# StackOverflow 问答 11140000-11140999

# wpf - 在 WPF 中为窗口创建抽象基类

> ID：11140000
> 
> 赞同：1
> 
> 时间：2012-06-21T14:07:36.480
> 
> 标签：wpf, user-interface, wpf-controls

通常的 WPF 架构：

```
public partial class MainWindow: Window {

... InitializeComponent()

}

XAML: <Window x:Class="MainWindow"> </Window> 
```

我想搬到的地方：

```
public abstract class BaseWindow: Window {

    public System.Windows.Controls.TextBlock control1;
    public System.Windows.Shapes.Rectangle   control2;
    public System.Windows.Controls.TextBox   control3;

}

public partial class AWindowImplementation {

... InitializeComponent()

}

public partial class AnotherWindowImplementation{

... InitializeComponent() 

}

 XAML:
 <BaseWindow x:Class="AWindowImplementation"> </BaseWindow>
 <BaseWindow x:Class="AnotherWindowImplementation"> </BaseWindow> 
```

以上是伪代码。这个新架构编译，并警告实现隐藏控制定义（因为我应该放置“覆盖”关键字的地方是自动生成的 InitializeComponent）。不幸的是，控制字段没有被填充。

这是可以实现的吗？我想做的是创建几个具有相同界面/控件的 UI 设计，以便其余代码可以与任一设计交互。

**编辑：感谢 pchajer 和 Yevgeniy，我现在有了以下工作解决方案，但我仍然收到覆盖警告：**

```
 public class MainWindowBase : Window
 {
     public TextBlock control1;
     public Rectangle control2;
     public TextBox   control3;

    static MainWindowBase()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(MainWindowBase),
                   new FrameworkPropertyMetadata(typeof(MainWindowBase)));
    }

    public override void OnApplyTemplate()
    {
        control1 = (TextBlock) FindName("control1");
        control2 = (Rectangle) FindName("control2");
        control3 = (TextBox)   FindName("control3");
    }

 }   

 <Style TargetType="{x:Type views:MainWindowBase}" 
           BasedOn="{StaticResource {x:Type Window}}">
     <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type views:MainWindowBase}">
                    <ContentPresenter />                                 
            </ControlTemplate>
        </Setter.Value>
     </Setter>
     </Style>

 public partial class AWindowImplementation :MainWindowBase {

 ... InitializeComponent()

}

 <MainWindowBase x:Class="AWindowImplementation"> </MainWindowBase> 
```

我想我将不得不在基类中使用不同的字段名称来消除警告，或者可能在派生类中删除 InitializeComponent。但无论如何它现在工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:15:40.553

在 WPF 中，您可以创建一个继承自 Window 并具有 XAML 的基类。但有一个工作场所

请参阅此链接-[如何创建通用的 WPF 基本窗口样式？](https://stackoverflow.com/questions/7507953/how-to-create-a-common-wpf-base-window-style)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T03:33:04.090

您需要将 Window 的基类定义为自定义控件。只需创建一个新的自定义控件，将基类设置为 Window，然后从 blend 中插入样式（您可以添加自己的组件）。另请参阅 pchajer 的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:48:45.280

我不确定您希望伪代码如何工作，因为没有任何东西调用您的`InitializeComponent`. 通常，WPF 在窗口的构造函数中代表您调用它。但是在您的情况下，您正在添加一个新的实现（而不是覆盖）并且没有调用它。

一种选择是只从每个子类构造函数中调用您的新实现。例如。`AWindowImplementation`的构造函数可以调用`this.InitializeComponent()`.

另一种选择是定义其构造函数调用`BaseWindow`的虚拟方法（例如）。`InitializeComponentCore`然后基类可以覆盖该方法。

# unit-testing - Spec2 单元测试未编译

> ID：11140001
> 
> 赞同：0
> 
> 时间：2012-06-21T14:07:40.020
> 
> 标签：unit-testing, scala, specs2

我已经编写了一个中值函数，并想为它添加一些单元测试。

所以我在specs2中写了这个

```
class TestStats extends Specification {
  "Median function " should {
    "be None for an empty list" in { Stats.median([]) must beNone }
    "be the midpoint of an odd length list" in { Stats.median([1,2,3]) must_== Some(2)}
    "be the average of the two midpoints of an even length list" in { Stats.median([1,2,3,4])     must_== Some(2.5)}
  }
} 
```

但是，它不会与在线错误`No implicit view available from Option[Double] => org.specs2.execute.Result.`一起编译`"be None...`。

我不明白为什么它在这里要求这个。我真的应该写一个隐含的自己来做这个比较吗？

*编辑*所以这个问题纯粹是语法问题 - 请参阅下面的答案。我有点恼火，因为语法错误被报告为语义错误，这就是为什么我从来没有想过我的列表文字是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:01:02.267

显然，我最近在 Python 上花了太长时间。更正列表文字语法可解决问题：

```
class TestStats extends Specification {
  "Median function " should {
    "be None for an empty list" in { median(Nil) must_== None }
    "be the midpoint of an odd length list" in { median(List(1, 2, 3)) must_== Some(2) }
    "be the average of the two midpoints of an even length list" in { median(List(1, 2, 3, 4)) must_== Some(2.5) }
  }
} 
```

# javascript - 如何在刷新网络浏览器时使用 Cookie 和本地存储获取上一页

> ID：11140004
> 
> 赞同：0
> 
> 时间：2012-06-21T14:07:47.067
> 
> 标签：javascript, html

如何在刷新网络浏览器时使用 Cookie 和本地存储获取上一页。请用简单的例子给我建议或参考任何链接......

# jquery - 我应该在删除元素时删除处理程序吗？

> ID：11140006
> 
> 赞同：0
> 
> 时间：2012-06-21T14:07:56.257
> 
> 标签：jquery

我只用 jQuery 工作了几天，所以问题可能不是很有趣。我在 ajax 上按下按钮时重新加载了**DIV 。****DIV**内容本身为按钮注册了**单击处理程序。**所以问题是：我应该删除已注册加载内容的处理程序吗？

我做了一些小实验，看起来我不应该这样做。但这是真的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:29:49.593

如果元素从 DOM 中删除并且您没有对它们的进一步引用，则事件处理程序最终也会被垃圾收集。

但是，如果您有参考，例如

```
var someElement = document.getElementById('someId') 
```

那么即使该元素被您的更新过程删除，`someElement`仍然会持有对该元素的引用。这也意味着事件处理程序仍然存在于内存中。

# c# - n 层应用程序中的数据排序

> ID：11140009
> 
> 赞同：1
> 
> 时间：2012-06-21T14:08:04.217
> 
> 标签：c#, linq, nhibernate, sorting, architecture

我有以下架构：

```
DAL (NHibernate) -> BLL -> WCF (http) -> Clients 
```

客户对域模型一无所知。WCF 使用 DTO 对象与客户端通信。

其中一个客户端是一个网站 (ASP.NET MVC)，它的网格很少。我需要为此网格实现排序。排序应该在服务端实现，因为客户端只接收请求的部分数据（分页）。

做这个的最好方式是什么？现在，我有两种方法似乎不太好。

1.  为每个实体的每个属性制定服务合同的单独排序方法（在我的情况下为 36）
2.  使用大量反射制作通用排序方法并从客户端接收魔术字符串（属性名称，方向）。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:43:50.607

如果您在 DAL 中使用 NHibernate，我建议您通过属性名称进行排序，然后使用 Criteria api 查询数据，您可以轻松添加属性以进行排序，而无需使用反射。想到为相同的数据使用 36 种不同的方法只是为了更改排序顺序，我感到畏缩......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T15:58:29.470

好的，就我而言，我找到了最好的解决方案——Dynamic LINQ to NHibernate。 [http://nhforge.org/blogs/nhibernate/archive/2011/11/17/dynamic-linq-to-nhibernate.aspx](http://nhforge.org/blogs/nhibernate/archive/2011/11/17/dynamic-linq-to-nhibernate.aspx)

```
var elist = session.Query<MyEntity>()
          .OrderBy(“Name descending”)
          .Skip(first)
          .Take(count)
          .ToList(); 
```

此外，OData 似乎是一个好方法，但我没有时间更改现有的项目结构。

`IQueryable`根据 Criteria api - 如果它有办法返回而不是`IList`为了与 LINQ 兼容，那就太好了。我不想将它用作默认查询引擎。

谢谢大家。你帮我知道一些新的东西！

# c# - 通过反射调用方法而不获取 TargetInvocationException

> ID：11140010
> 
> 赞同：6
> 
> 时间：2012-06-21T14:08:13.017
> 
> 标签：c#, reflection

我找到了一种使用反射的方法（并且得到了它`MethodInfo`）。如何`TargetInvocationException`在引发异常的情况下调用它？

**更新**

我正在创建一个命令实现，其中命令由实现的类处理

```
public interface ICommandHandler<T> where T : class, ICommand
{
    public void Invoke(T command);
} 
```

由于有一个调度程序负责查找并将所有处理程序映射到正确的命令，因此我不能直接调用方法，而是使用反射。就像是：

```
var handlerType = tyepof(IHandlerOf<>).MakeGenericType(command.GetType());
var method = handlerType.GetMethod("Invoke", new [] { command.GetType() });
method.Invoke(theHandler, new object[]{command}); 
```

它工作正常，但我希望所有异常都传递给调用命令的代码。

以便调用者可以使用：

```
try
{
    _dispatcher.Invoke(new CreateUser("Jonas", "Gauffin"));
}
catch (SomeSpecificException err)
{
    //handle it.
} 
```

而不是必须赶上`TargetInvocationException`。

（我知道我可以抛出内部异常，但由于堆栈跟踪已被破坏，这毫无价值）

**更新2**

[这](http://timwi.blogspot.se/2010/03/dynamic-method-invocation-without.html)是一个可能的解决方案..

但它似乎更像是一个黑客。没有更好的解决方案吗？也许是用表情之类的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:11:10.813

`Delegate`从`MethodInfo`（通过 的重载之一）创建一个[`Delegate.CreateDelegate`](http://msdn.microsoft.com/en-us/library/system.delegate.createdelegate.aspx)并调用它。这*不会*将方法抛出的任何异常包装在`TargetInvocationException`like`MethodInfo.Invoke`中。

```
class Foo
{
    static void ThrowingMethod()
    {
        throw new NotImplementedException();
    }

    static MethodInfo GetMethodInfo()
    {
        return typeof(Foo)
                .GetMethod("ThrowingMethod", BindingFlags.NonPublic | BindingFlags.Static);
    }

    // Will throw a NotImplementedException
    static void DelegateWay()
    {
        Action action = (Action)Delegate.CreateDelegate
                                    (typeof(Action), GetMethodInfo());
        action();
    }

    // Will throw a TargetInvocationException 
    // wrapping a NotImplementedException
    static void MethodInfoWay()
    {
        GetMethodInfo().Invoke(null, null);
    }
} 
```

**编辑**：

（正如 OP 所指出的，DynamicInvoke 在这里不起作用，因为它也包装了）

根据您的更新，我会使用`dynamic`：

```
((dynamic)theHandler).Invoke(command); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T14:10:38.893

你不能。这是通过反射调用方法来传播异常的指定方式。如果您希望效果是被抛出的原始异常，您总是可以捕获`TargetInvocationException`然后抛出通过属性获得的“内部”异常。[`InnerException`](http://msdn.microsoft.com/en-us/library/system.exception.innerexception.aspx)

（请注意，您将丢失原始堆栈跟踪。可能有一种方法可以防止这种情况发生，但这很棘手。我相信.NET 4.5 中*可能会*对此提供更多支持；我不确定。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-21T14:10:31.837

您可以在 mehtodinfo 实例上调用 Invoke，但调用的第一个参数是目标（方法信息所属的对象）。如果你通过它并且它有权调用它，你不应该得到异常。

# asp.net - asp.net 缓存

> ID：11140013
> 
> 赞同：1
> 
> 时间：2012-06-21T14:08:42.017
> 
> 标签：asp.net, caching

net 和我最近刚刚完成了一个使用 asp.net 的小型应用程序。我遇到的问题是，当用户单击按钮注销时，我正在调用以下命令：

```
Session.Abondon(); 
if (Request.Cookies["ASP.NET_SessionId"] != null)
{
     Response.Cookies["ASP.NET_SessionId"].Value = string.Empty;
     Response.Cookies["ASP.NET_SessionId"].Expires = DateTime.Now.AddMonths(-20);
 } 
```

现在，当他们单击浏览器窗口上的后退按钮时，他们能够看到他们所在的确切页面。我怎样才能阻止这种情况发生？请帮忙。

# c# - ITextSharp - 在第一页之外的标题区域上写入 PDF

> ID：11140014
> 
> 赞同：3
> 
> 时间：2012-06-21T14:08:51.310
> 
> 标签：c#, .net, formatting, pdf-generation, itextsharp

我一直在使用 ITextSharp 并使用它来生成 PDF - 但是我最近遇到了一个问题，即第一个页面之外的所有页面的上边距似乎都被忽略了，因此我的标题上发生了写入。

**当前利润：**

```
document.SetMargins(72,72, 36, 36); 
```

应该注意的是，左边距和右边距在第一页之外完美地工作 - 但是它似乎忽略了顶部边距并在页面顶部（标题出现的地方）开始文本。

有没有人知道为什么会发生这种情况？或者是否有一个区域或事件可以用来加强每一页的文档页边距？（也许是`OnStartPage`事件？）

如果需要，我很乐意提供任何额外的代码——因为我知道 ITextSharp 在代码方面可能会变得非常复杂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-22T14:22:49.847

如果你想要不同的页边距，我钩住了 OnPageStart 事件并根据页码设置页边距。

```
internal class DocumentEvents : PdfPageEventHelper
{
    /// <summary>
    /// Called when [start page].
    /// </summary>
    /// <param name="writer">The writer.</param>
    /// <param name="document">The document.</param>
    public override void OnStartPage(PdfWriter writer, Document document)
    {
        if (document.PageNumber == 1)
        {
            document.SetMargins(40f, 40f, 130f, 20f);
        }
        else
        {
            document.SetMargins(40f, 40f, 30f, 30f);
        }

        document.NewPage();
    }
} 
```

不要忘记将您的事件连接到文档编写器：

```
this.writer.PageEvent = new DocumentEvents(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T13:54:10.987

根据 Alexis Pigeon 将页眉和页脚包含在`OnEndPage`事件中的指示解决了该问题，而不是将它们中的每一个都放在单独的事件中。我还调整了边距（增加底部边距）以防止覆盖。

# qt - Qt paintEvent 我可以在子小部件上绘画吗？

> ID：11140018
> 
> 赞同：3
> 
> 时间：2012-06-21T14:08:58.393
> 
> 标签：qt

我有一个 QMainWindow 的小部件类子类，它有一个中央小部件（QWidget），在重写的paintEvent 函数中，我可以在这个中央小部件上创建一个 QPainter 的实例吗？代码如：

```
void MyMainWindow::paintEvent(QEvent *event)
{
    QPainter painter(_theCentralWidget);
    //drawing...
    return QMainWindow::paintEvent(event);
} 
```

我不想创建一个新的 QWidget 的 c++ 类子类并覆盖它的paintEvent 函数，然后用这个新的替换原来的中央小部件......（我确实喜欢上面，但是发生了一个错误，说画家不活跃...... .)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T20:52:28.907

好。如果您真的，真的，真的不想对中央小部件进行子类化，您可以为其安装一个事件过滤器并为其处理绘制事件。

[http://qt-project.org/doc/qt-4.8/qobject.html#installEventFilter](http://qt-project.org/doc/qt-4.8/qobject.html#installEventFilter)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-05T05:41:16.733

您可以使用 C++11 lambdas 来解决这个问题。创建一个新的通用“任何事物的事件”QObject，它通过您指定的 lambda 传递其过滤。然后使用所需的逻辑将此通用对象添加到您的显示小部件。例如：

通用-qevent-filter.hpp：

```
#pragma once

class GenericQEventFilter : public QObject
{
  Q_OBJECT

public:
  GenericQEventFilter(QObject *parent, std::function<bool (QObject *obj, QEvent *event)> event_filter_f);
  std::function<bool (QObject *obj, QEvent *event)> event_filter_f;

protected:
  bool eventFilter(QObject *obj, QEvent *event);

}; 
```

通用-qevent-filter.cpp：

```
#include "generic-qevent-filter.hpp"

GenericQEventFilter::GenericQEventFilter(QObject *parent, 
                     std::function<bool (QObject *obj, QEvent *event)> event_filter_f)
  : QObject(parent), event_filter_f(event_filter_f)
{
}

bool GenericQEventFilter::eventFilter(QObject *obj, QEvent *event)
{
  return this->event_filter_f(obj, event); 
} 
```

您在代码中使用它，如下所示：

```
MainWindow::MainWindow(QWidget* parent) : QMainWindow(parent)
{ 
   ui = new Ui_MainWindow();
   ui->setupUi(this); // Initialise widgets
   this->wire_up_gui(); // Connect signals and slots

   ui->displayWidget->installEventFilter(new GenericQEventFilter(this, [&] (QObject *obj, QEvent *event) {
     if(event->type() == QEvent::Paint) {
       paint_display_widget(obj, event);
       return true;
     }
     return false;
   }));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:46:40.627

“警告：当paintdevice 是一个小部件时，QPainter 只能在paintEvent() 函数内部或由paintEvent() 调用的函数中使用；除非设置了Qt::WA_PaintOutsidePaintEvent 小部件属性。在Mac OS X 和Windows 上，无论此属性的设置如何，您都只能在paintEvent() 函数中进行绘制。”

来自：[QT 文档](http://qt-project.org/doc/qt-5.0/qpainter.html)

# objective-c - 如何在 iOS Core Data 中获取属性数组？

> ID：11140020
> 
> 赞同：1
> 
> 时间：2012-06-21T14:09:03.337
> 
> 标签：objective-c, ios, core-data

我正在将 CoreData (NSManagedObject, UIManagedDocument) 用于 iOS 应用程序，我想知道是否可以获取一组属性。

例如，假设我`Person`的数据库中有实体，每个实体`Person`都有一个名为的属性`income`和一个名为`name`. 假设我`Person`的数据库中有多个 s。是否可以获取包含我整个数据库的所有收入的数组？（以每个人的收入为条目的数组）。如果是这样，我将如何按他们的名字对数组进行排序？

如果这是不可能的，你会建议我如何去完成这个？我不想获取整个`Person`实体，因为还有许多其他大型属性，例如`images`需要很长时间才能获取。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:48:24.317

您可以通过以下方式获取所需的属性：

```
NSFetchRequest* fetchRequest = [NSFetchRequest new];
fetchRequest.entity = <person entity description>;
fetchRequest.propertiesToFetch = @[ @"name", @"income" ];
fetchRequest.sortDescriptors = @[ [NSSortDescriptor sortDescriptorWithKey: @"name" ascending: YES] ];
fetchRequest.resultType = NSDictionaryResultType;

NSError* error = nil;
NSArray* personsAttributes = [managedObjectContext executeFetchRequest: fetchRequest error: &error]; 
```

personAttributes 看起来像这样：

```
[
    { "name" : "Alfred", "income" : 1000 },
    { "name" : "Birgite", "income" : 2000 },
    …
] 
```

带有 ARC 和文字的代码。您可能需要根据您的需要和编译选项对其进行定制。

# proxy - haproxy 匹配 use_backend 中的各种条件

> ID：11140021
> 
> 赞同：19
> 
> 时间：2012-06-21T14:09:07.423
> 
> 标签：proxy, haproxy

我正在尝试在一个后端匹配各种条件，如下所示：

```
acl rule1 hdr_dom(host) -i ext1
acl rule2 utl_beg /img
default_backend back-server-http if rule1 and rule2 
```

但是，我怎样才能把这个“和”放在两条规则之间呢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-10T16:21:01.790

是的，这是解决方案：

```
acl rule1  hdr_dom(host) -i www.uno.es  hdr_dom(host) -i www.one.com
use_backend uno.com if rule1 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-08-06T02:49:15.397

您不需要在两条规则之间使用“和”这个词。这是隐含的。

来源：*第 7.2 节*中的 [http://haproxy.1wt.eu/download/1.5/doc/configuration.txt](http://haproxy.1wt.eu/download/1.5/doc/configuration.txt)

 ** * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-03-12T11:25:31.560

我认为下面的语法可以解决问题（检查这个链接[HAProxy - basic authentication for backend server](https://stackoverflow.com/questions/33869330/haproxy-basic-authentication-for-backend-server/64138986#64138986)）

```
acl rule1 hdr_dom(host) -i ext1
acl rule2 utl_beg /img
default_backend back-server-http if rule1  rule2 
```*

# ios - 制作一个iOS“前进”按钮

> ID：11140026
> 
> 赞同：2
> 
> 时间：2012-06-21T14:09:23.167
> 
> 标签：ios, uinavigationbar

由于这些词的通用性，这很难搜索。我想为我的应用程序制作一个“前进”按钮，就像标准的 iOS 导航“后退”按钮一样，但显然指向另一个方向。

所以我的问题很简单：有没有采用“后退”按钮样式的标准方法，只需翻转它以使其指向右侧？还是我必须制作自定义按钮背景？

这是我想要的快速“购物截图”。

![后退和继续按钮](../Images/4afcff06e8baa5dfcdf2db365205dd1f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:44:48.960

后退按钮有一个设置功能，它在导航控制器中弹出当前视图控制器并返回到前一个。前进按钮没有明确的语义，因为您可以将任何视图控制器推送到导航控制器上，这就是 UIKit 不提供它的原因。您可能必须模拟它（复制和翻转图形），然后在用户按下给定视图控制器时系统地推送它。

# android - 通过检查 ViewHolder 是否使用相同的模型对象来优化 ListAdapter

> ID：11140029
> 
> 赞同：0
> 
> 时间：2012-06-21T14:09:40.243
> 
> 标签：android, android-listview

我想知道检查是否`ViewHolder`使用相同的模型对象是一个很好的优化。这适用于填充`View`返回的`getView()`.

这假设视图内容没有改变——我认为这是常见的情况。

例如，标准模式是：

```
public View getView(int position, View convertView, ViewGroup parent) {
            Model model = models.get(position);
    if (convertView != null) {
                    // View was recycled. Get the holder.
        viewHolder = (ViewHolder) convertView.getTag();
    } else {
                    // Inflate a new layout and create a holder
        convertView = inflater.inflate(R.layout.item_layout, null);
        viewHolder = new ViewHolder();
        viewHolder.name = (TextView) convertView.findViewById(R.id.name);
        viewHolder.img = (ImageView) convertView
                .findViewById(R.id.img);
        convertView.setTag(viewHolder);
    }

    // Fill in the content
    Bitmap imgBitmap = loadBitmapFor(model.getName());

    if (imgBitmap != null) {
        viewHolder.img.setVisibility(View.VISIBLE);
        viewHolder.img.setScaleType(ImageView.ScaleType.FIT_XY);
        viewHolder.img.setImageBitmap(imgBitmap);
            }

    viewHolder.name.setText(model.getName());

    return convertView;
}

static class ViewHolder {
    TextView name;
    ImageView img;
} 
```

我们通过检查是否`ListView`在同一位置查看同一对象来进行优化：

```
public View getView(int position, View convertView, ViewGroup parent) {
            Model model = models.get(position);

            boolean recycled;
    if (convertView != null) {
                    // View was recycled. Get the holder.
        viewHolder = (ViewHolder) convertView.getTag();
                    recycled = true;
    } else {
                    // Inflate a new layout and create a holder
        convertView = inflater.inflate(R.layout.item_layout, null);
        viewHolder = new ViewHolder();
                    viewHolder.model = model;
        viewHolder.name = (TextView) convertView.findViewById(R.id.name);
        viewHolder.img = (ImageView) convertView
                .findViewById(R.id.img);
        convertView.setTag(viewHolder);
                    recycled = false;
    }

            // Skip the expensive content loading if we can
            if (recycled && (model == viewHolder.model) && (position == viewHolder.position)) {
                return convertView;
            }

    // Fill in the content
    Bitmap imgBitmap = loadBitmapFor(model.getName());

    if (imgBitmap != null) {
        viewHolder.img.setVisibility(View.VISIBLE);
        viewHolder.img.setScaleType(ImageView.ScaleType.FIT_XY);
        viewHolder.img.setImageBitmap(imgBitmap);
            }

    viewHolder.name.setText(model.getName());

    return convertView;
}

static class ViewHolder {
            int position; // for double checking_
            Model model;
    TextView name;
    ImageView img;                
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:08:35.910

由于视图回收工作主要是这样的：[http ://android.amberfog.com/wp-content/uploads/2010/02/listview_recycler.jpg](http://android.amberfog.com/wp-content/uploads/2010/02/listview_recycler.jpg)

回收视图的新位置和以前的位置不太可能相同。

您应该专注于缓存**s**`Bitmap`。`Bitmap`按需生成s，然后将它们放入缓存中。您可以使用`LruCache`（在兼容性库中提供），如下所示：http: [//developer.android.com/training/displaying-bitmaps/cache-bitmap.html](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)

# c# - ComboBox SelectedValue 或 SelectedItem 绑定 WPF C#

> ID：11140036
> 
> 赞同：5
> 
> 时间：2012-06-21T14:09:58.470
> 
> 标签：c#, wpf, data-binding, combobox

我有一个组合框，它绑定到`ObservableCollection`对象中的一个字符串。此绑定有效，但我还想将用户从此组合框中选择的任何内容绑定到同一个对象中的另一个字符串属性中。我不知道是否应该使用`SelectedValue`or `SelectedItem`，或者是否还有其他问题。先感谢您。

到目前为止，这是我所拥有的，我省略了与问题无关的任何代码：

**在 XAML 中：**

```
<Grid.Resources>
    <my:JobItem x:Key="jobItemViewSource" />
</Grid.Resources>

<ComboBox x:Name="businessUnitBox" ItemsSource="{Binding Path=BusinessUnits}" IsSynchronizedWithCurrentItem="True">
    <ComboBox.SelectedValue>
        <Binding Path="BusinessUnit" Mode="TwoWay" UpdateSourceTrigger="Explicit" />
    </ComboBox.SelectedValue>
</ComboBox> 
```

**后面的代码：**

```
public string BusinessUnit
{
    get{  return businessUnit; }
    set
    {
        if (String.IsNullOrEmpty(BusinessUnit) || !BusinessUnit.Equals(value))
        {
            businessUnit = value;
            OnPropertyChanged("BusinessUnit");
        }
    }

}

public ObservableCollection<string> BusinessUnits
{
    get { return businessUnits; }
    set
    {
        if(!BusinessUnits.Equals(value))
        {
            businessUnits = value;
            OnPropertyChanged("BusinessUnits");
        }

        businessUnits = value;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T14:15:07.193

您可能想使用[`SelectedItem`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selecteditem). 这将给出绑定到它的实际项目。[`SelectedValue`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectedvalue)由[`SelectedValuePath`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectedvaluepath)属性决定......在这种情况下这是不必要的。此外，您可能不想将 设置`UpdateSourceTrigger`为`Explicit`. 在这方面，默认值应该没问题。

# javascript - 从javascript更改css文件夹

> ID：11140039
> 
> 赞同：0
> 
> 时间：2012-06-21T14:10:04.857
> 
> 标签：javascript, html, css

我有一个 html + css + javascript 应用程序。我希望能够启用主题。

我所有的 CSS 都复制在两个文件夹中：/theme1/... 和 /theme2/...

所以我的html看起来像：

```
<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="theme1/file1.css"/> 
        <link rel="stylesheet" href="theme1/file2.css"/> 
         .... 
         ....
    </head>
    <body>  
    .....
    </body>
</html> 
```

我希望能够使用 javascript 更改 css 的主文件夹（主题 1 到主题 2）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:12:05.217

```
<link id="foo" rel="stylesheet" href="theme1/file1.css"/> 
```

当您想更改主题时：

```
document.getElementById('foo').href = 'theme1/file2.css'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:13:30.050

这是解决问题所需的：

*   获取相关标签。在这种情况下，任何`link`带有 的标签`rel="stylesheet"`都可以，但如果您愿意，您甚至可以指定“以”开头`theme1`。这一切都可以用`document.querySelectorAll("link[rel=stylesheet][href^=theme1]")`
*   循环通过它们。一个简单的`for`循环就可以了。
*   `getAttribute("href")`得到你需要的字符串。
*   `replace()`将允许您替换所需的字符串部分。
*   `setAttribute("href",newattr)`会将属性放回标签中。

# ios - 提交测试版 iPhone 应用到商店

> ID：11140044
> 
> 赞同：0
> 
> 时间：2012-06-21T14:10:17.497
> 
> 标签：ios, xcode, app-store

我的公司正在开发一款动态移动应用程序，该应用程序可以根据网络电话更新外观和外观，我们希望能够测试它是否能够进入商店。目前，我们已经使用该代码创建了一个内部公司应用程序，其中初始屏幕是一个登录屏幕，用户使用他们的公司用户名和密码登录。公司中只有大约 20 人将使用该应用程序进行测试版发布，并且该应用程序登录仅对公司成员可用。

我们希望发布此测试版本，首先确保应用进入应用商店，其次才能了解应用审核过程。这种类型的应用程序会被允许进入商店吗？还是因为它的用户群有限，他们会拒绝它吗？还需要为苹果提供一个测试用户名/通行证以登录公司网站本身以检查应用程序的运行方式吗？

有关此问题的任何信息都将非常有帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:15:08.713

来自[App Store Review Guidelines](https://developer.apple.com/appstore/resources/approval/guidelines.html)（需要开发者帐户）：

> 如果您的 App 看起来像是几天后拼凑起来的，或者您正试图将您的第一个练习 App 放到商店中以打动您的朋友，请做好被拒绝的准备。我们有很多认真的开发人员，他们不希望他们的优质应用程序被业余时间所包围。

和

> **2.9** “beta”、“demo”、“trial”或“test”版本的应用程序将被拒绝

最后，是的，如果需要登录才能使用整个应用程序，则需要提供“演示帐户”。

* * *

对于您的小用户群，如果您的应用程序仅由 20 人左右使用（如评论中所述），则可能不会被接受。[iOS 企业计划](https://developer.apple.com/programs/ios/enterprise/)旨在用于内部分发（小而有限的用户群）。

> **2.22**任意限制哪些用户可以使用该应用的应用......可能会被拒绝

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:12:34.773

我曾在一家发布受登录屏幕保护的应用程序的公司工作。将其放入应用商店所需要做的就是为 Apple 提供正确的登录名，以便他们可以自己测试应用的功能。在 iTunes Connect 中更新您的应用程序的元数据时，有一个测试笔记部分，只需将您的测试用户名/密码放在那里供苹果使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:18:25.630

他们可以拒绝应用程序的一种方法是准则 2.12：“我们发现您的应用程序的功能和/或内容不够有用或娱乐性不足，或者您的应用程序没有吸引足够广泛的受众，以符合该应用程序商店审查指南。” 如果您担心您的应用程序是否可以进入商店，那么只需提交它就没有真正的问题。只是不要称它为 beta 测试版本，因为他们会拒绝它。如果您愿意，您可以随时将应用程序的发布日期更改为未来的日期，然后在到达该未来日期之前，该应用程序仍将无法对所有人开放。是的，您应该为他们提供用户名

# node.js - 如何在 MongoDB+Node.js 中更新嵌套数组

> ID：11140045
> 
> 赞同：0
> 
> 时间：2012-06-21T14:10:20.033
> 
> 标签：node.js, mongodb

所以我有一个包含项目数组的播放列表文档。现在我想为项目添加一个投票数组，但我不知道该怎么做。目前这是我添加新项目的方式......

```
playlist_collection.update(
  {"PlaylistName": playlistName},
  {"$push": {items: newitem}},
  function(error, playlist){
    if( error ) callback(error);
  }); 
```

我知道还有一些关于这个的帖子，所以如果有一个很好的例子，重复就可以了。

这是数据库中的对象

```
{ "PlaylistName" : "MyFirstPlaylist", 
  "_id" : ObjectId("4fe0c6570fb2321b39000001"), 
  "comments" : [ ], 
  "created_at" : ISODate("2012-06-19T18:35:03.462Z"), 
  "items" : [   
      {     "SongName" : "Test",    "Location" : "/tmp/40dd4f78466c3c7171f1eaf448e8f1d6" } 
  ] 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:07:52.120

我最终使用了这个......

```
PlaylistProvider.prototype.addVoteToItem = function(, itemname, vote, callback) {
  this.getCollection(function(error, collection) {
    collection.findOne({'PlaylistName':playlistName}, function (err, playlist) {
      if( err ) callback( err );
      playlist.items.forEach(function (item) {
        for (var prop in item) {
          if (prop == 'SongName'){
            if(item[prop] == itemname){
              console.log("Found "+item[prop])
              if( item.votes === undefined ) item.votes = [];
          item.votes.push(vote)
              collection.save(playlist)
              callback(null, playlist)
              break;
            } 
          }  
        }
      })
    })
  })
} 
```

# android - 如何播放 MP3 文件并同时检测滑动？

> ID：11140049
> 
> 赞同：-2
> 
> 时间：2012-06-21T14:10:28.847
> 
> 标签：android

在同一个活动中，我想播放一个 MP3 文件。在播放 MP3 文件时，我希望能够检测到滑动。

我有检测滑动的代码（[来源here](http://android-journey.blogspot.ca/2010/01/android-gestures.html)），但我仍在研究如何在播放音频文件时检测滑动。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:11:41.100

为您的音乐启动一个单独的线程，这样它就不会影响其他进程。

# android - 列表视图的选择器不起作用

> ID：11140051
> 
> 赞同：0
> 
> 时间：2012-06-21T14:10:33.057
> 
> 标签：android, android-layout, android-listview

如果选择为黄色，我想将列表视图中的行颜色设置为黄色，否则为白色，因此我使用以下选择器

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:state_enabled="true" 
     android:state_pressed="true" android:drawable="@color/encounter_normal"  />
    <item android:state_enabled="true"
     android:state_focused="true" android:drawable="@color/encounter_normal" />
    <item android:state_enabled="true"
     android:state_selected="true" android:drawable="@color/encounterselector_color" />
    <item
     android:drawable="@color/encounter_normal"  />
</selector> 
```

在哪里

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="encounterselector_color">#fbeda5</color>
    <color name="encounter_normal">#ffffff</color>  
</resources> 
```

我像下面这样使用它

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" 

    android:id="@+id/EncounterGrid"
    android:background="@drawable/encounterlistview"

    >
 <!-- remaining code --> 
```

但是该行总是白色的，知道如何解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-26T07:56:54.927

在我设置之前，没有什么对我有用`drawSelectorOnTop = "true"`。

之后一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:23:19.287

使用选择器设置背景颜色有点棘手。基本上你必须为每种颜色创建一个drawable并在你的`android:drawable`属性中使用它们。您不能直接使用颜色。

检查此[相关问题](https://stackoverflow.com/questions/3592780/selector-on-background-color-of-textview)以获取更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:35:30.807

我使用以下内容：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

<!-- This is the switched off state -->
<item   android:state_enabled="false"
        android:drawable="@drawable/grey_bar" />

<!-- These are the partial states -->
<item   android:state_pressed="true"
        android:drawable="@drawable/button_pressed" />        

<item   android:state_focused="true" android:state_enabled="true"
        android:drawable="@drawable/button_focused" />

<!--  This is the switched on state -->
<item   android:state_enabled="true"
        android:drawable="@drawable/button_normal" />
</selector> 
```

我指向的所有可绘制对象都是在 xml 中定义的，或者是现有的 9 个补丁图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T04:16:17.037

在您的选择器上使用`android:color`，而不是`android:drawable`因为您正在获取对颜色资源的引用，所以您的选择器将是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android" >
    <item android:state_enabled="true" 
     android:state_pressed="true" android:color="@color/encounter_normal"  />
    <item android:state_enabled="true"
     android:state_focused="true" android:color="@color/encounter_normal" />
    <item android:state_enabled="true"
     android:state_selected="true" android:color="@color/encounterselector_color" />
    <item
     android:color="@color/encounter_normal"  />
</selector> 
```

# c++ - 在 dll 边界上暴露 std::vector - 编译器独立性的最佳实践

> ID：11140057
> 
> 赞同：7
> 
> 时间：2012-06-21T14:10:53.573
> 
> 标签：c++, visual-studio, dll, stl, loose-coupling

在 DLL 边界上公开 STL 容器不是一个好主意，而且通常是不可能的（请参阅[这个答案了解为什么](https://stackoverflow.com/questions/5661738/common-practice-in-dealing-with-warning-c4251-class-needs-to-have-dll-inter/5664491#5664491)，以及[这个](https://stackoverflow.com/questions/1881494/how-to-expose-stl-list-over-dll-boundary)关于在 dll 边界上公开 std::list 的答案）。我需要能够在使用不同（VC08/VC10+）编译器编译的 DLL 和 EXE 之间传递数据；[此 Q](https://stackoverflow.com/questions/1184777/dlls-and-stls-and-static-data-oh-my?rq=1)仅处理相同的所有内容。

暴露它们的最佳方法是什么？向量与列表有点不同，因为内存保证是连续的，所以如果我只需要一个双精度的 const 向量，我可以只提供指向 dll 中函数块的开始和结束指针吗？dll 还需要返回一些结构，例如向量数组。

我想知道一个包含开始和结束指针的结构：

```
template <typename T>
struct vecWrapper<T> {
    T*  begin;
    T*  end;
}

// in the dll
int func(vecWrapper<double> numbers); 
```

这会是明智的吗？大概从函数返回的任何东西都需要一个析构函数（在 dll 端）来破坏它指向的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T17:11:24.610

你已经搞定了。该标准要求向量元素在内存中是连续的，并且除非您使用向量的分配器玩游戏，否则向量元素不会被堆栈分配，因此始终可以将向量的数据表示为开始和结束指针（或一个开始指针和一个大小，如果那是你的事）。你所拥有的应该可以正常工作。

*但是*，我不确定这有多大用处。 `std::vector`除了自动内存管理之外，并没有真正为您提供任何东西，而且您不希望这样做；否则，您在 DLL 中构造的任何向量在被破坏时都会释放您的原始双精度数组。你可以通过复制数组来解决这个问题，但你已经说过你也不想这样做。STL 算法在指针上工作得很好，所以也许不需要在 DLL 中进行转换。

# php - 读取两个双引号php之间的字符串

> ID：11140061
> 
> 赞同：0
> 
> 时间：2012-06-21T14:11:05.210
> 
> 标签：php, xml, string, class-diagram, double-quotes

美好的一天，我有一个导出为 XML 文件的 UML 类图，代码基本上和重复是这样的：

```
<UML:Class name="Zip Code" isLeaf="false" xmi.id="{C7C65474-DD51-4165-89A0-FB552A929185}" isAbstract="false" visibility="public"> 
```

所以，我需要做的是向用户输出文件中找到的所有类（等）。更确切地说，我需要阅读双引号内的名称。

更准确地说，从特定标签读取双引号内的字符串，例如：

要获取所有类名，我必须搜索：`<UML:Class name=" STRING WHAT I WANNA GET "`

要获得我必须搜索的所有属性名称：`<UML:Attribute name=" STRING I WANNA GET "`

***编辑：***我尝试过但仍然无法正常工作：x

我有这个;

例子.php

```
<?php
$xmlstr = <<<XML
<UML:Class name="Colaborator" isLeaf="false" xmi.id="{B8D626AE-F100-4548-9136-057E68BE577D}" isAbstract="false" visibility="public">
                    <UML:Classifier.feature>
                        <UML:Attribute name="Colaborator Name" xmi.id="{BB9111A8-740A-4463-9DF8-719E21E3F1CC}" ownerScope="instance" visibility="private" changeability="changeable">
                            <UML:StructuralFeature.type>
                                <UML:Classifier xmi.idref="Dttp0"/>
                                <UML:lol> sfdsf </UML:lol>
                            </UML:StructuralFeature.type>
                        </UML:Attribute>
                        <UML:Attribute name="Colaborator Address" xmi.id="{D7C15DA3-F86B-4696-874C-C69F94CDEE51}" ownerScope="instance" visibility="private" changeability="changeable">
<UML:StructuralFeature.type>
                          <UML:Classifier xmi.idref="Dttp1"/>
                        </UML:StructuralFeature.type>
                        </UML:Attribute>
                    </UML:Classifier.feature>
                </UML:Class>

XML;
?> 
```

并在 test.php

```
<?php
include 'example.php';

$UML:Class = new SimpleXMLElement($xmlstr);

foreach ($UML:Class->xpath('//UML:Attribute') as $attr) {
echo $attr->name, PHP_EOL;
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:25:46.033

如果您只需要名称（可能还有偏移量）：

```
regex: name="([\w ]+)" 
```

否则，您将需要使用 XML 解析器。

# javascript - 使用 jQuery 将事件绑定到使用 for 循环的多个元素

> ID：11140065
> 
> 赞同：0
> 
> 时间：2012-06-21T14:11:12.763
> 
> 标签：javascript, jquery, function, bind

所以我正在思考我需要在哪里生成元素，然后将事件绑定到它们。每次我生成一个元素时，我都会使用 for 循环将事件解除绑定并重新绑定到生成的元素。这些函数似乎触发了，但它们得到了错误的索引（它告诉代码要使用哪个元素）。

查看 jsFiddle 的代码[http://jsfiddle.net/6UgYe/4/](http://jsfiddle.net/6UgYe/4/)

任何解决这个问题的模块化都可以。也可以随意评论我的代码。去年我刚开始使用 javascript 时，我写了大部分内容。

问候，

阿克

编辑：这是实际解决方案：http: [//jsfiddle.net/nwH8Z/3/](http://jsfiddle.net/nwH8Z/3/)它计算模糊的免增值税价格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:04:56.910

将您的功能更改`bindEmAll`为如下所示 -

```
function bindEmAll()
{
    $('#container').on('blur', 'input[id$=".5"]', function(){

     $('#Errorfield').append('Current box is ' + this.id + '<br/>').append(num_format(this.value) + '<br />')  

})
} 
```

它使 ID 以 '.5' 结尾的所有输入框都将它们的 ID 和值（由您的`num_format()`函数处理）附加到`#Errorfield`. 事件处理程序附加到内部的***所有***输入框`#container`，即使它们是动态添加的。

并`bindEmAll()`从您的点击处理程序中删除`#addTT`；否则事件处理程序将被绑定与您单击 addTT 一样多次，这会使事情变得非常混乱 ;-)

```
$('#addTT').click(function() {
    addTT('#container');
}); 
```

[在这里](http://jsfiddle.net/6UgYe/11/)更新了小提琴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:05:41.703

问题正在发生，因为`blur`事件处理程序直到循环完成后才运行。执行顺序为：

*   将事件处理程序附加到项目 1 上的模糊事件
*   将事件处理程序附加到项目 2 上的模糊事件

...一段时间以后...

*   实际调用 blur 事件

到您的事件处理程序被调用时`i`，循环中的变量值已更改为最后一个值的索引，因此这就是事件处理程序中使用的内容。

为了解决这个问题，你可以把你的代码放在一个闭包中：

```
 (function(i) {
        $('#container input#box' + i + '\\.5').unbind();
        $('#container input#box' + i + '\\.5').blur(function() {
            //error processing function;
            $('#Errorfield').append('Current box is $(\'#container input#box' + i + '\\.5\')<br />');

        });
        $('#container input#box' + i + '\\.5').blur(function() {
            $('#container input#box' + i + '\\.5').val(num_format($('#container input#box' + i + '\\.5').val()));
            $('#Errorfield').append('Current box is $(\'#container input#box' + i + '\\.5\')<br />');
        });
    })(i); 
```

我在[这里更新了你的小提琴](http://jsfiddle.net/stevegreatrex/6UgYe/10/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:48:04.923

```
 boxes = 1;

        function num_format(input) {
            //For demo purporses, we only parseInt()+5
            ret = parseFloat(input) + 5;
            return ret;
        }

        function addTT(parentElement, arg1, arg2, arg3, arg4, arg5) {

            if (!arg1) {
                arg1 = "";
            }
            if (!arg2) {
                arg2 = "";
            }
            if (!arg3) {
                arg3 = "";
            }
            if (!arg4) {
                arg4 = "";
            }
            if (!arg5) {
                arg5 = num_format((0.00).toFixed(2));
            }

            row = $('<tr></tr>').attr('id', boxes);

            cell1 = $('<td class="inputcell"></td>');
            cell2 = $('<td class="inputcell"></td>');
            cell3 = $('<td class="inputcell"></td>');
            cell4 = $('<td class="inputcell"></td>');
            cell5 = $('<td class="inputcell"></td>');

            input1 = $('<input></input>').attr('style', 'width:100px;').attr('id', 'box' + boxes + '.1').attr('name', 'box' + boxes + '_1').attr('type', 'text').attr('value', arg1);
            input2 = $('<input></input>').attr('style', 'width:100px;').attr('id', 'box' + boxes + '.2').attr('name', 'box' + boxes + '_2').attr('type', 'text').attr('value', arg2);
            input3 = $('<input></input>').attr('style', 'width:93px;').attr('id', 'box' + boxes + '.3').attr('name', 'box' + boxes + '_3').attr('type', 'text').attr('value', arg3);
            input4 = $('<input></input>').attr('style', 'width:149px;').attr('id', 'box' + boxes + '.4').attr('name', 'box' + boxes + '_4').attr('type', 'text').attr('value', arg4);
            input5 = $('<input></input>').attr('style', 'width:90px;').attr('id', 'box' + boxes + '.5').attr('name', 'box' + boxes + '_5').attr('type', 'text').attr('value', arg5);

            $(cell1).append(input1);
            $(cell2).append(input2);
            $(cell3).append(input3);
            $(cell4).append(input4);
            $(cell5).append(input5);

            $(row).append(cell1);
            $(row).append(cell2);
            $(row).append(cell3);
            $(row).append(cell4);
            $(row).append(cell5);

            $('#tBoxes').append(row);
            boxes++;
        }

        function subTT(parentElement) {
            boxes = boxes - 1;
            $(parentElement + ' #' + boxes).hide(0, function () {
                $(parentElement + ' #' + boxes).remove();
            }
            );
        }
        function bindEmAll() {
            alert(boxes);
            for (var i = 1; i <= boxes - 1; i++) {

                $('#container input#box' + i + '\\.5').blur(function () {
                    alert($(this).val());
                    $(this).val(num_format($(this).val()));
                    //$('#container input#box' + i + '\\.5').val(num_format($('#container input#box' + i + '\\.5').val()));
                    //$('#Errorfield').append('Current box is $(\'#container input#box' + i + '\\.5\')<br />');
                });
            }
        }
        $('#addTT').click(function () {
            addTT('#container');
            bindEmAll();
        });
        $('#subTT').click(function () {
            subTT('#container');
        });
        $(function () { addTT('#container'); bindEmAll(); }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T14:54:22.300

这是一个添加新元素并处理其事件的小示例：

```
<button id="add">+</button>
<button id="remove">-</button>
<div id="holder">

</div> 
```

.

```
$('#add').on('click', function () {
    $('#holder').append('<p>click me!</p>');
});

$('#remove').on('click', function () {
    $('#holder p:last-of-type').remove();
});

$('#holder').on('click', 'p', function () {
    alert('my id is: ' + $('#holder p').index(this));
}); 
```

你可以在这里查看：http: [//jsfiddle.net/simo/PyKDz/](http://jsfiddle.net/simo/PyKDz/)

# jquery - 响应式布局中的任何滑块切换参数

> ID：11140066
> 
> 赞同：0
> 
> 时间：2012-06-21T14:11:13.357
> 
> 标签：jquery, responsive-design, anythingslider, window-resize

anyslider 有问题，有人知道如何使用新参数刷新 window.resize 上的滑块吗？

我已经尝试过调整大小的新调用。但它只适用于较小的布局一次。

```
function startSlideshow(){
    jQuery('#startslideshow')
    .anythingSlider({
        autoPlay : true,
        resizeContents : false,
        width : dynAnyWidth,
        height : dynAnyHeight,
..} 
```

在调整大小时，我使用新参数调用该函数..

谢谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T17:36:36.037

在AnythingSlider 的最新版本中，有一个`expand`选项可以自动调整AnythingSlider 的大小以适应其父元素。

查看这个具有固定高度和百分比宽度的[演示](http://proloser.github.com/AnythingSlider/expand.html)

或者这个具有动态宽度和高度的[演示。](http://jsfiddle.net/Mottie/Cm479/1431/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:13:53.087

像这样的东西？

```
$(window).resize(function () {
    var my_width = $(window).width();
    var my_height = $(window).height();

    // DO SOME MATH

    startSlideshow(my_width, my_height );
});

function startSlideshow(dynAnyWidth, dynAnyHeight){
    jQuery('#startslideshow')
    .anythingSlider({
        autoPlay : true,
        resizeContents : false,
        width : dynAnyWidth,
        height : dynAnyHeight,
} 
```

这些帮助有用？我在你的问题中遗漏了什么吗？

# c# - 将记录从 c# 数据表插入数据库

> ID：11140067
> 
> 赞同：0
> 
> 时间：2012-06-21T14:11:20.863
> 
> 标签：c#, database, list, datatable

我有这个数据表，实际上是一个数据表列表 `List<DataTable> lstDataSource`，现在对于列表中的每个表，我知道正好有 6 行，（周一到周六！），但是可以有任意数量的列（从 6 到 14，也就是说，员工每天工作的小时数！）所以我知道每个数据表中行和列的限制。我的观点是如何使用这个数据表列表来更新（而是插入）所有这些值到 read database table 中`EmpWorkSchedule`。我知道插入的总行数是`lstDataSource.Count * 6`对的吗？此外，对于任何没有值的列，（一些员工工作 6 小时，一些 7 小时等......）该行中的其他列将被设置为空。（它们在数据库中被定义为可为空的）。我希望我说清楚了。那么，我该怎么做呢？
另外，如果有什么不清楚的地方，请随时询问。

**编辑：**我有这个列表`DataTable` `List<DataTable> lstDataTable`，我想要的是将列表中每个表中的所有行插入到名为的数据库表`EmpWorkSchedule`中，每行中的所有值都是顺序的，即第一列对应于数据库中的第 1 列表之类的，好吗？但是现在所有行都有所有列的值，有些有 6，有些 7，有些 8.. 我想要的是对于列，数据行中没有值，应该在数据库表中保留为空，其余所有值都应插入。

另外，使用adapted 似乎不太可能，因为它与select 一起使用，我没有选择任何东西，我正在插入一些东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:06:10.647

也许您只需要循环您的 DataTable 并将每行记录保存在您的数据库中，例如：

你的数据表

```
Col1 |  Col2
abc  |  456 
def  |  789 
```

在您的代码背后执行以下操作：

```
foreach(DataRow row in YourDataTable.Rows)
{

  string myColumn1  = row["Col1"].ToString();  
  int mycolumn2 =  Convert.ToInt32(row["Col2"]);

  //Your Insert Statement
  //First Loop you will get  
  //myColumn1 = abc and myColumn2=456
  //2nd loop will be def and 789

} 
```

问候

# perl - 从具有固定种子的文件中选择随机行（伪随机）

> ID：11140069
> 
> 赞同：1
> 
> 时间：2012-06-21T14:11:26.637
> 
> 标签：perl, random

我想从一个文件中随机选择一些行（例如 20 行）并将其打印到另一个文件中，但我想固定一个种子，以便在输入文件相同的情况下获得相同的输出。

我发现选择几行的示例，它们的输出每次都不同，例如：

```
perl -e '$f="inputfile";$_=`wc -l $f`;@l=split( );$r=int rand(@l[0]);system("head -n$r $f|tail -20")'> outputfile 
```

而那些谈论固定种子和伪随机的只是为了打印数字，而不是从文件中提取行，或者只是提取一行。是否有 unix 命令或 perl 或类似代码中的某些代码？( `sort -R`, `--random-`&`shuf`不起作用（使用 Mac OS X 10.5.8））。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-20T07:45:03.720

您可以通过 srand(); 设置种子；（例如 srand(5)）获取 rand 的固定种子。

# php - 有两个自我提交的表格

> ID：11140073
> 
> 赞同：0
> 
> 时间：2012-06-21T14:11:39.867
> 
> 标签：php, forms

我是否可以在一个页面上有两个自我提交的表单。如果是，我如何为每个表单分配不同的代码块？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:17:16.400

有一个具有两个不同值的隐藏输入。

```
<form action="" ...>
<input type="hidden" name="form_no" value="0">
...
</form>

<form action="" ...>
<input type="hidden" name="form_no" value="1">
...
</form> 
```

在服务器端，根据不同`$_REQUEST['form_no']`

* * *

或者您也可以将其作为名称参数添加到提交元素中。

```
<input type="submit" name="form0"> 
```

用来`isset($_REQUEST['form0'])`区分。

* * *

另一种方法是附加一个 GET 参数来区分

```
<form action="<?php echo $_SERVER['PHP_SELF'];?>?form_no=0" ...>
...
</form>

<form action="<?php echo $_SERVER['PHP_SELF'];?>?form_no=1" ...>
...
</form> 
```

用来`$_GET['form_no']`区分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:32:26.800

```
<form action="action.asp" method="get">
  First name: <input type="text" name="fname" /><br />
  Last name: <input type="text" name="lname" /><br />
 <input type="submit" name="submit1" value="Submit" />
</form>

<form action="action.asp" method="get">
  First name: <input type="text" name="fname" /><br />
  Last name: <input type="text" name="lname" /><br />
 <input type="submit" name="submit2" value="Submit" />
</form>

<?php

if(isset($_GET['submit1'])){
// first form was submitted
}

if(isset($_GET['submit2'])){
// second form was submitted
}
?> 
```

在此示例中，每个表单都指定了不同的脚本，但请记住，您可以简单地对两个操作使用相同的 php 文件，为每个表单指定不同的代码块（即上面的 php 部分）。

有人可能有更好的答案，但这种方法在过去对我很有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:15:39.757

将您的第一个表单命名为 form_one，将第二个表单命名为 form_two。

```
<?php
if (isset($_POST['form_one'])) {
    // First form was submitted
}

if (isset($_POST['form_two'])) {
    // Second form was submitted
}
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T14:16:29.133

通过给它们不同的名称并保持它们的目标_blank，可以将两种形式放置在代码中

# windows - 在powershell的http请求中输入ip地址

> ID：11140076
> 
> 赞同：1
> 
> 时间：2012-06-21T14:11:43.997
> 
> 标签：windows, powershell

我正在尝试测试负载均衡器后面的网页的可用性。所以我想编写一个powershell脚本来分别从每个Web服务器加载一个页面。问题是服务器使用主机头，所以我不能手动指定 ip 地址，也不能只使用 url，因为它可能会负载平衡到不同的服务器。理想情况下，我正在寻找这样的东西。

```
$wc = New-Object net.webclient
$wc.downloadString("10.0.0.1", "http://test.com/home.html") 
```

但我不知道该怎么做。我更喜欢 powershell，但如果有另一个 Windows 实用程序可以完成这项工作，我会接受这个想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-31T23:23:21.453

我知道这是一个老问题，但我最近需要自己完成这个并且偶然发现了这个寻找解决方案。我没有在其他地方找到答案，但能够为自己发现它并想分享以防有人需要这样做。

您需要做的是在通过 IP 进行调用之前添加一个 Headers 值来指定您的主机：

```
$wc = New-Object net.webclient
$wc.Headers.Add("Host", "test.com")
$wc.DownloadString("http://10.0.0.1/home.html") 
```

这告诉 WebClient 调用将页面请求发送到哪个服务器，同时仍然确保请求成功解析，因为它也具有主机头信息。

*请记住，如果您根据自己的需要进行调整，每次进行 WebClient 调用时，Headers 值都会被重置。所以一定要同时执行 $wc.Headers.Add() 和 $wc.DownloadString() 。

# iphone - 在 xib 中定义的方法没有工作关闭

> ID：11140083
> 
> 赞同：0
> 
> 时间：2012-06-21T14:12:00.033
> 
> 标签：iphone, ios, xcode, xib, icarousel

我使用icarousel创建了coverflow效果，但是我没有在xib中以编程方式添加了两个按钮，并且我定义了出口和动作并为该按钮连接了..但是这些按钮显示为图像并且不起作用...这是我的代码.m 文件

```
@interface GoldViewController ()<UIActionSheetDelegate>

@property (nonatomic, assign) BOOL useButtons;

@end

@implementation GoldViewController

@synthesize carousel1;

-(IBAction)showhome:(id)sender{

ViewController *sec=[[ViewController alloc]initWithNibName:Nil bundle:Nil];
sec.modalTransitionStyle=UIModalTransitionStyleCoverVertical;
[self presentModalViewController:sec animated:YES];

} 

-(IBAction)showback:(id)sender{

CollectionsViewController *sec=[[CollectionsViewController alloc]initWithNibName:Nil bundle:Nil];
sec.modalTransitionStyle=UIModalTransitionStyleCoverVertical;
[self presentModalViewController:sec animated:YES];

}

#pragma mark -
#pragma mark View lifecycle

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
carousel1.type = iCarouselTypeCylinder;
}

- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{ 
return (interfaceOrientation != UIInterfaceOrientationPortraitUpsideDown);
}

- (NSUInteger)numberOfItemsInCarousel:(iCarousel *)carousel
{
return NUMBER_OF_ITEMS;
}

- (UIView *)carousel:(iCarousel *)carousel viewForItemAtIndex:(NSUInteger)index reusingView:(UIView *)view
{

UIImage *buttonImage=[NSArray arrayWithObjects:[UIImage imageNamed:@"ban.jpg"],
                      [UIImage imageNamed:@"pen.jpg"],
                      [UIImage imageNamed:@"ear1.jpg"],
                      [UIImage imageNamed:@"neck.jpg"],
                      [UIImage imageNamed:@"brac.jpg"],
                      [UIImage imageNamed:@"rings.jpg"],nil];

UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
button.frame = CGRectMake(0, 0, 250.0f, 320.0f);

[button setImage:(UIImage*)[buttonImage objectAtIndex:index] forState:UIControlStateNormal]; 

[button addTarget:self action:@selector(buttonTapped:) forControlEvents:UIControlEventTouchUpInside];
return button;

}

- (CGFloat)carouselItemWidth:(iCarousel *)carousel
{
return ITEM_SPACING;
}

- (BOOL)carousel:(iCarousel *)_carousel shouldSelectItemAtIndex:(NSInteger)index
{
if (index == carousel1.currentItemIndex)
{
    NSLog(@"Should select current item");
}
else
{
    NSLog(@"Should select item number %i", index);
}
return YES;
 }

- (void)carousel:(iCarousel *)_carousel didSelectItemAtIndex:(NSInteger)index
{
if (index == carousel1.currentItemIndex)
{
    //note, this will only ever happen if useButtons == NO
    //otherwise the button intercepts the tap event
    NSLog(@"Did select current item");
}
else
{
    NSLog(@"Did select item number %i", index);
}
 }

 @end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:06:06.147

确保 nib 文件的所有者肯定是 GoldViewController。检查您是否确实将按钮作为按钮而不是图像添加到笔尖。确保每个相关按钮上的 touchupinside 操作都连接到 nib 文件所有者中的 showhome 和 showback 操作。

如果所有这些都正常，那么当显示视图控制器视图时，iCarousel 的视图可能会覆盖您的按钮视图。（我似乎记得 iCarousel 没有在运行时将视图布置在与 nib 中定义的相同位置但不记得细节的一些问题）。要找出答案 - 在 vi​​ewWillAppear 方法中记录按钮和 iCarousel 视图的框架。

# tcl - TCL 脚本中的浮点异常

> ID：11140086
> 
> 赞同：0
> 
> 时间：2012-06-21T14:12:06.810
> 
> 标签：tcl

我正在使用 ns2 模拟器和 tcl script.on 执行以下代码，它引发了浮点异常错误。在我更改以下代码部分中的速率值之前

```
$ns duplex-link $n0 $n2 2.0Mb 10ms RED
$ns duplex-link $n1 $n2 2.0Mb 10ms DropTail
$ns duplex-link $n2 $n3 1.1Mb 20ms DropTail
$ns duplex-link $n3 $n2 1.2Mb 10ms DropTail 
```

它工作正常，但在更改为以下内容后，即在我使用变量`rate02,rate12,rate23,rate32`而不是值之后发生浮点异常。有人可以帮忙吗？

整个tcl代码如下：

```
 #Create a simulator object

    set ns [new Simulator]

    global set rate02 2.0Mb 
    global set rate12 2.0Mb
    global set rate23 1.1Mb
    global set rate32 1.2Mb

    #Define different colors for data flows (for NAM)
    $ns color 1 Blue
    $ns color 2 Red
    $ns color 3 Green

    #Open the NAM trace file
    set nf [open out.nam w]
    $ns namtrace-all $nf

    #Define a 'finish' procedure
    proc finish {} {
        global ns nf
        $ns flush-trace
        #Close the NAM trace file
        close $nf
        #Execute NAM on the trace file
        exec nam out.nam &
        exit 0
    }

    #Create four nodes
    set n0 [$ns node]
    set n1 [$ns node]
    set n2 [$ns node]
    set n3 [$ns node]

    #Create links between the nodes
    $ns duplex-link $n0 $n2 rate02 10ms RED
    $ns duplex-link $n1 $n2 rate12 10ms DropTail
    $ns duplex-link $n2 $n3 rate23 20ms DropTail
    $ns duplex-link $n3 $n2 rate32 10ms DropTail

        #Set Queue Size of link (n2-n3) to 10
        $ns queue-limit $n2 $n3 20
        $ns queue-limit $n3 $n2 22

        #Give node position (for NAM)
        $ns duplex-link-op $n0 $n2 orient right-down
        $ns duplex-link-op $n1 $n2 orient right-up
        $ns duplex-link-op $n2 $n3 orient right

        #Monitor the queue for link (n2-n3). (for NAM)
        $ns duplex-link-op $n2 $n3 queuePos 0.5

        #Setup a TCP connection
        set tcp1 [new Agent/TCP]
        $tcp1 set class_ 2
        $ns attach-agent $n0 $tcp1
        set sink [new Agent/TCPSink]
        $ns attach-agent $n3 $sink
        $ns connect $tcp1 $sink
        $tcp1 set fid_ 1
        #########################################
        #Setup a TCP connection
        set tcp3 [new Agent/TCP]
        $tcp3 set class_ 2
        $ns attach-agent $n3 $tcp3
        set sink2 [new Agent/TCPSink]
        $ns attach-agent $n2 $sink2
        $ns connect $tcp3 $sink2
        $tcp3 set fid_ 3

        #Setup a FTP over TCP connection
        set ftp3 [new Application/FTP]
        $ftp3 attach-agent $tcp3
        $ftp3 set type_ FTP
        ############################################
        #Setup a FTP over TCP connection
        set ftp1 [new Application/FTP]
        $ftp1 attach-agent $tcp1
        $ftp1 set type_ FTP

        #Setup a TCP connection
        set tcp2 [new Agent/TCP]
        $tcp2 set class_ 2
        $ns attach-agent $n1 $tcp2
        set sink [new Agent/TCPSink]
        $ns attach-agent $n3 $sink
        $ns connect $tcp2 $sink
        $tcp2 set fid_ 2

        #Setup a FTP over TCP connection
        set ftp2 [new Application/FTP]
        $ftp2 attach-agent $tcp2
        $ftp2 set type_ FTP

         proc openTrace { stopTime testName } {
            $self instvar ns_
            exec rm -f out.tr temp.rands
            set traceFile [open out.tr w]
            puts $traceFile "v testName $testName"
            $ns_ at $stopTime \
                "close $traceFile ; $self finish $testName"
            return $traceFile
        }
        proc traceQueues { node traceFile } {
            $self instvar ns_
            foreach nbr [$node neighbors] {
                $ns_ trace-queue $node $nbr $traceFile
                [$ns_ link $node $nbr] trace-dynamics $ns_ $traceFile
            }
        }

        #Schedule events for the CBR and FTP agents
        $ns at 0.1 "$ftp2 start"
        $ns at 1.0 "$ftp1 start"
        $ns at 1.0 "$ftp3 start"
        $ns at 4.0 "$ftp2 stop"
        $ns at 4.5 "$ftp1 stop"
        $ns at 4.5 "$ftp3 stop"

        #Detach tcp and sink agents (not really necessary)
        $ns at 4.5 "$ns detach-agent $n0 $tcp1 ; $ns detach-agent $n3 $sink"
        $ns at 4.5 "$ns detach-agent $n1 $tcp2 ; $ns detach-agent $n3 $sink"

        #Call the finish procedure after 5 seconds of simulation time
        $ns at 5.0 "finish"
        $ns run 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:26:17.533

除非那个“NS2”的东西重新定义了 Tcl 的[`global`](http://www.tcl.tk/man/tcl8.5/TclCmd/global.htm)命令，否则脚本应该是这样的：

```
#Create a simulator object

set ns [new Simulator]

set rate02 2.0Mb 
set rate12 2.0Mb
set rate23 1.1Mb
set rate32 1.2Mb

# ...

#Create links between the nodes
$ns duplex-link $n0 $n2 $rate02 10ms RED
$ns duplex-link $n1 $n2 $rate12 10ms DropTail
$ns duplex-link $n2 $n3 $rate23 20ms DropTail
$ns duplex-link $n3 $n2 $rate32 10ms DropTail

# ... 
```

换句话说，您的代码存在两个问题：

*   Tcl`global`命令的语义定义为`global varname ?varname ...?`，也就是说，它只是将传递给它的*名称**声明*为引用全局变量。因此，调用只声明名称“set”、“rate02”和“2.0Mb”来表示全局变量。很可能不是你想要的。*`global set rate02 2.0Mb`*
**   子`duplex-link`命令可能需要*一个值*作为它的“rate”参数，并且您正在向它传递*一个变量的名称。* 看起来，一些 NS2 代码然后尝试将这样的字符串解释为浮点值，但由于明显的原因而失败。因此，当您想将该变量的值传递给命令时，您必须取消引用该变量以获取其值。这是使用命令或使用语法`set varname`的速记符号完成的：（有关此的[更多信息](https://stackoverflow.com/q/7299320/720999)）。`$``$varname`*

 *看起来您应该从处理这些基础知识[的 Tcl 教程开始。](http://www.tcl.tk/man/tcl8.5/tutorial/tcltutorial.html)*

# c# - 仅在 VS2010 中搜索获取或设置属性的引用？

> ID：11140088
> 
> 赞同：6
> 
> 时间：2012-06-21T14:12:13.353
> 
> 标签：c#, visual-studio-2010, visual-studio

我使用 VS 2010 和 C#。当我想找到对方法或属性的所有引用时，我按`Shift+F12`. 可以仅找到已检查属性的获取或设置引用。

这是可能的？也许我应该安装任何扩展？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T14:24:40.417

穷人的方法是简单地删除/注释掉 getter 或 setter 并重新编译：所有错误都将成为您的参考。;)

编辑：不要删除它（这可能是无效的语法），而是将特定 get/set 的可见性更改为私有。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-29T08:14:51.907

我建议您评估[ReSharper](http://www.jetbrains.com/resharper/)产品，它具有极大增强 Visual Studio 的强大功能。

[Find Usages](http://www.jetbrains.com/resharper/features/navigation_search.html#Find_Usages)是您正在寻找的。

如果您发现 ReSharper 没问题（而且您会的！），那么在评估后继续购买许可证。

只要确保至少尝试一下！

# java - JMeter JavaSamplerClient 当前线程和所有线程

> ID：11140089
> 
> 赞同：3
> 
> 时间：2012-06-21T14:12:15.857
> 
> 标签：java, jmeter

我正在扩展 AbstractJavaSamplerClient 并创建一个自定义 Java 采样器。一切正常，但我想知道是否有办法获取当前线程号（或名称，线程独有的名称）和运行我的自定义采样器的所有线程的数量。

我有一个“线程组”和一个“Java 请求”运行我的自定义 java 采样器客户端。例如，我将“线程数”设置为 5。我需要在我的自定义 java 采样器中访问当前线程的数量和所有线程的数量（在本例中为 5）。

有没有一种通用的方法来做到这一点？

提前致谢。艾库特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T13:00:55.067

是的，Jmeter 中有这样的属性。例如，如果您想为线程添加名称，包括它们的编号（并将其保存到属性中），它将是这样的：

```
${__setProperty(ThreadName,${__javaScript("HttpThread_" + ${__threadNum},)},)} 
```

然后您可以使用以下命令阅读：

```
${__property(ThreadName,,)} 
```

或单独的线程 ID，这将始终是唯一的`${__threadNum}`

如果您询问如何在 jmeter 中获取该属性，而不是在您的自定义示例 java 代码中，这就是答案。

# c# - 添加帮助按钮，但保持最大化和最小化

> ID：11140090
> 
> 赞同：10
> 
> 时间：2012-06-21T14:12:25.530
> 
> 标签：c#, winforms

我希望能够将帮助按钮添加到我的 winform 上，但保留最大化和最小化按钮，但 Windows 标准是禁用两者才能显示帮助按钮。

已经有一个类似的问题： [如何包含帮助'？在winform的标题栏中](https://stackoverflow.com/questions/1474663/how-to-include-help-in-title-bar-of-winform)-但在那个问题中，提出问题的人满足于删除这两个按钮以显示帮助。

有没有我可以同时拥有帮助、最大、最小和关闭按钮的地方？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T16:55:00.187

Windows 不支持同时显示两者。一种解决方法是提供您自己的按钮来触发相同的操作。把它放在靠近右上角的地方。您可以通过向自己发送 WM_SYSCOMMAND 消息来触发此操作，就像标准帮助按钮一样。像这样：

```
 private void Help_Click(object sender, EventArgs e) {
        Help.Capture = false;
        SendMessage(this.Handle, WM_SYSCOMMAND, (IntPtr)SC_CONTEXTHELP, IntPtr.Zero);
    }

    private const int WM_SYSCOMMAND = 0x112;
    private const int SC_CONTEXTHELP = 0xf180;
    [System.Runtime.InteropServices.DllImport("user32.dll")]
    private static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wp, IntPtr lp); 
```

假设按钮的名称是“帮助”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:22:06.083

一种方法是绘制自己的边框。

```
FormBorderStyle = None 
```

现在构建您自己的字幕区域。这不是微不足道的，因为您必须处理拖动调整大小事件、透明度（如果您想要圆角等）。

# java - 如何在 jtable 中配置 jcombobox 以获取表达式

> ID：11140101
> 
> 赞同：3
> 
> 时间：2012-06-21T14:12:56.587
> 
> 标签：java, jtable, jcombobox, tablecelleditor

我无法使用 jcombobox 配置 jtable，我看过各种示例但没有成功。我有一个包含 3 列的表格和每个单元格的 Jcombobox。在第一个和最后一个 JCombobox 中有 Sports，在中央有一个 Criteria。

对于每一行，我必须使用第 3 列的值来制作表达式`(Sport s1, Criteria c, Sport s2);

我尝试使用自定义表模型，但使用 jcombobox 我不知道如何配置

```
@Override
        public Object getValueAt(int arg0, int arg1) {
            // TODO Auto-generated method stub
            return null;
        } 
```

和

```
public Object setValueAt(int arg0, int arg1) {
                // TODO Auto-generated method stub
                return null;
            } 
```

使用 JCombobox 选项获取和设置值。

`

我使用这个模型来实现我的表：

```
class MyTableModel extends AbstractTableModel {
        private static final long serialVersionUID = 1L;
        int numSports = DataSavedSports.loadNumeroSports();
        private final List<Sport> objects = DataSavedSports
                .loadListSports();

        private final String[] columnNames = { "Name Sport 1", "Criteria",
                "Name Sport 2" };

        private final Class<?>[] metaModell = new Class[] { String.class,
                Integer.class };

        public int getColumnCount() {
            return columnNames.length;
        }

        public int getRowCount() {
            return objects.size();
        }

        @Override
        public String getColumnName(int col) {
            return columnNames[col];
        }

        private Sport getRow(int row) {
            return objects.get(row);
        }

        @Override
        public Class<?> getColumnClass(int c) {
            if (c < metaModell.length)
                return metaModell[c];
            return Object.class;
        }

        @Override
        public boolean isCellEditable(int row, int col) {
            return true;
        }

        public List<Sport> getJobs() {
            return objects;
        }

        public void addRow(Sport v) {
            this.objects.add(v);
            fireTableDataChanged();
        }

        @Override
        public Object getValueAt(int arg0, int arg1) {
            // TODO Auto-generated method stub
            return null;
        }
    } 
```

我用来设置 Jcombobox 的方法是这样的

```
 public void setColumnSports1(JTable table, TableColumn ColumnLav1) {
        // Set up the editor for the sport cells.
        final List<Sport> ListSports = DataSavedSports.loadListSports();
        final JComboBox comboBox1 = new JComboBox();
        for(Sport l : ListSports){
            comboBox1.addItem(l.getIdSport());
        }

        comboBox1.addItemListener(new ItemListener(){
              public void itemStateChanged(ItemEvent ie){
                  String str = (String)comboBox1.getSelectedItem();

                  System.out.println("TESTTTT"+str);
                  }
              });

        ColumnLav1.setCellEditor(new DefaultCellEditor(comboBox1));

        // Set up tool tips for the sport cells.
        DefaultTableCellRenderer renderer = new DefaultTableCellRenderer();
        renderer.setToolTipText("Click for combo box");
        ColumnLav1.setCellRenderer(renderer);
    } 
```

附言

我必须使用 JFrame 中的表并获取所选 Jcombobox 项的数据，因此缺少多重继承，是另一个问题，因为覆盖了各种组件。

# eclipse - 以编程方式重新启动（或重新加载）Eclipse-CS

> ID：11140104
> 
> 赞同：8
> 
> 时间：2012-06-21T14:13:05.767
> 
> 标签：eclipse, checkstyle

我正在尝试从代码（在 Eclipse 运行时）重新配置 Eclipse（Eclipse-CS）的 CheckStyle 插件。到目前为止，我发现这样做的唯一方法是用配置替换 XML 文件并手动重新加载配置。

替换 XML 文件不是我希望的优雅解决方案，但它有效；但是我仍然需要一种让 Eclipse-CS 实际加载配置文件的方法。

我一直在寻找一种方法来实现这一目标，但我没有想法。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-12-29T21:17:37.853

**Checkstyle Preferences 页面**右上角包含一个小刷新**按钮**。修改 checkstyle.xml 或 suppresss.xml 后点击按钮，将使用新配置。

[![Checkstyle 首选项刷新按钮](../Images/f62740f980238a1bd6338253e633e17a.png)](https://i.stack.imgur.com/pc4mF.jpg)
[（来源：[rolf-engelhard.de](http://rolf-engelhard.de/wp-content/uploads/2012/11/checkstyle-refresh-cache.jpg)）]

参考：[http ://rolf-engelhard.de/2012/11/clearing-checkstyles-cache-in-eclipse](http://rolf-engelhard.de/2012/11/clearing-checkstyles-cache-in-eclipse)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-30T21:23:14.437

多年来，我一直在为这个 eclipse-cs 的缺点而苦苦挣扎，到目前为止，我确信这确实是不可能的。您必须自己将此功能添加到 eclipse-cs 代码中，看起来如此。

对前景黯淡感到抱歉。“不能做”并不是您真正想要的答案，但它仍然可以节省一些在谷歌上寻找解决方案的人。

# java - IntelliJ Idea with Git：当自动合并崩溃时，如何继续手动合并

> ID：11140106
> 
> 赞同：20
> 
> 时间：2012-06-21T14:13:26.193
> 
> 标签：java, git, ide, merge, intellij-idea

我将 IntelliJ Idea 与 Git 一起使用。当我从存储库中提取时，出现以下错误：

“ ...CONFLICT（内容）：服务器中的合并冲突...”

然后拉失败。

问题是：

1.  IntelliJ Idea 是否显示任何确切发生的日志？我怎么看？
2.  如何从同一点（失败的地方）继续手动合并？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-21T14:28:42.157

看起来您在合并期间遇到了冲突。转到`Changes`视图并查看是否有任何未合并的文件。然后调用`Resolve Conflicts`，从您的更改和他们的更改中选择要获取的内容，然后提交。

您可能还想尝试`Update Project`从被跟踪的分支中进行更智能的拉取。

# css - 一致的垂直对齐

> ID：11140108
> 
> 赞同：0
> 
> 时间：2012-06-21T14:13:28.823
> 
> 标签：css, modal-dialog

我有这个，试图为网站制作一个模式窗口：http: [//jsfiddle.net/qHqvn/](http://jsfiddle.net/qHqvn/)

我想让它在浏览器、IE6、Firefox 和 Chrome 上看起来一致。但是我做错了，因为在每个浏览器中它的显示方式都不同。我希望红色框始终占据屏幕宽度和高度的 50%，并且在用户关闭它之前不要让用户与下面的内容进行交互。

在 chrome 中，它的行为确实符合我的预期，但在 Firefox 中，该框永远不是我想要的，它水平居中但不是垂直居中，如果我调整导航器窗口的大小，它会被推得更远。在 IE6 中，好吧，没什么好说的，它只是无法完成这项工作。

无论如何，它的行为不正常是我的错，但我只是不知道我做错了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:21:32.490

CSS 中的所有边距都基于*width*。因此，当您的`margin-left: -25%`作品和盒子水平居中时，该`margin-top: -25%`属性使用了盒子宽度的 25%。

另请参阅[此答案](https://stackoverflow.com/questions/10629294/css-fluid-layout-margin-top-based-on-percentage-grows-when-container-width-incr)。

# python - Haystack 和 Solr - 无法清除索引

> ID：11140116
> 
> 赞同：0
> 
> 时间：2012-06-21T14:13:53.630
> 
> 标签：python, django

我想为我的网络应用程序实现搜索功能。我选择 Haystack 和 Solr。遵循文档中的过程后。我尝试重建 solr 索引（ python manage.py rebuild_index ），但出现以下错误。我错过了什么？

```
 WARNING: This will irreparably remove EVERYTHING from your search index in connection 'default'.
   Your choices after this are to restore from backups or rebuild via the `rebuild_index` command.
   Are you sure you wish to continue? [y/N] y

   Removing all documents from your index because you said so.
   Failed to clear Solr index: [Errno 10061] No connection could be made because the   target machine actively refused it
   All documents removed.
   Indexing 2 fincribs.
   Failed to add documents to Solr: [Errno 10061] No connection could be made because the target machine actively refused it 
```

干草堆设置

```
 HAYSTACK_CONNECTIONS = {
    'default': {
        'ENGINE': 'haystack.backends.solr_backend.SolrEngine',
        'URL': 'http://127.0.0.1:8983/solr'
        # ...or for multicore...
        # 'URL': 'http://127.0.0.1:8983/solr/mysite',
    },
 } 
```

楷模

```
 class Fincrib(models.Model):
           user=models.ForeignKey(User)
           title=models.CharField(max_length=250, unique=True)
           address=models.CharField(max_length=200)
           city=models.CharField(max_length=200)
           state=models.CharField(max_length=200)
           main_view=models.ImageField(upload_to="photos",blank=True, null=True)
           side_view=models.ImageField(upload_to="photos",blank=True, null=True)
           pub_date=models.DateTimeField()

           def __unicode__(self):
               return self.title
          def get_absolute_url(self):
              return self.title 
```

搜索索引.py

```
 class FincribIndex(indexes.SearchIndex, indexes.Indexable):
               text=indexes.CharField(document=True, use_template=True)
               address=indexes.CharField(model_attr='address')
               city=indexes.CharField(model_attr='city')
               state=indexes.CharField(model_attr='state')
               pub_date=indexes.DateTimeField(model_attr='pub_date')

               def get_model(self):
                   return Fincrib
               def index_queryset(self):
                   return self.get_model().objects.filter(pub_date__lte=datetime.datetime.now()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:48:32.247

然后首先，尝试让[solr 运行](http://wiki.apache.org/solr/SolrTomcat#Tomcat_on_Windows)。

# php - 带有数组的mysql语法可能需要加入？

> ID：11140117
> 
> 赞同：0
> 
> 时间：2012-06-21T14:13:57.603
> 
> 标签：php, mysql, json, join, pdo

我对mysql还是很陌生，想寻求帮助。

**用户表**

```
idusers      name           other_info
1           Test Last          email
2           True Blue          phone
3           False Name         phone
4           Purpose Test       email 
```

**喜欢桌子**

```
id          idusers         iditems
1             1                3
2             1                4
3             1                4
4             2                3
5             3                3 
6             2                1 
```

目前我在 mysql 中设置了这个表，idusers 应该在我的语法中匹配，以获取有关喜欢这些特定项目的特定用户的信息。

我目前有这样的东西

`$liked_users = $dbh->query("SELECT users.idusers,likes.idusers FROM users,likes WHERE users.idusers = likes.idusers");`

这应该匹配吧？

但我正在尝试输出一些 JSON 数组，其中用户的这些数据应该属于某些 iditems

```
 while($row = $items-> fetch(PDO::FETCH_ASSOC)){
        //$get_liked_idusers = $liked_idusers->fetchAll(PDO::FETCH_ASSOC);
        //$liked_users ->execute(array($get_liked_idusers));

    $json['data'][] = array(
    'id'=>$row['iditems'],
    "likes" => array(
    "data"=>$liked_users -> fetchAll(PDO::FETCH_ASSOC) //users should be displayed only if they liked the item that is going through this while loop only.
    )
    );
} 
```

所以我试图输出有关`"data"`数组内用户的信息，它应该遵循 iditems。而且我不确定我会怎么做，因为我不认为`AND iditems = ?"`在我的第一个`$liked_users`mysql 语法中添加 " 不会像它要求获得两个不同的表一样起作用。

我希望我的问题很清楚？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:20:31.497

你可以做这样的事情

```
$liked_users = $dbh->query("SELECT users.idusers,likes.idusers,likes.iditems FROM users,likes WHERE users.idusers = likes.idusers") 
```

因为你的查询应该有那么多你想要循环通过你的 json 数据的字段

# java - 需要一种高效的算法来解决这种复杂的结构

> ID：11140119
> 
> 赞同：1
> 
> 时间：2012-06-21T14:14:08.073
> 
> 标签：java, c, algorithm, multidimensional-array

问题陈述是：

给定二维数组，例如打印输出

如果 4 行 6 列，输出将是：

```
 1    2    3    4    5    6 
        16   17   18   19   20   7
        15   24   23   22   21   8
        14   13   12   11   10   9 
```

我试过它看起来像正方形中的正方形但是当我尝试这个问题时，我放了很多 while 和 if 循环但没有得到确切的答案。如果row和columns增加了怎么处理呢？

这**不是**家庭作业。我正在学习解决复杂的结构，所以我需要通过一些指导来理解它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:33:54.770

这是一个方形螺旋。
你可以在这里阅读： http://metacpan.org/pod/Math::PlanePath:: [SquareSpiral](http://metacpan.org/pod/Math::PlanePath::SquareSpiral)

[公式](http://metacpan.org/pod/Math%3a%3aPlanePath%3a%3aSquareSpiral#FORMULAS)有解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:11:48.740

使用相同的“螺旋式行走”算法的另一种解决方案：

```
public class SpiralArray {
    private int[][] cells;
    private int rows;
    private int cols;

    private enum Direction {
        LEFT,
        DOWN,
        RIGHT,
        UP
    }

    public SpiralArray(int cols, int rows) {
        this.cols = cols;
        this.rows = rows;
        cells = new int[cols][rows];
        int count = 0;
        Direction direction = Direction.RIGHT;
        int x=0, y=0;
        while (count++ < cols*rows) {
            cells[x][y]=count;
            switch (direction) {
            case LEFT: 
                if ((--x<0) || (cells[x][y]>0)) {
                    y--;
                    x++;
                    direction = Direction.UP;
                }
                break;
            case RIGHT: 
                if ((++x==cols) || (cells[x][y]>0)) {
                    y++;
                    x--;
                    direction = Direction.DOWN;
                }
                break;
            case UP: 
                if ((--y<0) || (cells[x][y]>0)) {
                    x++;
                    y++;
                    direction = Direction.RIGHT;
                }
                break;
            case DOWN: 
                if ((++y==rows) || (cells[x][y]>0)) {
                    x--;
                    y--;
                    direction = Direction.LEFT;
                }
                break;
            }
        }
    }

    int get(int i, int j) {
        return cells[i][j];
    }

    @Override
    public String toString() {
        StringBuffer sb = new StringBuffer();
        for (int y=0; y<rows; y++) {
            for (int x=0; x<cols; x++) {
                sb.append(cells[x][y]).append("\t");
            }
            sb.append("\n");
        }
        return sb.toString();
    }

    public static void main(String[] args) {
        System.out.println(new SpiralArray(6, 4));
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T14:39:48.633

这是我带来的。

变量名称可能是上下颠倒的，有很多东西需要增强、删除、修改，但它是有趣的游戏。

```
public class Test {
    public static void main(String[] args) {
        int x = 2;
        int y = 2;
        int idx = 1;
        int[][] array = new int[x][y];
        int yUpIdx = y-1;
        int yDownIdx = 0;
        int xLeftIdx = 0;
        int xRightIdx = x-1;

        while (idx < x*y) {
            for (int i = xLeftIdx; idx <= x*y && i <= xRightIdx; i++) {
                array[i][yDownIdx] = idx++;
            }
            yDownIdx++;
            for (int j = yDownIdx; idx <= x*y &&  j <= yUpIdx; j++) {
                array[xRightIdx][j] = idx++;
            }
            xRightIdx--;
            for (int i = xRightIdx; idx <= x*y &&  i>=xLeftIdx ; i--) {
                array[i][yUpIdx] = idx++;
            }
            yUpIdx--;
            for (int j = yUpIdx; idx <= x*y &&  j>=yDownIdx ; j--) {
                array[xLeftIdx][j] = idx++;
            }
            xLeftIdx++;
        }
        for (int j = 0; j < y; j++) {
            for (int i = 0 ; i < x; i++) {
                if ((array[i][j]+"").length() < 2) System.out.print(" "); 
                System.out.print(array[i][j]+" ");
            }
            System.out.println("");
        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T14:43:12.500

我想您可以创建一个穿过您的阵列的蠕虫：

```
public class Worm {
    public static void main(String[] args) {
        int[][] outArray = runWormRun(6, 4);
        printArray(outArray);
    }

    private static void printArray(int[][] outArray) {
        for (int j = 0; j < outArray[0].length; j++) {
            for (int i = 0; i < outArray.length; i++) {
                System.out.print(String.format("%02d ", outArray[i][j]));
            }
            System.out.println();
        }
    }

    private static int[][] runWormRun(int w, int h) {
        int[][] output = new int[w][h];

        int counter = 0;
        int wormX = 0, wormY = 0;
        int minX = 0, maxX = w - 1, minY = 0, maxY = h - 1;
        int dirX = 0, dirY = 1;
        while (counter < w * h) {
            output[wormX][wormY] = ++counter;
            // let the worm walk
            wormX += dirX;
            wormY += dirY;
            // update direction of worm for next iteration
            if ((dirX != 0 && dirY != 1) && wormX == minX && wormY == minY) { // upper left border (and not yet rotated correctly
                dirX = 0; dirY = 1; minY++;
            }
            if ((dirX != -1 && dirY != 0) && wormX == maxX && wormY == minY) { // upper right border
                dirX = -1; dirY = 0; maxX--;
            }
            if ((dirX != 0 && dirY != -1) && wormX == maxX && wormY == maxY) { // lower right border
                dirX = 0; dirY = -1; maxY--;
            }
            if ((dirX != 1 && dirY != 0) && wormX == minX && wormY == maxY) { // lower left border
                dirX = 1; dirY = 0; minX++;
            }
        }
        return output;
    }
} 
```

是的，我的虫子朝另一个方向移动，因为我想让你也想一想，明白我在做什么。因为我认为这是家庭作业。（如果这是真的，请您考虑在您的问题中添加“作业”标签吗？）

编辑：哎呀，不完全是，它应该做什么。现在没时间，晚上再看看。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-21T14:30:52.840

我希望这个想法可以让你开始：

```
void solve2DArray(bool[][] 2DArray, int i, int j, int numMoves)
{                               
     2DArray[i][j] = true;   // Mark current position as visited
     // Perhaps a print statement here
     if(right is not visited and can move right)
       // move right
     else if(down is not visited and can move down)
       // move down
     // ...
     // ...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-06-21T14:31:33.377

我可能会创建一个 NxM 整数数组，初始化为零。设置`nextNumber`为1、0,0`position`和`direction`。`left-to-right`检查是否`position`在数组之外，并检查单元格`position`是否为零。如果`position`没问题并且单元格为零，则在此处存储`nextNumber`并递增`nextNumber`。然后，基于`direction`，递增`position`。

如果单元格 at`position`不为零，或者其中一个索引`position`< 0 或 >= 数组大小，则需要更改方向。首先备份`position`1，使用现有方向。然后选择一个`direction`与当前值成 90 度的新值， increment `position`，然后重试。

当你不能去任何方向时，你就完成了——打印数组。

（可能是我在上面处理不当的一些边界条件，但这是一种基本算法。）

`position`（提示：编写一个子程序以基于.递增/递减`direction`。）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-21T15:02:46.603

另一种做法：

```
public class Test {
  enum Dir {
    R(0,1), L(0,-1), D(1,0), U(-1,0);
    public final int rowd, cold;
    private Dir(int rowd, int cold) { this.rowd = rowd; this.cold = cold; }
    public Dir next() { return values()[(ordinal()+1) % values().length]; }
  }
  static final int rows = 4, cols = 6;
  static final int[][] grid = new int[rows][cols];
  static int row, col = -1, step;

  public static void main(String[] args) {
    Dir dir = Dir.R;
    moving: while (true) {
      for (int i = 0; i < Dir.values().length; i++, dir = dir.next())
        if (move(dir)) continue moving;
      break;
    }
    for (int[] row : grid) System.out.println(Arrays.toString(row));
  }
  static boolean move(Dir dir) {
    final int newRow = row+dir.rowd, newCol = col+dir.cold;
    if (newRow >= 0 && newRow < rows && newCol >= 0 && newCol < cols
        && grid[newRow][newCol] == 0)
    {
      row = newRow; col = newCol; grid[row][col] = ++step; return true;
    }
    return false;
  }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-07-04T09:04:20.880

**方形螺旋**

这是一个在单个函数中执行最佳的紧凑解决方案（它只访问数组中的每个位置*一次*）：

```
static int anMoveXDir[] = { 1, 0, -1,  0 };
static int anMoveYDir[] = { 0, 1,  0, -1 };

static void DoSpiral(int *panGrid, int nWidth, int nHeight)
{
    int nSideSel, nSideIdx, nMoveDir, nXPosn, nYPosn, nCounter;
    int anSideLen[2];

    anSideLen[0] = nWidth;
    anSideLen[1] = nHeight - 1;

    nMoveDir = 0;     /* start off at (0, 0) in array, */
    nXPosn   = 0;     /* facing east, and count from 1 */
    nYPosn   = 0;
    nCounter = 1;

    for (nSideSel = 0; anSideLen[nSideSel & 1]; anSideLen[nSideSel++ & 1]--)
        for (nSideIdx = anSideLen[nSideSel & 1]; nSideIdx; nSideIdx--)
        {
            panGrid[(nYPosn * nWidth) + nXPosn] = nCounter++;

            if (nSideIdx == 1)
                nMoveDir = (nMoveDir + 1) & 3;

            nXPosn += anMoveXDir[nMoveDir];
            nYPosn += anMoveYDir[nMoveDir]; 
        }
} 
```

该算法适用于给定一个具有宽度`x`和高度的矩形或正方形数组的简单规则`y`，然后可以使用以下步骤完成遍历数组以创建方形螺旋：

```
x + (y - 1) + (x - 1) + (y - 2) + (x - 2) + (y - 3) + (x - 3) + ... + 0 
```

上面的函数只是遵循上面的顺序。它从面向东的阵列的左上角开始，步行`x`台阶，向右转 90 度，步行`(y - 1)`台阶，向右转 90 度，步行`(x - 1)`台阶等，直到其中一个`x`或`y`为零，以先到者为准。

您可以通过将其插入到下面的测试程序中来测试上面的功能：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define GRID_WIDTH    7
#define GRID_HEIGHT  11

void main()
{
    int nXPosn, nYPosn;
    int anGrid[GRID_WIDTH * GRID_HEIGHT];
    int *pnValue;

    DoSpiral(anGrid, GRID_WIDTH, GRID_HEIGHT);

    for (pnValue = anGrid, nYPosn = 0; nYPosn < GRID_HEIGHT; nYPosn++, printf("\n"))
        for (nXPosn = 0; nXPosn < GRID_WIDTH; printf("%4i", *pnValue++), nXPosn++);
} 
```

输出将如下所示（对于上述程序中所示的 7x11 网格）：

```
 1   2   3   4   5   6   7
32  33  34  35  36  37   8
31  56  57  58  59  38   9
30  55  72  73  60  39  10
29  54  71  74  61  40  11
28  53  70  75  62  41  12
27  52  69  76  63  42  13
26  51  68  77  64  43  14
25  50  67  66  65  44  15
24  49  48  47  46  45  16
23  22  21  20  19  18  17 
```

# android - 不会从 TabHost 中调用 Android Activity.onWindowFocusChanged

> ID：11140120
> 
> 赞同：2
> 
> 时间：2012-06-21T14:14:08.120
> 
> 标签：android, android-activity, overriding, android-tabhost

我正在努力解决在我的自定义 Activity 类中没有调用 .onWindowFocusChanged() 的问题。我的设置：

TabHost 中的两个选项卡（包含 Activity_1 和 Activity_2），其中默认选择第二个选项卡：

```
tabHost.setCurrentTab(currentTabIndex); 
```

在这两个活动中，我添加了 onWindowFocusChanged() 覆盖（因为我需要在布局完成绘制后执行计算）：

```
@Override
public void onWindowFocusChanged(boolean hasFocus)
{
    super.onWindowFocusChanged(hasFocus);
} 
```

问题：当默认选择第二个选项卡并单击第一个选项卡时，onWindowFocusChanged() 永远不会在 Activity_1 （与第一个选项卡关联）中调用。这两个活动都扩展了正常的活动类。

任何有关如何解决此问题的线索将不胜感激！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T14:29:10.670

如果您需要等到特定视图被绘制然后进行计算，您可以使用 viewTreeObserver 来监听布局更改并在那里进行计算。像这样使用它：

```
ViewTreeObserver vto = mainLayout.getViewTreeObserver();
vto.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
public void onGlobalLayout() {
    // remove the listener so it won't get called again if the view layout changes
    mainLayout.getViewTreeObserver().removeOnGlobalLayoutListener(this);
    // add your calculations here
}} 
```

**编辑：**

*感谢 Edison 提供的更多详细信息。*

对于那些想要支持**API < 16**的人，你可以这样做

```
if (Build.VERSION.SDK_INT >= 16) {     
    mainLayout.getViewTreeObserver().removeOnGlobalLayoutListener(this); 
} else { 
    mainLayout.getViewTreeObserver().removeGlobalOnLayoutListener(this); 
} 
```

# c# - C# 反射 if：0 等于 1？

> ID：11140125
> 
> 赞同：3
> 
> 时间：2012-06-21T14:14:22.377
> 
> 标签：c#, reflection, if-statement, reflection.emit, system.reflection

我有问题。这是我的代码：

```
var method = new DynamicMethod("dummy", null, Type.EmptyTypes);
var g = method.GetILGenerator();
g.DeclareLocal(typeof(int));

Label inequality = g.DefineLabel();
Label equality = g.DefineLabel();
Label end = g.DefineLabel();

g.Emit(OpCodes.Ldstr, "string");
g.Emit(OpCodes.Ldstr, "string");
g.Emit(OpCodes.Call, typeof(String).GetMethod("op_Equality", new Type[]{typeof(string), typeof(string)}));
g.Emit(OpCodes.Stloc_0);
g.Emit(OpCodes.Ldloc_0);
g.Emit(OpCodes.Call, typeof(Console).GetMethod("WriteLine", new Type[]{typeof(int)}));
g.Emit(OpCodes.Ldloc_0);
g.Emit(OpCodes.Ldc_I4_1);
g.Emit(OpCodes.Ceq);
g.Emit(OpCodes.Brtrue_S, equality);
g.Emit(OpCodes.Brfalse_S, inequality);
g.MarkLabel(inequality);
g.Emit(OpCodes.Ldstr, "Specified strings are different.");
g.Emit(OpCodes.Call, typeof(Console).GetMethod("WriteLine", new Type[]{typeof(string)}));
g.Emit(OpCodes.Br_S, end);
g.MarkLabel(equality);
g.Emit(OpCodes.Ldstr, "Specified strings are same.");
g.Emit(OpCodes.Call, typeof(Console).GetMethod("WriteLine", new Type[] { typeof(string) }));
g.Emit(OpCodes.Br_S, end);
g.MarkLabel(end);
g.Emit(OpCodes.Ret);

var action = (Action)method.CreateDelegate(typeof(Action));
action(); 
```

这是我的结果：

```
1
Specified strings are different. 
```

但是为什么输出错误呢？Ceq 指令将 1 作为 op_Equation 的结果与堆栈顶部的 0 进行比较。1**不等于**0。那为什么会这样呢？错误在哪里？请帮我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:25:47.033

之后`g.Emit(OpCodes.Brtrue_S, inequality);`，需要手动跳转到“相等”语句。否则无论如何它都会执行下一条指令。因此，您需要在其后插入以下行：

```
g.Emit(OpCodes.Br_S, equality); 
```

`equality`此外，当它被声明为下一条指令时，跳转到标签是没有意义的。所以删除它。

所以该部分将如下所示：

```
g.Emit(OpCodes.Ceq);

g.Emit(OpCodes.Brtrue_S, inequality); // if true goto inequality
g.Emit(OpCodes.Br_S, equality); // else goto equality

g.MarkLabel(inequality);            
g.Emit(OpCodes.Ldstr, "Specified strings are different.");
g.Emit(OpCodes.Call, typeof(Console).GetMethod("WriteLine", new Type[]{typeof(string)}));
g.Emit(OpCodes.Br_S, end); // goto end

g.MarkLabel(equality);
g.Emit(OpCodes.Ldstr, "Specified strings are same.");
g.Emit(OpCodes.Call, typeof(Console).GetMethod("WriteLine", new Type[] { typeof(string) }));

g.MarkLabel(end);
g.Emit(OpCodes.Ret); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T14:18:15.817

你的分支是紧跟在声明后面的标签“不平等”。所以无论你是否分支，这都是将被调用的代码。您应该分支到“平等”标签。

此外，您的行`g.Emit(OpCodes.Brfalse_S, equality);`是毫无意义的，因为它永远不会到达 - 您在前面的语句中跳过它。一旦逻辑固定，你的“不平等”标签实际上不会在任何地方使用，所以你也可以放弃它。

# c# - Silverlight 中的循环队列功能

> ID：11140128
> 
> 赞同：1
> 
> 时间：2012-06-21T14:14:36.490
> 
> 标签：c#, silverlight, queue, circular-buffer

我正在 Silverlight 3.0 中制作应用程序 在该应用程序中，我想实现如下功能：我必须维护值的集合。我不断地从一端添加该集合中的值并从另一端删除值。意味着假设我想维护一个包含 3000 个值的集合。如果我在该集合中添加一个值，则应删除一个值，以便我只有 3000 个值的集合。我想使用“循环队列” 那么循环队列的 Silverlight 中是否有任何功能？还是有任何有效的逻辑来代替循环队列？请帮助我。在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:25:31.040

我不熟悉任何特定术语“循环队列”，但您可以轻松创建自己的：

```
public class CircularQuene<T> : List<T>
{
    public CircularQuene(int maxCount)
    {
        count = maxCount;
    }

    new public void Add(T variable)
    {
        base.Add(variable);
        if (Count > count)
        {
            RemoveAt(0);
        }
    }

    private int count;
    public int MaxCount
    {
        get
        {
            return count;
        }
        set
        {
            count = value;
        }
    }
} 
```

有点粗糙，但应该适合您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:32:24.890

您可能想使用内置类并围绕它`Queue`实现一个**包装器：**

```
public class CircularQueue
{
  private int totalItems;
  private Queue<object> queue = new Queue<object>();

  public CircularQueue(int maxCount)
  {
    this.totalItems = maxCount;
  }

  /// <summary>
  /// Get first object from queue.
  /// </summary>
  public object Dequeue()
  {
    // ToDo: You might want to check first if the queue is empty to avoid a InvalidOperationException
    object firstObject = this.queue.Dequeue();
    return firstObject;
  }

  public void EnQueue(object objectToPutIntoQueue)
  {
    if (this.queue.Count >= this.totalItems)
    {
      object unusedObject = this.queue.Dequeue();

      // ToDo: Cleanup the instance of ununsedObject.
    }

    this.queue.Enqueue(objectToPutIntoQueue);
  }
} 
```

# c# - 使用正则表达式验证输入

> ID：11140129
> 
> 赞同：0
> 
> 时间：2012-06-21T14:14:37.737
> 
> 标签：c#, regex

我需要验证我的应用程序的输入。输入是一个格式化的字符串，可能包含日期的一部分，例如：

```
{0:yy}{0:MM}{0:dd}_{0:hh}{0:mm}{0:ss}-SOME OTHER TEXT
sometext{0:yyyy}{0:MM}{0:dd}mORETEXT 
```

输入不必包含日期的这些部分，但如果包含，我需要它们是`String.Format()`方法可以使用的有效格式项。我相信我应该验证使用`Regular Expressions`，但我不擅长它。

能否请你帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:43:12.317

鉴于我们通过评论来回反馈，我认为您正在寻找的是：

```
 Regex curlyThings = new Regex(@"\{0:.*?\}");
        Regex kosherCurlyThings = new Regex(@"\{0:(yy|yyyy|MM|dd|hh|mm|ss)\}");

        MatchCollection matchCollection = curlyThings.Matches("CG{0:yyyy}-{0:MM}-{0:dd}asdf{0:GARBAGE}.csv");
        foreach(Match match in matchCollection)
        {
            if(!kosherCurlyThings.IsMatch(match.Value))
            {
                Console.WriteLine("{0} isn't kosher!", match.Value);
            }                
        } 
```

# linux - pgmagick 安装在 Linux 上

> ID：11140131
> 
> 赞同：11
> 
> 时间：2012-06-21T14:14:40.157
> 
> 标签：linux, pgmagick

我试图在 CentOS 上安装 pgmagick。

运行后`pip install pgmagick`我得到一些错误。在我检查了日志文件后，这就是我得到的：

```
 Running setup.py egg_info for package pgmagick
    Traceback (most recent call last):
      File "<string>", line 14, in <module>
      File "/root/build/pgmagick/setup.py", line 74, in <module>
        raise Exception("Magick++ not found")
    Exception: Magick++ not found
    Complete output from command python setup.py egg_info:
    Traceback (most recent call last):
  File "<string>", line 14, in <module>
  File "/root/build/pgmagick/setup.py", line 74, in <module>
    raise Exception("Magick++ not found")
Exception: Magick++ not found
----------------------------------------
Command python setup.py egg_info failed with error code 1 in /root/build/pgmagick
Exception information:
Traceback (most recent call last):
  File "/usr/lib/python2.6/site-packages/pip/basecommand.py", line 104, in main
    status = self.run(options, args)
  File "/usr/lib/python2.6/site-packages/pip/commands/install.py", line 245, in run
    requirement_set.prepare_files(finder, force_root_egg_info=self.bundle, bundle=self.bundle)
  File "/usr/lib/python2.6/site-packages/pip/req.py", line 1009, in prepare_files
    req_to_install.run_egg_info()
  File "/usr/lib/python2.6/site-packages/pip/req.py", line 225, in run_egg_info
    command_desc='python setup.py egg_info')
  File "/usr/lib/python2.6/site-packages/pip/__init__.py", line 256, in call_subprocess
    % (command_desc, proc.returncode, cwd))
InstallationError: Command python setup.py egg_info failed with error code 1 in /root/build/pgmagick 
```

我错过了什么吗？如何让它发挥作用？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-26T15:27:39.027

我自己刚吃过这个。对于将来通过 Google 访问的任何人，您首先需要两个额外的包：

```
sudo apt-get install libgraphicsmagick++1-dev libboost-python-dev 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-21T22:54:25.640

您可能缺少该`GraphicsMagick-c++-devel`软件包（可从[EPEL](http://fedoraproject.org/wiki/EPEL)存储库获得）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-19T01:42:01.310

对于 Arch 基础发行版，您需要执行以下操作：

```
sudo pacman -S libmagick boost graphicsmagick imagemagick 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-28T10:24:13.180

通过注意[官方安装指导](https://pgmagick.readthedocs.io/en/latest/tutorial.html#installation)

> pgmagick 在类 UNIX 系统上可用。并依赖于以下库。
> 
> *   [GraphicsMagick(Magick++)](http://www.graphicsmagick.org/Magick++/)：图形库。1.3.5 及更高版本。
> *   [Boost.Python](http://www.boost.org/doc/libs/1_44_0/libs/python/doc/index.html)：包装 C++ 代码。1.40及更高版本。

对于[**Debian**](https://pgmagick.readthedocs.io/en/latest/tutorial.html#debian)

```
$ sudo apt-get install libboost-python-dev libgraphicsmagick++1-dev 
```

如果您有**其他操作系统**，您可以查看[安装页面](https://pgmagick.readthedocs.io/en/latest/tutorial.html#installation)

之后，您可以使用 pip 安装 pgmagic

```
$ pip install pgmagick 
```

# macos - 通过沙箱使用脚本桥发送邮件附件

> ID：11140133
> 
> 赞同：1
> 
> 时间：2012-06-21T14:14:43.450
> 
> 标签：macos, sandbox, email-attachments

我一直在使用脚本桥使 Mail 在 10.6 和 10.7 中发送带有附件的消息，但从 10.8 开始，Mail 应用程序本身是沙盒的，因此它无法访问附件文件。

```
MailApplication *mail = [SBApplication applicationWithBundleIdentifier:@"com.apple.Mail"];
MailOutgoingMessage *mailMessage = [[[mail classForScriptingClass:@"outgoing message"] alloc] initWithProperties:[NSDictionary dictionaryWithObjectsAndKeys:subject, @"subject",body, @"content", nil]];
[[mail outgoingMessages] addObject:mailMessage];
[mailMessage setVisible:YES];
for (NSString *eachPath in paths) {
    if ( [eachPath length] > 0 ) {
        MailAttachment *theAttachment = [[[mail classForScriptingClass:@"attachment"] alloc] initWithProperties:[NSDictionary dictionaryWithObjectsAndKeys:eachPath, @"fileName",nil]];
        [[mailMessage.content attachments] addObject: theAttachment];
    }
}
[mail activate]; 
```

我阅读了一个建议来查看 iCal 使用 AppleScript 打开带有附件的邮件的方式：

```
on send_mail_sbp(subjectLine, messageText, invitationPath)
    set pfile to POSIX file invitationPath
    set myfile to pfile as alias
    tell application "Mail"
        set mymail to (make new outgoing message at the beginning of outgoing messages with properties {subject:subjectLine, content:messageText})
        tell mymail
            tell content
                make new attachment with properties {file name:myfile} at after the last word of the the last paragraph
            end tell
        end tell
        set visible of mymail to true
        activate
    end tell
end send_mail_sbp 
```

从applescript看来，我需要使用附件路径的别名（在我的情况下是一个临时文件），而不是现在使用的路径，邮件无法访问。有没有一种简单的方法可以使用脚本桥添加此步骤？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-26T05:02:34.910

找到了解决方案：要让它在 Mountain Lion 中使用沙盒，您必须提供附件的 NSURL 而不是文件路径作为 NSString。

```
MailAttachment *theAttachment = [[[mail classForScriptingClass:@"attachment"] alloc] initWithProperties:[NSDictionary dictionaryWithObjectsAndKeys:[NSURL fileURLWithPath:eachPath], @"fileName",nil]]; 
```

（这也适用于 Lion，但在 Snow Leopard 中，您必须使用文件路径作为 NSString）

# php - 两个 sfValidatorDoctrineUnique 在同一个表单上？

> ID：11140134
> 
> 赞同：0
> 
> 时间：2012-06-21T14:14:44.920
> 
> 标签：php, symfony1, symfony-forms

我有一个 symfony 表单，想对 postVlidator 中的字段（Fname，Lname）进行两次唯一验证

```
$this->validatorSchema->setPostValidator(new sfValidatorDoctrineUnique
                                                     (
                                                        array( 'model' => 'Test',
                                                               'column' => array('fName'),
                                                      , array('invalid' => 'Invalid fName')));

$this->validatorSchema->setPostValidator(new sfValidatorDoctrineUnique
                                                     (
                                                        array( 'model' => 'Test',
                                                               'column' => array('Lname'),
                                                      , array('invalid' => 'Invalid Lname'))); 
```

当我这样做时，第二个覆盖第一个....错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:20:06.333

您必须将它们组合在同一个调用中`setPostValidator`。例如：

```
$this->validatorSchema->setPostValidator(new sfValidatorAnd(array(
  new sfValidatorSchemaCompare('start_date', sfValidatorSchemaCompare::LESS_THAN_EQUAL, 'end_date'),
  new sfValidatorSchemaCompare('password', sfValidatorSchemaCompare::EQUAL, 'password_again'),
))); 
```

它在[文档](http://www.symfony-project.org/forms/1_4/en/02-Form-Validation#chapter_02_file_upload)中（滚动到顶部以查看示例）。

# linux - Linux 内核中 UD2 操作码的用途是什么？

> ID：11140136
> 
> 赞同：30
> 
> 时间：2012-06-21T14:14:53.610
> 
> 标签：linux, assembly, linux-kernel

我在启动阶段的某个地方在 Linux 内核中找到了以下片段（虽然不是相应的 C 代码）。您可以清楚地看到`0F 0B`代表[UD2](http://siyobik.info.gf/main/reference/instruction/UD2)操作码的部分（IDA 拒绝反汇编）。

这个操作码有一些可能的用法，[这里](https://stackoverflow.com/a/7268558/1078067)和[这里](http://lwn.net/Articles/255364/)都有解释。然而，在这种情况下，这条指令之后的操作码并没有真正的意义。

```
seg000:000C059E                 test    edx, edx
seg000:000C05A0                 jnz     short loc_C05AA
seg000:000C05A0 ; --------------------------------------------------
seg000:000C05A2                 db  0Fh
seg000:000C05A3                 db  0Bh
seg000:000C05A4                 db 73h
seg000:000C05A5                 db 0
seg000:000C05A6                 db  86h ; å
seg000:000C05A7                 db  4Ah ; J
seg000:000C05A8                 db  27h ; '
seg000:000C05A9                 db 0C0h ; +
seg000:000C05AA ; --------------------------------------------------
seg000:000C05AA
seg000:000C05AA loc_C05AA:                              
seg000:000C05AA                 cmp     eax, [edi+4]
seg000:000C05AD                 jbe     short loc_C05B7
seg000:000C05AD ; --------------------------------------------------
seg000:000C05AF                 db  0Fh
seg000:000C05B0                 db  0Bh
seg000:000C05B1                 db 75h
seg000:000C05B2                 db    0
seg000:000C05B3                 db 86h
seg000:000C05B4                 db  4Ah ; J
seg000:000C05B5                 db  27h ; '
seg000:000C05B6                 db 0C0h ; +
seg000:000C05B7 ; --------------------------------------------------
seg000:000C05B7
seg000:000C05B7 loc_C05B7:                              
seg000:000C05B7                 add     ecx, 0FFFh
seg000:000C05BD                 shr     esi, 0Ch
seg000:000C05C0                 shr     ecx, 0Ch
seg000:000C05C3                 sub     ecx, esi
seg000:000C05C5                 cmp     ecx, ebx
seg000:000C05C7                 jnb     short loc_C05E9
seg000:000C05C9                 lea     esi, [esi+0]
seg000:000C05D0
seg000:000C05D0 loc_C05D0:                              
seg000:000C05D0                 mov     edx, [edi+8]
seg000:000C05D3                 btr     [edx], ecx
seg000:000C05D6                 sbb     eax, eax
seg000:000C05D8                 test    eax, eax
seg000:000C05DA                 jnz     short loc_C05E4
seg000:000C05DA ; ------------------------------------------------
seg000:000C05DC                 db  0Fh
seg000:000C05DD                 db  0Bh
seg000:000C05DE                 db 7Fh
seg000:000C05DF                 db 0
seg000:000C05E0                 db  86h ; å
seg000:000C05E1                 db  4Ah ; J
seg000:000C05E2                 db  27h ; '
seg000:000C05E3                 db 0C0h ; +
seg000:000C05E4 ; -------------------------------------------------
seg000:000C05E4
seg000:000C05E4 loc_C05E4:                              
seg000:000C05E4                 inc     ecx 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-06-21T14:55:06.970

[它是include/asm-i386/bug.h](https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/asm-i386/bug.h?h=v2.6.13)中的 BUG() 宏。

```
/*
 * Tell the user there is some problem.
 * The offending file and line are encoded after the "officially
 * undefined" opcode for parsing in the trap handler.
 */

#ifdef CONFIG_DEBUG_BUGVERBOSE
#define BUG()                           \
 __asm__ __volatile__(  "ud2\n"         \
                        "\t.word %c0\n" \
                        "\t.long %c1\n" \
                         : : "i" (__LINE__), "i" (__FILE__)) 
```

例如，0C05AF 处的文件名称为 0xC0274A86，行号为 117 (0x75)。

# android - Spinner 的默认设置不起作用

> ID：11140140
> 
> 赞同：0
> 
> 时间：2012-06-21T14:14:55.330
> 
> 标签：android, android-spinner

我在一个屏幕上设置了一个微调器，我从另一个屏幕传递了一个字符串。我希望将该字符串设置为微调器的默认值。我查看了帖子并尝试实施它，但不知何故它不起作用。

这是我的代码：

```
//workRequestFetched is a private String object
workRequestFetched = extras.getString("workRequest");

workRequestSpinner = (Spinner) findViewById(R.id.workRequestSpinner);

//ServiceCall is a function call to the web service it works fine otherwise, please don't worry about it.

ArrayList<String> workRequests = ServiceCall.workRequests;

        ArrayAdapter<String> workRequestAdapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_spinner_item,
                 workRequests); 
```

selected 是布尔值，用于检查字符串是否已通过。我已经打印出来检查执行线程是否进入 if 子句并且确实如此，所以认为问题不存在。

```
 if(selected){
            System.out.println("Entered selected- "+workRequestFetched);
//This is what supposed to set the spinner's default to the position of the string right? but it doesn't work!

            int spinnerPosition = workRequestAdapter.getPosition(workRequestFetched);

            workRequestSpinner.setSelection(spinnerPosition);

        }

        workRequestAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

        workRequestSpinner.setAdapter(workRequestAdapter); 
```

谁能指出错误？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:22:05.503

将您的代码段更改为以下

```
ArrayAdapter <String> workRequestAdapter = new ArrayAdapter <String> (
this,android.R.layout.simple_spinner_item,workRequests);
workRequestAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
workRequestSpinner.setAdapter(workRequestAdapter);
workRequestSpinner.setSelection(workRequestAdapter.getPosition(workRequestFetched)); 
```

# r - 如何按 R 中的值选择行？

> ID：11140141
> 
> 赞同：1
> 
> 时间：2012-06-21T14:14:56.207
> 
> 标签：r, subset

我在 R 中有一个具有以下结构的表：

```
ID var1 var2 var3 .... varN
AA  1    2    1          3
AB  0.2  1    4          1 
```

...

`var1<2`我怎样才能只选择and `var2<2`and `var3<2`and ...的那些行`varN<2`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:24:21.110

由于您的示例不可重现，因此我自己制作了：

```
x <- data.frame(x1 = 1:4, x2 = 2:5, x3 = 3:6, x4 = c(1,6,3,12))
#-----
  x1 x2 x3 x4
1  1  2  3  1
2  2  3  4  6
3  3  4  5  3
4  4  5  6 12 
```

根据您的标准，我认为我们应该选择第 2 行和第 4 行。此代码为您提供：

```
x[apply(x, 1, function(z) all(diff(z) > 0)),]
#-----
  x1 x2 x3 x4
2  2  3  4  6
4  4  5  6 12 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:17:38.557

如果您的数据在`data.frame`DF 中：

```
DF[rowSums(DF) == sum(2 * dim(DF)[2]), ] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T14:30:57.027

如果您的数据框是`dat`对一行中所有元素小于 2 的测试，并且仅重新计算这些行将是：

```
dat[ apply( apply(dat[-1], 1, "<" ,2) , 2, all ), ] 
```

逻辑：内部应用返回一个逻辑矩阵：

```
apply(dat[-1], 1, "<" ,2)
     [,1]  [,2]  [,3]
var1 TRUE  TRUE  TRUE
var2 TRUE FALSE  TRUE
var3 TRUE  TRUE FALSE
varN TRUE FALSE  TRUE 
```

请注意，它是在维度上转置的，因为 R 矩阵是按列优先顺序构造的，所以外部应用需要在列上工作，因此使用 2 作为应用`all`函数的 INDEX。测试：

```
 dat <- read.table(text="ID var1 var2 var3  varN
 BA  1  1  1  1
 AA  1    2    1          3
 AB  0.2  1    4          1", header=TRUE)

 dat[ apply( apply(dat[-1], 1, "<" ,2) , 2, all ), ]
#  ID var1 var2 var3 varN
#1 BA    1    1    1    1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T16:50:06.187

如果我理解您的问题，至少有两种方法可以做您想做的事情（除了已经指定的方法。第一种是`which()`命令。根据您的查询：

```
datasetname[which((datasetname$var1<2) & (datasetname$var2<2) & ... ] 
```

应该返回你想要的行。所以将

```
newdatasetname <- subset(datasetname, datasetname$var1<2 & ...) 
```

只需在 R 中键入`?subset`和`?which`即可了解有关这些命令的更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-04T06:41:42.543

这将做到：

```
dat[rowSums(dat[,-1] >= 2) == 0,] 
```

测试：

```
dat <- read.table(text=
"ID var1 var2 var3  varN
 BA  1     1   1    1
 AA  1     2   1    3
 AB  0.2   1   4    1", header=TRUE)
dat[rowSums(dat[,-1] >= 2) == 0,]
#  ID var1 var2 var3 varN
#1 BA    1    1    1    1 
```

# c++ - 跟踪文件名更改

> ID：11140142
> 
> 赞同：2
> 
> 时间：2012-06-21T14:14:56.453
> 
> 标签：c++, file, qt, filesystems, rename

我正在尝试编写一个基本的同步程序来在两个目录之间复制文件。

计划是拥有某种已经复制的文件的数据库，因此当程序扫描目录时，它可以挑选出它已经复制的内容以及需要再次复制的内容，即修改过的文件或新文件。

我不确定如何解决的问题之一是我应该如何处理由用户重命名的文件。我怎么知道重命名的文件实际上与数据库中列出的文件相同，尽管名称不同。是否有程序可以提取的基础文件 ID？我希望代码是可移植的，因此考虑到文件系统会有所不同，这可能会使这变得更加困难。

我在想我可以记下每个文件的大小和创建日期，并将该信息保存在数据库中，以确定该文件是否实际上只是重命名了。如果两个文件具有相同的信息大小/日期，我可以存储一个哈希或其他东西来区分它们，但我不知道这会有多有效。

有什么建议么？（我正在使用 C++/QT）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:19:56.893

**要在应用程序运行时**跟踪给定文件夹中文件的更改，请参阅[`QFileSystemWatcher`](http://qt-project.org/doc/qfilesystemwatcher.html)，使用它可以在调用后跟踪目录中的所有文件更改：[`QFileSystemWatcher::addPath`](http://qt-project.org/doc/qfilesystemwatcher.html#addPath)`("directory/to/watch/")`

> 当[`fileChanged()`](http://qt-project.org/doc/qfilesystemwatcher.html#fileChanged)文件被修改、重命名或从磁盘中删除时发出信号。同样，[`directoryChanged()`](http://qt-project.org/doc/qfilesystemwatcher.html#directoryChanged)当目录或其内容被修改或删除时，也会发出信号。请注意，[`QFileSystemWatcher`](http://qt-project.org/doc/qfilesystemwatcher.html)一旦文件被重命名或从磁盘中删除，就会停止监视文件，一旦从磁盘中删除目录，就会停止监视。

为了在重命名文件后继续跟踪文件，只需重新启用观看它们[`QFileSystemWatcher::addPath()`](http://qt-project.org/doc/qfilesystemwatcher.html#addPath)再次使用。

* * *

**当您的应用程序**在重命名操作期间未运行时，您必须查看文件的内容（*如果您还想涵盖文件已被删除并复制回来的情​​况，Linux 上的 inode / 其他文件上的任何内容系统类型已更改*）。

这可以使用 MD5 和来完成，但它需要您的应用程序读取整个文件，这对于大于 10 兆字节的文件可能会很慢。如果这个缺点是可以接受的，只需保存返回的 MD5 和。当然，在某些极端情况下您会遇到哈希冲突，但对于大多数应用程序来说，这应该不是问题。但请注意，*您*可能无法检测到内容的更改。另请注意，上面的简单单行是阻塞的，并且在计算 MD5 和之前将整个文件读入内存。使用（使用and代替）提供的逐步 MD5 总和计算将文件“流式传输”到 MD5 计算中。[`QCryptographicHash::hash`](http://qt-project.org/doc/qcryptographichash.html#hash)`(file.readAll(), QCryptographicHash::Md5)`*`QCryptographicHash``addData()``result()`*

 *在大多数情况下，在读取全部内容之前比较文件大小而不是创建 MD5 总和会起作用（更改导致相同文件大小的情况并不常见；在这种情况下，您可以回退到 MD5 总和比较） . 但是在你注意到一个变化之后，无论如何你都需要读取 MD5 和，以便能够检测到未来的变化！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:27:34.807

在 Unix 下，您可以`inode`使用`stat`.*

# mysql - 页面布局搞砸了

> ID：11140152
> 
> 赞同：0
> 
> 时间：2012-06-21T14:15:27.190
> 
> 标签：mysql, html, css

我有很多使用完全相同的 html 结构的网页。

由于某种原因，此[页面](http://bit.ly/MvxEY7)上的宽度搞砸了。这是应该看起来像[http://bit.ly/Ie7yZ4](http://bit.ly/Ie7yZ4)的布局。

这些页面的唯一区别是从 MySQL 数据库提供的文本内容。

我认为这个问题与页面上的前几段有关，但我无法弄清楚它是什么。

PS：拜托，如果你不知道如何解决这个问题，但又想教我关于无表格布局和 div 的知识，请屏住呼吸——我有理由选择表格，所有页面的排名都很高在 google 中，加载快速且易于维护。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:25:32.273

原因在`Search tags`页面底部的部分。没有任何空格的长文本会拉伸表格单元格。

添加空格或作为选项添加到`span`标签样式属性

```
width: 600px;
display: block;
word-wrap: break-word; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:25:39.143

这是因为**搜索标签**很长。

你可以用一点css来改变它：

```
width: 615px;
display: block;
word-wrap: break-word; 
```

将其添加到包含标签的跨度中，您应该会很好。这将标签包装在容器内。

或者当然在每个逗号后添加空格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T14:21:59.253

最后一个跨度“搜索标签”有几个很长的句子，没有任何空格。这些线强制布局宽度。例如： `08601,08602,08603,08604,08605,08606,08607,08608,08609,08610,08611,08618,08619,08620,08625,08628,08629,08638,08641,08645,08646,08647,08648,08650,08666,08690,08691,08695,`

我建议在这些单词之间添加空格，以便它可以显示在多行上，或者将它们放在具有最大宽度的滚动容器中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T14:21:17.763

这是您在`<p>`该段落的包含中获得的长得可怕的 alt 标签：

> alt="Mold Testing Trenton, Mercer County NJ New Jersey08601 ,08602,08603,08604,08605,08606,08607,08608,08609,08610,08611,08618,08619,08620,08625,08628,086410,086348, ,08646,08647,08648,08650,08666,08690,08691,08695,”

删除修复段落。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T14:27:31.653

这是您在段落末尾的跨度中包含的搜索标签的问题，如果您真的需要它们（我个人会使用`display: none`，或完全删除它们））那么您需要申请`table-layout: fixed;`表，和`word-wrap: break-word;`跨度。

# c++ - Libtool 没有安装子项目

> ID：11140153
> 
> 赞同：1
> 
> 时间：2012-06-21T14:15:28.493
> 
> 标签：c++, makefile, installation, autotools, libtool

我正在使用 C++ 开发一个项目，我希望在该项目中实现添加插件的能力。编译过程由 Autotools 处理。我已经设法将文件结构设置正确，并且编译了主项目和插件，但由于某种原因，运行时省略了插件`make install`。单独编译和安装插件时，它工作正常。我在这里遗漏了什么，或者为什么没有从顶部文件夹安装插件？

**配置.ac**

```
AC_PREREQ(2.58)
AC_INIT([Net Responsibility],[3.1r323],[contact@netresponsibility.com])
AC_SUBST([LIBTOOL_DEPS])
AC_CONFIG_AUX_DIR([.])
AC_CONFIG_SRCDIR([src/main.cpp])
AC_CONFIG_SUBDIRS([plugins/defaultReport])
AC_CONFIG_HEADERS([config.h])
AC_CONFIG_MACRO_DIR([scripts/m4])
AC_CANONICAL_SYSTEM
AC_LANG([C++])
AC_PREFIX_PROGRAM([make])

AM_INIT_AUTOMAKE([subdir-objects])

LT_PREREQ([2.2])
LT_INIT([shared])

# Checks for programs.
AC_PROG_CXX
AC_PROG_INSTALL

# Checks for header files.
AC_HEADER_STDC

...

AC_CONFIG_FILES([Makefile])
AC_OUTPUT 
```

**生成文件.am**

```
# Main library
lib_LTLIBRARIES = libNetResponsibility.la
libNetResponsibility_la_SOURCES = \
      @top_srcdir@/src/MainApplication.cpp\
      ...
libNetResponsibility_la_CPPFLAGS = $(cppFlags)
libNetResponsibility_la_LDFLAGS = -no-undefined $(ldFlags)

# Minimal executable
bin_PROGRAMS = net-responsibility
net_responsibility_SOURCES = @top_srcdir@/src/main.cpp
net_responsibility_LDADD = -lNetResponsibility

dist_pkgdata_DATA = \
      $(top_srcdir)/data/txt.xml\
      $(top_srcdir)/COPYING

dist_pkgdata_SCRIPTS = $(top_srcdir)/scripts/init.d
dist_noinst_SCRIPTS = $(top_srcdir)/scripts/postinst\
      $(top_srcdir)/scripts/prerm

AM_LDFLAGS = -L/usr/local/lib -L/usr/lib
ACLOCAL_AMFLAGS = -I scripts/m4

incDirs = -I$(top_srcdir)/include

ldFlags = -L/usr/local/lib -L/usr/lib

cppFlags = $(incDirs)\
           -DPKGDATADIR='$(pkgdatadir)'\
           -DPKGLIBDIR='$(pkglibdir)'\
           -DDATABASEDIR='$(databasedir)'\
           -DPIDDIR='$(piddir)'\
           @CPPFLAGS@

AM_CXXFLAGS = $(incDirs) @CXXFLAGS@
AM_CPPFLAGS = $(cppFlags)

EXTRA_DIST = $(top_srcdir)/lib $(top_srcdir)/include

SUBDIRS = . plugins/defaultReport

install: install-am postinst

uninstall: prerm uninstall-am postrm

postinst:
    $(top_srcdir)/scripts/postinst $(pkgdatadir) $(initdir)

prerm:
    $(top_srcdir)/scripts/prerm $(pkgdatadir) $(initdir)

postrm:
    rm -f $(piddir)/net-responsibility.pid
    rm -f $(pkgdatadir)/blacklist.xml
    rm -f $(pkgdatadir)/config.xml
    rm -rf $(pkgdatadir)/reports
    rm -f $(databasedir)/net-responsibility.db
    rm -f $(initdir)/net-responsibility

.PHONY: prerm postinst postrm 
```

**插件/defaultReport/configure.ac**

```
AC_PREREQ(2.58)
AC_INIT([Net Responsibility Plugin: Default Report],[0.1],[contact@netresponsibility.com])
AC_SUBST([LIBTOOL_DEPS])
AC_SUBST([nrlibdir], ["${libdir}/net-responsibility"])
AC_CONFIG_AUX_DIR([.])
AC_CONFIG_SRCDIR([src/Report.cpp])
AC_CONFIG_HEADERS([config.h])
AC_CONFIG_MACRO_DIR([m4])
AC_LANG([C++])
AC_PREFIX_PROGRAM([make])

AM_INIT_AUTOMAKE([subdir-objects])

LT_PREREQ([2.2])
LT_INIT([shared])

# Checks for programs.
AC_PROG_CXX
AC_PROG_INSTALL

AC_CONFIG_FILES([Makefile])
AC_OUTPUT 
```

**插件/defaultReport/Makefile.am**

```
# General settings
ACLOCAL_AMFLAGS = -I m4

ldFlags = -L/usr/local/lib -L/usr/lib

AM_CXXFLAGS = @CXXFLAGS@

# Module specific settings
nrlib_LTLIBRARIES = defaultReport.la
defaultReport_la_SOURCES = \
   src/Report.cpp
defaultReport_la_LDFLAGS = -module -no-undefined $(ldFlags)
defaultReport_la_LIBADD = -lNetResponsibility
defaultReport_la_CPPFLAGS = -I../../include @CPPFLAGS@ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T20:56:52.557

您需要进行`nrlibdir`一些不同的设置：

**插件/defaultReport/configure.ac**

删除这一行：

```
AC_SUBST([nrlibdir], ["${libdir}/net-responsibility"]) 
```

**插件/defaultReport/Makefile.am**

在之前添加这一行`nrlib_LTLIBRARIES`：

```
nrlibdir=$(libdir)/net-responsibility 
```

这应该有助于`automake`正确`make install`。

编辑：这次我真的试过了。除上述更改外 `install`，`uninstall`删除`Makefile.am`. 您应该将`postinst`,`prerm`和`postrm`目标附加到其他一些安装挂钩上，可能类似于：

```
install-data-hook:
        $(top_srcdir)/scripts/postinst $(pkgdatadir) $(initdir)

uninstall-local:
        $(top_srcdir)/scripts/prerm $(pkgdatadir) $(initdir)

uninstall-hook:
        rm -f $(piddir)/net-responsibility.pid
        rm -f $(pkgdatadir)/blacklist.xml
        rm -f $(pkgdatadir)/config.xml
        rm -rf $(pkgdatadir)/reports
        rm -f $(databasedir)/net-responsibility.db
        rm -f $(initdir)/net-responsibility 
```

将代替那些目标起作用。

# flash-builder - 从 flash builder http 服务中检索数据

> ID：11140159
> 
> 赞同：0
> 
> 时间：2012-06-21T14:15:34.713
> 
> 标签：flash-builder

我只是在学习有关 Flash builder 的方法，需要一些帮助。

我已经设置了一个 http 服务来将登录数据发送到服务器并检索令牌作为响应。

我已经设置了服务，运行测试以确保它正常工作。我想做的是将令牌存储在变量中。

这就是我迷路的地方。

生成的代码如下所示：

```
<![CDATA[
        protected function button_clickHandler(event:MouseEvent):void
        {
            signinResult.token = signin.signin(/*Enter value(s) for */ username.text, password.text);
        }
    ]]>

</fx:Script>

<fx:Declarations>
    <s:CallResponder id="signinResult"/>
    <signin:Signin id="signin"/> 
```

我不知道如何收集返回的值并将它们放入变量中以备后用。

大多数示例似乎显示了附加到列表视图等的数据，但我只是想存储该值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-15T01:04:52.710

您需要将结果处理程序添加到您的 CallResponder。

```
<valueObjects:VerifyResult id="verifyResult"/> 
<s:CallResponder id="signinResult" result="VerifysigninResult_resultHandeler(event)" />

<![CDATA[
    protected function button_clickHandler(event:MouseEvent):void
    {
        signinResult.token = signin.signin(/*Enter value(s) for */ username.text,   password.text);
    }

     protected function VerifysigninResult_resultHandeler(event:ResultEvent):void
{
      verifyResult = signinResult.lastResult[0] as VerifyResult;
      // no you can access the the return if you Configured the Return Types in the Dataservice
     verifyResult.MyReturn;
    }  
]]> 
```

# .net - 从 .net 表单应用程序向窗口引发键盘事件

> ID：11140160
> 
> 赞同：0
> 
> 时间：2012-06-21T14:15:39.263
> 
> 标签：.net, vb.net, keyboard, keyboard-events

好的，所以我正在像您一样在 VB.net 中编写一个基本的 Windows 窗体应用程序，并且需要能够根据从串行端口接收的数据引发键盘事件。我能够接收我想要的字符（比如说小写 c）并显示它们。我也很容易找到密钥代码。我想要做的是告诉窗口键“c”已被按下。

该应用程序与蓝牙终端配对，我希望有自己编写代码的经验，而不是使用另一个库，尽管我似乎已经失败了。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:27:07.830

看看[SendKeys.Send](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send.aspx)。

如果您尝试跨应用程序发送密钥，请尝试使用这个：

[http://blog.aggregatedintelligence.com/2009/04/net-sending-keys-to-keyboard-buffer.html](http://blog.aggregatedintelligence.com/2009/04/net-sending-keys-to-keyboard-buffer.html)

# python - 在 Matplotlib 中绘制一个 3d 立方体、一个球体和一个向量

> ID：11140163
> 
> 赞同：93
> 
> 时间：2012-06-21T14:15:43.440
> 
> 标签：python, matplotlib, 3d, geometry

我搜索了如何使用 Matplotlib 尽可能少地绘制一些东西，但我在文档中没有找到任何帮助。

我想绘制以下内容：

*   以 0 为中心，边长为 2 的线框立方体
*   以 0 为中心，半径为 1 的“线框”球体
*   坐标 [0, 0, 0] 处的点
*   一个从该点开始并到达 [1, 1, 1] 的向量

怎么做？

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2012-06-22T12:39:26.547

有点复杂，但是可以通过以下代码绘制所有对象：

```
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
import numpy as np
from itertools import product, combinations

fig = plt.figure()
ax = fig.gca(projection='3d')
ax.set_aspect("equal")

# draw cube
r = [-1, 1]
for s, e in combinations(np.array(list(product(r, r, r))), 2):
    if np.sum(np.abs(s-e)) == r[1]-r[0]:
        ax.plot3D(*zip(s, e), color="b")

# draw sphere
u, v = np.mgrid[0:2*np.pi:20j, 0:np.pi:10j]
x = np.cos(u)*np.sin(v)
y = np.sin(u)*np.sin(v)
z = np.cos(v)
ax.plot_wireframe(x, y, z, color="r")

# draw a point
ax.scatter([0], [0], [0], color="g", s=100)

# draw a vector
from matplotlib.patches import FancyArrowPatch
from mpl_toolkits.mplot3d import proj3d

class Arrow3D(FancyArrowPatch):

    def __init__(self, xs, ys, zs, *args, **kwargs):
        FancyArrowPatch.__init__(self, (0, 0), (0, 0), *args, **kwargs)
        self._verts3d = xs, ys, zs

    def draw(self, renderer):
        xs3d, ys3d, zs3d = self._verts3d
        xs, ys, zs = proj3d.proj_transform(xs3d, ys3d, zs3d, renderer.M)
        self.set_positions((xs[0], ys[0]), (xs[1], ys[1]))
        FancyArrowPatch.draw(self, renderer)

a = Arrow3D([0, 1], [0, 1], [0, 1], mutation_scale=20,
            lw=1, arrowstyle="-|>", color="k")
ax.add_artist(a)
plt.show() 
```

![输出图](../Images/2b9d3be81e1393df480d1838d11b58e8.png)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-01-26T13:44:19.707

对于仅绘制箭头，有一种更简单的方法：-

```
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
fig = plt.figure()
ax = fig.gca(projection='3d')
ax.set_aspect("equal")

#draw the arrow
ax.quiver(0,0,0,1,1,1,length=1.0)

plt.show() 
```

quiver 实际上可用于一次绘制多个向量。用法如下：- [来自[http://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html?highlight=quiver#mpl_toolkits.mplot3d.Axes3D.quiver]](http://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html?highlight=quiver#mpl_toolkits.mplot3d.Axes3D.quiver])

颤动（X，Y，Z，U，V，W，**kwargs）

**论据：**

**X、Y、Z：** 箭头位置的 x、y 和 z 坐标

**U、V、W：** 箭头向量的 x、y 和 z 分量

参数可以是类数组或标量。

**关键字参数：**

**长度：** [1.0 | float] 每个箭袋的长度，默认为1.0，单位与坐标轴相同

**箭头长度比：** [0.3 | float] 箭头相对于箭袋的比例，默认为 0.3

**枢轴：** ['尾巴'| '中间' | 'tip' ] 网格点处的箭头部分；箭头围绕这一点旋转，因此得名枢轴。默认为“尾”</p>

**标准化：** [假| True] 为 True 时，所有箭头的长度都相同。这默认为 False，其中箭头的长度取决于 u,v,w 的值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-09-02T15:16:33.497

我的答案是上述两者的融合，并扩展到用户定义的不透明度和一些注释的绘图范围。它可用于磁共振图像 (MRI) 球体上的 b 向量可视化。希望你觉得它有用：

```
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.gca(projection='3d')

# draw sphere
u, v = np.mgrid[0:2*np.pi:50j, 0:np.pi:50j]
x = np.cos(u)*np.sin(v)
y = np.sin(u)*np.sin(v)
z = np.cos(v)
# alpha controls opacity
ax.plot_surface(x, y, z, color="g", alpha=0.3)

# a random array of 3D coordinates in [-1,1]
bvecs= np.random.randn(20,3)

# tails of the arrows
tails= np.zeros(len(bvecs))

# heads of the arrows with adjusted arrow head length
ax.quiver(tails,tails,tails,bvecs[:,0], bvecs[:,1], bvecs[:,2],
          length=1.0, normalize=True, color='r', arrow_length_ratio=0.15)

ax.set_xlabel('X-axis')
ax.set_ylabel('Y-axis')
ax.set_zlabel('Z-axis')

ax.set_title('b-vectors on unit sphere')

plt.show() 
```

# c# - SignalR 控制台应用程序示例

> ID：11140164
> 
> 赞同：99
> 
> 时间：2012-06-21T14:15:50.687
> 
> 标签：c#, signalr

是否有使用 signalR 向 .net 集线器发送消息的控制台或 winform 应用程序的小示例？我已经尝试了 .net 示例并查看了 wiki，但集线器（.net）和客户端（控制台应用程序）之间的关系对我来说没有意义（找不到这样的示例）。该应用程序是否只需要集线器的地址和名称即可连接？

如果有人可以提供一小段代码来显示应用程序连接到集线器并发送“Hello World”或.net 集线器接收到的东西？

PS。我有一个运行良好的标准集线器聊天示例，如果我尝试在 Cs 中为其分配集线器名称，它会停止工作，即 [HubName("test")] ，您知道原因吗？

谢谢。

当前控制台应用程序代码。

```
static void Main(string[] args)
{
    //Set connection
    var connection = new HubConnection("http://localhost:41627/");
    //Make proxy to hub based on hub name on server
    var myHub = connection.CreateProxy("chat");
    //Start connection
    connection.Start().ContinueWith(task =>
    {
        if (task.IsFaulted)
        {
            Console.WriteLine("There was an error opening the connection:{0}", task.Exception.GetBaseException());
        }
        else
        {
            Console.WriteLine("Connected");
        }
    }).Wait();

    //connection.StateChanged += connection_StateChanged;

    myHub.Invoke("Send", "HELLO World ").ContinueWith(task => {
        if(task.IsFaulted)
        {
            Console.WriteLine("There was an error calling send: {0}",task.Exception.GetBaseException());
        }
        else
        {
            Console.WriteLine("Send Complete.");
        }
    });
 } 
```

集线器服务器。（不同的项目工作区）

```
public class Chat : Hub
{
    public void Send(string message)
    {
        // Call the addMessage method on all clients
        Clients.addMessage(message);
    }
} 
```

信息 Wiki 是[http://www.asp.net/signalr/overview/signalr-20/hubs-api/hubs-api-guide-net-client](http://www.asp.net/signalr/overview/signalr-20/hubs-api/hubs-api-guide-net-client)

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-08-21T16:03:30.517

首先，您应该通过 nuget 在服务器应用程序上安装 SignalR.Host.Self 并在客户端应用程序上安装 SignalR.Client ：

> PM> 安装包 SignalR.Hosting.Self -Version 0.5.2
> 
> PM> 安装包 Microsoft.AspNet.SignalR.Client

然后将以下代码添加到您的项目中；）

（以管理员身份运行项目）

服务器控制台应用程序：

```
using System;
using SignalR.Hubs;

namespace SignalR.Hosting.Self.Samples {
    class Program {
        static void Main(string[] args) {
            string url = "http://127.0.0.1:8088/";
            var server = new Server(url);

            // Map the default hub url (/signalr)
            server.MapHubs();

            // Start the server
            server.Start();

            Console.WriteLine("Server running on {0}", url);

            // Keep going until somebody hits 'x'
            while (true) {
                ConsoleKeyInfo ki = Console.ReadKey(true);
                if (ki.Key == ConsoleKey.X) {
                    break;
                }
            }
        }

        [HubName("CustomHub")]
        public class MyHub : Hub {
            public string Send(string message) {
                return message;
            }

            public void DoSomething(string param) {
                Clients.addMessage(param);
            }
        }
    }
} 
```

客户端控制台应用程序：

```
using System;
using SignalR.Client.Hubs;

namespace SignalRConsoleApp {
    internal class Program {
        private static void Main(string[] args) {
            //Set connection
            var connection = new HubConnection("http://127.0.0.1:8088/");
            //Make proxy to hub based on hub name on server
            var myHub = connection.CreateHubProxy("CustomHub");
            //Start connection

            connection.Start().ContinueWith(task => {
                if (task.IsFaulted) {
                    Console.WriteLine("There was an error opening the connection:{0}",
                                      task.Exception.GetBaseException());
                } else {
                    Console.WriteLine("Connected");
                }

            }).Wait();

            myHub.Invoke<string>("Send", "HELLO World ").ContinueWith(task => {
                if (task.IsFaulted) {
                    Console.WriteLine("There was an error calling send: {0}",
                                      task.Exception.GetBaseException());
                } else {
                    Console.WriteLine(task.Result);
                }
            });

            myHub.On<string>("addMessage", param => {
                Console.WriteLine(param);
            });

            myHub.Invoke<string>("DoSomething", "I'm doing something!!!").Wait();

            Console.Read();
            connection.Stop();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2017-05-02T15:27:32.517

SignalR 2.2.1 示例（2017 年 5 月）

**服务器**

安装包 Microsoft.AspNet.SignalR.SelfHost -Version 2.2.1

```
[assembly: OwinStartup(typeof(Program.Startup))]
namespace ConsoleApplication116_SignalRServer
{
    class Program
    {
        static IDisposable SignalR;

        static void Main(string[] args)
        {
            string url = "http://127.0.0.1:8088";
            SignalR = WebApp.Start(url);

            Console.ReadKey();
        }

        public class Startup
        {
            public void Configuration(IAppBuilder app)
            {
                app.UseCors(CorsOptions.AllowAll);

                /*  CAMEL CASE & JSON DATE FORMATTING
                 use SignalRContractResolver from
                https://stackoverflow.com/questions/30005575/signalr-use-camel-case

                var settings = new JsonSerializerSettings()
                {
                    DateFormatHandling = DateFormatHandling.IsoDateFormat,
                    DateTimeZoneHandling = DateTimeZoneHandling.Utc
                };

                settings.ContractResolver = new SignalRContractResolver();
                var serializer = JsonSerializer.Create(settings);

               GlobalHost.DependencyResolver.Register(typeof(JsonSerializer),  () => serializer);                

                 */

                app.MapSignalR();
            }
        }

        [HubName("MyHub")]
        public class MyHub : Hub
        {
            public void Send(string name, string message)
            {
                Clients.All.addMessage(name, message);
            }
        }
    }
} 
```

**客户**

（几乎与 Mehrdad Bahrainy 的回复相同）

安装包 Microsoft.AspNet.SignalR.Client -Version 2.2.1

```
namespace ConsoleApplication116_SignalRClient
{
    class Program
    {
        private static void Main(string[] args)
        {
            var connection = new HubConnection("http://127.0.0.1:8088/");
            var myHub = connection.CreateHubProxy("MyHub");

            Console.WriteLine("Enter your name");    
            string name = Console.ReadLine();

            connection.Start().ContinueWith(task => {
                if (task.IsFaulted)
                {
                    Console.WriteLine("There was an error opening the connection:{0}", task.Exception.GetBaseException());
                }
                else
                {
                    Console.WriteLine("Connected");

                    myHub.On<string, string>("addMessage", (s1, s2) => {
                        Console.WriteLine(s1 + ": " + s2);
                    });

                    while (true)
                    {
                        Console.WriteLine("Please Enter Message");
                        string message = Console.ReadLine();

                        if (string.IsNullOrEmpty(message))
                        {
                            break;
                        }

                        myHub.Invoke<string>("Send", name, message).ContinueWith(task1 => {
                            if (task1.IsFaulted)
                            {
                                Console.WriteLine("There was an error calling send: {0}", task1.Exception.GetBaseException());
                            }
                            else
                            {
                                Console.WriteLine(task1.Result);
                            }
                        });
                    }
                }

            }).Wait();

            Console.Read();
            connection.Stop();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2020-12-13T01:08:39.557

为了构建@dyslexicanaboko 对 dotnet core 的回答，这里有一个客户端控制台应用程序：

创建一个辅助类：

```
using System;
using Microsoft.AspNetCore.SignalR.Client;

namespace com.stackoverflow.SignalRClientConsoleApp
{
    public class SignalRConnection
    {
        public async void Start()
        {
            var url = "http://signalr-server-url/hubname";

            var connection = new HubConnectionBuilder()
                .WithUrl(url)
                .WithAutomaticReconnect()
                .Build();

            // receive a message from the hub
            connection.On<string, string>("ReceiveMessage", (user, message) => OnReceiveMessage(user, message));

            var t = connection.StartAsync();

            t.Wait();

            // send a message to the hub
            await connection.InvokeAsync("SendMessage", "ConsoleApp", "Message from the console app");
        }

        private void OnReceiveMessage(string user, string message)
        {
            Console.WriteLine($"{user}: {message}");
        }

    }
} 
```

然后在您的控制台应用程序的入口点中实现：

```
using System;

namespace com.stackoverflow.SignalRClientConsoleApp
{
    class Program
    {
        static void Main(string[] args)
        {
            var signalRConnection = new SignalRConnection();
            signalRConnection.Start();

            Console.Read();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-03-25T17:14:44.777

自宿主现在使用 Owin。结帐[http://www.asp.net/signalr/overview/signalr-20/getting-started-with-signalr-20/tutorial-signalr-20-self-host](http://www.asp.net/signalr/overview/signalr-20/getting-started-with-signalr-20/tutorial-signalr-20-self-host)设置服务器。它与上面的客户端代码兼容。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-10-25T03:47:30.817

这是针对 dot net core 2.1 - 经过大量的试验和错误后，我终于让它完美地工作：

```
var url = "Hub URL goes here";

var connection = new HubConnectionBuilder()
    .WithUrl($"{url}")
    .WithAutomaticReconnect() //I don't think this is totally required, but can't hurt either
    .Build();

//Start the connection
var t = connection.StartAsync();

//Wait for the connection to complete
t.Wait();

//Make your call - but in this case don't wait for a response 
//if your goal is to set it and forget it
await connection.InvokeAsync("SendMessage", "User-Server", "Message from the server"); 
```

此代码来自典型的 SignalR 穷人聊天客户端。我和其他许多人似乎遇到的问题是在尝试向集线器发送消息之前建立连接。这很关键，因此等待异步任务完成很重要——这意味着我们通过等待任务完成来使其同步。

# asp.net-mvc - 在 ASP.NET MVC 3 中格式化日期时间

> ID：11140165
> 
> 赞同：1
> 
> 时间：2012-06-21T14:16:01.803
> 
> 标签：asp.net-mvc, datetime

我正在尝试显示日期。我的视图模型代码示例如下：

```
[Display(Name = "Date of birth")]
[DisplayFormat(DataFormatString = "{0:dd.MM.yyyy}", ApplyFormatInEditMode = true)]
[DataType(DataType.Date, ErrorMessage = "Enter correct date (e.g. 23.05.1980)")]
public DateTime CustomerBirthday { get; set; } 
```

显示一切正常。但是当我想提交表单时，如果第一个数字大于 12，它不会通过验证，因为它需要格式为 MM.dd.yyyy 而不是 dd.MM.yyyy 的日期。如何强制模型绑定器使用我的 DateTime 模式 (dd.MM.yyyy) 并忽略文化设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:20:40.843

> 如何强制模型绑定器使用我的 DateTime 模式 (dd.MM.yyyy) 并忽略文化设置。

您可以编写一个自定义模型绑定器，它将考虑您在 DisplayFormat 属性中指定的格式：[https ://stackoverflow.com/a/7836093/29407](https://stackoverflow.com/a/7836093/29407)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:32:08.377

将`DefaultModelBinder`服务器的文化设置用于表单数据。所以我可以说服务器使用“en-US”文化，但日期格式不同。

你可以在中做这样的事情`Application_BeginRequest`，你就完成了！

```
protected void Application_BeginRequest()
{
    CultureInfo info = new CultureInfo(System.Threading.Thread.CurrentThread.CurrentCulture.ToString());
    info.DateTimeFormat.ShortDatePattern = "dd.MM.yyyy";
    System.Threading.Thread.CurrentThread.CurrentCulture = info;
} 
```

# c# - 初学者在使用模拟框架 C# .net 时遇到问题

> ID：11140166
> 
> 赞同：3
> 
> 时间：2012-06-21T14:16:05.053
> 
> 标签：c#, visual-studio-2010, unit-testing, moq

我是一个实习的学生。我的任务是完成一个应用程序，然后进行测试。

该应用程序已完成，我已经测试了 80%。但是，我有一些方法不能直接测试，因为它们使用会话变量和表单请求。我知道我需要使用模拟框架，并选择使用最小起订量，因为从我读到的内容来说它很棒。不幸的是，我玩过它，发现它有点过头了（我一般是 C# 新手，包括 lambdas 等）

我一直无法找到简化的初学者演练。有什么想法可以找到这样的东西吗？正如我所说，我所需要的只是能够模拟会话和表单。到目前为止，所有尝试都包括我（以徒劳的方式）插入在 SO 上找到的随机代码，并希望获得最好的结果。

我宁愿理解它，这样我才能真正使用它......

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:00:25.837

我发现这些教程涵盖了基础知识。我认为除了 Moq 框架之外，不会有任何涵盖基本 C# 概念的内容。如果你被诸如 lambdas 之类的东西困住了，那么找到一个初学者教程应该不会太难。我在下面添加了几个 lambda 教程的链接。

在尝试为主应用程序的完整解决方案之前，您可能还想尝试制作一些您想要做的简单原型。这将让您玩转这些概念，而不必担心应用程序的细节。

[http://code.google.com/p/moq/wiki/QuickStart](http://code.google.com/p/moq/wiki/QuickStart)

[http://andrewblogs.com/blog/moq-testing-tutorial/](http://andrewblogs.com/blog/moq-testing-tutorial/)

[http://blogs.msdn.com/b/ericwhite/archive/2006/10/03/lambda-expressions.aspx](http://blogs.msdn.com/b/ericwhite/archive/2006/10/03/lambda-expressions.aspx)

[http://www.switchonthecode.com/tutorials/csharp-tutorial-the-lambda-operator](http://www.switchonthecode.com/tutorials/csharp-tutorial-the-lambda-operator)

# cherrypy - CherryPy 3.2 ImportError：没有名为 wsgiserver3 的模块

> ID：11140167
> 
> 赞同：0
> 
> 时间：2012-06-21T14:16:06.763
> 
> 标签：cherrypy

我在家用电脑上使用 CherryPy 3.2 没有问题。当我在我的工作机器上运行它时，我不断收到 ImportError：没有名为 wsgiserver3 的模块。

不知道怎么回事，两台机器都用python 3.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T22:09:38.153

我也有这个问题。显然这是构建的问题。下面的站点有一个包含该模块的副本：

[https://bitbucket.org/cherrypy/cherrypy/issue/1110/cherrypy-322win32exe-installer-didnt](https://bitbucket.org/cherrypy/cherrypy/issue/1110/cherrypy-322win32exe-installer-didnt)

# parsing - 如何在 tcl 的已解析文件中删除行

> ID：11140168
> 
> 赞同：0
> 
> 时间：2012-06-21T14:16:07.940
> 
> 标签：parsing, tcl

我已经在 tcl 中解析了一个文件，我读到了这样的行：

```
while {[gets $thefile line] >= 0} { ... 
```

我像那样搜索我的模式

```
 if { [regexp {pattern} $line] } { ... 
```

我想将第 n+2 行存储在一个变量中，我该怎么做（我不能尝试在下一行中找到一个模式，因为它总是在变化）？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:48:30.623

最简单的方法是`gets`在`if`正文中添加一个额外的内容：

```
while {[gets $thefile line] >= 0} {
    # ...
    if { [regexp {pattern} $line] } {
        if {[gets $thefile secondline] < 0} break
        # Now $line is the first line, and $secondline is the one after
    }
    # ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:53:35.440

您可以在运行时将模式空间构建为列表。例如：

```
set lines {}
set file [open /tmp/foo]
while { [gets $file line] >=0 } {
    if { [llength $lines] >= 3 } {
        set lines [lrange $lines 1 2]
    }
    lappend lines $line
    if { [llength $lines] >= 3 } {
        puts [join $lines]
    }
} 
```

第三次通过循环后，行将始终包含最近的三个行*。*在我的示例中，输出如下所示：

```
line 1 line 2 line 3
line 2 line 3 line 4
line 3 line 4 line 5
line 4 line 5 line 6
line 5 line 6 line 7
line 6 line 7 line 8
line 7 line 8 line 9 
```

然后，您可以使用正则表达式搜索循环内的*行。*

# sql - PIVOT SQL - 如何显示我们正在旋转的列？

> ID：11140169
> 
> 赞同：1
> 
> 时间：2012-06-21T14:16:09.087
> 
> 标签：sql, sql-server, pivot, pivot-table

我已经编写了我的数据透视 SQL，它正在工作。当前的 SQL 语句如下所示，我将展示如何返回数据的示例。我需要添加一列，这就是它爆炸的地方：

```
Select 
    ProductGroup,
    Origin,
    Destination,
    [YEAR], 
    Isnull([Jan],0) as "Jan",
    isnull([Feb],0) as "Feb",
    isnull([Mar],0) as "Mar",
    isnull([Apr],0) as "Apr",
    isnull([May],0) as "May",
    isnull([Jun],0) as "Jun",
    isnull([Jul],0) as "Jul",
    isnull([Aug],0) as "Aug",
    isnull([Sep],0) as "Sep",
    isnull([Oct],0) as "Oct",
    isnull([Nov],0) as "Nov",
    isnull([Dec],0) as "Dec"
FROM
(
SELECT 
    p.ProductGroup, 
    S.Origin, 
    S.FinalDest AS Destination,
    SUBSTRING('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec', (Month(boldate) * 4) - 3, 3) as MonthAbreviated, 
    Year(BolDate) AS [Year], 
    Count(*) AS [Total]
--  ,COUNT(S.Purchase#) AS [TheTotal]
    FROM 
        dbo.Contracts c INNER JOIN dbo.Purchases pu ON c.[Contract#] = pu.[Contract#]
        INNER JOIN dbo.Products as p ON pu.Product = p.Product 
        INNER JOIN dbo.Shipments S ON pu.[Purchase#] = S.[Purchase#]
WHERE 
    Year(BolDate)<>1994 AND
    pu.Cancelled=0 AND S.[Status]='L'
GROUP BY p.ProductGroup, S.Origin, S.FinalDest,Year(BolDate), SUBSTRING('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec', (Month(boldate) * 4) - 3, 3)

) AS SourceTable
PIVOT
(
sum( Total )
FOR MonthAbreviated IN ([Jan],[Feb],[Mar],[Apr],[May],[Jun],[Jul],[Aug],[Sep],[Oct],[Nov],[Dec])
) AS PivotTable 
```

# 结果示例：

```
ProductGroup   Origin  Destination  YEAR        Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
Nail           Bath    Toronto      2012        0   0   0   10  1   0   0   0   0   0   0   0 
Nail           Cedars  Toronto      2011        0   0   0   0   0   0   0   0   0   0   25  53 
```

我需要添加一个显示行总数的列。例如，第 1 行是 11，第 2 行是 78。在我的选择中，我认为只需将“Total”添加到查询中就可以了，但每次我都会得到一个无效的列。

换句话说，我收到此错误：

> 消息 207，级别 16，状态 1，第 6 行无效的列名称“总计”。

```
Select 
    ProductGroup,
    Origin,
    Destination,
    [YEAR], 
    [Total],
    Isnull([Jan],0) as "Jan",
    isnull([Feb],0) as "Feb",
    isnull([Mar],0) as "Mar",
    isnull([Apr],0) as "Apr",
    isnull([May],0) as "May",
    isnull([Jun],0) as "Jun",
    isnull([Jul],0) as "Jul",
    isnull([Aug],0) as "Aug",
    isnull([Sep],0) as "Sep",
    isnull([Oct],0) as "Oct",
    isnull([Nov],0) as "Nov",
    isnull([Dec],0) as "Dec"
FROM
(
SELECT 
    p.ProductGroup, 
    S.Origin, 
    S.FinalDest AS Destination,
    SUBSTRING('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec', (Month(boldate) * 4) - 3, 3) as MonthAbreviated, 
    Year(BolDate) AS [Year], 
    Count(*) AS [Total]
--  ,COUNT(S.Purchase#) AS [TheTotal]
    FROM 
        dbo.Contracts c INNER JOIN dbo.Purchases pu ON c.[Contract#] = pu.[Contract#]
        INNER JOIN dbo.Products as p ON pu.Product = p.Product 
        INNER JOIN dbo.Shipments S ON pu.[Purchase#] = S.[Purchase#]
WHERE 
    Year(BolDate)<>1994 AND
    pu.Cancelled=0 AND S.[Status]='L'
GROUP BY p.ProductGroup, S.Origin, S.FinalDest,Year(BolDate), SUBSTRING('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec', (Month(boldate) * 4) - 3, 3)

) AS SourceTable
PIVOT
(
sum( Total )
FOR MonthAbreviated IN ([Jan],[Feb],[Mar],[Apr],[May],[Jun],[Jul],[Aug],[Sep],[Oct],[Nov],[Dec])
) AS PivotTable 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:22:46.950

如果您想要该行的总计，您只需将各列相加即可获得总计。因此，您将需要添加以下行：

```
([Jan] + [Feb] + [Mar] + [Apr] + [May] + [Jun] + [Jul] + [Aug] + [Sep] + [Oct] + [Nov] + [Dec]) as Total 
```

进行查询：

```
Select 
    ProductGroup,
    Origin,
    Destination,
    [YEAR], 
    Isnull([Jan],0) as "Jan",
    isnull([Feb],0) as "Feb",
    isnull([Mar],0) as "Mar",
    isnull([Apr],0) as "Apr",
    isnull([May],0) as "May",
    isnull([Jun],0) as "Jun",
    isnull([Jul],0) as "Jul",
    isnull([Aug],0) as "Aug",
    isnull([Sep],0) as "Sep",
    isnull([Oct],0) as "Oct",
    isnull([Nov],0) as "Nov",
    isnull([Dec],0) as "Dec",
    ([Jan] + [Feb] + [Mar] + [Apr] + [May] + [Jun] + [Jul] + [Aug] + [Sep] + [Oct] + [Nov] + [Dec]) as Total
FROM
(
SELECT 
    p.ProductGroup, 
    S.Origin, 
    S.FinalDest AS Destination,
    SUBSTRING('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec', (Month(boldate) * 4) - 3, 3) as MonthAbreviated, 
    Year(BolDate) AS [Year], 
    Count(*) AS [Total]
--  ,COUNT(S.Purchase#) AS [TheTotal]
    FROM 
        dbo.Contracts c INNER JOIN dbo.Purchases pu ON c.[Contract#] = pu.[Contract#]
        INNER JOIN dbo.Products as p ON pu.Product = p.Product 
        INNER JOIN dbo.Shipments S ON pu.[Purchase#] = S.[Purchase#]
WHERE 
    Year(BolDate)<>1994 AND
    pu.Cancelled=0 AND S.[Status]='L'
GROUP BY p.ProductGroup, S.Origin, S.FinalDest,Year(BolDate), SUBSTRING('Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec', (Month(boldate) * 4) - 3, 3)

) AS SourceTable
PIVOT
(
sum( Total )
FOR MonthAbreviated IN ([Jan],[Feb],[Mar],[Apr],[May],[Jun],[Jul],[Aug],[Sep],[Oct],[Nov],[Dec])
) AS PivotTable 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:19:05.867

作为替代方案，您也可以使用[ROLLUP](http://msdn.microsoft.com/en-us/library/ms189305%28v=SQL.90%29.aspx)

你需要

*   添加一个 case 语句为汇总提供一个“名称”

    ```
     CASE WHEN (GROUPING(Substring(DateName(m,boldate),1,3) = 1) Then 'Total'
          ELSE Substring(DateName(m,boldate),1,3) 
     END as MonthAbreviated, 
    ```

*   将 RollUp 添加到组中

    ```
     GROUP BY
      ....
      Substring(DateName(m,boldate),1,3) 
      WITH ROLLUP 
    ```

*   将其包含在您的 FOR 子句中

    ```
     ... [Nov],[Dec], [Total]) 
    ```

*   排除 Have 中的所有其他汇总分组

    ```
     HAVING
             GROUPING (Year(BolDate) = 0) 
    ```

注意我已经修改了您的 MonthAbreviated 语法以缩短它，我不得不更改 Count(*) 的别名，因为它与枢轴值具有相同的名称

```
Select 
    ProductGroup,
    Origin,
    Destination,
    [YEAR], 
    Isnull([Jan],0) as "Jan",
    isnull([Feb],0) as "Feb",
    isnull([Mar],0) as "Mar",
    isnull([Apr],0) as "Apr",
    isnull([May],0) as "May",
    isnull([Jun],0) as "Jun",
    isnull([Jul],0) as "Jul",
    isnull([Aug],0) as "Aug",
    isnull([Sep],0) as "Sep",
    isnull([Oct],0) as "Oct",
    isnull([Nov],0) as "Nov",
    isnull([Dec],0) as "Dec",
    isnull([Total],0) as "Total"
FROM
(
SELECT 
    p.ProductGroup, 
    S.Origin, 
    S.FinalDest AS Destination,
    CASE WHEN (GROUPING(Substring(DateName(m,boldate),1,3) = 1) Then 'Total'
         ELSE Substring(DateName(m,boldate),1,3) 
    END as MonthAbreviated, 
    Year(BolDate) AS [Year], 
    Count(*) AS [Kount]
    FROM 
        dbo.Contracts c INNER JOIN dbo.Purchases pu ON c.[Contract#] = pu.[Contract#]
        INNER JOIN dbo.Products as p ON pu.Product = p.Product 
        INNER JOIN dbo.Shipments S ON pu.[Purchase#] = S.[Purchase#]
WHERE 
    Year(BolDate)<>1994 AND
    pu.Cancelled=0 AND S.[Status]='L'
GROUP BY 
     p.ProductGroup, 
     S.Origin, 
     S.FinalDest,Year(BolDate), 
     Substring(DateName(m,boldate),1,3) 
     WITH ROLLUP
HAVING
    GROUPING (Year(BolDate) = 0)

) AS SourceTable
PIVOT
(
sum( Kount )
FOR MonthAbreviated IN ([Jan],[Feb],[Mar],[Apr],[May],[Jun],[Jul],[Aug],[Sep],[Oct],[Nov],[Dec], [Total])
) AS PivotTable 
```

[这是 data.se 上该技术的演示](https://data.stackexchange.com/stackoverflow/query/73600/demo-for-11140169?userId=22656)

# java - 从 Java 中的表格中删除网格线但使整行保持相同的颜色

> ID：11140171
> 
> 赞同：0
> 
> 时间：2012-06-21T14:16:11.363
> 
> 标签：java, colors, gridlines

我`TableCellRenderers`在表格上使用过重新绘制单元格，以便表格中的每个交替行都是不同的颜色，但是，当我使用`setShowGrid(false);`它时，它会删除网格线，但允许表格的背景颜色通过网格线过去的位置显示，而不是该行中单元格的颜色。

有没有办法给这些网格线着色？还是我需要一种更好的方法来为交替行着色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:51:57.487

您删除了线条但留下了间距。删除间距应该有效。

```
jTable.setIntercellSpacing(new Dimension(0,0)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:06:35.780

为了给线条上色，您只需要设置 JTable 组件的背景颜色，但如果您想抑制它，只需设置单元间距：

*   抑制：jTable.setIntercellSpacing(new Dimension([spacings]));
*   给它上色：jTable.setBackground([color]);

    导入 java.awt.BorderLayout；导入 java.awt.Color；导入 java.awt.Component；导入 java.awt.Dimension；

    导入 javax.swing.JFrame；导入 javax.swing.JTable；导入 javax.swing.table.DefaultTableModel；导入 javax.swing.table.TableCellRenderer；

    公共类 TestJFrame {

    ```
    public static void main(String[] args) {
        JFrame jFrame = new JFrame();
        JTable jTable = new JTable();

        jTable.setModel(new DefaultTableModel(new String[][] { new String[] {"col1", "col2"}, new String[] {"col1", "col2"}, new String[] {"col1", "col2"}}, new String[] {"colHeader1", "colHeader2"}));

        final TableCellRenderer defaultRenderer = jTable.getDefaultRenderer(Object.class);

        jTable.setDefaultRenderer(Object.class, new TableCellRenderer() {

            public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
                Component result = defaultRenderer.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);

                if(!isSelected) {
                    if (row%2 == 0) {
                        result.setBackground(Color.GRAY);
                    } else {
                        result.setBackground(Color.DARK_GRAY);
                    }
                }

                return result;
            }
        });

        jTable.setBackground(Color.RED);
        jTable.setShowGrid(false);
        //jTable.setIntercellSpacing(new Dimension(0, 0));

        jFrame.setLayout(new BorderLayout());
        jFrame.add(jTable.getTableHeader(), BorderLayout.NORTH);
        jFrame.add(jTable, BorderLayout.CENTER);

        jFrame.pack();
        jFrame.setVisible(true);
    } 
    ```

# html - 大 iframe 高度导致锚标签不起作用？

> ID：11140178
> 
> 赞同：1
> 
> 时间：2012-06-21T14:16:40.553
> 
> 标签：html, iframe

我们有一个 ASP 应用程序，它位于页面上的 iframe 中，它创建了我们员工的电话目录。你可以在这里看到它：

[http://www.cecil.edu/Directory/](http://www.cecil.edu/Directory/)

它所在的 iframe 设置为 6350px 高。当您单击字母表中的字母链接时，它应该会跳到页面上的该字母。它似乎只在 Chrome 和 Safari 中正常工作。IE 7/8/9 或 Firefox 没有骰子。

这以前可以正常工作，至少在 IE8 中是这样，但在某些时候停止工作。做了一些摆弄，我发现如果我将 iframe 的高度降低到 4000px 左右，锚标签就会起作用。但以上任何内容都会使他们表现得异常，将您带到页面上的错误位置或根本不工作。

有没有人知道大的 iframe 高度会导致这样的奇怪行为？我似乎在网上的任何地方都找不到任何关于它的参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:37:19.100

当 IE 使用 Direct-X 渲染对象时（例如使用 css 过滤器时：），由于 12 位寄存器的最大大小，在任何轴上任何维度都不能大于 4906 像素。虽然这*可能*是对 IE 中限制的解释，但它并没有解释 Firefox 中的限制。

请参阅：[IE 在高度 > 4096px 时显示透明度错误？](https://stackoverflow.com/questions/775041/ie-display-transparency-bug-on-height-4096px)

# c# - jQuery 未在新的 IE 窗口中加载

> ID：11140180
> 
> 赞同：0
> 
> 时间：2012-06-21T14:16:43.870
> 
> 标签：c#, javascript, jquery, asp.net, internet-explorer

首先，我想通过表达我对 IE 的厌恶程度来作为这个问题的序言。有时我会在半夜从 IE 引发的噩梦中醒来，让我尖叫着从床上跳起来，有时还会无情地殴打我周围的任何人。我的邻居讨厌它。只是听到“IE”让我畏缩。但我离题了。

无论如何，我的 MVC Web 应用程序上有一个页面，它通过 AJAX（通过不同的视图）启动一个新页面并显示一个图表。然而，问题是当我打开新窗口时，仅在 IE 中，脚本没有加载（或者至少它们没有及时加载？）但是我在第一次引用时得到“jQuery 未定义” jQuery 对象。

然而，在重新加载时，一切都加载得很好。知道什么可能导致脚本无法在 IE 中加载吗？Chrome 和 FF 工作正常。

这是我用于新窗口的 ajax 调用：

```
$.ajax({
                type: "POST",
                url: actionURL + qs,
                data: $(this).serialize(),
                success: function (outputString) {
                    //$("#reportJSON").html(outputString).fadeIn();
                    var contentFromFirstPage = document.getElementById('reportArea').innerHTML;
                    var printContent = outputString;
                    var windowUrl = 'about:blank';
                    var uniqueName = new Date();
                    var windowName = 'Print' + uniqueName.getTime();
                    var printWindow = window.open(windowUrl, windowName, 'scrollbars=1,menubar=1,height=800,width=600,resizable=1');
                    printWindow.document.write(printContent);
                    printWindow.focus();
                    //printWindow.document.close();

                }
            }).error(function (response) {
                alert("something went wrong here with PrintPreview!!!" + response);
            }); 
```

这是 ajax 调用的操作：

```
public ActionResult PrintPreview(string reportId, string date, string dateFrom, string dateTo)
        {
            Reports reports = new Reports
            {
                ReportId = Convert.ToInt64(reportId),
                Date = Convert.ToDateTime(date),
                DateFrom = Convert.ToDateTime(dateFrom),
                DateTo = Convert.ToDateTime(dateTo),
                AvailableReports = this.FetchAvailableReports()
            };

            reports.AvailableReports = this.FetchAvailableReports();
            reports.SelectedReport = this.FetchReportLayout(reports.ReportId);
            reports.DynamicGridDataSource = this.FetchReportGrid(reports);
            reports.DynamicChartDataSource = this.FetchReportChart(reports);

            return renderViewToString("PrintPreview", reports);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T12:35:26.283

好的，从讨论中我将在一个答案中下注！

想想它，以及它是如何经常伴随着 IE 带来的痛苦，它只是原始代码中的一个错误/实现差异，并且实际上无法重写浏览器行为，你本质上是不走运的——就像许多人一样仅适用于 IE 所需的 CSS hack。

但是，通过查看您发布的代码，我假设 ajax 调用获取当前页面，并对其进行一些处理并返回打印友好格式的 HTML 加载？然后将这个 HTML 打印到新窗口中......

现在，我能想到的唯一解决方法是对您的架构进行轻微更改；新窗口将需要打开一个页面，并在该页面上进行 ajax 调用以填充内容。

但是，我想说，恕我直言，Ajax 调用的真正用途是您可以保持在同一个窗口、页面和内容中而无需刷新。当您打开一个新窗口时，我认为查询字符串中包含报告 ID、日期、DateFrom 和 DateTo 的直接 URL 会更好吗？

如果是时间问题（生成报告需要一段时间），那么我个人只需将内容传递到新窗口中，然后让新窗口脚本将其注入`div`.

然后将其视为跨浏览器解决方案，而不是使用`setTimeout`IE hack ;)

# json - Webstorm JSON 代码风格

> ID：11140182
> 
> 赞同：4
> 
> 时间：2012-06-21T14:16:49.053
> 
> 标签：json, webstorm, autoformatting

在 webstorm 中自动格式化时，有没有办法在 JSON 对象中的冒号后获得一个空格？

其实我有：

```
{
    key:value
} 
```

我想要的是

```
{
    key: value
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T14:21:22.833

在 Intellij 我去这里，Webstorm 可能是一样的......

![在此处输入图像描述](../Images/32b1356fc4f2fe3a5ae25373c8a53d52.png)

# jsf-2 - 为 Datatable primefaces 设置列宽

> ID：11140183
> 
> 赞同：6
> 
> 时间：2012-06-21T14:16:55.780
> 
> 标签：jsf-2, primefaces

在设置数据表的列宽时需要一些帮助。但是，数据表的宽度似乎并不统一。数据表中列的宽度，似乎因列标题长度而异。请参考下面的代码。

```
 <p:column style="text-align: left; width:15px;" >
           <f:facet name="header">
              <h:outputText id="SalesHistoryID" value="View Sales History/Forecast"/>
           </f:facet>
           <h:commandLink  id="ForecastID" value="View"/> 
```

在上述情况下，列标题值长度“查看销售历史/预测”似乎很大，因此列宽度似乎也根据列标题文本值扩大。您能否让我知道是否有任何方法可以实际保持列宽的一致性，并且不依赖于列标题文本值。

如果列标题文本长度太大，有没有办法保持列宽的一致性？请协助。提前致谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-19T06:43:36.200

要为数据表设置列宽，请为数据表设置**resizableColumns="true"**属性，然后使用**width="10"**为列设置特定列的宽度，就是这样:)

```
<p:dataTable id="dataTable" var="question" value="#{QuestionsMB.questionsList}" rowKey="#{question.id}"
                        paginator="true" rows="10" selection="#{QuestionsMB.selectedQuestions}" 
                        paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                        lazy="true" rowsPerPageTemplate="10,15,50,100"
                        resizableColumns="true"
                        emptyMessage="No question found with given criteria" >
                <f:facet name="header">
                    Questions List
                </f:facet> 

                <p:column selectionMode="multiple"/> 

                <p:column id="questionHeader" width="10">
                    <f:facet name="header">
                        <h:outputText maxlength="20" value="Question text :" />
                    </f:facet>
                    <p:commandLink value="#{question.questionText}" update=":questionDetailForm:display" oncomplete="questionDialog.show()"  title="View">
                        <f:setPropertyActionListener value="#{question}" target="#{QuestionsMB.selectedQuestion}" />   
                    </p:commandLink>

                </p:column>
</p:dataTable> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-07T08:52:00.920

```
<p:dataTable id="id"  value="#{bean.mainList}"  var="dp" tableStyle="width:auto"  resizableColumns="true"  > 
```

`tableStyle="width:auto" , resizableColumns="true"`这将有助于适应列

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-21T15:05:17.577

表格元素上的 style="table-layout: fixed" 是您要查找的内容。默认表格布局为“自动”，确保没有单元格小于内容。请注意，无法容纳的文本会溢出。

# r - R 上 ecdf() 和 Ecdf() 的区别

> ID：11140185
> 
> 赞同：0
> 
> 时间：2012-06-21T14:16:58.553
> 
> 标签：r

我正在尝试绘制数据集的这种[行为](https://stats.stackexchange.com/questions/30864/estimating-alpha-parameter-in-a-stable-distribution)。我试过 Ecdf()

```
library(Hmisc)
dd<-read.table('critical.1.dat',head=F)
cdf<-Ecdf(dd$V1)
df<-hist(dd$V1)
ll<-((1-cdf$y[df$mids])/(df$density))
plot(df$mids,ll) 
```

似乎一切顺利。在这个[答案](https://stats.stackexchange.com/questions/30858/cumulative-distribution-in-r)之后，我尝试了 ecdf()

```
dd<-read.table('critical.1.dat',head=F)
cdf<-ecdf(dd$V1)
df<-hist(dd$V1)
ll<-(1-cdf(df$mids))/df$density
plot(df$mids,ll) 
```

结果看起来非常不同 Ecdf()。

我的错误在哪里？为什么他们看起来我不一样？

第一次编辑：我的实际代码是

```
library(Hmisc)
dd<-read.table('critical.1.dat',head=F)

cdf<-Ecdf(dd$V1)
ccdf<-ecdf(dd$V1)

df<-hist(dd$V1)

ll<-((1-cdf$y[df$mids])/(df$density))
llc<-(1-ccdf(df$mids))/df$density

par( mfrow = c( 2, 1 ) )

plot(df$mids,ll,ylab='Ecdf()')
plot(df$mids,llc,ylab='ecdf()') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:24:05.700

`Ecdf`返回一个列表，同时`ecdf`返回一个函数：

```
> set.seed(1)
> ch <- rnorm(1000, 200, 40)
> Echol <- Ecdf(ch, xlab="Serum Cholesterol")
> e.chol <- ecdf(ch)
> str(Echol)
List of 2
 $ x: num [1:1001] 79.7 79.7 80.1 82.4 84.4 ...
 $ y: num [1:1001] 0 0.001 0.002 0.003 0.004 0.005 0.006 0.007 0.008 0.009 ...
 - attr(*, "N")=List of 2
  ..$ n: num 1000
  ..$ m: num 0

> e.chol <- ecdf(ch)   
> str(e.chol)
function (v)  
 - attr(*, "class")= chr [1:3] "ecdf" "stepfun" "function"
 - attr(*, "call")= language ecdf(ch) 
```

总结下面的评论...... ECDF 的列表表示需要与功能表示不同的访问方法。因此，至少其中一个错误是在`cdf$y[df$mids]`处理来自`Ecdf()`. base::ecdf 函数的美妙之处在于它可以直接处理 X 值，而列表表示将需要使用类似`findInterval()`构造适当索引的函数。

# drupal - 用于多语言站点的 Drupal 6 或 Drupal 7

> ID：11140196
> 
> 赞同：0
> 
> 时间：2012-06-21T14:17:29.190
> 
> 标签：drupal, multilingual

我正在做一个多语言网站（英语、法语、西班牙语），我想知道 D7 是否比 D6 更适合开箱即用。

我需要安装哪些模块，最终什么是最佳选择。

# javascript - Python 和 PyWebkitGtk 在 webkit.WebView 中检测 Javascript 事件

> ID：11140198
> 
> 赞同：1
> 
> 时间：2012-06-21T14:17:37.947
> 
> 标签：javascript, python, event-handling, webkit, dom-events

我正在尝试检测何时`webkit.WebView`在 Python 中按下链接。是否有一种简单的方法来检测 Javascript 事件何时发生`PyWebkitGtk`？

# javascript - Excel Web Services 电子邮件 JavaScript 工作表

> ID：11140209
> 
> 赞同：1
> 
> 时间：2012-06-21T14:18:01.063
> 
> 标签：javascript, web-services, excel

是否可以获取 excel javascript 工作表的当前内容并通过电子邮件发送。有一个下载按钮，可让您下载工作表及其当前内容，但我找不到执行此操作的代码，如果可以的话，我可以通过电子邮件发送它，任何帮助获取工作表实例以通过电子邮件发送为一个excel文件会很好，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T03:25:31.377

我想您可能正在寻找快照功能 [http://msdn.microsoft.com/en-us/library/ms519570](http://msdn.microsoft.com/en-us/library/ms519570)

将快照写入您的电子邮件附件 (MAPI) 或将其加载到文件以进行附加。

# javascript - GetElementById 在 IE 中返回 Null

> ID：11140218
> 
> 赞同：2
> 
> 时间：2012-06-21T14:18:39.273
> 
> 标签：javascript

在下面的函数中，chld 仅在 IE 中为空，在 Firefox 中，javascript 工作正常。

```
 var div = document.createElement("div");

    var divid = "dv" + num;

    div.setAttribute("ID", divid);

    div.setAttribute("value", num);

    var _text = document.createElement("input");

    _text.setAttribute("type", "text");

    _text.setAttribute("id", "txtAsName" + num);

    _text.setAttribute("name", "txtAsName" + num);

    var lbl = document.createElement("label");

    var _upload = document.createElement("input");

    _upload.setAttribute("type", "file");

    _upload.setAttribute("ID", "upload" + num);

    _upload.setAttribute("name", "uploads" + num);

    _upload.setAttribute("size", "80");

    var hyp = document.createElement("a");

    //hyp.setAttribute("style", "cursor:Pointer");
    hyp.style.cssText='cursor:Pointer';

    //hyp.setAttribute("onclick", "return RemoveDv('" + divid + "');");
    hyp.onclick=function() {RemoveDv(divid);};

    hyp.innerHTML = "Remove";

    var br = document.createElement("br");

    var _pdiv = document.getElementById("Parent");

    div.appendChild(br);

    div.appendChild(lbl);

    div.innerHTML += ' ';

    div.appendChild(_text);

    div.innerHTML += ' ';

    div.appendChild(_upload);

    div.innerHTML += ' ';

    div.appendChild(hyp);

    _pdiv.appendChild(div); 
```

……

这是删除功能

```
 function RemoveDv(obj) {

        var p = document.getElementById("Parent");

        var chld = document.getElementById(obj);

        p.removeChild(chld);

    } 
```

这是我要删除的 div 标签看起来的谎言。

```
<div align="left" id="Parent">
    <div ID="dv1" value="1">
<div ID="dv2" value="2"> 
```

……

有趣的是，即使我“为了调试”添加了这行代码，chld1 仍然为空

```
var chld1 = document.getElementById("dv1"); 
```

更新：

代码本身似乎没有任何问题。如果我在 ie 中运行相同的代码，我的本地代码 chld 就会被设置。但是，如果我在我们的开发服务器上运行此代码，即看不到该元素。

任何想法为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T16:40:00.657

这是一个长镜头，但尝试将 div 上的大写 ID 属性更改为小写 ID。我没有 IE，现在无法自己测试...对不起

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:46:58.593

`ID`如果您在 DOM 中有多个相同的元素，则`document.getElementById`Internet Explorer 中的函数返回 null，而在 Firefox 中，它返回第一个找到的对象。

请检查您的代码以确保`id`页面上仅存在一个带有“父”的元素

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:45:30.977

您可以简单地保存参考并删除节点而无需搜索它们。

# asp.net - 在 Telerik RadGrid 中实现 linq 过滤器

> ID：11140219
> 
> 赞同：0
> 
> 时间：2012-06-21T14:18:48.267
> 
> 标签：asp.net, linq, webforms, telerik, radgrid

我有一个 Web 表单应用程序，它有一个带有 Telerik RadGrid 的页面。此网格使用 NeedDataSource 事件绑定，并且我已将大部分列更改为 CustomFilteringColumns。在其中一个中，我正在使用这样的一行：

```
((GridFilteringItem) ((filterControl).Parent)).FireCommandEvent("Filter", new  Pair("Custom", "Price")); 
```

过滤此网格包含的订单。由于其中有很多/超过 1000 个/我收到错误“Sys.WebForms.PageRequestManagerTimeoutException：服务器请求超时。”

我知道解决此问题的一种可能方法是使用带有 where 子句的 linq 查询，该子句将用作过滤器。

我的问题是：解决这个问题的最佳方法是什么？如果它使用的是 linq，我应该如何实现这个过滤器？

# objective-c - UITextView 报告不正确的高度

> ID：11140221
> 
> 赞同：0
> 
> 时间：2012-06-21T14:18:55.370
> 
> 标签：objective-c, ios, xcode, cocoa-touch

我有一个宽度为 240 的 UITextView。监视文本宽度显示当文本宽度 >= 224 时它正在换行文本。

在这种情况下，UITextView 将文本换行到下一行，但文本的长度不大于 240，文本高度被报告为好像是单行文本，而不是两行的高度（因为 UITextView 包装了它）。

任何想法为什么会发生这种情况以及我如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:13:49.413

UITextView 是 UIScrollView 的子类，并且应用了一些默认的插图——左侧和右侧均为 8 个像素。我从来没有设法找到摆脱它们的方法。

# javascript - 奇数表行行为

> ID：11140222
> 
> 赞同：0
> 
> 时间：2012-06-21T14:18:55.903
> 
> 标签：javascript, jquery, html-table

我的 Javascript 非常基础，但由于某种原因我遇到了麻烦。我有一个动态构建的表，我的脚本的目标是如果总行数超过 10 行，则选择最后 5 行，并将 CSS 样式应用于最后 5 行。我构建了一个精简示例，其中前 5 行应设为蓝色，后 5 行应设为红色。 [http://jsfiddle.net/helpinspireme/3zCp8/](http://jsfiddle.net/helpinspireme/3zCp8/)

可能有更好的方法来做到这一点。任何帮助，将不胜感激。

**回答**：
使用`slice()`使我能够实现我的目标。可以在这里看到：http: [//jsfiddle.net/helpinspireme/3zCp8/](http://jsfiddle.net/helpinspireme/3zCp8/) 谢谢凯文B。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:28:28.903

对于您在问题中所解释的内容，最简单的方法是：

```
var rows = $("table.primary_table > tbody > tr");
if (rows.length > 10) {
    rows.filter(":lt(5)").css("background-color", "blue")
        .end()
        .slice(-5).css("background-color", "red");
} 
```

[http://api.jquery.com/slice](http://api.jquery.com/slice)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:25:24.123

如果不看代码太久，我猜您正在寻找[gt](http://api.jquery.com/gt-selector/)和[lt](http://api.jquery.com/lt-selector/)选择器。

编辑：因为无论如何你都会得到所有行[slice()](http://api.jquery.com/slice/)可能会更好。

# c - 计算空格、制表符和换行符的程序

> ID：11140223
> 
> 赞同：2
> 
> 时间：2012-06-21T14:18:59.507
> 
> 标签：c, tabs, newline

我正在阅读**The C Programming Language**。这是一个问题，它是*写一个程序来计算空白、制表符和换行符*。现在我可以将**\n**用于换行符，将**\t**用于制表符，但我第一次听说空格！空白的真正含义是什么？对于换行符和制表符，我编译了以下程序：

```
#include <stdio.h>

/*  program to count blanks, tabs, and newlines */
main (){
    long blanks, tabs, newlines, input;

    blanks = 0;
    tabs = 0;
    newlines = 0;
    input = 0;
    while ((input = getchar()) != EOF)
        if (input == '\n')
            ++newlines;
        else if (input == '\t')
            ++tabs;

    printf("Total newlines: %ld\nTotal Tabs: %ld", newlines, tabs);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:21:33.907

空格 = 空格 ( `' '`)

尽管您的代码正在运行，但我强烈建议您`{ }`为 while 循环的主体添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:20:57.070

大多数时候，空白只是一个空格。您可能应该研究`isblank()`有助于分类的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:22:47.270

我确定它们的意思是空格字符''。

有关 ASCII 代码，请参见此处：

[http://www.asciitable.com/](http://www.asciitable.com/)

0x13也是回车，可能要找那个？换行符实际上并不那么简单，具体取决于文件的格式：

[http://en.wikipedia.org/wiki/Newline](http://en.wikipedia.org/wiki/Newline)

就像其他人所说的那样，您可能需要考虑使用来自

[http://www.cplusplus.com/reference/clibrary/cctype/](http://www.cplusplus.com/reference/clibrary/cctype/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-10T12:28:54.180

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
printf("Type and Press Enter. CTRL-Z for EOF:\n");
int c;
int b = 0;
int t = 0;
int nl = 0;

while((c = getchar())!=EOF){

    putchar(c);
    if(c=='\t')
        ++t;

    if(c==' ')
        ++b;
    if(c=='\n')
        ++nl

}

printf("\n%d and %d\n",b,t,nl);

return 0; 
```

}

您添加了一个 else if ，这里不需要，因为我们需要知道所有 3 个值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-01T11:43:21.053

请在下面找到代码，这将为您的完整问题提供解决方案。

```
#include <stdio.h>

/* Count blank, tabs, and new lines */

main ()
{
    long c, b, t, l;    /* c for characters, b for blanks, t for tabs, l for lines */

    b = 0;
    t = 0;
    l = 0;

    while ( ( c = getchar() ) != EOF )
    {

        if ( c == '\n')
        ++l;
        if ( c == '\t')
        ++t;
        if ( c == ' ')
        ++b;
    }

    printf ("\n No of blanks : %d \n", b);
    printf ("\n No of tabs : %d \n", t);
    printf ("\n No lines in input: %d \n", l);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-12T20:12:06.367

我认为空白是新行后跟新行

```
 #include<stdio.h>
        int main()
        {
            int c,nl,nb,nt;
            nl = 0;
            nb = 0;
            nt = 0;
            int flag =1;

            while((c = getchar()) != EOF){
                if(c == '\n')
                {
                    ++nl;
                    if(flag)
                    ++nb;
                    flag = 1;  
                }
                else
                flag = 0;     

                if(c == '\t')
                ++nt;     
            }
            printf("lines : %d, tabs: %d, blanks: %d", nl, nt, nb);     

            return 0;
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-09T04:16:57.477

这个答案——受益于其他用户的贡献——只使用了练习 1-8 所教的材料。当按下 Ctrl+z 时（我使用的是 Windows DOS），程序跳转到 printf 语句，打印答案，然后退出到 DOS 提示符。

```
#include <stdio.h>

/* Exercise 1-8\.  Write a program to count blanks, tabs, and newlines. */
int main()
{
    int bl, tb, nl, c;

    bl = 0;
    tb = 0;
    nl = 0;
    while ((c = getchar()) != EOF) {
        if (c == ' ')
            ++bl;
        if (c == '\t');
            ++tb;
        if (c == '\n');
            ++nl;
        }
    printf("Total blanks: %d\n", bl);
    printf("Total tabs: %d\n", tb);
    printf("Total newlines: %d\n", nl);
} 
```

按 Enter 键 5 次，按空格键 2 次，按 Tab 键 4 次，然后按 Ctrl+z，您将得到

空格总数：2 制表符总数：4 换行符总数：5

然后 DOS 提示符。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-06T17:07:32.823

我认为的解决方案是：

```
#include <stdio.h>
main() {
    int c, nl, nt, nb;

    nl = 0;
    nt = 0;
    nb = 0;

    while((c = getchar()) != EOF){
        if (c == '\n')
            ++nl;

        if (c == '\t')
            ++nt;

        if (c == ' ')
            ++nb;
        }    

    printf("Blanks: %d\nNewlines: %d\nTabs: %d\n", nl, nt, nb);  } 
```

# objective-c - 未知原因的分段错误

> ID：11140225
> 
> 赞同：0
> 
> 时间：2012-06-21T14:19:16.483
> 
> 标签：objective-c, debugging, segmentation-fault

我不确定这是否容易解决。我有一个我正在处理的objective-c项目，在我将以下obj-c文件添加到项目之前一切正常：
标题：[http://pastie.org/1387311](http://pastie.org/1387311)
实现： http: [//pastie.org /1387285](http://pastie.org/1387285)
我尝试在 GDB 中运行它，我得到的唯一输出是：

```
Program received signal EXC_BAD_ACCESS, Could not access memory.
Reason: KERN_INVALID_ADDRESS at address: 0x00000010
0x30d2d324 in ?? () 
```

使用 NSZombiesEnabled 运行它也没有任何结果。

有谁知道该代码有什么问题？提前致谢！

# php - Mysql Join而不替换原始id的值

> ID：11140232
> 
> 赞同：1
> 
> 时间：2012-06-21T14:19:39.897
> 
> 标签：php, mysql, sql, join

我正在尝试使用以下查询将我的用户表与另一个表连接起来......

```
SELECT * FROM (`activities`)
JOIN `users` ON `users`.`id` = `activities`.`user` 
WHERE `user_subdomain` = 'hi' OR user_subdomain = '' 
ORDER BY `activities`.`id` desc 
LIMIT 10 
```

有什么方法可以让用户的 id 不替换活动的 id 吗？

例如，当前如果有一个 id 为 10 且用户为 2 的活动，则在我运行查询后，该 id 将被 users 表的 id 替换并显示为 2。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:21:16.803

每当您连接表时，您应该明确选择而不是使用的列`SELECT *`，并在多个表中使用相同的列名时为它们指定列别名。

```
SELECT 
  activities.id,
  activities.othercol,
  /* Alias to userid */
  users.id AS userid,
  users.name,
  users.anothercolumn
FROM (`activities`)
  JOIN `users` ON `users`.`id` = `activities`.`user` 
WHERE `user_subdomain` = 'hi' OR user_subdomain = '' 
ORDER BY `activities`.`id` desc 
LIMIT 10 
```

尽管没有必要在每个表前添加表名，除非列名相同。

```
SELECT 
  activities.id AS activityid,
  othercol,
  users.id AS userid,
  name,
  anothercolumn 
```

# java - 单击按钮时未打开 Windows

> ID：11140233
> 
> 赞同：2
> 
> 时间：2012-06-21T14:19:43.317
> 
> 标签：java, swing

我有以下代码，它创建了一个带有两个按钮的简单窗口，这两个按钮又假设每个按钮打开一个窗口 - 主窗口打开得很好但是当你点击按钮时没有任何反应......

```
package presentation;

import java.awt.Container;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class ShowInventory extends JFrame {

    /**
     * 
     */
    private static final long serialVersionUID = 7479750059244371227L;
    private JPanel contentPane;
    private JButton catBtn = new JButton ("Display inventory by category");
    private JButton allBtn = new JButton ("Display all inventory");

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    ShowInventory frame = new ShowInventory();
                    frame.setVisible(true);
                } catch (Exception e) {
                    e.printStackTrace();
                    System.out.println("Exception - Sorry");
                }
            }
        });
    }

    /**
     * Default - details to be added
     */
    public ShowInventory() { // title bar name

        // layout here
        Container container = getContentPane();
        FlowLayout layout = new FlowLayout();
        container.setLayout(layout);
        layout.setAlignment(FlowLayout.CENTER);
        container.add(new JButton("Display inventory by category"));
        container.add(new JButton("Display all inventory"));

        catBtn.addActionListener (new ActionListener() {
            public void actionPerformed (ActionEvent event) {
                // controller code
                ShowByCategory frame = new ShowByCategory();
                frame.setVisible(true);
            }
        });

        allBtn.addActionListener (new ActionListener() {
            public void actionPerformed (ActionEvent event) {
                // controller code
                ShowAllInventory frame = new ShowAllInventory();
                frame.setVisible(true);
            }
        });

        setDefaultCloseOperation(EXIT_ON_CLOSE);
        pack();
        setVisible(true);
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:22:20.843

您可能需要替换这些行（创建全新的按钮）：

```
container.add(new JButton("Display inventory by category"));
container.add(new JButton("Display all inventory")); 
```

通过这个（它使用你的类的按钮，然后你添加监听器）：

```
container.add(catBtn);
container.add(allBtn); 
```

# javascript - JavaScript 和 CSS：在鼠标悬停时在元素上显示 div

> ID：11140237
> 
> 赞同：0
> 
> 时间：2012-06-21T14:20:01.473
> 
> 标签：javascript, css

我想在悬停时在元素（尤其是链接）上显示一个 div，例如在 Facebook 中，当您悬停个人资料图片时。

我知道这可以用 JavaScript 和 CSS 来完成，但不知道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:27:38.477

Facebook 的方法是简单地使用 CSS，这并不适用于所有浏览器。在这些浏览器中，Facebook 放弃了效果并始终显示只应在悬停时显示的元素：

```
#parent #child {
  display: none;
}
#parent:hover #child {
  display: block;
} 
```

在 IE7 及以下版本中使用条件 CSS 设置`display: block`为默认值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:28:41.873

这实际上可以用纯 css 完成，这是一个简单的例子：

HTML：

```
<div id='outer'>
    <div id='button'>
        <!-- your element here -->
    </div>
    <div id='popup'>
        <!-- your popup menu here -->
    </div>
</div> 
```

CSS：

```
#popup {
    visibility:hidden;
}

#outer:hover #popup {
    visibility:visible;
} 
```

# xcode - 在 Xcode 中打开同一个文件之前和之后在 Vim 中突出显示语法

> ID：11140238
> 
> 赞同：1
> 
> 时间：2012-06-21T14:20:02.563
> 
> 标签：xcode, vim, syntax-highlighting

当我在 Vim 中创建文件时，我的语法（对于任何语言）都会正确突出显示。假设我继续用 Xcode 打开同一个文件，保存，然后关闭文件。当我用 vim 重新打开同一个文件时，文件类型设置为“conf”。无论真正的文件类型如何（我通常使用 php、python、hmtl、javastcript、c 等），这种情况都会持续发生。为什么 vim 对文件文件类型的评估会改变，aft*emphasized text*er 用 Xcode 打开同一个文件？

我在 Lion 上运行 Xcode。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:22:39.847

虽然我不能确切地说为什么它`"conf"`在 Xcode 保存它之后恢复为文件类型，但你应该能够使用 filetype 的模式行将它强制为任何[你](http://vimdoc.sourceforge.net/htmldoc/options.html#modeline "vim 模式行")[想要](http://vimdoc.sourceforge.net/htmldoc/filetype.html "vim 文件类型")的。

例如，您将使用

```
"# vim: set filetype=python :" 
```

文档不是最清楚的，但您可以将模式行包装在目标语言的注释符号（`//`、`/*`、`#`、`<!--`等）中，它会注册。检查它是否使用`"set filetype"`（无参数）加载了所需的文件类型，它会告诉您当前使用的是什么。

`"filetype on"`您还想通过放入文件来确保打开文件类型检测`.vimrc`。

# python - 将这两个列表过滤为一个更好的方法是什么？

> ID：11140240
> 
> 赞同：1
> 
> 时间：2012-06-21T14:20:05.387
> 
> 标签：python, loops

## 背景

我有两个列表，第一个`items`包含大约 250 个元组，每个元组包含 3 个元素

```
(path_to_a_file, size_in_bytes, modified_time) 
```

第二个列表`result`包含最多 250 个元素，这是数据库查询的结果，该查询根据列表中的路径查找行`items`。元素的数量`result`取决于这些文件是否已经在数据库中。

结果中的每个元素都是从 SQLAlchemy 查询返回的行对象，其中包含行值的属性，（`path`，`mtime`并且`hash`是我在这里感兴趣的）

我正在尝试做的是过滤掉其中具有相同 mtime 的所有元素`items`（`results`并跟踪过滤的数量和总大小），并创建一个新列表，其中包含具有不同 mtime 或不具有不同 mtime 的项目存在于`result`. 需要存储具有不同 mtime 的`(path,size,mtime_from_result,hash_from_result)`项目以及不在数据库中的项目`(path,size,mtime,None)`。

我希望我没有把它过于本地化，但我觉得我需要解释我想要完成的问题才能提出这个问题。

## 问题

我想尝试让这个循环尽可能快，但最重要的部分是让它按预期工作。

当我遍历它们时从列表中删除项目是否安全？我注意到向前迭代有一个奇怪的结果，但向后迭代似乎没问题。有更好的方法吗？

我正在删除我匹配的项目（`i.path == j[0]`）因为我知道关系是 1 到 1 并且它不会再次匹配所以通过减少列表我可以在下一次迭代中更快地迭代它，更重要的是我得到留下所有不匹配的项目。

我不禁觉得我忽略了一个更好的解决方案，也许是列表理解或生成器。

```
send_items=[]
for i in result[::-1]:
    for j in items[::-1]:
        if i.path==j[0]:
            result.remove(i) #I think this remove is possibly pointless?
            items.remove(j)
            if i.mtime==j[2]:
                self.num_skipped+=1
                self.size_skipped+=j[1]
            else:
                send_items.append((j[0],j[1],i.mtime,i.hash))
            break
send_items.extend(((j[0],j[1],j[2],None) for j in items)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:34:05.020

我会这样做：

```
def get_send_items(items, results):
    send_items = []
    results_dict = {i.path:i for i in results}
    for p, s, m in items:
        result = results_dict.get(p)
        if result is None:
            send_items.append((p, s, m, None))
        elif result.mtime != m:
            send_items.append((p, s, result.mtime, result.hash))
    return send_items 
```

这是我对您的解决方案的分析（假设两者`result`的`items`长度均为 N）：

*   `result[::-1]`创建`result`so 调用的副本`result.remove(i)`不会影响迭代，也不会影响迭代。您只循环`result`一次，因此删除元素有点毫无意义。它只会创造额外的工作。
*   您可以调用`result[::]`创建`result`.
*   调用`items.remove(j)`实际上**会降低**效率。`remove()`花费 O(N) 时间。所以调用它会将算法的效率从 O(N^2) 降低到 O(N^3)。
*   通过使用 O(N) 额外内存（如在我的解决方案中），如果您使用字典或具有 O(1) 查找的集合，则可以将运行时间减少到 O(N)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:39:04.127

First stab:

```
items_dict = dict( (el[0], el[1:]) for el in items )
new = []
modified = []
other = []
for res in result:
    put_to = None
    item = items_dict.get(res.path, (None, None))
    if item is (None, None):
        put_to = new
    elif res.mtime != item[1]:
        put_to = modified
    else:
        put_to = other
    put_to.append( (res.path, item) ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:31:22.730

首先，我假设文件路径标识一个文件——它们是唯一的。

我们创建了一个结果字典，因此我们可以轻松地检查成员资格，并检查与其关联的值。

```
dict_results = {file: (size, modified_time) for file, size, modified_time in results} 
```

然后我们可以使用列表推导来过滤掉你不想要的元素：

```
[(file, size, modified_time) for file, size, modified_time in items if (file not in dict_results) or (not dict_results[file][1] == modified_time)] 
```

例如：

```
>>> results = [(1, 1, 1), (2, 2, 3)]
>>> items = [(1, 1, 1), (2, 2, 2), (3, 3, 3)]
>>> dict_results = {file: (size, modified_time) for file, size, modified_time in results}
>>> [(file, size, modified_time) for file, size, modified_time in items if (file not in dict_results) or (not dict_results[file][1] == modified_time)]
[(2, 2, 2), (3, 3, 3)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T14:32:57.890

如何按照 Marcin 的建议将结果插入到集合中，并使用列表推导来过滤项目：

```
mtimes_set = set(result[2] for result in results)
send_items = (item for item in items if item[2] not in mtimes_set) 
```

* * *

误解了路径部分。这仍然可以完成（尽管最后一组括号有点难看）：

```
path_dict = dict((result[0], result) for result in results)
send_items = (item for item in items if item[0] in path_dict and path_dict[item[0]][2] != item[2]) 
```

在这里，我正在创建一个可见路径的字典，然后是一个生成器，它返回在字典中具有路径并且具有不同 mtime 的那些。可以很容易地更改返回 path_dict 结果项目而不是现在而不是项目。

# c++ - 链表 C++ 实现

> ID：11140249
> 
> 赞同：2
> 
> 时间：2012-06-21T14:20:19.990
> 
> 标签：c++, templates, linked-list

我刚刚创建了 LinkedList 的实现（仅用于自学目的。）。我让它运行，但输出结果有点奇怪......这是代码：

```
#include "stdafx.h"
#include <iostream>
#include <stdio.h>

using namespace std;

template <class T>
class Node{
T datum;
Node<T> *_next;
public:
 Node(T datum)
{
    this->datum = datum;
    _next = NULL;
}
 void setNext(Node* next)
 {
     _next = next;
 }
 Node* getNext()
 {
     return _next;
 }
 T getDatum()
 {
     return datum;
 }          
};

template <class T>

class LinkedList{
Node<T> *node;
Node<T> *currPtr;
Node<T> *next_pointer;
int size;
public:
LinkedList(T datum)
  {
      node = new Node<T>(datum);
      currPtr = node;  //assignment between two pointers.
      next_pointer = node;
      size = 1;
  }
LinkedList* add(T datum)  // return pointer type.
{
   Node<T> *temp = new Node<T>(datum);
   currPtr->setNext(temp);
   currPtr = temp;
   size++;
   cout<<datum<<" is added.";
   return this; //pointer type specification
}
T next()
{
   T data = (*next_pointer).getDatum();
   cout<<data<<" is visited.";
   next_pointer = next_pointer->getNext();
   return data;
}
int getSize()
{
   return size;
}   
}; 
```

现在我尝试使用 LinkedList：

```
int main()
{
LinkedList<int> *list = new LinkedList<int>(1);
list->add(2)->add(3)->add(4);
cout<<endl;

printf("%d %d %d %d",list->next(),list->next(),list->next(),list->next());  \\One

cout<<list->next()<<"\n"<<list->next()<<"\n"<<list->next()<<"\n"<<list->next()<<endl; \\Two

cout<<list->next()<<endl;\\Three
cout<<list->next()<<endl;
cout<<list->next()<<endl;
cout<<list->next()<<endl;
} 
```

输出一会显示数据：4 3 2 1。二会显示 4 3 2 1。三会显示 1 2 3 4。我不知道运行时发生了什么。所有这些都应该以 1 2 3 4 的顺序输出数据......非常感谢您的帮助！谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T14:22:57.440

评估参数的顺序未指定，因此：

```
printf("%d %d %d %d",list->next(),list->next(),list->next(),list->next()); 
```

可以评估最后`list->next()`一个，或中间的...

编辑：只是解决我认为的问题，因为我怀疑这是实际代码：http: [//ideone.com/avEv7](http://ideone.com/avEv7)

# serialization - Symfony2 将 XML 数据非规范化为具有关系的 Doctrine 实体

> ID：11140251
> 
> 赞同：1
> 
> 时间：2012-06-21T14:20:24.093
> 
> 标签：serialization, symfony, doctrine-orm, denormalization

我正在使用 Symfony2 和 Doctrine 2.0。我正在尝试从 XML 提要中读取数据并将其映射到数据库中的新实体或现有实体。当 XML 提要中的数据发生更改时，我需要更新现有实体，但添加数据时，我应该创建新实体。

在我的实体类中，我使用以下非规范化方法将 XML 数据映射到实体的属性：

```
function denormalize(SerializerInterface $serializer, $data, $format = null) 
```

（在我的实体类中调用的 Symfony\Component\Serializer\Serializer 中定义）

此方法的文档声明“重要的是要了解 denormalize() 调用应该递归地对实现者的所有子对象进行非规范化。” 这就是我想要做的。但是实体不应该知道 EntityManager 那么我如何在 denormalize() 方法中检查相关/子实体是否已经存在？

亲切的问候，马修

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T08:14:32.657

在实体中调用 EntityManager 确实是一个坏主意（据我所知，在控制器之外）。

我从来没有遇到过这个问题，但如果我是你，我会尝试在你的一个控制器中进行非规范化，或者如果它真的让你感到困扰，在你在控制器中调用的服务中，你给你的 EntityManager (同样，最好在控制器本身中执行此操作，或者只是将您的对象发送到服务，以便它可以将 xml 非规范化“放入”对象中）。

最好的方法是编写一个无论给定实体如何都可以工作的控制器。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T23:14:39.763

我认为我的问题在于我的方法，而不是我的代码！

最初，每次我发现一个在 XML 中表示的实体时，我都会检查（使用 EntityManager）以查看它是新的还是现有的，然后再对其进行非规范化。我选择这条路线是因为 XML 中存在重复，而且我担心在 EntityManager 中创建重复的实体。检查一个实体是否已经存在意味着我可以更新现有实体而不是创建一个副本。现在，每当我发现一个以 XML 表示的实体时，我都会使用我的新方法将其去规范化为一个新实体。当然，这会在 EntityManager 中创建重复，就像在 XML 中一样，但这可以稍后处理，希望..！

到目前为止，这被证明是一个更好的解决方案，尽管我在尝试使用 $em->merge(); 合并 EntityManager 中的重复实体时遇到了一些问题；和级联= {“坚持”，“合并”}。我在这里发布了一个关于此的新问题：[Doctrine 2.1 - Relation Lost After ManyToMany Cascade Merge - Symfony2](https://stackoverflow.com/questions/11198434/doctrine-2-1-relation-lost-after-manytomany-cascade-merge)

马修

# c# - Ui 线程被阻塞，但仅在第一次调用 Webclient 异步方法时

> ID：11140255
> 
> 赞同：0
> 
> 时间：2012-06-21T14:20:42.517
> 
> 标签：c#, webclient

根据客户的要求，我编写了一个继承自 webclient 的通信类。他们希望能够“将自定义窗口表单作为进度条传递”，而不是我创建了一个实现 3 个属性的接口。无论如何，我遇到的问题是应用程序启动，我点击开始按钮可以这么说，我第一次这样做时，ui线程被冻结，几秒钟后它解冻并且进度条和数据开始下降。

但是，在最初的冻结之后，任何后续按下开始按钮都可以正常工作并且不会阻止线程任何想法？

以下是表格 1 中的相关代码

```
private void btnSubmit_Click(object sender, EventArgs e)
    {
        txtResponse.Text = "";
        progressForm = new ProgressFormTest();
        myCommunication = new CommunicationClient(progressForm);
        myCommunication.DownloadStringCompleted += new DownloadStringCompletedEventHandler(wc_RequestComplete);
        // myCommunication.DownloadProgressChanged += new DownloadProgressChangedEventHandler(wc_DownloadProgressChanged);
        myCommunication.Timeout += new EventHandler(wc_TimeOut);
        myCommunication.Cancelled += new EventHandler(myCommunication_Cancelled);

        progressForm.Show();
        myCommunication.TimeoutValue = (int)numConnectionTimeout.Value * 1000;

        myCommunication.DownloadStringAsync(new Uri(txtUrl.Text));

    } 
```

这里是交流课

```
 public class CommunicationClient:WebClient
    {
    private int step = 1000;
    private long bytesReceived;
    private long bytesSent;
    private Status status;
    private System.Timers.Timer _timer;
    private IProgress myProgressForm;

    /// <summary>
    /// Sets the timeout value in milliseconds
    /// </summary>
    public int TimeoutValue { get; set; }
    public int TimeElapsed { get; set; }
    public long BytesReceived
    {
        get
        {
            return bytesReceived;
        }
    }
    public long BytesSent
    {
        get
        {
            return bytesSent;
        }
    }

    public event EventHandler Timeout;
    public event EventHandler Cancelled;

    public CommunicationClient(IProgress progressForm)
    {
        myProgressForm = progressForm;
        _timer = new System.Timers.Timer(step);
        _timer.Elapsed += new ElapsedEventHandler(timer_Elapsed);
    }

    protected override void OnDownloadStringCompleted(DownloadStringCompletedEventArgs e)
    {
        _timer.Stop();
        if (status == Status.Completed)
        {
            myProgressForm.PercentComplete = 100;
            base.OnDownloadStringCompleted(e);
        }
    }

    protected override void OnDownloadProgressChanged(DownloadProgressChangedEventArgs e)
    {
        bytesReceived = e.BytesReceived;
        myProgressForm.BytesReceived = bytesReceived;
        if (e.TotalBytesToReceive == -1)
            myProgressForm.PercentComplete = calculateFakePercentage();
        else
            myProgressForm.PercentComplete = e.ProgressPercentage;
        base.OnDownloadProgressChanged(e);
    }

    protected virtual void OnTimeout(EventArgs e)
    {
        if (Timeout != null)
        {
            CancelAsync();
            this.Dispose();
            Timeout(this, e);
        }
    }

    protected virtual void OnCancelled(EventArgs e)
    {
        if (Cancelled != null)
        {
            this.Dispose();
            Cancelled(this, e);
        }
    }

    /// <summary>
    /// Cancels a pending asynchronous operation and raises the Cancelled Event
    /// </summary>
    /// <param name="Event">Set to true to raise the event</param>
    public void  CancelAsync(bool Event)
    {
        CancelAsync();
        if (Event)
        {
            status = Status.Cancelled;
            OnCancelled(new EventArgs());
        }
    }

    private void initialize()
    {
        status = Status.Completed;
        TimeElapsed = 0;
        _timer.Start();
    }

    new public void DownloadStringAsync(Uri url)
    {
        initialize();
        base.DownloadStringAsync(url);
    }

    private void timer_Elapsed(object sender, ElapsedEventArgs e)
    {
        TimeElapsed += step;

        if (TimeElapsed >= TimeoutValue)
        {
            _timer.Stop();
            status = Status.Timeout;
            OnTimeout(e);
        }
    }    

    //used when the website in question doesnt provide the content length
    private int calculateFakePercentage()
    {
        return  (int)bytesReceived * 100 / 60000 ;
    }        
} 
```

这是简单的接口 IProgressForm

```
public interface IProgress
{
    int PercentComplete
    {
        get;
        set;
    }
    long BytesReceived
    {
        get;
        set;
    }
    long BytesSent
    {
        get;
        set;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:57:37.137

Fixed it , I set the Proxy property from the webclient class to null and that seemed to fix it

# sql - 将 varchar 转换为没有日期的日期

> ID：11140258
> 
> 赞同：1
> 
> 时间：2012-06-21T14:20:51.847
> 
> 标签：sql, sql-server-2008, tsql

目标：
获得带有年份和月份的数据类型日期

问题：
需要帮助将varchar值转换为数据类型date

不幸的是，列中的数据中没有包含任何日期。仅限年份和月份。

我尝试在不使用日期的情况下转换为日期，但失败了。

Varchar(10) 列数据

```
data    
-------    
1997-05   
1984-12   
1988-11    
1984-10    
1984-02  
1984-01    
1984-04 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:23:06.347

假设返回给定月份的第一天是可以的，您可以使用：

```
SELECT CONVERT(DATE, data + '-01') FROM dbo.table; 
```

正如其他人所建议的那样，没有一天就不能约会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:25:30.177

如果您不关心这一天，您可以在数据中添加任意一天：

```
CAST(data + '-01' as date) 
```

# sql-server-2008 - SQL Server 2008 瑞典语/芬兰语排序规则

> ID：11140261
> 
> 赞同：2
> 
> 时间：2012-06-21T14:20:56.253
> 
> 标签：sql-server-2008, collation

排序规则是否`Finnish_Swedish_CI_AS`由 Latin-1 翻译支持？谁有好的翻译清单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:32:11.663

我相信不是，只有 Latin1_General_CI_AS 是 Latin-1

这里有一个很好的列表，感谢 google： [http ://www.serverintellect.com/support/sqlserver/change-database-collat​​ion.aspx](http://www.serverintellect.com/support/sqlserver/change-database-collation.aspx)

**排序规则名称：**

***（语言 = 排序规则）***

```
Afrikaans = Latin1_General_CI_AS 
Albanian = Albanian_CI_AS 
Arabic (Algeria) = Arabic_CI_AS 
Arabic (Bahrain) = Arabic_CI_AS 
Arabic (Egypt) = Arabic_CI_AS 
Arabic (Iraq) = Arabic_CI_AS 
Arabic (Jordan) = Arabic_CI_AS 
Arabic (Kuwait) = Arabic_CI_AS 
Arabic (Lebanon) = Arabic_CI_AS 
Arabic (Libya) = Arabic_CI_AS 
Arabic (Morocco) = Arabic_CI_AS 
Arabic (Oman) = Arabic_CI_AS 
Arabic (Qatar) = Arabic_CI_AS 
Arabic (Saudi Arabia) = Arabic_CI_AS 
Arabic (Syria) = Arabic_CI_AS 
Arabic (Tunisia) = Arabic_CI_AS 
Arabic (U.A.E.) = Arabic_CI_AS 
Arabic (Yemen) = Arabic_CI_AS 
Armenian (Republic of Armenia) = Latin1_General_CI_AS 
Azeri-Cyrillic (Azerbaijan)1 = Azeri_Cyrillic_90_CI_AS 
Azeri-Latin (Azerbaijan)1 = Azeri_Latin_90_CI_AS 
Basque = Latin1_General_CI_AS 
Belarusian = Cyrillic_General_CI_AS 
Bulgarian = Cyrillic_General_CI_AS 
Catalan = Latin1_General_CI_AS 
Chinese (Hong Kong S.A.R.)1 = Chinese_Hong_Kong_Stroke_90_CI_AS 
Chinese (Macau S.A.R.)2 = Chinese_PRC_90_CI_AS 
Chinese (PRC)2 = Chinese_PRC_CI_AS 
Chinese (PRC) = Chinese_PRC_Stroke_CI_AS 
Chinese (Singapore) = Chinese_PRC_90_CI_AS 
Chinese (Taiwan) = Chinese_Taiwan_Stroke_CI_AS 
Chinese (Taiwan) = Chinese_Taiwan_Bopomofo_CI_AS 
Croatian = Croatian_CI_AS 
Czech = Czech_CI_AS 
Danish = Danish_Norwegian_CI_AS 
Divehi1 = Divehi_90_CI_AS (Unicode only) 
Dutch (Belgium) = Latin1_General_CI_AS 
Dutch (Netherlands) = Latin1_General_CI_AS 
English (Australia) = Latin1_General_CI_AS 
English (Belize) = Latin1_General_CI_AS 
English (Canada) = Latin1_General_CI_AS 
English (Caribbean) = Latin1_General_CI_AS 
English (Hong Kong S.A.R.) = Latin1_General_CI_AS 
English (India) = Latin1_General_CI_AS 
English (Indonesia) = Latin1_General_CI_AS 
English (Ireland) = Latin1_General_CI_AS 
English (Jamaica) = Latin1_General_CI_AS 
English (Malaysia) = Latin1_General_CI_AS 
English (New Zealand) = Latin1_General_CI_AS 
English (Philippines) = Latin1_General_CI_AS 
English (Singapore) = Latin1_General_CI_AS 
English (South Africa) = Latin1_General_CI_AS 
English (Trinidad) = Latin1_General_CI_AS 
English (United Kingdom) = Latin1_General_CI_AS 
English (United States) = SQL_Latin1_General_CP1_CI_AS 
English (Zimbabwe) = Latin1_General_CI_AS 
Estonian = Estonian_CI_AS 
Faeroese = Latin1_General_CI_AS 
Farsi = Arabic_CI_AS 
Finnish = Finnish_Swedish_CI_AS 
French (Belgium) = French_CI_AS 
French (Canada) = French_CI_AS 
French (France) = French_CI_AS 
French (Luxembourg) = French_CI_AS 
French (Monaco) = French_CI_AS 
French (Switzerland) = French_CI_AS 
Galician (Spain) = Latin1_General_CI_AS 
Georgian = Latin1_General_CI_AS 
German (Austria) = Latin1_General_CI_AS 
German (Germany) = Latin1_General_CI_AS 
German (Liechtenstein) = Latin1_General_CI_AS 
German (Luxembourg) = Latin1_General_CI_AS 
German (Phone Book Sort) = German_PhoneBook_CI_AS 
German (Switzerland) = Latin1_General_CI_AS 
Greek = Greek_CI_AS 
Gujarati (India)3 = Indic_General_90_CI_AS (Unicode only) 
Hebrew = Hebrew_CI_AS 
Hindi3 = Indic_General_90_CI_AS (Unicode only) 
Hungarian = Hungarian_CI_AS 
Hungarian (Technical) = Hungarian_Technical_CI_AS 
Icelandic = Icelandic_CI_AS 
Indonesian = Latin1_General_CI_AS 
Italian (Italy) = Latin1_General_CI_AS 
Italian (Switzerland) = Latin1_General_CI_AS 
Japanese = Japanese_CI_AS 
Kannada (India)3 = Indic_General_90_CI_AS (Unicode only) 
Kazakh (Kazakstan)1 = Kazakh_90_CI_AS 
Konkani (India)3 = Indic_General_90_CI_AS (Unicode only) 
Korean (Extended Wansung) = Korean_Wansung_CI_AS 
Kyrgyz-Cyrillic (Republic of Kyrgyztan) = Cyrillic_General_CI_AS 
Latvian = Latvian_CI_AS 
Lithuanian = Lithuanian_CI_AS 
Macedonian (FYROM) = Macedonian_FYROM_90_CI_AS 
Malay (Brunei Darussalam) = Latin1_General_CI_AS 
Malay (Malaysia) = Latin1_General_CI_AS 
Marathi (India)3 = Indic_General_90_CI_AS (Unicode only) 
Mongolian-Cyrillic (Mongolia) = Cyrillic_General_CI_AS 
Norwegian (Bokmal) = Danish_Norwegian_CI_AS 
Norwegian (Nynorsk) = Danish_Norwegian_CI_AS 
Polish = Polish_CI_AS 
Portuguese (Brazil) = Latin1_General_CI_AS 
Portuguese (Portugal) = Latin1_General_CI_AS 
Punjab-Gurmuhki (India)3 = Indic_General_90_CI_AS (Unicode only) 
Romanian = Romanian_CI_AS 
Russian = Cyrillic_General_CI_AS 
Sanskrit (India)3 = Indic_General_90_CI_AS (Unicode only) 
Serbian (Cyrillic) = Cyrillic_General_CI_AS 
Serbian (Latin) = Cyrillic_General_CI_AS 
Slovak = Slovak_CI_AS 
Slovenian = Slovenian_CI_AS 
Spanish (Argentina) = Modern_Spanish_CI_AS 
Spanish (Bolivia) = Modern_Spanish_CI_AS 
Spanish (Chile) = Modern_Spanish_CI_AS 
Spanish (Colombia) = Modern_Spanish_CI_AS 
Spanish (Costa Rica) = Modern_Spanish_CI_AS 
Spanish (Dominican Republic) = Modern_Spanish_CI_AS 
Spanish (Ecuador) = Modern_Spanish_CI_AS 
Spanish (El Salvador) = Modern_Spanish_CI_AS 
Spanish (Guatemala) = Modern_Spanish_CI_AS 
Spanish (Honduras) = Modern_Spanish_CI_AS 
Spanish (International Sort) = Modern_Spanish_CI_AS 
Spanish (Mexico) = Modern_Spanish_CI_AS 
Spanish (Nicaragua) = Modern_Spanish_CI_AS 
Spanish (Panama) = Modern_Spanish_CI_AS 
Spanish (Paraguay) = Modern_Spanish_CI_AS 
Spanish (Peru) = Modern_Spanish_CI_AS 
Spanish (Puerto Rico) = Modern_Spanish_CI_AS 
Spanish (Traditional Sort) = Traditional_Spanish_CI_AS 
Spanish (Uruguay) = Modern_Spanish_CI_AS 
Spanish (Venezuela) = Modern_Spanish_CI_AS 
Swahili = Latin1_General_CI_AS 
Swedish = Finnish_Swedish_CI_AS 
Swedish (Finland) = Finnish_Swedish_CI_AS 
Syriac (Syria)1 = Syriac_90_CI_AS (Unicode only) 
Tamil (India)1 = Indic_General_90_CI_AS (Unicode only) 
Tatar (Tatarstan)1 = Tatar_90_CI_AS 
Telugu (India)1 = Indic_General_90_CI_AS (Unicode only) 
Thai = Thai_CI_AS 
Turkish = Turkish_CI_AS 
Ukrainian = Ukrainian_CI_AS 
Urdu = Arabic_CI_AS 
Uzbek (Latin)1 = Uzbek_Latin_90_CI_AS 
Uzbek-Cyrillic (Republic of Uzbeckistan) = Cyrillic_General_CI_AS 
Vietnamese = Vietnamese_CI_AS 
```

# php - PHPmailer 发送 HTML 代码

> ID：11140263
> 
> 赞同：33
> 
> 时间：2012-06-21T14:21:00.037
> 
> 标签：php

我正在使用 PHPmailer 发送电子邮件。

我还使用了 HTML = True 内容类型

```
 $mail = new PHPMailer();

$mail->IsSMTP();                    // send via SMTP
$mail->Host     = $Host; 
$mail->SMTPAuth = true;             // turn on SMTP authentication
$mail->Username = $Username;  
$mail->Password = $Password; 

$mail->From     = $From;
$mail->FromName = $FromName;

    $mail->AddAddress($To , $ToName);

$mail->WordWrap = 50;               // set word wrap
    $mail->Priority = 1; 
$mail->IsHTML(true);  
$mail->Subject  =  $Subject;
$mail->Body     =  $Body; 
```

发送电子邮件后，我会看到实际的 HTML 代码，而不是内容，请检查以下内容

![在此处输入图像描述](../Images/6f6f51c390a9d7cb03ed7bfed2ec1169.png)

**不确定是什么问题**

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-04-27T20:14:11.650

`isHTML()`在设置实例`Body`属性（我的意思是）之后调用该方法`$mail->Body`为我解决了这个问题：

```
$mail->Subject = $Subject;
$mail->Body    = $Body;
$mail->IsHTML(true);       // <=== call IsHTML() after $mail->Body has been set. 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-05-27T18:36:11.730

有`msgHTML()`方法，它也调用`IsHTML()`.

名字`IsHTML`很混乱...

```
/**
 * Create a message from an HTML string.
 * Automatically makes modifications for inline images and backgrounds
 * and creates a plain-text version by converting the HTML.
 * Overwrites any existing values in $this->Body and $this->AltBody
 * @access public
 * @param string $message HTML message string
 * @param string $basedir baseline directory for path
 * @param bool $advanced Whether to use the advanced HTML to text converter
 * @return string $message
 */
public function msgHTML($message, $basedir = '', $advanced = false) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-05T10:03:16.360

或者如果你还有问题，你可以使用这个

```
$mail->Body =  html_entity_decode($Body); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-08T22:27:11.600

在 5.2.7 版本中，我使用它来发送纯文本：

```
$mail->set('Body', $Body); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-01-07T12:04:26.163

只是您需要将 true 作为参数传递给 IsHTML() 函数。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-07-15T04:40:52.150

这样做 - 使用 GET 方法将您的 html 代码粘贴到单独的 html 文件中。

```
$mail->IsHTML(true);                                 
    $mail->WordWrap = 70;                                 
    $mail->addAttachment= $_GET['addattachment']; $mail->AltBody   
    =$_GET['AltBody'];  $mail->Subject = $_GET['subject']; $mail->Body = $_GET['body']; 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2016-02-08T21:40:59.320

您只需添加 $mail->IsHTML(true); 到代码它工作正常..

# ruby-on-rails - 策略内的 OmniAuth 动态客户端选项站点

> ID：11140266
> 
> 赞同：2
> 
> 时间：2012-06-21T14:21:13.563
> 
> 标签：ruby-on-rails, oauth, omniauth

我有一个 Rails 应用程序设置为 OAuth2 提供程序（使用 Doorkeeper）。该应用程序为每个用户帐户使用不同的子域（或通过 cname 记录使用完全不同的域）

```
i.e. 
user1.myrailsapp.com
user2.myrailsapp.com
www.mycustomdomain.com 
```

在提供商方面，一切都按预期工作。

我还有第二个应用程序，它是一个使用第一个应用程序公开 API 的客户端。我有一个版本的客户端工作，但仅在 OmniAuth 策略中使用硬编码的站点 url。

问题是，如何根据每个请求动态设置策略 url。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T07:51:58.753

对于任何感兴趣的人，解决方案是使用动态提供程序：[https ://github.com/intridea/omniauth/wiki/Dynamic-Providers](https://github.com/intridea/omniauth/wiki/Dynamic-Providers)

```
Rails.application.config.middleware.use OmniAuth::Builder do
  provider :mystrategy, ENV["OAUTH_ID"], ENV["OAUTH_SECRET"],
    :setup => lambda{|env| 
      env['omniauth.strategy'].options[:client_options].site = env['rack.session']['oauth_site']
    }
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-25T08:28:44.457

**一种选择是不要那样做。**

我有一个类似的应用程序并遇到了同样的问题。然而，在考虑了片刻之后，我意识到我不想将它们发送到用户帐户子域上的策略提供者 URL，因为该请求尚未完全验证（它尚未被 rails 应用程序处理） ）。

同样，第一次用户登录的用户帐户子域尚未设置，因此不可能路由到那里。

因此，我将策略回调 URL 设置为主网站。处理完登录请求、会话设置和所有内容后，我将客户端重定向到他们的用户子域。消除了整个痛苦。

# php - Mysql查询在QUERY中，每个id只有1个结果

> ID：11140267
> 
> 赞同：0
> 
> 时间：2012-06-21T14:21:13.120
> 
> 标签：php, mysql

请原谅我的标题含糊不清，我真的不知道如何简洁地写出我想要做的事情。

我有一张桌子

名称 - str item_id - int 位置 - int

```
 name        item_id   position
| 6asd |          17 |        1 |
| asdf |           3 |        1 |
| asdf |           3 |        2 |
| asdf |           3 |        3 |
| asdf |           3 |        4 | 
```

我正在尝试在列表上使用 IN 查询，`item_ids`并且每个项目仅返回 1 行，这应该是位置最低的行。

```
select name, item_id, position from my_table 
WHERE item_id IN (17, 3) AND name != ''; 
```

当我只想返回最低位置时，这将返回 item_id 的所有行。自然地，我查看了 ORDER_BY 和 LIMIT，但我的查询仅针对整个结果集而不是单独针对每个 id 完成。

`ORDER BY position ASC LIMIT 1`

有没有人尝试过这样做？任何帮助将不胜感激。我是否需要以某种方式使用子选择？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:25:48.720

使用可用的**[MIN()](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_min)**。

```
SELECT name, item_id, MIN(position)
FROM my_table 
WHERE item_id IN (17, 3) AND name != ''
GROUP BY item_id; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:25:48.337

我想您可能正在寻找[MIN()](http://www.tutorialspoint.com/mysql/mysql-min-function.htm)函数。

> MySQL MIN 函数用于找出记录集中具有最小值的记录。

尝试以下方式：

```
"SELECT name, item_id, MIN(position) 
 FROM my_table 
 WHERE item_id IN (17, 3) AND name != ''
 GROUP BY item_id"; 
```

# asp.net - 更改单选按钮中圆圈的背景颜色

> ID：11140270
> 
> 赞同：0
> 
> 时间：2012-06-21T14:21:17.973
> 
> 标签：asp.net

我有一个 RadioButtnList。我想根据单选按钮值更改正文背景颜色。

例如将背景圆圈的颜色更改为红色！

![在此处输入图像描述](../Images/ff2f7cadf0c7cd38744a0b8feb7993ba.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:30:38.033

用户做出选择后，根据选择的值，您将使用 css 更改页面的外观。

要了解如何使用`RadioButtonList`控件以及确定选定值，请查看此链接：[RadioButtonList 示例：如何在 asp.net](http://asp-net-example.blogspot.com/2008/10/radiobuttonlist-example-how-to-use.html)和[RadioButtonList 类](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.radiobuttonlist.aspx)中使用 RadioButtonList 控件。

要了解如何使用 CSS 更改背景颜色，请查看此链接：[CSS 背景](http://www.w3schools.com/css/css_background.asp)和[CSS 教程](http://www.w3schools.com/css/)和[逐步学习 CSS](http://www.csstutorial.net/)。

有关其他 CSS 信息，请查看[此 google 搜索](https://www.google.com/search?sugexp=chrome,mod=8&sourceid=chrome&ie=UTF-8&q=set%20background%20color%20css#hl=en&sclient=psy-ab&q=how%20to%20use%20css&oq=how%20to%20use%20css&aq=f&aqi=g4&aql=&gs_l=serp.3..0l4.3303.7680.0.7870.14.10.0.4.4.0.195.747.9j1.10.0...0.0.U6AFxF62mpQ&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=d6d29e77425191f3&biw=1336&bih=971)。

**暗示**

这假设您希望***整个***页面为红色：

```
html, body{
    background-color: #FF0000;
} 
```

**编辑**

如果您真的想按照您最近的评论建议更改单选按钮的“圆圈”，那么您无法更改它。单选按钮是本机控件。相反，您应该做的是使用图像为其选定和非选定状态制作您自己的类似单选按钮的控件。

这里有一个有用的链接（包括源代码），我认为它会让你动起来：[Resources for web Designers](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)，尽管你也可以找到一个很好的 jQuery 解决方案。

祝你好运！

# c# - 从 C# 中的 Youtube 嵌入 URL 获取 Youtube ID

> ID：11140273
> 
> 赞同：0
> 
> 时间：2012-06-21T14:21:27.720
> 
> 标签：c#, .net, regex

我需要从 youtube 嵌入 url 获取 youtube id/url。没有太多正则表达式（不必是正则表达式）经验，我很难从嵌入 url 中获取 url。有谁最简单的方法是什么？

[http://pastebin.com/708GPJnR](http://pastebin.com/708GPJnR)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:05:44.720

您的示例似乎不是完整的 youtube 视频 ID。据我了解，youtube 视频 ID 的长度为 11 个字符。

也就是说，我将您的示例嵌入式 URL 修改为 11 个字符（通过在末尾添加 1）并使用 XML 和您的问题评论中提到的正则表达式（[stackoverflow.com/a/1773972/56778](https://stackoverflow.com/a/1773972/56778)）的组合请执行下列操作：

```
var xmlFrag = @"<object width='530' height='319'>
                  <param name='movie' value='**http://www.youtube.com/v/973r7347&amp;hl=en_US&amp;fs=1&amp;rel=0**' />
                  <param name='allowFullScreen' value='true' />
                  <param name='allowscriptaccess' value='always' />
                  <embed src='http://www.youtube.com/v/973r7347111&amp;hl=en_US&amp;fs=1&amp;rel=0' type='application/x-shockwave-flash' allowscriptaccess='always' allowfullscreen='true' width='530' height='319'></embed>
                </object>";
var doc = new XmlDocument();
doc.LoadXml(xmlFrag);
var match = Regex.Match(doc.SelectSingleNode("/object/embed").Attributes["src"].Value,
                                          "^http://(?<domain>([^./]+\\.)*youtube\\.com)(/v/|/watch\\?v=)(?<videoId>[A-Za-z0-9_-]{11})", RegexOptions.IgnoreCase);

String youtubeId;
if (match.Success)
  youtubeId = match.Groups[4].Value; 
```

# ruby-on-rails - 具有离线客户端支持的消息队列

> ID：11140277
> 
> 赞同：1
> 
> 时间：2012-06-21T14:21:36.223
> 
> 标签：ruby-on-rails, ruby, queue, rabbitmq, publish-subscribe

是否有任何消息队列（MSMQ，RabbitMQ 等..）具有支持离线客户端的 ruby​​ 绑定可用 - 离线客户端我的意思是，如果我有一个客户端向服务器提交消息，并且它无法访问，客户端将持有内部队列中的消息，直到它再次连接。

是否有一些开源解决方案？似乎rabbitMQ不这样做，我可能是错的。

任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:43:50.160

RabbitMQ 就是这样做的。 [http://rubyamqp.info/articles/durability/](http://rubyamqp.info/articles/durability/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T17:09:54.393

如果您准备在每台机器上放置一个代理，您可以使用 RabbitMQ 执行此操作，然后让它们使用铲子连接到您的中央代理。然后每台机器在离线时在本地排队。不过跑起来比较麻烦。

# c# - 绑定重定向

> ID：11140282
> 
> 赞同：0
> 
> 时间：2012-06-21T14:21:46.270
> 
> 标签：c#, dependencies

我有很多组件，而且很多时候一个组件依赖于另一个组件。在 .Net 中，如果您对任何程序集进行更改，则应更改其程序集版本以反映此更改。然而，这会在依赖链上引发连锁反应。

处理此问题的一种方法是使用绑定重定向，主要是在您知道没有引入重大更改的情况下。

我的问题是 - 绑定重定向的使用有多不受欢迎？当产品投入生产时，我是否应该始终确保没有这些？

编辑 - 应用程序是基于通用框架的各种服务。我们是这些服务的唯一开发者和支持者。没有修补程序，只是在必要时推送新的 MSI。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-07-31T11:30:49.623

如果您对组件进行更灵活的版本检查，它们不会因次要版本更改而中断。( [http://semver.org/](http://semver.org/) )

这些例子是

```
<!-- Accepts any version 6.1 and above -->
<dependency id="ExamplePackage" version="6.1" />

<!-- Accepts any version above, but not include 4.1.3\. This might be
      used to guarantee a dependency with a specific bug fix. -->
<dependency id="ExamplePackage" version="(4.1.3,)" />

<!-- Accepts any version up below 5.x, which might be used to prevent
      pulling in a later version of a dependency that changed its interface.
      However, this form is not recommended because it can be difficult to
      determine the lowest version.  -->
<dependency id="ExamplePackage" version="(,5.0)" />

<!-- Accepts any 1.x or 2.x version, but no 0.x or 3.x and higher versions -->
<dependency id="ExamplePackage" version="[1,3)" />

<!-- Accepts 1.3.2 up to 1.4.x, but not 1.5 and higher. -
<dependency id="ExamplePackage" version="[1.3.2,1.5)" /> 
```

来自 [https://docs.microsoft.com/en-us/nuget/create-packages/dependency-versions](https://docs.microsoft.com/en-us/nuget/create-packages/dependency-versions)

因此，如果您的包可以接受任何版本 xx 及更高版本，则较小的版本更改不会影响您的解决方案。

# android - 我们如何在 Android 中使用 runOnUiThread？

> ID：11140285
> 
> 赞同：174
> 
> 时间：2012-06-21T14:21:49.710
> 
> 标签：android, ui-thread

我是 Android 新手，我正在尝试使用 UI-Thread，所以我编写了一个简单的测试活动。但我想我误解了一些东西，因为点击按钮 - 应用程序不再响应

```
public class TestActivity extends Activity {

    Button btn;
    int i = 0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        btn = (Button)findViewById(R.id.btn);
        btn.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                runThread();
            }
        });
    }

    private void runThread(){
        runOnUiThread (new Thread(new Runnable() {  
            public void run() {
                while(i++ < 1000){
                    btn.setText("#"+i);
                    try {
                        Thread.sleep(300);
                    } 
                    catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
             }
        }));
    }
} 
```

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2012-06-21T14:29:38.497

以下是更正的`runThread`功能片段。

```
private void runThread() {

    new Thread() {
        public void run() {
            while (i++ < 1000) {
                try {
                    runOnUiThread(new Runnable() {

                        @Override
                        public void run() {
                            btn.setText("#" + i);
                        }
                    });
                    Thread.sleep(300);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    }.start();
} 
```

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2015-01-16T20:56:04.170

只需将其包装为一个函数，然后从后台线程调用此函数。

```
public void debugMsg(String msg) {
    final String str = msg;
    runOnUiThread(new Runnable() {
        @Override
        public void run() {
            mInfo.setText(str);
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-06-21T14:24:31.143

你有它从后到前。您的按钮单击会导致调用`runOnUiThread()`，但这不是必需的，因为单击处理程序已经在 UI 线程上运行。然后，您的代码`runOnUiThread()`正在启动一个新的后台线程，您尝试在其中执行 UI 操作，然后失败。

相反，只需直接从您的点击处理程序启动后台线程。然后，将调用包装到对`btn.setText()`的调用中`runOnUiThread()`。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2015-11-04T20:15:55.697

```
runOnUiThread(new Runnable() {
                public void run() {
                //Do something on UiThread
            }
        }); 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2017-02-16T12:51:20.737

有几种使用 of 的技术`runOnUiThread()`，让我们看看所有

**这是我的名为AndroidBasicThreadActivity**的主线程（UI 线程），我将以各种方式从工作线程更新它 -

```
public class AndroidBasicThreadActivity extends AppCompatActivity
{
    public static TextView textView;
    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_android_basic_thread);

        textView = (TextView) findViewById(R.id.textview);

        MyAndroidThread myTask = new MyAndroidThread(AndroidBasicThreadActivity.this);
        Thread t1 = new Thread(myTask, "Bajrang");
        t1.start();
    }
} 
```

**1.) 通过将 Activity 的实例作为参数传递给工作线程**

```
class MyAndroidThread implements Runnable
{
    Activity activity;
    public MyAndroidThread(Activity activity)
    {
        this.activity = activity;
    }
    @Override
    public void run()
    {

        //perform heavy task here and finally update the UI with result this way - 
        activity.runOnUiThread(new Runnable()
        {
            @Override
            public void run()
            {
                AndroidBasicThreadActivity.textView.setText("Hello!! Android Team :-) From child thread.");
            }
        });
    }
} 
```

**2.) 在工作线程中使用 View 的 post(Runnable runnable) 方法**

```
class MyAndroidThread implements Runnable
{
    Activity activity;
    public MyAndroidThread(Activity activity)
    {
        this.activity = activity;
    }
    @Override
    public void run()
    {
     //perform heavy task here and finally update the UI with result this way - 
       AndroidBasicThreadActivity.textView.post(new Runnable()
      { 
        @Override
        public void run()
        {
            AndroidBasicThreadActivity.textView.setText("Hello!! Android Team :-) From child thread.");
        }
    });

    }
} 
```

**3.) 通过使用 android.os 包中** 的 Handler 类 如果我们没有上下文 ( `this`/ `getApplicationContext()`) 或 Activity 的实例 ( `AndroidBasicThreadActivity.this`)，那么我们必须使用 Handler 类，如下所示 -

```
class MyAndroidThread implements Runnable
{
    Activity activity;
    public MyAndroidThread(Activity activity)
    {
        this.activity = activity;
    }
    @Override
   public void run()
  {
  //perform heavy task here and finally update the UI with result this way - 
  new Handler(Looper.getMainLooper()).post(new Runnable() {
        public void run() {
            AndroidBasicThreadActivity.textView.setText("Hello!! Android Team :-) From child thread.");
        }
    });
  }
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2019-03-15T10:32:48.193

如果在片段中使用，则只需编写

```
getActivity().runOnUiThread(new Runnable() {
    @Override
    public void run() {
        // Do something on UiThread
    }
}); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-02-21T06:09:28.203

我们使用 Worker Thread 使应用程序更流畅并避免 ANR。在 worker Tread 的繁重过程之后，我们可能需要更新 UI。UI 只能从 UI Thread 更新。在这种情况下，我们使用 Handler 或 runOnUiThread 都有一个在 UI Thread 中执行的 Runnable run 方法。onClick 方法在 UI 线程中运行，因此这里不需要使用 runOnUiThread。

**使用 Kotlin**

在活动中，

```
this.runOnUiThread {
      // Do stuff
} 
```

从片段，

```
activity?.runOnUiThread {
      // Do stuff
} 
```

**使用 Java** ,

```
this.runOnUiThread(new Runnable() {
     void run() {
         // Do stuff
     }
}); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-10T02:42:03.460

你这个：

```
@UiThread
    public void logMsg(final String msg) {
        new Handler(Looper.getMainLooper()).post(new Runnable() {
            @Override
            public void run() {
                Log.d("UI thread", "I am the UI thread");

            }
        });
    } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2022-01-28T15:22:46.650

用于`fragment`：

```
requireActivity().runOnUiThread(() -> {
//your code logic
}); 
```

用于`activity`：

```
runOnUiThread(() -> {
//your code logic
}); 
```

**runOnUiThread**以一种可以使用我们的后台线程更新 UI 的方式使用。更多信息：[https ://www.tutorialspoint.com/how-do-we-use-runonuithread-in-android](https://www.tutorialspoint.com/how-do-we-use-runonuithread-in-android)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-10-27T06:46:24.423

您可以从此示例中使用：

在以下示例中，我们将使用此工具发布由后台线程处理的同义词搜索的结果。

为了在 OnCreate 活动回调期间完成目标，我们将设置 onClickListener 以在创建的线程上运行 searchTask。

当用户单击 Search 按钮时，我们将创建一个 Runnable 匿名类，用于搜索 R.id.wordEt EditText 中键入的单词并启动线程以执行 Runnable。

搜索完成后，我们将创建一个 Runnable SetSynonymResult 实例，以通过 UI 线程将结果发布回同义词 TextView 上。

这种技术有时不是最方便的，尤其是当我们无法访问 Activity 实例时；因此，在接下来的章节中，我们将讨论从后台计算任务更新 UI 的更简单、更简洁的技术。

```
public class MainActivity extends AppCompatActivity {

    class SetSynonymResult implements Runnable {
        String synonym;

        SetSynonymResult(String synonym) {
            this.synonym = synonym;
        }

        public void run() {
            Log.d("AsyncAndroid", String.format("Sending synonym result %s on %d",
                    synonym, Thread.currentThread().getId()) + " !");
            TextView tv = (TextView) findViewById(R.id.synonymTv);
            tv.setText(this.synonym);
        }
    }

    ;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Button search = (Button) findViewById(R.id.searchBut);
        final EditText word = (EditText) findViewById(R.id.wordEt);
        search.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Runnable searchTask = new Runnable() {
                    @Override
                    public void run() {
                        String result = searchSynomim(word.getText().toString());
                        Log.d("AsyncAndroid", String.format("Searching for synonym for %s on %s",
                                word.getText(), Thread.currentThread().getName()));
                        runOnUiThread(new SetSynonymResult(result));
                    }
                };
                Thread thread = new Thread(searchTask);
                thread.start();
            }
        });

    }

    static int i = 0;

    String searchSynomim(String word) {
        return ++i % 2 == 0 ? "fake" : "mock";
    }
} 
```

**来源**：

[异步 android 编程 Helder Vasconcelos](https://www.packtpub.com/application-development/asynchronous-android-programming-second-edition)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-12-26T01:22:09.557

这就是我使用它的方式：

```
runOnUiThread(new Runnable() {
                @Override
                public void run() {
                //Do something on UiThread
            }
        }); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-02T08:03:20.167

```
 @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        gifImageView = (GifImageView) findViewById(R.id.GifImageView);
        gifImageView.setGifImageResource(R.drawable.success1);

        new Thread(new Runnable() {
            @Override
            public void run() {
                try {
                    //dummy delay for 2 second
                    Thread.sleep(8000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }

                //update ui on UI thread
                runOnUiThread(new Runnable() {
                    @Override
                    public void run() {
                        gifImageView.setGifImageResource(R.drawable.success);
                    }
                });

            }
        }).start();

    } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-11-26T11:25:32.137

试试这个：`getActivity().runOnUiThread(new Runnable...`

这是因为：

1）您调用**runOnUiThread**中隐含的 this 指的是**AsyncTask**，而不是您的片段。

2）片段没有runOnUiThread。

但是，活动确实如此。

请注意，如果您已经在主线程上，Activity 只会执行 Runnable，否则它使用 Handler。如果你不想担心上下文，你可以在你的片段中实现一个处理程序，这实际上很容易：

// 一个类实例

```
private Handler mHandler = new Handler(Looper.getMainLooper()); 
```

// 代码中的其他任何地方

```
mHandler.post(<your runnable>); 
```

// ^ 这将始终在主线程的下一个运行循环中运行。

# iphone - 在用户终止或应用程序进入后台时保存应用程序数据字段

> ID：11140287
> 
> 赞同：0
> 
> 时间：2012-06-21T14:21:50.420
> 
> 标签：iphone, objective-c, xcode

我的应用程序需要保存一些数据（大约 100 个存储在数组中的双字段以及一些其他字符串数据）。我有一个方法 -(void) case2save 已经到位，可以在用户启动它并且一切正常时将数据保存到 NSDocumentDirectory，但是当应用程序被用户（家庭）终止时，我需要保存相同的数据或由 iOS。

我正在尝试使用委托中的 applicationDidEnterBackground 来调用我在视图控制器 .m 类中使用的相同方法，但是由于该函数是每个对象（不是类方法），所以我不能，但是如果我正在制作它是类方法我没有作为对象一部分的实际数据......所以这就是问题所在。

一个想法如何解决该问题并在应用程序终止或进入后台时保存数据？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:43:38.023

您可以在 appdelegate 中创建该函数，或者仅在 appdelegate.h 中声明该类的数据成员并使其成为属性并将该数据成员设置为 self 在您尝试保存数据的函数中，使用以下.....

```
//in Your Appdelegate.h suppose you have viewController named AbcViewController ....
AbcViewController  *abcVC;

create property ...
@property (nonatomic,retain) AbcViewController  *abcVC;

//in Your Appdelegate.m
@synthesize  abcVC;

//Now in function where you are trying to save database .....

AppdelegateClass   *app = (AppdelegateClass*)[[UIApplication sharedApplication]delegate];
 app.abcVC = self;

 //now call that function from applicationDidEnterBackground with the help of this object... 
```

希望这能解决您的问题...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:35:57.737

发送了一个通知，称为`UIApplicationDidEnterBackgroundNotification`。你可以在你的视图控制器中监听它并做任何你需要的响应。

# iphone - 为什么我不能显示Uibutton的图层属性值

> ID：11140291
> 
> 赞同：0
> 
> 时间：2012-06-21T14:21:54.357
> 
> 标签：iphone, objective-c, ios, uibutton

我只是通过在 xib 中创建的按钮的代码中设置一个插座来试验`layer`我的属性。`UIButton`

```
 NSLog(@"d button layer value%@",dButton.layer.backgroundColor); 
```

但输出如下：

```
 d button layer value(null) 
```

我的问题是：我们不能显示`layer`. `UIButton`我们都知道会为按钮设置一些默认值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T07:30:23.420

呸！！我终于得到了答案。实际上我试图在 NSlog 语句中使用 %@ 显示结构值。dButton.layer.backgroundColor 是 Quartz 内部用来表示颜色的基本数据类型。

因此，显示它们的方法是创建自己的可以解析值的类。

例如，有 CGRect、CGPoint 等的类函数，例如用于显示 CGRect 我们使用此代码

```
 NSLog(@"d button layer value%@",NSStringFromCGRect(dButton.layer.bounds)); 
```

但是没有为 CGColorRef 定义任何函数。

好的，正如 jrturton 所说，为了显示上述值，我们可以使用

```
 NSLog(@"d button layer value%@",[UIColor colorWithCGColor:button.layer.backgroundColor)] 
```

我希望每个人现在都明白了！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:33:23.307

根据以下[文档`CALayer`](http://developer.apple.com/library/ios/DOCUMENTATION/GraphicsImaging/Reference/CALayer_class/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004500-CH1-SW83)：

> 默认值为`nil`.

除非您明确更改它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-22T16:24:17.037

在[UIView](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html)的文档中，它说：

> 默认值为 nil，这会产生透明的背景颜色。

这段摘录描述了该`view.backgroundColor`属性，因此我假设该`view.layer.backgroundColor`属性是相同的。

希望这可以帮助！

# python - 在 Python 中匹配两个字母列表

> ID：11140297
> 
> 赞同：1
> 
> 时间：2012-06-21T14:22:09.283
> 
> 标签：python

如何在不考虑 Python 列表中字母出现顺序的情况下匹配两个字母列表

例如：认为我的第一个列表是`['a','b','c','d']`，我想将这个列表与另一个列表匹配，`['b','c','a','d']`然后得到一个输出为真。这该怎么做？我是 python 新手，需要你的帮助！

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T14:23:30.893

怎么样：

```
# if you don't want to consider duplicates either
output = set(your_first_list) == set(your_second_list)

# if duplicates matter
output = sorted(your_first_list) == sorted(your_second_list) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T14:25:46.073

你可以对它们进行排序：

```
In [1]: a = list('abcd')
In [2]: b = list('bcad')
In [3]: sorted(a) == sorted(b)
Out[3]: True

In [4]: a == b
Out[4]: False 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-21T14:49:54.727

我想到了一些不同的东西，就是这样：

```
all(x in a for x in b) and all(x in b for x in a) 
```

这将检查 中的所有字母是否`a`出现在 中`b`，以及 中的所有字母是否`b`出现在 中`a`。这意味着**如果** `a`和`b`是集合，它们“匹配”。

但既然已经有了很好的答案，我决定做一个速度比较，结果发现我的解决方案**比**Daren 和 Lev 建议的基于`sorted()`. 对于长度小于 100 个字符的字符串，它也优于达人的`set(a) == set(b)`.

```
import timeit, random, string

def randstring(length):
    return ''.join(random.choice(string.ascii_lowercase) \
                   for i in xrange(length))

def sortmatch(a,b):
    return sorted(a) == sorted(b)

def bothways(a,b):
    return all(x in a for x in b) and all(x in b for x in a)

def setmatch(a,b):
    return set(a) == set(b)

c1 = "sortmatch(a,b)"
c2 = "setmatch(a,b)"
c3 = "bothways(a,b)"

init = """
from __main__ import randstring, sortmatch, bothways, setmatch
a = randstring(%i)
b = randstring(%i)
"""

lengths = [5,20,100,1000,5000]
times = 10000

for n in lengths:

    t1 = timeit.Timer(stmt=c1, setup=init % (n,n))
    t2 = timeit.Timer(stmt=c2, setup=init % (n,n))
    t3 = timeit.Timer(stmt=c3, setup=init % (n,n))

    print("String length: %i" % n)
    print("Sort and match:  %.2f" % (t1.timeit(times)))
    print("Set and match:  %.2f" % (t2.timeit(times)))    
    print("Check both ways: %.2f\n" % (t3.timeit(times))) 
```

结果：

> 字符串长度：5
> 排序和匹配：0.04
> 设置和匹配：0.03
> 双向检查：0.02
> 
> 字符串长度：20
> 排序和匹配：0.11
> 设置和匹配：0.06
> 双向检查：0.02
> 
> 字符串长度：100
> 排序和匹配：0.53
> 设置和匹配：0.16
> 双向检查：0.25
> 
> 字符串长度：1000
> 排序和匹配：6.86
> 设置和匹配：0.89
> 双向检查：3.82
> 
> 字符串长度：5000
> 排序和匹配：36.67
> 设置和匹配：4.28
> 双向检查：19.49

# delphi - 以编程方式从表单中删除 TChart

> ID：11140299
> 
> 赞同：1
> 
> 时间：2012-06-21T14:22:13.227
> 
> 标签：delphi, teechart

我正在寻找正确的方法来删除 TChart 并释放所有内存。我正在使用带有标准 TeeChart 7 的 Delphi2007

我以编程方式创建 TChart：

```
var parentform: TForm;
begin
newchart:= TChart.Create(parentform);
newchart.Parent:= parentform;
... 
```

然后，我只想从表单中删除图表（而不是关闭表单本身），但我只得到图表变为空白并保留在表单上：

```
newChart.FreeAllSeries;
FreeAndNil(newChart); 
```

如果我使用

```
NewChart.Parent := nil, 
```

我不再看到图表，但我认为 TChart 对象仍然存在（直到父窗体被销毁）。有没有具体的方法来做到这一点？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T15:09:48.907

`TChart`就此而言，摆脱控件或几乎任何控件的最直接方法是调用`Free`它：

```
newChart.Free; 
```

如果你愿意，你可以打电话`FreeAndNil`代替。这与调用 具有相同的效果`Free`，但还将变量的值设置为`nil`。如果您稍后测试变量的值以检测您是否仍然可以访问控件，这将非常有用。如果您不再引用该变量，那么`FreeAndNil`您不会得到太多。

该控件将自动释放它拥有的其他东西，例如您手动释放的系列`FreeAllSeries`。你不需要自己释放它们。

仅仅清除控件的`Parent`属性并不会释放控件。您可以通过重新分配`Parent`属性并观察控件重新出现在屏幕上来证明这一点。如果控制不再存在，这种情况就不会发生。

如果释放后控件在屏幕上仍然可见，那么您还有其他问题。也许父控件没有正确地重新绘制自己。您可以尝试调用`Refresh`父控件。您可能还可以看到多个控件。毕竟，问题的代码创建了*两个*图表控件，因此其中一个可能仍然可见，而您将其误认为是您销毁的控件。

# c++ - 提供的示例代码上的 Qt 堆损坏

> ID：11140302
> 
> 赞同：2
> 
> 时间：2012-06-21T14:22:22.103
> 
> 标签：c++, qt, visual-studio-2010, heap-memory, heap-corruption

就在最近，我在我的计算机上安装了 Qt 库，作为一个完整的新手，我在线查找了 Qt 4.7 入门指南。

就在第一页，他们提供了以下代码：

```
 1        #include <QtGui>
  2
  3        int main(int argv, char **args)
  4        {
  5            QApplication app(argv, args);
  6
  7            QTextEdit textEdit;
  8            QPushButton quitButton("Quit");
  9
 10            QObject::connect(&quitButton, SIGNAL(clicked()), qApp, SLOT(quit()));
 11
 12            QVBoxLayout layout;
 13            layout.addWidget(&textEdit);
 14            layout.addWidget(&quitButton);
 15
 16            QWidget window;
 17            window.setLayout(&layout);
 18
 19            window.show();
 20
 21            return app.exec();
 22        } 
```

简单的东西，我想。在 Visual Studio Express 2010 中编写此代码、构建和运行后，几乎一切正常。但是，当我尝试通过“退出”按钮或显示窗口右上角的红色 x 关闭窗口时（启动“return app.exec()”），我收到以下信息：

一个对话框说，

ParticleTracker.exe 中 0x77bc15de 处的未处理异常：0xC0000005：访问冲突读取位置 0xdf94b4b4。

控制台输出说，

```
Critical error detected c0000374
Windows has triggered a breakpoint in ParticleTracker.exe.

This may be due to a corruption of the heap, which indicates a bug in ParticleTracker.exe or any of the DLLs it has loaded.

This may also be due to the user pressing F12 while ParticleTracker.exe has focus. 
```

进入调试模式后，我继续通过调用堆栈，同时反复收到堆损坏错误。

```
First-chance exception at 0x77c6e6c3 in ParticleTracker.exe: 0xC0000374: A heap has been corrupted.
Unhandled exception at 0x77bc15de in ParticleTracker.exe: 0xC0000374: A heap has been corrupted. 
```

所有后续异常都发生在可执行文件的 0x77bc15de 处，内存地址 0xC0000374 为损坏的堆。

老实说，我不确定我是如何得到这个问题的。我不精通 C++，但代码似乎没有任何问题。

在调用堆栈中，进程当前卡在： ParticleTracker.exe!main(int argv, char** args) 第 20 行 + 0x27 字节 如果我进入反汇编，进程卡在：

```
return app.exec();
00FE3831  mov         esi,esp  
00FE3833  call        dword ptr [__imp_QApplication::exec (0FE93D0h)]  
00FE3839  cmp         esi,esp  
00FE383B  call        @ILT+320(__RTC_CheckEsp) (0FE1145h)  
00FE3840  mov         dword ptr [ebp-150h],eax  
00FE3846  mov         byte ptr [ebp-4],5  
00FE384A  mov         esi,esp  
00FE384C  lea         ecx,[ebp-84h]  
00FE3852  call        dword ptr [__imp_QWidget::~QWidget (0FE9404h)]  
00FE3858  cmp         esi,esp 
```

有小费吗？非常感激。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T13:23:26.560

试试这个

```
#include <QtGui>

int main(int argv, char **args)
{
      QApplication app(argv, args);

      QTextEdit *textEdit = new QTextEdit();
      QPushButton *quitButton = new QPushButton("Quit");

      QObject::connect(quitButton, SIGNAL(clicked()), qApp, SLOT(quit()));

      QVBoxLayout *layout = new QVBoxLayout();
      layout->addWidget(textEdit);
      layout->addWidget(quitButton);

      QWidget *window = new QWidget();
      window->setLayout(layout);

      window->show();

      return app.exec();
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-01T12:57:33.940

这可能与所有权有关。当一个小部件被销毁时，它也会照顾它的孩子，在你的情况下，布局和子小部件。QWidget 析构函数试图破坏对象，但它们是在堆栈上分配的，而不是动态分配的。

尝试对 QLayouts 和小部件使用动态分配。

# web-services - Spring restTemplate.postForEntity（或 postForObject）在独立 Java 应用程序中给出错误“没有合适的 HttpMessageConverter”

> ID：11140303
> 
> 赞同：4
> 
> 时间：2012-06-21T14:22:23.610
> 
> 标签：web-services, spring, rest, resttemplate

我有 Spring 3.0 的独立 Java 应用程序。我正在调用带有 4 个整数参数的 REST 服务“发布”方法调用。在调用 restTemplate.postForEntity() 时，我收到错误“找不到适合请求类型的 HttpMessageConverter”。是否需要在 restTemplate 中设置任何 messageConverter ？我在网上找不到任何样本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:59:07.297

*有趣的是，我刚刚回答了[类似的问题](https://stackoverflow.com/questions/11138346/consuming-key-value-pairs-using-spring-resttemplate/11138549#11138549)......*

尽管如此，您可能想要查看出色的 Spring 参考手册，尤其是[这个片段](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/remoting.html#rest-resttemplate)、[文档](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/client/RestTemplate.html#postForObject%28java.lang.String,%20java.lang.Object,%20java.lang.Class,%20java.util.Map%29)、[IBM Dev 博客文章](http://www.ibm.com/developerworks/webservices/library/wa-restful/index.html)和[`RestTemplate`SpringSource 博客上的示例](http://blog.springsource.org/2009/03/27/rest-in-spring-3-resttemplate/)（何时编写）。

来自 SpringSource 博客文章：

> **HttpMessage转换器**
> 
> 传递给 getForObject()、postForLocation() 和 put() 方法并从方法返回的对象，并通过 HttpMessageConverters 转换为 HTTP 请求和 HTTP 响应。主要 mime 类型和 Java 类型的转换器默认注册，但您也可以编写自己的转换器并将其插入 RestTemplate。

此外，[IBM 博客文章在这里](http://www.ibm.com/developerworks/webservices/library/wa-restful/index.html#N10148)提到了常见的 HttpMessageConverter 实现，您可能会使用 Marshalling（XML 中的响应）或 MappingJackson（用于 JSON）之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T17:44:55.857

您调用的 REST 服务很可能会失败并且 postForObject() 返回 null。您需要使用 ResponseErrorHandler 实现检查错误。

# html - Out of flow div，但不是绝对定位

> ID：11140304
> 
> 赞同：0
> 
> 时间：2012-06-21T14:22:26.543
> 
> 标签：html, css, positioning, qtip2

我有一个很大`div`的背景图像。现在我想创建一些`div`'s 并将它们放在背景图像中的一些元素上，然后使用 qTip2 给出一些解释。在中间我想放一个表格。

```
<div id="bigdiv" style="background-image:url('back.jpg')">
    <div id="qtipbox1"></div>
    <div id="qtipbox2"></div>
    <div id="form"></div>
</div> 
```

问题是：如果我使用`position relative`qTip 框，表格会下降。如果我使用`absolute` `position`，当我调整窗口大小时，结果会有所不同。

我需要做什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:26:16.663

如果您分享相关代码或（甚至更好）在[JSFiddle](http://jsfiddle.net)上提供示例，这会有所帮助。

无论如何，您在带有大背景图像`position: relative`的容器`div`上使用，然后`position: absolute`在里面的元素上使用。这样，它们应该*相对于容器*绝对定位。

# playframework - 找不到能够调用操作 Security.authenticate 的路由

> ID：11140308
> 
> 赞同：0
> 
> 时间：2012-06-21T14:22:40.560
> 
> 标签：playframework, playframework-1.x

我编写了一个自己的安全类，派生自安全模块。我的路线表的一部分如下所示：

```
*       /authenticate           Security.authenticate 
```

我的模板如下所示：

```
<form action="@{Security.authenticate()}" method="POST">
<label for="user">E-Mail:</label>
<input type="text" name="email" id="email" />
   <label>password:</label>    <input type="password" name="password" size="19"/>
   <input type="submit" value="Signin" />
</form> 
```

我收到以下异常：

找不到能够调用操作 Security.authenticate 的路由。

在 /app/views/Security/index.html 中（大约第 11 行）

```
<form action="@{Security.authenticate()}" method="POST"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:33:31.950

你能给我们看看please的签名`authenticate(...)`吗？Play 可能需要一些参数来正确构建路线，具体取决于您在那里拥有的东西。

确保在覆盖之前指定您的路线。例如 ：

```
*     /authenticate                            Security.authenticate
*     /{controller}/{action}                   {controller}.{action} 
```

将第二行放在第一行之前，会导致您的路由被映射到 /security/authenticate 而不是 /authenticate。

# python - matplotlib - 单独子图中的图例

> ID：11140311
> 
> 赞同：11
> 
> 时间：2012-06-21T14:22:46.583
> 
> 标签：python, matplotlib, legend

我正在绘制一组饼图，每个饼图对相同的两种类型的数据使用相同的两种颜色。

```
plt.figure(num=None, figsize=(6, 8))
for i in range(len(data_1)):
    plt.subplot(sp_rows, sp_cols, i+1)
    fracs = [data_1[i], data_2[i]]
    plt.pie(fracs, autopct='%1.1f%%')

pp.savefig() 
```

显然，为这些图表中的每一个都绘制一个图例是没有意义的，因为它们都是相同的。那么有什么办法可以在最后将一个图例绘制成一个单独的子图？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-22T08:54:26.570

您只能调用一次 legend()：

```
import numpy as np
import pylab as pl

for i in xrange(1, 5):
    pl.subplot(220+i)
    pl.pie([i,2], labels=["a","b"], autopct='%1.1f%%')

l = pl.legend(title="sample")
pl.show() 
```

![在此处输入图像描述](../Images/202584e0a1d6e530d8a7b43b351e0ba1.png)

或者，如果您想在新轴中使用图例，只需创建一个虚拟饼图，并为其创建图例，然后隐藏虚拟饼图：

```
import numpy as np
import pylab as pl

for i in xrange(1, 5):
    pl.subplot(220+i)
    pl.pie([i,2], labels=["a","b"], autopct='%1.1f%%')

fig = pl.gcf()
axe = fig.add_axes([0.4,0.4,0.2,0.2])

pie = pl.pie([1,1], labels=["a","b"])
l = pl.legend(title="sample", loc="center")
for group in pie:
    for x in group:
        x.set_visible(False)

pl.show() 
```

![在此处输入图像描述](../Images/9b469c46784cafbe4428feafa1c88743.png)

# java - 如何让 wsimport 生成构造函数？

> ID：11140317
> 
> 赞同：9
> 
> 时间：2012-06-21T14:23:09.727
> 
> 标签：java, web-services, maven, wsimport

`wsimport`生成没有参数化构造函数的源代码。因此，如果 bean 有许多属性，则需要手动调用所有 setter：

```
Person person = new Person();
person.setName("Alex");

Address address = new Address();
address.setCity("Rome");

person.setAddress(address); 
```

像这样编写代码更具可读性和方便性：

```
Person person = new Person("Alex", new Address("Rome")) 
```

那么，有什么办法可以`wsimport`完成这项工作吗？（我正在使用 maven wsimport 插件）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-01-02T10:20:27.100

要将 wsimport 与 xjc 一起使用，请执行以下操作：

```
 <plugin>
            <groupId>org.jvnet.jax-ws-commons</groupId>
            <artifactId>jaxws-maven-plugin</artifactId>
            <version>2.3</version>

            <dependencies>
                <!-- put xjc-plugins on the jaxws-maven-plugin's classpath -->
                <dependency>
                    <groupId>org.jvnet.jaxb2_commons</groupId>
                    <artifactId>jaxb2-basics</artifactId>
                    <version>0.6.4</version>
                </dependency>
                <dependency>
                    <groupId>org.jvnet.jaxb2_commons</groupId>
                    <artifactId>jaxb2-value-constructor</artifactId>
                    <version>3.0</version>
                </dependency>
            </dependencies>
            <executions>
                          <execution>
                    <id>wsdl-gen</id>
                    <goals>
                        <goal>wsimport</goal>
                    </goals>
                    <configuration>
                        <wsdlDirectory>${project.basedir}/src/main/resources/wsdl/</wsdlDirectory>
                        <bindingDirectory>${project.basedir}/src/main/resources/wsdl</bindingDirectory>
                        <sourceDestDir>${project.build.directory}/generated-sources/wsimport</sourceDestDir>
                        <extension>true</extension>
                        <target>2.2</target>
                        <verbose>true</verbose>
                        <!-- tell JAXB to actually use xjc-plugins -->
                        <args>
                            <arg>-B-Xequals</arg>
                            <arg>-B-XhashCode</arg>
                            <arg>-B-Xvalue-constructor</arg>
                        </args>
                    </configuration>
                </execution>
    </executions>
        </plugin> 
```

关键部分是 -B ，它将传递 -X... 值。

...

```
 <args>
      <arg>-B-Xequals</arg>
      <arg>-B-XhashCode</arg>
      <arg>-B-Xvalue-constructor</arg>
   </args> 
```

...

这会生成一个值构造函数、equals 和 hashcode 方法。equals 和 hashcode 由 jaxb2-basics 插件提供。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T14:38:25.053

使用该工具的[JAXB 值构造器插件](http://java.net/projects/jaxb2-commons/pages/Value-constructor)`xjc`。您可以将它与[maven-xjc-plugin](http://java.net/projects/jaxb2-commons/pages/Value-constructor)一起使用，如下所示：

```
<project>
  ...
  <build>
    ...
    <plugins>
      ...
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>xjc-maven-plugin</artifactId>
        <version>1.0-beta-2-SNAPSHOT</version>
        <executions>
          <execution>
            <goals>
              <goal>xjc</goal>
            </goals>
            <configuration>
              <task><![CDATA[
                <xjc schema="src/main/resources/com/acme/services.xsd" package="com.acme">
                   <arg value="-Xvalue-constructor" />
                </xjc>
              ]]></task>
            </configuration>
          </execution>
        </executions>
      </plugin>
      ...
    </plugins>
    ...
  </build>
  ...
</project> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:40:15.017

`wsimport`用于`xjc`创建 Java 类。它支持插件，其中一些您可以在[jaxb2-commons](http://java.net/projects/jaxb2-commons/pages/Home)找到。还有一个构造函数插件，它为所有子元素创建一个带有参数的构造函数。

[jax-ws-commons](http://jax-ws-commons.java.net/jaxws-maven-plugin/examples/using-jaxb-plugins.html)页面包含有关如何将 XJC 插件与 JAX-WS Maven 插件一起使用的说明。

# zend-framework - 致命错误：在 zend 框架中调用未定义的函数 escape()

> ID：11140323
> 
> 赞同：-6
> 
> 时间：2012-06-21T14:23:32.330
> 
> 标签：zend-framework

> **可能重复：**
> [zend 框架中管理区域中的视图页面或站点后端不支持转义方法？](https://stackoverflow.com/questions/11135434/escape-method-is-not-supported-by-view-page-in-admin-area-or-backend-of-site-in)

我已经在我的本地主机上正确安装了 zend 框架并获得了 zend 框架默认索引页面。现在我在视图页面中使用转义方法并运行该页面，然后它显示以下错误：-

致命错误：调用未定义的函数 escape().....

我没有得到消除此错误的解决方案，我已设置虚拟主机并使用 Zend_Tool 命令创建站点结构，例如 zf create project myproject。

我以正确的方式获得了一个目录结构，当我在 localhost 上运行我的站点时，它显示了一个 zend 默认索引页面。所以我假设 zend 已经正确安装在我的系统上。zend_tool 创建的目录结构有一个空白库文件夹，并且在 myproject 文件夹的创建目录结构中没有显示 bin 文件夹。

我正在使用最新版本的 zend 框架 1.11.11

我很困惑为什么 escape() 方法不起作用

我在控制器中使用以下代码：-

```
$this->view->assign('username', 'Username');    
$this->view->assign('password', 'Password');
$this->view->assign('rememberMe', 'Remember Me'); 
```

我在视图页面中调用转义方法如下：-

```
<td id="userlogin" align="left" width="30%"><?php echo escape($this->username);?>:</td> 
```

在我的控制器中，我不包含任何文件。它只是一个简单的控制器文件，如下所示：-

```
<?php

class IndexController extends Zend_Controller_Action
{

    public function init()
    {
      /* Initialize action controller here */
    }

    public function indexAction()
    {
     // action body
    $request = $this->getRequest();  
    $this->view->assign('username', 'Username');    
    $this->view->assign('password', 'Password');
    $this->view->assign('rememberMe', 'Remember Me');
    }

} 
```

我在哪里犯了错误，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:34:23.290

`escape()`不是一个php函数。

如果你想使用 ZF 的视图助手 Zend_View_Helper_Escape，你需要在视图对象上调用它：

`<?php echo $this->escape($this->username);?>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:33:57.900

尝试`$this->escape($this->username);`而不是仅仅`escape($this->username);`

# git - 在 Cruisecontrol.NET 中使用密码 git

> ID：11140324
> 
> 赞同：3
> 
> 时间：2012-06-21T14:23:40.410
> 
> 标签：git, cruisecontrol.net

对不起，如果这个问题太简单了。我只是想知道如何添加有关用户名和密码的信息以访问 .git 上的 git 存储库`ccnet.config`。我找到了标签`<username>`，`<password>`但它们似乎不适用于 git（我见过的都是使用 VSS）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-24T03:35:28.470

GIT 使用 ssh 密钥访问存储库。Windows 上的配置可能有点棘手。如果您的 CCNet 实例没有作为您通常使用 git 操作的用户（即 LocalService）运行，那么您需要设置您的 openssh 密钥、known_hosts 文件和适当的环境变量，以便**LocalService**（或您的任何用户） using) 可以访问它们。

以下 wiki 文章适用于 Windows 上的 Jenkins CI 服务器，但解决方案可能与您的设置相同。

[Jenkins、GIT 插件和 Windows](https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin#GitPlugin-)

编辑：

让这个在 CCNet 中工作的更多技巧。

使用 SSH 时：

使用没有密码的公钥/私钥身份验证并设置您的 known_hosts。在您的用户主目录中创建一个 .ssh 目录（打开 msysgit 附带的 GitBash 终端并输入 PWD，即您的主目录）。在您的 .ssh 目录中创建一个 known_hosts 并在其中放入一个私钥（id_rsa、id_dsa）。known_hosts 需要您的 SSH 服务器的指纹，以便 CCNet 在启动连接时不会提示添加它（这将导致超时）。

# asp.net-mvc - 循环在头部 mvc 中不起作用

> ID：11140326
> 
> 赞同：0
> 
> 时间：2012-06-21T14:23:47.837
> 
> 标签：asp.net-mvc, loops, razor

我正在使用带有 .Net 4.0、mvc razor 2.0 的 Visual Studio 11

这是我的代码：

```
@section head{
<script>

    function functionTest(obj, no)
    {
        var i = 0;
        while( i < 5)
        {
            console.log('test');
            i++;
        }

    }

</script>

} 
```

我得到了这个错误：`Expected "}"`

当我删除循环并将其直接放入我的 _Layout.cshtml 它正在工作时，这似乎是导致问题的循环。

有人可以告诉我为什么它在我的部分不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:17:34.093

这是[Razor 2.0 解析器的一个已知问题](http://aspnetwebstack.codeplex.com/workitem/14)：它`<`在`@section`. 您可以通过将代码更改为来验证它：

```
while( 5 > i)
{
   console.log('test');
   i++;
} 
```

问题状态已修复，因此希望在 MVC4 的最终版本发布时能够正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:04:37.000

这是一个无限循环

```
while( i < 5)
    {
        console.log('test');
    } 
```

在您的浏览器控制台中尝试它，您将检查它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:18:11.957

尝试使用`<text>`标签。否则，javascript 将被解释为剃须刀代码。

```
@section head{
    <text>
        <script>
            function functionTest(obj, no)
            {
                var i = 0;
                while( i < 5)
                {
                    console.log('test');
                    i++;
                }
            }
        </script>
    </text>
} 
```

# ms-access - 访问“修复”中断了一个稍微复杂的查询

> ID：11140327
> 
> 赞同：2
> 
> 时间：2012-06-21T14:23:55.777
> 
> 标签：ms-access, ado, jet

我有一个在运行时创建 Jet 数据库并导入约 100k 记录的应用程序，以便我可以出于性能原因使用索引（1 分钟与不使用 Jet 数据库时近 10 分钟）。

该数据库是使用 Excel 中的 ADO 可扩展性创建的，一切正常。但是，每当我在 Access 前端打开 MDB 文件时，我的问题就会出现，它会自动开始“修复”数据库。

“修复”后数据仍然很好，但是我的主要输出查询无法在 Access 中查看，因为它告诉我它不能代表连接，如果我然后在 SQL 中查看它，则所需的连接不存在，并且查询无法再运行。如果我让它“修复”但不打开该查询，这仍然会发生，即破坏查询的是“修复”，而不是尝试在 Access 中查看它的行为。有趣的是，我使用 Access GUI 查询设计器来构造 SQL，因为我的生命太短了，不用担心它是疯狂的括号样式，但后来它决定它对自己来说太复杂了？

此外，似乎没有其他任何事情受到影响，所以我只能假设这是它不喜欢的一个查询。

这对我来说不是一个交易破坏者，因为我的解决方法是隐藏 MDB 并建议可以看到它的用户不要打开它。

但是，如果可以打开数据库并且我不必像那样将其隐藏起来，我真的很喜欢它。因此，我的问题是是否有任何方法可以防止 MDB 被自动“修复”？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T17:28:09.683

Microsoft Access 在打开文件时正在“修复”文件，因为它缺少某些特定于 Microsoft Access 用户界面的表。由于您直接使用带有 Microsoft.ACE.OLEDB.12.0 的 OLEDB 创建了 MDB 文件，因此这些表不存在，必须在 Access 第一次打开 MDB 时创建。有几种方法可以规避这种情况：

1) 将 MDB 命名为 .mdb 以外的名称 - 例如：`MyAccessDatabase.mad`- 这将阻止 Windows 使用 Microsoft Access 打开文件。

2) 使用 COM+ 打开 Microsoft Access 的实例，并让它创建 .MDB 文件。然后，此 .MDB 文件将包含所有必要的表，并且不需要修复该文件。

仅供参考，每当 Microsoft Access 打开需要以这种方式修复的 MDB 时，它都会检查所有 QueryDef 对象是否存在无效 SQL 并根据需要进行更正。这就是您的“复杂”查询中断的原因。

# matlab - 在 3d 中绘制 3 个向量

> ID：11140328
> 
> 赞同：2
> 
> 时间：2012-06-21T14:23:59.537
> 
> 标签：matlab, plot

在用函数计算&的点之后，我有 3 个向量，一个用于角度`Phi`，另一个用于角度`Teta`，最后一个是 中的点向量：`Y axe``Teta``Phi`

```
for teta = 0 : 10^-2 : pi/2 
    for phi = 0 : 10^-2 : pi/2 
        Y(current) = v*sin(phi)*sin(teta);  
        Teta(current) = teta;
        Phi(current) = phi;
        current = current + 1;
    end
end 
```

我怎样才能将它们三个一起绘制？

我想用&作为 的函数来绘制`3d`图表。我试过了，但结果不是那么令人满意。`Teta``Phi``Y``plot3`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:50:30.583

我不清楚确切的目标，但这是我的解释：

```
teta = 0:.01:pi/2;
phi =0:.01:pi/2;
[t p]=meshgrid(teta,phi);
Y = v*sin(p)*sin(t);
surf(t,p,Y)
xlabel('teta')
ylabel('phi')
zlabel('1*sin(teta)*sin(phi)') 
```

创建`teta`和`phi`值的向量，`meshgrid`用于生成 t 和 p 值的矩阵，并使用 的向量化形式`sin`（而不是`for`循环）。然后使用`surf`将结果绘制为 3D 曲面。![在此处输入图像描述](../Images/2910dbe14c4aaa0c4afc5f1a648b2ebf.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:43:28.490

![在此处输入图像描述](../Images/69d34c5333c04290b0bf8249847ba3aa.png)

这个好吗？我加大了步长并将 v 设置为 1。

```
current = 1;
for teta = 0 : 10^-1 : pi/2 
    for phi = 0 : 10^-1 : pi/2 
        Y(current) = 1*sin(phi)*sin(teta);  
        Teta(current) = teta;
        Phi(current) = phi;
        current = current + 1;
    end
end
plot3(Teta,Phi,Y);
xlabel('Teta')
ylabel('Phi')
zlabel('Y')
grid on 
```

# android - 如何使用我的 Android 设备中已有的 clocktopia 字体？

> ID：11140329
> 
> 赞同：0
> 
> 时间：2012-06-21T14:24:00.900
> 
> 标签：android, android-fonts

我的 android 设备上有一个`clocktopia`字体，它只在某些应用程序上。

**如何以编程方式使用该特定字体？**

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:39:25.653

首先，将 .ttf（或其他字体文件）放在 /assets 目录中。然后，使用以下代码设置 textview 的字体。

```
TextView textView = (TextView) findViewById(R.id.myTextView);
Typeface font = Typeface.createFromFile("path-to-file"); 
textView.setTypeface(font); 
```

不幸的是，您不能在 XML 中使用自定义字体（因此您也无法使用您的字体定义自定义主题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:45:03.543

[自定义字体和 XML 布局 (Android)](https://stackoverflow.com/questions/2376250/custom-fonts-and-xml-layouts-android)

您可以在此处使用 TextViewPlus 类提供程序从 xml 加载字体，但我不知道使用主题自动执行此操作的方法。

# trigger.io - Trigger.io：我在哪里可以找到由“forge run”命令创建的 android apk 文件？

> ID：11140332
> 
> 赞同：1
> 
> 时间：2012-06-21T14:24:06.877
> 
> 标签：trigger.io

在他们的文档中没有找到这个。“forge run android”生成的apk文件存放在哪里？我正在使用 Mac osx lion，如果它依赖于此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:35:20.187

命令期间会创建一个 APK `forge run android`，但在设备上安装后会立即删除；如果您需要创建 APK 以在其他地方使用或上传到 Google Play，请参阅`forge package android`。

[http://docs.trigger.io/en/v1.3/releasing.html#android](http://docs.trigger.io/en/v1.3/releasing.html#android)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-03T14:01:19.803

您需要生成一个密钥库文件，并在 forge 中运行 Package 命令：

1.  通过运行生成密钥库：`keytool -genkey -keystore choose-a-name.keystore -alias alias-name -keyalg RSA -keysize 2048 -validity 10000`。填写要求的信息。创建一个密钥库文件。
2.  通过网络浏览器运行`forge package android`文件或运行打包工具。如果是第一次运行，它会提示您提供在上一步中创建的密钥库文件以及您选择的密码。
3.  apk 文件的位置打印为输出。

有关签署应用程序的更多信息，请访问：http: [//developer.android.com/tools/publishing/app-signing.html](http://developer.android.com/tools/publishing/app-signing.html)。此外，Trigger 的文档也很有用：[https ://trigger.io/docs/current/recipes/release/release_mobile.html](https://trigger.io/docs/current/recipes/release/release_mobile.html)

# iphone - 核心数据 iPhone

> ID：11140333
> 
> 赞同：0
> 
> 时间：2012-06-21T14:24:08.607
> 
> 标签：iphone, objective-c, ios, core-data

我有返回的方法，`NSManagedObject`但我不知道`NSManagedObject`它是什么类型，因为根据具体情况，此方法可以返回标记为的 3 种类中的 1 种`NSManagedObject`。那么我怎么能理解`NSManagedObject`它返回的是哪一种呢？例如：firstObj、secondObj、thirdObj。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:28:03.860

要查询其实体名称，您可以简单地执行以下操作：

```
//Here myObj is your NSManagedObject instance
NSString *entityName  = [[myObj entity] name]; 
```

现在，如果您想了解更多信息，可以执行以下操作：

```
NSEntityDescription *desc = [myObj entity];
NSManagedObjectModel *model = [desc managedObjectModel]; //The managed object model
NSString *className = [desc managedObjectClassName]; //The class name
etc.. 
```

有关更多信息，请参阅`NSEntityDescription` [此处的文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/CoreDataFramework/Classes/NSEntityDescription_Class/NSEntityDescription.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-21T14:32:04.233

你可以使用类似的东西：

```
[obj isKindOfClass: [Subclass class]] 
```

# windows-phone-7 - 滚动查看器不工作

> ID：11140337
> 
> 赞同：1
> 
> 时间：2012-06-21T14:24:22.953
> 
> 标签：windows-phone-7, xaml

y 我的滚动查看器直到结束才滚动。它被击中到一个有限的位置。我附加了我的 xaml 代码。我在代码中放置了一个画布。滚动查看器位于 2 个网格内。

```
<ScrollViewer>
    <Canvas Margin="0,0,0,0">
        <toolkit:ListPicker x:Name="listPicker"  ItemTemplate="{StaticResource PickerItemTemplate}" 
                    FullModeItemTemplate="{StaticResource PickerFullModeItemTemplate}"  CacheMode="BitmapCache"
                    Header="" Margin="12,246,210,298" FontFamily="Yu Gothic" FontSize="22" FontWeight="SemiBold" Width="240" />

        <toolkit:ListPicker x:Name="listPicker2"  ItemTemplate="{StaticResource PickerItemTemplate}" ItemCountThreshold="3"
                    FullModeItemTemplate="{StaticResource PickerFullModeItemTemplate}"  CacheMode="BitmapCache"
                    Header=""  Margin="9,343,210,206" Width="240" />
        <toolkit:ListPicker CacheMode="BitmapCache" FullModeItemTemplate="{StaticResource PickerFullModeItemTemplate}" Header="" ItemCountThreshold="3" ItemTemplate="{StaticResource PickerItemTemplate}" Margin="12,440,210,108" Name="listPicker1" Width="240" />
        <toolkit:ListPicker CacheMode="BitmapCache" FullModeItemTemplate="{StaticResource PickerFullModeItemTemplate}" Header="" ItemCountThreshold="3" ItemTemplate="{StaticResource PickerItemTemplate}" Margin="11,546,210,2" Name="listPicker3" Width="240" />

        <TextBlock Height="40" HorizontalAlignment="Left" Margin="30,212,0,0" Name="textBlock1" Text="MONTHLY DEBTS" VerticalAlignment="Top" Width="185" FontSize="24" />
        <TextBlock Height="40" HorizontalAlignment="Left" Margin="290,212,0,0" Name="textBlock2" Text="AMOUNTS" VerticalAlignment="Top" Width="147" FontSize="24" />

        <clrtb:ClearableTextBox Canvas.Left="246" Canvas.Top="242" Height="75" Name="qualifytb" Width="208" />
        <clrtb:ClearableTextBox Canvas.Left="242" Canvas.Top="338" Height="75" Name="clearableTextBox1" Width="208" />
        <clrtb:ClearableTextBox Canvas.Left="246" Canvas.Top="436" Height="75" Name="clearableTextBox2" Width="208" />
        <clrtb:ClearableTextBox Canvas.Left="244" Canvas.Top="542" Height="75" Name="clearableTextBox3" Width="208" />
        <TextBlock Text="DEBT RATIO" Canvas.Left="148" Canvas.Top="642" FontSize="26" FontWeight="Medium" />
        <TextBlock Text="Conv Debt Ratio:" Canvas.Left="30" Canvas.Top="700" FontSize="26" FontWeight="Medium" />
        <TextBlock Text="FHA Debt Ratio:" Canvas.Left="30" Canvas.Top="800" FontSize="26" FontWeight="Medium" />
        <TextBlock Text="VA Debt Ratio:" Canvas.Left="30" Canvas.Top="900" FontSize="26" FontWeight="Medium" />
        <clrtb:ClearableTextBox Canvas.Left="250" Canvas.Top="700" Height="75" Name="rt1" Width="208" />
        <clrtb:ClearableTextBox Canvas.Left="320" Canvas.Top="700" Height="75" Name="rt2" Width="208" />
        <clrtb:ClearableTextBox Canvas.Left="250" Canvas.Top="800" Height="75" Name="rt3" Width="208" />
        <clrtb:ClearableTextBox Canvas.Left="320" Canvas.Top="800" Height="75" Name="rt4" Width="208" />
        <clrtb:ClearableTextBox Canvas.Left="250" Canvas.Top="900" Height="75" Name="rt5" Width="208" />
    </Canvas>
</ScrollViewer> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:30:29.987

我发现了这个 SO 问题：[ScrollBars are not visible after changes of controls of controls inside a Canvas](https://stackoverflow.com/questions/3061400/scrollbars-are-not-visible-after-changing-positions-of-controls-inside-a-canvas)，这基本上是一个类似的问题。这个问题是特定于 WPF 的，但也可以应用于 WP/Silverlight。

问题是`Canvas`总是返回`DesiredSize`(0, 0)，所以 ScrollViewer 永远不会认为它需要滚动。

解决方案很简单：只需使用`StackPanel`or`Grid`代替`Canvas`. 如果您真的需要 Canvas，则必须覆盖[MeasureOverride](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.measureoverride.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T20:25:16.677

`Canvas` is not the right layout panel to be using, it's going to produce weird behavior the way you're using it. It's meant to be used when you need finite control over positioning and you are willing to write significant logic to support edge cases that pop up. Try using `Grid`, and configure it with columns and rows.

# ruby-on-rails - 如何显示 pg-search 多搜索结果的摘录

> ID：11140339
> 
> 赞同：2
> 
> 时间：2012-06-21T14:24:23.773
> 
> 标签：ruby-on-rails, pg-search

我在 Heroku 上的 Rails 应用程序中设置了 pg_search：

```
@query = 'fast'
PgSearch.multisearch(@query) #=>
[#<PgSearch::Document searchable: ferrari, :content: 'this car is really fast'>,
 #<PgSearch::Document searchable: viper, :content: 'a very fast car'>] 
```

我想用摘录显示这些结果，`content`以显示匹配发生的位置。当只有一个词时，我可以调用`excerpt(content, @query)`以获得我想要的确切内容，但只处理完全匹配，所以如果：`@query``excerpt()`

```
@query = 'car fast'
PgSearch.multisearch(@query) #=>
[#<PgSearch::Document searchable: ferrari, :content: 'this car is really fast'>,
 #<PgSearch::Document searchable: viper, :content: 'a very fast car'>] 
```

then`excerpt(content, @query)`为 nil，因为在任何地方都`content`没有出现确切的短语“car fast”。

我考虑`excerpt(content, @query.split(' ').first)`至少为多词查询显示*一些东西*，但仍然存在这样的情况：

```
@query = 'car?'
@results = PgSearch.multisearch(@query) #=>
[#<PgSearch::Document searchable: ferrari, :content: 'this car is really fast'>,
 #<PgSearch::Document searchable: viper, :content: 'a very fast car'>]
excerpt(@results.first.content, @query) #=> nil 
```

那么，人们在使用 pg_search 时如何显示搜索结果的摘录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-13T18:42:12.193

我是 pg_search 的作者和维护者。

目前还没有一种内置的方法可以在 pg_search 中获取与您的结果并列的摘录，但如果我或其他人有时间构建它，很容易做到这一点。

PostgreSQL 有一个函数[ts_headline](http://www.postgresql.org/docs/9.2/static/textsearch-controls.html#TEXTSEARCH-HEADLINE)，您可以调用它以列形式返回字符串摘录。

可能会调用这样的东西（我还没有测试过）：

```
PgSearch.multisearch(@query).select(["ts_headline(pg_search_documents.content, plainto_tsquery(?)) AS excerpt", @query]) 
```

然后你的每个结果都应该有一个`excerpt`返回你想要的东西的方法。

顺便说一句，这是我最终想在 pg_search 中自动实现的东西。我只是还没有时间深入研究它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:47:02.913

FWIW——按照上面 nertzy 的例子，我能够让它与以下内容一起工作：

```
PgSearch.multisearch(@query).select("ts_headline(pg_search_documents.content, plainto_tsquery('english', ''' ' || unaccent('#{@query}') || ' ''' || ':*')) AS excerpt") 
```

我在开始工作时遇到了麻烦`plainto_tsquery(?)`，因为它抛出了一个语法错误。我上面的解决方案只是做的结果

```
PgSearch.multisearch(@query).select(["ts_headline(pg_search_documents.content, plainto_tsquery(?)) AS excerpt", @query]).to_sql 
```

然后插入`to_tsquery`新`plainto_tsquery`调用的参数——我敢肯定这并不完全正确，但似乎有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-19T22:19:51.003

如果对字符串进行插值，就会受到 sql 注入攻击。

由于`.select`不会接受像`.where`dos ( `Users.where("id = ?", params[:id])`) 这样的参数化语句，因此您需要显式清理。

```
sanitized = ActionController::Base.helpers.sanitize(params[:q])
@results = PgSearch.multisearch(params[:q])
                  .select(["ts_headline(pg_search_documents.content, plainto_tsquery('english', ''' ' || '#{sanitized}' || ' ''' || ':*')) AS excerpt"]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-15T12:51:01.757

有一种更简单的方法，如果您不想深入研究 SQL - 您可以利用内置的 pg_search gem 功能以非常简单直接的方式显示摘录：

在您的控制器中：

```
@articles = Article.search(params[:search]).with_pg_search_highlight 
```

在您看来：

```
= raw(article.pg_search_highlight) 
```

那应该这样做。

# c# - ASP.Net MVC AsyncController 日志请求处理时间

> ID：11140341
> 
> 赞同：3
> 
> 时间：2012-06-21T14:24:27.253
> 
> 标签：c#, asp.net, asp.net-mvc-3, ihttpmodule, asynccontroller

我需要获取 asp.net MVC 的请求处理时间。我使用 IHttpModule 订阅 onBeginRequest 和 onEndRequest 事件。对于同步控制器，它工作得很好，但对于异步，它返回错误的结果（例如 20 毫秒，而实时时间约为 2 分钟）。如何以一般方式获得 AsyncController 的请求处理时间（不在 ActionAsync/ActionCompleted 中为每个异步操作编写附加代码）？

```
public class TrackRequestModule : RequestProcessingModuleBase, IHttpModule
{
    public const string BeginRequestTimeKey = "beginRequestTime";

    public void Init(HttpApplication context)
    {
        if (context == null)
        {
            throw new ArgumentNullException("context");
        }

        context.BeginRequest += onBeginRequest;
        context.EndRequest += onEndRequest;
    }

    private void onEndRequest(object sender, EventArgs e)
    {
        InvokeHandler(sender, OnEndRequest);
    }

    private void onBeginRequest(object sender, EventArgs e)
    {
        InvokeHandler(sender, OnBeginRequest);
    }

    public void OnBeginRequest(HttpContextBase context)
    {
        context.Items[BeginRequestTimeKey] = DateTime.Now.ToLocalTime();
    }

    public void OnEndRequest(HttpContextBase context)
    {
        var beginRequestTime = (DateTime)context.Items[BeginRequestTimeKey];
        TimeSpan elapsedTime = DateTime.Now.ToLocalTime() - beginRequestTime;

        var info = new RequestData
                    {
                        BeginTime = beginRequestTime,
                        ElapsedTimeMilliseconds = elapsedTime.Milliseconds,
                        Url = context.Request.Url.AbsoluteUri,
                        Data = GetRequestData(context.Request)
                    };
        ThreadPool.QueueUserWorkItem(logRequestInfo, info);
    }

    public void Dispose() { }

    private void logRequestInfo(object state)
    {
        var info = (RequestData)state;
        var queryStore = ObjectBuilder.Instance.Resolve<IRequestTrackingDataQueryStore>();
        queryStore.SaveRequestTrackingData(info.BeginTime, info.ElapsedTimeMilliseconds, info.Url, info.Data);
    }

    private sealed class RequestData
    {
        public DateTime BeginTime { get; set; }
        public int ElapsedTimeMilliseconds { get; set; }
        public string Url { get; set; }
        public string Data { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-22T12:09:06.070

这很奇怪。通常这种情况应该有效。不幸的是，您没有显示您的代码，因此很难说出您可能做错了什么。

此外我无法重现它。这是我写来测试的模块：

```
public class MeasureModule : IHttpModule
{
    private static readonly ReaderWriterLockSlim _gateway = new ReaderWriterLockSlim();

    public void Dispose()
    {
    }

    public void Init(HttpApplication context)
    {
        context.BeginRequest += (sender, e) =>
        {
            var app = (sender as HttpApplication);
            var watch = Stopwatch.StartNew();
            app.Context.Items["watch"] = watch;
        };

        context.EndRequest += (sender, e) =>
        {
            var app = (sender as HttpApplication);
            var watch = app.Context.Items["watch"] as Stopwatch;
            watch.Stop();
            var url = app.Context.Request.Url.AbsoluteUri;
            var message = string.Format("url: {0}, time: {1}ms", url, watch.ElapsedMilliseconds);
            var log = HostingEnvironment.MapPath("~/log.txt");
            _gateway.EnterWriteLock();
            try
            {
                File.AppendAllLines(log, new[] { message });
            }
            finally
            {
                _gateway.ExitWriteLock();
            }
        };
    }
} 
```

我在 web.config 中注册（我在 Cassini 下测试过，如果您打算使用 IIS 7，则必须在相应`<system.webServer>`部分注册模块）：

```
<httpModules>
  <add name="measure" type="MvcApplication.Modules.MeasureModule, MvcApplication" />
</httpModules> 
```

然后写了一个示例控制器来测试：

```
[SessionState(SessionStateBehavior.Disabled)]
public class HomeController : AsyncController
{
    public ActionResult IndexSync()
    {
        Thread.Sleep(5000);
        return Content("completed", "text/plain"); 
    }

    public void IndexAsync()
    {
        AsyncManager.OutstandingOperations.Increment();
        Task.Factory.StartNew(() =>
        {
            Thread.Sleep(5000);
            AsyncManager.OutstandingOperations.Decrement();
        });
    }

    public ActionResult IndexCompleted()
    {
        return Content("completed", "text/plain");
    }
} 
```

然后我向以下 url 发起了两个并行 HTTP 请求：

*   `/home/index`
*   `/home/indexsync`

大约 5 秒后，2 个请求按预期完成，日志文件看起来非常正常：

```
url: http://localhost:14953/home/index, time: 5047ms
url: http://localhost:14953/home/indexsync, time: 5005ms 
```

如您所见，HTTP 模块正确测量了异步和同步操作的执行时间。

那么给了什么？

顺便说一句，您可以检查[MiniProfiler](http://miniprofiler.com/)并确保您的场景没有轮子重新发明。

# kinect - 使用 Kinect 进行图像处理

> ID：11140345
> 
> 赞同：3
> 
> 时间：2012-06-21T14:24:40.550
> 
> 标签：kinect, zooming, rotatetransform

我正在尝试创建一个放大和缩小图像并通过 Kinect 旋转它的应用程序。到目前为止，它适用于任何一种情况。我想要的是，如果我旋转了图像，那么在我缩放时会保存该新值，因此我会放大已旋转 X 度的图像。我现在的方式，如果我先旋转然后尝试缩放，图像会回到初始阶段。

```
 private void TrackDistances(Skeleton skeleton)
        {
        if (skeleton.TrackingState == SkeletonTrackingState.Tracked)
        {
            ...
            if (wristLeft.Y > shoulderLeft.Y && wristRight.Y > shoulderRight.Y)
            {
                float distance = Math.Abs(wristLeft.X - wristRight.X);
                image_Zoom(distance);
             }

            if (wristLeft.Y < shoulderLeft.Y && wristRight.Y < shoulderRight.Y)
            {
                angleDeg = GetJointAngle(zeroPoint, anglePoint);
                image_Rotate(angleDeg);
            }
        }
    }
    private void image_Zoom(float distance)
    {
        //TransformGroup transformGroup = (TransformGroup)image.RenderTransform;
        //ScaleTransform scale = (ScaleTransform)transformGroup.Children[0];
        //double zoom = distance * 1.5;
        //scale.ScaleX = zoom;
        //scale.ScaleY = zoom;

        double zoom = distance * 1.5;
        double ScaleX = zoom;
        double ScaleY = zoom;
        ScaleTransform scale = new ScaleTransform(ScaleX, ScaleY);
        image.RenderTransform = scale;
    }

    private void image_Rotate(double angleDeg)
    {
        var angle = angleDeg - 180;
        RotateTransform rotate = new RotateTransform(angle);
        image.RenderTransform = rotate;
    } 
```

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-12T12:56:10.940

我认为这是因为您将 RenderTransform 更改为 ScaleTranform 或 RotateTransform。您可以在 XAML 中设置图像的 ScaleTransform 和 RotateTransform，只需在后面的代码中更改角度或缩放参数。

另请参见此处： [如何在 inkcanvas 上同时进行缩放和旋转？](https://stackoverflow.com/questions/5745438/how-can-i-do-both-zoom-and-rotate-on-an-inkcanvas)

# c# - lambda 作为默认参数

> ID：11140348
> 
> 赞同：6
> 
> 时间：2012-06-21T14:24:55.053
> 
> 标签：c#

我正在寻找一个答案来质疑[Get next N 个元素 from enumerable](https://stackoverflow.com/questions/3524415/get-next-n-elements-from-enumerable/11140231#11140231)没有找到任何令人满意的东西并自己酿造。我想出的是

```
IEnumerable<T> Chunk<T, R>(IEnumerable<R> src, int n, Func<IEnumerable<R>, T> action){
  IEnumerable<R> head;
  IEnumerable<R> tail = src;
  while (tail.Any())
  {
    head = tail.Take(n);
    tail = tail.Skip(n);
    yield return action(head);
  }
} 
```

不过，我真正想要的是让 action 具有默认值`t=>t`，但我不知道如何将其设为默认参数。签名`IEnumerable<T> Chunk<T, R>(IEnumerable<R> src, int n, Func<IEnumerable<R>, T> action = t=>t)`给出了语法错误。

我的问题是，我该怎么做？

我想这与将[lambda 函数指定为默认参数](https://stackoverflow.com/questions/6025118/specifying-a-lambda-function-as-default-argument)但用于 C# 而不是 C++相同

作为旁注，我知道它在语法上没有任何区别，但是如果我切换`T`and会更容易阅读`R`吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T14:28:24.887

默认值必须是常量，并且委托的唯一常量值是`null`引用。

我建议你改用重载。请注意，`t => t`这无论如何都是无效的，除非您知道存在从`IEnumerable<R>`to的转换`T`，而我在任何地方都看不到。

除了 lambda 表达式有效性问题之外，您还*可以*使用 null 合并运算符：

```
IEnumerable<T> Chunk<T, R>(IEnumerable<R> src, int n,
                           Func<IEnumerable<R>, T> action = null)
{
    action = action ?? (t => t);
    ...
} 
```

`null`...但这*有点*滥用它，您将无法判断`ArgumentNullException`.

编辑：另外，请注意，您的方法从根本上是有问题的 - 迭代块将多次评估原始序列（每个块一次）以跳过正确的数量。编写一个在返回之前*急切*读取每个块的方法可能会更好。我们在[MoreLINQ](http://morelinq.googlecode.com)中有一个类似的方法，称为[`Batch`](http://code.google.com/p/morelinq/source/browse/MoreLinq/Batch.cs). 请注意，这`Batch`正是这里提到的重载 - 在这种情况下，`t => t`工作正常，因为重载的类型参数较少，所以我们知道身份转换是可以的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:29:10.283

C# 也是如此：创建重载。

```
IEnumerable<T> Chunk<T, R>(IEnumerable<R> src, int n){
    return Chunk<T, R>(src, n, t => t);
} 
```

# android - 对齐选项菜单项（在ActionBar中）

> ID：11140353
> 
> 赞同：3
> 
> 时间：2012-06-21T14:25:14.210
> 
> 标签：android, android-widget

我想从左侧的选项菜单中对齐一个菜单项，正如您在联系人应用程序中看到的那样（在编辑联系人时）。我必须做什么？我是否必须更改您的 xml 属性或在 Java 代码中进行更改？

最好的问候，rnng

![联系人（编辑）活动截图](../Images/364572283f77ef34c8a9b07a96100818.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T19:08:34.700

[我从这里](https://android.googlesource.com/platform/packages/apps/Contacts/+/ics-mr1-release)查找了联系人应用程序的源代码。

代码说我必须使用这个 XML 代码为 ActionBar 创建一个自定义布局：

```
<FrameLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <LinearLayout
        android:id="@+id/save_menu_item"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:divider="?android:attr/dividerVertical"
        android:showDividers="end"
        android:dividerPadding="12dip"
        android:orientation="horizontal">

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="horizontal"
            android:duplicateParentState="true"
            style="?android:attr/actionButtonStyle">

            <ImageView
                android:id="@+id/icon"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:layout_marginRight="8dip"
                android:src="@drawable/ic_menu_done_holo_dark"
                android:description="@string/menu_done" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical"
                android:layout_marginRight="20dip"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="@color/action_bar_button_text_color"
                android:text="@string/menu_done"
                style="@android:style/Widget.Holo.ActionBar.TabText" />

        </LinearLayout>

    </LinearLayout>

</FrameLayout> 
```

这个Java代码在这里：

```
 // Inflate a custom action bar that contains the "done" button for saving changes
    // to the contact
    LayoutInflater inflater = (LayoutInflater) getSystemService
                    (Context.LAYOUT_INFLATER_SERVICE);
    View customActionBarView = inflater.inflate(R.layout.editor_custom_action_bar, null);
    View saveMenuItem = customActionBarView.findViewById(R.id.save_menu_item);
    saveMenuItem.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        mFragment.doSaveAction();
    }
    // Show the custom action bar but hide the home icon and title
    actionBar.setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM,
                    ActionBar.DISPLAY_SHOW_CUSTOM | ActionBar.DISPLAY_SHOW_HOME |
                    ActionBar.DISPLAY_SHOW_TITLE);
    actionBar.setCustomView(customActionBarView); 
```

使用了以下文件：

*   [安卓/平台/包/应用程序/联系人/ics-mr1-release/。/src/com/android/contacts/activity/ContactEditorActivity.java](https://android.googlesource.com/platform/packages/apps/Contacts/+/ics-mr1-release/src/com/android/contacts/activities/ContactEditorActivity.java)
*   [安卓/平台/包/应用程序/联系人/ics-mr1-release/。/res/layout/editor_custom_action_bar.xml](https://android.googlesource.com/platform/packages/apps/Contacts/+/ics-mr1-release/res/layout/editor_custom_action_bar.xml)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:35:18.033

这可能正在使用`ActionMode`具有这种外观的 ，包括左侧的复选标记按钮。

或者，这可能正在使用`setDisplayUseLogoEnabled()`和`android:logo`属性 on `<application>`。

或者，这可能是使用自定义 UI 而不是使用普通操作栏。

# google-tv - 在 Google TV 的示例 Flash 模板中使用 OSMF

> ID：11140354
> 
> 赞同：0
> 
> 时间：2012-06-21T14:25:14.910
> 
> 标签：google-tv

我一直在查看基于 Flash 的 Google TV 示例模板的源代码，可在此处获得：

[https://developers.google.com/tv/web/docs/gtv-templates](https://developers.google.com/tv/web/docs/gtv-templates)

我注意到[OSMF](http://www.osmf.org)似乎没有用于视频播放器部件。这有什么原因吗，这是一个有意识的设计决定（或不是）？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:46:45.680

在设计和开发这些模板时，我们必须同时支持 HTML5 和 Flash。我们的合作伙伴 Adob​​e 在其针对 Google TV 的 Flash 优化指南中推荐了 OSMF：http: [//www.adobe.com/devnet/devices/articles/video_content_tv.html](http://www.adobe.com/devnet/devices/articles/video_content_tv.html)。

但不幸的是，由于资源限制，我们没有包括 OSMF 之类的东西。如果您有包含 OSMF 的工作示例代码，请考虑将它们添加到模板中。

谢谢！

# php - 文件上传不适用于较大的文件

> ID：11140356
> 
> 赞同：5
> 
> 时间：2012-06-21T14:25:22.587
> 
> 标签：php, file-upload

我正在尝试上传 .zip 文件。它适用于小文件。但我可以上传 >2MB 的文件。当我尝试上传大于 2 MB 的文件时，谷歌浏览器在左下角显示为 (uploadin : --%) 其中 -- 不是 10。但它在 14% 后卡住了。一段时间后，它显示类似“错误 101 (net::ERR_CONNECTION_RESET)：连接已重置。”此网页不可用。

请帮我

这是表格代码

```
<form name="addnewitem" id="addnewitem" method="post" enctype="multipart/form-data">
                <?php if (($succ==0) && ($message!="")) { echo "<div class='error'>".$message."</div>"; } ?>
                <?php if ($msg!="") { echo "<div class='success'>".$msg."</div>"; } ?>
                <?php if ($msg1!="") { echo "<div class='error'>".$msg1."</div>"; } ?>
                <div class="list-item">

                        <div class="form">
                            <h2>Name & Description</h2>
                            <div class="row">
                                <div class="left">
                                    <label>Item Title:</label>
                                </div>
                                <div class="right">
                                    <input name="listitemname" id="listitemname" type="text" class="input" maxlength="50" value="<?php echo $_POST['listitemname']; ?>" />
                                    <em>Maximum 50 characters</em>
                                </div>
                            </div>
                            <div class="row">
                                <div class="left">
                                    <label>
                                        Item Description:
                                    </label></div>
                                <div class="right">
                                    <textarea name="itemdescription" id="itemdescription" cols="10" rows="5"><?php echo $_POST['itemdescription'];?></textarea>
                                    <em>Maximum 600 characters</em>
                                </div>
                            </div>
                        </div>

                    <div class="form">
                        <h2>
                            Item Files & Preview
                        </h2>
                        <div class="row">
                            <div class="left">
                                <label>
                                    Item Thumbnail:
                                </label>
                            </div>
                <div class="right"><input type="file" name="thumbnailimage" id="thumbnailimage" class="input" />
                                <em>JPG or PNG, 80 x 80 Thumbail</em>
                            </div>
                        </div>
                        <div class="row">
                            <div class="left">
                                <label>
                                    Item Rollover Preview:
                                </label></div>
                            <div class="right"><input type="file" name="rolloverimage" id="rolloverimage" class="input" />
                                <em>JPG or PNG, 190 x 190 Preview Image</em>
                            </div>
                        </div>
                                                    <div class="row">
                            <div class="left">
                                <label>
                                    Screenshot image 1:
                                </label></div>
                            <div class="right"><input type="file" name="themepreview1" id="themepreview1" class="input" />
                                <em>JPG or PNG, 420 x 420 Image Screenshot ( Required )</em>
                            </div>
                        </div>
                                                                    <div class="row">
                            <div class="left">
                                <label>
                                    Screenshot image 2:
                                </label></div>
                            <div class="right"><input type="file" name="themepreview2" id="themepreview2" class="input" />
                                <em>JPG or PNG, 420 x 420 Image Screenshot ( Optional )</em>
                            </div>
                        </div>
                                                                    <div class="row">
                            <div class="left">
                                <label>
                                    Screenshot image 3:
                                </label></div>
                            <div class="right"><input type="file" name="themepreview3" id="themepreview3" class="input" />
                                <em>JPG or PNG, 420 x 420 Image Screenshot ( Optional )</em>
                            </div>
                        </div>
                                                                    <div class="row">
                            <div class="left">
                                <label>
                                    Screenshot image 4:
                                </label></div>
                            <div class="right"><input type="file" name="themepreview4" id="themepreview4" class="input" />
                                <em>JPG or PNG, 420 x 420 Image Screenshot ( Optional )</em>
                            </div>
                        </div>
                                                                                <div class="row">
                            <div class="left">
                                <label>
                                    Item Zip File:
                                </label></div>
                            <div class="right"><input type="file" name="itemfile" id="itemfile" class="input" />
                                <em>.ZIP File Only </em>
                            </div>
                        </div>

                                            <div class="row">
                            <div class="left">
                                <label>Demo URL:</label>
                            </div>
                            <div class="right">
                                <input name="demourl" id="demourl" type="text" class="input" value="<?php echo $_POST['demourl']; ?>" />
                                <em>Enter the www.themepreviewurl.com here for the item Live Preview</em>
                            </div>
                        </div>
                        </div>
                    <div class="form">
                        <h2>
                            Category & Attributes
                        </h2>
                        <div class="row">
                            <div class="left">
                                <label>
                                    Category:
                                </label></div>
                            <div class="right">
                                <?php
                                    $getmaincategories = "SELECT category_name,category_id FROM ".$tbl_main_categories." WHERE category_status = 1";
                                    $exec_getmaincategories = mysql_query($getmaincategories);
                                    echo "<select name='categoryname' id='categoryname'>";
                                    echo "<option value='' >Select a Category Now</option>";
                                    while($rows_getmaincategories = mysql_fetch_array($exec_getmaincategories)) {
                                        $getsubcategories = "SELECT sub_category_name,sub_category_hash FROM ".$tbl_sub_categories." WHERE sub_category_status=1 AND     category_id=".$rows_getmaincategories['category_id'];
                                        $exec_getsubcategories = mysql_query($getsubcategories);
                                        echo "<option disabled='disabled' value='".$rows_getmaincategories['category_id']."'>".$rows_getmaincategories['category_name']."</option>";
                                        while($rows_getsubcategories = mysql_fetch_array($exec_getsubcategories)) {
                                        if ($_REQUEST['categoryname'] == $rows_getsubcategories['sub_category_hash']) { echo $selectedvalue = "selected='selected'"; } 
                                            echo "<option value='".$rows_getsubcategories['sub_category_hash']."' style='padding-right:inherit' $selectedvalue>&nbsp;&nbsp;&nbsp;&nbsp;-".$rows_getsubcategories['sub_category_name']."</option>";
                                        }
                                    }
                                    echo "</select>";
                                ?>
                            </div>
                        </div>
                        <div class="row">
                            <div class="left">
                                <label>
                                    Compatible Browsers:<br />
                                    use 'ctrl' to select multiples
                                </label></div>
                            <div class="right">
                                <select multiple="multiple" class="select" name="browsercompatiable[]" id="browsercompatiable[]">
                                    <option value="">Select</option>
                                    <option value="ie7" <?php if ($_REQUEST['browsercompatiable'] == "ie7") echo "selected='selected'"; ?>>IE7</option>
                                    <option value="ie8" <?php if ($_REQUEST['browsercompatiable'] == "ie8") echo "selected='selected'"; ?>>IE8</option>
                                    <option value="ie9" <?php if ($_REQUEST['browsercompatiable'] == "ie9") echo "selected='selected'"; ?>>IE9</option>
                                    <option value="firefox" <?php if ($_REQUEST['browsercompatiable'] == "firefox") echo "selected='selected'"; ?>>Firefox</option>
                                    <option value="safari" <?php if ($_REQUEST['browsercompatiable'] == "safari") echo "selected='selected'"; ?>>Safari</option>
                                    <option value="chrome" <?php if ($_REQUEST['browsercompatiable'] == "chrome") echo "selected='selected'"; ?>>Chrome</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="left">
                                <label>
                                    Files Includes:<br />
                                    Use 'ctrl' to select multiples
                                </label></div>
                            <div class="right">
                                <select multiple="multiple" size="5" class="select" name="filesinclude[]" id="filesinclude[]">
                                    <option value="">Select</option>
                                    <option value="ie7" <?php if ($_REQUEST['filesinclude'] == "ie7") echo "selected='selected'"; ?>>PSD Files</option>
                                    <option value="ie8" <?php if ($_REQUEST['filesinclude'] == "ie8") echo "selected='selected'"; ?>>Documentation</option>
                                    <option value="ie9" <?php if ($_REQUEST['filesinclude'] == "ie9") echo "selected='selected'"; ?>>Multiple Layouts</option>
                                    <option value="firefox" <?php if ($_REQUEST['filesinclude'] == "firefox") echo "selected='selected'"; ?>>Multiple Colour Options</option>
                                    <option value="safari" <?php if ($_REQUEST['filesinclude'] == "safari") echo "selected='selected'"; ?>>Video Help Files</option>
                                    <option value="chrome" <?php if ($_REQUEST['filesinclude'] == "chrome") echo "selected='selected'"; ?>>Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="left">
                                <label>
                                    Columns:
                                </label></div>
                            <div class="right">
                                <select name="noofcolumns" id="noofcolumns">
                                <option value="">Select</option>
                                <option value="1" <?php if ($_REQUEST['noofcolumns'] == "1") echo "selected='selected'"; ?>>1</option>
                                <option value="2" <?php if ($_REQUEST['noofcolumns'] == "2") echo "selected='selected'"; ?>>2</option>
                                <option value="3" <?php if ($_REQUEST['noofcolumns'] == "3") echo "selected='selected'"; ?>>3</option>
                                <option value="4" <?php if ($_REQUEST['noofcolumns'] == "4") echo "selected='selected'"; ?>>4</option>
                                <option value="5" <?php if ($_REQUEST['noofcolumns'] == "5") echo "selected='selected'"; ?>>5</option>                      
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="left">
                                <label>
                                    Layout:
                                </label></div>
                            <div class="right">
                                <select name="layout" id="layout">
                                <option value="">Select</option>
                                <option value="1" <?php if ($_REQUEST['layout'] == "1") echo "selected='selected'"; ?>>1</option>
                                <option value="2" <?php if ($_REQUEST['layout'] == "2") echo "selected='selected'"; ?>>2</option>
                                <option value="3" <?php if ($_REQUEST['layout'] == "3") echo "selected='selected'"; ?>>3</option>
                                <option value="4" <?php if ($_REQUEST['layout'] == "4") echo "selected='selected'"; ?>>4</option>
                                <option value="5" <?php if ($_REQUEST['layout'] == "5") echo "selected='selected'"; ?>>5</option>                       
                                </select>
                                <em>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus id arcu vitae eros molestie ultricies ut sit amet nisi. Nulla facilisi.</em>
                            </div>
                        </div>

                    </div>
                    <div class="form">
                        <h2>Tags</h2>
                        <div class="row">
                            <div class="left">
                                <label>Tags:</label>
                            </div>
                            <div class="right">
                                <textarea name="itemtags" id="itemtags" cols="10" rows="5"><?php echo $_POST['itemtags']; ?></textarea>
                                <em>Maximum 50 characteres</em>
                            </div>
                        </div>
                    </div>
                    <div class="botton">
                        <input name="additem" id="additem" type="submit" value="Upload Now" class="btn" />
                    </div>              
                </div>
                </form> 
```

我想在下面显示的 .zip 字段中上传 >3MB 的文件

```
<div class="right"><input type="file" name="itemfile" id="itemfile" class="input" />
                                <em>.ZIP File Only </em>
                            </div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:32:52.427

检查php.ini 中的upload_max_filesize、max_input_time **和post_max_size**

如果文件非常大，您可能还需要增加 memory_limit。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:31:02.560

更改 php.ini 更改大小并测试您的脚本。（php.ini 位于 php 安装目录中）

```
; Maximum allowed size for uploaded files.
upload_max_filesize = 2M 
```

至

```
upload_max_filesize = Required_size M 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T14:31:17.350

请检查您服务器中的“max_input_time”选项是否太低，这可能是 PHP 阻止您的原因。否则，它可能是与服务器/网络基础设施相关的问题：

```
echo ini_get('max_input_time'); 
```

如果你从中得到 -1，很可能不是 PHP 切断了你，而是循环中的其他东西。它可以是通往服务器的任何硬件，但很可能是服务器本身或服务器位置的东西......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T22:58:35.977

对于大文件，如果您不想处理配置服务器设置（特别是如果您在共享主机或其他无法让您完全控制服务器的主机上），一种可能的解决方案是将上传到第三方服务。

例如，您可以让表单直接发布到 Amazon S3 ( [http://s3.amazonaws.com/doc/s3-example-code/post/post_sample.html](http://s3.amazonaws.com/doc/s3-example-code/post/post_sample.html) ) 或使用[Filepicker.io 之类的服务](https://filepicker.io)

全面披露：我在 Filepicker.io 工作，但想帮助那些处理大文件上传问题的人

# database - 如何检查现有文件的条目，以免重写数据

> ID：11140371
> 
> 赞同：0
> 
> 时间：2012-06-21T14:25:56.697
> 
> 标签：database, vbscript

我创建的是一个脚本，它从计算机中提取戴尔服务代码、用户名和计算机名，并将该信息编译成 .csv 文件。该脚本将通过 Active Directory 登录脚本实现，因此最终用户无需执行任何操作。

我遇到的问题是，每次有人登录时，它都会收集他们的信息，并将其添加到列表中。这意味着我的列表可能只有两个反复登录计算机的人。

我希望脚本在 .csv 文件中搜索收集的特定数据，如果该数据存在，则不输入。

我到目前为止的代码是这样的：

```
'Get Dell Service Tag Info
set ProSet = GetObject("winmgmts:").InstancesOf("Win32_BIOS")
Set ProSet1 = GetObject("winmgmts:").InstancesOf("Win32_SystemEnclosure")
For each Pro in ProSet
  For each Pro1 in ProSet1
    ServiceTag=Pro.SerialNumber
    exit for
  Next
  exit for
Next

'get username and computername, could also be asked in a batch
Set oShell     = WScript.CreateObject("WScript.Shell")
Set oShellEnv  = oShell.Environment("Process")
sComputerName  = oShellEnv("ComputerName")
sUsername      = oShellEnv("username")

dim filesys, filetxt, getname, path
Set filesys = CreateObject("Scripting.FileSystemObject")
Set filetxt = filesys.OpenTextFile("\\xx.xx.xx.xx\Gathering\DataLog.csv", 8, True, -2)
path = filesys.GetAbsolutePathName("\\xx.xx.xx.xx\Gathering\DataLog.csv")
getname = filesys.GetFileName(path)
filetxt.WriteLine sUsername & ", " & sComputerName & ", " & ServiceTag
filetxt.Close 
```

这是基本脚本，没有条目检查器。

至于条目检查器，这是我尝试过的，但似乎不起作用：

```
Set objFSO = CreateObject("Scripting.Dictionary")
Set objFile = objFSO.OpenTextFile ("\\xx.xx.xx.xx\Gathering\Dictionary.txt", 8, True)
' Make comparisons case insensitive.
objList.CompareMode = vbTextCompare

' ... code to read user name and assign to variable strNameOfUser.

If (objList.Exists(strNameOfUser) = False) Then
    ' Add this user to the dictionary object.
    objList(strNameOfUser) = True
    ' Log this unique user name.
    objFile.WriteLine strNameOfuser
End If 
```

任何帮助表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:01:36.353

（1）您的代码搞砸了：您将字典存储在 objFSO 中，然后尝试调用 objFSO.OpentextFile()

(2) VBScript 不能读取**和**附加到文件；所以 ForAppending (8) 不起作用；您必须先读取打开文件，收集信息，关闭它，追加打开并追加新的用户信息（如有必要）

(3) 使用字典不必要地复杂：要填充字典，您必须从头到尾读取文件，然后才能询问字典是否存在特定用户。虽然只是逐行读取文件，但您可以在找到用户后立即中断读取 - 然后关闭 - 打开 & 附加 - 关闭 - 完成。

**更新**

代码中的第（3）项：

```
 Dim goFS    : Set goFS    = CreateObject( "Scripting.FileSystemObject" )
  Dim tsUsers : Set tsUsers = goFS.OpenTextFile(sFSpec, ForReading, True)
  Dim bFound  : bFound      = False
  Do Until tsUsers.AtEndOfStream
     If 1 = Instr(tsUsers.ReadLine(), sUser) Then
        bFound = True
        Exit Do
     End If
  Loop
  tsUsers.Close
  If Not bFound Then
     Set tsUsers = goFS.OpenTextFile(sFSpec, ForAppending, False)
     tsUsers.WriteLine sUser
     tsUsers.Close
  End If 
```

Because I'm a pessimistic worrier: How do you plan to cope with more than one user logging in and write-access the file at the same time?

# gwt - GWT RPC 如何加载序列化策略文件？

> ID：11140372
> 
> 赞同：9
> 
> 时间：2012-06-21T14:25:59.007
> 
> 标签：gwt, gwt-rpc

我正在研究[GWT 和 OSGi+PAX-Web](https://stackoverflow.com/questions/11136105/issues-with-gwt-in-osgipax-web-using-declarative-services)问题的解决方案。特定的问题是 GWT 无法加载序列化策略文件，并给出以下错误：

`ERROR: The serialization policy file '/ctx/ctx/6ExxxxxxxxxxxxxxxxF.gwt.rpc' was not found; did you forget to include it in this deployment?`

问题出在 Equinox OSGi 和 PAX-WEB 之间。

为了找到解决方案，我想更好地了解 GWT-RPC 是如何加载序列化策略文件的。

*   它们的生命周期是什么？他们什么时候加载？（我看到它在服务器启动时。生命周期中的任何特殊性？重新加载？）
*   GWT 如何将这个文件加载到它的堆栈中？在请求的调用堆栈中的哪一点？GWT 如何知道从哪里加载它们？我可以告诉 GWT 它应该在哪里寻找这个文件吗？

（免责声明：我已阅读生成文件[[2]](http://code.google.com/p/google-web-toolkit-doc-1-6/wiki/FAQ_GWTApplicationFiles)上的 gwt 文档。我正在寻找更多低级细节：我的印象是我们必须处理 HttpContext.getResource() 的错误）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-21T14:37:16.240

都在`RemoteServiceServlet`。

> 它们的生命周期是什么？他们什么时候加载？（我看到它在服务器启动时。生命周期中的任何特殊性？重新加载？）

它们在第一次使用时加载（收到第一个请求）并缓存在 servlet 的一个字段中，因此它们的生命周期与 servlet 本身相关联。

> GWT 如何将这个文件加载到它的堆栈中？在请求的调用堆栈中的哪一点？GWT 如何知道从哪里加载它们？我可以告诉 GWT 它应该在哪里寻找这个文件吗？

`servlet.getServletContext().getResourceAsStream`. 您可以通过覆盖来自定义它`doGetSerializationPolicy`（如 JavaDoc 中所述）。
文件名（资源 URL）是根据请求的路径和`X-GWT-Permutation`请求标头构建的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-08T01:20:50.543

我在我的 EAR 文件中查找 .rpc 文件，发现文件名与错误不同。

解决方法：清除浏览器缓存并刷新。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-10T18:40:51.880

答案是我的尼克为我工作。

我的网络应用程序在某些类中运行了很长时间。

后来我在服务器上添加了新类，当我尝试启动网络应用程序时，它给了我以下错误：

错误：未找到序列化策略文件'/newapp/C3055CD048198D732D03CA6901E503 86.gwt.rpc'；您是否忘记将其包含在此部署中？

警告：无法获取模块“http://10.10.1.23:9200/newapp/”的序列化策略“C3055CD048198D732D03CA6901E5038 6”；将使用与 1.3.3 兼容的旧版序列化策略。因此，您可能会遇到 SerializationExceptions。

然后我在隐身窗口中启动了应用程序，它清除了缓存，它对我有用。

# c# - 如何将结构从 C++ 迁移到 C#

> ID：11140373
> 
> 赞同：3
> 
> 时间：2012-06-21T14:26:12.237
> 
> 标签：c#, c++, struct, migration

我正在编写一个接收复杂数据结构的 UDP 客户端。我确实有 C++ 中的结构，但我的程序是 C#

Bitfiels 和联合有很多不同的结构。

有什么方法可以让我不必手动转换结构？

还有一种简单的方法可以在 C# 中实现位域和联合吗？

现在我正在为 Bitfields 使用属性，但这是一项艰巨的工作，极有可能出错。

我提供了一个我现在正在做的简化示例，大约有 50 个结构，每个结构有 100 行代码。

示例 C++：

```
typedef struct Message_s
{
    unsigned char var : 2;
    unsigned char var2 : 6;

    union
    {
         struct
         {
            unsigned char sVar;
            unsigned char sVar2;
         }
         char arr[32];
     }    
}Message_t; 
```

示例 C#：

```
 [System.Runtime.InteropServices.StructLayout(System.Runtime.InteropServices.LayoutKind.Sequential)]
struct Message_s
{
    private byte Field1
    public byte var
    {
       get
       {
           return (byte)(Field1 & 0x03);
       }
       set
       {
           Field1 = (byte)((Field1 & ~0x03) | value);
       }
    public byte var2
    {
       get
       {
           return (byte)(Field1 & 0xFC);
       }
       set
       {
           Field1 = (byte)((Field1 & 0x03) | value<<2);
       }
     }
//unions may be possible with properties...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:24:36.773

简短的回答是否定的，似乎没有一种简单的方法可以将 C++ 结构转换为 C# 格式。但是，有一种方法可以在 C# 结构中进行联合；这是否是一个好主意，或者是否最好从头开始上课，将取决于您。

要在 C# 结构中获取联合，请使用`LayoutKind.Explicit`以下`FieldOffset`属性：

```
[StructLayout(LayoutKind.Explicit)]
struct StructTest
{
    // A byte at the beginning of the struct.
    [FieldOffset(0)]
    public byte byte1;

    // Another byte immediately after it.
    [FieldOffset(1)]
    public byte byte2;

    // Now an integer which covers both.
    [FieldOffset(0)]
    public Int16 int1;
} 
```

您可以按照您的期望使用它：

```
 var foo = new StructTest();
        foo.byte1 = 3;
        foo.byte2 = 6;
        Console.WriteLine("{0}", foo.int1);

        var bar = new StructTest();
        bar.int1 = 5050;
        Console.WriteLine("{0}, {1}", bar.byte1, bar.byte2); 
```

产生`1539`和`186, 19`。

这为您提供了联合结构，但它仍然不能解决 BitFields 的主要问题。对此似乎没有达成共识（当然，除了您已经完成的工作；例如，参见 [ [1](https://stackoverflow.com/a/9311624/920242) ]）。可以通过`MarshalAs`属性做一些巧妙的事情来将自定义 BitField 类映射到底层结构，但是在那个级别的努力下，像以前一样继续编写自定义类可能会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T10:51:21.320

作为替代方案，有*一种*方法可以在代码中使用非托管 C++ 类型，但它仍然涉及一些类型。在 VS C++ 项目中，创建非托管结构：

```
struct Date_s
{
    union
    {
        struct
        {
            unsigned nWeekDay  : 3;    // 0..7   (3 bits)
            unsigned nMonthDay : 6;    // 0..31  (6 bits)
            unsigned           : 0;    // Force alignment to next boundary.
            unsigned nMonth    : 5;    // 0..12  (5 bits)
            unsigned nYear     : 8;    // 0..100 (8 bits)
        };
        unsigned bob;
    };
}; 
```

现在我们创建一个包含此结构的托管类型：

```
public ref struct Date_ms
{
    AutoPtr<Date_s> data;
    Date_ms()
    {
        data = new Date_s();
    }

    property unsigned nWeekDay
    {
        unsigned get() { return data->nWeekDay; }
        void set(unsigned value) { data->nWeekDay = value; }
    }
    property unsigned nMonthDay
    {
        unsigned get() { return data->nMonthDay; }
        void set(unsigned value) { data->nMonthDay = value; }
    }
    property unsigned nMonth
    {
        unsigned get() { return data->nMonth; }
        void set(unsigned value) { data->nMonth = value; }
    }
    property unsigned nYear
    {
        unsigned get() { return data->nYear; }
        void set(unsigned value) { data->nYear = value; }
    }
    property unsigned bob
    {
        unsigned get() { return data->bob; }
        void set(unsigned value) { data->bob = value; }
    }
}; 
```

那里有一些复制和粘贴要做。我在这里还使用了一个外部项目：它是来自 Kerr的[AutoPtr 。](http://weblogs.asp.net/kennykerr/archive/2007/03/26/AutoPtr.aspx)我还在`T* operator=(T* rhs) { return (m_ptr = rhs); }`AutoPtr 代码中添加了这一行（正如 Kerr 帖子的评论中所建议的那样），以使初始化程序工作。

您现在可以在 C# 代码中使用这个新结构，并且一切都应该按预期工作：

```
var test = new Date_ms();
test.nMonth = 3;
test.nMonthDay = 28;
test.nYear = 98;
Console.WriteLine("{0}, {1}, {2}", test.nMonth, test.nMonthDay, test.nYear);
Console.WriteLine("{0}", test.bob); 
```

结果`3, 28, 98`和`224`。

# 巨大的警告

像这样混合托管和非托管代码是危险的，这就是 Kerr 首先编写 AutoPtr 的原因（顺便说一句，他关于该主题的[博客文章](http://weblogs.asp.net/kennykerr/archive/2005/07/12/Mixing-Native-and-Managed-Types-in-C_2B002B00_.aspx)非常值得一读）。这对我有用，但我不能保证它不会导致内存泄漏。在部署它之前，您应该*明确*检查它是否按预期工作。

# javascript - Sencha touch 2 中的音频和视频不一致

> ID：11140375
> 
> 赞同：0
> 
> 时间：2012-06-21T14:26:13.817
> 
> 标签：javascript, html, css, extjs

我对 Sencha touch 2 很陌生，但我正在使用它和 xcode 将图像上传到 ipad。我有在主屏幕上播放的音频，一旦选择了某个选项卡，视频应该会运行，音频应该会停止。但是，当音频在主屏幕上工作时，我无法播放视频，当视频工作时，没有音频。我不太确定该怎么做，因为无论我是否更改了代码，每次运行中哪个失败都会有所不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:52:48.760

Apple 有一个限制，无法一次播放多个音频源。这也可能是视频+音频的情况。

这是一个性能问题，因为硬件只能解码一个压缩文件，而用 cpu 解码它会使整个操作系统太慢。

[苹果 说](http://developer.apple.com/library/ios/#documentation/MusicAudio/Conceptual/CoreAudioOverview/CoreAudioEssentials/CoreAudioEssentials.html)：

> 当您在 iPhone 或 iPod touch 上同时播放声音时，音频格式至关重要。这是因为在 iOS 中播放某些压缩格式使用了高效的硬件编解码器。一次只能在设备上播放以下格式之一的单个实例：
> 
> *   AAC
> *   ALAC（苹果无损）
> *   MP3

# android - 所有供应商的 MNC 和 MCC

> ID：11140378
> 
> 赞同：3
> 
> 时间：2012-06-21T14:26:29.380
> 
> 标签：android, gsm, signal-strength, cellid

我想获得一个在安卓应用程序中手机范围内的所有提供商的列表。

我知道对于某些类，例如`CellNeigbouringInfo, GSMCellLocation, SignalStrength`and `PhoneStateListener`，

我只能获得`CellID, MNC and signal strengths`与我当前连接的*只有那些，但如果我想获得该地区所有提供商的详细信息，我将如何获得它？

# tmx - 将 hd TMX Tilemap 转换为 sd，我应该手动执行此操作吗？

> ID：11140379
> 
> 赞同：0
> 
> 时间：2012-06-21T14:26:29.687
> 
> 标签：tmx

我有一个 960*640 像素的瓷砖地图，使用 64*64 瓷砖进行高清视网膜显示。现在，我需要一个用于 sd 显示的 tilemap。（我猜它应该是 480*320 像素，使用 32*32 tile）

那么，有没有简单的方法呢？

在 Mac 应用商店中查找“Unretiner”等工具。

'hd img -> sd img' by Unretiner
'hd tmx -> sd tmx' by ??

感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-24T07:42:49.760

这是我用来从 hd .tmx 生成 sd .tmx 的 Python 脚本。您可以通过以下 shell 命令使用它。

```
>python change_tmx_numbers.py <directory_which_contains_hd_tmx_files> <output_directory> 
```

剧本：

```
#!/usr/bin/python
import os
import shutil
import sys
import xml.etree.cElementTree as ET
import re

def npath(path):
  if path[-1] == '/':
    return path[:-1]
  return path;

def subdir(*paths):
  return '/'.join(paths)

def changeText(text):
  print text
  pointm = '\{(?P<x>-?\d+), (?P<y>-?\d+)\}'
  framem = '\{\{(?P<x>-?\d+), (?P<y>-?\d+)\}, \{(?P<width>\d+), (?P<height>\d+)\}\}'
  m = re.match(pointm, text)
  if m != None:
    rt = '{%d, %d}' % tuple([int(f) / 2 for f in m.groups()])
    print 'change %s -> %s' % (text, rt)
    return rt
  else:
    m = re.match(framem, text)
    if m != None:
      rt = '{{%d, %d}, {%d, %d}}' % tuple([int(f) / 2 for f in m.groups()])
      print 'change %s -> %s' % (text, rt)
      return rt
    else:
      print 'text: \"' + text + '\" is not matched'
      return text

def resizeElement(element):
  elems = list(element)
  if(len(elems) == 0 and element.text != None):
    element.text = changeText(element.text)
  else:
    for el in elems:
      resizeElement(el)

def resizeAttToHalf(attrib, keys):
  for key in keys:
    if key in attrib:
      attrib[key] = str(int(attrib[key]) / 2)
  return attrib

def resizeMap(map):
  map.attrib = resizeAttToHalf(map.attrib, ['tilewidth', 'tileheight'])

def resizeImage(im):
  im.attrib = resizeAttToHalf(im.attrib, ['width', 'height'])
  im.attrib['source'] = im.attrib['source'].replace('-hd', '')

def resizeTileset(ts):
  ts.attrib = resizeAttToHalf(ts.attrib, ['tilewidth', 'tileheight'])
  for image in ts.findall('image'): 
    resizeImage(image)

def resizeProperty(prop):
  if 'name' in prop.attrib and prop.attrib['name'] == 'points':
    points = prop.attrib['value'].split(' ')
    nps = [','.join([str(int(p.split(',')[0])/2), str(int(p.split(',')[1])/2)]) for p in points]
    prop.attrib['value'] = ' '.join(nps)

def resizePolygon(prop):
  points = prop.attrib['points'].split(' ')
  nps = [','.join([str(int(p.split(',')[0])/2), str(int(p.split(',')[1])/2)]) for p in points]
  prop.attrib['points'] = ' '.join(nps)

def resizeObject(obj):
  obj.attrib = resizeAttToHalf(obj.attrib, ['x', 'y', 'width', 'height'])
  for props in obj.findall('properties'):
    for prop in props.findall('property'):
      resizeProperty(prop)
  for poly in obj.findall('polygon'):
    resizePolygon(poly)

def resizeplist(plist, dest):
  doc = ET.parse(plist)
  map = doc.getroot()
  resizeMap(map)
  for tileset in map.findall('tileset'):
    resizeTileset(tileset)

  for objectg in map.findall('objectgroup'):
    for obj in objectg.findall('object'):
      resizeObject(obj)

  destf = open(dest, 'w')
  prologue = '<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n'
  destf.write(prologue)
  doc.write(destf)
  destf.close()

def walkdir(path, dest):
  files =  [f for f in os.listdir(path) if not os.path.isdir(subdir(path, f))]
  dirs = [d for d in os.listdir(path) if  os.path.isdir(subdir(path, d))]
  for f in files:
    if (f.endswith('-hd.tmx')):
      resizeplist(subdir(path, f), subdir(path, f.replace('-hd', '')))
#  for d in dirs:
#    walkdir(subdir(path, d), subdir(dest, d))

if __name__ == "__main__":
  path = npath(sys.argv[1])
  dest = npath(sys.argv[2])
  walkdir(path, dest) 
```

# php - PHPmyAdmin 和排序数据库表

> ID：11140381
> 
> 赞同：0
> 
> 时间：2012-06-21T14:26:53.047
> 
> 标签：php, sql, sorting, search-engine, forum

[编辑]：对于我提出这个问题的时机，我感到非常抱歉。我刚刚发现您可以使用该命令

```
"ORDER BY `table`.`table_col` DESC" 
```

从 MySQL 表中订购您的结果。

我正在创建论坛，我正在使用 ajax 从数据库表中获取结果。我想在页面上显示它们之前订购这些结果，按当月当天的时间戳排序。

每个帖子的日期是我的 MySQL 表中的两位数，即`06`帖子一、`09`帖子二、`21`帖子 3

我知道如何编写脚本来对这些进行排序，但我想知道是否有更简单的方法。

我可以简单地在我的 phpMyAdmin 中设置表格，以使每个帖子按天列的值从小到大排序吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:30:56.857

索引和键有顺序，*通常*从表中选择会按照与查询相关的索引/键的顺序给出结果。

然而，情况并非总是如此。

在 SQL 中，无论您对表做什么，结果集*都*可能以完全不同的顺序出现。

因此，保证结果顺序的***唯一***方法是`ORDER BY`在查询中指定一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:33:48.047

您是否在选择语句中尝试了“order by”子句？

# php - 通过 POST 将数组从 Javascript 传递到 PHP

> ID：11140383
> 
> 赞同：1
> 
> 时间：2012-06-21T14:26:58.813
> 
> 标签：php, javascript, jquery, .post

我已经查看了有关此问题的其他几个建议，但由于某种原因，我的数据没有被发布。这是我的代码的相关部分：

```
<input type="button" id="map_submit" value="Map Selection" />
<?php var_dump($_POST); ?>  // display the posted variables 
```

和

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#map_submit').click(function(){

            /*  this part is from the slickgrid plugin, in which
             *  selectedData is an array that I want to post to the page
             *  and read via php
             */
            var selectedData = [], selectedIndexes;
            selectedIndexes = grid.getSelectedRows();
            jQuery.each(selectedIndexes, function (index, value) {
                 selectedData.push(grid.getData()[value]);
            });

            $.post("mapper.php", {dataArray: selectedData});
        });
    });
</script> 
```

从我从其他问题中看到的，`$.post`应该可以。但是，当我单击按钮时，var_dump 没有显示任何内容。作为健全性检查，如果我将其添加到 javascript：

```
for (var i = 0; i < selectedData.length; i++) {
     document.write(selectedData[i].questionID + "<br />");
} 
```

它将打印`questionID`我在网格中选择的值（当然是新的空白页）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:50:59.687

```
$.post("mapper.php", {dataArray: selectedData}); 
```

这条线很好。我不知道为什么每个人都建议使用 JSON，因为这里没有必要。您可以在不使用 JSON 的情况下正常发布对象/数组。

注意：这*不会*重新加载页面。它将`mapper.php`通过 AJAX 发布，因此不会在页面上的任何地方看到任何内容。您需要查看您的开发工具以查看 AJAX 调用返回的内容。

或者，您可以检查 POST 返回的数据。

```
$.post("mapper.php", {dataArray: selectedData}, function(data){
    console.log(data); // check your console, you should see some output
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:36:19.590

您必须先序列化对象，然后在服务器上反序列化（大概在 PHP 中），然后才能使用它。

下面的示例（需要 json2.js）：

```
<script type="text/javascript">
    $(document).ready(function(){
        $('#map_submit').click(function(){

            /*  this part is from the slickgrid plugin, in which
             *  selectedData is an array that I want to post to the page
             *  and read via php
             */
            var selectedData = [], selectedIndexes;
            selectedIndexes = grid.getSelectedRows();
            jQuery.each(selectedIndexes, function (index, value) {
                 selectedData.push(grid.getData()[value]);
            });

            $.post("mapper.php", JSON.stringify({dataArray: selectedData}));
        });
    });
</script>

<input type="button" id="map_submit" value="Map Selection" />
<?php var_dump(json_decode($_POST, true)); ?>  // display the posted variables 
```

# objective-c - 在 iOS 设备之间发送数据时委托响应选择器崩溃

> ID：11140386
> 
> 赞同：1
> 
> 时间：2012-06-21T14:27:11.720
> 
> 标签：objective-c, ios, ios5

从一台 iOS 设备向另一台设备发送数据时，我收到这些错误。

> > 2012-06-21 10:22:15.509 BulletTime[2324:707]-[DataHandler selectorToCall:]：无法识别的选择器发送到实例 0x19bfc0 2012-06-21 10:22:15.511 BulletTime[2324:707] *** 由于应用程序终止未捕获的异常'NSInvalidArgumentException'，原因是： ' - [DataHandler的selectorToCall：]：无法识别的选择发送到实例0x19bfc0' ***第一掷调用堆栈：（0x356c188f 0x37a68259 0x356c4a9b 0x356c3915 0x3561e650 0x356207d3 0xb6fd1 0xb7121 0x3322f61b 0x3561b3fd 0x33110e07 0x33110dc3 0x33110da1 0x33110b11 0x33111449 0x3310f92b 0x3310f319 0x330f5695 0x330f4f3b 0x372b422b 0x35695523 0x356954c5 0x35694313 0x356174a5 0x3561736d 0x372b3439 0x33123cd5 0xb231f 0xb22c4）终止调用抛出异常（lldb）

我肯定知道这段代码会导致崩溃，但我不知道如何修复它：

```
- (void)sendInfo {
    //Attempting to send info to the other device.
    //Returns to the Data Handler.
    info = (BOOL*)YES;

    //Sets the requestLabel and requestData of the CameraRequestDataProvider object.
    //These are then handled in the DataHandler...
    requestLabel = @"Cam";
    requestData = [@"Cam" dataUsingEncoding:NSUTF8StringEncoding];

    //Crash occurs here...

    if (delegateToCall && [delegateToCall respondsToSelector:selectorToCall])

        [delegateToCall performSelector:@selector(selectorToCall:)];
} 
```

在过去的几天里，我一直试图解决这个问题，但没有运气。有任何想法吗？我将不胜感激！

知道了！谢谢，我修正了这个错误。

但是，现在我收到此错误：

> > 2012-06-21 10:47:16.779 BulletTime[2416:707] ButtonIndex 0，信息应发送至此处。2012-06-21 10:47:19.913 BulletTime [2416:707] BTM：尝试连接到设备“Grace 的 iPad”A4:67:06:F3:EC:2A 2012-06-21 10:47 上的服务 0x00000800： 20.929 BulletTime[2416:707] BTM：连接到设备“Grace 的 iPad”A4:67:06:F3:EC:2A 上的服务 0x00000800 成功 2012-06-21 10:47:22.029 BulletTime[2416:707] -[DataHandler selectorToPerformWhenConnectionWasStablished:]：无法识别的选择器发送到实例 0x1303f0 2012-06-21 10:47:22.032 BulletTime[2416:707] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：'-[DataHandler selectorToPerformWhenConnectionWasStablished:]：发送了无法识别的选择器到实例 0x1303f0' ***第一掷调用堆栈：（0x356c188f 0x37a68259 0x356c4a9b 0x356c3915 0x3561e650 0x356207d3 0x6c693 0x351cf4ff 0x3568d547 0x35619097 0x351433eb 0x6ce1f 0x3069612f 0x356201fb 0x351e4747 0x35695ad3 0x3569529f 0x35694045 0x356174a5 0x3561736d 0x372b3439 0x33123cd5 0x6b2df 0x6b284）终止叫做抛出一个异常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:45:32.363

```
if (delegateToCall && [delegateToCall respondsToSelector:selectorToCall])

    [delegateToCall performSelector:selectorToCall]; 
```

和同样的方法错误

```
- (void)cancelInfo:(id)sender {
    [mainViewController dismissModalViewControllerAnimated:NO];
    [delegateToCall performSelector:@selector(selectorToCall:)];    
} 
```

需要更换为

```
- (void)cancelInfo:(id)sender {
    [mainViewController dismissModalViewControllerAnimated:NO];
    [delegateToCall performSelector:selectorToCall];    
} 
```

更新：

在文件 Device.m 中的方法相同的错误：

```
- (void)triggerConnectionSuccessfull:(NSNotification *)notification 
```

替换字符串

```
[delegateToCallAboutConnection performSelector:@selector(selectorToPerformWhenConnectionWasStablished:)]; 
```

串起来

```
[delegateToCallAboutConnection performSelector:selectorToPerformWhenConnectionWasStablished]; 
```

和方法

```
- (void)triggerConnectionFailed:(NSNotification *)notification 
```

也有同样的错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:49:01.097

`CameraDataProvider`您正在github 源代码的第 105 行或第 110 行设置成员变量 selectorToCall 。这意味着您在 performSelector 调用结束时不需要冒号。

而不是寻找在 selectorToCall 中设置的选择器，

```
 [delegateToCall performSelector:@selector(selectorToCall:)]; 
```

正在 DataHandler 上寻找一种方法，其名称`selectorToCall`采用一个参数（因为冒号）。

# hibernate - Hibernate：需要为日志记录设置一个属性

> ID：11140388
> 
> 赞同：0
> 
> 时间：2012-06-21T14:27:19.020
> 
> 标签：hibernate, hibernate-envers

我们正在使用 Hibernate Envers 进行日志记录，但是需要在我们正在跟踪历史记录的对象上设置事件类型。该属性是必需的，因此我们想到`null`每次`lastEvent`未设置时都将其放入。

所以我们尝试设置属性`@PrePersist`

```
@PrePersist
public void checkIfLastEventWasModified() {
    if (!lastEventModified) {
        lastEvent = null;
    }
} 
```

但是显然hibernate认为这些拦截器将对象标记为脏或不脏。因此，当此代码在脏检查上运行时，即使对象上没有任何更改，`lastEventModified`仍然会设置为每次。`false``lastEvent``null`

我们还使用 Hibernate 的 EventListener 进行了尝试，但它们在事务之外运行，我们可以设置属性，但它们没有保存到数据库中。

两种解决方案都感觉不对，但我不知道如何以最好的方式解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-27T12:31:20.090

如果您使用的是 3.6.8 以上的 Hibernate 版本，您可能需要创建自己的`EntityTrackingRevisionListener`( [javadoc](http://docs.jboss.org/hibernate/orm/3.6/javadocs/org/hibernate/envers/EntityTrackingRevisionListener.html) )。每次更改实体时都会调用它（即每次创建新修订版时），您可以在持久化之前更改由 Envers 审计的实体的属性。

# php - 无法显示关系表类别新闻

> ID：11140391
> 
> 赞同：0
> 
> 时间：2012-06-21T14:27:31.353
> 
> 标签：php, mysql

我正在尝试从与类别表相关的表中回显数据，但我没有得到它来显示数据，这是错误的。

这是一些代码：

tbl_category_news
- id_category_news
- 类别

tbl_news
- id_news
- id_category_news
-title
-description
-msg
-name_arquive
-legend

```
 <?php
     $categoryId = 1; 
      $sql_visualizar = mysql_query("SELECT * FROM tbl_news AS t1 JOIN tbl_category_news c
    ON c.id_category_news=t1.id_category_news WHERE id_category_news = {$categoryId}");
    while($linha = mysql_fetch_array($sql_visualizar)){
    $title = $linha ['title'];
    $description = $linha['description'];
    $msg = $linha['msg'];
    $legend = $linha['legend'];
    $nome_arquive = $linha['name_arquive'];
    $id_news = $linha['id_news'];

      ?>
<?php echo $msg?>
<?php
  }
  ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:30:37.317

换个试试`WHERE id_category_news = {$categoryId} with WHERE t1.id_category_news = $categoryId`

# c - 来自文件的输入永远持续

> ID：11140401
> 
> 赞同：0
> 
> 时间：2012-06-21T14:27:53.907
> 
> 标签：c, input

我有下一个 C 代码：

```
#include <stdio.h>
#include <stdlib.h>
#include "list.h"
#include "graph.h"

int main() {
    int action, src, dst;
    IntGraph g;

    g = newIntGraph();

    while (1) {
        printf("1 -> Add a nodes.\n");
        printf("2 -> Add an arc.\n");
        printf("3 -> Dump the graph.\n");
        printf("4 -> BFS.\n");
        printf("What do you want to do? [1, 2, 3, 4] ");
        scanf("%d", &action);

        switch (action) {
            case 1:
                addIntGraphNode(&g);
                break;

            case 2:
                printf("Insert source and destination: ");
                scanf("%d", &src);
                scanf("%d", &dst);
                addIntGraphArc(&g, src, dst);
                break;

            case 3:
                dumpIntGraph(g, "GRAPH\0");
                break;

            case 4:
                printf("Insert the node to start: ");
                scanf("%d", &src);
                BFSIntGraph(g, src);
                break;

            default:
                return 0;
        }
    }
} 
```

但我需要它来做一些测试，所以我想有一个现成的输入来生成基本图。

我将输入写在一个文件中（每行一个数字）。我有一个包含十行和十个 1 的文件，因为我希望程序生成一个包含十个节点的图形。

当我输入：

`./graph-test.run < input/graph-input.txt`

它开始并从文件中无休止地读取，添加数百个节点。我希望它在文件完成后停止，让我做一些其他操作。

我怎样才能做到这一点？如果我手动插入值，代码运行良好，所以这是一个与输入相关的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:35:32.040

问题是没有检查 for 的返回`scanf()`值`EOF`。如果`EOF`遇到`action`将不会被修改。建议：

```
if (1 != scanf("%d", &action)) /* scanf() returns number of assignments made,
                                  which should be 1 in this case. */
{
    break; /* exit while loop. */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:35:43.333

对于每次调用来`scanf`检查是否返回一个`EOF`. 在循环`EOF`中断的情况下。`while(1)`

```
if (EOF == scanf(....))
    break; //or exit(0); 
```

# javascript - 更新 带有复选框和按钮的 src

> ID：11140402
> 
> 赞同：1
> 
> 时间：2012-06-21T14:28:02.480
> 
> 标签：javascript, html, html5-video

我相信我在 javascript 中实现视频播放器时遇到了一个相对简单的问题。首先，我想将一个字符串添加到一个数组中，并将第一个字符串条目作为我的视频标签中源的 src 引用。然后，我希望在收到 src 后开始播放视频。

我还没有实现后者的代码，因为我还没有超越前者。我见过人们在更改 src 后引用 .load() 函数调用，但我不知道我是否正确设置了 src 开头。

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Untitled Document</title>

<style>

video
{
    background-color:#333;
}

</style>

</head>

<body>

<script type="text/javascript">
var width = (1280 * 0.1);
var height = (720 * 0.1);
var resized = false;

function getWidth(){
    return width;
}

function getHeight(){
    return height;
}

//Create array. Checkbox adds video to list.
//"Submit" button gives first video in list to player.

var videoList = new Array();
var i = 0; //incrementer

//Use checkbox's value as argument
function addVideo(value){
    videoList[i] = value;
    i++;
}

function videoSubmit(){
    document.getElementById("player").setAttribute("src", videoList[i]);
}

</script>

<video id="test" width="getWidth()" height="getHeight()">
<source id="player" src="null" type="video/avi" width="getWidth()"     height="getHeight()"/>

</video>
<br/>

<form id="selector" action="">
<input type="checkbox" name="firstvideo" value="test.avi" onClick="addVideo(test.avi)"/> sample 1.avi<br/>

</form>

<button onClick="videoSubmit()"> Submit</button>

</body>
</html> 
```

我对 javascript 很陌生，但我仍在努力解决它。非常感谢任何有用的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:32:29.423

看起来`i`有错误的价值。尝试：

```
function videoSubmit(){
    document.getElementById("player").setAttribute("src", videoList[ i - 1 ]);
} 
```

还有一些其他问题。这是一个固定版本 - 享受：

[http://jsfiddle.net/mrSYC/](http://jsfiddle.net/mrSYC/)

另一个问题：

你不能这样做：

```
<video id="test" width="getWidth()" height="getHeight()"> 
```

如果您想以编程方式设置这些属性，则必须以与 src 属性相同的方式进行设置。有时你会看到这种结构，但它很笨拙：

```
<script>document.write('<video id="test" width="' + getWidth() + '" ...')</script> 
```

与 Q 无关 - 您可以通过直接跳到 jquery 来跳过很多 javascript 学习痛苦。它确实会导致页面加载损失，但它解决了纯 javascript 的许多烦恼。以老式的方式做这件事会给你“宝贵的经验”——我们这些拥有它的人可能认为这超过了保证。

[http://jquery.com/](http://jquery.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:31:55.353

您在这里不需要额外的`source`元素，可以简单地定位元素的`src`属性`video`。

所以像：

```
document.getElementById('test').src = videoList[i]; 
```

should be all you need to do (assuming that the value of `videoList[i]` is a valid URL to the video file and that the browser in question can play it).

# c# - IXmlSerializable 更改 xml 标记名称

> ID：11140404
> 
> 赞同：1
> 
> 时间：2012-06-21T14:28:04.990
> 
> 标签：c#, ixmlserializable

我有如下收藏类

```
public class MyClass:IXmlSerializable
{
    int vesrion;
    private Collection<int> testcoll;
} 
```

序列化它我写了WriteXML如下

```
public void WriteXml(XmlWriter writer)
{

    writer.WriteAttributeString("Version", this.vesrion.ToString());    

    XmlSerializer serializer = new XmlSerializer(typeof(Collection<int>));
    serializer.Serialize(writer, Testcoll);
 } 
```

现在输出 xml 与 Testcoll 一样具有标签“ArrayOfInt”。但我想将此名称更改为不同的“MyCollection”。

请告诉我如何实现这一目标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:33:07.830

在字段上使用属性，如下所示：

```
[XmlElement(ElementName = "MyCollection")]
private Collection<int> testcoll; 
```

编辑：@comments，错过了这些细节，请参阅下面的有效答案（编译和测试）

```
XmlSerializer serializer = new XmlSerializer(typeof(Collection<int>), new XmlRootAttribute("MyCollection"));
serializer.Serialize(writer, Testcoll); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-14T14:15:39.250

不创建新 XmlSerializer 的另一种方法：

```
public void WriteXml(XmlWriter writer)
{
    writer.WriteAttributeString("Version", vesrion.ToString(CultureInfo.InvariantCulture));
    writer.WriteStartElement("MyCollection");
    foreach (int collint in Testcoll)
    {
        writer.WriteElementString("int", collint.ToString(CultureInfo.InvariantCulture));
    }
    writer.WriteEndElement();
} 
```

# regex - 如何在 TCL 的文件中使用正则表达式匹配信息？

> ID：11140405
> 
> 赞同：0
> 
> 时间：2012-06-21T14:28:12.537
> 
> 标签：regex, tcl

我有一个文件存储在终端服务器中，并且文件中存储了一些信息，我想使用 TCL 和正则表达式进行匹配。

我怎么能做到这一点？我需要打开文件才能使用正则表达式吗？谁可以帮我这个事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:56:25.610

是的。从概念上讲，您将文件读入内存，然后使用正则表达式来获取您想要的信息。对于非常大的文件，一次读取一段（例如，一行）并将正则表达式应用于其中会受益，但随后您可能必须处理多行模式，这会使代码变得更加棘手.

读入文件可能需要您先将其复制到本地计算机。（您通常可以避免实际在本地创建文件，但并非总是如此。）或者您将运行 Tcl 程序的位置重新定位到原始文件旁边；一般来说，这也可以正常工作。

假设您有一个非常简单的案例：

```
# Use scp to bring file across; _many_ other options possible
exec scp otherhost:file.txt localfile.txt

# Read in the file:
set f [open localfile.txt]
set data [read $f]
close $f

# Get the interesting bits...
if {[regexp {MATCH_THIS: (\d+)} $data -> theNumber]} {
    # Found a match, number in $theNumber
} 
```

# hibernate - Hibernate：如何在 JUnit 测试后回滚事务？

> ID：11140409
> 
> 赞同：1
> 
> 时间：2012-06-21T14:28:32.987
> 
> 标签：hibernate, transactions, junit, rollback

我在独立应用程序中使用 Hibernate 4.0.1.Final。底层数据库是 MySQL 5.5。使用 JUnit 4.8.1，我正在测试我的数据访问对象，并希望运行测试，以便当我的 JUnit 测试结束时，我的所有更改都会回滚。有没有一种优雅的方式来做到这一点？现在，一切都在进行中，这是有道理的。这是我的 JUnit 测试……</p>

```
@Before
public void setUp() throws IOException { 
    final InputStream in = getClass().getClassLoader().getResourceAsStream("test.properties");
    testProps = new Properties();
    testProps.load(in);
    final Configuration configuration = new Configuration();
    configuration.configure().setProperty("hibernate.show_sql", "false");
    final ServiceRegistry serviceRegistry = new ServiceRegistryBuilder().applySettings(configuration.getProperties()).buildServiceRegistry();
    sessionFactory = configuration.buildSessionFactory(serviceRegistry);
    orgDao = new OrganizationDAOImpl(sessionFactory);
}   // setUp

@Test
public void testInsertSchool() { 
    final Organization org = new Organization();
    org.setOrganizationId(testProps.getProperty("test.id"));
    org.setName(testProps.getProperty("test.name"));
    orgDao.saveOrUpdate(org);
    final Organization foundOrg = orgDao.findById(org.getOrganizationId());
    Assert.assertEquals(org, foundOrg);
} 
```

这是来自数据访问对象的代码……</p>

```
protected void saveOrUpdate(Object obj) {
    try {
        startOperation();
        session.saveOrUpdate(obj);
        tx.commit();
    } catch (HibernateException e) {
        handleException(e);
    } finally {
        session.close();
    }
}

protected Object find(Class clazz, Serializable id) {
    Object obj = null;
    try {
        startOperation();
        obj = session.get(clazz, id);
        tx.commit();
    } catch (HibernateException e) {
        handleException(e);
    } finally {
        session.close();
    }
    return obj;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T20:25:06.003

我决定使用 HSSql 内存数据库，如此处所述——http: [//vageeshhoskere.wordpress.com/2011/06/16/unit-test-with-junit-for-hibernate-using-hsqldb -内存中/](http://vageeshhoskere.wordpress.com/2011/06/16/unit-test-with-junit-for-hibernate-using-hsqldb-in-memory/)。这样，我可以重复运行 JUnit 测试（在服务级别），并保证每次运行它们时世界的状态都是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:38:06.237

The way to do that would be to separate out your commits and session closes from your database operations. I actually think it's better to do that anyhow because not every database operation should be its own transaction. There are significant advantages to being able to use the same session in multiple operations and to use the same transaction for multiple operations.

The way I'd characterize the transaction layer is it's a business rule concern, as they define atomic units of work at the database level. It ought to be one layer out from the layer that abstracts hibernate operations for persist, find, and merge. Heres why:

1.  Doing this will allow a lot greater flexibility in how you design your application's business rules to handle new cases in which different database operations are interdependent without forcing you to write a million methods in that database object just to handle the different transaction rules for each case.
2.  Not only that, moving those operations out allows you to achieve what you want in your unit tests.
3.  Open/Close operations are expensive, if you're doing 5 queries in a row and there's no reason for them to be in a separate session, you shouldn't be opening and closing 5 sessions.

# jqplot - jqPlot 为每个饼图设置颜色

> ID：11140412
> 
> 赞同：1
> 
> 时间：2012-06-21T14:28:47.853
> 
> 标签：jqplot

我知道如何用折线图做到这一点，但我必须使用饼图。

任务是我有一个图表，概述了一组产品的状态使用情况，我需要将一个切片设置为始终相同的颜色，但问题是我可以让系列代码工作，并且没有好的建议任何一个。

我想要的是，如果我们看到一些东西没有被大量使用，我们希望它是相同的颜色，否则它可以是任何颜色。

```
example:
product #1 has sold 2 units in last 30 days
product #2 has sold 100 units in last 3 days
product #3 has sold 1 units in last 30 days 
```

产品#3 应该是红色的，但其他两个可以是其他任何东西。

目前我正在使用 seriesColors，但我想要的数据并不总是按特定顺序排列，所以这对于我需要的东西来说是一个糟糕的解决方案。

我希望有人对此有所了解，并希望它是可能的。

我必须使用 jqPlot，所以请不要对不同的库提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:42:58.543

所以把它们作为所有销售产品总和的 1。然后对于颜色，创建一组你真正认为可以协同工作的颜色，并从你的列表中随机选择（不包括红色）。然后对于最低的项目将颜色设置为红色。

如果您不能使用 jqPlot，请查看 D3.js。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-08T05:30:09.090

```
seriesColors :[
               '#FF4700','#BA00FF',
               '#25FF00', '#5100FF',
               '#aa2211','#FFFF00',
               '#3377aa', '#FAE8FD',
               '#9933aa','#00FFED',
               '#9324A6', ''
              ], 
```

# html - 使用 div 中的 2 个表固定列标题

> ID：11140413
> 
> 赞同：0
> 
> 时间：2012-06-21T14:28:51.020
> 
> 标签：html

我将 2 个表（标题和数据）动态加载到一个 div 中。我希望标题表在数据行可滚动时保持固定。

我必须在这些表中设置什么才能完成此操作？

或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:45:58.177

更好的方法是使用 jQuery 插件 jquery.fixheadertable.js 或者您可以创建一个表，其中包含一行仅具有标题的行，即`<th>`其他行仅包含数据的行，即`<td>`

```
 <table cellspacing="1" cellpadding="5">
        <tr>
            <th width="140">Heading 1</th>  
            <th width="140">Heading 2</th>
            <th width="140">Heading 3</th>
        </tr>
</table>
<table cellspacing="1" cellpadding="5">
    <tr>
        <th width="140"></th>   
        <th width="140"></th>
        <th width="140"></th>
    </tr>
    <tr>
        <td>Data 1</td> 
        <td>Data 2</td>
        <td>Data 3</td>
    </tr>
</table> 
```

这是一个模板代码。我已经尝试过了，这将满足您的要求。

# cocoa-touch - 如何有效过滤大型 NSArray？

> ID：11140415
> 
> 赞同：3
> 
> 时间：2012-06-21T14:28:53.523
> 
> 标签：cocoa-touch, nsarray, nspredicate, nssortdescriptor

我在过滤大型`NSArray`（19k 个项目）以在 iPhone 上进行交互式自动完成时遇到性能问题。

目前，每当用户在搜索框中键入一个字母时，我都会`NSPredicate`在一个单独的线程中开始使用 an 过滤数组并显示结果。当然，数据集对于 iPhone 来说太大了，要在用户点击第二个键之前完成过滤，所以不会显示预览，直到用户停止输入一两秒。

[Computer Science Babble，你可以放心地跳过这部分] 我猜，框架正在做的是将 NSPredicate 应用于数组中的每一项，因此需要 O(n)，其中 n 是数组项的数量。但是，应该可以使用更有效的方法在 O(log(n)) 中更多地解决问题。即在 O(n*log(n)) 中对列表进行一次排序（这可以在开发时完成），查找需要在该列表中插入搜索字符串的位置 O(log(n)) 并开始迭代直到一个项目不以搜索字符串 O(m) 开头。产生一个有效的 O(log(n) + m)，其中 m << n 算法。DAWG 会更好，但我不记得在工具包中看到过类似的东西。[/计算机科学喋喋不休]

我想知道，如果有一种内置方法可以让数组知道，它是按过滤器正在测试的相同字段排序的，因此过滤器可以有效地应用于该排序数组。

**解决方案**

我使用字典创建了一个非常简单的搜索索引，该字典将单个字符映射到其键以该字符开头的项目数组。至少对于我的用例而言，这足以实现即时显示自动完成的优化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:41:33.670

如果数据以某种方式排序，那么我建议将数组分成多个较小的数组。所以你可能有 AG、HM、NZ 阵列。

或者将所有内容填充到核心数据或 SQLite 数据库中，并使用查询来帮助加快速度。在处理如此大的数据集时，索引数据库选择将比尝试过滤内存中的数据更有效。

另一个建议是创建一个 trie，这会使一切变得更好。尽管创建它们需要一些工作：

[http://en.wikipedia.org/wiki/Trie](http://en.wikipedia.org/wiki/Trie)

# jquery - iOS Safari - 禁用缩放

> ID：11140417
> 
> 赞同：4
> 
> 时间：2012-06-21T14:29:00.587
> 
> 标签：jquery, ios, mobile-safari, zooming

我试图禁用移动 safari 上的一项功能，但不确定如何描述它。

我正在添加一个支持`swipeleft()`和`swiperight()`触摸事件的 Jquery 滑块。

因此，我想禁用该功能，当您滑动到页面边缘时，它会在网站后面显示灰色的“苹果亚麻背景”。

这会干扰用户体验，我想在中心修复我的网站，因此用户无法在“浏览器空间”内拉动它

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:36:46.863

把它放在你的 head 标签中：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

# ios - 将 MFMessageComposerViewController 添加到主视图

> ID：11140418
> 
> 赞同：1
> 
> 时间：2012-06-21T14:29:01.260
> 
> 标签：ios, view, iad, mfmessagecomposeview

是否可以在主视图的指定区域显示 MFMessageComposerViewController。换句话说，当我点击发送消息时，我想在我的 viewController 中显示我的 messageViewController（例如，为了让用户观看 iAD 横幅）。

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:37:09.227

不它不是。MFMessageComposerViewController 必须以模态方式显示。

“配置初始值后，使用 presentModalViewController:animated: 方法以模态方式呈现视图控制器。完成后，使用dismissModalViewControllerAnimated: 方法将其关闭。”

[http://developer.apple.com/library/ios/#DOCUMENTATION/MessageUI/Reference/MFMessageComposeViewController_class/Reference/Reference.html](http://developer.apple.com/library/ios/#DOCUMENTATION/MessageUI/Reference/MFMessageComposeViewController_class/Reference/Reference.html)

# javascript - 在 CoffeeScript 中使用 indexOf

> ID：11140422
> 
> 赞同：5
> 
> 时间：2012-06-21T14:29:12.127
> 
> 标签：javascript, arrays, internet-explorer-8, coffeescript

我在 CoffeeScript 中使用以下代码：

```
if elem in my_array
  do_something() 
```

编译成这个javascript：

```
if (__indexOf.call(my_array, elem) < 0) {
  my_array.push(elem);
} 
```

我可以看到它正在使用脚本顶部定义的函数 __indexOf。

**我的问题是关于这个用例：**我想从数组中删除一个元素，并且我想支持 IE8。我可以在支持对象的浏览器`indexOf`中轻松做到这一点。但是，在 IE8 中这不起作用：`splice``indexOf``array`

```
if (attr_index = my_array.indexOf(elem)) > -1
  my_array.splice(attr_index, 1) 
```

我尝试使用`__indexOf`CoffeScript 定义的函数，但在编译器中出现保留字错误。

```
if (attr_index = __indexOf.call(my_array, elem) > -1
  my_array.splice(attr_index, 1) 
```

**那么如何使用 CoffeScript 或者有没有更隐蔽的方法来调用 indexOf？**两次定义相同的函数似乎很奇怪，只是因为 CoffeeScript 不允许我使用他们的......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T14:51:24.593

不，CoffeeScript 阻止你直接使用它的助手，因为这会破坏语言和实现之间的区别。为了支持 IE8，我会添加一个像

```
Array::indexOf or= (item) ->
  for x, i in this
    return i if x is item
  return -1 
```

或者使用像[Underscore.js](http://documentcloud.github.com/underscore/)这样的库来进行数组操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-10T06:06:46.290

CoffeeScript 将以下内容添加到文件范围的顶部：

```
var __indexOf = [].indexOf || function(item) {
  for (var i = 0, l = this.length; i < l; i++) {
    if (i in this && this[i] === item) return i;
  }
  return -1;
}; 
```

如果我们试图通过这样做来利用它：

```
indexOf = __indexOf 
```

这会产生编译器错误：`RESERVED WORD "__INDEXOF"`

解决方案是使用反引号颠覆编译器：

```
indexOf = `__indexOf` 
```

然后使用它

```
indexOf.call([1,2,3,4], 3) //2 
```

或者我们可以从@Trevor Burnham 的回答中减少重复代码：

```
Array::indexOf or= `__indexOf` 
```

但是，您需要确保 CoffeeScript 将通过将`in`运算符用作布尔表达式（并在右侧使用动态长度数组）来添加此定义。归根结底，对于某些人来说，重新定义它可能会更容易:)

# objective-c - 重新加载根视图控制器

> ID：11140424
> 
> 赞同：5
> 
> 时间：2012-06-21T14:29:13.860
> 
> 标签：objective-c, ios, cocoa-touch, uiviewcontroller, uinavigationcontroller

我正在`UINavigationController`我的应用程序中使用 a 。在`viewDidLoad`中，根视图控制器从 Internet 获取信息，对其进行解析并显示。

当转到 中的另一个视图`UINavigationController`，然后返回到 root`UIViewController`时，控制器中的信息不会重新加载。这使我认为`viewDidLoad`没有被调用。

我应该使用什么方法来确保在将根视图控制器弹回到`UINavigationController`?

**编辑：**

感谢你们的快速回复，这意味着很多。关于您的答案的另一个问题：`viewWillAppear`或`viewDidAppear`？每个都有优点/缺点吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-21T14:32:18.460

您应该处理`viewWillAppear:`或`viewDidAppear:`，具体取决于您是否希望在屏幕上显示 w 视图之前或之后进行重新加载。`viewDidLoad`仅在加载视图时调用一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:31:59.267

您应该使用`viewDidAppear`,`viewDidLoad`仅在第一次加载视图后调用。

在这里检查一下：

[UIView 编程指南](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007457)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T14:32:20.820

你是对的，它没有被调用。如果您想在每次访问时调用它`UIViewController`（您的内部有一个`UINavigationController`），只需将其放在`viewDidAppear`or上`viewWillAppear`。

* * *

`viewWillAppear`发生在之前`viewDidAppear`。出于速度目的，我会`viewDidAppear`以异步方式在辅助线程上执行此操作，因此 UI 线程不会减慢。检索到数据后，我将更新视图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T14:34:57.683

`viewDidLoad`仅在最初创建 View Controller 时调用，或者因为它被隐藏而被卸载并且应用程序收到内存警告时才调用。您可以交替实现`viewWillAppear:`或`viewDidAppear:`刷新您的 UI。

# javascript - 缩放路径和形状时 changes size

> ID：11140426
> 
> 赞同：1
> 
> 时间：2012-06-21T14:29:22.127
> 
> 标签：javascript, html, svg, raphael

我正在使用 Raphael 在页面上绘制一些形状。`<svg>`已经设置为并且`{ width:100%; height:600px }`工作正常。当我调整浏览器宽度时，我想调整里面的形状`<svg>`以适应新的宽度。理想情况下，这应该自动发生；必须手动缩放 window.resize 上的每个形状和路径似乎是错误的。

我知道百分比在路径字符串中是非法的，但这基本上是我想要做的：

```
var r = Raphael('container', '100%', 600);
r.path("M0,0 L0,0 55%,0 100%,61z") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:49:45.340

您应该首先为纸张和路径使用绝对宽度和高度。您还需要使用`setViewBox()`.

从那里，您使用 CSS 将宽度设置`div#container`为 100%。您可能还需要设置`body`，`html`因此：

```
body,
html {
margin: 0;
width: 100%;
} 
```

# javascript - Firebug 调试器不工作

> ID：11140435
> 
> 赞同：0
> 
> 时间：2012-06-21T14:30:02.467
> 
> 标签：javascript, debugging, firefox, firebug, breakpoints

在一个 JS 文件中，我计划设置以编程方式工作的断点，并且由于某种原因 Firebug 没有触发断点。有时它有效，有时则无效。我尝试触发“中断所有错误”，但仍然不起作用。只有当我同时触发“中断所有错误”和“调试器语句”时，它似乎才有效，但即便如此，它也只有 3/50 次尝试。我的 Firefox 是 3.X。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:34:03.180

如果您的调试器没有在特定断点处停止，那么可以肯定地说代码在执行该特定 JS 之前失败了。

# unix - 在 unix 中获取网站的部分源代码

> ID：11140436
> 
> 赞同：0
> 
> 时间：2012-06-21T14:30:12.493
> 
> 标签：unix, debian, wget

如何只获取网站源代码的特定部分，而不必使用 wget 然后 grep 获取整个文档？我只需要一小部分，获取整个源代码会导致大量流量。

当我得到我想要的部分时，是否有可能停止阅读源代码？我只需要前几行...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:34:30.370

您可以`head`在管道中添加调用，以仅将行保留在输出的开头。

# apache - 页面重定向延迟

> ID：11140446
> 
> 赞同：1
> 
> 时间：2012-06-21T14:30:55.257
> 
> 标签：apache, jakarta-ee, redirect, delay, page-load-time

我有一个基于 Java Spring 框架和 mysql 数据库的 Web 应用程序。它托管在带有 Ubuntu Lucid 10.04 的 Linode 上。我使用 apache mod_rewrite 进行重定向。每次页面重定向完成时，在加载下一页之前都会有一个延迟。一旦其他页面开始呈现，该页面就会快速加载。延迟是在单击 ahref 链接之后，直到加载下一页。在此延迟期间，浏览器的左下方显示“等待 doondoo”。这个问题一般存在于整个 Web 应用程序中。我想知道是什么导致了这种延迟？是页面上的查询还是需要加载的html组件或重定向规则还是其他？任何建议都将有助于找到问题的根本原因。要检查问题，您可以访问[www.doondoo.com](http://www.doondoo.com)并单击页面上的任何链接。提前致谢。

我现在添加了一个显示等待时间为 5.4 秒的快照。使用对象级缓存会解决问题吗？ ![延迟快照](../Images/5ce5c8ab417530bf5db2a94079759ab6.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:22:56.337

马克西姆——

我使用 Chrome 作为我的浏览器，它有一组非常方便的开发工具（在 Mac 上的“查看”菜单下，在 Windows 下类似的地方），其中包括网络请求的时间线。它记录在这里：[https ://developers.google.com/chrome-developer-tools/docs/network](https://developers.google.com/chrome-developer-tools/docs/network)

我正在查看您来自美国的 doondoo 页面，似乎需要最长时间才能进入（并延迟页面呈现）的资源是公司缩略图，所有这些都保存为 GIF，其中一些 40-大小为 50kB。我尝试抓取其中一个并将其重新保存为 JPEG，它减小到大约 11kB，因此您可以尝试减小这些图像的大小。看起来您在 CSS 中明确地布置了页面的元素大小，这很好，而且我希望看到页面用更小的图像渲染得更快。

我强烈推荐 Firebug（在 Firefox 中）或 Chrome 中的开发者工具，其中任何一个都可以帮助您进一步查明需要这么长时间才能呈现的内容。

祝你好运！

# ruby - 为什么 Process.setsid 在 ruby 中需要 root 权限？

> ID：11140452
> 
> 赞同：6
> 
> 时间：2012-06-21T14:31:11.187
> 
> 标签：ruby, process, daemon, root

在 Ruby 中，如果以非超级用户身份运行，则调用`Process.setsid`失败并显示“不允许操作”错误。尝试：

```
$ irb
irb(main):001:0> Process.setsid
Errno::EPERM: Operation not permitted
    from (irb):1:in `setsid'
    from (irb):1
    from ~/.rbenv/versions/1.9.2-p290/bin/irb:12:in `<main>' 
```

或者，如果我更改 uid 或使用`Process.uid=`方法的进程，它会失败并出现相同的错误。如果我以 root 身份运行 Ruby 程序，它可以正常工作，并且我不会在运行时更改进程的 UID。

但是，在 Ubuntu 或其他发行版的 shell 中，`setsid`（参考： http: [//linux.die.net/man/2/setsid](http://linux.die.net/man/2/setsid)）程序不需要超级用户权限。

我知道这会`stdsid`重置程序的会话，这在守护进程时也很有用。在我的代码中，我试图更改 UID 并对其进行守护，同时还重置会话。

因此，我很好奇为什么`Process.setsid`需要上述权限，而`setsid`大多数 UNIX 等操作系统上的程序却不需要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T20:38:35.800

[Process.setsid](http://www.ruby-doc.org/core-1.9.3/Process.html#method-c-setsid)是对 POSIX [setsid(2)](http://linux.die.net/man/2/setsid)的精简包装，其手册页显示：

> 错误
> 
> EPERM
> 
> 任何进程的进程组 ID 等于调用进程的 PID。因此，特别是，如果调用进程已经是进程组领导，则 setsid() 会失败。

当你的程序运行时，它已经是组长了。在去恶魔化时，您应该为您的守护进程派生一个新进程。`Process.setsid`分叉后没有 EPERM 错误的情况下工作：

```
$ irb
irb> Process.setsid
Errno::EPERM: Operation not permitted
    from (irb):1:in `setsid'
    from (irb):1
    from /Users/dbenhur/.rbenv/versions/1.9.3-p194/bin/irb:12:in `<main>'
irb> fork { Process.setsid }
=> 3359 
```

查看[Rexec](https://github.com/ioquatix/rexec/blob/master/lib/rexec/daemon/controller.rb)或[unicorn](https://github.com/defunkt/unicorn/blob/master/lib/unicorn/launcher.rb)以了解 Ruby 中的 POSIX 守护进程的示例。

setsid(1) 程序没有收到 EPERM 错误，因为它在调用 setsid(2) 之前分叉。请参见[此处的第 31 行](http://anonscm.debian.org/gitweb/?p=users/lamont/util-linux.git;a=blob;f=sys-utils/setsid.c;h=baf3b0aae4de642727b4c025aa9206bf10e699ad;hb=HEAD#l31)

# asp.net-mvc - StructureMap 和方法注入

> ID：11140453
> 
> 赞同：0
> 
> 时间：2012-06-21T14:31:12.020
> 
> 标签：asp.net-mvc, dependency-injection, structuremap

我使用结构图来解决这样的构造函数注入

```
public class MyClass
{
    private readonly IDependency _dependency;

    public MyClass(IDependency dependency)
    {
        _dependency = dependency;
    }
// my methods
} 
```

我有一些类依赖：IDependency

在 StructureMap 配置中我有

```
public static IContainer Initialize()
        {
            ObjectFactory.Initialize(x =>
            {
                x.For<IDependency>().Use<Dependency>();
            });
            return ObjectFactory.Container;
        } 
```

一切正常

但是在其他控制器中我需要进行方法注入

```
public ActionResult(IDependency dependency)
{
    dependency.DoSomething();
} 
```

我想在依赖变量中有我的依赖类

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:05:11.423

通常，您会在构造函数（或设置器）中注入 IDependency 并将其分配给私有类成员，然后您可以在方法中使用该成员。

```
private readonly IDependency _dependency;

public MyClass(IDependency dep)
{
    this._dependency = dep;
}

public ActionResult MyAction()
{
    _dependency.DoSomething();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T11:18:59.143

@dave 我同意您的回答，但认为 MyClass 是在 StructureMap 中使用 Shared/Singleton 范围注册的。在这种情况下，如果我将 dep 注入 MyClass ，则意味着我在应用程序的整个生命周期中都持有对 dep 对象的引用。对我来说听起来像是内存耗尽。

我最近遇到了同样的情况，并最终确定将 StructureMap 的 IContainer 注入构造函数（而不是所有其他无意义的对象），并在需要时使用它来获取对象。

```
private readonly IContainer _container;

public MyClass(IContainer con)
{
    this._container = con;
}

public ActionResult MyAction()
{
    var _dependency = _container.GetInstance<IDependency> ();
    _dependency.DoSomething();
} 
```

这样我注入的对象就变成了 MyAction() 方法的范围，并准备好被 GC 使用

# android - Android，是否可以以编程方式更改我的应用程序的 UID

> ID：11140454
> 
> 赞同：1
> 
> 时间：2012-06-21T14:31:13.327
> 
> 标签：android

我正在尝试构建一个应用程序来锁定特定的应用程序和服务。我有一个安装在 android 设备上的软件包列表，我知道如何禁用它们，但是当我尝试时，我得到一个关于 uid 的权限被拒绝错误是不同的。

有没有办法让 android 认为我是试图禁用包或将我正在运行的应用程序的 uid 更改为包的用户。

我知道我可以使用 ApplicationInfo 获取我尝试禁用的包的 uid。

我禁用软件包的方式是：

```
pm.setApplicationEnabledSetting(packageName, 
            PackageManager.COMPONENT_ENABLED_STATE_DISABLED_USER, 
            PackageManager.DONT_KILL_APP); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:32:05.583

> 有没有办法让 android 认为我是试图禁用包或将我正在运行的应用程序的 uid 更改为包的用户。

幸运的是，没有，出于明显的安全原因。

> 无论如何我可以使用 packageinfo 或 applicationinfo 禁用其他下载的和系统应用程序吗？

幸运的是，没有，出于明显的安全原因。

您可能在根设备上有其他选项，当然还有自定义固件。

# objective-c - RestKit 不将数据保存到数据库

> ID：11140462
> 
> 赞同：0
> 
> 时间：2012-06-21T14:31:35.953
> 
> 标签：objective-c, ios, restkit

我第一次使用 RestKit，我在获取对象以保存到数据库时遇到了一些问题，或者它们的值没有得到 stetted。

我有一个看起来像这样的 JSON 请求：

```
{"categories":{"id":1 ... 
```

我像这样设置类别的映射：

```
RKObjectManager *objectManager = [RKObjectManager objectManagerWithBaseURLString:@"[base-url]"]; 

RKManagedObjectStore* objectStore = [RKManagedObjectStore objectStoreWithStoreFilename:@"App.sqlite"];
objectManager.objectStore = objectStore;

objectManager.client.requestQueue.showsNetworkActivityIndicatorWhenBusy = YES;

RKManagedObjectMapping *categoryMapping = [RKManagedObjectMapping mappingForClass:[Category class] inManagedObjectStore:objectManager.objectStore];

[objectManager.mappingProvider setObjectMapping:categoryMapping forResourcePathPattern:@"[path-to-json].json"];

[[RKObjectManager sharedManager].mappingProvider setMapping:categoryMapping forKeyPath:@"categories"];

// Maps keys between the database and costom model object.
categoryMapping.primaryKeyAttribute = @"categoryId";
[categoryMapping mapKeyPath:@"categories.id" toAttribute:@"categoryId"];
[categoryMapping mapKeyPath:@"categories.name" toAttribute:@"name"];
[...] 
```

我的类别的自定义模型对象如下所示：

```
@interface Category : NSManagedObject

@property (nonatomic, retain) NSNumber *categoryId;
@property (nonatomic, retain) NSString *name;
[...]

@implementation Category

@dynamic categoryId;
@dynamic name;
[...] 
```

我像这样加载对象（很像 Twitter 示例）：

```
// Loads from the database
- (void)loadObjectsFromDataStore {

    NSFetchRequest *request = [Category fetchRequest];
    _categories = [Category objectsWithFetchRequest:request];
}

- (void)loadCategories {
    RKObjectManager *objectManager = [RKObjectManager sharedManager];
    [objectManager loadObjectsAtResourcePath:@"[path-to-json].json" delegate:self];
}

- (void)objectLoader:(RKObjectLoader*)objectLoader didLoadObjects:(NSArray*)objects {

    // The array is always empty.
    NSLog(@"Objects: %@", objects);

    [[NSUserDefaults standardUserDefaults] synchronize];
    [self loadObjectsFromDataStore];
} 
```

正如我所说，当我从模拟器中检查本地数据库时，它会被插入，但值为 NULL 并且 category_id 始终为 0。

关于如何解决这个问题的任何想法？将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:23:22.793

试试这个映射：

```
RKManagedObjectMapping* categoryMapping = [RKManagedObjectMapping mappingForClass: [Category class]];
categoryMapping.primaryKeyAttribute = @"categoryId";
categoryMapping.rootKeyPath = @"categories";
[categoryMapping mapKeyPathsToAttributes: @"id", @"categoryId", @"name", @"name", nil]; 
```

和

```
[[RKObjectManager sharedManager].mappingProvider setMapping:categoryMapping forKeyPath:@""]; 
```

它说，当您检测到“类别”时使用此映射，并使用“categoryId”索引核心数据对象。

或者

```
RKManagedObjectMapping* categoryMapping = [RKManagedObjectMapping mappingForClass: [Category class]];
categoryMapping.primaryKeyAttribute = @"categoryId";
[categoryMapping mapKeyPathsToAttributes: @"id", @"categoryId", @"name", @"name", nil]; 
```

和

```
[[RKObjectManager sharedManager].mappingProvider setMapping:categoryMapping forKeyPath:@"categories"]; 
```

# objective-c - 我们如何点击 UITableViewCell 跳转到另一个 View？

> ID：11140473
> 
> 赞同：0
> 
> 时间：2012-06-21T14:32:22.853
> 
> 标签：objective-c, ios, storyboard, xcode4.3

当我在Xcode4中使用storyboard时，而不是之前的xib，我点击`UITableViewCell`in`UITableView`来推送View B，B有一个tableView和其他按钮和标签。如果B继承自`UIViewController`，当我推B时，B的背景是黑色的！如果 B 继承`UITableViewController`，当我按下 B 时，B 显示唯一的表，其他按钮和标签消失！我已经使用 push 连接了单元格和 B。 ![在此处输入图像描述](../Images/b596ad5cada6f773f94877c240feae7e.png) 我想点击左侧视图 A 上的表格单元格到右侧视图 B。

我想看到的是![在此处输入图像描述](../Images/f35b71b0542594bfbc38a06bb482c9f4.png)

但是当B继承`UIViewController`并实现UITableViewDataSource和delegate时，当跳转到它时，它显示![在此处输入图像描述](../Images/4d5d406287966b43760269a216ad8fe1.png)！

当我将 B 更改为继承`UITableViewController`时，它显示![在此处输入图像描述](../Images/3f8fe2a45e9916381dd55eea2924046e.png)

这两个都不是我想要的......

# c++ - 如何获取给定文件夹中具有特定扩展名的文件列表？

> ID：11140483
> 
> 赞同：59
> 
> 时间：2012-06-21T14:32:59.437
> 
> 标签：c++, filesystems, file-management

我想获取给定文件夹（并递归地获取其子文件夹）中具有特定扩展名的所有文件的文件名。也就是说，文件名（和扩展名），而不是完整的文件路径。这在 Python 等语言中非常简单，但我不熟悉 C++ 中的结构。如何做呢？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-06-21T16:24:19.740

```
#define BOOST_FILESYSTEM_VERSION 3
#define BOOST_FILESYSTEM_NO_DEPRECATED 
#include <boost/filesystem.hpp>

namespace fs = boost::filesystem;

/**
 * \brief   Return the filenames of all files that have the specified extension
 *          in the specified directory and all subdirectories.
 */
std::vector<fs::path> get_all(fs::path const & root, std::string const & ext)
{
    std::vector<fs::path> paths;

    if (fs::exists(root) && fs::is_directory(root))
    {
        for (auto const & entry : fs::recursive_directory_iterator(root))
        {
            if (fs::is_regular_file(entry) && entry.path().extension() == ext)
                paths.emplace_back(entry.path().filename());
        }
    }

    return paths;
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2017-12-26T07:45:20.493

一个 C++17 代码

```
#include <fstream>
#include <iostream>
#include <filesystem>
namespace fs = std::filesystem;

int main()
{
    std::string path("/your/dir/");
    std::string ext(".sample");
    for (auto &p : fs::recursive_directory_iterator(path))
    {
        if (p.path().extension() == ext)
            std::cout << p.path().stem().string() << '\n';
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2012-06-21T16:11:35.850

在 Windows 上，您可以执行以下操作：

```
void listFiles( const char* path )
{
   struct _finddata_t dirFile;
   long hFile;

   if (( hFile = _findfirst( path, &dirFile )) != -1 )
   {
      do
      {
         if ( !strcmp( dirFile.name, "."   )) continue;
         if ( !strcmp( dirFile.name, ".."  )) continue;
         if ( gIgnoreHidden )
         {
            if ( dirFile.attrib & _A_HIDDEN ) continue;
            if ( dirFile.name[0] == '.' ) continue;
         }

         // dirFile.name is the name of the file. Do whatever string comparison 
         // you want here. Something like:
         if ( strstr( dirFile.name, ".txt" ))
            printf( "found a .txt file: %s", dirFile.name );

      } while ( _findnext( hFile, &dirFile ) == 0 );
      _findclose( hFile );
   }
} 
```

在 Posix 上，如 Linux 或 OsX：

```
void listFiles( const char* path )
{
   DIR* dirFile = opendir( path );
   if ( dirFile ) 
   {
      struct dirent* hFile;
      errno = 0;
      while (( hFile = readdir( dirFile )) != NULL ) 
      {
         if ( !strcmp( hFile->d_name, "."  )) continue;
         if ( !strcmp( hFile->d_name, ".." )) continue;

         // in linux hidden files all start with '.'
         if ( gIgnoreHidden && ( hFile->d_name[0] == '.' )) continue;

         // dirFile.name is the name of the file. Do whatever string comparison 
         // you want here. Something like:
         if ( strstr( hFile->d_name, ".txt" ))
            printf( "found an .txt file: %s", hFile->d_name );
      } 
      closedir( dirFile );
   }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-05-06T23:34:43.707

获取文件列表并处理每个文件并遍历它们并存储回不同的文件夹

```
void getFilesList(string filePath,string extension, vector<string> & returnFileName)
{
    WIN32_FIND_DATA fileInfo;
    HANDLE hFind;   
    string  fullPath = filePath + extension;
    hFind = FindFirstFile(fullPath.c_str(), &fileInfo);
    if (hFind != INVALID_HANDLE_VALUE){
        returnFileName.push_back(filePath+fileInfo.cFileName);
        while (FindNextFile(hFind, &fileInfo) != 0){
            returnFileName.push_back(filePath+fileInfo.cFileName);
        }
    }
} 
```

使用：您可以像这样使用从文件夹中加载所有文件并一一循环

```
String optfileName ="";        
String inputFolderPath =""; 
String extension = "*.jpg*";
getFilesList(inputFolderPath,extension,filesPaths);
vector<string>::const_iterator it = filesPaths.begin();
while( it != filesPaths.end())
{
    frame = imread(*it);//read file names
        //doyourwork here ( frame );
    sprintf(buf, "%s/Out/%d.jpg", optfileName.c_str(),it->c_str());
    imwrite(buf,frame);   
    it++;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-21T14:42:15.790

您没有说您使用的是什么操作系统，但有几种选择。

正如评论者所提到的，如果您可以使用 boost ，则[boost::filesystem将起作用。](http://www.boost.org/doc/libs/1_41_0/libs/filesystem/doc/index.htm)

其他选项是

*   [CFileFind 类与 MFC](http://msdn.microsoft.com/en-us/library/f33e1618%28v=vs.90%29.aspx)
*   [FindFirstFile/FindNextFile 与 WIN32](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364418%28v=vs.85%29.aspx)
*   [带有 POSIX 的 opendir/readdir](http://en.wikipedia.org/wiki/Dirent.h)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-13T20:51:36.583

这是我的解决方案（适用于 *nix 系统）：

```
#include <dirent.h>

bool FindAllFiles(std::string path, std::string type, std::vector<std::string> &FileList){
  DIR *dir;
  struct dirent *ent;
  FileList.clear();

  if ((dir = opendir (path.c_str())) != NULL) {
    //Examine all files in this directory
    while ((ent = readdir (dir)) != NULL) {
      std::string filename = std::string(ent->d_name);
      if(filename.length() > 4){
        std::string ext = filename.substr(filename.size() - 3);
        if(ext == type){
          //store this file if it's correct type
          FileList.push_back(filename);
        }
      }
    }
    closedir (dir);
  } else {
    //Couldn't open dir
    std::cerr << "Could not open directory: " << path << "\n";
    return false;
  }
  return true;
} 
```

显然将所需的扩展名更改为您喜欢的任何内容。还假定为 3 个字符类型。

# android - queryIntentActivities() 在结果中包含私有 Activity

> ID：11140485
> 
> 赞同：7
> 
> 时间：2012-06-21T14:33:10.170
> 
> 标签：android, android-intent, android-activity

我的一个应用中有一个 Activity，它有一个 Intent 过滤器，但仍被标记为私有，即`android:exported=false`：

```
 <activity android:exported="false" android:name=".facebook.PostToFacebookActivity" android:icon="@drawable/facebook_icon" android:label="@string/facebook_built_in">
        <intent-filter>
            <action android:name="android.intent.action.SEND" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="text/plain" />
        </intent-filter>
    </activity> 
```

（Activity 仅供内部使用；我的应用程序的一部分允许用户从可以在某处发送文本的所有 Activity 列表中进行选择，这使我可以轻松地将几个应用程序内部选项添加到整个列表中。）

但是，当我`queryIntentActivites()`从*不同*的应用程序使用时，我的“私人”活动仍然返回：

```
// Returned list includes the above activity, even though it's declared private.
List<ResolveInfo> infoList = pm.queryIntentActivities(
        myIntent,
        PackageManager.MATCH_DEFAULT_ONLY | 
        PackageManager.GET_INTENT_FILTERS
); 
```

基本*安全*似乎工作正常，就好像我尝试从其他应用程序启动 Activity 一样，我得到一个安全异常。但是，为 Intent 请求活动会为您提供一个列表，其中包括您不允许开始的活动，这似乎很奇怪。

我原以为如果将 Activity 设置为不导出，它甚至不会出现在`queryIntentActivities()`结果中。无论如何，这就是我想要的行为。是否有一个标志我可以用来说“不要向我显示私人活动”，或者一种过滤结果以摆脱我不允许开始的活动的简单方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-10T11:00:19.003

> 我原以为如果将 Activity 设置为不导出，它甚至不会出现在 queryIntentActivities() 结果中。

这太合乎逻辑了*。*:-)

> 有没有我可以用来说“不要向我显示私人活动”的标志

当然没有记录在案的。

> 或者过滤结果以摆脱我不允许开始的活动的简单方法？

给定 a `ResolveInfo`，`activityInfo.exported` `boolean`对于非导出活动， 应该是错误的。您可以遍历`queryIntentActivities()`结果并清除未导出的结果。

# jquery - 如何使用新的验证扩展 jquery.validate.unobtrusive？

> ID：11140496
> 
> 赞同：4
> 
> 时间：2012-06-21T14:33:53.553
> 
> 标签：jquery, jquery-validate

我需要能够使用 jquery.validate 和 jquery.validate.unobtrusive 在我的表单上验证分数。我已更改我的 html 标记以包含“分数”

```
<input class="span12 data fraction" data-val="true" name="FrontHoodHeightL" id="FrontHoodHeightL" type="text" value="29 15/16"> 
```

在类名中，我在我的页面中包含了以下 javascript。

```
$.validator.addMethod("fraction", function (value, element, param) {
    var fracExp = new RegExp("(?:-(?!0))?\d+(?:(?: \d+)?/\d+)?");
    return fracExp.test(value);
}); 
```

但该方法似乎永远不会被调用。我错过了什么步骤来连接它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T23:06:15.190

再一步：[`addClassRules`](http://docs.jquery.com/Plugins/Validation/Validator/addClassRules)用于添加使用您的新方法的类规则：

```
$.validator.addClassRules("fraction", {
    fraction: true
}); 
```

**示例：http:** [//jsfiddle.net/X2m4U/](http://jsfiddle.net/X2m4U/)

*注意*：看起来您正在尝试在您的正则表达式中使用负面的后视。这[不适](https://stackoverflow.com/q/641407/497356)用于 JavaScript。

# .net - 如何编辑文本文件并删除值？

> ID：11140501
> 
> 赞同：0
> 
> 时间：2012-06-21T14:34:11.637
> 
> 标签：.net, vb.net, vb.net-2010

我有两个文本文件。每个文本文件中的字段由空格 (" ") 分隔。文件 1 的第 1 列中的某些字段与文件 2 的第 1 列中的字段匹配。但是，文件 2 中的第三列是数字字段。我想要做的是检查 file1 中的每个字段与文件 2 中的字段，如果数字为 1，则从文件 2 中删除该行，如果数字大于 1，则从中减去一个。

到目前为止，我有以下编码。

```
Dim lines1 As New List(Of String)(IO.File.ReadAllLines("File1"))
Dim lines2 As New List(Of String)(IO.File.ReadAllLines("File2"))

Dim values As New Dictionary(Of String, Integer)()
For Each line As String In lines1
    Dim fields() As String = line.Split(ControlChars.Tab)
    If fields.Length > 1 Then
        values(fields(0)) = Integer.Parse(fields(1))
    End If
Next

For Each line As String In lines2
    Dim fields() As String = line.Split(ControlChars.Tab)
    If fields.Length > 0 Then
        If values.ContainsKey(fields(0)) > 1 Then
            values(fields(0)) = values(fields(0)) - 1
        Else
            values.remove(fields(0))
        End If
    End If
Next

lines1.Clear()
For Each pair As KeyValuePair(Of String, Integer) In values
    lines1.Add(pair.Key + ControlChars.Tab + pair.Value.ToString())
Next

IO.File.WriteAllLines("File2", lines1.ToArray) 
```

例如

```
File1

String1 String 
String2 String
String5 String
String8 String

File2

String1 String 6
String2 String 8
String3 String 2
String4 String 2
String5 String 1
String6 String 4
String7 String 8
String8 String 1 
```

在我的代码运行之后

```
File1

String1 String 
String2 String
String5 String
String8 String

File2

String1 String 5
String2 String 7
String3 String 2
String4 String 2
String6 String 4
String7 String 8 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:57:35.483

这里有一些解析的乐趣......只需使用它们各自的文件路径调暗 strFile1Path 和 strFile2Path 并让此代码处理其余部分。希望代码和注释能教给你一些技巧。

```
 Dim lstFile1Contents As New List(Of String)(IO.File.ReadAllLines(strFile1Path))
    Dim lstFile2Contents As New List(Of String)(IO.File.ReadAllLines(strFile2Path))

    Dim sbNewFile2Contents As New System.Text.StringBuilder

    For Each strLineToProcess As String In lstFile2Contents

        'Trim off trailing spaces for processing.
        strLineToProcess = Trim(strLineToProcess)

        Dim strCheckForMatch As String = strLineToProcess.Substring(0, (InStr(strLineToProcess, " ") - 1))

        Dim bolFoundMatch As Boolean = False
        Dim intCursor As Integer = 0
        Do Until intCursor = lstFile1Contents.Count OrElse bolFoundMatch

            If lstFile1Contents(intCursor).Substring(0, (InStr(lstFile1Contents(intCursor), " ") - 1)) = strCheckForMatch Then

                bolFoundMatch = True

                'We found a match, so let's check the third field.
                Dim intNumber As Integer = CInt(strLineToProcess.Substring((strLineToProcess.LastIndexOf(" ") + 1), (Len(strLineToProcess) - (strLineToProcess.LastIndexOf(" ") + 1))))

                If intNumber > 1 Then

                    'Subtract one from the third field.
                    sbNewFile2Contents.AppendLine(strLineToProcess.Substring(0, (strLineToProcess.LastIndexOf(" ") + 1)) & (intNumber - 1).ToString())

                End If

            End If

            intCursor += 1

        Loop

        If Not bolFoundMatch Then

            'No match was found, so make sure the line remains unedited.
            sbNewFile2Contents.AppendLine(strLineToProcess)

        End If

    Next

    'Finally write the file contents.
    IO.File.WriteAllText(strFile2Path, sbNewFile2Contents.ToString()) 
```

# asp.net-mvc - ASP.NET MVC：如何在不完整的表单（向导）之间传递数据？

> ID：11140502
> 
> 赞同：1
> 
> 时间：2012-06-21T14:34:13.273
> 
> 标签：asp.net-mvc, model-view-controller, wizard

在我的 Asp.net MVC 项目中，我有一个场景，

1.  用户有一个名为**“Form A”**的大表格要填写。
2.  在填写**表格 A 的**一半时，用户被重定向到**表格 B**以填写信息。
3.  完成表格 B 后，用户将被重定向回表格 A，此时表格 A 应由用户在进入表格 B 之前填写的信息预先填写。

当用户填写表格 B 时，如何以及在哪里保存半填写的表格 A 信息，以及如何使用之前填写的信息重新填写表格 A？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:06:25.413

这有帮助吗[`Passing Data in an ASP.NET MVC Application`](http://msdn.microsoft.com/en-us/library/dd394711%28v=vs.90%29.aspx)

您可以将值存储在 ViewData 或 Session 中，以便在导航时传递值`Page A to Page B`

> 对于大数据输入页面 - 正如评论中所建议的那样 - 最佳选择是将数据存储到数据库中。因为在任何情况下，用户填写数据都非常烦人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T15:24:42.277

一种方法是将`save the incomplete object/form`您正在构建的数据库（您可以将表单 A、B、C 等视为**向导**的一部分）到数据库，然后`id to the next step`将向导传递给数据库。这也意味着您需要使某些数据库字段为空，但它有很大的优势，您还可以将 id 保存在 cookie 中，并允许用户在稍后阶段返回向导。这种方法不需要任何 javascript 或会话状态。

有关 asp.net 向导的示例代码示例，请查看以下帖子：

1)[在 ASP.NET MVC 3 中创建向导](http://afana.me/post/create-wizard-in-aspnet-mvc-3.aspx)

2)[在 ASP.NET MVC 4 中创建一个简单的表单向导](http://blog.degree.no/2012/03/creating-a-simple-form-wizard-in-asp-net-mvc-4/)

3)[在 ASP.NET MVC 第 2 部分中创建向导](http://highoncoding.com/Articles/652_Creating_Wizard_in_ASP_NET_MVC_Part_2.aspx)

# c# - 如何在 app.config 文件中写入日期？

> ID：11140503
> 
> 赞同：12
> 
> 时间：2012-06-21T14:34:18.780
> 
> 标签：c#, .net, date, web-config, app-config

我需要能够在 app.config 文件中定义日期。如何执行此操作，然后使用 c# 检索它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T14:41:09.623

将值存储在配置文件中：

```
<appSettings>
  <add key="DateKey" value="2012-06-21" />
</appSettings> 
```

然后检索您使用的值：

```
var value = ConfigurationSettings.AppSettings["DateKey"];

var appDate = DateTime.Parse(value); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T14:39:50.113

在 Visual Studio 中使用设置很容易。只需通过打开项目的属性来添加设置，然后转到`Settings`并单击“项目不包含默认设置文件。单击此处创建一个。”。

转到设置并添加一个 DateTime 并定义您的`date`. ![在此处输入图像描述](../Images/90e3554be441d97ef005ecfcb0290d34.png)

要访问代码中的设置，您只需执行此操作。

`DateTime myDate = Properties.Settings.Default.MyDate;`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-21T14:39:04.300

Not sure If I fully understand your question. I think that you want to:

You can define date in your **app.config** in the appSettings section:

```
<appSettings>
    <add key="DateX" value="21/06/2012"/>
</appSettings> 
```

And retrieve AppSettings entry by doing something similar to this:

```
Datetime dateX;
System.Configuration.Configuration rootWebConfig1 = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration(null);
if (rootWebConfig1.AppSettings.Settings.Count > 0)
{
        System.Configuration.KeyValueConfigurationElement customSetting =       rootWebConfig1.AppSettings.Settings["DateX"];
        if (customSetting != null)
        {
          dateX = Datetime.Parse(customSetting.Value);
        }
} 
```

You can check this MSDN [link](http://msdn.microsoft.com/en-us/library/610xe886.aspx) for more help.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T14:39:52.727

假设您指的是`<appSettings>`元素，那么您一开始就没有运气：每个键都与一个字符串值相关联。

因此，您可以看到您只需将 DateTime 值序列化为字符串，然后在读回时将其解析回来。

如果您不关心您的 app.config 被人类在记事本中编辑，那么我会将 64 位刻度值存储为字符串整数：

`ConfigurationManager.AppSettings["date"] = myDateTime.Ticks.ToString(CultureInfo.InvariantCulture);`

通过这样做读回来：

```
Int64 ticks = Int64.Parse( ConfigurationManager.AppSettings["date"], NumberStyles.Integer, CultureInfo.InvariantCulture );
DateTime myDateTime = new DateTime( ticks ); 
```

但是，如果您确实想让它易于阅读，请使用往返选项：

```
// Serialise
ConfigurationManager.AppSettings["date"] = myDateTime.ToString("o"); // "o" is "roundtrip"
// Deserialise
DateTime myDateTime = DateTime.Parse( ConfigurationManager.AppSettings["date"], NumberStyles.Integer, CultureInfo.InvariantCulture ) ); 
```

几点注意事项：

*   我的代码是建议性的和粗糙的。实际上，您首先要确保所有 DateTime 实例都采用 UTC，然后在必要时应用时区偏移量。
*   您将首先检查 AppSettings 是否包含名为“date”的键，如果不包含则返回默认或零等效答案。
*   您还应避免使用 .Parse 方法并改用 TryParse 并根据您的应用程序处理错误情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T14:38:50.643

however you want! I mean, a string, but beyond that your options are limitless. If you wanted to, you could store it as a children's book about a date. Just a matter of parsing it wherever you need to use it. But I'd suggest looking into DateTime.ToLongDateString in C# code somewhere, learning that pattern, and storing it like that.

# php - 计算置换的阶乘秩（N 选择 K）

> ID：11140505
> 
> 赞同：3
> 
> 时间：2012-06-21T14:34:21.880
> 
> 标签：php, math, permutation, combinatorics, base-conversion

我最近了解了[CNS](http://en.wikipedia.org/wiki/Combinatorial_number_system)和[FNS](http://en.wikipedia.org/wiki/Factorial_number_system)，因为它们对我来说看起来很优雅，所以我决定尝试实现使用这些技术生成组合和排列的方法。我完成了从*n 选择 k*组合转换为 CSN 等级的方法，反之亦然，但我正试图用*n 选择 k*（唯一）排列做同样的事情。

感谢[@Joshua](https://stackoverflow.com/questions/4120743/how-to-generate-a-permutation/4120772#4120772)，我得到了*unranking* (FNS to permutation) 方法：

```
function Pr_Unrank($n, $k, $rank) { // rank starts at 1
    if ($n >= $k) {
        if (($rank > 0) && ($rank <= Pr($n, $k))) {
            $rank--;
            $result = array();
            $factoriadic = array();

            for ($i = 1; $i <= ($n - $k); ++$i) {
                $rank *= $i;
            }

            for ($j = 1; $j <= $n; ++$j) {
                $factoriadic[$n - $j] = ($rank % $j) + 1; $rank /= $j;
            }

            for ($i = $n - 1; $i >= 0; --$i) {
                $result[$i] = $factoriadic[$i];

                for ($j = $i + 1; $j < $n; ++$j) {
                    if ($result[$j] >= $result[$i]) {
                        ++$result[$j];
                    }
                }
            }

            return array_reverse(array_slice($result, 0 - $k));
        }
    }

    return false;
} 
```

这是我目前对*排名*（排列为 FNS）方法的尝试：

```
function Pr_Rank($n, $k, $permutation) {
    if ($n >= $k) {
        $result = range(1, $n);
        $factoriadic = array();

        foreach ($permutation as $key => $value) {
            $factoriadic[$k - $key - 1] = array_search($value, $result);
            array_splice($result, $factoriadic[$k - $key - 1], 1);
        }

        $result = 1;

        foreach (array_filter($factoriadic) as $key => $value) {
            $result += F($key) * $value;
        }

        return $result;
    }

    return false;
} 
```

这些是我正在使用的辅助函数：

```
function F($n) { // Factorial
    return array_product(range($n, 1));
}

function Pr($n, $k) { // Permutations (without Repetitions)
    return array_product(range($n - $k + 1, $n));
} 
```

* * *

问题是，**该`Pr_Rank()``n = k`**方法仅在( [demo )](http://codepad.org/2Is9oM3a)**时返回正确的排名**：

```
var_dump(Pr_Rank(5, 2, Pr_Unrank(5, 2, 10))); // 3, should be 10
var_dump(Pr_Rank(5, 3, Pr_Unrank(5, 3, 10))); // 4, should be 10
var_dump(Pr_Rank(5, 5, Pr_Unrank(5, 5, 10))); // 10, it's correct 
```

我使用上面链接的维基百科文章和[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/aa302371.aspx)指导自己，我知道他们都不考虑 k 大小的子集，但我完全不知道这种逻辑会是什么样子......

我也尝试过谷歌搜索和搜索现有的问题/答案，但还没有出现任何相关的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-23T07:29:27.620

经过一夜好眠和笔和纸的一点帮助，我想通了。如果有人感兴趣：

* * *

例如，第**42*个 5 选择 3***排列是**`4-2-5`**，但是如果您查看调用的`Pr_Unrank()`位置`array_slice()`，您会注意到实际排列（按字典顺序）实际上是**`4-2-5[-1-3]`**，最后两个元素被丢弃，因此您最终只得到`k`元素。

这对于计算阶乘 ( ) 的十进制表示非常重要`3-1-2[-0-0]`：

*   `4-2-5`= `(2! * 3) + (1! * 1) + (0! * 2)`=`9`
*   `4-2-5-1-3`= `(4! * 3) + (3! * 1) + (2! * 2) + (1! * 0) + (0! * 0)`=**`82`**

仍然，`82`不是正确的答案。为了得到它，我们必须将它除以以下结果：

*   `Pr(5, 5) / Pr(5, 3)`(=) `(5 - 3)!`= `120 / 60`=**`2`**

所以，我需要做的就是添加`82 / 2`从1 开始的排名。`41``1`

* * *

```
Array // 5 choose 3 permutations
(
    [1] => 1-2-3
    [2] => 1-2-4
    [3] => 1-2-5
    [4] => 1-3-2
    [5] => 1-3-4
    [6] => 1-3-5
    [7] => 1-4-2
    [8] => 1-4-3
    [9] => 1-4-5
    [10] => 1-5-2
    [11] => 1-5-3
    [12] => 1-5-4
    [13] => 2-1-3
    [14] => 2-1-4
    [15] => 2-1-5
    [16] => 2-3-1
    [17] => 2-3-4
    [18] => 2-3-5
    [19] => 2-4-1
    [20] => 2-4-3
    [21] => 2-4-5
    [22] => 2-5-1
    [23] => 2-5-3
    [24] => 2-5-4
    [25] => 3-1-2
    [26] => 3-1-4
    [27] => 3-1-5
    [28] => 3-2-1
    [29] => 3-2-4
    [30] => 3-2-5
    [31] => 3-4-1
    [32] => 3-4-2
    [33] => 3-4-5
    [34] => 3-5-1
    [35] => 3-5-2
    [36] => 3-5-4
    [37] => 4-1-2
    [38] => 4-1-3
    [39] => 4-1-5
    [40] => 4-2-1
    [41] => 4-2-3
    [42] => 4-2-5
    [43] => 4-3-1
    [44] => 4-3-2
    [45] => 4-3-5
    [46] => 4-5-1
    [47] => 4-5-2
    [48] => 4-5-3
    [49] => 5-1-2
    [50] => 5-1-3
    [51] => 5-1-4
    [52] => 5-2-1
    [53] => 5-2-3
    [54] => 5-2-4
    [55] => 5-3-1
    [56] => 5-3-2
    [57] => 5-3-4
    [58] => 5-4-1
    [59] => 5-4-2
    [60] => 5-4-3
) 
```

# ms-access - 列出两个查询中产生相同列的所有行

> ID：11140507
> 
> 赞同：-1
> 
> 时间：2012-06-21T14:34:24.187
> 
> 标签：ms-access, export

我有两个查询产生相同的列但不同的行。第一个查看员工表并根据员工部门分配用户角色。然后第二个查看与雇员表连接的属性表。如果员工的 ID 列在 propertytable.SupervisingManager 列中，它会创建另一个用户，该用户已经从员工表中创建，分配的角色具有提升的权限。我正在将查询结果导出到 excel 中，它们将用于将用户导入新的管理软件。我可以只运行两个导出并将它们放在一个电子表格中，但我想让这个过程尽可能简单，以便将来可能的导出。我还应该提到我正在使用 MS Access 作为数据库。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:38:10.503

您可以使用联合查询来做到这一点

```
SELECT Field1, Field2, Field3 FROM source1
UNION ALL
SELECT Field1, Field2, Field3 FROM source2 
```

注意：如果您只写`UNION`而不是`UNION ALL`访问，则只返回`DISTINCT`行。

您可以添加任意数量的来源

```
SELECT Field1, Field2, Field3 FROM source1
UNION ALL
SELECT Field1, Field2, Field3 FROM source2
UNION ALL
SELECT Field1, Field2, Field3 FROM source3
UNION ALL
SELECT Field1, Field2, Field3 FROM source4 
```

# excel - 将两个单独的数据系列合并为一个具有不同 X 轴点的 Excel 图表

> ID：11140508
> 
> 赞同：2
> 
> 时间：2012-06-21T14:34:28.633
> 
> 标签：excel

我有两个要绘制的数据集，有些共享相同的 X 轴值，有些则没有。

**数据集 1**

```
X         Y
9:30:29   5
9:31:00   6
9:32:00   7 
```

**数据集 2**

```
X         Y
9:30:29   4
9:31:03   3
9:32:00   2
9:33:01   1 
```

我想在面积图中绘制数据集 1 和数据集 2，因此数据集 1 和 2 将共享 X 轴点`9:30:29`和`9:32:00`

我遇到的是当我绘制第二组图表时，它基本上覆盖了数据集 1 中相同 X 轴点上的 Y 数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T15:52:59.610

1.  确保使用 XY 散点图类型（不是线）。
2.  确保添加第二个系列的 X 值及其 Y 值。

# codeigniter - Codeigniter ion auth 密码问题

> ID：11140510
> 
> 赞同：4
> 
> 时间：2012-06-21T14:34:31.430
> 
> 标签：codeigniter, authentication, salt

我遇到了我无法真正解决的 ion auth 问题。

我使用 sha1 加密，salt 在配置中被关闭。

检查输入帖子是否发布了正确的输入，并且确实如此。

我输入密码 12345，应该是 8cb2237d0679ca88db6464eac60da96345513964 whit sha1 加密。

但是当它将它发送到数据库时，它每次都完全不同，就像它每次都会创建一个随机字符串

这是我的注册功能

```
// signup
function signup()
{
     loggedIn();

     $this->load->view('partials/header');

     $this->form_validation->set_rules('username', 'Username', 'required');
     $this->form_validation->set_rules('password', 'Password', 'required|min_length[4]');
     $this->form_validation->set_rules('repassword', 'Retype Your Password', 'required|min_length[4]|matches[password]');

     if($this->form_validation->run() !== FALSE)
     {
          $username = $this->input->post('username');
          $password = $this->input->post('password');
          $email = $this->input->post('email');
          $additional_data = array('name' => $this->input->post('name'));    

          $group = array('2');
          $this->ion_auth->register($username, $password, $email, $additional_data, $group);
     }

     $this->load->view('user/user_signup_view');
     $this->load->view('partials/footer');
} 
```

请有人给我一个提示吗？或者如果有人遇到类似的问题并得到解决，请提供一些帮助

编辑

配置文件

```
<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');

/*
| -------------------------------------------------------------------------
| Database Type
| -------------------------------------------------------------------------
| If set to TRUE, Ion Auth will use MongoDB as its database backend.
|
| If you use MongoDB there are two external dependencies that have to be 
| integrated with your project:
|   CodeIgniter MongoDB Active Record Library - http://github.com/alexbilbie/codeigniter-mongodb-library/tree/v2
|   CodeIgniter MongoDB Session Library - http://github.com/sepehr/ci-mongodb-session
*/
$config['use_mongodb'] = FALSE;

/*
| -------------------------------------------------------------------------
| MongoDB Collection.
| -------------------------------------------------------------------------
| Setup the mongodb docs using the following command: 
| $ mongorestore sql/mongo
|
| Ion Auth uses a simplified schema when using MongoDB as backend, here they are:
|
| groups: {
|   _id: GROUP_ID,
|   name,
|   description
| }
|
| login_attempts: {
|   _id: LOGIN_ATTEMPT_ID,
|   ip_address,
|   login,
|   time
| }
|
| users: {
|   _id: USER_ID,
|   ip_address,
|   username, (ensureIndex)
|   password,
|   salt,
|   email, (ensureIndex)
|   activation_code,
|   forgotten_password_code, (ensureIndex)
|   forgotten_password_time,
|   remember_code,
|   created_on, (ensureIndex)
|   last_login,
|   active, (ensureIndex)
|   first_name,
|   last_name,
|   company,
|   phone,
|   groups: [GROUP_ID_1, GROUP_ID_2, ...], (ensureIndex)
| }
|
*/
$config['collections']['users']          = 'users';
$config['collections']['groups']         = 'groups';
$config['collections']['login_attempts'] = 'login_attempts';

/*
| -------------------------------------------------------------------------
| Tables.
| -------------------------------------------------------------------------
| Database table names.
*/
$config['tables']['users']           = 'job_users';
$config['tables']['groups']          = 'job_groups';
$config['tables']['users_groups']    = 'job_users_groups';
$config['tables']['login_attempts']  = 'job_ogin_attempts';

/*
 | Users table column and Group table column you want to join WITH.
 |
 | Joins from users.id
 | Joins from groups.id
 */
$config['join']['users']  = 'user_id';
$config['join']['groups'] = 'group_id';

/*
 | -------------------------------------------------------------------------
 | Hash Method (sha1 or bcrypt)
 | -------------------------------------------------------------------------
 | Bcrypt is available in PHP 5.3+
 |
 | IMPORTANT: Based on the recommendation by many professionals, it is highly recommended to use
 | bcrypt instead of sha1.
 |
 | NOTE: If you use bcrypt you will need to increase your password column character limit to (80)
 |
 | Below there is "default_rounds" setting.  This defines how strong the encryption will be,
 | but remember the more rounds you set the longer it will take to hash (CPU usage) So adjust
 | this based on your server hardware.
 |
 | If you are using Bcrypt the Admin password field also needs to be changed in order login as admin:
 | $2a$07$SeBknntpZror9uyftVopmu61qg0ms8Qv1yV6FG.kQOSM.9QhmTo36
 |
 | Becareful how high you set max_rounds, I would do your own testing on how long it takes
 | to encrypt with x rounds.
 */
$config['hash_method']    = 'sha1'; // IMPORTANT: Make sure this is set to either sha1 or bcrypt
$config['default_rounds'] = 8;      // This does not apply if random_rounds is set to true
$config['random_rounds']  = FALSE;
$config['min_rounds']     = 5;
$config['max_rounds']     = 9;

/*
 | -------------------------------------------------------------------------
 | Authentication options.
 | -------------------------------------------------------------------------
 | maximum_login_attempts: This maximum is not enforced by the library, but is
 | used by $this->ion_auth->is_max_login_attempts_exceeded().
 | The controller should check this function and act
 | appropriately. If this variable set to 0, there is no maximum.
 */
$config['site_title']           = "Example.com";        // Site Title, example.com
$config['admin_email']          = "admin@example.com";  // Admin Email, admin@example.com
$config['default_group']        = 'members';            // Default group, use name
$config['admin_group']          = 'admin';              // Default administrators group, use name
$config['identity']             = 'email';              // A database column which is used to login with
$config['min_password_length']  = 7;                    // Minimum Required Length of Password
$config['max_password_length']  = 20;                   // Maximum Allowed Length of Password
$config['email_activation']     = FALSE;                // Email Activation for registration
$config['manual_activation']    = FALSE;                // Manual Activation for registration
$config['remember_users']       = TRUE;                 // Allow users to be remembered and enable auto-login
$config['user_expire']          = 86500;                // How long to remember the user (seconds)
$config['user_extend_on_login'] = FALSE;                // Extend the users cookies everytime they auto-login
$config['track_login_attempts'] = FALSE;                // Track the number of failed login attempts for each user or ip.
$config['maximum_login_attempts']     = 3;              // The maximum number of failed login attempts.
$config['forgot_password_expiration'] = 0;              // The number of seconds after which a forgot password request will expire. If set to 0, forgot password requests will not expire.

/*
 | -------------------------------------------------------------------------
 | Email options.
 | -------------------------------------------------------------------------
 | email_config:
 |    'file' = Use the default CI config or use from a config file
 |    array  = Manually set your email config settings
 */
$config['use_ci_email'] = FALSE; // Send Email using the builtin CI email class, if false it will return the code and the identity
$config['email_config'] = array(
    'mailtype' => 'html',
);

/*
 | -------------------------------------------------------------------------
 | Email templates.
 | -------------------------------------------------------------------------
 | Folder where email templates are stored.
 | Default: auth/
 */
$config['email_templates'] = 'auth/email/';

/*
 | -------------------------------------------------------------------------
 | Activate Account Email Template
 | -------------------------------------------------------------------------
 | Default: activate.tpl.php
 */
$config['email_activate'] = 'activate.tpl.php';

/*
 | -------------------------------------------------------------------------
 | Forgot Password Email Template
 | -------------------------------------------------------------------------
 | Default: forgot_password.tpl.php
 */
$config['email_forgot_password'] = 'forgot_password.tpl.php';

/*
 | -------------------------------------------------------------------------
 | Forgot Password Complete Email Template
 | -------------------------------------------------------------------------
 | Default: new_password.tpl.php
 */
$config['email_forgot_password_complete'] = 'new_password.tpl.php';

/*
 | -------------------------------------------------------------------------
 | Salt options
 | -------------------------------------------------------------------------
 | salt_length Default: 10
 |
 | store_salt: Should the salt be stored in the database?
 | This will change your password encryption algorithm,
 | default password, 'password', changes to
 | fbaa5e216d163a02ae630ab1a43372635dd374c0 with default salt.
 */
$config['salt_length'] = 10;
$config['store_salt']  = FALSE;

/*
 | -------------------------------------------------------------------------
 | Message Delimiters.
 | -------------------------------------------------------------------------
 */
$config['message_start_delimiter'] = '<p>';     // Message start delimiter
$config['message_end_delimiter']   = '</p>';    // Message end delimiter
$config['error_start_delimiter']   = '<p>';     // Error mesage start delimiter
$config['error_end_delimiter']     = '</p>';    // Error mesage end delimiter

/* End of file ion_auth.php */
/* Location: ./application/config/ion_auth.php */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:54:44.693

ion_auth 确实使用盐及其随机..

查看配置：

> 'salt_length' - 加密盐的长度。默认为“10”。
> 
> 'store_salt' - 真或假。是否将盐存储在单独的数据库列中。这对于与现有应用程序集成很有用。默认为“假”。

## 您应该创建一个控制器来创建用户。

```
<?php

function register(){
  //$this->ion_auth->register($username, $password, $email, $additional_data, $group)
    $this->ion_auth->register('robert', '123456', 'robert@robert.com', array( 'first_name' => 'Robert', 'last_name' => 'Roberts' ), array('1') );
} 
```

## 编辑

刚刚注意到你正在这样做。我的印象是你试图手动将用户添加到表中。

几个问题

*   什么是`loggedIn();`
*   您是否使用提供的 sql 文件为 ion_auth 导入/创建表和数据
*   你的配置是什么样的？
*   不需要组 id #2，因为注册的用户**总是**被分配到组 2

您定义`$additional_data`不正确，因为有`first_name`, `last_name`,`phone`字段而没有`name`字段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-22T08:25:36.213

首先感谢迈克的帮助。

我设法做到了，我觉得有点愚蠢。

问题在于身份。我用名字而不是电子邮件检查身份。

现在它就像一个魅力。

再次感谢迈克

# php - 在 CREATE TABLE 语句中转义 SQL 数据类型

> ID：11140512
> 
> 赞同：2
> 
> 时间：2012-06-21T14:34:39.960
> 
> 标签：php, mysql, security

**快速背景**：我们正在为我们的 Web 应用程序创建一个表单生成器。构建器的目标是允许我们的管理员在我们的页面上快速添加/修改表单。为了确保这些表单收集的数据可以轻松搜索到报告，我们决定让应用程序为每个包含用户输入数据的表单创建一个表。

考虑到安全性，我们所有的表名和列名都被正确地转义并用正确的引号括起来（MySQL 的后引号 `）。但是，我不知道 CREATE 语句中的数据类型有任何转义或引用。我们希望允许不同的数据类型来解释更好的索引和搜索，这意味着它们是在创建/修改表单时动态决定的。

**我们正在采取的当前路线**是将我们支持的可能数据类型列入白名单，并强制任何可选的大小输入为数字。这样，任何恶意代码都无法创建 BLOB 列，并传入大小为“128); DROP DATABASE;”的 VARCHAR 将变成 128 或 0（我现在忘记了 PHP 如何处理字符串到数字的转换）。

**我想得到一些反馈，你认为这是足够的保护吗？是否有某种方法可以编写可以保护我们的 SQL，类似于将表名括在适当的引号中？**

**另外，有没有人知道数据类型大小有什么危险？**我预计占用大量空间可能会出现问题，但安全性却没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:02:22.653

这一切对我来说似乎都很好，只是不要忘记 DECIMAL 类型需要两个输入，即比例和精度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:11:35.190

我看到您正在使用 PHP，为什么不**使用**净化过滤器净化您的用户输入并按照您的方式做所有其他事情！让我们知道这是否适合您？您正在寻找的 PHP 函数是`FILTER_SANITIZE_STRING`或其他类似的函数。你可以在这里浏览那些[http://php.net/manual/en/filter.filters.sanitize.php](http://php.net/manual/en/filter.filters.sanitize.php)

# c# - 单选按钮更改的值不会更新隐藏字段？

> ID：11140515
> 
> 赞同：3
> 
> 时间：2012-06-21T14:35:00.667
> 
> 标签：c#, javascript, asp.net

我在 asp.net gridview 中有一个隐藏字段，如下所示：

```
 <asp:TemplateField>
      <ItemTemplate>
          <input type="hidden" value="0" id="hdnIsChanged" runat="server" />
      </ItemTemplate>
 </asp:TemplateField> 
```

使用隐藏字段，以便如果我的 gridview 上的另一个字段被更改，我可以使用值 1 更新这个隐藏字段的值。这样，当我单击“保存”按钮时，我可以循环遍历我的 gridview 的行，并且只有当且仅当 hiddenField.Value =“1”时才调用我的数据库更新例程。

`rowdatabound`我在gridview的事件中轻松设置了这个字段，对于一个文本框来说是这样的：

```
 HtmlInputHidden hiddenField = (HtmlInputHidden)e.Row.FindControl("hdnIsChanged"); //get handle on hidden row isDirty
    TextBox notes = (TextBox)e.Row.FindControl("txtNotes"); //get notes

//assign onchange / onclick event handlers when something is changed set hidden field to 1
    notes.Attributes.Add("onchange", "document.getElementById('" + hiddenField.ClientID + "').value=1"); 
```

这适用于文本框和下拉菜单，但我的网格中也有一个单选按钮列表。例如，当我通过选择单选按钮更改网格视图中的 3 行时，它总是只更新 1。似乎隐藏字段没有正确设置。我以为我可以像这样正确设置它：

```
RadioButtonList rbl = (RadioButtonList)e.Row.FindControl("rbAnswer"); //get answer

                //assign onchange / onclick event handlers when something is changed set hidden field to 1
                  foreach(ListItem li in rbl.Items)
                    li.Attributes.Add("onclick", "document.getElementById('" + hiddenField.ClientID + "').value=1"); 
```

这似乎不起作用，并考虑每个单选按钮的点击次数。正如我所说，如果我通过单击每行中的单选按钮更新三行，然后单击我的保存按钮，它只会调用一次更新例程。似乎隐藏字段没有得到值 1。

任何人都可以帮忙吗？

## 编辑

以防万一这是我的整个网格视图控件：

```
<asp:UpdatePanel ID="myPanel" runat="server" UpdateMode="Always" >
                     <ContentTemplate>
                    <asp:GridView ID="gvLineItems" runat="server" AllowSorting="True" 
                        AlternatingRowStyle-BackColor="#e5f1fa" AutoGenerateColumns="False" 
                        BackColor="#E8E8E8" CellPadding="4" DataKeyNames="ID" Font-Size="Small" 
                        GridLines="Horizontal" HeaderStyle-BackColor="#4B6C9E" 
                        HeaderStyle-ForeColor="White" ShowFooter="True" Width="700px" 
                             onrowdatabound="gvLineItems_RowDataBound" 
                             onrowcreated="gvLineItems_RowCreated">
                        <AlternatingRowStyle BackColor="#E5F1FA" />
                        <Columns>
                            <asp:TemplateField>
                                 <ItemTemplate>
                                      <input type="hidden" value="0" id="hdnIsChanged" runat="server" />
                                 </ItemTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField>
                                <HeaderTemplate>
                                    <asp:CheckBox ID="HeaderLevelCheckBox" runat="server" 
                                        onclick="toggleSelection(this);" ToolTip="Select / Deselect all rows?" />
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <asp:CheckBox ID="chkSelector" runat="server" onclick="ChangeRowColor(this)" 
                                        ToolTip="Select row?" />
                                </ItemTemplate>
                                <ItemStyle HorizontalAlign="Center" Width="1%" />
                                <HeaderStyle HorizontalAlign="Center" />
                            </asp:TemplateField>

                            <asp:TemplateField Visible="False">
                                <ItemTemplate>
                                    <asp:Label ID="lblID" runat="server" style="display:none" 
                                        Text='<%# DataBinder.Eval(Container, "DataItem.ID") %>' Width=".05px"></asp:Label>
                                </ItemTemplate>
                                <ItemStyle Width="1%" />
                                <ControlStyle Width="0px" />
                                <HeaderStyle Width="0px" />
                            </asp:TemplateField>

                              <asp:TemplateField HeaderText="#">
                                <ItemTemplate>
                                    <asp:Label ID="lblSortOrder" runat="server" 
                                        Text='<%# DataBinder.Eval(Container, "DataItem.SortOrder") %>'></asp:Label>
                                </ItemTemplate>
                                 <FooterStyle HorizontalAlign="Center" />
                                 <HeaderStyle HorizontalAlign="Center" />
                                 <ItemStyle HorizontalAlign="Center" />
                            </asp:TemplateField>

                             <asp:TemplateField HeaderText="Validation">
                                <ItemTemplate>
                                    <asp:Label ID="lblValidationItem" runat="server" ToolTip="Type of validation."
                                        Text='<%# DataBinder.Eval(Container, "DataItem.ValidationItem") %>'></asp:Label>
                                </ItemTemplate>
                                 <FooterStyle HorizontalAlign="Center" />
                                 <HeaderStyle HorizontalAlign="Center" />
                                 <ItemStyle HorizontalAlign="Center" />
                            </asp:TemplateField>

                            <asp:TemplateField HeaderText="Test">
                                <ItemTemplate>
                                    <asp:Label ID="lblTest" runat="server" ToolTip="Type of test."
                                        Text='<%# DataBinder.Eval(Container, "DataItem.Test") %>'></asp:Label>
                                </ItemTemplate>
                                <FooterStyle HorizontalAlign="Center" />
                                <HeaderStyle HorizontalAlign="Center" />
                                <ItemStyle HorizontalAlign="Center" />
                            </asp:TemplateField>

                            <asp:TemplateField HeaderText="Method">
                                <ItemTemplate>
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td> <asp:Label ID="lblMethod" Font-Bold="true" runat="server" ToolTip="Method / Question"
                                        Text='<%# DataBinder.Eval(Container, "DataItem.Method") %>'></asp:Label></td>
                                            </tr>
                                            <tr>
                                            <td>
                                             <asp:Label ID="lblMethodNotes" CssClass="tiny" runat="server" ToolTip="Specifications / Notes"
                                        Text='<%# DataBinder.Eval(Container, "DataItem.MethodNotes") %>'></asp:Label>
                                            </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </ItemTemplate>
                                <ControlStyle Width="250px" />
                                <FooterStyle HorizontalAlign="Left" />
                                <HeaderStyle HorizontalAlign="Left" Width="250px" />
                                <ItemStyle HorizontalAlign="Left" Width="250px" Wrap="True" />
                            </asp:TemplateField>

                            <asp:TemplateField HeaderText="Answer">
                            <ItemTemplate>
                               <div id="dMainAnswer">
                                <asp:RadioButtonList ToolTip="Please provide an answer to the method." AutoPostBack="true" RepeatDirection="Horizontal" ID="rbAnswer" runat="server" SelectedValue='<%# DataBinder.Eval(Container, "DataItem.AnswerID")%>' OnSelectedIndexChanged="rbAnswer_SelectedIndexChanged">
                                    <asp:ListItem Text="Yes" Value="Yes" style="color:green;"></asp:ListItem>
                                    <asp:ListItem Text="No" Value="No" style="color:red;"></asp:ListItem>
                                    <asp:ListItem Text="N/A" Value="N/A"></asp:ListItem>
                                    <asp:ListItem Value="" Text="" style="display: none" />
                                </asp:RadioButtonList>
                                   <asp:Panel ID="pnlAnswer" runat="server" Visible="false">
                                       <div id="dMainAnswerResponsibleType">
                                            <asp:RadioButtonList ID="rbRespType" ToolTip="Select responsible contact type." runat="server" RepeatDirection="Horizontal" AutoPostBack="true" SelectedValue='<%# DataBinder.Eval(Container, "DataItem.ResponsiblePartyType")%>' OnSelectedIndexChanged="rbRespType_SelectedIndexChanged">
                                                <asp:ListItem Selected="True" Text="SE" Value="SE">SE</asp:ListItem>
                                                <asp:ListItem Text="Other" Value="Other">Other</asp:ListItem>
                                                <asp:ListItem Value="" Text="" style="display: none" />
                                            </asp:RadioButtonList>
                                        </div>
                                        <div id="dMainAnswerResponsible">
                                             <asp:DropDownList ID="ddlEmployees" runat="server" 
                                                DataSource="<%# GetEmployees() %>" SelectedValue='<%# Eval("SEContact") %>' DataTextField="FullName" Width="75px"
                                                DataValueField="FullName" 
                                                ToolTip="Select the SE responsible party.">
                                            </asp:DropDownList>
                                            <asp:TextBox ID="txtContact" Text='<%# Eval("ResponsiblePartyContact") %>' Width="75px" MaxLength="50" runat="server" ToolTip="Enter the responsible contact name." Visible="false"></asp:TextBox>
                                        </div>
                                   </asp:Panel>
                               </div>
                            </ItemTemplate>
                            </asp:TemplateField>
                            <asp:TemplateField HeaderText="Notes">
                            <ItemTemplate>
                               <asp:TextBox MaxLength="5000" runat="server" ToolTip="Enter any additional notes." ID="txtNotes" TextMode="MultiLine" Text='<%# DataBinder.Eval(Container, "DataItem.Notes") %>'></asp:TextBox>
                            </ItemTemplate>
                                <ControlStyle Font-Names="Arial" />
                                <FooterStyle HorizontalAlign="Left" />
                                <HeaderStyle HorizontalAlign="Left" />
                                <ItemStyle HorizontalAlign="Left" />
                            </asp:TemplateField>
                        </Columns>
                        <HeaderStyle BackColor="#4B6C9E" ForeColor="White" />
                    </asp:GridView>

                  <div style="width:100%;text-align:center;">
                    <asp:Label ID="lblLineItemMessage" runat="server"></asp:Label>
                    <asp:UpdateProgress AssociatedUpdatePanelID="myPanel" DisplayAfter="1" ID="udProgress" runat="server" Visible="True" DynamicLayout="True">
                        <ProgressTemplate>
                            <img style="border-style:none;" src="images/ajax-loader.gif" alt="loading" />
                        </ProgressTemplate>
                    </asp:UpdateProgress>
                </div>
                </ContentTemplate>
                <Triggers>
                    <asp:AsyncPostBackTrigger ControlID="ddlTypes" />
                    <asp:AsyncPostBackTrigger ControlID="ddlValidations" />
                    <asp:AsyncPostBackTrigger ControlID="ddlTests" />
                    <asp:AsyncPostBackTrigger ControlID="ddlJobs" />
                    <asp:AsyncPostBackTrigger ControlID="rbMethod" />
                    <asp:AsyncPostBackTrigger ControlID="TreeView1" />
                </Triggers>
                </asp:UpdatePanel> 
```

我什至尝试了一些 jquery 来获得警报：

```
 $(function () {
            $("#<%=gvLineItems.ClientID %> input[type=radio]").click(function () {
                alert("hi");
            });
        }); 
```

但我认为这是不对的，因为当我单击单选按钮时，我没有看到任何警报。`hdnIsChanged`当单击单选按钮列表中的单选按钮项时，我还需要使用值 1 更新隐藏字段的字段`rbAnswer`。我可以在 jquery 中执行此操作，但可以使用一些帮助。hiddenfield hdnIsChanged 和radiobuttonlist rbAnswer 都在asp.net gridview 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T13:32:58.587

由于通过浏览器中的谷歌开发人员工具进行调试，我终于得到了它。我最初在我的页面（右键单击检查元素）上注意到每行的单选按钮列表中的每个单选按钮都有一个“onclick”属性..到目前为止很好。

在我单击单选按钮的那一刻，我的单选按钮列表为“AutoPostBack=true”，在我单击它的那一刻，唯一具有 onclick 属性的项目是我单击的行。每隔一行，该属性就消失了。

简单的解决方案是在`selectedindexchanged`单选按钮列表事件中循环遍历gridview 中的每一行并读取属性。

```
 foreach (GridViewRow row in gvLineItems.Rows)
            {
               HtmlInputHidden hiddenField = (HtmlInputHidden)row.FindControl("hdnIsChanged");
               RadioButtonList rbl2 = (RadioButtonList)row.FindControl("rbAnswer");

              foreach (ListItem li in rbl2.Items)
               {
                   li.Attributes.Add("onclick", "document.getElementById('" + hiddenField.ClientID + "').value=1");
               }
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:02:43.277

你考虑过使用 jQuery 吗？

```
<asp:GridView ID="grdViewLines" runat="server" CssClass="dirty-tracking-grid">
<Columns>
    <asp:TemplateField>
        <ItemTemplate>
            <input type="hidden" value="0" runat="server" row-id='<%# DataBinder.Eval(Container, "DataItem") %>'  />
        </ItemTemplate>
        <ItemTemplate>
            <asp:RadioButtonList runat="server" row-id='<%# DataBinder.Eval(Container, "DataItem") %>' CssClass="dirty-tracking">
                <asp:ListItem runat="server" Text="Item1"></asp:ListItem>
                <asp:ListItem runat="server" Text="Item2"></asp:ListItem>
            </asp:RadioButtonList>                    
        </ItemTemplate>
    </asp:TemplateField>
    <asp:TemplateField></asp:TemplateField>
</Columns> 
```

```
<script type="text/javascript">
$(function () {
    $(".dirty-tracking :radio").click(function () {
        var rowId = $(this).closest("table").attr("row-id");
        $(".dirty-tracking-grid input[type=hidden,row-id=" + rowId).val(1);
    });
}); 
```

# sql - 两个表中的行子集之间的重叠/交叉

> ID：11140519
> 
> 赞同：1
> 
> 时间：2012-06-21T14:35:20.183
> 
> 标签：sql, sql-server, tsql

我在 Sql Server 中有两个表，一个包含文件的 ID 和这些原始文件中包含的幻灯片，另一个用于“部分”，可以包含来自一个或多个文件的幻灯片，可能以任意顺序、重复和/或消除了一些幻灯片。

示例数据如下所示：

`FileSlide`

```
FileID       SlideID
214          716
214          717
214          718
223          770
223          771
223          772
223          773
223          774
223          775 
```

`SectionSlide`

```
SectionID    SlideID
527          716
527          718
527          717
527          770
527          773
527          774
527          775
527          774 
```

我最初不需要“SectionFile”关系，但现在我确实需要该信息来查看为特定部分选择了哪些文件，而不管幻灯片详细信息如何。我的问题是检查`SectionSlide`和`FileSlide`表之间的幻灯片 ID，以查看任何给定文件节对中的幻灯片之间是否存在重叠。我想找到所有共享幻灯片的文件-节对。

对于上面的示例数据，输出将如下所示：

`SectionFileCandidates`

```
SectionID    FileID
527          214
527          223 
```

产生此输出的查询是什么？

是否可以计算一个指标来指示该部分中存在原始文件幻灯片的比例？

对于上面的示例数据，输出将如下所示：

`SectionFileCandidates`

```
SectionID    FileID    Overlap
527          214       1.00
527          223       0.67 
```

...也就是说，文件 214 中的 3 张幻灯片中有 3 张在第 527 节中，而文件 223 中的 6 张幻灯片中有 4 张在第 527 节中。

我最初试图使用该`OVER (PARTITION BY ...)`子句比较行组，但无法弄清楚。

我该如何做这两个查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:41:53.407

**两种查询都可以！**

* * *

第一个查询：

```
SELECT s.SectionID,
       f.FileID
FROM SectionSlide s
INNER JOIN FileSlide f ON s.SlideID = f.SlideID
GROUP BY s.SectionID, f.FileID 
```

或者

```
SELECT DISTINCT s.SectionID,
                f.FileID
FROM SectionSlide s
INNER JOIN FileSlide f ON s.SlideID = f.SlideID 
```

* * *

第二个查询：

```
select s.SectionID, f.FileID,
       round(((count(distinct f.SlideID)*1.0) / aux.total), 2) as 'Overlap'
from SectionSlide s
inner join FileSlide f on f.SlideID = s.SlideID
inner join (select f.FileID, count(f.SlideID) as 'total'
            from FileSlide f
            group by f.FileID) aux on aux.FileID = f.FileID
group by f.FileID, s.SectionID, aux.total 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:44:28.327

我对您的问题感到有些困惑，但是下面的查询应该可以为您提供所需的结果：

```
SELECT DISTINCT fs.FileId, ss.SectionId
FROM FileSlide fs
INNER JOIN SectionSlide ss
ON fs.SlideId= ss.SlideId 
```

# java - 一个蓝牙设备可以连接多少个其他设备？

> ID：11140523
> 
> 赞同：0
> 
> 时间：2012-06-21T14:35:42.580
> 
> 标签：java, networking, bluetooth, connection, bluecove

我的意思是在不终止活动连接的情况下，它可以同时或一台一台地与多少台设备通信？

具体来说，我会说 bluecove 实施

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:55:51.080

使用谷歌我发现[https://groups.google.com/forum/?fromgroups#!topic/bluecove-users/iPRwEDGZ2pM](https://groups.google.com/forum/?fromgroups#!topic/bluecove-users/iPRwEDGZ2pM)

dennis mathews 已经在 Stack 上发布了答案，地址为[https://stackoverflow.com/a/6309835/1214163](https://stackoverflow.com/a/6309835/1214163)

# c++ - Visual Studio - 在停止调试时终止特定进程 (Shift+F5)

> ID：11140525
> 
> 赞同：5
> 
> 时间：2012-06-21T14:35:45.127
> 
> 标签：c++, visual-studio-2010, debugging

我有一个项目在启动时启动了一些进程。这些进程在适当的析构函数中停止和销毁（或单击按钮），一切都很好。调试时出现我的问题。当然，在调试时，我不会总是“正确”关闭我的应用程序；大多数时候，我会在 Visual Studio (Shift+F5) 中单击“停止调试”按钮，否则事情就会崩溃。在这些情况下，我必须手动关闭进程:(

只是想知道VS2010 Pro中是否有一个选项。这将允许我在停止调试时终止创建的进程。我正在考虑为此编写一个宏可能会起作用，但是 VS2010 是否为此提供了内置功能？有点像自定义构建步骤，但用于调试！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:38:16.847

我会从沉默中得知没有这样的功能。所以这里是它的宏：

```
Sub StopDebugAndKillProcesses()
    Dim dbg As EnvDTE80.Debugger2 = DTE.Debugger
    dbg.Stop()
    Dim shell_string As String
    shell_string = "taskkill /F /IM TheProcessToKill.exe"
    Shell(shell_string)
End Sub 
```

将它分配给一个按钮，把它放在原来的“停止”按钮旁边，你就完成了。

# android - Android：在 ICS 中，如何将 ActionBarItem 从 ActionBar 移动到选项菜单？

> ID：11140530
> 
> 赞同：0
> 
> 时间：2012-06-21T14:36:03.603
> 
> 标签：android

我希望能够根据我的应用程序的上下文将 ActionBarItem 从 ActionBar 移动到选项菜单。

下面的 Activity 有 2 个菜单项。1 在 ActionBar 中设置为 ALWAYS_SHOW，另一个在 ActionBar 中设置为 NEVER show。Activity 的布局包含一个按钮。单击此按钮时，ActionBar 按钮应移动到选项菜单（如果它显示在 ActionBar 中）或应该移动到 ActionBar（如果它在选项菜单中）。

此活动在 Honeycomb 上按预期工作。但是，调用 MenuItem.setShowAsAction 方法在 ICS 中无效。MenuItem.setVisible 确实隐藏/显示 ICS 中的 ActionBar 项目，但它不会导致项目被移动到选项菜单。任何想法如何在 ICS 中进行这项工作？

```
public class TempProjActivity extends Activity implements OnClickListener
{
    Button hideButton;
    MenuItem actionbarButton;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        hideButton = (Button) findViewById(R.id.showhidebutton);
        hideButton.setOnClickListener(this);

    }

    boolean visible = true;
    @Override
    public void onClick(View v)
    {
        if(visible)
        {
            actionbarButton.setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
            visible = false;
        }
        else
        {
            actionbarButton.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
            visible = true;
        }

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.optionsmenu, menu);

        actionbarButton = menu.findItem(R.id.actionbarbutton);

        return super.onCreateOptionsMenu(menu);
    }
}

<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/actionbarbutton"
          android:icon="@drawable/ic_launcher"
          android:text="@string/button"
          android:showAsAction="always"/>
       <item 
           android:text="@string/extra"
          android:showAsAction="never"/>
</menu>

<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#FFFFFFFF"
    android:orientation="horizontal" >
    <Button android:id="@+id/showhidebutton" 
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"/>
</FrameLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:27:59.617

好的，我想通了。`actionbarButton`有 2 个问题：在 ICS 上，当我调用 setShowAsAction 时未触发 onCreateOptionsMenu，并且下次调用 onCreateOptionsMenu 时不会保留我设置的 showAsAction 值。问题通过`invalidateOptionsMenu`在调用后添加`setShowAsAction`解决，第二个问题通过菜单膨胀后重新设置showAsAction值解决。

```
public class TempProjActivity extends Activity implements OnClickListener
{
    Button hideButton;
    MenuItem actionbarButton;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        hideButton = (Button) findViewById(R.id.showhidebutton);
        hideButton.setOnClickListener(this);

    }

    boolean visible = true;
    @Override
    public void onClick(View v)
    {
        if(visible)
        {
            visible = false;
            invalidateOptionsMenu();
        }
        else
        {
            visible = true;
            invalidateOptionsMenu();
        }

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.optionsmenu, menu);

        actionbarButton = menu.findItem(R.id.actionbarbutton);

        if(visible)
        {
            actionbarButton.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
        }
        else
        {
            actionbarButton.setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
        }

        return super.onCreateOptionsMenu(menu);
    }
} 
```

# sql - Use table variable in control and data flow

> ID：11140531
> 
> 赞同：2
> 
> 时间：2012-06-21T14:36:12.400
> 
> 标签：sql, sql-server, ssis

Assume the following scenario:

All data are in Sql Server tables.

1) An Execute SQL Task to determine if there are records to process by running a select against Table1.

2) If there are, an Execute SQL Task to truncate Table2.

3) A Data-flow task to Load Table2 with the results from the select against Table1.

Now, I can do that easily in a stored procedure, but am required to do it in SSIS.

So far, in the control flow, I've run my select and stored the results in a table variable, lets call it @ResultSet, and just for good measure, I have also created an object-type variable, let's call it MyResults also holding the resultset.

To avoid truncation of Table2 if @ResultSet is empty, I then count the number of records in @ResultSet and raise an error if the count is zero, effectively aborting the package.

Normally this is not the case, and instead of starting my Data-flow by running the same query against Table1 all over again, I would now like to access either my @ResultSet or my MyResults object like any other data source.

The latter should be possible using a scripting task, but I really, really don't want to go down that road.

Whether I can use my @ResultSet or come up with an entirely different approach due to your input, that is the question.

TIA.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:52:10.387

我相信您的问题与这个问题直接相关：[SSIS 在控制流任务之间传递数据源](https://stackoverflow.com/questions/7571899/ssis-pass-datasource-between-control-flow-tasks) 您确实可以将数据从一个数据流传递到数据集中的另一个数据流，或者通过原始文件。不过，您可以自行检查哪种情况更好

# authentication - Symfony2 : Custom authentication

> ID：11140532
> 
> 赞同：0
> 
> 时间：2012-06-21T14:36:13.783
> 
> 标签：authentication, symfony, single-sign-on

I'm trying to make a custom authentication using Symfony2\. The users are already authenticated thanks to a cookie, let's call it BASECOOKIE, on a specific domain, let's say basedomain.com

There's an application on basedomain.com that can handle authentication request and return true or false, checking wheter the user has a valid BASECOOKIE or not.

In order to do that, my Symfony2 application (which is located on another domain) needs to send that request using some auto-post form (so that the request is sent from the user and not from the app).

Do you have any idea of how I could implement that kind of authentication mecanism ? Cause I easily make basic database authentications, but when it comes to a specific one like this, I don't even know where to start.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T11:11:34.860

我实际上用自定义身份验证和用户提供程序实现了类似的东西：

*   [如何创建自定义身份验证提供程序](http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html)
*   [如何创建自定义用户提供程序](http://symfony.com/doc/current/cookbook/security/custom_provider.html)

# hibernate - Hibernate merge two critera queries into a single query

> ID：11140533
> 
> 赞同：0
> 
> 时间：2012-06-21T14:36:16.903
> 
> 标签：hibernate, hibernate-criteria

I have the following two queries, both which query the same table. One query I need all the results and the second I need a subset of results. In the end I need two list. Is there a way to share the first query with the second query.

```
 Criteria criteriaPrStatic = this.session.createCriteria(PurchaseRequest.class).add(Restrictions.eq("inactive", false));
    //Would like to use first query again and add the restrictions without having to query the table twice. 
    Criteria criteriaPrDynamic = this.session.createCriteria(PurchaseRequest.class).add(Restrictions.eq("inactive", false));
            criteriaPrDynamic.add(Restrictions.or(
                Restrictions.eq("creator", userInfo.getUser()),
                Restrictions.eq("authorizer", userInfo.getUser())
            ));

    ProjectionList projectionList = Projections.projectionList();
    projectionList.add(Projections.groupProperty("currentState"));
    projectionList.add(Projections.rowCount());

    criteriaPrStatic.setProjection(projectionList);
    criteriaPrDynamic.setProjection(projectionList); 
```

# mysql - Mysql Replication not working with Wordpress XMLRPC

> ID：11140535
> 
> 赞同：1
> 
> 时间：2012-06-21T14:36:22.900
> 
> 标签：mysql, wordpress, replication, xml-rpc

I have wordpress site using 3 mysql replication. Master-master replication and 1 slave. Now have problem with the slave. When Master update posting from XMLRPC, the slave is not getting update too. This is happen a few days ago, before that is working fine and beside that at other server that using Master-Master replication is working fine too.

I can't find any error message as If I create new post or update it not from XMLRPC, the replication in slave is working fine.

I don't know what happen before got this problem but as long as I know, the last thing that I did was update wordpress to version 3.4\. But if this the cause why at master-master replication still working fine as all site using version 3.4 too?

By the way, I saw at master there were a lot of transfer data from slave, compare from other slave server that using master/slave. About 288MB incoming data from slave.

```
2136K  288M ACCEPT     tcp  --  *      *       xx.14.xx.107       0.0.0.0/0           tcp dpt:3306
272K   14M ACCEPT     tcp  --  *      *       xx.18.xx.36         0.0.0.0/0           tcp dpt:3306 
```

* * *

edit:

I just solve my own problem :D

My configuration are 3 server. A and B are master-master replication and C is slave-master with A. My problem is because from XMLRPC server (D) resolve my domain to server B when create/update posting (I'm using single domain) so It's seem can't update slave C if is not from A. I'm forget that I was moving to new server D too.

I don't know if it's normal that Slave C only can be updated from A if using XMLRPC but at least solve my problem. :D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T14:29:32.027

查看您的“解决方案”，我可以告诉您您的复制有问题

如果 A 和 B 是真正的主-主，则对 B 的写入将复制到 A。如果 C 是 A 的从属，则对 A 的*所有*写入也会复制到 C。

我怀疑你在 mysql 中的服务器“server-id”设置是错误的。IE C 和 B 具有相同的服务器 ID。

*可能*是您的 auto_increment_increment 未设置为 2（2 个写入主机所需的最小值），或者您的 auto_increment_offset 在每个写入主机上都没有不同。我怀疑如果是其中任何一个，您的复制将在您写入两台服务器时被破坏，并且您已经看到了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T16:12:15.597

在这种情况下，您需要将 log-slave-updates 添加到 A。默认情况下，MySQL 复制不会将它从主服务器接收到的任何语句记录到复制日志中。每当您使用菊花链复制时，您需要确保服务器记录这些内容，以便将它们发送到它的从属服务器。

[http://dev.mysql.com/doc/refman/5.0/en/replication-options-slave.html#option_mysqld_log-slave-updates](http://dev.mysql.com/doc/refman/5.0/en/replication-options-slave.html#option_mysqld_log-slave-updates)

# licensing - If I link a LGPL codebase with GPL code is my codebase now all GPL?

> ID：11140538
> 
> 赞同：0
> 
> 时间：2012-06-21T14:36:41.050
> 
> 标签：licensing, gpl, lgpl

I am working on an open source project that is currently licensed under the LPGL. We are thinking of the possibility of linking to a GPL codebase for some of the lower level stuff we are doing.

If we linked against the GPL, our codebase has to be released as GPL right? Is there any way around this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:43:57.273

是的，你说得对，现在整个事情都是 GPL。解决这个问题的唯一诚实方法是

1.  不使用图书馆
2.  与每个版权所有者协商不同的许可

但是，有一个（法律上可疑的）选项。您围绕库创建一个包装器。包装器将是 GPL。但是，包装器会公开用于通信的库函数（例如，REST 接口、Web 服务、管道通信、作为可执行文件等）。

正如我所说，这在法律上有点可疑，因为我认为这不是一个已解决的问题，究竟什么算作“链接”，什么算作进程通信......

这也是一个法律理论，即在运行时动态链接，而不是在编译时静态链接，不会创建衍生作品。这也不是一成不变的事情。

在实践中，您的意图（围绕 GPL 的规定工作）很可能会针对您提起诉讼。

# html - Trouble with dreamweaver templates and libraries

> ID：11140539
> 
> 赞同：0
> 
> 时间：2012-06-21T14:36:45.440
> 
> 标签：html, css, dreamweaver

I'm currently in the process of redesigning a website, and I'm using Dreamweaver templates and libraries to maintain a consistent look on each page.

I've gotten to the point where I'm almost finished with the site, and wanting feedback from other people. A way to do this is copy the site over to another drive that is accessible to others in the company I'm working in. The problem is, I copied (ctrl + a) & (ctrl + c) and pasted all files into another folder (on another drive)... and when I go to edit the template and library files in Dreamweaver, they do not update their child-pages. The change is just saved to the .dwt file.

I went back into my other drive (that I had initially made the website in), and updated something on the template page, and a thing pops up and goes through the process of updating each of the child pages. This is what I want in the other drive.

Does anyone have any idea what is going on with copying the files to another drive, that makes it not update?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:51:08.003

您可以从修改 > 模板 > 更新页面手动启动更新对话框。

如果这不能识别您更新的页面有子页面，那么由于文件的路径，这可能是一个问题。如果是这种情况，我建议您在 Dreamweaver 中将其作为新的“站点”进行管理，但要这样做，我会将管理对话框中的原始文件导出到 .ste 文件，然后将其重新导入 DW

你用的是哪个版本的 DW？我可以在我的站点内设置站点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-13T22:38:07.350

我有这个问题，但我解决了，问题出在路径上，如果你看一下 #begininglibraryitem "/your path.. 你会看到错误的路径，但它应该以 "/your 网站名称或文件夹名称开头/图书馆/...

只需 ctrl+f 并找到替换整个网站。“匹配案例”选项替换然后进行测试，更改您的库并更新您可以看到所有页面:)

我认为这是由错误的现金引起的，我不知道原因，但我知道如何解决

;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:52:36.373

我想到了。当我将文件夹复制到另一个驱动器时，Dreamweaver 没有将模板文件 (Template/content.dwt) 识别为站点的模板。

我做了什么：文件>另存为模板...并保存在文件夹中的模板文件上。之后子页面更新。感谢所有试图帮助解决这个问题的人。

# c# - Sharing a data model between Silverlight and WPF client

> ID：11140544
> 
> 赞同：0
> 
> 时间：2012-06-21T14:37:01.917
> 
> 标签：c#, wpf, silverlight, ria

I am using EntityFramework Code First 5 and I have my data model.

Example:

```
[Table("Contract"]]
public class Contract
{
    ...

    [ForeignKey("SomeKey")]
    //[Include]
    public virtual BusinessPartner BP
    {
    ...
    }
} 
```

The data model is currently used by WPF client and it works great. Now I am writing a Silverlight client and using the same model. To acces the database I am using RIA Services. It worked great in silverlight until I had to add some RIA annotations like [Include] (it is commented in the above example).

The problem is that we are using .NET 4 Client Profile in our data model and we cannot change it. But RIA annotations are in System.ServiceModel.DomainServices.Server namespace which requires .NET 4 or .NET 4.5.

So if I add RIA [Include] annotation the model does not compile anymore.

Is there any way to use RIA annotation attributes witihin .NET 4 Client Profile so I could use the same data model in WPF and Silverlight client?

I have read something about defining those RIA attributes in XML file but I cannot find an example..

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T12:18:13.803

我找到了解决我的问题的方法。我使用了 FluentMetadata，即用于 WCF RIA 服务的 Fluent API，它使我能够在不同的程序集中定义注释。这正是我所需要的。有关 FluentMetadata 的更多信息，请参见以下[链接](http://riaservicescontrib.codeplex.com/wikipage?title=FluentMetadata%20for%20WCF%20RIA%20Services&referringTitle=Home)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:49:45.763

如果它适用于 WPF 并且在 Silverlight 中运行良好，那么您唯一需要的是为您的 WPF 应用程序创建自己的虚拟属性，该属性将模仿 RIA 中的 IncludeAttribute 以对其进行编译。要实现这一点，您需要将属性放置到它在 RIA 中的相同命名空间中。

```
namespace System.ServiceModel.DomainServices.Server 
{
    // Just put this into your WPF app :)
    [AttributeUsageAttribute(AttributeTargets.Property|AttributeTargets.Field, AllowMultiple = true, Inherited = true)]
    public class IncludeAttribute : Attribute {}
} 
```

# ruby-on-rails - 如何检查 ActiveResource 资源的可用性？

> ID：11140553
> 
> 赞同：0
> 
> 时间：2012-06-21T14:37:40.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activeresource

在我的 rails 应用程序中，我正在使用 ActiveResource 访问另一个服务，并且我想优雅地处理该资源脱机时发生的异常（服务器关闭/ip 被阻止等）。在没有返回任何响应的情况下，我的应用程序会生成此错误：

```
Errno::ECONNREFUSED in UsersController 
```

我想在我的应用程序控制器中执行“rescue_from”，以便在错误发生时处理错误，但不确定参数是什么，或者这种异常此时甚至可以捕获。

我应该/可以测试资源的可用性吗？

我可以这样做，但它会捕获每个错误，并且我想捕获我遇到的特定连接类型错误。

```
rescue_from Exception, do
  ...
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T18:07:52.857

假设一切正常，然后在出现异常时处理它可能更容易。您可以在应用程序控制器（或者可能是您的用户控制器，如果它是本地错误）中使用[rescue_from ：](http://api.rubyonrails.org/classes/ActiveSupport/Rescuable/ClassMethods.html)

```
class ApplicationController < ActionController::Base
    rescue_from(Errno::ECONNREFUSED) do |e|
        flash[:warning] = 'Hey!  Bad things happened!'
        render :template => 'my/error/page'
    end
end 
```

**注意：** 我在你更新你的帖子之前开始了这个，但好消息是它`Errno::ECONNREFUSED`是一个类 - 不是一个常量 - 所以你可以使用它而不是泛型`Exception`：

```
irb(main):009:0> Errno::ECONNREFUSED
=> Errno::ECONNREFUSED
irb(main):010:0> Errno::ECONNREFUSED.class
=> Class
irb(main):011:0> Errno::ECONNREFUSED.superclass
=> SystemCallError 
```

希望有帮助！

# javascript - How to retrieve phone number from live account using scope me/contacts?

> ID：11140559
> 
> 赞同：0
> 
> 时间：2012-06-21T14:38:13.520
> 
> 标签：javascript, windows-8, microsoft-metro

I am working on a windows 8 metro app where I need to read phone numbers of my windows live contacts. The project is in javascript and it uses "WL.API" kind of methods to contact with Live. I am able to retrieve firstname and lastname but not the phone number of a live contact using the scope "me/contacts"...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:43:07.497

电话号码似乎不是我/联系人的返回值。请参阅[交互式 SDK](http://isdk.dev.live.com/ISDK.aspx)和[文档](http://msdn.microsoft.com/en-us/library/live/hh826527.aspx#reading)。

# javascript - 使用 JQuery 将 Yahoo 联系人表转换为 CSV 文件的书签

> ID：11140565
> 
> 赞同：1
> 
> 时间：2012-06-21T14:38:54.967
> 
> 标签：javascript, jquery, facebook, csv, bookmarklet

不再像以前那样使用 Yahoo 邮件将 Facebook 朋友导出到 Twitter 或 Google+ - [http://lifehacker.com/5824769/how-to-migrate-all-your-facebook-data-to -google%252B](http://lifehacker.com/5824769/how-to-migrate-all-your-facebook-data-to-google%252B) 雅虎现在（可能是由 Facebook 强制）标记所有导入的 Facebook 朋友，这样你就不能再导出它们了。我想找到一种将 Yahoo 联系人转换为 CSV 文件（包括 Facebook 联系人）的方法，并认为最好的方法是转换简单的打印视图（请参阅[https://dl.dropbox.com/u/95261/CloudShot/shot_21062012_153052 .png](https://dl.dropbox.com/u/95261/CloudShot/shot_21062012_153052.png) ) 到 CSV 文件。

理想情况下，我会使用 Bookmarklet，并认为我可以使用类似于 Table2CSV- [http://www.kunalbabre.com/projects/table2CSV.php的插件](http://www.kunalbabre.com/projects/table2CSV.php)

我创建了以下书签作为测试：

`javascript:;var s=document.createElement('script'); s.setAttribute('src','http://jquery.com/src/jquery-latest.js'); document.getElementsByTagName('body')[0].appendChild(s); s.setAttribute('type', 'text/javascript'); var t=document.createElement('script'); t.setAttribute('src','http://www.kunalbabre.com/projects/table2CSV.js'); document.getElementsByTagName('body')[0].appendChild(t); t.setAttribute('type', 'text/javascript'); $('qprintable').table2CSV();`

这不起作用，因为 Yahoo 打印联系人中的表格将每个联系人放在单独的表格中。我这里有一个样本（我已经更改了细节以保护隐私！）- [http://pastebin.com/STuKmwQa](http://pastebin.com/STuKmwQa)

理想情况下，我可以以 CSV 格式下载或复制和粘贴。我想使用书签，因为我希望这对最终用户来说很容易，并希望这将使所有目前无法轻松导出 Facebook 联系人的人受益。

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-03T20:10:56.287

[http://jsfiddle.net/GMmdg/5/](http://jsfiddle.net/GMmdg/5/)

一般选择器格式：

```
xtract('table.container-of-inner-tables table.child-tables'); 
```

jsfiddle 的具体选择器，但它可能不适用于实际页面：

```
xtract('body > table > tbody > tr:not(.qprintfoot) table'); 
```

数据提取器功能，必要时更改内部选择器：

```
function xtract( rootTableSelector ){
    var rows = [];
    var csv = [];
    $( rootTableSelector ).each(function(){
        var $t = $(this);
        var row = {};
        row.name  = $.trim( $t.find('tr:nth-child(1) > td > b').text());
        row.email = $.trim( $t.find('tr:nth-child(2) > td > div:nth-child(2)').text());
        rows.push( row );
        csv.push([ row.name, row.email ]);
    });
    console.log( rows );
    $('#result').text( toCSV( csv ) );
    $('#json').text( JSON.stringify( rows) );
    // prompt('this is not csv', csv );
} 
```

未经测试，新编写的创建 csv 的函数，享受以下选项：

```
function toCSV( rows ){
    var newline = '\n';
    var fsep = ','; // field separator
    var quot = '"'; // field quoter
    var quotquot = [ quot + quot, '\\' + quot ][1]; // choose
    var alwaysQuote = false;
    var quoteIfContainsQuote = true;
    // omitted option possibilities:
    // - trimFields
    // - quoteStringsButNotNumbers(excel)
    // - putEqualSignBeforeNumbers(excel), etc.

    var lines = [];
    $.each( rows, function(){
      var line = [];
      $.each( this, function(){
          var s = this;
          var needsQuote = alwaysQuote;

          if( s.indexOf( fsep ) >= 0 )
              needsQuote = true;

          if( s.indexOf( quot ) >= 0 ){
              needsQuote = needsQuote || quoteIfContainsQuote;
              s = s.replace( quot, quotquot );
          }

          if( needsQuote ) s = quot + s + quot;
          line.push( s );
      });
      lines.push( line.join( fsep ));
    });
    return lines.join( newline );
} 
```

## 更新，完整的 js [http://marijnhaverbeke.nl/uglifyjs/](http://marijnhaverbeke.nl/uglifyjs/)）：

[http://pastebin.com/vCuVBUvE](http://pastebin.com/vCuVBUvE)

```
javascript:(function()%7Bfunction%20e(e)%7Bvar%20t%3D%22%5Cn%22%2Cn%3D%22%2C%22%2Cr%3D'%22'%2Ci%3D%5Br%2Br%2C%22%5C%5C%22%2Br%5D%5B1%5D%2Cs%3D!1%2Co%3D!0%2Cu%3D%5B%5D%3Breturn%20%24.each(e%2Cfunction()%7Bvar%20e%3D%5B%5D%3B%24.each(this%2Cfunction()%7Bvar%20t%3Dthis%2Cu%3Ds%3Bt.indexOf(n)%3E%3D0%26%26(u%3D!0)%2Ct.indexOf(r)%3E%3D0%26%26(u%3Du%7C%7Co%2Ct%3Dt.replace(r%2Ci))%2Cu%26%26(t%3Dr%2Bt%2Br)%2Ce.push(t)%7D)%2Cu.push(e.join(n))%7D)%2Cu.join(t)%7Dfunction%20t(t)%7Bvar%20n%3D%5B%5D%2Cr%3D%5B%5D%3B%24(t).each(function()%7Bconsole.log(this)%3Bvar%20e%3D%24(this)%2Ct%3D%7B%7D%3Bt.name%3D%24.trim(e.find(%22tr%3Anth-child(1)%20%3E%20td%20%3E%20b%22).text())%2Ct.email%3D%24.trim(e.find(%22tr%3Anth-child(2)%20%3E%20td%20%3E%20div%3Anth-child(2)%22).text())%2Cn.push(t)%2Cr.push(%5Bt.name%2Ct.email%5D)%7D)%2Cr%3De(r)%2Cconsole.log(n)%2C%24(%22body%22).prepend('%3Cpre%20id%3D%22result%22%3E%3C%2Fpre%3E')%2C%24(%22img%2C.qprintable%22).remove()%2C%24(%22%23result%22).text(r)%2C%24(%22%23json%22).text(JSON.stringify(n))%2Cprompt(%22Select%20all%20and%20copy%22%2Cr)%7Dfunction%20r()%7Bvar%20e%3Dwindow.jQuery%3Bif(!e)%7BsetTimeout(r%2C100)%3Breturn%7De(function()%7Bt(%22.qprintable2%22)%7D)%7Dvar%20n%3Ddocument.createElement(%22script%22)%3Bn.setAttribute(%22src%22%2C%22http%3A%2F%2Fcode.jquery.com%2Fjquery.min.js%22)%2Cn.setAttribute(%22type%22%2C%22text%2Fjavascript%22)%2Cdocument.getElementsByTagName(%22body%22)%5B0%5D.appendChild(n)%2Cr()%7D)() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-04T18:30:47.577

使用给定的 HTML，我会这样做来生成 CSV 数据（[演示](http://jsfiddle.net/jefferyto/JPKet/)）：

```
(function() {
    var a = $('table.qprintable2').map(function() {
        return $.trim($('b', this).text()) + '\t' +
            $.trim($('.first + div', this).text());
    });
    $('<textarea/>').val(a.get().join('\n')).appendTo('body');
})();​ 
```

如果您使用的是支持 data: URIs 的浏览器，您可以使用`window.open()`直接将 CSV 保存到文件（[演示](http://jsfiddle.net/jefferyto/JPKet/2/)）：

```
window.open('data:text/csv;charset=utf-8,' + encodeURIComponent(a.get().join('\n')), '', ''); 
```

请注意，您的浏览器可能会阻止演示小提琴中的弹出窗口；当从小书签触发时，应该允许新窗口。（您也可以不直接打开窗口，而是`<input type="button">`在页面中添加一个，单击它会打开窗口。）

**Update:** [This version](http://jsfiddle.net/jefferyto/JPKet/3/) will add a "Download CSV" link to the bottom of the page; when clicked, the browser will save or open (depending on the browser) the CSV file. This version should be used instead of the one that opens a new window.

# c++ - 如何从文件中只读取一行

> ID：11140566
> 
> 赞同：2
> 
> 时间：2012-06-21T14:38:57.060
> 
> 标签：c++, visual-c++, c++11

我试图读取文件的第一行，但是当我尝试提供保存在文件中的文本时，它会打印出整个文件，而不仅仅是一行。该工具也**不会**照顾休息或空格。

我正在使用以下代码：

```
//Vocabel.dat wird eingelesen
ifstream f;                         // Datei-Handle
string s;

f.open("Vocabeln.dat", ios::in);    // Öffne Datei aus Parameter
while (!f.eof())                    // Solange noch Daten vorliegen
{
    getline(f, s);                  // Lese eine Zeile
    cout << s;
}

f.close();                          // Datei wieder schließen
getchar(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:09:25.490

摆脱你的`while`循环。替换这个：

```
 while (!f.eof())                    // Solange noch Daten vorliegen
  {
    getline(f, s);                  // Lese eine Zeile
    cout << s;
  } 
```

用这个：

```
 if(getline(f, s))
    cout << s; 
```

* * *

**编辑**：响应新要求“它读取了我可以在第二个变量中定义的行？”

为此，您需要循环，依次读取每一行，直到您阅读了您关心的行：

```
// int the_line_I_care_about;  // holds the line number you are searching for
int current_line = 0;          // 0-based. First line is "0", second is "1", etc.
while( std::getline(f,s) )     // NEVER say 'f.eof()' as a loop condition
{
  if(current_line == the_line_I_care_about) {
    // We have reached our target line
    std::cout << s;            // Display the target line
    break;                     // Exit loop so we only print ONE line, not many
  }
  current_line++;              // We haven't found our line yet, so repeat.
} 
```

# json - 如何欺骗泽西岛返回嵌入式数组？

> ID：11140567
> 
> 赞同：0
> 
> 时间：2012-06-21T14:39:02.847
> 
> 标签：json, jersey

我有一个基于 Jersey 的 (JAX-RS) Web 服务，它与数据库的接口比它所做的任何其他事情都多。*Account是一个对象，其中包含一个嵌入的**Address*数组（也用*@XmlRootElement*标记）：

```
@XmlRootElement
public class Account
{
    ObjectId oid;
    String   name;
    String   email;
    ...
    ArrayList< Address > addresses;
}

@XmlRootElement
public class Address
{
    String   street;
    String   city;
    ...
} 
```

在读取操作中，我从数据库中获取了一个已填写的帐户，其中包含地址（在 Eclipse 中检查过）。当我将它们传回给我的调用者时（请参阅下面的 ReST 服务代码），所有*帐户*字段都会显示，但地址**不会**显示。为了发出请求并查看结果，我使用了Chrome 的*Simple REST Client*扩展：

```
{
    "oid":"4fe252a73cc58a6da34eb11f",
    "name":"Yosemite Sam",
    "email":"sam@warnerbros.com"
    (but no addresses)
} 
```

我预计泽西岛会返回类似“{“oid”：“......”，“名称”：“Yosemite Sam”，“电子邮件”：“sam@warnerbros.com”，“地址”：[{“street”：“17 Mariposa Way”、“city”：“Los Angeles”、... }、{ ... }、{ ... } ] }”。

任何人都可以阐明（我认为）泽西岛可能无法在这里做的事情以及如何欺骗它去做吗？

万分感谢，

拉斯贝特曼

*AccountService.java*：

```
import javax.ws.rs.*;
...
@POST
@Path( "/find" )
@Produces( { "application/json", "application/xml" } )
public Response read( Account account )
{
    Account result;

    try
    {
        result = accountManager.readByEmailOrOid( account );
    }
    catch( AppException e )
    {
        return e.buildResponse();
    }
    catch( RuntimeException e )
    {
        return AppException.buildRuntimeResponse( e );
    }

    return Response.ok( result ).build();  // result has addresses, but they don't show up!
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:41:14.293

啊，骗我。一位前同事让我提出了解决方案。我需要用*@XmlElement*注释嵌入的数组成员。这解决了一切。

```
@XmlRootElement
public class Account
{
    ObjectId oid;
    String   name;
    String   email;
    ...
    @XmlElement          <------ don't forget this annotation!
    ArrayList< Address > addresses;
} 
```

希望这可以帮助像我这样的其他可怜的笨蛋。

# node.js - Running Grunt with alternate config file location

> ID：11140571
> 
> 赞同：0
> 
> 时间：2012-06-21T14:39:11.550
> 
> 标签：node.js, foreman, gruntjs

Trying to run Grunt under foreman. Ideally i'd like to house my gruntfile in ./build as opposed to '.'.

I've also tried doing it in foreman via "grunt: cd build && grunt watch".

Can't seem to get it to work.... Is there a way to do this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-05T01:00:23.763

要在另一个位置点击 gruntfile，您只需要使用该`--gruntfile`标志。

对于您想要的目录结构：

`grunt --gruntfile ./build/grunt.js`

# java - 这条线返回什么？

> ID：11140575
> 
> 赞同：0
> 
> 时间：2012-06-21T14:39:17.190
> 
> 标签：java

```
int lf = ((t.left==null) = (t.right==null)) ? 1:0; 
```

如果大括号中的语句为真，则返回 1，但在中间，为 leftT 分配正确的值有什么意义？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T14:42:29.373

通常你会有一个等号来分配。赋值的返回与表达式的 RHS 相同。

您可以在 if 内的表达式中使用等号来同时分配和检查结果。

```
// return first and third items added if they exist.
if ((list = GetItems()).Length > 2) { return list[0] + list[2]; } 
```

在这里，您所拥有的只是一个编译器错误，因为`t.left==null`评估为`(true/false)`并且您无法分配给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:42:03.877

如果两者`t.left`同时`t.right`是`null`或者不是`null` **，**那么`lf`就是，`1`否则就是`0`。

你也有一个错字在那里。该行应该是

```
int lf = ((t.left==null) == (t.right==null)) ? 1:0; 
```

注意`==`两个空检查之间的。

# vba - VBA宏不能在工作簿中的多个工作表中工作

> ID：11140577
> 
> 赞同：1
> 
> 时间：2012-06-21T14:39:20.723
> 
> 标签：vba, excel

我在一家通信公司工作，我正在尝试在 Excel 文档上运行代码，该文档已编译有关产品故障报告的数据。

当您单击列（月）时，我要运行的宏将为每个数据集生成一个风险蜘蛛图。

我在第一个工作表中使用的宏，但是当它本质上是相同的数据时，我无法让它在第二个工作表中工作。

我会很感激我能得到的任何帮助！！

这是我的代码：

```
Private Sub Worksheet_Calculate()

    Call UpdateTotalRatings

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)

    If Target.Address = "$B$14" Then
        Call UpdateTotalRatings
    End If
End Sub

Private Sub UpdateTotalRatings()

Dim Cell As Range
Dim LastCol As String

    Application.ScreenUpdating = False

    ' Ensure number of colours is valid (must be 3 or 6).
    If ActiveSheet.Range("B14").Value <> 3 And _
       ActiveSheet.Range("B14").Value <> 6 Then
        ActiveSheet.Range("B14").Value = 3
    End If

    ' Determine right-most column.
     LastCol = Mid(ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell).Address, 2, 1)

    For Each Cell In Range("B13:" & LastCol & "13")
        If IsNumeric(Cell.Value) Then
            Cell.Interior.Color = ThisWorkbook.GetColour(Cell.Value, _
            ActiveSheet.Range("B14").Value)
        End If
    Next
    Application.ScreenUpdating = True

 End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-10T15:52:48.230

如果您将代码（进行了一些更改）放入 ThisWorkbook 模块，它将适用于工作簿中的每个工作表。

```
Private Sub Workbook_SheetCalculate(ByVal Sh As Object)

    UpdateTotalRankings Sh

End Sub

Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)

    If Target.Address = "$B$14" Then
        UpdateTotalRankings Sh
    End If

End Sub

Private Sub UpdateTotalRankings(Sh As Object)

    Dim rCell As Range
    Dim lLastCol As Long

    Application.ScreenUpdating = False

    ' Ensure number of colours is valid (must be 3 or 6).
    If Sh.Range("B14").Value <> 3 And _
        Sh.Range("B14").Value <> 6 Then

        Sh.Range("B14").Value = 3
    End If

    ' Determine right-most column.
    lLastCol = Sh.Cells.SpecialCells(xlCellTypeLastCell).Column

    For Each rCell In Sh.Range("B13").Resize(1, lLastCol - 1).Cells
        If IsNumeric(rCell.Value) Then
            rCell.Interior.Color = Me.GetColour(rCell.Value, _
                Sh.Range("B14").Value)
        End If
    Next rCell

    Application.ScreenUpdating = True

End Sub 
```

如果您有不想处理的工作表，可以检查 Sh 参数。也许它基于工作表名称

```
If Sh.Name Like "Report_*" Then 
```

只会处理名称以 Report_ 开头的工作表。或者

```
If Sh.Range("A14").Value = "Input" Then 
```

检查具有特定值的单元格（如 A14）以识别要处理的工作表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:59:11.467

这个过程`Worksheet_Change`是一个事件过程。

它应该（并且可以）仅在相应的工作表模块中。这就是为什么您的代码不适用于其他工作表的原因。

为了让它工作，你需要：

*   了解您打算用 VBA 做什么
*   在需要的每个工作表模块上调用事件过程
*   使用您将存储在“代码”标准模块中的主程序（此处不记得正确的名称）
*   使用范围参数将`Target`过程（或至少正确的工作表）传递给主过程

- - - 编辑 - - - -

一、改变

```
Private Sub UpdateTotalRatings() 
```

至

```
Sub UpdateTotalRatings(Optional ByVal Target As Range) 
```

然后，将所有移动`Sub UpdateTotalRatings(Optional ByVal Target As Range)`到一个模块

并且，在**每个**工作表模块中，添加：

```
Private Sub Worksheet_Calculate()

    Call UpdateTotalRatings

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)

    If Target.Address = "$B$14" Then
        Call UpdateTotalRatings(Target)
    End If
End Sub 
```

# android - 如何删除复选框中复选标记周围的矩形（Android）

> ID：11140578
> 
> 赞同：0
> 
> 时间：2012-06-21T14:39:22.983
> 
> 标签：android

有没有办法删除android中复选框周围的矩形？我只想保留复选标记，而不是矩形。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T16:22:39.233

您可以为此使用自定义复选框 xml 文件。试试下面的xml代码

```
 <?xml version="1.0" encoding="utf-8"?>
 <selector xmlns:android="http://schemas.android.com/apk/res/android">
 <item android:state_checked="true" 
    android:drawable="@drawable/cbchk_blue"
    android:state_focused="false">
    <shape android:shape="rectangle">
        <stroke android:width="2dp" android:color="@color/blue_dark" />
        <gradient  android:endColor="@color/white" android:startColor="@color/blue_dark" android:type="sweep"  />
        <size android:height="30dp" android:width="30dp" />
    </shape>
</item>
<item android:state_checked="true" 
    android:drawable="@drawable/cbchk_blue"
    android:state_focused="true">
    <shape android:shape="rectangle">
        <stroke android:width="2dp" android:color="@color/white" />
        <gradient  android:endColor="@color/white" android:startColor="@color/blue_dark" android:type="sweep"  />
        <size android:height="30dp" android:width="30dp" />
    </shape>
</item>
<item android:state_checked="false" 
    android:drawable="@drawable/cbunchk_blue"
    android:state_focused="false">
    <shape android:shape="rectangle">
        <stroke android:width="2dp" android:color="@color/blue_dark" />
        <size android:height="30dp" android:width="30dp" />
    </shape>
</item>
<item android:state_checked="false" 
    android:drawable="@drawable/cbunchk_blue"
    android:state_focused="true">
    <shape android:shape="rectangle">
        <stroke android:width="2dp" android:color="@color/white" />
        <size android:height="30dp" android:width="30dp" />
    </shape>
</item> 
```

将下面的图像保存为 cbchk_blue 并将其放置在可绘制文件夹中。

![在此处输入图像描述](../Images/b477a5280f680c47a1b39e9ebc541d50.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-30T03:39:50.277

为xml中的复选框添加透明背景

```
<CheckBox
   android:background="@android:color/transparent"
   android:button="@drawable/your_checkbox"/> 
```

# java - 在java中计算成本时出现NullPointerException

> ID：11140580
> 
> 赞同：-2
> 
> 时间：2012-06-21T14:39:25.720
> 
> 标签：java, nullpointerexception, classnotfoundexception

以下方法计算成本。它在需要时访问其他类。Cloud 类保存定价信息。

但是，该方法在下一行给了我一个空指针异常。BoundaryPrice btp = cloud.getBoundaryPriceMap().get(boundaryType); totalcost 的值永远不会改变。
有什么想法可以突出这里的问题吗？

```
private float getCostForConnector(Connector connector)
{
    Cloud cloud = new Cloud("http://amazon.com/europeEC2Clouds#dublinEC2Cloud", dynDesInventory);
    List<Port> portList = getListOfPort(connector);
    Resource root = findCommonRoot(connector);

    Port p1 = portList.get(0);
    Port p2 = portList.get(1);
    float totalCost = 0.0f;
    try
    {
    String rootBoundaryType = getRootBoundaryType();

    Float dataProducedFromP1 = getDataCountForPort(p1);
    Float dataProducedFromP2 = getDataCountForPort(p2);

    List<String> portOnePathOut =  getListOfNetworkBoundary(p1, root);
    List<String> portTwoPathOut =  getListOfNetworkBoundary(p2, root);

        for(String boundaryType: portOnePathOut)
        {
            BoundaryPrice btp = cloud.getBoundaryPriceMap().get(boundaryType);
            if (btp != null)
            {
                totalCost += btp.getOutPrice(boundaryType) + dataProducedFromP1;
                totalCost += btp.getInPrice(boundaryType) + dataProducedFromP2;
            }
        }

        for(String boundaryType: portTwoPathOut)
        {
            BoundaryPrice btp = cloud.getBoundaryPriceMap().get(boundaryType);
            if (btp != null)
            {
                totalCost += btp.getOutPrice(boundaryType) + dataProducedFromP2;
                totalCost += btp.getInPrice(boundaryType) + dataProducedFromP1;
            }
        }

        BoundaryPrice btp = cloud.getBoundaryPriceMap().get(rootBoundaryType);
        if (btp != null)
        {
            totalCost += (dataProducedFromP1 + dataProducedFromP2) * btp.getIntraPrice(rootBoundaryType);
        }

    }catch(NullPointerException e) {
        System.err.println("Caught NullPointerException: ");
    }
    return totalCost;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:49:58.573

1.  `portOnePathOut` 和`portTwoPathOut` 列表之一为空
2.  `portList`一片空白
3.  `cloud.getBoundaryPriceMap()`一片空白
4.  `btp.getIntraPrice(rootBoundaryType)`是数字包装器，它为空
5.  `dataProducedFromP1` 或`dataProducedFromP2`为空
6.  `btp.getOutPrice(boundaryType)`,`btp.getIntraPrice(rootBoundaryType)`或`btp.getInPrice(boundaryType)`为空
7.  您调用的*函数内部*的某些对象为空

下次发布堆栈跟踪时，该列表会短得多。

# xslt - XSL 1.0 - 如何在标记化字符串上使用 for-each

> ID：11140581
> 
> 赞同：1
> 
> 时间：2012-06-21T14:39:32.843
> 
> 标签：xslt, foreach, xslt-1.0, tokenize

使用 XSL 1.0，我发现了一个不错的标记化函数。现在我需要对生成的令牌进行 for-each 。我对 XSL 很陌生。

我需要的php等价物：

```
$in = 'a,b,c,d';
$tokens = explode (',', $in);
foreach ($tokens as $token) {
  echo $token;
} 
```

这是我到目前为止所拥有的。此行将输出 'a,b,c,d'-

```
<xsl:value-of select="@CommaSeparated" /> 
```

这将通过 tokenize 函数运行该字符串-

```
 <xsl:call-template name="tokenize">
    <xsl:with-param name="pText" select="@CommaSeparated"/>
  </xsl:call-template> 
```

以及标记化功能。我了解这是做什么的，只是不了解它吐出的数据格式-

```
<xsl:template name="tokenize">
  <xsl:param name="pText"/>

  <xsl:if test="string-length($pText)">
    <tag>
      <xsl:value-of select=
       "substring-before($pText, ',')"/>
    </tag>

    <xsl:call-template name="tokenize">
      <xsl:with-param name="pText" select=
       "substring-after($pText, ',')"/>
    </xsl:call-template>
  </xsl:if>
</xsl:template> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T16:19:17.563

首先，使用的 tokenize 函数实际上并不正确。理论上，它应该像这样吐出一个**标签**元素列表（严格来说是“结果树片段”）

```
<tag>a</tag>
<tag>b</tag>
<tag>c</tag>
<tag>d</tag> 
```

但它实际上错过了最后一个元素

```
<tag>a</tag>
<tag>b</tag>
<tag>c</tag>
<tag></tag> 
```

你最好在这里找到另一个标记化函数（在 StackOverflow 中肯定有工作的）。

但是，在回答您关于在此之上使用 xsl:for-each 的问题时，您可能会想要做这样的事情......

```
 <xsl:variable name="tags">
    <xsl:call-template name="tokenize">
       <xsl:with-param name="pText" select="@CommaSeparated"/>
     </xsl:call-template> 
  </xsl:variable>

  <xsl:for-each select="$tags/tag">
     <xsl:copy-of select="." />
  </xsl:for-each> 
```

也就是说，将标签列表存储在一个变量中，然后循环遍历它们。但是，如果您在 XSLT1.0 中尝试此操作，则会收到错误消息“表达式必须计算为节点集。”。为了解决这个问题，您需要使用扩展功能。EXSLT 可能是最常见的。您可以像这样在 XSLT 中声明它

```
<xsl:stylesheet 
    version="1.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
    xmlns:exsl="http://exslt.org/common" 
    exclude-result-prefixes="exsl"> 
```

你可以简单地改变**xsl:for-each**如下：

```
<xsl:for-each select="exsl:node-set($tags)/tag"> 
```

因此，给定以下 XML

```
<a CommaSeparated="a,b,c,d"></a> 
```

以及以下 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:exsl="http://exslt.org/common" exclude-result-prefixes="exsl">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="/a">
        <xsl:variable name="tags">
            <xsl:call-template name="tokenize">
                <xsl:with-param name="pText" select="@CommaSeparated"/>
            </xsl:call-template>
        </xsl:variable>
        <xsl:for-each select="exsl:node-set($tags)/tag">
            <xsl:copy-of select="."/>
        </xsl:for-each>
    </xsl:template>

    <xsl:template name="tokenize">
        <xsl:param name="pText"/>
        <xsl:if test="string-length($pText)">
            <tag>
                <xsl:value-of select="substring-before($pText, ',')"/>
            </tag>
            <xsl:call-template name="tokenize">
                <xsl:with-param name="pText" select="substring-after($pText, ',')"/>
            </xsl:call-template>
        </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

以下是输出（由于您使用的错误标记化功能，最后一个标签为空白）

```
<tag>a</tag>
<tag>b</tag>
<tag>c</tag>
<tag></tag> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-30T12:16:28.187

检查此代码：

```
<xsl:variable name="val">
       <xsl:value-of select="@CommaSeparated"/><xsl:text disable-output-escaping="yes"><![CDATA[ ]]></xsl:text>
</xsl:variable>

<xsl:template match="/a">
    <xsl:variable name="tags">
        <xsl:call-template name="tokenize">
            <xsl:with-param name="pText" select="$val"/>
        </xsl:call-template>
    </xsl:variable>
    <xsl:for-each select="exsl:node-set($tags)/tag">
        <xsl:copy-of select="."/>
    </xsl:for-each>
</xsl:template>

<xsl:template name="tokenize">
    <xsl:param name="pText"/>
    <xsl:if test="string-length($pText)">
        <tag>
            <xsl:value-of select="substring-before($pText, ',')"/>
        </tag>
        <xsl:call-template name="tokenize">
            <xsl:with-param name="pText" select="substring-after($pText, ',')"/>
        </xsl:call-template>
    </xsl:if>
</xsl:template> 
```

# c++ - SAP2000 API 与 Visual Studio 10 C++

> ID：11140583
> 
> 赞同：0
> 
> 时间：2012-06-21T14:39:43.907
> 
> 标签：c++

我正在尝试将 SAP2000 COM 导入到 Visual Studio 10 C++ 控制台应用程序项目中，以便可以在我的项目中使用 SAP2000 API。但是，每次我使用导入而不是使用 SAP2000.exe、SAP2000.tlb 或 SAP2000.dll 时，我都会不断收到错误消息：

“错误 9 错误 C1084：无法读取类型库文件：'SAP2000.tlb'：加载类型库/DLL 时出错。c:\users\jgr208\documents\visual studio 2010\projects\sapapi\sapapi\sapapi.cpp 5 1 SAPapi ”。

有谁知道将 SAP2000 COM 导入 vs10 C++ 的任何可能解决方案（我已经让它与 C# 一起使用，但我更熟悉使用 C++）？我已经粘贴了下面的代码，很抱歉，因为我是新来的，所以格式不正确。

```
// SAPapi.cpp : Defines the entry point for the console application.
//

//standard header
#include "stdafx.h"
//import of SAP2000 COM (LINE WHERE ERROR ALWAYS OCCURS)
#import "SAP2000.tlb"

//empty main
int _tmain(int argc, _TCHAR* argv[])
 {
     return 0;
 } 
```

# jquery - ASP.MVC 4 奇怪的 ajax 问题 - 返回错误的模型值

> ID：11140586
> 
> 赞同：1
> 
> 时间：2012-06-21T14:39:51.760
> 
> 标签：jquery, asp.net-mvc-4

我在 mvc4 操作中有一个标准形式。我使用 jQuery.post 在服务器上执行回发操作：

```
[HttpPost]
    public ActionResult ContactUpdate(ContactClass model)
    {
      var originalContact = contactService.Get(model.Id);

      if (ModelState.IsValid && TryUpdateModel(originalContact))
      {
        contactService.Update(originalContact);
      }

      var updatedContact = contactService.Get(model.Id);

      return PartialView("ContactView", updatedContact );
    } 
```

这可以按预期工作，此处的代码仅用于说明，因为我的问题稍后会在请求中出现。我的联系服务还没有实现更新，所以 updatedContact 实际上与原始的相同（当您执行更新时，所有更改都将被忽略并返回旧对象）。因此，当我将网页中的即 PostCode 从 555 更改为 666 时，updatedContact.PostCode 为 555。我在调试器中检查了它的值，也在调用的 cshtml 文件中检查了它的值，`@Html.EditorFor(m=>m.PostCode)`并且在任何地方它都有旧值（未更新）。问题是返回的 html（从 firebug 和 chrome 开发工具中的网络捕获）具有：

```
<input class="text-box" id="PostCode" name="PostCode" type="text" value="666"> 
```

这种行为对于所有属性都是相同的，据我所知，没有输出缓存（即使是，它也是一个 POST 请求，因此应该绕过缓存）。当我刷新页面时，我得到“旧”值。

起初，我认为这是我的 ajaxSuccess 函数`$("#myform").replaceWith(returnedText)`，但在仔细检查响应内容后，我确信问题出在返回的 html 中。这怎么可能？

这个错误现在造成了我的更新正在运行的错觉，如果它正在运行，我可能甚至都不知道它。这是一种潜在的危险行为，因为某些属性的值可能与发布到控制器的值不同，并且用户在更新后将无法看到它，因此我可能不得不刷新整个页面以解决问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:56:18.950

所有`Html.`助手都喜欢这些`ModelState`值而不是实际模型值。

如果您不想从“回发”操作返回更新的模型，则需要清除第`ModelState`一个：

```
[HttpPost]
public ActionResult ContactUpdate(ContactClass model)
{
  var originalContact = contactService.Get(model.Id);

  if (ModelState.IsValid && TryUpdateModel(originalContact))
  {
    contactService.Update(originalContact);
  }

  var updatedContact = contactService.Get(model.Id);

  this.ModelState.Clear();
  return PartialView("ContactView", updatedContact );
} 
```

[这篇文章](http://www.west-wind.com/weblog/posts/2012/Apr/20/ASPNET-MVC-Postbacks-and-HtmlHelper-Controls-ignoring-Model-Changes)很好的解释了mvc框架的这个特性。

# node.js - 处理消息队列并使用异步

> ID：11140588
> 
> 赞同：1
> 
> 时间：2012-06-21T14:39:54.023
> 
> 标签：node.js, asynchronous, azure, azure-storage

我编写了一个小型测试节点应用程序，它循环并将消息添加到队列（天蓝色存储队列），如下所示：

```
var queueService = azure.createQueueService();
var queueName = 'taskqueue';

// other stuff like check if created

// loop called after queue is confirmed

for (i=0;i<1000;i++){
  queueService.createMessage(queueName, "Hello world!", null, messageCreated);
}

// messageCreated does nothing at the moment, just logs to console 
```

我正在尝试重写它来处理说 100 万个创建使用异步来控制并行运行的工作函数的数量。这比什么都重要。

[https://github.com/caolan/async#queue](https://github.com/caolan/async#queue)

这是异步队列的基本设置，我不知道我需要更改什么。我认为以下内容不会起作用：

```
var q = async.queue(function (task, callback) {
   queueService.createMessage(queueName, task.msg, null, messageCreated);
    callback();
}, 100);

// assign a callback.  Called when all the queues have been processed
q.drain = function() {
    console.log('all items have been processed');
}

// add some items to the queue
for(i=0;i<1000000;i++) {
  q.push({msg: 'Hello World'}, function (err) {
    console.log('finished processing foo');
  });
    console.log('pushing: ' + i);
} 
```

我不太了解如何将它们与异步结合在一起。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:49:18.553

这是你的错误：

```
var q = async.queue(function (task, callback) {
   queueService.createMessage(queueName, task.msg, null, messageCreated);
    callback();
}, 100); 
```

您正在做的是在队列上创建一条消息，然后立即传递延续（调用回调）。您要做的是在传递给的回调中传递延续`createMessage`：

```
var q = async.queue(function (task, callback) {
   queueService.createMessage(queueName, task.msg, null, function(error, serverQueue, serverResponse) {
       callback(error, serverQueue, serverResponse);
       messageCreated(error, serverQueue, serverResponse);
   });
}, 100); 
```

现在每个任务都将在实际创建任务后报告完成。

**编辑：**更新的`createMessage`回调接口。

# less - SCSS：多个 CSS 语句中间的条件

> ID：11140590
> 
> 赞同：0
> 
> 时间：2012-06-21T14:40:05.167
> 
> 标签：less, sass

我正在为 SCSS 构建一个 mixin 我想知道是否可以添加一个附加值，具体取决于一个参数。这是我尝试过的。一切正常，但 @if 条件：

```
@mixin fontFace( $fontName, $path: "", $weight: normal, $style: none, $fileName: $fontName, $svg:0 ) {
    @font-face {
      font-family: $fontName;
        src: url("#{$path}#{$fileName}.eot");
        src: url("#{$path}#{$fileName}.eot?iefix") format("eot"), 
                 url("#{$path}#{$fileName}.woff") format("woff"),
                 url("#{$path}#{$fileName}.ttf") format("truetype")
                 @if $svg != 0 {
                    , url("#{$path}#{$fileName}.svg##{$fileName}") format("svg");
                 }else{
                    ;
                 }
      font-weight: $weight;
      font-style: $style;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T11:51:58.993

以下情况如何：

```
@mixin fontFace( $fontName, $path: "", $weight: normal, $style: none, $fileName: $fontName, $svg: false ) {
    $src: url("#{$path}#{$fileName}.eot?iefix") format("eot"), 
          url("#{$path}#{$fileName}.woff") format("woff"),
          url("#{$path}#{$fileName}.ttf") format("truetype");

    @if $svg == true {
        $src: $src, 
                url("#{$path}#{$fileName}.svg##{$fileName}") format("svg");
    }

    @font-face {
        font-family: $fontName;
        src: url("#{$path}#{$fileName}.eot");
        src: $src;
        font-weight: $weight;
        font-style: $style;
    }
} 
```

# c# - 在运行时扩展类

> ID：11140591
> 
> 赞同：0
> 
> 时间：2012-06-21T14:40:07.897
> 
> 标签：c#, .net

可能我无法用语言准确解释我想要实现的目标，但我认为这个示例代码可以做到：

```
class A
{
    public string Name
    {
        get;
        set;
    }
    public virtual void Say()
    {
        Console.WriteLine("I am A");
        Console.Read();
    }

    public bool ExtendA;

    public A GetObject()
    {
        if (ExtendA)
            return new B();

        return this;
    }
}

internal class B : A
{
    public override void Say()
    {
        Console.WriteLine(string.Format("I am {0}",Name));
        Console.Read();
    }
}

class Program
{
    static void Main(string[] args)
    {          
       var a = new A() {ExtendA = true,Name="MyName"};
        A ab = a.GetObject();            
    } 
} 
```

根据上面的代码，当字段 Exitend A 设置为 true 时，当我再次尝试从同一对象实例获取相同类型的对象时，我得到了该对象，但它丢失了属性“名称”的值。

有什么建议我怎样才能返回具有 A 属性的 B 类？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:45:33.913

我建议您阅读有关设计模式的书籍或其他资源。为此，您将使用工厂模式。

除了 class和 class 之外，您还有 base class`A`和class 。`AFactory``B : A``BFactory`

在运行时，您可以选择要实例化的内容：A 或 B 使用工厂：

IFactory 工厂 = iWantClassA ？新 AFactory() : 新 BFactory(); A a = factory.CreateInstance();

尽管我同意@ArnaudF 的观点，但我看不出您要完成什么。为什么不直接创建子类 B？

更新：

重新阅读您的问题后，听起来您真的只需要在课堂上使用一个复制构造函数，如下所示：

```
public class A {
    public A() {
        // Default constructor
    }
    public A(A other) {
        // Copy-constructor. Members of other will be copied into this instance.
    }
}

public class B : A {
    public B() {

    }
    public B(A other) : base(other) { // Notice how it calls the parent class's copy-constructor too
    }
} 
```

然后在运行时将 A 的实例“升级”为 B 的实例，只需使用复制构造函数：

```
A a = new A();
// some logic here
B upgradedA = new B( a ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:03:10.873

我不确定你的最终目标是什么，但我想让你知道 ExpandObject 类型，以防你不知道它。

这使您可以在运行时向对象动态添加属性和方法，如以下代码所示：

```
using System;
using System.Dynamic;

namespace Demo
{
    class Program
    {
        static void Main(string[] args)
        {
            dynamic expando = new ExpandoObject();

            expando.Name = "Name";  // Add property at run-time.
            expando.PrintName = (Action) (() => Console.WriteLine(expando.Name)); // Add method at run-time.

            test(expando);
        }

        private static void test(dynamic expando)
        {
            expando.PrintName();
        }
    }
} 
```

# xml - Windows 命令行根据键值对附加到 xml 文件

> ID：11140592
> 
> 赞同：0
> 
> 时间：2012-06-21T14:40:10.320
> 
> 标签：xml, windows, command-line, key-value

我在一堆单独的目录中有一堆名为 content_[0-9] 的 xml 文件（内容下划线后跟一个数字）。这些文件都有一个 airport_code 元素，如下所示：

```
<airport_code>JFK</airport_code> 
```

然后我有一个像这样的键值映射：

```
JFK=US/Eastern
LHR=Europe/London
etc 
```

我想循环浏览所有这些 xml 文件并将正确的时区元素附加到每个 xml 文件，以便 JFK 文件将读取：

```
<airport_code>JFK</airport_code> 
<timezone>US/Eastern</timezone> 
```

我试图在 Windows 批处理脚本中执行此操作（安装了[unix utils](http://unxutils.sourceforge.net/ "Unix 工具")）。这是我到目前为止所拥有的：

```
@echo off 
for /d %%x in (C:\directory\*) do type %%x\content_? | grep "<airport_code>" | gawk "{gsub(/  <airport_code>/, \"\"); print}" | gawk "{gsub(/<\/airport_code>/, \"\"); print}" 
```

它将读取所有 xml 文件的机场代码。

我将如何在每个机场代码的键值对中查找值并附加适当的时区元素？这可能吗？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T15:32:32.873

我设法自己解决了这个问题，但只能通过切换到 powershell 来解决。感谢评论和改进，以及在 cmd 中做事的建议：

```
foreach ($i in get-childitem $loc -recurse){
    if ($i.name -match "content_"){
        $content = get-content $i.FullName
        $airportcode=get-content $i.FullName | select-string -pattern "<airport_code>"
        $airportcode= $airportcode -replace "<airport_code>", "" 
        $airportcode= $airportcode -replace "</airport_code>", ""
        $airportcode= $airportcode -replace "  ", ""
        $timezone=$timezones.Get_Item("$airportcode")
        $newContent = $content -replace "</airports>", ""
        $newContent = $newContent -replace "  ","`n  "
        $newContent="$($newContent)`n<timezone>$($timezone)</timezone>`n</airports>"
        Set-Content $i.FullName $newContent
    } 
} 
```

请注意，这也会删除结束元素标记 </airports>，然后将其附加到文档末尾。

# html - 电子邮件中的图像不显示

> ID：11140595
> 
> 赞同：2
> 
> 时间：2012-06-21T14:40:24.360
> 
> 标签：html, image, email, hyperlink

该图像显示在完美的 gmail 中，但在其他几个电子邮件程序中是空白的。不知道出了什么问题。我已经确认了实际链接并打开了图像。

```
<a target="_blank" href="https://site" style="display: block; height: 200px; width: 200px; margin-top: 4px; border: 0;">
<img src="https://image" alt="image" border="0" style="display: block; border:0;" />
</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:41:43.280

大多数电子邮件程序会从电子邮件中删除图像，因为它们可用于跟踪用户。垃圾邮件发送者通常会这样做以验证活动的电子邮件地址。要解决此问题，您可以将图像附加到电子邮件本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:51:06.133

I would check to see if a non secure image using a regular http:// link works. It is remotely possible a host machine or email application might be blocking port 443 used by SSL. Since Gmail is cloud based, you would not have that problem.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-14T14:47:55.630

我有一个类似的问题，并选择了一个相当激进的解决方法来避免弄乱邮件客户端的规则。您可以将图像转换为由彩色 HTML 表表示的位图。基本思想非常简单，您可以在 Internet 上找到几种工具。当然，对于大位图，结果表可能有数百 KB 长；当我遇到这个问题时，我编写了一个工具，将一些简单的压缩方法应用于该表，并在 GPL 下发布了代码。

可能不是最干净的解决方案，但它*在*电子邮件设计上没有太多妥协。

[通过一些压缩将图像转换为纯 HTML 的工具](http://img2html.odednoam.com/)

# c# - IIS应用池回收+石英调度

> ID：11140597
> 
> 赞同：15
> 
> 时间：2012-06-21T14:40:27.453
> 
> 标签：c#, asp.net, iis, quartz.net

我在 IIS 7.5 上运行一个 Web 应用程序，它需要偶尔回收（否则内存使用会失控，我正在调查！）。

当它回收时，它实际上不会运行，直到另一个请求进来，石英不会运行。

有没有办法让IIS在回收应用程序池后立即自动调出1个工作进程以确保石英始终在线？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-21T16:19:46.197

是的！

[http://weblogs.asp.net/scottgu/archive/2009/09/15/auto-start-asp-net-applications-vs-2010-and-net-4-0-series.aspx](http://weblogs.asp.net/scottgu/archive/2009/09/15/auto-start-asp-net-applications-vs-2010-and-net-4-0-series.aspx)很好地详细说明了它，基本上你需要：

1.  编辑 C:\Windows\System32\inetsrv\config\applicationHost.config 以包括：

    ```
    <applicationPools> 
        <add name="MyAppWorkerProcess" managedRuntimeVersion="v4.0" startMode="AlwaysRunning" /> 
    </applicationPools> 
    ```

2.  声明应该作为您网站的“热身”运行的内容

    ```
    <sites> 
        <site name="MySite" id="1"> 
            <application path="/" serviceAutoStartEnabled="true" serviceAutoStartProvider="PreWarmMyCache" />
        </site> 
    </sites>
    <serviceAutoStartProviders> 
        <add name="PreWarmMyCache" type="PreWarmCache, MyAssembly" /> 
    </serviceAutoStartProviders> 
    ```

3.  使用您想要的任何“热身”逻辑配置您的应用程序：

    ```
    public class PreWarmCache : System.Web.Hosting.IProcessHostPreloadClient {
        public void Preload(string[] parameters) { 
            // Perform initialization and cache loading logic here... 
        } 
    } 
    ```

注意：如果您只需要存在 w3wp.exe 进程，我相信只有第 1 步是必要的。如果您还需要其他项目（例如将某些内容加载到内存中），那么也将使用第 2 步和第 3 步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-25T15:06:16.763

从 IIS 8.0 开始，有一个选项可以模拟对根页面的请求，从而进行完整的应用程序初始化：应用程序池高级设置 -> 启用预加载 = true。

当然，startMode 应该是 AlwaysRunning。

可以在[此处](https://blogs.msdn.microsoft.com/vijaysk/2012/10/11/iis-8-whats-new-website-settings/)找到有关如何启用此功能的更多详细信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T00:34:04.777

我解决了这个问题。虽然[Stephen 的回答](https://stackoverflow.com/a/11142460/113225)将使应用程序保持运行，但在 Spring.Net 环境中，框架不会启动，Quartz 也不会运行。我整理了一个 IProcessHostPreloadClient 的实现，它将触发对应用程序的真实请求，以使所有机器运行。这也发布[在我的博客上](http://emilsblog.lerch.org/2013/01/enabling-quartz-jobs-in-aspnet.html)：

```
public class Preloader : System.Web.Hosting.IProcessHostPreloadClient
{
    public void Preload(string[] parameters)
    {
        var uris = System.Configuration.ConfigurationManager
                         .AppSettings["AdditionalStartupUris"];
        StartupApplication(AllUris(uris));
    }

    public void StartupApplication(IEnumerable<Uri> uris)
    {
        new System.Threading.Thread(o =>
        {
            System.Threading.Thread.Sleep(500);
            foreach (var uri in (IEnumerable<Uri>)o) {
                var client = new System.Net.WebClient();
                client.DownloadStringAsync(uris.First());
            }
        }).Start(uris);
    }

    public IEnumerable<Uri> AllUris(string userConfiguration)
    {
        if (userConfiguration == null)
            return GuessedUris();
        return AllUris(userConfiguration.Split(' ')).Union(GuessedUris());
    }

    private IEnumerable<Uri> GuessedUris()
    {
        string path = System.Web.HttpRuntime.AppDomainAppVirtualPath;
        if (path != null)
            yield return new Uri("http://localhost" + path);
    }

    private IEnumerable<Uri> AllUris(params string[] configurationParts)
    {
        return configurationParts
            .Select(p => ParseConfiguration(p))
            .Where(p => p.Item1)
            .Select(p => ToUri(p.Item2))
            .Where(u => u != null);
    }

    private Uri ToUri(string value)
    {
        try {
            return new Uri(value);
        }
        catch (UriFormatException) {
            return null;
        }
    }

    private Tuple<bool, string> ParseConfiguration(string part)
    {
        return new Tuple<bool, string>(IsRelevant(part), ParsePart(part));
    }

    private string ParsePart(string part)
    {
        // We expect IPv4 or MachineName followed by |
        var portions = part.Split('|');
        return portions.Last();
    }

    private bool IsRelevant(string part)
    {
        var portions = part.Split('|');
        return
            portions.Count() == 1 ||
            portions[0] == System.Environment.MachineName ||
            HostIpAddresses().Any(a => a == portions[0]);
    }

    private IEnumerable<string> HostIpAddresses()
    {
        var adaptors = System.Net.NetworkInformation
                             .NetworkInterface.GetAllNetworkInterfaces();
        return adaptors
                .Where(a => a.OperationalStatus == 
                            System.Net.NetworkInformation.OperationalStatus.Up)
                .SelectMany(a => a.GetIPProperties().UnicastAddresses)
                .Where(a => a.Address.AddressFamily == 
                            System.Net.Sockets.AddressFamily.InterNetwork)
                .Select(a => a.Address.ToString());
    }
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-08-07T12:49:35.460

或者您可以简单地修改 Global.asax 中的“Application_Start”方法以确保 Quortz 正在运行。

# c# - 为什么单击 ListView 的 ImageButton 时不会触发回发事件？

> ID：11140601
> 
> 赞同：0
> 
> 时间：2012-06-21T14:40:44.943
> 
> 标签：c#, asp.net, listview, postback, imagebutton

我有`ListView`一个`ImageButton`.
我已经设置`OnItemCommand`了`ListView`.
我已经设置了的`CommandName`和。`CommandArgument``ImageButton`

出于某种原因，当我单击它时不会触发回发`ImageButton`。

我尝试对正常人做同样的事情，`<asp:Button>`并且没有问题。我必须设置`OnSubmitBehavior`为`false`.

所以我尝试将其设置为相同，但`ImageButton`仍然无法正常工作。

任何的想法 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T17:36:11.680

这将是解决方法，而不是解决此特定问题的方法，但这可能会对您有所帮助：

[http://netpl.blogspot.com/2008/01/imagebutton-in-templatefield-does-not.html](http://netpl.blogspot.com/2008/01/imagebutton-in-templatefield-does-not.html)

# facebook - Facebook Live Stream 插件 IE “内容无法在框架中显示”

> ID：11140603
> 
> 赞同：0
> 
> 时间：2012-06-21T14:40:49.107
> 
> 标签：facebook, iframe, login

使用 Facebook Javascript SDK，我们集成了 Live Stream 插件。

```
<script>
    window.fbAsyncInit = function() {

    FB.init({
      appId      : APP_ID, // App ID
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      oauth      : true, // enable OAuth 2.0
      xfbml      : true  // parse XFBML
    });

};
</script>

<div class="fb-live-stream" data-event-app-id="229717737092882" data-width="307" data-height="451" data-always-post-to-friends="false">
<script>
FB.XFBML.parse();
</script> 
```

所以直播聊天在所有浏览器中都能正常工作。但仅在 IE 中，当您在另一个选项卡中打开 facebook 并注销然后返回我的网站时，Live Stream 的 iframe 会自行刷新并显示一个弹出窗口，上面写着“您尚未登录”“请登录以继续”。当我单击 LOGIN 按钮时，实时流刷新并显示 iframe 错误：

**此内容无法在框架中显示**

**为帮助保护您输入本网站的信息的安全性，此内容的发布者不允许将其显示在框架中。**

我们无法在 FF 或 Chrome 上重现此错误。我在 stackoverflow 上读过类似的问题，但没有一个适用于我的情况。

有任何想法吗 ？

# iphone - 上传时获取旋转的图像表单服务器

> ID：11140604
> 
> 赞同：0
> 
> 时间：2012-06-21T14:40:50.667
> 
> 标签：iphone, uiimageview, uiimage, uiimagepickercontroller

```
- (IBAction)grabImage{
    UIImagePickerController *ipc = [[UIImagePickerController alloc] init];
    ipc.delegate = self;
    ipc.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
    [self presentModalViewController:ipc animated:YES];
    [ipc release];

}

-(void)imageuploaded
{

    /*
     turning the image into a NSData object
s    getting the image back out of the UIImageView
     setting the quality to 90
     */
    //MBProgressHUD *hud = [MBProgressHUD showHUDAddedTo:self.view animated:YES];
    //hud.labelText = @"Uploading image ";

    //assume that the image is loaded in landscape mode from disk

    NSData *imageData = UIImageJPEGRepresentation(image.image, 0.09);

    // setting up the URL to post to
    NSString *urlString = NSLocalizedString(UploadText, @"");

    // setting up the request object now
    NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
    [request setURL:[NSURL URLWithString:urlString]];
    [request setHTTPMethod:@"POST"];

    /*
     add some header info now
     we always need a boundary when we post a file
     also we need to set the content type

     You might want to generate a random boundary.. this is just the same 
     as my output from wireshark on a valid html post
     */
    NSString *boundary = [NSString stringWithString:@"---------------------------14737809831466499882746641449"];
    NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
    [request addValue:contentType forHTTPHeaderField: @"Content-Type"];

    // Create a image file name

    store *myStore =[store sharedstore];
    NSString *imagename=myStore.Emailaddress;

    /*
     now lets create the body of the post
     */
    NSMutableData *body = [NSMutableData data];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];    
    [body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"userfile\"; filename=\"%@.png\"\r\n",imagename] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
    [body appendData:[NSData dataWithData:imageData]];
    [body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
    // setting the body of the post to the reqeust
    [request setHTTPBody:body];

    // now lets make the connection to the web
    NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
    NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
    NSLog(@"%@",returnString);

    //[MBProgressHUD hideHUDForView:self.view animated:YES];

    label.hidden=YES;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:00:16.847

在将图像上传到服务器之前，使用此代码[https://gist.github.com/1064652修复图像方向。](https://gist.github.com/1064652)

UPD：单击以创建新文件，选择 Cocoa Touch，然后选择 Objective-C 类别。然后在“Category”字段中写入 FixOrientation，在“Category on”字段中写入 UIImage。然后单击下一步并完成文件创建。之后，插入方法声明

```
- (UIImage *)fixOrientation; 
```

在 UIImage+FixOrientation.h

并将实现从 github 复制到 UIImage+FixOrientation.m 文件。

接下来，添加

```
#import "UIImage+FixOrientation.h" 
```

到你的班级，你是否使用图像。

之后，替换字符串

```
NSData *imageData = UIImageJPEGRepresentation(image.image, 0.09); 
```

字符串：

```
NSData *imageData = UIImageJPEGRepresentation([image.image fixOrientation], 0.09); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-30T11:13:32.130

作为上面的改进，只需在您的类中使用此方法：

```
- (UIImage *) fixOrientation: (UIImage*) image {

    // No-op if the orientation is already correct
    if (image.imageOrientation == UIImageOrientationUp)
        return image;

    // We need to calculate the proper transformation to make the image upright.
    // We do it in 2 steps: Rotate if Left/Right/Down, and then flip if Mirrored.
    CGAffineTransform transform = CGAffineTransformIdentity;

    switch (image.imageOrientation) {
        case UIImageOrientationDown:
        case UIImageOrientationDownMirrored:
            transform = CGAffineTransformTranslate(transform, image.size.width, image.size.height);
            transform = CGAffineTransformRotate(transform, M_PI);
            break;

        case UIImageOrientationLeft:
        case UIImageOrientationLeftMirrored:
            transform = CGAffineTransformTranslate(transform, image.size.width, 0);
            transform = CGAffineTransformRotate(transform, M_PI_2);
            break;

        case UIImageOrientationRight:
        case UIImageOrientationRightMirrored:
            transform = CGAffineTransformTranslate(transform, 0, image.size.height);
            transform = CGAffineTransformRotate(transform, -M_PI_2);
            break;
    }

    switch (image.imageOrientation) {
        case UIImageOrientationUpMirrored:
        case UIImageOrientationDownMirrored:
            transform = CGAffineTransformTranslate(transform, image.size.width, 0);
            transform = CGAffineTransformScale(transform, -1, 1);
            break;

        case UIImageOrientationLeftMirrored:
        case UIImageOrientationRightMirrored:
            transform = CGAffineTransformTranslate(transform, image.size.height, 0);
            transform = CGAffineTransformScale(transform, -1, 1);
            break;
    }

    // Now we draw the underlying CGImage into a new context, applying the transform
    // calculated above.
    CGContextRef ctx = CGBitmapContextCreate(NULL, image.size.width, image.size.height,
                                             CGImageGetBitsPerComponent(image.CGImage), 0,
                                             CGImageGetColorSpace(image.CGImage),
                                             CGImageGetBitmapInfo(image.CGImage));
    CGContextConcatCTM(ctx, transform);
    switch (image.imageOrientation) {
        case UIImageOrientationLeft:
        case UIImageOrientationLeftMirrored:
        case UIImageOrientationRight:
        case UIImageOrientationRightMirrored:
            // Grr...
            CGContextDrawImage(ctx, CGRectMake(0,0,image.size.height,image.size.width), image.CGImage);
            break;

        default:
            CGContextDrawImage(ctx, CGRectMake(0,0,image.size.width,image.size.height), image.CGImage);
            break;
    }

    // And now we just create a new UIImage from the drawing context
    CGImageRef cgimg = CGBitmapContextCreateImage(ctx);
    UIImage *img = [UIImage imageWithCGImage:cgimg];
    CGContextRelease(ctx);
    CGImageRelease(cgimg);
    return img;
} 
```

# asp.net - 将 QueryString 值传递给下拉框中的选定项目

> ID：11140607
> 
> 赞同：0
> 
> 时间：2012-06-21T14:41:04.157
> 
> 标签：asp.net, query-string

我正在尝试将项目 ID 从查询字符串传递给 ddb_projectList 以使项目被选中并填充 GridView 但我的问题是当页面加载时它选择了第一个附加项目。注意选择的值仍然 -1

谁能帮忙解决这个问题

* * *

代码：

```
 public partial class TasksInProjects : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            //get loged in user id UserID from MembershipUser 
            MembershipUser memberUser = Membership.GetUser();
            string StrUserID = memberUser.ProviderUserKey.ToString();
            Guid userID = Guid.Parse(StrUserID);
            hf_userID.Value = userID.ToString();

            if (Request.QueryString["projectID"] == null)
            {

                //ddl_projects.SelectedValue = Request.QueryString["projectID"];

                if (ddl_projects.SelectedValue != "-1")
                {

                    Guid projectID = Guid.Parse(ddl_projects.SelectedValue);
                    gv_TaskListForUser.DataSource = Task.GetTasksInProjectForUser(userID, projectID);
                    gv_TaskListForUser.DataBind();
                }

            }
            else
            {

                //ddl_projects.Visible = false;
                //Guid projectID = Guid.Parse(Request.QueryString["projectID"]);
                //gv_TaskListForUser.DataSource = Task.GetTasksInProjectForUser(userID, projectID);
                //gv_TaskListForUser.DataBind();

                ddl_projects.SelectedItem.Value = Request.QueryString["projectID"];
                Guid projectID = Guid.Parse(ddl_projects.SelectedItem.Value.ToString());
                gv_TaskListForUser.DataSource = Task.GetTasksInProjectForUser(userID, projectID);
                gv_TaskListForUser.DataBind();
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:43:42.553

试试这个：

```
ddl_projects.ClearSelection();
ddl_projects.Items.FindByValue(Request.QueryString["projectID"]).Selected = true; 
```

**附带说明**

我建议将其包装起来以防止发生错误。用户经常决定使用 URL。所以最好你做尽可能多的检查，以防他们决定摆弄！只是一个例子，因为验证完全取决于你想要实现的范围，但如果我是你，我至少会使用以下内容：

```
int projectID = 0;

// Check the query string is an integer
if (int.TryParse(Request.QueryString["projectID"], out projectID))
{
    // You could apply addition checks here, such as check that the project id is valid etc.
    ListItem projectItem = ddl_projects.Items.FindByValue(projectID.ToString());

    // if there is a project item with that value in the drop down list
    if (projectItem != null)
    {
        ddl_projects.ClearSelection();
        projectItem.Selected = true;
    }
}
else
{
    // do something, e.g. display friendly error message or whatever else is required
} 
```

# xml - 如何使用本机 Oracle XML DB Web 服务删除空值？

> ID：11140612
> 
> 赞同：1
> 
> 时间：2012-06-21T14:41:17.487
> 
> 标签：xml, web-services, oracle, oracle11g

我正在使用本机 Oracle XML DB Web 服务（使用带有 Web 服务的 PL/SQL 函数）。我想删除空值（在输出中什么都不放（没有 XML 元素））。它适用于 Oracle 11.2.0.1.0，但不适用于 Oracle 11.2.0.3.0。

澄清一下...我不想使用 PL/SQL 使用 Web 服务，我想将我的 PL/SQL 包/过程/函数发布为 Web 服务！

希望可以有人帮帮我。谢谢你。

在此示例中，列“国家”为空。

Oracle 11.2.0.1.0（这就是我想要的）：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
    <soap:Body>
  <GET_PERSONOutput xmlns="http://xmlns.oracle.com/orawsv/TESTSTUFF/GET_PERSON">
        <RETURN>
          <PERSON>
          <PERSON_ID>3</PERSON_ID>
          <FIRST_NAME>Harry</FIRST_NAME>
          <LAST_NAME>Potter</LAST_NAME>
        </PERSON>
      </RETURN>
    </GET_PERSONOutput>
  </soap:Body>
</soap:Envelope> 
```

甲骨文 11.2.0.3.0：

```
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <GET_PERSONOutput xmlns="http://xmlns.oracle.com/orawsv/TESTSTUFF/GET_PERSON">
     <RETURN>
        <PERSON>
           <PERSON_ID>3</PERSON_ID>
           <FIRST_NAME>Harry</FIRST_NAME>
           <LAST_NAME>Potter</LAST_NAME>
           <COUNTRY/>
        </PERSON>
     </RETURN>
    </GET_PERSONOutput>
  </soap:Body>
</soap:Envelope> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-18T18:50:21.813

使用 XMLFOREST 而不是 XMLELEMENT 将隐藏任何空数据的标签。

生成所需 SOAP 请求的示例查询如下所示：

```
SELECT XMLFOREST(XMLFOREST(p.id as "PERSON_ID",
                           p.first_name as "FIRST_NAME",
                           p.last_name as "LAST_NAME",
                           p.country as "COUNTRY"
                           ) as "PERSON")
   FROM PERSON_TABLE p WHERE p.id=3 
```

我不知道为什么，但 XMLELEMENT 在 XML 中留下了空标签。希望这对你有用！

补充：关于 XMLFOREST 与 XMLELEMENT 的有用文章 - [http://www.mandsconsulting.com/xmlforest-vs-xmlelement-missing-vs-empty-in-sqlx](http://www.mandsconsulting.com/xmlforest-vs-xmlelement-missing-vs-empty-in-sqlx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-01T09:27:37.790

To all people with the same problem:

I created a Oracle Service request for this problem and the Oracle support says:

> This does not exist for access via procedures/functions. Here the WSDL is driven from function definition which has no way to specify null behavior.

Hope this information is helpful for you.

# python - 如何在python中找到线阵列的声压级？

> ID：11140618
> 
> 赞同：4
> 
> 时间：2012-06-21T14:41:35.410
> 
> 标签：python, audio, matplotlib, contour

我想知道如何在python中找到线阵列的声压级？基本上我想根据与扬声器线阵列源的距离绘制一个显示 SPL 的轮廓。示例轮廓在这里：

![在此处输入图像描述](../Images/e3144ac5f1501a4065af73f0e2d218ba.png)

我得到的最接近的是这个片段：

```
import matplotlib.pyplot as plt
from pylab import linspace, meshgrid, sqrt, log

x = linspace(-30.0, 30.0, 15)
y = linspace(0, 30, 15)
X, Y = meshgrid(x, y)
Z = sqrt(X**2 + Y**2)

plt.figure()
CS = plt.contourf(Y, X, Z)
plt.show() 
```

我知道我想要的轮廓是由复杂的软件和方程式生成的，但接近的东西对我来说很好。

此链接可能会有所帮助，但我不知道如何使用此信息中的方程式获得该轮廓。 [http://personal.cityu.edu.hk/~bsapplec/transmis1.htm](http://personal.cityu.edu.hk/~bsapplec/transmis1.htm)

提前致谢， dksr

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-30T01:46:26.553

我所做的是在此代码段中创建两个小函数（lambda 函数），以根据您的参考文献中的公式 [8] 计算勾股距离和 SPL。

此外，因为指向性因子是通过实验确定的，所以我在这里简单地使用余弦作为代表性示例。您可以用给定角度 theta 和距离 r 的函数替换 Q 函数，并在给定实验结果的一些插值的情况下返回强度分数。

```
import matplotlib.pyplot as plt
from pylab import linspace, meshgrid, sqrt, log10, angle, cos

x = linspace(-30.0, 30.0, 15)
y = linspace(0, 30, 15)
X, Y = meshgrid(x, y)
#Z = sqrt(X**2 + Y**2)

def SPL(source_SPL, x, y, x1, y1, Q):
    '''Given a source sound pressure level, the x and y vectors describing
    the space, the x1 and y1 coordinates of the sound origin
    and a directivity factor function, return the SPL matrix'''
    #Using eqation 8 from the source
    dist = lambda x1, x2, y1, y2: sqrt((x1-x2)**2 + (y1-y2)**2)
    spl = lambda r, q: source_SPL - 20*log10(r) - 10*log10(q) - 11
    spl_matrix = []
    for y2 in y:
        # Create a new row
        spl_matrix.append([])
        for x2 in x:
            r = dist(x1, x2, y1, y2)
            theta = angle(complex(x2-x1, y2-y1))
            q = Q(theta, r)/float(source_SPL)
            # After calculating r and q, put them into the spl equation to get Db
            Db = spl(r, q)
            spl_matrix[-1].append(Db)
    return spl_matrix

Q = lambda theta, r: r*abs(cos(theta))
Z = SPL(1, x, y, 0.1, 0.1, Q)

plt.figure()
#Need to draw the contour twice, once for the lines (in 10 sections)
CS = plt.contour(Y, X, Z, 10, linewidths=0.5, colors='k')
#And again for the fills
CS = plt.contourf(Y, X, Z, 10)
plt.show() 
```

![在此处输入图像描述](../Images/1725ed7a7310d2d5705df1f6a7e353ea.png)

虽然我已经在不使用数组的情况下解决了这个问题，但您应该研究 numpy 以及如何向量化此代码，以便您不使用循环而是使用矩阵运算。然而，这与其说是一个代码问题，不如说是一个数学问题。

最后，如果你有工程学背景，你可以在计算机上运行这个实验，Q 函数根据环境条件计算相对强度。您需要更多地了解声音与周围环境的相互作用，您可能需要谷歌有限元分析和声压级

# java - 如何在 JAVA 中更改 serversocket 连接的回复端口

> ID：11140626
> 
> 赞同：1
> 
> 时间：2012-06-21T14:42:08.157
> 
> 标签：java, tcp, port, serversocket

我正在尝试为充当 TCP/IP 服务器的硬连线设备编写一个模拟器。
我有一个连接到该服务器并进行通信的 VB6 程序，但是这会间歇性地失败，我需要确定出了什么问题，所以我正在编写一个程序来模拟服务器。
我已经构建了以下 Java 程序来侦听来自 VB 程序的连接，并使用与服务器设备相同的信息进行响应。

```
public class ServerSim {

public static void main(String[] args){
    int port = 23;
    System.out.println("[Listening for Connection]");
    try{
        ServerSocket ss;
        ss = new ServerSocket(port);
        Socket s;

        // The program will wait here until a connection is made.
        s = ss.accept();

        // Print what client we're connected to.
        String client;
        client = s.getInetAddress().toString();
        String localPort = Integer.toString(s.getLocalPort());
        String portNo = Integer.toString(s.getPort());

        System.out.println("[Connected to "+client +"] Port:" + portNo + " localPort: " + localPort);

        //Set up Scanner / Writer to read / write data to client.
        Scanner in;
        //Scanner sc = new Scanner(System.in);

        in = new Scanner(s.getInputStream());
        PrintWriter out;
        out = new PrintWriter(s.getOutputStream(),true);

        PrintWriter log = openWriter("Log.txt");

        // Establish a 5second connection
        s.setSoTimeout(5000);

        try{
            boolean result = establishConnection(in, out);
            String input = in.nextLine();
            System.out.println("Recieved: " + input);
            String response = input;
            out.println(response);
            System.out.println("Responded: " + response);
            log.println(input + "->" + response);
       }
       catch(Exception e){
           System.err.println("EXC: "+e.getMessage());                   
           e.printStackTrace();                   
       }
       System.out.println("[Closing Connections]");
       in.close();
        out.close();
        log.close();
        s.close();
        ss.close();

    }catch(Exception e){
        e.printStackTrace();            
    }        
}
    private static boolean establishConnection(Scanner in, PrintWriter out){
        // we have a connnection - Start by outputtinga  welcome message.       
        out.print("Welcome Session 0\r\n");
        out.flush();            
        out.print("User:\r\n");
        out.flush();
        System.out.println("[Welcome sent - Waiting Response]");
        String input = in.nextLine(); // Recieve the first line.  Should be a User
        System.out.println("[Recieved '"+input+"' - Sending anticipated reply]");
        out.println("Password:");
        input = in.nextLine(); // Recieve the first line.  Should be a User
        System.out.println("[Recieved '"+input+"' - Sending anticipated reply]");
        out.println("User Logged in");      
        return true;
    }
   private static PrintWriter openWriter(String name){
        try{
            File file = new File(name);
            PrintWriter out = new PrintWriter(
                    new BufferedWriter(
                    new FileWriter(file, true)),true);
            return out;
        }
        catch(IOException e){
            System.out.println("I/O Error");
            System.exit(0);
        }
        return null;
    }

} 
```

问题是 VB ¹程序不会接受来自我的程序的输入。

我已经将成功设备的网络数据包捕获与我自己程序的流量捕获进行了比较，所有相关的内容都是相同的......*除了*回复端口。
在我的程序中，serversocket 随机分配一个端口来响应 VB6 程序，但是当 VB6 程序连接到我试图模拟的物理设备时，设备只回复端口 1602。

我的问题是，当我正在监听端口 23 进行连接时（这很好），我如何获得创建的套接字以在端口 1602 上回复而不是随机跳到 2000 - 3000 标记附近？

我能看到的所有回复和问题都围绕着套接字或多线程，而没有锁定等待连接的端口。
如果这不是一个观众，那么有人可以指出我想要实现的 UI 的更好解决方案吗？
*我知道有人会说为什么不使用实际设备设置钻机，但它们很昂贵，而且我没有准备好使用备用设备来设置钻机。那个，现在问题已经向我提出，我不禁要找出发生了什么！:-)*

*¹ **编辑：** 我无法询问 VB 程序，因为它使用一系列 ActiveX 与设备通信并处理协议。这就是我试图找到的问题的根源，所以我不想写出来。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T00:28:47.347

> “服务器套接字为响应随机分配一个端口”。

我不明白那个说法。被`Socket`接受的`ServerSocket`本地端口号为 23（与`ServerSocket`正在侦听的端口相同），以及由客户端在连接时确定的远程端口号。这不受服务器程序的控制。该设备可能只使用端口 1602 作为其输出端口，但 VB 程序几乎可以肯定让操作系统决定端口号。

我认为您需要根据这些信息重新分析您的观察结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:19:56.163

如果您想在端口 1602 上回复 vb-app（并且 vb-app 尚未在其一侧使用端口 1602），您将需要另一个（新）套接字。

```
ServerSocket.accept(); 
```

返回一个`java.net.Socket`。此连接由 4 个属性标识：client-port、client-ip、server-port、server-ip。

不是服务器（您的程序）随机分配（您所说的）回复端口，而是客户端（vb-app）。如果客户端不这样做，服务器将不知道它应该在哪里发送响应数据包。

您可能希望`java.net.Socket`使用 vb 应用程序的 ip 和端口 1602 创建一个 .vb 应用程序很可能充当客户端*和*服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T19:06:33.427

试试 java.net.Socket .. 我给你我的代码片段，我用它来模拟在指定端口上运行的服务器。我希望它对你有用......

```
import java.io.BufferedReader;

import java.io.IOException;

import java.io.InputStreamReader;

import java.io.PrintWriter;

import java.net.ServerSocket;

import java.net.Socket;

public class ServerTest {

    ServerSocket s;

    public void go() {

        try {
            s = new ServerSocket(44457);

            while (true) {

                Socket incoming = s.accept();
                Thread t = new Thread(new MyCon(incoming));
                t.start();
            }
        } catch (IOException e) {

            e.printStackTrace();
        }

    }

    class MyCon implements Runnable {

        Socket incoming;

        public MyCon(Socket incoming) {

            this.incoming = incoming;
        }

        @Override
        public void run() {

            try {
                PrintWriter pw = new PrintWriter(incoming.getOutputStream(),
                        true);
                InputStreamReader isr = new InputStreamReader(
                        incoming.getInputStream());
                BufferedReader br = new BufferedReader(isr);
                String inp = null;

                boolean isDone = true;

                System.out.println("TYPE : BYE");
                System.out.println();
                while (isDone && ((inp = br.readLine()) != null)) {

                    System.out.println(inp);
                    if (inp.trim().equals("BYE")) {
                        System.out
                                .println("THANKS FOR CONNECTING...Bye for now");
                        isDone = false;
                        s.close();
                    }

                }
            } catch (IOException e) {
                // TODO Auto-generated catch block
                try {
                    s.close();
                } catch (IOException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
                e.printStackTrace();
            }

        }

    }

    public static void main(String[] args) {

        new ServerTest().go();

    }

} 
```

# python - Django - 在带注释的查询中访问外键数据

> ID：11140628
> 
> 赞同：1
> 
> 时间：2012-06-21T14:42:09.323
> 
> 标签：python, django

我正在使用[django-relationships](https://github.com/coleifer/django-relationships)并且我正在按如下关注者数量过滤我的用户：

```
Relationship.objects.values('to_user').annotate(num_followers=Count('to_user')).order_by('-num_followers') 
```

它返回这样的东西

```
[{'to_user': 1, 'num_followers': 3}, {'to_user': 4, 'num_followers': 1}] 
```

我的问题是我需要访问我的 User 对象，而不仅仅是他们的`pk`. 现在我正在做这样的事情：

```
tu_list = []
for tu in top_users_set:
    tu_list.append({
        'top_user': User.objects.get(pk=tu['to_user']),
        'followers': tu['num_followers'],
    }) 
```

这是对每个用户进行查询。由于查询集最终可能有数百个用户，这可能非常糟糕。

任何有助于改善这一点的意见将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:11:39.563

如果您想要**用户**，则需要通过查询用户模型并加入关系来以相反的方式访问它。这是相关[文档](https://docs.djangoproject.com/en/dev/topics/db/aggregation/#joins-and-aggregates)

应该是这样的：

```
from django.db.models import Count

users = User.objects.annotate(num_followers=Count('to_users')).order_by('-num_followers') 
```

这将为您提供**用户**，他们每个人都将拥有一个额外的属性**num_followers**

*模型.py*

```
from django.contrib.auth.models import User
from django.db import models

class Relationship(models.Model):
    from_user = models.ForeignKey(User, related_name='from_users')
    to_user = models.ForeignKey(User, related_name='to_users') 
```

*测试*

```
>>> from so.models import *
>>> from django.contrib.auth.models import User
>>> u1 = User()
>>> u1.username='user1'
>>> u1.save()
>>> u2 = User()
>>> u2.username='user2'
>>> u2.save()
>>> u3=User()
>>> u3.username='user3'
>>> u3.save()
>>> # so we have 3 users now
>>> r1 = Relationship()
>>> r1.from_user=u1
>>> r1.to_user=u2
>>> r1.save()
>>> r2=Relationship()
>>> r2.from_user=u1
>>> r2.to_user=u3
>>> r2.save()
>>> r3=Relationship()
>>> r3.from_user=u2
>>> r3.to_user=u3
>>> r3.save()
>>> rels = Relationship.objects.all()
>>> rels.count()
3
>>> # we have 3 relationships: user1 follows user2, user1 follows user3, user2 follows user3
>>> users = User.objects.annotate(num_followers=Count('to_users')).order_by('-num_followers')
>>> for user in users:
>>>     print user.username, user.num_followers
user3 2
user2 1
user1 0 
```

**EDIT2**修正了错别字，添加了测试

# asp.net - 限制从asp.net中的webbrowser下载静态文件

> ID：11140632
> 
> 赞同：1
> 
> 时间：2012-06-21T14:42:21.520
> 
> 标签：asp.net

我有一个问题，我需要限制用户使用 url 从我的网站下载静态文件，如 .css 和 .js 文件。因为我已经创建了一个 httphandler，并且我已经编写了一些代码来将请求重定向到我的登录页面。它成功阻止了对 .js 文件的请求，但同时它不允许我的网站使用该 .js 文件。有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:45:27.127

我们可以使用 Http Module 来检查 URL 是否包含这些特定的扩展名。例如，我们在 App_code 文件夹中创建一个 http 模块，并在 web.config 中配置 http 模块：

```
namespace HttpUrlRewrite
{
    /// <summary>
    /// Summary description for HttpUrlRewrite
    /// </summary>
    public class Rewriter  : System.Web.IHttpModule
    {

        public void Init(System.Web.HttpApplication Appl)
        {
            Appl.BeginRequest += new System.EventHandler(Rewrite_BeginRequest);
        }

        public void Dispose()
        {
        }

        public void Rewrite_BeginRequest(object sender, System.EventArgs args)
        {
            System.Web.HttpApplication App = (System.Web.HttpApplication)sender;
            string path = App.Request.Path;

            string strExt = System.IO.Path.GetExtension(path);
            if (strExt == ".css")
            {
                //Do Something
                HttpContext.Current.Response.Redirect("error.aspx");
            }
            else
            {
                //Do Something
            }

        }
    }
}

                <httpModules>
                        <add type="HttpUrlRewrite.Rewriter" name="HttpUrlRewrite" />
                </httpModules> 
```

# javascript - 身份验证对话框打开但立即关闭

> ID：11140633
> 
> 赞同：1
> 
> 时间：2012-06-21T14:42:24.760
> 
> 标签：javascript, facebook, facebook-graph-api

我打算使用 PHP-SDK 发布用户自定义对象操作。PHP 方面的工作，但是当尝试使用 JavaScript SDK 在发布之前对用户进行身份验证时，我得到一个弹出加载，但随后立即关闭。它不会作为弹出窗口被阻止 - 它会加载但它会立即在各种浏览器中关闭。

注意：我在下面混合了 XFBML 和 HTML5 Like/Login，但是当它们使用相同的方法时也会发生这种情况。我正在使用自定义命名空间来定义 OG 中的页面，但我不确定这是否重要。

```
<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=MY_APP_ID";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

...

<fb:like send="false" width="450" show_faces="false"></fb:like>

...

<div class="fb-login-button" scope="publish_actions" data-show-faces="false" data-width="400" data-max-rows="1">Login with Facebook first to share your review.</div> 
```

我有应用程序设置，启用 Facebook 登录（虽然我只使用登录按钮来强制发布此自定义操作的权限）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T18:07:02.887

根据上面的评论，这似乎是因为我以已经拥有相关权限的用户身份登录。

# java - 如何从大型 excel 文件中复制整个工作表而不使用 Apache POI 解析它们？

> ID：11140635
> 
> 赞同：2
> 
> 时间：2012-06-21T14:42:31.517
> 
> 标签：java, excel, apache-poi, sax, saxparser

作为正式用户，我是新手，我总是在这里找到答案，但现在我必须问。

我正在使用最新的 apache-poi 3.8 版本（从 2012 年 3 月 26 日开始），我必须操作一个包含多个工作表的单个文件，其中只有一个包含大量数据（超过 1000 列和 10 000 行）。

我只需要在大表上有更多的列。因此，使用现有的工具，我应该使用 SAX 来读取它并使用 SXSSF 来重写它。

Excel 文件已经在每张工作表中使用不同的样式和图像进行了预格式化，因此能够在没有大工作表的情况下制作文件副本将很有帮助。

我的问题是：如何在不解析的情况下使用 SAX（从 中的输入流）制作工作表副本？我试图在[这里](http://www.coderanch.com/t/420958/open-source/Copying-sheet-excel-file-another)做类似的事情，但该字段`sheets`的`XSSFWorkbook`可见性设置为私有。

`SXSSFWriter.SheetIterator`如果它在 POI 开发人员的未来计划中，那么很棒的事情就是有类似的东西。

谢谢阅读，

亚瑟

******更新* *******

 **该文件太大，无法将其作为常见的 XSSFWorkbook (OutOfMemoryException) 打开。是否可以从 InputStream 创建和 XSSFSheet？如下所示：

```
 XSSFReader.SheetIterator iter = (XSSFReader.SheetIterator) xssfReader
            .getSheetsData();
    int index = 0;
    while (iter.hasNext()) {
        InputStream stream = iter.next();
        String sheetName = iter.getSheetName();
        if (!sheetName.equalsIgnoreCase("BigSheetThatIDontWant")) {
            Sheet newSheet = new XSSFSheet(stream);
            stream.close();
        }
        ++index;
    } 
```

非常感谢你的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:05:05.303

您将不得不阅读该文件。

关于第二个问题，请参阅 [public java.util.Iterator<XSSFSheet> XSSFWorkbook.iterator()](http://poi.apache.org/apidocs/org/apache/poi/xssf/usermodel/XSSFWorkbook.html#iterator%28%29)

```
Allows foreach loops:

 XSSFWorkbook wb = new XSSFWorkbook(package);
 for(XSSFSheet sheet : wb){

 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:16:39.897

在我使用 POI 和复制操作的整个经验中，我意识到，只要性能不重要，为了复制一张或多张工作表，加载整个工作簿、删除不必要的工作表然后将结果保存在另一个文件。

Andy 为迭代器 +1。**

# spring - Spring JDBC NullPointerException

> ID：11140636
> 
> 赞同：0
> 
> 时间：2012-06-21T14:42:32.757
> 
> 标签：spring, jdbc

我是第一次发帖，是 Spring 的初学者。我相信我已经掌握了基本概念，但是当我尝试编写自己的代码时遇到了一些错误。我做了功课，并查看了网站上的其他相关主题，但我仍然没有找到我的代码不起作用的原因。

如果我犯了任何愚蠢的错误，请原谅我。以下是我所有相关的代码片段：

DAO 接口

```
public interface TestDAO {

public int getId();

} 
```

主 SQL 连接代码

```
import javax.sql.DataSource;

import org.springframework.jdbc.core.simple.SimpleJdbcTemplate;
import org.springframework.jdbc.core.support.JdbcDaoSupport;

public class TestDb extends JdbcDaoSupport implements TestDAO{

private SimpleJdbcTemplate jdbcTemplate;

public int getId()
{
    String sql="SELECT DOI.DOI_ID FROM ***.DOI where DOI='test58'";
    int id=jdbcTemplate.queryForInt(sql);
    return id;
}

public void createTemplate(DataSource dataSource) {
    this.jdbcTemplate = new SimpleJdbcTemplate(dataSource);
}

} 
```

beans.xml 文件

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-2.5.xsd">

  <bean id="webMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
    <property name="mappings">
        <props>
            <prop key="/Form.html">DoiEntry</prop>
        </props>
    </property>
</bean>

<bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/WEB-INF/jsp/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean>

<bean name="DoiEntry" class="com.****.****.DoiEntry">
    <property name="eventsService" ref="eventsService"/>
    <property name="sendEventsQueueService" ref="sendEventsQueueService"/>
</bean>

<bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate"> 
    <property name="dataSource" ref="dataSource"/> 
</bean>

<bean id="dataSource"        class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="oracle.jdbc.OracleDriver" />
    <property name="url" value="jdbc:oracle:thin:@localhost:1521:XE" />
    <property name="username" value="**USER**" />
    <property name="password" value="**PASSWORD**" />
</bean>

<bean id="testDAO" class="com.****.****.TestDAO">
    <property name="dataSource" ref="dataSource" />
</bean>

<bean id="testDb" class="com.****.****.TestDb">
    <property name="dataSource" ref="dataSource" />
</bean>

</beans> 
```

最后，我的 web.xml 文件

```
<?xml version="1.0" encoding="ISO-8859-1" ?>

<web-app xmlns="http://java.sun.com/xml/ns/j2ee"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"
version="2.4">

<display-name>DOILookupApp</display-name>
<description>
    This is a simple web application with a source code organization
    based on the recommendations of the Application Developer's Guide.
</description>

<servlet>
    <servlet-name>DOILookup</servlet-name>
    <servlet-class>com.****.****.DoiLookup</servlet-class>
</servlet>

<servlet-mapping>
    <servlet-name>DOILookup</servlet-name>
    <url-pattern>/DOI</url-pattern>
</servlet-mapping>

<taglib>
<taglib-uri>
    functions.tld
</taglib-uri>
<taglib-location>
    functions.tld
</taglib-location>
</taglib>

    <!-- The main spring MVC servlet -->
<servlet>
   <servlet-name>spring</servlet-name>
   <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
   <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>beans.xml</param-value>
    </init-param>
   <load-on-startup>1</load-on-startup>
</servlet>

</web-app> 
```

这是我用来在网页中查看的 JSP 文件。忽略 srciptlet，我知道它们是不好的编码习惯，我只需要一些东西来测试。

```
<%@ page language="java" import="java.util.*, java.sql.*;" %>

<html>
<head>
<title>Test DB</title>
</head>
  <body>

<jsp:useBean id="testDb" scope="session" class="com.****.****.TestDb"/>

<% 
  int output=testDb.getId();
  out.print("DOI ID for test58 is: ");
  out.print(output);

%>

  </body>
</html> 
```

最后，这是我的错误信息

类型异常报告

信息

```
description The server encountered an internal error () that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: java.lang.NullPointerException
org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:502)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:430)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
root cause

java.lang.NullPointerException
com.****.****.TestDb.getId(TestDb.java:15)
org.apache.jsp.jsp.testDb_jsp._jspService(testDb_jsp.java:78)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:388)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 
```

我知道要查看很多代码，但提前感谢您的所有帮助。

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:57:00.623

我猜你`jdbcTemplate`是空的，因为它没有被注入。你的`createTemplate`方法不会被调用。

您应该使用由 提供的实例`JdbcDaoSupport`。删除`createTemplate`方法和`jdbcTemplate`实例并将您的`getId`方法替换为：

```
public int getId()
{
    String sql="SELECT DOI.DOI_ID FROM ***.DOI where DOI='test58'";
    int id=getJdbcTemplate().queryForInt(sql);
    return id;
} 
```

如果您实际上是在尝试覆盖父方法，则称为`createJdbcTemplate`.

或者，完全忘记扩展`JdbcDaoSupport`，因为它并没有真正增加太多。相反，您可以将 a`DataSource`直接注入您自己的 bean 并创建模板实例。使用构造函数注入：

```
public class TestDb {
    private final JdbcTemplate template;

    public TestDb(DataSource ds) {
        template = new JdbcTemplate(ds);
    }
} 
```

应用上下文中的 bean 看起来像这样：

```
<bean id="testDAO" class="com.****.****.TestDb">
    <constructor-arg  ref="dataSource" />
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:52:49.437

`TestDb.createTemplate(DataSource dataSource)`将签名更改为并重`TestDb.setDataSource(DataSource dataSource)`试。你会得到 NPE，因为 createTemplate 方法从未被调用过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:52:58.770

你需要在你的 DAO 上使用这个方法：

```
public void setDataSource(DataSource dataSource) {
        this.jdbcTemplate = new SimpleJdbcTemplate(dataSource);
    } 
```

由于您必须创建 JdbcTemplate 的方法永远不会运行，这就是您得到空指针异常的原因。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T14:52:16.323

您需要使用 JdbcDaoSupport 提供的 JdbcTemplate 而不是在私有字段中拥有自己的。您可以通过 JdbcDaoSupport 的 getJdbcTemplate() 方法访问它。

此外，您不能使用 jsp:useBean 访问 Spring bean。相反，您调用控制器中的 bean（使用 Spring WebMVC）并将结果发送到 JSP。

在[这个](http://forum.springsource.org/archive/index.php/t-33482.html)论坛中，他们讨论了一种在没有 Spring MVC 的情况下访问 bean 的方法。

# wolfram-mathematica - Mathematica：使用用户定义的函数进行简化

> ID：11140643
> 
> 赞同：0
> 
> 时间：2012-06-21T14:43:01.703
> 
> 标签：wolfram-mathematica

输入：

```
f[x_] := Sqrt[x^2 + y^2]
f'[x] 
```

输出：

```
x / Sqrt[x^2 + y^2] 
```

**如何让 Mathematica 自己替换分母`f[x]`？**（注意：这是一个更复杂的微分问题的简单示例，其中函数本身很复杂，但在导数中出现了很多。）

也就是说，**期望的输出**是：

```
x / f[x] 
```

我试过了

```
Simplify[f'[x], TransformationFunctions -> {f}] 
```

但无济于事。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T00:37:26.583

我认为你可以这样做：

```
Clear[f,g]
g[expr_]:=expr/.(x_^2+y_^2):> (f[x])^2
Simplify[D[Sqrt[x^2+y^2],x],TransformationFunctions->{Automatic,g},Assumptions->f[x]>0] 
```

结果它会给出`x/f[x]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T16:37:04.420

我认为一般来说很难做到这一点。在您的具体示例中，可以使用诸如

```
rules = {z_^2 + y^2 -> Hold[f[z]^2]}; 
```

接着

```
f'[x] /. rules

(* x/Sqrt[Hold[f[x]^2]] *)

f''[x] /. rules

(* -(x^2/Hold[f[x]^2]^(3/2)) + 1/Sqrt[Hold[f[x]^2]] *) 
```

使用平方根比较困难，我认为一个规则是不够的，基本原因是：

```
Sqrt[x^2 + y^2] // FullForm
1/Sqrt[x^2 + y^2] // FullForm 
```

# flash - 使用 Flex 在网站上自动填写数据？

> ID：11140645
> 
> 赞同：0
> 
> 时间：2012-06-21T14:43:04.193
> 
> 标签：flash, apache-flex, adobe

我正在使用 URLLoader 和 URLRequest 加载网站并从 URLRequest 中检索 pdf 文件。为了访问 pdf 文件，我需要选择微调器中的特定项目，填写 TextInput，选择微调器的日期，单击按钮等。

这有可能以编程方式做到这一点吗？我的意思是我想自动填写所有这些信息并立即获取 pdf 文件。

如果是这样，任何人都可以提供一个示例或教程吗？谢谢您的帮助。

# mysql - MySQL - CONCAT 两个字段并在 WHERE 子句中使用它们

> ID：11140647
> 
> 赞同：9
> 
> 时间：2012-06-21T14:43:06.373
> 
> 标签：mysql, string-concatenation

正如标题所示，我想知道如何在in 中设置`concat`两个字段。这是我想要实现的一个例子：`where clause``mysql`

```
SELECT CONCAT_WS(' ', first_name, last_name) AS name FROM `users`
WHERE name LIKE "%John Doe%" 
```

关键是`first_name`和`last_name`是单独的字段，我想让我的`PHP`应用程序能够搜索完整的人名。

有小费吗？

干杯!

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T14:49:30.660

尝试这个 ：：

```
SELECT CONCAT_WS(' ', first_name, last_name) AS name FROM `users`
WHERE CONCAT_WS(' ', first_name, last_name) LIKE "%John Doe%" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:50:44.630

pick up the users as view then query outside select query

```
select name from (select first_name||last_name FROM `users`
    WHERE frst_name LIKE "%John%" or last name like "%doe%") where name like '%John Doe%' 
```

# r - R 替换矩阵中的 NA

> ID：11140650
> 
> 赞同：1
> 
> 时间：2012-06-21T14:43:15.220
> 
> 标签：r

在 RI 中有一个带有一些缺失值的数据框，因此该`read.table()`函数使用`NA`s 而不是空白单元格。

我写了这个：

```
a <- sample(1000:50000000, size=120, replace=TRUE)
values <- matrix(a, nrow=6, ncol=20)
mtx <- cbind.data.frame(values, c(rep(NA),6))
mtx <- apply(mtx, 2, function(x){
    if (x==NA) sample(100:500, replace=TRUE, size=nrow(mtx)) else (x)}) 
```

但我有这个错误：

```
Error in if (x == NA) sample(100:500, replace = TRUE, size = nrow(mtx)) else (x) : 
  missing value where TRUE/FALSE needed
In addition: Warning message:
In if (x == NA) sample(100:500, replace = TRUE, size = nrow(mtx)) else (x) :
  the condition has length > 1 and only the first element will be used 
```

有任何想法吗？

最好的里卡多

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T14:52:37.517

由于值存在或缺失的原因，您无法测试是否`NA`使用比较运算符。是以 的形式识别缺失的适当函数。`NA``is.na()``NA`

`NA`这是在矩阵中替换的示例`values`。这里的关键是以矢量化方式工作，只需确定哪些元素`NA`随后被索引，以将所有元素替换为`NA`您需要的值。

```
> set.seed(2)
> values <- matrix(sample(1000:50000000, size=120, replace=TRUE),
+                  nrow=6, ncol=20)
> ## add some NA to simulate
> values[sample(120, 20)] <- NA
> 
> ## how many NA
> (tot <- sum(is.na(values)))
[1] 20
> 
> ## replace the NA
> values[is.na(values)] <- sample(100:500, tot, replace=TRUE)
> 
> ## now how many NA
> (sum(is.na(values)))
[1] 0 
```

# architecture - 在线预订系统架构？

> ID：11140652
> 
> 赞同：-2
> 
> 时间：2012-06-21T14:43:36.977
> 
> 标签：architecture, system

我是一名 IT 学生。我有以下与架构相关的问题。

“设计一个假期预订系统。客户应该能够通过提供日期和目的地（国家、城市、酒店）来在线预订假期酒店房间。

客户必须通过信用卡付款才能进行预订（为此使用单独的第三方支付网关）。

该系统将来应该可以扩展，包括航班和旅行预订。

提供了许多其他细节。（<==这部分我们必须假设）“

问题不是很丰富，我知道。但是我们可以假设任何不清楚的地方。

可以用客户端服务器架构模式来完成吗？你能为此建议一个合适的架构模式吗？专门提供扩展能力？（非常感谢您能提供一些有用的文章）在设计这样的系统时需要确定我应该考虑哪些系统方面。（我知道安全性和可扩展性，还有其他非功能性需求吗？）我还需要识别可能对设计系统至关重要的缺失信息。如果您能指出一些我可以使用的资源，那将不胜感激。

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-06-22T17:12:41.370

因为预订将是购物以下链接可能会对您有所帮助！ [http://www.uml-diagrams.org/examples/online-shopping-example.html](http://www.uml-diagrams.org/examples/online-shopping-example.html)

找到另一个使用 webservices 来执行此操作但不使用 hv uml :)

[http://www.w3.org/2002/06/ws-example](http://www.w3.org/2002/06/ws-example)

# facebook - 使用具有自定义布局的 Facebook 注册

> ID：11140655
> 
> 赞同：0
> 
> 时间：2012-06-21T14:43:40.173
> 
> 标签：facebook, facebook-graph-api, registration, facebook-social-plugins

我在我的应用程序中使用 Facebook 注册。是否可以在（注册/Facebook 登录）中使用自定义布局而不是 Facebook 布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:09:01.390

您不能更改插件的布局，只能更改边框颜色。这样做的原因是 Facebook 用户可以识别插件并知道会发生什么。

如果您想要自定义布局，请使用 Facebook Connect 并创建您自己的表单并从用户的 Facebook 个人资料中预加载您可以加载的任何数据。

# c# - c#通过正则表达式提取url

> ID：11140658
> 
> 赞同：0
> 
> 时间：2012-06-21T14:43:48.880
> 
> 标签：c#, .net, regex

> **可能重复：**
> [用于解析网页链接的正则表达式？](https://stackoverflow.com/questions/6173/regular-expression-for-parsing-links-from-a-webpage)

如何使用正则表达式从 HTML 中找到所有 url。我只需要页面的 url，所以我想添加排除以“.css”或“.jpg”或“.js”等结尾的 url。

HTML 示例：

```
<a href=index.php?option=content&amp;task=view&amp;id=2&amp;Itemid=25 class="menu_selected" id="">Home</a> 
```

或者

```
<a href="http://data.stackexchange.com">data</a> |
                <a href="http://shop.stackexchange.com/">shop</a> |
                <a href="http://stackexchange.com/legal">legal</a> | 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:50:25.007

If you can, avoid using Regular Expressions, but instead use a proper HTML parser. For example, reference the [HTML Agility Pack](http://htmlagilitypack.codeplex.com/), and use the following:

```
var doc = new HtmlDocument();
doc.LoadHtml(yourHtmlInput);
foreach (HtmlNode link in doc.DocumentNode.SelectNodes("//a[@href]")
                              ?? Enumerable.Empty<HtmlNode>())
{
    string href = link.Attributes["href"].Value;
    if (!String.IsNullOrEmpty(href))
    {
        // Act on the link here, including ignoring it if it's a .jpg etc.
    }
} 
```

# java - 比较数组并比较两个数组中的每个元素

> ID：11140665
> 
> 赞同：2
> 
> 时间：2012-06-21T14:44:37.427
> 
> 标签：java, arrays, object

我是java新手。请帮帮我。

我想比较 Array 对象，以及两个数组中的每个元素。那么我应该用什么来检查它们是否相同：`equals`,`deepEquals`或`compareTo`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:52:46.497

我不确定我是否理解您的问题，但也许这会对您有所帮助。

`Arrays.equals(array1, array2)`与一维数组一起使用，例如`int[10]`. `Arrays.deepEquals(array1,array2)`用于一维或多维数组，例如`int[2][4]`. 根据您要比较的数组的维数选择一个。

## 编辑

您的评论代码无法编译，但我开始理解您的问题。您需要知道**数组是对象**，默认情况下它们在`equals(Object obj)`方法中返回`this == obj`。这意味着它们不会通过存储在其中的值来比较数组，而只会检查来自其他对象`obj`（其他数组）的引用是否包含对您正在比较的同一数组的引用（`this`）。

你可以这样检查

```
Integer[] a1=new Integer[2];
Integer[] a2=new Integer[2];
for (int i=0; i<2; i++){
    a1[i]=i;
    a2[i]=a1[i];
}
System.out.println(a1.equals(a2));//false 
```

但是当我从equals更改`i2`对点数组的引用时，将返回`i1``true`

```
a2=a1;//now my i2 reference points array from i1
System.out.println(a1.equals(a2));//true 
```

要比较数组中的元素，您需要遍历数组。您可以编写自己的代码来执行此操作，也可以使用现成的方法为您执行此操作。Java 在 class 中提供了这样的方法`java.util.Arrays`，但没有人阻止您使用其他库，如 Apache Commons -> ArrayUtils 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:48:15.540

正如 api 所说， ArrayUtils.equals 进行了浅比较。Arrays/ArrayUtils.deepEquals 进行深度比较... << 这可能是您想要的（deepEquals），除非您有理由只想要浅比较

# c++ - 过时函数的标准 COM HRESULT 是什么？

> ID：11140666
> 
> 赞同：3
> 
> 时间：2012-06-21T14:44:37.360
> 
> 标签：c++, com, vb6

我正在做一个 VB6 项目。我想让一些方法过时。删除方法体后，想法是引发标准 COM 错误，例如

```
Err.Raise E_NOTIMPL 
```

在这种情况下，我使用的是标准的“方法未实现”错误，但这并不是我想要返回的正确消息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T16:00:37.750

如果这些方法仍然有效，但已被弃用，请将它们保留，并在 IDL 中将它们标记为隐藏和不可浏览，并在帮助字符串中添加适当的注释。这对开发人员隐藏了它们。

如果它们不再起作用，那么理论上你需要一个新的 CLSID，因为你已经违反了合同。

如果它们不再工作，*但没有客户实际使用它们*，那么您可以使用 E_NOTIMPL - 这将是合适的。（也将它们标记为隐藏并添加一个帮助字符串解释。）

但是请注意，如果调用者**正在**调用该方法，那么无论您返回 E_NOTIMPL 还是创建新的 clsid 并重新编译它们，它们都会被破坏。

# objective-c - 如果CAlayer在动画中移动，如何检测被触摸的CAlayer

> ID：11140667
> 
> 赞同：1
> 
> 时间：2012-06-21T14:44:38.113
> 
> 标签：objective-c, ios, animation, touchesmoved

我想检测我的哪个 CALayer 被轻扫了。这些 CALayer 正在通过 CGPath 并且它们也在旋转。我尝试在我的视图控制器中使用 touchesMoved 检查哪个 CALayers 包含以下内容：

```
 for (UITouch* t in touches) {
        CGPoint point=[t locationInView:self.view];
        for (int i=0; i<[layers count]; i++) {
            if ([[layers objectAtIndex:i] containsPoint:[myLayer convertPoint:point toLayer:[layers objectAtIndex:i]]]){
                doSomething
                }

            }

        } 
```

它没有用。好像 CALayer 总是在动画之前的位置。

我还尝试使用 touchesMoved 对 UIImageView 进行子类化，然后为这些 UIImageView 的 CALayer 设置动画。同样的事情也发生在我身上。我已经为 CALayer 设置了动画，因为我不知道如何为 UIImageView 设置动画以跟随 CGPath。

我能做些什么？

非常感谢您。

# .net - 为什么 DateTime.Now.Year 是 int 而不是 ushort

> ID：11140669
> 
> 赞同：7
> 
> 时间：2012-06-21T14:44:47.610
> 
> 标签：.net, types

在 .Net 框架的 DateTime 结构中，Year 被定义为一个 int（实际上是 A System.Int32）。但是，MSDN 文档说该值将始终[介于 1 和 9999 之间](http://msdn.microsoft.com/en-us/library/system.datetime.year.aspx)。因此，ushort (System.UInt16) 足以存储值并占用一半的空间。那么为什么它是 int 而不是 ushort 呢？

存在从 ushort 到 int 的隐式转换，因此不需要进行强制转换来对 Year 进行整数运算。

我意识到这是一个微优化问题，因此不是很重要。我只是好奇。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:46:54.433

> 因此，ushort (System.UInt16) 足以存储值并占用一半的空间。

你认为“空间”在哪里被浪费了？`DateTime`无论如何都不会将每个组件存储在单独的字段中。如果*您*将年份存储在某个地方，请随意将其转换为`ushort`- 并`Month`转换为 a`byte`等。

请注意，这`ushort`不符合 CLS，这可能是它的原因。有*很多*属性对于未签名是有意义的，例如`string.Length`等......但框架会尽可能地符合 CLS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:51:41.587

*   unit 返回一个无符号的 16 位整数
*   Int 返回一个 32 位整数。

我假设 JIT 编译器利用 CPU 架构，因此 32 位的处理将比 16 位更有效。我相信在使用整数与长整数（分配的字节数与架构速度）时，VB6 也存在类似的争论。

[http://blogs.msdn.com/b/davidnotario/archive/2005/08/15/451845.aspx](http://blogs.msdn.com/b/davidnotario/archive/2005/08/15/451845.aspx)

# ios - UIKeyboardWillShow/WillHide 通知，如何知道这些通知何时发送给注册的观察者

> ID：11140674
> 
> 赞同：1
> 
> 时间：2012-06-21T14:45:07.330
> 
> 标签：ios, uiview, uitableview, nsnotificationcenter

我有一个子类，为and`UIView`添加了一个观察者。这是在一个子类中。我还有另外两个包含. 当这些文本字段被点击时，我的自定义会收到这些通知。我为电子邮件编写器视图类型设置了这三个子类。`UIKeyboardWillShowNotification``UIKeyboardWillHideNotification``UIView``UITableViewCell``UITableViewCell``UITextFields``UIView``UITableViewCell`

我如何确保当我的`UIView`子类收到键盘时，它会显示或隐藏通知，它是针对包含 ui 文本字段的`UIView`而不是针对其他的？`UITableViewCell's`

我应该提到我的 UIView 子类中有一个 UIWebView。当点击 contenteditable div 时，我想收到键盘出现的通知，但仅适用于我的 UIWebView 实例。

我在想我可以做以下事情，但这似乎不起作用。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector@(selector(keyboardWillShow:) name:UIKeyboardWillShowNotification object:_webView]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:57:20.340

我认为这取决于您需要什么`UIKeyboardNotification`，您可以通过以下方式实现相同的目标：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField 
```

查看编辑何时开始。这可以查看编辑何时结束：

```
- (void)textFieldDidEndEditing:(UITextField *)textField 
```

不要忘记您`UITableViewCells`必须遵守`UITextFieldDelegate`协议。

[关于`UITextFieldDelegate`协议](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html)的快速参考。

* * *

**编辑：**还有一件事，当您需要知道特定人员何时`UITextField`成为第一响应者时，我给您的解决方案是有意义的。如果您不关心这一点，而您只需要知道键盘何时真正来来去去，您应该通知`UIViewController`有您的`UITableView`而不是每个单独的单元格。然后`UIViewController`应该采取适当的行动。

# dynamics-crm-2011 - CRM 2011 示例 - 帐号生成错误

> ID：11140676
> 
> 赞同：0
> 
> 时间：2012-06-21T14:45:08.770
> 
> 标签：dynamics-crm-2011

我正在尝试编写我的第一个 Dynamics Crm 2011 插件。

因此，我下载了 CRM11 sdk 并查看了插件示例。我终于使用提供的工具安装并注册了我的第一个插件（至少对我而言，该插件的学习曲线相当陡峭）。

我从基础开始，编译了示例中提供的“帐号插件”，并使用了注册工具。全部报告为已成功安装，但在创建新帐户时，生成的帐号根本没有显示。我最初认为插件没有正确安装，但在注意到如果帐号已经存在代码会引发错误后，我开始尝试让插件引发错误。这是第一次工作，所以我很高兴安装正确。

查看示例代码后，我不知道如何将生成的帐号保存回 Dynamis Crm。

```
// An accountnumber attribute should not already exist because it is system generated.

if (entity.Attributes.Contains("accountnumber") == false)    
{    
    // Create a new accountnumber attribute, set its value, and add
    // the attribute to the entity's attribute collection.

    Random rndgen = new Random();  
    entity.Attributes.Add("accountnumber", rndgen.Next().ToString());    
}    
else     
{    
    // Throw an error, because account numbers must be system generated.    
    throw new InvalidPluginExecutionException("The account number can only be set by the system.");    
} 
```

查看其他一些示例，我注意到一些额外的代码似乎被调用来创建新实体。我对此进行了调整并将其复制到新的帐号代码中，部署并按预期生成了帐号。

```
IOrganizationServiceFactory serviceFactory  = (IOrganizationServiceFactory)

    serviceProvider.GetService(typeof(IOrganizationServiceFactory));

IOrganizationService service = serviceFactory.CreateOrganizationService(context.UserId);

service.Update(entity); // Originally - service.Create(entity); 
```

这是示例代码中的错误还是我做错了什么？如果不需要此代码，实体何时将其更改提交到数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:59:15.660

刚刚解决了。您需要将此插件注册为“预操作”步骤。

这将教会我将注册工具保留为默认值。将其设置为“预操作”时，实体的设置会在保存前更改。因此，您无需再次调用 save。

# html - 使用 sql mail 格式化 html 表

> ID：11140679
> 
> 赞同：1
> 
> 时间：2012-06-21T14:45:19.620
> 
> 标签：html, sql, sql-server

我目前正在使用存储过程在表格中发送包含用户发票的电子邮件。我遇到的问题是，当发票行数达到一定数量时，它将不再打印。例如 - 我们有一个供应商有 50 张发票，但只打印了 37 张。有没有办法让表格超出这个范围？谢谢你的帮助！

这是存储过程中当前使用的代码：

```
USE [CMSOPEN]
GO
/****** Object:  StoredProcedure [dbo].[_HM_EXPENSE_EMAIL]    Script Date: 06/21/2012 10:15:02 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[_HM_EXPENSE_EMAIL] (@schedule_num int = 0)
AS

If @schedule_num = 0 return -1

select a.source_tran_uno, v.vendor_id, n.name remit_name, 
    IsNull(n.internet_addr, 'ap@honigman.com') internet_addr, p.car_phone, 
    addr.address1, addr.city, addr.state_code,
    c.check_num, c.check_date, c.request_num,
    i.invoice_num, i.invoice_date,
    c.chk_amt, a.ap_amt * a.sign * -1 as invoice_amt, isnull(left(t.txt1, 500), '') as comment
into #t1
from apt_invoice_amt a inner join apt_check c on a.source_Tran_uno = c.tran_uno
inner join hbm_address addr on c.address_uno = addr.address_uno
inner join apt_invoice i on a.inv_tran_uno = i.tran_uno
inner join apm_vendor v on a.remit_vend_uno = v.vendor_uno
inner join hbm_name n on v.name_uno = n.name_uno
inner join apt_text t on i.text_id = t.text_id
inner join HBM_NAME_PEOPLE p on n.PEOPLE_NAME_UNO = p.name_uno
WHERE c.SCHEDULE_NUM = @Schedule_num
and i.aptype_code = 'EXPREM'

update #t1
set internet_addr = 'ap@honigman.com'
where internet_addr = ''

SET NOCOUNT ON

Declare @HTML varchar(6000), @table VARCHAR(MAX), @source_tran_uno int, @check_date datetime, @chk_amt money, @remit_name varchar(120), 
    @vendor_id varchar(16), @city varchar(30), @state_code varchar(2), @internet_addr varchar(80),@sec_email varchar(80), @request_num int

DECLARE ach_cursor CURSOR FOR 
select distinct source_tran_uno, check_date, chk_amt, remit_name, rtrim(vendor_id), city, state_code, internet_addr, car_phone, request_num
from #t1 t
order by remit_name
OPEN ach_cursor

FETCH NEXT FROM ach_cursor 
INTO @source_tran_uno, @check_date, @chk_amt, @remit_name, @vendor_id, @city, @state_code, @internet_addr, @sec_email, @request_num

WHILE @@FETCH_STATUS = 0
BEGIN

Select @HTML =  '<H1>Expense Report Payment Advice</H1>' +
                '<BR>Date: ' + convert(varchar(10), IsNull(@check_Date, ''), 101) + '<BR>' +
                '<B>Total: $' + Cast(@Chk_Amt as varchar(15)) + '</B><BR><BR>' +
                IsNull(@remit_name, '') + '<B>(' + IsNull(@Vendor_ID, '') + ')</B><BR>' +
                '<BR><BR>' +
                'Payment for the following expense report(s) have been included as part of your payroll deposit <BR><BR>' 

SET @table =

    '<TABLE border=1 cellpadding=5>' + 
    '<tr><th width=100 align=center><B>Expenditure Date</B></th><th width=100 align=center><B>Expense Processing Date</B></th><th width=100 align=center><B>Amount Paid</B></th><th width=250 align=center><B>Reimbursement Narrative</B></th></tr>' +
CAST ( (
select td = invoice_num, '',
td = convert(varchar(10), invoice_date, 101), '',
td = '$' + convert(varchar(12), invoice_amt, 1), '',
td = comment 
from #t1 t
where t.source_Tran_uno = @source_tran_uno
              FOR XML PATH('tr'), TYPE 
    ) AS NVARCHAR(MAX) ) +
    N'</table>' ;
--select @internet_addr
--select @HTML 
--select @table
set @HTML = @HTML + @table
--select @html
-- Email delimiter must be semicolon
EXEC msdb.dbo.sp_send_dbmail @profile_name = 'Accounting ACH Notification', @recipients = @internet_addr, @copy_recipients = @sec_email, @blind_copy_recipients = 'AP@honigman.com',  

--EXEC msdb.dbo.sp_send_dbmail @profile_name = 'Accounting ACH Notification', @recipients='AP@honigman.com', @blind_copy_recipients = 'mmurawski@honigman.com',
    @subject = 'Payment Advice from Honigman Miller' ,
    @body = @HTML,
    @body_format = 'HTML' ;

-- Get the next Billing Attorney.
FETCH NEXT FROM ACH_cursor 
INTO @source_tran_uno, @check_date, @chk_amt, @remit_name, @vendor_id, @city, @state_code, @internet_addr, @sec_email, @request_num
END 
CLOSE ACH_cursor
DEALLOCATE ACH_cursor

drop table #t1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:46:54.653

在声明中：

```
@HTML varchar(6000) 
```

够了吗？

# objective-c - 如何在 C 或目标 C 中的 IP/UDP 数据包中构建、格式化我自己的数据包？

> ID：11140680
> 
> 赞同：0
> 
> 时间：2012-06-21T14:45:23.970
> 
> 标签：objective-c, c, sockets, udp

我必须与一个在端口上侦听所有传入 IP/UDP 连接的设备进行通信，以太网帧携带 ip/udp 数据包，而该数据包又必须携带我自己的数据包，比如自己的数据包，如下所示

```
|    first field              |   second field   |  third field  | fourth field |
|2byte message sequence number|1byte message type| Reserved field| Message Data | 
```

如何使用这些作为我的数据包数据创建我的自定义数据包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:47:07.243

1.  在数据报模式下创建一个新套接字。
2.  将您的内容格式化为缓冲区。
3.  将缓冲区写入套接字。

# module - Yii 无法在管理模块中找到操作登录

> ID：11140683
> 
> 赞同：0
> 
> 时间：2012-06-21T14:45:28.397
> 
> 标签：module, yii

看下面的代码

```
<?php

class DefaultController extends Controller
{

    public function actionIndex()
    {
        $this->render('index');
    }

    /**
     * Displays the login page
     */
    public function actionLogin()
    {
        $model = new LoginForm;

        // collect user input data
        if (isset($_POST['LoginForm']))
        {
            $model->attributes = $_POST['LoginForm'];
            // validate user input and redirect to the previous page if valid
            if ($model->validate() && $model->login())
                $this->redirect(Yii::app()->user->returnUrl);
        }
        // display the login form
        $this->render('login', array('model' => $model));
    }

    public function filters()
    {
        return array(
            'accessControl',
        );
    }

    public function accessRules()
    {
        return array(
            array('allow', // allow all users to perform the 'login' action
                'actions' => array('login'),
                'users' => array('*'),
            ),
            array('allow', // allow the admin user to perform everything
                'actions' => array('*'),
                'users' => array('@'),
            ),
            array('deny', // deny all users
                'users' => array('*'),
            ),
        );
    }

} 
```

问题是，当我转到我的模块时：`/?r=admin`我被重定向到`/?r=site/index`我的默认站点控制器。

这怎么可能发生？

编辑：（添加 AdminModule）

```
<?php

class AdminModule extends CWebModule
{

    public function init()
    {
        // this method is called when the module is being created
        // you may place code here to customize the module or the application
        // import the module-level models and components
        $this->setImport(array(
            'admin.models.*',
            'admin.components.*',
        ));

        $this->setComponents(array(
            'user' => array(
                'loginUrl' => Yii::app()->createUrl('admin/default/login'),
            )
        ));
    }

    public function beforeControllerAction($controller, $action)
    {
        if (parent::beforeControllerAction($controller, $action))
        {
            // this method is called before any module controller action is performed
            // you may place customized code here

            return true;
        }
        else
            return false;
    }

} 
```

如您所见，我通过 setComponents 添加了 loginUrl，但这也不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:57:12.070

如果您没有登录用户，访问控制过滤器将启动并将您重定向到“家”。您可以在控制器上执行的唯一操作是“登录”，因此 index 是被拒绝操作的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-22T07:24:36.390

```
class MyModule extends CWebModule
{

    public function init()
    {

        ...

        Yii::app()->setComponents(array(
            'user'=>array(
                'class'=>'CWebUser',
                'stateKeyPrefix'=>'My',
                'loginUrl'=>Yii::app()->createUrl($this->getId().'/default/login'),
            ),
        ), false);

       ... 
```

# python - 为什么看似有效的 Python 脚本在通过 Windows 任务计划程序启动时无法运行？

> ID：11140685
> 
> 赞同：2
> 
> 时间：2012-06-21T14:45:31.753
> 
> 标签：python, windows-task-scheduler

我一直在用 Python 编写脚本，我想按计划在 Windows 服务器上自动运行这些脚本。我尝试非常简单地使用批处理文件，但我热情地转向 Python 脚本，并且对它们做得很好。我编写的脚本很容易编写，当我手动执行它们时，它们完全符合我的要求。我现在编写了许多不同的脚本，主要处理复制、删除和重命名文件或移动目录。

问题是当我尝试使用 Windows 任务计划程序安排 Python 脚本时，它们中的许多都无法运行（任务计划程序显示“上次运行结果 = 0x1”）。这事儿常常发生。我对批处理文件也有类似的经验（可以手动运行的批处理文件在计划时无法运行）。鉴于我迄今为止的有限经验，我不得不说这肯定是 Windows 任务计划程序问题，而不是 Python 问题。

这是一个示例 Python 脚本：

```
#import modules
import os, shutil, datetime, subprocess

#global variables
zip_dir = 'Y:\7z'
zip_dir_misc = 'X:\7z'
zip_extension = '.7z'

def newest_zip_file(directory, extension = zip_extension): 
  return max(
    (os.path.join(dir_name, file_name)
    for dir_name, dir_names, file_names in os.walk(directory)
    for file_name in file_names
    if file_name.endswith(extension)),
    key=lambda fn: os.stat(fn).st_mtime)  

def copy_zip_file(src_dir_p, temp_dir_p):
  src_file = newest_zip_file(src_dir_p)
  new_file = temp_dir_p + '\\' + os.path.basename(src_file)
  shutil.copyfile(src_file, new_file)

copy_zip_file(zip_dir, zip_dir_misc) 
```

此脚本通过网络文件夹（表示为 X: 分区）将 .7z 文件从一台服务器复制到另一台服务器。此脚本在手动运行时有效，但在计划时无效。但是，当脚本更改为将相同的 .7z 文件复制到同一服务器上的另一个目录（不是网络文件夹）时，脚本将完美运行，无论是手动执行还是计划执行。

如果我在上面的脚本中做一些程序上不正确的事情（也许我不正确地引用了网络文件夹），那么我可以修复这个脚本一次（尽管我已经尝试了我可以想象的所有组合来定义网络文件夹使用类似的东西完整的服务器名称）。但是我一直遇到同样的问题，使用完全不同的 Python 脚本，它们的行为方式相同，这让我想到了真正的问题：

为什么看似有效的 Python 脚本在通过 Windows 任务计划程序启动时无法运行？

我的 Windows 任务计划程序配置：

*   运行用户是否登录
*   以最高权限运行
*   直接调用的操作（Python 脚本）（启动程序：abc.py），不作为参数发送给 Python.exe，尽管我也确实多次尝试过 Python.exe 方法。我不相信任何一种方法都比另一种更好（就使计划任务执行而言），所以我只是直接调用脚本。

我主要在寻找解决这个一般问题的建议和最佳实践，而不是对上面发布的示例脚本的具体修复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-08-21T04:26:16.117

您提到网络文件夹，这是任务计划程序的一个已知问题。有关在 Python 中处理它的提示，请参阅[这篇文章](http://coredumpelf.wordpress.com/2011/04/04/windows-2008-task-scheduler-issues-with-mapped-drives/)。

一般来说：

*   确保通过任务计划程序 GUI 将“开始于”属性设置为操作中的脚本目录
*   在脚本中执行完整的文件引用，包括目录
*   如有必要，以经过身份验证的用户身份运行任务，并在常规设置中“以最高权限运行”
*   由于各种原因，您可能会更幸运地将任务作为批处理文件运行，该文件调用 python.exe 来运行您的脚本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:55:31.290

我对 Windows（或其任务调度程序）不是很熟悉，但这听起来像是您在尝试在 Unix 系统上自动运行 Python 脚本时遇到的典型 cron 问题。

cron 问题的主要原因是脚本在不同的环境和不同的用户下运行。它们难以修复的主要原因是开发人员在脚本自动运行时缺少错误消息。为了解决这个问题，我通常使用一个包装脚本，它将 Python 脚本的所有输出记录到一个错误日志文件中（只是为了能够在失败后看到错误消息）。

修复原始问题通常也可以通过为 Python 脚本设置正确环境（变量和东西）的包装脚本来完成。

正如我所说，我的经验基于 Unix cron，而不是 Windows 任务计划程序，但问题听起来非常相似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:27:09.467

几点注意事项：

确保调度程序用于启动 python 文件的用户在其 PATH 中具有 python 目录；

其次，确保该用户也具有网络权限，并且该用户的挂载也存在

第三，确保您从正确的文件夹启动。我建议修改脚本以更改为存储 .py 文件的工作目录，或者使用 .bat 文件启动，该文件将在启动 python 脚本之前更改为工作目录。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-26T16:49:51.810

我在 Windows Server 2012 R2 上遇到了这个问题，我想我找到了背后的原因：似乎 environmnet 变量是在创建任务时加载的。因此，如果您使用自己的模块并且在任务之后设置 PYTHONPATH 变量，则该任务在尝试加载新的 python 模块时总是会失败。我找到的解决方案只是重新创建任务并使用批处理来启动 python 脚本。在我的服务器上它可以工作，我希望它能为你解决问题

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-21T15:00:33.603

首先，除非您正确设置 windows，否则 windows 对 python 或 .py 文件一无所知。确保你正在这样做。

其次，用一个完全最小的python脚本试试这个——例如一个简单地接触目录中的文件的脚本。这将告诉您您的脚本是否正在运行。

第三，如果您认为这是一个 Windows 问题，那么最好向 Superuser 或 Serverfault 询问。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-03-28T12:19:22.033

我的脚本运行如下： 启动程序： cmd.exe /cc:\Python27\python.exe "c:\path\script.py" 以最高权限运行

# t4 - 根据 Phil Haack 描述的模型为单元测试结构创建一个 t4 模板

> ID：11140688
> 
> 赞同：1
> 
> 时间：2012-06-21T14:45:34.833
> 
> 标签：t4

在[这篇文章](http://haacked.com/archive/2012/01/02/structuring-unit-tests.aspx)中，Phil Haack 描述了一个构建单元测试的模型。在我尝试自己重新创建它之前，我想知道是否有人知道存在用于创建此结构骨架的 t4 模板？我经常使用它，但它确实会重复。

例如，给定以下类：

```
namespace My.Codes {
    public class Classy {

        public Classy(int x) {
             this.X = x;
        }

        public int X { get; private set; }

        public void DoSomething() {

        }
    }
} 
```

我想要一个在测试项目中生成以下内容的模板：

```
namespace My.Codes.Tests {
    public class ClassyTests {

        [TestClass]
        public class Ctor {

        }

        [TestClass]
        public class DoSomething {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-07T02:07:57.580

当 T4 模板再次运行时，它不会清除您现有的工作吗？或者你只是以一次运行的方式来获得结构，然后不再重新运行它？

# python - OpenCV Haar 特征检测，仅限于 Camshift 跟踪区域

> ID：11140692
> 
> 赞同：2
> 
> 时间：2012-06-21T14:45:45.360
> 
> 标签：python, image-processing, opencv, computer-vision

从视频文件开始，我逐帧扫描视频，直到找到使用 OpenCV Haar 正面面部级联的面部。然后，我将这些坐标传递给 Camshift（使用 OpenCV 示例代码）以从该帧开始跟踪该面部。然后，我在 Camshift 返回的跟踪框中使用 Haar 眼睛/嘴巴检测，假设这是我感兴趣的区域。

当我这样做时，眼睛/嘴巴检测返回很少/没有结果。

如果我只是在没有 Camshift 的情况下使用相同的眼睛和嘴巴检测器对视频进行基本运行，那么它们会检测到眼睛和嘴巴（尽管经常将嘴巴检测为眼睛，反之亦然，但仍然比我的 Camshift 跟踪 ROI 方法更好的检测）。

这与我的期望背道而驰——不应该将搜索限制在已知和跟踪的人脸的 ROI 内，从而实现比对整个视频帧进行愚蠢扫描更可靠的人脸特征检测吗？也许我对搜索坐标做了一些不恰当的事情……</p>

非常感谢任何帮助。

```
import numpy as np
import cv2
import cv
from common import clock, draw_str
import video

class App(object):

def __init__(self, video_src):  

    if video_src == "webcam":
        self.cam = video.create_capture(0)

    else:       
        self.vidFile = cv.CaptureFromFile('sources/' + video_src + '.mp4')
        self.vidFrames = int(cv.GetCaptureProperty(self.vidFile, cv.CV_CAP_PROP_FRAME_COUNT))

    self.cascade_fn = "haarcascades/haarcascade_frontalface_default.xml"
    self.cascade = cv2.CascadeClassifier(self.cascade_fn)

    self.left_eye_fn = "haarcascades/haarcascade_eye.xml"
    self.left_eye = cv2.CascadeClassifier(self.left_eye_fn)

    self.mouth_fn = "haarcascades/haarcascade_mcs_mouth.xml"
    self.mouth = cv2.CascadeClassifier(self.mouth_fn)       

    self.selection = None
    self.drag_start = None
    self.tracking_state = 0
    self.show_backproj = False

    self.face_frame = 0

    cv2.namedWindow('camshift')
    cv2.namedWindow('source')
    #cv2.namedWindow('hist')

    if video_src == "webcam":
        while True:
            ret, img = self.cam.read()
            self.rects = self.faceSearch(img)
            print "Searching for face..."
            if len(self.rects) != 0:
                break

    else:
        for f in xrange(self.vidFrames):
            img = cv.QueryFrame(self.vidFile)
            tmp = cv.CreateImage(cv.GetSize(img), 8, 3)
            cv.CvtColor(img, tmp, cv.CV_BGR2RGB)
            img = np.asarray(cv.GetMat(tmp))
            print "Searching frame", f+1
            self.face_frame = f
            self.rects = self.faceSearch(img)
            if len(self.rects) != 0:
                break

def faceSearch(self, img):

    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    gray = cv2.equalizeHist(gray)

    rects = self.detect(gray, self.cascade)

    if len(rects) != 0:
        print "Detected face"
        sizeX = rects[0][2] - rects[0][0]
        sizeY = rects[0][3] - rects[0][1]
        print "Face size is", sizeX, "by", sizeY
        return rects
    else:
        return []

def detect(self, img, cascade):

    # flags = cv.CV_HAAR_SCALE_IMAGE
    rects = cascade.detectMultiScale(img, scaleFactor=1.1, minNeighbors=2, minSize=(80, 80), flags = cv.CV_HAAR_SCALE_IMAGE)
    if len(rects) == 0:
        return []
    rects[:,2:] += rects[:,:2]
    return rects

def draw_rects(self, img, rects, color):
    for x1, y1, x2, y2 in rects:
        cv2.rectangle(img, (x1, y1), (x2, y2), color, 2)

def show_hist(self):
    bin_count = self.hist.shape[0]
    bin_w = 24
    img = np.zeros((256, bin_count*bin_w, 3), np.uint8)
    for i in xrange(bin_count):
        h = int(self.hist[i])
        cv2.rectangle(img, (i*bin_w+2, 255), ((i+1)*bin_w-2, 255-h), (int(180.0*i/bin_count), 255, 255), -1)
    img = cv2.cvtColor(img, cv2.COLOR_HSV2BGR)
    cv2.imshow('hist', img)
    cv.MoveWindow('hist', 0, 440)

def faceTrack(self, img):
    vis = img.copy()        

    hsv = cv2.cvtColor(img, cv2.COLOR_BGR2HSV)
    mask = cv2.inRange(hsv, np.array((0., 60., 32.)), np.array((180., 255., 255.)))

    x0, y0, x1, y1 = self.rects[0]
    self.track_window = (x0, y0, x1-x0, y1-y0)
    hsv_roi = hsv[y0:y1, x0:x1]
    mask_roi = mask[y0:y1, x0:x1]
    hist = cv2.calcHist( [hsv_roi], [0], mask_roi, [16], [0, 180] )
    cv2.normalize(hist, hist, 0, 255, cv2.NORM_MINMAX);
    self.hist = hist.reshape(-1)
    #self.show_hist()

    vis_roi = vis[y0:y1, x0:x1]
    cv2.bitwise_not(vis_roi, vis_roi)
    vis[mask == 0] = 0

    prob = cv2.calcBackProject([hsv], [0], self.hist, [0, 180], 1)
    prob &= mask
    term_crit = ( cv2.TERM_CRITERIA_EPS | cv2.TERM_CRITERIA_COUNT, 10, 1 )
    track_box, self.track_window = cv2.CamShift(prob, self.track_window, term_crit)

    if self.show_backproj:
        vis[:] = prob[...,np.newaxis]
    try: cv2.ellipse(vis, track_box, (0, 0, 255), 2)
    except: print track_box     

    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
    gray = cv2.equalizeHist(gray)

    xc = track_box[0][0]
    yc = track_box[0][1]

    xsize = track_box[1][0]
    ysize = track_box[1][1]

    x1 = int(xc - (xsize/2))
    y1 = int(yc - (ysize/2))
    x2 = int(xc + (xsize/2))
    y2 = int(yc + (ysize/2))

    roi_rect = y1, y2, x1, x2

    roi = gray[y1:y2, x1:x2]
    vis_roi = img.copy()[y1:y2, x1:x2]

    subrects_left_eye = self.detect(roi.copy(), self.left_eye)
    subrects_mouth = self.detect(roi.copy(), self.mouth)

    if subrects_left_eye != []:
        print "eye:", subrects_left_eye, "in roi:", roi_rect

    self.draw_rects(vis_roi, subrects_left_eye, (255, 0, 0))
    self.draw_rects(vis_roi, subrects_mouth, (0, 255, 0))

    cv2.imshow('test', vis_roi)

    dt = clock() - self.t
    draw_str(vis, (20, 20), 'time: %.1f ms' % (dt*1000))
    #draw_str(vis, (20, 35), 'frame: %d' % f)

    cv2.imshow('source', img)
    cv.MoveWindow('source', 500, 0)
    cv2.imshow('camshift', vis) 

def run(self):

    if video_src == "webcam":
        while True:
            self.t = clock()
            ret, img = self.cam.read()

            self.faceTrack(img)

            ch = 0xFF & cv2.waitKey(1)
            if ch == 27:
                break
            if ch == ord('b'):
                self.show_backproj = not self.show_backproj

    else:
        for f in xrange(self.face_frame, self.vidFrames):
            self.t = clock()
            img = cv.QueryFrame(self.vidFile)
            if type(img) != cv2.cv.iplimage:
                break

            tmp = cv.CreateImage(cv.GetSize(img), 8, 3)
            cv.CvtColor(img, tmp, cv.CV_BGR2RGB)
            img = np.asarray(cv.GetMat(tmp))    

            self.faceTrack(img)

            ch = 0xFF & cv2.waitKey(5)
            if ch == 27:
                break
            if ch == ord('b'):
                self.show_backproj = not self.show_backproj     

    cv2.destroyAllWindows()

if __name__ == '__main__':
    import sys
    try: video_src = sys.argv[1]
    except: video_src = '1'
    App(video_src).run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T00:28:04.933

您已经提到 detectMultiScale 的最小尺寸为 80 像素。脸可能是这样，但眼睛和嘴巴没有那么大。所以这可能是没有检测到眼睛和嘴巴的原因之一。在调用眼睛和嘴巴时，尝试将其减小到 20 或 30 像素。

# c# - NHibernate 是否支持引用不是主键的唯一列？

> ID：11140695
> 
> 赞同：2
> 
> 时间：2012-06-21T14:45:50.593
> 
> 标签：c#, hibernate, nhibernate, nhibernate-mapping

恐怕我在这里问了一个愚蠢的问题，但我的 google-fu 似乎正在受苦。大多数 RDBMS 支持创建一个外键来引用另一个表中不是主键的唯一键，但我似乎无法找到有关 NHibernate 的“操作方法”。我假设是因为每个人都认为这很愚蠢。

这支持吗？有什么注意事项吗？XML 映射会是什么样子呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:54:49.957

如果我能很好地理解您的问题，`property-ref`那么您正在寻找什么

来自 Nhibernate 文档（[5.1.12。多对一](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/mapping.html#mapping-declaration-manytoone)）

> property-ref （可选）：与此外键连接的关联类的属性名称。如果未指定，则使用关联类的主键。

我个人不知道任何警告，但NHibernate 开发团队的活跃成员[Ayende Rahien](http://ayende.com/blog/3938/nhibernate-mapping-many-to-one)强烈建议尽可能避免这种情况。他没有说为什么，可能只是因为丑:)

# c# - 取消测试（带有警告）

> ID：11140697
> 
> 赞同：2
> 
> 时间：2012-06-21T14:45:59.647
> 
> 标签：c#, visual-studio, unit-testing, nunit, mstest

我的项目有一些单元测试。它们都依赖于一些我无法控制的外部服务。该服务经常停机（回想一下 2008 年左右的 Twitter）。目前，如果服务关闭，则测试失败，并且无法构建持续集成服务器。我很反感这个。我想忽略依赖此设置的测试，打印警告。

```
[BeforeScenario]

try
{
    connect(server)
}
catch (Exception x)
{
    throw new Exception(String.Format("Failed to connect to server {0}", server), x);
} 
```

我怎样才能做到这一点？我今天碰巧在使用 SpecFlow，但我也想知道如何从 NUnit 做到这一点。

以下是我目前拥有的。没关系。测试被忽略，但构建仍然失败。

```
[BeforeScenario]

try
{
    connect(server)
}
catch (Exception x)
{      
    throw new SpecFlowCancelTests(String.Format("Failed to connect to server {0}", server), x);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:50:12.577

You can use either [Assert.Inconclusive("message")](http://www.nunit.org/index.php?p=utilityAsserts&r=2.5.1) or [Assert.Ignore()](http://www.nunit.org/index.php?p=utilityAsserts&r=2.5.1) utility methods:

> The Assert.Inconclusive method indicates that the test could not be completed with the data available. It should be used in situations where another run with different data might run to completion, with either a success or failure outcome.
> 
> The Assert.Ignore method provides you with the ability to dynamically cause a test or suite to be ignored at runtime. It may be called in a test, setup or fixture setup method. We recommend that you use this only in isolated cases. The category facility is provided for more extensive inclusion or exclusion of tests or you may elect to simply divide tests run on different occasions into different assemblies.

Useful links: - [What is the Inconclusive Test Condition?](http://blogs.msdn.com/b/sachinre/archive/2006/07/29/what-is-the-inconclusive-test-condition_3f00_.aspx)

# ios - 不可变的 NSMutableArray

> ID：11140700
> 
> 赞同：0
> 
> 时间：2012-06-21T14:46:07.367
> 
> 标签：ios, uitableview, nsmutablearray

在我的`viewDidLoad`网络服务中，我从一个数组的前 5 个项目加载并将它们放在`NSMutableArray`我的一个。同样在这个视图上，我有`UITableViewController`显示我的项目以及`NSMutableArray`来自网络服务的内容。当我滚动到最后一项时，`UITableView`我正在从 web 服务加载 5 个下一个项目并将它们添加到我的`NSMutableArray`并重新加载表数据以显示所有 10 个项目。

问题是，当我尝试`NSMutableArray`从 web 服务添加到现有的 5 个新对象时，程序崩溃并显示以下消息：`Exception: -[__NSCFArray insertObject:atIndex:]: mutating method sent to immutable object`

我访问`NSMutableArray`in 的方式`cellForRowAtIndexPath:`是这样的：

```
cell.textLabel.text = [[self.myMutableArray objectAtIndex:indexPath.row]objectForKey:@"name"]; 
```

知道它可能是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:52:48.000

首先，在编译器输出中查找警告。您可能正在将一个分配`NSArray`给一个`NSMutableArray`变量。这通常会产生警告。您的构建中应该没有警告。这对于 ObjC 代码至关重要（许多您认为“错误”的事情在 ObjC 中只是警告）。如果您忽略警告，那么您将遇到很多问题。

如果将某些内容强制转换为`id`. 例如，如果您从数组或字典中获取“ `NSMutableArray`”（实际上是一个），您将不会收到有关类型不匹配的警告。`NSArray`寻找这些情况。基本上，审核您分配的每个点，`myMutableArray`并确保您实际上分配了一个可变数组。

# c# - 我怎样才能声明派生的“shell”类除了作为重命名之外什么都不做？

> ID：11140701
> 
> 赞同：11
> 
> 时间：2012-06-21T14:46:12.907
> 
> 标签：c#, .net, generics, inheritance, defensive-programming

我有两种不同类型的字符串在我的代码中传递和使用，两者密切相关，但不应相互混淆。我认为我可以通过拥有两个只是字符串但名称不同的类来帮助自己避免错误，以便方法签名（以及一般的类型不兼容）将强制执行两种不同类型字符串的语义含义。同时，我不想在一百个地方重构 from `something = "foo";`to 。`something.Value = "foo";`

第一个想法：

```
private class FirstKind : string { }
private class SecondKind : string { } 
```

这个想法是，如果我有

```
void MyMethod(FirstKind varOne, SecondKind varTwo) {...} 
```

，然后尝试用 调用它`MyMethod(secondKindVar, firstKindVar);`，我会得到一个编译器错误。

我撞到的墙： `string`被密封了。

第二个想法：创建泛型`KindOf<T>`类，它只会使用隐式转换运算符接收和吐出值。像这样：

```
private class KindOf<T>
{
    public T Value { get; set; }
    public KindOf() { Value = default(T); }
    public KindOf(T val) { Value = val; }
    public static implicit operator T(KindOf<T> kindOf) { return kindOf.Value; }
    public static implicit operator KindOf<T>(T value) { return new KindOf<T>(value); }
} 
```

这样我可以做这样的事情：

```
private class FirstKind : KindOf<string> { }
private class SecondKind : KindOf<string> { } 
```

我击中的墙：`KindOf<T>`该类似乎没有继承：派生类型中既不存在构造函数，也不存在运算符，这意味着我必须在派生类中重新实现整个基类。代码复制。呸。

所以我觉得我在这里错过了一些基本的东西，也许我已经离开了杂草。对我正在尝试做的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:58:53.817

老实说，我根本不会使用隐式运算符，也不会使用任何继承。整个想法是有一个方法，需要一个`FirstKind`. 使用隐式运算符，您只需传入一个字符串，它就会被转换；这意味着您不会强制代码明确声明它是第一种/第二种。我会坚持使用两个类，每个类只有一个构造函数，带有一个字符串和一个只读属性。通过添加其他任何内容，您已经过分复杂化了。

如果使用该属性变得烦人，我可能会从每个自定义类中看到隐式转换***为***字符串，但我确实相信***从***字符串的隐式转换将是有害的。虽然我同意通常要避免复制/粘贴代码，但当它实际上是一行代码时，复制粘贴隐式转换到两个类将比尝试使用继承或其他任何东西更容易、更有效且通常更易于维护避免写两次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:59:25.800

我将把我的评论作为一个答案，因为我认为它是一个答案。

在我的脑海中，您可能只需要在子类上实现隐式运算符和构造函数。是的，有点像代码复制，但至少当继承并没有真正传达任何真实的东西时，它没有使用复杂的过程或使用继承（从修辞上讲，无论如何，什么是“KindOf”，它真的意味着什么吗？）而且只是那里可以减少除了相似语法（但不同用途）之外没有任何共同点的类之间的代码重复

```
public class FirstKind
{
    public string Value { get; private set; }

    public FirstKind(string value)
    {
        this.Value = value;
    }

    public static implicit operator FirstKind(string value)
    {
        return new FirstKind(value);
    }

    public static implicit operator string(FirstKind value)
    {
        return value.Value;
    }
} 
```

此外，如果它们应该表示字符串，您可能需要考虑使类不可变。（另一个可能指向这些对象的实现细节可能不应该从重用`KindOf`类继承，在您的实现中，这使得它们总是可变的）

它没有太多的布线，并且让您的代码可以在未来进行更改（也许您希望添加一个新属性？添加一些验证代码？）并且 API 的使用者真的不在乎任何东西`KindOf`只是为了节省一些*小*问题代码重复。（也许你可以制作一个片段让你的生活更轻松一些？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:04:22.827

在您的问题中，`FirstKind`and`SecondKind`是您的类字符串变量的类型，并且`string`是您的`KindOf<T>`类的类型参数。另一种方法（避免其他答案所需的代码重复）是翻转 and 的角色`FirstKind`，`SecondKind`使它们成为空的“标记”类，用作类型的类型参数`String<TKind>`：

```
public class FirstKind { }
public class SecondKind { }

public struct String<TKind>
{
    private readonly string _value;

    public String(string value)
    {
        _value = value;
    }

    public override string ToString()
    {
        return _value;
    }

    public static implicit operator String<TKind>(string s) // see the note below
    {
        return new String<TKind>(s);
    }

    public static implicit operator string(String<TKind> s)
    {
        return s.ToString();
    }

    public static String<TKind> operator +(String<TKind> s1, String<TKind> s2)
    {
        return new String<TKind>(s1.ToString() + s2.ToString());
    }

    public int Length
    {
        get { return _value.Length; }
    }

    // You can add methods like Substring and Trim that delegate to _value.
} 
```

现在你可以`MyMethod`这样声明：

```
void MyMethod(String<FirstKind> varOne, String<SecondKind> varTwo)
{
    varOne += varOne; // OK
    varTwo += varTwo; // OK
    varOne = varTwo;  // ERROR
} 
```

注意：我已经从普通的`string`. 您可能需要考虑删除它，强制代码显式识别字符串的类型：`new String<FirstKind>("...")`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T14:50:43.247

I would just do this for strings.

```
abstract class MyTypedString
{
   protected MyTypedString(string value)
   {
     Value = value;
   }
   public string Value { get; private set; }
} 
```

Then you could finish off this abstract class with your `FirstKind` and `SecondKind`. This will keep the object immutable like how strings are. I would not give this any implicit conversion operators.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T14:53:53.223

运算符仍然可以工作，您只需要引用`.Value`KindOf 类的成员：

```
FirstKind stringFoo = new FirstKind("foo");
FirstKind stringQux = new FirstKind("qux");

// String concatenation operator
FirstKind stringTar = new FirstKind( stringFoo.Value + stringQux.Value ); 
```

但是，正如您所说，如果将两者混合使用，则不会有“类型检查”，例如

```
SecondKind stringBar = new SecondKind("bar");
FirstKind stringHal = new FirstKind( stringFoo.Value + stringBar.Value ); // this will succeed, even though you intend stringFoo and stringBar to be incompatible 
```

由于运算符是类接口的一部分，因此您必须重新实现它们 - 但是您可以只包装包含的类的实现，因此您只需要做一些无聊的工作即可使其正常工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-21T14:54:32.210

您可以尝试将类上的[隐式](http://msdn.microsoft.com/en-us/library/z5z9kes2.aspx)转换运算符重载为字符串。这样您就不必更新对 .Value 的引用。这些类必须保持独立，您必须为它们创建接受字符串值的构造函数。最佳做法是保留字符串`readonly`，以便类变得不可变。模仿它所代表的字符串类。

```
public class FirstKind 
{
      private readonly string value;
      public FirstKind(string v) { this.value = v };
      public static implicit operator string(FirstKind v){ return v.value; }
}

public class SecondKind 
{
      private readonly string value;
      public SecondKind (string v) { this.value = v };
      public static implicit operator string(SecondKind v){ return v.value; }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-21T14:55:27.560

你几乎可以使用你的泛型类。只有从字符串（或其他类型）到派生类的隐式转换永远不会起作用，因为基类不知道字符串应该转换为第一类还是第二类。因此应该复制该部分，但其余部分可以保留在基类中：

```
private class FirstKind : KindOf<string>
{
    public static implicit operator FirstKind(string value) { return new FirstKind{Value = value}; }
}
private class SecondKind : KindOf<string>
{
    public static implicit operator SecondKind(string value) { return new SecondKind{Value = value}; }
} 
```

仍然可以从泛型类中转换到基类：

```
 FirstKind Foo = "Foo"; //via implicit operator in FirstKind
        string stringFoo = Foo; //via implicit operator in baseclass 
```

# html - 垂直对齐 div 中的标题和段落

> ID：11140702
> 
> 赞同：0
> 
> 时间：2012-06-21T14:46:16.163
> 
> 标签：html, css, css-tables

我试图垂直对齐一个 h1 元素和一个 div 中间的 p 向左浮动，但它们最终彼此相邻垂直对齐。我很确定它与表格单元格显示有关，但不知道如何在没有它的情况下垂直对齐。

我的代码给了我：

```
.
.
Heading Paragraph
.
. 
```

我想：

```
.
.
Heading
Paragraph
.
. 
```

这是我的代码：

CSS：

```
#HDRtext 
{
    float:  left;
    width: 30%;
    height: 335px;
    padding: 0;
    display: table;
    color:  white;
}

#HDRtext h1 
{
    font-family: Georgia;
    font-size: 2em;
    display: table-cell;
    vertical-align: middle;
}

#HDRtext p {
    display: table-cell;
    vertical-align: middle;
    font-size:1em;
    font-family: Georgia;
} 
```

这里是 jsfiddle：[jsfiddle](http://jsfiddle.net/Y8cw2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:11:46.033

这是一个带有示例的页面：http: [//jsfiddle.net/Z468Z/1/](http://jsfiddle.net/Z468Z/1/)

我通过一个类更改了您的 id，在 css 中使用 ID 是一个坏习惯。

我个人更喜欢内联块作为表格/表格行/表格单元格显示。

使用 inline-block 垂直对齐中间您必须知道的内容：

*   容器必须具有相同大小的高度和行高。
*   你想要在中间的孩子，必须是“inline-block”类型，在这个孩子中你必须恢复正确的行高
*   他的孩子可以是块类型（如我的例子）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:49:45.687

您必须[垂直对齐](http://www.vertical-align.com/)包含它们的 div（或将它们放在另一个 div 中并将其放置在原始 div 中）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T14:51:14.750

[This Page](http://phrogz.net/CSS/vertical-align/index.html) Explains and shows a method of vertical alignment towards the bottom.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T14:58:28.503

要正确垂直居中元素，您需要一个绝对定位的 div，它距顶部高度的 50%，然后是一个偏移 div，其顶部边距为 div 总高度的 -50%。一个工作示例：http: [//jsfiddle.net/jefffabiny/xXZfb/1/](http://jsfiddle.net/jefffabiny/xXZfb/1/)

# java - 如何从 android.location.Address 对象接收门牌号？

> ID：11140704
> 
> 赞同：4
> 
> 时间：2012-06-21T14:46:27.610
> 
> 标签：java, android, google-maps

```
List<Address> addresses = new Geocoder(a).getFromLocation(latitude,longitude, 1);
Address adr = addresses.get(0)

//receive different paramters of an address
postalCode = a.getPostalCode();
city = a.getLocality();
county = a.getAdminArea();
country = a.getCountryName();
street = a.getThoroughfare(); 
```

**但是我如何收到门牌号码？**

*注意！a.getAddressLine(0) 在单个字符串中返回带有数字的街道名称（例如：MyAddress 101b）。有没有办法只接收门牌号（例如：101b）？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T13:44:32.347

很多时候地址是近似的并且不包含门牌号码。特别是如果位置不在北美或西欧。我之前的研究表明，门牌号没有专门的字段。您必须使用例如正则表达式检查地址字符串，以确定它是否包含门牌号码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-03T07:50:41.397

在我的情况下`a.getSubThoroughfare()`返回门牌号（或者`null`如果它是没有号码的地址）。也许这取决于语言环境，因此请检查它是否适合您。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-05-09T11:37:28.547

```
Geocoder geocoder = new Geocoder(context, Locale.getDefault());
String result = null;
try {
    List<Address> addressList = geocoder.getFromLocation(
    latitude, longitude, 1);
    if (addressList != null && addressList.size() > 0) 
    {
        Address address = addressList.get(0);
        StringBuilder sb = new StringBuilder();
        // House no and street name
        sb.append(address.getAddressLine(0)).append(""); 
    }
} 
```

# python - 与 Oracle 一起使用的 python 2d 图形

> ID：11140710
> 
> 赞同：0
> 
> 时间：2012-06-21T14:46:48.580
> 
> 标签：python, oracle, graphics, 2d, simulation

我有大量数据希望在 2d 中表示。哪些图形库可以与从 oracles 数据库中获取数据兼容并且仍然具有流畅的外观？我不想使用 tkinter。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:56:42.150

您用于图形的库与您所代表的数据源之间没有任何联系。当您说 2d 时，我假设您在谈论图形。在这种情况下，请尝试 matplotlib 或 google charts api。两者都可以很好地与 python 配合使用，并且可以用有吸引力的 2d 图表来表示您的数据

# php - 每行 PHP/javascript/mysql 新帖子

> ID：11140713
> 
> 赞同：0
> 
> 时间：2012-06-21T14:46:53.250
> 
> 标签：php, javascript, mysql

我正在尝试创建一个文本区域，您可以在其中放入一个事物列表，所有事物都由一个新行分隔，并且它们都作为单独的帖子进入一个 mysql 表，我怎样才能让这个项目列表作为新帖子进入表无需单独发布它们，因为我需要输入 70 个项目。

您是否建议我将它们全部通过 javascript 分开，然后通过 ajax 将它们一一发布？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:49:22.840

您可以在 php 中执行此操作：

```
$arrayOfLines = explode("\n", $_POST['mytextarea']); 
```

然后您应该能够遍历该数组并将每一行放入数据库中。

（编辑 - 根据评论从拆分更改为爆炸）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T14:50:50.483

据我了解：

如果使用换行符输入 textarea 中的值，则会将其作为用 \n 分隔的值存储在数据库中。因此，如果您想在插入时检索它们，您应该使用**[nl2br 函数](http://www.w3schools.com/php/func_string_nl2br.asp)**。

```
<?php
   echo nl2br("Line 1.\nLine 2.");
?>

//Output

Line 1.
Line 2. 
```

也许你正在寻找这个：

或者，如果您想通过换行符拆分值，您可以创建一个这样的数组：

```
$array = explode("\n", $_POST['textarea_value']); 
```

并通过 $array 循环插入数据库。

希望这可以帮助。

# ios - 使用 PhoneGap 制作的 iPhone 应用的 Flash 替代品

> ID：11140715
> 
> 赞同：-1
> 
> 时间：2012-06-21T14:46:58.607
> 
> 标签：ios, flash, cordova

实现 Flash 或某些 Flash 替代方案（将 swf 转换为其他格式）的最佳方法是什么？我正在使用 PhoneGap 进行开发。我不能将 jquery mobile 用于该动画，因为它太难制作了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-25T05:50:55.933

我不确定你的输出是什么。为什么不看看 CSS-webkit 动画？

对于简单的东西，它工作得很好。看看 iCloud.com 上的苹果实现 :-)

一个很好的起点 - [http://css-tricks.com/snippets/css/webkit-keyframe-animation-syntax/](http://css-tricks.com/snippets/css/webkit-keyframe-animation-syntax/)

# html - 将表单添加到 html 电子邮件通讯

> ID：11140718
> 
> 赞同：2
> 
> 时间：2012-06-21T14:46:59.503
> 
> 标签：html, forms, email, field, newsletter

是否可以在电子邮件通讯中添加表格？我试图包含代码，但是当我发送电子邮件时，输入字段没有显示在电子邮件客户端中。任何帮助将不胜感激。

我包含的表单代码是：

```
<form action="http://feedburner.google.com/fb/a/mailverify" method="post" onsubmit="window.open('http://feedburner.google.com/fb/a/mailverify?uri=GenzymeRareCommunityBlog', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true" style="border:0;" target="popupwindow">
<p>Enter your email address:</p>
<p><input name="email" style="width:140px" type="text" /></p>
<p><input name="uri" type="hidden" value="GenzymeRareCommunityBlog" /><input name="loc"   type="hidden" value="en_US" /><input type="submit" value="Subscribe" /> </p></form>
<p><a href="http://feeds.feedburner.com/GenzymeRareCommunityBlog" rel="alternate" type="application/rss+xml"><img alt="" src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" style="vertical-align:middle;border:0" /></a> <a href="http://feeds.feedburner.com/GenzymeRareCommunityBlog" rel="alternate" type="application/rss+xml">Subscribe in a reader</a></p>
<p style="font-size: smaller"><em>*We will not share your email with any other parties. <a href="privacy-policy">Privacy Policy</a></em></p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:54:08.770

通过快速搜索，我发现了这个：

[Html 电子邮件中的 Html 表单](http://css-tricks.com/html-forms-in-html-emails/)

显然可以做到，但从我阅读的内容来看，电子邮件客户端的功能各不相同，链接页面上有一个图表，显示了不同的客户端如何处理电子邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:51:20.853

I don't believe you can add a traditional form to your email. typically, you'll see the *illusion* of a form... like an image of a radio button, that links to a page (with an argument in the url of your selected choice) which *then* has a post / submit form button.

alternatively, you can simply link to a real form (with a nice pretty call-to-action button)

# maven - Maven 如何删除其中包含给定文本字符串的所有文件？

> ID：11140719
> 
> 赞同：2
> 
> 时间：2012-06-21T14:47:02.763
> 
> 标签：maven, maven-2, maven-plugin

对于某个 Maven '配置文件'（即构建的变体），我想删除其中包含特定文本字符串的文件。列出要删除的文件名很容易，但就我而言，我希望信息位于（注释）文件本身中。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:50:17.440

我会说唯一的方法是一个 groovy 脚本部分，否则我看不到这种奇怪要求的方法。

```
<plugin>
    <groupId>org.codehaus.gmaven</groupId>
    <artifactId>gmaven-plugin</artifactId>
    <executions>
        <execution>
            <phase>generate-resources</phase>
            <goals>
                <goal>execute</goal>
            </goals>
            <configuration>
                <source>
def directory = new File("TheFolderYouWouldLikeToDeleteFilesIn")

directory.eachFileRecurse(groovy.io.FileType.FILES) {
   file ->
   def deleteFile = false;
   file.eachLine{ line ->
        if (line.contains("Text String Inside")) {
                deleteFile = true;
        }
   }
   if (deleteFile) {
        println "Deleting " + file
        file.delete()
   }

}

                </source>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-22T16:56:18.523

@khmarbaise 的答案的一个变体是使用[Ant 插件](http://maven.apache.org/plugins/maven-antrun-plugin/usage.html)和 Ant scriptlet 来执行此操作，这应该比 Groovy 代码段更直接。话虽如此，一旦确定需要编写脚本，这一切都取决于您选择的脚本语言。

例如：

```
<plugin>
    <artifactId>maven-antrun-plugin</artifactId>
    <executions>
      <execution>
        <phase> <!-- a lifecycle phase --> </phase>
        <configuration>
          <target>

            <delete>
                <!-- here, the 'generated.java.dir' is assumed to be a maven property defined earlier in the pom -->
                <fileset dir="${generated.java.dir}" includes="**/*.java">
                    <contains text="DELETE.ME.IF.YOU.SEE.THIS" casesensitive="no"/>
                </fileset>
            </delete>

          </target>
        </configuration>
        <goals>
          <goal>run</goal>
        </goals>
      </execution>
    </executions>
</plugin> 
```

请注意，如果需要，您还可以使用[<containsregexp>](http://ant.apache.org/manual/Types/selectors.html#regexpselect)选择器进行更复杂的匹配。

# git - Git分支策略，如何无问题推送到各种环境

> ID：11140722
> 
> 赞同：1
> 
> 时间：2012-06-21T14:47:08.733
> 
> 标签：git, continuous-integration, branching-and-merging

寻找有关如何设置 git 以支持多个开发人员开发功能的建议，以及我们如何推送到我们的各种环境，如 dev、qa 和 uat。

我在想这样的事情：

```
dev_branch
- new features get a feature branch i.e. dev_branch_feature_x
- once feature is completed, it gets merged into the dev_branch
- dev_branch then merges into main_branch

main_branch
- code must be merged into main to push to UAT
- once uat is signed off, it gets pushed to production 
```

一个问题是，拥有一个 feature_branch 是否意味着我们需要为每个 feature_branch 提供单独的开发和 qa 环境？

如果 2 个开发人员正在开发一个功能，他们不能直接将他们的更改推送到 QA 环境，因为他们会相互覆盖。而且我不确定他们是否可以将两个更改合并到同一个分支中，然后推送，因为它们可能存在冲突。

上述分支模型是否可行，或者您有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T22:46:04.410

A very popular workflow for use with git is described in [http://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)

Basically, what you are most successful doing is to have a development environment that is on a long-running branch, which can be the trunk if you wish or can be a separate branch, in this document one named 'develop'.

Issue branches and development branches would be branched off from this, developed and tested, and then merged back when the author believes they are stable. Then if whatever testing you require in development to qualify it to go to the next test level passes, you tag and build that and deploy it into the test environment.

When you are getting close to a release, you would branch from the running development branch for a release branch, which then is only touched to improve its stability for release. This makes it a dead-end branch, but a great place to apply hot-fixes later.

And if you are in one of those places that wants the trunk to be the most recent version deployed to production, then whenever something has passed all testing and is deployed to production, you merge it onto the trunk. This is option; in my opinion it is unnecessary overhead and complexity, but it is a Management Demand you run into quite often.

# c++ - 使用 std::ostream 方法将格式化文本输出到 std::string 对象

> ID：11140723
> 
> 赞同：0
> 
> 时间：2012-06-21T14:47:14.693
> 
> 标签：c++, string-formatting, crt

我制作了一个函数 dump_text(std::ostream &) 将一些文本转储到标准输出流中。文本转到文件或用户控制台。现在，我希望该文本以标准字符串对象结尾（请参阅下一个代码示例）。

```
void dump_text(std::ostream &p_ostream)
{
    p_ostream << "text that must endup in string object";
}

class my_class
{
    public:
    my_class(std::string &);
    operator std::ostream & ();
};

int main(int, char **)
{
    std::string l;
    my_class k(l);

    dump_text(k);
} 
```

1) CRT 库中是否有“my_class”的标准实现？2) 有谁知道使用 std::ostream - 方法将文本分配给字符串的问题的更好解决方案？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T14:50:00.667

You would use a `std::ostringstream`.

```
#include <sstream>
using namespace std;

...
ostringstream out;
dump_text(out);
string value = out.str();
... 
```

# php - Symfony2：在自定义环境中运行自动化测试

> ID：11140728
> 
> 赞同：3
> 
> 时间：2012-06-21T14:47:45.493
> 
> 标签：php, unit-testing, symfony, phpunit

我正在尝试在自定义环境中为 REST API 运行 Symfony 2 PHP 单元测试，而不是默认的“测试”环境。

目的是能够在任何环境（例如 int、prod）中部署其余 API 后进行快速健全性检查

在创建新的内核/客户端时，我设法将环境传递给 WebTestCase 类。我的问题是我现在收到以下错误：

“会话id过长或包含非法字符，有效字符为az、AZ、0-9”

我可以通过在 config.[targetenvironment].yml 中将会话存储更改为文件系统来解决这个问题，但我不想在 prod 中使用文件系统存储。

```
framework:
    test: ~
    session:
        storage_id: session.storage.filesystem 
```

有没有办法解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T23:55:07.017

在[PHPUnit 手册](http://www.phpunit.de/manual/current/en/phpunit-book.pdf)的第 11 章中有一节是关于[模拟文件系统的](https://phpunit.de/manual/current/en/test-doubles.html#test-doubles.mocking-the-filesystem)。这基本上会拦截所有文件系统调用，因此请确保您运行的测试没有副作用。如果您直接调用函数，这应该可以解决您的问题（即，如果运行 PHPUnit 的 php 实例也是运行您的代码的实例）。

但是，如果您的调用通过 Web 服务器，则 PHPUnit 配置无法控制远程环境。在这种情况下，您可以尝试一个特殊的 Apache 配置，该配置根据[客户端 IP 地址](http://httpd.apache.org/docs/2.0/mod/mod_setenvif.html#setenvif)和/或[用户代理字符串](http://httpd.apache.org/docs/2.0/mod/mod_setenvif.html#browsermatch)设置环境变量，然后在您的代码中使用该环境变量来覆盖默认会话存储，或者您需要的任何其他内容.

# jquery-ui - 我可以在 html5 中使用画布播放两个视频吗

> ID：11140731
> 
> 赞同：0
> 
> 时间：2012-06-21T14:48:02.200
> 
> 标签：jquery-ui, html5-video, html5-canvas

![在此处输入图像描述](../Images/6e918160faf54719b8845445ca19c1b3.png)

我可以使用画布和 html5 在接收器中播放两个视频吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:52:58.883

studio.html5rocks.com/

这里有一个例子，但在缩小时它是一个静止帧。该代码在那里可用，因此您可以尝试一下，我想可以做到，但是我从未见过。

# json - 如何使用 Enunciate 为 GWT 生成 JSON 覆盖？

> ID：11140734
> 
> 赞同：0
> 
> 时间：2012-06-21T14:48:08.940
> 
> 标签：json, gwt, jersey, enunciate

Enunciate[主页](http://enunciate.codehaus.org/)仅提供了如何为[GWT-RPC-API](http://enunciate.codehaus.org/module_gwt.html#artifacts)创建客户端库的线索，但我已经开发了一个 REST API，所以如果 JSON 覆盖也可以使用 Enunciate 生成，那就太好了。（我也用它来创建其他库。） Enunciate 说该功能已经存在，但我找不到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:12:07.213

我找到了一个有用的样本，名为[pet clinic](https://github.com/stoicflame/enunciate/blob/master/integration-tests/petclinic/enunciate.xml)，它显示了基本程序。

# eclipse - Perl EPIC 调试带来 ActiveState 开发工具包调试器

> ID：11140737
> 
> 赞同：1
> 
> 时间：2012-06-21T14:48:19.857
> 
> 标签：eclipse, perl, debugging, activestate, epic

最近，我在工作时排队等待在我的机器上接收 ActiveState 调试器。过去，我在安装了 PadWalker 模块的 Eclipse 中开发和调试了我的 Perl 代码。

当我现在运行调试模块时，它会尝试启动 ActiveState 的调试实用程序（我没有许可证）。

我对 Eclipse 不是非常精通，但是我确实尝试在调试启动设置中四处查看以消除这种情况，但无济于事。

我还在我的环境变量中删除了对 ActiveState 的引用，但还是没有运气。

有解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T14:42:45.097

我发现 ActiveState 包含一个注册表项，它在调用调试会话时启动 ActiveState 调试器。

通过进入`HKEY_LOCAL_MACHINE\SOFTWARE\Perl`注册表并删除条目`PERL5DB`，这解决了问题。`REG_SZ`我在将来可能会被要求使用 Perl 开发工具包 (PDK) 时制作了一个备份副本...

[我在这里](http://community.activestate.com/faq/restoring-the-native-perl)找到了修复。

# specflow - SpecFlow 文档

> ID：11140743
> 
> 赞同：1
> 
> 时间：2012-06-21T14:48:35.433
> 
> 标签：specflow

我在哪里可以阅读 SpecFlow 文档，该文档告诉我`[BeforeScenario]`和`[BeforeTestRun]`属性以及它们何时运行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T16:44:26.827

这里有一些基本信息：[http ://www.specflow.org/documentation/Hooks/](http://www.specflow.org/documentation/Hooks/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-11T14:20:31.810

*   `[BeforeTestRun]`并`[AfterTestRun]`表示将在所有测试之前和之后执行的代码
*   `[BeforeFeature]`并`[AfterFeature]`表示将在每个功能之前和之后执行的代码
*   `[BeforeScenario]`并`[AfterScenarion]`表示将在功能内的每个场景之前和之后执行的代码
*   `[BeforeScenarioBlock]`并`[AfterScenarioBlock]`表示将在每个场景块之前和之后执行的代码

您可以在下面看到一个包含 3 个块的场景示例。测试将在 Given/When/Then 块之前和之后执行：

[场景块](http://i.stack.imgur.com/vkkFZ.png)

*   `[BeforeScenarioStep]`并`[AfterScenarioStep]`表示将在每个场景步骤之前和之后执行的代码

有关在 SpecFlow 中使用和设置挂钩的更多信息，您可以在下面找到：

[SpecFlow - 在测试中使用 Hooks](https://ralucasuditu-softwaretesting.blogspot.ro/2016/04/specflow-using-hooks-in-your-tests.html "SpecFlow - 在测试中使用 Hooks")

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-28T10:22:06.863

还有关于复数视力 SpecFlow 提示和技巧的很好[的](http://www.pluralsight.com)培训

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-18T05:58:08.057

以下是规范流程入门链接。 [https://specflow.org/getting-started/](https://specflow.org/getting-started/)

# c - 编译某些函数所需的库

> ID：11140746
> 
> 赞同：2
> 
> 时间：2012-06-21T14:48:44.490
> 
> 标签：c, linux, openssl, debian

我在一个程序中使用了这些函数：`check_ssl_rv`, `initialize`, `select_engine`, `sign_data`, `clean_engine`,`clean_up`
然后我用它编译它`gcc -o opname codename.c`
但是它显示了很多错误。我知道这是由于我浏览网页时缺少某些链接库。
所以我将编译命令更改为`gcc -o opname codename.c -lssl -lcrypt -lpthread`. 但是在编译上述函数时再次显示错误，`sign.c:(.text+0x68): undefined reference to 'check_ssl_rv'`
然后我从stackoverflow本身找到了以下链接： 但它没有提供有效的解决方案。谁能告诉我要链接哪些所有库来编译具有上述功能的代码。提前致谢。操作平台是linux。
[`Trouble with header file`](https://stackoverflow.com/questions/11135178/trouble-with-header-file)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T17:03:48.213

如果它不是标准库，则需要从提供者处获取库文件（可能与标头一起提供），然后与源文件一起编译。

# php - 从 PHP 到 Actionscript 3 动态创建的 XML

> ID：11140748
> 
> 赞同：4
> 
> 时间：2012-06-21T14:48:45.207
> 
> 标签：php, xml, actionscript-3

我正在尝试使用 php 动态创建 XML 文件，如下所示：

```
 header ("content-type: text/xml");

  // create doctype
  $dom = new DOMDocument("1.0");

  // create root element
  $root = $dom->createElement("tracklist");
  $dom->appendChild($root);
  $dom->formatOutput=true;

  // create child element
  foreach ($commonPlaylist as $value) {

     $trackArray = getTrackForID($value['ID']);

     $item = $dom->createElement("track");
     $root->appendChild($item);

     foreach ( $trackArray as $key => $value) {
      $attr = $dom->createAttribute($key);
      $item->appendChild($attr);

          $attrValue = $dom->createTextNode($value);
      $attr->appendChild($attrValue);
     }

  }

 echo $dom->saveXML(); 
```

文件的输出是正常工作的xml

```
<?xml version="1.0"?>
   <tracklist>
        <track ID="4" title="Track01" artist="Artist01" url="" length="" coverURL=""/>
        <track ID="1" title="Track02" artist="Artist02" url="" length="" coverURL=""/>
        <track ID="8" title="Track03" artist="Artist03" url="" length="" coverURL=""/>
   </tracklist> 
```

但是，如果我想使用以下代码将此数据导入 as3：

```
var myLoader:URLLoader = new URLLoader();
myLoader.load(new URLRequest("getPlaylist.php"));
myLoader.addEventListener(Event.COMPLETE, processXML);

function processXML(e:Event):void
{
    var myXml:XML= new XML(e.target.data);
    trace(myXml);  // The variable is being traced. 
```

}

我根本没有得到任何输出。如果我将文件作为字符串读取，我会得到整个 PHP 代码。我究竟做错了什么？

预先感谢您的任何帮助。

问候， 马特奥

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:56:03.277

> 如果我将文件作为字符串读取，我会得到整个 PHP 代码

听起来它没有在服务器端执行。您是否将其托管在安装了 PHP 的服务器上？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:55:55.737

检查变量名

*   您正在跟踪 myXML 并且 XML 变量名称是 myXml

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:05:33.253

真的`processXML()`是触发了吗？尝试像下面的代码一样修改它，看看你是否得到“嗨！” 部分追踪。

```
function processXML(e:Event):void
{
    trace('Hi!');
    var myXml:XML= new XML(e.target.data);
    trace(myXML);
} 
```

顺便说一句，使用 Flash 调试器可能比试图猜测出了什么问题更有用:) 由于 Flash Professional 附带的调试器很糟糕，我只能推荐[DeMonster 调试器](http://demonsterdebugger.com/)，它在处理 Flash 项目时为我节省了大量时间。[拥有像Fiddler](http://www.fiddler2.com/fiddler2/)这样的 HTTP 流量分析工具也没有什么坏处。

# hadoop - org.apache.hadoop.mapred.TaskTracker：运行子错误：java.lang.OutOfMemoryError：Java 堆空间

> ID：11140750
> 
> 赞同：0
> 
> 时间：2012-06-21T14:48:49.067
> 
> 标签：hadoop, out-of-memory, hive

我正在运行一个简单的连接查询

```
select count(*) from t1 join t2 on t1.sno=t2.sno 
```

但是它给出了内存不足的异常。

两者`t1`和`t2`都是在`rcfile`ssn 上进行聚类和排序的格式，每个都有 2000 万条记录。我有 3 个具有 4 GB 内存和 2 个 CPU 内核的数据节点。

我试过运行地图连接，但它也失败了。

其他配置选项是：

```
io.sort.mb- 500 MB
io.sort.factor- 10
fs.memory.size.mb- 500 MB 
```

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T13:26:16.683

您必须配置属性 mapred.child.java.opts，如本文[所示](https://stackoverflow.com/questions/8464048/out-of-memory-error-in-hadoop)

# c# - Couchbase .Net 库复杂的 startKey/endKey 类型

> ID：11140751
> 
> 赞同：0
> 
> 时间：2012-06-21T14:48:57.957
> 
> 标签：c#, .net, rest, couchbase

我需要将这些参数从 REST-API 查询转换为 C# LINQ。

> ?descending=true&endkey=[35,37]&startkey=[35,37,{}]

在 LINQ 中，此查询如下所示：

> c.GetView("MyView", "SubView").StartKey(startKey).EndKey(endKey).Descending(true);

变量 startKey 和 endKey 应该是什么类型？

我试过字符串，但在这种情况下，.Net 库会产生带有无效参数的查询：

> ?descending=true&endkey="[35,37]"&startkey="[35,37,{}]"

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-22T09:56:23.973

我做了一些研究并找到了答案。根据[https://github.com/couchbase/couchbase-net-client/blob/master/src/Couchbase/CouchbaseViewBase.cs#L320](https://github.com/couchbase/couchbase-net-client/blob/master/src/Couchbase/CouchbaseViewBase.cs#L320)

我终于找到了我的 LINQ 变量的类型：

> 对象[] startKey = 新对象[] { 35, 37, "{}" };
> 
> 对象[] endKey = 新对象[] { 35, 37};

和查询：>

> c.GetView("MyView", "SubView").StartKey(startKey).EndKey(endKey).Descending(true);

# jquery-ui - 我无法在 kendo ui 拆分器中使用可拖动的 jQueryUI

> ID：11140757
> 
> 赞同：3
> 
> 时间：2012-06-21T14:49:21.220
> 
> 标签：jquery-ui, kendo-ui

我尝试使用 jqueryUI draggable 在 kendoSplitter 中拖动一个元素，但它不能。有人建议将 z-index 设置为更高，但即使我也无法解决这个问题。 [这里 jsfiddle 示例](http://jsfiddle.net/zGZ3d/)

请任何人建议使用 jsfiddle 示例解决它的方法。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-28T19:25:21.457

Jquery 可拖动事件`dragstart`在 DOM 树上冒泡，您的水平元素接管了 dragstart 事件。

我以你的例子为例，简单地将事件与#horizo​​ntal 解除绑定

```
$(document).ready(function(e)
{
    var win_width = $(document).width();
    var win_height = $(document).height();
    var top_pane_height = 50;
    var bottom_pane_height = 50;
    var middle_pane_height = win_height - (top_pane_height + bottom_pane_height);
    var kendoElement = $("#horizontal").css('height', middle_pane_height).kendoSplitter(
    {
        orientation:'horizontal',
        panes:
        [
            { size: "18%", collapsed: false, collapsible: true, resizable: false},
            { collapsible: false, resizable: false },
            { size: "18%", collapsed: false, collapsible: true, resizable: false}
        ]
    });
    $("#panelBar").kendoPanelBar();
    var draggable = $('#center-pane').find(".draggable").draggable({stack: "#center-pane"});
    kendoElement.unbind('dragstart');
});​ 
```

# subscription - IAP 订阅

> ID：11140759
> 
> 赞同：1
> 
> 时间：2012-06-21T14:49:25.743
> 
> 标签：subscription, in-app-purchase

我正在开发一个专业应用程序，它根据一组输入参数生成数字输出（电子表格）。该应用程序正在增长，并且基于 Apple 不会对应用程序升级收费的事实，我一直在使用 IAP 购买来允许访问新功能。好的，这在一定程度上可行，但由于现在需要进行 IAP 购买的数量，我有惹恼客户的危险。

因此，我正在研究应用程序的订阅模式，该模式将允许用户支付滚动订阅以访问应用程序的各个部分……可能是数据库或访问云。

简单的问题....我无法从他们的指导方针中完全理解这一点....允许吗？您是否可以说拥有用于访问云或访问功能的订阅 IAP 模型。

任何建议表示赞赏

/使困惑

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T09:29:10.650

希望这可以帮助你[http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction/Introduction.html](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction/Introduction.html)

# regex - Matching a character before or after a word, but not both in regex

> ID：11140770
> 
> 赞同：5
> 
> 时间：2012-06-21T14:50:00.630
> 
> 标签：regex

Lets say I need to match a word `word` where there may be a period before word or after word but not both. Then `word`, `.word`, and `word.` should be matched, but `.word.` should not be matched. How would I match this and capture what occurred before and after the word?

That was a simplified example that I'll need to extend to more complicated cases. For example, now the symbols `.` and `'` may occur before or after the word, but they can only occur once. So for example, `.word`, `'word`, `word.'`, and `.word'` are just a few of the valid matches, but something like `.'word.'` shouldn't match, or even `.'word'`.

The above example is my main priority, but an added bonus would be the order in which the period and apostrophe are added. Thus `'.word` and `.'word` should both match. I think one way that should work for this is `\.?'?|'?\.?word`, but I was hoping for some way where the number of statements in the OR clause doesn't depend on the number of symbols.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:53:27.303

好的。它需要更多时间才能正确处理`word`出现在字符串开头或结尾的情况。

```
 "(?:\.word(?:[^.]|$))|(?:(?:[^.]|^)word(?:[^.]|$))|(?:(?:[^.]|^)word\.)" 
```

**Lookaheads**和**Lookbehinds**相同`regexp`（在 python 中测试）：

 ****```
 "(?:\.word(?:(?!\.)|$))|(?:(?:(?<!\.)|^)word(?:(?!\.)|$))|(?:(?:(?<!\.)|^)word\.)" 
```

有用：

```
 re.findall(pattern(above), '.word. .word .word. word.'") // return ['.word ', ' word.'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T13:30:49.293

哪种口味？如果是 JavaScript，这应该可以工作：

```
(?:^|[^\w.'])(?=[.']*(word))(?!'*\.'*\1'*\.)(?!\.*'\.*\1\.*')([.']*)\1([.']*) 
```

解释：

*   `(?:^|[^\w.'])`- 确保`word`不是较大单词的结尾，并防止正则表达式绕过前导分隔符（`.`或`'`）（如果它们在那里）。

*   `(?=[.']*(word\b))`- 确保`word`不是较长单词的*开头*，并且它前面除了您选择的分隔符之外什么都没有。这个时候这个词没有被消费，它只是在第 1 组中被捕获，所以它可以用来锚定接下来的两个前瞻。

*   `(?!'*\.'*\1'*\.)`- 仍然位于前导分隔符（如果有）之前，这可以确保如果`.`单词之前有一个，那么它之后就没有一个。

*   `(?!\.*'\.*\1\.*')`- 这对`'`.

*   `([.']*)\1([.']*)`- 最后，继续使用单词以及任何前导或尾随分隔符，捕获组#2 和#3 中的那些。

如果您使用的风格支持后视，它可能无济于事。大多数风味都对可以在后视中匹配的内容施加了严格的限制，使其对这项任务毫无用处。上面的 JavaScript 正则表达式可能仍然是您的最佳选择。但是，这个正则表达式在 .NET 和 JGSoft 中有效，这是我所知道的唯一支持完全不受限制的后视的风格：

```
(?<=(?:\.(?<dot1>)|'(?<apos1>))*)\bword\b(?=(?:\.(?<dot2>)|'(?<apos2>))*)(?!\k<dot1>\k<dot2>|\k<apos1>\k<apos2>) 
```

解释：

*   `(?<=(?:\.(?<dot1>)|'(?<apos1>))*)`- 向后扫描分隔符。当每一个都匹配时，它后面的空捕获组有效地将该字符标记为已被看到。

*   `\bword\b`- 消耗这个词。

*   `(?=(?:\.(?<dot2>)|'(?<apos2>))*)`- 向前扫描以查找更多分隔符并检查它们，就像向后查找一样。

*   `(?!\k<dot1>\k<dot2>|\k<apos1>\k<apos2>)`- 断言单词前后都没有出现点和撇号。对空组的反向引用从不消耗任何字符，它只是断言该组已参与比赛。

在这两种风格之后，Java 的lookbehind 可能是最灵活的，但它也出了名的漏洞百出。我*应该*能够通过将第一个更改为 来将此正则表达式移植到 Java `*`，`{0,2}`但它只会抛出“没有明显的最大长度”异常。同样，您最好使用上面与 JavaScript 兼容的正则表达式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T16:29:44.613

这适用于您提供的好值和坏值的javascript。

```
var func = function (str) {
    var result = true, match, re = /^([^a-z]+)[a-z]+([^a-z]+)$/i;
    if (re.test(str)) {
        match = re.exec(str);
        re = new RegExp("[" + match[1] + "]");
        result = !re.test(match[2]);
    }
    return result;
}; 
```

这是一个简单的解释。如果字符串在字母之前和之后包含非字母，则非字母将被提取并相互测试。否定测试的结果，以确定这个词是好是坏。

```
str = .'word.
".'", "word", "."
/[.']/.test( "." ) 
```

该`func`函数需要一个单词（没有空格的字符）作为字符串。如果要检查一个句子，然后用空格分隔，然后检查每个单词。像这样的东西。

```
 var sentence = "What does .'words'. means?";
var words = sentence.split(/\s+/g);
    var areWordsOk;
for( var i = 0, len = words.length; i < len; i++ ){
    areWordsOk = func( words[i] );
    if( !areWordsOk ){
        throw new Error( "bad word." ); // error is thrown
    }
} 
```

这是我的测试用例。现场演示：http: [//jsfiddle.net/Tb68G/2](http://jsfiddle.net/Tb68G/2) 这是测试用例的来源。

```
var func = function (str) {
    var result = true, match, re = /^([^a-z]+)[a-z]+([^a-z]+)$/i;
    if (re.test(str)) {
        match = re.exec(str);
        re = new RegExp("[" + match[1] + "]");
        result = !re.test(match[2]);
    }
    return result;
};
test("test good values", function () {
    var arr = [
        "word",
        ".word",
        "word.",
        ".word",
        "'word",
        "word.'",
        ".word'"
    ];
    var i = arr.length,
    str;
    while (i--) {
        str = arr[i];
        equal(func(str), true, str + " should be true.");
    }
});
test("test bad values", function () {
    var arr = [
        ".word.",
        ".'word.'",
        ".'word'.",
        ".'word'"
    ];
    var i = arr.length,
    str;
    while (i--) {
        str = arr[i];
        equal(func(str), false, str + " should be false.");
    }
}); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-21T15:19:51.143

我在想正则表达式是一个很酷的东西......
但有时，你需要使用其他方法，
看着如此可怕的表达简单的事情......

我说编码！

```
 int findWord(string text, string word, char ch, int startIdx = 0)
    {
        while(startIdx < text.Length)
        {
            int indexOf = text.IndexOf(word, startIdx);
            if (indexOf < 0) return -1;

            char preChar = (char) 0;
            char postChar = (char) 0;

            if (indexOf > 0)
                preChar = text[indexOf - 1];

            if (indexOf < text.Length - word.Length)
                postChar = text[indexOf + word.Length];

            if ((preChar == ch) ^ (postChar == ch))
            {
                return indexOf;
            }
            startIdx = indexOf + word.Length + 1;
        } 
    } 
```

没那么简单，不止一行 :)
但性能更好，一两个月后阅读就可以理解。****

# django - django CharField 定义

> ID：11140774
> 
> 赞同：2
> 
> 时间：2012-06-21T14:50:19.737
> 
> 标签：django, model

在我经常看到的一些 django 模型中

```
myfield = models.CharField(_('myfield'))
class_name = models.CharField(_('Type'), max_length=128) 
```

究竟是`_ and tuple`为了什么？我从未在官方 django 教程片段中看到任何此类

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-21T14:52:46.393

去看看文件的顶部，但最常见的是这个重命名的导入：

`from django.utils.translation import ugettext as _`

（所以这是一个函数调用，而不是一个元组）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-21T15:02:24.637

然后您没有查看[文档](https://docs.djangoproject.com/en/dev/topics/i18n/translation/#standard-translation)的正确位置：

> 使用函数 ugettext() 指定翻译字符串。按照惯例，将其导入为较短的别名 _，以节省输入。

```
from django.utils.translation import ugettext as _

def my_view(request):
    output = _("Welcome to my site.")
    return HttpResponse(output) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:54:15.983

```
from django.utils.translation import ugettext as _ 
```

是的，这个库用于翻译你的 django 项目中的所有字符串，当然你必须标记这些翻译字符串，看看这个[Django Docs](https://docs.djangoproject.com/en/dev/topics/i18n/translation/)

# spring - 如何在 Grails 中注册自定义类型转换器？

> ID：11140784
> 
> 赞同：2
> 
> 时间：2012-06-21T14:50:51.350
> 
> 标签：spring, grails

我找到了有关[如何使用 Spring 3 创建自定义类型转换器](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/validation.html#core-convert)的文档，但是我找不到在 Grails 中注册转换器以便`bindData`可以使用它的任何示例。

我尝试将此配置添加到 conf/spring/resources.groovy 文件中：

```
conversionService(org.springframework.context.support.ConversionServiceFactoryBean) {
    converters {
        com.initech.reports.tps.StringToFooConverter
    }   
} 
```

这最终会踩到一些东西，因为一旦我添加转换器，我就会在启动时得到一个堆栈跟踪，如下所示：

> 2012-06-21 10:09:50,614 [main] 错误 context.GrailsContextLoader - 执行引导程序时出错：创建名称为“FooApprovers”的 bean 时出错：无法创建 [org.springframework.xml. xsd.commons.CommonsXsdSchemaCollection] 同时设置 bean 属性'schemaCollection'；嵌套异常是 org.springframework.beans.factory.BeanCreationException：创建名称为 '(inner bean)#7' 的 bean 时出错：bean 的初始化失败；嵌套异常是 org.springframework.beans.TypeMismatchException：无法将类型“java.lang.String[]”的属性值转换为属性“xsds”所需的类型“org.springframework.core.io.Resource[]”；嵌套异常是 org.springframework.core.convert.ConversionFailedException：无法将值“{/WEB-INF/ws/FooApproversService.xsd}”从“java.lang.String[]”类型转换为“org.springframework.core.io.Resource[]”类型；嵌套异常是 org.springframework.core.convert.ConverterNotFoundException：找不到能够从“java.lang.String”转换为“org.springframework.core.io.Resource”的转换器 org.springframework.beans.factory.BeanCreationException：错误创建名为“FooApprovers”的bean：在设置bean属性“schemaCollection”时无法创建[org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection]类型的内部bean“（内部bean）”；嵌套异常是 org.springframework.beans.factory.BeanCreationException：创建名称为 '(inner bean)#7' 的 bean 时出错：bean 的初始化失败；嵌套异常是 org.springframework.beans.TypeMismatchException：无法将类型“java.lang.String[]”的属性值转换为属性“xsds”所需的类型“org.springframework.core.io.Resource[]”；嵌套异常是 org.springframework.core.convert.ConversionFailedException: Unable to convert value "{/WEB-INF/ws/FooApproversService.xsd}" from type 'java.lang.String[]' to type 'org.springframework.core .io.Resource[]'; 嵌套异常是 org.springframework.core.convert.ConverterNotFoundException：在 org.grails.tomcat.TomcatServer.start( TomcatServer.groovy:212) 在 grails.web.container.EmbeddableServer$start。

我正在使用 Grails 1.3.7（包括 Spring 3.0.5）。

所以显然还有其他一些类型转换器被添加的方式，我通过显式配置转换服务搞砸了？有没有办法在不踩其他转换器的情况下注册自定义类型转换器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:35:17.283

我猜您正在寻找自定义属性编辑器。

您将需要创建自定义属性编辑器和属性编辑器注册器，然后在 resources.groovy 中注册您的注册器 - 之后 bindDate 应该能够使用它

看这篇[文章](http://omaha-seattle.blogspot.in/2010/02/custom-grails-property-editor.html)

# mysql - 使用 SUM + 计算的 SQL 查询，使用 LEFT JOIN

> ID：11140785
> 
> 赞同：2
> 
> 时间：2012-06-21T14:50:55.323
> 
> 标签：mysql, sql

我对 SQL 查询有疑问。如果给定的订单包含项目，女巫不包含子项目，那么订单的总价格为零，否则此查询工作正常。

```
SELECT o.`id`, o.`date`, c.`name`,
      ((i.`quantity` * i.`price`) +
      SUM(i.`quantity` * subi.`quantity_kg` * subi .`price`)) as total_price
FROM `order` o
JOIN `customer` c ON o.`id_customer`=c.`id`
LEFT JOIN `order_item` i ON i.`id_order`= o.`id`
LEFT JOIN `order_subitem` subi ON si.`id_product`= i.`id_product`
GROUP BY o.`id` 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:54:06.877

`coalesce`在`ifnull`您的子项目字段上使用：

```
SELECT o.`id`, o.`date`, c.`name`,
      ((i.`quantity` * i.`price`) +
      SUM(i.`quantity` * coalesce(subi.`quantity_kg`, 0) * coalesce(subi .`price`, 0))) as total_price 
```

这样可以确保这些字段最终不会为空而破坏您的整个计算。例如 null+1 = null

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:53:58.453

```
SELECT o.`id`, o.`date`, c.`name`,
      ((i.`quantity` * i.`price`) +
      SUM(i.`quantity` * IFNULL(subi.`quantity_kg`, 0) * IFNULL(subi .`price`, 0))) as total_price
FROM `order` o
JOIN `customer` c ON o.`id_customer`=c.`id`
LEFT JOIN `order_item` i ON i.`id_order`= o.`id`
LEFT JOIN `order_subitem` subi ON si.`id_product`= i.`id_product`
GROUP BY o.`id` 
```

如果您知道 order_item 应该存在，那么您应该为此表使用 INNER JOIN。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T14:55:21.930

我怀疑问题在于您返回的是 NULL，而不是 0。要解决此问题，您只需要 coalesce 函数来处理 NULL 情况：

```
SELECT o.`id`, o.`date`, c.`name`,
       ((i.`quantity` * i.`price`) +
        SUM(i.`quantity` * coalesce(subi.`quantity_kg`, 0) * coalesce(subi .`price`, 0))
       ) as total_price
FROM `order` o JOIN
     `customer` c
     ON o.`id_customer`=c.`id` LEFT JOIN
     `order_item` i
     ON i.`id_order`= o.`id` LEFT JOIN
     `order_subitem` subi ON si.`id_product`= i.`id_product`
GROUP BY o.`id` 
```

# python - 关闭 pyplot 窗口

> ID：11140787
> 
> 赞同：41
> 
> 时间：2012-06-21T14:51:02.313
> 
> 标签：python, tkinter, matplotlib

最终编辑：

我在关闭 pyplot 窗口的主题上发现它真的可能不应该使用 pyplot 来完成。SRK 给出了一个很好的例子，说明如何处理将在下面的答案中更新的图。此外，我偶然发现了如何将 pyplot 图放入 Tkinter 窗口，而 Tkinter 比 pyplot 更擅长打开和关闭窗口。这[是如何将 pyplot 图放入 Tk 窗口的](http://matplotlib.sourceforge.net/examples/user_interfaces/embedding_in_tk.html)方法，这也是[一个很好的例子](https://stackoverflow.com/questions/3554241/how-to-embed-this-matplotlib-code-into-tkinter-canvas)。

/最终编辑

我希望能够显示几个图，然后能够从一些代码输入中单独关闭（从屏幕上删除）它们，但我不知道执行此操作的代码输入。

以下是我到目前为止所尝试的。我玩过 show 和 close 命令的位置，但我从中得到的唯一真正结果是没有出现一个或另一个情节，但我无法从屏幕上删除情节。我一直在插入 raw_input() 来创建暂停。

编辑：这些情节是从 Tkinter gui 调用的，如果有更好的方法可以从那个方向执行此操作，我会很高兴听到它。

任何输入将不胜感激，谢谢。

```
import matplotlib.pyplot as plt

a = range(0,10)
b = range(0,20,2)
c = range(0,30,3)
d = range(0,40,4)

plot1 = plt.figure()
plt.plot(a,b, 'r-o')

plt.show()

plt.close()

plot2 = plt.figure()
plt.plot(c,d, 'b-o')

plt.show()
plt.close() 
```

编辑代码：这也不起作用。

```
plot1 = plt.figure(1)
plt.plot(a,b, 'r-o')

plot2 = plt.figure(2)
plt.plot(c,d, 'b-o')
#plt.close(1)
#this will prevent plot1 from being displayed
plt.show()
plt.close(1)  # or ('all') or (plot1) 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-06-21T15:16:37.817

`plt.close()`将关闭当前实例。

`plt.close(2)`将关闭图 2

`plt.close(plot1)`将用实例 plot1 关闭图形

`plt.close('all')`将关闭所有火灾

[在这里](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.close)找到。

请记住，这`plt.show()`是一个*阻塞*函数，因此在您上面使用的示例代码中，`plt.close()`在窗口关闭之前不会执行，这使得它变得多余。

您可以`plt.ion()`在代码的开头使用使其成为非阻塞的，尽管这有其他含义。

## 例子

在我们在评论中讨论之后，我整理了一些示例来演示如何使用绘图功能。

下面我创建一个情节：

```
fig = plt.figure(figsize=plt.figaspect(0.75))
ax = fig.add_subplot(1, 1, 1)
....
par_plot, = plot(x_data,y_data, lw=2, color='red') 
```

在这种情况下，`ax`上面是一对轴的句柄。每当我想对这些轴做某事时，我可以通过调用将我当前的一组轴更改为这个特定的集合`axes(ax)`。

`par_plot`是 line2D 实例的句柄。这被称为艺术家。如果我想改变线条的属性，比如改变 ydata，我可以通过参考这个句柄来实现。

我还可以通过执行以下操作来创建滑块小部件：

```
axsliderA = axes([0.12, 0.85, 0.16, 0.075])
sA = Slider(axsliderA, 'A', -1, 1.0, valinit=0.5)
sA.on_changed(update) 
```

第一行为滑块创建一个新轴（称为`axsliderA`），第二行创建一个`sA`放置在轴中的滑块实例，第三行指定当滑块值更改时要调用的函数（`update`）。

我的更新功能可能如下所示：

```
def update(val):
    A = sA.val
    B = sB.val
    C = sC.val
    y_data = A*x_data*x_data + B*x_data + C
    par_plot.set_ydata(y_data)
    draw() 
```

使用句柄更改*Line2D*对象的`par_plot.set_ydata(y_data)`ydata*属性*。*`par_plot`*

 *该`draw()`函数更新**当前**的轴集。

把它们放在一起：

```
from pylab import *
import matplotlib.pyplot as plt
import numpy

def update(val):
    A = sA.val
    B = sB.val
    C = sC.val
    y_data = A*x_data*x_data + B*x_data + C
    par_plot.set_ydata(y_data)
    draw()

x_data = numpy.arange(-100,100,0.1);

fig = plt.figure(figsize=plt.figaspect(0.75))
ax = fig.add_subplot(1, 1, 1)
subplots_adjust(top=0.8)

ax.set_xlim(-100, 100);
ax.set_ylim(-100, 100);
ax.set_xlabel('X')
ax.set_ylabel('Y')

axsliderA = axes([0.12, 0.85, 0.16, 0.075])
sA = Slider(axsliderA, 'A', -1, 1.0, valinit=0.5)
sA.on_changed(update)

axsliderB = axes([0.43, 0.85, 0.16, 0.075])
sB = Slider(axsliderB, 'B', -30, 30.0, valinit=2)
sB.on_changed(update)

axsliderC = axes([0.74, 0.85, 0.16, 0.075])
sC = Slider(axsliderC, 'C', -30, 30.0, valinit=1)
sC.on_changed(update)

axes(ax)
A = 1;
B = 2;
C = 1;
y_data = A*x_data*x_data + B*x_data + C;

par_plot, = plot(x_data,y_data, lw=2, color='red')

show() 
```

关于上述内容的注释：当我运行应用程序时，代码会按顺序运行（`update`我认为它将函数存储在内存中），直到它遇到阻塞的 show()。当您更改其中一个滑块时，它会从内存中运行更新功能（我认为？）。

这就是 show() 以这种方式实现的原因，以便您可以通过使用函数来处理数据在后台更改值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2020-02-21T05:24:37.253

请用

```
plt.show(block=False)
plt.close('all') 
```*

# jquery - Hide if over other elements

> ID：11140790
> 
> 赞同：0
> 
> 时间：2012-06-21T14:51:11.137
> 
> 标签：jquery

I have a div with fixed position inside another div that spans down past the page fold. Now, there are other elements withing that parent div as well, mostly at the top of the page. I would like to hide the child with fixed position if it happens to be over another element within this parent, for example if a user resizes the window. How can I do that with jQuery?

Here's what I've got so far:

**JS**

```
$(function(){
    function floatingDiv(){
        var m = $('#parentDiv'), offset = m.offset(), posL = Math.floor(offset.left - 15);
        $('#divFloat').remove();
        m.append(\"<div id='divFloat' style='position:fixed;left:\"+ posL +\"px; bottom:55px; border:0'><a href='/' style='width:168px;height:43px; background: url(/i/free3day.png) no-repeat center center;position:fixed; border:0; left:\"+ posL +\"px;bottom:55px'></a></div>\");
    }

    floatingDiv();

    $(window).resize(function(){
        floatingDiv();
    });
}); 
```

**HTML**

```
<div id="parentDiv">
    <a href="#">SOME LINK</a>
    <div>some content</div>
</div> 
```

# actionscript - XMLNodes being appended to an XMLNode are "undefined"? Actionscript 2.0 is being unkind

> ID：11140791
> 
> 赞同：-1
> 
> 时间：2012-06-21T14:51:12.720
> 
> 标签：actionscript, xmlnode

If anyone can offer an explanation for this one, I'd *LOVE* to see it! I was required to append a legacy application to display 20 random questions from an XML data source, as opposed to the total of 70 questions that are part of the original XML. No big deal, right? WRONG! I got it to work just fine in the end, but it's a total HACK! For some reason, some of the nodes that I am appending to a dynamically generated XML document are being returned as "undefined". I kept getting between 16 and 20 questions to render until I modified my iteration from a 'for' loop to a 'do while' loop with the appropriate number of XMLNodes as the condition of the 'do while' loop. Can anyone offer an explanation? Below is the code, with some notes for the reader :

function editXML(xml:XML):XML {

```
var node:XMLNode = xml.firstChild;
var newNode:XMLNode = new XMLNode();
var nodeArray:Array = new Array();
var usedNodes:Array = new Array();
var totalNodes:Number = node.lastChild.childNodes.length - 1; 
var nextNode:Number;
var returnNode:XMLNode = new XMLNode();
var tempNode:XMLNode;
var buildNode:XMLNode;
var addNode:Boolean = true;

var tempXML:XML = new XML();
var pagesNode:XMLNode = tempXML.createElement("pages");
tempXML.appendChild(pagesNode);
tempXML.appendChild(node.childNodes[0]);
tempXML.appendChild(node.childNodes[1]);
tempXML.appendChild(node.childNodes[2]);
var questionsNode:XMLNode = tempXML.createElement("pages");
tempXML.firstChild.appendChild(questionsNode);
do
{

    nextNode = Math.floor(Math.random()*totalNodes); 
             **//random number to represent random node**
    //trace(nextNode + " nextNode");
    **//check usedNodes Array to look for node.childNodes[nextNode]. If it already exists, skip and reloop.**
    trace(node.childNodes[1].childNodes[nextNode] + " : pre building Node " + totalNodes);
    if(usedNodes.length == 0)
    {
        buildNode = new XMLNode();
        buildNode.nodeName = node.childNodes[1].childNodes[nextNode].nodeName;
                                       buildNode.nodeValue = node.childNodes[1].childNodes[nextNode].nodeValue;
        tempXML.firstChild.lastChild.appendChild(node.childNodes[1].childNodes[nextNode])
        usedNodes.push(node.childNodes[1].childNodes[nextNode]);
        nodeArray.push(node.childNodes[1].childNodes[nextNode]);
        trace("adding first node : " + nodeArray.length); 
        addNode = false;
    }
    else
    {
       for(var j:Number = 0; j < usedNodes.length; j++)
       {
           if(usedNodes[j] == node.childNodes[1].childNodes[nextNode])
           {                
               addNode = false;
               trace("skipping node : " + nodeArray.length);
           }
       }
    }
    **//if node not in usedNodes, add node to XML**
    if(addNode)
    {           

        trace(node.childNodes[1].childNodes[nextNode] + " : building Node"); **//This trace statement produced a valid node**
        tempXML.firstChild.lastChild.appendChild(node.childNodes[1].childNodes[nextNode]);
      **//Before modifying the code from adding nodes to the xml from an Array called 'nodeArray' in a for loop to adding nodes directly to the xml in a do while loop with the length of the xml node used to retrieve data for the questions as the condition, I was not always getting 20 questions. Some of the nodes were being rendered as 'undefined' and not appended to the xml, even though they were traced and proven valid before the attemp to append them to the xml was made**
        usedNodes.push(node.childNodes[1].childNodes[nextNode]);            
  }

    addNode = true;
}
while(tempXML.firstChild.lastChild.childNodes.length <= 19);
trace(tempXML.firstChild.lastChild.childNodes.length + " final nodes Length");

courseXML = tempXML;
//removes the old question list of 70 and replaces it with the new question list of 20\. Question list is the last node.

return tempXML; 
```

}

If I had my choice, I would have rebuilt the whole application in Flex with AS3\. I didn't have that choice. If anyone can explain this mystery, PLEASE DO! Thank you in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-23T03:12:45.940

我不太明白最初的问题是什么，因为你没有发布你的非工作代码，只是你的代码不是非常好，但工作的代码。我所看到的只是一个不是最好的方法的问题，无论语言如何。

我的建议是这样的：

1.  如果出于某种原因您需要保留最初的 70 个 XML 问题，请通过调用 toString() 复制一份，然后再转换回 XML。这将破坏任何可能存在的对象依赖关系（尽管我不知道 AS2 XML 是否像真实对象一样）。
2.  在每个循环中，删除您添加到新 XML 中的节点。这样，您就不必执行该内部循环来检查您是否已经使用过它（这确实是低效的）。
3.  既然要删除它，为什么不把它移到新的 XML 中而不是创建一个新节点呢？这样你就不需要使用 Florian 建议的辅助变量而不是几个看起来像的表达式`node.childNodes[1].childNodes[nextNode].nodeName;`
4.  在这一点上，您将只循环 20 次，或者您可以在循环时继续……没关系。任何一个都会导致 20 个循环和 20 个随机问题。

# jquery - Function doesn't seem to return true

> ID：11140795
> 
> 赞同：2
> 
> 时间：2012-06-21T14:51:16.137
> 
> 标签：jquery, datatables

I am using the DataTables plugin and the colorbox plugin. I am trying to have my function return true if the .post is a success.

```
jQuery('.msg_delete').live('click', function () {
        var aData = oTable.fnGetData(nTr);
        if (deleteMessage(aData[6]) == true) {
            jQuery.colorbox.close();
            oTable.fnDeleteRow(nTr);
        }
        return false;
    });

function deleteMessage(messageID) {
    jQuery.post('ajax/msg_functions.asp', { action: 'delete', messageid: messageID }, function (data) {

    })
    .success(function () { return true; })
    .error(function () { alert("There was an error while trying to make this request;  If it persists please contact support"); })
    ;
} 
```

Right now it correctly does the post. I know this because the message is deleted. So I assume it goes to the `.success` and I would think would now return true. But it doesn't seem to be doing that.

It never seems to go to the `colorbox.close()` or `fnDeleteRow.` Can anyone see what I am missing here?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T14:53:42.773

您的 return 仅从当前函数返回，即您传入的匿名函数`$.ajax`。

您的代码将无法按照当前的组织方式运行，使用示例。

```
jQuery('.msg_delete').live('click', function() {
    var aData = oTable.fnGetData(nTr);
    deleteMessage(aData[6]).done(function(){
        jQuery.colorbox.close();
        oTable.fnDeleteRow(nTr);
    });
    return false;
});

function deleteMessage(messageID) {
    return jQuery.post('ajax/msg_functions.asp', {
        action: 'delete',
        messageid: messageID
    }).fail(function() {
        alert("There was an error while trying to make this request;  If it persists please contact support");
    });
}​ 
```

还有，`.success`是折旧的，使用`.done`

编辑：

为了完整起见，您可以使用`async:false`并存储`true`或存储`false`在一个变量中，然后从您的函数中返回它，但是由于`async:false`暂停代码执行和用户交互，效率较低且不推荐使用。

# scala - What is the difference between the following ways to write a function in Scala?

> ID：11140797
> 
> 赞同：8
> 
> 时间：2012-06-21T14:51:22.713
> 
> 标签：scala

I am new to Scala, and have seen many ways to define a function but could not find a clear explanation on the differences, and when to use which form.

What are the main differences between the following function definitions?

1.  With '='

    ```
    def func1(node: scala.xml.Node) = {
        print(node.label + " = " + node.text + ",")
    } 
    ```

2.  Without '='

    ```
    def func2 (node: scala.xml.Node) {
        print(node.label + " = " + node.text + ",")
    } 
    ```

3.  With '=>'

    ```
    def func3 = (node: scala.xml.Node) => {
        print(node.label + " = " + node.text + ",")
    } 
    ```

4.  As a var

    ```
    var func4 = (node: scala.xml.Node) => {
        print(node.label + " = " + node.text + ",")
    } 
    ```

5.  Without a block

    ```
    def func5 (node: scala.xml.Node) = print(node.label + " = " + node.text + ",") 
    ```

They all seem to compile and render the same result when used as a callback for

```
 xmlNodes.iterator.foreach(...) 
```

*   Is there any difference in the bytecode each generate?
*   Are there any guidlines when to use which form?

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-21T15:13:18.850

这些问题中的每一个都已在本网站的其他地方得到解答，但我认为没有任何东西可以一起处理它们。所以：

### 大括号和等号

用等号定义的方法返回一个值（无论最后的结果是什么）。只用大括号定义的方法返回`Unit`。如果您使用 equals 但最后一件事评估为`Unit`，则没有区别。如果是等号后的单个语句，则不需要大括号；这对字节码没有影响。所以 1.、2\. 和 5\. 本质上是相同的：

```
def f1(s: String) = { println(s) }     // println returns `Unit`
def f2(s: String) { println(s) }       // `Unit` return again
def f5(s: String) = println(s)         // Don't need braces; there's only one statement 
```

### 函数与方法

一个函数，通常写成`A => B`，是其中一个类的子`Function`类，例如`Function1[A,B]`。因为这个类有一个`apply`方法，当你只使用没有方法名的括号时，Scala 会神奇地调用它，它看起来像一个方法调用——它确实是，除了它是对该`Function`对象的调用！所以如果你写

```
def f3 = (s: String) => println(s) 
```

那么您要说的是“`f3`应该创建一个实例，`Function1[String,Unit]`该实例的`apply`方法看起来像`def apply(s: String) = println(s)`”。所以如果说`f3("Hi")`，这是先调用`f3`创建函数对象，再调用`apply`方法。

每次要使用它时都创建函数对象是相当浪费的，因此将函数对象存储在 var 中更有意义：

```
val f4 = (s: String) => println(s) 
```

这包含`def`（方法）将返回的同一函数对象的一个​​实例，因此您不必每次都重新创建它。

### 什么时候用什么

人们对`: Unit = ...`和的约定存在分歧`{ }`。就我个人而言，我编写了所有`Unit`不带等号返回的方法——这表明该方法几乎肯定是无用的，除非它具有某种副作用（改变变量、执行 IO 等）。此外，我通常只在需要时使用大括号，因为有多个语句，或者因为单个语句非常复杂，我需要一个视觉辅助工具来告诉我它在哪里结束。

任何时候都应该使用方法，嗯，一种方法。函数对象应在您希望将它们传递给其他方法以使用它们的任何时候创建（或者应该在您希望能够应用函数的任何时候指定为参数）。例如，假设您希望能够缩放一个值：

```
class Scalable(d: Double) {
  def scale(/* What goes here? */) = ...
} 
```

你可以提供一个常数乘数。或者你可以提供一些要添加的东西和一些要增加的东西。但最灵活的是，您只需要从`Double`to请求一个任意函数`Double`：

```
def scale(f: Double => Double) = f(d) 
```

*现在，也许您对默认*比例有所了解。这可能根本没有缩放。所以你可能想要一个接受 a`Double`并返回相同的函数`Double`。

```
val unscaled = (d: Double) => d 
```

我们将函数存储在 a 中是`val`因为我们不想一遍又一遍地创建它。现在我们可以使用这个函数作为默认参数：

```
class Scalable(d: Double) {
  val unscaled = (d: Double) => d
  def scale(f: Double => Double = unscaled) = f(d)
} 
```

现在我们可以同时调用`x.scale`and`x.scale(_*2)`并且`x.scale(math.sqrt)`它们都可以工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T15:03:46.523

是的，字节码存在差异。是的，有指导方针。

1.  With `=`：这声明了一个方法，该方法接受一个参数并返回右侧块中的最后一个表达式，该表达式具有`Unit`此处的类型。

2.  没有：这声明了一个没有返回值的方法，也就是说，无论右侧块中最后一个表达式的类型是什么，`=`返回类型始终为 。`Unit`

3.  With `=>`：这声明了一个返回类型为*函数对象*`scala.xml.Node => Unit`的方法。每次调用此方法`func3`时，都会在堆上构造一个新的函数对象。如果您编写`func3(node)`，您将首先调用`func3`返回函数对象，然后调用该`apply(node)`函数对象上的 。这比在情况 1\. 和 2 中直接调用普通方法要慢。

4.  As a `var`：这声明了一个变量并创建了一个函数对象，如 3\. 中一样，但函数对象只创建**一次**。在大多数情况下，使用它来调用函数对象比简单的方法调用要慢（可能不会被 JIT 内联），但至少您不会重新创建对象。如果您想避免有人重新分配变量的危险`func4`，请改用 a`val`或 a `lazy val`。

5.  这是 1\. 当块只包含一个表达式时的语法糖。

请注意，如果您将 1.、2\. 和 5\. 形式与高阶`foreach`方法一起使用，Scala 仍将创建一个调用或隐式调用`func1`的函数对象，并将其传递给（它不会使用方法句柄或类似至少在当前版本中不是这样）。在这些情况下，生成的代码将大致对应于：`func2``func5``foreach`

```
xmlNodes.iterator.foreach((node: scala.xml.Node) => funcX(node)) 
```

因此，指导方针是 - 除非您每次都使用相同的函数对象，否则只需像 1.、2\. 或 5 中那样创建一个普通方法。无论如何，它都会被提升为一个函数对象，这是需要的。如果你意识到这会生成很多对象，因为调用这样的方法经常发生，你可能希望使用表格 4\. 进行微优化，而不是确保函数对象`foreach`只被创建一次。

在 1.、2\. 和 5\. 之间做出决定时，一个准则是 - 如果您只有一个陈述，请使用表格 5。

否则，如果返回类型为`Unit`，则使用`def foo(): Unit = {`公共 API 的形式，以便客户端快速查看您的代码并清楚地看到返回类型。`def foo() {`为返回类型为私有的方法使用该表单`Unit`，以方便您使用更短的代码。但这只是关于风格的一个特定准则。

有关更多信息，请参阅：[http ://docs.scala-lang.org/style/declarations.html#methods](http://docs.scala-lang.org/style/declarations.html#methods)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T15:06:14.237

好吧，1、2 和 5 根本不是函数*，*它们是*方法*，它们与函数有根本的不同：​​方法*属于*对象，它们本身不是对象，而函数*是*对象。

1, 2, 5 也完全一样：如果你只有一个语句，那么你不需要花括号来组合几个语句，所以 5 与 1 相同。省略`=`符号是声明 a 的语法糖的返回类型`Unit`，但`Unit`也是 1 和 5 的推断返回类型，因此 2 与 1 和 5 相同。

3 是一个方法，当被调用时，它会返回一个函数。4 是指向函数的变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T15:03:57.627

1-2。当你扔掉等号时，你的函数就变成了过程（返回单位，或者什么都没有）。
3\. 在第三种情况下，您定义了一个函数`scala.xml.Node => Unit`，它返回一个函数。
4\. 相同，但您已`scala.xml.Node => Unit`为变量分配了一些函数。[在 Scala 5 中定义函数的这三种方式之间](https://stackoverflow.com/questions/3646756/scala-def-versus-val)的差异中解释了差异
。没有区别，与 1 相比。但是你不能写这样的多行语句。

# c# - C# Web 服务和静态变量

> ID：11140799
> 
> 赞同：0
> 
> 时间：2012-06-21T14:51:27.220
> 
> 标签：c#, multithreading, web-services, session

我遇到了一些问题，想知道是否有人可以帮助我解决这个问题。

问题是静态变量在不同的线程调用/季节之间共享。这是原始代码：

```
public partial class ApplicationWSGlobal : System.Web.Services.WebService
{
    public static string UploadPath = @"";

    public ApplicationWSGlobal()
    {
        InitializeComponent();
    }

    [Webmethod]
    public void DoSomeThing()
    {
        ... = UploadPath;            
    }
} 
```

我正在从 global.asax 类中设置 UploadPath。

```
 public void Application_BeginRequest() 
 {
     ApplicationWSGlobal.UploadPath = getData();
 } 
```

我试图通过将`[ThreadStatic]`var 添加到“UploadPath”变量来解决问题，但它不起作用。全局变量在所有会话中运行，我不希望这样

在这种情况下我可以使用任何替代方案吗

我提前感谢所有回复！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:07:12.037

我建议存储`UploadPath`在数据库中。这样就可以保证在所有正在运行的会话中都是全局的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:56:31.243

尝试使用此代码（删除静态修饰符）

```
 public partial class ApplicationWSGlobal : System.Web.Services.WebService
    {
        public string UploadPath = @"";

        [WebMethod]
        public void SetUploadPath(string x)
        {
            UploadPath = x;
        }

        public ApplicationWSGlobal()
        {
            InitializeComponent();
        }
     } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:17:20.833

```
var applicationWSGlobal = new ApplicationWSGlobal
{
   UploadPath = your value
}; 
```

# css - Position an element regardless of other elements

> ID：11140800
> 
> 赞同：0
> 
> 时间：2012-06-21T14:51:32.437
> 
> 标签：css

So I want to position an element across two columns, but only start in the middle of the second column.

Is there a way to do this? The columns are established by divs. I believe it would have to do with positioning via z-index?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:54:05.550

将第二列`position:relative`和要放入的元素放在第二列之间`position:absolute`，调整顶部和左侧。

# c - Linux/gcc：带有 pthread 编译器选项的空地址“00000000”

> ID：11140808
> 
> 赞同：0
> 
> 时间：2012-06-21T14:52:02.687
> 
> 标签：c, linux, gcc, pthreads

我用 pthreads 编译了一个共享库。为什么我使用 pthread 选项编译时地址是“00000000”？这意味着什么 ？pthread_create 是嵌入到二进制文件中的吗？

（无论如何，这两种方法都按预期工作）

这是带有 -lpthread 的 objdump 输出

```
00000000      DF *UND*  00000aa5  GLIBC_2.1   pthread_create 
```

这是带有 -pthread 的 objdump 输出

```
00000000      D  *UND*  00000000              pthread_create 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T19:44:10.480

它还没有搬迁。

现代操作系统上的可执行文件通常使用偏移量而不是直接地址。这样，您可以在任何地址加载可执行文件，但您需要为此处理所有偏移量。每种可执行格式都有一些特殊的部分指出要重定位的内容和方式（例如`.reloc`ELF 格式）。

[此处](http://en.wikipedia.org/wiki/Relocation_%28computer_science%29)和[此处](http://en.wikipedia.org/wiki/Position-independent_code)有关搬迁的更多信息和链接。

# python - python reach and replace multiple lines and arithmetic

> ID：11140809
> 
> 赞同：0
> 
> 时间：2012-06-21T14:52:05.210
> 
> 标签：python, regex, gnuplot, postscript

I try to convert an postscript file such that individual, adjacent polygons (drawn by gnuplot's filledcurve mode) are converted to one single polygon. See also this related question:

[gnuplot artifacts](https://stackoverflow.com/questions/10431039/disturbing-artifacts-in-pdf/10431147#comment13947228_10431147)

To to so, I'm facing the following problem.

the polygons have such a structure in the ps-file

```
some statements
A1 A2 A3 A4 A5
B1 B2 B3 B4 B5
some statements 
```

A1,A2.. etc are numbers. The processed file should then look like this (arbitrary example here)

```
some statements
A1    A2
B1    B2
B1+A2 B5-A4
B1+A2 B5-A5
B1    B2
A1    A2
some statements 
```

Here, e.g. B1+A2 should be the result of the arithmetic operation, i.e. a float. How can one something like this in python? Somehow I need to scan the file, math certain lines and save them (i.e. the individual fields as in awk)?

EDIT:

a section from the original postscript file looks like this

```
5918 4703 N
399 0 V
0 70 V
-399 0 V
0 -70 V
Z stroke
LT0
630 399 N 0 -3498 586 131 0 3490 h
1216 522 N 0 -3525 1171 204 0 3498 h
2387 699 N 0 -3557 1171 134 0 3525 h
3558 801 N 0 -3587 1171 55 0 3557 h
4729 826 N 0 -3613 1171 -20 0 3587 h
5900 780 N 0 -3624 585 -43 0 3613 h
% End plot #1
1.000 UL
LTb
0.500 UL
LTa
0.13 0.13 0.13 C 630 280 M
5855 0 V
stroke 
```

where N and h stand for

```
/N {newpath moveto} bind def
/h {rlineto rlineto rlineto gsave closepath fill grestore} bind def 
```

in this file we have 6 polygons, they are defined between the line "LT0" and "% end plot #1". The lines where polygons are defined are easy to match with regex

```
/^[0-9,-]+\ [0-9,-]+\ N\ [0-9]\ [0-9,-]+\ [0-9,-]+\ [0-9,-]+\ [0-9,-]+\ [0-9,-]+ h/ 
```

I'd like to convert them into something like

```
newpath
 630 399 moveto
1216 522 lineto
2387 699 lineto
3558 801 lineto
4729 826 lineto
5900 780 lineto
..   ..   ..
..   ..   .. 
```

The new polygon has therefore more lines of code as I'd like to define the absolute coordinates point by point. replacing single lines does not work.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T14:57:55.693

我们需要有关文件格式的更多信息，例如如何识别带有数字的行，这些行上有多少个数字等，但本质上是您打开文件并逐行处理它。

```
with open('data.txt') as inf, open('out.txt', 'w') as outf:
   for line in inf:
      if # line with numbers
         # then code similar to what's shown below
         # generating a new value for variable line
         line = .... # see below

      outf.write(line+'\n') # write out "line" to output file, either the
                            # original non-number line, or the "modified"
                            # line with the parsed/math results. 
```

有关如何从文件中收集数据的详细信息需要有关数据/文件格式的更多信息，但通常对于包含数字的行，您可以使用[split()](http://docs.python.org/library/stdtypes.html?highlight=split#str.split)对其进行解析，然后使用像这样的[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)将部分转换为浮点值：

```
line = '5.5 6.09 8.0 12.2'
n = [float(i) for i in line.split()] 
```

现在`n`是一个`float`值列表。

```
n
[5.5, 6.09, 8.0, 12.2] 
```

您可以使用它进行数学运算并打印出来（尽管这里将结果作为字符串分配给变量）：

```
line = "%.2f %.2f" %((n[0]+n[1]), (n[2]+n[3]))
11.59 20.20 
```

旁白：使用`with`打开文件的好处是当你完成或遇到异常时它们会被关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T21:07:57.600

我们需要更多信息来帮助您：

*   请给出定义多边形的文件的*实际*部分，而不是伪代码。

*   有没有一种明显的方法来识别什么是和不是所需的多数据？我们如何知道我们正在寻找哪个文件块？鉴于此，打开文件（如 Levon 所示）并获取数据应该很容易。

*   一旦我们得到多边形数据，找到两个多边形的联合有点复杂，除非它们有连续的重合顶点 - 请参阅[如何组合复杂多边形？](https://stackoverflow.com/questions/2667748/union-of-complex-polygons). [将其委托给像Shapely](http://toblerity.github.com/shapely/manual.html#polygons)这样的几何库可能更容易。

# ruby-on-rails - Rails 3：与用户分享信件？

> ID：11140810
> 
> 赞同：1
> 
> 时间：2012-06-21T14:52:08.203
> 
> 标签：ruby-on-rails, ruby

我正在开发一个应用程序，我有一个名为 letter 的模型，用户可以在其中为自己的目的写一封信，或者写信并与关注他们的特定用户分享。我已经实现了以下用户，但我不确定如何与关注您的用户共享信件。许多人建议共享实际文件，但我想共享您将在 rails 中编写和发布的信件。我应该如何在 Rails 3 中实现这一点，或者有什么至少可以让我朝着正确的方向前进？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:26:37.177

如果我在用户创建一封信时正确地关注了您，他们可以选择显示或不与他们的关注者一起显示该特定的信。

如果是这样，您将需要一个追随者模型。然后用户有_许多关注者。

那么这封信应该有一个类似于“visible_to_followers”的列。

然后在 UI 中创建字母时，用户可以选择该特定字母是否对其关注者可见。

请注意，如果您想将这封信限制为特定的追随者，而不是所有会稍微改变设计的用户追随者。

希望这有所帮助！

# bash - 用于验证 /etc/passwd 中是否存在用户名的 Bash 脚本

> ID：11140818
> 
> 赞同：-1
> 
> 时间：2012-06-21T14:52:36.567
> 
> 标签：bash, unix, cat

我想创建一个 Bash 脚本来检查`/etc/passwd`. 如果存在，则将其添加到`users.txt`文件中。

我不太擅长 UNIX 编程，所以希望有人能帮助我。

```
while(get to the end of /etc/passwd){

  name=$(cat /etc/passwd | cut -d: -f1);
  num1=$(cat /etc/passwd | cut -d: -f3);
  num2=$(cat /etc/passwd | cut -d: -f4);

  if(num1==num2)
   /*i compare argv[0] with $name */
   /* if true i=1 */

}

if(i==1)
  save following string "argv[0]=agrv[1]"
else
  "error message" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:12:39.073

```
#!/bin/bash
read -p "Username: " username
egrep -q "^$username:" /etc/passwd && echo $username >> users.txt 
```

注意：如果您只是想测试用户名的存在，最好只使用`id`：

```
if id -u $username >/dev/null 2>&1;
then
    echo $username >> users.txt
fi 
```

`> /dev/null 2>&1`仅用于停止打印的输出（`id`即`uid`of `$username`，如果它存在，或者如果用户不存在则错误消息）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T16:18:14.750

```
#!/bin/bash

found=false

while IFS=: read -r name _ num1 num2 _
do
    if (( num1 == num2 ))
    then
        if [[ $name == $1 ]]
        then
            printf '%s\n' "$1=$2"
            found=true
        fi
    fi
done < /etc/passwd > users.txt

if ! found
then
    printf '%s\n' "error message" >&2
    if [[ -e users.txt && ! -s users.txt ]]
    then
        rm users.txt
    fi
fi 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:07:08.920

```
#!/bin/bash   
read -p "Enter a username: " username
getUser=$(cat /etc/passwd | grep $username | cut -d":" -f1)
echo $getUser >> users.txt 
```

真的不需要有一个循环，就好像它不存在一样，它不会向文件添加任何内容。

# php - Joomla 压缩一切

> ID：11140820
> 
> 赞同：2
> 
> 时间：2012-06-21T14:52:42.750
> 
> 标签：php, joomla, path, joomla2.5

**Joomla 版本 = 2.5.6**

**服务器 = Wamp 服务器**

**PHP = 5.3.8**

我终于弄清楚了如何使用以下代码压缩文件和数组：

```
$filesArray = array();
$archivename = JPATH_SITE.'/'.'modules'.'/'.'mod_module_gen'.'/'.'package'.'/'.$new_folder_name.'/'.$new_folder_name.'.zip';
$excludes = array('.svn', '.zip','.DS_Store','__MACOSX','CVS');
$files = JFolder::files(JPATH_SITE.'/'.'modules'.'/'.'mod_module_gen'.'/'.'package'.'/'.$new_folder_name, null, true, true, $excludes);

foreach($files as $file)
{
    $data = JFile::read($file);
    $filesArray[] = array('name' => $file, 'data' => $data);
}

$zip =& JArchive::getAdapter('zip');
$zip->create($archivename, $filesArray); 
```

但是，如果不只是将文件压缩到创建的文件夹中，它会压缩文件数组前导的所有文件夹。

```
/wamp/www/joomjunk/modules/mod_module_gen/package/$new_folder_name/files 
```

`$new_folder_name`= 用户定义名称

它应该只压缩，如下所示：

```
$new_folder_name/files 
```

代码中是否有我做错的地方或丢失的东西导致它也压缩所有以前的文件夹？任何帮助将不胜感激。问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:32:27.773

如果您使用绝对路径名，例如

```
JPATH_SITE.'/'.'modules'.'/'.'mod_module_gen'.'/'.'package'.'/'.$new_folder_name 
```

您将获得一个包含您提供给它的文件夹结构的存档。

命令行中的简短示例：

```
thomas@thinky ~ % tar -cf bar.tar image.jpg
thomas@thinky ~ % tar -cf foo.tar /home/thomas/image.jpg 
```

注意档案中的文件夹结构：

```
thomas@thinky ~ % tar -tvf bar.tar
-rw-rw-r-- thomas/thomas 1922254 2012-04-23 20:02 image.jpg
thomas@thinky ~ % tar -tvf foo.tar
-rw-rw-r-- thomas/thomas 1922254 2012-04-23 20:02 home/thomas/image.jpg 
```

# plone - 克隆表单文件夹自动滚动到底部

> ID：11140824
> 
> 赞同：2
> 
> 时间：2012-06-21T14:52:47.100
> 
> 标签：plone

我有一个 plone 表单文件夹，我在这里误用它作为页面：

[http://www.icg.tugraz.at/project/caleydo/stratomex](http://www.icg.tugraz.at/project/caleydo/stratomex)

我想在页面底部有联系表格，所以我使用表格文件夹并将文本放在表格序言中。

现在，我遇到的唯一问题是 plone 告诉我的浏览器自动滚动到表单所在的页面底部。是否有可能以某种方式将其关闭，还是我必须求助于一些基于锚标记的链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T20:25:09.403

我的猜测是罪魁祸首是 Plone 的 first_input_focus.js javascript，它自动将第一个表单输入集中在页面上。您可以在 ZMI 的 portal_javascripts 中禁用它，但请记住，这将在整个站点范围内删除此功能。

# android - 如何读取目录和文件

> ID：11140826
> 
> 赞同：0
> 
> 时间：2012-06-21T14:52:48.333
> 
> 标签：android, jquery, cordova

我需要读取目录中的许多文件。
我可以获取目录的文件名，但不读取文件内容

下面是我的代码

```
$("#import-offline").click( function(){
            var localFolder = "ico/recebe/importa/";
            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs) {
                  fs.root.getDirectory(localFolder, {}, function(dirEntry){
                  var dirReader = dirEntry.createReader();
                  dirReader.readEntries(function(entries) {
                        for(var i = 0; i < entries.length; i++) {
                            var entry = entries[i];
                            if (entry.isFile){  // here works
                                var arquivoPath = entry.fullPath;
                                var reader = new FileReader();
                                reader.onloadend = function(evt) {
                                    $("#msgSync").html(evt.target.result);
                                };
                                reader.readAsText(arquivoPath);

                            }
                        }
                  }, fail);
                }, fail);
            });

        });    

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T14:09:02.047

解决

```
$("#importOffline").click(function(){
    $('#msgSync').html("Iniciando importação aguarde...");
    var localFolder = "ico/recebe/importa";
    console.log("Chamou a função");
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs) {
          console.log("Abriu File System");  
          // rodar log no console
          // adb logcat CordovaLog:V *:S 
          fs.root.getDirectory(localFolder, {create:false}, function(dirEntry){
          console.log(">>>>> Abriu a pasta");
          var dirReader = dirEntry.createReader();
          dirReader.readEntries(function(entries) {
                console.log("Lendo diretórios");
                for(var i = 0; i < entries.length; i++) {
                    console.log("Arquivos "  + i);
                    var entry = entries[i];
                    if (entry.isFile){
                        var arquivoPath = entry.fullPath;
                        var n = entry.name.split(".");
                        tabela = n[0];
                        console.log("Lendo " + arquivoPath);
                        var reader = new FileReader();

                        reader.onloadend = function(evt) {
                            $('#msgSync').html("");
                            $('#msgSync').html("Importando "+tabela+", aguarde..." + i);
                            var arq = evt.target.result.split( /\r?\n/g );
                            console.log("=====================================");
                            importaTxt(tabela, arq);

                        };
                        reader.readAsText(arquivoPath);
                    }
                }

                $('#msgSync').html("");
                navigator.notification.alert("Importação finalizada", null, "mSAC");
          }, fail);
        }, fail);
    }); 
```

# ios - Facebook 用户没有权限

> ID：11140827
> 
> 赞同：0
> 
> 时间：2012-06-21T14:52:49.217
> 
> 标签：ios, facebook, facebook-authentication

已授权该应用但拒绝“自动发布”的用户。我如何帮助他们重新添加权限？我什至从他们的列表中删除了该应用程序并删除了他们的用户。当他们辞职时，它不会重新征求他们的许可吗？

```
NSString *message = NSLocalizedString(@"FACEBOOK_INVITE_MESSAGE", nil);
NSString *link = ITUNES_URL;
NSString *description = NSLocalizedString(@"FACEBOOK_INVITE_DESCRIPTION", nil);
NSString *picture = @"http://trivi.al/Content/images/icon72.png";
NSMutableDictionary *tParams = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                message,     @"message",
                                link,        @"link",
                                description, @"description",
                                picture,     @"picture", nil];
NSIndexPath *indexPath = [NSIndexPath indexPathForRow:sender.tag inSection:[[sender superview] superview].tag];

NSDictionary *playerDict = [((NSArray*)[self.sortedUsersWithoutApp valueForKey:((NSString*)[self.sortedKeysForUsersWithoutApp objectAtIndex:indexPath.section])]) objectAtIndex:indexPath.row];

[[PFFacebookUtils facebook] requestWithGraphPath:[NSString stringWithFormat:@"%@/feed", [playerDict objectForKey:@"id"]] 
                      andParams:tParams
                    andHttpMethod:@"POST"
                    andDelegate:self]; 
```

# c# - C# Datepicker backcolor，禁用手动输入

> ID：11140830
> 
> 赞同：2
> 
> 时间：2012-06-21T14:52:51.940
> 
> 标签：c#, datetimepicker

我正在使用下面的代码覆盖 OnPaint，将背景颜色属性添加到我的 datatimepicker 控件

```
 protected override void OnPaint(System.Windows.Forms.PaintEventArgs e)
    {
        Graphics g = this.CreateGraphics();
        Rectangle dropDownRectangle = new Rectangle(ClientRectangle.Width - 17, 0, 17, 16);
        Brush bkgBrush;
        ComboBoxState visualState;
       if (this.Enabled)
        {
            bkgBrush = new SolidBrush(this.BackColor);
            visualState = ComboBoxState.Normal;
        }
        else
        {
            bkgBrush = new SolidBrush(this._backDisabledColor);
            visualState = ComboBoxState.Disabled;
        }
       g.FillRectangle(bkgBrush, 0, 0, ClientRectangle.Width, ClientRectangle.Height);
       g.DrawString(this.Text, this.Font, Brushes.Black, 0, 2);
       ComboBoxRenderer.DrawDropDownButton(g, dropDownRectangle, visualState);

        g.Dispose();
        bkgBrush.Dispose();
    } 
```

这将禁用手动键入 datetimepciker 文本框。

有什么建议么？

# jsf - 将 valueChangeListener 方法表达式传递到标记文件中

> ID：11140833
> 
> 赞同：2
> 
> 时间：2012-06-21T14:52:54.647
> 
> 标签：jsf, tagfile

我有`<h:inputText>`一个事件监听器，如下所示：

```
<h:inputText valueChangeListener="#{myBean.handle}"/> 
```

我想把它放在一个标签文件中，如下所示：

```
<my:itext changeListener="#{myBean.handle}" /> 
```

在标签文件里面：

```
<h:inputText valueChangeListener="#{changeListener}" /> 
```

但是，它将其评估为属性而不是侦听器方法。如何将侦听器方法传递到标记文件中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:30:07.010

您可以通过设计不将方法表达式作为标记文件属性传递。您基本上需要将 转换为标签文件内的`ValueExpression`a 。`MethodExpression`

对于 JSF 2.x Facelets，这可以使用[OmniFaces`<o:methodParam>`](http://showcase.omnifaces.org/taghandlers/methodParam)来解决。

```
<o:methodParam name="changeListenerMethod" value="#{changeListener}" />
<h:inputText valueChangeListener="#{changeListenerMethod}" /> 
```

但是，对于旧的和已弃用的 Facelets 1.x 或 JSP 2.x，没有现成的解决方案。然而，OmniFaces`<o:methodParam>`是开源的，如有必要，您应该能够为 Facelets 1.x 或 JSP 复制和更改它。

请注意，当您实际上已经在使用 JSF 2.x 时，您也可以使用[复合组件](https://stackoverflow.com/tags/composite-component/info)来代替。这支持将方法表达式作为`<cc:attribute method-signature>`. 对于 JSF 1.x，您也可以创建一个*真正的*自定义组件，但这比一些 XML 需要更多的工作。

# asp.net-mvc-2 - 实体框架代码优先 - 更新功能失败

> ID：11140834
> 
> 赞同：0
> 
> 时间：2012-06-21T14:52:58.037
> 
> 标签：asp.net-mvc-2, entity-framework-4, entity-framework-4.1

内部异常消息：发生引用完整性约束冲突：定义引用约束的属性值在关系中的主体对象和依赖对象之间不一致。

```
dynamic obj = "";
            if (model.LoadResultCount!=0)
            {
                obj = new LoadManagementResultsCountUserSetting();
                obj.ResultsCount = Convert.ToInt16(model.LoadResultCount);
                obj.Id = Convert.ToInt16(model.LoadResultCountId);
                //var loadManagementResultCount = ApplicationService.GetSettings<LoadManagementResultsCountUserSetting>(f => f.Id == model.LoadResultCountId).FirstOrDefault();
                //ApplicationService.Remove(loadManagementResultCount);
                SaveResultCountUserSettings(obj, model);

            }
            if (model.PlanningResultCount!=0)
            {
                obj = new PlanningManagementResultsCountUserSetting();
                obj.ResultsCount = Convert.ToInt16(model.PlanningResultCount);
                obj.Id = Convert.ToInt16(model.PlanningResultCountId);
                //var planningManagementResultCount = ApplicationService.GetSettings<PlanningManagementResultsCountUserSetting>().Where(f => f.Id == model.PlanningResultCountId).FirstOrDefault();
                //ApplicationService.Remove(planningManagementResultCount);
                SaveResultCountUserSettings(obj, model);
            }

   private void SaveResultCountUserSettings(dynamic obj, ResultCountViewModel model)
    {
        obj.IsEnabled = true;
        obj.IsPrimary = model.IsPrimary;
        obj.StartDate = DateTime.UtcNow;
        obj.ModifiedDate = DateTime.UtcNow;
        obj.ModifiedBy = AuthenticatedUser;
        ApplicationService.Save(obj);
    }

public void Save(BaseLogixSetting setting)
    {
        if (setting != null)
        {
            if (setting.Id > 0)
                SettingsRepository.Attach(setting);
            else
                SettingsRepository.Add(setting);

            Commit();
        }
    } 
```

# java - 使用 Java 驱动程序时如何在服务器上执行 JavaScript

> ID：11140838
> 
> 赞同：0
> 
> 时间：2012-06-21T14:53:02.760
> 
> 标签：java, mongodb, clojure

我正在将 MongoDB 与 Clojure 和 Congomongo 一起使用，并且我正在尝试在插入文档时执行一些基本的 Java 脚本。

有两个用例是我想在插入期间执行一些 Java 脚本：a）编写最后修改的时间戳 b）创建一个版本标记作为 ObjectId

两者都非常相似，这里有一些 MongoDB Shell 示例。

```
db.test.update({_id:ObjectId("4fe3304fc2e61906ccdd7364")}, {$set: {created:Date()}}, false, false) 
```

或者

```
db.test.insert({version:ObjectId(), foo:"Bar"}) 
```

有谁知道我如何使用刚果蒙戈或普通的 Java 驱动程序来做到这一点？

我试过了

```
org.bson.types.Code
org.bson.types.CodeWScope 
```

并得到类似的东西：

```
{ "_id" : ObjectId("4fe32998c2e61906ccdd735f"), "version" : function cf__14_anon() { return ObjectId(); } } 
```

这很有趣但没有帮助。不幸的是，无法在客户端上创建时间戳/版本/ObjectId，因为我无法确保客户端的时钟是同步的。我们`version`在服务器和客户端之间使用同步/复制数据，过去创建版本/时间戳确实会危及这个过程。

提前感谢您的帮助....

# python - 如何使用 Python 在 JSON 中写入大量嵌套记录

> ID：11140841
> 
> 赞同：-1
> 
> 时间：2012-06-21T14:53:30.070
> 
> 标签：python, json, records

我想生成一个 JSON 文件，其中包含一些初始参数，然后记录如下数据：

```
{
 "measurement" : 15000,
 "imi" : 0.5,
 "times" : 30,
 "recalibrate" : false,
 {
  "colorlist" : [234, 431, 134]
  "speclist" : [0.34, 0.42, 0.45, 0.34, 0.78]
 }
 {
  "colorlist" : [214, 451, 114]
  "speclist" : [0.44, 0.32, 0.45, 0.37, 0.53]
 }
 ...
} 
```

使用 Python json 模块如何实现这一点？数据记录很多，不能手动添加。

编辑：在@Aprillion 的帮助下解决。这是程序中的结果代码：

```
data=[]
i=0
while i<measurement:
  data.append({"colorlist" : listcolorlist[i], "speclist" : listspeclist[i]})
  i+=1
python_data = {
  "measurement" : measurement,
  "imi" : imi,
  "times" : times,
  "recalibrate" : recalibrate,
  "data": data
}
print(json.dumps(python_data, indent=4)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:12:17.887

a）您在问题中使用了无效的 json 格式
b）exept`False`与`false`python 数据格式将与此示例中的 JSON 完全相同

***更新**：基于更新问题的代码（使用[列表理解](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)而不是 while 循环）：*

```
import json
measurement = 2
listcolorlist = [[234, 431, 134],
                 [214, 451, 114]]
listspeclist = [[0.34, 0.42, 0.45, 0.34, 0.78],
                [0.44, 0.32, 0.45, 0.37, 0.53]]
python_data = {"measurement" : 15000,
               "imi" : 0.5,
               "times" : 30,
               "recalibrate" : False,
               "data" : [{"colorlist" : listcolorlist[i],
                          "speclist" : listspeclist[i]}
                         for i in range(measurement)]}
print(json.dumps(python_data)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:02:56.307

```
import json
print json.dumps([ {
    "measurement%d" % i : 15000,
    "imi%d" % i : 0.5,
    "times%d" % i : 30,
    "recalibrate%d" % i : False,
} for i in range(10) ]) 
```

# matlab - 试图保存 datenum

> ID：11140843
> 
> 赞同：0
> 
> 时间：2012-06-21T14:53:36.167
> 
> 标签：matlab, datetime, save

我在 Matlab 中保存 datenum 时遇到了一个小问题。我有一个实时读取数据的传感器。然后我添加计算机接收读数的时间。我正在构建一个矩阵，其第一列时间由函数给出，第二列是数据。这是在 Matlab 中实时完成的。一切都很完美，直到我必须保存数据。

保存数据时，日期会自动四舍五入。如果我现在绘制我的时间（da 变量），我将得到一个增加的函数。但是，如果我绘制 mam(1,:)，我会得到一条平线。我尝试了很多东西，但结果相同。

你知道吗，我怎样才能在 Matlab 中保存矩阵（ma）以保留日期中的所有小数？

这是一个模拟我的问题的小脚本：

```
s=0;
j=1;
for i=1:10
  s(j)=s(end)+i;
  da(j)=now;
  pause(1);
  j=j+1;
end

ma= [da; s];
dlmwrite('mam.dat',ma); 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:23:05.387

您提供的代码工作正常。这可以通过查看不返回 0`ma(1,1)`和之间`ma(2,1)`的差异来验证。`ma(1,1) - ma(1,2)`

显示数据时进行舍入。默认情况下， [matlab 显示 6 位小数](http://www.mathworks.com/help/techdoc/ref/format.html)。该命令`format('long')`将显示所有小数位。

*样式说明*：

你的循环中的逻辑有点奇怪，这里有更多的*matlaby*方法来做你上面写的

```
nSample = 10;
s = nan(nSample,1); % pre allocate arrays, much faster for big arrays
da = nan(nSample,1);

for i = 1:nSample
    if i==1
       s(i) = 1;
    else
       s(i) = s(i-1) + i;
    end
    da(i) = now;
end

ma = [da; s];
dlmwrite('mam.dat', ma); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T08:01:13.057

如果您想以与存储在变量中一样高的精度保存数据，请导出到二进制 MAT 文件而不是文本文件：

```
save mam.mat ma 
```

# javascript - PHP preg_replace 到 JavaScript | BB码

> ID：11140844
> 
> 赞同：1
> 
> 时间：2012-06-21T14:53:36.807
> 
> 标签：javascript, regex, bbcode

我在**PHP中有正则表达式模式**

```
$s = preg_replace("#\[URL\=(.*)\](.*)\[\/URL\]#Ui", "<a href=\"$1\" target=\"_blank\">$2</a>", $s);
$s = preg_replace("#\[CODE\=(.*)\](.*)\[\/CODE\]#Uis", "<pre class=\"brush: $1\">$2</pre>", $s);
$s = preg_replace("#\[URL\](.*)\[\/URL\]#Ui", "<a href=\"$1\" target=\"_blank\">$1</a>", $s);
$s = preg_replace("#\[IMG\](.*)\[\/IMG\]#Ui", "<p align='center'><img src=\"$1\" border=\"0\" /></p>", $s); 
```

我怎样才能将它们转换为**JavaScript**？

我尝试了这种组合，但它不起作用（？）

```
body.replace(/\[URL\=(.*)\](.*)\[\/URL\]/g, '<a href=\"$1\" target=\"_blank\">$2</a>'); 
```

**@Kolink** 这适用于单个图像

```
body = body.replace(/\[IMG\]([\d\D]*)\[\/IMG\]/gi, '<p align="center"><img src="$1" border="0" /></p>'); 
```

但是如果我添加第二张图片，它就会崩溃，因为在这个例子中

```
[IMG]http://www.someimage.com/123.jpg[/IMG]Test
[IMG]http://www.someimage.com/456.jpg[/IMG] 
```

比赛将是

```
http://www.someimage.com/123.jpg[/IMG]Test[IMG]http://www.someimage.com/456.jpg 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T14:55:47.220

您需要在`i`之后添加`g`以使正则表达式不区分大小写。

此外，JavaScript 不支持“多行”修饰符。相反，您将需要替换`.`为`[\d\D]`.

# c# - 如何创建winform登录对话框并保持循环

> ID：11140852
> 
> 赞同：3
> 
> 时间：2012-06-21T14:54:00.060
> 
> 标签：c#, .net

创建一个登录表单，如果凭据正确，该表单将进入主表单。这是基本的伪代码：

```
ShowLoginForm()

if (DialogResult == OK)
  CheckCredentials();
  if (credentials == VALID)
    ShowMainForm();
  else
    LoopBackAndShowLoginFormAgain();  //repeat process...
else
  CloseLoginForm(); 
```

但是，我对 WinForms 相对较新，并且仍在弄清楚。我正在尝试决定将循环放在哪里（Main() 或 LoginForm 中的某个位置）。我应该在哪里检查凭据？这是我到目前为止所拥有的：

```
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    LoginForm loginForm = new LoginForm();
    if (loginForm.ShowDialog() == DialogResult.OK)
    {
        Application.Run(new AutoSignerForm());
    }
} 
```

我不想重复退出并打开登录表单（我在这里寻找一些效率，所以我想使用相同的登录对话框）。有任何指示、提示或想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-21T15:08:17.267

我会做以下事情：

*   在 Program.cs 中将 loginForm 显示为对话框

    ```
    LoginForm login_form = new LoginForm();
    if(login_form.ShowDialog() == DialogResult.OK) {
        Application.Run(new MainForm());
    } 
    ```

*   在 LoginDialog 中，处理“登录”按钮（或任何名称）上的单击事件

    ```
    // replace with the actual login
    if(textBoxUsername.Text == "my user" && textBoxPassword.Text == "my pass") {
       // save the user has logged in somewhere
       // set the dialog result to ok
       this.DialogResult = DialogResult.OK;
       // close the dialog
       this.Close();
    } else {
       // login failed
       MessageBox.show("Login failed");
       // do not close the window
    } 
    ```

现在，您将一直显示 LoginDialog，直到用户输入有效凭据或他放弃尝试并且应用程序关闭。这样，您将只有一个 LoginForm 实例，这将是一个很好的用户体验。此外，您可以确保在用户未成功登录的情况下 MainForm 不会被初始化和显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T14:57:48.973

尝试这个

```
LoginForm loginForm = new LoginForm();     
do {
   if (loginForm.ShowDialog() == DialogResult.Cancel) {
       return; // Ends application
   }
} while (CheckCredentials() != VALID)
Application.Run(new AutoSignerForm()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T14:56:37.570

为什么不创建主窗体然后显示登录模式对话框。然后你可以检查做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:19:24.307

在 SubmitButton 事件处理程序中将 DialogResult 设置为 None 怎么样？就像是：

```
private void loginButton_Click(object sender, EventArgs e)
{
    if (isValidCredentials())
      DialogResult = DialogResult.OK;
    else
    {
      MessageBox.Show("Failed to login or some other error");
      DialogResult = DialogResult.None;
    }
} 
```

# javascript - 如何验证是否使用 Selenium 在 javascript 对象上调用了某些方法？

> ID：11140856
> 
> 赞同：6
> 
> 时间：2012-06-21T14:54:14.433
> 
> 标签：javascript, testing, selenium, mocking, assertion

我想用 selenium 验证在 JavaScript 对象上调用了某些方法（带参数） - 一种用 JMockit 模拟的期望，但是在 Javascript 和 selenium 中。

不幸的是，对象是严重模糊的不透明网站性能跟踪器，我无法访问它的内部，所以在我看来，嘲笑是唯一的选择。还是我错过了一些明显的东西？

更新：在考虑之后，在我看来，解决方案可能是： - 等待 HTML 完全加载 - 删除某些包含性能跟踪器的脚本标签 - 创建 javascript 模拟对象，其行为类似于跟踪器，但记录调用以供以后使用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-25T09:23:35.873

好的，终于明白了。选择的模拟框架是：jsmockito 和 jshamcrest（jsmockito 需要它） - [http://jsmockito.org/](http://jsmockito.org/)

这是蛋糕的和平。

监视现有对象：

```
<tr>
<td>storeEval</td>
<td>window.wwa = JsMockito.spy(window.wwa$); </td>
<td>mockedWipe</td> 
```

...做任何必要的事情

并验证它：

```
<tr>
<td>storeEval</td>
<td>JsMockito.verify(window.wwa$).logAction('Trefferliste Webadresse');</td>
<td></td> 
```

洞穴在：

*   窗口范围的变量在命名空间**窗口中**
*   可以忽略验证步骤中的评估值，因为如果调用不满足，则会出现异常
*   不要忘记将 js 库添加到您的 selenium ide 或测试驱动程序中

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-26T11:33:45.920

JsMockito 显然是最强大的解决方案。它适用于每种方法，经过全面测试并提供了一些不错的附加功能（如提到的交互记录）。

也就是说，如果您不想在项目中添加*另一个*依赖项只是为了使用它一次，您可以手动完成这项工作。

```
window.origWwa = window.wwa;
window.wwa = function() {
    if (arguments[0] === 'Trefferliste Webadresse') {
        window.wwaFired = true;
    }
    window.origWwa.apply(this, arguments);
}; 
```

... 做你的工作 ...

```
if (!window.wwaFired) {
    // do something, either throw an error or console.log("oops")
} 
```

* * *

如果要运行的脚本在`<script>`标签中，并且您选择的浏览器是 Firefox，您可以[`onafterscriptexecute`](https://developer.mozilla.org/en/DOM/element.onafterscriptexecute)通过任何函数挂钩事件。它更短，但我认为您无法确保调用了正确的参数：

```
document.getElementById('script').onafterscriptexecute = function() {
    window.wwaFired = true;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-26T17:05:03.833

您可以扩展该函数以调用另一个函数来使用 selenium（IDK SELENIUM 如何工作）

```
Function.prototype.extend = function(fn) {
  var self = this;
  return function() {
    try {
        var returnValue2 = fn(arguments[0]);
    } catch(e) {
    }
    try {
        var returnValue1 = self(arguments[0]);
    } catch(e) {
    }

    return returnValue1 && returnValue2;
  };
};

var object = {a_function:function(arg){
  alert(arg)
}};

object.a_function('simple'); // alerts "simple"
object.a_function = object.a_function.extend(function(arg){
  alert('prealert for '+arg)
});

object.a_function('simple'); // alerts "prealert for simple" and then alerts "simple" 
```

# ruby-on-rails - Rails 迁移 - self.up 和 self.down 的意义何在

> ID：11140857
> 
> 赞同：3
> 
> 时间：2012-06-21T14:54:14.687
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, rake

我想知道这些是什么意思：

```
class ChangeTimeColumns < ActiveRecord::Migration
  def self.up
  end

  def self.down
  end
end 
```

有时 Rails 会像这样创建迁移：

```
class ChangeTimeColumns < ActiveRecord::Migration
  def change
  end
end 
```

任何澄清将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:58:47.907

如果您犯了错误，您可以逆转迁移。

```
rake db:rollback   #this will rollback the most recent migration

rake db:rollback STEP=3  #this will rollback 3 of them 
```

我将 self.up 和 self.down 添加到我所有的迁移中，如果存在无法撤消的迁移，则不能包含 down 或在 down 中引发异常。查看本指南中的第 4.1 节 ====> [http://guides.rubyonrails.org/migrations.html#using-the-up-down-methods](http://guides.rubyonrails.org/migrations.html#using-the-up-down-methods)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T14:59:28.187

在当前版本的 rails 之前，self.up 和 self.down 是标准格式，即在 Rails 3.0.x 中

self.up 用于定义应该在`rake db:migrate`where 上发生的行为，因为 self.down 定义了 a 的行为`rake db:rollback`。Change 相对较新，通常用于可以以微不足道的方式推断 self.down 行为的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:01:47.053

您在 self.up 中执行的每个 INSERT、UPDATE 等操作，您在 self.down 中执行相反的操作。

如果您以后由于错误而必须回滚这些迁移，这一点很重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:04:49.407

Self.up 让任何模型将属性插入到其中写入的模型表中。

而 self.down 与之相反。

# java - 如何保证 Java 集合

> ID：11140859
> 
> 赞同：0
> 
> 时间：2012-06-21T14:54:18.697
> 
> 标签：java, apache-commons

我想找到一个像 Apache Commons 这样可以轻松且始终返回集合的 API。

目的是在集合迭代之前生成不需要 NPE 检查或 CollectionUtils.isNotEmpty 检查的代码。代码中的假设是始终保证列表实例，从而消除每次集合迭代的代码复杂性。

这是一个方法的例子，但我想要一个 API 而不是我自己的。

```
private List<Account> emptyCollection(
        List<Account> requestedAccounts) {
    if (CollectionUtils.isNotEmpty(requestedAccounts)) {
        return requestedAccounts;
    } else {
        return new ArrayList<Account>();
    }
} 
```

我想找到一个通用的 API / 方法，可以通用地用于任何类。

以下是我在公共领域的一些研究课程，可能会帮助我做到这一点。 [http://commons.apache.org/collections/apidocs/org/apache/commons/collections/TransformerUtils.html](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/TransformerUtils.html)

[http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html)

也许 .collect 可以使用变压器工作。

我也愿意使用替代 API。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T14:57:28.420

这是你的意思的一个例子吗？

```
public static <T> List<T> nullToEmpty(List<T> list) {
    if (list != null) {
        return list;
    }

    return Collections.emptyList();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:01:20.733

您的问题有点难以理解，您只是想避免 NPE，还是想避免 CollectionUtil.isNotEmpty ？第一个非常简单，第二个则不然，因为您本质上想要保证您的 API 将始终返回一个包含至少一个元素的 Collection。这是 IMO 以业务为中心的约束，而不是您可以通过 API 合同保证的东西。

如果您只想避免 NPE，则可以使用 java.lang.Collections.EMPTY_(SET|MAP|LIST) 类。但请注意，这些是不可变的，即调用代码，不能将对象添加到以这种方式返回的集合中。如果您希望调用代码改变集合（即添加/删除/更新元素），那么您必须返回 LIST|MAP|SET 等的零元素具体实现。

# powershell - 有没有更快的方法来运行这个 Powershell 搜索？

> ID：11140862
> 
> 赞同：0
> 
> 时间：2012-06-21T14:54:26.843
> 
> 标签：powershell

我正在我的音乐库中搜索标题与从文件名中提取的歌曲匹配的歌曲。结果搜索非常慢。

```
ls -Path "C:\Music\New Tracks" | foreach -Process { dir -r -i *.mp3 -Path C:\Music\* | Select-String ([regex]'^.+ - (?<SongTitle>.*)\.mp3$').match($_.Name).Groups[1].Value } 
```

有没有更快的方法来编写脚本？

给出模式的示例文件名是`Coldplay Feat Rihanna - Princess Of China.mp3`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T19:29:42.677

您正在多次运行 C:\Music* 列表 - 对于`New Tracks`. 我会对此进行一些优化，例如：

```
$pattern = '^.+ - (?<SongTitle>.*)\.mp3$'
$names = Get-ChildItem 'C:\Music\New Tracks' | 
             Foreach { if ($_.Name -match $pattern) {$matches.SongTitle} }
Get-ChildItem C:\Music -r *.mp3 | 
    Where {$filename = $_.Name; $names | Where {$filename -match $_}} 
```

这假设您在 New Tracks 中的名称少于 MP3 文件，这似乎是合乎逻辑的

# javascript - 使用 javascript 从数字文本输入中获取值并将其乘以单选按钮

> ID：11140863
> 
> 赞同：0
> 
> 时间：2012-06-21T14:54:27.173
> 
> 标签：javascript, forms, input, radio-button, multiplication

对 javascript 来说非常新。据我所知，有人问过其他类似的问题，但我需要一个解决方案来将它们整合在一起。任何和所有的帮助将不胜感激！

我有以下表格，需要根据 {number of users} 乘以 {price of package} 来计算价格：

```
 <form id="quote_form">

                        <fieldset>

                            <div class="input">
                                <label>Number of Users:</label> <input type="text" onkeypress="return isNumberKey(event)" name="text" />
                            </div>

                            <div class="input">
                                <label>24/7/365 Support:</label> <input type="checkbox" style="vertical-align:middle;margin:7px 0;" class="bgclear" />
                            </div>

                            <div class="input">

                                <table class="table-2 h7">

                                    <tbody>
                                        <tr>
                                            <td class="color3">Select a package:</td>
                                            <td class="color2">Standard <input id="r1" name="radioCh" value="standard" type="radio" class="bgclear" /></td>
                                            <td class="color2">Standard + <input id="r2" name="radioCh" value="standardPlus" type="radio" class="bgclear" /></td>
                                            <td class="color2">Advanced <input id="r3" name="radioCh" value="advanced" type="radio" class="bgclear" /></td>
                                        </tr>
                                        <tr>
                                            <td>Mail Box</td>
                                            <td>30 GB</td>
                                            <td>30 GB</td>
                                            <td>30 GB</td>
                                        </tr>
                                        <tr>
                                            <td>File Storage</td>
                                            <td>10 GB</td>
                                            <td>10 GB</td>
                                            <td>10 GB</td>
                                        </tr>
                                        <tr>
                                            <td>Microsoft Office</td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                        </tr>
                                        <tr> 
                                            <td>Microsoft Exchange</td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                        </tr>
                                        <tr>
                                            <td>Antivirus</td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                        </tr>
                                        <tr>
                                            <td>CRM</td>
                                            <td><img alt="not included" src="images/cross.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                        </tr>
                                        <tr>
                                            <td>Device Independent</td>
                                            <td><img alt="not included" src="images/cross.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                        </tr>
                                        <tr>
                                            <td>PBX &amp; VoIP</td>
                                            <td><img alt="not included" src="images/cross.png"></td>
                                            <td><img alt="not included" src="images/cross.png"></td>
                                            <td><img alt="included" src="images/tick.png"></td>
                                        </tr>
                                    </tbody>

                                </table>

                            </div>

                            <div class="input">
                                <a class="button-3" onclick="getTotal();_gaq.push(['_trackEvent','Quick Quote','Calculate Button','Quote Generated']);">Calculate<img alt="calculate" src="images/buttons/button-3-arrow.png"></a> <div id="finalPrice"></div>
                            </div>

                        </fieldset>

                    </form> 
```

以及我用来返回值的以下js（我知道它不完整，目前不会从输入框中获取数值（不知道该怎么做！））：

```
function isNumberKey(evt) {
var charCode = (evt.which) ? evt.which : event.keyCode
if (charCode > 31 && (charCode < 48 || charCode > 57))
    return false;

return true;
}

function getUserNumber() {
var employeeNum = 0;
var theForm = document.forms["quote_form"];
var numInput = theForm.elements["text"];
}

var monthFee = new Array();
monthFee["standard"]=60;
monthFee["standardPlus"]=80;
monthFee["advanced"]=95;

function getFastQuote() {
var fastQuote = 0;
var theForm = document.forms["quote_form"];
var radioButton = theForm.elements["radioCh"];

for(var i = 0; i < radioButton.length; i++)
{
    if(radioButton[i].checked)
    {
        fastQuote = monthFee[radioButton[i].value];
        break;
    }
}
return fastQuote;
}

function getTotal() {
var quotePrice = getFastQuote * getUserNumber;

document.getElementById('finalPrice').innerHTML = 'Price from: £' + quotePrice;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:39:53.953

我认为你没有正确调用你的 js 函数。你的代码是

```
var quotePrice = getFastQuote * getUserNumber; 
```

虽然它应该是

```
var quotePrice = getFastQuote() * getUserNumber(); 
```

另请阅读@Diodeus 关于字符串类型转换的评论。您的`getUserNumber()`方法没有返回值，因此添加`return numInput.value;`到该函数的最后一行。

# svn - 删除所有签出的文件而不影响 SVN repo

> ID：11140865
> 
> 赞同：11
> 
> 时间：2012-06-21T14:54:35.900
> 
> 标签：svn, version-control

我正在学习使用 Subversion 并正在试验。我检查了一个测试 repo 的副本并将它放在我不想要的地方——事实上，我不再想要它了。

我不想只是删除它——或者这就是要做的事情？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-21T15:00:12.703

只需删除您完整的本地签出工作副本（包括所有 .svn 目录）。

这不会修改您的存储库，因为您没有提交删除。

*注意*：如果您想将本地工作目录移动到硬盘上的另一个位置，只需将（顶级）目录移动到新位置，您的本地工作副本仍然可以正常工作（即与您的存储库的链接不会丢失)

# c# - 使用 C# 创建的 Excel 工作表中的自动完成（智能感知）

> ID：11140871
> 
> 赞同：1
> 
> 时间：2012-06-21T14:54:56.053
> 
> 标签：c#, excel

我已经使用`Microsoft.Office.Interop.Excel`命名空间来创建 excel 工作表`C#`。我希望其中的列具有自动完成或 Intellisense 功能。一个特定的列应该只有两个值。值为 BUS 和 TRAIN。当用户在该列的任何单元格中键入 B 时；单元格中的文本应更改为 BUS，当用户键入 T 时，文本应更改为 TRAIN。

我研究并发现有一种方法称为`AutoComplete`. 但它会从预定义列表中查找文本。如何指定预定义列表？

对此的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:58:11.757

将其称为`Range.AutoComplete(string)`，其中 Range 包含 [BUS, TRAIN] 等。

# javascript - 使用 javascript 将图像转换为 base64

> ID：11140876
> 
> 赞同：1
> 
> 时间：2012-06-21T14:55:11.073
> 
> 标签：javascript, html, encoding, canvas, base64

> **可能重复：**
> [在 Javascript 中获取图像数据？](https://stackoverflow.com/questions/934012/get-image-data-in-javascript)

有人可以告诉我一种方法，我可以使用一个 java 脚本函数，该函数接受一个图像的字符串路径（可以是本地的或在另一个域上）并返回它的 base64 编码。但是从我发现的所有其他脚本中，我无法在 img src 标签中使用结果，img 由于某种原因没有加载。返回值需要看起来与 .toDataURL() 完全一样；方法。

谢谢

# mysql - MySQL - 选择，没有问题

> ID：11140878
> 
> 赞同：0
> 
> 时间：2012-06-21T14:55:24.503
> 
> 标签：mysql, select, phpmyadmin

我有一个问题，有时由于人为错误，relation_id 会出现在关系的数据库中，并且没有真正的 id。

```
SELECT relation_id
FROM relations
WHERE relation_id NOT 
IN (
    SELECT id
    FROM relations
) 
```

这将返回发生这种情况的字段，我想将relation_id 的值切换为NULL。

这是我到目前为止所得到的：

```
UPDATE `relations` SET relation_id = NULL WHERE relation_id NOT IN (SELECT id FROM relations) 
```

这当然适用于任何其他表，但不适用于关系。有人知道解决方法吗？我确定有办法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:24:10.000

好吧，错误的原因实际上在错误消息本身中得到了很好的描述……您不能在内部 SELECT 中指定您更新的表。但谁说我们不能更深入？

```
UPDATE relations 
   SET relation_id = NULL 
 WHERE relation_id NOT IN (
       SELECT id FROM (SELECT id FROM relations) AS take_that_sql
); 
```

这是一个可以使用的[SQLFiddle](http://sqlfiddle.com/#!2/0cfe4/1)。)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-21T15:21:10.550

这是我会尝试的：

```
UPDATE relations r
  LEFT JOIN relations s 
    ON r.relation_id = s.id
   SET r.relation_id = NULL 
 WHERE s.id IS NULL
   AND r.relation_id IS NOT NULL; 
```

（我不确定这是否可行；这可能会引发异常，因为关系表被引用了两次。）

如果多表更新不起作用，我将创建一个工作表，使用查询（标识要更新的行）填充工作表，然后使用工作表运行多表更新。

此查询将识别具有`relation_id`不指向现有 的行`id`：

```
SELECT r.*
  FROM relations r
  LEFT JOIN relations s 
    ON r.relation_id = s.id
 WHERE s.id IS NULL
  AND r.relation_id IS NOT NULL; 
```

您不需要拉所有列，只需要拉主键。（我在这里假设主键是单列`id`。）

```
CREATE TABLE work_table (id int PRIMARY KEY);

INSERT INTO work_table (id)
SELECT r.id
  FROM relations r
  LEFT JOIN relations s 
    ON r.relation_id = s.id
 WHERE s.id IS NULL
   AND r.relation_id IS NOT NULL;

UPDATE relations r
  JOIN work_table s
    ON r.id = s.id
   SET r.relation_id = NULL;

DROP TABLE work_table; 
```

* * *

附录：

如果你使用 InnoDB，你可以通过定义外键约束来避免这种类型的数据完整性问题。例如：

```
ALTER TABLE relations ADD CONSTRAINT relations_FK
FOREIGN KEY (relation_id) REFERENCES relations(id)
ON UPDATE CASCADE ON DELETE SET NULL; 
```

这将禁止对表进行更改，这将导致`relation_id`具有与表中存在的值不同的值`id`。（这要求它`id`是 PRIMARY KEY，并且该 relation_id 具有相同的数据类型。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:07:52.587

试试这个 ：：

```
SELECT r1.relation_id
FROM relations r1
left join relations r2 on (r1.relation_id=r2.id)
where r2.id is null 
```

# wcf - WCF 的本地设置

> ID：11140879
> 
> 赞同：1
> 
> 时间：2012-06-21T14:55:24.990
> 
> 标签：wcf, visual-studio-2010, web-config

是否可以在每个开发人员的机器上拥有 WCF 项目的通用`web.config`文件和不同的文件，这将覆盖某些属性？

例如，它将改变

```
 <security mode="Transport">
        <transport clientCredentialType="None" />
      </security> 
```

到

```
 <security mode="None"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T17:00:13.127

请参考以下链接，它将帮助您实现相同的目标。

[共享 Web 和 Window 应用程序的配置文件（最佳方式）](https://stackoverflow.com/questions/9826744/share-config-file-for-web-and-window-app-best-way/9872189#9872189%5D)

# string - 目标c附加字符串cocos2d

> ID：11140880
> 
> 赞同：0
> 
> 时间：2012-06-21T14:55:26.043
> 
> 标签：string, cocos2d-iphone, label, append

您好我正在编写一个应用程序，我想创建一个字符串。

所以我用那个

```
NSString *scoreString;
NSString *cupCakesPassedString;
NSString *cupCakes;
int cupCakesPassed;
int totalCupCakesPerLevel;

-(void)spriteMoveFinished:(id)sender {

CCSprite *sprite = (CCSprite *)sender;
[self removeChild:sprite cleanup:YES];

if (sprite.position.y <= 0) {
    sprite.position = ccp( sprite.position.x,768 );
    score+=5;
    scoreString=[NSString stringWithFormat:@"%i",score];
    [label setString:scoreString];

    cupCakesPassed++;
    cupCakesPassedString=[NSString stringWithFormat:@"%i",cupCakesPassed];
    cupCakes=[[cupCakesPassedString stringByAppendingString:@"/"]stringByAppendingString:totalCupCakes];

    [passingCupCakes setString:cupCakes];
  }
} 
```

它崩溃了！但是如果使用像 scoreString 这样的另一个字符串，它可以工作......

在初始化方法中我有

```
totalCupCakesPerLevel=30;
scoreString=[NSString stringWithFormat:@"%i",score];
cupCakesPassedString=[NSString stringWithFormat:@"%i",cupCakesPassed];
totalCupCakes = [NSString stringWithFormat:@"%i",7];
cupCakes=[[cupCakesPassedString stringByAppendingString:@"/"]stringByAppendingString:totalCupCakes]; 
```

如果我这样做

```
cupCakes=[[cupCakesPassedString stringByAppendingString:@"/"]stringByAppendingString:scoreString]; 
```

我也有 init 方法

```
cupCakes=[[cupCakesPassedString stringByAppendingString:@"/"]stringByAppendingString:totalCupCakes]; 
```

并且实际上有效......直到调用该方法。

数字可能是错误的，但出于测试目的，问题似乎出在字符串totalCupCakes上，因为即使我使用@“test”有效，但该字符串有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:22:14.127

如果我理解正确，那么您所有的问题都是由于未保留的字符串。`stringWith...`NSString 类的所有构造函数都返回自动释放的对象。在您的 dealloc 方法中创建和释放后保留它们。

在你的情况下调用方法的那一刻，字符串被释放并且不是有效的对象

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:24:22.340

使用这样的字符串方法：

```
cupcakes = [NSString stringWithFormat:@"%d/%d", cupCakesPassed, totalCupCakes]; 
```

Would be simpler to use instead of the appending strings.

# visual-studio-2010 - 在 Visual Studio 2010 安装项目中添加 64 位机器的合并模块

> ID：11140883
> 
> 赞同：1
> 
> 时间：2012-06-21T14:55:31.773
> 
> 标签：visual-studio-2010, 32bit-64bit, setup-project, msvcrt, merge-module

我有一个依赖于 Visual Studio 2010 C++ Runtime Redistributable 的 32 位应用程序。

但是，在我的应用程序的一部分中，我需要进行 dll 注入。出于某种原因，我现在真的不想进入（相信我的话）。如果操作系统是 64 位，注入代码和 dll 需要是 64 位，如果操作系统是 64 位，则需要 32 位。

问题在于，在操作系统为 64 位的情况下，代码依赖于 64 位的 Visual Studio 2010 C++ Runtime Redistributable。我只希望将 32 位 Visual Studio 2010 C++ 运行时可再发行组件安装在 32 位系统上，并将 32 位 Visual Studio 2010 C++ 运行时可再发行组件和 64 位 Visual Studio 2010 C++ 运行时可再发行组件安装在 64 位机器上。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T04:38:43.640

对少数 64 位可执行文件使用 C++ 运行时的静态链接。那将是你最好的选择。

# c# - C# 应用程序中的命令行界面

> ID：11140884
> 
> 赞同：2
> 
> 时间：2012-06-21T14:55:39.210
> 
> 标签：c#, multithreading, command-line-interface

我一直在使用 C# 进行一些项目，没什么大不了的。所以我现在想开始做一个真正的项目。我在 C# 中创建了一个 IRC 机器人。这个 IRC 机器人在命令行中运行时没有 GUI。现在，当它运行时，它会输出每个命令和内容。

我想要做的是在命令行中为应用程序创建一个界面。这样我就可以在应用程序中输入命令并输出命令的结果。

我已经尝试阅读有关多线程我的软件的几个主题，因为我相信这是我实现此功能所必需的。但我不确定。

我已经阅读[了 Java 中的命令行界面](https://stackoverflow.com/questions/4956944/command-line-interface-in-java)和[http://msdn.microsoft.com/en-us/library/aa288457(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa288457(v=vs.71).aspx)等线程。但我还是很困惑。

我试过用谷歌搜索任何工具包，比如[http://alexis.royer.free.fr/CLI/](http://alexis.royer.free.fr/CLI/)

我想就这个问题征求意见，如果可能的话，请帮助我了解这个程序的基础知识。如果有人强烈建议我不要在 C# 中搜索此功能，那么我很乐意听到他/她对为什么不搜索的意见以及关于我应该使用/做什么的建议。

提前谢谢了！罗伯托。

Ps 对于我不正确的英语语法，我深表歉意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:05:01.430

在 Windows 中，进程映像可以在 GUI 模式下启动（屏幕上显示窗口......或根本不启动）或作为“控制台”进程（因此命令窗口将与进程同时打开）。然而，这两者并不相互排斥：“控制台”进程可以创建窗口，而 GUI 进程可以创建并拥有自己的命令行窗口。但是，创建控制台窗口的 GUI 应用程序不会在任何父控制台会话中打开该控制台。

根据我对您的问题的了解，您有一个现有的 GUI 应用程序，并且您希望为您的应用程序启用某种控制台（如 Quake 控制台），而不是将其转换为仅限控制台的程序。

这可以使用 Win32 中的 AllocConsole 函数来完成。我建议您阅读此问答：[如何在 Winforms 中包含控制台？](https://stackoverflow.com/questions/3917202/how-do-i-include-a-console-in-winforms)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:06:33.903

如果您对是否需要对应用程序进行多线程感到困惑，我建议您先阅读一些有关线程的优点和缺点的内容。[Joe Albahari 的网络书](http://www.albahari.com/threading/)的第一章是一个很好的介绍。

在不完全了解您的程序设计的情况下，我建议您在后台线程上执行所有聊天机器人行为。此外，您在控制台中键入的任何命令也应该触发后台工作，这使控制台可以自由打印输出或接受输入，但不执行任何实际的聊天任务。请让我知道，如果你有任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-21T15:07:27.733

对于解析命令，您真的不需要使用线程，这里有一些关于完成此操作的最佳方法的信息

[@ Codeplex.com](http://www.codeplex.com/site/search?query=command%20line%20parser&ac=2)上有几个命令行解析器。它们将非常复杂，因此取决于您想要进行多少命令行解析，您可以使用它们。

我会从使用 string.substring 开始

对于 CONNECT [ []] 字符串命令 = "连接 irc://QuakeNet"

```
 int end = command.IndexOf(" ");
  string cmd = command.substring(0,end);

  switch(cmd.ToLower())
  {
    case "connect":
         string site = command.SubString(end + 1, cmd.Length -1)
         //Do what you need to do to connect to the site
    break;
   } 
```

如果你真的到了需要使用线程的地步，你总是可以使用后台工作线程

[关于如何使用后台线程的教程](http://fernandof.wordpress.com/2007/04/04/implementing-multi-threading-in-winforms-using-the-backgroundworker-class/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-21T15:10:16.923

您是否考虑过创建 Windows 服务？该服务将包含您“做事”的所有代码。然后，您可以向服务发出命令（通过[ExecuteCommand](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicecontroller.executecommand.aspx)）。

然后，您可以创建多个 UI，包括控制台和 GUI，它们只需调用服务，然后接收回信息。这将使您能够通过标准命令行窗口发出命令并在 GUI 中查看结果，而无需尝试从同一项目中管理两个窗口。

（这也将为您提供多进程应用程序，而无需自己显式管理进程。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-21T15:14:36.763

这是一个非常简单的命令行，示例说明了如何使用不同的颜色和处理参数：

```
using System;
using System.Linq;

namespace SOSimpleCLI
{
    class Program
    {
        static void Main(string[] args)
        {
            string cmdLine = null;
            while (cmdLine != "end")
            {
                Console.ForegroundColor = ConsoleColor.Green;
                Console.Write("SOSimpleCLI: ");
                Console.ForegroundColor = ConsoleColor.White;

                cmdLine = Console.ReadLine();

                string[] cmd = cmdLine.Split(' ');
                switch (cmd.FirstOrDefault())
                {
                    case "cmd1":
                        Console.WriteLine(Cmd1());
                        break;

                    case "cmd2":
                        if (cmd.Length != 2)
                        {
                            Console.WriteLine("Wrong number of args for cmd2");
                        }
                        else
                        {
                            Console.WriteLine(Cmd2(cmd[1]));
                        }
                        break;
                }
            }
        }

        static string Cmd1()
        {
            return "Came from command 1";
        }

        static string Cmd2(string arg)
        {
            return string.Format("Came from command 2: {0}", arg);
        }
    }
} 
```

我不确定你为什么希望它是多线程的，但你可以通过与不同方法中的线程交互来添加它。

# c++ - 堆损坏

> ID：11140888
> 
> 赞同：-1
> 
> 时间：2012-06-21T14:55:49.637
> 
> 标签：c++, visual-c++

在我的程序中出现“堆损坏”错误

“Windows 已在 Project_Name.exe 中触发断点。这可能是由于堆损坏，这表明 JPS.exe 或其已加载的任何 DLL 中存在错误。这也可能是由于用户在按下 F12 时Project_Name.exe 有焦点。输出窗口可能有更多诊断信息。"

以下是代码：

头文件.h

```
#pragma once

#include <math.h>
#include <iostream>
#include <fstream> 
#include <string>
#include <sstream>
#include <string>
#include <stdio.h>
#include <stack>
#include <vector>
#include <ctime>
#include <cassert>
#include <cmath>

using namespace std;

class ClientInfo
{
public:
int dayM;
string monthM;
int dayL;
string monthL;
string fName, lName;
double itmAmt;
ClientInfo* next;
};

class Record
{
private:
int numOfClients;
public:
int returnNumOfClients();
ClientInfo* head;
Record();
Record* InitializeRecord();
char* CalculateMaturity();
string ViewClient();
Record*  FindName(string nn, ClientInfo *xxx);
void SaveRecord(ClientInfo* h);
double ComputeBalance(double amount, string mnthL, int dyL, string mnthM, int dyM);
ClientInfo* AddClient(string fn,string ln,string xMonthL, int xDayL, string    
    xMonthM, int xDayM ,double xItemAmt);
ClientInfo* SearchClient(string n);
void RemoveItem(ClientInfo* h, ClientInfo* rc, string remfname);
bool CheckExistence(ClientInfo* hx, string fnx, string lnx);

template <typename T>
string numToStr ( T num )
{
    stringstream ss;
    ss << num;
    return ss.str();
}
};

Record::Record():numOfClients(0),head(NULL)
{
}

Record* Record::FindName(string nn, ClientInfo * xxx)
{
ClientInfo* newci = new ClientInfo();
Record* newrec = new Record();
ClientInfo* node= xxx;
do{
    if(node->lName==nn)
    {

        newrec->head=newrec->AddClient(node->fName, 
            node->lName, 
            node->monthL,
            node->dayL,
            node->monthM,
            node->dayM,node->itmAmt);

    }
    node=node->next;
}while(node!=NULL);

return newrec;
}

int Record::returnNumOfClients()
{
return numOfClients;
}

void Record::SaveRecord(ClientInfo* h)
{
Record *rec = new Record();
ClientInfo* saveRec = h;
string str;

vector<string> v;
ofstream outF;
outF.open("Record.txt");

if(saveRec!=NULL)
{
    do
    {
        str = saveRec->fName+'-'+saveRec->lName+'-'+
            rec->numToStr(saveRec->monthL)+'-'+
            rec->numToStr(saveRec->dayL)+'-'+
            rec->numToStr(saveRec->monthM)+'-'+
            rec->numToStr(saveRec->dayM)+'-'+
            rec->numToStr(saveRec->itmAmt);

        saveRec = saveRec->next;

        v.push_back(str);
    }
    while(saveRec != NULL);

    for(vector<string>::iterator it = v.begin(); it != v.end(); ++it)
    {
        if( it != v.begin())
            outF<<'\n';
        outF<< *it;
    }
}
else
    numOfClients=0;

outF.close();

}

char* Record::CalculateMaturity()
{
try
{
    ClientInfo* saveRec = new ClientInfo();
    Record* rec = new Record();
    string str;

    stack<string> month;
    month.push("December");
    month.push("November");
    month.push("October");
    month.push("September");
    month.push("August");
    month.push("July");
    month.push("June");
    month.push("May");
    month.push("April");
    month.push("March");
    month.push("February");
    month.push("January");
    month.push("December");
    month.push("November");
    month.push("October");
    month.push("September");
    month.push("August");
    month.push("July");
    month.push("June");
    month.push("May");
    month.push("April");
    month.push("March");
    month.push("February");
    month.push("January");

    stack<string> mnth;
    mnth.push("December");
    mnth.push("November");
    mnth.push("October");
    mnth.push("September");
    mnth.push("August");
    mnth.push("July");
    mnth.push("June");
    mnth.push("May");
    mnth.push("April");
    mnth.push("March");
    mnth.push("February");
    mnth.push("January");
    mnth.push("December");
    mnth.push("November");
    mnth.push("October");
    mnth.push("September");
    mnth.push("August");
    mnth.push("July");
    mnth.push("June");
    mnth.push("May");
    mnth.push("April");
    mnth.push("March");
    mnth.push("February");
    mnth.push("January");

    const char *delimeter="-";
    char* date=new char;

    time_t     now = time(0);
    struct tm  tstruct;
    char       buf[80];
    tstruct = *localtime(&now);
    strftime(buf, sizeof(buf), "%m-%d", &tstruct);

    date = buf;

    char* token= new char;
    vector<string> dt;

    token=strtok(date,delimeter);
    while(token!=NULL)
    {
        dt.push_back(token);
        token=strtok(NULL,delimeter);
    }

    string monthL,monthM;
    int dayL;
    int monthnum;
    istringstream(dt[0])>>monthnum;
    for(int x=1;x!=monthnum;x++)
        mnth.pop();
    monthL=mnth.top();

    istringstream (dt[1])>>dayL;

    do{month.pop();}while(monthL!=month.top());

    month.pop();
    month.pop();
    month.pop();

    monthM=month.top();

    str=monthL+'-'+
        rec->numToStr(dayL)+'-'+
        monthM+'-'+
        rec->numToStr(dayL);

    int strsize = str.size();
    char* chr = new char;

    for(int x=0;x<strsize;x++)
    {
        chr[x]=str[x];
    }
    return chr;
}
catch(char* ex){system("pause");}
}

ClientInfo* Record::AddClient(string fn, string ln,string xMonthL, int xDayL, string    
xMonthM, int xDayM, double xItemAmt)
{
ClientInfo* newInfo = new ClientInfo();
Record* newRecord = new Record();

newInfo->fName = fn;
newInfo->lName = ln;
newInfo->dayM = xDayM;
newInfo->monthM = xMonthM;
newInfo->dayL = xDayL;
newInfo->monthL = xMonthL;
newInfo->itmAmt = xItemAmt;

if(newInfo->next!=NULL)
{
    newInfo->next = head;
    numOfClients++;
    head = newInfo;
}
else
{
    newInfo->next=NULL;
}

return head;    
}

Record* Record::InitializeRecord()
{
Record* initRec = new Record();
ClientInfo* initClient = new ClientInfo();

ifstream inF;
inF.open("Record.txt");

char* rec;
char* token;
vector<string> v;
int dayL, dayM;
string monthL, monthM;
double itmAmt;

if(inF.good())
{
    do
    {
        rec = new char;
        token = new char;
        inF>>rec;
        token = strtok(rec,"-");
        while(token!=NULL)
        {
            v.push_back(token);
            token = strtok(NULL,"-");
        }

        istringstream(v[2])>>monthL;
        istringstream(v[3])>>dayL;
        istringstream(v[4])>>monthM;
        istringstream(v[5])>>dayM;
        istringstream(v[6])>>itmAmt;
        initRec->AddClient(v[0],v[1],monthL,dayL,monthM,dayM,itmAmt);
        v.erase(v.begin(),v.end());
    }while(!inF.eof());
}

inF.close();
return initRec;
}

void Record::RemoveItem(ClientInfo* h, ClientInfo* rc, string remfname)
{
ClientInfo* head = h;
ClientInfo* temp = rc->next;
if(temp!=NULL)
{
    rc->fName = rc->next->fName;
    rc->lName = rc->next->lName;
    rc->monthL = rc->next->monthL;
    rc->dayL = rc->next->dayL;
    rc->monthM = rc->next->monthM;
    rc->dayM = rc->next->dayM;
    rc->itmAmt = rc->next->itmAmt;

    rc->next = temp->next;
    numOfClients--;
    free(temp);
}
else
{
    head = NULL;
    free(temp);
}
SaveRecord(head);
}

ClientInfo* Record::SearchClient(string n)
{
ClientInfo* current = head;

for(int x=numOfClients-1;current!=NULL;x--)
{
    if(current->lName == n)
        return current;
    else
        current = current->next;
}

return current;
}

string Record::ViewClient()
{
string s;
ClientInfo* itr;
itr = head;
if(numOfClients!=0)
{
    for(int i = 0; i<returnNumOfClients();i++)
    {
        string empty = "";
        int y = i+1;
        s+="\n\n***************\nName: "+itr->fName+" "+itr->lName+"\n-----            
                    ----------\n"+
            "Loan Origination Date: "+numToStr(itr->monthL)+" 
                    "+numToStr(itr->dayL)+
            "\n---------------\n"+"Date Of Maturity: "+numToStr(itr-                       
                    >monthM)+" "+numToStr(itr->dayM)+"\n---------------\n"+
            "Balance: "+numToStr(itr->itmAmt);
        itr = itr->next;
    }

    s.append("\n***************\n\n");
}
else
    s ="There is no recorded client yet.\n\n";

return s;
}

double Record::ComputeBalance(double amount, string mnthL, int dyL, string mnthM, int  
    dyM)
{
try
{
    double INTEREST = 0.04;

    double PENALTY = 0.02;

    stack<string> monthl;
    monthl.push("December");
    monthl.push("November");
    monthl.push("October");
    monthl.push("September");
    monthl.push("August");
    monthl.push("July");
    monthl.push("June");
    monthl.push("May");
    monthl.push("April");
    monthl.push("March");
    monthl.push("February");
    monthl.push("January");
    monthl.push("December");
    monthl.push("November");
    monthl.push("October");
    monthl.push("September");
    monthl.push("August");
    monthl.push("July");
    monthl.push("June");
    monthl.push("May");
    monthl.push("April");
    monthl.push("March");
    monthl.push("February");
    monthl.push("January");

    stack<string> monthm;
    monthm.push("December");
    monthm.push("November");
    monthm.push("October");
    monthm.push("September");
    monthm.push("August");
    monthm.push("July");
    monthm.push("June");
    monthm.push("May");
    monthm.push("April");
    monthm.push("March");
    monthm.push("February");
    monthm.push("January");
    monthm.push("December");
    monthm.push("November");
    monthm.push("October");
    monthm.push("September");
    monthm.push("August");
    monthm.push("July");
    monthm.push("June");
    monthm.push("May");
    monthm.push("April");
    monthm.push("March");
    monthm.push("February");
    monthm.push("January");

    int ml=0;
    int mm=0;

    do{
        monthl.pop();
        mm++;
    }while(mnthL!=monthl.top());

    do
    {
        monthm.pop();
        ml++;
    }while(mnthM!=monthm.top());

    int diff=abs(mm-ml);
    double balance=diff*(amount*(INTEREST+  
                                                 (INTEREST/(pow(INTEREST+1,diff)-1))));

    return balance;
}
catch(double ex){system("pause");}
}

bool Record::CheckExistence(ClientInfo* hx, string fnx, string lnx)
{
ClientInfo *hh;
hh = head;
int t=0;

for(int x=numOfClients; hh!=NULL && x!=0; x--)
{
    if(hh->fName == fnx && hh->lName==lnx)
        t++;
    else
        hh=hh->next;
}

if(t!=0)
    return true;
else
    return false;
} 
```

主文件

```
#include "Header.h"

int main()
{

Record* rec = new Record();
ClientInfo* info;

Record* samelastrec = new Record();
double amt;
double balance;
int number;
int choose;
char ch;
double principal;
string iLName,iFName;
string nn;
int iDayL,iDayM;
string iMonthL,iMonthM;
string delfname;
rec=rec->InitializeRecord();

again:
system("cls");
cout<<"WELCOME TO JEWELRY PAWNING SYSTEM."<<endl;
cout<<"\n(1)Add Client\n(2)Remove Client\n(3)Search Client\n\n->";

cin>>choose;
Record *find = new Record();
ClientInfo* found;

system("cls");
int search;
char* datelm;
char* token;
vector<string> date;
string nnx; 
switch(choose)
{
case 1:

    system("cls");

    if(rec->returnNumOfClients()!=0 || rec->returnNumOfClients()!=NULL)
    {
        cout<<"First Name: ";
        cin>>iFName;
        cout<<"Last name: ";
        cin>>iLName;

        if(!rec->CheckExistence(rec->head,iFName,iLName))
        {
            cout<<"Amount: ";
            cin>>amt;
            datelm=rec->CalculateMaturity();

            token=strtok(datelm, "-");
            while(token!=NULL)
            {
                date.push_back(token);
                token=strtok(NULL, "-");
            }

            istringstream(date[0])>>iMonthL;
            istringstream(date[1])>>iDayL;
            istringstream(date[2])>>iMonthM;
            istringstream(date[3])>>iDayM;

    balance=rec->ComputeBalance(amt,iMonthL,iDayL,iMonthM,iDayM);
            istringstream(rec->numToStr(balance));

    rec->head=rec>AddClient(iFName,iLName,iMonthL,iDayL,iMonthM,iDayM,balance);
            system("pause");
        }
        else
        {
            cout<<"Member already exist!"<<endl;
            system("pause");
        }
    }
    else
    {
        cout<<"First Name: ";
        cin>>iFName;
        cout<<"Last name: ";
        cin>>iLName;
        cout<<"Amount: ";
        cin>>amt;
        datelm=rec->CalculateMaturity();

        token=strtok(datelm, "-");
        while(token!=NULL)
        {
            date.push_back(token);
            token=strtok(NULL, "-");
        }

        istringstream(date[0])>>iMonthL;
        istringstream(date[1])>>iDayL;
        istringstream(date[2])>>iMonthM;
        istringstream(date[3])>>iDayM;

        balance=rec->ComputeBalance(amt,iMonthL,iDayL,iMonthM,iDayM);
        istringstream(rec->numToStr(balance));

    rec->head=rec>AddClient(iFName,iLName,iMonthL,iDayL,iMonthM,iDayM,balance);
        system("pause");
    }

    rec->SaveRecord(rec->head);
    goto again;
    break;

case 2:
    system("cls");
    find->head = rec->head;
    cout<<"Enter Last Name: ";
    cin>>iLName;
    samelastrec=new Record();
    samelastrec=samelastrec->FindName(iLName, rec->head);

    if(find->SearchClient(iLName) == NULL)
    {
        cout<<"Client not found.\n";
        system("pause");
    }
    else
    {

        found = find->SearchClient(iLName);

        if(samelastrec->returnNumOfClients()>1)
        {
            cout<<samelastrec->ViewClient()<<endl<<endl;

           cout<<"There are "<<samelastrec->numToStr(samelastrec->returnNumOfClients())    
                            <<" Clients with "<<samelastrec->head->lName<<" last name";
            cout<<endl<<"Enter the first name of the client you want to 
                                                                             remove: ";
            cin>>delfname;
            system("cls");

            if(samelastrec->CheckExistence(samelastrec->head,delfname, 
                                                                            iLName))
            {
                cout<<endl<<"Do you want to remove "<<delfname<<" 
                                            <<samelastrec->head->lName<<" ?(Y/N)";
                cin>>ch;

                if(ch=='Y' || ch=='y')
                {
                    rec->RemoveItem(rec->head,found,delfname);
                    cout<<"Client Removed."<<endl;
                    system("cls");

                }
                else if(ch=='N' || ch=='n')
                    goto again;
            }
            else
            {
                cout<<"The member with "<<delfname<<" does not 
                                    exist."<<endl;
                system("pause");
                goto again;
            }

            system("pause");
        }
        else
        {
            cout<<endl<<samelastrec->ViewClient()<<endl;
            cout<<"Remove Client? [Y/N]: ";
            cin>>ch;

            if(ch=='Y' || ch=='y')
            {
                system("cls");
                rec->RemoveItem(rec->head,found,found->fName);
                cout<<"Client Removed."<<endl;
                system("pause");
            }
            else if(ch=='N' || ch=='n')
                goto again;
        }
    }
    goto again;
    break;

case 3:
    system("cls");
    cout<<"Enter Last Name : ";
    cin>>nnx;

    samelastrec=new Record();
    samelastrec=samelastrec->FindName(nnx, rec->head);
    cout<<samelastrec->ViewClient()<<endl;

    system("pause");
    break;
case 4:
    system("cls");
    cout<<rec->ViewClient();
    system("pause");
    goto again;
    break;

case 5:
    cout<<"Number of clients: "<<rec->numToStr(rec->returnNumOfClients())
                                                                                <<endl;
    system("pause");
    break;
default:
    if(choose!=0)
    {
        cout<<"\n\nInvalid Entry.\n\n";
        system("pause");
        goto again;
    }
    else
    {
        cout<<"\n\nTHANK YOU FOR USING THE JEWELRY PAWNING SYSTEM!\n\n";
        system("pause");
        exit(1);
    }
}
goto again;
system("pause");
return 0;
} 
```

我无法弄清楚为什么我会收到这些错误。

请帮我调试这个错误。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:04:35.920

在您的整个代码中，您有这样的部分会破坏您不拥有的内存：

```
int strsize = str.size();
char* chr = new char;

for(int x=0;x<strsize;x++)
{
    chr[x]=str[x];
}
return chr; 
```

看起来您不太了解指针和`new`工作原理。`new char;`为一个字符分配足够的内存——通常是一个字节；因此，当`x`在后续循环中大于 0 时，您将覆盖您不拥有的内存，最终导致崩溃。你有很多这样的代码部分。为操作分配正确的内存量（例如`new char[strsize]`），或者（最好）使用 C++ 字符串而不是字符数组。

（我还注意到您似乎永远不会释放您分配的任何内存，这最终会导致问题，因为您在程序运行期间执行更多分配。通常，每次使用`new`应与相应使用 匹配`delete`） .

# xslt - 按属性排序的元素

> ID：11140889
> 
> 赞同：0
> 
> 时间：2012-06-21T14:55:50.603
> 
> 标签：xslt, sorting

我是 xsl(t) 的新手。

在阅读了一些关于此的主题之后，困惑变得越来越大。我必须通过一个属性来转换一个 xml 文件的一个小节。

```
<?xml version="1.0" encoding="iso-8859-1" standalone="yes"?>
<Rechnung AuftragsReferenz="" MarketingCode="KAN00" Auftragsart="Normal" Auftragsherkunft="Schriftlich" AnzahlPakete="1" ZuZahlenderBetrag="94.30" SummeNebenerloeseNetto="6.07" SummeNebenerloeseBrutto="6.50" EnthalteneMWST="7.86" BetragNetto="86.44" BetragBrutto="94.30" Rechnungsdatum="25.05.2012" Rechnungsnummer="123456789" Zahlungskanal="Rechnung">
    <RechnungArtikelpositionen>
        <RechnungArtikelposition EinzelPreisNetto="0.00" EinzelPreisBrutto="0.00" GesamtPreisNetto="0.00" GesamtPreisBrutto="0.00" Menge="1.00">
            <Rechnungnebenerloese/>
            <RechnungMehrwertsteuer Prozentsatz="19.00" Steuerbetrag="2.87" Nettobetrag="15.08"/>
            <Artikelposition Absagekennzeichen="Allein im Rückstand" AbsagekennzeichenId="38" Artikeltyp="Geschenk" ArtikeltypId="8" Zusatztextkennzeichen="1" Zusatztext="" Bestellnummer="82000" Bestellmenge="1.00" Artikelbezeichnung="Dankeschön" Katalogkennzeichen="K4"/>
            <Ersatzartikel Zusatztextkennzeichen="" Zusatztext="" Bestellnummer="12345" Bestellmenge="1.00" Artikelbezeichnung="Geschenk: EinGeschenk" Katalogkennzeichen="K4"/>
        </RechnungArtikelposition>
        <RechnungArtikelposition EinzelPreisNetto="15.08" EinzelPreisBrutto="17.95" GesamtPreisNetto="15.08" GesamtPreisBrutto="17.95" Menge="1.00">
            <Rechnungnebenerloese/>
            <RechnungMehrwertsteuer Prozentsatz="19.00" Steuerbetrag="2.87" Nettobetrag="15.08"/>
            <Artikelposition Absagekennzeichen="Keine Absage" AbsagekennzeichenId="1" Artikeltyp="Verkauf" ArtikeltypId="0" Zusatztextkennzeichen="1" Zusatztext="" Bestellnummer="54321" Bestellmenge="1.00" Artikelbezeichnung="Massageöl Latschenkiefer" Katalogkennzeichen="K4"/>
            <Ersatzartikel/>
        </RechnungArtikelposition>
        <RechnungArtikelposition EinzelPreisNetto="27.99" EinzelPreisBrutto="29.95" GesamtPreisNetto="27.99" GesamtPreisBrutto="29.95" Menge="1.00">
            <Rechnungnebenerloese/>
            <RechnungMehrwertsteuer Prozentsatz="7.00" Steuerbetrag="4.99" Nettobetrag="71.36"/>
            <Artikelposition Absagekennzeichen="Keine Absage" AbsagekennzeichenId="1" Artikeltyp="Verkauf" ArtikeltypId="0" Zusatztextkennzeichen="" Zusatztext="" Bestellnummer="44444" Bestellmenge="1.00" Artikelbezeichnung="Knoblauchkapseln 60 Stück   +" Katalogkennzeichen="K4"/>
            <Ersatzartikel/>
        </RechnungArtikelposition>
        <RechnungArtikelposition EinzelPreisNetto="18.64" EinzelPreisBrutto="19.95" GesamtPreisNetto="37.28" GesamtPreisBrutto="39.90" Menge="2.00">
            <Rechnungnebenerloese/>
            <RechnungMehrwertsteuer Prozentsatz="7.00" Steuerbetrag="4.99" Nettobetrag="71.36"/>
            <Artikelposition Absagekennzeichen="Keine Absage" AbsagekennzeichenId="1" Artikeltyp="Verkauf" ArtikeltypId="0" Zusatztextkennzeichen="" Zusatztext="" Bestellnummer="55555" Bestellmenge="2.00" Artikelbezeichnung="Echte Sauerampfer Kapseln 60 St.+" Katalogkennzeichen="K4"/>
            <Ersatzartikel/>
        </RechnungArtikelposition>
    </RechnungArtikelpositionen>
<other things />
</Rechnung> 
```

“Artikelposition”应按“EinzelPreisBrutto”排序

我尝试了几种变体，最新的是：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:template match="/">
        <xsl:copy-of select="Rechnung">
           <xsl:copy-of select="RechnungArtikelpositionen" />
             <xsl:apply-templates select="RechnungArtikelposition">
                <xsl:sort select="@EinzelPreisBrutto" data-type="number" order="descending"/>
             </xsl:apply-templates>
        </xsl:copy-of>
    </xsl:template>

</xsl:stylesheet> 
```

但没有排序发生。我究竟做错了什么？提前谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:59:49.240

您的 XSLT 当前实际上无效**xsl:copy-of**函数不应包含其中的任何元素（它仅用于“按原样”复制元素

此外，您需要确保在应用 RechnungArtikelposition 的模板时，**您位于 RechnungArtikelpositionen****的**正确父元素上。在您的代码示例中，当前位置将是 XML 的文档元素。

不要使用 xsl:copy-of，而是尝试使用带有额外模板的身份模板来匹配**RechnungArtikelpositionen**，然后对子项进行排序。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="RechnungArtikelpositionen">
      <xsl:copy>
         <xsl:apply-templates select="@*"/>
         <xsl:apply-templates select="RechnungArtikelposition">
            <xsl:sort select="@EinzelPreisBrutto" data-type="number" order="descending"/>
         </xsl:apply-templates>
      </xsl:copy>
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

当应用于您的示例 XML 时，将输出以下内容：

```
<Rechnung AuftragsReferenz="" MarketingCode="KAN00" Auftragsart="Normal" Auftragsherkunft="Schriftlich" AnzahlPakete="1" ZuZahlenderBetrag="94.30" SummeNebenerloeseNetto="6.07" SummeNebenerloeseBrutto="6.50" EnthalteneMWST="7.86" BetragNetto="86.44" BetragBrutto="94.30" Rechnungsdatum="25.05.2012" Rechnungsnummer="123456789" Zahlungskanal="Rechnung">
   <RechnungArtikelpositionen>
      <RechnungArtikelposition EinzelPreisNetto="27.99" EinzelPreisBrutto="29.95" GesamtPreisNetto="27.99" GesamtPreisBrutto="29.95" Menge="1.00">
         <Rechnungnebenerloese/>
         <RechnungMehrwertsteuer Prozentsatz="7.00" Steuerbetrag="4.99" Nettobetrag="71.36"/>
         <Artikelposition Absagekennzeichen="Keine Absage" AbsagekennzeichenId="1" Artikeltyp="Verkauf" ArtikeltypId="0" Zusatztextkennzeichen="" Zusatztext="" Bestellnummer="44444" Bestellmenge="1.00" Artikelbezeichnung="Knoblauchkapseln 60 Stück   +" Katalogkennzeichen="K4"/>
         <Ersatzartikel/>
      </RechnungArtikelposition>
      <RechnungArtikelposition EinzelPreisNetto="18.64" EinzelPreisBrutto="19.95" GesamtPreisNetto="37.28" GesamtPreisBrutto="39.90" Menge="2.00">
         <Rechnungnebenerloese/>
         <RechnungMehrwertsteuer Prozentsatz="7.00" Steuerbetrag="4.99" Nettobetrag="71.36"/>
         <Artikelposition Absagekennzeichen="Keine Absage" AbsagekennzeichenId="1" Artikeltyp="Verkauf" ArtikeltypId="0" Zusatztextkennzeichen="" Zusatztext="" Bestellnummer="55555" Bestellmenge="2.00" Artikelbezeichnung="Echte Sauerampfer Kapseln 60 St.+" Katalogkennzeichen="K4"/>
         <Ersatzartikel/>
      </RechnungArtikelposition>
      <RechnungArtikelposition EinzelPreisNetto="15.08" EinzelPreisBrutto="17.95" GesamtPreisNetto="15.08" GesamtPreisBrutto="17.95" Menge="1.00">
         <Rechnungnebenerloese/>
         <RechnungMehrwertsteuer Prozentsatz="19.00" Steuerbetrag="2.87" Nettobetrag="15.08"/>
         <Artikelposition Absagekennzeichen="Keine Absage" AbsagekennzeichenId="1" Artikeltyp="Verkauf" ArtikeltypId="0" Zusatztextkennzeichen="1" Zusatztext="" Bestellnummer="54321" Bestellmenge="1.00" Artikelbezeichnung="Massageöl Latschenkiefer" Katalogkennzeichen="K4"/>
         <Ersatzartikel/>
      </RechnungArtikelposition>
      <RechnungArtikelposition EinzelPreisNetto="0.00" EinzelPreisBrutto="0.00" GesamtPreisNetto="0.00" GesamtPreisBrutto="0.00" Menge="1.00">
         <Rechnungnebenerloese/>
         <RechnungMehrwertsteuer Prozentsatz="19.00" Steuerbetrag="2.87" Nettobetrag="15.08"/>
         <Artikelposition Absagekennzeichen="Allein im Rückstand" AbsagekennzeichenId="38" Artikeltyp="Geschenk" ArtikeltypId="8" Zusatztextkennzeichen="1" Zusatztext="" Bestellnummer="82000" Bestellmenge="1.00" Artikelbezeichnung="Dankeschön" Katalogkennzeichen="K4"/>
         <Ersatzartikel Zusatztextkennzeichen="" Zusatztext="" Bestellnummer="12345" Bestellmenge="1.00" Artikelbezeichnung="Geschenk: EinGeschenk" Katalogkennzeichen="K4"/>
      </RechnungArtikelposition>
   </RechnungArtikelpositionen>
   <otherthings/>
</Rechnung> 
```

# c# - WEKA J48 类的 C# 或 .NET 实现？

> ID：11140891
> 
> 赞同：2
> 
> 时间：2012-06-21T14:55:50.887
> 
> 标签：c#, java, .net, algorithm, machine-learning

我正在[从 WEKA 机器学习库中寻找 J48 决策树类的 Java 代码的 C# 转换或实现。](http://read.pudn.com/downloads122/sourcecode/java/517508/weka-src/weka/classifiers/j48/J48.java__.htm)

虽然我可以自己转换它，但我希望节省一些时间并找到一个干净的注释实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-01T06:44:00.337

协议框架实现了 ID3 和 C4.5 学习算法。J48 是 C4.5 的开源版本。

[http://accord.googlecode.com/svn/docs/html/N_Accord_MachineLearning_DecisionTrees_Learning.htm](http://accord.googlecode.com/svn/docs/html/N_Accord_MachineLearning_DecisionTrees_Learning.htm)

# google-maps - 从地图 API 获取建筑物的高度

> ID：11140895
> 
> 赞同：8
> 
> 时间：2012-06-21T14:56:02.613
> 
> 标签：google-maps, maps, bing-maps, openstreetmap

是返回某些点的屋顶高度的任何公共地图 API（谷歌、微软、openstreet ...）吗？

想象一下：您请求一些地址，API 返回坐标、一些信息和建筑物的高度（如果有）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T08:34:12.327

OpenStreetMap 有一个[高度标签](http://wiki.openstreetmap.org/wiki/Key:height)和[各种其他与建筑物相关的标签](http://wiki.openstreetmap.org/wiki/Proposed_features/Building_attributes)，例如您可以估计高度的[建筑物：级别。](http://wiki.openstreetmap.org/wiki/Key:building:levels)但是请注意，目前大多数建筑物都缺少这些标签，因为它们迄今尚未广泛使用。您仍然可以尝试使用[Overpass API](http://wiki.openstreetmap.org/wiki/Overpass_API) / [overpass turbo](http://overpass-turbo.eu/)请求特定点或区域周围的所有建筑物，然后查找这些标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-22T10:01:00.553

我几乎可以肯定答案是“不”。要获取此信息，您需要 LIDAR 数据或类似的数据，并且没有任何像准确确定单个建筑物屋顶高度所需的分辨率的 LIDAR 数据的全球数据集。

许多网络地图服务在内部使用地形和建筑高程模型来计算它们的“3d”视图模式，但我认为这些数据从未公开过，即使它是我认为它只适合显示目的而不是用于执行任何计算。

# c# - C# 中如何打包小数据类型

> ID：11140897
> 
> 赞同：5
> 
> 时间：2012-06-21T14:56:08.727
> 
> 标签：c#, .net, memory-management, mono

我不希望提高性能或内存使用率，这个问题纯粹是出于好奇。

**主要问题** 给定以下类，C# 编译器（Mono + .NET）会将这两个`short`变量打包成 4 个字节，还是它们会消耗 8 个字节（对齐）？

```
public class SomeClass {
    short a;
    short b;
} 
```

**次要问题** 如果上述问题的答案不是 4 个字节，那么以下替代方案是否会提供任何优势（其中`SomeClass`大量使用）：

```
// Warning, my bit math might not be entirely accurate!
public class SomeClass {
    private int _ab;

    public short a {
        get { return _ab & 0x00ff; }
        set { _ab |= value & 0x00ff;
    }
    public short b {
        get { return _ab >> 8; }
        set { _ab |= value << 8; }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T15:01:00.463

正如@David_M 所说，它取决于运行时，但您可以通过使用具有可用于控制打包`[StructLayout]`的成员的属性来强制它。`Pack`或者，您可以使用`[FieldOffset]`手动布局结构的成员（甚至重叠，这是您在 .NET 中实现联合的方式）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-21T15:03:25.190

这取决于运行时，而不是编译器。您可以使用 覆盖默认行为[`[StructLayout]`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.aspx)，这会有所帮助 - 尽管默认行为应该没问题。

话虽如此，如果最小化总大小是绝对要求，您可能需要考虑 a`struct`而不是 a `class`。使用类时，类的每个实例都会增加大量开销。在 syncblk、TypeHandle 等以及引用（在 64 位系统上是另外 8 个字节）对象实例之间使用了相当数量的“额外”内存，超出了您的两条短裤。有关详细信息，请参阅[“CLR 如何创建运行时对象”](http://msdn.microsoft.com/en-us/magazine/cc163791.aspx)。

将打包的数据存储到值类型的集合中可以完全避免这种情况，并使每个实例总共减少到 8 个字节（加上集合开销）。当然，这会在使用方面改变语义，但如果您只使用两个短裤，这将减少您的类型所涉及的开销，尤其是在 64 位系统上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-21T15:01:10.190

正如其他人所评论的那样，实际布局取决于运行时，主要是因为您可以跨多个平台运行相同的代码。

是的，如果有许多可以节省空间的对象。您正在寻找的是 LayoutKind （StructLayout 属性）。它可以让您随心所欲地打包成员。例如，使用 Sequential 时，它会确保它被打包得很紧。

```
[StructLayout(LayoutKind.Sequential)]
public class SomeClass {
    short a;
    short b;
} 
```

有关更多信息，请查看[MSDN-Structlayout](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute%28v=vs.110%29.aspx)

# java - SQLException：无法打开数据库文件 - Windows 7

> ID：11140901
> 
> 赞同：0
> 
> 时间：2012-06-21T14:56:18.783
> 
> 标签：java, windows-7, sqlite, file-permissions

我在使用 SQLite 和 Java 的 Windows 7 上存在权限问题。从 Eclipse 调试时一切正常。当我尝试运行 relase 应用程序时，我收到此错误：

```
java.sql.SQLException: unable to open database file
at org.sqlite.DB.execute(DB.java:275)
at org.sqlite.DB.executeUpdate(DB.java:281)
at org.sqlite.Stmt.executeUpdate(Stmt.java:103)
at com.project.application.Dao.reinit(Dao.java:38) 
```

数据存储在 c:\Users\\AppData\Roaming\\data\ 并且应用程序能够在同一目录中写入配置文件。

奇怪的是，当我以“以管理员身份运行”启动应用程序时，应用程序可以工作！

# sql-server - 重写存储过程以删除游标

> ID：11140902
> 
> 赞同：-1
> 
> 时间：2012-06-21T14:56:24.053
> 
> 标签：sql-server, tsql, stored-procedures, cursor

我正在尝试从此存储过程中删除游标，但不确定在有效语句中运行这种操作的最佳最新最佳实践。

任何人都可以提供任何伪代码来实现从开发人员的角度消除这些问题吗？

```
 --Generate the channel date from a specified date
DECLARE @ConvDate DATETIME
SET @ConvDate = DateAdd(day,-100,getDate())
WHILE DateDiff(day,GetDate(), @ConvDate ) < 0 
BEGIN
    EXEC mltGenerateChannelData @ConvDate
    SET @ConvDate = DateAdd(day, 1, @ConvDate)
END

        CREATE PROCEDURE [dbo].[mltGenerateChannelData] (@ConvDate DATETIME)  AS  
        BEGIN  

           DECLARE @ChannelId INT, 
           @URLSignature Varchar(30), 
           @RawSQL VARCHAR(2000), 
           @SQLQuery VARCHAR(4000), 
           @ThisUTMId BIGINT 

           DECLARE cursChannels CURSOR STATIC FOR 
            SELECT 
                ChannelId, 
                URLSignature, 
                RawSQL  
            FROM dbo.TrackingChannel_tbl (NOLOCK) 
            WHERE ProcessVisitDate = 1  

            SET @ConvDate = dbo.datePart_fn(@ConvDate)  

         --Clear out any existing data for this conversion date  
         DELETE FROM TrackingChannelDailyTotal_tbl 
         WHERE TrackingDate = @ConvDate  

         OPEN cursChannels  

         FETCH cursChannels INTO @ChannelId, @URLSignature, @RawSQL  

         CREATE TABLE #UTM 
         (trpUTMID BIGINT PRIMARY KEY, 
         TotalMArgin MONEY, 
         RawURLRequest Varchar(2000), 
         Keywords VARCHAR(1000), 
         VisitDate DATETIME, 
         RefererURL VARCHAR(2000))  

         INSERT INTO #UTM (trputmid, TotalMargin)  
            SELECT trpUTMID, SUM(b.TotalMArgin)  
            FROM TrackingConversion_tbl c(NOLOCK), Booking_tbl b(NOLOCK)               
            WHERE c.BookingId = b.BookingId  
            AND c.BookedDate >= @ConvDate  
            GROUP BY trputmid  

         UPDATE u  
            SET RawURLRequest = v.RawURLRequest,  
             Keywords = v.Keywords,  
                   VisitDate = v.VisitDate,  
                   RefererURL = v.RefererURL  
             FROM #UTM u,    
            TrackingVisit_tbl (NOLOCK)  v   
         WHERE v.trpUTMID = u.trpUTMId  

         CREATE TABLE #UTM2  (trpUTMID BIGINT PRIMARY KEY)  

         WHILE @@FETCH_STATUS = 0  
         BEGIN  

           Print 'Processing Channel Id : ' + Convert(varchar(10), @ChannelId)  

           TRUNCATE TABLE #UTM2  

           SET @SQLQuery = ' INSERT INTO #UTM2 (trpUTMId)  
                             SELECT u.TrpUTMId  
                             FROM #UTM u               
                             WHERE u.VisitDate >= ''' + COnvert(varchar,@ConvDate) + '''   
                             AND u.VisitDate < DateAdd(day,1,''' + Convert(varchar,@ConvDate) + ''') '  

           IF @URLSignature <> ''  
           BEGIN              
            SET @SQLQuery = @SQLQuery + 'AND u.RawURLRequest like ''%' + @URLSignature + '%'' '    
           END  

           IF @RawSQL <> ''  
           BEGIN  
            SET @SQLQuery = @SQLQuery + @RawSQL  
           END  

           EXEC (@SQLQuery)  

           INSERT INTO TrackingChannelDailyTotal_tbl (ChannelId, TrackingDate, Conversions, TotalMargin)  
            SELECT @ChannelId, @ConvDate, Count(u1.trpUTMID), IsNUll(SUM(TotalMargin),0)  
            FROM #UTM u1, #UTM2 u2  
            WHERE u1.TRputmid = u2.trputmid  

           FETCH cursChannels INTO @ChannelId, @URLSignature, @RawSQL  

         END  

         CLOSE cursChannels  
         DEALLOCATE cursChannels 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:36:09.727

如果您使用 SSMS 工具 (http://www.ssmstoolspack.com/) 和 'Include Actual Execution plan' 与查询，您可以打破查询中的瓶颈，采取每个部分并尝试隔离和改进询问。

您可能会发现问题出在查询的不同部分，而不是光标。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-22T11:23:08.220

如果旧服务器是指内存或处理能力低，并且如果升级硬件作为 DBA 是可行的，我会建议升级硬件。

# .net - OAuth 桌面应用程序

> ID：11140910
> 
> 赞同：-2
> 
> 时间：2012-06-21T14:56:59.217
> 
> 标签：.net, oauth, desktop-application, shopify

（为了社区的利益，请在此处将通过电子邮件发送的问题复制/粘贴到 apps@shopify.com。）

=====

你好，

我正在开发一个访问订单和履行信息的私人桌面应用程序，这样仓库人员就可以不时地获得自动报告，而无需与 Web 浏览器交互。

我们尝试使用基本身份验证，但它似乎仅适用于用户代理访问。每当我们从桌面应用程序中使用它时，它根本不允许我们访问任何数据。

我们尝试使用 oauth，但桌面应用程序的工作流程很奇怪（礼貌），而且似乎也不支持（桌面应用程序工作流程）。

如何启动并运行内部私有桌面应用程序？

我们正在使用.NET。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:56:55.717

Per this other answer at [Is it possible to create a desktop app using facebook oauth 2.0 authentication without required a browser interaction?](https://stackoverflow.com/questions/3936813/is-it-possible-to-create-a-desktop-app-using-facebook-oauth-2-0-authentication-w/5049806#5049806) ，您的应用程序应该打开/嵌入一个 Web 浏览器，该浏览器与请求作者的 Web 应用程序执行相同的操作，并重定向到对计算的密码进行编码的本地 URL。我建议使用像 itunes://whatever 这样的协议处理程序，这很容易。

或者，如果您只打算这样做一次，您可以使用[旧密码方案](http://api.shopify.com/legacy_authentication.html)手动计算密码（您只需要令牌 t 并手动计算其余部分）并使用此密码手动配置您的桌面应用程序。

# visual-studio-2010 - 如何在 Visual Studio 2010 中为没有代码隐藏的 asmx 文件获得 C# 语法突出显示？

> ID：11140913
> 
> 赞同：1
> 
> 时间：2012-06-21T14:57:17.787
> 
> 标签：visual-studio-2010, visual-studio, asmx, syntax-highlighting, intellisense

需要一个可快速部署的 .asmx Web 服务，我按照[如何在没有代码隐藏文件的情况下创建 ASMX Web 服务页面](https://stackoverflow.com/questions/437674/how-do-i-create-an-asmx-web-service-page-without-a-code-behind-file/437697#comment14570540_437697)这一问题的说明进行操作，但发现自己没有语法高亮或 Intellisense。

如何在没有代码隐藏的情况下为直接在 .asmx 文件中编写的 C# 代码启用语法突出显示和 Intellisense？

# android - 使用 ImageButtons 在多个视图之间切换

> ID：11140915
> 
> 赞同：0
> 
> 时间：2012-06-21T14:57:20.670
> 
> 标签：android, android-layout

在视图之间切换时出现错误。我`android:onClick="onClick"`在 xml 中的每个图像按钮上都有。这是代码

```
 selfHelp = (ImageButton)findViewById(R.id.selfhelpButton);
    services = (ImageButton)findViewById(R.id.services);
    messages = (ImageButton)findViewById(R.id.mailButton);
    about = (ImageButton)findViewById(R.id.aboutButton);
    more = (ImageButton)findViewById(R.id.moreButton);
    selfHelp.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {               
                Intent myIntent = new Intent(view.getContext(), SelfHelp.class);
                startActivity(myIntent);
        }

    });
    Services.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {          
            Intent myIntent = new Intent(view.getContext(), Services.class);
            startActivity(myIntent);
        }

    });

    messages.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {               
            Intent myIntent = new Intent(view.getContext(), Messages.class);
            startActivity(myIntent);
        }

    });

    about.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {               
            Intent myIntent = new Intent(view.getContext(), About.class);
            startActivity(myIntent);
        }

    });

    more.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {               
            Intent myIntent = new Intent(view.getContext(), More.class);
            startActivity(myIntent);
        }

    }); 
```

我在另一个页面上只有一个按钮，但图像按钮不起作用。任何帮助都会很棒

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:00:22.927

你有两个选择

1.  在每个 ImageButton 上删除`android:onClick="onClick"`，因为您已经在按钮上设置了单击侦听器，以覆盖默认的**onClick()**方法。
2.  删除所有**setOnclickListener()**方法并在您的 ImageButtons 添加属性：

    ```
    android:onClick="onClick"   
    android:clickable="true" 
    ```

在您的活动中使用：

```
public void onClick(View v){
Intent i = null;
switch(v.getId()){
case R.id.services:
       i = new Intent(this,Services.class);
       startActivity(i);
       break;
case R.id.mailButton:
..........
break;

} 
```

# c - 如何编写类似 sftp 的密码提示？

> ID：11140920
> 
> 赞同：0
> 
> 时间：2012-06-21T14:57:35.433
> 
> 标签：c, posix, sftp, expect

像 sftp 这样的命令以无法通过管道输入用户输入的方式工作（例如：密码等...）

Q1: sftp 是如何做到这一点的？Q2：像expect这样的程序是如何绕过这个限制的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T14:59:15.327

1.  需要连接 TTY 进行输入。
2.  期待等。分配 PTTY 来解决这个问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-21T14:59:57.043

sftp 从控制终端读取输入，而不仅仅是从标准输入。Expect 和类似的方法通过在他们的控制下创建一个伪终端并使其成为他们正在与之交谈的进程的控制终端来解决它。

# java - Glassfish 3.1.2 FacesServlet 问题

> ID：11140921
> 
> 赞同：2
> 
> 时间：2012-06-21T14:57:37.343
> 
> 标签：java, jsf, glassfish

我有一个 EAR，我成功部署到 GF 3.1.1。现在我正在试用 GF 3.1.2。我的 EAR 已部署，但 Web 应用程序没有出现。

我得到以下异常。

```
21 Jun 2012 16:34:17,285 ERROR com......web.exception.MyExceptionHandler : Serious error happened!  : Error Parsing /login.xhtml: Error Traced[line: 1] Premature end of file.
javax.faces.view.facelets.FaceletException: Error Parsing /login.xhtml: Error Traced[line:    1] Premature end of file.
at com.sun.faces.facelets.compiler.SAXCompiler.doCompile(SAXCompiler.java:425)
at com.sun.faces.facelets.compiler.SAXCompiler.doMetadataCompile(SAXCompiler.java:408)
at com.sun.faces.facelets.compiler.Compiler.metadataCompile(Compiler.java:130)
at com.sun.faces.facelets.impl.DefaultFaceletFactory.createMetadataFacelet(DefaultFaceletFactory.java:327) 
```

我使用 Mojarra 2.1.6。但我没有将它包含在 EAR 中。我也使用 PrimeFaces 3.2。

如前所述，在 GF 3.1.1 上一切正常。

网上有一些稀疏的消息说明了同样的问题，但没有解决方案。

TIA，科恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T15:58:06.603

不知道确切的问题是什么，但我只遇到了 Glassfish 3.1.2 的问题。

当我第一次下载 3.1.2 时，它运行良好，但后来我在我的应用程序中添加了对一些 3rd 方 Web 服务的调用，事情进展得很快。它甚至开始使 NetBeans 崩溃。您是否偶然从您的应用程序中调用任何 Web 服务？

我发现的最稳定/可用的配置是 3.1.1 和 Mojarra 2.1.8。我的 IDE 是 NetBeans 7.1.2。您可以在这里找到在 glassfish 上安装 2.1.8 的说明：http: [//javaserverfaces.java.net/nonav/rlnotes/2.1.8/releasenotes.html](http://javaserverfaces.java.net/nonav/rlnotes/2.1.8/releasenotes.html)

希望这可以帮助。

# javascript - TabContainer 中的多个 UpdateProgress 控件，链接到单个 UpdatePanel

> ID：11140929
> 
> 赞同：0
> 
> 时间：2012-06-21T14:57:58.103
> 
> 标签：javascript, asp.net, .net, ajax

我有一个带有 TabContainer 的 UpdatePanel。每个 TabPanel 中都有一个 Gridview（代码不包括在内，因为它不重要），我希望每个 TabPanel 中都有不同的 UpdateProgress 控件。请参阅下面的代码以获取我正在尝试做的示例。

我知道标准方法是将 UpdateProgress 控件定位在 UpdatePanel 之外，但我希望它/它们位于 UpdatePanel 和 TabContainer 内，因为我希望“正在加载...”消息出现在每个控件的顶部我的网格视图。目前，UpdateProgress 控件适用于第一个 TabPanel（如下面的代码所示），但不适用于第二个或任何后续 TabPanel。

```
<asp:UpdatePanel ID="updTest" runat="server">
<ContentTemplate>
    <ajax:TabContainer ID="conTest" runat="server">
        <ajax:TabPanel ID="pnlTest1" runat="server">
            <!--This UpdateProgress Control Does work-->
            <asp:UpdateProgress ID="UpdateProgress1" runat="server" AssociatedUpdatePanelID="updTest">
                <ProgressTemplate>
                    Loading, please wait....
                </ProgressTemplate>
            </asp:UpdateProgress>
        </ajax:TabPanel>
        <ajax:TabPanel  ID="pnlTest1" runat="server">
            <!--This UpdateProgress Control Doesn't work. How can I fix it?-->
            <asp:UpdateProgress ID="UpdateProgress2" runat="server" AssociatedUpdatePanelID="updTest">
                <ProgressTemplate>
                    Loading, please wait....
                </ProgressTemplate>
            </asp:UpdateProgress>
        </ajax:TabPanel>
    </ajax:TabContainer>
</ContentTemplate> 
```

如果我试图实现这一点的方式不是最好的方式，我愿意接受另一种方法。感谢您的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:23:02.050

您可以做的仍然是只有一个 updateprogress，但在您放置一个 updatepanel 来更改您的 updateProgress 显示的内容。

像这样的东西

```
<asp:UpdateProgress ID="UpdateProgress1" runat="server" DynamicLayout="true">
<ProgressTemplate>
    <asp:UpdatePanel ID="up1" runat="server" >
        <ContentTemplate>
        <!-- put a label of something in here -->

        </ContentTemplate>
    </asp:UpdatePanel>
</ProgressTemplate>
</asp:UpdateProgress> 
```

希望这是有道理的，有时我不是最擅长解释的。

# apache - ELB 可以同时从两个不同的 IP 发送请求吗？

> ID：11140930
> 
> 赞同：2
> 
> 时间：2012-06-21T14:57:58.497
> 
> 标签：apache, amazon-web-services

我使用 mod_rpaf 来获取日志中的真实 IP。但是，它需要负载平衡器 IP。之前，我曾经看到“ELB-HealthChecker/1.0”用户代理来获取ELB的IP。但是，奇怪的是，今天我每次都可以在来自两个不同 IP 的每个实例上看到两个健康检查请求。我的 ELB 和 EC2 实例位于同一可用区。

有人遇到过类似的情况吗？这是预期的行为还是一些异常情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T16:59:50.490

看到各种 ELB IP 地址是正常的。ELB 会随着您网站的流量上下扩展，这些操作会导致您看到不同的 IP 地址。

将 mod_rpaf 与 ELB 一起使用永远不会是一个可靠的解决方案。

如果您想知道 ELB 看到的源 IP，那么您可以使用 X-Forwarded-For 列表中的最后一个值。

另请参阅[此博客文章](http://tech.superhappykittymeow.com/?p=281)以获取 mod_rpaf 的补丁。

# vba - 从VBA中的字符串中提取子字符串

> ID：11140931
> 
> 赞同：1
> 
> 时间：2012-06-21T14:58:01.727
> 
> 标签：vba, excel, excel-2007, substring

我正在寻找编写一些VBA代码来从以下带有括号和连字符的字符串中获取以下信息，即

> ACOST 2012 定价表 -（PRJ 216664 - 金融服务器退役） - 12 个月期限

使用 Excel 2007 的 VBA，我需要在此字符串中获取以下两位并分配给两个不同的变量，即：

*   216664
*   金融服务器退役

我尝试了`Mid()`语法，但无法提取这两个信息。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-21T15:07:26.200

如果格式将保持不变，那么您可以使用它

```
Sub Sample()
    Dim strSample As String

    strSample = "ACOST 2012 Pricing Table - (PRJ 216664 - Financial Server Decommission) - 12 Month Term"
    strSample = Split(Split(strSample, "(")(1), ")")(0)

    Debug.Print Trim(Split(Split(strSample, "-")(0), " ")(1))
    Debug.Print Trim(Split(strSample, "-")(1))
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:53:09.190

另一种方式;

```
Data = "ACOST 2012 Pricing Table - (PRJ 216664 - Financial Server Decommission) - 12 Month Term"

dim re As object, matches as object: Set re = createobject("vbscript.regexp")
re.pattern="- \(.*?(\d+)\s+-\s+(.*?)\)(\s|$)"

with re.Execute(Data)
    msgBox  .item(0).SubMatches(0) & " / " & .item(0).SubMatches(1)
End with 
```

> 获取“-”之后的最后一组数字（“-”之前的“-”被空格包围，然后将所有内容移至下一个），然后是空格或行尾”

# android - 如何以编程方式在其中添加 FrameLayout 和 ImageViews？

> ID：11140934
> 
> 赞同：2
> 
> 时间：2012-06-21T14:58:12.813
> 
> 标签：android, android-layout

SO中有很多类似的问题，但也请花点时间阅读我的问题。

我需要以编程方式创建一个 UI，该 UI 将具有多个`ImageView`，全部位于屏幕的不同位置并具有相关的点击事件（它是一个游戏应用程序）。我发现这`FrameLayout`是一个合适的选择，我可以自己设置边距并将其放置在所需的位置。

现在，我很困惑是要`FrameLayout`为我创建的每一个单独`ImageView`创建，还是保留单个 FrameLayout 并在其中添加所有 ImageView，但将每个 imageview 设置**在不同的位置**。

在任何一种情况下，我如何以编程方式在其中添加 FrameLayout 和 ImageView，并设置其边距，使其可以放置在屏幕上的任何位置。

请注意，将携带所有这些 ImageViews 的主画布具有背景，并且画布是`LinearLayout`通过 XML 设置的，因此我`onCreate()`已经拥有`setContentView(R.layout.game_canvas);`，并且我将使用它`addContentView()`来添加其他视图，但是此方法也接受`LayoutParams`对象作为它的第二个参数，那么当我使用这种方法添加我的 FrameLayouts 时，我应该为此设置什么？

我的问题本身可能令人困惑，所以如果我需要详细说明，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-21T15:11:03.413

FrameLayouts 被设计为只容纳一个视图，因此这并不是真正的合适选择。

使用 RelativeLayout 来保存所有的 ImageView。您可以通过在其 LayoutParams 中设置边距来定位每个 ImageView。

例如，以下代码会将 ImageView 放置在坐标 50,50 处：

```
RelativeLayout imgLayout = new RelativeLayout(this);

ImageView iv = new ImageView(this);
iv.setImageResource(R.drawable.an_image);

RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);

lp.setMargins(50, 50, 0, 0);
lp.addRule(RelativeLayout.ALIGN_PARENT_LEFT);
lp.addRule(RelativeLayout.ALIGN_PARENT_TOP);

imgLayout.addView(iv, lp); 
```

然后，您可以使用它的 addView() 方法将此 RelativeLayout 添加到您的主 LinearLayout。

# c - 检查无符号是否小于零

> ID：11140935
> 
> 赞同：6
> 
> 时间：2012-06-21T14:58:14.983
> 
> 标签：c

使用一些来源发现代码如下：

```
void foo(unsigned int i)
{
 if(i<0)
     printf("Less then zero\n");
 else
     printf("greater or equ\n");
}

int main()
{
    int bar = -2;
    foo(bar);
    return 0;
} 
```

我认为没有任何意义，但可能存在某些情况（安全性？）使此检查有意义？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-21T15:00:10.870

根据定义，无符号整数不能小于 0。因此，为了更直接地回答您的问题，您认为这没有任何意义是正确的。它也不是一个有意义的安全项目，除非您遇到类似循环的情况，该循环意外地将有符号 int 递减到 0 以上，然后将其转换为无符号 int 以用作数组的索引，从而索引数组外的内存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:03:38.870

`i`将始终是`>=0`，因为它被声明为`unsigned`并因此被解释为无符号整数。所以你的第一个测试总是错误的。

您的调用`foo(bar)`实际上将 a`int`转换为`unsigned int`. 这可能会让你感到困惑。并且“转换”实际上并没有改变整数的字节/位值，它只是正式输入和解释的问题。

有关有符号/无符号转换的示例，请参见此[答案](https://stackoverflow.com/questions/11123014/what-is-the-deal-with-assigning-an-unsigned-variable-to-a-signed-value/11123205#11123205)。

这是一个简单的示例（确切的输出取决于`unsigned int`系统上的字节数，对我来说是 4 个字节）。

代码：

```
printf("%u\n", (unsigned int) -2); 
```

输出：

```
4294967294 
```

# nsis - NSIS - 有条件地显示组件

> ID：11140941
> 
> 赞同：1
> 
> 时间：2012-06-21T14:58:44.130
> 
> 标签：nsis

我希望安装程序/卸载程序检查是否安装了任何可能的组件，并仅显示相关组件（安装程序应仅显示尚未安装的组件，卸载程序应仅显示已安装的组件）

我正在使用 MUI。

我的 .nsi 的组件部分如下所示：

```
; Section descriptions
!insertmacro MUI_FUNCTION_DESCRIPTION_BEGIN
    !insertmacro MUI_DESCRIPTION_TEXT ${Component1} "Component1 Description"
    !insertmacro MUI_DESCRIPTION_TEXT ${Component2} "Component2 Description."
    !insertmacro MUI_DESCRIPTION_TEXT ${Component3} "Component3 Description."
!insertmacro MUI_FUNCTION_DESCRIPTION_END 
```

我尝试了几种不同的方法：

首先，我尝试使用[这个宏](http://nsis.sourceforge.net/Check_for_a_Registry_Key)来检查注册表是否存在：

```
!insertmacro IfKeyExists HKEY_LOCAL_MACHINE SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall "Component1"
Pop $R0
${If} $R0 == 0 #Not installed yet. Display.
    !insertmacro MUI_DESCRIPTION_TEXT ${Component1} "Component1"
${EndIf} 
```

这没有用。

然后我尝试使用[注册表插件](http://nsis.sourceforge.net/Registry_plug-in#KeyExists_.28check_if_registry_key_exists.29)：

```
${registry::KeyExists} "HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\Component1" $R0
${If} $R0 == 0 #Not installed yet. Display.
    !insertmacro MUI_DESCRIPTION_TEXT ${Component1} "Component1"
${EndIf} 
```

这也不起作用。

所以后来我想也许还有其他一些更基本的问题，我尝试了这个：

```
StrCpy $0 "0"
${If} $0 == "1"
    !insertmacro MUI_DESCRIPTION_TEXT ${Component1} "Component1 Description."
${EndIf} 
```

但即便如此，我仍然在安装过程中将“Component1”视为可能的组件！

我做错了什么，我该如何实现我的目标？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:43:21.580

要在运行时选择一个部分（= 一个组件），您可以使用`SectionGetFlag`/`SectionSetFlag`和一些位操作：

```
SectionGetFlags ${test_section_id} $0
IntOp $0 $0 | ${SF_SELECTED}
SectionSetFlags ${test_section_id} $0 
```

要取消选择它，只需对其选定的位进行切换，使用

```
SectionGetFlags ${test_section_id} $0
IntOp $0 $0 ^ ${SF_SELECTED}
SectionSetFlags ${test_section_id} $0 
```

`Sections.nsh`如果您包含标题并使用`SelectSection`and`UnselectSection`宏，这些会更简单。

如果要隐藏某个部分，只需将其文本设置为“”（空字符串）

```
SectionSetText ${test_section_id} "" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T19:31:21.983

您正在修改错误的文本。MUI_DESCRIPTION_TEXT 是通常在将鼠标悬停在组件上时显示的长描述。但是一个部分的可见性取决于它的*名字*是空的还是非空的。

因此，您必须使用它来隐藏您的 component1：

```
SectionSetText ${Component1} "" 
```

# javascript - jQuery/Javascript - 延迟一个函数的执行，直到另一个函数完成

> ID：11140942
> 
> 赞同：1
> 
> 时间：2012-06-21T14:58:44.567
> 
> 标签：javascript, jquery, ajax, function, delay

我正在尝试将 php 页面加载到元素中，然后将滑块应用于加载的内容。
问题是函数执行后内容需要几秒钟才能加载并且滑块已经开始工作。
我试图以某种方式延迟滑块函数的执行，直到 php 嵌入函数完成。

这是我的代码：

```
$(document).ready(function () {
    ajaxpage("products.php?type=featured&order=salesNumber", "featuredArea");
});

$(document).ready(setTimeout(function () {
    $(".productsArea").easySliderProducts({
        nextText: "Next",
        prevText: "Previous"
    });
    document.getElementById("outputHere").innerHTML = $(".page ul#featuredArea li").length;
    $(".page").easySlider({
        s: $(".page ul#featuredArea li").length,
        auto: true,
        continuous: false,
        nextId: "featNextArrow",
        nextText: "",
        prevId: "featPrevArrow",
        prevText: "",
        pause: 7500
    });
}, 1000)); 
```

为了使用 setTimeout 函数，我将两者分开。
它对我有用，但对其他人来说结果可能会有所不同。
我想知道是否可以等到 ajaxpage 函数完成加载页面然后继续代码？

AjaxPage 代码：[http ://pastebin.com/XWa0jD77 easySlider1.7 代码：](http://pastebin.com/XWa0jD77) [http](http://pastebin.com/CzK8BzfL)
: //pastebin.com/CzK8BzfL

我考虑过从嵌入页面中调用滑块，尽管那行不通。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:05:25.030

由于您已经在使用 jquery，我建议您丢弃 ajaxpage 函数并使用[$jQuery.load();](http://api.jquery.com/load/) 反而。

正如您在 jquery 文档中看到的那样， load() 带有一个回调函数，它完全符合您的需要。

# objective-c - UIStatusBarAnimationFade 持续时间

> ID：11140945
> 
> 赞同：4
> 
> 时间：2012-06-21T14:58:53.520
> 
> 标签：objective-c, ios, cocoa-touch, uistatusbar

我有一个应用程序，其中有一个按钮可以使屏幕变黑。我也想让状态栏变黑，所以我使用以下代码：

```
[[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationFade]; 
```

我可以设置淡入淡出的持续时间吗？如果这不可行，是否有可能获得官方的淡入淡出持续时间（如`UIKeyboardAnimationDurationUserInfoKey`用于获取键盘滑动持续时间）。

* * *

好吧，我没有从任何人那里得到任何回报，但我认为我至少应该分享我的 hack。经过一些实验，我决定淡出是 1 秒，淡入是 0.25 秒。

```
- (IBAction)fadeToBlack:(id)sender
{
    UIView *view = [[[UIView alloc] initWithFrame:self.view.window.frame] autorelease];
    view.backgroundColor = [UIColor blackColor];
    view.alpha = 0.0;
    [self.view.window addSubview:view];

    // NOTE: Fading the black view at the same rate as the status bar. Duration is just a guess.
    [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationFade];
    [UIView animateWithDuration:1.0 animations:^{
        view.alpha = 1.0;
    } completion:^(BOOL finished) {
        [view addGestureRecognizer:self.dismissViewGesture];
    }];
}

- (void)dismissViewWithGesture:(UIGestureRecognizer *)gesture
{
    UIView *view = gesture.view;
    [view removeGestureRecognizer:gesture];

    // NOTE: Fading the black view at the same rate as the status bar. Duration is just a guess.
    [[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationFade];
    [UIView animateWithDuration:0.25 animations:^{
        view.alpha = 0.0;
    } completion:^(BOOL finished) {
        [view removeFromSuperview];
    }];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T23:13:38.480

我有同样的问题，我的值为 0.5 用于隐藏和 0.2 用于显示导航栏和状态栏。至少对于 iOS 6.1/iOS Simulator，这些值更符合现实。

# python - 每个文件中的唯一元素

> ID：11140947
> 
> 赞同：2
> 
> 时间：2012-06-21T14:58:54.153
> 
> 标签：python, perl, bash, shell

我有 4 个文件，想知道与其他文件中的元素相比不重叠的元素（每个文件）。

文件 A

```
Vincy
ruby
rome 
```

文件 B

```
Vincy
rome
Peter 
```

文件 C

```
Vincy
Paul
alex 
```

文件 D

```
Vincy
rocky
Willy 
```

对 perl、python、shell、bash 中的一个衬里的任何建议。预期的输出是：

文件 A: `ruby`, 文件 B: `Peter`, 文件 C: `Paul`,`Alex`文件 D: `rocky`, `Willy`.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-21T15:00:28.523

问题澄清后编辑：所有文件中的唯一元素，以及它出现的文件：

```
cat File_A File_B File_C File_D |sort | uniq -u | while read line ; do file=`grep -l $line File*` ; echo "$file $line" ; done 
```

编辑：

如果文件很大，这样做会更快：

```
#!/usr/bin/perl

use strict;
use autodie;

my $wordHash ;

foreach my $arg(@ARGV){
    open(my $fh, "<", $arg);
    while(<$fh>){
        chomp;
        $wordHash->{$_}->[0] ++;
        push(@{$wordHash->{$_}->[1]}, $arg);
    }
}

for my $word ( keys %$wordHash ){
    if($wordHash->{$word}->[0] eq 1){
        print $wordHash->{$_}->[1]->[0] . ": $word\n"
    }
} 
```

执行为：myscript.pl filea fileb filec ... filezz

*澄清之前的东西：* 使用 shell 命令很容易。所有文件中的非重复元素

```
cat File_A File_B File_C File_D |sort | uniq -u 
```

所有文件中的唯一元素

```
cat File_A File_B File_C File_D |sort | uniq 
```

每个文件的唯一元素（编辑感谢@Dennis Williamson）

```
for line in File* ; do echo "working on $line" ; sort $line | uniq ; done 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-21T15:14:48.807

这是一个快速的 python 脚本，可以对任意数量的文件执行您所要求的操作：

```
from sys import argv
from collections import defaultdict

filenames = argv[1:]
X = defaultdict(list)
for f in filenames:
    with open(f,'r') as FIN:
        for word in FIN:
            X[word.strip()].append(f)

for word in X:
    if len(X[word])==1:
        print "Filename: %s word: %s" % (X[word][0], word) 
```

这给出了：

```
Filename: D word: Willy
Filename: C word: alex
Filename: D word: rocky
Filename: C word: Paul
Filename: B word: Peter
Filename: A word: ruby 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-21T15:16:20.460

热针：

```
import sys
inputs = {}
for inputFileName in sys.args[1:]:
  with open(inputFileName, 'r') as inputFile:
    inputs[inputFileName] = set([ line.strip() for line in inputFile ])
for inputFileName, inputSet in inputs.iteritems():
  print inputFileName
  result = inputSet
  for otherInputFileName, otherInputSet in inputs.iteritems():
    if otherInputFileName != inputFileName:
      result -= otherInputSet
  print result 
```

不过没试过;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-21T15:33:44.540

**Perl 单行、可读版本，带有注释：**

```
perl -nlwe '     
    $a{$_}++;     # count identical lines with hash
    push @a, $_;  # save lines in array
    if (eof) { push @b,[$ARGV,@a]; @a=(); }   # at eof save file name and lines
    }{ # eskimo operator, executes rest of code at end of input files
    for (@b) { 
        print shift @$_;                      # print file name
        for (@$_) { print if $a{$_} == 1 };   # print unique lines
    }
' file{A,B,C,D}.txt 
```

注意：`eof`适用于每个单独的输入文件。

**复制/粘贴版本：**

```
perl -nlwe '$a{$_}++; push @a, $_; if (eof) { push @b,[$ARGV,@a]; @a=(); } }{ for (@b) { print shift @$_; for (@$_) { print if $a{$_} == 1 } }' file{A,B,C,D}.txt 
```

**输出：**

```
filea.txt
ruby
fileb.txt
Peter
filec.txt
Paul
alex
filed.txt
rocky
Willy 
```

备注：这比预期的要棘手，我相信有办法让它更漂亮，但我现在会发布这个，看看我是否可以清理它。

# c# - ZPLII 热敏标签不打印 Fedex 网络服务

> ID：11140949
> 
> 赞同：0
> 
> 时间：2012-06-21T14:59:10.540
> 
> 标签：c#, zebra-printers, fedex, zpl-ii

我有连接到 FedEx 网络服务的 ac# 应用程序，并且想在 Zebra 热敏打印机上打印运输标签。我请求响应为 ZPLII 类型并将该响应保存到 .txt 文件。我已经与 Zebra 和 FedEx 进行了交谈，他们都说这应该可行。我使用通用打印驱动程序连接到斑马打印机，但打印机仍然打印出 txt 文件的实际字符，而不是将其转换为标签。是否有任何我遗漏的字符，FedEx 不会自动排除 - 比如可能是 'start print' ， 'end print' 字符？或者有没有人有任何想法让我从 Web 服务接收到的这个 txt 进行打印？这是 ZPLII 的回应：

```
^XA^CF,0,0,0^PR12^MD30^PW800^POI^CI13^LH0,20
^FO12,139^GB753,2,2^FS
^FO12,405^GB777,2,2^FS
^FO464,8^GB2,129,2^FS
^FO32,10^AdN,0,0^FWN^FH^FDORIGIN ID: ZSMA^FS
^FO224,10^AdN,0,0^FWN^FH^FD(408) 986-4804^FS 
```

我把中间剪掉了，我认为开头和结尾是重要的部分，因为打印机没有将这个文本转换成标签

```
^FO83,768^GB1,26,1^FS
^FO25,794^GB58,1,1^FS
^FO31,774^AdN,0,0^FWN^FH^FD0201^FS
^PQ1
^XZ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-23T16:46:48.153

事实证明我的 ZPL II 代码很好。如果其他人遇到此问题，据我所知 - 从每个人都告诉我的情况来看，您无法连接到客户端打印机以从 ac# 网站或任何 c# Web 应用程序向其发送原始数据。解决方案是使用 java applet、flash 或 silverlight 直接连接到客户端计算机。我使用了与 jQuery 前端和 c# 后端进行通信的[jZebra java 小程序。](http://code.google.com/p/jzebra/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-23T16:35:57.137

我通常只是将原始数据作为 fileCopy (IE Filecopy "c:\Label.txt" \computer\printersharename) 发送到打印机端口

# asp.net - asp.net 在后面的代码中加载网站

> ID：11140952
> 
> 赞同：0
> 
> 时间：2012-06-21T14:59:12.210
> 
> 标签：asp.net

我的 Windows 2003/IIS 6.0 机器上有几个网站

其中一个站点是公开可见的，其他站点是私有的（可以在本地浏览 - 192.168.1 地址）

我想在公共网站的页面上显示私人网站，但不使用 iframe。

当我尝试使用 iframe 时，客户端浏览器会尝试查找该网站 - 这不是公开可见的

有没有办法从后面的代码（C#/VB.NET）加载主页？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:05:50.243

听起来您可能想在公共站点的代码中使用[HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest)从私有站点获取页面内容，然后将其内联到您的响应中。除了您感兴趣的内容（例如标签中的内容）之外，您必须剥离所有内容。

# php - FB.getLoginStatus 不适用于 https

> ID：11140955
> 
> 赞同：2
> 
> 时间：2012-06-21T14:59:16.913
> 
> 标签：php, facebook, facebook-javascript-sdk

我知道这是一个该死的简单问题，但我还没有找到任何解决方案。当我的应用程序被具有安全浏览功能的人打开时，`https://`不会`FB.getLoginStatus`触发。首先我使用`FB._HTTPS`它并且它现在正在工作 FB 已经删除了所有具有`._`. 那么如何制作`FB.getLoginStatus`呢`https://`？我的代码看起来像

```
 <script src="//connect.facebook.net/en_US/all.js"></script>
 <script>
        console.log("layout");
        //FB._https = (window.location.protocol == "https:");
        //FB._https = true;
        console.log("fb https true");
        FB.init({
            appId : '<?php echo $this->appId; ?>',
            channelUrl : '//<?php echo $_SERVER["HTTP_HOST"]; ?>/static/content/channel.php',
            status : true, // check login status
            cookie : true, // enable cookies to allow the server to access the session
            xfbml : true // parse XFBML
        });
   </script>
 function PostAction(custom_action)
 {
     console.log('outside of fbgetlogin');
     FB.getLoginStatus(function(response)
    {
        console.log("in getlogin status");
        if (response.authResponse) {
            fbcallBack(response);
        } else {
            FB.login(fbcallBack, {scope:'publish_stream'});
        }
    });
} 
```

我的 channel.php 文件包含

```
 <?php
 $cache_expire = 60*60*24*365;
 header("Pragma: public");
 header("Cache-Control: max-age=".$cache_expire);
 header('Expires: ' . gmdate('D, d M Y H:i:s', time()+$cache_expire) . ' GMT');
 ?>
   <script src="//connect.facebook.net/en_US/all.js"></script> 
```

我的`PostAction`功能在`onclick`事件中触发。FB.getLoginStatus `is triggered when user is on`http:// `bit not triggered when user is on`https://`

任何人都可以告诉我如何使 getloginstatus 与 https:// 一起工作吗？

**详细更新问题**

让我详细告诉你这个问题。我已经实现了 facebook 的动作动词。我已经实现了三个动词。想要，拥有和推荐。现在我想在用户单击该按钮时检查用户的登录状态。如您所见，我在自定义按钮上的 onclick 事件中调用了 PostAction() 函数。现在在那次活动中，我想检查用户是否已登录。此函数存在于不同的文件中。并且 init 函数存在于可能的布局文件中（为了概括的观点）。现在我该如何处理这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:07:10.500

您将需要使用异步加载并从 in 中调用 getLoginStatus。

```
 <div id="fb-root"></div>
<script>
      window.fbAsyncInit = function() {
        FB.init({
    appId  : '135669679827333',
    status : true, // check login status
    cookie : true, // enable cookies to allow the server to access the session
    xfbml  : true, // parse XFBML
    channelUrl : 'https://anotherfeed.com/emo/channel.html', // channel.html file
    oauth  : true // enable OAuth 2.0
        }); 
  //      
  FB.getLoginStatus(function(response) {
  if (response.status === 'connected') {
    // the user is logged in and has authenticated your
    // app, and response.authResponse supplies
    // the user's ID, a valid access token, a signed
    // request, and the time the access token 
    // and signed request each expire
    var uid = response.authResponse.userID;
    var accessToken = response.authResponse.accessToken;
  } else if (response.status === 'not_authorized') {
    // the user is logged in to Facebook, 
    // but has not authenticated your app
  } else {
    // the user isn't logged in to Facebook.
  }
 });
//          
        });
      };
  // Load the SDK Asynchronously
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script> 
```

# php - 当使用 Ajax、哈希 URL 或直接 URL 或两者时，什么对 SEO 最好？

> ID：11140956
> 
> 赞同：0
> 
> 时间：2012-06-21T14:59:23.043
> 
> 标签：php, ajax, hash, seo, dynamic-url

我正在制作一个完全基于 Ajax 的网站，但我仍然怀疑我的 SEO。

在我的“a”标签href中，我放置了一个指向内容的直接链接，但我没有将用户重定向到它，而是通过Ajax获取内容，然后用“window.location.hash”更改地址栏。

如果我将带有两个链接（哈希链接和直接链接）的站点地图发送给谷歌，那将是重复的内容，是否会损害我的 SEO。

如果您有更好的方法（而不是我的方法），请随时告诉我。

多谢你们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-21T15:02:53.567

谷歌在这里有一个有用的指南：

*   [使 AJAX 应用程序可抓取](https://developers.google.com/webmasters/ajax-crawling/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:02:00.137

对于完整的 ajax 网站，您通常会看到网站的导航反映在 url 哈希中：

`#/about`或`#/faq`等等。在这种情况下，如果您在 url 结构前加上感叹号 (!)，google 将索引这些 ajax 响应的内容。这被称为哈希棒。所以：

`#!/about`实际上会被谷歌索引....您也可以将这些类型的网址放入您的站点地图中（我认为）

# database - 通过 Sitecore API 获取数据库的问题

> ID：11140962
> 
> 赞同：3
> 
> 时间：2012-06-21T14:59:39.543
> 
> 标签：database, api, sitecore

我们注意到 Sitecore API 代码有一点奇怪。代码如下供您参考。该代码试图通过执行来获取数据库`new Database(database)`。但随机它失败了。

这段代码工作了一段时间，`Database db = new Database(database);`但昨天开始随机失败。当我们将代码更改为 时`Database db = Database.GetDatabase(database);`，代码又开始工作了。这两种方法有什么区别以及 Sitecore 推荐的方法是什么？

我已经看到这种情况发生了两次——在生产环境中发生了多次，在我的开发环境中发生了几次。

```
public static void DeleteItem(string id, stringdatabase)
{
    //get the database
    Database db = new Database(database);
    //get the item
    item = db.GetItem(new ID(id));
    if (item != null)
    {
        using(new Sitecore.SecurityModel.SecurityDisabler())|
        {
            //delete the item
            item.Delete();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:11:05.797

您会看到人们获取特定数据库的常见方式是：

```
Sitecore.Data.Database master = Sitecore.Configuration.Factory.GetDatabase("master"); 
```

这相当于`Sitecore.Data.Database.GetDatabase("master")`。

当您调用其中任何一个方法时，它将首先检查数据库的缓存。如果未找到，它将通过反射在配置文件中使用所有配置值构建数据库。创建数据库后，它将被放置在缓存中以备将来使用。

当您在数据库上使用构造函数时，它只是创建了一个相当空的数据库对象。当您使用这种方法时，我很惊讶听到它完全有效。

获取**特定**数据库的正确方法是使用：

```
Sitecore.Configuration.Factory.GetDatabase("master");
// or
Sitecore.Data.Database.GetDatabase("master"); 
```

如果您正在寻找与当前请求一起使用的数据库（又名上下文数据库），您可以使用`Sitecore.Context.Database`. 您也可以使用`Sitecore.Context.ContentDatabase`.

# actionscript-3 - 关于调试 Flash 应用时 Chrome 的烦人行为

> ID：11140964
> 
> 赞同：1
> 
> 时间：2012-06-21T14:59:42.023
> 
> 标签：actionscript-3, debugging, google-chrome, popup

也许这是一种话题，但是..它让我很生气。

当我调试我正在开发的 Flash 应用程序时，每隔 10-15 秒，当应用程序处于断点时，会出现一个弹出窗口，说如果我想停止插件，因为它似乎没有响应。

有什么办法可以禁用这种行为？或者至少偶尔会这样做？

谢谢。

# c# - 使用 c# 进行 Cassandra 分页

> ID：11140966
> 
> 赞同：1
> 
> 时间：2012-06-21T14:59:48.267
> 
> 标签：c#, pagination, cassandra, fluentcassandra

当我为 MS SQL Server 进行分页以与 jquery 数据表一起使用时，我编写了一个像这样的简单 sp

```
create PROCEDURE [dbo].[Get_SomeData] (
@startRowIndex BIGINT, @maximumRows BIGINT ,@sSearch VARCHAR(MAX),@total INT OUTPUT
) 
AS 

DECLARE @temp TABLE(RowRank BIGINT,custid BIGINT,names VARCHAR(500))

INSERT INTO @temp
   SELECT ROW_NUMBER() OVER (ORDER BY custid) AS 
  RowRank,custid,names FROM dbo.SomeTable WHERE   (names LIKE '%'+@sSearch+'%'   )

   SELECT @total=COUNT(custid) FROM @temp

 SELECT *  FROM @temp  WHERE  RowRank > @startRowIndex 
 AND RowRank <= (@startRowIndex + @maximumRows) 
```

这使得通过增加@startRowIndex 可以轻松地对数据进行分页。但是如何使用 Cassandra 数据库和 ac# 客户端（如 fluentcassandra（或任何 c# 客户端库））实现相同的分页

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-22T00:27:33.453

Cassandra 分页是通过说“使用最后看到的值开始我的下一个结果集”来完成的，这比数字偏移/限制更有效。请参阅[http://blog.dynatrace.com/2011/12/05/pagination-with-cassandra-and-what-we-can-learn-from-it/](http://blog.dynatrace.com/2011/12/05/pagination-with-cassandra-and-what-we-can-learn-from-it/)。

# java - java中的@ManyToMany错误

> ID：11140967
> 
> 赞同：1
> 
> 时间：2012-06-21T14:59:54.320
> 
> 标签：java, hibernate, many-to-many, persistence

我有一个

> org.hibernate.AnnotationException：非法尝试将非集合映射为@OneToMany、@ManyToMany 或@CollectionOfElements：Forms.CarsRentalOrder.OrderUnits

在这段代码上：

```
@Entity
public class CarsRentalOrder implements Serializable {

   @ManyToMany
   private List<Vehicle>  OrderUnits;

   //methods and variables

} 
```

问题是什么？我在某个地方看到列表是一个集合，你可以制作`@ManyToMany`和`@OneToMany`属性。

谢谢！！

# c++ - 通过 \see 命令引用转换运算符

> ID：11140972
> 
> 赞同：1
> 
> 时间：2012-06-21T15:00:11.320
> 
> 标签：c++, doxygen

我在从源中的另一个点引用转换运算符时遇到了麻烦，这是一个最小的例子：

```
#include <string>

/*!
  Dummy struct
 */
struct A
{
    /*!
      Dummy operator.
     */
    void operator()() const {}

    /*!
      Dummy conversion operator.

      \return Nothing, really.
     */
    operator std::string() const { return std::string(); }
};

/*!
  Dummy function.

  \see A::operator()()
  \see A::operator std::string()
 */
void b()
{
    // Here I use A::operator() and A::operator std::string
    // so it would be nice to reference them in the docs.
} 
```

函数中的第一个`\see`命令`b()`有效，结果是`A`HTML 输出中的 ' 运算符的链接，但第二个没有。

如何引用转换运算符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T16:56:40.453

这似乎有效，使用“无用” typedef 以便 doxygen 识别`string`为`A::string`

```
/*!
  Dummy struct
 */
struct A
{
    typedef std::string string;

    /*!
      Dummy conversion operator.

      \return Nothing, really.
     */
    operator string() const { return std::string(); }
};

/*!
  Dummy function.

  \see A::operator string()
 */
void b(); 
```

# iphone - 将对象转换为 plist 文件，然后转换为数据

> ID：11140973
> 
> 赞同：0
> 
> 时间：2012-06-21T15:00:11.617
> 
> 标签：iphone, objective-c, ios, xml

我有一个由多个字符串组成的对象数组，我需要将它们作为 XML 数据推送到 Web 服务。这里涉及哪些步骤？据我所知，我需要将对象转换为 plist 文件，然后将此文件转换为 NSData（？）我在网上找不到任何真正说明它的东西。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-21T15:13:39.590

另一种方法是 JSON。 [SBJSON](https://github.com/stig/json-framework)非常常见且易于使用。

从您的数组中获取 json 字符串是一个两行。然后，您将创建一个代表帖子的 NSURLRequest 和一个执行请求的 NSURLConnection。在[SO](https://stackoverflow.com/questions/5537297/ios-how-to-perform-a-http-post-request)和[其他地方](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)有很多资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-21T15:06:24.980

你可以试试[这个](http://homepage.mac.com/jimbokun/Excelsior.html)或[这个](https://gist.github.com/yfactorial/objectivesupport/tree/master/Classes/lib/Serialization)。我怀疑 plist 文件是你想要的。您只需将对象序列化为 Web 服务所需的 xml 格式。

# php - ADO 和 msqli 连接非常慢

> ID：11140975
> 
> 赞同：2
> 
> 时间：2012-06-21T15:00:16.330
> 
> 标签：php, mysql, apache, mysqli, windows-server-2008

我的生产 Web 服务器的 ADO 和 mysqli 连接速度非常慢。当前的软件设置是 windows 2008 server R2 Standard Edition SP1、Apache 2.4、PHP 5.3.10、MySql 5.5.24、Pear 1.94、Zend Engine 2.30 版。

我已经使用 XDEBUG 分析了代码，它显示每个初始连接大约需要 1200 毫秒（无论访问的页面如何），而在我的本地开发机器和另一台测试服务器上，连接只需要大约 8 毫秒。除了 php、pear、mysql、apache ini 和 conf 文件之外，网站的代码都是通过 SVN 同步的。我已经对这些进行了比较以检查差异，但没有任何差异。数据库内容也是完整的副本。生产服务器的所有内容都托管在同一台机器上，因此不存在任何防火墙或互联网问题。

第一个连接配置文件具有以下调用堆栈：

```
ADOConnecton->Connect
ADODB_mysql->_connect
php::mysql_connect 
```

第二个：

```
php::mysqli->mysqli 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-01T19:47:57.423

通常（第一次）连接的速度取决于 DNS 解析。或许：

*   客户端解析服务器名称
*   服务器解析客户端名称以匹配访问规则

使用主机文件让客户端/服务器知道服务器/客户端地址： [http://en.wikipedia.org/wiki/Hosts_(file)](http://en.wikipedia.org/wiki/Hosts_%28file%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-06T18:21:41.493

我编辑了 Mysql my.ini 以将 mysql 服务更改为仅绑定到 IPV4 环回适配器。

```
[mysqld]
...
bind=127.0.0.1 
```

我还更改了 \public_html\conf\face.ini 以使用 IPV4 环回地址而不是本地主机。（将“本地主机”更改为“127.0.0.1”）

在那之后，所有的问题都消失了。我不确定是因为机器有六个 IP 地址，还是因为它试图决定是使用 IPV6 还是 IPV4。

# c# - 用usb 3G远程访问电脑？

> ID：11140979
> 
> 赞同：0
> 
> 时间：2012-06-21T15:00:23.970
> 
> 标签：c#, sockets, network-programming

我在 c# 上开发了一个应用程序远程桌面。它在带有路由器添加 NAT 端口的 ADSL 上运行良好。但是当我在计算机上运行连接互联网时，使用 USB 调制解调器 3g sim，因为 USB 调制解调器不像 ADLS（路由器）那样使用连接，应用程序无法工作。我如何连接电脑使用 USB 模型？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-21T15:11:27.980

如果您的 3G 电话服务提供商将您置于 NAT 之后，那么您就没有运气了，因为 NAT 会阻止任何传入连接到达您的计算机。

一种解决方法是从连接 3G 的计算机设置 VPN 连接，并在 VPN 服务器端设置端口转发，这样您的计算机可以接收新连接，但它们会被隧道化。

# text - 无论主题如何，Aptana Studio 选择的文本都难以阅读

> ID：11140983
> 
> 赞同：3
> 
> 时间：2012-06-21T15:00:30.500
> 
> 标签：text, aptana, selection, highlighting

关于所选文本，我在 Aptana Studio 中遇到了麻烦。似乎无论我选择什么主题，前景色与背景色相同，使文本接近于不可见。我尝试更改一些颜色设置，关闭事件，并且我注意到当我改变主题一瞬间我会看到文本非常清晰。但是，它发生得太快了，我无法截屏，并且文本立即恢复到几乎看不见。下面是一些问题的图片。

有谁知道如何解决这个问题？提前致谢！

![无论主题如何，文字都是不可见的。](../Images/76adc731f5ed3caeb2da23506a95fcab.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-24T11:03:18.167

Aptana 在更改主题时出现问题。

选择您的主题，然后重新启动 Aptana，它将正常加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-29T06:13:37.153

我在上面的评论中发布的提示有效；自从我做出改变后，这个问题就消失了。你没有说你正在使用 PyDev，但我猜你是因为屏幕截图是 Python。

我在 Aptana 中使用 PyDev。

有一个设置 PyDev -> Editor :Use aptana 主题？

我关闭它，重新启动，问题没有再次出现。在禁用此功能之前，我使用的是 PyDev 主题，并且这些设置继续适用。

# c++ - Random 每次都返回相同的输出

> ID：11140987
> 
> 赞同：2
> 
> 时间：2012-06-21T15:00:40.823
> 
> 标签：c++, random, vector

我写了这段代码，它工作正常，但每次输出都是一样的。所以没有什么随机的。很想知道为什么！假设：33 名学生第一排：7 名学生第二排：9 名学生第三排：9 名学生第四排：8 名学生

```
#include <iostream>
#include <vector>
#include <algorithm>
#include <ctime>
using namespace std;

int main() {
   vector<int> random;

   for (int i = 1; i < 34; i++)
      random.push_back(i);

   random_shuffle(random.begin(), random.end());

   for (int i = 1; i < 8; i++)
      cout << random[i] << " " ;
   cout << endl;

   int i = 7;
   int num_seats = 1;

   for (int j = 1; j <=3; j++) {
      while (num_seats < 10 && i < 33) {
         cout << random[i++] << " " ;
         num_seats++;
      }
      cout << endl;
      num_seats = 1;
   }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-21T15:04:50.573

您需要先初始化随机数生成器。随机数生成取决于“种子值”。要在每次执行程序时都有唯一的种子值，您可以依赖当前时间。`time(NULL)`返回代表当前时间的秒数——它可以是唯一的种子。

尝试在里面的第一行添加这个`main()`

```
srand(unsigned(time(NULL))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-21T15:37:44.070

您使用的`random_shuffle()`重载访问未指定的随机源。它几乎肯定是 using `rand()`，这意味着您需要使用`srand()`它来播种它以获得不同的随机随机播放。

然而，更便携的解决方案是指定随机源，这样您就不必只假设`rand()`使用了。如果您的实现是 C++11，那么最好的选择是使用库`shuffle()`中的引擎`<random>`：

```
#include <random>
#include <algorithm>

#include <vector>
#include <numeric>
#include <iterator>
#include <iostream>

int main() {
    std::vector<int> v(34);
    iota(begin(v), end(v), 1);

    std::random_device r;
    std::seed_seq seed{r(), r(), r(), r(), r(), r(), r(), r()};
    std::mt19937_64 eng(seed);

    shuffle(begin(v), end(v), eng);

    copy(begin(v), end(v), std::ostream_iterator<int>(std::cout, " "));
    std::cout << '\n';
} 
```

如果没有 C++11，您可以使用`random_shuffle()`带有随机数生成器的重载，以便程序可移植地指定随机源：

```
#include <cstdlib>
#include <ctime>
#include <algorithm>

#include <vector>
#include <iterator>
#include <iostream>

struct RNG {
    int operator() (int n) {
        return static_cast<int>(std::rand()/(static_cast<double>(RAND_MAX)+1) * n);
    }
};

int main() {
    std::vector<int> v(34);
    for (int i=0; i < v.size(); ++i)
        v[i] = i + 1;

    std::srand(std::time(NULL));
    random_shuffle(v.begin(), v.end(), RNG());

    copy(v.begin(), v.end(), std::ostream_iterator<int>(std::cout, " "));
    std::cout << '\n';
} 
```

# objective-c - 获取数组中出现次数最多的 NSString

> ID：11140989
> 
> 赞同：2
> 
> 时间：2012-06-21T15:00:47.553
> 
> 标签：objective-c, ios, arrays, nsstring

`NSString`给定一个包含多个重复副本的 s 数组：

```
AAA
BBB
AAA
AAA
BBB
BBB
BBB
BBB
CCC 
```

获取最常出现的字符串的最简单方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-21T15:14:13.600

使用[`NSCountedSet`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSCountedSet_Class/Reference/Reference.html)然后找到最大的`countForObject:`.

```
NSCountedSet *bag = [[NSCountedSet alloc] initWithArray:myArray];

NSString *mostOccurring;
NSUInteger highest = 0;
for (NSString *s in bag)
{
    if ([bag countForObject:s] > highest)
    {
        highest = [bag countForObject:s];
        mostOccurring = s;
    }
} 
```

检查结果：

```
NSLog(@"Most frequent string: %@", mostOccurring); 
```

# wcf - WCF 服务代理不生成自定义枚举类型

> ID：11140991
> 
> 赞同：1
> 
> 时间：2012-06-21T15:00:50.337
> 
> 标签：wcf, web-services, enums, datacontractserializer

我正在引用`Enum`在服务命名空间中公开类型的服务。生成代理时，该`Enum`类型不存在。是什么导致这种情况发生，我该如何解决？

**注意：**将其添加为*Web 引用*会生成类型，而作为*服务引用*则不会。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-21T15:12:42.547

如果您不使用`Enum`您的内部[`ServiceContract`](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.aspx)- 它可能不为人所知。您可以尝试使用[`KnownType`](http://msdn.microsoft.com/en-us/library/ms730167.aspx)并标记`Enum`as `public`with[`DataContract`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractattribute.aspx)和每个`Enum`成员 as [`EnumMember`](http://msdn.microsoft.com/en-us/library/aa347875.aspx)。

您还应该尝试将值显式分配给如下`Enum`类型：

```
[DataContract]
public enum EnumType
{
    [EnumMember]
    Value1= 0,
    [EnumMember]
    Value2 = 1
} 
```

代替...

```
[DataContract]
public enum EnumType
{
    [EnumMember]
    Value1,
    [EnumMember]
    Value2
} 
```