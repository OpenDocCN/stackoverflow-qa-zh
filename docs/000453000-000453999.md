# StackOverflow 问答 000453000-000453999

# desktop-application - 自动更新的最佳实践

> ID：453005
> 
> 赞同：12
> 
> 时间：2009-01-17T08:46:39.783
> 
> 标签：desktop-application, auto-update

对于基于桌面的应用程序，执行自动更新的最佳做法是什么？目前，我们下载所有文件，然后复制并注册（如果是 com dll）到它们各自的目录。

我查看了 Google Chrome 更新方法。它似乎首先将压缩文件下载到目录中，然后解压缩所有文件。此外，他们有一个似乎用于进行更新的设置应用程序。此外，他们创建了一个映射到更新版本的目录，如 1.0.154.43，但他们保留旧版本的目录。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-17T11:34:15.280

几个提示：

*   无论您选择如何执行此操作，请**不要创建新的服务或流程来检查更新，然后继续保持打开状态**。你知道，就像 Adob​​e 和 Sun（针对 Java）一样。不管你在做什么，我可以保证它不够重要，以至于每次用户启动计算机时都需要更新它。更新应该与操作系统通用的标准化更新过程集成，或者在应用程序运行时集成。默认情况下，更新不应持续窃取系统资源或减慢启动过程。

*   如果您为每个版本维护单独的目录，则需要添加代码来维护它。磁盘空间并非旨在推动更新。我记得一个 Citrix 应用程序在我的计算机上一次有 5 个不同的版本。 除非用户明确将它们放在那里，否则**用户不应在其文件系统上看到超过两个副本（最多一个备份，确认为正常运行）您的应用程序。**当文件夹位置发生这样的变化时，应用程序的快捷方式可能会过时，所以要小心。

*   如果您在程序启动后进行更新，我建议您**以不突兀的方式通知用户**。如果更新没有导致功能发生重大变化，请在后台下载更新，下次执行应用程序时切换到新版本，并通知用户重大更改（不要使用模态对话框或窃取重点）。不要让用户在启动应用程序之前单击按钮同意安装更新，或强制他们重新启动以使用更新的版本。允许用户配置自动更新，然后在不影响他们的工作效率的情况下进行。Firefox 在这方面相当糟糕，这很可悲，因为它是许多用户不可或缺的应用程序。

*   **不要触摸系统托盘**。这应该保留给有用的（对用户）应用程序。我也建议不要使用气球通知。使用浏览器中常见的信息栏之类的东西。Microsoft 应用程序在使用系统托盘和气球通知来浪费用户时间与不重要的通知方面特别糟糕。如果用户启用了自动更新，他们真的不需要知道一切都按他们预期的那样工作。当有新的或有用的东西时告诉他们，不要强迫他们接受这些知识。将更改日志留在帮助菜单项下，以便他们自己检查错误修复。

*   如果您部署默认配置文件，请小心使用 MSI 系统进行更新。 **您不想覆盖 update 中的任何用户文件**。同样，如果配置文件或用户文件的格式发生变化，您应该提供一种机制来自动备份和升级这些文件。或者开始在应用程序内部构建默认设置，而不是部署它们。

*   **有带宽意识**。大文件需要时间，并且可能需要用户计量带宽。特别是如果您每天更新。

我无法立即回忆起真正的非侵入式更新程序，但我可以回忆起过去浪费了我的时间和资源的很多事情。不要成为制造另一个人的人。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-17T08:52:31.940

Chromium 团队最近的博客文章是一个很好的指南：

[http://blog.chromium.org/2009/01/google-chrome-installation-and-updates.html](http://blog.chromium.org/2009/01/google-chrome-installation-and-updates.html)

基本上，当您使用 MS 的 ClickOnce 时会执行相同的操作，并且到目前为止我使用具有这种更新方法的应用程序没有问题，所以我想这归类为“最佳实践”......但这只是我。

1.  将每个版本存储在其自己的唯一文件夹中。
2.  使用“启动器”启动可用的最新版本并...
3.  应用程序启动后，在后台检查是否有任何新版本。
4.  下载找到的任何新版本并为该版本创建一个新文件夹。

谷歌浏览器有点不同，因为他们使用谷歌更新服务进行更新，但整体体验/周期几乎相同。

您的用户启动一个应用程序，如果有任何新版本可用，它会在后台下载。然后下次应用程序启动时，您的用户会自动（如果可能）静默地获取新版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T09:34:14.040

使用现有框架

在 MacOS X 上：使用 Sparkle 框架，[http ://sparkle.andymatuschak.org](http://sparkle.andymatuschak.org)

在 Linux 上：为您将支持的发行版创建软件包和设置存储库

# .net - 做一个清单 保证物品将按照添加的顺序退回？

> ID：453006
> 
> 赞同：87
> 
> 时间：2009-01-17T08:48:04.583
> 
> 标签：.net, list, collections

是否`List<T>`始终保证项目将按照枚举时添加的顺序返回？

***更新***：感谢所有回答的人，让我放心。我`List<T>`用 .NET Reflector 快速浏览了这个类（可能一开始就应该这样做），实际上底层存储是一个`T`(`T[]`) 数组。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-01-17T09:04:36.890

该列表是基于索引的，新项目将始终添加到列表的末尾。您可以在某个索引处插入项目，以便下一个项目将移动一个位置。

所以**是**的，你可以这样*安全地*使用它......

> List(T) 类是 ArrayList 类的通用等价物。它使用一个数组来实现 IList(T) 泛型接口，该数组的大小根据需要动态增加。
> 
> 可以使用整数索引访问此集合中的元素。此集合中的索引是从零开始的。
> 
> List(T) 不能保证被排序。在执行需要对 List(T) 进行排序的操作（例如 BinarySearch）之前，您必须对 List(T) 进行排序。
> 
> 只要不修改集合，List(T) 可以同时支持多个读取器。通过集合进行枚举本质上不是线程安全的过程。在枚举与一个或多个写访问竞争的极少数情况下，确保线程安全的唯一方法是在整个枚举期间锁定集合。要允许集合被多个线程访问以进行读写，您必须实现自己的同步。

[您可以在MSDN](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)上阅读有关它的更多信息。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-05-15T03:04:29.373

是的，[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)保证**插入顺序和检索顺序**，这在 MSDN 上有记录（下面的重点是我的）。

## 插入

[**`List<T>.Add`方法**](http://msdn.microsoft.com/en-us/library/3wcytfd1.aspx)

> 将对象添加**到[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)**.

项目参数为：

> 要添加**到[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)**.

[**`List<T>.AddRange`方法**](http://msdn.microsoft.com/en-us/library/z883w3dc.aspx)

> 将指定集合的​​元素添加**到[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)**.

集合参数为：

> 其元素应添加**到[`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)**.

## 恢复

[**`List<T>.Enumerator`结构**](http://msdn.microsoft.com/en-us/library/x854yt9s.aspx)

> 最初，枚举数位于集合中的第一个元素之前。在这个位置，`Current`未定义。因此，在读取 的值之前，您必须调用`MoveNext`以将枚举数推进到**集合的第一个元素**`Current`。

`Current`返回相同的对象，直到`MoveNext`被调用。`MoveNext`设置`Current`为**下一个元素**。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-17T08:58:02.443

是的。但这不是规范的一部分。

参考：[列表类](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T08:55:57.877

是的，根据这个[MSDN 论坛线程](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/24618c6e-3efe-4687-8ee3-74f47c18b997/)

# asp.net - 如何使用 innerHTML = 将服务器图像控件添加到 html 容器

> ID：453010
> 
> 赞同：0
> 
> 时间：2009-01-17T08:50:44.593
> 
> 标签：asp.net

我有一个 td，我想使用 innerHTML = "" 注入服务器图像控件 (asp.net)。webcontrol 的 toString 给出了类型。

有没有办法从服务器控件中提取生成的？或者，是否有不同的解决方案...？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T09:01:15.603

```
StringBuilder sb = new StringBuilder();
StringWriter writer = new StringWriter(sb);
img.RenderControl(new HtmlTextWriter(writer));
td.InnerHtml = sb.ToString(); 
```

或更明显

```
td.Controls.Add(img); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T09:02:53.710

您问题的第一部分看起来像是在询问如何在运行时将图像注入表格单元格。

如果表格单元格是 ASP.NET 页面的一部分，您可以执行以下操作：

```
<td id="imageCell" runat="server"/> 
```

在您后面的代码中：

```
Image img = new Image();
img.ImageUrl = "mypic.jpg";
imageCell.Controls.Add(img); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T09:06:12.940

您可以使用[RenderControl](http://msdn.microsoft.com/en-us/library/system.web.ui.control.rendercontrol.aspx)方法获取输出 HTML。

前任：

```
using System;
using System.Web.UI;
using System.Web.UI.WebControls;

class Program
{
    static void Main()
    {
        var img = new Image();

        var hw = new HtmlTextWriter(Console.Out);
        img.RenderControl(hw);

        hw.Dispose();
    }
} 
```

输出：

```
<img src="" style="border-width:0px;" /> 
```

# java - Java中文件中的行数

> ID：453018
> 
> 赞同：225
> 
> 时间：2009-01-17T08:59:06.310
> 
> 标签：java, large-files, line-numbers

我使用巨大的数据文件，有时我只需要知道这些文件的行数，通常我打开它们并逐行读取它们，直到到达文件末尾

我想知道是否有更聪明的方法来做到这一点

* * *

## 回答 #1

> 赞同：249
> 
> 时间：2009-01-17T09:35:17.373

这是迄今为止我发现的最快的版本，比 readLines 快大约 6 倍。在 150MB 的日志文件上，这需要 0.35 秒，而使用 readLines() 时需要 2.40 秒。只是为了好玩，linux 的 wc -l 命令需要 0.15 秒。

```
public static int countLinesOld(String filename) throws IOException {
    InputStream is = new BufferedInputStream(new FileInputStream(filename));
    try {
        byte[] c = new byte[1024];
        int count = 0;
        int readChars = 0;
        boolean empty = true;
        while ((readChars = is.read(c)) != -1) {
            empty = false;
            for (int i = 0; i < readChars; ++i) {
                if (c[i] == '\n') {
                    ++count;
                }
            }
        }
        return (count == 0 && !empty) ? 1 : count;
    } finally {
        is.close();
    }
} 
```

编辑，9 1/2 年后：我几乎没有 Java 经验，但无论如何我都尝试将此代码与`LineNumberReader`下面的解决方案进行基准测试，因为没有人这样做让我感到困扰。似乎特别是对于大文件，我的解决方案更快。尽管在优化器完成体面的工作之前似乎需要运行几次。我对代码进行了一些尝试，并制作了一个始终最快的新版本：

```
public static int countLinesNew(String filename) throws IOException {
    InputStream is = new BufferedInputStream(new FileInputStream(filename));
    try {
        byte[] c = new byte[1024];

        int readChars = is.read(c);
        if (readChars == -1) {
            // bail out if nothing to read
            return 0;
        }

        // make it easy for the optimizer to tune this loop
        int count = 0;
        while (readChars == 1024) {
            for (int i=0; i<1024;) {
                if (c[i++] == '\n') {
                    ++count;
                }
            }
            readChars = is.read(c);
        }

        // count remaining characters
        while (readChars != -1) {
            System.out.println(readChars);
            for (int i=0; i<readChars; ++i) {
                if (c[i] == '\n') {
                    ++count;
                }
            }
            readChars = is.read(c);
        }

        return count == 0 ? 1 : count;
    } finally {
        is.close();
    }
} 
```

1.3GB 文本文件的基准测试结果，y 轴以秒为单位。我已经使用同一个文件执行了 100 次运行，并使用`System.nanoTime()`. 您可以看到它`countLinesOld`有一些异常值，并且`countLinesNew`没有，虽然它只是快一点，但差异在统计上是显着的。`LineNumberReader`显然更慢。

[![基准图](https://i.stack.imgur.com/fjQQB.png)](https://i.stack.imgur.com/fjQQB.png)

* * *

## 回答 #2

> 赞同：202
> 
> 时间：2011-03-17T16:28:17.880

我已经实现了该问题的另一种解决方案，我发现它在计算行数方面更有效：

```
try
(
   FileReader       input = new FileReader("input.txt");
   LineNumberReader count = new LineNumberReader(input);
)
{
   while (count.skip(Long.MAX_VALUE) > 0)
   {
      // Loop just in case the file is > Long.MAX_VALUE or skip() decides to not read the entire file
   }

   result = count.getLineNumber() + 1;                                    // +1 because line index starts at 0
} 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-01-19T06:11:26.863

对于不以换行符结尾的多行文件，接受的答案有一个错误。没有换行符的单行文件将返回 1，但没有换行符的两行文件也将返回 1。这是解决此问题的公认解决方案的实现。endsWithoutNewLine 检查除了最终读取之外的所有内容都是浪费的，但与整体功能相比应该是微不足道的时间明智。

```
public int count(String filename) throws IOException {
    InputStream is = new BufferedInputStream(new FileInputStream(filename));
    try {
        byte[] c = new byte[1024];
        int count = 0;
        int readChars = 0;
        boolean endsWithoutNewLine = false;
        while ((readChars = is.read(c)) != -1) {
            for (int i = 0; i < readChars; ++i) {
                if (c[i] == '\n')
                    ++count;
            }
            endsWithoutNewLine = (c[readChars - 1] != '\n');
        }
        if(endsWithoutNewLine) {
            ++count;
        } 
        return count;
    } finally {
        is.close();
    }
} 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-07-25T19:07:54.210

使用[java-8](/questions/tagged/java-8 "显示标记为“java-8”的问题")，您可以使用流：

```
try (Stream<String> lines = Files.lines(path, Charset.defaultCharset())) {
  long numOfLines = lines.count();
  ...
} 
```

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-10-29T22:41:33.943

如果文件在文件末尾没有换行符，上面的 count() 方法的答案会给我行错误计数 - 它无法计算文件中的最后一行。

这种方法对我来说效果更好：

```
public int countLines(String filename) throws IOException {
    LineNumberReader reader  = new LineNumberReader(new FileReader(filename));
int cnt = 0;
String lineRead = "";
while ((lineRead = reader.readLine()) != null) {}

cnt = reader.getLineNumber(); 
reader.close();
return cnt;
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-11-19T10:57:57.720

我测试了上述计算行数的方法，这是我对在我的系统上测试的不同方法的观察

文件大小：1.6 Gb 方法：

1.  **使用扫描仪**：约 35 秒
2.  **使用 BufferedReader**：大约 5 秒
3.  **使用 Java 8**：大约 5 秒
4.  **使用 LineNumberReader**：大约 5 秒

此外**，Java8**方法似乎很方便：

```
Files.lines(Paths.get(filePath), Charset.defaultCharset()).count()
[Return type : long] 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2012-09-21T20:27:57.727

我知道这是一个老问题，但接受的解决方案与我需要它做的并不完全匹配。因此，我对其进行了改进以接受各种换行符（而不仅仅是换行符）并使用指定的字符编码（而不是 ISO-8859- *n*）。多合一方法（酌情重构）：

```
public static long getLinesCount(String fileName, String encodingName) throws IOException {
    long linesCount = 0;
    File file = new File(fileName);
    FileInputStream fileIn = new FileInputStream(file);
    try {
        Charset encoding = Charset.forName(encodingName);
        Reader fileReader = new InputStreamReader(fileIn, encoding);
        int bufferSize = 4096;
        Reader reader = new BufferedReader(fileReader, bufferSize);
        char[] buffer = new char[bufferSize];
        int prevChar = -1;
        int readCount = reader.read(buffer);
        while (readCount != -1) {
            for (int i = 0; i < readCount; i++) {
                int nextChar = buffer[i];
                switch (nextChar) {
                    case '\r': {
                        // The current line is terminated by a carriage return or by a carriage return immediately followed by a line feed.
                        linesCount++;
                        break;
                    }
                    case '\n': {
                        if (prevChar == '\r') {
                            // The current line is terminated by a carriage return immediately followed by a line feed.
                            // The line has already been counted.
                        } else {
                            // The current line is terminated by a line feed.
                            linesCount++;
                        }
                        break;
                    }
                }
                prevChar = nextChar;
            }
            readCount = reader.read(buffer);
        }
        if (prevCh != -1) {
            switch (prevCh) {
                case '\r':
                case '\n': {
                    // The last line is terminated by a line terminator.
                    // The last line has already been counted.
                    break;
                }
                default: {
                    // The last line is terminated by end-of-file.
                    linesCount++;
                }
            }
        }
    } finally {
        fileIn.close();
    }
    return linesCount;
} 
```

这个解决方案的速度与公认的解决方案相当，在我的测试中慢了大约 4%（尽管 Java 中的计时测试是出了名的不可靠）。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2015-02-20T22:13:37.730

```
/**
 * Count file rows.
 *
 * @param file file
 * @return file row count
 * @throws IOException
 */
public static long getLineCount(File file) throws IOException {

    try (Stream<String> lines = Files.lines(file.toPath())) {
        return lines.count();
    }
} 
```

在 JDK8_u31 上测试。但与这种方法相比，性能确实很慢：

```
/**
 * Count file rows.
 *
 * @param file file
 * @return file row count
 * @throws IOException
 */
public static long getLineCount(File file) throws IOException {

    try (BufferedInputStream is = new BufferedInputStream(new FileInputStream(file), 1024)) {

        byte[] c = new byte[1024];
        boolean empty = true,
                lastEmpty = false;
        long count = 0;
        int read;
        while ((read = is.read(c)) != -1) {
            for (int i = 0; i < read; i++) {
                if (c[i] == '\n') {
                    count++;
                    lastEmpty = true;
                } else if (lastEmpty) {
                    lastEmpty = false;
                }
            }
            empty = false;
        }

        if (!empty) {
            if (count == 0) {
                count = 1;
            } else if (!lastEmpty) {
                count++;
            }
        }

        return count;
    }
} 
```

经过测试，速度非常快。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2014-09-14T03:49:15.387

使用扫描仪的直接方法

```
static void lineCounter (String path) throws IOException {

        int lineCount = 0, commentsCount = 0;

        Scanner input = new Scanner(new File(path));
        while (input.hasNextLine()) {
            String data = input.nextLine();

            if (data.startsWith("//")) commentsCount++;

            lineCount++;
        }

        System.out.println("Line Count: " + lineCount + "\t Comments Count: " + commentsCount);
    } 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-02-16T14:55:26.627

我得出的结论是`wc -l`:s 计算换行符的方法很好，但在最后一行不以换行符结尾的文件上返回非直观的结果。

@er.vikas 解决方案基于 LineNumberReader 但在行数上加一会在最后一行以换行符结尾的文件上返回非直观的结果。

因此，我制作了一个处理如下的算法：

```
@Test
public void empty() throws IOException {
    assertEquals(0, count(""));
}

@Test
public void singleNewline() throws IOException {
    assertEquals(1, count("\n"));
}

@Test
public void dataWithoutNewline() throws IOException {
    assertEquals(1, count("one"));
}

@Test
public void oneCompleteLine() throws IOException {
    assertEquals(1, count("one\n"));
}

@Test
public void twoCompleteLines() throws IOException {
    assertEquals(2, count("one\ntwo\n"));
}

@Test
public void twoLinesWithoutNewlineAtEnd() throws IOException {
    assertEquals(2, count("one\ntwo"));
}

@Test
public void aFewLines() throws IOException {
    assertEquals(5, count("one\ntwo\nthree\nfour\nfive\n"));
} 
```

它看起来像这样：

```
static long countLines(InputStream is) throws IOException {
    try(LineNumberReader lnr = new LineNumberReader(new InputStreamReader(is))) {
        char[] buf = new char[8192];
        int n, previousN = -1;
        //Read will return at least one byte, no need to buffer more
        while((n = lnr.read(buf)) != -1) {
            previousN = n;
        }
        int ln = lnr.getLineNumber();
        if (previousN == -1) {
            //No data read at all, i.e file was empty
            return 0;
        } else {
            char lastChar = buf[previousN - 1];
            if (lastChar == '\n' || lastChar == '\r') {
                //Ending with newline, deduct one
                return ln;
            }
        }
        //normal case, return line number + 1
        return ln + 1;
    }
} 
```

如果你想要直观的结果，你可以使用它。如果您只想要`wc -l`兼容性，只需使用@er.vikas 解决方案，但不要在结果中添加一个并重试跳过：

```
try(LineNumberReader lnr = new LineNumberReader(new FileReader(new File("File1")))) {
    while(lnr.skip(Long.MAX_VALUE) > 0){};
    return lnr.getLineNumber();
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-03-29T13:16:36.837

在 Java 代码中使用 Process 类怎么样？然后读取命令的输出。

```
Process p = Runtime.getRuntime().exec("wc -l " + yourfilename);
p.waitFor();

BufferedReader b = new BufferedReader(new InputStreamReader(p.getInputStream()));
String line = "";
int lineCount = 0;
while ((line = b.readLine()) != null) {
    System.out.println(line);
    lineCount = Integer.parseInt(line);
} 
```

不过需要尝试一下。将发布结果。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-08-30T16:13:49.143

这个有趣的解决方案实际上非常有效！

```
public static int countLines(File input) throws IOException {
    try (InputStream is = new FileInputStream(input)) {
        int count = 1;
        for (int aChar = 0; aChar != -1;aChar = is.read())
            count += aChar == '\n' ? 1 : 0;
        return count;
    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-07-30T12:55:41.130

似乎您可以使用 LineNumberReader 采取几种不同的方法。

我这样做了：

```
int lines = 0;

FileReader input = new FileReader(fileLocation);
LineNumberReader count = new LineNumberReader(input);

String line = count.readLine();

if(count.ready())
{
    while(line != null) {
        lines = count.getLineNumber();
        line = count.readLine();
    }

    lines+=1;
}

count.close();

System.out.println(lines); 
```

更简单的是，您可以使用 Java BufferedReader lines() 方法返回元素流，然后使用 Stream count() 方法对所有元素进行计数。然后只需在输出中添加 1 即可获取文本文件中的行数。

例如：

```
FileReader input = new FileReader(fileLocation);
LineNumberReader count = new LineNumberReader(input);

int lines = (int)count.lines().count() + 1;

count.close();

System.out.println(lines); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-17T09:03:02.633

在基于 Unix 的系统上，使用`wc`命令行上的命令。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-17T09:09:01.250

知道文件中有多少行的唯一方法是计算它们。您当然可以从您的数据中创建一个指标，为您提供一行的平均长度，然后获取文件大小并将其除以 avg。长度，但这并不准确。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-17T09:36:41.303

如果您没有任何索引结构，您将无法阅读完整的文件。但是您可以通过避免逐行读取并使用正则表达式来匹配所有行终止符来优化它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-10T08:20:16.800

EOF 处没有换行符（'\n'）的多行文件的最佳优化代码。

```
/**
 * 
 * @param filename
 * @return
 * @throws IOException
 */
public static int countLines(String filename) throws IOException {
    int count = 0;
    boolean empty = true;
    FileInputStream fis = null;
    InputStream is = null;
    try {
        fis = new FileInputStream(filename);
        is = new BufferedInputStream(fis);
        byte[] c = new byte[1024];
        int readChars = 0;
        boolean isLine = false;
        while ((readChars = is.read(c)) != -1) {
            empty = false;
            for (int i = 0; i < readChars; ++i) {
                if ( c[i] == '\n' ) {
                    isLine = false;
                    ++count;
                }else if(!isLine && c[i] != '\n' && c[i] != '\r'){   //Case to handle line count where no New Line character present at EOF
                    isLine = true;
                }
            }
        }
        if(isLine){
            ++count;
        }
    }catch(IOException e){
        e.printStackTrace();
    }finally {
        if(is != null){
            is.close();    
        }
        if(fis != null){
            fis.close();    
        }
    }
    LOG.info("count: "+count);
    return (count == 0 && !empty) ? 1 : count;
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-02-26T17:55:47.370

带有正则表达式的扫描仪：

```
public int getLineCount() {
    Scanner fileScanner = null;
    int lineCount = 0;
    Pattern lineEndPattern = Pattern.compile("(?m)$");  
    try {
        fileScanner = new Scanner(new File(filename)).useDelimiter(lineEndPattern);
        while (fileScanner.hasNext()) {
            fileScanner.next();
            ++lineCount;
        }   
    }catch(FileNotFoundException e) {
        e.printStackTrace();
        return lineCount;
    }
    fileScanner.close();
    return lineCount;
} 
```

还没打卡

* * *

## 回答 #19

> 赞同：-2
> 
> 时间：2010-12-13T03:23:15.990

如果你用这个

```
public int countLines(String filename) throws IOException {
    LineNumberReader reader  = new LineNumberReader(new FileReader(filename));
    int cnt = 0;
    String lineRead = "";
    while ((lineRead = reader.readLine()) != null) {}

    cnt = reader.getLineNumber(); 
    reader.close();
    return cnt;
} 
```

你不能跑到大 num 行，比如 100K 行，因为从 reader.getLineNumber 返回是 int。您需要长类型的数据来处理最大行数..

# java - 静态字段是否为垃圾收集打开？

> ID：453023
> 
> 赞同：98
> 
> 时间：2009-01-17T09:02:49.810
> 
> 标签：java, static, garbage-collection, static-members

给定一个仅在程序设置中使用的假设实用程序类：

```
class MyUtils {
   private static MyObject myObject = new MyObject();
   /*package*/static boolean doStuff(Params... params) {
       // do stuff with myObject and params...
   }
} 
```

myObject 在不再使用时会被垃圾收集，还是会在程序的生命周期内一直存在？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-01-17T09:44:14.597

加载类时不能选择静态变量进行垃圾回收。当相应的类加载器（负责加载此类）本身被收集为垃圾时，可以收集它们。

查看[JLS 第 12.7 节卸载类和接口](https://docs.oracle.com/javase/specs/jls/se8/html/jls-12.html#jls-12.7)

> 当且仅当垃圾收集器可以回收其定义的类加载器时，才可以卸载类或接口 [...] 引导加载器加载的类和接口可能不会被卸载。

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-01-17T09:33:21.763

静态变量由 ClassLoaders 引用的 Class 对象引用 - 所以除非 ClassLoader 以某种方式删除 Class（如果这甚至可能的话）或 ClassLoader 本身有资格收集（更有可能 - 考虑卸载 webapps）静态变量（或相反，它们引用的对象）不会被收集。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-07-11T12:49:09.493

myObject 是一个**引用**，而不是一个**对象**。当一个对象没有引用指向它时，它会自动被垃圾回收，因为它是不可访问的。

因此，如果您取消引用静态引用“myObject”后面的对象，则它也可以被垃圾收集

```
myObject = null; 
```

并且没有其他对该对象的引用。

但是，静态引用和变量会在程序的整个生命周期内保留。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-01-17T18:49:44.370

如果您希望将临时对象用于静态初始化然后处理，您可以使用静态初始化块，例如

```
class MyUtils {
   static
   {
      MyObject myObject = new MyObject();
      doStuff(myObject, params);
   }

   static boolean doStuff(MyObject myObject, Params... params) {
       // do stuff with myObject and params...
   }
} 
```

由于静态初始化块是一种特殊的静态方法，myObject 是一个局部变量，可以在块执行完成后进行垃圾回收。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-01-17T09:12:24.503

我认为[这](https://stackoverflow.com/questions/405364/whats-up-with-static-memory-in-java)回答了您的问题 - 除非该类来自特殊的类加载器并且卸载该类，否则基本上不会。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-02T22:31:53.033

这里的关键是类实例的垃圾收集，即对象。ClassLoader 实例本质上是一个对象。因此，如果 Classloader 对象没有被垃圾回收，那么它们存储在堆中的任何引用（即静态的东西）几乎永远不会被垃圾回收。字符串池是个例外。

所以在你突然决定做之前 `private static MyGiantClass myGiantObject = new MyGiantClass()` 三思而后行，因为我已经学会了艰难的方式。

# javascript - Javascript 中的 __LINE__ 等价物

> ID：453028
> 
> 赞同：17
> 
> 时间：2009-01-17T09:04:48.420
> 
> 标签：javascript

有没有办法在 Javascript 中获取源代码行号，比如`__LINE__`C 或 PHP？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T09:10:19.000

有一种方法，虽然成本更高：抛出一个异常，立即捕获它，然后从它的堆栈跟踪中挖掘出第一个条目。请参阅[此处](http://eriwen.com/javascript/js-stack-trace/)有关如何解析跟踪的示例。同样的技巧也可以在纯 Java 中使用（如果代码是在打开调试信息的情况下编译的）。

**编辑**：显然不是所有的浏览器都支持这个。好消息是（感谢克里斯托夫的评论！）一些浏览器[直接通过错误对象的`fileName`和`lineNumber`属性](http://books.google.hu/books?id=8oxJo5NITJUC&pg=PA204&lpg=PA204&dq=javascript+lineNumber+property&source=bl&ots=qkNTkbNKZR&sig=0Rs0BRj8wj-yTvdLUE9UJybd4TA&hl=en&sa=X&oi=book_result&resnum=1&ct=result)导出源文件名和行号。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T09:15:04.030

简短的回答是**否定**的。

长答案是，根据您的浏览器，您可能能够抛出并捕获异常并提取堆栈跟踪。

我怀疑您正在使用它进行调试（无论如何，我希望如此！）所以您最好的选择是使用[**Firebug**](http://getfirebug.com/)。这会给你一个[`console`](http://getfirebug.com/console.html)对象；您可以随时调用`console.trace()`以查看您的程序正在做什么，而不会中断执行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-28T10:42:44.630

C 中的A由[预处理器](http://en.wikipedia.org/wiki/Preprocessor)`__LINE__`扩展，该预处理器将其替换为当前输入的行号。所以，当你看到

```
printf("Line Number: %d\r\n", __LINE__); 
```

编译器看到：

```
printf("Line Number: %d\r\n", 324); 
```

实际上，数字（在这种情况下为 324）是硬编码到程序中的。正是这种*两次通过*机制使这成为可能。

我不知道 PHP 是如何实现这一点的（它也被预处理了吗？）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-28T11:01:03.000

您可以尝试`cpp`在您的 javascript 文件上运行 C 预处理器（来自 GNU Compiler Collection）——无论是动态地使用每个请求还是静态地，通过在每次更改 javascript 文件时应用此操作。我认为 javascript 语法足够相似，可以正常工作。

然后，您将拥有 C 预处理器的所有功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-24T20:31:04.547

你可以在原版 JS 中使用它：

```
function getLine(offset) {
    var stack = new Error().stack.split('\n'),
        line = stack[(offset || 1) + 1].split(':');
    return parseInt(line[line.length - 2], 10);
}

Object.defineProperty(window, '__LINE__', {
    get: function () {
        return getLine(2);
    }
}); 
```

您现在可以访问全局变量`__LINE__`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-28T10:27:17.297

有一种解决方法。

通常 __ LINE __ 结合 __ FILE __ 用于标记代码中的位置，并且标记是为了稍后找到该位置。

但是，可以通过使用全局唯一标识符 (GUID-s) 代替 __ LINE __ 和 __ FILE __ 来实现相同的效果。该解决方案的详细信息位于 BSD 许可工具集的[COMMENTS.txt](https://github.com/martinvahi/mmmv_devel_tools/blob/master/src/mmmv_devel_tools/GUID_trace/COMMENTS.txt)中，该工具集可自动执行该过程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-13T16:21:59.500

我认为预处理更有意义，因为它不会增加运行时开销。C 预处理器的替代方法是使用 perl，如下面的 2 步过程所示：

1 – 将“Line # 999 \n”添加到脚本中要编号的每一行，例如，

```
 alert ( "Line # 999 \n"+request.responseText);

2 – run the perl below:

cat my_js.js | perl -ane "{ s/Line # \d+ /Line # $. /; print $_;}" > C_my_js.js; mv  C_my_js.js  my_js.js 
```

# c# - 如何为我的 C# 应用程序创建产品密钥？

> ID：453030
> 
> 赞同：94
> 
> 时间：2009-01-17T09:06:23.360
> 
> 标签：c#, .net, license-key

如何为我的 C# 应用程序创建产品密钥？

我需要创建一个每年更新的产品（或许可证）密钥。此外，我需要为试用版创建一个。

> 有关的：
> 
> *   [如何最好地混淆我的 C# 产品许可证验证码？](https://stackoverflow.com/questions/501988)
> *   [您如何保护您的软件免受非法分发？](https://stackoverflow.com/questions/109997)

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2009-01-17T09:54:06.667

您可以执行一些操作，例如创建一条记录，其中包含您要向应用程序验证的数据。这可能包括您想要的任何内容 - 例如启用的程序功能、到期日期、用户名（如果您想将其绑定到用户）。然后使用具有固定密钥的某种加密算法对其进行加密或对其进行哈希处理。然后你只需在你的程序中验证它。分发许可证文件（在 Windows 上）的一种方法是将其作为更新注册表的文件提供（无需用户键入）。

不过要小心错误的安全感——迟早有人会简单地修补您的程序以跳过该检查，然后分发修补版本。或者，他们将制定出一个通过所有检查的密钥并分发它，或者回溯时钟等。无论您的计划多么复杂，您为此所做的任何事情最终都将通过默默无闻来确保安全，他们将永远能够做到这一点。即使他们不能，也有人会分发被黑的版本。即使您提供加密狗也同样适用 - 如果有人愿意，他们也可以为此修补检查。对您的代码进行数字签名将无济于事，他们可以删除该签名或将其辞职。

您可以通过使用技术来防止程序在调试器等中运行，从而使事情复杂化，但这也不是防弹的。因此，您应该让它变得足够困难，以至于诚实的用户不会忘记付款。还要非常小心，不要让您的计划对付费用户造成干扰——最好有一些盗版的副本，而不是让您的付费客户无法使用他们所支付的费用。

另一种选择是进行在线检查 - 只需为用户提供一个唯一 ID，并在线检查该 ID 应具有哪些功能，并将其缓存一段时间。但是，所有相同的警告都适用-人们可以绕过这样的任何事情。

还要考虑必须与忘记密钥的用户打交道的支持成本等。

*编辑：我只是想补充一点，不要在这方面投入太多时间，或者认为你的复杂方案会有所不同且无法破解。只要人们控制您的程序运行的硬件和操作系统，它就不会，也不可能。开发人员一直试图为此提出更复杂的方案，认为如果他们为此开发自己的系统，那么只有他们自己知道，因此“更安全”。但这实际上是一种相当于尝试构建永动机的编程。:-)*

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-17T10:21:37.127

你信任谁？

我一直认为这个领域太重要了，不能信任第三方来管理应用程序的运行时安全性。一旦该组件针对一个应用程序被破解，它就会针对所有应用程序被破解。几年前，当[Discreet使用](https://en.wikipedia.org/wiki/Autodesk_Media_and_Entertainment)[3ds Max](https://en.wikipedia.org/wiki/Autodesk_3ds_Max)的第三方许可解决方案时，他们在五分钟内发生了这种情况……好时光！

说真的，考虑自己滚动以完全控制您的算法。如果这样做，请考虑在密钥中使用以下组件：

*   许可证名称 - 您授权的客户名称（如果有）。对管理公司部署很有用 - 让他们在您提供的许可证信息中使用“个性化”名称感到特别。
*   执照到期日期
*   在同一许可下运行的用户数。这假设您有一种以服务器方式跟踪站点上正在运行的实例的方法
*   功能代码 - 让您可以跨多个功能和多个产品使用相同的许可系统。当然，如果它为一种产品破解，它对所有产品都破解。

然后对它们进行校验和，并添加您想要的任何（可逆）加密，以使其更难破解。

要制作试用许可证密钥，只需将上述值设置为“试用模式”即可。

并且由于这现在可​​能是您的应用程序/公司中最重要的代码，因此除了混淆之外/而不是考虑将解密例程放在本机 DLL 文件中并简单地对其进行[P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services)。

我工作过的几家公司为此采用了通用方法并取得了巨大成功。或者也许这些产品不值得破解；）

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-18T04:50:40.880

如果您询问可以输入的密钥，例如 Windows 产品密钥，那么它们是基于一些检查的。如果您谈论的是必须复制粘贴的密钥，那么它们是基于数字签名（私钥加密）的。

一个简单的产品密钥逻辑可以首先说产品密钥由四个 5 位组组成，例如`abcde-fghij-kljmo-pqrst`，然后继续指定内部关系，例如 f+k+p 应该等于 a，这意味着 2 的第一个数字, 3 和 4 组应该总计为一个。这意味着 8xxxx-2xxxx-4xxxx-2xxxx 有效，8xxxx-1xxxx-0xxxx-7xxxx 也是有效的。当然，还有其他关系，包括复杂的关系，比如如果第一组的第二个数字是奇数，那么最后一个数字的最后一个数字也应该是奇数。这样就会有产品密钥的生成器，并且产品密钥的验证将简单地检查它是否符合所有规则。

加密通常是有关使用私钥（== 数字签名）加密并转换为[Base64](http://en.wikipedia.org/wiki/Base64)的许可证的信息字符串。公钥与应用程序一起分发。当 Base64 字符串到达​​时，它由公钥验证（==解密），如果发现有效，则激活产品。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-17T14:59:40.810

无论它是微不足道的还是难以破解的，我都不确定它是否真的有很大的不同。

您的应用程序被破解的可能性与其实用性成正比，而不是产品密钥处理的强度。

就个人而言，我认为有两类用户。付钱的人。那些没有。即使是最微不足道的保护，那些这样做的人也可能会这样做。那些不这样做的人会等待裂缝或寻找其他地方。无论哪种方式，它都不会让您获得更多的钱。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-18T06:26:12.840

我不得不承认我会做一些相当疯狂的事情。

1.  查找 CPU 瓶颈并将其提取到[P/Invokeable](http://en.wikipedia.org/wiki/Platform_Invocation_Services) DLL 文件中。
2.  作为构建后操作，使用 XOR 加密密钥加密 DLL 文件的一部分。
3.  选择公钥/私钥方案，在 DLL 文件中包含公钥
4.  安排使解密产品密钥和将两半异或在一起产生 DLL 的加密密钥。
5.  在 DLL 的 DllMain 代码中，禁用保护 (PAGE_EXECUTE_READWRITE) 并使用密钥对其进行解密。
6.  创建一个 LicenseCheck() 方法，对许可证密钥和参数进行完整性检查，然后对整个 DLL 文件进行校验和，从而引发许可证违规。哦，在这里做一些其他的初始化。

当他们找到并删除 LicenseCheck 后，当 DLL 开始出现[分段错误](http://en.wikipedia.org/wiki/Segmentation_fault)时，将会有什么乐趣。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-18T04:53:58.330

还可以选择[Microsoft 软件许可和保护](http://www.microsoft.com/slps/)(SLP) 服务。在阅读了它之后，我真的希望我可以使用它。

我真的很喜欢根据许可证阻止部分代码的想法。热门的东西，对于 .NET 来说是最安全的。即使你不使用它也很有趣！

> Microsoft® 软件许可和保护 (SLP) 服务是一项软件激活服务，使独立软件供应商 (ISV) 能够为其客户采用灵活的许可条款。Microsoft SLP 服务采用独特的保护方法，有助于保护您的应用程序和许可信息，使您能够更快地进入市场，同时提高客户合规性。

注意：这是我发布带有敏感代码（例如有价值的算法）的产品的唯一方法。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-12-12T11:32:25.713

如果您想要一个简单的解决方案来创建和验证序列号，请尝试 [Ellipter](http://ellipter.com)。它使用椭圆曲线密码学并具有“到期日期”功能，因此您可以创建试用版或有时间限制的注册密钥。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-03-19T20:32:04.443

另一个用于产品密钥和激活的物美价廉的工具是名为 InstallKey 的产品。看看[www.lomacons.com](http://www.lomacons.com)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-06-04T16:32:59.620

一种简单的方法是使用[全局唯一标识符](http://en.wikipedia.org/wiki/Globally_unique_identifier)(GUID)。GUID 通常存储为 128 位值，通常显示为 32 位十六进制数字，组之间用连字符分隔，例如`{21EC2020-3AEA-4069-A2DD-08002B30309D}`.

在 C# 中使用以下代码 by `System.Guid.NewGuid()`。

```
getKey = System.Guid.NewGuid().ToString().Substring(0, 8).ToUpper(); //Will generate a random 8 digit hexadecimal string.

_key = Convert.ToString(Regex.Replace(getKey, ".{4}", "$0/")); // And use this to separate every four digits with a "/". 
```

我希望它有所帮助。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-17T09:24:22.077

诀窍是要有一个只有你知道的算法（这样它就可以在另一端被解码）。

有一些简单的事情，例如“选择一个质数并添加一个幻数”

更复杂的选项，例如对一组二进制数据（可能包括唯一标识符、版本号等）使用非对称加密，并将加密数据作为密钥分发。

也可能值得阅读对[这个问题](https://stackoverflow.com/questions/404806/pin-generation#404904)的回答

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-17T09:25:51.933

有一些可用的工具和 API。但是，我认为您不会免费找到一个；）

例如 OLicense 套件： [http ://www.olicense.de/index.php?lang=en](http://www.olicense.de/index.php?lang=en)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-07-26T19:22:31.753

请检查这个答案：[https ://stackoverflow.com/a/38598174/1275924](https://stackoverflow.com/a/38598174/1275924)

这个想法是使用[Cryptolens](https://cryptolens.io/)作为许可证服务器。这是一个[分步示例](https://help.cryptolens.io/examples/key-verification)（在 C# 和 VB.NET 中）。我还在下面（在 C# 中）附加了一个用于密钥验证的代码片段：

```
var licenseKey = "GEBNC-WZZJD-VJIHG-GCMVD";
var RSAPubKey = "{enter the RSA Public key here}";

var auth = "{access token with permission to access the activate method}";
var result = Key.Activate(token: auth, parameters: new ActivateModel()
{
    Key = licenseKey,
    ProductId = 3349,
    Sign = true,
    MachineCode = Helpers.GetMachineCode()
});

if (result == null || result.Result == ResultType.Error ||
    !result.LicenseKey.HasValidSignature(RSAPubKey).IsValid())
{
    // an error occurred or the key is invalid or it cannot be activated
    // (eg. the limit of activated devices was achieved)
    Console.WriteLine("The license does not work.");
}
else
{
    // everything went fine if we are here!
    Console.WriteLine("The license is valid!");
}

Console.ReadLine(); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-03-11T15:20:53.183

您可以检查[LicenseSpot](http://www.licensespot.com)。它提供：

*   免费许可组件
*   在线激活
*   用于集成您的应用程序和在线商店的 API
*   序列号生成
*   吊销许可证
*   订阅管理

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-05-13T22:12:37.393

我将借鉴@frankodwyer 的出色回答，并更深入地研究基于在线的许可。我是[Keygen](https://keygen.sh)的创始人，这是一个为开发人员构建的许可 REST API。

由于您提到您的应用程序需要两种“类型”的许可证，即“完整版”和“试用版”，我们可以简化它并使用*功能许可证模型*，您可以在其中许可应用程序的特定功能（在这种情况下，有一个“完整”功能集和一个“试用”功能集）。

首先，我们可以创建 2*种许可证类型*（在 Keygen 中称为**策略**），每当用户注册帐户时，您都可以为他们生成“试用”许可证（“试用”许可证*实施*我们的“试用”功能策略） ，您可以使用它在应用程序中进行各种检查，例如用户可以使用*Trial-Feature-A*和*Trial-Feature-B*。

在此基础上，每当用户*购买您的应用程序*（无论您使用的是 PayPal、Stripe 等），您都可以生成一个实施“完整”功能策略的许可证，并将其与用户的*帐户*相关联。现在在您的应用程序中，您可以检查用户是否拥有可以执行*Pro-Feature-X*和*Pro-Feature-Y*的“完整”许可证（通过执行类似的操作`user.HasLicenseFor(FEATURE_POLICY_ID)`）。

我提到允许您的用户创建*用户帐户*——我的意思是什么？我在[其他几个答案](https://stackoverflow.com/questions/599837/how-to-generate-and-validate-a-software-license-key/43957550#43957550)中对此进行了详细介绍，但简要说明了为什么我认为这是一种验证和识别用户的优越方法：

1.  用户帐户可让您将*多个许可证*和*多台计算机*关联到一个*用户*，让您深入了解客户的行为*并提示他们进行“应用内购买”，*即购买您的“完整”版本（有点像移动应用程序）。
2.  我们不应该要求我们的客户输入长的许可证密钥，这既输入乏味*又难以跟踪，*即它们很容易丢失。（尝试在 Twitter 上搜索“丢失的许可证密钥”！）
3.  客户*习惯使用电子邮件/密码*；我认为我们应该做人们习惯做的事情，这样我们才能提供良好的用户体验（UX）。

当然，如果您*不想*处理用户帐户并且*希望*您的用户输入许可证密钥，那完全可以（并且 Keygen[也支持这样做](https://keygen.sh/docs/api/#licenses-actions-validate-key)）。我只是提供另一种处理许可方面的方法，并希望为您的客户提供良好的用户体验。

最后，由于您还提到您希望每年更新这些许可证，您可以在策略上设置一个*持续时间*，以便“完整”许可证将在一年后到期，而“试用”许可证持续 2 周，要求您的用户购买新的许可证到期后。

I could dig in more, getting into associating machines with users and things like that, but I thought I'd try to keep this answer short and focus on simply licensing features to your users.

# asp.net - Page.LoadComplete 的用途是什么（在实践中）

> ID：453032
> 
> 赞同：7
> 
> 时间：2009-01-17T09:08:40.580
> 
> 标签：asp.net

在 ASP.NET [Page LifeCycle](http://msdn.microsoft.com/en-us/library/ms178472.aspx "MSDN 链接")中有 Page.LoadComplete 事件。

MSDN 文档说“将此事件用于需要加载页面上所有其他控件的任务”。这到底是什么？“最佳实践”会说 LoadComplete 应该用于什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T11:50:37.803

当您将几种方法连接到 Load 事件时，您不知道它们将被调用的顺序。因此，您可以使用 PreLoad、Load 和 LoadComplete 事件来更好地控制代码被调用的顺序。

仅使用您的页面类时，它的使用可能并不总是很清楚。但是，在使用控件时，由于需要在加载时运行一些代码，您可能希望使其在加载事件中通常发生的事情之前或之后立即运行。然后您可以使用 PreLoad 和 LoadComplete 方法。

正如 simon 提到的，Init 事件遵循相同的模式......

有关 ASP.NET 页面生命周期的更多信息，请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

**编辑：**从 MSDN 文章看来，在您的控制事件（如 Button.Click 已引发之后）调用 LoadComplete 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T09:15:30.143

假设您有多个控件在加载事件中准备一些数据。如果您想在 ASP.NET 生命周期的加载步骤中对该数据采取行动，您需要有一种方法可以在所有其他加载运行后执行。因此“加载完成”。还有一个“初始化完成”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-20T00:59:15.817

这是我尝试使用 Page_Load 的[一个示例](https://stackoverflow.com/questions/418596/how-do-i-increment-a-step-value-to-be-processed-when-the-page-loads-in-asp-net)，有人正确指出 LoadComplete 会更好。

# asp.net-mvc - ASP.NET MVC 中的 UI 组合

> ID：453036
> 
> 赞同：5
> 
> 时间：2009-01-17T09:13:08.217
> 
> 标签：asp.net-mvc, composition

您将如何在 ASP.NET MVC 视图中支持外部可组合部件？

我这是什么意思？想想“每个页面上的登录框”或“iGoogle”。这是需要在每个控制器/视图外部的某些地方的东西。

一种方法是在视图中添加组件，如下所示：

```
<% foreach (var component in GetComponents()) {%>
    <%= Html.RenderPartial(component.ViewName, component.ViewData)%>
<%} %> 
```

在上面的示例中，我正在寻找一种让每个组件的控制器而不是显示它们的视图的控制器传递视图名称和视图数据的好方法。您可以建议的任何完全不同的解决方案也会很有趣。过滤器、WebForms 等

**更新：**我将尝试用一个例子来解释我想要理解的内容。我将选择登录功能。

在典型的 webforms 应用程序中，这可能是一个用户控件，它在页面生命周期的加载事件中检索*适当的数据并更新一些 UI 控件。*单击页面后，页面将回发，我们可以对同一用户控件中单击事件中*发布的信息采取行动。*

根据我目前对 ASP.NET MVC 样式的理解，**首先接受请求**的控制器将检索*适当的数据*并将其传递给视图，该视图又将其传递给登录部分视图。登录视图将定义一个表单，其发布操作针对登录控制器的登录操作。发布的*信息*由登录操作使用，我们可以选择使用一些漂亮的方案将请求传递给原始控制器。

我假设有一种比上面更聪明的方法，不需要我将控制器逻辑放在视图/母版页中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-18T09:17:26.070

有两种方法可以做到这一点：

一：制作一个BaseController，它总是获取这些组件所需的数据，设置ViewData[“loginbox”] = loginBoxData，然后你可以像这样传递它。

```
<% foreach (var component in GetComponents()) {%>
        <%= Html.RenderPartial(component.ViewName, ViewData[component.Name])%>
<%} %> 
```

这种方法的问题在于，您需要有逻辑来说明何时获取组件所需的所有这些数据，以及何时不获取。

二：

有一个 MVC Futures DLL，您可以从[这里](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18459)下载。

如果您引用它，并记住将其命名空间添加到您的 web.config，那么您应该能够说：`Html.RenderAction("blah")`- 此方法通过联系控制器、启动视图并返回 HTML 来完成整个行程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T08:41:12.693

您可以使用[母版页并使用内容占位符](http://www.asp.net/learn/mvc/tutorial-12-cs.aspx)来查看内容页面和查看用户控件。

ASP.NET MVC Framework Beta 中的默认项目模板具有用于查看内容页面的内容占位符。页面右上角还有一个用于登录/注销链接的查看用户控件。

## 查看内容页面

视图内容页面应该与来自您正在查看的视图的数据一起使用。即，如果您正在浏览 中的`Index`操作`HomeController`，服务器将呈现`Home/Index.aspx`视图内容页面。

在母版页中，您需要以下行：

```
<asp:ContentPlaceHolder ID="Holder1" runat="server" /> 
```

在查看内容页面本身中，您为该占位符撰写以下内容：

```
<asp:Content ID="Content1" ContentPlaceHolderID="Holder1" runat="server">
  <p>This text goes to "Holder1" content place holder and
     I can access the ViewData.</p>
  <p><%= ViewData["Message"] %>
</asp:Content> 
```

每个都通过 id`asp:ContentPlaceHolder`对应于视图。`asp:Content`所以如果你想要**几个**这样的占位符：

```
<asp:ContentPlaceHolder ID="Holder1" runat="server" />
<asp:ContentPlaceHolder ID="Holder2" runat="server" /> 
```

…您可以像这样在视图内容页面中处理它们：

```
<asp:Content ID="Content1" ContentPlaceHolderID="Holder1" runat="server">
  <p>This text goes to "Holder1" content place holder</p>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="Holder2" runat="server">
  <p>This text goes to "Holder2" content place holder</p>
</asp:Content> 
```

## 查看用户控件

无论您正在查看什么视图，都可以使用视图用户控件。以下是查看用户控件的一些示例，取自[Wekeroad 关于查看用户控件的博客文章](http://blog.wekeroad.com/2008/01/07/aspnet-mvc-using-usercontrols-usefully/)。要使用视图用户控件：

```
<%=Html.RenderUserControl(“~/UserControls/UserList.ascx”)%> 
```

如果您有需要，您还可以将数据和匿名类型传递给它。

```
<%=Html.RenderUserControl(“~/UserControls/UserList.ascx”,ViewData.Users, new {GroupID=2})%> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T10:43:54.507

在没有正确理解问题的情况下，我建议采用母版方法。IE。让母版页呈现从母版页派生的组件和页面。

我担心这不是一个好的答案。我不明白这一点：“..每个组件的控制器而不是它们所显示的视图的控制器提供的视图名称和视图数据。”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-04T01:54:09.157

这是一个老问题，但这是我对它的看法：

在 CQRS 风格的应用程序中，您可以将 ICommand 推送到单个服务端点，服务会计算出如何路由它。

一个很好的例子：[https ://github.com/ncqrs/ncqrs/blob/master/Framework/src/Ncqrs/Commanding/ServiceModel/CommandService.cs](https://github.com/ncqrs/ncqrs/blob/master/Framework/src/Ncqrs/Commanding/ServiceModel/CommandService.cs)

怎么说 - 我们试图执行查询而不是尝试执行命令？

而不是 1 我们传递 1 或更多作为 IViewModelExecutor 的列表？

在您的主页中，您有一个主 ViewModel，它对每个子 ViewModel 都有一个定义，当页面加载时，我们要求服务获取与该视图相关的所有视图模型：

```
service.Load(new List<IViewModelExecutor>{UserinfoViewModel, UserAccountViewModel }); 
```

该服务从 readmodel 加载数据并在需要的地方缓存。子视图模型使用传递给子视图`Html.RenderPartial("subviewname", Model.SubViewModel)`

子视图知道如何根据模型渲染自己。

现在 - 因为我们有一个带有 ajax 更新的组合 UI - 假设我们想要更新页面的 UserAccount 部分。在控制器中，我们有一个动作负责渲染该部分。

它也可以从`service.Load(new List<IViewModelExecutor>{UserAccountViewModel })`

并且只取回它需要的视图模型的一部分——可能是缓存的。除非参数改变 obv。

现在我们有了一个可以全部或部分构建的组合 UI。

使用内容协商，我们可以根据请求中的 HTTP 标头提供 HTML 片段、JSON 或 XML。

# asp.net-mvc - 将 MVC Beta Web 应用程序移动到虚拟目录会剥离所有 /Content 资源

> ID：453043
> 
> 赞同：1
> 
> 时间：2009-01-17T09:16:36.413
> 
> 标签：asp.net-mvc, iis-6, routing

我在 win2008 服务器上使用 VS2008 开发了一个非常不错的 MVC Beta 应用程序。当我试图将它部署到 IIS6 虚拟目录时，我的麻烦就开始了。在目标 win2003 服务器上安装 MVC Beta 后，我能够从虚拟目录中显示应用程序，但所有图像和 css 属性都丢失了。占位符建议图像应该位于根网站，而不是应用程序运行的虚拟目录。

实际路径：

```
http://localhost/Content/images/<myimage>.png 
```

而不是：

```
http://localhost/<virtualdirectory>/Content/images/<myimage>.png 
```

如果我将应用程序安装在它自己的网站（根）中，一切正常。我可以通过将 Web 属性设置为“使用 Visual Studio 开发服务器”/特定端口/并添加虚拟路径来在 VS2008 中复制它。

我还可以通过将项目的 Web 属性设置为“使用本地 IIS Web 服务器”并创建一个虚拟目录来复制它。

关于 mvc url 路由，我显然缺少一些东西。这里的任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T09:33:57.253

你是如何参考这些图像的？他们应该以“~/”开头来表示“应用程序根”（“/”是“站点根”） - 即“/Content/images/myimage.png”。

但是，有些控件会在不替换虚拟路径的情况下将其发送给客户端；对于相关线程（谈论js，但概念相同），请参见[此处](https://stackoverflow.com/questions/347528/using-scripts-in-a-master-page-with-asp-net-mvc)（包括一个简单的解决方案/示例方法）。

另外-虚拟是应用程序吗？齿轮图标...

考虑`<base href...>`母版页中的标签（到应用程序根目录）

# c++ - 服务崩溃加载 dll

> ID：453045
> 
> 赞同：0
> 
> 时间：2009-01-17T09:18:15.100
> 
> 标签：c++, windows, service

我制作了一个新的 Windows 服务，它使用准系统代码（只是服务的基本框架）可以正常工作，但是，当我将它链接到我的 dll、lib 文件以使用 dll 中的功能时，它在启动时崩溃并出现 0xc0000034错误。

是否有一个特殊的地方可以为服务或特殊的方式放置 dll？

.

编辑：我在与 exe 相同的文件夹中拥有它需要的所有 dll，但我会尝试将它们移动到 system32 文件夹。我认为这可能是由我的内存泄漏检测器（vld）和服务引起的冲突，将不得不做更多的调试和反复试验。

.

编辑2：

找出是什么原因造成的。它缺少 dbghelp.dll（使用依赖walker 来解决）。感谢您的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T09:43:08.590

0xc0000034 代表 STATUS_OBJECT_NAME_NOT_FOUND，表示文件丢失。您是否将 dll 放置在正确的路径中？

编辑：我认为，因为它是 win 服务，所以它加载的 dll 的路径应该是绝对路径，或者它应该在 PATH 环境变量中（COM 服务器就是这样工作的）

只需将 dll 复制到 System32 目录并检查它是否解决了问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T09:52:11.803

您的 DLL 是否依赖于任何其他 DLL？那些其他 DLL 是否在正确的位置？

# .net - CCNET 构建报告上的异常行号混乱

> ID：453046
> 
> 赞同：0
> 
> 时间：2009-01-17T09:18:56.330
> 
> 标签：.net, exception, continuous-integration, reporting, line-numbers

我们有一个集成服务器 (CruiseControl.NET) 构建和验证几个 .NET 3.5 库。当某些集成代码失败时，会记录异常并显示在自定义报告中。

然而，异常消息报告的行号是混乱的——通常在抛出异常的位置下方 50 / 100 行以内。

知道什么可能导致这种情况吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T16:16:15.227

您的构建过程是否在源代码中插入任何标头？如果是这样，那么您可能会看到工作站上的行号与构建服务器上的行号之间存在偏移。

或者，您可能已将构建过程更改为不再创建 PDB 文件，从而为新构建提供旧行号。

不幸的是，由于 CCNet 配置是根据您的情况量身定制的，如果没有更多信息就很难诊断。我建议将构建机器磁盘上的源代码与工作站上的源代码进行比较，并查看报告的行号对于服务器的文件副本是否准确。

您也可以尝试强制执行干净的源代码检出并删除任何延迟的构建输出。

# asp.net - 为禁用 ViewState 的 ASP.NET DropDownList 控件模拟“SelectedIndexChanged”的最佳方法

> ID：453048
> 
> 赞同：2
> 
> 时间：2009-01-17T09:22:25.777
> 
> 标签：asp.net, viewstate, selectedindexchanged

我发现了很多帖子，人们试图解决`SelectedIndexChanged`什么时候不工作的问题`EnableViewState='false'`。

我有点困惑为什么控制状态不启动并允许它工作，但如果有人也能解释这一点，那就是加分。

一些“黑客”非常“黑客”。就像在页面本身的视图状态上设置一个与下拉值相对应的值，然后将该值与回发期间收到的值进行比较。

我正在寻找最好的最优雅的解决方案（如果有一个好的解决方案）。

我不知道这是否是一个聪明的派生控件或更聪明的东西，但我想确保该解决方案足够通用以“值得信赖”，而不仅仅是一个仅适用于相关特定页面的黑客（这对于这样的黑客！）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T19:31:13.910

如果您真的想知道为什么以及如何工作，我建议您阅读以下文章：

[真正理解 ViewState](http://weblogs.asp.net/infinitiesloop/archive/2006/08/03/truly-understanding-viewstate.aspx)

这不是一本容易阅读的书，但确实涵盖了人们在使用视图状态时经常遇到的所有问题。它涵盖了为什么在 Page_Init 而不是 Page_Load 中填充时一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-08T05:53:04.807

在将列表添加到控件集合之前绑定列表（而不是在上面评论者所说的之后）。

- 上述文章的作者 :)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-17T12:57:22.723

尝试在较早的时候将数据加载到 DropDownList 中。IE。在初始化完成中。我还没有测试过，但我认为这应该可以解决问题。

**编辑：**

它没有成功。我已经测试过了，它的效果并不令人满意。正如 Ken Browning 在关于这个问题的另一个答案中指出的那样，如果 SelectedIndex 不是其初始值，则始终会触发 SelectedIndexChanged 事件。

为什么 SelectedIndex 不存储在 ControlState 中而不是 ViewState 中。我们可以欺骗 ViewState 只跟踪 SelectedIndex，而不存储 Items 集合吗？

# visual-studio - 如何通过 ClickOnce 部署 Visual Studio 加载项？

> ID：453049
> 
> 赞同：3
> 
> 时间：2009-01-17T09:23:31.610
> 
> 标签：visual-studio, clickonce, add-in, extensibility

是否可以使用 ClickOnce 部署 VS 加载项？我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-25T09:49:18.977

查看[保护和部署加载项](http://msdn.microsoft.com/en-us/library/cc175947.aspx)。[以及使用 ClickOnce 保护加载项](http://msdn.microsoft.com/en-us/library/cc175918.aspx)的子主题。

我没有亲自使用过它们，但我在搜索与您类似的问题时发现了它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-02-15T22:16:33.557

@Rob：您提供的链接是用于应用程序的插件（又名 MS Office），而不是用于 Visual Studio 的插件（据我所知）。Visual Studio 中的加载项对象模型不支持 ClickOnce - 很遗憾。

要为 Visual Studio 部署加载项，请访问[http://msdn.microsoft.com/en-us/library/dd393694.aspx](http://msdn.microsoft.com/en-us/library/dd393694.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T09:31:56.227

我很确定你不能这样做。ClickOnce 专为无副作用部署而设计，不会影响注册表（可能文件关联除外）或“程序文件”（拥有自己的存储库）。

我很确定你需要msi。

# eclipse - 改变backward-word和backward-kill-word的行为

> ID：453057
> 
> 赞同：5
> 
> 时间：2009-01-17T09:28:18.420
> 
> 标签：eclipse, emacs, elisp

我对“backward-word”和“backward-kill-word”命令的工作方式有一个小问题。当我在只有空格的行（例如，缩进行的第一个字符）上点击“backward-kill-word”时，该命令将杀死所有空格以及最后一个单词上一行。

这种行为对我来说完全不直观。我更喜欢它在 Eclipse 中的工作方式，例如，它会在第一次按下“backward-kill-word”时将空白字符杀死到行首，将移动到上一行的末尾在下一次命中时，才会开始从行尾开始杀死单词。

我很确定这种行为是大多数应用程序中的默认行为（因为它似乎更直观，这可能是因为我习惯了，但我不确定），所以我想知道是否有一种将 Emacs 配置为也具有此行为的方法。不幸的是，谷歌上的一些搜索结果一无所获。

谢谢

**编辑：**

感谢所有人的回答（包括我所要求的 elisp 代码）。

显然，使用 forward-kill-word 和移动命令也会出现同样的问题，我希望 emacs 中只有一些可配置的标志来改变行为，但看起来我只是要使用这些 elisp 函数并为这些重新绑定默认的移动和杀死命令。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T12:54:10.967

这个怎么样：

```
(defun my-backward-kill-word ()
  "Kill words backward my way."
  (interactive)
  (if (bolp)
      (backward-delete-char 1)
    (if (string-match "^\\s-+$" (buffer-substring (point-at-bol) (point)))
        (kill-region (point-at-bol) (point))
      (backward-kill-word 1)))) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T10:12:25.193

在这种情况下，您可能想尝试 M-\ (delete-horizo​​ntal-space)，它会在第一次按键时执行您想要的操作。如果你真的需要一个将两者结合起来的函数，那么编写一个检查光标之前的当前行中是否有任何非空格字符并基于此调用一个或另一个的函数应该不会太难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T10:21:21.540

这是一个很大的问题。您将不得不研究 emacs lisp 编程并学习一些有关它的东西。我建议从这里开始：[响尾蛇 emacs 教程](http://www.rattlesnake.com/intro/index.html)，然后按照自己的方式进行操作。

仅供参考，查看我的 TAGS 文件告诉我，backward-word 是在 simple.el 中定义的，具有以下形式：

(defun 后向词 (&optional arg)

“向后移动直到遇到单词的开头。有论据，多次这样做。”

（交互式“p”）

（前向词（-（或 arg 1））））

所以下一步是在这个调用中添加一个 if 。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T14:21:55.987

这应该这样做：

```
(defun eclipse-kill-word (repeat)
  "Redefine `backward-kill-word' to work as Eclipse does.

Now stops at the beginning of the line, deleting only whitespace."
  (interactive "p")
  (let (cnt)
    (dotimes (cnt repeat)
      (if (= (point) (save-excursion (beginning-of-line) (point)))
          (kill-region (point) (save-excursion (backward-word) (point)))
        (kill-region (point)
                     (max (save-excursion (beginning-of-line) (point))
                          (save-excursion (backward-word) (point)))))))) 
```

具有使用前缀键 (Ctrl-U) 可重复的额外好处。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T20:10:02.443

请注意，在[cc-mode](http://cc-mode.sourceforge.net/)中，有一个饥饿删除选项，您可以像这样启用它：

`(add-hook 'c-mode-common-hook (lambda () (c-toggle-auto-hungry-state 1)))`

显然这只适用于 C,C++,Java,... 文件，并适用于退格键（不删除单词）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-28T21:54:50.883

您可以重用 viper 的一些功能以获得所需的行为：

```
(setq viper-mode nil)
(require 'viper)

(defun viper-delete-word (arg)
  "Delete word."
  (interactive "p")
  (save-excursion
    (push-mark nil t)
    (viper-forward-word arg)
    (delete-region (point) (mark t))
    (pop-mark)))

(defun viper-delete-backward-word (arg)
  "Delete previous word."
  (interactive "p")
  (save-excursion
    (push-mark nil t)
    (viper-backward-word arg)
    (delete-region (point) (mark t))
    (pop-mark)))

(global-set-key [C-left] 'viper-backward-word)
(global-set-key [C-right] 'viper-forward-word)
(global-set-key [C-delete] 'viper-delete-word)
(global-set-key [C-backspace] 'viper-delete-backward-word) 
```

# oop - 有人可以举一个脆弱的基类问题的更好例子吗？

> ID：453059
> 
> 赞同：9
> 
> 时间：2009-01-17T09:31:50.347
> 
> 标签：oop, inheritance

脆弱的基类是在每次讨论通过实现继承的可重用性的讨论中弹出的最常见的点之一。

除了常见的正方形，矩形示例之外，有没有人遇到过任何真正的问题。

每次我需要向某人解释这一点时，我都会遇到一些现实世界的案例，这些案例引发了这些问题以及如何解决。

如果有人想分享他们在这方面的经验，那将非常有帮助。

这是了解此问题的维基百科链接

[维基百科上的脆弱基类](http://en.wikipedia.org/wiki/Fragile_base_class)

## 编辑：

我对此的投入......问题主要发生在基类版本发生变化时，因为使用它的开发人员可能不知道基类实现发生的扩展，并且基类实现者可能没有关于所有派生类。而看似无害的更改可能会破坏所有派生类的功能。无论如何，这是一个糟糕的设计实践，因为它会破坏 OCP 原则。

## 在软件旧论坛上从 Joel 那里得到了很好的报价。想把它放下。

“我们有时无法应对现代生活的复杂性，实际上是自然界中发生的脆弱基类问题的一个例子，原因是我们仍然从过着截然不同的生活的祖先那里继承了许多特征。”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T09:40:38.300

是的 - java.util.Properties 是一个痛苦的派生。

暂时让我们抛开它从 java.util.Hashtable 派生的事实开始（这意味着它具有`get(Object)`并且`put(Object, Object)`尽管属性始终是字符串......

我曾经将 java.util.Properties 子类化以提供一种层次结构 - 在我拥有的属性文件中：

```
x.y.z = 10
a.b.c = 10 
```

并且您可以向“x”（使用新方法调用）询问“主”属性，它会为您提供另一个属性对象，该对象将有效地包含“yz = 10”等。将 java.util.Properties 子类化为很方便许多其他代码已经知道使用的属性。如果它实现了一个接口，我就不会子类化，也不会有任何问题:(

无论如何，如有必要，我需要重写 getProperty() 以引用父属性。但是有两个重载 - 我应该覆盖哪个？getProperty(String) 是否调用 getProperty(String,String) 或反之亦然？也许我只需要覆盖 get()？它没有记录，如果我只覆盖其中一个，则实现可能会在以后的版本中更改以切换事物 - 所以我需要覆盖它们。

其他各种方法也是如此（保存和加载很痛苦，IIRC - 这是很久以前的事了）。基本上，如果我可以依靠 Properties 的部分实现不变，我可以更简单地完成这项工作——但这​​显然会使 Sun 在以后改进实现变得更加困难。

无论如何，这是一个明确的示例，其中组合和公开客户端将依赖的接口会*好得多*。

# pyqt - Qt：擦除背景（Windows Aero Glass）

> ID：453069
> 
> 赞同：20
> 
> 时间：2009-01-17T09:36:53.767
> 
> 标签：pyqt, windows-vista, dwm, aero-glass

# 更新

[有关使用 Qt 和DWM](http://msdn.microsoft.com/en-us/library/aa969540(VS.85).aspx)的示例，请参阅[在 Windows 上使用模糊](http://labs.trolltech.com/blogs/2009/09/15/using-blur-behind-on-windows/)。[替代文字 http://labs.trolltech.com/blogs/wp-content/uploads/2009/09/blurbehind2.png](http://labs.trolltech.com/blogs/wp-content/uploads/2009/09/blurbehind2.png)

* * *

## 原始问题：

我想用 Qt 创建一个 Windows Aero Glass 窗口，现在它看起来像这样： ![替代文字](https://img-fotki.yandex.ru/get/3203/goodrone.0/0_1ee1c_ecb3fc6e_L.jpg)

但是在调用了一些之后，`my_window->repaint()`我的窗口标签就坏了： ![替代文字](https://img-fotki.yandex.ru/get/3201/goodrone.0/0_1ee20_16877c58_L.jpg)

但现在**如果我稍微调整窗口大小**，它会正确重绘。

* * *

**问题是**：我如何擦除窗口背景，以便小部件将自己绘制在干净的玻璃上？

* * *

重现问题的简短代码是（Vista with Aero）：

```
class Window(QWidget):
    def __init__(self, *args):
        QWidget.__init__(self, *args)
        self.setLayout(QVBoxLayout())
        self.layout().addWidget(QLabel("This is the text"))

        # let the whole window be a glass
        self.setAttribute(Qt.WA_NoSystemBackground)
        from ctypes import windll, c_int, byref
        windll.dwmapi.DwmExtendFrameIntoClientArea(c_int(self.winId()), byref(c_int(-1)))
    def mousePressEvent(self, event):
        self.repaint() 
```

您现在可以单击窗口，也可以单击`Alt-Tab`几次。

无论如何，使用带有 Aero Glass 的标签不是我需要的，因为 QLabel 不知道如何用一段时间发光（如窗口的标题）来绘制自己。我需要的是一种清洁“玻璃”的通用方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-27T19:40:01.127

只需使用：

```
QPainter p

p.setCompositionMode(QPainter::CompositionMode_DestinationIn);
p.fillRect(boundsRect, QColor(0, 0, 0, 0)); 
```

这将丢弃旧内容并用透明颜色填充。

更多信息在

*   [http://techbase.kde.org/Development/Tutorials/Graphics/Performance#QPixmap::setAlphaChannel.28.29](http://techbase.kde.org/Development/Tutorials/Graphics/Performance#QPixmap::setAlphaChannel.28.29)

*   [http://doc.qt.digia.com/qtjambi-4.4/html/com/trolltech/qt/gui/QPainter.CompositionMode.html](http://doc.qt.digia.com/qtjambi-4.4/html/com/trolltech/qt/gui/QPainter.CompositionMode.html)

编辑：最好使用 CompositionMode_Clear 并用任何颜色绘制矩形。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-16T10:55:43.067

我已经在谷歌上搜索了一段时间，所以我想我会分享解决方案：

将 WA_NoSystemBackground 替换为 WA_TranslucentBackground 并忘记 mousepressevent

现在窗户是透明的航空玻璃，并在需要时自动重新渲染，耶 :)

# sql - 实施有效的“未读评论”计数器系统

> ID：453074
> 
> 赞同：9
> 
> 时间：2009-01-17T09:45:54.577
> 
> 标签：sql, database, database-design, database-schema

我正在尝试为以下问题找到最佳解决方案：需要设计一个数据库（基于postgres），其中包含触发器和计数器系统，它将形成一个有效查询、更新和存储信息的系统'显示在页面上的每篇文章（或博客条目，或类似的东西）中存在多少未读评论'。

每个出现的解决方案都有一些严重的缺点，无论是在查询、存储还是更新部分。即它需要太多的存储空间，或者太多的更新，或者太昂贵的查询。

你的经历呢？也许对于这类问题已经形成了很好的解决方案？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-17T09:57:58.703

我会尽可能简单地保持模式，因此查询将尽可能简单。这通常也具有最低的存储要求。当然，设置索引来支持这个查询。

下一步：测量性能！“衡量就是知道。” 响应时间是多少？服务器的负载是多少？只要性能是可以接受的，保持模式和查询简单。如果不是绝对必要，请不要牺牲可维护性：您的继任者稍后会感谢您。

如果性能确实是个问题，请查看您用于应用程序的框架的缓存功能。不执行查询总是比执行优化查询快。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T10:00:20.880

如果你真的没有在你的资源范围内取得成功，也许你必须调整用户体验。也许存储最后一次访问线程的日期就足够了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T10:50:14.040

我不相信典型的标准化方法会给您带来低效的查询。假设您有一个带有 PK 的表`article_comments`和`(article_id, comment_id)`另一个`comments_seen_by_user`带有 PK的表`(user_id, article_id, comment_id)`。对于页面上列出的每篇文章，您需要做的就是：

```
SELECT count(*) FROM article_comments ac
WHERE article_id = ?                -- Parameter
AND NOT EXISTS (
    SELECT 1 FROM comments_seen_by_user csbu
    WHERE csbu.user_id = ?          -- Parameter
    AND   csbu.article_id = ac.article_id
    AND   csbu.comment_id = ac.comment_id
) 
```

如果您在一页上显示 20 篇文章，您将运行上述查询 20 次，每次运行将使用一个索引从 中提取 10-20 行`article_comments`，而子查询测试只是对 的另一个索引扫描`comments_seen_by_user`，所以全部在您可能需要执行 20 * (20 * 2) = 800 次索引查找来显示给定页面。这对现代数据库来说并不费力。而且我可能忽略了 PostgreSQL 可能找到的更好的查询计划。

你有没有试过这个，发现性能不足？如果是这样，我的第一个猜测是你有一段时间没有`VACUUM`编辑了。否则，我对每页文章数量或每篇文章评论数的估计一定是错误的——在这种情况下，请更新更多详细信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T11:05:38.237

我将第二个 j_random_hacker 的答案，只是我会避免将 article_id 存储在 comments_seen_by_user 表中，因为每条评论的 comment_id 应该是全局唯一的。此外，PostgreSQL 中的 3 维（和 2 维程度较低）索引仍然很慢，因此请尽量避免使用它们。

围绕 user_id、comment_id 值的表没有真正好的方法来存储有关阅读评论的信息，只需确保它具有唯一索引即可。这样的表中几千万行对PostgreSQL来说完全没有问题，只要它可以将索引保留在内存中。您可以通过查询系统表来跟踪索引大小（磁盘上 8KB 页面的数量）：

```
select relname,relpages from pg_class where relname='comments_seen_by_user_pkey'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T12:01:25.613

我同意采用标准化方法，看看是否可行。通常我应该。但是，您也可以在“评论”表上使用一些 INSERT 触发器，它会更新基本（即文章）表中的评论计数器。这取决于该网站的使用情况：如果大多数人阅读评论（与添加评论相比），则基于触发器的方法的开销应该会迅速摊销。如果它是一个具有高评论负载的网站，这可能会影响性能。

当您有一些合理的使用配置文件时，我会选择一个简单的规范化表结构并在以后添加其他优化。

# asp.net-mvc - FormatException：Html.CheckBox()、UpdateModel() 和隐藏的输入

> ID：453076
> 
> 赞同：1
> 
> 时间：2009-01-17T09:48:24.883
> 
> 标签：asp.net-mvc, forms, checkbox, boolean, updatemodel

在我看来，我有一个 bool 字段的复选框，如下所示：

```
=Html.CheckBox("Active", ViewData["Active"] != null ? ViewData["Active"] : (ViewData.Model.Active != null ? ViewData.Model.Active : false)
```

如果你喜欢，你可以忘记绒毛：

```
=Html.CheckBox("Active", ViewData.Model.Active)
```

..导致同样的问题。

当我尝试更新我的模型时：

```
UpdateModel(空缺, Request.Form.AllKeys);
```

..我得到带有两个布尔字段的对象数组返回。好的，所以我了解隐藏字段的需要。但我使用的是 MVC Beta，我相信 UpdateModel 没有正确处理帖子数据。我收到此错误：System.FormatException“字符串未被识别为有效的布尔值。” ..当表格有时会发回时。我的意思是表单工作正常，保存真假状态，除非表单上的另一个字段为空。然后它抱怨“真，假”值。这很好。我知道字符串“true,false”不是一个有效的布尔值，但是它有时会抱怨而其他时候会起作用吗？请帮忙

**编辑：** 拜托，如果 some1 甚至可以建议 UpdateModel() 方法的另一种方法，我会看看。我怀疑这是我想念的简单的东西。

**编辑 2：** 这似乎是 MVC Beta 中的一个已知错误（[http://www.codeplex.com/aspnet/WorkItem/View.aspx?WorkItemId=2671&FocusElement=CommentTextBox](http://www.codeplex.com/aspnet/WorkItem/View.aspx?WorkItemId=2671&FocusElement=CommentTextBox)）。任何人都可以提出解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-11-10T20:09:29.953

**在 ASP.net MVC 1.0 中解决**

（添加了答案，以便我们可以从 中消除问题`Unanswered`）

# c++ - 静态数组的大小

> ID：453099
> 
> 赞同：14
> 
> 时间：2009-01-17T10:25:19.350
> 
> 标签：c++, arrays, size

我声明了一个静态字符数组，然后将它传递给一个函数。怎么拿号。函数内部数组中的字节数？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-17T10:56:32.890

使用具有非类型模板参数的函数模板：

```
template <size_t N>
void func(char (&a)[N]) {
    for (int i = 0; i < N; ++i) {
        cout << "a[" << i << "] = " << a[i] << endl;   // Or whatever you want to do
    }
} 
```

致电：

```
char myArray[500];        // Or "static char myArray[500]", if you want
func(myArray); 
```

这个函数的一个新副本将被实例化为每个不同大小的数组，所以如果你用许多不同大小的数组调用它，你会得到一些代码膨胀。但情况并非如此。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-17T10:29:48.153

您必须将其传递给函数。您可以使用 sizeof() 来获取数组的大小。

```
const char foo[] = "foobar";

void doSomething( char *ptr, int length)
{

}

doSomething(foo, sizeof(foo)); 
```

这个[MSDN 页面](http://msdn.microsoft.com/en-us/library/4s7x1k91(VS.71).aspx)解释了更多关于 sizeof 并有一个更大的例子。

编辑：*[请参阅 j_random_hacker 的答案](https://stackoverflow.com/questions/453099/size-of-static-array#453131)，了解使用模板的有趣技术... *

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-08-09T07:58:49.097

您也可以`std::size()`从 C++17 开始使用

[https://en.cppreference.com/w/cpp/iterator/size](https://en.cppreference.com/w/cpp/iterator/size)

```
#include <iostream>
#include <vector>
#include <iterator>

int main() 
{
    std::vector<int> v = { 3, 1, 4 };
    std::cout << std::size(v) << '\n'; 

    int a[] = { -5, 10, 15 };
    std::cout << std::size(a) << '\n';
} 
```

对于 c++17 之前的复制示例实现；）

```
template <class T, std::size_t N>
constexpr std::size_t size(const T (&array)[N]) noexcept
{
    return N;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T10:32:19.053

你不能。C++ 中的数组是指针，这就是你所拥有的：指向数组开头的指针。如果它恰好是一个字符串，你可以使用 strlen 来测量它的长度。如果是其他已知格式，您可以根据该格式计算长度。

考虑这段代码：

```
static char str[] = "hello world";

foo(str);
bar(str);

void foo(char* str)
{
   // length of str is unknown
}

void bar(char str[])
{
  // length of str is still unknown
} 
```

无论您的函数参数是 char[] 还是 char*，您都不知道大小。

我建议将大小作为单独的参数传递。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T10:58:06.240

不，不要使用数组。请改用向量。现在几乎没有理由使用数组，因为它们不安全。AFAIK，它们是软件问题的主要原因之一，因为很容易意外地超出阵列的末端。

使用向量，您不必再担心缓冲区溢出。你的函数可以很容易地找出向量的大小。

```
#include <vector>
vector<char> myVector;

void DoSomething(vector<char> &v)
{
    int sizeOfVector = v.size();
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-20T13:40:46.243

int array_size = sizeof(Array) / sizeof(Array[0]);

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T10:38:46.483

您还有一个选择是创建一个管理字符串的字符串类。我敢肯定有人已经这样做了。最原始的版本是带有 char * 和缓冲区长度的结构，当它发生变化时，您必须手动管理大小。频谱的另一端是一个完全实现的字符串类，具有运算符重载和操作功能。

然后将此类传递给您的函数，它已经知道大小。将它作为单独的参数传递并没有什么不同；如果它们都是不同的长度，它只是一种更简单的管理字符串的方法。

# html - 使用 HTML/CSS 构建公共信息显示的资源？

> ID：453103
> 
> 赞同：1
> 
> 时间：2009-01-17T10:29:46.330
> 
> 标签：html, css, content-management-system, information-architecture

我想在建筑物的显示器上为访客显示时间表、地图和其他信息。这些显示器最多只能提供鼠标输入，但不提供键盘。

十年前，这是 Macromedia Director 的领域，但今天我相信浏览器和内容管理系统提供了更好的架构。但是，我找不到用于此目的的单一开源系统，甚至没有一些 CSS 样式。对于如何实施交互性低的公共信息系统的想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T20:51:51.393

SVG 将是最好的选择。它可以让您绘制建筑物的地图并交互式地放大/缩小和平移，还可以让您单击感兴趣的项目以显示详细信息。

你的限制是什么？这会在 Kiosk 模式下运行 IE 或 Firefox 的触摸屏外壳中吗？（例如，像建筑物大厅中的可视目录？）

例如，参见圣何塞的[Adob​​e 大楼。](http://www.adobe.com/svg/demos/vbs/html/frameset.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-08T19:17:08.577

只需建立一个清楚地显示信息的网站。您可以将所有移动最佳实践应用到该站点。因为当你将它缩放到大屏幕时，你会遇到同样的易读性问题。

另一个技巧是更改 CSS 溢出属性以防止出现滚动条。

我使用[http://webconverger.com](http://webconverger.com)来使用 Web 应用程序显示标志。

# html - 如何垂直对齐表格列的顶部和底部？

> ID：453105
> 
> 赞同：11
> 
> 时间：2009-01-17T10:30:33.910
> 
> 标签：html, internet-explorer-7, html-table, vertical-alignment, internet-explorer-6

..如果列的高度取决于另一列的高度？解决方案至少应该适用于 IE6,7 和 Mozilla。

HTML表格布局：

```
+------------------------+----------+
 | 顶部对齐的段落 | 这里 |
 | | 是一个|
 | | 非常|
 | | 长 |
 | | 正文 |
 | | 那个|
 | | 最终|
 | | 确定 |
 | | 整体|
 |底部对齐的段落| 桌子高度。|
 +------------------------+----------+

```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-17T10:49:37.070

最简单的方法应该是`vertical-align`在您希望对齐的单元格中使用顶部和底部：

```
<table>
<tr>
<td class="top">
<p>Top aligned paragraph</p>
</td>
<td rowspan="2">
<p>Lorem ipsum dolor sit amet consectetuer id egestas condimentum neque elit. Non tortor tempus orci quis condimentum interdum dictum pede Duis enim. Sociis sollicitudin Nulla lacinia risus id sit odio pellentesque Vestibulum et. Ipsum pretium vestibulum et lobortis mauris semper In In id faucibus. Est Integer Curabitur dui Quisque eu habitasse Curabitur gravida vel semper. A libero vel nisl.</p>
</td>
</tr>
<tr>
<td class="bottom">
<p>Bottom aligned paragraph</p>
</td>
</tr>
</table> 
```

然后是 CSS：

```
.top{
vertical-align:top;
}
.bottom{
vertical-align:bottom;
} 
```

复制|粘贴

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T13:52:46.030

使用 rowspan 属性 ( [http://www.htmlcodetutorial.com/tables/index_famsupp_30.html](http://www.htmlcodetutorial.com/tables/index_famsupp_30.html) ) 使长文本 (column2) 跨越两行。然后将 Para1 放在第一列第一行（对齐顶部），然后将 Para2 放在第一列第二行（对齐底部）。

```
--------------------------------------
|Para 1 Align Top |This is your very |                   
|                 |long text.  This  |
|                 |is your very long |
|_________________|text.             |
|                 |This is your very |
|                 |long text.  This  |
|                 |is your very long |
|Para2 align bottm|Text.             |
-------------------------------------- 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T11:46:56.080

如果您不想使用表格，可以执行以下操作：

```
<style type="text/css" media="screen">
    .outer {
        position: relative;
        background-color: #EEE;
    }
    .right {
        width: 50%;
        margin-left: 50%;
        background-color: #F88;
    }
    .top,
    .bottom {
        position: absolute;
        width: 50%;
    }
    .top {
        top: 0;
        background-color: #8F8;
    }
    .bottom {
        bottom: 0;
        background-color: #88F;
    }
</style>

<div class="outer">
    <div class="right">Here<br>is a<br>very<br>long<br>text<br>that<br>eventually<br>determines<br>the overall<br>table height.</div>
    <div class="top">top-aligned paragraph</div>
    <div class="bottom">bottom-aligned paragraph</div>
</div> 
```

# c++ - 使用预编译器的字符串连接

> ID：453107
> 
> 赞同：0
> 
> 时间：2009-01-17T10:32:40.583
> 
> 标签：c++, c-preprocessor, string-concatenation

我有以下问题。我想包含一个多行文本文件`#define`，即我需要的是一个存储文本文件值的常量。例子：

```
File 'f.txt': This\nis\n\nsome\ntext 
```

我想以如下方式初始化一个常量（在编译时）

```
#define txtfile "This\\nis\\na\\ntextfile" 
```

其中字符串“This\nis\na\ntextfile”是通过连接文件 f.txt 中的行获得的。有没有办法使用预处理器命令/宏来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T10:53:37.343

[将 C 程序中的“#include”文本文件视为 char[]](https://stackoverflow.com/questions/410980/include-a-text-file-in-a-c-program-as-a-char)以了解可能满足您需求的替代方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T10:56:22.517

这不是直接可能的，因为文本文件需要首先处理。您可以编写一个相当简单的脚本来执行适当的转义并添加`#define`创建合适的头文件。

通常，您实际上并不需要将文本文件作为预处理器宏扩展，但是，您需要文件数据出现在目标文件中并且可以像`extern char[]`.

为此，有两种方法。轻量级的方法是使用像 yasm 这样的汇编程序和`incbin`指令来生成一个目标文件，该文件将文件数据作为标记部分。例如：

```
 global f_txt
f_txt:
    incbin "f.txt" 
```

然后在C文件中你可以声明：

```
extern char f_txt[]; 
```

更便携的方法是使用一个实用程序，比如`xxd -i`将数据转换为 C 文件，其中 char 数组写出“长手”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T10:57:28.253

您可能需要做的是有一个单独的预处理程序，它接收您的输入文件 ( `f.txt`) 和您的特殊源文件 ( `program.cppx`) 中的代码部分，例如：

```
#superdefine txtfile f.txt 
```

您必须自己编写预处理器，但它基本上会根据文件内容将这些`#superdefine`行替换为等效的行，生成一个文件，然后您可以将其输入到真正的编译器中。`#define``program.cpp`

如果您使用 make 变体，这在 UNIX 下很容易实现。使用 IDE 可能不是那么容易。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-17T10:53:06.907

有人可能会想出一个类似以下的想法：

f.txt：

```
这个 \
是 \
一些 \
文本 \

```

代码.c：

```
#定义文本文件“\
#include "f.txt"
"

```

但我认为这行不通。包含行将被视为字符串。

# c# - .NET 中的 DAL 和 BLL

> ID：453109
> 
> 赞同：10
> 
> 时间：2009-01-17T10:36:02.603
> 
> 标签：c#, asp.net, datatable, data-access-layer, bll

Microsoft 为 ASP.NET (2.0) 应用程序提供了此[DAL/BLL 设计建议](http://msdn.microsoft.com/en-us/library/bb288041.aspx)。我知道一些替代方案，并且我已经在 SO 上阅读了相关问题。但是我想知道这个提议的解决方案现在是否值得实施，你知道有什么具体的缺点吗？

我想开发 DAL/BLL 组件供公司内部使用，从各种应用程序和脚本访问客户和员工数据等。然而，在我开始构建这些东西之前，我想确保这个解决方案是“好的”。例如，[BLL](http://msdn.microsoft.com/en-us/library/aa581779.aspx)传递数据表而不是封装任何东西，您没有包含逻辑的隔离业务对象。它基本上只是一个愚蠢的层，可以稍微简化 CRUD 操作并允许控件的数据绑定。

在该领域有经验的人可以指出这种方法的优缺点吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-17T21:26:51.120

我完全建议不要使用数据表。查看一个领域驱动的设计实现，您的整个框架将与您可以传递给 List<> 或 Queryable<> 的常规对象一起工作。DataTables 是垃圾，甚至不应该包含在 .NET 中。

我还建议研究使用依赖注入/控制反转框架（例如 Microsoft Unity 或 StructureMap）来创建松散耦合的代码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-17T10:57:44.400

**优点：**
- 简单的方法和一些数据映射是用数据表为你完成的。
- 为触发选择、添加、更新和删除查询提供了一些便利。
- 可能适用于很少桌子的非常简单的设计。
- 适用于非自引用 ER 设计或具有少量查找表和简单/很少连接的 ER
- 适用于需要简单数据存储的地方。IE。复杂的 OO 思想应该应用于“业务对象”，这种模式会使事情变得更加困难。

**缺点：**
- 大型 OO 模型在这种模式下会遇到困难
- 具有许多表、复杂关系或 OO 对象要求的复杂 ER 设计不适合这种模式。数据表没有为像 LINQ 这样的代码内对象查询提供太多帮助。
- 大多数查询需要用 SQL 手工编写（包括连接）。是的，您可以使用查询设计器，但这并没有多大帮助。
- 这种方法有很多代码重复。因为您将在 BLL 类中编写大量 CRUD 方法（您也需要从头开始编写）。

**结论：** 这真的取决于你的要求。如果您的实现很小/简单，那么这可能是一个好主意。但是这种方法很难在一个小想法上成长。更多的 OO 方法将使您更好地进行重构/扩展。这种模式也较旧/过时。对象查询 IQueryable/LINQ 更流行，不久将成为更广泛的标准。我建议你跳上这辆马车。从长远来看，这对您的个人发展也会更好。:D

**一些链接：**

*   尝试 aspnet MVC - [http://www.asp.net/learn/mvc-videos/video-360.aspx?redir=true](http://www.asp.net/learn/mvc-videos/video-360.aspx?redir=true)
*   [http://www.asp.net/learn/mvc-videos/video-361.aspx?redir=true](http://www.asp.net/learn/mvc-videos/video-361.aspx?redir=true)
*   [http://www.asp.net/learn/mvc-videos/video-395.aspx](http://www.asp.net/learn/mvc-videos/video-395.aspx)
*   如果您的范围更大，这将是一个方便的模式的良好开端 - [http://www.asp.net/learn/mvc-videos/video-350.aspx](http://www.asp.net/learn/mvc-videos/video-350.aspx)

# visual-studio - JScript.Net 编译器错误

> ID：453112
> 
> 赞同：0
> 
> 时间：2009-01-17T10:39:11.583
> 
> 标签：visual-studio, visual-studio-2008, jscript.net

1.  我创建了一个包含 print("Hello World!"); 的 .js 文件。
2.  我将它保存为 hello.js
3.  我打开 Visual Studio 2008 命令提示符
4.  jsc + 输入
5.  jsc \out:hello.exe C:\path\to\my\file.js + Enter

我收到 E_ACCESSDENIED 错误：可能是什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T11:05:42.997

听起来您正在运行 Vista 或 Windows 2008。VS2008 命令提示符可能以`C:\Program Files\Microsoft Visual Studio 9.0\VC>`.

您的`/out:hello.exe`开关没有指定路径，因此编译器试图将编译后的 exe 写入当前工作文件夹`C:\Program Files\Microsoft Visual Studio 9.0\VC>`，如果没有提升的权限（即以管理员身份运行），这是不允许的。

解决方案是指定与可写源文件相同的路径：

`jsc /out:C:\path\to\my\hello.exe C:\path\to\my\file.js`

最后，如果您运行的是 64 位 Windows，那么命令提示符的工作文件夹路径将是：`C:\Program Files (x86)\Microsoft Visual Studio 9.0\VC`

# c# - 删除 ListViewItem 集合中所有选定项目的最有效方法是什么？

> ID：453118
> 
> 赞同：3
> 
> 时间：2009-01-17T10:44:23.647
> 
> 标签：c#, winforms, listview

我的用户能够在`ListView`配置为显示详细信息（即行列表）的集合中选择多个项目。

我想要做的是添加一个`Delete`按钮，该按钮将从`ListViewItem`与`ListView`.

所选项目的集合在 中可用`ListView.SelectedItems`，但`ListView.Items`似乎没有一种方法可以让我删除整个范围。我必须遍历范围并一一删除它们，这可能会修改我正在迭代的集合。

所以，我基本上追求的是相反的`AddRange()`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T11:19:25.073

如果您有一组 selectedItems，您可以简单地对它们中的每一个调用 remove，而不是遍历 ListView。

ListViewItem 上有一个名为[Remove()](http://msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.remove.aspx)的方法。

```
ListView listview = <reference to ListView>;
foreach (ListViewItem item in listView.SelectedItems)
{
  item.Remove();
} 
```

This removes the iteration through all the items and only removes your selected items.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T10:56:12.780

据我所知，除了单独删除它们之外别无他法。

将您的删除算法包装在`ListView.BeginUpdate()`并`ListView.EndUpdate()`调用。这样，您就不会在每次删除时重新绘制速度变慢。

此外，如果您以相反的顺序删除它们，我相信底层结构将无事可做。

此外，如果您要删除的项目数量占项目总数的很大比例，您可能会通过清除列表并`AddRange()`再次将它们重新输入来获得更高的性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-07T21:31:11.113

For me, in linq 2 sql I use:

```
mylist.Clear(); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-17T11:16:28.183

也许您可以尝试以下方法：

```
var ItemsToDelete = ... // wherever you get the collection of items to delete from
var RemainingItems = yourList.FindAll(delegate(ListItem x) {
  return !ItemsToDelete.Contains(x)
});
yourListView.DataSource = RemainingItems;
yourListView.DataBind(); 
```

或者只是将剩余的项目分配给现有的控件，或者你喜欢的任何东西。

*（稍微编辑格式）*

# .net - DateTime 作为 SortedDictionary 中的键

> ID：453124
> 
> 赞同：5
> 
> 时间：2009-01-17T10:50:40.063
> 
> 标签：.net, collections

我可以在不实现自己的情况下安全地`DateTime`用作 a 中的密钥吗？`SortedDictionary<K, V>``IComparer`

我已经尝试过了，排序顺序得到了维护，重要的是为了我的目的，该`.ContainsKey<T>`方法按预期工作。但我只是想在承诺自己走这条路之前仔细检查一下。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-17T11:07:21.837

我工作得很好，因为`DateTime`实现了`IComparable<DateTime>`. 所以你可以依赖[Comparer(T).Default](http://msdn.microsoft.com/en-us/library/azhsac5f.aspx)。

在内部，`DateTime`使用刻度来比较 2 个日期。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-17T11:02:39.540

您将不需要新的 IComparer。您的默认 IComparer 将使用`Equals()`来自您的值对象并与之比较/排序。由于 DateTime 类型`Equals()`正确实现，默认的 IComparer 将按照您的意愿排序（就像您发现的那样）。

创建新的比较器更适合您自己编写的复杂集合。我曾经写过一个复杂的比较器。这有点令人兴奋。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-17T11:04:03.890

我没有预见到任何问题；在幕后，该值是一个长刻度值。

此外，请确保所有值都基于同一时区 - 我个人使用 UTC/GMT 进行存储和计算，并且仅在显示时调整为本地时间。

# matlab - 什么是 MATLAB？它会生成可执行文件吗？

> ID：453139
> 
> 赞同：5
> 
> 时间：2009-01-17T11:02:16.513
> 
> 标签：matlab, frameworks, simulink, matlab-deployment

究竟什么是[MATLAB/Simulink？](http://www.mathworks.com)我试图理解它，但在这个过程中只会变得更加困惑。

我知道您可以使用高级**行业特定功能**和算法编写程序，但是：

*   它是一个**运行时**，您可以将代码“构建”到客户端/服务器的可执行程序中吗？
*   它只是一个**模拟**环境，如[LabVIEW](http://www.ni.com/labview/)，不能用于生产软件/硬件吗？
*   它是一个**代码生成**软件，比如[编译器-编译器](http://en.wikipedia.org/wiki/Parser_generator)本身并不真正执行代码吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T11:09:06.810

它主要是一个模拟和数学计算环境。

在我接受教育期间，我们将它用于频谱分析、声音处理和图像处理。非常适合尝试这些东西；如果使用得当，速度会相当快。

它确实具有一些功能，例如 Matlab 编译器，允许您获取 Matlab 代码并将其编译为可执行文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T11:10:22.520

MATLAB 是一种解释性编程语言和图形环境，适用于解决数学和工程问题。它包含高度优化的矩阵和其他数学函数，因此如果使用得当，它不会像您想象的那么慢。我相信有一个“编译器”可以将 MATLAB 程序编译为等效的 C 程序，然后可以将其编译为可执行文件。

我不确定 Simulink 到底是什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T11:58:30.067

MATLAB 程序可以编译为可执行文件，该可执行文件可以在安装了 MATLAB 运行时的机器上运行。这是一个稍微不整洁的过程，它涉及可执行文件将一大堆文件解压缩到硬盘上。我相信还有一系列其他选项可用于分发 MATLAB 应用程序和组件（即链接到 Excel、COM 对象），但我没有直接体验过它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T20:52:13.873

要回答您问题的[Simulink](http://www.mathworks.com/products/simulink/)部分，它是一个主要使用框图编程的仿真环境，很像 LabVIEW。Simulink 是 vanilla MATLAB 之外的附加包，可以附带各种其他附加包，称为 Blocksets，其中包含用于特定仿真领域的模块库，例如 Signal Processing Blockset 或 Aerodynamics Blockset。

借助 Real Time Workshop，您可以为定制硬件设计嵌入式软件的 Simulink 模型，然后将该模型自动编码为 C++。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T19:16:08.590

在 Matlab 中，您可以编写可以在 matlab 运行时环境中执行的应用程序。它可以是真实目的的真实软件，在高中时我编写了模拟 LAN 和 WIFI 网络并模拟攻击的软件。

使用实时工具箱，您可以模拟或控制汽车工厂中的装配线等真实流程

回到你的问题：

*   是的，它具有客户端/服务器的运行时间，例如我的网络模拟程序包含监视网络、计算统计数据和控制所有网络的服务器，以及模拟网络中的一台或多台计算机的客户端

*   它是模拟环境，但可以在实际生产中用于特定目的

*   我不明白你的最后一个问题

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-18T03:09:51.363

还有一个称为[嵌入式 MATLAB](http://www.mathworks.com/products/featured/embeddedmatlab/index.html?BB=1) (EML) 的 MATLAB 语言子集，它允许您将 M 代码转换为嵌入式目标的 C 代码。

除了仿真和生成 C/C++ 代码外，Simulink 还允许您对模型进行验证和确认。

# c - 基本单元测试和 C，我该如何开始？

> ID：453141
> 
> 赞同：24
> 
> 时间：2009-01-17T11:03:52.143
> 
> 标签：c, linux, unit-testing, tdd, check-framework

在阅读了 StackOverflow 上的一些帖子后，我得出结论，我应该采用某种形式的测试驱动开发/单元测试（或至少探索该领域）。

由于我们在 Linux 下讨论 c 代码，所以我决定试一试（我不知道这是否是正确的选择，但如果它不好，我可以稍后再尝试其他方法）[。](http://check.sourceforge.net/doc/check.html/index.html)

但是由于单元测试和单元测试框架的概念对我来说是全新的，我开始对一个非常小的测试代码进行一些单元测试（但无论如何我完全迷失了，感觉就像我错过了一些东西）。

这是我到目前为止所做的，我创建了以下文件：

*   main.c，只调用一个名为 my_pow 的函数并打印结果的 main.c。
*   my_pow.c，包含函数 my_pow。
*   我的_pow.h
*   my_pow_test.c，我想我应该把 my_pow 函数的单元代码放在这里。

（所以“正常程序”是 main.c、my_pow.c 和 my_pow.h。）

这是 my_pow.c

```
 #include "my_pow.h"
int my_pow(int a, int b)
{
    return (a*b);
} 

```

然后我发现在 my_pow_test.c 我放了这样的东西：

```
 #include <check.h>
#include "my_pow.h"

START_TEST (test_my_pow)
{
    /* unit test code */
}
END_TEST

//do I need some sort off main here that calls test_my_pow? 

```

[这与检查手册](http://check.sourceforge.net/doc/check.html/index.html)第 3.1 章中的基本相同，但仍然不是......

有人可以把我推向正确的方向吗？

谢谢约翰

* * *

更新：我没有理由尝试使用 check 我只是认为我应该从某个地方开始，也许 CUnit 是一个更好的选择（我想我也会尝试一下，然后做出有根据的选择）。

更新：感谢@philippe 间接指出在线文档只是事实的一半，阐明文档所讨论内容的示例代码已与 check 包一起安装。在 Ubuntu 案例中 /usr/share/doc/check/example/tests/

更新：创建了代码示例，以便您从查看他的第一个版本开始，然后查看第二个版本等等。这样您就可以了解他如何创建一个非常基本的测试用例/代码，从零到有用的东西传统的 TTD 方式。

而且由于我的代码被破坏了，我希望单元测试来证明这一点，所以我作弊了一点，并针对真正的 pow 函数进行了测试。像这样的东西：

```
 START_TEST (test_my_pow1)
{
    int resultat = my_pow(3,3);
    int math     = pow(3,3);
    fail_unless ( resultat == math,
           "Error on 3^3 != %d (%d)",math, resultat);
} 

```

但是，将来我不会复制标准库中已有的内容:-)

* * *

有关的：

*   [单元测试 C 代码](https://stackoverflow.com/questions/65820/unit-testing-c-code)
*   [如何测试 C 代码](https://stackoverflow.com/questions/148576/how-to-test-c-code)
*   [C 的单元测试框架](https://stackoverflow.com/questions/177251/unit-testing-frameworks-for-c)
*   [C 的测试框架](https://stackoverflow.com/questions/437233/testing-frameworks-for-c)
*   [基本单元测试和 C，我该如何开始？](https://stackoverflow.com/questions/453141/basic-unit-test-and-c-how-do-i-get-started)

取自搜索`[c] [unit-testing]`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-17T12:40:39.497

您创建了第一个测试用例。现在您需要[创建一个测试套件](http://libcheck.github.io/check/doc/check_html/check_3.html#Creating-a-Suite)（一组测试用例）和一个[运行](http://libcheck.github.io/check/doc/check_html/check_3.html#SRunner-Output)器。

我建议您首先尝试编译[他们的示例](http://libcheck.github.io/check/doc/check_html/check_3.html#Setting-Up-the-Money-Build-Using-CMake)以验证您的环境，尽管他们的文档通过 diff（源补丁）引入了新代码，我觉得这不太方便。

* * *

如果您决定尝试使用另一个框架（[minunit](http://www.jera.com/techinfo/jtns/jtn002.html)立即出现在我的脑海中），我可以为您指出一个“[教程](http://pantras.free.fr/articles/minunit.html)”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T11:53:47.097

我更倾向于使用[CUnit](http://cunit.sourceforge.net/)，它是 X-Unit 系列测试框架的一部分。

它可以扩展到大型测试套件，并且已经使用了很多年，因此很成熟。

你为什么不选择CUnit？

高温高压

干杯，

抢

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-18T16:59:18.127

我多年来一直在使用[dejagnu](http://www.gnu.org/software/dejagnu)并且喜欢它。

我开始将它用于嵌入式开发，因为它很好地支持了运行测试程序的机器可能与构建测试程序的机器不同的概念。这样做的结果是，在多个平台上测试代码也得到了很好的支持。不确定这是否重要。gcc 测试套件使用它。我也将它用于桌面开发。

dejagnu 的基本思想是你

*   将测试程序复制到“目标”（本地测试可以是 ~/tmp 目录）
*   启动测试程序
*   将内容打印到控制台（作为测试程序的输入）
*   解析测试程序的输出并将其与您期望的匹配
*   决定该输出是通过还是失败

一旦你编写了测试程序和测试脚本，你最终会做这样的事情：

```
$运行测试
                === foo 总结 ===

# 预期通过次数 42
foo-test 于 2009 年 1 月 15 日星期四 20:09:19 PST 建成
foo-test 版本 0.0.0.1
运行测试于 2009 年 1 月 18 日星期日 08:29:13 完成
```

我去那里测试一个名为 foo 的库的方法是：

*   假设库的源文件和包含文件在 ~/src/foo
*   创建一个名为 ~/src/foo/testsuite 的目录
*   编写一个名为 foo-test.c 的测试程序，它有一个 main()

*   处理命令行参数
*   - 打印一个提示并坐在一个循环处理“命令”中，我定义一个命令来测试我的库中的每个函数。这有点像命令外壳，但特定于库。对于 my_pow 之类的东西，我将命令定义为采用 2 个参数。
*   编写一个 dejagnu（这是 Expect (http://expect.nist.gov/) 之上的另一层，它本身就是 Tcl (http://www.tcl.tk/) 之上的一层名为 my_pow 的函数：

*   接受两个参数
*   计算预期结果（在 Tcl 中）
*   将“my_pow”发送到控制台
*   从 foo-test 解析 my_pow 命令的输出
*   确定实际结果是否与预期结果相符
*   调用适当的 dejagnu 函数（通过或失败）

听起来很难，但事实并非如此。决定在 foo-test 中做多少工作与在 Tcl 中做多少工作需要一点时间。我最终使用了大量的 shell（例如 bash）功能来执行诸如将文件复制到临时目录或查看我的程序生成的日志文件之类的事情。所以你最终会擅长所有这些东西。

至于参考资料，我想说的是一本关于 Expect 的书是深入研究的必要条件：http: [//oreilly.com/catalog/9781565920903/index.html](http://oreilly.com/catalog/9781565920903/index.html)。
在此和在线 Tcl 命令参考[http://www.tcl.tk/man/tcl8.4/TclCmd/contents.htm](http://www.tcl.tk/man/tcl8.4/TclCmd/contents.htm)和常见问题解答（[http://www.psg.com/~joem/tcl/faq.html](http://www.psg.com/~joem/tcl/faq.html)），你几乎在那里。

祝你好运。

-D B

# c# - 如何以编程方式获取（ASP）.NET 应用程序分配的总内存？

> ID：453154
> 
> 赞同：3
> 
> 时间：2009-01-17T11:15:51.697
> 
> 标签：c#, .net, asp.net, memory

如何以编程方式检查我的程序当前分配了多少内存？

我需要它用于 ASP .NET 应用程序，但我怀疑该解决方案适用于所有类型的 .NET 应用程序。理想情况下，获取当前分配的内存量的操作应该很快，因为我需要经常查询它。

编辑：感谢您的回答。我将使用 GC.GetTotalMemory 来完成这项任务，因为我需要将它用于 ASP .NET 应用程序。经过一些实验，我确定它足够快速和准确，可以满足我的需求。使用 Process 的 PrivateMemorySize64 属性的建议通常也可以使用；但正如答案中所指出的，对于 ASP.NET 应用程序，通常会在一个进程中运行多个 AppDomain。我需要每个 AppDomain 的内存总量。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T11:27:49.643

有一个[**GC.GetTotalMemory**](http://msdn.microsoft.com/en-us/library/system.gc.gettotalmemory(VS.80).aspx)方法，但这只会给你一个近似值。这够了吗？

如果你用它来调用它`GC.GetTotalMemory(false)`会更快......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T12:56:24.613

还要注意，对于 asp.net，在一个进程中有多个应用程序是很常见的。这限制了 PrivateMemorySize64 的用处。GC.GetTotalMemory 是每个应用程序域 afaik。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T11:36:43.730

您还可以从[Process](http://msdn.microsoft.com/en-us/library/system.diagnostics.process_members.aspx)类中调用 PrivateMemorySize64（或 Virtual，如果您愿意）。但是，请注意，数字会被缓存，并且仅在您调用 Refresh 时才会刷新。

# python - 与 Twitter 交互时，xml、json、rss 和 atom 之间的实际区别是什么？

> ID：453158
> 
> 赞同：6
> 
> 时间：2009-01-17T11:19:36.650
> 
> 标签：python, xml, json, twitter, twisted

我是 Web 服务的新手，作为介绍，我正在使用 Python 中的 Twisted 框架来玩转 Twitter API。我已经阅读了他们提供的不同格式，但我仍然不清楚在我相当简单的项目中应该使用哪一种。具体来说，使用 JSON 或 XML 之间的实际区别是我希望得到的指导。我所做的只是请求公共时间线并将其缓存在本地。

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T14:45:23.287

对我来说，这归结为方便。使用 XML，我必须将响应解析为 DOM（或更常见的是 ElementTree）。使用 JSON，调用 simplejson.loads(json_string)，我就有了一个原生 Python 数据结构（列表、字典、字符串等），我可以开始迭代和处理。在我看来，任何意味着少写几行代码的事情通常都是一个好主意。

我经常使用 JSON 在 PHP、Python 和 JavaScript 之间移动数据结构——同样，因为它让我不必弄清楚 XML 序列化然后在另一端解析它。

就像 jinzo 所说，JSON 最终在网络上的字节数略少。

你可能会发现我几年前关于 JSON 的博客文章很有用：[http ://simonwillison.net/2006/Dec/20/json/](http://simonwillison.net/2006/Dec/20/json/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T11:21:38.550

RSS 和 Atom 是 XML 格式。

JSON 是一个字符串，可以作为 Javascript 代码进行评估。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T11:24:46.920

我想说通过网络发送的数据量是一个因素。对于相同的数据，XML 数据流将大于 JSON。但是你可以使用任何你知道的更多/有更多经验的东西。

我会推荐 JSON，因为它比 XML 更“pythonic”。

# image-capture - j2me 应用程序

> ID：453159
> 
> 赞同：0
> 
> 时间：2009-01-17T11:20:02.123
> 
> 标签：image-capture

我正在为移动设备编写一个 j2me 应用程序...我试图在应用程序中打开移动相机并捕获图像..怎么做？请尽快回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T11:31:12.447

如果手机支持 MMAPI，您可以像这样拍摄快照。

```
//Use this method to initialize
// m_Form is the displayed Form
private void startPlayer() {
   try {
         Player m_objPlayer = Manager.createPlayer("capture://video");
         m_objPlayer.realize();
         m_objVideoControl = (VideoControl)
         m_objPlayer.getControl("VideoControl");
         if (m_objVideoControl != null) 
         {
           m_Form.append((Item) m_objVideoControl.initDisplayMode(
           VideoControl.USE_GUI_PRIMITIVE, null));
           m_objPlayer.start();
         }
       } catch (Exception exc) {
            // handle Exception
}

// Use this to take a snapshot
public void commandAction(Command cmd, Displayable d) {
   if ((cmd == snapShotCommand) && d == this) {
    try {
         data =
           m_objVideoControl.getSnapshot("encoding=jpeg&width =160&height=120"));
          // m_objVideoControl.getSnapshot("encoding=png&width= 80&height=60"));
          // m_objVideoControl.getSnapshot("encoding=bmp&width= 160&height=120"));
   } catch (Exception exc) {
     // handle Exception
   }
} 
```

这是一篇关于太阳的旧文章[点击我！](http://developers.sun.com/mobility/midp/articles/picture/)

# c# - 如何在 Windows 窗体应用程序中保存应用程序设置？

> ID：453161
> 
> 赞同：625
> 
> 时间：2009-01-17T11:23:36.393
> 
> 标签：c#, xml, winforms, configuration-files, application-settings

我想要实现的目标非常简单：我有一个使用路径读取信息的 Windows 窗体 (.NET 3.5) 应用程序。用户可以使用我提供的选项表单来修改此路径。

现在，我想将路径值保存到文件中以备后用。这将是保存到此文件的众多设置之一。该文件将直接位于应用程序文件夹中。

我了解三个选项可用：

*   配置设置文件 (appname.exe.config)
*   登记处
*   自定义 XML 文件

我读到 .NET 配置文件无法将值保存回它。至于注册表，我想离它越远越好。

这是否意味着我应该使用自定义 XML 文件来保存配置设置？

如果是这样，我想看看那个（C#）的代码示例。

我看过其他关于这个主题的讨论，但我仍然不清楚。

* * *

## 回答 #1

> 赞同：635
> 
> 时间：2009-01-17T12:18:01.227

如果您使用 Visual Studio，那么很容易获得可持久化的设置。右键单击解决方案资源管理器中的项目，然后选择属性。如果设置不存在，请选择“设置”选项卡并单击超链接。

使用设置选项卡创建应用程序设置。Visual Studio 创建文件`Settings.settings`并`Settings.Designer.settings`包含从[ApplicationSettingsBase](http://msdn.microsoft.com/en-us/library/system.configuration.applicationsettingsbase.aspx)`Settings`继承 的单例类。您可以从您的代码访问此类以读取/写入应用程序设置：

```
Properties.Settings.Default["SomeProperty"] = "Some Value";
Properties.Settings.Default.Save(); // Saves settings in application configuration file 
```

此技术适用于控制台、Windows 窗体和其他项目类型。

请注意，您需要设置设置的*范围*属性。如果您选择应用程序范围，则 Settings.Default.<your property> 将是只读的。

参考：[如何：使用 C# 在运行时编写用户设置](https://docs.microsoft.com/en-us/dotnet/framework/winforms/advanced/how-to-write-user-settings-at-run-time-with-csharp)- Microsoft Docs

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2011-06-30T22:16:52.993

如果您打算保存到与可执行文件位于同一目录中的文件，这是一个使用[JSON](http://en.wikipedia.org/wiki/JSON)格式的不错的解决方案：

```
using System;
using System.IO;
using System.Web.Script.Serialization;

namespace MiscConsole
{
    class Program
    {
        static void Main(string[] args)
        {
            MySettings settings = MySettings.Load();
            Console.WriteLine("Current value of 'myInteger': " + settings.myInteger);
            Console.WriteLine("Incrementing 'myInteger'...");
            settings.myInteger++;
            Console.WriteLine("Saving settings...");
            settings.Save();
            Console.WriteLine("Done.");
            Console.ReadKey();
        }

        class MySettings : AppSettings<MySettings>
        {
            public string myString = "Hello World";
            public int myInteger = 1;
        }
    }

    public class AppSettings<T> where T : new()
    {
        private const string DEFAULT_FILENAME = "settings.json";

        public void Save(string fileName = DEFAULT_FILENAME)
        {
            File.WriteAllText(fileName, (new JavaScriptSerializer()).Serialize(this));
        }

        public static void Save(T pSettings, string fileName = DEFAULT_FILENAME)
        {
            File.WriteAllText(fileName, (new JavaScriptSerializer()).Serialize(pSettings));
        }

        public static T Load(string fileName = DEFAULT_FILENAME)
        {
            T t = new T();
            if(File.Exists(fileName))
                t = (new JavaScriptSerializer()).Deserialize<T>(File.ReadAllText(fileName));
            return t;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：69
> 
> 时间：2009-01-17T11:33:57.073

注册表是不行的。您不确定使用您的应用程序的用户是否有足够的权限写入注册表。

您可以使用该`app.config`文件保存应用程序级别的设置（对于使用您的应用程序的每个用户都是相同的）。

我会将用户特定的设置存储在一个 XML 文件中，该文件将保存在[独立存储](https://docs.microsoft.com/en-us/dotnet/standard/io/isolated-storage)或[SpecialFolder.ApplicationData](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)目录中。

除此之外，从 .NET 2.0 开始，可以将值存储回`app.config`文件。

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2009-01-17T14:45:56.157

该类`ApplicationSettings`不支持将设置保存到*app.config*文件。这在很大程度上是设计使然。使用适当保护的用户帐户（想想 Vista UAC）运行的应用程序对程序的安装文件夹没有写入权限。

`ConfigurationManager`您可以与班级对抗系统。但简单的解决方法是进入设置设计器并将设置的范围更改为用户。如果这会导致困难（例如，该设置与每个用户相关），您应该将您的选项功能放在一个单独的程序中，以便您可以请求权限提升提示。或者放弃使用设置。

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2011-10-11T15:24:09.690

registry/configurationSettings/XML 参数似乎仍然非常活跃。随着技术的进步，我已经全部使用了它们，但我最喜欢的是基于[Threed 的系统和](https://stackoverflow.com/questions/453161/best-practice-to-save-application-settings-in-a-windows-application/6541739#6541739)[独立存储](http://msdn.microsoft.com/en-us/library/3ak841sy.aspx)的结合。

以下示例允许将名为属性的对象存储到独立存储中的文件中。如：

```
AppSettings.Save(myobject, "Prop1,Prop2", "myFile.jsn"); 
```

可以使用以下方法恢复属性：

```
AppSettings.Load(myobject, "myFile.jsn"); 
```

这只是一个示例，并不暗示最佳实践。

```
internal static class AppSettings
{
    internal static void Save(object src, string targ, string fileName)
    {
        Dictionary<string, object> items = new Dictionary<string, object>();
        Type type = src.GetType();

        string[] paramList = targ.Split(new char[] { ',' });
        foreach (string paramName in paramList)
            items.Add(paramName, type.GetProperty(paramName.Trim()).GetValue(src, null));

        try
        {
            // GetUserStoreForApplication doesn't work - can't identify.
            // application unless published by ClickOnce or Silverlight
            IsolatedStorageFile storage = IsolatedStorageFile.GetUserStoreForAssembly();
            using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(fileName, FileMode.Create, storage))
            using (StreamWriter writer = new StreamWriter(stream))
            {
                writer.Write((new JavaScriptSerializer()).Serialize(items));
            }

        }
        catch (Exception) { }   // If fails - just don't use preferences
    }

    internal static void Load(object tar, string fileName)
    {
        Dictionary<string, object> items = new Dictionary<string, object>();
        Type type = tar.GetType();

        try
        {
            // GetUserStoreForApplication doesn't work - can't identify
            // application unless published by ClickOnce or Silverlight
            IsolatedStorageFile storage = IsolatedStorageFile.GetUserStoreForAssembly();
            using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(fileName, FileMode.Open, storage))
            using (StreamReader reader = new StreamReader(stream))
            {
                items = (new JavaScriptSerializer()).Deserialize<Dictionary<string, object>>(reader.ReadToEnd());
            }
        }
        catch (Exception) { return; }   // If fails - just don't use preferences.

        foreach (KeyValuePair<string, object> obj in items)
        {
            try
            {
                tar.GetType().GetProperty(obj.Key).SetValue(tar, obj.Value, null);
            }
            catch (Exception) { }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2016-06-07T20:56:13.393

我想分享一个为此构建的库。这是一个很小的库，但对 .settings 文件有很大的改进（恕我直言）。

该库称为[Jot (GitHub)](https://github.com/anakic/Jot)。这是我写的一篇关于它的旧[代码项目文章。](http://www.codeproject.com/Articles/475498/Easier-NET-settings)

以下是您如何使用它来跟踪窗口的大小和位置：

```
public MainWindow()
{
    InitializeComponent();

    _stateTracker.Configure(this)
        .IdentifyAs("MyMainWindow")
        .AddProperties(nameof(Height), nameof(Width), nameof(Left), nameof(Top), nameof(WindowState))
        .RegisterPersistTrigger(nameof(Closed))
        .Apply();
} 
```

**与 .settings 文件相比的好处：**代码少得多，而且出错的可能性要小得多，因为您只需要提及每个属性**一次**。

对于设置文件，您需要提及每个属性**五次**：一次是在您显式创建属性时，另外四次是在代码中来回复制值。

存储、序列化等是完全可配置的。当目标对象由[IoC](https://en.wikipedia.org/wiki/Inversion_of_control)容器创建时，您可以 [hook it][] 以便它自动将跟踪应用到它解析的所有对象，因此您需要做的就是使属性持久化一个 [Trackable]属性就可以了。

它是高度可配置的，您可以配置： - 何时全局或为每个跟踪对象持久化和应用数据 - 如何序列化 - 存储位置（例如文件、数据库、在线、隔离存储、注册表） - 可以取消应用的规则/为属性持久化数据

相信我，图书馆是一流的！

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2015-11-25T13:18:02.177

一种简单的方法是使用配置数据对象，将其保存为 XML 文件，并在本地文件夹中使用应用程序的名称，然后在启动时将其读回。

这是一个存储表单位置和大小的示例。

配置数据对象是强类型且易于使用：

```
[Serializable()]
public class CConfigDO
{
    private System.Drawing.Point m_oStartPos;
    private System.Drawing.Size m_oStartSize;

    public System.Drawing.Point StartPos
    {
        get { return m_oStartPos; }
        set { m_oStartPos = value; }
    }

    public System.Drawing.Size StartSize
    {
        get { return m_oStartSize; }
        set { m_oStartSize = value; }
    }
} 
```

用于保存和加载的管理器类：

```
public class CConfigMng
{
    private string m_sConfigFileName = System.IO.Path.GetFileNameWithoutExtension(System.Windows.Forms.Application.ExecutablePath) + ".xml";
    private CConfigDO m_oConfig = new CConfigDO();

    public CConfigDO Config
    {
        get { return m_oConfig; }
        set { m_oConfig = value; }
    }

    // Load configuration file
    public void LoadConfig()
    {
        if (System.IO.File.Exists(m_sConfigFileName))
        {
            System.IO.StreamReader srReader = System.IO.File.OpenText(m_sConfigFileName);
            Type tType = m_oConfig.GetType();
            System.Xml.Serialization.XmlSerializer xsSerializer = new System.Xml.Serialization.XmlSerializer(tType);
            object oData = xsSerializer.Deserialize(srReader);
            m_oConfig = (CConfigDO)oData;
            srReader.Close();
        }
    }

    // Save configuration file
    public void SaveConfig()
    {
        System.IO.StreamWriter swWriter = System.IO.File.CreateText(m_sConfigFileName);
        Type tType = m_oConfig.GetType();
        if (tType.IsSerializable)
        {
            System.Xml.Serialization.XmlSerializer xsSerializer = new System.Xml.Serialization.XmlSerializer(tType);
            xsSerializer.Serialize(swWriter, m_oConfig);
            swWriter.Close();
        }
    }
} 
```

现在您可以创建一个实例并在表单的加载和关闭事件中使用：

```
 private CConfigMng oConfigMng = new CConfigMng();

    private void Form1_Load(object sender, EventArgs e)
    {
        // Load configuration
        oConfigMng.LoadConfig();
        if (oConfigMng.Config.StartPos.X != 0 || oConfigMng.Config.StartPos.Y != 0)
        {
            Location = oConfigMng.Config.StartPos;
            Size = oConfigMng.Config.StartSize;
        }
    }

    private void Form1_FormClosed(object sender, FormClosedEventArgs e)
    {
        // Save configuration
        oConfigMng.Config.StartPos = Location;
        oConfigMng.Config.StartSize = Size;
        oConfigMng.SaveConfig();
    } 
```

并且生成的 XML 文件也是可读的：

```
<?xml version="1.0" encoding="utf-8"?>
<CConfigDO xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <StartPos>
    <X>70</X>
    <Y>278</Y>
  </StartPos>
  <StartSize>
    <Width>253</Width>
    <Height>229</Height>
  </StartSize>
</CConfigDO> 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2020-01-23T09:39:32.967

**是的，可以保存**配置 - 但这在很大程度上取决于您选择的方式。让我描述一下技术差异，以便您了解您拥有的选项：

首先，您需要区分是要在您的（也就是在 Visual Studio 中）文件中使用**applicationSettings**还是**AppSettings** - 存在**根本的区别，****[在此处进行了描述](https://stackoverflow.com/a/40970982/1016343)****。**`*.exe.config``App.config`

 **两者都提供了不同的保存更改的方式：

*   **[AppSettings](https://stackoverflow.com/a/11841175/1016343)**允许您通过直接读取和写入配置文件`config.Save(ConfigurationSaveMode.Modified);`，其中 config 定义为：
    `config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);`

*   **[applicationSettings](https://stackoverflow.com/a/9704380/1016343)**允许读取，但如果您写入更改（通过）`Properties.Settings.Default.Save();`，它将基于每个用户写入，存储在特殊位置（例如`C:\Documents and Settings\USERID\Local Settings\Application Data\FIRMNAME\WindowsFormsTestApplicati_Url_tdq2oylz33rzq00sxhvxucu5edw2oghw\1.0.0.0`）。正如[Hans Passant](https://stackoverflow.com/a/453390/1016343)在他的回答中提到的，这是因为用户通常对 Program Files 具有受限的权限，并且在不调用 UAC 提示的情况下无法对其进行写入。一个缺点是，如果您将来要添加配置密钥，则需要将它们与每个用户配置文件同步。

但是还有其他几个替代选项：

*   由于 .NET Core（以及 .NET 5 和 6），**第三个选项**是`appsettings.json`使用 Microsoft 配置抽象的文件。但通常 WinForms 不使用它，所以我提到它只是为了完整性。但是，这里有一些如何[读取](https://stackoverflow.com/questions/41738692/read-appsettings-json-in-main-program-cs)和[写入](https://stackoverflow.com/questions/41653688/asp-net-core-appsettings-json-update-in-code)值的参考。或者，您可以使用[Newtonsoft JSON 读取和写入](https://www.newtonsoft.com/json/help/html/ReadingWritingJSON.htm)`appsettings.json`文件，但不限于此：您还可以使用该方法创建自己的 json 文件。

*   正如问题中提到的，有**第4个选项：**如果您将配置文件视为**XML文档，**您可以使用[`System.Xml.Linq.XDocument`](https://docs.microsoft.com/en-us/dotnet/api/system.xml.xmldocument?view=netframework-4.8)该类来加载、修改和保存它。不需要使用自定义的 XML 文件，可以读取已有的配置文件；对于查询元素，您甚至可以使用 Linq 查询。我在**[这里](https://stackoverflow.com/a/9704380/1016343)****`GetApplicationSetting`**举了一个例子，在答案中查看那里的功能。

*   **第五个选项**是将设置存储在**注册表中。**[此处](https://stackoverflow.com/a/13232372/1016343)描述了如何做到这一点。

*   最后同样重要的是，还有**第 6 个选项**：您可以将值存储在**环境中**（系统环境或帐户环境）。在 Windows 设置（Windows 菜单中的齿轮）中，在搜索栏中输入“环境”并在那里添加或编辑它们。要阅读它们，请使用
    `var myValue = Environment.GetEnvironmentVariable("MyVariable");`.
    请注意，您的应用程序通常需要重新启动才能获得更新的环境设置。

如果您需要**加密来保护您的值，**请查看**[此](https://stackoverflow.com/a/15342230/1016343)**答案。它描述了如何使用 Microsoft 的 DPAPI 来存储加密的值。

如果您想支持自己的文件，无论是 XML 还是 JSON，了解运行的程序集的目录可能会很有用：

```
var assemblyDLL = System.Reflection.Assembly.GetExecutingAssembly();
var assemblyDirectory = System.IO.Path.GetDirectoryName(assemblyDLL.Location); 
```

您可以`assemblyDirectory`用作基本目录来存储您的文件。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-09-09T21:49:24.477

我不喜欢使用`web.config`or的建议解决方案`app.config`。尝试阅读您自己的 XML。查看*[XML 设置文件 – 不再有 web.config](http://www.picnet.com.au/blogs/guido/post/2009/09/10/xml-settings-files-no-more-web-config/)*。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-12-14T20:07:28.030

“这是否意味着我应该使用自定义 XML 文件来保存配置设置？” 不，不一定。我们使用 SharpConfig 进行此类操作。

例如，如果配置文件是这样的

```
[General]
# a comment
SomeString = Hello World!
SomeInteger = 10 # an inline comment 
```

我们可以像这样检索值

```
var config = Configuration.LoadFromFile("sample.cfg");
var section = config["General"];

string someString = section["SomeString"].StringValue;
int someInteger = section["SomeInteger"].IntValue; 
```

它与 .NET 2.0 及更高版本兼容。我们可以即时创建配置文件，以后可以保存。

来源：[http](http://sharpconfig.net/)
: //sharpconfig.net/ GitHub：[https ://github.com/cemdervis/SharpConfig](https://github.com/cemdervis/SharpConfig)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2014-09-19T03:04:41.647

其他选项，而不是使用自定义 XML 文件，我们可以使用更用户友好的文件格式：JSON 或 YAML 文件。

*   如果你使用.NET 4.0动态，这个库真的很容易使用（序列化、反序列化、嵌套对象支持和排序输出随心所欲+将多个设置合并为一个）[JsonConfig](https://github.com/Dynalon/JsonConfig "JsonConfig")（用法相当于ApplicationSettingsBase）
*   对于 .NET YAML 配置库...我还没有找到一个像 JsonConfig 一样好用的

您可以将设置文件存储在此处列出的多个特殊文件夹（所有用户和每个用户）中[Environment.SpecialFolder 枚举](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder%28v=vs.110%29.aspx)和多个文件（默认只读、每个角色、每个用户等）

*   获取特殊文件夹路径示例：*[C#获取%AppData%路径](https://stackoverflow.com/a/867493/423356)*

如果您选择使用多个设置，则可以合并这些设置：例如，合并 default + BasicUser + AdminUser 的设置。您可以使用自己的规则：最后一个覆盖值等。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-01-17T11:34:10.257

据我所知，.NET 确实支持使用内置应用程序设置工具的持久设置：

> Windows 窗体的应用程序设置功能可以轻松地在客户端计算机上创建、存储和维护自定义应用程序和用户首选项。使用 Windows 窗体应用程序设置，您不仅可以存储应用程序数据（例如数据库连接字符串），还可以存储用户特定的数据，例如用户应用程序首选项。使用 Visual Studio 或自定义托管代码，您可以创建新设置，从磁盘读取它们并将它们写入磁盘，将它们绑定到表单上的属性，并在加载和保存之前验证设置数据。- [http://msdn.microsoft.com/en-us/library/k4s6c3a0.aspx](http://msdn.microsoft.com/en-us/library/k4s6c3a0.aspx)

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-12-23T17:41:36.827

有时您想摆脱保留在传统 web.config 或 app.config 文件中的那些设置。您希望对设置条目的部署和分离的数据设计进行更细粒度的控制。或者要求是在运行时启用添加新条目。

我可以想象两个不错的选择：

*   强类型版本和
*   面向对象的版本。

强类型版本的优点是强类型设置名称和值。不存在混合名称或数据类型的风险。缺点是需要编写更多设置，无法在运行时添加。

使用面向对象版本的优点是可以在运行时添加新设置。但是您没有强类型的名称和值。必须小心字符串标识符。获取值时必须知道之前保存的数据类型。

[您可以在此处](http://www.milevis.com/Tips/Details/31)找到两个全功能实现的代码。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-07-27T16:44:11.720

```
public static class SettingsExtensions
{
    public static bool TryGetValue<T>(this Settings settings, string key, out T value)
    {
        if (settings.Properties[key] != null)
        {
            value = (T) settings[key];
            return true;
        }

        value = default(T);
        return false;
    }

    public static bool ContainsKey(this Settings settings, string key)
    {
        return settings.Properties[key] != null;
    }

    public static void SetValue<T>(this Settings settings, string key, T value)
    {
        if (settings.Properties[key] == null)
        {
            var p = new SettingsProperty(key)
            {
                PropertyType = typeof(T),
                Provider = settings.Providers["LocalFileSettingsProvider"],
                SerializeAs = SettingsSerializeAs.Xml
            };
            p.Attributes.Add(typeof(UserScopedSettingAttribute), new UserScopedSettingAttribute());
            var v = new SettingsPropertyValue(p);
            settings.Properties.Add(p);
            settings.Reload();
        }
        settings[key] = value;
        settings.Save();
    }
} 
```

# c# - C# 方法调用委托

> ID：453163
> 
> 赞同：0
> 
> 时间：2009-01-17T11:24:31.490
> 
> 标签：c#, linq, methods, delegation

假设我有一个 DLL 程序集，其中包含一个具有两种方法的自动生成类：

```
public class AutoGeneratedClass
{
    public int DoSomething(bool forReal) { ??? }
    public void DoSomethingElse(string whatever) { ??? }
} 
```

方法可以是任何东西，真的。以上只是一个说明。

我需要生成什么样的代码来代替??? 上面让它自动打包调用的参数并将它们发送到另一个类上的单个泛型方法，然后实际处理调用并返回结果？

```
public class GenericClass
{
    public ??? GenericHandler(???) { ??? }
} 
```

我想我正在寻找与`Expression<Func<...>>`LINQ 类似的东西，它编译成可以发送到任何地方并在那里拆开的数据结构。

不过，我想保持原始方法原型与正常的本地实现方法相同，以保持 AutoGeneratedClass 的调用者不明智。

如果这无法实现，我有什么选择？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T11:48:31.473

一定要上课吗？使用接口生活会容易得多 - 然后您可以使用[System.Runtime.Remoting.Proxies.RealProxy](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.proxies.realproxy.aspx)或者可能根据需要创建一个新类型。我相信[Rhino.Mocks](http://ayende.com/projects/rhino-mocks.aspx)是后者（使用库来完成繁重的工作）——如果你*可以*使用接口，那么看看 Rhino.Mocks 是如何实现的可能是一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T13:28:56.403

我将在这里暗中尝试，因为我不确定您的所有限制是什么。这听起来像是 AutoGenerated 类的部分方法/部分类的好例子。（注意我没有通过编译器运行得这么好，所以它可能需要一些清理。）

```
public partial class AutoGenerated
{
    public partial int ProcessDoSomething(bool forReal);
    public int DoSomething(bool forReal)
    {
        //some generated code against error conditions??
        return ProcessDoSomething(forReal)
    }

    .....
}

public partial class AutoGenerated
{
    public partial int ProcessDoSomething(bool forReal)
    {
        //call the generic handler...
    }
} 
```

我将远离通用处理程序的类似 LINQ 的表达式部分，因为我仍在研究 grokking Expressions。然而，需要考虑的是，如果您采用类似 LINQ 的表达式路径，您的 GenericClass 维护起来有多难/容易？

我的经验是，相当多的开发人员对委托和 Lamba 表达式不满意。在查看使用表达式的代码时，他们会畏缩（字面意思）。

# ant - 使用ant检测os并设置属性

> ID：453170
> 
> 赞同：47
> 
> 时间：2009-01-17T11:29:30.810
> 
> 标签：ant

我想通过操作系统类型以不同的方式在 ant 任务中设置属性。

该属性是一个目录，在 Windows 中我希望它是 unix/linux“/opt/flag”中的“c:\flag”。

我当前的脚本仅在我使用默认目标运行时才有效，但为什么呢？

```
 <target name="checksw_path" depends="if_windows, if_unix"/>

<target name="checkos">
    <condition property="isWindows">
        <os family="windows" />
    </condition>

    <condition property="isLinux">
        <os family="unix" />
    </condition>
</target>

<target name="if_windows" depends="checkos" if="isWindows">
   <property name="sw.root" value="c:\flag" />
    <echo message="${sw.root}"/>
</target>

<target name="if_unix" depends="checkos" if="isLinux">
    <property name="sw.root" value="/opt/flag" />
    <echo message="${sw.root}"/>
</target> 
```

在我所有的蚂蚁目标中，我添加了一个“depends=checksw_path”。

如果我在 Windows 中运行默认目标，我得到正确的“c:\flag”，但如果我运行非默认目标，我得到调试进入 if_windows 但指令“”没有设置保留的属性/选择/标志。我正在使用蚂蚁 1.7.1。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-01-17T11:41:18.337

将您的条件移出`<target />`，因为您的目标可能没有被调用。

```
 <condition property="isWindows">
                    <os family="windows" />
 </condition>

 <condition property="isLinux">
                    <os family="unix" />
 </condition> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-10-20T23:59:17.533

您需要将值“true”设置为 if 条件才能工作的属性。请看下面的代码：

```
<target name="checkos">
    <condition property="isWindows" value="true">
            <os family="windows" />
    </condition>

    <condition property="isLinux" value="true">
            <os family="unix" />
    </condition>
</target> 
```

HTH，哈里

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-22T07:51:54.197

我使用了这个脚本，它对我来说效果很好：

```
<project name="dir" basedir=".">

  <condition property="isWindows">
    <os family="windows" />
  </condition>

  <condition property="isUnix">
    <os family="unix" />
  </condition>

  <target name="setWindowsRoot" if="isWindows">
    <property name="root.dir" value="c:\tmp\" />
  </target>

  <target name="setUnixRoot" if="isUnix">
    <property name="root.dir" value="/i0/" />
  </target>

  <target name="test" depends="setWindowsRoot, setUnixRoot">
    <mkdir dir="${root.dir}" />
  </target>

</project> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-04-20T10:23:12.127

如果要根据操作系统设置单个属性，也可以直接设置，无需创建任务：

```
<condition property="sw.root" value="c:\flag">
    <os family="windows" />
</condition>

<condition property="sw.root" value="/opt/flag">
        <os family="unix" />
</condition>

<property name="sw.root" value="/os/unknown/"/> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-30T05:21:59.387

尝试`<sysproperty key="foobar" value="fowl"/>`在您的 java 任务中进行设置。然后，在您的应用程序中，使用 System.getProperty("foobar");

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-05-10T16:49:42.153

通过使用[Ant Contrib](http://ant-contrib.sourceforge.net/)，您可以通过减少为添加这些条件而需要声明的元素数量来简化构建文件。

```
<!--Tell Ant to define the Ant Contrib tasks from the jar-->
<taskdef resource="net/sf/antcontrib/antcontrib.properties">
    <classpath>
        <pathelement location="path/to/ant-contrib-0.6.jar"/>
    </classpath>
</taskdef>

<!--Do your OS specific stuff-->
<target name="checkos">
    <if>
        <os family="unix"/>
        <then>
            <!--Do your Unix stuff-->
        </then>
        <elseif>
            <os family="windows"/>
            <then>
                <!--Do your Windows stuff-->
            </then>
        </elseif>
    </if>
</target> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-22T20:45:33.900

首先，您要根据操作系统 (OS) 将变量设置为 true 或 false：

```
<condition property="IS_WINDOWS" value="true" else="false">
   <os family="windows"/>
</condition> 
```

然后你想使用变量触发你的逻辑。为此，您可以在这里找到答案：

[https://boulderappsco.postach.io/post/running-different-ant-tasks-depending-on-the-operating-system](https://boulderappsco.postach.io/post/running-different-ant-tasks-depending-on-the-operating-system)

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-01-17T19:32:58.603

我使用 -Dsw.root=c:\flag （对于 Windows）或 -Dsw.root=/opt/superwaba （对于 Linux）解决了使用 sw.root 的值执行 ant 任务。

不管怎样，谢谢

# javascript - 在 JavaScript 中使用模数 (%) 运算符的正确方法是什么？

> ID：453186
> 
> 赞同：3
> 
> 时间：2009-01-17T11:47:07.547
> 
> 标签：javascript, modulo

在 JavaScript 中，% 操作符的行为似乎很奇怪。我尝试了以下方法：

```
>>> (0 - 11) % 12
-11 
```

为什么它返回 -11 而不是 1（如在 Python 中）？

我确定我正在做错事或期待错事，但文档并没有告诉我是什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T11:49:59.787

根据指定语言的方式（例如[ECMA 262](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-262.pdf)），它的行为正确，它被称为余数运算符而不是模数运算符。从规范：

> ECMAScript 浮点余数运算的结果由 IEEE 算术规则确定：
> 
> *   如果任一操作数为 NaN，则结果为 NaN。
> *   结果的符号等于被除数的符号。
> *   如果被除数为无穷大，或除数为零，或两者兼而有之，则结果为 NaN。
> *   如果被除数是有限的且除数是无穷大，则结果等于被除数。
> *   如果被除数为零且除数为非零且有限，则结果与被除数相同。
> *   `r`在其余情况下，既不涉及无穷大，也不涉及零，也不涉及 NaN，被除数`n`和除数的浮点余数`d`由数学关系定义，`r = n - (d * q)`其中`q`是一个整数，只有当`n/d`是负数和正数时才是负数if`n/d`是正的，并且其幅度尽可能大，但不超过 和 的真数学商的`n`幅度`d`。`r`使用 IEEE 754 舍入到最近模式计算并舍入到最接近的可表示值。

在你的情况下`n/d`是负面的，所以结果是负面的。

有关更多详细信息，请参阅[有关模数的 Wikipedia 条目](http://en.wikipedia.org/wiki/Modulo_operation)，包括具有结果符号行为的语言列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T19:16:59.427

有两种类似的运算：取模和取余。模表示更多的数学用法，其余更多的 IT 用法。

假设我们有两个整数，a 和 b。

MOD(a, b) 将返回与 b 具有相同符号的结果。

REM(a, b) 将返回一个与 a 符号相同的结果。- 这就是在 C/C++/C# 中作为 % 运算符实现的内容，并且经常被混淆地称为“mod”

你也可以这样想：

MOD(a, b) 将找到小于 a 的 b（称为“c”）的最大整数倍，并返回 (a - c)。

例如 MOD(-340,60) 我们发现 c = -360 是小于 -340 的 60 的最大倍数。所以我们做 (-340 - (-360)) = 20。

REM(a, b) 将返回一个值，使得 (DIV(a,b) * b) + REM(a, b) = a，其中 DIV() 表示整数除法。

所以对于 r = REM(-340, 60)

-340 = DIV(-340,60) * 60 + r = -5 * 60 + r = r - 300

这解决了给我们 r = -40。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T11:52:33.400

-11 < 12，所以我“假设”它们实际上并没有除：所以 -11 = 0x12 -11

试试 (0-13) % 12

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-30T20:50:17.470

你说 MOD(a,b) 将返回一个与 b 符号相同的结果，但然后说它返回 (ac)，其中 c 小于 a。第二个定义意味着它总是返回一个正数。它是哪一个？

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-01-17T11:54:52.537

数学模块中的 fmod 在 python 中的行为正确：

```
>>> from math import *
>>> fmod(-11, 12)
-11.0 
```

-11 是正确答案..

# database - 实体/属性替代 - 动态创建的表

> ID：453187
> 
> 赞同：2
> 
> 时间：2009-01-17T11:48:01.803
> 
> 标签：database, database-design, schema

我喜欢纯粹的关系设计，但有时需要一种实体/值方法来存储数据。尤其是用户需要频繁创建新类型数据的地方。

我在一些商业软件中看到他们动态创建标准表而不是使用 EV 表。

显然，这不是一个解决所有问题的解决方案，只有在您限制可以定义的数据种类时才能工作。但是，它有以下好处：-

*   该模型已明确定义 - 您无需询问架构即可理解架构。
*   您可以获得更好的性能，因为表只保存该类型数据的数据，因此不需要查询明显不相关的行。
*   同样，索引只保存表定义的数据类型的值，再次提高了性能。（即在 EV 模型中，如果索引是 valueid,entityid - 您将搜索与查询无关的实体的值 - 除非您对索引进行分区）。

所以对我来说，这听起来很棒，但是如果把这个想法通过 DBA，你会吃很多苦头。这是一个好主意，有什么陷阱，有没有人尝试过这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T12:10:21.243

首先：应用程序不应该能够改变数据库结构，因为他们没有权限这样做。

第二：我认为创建一个好的解决方案来动态创建一个**好的**数据库结构的开销不会得到回报。

第三：如果操作不当，可能会对使用数据库的其他事情（备份和维护脚本、其他应用程序等）造成一些严重的副作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T12:23:37.160

不久前，我构建了一个在线调查应用程序。我使用混合形式作为数据库模式：

*   最初将值存储在键/值表中。
*   使用动态的临时表，因为键/值对在每次调查时都转换为自定义表。
*   填充这些临时表可以通过一条繁重的`INSERT INTO temp_table SELECT ...`语句完成，使用大量的`LEFT JOIN`s。

这种方法非常适合这个特定的应用程序，因为调查通常有一个插入答案的阶段和一个分析结果的阶段。

*   构建临时表有时可能很耗时，但只需在调查结束后完成一次。
*   之后查询结果表非常快。
*   如果临时表被删除或过期，则会自动重新创建它们。因此，他们不必备份。

所以我的建议是：考虑一下预期用途是什么。这个例子只是因为这个应用程序的特定要求而制定的。您主要是插入和更新值（OLTP）吗？或者您想运行聚合查询 (OLAP)？根据此问题的答案构建您的架构。

# unicode - 屏幕阅读器如何处理省略号 unicode 字符？

> ID：453189
> 
> 赞同：3
> 
> 时间：2009-01-17T11:49:46.993
> 
> 标签：unicode, accessibility, screen-readers

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T17:59:27.140

This depends on the screen reader. In particular, most screen readers have a number of punctuation settings such as "some", "most", and "all". So it depends which category the screen reader puts the ellipses character into, which punctuation setting the user has selected, and what action the user is taking.

For example, in the JAWS for Windows screen reader (www.FreedomScientific.com) the ellipses isn't read when reading the document, but is read when navigating by letter or word.

I appreciate that's not a definitive answer, but my personal opinion is that you shouldn't avoid this character purely for accessibility reasons - each screen reader is different and this behaviour will probably change at some point in the future.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T15:13:09.563

The tools provided with the microsoft speach SDK 5.1 just skip over ellipsis, including the one you quoted. I was expecting it to at least pause but there was no noticeable pause.

# xml - 仅使用 XPath 选择第一个实例？

> ID：453191
> 
> 赞同：21
> 
> 时间：2009-01-17T11:50:06.900
> 
> 标签：xml, xpath

我正在解析一些类似这样的 XML：

```
<root>
    <some_gunk/>
    <dupe_node>
        ...
        stuff I want
        ...
    </dupe_node>
    <bits_and_pieces/>
    <other_gunk/>
    <dupe_node>
        ...
        stuff I don't want
        ...
    </dupe_node>
    <more_gunk/>
</root> 
```

XPath`'//dupe_node'`将为我提供两个`dupe_node`可玩的实例。我只想遍历第一个。我可以用 XPath 做到这一点吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-01-17T19:47:22.443

```
/descendant::dupe_node[1] 
```

`//dupe_node[1]`通常是错误的，尽管在这种特殊情况下它会产生相同的结果。[请参阅文档](http://www.w3.org/TR/xpath#path-abbrev)：

> 位置路径//para[1] 与位置路径/descendant::para[1] 的含义不同。后者选择第一个后代 para 元素；前者选择作为其父母的第一个 para 孩子的所有后代 para 元素。

给定以下 XML：

```
<foo>
    <bar/>
    <foo>
        <bar/>
    </foo>
</foo> 
```

`//bar[1]`将产生两个节点，因为两个条都是它们各自父节点的第一个子节点。

`/descendant::bar[1]`将只给出一个节点，它是文档中所有条的第一个。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-17T11:55:27.623

```
//dupe_node[1] 
```

XPath 从 1 开始计数，在这种情况下不是 0。您可以使用此工具在浏览器中进行尝试：

[http://www.xmlme.com/XpathTool.aspx?mid=82](http://www.xmlme.com/XpathTool.aspx?mid=82)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T11:52:30.547

//dupe_node[1]

# javascript - 在 JavaScript 中复制到剪贴板

> ID：453198
> 
> 赞同：4
> 
> 时间：2009-01-17T11:54:54.613
> 
> 标签：javascript, clipboard

有没有办法通过 JavaScript 更改用户的剪贴板？

我希望他们单击​​地图上的给定点，并将该位置的坐标添加到剪贴板。

但是，我确实假设 JavaScript 无法实现这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T12:15:39.720

您可以尝试使用[zeroclipboard](http://code.google.com/p/zeroclipboard/ "零剪贴板")库，该库涉及在页面上放置一个不可见的 flash 元素来将文本实际复制到剪贴板。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T12:05:01.877

它存在于 Internet Explorer 中，但不存在于其他浏览器中，尽管可以通过在每次您想要复制时插入[Flash文件在其他浏览器中](http://en.wikipedia.org/wiki/Adobe_Flash)[一起破解支持。](http://www.webtips.co.in/javascript/copy-to-clipboard-with-javascript-on-mozilla-firefox-and-ie.aspx)我想说不是很有用，因为它也[带来了可用性缺陷](http://www.rodsdot.com/ee/cross_browser_clipboard_copy_with_pop_over_message.asp)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T12:03:49.993

如果我没记错的话，在 Internet Explorer 中是可能的（也许该站点必须在“受信任”区域中），但在 Firefox 或 Opera 中是不可能的。

# dos - 在 Dosbox 0.72 下运行 DOS 游戏

> ID：453200
> 
> 赞同：0
> 
> 时间：2009-01-17T11:57:00.677
> 
> 标签：dos, dosbox

我正在使用 Windows Vista 和 Dosbox 0.72 来加载 Turbo C 来编写 DOS 游戏。只要我的代码在 Turbo C 的 DOS shell 下运行（在 Dosbox 下），它就可以正常运行（图形和声音例程）。但是当我在 DosBox（Turbo C 的 Dos shell 之外）下运行相同的代码时，图形会闪烁、变慢并且声音会破裂。怎么了？？

普拉莫德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T20:15:14.633

也许您的程序在独立运行时会占用太多内存。您可以使用 MEM 命令确定有多少内存可用，并在使用 LOADFIX 命令运行程序之前减少此数量。可以多次运行 LOADFIX 命令，每次都会减少系统的可用内存

# yahoo - 有人知道雅虎通 Http 请求吗？

> ID：453206
> 
> 赞同：1
> 
> 时间：2009-01-17T12:04:52.767
> 
> 标签：yahoo

看到 yahoo messenger 客户端可以在 http 请求模式下运行，他们的 webmessenger 也可以这样做，有没有人知道有关“此协议”、登录请求、发送消息请求、接收消息等的详细信息...，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T12:11:24.767

看看[http://www.pidgin.im/](http://www.pidgin.im/)是怎么做的。应该有一个库，其中包含用于与 yahoo 一起工作的所有代码。您可能想使用他们的 libpurple ( [http://developer.pidgin.im/wiki/WhatIsLibpurple](http://developer.pidgin.im/wiki/WhatIsLibpurple) ) 库，因为它是免费的，而且我想很容易使用（虽然从未使用过）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-28T07:33:58.350

您可以使用这个**IM SDK Yahoo**库。

`sending messages`这里给出了,的所有代码`receiving messages`。您可以导入联系人以及与之相关的所有内容。

该库位于`java`. [https://github.com/aldrinm/messenger-sdk](https://github.com/aldrinm/messenger-sdk)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-17T17:33:01.900

你可以使用这个：http: [//developer.yahoo.com/messenger/guide/chapterintrotomessengersdk.html](http://developer.yahoo.com/messenger/guide/chapterintrotomessengersdk.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T12:12:21.020

您可以使用 Wireshark 来研究协议。虽然，我认为互联网上一定有一些关于这个的东西。你有谷歌搜索雅虎信使网络协议吗？

# algorithm - 如何计算一个人的年、月、日年龄？

> ID：453208
> 
> 赞同：19
> 
> 时间：2009-01-17T12:05:02.767
> 
> 标签：algorithm, datetime, math

我想计算一个人的年龄，给定出生日期和相对于当前日期的年、月和日的当前日期。

例如：

```
>>> calculate_age(2008, 01, 01)
1 years, 0 months, 16 days 
```

任何指向执行此操作的算法的指针都将受到赞赏。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-18T08:02:06.563

首先，请注意假设，例如，如果您出生于 2 月 1 日，那么在接下来的 3 月 1 日，您正好 1 个月大，即使您的天龄仅为 28 岁 - 小于平均一个月的长度. 年份也有可变长度（由于闰年），这意味着您生日时的年龄通常不是精确的整数年数。如果您想以年/月/日的形式表达您活着的确切时间，请参阅我的其他答案。但更有可能你想把它捏得恰到好处，所以在 2 月 1 日出生意味着每年 2 月 1 日你是 X 年 0 个月零 0 天，而在任何一个月的 1 日你都是 X 年 Y 个月，和 0 天。

在这种情况下，请继续阅读。（注意：以下仅适用于过去的日期。）

给定一个出生`(y,m,d)`日期，当前日期，`(ynow,mnow,dnow)`和一个`tm()`给出[给定日期的 unix/epoch 时间](https://stackoverflow.com/questions/95492/convert-a-date)的函数，下面将输出一个 3 元素列表，给出年龄为 {年、月、日}：

```
t0 = y*12 + m - 1;        # total months for birthdate.
t = ynow*12 + mnow - 1;   # total months for Now.
dm = t - t0;              # delta months.    
if(dnow >= d) return [floor(dm/12), mod(dm,12), dnow-d];
dm--; t--;
return [floor(dm/12), mod(dm,12), 
        (tm({ynow,mnow,dnow}) - tm({floor(t/12), mod(t,12)+1, d}))/60/60/24]; 
```

如果您不喜欢所有楼层和模组，以下是等效算法。但我认为上面的更好。一方面，它避免`tm()`在不需要时调用。

```
{yl, ml} = {ynow, mnow};
if(mnow < m || mnow == m && dnow < d) yl--;
if(dnow < d) ml--;
years = yl - y;
months = ml + 12*(ynow - yl) - m;
yl = ynow;
if(ml == 0) { ml = 12; yl--; }
days = (tm({ynow, mnow, dnow}) - tm({yl, ml, d}))/60/60/24;
return [years, months, days]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T12:25:28.403

这不是一个简单的问题，因为上述日子（如果我们不考虑[闰秒](http://en.wikipedia.org/wiki/Leap_second)）没有简单的公式。

月份可以由 28、29、30 或 31 天组成；年可以是 365 或 366 天。因此，当您尝试计算月和年的完整时间单位时，就会出现问题。

这是一篇[有趣的文章](http://www.javaworld.com/javaworld/jw-03-2001/jw-0330-time.html)，它考虑了用 Java 解决问题的所有复杂方面。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-18T06:05:17.003

这里的其他人有正确的想法 - 您只需要能够将其扩展到其他语言。许多计算机系统从特定点（“纪元”或“参考日期”）开始以秒为单位计算时间，并从那里计算出日期，并提供从秒转换为日期的方法。您应该能够以秒为单位获取当前时间，将出生日期转换为纪元的秒数​​，减去两个值，然后将其除以一天中的秒数：

```
int timenow = time(0);
struct tm birthday = { tm_mday = 16 , .tm_mon = 1 , .tm_year = 1963 };
int timebirth = mktime( &birthday_tm );
int diff_sec = timenow - timebirth;
int days = diff_sec / ( 24 * 60 * 60);
printf("%d - %d = %d seconds, or %d days\n", timenow, timebirth, diff_sec, days); 
```

此特定代码中的错误是 mktime() 无法处理纪元之前的日期，即 1970 年 1 月 1 日在基于 Unix 的系统中。其他系统上也会存在类似问题，具体取决于它们如何计算时间。一般算法应该可以工作，你只需要知道你对特定系统的限制。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T18:53:13.800

如果您愿意违反“我的生日应该是整数岁”的原则，这是一种方法。请注意，由于闰年，该原则并非严格正确，因此以下内容实际上更准确，尽管可能不太直观。如果您想知道某人的实际确切年龄，我会这样做。

首先将出生日期和当前时间都转换为纪元时间（自时间黎明以来的秒数，即 unix 领域的 1970 年）并减去它们。例如，请参阅这个问题以了解如何做到这一点： [How do I convert a date/time to epoch time (aka unix time -- seconds since 1970) in Perl？](https://stackoverflow.com/questions/95492/how-do-i-convert-a-date). 您现在拥有该人的确切年龄（以秒为单位），需要将其转换为“36 岁 3 个月 8 天”之类的字符串。

这是执行此操作的伪代码。删除几周或几小时或任何您不想要的部分应该很简单......

```
daysInYear = 365.2425;  # Average lengh of a year in the gregorian calendar.
                        # Another candidate for len of a year is a sidereal year,
                        # 365.2564 days.  cf. http://en.wikipedia.org/wiki/Year
weeksInYear = daysInYear / 7;
daysInMonth = daysInYear / 12;
weeksInMonth = daysInMonth / 7;
sS = 1;
mS = 60*sS;
hS = 60*mS;
dS = 24*hS;
wS = 7*dS;
oS = daysInMonth*dS;
yS = daysInYear*dS;

# Convert a number of seconds to years,months,weeks,days,hrs,mins,secs.
seconds2str[secs] 
{
  local variables:
    y, yQ= False, o, oQ= False, w, wQ= False,
    d, dQ= False, h, hQ= False, m, mQ= False, s= secs;

  if(secs<0) return "-" + seconds2str(-secs);  # "+" is string concatenation.

  y = floor(s/yS);
  if(y>0) yQ = oQ = wQ = dQ = hQ = mQ = True;
  s -= y * yS;

  o = floor(s/oS);
  if(o>0) oQ = wQ = dQ = hQ = mQ = True;
  s -= o * oS;

  w = floor(s/wS);
  if(w>0) wQ = dQ = hQ = mQ = True;
  s -= w * wS;

  d = floor(s/dS);
  if(d>0) dQ = hQ = mQ = True;
  s -= d * dS;

  h = floor(s/hS);
  if(h>0) hQ = mQ = True;
  s -= h * hS;

  m = floor(s/mS);
  if(m>0) mQ = True;
  s -= m * mS;

  return
    (yQ ? y + " year"  + maybeS(y) + " " : "") + 
    (oQ ? o + " month" + maybeS(o) + " " : "") + 
    (wQ ? w + " week"  + maybeS(w) + " " : "") + 
    (dQ ? d + " day"   + maybeS(d) + " " : "") + 
    (hQ ? dd(h) + ":" : "") + 
    (mQ ? dd(m) + ":" + dd(round(s)) + "s" : s + "s");
}

# Returns an "s" if n!=1 and "" otherwise.
maybeS(n) { return (n==1 ? "" : "s"); }

# Double-digit: takes a number from 0-99 and returns it as a 2-character string.
dd(n) { return (n<10 ? "0" + tostring(n) : tostring(n)); } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T02:10:14.107

由于年、月甚至日的长度可能不均匀，因此您不能通过减去两个日期来获得简单的持续时间。如果您希望结果与人类对待日期的方式相匹配，则必须使用实际日期，使用您的语言的内置函数，这些函数比以往任何时候都更好地理解日期。

该算法的编写方式取决于您使用的语言，因为每种语言都有一组不同的函数。我自己在 Java 中的实现，使用了笨拙但技术上正确的 GregorianCalendar：

```
Term difference (Date from, Date to) {
    GregorianCalendar cal1 = new GregorianCalendar();
    cal1.setTimeInMillis(from.getTime());

    GregorianCalendar cal2 = new GregorianCalendar();
    cal2.setTimeInMillis(to.getTime());

    int years = cal2.get(Calendar.YEAR) - cal1.get(Calendar.YEAR);
    int months = cal2.get(Calendar.MONTH) - cal1.get(Calendar.MONTH);
    int days = cal2.get(Calendar.DAY_OF_MONTH) - cal1.get(Calendar.DAY_OF_MONTH);
    if (days < 0) {
        months--;
        days += cal1.getActualMaximum(Calendar.DAY_OF_MONTH);
    }
    if (months < 0) {
        years--;
        months += 12;
    }
    return new Term(years, months, days);
} 
```

这可能并不完美，但它提供了人类可读的结果。Term 是我自己的一个类，用于存储人类风格的句点，因为 Java 的日期库没有。

对于未来的项目，我计划转移到更好的 Joda 日期/时间库，其中确实有一个 Period 类，并且可能必须重写这个函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T10:29:17.450

这是使用数学的借用规则。

```
 DateTime dateOfBirth = new DateTime(2000, 4, 18);
        DateTime currentDate = DateTime.Now;

        int ageInYears = 0;
        int ageInMonths = 0;
        int ageInDays = 0;

        ageInDays = currentDate.Day - dateOfBirth.Day;
        ageInMonths = currentDate.Month - dateOfBirth.Month;
        ageInYears = currentDate.Year - dateOfBirth.Year;

        if (ageInDays < 0)
        {
            ageInDays += DateTime.DaysInMonth(currentDate.Year, currentDate.Month);
            ageInMonths = ageInMonths--;

            if (ageInMonths < 0)
            {
                ageInMonths += 12;
                ageInYears--;
            }
        }
        if (ageInMonths < 0)
        {
            ageInMonths += 12;
            ageInYears--;
        }

        Console.WriteLine("{0}, {1}, {2}", ageInYears, ageInMonths, ageInDays); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-24T05:56:35.467

dreeves 答案的 Swift 实现。

附言。我使用两个 NSDate 而不是 (y,m,d) (ynow,mnow,dnow) 作为输入，这在实际使用中可能更方便。

```
extension NSDate {

    convenience init(ageDateString:String) {
        let dateStringFormatter = NSDateFormatter()
        dateStringFormatter.dateFormat = "yyyy-MM-dd"
        dateStringFormatter.locale = NSLocale(localeIdentifier: "en_US_POSIX")
        let d = dateStringFormatter.dateFromString(ageDateString)!
        self.init(timeInterval:0, sinceDate:d)
    }

    func ageFrom(date: NSDate) -> (Int, Int, Int) {
        let cal = NSCalendar.currentCalendar()

        let y = cal.component(NSCalendarUnit.Year, fromDate: date)
        let m = cal.component(NSCalendarUnit.Month, fromDate: date)
        let d = cal.component(NSCalendarUnit.Day, fromDate: date)
        let ynow = cal.component(NSCalendarUnit.Year, fromDate: self)
        let mnow = cal.component(NSCalendarUnit.Month, fromDate: self)
        let dnow = cal.component(NSCalendarUnit.Day, fromDate: self)

        let t0 = y * 12 + m - 1       // total months for birthdate.
        var t = ynow * 12 + mnow - 1;   // total months for Now.
        var dm = t - t0;              // delta months.
        if(dnow >= d) {
            return (Int(floor(Double(dm)/12)), dm % 12, dnow - d)
        }
        dm--
        t--
        return (Int(floor(Double(dm)/12)), dm % 12, Int((self.timeIntervalSince1970 - NSDate(ageDateString: "\(Int(floor(Double(t)/12)))-\(t%12 + 1)-\(d)").timeIntervalSince1970)/60/60/24))
    }

}

// sample usage
let birthday = NSDate(ageDateString: "2012-7-8")
print(NSDate().ageFrom(birthday)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-07-07T08:23:23.320

我认为这些问题不仅仅是一种编程语言。如果您使用的是 C#，则可以使用 DateTimeOffset 来计算它。

```
var offset = DateTimeOffset.MinValue;
var lastDate = DateTime.Today;
var firstDate = new DateTime(2006,11,19);

var diff = (lastDate- firstDate);
var resultWithOffset = DateTimeOffset.MinValue.AddDays(diff.TotalDays);
var result = resultWithOffset.AddDays(-offset.Day).AddMonths(-offset.Month).AddYears(-offset.Year); 
```

`result.Day`, `result.Month`,`result.Year`将保存您需要的信息。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-27T09:15:12.637

我知道它有点过时了，但这是我使用的一个简单代码，它具有 Python 库的强大功能（用于注释的 Python 3.5，但没有）。

```
from datetime import date, timedelta

def age(birth: date) -> (int, int, int):
        """
            Get a 3-int tuple telling the exact age based on birth date.
        """
        today_age = date(1, 1, 1) + (date.today() - birth)
        # -1 because we start from year 1 and not 0.
        return (today_age.year - 1, today_age.month - 1, today_age.day - 1) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-12T17:41:58.847

### 此算法打印下一个格式 -> 24 年，8 个月，2 天

```
from dateutil.relativedelta import *
from datetime import date

def calc_age(dob):
  today = date.today()
  age = relativedelta(today, dob)
  print str(age.years)+" Years, "+str(age.months)+" Months,"+str(age.days)+" Days"

#test it
calc_age(date(1993,10,10)) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-07-18T08:11:09.047

您可以使用 PHP date_diff [http://php.net/manual/en/function.date-diff.php](http://php.net/manual/en/function.date-diff.php)或[http://www.php.net/manual/en/datetime.diff.php](http://www.php.net/manual/en/datetime.diff.php)来实现您想要的和你可以使用 PHP 日期格式以任何你想要的格式输出它

`$interval = date_diff(date_create(), date_create('2008-01-01 10:30:00')); echo $interval->format("You are %Y Year, %M Months, %d Days, %H Hours, %i Minutes, %s Seconds Old");`

结果： `You are 04 Year, 04 Months, 1 Days, 00 Hours, 56 Minutes, 36 Seconds Old`

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2009-01-17T12:13:42.843

由于您显然在使用 python：创建日期时间对象，一个带有“生日”，一个带有“现在”，减去它们并从生成的 timedelta 对象中读取年龄。

为什么要为闰年之类的事情烦恼？

# jquery - 如何使用 JQuery 获取总 Json 记录数？

> ID：453209
> 
> 赞同：29
> 
> 时间：2009-01-17T12:06:07.897
> 
> 标签：jquery, json

我找不到任何关于使用 jQuery 获取 JSON 总记录数的信息。

这是返回的 JSON：

`{"Email":"Please enter your Email.","Password":"Please enter a password."}`

这是我的代码：

```
$(function() {
    $("#btnSubmit").click(function() {
        $.ajax({
            url: "/account/signup",
            type: "POST",
            dataType: "json",
            data: { 
                Email: $("#strEmail").val(),
                Password: $("#strPassword").val()
            },
            success: function(j) {
                    $(".errMsg").hide();
                    alert(j.length); // I couldn't get the total count
                $.each(j, function(n) {
                    $("#err" + n).html(j[n]);
                    $("#err" + n).show();
                })

            },
            error: function(req, status, error) {
                alert(req);
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-01-17T12:10:05.753

如果你有这样的事情：

```
var json = [ {a:b, c:d}, {e:f, g:h, ...}, {..}, ... ] 
```

然后，你可以这样做：

```
alert(json.length) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-12-14T01:17:54.740

OP 正在尝试计算 JSON 对象中的属性数量。这可以通过迭代器中递增的临时变量来完成，但他似乎想在迭代开始之前知道计数。[本页](http://www.webdeveloper.com/forum/showthread.php?t=168120)底部提供了一个满足需要的简单功能。

这是对我有用的代码的剪切和粘贴：

```
function countProperties(obj) {
  var prop;
  var propCount = 0;

  for (prop in obj) {
    propCount++;
  }
  return propCount;
} 
```

这应该适用于 JSON 对象。对于可能从其原型链派生属性的其他对象，您需要添加一个 hasOwnProperty() 测试。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-17T13:14:14.873

在这种情况下你为什么想要长度？

如果您确实想检查长度，请让服务器返回一个带有键值对的 JSON 数组，如下所示：

```
[
  {key:value},
  {key:value}
] 
```

在 JSON 中，[ 和 ] 表示一个数组（带有长度属性），{ 和 } 表示一个对象（没有长度属性）。您可以遍历对象的成员，但您也将获得函数，除了遍历它们之外，对成员数量进行长度检查是无用的。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-03-11T06:54:53.923

尝试以下操作：

```
var count=Object.keys(result).length; 
```

不适用于 IE8 及更低版本。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-17T12:38:58.767

您的 json 不是数组，它没有长度属性。您必须更改数据返回或获取数据计数的方式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-07-23T18:51:57.810

你正在寻找的是

```
j.d.length 
```

**d**是关键。至少在我的情况下，我使用的是 .NET 网络服务。

```
 $.ajax({
            type: "POST",
            url: "CantTellU.asmx",
            data: "{'userID' : " + parseInt($.query.get('ID')) + " }",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(msg, status) {
                ApplyTemplate(msg);
                alert(msg.d.length);
            }
        }); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-01-13T02:48:55.363

也许您可能想先尝试 JSON.parse 您的返回结果，然后您可以通过 .length 获取计数

# flash - 有什么快速的方法可以让 Movieclip 在 Flash 中滚动？

> ID：453216
> 
> 赞同：1
> 
> 时间：2009-01-17T12:10:46.343
> 
> 标签：flash, user-interface, scroll, actionscript-2

我需要一种方法来获取（**容器）MovieClip 中的（****内容**） MovieClip，以便使用滚动条滚动。

 **闪存 AS2 组件

*   **ScrollArea** - 只能滚动外部加载的 SWF。
*   **UIScrollBar** - 只能滚动 TextFields。

如何滚动内部影片剪辑？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T20:05:40.240

AS2 也应该有 ScrollPane 组件（至少我有）。诀窍是您可以将**链接标识符**设置为 contentPath。通过创建一个 MovieClip、在库中右键单击它、选择属性、单击“export for actionscript”复选框，然后在相应的文本字段中输入它来设置链接标识符。

如果您想在运行时将内容放入 ScrollPane 中，这也是您需要做的，然后您将 contentPath 设置为库中的一个空 MovieClip，然后将您的剪辑附加到其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T18:10:11.657

如果您使用的是纯 Flash，请查看 Flash CS3 中包含的 ScrollPane。如果您使用的是 Flex，大多数容器对象都具有滚动功能。

# c# - 接口继承

> ID：453218
> 
> 赞同：9
> 
> 时间：2009-01-17T12:12:20.037
> 
> 标签：c#, interface

如果我有一个界面：

```
interface IFoo
{
    int Offset {get;}
} 
```

我想要这个，可以吗：

```
interface IBar: IFoo
{   
    int Offset {set;}
} 
```

那么 IBar 的消费者将能够设置或获取？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T12:19:57.743

这是接近但没有香蕉。

```
interface IFoo
{
    int Offset { get; }
}

interface IBar : IFoo
{
    new int Offset { set; }
}

class Thing : IBar
{
    public int Offset { get; set; }
} 
```

注意`new`IBar 中的关键字，但这会覆盖 IFoo 的 get 访问器，因此 IBar 没有 get。因此，不，您实际上不能创建只添加一组同时保留现有获取的 IBar。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-17T12:30:42.233

不，你不能！

（我正要写“是”，但在阅读了 Anthony 的帖子并尝试了一些调整后，我发现答案是否定的！）

```
class FooBar : IFoo, IBar
{
    public int Offset{get;set;}
} 
```

（正如 Anthony 指出的那样，会产生一个警告，可以通过添加“new”关键字来修复。）

试用代码时：

```
IBar a = new FooBar();
a.Offset = 2;
int b = a.Offset; 
```

最后一行将产生编译错误，因为您隐藏了 IBar 的 Offset 设置器。

**编辑：**修复了类中属性的可访问性修饰符。谢谢安东尼！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T12:37:27.633

+1 致 Arjan Einbu

当然，IBar 的消费者将无法获得 Offset 属性的值，因为 IFoo 的继承不会改变 IBar 中定义的 Offset 属性的语义 - 编译器会警告您是有原因的。当您使用“new”关键字编译器完全消除歧义并将 IBar.Offset 视为只写。但是，从 IBar 接口继承的*类*的消费者将能够获取和设置 Offset 属性。

如果您使用显式接口实现，则差异会变得更加明显：

```
class Boo: IBar
{
    int IFoo.Offset { get { return 0; } }
    int IBar.Offset 
    {
          set { }  // OK - IBar has a setter
          get { return 1; } // compiler error - IBar.Offset doesn't inherit setter

    }
}

class Program
{
    static void Main(string[] args)
    {
        Boo b = new Boo();
        int x = ((IFoo) b).Offset; // OK - IFoo.Offset has getter
        ((IBar) b).Offset = 1; // OK - IBar.Offset has setter
        x = ((IBar) b).Offset; // compiler error - IBar doesn't inherit 
                               // getter from IFoo
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T12:47:41.777

您可以做的是让 IBar 接口具有 getter 和 setter（没有这个真的没有意义）。当您在 IBar 中只有 setter 时，您实际上是在明确地说“在 IBar 界面上 Offset 属性是只写的”，这显然不是您想要的。

```
interface IFoo 
{ 
    int Offset { get;}
}

interface IBar : IFoo 
{
    new int Offset { get; set; } 
}

class Thing : IBar 
{
    public int Offset
    {
        get;
        set;
    }
} 
```

现在您可以像这样使用 Thing 类：

```
var t = new Thing();
t.Offset = 1;
int read = t.Offset; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-12-18T22:35:18.940

如果属性 getter 和 setter 是独立的实体，定义属性 setter 并从定义属性 getter 的接口继承的接口将允许读写语义。不幸的是，无论出于何种原因，vb.net 和 C# 都不允许它工作。相反，getter 是只读属性，而 setter 是只写属性。如果类型定义了只写属性但继承了只读属性，vb.net 和 C# 将只看到只写属性。如果一个接口继承了一个公开只读属性的接口和一个公开只写属性的接口，则这两个属性都不能在该接口上使用，因为 vb.net 和 C# 都不愿意使用一个属性是read 或written 以确定是使用只读还是只写属性。反而，

如前所述，解决方案是拥有一个接口，该接口继承具有只读属性的接口并实现读写属性。这将隐藏其他只读属性，但如果实现读写属性以返回相同的数据，那应该不是问题。实际上，在 C# 中处理隐式接口实现的方式允许使用相同的代码实现读写和只读接口（vb，有点烦人，需要将“只读”属性与“读写”属性）。

# project-management - 所需的流程指南

> ID：453220
> 
> 赞同：3
> 
> 时间：2009-01-17T12:12:27.540
> 
> 标签：project-management, process

我的公司没有遵循任何定义明确的软件开发流程。我想实施一个适合我公司的简单但有效的流程。

我们拥有从项目经理到开发人员和测试人员的所有资源。

请提供一些我可以使用的参考资料或流程模板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T12:15:41.857

你真的没有描述你公司的特点或你面临的主要挑战，所以很难给出好的建议。如果你想要轻量级的东西，你可以尝试像[scrum](http://en.wikipedia.org/wiki/Scrum_(development))这样的东西，如果你几乎没有或没有现有的流程，这可能是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T12:30:37.677

选择的过程将根据您正在开发的软件类型而有很大差异。游戏开发所需过程的性质与为心脏起搏器开发嵌入式软件所需过程的性质大不相同。

我们在谈论什么样的软件？

干杯，

抢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T14:28:45.003

如果您正在使用 C++ 并考虑在您的流程中包含编码标准，您可能会对这个线程感兴趣：

[轻量级 C++ 编码标准中最关键的元素](https://stackoverflow.com/questions/242728/most-crucial-elements-in-a-light-weight-c-coding-standard)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T14:57:07.257

Jim Highsmith 的书[Agile Software Development Ecosystems](https://rads.stackoverflow.com/amzn/click/com/0201760436)很好地概述了主要的敏捷软件开发方法。我建议从图书馆查看它或购买一份副本，以感受不同的可能性，看看哪种（如果有的话）最适合您的公司和产品。您可能想要查看的其他流程包括 IBM [Rational Unified Process](http://en.wikipedia.org/wiki/IBM_Rational_Unified_Process)（也有一个[敏捷版本](http://www.ambysoft.com/unifiedprocess/agileUP.html)）和[Team Software Process](http://www.sei.cmu.edu/tsp/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T14:36:29.967

如果您正在寻找项目管理模板，[PRINCE2](http://www.prince2.com)是一种有用的项目管理方法。
你可以很容易地用 Prince2 做 Scrum

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T16:38:58.220

你会从你的员工那里得到的反馈是，每个项目都需要稍微不同的过程（取决于项目的规模、复杂性和参数）。

我要做的是为您期望执行的最大项目制定一个流程，然后从中构建一个清单。当你即将开始一个新项目时，拿出检查清单，对项目中的每一部分做出明智的决定，并决定你是否需要使用这部分过程（例如，你可能不需要对一个项目进行压力测试） 3 用户应用程序，但一个门户网站 - 认为你会的 youtube）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T19:47:48.730

正如其他人所建议的那样，如果没有关于您的公司、项目和领域的更多信息，很难给出有价值的建议。当您没有定义的流程时，*任何定义*的流程都会做得更好。

我的建议是从小事做起，而不是全面部署任何给定的方法。找出让你和你的同事最痛苦的事情；理解为什么它是痛苦的，并定义一个可以避免这个陷阱的程序。通过解释遵循程序的价值，尝试让每个人都认同这一点。当团队习惯使用此程序时，请找到下一个问题并执行相同的操作。

我不确定你是否已经有了这个，但如果你没有，你可以做的最重要的事情就是部署问题跟踪工具，如[JIRA](http://www.atlassian.com/software/jira/)或[Trac](http://trac.edgewall.org/)并开始跟踪测试人员发现或报告的问题是什么用户以及他们是如何解决的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-18T11:14:57.593

我们从事定制软件开发，也有一些产品，如工资单应用程序、共同基金和电子商务。我们使用的技术是 .net 2.0 和 sql 2005。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-18T19:30:29.757

在添加模板和流程之前，我认为您需要“反思”您遇到的问题，查看许多可用的基础项目管理/软件开发流程，并确定哪些最适合您的团队，它们将如何实施以及在什么范围内时间框架，如何提供培训等。

其他的，抵制改变的冲动，直到你知道为什么、如何、何时以及谁——并确保你有办法跟踪进展和成功......否则你将不知道你是否实现了你的目标后

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-06T13:09:59.997

流程也是一个治理问题。采用没有管理层参与的治理结构是徒劳的。（尖头发老板说，“我们今天开始写代码！我们周五部署！你聪明的用例不会告诉我如何经营我的商店！”）另外，规模也很重要。许多流程都是让某人检查某人以确保他们正确完成工作的方法。如果您是一个人的团队，那么这相当于您检查自己的工作。开发人员以外的其他人关心流程的情况也很少见。联邦 SDLC、CMMI 是假设数十人热情地关心流程的巨大流程的示例，这是一个经常未被满足的假设。

# sql - 如何获取标识值列 - SQL

> ID：453221
> 
> 赞同：0
> 
> 时间：2009-01-17T12:12:34.810
> 
> 标签：sql, insert, triggers

我有一个将记录从一个表插入到另一个表的过程。目标表有一个名为 LeadId 的标识列

```
 Create Procedure prcInsertPrd
 As
  Begin
   Begin Transaction 
     Declare @Identity int
     Insert into Temp_ProductsArchive (column1,column2,column3)  select   
       (column1,column2,column3) 
    from Temp_Products

   if(@@Error=0)
     Begin
       Commit  
     End
   else
     Begin
       Rollback
     End
  End

```

然后我编写了一个插入触发器，它将从插入的表中获取 LeadId 并将其插入到另一个具有其他值的表中 -

```
 Alter TRIGGER trgInsertTopProducts
   ON  Temp_ProductsArchive
   AFTER INSERT
AS 
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;
     declare @LeadId as int
     Select @LeadId=LeadId from inserted 
     print @LeadId

Insert into Temp_ProductsTop(column4,LeadID,Column5,column6) Select column4,@LeadID 'LeadID',column 5,column6 from Temp_Products
END
GO 

```

问题是我得到的是第一个生成的 LeadiD，而不是所有的 LeadId。Temp_ProductsTop 表中的 LeadiD 列仅针对记录数重复此值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T12:51:46.120

你的触发器有一个大问题。当你编写一个触发器时，你必须假设它可能被多行调用。即该`inserted`表可能包含多于一行，这意味着您必须加入到插入的表中。

我不确定您要在代码中实现什么，但您需要重写如下内容：

```
 Alter TRIGGER trgInsertTopProducts  
    ON  Temp_ProductsArchive 
    AFTER INSERT AS
    BEGIN    
      SET NOCOUNT ON;    
      insert into Temp_ProductsTop 
        (ProductID,LeadID,ProductName,SupplierID,CategoryID,QuantityPerUnit,UnitPrice,UnitsInStock,UnitsOnOrder,ReorderLevel,Discontinued) 
      Select ProductID, inserted.LeadID, ProductName,SupplierID,CategoryID,QuantityPerUnit,UnitPrice,UnitsInStock,UnitsOnOrder,ReorderLevel,Discontinued 
      from 
        Temp_Products
        inner join inserted on inserted.Leadid = ?
    END

GO 
```

在哪里 ？代表您加入的 table.column。是否要为每个 LeadId 添加 temp_products？

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-01-17T12:50:27.107

" `inserted`" 是一个伪表，其中包含插入的每个项目的一行。触发器总共只触发一次，而不是每个插入的条目一次！

您可能需要使用游标来遍历插入的记录，一次处理一个。也许：

```
Alter TRIGGER trgInsertTopProducts
  ON Temp_ProductsArchive
  AFTER INSERT
AS
BEGIN
  -- SET NOCOUNT ON added to prevent extra result sets from
  -- interfering with SELECT statements.
  SET NOCOUNT ON;
  declare @LeadId as int
  declare c CURSOR READ_ONLY for
    select LeadId from inserted

  open c
  fetch next from c into @LeadId
  while @@FETCH_STATUS = 0
  BEGIN
    Insert into Temp_ProductsTop(ProductID,LeadID,ProductName,SupplierID,CategoryID,QuantityPerUnit,UnitPrice,UnitsInStock,UnitsOnOrder,ReorderLevel,Discontinued) Select ProductID,@LeadID 'LeadID',ProductName,SupplierID,CategoryID,QuantityPerUnit,UnitPrice,UnitsInStock,UnitsOnOrder,ReorderLevel,Discontinued from Temp_Products
    fetch next from c into @LeadId
  END
  close c
  deallocate c
END 
```

（请注意，我只是在这里输入的，还没有经过语法检查或测试）

# .net - 使用带有数组参数的 Thread.VolatileWrite()

> ID：453232
> 
> 赞同：3
> 
> 时间：2009-01-17T12:19:15.860
> 
> 标签：.net, multithreading

我想使用`Thread.VolatileWrite()`（或等效函数）来更改`T[]`字段的值，以便所有其他线程立即看到更新后的值。但是，该方法不提供通用版本，并且我无法使用`Object`重载，因为它需要一个`ref`参数。

有替代方案吗？会`Interlocked.Exchange<T>`做这份工作吗？有没有更好的方法来实现我想做的事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T12:46:23.353

`VolatileWrite`仅当您还使用`VolatileRead`;时才有用 修饰符更`volatile`容易使用，但我想知道使用同步是否更简单 - 可能是 a [`ReaderWriterLockSlim`](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)（因为听起来你有很多读者）。

`Interlocked.Exchange<T>`只需将 get 和 set 作为原子操作执行；它（AFAIK）没有做出任何波动性声明（实际上，编译器甚至告诉您一个字段在用作参数时`volatile`不会被视为）。`volatile``ref`

* * *

编辑以澄清“它（AFAIK）没有做出任何波动性声明” - 的行为是可预测的，**只要**它们也使用`Interlocked`，您应该立即在其他线程上看到更新；我的观点是，如果一个线程使用，而另一个依赖于（与同一个字段交谈），我不知道有任何保证。坚持一个或另一个以获得**所有**访问权限。**`Interlocked``Interlocked``volatile`**

 ***** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T12:34:30.697

您也许可以使用[volatile](http://msdn.microsoft.com/en-us/library/x13ttww7.aspx)修饰符。但请查看文档以了解该限制不适用于您的案例。使用它可能会降低性能。

**更新：**关于使用联锁。请注意，文档没有说明更改的值对所有线程都是可见的。所以可能不太一样。但是，如果您处于这种情况，这很重要。您必须进一步调查所有并发灾难的可能性。

# macos - 如何在 Mac 上设置我的默认 shell，例如 Fish？

> ID：453236
> 
> 赞同：218
> 
> 时间：2009-01-17T12:21:22.627
> 
> 标签：macos, terminal, fish

我不喜欢`fish`每次启动终端时都重新输入。我希望默认启用[Fish](https://en.wikipedia.org/wiki/Fish_(Unix_shell))。如何将 Fish shell 设置为 Mac 上的默认 shell？

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2014-10-12T02:06:47.753

**1\. 须藤纳米 /etc/shells** ![在此处输入图像描述](https://i.stack.imgur.com/TTCOg.png)

**2\. 将 /usr/local/bin/fish 添加到你的 shell 列表中** ![在此处输入图像描述](https://i.stack.imgur.com/qHXcI.png)

**3\. chsh -s /usr/local/bin/fish**

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2013-12-10T22:11:02.140

从终端：

1.  将 Fish 添加到`/etc/shells`，这将需要管理密码：

    ```
    sudo echo /usr/local/bin/fish >> /etc/shells 
    ```

2.  使用以下命令将 Fish 设为默认 shell `chsh`：

    ```
    chsh -s /usr/local/bin/fish 
    ```

* * *

从系统偏好设置：

1.  用户和组→ ctrl-单击当前用户→ 高级选项...

2.  将登录外壳更改为`/usr/local/bin/fish`

    ![登录外壳](https://i.stack.imgur.com/I5jTk.png)

3.  按确定，注销并再次登录

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2009-01-17T12:48:48.140

您可以使用[chsh](https://developer.apple.com/library/mac/documentation/Darwin/Reference/ManPages/man1/chsh.1.html)更改用户的 shell。

例如，运行以下代码以将您的 shell 更改为 Zsh

```
chsh -s /bin/zsh 
```

如手册页和 Lorin 所述，如果操作系统不知道 shell，则必须将其添加到其已知列表中：`/etc/shells`.

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2017-07-15T15:29:07.187

这些适用于 macOS v10.12.5 (Sierra) (16F73) 以及可能其他一些最近和即将发布的 macOS 版本。

1.  `chsh`更改默认 shell 是不够的。确保在您的终端打开时按`Command`+ `,`，并将“Shell 打开方式”选项更改为“默认登录 shell”。

2.  如果是 Bash，请确保执行`echo $BASH_VERSION`以确认您正在运行预期版本的 Bash。`bash --version`没有给你正确的信息。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2010-01-10T15:27:05.853

这是另一种方法：

假设您使用[MacPorts](https://en.wikipedia.org/wiki/MacPorts)安装它，可以通过以下方式完成：

```
sudo port install fish 
```

您的外壳将位于`/opt/local/bin/fish`.

你需要告诉 OS X 这是一个有效的 shell。为此，请将此路径添加到`/etc/shells`文件末尾。

完成此操作后，您可以通过转到*System Preferences* → *Accounts*来更改 shell 。单击*锁定*以允许更改。右键单击该帐户，然后选择*“高级选项...”*。在*“登录 shell”*字段中，添加 Fish 的路径。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2017-01-03T18:26:02.653

### *Terminal.app* → *Preferences* → *General* → *Shells open with* → */bin/fish*

1.  打开终端并按`command`+ `,`（逗号）。这将打开一个首选项窗口。
2.  第一个选项卡是“常规”。
3.  找到'Shells open with'设置并选择需要完整路径的第二个选项到shell。
4.  将链接粘贴到您的 fish 命令，通常是*/usr/local/bin/fish*。

请参阅此屏幕截图，其中`zsh`设置为默认值。

[![在 Terminal.app 首选项中输入 /bin/zsh 的屏幕截图](https://i.stack.imgur.com/DzHE9.jpg)](https://i.stack.imgur.com/DzHE9.jpg)

我正在使用[macOS v10.12](https://en.wikipedia.org/wiki/MacOS_Sierra) (Sierra)。它也适用于[macOS v10.14](https://en.wikipedia.org/wiki/MacOS_Mojave) (Mojave)。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2014-06-05T22:22:11.413

唯一对我有用的是所有这些方法的组合。

1.  首先，我必须将 Fish 可执行文件的路径添加到`/etc/shells`文件中

2.  然后我跑了`chsh -s /usr/local/bin/fish`

3.  最后，我输入`Command`+`,`并添加`/usr/local/bin/fish`到那里的默认路径

只有在我完成所有三件事之后，Fish 才开始作为新终端窗口的默认值弹出。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-09-28T11:22:55.743

在[macOS v10.14](https://en.wikipedia.org/wiki/MacOS_Mojave) (Mojave) 上，我必须执行以下操作（以[Z shell](https://en.wikipedia.org/wiki/Z_shell) ( `zsh`) 为例）：

```
brew install zsh
sudo sh -c "echo $(which zsh) >> /etc/shells"
chsh -s $(which zsh) 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-03-05T20:35:17.237

如何在现代 macOS 上获取最新版本的 Bash（在[macOS v10.14](https://en.wikipedia.org/wiki/MacOS_Mojave) (Mojave) 上测试）。

```
brew install bash
which bash | sudo tee -a /etc/shells
chsh -s $(which bash) 
```

然后你准备好[获得 Vim 风格的选项卡完成](https://stackoverflow.com/a/48514114/117471)，它只在 Bash >= 4 上可用（[Homebrew](https://en.wikipedia.org/wiki/Homebrew_(package_manager))中的当前版本是 5.0.2）：

```
# If there are multiple matches for completion, Tab should cycle through them
bind 'TAB':menu-complete

# Display a list of the matching files
bind "set show-all-if-ambiguous on"

# Perform partial completion on the first Tab press,
# only start cycling full results on the second Tab press
bind "set menu-complete-display-prefix on" 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2019-07-11T18:04:08.020

这对我来说适用于全新安装[Mac OS X v10.12](https://en.wikipedia.org/wiki/MacOS_Sierra) (Sierra)：

1.  将当前用户定义为 shell 的所有者

    ```
    sudo chown $(whoami) /etc/shells 
    ```

2.  将 Fish 添加到文件*/etc/shells*

    ```
    sudo echo /usr/local/bin/fish >> /etc/shells 
    ```

3.  *[使用chsh](https://linux.die.net/man/1/chsh)*使[Fish](https://en.wikipedia.org/wiki/Fish_(Unix_shell))成为您的默认 shell

    ```
    chsh -s /usr/local/bin/fish 
    ```

4.  将root重新定义为shell的所有者

    ```
    sudo chown root /etc/shells 
    ```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-01-17T12:28:04.017

该`chsh`程序将允许您更改默认外壳。它将需要可执行文件的完整路径，因此如果您的 shell 是 Fish，那么它将希望您提供键入时给出的输出`which fish`。

您将看到以“”开头的行`Shell:`。如果您从未编辑过它，它很可能会显示“ `Shell: /bin/bash`”。`/bin/bash`将该路径替换为所需外壳的路径。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2012-01-23T15:36:27.547

在 中时，使用+`Terminal`打开终端首选项。`Command``,`

在常规选项卡上，`Shells open with`：从更改`Default login shell`为`Command`：并使用`/bin/fish`

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-17T12:30:11.127

使用[`dscl`](https://ss64.com/osx/dscl.html)：

```
heimdall:~ leeg$ dscl
Entering interactive mode... (type "help" for commands)
 > cd /Local/Default/Users/
/Local/Default/Users > read <<YOUR_USER>>
[...]
UserShell: /bin/bash
/Local/Default/Users > 
```

只需更改该值（使用中的写入命令`dscl`）。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-10-11T11:21:43.350

如果您在使用其他方式时遇到问题，以下方法适用于[macOS v10.14](https://en.wikipedia.org/wiki/MacOS_Mojave) (Mojave)，但通常应该可以。

```
which fish 
```

将输出路径添加到*System Preferences* → *Users & Groups* → 右键单击*​​ user*，*Advanced Options*。将结果粘贴`which`到归档的*"Login shell:"*中。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-03-27T10:04:12.060

[M1](https://en.wikipedia.org/wiki/Apple_M1) Mac上的[Homebrew](https://en.wikipedia.org/wiki/Homebrew_(package_manager))`/opt/homebrew`应该使用而不是`/usr/local`.

您可以检查[鱼](https://en.wikipedia.org/wiki/Fish_(Unix_shell))的位置`which fish`。对我来说，Fish 是**`/opt/homebrew/bin/fish`**我添加到的位置`etc/shells`。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2021-12-15T12:20:07.797

*   输入`fish`检查是否安装正确，如果安装正确，输入`exit`
*   输入`which fish`，复制路径。
*   类型`sudo sh -c 'echo <your-fish-path-here> >> /etc/shells'`
*   重启你的终端
*   类型`chsh -s <your-fish-path-here>`
*   再次重启终端
*   它现在应该可以工作了。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-05-19T19:01:28.647

要更改 Mac 上的默认 shell，请运行以下命令：

```
chsh -s <name-of-shell> 
```

您可以选择的 shell 列表包括：

1.  /bin/bash
2.  /bin/csh
3.  /bin/破折号
4.  /bin/ksh
5.  /bin/sh
6.  /bin/tcsh
7.  /bin/zsh

因此，如果您想从*/bin/zsh* shell 更改，您的命令将如下所示：

```
chsh -s /bin/zsh 
```

您可以通过运行以下命令查看系统上所有可用的 shell：

```
cat /etc/shells 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-01-14T01:27:46.870

编辑文件*.zshrc*并将其更改为

`exec /bin/bash`

或者你可能喜欢的任何外壳。

奖励：这不需要 root 访问权限，并且适用于 OS X 的每个版本。

唯一的问题是它不会以这种方式读取文件*.bash_profile*；只有当 Bash 作为交互式登录 shell 运行时才会读取它。您必须使用以下内容从文件*.bashrc*中包含它：

```
if [[ "$OSTYPE" == "darwin"* ]]; then
    #local hack on osx.
    if [[ -f $HOME/.bash_profile ]]; then
      . $HOME/.bash_profile
    fi
fi 
```

另外： osx 附带的 bash 版本有点过时，最好安装最新版本的 bash `brew install bash`；在这种情况下，您的 .zshrc 文件应该运行正确的 bash 版本。目前是

`exec /usr/local/Cellar/bash/5.1.8/bin/bash`

# php - 将 MySQL 查询限制为偶数个结果

> ID：453245
> 
> 赞同：2
> 
> 时间：2009-01-17T12:29:39.067
> 
> 标签：php, sql, mysql, mysqli, limit

我有一些 PHP 代码，我需要从 MySQL 数据库返回偶数个结果。我正在使用 mysqli 扩展来执行我的查询。

我的代码目前大致是这样的：

```
//assume we already have a database connection

$query = "SELECT id 
            FROM movies 
           WHERE publish = 1
             AND showimage = 1
        ORDER BY date DESC
           LIMIT 6";

$result = $connection->query($query);

while ($row = $result->fetch_assoc()) {
    //do some stuff
} 
```

如您所见，我将查询限制为 6 行，但在某些情况下，返回的行数会更少。如果只返回 3 行，我想扔掉最后一行，只保留 2 行。

如何在 MySQL 查询或 MySQLi 中执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T12:32:21.417

我可能会在 PHP 中执行此操作，而不是 SQL。在`while`-loop 中，保留一个计数器，当你退出循环时，检查计数器是否。如果它很奇怪，请丢弃最后一次迭代的结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T12:43:47.853

我会想象这样的事情：

```
// row counter
$counter = 1;
// loop through each row
while($row = $result->fetch_assoc()) {
    // If there is more than one row remaining 
    // OR if the current row can be divided by two
    if (($result->num_rows - $counter) > 1 || ($counter % 2)) {
        // result code for even rows
        $counter++;
    } else {
        // break out of the loop
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T12:45:10.533

另一种选择是要求 a`COUNT`并根据结果更改查询：

```
SELECT COUNT(*) FROM movies WHERE publish = 1 AND showimage = 1

```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T13:01:26.100

我不是 PHP 人（自从我看过它以来已经有好几年了）但是....

罗斯提到它，但你想使用

```
$result->num_rows 
```

以某种方式在您的循环中处理结果以保持偶数行。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-17T13:12:45.190

```
$maxResults = $result->num_rows;
if( ($maxResults % 2) = 1)
    $maxResults--; 
```

当 counter 与 相同时`$maxResults`，跳出循环。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-17T14:24:46.323

我的答案只是 mysql，虽然可能不是最好的，但也许有点酷。:-)

```
SELECT size INTO @count FROM (SELECT COUNT(*) as size FROM (SELECT * FROM table LIMIT 6) l) t;
SET @count = @count - (@count % 2);
PREPARE stmt_limit FROM 'SELECT * FROM table LIMIT ?';
EXECUTE stmt_limit USING @count;
DEALLOCATE PREPARE stmt_limit; 
```

脚步：

1.  在第一个语句中，我将您真正得到的结果数量放在了@count 变量中
2.  在第二个语句中，如果变量不均匀，我将变量减一
3.  使用您的查询和占位符为限制准备语句
4.  执行婴儿
5.  解除分配，不知道有没有必要

但是谁知道呢，这可能比 php 解决方案更快……

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-18T00:21:47.187

最简单的方法是一次只抓取两行：

```
while($row1 = $result->fetch_assoc() && $row2 = $result->fetch_assoc()) {
    do_something_with($row1);
    do_something_with($row2);
} 
```

（不是 PHP 人，而是从其他答案中学习语法……）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-04-05T23:13:27.740

夏基，

您的解决方案将完美运行，但您需要稍微修改语法。见下文。

```
while(($row1 = $result->fetch_assoc()) && ($row2 = $result->fetch_assoc()))
{ 
    do_something_with($row1); 
    do_something_with($row2); 
} 
```

另一种方式是您的第二行将取消第一行并且不会显示第一行。现在它将显示两个结果。不错的简单解决方案，顺便说一句。

# xslt - 如何从嵌套循环中访问外部循环中的元素？

> ID：453258
> 
> 赞同：21
> 
> 时间：2009-01-17T12:41:43.007
> 
> 标签：xslt, scope, for-loop

我嵌套了 xsl:for 循环：

```
<xsl:for-each select="/Root/A">
    <xsl:for-each select="/Root/B">
        <!-- Code -->
    </xsl:for>
</xsl:for> 
```

**从内部循环中，如何从外部循环中的当前节点访问属性？**

我不断发现自己在编写这样的代码：

```
<xsl:for-each select="/Root/A">
    <xsl:variable name="someattribute" select="@SomeAttribute"/>
    <xsl:for-each select="/Root/B">
        <!-- Now can use $someattribute to access data from 'A' -->
    </xsl:for>
</xsl:for> 
```

这不能很好地扩展，因为有时我需要访问多条信息并最终为每条信息创建一个变量。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-01-17T12:44:21.720

您可以将整个 /Root/A 结构存储在一个变量中，并引用该变量，而不是为您需要访问的每个属性和子元素创建一个新变量。

```
<xsl:for-each select="/Root/A/">
    <xsl:variable name="ROOT_A" select="."/>
    <xsl:for-each select="/Root/B/">
         <!-- Variable is accessed like this: $ROOT_A/@someAttribute
              Just like a normal XML node -->
    </xsl:for-each>
</xsl:for-each> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-17T13:00:11.517

[Welbog](https://stackoverflow.com/users/52443/welbog)已经很好地回答了它 - 但只是要注意你似乎正在做一个 cartesion (cross) join - 这是故意的吗？如果您正在尝试进行常规连接（使用谓词等），那么您想要查看`<xsl:key/>`- 即声明一个键：

```
<xsl:key name="BIndex" match="/Root/B" use="SomeChildNode"/> 
```

然后在你的谓词中消费：

```
<xsl:for-each select="/Root/A/">
    <xsl:variable name="ROOT_A" select="."/>
    <xsl:for-each select="key('BIndex', LocalNode)">
     <!-- -->
    </xsl:for-each>
</xsl:for-each> 
```

这应该等同于（但比）谓词：

```
 <xsl:for-each select="/Root/B[SomeChildNode = current()/LocalNode]"> 
```

如果要对数据进行*分组*，请查看[Muenchian 分组](http://en.wikipedia.org/wiki/Muenchian_grouping)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-10T07:39:26.713

也可以使用以下内容：

```
 <xsl:for-each select="ns:attribute">
        <name><xsl:value-of select="ns:name" /></name>              
        <xsl:for-each select="ns:value">
        <value><xsl:value-of select="."/></value>       
        </xsl:for-each>
    </xsl:for-each> 
```

用于解析 XML 文档..

```
 <ns:attribute>
      <ns:name>name</ns:name>
      <!--1 or more repetitions:-->
      <ns:value>Rahul</ns:value>
      <ns:value>Sushovan</ns:value>
</ns:attribute> 
```

# visual-studio-2008 - 在 Windows 7 Beta (Build 7000) 上将 Visual Studio 2008 从试用版升级到完整版

> ID：453262
> 
> 赞同：32
> 
> 时间：2009-01-17T12:45:09.380
> 
> 标签：visual-studio-2008

我尝试从试用版 VS2008 升级到完整版……但是，在 Windows 7 Beta 上，没有“升级到 Microsoft Visual Studio 2008”选项……有人知道为什么吗？……还有其他人遇到过这个问题吗？！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2010-03-12T14:08:26.777

这是在 Windows 7 中将 Visual Studio 2008 试用版升级到专业版的或多或少的完整指南。

1.  下载并安装/解压缩 AnVir 任务管理器免费版（便携式版本：[http](http://www.anvir.com/downloads/taskfree.zip) ://www.anvir.com/downloads/taskfree.zip ）
2.  转到开始 -> 控制面板 -> 程序和功能。
3.  选择 Microsoft Visual Studio 2008 Professional ENU，单击列表顶部的卸载/更改。
4.  等待维护程序启动。完成后，从第一个屏幕单击“下一步 >>”。
5.  在第二个屏幕上，您将看到三个选项：“添加或删除功能”、“修复/重新安装”、“卸载 Microsoft Visual Studio 2008”。不要点击其中任何一个。您想要的控件隐藏在这三个选项下。
6.  以管理员身份启动 AnVir 任务管理器。（如果您不这样做，您将无法启用控件。）
7.  在应用程序选项卡中，找到 Microsoft Visual Studio 2008 安装程序 - 维护页面。右键单击该项目并选择“详细信息”。如果您的屏幕足够大，加高现在出现的底部面板可能会有所帮助。
8.  在底部面板中，单击“Windows”。
9.  在底部面板中，展开“Microsoft Visual Studio 2008 Setup - Maintenance Page”。
10.  在出现的列表中，有几个项目似乎没有名称。底部四个有名称的项目是“Visual Studio Setup Banner”。展开这四个命名项目上方的匿名项目。
11.  在新扩展的项目中，您将看到许多行，其图标显示为灰色。这表明它们是隐藏的。对于每个禁用的行，右键单击并选择“可见”，然后右键单击并选择“启用”。不要忘记在此列表中包含标有“升级”的项目 - 这是提交许可证密钥数据的按钮。
12.  检查您的 Visual Studio 维护窗口（我们上次在步骤 5 中查看过此窗口）。您应该会看到用于在此处输入许可证密钥的控件。输入许可证密钥，然后单击“升级”。

如果您在其中一个步骤中遇到困难，则您的维护窗口可能与我的略有不同。在 AnVir 中展开主窗口后，在隐藏控件中四处寻找，直到看到“升级”按钮，然后确保所有与该控件同级的控件都已启用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-12-11T00:17:12.903

这是在 Windows 7 中更新 VS2008 的另一种方法

1.  从微软网站获取 VS2008 的 ISO 文件
2.  使用 WinRAR 提取 ISO 文件（例如 D:\VS2008），或使用[Virtual CloneDrive](http://www.slysoft.com/en/virtual-clonedrive.html)将内容复制到硬盘驱动器。
3.  转到 D:\VS2008\Setup。使用 Notepad.exe 打开文件“setup.sdb” 找到行 [Product Key] Replace the default key with your key（删除所有破折号）保存文件并关闭记事本。
4.  安装VS2008。就这样！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-01-26T13:18:18.360

是的，由于缺少升级按钮和产品密钥字段，因此无法从 Windows 7 上的 Visual Studio 2008 试用版升级。但是可以通过使用 Anvir 任务管理器来恢复它们的可见性。由于未知原因，这些控件在 Windows 7 上被隐藏和禁用，但在 Windows Vista 上正常。恢复升级控件后，我已经成功升级了 Visual Studio。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-08-23T00:47:16.627

对于那些已经安装了 VS2008 并且他们使用编辑 setup.sdb 的解决方案已经很晚了，并且不想安装 AnVir 任务管理器，因为它会给您的 PC 带来不需要的垃圾软件，您可以使用 WinSpy：[http:// www.catch22.net/software/winspy-17](http://www.catch22.net/software/winspy-17)。它对我有用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-15T20:56:50.937

我找到了解决方案。安装 vs2008 前需要输入产品密钥：

在某处提取iso。编辑 Setup\setup.sdb 文件并在 [Product Key] 部分中设置您的产品密钥。然后您可以安装它而无需升级。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-16T04:06:08.043

按照 Denis Avilov 的建议使用 WinSpy 效果很好，不需要安装任何不需要的软件，但是除了启用（并使其可见）“升级”按钮之外，您还必须启用更多的兄弟控件，特别是 5 个“编辑”字段需要输入有效的 Visual Studio 序列号。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T12:50:13.503

如果您可以复制它，则值得将其作为反馈发送（您是否像我一样在每个窗口上都有“发送反馈”链接？）。

我可以试一试，但我已经在我的物理 Windows 7 机器上安装了 Team Suite，所以我需要整理一个新的 VM 来试一试……

但实际上，在 beta Windows 7 上激活升级（真正的）可能不是一个好主意；在某些时候，您将不得不完全从头开始使用该操作系统。我同意，如果该选项*意味着*存在，那么它的缺席就是一个问题。但是我之前没有使用过“试用”，所以我不知道它是否存在！

# php - 可以在 MySQL 表中设置最大行数吗？

> ID：453266
> 
> 赞同：1
> 
> 时间：2009-01-17T12:47:48.093
> 
> 标签：php, mysql

我对 MySQL 中的表有疑问。

我目前正在制作一个网站，其中有供人们下载的文件。现在我想在 MySQL 中创建一个存储最新下载的表，例如如果有人下载 file1.zip，那么它将在表中添加一行包含文件名和日期的行，以便我可以在首页上显示“最近下载的文件”或类似的东西。

而且由于我只需要显示 5-10 个项目，因此我不必在表格中存储更多。所以我想知道的是是否可以为表中的行数设置最大限制。就像设置为 10 并且表中有 10 个条目一样，下次尝试添加一个时，它会自动删除最旧的条目，因此表中始终只有 10 行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T12:53:51.047

查看[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)以自动删除旧行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T12:54:15.787

这可以通过使用触发器（需要 MySQL 5）或设置 cron 作业或类似的东西来解决，定期检查表中的行数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T12:58:02.100

我认为您不能将 MySQL 设置为自动执行（尽管我的 MySQL 并不完全是大师级别，所以我可能错了）所以我认为您可能需要做的是创建一个 INSERT 触发器来删除最旧的行在您执行 INSERT 之前，或编写您的应用程序，使其始终在 INSERT 之前运行 DELETE。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-26T16:28:22.850

给表一个时间戳列，不要插入新行，用最旧的时间戳替换行。

# nhibernate - 通过子实体的平均值查询NHibernate中的实体

> ID：453277
> 
> 赞同：2
> 
> 时间：2009-01-17T12:54:56.690
> 
> 标签：nhibernate

我有一个这样的实体产品：

```
[Class(0, Name = "Product", Table = "Products")]
public class Product
{
    private readonly ISet<ProductPropertyValue> _productPropertyValues;
    private readonly ISet<ProductImage> _productImages;
    private readonly ISet<ProductComment> _productComments;
    private readonly IList<Category> _categories;
    private readonly ISet<Rate> _rates;

    public Product()
    {
        _productPropertyValues = new HashedSet<ProductPropertyValue>();
        _productImages = new HashedSet<ProductImage>();
        _productComments = new HashedSet<ProductComment>();
        _categories = new List<Category>();
        _rates = new HashedSet<Rate>(); ;
    }

    [Id(0, Name = "ProductId", Type = "Int32", Column = "ProductID")]
    [Generator(1, Class = "native")]
    public virtual Int32 ProductId { get; set; }

    [Property(0, Name = "Description", Column = "Description", Type = "string")]
    public virtual String Description { get; set; }

    [Property(0, Name = "ShortDescription", Column = "ShortDescription", Type = "string")]
    public virtual String ShortDescription { get; set; }

    [Property(0, Name = "ProductName", Column = "ProductName", Type = "string")]
    public virtual String ProductName { get; set; }

    [Property(0, Name = "UnitPrice", Column = "UnitPrice", Type = "double")]
    public virtual double UnitPrice { get; set; }

    [Property(0, Name = "UnitsInStock", Column = "UnitsInStock", Type = "int")]
    public virtual int UnitsInStock { get; set; }

    [Property(0, Name = "MainImagePath", Column = "MainImagePath", Type = "string")]
    public virtual String MainImagePath { get; set; }

    [Property(0, Name = "NumberOfSales", Column = "NumberOfSales", Type = "int")]
    public virtual int NumberOfSales { get; set; }

    [Property(0, Name = "NumberOfViews", Column = "NumberOfViews", Type = "int")]
    public virtual int NumberOfViews { get; set; }

    [Property(0, Name = "IsSpecial", Column = "IsSpecial", Type = "boolean")]
    public virtual bool IsSpecial { get; set; }

    [Property(0, Name = "AdditionDate", Column = "AdditionDate", Type = "DateTime")]
    public virtual DateTime AdditionDate { get; set; }

    [Property(Name = "Enabled", Column = "Enabled", Type = "boolean")]
    public virtual bool Enabled { get; set; }

    [Bag(0, Name = "Categories", Lazy = true, Table = "Products_Categories",
        Access = "field.camelcase-underscore", Cascade = "none")]
    [Key(1, Column = "ProductID")]
    [ManyToMany(2, Class = "Category", Column = "CategoryID")]
    public virtual ReadOnlyCollection<Category> Categories
    {
        get { return new ReadOnlyCollection<Category>(_categories); }
    }

    [Set(0, Name = "ProductComments", Lazy = true, Access = "field.camelcase-underscore",
        Cascade = "save-update", Inverse = true)]
    [Key(1, Column = "ProductID")]
    [OneToMany(2, Class = "ProductComment")]
    public virtual ReadOnlyCollection<ProductComment> ProductComments
    {
        get { return new ReadOnlyCollection<ProductComment>(new List<ProductComment>(_productComments)); }
    }

    [Set(0, Name = "ProductImages", Lazy = true, Access = "field.camelcase-underscore",
        Cascade = "save-update")]
    [Key(1, Column = "ProductID")]
    [OneToMany(2, Class = "ProductImage")]
    public virtual ReadOnlyCollection<ProductImage> ProductImages
    {
        get { return new ReadOnlyCollection<ProductImage>(new List<ProductImage>(_productImages)); }
    }

    [Set(0, Name = "ProductPropertyValues", Lazy = true, Access = "field.camelcase-underscore",
        Cascade = "save-update")]
    [Key(1, Column = "ProductID")]
    [OneToMany(2, Class = "ProductPropertyValue")]
    public virtual ReadOnlyCollection<ProductPropertyValue> ProductPropertyValues
    {
        get { return new ReadOnlyCollection<ProductPropertyValue>(new List<ProductPropertyValue>(_productPropertyValues)); }
    }

    [Set(0, Name = "Rates", Lazy = true, Access = "field.camelcase-underscore",
        Cascade = "save-update")]
    [Key(1, Column = "ProductID")]
    [OneToMany(2, Class = "Rate")]
    public virtual ReadOnlyCollection<Rate> Rates
    {
        get { return new ReadOnlyCollection<Rate>(new List<Rate>(_rates)); }
    }

    /// <summary>
    /// Gets everage rate.
    /// </summary>
    /// <value>The everage rate.</value>
    public double AverageRate
    {
        get
        {
            if (_rates.Count != 0)
            {
                return _rates.Average(x => x.Value);    
            }
            return 0;
        }
    }

    /// <summary>
    /// Gets rounded average rate.
    /// </summary>
    /// <value>The rounded average rate.</value>
    public Int32 AverageRateRounded
    {
        get
        {
            return (int)Math.Round(AverageRate);
        }
    }

    /// <summary>
    /// Gets the number of votes.
    /// </summary>
    /// <value>The number of votes.</value>
    public Int32 NumberOfVotes
    {
        get
        {
            return _rates.Count;
        }
    }

    /// <summary>
    /// Add new comment to current product
    /// </summary>
    /// <param name="commentToAdd">Comment to add</param>
    public virtual void AddComment(ProductComment commentToAdd)
    {
        if (commentToAdd != null)
        {
            if (!_productComments.Contains(commentToAdd))
            {
                _productComments.Add(commentToAdd);
            }
        }
    }

    /// <summary>
    /// Delete comment from current product 
    /// </summary>
    /// <param name="commentToDelete"></param>
    public virtual void DeleteComment(ProductComment commentToDelete)
    {
        if (commentToDelete != null)
        {
            if (_productComments.Contains(commentToDelete))
            {
                _productComments.Remove(commentToDelete);
            }
        }
    }

    /// <summary>
    /// Add image to current product 
    /// </summary>
    /// <param name="imageToAdd">Image to add</param>
    public virtual void AddImage(ProductImage imageToAdd)
    {
        if (imageToAdd != null)
        {
            if (!_productImages.Contains(imageToAdd))
            {
                _productImages.Add(imageToAdd);
            }
        }
    }

    /// <summary>
    /// Delete image from current product
    /// </summary>
    /// <param name="imageToDelete">Image to delete</param>
    public virtual void DeleteImage(ProductImage imageToDelete)
    {
        if (imageToDelete != null)
        {
            if (_productImages.Contains(imageToDelete))
            {
                _productImages.Remove(imageToDelete);
            }
        }
    }

    /// <summary>
    /// Add property to current product
    /// </summary>
    /// <param name="valueToAdd">Value to add</param>
    public virtual void AddProrerty(ProductPropertyValue valueToAdd)
    {
        if (valueToAdd != null)
        {
            if (!_productPropertyValues.Contains(valueToAdd))
            {
                _productPropertyValues.Add(valueToAdd);
            }
        }
    }

    /// <summary>
    /// Delete property from current product
    /// </summary>
    /// <param name="valueToDelete">Value to delete</param>
    public virtual void DeleteProperty(ProductPropertyValue valueToDelete)
    {
        if (valueToDelete != null)
        {
            if (_productPropertyValues.Contains(valueToDelete))
            {
                _productPropertyValues.Remove(valueToDelete);
            }
        }
    }

    /// <summary>
    /// Adds rate to current product.
    /// </summary>
    /// <param name="rate">The rate.</param>
    public virtual void AddRate(Rate rate)
    {
        if (rate != null)
        {
            if (!_rates.Contains(rate))
            {
                _rates.Add(rate);
            }
        }
    }

    /// <summary>
    /// Deletes rate from product.
    /// </summary>
    /// <param name="rate">The rate.</param>
    public virtual void DeleteRate(Rate rate)
    {
        if (rate != null)
        {
            if (_rates.Contains(rate))
            {
                _rates.Remove(rate);
            }
        }
    }
} 
```

和这样的 Rate 实体：

```
[Class(0, Name = "Rate", Table = "Rates")]
public class Rate
{
    [CompositeId(1)]
    [KeyManyToOne(2, Name = "Product", Class = "Product", Column = "ProductId")]
    [KeyManyToOne(3, Name = "User", Class = "User", Column = "UserId")]
    public virtual Product Product { get; set; }

    public virtual User User { get; set; }

    [Property(0, Name = "Value", Column = "Value", Type = "Int32")]
    public virtual Int32 Value { get; set; } 
```

}

我需要以 DESC 顺序获取所有具有平均评分的产品。此外，它应该可以通过任何字段过滤`Product`，例如价格：从 1000 美元到 5000 美元。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T23:13:28.330

应该主要按照您的想法工作。

在 HQL 中：

```
select p
from Product p join p.Rates r
where (p.Price >= 1000 and p.Price <= 5000)
order by avg(r.Value) desc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T23:18:01.113

我想玩一点，但我有点懒得设置一个小测试项目。

在任何情况下，如果您想获取这些产品，以概览或类似的方式显示它们，我将使用 Projections 和 AliasToBean 转换器，以便 NHibernate 发出一个更简单的查询，并仅检索这些值您需要显示您的概览。为此，您将必须创建另一个类 offcourse，该类将保存将要检索的值。

# flash - Haxe：没有帧的关键帧动画

> ID：453279
> 
> 赞同：4
> 
> 时间：2009-01-17T12:56:37.063
> 
> 标签：flash, animation, structure, haxe, keyframe

我想在 Haxe (flash9) 中做简单的（循环）动画（移动、改变 alpha 等）。我的库中没有任何类似于框架的东西，只有单帧资产。

因为我是初学者。我不一定要寻找一个复杂的框架。我会对快速而肮脏的东西感到满意。也许`if`检查`frame`（类变量）并线性插值值。

```
class MyClass extends Sprite {
    static var frame:Int = 0;
    static inline var framerate:Int = 25;

    static function main() {
        var app:MyClass = new MyClass();
        flash.Lib.current.addChild(app);
    }

    private function new() {
        super();

        // init assets here

        var myTimer:Timer = new Timer(1000/framerate);
        myTimer.addEventListener(TimerEvent.TIMER, animate);
        myTimer.start();
    }

    function animateForeground(event:TimerEvent) {
        frame = (frame + 1) % 1000;

        // set new values depending on frame
    }

} 
```

我知道关键帧动画的基本思想。我正在寻找更多关于*如何构建这部分程序的*内容。

你能给我一些关于我应该如何进行的指示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T19:58:22.233

如果你想做动画，我非常推荐使用[补](http://code.google.com/p/tweener/)间库，尽管我知道你可能想在“作弊”之前学习基础知识。

我建议将您的动画连接到 ENTER_FRAME 事件，而不是让计时器以与您的帧速率相同的速度运行。真的没有必要将这两者解耦，因为计时器并不比 ENTER_FRAME 事件更可靠，而且如果无论如何都看不到它，也没有必要移动东西。

另外，我认为您不应该过多关注“关键帧”动画。**当您拥有**关键帧时，这是一个有用的概念，如果您没有关键帧，那么做一些感觉是实现这一点的最佳方式会更实用。

我会在这里放一些代码，但是我很难想出任何代码，因为我不确定您要在这里实现什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T05:22:30.307

可能值得一读Robert Penner 书中的[chapter7_tweening.pdf](http://www.robertpenner.com/easing/penner_chapter7_tweening.pdf)，虽然现在在代码方面已经过时，但它涵盖了补间的概念。

但也许不值得重新发明轮子......

[Feffect](http://haxe.org/com/libs/feffects)是一个很好的跨平台补间引擎，[Actuate](http://haxe.org/com/libs/actuate)使用更简单，速度也更快。使用宏进行补间可能是最好的方法，但开始可能有点复杂（[tinkerbell](https://github.com/back2dos/tinkerbell/blob/master/tests/src/tween/TweenTest.hx)）。

# ruby-on-rails - Rails 基于域的缓存

> ID：453287
> 
> 赞同：1
> 
> 时间：2009-01-17T13:05:30.553
> 
> 标签：ruby-on-rails, ruby, caching

Rails 缓存（文件缓存）每个默认基于域，但有没有办法禁用它？我的 rails 应用程序可以通过多个域访问，并且内容都是一样的。我只是不想有多个缓存文件。

（我知道 memcache 更好，这不是问题的一部分）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T13:18:00.203

在您的 中配置资产服务器`environment.rb`，以便从同一个域加载所有静态文件。

# asp.net-mvc - 生成对 Json 友好的结果的最佳方法 (.NET MVC)

> ID：453289
> 
> 赞同：2
> 
> 时间：2009-01-17T13:09:15.227
> 
> 标签：asp.net-mvc, json

我现在使用`ListItem()`Json 格式的结果，但是生成的 Json 文本有一个额外的属性叫做`"selected = false"`，我知道这是用于下拉列表，但我希望我的应用程序运行得更快，所以我不想要这个属性。你知道任何其他方法可以获得类似的结果吗？

这是我的代码：

```
List<ListItem> list = new List<ListItem>() {
    new ListItem() { Text = "Email", Value = "Pls enter your email" },
    new ListItem() { Text = "NameFull", Value = "Pls enter your full name" },
    new ListItem() { Text = "Sex", Value = "Pls choose your sex" }
}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T13:37:41.817

如果您使用的是 ASP.NET MVC Beta，您可以使用 Json 函数和匿名类型将任何对象序列化为 JSON。

```
public JsonResult GetData() {
    var data = new { Text = "Email", Value = "Pls enter your email" }; 
    return Json(data);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T13:23:05.310

根据您的 JSON 序列化程序，您可能会或可能无法告诉序列化程序忽略此属性。

你最好只创建一个只有你需要的字段的类。例如

```
public class MyListItem
{
    public string Text { get;set; }
    public string Value { get;set; }
}

List<MyListItem> list = new List<MyListItem>() {
    new MyListItem() { Text = "Email", Value = "Pls enter your email" },
    new MyListItem() { Text = "NameFull", Value = "Pls enter your full name" },
    new MyListItem() { Text = "Sex", Value = "Pls choose your sex" }
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T13:18:19.233

不要使用`ListItem`- 使用只有您想要的属性的自定义类型。

# c++ - C++; 多核环境中的注意事项

> ID：453293
> 
> 赞同：2
> 
> 时间：2009-01-17T13:12:12.490
> 
> 标签：c++, multithreading

在多核环境中编码时需要注意哪些事项？

例如，对于单例类，最好创建一个全局对象，然后返回其引用，而不是静态对象。

即而不是拥有

```
MyClass & GetInstance()
{

static Myclass singleMyclass;
return singleMyclass;
} 
```

最好有

```
Myclass singleMyclass;

 MyClass & GetInstance()
    {

     return singleMyclass;
    } 
```

GetInstance() 可能被多个线程同时调用。

**编辑：**

我的问题是关于在多线程程序中使用它们时必须注意的 C++ 的隐藏结构。在上述情况下，静态不是线程安全的，因为编译器为静态对象添加了一些指令，这不是线程安全的。我正在寻找一个应该知道的类似结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T13:28:18.340

您必须小心初始化静态变量。在静态对象在其构造函数中做很多事情的复杂系统中，初始化顺序可能会造成严重破坏。

第一种方法更好，因为单例是按需创建的，但是您需要一些锁定以使其线程安全。

第二种方法是线程安全的，因为初始化是在创建任何线程之前完成的（假设您的静态对象没有启动线程运行），但是顺序或初始化可能是一个大问题！如果一个静态对象在实例化 singleMyclass 之前从它的构造函数调用 GetInstance() 怎么办？（提示：它不漂亮！）

我建议使用第一种方法，但请阅读[Double-checked locking](http://en.wikipedia.org/wiki/Double-checked_locking)，但要小心，因为它[实际上不起作用](http://www.ddj.com/184405726)

确保您阅读了 Dobb 博士的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T01:22:35.777

我的第一个答案解决了您的单例初始化示例，但是正如您在对问题的编辑中强调的那样，随着我们转向多核和多线程应用程序，您正在经历 C++ 更普遍的陷阱。以下是您第一次遇到它时的真正惊喜。虽然不是 C++ 特定的，但它肯定会影响 C++ 代码。

**乱序执行和内存屏障（或栅栏）：**

一个问题是执行无序。由于现代硬件允许乱序执行优化，线程有可能看到在不同内核上乱序执行的其他线程的操作。结果，在单核机器上正确运行的多线程编码实际上可能在多核机器上不正确。

解决此类问题的一个简单方法是增加临界区的范围。另一种是使用[内存屏障](http://en.wikipedia.org/wiki/Memory_barrier)或无锁算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T13:16:00.283

多核并不那么重要，因为您也可能在单核系统上获得多个线程。

两个版本的 GetInstance() 看起来都可以在那里工作，如果它们做任何不是线程安全的事情，则需要进行适当的锁定等的类方法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-01-17T15:37:43.617

基于它的标题，我渴望这个问题，但现在完全看不到它的相关性。

多核编程的问题基本上是如何构建程序以使这些内核获得最大负载；换句话说，如何并行化您的应用程序。

在这方面，对于从事 C++ 项目的人来说，一个温暖的建议是[英特尔线程构建模块](http://www.threadingbuildingblocks.org/)库（和[书籍](https://rads.stackoverflow.com/amzn/click/com/0596514808)）。它试图消除问题，将它们隐藏在模板类后面。我认为它做得很好。

# linux - 版本控制可以在多大程度上帮助系统管理？

> ID：453300
> 
> 赞同：4
> 
> 时间：2009-01-17T13:16:42.873
> 
> 标签：linux, version-control, unix, sysadmin, openbsd

我目前正在修补 OpenBSD 系统，以期为自己构建防火墙和其他一些零碎的东西。

由于这是相当实验性的（我是 OpenBSD n00b，并且我已经将我的系统破坏了 3 或 4 次），我想知道其他人在制作部分或全部文件系统方面有什么经验（我特别想/etc) 一些 VCS 或其他的工作副本。

*   这是一个好主意吗？

*   我特别感兴趣的是人们为此使用了哪些 VCS。我正在考虑颠覆、集市和 git；这不会是一个共享存储库，所以我可能对基本的 vcs 功能比分布式或非分布式参数更感兴趣。

*   我还想听听人们发现的想象或实际陷阱。我可以想象文件所有权和权限的保存需要仔细考虑！

*   当然，任何不涉及 VCS 的替代方法

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T13:29:55.450

[在这里](http://bryan-murdock.blogspot.com/2007/07/put-etc-under-revision-control-with-git.html)，您有一个关于使用 git 将 /etc/ 置于修订控制之下的详细修订。

[另一种](http://www.jukie.net/~bart/blog/20070312134706)循序渐进的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T13:34:11.603

对于您正在做的事情，我建议您不要从 OpenBSD 开始，而是从已经完成大部分工作的发行版开始，例如[pfsense](http://www.pfsense.org/)。

至于 VCS 本身，您可能需要考虑[这些项目](http://www.selenic.com/mercurial/wiki/index.cgi/ProjectsUsingMercurial)成功使用的[mercurial](http://www.selenic.com/mercurial)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-28T22:18:29.407

我认为还没有人提到[etckeeper](http://kitenet.net/~joey/code/etckeeper/)。

它将 /etc 存储在 repos（git（默认）、mercurial 或 bzr）中。它解决了保存文件所有权、权限和空目录的问题。它可以与包管理网集成（至少与 apt 集成）以自动提交在安装新包期间发生的更改到 /etc。如果安装使您自己的更改失败，那就太好了，只需回滚即可。

我已经在 Ubuntu 中成功使用了一段时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T13:22:04.000

我在“Gnu/Linux Magazine France”中读到了一些相关内容。这家伙使用 rsync 从 /etc 到 root/ 然后通过 subversion 存储它，而不创建工作副本。

我将引用该杂志的一些内容。

好的，在示例中，服务器运行 freeBSD 并且是“sparky”，而要保存的机器在 debian 下并且是“副本”。创建用户“副本”。

在 /usr/local/etc/ssh/sshd_config 添加：

```
Match User replica
X11Forwarding no
AllowTcpForwarding no
ForceCommand /usr/local/bin/svnserv -t -r /home/replica/svnrepo -tunnel-user=replica 
```

创建存储库

sparky # svnadmin 创建 /home/replica/svnrepo

修复权限：

```
sparky # chown -R replica:nogroup /home/replica
sparky # chown -R o-rwx /home/replica
sparky # chown -R g-rwx /home/replica 
```

客户端：

安装颠覆

```
replica # mkdir -p /root/scripts/svnrepo
replica # rsync -av /etc /root/scripts/svnrepo

export SVN_SSH ="ssh -i /root/.ssh/id_rsa"
svn import -m "replica config files" /root/scripts/svnrepos svn+ssh://replica@sparky/home/replica/svnrepo 
```

现在，我们的文件夹还不是工作副本，所以我们必须制作它。你能创建一个 .svn 文件吗？他不能:)

```
cd /root/scripts
mv svnrepo svnrepo.old
svn checkout svn+ssh://replica@sparky/home/replica/svnrepo 
```

现在尝试修改 etc 中的文件，例如主机。

再次同步。您应该只获取修改后的文件，即复制 /etc/hosts。

现在你可以提交：

```
svn commit -m "backup 1" /root/scripts/svnrepo 
```

还有最后一件事。如果你想让一个文件被颠覆，它必须被添加。因此，例如，如果您在 /etc 中创建一个新文件，默认情况下它不会被保存。

要做什么？

```
svn status /root/scripts/svnrepo | grep -e '^!' | awk '{ print $2 }' | xargs -r svn delete 
svn status /root/scripts/svnrepo | grep -e '^?' | awk '{ print $2 }' | xargs -r svn add 
```

然后，您必须制作自己的脚本。

希望这可以帮助。

（gtg，我稍后会编辑以设置标题，如果没有人这样做的话）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-18T00:14:48.397

不仅仅是在修订控制系统中拥有配置文件，我建议使用诸如[Chef](http://wiki.opscode.com/display/chef/Home)或[Puppet](http://reductivelabs.com/trac/puppet)之类的配置管理系统来管理配置文件的内容、权限和其他详细信息，例如在配置文件更改时重新启动应用程序，以及管理git/subversion/yourfavoriteVCS 中的那些文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-17T18:33:23.060

我管理的每台服务器上的 /etc 中的所有内容（300 + 并且还在计数）都在[Mercurial](http://www.selenic.com/mercurial/wiki/)下。为什么？

*   对于曾经使用过 SVN 或 CVS 的任何人来说，它都易于使用（如果您没有，那么您在我的生产机器上的 /etc 中没有业务）
*   它可以轻松地将更改从一台服务器的配置拉到许多其他服务器
*   当其他管理员有脑子放屁时，我可以快速回滚

在这种情况下，对于太少的问题，Git 的功能太强大了。由于 HG 是 DVCS，因此提交和回滚是干净且容易的。我也使用 HG 来[管理我的大部分网站](http://echoreply.us/tuto/mercurial_site_management.html)。

它不仅适用于源代码 :) 另一个更基本的选择是使用某种版本控制文件系统，它在写入时拍摄快照 (CoW)，DVCS 更容易。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T13:51:26.780

## 反馈：我最终做了什么

（@Aif，感谢您的温柔提醒，我的礼貌有点缺失）

我使用 /etc 作为 git 存储库，但由于我对此（我，不是 git）仍然有点不安，我正在手动执行 gitwork。

作为一个副作用，我开始了一个小项目来评估，并列，颠覆，git，集市，mercurial，单调，darcs，和化石，虽然在更一般的版本管理上下文（合并等）。

* * *

## 我对你的回答的反应

感谢大家的帮助。我在选择接受哪个答案时遇到了一些困难，所以如果不是你的，请相信我，我也很感激你的。

@**路易斯梅尔格拉蒂**

路易斯，感谢您提供了一些出色的参考资料。我已接受您的回答为最有用的。

* * *

@**康拉德**

康拉德，我很欣赏你的两个建议。

我当然会调查*pfsense*，尽管我的目标之一是真正弄脏我的手，以及建立防火墙，所以“制造而不是获取”很重要。

至于 Mercurial，我没有将它包含在我的列表中，因为我已经尝试过（以前），并且我觉得我“更喜欢”集市，而 git 乍一看似乎有很大的力量（诚然，我可能不需要）。我目前的“主要”VCS 是 Subversion，但我不确定它是否适合这种情况。因此列出了三个。

（我现在查看了 pfsense 并在我的网络上启动了它。非常好，但我完全不确定我的手是否会稍微弄脏......）

* * *

@**艾夫**

谢谢，艾夫。我肯定会尝试一下，尽管我怀疑我最终会使用 git。

* * *

@**小叮当**

感谢您对 Mercurial 的看法，我现在计划重新访问，尽管我对 Bazaar 很满意。

* * *

@**每维克兰德**

感谢您提出非常有趣的建议！当我可以从当前的工作堆下脱身时，我肯定会看看 etckeeper。

# qt4 - QProcess setEnvironment 没有效果？

> ID：453306
> 
> 赞同：0
> 
> 时间：2009-01-17T13:22:34.500
> 
> 标签：qt4, vista64

我正在尝试使用 QProcess 启动一个程序（vista64bit 上的 Qt4.4，在 MSVC2005 中开发）。该程序不在路径中，因此我尝试以类似于[QProcess::setEnvironment](http://doc.trolltech.com/4.4/qprocess.html#setEnvironment)文档中演示的方式将程序所在的目录添加到 QProcess 环境中。

不幸的是，程序没有启动，显然是因为在路径中找不到可执行文件。这是一个已知的问题？我做错了吗？

我已经验证了在添加路径后通过打印 QProcess 环境来设置路径。

有两种解决方法：第一种是使用完整路径启动程序，第二种是在启动可执行文件之前将目录添加到路径中，但我都不想使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-19T12:05:55.393

QProcess::setEnvironment() 只影响正在生成的进程的环境，而不影响处理生成的上下文。您需要更改当前环境，以便可以找到您正在生成的应用程序（使用 ::SetEnvironmentVariable() 作为初学者）。

[CreateProcess](http://msdn.microsoft.com/en-us/library/ms682425.aspx) API 的文档中概述了应用程序文件查找。

检查[此指针](http://msdn.microsoft.com/en-us/library/ms682009(VS.85).aspx)以获取示例场景。

# asp.net - VDS 托管中的 ASP.NET Web 应用程序安全性

> ID：453310
> 
> 赞同：0
> 
> 时间：2009-01-17T13:28:23.660
> 
> 标签：asp.net, sql-server, hosting, vps

我们正在 wcsf 中设计 asp.net Web 应用程序。Web 应用程序将部署到 Windows Server 2003 共享[VDS](http://en.wikipedia.org/wiki/Virtual_private_server)主机。网站将用于 b2b、每月服务费和 Web 应用程序中使用的信用卡交易，因此它必须是安全的网站。我想考虑在部署之前必须做些什么，我需要回答几个问题：

1) 我如何复制保护我的网站和我的代码。代码签名是否足够？反光板保护应该怎么做？混淆就够了吗？

2) Windows Server 2003 [VDS](http://en.wikipedia.org/wiki/Virtual_private_server)主机的优缺点如何？

3) MS SQL Server 2005 Express 适合那种商业用途？mssql express（4GB 存储和 1Gb 内存）的限制导致网站出现瓶颈？

4) 以后可以将数据库从 express 版转移到 mssql 2005 工作组版没有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T14:08:58.540

1.  混淆就足够了。代码签名不提供任何防止窥探的保护。此外，大多数受人尊敬的主机商对您的知识产权和数据不感兴趣。归根结底，他们从事托管业务。

2.  我在一家托管公司工作，我们在我们的虚拟化平台上托管的客户数量正在快速增长。对于客户和我们自己来说，其中一个优势是，如果您需要更多 CPU 或内存，我们几乎可以立即添加它们，因为这只是 VM 上的配置设置。最终，这一切都取决于您的供应商如何构建他的虚拟环境。您确实需要收集有关其环境的功能和限制、每个节点通常运行多少台服务器等的更多信息，并确定它是否适合您。

3.  SQL 2005 express 将与完整的 SQL 2005 一样执行。限制在于功能（例如，没有 olap，那种东西），并且正如您正确指出的那样，它可以使用的最大内存量和 DB 的最大大小。但是，如果您超出最大可用内存量，性能将会下降。

4.  SQL 2005 Express 数据库可以毫无问题地备份和恢复到任何 SQL 2005/2008 产品。

在不知道会影响您的应用程序的流量的情况下，很难预测虚拟服务器是否是最佳环境选择。这同样适用于 SQL 2005 express。如果应用程序是数据库密集型应用程序，您可能会发现自己承受着越来越大的内存压力 - SQL Server 拥有的内存越多，它可以缓存的越多。我认为您需要进行一些自己的容量规划，并自己决定现在和以后的最佳解决方案是什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T14:20:52.727

二汗——

您的主要安全目标不是保护您的源代码，*而是保护您的客户数据。* 为此，您必须确保 A) 您的通信是安全的 (SSL) b) 您的代码实现了适当的安全性（不受 SQL 注入攻击）和 c) 您的数据库是安全的。

对于 (A) - 通信安全 - 您需要从[Thawte](http://www.thawte.com)之类的人那里获得 SSL 证书（这是我们使用的人，我喜欢他们）。当您在服务器上安装证书时，您需要确保网站只接受安全 (SSL) 连接 - 至少对于包含敏感数据的所有页面。例如，所有包含信用卡数据的表格都必须通过 SSL 提交。

对于 (B) - 代码安全性 - 这值得一整[本书](https://rads.stackoverflow.com/amzn/click/com/0735618909)！例如，您**不能**仅通过附加从网页收集的表单/请求数据来构造 SQL 调用（这会使您面临*[SQL 注入](http://en.wikipedia.org/wiki/SQL_Injection)*攻击）。 **所有**SQL 参数都必须参数化。等等等等。没有人可以在 SO 帖子中解释安全性 - 你有*很多东西*要学。

对于 (C) - SQL Server 安全性 - 这也是一个复杂的主题，但有几个关键点。根据您的描述，我假设 SQL Server 与您的 Web 应用程序在同一台服务器上运行。这意味着您*不*希望它接受*任何*来自网络的连接。不要试图让它保持打开状态，以便您可以从桌面上的 SQL Management Studio 轻松访问它……这只是可怕的、愚蠢的安全做法。登录远程服务器后，您可以通过远程桌面访问它。此外，禁用“sa”帐户 - 立即执行。在端口 1433 上找到您的人（如果您不禁用所有网络访问）将每分钟每秒对 sa 帐户进行暴力密码猜测，等等。多年。我们每天在为少数客户维护的非网站数据库上获得大约 17,000 个数据。这里还有更多要学习的东西，但如果你采取这两个步骤，你就会很好地覆盖。不过，可以肯定的是，我建议您也运行 MS 安全表面分析工具并遵循它的建议，

至于虚拟机托管，*应该*没问题。[然而， MaximumASP](http://www.maximumasp.com)的专用主机每月仅运行约 199 美元（我使用、推荐和认为是业内最好的！）。我建议您考虑使用自己的专用服务器，以便在证明成功的情况下轻松扩展业务。

对于您的数据库，SQL Server Express 将适用于此，是的，您将来可以升级到 Workgroup Edition。除非您实际达到这些限制，否则数据库限制不会对您的网站造成瓶颈。你需要弄清楚这是否可能。话虽如此，确实*不*建议尝试在免费版本的 MS 数据库上运行专业网站——尤其是一个持有财务数据的网站。无论取得任何成功，您*都*可能会突破这些限制。许多网络托管公司（尤其是MaximumASP）将允许您以最低价格（例如每月25 美元或类似的价格）在您的服务器价格中添加专业版本的SQL Server。

最后，您似乎对 Web 应用程序与 Windows 应用程序有点混淆。在 Web 应用程序中，您的用户将无法访问您的源代码/DLL（IIS 阻止访问各种文件，包括 dll 和 .config 文件）。他们不会下载和安装应用程序，因此您无需对代码进行签名，也无需进行混淆处理。在这种情况下，“反射器保护”对我来说甚至没有意义。

如果您担心*托管公司*会看到您的代码，您应该找一家不同的托管公司。话虽这么说，我只是无法想象任何有信誉的托管公司真的关心看到你的源代码。

祝你好运！

# asp.net - 在 asp.net 权限错误中上传文件（对路径 x 的访问被拒绝）

> ID：453312
> 
> 赞同：1
> 
> 时间：2009-01-17T13:29:08.370
> 
> 标签：asp.net, windows, iis-6, permissions

我正在尝试在我的 asp.net 网络应用程序中上传一些图像文件。

服务器操作系统：Windows server 2003 和 IIS 6

我在 IIS 中授予对根文件夹和目标文件夹的写入权限，并授予此用户 IUSer_Mashinname、Asp.net 用户、网络服务、Everyone 和所有其他用户对 Web 应用程序根文件夹和上传目标文件夹的完全控制访问权限，但是有“访问被拒绝的问题”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-30T01:00:23.820

我遇到了同样的问题，并使用[procmon](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)确定虽然我的应用程序池在 IIS_IUSRS（具有写入和修改权限）下运行，但它正在模拟 IUSR。将 privs 添加到 IUSR 解决了问题

# php - 在 RewriteRule 到 PHP 脚本之后，从 PHP 内部进行内部重定向

> ID：453313
> 
> 赞同：0
> 
> 时间：2009-01-17T13:29:47.557
> 
> 标签：php, apache, mod-rewrite

我有一些 mod_rewrite 重写可以正确地将 URL 重定向到脚本。在脚本中，我想转到另一个文件而不引起另一个请求/更改 URL。

我已经尝试过位置和元刷新，但它们并不像预期的那样流畅。

有没有办法更改脚本甚至将数据返回到重写规则，以便进一步重写？

improfane.domain.com 被发送到从数据库获取用户 ID 的脚本，然后我使用用户 ID 重定向到配置文件页面。我希望它更流畅，没有重定向。这意味着 improfane.domain.com 将保留在 URL 中，而不是转到 domain.com/?profile=6

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T13:45:15.310

您可以使用以下 php 指令之一包含真正的目标文件：

```
include(filename)
require(filename)
include_once(filename)
require_once(filename) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T13:43:18.967

您应该使用[前端控制器](http://www.phppatterns.com/docs/design/the_front_controller_and_php)（也称为[引导程序](http://devzone.zend.com/node/view/id/70)）来确定路由并包含正确的脚本（而不是重定向）。前端控制器是您的应用程序的单一入口点，并允许您按照您认为合适的方式处理路由。

大多数框架都有一个[很好](http://framework.zend.com/manual/en/zend.controller.front.html)的前端控制器实现，但为了简单的目的，你可以自己滚动。

# python - Advice regarding IPython + MacVim Workflow

> ID：453329
> 
> 赞同：19
> 
> 时间：2009-01-17T13:46:27.320
> 
> 标签：python, vim, ipython

I've just found [IPython](http://ipython.scipy.org/) and I can report that I'm in deep love. And the affection was immediate. I think this affair will turn into something lasting, like [the one I have with screen](https://stackoverflow.com/questions/431521/run-a-command-in-a-shell-and-keep-running-the-command-when-you-close-the-session#431570). Ipython and screen happen to be the best of friends too so it's a triangular drama. Purely platonic, mind you.

The reason IPython hits the soft spots with me are very much because I generally like command prompts, and especially *nix-inspired prompts with inspiration from ksh, csh (yes, chs is a monster, but as a prompt it sport lots of really good features), bash and zsh. And IPython does sure feel like home for a *nix prompt rider. Mixing the system shell and python is also a really good idea. Plus, of course, IPython helps a lot when solving [the Python Challenge](http://www.pythonchallenge.com/) riddles. Invaluable even.

Now, I love Vim too. Since I learnt vi back in the days there's no turning back. And I'm on Mac when I have a choice. Now I'd like to glue together my IPython + MacVim workflow. What I've done so far is that I start Ipython using:

```
ipython -e "open -a MacVim" 
```

Thus when I edit from IPython it starts MacVim with the file/module loaded. Could look a bit like so:

```
In [4]: %run foo #This also "imports" foo anew
hello world

In [5]: edit foo
Editing... done. Executing edited code... #This happens immediately
hello world

In [6]: %run foo
hello SO World 
```

OK. I think this can be improved. Maybe there's a way to tie IPython into MacVim too? Please share your experiences. Of course if you use TextMate or some other fav editor I'm interested too. Maybe some of the lessons are general.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-17T19:13:43.837

I use Linux, but I believe this tip can be used in OS X too. I use [GNU Screen](http://www.gnu.org/software/screen/) to send IPython commands from Vim as recommended by [this tip](http://vim.wikia.com/wiki/IPython_integration). This is how I do it:

First, you should open a terminal and start a screen session called 'ipython' or whatever you want, and then start IPython:

```
$ screen -S ipython
$ ipython 
```

Then you should put this in your .vimrc:

```
autocmd FileType python map F5 :w<CR>:!screen -x ipython -X stuff $'\%run %:p:h\n'<CR><CR> 
```

Then when you hit F5, it will tell Screen to execute the command '%run file' inside the 'ipython' created previously, where file is your current buffer in Vim.

You can tweak this to execute the command you want inside IPython from Vim. For example I use this:

```
autocmd FileType python map <F5> :w<CR>:!screen -x ipython -X stuff $'\%reset\ny\n\%cd %:p:h\n\%run %:t\n'<CR><CR> 
```

This executes %reset (answering yes to the prompt), then change to the directory where the current buffer in vim is located and then %run the file. This is specially useful if you have the %pdb active in IPython.

Don't forget that you need an active Screen session called 'ipython' with IPython running inside.

If you like Emacs. There is [good support](http://ipython.scipy.org/dist/ipython.el) for IPython.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-11-10T09:35:52.050

This questions is stale now, but just for reference - if you're using IPython 0.11 with ZeroMQ enabled, take a look at [vim-ipython](https://github.com/ivanov/vim-ipython) (an older version of which shipped with 0.11).

Using this plugin, you can send lines or whole files for IPython to execute, and also get back object introspection and word completions in Vim, like what you get with: `object?<enter>` and `object.<tab>` in IPython.

Take a look at two screencasts of this plugin in action on [this post](http://pirsquared.org/blog/2011/07/28/vim-ipython/).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T14:38:20.383

In the ipythonrc.ini file in you home directory change the editor to MacVim.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-26T05:10:40.227

I've had the same issue. After experimenting this is my solution: if you placed MacVim.app in /Applications and mvim is in your path, in ~/.ipython/ipythonrc change the line

```
editor 0 
```

to

```
editor mvim --remote-tab-wait-silent 
```

I think you need to keep MacVim open in the background. You could also use the -f flag. Look at this thread from the [MacVim google group](http://groups.google.com/group/vim_mac/browse_thread/thread/2070d56fad8a7ee9/4cc4ebd1696e9fa5?lnk=gst&q=server+%22--remote%22#4cc4ebd1696e9fa5 "MacVim google group").

# flash - 如何使用 FFMPEG 最好地转换 Flash 兼容的 mp4 文件？

> ID：453352
> 
> 赞同：17
> 
> 时间：2009-01-17T14:13:51.587
> 
> 标签：flash, ffmpeg, flash-video

我正在尝试`.mp4`使用 ffmpeg 将不同的文件转换为与 flash 兼容的文件，但我似乎无法让它工作。当然，目标是用最小的文件大小获得最高质量。

到目前为止，我有这个，它可以工作，但由于某种原因它不能在 Flash 播放器中播放。结果不是很好，我该如何改进这种转换？

这是我正在使用的命令：

```
ffmpeg -i input.file -f mp4 -vcodec mpeg4 -r 25 -b 560000 -s 610x340 -acodec aac -ac 2 -ab 64 -ar 44100 output.file 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-20T17:04:04.047

要创建交错元数据（这将允许中间流恢复和倒带/向前），请使用 gpac 实用程序（例如，包含在 medibuntu 中）重新交错文件。转换为 mp4 如下，FFmpeg 版本为 0.5 或更高：

```
ffmpeg -f mp4 -i video.mov -b 400k video.mp4 
```

然后

```
/usr/bin/MP4Box -inter 500 video.mp4 
```

多田！完毕！这将在 JW Flv 或其他 Flash 播放器中正确播放。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-06T10:19:05.257

FLV 和 MP4 是媒体容器。

MPEG-4 第 2 部分和 H.264 是视频编解码器。（并且 H.264 提供更好的质量）

libx264 是 H.264 编解码器的编码器。

mpeg4 是 MPEG-4 第 2 部分编解码器的编码器。

Flash 只能在 FLV 容器中播放视频编解码器 H.264。

所以参数应该是这样的：

```
-f flv -vcodec libx264 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-18T11:44:08.163

在我的代码片段集合中，我有以下任务。

ffmpeg 第一遍：

```
ffmpeg -y -i input.mp4 -pass 1 -vcodec libx264 -b 2000k -g 300 -bf 3 -refs 6 -b_strategy 1 -coder 1 -qmin 10 -qmax 51 -sc_threshold 40 -flags +loop -cmp +chroma -me_range 16 -me_method umh -subq 7 -i_qfactor 0.71 -qcomp 0.6 -qdiff 4 -directpred 3 -flags2 +dct8x8+wpred+bpyramid+mixed_refs -trellis 1 -partitions +parti8x8+parti4x4+partp8x8+partp4x4+partb8x8 -acodec libfaac -ab 128k output.mp4 
```

ffmpeg 第二遍：

```
ffmpeg -y -i input.mp4 -pass 2 -vcodec libx264 -b 2000k -g 300 -bf 3 -refs 6 -b_strategy 1 -coder 1 -qmin 10 -qmax 51 -sc_threshold 40 -flags +loop -cmp +chroma -me_range 16 -me_method umh -subq 7 -i_qfactor 0.71 -qcomp 0.6 -qdiff 4 -directpred 3 -flags2 +dct8x8+wpred+bpyramid+mixed_refs -trellis 1 -partitions +parti8x8+parti4x4+partp8x8+partp4x4+partb8x8 -acodec libfaac -ab 128k output.mp4 
```

质量设置为 2000k = 视频比特率、128k = 音频比特率和 300 = GOP。不要问我其他参数是什么。:)

与 MP4Box 交错：

```
MP4Box -inter 500 output.mp4 
```

创建缩略图/海报图像（玩弄 5 以获得您想要的图像）

```
ffmpeg -itsoffset -5 -i output.mp4 -vcodec mjpeg -vframes 1 -an -f rawvideo -s 1280x720 thumbnail.jpg 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-06T23:03:47.213

我使用一系列命令来执行此操作，从 mencoder 开始。（见下面的脚本）。诀窍是 ffmpeg（和 mencoder）的 mp4 文件输出通常不兼容闪存，因为它是交错的，并且它们不能很好地控制这种行为。所以，我制作了一个 AVI 文件，然后使用 mp4box 以我想要的方式重新混合它。这是我的完整脚本，预计将获得一个 .avi 文件，并生成一个可闪存播放的 .mp4 文件。

```
#!/bin/bash
#
ORIGDIR=`pwd`
FILE=$@
VID_OUTPUT=${FILE/.AVI/.tmp.avi}
FINAL_OUTPUT=${FILE/.AVI/.mp4}
MENCODER=~/src/mplayer/svn/mplayer/mencoder
BITRATE=500
RES=640:480
LOG=mencoder.$FILE.log

TEMPDIR=`mktemp -d /tmp/transcode.XXXXXXXX`
pushd $TEMPDIR
echo "Pass 1"

PARAMS=keyint=250:bframes=0:qp_min=10:qp_max=51:turbo=1:mixed_refs=0:frameref=1:deblock=0,0:qblur=0:vbv_bufsize=10000:vbv_maxrate=10000:keyint_min=25:me=hex:me_range=16:ip_factor=1.4:pb_factor=1.3:chroma_qp_offset=0:vbv_init=0.9:ratetol=1.0:cplx_blur=20:nocabac:noweight_b:nob_pyramid:partitions=p8x8,b8x8,i4x4:no8x8dct:nossim:deadzone_inter=21:deadzone_intra=11

EXTRA_PARAMS=subq=5:trellis=0:

$MENCODER $ORIGDIR/$FILE -o $VID_OUTPUT -oac faac -srate 44100 -ovc x264 -x264encopts bitrate=$BITRATE:$PARAMS:pass=1 -vf scale=$RES 2>&1 >> $LOG
echo "Pass 2"
$MENCODER $ORIGDIR/$FILE -o $VID_OUTPUT -oac faac -srate 44100 -ovc x264 -x264encopts bitrate=$BITRATE:$PARAMS:pass=2 -vf scale=$RES 2>&1 >> $LOG
MP4Box -aviraw video $VID_OUTPUT
MP4Box -aviraw audio $VID_OUTPUT
TEMP_AUDIO=${VID_OUTPUT/.avi/}_audio.raw
AAC_AUDIO=${TEMP_AUDIO/.raw/.aac}
H264_VIDEO=${VID_OUTPUT/.avi/}_video.h264
echo TEMP is $TEMP_AUDIO
echo AAC is $AAC_AUDIO
echo H264 is $H264_VIDEO
mv $TEMP_AUDIO $AAC_AUDIO
MP4Box -add $H264_VIDEO:fps=29.97 -add $AAC_AUDIO $FINAL_OUTPUT
mv $LOG $ORIGDIR
mv $FINAL_OUTPUT $ORIGDIR
popd
echo Files left in $TEMPDIR
# rm -fr $TEMPDIR 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-28T00:43:31.797

如果您使用 ffmpeg 制作 .mp4s，请查看 ffpresets/ 目录并使用 -vpre。默认选项（对于所有编解码器，尤其是 libx264）非常糟糕，实际上所有这些都应该设置为自定义的。-vpre 为 x264 处理大部分内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-09-16T04:32:10.373

实际上，您不应该使用 maxrate，尤其是当您将比特率明确设置为 200k 时，不应该使用 10000k 的 maxrate。事实上，更仔细地看这个，我真的不认为你明白这些东西的大部分用途:)

对于初学者，您调用输入文件 output.mp4，加上输出文件（实际上应该是 /dev/null 用于第 1 步）称为 yourinfile.avi 并且您实际上还没有设置容器格式，所以您将结束最多的是一个 h264 编码的 avi 文件。

试试这个高质量的 1080p 高清闪存兼容 h264 编码的 MPEG-4 视频，首先在与您正在编码的视频相同的目录中创建一个包含以下内容的文件，并将其命名为 flash-mp4.ffpreset

```
vcodec=libx264
b=5000k
acodec=libfaac
ab=256k
ac=2
ar=44100
coder=1
flags=+loop+mv4
cmp=+chroma
partitions=+parti8x8+parti4x4+partp8x8+partb8x8
me_method=umh
subq=8
me_range=16
g=250
keyint_min=25
sc_threshold=40
i_qfactor=0.71
b_strategy=2
qcomp=0.6
qmin=10
qmax=51
qdiff=4
bf=3
refs=4
directpred=3
trellis=1
flags2=+wpred+mixed_refs+dct8x8+fastpskip
wpredp=2
fflags=+rtphint
profile=1 
```

然后从命令行：

```
ffmpeg -y -i sourcefile.avi -fpre ./flash-mp4.ffpreset -f mp4 outputfile.f4v 
```

这应该可以与 flash 10+ 完美配合

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T19:47:11.477

我在网络上的某个地方发现了这个（非常冗长，我不确定它的一半是什么）片段。它是为执行两遍而设计的，因此在第一遍时不会输出任何视频，您需要将其设置为 do **-pass 2**以运行第二遍并输出实际视频。

```
ffmpeg -y -i output.mp4 -vcodec libx264 -acodec libfaac -ab 12000 -ac 2 -b 200000 -threads 2 -flags +loop -cmp +chroma -partitions 0 -subq 1 -trellis 0 -refs 1 -coder 0 -me_range 16 -g 300 -keyint_min 25 -sc_threshold 40 -i_qfactor 0.71 -maxrate 10M -bufsize 10M -rc_eq \’blurCplx^(1-qComp)\’ -qcomp 0.6 -qmin 10 -qmax 51 -qdiff 4 -level 30 -s 304x224 -pass 1 yourinfile.avi 
```

要在下载期间获得渐进式播放，您还需要将元数据移动到文件的开头。ffmpeg 把它放在最后，flash 需要它才能开始播放。一个有用的工具是[QTIndexSwapper](http://renaun.com/blog/2007/08/22/234/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-17T17:39:38.193

只是关于为什么会发生这种情况的一些想法

*   mp4 仅支持 flash 9.0.115.0 或更高版本，您使用的是什么版本？
*   托管文件的网络服务器是否设置了 mp4 mime 类型？

转换为 FLV 时会播放吗？这是一个选项吗？然后，您将使用以下选项

```
ffmpeg -i input.file -f flv -r 25 -b 560000 -s 610x340 -acodec mp3 -ac 2 -ab 64 -ar 44100 output.file 
```

# android - 谷歌 Android 平台在财务上已经很有趣了吗？

> ID：453353
> 
> 赞同：11
> 
> 时间：2009-01-17T14:14:35.423
> 
> 标签：android

下午好，

随着围绕 iPhone / AppStore 等的所有嗡嗡声，我觉得为我一直在组装的 Web 应用程序创建一个漂亮的 iPhone 应用程序是不费吹灰之力的，但是到目前为止，您对 Android 平台的体验如何 - 是从销售和用户量来看，它已经很有趣了吗？

我快速浏览了 T-Mobile G1，从最终用户的角度来看，我认为这一切都不是很吸引人，而且对我来说，这一切似乎需要一段时间才能起飞。

你们中是否有人已经为该平台完成了一个或多个应用程序？您对此有何看法.. 销售额是否低于/高于您的预期？是否值得（现在）投入时间和金钱来构建我的应用程序的 android 版本？显然，“值得”是一个非常灵活的术语，取决于某人的观点，但基本上现在每个小时我都不在 Web 应用程序本身上工作，基本上“必须”相当快地得到回报......这就是为什么我寻求一些现实生活中的经验。

干杯和感谢，-J

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-20T17:29:22.760

关于通过为您的应用程序收费来赚钱：“从第一季度初开始，除了免费应用程序之外，开发人员还可以分发付费应用程序。” [来源：[http](http://android-developers.blogspot.com/2008/10/android-market-now-available-for-users.html) ://android-developers.blogspot.com/2008/10/android-market-now-available-for-users.html ]

我研究了两个平台的API。如果我去做两句话的比较，我会说：

iPhone 专注于提供一致的用户体验。

Android 专注于为开发人员提供实现或改进他们想要的任何东西的自由。

您还应该考虑天气您的特定应用程序从中受益。例如，它是重文本输入（android）还是基于浏览（iPhone）？

它是否适合作为基本应用程序的附加组件，例如地图？（安卓）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T20:57:00.027

AFAIK 目前无法通过 Android Market 发布“非免费”应用程序。目前，AM 中的所有应用程序都是免费的。

尽管 Google 正在集中精力开发此功能，预计很快就会发布。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T21:16:42.233

我的经验是，Android 目前几乎是一个 beta 平台，即使谷歌不想承认...整个平台稳定并获得更多用户（当然，谷歌在 Android Market 中引入了非免费应用程序）。

但是你现在可以开始开发了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T10:45:01.290

是的，这也是我经过一天的挖掘和搜索后得出的结论。我会时不时地让自己习惯这个平台，但现在不会广泛追求它。

谢谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T11:17:32.580

根据 Shopsavvy 在前 75 天的数据，G1 的销量比 iPhone 还多。只是一个需要考虑的想法。

# asp.net-mvc - 发布 ASP.Net MVC 应用程序时是否应该部署 cs 文件？

> ID：453356
> 
> 赞同：1
> 
> 时间：2009-01-17T14:16:19.493
> 
> 标签：asp.net-mvc, publish, jit

我有一个项目可以在我的开发机器上编译并运行良好，但是当我在 Web 服务器上运行它时，出现以下错误。

> 解析器错误消息：文件“/Views/Shared/Main.master.cs”不存在。

提到的文件在服务器上不存在，但文件“/Views/Shared/Main.master”存在。

我使用“发布”命令上传项目。是不是缺少cs文件？

是否有一些设置可以及时编译需要关闭？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T15:20:28.053

我偶然发现了这个解决方案。

母版页具有以下属性`CodeFile="Main.master.cs"`。当我用它替换它时，`CodeBehind="Main.master.cs"`它按预期工作。

该文件最初来自较旧的 Web 应用程序，但我不知道其中的区别是什么意思。如果其他人可以提出更好的解释，我将接受他们的答案而不是这个答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T15:48:19.040

很高兴你弄明白了。从“网站”转换为“Web 应用程序”项目类型时可能会出现问题。

[http://aspadvice.com/blogs/ssmith/archive/2007/01/24/CodeFile-or-CodeBehind.aspx](http://aspadvice.com/blogs/ssmith/archive/2007/01/24/CodeFile-or-CodeBehind.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T15:09:03.240

通常这些文件标有对存在于 bin 中的 dll 的引用，例如 Main.master 的继承声明中的 App_Web_nnnnn。Web服务器上的那个文件是这种情况吗？引用的dll是否存在于bin中？如果不是，那么它可能不会按应有的方式进行预编译。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-10T19:49:09.907

据我所见，我认为您甚至不需要代码隐藏页面，对吗？

我已经从我的应用程序中出于任何原因存在的任何页面中删除了引用。

Also, when you create a new View, I don't think it even creates the code-behind page in MVC, does it? (Really threw me to start with!!)

# java - 如何从 JVM 卸载库 (DLL)

> ID：453359
> 
> 赞同：37
> 
> 时间：2009-01-17T14:18:32.793
> 
> 标签：java, native-code

我需要卸载加载的 DLL `System.loadLibrary(..)`，有人知道这是否可能吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-01-17T14:32:54.920

我没有这方面的任何经验，但是一些挖掘表明，当加载库的类加载器被垃圾收集时，应该卸载库。

链接：

*   [调用 API 文档 (Sun) - 查找“库和版本管理”](https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/invocation.html#library_version)
*   [Java JNI DLL 卸载教程](https://web.archive.org/web/20140704120535/http://www.codethesis.com/blog/unload-java-jni-dll)

# c++ - 在 C++ 的头文件中编写函数定义

> ID：453372
> 
> 赞同：65
> 
> 时间：2009-01-17T14:36:22.040
> 
> 标签：c++, performance, header-files

我有一个有很多小功能的类。小函数是指不进行任何处理而只返回文字值的函数。就像是：

```
string Foo::method() const{
    return "A";
} 
```

我创建了一个头文件“Foo.h”和源文件“Foo.cpp”。但是由于函数很小，我正在考虑将它放在头文件本身中。我有以下问题：

1.  如果我将这些函数定义放在头文件中，是否有任何性能或其他问题？我会有很多这样的功能。
2.  我的理解是编译完成后，编译器会展开头文件并将其放在包含的位置。那是对的吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-01-17T14:44:05.473

如果函数很小（您经常更改它的机会很低），并且如果该函数可以放入头文件中而不包含无数其他头文件（因为您的函数依赖于它们），那么这样做是完全有效的。如果将它们声明为 extern inline，则编译器需要为每个编译单元提供相同的地址：

*headera.h*：

```
inline string method() {
    return something;
} 
```

成员函数是隐式内联的，前提是它们在其类中定义。对它们来说也是如此：如果它们可以毫不费力地放入标题中，那么您确实可以这样做。

因为函数的代码放在头部并且可见，所以编译器能够内联调用它们，即直接将函数的代码放在调用位置（不是因为你在它之前放置了inline，而是更多因为编译器会以这种方式决定。仅将 inline 放入是对编译器的提示）。这可以提高性能，因为编译器现在可以看到参数与函数局部变量匹配的位置，以及参数不相互别名的位置 - 最后但并非最不重要的一点是，不再需要函数帧分配。

> 我的理解是编译完成后，编译器会展开头文件并将其放在包含的位置。那是对的吗？

对，那是正确的。该函数将在您包含其标题的每个地方定义。编译器只关心将它的一个实例放入结果程序中，通过消除其他实例。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-17T15:18:42.003

根据您的编译器及其设置，它可能会执行以下任何操作：

*   它可能会忽略 inline 关键字（它只是对编译器的提示，而不是命令）并生成独立函数。如果您的函数超过编译器相关的复杂度阈值，它可能会这样做。例如太多的嵌套循环。
*   它可能决定您的独立函数是否适合内联扩展。

在许多情况下，编译器在确定一个函数是否应该被内联方面比你更有优势，所以没有必要再猜测它。当一个类有很多小函数时，我喜欢使用隐式内联，只是因为在类中有实现很方便。这对于较大的功能来说效果不佳。

要记住的另一件事是，如果您要在 DLL/共享库中导出一个类（恕我直言，这不是一个好主意，但人们无论如何都会这样做），您需要非常小心内联函数。如果构建 DLL 的编译器决定一个函数应该被内联，那么你有几个潜在的问题：

1.  使用 DLL 构建程序的编译器可能决定不内联函数，因此它将生成对不存在的函数的符号引用，并且 DLL 将不会加载。
2.  如果您更新 DLL 并更改内联函数，客户端程序仍将使用该函数的旧版本，因为该函数已内联到客户端代码中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-17T14:41:15.387

由于头文件中的实现是隐式内联的，因此性能会有所提高。正如您提到的，您的功能很小，内联操作将对您非常有益，恕我直言。

您对编译器的看法也是正确的。编译器（除了内联）在头文件或`.cpp`文件中的代码之间没有区别。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T14:42:24.337

1.  如果您的函数如此简单，请将它们内联，无论如何您都必须将它们粘贴在头文件中。除此之外，任何约定都只是——约定。

2.  是的，编译器会在遇到#include 语句的地方展开头文件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-17T14:49:04.933

这取决于适用于您的情况的编码标准，但是：

应该内联没有循环和其他任何内容的小函数以获得更好的性能（但代码稍大 - 对于某些受限或嵌入式应用程序很重要）。

如果您在标头中有函数的主体，则默认情况下将拥有它 inline(d) （在速度方面这是一件好事）。

在编译器创建目标文件之前，调用预处理器（gcc 的 -E 选项）并将结果发送到编译器，编译器使用代码创建对象。

所以更简短的答案是：

-- 在 header 中声明函数有利于速度（但不利于空间） --

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-12-05T05:57:01.920

> 如果你这样做，C++ 不会抱怨，但一般来说，你不应该抱怨。
> 
> 当您#include 一个文件时，包含文件的全部内容将插入到包含点。这意味着您放入标头的任何定义都会复制到包含该标头的每个文件中。
> 
> 对于小型项目，这可能不是什么大问题。但是对于较大的项目，这可能会使编译时间变得更长（因为每次遇到相同的代码都会重新编译），并且可能会大大增加可执行文件的大小。如果您更改代码文件中的定义，则只需重新编译该 .cpp 文件。如果您对头文件中的定义进行更改，则需要重新编译包含该头文件的每个代码文件。一个小改动可能会导致您不得不重新编译整个项目！
> 
> 有时对于不太可能更改的琐碎函数（例如，函数定义只有一行）会例外。

来源： http: [//archive.li/ACYlo](http://archive.li/ACYlo)（learncpp.com 上第 1.9 章的上一版本）

# java - 计算Java中的日期差异

> ID：453388
> 
> 赞同：17
> 
> 时间：2009-01-17T14:44:18.390
> 
> 标签：java, date, datetime, date-arithmetic

我觉得 Java（或 java.util 库）没有内置函数来计算日期差异很有趣。我想从另一个日期中减去一个日期以获得它们之间的经过时间。做这个的最好方式是什么？

我知道简单的方法是以毫秒为单位的时间差，然后将其转换为天。但是，我想知道这是否适用于所有情况（夏令时等）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T14:48:21.050

如果您查看开源，Java 并没有丢失太多：试试[Joda-Time](http://www.joda.org/joda-time/)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T15:07:12.430

> 我知道简单的方法是以毫秒为单位的时间差，然后将其转换为天。但是，我想知道这是否适用于所有情况（夏令时等）。

如果您的时间来自 UTC 日期，或者它们只是在同一系统上测量的两次 System.getCurrentTimeMillis() 调用之间的差异，您将获得有效的毫秒数作为差异，与任何时区问题无关。（这就是为什么一切都应该使用 UTC 作为存储格式的原因——从 UTC-> 本地时间开始要容易得多；如果你尝试另一种方式，那么你需要将本地时区与本地时间一起存储——或尝试推断它，gack！）

至于将其转换为天数，您应该只能除以 86400000 ......但需要注意的是每隔一年左右偶尔会有一次[闰秒。](http://en.wikipedia.org/wiki/Leap_second)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-03T07:05:11.623

使用 Joda-Time 或 Java 8 中的新 java.time 包。

两个框架都使用*半开放*方法，其中开头是*包容性*的，而结尾是*独占*性的。有时记为`[)`. 这通常是定义时间跨度的最佳方法。

# java.time

Java 8 及更高版本中内置的 java.time 框架有一个`Period`类，用于将时间跨度表示为年数、月数和天数。但是这个类仅限于一整天，没有小时、分钟和秒的表示。

请注意，我们指定了一个时区，这对于确定日期至关重要。例如，[巴黎](https://en.wikipedia.org/wiki/Paris)的新一天比[蒙特利尔](https://en.wikipedia.org/wiki/Montreal)更早。

```
ZoneId zoneId = ZoneId.of( "America/Montreal" );
LocalDate now = LocalDate.now( zoneId );
LocalDate then = LocalDate.of( 2001, 1, 1 );
Period period = Period.between( then, now ); 
```

> 然后：2001-01-01。现在：2015-09-07。期间：P14Y8M6D。天数：5362

对于一整天，[夏令时 (DST)](https://en.wikipedia.org/wiki/Daylight_saving_time)是无关紧要的。

如果您想要计算总天数，请使用[`ChronoUnit`](http://docs.oracle.com/javase/8/docs/api/java/time/temporal/ChronoUnit.html)包含一些计算方法的枚举。请注意，计算返回很长。

```
long days = ChronoUnit.DAYS.between( then, now );  // "5362" seen above. 
```

[我问](https://stackoverflow.com/q/32366154/642706)过在 java.time 中做一个完整的时间，包括小时、分钟、秒。从 Java 8 开始不可能[。Meno Hochschild](https://stackoverflow.com/users/2491410/meno-hochschild)[提出](https://stackoverflow.com/a/32419901/642706)了一个使用捆绑库的令人惊讶的解决方法：使用[javax.xml.datatype 包](https://docs.oracle.com/javase/8/docs/api/javax/xml/datatype/package-summary.html)中的类。[`Duration`](http://docs.oracle.com/javase/8/docs/api/javax/xml/datatype/DatatypeFactory.html#newDuration-java.lang.String-)

# 乔达时间

这是 Joda-Time 2.3 中的一些示例代码。

```
DateTimeZone timeZone = DateTimeZone.forID( "Europe/Paris" );
DateTime start = new DateTime( 2014, 1, 2, 3, 4, 5, timeZone );
DateTime stop = new DateTime( 2014, 5, 2, 3, 4, 5, timeZone );
Period period = new Period( start, stop ); 
```

调用将为您提供[ISO 8601](http://en.wikipedia.org/wiki/ISO_8601)标准`toString`定义的形式的字符串表示， .`PnYnMnDTnHnMnS`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-13T02:14:40.497

使用[date4j](http://www.date4j.net)库：

```
int numDaysBetween = oneDate.numDaysFrom(anotherDate); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-04T12:34:04.770

有一种简单的方法来实现它。我们可以使用带有循环的 Calendar.add 方法。例如如下，

```
DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");

Date beginDate = dateFormat.parse("2013-11-29");
Date endDate = dateFormat.parse("2013-12-4");

Calendar beginCalendar = Calendar.getInstance();
beginCalendar.setTime(beginDate);

Calendar endCalendar = Calendar.getInstance();
endCalendar.setTime(endDate); 
```

beginDate 和 endDate 之间的减号天数，代码如下，

```
int minusDays = 0;
while (true) {
  minusDays++;

  // Day increasing by 1
  beginCalendar.add(Calendar.DAY_OF_MONTH, 1);

  if (dateFormat.format(beginCalendar.getTime()).
            equals(dateFormat.format(endCalendar).getTime())) {
    break;
  }
}
System.out.println("The substractation between two days is " + (minusDays + 1)); 
```

玩得开心！@.@

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-19T21:58:54.293

Java 的日期实现很差。如果你觉得[Joda-Time](http://www.joda.org/joda-time/)太复杂，试试我对开源的一点贡献：http: [//calendardate.sourceforge.net/javadoc/index.html](http://calendardate.sourceforge.net/javadoc/index.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-19T22:06:20.613

我不同意 Java 没有计算日期之间差异的机制的说法。

Java 是为全球使用而设计的。它被设计成没有日期的概念，只有“以毫秒为单位的时间”的概念。在特定约定下，对特定地点的时间和日期这样的世界时间的任何解释都只是一种投影或一种看法。

日历类用于将这种绝对时间转换为日期。如果确实需要，您还可以添加或减去日期组件。在两次之间提供组件术语差异的唯一方法是日历生成和特定。因此，您可能会争辩说标准库不包含足够智能的公历，我同意它还有一些不足之处。

话虽如此，这种功能有很多实现，我看到其他人提供了示例。

# flash - ActionScript 2 与 ActionScript 3 的性能对比

> ID：453391
> 
> 赞同：2
> 
> 时间：2009-01-17T14:46:08.060
> 
> 标签：flash, actionscript, programming-languages

这两种语言（编译器）的整数、数组、函数、类等**性能**的任何**基准？**

 **比较也会有所帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-18T22:01:54.070

由于 AS3 在与 AS2 (AVM) 不同的虚拟机 (AVM2) 中运行，因此随着 AS3 的引入，性能得到了显着改进。一般来说，由 AVM2 执行的操作码比在旧 AVM 中运行的类似操作码快约 10 倍。这当然并不意味着 AS3 中的所有内容都比 AS2 快 10 倍。随着 AS3 的引入，所有显示功能或所有典型 Flash API 的速度并没有提高，只是代码执行过程的逻辑和算术部分。例如，在视觉元素上应用模糊过滤器与 AS2 一样快，但是，使用 AS3 进行 3D 转换要快得多。AS3 还引入了一些新的数据类型，它们也可以提高性能（尽管不一定总是如此）。

以下是一些有关 AS3 性能信息的链接：

*   [避免在 AS3 中使用整数](http://kuwamoto.org/2006/06/15/avoid-ints-in-actionscript/)

*   [AS3 中的类型](http://www.gskinner.com/blog/archives/2006/06/types_in_as3_in.html)

*   [AS3 性能测试](http://www.boostworthy.com/blog/?p=82)

*   [Flash AS3 和 AVM2：性能调优](http://www.scribd.com/doc/913908/Flash-AS3-and-AVM2-Performance-Tuning)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-18T04:17:54.097

我认为您必须更具体地了解您到底在寻找什么，我怀疑是否有人对所有内容进行了基准测试和比较。此外，AS 只是语言，但播放器版本、平台和浏览器之间也存在速度差异。

但作为一般规则，AS3 几乎总是更快，有时甚至达到数量级。

# python - 用 python 对 jpeg 图像进行地理标记的最佳方法是什么？

> ID：453395
> 
> 赞同：5
> 
> 时间：2009-01-17T14:49:53.013
> 
> 标签：python, jpeg, exif, geotagging

我有一些来源的坐标，想用它们标记我的 jpg 文件。将地理标签写入 exif 数据的最佳 python 库是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T14:55:41.533

我自己没有尝试过，但是从文档 [pyexiv2][1] 看来它应该可以完成这项工作。

[1]: [http://tilloy.net/dev/pyexiv2/tutorial.html](http://tilloy.net/dev/pyexiv2/tutorial.html) #link 缺少最后一个字符

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T15:45:16.067

[pexif](https://github.com/bennoleslie/pexif)是以地理标签为目标编写的（我的重点）：

> pexif 是一个 Python 库，用于解析和更重要的是编辑 JPEG 文件中的 EXIF 数据。
> 
> 这是因为**需要将 GPS 标记的数据添加到我的图像**中，不幸的是，那里的其他库无法进行更新，并且似乎不容易架构成能够添加这样的东西。不是可重用的软件盛大！
> 
> 我写这篇文章的主要原因是提供一种简单的方法来对我的照片进行地理标记，而图书馆现在似乎已经成熟到可以做到这一点。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-01-30T12:19:18.417

这是一个如何使用 pyexiv2 库设置 GPS 位置的示例。我已经通过将地理标记图像上传到 Panoramio 来测试这个脚本

```
#!/usr/bin/env python

import pyexiv2
import fractions
from PIL import Image
from PIL.ExifTags import TAGS
import sys

def to_deg(value, loc):
        if value < 0:
            loc_value = loc[0]
        elif value > 0:
            loc_value = loc[1]
        else:
            loc_value = ""
        abs_value = abs(value)
        deg =  int(abs_value)
        t1 = (abs_value-deg)*60
        min = int(t1)
        sec = round((t1 - min)* 60, 5)
        return (deg, min, sec, loc_value)    

def set_gps_location(file_name, lat, lng):
    """Adds GPS position as EXIF metadata

    Keyword arguments:
    file_name -- image file 
    lat -- latitude (as float)
    lng -- longitude (as float)

    """
    lat_deg = to_deg(lat, ["S", "N"])
    lng_deg = to_deg(lng, ["W", "E"])

    print lat_deg
    print lng_deg

    # convert decimal coordinates into degrees, munutes and seconds
    exiv_lat = (pyexiv2.Rational(lat_deg[0]*60+lat_deg[1],60),pyexiv2.Rational(lat_deg[2]*100,6000), pyexiv2.Rational(0, 1))
    exiv_lng = (pyexiv2.Rational(lng_deg[0]*60+lng_deg[1],60),pyexiv2.Rational(lng_deg[2]*100,6000), pyexiv2.Rational(0, 1))

    exiv_image = pyexiv2.Image(file_name)
    exiv_image.readMetadata()
    exif_keys = exiv_image.exifKeys() 

    exiv_image["Exif.GPSInfo.GPSLatitude"] = exiv_lat
    exiv_image["Exif.GPSInfo.GPSLatitudeRef"] = lat_deg[3]
    exiv_image["Exif.GPSInfo.GPSLongitude"] = exiv_lng
    exiv_image["Exif.GPSInfo.GPSLongitudeRef"] = lng_deg[3]
    exiv_image["Exif.Image.GPSTag"] = 654
    exiv_image["Exif.GPSInfo.GPSMapDatum"] = "WGS-84"
    exiv_image["Exif.GPSInfo.GPSVersionID"] = '2 0 0 0'

    exiv_image.writeMetadata()

set_gps_location(sys.argv[1], float(sys.argv[2]), float(sys.argv[3])) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-05T14:26:58.133

上面的代码有效，但我不得不修改 set_gps_location 函数以使用当前版本的 pyexiv2 ...也许 Maksym 使用的是旧版本：

```
def set_gps_location(file_name, lat, lng):
    """Adds GPS position as EXIF metadata

    Keyword arguments:
    file_name -- image file
    lat -- latitude (as float)
    lng -- longitude (as float)

    """
    lat_deg = to_deg(lat, ["S", "N"])
    lng_deg = to_deg(lng, ["W", "E"])

    print lat_deg
    print lng_deg

    # convert decimal coordinates into degrees, munutes and seconds
    exiv_lat = (pyexiv2.Rational(lat_deg[0]*60+lat_deg[1],60),pyexiv2.Rational(lat_deg[2]*100,6000), pyexiv2.Rational(0, 1))
    exiv_lng = (pyexiv2.Rational(lng_deg[0]*60+lng_deg[1],60),pyexiv2.Rational(lng_deg[2]*100,6000), pyexiv2.Rational(0, 1))
    metadata = pyexiv2.ImageMetadata(file_name)
    metadata.read()

##    exif_keys = metadata.exif_keys

    metadata["Exif.GPSInfo.GPSLatitude"] = exiv_lat
    metadata["Exif.GPSInfo.GPSLatitudeRef"] = lat_deg[3]
    metadata["Exif.GPSInfo.GPSLongitude"] = exiv_lng
    metadata["Exif.GPSInfo.GPSLongitudeRef"] = lng_deg[3]
    metadata["Exif.Image.GPSTag"] = 654
    metadata["Exif.GPSInfo.GPSMapDatum"] = "WGS-84"
    metadata["Exif.GPSInfo.GPSVersionID"] = '2 0 0 0'

    metadata.write() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-14T00:38:52.390

pyexiv2 现在已被弃用，取而代之的是[GExiv2](https://wiki.gnome.org/Projects/gexiv2)，这是一个围绕 libexiv2 的基于 GObject 的包装器。

# python - 编写一个简单的“石头剪刀布”游戏机器人

> ID：453396
> 
> 赞同：7
> 
> 时间：2009-01-17T14:50:12.293
> 
> 标签：python

这是我为我的石头剪刀布游戏想出的：

```
import random 

from time import sleep 

print "Please select: " 
print "1  Rock" 
print "2  Paper" 
print "3  Scissors" 

player = input ("Choose from 1-3: ") 

if player == 1: 
    print "You choose Rock" 
    sleep (2) 
    print "CPU chooses Paper" 
    sleep (.5) 
    print "You lose, and you will never win!" 

elif player == 2: 
    print "You choose Paper" 
    sleep (2) 
    print "CPU chooses Scissors" 
    sleep (.5) 
    print "You lose, and you will never win!" 

else: 
    print "You choose Scissors" 
    sleep (2) 
    print "CPU chooses Rock" 
    sleep (.5) 
    print "You lose, and you will never win!" 
```

我希望程序做的是无论用户输入什么，都从三个选项（石头剪刀布）中随机选择一个。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-01-17T14:53:03.833

好吧，您已经导入了 random 模块，这是一个开始。

试试 random.choice 函数。

```
>>> from random import choice
>>> cpu_choice = choice(('rock', 'paper', 'scissors')) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-17T16:05:47.820

```
import random

ROCK, PAPER, SCISSORS = 1, 2, 3
names = 'ROCK', 'PAPER', 'SCISSORS'

def beats(a, b):
    if (a,b) in ((ROCK, PAPER), (PAPER, SCISSORS), (SCISSORS, ROCK)): 
        return False

    return True

print "Please select: " 
print "1  Rock" 
print "2  Paper" 
print "3  Scissors" 

player = int(input ("Choose from 1-3: "))
cpu = random.choice((ROCK, PAPER, SCISSORS))

if cpu != player:
    if beats(player, cpu):
        print "player won"
    else:
        print "cpu won"
else:
    print "tie!"

print names[player-1], "vs", names[cpu-1] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T18:48:38.520

灵感来自古姆兹：

```
import random

WEAPONS = 'Rock', 'Paper', 'Scissors'

for i in range(0, 3):
  print "%d %s" % (i + 1, WEAPONS[i])

player = int(input ("Choose from 1-3: ")) - 1
cpu = random.choice(range(0, 3))

print "%s vs %s" % (WEAPONS[player], WEAPONS[cpu])
if cpu != player:
  if (player - cpu) % 3 < (cpu - player) % 3:
    print "Player wins"
  else:
    print "CPU wins"
else:
  print "tie!" 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-09-14T03:28:11.380

使用字典

```
loseDic = { 'rock'     : 'paper',
            'paper'    : 'scissors',
            'scissors' : 'rock',
}

## Get the human move, chose a random move, bla bla bla...

if robotMove == humanMove:
    tie()
elif humanMove == loseDic[robotMove]:
    lose()
else:
    win() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-28T23:39:33.743

不是专家，但这是我迄今为止所拥有的，`__name__ == '__main__'`如果您需要计算机生成答案并保持其简洁明了，使用语句可能会有所帮助。

没有给出解决方案。

```
import random

def is_tie(move1, move2):

'''FIX! (parameter types) -> return type

    Return True if move1 and move2 are the same.'''

    if move1 == move2:
        return True

def is_win(move1, move2):
    '''FIX! (parameter types) -> return type

    Return True iff move1 beats move2 in rock-paper-scissors.'''

    choice1 = scissor > paper,
    choice2 = paper > rock,
    choice3 = rock > scissor   

    return choice1 or choice2 or choice3

    if move1 > move2:

    return True

if __name__ == '__main__':

    # Get a move from the user.
    print "Rock, Paper, Scissor",    
    move1 = raw_input("What is your move? ")

    # Now, to generate a random move for the computer. Tricky... Here are some examples and suggestions, no solution given.

    if move2(random.randint(1,3)) == 1:
        print "paper"
    elif move2(random.randint(1,3)) == 2:
        print "rock"
    else:
        print "scissor"

    # Evaluate who wins and then print out an appropriate message.    
    #if solution(move1, move2):
    #   print 
    #if move2 > move1:
    #    usr_fail = (raw_input('I win!!'))
    #    print usr_fail
    #if move2 < move1:
    #    usr_win  = (raw_input('Damn it!'))
    #    print usr_win
    #if move2 == move1
    #usr_draw = (raw_input('Draw!!!')
    #    print usr_draw 
```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2018-10-08T09:24:09.210

试试这个：

```
 print()
    humanGuess = input("rock, paper or scissors?: ")
    import random
    misc =(random.randint(1,3))
    if misc == 1 and humanGuess == "paper":
        print ("paper, [draw] ")
    elif misc == 2 and humanGuess == "paper":
        print ("rock, [you win] ")
    elif misc == 3 and humanGuess == "paper":
        print ("scissors, [I win] ")
    elif misc == 1 and humanGuess == "rock":
        print ("paper, [I win] ")
    elif misc == 2 and humanGuess == "rock":
        print ("rock, [draw] ")
    elif misc == 3 and humanGuess == "rock":
        print ("scissors, [you win] ")
    elif misc == 1 and humanGuess == "scissors":
        print ("paper, [you win] ")
    elif misc == 2 and humanGuess == "scissors":
        print ("rock, [I won] ")
    elif misc == 3 and humanGuess == "scissors":
        print ("scissors, [draw] ")
    else:
        print ("not recognised") 
```

我认为这行得通

# flash - ActionScript 2 拳击性能

> ID：453399
> 
> 赞同：1
> 
> 时间：2009-01-17T14:51:46.597
> 
> 标签：flash, optimization, actionscript, actionscript-2

我听说每次参数传入/传出函数时，AS**框和取消框值。**

**A.**因此，这会更快吗？

```
var val = doWork(50,"hello", 2048);

function doWork (param1,param2,param3){
   t.text = param2;
   return param1+param3;
} 
```

**B.**还是这个？

```
var val:Number = doWork(50,"hello", 2048);

function doWork (param1:Number,param2:String,param3:Number):Number{
   t.text = param2;
   return param1+param3;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T16:58:22.130

运行时没有区别。AS 2 由不支持静态类型的 Actionscript 虚拟机 1 (AVM1) 运行，因此类型信息是编译器的提示，可帮助您更早地捕获类型不一致。但是带有或不带有类型注释的相同代码会产生相同的字节码。

AS 3 由支持动态和静态类型的 AVM2 运行，因此在代码中声明类型消除了一些运行时查找，从而使其执行速度更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T16:47:42.680

在性能方面，您**总是**会比省略它们更好地声明类型，因此在您的情况下，仅出于这个原因，B 就是更好的答案。不使用（暗示）对象也更好。

关于 ActionScript 如何进行装箱和拆箱的信息几乎没有那么多（与 C# 和 Java 相比），但 AS3 文档确实解决了一些问题（请参阅数据类型）：

[http://livedocs.adobe.com/flex/3/html/help.html?content=03_Language_and_Syntax_01.html](http://livedocs.adobe.com/flex/3/html/help.html?content=03_Language_and_Syntax_01.html)

不过，一般来说，最好避免运行时类型检查并使用文档中定义的 AS3 的“原语”（Boolean、Number、int、uint、String）。祝你好运！

# c# - 使用 SQL 身份验证处理连接字符串

> ID：453404
> 
> 赞同：2
> 
> 时间：2009-01-17T14:56:57.273
> 
> 标签：c#, sql, string, authentication, connection

我正在部署一个使用 SQL Server 2005 的 Windows 应用程序。该程序将使用 SQL 身份验证。

我的问题是，当您不知道用户名/密码是什么时，您如何处理连接字符串？您是否从加密文件中加载此文件？还是已经有处理这个问题的规定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T12:54:55.973

如果用户将提供他们的登录详细信息（用户名和密码），那么您只需要提供在您的应用程序中输入它们的能力，例如显示一个询问这些详细信息的对话框。然后，您可以使用用户提供的这些值在代码中构建连接字符串。

或者，如果您的所有用户都将使用单个 SQL 帐户进行连接，那么您可以使用加密将连接字符串放入您的 app.config 文件中，如果您想对您的用户隐藏它，请参阅 cmsjr 的答案以获取有关如何操作的示例去做这个。

或者，如果您在内部域（Int​​ranet）上开发它，则将您的数据库切换到集成安全性并将您的用户域帐户放入数据库服务器上的相关访问组中。这样您就完全不用担心收集用户名或密码了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T15:17:48.807

对 Windows 应用程序的配置部分进行加密并不像 Web 应用程序那样简单，但它肯定是可行的。这是一个[示例。](http://www.codeproject.com/KB/dotnet/EncryptingTheAppConfig.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T15:15:18.687

如果最终用户将提供您不需要做任何事情的密码，请不要将用户名/密码保存在配置文件中。如果您不希望最终用户提供密码，您可以在安装时将其放入配置文件中。但是，如果需要更改用户名并且您已经加密了连接字符串，这可能是一个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T13:18:06.160

只需确保检查用户名/密码是否有用户可能输入的“奇怪”字符。你最不想让他们改变你的连接字符串。然后基本上您只需指定驱动程序（如果使用 ODBC）、数据库、服务器，但保留所有用户名/密码和受信任的连接信息。然后只需添加用户名 = 和密码 = 将设置为等于用户最后输入的内容。但是要注意分号。如果同时存在用户名/密码和trusted_connection = true，我从未尝试过看看会发生什么。

# cocoa-touch - 将变量传递给不同的视图控制器

> ID：453406
> 
> 赞同：2
> 
> 时间：2009-01-17T14:57:23.247
> 
> 标签：cocoa-touch

我已经搜索和搜索，但没有任何效果。

我正在尝试将文本框中的文本值设置为字符串或其他任何内容，以便稍后在不同的视图控制器中调用它。我似乎无法让它工作！

我也想结转数字，比如货币。

对他们有什么想法吗？

干杯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T16:09:50.760

您可以在推送/弹出视图之前使另一个视图控制器上的实例变量保留或复制该值。例如：

```
OpenNextViewController *varNextPageController = [[OpenNextViewController alloc] initWithNibName:@"OpenNextViewController" bundle:nil];
varNextPageController .textString= self.textString;
[[self navigationController] pushViewController:varNextPageController animated:YES];
[varNextPageController release]; 
```

在此示例中的“OpenNextViewController”中有一个实例变量“textString”，它保留或复制（取决于您的需要）您的文本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T15:37:03.743

花一些时间尝试了解[模型视图控制器](http://developer.apple.com/documentation/Cocoa/Conceptual/CocoaFundamentals/CocoaDesignPatterns/chapter_5_section_4.html)模式。

在您的情况下，您可能希望在共享一个公共模型的不同视图之间共享数据。模型是您的数据的存储，在您的情况下是文本值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T15:27:12.470

你的问题有点含糊。您能否提供更多细节。*听起来*你想知道：

1.  如何从控件中获取值。对于文本字段，应该有一个文本属性，您可以从中获取值。

2.  如何在控制器之间共享值。不确定你的意思。*控制器*通常通过使用*模型*作为数据的权威版本来协调不同*视图*之间的值共享。

 *同样，如果您可以更具体一些，我们可能会提供更多帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T18:47:07.090

如果您想在多个控制器中使用它，那么我认为您需要通过模型运行它？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-19T22:41:11.323

你们认为使用 AppDelegate 作为模型的持有者从根本上是错误的吗？我的意思是 AppDelegate 对所有控制器都很容易看到，因此很容易绑定和获取/设置它的属性。

绒球

# c++ - *你*使用 C++ ABC 构造函数做什么？

> ID：453407
> 
> 赞同：1
> 
> 时间：2009-01-17T14:57:49.300
> 
> 标签：c++, constructor, interface-design, abc

这里的人们在该领域使用 C++ 抽象基类构造函数做什么？我说的是没有数据成员和非纯虚拟成员的纯接口类。

任何人都可以演示任何以有用的方式使用 ABC 构造函数的习语吗？或者仅仅是使用 ABC 实现接口的本质，它们保持为空、内联和受保护？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T17:00:54.247

> 任何人都可以演示任何以有用的方式使用 ABC 构造函数的习语吗？

这是一个例子，虽然这是一个人为的、不常见的例子。

您可以使用它来保存所有实例的列表：

```
class IFoo
{
private:
  //static members to keep a list of all constructed instances
  typedef std::set<IFoo*> Set;
  static Set s_set;

protected:
  //new instance being created
  IFoo()
  {
    s_set.insert(this);
  }

public:
  //instance being destroyed
  virtual ~IFoo()
  {
    s_set.remove(this);
  }

  ... plus some other static method and/or property
      which accesses the set of all instances ...
}; 
```

> 或者仅仅是使用 ABC 实现接口的本质，它们保持为空、内联和受保护？

更常见的是，它们根本没有被宣布！没有理由声明它们：

*   空和内联 => 为什么要声明它？
*   Protected => ABC 可能已经有一些**纯虚**方法，因此除了作为子类之外已经无法实例化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T16:46:02.730

假设所有派生类都有一些共同的行为。例如在某个外部注册表中注册自己，或检查某事的有效性。

所有这些公共代码都可以放在基类的构造函数中，并且将从每个派生类的构造函数中隐式调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T16:35:01.037

抽象基类的构造函数如何用于任何事情*？*

假设您有一个抽象基类 B 和一个派生类 D。当创建 D 类型的对象时，首先调用 B 的构造函数，但此时对象“仍然”属于 B 类型（参见[此处](http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.7)）——在特别是，从 B 的构造函数主体调用任何虚函数将调用*B 自己*的这些函数的实现。但是如果 B 是一个纯抽象类，这些虚函数都没有定义，所以程序会立即崩溃。

我猜你打算让 B 的构造函数调用虚函数的最派生类（例如 D 的）实现，对吗？这通常是一个坏主意，因为 D 的对象尚未完全构造，因此从 D 的虚函数实现内部对 D 中的成员变量的任何访问都将访问未初始化的内存。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T16:44:44.543

记住：**“资源获取就是初始化”**。

有时我们使用抽象基类作为某种锁定机制。例如，在多线程环境中，多个线程需要共享一个资源，那么一个线程可以使用构造函数作为获取资源的方式，使用析构函数来释放资源

```
void PlayWithPaintBallGun(Target &target)
{
    PaintBallGun paintBallGun;    // constructor waits until the gun is free,
                                  // then picks it up.

    paintBallGun.Aim(target);     // Shoot something
    paintBallGun.Fire();          //

                                  // Clever! The destructor is automatically
                                  // called when it goes out of scope. So we
                                  // can't forget to put the gun down.
} 
```

雨果

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T20:39:23.853

我想不出很多有用的例子。没有数据成员的类没有状态，因此无法初始化任何东西。不过，您可以让构造函数/析构函数为您记录日志。例如，要记录所有访问者对象的创建/销毁：

```
class Visitor {
public:
    Visitor() {
        std::cout << "Visitor@" << this << " created" 
                  << std::endl;
    }

    virtual ~Visitor() {
        std::cout << "Visitor@" << this << " destroyed" 
                  << std::endl;
    }

    virtual void visitA(A*) = 0;
    virtual void visitB(B*) = 0;
    // ...
}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T15:16:09.900

通常它只是将成员初始化为合理的值。

# cocoa-touch - 使用带有自定义值的 UIPickerView

> ID：453409
> 
> 赞同：0
> 
> 时间：2009-01-17T15:02:02.847
> 
> 标签：cocoa-touch

我使用导航控制器和普通视图。在视图中，我想要一个带有自定义值的 UIPickerView。它将有一列，其中包含大约 15 个值。我希望能够为每个值添加一个动作。

有什么办法可以使用 Xcode 做到这一点？我似乎找不到正确的帮助。

干杯。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T16:27:42.410

您需要查看**UIPickerViewDelegate**的文档。

为了对每个值执行操作，您将实现*pickerView:didSelectRow:inComponent:*并根据选择的行执行不同的操作。

对于行的内容，您可以实现*pickerView:titleForRow:forComponent:*如果您的内容是简单文本。

*如果您想要自定义绘制的内容，您可以使用pickerView:viewForRow:forComponent:reusingView:*方法为每一行提供自定义视图。

请参阅 iPhone 开发人员示例中提供的 UICatalog 示例。

# bash - 用于调整图像大小的 shell 脚本

> ID：453410
> 
> 赞同：4
> 
> 时间：2009-01-17T15:02:09.103
> 
> 标签：bash, image-manipulation

有没有办法调整目录中的所有图像大小？

如果我将最大尺寸设置为 800x600，它将使较大的尺寸变小，而将较小的尺寸保留为原始尺寸。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-17T15:09:55.577

```
for img in *.png; do
    convert "$img" "800x600>" $(basename "$img" .png)_new.png
done 
```

`convert`来自 ImageMagick。">" 表示只有在更大时才会调整大小。有关其他选项，请参见[此处](http://www.imagemagick.org/script/command-line-options.php#resize)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T15:06:20.357

需要安装图片魔法包： mogrify -resize 320x240 *.jpg 其中 320 = 宽度，240 = 高度

或者您可以只保留宽度参数： mogrify -resize 320 *.jpg 其余部分将被处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T15:07:37.563

存在各种用于命令行或脚本驱动的图像文件操作的软件包。

我建议看[`netpbm`](http://netpbm.sourceforge.net/), 或[`ImageMagick`](http://www.imagemagick.org/script/index.php). 我个人更喜欢前者，因为它使用起来要简单得多。

# php - 帮助包含功能

> ID：453420
> 
> 赞同：0
> 
> 时间：2009-01-17T15:13:59.703
> 
> 标签：php, function

我试图用 PHP 制作一个简单的模板系统。我是 PHP 新手，所以没什么大不了的。我有一些问题：

一个常规的包括作品：

```
$variable = "test";
include("templates/news.html"); 
```

但这不会：

这说`$variable`是未定义的：

```
$variable = "test";
getTemplate("news"); 
```

功能：

```
function getTemplate($tpl) {
    $file = "templates/$tpl.html";
    if (file_exists($file))
        return include($file);
    return false;
} 
```

新闻.html

```
<h1>php echo $variable</h1> 
```

该函数有效并包含页面，但它不写出变量

我在所有页面的顶部包含该功能。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T15:48:16.450

使用[extract](http://php.net/extract)函数，您可以从数组中定义不同的变量。

你可以这样：

```
$vars = array('var1' => "value1", 'var2' => "value2");

function getTemplate($tpl, $vars) {
$file = "templates/$tpl.html";

extract($vars, EXTR_SKIP)

if (file_exists($file))
    return include($file);
return false;
}

getTemplate('news', $vars); 
```

在您的模板中，您可以使用 $var1 和 $var2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T15:22:13.790

您正在尝试在函数中访问全局变量。

你必须要么在函数中声明一个全局变量，要么只使用：$GLOBALS["variable"]

```
function () {
global $variable;
etc..
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T16:43:40.303

您是否考虑过使用[Smarty](http://www.smarty.net/)

如果你不想使用这个模板引擎，也许你应该检查一下它背后的一些想法。简而言之，它通过将变量值分配给对象来处理将变量分配给模板。如果您将变量分配给模板对象，则可以在模板文件中使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T15:22:56.160

因为您从函数内部包含文件，所以该文件的内容不再在全局范围内。

您要么需要添加`global $variable;`到函数的开头，要么`echo $GLOBALS['variable'];`在 news.html 中使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T15:26:53.610

我相信您的问题与变量范围有关。当你调用一个函数时，你无法访问该函数之外的变量，除了全局变量（稍后会详细介绍）或传递给你的函数的变量。该[`global`](http://us.php.net/global)函数告诉 PHP 您希望在函数中使用与父作用域中相同的变量。您还可以使用该[`define`](http://us.php.net/define)函数为您的脚本定义常量，这些常量可以被普遍访问。

使用大量全局变量是非常不受欢迎的，我建议将关联数组传递给函数，或者使用更面向对象的方法。

希望这会有所帮助，雅各布

# vbscript - 需要帮助删除“;” 数组中项目的分隔符，VBscript

> ID：453424
> 
> 赞同：1
> 
> 时间：2009-01-17T15:15:24.630
> 
> 标签：vbscript

我的代码是从列出多个文件路径并使用分号“;”作为分隔符的数据单元格中提取的。拆分数据并将其放入数组后，我需要删除分号。否则我的文件路径在进入循环时无效。

澄清一下：我的代码在数据单元格中只有一个文件路径时有效，并且由于“；”而在遇到具有多个路径的单元格时死亡

任何帮助将非常感激。

我的代码如下：

```
<%
strValue = RS("ATTACHMENTS")
strAryWords = Split(strValue, ";")

' - strAryWords is now an array
For i = 0 to Ubound(strAryWords)
    Set fso = Server.CreateObject("Scripting.FileSystemObject")
    Set fileObject = fso.getFile(strAryWords(i))

    Response.Write "<TH><TR align=left><TD>" & strAryWords(i) &"  "& fileObject.Size &"  "&"<img src=images/up.gif><BR></TD></TR>"

    Set fileObject = Nothing
    Set fso = Nothing  
Next
%> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T21:52:21.647

如果问题是 strValue 有一个尾随 ';'，请将您的代码更改为：

```
strValue = RS("ATTACHMENTS")
strAryWords = Split(strValue, ";")

' - strAryWords is now an array
For i = 0 to Ubound(strAryWords)
    If strAryWords(i) <> "" Then
        Set fso = Server.CreateObject("Scripting.FileSystemObject")
        Set fileObject = fso.getFile(strAryWords(i))

        Response.Write "<TH><TR align=left><TD>" & strAryWords(i) &"  "& fileObject.Size &"  "&"<img src=images/up.gif><BR></TD></TR>"

        Set fileObject = Nothing
        Set fso = Nothing
    End If
NEXT 
```

# c++ - 在 C/C++ 中初始化和归零数组的区别？

> ID：453432
> 
> 赞同：18
> 
> 时间：2009-01-17T15:21:37.143
> 
> 标签：c++, c, arrays

在 c (或者可能是 c++) 中，有什么区别

```
char myarr[16]={0x00};

```

和

```
char myarr[16];
memset(myarr, '\0', sizeof(myarr));

```

??

编辑：我问这个是因为在 vc++ 2005 中结果是一样的..
编辑更多：和

```
char myarr[16]={0x00,};
```

?
也许可以得到更全面的答案，而不是模棱两可，因为下面的一些答案是指这种代码，即。将逗号放在大括号之前。vc++ 2005 中的结果也是一样的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-01-17T15:38:41.323

重要的区别是第一个默认值以特定于元素的方式初始化数组：指针将接收一个*空指针值*，它不需要为 0x00（如在所有位为零），布尔值将是*false*。如果元素类型不是所谓的*POD*（普通旧数据类型）的类类型，那么您只能执行第一个，因为第二个仅适用于最简单的情况（您没有*virtual函数*，用户定义的构造函数等）。相比之下，使用 memset 的第二种方法将数组的所有元素设置为所有位为零。这并不总是你想要的。例如，如果您的数组具有指针，则它们不一定会设置为空指针。

第一个将默认初始化数组的元素，第一个除外，它显式设置为 0。如果数组是本地的并且在堆栈上（也就是说，不是静态的），编译器内部通常会执行一个 memset 来清除数组。如果数组是非本地的或静态的，第一个版本的*效率会高得多*。编译器可以在编译时将初始化程序放入生成的汇编代码中，使其根本不需要运行时代码。或者，当程序以快速方式（即按页方式）启动时，可以将数组布置在自动归零的部分上（也适用于指针，如果它们具有全位零表示）。

第二个在整个数组上显式地执行 memset。优化编译器通常会将较小区域的 memset 替换为仅使用标签和分支循环的内联机器代码。

[这是为第一种情况生成的汇编代码。我的 gcc 的东西没有太多优化，所以我们真正调用了 memset（堆栈顶部的 16 个字节总是被分配，即使我们没有本地人。$n 是一个寄存器号）：]

```
void f(void) {
    int a[16] = { 42 };
}

sub     $29, $29, 88 ; create stack-frame, 88 bytes
stw     $31, $29, 84 ; save return address
add     $4, $29, 16  ; 1st argument is destination, the array.
add     $5, $0, 0    ; 2nd argument is value to fill
add     $6, $0, 64   ; 3rd argument is size to fill: 4byte * 16
jal     memset       ; call memset
add     $2, $0, 42   ; set first element, a[0], to 42
stw     $2, $29, 16  ;
ldw     $31, $29, 84 ; restore return address
add     $29, $29, 88 ; destroy stack-frame
jr      $31          ; return to caller 
```

C++ 标准中的血腥细节。上面的第一种情况将默认初始化剩余的元素。

`8.5`：

> 对 T 类型的对象进行零初始化存储意味着：
> 
> *   如果 T 是标量类型，则存储设置为*转换为 T*的值 0（零） ；
> *   如果 T 是非联合类类型，则每个非静态数据成员和每个基类子对象的存储都是零初始化的；
> *   如果 T 是联合类型，则其第一个数据成员的存储为零初始化；
> *   如果 T 是数组类型，则每个元素的存储都是零初始化的；
> *   如果 T 是引用类型，则不执行初始化。
> 
> 默认初始化 T 类型的对象意味着：
> 
> *   如果 T 是非 POD 类类型，则调用 T 的默认构造函数
> *   如果 T 是数组类型，则每个元素都是默认初始化的；
> *   否则，对象的存储被零初始化。

`8.5.1`：

> 如果列表中的初始化器少于聚合中的成员，则每个未显式初始化的成员都应*默认初始化*（8.5）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-01-17T15:42:47.400

ISO/IEC 9899:TC3 6.7.8，第 21 段：

> 如果大括号括起来的列表中的初始值设定项少于聚合的元素或成员，或者用于初始化已知大小数组的字符串文字中的字符少于数组中的元素，则聚合的其余部分应隐式初始化与具有静态存储持续时间的对象相同。

具有静态存储持续时间的数组被初始化为`0`，因此 C99 规范保证未显式初始化的数组元素也被设置`0`为。

* * *

在我对这篇文章的第一次编辑中，我说了一些关于在初始化后使用复合文字分配给数组的废话。那是行不通的。如果您真的想使用复合文字来设置数组的值，则必须执行以下操作：

```
#define count(ARRAY) (sizeof(ARRAY)/sizeof(*ARRAY))

int foo[16];
memcpy(foo, ((int [count(foo)]){ 1, 2, 3 }), sizeof(foo)); 
```

使用一些宏魔法和非标准`__typeof__`运算符，这可以大大缩短：

```
#define set_array(ARRAY, ...) \
    memcpy(ARRAY, ((__typeof__(ARRAY)){ __VA_ARGS__ }), sizeof(ARRAY))

int foo[16];
set_array(foo, 1, 2, 3); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-17T17:09:35.163

开始可能`char myarr[16]={0x00};`不是一个好例子，因为显式和隐式成员初始化都使用零，因此更难解释在这种情况下发生了什么。我认为一个具有非零值的真实示例可能更具说明性：

```
/**
 * Map of characters allowed in a URL
 *
 * !, \, (, ), *, -, ., 0-9, A-Z, _, a-z, ~
 *
 * Allowed characters are set to non-zero (themselves, for easier tracking)
 */
static const char ALLOWED_IN_URL[256] = {
/*          0      1      2      3      4      5      6      7      8      9*/
/*   0 */   0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
/*  10 */   0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
/*  20 */   0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
/*  30 */   0,     0,     0,    '!',    0,     0,     0,     0,     0,   '\'',
/*  40 */  '(',   ')',   '*',    0,     0,    '-',   '.',    0,    '0',   '1',
/*  50 */  '2',   '3',   '4',   '5',   '6',   '7',   '8',   '9',    0,     0,
/*  60 */   0,     0,     0,     0,     0,    'A',   'B',   'C',   'D',   'E',
/*  70 */  'F',   'G',   'H',   'I',   'J',   'K',   'L',   'M',   'N',   'O',
/*  80 */  'P',   'Q',   'R',   'S',   'T',   'U',   'V',   'W',   'X',   'Y',
/*  90 */  'Z',    0,     0,     0,     0,    '_',    0,    'a',   'b',   'c',
/* 100 */  'd',   'e',   'f',   'g' ,  'h',   'i',   'j',   'k',   'l',   'm',
/* 110 */  'n',   'o',   'p',   'q',   'r',   's',   't',   'u',   'v',   'w',
/* 120 */  'x',   'y',   'z',    0,     0,     0,    '~',
}; 
```

这是一个可以在对字符串进行 URL 编码时使用的查找表。只有 URL 中允许的字符设置为非零值。零表示该字符不被允许，需要进行 URL 编码 ( `%xx`)。请注意，该表突然在波浪字符后以逗号结尾。波浪号后面的任何字符都是不允许的，因此应设置为零。但是，我们没有编写更多的零来填充表最多 256 个条目，而是让编译器隐式地将其余条目初始化为零。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-18T13:39:37.203

`= { 0 }`鉴于比 更具可读性这一无可争辩的事实`memset(..., ..., ... sizeof ...)`，那么以下内容将不鼓励明确使用`memset`：

在 Visual Studio 2005 中，为 Windows Mobile 编译，完全优化的发布版本：

```
; DWORD a[10] = { 0 };

mov         r3, #0
mov         r2, #0x24
mov         r1, #0
add         r0, sp, #4
str         r3, [sp]
bl          memset
add         r4, sp, #0
mov         r5, #0xA

; DWORD b[10];
; memset(b, 0, sizeof(b));

mov         r2, #0x28
mov         r1, #0
add         r0, sp, #0x28
bl          memset
add         r4, sp, #0x28
mov         r5, #0xA 
```

基本上一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-10T04:55:55.523

在变量声明中定义初始值与使用 memset 不同。

对于前一种情况，零在二进制文件中以某种形式定义为零初始化内存（或非零，具体取决于您初始化的内容），并且您希望加载器尊重这一点，与 C 语言标准完全无关。后者，使用 memset 取决于您也可以使用的 C 库。我对图书馆更有信心。

我做了很多嵌入式代码，你学会了避免将变量初始化为变量声明的一部分的坏习惯，而是在代码中进行。

对于标准操作系统、Linux、Windows 等，变量声明期间的 init 很好，您将获得难以察觉的性能提升，但如果您正在运行一个操作系统，那么您在一个足够快的平台上看不到这种差异。

根据二进制类型，声明期间 init 的前一种情况可以使二进制更大。这非常容易测试。如上所述编译二进制文件，然后将数组大小从 [16] 更改为 [16000]，然后再次编译。然后在没有 = {0x00} 的情况下编译并比较三个二进制大小。

For most systems that most programmers will ever see, there is no functional difference. I recommend the memset as a habit. Despite what standards say many if not most C compilers (of which most programmers will never see in their careers) wont like that init because the number of elements doesnt match the size. Most compilers do not conform to the standards even if they claim to. Instead develop good habits that avoid shortcuts or pretty much anything that should work for standard X but is different from the prior standard M. (Avoid any gee whiz compiler or standards based tricks).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T00:45:02.157

实际上它们是一样的。第一种形式保证将整个类型初始化为 0x00（例如，甚至结构元素之间的填充空间），这是从 C90 开始定义的。不幸的是，gcc 使用 -Wmissing-field-initializers 选项对第一个表单发出警告。更多细节在这里：

[http://www.pixelbeat.org/programming/gcc/auto_init.html](http://www.pixelbeat.org/programming/gcc/auto_init.html)

# jakarta-ee - Java EE 6 发布日期

> ID：453436
> 
> 赞同：2
> 
> 时间：2009-01-17T15:23:30.183
> 
> 标签：jakarta-ee

Java EE 6 看起来令人兴奋。它将包括 Servlet 3.0 规范、EJB3.1 Lite、Profiles、JSF2.0 Restful API、JPA2.0 和 WebBeans。

我试图用谷歌搜索该平台的预定发布日期，但找不到任何官方信息。任何人？或者它只是它的工作方式？一旦所有 JCP 专家组完成规范，它就会成为官方的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T15:58:55.167

JSR316 [（](http://jcp.org/en/jsr/detail?id=316) JavaTM 平台，企业版 6（[Java EE](http://en.wikipedia.org/wiki/Java_Platform,_Enterprise_Edition) 6）规范），根据这个“规范”页面，“目标是在 2008 年发布。”。

咳咳。

如果您将它们的阶段与之前的 Java EE（[JSR 244](http://jcp.org/en/jsr/detail?id=244)中的 Java EE 5 ）进行比较，您会发现：

*   Java EE 6 处于“早期草稿审查”阶段，于 2008 年 11 月完成
*   Java EE 5“Early Draft Review”与最终发布之间的月数为：12 个月（2005 年 5 月至 2006 年 5 月最终发布）。

所以给你。我不知道平行是否准确，但这是你现在唯一可以猜测的日期。尽管[InfoQ](http://www.infoq.com/news/2008/11/openejb-3.1-release)或[JavaOne200](http://technology.amis.nl/blog/3163/javaone-2008-lingo-keywords-recurring-themes-buzzwords-and-hype-terms) 8 提到“2009 年初”作为可能的发布日期，但它可能会比那晚一点（比如“2009 年第四季度”！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-23T16:45:01.677

Robert Chinnici 的[博客](http://weblogs.java.net/blog/robc/)是一个很好的查看位置 - 最初他们为 JavaOne 2009[版本](http://weblogs.java.net/blog/robc/archive/2008/10/update_on_the_s.html)拍摄，现在看起来比[那晚](http://weblogs.java.net/blog/robc/archive/2009/01/java_ee_6_platf_1.html)。

我最好的猜测是他们会非常努力地为 JavaOne 2009 提供某种预览 - 可能在 6 个月后发布生产版本 - 即 2009 年末。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T15:06:03.207

据此，它定于[今年](http://www.internetnews.com/dev-news/article.php/3825056/Where+Is+Java+EE+6.htm)秋季。

# flash - 用于通过 Java2D 渲染矢量图形格式的开源库？

> ID：453437
> 
> 赞同：3
> 
> 时间：2009-01-17T15:24:21.570
> 
> 标签：flash, svg, java-2d, eps, vml

我有哪些选择可以将 Java2D 编码的图形渲染为矢量图形格式，例如 EPS、SWF、SVG、VML、PDF 和其他我可能还没有听说过的开源库？

[Batik](http://xmlgraphics.apache.org/batik/)是用于渲染 SVG 的最广泛使用的库。还有哪些其他选择？

[iText](http://www.lowagie.com/iText/)广泛用于呈现 PDF。是否有一些功能较少但可能更简单的东西？

对于[从 Java2D 渲染 SWF (Flash)](https://stackoverflow.com/questions/267001/save-java2d-to-swf-flash)，我发现Flagstone Software 的[Transform SWF非常有效，即使不直观。](http://www.flagstonesoftware.com/transform/)

哪些不太受欢迎的库或刚起步的项目值得一看？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T16:05:14.390

Batik 和 iText 都是很好的库。我也尝试过[Apache PDFBox](http://incubator.apache.org/pdfbox/)，但我认为它不支持 Java2D。

关于 iText，虽然它具有广泛的功能，但您仍然可以通过[PdfGraphics2D](http://www.1t3xt.info/api/com/lowagie/text/pdf/PdfGraphics2D.html)类将其用于简单的 Java2D 渲染任务。一个简短的例子说明这是多么简单，请参阅这个[链接](http://itextdocs.lowagie.com/tutorial/directcontent/graphics2D/index.php)。

以下是您可能想要探索的其他一些资源：

*   [EpsGraphics2D](http://www.jibble.org/epsgraphics/) (EPS)
*   [Apache FOP](http://xmlgraphics.apache.org/fop/)（PDF、PS、带有蜡染的 SVG）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-07T03:35:25.607

如果您只想将 Java2D 保存到 PostScript，那么无需任何附加库，这真的很容易：请参阅[http://weblogs.java.net/blog/cayhorstmann/archive/2009/10/08/how-draw-简单图表-easy-way-java2d](http://weblogs.java.net/blog/cayhorstmann/archive/2009/10/08/how-draw-simple-diagrams-easy-way-java2d)。然后，您可以使用 ps2eps 将输出转换为 EPS，或使用 ps2pdf 将其转换为 PDF。

# c++ - C++ 中的 COM 事件处理

> ID：453440
> 
> 赞同：2
> 
> 时间：2009-01-17T15:25:39.260
> 
> 标签：c++, com

**没有**以下内容：

*   ATL
*   MFC

**问题：**

*   一旦特定事件终止， 如何让 COM**服务器**向 COM**客户端报告？**

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T17:12:31.040

**请参阅：** [**COM**事件处理 - IConnectionPointContainer - 插图](http://www.codeproject.com/KB/COM/TEventHandler.aspx?fid=133954&df=90&mpp=25&noise=3&sort=Position&view=None&select=2755820#xx2755820xx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T16:57:14.190

使用 IConnectionPointContainer

# linux - 在 Unix 中，我可以在一个目录中运行“make”而不先 cd'ing 到那个目录吗？

> ID：453447
> 
> 赞同：239
> 
> 时间：2009-01-17T15:31:29.840
> 
> 标签：linux, unix, makefile

在 Unix 中，我可以`make`在一个目录中运行而无需`cd`先进入该目录吗？

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2009-01-17T15:33:52.877

`make -C /path/to/dir`

* * *

## 回答 #2

> 赞同：104
> 
> 时间：2009-01-17T15:44:49.377

如其他答案所述， make(1) 有一个`-C` 选项；几个命令具有相似的选项（例如 tar）。值得注意的是，对于缺少此类选项的其他命令，可以使用以下命令：

```
(cd /dir/path && command-to-run) 
```

这将在子 shell 中运行命令，该子 shell 首先更改了其工作目录（同时保留父 shell 的工作目录）。这里`&&` 用于代替`;` 捕获无法更改目录的错误情况。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-01-19T05:25:56.233

如果您不想 cd 到某个目录的原因是因为您需要留在当前目录中以执行以后的任务，则可以使用 pushd 和 popd：

```
pushd ProjectDir ; make ; popd 
```

它进入 ProjectDir，运行 make，然后回到你原来的位置。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-09-15T10:24:00.093

您也可以使用：

```
make --directory /path/to/dir 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2018-09-23T22:56:33.997

生成文件：

```
all:
    gcc -Wall -Wpedantic -std=gnu99 -g src/test.c -o build/test

run:
    ./build/test 
```

或者

```
run:
    ./../build/test 
```

等等

# ruby-on-rails - 特征区分：Rails / Django

> ID：453448
> 
> 赞同：3
> 
> 时间：2009-01-17T15:32:01.320
> 
> 标签：ruby-on-rails, django, reporting, integration, language-features

*   Rails 或 Django 中是否有其他框架中不存在的重要功能？
*   对于企业 Web 应用程序，是否缺少任何重要的东西？

这个问题不是为了争论——我试图为即将到来的项目做出明智的技术决策。关于选择其中一个框架，我有两个担忧是：

1.  与外部系统（Java、.Net、SAP 等）集成
2.  报告 - 使用任一框架生成复杂的报告/图表（财务）是否会有任何困难。这将需要多表连接、自定义排序、分页（w/ajax）和不同设备的打印。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-17T17:46:17.993

Jython 上的 Django 运行良好，因此 Java 集成应该不是问题。

在集成方面，不要忘记 Django 也是 Python，因此您拥有标准库的大量支持以及所有其他成熟且支持良好的 Python 项目。将第 3 方 Python 代码集成到 Django 项目中通常是微不足道的。

冒着成为福音派的风险，我将列出以下 Django 杀手级功能：

1.  管理员
2.  文档
3.  Python ;-）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-19T17:06:20.873

Django 也有 GeoDjango。纽约时报在他们的[Represent](http://open.blogs.nytimes.com/2008/12/22/represent/ "代表")项目中选择了 Django 而不是 Ruby，以便于映射支持：

“我们使用 Python Web 框架 Django 构建 Represent。虽然我们的大部分工作都是使用 Ruby on Rails 完成的，但我们为这个项目选择了 Django，因此我们可以使用 GeoDjango，一个支持几何字段并扩展 ORM 以允许空间查询。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T17:12:59.760

我的经验/意见是，Rails 更加灵活，生态系统更加多样化，并且发展速度更快，而 Django 更稳定，变化更慢，文档更好。

Rails 在通过 JRuby 与其他系统集成方面具有巨大优势。您可以让 rails 访问整个 Java 生态系统并在 JVM 上运行它。

Django 可能能够通过 IronPython 来利用 .Net（除了 IronPython 存在之外，我对此一无所知 - 而 IronRuby 只是在路上，但还没有出现）

# c# - 解决扩展方法/LINQ 歧义

> ID：453451
> 
> 赞同：29
> 
> 时间：2009-01-17T15:34:10.863
> 
> 标签：c#, .net, visual-studio-2008, linq, extension-methods

我正在为[ReSharper](http://en.wikipedia.org/wiki/ReSharper) 4 编写一个加载项。为此，我需要引用几个 ReSharper 的程序集。其中一个程序集 (JetBrains.Platform.ReSharper.Util.dll) 包含一个`System.Linq`命名空间，其中包含 System.Core 已提供的扩展方法子集。

例如，当我编辑代码时，它会在这些扩展之间产生歧义，因此我无法使用`OrderBy`. 我怎么能解决这个问题？我想使用核心[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)扩展，而不是来自 ReSharper 的扩展。

尝试编译时出现以下错误：

> 以下方法或属性之间的调用不明确：' `System.Linq.Enumerable.OrderBy<string,int>(System.Collections.Generic.IEnumerable<string>`, `System.Func<string,int>)' and 'System.Linq.Enumerable.OrderBy<string,int>(System.Collections.Generic.IEnumerable<string>, System.Func<string,int>`)'

**编辑：**我尝试了下面的建议，不幸的是没有运气。同时，我通过删除对`System.Core`. 这样我就可以使用 ReSharper DLL 文件提供的扩展。

我[上传了一个示例程序](http://a.imagehost.org/download/0589/ClassLibrary1)，我刚刚导入了我需要的 ReSharper DLL 文件。我更改了`System.Core`to的别名`SystemCore`，添加了`extern alias`指令，但它仍然不起作用。如果我错过了什么，请告诉我。PS 引用的是安装在默认目录中的 ReSharper v4.1 DLL 文件`"C:\Program Files\JetBrains\ReSharper\v4.1\..."`。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-01-17T15:42:21.457

[这可能是使用extern alias](http://msdn.microsoft.com/en-us/library/ms173212.aspx)有意义的少数情况之一。

在对 System.Core 的引用的属性页面中（即在 References 下，选择 System.Core，右键单击并选择“Properties”），将“Aliases”值更改为“global,SystemCore”（或者如果只是“SystemCore”一开始是空白的）。

然后在你的代码中，写：

```
extern alias SystemCore;
using SystemCore::System.Linq; 
```

这将使 System.Core.dll 的 System.Linq 命名空间中的所有相关类型等可用。此处的“SystemCore”名称是任意的——您可以将其称为“DotNet”或其他名称，如果这样会让您更清楚的话。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-17T19:47:55.827

这并不是真正的答案，但可能会为其他人提供一种更简单的方法来重现该问题（从命令行 - 如果需要，您可以使用 Visual Studio 中的两个项目来完成）。

1) 创建 BadLinq.cs 并将其构建为 BadLinq.dll：

```
using System.Collections.Generic;

namespace System.Linq
{
    public static class Enumerable
    {
        public static IEnumerable<T> Where<T>(this IEnumerable<T> source, 
                                              Func<T,bool> predicate)
        {
            return null;
        }
    }
} 
```

2）创建Test.cs：

```
extern alias SystemCore;

using System;
using SystemCore::System.Linq;

static class Test
{
    static void Main()
    {
        var names = new[] { "Larry", "Curly", "Moe" };

        var result = names.Where(x => x.Length > 1);
    }
} 
```

3) 编译 Test.cs 指定外部别名：

```
csc Test.cs /r:BadLinq.dll /r:SystemCore=System.Core.dll 
```

这失败了：

> Test.cs(11,28)：错误 CS1061：“System.Array”不包含“Where”的定义，并且找不到接受“System.Array”类型的第一个参数的扩展方法“Where”（你是缺少 using 指令或程序集引用？）

如果您将其更改为不尝试使用扩展方法（即 Enumerable.Where），则它可以与 extern 别名一起正常工作。

我认为这*可能*是一个编译器错误。我已经通过电子邮件发送了一个 C# 团队阅读的私人邮件列表 - 当我收到回复时，我会更新这个答案或添加一个新答案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T08:09:10.450

这不再是一个问题，因为我可以使用 ReSharper DLL 文件提供的 LINQ 扩展，即使是针对 .NET 3.0 也是如此。

斯基特先生又说对了！我能够使用完整的 LINQ 语法，同时在项目的属性中定位 .NET 3.0 而不是引用 System.Core！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-04-14T11:37:44.900

为了使 ReSharper 尽可能与它所使用的各种解决方案兼容，它是针对 .NET 2.0 构建的。LINQ 等出现在 C# 3.0 中，因此它们在该版本的框架中不可用。因此，JetBrains 添加了自己的版本。

解决方案也是针对 .NET 2.0 构建您的插件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-29T16:20:35.300

我在使用 System.ComponentModel 时遇到了模棱两可的参考问题。Visual Studio 抱怨在 v2 和 v4 中都存在 DLL 文件。我能够通过删除对系统 DLL 文件的引用并读取它来解决它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T21:33:04.400

一种解决方案是将所有代码移到使用 ReSharper 代码的部分类中。在那里，您将只导入 ReSharper 命名空间，而不是 System.Core。

在部分类的其余部分中，您将导入所需的所有其他命名空间，包括 System.Core，但不导入 ReSharper 命名空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-28T22:20:03.130

即使使用外部别名，我也遇到了同样的问题，我[将其作为](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=510113)Connect 上的编译器错误提出。暂时的解决方法是放弃扩展方法语法。

该错误已针对 Visual Studio 2010 修复。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-05T11:56:12.817

这确实是一个编译器错误。

我有同样的问题，我只是通过清理和重建项目来解决它。之后问题就消失了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-17T07:59:01.300

我也有类似的情况。经过两个小时的努力，我意识到我的库中有重复的命名空间名称。如果您使用的是 Microsoft 发布的文件 Dynamic.cs，您唯一需要做的就是将当前命名空间重命名为其他名称，它将被修复。

```
//Copyright (C) Microsoft Corporation.  All rights reserved.

using System;
using System.Collections.Generic;
using System.Text;
using System.Linq;
using System.Linq.Expressions;
using System.Reflection;
using System.Reflection.Emit;
using System.Threading;

namespace System.Linq.Dynamic    <- for example to Linq.Dynamic
{ 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-08-13T20:20:40.477

在 MVC（.Net 4.5，MVC 5）中使用 PagedList 时，我发现了同样的歧义。我发现，如果我将对象作为不明确的论点并首先明确地转换它，那么问题就解决了。如果歧义是在采用 System.Linq.Enumerable 的方法和采用 System.Collections.Generic.IEnumerable 作为相关参数的方法之间，并且源是 System.Collections.Generic.IEnumerable 类型，我不使用扩展方法就可以了。我投了它。在这个例子中，我的存储库方法返回一个列表：

```
searchRequest.CaseSearchResults = csr.SelectMatchingCases(searchRequest);
var results = searchRequest.CaseSearchResults.AsEnumerable<CaseSearchResult>();
int pageNum = (int)(ViewBag.PageNum ?? 1);
var pageResults =results.ToPagedList<CaseSearchResult>(pageNum, 5); 
```

**在searchRequest.CaseSearchResults**上调用扩展方法导致歧义错误；显式转换为**结果**，然后调用该扩展名。

# c# - 寻找完全托管的 WeifenLuo(DockPanel Suite) 替代品或实施的提示

> ID：453473
> 
> 赞同：1
> 
> 时间：2009-01-17T15:47:18.903
> 
> 标签：c#, winforms, mono, dockpanel-suite

我需要一个 WeifenLuo 替代品，它可以在 .NET 和 Mono、Windows、Linux 和 Mac 上运行，最好在 MIT 许可下获得许可。如果 API 与 WeifenLuo 的 API 相似，我将不胜感激，但我知道这样的 API 可能不可用。

另外，由于我在谷歌上找不到任何东西，我相信这可能不存在。在这种情况下，我想要一些关于如何实现它的提示。

我有一些（不多）Windows.Forms 经验，我不能使用任何 P/Invoke。我已经知道如何检测窗口运动以及如何在给定位置和给定大小创建无边框半透明窗口。

所以这是我面临的一些问题：

1.  WeifenLuo 支持多个左/右/上/下窗格，允许它们调整大小并包含多个面板。
2.  它还支持可拆分的选项卡。

在开始之前我还有什么需要注意的吗？是否有类似的开源项目可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-03T03:30:01.783

在 Mono 上运行时，可以禁用所有 PInvoke 到 Win32 API。您付出的代价是失去对 Mono/Linux 的拖放支持，这在某些情况下可能是可以接受的。

**编辑：[http](http://www.lextm.com/2012/05/a-call-to-the-community-dockpanel-suite-history-and-future-2/) ://www.lextm.com/2012/05/a-call-to-the-community-dockpanel-suite-history-and-future-2/ DPS 的一个分支现在托管在 GitHub 上，[http： //github.com/dockpanelsuite/dockpanelsuite](http://github.com/dockpanelsuite/dockpanelsuite)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T00:03:32.327

我一直想要同样的东西。我一直在测试 win 表单的基本布局系统，发现 WinForms 的单声道 Mac 版本不是 100% 完整的，就像拖放没有实现并且速度很慢。

根据我自己的搜索，GTK# 在所有平台上都有最好的支持。另一种方法是为每个平台拆分 UI，即 WinFoms、GTK# (linux) 和 Cocoa (cocoa#/monobjc)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T20:53:28.580

GTK# 看起来不错，但涉及，并且有一个学习曲线。我自己，我尝试过 QuickSharp，但在任何地方都找不到支持，而且 weifenluo 对接系统缺乏一些功能，并且难以实现表单大小。

我最终选择了`[dockDotNet][1]`它允许一个`minimumsize`参数，并且很容易使用。您可以使用属性管理器设置几乎所有浮动表单属性 - 甚至设置表单图标！

# python - Queryset API distinct() 不起作用？

> ID：453477
> 
> 赞同：7
> 
> 时间：2009-01-17T15:49:11.287
> 
> 标签：python, django

```
class Message(models.Model):
    subject = models.CharField(max_length=100)
    pub_date = models.DateTimeField(default=datetime.now())

class Topic(models.Model):
    title = models.CharField(max_length=100)
    message = models.ManyToManyField(Message, verbose_name='Discussion') 
```

我想根据附加到该主题的最新消息对象对所有主题进行排序。我执行了这个查询，但这并没有给出不同的查询集。

```
>> Topic.objects.order_by('-message__pub_date').distinct() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-24T16:16:07.010

你不需要 distinct() 这里，你需要的是[aggregation](http://docs.djangoproject.com/en/dev/topics/db/aggregation/#topics-db-aggregation)。此查询将执行您想要的操作：

```
from django.db.models import Max
Topic.objects.annotate(Max('message__pub_date')).order_by('-message__pub_date__max') 
```

虽然如果这是生产代码，您可能希望遵循 akaihola 的建议，将“last_message_posted”直接非规范化到主题模型上。

此外，Message.pub_date 的默认值存在错误。正如您现在所拥有的，每当您第一次运行服务器并加载此代码时， datetime.now() 将执行一次，该值将用作所有消息的 pub_date。改用它来传递可调用对象本身，因此在创建每个消息之前不会调用它：

```
pub_date = models.DateTimeField(default=datetime.now) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-20T10:14:16.947

您可以在[文档中`.distinct()`](http://docs.djangoproject.com/en/dev/ref/models/querysets/#distinct)找到.

我会通过向模型添加一个`modified_date`字段`Topic`并在保存或删除消息时更新它来进行反规范化。

# java - java.util.Random 有多好？

> ID：453479
> 
> 赞同：47
> 
> 时间：2009-01-17T15:50:40.130
> 
> 标签：java, random

两个问题：

对于我投入其中的每颗种子，我会得到不同的数字序列吗？

有一些“死”的种子吗？（产生零或快速重复的那些。）

顺便说一句，我应该使用哪些其他 PRNG（如果有）？

解决方案：因为我将使用 PRNG 来制作游戏，所以我不需要它是加密安全的。我会选择 Mersenne Twister，因为它的速度和周期都很长。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-01-17T16:44:24.153

在某种程度上，随机数生成器是课程的马。Random 类使用合理选择的参数实现 LCG。但它仍然表现出以下特点：

*   相当短的时期（2 ^ 48）
*   位不是同样随机的（请参阅我关于[位位置随机性的](http://www.javamex.com/tutorials/random_numbers/lcg_bit_positions.shtml)文章）
*   只会生成一小部分值*组合*（著名的“[坠入平面](http://www.javamex.com/tutorials/random_numbers/lcg_planes.shtml)”问题）

如果这些事情对您来说并不重要，那么 Random 具有作为 JDK 的一部分提供的赎回功能。对于休闲游戏（但不是涉及金钱的游戏）来说，这已经足够了。没有像这样的弱种子。

另一种选择是[XORShift 生成器](http://www.javamex.com/tutorials/random_numbers/xorshift.shtml)，它可以用 Java 实现，如下所示：

```
public long randomLong() {
  x ^= (x << 21);
  x ^= (x >>> 35);
  x ^= (x << 4);
  return x;
} 
```

对于一些非常便宜的操作，它的周期为 2^64-1（不允许为零），并且足够简单，可以在重复生成值时内联。可能有各种移位值：有关更多详细信息，请参阅 George Marsaglia 关于 XORShift 生成器的论文。您可以将生成的数字中的位视为同样随机。一个主要的弱点是，它偶尔会进入一个“车辙”，其中没有多少位设置在数字中，然后需要几代人才能摆脱这个车辙。

其他可能性是：

*   组合不同的生成器（例如，将 XORShift 生成器的输出馈送到 LCG，然后将结果添加到具有不同参数的 XORShift 生成器的输出中）：这通常可以“消除”不同方法的弱点，并且可以如果仔细选择组合发电机的周期，则给出更长的周期
*   添加“滞后”（给出更长的周期）：本质上，生成器通常会转换最后生成的数字，存储“历史缓冲区”并转换，例如，第 (n-1023) 个。

我会说避免生成器使用愚蠢的内存量来给你一个比你真正需要的周期更长的周期（有些周期比宇宙中的原子数大——你真的不需要那个）。请注意，“长周期”并不一定意味着“高质量生成器”（尽管 2^48 仍然有点低！）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-17T15:59:34.853

正如 zvrba 所说，那个 JavaDoc 解释了正常的实现。[关于伪随机数生成器](http://en.wikipedia.org/wiki/PRNG)的Wikipedia 页面有大量信息，并提到了[Mersenne twister](http://en.wikipedia.org/wiki/Mersenne_twister)，它在密码学上不安全，但速度非常快，并且[在 Java 中有各种实现](http://www.cs.gmu.edu/~sean/research/)。（最后一个链接有两个实现——我相信还有其他可用的。）

如果您需要加密安全生成，请阅读 Wikipedia 页面 - 有多种可用选项。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-17T16:09:59.200

随着 RNG 的发展，Sun 的实现[绝对不是最先进的](http://www.alife.co.uk/nonrandom/)，但对于大多数用途来说已经足够了。如果您需要用于加密目的的随机数，可以使用[java.security.SecureRandom](https://docs.oracle.com/javase/9/docs/api/java/security/SecureRandom.html)，如果您只是想要比 java.util.random 更快更好的东西，很容易在网上找到 Mersenne Twister 的 Java 实现。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-17T15:53:50.637

这在[文档](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Random.html)中有所描述。线性同余生成器在理论上很容易理解，文献和互联网上都有很多关于它们的材料。具有相同参数的线性同余生成器总是输出相同的周期序列，而种子唯一决定的就是序列的开始位置。所以你的第一个问题的答案是“是的，如果你生成足够的随机数”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-01-06T02:14:00.433

请参阅我的博客文章中的答案：

[http://code-o-matic.blogspot.com/2010/12/how-long-is-period-of-random-numbers.html](http://code-o-matic.blogspot.com/2010/12/how-long-is-period-of-random-numbers.html)

Random 的状态有一个最大周期（很长，即 2^64 周期）。这可以直接推广到 2^k - 投资尽可能多的状态位，并获得最大周期。*相对而言，2Mersenne Twister 的周期*实际上很***短***（参见上述博客文章中的评论）。

 *——哎呀。Random 将自身限制为 48 位，而不是使用 long 的全部 64 位，因此相应地，它的周期毕竟是 2^48，而不是 2^64。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-01-17T16:21:54.980

如果 RNG 质量对您来说真的很重要，我建议您使用您自己的 RNG。也许 java.util.Random 很棒，在这个版本中，在你的操作系统上等等。它可能是。但这可能会改变。之前发生过，图书馆作者在以后的版本中使事情变得更糟。

自己写很简单，然后你就知道到底发生了什么。它不会在升级等时改变。这是一个可以在 10 分钟内移植到 Java的[生成器。](http://www.codeproject.com/KB/recipes/SimpleRNG.aspx)如果你从现在开始一周后开始用某种新语言写作，你可以再次移植它。

如果您不自己实现，您可以从信誉良好的来源获取知名 RNG 的代码，并在您的项目中使用它。然后没有人会从你下面换掉你的发电机。

（我不提倡人们提出自己的*算法*，只提出他们自己的*实现*。大多数人，包括我自己，都没有开发自己的算法的业务。编写一个你认为很棒的坏生成器很容易。这就是为什么人们需要问这样的问题，想知道库生成器有多好。我引用的生成器中的算法已经通过了许多同行评审的铃声。）

# language-agnostic - 软件评论：开源软件

> ID：453493
> 
> 赞同：5
> 
> 时间：2009-01-17T15:58:18.803
> 
> 标签：language-agnostic, open-source

我在哪里可以找到对开源项目的批判性分析？

即：深入分析源中的方法，将项目与其他项目进行比较，以及绩效指标......

我想阅读一些关于现有项目的内容，这些内容可以让我大致了解其设计、实施、优势和劣势，这样我就可以选择参与其中。希望每次批评都会有不止一位分析师。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T16:12:25.623

[Ohloh](http://ohloh.net)会为您提供一些信息，但仅限于可以从源代码存储库数据中机器计数的信息，即：

*   使用的语言，每种语言的数量
*   评论百分比
*   开发人员基础（即随着时间的推移而扩展）

但是，我不知道有任何在代码级别进行自动方法分析的服务/站点。Ohloh 最终可能会传达类似“Mostly OOP”之类的内容，但这将是遥远的未来。

几乎所有像您提到的类型的报告都是在实验室中手工完成并测试一个非常有针对性的群体..即比较各种Web服务器的性能和编码方法。几乎所有时间，您都会在 Slashdot 首页上找到这些类型的报告，因为它的数据是许多人感兴趣的。

像 Ohloh 这样的东西可以让你开始比较自己想要比较的东西，但我知道没有任何东西可以为你做任何程度的可靠性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T16:02:23.663

[Patrick Smacchia（优秀工具 NDepend 的作者）在他的博客](http://codebetter.com/blogs/patricksmacchia/)上发布了对开源项目的分析

我记得的一些帖子

[从 NUnit 代码库中吸取的教训](http://codebetter.com/blogs/patricksmacchia/)

[Paint.NET 分析](http://codebetter.com/blogs/patricksmacchia/archive/2008/10/20/controlling-the-usage-of-libraries.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T16:13:34.077

我建议您在[ohloh.net](http://www.ohloh.net/)上进行一些搜索。虽然它不提供架构分析，但它提供了许多关于流行开源项目的有用统计数据（语言、活动、成员位置、用户评级、许可证类型、新闻等）。您可能会发现这是一个有用的工具，可以帮助您寻找要贡献的项目。

例如，这里是 NUnit 的页面：http: [//www.ohloh.net/p/nunit](http://www.ohloh.net/p/nunit)

您也可以随时搜索开源项目托管网站，例如[SourceForge](http://sourceforge.net/)、[Google Code](http://code.google.com/hosting/)和[CodePlex](http://www.codeplex.com/)，尽管信息不如 ohloh 深入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-01T14:53:51.887

开源软件的主要问题似乎是没有营销部门（通常）使开发人员朝着更加用户友好的方向发展。

是的，一些 Linux 发行版在表面上看起来不错，但一半完成的代码数量令人难以置信。

我见过一些令人惊奇的东西，比如未完成的文本编辑器，它在某些发行版中的每一次点击都会给出“功能尚未实现”的警告，等等......

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2009-01-17T16:10:19.387

不要试图听起来令人反感，但你的问题完全是落后的。您应该询问**您可以为特定的开源项目做些什么**。为什么有人会分析开源项目并将它们相互比较，我不知道。在查看**实际软件**的性能指标时，我可以看到一些好处，但这将是特定类型的，而不是通用的。

最好的办法是访问freshmeat 之类的网站，查看发布历史、源代码和从事**您特别感兴趣的**项目以及**您可以有所作为的项目的开发人员**

简而言之： **可以将软件与其他软件进行比较**

**项目不能与其他项目进行比较**。这样做是不明智的。一些人认为*正确*的方法往往被其他人视为*错误*的。

# wpf - 我可以在设计时使 WPF 网格控件不透明吗？

> ID：453513
> 
> 赞同：1
> 
> 时间：2009-01-17T16:13:32.297
> 
> 标签：wpf, grid

所以我刚开始使用 WPF，我真的很恼火，如果我将两个网格放在彼此的顶部，顶部的网格不是不透明的。它使设计非常烦人。这可以以某种方式关闭吗？

我只是在构建您的标准 Winforms STYLE 应用程序，但在 WPF 中。我只是想开始弥合这里的差距。在 Winforms（和 VB）中，您的表单上总是有组合框或其他东西，然后根据某些用户上下文，其中一个组合框将位于顶部。这是我自古以来设计表格的方式。这里必须满足以下两件事之一：

A）这不是使用 WPF 设计 Windows 的推荐方法，但我不明白你应该做什么

B）有一些属性可以使网格不透明，因此我可以按照我习惯的样式构建窗口。

我对解决 A 或 B 的答案很好。如果我因为它们已经改变而没有以正确的方式做事，那么请赐教。

更新：事实证明，我可以通过设置背景颜色使网格变得不透明，但现在看起来我被锁定在白色背景中，而不是坚持使用系统颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T16:39:21.217

您可以使用[`SystemColors`](http://msdn.microsoft.com/en-us/library/system.windows.systemcolors.aspx)使控件背景颜色匹配（而不是白色）。

我不明白您为什么要将一个网格放在另一个网格之上。在 WPF 中，您通常使用单个网格在一个区域内堆叠多个视觉元素。你能解释一下为什么你想用前景元素隐藏背景中的东西吗？

这听起来有点像您正在实现一个选项卡控件——根据焦点在控件页面之间切换。你试过新的[`TabControl`](http://msdn.microsoft.com/en-us/library/system.windows.controls.tabcontrol.aspx)吗？

我尽可能从 WinForms 转向 WPF 开发，并发现这样做需要一些重新调整。WPF 有一种完全不同的布局方式，现在我对它更满意了，我认为它更胜一筹。我猜你只需要多走一点学习曲线。

希望有帮助。

**编辑：**作为对您的评论的回应，我想您可以拥有一个没有标签的标签控件，尽管我自己没有尝试过（可能值得在 SO 上提出另一个问题）。选项卡控件是带标题的控件，这意味着它们具有标题项和内容项。在这种情况下，标题是选项卡按钮，内容是页面项。您可以指定`ControlTemplate`详细说明这些项目应如何相互显示。

有趣的是，许多其他类型的常见 GUI 元素也是标题控件：

*   *菜单项*- 菜单项文本/图标是标题，可选的子菜单是内容
*   *树视图*- 每个节点都是标题，可选的子节点在内容中
*   *组框*- 标题是标题，内容是内容:)

请注意，在菜单项和树视图的情况下，类型可能会递归地嵌套在其自身中。这是非常优雅的，并且可以在相同的逻辑模型上提供一些完全不同的表示选项，只需更改控制模板。

有关更多信息，请阅读[`HeaderedContentControl`](http://msdn.microsoft.com/en-us/library/ms742541.aspx)和[`HeaderedItemsControl`](http://msdn.microsoft.com/en-us/library/ms742543.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T16:44:02.860

您可以使用以下内容：

```
 <Grid Background="{DynamicResource {x:Static SystemColors.WindowBrush}}">  
  <!-- content -->
  </Grid> 
```

这将实时响应系统颜色的变化（DynamicResource 执行此操作）。

# asp.net - 如何在 Web 部件中显示是/否样式的消息框，并获得客户的选择？

> ID：453528
> 
> 赞同：1
> 
> 时间：2009-01-17T16:29:53.373
> 
> 标签：asp.net, sharepoint

当用户尝试在我的 Web 部件中执行任何主要操作时，我想显示一个消息框。如果用户选择[Yes]，那么继续做一些事情...[No] 是白做的。

如何在我的 Web 部件 Sharepoint 2007 中实现此功能？

请帮助我~~

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T18:20:05.723

如果您使用 ASP.Net 控件（如 Button），则可以添加以下属性以在回发实际发生之前为用户提供 JavaScript 弹出窗口：

```
<asp:Button runat="server" ID="Button1" OnClick="Button1_Click" OnClientClick="return confirm('Are you sure you want to do this?');" /> 
```

您还可以在代码中的按钮对象上设置此属性：

```
Button1.OnClientClick = "return confirm('Are you sure you want to do this?');"; 
```

# django - 将您的 Django 管理目录留在默认的 admin 网址下是否危险？

> ID：453537
> 
> 赞同：6
> 
> 时间：2009-01-17T16:36:30.100
> 
> 标签：django, url, indexing, django-admin

仅使用普通的旧管理员 URL 即可访问 Django 应用程序中的管理界面是否危险？为了安全起见，是否应该将其隐藏在类似于 64 位唯一 uuid 的模糊 url 下？

另外，如果你创建了一个到管理界面的模糊链接，你怎么能避免让任何人发现它在哪里？如果您的网站或互联网上的任何地方都没有指向该 url 的链接，google-bot 是否知道如何找到该 url？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-17T18:03:51.000

您可能需要注意字典攻击。最安全的做法是使用您的 Web 服务器配置 IP 限制对该 URL 的访问。您还可以限制对该 URL 的访问 - 我上周发布了[一篇关于此的文章。](http://blog.simonwillison.net/post/57956846132/ratelimitcache)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-18T11:40:17.497

如果一个 URL 在互联网上不存在，“googlebot”就无法知道它......除非有人告诉它。不幸的是，许多用户在他们的浏览器中安装了工具栏，这些工具栏将浏览器访问的所有 URL 提交到各种服务器（例如 Alexa、Google）。

因此，从长远来看，将 URL 保密是行不通的。

uuid 也很难记住和输入 - 导致额外的支持（“又是什么 URL？”）。

但我仍然强烈建议更改 URL（例如更改为 /myadmin/）。这将挫败自动扫描和攻击工具。因此，如果有一天“伟大的 Django 蠕虫”在 Internet 上出现，那么您被攻击的机会就会低得多。

使用 PHPmyAdmin 的人在过去几年有过这样的经历：更改默认 URL 可以避免大多数攻击。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T17:32:24.277

虽然添加额外的保护层（一个模糊的 url）并强制执行良好的密码选择（检查密码强度并检查它不在一个大的常用密码列表中）并没有什么坏处，但会更好地利用您的时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T16:43:10.053

假设您选择了一个好的密码，不，这并不危险。人们可能会*看到* 该页面，但无论如何他们都无法进入。

如果您不希望 Google 为目录编制索引，则可以使用[robots.txt](http://www.robotstxt.org/)文件来控制它。

# java - 哪些问题会阻止 Java 应用程序在多个平台上运行？

> ID：453538
> 
> 赞同：19
> 
> 时间：2009-01-17T16:36:54.950
> 
> 标签：java, cross-platform

Java 应该是“一次编写，随处运行”，它确实可以，但在某些情况下，它变成了“一次编写，到处调试”。

将 Java 应用程序从一个平台迁移到另一个平台时出现问题的最常见原因是什么？

有哪些不常见但有趣的原因？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-01-17T16:45:09.207

*   不要对文件系统的大小写敏感度做出假设
*   不要对路径或目录分隔符做出假设
*   不要对行终止符做出假设
*   不要使用默认的平台编码，除非你真的非常确定你的意思
*   不要启动“cmd.exe”等（我知道，这听起来很明显 - 但我已经看到它会导致问题）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-17T16:53:16.320

来自 UI 区域的少数：

*   OK/Cancel 等按钮的顺序不正确
*   使用绝对布局
*   不同的加速键
*   不同大小/字体的渲染
*   期望某些键存在（Windows 键、元键）

（虽然这些不是 Java 特定的）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-17T16:42:41.957

我只能从个人经验来说。这些是我见过的：

1.  线程在某些架构上的抽象方式不同，因此延迟和可能的顺序略有不同。（这可能导致一些竞争条件）
2.  控制键盘的状态（大写锁定、数字锁定等）并不总是按预期工作（当时 Linux 不允许我将大写锁定更改为禁用 v1.5）

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-17T17:14:25.933

使用`com.sun.*`Sun JDK 附带的包中的类。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-17T16:50:38.633

假设您可以写入包含您的应用程序的目录。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-17T16:49:47.933

使用 JNI 是应该研究的。为每个目标平台提供本机库可以减少这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-17T16:41:56.843

有许多不同的 JVM，因此根据客户在他们的机器上安装了哪一个，它们可能会得到稍微不同的结果。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-14T06:54:37.153

在我的脑海中......其中一些实际上发生在工作中

*   JNI

*   开发工具将字符引入到在 Windows 下工作但在 Linux 下不工作的格式化字符串文字中（这确实发生了）

*   文件系统不一致（将应用程序紧密耦合到一个环境）

*   可用内存或内核等底层硬件可能会导致行为改变

# java - Paradox 4.5 可以安装在服务器上吗？

> ID：453545
> 
> 赞同：0
> 
> 时间：2009-01-17T16:41:49.073
> 
> 标签：java, sql-server, database, paradox, netbeans6.1

我已经使用 Netbeans 和 Paradox 驱动程序建立了一个链接，并且可以查询数据库。Paradox 4.5 (Borland) 可以设置在服务器上，以便远程查询数据库吗？请指出我正确的方向。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T17:57:18.283

我很早以前就用过悖论，所以我希望我记得很清楚。

Paradox 不是基于服务器的数据库，而是基于文件的。这意味着您根本不需要 paradox 来使用 paradox 数据库。你只需要合适的驱动程序。

在配置中，您指定一个网络控制目录。您必须为所有访问数据库的计算机使用相同的位置。如果您也使用相同的驱动器号，那是最好的。

数据库本身也应该具有来自所有工作站的相同驱动器号和路径。您可以使用与网络控制目录相同的驱动器。

如果您不能再访问数据库，请断开所有工作站与数据库的连接，删除网络控制目录中的 *.net（如 pdoxusrs.net）和 *.lck 以及表所在的位置。然后再试一次。

# java - 通过 JNDI 使用 ActiveMQ

> ID：453561
> 
> 赞同：7
> 
> 时间：2009-01-17T16:46:44.307
> 
> 标签：java, jndi, activemq

我正在尝试使用 JNDI 创建与 ActiveMQ 的简单连接。

* * *

我有

1.  名为“example.A”的队列。

2.  根据[涉及 JNDI 的 ActiveMQ 文档](http://activemq.apache.org/jndi-support.html)，如果我想通过 JNDI 使用 ConectionFactories 和队列（主题），我必须将 jndi.properties 文件放在我的类路径中。据我了解，activeMQ 类路径默认为 %activemq%/conf 目录。我没有改变它。所以我的队列有这个属性：

    queue.MyQueue = example.A

3.  我为 ActiveMQ 创建了 java 客户端类，它使用如下 JNDI：

    ```
     Properties jndiParameters = new Properties() ;
        jndiParameters.put(Context.INITIAL_CONTEXT_FACTORY, "org.apache.activemq.jndi.ActiveMQInitialContextFactory");
        jndiParameters.put(Context.PROVIDER_URL, "tcp://localhost:61616");
        Context context = new InitialContext(jndiParameters);
        ConnectionFactory connectionFactory = (ConnectionFactory) context.lookup("ConnectionFactory");
        Queue queue = (Queue) context.lookup("MyQueue"); 
    ```

但它找不到我的队列，它抛出异常：javax.naming.NameNotFoundException: MyQueue

我的错误在哪里？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-17T22:20:25.973

问题是您正在显式创建属性并将它们传递给 InitialContext 构造函数。这意味着不会读取类路径上的 jndi.properties。

你的代码应该是这样的：

```
Context context = new InitialContext();
ConnectionFactory connectionFactory = (ConnectionFactory) context.lookup("ConnectionFactory");
Queue queue = (Queue) context.lookup("MyQueue"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-18T00:43:54.377

您可以设置静态属性以及从文件中检索它们，如下所示：

```
 InputStream is = getClass().getResourceAsStream("/my.jndi.properties");
    Properties jndiParameters = new Properties();
    jndiParameters.load(is);
    jndiParameters.put(Context.INITIAL_CONTEXT_FACTORY, "org.apache.activemq.jndi.ActiveMQInitialContextFactory");
    jndiParameters.put(Context.PROVIDER_URL, "tcp://localhost:61616");
    Context ctx =  new InitialContext(jndiParameters);
... 
```

只要您在加载资源后设置静态道具，这就会起作用。例如，如果您从其他地方加载提供程序 url，这很有帮助。

# python - 有没有一种快速的方法可以在 Python 中生成字母表的字典？

> ID：453576
> 
> 赞同：46
> 
> 时间：2009-01-17T16:51:34.810
> 
> 标签：python, dictionary, alphabet

我想生成一个以字母为键的字典，比如

```
letter_count = {'a': 0, 'b': 0, 'c': 0} 
```

什么是生成该字典的快速方法，而不是我必须输入它？

谢谢你的帮助。

**编辑**
感谢大家的解决方案:)

[nosklo 的](https://stackoverflow.com/users/17160/nosklo) [解决方案](https://stackoverflow.com/questions/453576/simple-python-question-is-there-a-fast-way-to-generate-a-dict-of-the-alphabet#453785)可能是最短的

另外，感谢您提醒我有关 Python[字符串](http://docs.python.org/library/string.html)模块的信息。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-01-17T18:36:15.443

我发现这个解决方案更优雅：

```
import string
d = dict.fromkeys(string.ascii_lowercase, 0) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-17T17:03:27.500

```
import string
letter_count = dict(zip(string.ascii_lowercase, [0]*26)) 
```

或许：

```
import string
import itertools
letter_count = dict(zip(string.lowercase, itertools.repeat(0))) 
```

甚至：

```
import string
letter_count = dict.fromkeys(string.ascii_lowercase, 0) 
```

首选解决方案可能是不同的解决方案，具体取决于您在字典中想要的实际值。

* * *

我在这里猜一猜：你想计算文本（或类似内容）中出现的字母吗？有比从初始化字典开始更好的方法来做到这一点。

`Counter`从`collections`模块中使用：

```
>>> import collections
>>> the_text = 'the quick brown fox jumps over the lazy dog'
>>> letter_counts = collections.Counter(the_text)
>>> letter_counts
Counter({' ': 8, 'o': 4, 'e': 3, ... 'n': 1, 'x': 1, 'k': 1, 'b': 1}) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-17T17:01:01.703

这是一个紧凑的版本，使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
>>> import string
>>> letter_count = dict( (key, 0) for key in string.ascii_lowercase )
>>> letter_count
{'a': 0, 'c': 0, 'b': 0, 'e': 0, 'd': 0, 'g': 0, 'f': 0, 'i': 0, 'h': 0, 'k': 0,
 'j': 0, 'm': 0, 'l': 0, 'o': 0, 'n': 0, 'q': 0, 'p': 0, 's': 0, 'r': 0, 'u': 0, 
't': 0, 'w': 0, 'v': 0, 'y': 0, 'x': 0, 'z': 0} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-17T18:19:27.440

如果你打算用它来计数，我建议如下：

```
import collections
d = collections.defaultdict(int) 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-17T18:17:54.230

另一个 1-liner Python hack：

```
letter_count = dict([(chr(i),0) for i in range(97,123)]) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-07-22T14:39:32.480

字典理解非常容易：`{chr(i+96):i for i in range(1,27)}` 生成：

`{'a': 1, 'c': 3, 'b': 2, 'e': 5, 'd': 4, 'g': 7, 'f': 6, 'i': 9, 'h': 8, 'k': 11, 'j': 10, 'm': 13, 'l': 12, 'o': 15, 'n': 14, 'q': 17, 'p': 16, 's': 19, 'r': 18, 'u': 21, 't': 20, 'w': 23, 'v': 22, 'y': 25, 'x': 24, 'z': 26}`

您可以为 Capital AZ 生成相同的内容`chr(i+64)`

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-17T16:59:54.637

还有这个：

```
import string
letter_count = dict((letter, 0) for letter in string.ascii_lowercase) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-17T17:05:46.077

```
import string
letters = string.ascii_lowercase
d = dict(zip(letters, [0]*len(letters)) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-06-21T08:18:31.813

您可以直接使用字典和范围，因此您可以创建自己的函数并轻松自定义它。

```
def gen_alphabet(start, value):
    return {chr(ord('a') + i) : 0 for i in range(value)}

print(gen_alphabet('a', 26)) 
```

输出：

```
>>> {'a': 0, 'c': 0, 'b': 0, 'e': 0, 'd': 0, 'g': 0, 'f': 0, 'i': 0, 'h': 0, 'k': 0, 'j': 0, 'm': 0, 'l': 0, 'o': 0, 'n': 0, 'q': 0, 'p': 0, 's': 0, 'r': 0, 'u': 0, 't': 0, 'w': 0, 'v': 0, 'y': 0, 'x': 0, 'z': 0} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-03-04T16:33:35.033

```
import string
s =string.ascii_lowercase 
s1 =string.ascii_uppercase
s2=string.ascii_letters
print(dict(enumerate(s,1))) 
print(dict(enumerate(s1,1)))
print(dict(enumerate(s2,1))) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-01-29T13:24:22.127

我的变种：

注意：unicode 中的范围 AZ => 65-90（十进制）

```
d = dict.fromkeys([chr(j) for j in range(65, 90)], 0)
print(d) 
```

输出 ：

```
>>> {'A': 0, 'B': 0, 'C': 0, 'D': 0, 'E': 0, 'F': 0, 'G': 0, 'H': 0, 'I': 0, 'J': 0, 'K': 0, 'L': 0, 'M': 0, 'N': 0, 'O': 0, 'P': 0, 'Q': 0, 'R': 0, 'S': 0, 'T': 0, 'U': 0, 'V': 0, 'W': 0, 'X': 0, 'Y': 0} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2020-04-13T20:29:39.827

```
a_to_z = [(chr(i+64), chr(i+64)) for i in range(1, 27)] 
```

输出

> ```
> [('A', 'A'), ('B', 'B'), ('C', 'C'), ('D', 'D'), ('E', 'E'), ('F', 'F'), ('G', 'G'), ('H', 'H'), ('I', 'I'), ('J', 'J'), ('K', 'K'), ('L', 'L'), ('M', 'M'), ('N', 'N'), ('O', 'O'), ('P', 'P'), ('Q', 'Q'), ('R', 'R'), ('S', 'S'), ('T', 'T'), ('U', 'U'), ('V', 'V'), ('W', 'W'), ('X', 'X'), ('Y', 'Y'), ('Z', 'Z')] 
> ```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2022-02-10T17:00:35.050

从字母顺序 A 构造一个单词字典，将每个单词包含形容词、副词。将形容词和副词列表从 dict 转换为 list

# php - Ruby、PHP 的交互式控制台

> ID：453578
> 
> 赞同：48
> 
> 时间：2009-01-17T16:53:00.813
> 
> 标签：php, ruby

如何启动 ruby​​ 和 php 的交互式控制台

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-01-17T16:59:14.577

对于 ruby​​，您需要 ' `[irb](http://en.wikipedia.org/wiki/Interactive_Ruby_Shell)`' 命令。

`[python](http://www.python.org/doc/2.1.3/tut/node4.html#SECTION004120000000000000000)`对于 python，您可以使用 ' ' 命令进入交互模式。

对于 php，您可以使用 ' ' 进入基本交互模式`[php -a](http://www.manpagez.com/man/1/php/)`。由于其局限性，其他交互式外壳如雨后春笋般涌现。 [PHP-Shell](http://jan.kneschke.de/projects/php-shell/)就是其中之一。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-18T04:06:20.020

此外，如果您正在使用 Ruby On Rails 项目，您可以使用

```
ruby script/console 
```

从您的 Rails 应用程序根目录。这是一个很好的方法，因为您获得了一个交互式 ruby​​ shell，其优点是可以为您加载整个应用程序堆栈。如果您正在测试新代码或尝试调试某些东西，这非常方便。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T18:11:11.360

php 不太适合交互式 shell，因为您无法重新定义函数和类。因此，虽然[有*一个*](http://jan.kneschke.de/projects/php-shell)交互式 shell 可用，但它并不是很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T18:16:44.997

确保您已安装 php5-cli 并在命令行中键入“php -a”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T03:28:29.020

您正在寻找与 irb 相同的[phpsh用于 ruby​​。](http://www.phpsh.org/)php-cli 允许您为命令行运行脚本，例如

```
myserver> php -r "echo 'hola mundo';" 
```

所以你问的和关于 php-cli 的所有回复都是不同的。php-cli 也有它自己的 php.ini，它允许你有不同的配置取决于通过 httpd（如 apache）或在 bash 中运行 php

萨卢多斯

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-24T11:25:13.937

有一个优秀的 PHP 脚本，允许您在本地网站上运行 php 控制台。

[http://seld.be/notes/php-console-in-your-browser](http://seld.be/notes/php-console-in-your-browser)

这里有明显的安全隐患，但如果它只能在本地访问，那就不用担心了。

如果您想仔细检查函数行为，或者隔离一段代码并诊断发生了什么，真的可以节省时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-01T21:40:37.047

对于加载了 rails 3.x+ 项目的控制台

```
rails c 
```

这是简写`ruby scripts/rails console`

在此处查看更多缩写：http: [//xyzpub.com/en/ruby-on-rails/3.2/abkuerzungen.html](http://xyzpub.com/en/ruby-on-rails/3.2/abkuerzungen.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-17T17:02:44.180

在 php 中，它的 php 或 php-cli - 不同安装中的不同名称

# shell - 如何删除文件夹中的所有文件，音乐子文件夹除外？

> ID：453581
> 
> 赞同：0
> 
> 时间：2009-01-17T16:53:46.693
> 
> 标签：shell, terminal

### 复制

> [无法删除文件夹中除 FileA 之外的所有其他内容](https://stackoverflow.com/questions/635378/unable-to-remove-everything-else-in-a-folder-except-filea)

我猜它和这个有点相似：删除 [^Music]

但是，它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T15:24:58.453

将以下命令放入您的 ~/.bashrc

```
shopt -s extglob 
```

您现在可以通过以下方式删除文件夹中除“音乐”文件夹外的所有其他内容

```
rm -r !(Music) 
```

请注意命令。它很强大，但也很危险。

我建议始终使用命令对其进行测试

```
echo rm -r !(Music) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T18:23:39.460

命令

```
rm (ls | grep -v '^Music$') 
```

应该管用。如果您的某些“文件”也是子目录，那么您也想递归删除它们：

```
rm -r (ls | grep -v '^Music$') 
```

**警告**：`rm -r`可能很危险，您可能会意外删除大量文件。如果您想确认要删除的内容，请尝试查看

```
ls | grep -v '^Music$' 
```

*说明*：

*   该`ls`命令列出目录内容；没有参数，它默认为当前目录。
*   管道符号`|`将输出重定向到另一个命令；当以这种方式重定向的输出时，它每行打印一个文件名，而不是像在交互式终端上`ls`键入时所看到的列格式。`ls`
*   该`grep`命令匹配模式的行；该`-v`开关表示打印与模式*不*匹配的行。
*   模式的`^Music$`意思是匹配以Music开头和结尾的一行——即只匹配字符串Music；`^`（行首）和（行尾）字符的效果`$`也可以通过`-x`switch来实现，如`grep -vx Music`.
*   语法`command (subcommand)`是 fish 获取一个命令的输出并将其作为命令行参数传递给另一个命令的方式。
*   该`rm`命令删除文件。默认情况下，它不会删除目录，但`-r`("recursive") 选项会改变它。

您可以通过键入来了解这些命令以及更多信息，您想了解的内容`man command`在哪里。`command`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-25T18:43:56.930

所以我一直在寻找一种方法来删除目录中的所有文件，除了一些我想保留的目录和文件。经过大量搜索后，我设计了一种使用 find 的方法。

```
find -E . -regex './(dir1|dir2|dir3)' -and -type d -prune -o -print -exec rm -rf {} \; 
```

本质上，它使用正则表达式来选择要从结果中排除的目录，然后删除剩余的文件。只是想把它放在这里以防其他人需要它。

# javascript - 在 Firefox 中，如何更改现有的 CSS 规则

> ID：453586
> 
> 赞同：3
> 
> 时间：2009-01-17T16:56:21.370
> 
> 标签：javascript, css, firefox

在 Firefox 中，我的 .css 文件中有以下片段

```
tree (negative){  font-size: 120%; color: green;} 
```

使用 javascript，如何更改**规则**，将颜色设置为红色？

**注意：
我不想更改元素。
我想改变规则。请不要回答类似**

...

element.style.color = '红色';

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T17:24:01.843

您正在寻找的是`document.styleSheets`属性，通过它您可以访问您的 css 规则并对其进行操作。大多数浏览器都有这个属性，但是 IE 的界面略有不同。

例如，尝试在此页面的 FF 中粘贴以下内容并按 Enter：

```
javascript:alert(document.styleSheets[0].cssRules[1].cssText) 
```

对我来说，这会产生 string `"body { line-height: 1; }"`。有一些方法/属性允许您操纵规则。

这是一个为您抽象此接口的库（跨浏览器）：[http ://code.google.com/p/sheetup/](http://code.google.com/p/sheetup/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-25T20:28:23.370

```
function changeCSSRule (stylesheetID, selectorName, replacementRules) {
    var i, theStylesheet = document.getElementById(stylesheetID).sheet,
    thecss = (theStylesheet.cssRules) ? theStylesheet.cssRules : theStylesheet.rules;
    for(i=0; i < thecss.length; i++){
        if(thecss[i].selectorText == selectorName) {
            thecss[i].style.cssText = replacementRules;
        }
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T17:18:56.130

您可以通过 CSS 对象模型（目前称为 DOM Level 2 Style）更改样式表中的 CSS 规则。但是，如果您在样式表中确实有“树（负）”，则该规则将被删除并且根本不会出现在对象模型中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T17:01:52.683

由于没有 HTML 元素`tree`，我将假设它`tree`是另一个元素的`id`or `class`。

您将首先通过 id 检索 DOM 元素：

```
var tree = document.getElementById("tree"); 
```

现在`tree`代表您的 DOM 元素，您可以随意操作它：

```
tree.style.color = "red"; 
```

[这是将 css 属性映射到其 javascript 等效项的一个很好的参考。](http://codepunk.hardwar.org.uk/css2js.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T17:02:26.957

我不确定您是否可以进行实际的类/选择器覆盖。您需要定位使用`.tree`该类的每个元素并设置 CSS。最快和最简单的方法是通过 jQuery（或其他类似的框架）：

```
$('.tree').each(function() { this.style.color = "red"; }); 
```

你甚至可以使用内置的 CSS 函数：

```
$('.tree').css('color', 'red'); 
```

（我这样做的第一种方法是向您展示标准 JS 将如何做到这一点。该`$(...)`部分是 jQuery 用于选择`.tree`该类的所有元素。如果您不使用 jQuery，则需要替代代码。）

如果`tree`是一个 ID，而不是一个类（页面上应该只有一个），所以使用 getElementById 应该没问题。您的代码应该看起来像另一个答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T17:05:48.340

```
 for( var i in document.getElementsByTagName("tree") ){
   document.getElementsByTagName("tree")[i].style.color = "red";
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T17:13:35.640

正如我在另一个答案的评论中所说，我从来没有见过你想要的那样做。我只以与 CSS 渲染器相同的方式定位元素并更改了每个元素的样式。

我确实看到了这个：[jQuery.Rule](http://flesler.blogspot.com/2007/11/jqueryrule.html)

*听起来*它可以满足您的需求，但该演示使我的浏览器有点崩溃。我邀请您查看源代码，看看它确实可以满足您的需求，如果您想在没有 jQ 的情况下使用它，请将其作为起点。

**编辑：**是的，这应该有效。它通过将另一个`<style>`标签附加到页面并在其中写出您的覆盖来工作。如果您想将其移植到纯 JS，遵循起来相当简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-17T17:16:49.643

对于调试，您可以使用[Firebug](http://www.getfirebug.com)即时更改 CSS 规则。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-17T17:19:15.957

如果您想将呈现的 css 规则从一个页面请求更改为下一个页面请求，则需要某种服务器端脚本。否则，原始样式表将在下一页请求时简单地重新加载。

如果您想在第一页上使用事件来强制执行服务器端操作，那么您可以使用 AJAX 来实际更改用户的 CSS 规则。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-17T17:19:37.377

> “我想更改规则，以便当我导航到下一页时，我不必再次进行所有更改。”

听起来您可能想要的是一个远程请求（“ajax”）返回到服务器并带有您想要发出的请求，并生成一个发送回客户端的动态样式表？

这个 Firefox 如何/为什么是特定的？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-01-17T17:38:34.153

> 我想更改规则，以便当我导航到下一页时，我不必再次进行所有更改。

我可以在这里想到两种方法。即客户端和/或服务器端。

客户端：将主题设置存储到cookies中，下次通过javascript加载。

服务器端：如果您的站点有登录系统，您也可以将用户偏好存储到数据库中，并在下次生成带有此信息的网页。

最终，您仍在编写类似`element.style.color =`. 但是，他们应该得到你想要的。

# html - 如果 CSS 规则发生变化，是否需要刷新浏览器

> ID：453593
> 
> 赞同：0
> 
> 时间：2009-01-17T17:00:00.533
> 
> 标签：html, css, css-reset

如果我通过 javascript 更改了 CSS 规则，我是否需要做任何事情来“刷新”浏览器以使用更新的规则重新显示当前页面？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T17:08:42.373

不——不需要刷新——如果确实发生了，它会将文档恢复到其原始状态。

更改应立即发生（例如设置显示：无）。使用 FireFox 插件 FireBug ( [http://getfirebug.com/](http://getfirebug.com/) ) 或 IE Developer Toolbar（内置于 IE8 并作为以前版本的免费插件提供）动态查看 HTML 以确保您认为正在发生的更改实际上正在发生.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T17:13:19.073

通过 JavaScript 动态更改 CSS 属性**应该**会自动在用户的 Web 浏览器中进行更改，除非您的脚本出现问题（如果用户关闭了 JavaScript）。

# java - Java 的最佳拼写检查 API

> ID：453607
> 
> 赞同：9
> 
> 时间：2009-01-17T17:06:06.577
> 
> 标签：java, spell-checking

最好的 Java 拼写检查 API 是什么？

免费或购买，必须免版税。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-28T01:00:10.803

刚用过[Jazzy](http://sourceforge.net/projects/jazzy/)，效果很好。试试这个[例子](http://jazzy.cvs.sourceforge.net/viewvc/jazzy/jazzy/src/com/swabunga/spell/examples/SpellCheckExample.java?view=markup)并下载[字典](http://sourceforge.net/projects/jazzy/files/Dictionaries/English/)。

这是[Maven 依赖项](http://search.maven.org/#search%7Cgav%7C1%7Cg%3a%22net.sf.jazzy%22%20AND%20a%3a%22jazzy%22)：

```
<dependency>
    <groupId>net.sf.jazzy</groupId>
    <artifactId>jazzy</artifactId>
    <version>0.5.2-rtext-1.4.1-2</version>
</dependency> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T17:23:58.147

[Sentry Spell Checker](http://www.wintertreesoftware.com/spell-check/java/index.html)似乎很有趣。它支持基于对话框的拼写检查和拼写错误单词的键入突出显示。这是一个商业产品（引擎 399 美元），但没有版税。

[Jazzy](http://jazzy.sourceforge.net/)是一种更简单的开源替代方案。它已经存在了一段时间，但似乎不再处于积极开发中。从好的方面来说，它是免费的（LGPL 许可证）。

我会先看看 Jazzy，看看它是否符合您的需求。[这里](http://jazzy.sourceforge.net/demo.html)有一个演示小程序，您可以在其中试用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T18:17:48.897

听说还有几个，不知道好不好用。

Rapidspell 和 JTextCheck

# c# - 监视套接字以获取新数据然后处理该数据的最佳方法是什么？

> ID：453609
> 
> 赞同：3
> 
> 时间：2009-01-17T17:06:27.760
> 
> 标签：c#, multithreading, .net-3.5, sockets, sunspot

请原谅我的 C#.Net 新手状态。如果这很明显并且我从文档中错过了它，将不胜感激提供相关页面或示例代码的链接。

我正在开发一个将接受来自 Java 应用程序的 TCP 套接字连接的应用程序。（是的，那部分需要 Java。它是 Sun SPOT 设备，Java 是唯一的选择。）Java 应用程序将定期将新数据写入套接字，我的应用程序的工作是接收字节 []，转换将其转换为字符串，处理数据（更新 UI 等），并可能将数据转发到另一台运行类似 C#.NET 应用程序的计算机上。

以下是我到目前为止所做的： 现在，应用程序在启动时启动了一个线程，该线程打开了一个套接字。Java 应用程序可以成功连接到套接字，以便正常工作。我正在查看 NetworkStream 的`beginRead`方法和`dataAvailable`, `length`, 和`CanRead`属性，但我不完全确定如何确定何时读取了一个数据包，通常约为 512 个字节，但可能会有所不同。

如果 Java 应用程序将数据写入流或有数据积压（Java 应用程序将很快传递数据。）如何确保一次只读取一个数据包？如果 Java 应用程序 null 在写入时终止数据，那会有帮助吗？够了吗？

最后，套接字只会接收一个连接，但我需要让它保持打开状态，直到出现错误或连接终止。处理这方面的最优雅的方式是什么？由于在 Sun SPOT 基站上运行的 Java 应用程序的快速启动（近乎实时）方面，我认为关闭并重新打开每个数据包都不会起作用。现在，当基站终止时，我的应用程序会大声而痛苦地死去。:)

感谢您的阅读以及您可以提供的任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T20:20:27.447

“如果 Java 应用程序将数据写入流或有数据积压（Java 应用程序将很快传递数据。）我如何确保一次只读取一个数据包？”

请注意不要假设您可以控制哪些数据最终会出现在哪个数据包中。如果您尝试发送字节数据`{ 'H', 'e', 'l', 'l', 'o' }`，则无法保证所有这些数据都将在单个数据包中发送。虽然极不可能，但每个数据包仍可能仅包含一个字节，因此您将在 5 个不同的事件中收到所有五个字节。关键是，不要以这种方式依赖数据包。相反，定义您自己的消息结束终止符，并将所有传入数据简单地放入某种字节缓冲区中，并使用另一个函数来检测是否存在这些终止符中的任何一个。如果是这样，请阅读该终结者。例如，假设您从 Java 应用程序调用相应的 send 方法两次，其中包含以下数据：

```
{ 'H', 'e', 'l', 'l', 'o', '\0' }
{ 'W', 'o', 'r', 'l', 'd', '\0' } 
```

你的应用程序应该如何准备接收数据应该是这样的：

```
Server receives { 'H', 'e', 'l' }
Data stored in byte buffer { 'H', 'e', 'l' }
Check byte buffer for message terminator '\0'. None found. Buffer unchanged, no message processed.
Server receives { 'l', 'o', '\0', 'W' }
Data stored in byte buffer { 'H', 'e', 'l', 'l', 'o', '\0', 'W' }
Check byte buffer for message terminator '\0'. 1 found, extracted message { 'H', 'e', 'l', 'l', 'o' } and buffer updated { 'W' } 
```

因此，虽然这并不完全是对您最初问题的回答，但我认为它应该可以推动您朝着正确的方向前进。

您可能会遇到的一件事是，根本没有任何字符不能成为数据而不是消息终止符。例如，许多文件包含数据 \0，因此这些文件会破坏您的消息检测。通常如何处理这个问题是通过为您的协议创建一个标头规范并检测您是否期望一个标头（在这种情况下，查找 \0 将表示消息的结尾）或者您是否正在等待一定数量的数据（可以由收到的最后一个标头指定。）如果这没有意义，并且您认为您可能需要使用此技术，请告诉我，我将添加到此答案中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T17:43:47.420

当您读取流数据时，您需要一些标记/终止字符或已知大小的数据来确定何时停止读取和处理信息。空字符或换行符很常见。另一种技术是使用固定大小的标头来指定正文的长度。

套接字将保持打开状态，直到您将其关闭或另一端终止，在这种情况下，您将在从您应该处理的套接字读取时收到错误。当在读取或写入操作期间从远程端关闭套接字时，NetworkStream 会引发 IOException。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T15:27:23.527

我们解决这个问题的方法是结合使用标记字符和固定宽度字段。前两个字节是整个数据包的长度标头。然后，我将数据包读入 byte[] 缓冲区，然后依靠我们自己的数据包结构来知道，例如，前两个字节分别被解释为单独的字段，然后字符串字段以 \n 字符终止（如果您在家得分，则为 0x0A）。然后，通过读取 8 个连续字节等来处理长数据字段。这对我们来说似乎工作得很好，但这显然是一种解决方案，即一个人可以控制套接字的两端，而不是只有一个能够控制一端。希望这对其他人也有帮助。

# java - Java的虚拟机和CLR

> ID：453610
> 
> 赞同：145
> 
> 时间：2009-01-17T17:06:49.477
> 
> 标签：java, .net, bytecode, cil, vm-implementation

[作为对名为“MSIL 和 Java 字节码之间的差异](https://stackoverflow.com/questions/95163/differences-between-msil-and-java-bytecode)”的问题的一种跟进？，Java虚拟机的工作方式与Java虚拟机的工作方式有什么（主要）差异或相似之处~~.NET 框架~~公共语言运行时 (CLR) 有效吗？

另外，是~~.NET 框架~~CLR 是“虚拟机”还是不具备虚拟机的属性？

* * *

## 回答 #1

> 赞同：285
> 
> 时间：2009-01-26T16:21:50.357

两种实现之间有很多相似之处（在我看来：是的，它们都是“虚拟机”）。

一方面，它们都是基于堆栈的虚拟机，没有我们习惯于在 x86 或 PowerPC 等现代 CPU 中看到的“寄存器”概念。所有表达式 ((1 + 1) / 2) 的求值是通过将操作数压入“堆栈”，然后在指令（加法、除法等）需要使用这些操作数时将这些操作数从堆栈中弹出来执行的。每条指令将其结果推回堆栈。

这是实现虚拟机的一种便捷方式，因为世界上几乎每个 CPU 都有一个堆栈，但寄存器的数量通常不同（有些寄存器是专用的，每条指令都希望它的操作数在不同的寄存器中，等等）。

因此，如果您要为抽象机器建模，纯粹基于堆栈的模型是一个不错的选择。

当然，真正的机器不会那样操作。因此，JIT 编译器负责执行字节码操作的“注册”，本质上是调度实际的 CPU 寄存器以尽可能包含操作数和结果。

所以，我认为这是 CLR 和 JVM 之间最大的共同点之一。

至于差异...

这两种实现之间的一个有趣的区别是 CLR 包含用于创建泛型类型的指令，然后用于将参数特化应用于这些类型。因此，在运行时，CLR 将 List<int> 视为与 List<String> 完全不同的类型。

在幕后，它对所有引用类型特化使用相同的 MSIL（因此 List<String> 使用与 List<Object> 相同的实现，在 API 边界具有不同的类型转换），但每个值类型使用它自己独特的实现（List<int> 生成与 List<double> 完全不同的代码）。

在 Java 中，泛型类型纯粹是一种编译器技巧。JVM 不知道哪些类具有类型参数，并且它无法在运行时执行参数化专门化。

从实际的角度来看，这意味着您不能在泛型类型上重载 Java 方法。不能有两个不同的方法，名称相同，区别仅在于它们接受 List<String> 还是 List<Date>。当然，由于 CLR 知道参数类型，它在处理泛型类型特化上重载的方法时没有问题。

在日常的基础上，这是我最注意到 CLR 和 JVM 之间的区别。

其他重要区别包括：

*   CLR 具有闭包（作为 C# 委托实现）。JVM 仅在 Java 8 之后才支持闭包。

*   CLR 具有协程（使用 C# 'yield' 关键字实现）。JVM 没有。

*   CLR 允许用户代码定义新的值类型（结构），而 JVM 提供固定的值类型集合（byte、short、int、long、float、double、char、boolean）并且只允许用户定义新的引用——类型（类）。

*   CLR 支持声明和操作指针。这特别有趣，因为 JVM 和 CLR 都采用严格的分代压缩垃圾收集器实现作为它们的内存管理策略。在一般情况下，严格压缩 GC 很难处理指针，因为当您将一个值从一个内存位置移动到另一个内存位置时，所有指针（以及指向指针的指针）都变得无效。但是 CLR 提供了一种“固定”机制，以便开发人员可以声明一个不允许 CLR 在其中移动某些指针的代码块。这很方便。

*   JVM 中最大的代码单元是“包”，如“受保护”关键字所证明的，或者可以说是 JAR（即 Java ARchive），如能够在类路径中指定 jar 并将其视为文件夹所证明的那样的代码。在 CLR 中，类被聚合成“程序集”，CLR 为推理和操作程序集（加载到“AppDomains”中，为内存分配和代码执行提供子应用程序级沙箱）提供逻辑。

*   CLR 字节码格式（由 MSIL 指令和元数据组成）的指令类型比 JVM 少。在 JVM 中，每个唯一操作（添加两个 int 值、添加两个 float 值等）都有自己唯一的指令。在 CLR 中，所有 MSIL 指令都是多态的（添加两个值），JIT 编译器负责确定操作数的类型并创建适当的机器代码。不过，我不知道哪个是最好的策略。两者都有取舍。对于 JVM，HotSpot JIT 编译器可以使用更简单的代码生成机制（它不需要确定操作数类型，因为它们已经在指令中编码），但这意味着它需要更复杂的字节码格式，具有更多指令类型。

我已经使用 Java（并且欣赏 JVM）大约十年了。

但是，在我看来，CLR 现在几乎在所有方面都是出色的实现。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-17T17:54:54.027

您的第一个问题是将 JVM 与 .NET Framework 进行比较——我假设您实际上是想与 CLR 进行比较。如果是这样，我想你可以写一本关于这个的小书（**编辑：**看起来 Benji 已经有了:-)

一个重要的区别是 CLR 被设计为一种语言中立的体系结构，这与 JVM 不同。

另一个重要的区别是 CLR 专门设计用于允许与本机代码的高级互操作性。这意味着当访问和修改本机内存时，CLR 必须管理可靠性和安全性，并且还必须管理基于 CLR 的数据结构和本机数据结构之间的[编组。](http://msdn.microsoft.com/en-us/magazine/cc163910.aspx)

为了回答您的第二个问题，“虚拟机”一词是硬件世界的一个较旧的术语（例如 IBM 在 1960 年代对 360 的虚拟化），它曾经表示底层机器的软件/硬件模拟以完成相同类型的VMWare 所做的事情。

CLR 通常被称为“执行引擎”。在这种情况下，这是在 x86 之上的 IL 机器的实现。这也是 JVM 所做的，尽管您可以争辩说 CLR 的多态字节码和 JVM 的类型化字节码之间存在重要区别。

所以你的第二个问题的迂腐答案是“不”。但这实际上取决于您如何定义这两个术语。

**编辑：** JVM 和 CLR 之间的另一个区别是 JVM（版本 6）[非常不愿意](https://stackoverflow.com/questions/366658/java-6-excessive-memory-usage/#366776)将分配的内存释放回操作系统，即使它可以。

例如，假设 JVM 进程启动并最初从操作系统分配 25 MB 内存。然后，应用程序代码会尝试分配需要额外 50 MB 的空间。JVM 将从操作系统中额外分配 50 MB。一旦应用程序代码停止使用该内存，就会对其进行垃圾回收，并且 JVM 堆大小将减小。[但是，JVM 只会在某些非常特殊的情况下](https://stackoverflow.com/questions/366658/java-6-excessive-memory-usage#367933)释放分配的操作系统内存。否则，在进程生命周期的剩余时间内，该内存将保持分配状态。

另一方面，如果不再需要分配的内存，CLR 会将其释放回操作系统。在上面的示例中，一旦堆减少，CLR 就会释放内存。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-17T17:10:15.367

CLR 和 JVM 都是虚拟机。

.NET Framework 和 Java 运行时环境是各自 VM 及其库的捆绑。没有库，虚拟机就毫无用处。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-27T23:06:44.703

可以从各种学术和私人来源中找到有关差异的更多细节。一个很好的例子是[CLR Design Choices](http://www.artima.com/intv/choices.html)。

一些具体的例子包括：

*   一些低级操作数是键入的，例如“添加两个整数”，其中 CLR 使用多态操作数。（即 fadd/iadd/ladd 与只是添加）
*   目前，JVM 进行更积极的运行时分析和优化（即 Hotspot）。CLR 当前进行 JIT 优化，但不进行运行时优化（即在运行时替换代码）。
*   CLR 不内联虚拟方法，JVM 确实...
*   除了“原语”之外，还支持 CLR 中的值类型。

* * *

## 回答 #5

> 赞同：-11
> 
> 时间：2009-01-17T17:24:01.703

它不是虚拟机，.net 框架在第一次运行时将程序集编译为本机二进制文件：

在计算中，即时编译（JIT）也称为动态翻译，是一种提高计算机程序运行时性能的技术。JIT 建立在运行时环境中的两个早期想法之上：字节码编译和动态编译。它在本机执行之前在运行时转换代码，例如将字节码转换为本机机器代码。对解释器的性能改进源于缓存翻译代码块的结果，而不是简单地在每次遇到时重新评估每一行或操作数（请参阅解释语言）。与在开发时静态编译代码相比，它还具有优势，因为如果发现这样做有利，它可以重新编译代码，并且可能能够强制执行安全保证。

一些现代运行时环境，例如 Microsoft 的 .NET Framework、大多数 Java 实现以及最近的 Actionscript 3，都依赖 JIT 编译来实现高速代码执行。

资料来源：[http ://en.wikipedia.org/wiki/Just-in-time_compilation](http://en.wikipedia.org/wiki/Just-in-time_compilation)

添加.NET框架包含一个虚拟机，就像Java一样。

# c# - 最好的 C# 拼写检查库是什么？

> ID：453611
> 
> 赞同：34
> 
> 时间：2009-01-17T17:07:23.640
> 
> 标签：c#, .net, asp.net, spell-checking

什么是 C# / .net 的最佳拼写检查库？

（这将是基于 Web 的，因此 WPF 的内置拼写检查将不起作用。）

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-08-31T12:12:44.557

我制作了 Open Office / Google Chrome ... 拼写检查器 Hunspell 的 .NET 版本（包装器）。它被称为[NHunspell](http://nhunspell.sourceforge.net/)，可以与 C#/ VB / .... 一起使用。还包括 Open Office 连字符“Hyphen”。所有 Open Office 词典都可以使用。它是免费的（开源 LGPL / MPL 许可）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T18:03:52.153

我以前使用**[过 Aspell.net](http://aspell-net.sourceforge.net/)**并取得了一些成功。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-27T03:53:37.777

我过去曾成功使用过 NetSpell。[http://sourceforge.net/projects/netspell/](http://sourceforge.net/projects/netspell/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-28T11:55:24.713

对于自定义解决方案，我创建了一个 Web 服务，然后包装 WPF 库。这提供了通过简单地调用 Web 服务来使用 ASP.NET 应用程序/网站的内置拼写检查的能力。

可以在这里找到一个易于理解和基本的包装理念：

[http://www.quicklearn.com/blogsamples/SpellCheck.aspx](http://www.quicklearn.com/blogsamples/SpellCheck.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T18:06:12.757

有一个 aspell .net 包装器。

[http://aspell-net.sourceforge.net/](http://aspell-net.sourceforge.net/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T22:52:46.033

对于商业解决方案：

我目前正在评估 RapidSpell，这似乎是我所需要的。我会说他们的演示安装*似乎*破坏了我的第三方安装。（确实发生了*一些事情*，我在安装他们的演示后就注意到了。但这可能是巧合。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-27T04:00:30.103

Telerik 的 ASP.NET 控制套件带有一个拼写检查器。你可以看看他们。

[http://demos.telerik.com/aspnet-ajax/Spell/Examples/Overview/DefaultCS.aspx](http://demos.telerik.com/aspnet-ajax/Spell/Examples/Overview/DefaultCS.aspx)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-01-17T21:23:40.847

您可以使用 silverlight 嵌入 WPF 拼写检查器。否则，您可能希望查看已经可用的商业产品，例如[Telerik 的 ASP.NET AJAX 控件](http://www.telerik.com/products/aspnet-ajax.aspx)。

# sql-server - Visual Studio 与 SQL Server Management Studio - 你的选择

> ID：453612
> 
> 赞同：24
> 
> 时间：2009-01-17T17:07:52.610
> 
> 标签：sql-server, visual-studio, version-control, ssms, database-management

前言：我在一家从事 ASP.NET 开发并使用 SQL Server 2005 满足我们所有数据库需求的小公司工作。

我很好奇使用 Visual Studio 或 SQL Server Management Studio 进行数据库端开发（即表创建、存储过程编写等）的优缺点是什么。

现在我们在 Management Studio 中执行所有数据库任务，我想知道使用 Visual Studio 是否有一些好处。是否更容易跟踪过程更改和对数据库的其他修改（无论是通过 Visual Studio 本身还是通过某种类型的源代码控制（计划很快实施颠覆）。

我个人在使用 Management Studio 时没有遇到任何问题，但如果通过 Visual Studio 以我不熟悉的方式更高效、更可控，我很想听听。

**编辑**：我只想指出我的特定开发环境是 SQL Sever 2005、Visual Studio 2005 专业版和 Visual Studio Team System 2008 开发版。我们没有运行或安装团队基础服务器或任何其他附加功能。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T17:39:06.103

我个人的方法是对所有与设计相关的东西（模式设计、图表、键、索引等）使用 SQL MS，但在“数据库”项目中的 Visual Studio 中制作我所有的存储过程、函数等附加到我的解决方案 - 主要是因为它让我可以更好地保持 procs 的版本控制（因为我发现它们通常比架构更频繁地更改），而且我发现使用 VS 中的上下文菜单来运行 procs 特别方便直接在我的测试和登台机器上，因为我经常这样做。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-17T17:26:45.677

恕我直言，使用管理工作室的一大优势是“脚本为”。据我所知，VS 中没有等价物。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-08-27T20:08:21.027

Visual Studio 2010 对 SQL Server 项目和解决方案进行了一些相当不错的升级。在这里阅读更多：

[https://web.archive.org/web/20160407003056/http://leonardwoody.com/2011/08/27/introduction-to-visual-studio-database-management/](https://web.archive.org/web/20160407003056/http://leonardwoody.com/2011/08/27/introduction-to-visual-studio-database-management/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T17:37:08.277

我之前使用 Management Studio 进行所有 SQL 工作，但最近我发现 Visual Studio 的内部 SQL 管理器也很不错。我越来越多地使用它来运行快速查询检查和修改数据库方案。

它有一个很棒的 SQL 缩进功能，我发现它非常有用。在我看来，它胜过 Management Studio 的 SQL 着色。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-17T17:31:57.210

这是一个很难的问题。我想这完全取决于你在做什么。如果您正在构建 DAL 和其他东西，使用 VS 可能会更容易，因为有一些很好的集成（拖放等）。VS 可能足以满足您每天 95% 的数据库活动。

但是正如有人已经提到的那样，您没有得到“脚本作为”助手（我一直使用它）。在用户管理工具（登录等）方面，您也不会得到太多（如果有的话）。据我所知，没有办法通过 Visual Studio 管理索引。关于导入/导出数据，您也一无所获。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-17T17:28:34.643

对我而言，Data Dude（又名 Visual Studio 2008 Team System 的数据库版）在完成您的问题所针对的事情方面是一个重大的游戏规则改变者：保持“跟踪过程更改和对数据库的其他修改”。您的团队不仅可以作为一个整体跟踪各种共享环境之间的变化，而且通过源代码控制，每个团队成员都可以跟踪他或她自己相对于所有共享环境的差异。这使得数据库代码成为真正的代码，并具有所有随之而来的好处。

此外，协调数据库之间的差异并让该工具自动生成协调这些差异的代码是一件轻而易举的事。理想情况下，数据库代码将在源代码控制之外直接发布，就像 ASP.NET 代码通常会这样做一样。Data Dude 大大减少了实现这种平等的努力。

一个负面因素是成本：Data Dude 需要为 Visual Studio Pro 上的用户升级到 Team System。幸运的是，很明显微软将把这个功能加入到 Visual Studio 2010 的“开发者”版中，它的定价可能与 Visual Studio 2008 Pro 相似。

# wpf - 如何在 wpf 中将项目置于最前面？

> ID：453613
> 
> 赞同：23
> 
> 时间：2009-01-17T17:08:22.780
> 
> 标签：wpf, grid, z-index, z-order

我只是在彼此之上有两个网格。给定世界的一种状态，我希望网格 A 位于顶部，给定另一种世界状态，我希望网格 B 位于顶部。在过去，我们可以只调用 grid.BringToFront()，但这已经不存在了，我想不出任何方法来实现它。

我能想到的最好的情况是，我需要创建自己的自定义类来实现此功能，但这对于曾经如此简单的东西来说似乎是一种过大的杀伤力。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-17T17:23:47.273

您可以使用[Panel.ZIndex](http://msdn.microsoft.com/en-us/library/system.windows.controls.panel.zindex.aspx)属性更改面板中元素的显示顺序

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-06-09T13:07:22.797

你必须使用 Z 索引属性，并且因为没有内置函数来做你想做的事，所以我自己做了。Z 值越高，越靠近控件前方。所以你想把你的控制放在首位，而不必设置任意的高 Z 值。

因此，这是我为自己编写的一个小函数，可以做到这一点。注意：这假设您使用的是 Canvas 和 UserControls。所以如果不是你的情况，你可能需要稍微调整一下。

基本上它将获取要移动的控件的索引，然后当前位于其上方的任何控件将下降 1，并且要移动的控件将被置于顶部（以保持层次结构）。

```
 static public void BringToFront(Canvas pParent, UserControl pToMove)
    {
            try
            {
                int currentIndex = Canvas.GetZIndex(pToMove);
                int zIndex = 0;
                int maxZ = 0;
                UserControl child;
                for (int i = 0; i < pParent.Children.Count; i++)
                {
                    if (pParent.Children[i] is UserControl &&
                        pParent.Children[i] != pToMove)
                    {
                        child = pParent.Children[i] as UserControl;
                        zIndex = Canvas.GetZIndex(child);
                        maxZ = Math.Max(maxZ, zIndex);
                        if (zIndex > currentIndex)
                        {
                            Canvas.SetZIndex(child, zIndex - 1);
                        }
                    }
                }
                Canvas.SetZIndex(pToMove, maxZ);
            }
            catch (Exception ex)
            {
            }
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-31T05:43:23.823

**敬启者：**

`ZIndex`属性默认为 0，所以如果你（像我一样）有超过 1 个元素（在我的例子中是>4000 个形状）的 Canvas，所有都会有`ZIndex = 0`，所以用这个方法改变 ZIndexes 将没有效果。

为此，我在创建所有元素后将 ZIndexes 设置为已知值，以便可以在之后对它们进行排序。

```
 int zIndex = 0; 
    for (int i = 0; i < canvas.Children.Count; i++) {
        UIElement child = canvas.Children[i] as UIElement;
        if (canvas.Children[i] is UIElement) Canvas.SetZIndex(child, zIndex++);
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-01T20:41:08.317

不要堆叠两个网格，而是更改可见性属性，以便折叠您不使用的网格。

# c# - 最小 Silverlight 示例

> ID：453614
> 
> 赞同：1
> 
> 时间：2009-01-17T17:08:34.590
> 
> 标签：c#, silverlight, boo

Silverlight 应用程序的真正最小示例是什么？

例如，我使用 IronPython 做了以下示例：

```
from System.Windows import Application
from System.Windows.Controls import Canvas, TextBlock

canvas = Canvas()
textblock = TextBlock()
textblock.FontSize = 24
textblock.Text = 'Hello!'
canvas.Children.Add(textblock)

Application.Current.RootVisual = canvas 
```

然后我使用**chiron**并创建了一个 .xap 文件。没有（显式）XAML，什么都没有。是否可以在 C# 中做同样的事情？我可以从命令行编译的一个源文件？如果是这样，源代码是什么？

我的动机是尝试使用非传统语言创建 silverlight 应用程序，现在我被困在 Boo...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-18T06:19:22.887

```
using System;
using System.Windows;
using System.Windows.Controls;

namespace MimimalSilverlightApp
{
    public class App : Application
    {
        public App()
        {
            this.Startup += this.Application_Startup;
        }

        private void Application_Startup(object sender, StartupEventArgs e)
        {
            var canvas = new Canvas();

            var textblock = new TextBlock();
            textblock.FontSize = 24;
            textblock.Text = "Hello!";
            canvas.Children.Add(textblock);

            this.RootVisual = canvas;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-18T10:49:23.153

[在这里](http://jyliao.blogspot.com/2008/11/f-and-silverlight-20.html)找到了一个 F# 示例。

基于它做了一个Boo的例子。源代码：

```
namespace Hello
import System
import System.Windows
import System.Windows.Controls

class MyPage(UserControl):
    def constructor():
        canvas = Canvas()
        textblock = TextBlock()
        textblock.FontSize = 24
        textblock.Text = "Hello!"
        canvas.Children.Add(textblock)

        self.Content = canvas

class MyApp(Application):

    def constructor():      
        Startup += onStartup

    def onStartup(sender, e):

        self.RootVisual = MyPage() 
```

内置：

```
booc -nostdlib -target:library -lib:"C:\Program Files\Microsoft SDKs\Silverlight\v2.0\Reference Assemblies","C:\Program Files\Microsoft SDKs\Silverlight\v2.0\Libraries\Client" -r:System.Windows.dll -r:System.Windows.Controls.dll Hello.boo 
```

AppManifest.xaml：

```
<Deployment xmlns="http://schemas.microsoft.com/client/2007/deployment" 
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
            EntryPointAssembly="Hello" 
            EntryPointType="Hello.MyApp" RuntimeVersion="2.0.31005.0">
  <Deployment.Parts>
    <AssemblyPart x:Name="Hello" Source="Hello.dll" />
    <AssemblyPart x:Name="Boo.Lang" Source="Boo.Lang.dll" />
  </Deployment.Parts>
</Deployment> 
```

然后制作了一个包含 AppManifest.xaml、Hello.dll 和 Boo.Lang.dll（其目录中的 Boo 库之一）的普通 .zip 文件，并将其重命名为 hello.xap。

一个 html 来查看它：

```
<html>
<head></head>
<body>
<object id="SilverlightPlugin" data="data:application/x-silverlight,"
 type="application/x-silverlight-2" width="450" height="540">
  <param name="source" value="hello.xap"/>

  <a href="http://go.microsoft.com/fwlink/?LinkID=124807" style="text-decoration: none;">
    <img src="http://go.microsoft.com/fwlink/?LinkId=108181"
     alt="Get Microsoft Silverlight" style="border-style: none"/>
  </a>
</object>

</body>
</html> 
```

生成的 hello.xap 为 43 KB，比我使用 IronPython 和 DLR 获得的 1.5 MB 要好得多。

# linux - Shell 脚本波浪号扩展

> ID：453627
> 
> 赞同：8
> 
> 时间：2009-01-17T17:15:16.043
> 
> 标签：linux, shell

这是我的脚本：

```
#!/bin/bash 
echo "Digite o local em que deseja instalar o IGRAFU(pressione enter para 
instalar em 
${HOME}/IGRAFO):"
read caminho
if test -z $caminho
then
caminho="${HOME}/IGRAFO"
fi
echo "O IGRAFU será instalado no diretório: $caminho"
mkdir -pv $caminho

mv -v ./* $caminho
echo "Pronto!" 
```

在“read caminho”处，我可能会从用户那里收到一条路径，如 ~/somefolder。当脚本接收到这种路径时， mv 和 mkdir 都不会进行波浪号扩展，因此它将尝试创建一个 ~/somefolder 而不是 /home/username/somefolder 并因此失败。

如何确保波浪号将转换为 HOME 变量？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-17T17:23:09.567

您可能需要评估变量以正确替换它。一个例子是简单地做

```
caminho=`eval "echo $caminho"` 
```

请记住，如果`caminho`包含分号或引号，这将中断，它还将反斜杠视为转义，并且如果数据不受信任，则需要注意您不是注入攻击的目标。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T17:36:10.413

引用和扩展总是很棘手，尤其是在 bash 中。如果您自己的主目录足够好，则此代码有效（我已经测试过）：

```
if test -z $caminho
then
caminho="${HOME}/IGRAFO"
else
  case "$caminho" in
    '~')   caminho="$HOME" ;;
    '~'/*) caminho="$HOME/${caminho#'~/'}" ;; 
    '~'*)  echo "Case of '$caminho' is not implemented" 1>&2 ;;
  esac
fi 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-17T17:25:35.553

如果 if 不是，则可能使用`/home/${USER}`替换您的高级用户级别目录`/home`。

# antivirus - （反）病毒阻止我的应用程序工作？

> ID：453634
> 
> 赞同：1
> 
> 时间：2009-01-17T17:22:36.510
> 
> 标签：antivirus

在我的另一台 PC（Windows XP SP2）上，我使用 msvc05 从我的主 PC 上运行我的应用程序，对网络上的文件进行排序，发现它无法移动目录。我在那台电脑上使用的一个应用程序无法正常运行。所有文件都是自动只读的。现在在这台电脑上我有同样的症状。还没有什么好笑的安静（tortoiseSVN 做到了，但我不确定 readonly 是问题所在），但我知道最终会的。为什么一切都是只读的？我用谷歌搜索了这个问题，它说关闭bitdefender。我还没有 DL bitdefender。我 DL 诺顿杀毒软件并扫描了我的电脑，没有出现病毒。这是怎么回事？

注意：在这台电脑上，只读框没有复选标记，而是一个正方形。进入文件夹，所有文件都有一个空框。我打开了查看不可见文件和系统文件。我在那个文件夹中看不到任何东西。我认为另一台 PC 可能有复选标记，但我不确定。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-02T07:11:44.850

您确定您（或您的 app_）有权写入这些目录吗？

如果您只有读取权限，则文件似乎是只读的。

# c - F 键 ( F[1-12]) 和箭头键有哪些数值？

> ID：453640
> 
> 赞同：1
> 
> 时间：2009-01-17T17:24:23.090
> 
> 标签：c, command-line

我想用 C 语言编写一个应用程序，它使用箭头键导航和 F 键用于其他功能，例如保存到文件、语言选择等。

可能这些值取决于平台，那么我如何找出键具有哪些值？

如果他们不知道，或者如果您认识他们，我不必知道如何找出；）

编辑：我的平台是 Linux 和 M$ Windows。因此，我正在寻找一种尽可能便携的解决方案。

（可能像

```
#ifdef __unix__
   #define F1 'some number'
   /* ... */
   #define ARROW_UP 'some other number'
#elif __WIN32__ || MSDOS /*whatever*/
   #define F1 'something'
   /* ... */
   #define ARROW_UP 'something different'
#endif 
```

)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T17:31:05.183

我认为这取决于 $TERM，但无论哪种方式，它都将是一个字符序列。我明白了：

```
% read x; echo $x | od -c --
^[[15~
0000000  033   [   1   5   ~  \n                                        
0000006 
```

那是我的 F5 键，如果这不是您的平台，请原谅这是一个以 *nix 为中心的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T17:46:37.693

这个问题比任何人都想的要复杂得多。简而言之，这些键中的每一个都会发送一系列字符，详细信息取决于正在使用的终端仿真器。在 Unix 上，您有几个选择：

*   编写您的应用程序以使用该`curses`库并使用其与`terminfo`数据库的接口。

*   自己解析`terminfo`数据库以查找序列。或者要使用 API，请查看源代码`tput`以了解这是如何完成的。

*   使用命令行程序`tput`来帮助发现序列。例如，要学习 F10 的序列，请运行`tput kf10 | od -a`. 请记住，这会随着终端的变化而变化，因此您应该在`tput`每次运行应用程序时运行。

*   使用其中一个 X 库编写应用程序并访问“关键符号”而不是字符序列。该`XLookupKeysym`功能是入门的好地方；您会在 中找到符号的名称`/usr/include/X11/keysymdef.h`。如果您打算从非 X 系统（例如 Windows）通过网络连接，则此选项不太好。

我不知道如何在 Windows 上执行任何这些操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T17:32:54.697

如果您在 Unix 或 Linux 机器上，只需输入 cntl-V，然后在 vim* 中输入密钥。你会看到代码。

高温高压

干杯，

抢

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T17:41:51.230

这个方便的网站有很多关于原始扫描码的有用信息：

[http://www.win.tue.nl/~aeb/linux/kbd/scancodes.html#toc1](http://www.win.tue.nl/~aeb/linux/kbd/scancodes.html#toc1)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T18:51:47.203

一些键生成 2 个字符的[键码](http://www.beyondlogic.org/keyboard/keybrd.htm)。我在 pc 上成功使用的一种技术是获取 2 个字符，并在第二个字符上设置第 7 位，然后返回该字符作为答案。它让程序的其余部分将每个击键视为单个字符。

您的问题的解决方案取决于您需要支持的密钥。将翻译隐藏在某种功能后面通常是一个好主意。

# flash - Flash ocx 中的 AxShockwaveFlashObjects 和 ShockwaveFlashObjects

> ID：453654
> 
> 赞同：0
> 
> 时间：2009-01-17T17:33:17.317
> 
> 标签：flash, activex, ocx

我正在尝试创建：

AxShockwaveFlashObjects.dll 和 ShockwaveFlashObjects.dll

输入以下命令：

aximp C:\WINDOWS\system32\Macromed\Flash\FlDbg10.ocx /nologo

但我收到 E_ACCESSDENIED 错误。

我究竟做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T05:17:18.337

打开命令提示符。切换到包含 aximp.exe 文件的目录。通常; C:\Program Files\Microsoft Visual Studio 8\SDK\v2.0\Bin>

输入以下命令（您可能需要更改 COX 文件的名称以匹配您的版本。

aximp.exe -source "C:\WNDOWS\system32\Macromed\Flash\Flash10a.ocx"

查看 C:\WNDOWS\system32\Macromed\Flash\ 目录。你的文件应该在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-08T23:28:27.607

访问被拒绝可能是由于程序试图修改 Program Files 或 Windows 顶级文件夹中已注册应用程序目录中的文件而导致的 Vista/Win7 问题。

解决方法（它对我有用）是

*   将**AxImp.exe**和您的`.OCX`文件都复制到某个用户创建的文件夹（*例如* `c:\test\`：） 。

*   然后只需`AxImp.exe Flash10c.ocx /source`从该文件夹中的命令行运行命令即可。

这不仅会生成（在同一个`test`文件夹中）您的两个 DLL 文件，还会生成`.CS`源文件（用于包含在项目中）和`.PDB`调试器符号文件。享受！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-07T08:06:51.527

确实，此错误出现在 Windows 7 或 vista 中。您可以简单地以管理员身份运行命令提示符，然后从命令提示符处执行此命令。它以这种方式工作而不做任何其他事情。

# ruby-on-rails - Mac（计算机）对 Rails 开发人员有什么好处？

> ID：453655
> 
> 赞同：16
> 
> 时间：2009-01-17T17:33:53.430
> 
> 标签：ruby-on-rails, macos

我试图理解为什么这么多 Rails 开发发生在 Mac 上？或者这只是一个神话？有任何确凿的证据支持这一点吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-17T17:47:59.127

Rails Core 团队都使用 Mac，DHH 过去一直[提倡使用 Mac](http://www.loudthinking.com/arc/000433.html)。许多[教程](http://danbenjamin.com/articles/2008/02/ruby-rails-leopard)或说明都是假设读者使用的是 Mac 或至少是类 UNIX 操作系统而编写的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-01-17T17:40:43.090

我认为这是因为许多 Ruby/Rails 开发人员喜欢使用仅适用于 Mac的[Textmate编辑器。](http://macromates.com/)几乎我看过的每个 Rails 教程视频，编码器都在使用 TextMate。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-17T17:38:08.990

一般来说，Mac OS X 和 Linux 对大多数开源软件的支持要好得多。这两个平台在没有 Visual Studio 等专有软件的情况下进行开发更加友好（实际上，您可能需要 Apple 的开发人员工具来进行任何真正的编译，但这些只是 GCC 的修改版本）。

具有 Linux 兼容性很好，因为大多数 Rails 服务器运行某种类型的 Linux。至于为什么人们不经常使用 Linux 进行开发……嗯，Mac 界面更好。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-18T03:09:32.770

Mac 让您确信，当开发 Rails 应用程序出现问题时，这是您的错，因为几乎所有库开发人员都在使用它们，所以他们使用它们进行测试，而 Windows 测试排在第二位。

在 Windows 机器上，总是有两种可能性——你搞砸了，或者 Windows 有问题。它是一个 PITA，用于处理库依赖关系，其中一个链对于 Windows 来说是中断的，直到安装其他东西并搞砸整个设置之后你才发现。

每次消除第二种可能性都值得花一些钱，因为它可以节省您的时间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-17T17:36:21.507

这是次要的，但 Leopard 安装了 Rails。我不确定是否必须安装开发人员工具才能获得它。

这可能会有所帮助，但我怀疑它有多大影响。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-18T03:19:34.963

大多数情况下，rails 应用程序是在 OSX 上开发并部署到 linux 上的。所以这是所有库都倾向于正常工作的两个平台。如果您不这样做，那么对于 Rails 来说，非标准操作系统（如 Solaris 或 Windows）可能无法按预期工作。

我想说，就 ruby​​ on rails 开发而言，选择 Mac 而不是 Windows 有很好的论据。但是使用 OSX 与 Linux 并没有真正的优势。Apple 硬件运行良好，它的操作系统运行良好，就像 unix 一样，大多数情况下都可以运行。安装库工作，你总是有命令行，等等......

很多人都指向 textmate，但现实情况是，在[rails cabal](http://caboo.se)中的许多人都放弃了 textmate，转而使用 emacs 或 vim。

在 Windows 上进行 Rails 开发是一项痛苦的 hackish 任务。而且我什至从未听说有人试图使用 Windows 部署生产轨道。并不是说 windows 不能成为一流的 ruby​​ / rails 操作系统，只是没有足够的开发人员使用该平台来跟上步伐。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-04-15T18:08:47.900

老实说，我相信 Linux 是开发 Rails 应用程序的最佳操作系统，因为该应用程序可能会托管在 Linux 服务器中，并且我们知道我们希望尽可能接近地复制生产环境以减少部署问题。

这是我的意见。无论如何，Linux 和 Mac 都是不错的选择。尽量避免使用 Windows，你最终会转向 Linux/Mac（我做到了......）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-17T17:38:19.613

就我个人而言，我认为 Mac（或专门在 OSX 中开发）不会为 Rails 开发提供任何真正的优势。

如果我更刻薄的话，我会说使用 Mac 的人是那种喜欢跳上“新的和闪亮的”潮流的人，而 Rails 绝对是那里更受欢迎和“酷”的东西之一。

注意：我不太相信，但人们喜欢讨厌 Mac 用户。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-17T22:10:05.197

我同意使用 Mac 进行 Rails 开发的主要原因是[TextMate](http://macromates.com/ "文本伴侣主页")。TextMate 为您提供了许多常见 Rails 代码的快捷方式，例如键入 bf + tab 以获得 before_filter。此外，您在 Mac Terminal 中所做的大部分工作都可以轻松转换为 Linux 命令行，当您扩展您的架构证书时，这绝对是一项资产。此外，Rails 使用了许多开源技术，而 Mac 通过使编译和构建这些应用程序相当简单，帮助加快了安装过程。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-12-08T11:28:24.847

Rails 开发人员使用 Mac，因为：

*   Mac UI 看起来不错。2007 年，当 Rails 开始大肆宣传时，Ubuntu 并没有今天那么好看。
*   Mac 有一个强大的终端和包管理器，类似于 Ubuntu。
*   Mac 可以运行 Mac Office，如果您的公司使用 Exchange Server，这很重要。
*   Mac 可以运行 Photoshop，这对设计师来说很重要。UI 设计人员需要能够在他们的计算机上运行 Ruby 应用程序以获得即时反馈。
*   许多 Rails/Ruby 大师都使用 Mac，并且在他们的博客上有 Mac 特定的代码/说明。

如果您是使用 IMAP 的后端开发人员，您可以愉快地使用 Linux。前端开发人员倾向于使用 Photoshop，因此使用 Mac。因为许多 Rails 开发人员必须提供他们使用 Mac 的整个堆栈（多合一开发人员）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-01-17T21:13:54.750

我认为最大的一个是 OSX（和任何桌面 linux）开箱即用地支持 SSH。使用 Putty 是一个巨大的 PITA，像 Capistrano 这样的实用程序与 Windows 不能很好地配合。另外 Mac 很少崩溃。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-04T20:13:01.923

可能是基于 Mac 的 Rails 开发人员在 Web 上比基于 Windows 的开发人员更容易看到，但我确实相信 Mac 在 Rails 世界中的影响力非常大。（我喜欢这样:)）

为什么？我会说 Textmate 肯定是一个因素，但可能不是最大的因素。

我每天都使用windows和mac。在 Windows 中，总是有一些问题困扰着我……某些东西崩溃了，或者防病毒软件有更新，或者托盘中弹出了一些其他通知。操作系统总是需要我的关注，需要我做点什么。

在不会发生的mac上。我只是做我想做的事，而不必为操作系统做任何事情。**我**使用计算机工作，而不是**为**操作系统工作。结果是我在 Mac 上的工作效率始终较高。

接受它，赋予它所有 UNIX/Linux 系统的强大功能，以及与 UNIX/Linux 的互操作性，你就会得到一个非常棒的编程平台。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-17T22:15:42.207

这可能是因为 textmate，但也有一个适用于 windows 的 textmate（google for e-texteditor）。

虽然我是 mac 和 linux 爱好者，但我认为不同的操作系统不应该阻止你编程任何语言/框架。使用你喜欢的任何东西，并感到舒适。这是您可以拥有的最大优势。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-19T06:49:38.550

如果你有一个人们喜欢 TextMate 的编辑器，那么 OS X 不会比任何其他 *NIX 更好，但我喜欢我的 Mac 的主要原因就像大多数其他 Mac 开发人员一样。界面很好，它是一个非常稳定的工作平台，即我花更多的时间工作而不是让它工作，还有TextMate。对于我所做的所有开发，没有更好的编辑器可以使用它，当您对自己的工具感到满意时，您的工作效率就会最高。我认为这就是人们喜欢在 Mac 上开发的原因。

# mysql - 为 Delphi 开发 MySQL.pas 包装器

> ID：453657
> 
> 赞同：3
> 
> 时间：2009-01-17T17:34:43.820
> 
> 标签：mysql, delphi, wrapper

**背景：**我想在项目中使用 mysql.c 的 Delphi 翻译，但原始维护者 Matthias Fichtner ( [http://www.fichtner.net/delphi/mysql/](http://www.fichtner.net/delphi/mysql/) ) 似乎已将其删除。

**问题：**有谁知道*libmySQL.dll*的类似包装器（或 Matthias Fichtner 的包装器的更新版本）在轻量级性质上相似？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-05-04T13:45:24.217

原来的 URL [http://www.fichtner.net/delphi/mysql](http://www.fichtner.net/delphi/mysql)现在重定向到这里：[http ://www.audio-data.de/mysql.html](http://www.audio-data.de/mysql.html)

这似乎是比吉姆发布的版本更新得多的版本。

> **mysql.pas（版本 2009-09-13）**
> 
> 使用 LibMySql.dll 或 LibMySqld.dll（嵌入式 MYSQL 服务器）的 MySQL AB 的 SQL 数据库服务器的客户端 API。它是 mysql.h 和其他一些为 MySQL 数据库服务器编写客户端所需的 C 头文件的 Pascal 翻译。
> 
> 该单元经过以下测试：
> 
> *   德尔福版本：(3)、(4)、5、​​6、2007、2009、2010。
> *   LibMySql.dll 版本：3.23、4.0、4.1、5.0、5.1、6.0
> *   MySQL 服务器版本：3.23、4.0、4.1、5.0、5.1

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T23:50:41.097

[MySQL.pas](http://www.geocities.com/siazali/mysql5/mysql.pas)

```
// -----------------------------------------------------------------------------------------------
//
//                    MySQL Client API for Borland Delphi (version 4 and above)
//
//                           Pascal Interface Unit for libmySQL.dll, the
//                        Client Library for MySQL AB's SQL Database Server
//
//                  This is a literal translation of relevant parts of MySQL AB's
//                    C header files, mysql.h, mysql_com.h, and mysql_version.h
//
//                            Copyright (c) 1999-2002 Matthias Fichtner
//                           (see license.txt for licensing information)
//
// -----------------------------------------------------------------------------------------------
//                       See mysql.h for MySQL AB's copyright and GPL notice
// -----------------------------------------------------------------------------------------------
//
//       17-Aug-1999  mf  Translated mysql.h                             MySQL 3.22.24
//       19-Aug-1999  mf  Corrected some type definitions                MySQL 3.22.24
//       20-Aug-1999  mf  Finished debugging the unit                    MySQL 3.22.24
//       18-Sep-1999  mf  Code maintenance for release 3.22.26a          MySQL 3.22.26a
//       22-Oct-1999  mf  Code maintenance for release 3.22.28           MySQL 3.22.28
//       02-Jan-2000  mf  Code maintenance for release 3.22.29           MySQL 3.22.29
//       21-Jan-2000  mf  Code maintenance for release 3.22.30           MySQL 3.22.30
//       07-Feb-2000  mf  Code maintenance for release 3.22.31           MySQL 3.22.31
//       16-Feb-2000  mf  Code maintenance for release 3.22.32           MySQL 3.22.32
//       13-Aug-2000  mf  Code maintenance for release 3.22.34           MySQL 3.22.34
//       14-Aug-2000  mf  Reworked entire unit for first 3.23 release    MySQL 3.23.19-beta
//       14-Aug-2000  mf  Added mysql_character_set_name()               MySQL 3.23.22-beta
//       11-Sep-2000  mf  Added IS_NUM_FIELD and INTERNAL_NUM_FIELD      MySQL 3.23.24-beta
//       08-Oct-2000  mf  Modified TMEM_ROOT, enum_server_command,       MySQL 3.23.25-beta
//                        and INTERNAL_NUM_FIELD
//       01-Nov-2000  mf  Code maintenance for release 3.23.27           MySQL 3.23.27-beta
//       25-Nov-2000  mf  Code maintenance for release 3.23.28           MySQL 3.23.28-gamma
//       05-Jan-2001  mf  Code maintenance for release 3.23.30           MySQL 3.23.30-gamma
//       19-Jan-2001  mf  Code maintenance for release 3.23.31           MySQL 3.23.31
//       11-Mar-2001  mf  Added functions mysql_real_send_query(),       MySQL 3.23.33
//                        mysql_send_query(), and mysql_reap_query()
//       28-Mai-2001  mf  Modified mysql_send_query(), removed           MySQL 3.23.38
//                        mysql_real_send_query(), mysql_reap_query(),
//                        added mysql_read_query_result(), and fixed
//                        CLIENT_TRANSACTIONS
//       07-Aug-2001  mf  Code maintenance for release 3.23.40           MySQL 3.23.40
//       23-Sep-2001  mf  Code maintenance for release 3.23.42           MySQL 3.23.42
//       29-Jan-2002  mf  Added libmysql_load(), libmysql_free(),        MySQL 3.23.47
//                        libmysql_status and LIBMYSQL_ constants
//                        for dynamic loading of libmySQL.dll
//       11-Mar-2002  mf  Added MYSQL_OPT_LOCAL_INFILE to mysql_option   MySQL 3.23.49
//
// -----------------------------------------------------------------------------------------------
//
//                   Latest releases of mysql.pas are made available through the
//                   distribution site at: http://www.fichtner.net/delphi/mysql/
//
//                  Please send questions, bug reports, and suggestions regarding
//                  mysql.pas to Matthias Fichtner <mfichtner@fichtner-meyer.com>
//
//                      See readme.txt for an introduction and documentation.
//                    See license.txt for licensing information and disclaimer.
//
// -----------------------------------------------------------------------------------------------
//                     This unit is provided "as is". Use it at your own risk.
// -----------------------------------------------------------------------------------------------

unit mysql;

// -----------------------------------------------------------------------------------------------
INTERFACE
// -----------------------------------------------------------------------------------------------

uses
  Windows,  // Needed for some type definitions
  Winsock;  // Needed for some type definitions

// ----------------
// From mysql.h ...
// ----------------

type
  my_bool = byte;
  gptr = pChar;

type
  PUSED_MEM = ^TUSED_MEM;  // struct for once_alloc
  TUSED_MEM = record
    next: PUSED_MEM;       // Next block in use
    left: longword;        // memory left in block
    size: longword;        // size of block
  end;

type
  error_proc = procedure;

type
  PMEM_ROOT = ^TMEM_ROOT;
  TMEM_ROOT = record
    free: PUSED_MEM;
    used: PUSED_MEM;
    pre_alloc: PUSED_MEM;
    min_malloc: longword;
    block_size: longword;
    error_handler: error_proc;
  end;

type
  my_socket = TSocket;

// --------------------
// From mysql_com.h ...
// --------------------

const
  NAME_LEN = 64;               // Field/table name length
  HOSTNAME_LENGTH = 60;
  USERNAME_LENGTH = 16;
  SERVER_VERSION_LENGTH = 60;

  LOCAL_HOST = 'localhost';
  LOCAL_HOST_NAMEDPIPE = '.';

  MYSQL_NAMEDPIPE = 'MySQL';
  MYSQL_SERVICENAME = 'MySql';

type
  enum_server_command = (
    COM_SLEEP, COM_QUIT, COM_INIT_DB, COM_QUERY,
    COM_FIELD_LIST, COM_CREATE_DB, COM_DROP_DB, COM_REFRESH,
    COM_SHUTDOWN, COM_STATISTICS,
    COM_PROCESS_INFO, COM_CONNECT, COM_PROCESS_KILL,
    COM_DEBUG, COM_PING, COM_TIME, COM_DELAYED_INSERT,
    COM_CHANGE_USER, COM_BINLOG_DUMP,
    COM_TABLE_DUMP, COM_CONNECT_OUT
  );

const
  NOT_NULL_FLAG = 1;      // Field can't be NULL
  PRI_KEY_FLAG = 2;       // Field is part of a primary key
  UNIQUE_KEY_FLAG = 4;    // Field is part of a unique key
  MULTIPLE_KEY_FLAG = 8;  // Field is part of a key
  BLOB_FLAG = 16;         // Field is a blob
  UNSIGNED_FLAG = 32;     // Field is unsigned
  ZEROFILL_FLAG = 64;     // Field is zerofill
  BINARY_FLAG = 128;

  // The following are only sent to new clients

  ENUM_FLAG = 256;            // field is an enum
  AUTO_INCREMENT_FLAG = 512;  // field is a autoincrement field
  TIMESTAMP_FLAG = 1024;      // Field is a timestamp
  SET_FLAG = 2048;            // field is a set
  NUM_FLAG = 32768;           // Field is num (for clients)
  PART_KEY_FLAG = 16384;      // Intern; Part of some key
  GROUP_FLAG = 32768;         // Intern: Group field
  UNIQUE_FLAG = 65536;        // Intern: Used by sql_yacc

  REFRESH_GRANT = 1;     // Refresh grant tables
  REFRESH_LOG = 2;       // Start on new log file
  REFRESH_TABLES = 4;    // close all tables
  REFRESH_HOSTS = 8;     // Flush host cache
  REFRESH_STATUS = 16;   // Flush status variables
  REFRESH_THREADS = 32;  // Flush status variables
  REFRESH_SLAVE = 64;    // Reset master info and restart slave
                         // thread
  REFRESH_MASTER = 128;  // Remove all bin logs in the index
                         // and truncate the index

  // The following can't be set with mysql_refresh()

  REFRESH_READ_LOCK = 16384;  // Lock tables for read
  REFRESH_FAST = 32768;       // Intern flag

  CLIENT_LONG_PASSWORD = 1;      // new more secure passwords
  CLIENT_FOUND_ROWS = 2;         // Found instead of affected rows
  CLIENT_LONG_FLAG = 4;          // Get all column flags
  CLIENT_CONNECT_WITH_DB = 8;    // One can specify db on connect
  CLIENT_NO_SCHEMA = 16;         // Don't allow database.table.column
  CLIENT_COMPRESS = 32;          // Can use compression protcol
  CLIENT_ODBC = 64;              // Odbc client
  CLIENT_LOCAL_FILES = 128;      // Can use LOAD DATA LOCAL
  CLIENT_IGNORE_SPACE = 256;     // Ignore spaces before '('
  CLIENT_INTERACTIVE = 1024;     // This is an interactive client
  CLIENT_SSL = 2048;             // Switch to SSL after handshake
  CLIENT_IGNORE_SIGPIPE = 4096;  // IGNORE sigpipes
  CLIENT_TRANSACTIONS = 8192;    // Client knows about transactions

  SERVER_STATUS_IN_TRANS = 1;    // Transaction has started
  SERVER_STATUS_AUTOCOMMIT = 2;  // Server in auto_commit mode

  MYSQL_ERRMSG_SIZE = 200;
  NET_READ_TIMEOUT = 30;       // Timeout on read
  NET_WRITE_TIMEOUT = 60;      // Timeout on write
  NET_WAIT_TIMEOUT = 8*60*60;  // Wait for new query

type
  PVio = ^TVio;
  TVio = record
  end;

type
  PNET = ^TNET;
  TNET = record
    vio: PVio;
    fd: my_socket;
    fcntl: longint;
    buff, buff_end, write_pos, read_pos: pByte;
    last_error: array [0..MYSQL_ERRMSG_SIZE - 1] of char;
    last_errno, max_packet, timeout, pkt_nr: longword;
    error: byte;
    return_errno, compress: my_bool;
    no_send_ok: my_bool;  // needed if we are doing several
      // queries in one command ( as in LOAD TABLE ... FROM MASTER ),
      // and do not want to confuse the client with OK at the wrong time
    remain_in_buf, length, buf_length, where_b: longword;
    return_status: pLongword;
    reading_or_writing: byte;
    save_char: char;
  end;

const
  packet_error: longword = $ffffffff;

const
  FIELD_TYPE_DECIMAL = 0;
  FIELD_TYPE_TINY = 1;
  FIELD_TYPE_SHORT = 2;
  FIELD_TYPE_LONG = 3;
  FIELD_TYPE_FLOAT = 4;
  FIELD_TYPE_DOUBLE = 5;
  FIELD_TYPE_NULL = 6;
  FIELD_TYPE_TIMESTAMP = 7;
  FIELD_TYPE_LONGLONG = 8;
  FIELD_TYPE_INT24 = 9;
  FIELD_TYPE_DATE = 10;
  FIELD_TYPE_TIME = 11;
  FIELD_TYPE_DATETIME = 12;
  FIELD_TYPE_YEAR = 13;
  FIELD_TYPE_NEWDATE = 14;
  FIELD_TYPE_ENUM = 247;
  FIELD_TYPE_SET = 248;
  FIELD_TYPE_TINY_BLOB = 249;
  FIELD_TYPE_MEDIUM_BLOB = 250;
  FIELD_TYPE_LONG_BLOB = 251;
  FIELD_TYPE_BLOB = 252;
  FIELD_TYPE_VAR_STRING = 253;
  FIELD_TYPE_STRING = 254;

const
  FIELD_TYPE_CHAR = FIELD_TYPE_TINY;      // For compability
  FIELD_TYPE_INTERVAL = FIELD_TYPE_ENUM;  // For compability

type
  enum_field_types = FIELD_TYPE_DECIMAL..FIELD_TYPE_STRING;

// ------------------------
// From mysql_version.h ...
// ------------------------

const
  PROTOCOL_VERSION = 10;
  MYSQL_SERVER_VERSION = '3.23.49';
  MYSQL_SERVER_SUFFIX = '';
  FRM_VER = 6;
  MYSQL_VERSION_ID = 32349;
  MYSQL_PORT = 3306;
  MYSQL_UNIX_ADDR = '/tmp/mysql.sock';

// ----------------
// From mysql.h ...
// ----------------

function IS_PRI_KEY(n: longword): boolean;
function IS_NOT_NULL(n: longword): boolean;
function IS_BLOB(n: longword): boolean;
function IS_NUM(t: longword): boolean;

type
  PMYSQL_FIELD = ^TMYSQL_FIELD;
  TMYSQL_FIELD = record
    name: pChar;              // Name of column
    table: pChar;             // Table of column if column was a field
    def: pChar;               // Default value (set by mysql_list_fields)
    _type: enum_field_types;  // Type of field. Se mysql_com.h for types
    length: longword;         // Width of column
    max_length: longword;     // Max width of selected set
    flags: longword;          // Div flags
    decimals: longword;       // Number of decimals in field
  end;

function IS_NUM_FIELD(f: PMYSQL_FIELD): boolean;
function INTERNAL_NUM_FIELD(f: PMYSQL_FIELD): boolean;

type
  PMYSQL_ROW = ^TMYSQL_ROW;  // return data as array of strings
  TMYSQL_ROW = array[0..MaxInt div SizeOf(pChar) - 1] of pChar;

type
  MYSQL_FIELD_OFFSET = longword;  // offset to current field

type
  my_ulonglong = int64;

const
  MYSQL_COUNT_ERROR: my_ulonglong = not 0;

type
  PMYSQL_ROWS = ^TMYSQL_ROWS;
  TMYSQL_ROWS = record
    next: PMYSQL_ROWS;  // list of rows
    data: PMYSQL_ROW;
  end;

type
  MYSQL_ROW_OFFSET = PMYSQL_ROWS;  // offset to current row

type
  PMYSQL_DATA = ^TMYSQL_DATA;
  TMYSQL_DATA = record
    rows: my_ulonglong;
    fields: longword;
    data: PMYSQL_ROWS;
    alloc: TMEM_ROOT;
  end;

type
  PMYSQL_OPTIONS = ^TMYSQL_OPTIONS;
  TMYSQL_OPTIONS = record
    connect_timeout, client_flag: longword;
    compress, named_pipe: my_bool;
    port: longword;
    host, init_command, user, password, unix_socket, db: pChar;
    my_cnf_file, my_cnf_group, charset_dir, charset_name: pChar;
    use_ssl: my_bool;   // if to use SSL or not
    ssl_key: pChar;     // PEM key file
    ssl_cert: pChar;    // PEM cert file
    ssl_ca: pChar;      // PEM CA file
    ssl_capath: pChar;  // PEM directory of CA-s?
  end;

type
  mysql_option = (
    MYSQL_OPT_CONNECT_TIMEOUT, MYSQL_OPT_COMPRESS,
    MYSQL_OPT_NAMED_PIPE, MYSQL_INIT_COMMAND,
    MYSQL_READ_DEFAULT_FILE, MYSQL_READ_DEFAULT_GROUP,
    MYSQL_SET_CHARSET_DIR, MYSQL_SET_CHARSET_NAME,
    MYSQL_OPT_LOCAL_INFILE
  );

type
  mysql_status = (
    MYSQL_STATUS_READY, MYSQL_STATUS_GET_RESULT,
    MYSQL_STATUS_USE_RESULT
  );

type
  PMYSQL_FIELDS = ^TMYSQL_FIELDS;
  TMYSQL_FIELDS = array[0..MaxInt div SizeOf(TMYSQL_FIELD) - 1] of TMYSQL_FIELD;

type
  PCHARSET_INFO = ^TCHARSET_INFO;
  TCHARSET_INFO = record
    // Omitted: Structure not necessarily needed.
    // Definition of struct charset_info_st can be
    // found in include/m_ctype.h
  end;

type
  PMYSQL = ^TMYSQL;
  TMYSQL = record
    net: TNET;                    // Communication parameters
    connector_fd: gptr;           // ConnectorFd for SSL
    host, user, passwd, unix_socket, server_version, host_info, info, db: pChar;
    port, client_flag, server_capabilities: longword;
    protocol_version: longword;
    field_count: longword;
    server_status: longword;
    thread_id: longword;          // Id for connection in server
    affected_rows: my_ulonglong;
    insert_id: my_ulonglong;      // id if insert on table with NEXTNR
    extra_info: my_ulonglong;     // Used by mysqlshow
    packet_length: longword;
    status: mysql_status;
    fields: PMYSQL_FIELDS;
    field_alloc: TMEM_ROOT;
    free_me: my_bool;             // If free in mysql_close
    reconnect: my_bool;           // set to 1 if automatic reconnect
    options: TMYSQL_OPTIONS;
    scramble_buff: array [0..8] of char;
    charset: PCHARSET_INFO;
    server_language: longword;
  end;

type
  PMYSQL_RES = ^TMYSQL_RES;
  TMYSQL_RES = record
    row_count: my_ulonglong;
    field_count, current_field: longword;
    fields: PMYSQL_FIELDS;
    data: PMYSQL_DATA;
    data_cursor: PMYSQL_ROWS;
    field_alloc: TMEM_ROOT;
    row: PMYSQL_ROW;          // If unbuffered read
    current_row: PMYSQL_ROW;  // buffer to current row
    lengths: pLongword;       // column lengths of current row
    handle: PMYSQL;           // for unbuffered reads
    eof: my_bool;             // Used my mysql_fetch_row
  end;

// Functions to get information from the MYSQL and MYSQL_RES structures
// Should definitely be used if one uses shared libraries

var
  mysql_num_rows: function(res: PMYSQL_RES): my_ulonglong; stdcall;
  mysql_num_fields: function(res: PMYSQL_RES): longword; stdcall;
  mysql_eof: function(res: PMYSQL_RES): my_bool; stdcall;
  mysql_fetch_field_direct: function(res: PMYSQL_RES; fieldnr: longword): PMYSQL_FIELD; stdcall;
  mysql_fetch_fields: function(res: PMYSQL_RES): PMYSQL_FIELDS; stdcall;
  mysql_row_tell: function(res: PMYSQL_RES): PMYSQL_ROWS; stdcall;
  mysql_field_tell: function(res: PMYSQL_RES): longword; stdcall;

var
  mysql_field_count: function(_mysql: PMYSQL): longword; stdcall;
  mysql_affected_rows: function(_mysql: PMYSQL): my_ulonglong; stdcall;
  mysql_insert_id: function(_mysql: PMYSQL): my_ulonglong; stdcall;
  mysql_errno: function(_mysql: PMYSQL): longword; stdcall;
  mysql_error: function(_mysql: PMYSQL): pChar; stdcall;
  mysql_info: function(_mysql: PMYSQL): pChar; stdcall;
  mysql_thread_id: function(_mysql: PMYSQL): longword; stdcall;
  mysql_character_set_name: function(_mysql: PMYSQL): pChar; stdcall;

type
  PMYSQL_LENGTHS = ^TMYSQL_LENGTHS;
  TMYSQL_LENGTHS = array[0..MaxInt div SizeOf(longword) - 1] of longword;

type
  extend_buffer_func = function(void: pointer; _to: pChar; length: pLongword): pChar;

var
  mysql_init: function(_mysql: PMYSQL): PMYSQL; stdcall;
  {$IFDEF HAVE_OPENSSL}
  mysql_ssl_set: function(_mysql: PMYSQL; const key, cert, ca, capath: pChar): longint; stdcall;
  mysql_ssl_cipher: function(_mysql: PMYSQL): pChar; stdcall;
  mysql_ssl_clear: function(_mysql: PMYSQL): longint; stdcall;
  {$ENDIF} // HAVE_OPENSSL
  mysql_connect: function(_mysql: PMYSQL; const host, user, passwd: pChar): PMYSQL; stdcall;
  mysql_change_user: function(_mysql: PMYSQL; const user, passwd, db: pChar): my_bool; stdcall;
  mysql_real_connect: function(_mysql: PMYSQL; const host, user, passwd, db: pChar; port: longword; const unix_socket: pChar; clientflag: longword): PMYSQL; stdcall;
  mysql_close: procedure(sock: PMYSQL); stdcall;
  mysql_select_db: function(_mysql: PMYSQL; const db: pChar): longint; stdcall;
  mysql_query: function(_mysql: PMYSQL; const q: pChar): longint; stdcall;
  mysql_send_query: function(_mysql: PMYSQL; const q: pChar; length: longword): longint; stdcall;
  mysql_read_query_result: function(_mysql: PMYSQL): longint; stdcall;
  mysql_real_query: function(_mysql: PMYSQL; const q: pChar; length: longword): longint; stdcall;
  mysql_create_db: function(_mysql: PMYSQL; const DB: pChar): longint; stdcall;
  mysql_drop_db: function(_mysql: PMYSQL; const DB: pChar): longint; stdcall;
  mysql_shutdown: function(_mysql: PMYSQL): longint; stdcall;
  mysql_dump_debug_info: function(_mysql: PMYSQL): longint; stdcall;
  mysql_refresh: function(_mysql: PMYSQL; refresh_options: longword): longint; stdcall;
  mysql_kill: function(_mysql: PMYSQL; pid: longword): longint; stdcall;
  mysql_ping: function(_mysql: PMYSQL): longint; stdcall;
  mysql_stat: function(_mysql: PMYSQL): pChar; stdcall;
  mysql_get_server_info: function(_mysql: PMYSQL): pChar; stdcall;
  mysql_get_client_info: function: pChar; stdcall;
  mysql_get_host_info: function(_mysql: PMYSQL): pChar; stdcall;
  mysql_get_proto_info: function(_mysql: PMYSQL): longword; stdcall;
  mysql_list_dbs: function(_mysql: PMYSQL; const wild: pChar): PMYSQL_RES; stdcall;
  mysql_list_tables: function(_mysql: PMYSQL; const wild: pChar): PMYSQL_RES; stdcall;
  mysql_list_fields: function(_mysql: PMYSQL; const table, wild: pChar): PMYSQL_RES; stdcall;
  mysql_list_processes: function(_mysql: PMYSQL): PMYSQL_RES; stdcall;
  mysql_store_result: function(_mysql: PMYSQL): PMYSQL_RES; stdcall;
  mysql_use_result: function(_mysql: PMYSQL): PMYSQL_RES; stdcall;
  mysql_options: function(_mysql: PMYSQL; option: mysql_option; const arg: pChar): longint; stdcall;
  mysql_free_result: procedure(result: PMYSQL_RES); stdcall;
  mysql_data_seek: procedure(result: PMYSQL_RES; offset: my_ulonglong); stdcall;
  mysql_row_seek: function(result: PMYSQL_RES; offset: MYSQL_ROW_OFFSET): MYSQL_ROW_OFFSET; stdcall;
  mysql_field_seek: function(result: PMYSQL_RES; offset: MYSQL_FIELD_OFFSET): MYSQL_FIELD_OFFSET; stdcall;
  mysql_fetch_row: function(result: PMYSQL_RES): PMYSQL_ROW; stdcall;
  mysql_fetch_lengths: function(result: PMYSQL_RES): PMYSQL_LENGTHS; stdcall;
  mysql_fetch_field: function(result: PMYSQL_RES): PMYSQL_FIELD; stdcall;
  mysql_escape_string: function(_to: pChar; const from: pChar; from_length: longword): longword; stdcall;
  mysql_real_escape_string: function(_mysql: PMYSQL; _to: pChar; const from: pChar; length: longword): longword; stdcall;
  mysql_debug: procedure(const debug: pChar); stdcall;
  mysql_odbc_escape_string: function(_mysql: PMYSQL; _to: pChar; to_length: longword; const from: pChar; from_length: longword; param: pointer; extend_buffer: extend_buffer_func): pChar; stdcall;
  myodbc_remove_escape: procedure(_mysql: PMYSQL; name: pChar); stdcall;
  mysql_thread_safe: function: longword; stdcall;

function mysql_reload(_mysql: PMySQL): longint;

// Status codes for libmySQL.dll

const
  LIBMYSQL_UNDEFINED = 0;     // libmysql_load() has not yet been called
  LIBMYSQL_MISSING = 1;       // No suitable DLL could be located
  LIBMYSQL_INCOMPATIBLE = 2;  // A DLL was found but it is not compatible
  LIBMYSQL_READY = 3;         // The DLL was loaded successfully

var
  libmysql_handle: HMODULE = 0;
  libmysql_status: byte = LIBMYSQL_UNDEFINED;

function libmysql_load(name: pChar): byte;
procedure libmysql_free;

// -----------------------------------------------------------------------------------------------
IMPLEMENTATION
// -----------------------------------------------------------------------------------------------

function IS_PRI_KEY(n: longword): boolean;
begin
  Result := (n and PRI_KEY_FLAG) = PRI_KEY_FLAG;
end;

function IS_NOT_NULL(n: longword): boolean;
begin
  Result := (n and NOT_NULL_FLAG) = NOT_NULL_FLAG;
end;

function IS_BLOB(n: longword): boolean;
begin
  Result := (n and BLOB_FLAG) = BLOB_FLAG;
end;

function IS_NUM(t: longword): boolean;
begin
  Result := (t <= FIELD_TYPE_INT24) or (t = FIELD_TYPE_YEAR);
end;

function IS_NUM_FIELD(f: PMYSQL_FIELD): boolean;
begin
  Result := (f.flags and NUM_FLAG) = NUM_FLAG;
end;

function INTERNAL_NUM_FIELD(f: PMYSQL_FIELD): boolean;
begin
  Result := (((f._type <= FIELD_TYPE_INT24) and ((f._type <> FIELD_TYPE_TIMESTAMP) or (f.length = 14) or (f.length = 8))) or (f._type = FIELD_TYPE_YEAR));
end;

function mysql_reload(_mysql: PMYSQL): longint;
begin
  Result := mysql_refresh(_mysql, REFRESH_GRANT);
end;

function libmysql_load(name: pChar): byte;

  procedure assign_proc(var proc: FARPROC; name: pChar);
  begin
    proc := GetProcAddress(libmysql_handle, name);
    if proc = nil then libmysql_status := LIBMYSQL_INCOMPATIBLE;
  end;

begin
  libmysql_free;
  if name = nil then name := 'libmysql.dll';
  libmysql_handle := LoadLibrary(name);
  if libmysql_handle = 0 then libmysql_status := LIBMYSQL_MISSING
  else begin
    libmysql_status := LIBMYSQL_READY;
    assign_proc(@mysql_num_rows, 'mysql_num_rows');
    assign_proc(@mysql_num_fields, 'mysql_num_fields');
    assign_proc(@mysql_eof, 'mysql_eof');
    assign_proc(@mysql_fetch_field_direct, 'mysql_fetch_field_direct');
    assign_proc(@mysql_fetch_fields, 'mysql_fetch_fields');
    assign_proc(@mysql_row_tell, 'mysql_row_tell');
    assign_proc(@mysql_field_tell, 'mysql_field_tell');
    assign_proc(@mysql_field_count, 'mysql_field_count');
    assign_proc(@mysql_affected_rows, 'mysql_affected_rows');
    assign_proc(@mysql_insert_id, 'mysql_insert_id');
    assign_proc(@mysql_errno, 'mysql_errno');
    assign_proc(@mysql_error, 'mysql_error');
    assign_proc(@mysql_info, 'mysql_info');
    assign_proc(@mysql_thread_id, 'mysql_thread_id');
    assign_proc(@mysql_character_set_name, 'mysql_character_set_name');
    assign_proc(@mysql_init, 'mysql_init');
    {$IFDEF HAVE_OPENSSL}
    assign_proc(@mysql_ssl_set, 'mysql_ssl_set');
    assign_proc(@mysql_ssl_cipher, 'mysql_ssl_cipher');
    assign_proc(@mysql_ssl_clear, 'mysql_ssl_clear');
    {$ENDIF} // HAVE_OPENSSL
    assign_proc(@mysql_connect, 'mysql_connect');
    assign_proc(@mysql_change_user, 'mysql_change_user');
    assign_proc(@mysql_real_connect, 'mysql_real_connect');
    assign_proc(@mysql_close, 'mysql_close');
    assign_proc(@mysql_select_db, 'mysql_select_db');
    assign_proc(@mysql_query, 'mysql_query');
    assign_proc(@mysql_send_query, 'mysql_send_query');
    assign_proc(@mysql_read_query_result, 'mysql_read_query_result');
    assign_proc(@mysql_real_query, 'mysql_real_query');
    assign_proc(@mysql_create_db, 'mysql_create_db');
    assign_proc(@mysql_drop_db, 'mysql_drop_db');
    assign_proc(@mysql_shutdown, 'mysql_shutdown');
    assign_proc(@mysql_dump_debug_info, 'mysql_dump_debug_info');
    assign_proc(@mysql_refresh, 'mysql_refresh');
    assign_proc(@mysql_kill, 'mysql_kill');
    assign_proc(@mysql_ping, 'mysql_ping');
    assign_proc(@mysql_stat, 'mysql_stat');
    assign_proc(@mysql_get_server_info, 'mysql_get_server_info');
    assign_proc(@mysql_get_client_info, 'mysql_get_client_info');
    assign_proc(@mysql_get_host_info, 'mysql_get_host_info');
    assign_proc(@mysql_get_proto_info, 'mysql_get_proto_info');
    assign_proc(@mysql_list_dbs, 'mysql_list_dbs');
    assign_proc(@mysql_list_tables, 'mysql_list_tables');
    assign_proc(@mysql_list_fields, 'mysql_list_fields');
    assign_proc(@mysql_list_processes, 'mysql_list_processes');
    assign_proc(@mysql_store_result, 'mysql_store_result');
    assign_proc(@mysql_use_result, 'mysql_use_result');
    assign_proc(@mysql_options, 'mysql_options');
    assign_proc(@mysql_free_result, 'mysql_free_result');
    assign_proc(@mysql_data_seek, 'mysql_data_seek');
    assign_proc(@mysql_row_seek, 'mysql_row_seek');
    assign_proc(@mysql_field_seek, 'mysql_field_seek');
    assign_proc(@mysql_fetch_row, 'mysql_fetch_row');
    assign_proc(@mysql_fetch_lengths, 'mysql_fetch_lengths');
    assign_proc(@mysql_fetch_field, 'mysql_fetch_field');
    assign_proc(@mysql_escape_string, 'mysql_escape_string');
    assign_proc(@mysql_real_escape_string, 'mysql_real_escape_string');
    assign_proc(@mysql_debug, 'mysql_debug');
    assign_proc(@mysql_odbc_escape_string, 'mysql_odbc_escape_string');
    assign_proc(@myodbc_remove_escape, 'myodbc_remove_escape');
    assign_proc(@mysql_thread_safe, 'mysql_thread_safe');
  end;
  Result := libmysql_status;
end;

procedure libmysql_free;
begin
  if libmysql_handle <> 0 then FreeLibrary(libmysql_handle);
  libmysql_handle := 0;
  libmysql_status := LIBMYSQL_UNDEFINED;
end;

// -----------------------------------------------------------------------------------------------
INITIALIZATION
// -----------------------------------------------------------------------------------------------

begin
  {$IFNDEF DONT_LOAD_DLL}
  libmysql_load(nil);
  {$ENDIF} // DONT_LOAD_DLL
end;

// -----------------------------------------------------------------------------------------------
FINALIZATION
// -----------------------------------------------------------------------------------------------

begin
  libmysql_free;
end;

end. 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T17:50:57.110

[TMySQL5](http://www.torry.net/db/direct/mysql/MySQL5.zip)组件提供对 MySQL 最新生产服务器 MySQL server 5.0 的快速访问。它只需要 libmysql.dll、MySQL5.pas 和 mysql.pas（感谢 Matthias Fichtner 使 mysql.pas 可用）。

目前这个组件最多只支持 500 行和 10 个字段。但是，您可以在语句 Dataset: array[1..n, 1..m] 中更改此值以满足您的要求。

只有两种数据类型可用 String 和 Integer，但是，您可以使用标准数据转换函数转换数据。

*   功能齐全
*   来源：包括
*   包括Exe-Demo

好通过 Delphi 2006

[主页](http://tmysql5.blogspot.com/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-17T18:51:53.833

我一直使用[Zeoslib](http://sourceforge.net/projects/zeoslib)与 MySQL 进行通信。它使用 libmySQL.dll，我个人非常喜欢它。

尽管它不仅仅是包装 libmysql，它仍然非常轻量级。你甚至可以让它连接到 libmysqld，在你的应用程序中嵌入一个 mysql 引擎（无需连接到外部或本地 mysql 服务器）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-05T08:15:26.013

这是我为 HeidiSQL 开发的类似单元： [https](https://code.google.com/p/heidisql/source/browse/trunk/source/dbconnection.pas) ://code.google.com/p/heidisql/source/browse/trunk/source/dbconnection.pas 。

It supports nearly all MySQL releases, even detects some other flavors as MariaDB, TokuDB, Percona, InfiniDB and InfoBright. Also, it supports Microsoft SQL Server and PostgreSQL.

The unit mainly contains 2 classes called TDBConnection and TDBQuery, and for both one derived class for each supported RDBMS.

However, the downside is it has some few dependencies to other units within the HeidiSQL sources, which you will need to break.

# python - 是否有与 RubyFlow 相当的 Python 新闻网站？

> ID：453673
> 
> 赞同：6
> 
> 时间：2009-01-17T17:41:14.367
> 
> 标签：python

我真的很喜欢[RubyFlow](http://rubyflow.com)中用于 Ruby 相关主题的链接的格式和类型。是否有对应的 Python 处于活动状态？有一个[PythonFlow](http://pythonflow.com)，但我认为它已经死了。

我不太喜欢[http://planet.python.org/](http://planet.python.org/)，因为那里有很多非 Python 的东西，而且帖子的摘要很少。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T17:54:20.457

[http://www.reddit.com/r/Python](http://www.reddit.com/r/Python)是我最喜欢的 Python 新闻来源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T17:44:13.940

可能是[http://www.planetpython.org/](http://www.planetpython.org/)或[http://planet.python.org/](http://planet.python.org/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T17:54:29.253

[http://planetpython.org/](http://planetpython.org/)（非官方星球）通常比[http://planet.python.org/](http://planet.python.org/)（官方星球）好 - 我认为非官方星球的维护者在修剪提要和如果可用的话，订阅 Python 类别提要可能会更加小心（他们当然订阅了我博客上的 python 标签，而不是整个提要）。

# ado.net - DbConnection.GetSchema 集合名称列表？

> ID：453683
> 
> 赞同：11
> 
> 时间：2009-01-17T17:45:05.733
> 
> 标签：ado.net

当你调用 DbConnection.GetSchema 时，你给它一个你感兴趣的集合的字符串名称。我在任何地方都找不到集合列表。集合列表是不可变的还是因数据库类型（orcle、sql server 等）而异？

我有兴趣获取一些数据库类型（如 sql server 和 sqlite）中所有集合名称的列表。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T18:39:33.627

即使我正在与 Oracle、Sql Server 连接，我也使用 OleDbConnection ......然后我可以使用：

```
myOleDbConnection.GetOleDbSchemaTable(OleDbSchemGuid.Tables); 
```

OleDbSchemaGuid 的可能值：（
请注意，根据数据库的不同，其中一些可能会引发 NotSupported 异常：

```
OleDbSchemaGuid.Assertions;
OleDbSchemaGuid.Catalogs;
OleDbSchemaGuid.Character_Sets;
OleDbSchemaGuid.Check_Constraints;
OleDbSchemaGuid.Check_Constraints_By_Table;
OleDbSchemaGuid.Collations;
OleDbSchemaGuid.Column_Domain_Usage;
OleDbSchemaGuid.Column_Privileges;
OleDbSchemaGuid.Columns;
OleDbSchemaGuid.Constraint_Column_Usage;
OleDbSchemaGuid.Constraint_Table_Usage;
OleDbSchemaGuid.DbInfoKeywords;
OleDbSchemaGuid.DbInfoLiterals;
OleDbSchemaGuid.Foreign_Keys;
OleDbSchemaGuid.Indexes;
OleDbSchemaGuid.Key_Column_Usage;
OleDbSchemaGuid.Primary_Keys;
OleDbSchemaGuid.Procedure_Columns;
OleDbSchemaGuid.Procedure_Parameters;
OleDbSchemaGuid.Procedures;
OleDbSchemaGuid.Provider_Types;
OleDbSchemaGuid.Referential_Constraints;
OleDbSchemaGuid.SchemaGuids;
OleDbSchemaGuid.Schemata;
OleDbSchemaGuid.Sql_Languages;
OleDbSchemaGuid.Statistics;
OleDbSchemaGuid.Table_Constraints;
OleDbSchemaGuid.Table_Privileges;
OleDbSchemaGuid.Table_Statistics;
OleDbSchemaGuid.Tables;
OleDbSchemaGuid.Tables_Info;
OleDbSchemaGuid.Translations;
OleDbSchemaGuid.Trustee;
OleDbSchemaGuid.Usage_Privileges;
OleDbSchemaGuid.View_Column_Usage;
OleDbSchemaGuid.View_Table_Usage;
OleDbSchemaGuid.Views; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T19:32:05.737

该列表因提供商而异。出于这个原因，已经定义了一些[通用模式集合，无论提供者如何，它们始终可用。](http://msdn.microsoft.com/en-us/library/ms254501.aspx)其中之一是 MetaDataCollections 集合，它将返回一个 DataTable，其中包含当前提供程序支持的模式集合的列表、它们各自支持的限制数量以及它们使用的标识符部分的数量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T19:03:49.957

对于 System.Data.SQLite，我终于找到了支持的内容：

[http://sqlite.phxsoftware.com/readme.htm](http://sqlite.phxsoftware.com/readme.htm)

“DbConnection.GetSchema(...) 支持包括 ReservedWords、MetaDataCollections、DataSourceInformation、DataTypes、Columns、Tables、Views、ViewColumns、Catalogs、Indexes、IndexColumns、ForeignKeys 和 Triggers。”

我认为 sql server 会差不多，但我仍然没有明确的列表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-09T01:31:53.197

您正在谈论的列表称为[MetaDataCollection](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/common-schema-collections#metadatacollections)。如果您在没有任何参数的情况下调用[GetSchema()](https://docs.microsoft.com/en-us/dotnet/api/system.data.sqlclient.sqlconnection.getschema?view=netframework-4.7.1)，它将为您提供所有可以使用的集合名称的列表。

此外，所有数据库都有一个固定的集合名称列表[。](https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/common-schema-collections)一些 ADO.NET 提供程序也会添加特定于您正在连接的数据库的附加参数。

例如，ODP.NET 将添加名为 Users 的集合名称，它将为您提供 Oracle 数据库中可用的所有用户（模式）。

# java - 在 Java 中使用 Hashtable、Vector 或 HashMap 或 ArrayList

> ID：453684
> 
> 赞同：14
> 
> 时间：2009-01-17T17:45:37.150
> 
> 标签：java, vector

Java 开发强调的一个模因总是使用 ArrayList 而不是 Vector。向量已弃用。这可能是真的，但 Vector 和 Hashtable 的优点是它们是同步的。

我正在使用一个高度并发的应用程序，使用像 Vector 这样同步的对象不是有好处吗？似乎他们有自己的位置？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-17T17:52:30.193

Vector 和 Hashtable 的问题在于它们仅在本地同步。它们不会在并发应用程序中中断（如损坏数据），但是，由于本地同步（例如 get 已同步，但仅在 get 返回之前），您将希望在诸如此类的情况下执行自己的同步作为对内容的迭代。现在，即使你的 put-method 需要一些额外的同步来配合迭代同步，你最终会遇到 Hashtable/Vector 双重同步的情况。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-17T18:01:07.680

[ConcurrentHashMap](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)比Hashtable[快得多。](http://www.ibm.com/developerworks/java/library/j-jtp07233.html#N10244)它是**并发**的，而不仅仅是同步的。它一次承认多个读者/作者。

虽然没有这样的“并发”数组列表。根据您的需要，[CopyOnWriteArrayList](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/CopyOnWriteArrayList.html)可能是也可能不是您需要的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-17T17:53:46.120

如果您需要同步的 ArrayList 或 HashMap，您可以将它们包装起来。

```
List list = Collections.synchronizedList(new ArrayList(...));
Map m = Collections.synchronizedMap(new HashMap(...)); 
```

就我个人而言，我发现这些集合中的“同步”方法在繁重的线程代码中不是很有用。有一些更新的集合可以提供更多帮助，但大多数情况下我发现自己制作自己的同步对象并围绕它们进行同步，或者使用 java.util.concurrent 中的新锁

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-01-17T17:55:25.227

[`Vector`](http://java.sun.com/javase/6/docs/api/java/util/Vector.html)同步有它的位置，但这不是和之间的唯一区别[`ArrayList`](http://java.sun.com/javase/6/docs/api/java/util/ArrayList.html)。`Vector`每次超过其容量时，将其内部存储数组增长固定数量，同时将其`ArrayList`增长固定因子，这通常是一种更好的方法（因为它为追加项目提供了 O(1)的[摊销成本）。](http://en.wikipedia.org/wiki/Amortized_analysis)

另请注意，[`Collections.synchronizedList()`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#synchronizedList(java.util.List))可用于在任何`List`实现上创建同步视图，因此您不必绑定到的特性`Vector`（例如，您可能需要同步`LinkedList`）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-17T17:55:28.317

您可以使用静态 Collections 方法将 List 或 Map 转换为同步版本：http: [//java.sun.com/j2se/1.4.2/docs/api/java/util/Collections.html#synchronizedList (java.util 。列表）](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Collections.html#synchronizedList(java.util.List))

通常，您通常需要锁定的不仅仅是对列表或地图的单独调用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T17:58:42.100

在我看来，您需要 Collection 本身是线程安全的唯一时间是：

*   如果集合从类外部可见（公共或默认范围）
*   如果您要从方法返回集合的句柄
*   如果集合是您班级的静态成员

所有这些在设计方面可能都是一个坏主意。

更好的方法是将集合本身​​设为私有或受保护，并通过同步方法访问它。对于静态成员，如果您需要这样做，单例将是更好的选择。

# cocoa - 如何使用 NSDecimalNumber？

> ID：453691
> 
> 赞同：47
> 
> 时间：2009-01-17T17:50:34.723
> 
> 标签：cocoa, math

我正在构建一个需要对金钱进行计算的应用程序。

我想知道如何正确使用 NSDecimalNumber，尤其是如何从整数、浮点数和双精度数初始化它？

我只发现它很容易使用该`-decimalNumberWithString:`方法。不鼓励使用这些`-initWith...`方法，因此只留下带有尾数的方法，但我以前使用的 7 种语言中的任何一种都不需要，所以我不知道放在那里的是什么......

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-01-18T03:01:16.983

不要**使用**`NSNumber`'方法`+numberWith...`创建`NSDecimalNumber`对象。它们被声明为返回`NSNumber`对象，并且不保证作为`NSDecimalNumber`实例运行。

Apple 开发人员 Bill Bumgarner在此[线程中对此进行了解释。](http://www.cocoabuilder.com/archive/message/cocoa/2009/1/10/227253)我鼓励您针对这种行为提交一个错误，参考错误 rdar://6487304。

作为替代方案，这些是用于创建 的所有适当方法`NSDecimalNumber`：

```
+ (NSDecimalNumber *)decimalNumberWithMantissa:(unsigned long long)mantissa
                     exponent:(short)exponent isNegative:(BOOL)flag;
+ (NSDecimalNumber *)decimalNumberWithDecimal:(NSDecimal)dcm;
+ (NSDecimalNumber *)decimalNumberWithString:(NSString *)numberValue;
+ (NSDecimalNumber *)decimalNumberWithString:(NSString *)numberValue locale:(id)locale;

+ (NSDecimalNumber *)zero;
+ (NSDecimalNumber *)one;
+ (NSDecimalNumber *)minimumDecimalNumber;
+ (NSDecimalNumber *)maximumDecimalNumber;
+ (NSDecimalNumber *)notANumber; 
```

如果您只是想要一个`NSDecimalNumber`from a`float`或`int`常量，请尝试以下操作：

```
NSDecimalNumber *dn = [NSDecimalNumber decimalNumberWithDecimal:
                             [[NSNumber numberWithFloat:2.75f] decimalValue]; 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2011-03-14T22:05:47.663

正确的方法实际上是这样做的：

```
NSDecimalNumber *floatDecimal = [[[NSDecimalNumber alloc] initWithFloat:42.13f] autorelease];
NSDecimalNumber *doubleDecimal = [[[NSDecimalNumber alloc] initWithDouble:53.1234] autorelease];
NSDecimalNumber *intDecimal = [[[NSDecimalNumber alloc] initWithInt:53] autorelease];

NSLog(@"floatDecimal floatValue=%6.3f", [floatDecimal floatValue]);
NSLog(@"doubleDecimal doubleValue=%6.3f", [doubleDecimal doubleValue]); 
NSLog(@"intDecimal intValue=%d", [intDecimal intValue]); 
```

[在此处](http://juliuspaintings.co.uk/cgi-bin/paint_css/animatedPaint/057_NSNumber_NSDecimalNumber.pl)查看更多信息。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-19T16:20:35.707

在设计方面，您应该尽量避免将 NSDecimalNumber 或 NSDecimals 转换为 int、float 和 double 值，原因与建议您使用 NSDecimalNumbers 的原因相同：精度损失和二进制浮点表示问题。我知道，有时这是不可避免的（从滑块获取输入，进行三角计算等），但您应该尝试将用户的输入作为 NSStrings 获取，然后使用 initWithString:locale: 或 decimalNumberWithString:locale: 生成 NSDecimalNumbers。使用 NSDecimalNumbers 进行所有数学运算，并将它们的表示返回给用户，或者使用 descriptionWithLocale: 将它们作为字符串描述保存到 SQLite（或任何地方）。

如果您必须从 int、float 或 double 输入，您可以执行以下操作：

```
int myInt = 3;
NSDecimalNumber *newDecimal = [NSDecimalNumber decimalNumberWithString:[NSString stringWithFormat:@"%d", myInt]]; 
```

或者你可以按照 Ashley 的建议来确保你在十进制结构中是安全的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-12T14:20:34.557

一个小的补充：如果你`NSDecimalNumber`从一个字符串初始化，设置一个语言环境也可能很有用。例如，如果您的字符串包含逗号作为`decimal separator`.

```
self.order.amount = [NSDecimalNumber decimalNumberWithString:self.amountText locale:[NSLocale currentLocale]]; 
```

# c - 返回指向静态局部变量的指针是否安全？

> ID：453696
> 
> 赞同：52
> 
> 时间：2009-01-17T17:51:59.557
> 
> 标签：c, static

我正在使用一些广泛使用返回指向静态局部变量的指针的习惯用法的代码。例如：

```
char* const GetString()
{
  static char sTest[5];
  strcpy(sTest, "Test");
  return sTest;
} 
```

我认为这是安全的吗？

PS，我知道这将是做同样事情的更好方法：

```
char* const GetString()
{
  return "Test";
} 
```

**编辑：** 抱歉，函数签名当然应该是：

```
const char* GetString(); 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-01-17T18:10:41.250

**第一个例子：有点安全**

```
char* const GetString()
{
  static char sTest[5];
  strcpy(sTest, "Test");
  return sTest;
} 
```

尽管不推荐，但这是安全的，即使函数范围结束，静态变量的范围仍然有效。这个函数根本不是线程安全的。一个更好的函数会让你传递 a`char* buffer`和 a`maxsize`来`GetString()`填充函数。

特别是，此函数不被视为**可重入函数**，因为可重入函数不得~~将地址返回给静态（全局）非常量数据~~。请参阅[可重入函数](http://en.wikipedia.org/wiki/Reentrant_(subroutine))。

**第二个例子：完全不安全**

```
char* const GetString()
{
  return "Test";
} 
```

如果你做了一个`const char *`. 你给的东西不安全。原因是字符串文字可以存储在只读内存段中，并且允许修改它们会导致未定义的结果。

`char* const`(const pointer) 意味着您不能更改指针指向的地址。 `const char *`(pointer to const) 意味着你不能改变这个指针指向的元素。

**结论：**

您应该考虑：

1）如果您有权访问代码，则修改`GetString`以采用 a 的参数`char* buffer`来填充和`maxsize`使用 a 。

2) 如果您无权访问代码，但必须调用它，请将此方法包装在另一个受互斥锁保护的函数中。新方法如 1 所述。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-17T18:04:47.330

`static`变量（在函数中）就像作用域的全局变量。一般来说，应该避免使用它们（如全局变量，它们会导致重入问题），但有时很有用（一些标准库函数使用它们）。您可以返回指向全局变量的指针，因此也可以返回指向`static`变量的指针。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-17T18:12:48.283

这取决于您所说的安全是什么意思。我可以立即看到几个问题：

1.  您返回了一个`char * const`，这将允许调用者更改此位置的字符串。潜在的缓冲区溢出。或者你的意思是一个`const char *`？
2.  您可能会遇到重入问题或并发问题。

为了解释第二个，考虑一下：

```
const char * const format_error_message(int err)
{
    static char error_message[MAXLEN_ERROR_MESSAGE];
    sprintf(error_message, "Error %#x occurred", err);
    return error_message;
} 
```

如果你这样称呼它：

```
int a = do_something();
int b = do_something_else();

if (a != 0 && b != 0)
{
    fprintf(stderr,
        "do_something failed (%s) AND do_something_else failed (%s)\n",
        format_error_message(a), format_error_message(b));
} 
```

...要打印什么？

线程也一样。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-17T18:07:38.200

从根本上说，是的，从某种意义上说，它是安全的，因为它是静态的，所以价值将无限期地持续下去。

从某种意义上说，这是不安全的，因为您返回了一个指向变量数据的常量指针，而不是一个指向常量数据的变量指针。最好是不允许调用函数修改数据：

```
const char *GetString(void)
{
    static char sTest[5];
    strncpy(sTest, "Test", sizeof(sTest)-1);
    sTest[sizeof(sTest)-1] = '\0';
    return sTest;
} 
```

在所示的简单情况下，几乎没有必要担心缓冲区溢出，尽管我的代码版本确实担心，并确保空终止。另一种方法是使用[TR24731](https://stackoverflow.com/questions/372980/do-you-use-the-tr-24731-safe-functions-in-your-c-code)函数`strcpy_s`：

```
const char *GetString(void)
{
    static char sTest[5];
    strcpy_s(sTest, sizeof(sTest), "Test");
    return sTest;
} 
```

更重要的是，这两种变体都返回一个指向常量数据的（变量）指针，因此用户不应该去修改字符串和（可能）践踏数组范围之外。（正如@strager 在评论中指出的那样，返回 a`const char *`并不能保证用户不会尝试修改返回的数据。但是，他们必须将返回的指针转换为非常量，然后再修改数据；这会调用未定义的行为，此时一切皆有可能。）

字面返回的一个优点是不写承诺通常可以由编译器和操作系统强制执行。该字符串将被放置在程序的文本（代码）段中，如果用户试图修改返回值所指向的数据，操作系统将产生错误（Unix 上的段违规）。

[至少有一个其他答案指出该代码不可重入；那是对的。返回文字的版本是可重入的。如果重入很重要，则需要修复接口，以便调用者提供存储数据的空间。]

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-17T18:06:03.897

是的，它非常安全。局部静态变量的生命周期是整个程序在 C 中执行的生命周期。因此您可以返回一个指向它的指针，因为即使函数返回后数组仍然是活动的，并且返回的指针可以有效地取消引用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-15T09:47:28.683

它非常有用，因为您可以直接将该函数用作 printf 参数。但是，正如前面提到的，在单个调用中多次调用该函数会导致问题，因为该函数使用相同的存储并且调用它两次将覆盖返回的字符串。但我测试了这段代码，它似乎可以工作 - 你可以安全地调用一个函数，其中 givemestring 最多使用 MAX_CALLS 次，它会正常运行。

```
#define MAX_CALLS 3
#define MAX_LEN 30

char *givemestring(int num)
{
        static char buf[MAX_CALLS][MAX_LEN];
        static int rotate=0;

        rotate++;
        rotate%=sizeof(buf)/sizeof(buf[0]);

        sprintf(buf[rotate],"%d",num);
        return buf[rotate];

} 
```

唯一的问题是线程安全，但这可以通过线程局部变量来解决（gcc 的 __thread 关键字）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T18:05:38.717

是的，这经常用于返回某些查找的文本部分，即将某些错误编号转换为人类友好的字符串。

在以下情况下这样做是明智的：

```
fprintf(stderr, "Error was %s\n", my_string_to_error(error_code)); 
```

如果`my_string_to_error()`返回一个分配的字符串，你的程序会泄漏，因为这种函数的上述（非常）常见用法。

```
char const *foo_error(...)
{
    return "Mary Poppins";
} 
```

...也可以，但一些脑残的编译器可能希望你强制转换它。

以这种方式观看字符串，不要归还书 :)

# c++ - 继承还是组合：依赖“is-a”和“has-a”？

> ID：453738
> 
> 赞同：32
> 
> 时间：2009-01-17T18:08:45.437
> 
> 标签：c++, inheritance, oop

当我设计类并且必须在继承和组合之间进行选择时，我通常使用经验法则：如果关系是“is-a” - 使用继承，如果关系是“has-a” - 使用组合。

总是正确的吗？

谢谢你。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-01-17T20:48:01.370

不——“是一个”并不总是导致继承。一个被广泛引用的例子是正方形和长方形之间的关系。正方形是长方形，但是设计从 Rectangle 类继承 Square 类的代码会很糟糕。

[我的建议是使用Liskov Substitution Principle](https://en.wikipedia.org/wiki/Liskov_substitution_principle)来增强您的“是/具有”启发式。要检查继承关系是否符合里氏替换原则，请询问基类的客户是否可以在不知道它在操作子类的情况下对子类进行操作。当然，必须保留子类的所有属性。

在正方形/矩形的例子中，我们必须要问，矩形的客户端是否可以在不知道它是正方形的情况下对正方形进行操作。客户必须知道的只是它是在一个矩形上操作的。下面的函数演示了一个假设设置矩形宽度保持高度不变的客户端。

```
void g(Rectangle& r)
{
    r.SetWidth(5);
    r.SetHeight(4);
    assert(r.GetWidth() * r.GetHeight()) == 20);
} 
```

这个假设适用于矩形，但不适用于正方形。所以函数不能在正方形上运行，因此继承关系违反了里氏替换原则。

[其他示例](https://stackoverflow.com/q/56860/3681671)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-01-17T18:14:36.000

是和不是。

这条线可以模糊。OO 早期的一些非常糟糕的 OO 编程示例并没有帮助解决这个问题，例如：Manager is an Employee is an Person。

关于继承，您必须记住的是：继承破坏了封装。继承是一个实现细节。关于这个主题有各种各样的文章。

最简洁的总结方法是：

**更喜欢作曲。**

这并不意味着使用它来完全排除继承。它只是意味着继承是一个后备位置。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-17T20:22:31.110

> 如果关系是“is-a”——使用继承，如果关系是“has-a”——使用组合。总是正确的吗？

从某种意义上说，是的。但是你必须小心不要引入不必要的、人为的“is-a”关系。

例如，有人可能会认为ThickBorderedRectangle*是*-a Rectangle，乍一看似乎很合理，并决定使用继承。但是这种情况更好地描述为矩形*有一个*边框，它可能是也可能不是厚边框。在这种情况下，他会更喜欢作曲。

以同样的方式，人们可能认为ThickBorder*是一个*特殊的Border 并使用继承；但最好说边框*有*宽度，因此更喜欢构图。

在所有这些模棱两可的情况下，我的经验法则是*三思而后*行，并且正如其他人建议的那样，*更喜欢组合而不是继承*。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T18:25:15.823

我不认为它像“is-a”与“has-a”那么简单——正如 cletus 所说，这条线会变得非常模糊。仅仅作为指导方针，两个人并不总是会得出相同的结论。

也正如 cletus 所说，更喜欢组合而不是继承。在我看来，必须有充分的理由从基类派生——特别是，基类确实需要为继承而*设计*，并且确实需要为您想要应用的那种专业化而设计。

除此之外——这可能是一个不受欢迎的想法——它归结为品味和直觉。随着时间的推移，我认为优秀的开发人员会更好地了解继承何时有效，何时无效，但他们可能会发现很难清楚地表达出来。我知道*我*觉得很难，正如这个答案所表明的那样。也许我只是将困难投射到其他人身上:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-17T18:29:44.333

继承并不总是意味着存在“is-a”关系，而缺少继承并不总是意味着没有。

例子：

*   如果您使用受保护或私有继承，那么您将失去外部可替代性，也就是说，就您的层次结构之外的任何人而言，Derived 不是 Base 的一种。
*   如果您覆盖一个基本虚拟成员并更改从原始基本实现中引用该基本的人可观察到的行为，那么您实际上破坏了可替代性。即使您有一个公共继承层次结构 Derived is-not-a Base。
*   您的类有时可以在没有任何继承关系的情况下替代另一个。例如，如果您要为适当的 const 成员函数使用模板和相同的接口，那么椭圆恰好是完美圆形的“Ellipse const&”可以替代“Circle const&”。

我在这里想说的是，无论您是否使用继承，都需要大量思考和工作来维持两种类型之间的“is-a”可替代关系。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-17T18:11:19.347

~~不~~是的。如果关系是“has-a”，则使用组合。（*补充*：问题的原始版本对两者都说“使用继承” - 一个简单的错字，但更正将我回答的第一个单词从“否”更改为“是”。）

并且默认使用合成；仅在必要时使用继承（但不要犹豫使用它）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-17T18:32:56.837

人们常说继承是一种“is-a”关系，但这会给你带来麻烦。C++ 中的继承分为两个想法：代码重用和定义接口。

第一个说“我的班级就像其他班级一样。我将为它们之间的增量编写代码，并尽可能多地重用来自其他班级的其他实现。”

第二个依赖于抽象基类，是类承诺实现的方法列表。

第一个可能非常方便，但如果做得不好也会导致维护问题，因此有些人甚至会说你不应该这样做。大多数人强调第二个，将继承用于其他语言显式调用的接口。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-18T03:08:11.883

我认为约翰的想法是正确的。您将班级关系视为创建*模型*，这是他们开始教您 OOP 校长时试图让您做的事情。*真的，您最好根据代码架构*来查看事物的功能。也就是说，对于其他程序员（或您自己）来说，重用您的代码而不破坏它或不必查看实现以了解它的作用的最佳方式是什么。

我发现继承经常打破“黑匣子”的理想，所以如果信息隐藏很重要，它可能不是最好的方法。我越来越多地发现继承对于提供通用接口比在其他地方重用组件更好。

当然，每种情况都是独一无二的，没有正确的方法来做出这个决定，只有经验法则。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-17T18:43:07.393

我的经验法则（虽然不是具体的）是，如果我可以为不同的类使用相同的代码，那么我将把该代码放入父类并使用继承。否则我使用组合。

这使我可以编写更少的代码，而这些代码本质上更容易维护。

# ruby-on-rails - Cache-Money：仅在生产中使用？

> ID：453755
> 
> 赞同：1
> 
> 时间：2009-01-17T18:16:17.870
> 
> 标签：ruby-on-rails, memcached

我使用[cache-money](http://github.com/nkallen/cache-money) gem 来透明地使用 Memcached。使用提供的配置文件，它可以在所有模式（开发、测试、生产）上启用。有没有办法只在生产模式下激活缓存资金？

目前还不清楚如何做到这一点，而且在开发模式下处理缓存是一件非常痛苦的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T20:26:22.533

感谢[Obie Fernandez](http://obiefernandez.com/)提供的出色离线提示：存根 cache-money 的 #index 方法，什么都不做。这为模型中的#index 语句提供了一个位置，并停止了上述错误。

这是我完整的 cache_money.rb 库：

```
if RAILS_ENV != 'development'
  require 'cache_money'

  config = YAML.load(IO.read(File.join(RAILS_ROOT, "config", "memcached.yml")))[RAILS_ENV]
  $memcache = MemCache.new(config)
  $memcache.servers = config['servers']

  $local = Cash::Local.new($memcache)
  $lock = Cash::Lock.new($memcache)
  $cache = Cash::Transactional.new($local, $lock)

  class ActiveRecord::Base
    is_cached :repository => $cache
  end
else
  # If we're in development mode, we don't want to
  # deal with cacheing oddities, so let's overrite
  # cache-money's #index method to do nothing...
  class ActiveRecord::Base
    def self.index(*args)
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T20:15:57.073

通过在测试中关闭缓存钱，您无法知道它是否会干扰您的代码。

我这样做了：

```
require 'cache_money'
require 'memcache'

if RAILS_ENV == 'test'
  $memcache = Cash::Mock.new
else
  config = YAML.load(IO.read(File.join(RAILS_ROOT, "config", "memcached.yml")))[RAILS_ENV]
  $memcache = MemCache.new(config)
  $memcache.servers = config['servers']
end

$local = Cash::Local.new($memcache)
$lock = Cash::Lock.new($memcache)
$cache = Cash::Transactional.new($local, $lock)

class ActiveRecord::Base
  is_cached :repository => $cache
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T21:59:30.883

如果您在开发模式下运行，请在初始化程序中跳过初始化：

```
unless 'development' == RAILS_ENV
  require 'cache_money'
  .... 
```

# ruby-on-rails - 指责 Rails 有“魔法”公平吗？

> ID：453759
> 
> 赞同：6
> 
> 时间：2009-01-17T18:17:39.550
> 
> 标签：ruby-on-rails, django, black-box

当我第一次开始研究 Rails 和 Django 时，我被 Django 开发人员带离 Rails，他们认为 Rails 是一个使用过多“魔法”（泄漏抽象）的黑盒子。在进一步探索 Rails 时，我想知道这是否是基于不知道如何在不使用脚手架的情况下在 Rails 中实现自定义的不知情假设。脚手架本身似乎隐藏了很多东西，但是一旦您了解了如何在没有它的情况下创建项目，Rails 似乎与 Django 一样具有高度可定制性。这是我的误解还是 Rails 的“魔术”批评者的误解？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-17T18:21:52.477

Rails 广泛使用 Ruby 的元编程工具来为您完成大量繁重的工作，但这并没有什么神奇之处——最终它只是代码，只要有足够的时间和精力就可以理解。

脚手架始终旨在作为一种快速启动和运行模型的方式来执行 CRUD 操作。目的始终是应该用您的真实生产代码替换脚手架。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T18:57:39.907

我不会接受 Pythonista 对 Rails 的建议，就像我不会接受 Rubyist 对 Django 的意见一样，除非他们至少能证明对这两个平台有合理的理解水平，而且很少有人能做到。

这些框架（就我对 Django 方面的有限理解而言）具有相似的架构，但发展方式不同，并利用了不同语言的优势。

我同意 Rails 具有相当多的“魔力”，而且[约定优于配置](http://en.wikipedia.org/wiki/Convention_over_configuration)是框架的很大一部分。我可以看出这对 Python 专家来说可能是多么令人反感，这可能是公平的——Ruby 的相对优势之一是使魔法发生的元编程能力。也许正因为如此， Python 中的[猴子修补](https://stackoverflow.com/questions/5626193/what-is-monkey-patch)通常被视为可疑，而在 Ruby 中则很常见。没有更坏的东西，只是不同。

老实说，我认为您可以在任何一个平台上都玩得很开心。我建议您花两三天时间为每个应用构建一个简单的应用程序，然后选择您最喜欢的应用程序。我很想看看你选择的反馈和原因。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-18T03:36:27.740

你认为 Merb 是什么？这是 Rails 开发人员反抗 Rails 中过多的魔法的旗帜。

Rails 3 试图减少魔法，引入 Merb 的许多部分，并进行清理。

现在魔法真的太多了吗？也许吧，但请记住这一点。Rails 基本上是 DSL（领域特定语言）的集合，它们作为 Web 开发的框架组合在一起。这就是它如此干净的原因，它是一种用于路由、模板或 ORM 等的语言。要制作干净的 DSL，您必须扩展 Ruby，这需要一些魔法或元编程。

Django 不这样做，它不会是 Python 的方式。没有好坏之分，只有明显不同。

现在你问，Rails 中是否有太多的魔力？

记住[Arthur C Clark 的第三预测定律](http://en.wikipedia.org/wiki/Clarke%27s_three_laws)：任何足够先进的技术都与魔法无异。

所以也许你的那个开发者朋友只是说 Rails 技术太先进了，他们用起来不舒服。

对我来说，我可以阅读 Rails 的源代码并弄清楚发生了什么。当然它在某些地方很复杂，但我总是能够浏览源代码，阅读非常广泛的单元测试，并知道它是如何工作的。内核也非常复杂，但我们不会因为这些理由而拒绝使用它，不是吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-18T03:51:06.210

您可能会发现花一些时间阅读过去对这个问题的变体的答案很有用（例如，我在[这里](https://stackoverflow.com/questions/441717/whats-wrong-with-magic#442088)解释了我的看法）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-18T03:02:53.143

我不明白如何将导轨视为黑匣子。你有来源。一些红宝石有点棘手，元编程可能会使事情难以追踪，但一切都在那里供您查看。再加上脚手架的批评是没有意义的，除非他们谈论的是旧的脚手架，而不是生成的脚手架，后者只是创建了非常基本的代码模板，可以在那里看到。

我猜 djangoist 并非不知情，但他们确实意味着其他东西，比如 rails 使用了太多棘手的 ruby​​，并且通过猴子修补 ruby​​ 类来踩踏一些不应该的东西。这是一个可以成立的案例。

当然，他们真的不应该说坏话，因为我很确定 Django 在澳大利亚吃婴儿。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-18T11:31:32.053

我认为“公平”的概念在这里是错误的。这完全是口味问题。我很震惊 Rails Monkey 修补了 ruby​​ 的内置类型（导致像“5.days”这样的东西）。我认为这是魔术。一些 ruby​​ist 可能会认为它是可靠的工程。

我认为说 Rails 对您的语言运行时做了很多不明显的事情是客观的。如果您认为这是好是坏取决于您。

# ruby-on-rails - 尝试从 Rails 控制器调用辅助方法时出现 NoMethodError

> ID：453762
> 
> 赞同：75
> 
> 时间：2009-01-17T18:18:54.463
> 
> 标签：ruby-on-rails, ruby

`NoMethodError`当我尝试从我的一个控制器类访问我的一个助手模块中定义的方法时，我得到了一个。我的 Rails 应用程序使用带有如下符号的`helper`类方法：`:all`

```
class ApplicationController < ActionController::Base
  helper :all
  .
  .
end 
```

我的理解是，这应该使我的所有控制器类自动包含 app/helpers 目录中的所有帮助模块，因此将所有方法混合到控制器中。它是否正确？

如果我明确地`include`在控制器中使用辅助模块，那么一切正常。

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2010-12-02T19:51:17.737

要使用模板引擎中已经包含的辅助方法：

*   Rails 2：使用`@template`变量。
*   Rails 3：有很好的控制器方法[`view_context`](http://apidock.com/rails/AbstractController/Rendering/view_context)

在控制器方法中调用“number_to_currency”的示例用法：

```
# rails 3 sample
def controller_action
  @price = view_context.number_to_currency( 42.0 ) 
end

# rails 2 sample
def controller_action
  @price = @template.number_to_currency( 42.0 ) 
end 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-01-17T19:19:38.770

`helper :all`使视图中的所有助手（是的，所有助手）都可用，但不将它们包含在控制器中。

如果您希望在助手和控制器之间共享一些代码，这不是很理想，因为助手是 UI 代码而控制器是控制器代码，您可以将助手包含在控制器中，或者创建一个单独的模块并将其包含在控制器和助手也是如此。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2010-01-20T17:17:20.853

如果你需要在控制器和助手/视图之间共享一个方法，你可以通过控制器顶部的“helper_method”来定义：

```
class ApplicationController < ActionController::Base
  helper_method :my_shared_method
  ...

  def my_shared_method
    #do stuff
  end
end 
```

希望有帮助

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-01-26T22:08:09.863

## 来自控制器的辅助方法

获得帮助方法的一种方法是简单地包含您的帮助文件。

```
include LoginHelper
cool_login_helper_method(x,y,z) 
```

这会将来自该辅助模块的所有方法带入控制器的范围内。这并不总是一件好事。为了保持作用域分离，创建一个对象，赋予它帮助器的能力，并使用它来调用方法：

```
login_helper = Object.new.extend(LoginHelper)
login_helper.cool_login_helper_method(x,y,z) 
```

* * *

## 帮手：全部

`helper :all`使所有辅助模块中的所有辅助方法对所有**视图**都可用，但对控制器没有任何作用。这是因为辅助方法是为在视图中使用而设计的，通常不应从控制器中访问。 *在较新版本的 Rails 中，默认情况下每个控制器都启用此选项。*

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-10T18:03:49.527

对于 Rails 3，使用`view_context`控制器中的方法：

```
def foo
  view_context.helper_method
  ... 
```

这是一个例子： http: [//www.christopherirish.com/2011/10/13/no-view_context-in-rails-3-1-changes/](http://www.christopherirish.com/2011/10/13/no-view_context-in-rails-3-1-changes/)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-17T21:11:02.477

我发现这是最需要的时间是编写闪存或自定义错误检查器。在某些情况下，在 flash 消息中使用 link_to 助手之类的东西很好。我使用以下解决方案将 ActionView 助手放入控制器。请注意，如上所述，这打破了 MVC 分离，所以如果其他人有更好的主意，请告诉我！

在 ApplicationController 下面添加：

```
class Something
  include Singleton
  include ActionView::Helpers::UrlHelper
end 
```

并在 ApplicationController 内部，添加

```
def foo
  Something.instance
end 
```

最后，在您要访问帮助程序代码的控制器中：

```
messages << "<li class='error'>Your have an Error!<%= foo.link_to('Fix This', some_path) %></li>" 
```

希望在某种程度上有所帮助！

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2011-07-11T14:47:52.093

使用[helpers](http://api.rubyonrails.org/classes/ActionController/Helpers/ClassMethods.html#method-i-helpers)方法可能更干净：

```
class FooController < ActionController::Base
  def action
    self.class.helpers.helper_method arg
  end
end 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-05-06T16:54:14.103

可以使用控制器中的 @template 变量访问任何帮助程序。

> @template.my_super_helper

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-03-02T06:10:19.083

控制器无法自动访问辅助方法。我们必须将它们包含在应用控制器中。

模块 ApplicationHelper

```
 def hello_message
    "Hello World"
 end 
```

结尾

类 ApplicationController < ActionController::Base

```
 include ApplicationHelper

  def message
     hello_message
  end 
```

结尾

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-17T19:19:07.197

助手将与模板一起使用，即。视图，而不是在控制器中。这就是您无法访问该方法的原因。例如，如果您想在两个控制器之间共享一个方法，则必须在 ApplicationController 中定义它。helper :all 表示您在 app/helpers 目录中的任何帮助文件中定义的任何方法都可用于任何模板。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2010-06-02T13:02:28.873

有两种方法可以做到这一点：要么创建一个模块，要么使用@template 变量。查看更多详情 [http://www.shanison.com/?p=305](http://www.shanison.com/?p=305)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-03-03T10:32:07.400

如果您将 application_controller.rb 文件更改为此...

```
class ApplicationController < ActionController::Base
  protect_from_forgery with: :exception
  include SessionsHelper
end 
```

...然后所有助手都将可供所有控制器使用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-12-16T07:52:20.433

如果您的`app/helpers`文件夹中只有 ApplicationHelper，那么您必须使用`include ApplicationHelper`. 默认情况下，Rails 只加载与控制器同名的辅助模块。（例如，ArticlesController 将加载 ArticlesHelper）。如果您有许多模型（例如文章；帖子；类别），那么您必须在控制器中上传每个模型。[文档](http://api.rubyonrails.org/classes/ActionController/Helpers.html)

帮手

```
module PostsHelper
    def find_category(number)
        return 'kayak-#{number}'
    end
    def find_other_sport(number)
        "basketball" #specifying 'return' is optional in ruby
    end
end

module ApplicationHelper
    def check_this_sentence
        'hello world'
    end

end 
```

示例控制器

```
class ArticlesController < ApplicationController
    include ApplicationHelper
    include PostsHelper
    #...and so on...

  def show#rails 4.1.5
    #here I'm using the helper from PostsHelper to use in a Breadcrumb for the view
    add_breadcrumb find_other_sport(@articles.type_activite), articles_path, :title => "Back to the Index"
    #add_breadcrumb is from a gem ... 
    respond_with(@articles)
  end
end 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-06-04T20:06:00.870

`include SessionsHelper`请在 ApplicationController 中尝试

```
class ApplicationController < ActionController::Base
  include SessionsHelper
  ...
end 
```

# javascript - Arrays keys number and "number" are unexpectedly considered the same

> ID：453765
> 
> 赞同：4
> 
> 时间：2009-01-17T18:19:26.537
> 
> 标签：javascript, arrays, type-conversion

I have been playing with javascript arrays and I have run into, what I feel, are some inconsistencies, I hope someone can explain them for me.

Lets start with this:

```
 var myArray = [1, 2, 3, 4, 5];
document.write("Length: " + myArray.length + "<br />");
for( var i in myArray){
   document.write( "myArray[" + i + "] = " + myArray[i] + "<br />");
}
document.write(myArray.join(", ") + "<br /><br />"); 
```

```
Length: 5
myArray[0] = 1
myArray[1] = 2
myArray[2] = 3
myArray[3] = 4
myArray[4] = 5
1, 2, 3, 4, 5

```

There is nothing special about this code, but I understand that a javascript array is an object, so properities may be add to the array, the way these properities are added to an array seems inconsistent to me.

Before continuing, let me note how string values are to be converted to number values in javascript.

 ***   Nonempty string -> Numeric value of string or NaN* 
*   **Empty string -> 0** 

 *So since a javascript array is an object the following is legal:

```
 myArray["someThing"] = "someThing";
myArray[""] = "Empty String";
myArray["4"] = "four";

for( var i in myArray){
   document.write( "myArray[" + i + "] = " + myArray[i] + "<br />");
}
document.write(myArray.join(", ") + "<br /><br />"); 
```

```
Length: 5
myArray[0] = 1
myArray[1] = 2
myArray[2] = 3
myArray[3] = 4
myArray[4] = four
myArray[someThing] = someThing
myArray[] = Empty String
1, 2, 3, 4, four

```

The output is unexpected.

The non empty string "4" is converted into its numeric value when setting the property myArray["4"], this seems right. However the empty string "" is not converted into its numeric value, 0, it is treated as an empty string. Also the non empty string "something" is not converted to its numeric value, NaN, it is treated as a string. So which is it? is the statement inside myArray[] in numeric or string context?

Also, why are the two, non numeric, properities of myArray not included in myArray.length and myArray.join(", ")?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-17T18:24:36.497

The keys of a JavaScript array are actually strings. For details and an implementation of a map type for arbitrary keys, check [this answer](https://stackoverflow.com/questions/368280/javascript-hashmap-equivalent#383540).

* * *

To clarify and add to what Jason posted: JavaScript arrays are objects. Objects have properties. A property name is a string value. Therefore, array indices are converted to strings as well before anything more can happen. A property name P will be treated as an array index (ie the special array-magic will be invoked) if the following holds (ECMA-262, 15.4):

> ToString(ToUint32(P)) is equal to P and ToUint32(P) is not equal to 2^32 − 1

That numeric indices will be converted to strings (and not the other way around) can be easily verified:

```
var array = [];
array[1] = 'foo';
array['1'] = 'bar';
array['+1'] = 'baz';
document.writeln(array[1]); // outputs bar 
```

* * *

Also, its bad practice to iterate over an array's entries with a `for..in` loop - you might get unexpected results if someone messed with some prototypes (and it's not really fast, either). Use the standard `for(var i= 0; i < array.length; ++i)` instead.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T18:41:16.617

(edit: the following is not quite right)

The keys of a JavaScript *Object* are actually strings. A Javascript *Array* by itself has numeric indices. If you store something with an index that can be interpreted as a nonnegative integer, it will try to do so. If you store something with an index that is not a nonnegative integer (e.g. it's alphanumeric, negative, or a floating-point number with a fractional piece), it will fail on the array-index store, and default to the *Object* (which is Array's base class) store, which then converts the argument to a string and stores by string index -- but these stored properties are not seen by the Array class and therefore are not visible to its methods/properties (length, join, slice, splice, push, pop, etc).

edit: the above is not quite right (as Christopher's foo/bar/baz example shows). The actual storage indices according to the [ECMAscript spec](http://www.ecma-international.org/publications/standards/Ecma-262.htm) are, in fact, strings, but if they are valid array indices (nonnegative integers) then the Array object's `[[Put]]` method, which is special, makes those particular values visible to the Array's "array-ish" methods.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-18T11:10:26.667

This is an answer to [PhiLo's post](https://stackoverflow.com/questions/453765/javascript-arrays-and-type-conversion-inconsistencies#454344). His benchmark is flawed because he uses different property names for the object version: He should have used `i` as well and not `x`.

If done correctly, eg like this:

```
var start, end, count = 1000000;

var obj = {},
    array = [];

start = new Date;
for(var i = count; i--; )
    array[i] = i;
end = new Date;
document.writeln(Number(end) - Number(start));

start = new Date;
for(var i = count; i--; )
    obj[i] = i;
end = new Date;
document.writeln(Number(end) - Number(start)); 
```

You'll see that the times will be very close. In FF3.0.5, the array version is even consistently slower (in Opera, it's the other way around).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T00:05:20.737

I disagree with Christoph when he states "array indices are converted to strings".

First, I think it is implementation dependent... I suppose (good) implementers will optimize array access, there are some smart ways to do it.

Actually, I did a little test, and although it is as good as most micro-benchmarks (ie. not super-reliable), it is interesting:

```
result = ""
var x;

var trueArray = []
var startTime = new Date();
for (var i = 0; i < 100000; i++)
{
  x = "i" + i; // To do the same operations
  trueArray[i] = 1;
}
var endTime = new Date();
result += "With array: " + (endTime - startTime) + "\n";

var sArray = []
var startTime = new Date();
for (var i = 0; i < 100000; i++)
{
  x = "" + i;
  sArray[x] = 1;
}
var endTime = new Date();
result += "With s array: " + (endTime - startTime) + "\n";

var objArray = {}
var startTime = new Date();
for (var i = 0; i < 100000; i++)
{
  x = "i" + i;
  objArray[x] = 1;
}
var endTime = new Date();
result += "With object(i): " + (endTime - startTime) + "\n";

var sobjArray = {}
var startTime = new Date();
for (var i = 0; i < 100000; i++)
{
  x = "" + i;
  sobjArray[x] = 1;
}
var endTime = new Date();
result += "With s object: " + (endTime - startTime) + "\n";

var iobjArray = {}
var startTime = new Date();
for (var i = 0; i < 100000; i++)
{
  x = "" + i;
  iobjArray[i] = 1;
}
var endTime = new Date();
result += "With i object: " + (endTime - startTime) + "\n";

// Then display result 
```

On IE6, I get: With array: 1453 With object: 3547
On FF 3.0, I get: With array: 83 With object: 226
On Safari 3.1, I get: With array: 140 With object: 313
On Opera 9.26, for some reason I don't get the result, but if I reduce to the tenth of number of loops, I get: With array: 47 With object: 516
Actually, I let Opera run while I type this, and finally got the result: With array: 281 With object: 166063...

So arrays are optimized! Which is fortunate...
Christoph's demonstration didn't impress me. My conclusion would be more that strings that can be interpreted as numbers are treated as such, which go along with the quoted formula...

So my interpretation of your results is that the array is behaving like a fast array with numerical indices when feed with these (with perhaps a behavior of associative array on sparse values, ie. some isolated big indices), but as an object, it still has the normal handling of properties. But these properties aren't handled in the array part, hence the result you got with join().

[EDIT] I added some loops, following Christoph's idea.
On FF3, I get: With array: 92 With s array: 93 With object(i): 243 With s object: 194 With i object: 125 (perfs vary between runs, but are roughly consistent).

I am not super-convinced of this integer -> string -> integer round-trip, not even that ECMA requests this sequence. The way I read it is: is the property is a string and can be interpreted as integer, then it is treated as such.

Of course, the only sure way to know would be to look at an implementation...

I notice with interest that plain objects getting an integer property or a property that can be transformed to an integer are somehow optimized. Perhaps because lot of JS programmers used plain objects as arrays, so implementers judged interesting to optimize this case.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-18T00:40:04.053

Arrays, like everything else in JavaScript, are objects. Objects have been blessed with the *dot notation* to ease the burden on developers. Using your example

```
myArray["someThing"] = "someThing"; 
```

is the same as writing

```
myArray.someThing = "someThing"; 
```

In this case, you are adding a property onto the object instead of adding it into the array. The same goes with the empty string, although you cannot use the *dot notation* for an empty string...strange, huh?

In the case of "4", it can be coerced into an integer, and therefore is used as an index into the array.

# c++ - 如何在 C++ 中创建 Lua 表，并将其传递给 Lua 函数？

> ID：453769
> 
> 赞同：9
> 
> 时间：2009-01-17T18:22:05.360
> 
> 标签：c++, string, map, lua, lua-table

在 C++ 中，我有一个`map<string, string>`, 包含未知数量的条目。如何将它传递给 Lua 函数，以便 Lua 函数可以将数据用作表？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-19T22:32:58.997

如果你想要一个真正的 lua 表：

```
lua_newtable(L);
int top = lua_gettop(L);

for (std::map::iterator it = mymap.begin(); it != mymap.end(); ++it) {
    const char* key = it->first.c_str();
    const char* value = it->second.c_str();
    lua_pushlstring(L, key, it->first.size());
    lua_pushlstring(L, value, it->second.size());
    lua_settable(L, top);
} 
```

用适合您的地图的正确类型替换为..

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T18:43:30.780

几个选项...

1.  将地图复制到新的 Lua 表中，并传递 Lua 表。

2.  创建一个[代理表](http://www.lua.org/pil/13.4.html)，通过元表和元方法指导读取`__index`和`__newindex`写入

当然，（1）的缺点是所有的复制。

(2) 的缺点是`pairs()`不能在代理表上工作

[在 wiki](http://lua-users.org/wiki/GeneralizedPairsAndIpairs)和[这个邮件列表线程](http://lua-users.org/lists/lua-l/2007-02/msg00423.html)`pairs`中讨论了对 Lua 进行通用化的修复。预计[Lua 5.2](http://lua-users.org/wiki/LuaFiveTwo)会泛化`pairs`

# java - 如何：Java 侦听 C 线程捕获的事件

> ID：453776
> 
> 赞同：2
> 
> 时间：2009-01-17T18:27:57.067
> 
> 标签：java, c, multithreading, java-native-interface

我想创建一个 Java 程序来侦听和响应 C 中线程捕获的事件。
有人可以解释如何使用 JNI 实现这一点，或者指向在线教程吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-17T18:38:50.163

您可以让本机代码调用 Java 方法来接收事件。有几篇关于 JNI 的文章可以帮助您，例如[How to Call Java functions from C Using JNI](http://www.codeproject.com/KB/cpp/CJniJava.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-19T20:44:47.563

如果您想进行任何类型的 JNI 编程，则需要阅读JNI[规范。](http://java.sun.com/j2se/1.5.0/docs/guide/jni/spec/jniTOC.html)

从 C 调用 Java 代码有两种情况。在第一种情况下，Java 程序调用*本地*方法，将控制权传递给 C。C 函数接收一个指针作为其第一个参数，该`JNIEnv`指针是用于访问 JNI 的主句柄。从 Java 到 C 的典型调用如下所示：

```
jenv->CallStaticMethod(jenv, cls, ...); 
```

（请注意，在 C++ 中，调用是正确的方法，因此您不需要`jenv`作为第一个参数传递。）这相当简单；Java 调用 C 调用回 Java。

第二种情况稍微复杂一些，当您有需要对 Java 进行“自发”调用的 C 代码时必须使用第二种情况，即不是因为该代码首先从 Java 调用的结果。这通常是您有一个本机线程生成事件的情况（如您的情况）。然后，您需要使用称为**[Invocation API](http://java.sun.com/j2se/1.5.0/docs/guide/jni/spec/invocation.html#wp9502)**的 JNI 的一部分。此 API 分两步使用：首先您请求对要调用的 JVM 的引用（一些 JVM 实现支持同一进程中的多个 JVM），第二步是请求`JNIEnv`指针以便调用 JVM .

为了获得`JNIEnv`指向 JVM 的调用的指针，本机线程需要将自身“附加”到 JVM。这样做是为了让 JVM “感知”线程，并且在将线程附加到 JVM 之后，该线程可以被认为是任何其他 Java 线程（实际上，我不确定是否有任何实际差异）。如果您在调试器中检查 JVM 的线程，本机线程将显示为任何其他线程。请注意，您可以将本机线程标记为守护线程，因此当 JVM 退出时，该线程将被杀死。

但是请注意，在 Unix 信号处理程序中执行操作时需要采取[适当的预防措施。](http://users.evtek.fi/~tk/rtp/signals-programming.html#do_dont)我建议**不要**直接从信号处理程序调用 Java。

# c# - 使用 PreLoaded Sql Server Express 数据库发布 c# 应用程序的最佳方法是什么

> ID：453779
> 
> 赞同：2
> 
> 时间：2009-01-17T18:31:53.017
> 
> 标签：c#, .net, sql, sql-server, publish

我想将我的 C# 应用程序与 SQL Server Express 2005 和应用程序对应的数据库一起分发。安装 SQL Server Express 2005 后，我的示例数据库需要在安装时自动加载数据，而不仅仅是表结构。我怎样才能做到这一点。

有没有办法使用 Visual Studio Click Once 技术来做到这一点？我有VS 2008。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-21T20:42:39.610

有几种方法可以做到这一点 - 正如 JFV 所提到的，您可以发布 MDF/LDF 数据库并在安装后重新附加它。

[或者，您可以使用 Red-Gate 的SQL Packager](http://www.red-gate.com/products/SQL_Packager/index.htm)之类的东西将您的数据库创建脚本封装到 .NET 项目和/或独立的 EXE 中。

或者再一次，在 SQL Server Express 上，您可以简单地将 MDF 文件添加到目录并使用 ADO.NET 中的“附加本地数据库文件”机制连接到您的数据库文件。您的连接字符串看起来像：

> 服务器=.\SQLExpress; **AttachDbFilename=c:\mydbfile.mdf** ;Database=dbname;Trusted_Connection=Yes;

你的选择！:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-17T18:36:39.467

如果您可以运行创建表的 SQL 脚本，那么相同的脚本不能也插入行吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T19:13:12.373

如果每次安装的基本示例数据都相同，您可以包括一个分离的 MDF/LDF，并在安装时将其附加到新的 SQL Express 实例。或者您可以在安装后恢复数据库的 BAK 文件...？

让我知道这是否有帮助！
联合部队

# c# - 使用 C# 从字符串中删除 JavaScript 注释

> ID：453784
> 
> 赞同：3
> 
> 时间：2009-01-17T18:35:39.623
> 
> 标签：c#, javascript

我正在尝试从 C# 的刺痛中删除 javascript 注释 (`//`和`/**/`)。有没有人有它的正则表达式。我正在阅读 javascript 文件列表，然后将它们附加到字符串中，并尝试清理 javascript 代码并使其轻松加载。波纹管您会发现其中一个适用于`/* */`评论的正则表达式，但我也需要删除`//`评论：

```
content = System.Text.RegularExpressions.Regex.Replace(content,
    @"/\*[^/]*/", 
    string.Empty); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-18T01:16:59.987

您不能使用简单的正则表达式从 JS 中删除评论——至少不可靠。例如，想象一下，尝试处理以下内容：

```
alert('string\' // not-a-comment '); // comment /* not-a-nested-comment
alert('not-a-comment'); // comment */* still-a-comment
alert('not-a-comment'); /* alert('commented-out-code');
// still-a-comment */ alert('not-a-comment');
var re= /\/* not-a-comment */; //* comment
var e4x= <x>// not-a-comment</x>; 
```

你可以让你的正则表达式比现在更好地工作，方法是让它以'*/'而不是'/'结束，并在它周围加上一个或子句，将 // 的测试添加到换行符。但它永远不会是万无一失的，因为正则表达式无法解析 JavaScript 或 [X]HTML 等语言。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-17T18:42:41.950

如果您想缩小 Javascript 文件（“让加载更轻松”），为什么不试试[Douglas Crockford 的 JSMin](http://www.crockford.com/javascript/jsmin.html)呢？页面底部有指向 c# 实现的链接（[http://www.crockford.com/javascript/jsmin.cs](http://www.crockford.com/javascript/jsmin.cs)）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T18:44:50.167

Regex 的替代品可以是[.Net 的 YUI Compressor](http://www.codeplex.com/YUICompressor)，它可以让您删除注释并缩小 JavaScript 代码。

```
// Note: string javaScript == some javascript data loaded from some file, etc.
compressedJavaScript= JavaScriptCompressor.Compress(javaScript); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-09-26T14:28:26.140

```
content = Regex.Replace(content,
                        "/\\*.*?\\*/",
                        String.Empty,
                        RegexOptions.Compiled | RegexOptions.Singleline);
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-08-18T14:23:28.587

我推荐程序[stripcmt](http://www.bdc.cx/software/stripcmt/)：

> StripCmt 是一个用 C 语言编写的简单实用程序，用于从 C、C++ 和 Java 源文件中删除注释。在 Unix 文本处理程序的伟大传统中，它既可以用作 FIFO（先进先出）过滤器，也可以在命令行上接受参数。

简单而强大，完美地完成工作。

# asp.net - 删除 DetailsView 控件中的 [选定] 边框

> ID：453791
> 
> 赞同：2
> 
> 时间：2009-01-17T18:40:56.947
> 
> 标签：asp.net, css, stylesheet, detailsview

我有一个[DetailsView 控件](http://www.albaassoc.com/events/eventdetails.aspx?eventid=29)，其中包括构成地址的几行。理想情况下，我想将地址行与以下两行“合并” - 基本上删除它们之间的边界。

我猜我可以使用 asp:TemplateField 创建一个近似的解决方案（使用单行，但我们在 seconf（数据）单元格中换行），但我宁愿看看是否有任何其他方法与我之前的样式相同的行（使用 CssClass）。此外，这与其他任何事情一样都是一种学习练习。

我尝试给 Address2 BoundField 一个类并通过 CSS 删除底部和顶部边框，但它似乎不起作用。查看 HTML，它将类分配给单个单元格，而我认为我需要将此类应用于整行。我无法解决整行问题；我可以处理所有行，无论是列还是一个单元格。

有什么建议么？

代码片段：

HTML：

```
<h2 class="title">Event Details</h2>
    <div class="entry">
        <form id="frmEvents" runat="server">
            <asp:DetailsView ID="vwEventDetails" runat="server" CssClass="vwEventDetails" FieldHeaderStyle-CssClass="FieldCol" >
                <Fields>
                    <asp:BoundField HeaderText="Event" DataField="EventName" ReadOnly="true" SortExpression="EventName" />
                    <asp:BoundField HeaderText="Date &amp; Time" DataField="EventDate" ReadOnly="true" SortExpression="EventDate" />
                    <asp:BoundField HeaderText="Address" DataField="Address1" ReadOnly="true" SortExpression="Address1" />
                    <asp:BoundField HeaderText="" DataField="Address2" ReadOnly="true" SortExpression="Address2" ItemStyle-CssClass="noBorders" />
                    <asp:BoundField HeaderText="" DataField="Address3" ReadOnly="true" SortExpression="Address3" />
                    <asp:BoundField HeaderText="Town" DataField="Town" ReadOnly="true" SortExpression="Town" />
                    <asp:BoundField HeaderText="County" DataField="County" ReadOnly="true" SortExpression="County" />
                    <asp:BoundField HeaderText="Postcode" DataField="Postcode" ReadOnly="true" SortExpression="Postcode" />
                    <asp:BoundField HeaderText="Entry Fee" DataField="EventFee" ReadOnly="true" SortExpression="EntryFee" />
                    <asp:BoundField HeaderText="Sponsor" DataField="SponsorName" ReadOnly="true" SortExpression="Sponsor" />
                    <asp:BoundField HeaderText="Category" DataField="CategoryName" ReadOnly="true" SortExpression="Category" />
                    <asp:HyperLinkField HeaderText="" DataTextField="" Text="Make A Booking" DataNavigateUrlFields="EventID" DataNavigateUrlFormatString="bookevent.aspx?eventid={0}" />
                </Fields>
            </asp:DetailsView>
        </form>
    </div> 
```

CSS：

```
.vwEventDetails .FieldCol
{
    font-weight: bold;
    background-color: #99CCFF;
    width: 100px;
}

.vwEventDetails tr td
{
    padding: 0 2em;
}

.noBorders
{
    border-bottom-style:none;
    border-top-style:none;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T21:39:03.623

我会使用 2 种样式：

```
.noTopBorders { border-top: none; }
.noBottomBorders { border-bottom: none; } 
```

我将分配`noTopBorders`给“Address2”和“Address3”BoundFields的`HeaderStyle-CssClass`和属性。`ItemStyle-CssClass`

我将分配`noBottomBorders`给“Address1”和“Address2”绑定字段的`HeaderStyle-CssClass`和属性。`ItemStyle-CssClass`

# c++ - 找到素数最快的算法是什么？

> ID：453793
> 
> 赞同：212
> 
> 时间：2009-01-17T18:42:22.247
> 
> 标签：c++, algorithm, primes

哪个是使用 C++ 找出素数的最快算法？我已经使用了筛子的算法，但我仍然希望它更快！

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-01-17T18:45:25.783

[阿特金筛法的](http://en.wikipedia.org/wiki/Sieve_of_Atkin)一个非常快速的实现是[丹伯恩斯坦](http://cr.yp.to/primegen.html)的素数。这种筛子比[Eratosthenes](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)筛子更有效。他的页面有一些基准信息。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-01-17T18:48:13.797

如果它必须非常快，您可以包含一个素数列表：http:
[//www.bigprimes.net/archive/prime/](http://www.bigprimes.net/archive/prime/)

如果您只需要知道某个数字是否为质数，[维基百科上列出了各种质数测试](http://en.wikipedia.org/wiki/Primality_test)。它们可能是确定大数是否为素数的最快方法，尤其是因为它们可以告诉您一个数字是否*不是*素数。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2011-09-26T12:57:47.330

他，他我知道我是一个回答老问题的死灵法师，但我刚刚发现这个问题正在网上搜索实现有效素数测试的方法。

到目前为止，我认为最快的素数测试算法是强概率素数（SPRP）。我从 Nvidia CUDA 论坛引用：

> 数论中更实际的利基问题之一与素数的识别有关。给定 N，你如何有效地确定它是否是素数？这不仅仅是一个理论问题，它可能是代码中真正需要的问题，也许当您需要在特定范围内动态查找素数哈希表大小时。如果 N 大约是 2^30，你真的要进行 30000 次除法测试来搜索任何因素吗？明显不是。
> 
> 这个问题的常见实际解决方案是一个简单的测试，称为欧拉概率素数测试，以及一个更强大的泛化，称为强概率素数 (SPRP)。这是一个测试，对于一个整数 N 可以概率性地将其分类为素数或非素数，并且重复测试可以增加正确概率。测试本身的缓慢部分主要涉及计算类似于 A^(N-1) 模 N 的值。任何实现 RSA 公钥加密变体的人都使用过这个算法。它对于大整数（如 512 位）以及普通的 32 或 64 位整数都很有用。
> 
> 通过预先计算某些已知在 N 范围内总是成功的测试输入参数，可以将测试从概率拒绝变为确定的素数证明。不幸的是，这些“最知名的测试”的发现实际上是对一个巨大的 (实际上是无限的）域。1980 年，Carl Pomerance 创建了第一个有用测试列表（以他的 Quadratic Seive 算法对 RSA-129 进行分解而闻名）。后来 Jaeschke 在 1993 年显着改进了结果。2004 年，Zhang 和 Tang 改进了该理论和搜索域的限制。Greathouse 和 Livingstone 已经在网络上发布了迄今为止最现代的结果，网址为[http://math.crg4.com/primes.html](http://math.crg4.com/primes.html)，这是一个巨大搜索域的最佳结果。

请参阅此处了解更多信息： http: [//primes.utm.edu/prove/prove2_3.html](http://primes.utm.edu/prove/prove2_3.html)和[http://forums.nvidia.com/index.php?showtopic=70483](http://forums.nvidia.com/index.php?showtopic=70483)

如果您只需要一种方法来生成非常大的素数并且不关心生成所有小于整数 n 的素数，您可以使用 Lucas-Lehmer 测试来验证 Mersenne 素数。梅森素数的形式为 2^p -1。我认为 Lucas-Lehmer 检验是为梅森素数发现的最快算法。

如果你不仅想使用最快的算法，还想使用最快的硬件，尝试使用 Nvidia CUDA 来实现它，为 CUDA 编写一个内核并在 GPU 上运行它。

如果您发现足够大的素数，您甚至可以赚到一些钱，EFF 的奖金从 5 万美元到 25 万美元不等： [https ://www.eff.org/awards/coop](https://www.eff.org/awards/coop)

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-11-04T09:43:16.737

有一个 100% 的数学测试将检查一个数字`P`是素数还是合数，称为[AKS Primality Test](http://en.wikipedia.org/wiki/AKS_primality_test)。

概念很简单：给定一个数`P`，如果 的所有系数`(x-1)^P - (x^P-1)`都可以被 整除`P`，`P`则为素数，否则为合数。

例如，给定`P = 3`，将给出多项式：

```
 (x-1)^3 - (x^3 - 1)
 = x^3 + 3x^2 - 3x - 1 - (x^3 - 1)
 = 3x^2 - 3x 
```

并且系数都可以被 整除`3`，因此这个数是素数。

和示例 where `P = 4`，这不是一个素数将产生：

```
 (x-1)^4 - (x^4-1)
 = x^4 - 4x^3 + 6x^2 - 4x + 1 - (x^4 - 1)
 = -4x^3 + 6x^2 - 4x 
```

在这里我们可以看到系数`6`不能被 整除`4`，因此它不是素数。

多项式`(x-1)^P`将`P+1`项和可以使用组合找到。所以，这个测试将在`O(n)`运行时运行，所以我不知道这会有多大用处，因为你可以简单地`i`从 0 迭代到`p`并测试剩余部分。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-17T20:24:46.423

你的问题是决定一个特定的数字是否是素数吗？然后你需要一个素数测试（简单）。或者你需要给定数字的所有素数吗？在这种情况下，初筛很好（容易，但需要记忆）。或者你需要一个数字的质因数吗？这将需要分解（如果您真的想要最有效的方法，则很难处理大量数据）。您正在查看的数字有多大？16位？32位？大？

一种聪明而有效的方法是预先计算素数表并使用位级编码将它们保存在文件中。该文件被认为是一个长位向量，而位 n 表示整数 n。如果 n 是素数，则其位设置为 1，否则设置为 0。查找非常快（您计算字节偏移量和位掩码）并且不需要将文件加载到内存中。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-17T22:37:57.840

这取决于您的应用程序。有一些考虑：

*   您是否只需要一些数字是否为素数的信息，您是否需要所有素数达到一定限制，或者您是否需要（可能）所有素数？
*   您必须处理的数字有多大？

对于超过一定大小的数字（我相信大约几百万），米勒拉宾和模拟测试只比筛子快。在此之下，使用试除法（如果您只有几个数字）或筛子会更快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-17T21:01:27.333

[Rabin-Miller](http://en.wikipedia.org/wiki/Miller-Rabin_primality_test)是一种标准的概率素性检验。（你运行它 K 次，输入数字要么肯定是复合的，要么可能是素数，错误概率为 4 ^(-K)。（几百次迭代，它几乎肯定会告诉你真相）

Rabin Miller有一个非概率（确定性）[变体](http://en.wikipedia.org/wiki/Miller-Rabin_primality_test#Deterministic_variants_of_the_test)。

Great Internet Mersenne [Prime Search](http://mersenne.org/) (GIMPS) 发现了世界上最大的已证明素数记录（截至 2017 年 6 月为 2 ^(74,207,281) - 1 个），它使用[了多种算法](http://mersennewiki.org/index.php/Primality_test)，但这些是特殊形式的素数。然而，上面的 GIMPS 页面确实包含了一些通用的确定性素性测试。它们似乎表明哪种算法“最快”取决于要测试的数字的大小。如果您的数字适合 64 位，那么您可能不应该使用旨在处理数百万位素数的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-12T00:30:33.377

这是我一直在玩弄的 Python 中 Eratosthenes 筛的实现。

```
def eratosthenes(maximum: int) -> list[int | None]:
    """
    Find all the prime numbers between 2 and `maximum`.

    Args:
        maximum: The maximum number to check.

    Returns:
        A list of primes between 2 and `maximum`.
    """

    if maximum < 2:
        return []

    # Discard even numbers by default.
    sequence = dict.fromkeys(range(3, maximum+1, 2), True)

    for num, is_prime in sequence.items():
        # Already filtered, let's skip it.
        if not is_prime:
            continue

        # Avoid marking the same number twice.
        for num2 in range(num ** 2, maximum+1, num):
            # Here, `num2` might contain an even number - skip it.
            if num2 in sequence:
                sequence[num2] = False

    # Re-add 2 as prime and filter out the composite numbers.
    return [2] + [num for num, is_prime in sequence.items() if is_prime] 
```

在不起眼的三星 Galaxy A40 上，10000000 个数字的代码似乎需要大约 16 秒。

欢迎提出建议！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-18T17:08:03.170

我最近编写了这段代码来查找数字的总和。可以轻松修改它以查找数字是否为素数。基准在代码之上。

```
// built on core-i2 e8400
// Benchmark from PowerShell
// Measure-Command { ExeName.exe }
// Days              : 0
// Hours             : 0
// Minutes           : 0
// Seconds           : 23
// Milliseconds      : 516
// Ticks             : 235162598
// TotalDays         : 0.00027217893287037
// TotalHours        : 0.00653229438888889
// TotalMinutes      : 0.391937663333333
// TotalSeconds      : 23.5162598
// TotalMilliseconds : 23516.2598
// built with latest MSVC
// cl /EHsc /std:c++latest main.cpp /O2 /fp:fast /Qpar

#include <cmath>
#include <iostream>
#include <vector>

inline auto prime = [](std::uint64_t I, std::vector<std::uint64_t> &cache) -> std::uint64_t {
    std::uint64_t root{static_cast<std::uint64_t>(std::sqrtl(I))};
    for (std::size_t i{}; cache[i] <= root; ++i)
        if (I % cache[i] == 0)
            return 0;

    cache.push_back(I);
    return I;
};

inline auto prime_sum = [](std::uint64_t S) -> std::uint64_t {
    std::uint64_t R{5};
    std::vector<std::uint64_t> cache;
    cache.reserve(S / 16);
    cache.push_back(3);

    for (std::uint64_t I{5}; I <= S; I += 8)
    {
        std::uint64_t U{I % 3};
        if (U != 0)
            R += prime(I, cache);
        if (U != 1)
            R += prime(I + 2, cache);
        if (U != 2)
            R += prime(I + 4, cache);
        R += prime(I + 6, cache);
    }
    return R;
};

int main()
{
    std::cout << prime_sum(63210123);
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-05T07:49:14.713

我会让你决定它是否是最快的。

```
using System;
namespace PrimeNumbers
{

public static class Program
{
    static int primesCount = 0;

    public static void Main()
    {
        DateTime startingTime = DateTime.Now;

        RangePrime(1,1000000);   

        DateTime endingTime = DateTime.Now;

        TimeSpan span = endingTime - startingTime;

        Console.WriteLine("span = {0}", span.TotalSeconds);

    }

    public static void RangePrime(int start, int end)
    {
        for (int i = start; i != end+1; i++)
        {
            bool isPrime = IsPrime(i);
            if(isPrime)
            {
                primesCount++;
                Console.WriteLine("number = {0}", i);
            }
        }
        Console.WriteLine("primes count = {0}",primesCount);
    }

    public static bool IsPrime(int ToCheck)
    {

        if (ToCheck == 2) return true;
        if (ToCheck < 2) return false;

        if (IsOdd(ToCheck))
        {
            for (int i = 3; i <= (ToCheck / 3); i += 2)
            {
                if (ToCheck % i == 0) return false;
            }
            return true;
        }
        else return false; // even numbers(excluding 2) are composite
    }

    public static bool IsOdd(int ToCheck)
    {
        return ((ToCheck % 2 != 0) ? true : false);
    }
}
} 
```

在配备 2.40 GHz 处理器的 Core 2 Duo 笔记本电脑上，查找和打印 1 到 1,000,000 范围内的质数大约需要**82 秒。**它发现**了 78,498 个**素数。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-08-16T21:30:20.877

我发现这个解决方案非常快，但它带来了后果，所以这被称为**费马小定理**。如果我们取任何数字`p`并将其放入`(1^p)-1`or `(2^p)-2`...`(n^p)-n`同样，并且我们得到的数字可以被整除，`p`那么它就是质数。谈论后果，这不是 100% 正确的解决方案。有一些像`341`(not prime) 这样的数字会通过测试`(2^341)-2`但在 上失败`(3^341)-3`，所以它被称为合数。我们可以进行两项或多项检查，以确保他们通过所有检查。还有一种不是素数但也通过了所有测试用例的数字：（561、1729 *Ramanujan Taxi no*等。

> 好消息：`(2^p)-2`在前 250 亿个数字中，只有 2183 个失败了。

```
#include <iostream>
#include <math.h>
using namespace std;

int isPrime(int p)
{
    int tc = pow(2, p) - 2;
    if (tc % p == 0)
    {
        cout << p << "is Prime ";
    }
    else
    {
        cout << p << "is Not Prime";
    }
    return 0;
}

int main()
{
    int p;
    cin >> p;
    isPrime(p);
    return 0;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-08-20T15:55:21.557

我今天用 C 语言编写了它，用 tcc 编译，几年前在准备竞争性考试时发现。不知道有没有人已经写过。它真的很快（但你应该决定它是否很快）。在平均 32% 的 CPU 使用率的 i7 处理器上，花了一两分钟的时间在 10 到 1,00,00,000 之间找出大约 1,00,004 个素数。如您所知，只有最后一位数字为 1、3、7 或 9 的数字才能是素数，并且要检查该数字是否为素数，您必须将该数字除以先前找到的素数。所以首先取一组四个数字 = {1,3,7,9}，通过除以已知素数来测试它，如果提示非零则数字是素数，将其添加到素数数组。然后将 10 添加到组中，使其变为 {11,13,17,19} 并重复该过程。

```
#include <stdio.h>
int main() {    
    int nums[4]={1,3,7,9};
    int primes[100000];
    primes[0]=2;
    primes[1]=3;
    primes[2]=5;
    primes[3]=7;
    int found = 4;
    int got = 1;
    int m=0;
    int upto = 1000000;
    for(int i=0;i<upto;i++){
        //printf("iteration number: %d\n",i);
        for(int j=0;j<4;j++){
            m = nums[j]+10;
            //printf("m = %d\n",m);
            nums[j] = m;
            got = 1;
            for(int k=0;k<found;k++){
                //printf("testing with %d\n",primes[k]);
                if(m%primes[k]==0){
                    got = 0;
                    //printf("%d failed for %d\n",m,primes[k]);
                    break;
                }
            }
            if(got==1){
                //printf("got new prime: %d\n",m);
                primes[found]= m;
                found++;
            }
        }
    }
    printf("found total %d prime numbers between 1 and %d",found,upto*10);
    return 0;
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2021-01-01T12:43:41.130

寻找因素的解决方案：

```
def divisors(integer):
    result = set()
    i = 2
    j = integer/2
    while(i <= j):
        if integer % i == 0:
            result.add(i)
            #it dont need to 
            result.add(integer//i)
        i += 1
        j = integer//i
    if len(result) > 0:
        return f"not  prime {sorted(result)}"
    else:
        return f"{integer} is prime" 
```

--- 测试 ---- 导入时间

```
start_time = time.time()
print(divisors(180180180180))
print("--- %s seconds ---" % (time.time() - start_time)) 
```

--- 0.06314539909362793 秒 ---

```
start_time = time.time()
print(divs(180180180180180))
print("--- %s seconds ---" % (time.time() - start_time)) 
```

--- 1.5997519493103027 秒 ---

```
start_time = time.time()
print(divisors(1827))
print("--- %s seconds ---" % (time.time() - start_time)) 
```

--- 0.0 秒 ---

```
start_time = time.time()
print(divisors(104729))
print("--- %s seconds ---" % (time.time() - start_time)) 
```

--- 0.0 秒 ---

使用此代码：

```
def divs(integer):
    result = set()
    i = 2
    j = integer / 2
    loops = 0
    while (i <= j):
        if integer % i == 0:
            print(f"loops:{loops}")
            return f"{integer} is not a prime"
        i += 1
        j = integer // i
        loops += 1
    print(f"loops:{loops}")

    return f"{integer} is prime" 
```

--- 测试 ---

```
start_time = time.time()
print(divs(180180180180180180180180))
print("--- %s seconds ---" % (time.time() - start_time)) 
```

--- 0.0 秒 ---

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2015-08-01T11:37:25.190

我总是使用这种方法来计算使用筛算法的素数。

```
void primelist()
 {
   for(int i = 4; i < pr; i += 2) mark[ i ] = false;
   for(int i = 3; i < pr; i += 2) mark[ i ] = true; mark[ 2 ] = true;
   for(int i = 3, sq = sqrt( pr ); i < sq; i += 2)
       if(mark[ i ])
          for(int j = i << 1; j < pr; j += i) mark[ j ] = false;
  prime[ 0 ] = 2; ind = 1;
  for(int i = 3; i < pr; i += 2)
    if(mark[ i ]) ind++; printf("%d\n", ind);
 } 
```

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2011-11-16T17:49:04.950

```
#include<stdio.h>
main()
{
    long long unsigned x,y,b,z,e,r,c;
    scanf("%llu",&x);
    if(x<2)return 0;
    scanf("%llu",&y);
    if(y<x)return 0;
    if(x==2)printf("|2");
    if(x%2==0)x+=1;
    if(y%2==0)y-=1;
    for(b=x;b<=y;b+=2)
    {
        z=b;e=0;
        for(c=2;c*c<=z;c++)
        {
            if(z%c==0)e++;
            if(e>0)z=3;
        }
        if(e==0)
        {
            printf("|%llu",z);
            r+=1;
        }
    }
    printf("|\n%llu outputs...\n",r);
    scanf("%llu",&r);
} 
```

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2014-06-26T17:32:22.043

我知道有点晚了，但这可能对通过搜索到达这里的人有用。无论如何，这里有一些 JavaScript 依赖于只需要测试素数的事实，因此代码生成的早期素数被重新用作以后的测试因子。当然，首先过滤掉所有偶数和 mod 5 值。结果将在数组 P 中，并且此代码可以在 i7 PC 上在 1.5 秒内处理 1000 万个素数（或大约 20 秒内处理 1 亿个）。用C重写它应该非常快。

```
var P = [1, 2], j, k, l = 3

for (k = 3 ; k < 10000000 ; k += 2)
{
  loop: if (++l < 5)
  {
    for (j = 2 ; P[j] <= Math.sqrt(k) ; ++j)
      if (k % P[j] == 0) break loop

    P[P.length] = k
  }
  else l = 0
} 
```

* * *

## 回答 #17

> 赞同：-4
> 
> 时间：2012-02-29T16:57:32.853

```
#include <iostream>

using namespace std;

int set [1000000];

int main (){

    for (int i=0; i<1000000; i++){
        set [i] = 0;
    }
    int set_size= 1000;
    set [set_size];
    set [0] = 2;
    set [1] = 3;
    int Ps = 0;
    int last = 2;

    cout << 2 << " " << 3 << " ";

    for (int n=1; n<10000; n++){
        int t = 0;
        Ps = (n%2)+1+(3*n);
        for (int i=0; i==i; i++){
            if (set [i] == 0) break;
            if (Ps%set[i]==0){
                t=1;
                break;
            }
        }
        if (t==0){
            cout << Ps << " ";
            set [last] = Ps;
            last++;
        }
    }
    //cout << last << endl;

    cout << endl;

    system ("pause");
    return 0;
} 
```

* * *

## 回答 #18

> 赞同：-12
> 
> 时间：2012-03-11T17:05:52.830

```
#include<iostream>
using namespace std;

void main()
{
    int num,i,j,prime;
    cout<<"Enter the upper limit :";
    cin>>num;

    cout<<"Prime numbers till "<<num<<" are :2, ";

    for(i=3;i<=num;i++)
    {
        prime=1;
        for(j=2;j<i;j++)
        {
            if(i%j==0)
            {
                prime=0;
                break;
            }
        }

        if(prime==1)
            cout<<i<<", ";

    }
} 
```

# md5 - 对Wordlist中的所有单词进行MD5

> ID：453802
> 
> 赞同：0
> 
> 时间：2009-01-17T18:47:43.703
> 
> 标签：md5, rainbowtable

假设我们有一个单词列表

我想要的是将它们生成为 MD5 哈希。（有一个 30gb 的单词表，我想把它们全部变成 MD5）我不在乎哪种语言。

这说我在单词列表中有单词“测试”所以我想要这种格式：

```
test:098f6bcd4621d373cade4e832627b4f6 
```

098f6bcd4621d373cade4e832627b4f6 = 在 MD5 中测试

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T18:54:13.987

重击ftw！\o/

```
while read word; do
    echo -n $word | md5sum -1 | cut -f 1 -d " "
done < wordlist 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T19:05:14.010

在 MySql 中：（可能需要在 unix 平台上将“TERMINATED BY”设为 '\n'。）

```
create table words ( word varchar(255) , hash varchar(32) );
LOAD DATA LOCAL INFILE 'wordlist'
    INTO TABLE words LINES TERMINATED BY '\r\n' (word);
update words set hash=md5(word);
select * from words where word = 'test'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T19:00:31.273

在蟒蛇中：

```
import hashlib
word_list = ['test','word1','word2','third']
hash_dict = dict([(w,hashlib.md5(w).hexdigest()) for w in word_list])
for (k,v) in hash_dict.items(): print '%s:%s' % k,v 
```

额外的好处：hash_dict['word'] 会返回该单词的哈希值。

# python - PYTHONSTARTUP 似乎不起作用

> ID：453808
> 
> 赞同：7
> 
> 时间：2009-01-17T18:51:06.783
> 
> 标签：python, startup

我正在尝试使用 PYTHONSTARTUP 环境变量。我在“我的电脑”->“高级”等中将其设置为“c:\python25\pythonstartup.py”，但它似乎不起作用。

打开 IDLE 不会运行脚本，尽管它识别了变量：

```
>>> import os
>>> os.environ['PYTHONSTARTUP']
'c:\\python25\\pythonstartup.py'
>>> 
```

我正在使用 XP 和 Python 2.5.2。我还不想升级到 3.0。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-17T18:56:11.610

[文档](http://docs.python.org/using/cmdline.html)说 PYTHONSTARTUP 仅针对交互式会话运行。我不确定 IDLE 如何运行 Python 解释器，但它可能会产生干扰。

相反，请尝试`python`直接从命令提示符运行，而不是单击图标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T22:39:05.810

添加到 Greg Hewgill 的正确答案：如果 IDLE 没有自己的启动文件，您可以[`sitecustomize.py`](http://docs.python.org/dev/library/site.html)在路径中放置一个名为的文件，该文件将为命令提示符和脚本/IDLE 会话执行。

# c# - 使用 protobuf-net 的 C# 项目中的协议缓冲区 - 代码生成的最佳实践

> ID：453820
> 
> 赞同：16
> 
> 时间：2009-01-17T18:57:25.820
> 
> 标签：c#, visual-studio, protocol-buffers, protobuf-net

我正在尝试在 C# 项目中使用 protobuf，使用 protobuf-net，并且想知道将其组织到 Visual Studio 项目结构中的最佳方法是什么。

当手动使用 protogen 工具将代码生成到 C# 中时，生活似乎很轻松，但感觉并不正确。

我希望 .proto 文件被视为主要源代码文件，生成 C# 文件作为副产品，但在 C# 编译器参与之前。

选项似乎是：

1.  原型工具的自定义工具（虽然我看不到从哪里开始）
2.  预构建步骤（调用 protogen 或执行此操作的批处理文件）

我一直在上面的 2）中挣扎，因为它一直给我“系统找不到指定的文件”，除非我使用绝对路径（而且我不喜欢强制明确定位项目）。

是否有一个约定（还）？

* * *

***编辑：*** 根据@jon的评论，我重试了预构建步骤方法并使用了这个（protogen的位置现在硬编码），使用谷歌的地址簿示例：

```
c:\bin\protobuf\protogen "-i:$(ProjectDir)AddressBook.proto" 
       "-o:$(ProjectDir)AddressBook.cs" -t:c:\bin\protobuf\csharp.xslt 
```

* * *

***Edit2：*** 采纳@jon 的建议，通过不处理 .proto 文件（如果它们没有更改）来最小化构建时间，我已经拼凑了一个基本工具来检查我（这可能会扩展到一个完整的自定义构建工具):

```
using System;
using System.Diagnostics;
using System.IO;

namespace PreBuildChecker
{
    public class Checker
    {
        static int Main(string[] args)
        {
            try
            {
                Check(args);
                return 0;
            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
                return 1;
            }
        }

        public static void Check(string[] args)
        {
            if (args.Length < 3)
            {
                throw new ArgumentException(
                    "Command line must be supplied with source, target and command-line [plus options]");
            }

            string source = args[0];
            string target = args[1];
            string executable = args[2];
            string arguments = args.Length > 3 ? GetCommandLine(args) : null;

            FileInfo targetFileInfo = new FileInfo(target);
            FileInfo sourceFileInfo = new FileInfo(source);
            if (!sourceFileInfo.Exists) 
            {
                throw new ArgumentException(string.Format(
                    "Source file {0} not found", source));
            }

            if (!targetFileInfo.Exists || 
                sourceFileInfo.LastWriteTimeUtc > targetFileInfo.LastAccessTimeUtc)
            {
                Process process = new Process();
                process.StartInfo.FileName = executable;
                process.StartInfo.Arguments = arguments;
                process.StartInfo.ErrorDialog = true;

                Console.WriteLine(string.Format(
                     "Source newer than target, launching tool: {0} {1}",
                     executable,
                     arguments));
                process.Start();
            }
        }

        private static string GetCommandLine(string[] args)
        {
            string[] arguments = new string[args.Length - 3];
            Array.Copy(args, 3, arguments, 0, arguments.Length);
            return String.Join(" ", arguments);
        }
    }
} 
```

我的预构建命令现在是（全部在一行上）：

```
$(SolutionDir)PreBuildChecker\$(OutDir)PreBuildChecker 
    $(ProjectDir)AddressBook.proto 
    $(ProjectDir)AddressBook.cs 
    c:\bin\protobuf\protogen 
      "-i:$(ProjectDir)AddressBook.proto" 
      "-o:$(ProjectDir)AddressBook.cs" 
      -t:c:\bin\protobuf\csharp.xslt 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-17T19:06:34.320

调用预构建步骤但使用项目变量（例如`$(ProjectPath)`）来创建绝对文件名而不将它们实际包含在您的解决方案中对我来说似乎是一个合理的选择。

根据我过去对代码生成器的经验，您可能需要考虑一件事：您可能想为 protogen 编写一个包装器，它将代码生成到不同的位置，然后检查新生成的代码是否与旧代码相同，并且如果是这样，则不会覆盖它。这样，Visual Studio 将意识到没有任何改变，并且不会强制重建该项目 - 这在过去对我来说已经*大大缩短了构建时间。*

或者，您可以保留上次执行 protogen 时 .proto 文件的 md5 散列，并且仅在 .proto 文件发生更改时才执行 protogen - 每次构建时要做的更少！

不过，感谢您提出这个问题 - 它清楚地表明我应该想出一种方法，使这成为我自己的端口的简单预构建步骤。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-16T18:06:36.723

作为 Shaun 代码的扩展，我很高兴地宣布 protobuf-net 现在通过自定义工具集成了 Visual Studio。msi 安装程序可从[项目页面](http://code.google.com/p/protobuf-net/)获得。更完整的信息在这里：[protobuf-net；现在添加了 Orcas](http://marcgravell.blogspot.com/2009/07/protobuf-net-now-with-added-orcas.html)。

![使用 protobuf-net 作为自定义工具的 Visual Studio](https://lh6.ggpht.com/_feJtUp7IGuI/Sl7rs9FkdHI/AAAAAAAAAJY/zoDaMfuthIw/proto-vs_thumb%5B1%5D.png?imgmax=800)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-13T08:52:12.963

将以下预构建事件添加到您的项目设置中，以仅在 .proto 文件发生更改时生成 C# 文件。只需替换`YourFile`为 .proto 文件的基本名称即可。

```
cd $(ProjectDir) && powershell -Command if (!(Test-Path YourFile.proto.cs) -or (Get-Item YourFile.proto).LastWriteTimeUtc -gt (Get-Item YourFile.proto.cs).LastWriteTimeUtc) { PathToProtoGen\protogen -i:YourFile.proto -o:YourFile.proto.cs } 
```

[根据问题338](https://code.google.com/p/protobuf-net/issues/detail?id=338)和[413](https://code.google.com/p/protobuf-net/issues/detail?id=413)，这适用于任何最新版本的 Visual Studio，与不支持 Visual Studio 2012 或 Visual Studio 2013 的 protobuf-net Custom-Build 工具不同。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-09-17T19:50:48.227

将此添加到相关的项目文件中。

优势，增量构建。

缺点是添加文件时需要手动编辑。

```
<ItemGroup>
    <Proto Include="Person.proto" />
    <Compile Include="Person.cs">
        <DependentUpon>Person.proto</DependentUpon>
    </Compile>
</ItemGroup>
<PropertyGroup>
    <CompileDependsOn>ProtobufGenerate;$(CompileDependsOn)</CompileDependsOn>
</PropertyGroup>
<Target Name="ProtobufGenerate" Inputs="@(Proto)" Outputs="@(Proto->'$(ProjectDir)%(Filename).cs')">
    <ItemGroup>
        <_protoc Include="..\packages\Google.Protobuf.*\tools\protoc.exe" />
    </ItemGroup>
    <Error Condition="!Exists(@(_protoc))" Text="Could not find protoc.exe" />
    <Exec Command="&quot;@(_protoc)&quot; &quot;--csharp_out=$(ProjectDir.TrimEnd('\'))&quot; @(Proto->'%(Identity)',' ')" WorkingDirectory="$(ProjectDir)" />
</Target> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-22T00:44:05.607

好吧，这给了我一个想法（关于重新发明轮子的想法）......

*   创建简单的 Makefile.mak，类似于

```
.SUFFIXES : .cs .proto

.proto.cs：
    protogen\protogen.exe -i:$? -o:$@ -t:protogen\csharp.xlst

```

（显然，不要忘记替换 protogen 和 csharp.xlst 的路径）。**重要 - protogen\protogen.exe 命令从 TAB 字符开始，而不是 8 个空格**

*   如果您不想一直指定需要构建的文件，您可以使用类似

```
.SUFFIXES : .cs .proto

全部：mycs1.cs myotherfile.cs

.proto.cs：
    protogen\protogen.exe -i:$? -o:$@ -t:protogen\csharp.xlst

```

*   在预构建步骤中添加

```
cd $(ProjectDir) && "$(DevEnvDir)..\..\vc\bin\nmake" /NOLOGO -c -f Makefile.mak mycs1.cs myotherfile.cs
```

或者，如果您的路径中有 nmake，则可以使用

```
cd $(ProjectDir) && nmake /NOLOGO -c -f Makefile.mak mycs1.cs myotherfile.cs
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-24T18:02:25.807

我已将 ProtoGen.exe 周围的快速而肮脏的 Visual Studio 自定义工具包装器附加到此问题的 Google 代码页面（[http://code.google.com/p/protobuf-net/issues/detail?id=39](http://code.google.com/p/protobuf-net/issues/detail?id=39)）。这使得将 .proto 文件添加到 C# 项目非常容易。

有关详细信息，请参阅附件中的自述文件。

# c# - 使用 gtk# 在 ac# 程序中嵌入应用程序#

> ID：453830
> 
> 赞同：1
> 
> 时间：2009-01-17T19:05:36.367
> 
> 标签：c#, gtk, embed, gtk#

我想使用 GTK# 绑定将 VLC 之类的电影观看应用程序嵌入到我的 C# 程序中。

谷歌搜索，我没有看到很多人们声称简单或有效的解决方案。

经验？帮助？

请！

谢谢，jbu

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T04:10:02.413

我不确定 VLC 但[Banshee](http://banshee-project.org/)是一个 C# GTK+ 多媒体应用程序，它使用[GStreamer](http://gstreamer.freedesktop.org/)在其界面中嵌入视频。也许他们的代码可以帮助你。

GStreamer 是跨平台的，并且有许多适用于大多数视频格式的插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T16:04:02.860

为什么需要使用 GTK#？（这可能与 Mono 有关，如果是这样，我很抱歉，我对 Mono 一无所知）。

如果你有一个 C# 应用程序，你可以使用 VLC 包装器之一将 VLC 嵌入其中。搜索 VideoLan 论坛。例如，这个[线程](http://forum.videolan.org/viewtopic.php?f=32&t=52021&start=15)。我自己一直在我的 C# 应用程序中使用马克思包装器。效果很好。

# c# - 参数化查询（C#、Oracle）：如何生成更易读的表示？

> ID：453849
> 
> 赞同：3
> 
> 时间：2009-01-17T19:20:06.040
> 
> 标签：c#, sql, oracle, parameterized

我在我的 C# 代码中使用参数化查询与 Oracle 数据库进行交互。我该怎么做才能以更易读的方式记录语句？

假设我有一个参数化查询，例如：

```
INSERT INTO PERSON (ID, NAME, BIRTHDATE) VALUES (:id, :name, :birthdate) 
```

理想情况下，我希望看到替换所有参数的日志条目，以便我可以复制并粘贴语句以供以后使用：

```
INSERT INTO PERSON (ID, NAME, BIRTHDATE) VALUES (23, ‘Mike’, TO_DATE('2003/07/09', 'yyyy/mm/dd') 
```

我目前的方法是打印出参数化查询的字符串，然后遍历所有参数并使用 ToString()。如果有很多参数，这有点难以阅读。它会产生类似的东西：

```
INSERT INTO PERSON (ID, NAME, BIRTHDATE) VALUES (:id, :name, :birthdate) [:id=23, :name=Mike, birthdate=2004/07/09 00:00:00] 
```

我计划的另一种方法是使用 string.Replace() 函数来替换参数占位符。但也许有更好的方法来做到这一点？

提前致谢。

**编辑1：**

我想最好提供一些代码示例。

我以这种形式使用参数化查询（注意：我使用的是 log4net）：

```
 using (OracleConnection connection = new OracleConnection(connectionString))
        using (OracleCommand command = new OracleCommand(statement, connection))
        {
            command.Parameters.AddWithValue(":id", id);
            command.Parameters.AddWithValue(":name", name);
            command.Parameters.AddWithValue(":birthdate", birthdate);
            command.Connection.Open();
            log.DebugFormat("Executing statement: {0}.", command.CommandText);
            // there I would add some more code to iterate over
            // the parameters and print them out
            command.ExecuteNonQuery();
            command.Connection.Close();
        } 
```

我正在寻找一种方法来注销 oracle 命令对象正在使用的语句。我目前的方法（见问题）还不是很令人满意，因为不是很可读。

我希望有一些 API（甚至可能在 OracleClient 命名空间中）有助于为我解析参数化查询。我可以做一些更复杂的字符串替换或正则表达式，但我想收集一些知识。我已经对其进行了一些研究，但没有找到任何东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-19T23:51:11.710

也许值得看看它在 NHibernate[源代码](https://nhibernate.svn.sourceforge.net/svnroot/nhibernate/trunk/nhibernate/src/NHibernate/AdoNet/AbstractBatcher.cs)中的完成方式。

找到名为“GetCommandLogString（IDbCommand command）”的函数，您几乎可以复制/粘贴它：p

```
protected string GetCommandLogString(IDbCommand command)
{
    string outputText;

    if (command.Parameters.Count == 0)
    {
        outputText = command.CommandText;
    }
    else
    {
        StringBuilder output = new StringBuilder();
        output.Append(command.CommandText);
        output.Append("; ");

        IDataParameter p;
        int count = command.Parameters.Count;
        for (int i = 0; i < count; i++)
        {
            p = (IDataParameter) command.Parameters[i];
            output.Append(string.Format("{0} = '{1}'", p.ParameterName, p.Value));

            if (i + 1 < count)
            {
                output.Append(", ");
            }
        }
        outputText = output.ToString();
    }
    return outputText;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T19:38:46.113

尝试将其存储为可运行语句以供以后使用的问题在于参数版本与硬编码字符串版本的运行方式不同，因为前者不需要内联类型转换，例如您不必加上引号围绕字符串参数等。您需要根据每个参数的类型手动执行此操作。

我不知道您的日志格式是什么，但您最好将 SQL 写入日志以运行参数化查询；即，声明必要的变量并赋值，然后运行查询。它将产生更多行（或更长的行，如果您避免换行符），但是您可以按原样运行代码，您不必担心自己替换参数。另外，您的日志条目可以抵抗 SQL 注入 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-18T10:25:25.510

好吧，使用替换功能。为什么不？或者你可以使用 string.format()。或正则表达式。或组合。你想要的只是字符串操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-29T09:40:38.513

你可以这样使用：

```
INSERT INTO PERSON (ID, NAME, BIRTHDATE)
   VALUES ('"+id+"', '"+name+"', '"+birthdate+"') 
```

# performance - 如何调整应用程序服务器中的缓存

> ID：453851
> 
> 赞同：4
> 
> 时间：2009-01-17T19:20:38.003
> 
> 标签：performance, language-agnostic, caching

我们的客户在每台应用服务器上都有数百个项目。

每个项目都有自己的元数据描述符（内存约 1MB，从数据库加载约 1 秒）。元数据用于在各个方面（权限、有效字段、字段值等）验证对服务器的每个请求。我们严重依赖此元数据。

为了节省查询数据库的时间，我们决定实现缓存机制（使用 EHCache）来存储项目的元数据。我们想正确调整缓存。

我想知道，调整缓存属性（总大小、对象数量、疏散策略......）的技术是什么

例如，是否应该释放一段时间未访问的对象以节省内存？如何选择驱逐策略（如LRU、MRU）？

我们确实有经验丰富的负载测试团队和来自客户的大量数据（项目数量、平均元数据大小等），因此构建负载测试环境应该不是问题。我只是不确定我到底应该寻找什么？

请分享您的缓存调整经验。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-20T21:41:31.707

缓存的关键统计数据非常简单……缓存未命中率。您想计算某人向缓存请求某物的次数，以及“某物”尚未在缓存中的次数，后者除以前者就是您的未命中率。

差不多就是这样。为您的应用程序找到一种可靠的方法来衡量它，而其他一切都只是运行测试。每次调整时，在实际情况下进行负载测试以检查未命中率的变化。可用参数过于依赖于您的问题的具体情况。

我通常会从 LRU 开始，增加大小，直到我开始看到未命中率的回报递减，然后尝试相同大小的 LFU 以查看它的比较情况。当然，除非您碰巧确定您的案例对 LRU 来说是病态的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T21:32:20.447

最佳驱逐策略可能很大程度上取决于具体数据及其使用方式。

以下是几个通用示例：

新闻内容 - 每天都会添加文章并且很少修改 - 缓存用于减少对数据库服务器的需求。驱逐策略应该针对多次读取但几乎没有写入进行定制。

论坛主题（可能不是最好的例子） - 驱逐策略应该针对多次读取进行调整，但也应该针对频繁写入进行调整。

虽然新闻内容可能最优化地配置有最近最少使用 (LRU) 驱逐策略，但本示例中的论坛线程可能更优化地配置有最近最少使用 (LFU) 驱逐策略。当添加新消息时，无论如何都需要经常更换论坛线程的缓存，但是，LFU 策略会将最活跃的线程保留在缓存中。

# webserver - How do web servers work?

> ID：453855
> 
> 赞同：16
> 
> 时间：2009-01-17T19:21:58.283
> 
> 标签：webserver

I am a .NET developer and I've been working in C# for almost 3.5 yrs. I want to understand how the web server works and I don't mean a 65,000 feet overview. I want to understand the inner workings of a web server.

What are some good resources to learn the nuts and bolts of how a web server works?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-17T19:31:45.487

If you really want the nuts and bolts of how a web server is *supposed* to work read the [HTTP Spec](http://www.w3.org/Protocols/rfc2616/rfc2616.html).

A good tool would be be [fiddler](http://www.fiddlertool.com/Fiddler2/version.asp). Using this tool browser about the net and examine the conversation between the browser and the servers. Combined with a reading of the HTTP spec this will give you some good insight into what is really going on on the net.

If you want to go further you need to decide which web server you spcecifically want to understand better. For example, if you want to understand IIS6/7 then [David Wang's](http://blogs.msdn.com/david.wang/) blog is a good place to search for under-the-hood details.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-17T19:30:09.157

Web servers are very simple to implement, and there are several tutorials on how to build one.

Here is such a tutorial for C#: [http://www.codeguru.com/csharp/.net/net_general/article.php/c4603](http://www.codeguru.com/csharp/.net/net_general/article.php/c4603), this tutorial is nice because it implements the server down to raw sockets and HTTP header passing, so you learn a lot about the HTTP Spec. Unfortunatly, some tutorials and libraries abstract this away.

Implementing on yourself allow you to touch many topics:

*   Socket programming
*   HTTP Protocol (GET / POST)
*   Multi-threading

And once you get a basic webserver built you can extend your server and protocol into your own web-framework. should make a really cool pet-project.

I have done just this for Java, C++, and Python.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-03T19:18:49.097

I just happened on this question while looking for something else, but if you want to understand a web server I've recently started on a se of blog entries going though a custom built, open source web server.

It won't teach you exactly how IIS works, but the basic communication would be the same and, hence, is a good start. Here are the links for you to check out, including the link to the open source project:

*   [tOSU-WebServer](http://theopensourceu.com/tosu-webserver/)
*   [Presenting tOSU Web Server - An open source web Server](http://theopensourceu.com/2010/03/presenting-tosu-web-server-an-open-source-web-server/)
*   [Process and Threats (and the tOSU Web Server)](http://theopensourceu.com/2010/04/processes-and-threads/)
*   [BitBucket based Project with source code](http://bitbucket.org/frankv01/tosu-webserver/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T19:39:32.070

[IIS](http://www.iis.net/) and [Apache](http://httpd.apache.org/) are likely the two most common Web server implementations though I'm not sure what you are really looking for here. Are you wanting to know how each runs, how to customize it, or how to roll your own?

# sql - SQL Server 日志文件混淆

> ID：453858
> 
> 赞同：4
> 
> 时间：2009-01-17T19:22:47.533
> 
> 标签：sql, sql-server, flush

我正在寻找有关 SQL Server 日志文件的一些清晰信息。我有一个较大的数据库（2GB），最近由于某种原因没有备份。数据库的日志文件增长到大约 11GB，据我了解，这是数据库中发生的所有事务和语句。

我的问题：

是什么导致数据库日志文件被刷新？“冲洗”实际上是什么意思？对大型日志文件执行文件收缩或数据库收缩的后果是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-17T21:57:30.263

备份事务日志后，这些事务将从日志中截断，但不会自动恢复操作使用的空间。如果您正在执行定期事务日志备份，这可能是一件好事。假设该空间用于交易并且将来会再次被需要。不断缩小事务日志可能不利于性能，因为当再次需要时，数据库将需要扩展日志。

因此，要解决您的问题，请先进行完整备份和事务日志备份。您无需进入简单模式或单用户模式。然后收缩数据库并每隔几个小时设置一次事务日志备份。在我的服务器上，我每 10 分钟执行一次，但这完全取决于人们对其环境的需求频率。监控日志大小如何变化，确保留出足够的空间，使其不必定期扩展，再加上一些额外的乐趣。

当您收缩数据库时，请使用[DBCC SHRINKFILE](http://msdn.microsoft.com/en-us/library/ms189493.aspx)而不是[DBCC SHRINKDATABASE](http://msdn.microsoft.com/en-us/library/ms190488.aspx)，因为后者将收缩整个数据库，而不仅仅是日志文件。此外，您对回收的空间量也没有太多控制权。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T19:39:00.247

备份通常会清除事务日志。事务日志保留自上次备份以来的所有更改。根据您备份数据库的方式，您可能根本不需要保留完整的事务日志。如果您使用的是 MS SQL2000/MS SQL2005，将恢复模式设置为**简单**会删除事务日志。

一旦你确定你有一个干净的数据库副本（没有丢失的风险），删除事务日志是安全的。有一些 SQL 命令可以做到这一点，但我通常将恢复模式更改为**简单**，然后缩小数据库，然后在必要时将恢复模式设置回**完全。**

如果您需要更多信息，请包括您正在使用的 SQL 版本以及如何执行备份，我会看看是否可以详细说明您的特定设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-17T20:20:38.523

实际上，我不相信备份数据库会缩小日志，备份事务日志本身会缩小日志。SQL Server 对两者进行了区分。

通常，我要么让所有数据库“简单”恢复，要么让备份事务日志成为我定期维护计划的一部分（通常每周一次）。

# tfs - 在 TFS（Team Foundation Server）中进行分支有什么好的建议/资源吗？

> ID：453863
> 
> 赞同：8
> 
> 时间：2009-01-17T19:26:49.787
> 
> 标签：tfs, branch

分支似乎总是一件复杂的事情。不是技术上的，但是是的，有一些真正的决策/计划可以提出适当的分支策略。

我知道这个 [TFS 分支指南](http://www.codeplex.com/TFSBranchingGuideII)

您推荐或用于分支和合并的任何其他资源或指南。

非常感谢您分享您在这方面的经验。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-18T19:44:51.677

如果您只专注于专门引用 TFS 的资源，那么您将错过大量本质上更通用甚至针对其他源代码控制系统的优秀内容。鉴于您似乎对方法论而不是 TFS 分支的技术实现更感兴趣，因此寻找其他地方是有意义的 - 例如：

*   [你可以在这里](http://www.ericsink.com/scm/source_control.html)找到一个很好的通用源代码控制教程，由[SourceGear的 Eric 编写](http://www.sourcegear.com/)
*   [Jeff Atwood（SO 创始人之一）在他的 Coding Horror博客](http://www.codinghorror.com/blog/archives/000968.html)中谈到了分支策略
*   [SVN 在其文档](http://svnbook.red-bean.com/en/1.1/ch04.html)中有一个关于分支的极好（如果有点冗长）部分

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-20T12:04:45.507

我已经阅读了模式和实践分支文档，现在开始阅读 Manning 的[Team Foundation Server 2008 in Action](http://www.manning.com/azher/)。

在本出版物中，我还没有深入到分支\合并策略部分，但到目前为止我所阅读的内容（与 TFS 2008 中的新构建功能相关）已经相当不错了！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T23:50:37.577

阅读这篇关于树枝、树干等理论的精彩介绍：http: [//oreilly.com/catalog/practicalperforce/chapter/ch07.pdf](http://oreilly.com/catalog/practicalperforce/chapter/ch07.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T09:34:56.917

我认为这也是一个非常令人耳目一新的观点[infoq](http://www.infoq.com/articles/agile-version-control)

# .net - MDI 表格“蠕变”（MDI 窗口中的位置变化）

> ID：453868
> 
> 赞同：2
> 
> 时间：2009-01-17T19:28:52.700
> 
> 标签：.net, vb.net, mdi

我有一个 VB.NET MDI WinForms 应用程序。我的用户一直在抱怨表单蠕变（正如他们所说的那样），这是每次您在主 MDI 窗口中打开特定表单时，它会在之前加载的位置略下方和右侧打开 - 即它从窗口的左上角并向下移动到右下角。

我不得不同意他们的观点，这非常令人恼火，有什么办法可以防止这种情况发生吗？加载表单的代码是：

```
frmPurchaseInvoiceSelect.Show()
frmPurchaseInvoiceSelect.MdiParent = Me 
```

我可以通过将表单启动位置设置为“手动”来解决这个问题，但它们只是在屏幕左上角直接打开。

任何其他 SO 用户都遇到过这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-17T20:18:12.630

尝试

`frmPurchaseInvoiceSelect.StartPosition = FromStartPosition.CenterParent`

始终从 Mdi 父级的中心开始。

有几个选项，但这取决于您希望表单从哪里开始。我没试过，但是：

```
frmPurchaseInvoiceSelect.Location = windowPoint
frmPurchaseInvoiceSelect.Size = windowSize
frmPurchaseInvoiceSelect.StartPosition = FormStartPosition.Manual 
```

应该在您想要的位置开始表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-19T14:54:31.900

以下为我解决了 **frmUser.StartPosition = FormStartPosition.Manual** 重新打开时，它停止了“爬行”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-10T07:12:53.843

请参阅我的[问题](http://nbnewman.blogspot.com/2011/12/preventing-mdi-creep-how-to-decascade.html)和得到的答案，这很可能会帮助您解决这个问题。您还可以查看我关于该主题的非常详细的[博客文章](http://nbnewman.blogspot.com/2011/12/preventing-mdi-creep-how-to-decascade.html)。我的代码是用 Delphi 编写的，但您应该能够将这些概念转移到 VB。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T20:03:58.870

不管使用什么语言，原因都是一样的。当您打开第一个 MDI 窗口时，起点是相对于 MDI 框架的 0,0，因此它在框架内的左上角打开。如果您关闭窗口然后重新打开它，则起点不再是 0,0，而是基于您打开窗口的方式（级联等）的其他值 通常它会略低并位于前一个窗口的右侧关闭。存在问题是因为您或该工具没有检查要打开的窗口是否是框架内的唯一窗口实例。如果窗口是唯一的实例，则在 0,0 处打开它，否则在相对于其他窗口的适当位置打开它。

此功能通常由您正在使用的 MDI 库处理，或者如果没有，您将手动对其进行编码。手动编写代码只需要几行代码，因此实现起来应该很简单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T20:59:20.503

男童，

MDI 应用程序通常不显示居中的窗口，尽管 SDI 应用程序可以。在打开多个窗口的 MDI 应用程序中，用户通常希望看到每个窗口的边缘（级联视图），以便他/她可以单击所需的窗口将其带到前面。这通常可以通过两种方式完成。知道打开了多少个窗口以及它们相对于 MDI 框架的位置。打开最后一个窗口正下方和右侧的后续窗口。此功能通常在所使用的语言或库中提供。第二种方法是选择（菜单或其他方式）以在所需方向（层叠、平铺或分层）之后显示打开的窗口。正如我之前提到的，如果在语言/库中没有自动提供 MDI 显示功能，则需要手动对其进行编码。

# compiler-construction - 编写编程语言的建议？

> ID：453870
> 
> 赞同：16
> 
> 时间：2009-01-17T19:29:42.010
> 
> 标签：compiler-construction, programming-languages, interpreter, scripting-language

您能给想要编写编程或脚本语言的人什么建议？我不担心如何编程或设计编译器，而是担心如何使用工具和代码生成器快速开发编译器。

上次我尝试用 C++ 编写它，状态和语法几乎与编写实际逻辑一样长。我知道以下工具会有所帮助。

我在想我可以生成 c++ 代码并让 gcc 编译它。使用上述工具，您估计编写程序或脚本语言需要多长时间？

* * *

早在[学习编写编译器](https://stackoverflow.com/questions/1669/learning-to-write-a-compiler)时，人们就反复询问过这个问题的变体。这是有关该主题[的 SO 资源的不完整列表。](https://stackoverflow.com/questions/365602/creating-your-own-language#365636)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-17T19:37:52.043

估计这样的事情可能需要多长时间取决于许多不同的因素。例如，一个有经验的程序员可以通过单元测试在几个小时内轻松搞定一个简单的算术表达式求值器。但是新手程序员可能必须学习解析技术、递归下降、表达式树的抽象表示、树遍历策略等等。这很容易花费数周或更长时间，仅用于算术表达式。

但是，不要让这让您灰心。[正如 Jeff 和 Joel 在最近的 Stack Overflow 播客](https://blog.stackoverflow.com/2009/01/podcast-36/)上与 Eric Sink 讨论的那样，编写编译器是了解编程许多不同方面的绝佳方式。我已经构建了一些编译器，它们是我最难忘的编程项目之一。

一些关于构建编译器的经典书籍是：

*   [编译器：原理、技术和工具](http://dragonbook.stanford.edu/)（也称为龙书）
*   [计算机程序的结构和解释](http://mitpress.mit.edu/sicp/)（也称为 SICP）
*   [算法 + 数据结构 = 程序](http://www.inf.ethz.ch/personal/wirth/books/AlgorithmE0/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T22:34:39.157

Dave Hanson 与 Chris Fraser 一起花了 10 年时间构建[了世界上最精心制作的编译器](http://www.cs.princeton.edu/software/lcc/)之一，他曾经告诉我，他从经验中学到的主要内容之一是不要尝试用 C 或 C++ 编写编译器。

如果你想快速开发一些东西，不要生成原生代码；以现有虚拟机为目标，例如 CLR、JVM 或[Lua](http://www.lua.org/)虚拟机。使用最大咀嚼生成代码。

如果您正在编写解释器，另一个不错的选择就是使用底层编程语言的内存管理和其他工具。解析为 AST，然后通过 AST 的 tree walk 进行解释。这将使您快速起步。性能不是最好的，但可以接受。（使用这种技术，我曾经在 Modula-3 中编写了一个 PostScript 解释器。第一个实现花了一周时间，尽管后来它进行了一些性能调整，主要是在词法分析器中，但它从来没有被替换过。）

避免使用 LALR 解析器生成器；使用可以节省您时间的东西，例如 ANTLR 或[Elkhound](http://www.cs.berkeley.edu/~smcpeak/elkhound/) GLR 解析器生成器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T19:41:42.813

关于编译器设计的经典书籍是

Alfred V. Aho 和 Jeffrey D. Ullman 的“编译器设计原则”。它已经存在了很长一段时间，它的粉红骑士和绿龙至少为几代 CS 学生所熟知。

还...

“编译器：原理、技术和工具”，Alfred V. Aho、Monica S. Lam、Ravi Sethi、Jeffrey D. Ullman

如果您对编写编译器感兴趣，那么这些无疑是最好的起点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-17T20:05:23.187

> 作为一个非常了解 C++ 的人，您能给想要编写编程或脚本语言的人提供哪些建议？

不要这样做。（或者至少在你做之前仔细想想！）

如果您正在尝试编写脚本语言来公开某些自定义编写对象的方法/属性，最好在 Java（或 .NET/VB 或所有那些讨厌的 Microsoftisms）中实现这些，然后使用其中一个[Bean Scripting Framework](http://jakarta.apache.org/bsf/)语言作为您的脚本语言。（与微软端的任何等价物。）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-17T20:35:31.800

任何关于编译器的问题都会在几分钟内得到答案“去读龙书，读那本书，这本书……”。所以我跳过了那部分（就像我一开始所说的那样）。阅读这些书来学习如何使用你想要的工具，与阅读角动量来学习如何骑自行车一样有用。

因此，为了回答您的问题，无需质疑您的意图，我可以轻松地向初学者推荐 antlr 和 antlrworks。您可以轻松生成 AST（我认为真正的魔法发生在哪里）并直观地调试您的语法。它为您生成了一个工作编译器的很大一部分。

如果你知道你的东西并且想要有更多的控制权或者不喜欢 antlr，你可以一起使用[柠檬](http://www.hwaci.com/sw/lemon/)解析器生成器和[ragel](http://www.complang.org/ragel/)状态机编译器（对词法分析有特殊的支持）。

如果您不需要太多的性能，并且由于您计划生成 C/C++ 代码，您可以跳过自己进行任何优化，并将这些东西留给您的 C/C++ 编译器。

如果您可以忍受缓慢的运行时，您可以进一步缩短仅进行解释的开发工作，因为以这种方式实现动态功能通常更容易。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-18T16:30:10.600

我认为每个人都错过了一个非常重要的观点。

***为什么***要编写编译器/解释器/解析器等。

这将严重决定你所做的很多事情。

我从事过很多语言实现，有些很奇怪，有些特定于领域，有些只是通过命令环境编写的脚本（通常后来隐藏了命令环境）。每个都需要不同水平的技能。

许多书籍可供选择。我喜欢的是一本 BYTE 书：Threaded Interpreted Languages - 打赌它已经绝版了。

简单的脚本引擎可以通过几个晚上的思考和一些尝试和错误来制作。

但我敢打赌，现在有在线课程可以为您节省大量时间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-17T20:06:18.583

我强烈建议查看现有的字节码解释器。如果您可以使您的语言适合 CIL (.NET) 或 Java（甚至是 Python 或 Parrot 等其他语言），您将省去创建可行支持环境的所有努力，并且可以继续尝试语言概念。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-17T20:58:33.750

如果您打算编写解释器或编译器，请不要这样做，因为您想编写下一件大事。写它是因为你已经有了它的目的或学习它。如果你这样做，你可能会发现你不小心写了下一件大事。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-18T00:58:56.387

我用于 LALR 的一个好工具是[GOLD Parsing System](http://www.devincook.com/goldparser/)。它是免费的，语法是 Backus-Naur 形式，并且有多个示例，包括用 C#、VB.NET、Java 等编写的引擎。这使您可以编写语法，将语法编译为文件，然后使用引擎解析语法。

如上所述，我建议以某种字节码为目标，例如 IL。这将允许您利用大量现有框架。

祝你好运

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-18T04:26:45.750

如果您不想编写编译器以将语言简化为汇编/机器，那么您的下一个选择是将编译器编写为字节码语言虚拟机，例如 JVM、PVM 或 .NET。

当然，如果您甚至不想这样做——您只想创建自己的“领域特定语言”，我会在 Common Lisp 中构建它。Lisp 宏提供了一种相当直接的方法来创建您想要的任何语法并将其解析为 Lisp。而且您不必担心字节码或汇编。当然，你需要学习 Lisp。

# php - 谁能解释这个.ASP aka VB“Regex.Replace”函数，以便我可以在 PHP 中完成它？

> ID：453874
> 
> 赞同：-1
> 
> 时间：2009-01-17T19:31:53.333
> 
> 标签：php, asp.net, vb.net, regex, replace

下面的代码是visual basic、.NET、ASP... 以上都是？当“strCookies”等于两个 Regex.Replace 函数下方的文本块时，谁能告诉我这两个“Regex.Replace”函数/方法会给我留下什么？我相信这个想法只是简单地捕获“sessionid”代码，然后捕获“cadata”代码，带或不带“sessionid”和“cadata”的标题/键。最终，我正在尝试在 php 中进行等效操作...问题是我正在尝试根据此代码推断出我到底需要什么。希望这是有道理的。谢谢！（我还想为“cadata”代码添加这一点，我特别困惑我是否应该抓住整个代码周围的双引号。sessionid 没有 t 有和双引号，所以它不那么混乱。我不知道 Regex.Replace 函数在做什么）。

* * *

Dim strCADataCookie As String = Regex.Replace(strCookies, "(. *)sessionid=(.* )(,|;)(.*)", "$2")

Dim strSessionIDCookie As String = Regex.Replace(strCookies, "(. *)cadata=""(.* )""(.*)", "$2")

* * *

Netscape HTTP Cookie 文件 [http://www.netscape.com/newsref/std/cookie_spec.html](http://www.netscape.com/newsref/std/cookie_spec.html) 这个文件是由 libcurl 生成的！编辑风险自负。

a.test.edu FALSE / FALSE 0 sessionid ca391d4e-69ad-4726-b00c-efa26f3d1594

a.test.edu FALSE / TRUE 0 cadata "2YUj33BRih9xeQqCL1PLAY+0EExSdDkGJdQg7KoUbca6OQxrgJi0AuuPBOEhCu7wlG2+2in5ilEE="

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T20:51:13.890

> `Regex.Replace(strCookies, "(.)sessionid=(.)(,|;)(.*)", "$2")`

这将返回一个名为 sessionid 的 cookie 的值。

> `Regex.Replace(strCookies, "(.)cadata=""(.)""(.*)", "$2")`

在取消引用后返回名为 cadata 的 cookie 的值。因此，生成的字符串将在**没有**引号的情况下存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T20:50:09.400

我运行您在问题中显示的代码，对于给定的 strCookie 示例，strCADataCookie 和 strSessionIDCookie 的结果都是 strCookie。原因是没有进行替换，因为 strCookie 中的模式不匹配。

您可以在此处阅读有关正则表达式的一些信息：[http ://www.regular-expressions.info/reference.html](http://www.regular-expressions.info/reference.html)

您示例中的正则表达式有点奇怪。任何一种模式匹配的所有内容都将被单个字符替换。$2 - 指括号中第二个表达式的值。"" - 表示“，第一个”只是一个转义字符。

希望这会帮助你。

# database - 有没有办法使用 Sybase 工具包或 Perl DBI 等访问该 *.DB 文件？

> ID：453877
> 
> 赞同：1
> 
> 时间：2009-01-17T19:32:56.280
> 
> 标签：database, perl, odbc, sybase, dbi

我工作的医疗办公室使用没有 ODBC 的 MIS。但是，有一个导出功能，它似乎将其转储到“export.DB”文件中。在 Windows 中，这通常是 Paradox 数据库；但是，在窥探目录体系结构时，看起来好像有一个可移植的 Sybase 服务器。有没有办法使用 Sybase 工具包或 Perl DBI 等访问该 *.DB 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-19T14:52:01.377

这不是一个直接的答案，但作为一个中间步骤它可能会有所帮助。

您可以尝试使用工具（不是免费的）转换为更易于访问的格式，例如：

[ABC 琥珀悖论](http://www.processtext.com/abcprdox.html)

例如，如果您转换为 MDB，则在 windows 上使用 perl DBI 访问相对简单。

这是一次性转换还是重复/定期访问？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-20T20:43:23.657

不幸的是，*.db 可以是任何东西：Berkeley DB、Paradox、DB III 或专有格式。如果幸运的话，它们都不是，它是一个普通的旧文本文件（带有分隔符或固定宽度）。我还认为在同一个应用程序中看到 Paradox 和 Sybase 的混合有点奇怪（例如：生成 Paradox 导出文件的 Sybase 后端，除非这是特定的导出模式）。

您是否有更多关于生成数据文件的引擎的信息？您提到 Paradox 和 Sybase：您确定它是其中之一吗？

您是否尝试过直接查看文件，例如记事本（如果文件很大，则使用写字板）？是文字还是乱码？如果乱码，您是否在第一行中看到任何内容，或者是否可以为您提供有关其格式的线索？

# language-agnostic - 你如何设计一个继承类？

> ID：453879
> 
> 赞同：12
> 
> 时间：2009-01-17T19:33:11.270
> 
> 标签：language-agnostic, inheritance

我听说它说“为继承而设计”是“困难的”，但我从来没有发现过这种情况。任何人（以及任何人，我的意思是 Jon Skeet）都可以解释为什么这据称很困难，陷阱/障碍/问题是什么，以及为什么普通的程序员不应该尝试它，而只是让他们的课程被密封以保护无辜者？

好吧，我对后者开玩笑——但我很想知道是否有人（包括乔恩）真的有“为继承而设计”的困难。我真的从来没有认为这是一个问题，但也许我忽略了一些我认为理所当然的事情 - 或者在没有意识到的情况下搞砸了一些事情！

编辑：感谢迄今为止所有出色的答案。我相信共识是​​，对于典型的应用程序类（WinForm 子类、一次性实用程序类等），无需考虑任何类型的重用，更不用说通过继承进行重用，而对于库类，考虑重用至关重要通过设计中的继承。

我并没有真正考虑过，比如说，一个 WinForm 类来实现一个 GUI 对话框，作为一个有人可以重用的类——我有点认为它是一个一次性的对象。但从技术上讲，它是一个类，有人可能会继承它——但这不太可能。

我所做的许多大规模开发都是用于基础库和框架的类库，因此通过继承设计重用是至关重要的——我只是从不认为它是“困难的”，它*只是*. ;-)

但我也从未考虑过它与 WinForms 等常见应用程序任务的“一次性”类相比。

当然，欢迎更多关于继承设计的技巧和陷阱；我也会尝试加入一些。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-17T20:03:49.180

我不会过多地重复它，而是简单地回答你应该看看[我在子类化 java.util.Properties 时遇到的问题](https://stackoverflow.com/questions/453059/can-someone-give-a-better-example-of-fragile-base-class-issues#453071)。我倾向于通过尽可能少地这样做来避免为继承设计的许多问题。不过，这里有一些关于问题的想法：

*   正确实现相等是一种痛苦（或可能是不可能的），除非您将其限制为“两个对象必须具有完全相同的类型”。`a.Equals(b)`困难来自隐含的对称要求`b.Equals(a)`。如果`a`和`b`分别是“一个 10x10 正方形”和“一个*红色*10x10 正方形”，那么`a`很可能会认为它`b`等于它 - 在许多情况下，这*可能*就是你真正想要测试的全部。但`b`知道它有颜色，`a`不...

*   任何时候在实现中调用虚拟方法时，都必须记录这种关系，并且永远不要改变它。从该类派生的人也需要阅读该文档 - 否则他们可能会以相反的方式实现调用，迅速导致 X 调用 Y 的堆栈溢出，它调用 X 调用 Y。这是我的主要问题 - 在许多在这种情况下，您必须记录您的*实施*，这会导致缺乏灵活性。如果您从不从另一个虚拟方法调用一个虚拟方法，它会显着减轻，但是您*仍然*必须记录对虚拟方法的任何其他调用，即使是来自非虚拟方法的调用，并且永远不要在这个意义上更改实现。

*   即使没有一些未知代码作为执行时类的一部分，也很难实现线程安全。您不仅需要记录类的线程模型，而且可能还必须向派生类公开锁（等），以便它们以相同的方式是线程安全的。

*   考虑哪种专业化是有效的，同时保持原始基类的合同。可以通过哪些方式覆盖方法，以便调用者不需要了解专业化，只需知道它是否有效？java.util.Properties 是一个糟糕的专业化的很好的例子——调用者不能仅仅把它当作一个普通的 Hashtable，因为它应该只有键和值的字符串。

*   如果一个类型是不可变的，它不应该允许继承——因为子类很容易是可变的。那么奇怪的事情就会比比皆是。

*   你应该实现某种克隆能力吗？如果不这样做，可能会使子类更难正确克隆。有时按成员克隆就足够了，但有时它可能没有意义。

*   如果您不提供*任何*虚拟成员，您可能会相当安全 - 但此时任何子类都提供额外的不同功能，而不是专门化现有功能。这*不一定*是坏事，但感觉不像继承的初衷。

与类库设计者相比，对于应用程序构建者来说，其中许多问题要小得多：如果你知道你和你的同事将是唯一从你的类型派生的人，那么你就可以少很多了——前端设计 - 如果您以后需要，您可以修复子类。

顺便说一句，这些只是即兴点。如果我思考的时间足够长，我可能会想出更多。Josh Bloch 在 Effective Java 2 中说得很好，顺便说一句。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T20:14:19.020

我认为重点在 Jon 回复的倒数第二段：大多数人从应用程序设计的角度考虑“为继承而设计”，即他们只是希望它工作，如果它不工作，它可以被固定。

但是将可继承类设计为 API 供其他人使用是完全不同的野兽 - 因为受保护的字段和大量实现细节隐含地成为使用 API 的人必须理解的 API 合同的一部分，并且如果不使用 API 破坏代码，则无法更改。如果您在设计或实现中犯了错误，您可能无法在不破坏依赖它的代码的情况下修复它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-19T02:10:33.740

我不认为我曾经设计过继承类。我只是编写尽可能少的代码，然后当需要复制和粘贴以创建另一个类时，我将那个方法撞到一个超类中（它比组合更有意义）。所以我让不要重复自己（DRY）原则决定了我的课堂设计。

至于消费者，就看他们是否理智行事了。我尽量不规定任何人如何使用我的课程，尽管我确实尝试记录我打算如何使用它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T20:33:49.107

另一个可能的问题：当您从基类的构造函数中调用“虚拟”方法，并且子类覆盖此方法时，子类可能会使用未初始化的数据。

代码更好：

```
class Base {
  Base() {
    method();
  }

  void method() {
    // subclass may override this method
  } 
}

class Sub extends Base {
  private Data data;

  Sub(Data value) {
    super();
    this.data = value;
  }

  @Override
  void method() {
    // prints null (!), when called from Base's constructor
    System.out.println(this.data);  
  }
} 
```

这是因为基类的构造函数必须总是在子类的构造函数之前完成。

摘要：**不要从构造函数中调用可覆盖的方法**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T20:03:47.573

有时在创建基类时，我不确定是否应该将某些成员公开给子类，例如用于同步的对象。我通常最终将它们全部设为私有，并在需要时将它们更改为受保护。

# oop - 可视化函数层次结构树的工具？

> ID：453881
> 
> 赞同：1
> 
> 时间：2009-01-17T19:34:07.853
> 
> 标签：oop, function, code-analysis

任何可以执行其中任何一项的**代码分析或“逆向工程”工具？：**

*   计算哪些类是哪些类的**子**类
*   计算哪些类**实例化**哪些类—— *（如**[VS Class Designer](http://msdn.microsoft.com/en-us/library/aa288743.aspx)**）*
*   计算哪些函数**调用**哪些函数—— *（很像**调用堆栈**）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T19:59:44.087

[Doxygen](http://www.doxygen.nl/) + [GraphViz](http://www.graphviz.org/) （对于图片，doxygen 需要 GraphViz）

它具有最大的语言支持（因为您没有指定语言）并且查看器是浏览器，因此一旦生成，任何人都应该能够查看它。

配置 doxygen 以生成甚至未记录的成员，并包含源代码。这样，源代码将包含指向函数声明的链接，以便于导航。

还有一些专门研究一种语言的工具，例如[为 C++ 理解的](http://www.scitools.com/products/understand/)工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-19T13:17:08.487

> 计算哪些函数调用哪些函数

NDepend 可以生成一些有用的方法或类**调用图**，例如下面的屏幕截图（[此处](http://www.ndepend.com/Res/DiagramBoxAndArrowGraphBig.jpg)为全尺寸图片）*免责声明：我是该工具的开发人员之一*

![NDepend 方法调用图](https://i.stack.imgur.com/uT9pX.jpg)

在此处查找有关[如何使用 NDepend 生成调用图的](http://www.ndepend.com/Doc_VS_Arch.aspx#Call)更多说明。

> 计算哪些类是哪些类的子类

同样的方式 NDepend 可以生成类继承图（[这里​​解释生成类继承图](http://www.ndepend.com/Doc_VS_Arch.aspx#Inherit)）。

> 计算哪些类实例化哪些类

NDepend 允许**在 LINQ 查询**（我们称之为[CQLinq](http://www.ndepend.com/Features.aspx#CQL)）上编写代码查询。使用 CQLinq，您可以请求创建特定类的方法或类，例如：

```
from m in Methods 
where m.CreateA("NUnit.Core.NUnitConfiguration")
select m 
```

这样的 CQLinq 查询结果可以导出到图形视图，以获得依赖关系的可视化表示。

附带说明一下，使用 CQLinq 还可以编写代码规则。默认提出了超过[200 条代码规则，这些规则包括关于](http://www.ndepend.com/Doc_VS_Arch.aspx#Inherit)*设计*、*架构*、*代码质量*、*代码演化*、*命名约定*、*死代码*、*.NET Fx 使用*的规则......

CQLinq 规则可以[在 Visual Studio 中实时验证](http://www.ndepend.com/Doc_VS_CQL.aspx)，或者可以在构建过程中验证并[在 HTML/javascript 报告中报告](http://www.ndepend.com/Doc_CI_Report.aspx#CQLRule)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T20:18:43.677

**了解2.0**

> ...显示了**用不同语言编写的代码部分之间的依赖关系**。CLA 使**跟踪呼叫变得容易。** ~[组合语言分析](http://www.scitools.com/products/understand/details.php)

特别是这个[函数调用树](http://www.scitools.com/images/screenshots/understand/AdaCallsC.jpg)图像。

# c# - 赢表计算器：按钮 0 - 9 执行重复任务的事件处理程序

> ID：453884
> 
> 赞同：4
> 
> 时间：2009-01-17T19:36:09.267
> 
> 标签：c#, winforms, calculator

我有一个看起来像典型计算器的 win 表单 UI。自然，我不想为每个数字按钮（0-9）重写相同的逻辑。我希望能够知道单击了哪个按钮，以便可以根据它的 text 属性执行计算。我应该只创建一个接受按钮对象作为参数的方法来促进代码重用吗？有没有更好的办法？我想听听更多资深的 Win Form 应用程序开发人员将如何处理这个问题。我试图将我的逻辑排除在 UI 之外。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T20:04:39.397

事件处理程序的典型签名是`void EventHandler(object sender, EventArgs e)`. 重要的部分是`object sender`. 这是触发事件的对象。在 a`Button`的点击事件的情况下，发送者将是那个`Button`。

```
void digitButton_Click(object sender, EventArgs e)
{
    Button ButtonThatWasPushed = (Button)sender;
    string ButtonText = ButtonThatWasPushed.Text; //the button's Text
    //do something

    //If you store the button's numeric value in it's Tag property
    //things become even easier.
    int ButtonValue = (int)ButtonThatWasPushed.Tag;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-17T19:46:13.413

指定事件处理程序时，您可以注册相同的函数来处理多个事件（如果在 VS.Net 中，请转到属性，选择事件部分（闪电按钮），单击下拉菜单以单击）。这样，您将编写一个事件处理函数来处理所有按钮。

示例 (C#) 如果在代码中完成按钮创建和事件注册：

```
public void digitButtons_Click(object sender, EventArgs eventArgs) {
    if(sender is Button) {
        string digit = (sender as Button).Text;
        // TODO: do magic
    }
}

public void createButtons() {
    for(int i = 0; i < 10; i++) {
        Button button = new Button();
        button.Text = i.ToString();
        button.Click += digitButtons_Click;
        // TODO: add button to Form
    }
} 
```

# java - 如何使用 Eclipse TPTP 分析 JNI 应用程序？

> ID：453896
> 
> 赞同：1
> 
> 时间：2009-01-17T19:45:38.827
> 
> 标签：java, eclipse, profiling, java-native-interface, eclipse-tptp

我需要从 C 应用程序分析由 JNI 调用 API 启动的 Java 应用程序，自然 TPTP 工具似乎是一个不错的起点。但是，我可以启动应用程序，但我不知道如何连接到它以进行分析。我意识到这属于“愚蠢的新手”桶，但我真的有点迷路了。请允许我解释一下：

我已将 JVM 选项“ `-XrunpiAgent:server=controlled`”添加到我的 java VM 启动选项中。

我已经添加了`$ECLIPSE_HOME/plugins/org.eclipse.tptp.platform.ac.linux_ia32_4.4.1.v200808290100/agent_controller/lib to my LD_LIBRARY_PATH`

我正在针对 Sun Java 1.5.0_10 JVM 库运行

在 Eclipse 中，我有一个 Java 项目，其中包含我希望分析的代码。我没有分析启动配置，我也不真正知道需要进入它们的内容。

正是在这一点上，我的知识走到了尽头。当我启动我的基于 JNI 的应用程序时，它只是在 VM 启动期间停止并等待，大概是代理控制器连接。我需要采取哪些步骤才能实现这一目标并从中获取信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-23T00:08:00.757

我之前尝试过使用 TPTP，但我始终无法正确设置它。我可以建议您尝试使用 netbeans 中包含的分析器来连接到您的应用程序。我用它来分析一个带有 JNI 调用的应用程序，它对我很有帮助。当然，所有本机代码对分析器都是不透明的，它只会告诉您本机调用本身花费了多长时间。

[如果有帮助，我有一篇博客文章解释了如何使用 netbeans 分析 Eclipse 应用程序。](http://jroller.com/ortegon/entry/on_profiling_eclipse_rcp_applications)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-23T07:18:30.043

您可以使用 C 分析器来分析您的 C 代码。它需要编译到您要分析的库中，但对于查看代码在做什么很有用。

# mysql - 用MySql中的自然键改造表中的代理键？

> ID：453897
> 
> 赞同：1
> 
> 时间：2009-01-17T19:46:06.190
> 
> 标签：mysql, primary-key, surrogate-key, natural-key

假设一个表使用自然键并且有许多现有的行。改造代理键列并使用 MySql 用唯一值填充它的最简单方法是什么？

即变换

```
table employees
(
    social_security_no varchar(20),
    ...
    constraint emp_pk primary key (social_security_no)
); 
```

到

```
table employees
(
    id int,
    social_security_no varchar(20),
    ...
    constraint emp_pk primary key (id)
); 
```

并用有效的 id:s 填充新的 id 列。

谢谢/埃里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T21:56:51.370

简单的：

```
ALTER TABLE employees DROP PRIMARY KEY;
ALTER TABLE employees ADD (id INT AUTO_INCREMENT PRIMARY KEY); 
```

或者你会（可能）想要这样做：

```
CREATE INDEX employees_ssn ON employees (social_security_no); 
```

对于任何参考表：

```
ALTER TABLE blah ADD (employees_fk INT);
UPDATE blah b SET employees_fk = (SELECT id FROM employees WHERE social_security_no = b.ssn);
ALTER TABLE blah DROP (ssn); 
```

# c# - 将 c# 2.0 BL/DL 和 webservice/wcf 代码移植到 linux（使用 oracle DB）

> ID：453905
> 
> 赞同：1
> 
> 时间：2009-01-17T19:49:21.893
> 
> 标签：c#, linux, mono

我有这个典型的场景。我有一个基于 Windows 上的 .net 2.0 框架的 smartclient 应用程序。申请的细节无关紧要。这不是一个学习项目，而是一个我需要移植的真正的中级企业应用程序。

我需要将我的 BusinessLayer 和 DataLayer 移植到 Linux（使用 oracle 作为后端）。

我只是稍微了解 MONO 项目 [MONO 项目](http://www.mono-project.com/Main_Page)

有没有人做过这种事情？如果是，请向我指出适当的资源，这将有助于将我的 BL/DL 迁移/移植到 Linux。

MONO 还支持 WCF/webservices 吗？有什么警告吗？

这里需要一些真实的经验

*   移植/迁移的便利性
*   面临的问题
*   任何具体的挑战
*   已知限制等

我没有做过这种活动。所以，任何输入都会有帮助，这对我来说真的是一个学习练习。

## 编辑：

得到一个指针 [Mono 迁移分析器工具](http://www.mono-project.com/Main_Page)

这似乎很有用，但对我来说不是，因为我主要处理 BL/DL/Services。但可能对某人有用。试试这个。

如果有人除了我下面的回答之外还有其他资源也会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-18T03:27:55.120

我认为以下有关将 .net 应用程序移植到 MONO 的 codeproject 文章可能很有用。这是与“Mainsoft 的蚱蜢”合作安排的比赛。似乎是一个很好的工具。

- [Race to Linux - Race 2: Time Tracker Starter Kit](http://www.codeproject.com/KB/cross-platform/RacetoLinuxRace2.aspx)

- [ASP.NET TimeTracker Starter Kits 从 Windows 移植到 Linux](http://www.codeproject.com/KB/aspnet/TimeTracker_Porting.aspx)

- [Race to Linux - Race 3: Reports Starter Kit 使用 Mono SqlServer/Firebird](http://www.codeproject.com/KB/aspnet/RaceToLinuxRace3.aspx)

并且可以在以下位置找到关于在 MONO 上进行开发的全面介绍

[Mono 简介 - 带有 XSP 和 Apache 的 ASP.NET](http://www.codeproject.com/KB/cross-platform/introtomono2.aspx)

这是将应用程序移植到 MONO 的指南

[将应用程序移植到 MONO 的指南](http://www.mono-project.com/Guide:_Porting_ASP.NET_Applications)

这不是问题的完整答案，而只是我发现的一些有用资源。

# .net - .NET 中的序列号（注册密钥）算法

> ID：453908
> 
> 赞同：6
> 
> 时间：2009-01-17T19:53:15.630
> 
> 标签：.net, algorithm, security, licensing, software-distribution

有一些关于 IP 安全等的及时帖子，但我找不到专门针对算法的帖子。在我目前的一个项目中，我们决定采用离线注册密钥系统的路线。

我想我们最终的大多数用户群都会是诚实的，所以我认为我们不必担心*太多。*另一方面，我宁愿在没有大量汗水和眼泪的情况下让休闲饼干获得访问权。

那么，如何生成（和验证）密钥有哪些选择？由于安装模型是从内部网服务器上的 samba 共享运行，因此很可能无法使用硬件键控。另外，钥匙应该多长？

其次，验证算法简单地被反射出来的危险有多大，即使被混淆了？用非托管代码编写算法会更好吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-18T02:42:33.183

在我看来，您将面临的关键问题不在于您的注册算法和混淆程度（或缺乏）。

相反，它是这样的：在您的代码中的某个时刻，它归结为简单的二进制决策 - 运行或退出。破解你的系统只需要找到并调整这个决策点。

其他一切——混淆、强签名、篡改检测——都是为了让这变得更加困难，但它不能让它*变得*更难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T20:33:07.890

通常，您想要做的是选择一些您想要包含在密钥中的数据，例如谁拥有它以及它何时到期，甚至可能是您的应用程序需要正常工作的一些小代码（因此很难让它在没有钥匙）。然后使用 RSA 等数字签名方案，使用您公司的私钥对密钥进行数字签名。将公钥与应用程序可执行文件一起分发。然后在加载密钥时，只需验证签名是否有效，然后使用密钥中包含的数据即可。1024 或 2048 位的密钥应该足够了。

当然，无论您的代码多么复杂，总有人能够破解它或绕过它。所以你必须问自己的问题是你想让它有多难（记住更难的方案对你来说更难编码和维护）？有一个收益递减点，通常是相当低的。只要程序在没有密钥的情况下无法运行，并且密钥足够复杂以至于您无法使用十六进制编辑器伪造一个（或更改到期日期等），那么您可能没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T21:33:20.343

就重构密钥而言，如果他们将调用站点从托管变为非托管，那么将其写入非托管可能无济于事。如果您使用 Dotfuscator 专业人士，您可以选择一种混淆方式来启用他们的“篡改检测”，本质上他们会标记您的程序集，并且如果有人修改您可以让您的代码执行各种操作。当然，黑客可以删除它，但它需要更多的汗水和泪水。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-18T03:03:42.547

我只找到了一种很好地锁定代码的方法。几乎所有形式的串行验证都可以被普通的二年级程序员轻松破解。

我这样做的方法是在 .NET 中使用 License 对象。在我自己开发的许可证对象中，它读取“许可证”文件以找出“家”在哪里。该许可证是一个加密字符串。字符串的私钥在 License 对象中。

然后，许可证对象使用同样加密的秘密密码调用 home。服务器解密密码并验证它......还记录IP和用户名以防欺诈调查。如果服务器可以验证密码，它会以秘密响应进行响应，再次加密以防止被欺骗。如果无法验证，则断开连接。没有响应发送，因此另一端的 License 对象失败。

当集成的 License 对象失败时，它会自动抛出异常，强制应用程序失败并在调用 license 时退出。

我花了大约两个工作日来编写服务器和许可证对象，所以这有点像锻炼，但不是火箭科学。

如果您想要一些示例源或更多信息，请告诉我。我会很高兴为您提供我所能提供的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T20:20:58.443

你可能想看看[这个问题的答案](https://stackoverflow.com/questions/453030/how-can-i-create-a-product-key-for-my-c-app#453051)

# objective-c - 从多个 XIB 中使用一个 NSArrayController

> ID：453909
> 
> 赞同：3
> 
> 时间：2009-01-17T19:55:14.673
> 
> 标签：objective-c, cocoa, interface-builder, cocoa-bindings, nsarraycontroller

我在不同 XIB 中定义的两个窗口中显示一个 NSArrayController 的内容时遇到了一些问题。

在我的主窗口中（在 MainMenu.xib 中），我有一个 NSTableView 绑定到 NSArrayController

在我的第二个 XIB 中，我有另一个包含 NSTableView 的窗口。我创建了一个新的 NSArrayController，并将表绑定到该 NSArrayController 的内容。

两个 NSArrayController 都绑定到完全相同的 NSArray。

一开始一切都很好，但问题是如果在主窗口中使用 NSArrayController 将对象添加到数组中，则辅助窗口的数据视图不会更新。这很可能是因为它不知道自己需要更新自己，因为它的 NSArrayController 没有用于添加新对象。

我想做的是在两个窗口中使用完全相同的 NSArrayController 实例。这样，如果将对象添加到数组中，两个视图都将收到更改通知。

问题是我无法弄清楚如何在 Interface Builder 中执行此操作。我无法将 NSArrayController 绑定到另一个 NSArrayController（我收到一个运行时错误，表明它只能绑定到 NSArray）。将 NSArrayController 连接到 File's Owner 的 NSArrayController 成员也无济于事，因为这只会清除我希望它使用的 NSArrayController。

我想我可以自己在代码中设置绑定，但如果可能的话，使用 Interface Builder 似乎会更好。有没有办法在 Interface Builder 中做到这一点，或者可能有更好的方法来一起设置？

**更新：**针对 Chuck 的回答和评论，我尝试了以下操作： - 将我的 NSTableView 的表格内容绑定到 NSArrayController 成员的排列对象（如果我使用 NSArrayController 本身，日志中出现错误：“[NSArrayController count] : unrecognized selector sent to instance") - 将表中的每一列绑定到文件的所有者，模型键路径为 arrayController.arrangedObjects.propertyName

这仍然没有导致表的内容得到更新。我认为这是因为我绑定到 NSArrayController 的排列对象，而不是绑定到 NSArrayController 本身。但是，如果我直接绑定到 NSArrayController，那会给我带来错误。

通常，我会从“绑定到”组合框中选择我的 NSArrayController，使用排列对象作为控制器键，并将属性本身作为模型键路径。我不确定在这种情况下如何做同样的事情——如果可以的话。

我在上面的过程中做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-27T18:48:47.220

我能想到的最好的选择是`NSArrayController`通过调用它来通知第二个它正在管理的数组已经改变`rearrangeObjects:`。这看起来很笨拙，但它确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-27T18:51:21.757

如何在 IB 中将它们设置为代理对象，然后在代码中实例化实际的对象，也许在您的应用程序委托中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-30T22:22:32.977

添加数组时，您可以通过 KVO 让两个 NSArrayControllers 更新。诀窍是您必须以符合 KVO 的方式观察并添加到数组中。

您需要一些拥有该数组的对象，我们称其为“模型”。数组必须是对象上的键，我们称键为“contentArray”。接下来，当您添加/删除时，您应该首先在“model”上调用 mutableArrayForKey 以获取“contentArray”。然后从数组中添加/删除应该可以工作，例如：

Controller1 绑定到 self.model.contentArray

Controller2 绑定到 self.model.contentArray

```
//this method is on the "model" object
-(void)addContent(id content)
{
    NSMutableArray* contentArr = [self mutableArrayForKey:@"contentArray"];
    [contentArr addObject:content]; //this will trigger KVO notifications
} 
```

或者，您可以像这样手动执行 KVO 通知：

```
-(void)addContent(id content)
{
    [self willChangeValueForKey:@"contentArray"];
    [m_contentArray addObject:content];
    [self didChangeValueForKey:@"contentArray"];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-19T04:14:21.463

当您通过另一个数组控制器进行更新时，没有理由让两个数组控制器不更新一个视图。如果它没有发生，听起来您的 KVO 通知在某处丢失了。很可能您正在直接编辑一个数组（`add:`也许是在 NSArrayController 子类的方法中？）而不发送正确的更改通知。

# java - 如何确定使用 Spring Security 访问 URL 需要哪些角色？

> ID：453925
> 
> 赞同：6
> 
> 时间：2009-01-17T20:04:48.617
> 
> 标签：java, spring, spring-mvc, spring-security

我正在使用 Spring Security 来保护 webapp。URL 的保护方式如下：

```
<security:http entry-point-ref="authenticationEntryPoint">
  <security:intercept-url pattern="/" access="ROLE_ANONYMOUS" />
  <security:intercept-url pattern="/assets/**/*" access="ROLE_ANONYMOUS" />
  ...
  <security:intercept-url pattern="/**" access="ROLE_USER" />
  <security:anonymous granted-authority="ROLE_ANONYMOUS" />
</security:http> 
```

我有一个过滤器需要在某些情况下将用户重定向到特殊页面。但是，该页面需要资产目录中的图像和 CSS 文件，不幸的是，这些文件也会被重定向到该特殊页面。我不希望过滤器手动检查每个 URL 模式，因为我的实际 URL 配置要长得多，而且我还希望允许其他页面。

有没有办法从给定页面的过滤器中确定需要哪些角色？如果不需要 ROLE_ANONYMOUS，我可以选择不重定向。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-23T16:56:56.627

假设您使用的是 Spring Security 3，该信息的来源（为特定路径配置的属性/角色）是注入到 FilterSecurityInterceptor 中的 FilterInvocationSecurityMetadataSource。因此，如果您有特定的 URL，则可以通过将 FilterInvocation（从请求和响应创建）传递给 FilterInvocationSecurityMetadataSource 的 getAttributes() 方法来查询配置的属性。

获取对命名空间创建的内部 bean 的引用可能有点棘手。假设您有自己的 bean（或 bean）要从中进行调用，您可以通过将 BeanPostProcessor 添加到应用程序上下文中来将其注入其中，其实现方式如下：

```
public class FilterSecurityMDSExtractor implements BeanPostProcessor, BeanFactoryAware {
    private ConfigurableListableBeanFactory bf;

    public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException {
        if (bean instanceof FilterInvocationSecurityMetadataSource) {
            // Get your own bean from the BeanFactory here and inject the SecurityMetadataSource into it
        }
        return bean;
    }

    public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException {
        return bean;
    }    

    public void setBeanFactory(BeanFactory beanFactory) throws BeansException {
        this.bf = (ConfigurableListableBeanFactory)beanFactory;
    }   
} 
```

请注意，Spring Security 会在上下文中自动注册一个 WebInvocationPrivilegeEvaluator，它可用于检查用户是否能够在不实际调用特定 URL 的情况下调用它。这很相似，因为它查询 SecurityMetadataSource，但不完全是您在此处所追求的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-17T21:07:37.977

不要忘记，在决定是否允许访问时实际发生的是 URL 和现有身份验证通过一系列[AccessDecisionVoter](http://static.springframework.org/spring-security/site/apidocs/org/springframework/security/vote/AccessDecisionVoter.html)传递，其中一个默认值是[RoleVoter](http://static.springframework.org/spring-security/site/apidocs/org/springframework/security/vote/RoleVoter.html)。此投票者检查所请求资源的配置，如果需要特定角色，如果现有身份验证没有该角色，则将拒绝该请求。

因此，对于解决方案 - 您可以在角色投票者之前添加其他投票者。每个选民必须返回 GRANT、DENY 或 ABSTAIN，并且只有在返回 ABSTAIN 时才会继续处理后续的选民。因此，您可以编写自己的自定义投票器（如果可行，也可以重用现有的投票器），在角色投票器之前触发它，并无条件地授予对您所指资源的任何请求的访问权限。

我在当前项目中做过类似的事情，其中​​某些特定于应用程序的临时属性可以让某人访问通常他们无法访问的资源，并且它作为一种方法效果很好。

# silverlight - Silverlight：按钮上的透明图像

> ID：453926
> 
> 赞同：1
> 
> 时间：2009-01-17T20:05:05.480
> 
> 标签：silverlight, image, button, opacity

我想在 silverlight 按钮上使用透明的 png 文件。此外，我希望按钮本身是透明的，以便背景（按钮后面）显示出来。我发现如果我设置按钮的不透明度，它也会影响图像。我不希望整个图像都是透明的 - 只是 PNG 中定义的透明部分。

关于如何实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-18T18:57:34.970

Silverlight 支持 png 透明度。这有效：

```
<UserControl x:Class="SilverlightApplication17.Page"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
Width="400" Height="300">
<Grid x:Name="LayoutRoot" Background="Green">
<Button Width="200" Height="200">
  <Button.Content>
    <Image Source="http://wildermuth.com/images/tx_head.png" />  
  </Button.Content>
</Button> 
```

您应该看到图像对按钮背面是透明的。如果您希望按钮透明，那么您需要创建一个清晰的按钮模板。texmex5 的答案中的链接是血统的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-25T00:42:28.400

从我随后的调查来看，似乎并非所有透明的 PNG 都能正常工作。它们必须是基于 alpha 的透明胶片（而不是基于调色板）。它们还必须是至少 16 位的图像。标准的 8 位不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-15T15:27:46.340

```
<UserControl x:Class="MyProject.SilverlightControl1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
    mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400">

        <Grid x:Name="LayoutRoot" Background="Green">
            <Image Width="18" Height="18" DataContext="{Binding PrintMovementCommand}" Source="{Binding IconSource}" VerticalAlignment="Center" HorizontalAlignment="Center" ToolTipService.ToolTip="{Binding Title}" Cursor="Hand">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="MouseLeftButtonUp">
                        <i:InvokeCommandAction Command="{Binding Command}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </Image>
        </Grid>

    </UserControl> 
```

# c++ - 用于 C++ 的 Hibernate 类层

> ID：453928
> 
> 赞同：11
> 
> 时间：2009-01-17T20:05:39.163
> 
> 标签：c++, hibernate, persistence, freeze-thaw

使用带有 C++ 的 DB 真是一团糟，当我转向 Java 以便能够使用统一的系统来抽象整个层（又名 Hibernate）时，这令人耳目一新。

有几个用于 DB 的 C++ 抽象层，但它们通常是特定于供应商的，并且只有一个包装真正 C API 的薄层。有没有人遇到过类似 C++ 的休眠或知道正在研究这个问题域的组或开源项目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T23:16:19.403

我不知道任何像 Hibernate 这样的 C++ 库，但肯定有非供应商特定的库：[SOCI](http://sourceforge.net/projects/soci/)和[DTL](http://dtemplatelib.sourceforge.net/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T11:38:18.780

我感觉到你的痛苦。您将很快使用单独的库来进行数据库访问、XML 处理、线程以及应用程序通常需要的所有其他内容。出于这个原因，我经常使用 Qt，它提供了程序中经常需要的最常见的功能（数据库访问、XML 处理、线程、GUI 小部件等）。他们的 SQL 类相当不错，并且可以与许多数据库一起使用。但它不像许多对象关系映射器那样抽象 SQL。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-01-28T11:34:57.290

**我们开发了一个名为QHibernate**的开源库。

QHibernate 是用于 C++ 和 Qt 框架的 Hibernate ORM（对象关系映射）端口。当前版本是概念工作的证明。它与 PostgreSQL 9.4 和 Qt 5.4.1 一起使用。

特征

*   Qt5
*   PostgreSQL
*   类映射xml
*   类映射xml
*   休眠配置xml
*   一对多、一对一、多对一映射

您可以在此处找到一些详细信息、源代码和下载链接：[QHibernate](http://www.cstech.com.tr/en/QHibernate)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-09-21T19:38:13.793

现在有一个完全用 C++ 编写的 Hibernate 层。你可以在[edwig/CXHibernate 的 github 上找到它。](https://github.com/edwig/cxhibernate) 它带有完整的书面文档。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T21:21:36.293

如果您将 C++ 与 .Net 一起使用，请使用 nhibernate。2.0 与 hibernate 3.0 大致相同，并且非常健壮。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-30T22:00:34.337

另一种方法是 C++ 对象 <-> xml 映射，如[代码合成 xsd](http://www.codesynthesis.com/products/xsd/)
我从不喜欢直接休眠/序列化方法，如果您需要更改类，它会破坏太多。

# command-line - 从命令行编译处理草图？

> ID：453935
> 
> 赞同：2
> 
> 时间：2009-01-17T20:11:28.807
> 
> 标签：command-line, processing

我是一个盲人学生，必须在编程课上使用处理。当前的 1.01 版本是否可以从命令行编译草图文件并查看任何错误？

更新这个链接帮助我解决了我的问题，我会在有时间的时候写一篇关于它的博客文章。

[http://processing.org/discourse/yabb_beta/YaBB.cgi?board=os_core_pde;action=display;num=1224645998](http://processing.org/discourse/yabb_beta/YaBB.cgi?board=os_core_pde;action=display;num=1224645998)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-27T20:17:23.750

在翻阅修订日志后，我找到了[Commander 类](http://dev.processing.org/reference/everything/javadoc/processing/app/Commander.html)的文档，其中解释了您必须从源代码创建单独的构建才能使用命令行版本的处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-11T10:01:41.640

我没有检查处理 1.01，只检查了 1.2。在遇到同样的问题后，我终于设法让它工作了。首先使用 Windows 中的普通命令提示符您必须使用以下命令将`.java`文件编译为：`.class`

```
> javac -classpath <path to processing>/lib/core.jar *.java 
```

如果您未指定核心处理库的路径，则会收到如下错误：`package processing.core does not exist`.

下一步是将java`.class`文件压缩为`.jar`file。这可以使用以下命令完成：

```
> jar <command> file.jar {manifest.txt} *.class 
```

where the manifest file is optional. If you got some error, complaining the path wasn't defined, you need to trace the path to the java library, by using the command:

```
path c:\Program Files\Java\jdk1.5.0_09\bin;%path% 
```

If everything is ok, then You should get a jar file, which You can use on Your sketch folder.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-27T19:06:36.297

处理不是用java制作的吗？

我想你可以像往常一样用 javac 编译。

像：

javac yourclass.java

如果您正确安装了软件包，我认为 java 编译器应该很容易找到它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-27T19:57:12.387

不，我找不到从命令行编译处理文件的任何方法。尽管他们[声称](http://dev.processing.org/bugs/show_bug.cgi?id=219)已在（回复 #7）中添加了此功能，但没有提及实际是如何完成的。

我查看了关于将处理代码转换为 Java 代码的说明，并基本上添加了必要的库和包装类。当然，在实践中，您自己做似乎是不可行的（如您最初的问题所示）。

我会说你最好的选择是纠缠给定链接上的那个人，他说他添加了它，并要求提供一些关于它是如何完成的文档。此外，我认为您可以重新打开该错误，因为如果他们不告诉您如何操作，或者至少参考显示该问题讨论的手册，它就不算作错误修复。

# c# - C# 设置管理

> ID：453936
> 
> 赞同：6
> 
> 时间：2009-01-17T20:12:03.143
> 
> 标签：c#, xml, settings

当需要将常规设置加载/保存到 xml 文件时，我觉得我总是在为每个应用程序重新发明轮子。管理用户可以调整并需要保存/恢复的基本应用程序设置的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T20:18:23.863

我喜欢在 .config 文件中使用[自定义配置部分](http://www.renevo.com/blogs/dotnet/archive/2009/01/08/custom-configuration-sections-in-application-config-files.aspx)以及[加载外部 .config](http://www.renevo.com/blogs/dotnet/archive/2008/01/31/loading-config-files-from-non-default-locations.aspx)文件而不是标准的 app.config。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T20:15:50.547

你在使用 Visual Studio 吗？有一个内置的设置管理器，我发现它适用于大多数情况。只是不要忘记`Settings.Save()`在应用程序退出之前打电话。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-09T22:36:07.783

为什么人们推荐 app.config 或 web.config？它们是世界上最丑陋的文件。尝试您自己的 XML [http://www.picnet.com.au/blogs/Guido/post/2009/09/10/XML-Settings-Files-No-more-webconfig.aspx](http://www.picnet.com.au/blogs/Guido/post/2009/09/10/XML-Settings-Files-No-more-webconfig.aspx)

这种设计很容易习惯，一旦你习惯了，你就再也不会回到那些丑陋的文件了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-17T20:17:24.303

*File / New Item...*并选择*Settings*。然后，您可以配置用户和应用程序设置，VS 会生成一个类，让您可以轻松访问这些设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-08-24T18:56:39.687

可能不是“最佳”方法（例如，它重新启动 Web 应用程序），但如果您需要一些快速且肮脏的东西，例如您只需要访问/更改一些简单值的小型应用程序，请查看在

[http://www.dotnetspark.com/Forum/656-how-to-modify-webconfig-file-dynamically.aspx](http://www.dotnetspark.com/Forum/656-how-to-modify-webconfig-file-dynamically.aspx)（见拉利特的回应）

[http://ramanisandeep.wordpress.com/2009/04/07/programming-the-webconfig-file-using-c/](http://ramanisandeep.wordpress.com/2009/04/07/programming-the-webconfig-file-using-c/)

# java - seam-gen、netbeans 和完成

> ID：453960
> 
> 赞同：0
> 
> 时间：2009-01-17T20:23:36.380
> 
> 标签：java, netbeans, seam, facelets, netbeans6.5

如何使[seam-gen](http://docs.jboss.org/seam/1.1BETA2/reference/en/html/gettingstarted.html)与[NetBeans](http://www.netbeans.org/) 6.5 一起工作，以便完成标签（s:、ui:、rich:、...）工作？在 seam-gen 创建的自由形式项目中，这不起作用。如果我创建一个标准的 NetBeans Web 应用程序（文件 -> 新项目），则完成确实有效。

谢谢，米。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-24T22:49:11.787

检查您的 netbeans 日志。它可能是 facelet 解析器在richaces taglib 上崩溃。我在使用 RF v3.2.2 时遇到了这个问题，旧版本运行良好。

# sql-server-2005 - 从连接到服务器对话框中删除条目

> ID：453963
> 
> 赞同：0
> 
> 时间：2009-01-17T20:25:54.113
> 
> 标签：sql-server-2005

在 SSMSE 2005 中，一旦成功连接到 SQL Server 实例，该服务器就会出现在“连接到服务器”对话框的下拉框中。

有谁知道如何从这个列表中*删除*一个条目？

我在注册表或任何本地文件中都没有找到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T22:44:04.037

在 Vista 上删除：

```
C:\Users\<user>\AppData\Roaming\Microsoft\Microsoft SQL Server\90\Tools\Shell\mru.dat 
```

在 XP 上删除：

```
C:\Documents and Settings\<user>\Application Data\Microsoft\Microsoft SQL Server\90\Tools\Shell\mru.dat 
```

不幸的是，这会删除所有条目。我还没有找到删除单个条目的方法。

如果上述方法不起作用，我听说过：

```
C:\Users\<user>\AppData\Roaming\Microsoft\Microsoft SQL Server\90\Tools\ShellSEM\mru.dat 
```

或者

```
C:\Documents and Settings\<user>\Application Data\Microsoft\Microsoft SQL Server\90\Tools\ShellSEM\mru.dat 
```

但无法测试，因为我没有该文件夹。

有关 SQL Server 2005 管理和管理工具的文章：

[http://www.informit.com/articles/article.aspx?p=680822&seqNum=2](http://www.informit.com/articles/article.aspx?p=680822&seqNum=2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-10T08:35:06.947

对于 Windows 7：

对于使用 SQL Server 2005 后端的 SqlExpress 2008 前端，请删除以下文件：

```
C:\Users\"user"\AppData\Roaming\Microsoft\Microsoft SQL Server\100\Tools\Shell\SqlStudio.bin 
```

重新启动 SQL Server 后将重新创建此文件

# math - 为相机投影屏幕

> ID：453964
> 
> 赞同：3
> 
> 时间：2009-01-17T20:26:02.380
> 
> 标签：math, graphics, 3d, vector, raytracing

我试图通过编写一个简单的光线追踪器来学习更多关于vectormath的知识，并且我一直在阅读它，但我无法找到如何确定主光线的方向。这听起来像一个简单的问题，可能是，但以我目前的知识，我无法弄清楚。

我想我需要一个相机（只不过是一个位置和一个方向作为矢量），然后我从相机将主光线发射到相机前面的屏幕上，它代表最终图像。我无法弄清楚的是屏幕的角坐标。如果我知道屏幕，找到主光线的方向很容易。

我希望可以只使用不需要任何旋转矩阵的简单数学来计算屏幕。我最好的猜测是：

我将相机的方向作为矢量，这个方向等于投影屏幕平面的法线。所以我有屏幕的法线，从那里我可以很容易地计算出屏幕的中心，即：

```
camera_location + (normal * distance) 
```

其中距离是屏幕和相机之间的距离。但是，这就是我迷路的地方，我无法找到一种方法来确定相机任意方向的平面角坐标。

你们有人能帮我吗？如果我的方法不可能奏效，那该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T20:39:00.780

编辑：这是一些代码，与最初发布的代码相比大大减少了，因为它省略了 viewMatrix 的创建。这仅在某些扫描线渲染中需要，而不用于光线追踪。

艰苦的工作是lookat() 函数，特别是创建“上”和“右”向量。它们必须相互垂直，并且还必须垂直于眼睛和图片中心之间的矢量。这些向量的创建依赖于叉积向量函数。

投射光线的实际函数假定屏幕视口在 Y 方向上从 -0.5 运行到 +0.5。该函数非常简单，只需将“视图”、“向上”和“右”向量的正确比例相加。

```
public class Camera {

    protected Point3d       eye;
    protected Point3d       center;

    protected Vector3d      up;
    protected Vector3d      right;
    protected Vector3d      view;

    protected double        fovy;           // half FoV in radians
    protected double        tanf;
    protected double        aspect;

    public Ray castRay(double x, double y) {

        Vector3d dir = new Vector3d(view);
        Vector3d t = new Vector3d();
        t.scale(tanf * x * aspect, right);
        dir.add(t);
        t.scale(tanf * y, up);

        dir.add(t);
        dir.normalize();

        return new Ray(eye, dir);
    }

    /* algorithm taken from gluLookAt */
    public void lookAt(Point3d _eye, Point3d _center, Vector3d _up) {

        eye = new Point3d(_eye);
        center = new Point3d(_center);
        Vector3d u = new Vector3d(_up);

        Vector3d f = new Vector3d(center);
        f.sub(eye);
        f.normalize();

        Vector3d s = new Vector3d();
        u.normalize();
        s.cross(f, u);
        s.normalize();
        u.cross(s, f);

        view = new Vector3d(f);
        right = new Vector3d(s);
        up = new Vector3d(u);
    }

    /* algorithm taken from gluPerspective */
    public void setfov(double _fovy, double _aspect)
    {
        fovy = Math.toRadians(_fovy) / 2.0;
        tanf = Math.tan(fovy);
        aspect = _aspect;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T22:37:30.243

感谢您的信息。就个人而言，我对矩阵转换不太满意，并希望尽可能避免它们。但是，从您的帖子中，我了解到转换是做我想做的事情的唯一方法？那太糟糕了，因为我认为我非常接近（我得到了屏幕的法线和中心点）并且会喜欢纯矢量数学解决方案。

我将尝试采用您的代码，但不幸的是，我并不确切知道您的对象在某些时候内部发生了什么，主要是在 Matrix4d 对象中。

PS：如果您想作为问题的创建者回复 StackOverflow 上的答案，您应该对该答案发表评论，还是可以创建一个新的“答案”？

# python - 你最不合常理的代码片段

> ID：453967
> 
> 赞同：5
> 
> 时间：2009-01-17T20:27:50.427
> 
> 标签：python

我是一位经验丰富的 Python 开发新手，并且仍然发现自己正在编写正确但非 Python 的代码。我认为看到人们编写的 Python 代码的小例子在某种程度上与通常首选的做事方式发生冲突，这可能是有启发性和娱乐性的。

我对您实际编写的代码而不是发明的示例感兴趣。这是我的一个：在期望序列可能为空或无的代码中，我有

```
if data is not None and len(data) > 0: 
```

我后来把它减少到

```
if data: 
```

更简单的版本允许额外的真值，如 True 或 10，但这没关系，因为调用者犯了一个错误，并且会从 if 中的语句中得到一个异常。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T21:14:48.930

我发现手动类型检查最“unpythonic”（虽然总体上也很糟糕）。这是被滥用的两种常见情况。第一种是函数的逻辑根据参数的类型而不同。例如：

```
def doStuff (myVar):
    if isinstance (myVar, str):
        # do stuff
        pass
    elif isinstance (myVar, int):
        # do other stuff
        pass 
```

第二个是当程序员试图创建一个强类型函数时，就像你期望在静态类型语言中找到的那样。

```
def doStuff (myVar):
    if not isinstance (myVar, int):
        raise TypeError ('myVar must be of type int') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T20:40:33.677

可以从类 C 语言继承的一些非 Python 习惯：

1）不必要的分号：

```
printf "Hello world"; 
```

2）不必要的索引：

```
# Bad
for i in range(len(myList)):
    print myList[i]

# Good
for item in myList:
    print item 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-17T20:51:47.197

我的坏习惯是：

```
index = 0
for item in someCollection:
    doSomething(index, item)
    index += 1 
```

代替：

```
for index, item in enumerate(someCollection):  
    doSomething(index, item) 
```

哪个更干净:-)

另外 - 谨防简单

```
if someList: 
```

如果`someList`将成为正整数或非空字符串或其他任何内容，这可能会造成伤害。错误可能很难找到，而

```
if len(someList): 
```

会立即捕获此类错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-17T20:59:51.410

我写的最不合 Python 的代码是错误地重新发明了一些已经存在于库中或已经过大修的东西（例如 DSU 成语）——注意到这一点，把它全部撕掉，然后用（通常是）单行代码替换它感觉不错。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-17T20:31:38.983

多年来我一直在做很多 python，我更喜欢更冗长的第一个例子而不是更“pythonic”的例子。

也许这不是党的路线，但它的意图要清楚得多，并且对于可能知道也可能不知道 python 的所有小秘密的其他开发人员来说会更有意义。

ymmv

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-18T01:20:54.113

```
import random
make_token = (lambda chars, length:"".join([chars[random.randint(0,len(chars)-1)] for c in range(0, length)]))
random_token = make_token("abcdefghijklmnopqrstuvwxyz0123456789", 20) 
```

这使得长度为 20 的随机标记由输入的字符集组成。从那以后，我了解到我的方式的错误。;)

# vb6 - 旧版 Sybase Adaptive Server Anywhere 的无 DSN ODBC 连接字符串

> ID：453970
> 
> 赞同：3
> 
> 时间：2009-01-17T20:28:40.987
> 
> 标签：vb6, odbc, oledb, sybase-asa

这是对这篇文章的失败回复：[Sybase, VB and ADO](http://www.vbrad.com/article.aspx?id=94)

我刚刚做了一个连接到旧版 ASA 7 数据库的 VB6 项目。在未能完全使用 ASAProv OLEDB 提供程序（出于某种原因）和大量研究之后，这里是用于 ODBC 垫片的 OLEDB 提供程序的连接字符串，用于无 DSN 的 ODBC 驱动程序连接：

`Provider=MSDASQL.1;Driver={Adaptive Server Anywhere 7.0};CommLinks=TCPIP,SharedMemory;EngineName=<database_name>;UID=DBA;PWD=SQL`

dbeng7.exe在哪里`<database_name>`运行 db 的实例名称。检查引擎日志中的“正在启动数据库” `<database_name>`“”。

`HKLM\SOFTWARE\ODBC\ODBC.INI\<system_dsn>`您可以通过创建系统 DSN、调整设置和检查值键来找到 ODBC 连接字符串的所有有效属性名称。

可在 MSDASQL 提供程序连接字符串的 Driver 属性下使用的可用 ODBC 驱动程序是`HKLM\SOFTWARE\ODBC\ODBCINST.INI`

显然 Sybase 登录密码不区分大小写，我觉得这很有趣。

干杯
`</wqw>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-27T06:02:33.197

哇，我相信我实际上是在上个千年写的那篇文章。

让我逐点说明这一点。

1.  OLEDB 提供程序可以正常工作，我记得以前使用过它们。只需按照此处的说明操作：[http](http://www.vbrad.com/article.aspx?id=81) ://www.vbrad.com/article.aspx?id=81 ，了解如何创建连接字符串。

2.  对于 ODBC，访问[http://www.connectionstrings.com/](http://www.connectionstrings.com/)从来没有让我失望过。他们得到了连接字符串wazoo。

# php - PHP/RegEx - 预先表名的逻辑

> ID：453975
> 
> 赞同：0
> 
> 时间：2009-01-17T20:31:59.280
> 
> 标签：php, regex, logic

因此，我正在尝试构建一个脚本，该脚本会自动在有效列名前面加上适当的表前缀（例如“t.”或“r.”）

```
$t_columns = array('id', 'name', 'label');
$r_columns = array('related_value'); 
```

输入：

```
id > 1 AND (name = 'Hello' OR label IN ('World', 'Planet name AND label')) AND (related_value > 1 AND related_value < 50) 
```

输出：

```
t.id > 1 AND (t.name = 'Hello' OR t.label IN ('World', 'Planet name AND label')) AND (r.related_value > 1 AND r.related_value < 50) 
```

注意你不能做一个正常的**str_replace**。什么是最简单的代码（我猜**preg_replace**）以确保所有表名都正确添加？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T20:52:24.560

经过几秒钟的思考，这是我的解决方法：

逐个字符地遍历字符串，查找单引号，但跳过转义字符。两个未转义的单引号（即字符串）之间的内容将被替换为唯一标记，并放入关联数组中，该标记作为键，原始字符串作为值。

现在我们已经排除了字符串，为已知的列名做一个`str_replace()`（或者，如果你坚持的话）。`preg_replace()`我可能会将列名构造成一个关联数组，以表的别名作为键，将值作为包含列名的枚举数组。这样，更换可以自动化。

填写表名后，只需`str_replace()`对标记执行 a 操作，将原始字符串替换回原位，就完成了。

我敢肯定，有人可能会推出一个超级棒（而且可能几乎无法维护）的正则表达式，一键完成所有这些工作。但我更喜欢仅在正则表达式实际上是正确工具的情况下使用正则表达式，而不是 CFL 更适合的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-17T20:58:41.817

我不知道在这里使用正则表达式是否是个好主意。我会说在 PHP 中自己执行验证是值得的。然后，如果您的数据库需要任何更改，您就不必担心如何提高正则表达式的稳健性。

正如 Jamie Zawinski 曾经说过的，“有些人在遇到问题时会想‘我知道，我会使用正则表达式’。现在他们有两个问题。”

在创建将确保您使用正确的数据库的工作流方面，我会考虑采用面向对象的方法。T 和 R 表的类可以是模型类的实例化子类，该模型类负责在同一方法中使用条件逻辑而不是正则表达式来构建正确的表类型对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-09T18:09:56.920

这可以通过多种方式完成，也可以使用正则表达式。我个人会使用数组方法。首先，我会以这种方式定义修饰表：

```
$table = array(
    'id' => 't.id',
    'name' => 't.name',
    'label' => 't.label',
    'related_value' => 'r.related_value'
); 
```

这将使 str_replace() 调用更容易：

```
function mangling(&$v, $k, $table)
{
    if (($k & 1) == 0)
        $v = str_replace(array_keys($table), array_values($table), $v);
}

$spans = explode("'", ' ' . $input);
array_walk($spans, 'mangling', $table);
$output = implode("'", $spans); 
```

# coding-style - 您是否分小步进行重构？

> ID：453981
> 
> 赞同：6
> 
> 时间：2009-01-17T20:34:02.397
> 
> 标签：coding-style, refactoring

在阅读了 Fowler 的“重构”一段时间后，我仍然经常发现自己在想“我应该以更小的步骤来做这件事”。- 即使我没有破坏我的代码。

小步骤重构是安全的，但会耗费时间。这是速度和风险之间的权衡——我尝试在选择重构方式时保持战略性。

尽管如此：大多数时候我都在以更大的步骤进行重构。如果我拿 Fowler 的一些“力学”部分来比较我的工作方式，我可能会发现我经常一次向前跳跃两到五步。这并不意味着我是重构大师。我的代码可能会停留 5 - 60 分钟损坏或无法编译。

您是否以较小的步骤进行重构并尝试以较短的频率生成完整的代码？并且：你在这方面成功了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-17T20:48:25.473

Martin Fowler 似乎倾向于小而渐进的重构方法。然而，在阅读了他的书之后，他偶尔会采取一些激烈的步骤，但*只是*通过单元测试来备份代码。

> 重构是一种用于改进现有代码库设计的受控技术。它的本质是应用一系列小的行为保持转换，每一个都“太小而不值得做”。然而，这些转变中的每一个的累积效应都非常显着。通过小步骤进行操作，您可以降低引入错误的风险。您还可以避免在执行重构时系统损坏 - 这使您可以在很长一段时间内逐步重构系统。——[马丁·福勒](http://martinfowler.com/books.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-17T20:42:28.260

我尝试 :) 在重构过程中，我最需要抵制的一个冲动实际上是在此过程中进行其他更改。假设我正在重构一些代码并在代码中看到一些不相关的东西。我必须有意识地努力不要去“修复”它。记下它并继续前进。一方面，它分散了手头任务的注意力。它最终还会污染您的更改集，因此您的提交消息现在必须记录几个看似随机的更改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-17T20:59:10.473

是的，总是。我认为重构的真正本质是选择从哪些步骤开始。

我发现以安全的方式重构大的变化总是要对你想去的地方有一个相当清晰的了解。然后考虑您现有的系统，并尝试找出您可以引入哪些最不可能发生根本性变化的部分。然后，您可以以受控且经过充分测试的方式介绍这些内容。

所以你要做的就是在肮脏的地方工作。并不总是直接从正面进攻，但有时只是切掉小块。通常我会等待，并且只在几轮消除轻微的肮脏之后才去争取“大奖”。但我知道*我*想去哪里。

以这种方式工作的好处是您可以保持进步。您永远不会“停止开发以进行重构”。可以说，在某些情况下停止是正确的情况，但大多数情况下并非如此。

这里的想法是，如果您从兑现奖金“开始”，您将在接下来的 X 天里做苦差事。并且存在风险，也许你会退缩或者它不起作用 - 或者花费 6 个月而不是一周。如果您先做苦差事，则可以以较小的风险兑现奖金。你的代码会随着你的进步而改进。有时你可以决定做一半的工作就足够了，因为你对问题的理解增加了。有时，你想去哪里的想法有点拙劣，你可以随着你的进步重新调整你的目标。

但它很容易直接获得奖励。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-17T20:39:42.760

大多数时候我倾向于大步重构，这样我就可以从树上看到森林。这是一种“意识流”的编程。只要您选择的源代码控制中的最后一个工作版本安全...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-17T20:41:47.623

这就是“红、绿、重构”方法有用的地方。在每个阶段，您都可以验证代码的行为是否未发生变化，并且重构只需集成新的行为。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-17T20:42:55.670

我使用的经验法则是用测试重构，并且只重构你有信心的代码。

在 60 分钟时，您确定您的代码完全按照应有的方式运行。你需要很多测试才能通过。我会试着让一个开始，然后继续下一个。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-17T20:44:48.507

如果我对自己想要做什么有一个清晰的认识，并且如果我可以轻松地验证我之后没有破坏任何东西，那么我正在采取更大的步骤。

如果重构更复杂，我会尝试将其分解为更小的步骤，并在每个步骤之后进行大量测试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-17T21:01:25.913

我通常在更改代码时对其进行重构。也就是说，我不是采用一段代码并在保持其功能的同时对其进行重写，而是将其重写为新功能，并在此过程中改进代码的设计。

这通常意味着当我实现该功能时，我还没有对旧代码进行完整且令人满意的重构。虽然它有所改进，我知道下次我要更改它的功能时，我会有时间进一步改进它。

对于测试，这意味着我可以同时测试重构和新功能，这应该可以节省一些时间。

这也意味着我只在重构上花费足够的时间来改善该特定功能所需的维护情况。这应该有助于避免过度工程和/或浪费时间重构已经有效且不会从更好的设计中受益的东西。通过只关注我无论如何都会更改的代码，我很有可能会在不久的将来重新访问该代码，以便在用户注意力范围内进行进一步的更改。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-17T21:19:47.373

小的离散步骤是我最舒服的，尽管在某些时候它可以是我在重构血洗中统治的自我控制能力的测试。如果我注意到可以进行的任何改进（无论有多大），我都会记下它们并考虑如何将其拆分为单独的重构任务。另外，在提交消息中进行大量更改也无济于事。

注意。我工作的代码库已经很老了，而且充满了以科学家命名的神秘错误。由于大部分测试覆盖率甚至接近 50% 仍然缺乏任何东西，因此得意忘形是粗心的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-08-05T19:03:53.810

是的。我喜欢不断地运行测试，所以一连串的小重构效果很好。我的代码一次被破坏超过几分钟我真的很不舒服，如果我晚上回家时我的代码被破坏了，我通常会恢复，第二天早上重新编写总是比试图拿起哪里更好我曾是。

# iphone - 自定义 iPhone 图标

> ID：453989
> 
> 赞同：0
> 
> 时间：2009-01-17T20:39:04.930
> 
> 标签：iphone, icons

这不是一个技术问题，但鉴于这里有一些 iPhone 开发人员，我想我会问。是否有设计公司为设计定制 iPhone 图标做广告服务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-17T21:03:03.493

我相信你可以在网上找到很多，只需谷歌它。

[Icon Factory](http://iconfactory.com/design/)和[IconShock](http://www.iconshock.com/professional-icons.php)是我的最爱之一，但有些人可以为您提供所需的价格，**只要问他们**，看看**[Made By Sofa](http://www.madebysofa.com/#work)**公司制作的图标，我真的很喜欢它们，并且我建议你直接联系他们，他们在市场上制作了非常有名的图标！

但对于 iPhone，您需要一个 75x75 像素的 PNG 格式图标，圆形曲线由 iPhone 操作系统自动生成。

您可以使用网页对其进行测试，只需在您的 HTML 页面（标题部分）中添加这行代码：

```
<link rel="apple-touch-icon" href="myIcon.png" /> 
```

并使用 iPhone 或 iPod Touch 将其添加到主页

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-18T02:43:15.850

任何平面设计师都可以制作 iPhone 图标。不需要专门的技能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-17T20:53:25.027

一个快速的谷歌发现[SoftFacade](http://www.softfacade.com/)和[FastIcon](http://fasticon.com)。不过，我认为您不需要只寻找“iphone 图标”艺术家。如果你能找到你喜欢的图标，就很容易让它[看起来像](http://www.photoshopvids.com/photshop-tutorials/photoshop-tutorial-how-to-make-iphone-icons/)[iphone](http://tutorials20.com/design/design-your-iphone-widgets/) 。

# c - POSIX C API 函数的列表在哪里？

> ID：453993
> 
> 赞同：28
> 
> 时间：2009-01-17T20:40:17.297
> 
> 标签：c, posix

我正在尝试找出在哪里可以找到有关 POSIX 函数的文档，但没有找到。有什么建议吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-17T20:47:26.877

[POSIX 1003.1-2008](http://www.opengroup.org/onlinepubs/9699919799/toc.htm)现已在网络上提供（它的所有 3872 页，PDF 和 HTML）。您必须注册（免费）。我是从[Open Group Bookstore](http://www.opengroup.org/bookstore/catalog/c082.htm)得到的。

请参阅[How to Portably scanf into a pid_t in C](https://stackoverflow.com/questions/437802/how-to-portably-scanf-into-a-pidt-in-c#437814)以获取包含此信息的我的原始答案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-17T20:47:31.993

严格来说，POSIX 函数的最终列表是 POSIX 标准文档本身。

[对 POSIX 的全部内容进行了很好的介绍，并提供了指向Wikipedia](http://en.wikipedia.org/wiki/POSIX)上大量参考资料的链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-23T07:11:47.137

**用于 grepping 的压缩版 HTML**

*   [http://pubs.opengroup.org/onlinepubs/9699919799/download/](http://pubs.opengroup.org/onlinepubs/9699919799/download/)
*   [http://pubs.opengroup.org/onlinepubs/9699919799/download/susv4tc2.zip](http://pubs.opengroup.org/onlinepubs/9699919799/download/susv4tc2.zip)

当您开始想要 grep 而不为 PDF 付费时，这些很有用。

[乔纳森](https://stackoverflow.com/questions/453993/is-there-a-listing-of-the-posix-api-functions/454007?noredirect=1#comment78623115_454007)提到。

# sql-server-2005 - 删除数据库及其服务

> ID：453998
> 
> 赞同：0
> 
> 时间：2009-01-17T20:42:49.150
> 
> 标签：sql-server-2005

我被分配了从某个服务器上删除一些数据库的任务。

删除数据库很容易：http: [//msdn.microsoft.com/en-us/library/ms177419.aspx](http://msdn.microsoft.com/en-us/library/ms177419.aspx)

似乎控制面板>管理工具>服务中的每个数据库都有一项服务

我怎样才能删除那些？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-17T20:44:52.017

我认为您指的是实例。

您可以只使用添加/删除程序并选择 SQL Server 2005。它会给您一个实例列表，您可以选择删除/卸载。**************