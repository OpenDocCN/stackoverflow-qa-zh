# StackOverflow 问答 000923000-000923999

# git - git 是否支持 Subversion 等任意属性的版本控制？

> ID：923001
> 
> 赞同：5
> 
> 时间：2009-05-28T20:31:41.830
> 
> 标签：git, version-control

我知道通过颠覆，您可以将任意属性附加到每个文件。

在 Subversion 中，某些属性具有特殊含义，它们是“svn:”命名空间中的属性，但您可以将任意属性附加到文件。

我想知道 git 或任何其他分布式版本控制系统是否支持此功能。

任何其他版本控制系统（分布式或集中式）都支持类似于颠覆属性的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T20:46:28.087

最接近的事情是[`gitattributes`](http://git-scm.com/docs/gitattributes)

```
 $GIT_DIR/info/attributes, .gitattributes 
```

> 文件是一个`gitattributes`简单的文本文件，它为路径名提供属性。
> 文件中的每一行`gitattributes`格式为：

```
pattern attr1 attr2 ... 
```

> 也就是说，一个模式后跟一个属性列表，用空格分隔。
> 当模式与相关路径匹配时，将行上列出的属性赋予路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-26T06:49:26.920

可以将您想要的任何属性添加到 git 属性文件中。然后，您可以使用 查询值[`git-check-attr`](http://www.kernel.org/pub/software/scm/git/docs/git-check-attr.html)。据我所知，*没有*相应`git-set-attr`类型的函数，您必须直接更新 git 属性文件。

用于`.gitattributes`将受版本控制并在存储库被克隆、拉取等时移动的属性。

用于`$GIT_DIR/info/attributes`在版本历史转移到另一个存储库时不会移动的“私有”属性。

# jquery - 自动淡出（点击）和自动（几秒钟后）

> ID：923008
> 
> 赞同：0
> 
> 时间：2009-05-28T20:32:49.427
> 
> 标签：jquery

```
 $('<div class="error"></div>').html('<h2>(click here to dismiss)</h2>').insertAfter($('#someid')).fadeIn('slow').animate({ opacity: 1.0 }, 1000).click(function() {
       $(this).fadeOut('slow', function() {
           $(this).remove()
       })
   }); 
```

有没有办法将它与：

```
$('#someid').animate({opactiy: 1.0 } fadeOut('slow', function() {
            $(this).remove()
        }); 
```

换句话说就是组合它，所以当他们不点击它时，它仍然会在几秒钟后消失..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T21:04:05.243

我不确定是否有一种将所有这些链接在一起的好方法，所以它发生在一个命令中。但是，您可以在单独的行上使用 setTimeout 以在另一个语句中实现相同的效果。例如，在您的第一个语句之后：

```
setTimeout(function() {
    if ($('#someid').css('opacity') == 1.0) {
        // Fade out has not started yet
        $('#someid').animate({opactiy: 1.0 } fadeOut('slow', function() {
            $(this).remove()
        });
    }
}, 3000); // setTimeout counted in ms, not seconds 
```

我同意将所有内容链接在一起可能更优雅，但我不知道这样做的好方法。

作为旁注，您可以在 Javascript 中的方法名称之间有任意多的空格，因此您可以将原始语句分成多行以获得更好的可读性，例如

```
$('<div class="error"></div>')
    .html('<h2>(click here to dismiss)</h2>')
    .insertAfter($('#someid'))
    .fadeIn('slow')
    .animate({ opacity: 1.0 }, 1000)
    .click(function() {
   $(this).fadeOut('slow', function() {
       $(this).remove()
   }) 
```

});

但这是一个偏好问题。

# asp.net-mvc - 在 Entity Framework v1 中处理查找表

> ID：923009
> 
> 赞同：3
> 
> 时间：2009-05-28T20:33:19.987
> 
> 标签：asp.net-mvc, entity-framework

我刚刚开始使用 Microsoft 的 Entity Framework，将它用于 MVC 项目，因为 MS 似乎真的在推动它，我遇到了一些问题。在我的数据库中，有多个查找表通过外键绑定到单个表。在实体框架中，我试图将它们组合成一个，以便在我的模型中为这些数据提供一个简化的单一视图。但是，从设计者的角度来看，这似乎是不可能的。我有什么明显的遗漏吗？有没有办法可以手动编辑 edmx 文件来生成这种模型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T20:58:27.330

**目前，实体框架中的外键和查找表是一个难题。**

带有 LINQ 的 EF*让*您的数据变得超级容易，并且表面上*看起来*很容易更新，但是使用查找表时事情变得很困难（现在......继续阅读......）

我不确定您如何将查找表“组合”成一个表。如果每个表都包含不同类型的“查找实体”，那么恕我直言，它们应该在您的 EDM 中单独表示。我猜您在将记录的外键更新到查找表时很头疼。那是因为它很头疼。

**更改外键值：**

```
MyDBEntities _db = new MyDBEntities();
//get a Person
MyDBEntities.Person person = (from p in _db.Persons
                      where p.Id = 1
                      select p).First();
// This sets the foreign key value in the Person table on the PersonType field
person.PersonTypeReference = new EntityKey("MyDBEntities.PersonType", "PersonTypeId", 3) 
```

实体框架的[下一个发布版本](http://blogs.msdn.com/efdesign/archive/2009/03/16/foreign-keys-in-the-entity-framework.aspx)将有一个名为“FK 关联”的新概念。这将恢复直接设置外键值的合理性，而不必创建和设置 EntityKey。

HTH。

# authentication - 使用 Web 引用的 HTTP 身份验证

> ID：923015
> 
> 赞同：1
> 
> 时间：2009-05-28T20:34:59.750
> 
> 标签：authentication, soap-client

我有一个从 WSDL 创建的 Web 引用，但除非我传入用户名/密码，否则我不能调用该函数；XML 工具包的原始代码是：

```
Set client = CreateObject("MSSOAP.SOAPClient30")
URL = "http://" & host & "/_common/webservices/Trend?wsdl"

client.mssoapinit (URL)

client.ConnectorProperty("WinHTTPAuthScheme") = 1
client.ConnectorProperty("AuthUser") = user
client.ConnectorProperty("AuthPassword") = passwd

On Error GoTo err
Dim result1() As String

result1 = client.getTrendData(expression, startDate, endDate, 
              limitFromStart, maxRecords 
```

如何将 AuthUser/AuthPassword 添加到我的新代码中？

新代码：

```
 ALCServer.TrendClient tc = new WindowsFormsApplication1.ALCServer.TrendClient();

    foreach(string s in tc.getTrendData(textBox2.Text, "5/25/2009", "5/28/2009", false, 500))
        textBox1.Text+= s; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T21:22:26.920

找到它：即使 Preauthenticate==True，它也不会这样做。您必须覆盖 WebRequest：

```
 protected override System.Net.WebRequest GetWebRequest(Uri uri)
    {
        HttpWebRequest request;
        request = (HttpWebRequest)base.GetWebRequest(uri);

        if (PreAuthenticate)
        {
            NetworkCredential networkCredentials =
                Credentials.GetCredential(uri, "Basic");

            if (networkCredentials != null)
            {
                byte[] credentialBuffer = new UTF8Encoding().GetBytes(
                    networkCredentials.UserName + ":" +
                    networkCredentials.Password);
                request.Headers["Authorization"] =
                    "Basic " + Convert.ToBase64String(credentialBuffer);
            }
            else
            {
                throw new ApplicationException("No network credentials");
            }
        }
        return request;
    } 
```

由于它是作为部分类创建的，因此您可以将存根保存在单独的文件中，并且重建 Reference.cs 不会影响您。

# asp.net - 使用 ASP.net MVC 时应该如何设置我的解决方案？

> ID：923019
> 
> 赞同：0
> 
> 时间：2009-05-28T20:35:49.343
> 
> 标签：asp.net, asp.net-mvc

使用 ASP.net 网络表单时，我通常的解决方案将具有以下类型的设置 -

1.  MyCompany.MyProject.Presentation.MyWebFormsApp（asp.net 网络表单）
2.  MyCompany.MyProject.Service.MyServieLayer（WCF/Web 服务）
3.  MyCompany.MyProject.Business.MyBusinessLogicLayer（类项目）
4.  MyCompany.MyProject.DataAccess.MyDALayer（类项目/Linq2SQL/NHibernate == DataModel）
5.  MyCompany.MyProject.DataTransferObjects.MyDomainLayer（类项目）
6.  {一大堆测试项目}

在使用 ASP.net MVC 时，我使用过这种解决方案分解 -

1.  MyCompany.MyProject.Presentation.MyMVCApp（ASP.net MVC 项目）
2.  MyCompany.MyProject.DataAccess.MyDALayer（类项目/Linq2SQL/NHibernate == DataModel）
3.  {一大堆测试项目}

**问题** 在 AP.net MVC 设置中，如何连接我的 DomainObjects/DTO/POCO 和 WCF/Web 服务层？如果我想保留我用于 WebForms 的解决方案，我会失去任何功能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T21:13:16.740

ASP.NET MVC 项目应该只在 Web 项目中有所不同，其他一切都应该保持不变。在 Web 项目中，您在 Web 表单应用程序中拥有的常规页面现在将拆分为控制器和视图。

# javascript - 如何选择第二 使用javascript的元素？

> ID：923025
> 
> 赞同：5
> 
> 时间：2009-05-28T20:37:00.573
> 
> 标签：javascript, html

使用 JavaScript，我怎样才能动态更改以下列表项之一：

```
<ul class="tabbernav">
<li class="tabberactive"><a title="All">All</a></li>
<li class=""><a title="One">One</a></li>
<li class=""><a title="Two">Two</a></li>
<li class=""><a title="Three">Three</a></li>
</ul> 
```

至

```
<ul class="tabbernav">
<li class="tabberactive"><a title="All">All</a></li>
<li class=""><a title="One">One</a></li>
<li class=""><a title="Two">-----------NEW LIST ITEM CHANGED---------</a></li>
<li class=""><a title="Three">Three</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T20:45:23.113

我想您可以在 ul 中使用 getElementsByTagName 来获取数组中的所有列表项。然后您可以编辑数组中的第三个元素，索引号为 2。

```
var lItems = document.getElementsByTagName("ul").getElementsByTagName("li");
lItems[2].innerHTML = "<a title='Two'>----NEW LIST ITEM CHANGED-----</a>"; 
```

这当然会得到页面上的所有 ul 元素，如果您的文档中有两个以上的 ul，可能会导致一些奇怪的结果。但你明白了，对吧？如果您不明白我要说什么，请再问一些。

好的，上面的代码并不能正常工作。我稍微修改了我的代码，但这也包括对您的 HTML 的更改，因为我认为您只有一个 ul“tabbernav”，因此我将其`class="tabbernav"`从`id="tabbernav"`. 这是做你想做的事情的代码。

```
var ul = document.getElementById("tabbernav");
var liArray = ul.getElementsByTagName("li");

for (var i = 0; i < liArray.length; i++) {
    if(liArray[i].childNodes[0].title == "Two") {
        liArray[i].innerHTML = "Your desired output";
    }
} 
```

希望对你有更多帮助:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T20:49:06.070

我还建议使用 jQuery，它可以使这样的选择变得微不足道。在您的情况下，您可以使用 :eq 伪选择器来获取第二行元素：

```
$('.tabbernav li:eq(1)') 
```

这将选择作为tabbernav 类的元素中的*第二个li（索引从 0 开始）的 DOM 元素。*它返回一个 jQuery 对象，您可以将其他方法链接到该对象。更改内部 HTML 是使用 .html('Your html here') 完成的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-29T10:52:19.330

```
var list = document.getElementsByTagName("li");
list[2].innerHTML = "<a title='Two'>------NEW LIST ITEM CHANGED----</a>"; 
```

这将完美无缺

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-11T00:22:41.790

这就是您在纯 JavaScript 中选择 Ul 列表的第三个 Li 元素的方式。

```
document.querySelectorAll("li")[2].innerHTML = "vasile"; 
```

将“Vasile”替换为您想要的文本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-11T07:19:40.500

我知道这个问题很老，但由于它仍然是开放的，看看我是如何修改第一个答案的。我觉得其他人可能需要它。

```
>var lItems = document.getElementsByTagName("ul")[0];
>>var nth = lItems.getElementsByTagName("li")[2];
>>>nth.innerHTML = "<a title='Two'>----NEW LIST ITEM CHANGED-----> </a>"; 
```

所以这基本上通过指定lItems的位置来解决它，特别是在这种情况下为[0]。如果缺少该位置，代码将无法正常工作，因为 getElementsByTagName(NAME) 返回带有指定 NAME 的 html 元素的集合。因此，如果您不指定其中的哪一个，代码就会失败。

如果您喜欢代码重用，请查看您可以使用的功能。您只需要指定父元素及其位置和 childNode 位置，就可以得到相同的结果。

```
>var nthChild = function(parent, pos, childPos){
>>parent = document.getElementsByTagName(parent)[pos];
>>>return parent.children[childPos];
>>>>};
//used thus:
>nthChild("ul", 0, 2).innerHTML = "<a title='Two'>----NEW LIST ITEM CHANGED-----> </a> 
```

* * *

";

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T20:44:06.330

你如何确定哪个`<li>`是你想要修改的？

如果你是按索引来做的，我认为你可以做这样的事情：

```
var list = document.getElementById("listid");
list.childNodes[2].innerHtml = "<a title='Two'>-----------NEW LIST ITEM CHANGED---------</a>"; 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-28T20:42:55.520

研究使用 Javascript 库，例如 JQuery。这会让你的生活轻松很多。然后你可以做这样的事情：

```
$('li a[title=Two]').text('Changed Text Goes Here'); 
```

您需要检查我的语法（不确定`text()`函数），但在 JQuery 的 api 文档中查找很容易。

# postgresql - 在 postgres 中使用 table.column%type-argument 获取有关函数的元数据

> ID：923026
> 
> 赞同：1
> 
> 时间：2009-05-28T20:37:22.833
> 
> 标签：postgresql, metadata

是否可以找出 postgres 中函数中的参数是否定义为

```
table.column%type foo 
```

或者

```
sometype foo 
```

查询例如 pg_proc?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T23:21:04.437

中的`proargtypes`列`pg_proc`是所有函数参数类型的数组。然后可以将每种类型交叉引用到`pg_type.oid`.

所以如果我定义一个这样的函数：

```
steve@steve@[local] =# create function testfunc(pg_proc.proname%type) returns boolean language 'sql' immutable strict as $$ select true $$;
NOTICE:  type reference pg_proc.proname%TYPE converted to name
CREATE FUNCTION 
```

嗯，那个通知是不是太有希望了。

该函数的 pg_proc 条目是：

```
 proname  | proargtypes
----------+-------------
 testfunc | 19 
```

类型 19 只是“名称”。所以看起来这里的答案是“不”，恐怕。

# powershell - 通过 PSEXEC 运行时，Powershell 未加载配置文件

> ID：923027
> 
> 赞同：0
> 
> 时间：2009-05-28T20:37:24.487
> 
> 标签：powershell, profile, powershell-1.0, psexec

我正在使用 PSEXEC 使用 powershell 1.0 远程运行脚本（或以批处理模式在同一个盒子上）。在我的机器上，“远程”powershell 会话正确加载了我的 profile.ps1（来自 MyDocuments 文件夹），但在另一台机器上却没有。我没有将 -noprofile 开关传递给 powershell.exe，并且我已经验证了 powershell 会话实际上是经过网络身份验证的（我让它在服务器上访问了管理员共享并且工作得很好）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T20:39:10.957

没关系。另一台机器上运行的不同 PSEXEC 版本。

# clojure - Clojure：从文件中读取结构失败，字符串属性包含空格

> ID：923029
> 
> 赞同：7
> 
> 时间：2009-05-28T20:38:00.273
> 
> 标签：clojure

我刚刚开始使用 Clojure，我想我会尝试的第一件事是存储和检索结构列表，就像[这里](http://github.com/stuarthalloway/practical-cl-clojure/blob/1c2f138bda5e73ebbbafbc2cea7e5cd14ec335c4/pcl/chap_03/chap_03.clj)的 Suart Halloway 的示例一样。

如果我在属性字符串中使用没有空格的结构实例，则我的结构散列的吐出/啜饮效果很好，如下所示：

```
(struct customer "Apple" "InfiniteLoop") 
```

但如果我使用这个：

```
(struct customer "Apple" "Infinite Loop 1") 
```

我收到一个错误：

```
Exception in thread "main" clojure.lang.LispReader$ReaderException: java.lang.ArrayIndexOutOfBoundsException: 7 (test-storing.clj:19)
    at clojure.lang.Compiler$InvokeExpr.eval(Compiler.java:2719)
    at clojure.lang.Compiler$DefExpr.eval(Compiler.java:298)
    at clojure.lang.Compiler.eval(Compiler.java:4537)
    at clojure.lang.Compiler.load(Compiler.java:4857)
    at clojure.lang.Compiler.loadFile(Compiler.java:4824)
    at clojure.main$load_script__5833.invoke(main.clj:206)
    at clojure.main$init_opt__5836.invoke(main.clj:211)
    at clojure.main$initialize__5846.invoke(main.clj:239)
    at clojure.main$null_opt__5868.invoke(main.clj:264)
    at clojure.main$legacy_script__5883.invoke(main.clj:295)
    at clojure.lang.Var.invoke(Var.java:346)
    at clojure.main.legacy_script(main.java:34)
    at clojure.lang.Script.main(Script.java:20)
Caused by: clojure.lang.LispReader$ReaderException: java.lang.ArrayIndexOutOfBoundsException: 7
    at clojure.lang.LispReader.read(LispReader.java:180)
    at clojure.core$read__4168.invoke(core.clj:2083)
    at clojure.core$read__4168.invoke(core.clj:2081)
    at clojure.core$read__4168.invoke(core.clj:2079)
    at clojure.core$read__4168.invoke(core.clj:2077)
    at chap_03$load_db__54.invoke(chap_03.clj:71)
    at clojure.lang.AFn.applyToHelper(AFn.java:173)
    at clojure.lang.AFn.applyTo(AFn.java:164)
    at clojure.lang.Compiler$InvokeExpr.eval(Compiler.java:2714)
    ... 12 more
Caused by: java.lang.ArrayIndexOutOfBoundsException: 7
    at clojure.lang.PersistentArrayMap$Seq.first(PersistentArrayMap.java:216)
    at clojure.lang.APersistentMap.hashCode(APersistentMap.java:101)
    at clojure.lang.Util.hash(Util.java:55)
    at clojure.lang.PersistentHashMap.entryAt(PersistentHashMap.java:134)
    at clojure.lang.PersistentHashMap.containsKey(PersistentHashMap.java:130)
    at clojure.lang.APersistentSet.contains(APersistentSet.java:33)
    at clojure.lang.PersistentHashSet.cons(PersistentHashSet.java:59)
    at clojure.lang.PersistentHashSet.create(PersistentHashSet.java:34)
    at clojure.lang.LispReader$SetReader.invoke(LispReader.java:974)
    at clojure.lang.LispReader$DispatchReader.invoke(LispReader.java:540)
    at clojure.lang.LispReader.read(LispReader.java:145)
    ... 20 more 
```

根据结构中字段的数量，我也可能只是将字符串的一部分作为属性名称而不是错误。例如：循环 1

我使用这样的存储功能：

```
(defn store-customer-db [customer-db filename]
  (spit filename (with-out-str (print customer-db)))) 
```

和这样的读取功能：

```
(defn load-db [filename]
  (with-in-str (slurp filename)(read))) 
```

从 spit 的输出文件中，我可以看到 print 没有给字符串加上双引号，这似乎是 slurp 的问题。什么是正确的解决方案？

我的 Clojure 版本是 1.0，contrib 是几周前的快照。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-29T19:23:50.343

`print`并且`println`用于人类可读的输出。如果您想打印一些稍后会再次读取的内容，请使用`pr`或`prn`。

```
user> (read-string (with-out-str (prn {"Apple" "Infinite Loop"})))
{"Apple" "Infinite Loop"} 
```

然而：

```
user> (read-string (with-out-str (print {"Apple" "Infinite Loop"})))
java.lang.ArrayIndexOutOfBoundsException: 3 (NO_SOURCE_FILE:0) 
```

它正在尝试运行此代码：

```
(read-string "{Apple Infinite Loop}") 
```

它有奇数个键/值。请注意单个哈希键/值周围缺少引号。即使此读取有效（即，如果您碰巧提供了偶数个参数），它读取的也不会是一个充满字符串的哈希映射，而是符号。所以你会得到除了你输出的东西之外的东西。

```
user> (map class (keys (read-string (with-out-str (print {"foo bar" "baz quux"})))))
(clojure.lang.Symbol clojure.lang.Symbol) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T03:14:57.293

对于，说：

```
(def hashed-hobbits {:bilbo "Takes after his Mother's family" :frodo "ring bearer"}) 
```

你只需要：

```
(spit "hobbitses.txt" hashed-hobbits) 
```

并读回来：

```
(def there-and-back-again (read-string (slurp "hobbitses.txt"))) 
```

spit/slurp 将其全部包装在一个字符串中，但在 slurp 上使用 read-string 会将字符串解释回 clojure 代码/数据。也适用于巨魔数据结构！

# java - 如何使用 ExecutorService 跟踪任务执行统计信息？

> ID：923033
> 
> 赞同：10
> 
> 时间：2009-05-28T20:38:54.407
> 
> 标签：java, concurrency, statistics, monitoring

我正在使用 ExecutorService 启动任务，调度需要按任务特定标准分组的任务：

```
Task[type=a]
Task[type=b]
Task[type=a]
... 
```

我想定期输出每个任务花费的平均时间长度（按 分组`type`）以及平均/中位数和标准偏差等统计信息。

当然，这需要非常快，并且理想情况下不应导致各个线程在报告统计信息时同步。这样做的好架构是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-28T20:50:11.467

[ThreadPoolExecutor](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)提供了可以覆盖的[beforeExecute](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html#beforeExecute(java.lang.Thread,%20java.lang.Runnable))和[afterExecute方法。](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html#afterExecute(java.lang.Runnable,%20java.lang.Throwable))您可以使用它们在单个（ExecutorService 的成员变量）[ConcurrentHashMap](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)中记录您的统计数据，该数据键控您的任务的一些唯一标识符，并存储类型、开始时间和结束时间。

`ConcurrentHashMap`从您准备好查看统计数据开始计算统计数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T20:51:22.103

子类化[Thread Pool Executor](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)并跟踪执行事件：

*   从[beforeExecute开始](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html#beforeExecute%28java.lang.Thread,%20java.lang.Runnable%29)
*   在[afterExecute结束](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html#afterExecute%28java.lang.Runnable,%20java.lang.Throwable%29)

值得注意的是，这些方法是由执行任务的工作线程调用的，因此您需要确保执行跟踪代码的线程安全。

此外，您将收到的 Runnables 很可能不是您的 Runnables，而是包装在 FutureTasks 中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-03T08:31:56.543

另一种方法是使用包装器/装饰器模式。

```
public class Job implements Runnable {
private Runnable _task;
private Statistics _statistics;

public Job(Runnable task, Statistics statistics) {
    this._task = task;
}

public void run() {
    long s = System.currentTimeMillis();
    _task.run();
    long e = System.currentTimeMillis();

    long executionTime = e - s;
    _statistics.updateStatistics(executionTime);
}
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T22:01:12.743

我相信另外两个答案是正确的，但可能有点太复杂了（尽管我的答案虽然简单，但可能不如他们的答案那么好。

为什么不只使用原子变量来跟踪您的统计数据？例如运行的任务数，总执行时间（除以总数，你得到平均执行时间）。将这些变量传递到每个任务的 Runnable 中。除非您的任务非常短暂，否则我认为锁定 Atomic 变量的开销不会影响您。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-15T12:20:06.840

我同意@Robert Munteanu。尽管文档说它可以用于统计，但线程池中的`beforeExecute`线程池确实一文不值。但实际上，我们无法在我们的情况下检查 runnable 的身份。

我认为一个包装可以到达这个。

```
public interface ICallableHook<V> {
    void beforeExecute(Thread t, Callable<V> callable);
    void afterExecute(Callable<V> callable, V result, Throwable e);
}

private class CallableWrapper<V> implements Callable<V> {
        private ICallableHook hooker;
        private Callable<V> callable;

        CallableWrapper(Callable callable, ICallableHook hooker) {
            this.callable = callable;
            this.hooker = hooker;
        }

    @Override
    public V call() throws Exception {
        if (hooker != null) {
            hooker.beforeExecute(Thread.currentThread(), callable);
        }

        V result = null;
        Exception exception = null;
        try {
            result = callable.call();
        } catch (Exception e) {
            exception = e;
            throw e;
        } finally {
            if (hooker != null) {
                hooker.afterExecute(callable, result, exception);
            }
        }
        return result;
    }
} 
```

这样的用法，

```
 for (Callable<XXX> callable : callableList) {
        CallableWrapper<XXX> callableWrapper = new CallableWrapper<>(callable, hooker);
        Future task = completionService.submit(callableWrapper);

    } 
```

# vb.net - 缩放对象大小视口-> 预览

> ID：923037
> 
> 赞同：2
> 
> 时间：2009-05-28T20:39:22.267
> 
> 标签：vb.net, scaling

我玩弄了一个项目，我可以在其中将对象运行时定位在屏幕上。我还有一个小的“预览”窗口，我想在其中查看对象的轮廓。

我有一个在“场景”上有大小和位置的对象数组。现在我想遍历我的场景对象并在预览窗口中为“场景”中的每个对象创建一个图片框。

所以，我有“场景”的大小和场景中可见的对象数组。每个对象都有映射到场景的大小和位置。

我还有一个具有动态大小的预览窗口。如何创建缩小到预览窗口的预览？为方便起见，我循环遍历场景中的场景对象，并在预览表单上为每个对象创建一个图片框，该图片框使用预览表单大小进行缩放。

```
SceneSize=new size(800,600) 
PreviewSize=new size(80,60) 

For each obj as SceneObject in Scene
   dim p as new picturebox
    p.size=?? scaling here (we have obj.size and obj.location)
    p.location=?? scaling here (we have obj.size and obj.location)
    previewWindow.controls.add (p)

next 
```

.Net 中的任何示例都会很好。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T03:59:26.570

Bob Powell 在 GDI+ 上的网站可能有一些关于如何进行的有用信息。查看他关于矩阵变换的页面。本文可能会为您提供一些关于如何进行的好主意

[鲍勃·鲍威尔 GDI+ 转型](https://web.archive.org/web/20130312094930/http://www.bobpowell.net/transformations.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T00:28:57.467

这成功了，它并不比这更难。

```
Function GetPreviewRectangleForObject(ByVal ScreenSize As Size, ByVal PreviewSize As Size, ByVal OriginalRect As Rectangle) As Rectangle
    Dim xFactor As Integer = ScreenSize.Width / PreviewSize.Width
    Dim yFactor As Integer = ScreenSize.Height / PreviewSize.Height
    With OriginalRect
        Return New Rectangle(.X / xFactor, .Y / yFactor, .Width / xFactor, .Height / yFactor)
    End With
End Function 
```

# comments - 为什么代码中的注释颜色不同？

> ID：923039
> 
> 赞同：-2
> 
> 时间：2009-05-28T20:39:39.443
> 
> 标签：comments, usability

为什么不同程序的评论颜色不同？仅仅是审美还是有实际原因？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-28T20:40:42.217

这取决于您的 IDE 或编辑器中的设置。评论没有固定颜色。它们只是字母。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T20:41:20.377

我认为这是为了让它们脱颖而出，这样人们就不会轻易地将它们与代码混淆。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-28T20:46:25.217

迷惑色盲经理。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T20:41:47.253

注释的颜色不同，以使它们从代码的其余部分中脱颖而出（使其更容易阅读和遵循注释线索）。

为什么它们是某些颜色完全取决于相关编辑器的制造商（通常基于可用性研究），但您几乎总是可以使用 IDE 的设置来更改这些颜色。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T20:41:07.473

纯粹审美

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T20:43:07.643

正如 Aiden 所说，这真的取决于实施 IDE 的人来选择。我熟悉绿色代码注释，因为 SQL Server Management Studio 和 Visual Studio 默认都是绿色的，但是开发人员没有理由不能（例如）在他们的 IDE 中选择紫红色、柠檬黄或黄绿色. 加载到另一个 IDE 中，“代码注释”将以*该 IDE 的*颜色显示。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-28T20:42:16.880

这是严格的审美。如果您使用好的 IDE 或文本编辑器，您可以将评论的颜色更改为您喜欢的任何颜色！

我在工作中使用 Visual Studio 2008，我看到很多人更改保留字的颜色，更改为类名，以你的名字命名。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-28T20:42:17.270

大多数程序允许您自定义配色方案，包括评论的颜色。对源代码、注释和其他内容进行着色，使代码更具可读性。特定颜色的选择是个人的和审美的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-28T20:43:13.273

当您说“不同的程序”时，我假设您的意思是“开发环境”。

但总的来说，你是对的。它有一个美学和可用性的组成部分。开发环境 (IDE) 制造商（例如 Microsoft 的 Visual Studio）进行可用性研究以确定哪些颜色最适合开发。比如用什么颜色做关键词、评论等等。

但是这些默认颜色偏好通常很容易被用户更改。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-02-21T11:26:30.030

灰色或绿色用于注释，因为其他颜色具有更理想的属性，因此保留用于代码中更具影响力的区域。

例如，紧密的循环通常是红色的，以使它们运行得更快，而儿童代码通常是蓝色的（出于同样的原因，他们用蓝色学习手写），以使其不那么困难和更熟悉。蓝色通常也用于语言关键字和 API，以使其更易于理解。

由于人眼识别绿色的能力增强，非常重要的代码或注释是绿色的。

黑色和灰色用于代码中乏味和无聊的区域，以鼓励您查看其他地方，例如明亮而令人兴奋的界面和文档（如上图为蓝色和绿色）。

病毒、木马等总是以白色书写，因此它们可以逃避大多数桌面主题的检测。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-28T20:42:05.973

我不太确定您的意思，但我假设您想知道为什么不同的 IDE 在其语法突出显示中使用不同的颜色作为注释。这主要是为了美观，但您通常可以根据需要更改颜色。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-28T20:46:37.900

过去，屏幕是黑色的，所有的字母都是绿色的！它们是各种颜色，可帮助您确定每个（注释、命令、变量等）的使用情况。进展并不大！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-28T20:41:31.093

它只是为了美观和可用性，它明确了哪些将被编译成代码，哪些不会被编译成代码，以及阅读以了解正在发生的事情很重要。

# javascript - 我可以使用除 textarea 和输入文本元素之外的 Javascript 突出显示任何文本吗？

> ID：923043
> 
> 赞同：3
> 
> 时间：2009-05-28T20:40:36.460
> 
> 标签：javascript

使用 Javascript，很容易以编程方式选择文本区域内的文本或输入文本元素。怎么样

```
<span>The quick brown fox jumps over the lazy dog</span> 
```

是否可以使用 JavaScript 来选择单词“quick brown fox”？还是选择整个句子？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T20:57:13.200

礼貌[http://www.sitepoint.com/forums/showthread.php?t=459934](http://www.sitepoint.com/forums/showthread.php?t=459934)

```
<script type="text/javascript">
    function fnSelect(objId) {
        fnDeSelect();
        if (document.selection) {
        var range = document.body.createTextRange();
            range.moveToElementText(document.getElementById(objId));
        range.select();
        }
        else if (window.getSelection) {
        var range = document.createRange();
        range.selectNode(document.getElementById(objId));
        window.getSelection().addRange(range);
        }
    }

    function fnDeSelect() {
        if (document.selection) document.selection.empty(); 
        else if (window.getSelection)
                window.getSelection().removeAllRanges();
    }
    </script>
<body>

<div id="test1">
    <p>jhsdgfhlsdlfkjsdklgjs</p>
    <p>jhsdgfhlsdlfkjsdklgjs</p>
    <p>jhsdgfhlsdlfkjsdklgjs</p>
</div>
<div id="test2">
    <p>jhsdgfhlsdlfkjsdklgjs</p>
    <p>jhsdgfhlsdlfkjsdklgjs</p>
    <p>jhsdgfhlsdlfkjsdklgjs</p>
</div>
<a href="javascript:fnSelect('test1');">Select 1</a>
<a href="javascript:fnSelect('test2');">Select 2</a>
<a href="javascript:fnDeSelect();">DeSelect</a>
</body> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:53:17.527

您将需要一些方法来操作`span`标签。比如一个`id`，但是在javascript中我会编辑一些`style`属性。您可以为要突出显示的所有内容设置一个属性，如下所示。

```
.HL {
    background: #ffff99; 
    color: #000000;
} 
```

如果你这样做，那么你将需要获得对特定标签的引用。

```
DocumentgetElementsByTagName("title") 
```

否则`Document.getElementByID("ID")`对唯一 ID 有好处。然后使用`setAttribute(name, value)`To 将类更改为给定的类。

这只是一个简单的例子，但有很多方法可以做到这一点。

```
<span id="abc" class=""> Sample </span>
var temp = Document.getelementByID("abc");
temp.setAttribute('class', 'HL'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T20:48:04.497

在 CSS 中你可以创建一个 .highlight 类

```
.highlight{
  background-color:yellow;
} 
```

在 javascript 中，您可以将 .highlight 类添加到要突出显示的元素中

```
<getSpanElement>.className='highlight'; 
```

该文本随后被突出显示，尽管它未被选中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-28T20:48:33.107

突出显示还是选择？我认为您实际上想选择不突出显示。

突出显示...是的！设置元素的适当 CSS 属性`span`，例如前景色和背景色。

编辑：这就是所谓的选择。抱歉，我不知道有什么办法。

# jquery - 带有 jquery 的文本阴影

> ID：923049
> 
> 赞同：2
> 
> 时间：2009-05-28T20:41:13.777
> 
> 标签：jquery

我希望用 javascript 更改元素的 text-shadow 属性。据我所知，jquery css 不适用于文本阴影。

有没有人对动态更改文本阴影有任何建议。

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T23:17:35.787

对我有用（Chrome 和 FF，不是 IE）。

尝试使用 camelCase。在 JavaScript 中使用 CSS 属性时，您必须删除连字符（例如，“background-image”将变为“backgroundImage”），然后设置属性。

所以你的代码应该是：

> $('#bla').css('textShadow','#6374AB 20px -12px 2px');

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:52:07.063

总是有[这个](http://kilianvalkhof.com/uploads/ieshadow.html)小脚本。

但我不明白为什么这不起作用：

```
$('#bla').css('text-shadow','#6374AB 20px -12px 2px'); 
```

编辑：嗯，我试过了，我的尝试确实给 jQuery 留下了深刻的印象。但我确实找到了另一个[脚本](http://groups.google.com/group/jquery-en/browse_thread/thread/f9df5396ea4dfcac)。

干杯!

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-10T06:36:21.547

```
$("#text").hover(function() { 
    $(this).animate({textShadow: "#aaa 6px 6px 6px"});
}, function() { 
    $(this).animate({textShadow: "#ccc 3px 3px 3px"});
}); 
```

Alex Peattie 的网站上还有更多内容：http: [//alexpeattie.com/projects/animate-textshadow/](http://alexpeattie.com/projects/animate-textshadow/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-07T09:52:58.763

您也可以将其放置在对象内。

```
({"text-shadow" : "#6374AB 20px 12px 2px"}) 
```

# c# - 私有成员实例化/初始化的最佳实践是什么？

> ID：923054
> 
> 赞同：1
> 
> 时间：2009-05-28T20:41:44.430
> 
> 标签：c#, .net

> **可能重复：**
> [C#成员变量初始化；最佳实践？](https://stackoverflow.com/questions/298183/c-member-variable-initialization-best-practice)

这样做有什么好处：

```
public class RemotingEngine
{
    uint m_currentValueId;
    object m_lock;

    public RemotingEngine()
    {
        m_currentValueId = 0;
        m_lock = new object();
    } 
```

与这个：

```
public class RemotingEngine
{
    uint m_currentValueId = 0;
    object m_lock = new object(); 
```

我一直在避免第二个，只是因为它感觉“脏”。它显然减少了打字，所以这对我很有吸引力。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-28T20:47:52.377

它可以在继承情况下有所作为。有关对象初始化顺序，请参阅此链接：
[http ://www.csharp411.com/c-object-initialization/](http://www.csharp411.com/c-object-initialization/)

1.  派生静态字段
2.  派生静态构造函数
3.  派生实例字段
4.  基本静态字段
5.  基础静态构造函数
6.  基本实例字段
7.  基实例构造函数
8.  派生实例构造函数

因此，如果这是一个派生类，则在初始化派生字段和构造函数运行之间初始化整个基对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T20:44:31.197

没有太大的区别，我会保留第一个，因为它更具可读性。通常变量是在类的顶部定义的，我可以去那里检查它们的默认值，而不是寻找构造函数并查看它是否设置了它。就编译器而言，没有区别，除非您有多个构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T20:45:39.323

出于这个原因，我总是使用第一个：初始化变量是构造函数的责任。不同的构造函数可能以不同的方式初始化变量。所以是的，第二种方式你应该觉得很脏=）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T20:50:56.363

我更喜欢第二种，在某些情况下，它取决于您的编码标准。但考虑处理顺序：

**目标类字段初始化->基类字段初始化->基类构造函数->目标类构造函数**

如果基类或目标类在创建对象时出现异常并且字段已预初始化，则它将在完成时具有值，并可能导致一些意外问题。

另请参阅 Bill Simser 的此博客[Best Practices and Member Initialization in C#](http://weblogs.asp.net/bsimser/archive/2005/04/21/403770.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T20:43:59.013

就 IL 而言，它们是相同的。

编译器会这样：

```
class Foo
{
    int bar = 1;
} 
```

进入这个：

```
class Foo
{
    int bar;

    public Foo()
    {
        this.bar = 1;
    }
} 
```

即使您像这样自己添加构造函数：

```
class Foo
{
    int bar = 1;

    public Foo(int bar)
    {
        this.bar = bar;
    }
} 
```

编译器把它变成这样：

```
class Foo
{
    int bar;

    public Foo(int bar)
    {
        this.bar = 1;
        this.bar = bar;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-28T20:46:23.830

对于 int，您根本不必这样做，内在类型被初始化为 default() - 对于 int 来说，它是 0。

至于对象，这是一个口味问题。我更喜欢前者。如果有人重写了我的构造函数，我希望他们调用 base() 以在适当的状态下构造它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-28T20:46:23.860

您希望避免在构造函数范围之外进行实例化，因为它显示了意图，特别是如果您正在覆盖构造函数，您将拥有更多的灵活性

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-28T20:57:35.193

我对此有不同的看法。我认为您应该抽象为属性并将它们设置在构造函数中。使用自动属性基本上可以消除这个问题，因为您无法初始化它们（除了默认值之外的任何东西）。

```
public class RemotingEngine {
    private uint CurrentValueID { get; set; }
    private object Lock { get; set; }

    public RemotingEngine()
    {
        this.CurrentValueID = 0; // not really necessary...
        this.Lock = new object();
    }
} 
```

# python - 如何捕获子进程的 stdout 输出？

> ID：923079
> 
> 赞同：12
> 
> 时间：2009-05-28T20:45:45.827
> 
> 标签：python, subprocess, stdout

我正在尝试用 Python 编写一个程序，并被告知运行一个 .exe 文件。当这个 .exe 文件运行时，它会吐出大量数据，我需要将某一行打印到屏幕上。我很确定我需要使用`subprocess.popen`或类似的东西，但我是 subprocess 的新手并且不知道。任何人都有一个简单的方法让我完成这项工作？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-28T20:52:54.580

如果您有兴趣在流程完成执行后打印输出，@Paolo 的解决方案是完美的。如果您想在进程运行时轮询输出，您必须这样做：

```
process = subprocess.Popen(cmd, stdout=subprocess.PIPE)

while True:
    out = process.stdout.readline(1)
    if out == '' and process.poll() != None:
        break
    if out.startswith('myline'):
        sys.stdout.write(out)
        sys.stdout.flush() 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-28T20:49:38.363

像这样的东西：

```
import subprocess
process = subprocess.Popen(["yourcommand"], stdout=subprocess.PIPE)
result = process.communicate()[0] 
```

# c# - 将文本文件保存到没有列名的 SQL 数据库

> ID：923080
> 
> 赞同：0
> 
> 时间：2009-05-28T20:45:54.173
> 
> 标签：c#, sql, text-files, readline

我正在读取 C# 中的文本文件并尝试将其保存到 SQL 数据库。我很好，只是我不希望第一行，即列的名称，包含在导入中。排除这些最简单的方法是什么？

代码是这样的

```
while (textIn.Peek() != -1)
{
   string row = textIn.ReadLine();
   string[] columns = row.Split('   ');
   Product product = new Product();
   product.Column1 = columns[0];
   etc.....
   product.Save();
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:49:30.423

如果您自己编写代码以读取文件然后导入...为什么不跳过第一行？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T07:20:01.167

这是我的建议：

```
string[] file_rows;
using(var reader=File.OpenText(filepath))
{
file_rows=reader.ReadToEnd().Split("\r\n");
reader.Close();
}

for(var i=1;i<file_rows.Length;i++)
{
var row=file_rows[i];
var cells=row.Split("\t");
....
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T20:49:22.683

你是如何导入数据的？如果您在 C# 中循环并一次插入一个，请构建循环以跳过第一个插入！

或者只是删除它们在那里之后插入的第一行。

提供更多信息，获取更多详细信息...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T08:01:36.650

为了将来参考，看看这个很棒的包：FileHelpers Library

我还不能添加链接，但谷歌应该会提供帮助，它在 sourceforge 上

当人们坚持使用文件作为集成时，这让我们的生活变得更轻松

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T20:50:09.920

将标志传递给程序（以防将来第一行也是数据），导致程序跳过第一行文本。

如果它与数据库中使用的列名相同，您还可以对其进行解析以从中获取列名，而不是对它们进行硬编码（假设这就是您当前正在做的事情:)）。

最后一点，如果您使用的是 MySQL 数据库并且您有命令行访问权限，您可能需要查看[LOAD DATA LOCAL INFILE](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)语法，它可以让您导入任意定义的 CSV 数据。

# css - AS3 的 CSS 标识符中的错误？

> ID：923096
> 
> 赞同：0
> 
> 时间：2009-05-28T20:48:13.980
> 
> 标签：css, actionscript-3, actionscript

我不确定这是否是一个错误，但有没有办法使用 ActionScript 3.0 CSS 将“类”或“id”标识符定位到样式标题标签（h1 到 h6）？它适用于所有其他标签。

例如。：

<p class="style1">text</p> // 我可以在 CSS 中使用 .style1 或 p

<h1 class="style2">text</h1> // 我不能在 CSS 中使用 .style2，只能使用 h1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T21:46:57.357

看起来 TextField 类不支持 h1。在文档中查找 htmlText 属性以获取支持的标签列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T21:52:42.993

**h1**是一个 html 元素，它暗示了某种层次结构。在 Flash 中没有这样的标签，因为它们仅将它们用于事物的外观而不是它们的结构。

您可以使用类似于以下内容的方式实现您可能想要的效果：

的HTML：

```
<p style="headline">Headline</p>
<p style="text">Text</p> 
```

的CSS：

```
p.headline {font-size: 20pt; font-weight: bold;}
p.text {font-size: 12pt;} 
```

# list - 以pythonic方式创建列表列表

> ID：923111
> 
> 赞同：11
> 
> 时间：2009-05-28T20:50:30.810
> 
> 标签：list, matrix, python

我正在使用列表列表在 python 中存储矩阵。我尝试如下初始化一个 2x3 零矩阵。

```
mat=[[0]*2]*3 
```

*但是，当我更改矩阵中一项的值时，它会更改每一*行中该条目的值，因为其中每一行的 id`mat`是相同的。例如，分配后

```
mat[0][0]=1 
```

`mat`是`[[1, 0], [1, 0], [1, 0]]`。

我知道我可以使用如下循环创建零矩阵，

```
mat=[[0]*2]
for i in range(1,3):
    mat.append([0]*2) 
```

但谁能告诉我一个更蟒蛇的方式？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T21:00:21.883

使用[列表理解](http://docs.python.org/tutorial/datastructures.html?highlight=list%20comprehension#list-comprehensions)：

```
>>> mat = [[0]*2 for x in xrange(3)]
>>> mat[0][0] = 1
>>> mat
[[1, 0], [0, 0], [0, 0]] 
```

或者，作为一个函数：

```
def matrix(rows, cols):
    return [[0]*cols for x in xrange(rows)] 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-28T20:57:09.470

试试这个：

```
>>> cols = 6
>>> rows = 3
>>> a = [[0]*cols for _ in [0]*rows]
>>> a
[[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]
>>> a[0][3] = 2
>>> a
[[0, 0, 0, 2, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]] 
```

[此答案](https://stackoverflow.com/questions/691946/short-and-useful-python-snippets/692458#692458)中也对此进行了讨论：

```
>>> lst_2d = [[0] * 3 for i in xrange(3)]
>>> lst_2d
[[0, 0, 0], [0, 0, 0], [0, 0, 0]]
>>> lst_2d[0][0] = 5
>>> lst_2d
[[5, 0, 0], [0, 0, 0], [0, 0, 0]] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-02-25T09:29:17.937

这个比公认的答案更快！
使用 xrange(rows) 而不是 [0]*rows 没有区别。

```
>>> from itertools import repeat
>>> rows,cols = 3,6
>>> a=[x[:] for x in repeat([0]*cols,rows)] 
```

不使用 itertools 并以相同速度运行的变体

```
>>> a=[x[:] for x in [[0]*cols]*rows] 
```

来自 ipython：

```
In [1]: from itertools import repeat

In [2]: rows=cols=10

In [3]: timeit a = [[0]*cols for _ in [0]*rows]
10000 loops, best of 3: 17.8 us per loop

In [4]: timeit a=[x[:] for x in repeat([0]*cols,rows)]
100000 loops, best of 3: 12.7 us per loop

In [5]: rows=cols=100

In [6]: timeit a = [[0]*cols for _ in [0]*rows]
1000 loops, best of 3: 368 us per loop

In [7]: timeit a=[x[:] for x in repeat([0]*cols,rows)]
1000 loops, best of 3: 311 us per loop 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-28T21:03:09.847

我用

```
mat = [[0 for col in range(3)] for row in range(2)] 
```

尽管取决于您在创建矩阵后对矩阵所做的操作，但您可能会考虑使用 NumPy 数组。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-28T20:59:40.323

这将起作用

```
col = 2
row = 3
[[0] * col for row in xrange(row)] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-28T21:00:18.230

关于什么：

```
m, n = 2, 3
>>> A = [[0]*m for _ in range(n)]
>>> A
[[0, 0], [0, 0], [0, 0]]
>>> A[0][0] = 1
[[1, 0], [0, 0], [0, 0]] 
```

又名列表理解；来自[文档](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)：

```
List comprehensions provide a concise way to create lists 
without resorting to use of     
map(), filter() and/or lambda. 
The resulting list definition tends often to be clearer    
than lists built using those constructs. 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-01-20T14:26:58.410

如果涉及的尺寸真的只有2和3，

```
mat = [[0, 0], [0, 0], [0, 0]] 
```

很容易最好，还没有被提及。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-02-25T09:15:18.443

有什么 itertools 不能做的吗？:)

```
>>> from itertools import repeat,izip
>>> rows=3
>>> cols=6
>>> A=map(list,izip(*[repeat(0,rows*cols)]*cols))
>>> A
[[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]]
>>> A[0][3] = 2
>>> A
[[0, 0, 0, 2, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]] 
```

# browser - 仅在浏览器插件中从服务器获取视频数据的问题

> ID：923117
> 
> 赞同：0
> 
> 时间：2009-05-28T20:51:34.007
> 
> 标签：browser, video, plugins

我的服务器有问题，用 Java 编写，在 Tomcat 上运行，提供视频文件。我没有编写代码，并且对涉及此问题的库知之甚少，因此非常感谢任何要追求的想法:)

当您将相关视频从浏览器保存到磁盘然后播放时，它们可以正常工作。

但是，当您尝试使用视频播放浏览器插件查看一个时（似乎哪个插件无关紧要...... FF 或 IE 的 WMP，FF 中的 VLC，哪个浏览器版本也无关紧要），这一切出错。从浏览器端，似乎没有数据到达插件（例如，VLC 插件只是说“等待视频”......它永远不会到达）。

在服务端，有一个HttpServletResponse实例，它在这个实例上调用getOutputStream，将数据写入流中没有问题，然后在关闭流时抛出异常。

异常堆栈跟踪如下：

```
java.net.SocketException: Software caused connection abort: socket write error
at java.net.SocketOutputStream.socketWrite0(Native Method)
at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
at java.net.SocketOutputStream.write(SocketOutputStream.java:136)
at org.apache.coyote.http11.InternalOutputBuffer.realWriteBytes(InternalOutputBuffer.java:750)
at org.apache.tomcat.util.buf.ByteChunk.flushBuffer(ByteChunk.java:432)
at org.apache.tomcat.util.buf.ByteChunk.append(ByteChunk.java:347) 
```

有任何想法吗？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T21:26:08.273

您是否尝试过在关闭流之前刷新它？通常，您不应该自己关闭响应的 OutputStream，servlet 容器将在完成请求之前将其作为最后一件事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T21:29:54.770

HTTP 响应标头是否包含`Content-Disposition`字段？如果是这样，请尝试将其删除，让客户决定演示方法。

规范：[RFC 2183](http://www.ietf.org/rfc/rfc2183.txt)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-05T07:03:07.307

好的，所以我终于明白了这一点。它确实与Tomcat或Java无关，关键是浏览器如何获取数据和浏览器插件如何获取数据之间的区别：插件不发送浏览器的cookie。

在这种情况下，服务器有一些登录 cookie 内容，因此插件的数据请求在被写入流之前被拒绝。这里令人困惑的是，在调试器中，流式编写代码仍在运行，但这只是因为浏览器首先请求数据（一旦它意识到它有视频，它就会启动插件而不是插件使一个新的 HTTP 请求）。

我在 Wireshark 顺便说一句发现了这一点，其中对插件的响应很清楚（这是一个 HTML“访问被拒绝”类型的页面）。

# exception - WinCE 5.0 上 Microsoft.AGL.Common.MISC.HandleAr() 的 System.Exception

> ID：923123
> 
> 赞同：3
> 
> 时间：2009-05-28T20:52:10.947
> 
> 标签：exception, compact-framework

出于某种原因，操作系统会抛出此异常，它发生在 Dispose() 方法中。没有提供额外的细节。

我的代码太长，无法发布。一般来说，这个异常是什么意思？

我在 WinCE 5.0 上使用 .net CF 2.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-26T15:57:16.793

选项 1\. 非 UI 线程上的 UI 方法/属性访问（检查 Control.InvokeRequired） 选项 2\. 低内存状态和未处理的位图/图像问题 (AGL)

# objective-c - Objective-C：阅读 cocos2d api 文档时遇到问题

> ID：923128
> 
> 赞同：0
> 
> 时间：2009-05-28T20:52:59.633
> 
> 标签：objective-c, cocos2d-iphone

我正在尝试阅读[cocos2d api 文档](http://www.sapusmedia.com/cocos2d-iphone-api-doc/)，但我对 [...] 的含义感到困惑，例如：

```
- (float) scale [read,write,assign] 
```

我期待一个类型和一个参数名称，所以像

```
- (void) addFrameWithFilename: (NSString *) filename 
```

说得通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T21:03:00.240

它是对属性的描述（并且这些在您链接到的文档中被分开）。这些是[] 中的[属性属性](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocProperties.html)；在这种情况下，它们表示存在两种方法，getter（读取）和 setter（写入）：

```
- (float)scale
- (void)setScale:(float)value 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T21:06:29.217

这些是 Objective-C 2.0 的属性。关于这个主题有一个[很好的教程。](http://theocacao.com/document.page/510)

基本上，如果您有一个 instance `foo`，您可以通过执行以下操作来访问和修改该属性：

```
foo.scale = 3.0f; 
```

# design-patterns - 更新多个实体的方法通常不是 DAO 的一部分吗？

> ID：923129
> 
> 赞同：3
> 
> 时间：2009-05-28T20:53:00.603
> 
> 标签：design-patterns, dao, oop

我已经看到了一百万个 DAO 示例，并且在大多数情况下，它们都为单个实体实现了基本的 CRUD 操作，可能还有一些返回列表的方法（例如 List getCustomers()）。

但是，我从未见过有更新、删除或创建多个实体的方法的示例，例如：void update(List)。

更新多个实体的方法通常不是 DAO 的一部分，还是它们只是不经常在示例中使用？我有一个要求，我必须进行一些批量插入，并且调用 myDAO.create() 一百次并不是非常有效。

我只是想确保在继续做看起来很明显的事情之前我没有遗漏任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T20:59:31.913

I find that batch updates are usually done with tools provided by the database vendor.

I agree that the DAOs that I've seen usually don't have methods for create/update/delete overloaded to take List, but there's no reason why they can't.

The one thought that brings me up short is that DAOs don't own transactions when I write them. They can never know where they're part of a larger unit of work. That's what services do.

My advice would be to leave the DAOs alone and let a separate service layer own the batch operations. Services own the transaction logic. It's also a good place to include logic for "chunking" a large update into pieces. That lets you checkpoint the batch and keep the size of your rollback logs manageable.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:59:43.507

`void update(List)` should act the same as `void update(Item)`, only the `List` one would update multiple items. If not, it should be unless there are very specific reasons why not to. The overhead of calling a method is not a concern if they do the same thing.

For example, calling `update(Item)` 1000 times vs calling `update(List)` 1 and it does the same as `update(Item)` only a 1000 times means there will be very little performance difference.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T20:58:01.700

我认为这些示例不经常使用它。我的 DAO 具有访问、创建和更新单个实体和记录集合的方法。

# xml - 如何将类型为 ObjectProxy 的 WebService 结果转换为 XML？

> ID：923132
> 
> 赞同：1
> 
> 时间：2009-05-28T20:53:20.290
> 
> 标签：xml, apache-flex, actionscript-3, web-services

我有一个在 SOAP 响应中返回 XML 的 WebService：

```
<?xml version="1.0" encoding="utf-8" ?> 
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <GetConfigResponse xmlns="Web.Services">
            <GetConfigResult>
                <Configuration xmlns="">
                    <Stuff>False</Stuff> 
                    <MoreStuff>
                        <Report_Format>PDF</Report_Format> 
                        <Report_Sections>
                            <Report_Section>
                                <idNmb>1</idNmb> 
                                <name>Report 1</name> 
                                <isDefault>true</isDefault> 
                                <isVisible>true</isVisible> 
                            </Report_Section>
                            <Report_Section>
                                <idNmb>2</idNmb> 
                                <name>Report 2</name> 
                                <isDefault>false</isDefault> 
                                <isVisible>true</isVisible> 
                            </Report_Section>
                        </Report_Sections>
                    </MoreStuff>
                </Configuration>
            </GetConfigResult>
        </GetConfigResponse>
    </soap:Body>
</soap:Envelope> 
```

当我调用这个 WebService 时，Flex 调试器显示 ResultEvent.result 的类型是“ObjectProxy”。当我尝试将此值转换为 XML 时，它会跟踪为“[object Object]”，并且我无法访问 XML 节点。对于我调用的大多数其他 Web 服务，ResultEvent.result 的类型为“Array”，并且可以毫无问题地转换为 XML。

我该怎么做才能将此结果存储为 XML？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-29T13:18:57.633

将`resultFormat`您的请求/操作设置为`"e4x"`，它将返回一个`XML`对象，而不是将结果转换为`ObjectProxy`.

# .net - .NET 调试和跟踪性能：技巧/隐藏功能？

> ID：923133
> 
> 赞同：1
> 
> 时间：2009-05-28T20:53:24.720
> 
> 标签：.net, performance, debugging

您对在 .NET 技术中完成的每个应用程序的性能分析和优化中应该使用哪些技术有什么看法？
此外，您还知道哪些功能强大的调试/跟踪技术？
您是否认为在大型项目中需要自定义调试/诊断类？
您是否建议使用应用程序分析器或任何其他第三方应用程序？

另一个非常相关的问题：如何获得要执行的方法所花费的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-02T16:31:55.577

这是与语言无关的建议。如果你有一些对现有应用程序[进行性能调整](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)的经验，尤其是大型应用程序，你可能会学到我学到的东西。最大的性能杀手是过度设计：太多的抽象层、通知驱动的处理等等。问题在于，抽象地说，那些本应让你的生活更轻松的小事情最终会在你不知情的情况下把你吸进巨大的循环浪费中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T06:26:41.330

这是一个非常普遍的问题:) 但是这里有一些指导方针

1.  测量您的应用程序的启动时间，如果启动对您的客户来说是一个大问题，请考虑使用 Ngen 服务，使用 ngen 服务（ngen.exe）对于冷启动有相当大的性能
2.  工作集和 GC 堆：你的 gc 堆是什么样的；特别是你的LOH。CLR 中的 LOH 未压缩，因此保持 LOH 较小或使用缓存技术重用 LOH 中的对象（大对象堆保存大于 85000 字节的对象）很重要。
3.  吞吐量：您可以执行多少操作，如果您的应用有用户界面，它的响应时间是多少，如果它是服务器应用，它可以处理多少请求..等等

关于诊断和跟踪，您可以使用 System.Dignostics 命名空间中的类，例如 TraceListner，您还可以为关键代码路径考虑 ETW 事件（MSDN 中的 Windows 事件跟踪有很好的参考）。

您可以在 System.Dignostics 命名空间中的内置类之上构建自己的自定义诊断类。

A couple of very useful tool that you need to have in your grab bag is VS Profiler, and CLR profiler for time profiling and memory profiling respectively.

You can use a profiler to have a general high level idea about your hot functions, you can use StopWatch class to measure the time for some selected methods, or for high resolution timing, you can use QueryPerformanceCounter and QueryPerformanceFrequency windows APIs

# c# - Asp.net 中的全局计时器

> ID：923134
> 
> 赞同：7
> 
> 时间：2009-05-28T20:53:35.780
> 
> 标签：c#, asp.net

我想要一个 ASP.net 应用程序的计时器，该应用程序将在每个星期天晚上启动并执行某些操作（更新数据库中的表）。但是，我真的不想编写除了 Web 应用程序之外还必须部署在服务器上的服务。有没有办法轻松完成这项工作？也许使用 Global.asax 文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-08-01T05:10:50.820

似乎最好的解决方案是使用[这种技术](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)。如果我对服务器有更多的控制权，我可能会编写一个控制台应用程序来利用计划任务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-28T20:59:26.423

我不是 100% 确定你会把它放在*哪里，但是使用 System.Threading.Timer 会摇滚这个。*

```
// In some constructor or method that runs when the app starts.
// 1st parameter is the callback to be run every iteration.
// 2nd parameter is optional parameters for the callback.
// 3rd parameter is telling the timer when to start.
// 4th parameter is telling the timer how often to run.
System.Threading.Timer timer = new System.Threading.Timer(new TimerCallback(TimerElapsed), null, new Timespan(0), new Timespan(24, 0, 0));

// The callback, no inside the method used above.
// This will run every 24 hours.
private void TimerElapsed(object o)
{
    // Do stuff.
} 
```

最初，您必须确定第一次启动计时器的时间，或者您可以在希望此计时器在周日晚上运行的时间打开网站。

但正如其他人所说，使用网站以外的东西来做到这一点。制作一个 Windows 服务来处理这个问题很容易。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T20:56:56.040

我会编写一个控制台应用程序并使用**计划任务**来安排它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-20T11:05:23.817

试试[Quartz .NET](http://quartznet.sourceforge.net/)，一个用于 .NET 企业应用程序（例如 ASP .NET）的作业调度程序，这应该可以满足您的目的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T00:43:25.940

我不认为 .NET 应用程序可以很好地解决您的问题。

IIS 回收将每隔几个小时回收一次进程（取决于设置），即使您将该间隔设置为 7 天，应用程序池仍可能因您无法控制的其他原因而被回收。

我同意 jcrs3：只需编写一个小控制台应用程序并使用调度程序。您也可以编写服务，但如果您需要快速简单的东西，请使用控制台应用程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T02:45:02.440

针对您对计划任务的评论：

另一个技巧是覆盖**Global.asax**中的一个事件，这个事件经常被称为**Application_EndRequest()**并执行类似的操作：

```
protected void Application_EndRequest()
{
    if (((DateTime)Application["lastTimeRun"]) < DateTime.Today)
    {
        Application["lastTimeRun"] = DateTime.Today;
        doSomething();
    }
} 
```

这将在日期更改后的第一个请求之后运行，因此您不能保证它会在每天早上 3:00 精确运行。

我什至有一些案例，您可以在另一台计算机上使用计划任务访问该站点。

# django - 自定义用户类会破坏 django 中的应用程序吗？

> ID：923135
> 
> 赞同：3
> 
> 时间：2009-05-28T20:53:56.980
> 
> 标签：django, authentication, django-models

假设我正确地对用户模型（CustomUser）进行了子类化（如此处所述：http: [//scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/](http://scottbarnham.com/blog/2008/08/21/extending-the-django-user-model-with-inheritance/)）

并安装了评论应用程序。

在我写的模板中访问评论的用户：

```
{{comment.user}} # which provides User, not my CustomUser 
```

因此，

```
{{comment.user.CustomProperty}} #does not work. 
```

我该如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T21:23:43.550

正如您在该帖子的评论中看到的那样，它仍然存在争议，最好的方法是什么。

我也通过子类化进行了尝试，但我遇到了很多问题，而[使用配置文件](http://www.djangobook.com/en/1.0/chapter12/#cn222)对我来说非常有效。

```
class IRCUser(models.Model):
    user        = models.ForeignKey(User, unique=True)
    name        = models.CharField(max_length=100, blank= True, null = True )
    friends     = models.ManyToManyField("IRCUser", blank= True, null = True)
    dataRecieved= models.BooleanField(default=False) 
```

创建 IRCUser 的工作方式如下：

```
>>> IRCUser(user = User.objects.get(username='Kermit')).save() 
```

**编辑：为什么 user_profiles 优雅：**

假设，我们正在编写一个 webapp，它将表现为一个多协议聊天。用户可以在 ICQ、MSN、Jabber、FaceBook、Google Talk 上提供他们的帐户.....

我们可以通过继承自由地创建一个自定义用户类，它将包含所有附加信息。

```
class CustomUser(User):
    irc_username = models.CharField(blank=True, null=True)
    irc_password = models.PasswordField(blank=True, null=True)
    msn_username = models.CharField(blank=True, null=True)
    msn_password = models.PasswordField(blank=True, null=True)
    fb_username = models.CharField(blank=True, null=True)
    fb_password = models.PasswordField(blank=True, null=True)
    gt_username = models.CharField(blank=True, null=True)
    gt_password = models.PasswordField(blank=True, null=True)
    ....
    .... 
```

这将导致

*   具有大量零值的数据行
*   棘手*的假设*验证
*   不可能，拥有更多具有相同服务的一个帐户

所以现在让我们用 user_profiles 来做吧

```
class IRCProfile(models.Model):
    user = models.ForeignKey(User, unique=True, related_name='ircprofile')
    username = models.CharField()
    password = models.PasswordField()

class MSNProfile(models.Model):
    user = models.ForeignKey(User, unique=True, related_name='msnprofile')
    username = models.CharField()
    password = models.PasswordField()

class FBProfile(models.Model):
    user = models.ForeignKey(User, unique=True, related_name='fbprofile')
    username = models.CharField()
    password = models.PasswordField() 
```

结果：

*   User_profiles 可以在需要时创建
*   数据库不会被零值淹没
*   可以将 n 个相同类型的配置文件分配给一个用户
*   验证很容易

这可能会导致模板中的语法更加神秘，但我们可以自由地在我们的视图/模板标签中使用一些快捷方式，或者根据需要使用`{% with ... %}`它来调整它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T22:31:44.037

`ForeignKey`from是 django的`comments.Comment`内置`User`对象，所以查询`comment.user`会给你父对象（即：基本`User`模型）。但是，django 继承确实提供了一种从超类获取子类版本的方法：

```
{{ comment.user.customeruser }} 
```

这将允许您执行以下操作：

```
{{ comment.user.customeruser.customproperty }} 
```

我碰巧认为这是 Django 继承实现的一个弱点，因为它并不能完全反映您通常期望从 Python 中的对象继承中获得的行为，但至少有一种解决方法。由于我几乎不会急于提交带有正确行为版本的补丁，因此我不能抱怨:-)

* * *

我同意 Carl Meyer 的评论：在不更改父模型的数据库表的情况下自动获取子类可能会很昂贵，并且从父类查询返回子类的实例将与 Django 的承诺不一致，即查询集返回的模型是查询集已运行。

然而，在实践中，我仍然发现 Django 的继承有时会导致一些尴尬的额外步骤。从 0.91 开始使用 Django，并且知道解决对象关系映射问题的所有不同策略都有权衡，我很高兴现在在 Django 中有继承，并且觉得当前的实现非常好......所以我会讨厌我最初的答案被解释为对项目的轻微反对。

因此，我想我会编辑此答案以链接到 Carl 本人在解决方案中提供的答案，以防您不知道子类是什么类型：[How do I access the child classes of an object in Django without known the孩子班级的名字？](https://stackoverflow.com/questions/929029/how-do-i-access-the-child-classes-of-an-object-in-django-without-knowing-the-name/929982#929982). 他在那里提供了有关使用 ContentType 框架的建议。仍然涉及一些间接，但在工具包中是一个很好的、可推广的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T21:12:21.187

我认为没有办法解决它，因为正如你所说，`comment.user`是 a `User`，而不是 a `CustomUser`。

请参阅[http://docs.djangoproject.com/en/dev/topics/db/models/#proxy-models](http://docs.djangoproject.com/en/dev/topics/db/models/#proxy-models)：

> **QUERYSETS 仍然返回**
> 所请求的模型 每当您查询 User 对象时，都无法让 Django 返回一个 MyUser 对象。用户对象的查询集将返回这些类型的对象。代理对象的全部意义在于依赖于原始用户的代码将使用这些，而您自己的代码可以使用您包含的扩展（无论如何都没有其他代码依赖）。这不是一种用您自己创建的东西替换任何地方的用户（或任何其他）模型的方法。

也许在这种情况下，旧的使用方式`UserProfile`会是更好的选择？

对不起，如果我没有帮助太多。

# sql-server - 动态名称-值对的 T-SQL 过滤

> ID：923136
> 
> 赞同：0
> 
> 时间：2009-05-28T20:53:58.493
> 
> 标签：sql-server, tsql, dynamic-data, filtering

我将描述我想要实现的目标：

**我将一个带有名称值对的 xml 传递给 SP，我将其放入表变量中，比如说`@nameValuePairs`. 我需要检索与名称-值对（属性、另一个表）完全匹配的表达式（一个表）相关联的 ID 列表。**

这是我的架构：

**表达式表**--> (expressionId, attributeId)

**属性表**--> (attributeId, attributeName, attributeValue)

在尝试了使用动态 SQL 和邪恶游标的复杂内容（有效但速度非常慢）之后，这就是我现在所拥有的：

```
--do the magic plz!

-- retrieve number of name-value pairs
SET @noOfAttributes = select count(*) from @nameValuePairs

select distinct
    e.expressionId, a.attributeName, a.attributeValue
into 
    #temp
from 
    expressions e
join
    attributes a
on
    e.attributeId = a.attributeId
join --> this join does the filtering
    @nameValuePairs nvp
on 
    a.attributeName = nvp.name and a.attributeValue = nvp.value
group by
    e.expressionId, a.attributeName, a.attributeValue

-- now select the IDs I need
-- since I did a select distinct above if the number of matches
-- for a given ID is the same as noOfAttributes then BINGO!
select distinct 
    expressionId
from 
    #temp
group by expressionId
having count(*) = @noOfAttributes 
```

人们可以请检查一下，看看他们是否能发现任何问题？有没有更好的方法来做到这一点？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T21:07:08.903

这不是一个坏方法，具体取决于表的大小和索引，包括@nameValuePairs。如果这些行数很高或者变得很慢，则最好将 @namValuePairs 放入临时表中，添加适当的索引，并使用单个查询而不是两个单独的查询。

我确实注意到您将不使用的列放入#temp，排除它们会更快（尽管这意味着#temp 中的重复行）。此外，您的第二个查询在同一列上同时具有“不同”和“分组依据”。你不需要两者，所以我会放弃“不同的”（可能不会影响性能，因为优化器已经解决了这个问题）。

最后，#temp 使用 expressionid 上的聚集非唯一索引可能会更快（我假设这是 SQL 2005）。您可以在 SELECT..INTO 之后添加它，但在加载之前添加它通常一样快或更快。这将要求您首先创建#temp，添加集群，然后使用 INSERT..SELECT 来加载它。

我将添加一个合并查询的示例...好的，这是将它们合并为单个查询的一种方法（这也应该与 2000 兼容）：

```
-- retrieve number of name-value pairs
SET @noOfAttributes = select count(*) from @nameValuePairs

-- now select the IDs I need
-- since I did a select distinct above if the number of matches
-- for a given ID is the same as noOfAttributes then BINGO!
select
    expressionId
from 
    (
        select distinct
            e.expressionId, a.attributeName, a.attributeValue
        from 
            expressions e
        join
            attributes a
        on
            e.attributeId = a.attributeId
        join --> this join does the filtering
            @nameValuePairs nvp
        on 
            a.attributeName = nvp.name and a.attributeValue = nvp.value
    ) as Temp
group by expressionId
having count(*) = @noOfAttributes 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T21:08:24.470

我看到的一个错误是您没有别名为 b 的表，但您正在使用：a.attributeId = b.attributeId。

尝试修复它，看看它是否有效，除非我遗漏了什么。

编辑：我认为您刚刚在编辑中修复了这个问题，但它应该是 a.attributeId = e.attributeId 吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T21:43:40.873

我相信这将满足您要满足的要求。我不确定它有多漂亮，但它应该可以工作并且不需要临时表：

```
SET @noOfAttributes = select count(*) from @nameValuePairs

SELECT e.expressionid
FROM expression e
LEFT JOIN (
           SELECT attributeid
           FROM attributes a
           JOIN @nameValuePairs nvp ON nvp.name = a.Name AND nvp.Value = a.value 
           ) t ON t.attributeid = e.attributeid
GROUP BY e.expressionid
HAVING SUM(CASE WHEN t.attributeid IS NULL THEN (@noOfAttributes + 1) ELSE 1 END) = @noOfAttributes 
```

编辑：在进行了更多评估之后，我发现了一个问题，其中包含某些不应该包含的表达式。我已经修改了我的查询以考虑到这一点。

# svn - 查询某个特定用户锁定的所有文件的 Subversion 存储库的命令是什么？

> ID：923139
> 
> 赞同：2
> 
> 时间：2009-05-28T20:54:14.187
> 
> 标签：svn

查询 Subversion 存储库以查找由特定用户~~签出并~~锁定的所有文件的命令是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T22:36:11.440

在 subversion 中，“*签出*”仅仅意味着您已经在存储库中制作了某个文件夹的本地工作副本。然后，您可以在此工作副本上脱机工作（直到您需要执行一些需要与存储库通信的操作）。

在离线时，您可以随时删除您的工作副本，因此服务器确实无法知道谁还有“已签出”的内容，而谁还没有。

* * *

**编辑**：所以你的意思是锁。要列出特定用户锁定的所有内容，您可以使用一些 svn+xml+xslt voodoo。首先，像这样创建一个 svninfo.xml 文件：

```
 svn info -R --xml http://url/to/project/root >> svninfo.xml 
```

之后在结果文件中添加这个 xslt 样式表预处理器元素`<?xml version="1.0"?>`

```
 <?xml-stylesheet type="text/xsl" href="svnlocks.xsl" ?> 
```

使用此内容创建一个 svnlocks.xsl 文件，替换`username`为实际用户名：

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
   <xsl:template match="/">
      <html><body>
      <xsl:apply-templates select="info/entry[lock/owner='username']" />
      </body></html>
   </xsl:template>
   <xsl:template match="entry">
      <xsl:value-of select="@path"/><br/>
   </xsl:template>
</xsl:stylesheet> 
```

最后，用你喜欢的浏览器打开 svninfo.xml。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T23:19:28.060

使用[svn status](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.status.html)来获取用户锁定的所有文件的列表——我的意思是，所有设置了[svn:needs-lock](http://svnbook.red-bean.com/en/1.5/svn.advanced.locking.html)属性的文件，并且用户已经使用[svn lock](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.lock.html)命令获得了这些锁。

如果你使用命令行，你会在每个被锁定的文件上看到一个 O 标记，运行 svn status --show-updates。要找出谁锁定了该文件，请使用[svn info](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.info.html)。（注意，如果你有一个文件被锁定，svn status 将显示 K）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T21:00:12.193

Do you mean to search for files *locked* by a specific user? Because you can't search for files checked out by a particular user (without raiding that user's home directory).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T12:46:23.067

如果您能够`svnadmin`在存储库机器上使用，那么您可以使用`svnadmin lslocks <repo>`来获取该存储库上持有的所有锁的详细信息。从那里，您可以编写一些内容以按用户名过滤。

有关详细信息，请参阅[The Subversion Book: Advanced Locks (Breaking & Stealing Locks)](http://svnbook.red-bean.com/en/1.5/svn.advanced.locking.html#svn.advanced.locking.break-steal)。

# continuous-integration - 使用 dvcs 是否会使在企业环境中使用持续集成变得更加困难？

> ID：923150
> 
> 赞同：5
> 
> 时间：2009-05-28T20:57:23.883
> 
> 标签：continuous-integration, dvcs

毫无疑问，使用 dvcs 有很多优势，它可以像集中式 vcs 一样使用，但是是否有本地提交并且能够非常轻松地为一些较小的团队分叉项目，这使得支持持续集成变得更加困难？它有助于开发，每个人都可以访问最新的更改，这些更改由 CI 服务器测试，因此可以最大限度地减少不兼容更改的可能性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-28T21:14:10.060

您可以集中 DVCS。DVCS 和集中式的区别在于，使用 DVCS，您不必*集中*它。

您可以拥有一个中央存储库，每个人都可以在其中推送更改，并且每个人都可以从中提取最新代码。您可以在服务器上编写一个提交挂钩，以便每次有人推送代码时，它都会运行测试以确保它通过测试。这就像集中式版本控制，只是更好，因为我可以在准备推送到中央服务器之前创建一个本地分支并进行多次本地提交。

你有没有做过一个大的改变，破坏了很多东西，并且想要做几个提交，但在你完成并且一切都再次修复之前不要分享它们？这就是 DVCS 让一切变得简单的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T11:51:01.463

它确实使执行 CI 变得更加困难，因为源代码控制系统鼓励您不要持续集成。但是，绝对没有什么可以阻止您定期集成到中央存储库中。团队只需要对此保持自律。

在较小的团队分叉项目并暂时做自己的事情的情况下，您也应该针对该分叉进行持续集成构建，并可能在两个分叉之间建立定期集成。

这类似于 Accurev 推动的基于流的多阶段持续集成策略：
[http ://www.accurev.com/multistage-continuous-integration.html](http://www.accurev.com/multistage-continuous-integration.html)

# client-side - 跨 Javascript 和 C# 的类库的设计策略

> ID：923151
> 
> 赞同：3
> 
> 时间：2009-05-28T20:57:29.440
> 
> 标签：client-side, server-side, class-library

我正在实现一些对象，它们在客户端和服务器端都将具有相同的丰富性。

在这种特殊情况下，我将构建一个（希望如此）小类库来处理搜索标记。因此，作为一个伪代码示例，我希望能够在 Javascript 和服务器（在我的情况下为 C#）中执行以下等效操作。

```
s = new SearchTokenList();
s.Add(new SearchToken(field, value, negation)); 
```

哪些设计策略将有助于避免为必须跨越 C# 和 Javascript 的库创建一大堆泥巴？

更新：寻找比机制更多的策略。但我会从以前做过类似事情的人那里得到任何指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T19:57:39.463

看看 Nikhil Kothari 的 Script#，可能会对您有所帮助。它是一个 C# 到 JavaScript 的编译器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-06T22:21:20.150

[我认为您应该在http://jsc.sourceforge.net/](http://jsc.sourceforge.net/)上查看我的 C# 到 JavaScript 编译器

与 Script# 不同，我的 jsc 编译器在 MSIL 级别上工作。

WPF 示例：[AvalonExampleGallery](http://jsc.sourceforge.net/examples/avalon/AvalonExampleGalleryDocument.htm) [![替代文字](https://i.stack.imgur.com/r6qH2.png)](https://i.stack.imgur.com/r6qH2.png)

如果您有任何具体问题，请与我联系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-07T06:55:26.997

如果性能不重要，您可以以 JSON 或 XML 格式加载数据并将其传递回服务器端并进行处理。我认为 WCF 可以开箱即用地生成 JavaScript 接口。请参阅[.NET 示例：从 Javascript 调用 WCF 服务](http://dotnetbyexample.blogspot.com/2008/02/calling-wcf-service-from-javascript.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-06T20:45:13.307

您应该能够使用 Microsoft 的[JScript.NET](http://msdn.microsoft.com/en-us/library/3bf5fs13.aspx)在您的 .NET 服务器上运行一些 Javascript 代码——使用它进行编译`/target:library`并确保它符合 CLS 并且您使用

```
[assembly:System.CLSCompliant(true)] 
```

[或CLS 合规性声明](http://msdn.microsoft.com/en-us/library/system.clscompliantattribute(VS.71).aspx)的其他变体。一旦你得到这个工作，你可以在服务器（从 C# 调用它）和客户端（从其他 JS 调用它）上运行（一点）JS 代码，并且更容易确保双方的功能相同。

# asp.net - 我应该采取什么措施来保护我的多层 ASP.NET 应用程序？

> ID：923154
> 
> 赞同：4
> 
> 时间：2009-05-28T20:57:56.333
> 
> 标签：asp.net, security

我正在设计一个应该处理敏感信息（比如财务数据）的多层 ASP.NET Web 应用程序。

我想确定应用程序在现实生活中将面临的**所有潜在威胁，并相应地规划***对策*。

一些细节：

*   该应用程序将托管在客户的数据中心，供内部和外部用户使用
*   目标平台是 Windows Server 2008 + IIS7 或 Windows Server 2003 + IIS6
*   目标数据库是 MS SQL Server 2008

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T21:03:22.610

Phew! Where to start... Depends on how "secure" you need it to be. i.e. Difference between a personal blog and a large project for a large company/government dept. etc...

In no particular order

*   Secure your configuration files by encrypting them.
*   Ensure that your Database is behind some sort of DMZ and not on a publically accessible IP
*   Get a security company to give your site an overhaul for potential vulneribilities (Cross Site Scripting / Sql Injection)
*   Use SSL
*   Lock down everything port-wise on the server except for 80 HTTP & 443 HTTPS unless absolutely necessary
*   Make sure your Remote Desktop/VNC connections to the box are secure
*   If your storing passwords in the DB, hash & salt them and don't store plain text
*   Publish your code, and don't leave source code on the server
*   Build your code based on known standards, i.e. don't write your own Crypto Algorithms
*   If secure connections between the Site->DB or Site-MSMQs are available, use them

Microsoft have a good article on securing ASP.NET apps that i'll dig out.

**Edit**

And as Syed just posted in his reply, (+1 a credit to him)

[Building Secure ASP.NET Applications: Authentication, Authorization, and Secure Communication](http://msdn.microsoft.com/en-us/library/aa302415.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T21:03:20.923

[http://msdn.microsoft.com/en-us/library/aa302415.aspx](http://msdn.microsoft.com/en-us/library/aa302415.aspx)

for multi layer security. [http://msdn.microsoft.com/en-us/library/aa302415.aspx#secnetlp_part3](http://msdn.microsoft.com/en-us/library/aa302415.aspx#secnetlp_part3)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T21:03:57.070

that is a very large (broad) question, there are complete books on security that can not answer that. Go to Borders and get a few security books and start reading.

# sql - SQL: Have 4 Tables, Looking to find unmatched data

> ID：923161
> 
> 赞同：0
> 
> 时间：2009-05-28T20:59:17.593
> 
> 标签：sql, ms-access

I've always done this back asswards in PHP or ASAP, so I figure it's time to actually learn the proper way to do it in SQL. I have the following 4 tables in a database:

Category (Fields: CategoryNumber, Desc) (small table with 15 rows)

Media (Fields: MediaID, Desc, CategoryNumber, etc) (huge table with 15,000 rows)

Sales (Fields: Date, MediaID, EmployeeID etc) (huge table with 100,000 rows)

Employees (Fields: EmployeeID, Name, etc) (small table with only 20 rows)

Category only links to Media Media has links to both Category and Sales. Sales links to both the Media and Employee Employee only links to Sales

What I would like to do is to write a query which tells me what categories a given employee has never sold any media in.

I can write a simple query that looks for unmatched data between 2 tables, but I have no clue how to do it when I'm dealing with 4 tables.

Thanks for your time and help!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T21:07:54.050

这是我的建议：

```
select *
from Category c
where not exists (
    select *
    from Employee e
    inner join Sales s on s.EmployeeId = e.EmployeeId
    inner join Media m on m.MediaID = s.MediaID
    where e.Name = 'Ryan' and m.CategoryNumber = c.CategoryNumber
) 
```

查询所有员工没有销售任何东西的类别：

```
select e.EmployeeName, c.CategoryNumber
from Category c
cross join Employee e
where not exists (
    select *
    from Sales s
    inner join Media m on m.MediaID = s.MediaID
    where c.categoryNumber = m.CategoryNumber
    and s.EmployeeId = e.EmployeeId
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T21:06:01.980

```
SELECT c.CategoryNumber, c.Desc
FROM   Category c
WHERE NOT EXISTS
(
SELECT *
FROM       Employees e
INNER JOIN Sales     s on s.EmployeeID = e.EmployeeID
INNER JOIN Media     m on m.MediaID    = s.MediaID
WHERE e.Name = "Ryan"
AND   m.CategoryNumber = c.CategoryNumber
) 
```

MS Access evidently needs a lot of parentheses (thanks, Ryan!):

```
select * 
from Category c 
where not exists 
( select * 
from (     Employee e 
inner join Sales    s on (s.EmployeeId = e.EmployeeId)) 
inner join Media    m on (m.MediaID    = s.MediaID) 
where (e.Name = 'Ryan' and m.CategoryNumber = c.CategoryNumber) ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T21:14:11.213

```
select c.desc
from category
left outer join (select s.employeeid,m.categorynumber
         from sales s 
         inner join media m on s.mediaid=m.mediaid
         inner join employee e on e.employeeid=s.employeeid
         where e.name = 'JOE'
         group by employeeid,categorynumber) t on t.categorynumber=c.categorynumber
where s.employeeid is null 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-29T14:16:08.860

根据 Carl 在 Access SQL Syntax 中提供的解决方案修改答案：

```
 select *
from Category c
where not exists (
    select *
    from (Employee e
    inner join Sales s on (s.EmployeeId = e.EmployeeId))
    inner join Media m on (m.MediaID = s.MediaID)
    where (e.Name = 'Ryan' and m.CategoryNumber = c.CategoryNumber)
)c# - 数组到列表 - 无法使 AddRange(IEnumerable) 工作

ID：923167

赞同：3

时间：2009-05-28T20:59:44.550

标签：c#, arrays, .net-3.5, list

我很抱歉这个幼稚的问题。我有以下内容：

```
public Array Values
{
  get;
  set;
}

public List<object> CategoriesToList()
{
  List<object> vals = new List<object>();
  vals.AddRange(this.Values);

    return vals;
} 
```

但这不起作用，因为我无法键入数组。有什么方法可以轻松修复上面的代码，或者通常将 System.Collections.Array 转换为 System.Collections.Generic.List？

            回答 #1

赞同：5

时间：2009-05-28T21:04:35.167

确保您是`using System.Linq;`，然后将您的线路更改为：

`vals.AddRange(this.Values.Cast<object>());`

编辑：您还可以遍历数组并单独添加每个项目。

再次编辑：另一个选项可以简单地将数组转换为`object[]`并使用该`ToList()`函数或将其传递给`List<object>`构造函数：

`((object[])this.Values).ToList();`

或者

`new List<object>((object[])this.Values)`

            回答 #2

赞同：2

时间：2009-05-28T21:05:54.070

你能把你的财产声明改成这个吗？：

```
public object[] Values { get; set; } 
```

            回答 #3

赞同：0

时间：2009-05-28T21:07:12.413

使用 System.Linq；...

```
 public object[] Values
    {
        get;
        set;
    }

    public List<object> CategoriesToList()
    {
        List<object> vals = new List<object>();
        vals.AddRange(Values.ToList());

        return vals;
    } 
```

            回答 #4

赞同：0

时间：2009-05-28T22:09:36.203

如果您不想使用 linq，您可以简单地转换：

```
vals.AddRange((IEnumerable<object>) this.Values); 
```

        sqlmetal - SqlMetal 脚本和大写

ID：923184

赞同：1

时间：2009-05-28T21:04:22.013

标签：sqlmetal

当我运行 SqlMetal 时，它会生成所有带有大写字母的视图和函数。他们是一种让它在数据库中的任何情况下生成它的方法吗？

当我使用 UI 构建 DBML 和 CS 文件时，它会正确处理此问题，但是当我编写脚本时，SqlMetal 似乎将它们设为大写。

这没什么大不了的，但这让我想知道它们是否是我不知道的其他细微变化，或者我只是在做一些愚蠢的事情。

如果有帮助，这就是我正在做的事情：

```
SqlMetal.exe /conn:"Data Source=server1\developer2008;Initial Catalog=Dingo;Integrated Security=true" /views /functions /sprocs /pluralize /language:csharp /namespace:"Foo_Api" /context:"DataClassesFooDataContext" /dbml:"foo.dbml"

SqlMetal.exe /code:"foo.designer.cs" "foo.dbml" 
```

            回答 #1

赞同：0

时间：2009-06-04T11:19:52.050

您能否在获取数据库模式和生成代码之间对 foo.dbml 执行转换（它是 XML）？

        ruby-on-rails - 在 Rails 中覆盖 before_save 过滤器以进行测试

ID：923185

赞同：0

时间：2009-05-28T21:04:34.167

标签：ruby-on-rails

我的模型类上有一个`before_save`过滤器，它将日期字段设置为未来日期，以保证数据的完整性。

除了单元测试之外，这非常有效。我想设置一个测试场景，其中涉及将此日期字段设置为过去的日期。我不能这样做，`ActiveRecord`因为`before_save`过滤器被调用并且日期被更新到未来的日期。执行原始 SQL 的最佳方法是使用`ActiveRecord::Base::connection.update`?

            回答 #1

赞同：2

时间：2009-06-01T16:06:37.357

也许最好使用模拟对象。有关模拟对象的快速介绍，请阅读

[http://erikonrails.wordpress.com/2008/05/07/how-to-use-mock-objects/](http://erikonrails.wordpress.com/2008/05/07/how-to-use-mock-objects/)

            回答 #2

赞同：0

时间：2009-05-29T08:33:23.047

它可能被认为是一种 hack，但您始终可以在单元测试中重新打开模型类并覆盖`before_save`过滤器的实现。

            回答 #3

赞同：0

时间：2009-05-29T16:18:59.137

如果您不允许这种情况发生，为什么您需要测试它何时发生？

我的意思是，如果您永远不允许将过去的日期保存到该模型中，那么您永远不应该拥有它，那么有什么要测试的？

似乎应该做的唯一测试是确保当您尝试保存过去的日期时，它可以正确处理

        java - 执行存储过程时使用 Microsoft JDBC 驱动程序的开销

ID：923188

赞同：1

时间：2009-05-28T21:04:53.073

标签：java, sql-server-2005, jdbc

我正在使用带有 SQL Server 2005 的 Microsoft JDBC Driver 2.0。为了更好地解释我的问题，让我从调用存储过程的示例代码开始。

```
public static void executeSproc(Connection con) 
{
  CallableStatement cstmt = con.prepareCall("{call dbo.getEmployeeManagers(?)}");
  cstmt.setInt(1, 50);
  ResultSet rs = cstmt.executeQuery();

  while (rs.next()) {
     // print results in the result set
  }
  rs.close();
  cstmt.close();
} 
```

使用 SQL Profiler 我看到 JDBC 驱动程序生成以下 sql 语句来进行调用 -

```
declare @P1 int
set @P1=1
exec sp_prepexec @P1 output, N'@P0 int', N'EXEC getEmployeeManagers @P0', 50
select @P1 
```

所以这意味着当我使用 CallableStatement 执行存储过程时，`sp_prepexec` 
会调用该语句。后来当我关闭语句时，`sp_unprepare` 
调用了。这似乎是 JDBC 驱动程序的默认行为。问题是，生成准备好的语句然后关闭它的开销会影响性能。驱动程序有没有办法直接执行存储过程？为什么司机不能这样做——

```
exec getEmployeeManagers @P0=50 
```

            回答 #1

赞同：4

时间：2009-05-29T17:29:06.937

尝试使用 SQLServer 的[jTDS](http://jtds.sourceforge.net)驱动程序。我在工作中使用它，它似乎比MS提供的驱动程序好很多。

        .net - Simple menu-like navigation in WinForms

ID：923190

赞同：0

时间：2009-05-28T21:05:28.830

标签：.net, winforms, user-interface, navigation

I am writing a very simple WinForms application with few data-entry forms. But before the user gets to these forms, she has to select which action to take (ie which form to open, possibly after entering a search query). As this application is a rewrite of a legacy custom DOS FoxPro app, the user wants the UI to be as similar (read simple) to the old one as possible. *(Please note I do not want to discuss how to persuade the customer to migrate to a more modern UI.)*

Now, the UI should look like this:

```
│--------------│
│ Customers >> │ │-----------------│
│ Invoices     │ │ Find customer   │
│ -------------│ │ Create new      │
│ .. etc..     │ │ Delete customer │
│ -------------│ │-----------------│
│ Exit         │
│--------------│ 
```

The menu has to be quite large and in the middle of the screen (form). This means that classic MenuStrip is out of the question. Should I create ListBoxes on the fly with the appropriate items? How would you approach this? I already have the navigation structure in stored in objects, I am looking for advice how to present the navigation UI to the user.

Also, in this case keyboard input is essential and more important than mouse interaction.

            回答 #1

赞同：1

时间：2009-05-28T21:37:07.160

我参与的一个旧项目是将 DOS (Clipper) 应用程序转换为 Windows。我们决定采用与此类似的方式，具有更多的网络感觉（单击超链接）：

```
- - - - - - - - - - - - - - - - - - - - - - - 
| Bolded Group Header | Bolded Group Header |
|   Item Link 1       |   Item Link 3       |
|   Item Link 2       |   Item Link 4       |
- - - - - - - - - - - - - - - - - - - - - - - 
```

双击组标题时，该组中的所有链接将在后台立即打开。此外，通过工具栏选择应用程序的上下文（例如选定的客户），因此始终显示当前客户的详细信息。

从技术上讲，我们使用了源自 TPanel 的控件（这是使用 C++Builder 中的 VCL）和客户区标签，但您可以在 .NET 中轻松地做类似的事情。

祝你好运！

编辑：只是为了更新，因为您提到了键盘支持，面板获取所有 Windows 消息和击键，因此对它们的响应取决于您（我们有完整的键盘支持，但我们确实必须自己编写代码）。如果您想要无需编写任何代码就可以正常工作的东西，我会使用 ListView 而不是 ListBox 控件。

            回答 #2

赞同：1

时间：2009-05-28T21:37:39.373

我一直在为我的 windows ui使用[Krypton控制套件，它使用起来非常简单，而且该工具包是免费的。](http://www.componentfactory.com/)它有一些很棒的[上下文菜单](http://www.componentfactory.com/toolkit_contextmenu.php)选项。还有一个导航控件，它提供了一堆菜单选项。

            回答 #3

赞同：0

时间：2009-05-28T21:34:04.280

我认为您可以使用 ToolStrip 控件来执行此操作。设置 Dock=None 和 LayoutStyle=VerticalStackWithOverflow 作为开始。

        sql-server - Execute SQL Server SSIS Package From Stored Procedure

ID：923195

赞同：8

时间：2009-05-28T21:06:08.110

标签：sql-server, stored-procedures, ssis

I have a SSIS package that is stored in a SQL Server 2005 DB.  I am trying to execute  this package from a stored procedure on the same server.   Is there a better way than exec master..xp_cmdshell 'dtexec /SQL...

I am running into (I think) file system permission issues with xp_cmdshell that is preventing execution

            回答 #1

赞同：4

时间：2009-05-28T21:27:02.170

我不这么认为，这里有两篇好文章：

[http://www.simple-talk.com/sql/sql-server-2005/executing-ssis-packages-/](http://www.simple-talk.com/sql/sql-server-2005/executing-ssis-packages-/)

[http://www.codeproject.com/KB/database/Call_SSIS_from_SP.aspx](http://www.codeproject.com/KB/database/Call_SSIS_from_SP.aspx)

            回答 #2

赞同：4

时间：2009-05-31T01:49:53.663

我建议改用代理：

1.  为将运行作业的帐户创建代理代理帐户
2.  创建运行此包的代理作业
3.  使其使用在#1 中创建的代理帐户
4.  测试作业
5.  在 SQL 代码中，用于`sp_start_job`启动此作业

缺点是您不能通过这种方式轻松地将参数从 SQL 传递到包。

            回答 #3

赞同：1

时间：2015-08-19T07:48:05.073

自 2012 年以来，MSSQL 有一个 SSIS 目录，您可以将您的包放在那里。然后，您可以执行带有参数的包。这样我们就可以避免`xp_cmdshell`调用`dtexec`，或者`sp_start_job`不带参数。关键 SP：`create_execution`、`set_execution_parameter_value`和`start_execution`。

来自 MSDN：

[使用 SQL Server Management Studio 在服务器上运行包](https://msdn.microsoft.com/en-us/library/hh231084.aspx)

[使用存储过程部署和执行 SSIS 包](https://msdn.microsoft.com/en-us/library/jj820152%28v=sql.120%29.aspx?f=255&MSPPError=-2147217396)

        reporting-services - What happened to the ReportingService.Render Method()

ID：923196

赞同：1

时间：2009-05-28T21:06:17.360

标签：reporting-services, ssrs-2008, render, reportingservices-2000

Our company started using SQL Server reporting services integrated with sharepoint from the old reporting services with SQL 2000\.  The web service that is available is called ReportingService2006 and it has lost the .Render method that used to be available in the old ReportingService.  My question is what happened?  How do I render a report now.  Unfortunately the report viewer control is not an option.

            回答 #1

赞同：2

时间：2009-06-01T19:21:16.417

渲染方法已从 ReportingService 移至 ReportExecutionService

        ruby-on-rails - Rails Ajaxy File Upload

ID：923198

赞同：1

时间：2009-05-28T21:06:26.253

标签：ruby-on-rails, file-upload

Is there a defacto way of doing an Ajaxy file upload in Rails? (I say "Ajaxy" because it can't really use XHR). 
I've read about various approaches and plugins. Wondering what's the cleanest/most approved of by the community.

Thanks!

            回答 #1

赞同：1

时间：2009-05-28T22:47:06.067

[SWFUpload](http://www.swfupload.org/)是 Ajaxy 上传的常用工具。

这里有几个应该与 Rails 集成的链接。

[http://blog.airbladesoftware.com/2007/8/8/uploading-files-with-swfupload](http://blog.airbladesoftware.com/2007/8/8/uploading-files-with-swfupload)

[http://thewebfellas.com/blog/2008/12/22/flash-uploaders-rails-cookie-based-sessions-and-csrf-rack-middleware-to-the-rescue](http://thewebfellas.com/blog/2008/12/22/flash-uploaders-rails-cookie-based-sessions-and-csrf-rack-middleware-to-the-rescue)

            回答 #2

赞同：1

时间：2012-02-15T08:46:29.040

如果您不希望上传器基于 Flash，您可以查看[http://blueimp.github.com/jQuery-File-Upload/](http://blueimp.github.com/jQuery-File-Upload/)它非常酷。

            回答 #3

赞同：0

时间：2012-05-09T23:22:22.427

我在[Plupload](http://www.plupload.com/documentation.php)上玩得很开心。有一个 plupload-rails gem（我不相信 plupload-rails3，它太自动化了，但可能没问题）。它提供了多个运行时（html5、html4、flash、silverlight、gears，...），它们可以设置为彼此的后备，因此您可以支持所有客户端，无论他们是否有 silverlight 或 flash，或者即使他们使用互联网探险家。

jQuery-File-Upload 看起来不错，我几乎在 mu 上一个项目中使用它，但我很难让它与 Internet Explorer 很好地配合使用。（我也在使用 Amazon S3，这使事情变得复杂）

*我刚刚看到日期，我希望新来的人觉得这很有用。*

            回答 #4

赞同：0

时间：2009-05-28T22:31:39.157

我[`responds_to_parent`](http://github.com/markcatley/responds_to_parent/tree/master)在几个项目上都成功使用过。

这个想法是您正在对页面上嵌入的 iframe 进行完整的 POST。t 插件添加了一些有用的`responds_to_paren`功能，然后在主页的上下文中执行成功或失败的 javascript。

        delphi - Delphi 中是否有类似 PHP 的 vardump 的功能？

ID：923200

赞同：5

时间：2009-05-28T21:06:37.110

标签：delphi, debugging, delphi-7

我已经放弃了 Delphi 7 调试器，并且非常依赖 outputdebugstrings。是否有一个标准函数我可以调用来将对象的内容作为字符串获取，就像我设置断点时调试器一样？

            回答 #1

赞同：5

时间：2009-05-28T22:09:58.730

不完全是您要查找的内容，但您可以使用 RTTI 访问各种已发布属性的值。神奇的例程在 TypInfo 单元中。您可能最感兴趣的是 GetPropList，它将返回对象属性的列表，而 GetPropValue 将允许您获取属性的值。

```
procedure TForm1.DumpObject( YourObjectInstance : tObject );
var
  PropList: PPropList;
  PropCnt: integer;
  iX: integer;
  vValue: Variant;
  sValue: String;
begin
  PropCnt := GetPropList(YourObjectInstance,PropList);
  for iX := 0 to PropCnt-1 do
    begin
      vValue := GetPropValue(YourObjectInstance,PropList[ix].Name,True);
      sValue := VarToStr( vValue );
      Memo1.Lines.Add(PropList[ix].Name+' = '+sValue );
    end;
end; 
```

例如，在主窗体的按钮单击上使用 DumpObject(Self) 运行它，它会将当前窗体的所有属性转储到备忘录中。这只是发布的属性，并且要求主类或者从 TPersistent 继承，或者在对象之前打开 {$M+} 进行编译。

有传言说，在 Delphi 的未来版本（可能是 2010 年）中将提供类似“反射器”的能力。

            回答 #2

赞同：3

时间：2009-05-29T08:25:58.613

Consider something like [Codesite](http://www.raize.com/DevTools/CodeSite/Default.asp) which is a much more complete tracing solution. It allows you to output much more complex info, and then search, print, and analyse the data. But for your purposes, you can simply send an object to it with Codesite.Send('Before', self); and you get all the RTTI available properties in the log. Do an "After" one too, and then you can compare the two in the Codesite output just by selecting both. It's saved me many times.

            回答 #3

赞同：-2

时间：2009-05-28T21:16:49.587

如果 delphi 7 是 .NET 版本，那么您可以（其中一些）通过反射来实现。（不容易，但也不是特别难）。如果它是正常的，编译的东西，那么这是一个难题，调试器是你最好的选择，除了专门的打印功能/方法。

        php - Why is php's fsockopen returning (Resource temporarily unavailable)?

ID：923208

赞同：2

时间：2009-05-28T21:07:40.243

标签：php, performance, unix, sockets

I have a very simple server php code like this

```
function listenForClients()
 {
      $this->serviceConnection = socket_create(AF_UNIX, SOCK_STREAM, 0);
      socket_bind($this->serviceConnection, "\tmp\mysock", 0);
      socket_listen($this->serviceConnection, 10000000);

      while($clientSocket = socket_accept($this->serviceConnection))
      {
           $clientMessage = socket_read($clientSocket, 1024);
           socket_close($clientSocket);
      }
 } 
```

Then I have a very simple client that does this

```
for ( $counter = 0; $counter <= 1000; $counter ++) {    
   $fp = fsockopen("unix///tmp/mysock", 0, $errno, $errstr);

   if (!$fp){
      echo  "Error: Could not open socket connection at " . $counter . "\n";
      exit;
   }else{    
      fputs ($fp, "hello", strlen("hello"));
      fclose($fp);
   }
} 
```

For some reason, after a random number of connections (around 300-500) fsockopen will return with a warning Resource temporarily unavailable. In the beginning I was getting the warning at around 20-30 connections. But once I increased the backlog parameter in   socket_listen it got a bit better to around 300-500\. How do I overcome this? 

What is the way to build a php server socket to accept a lot of incoming connections per second (sustained). 

Thanks!

The full error:

PHP Warning:  fsockopen(): unable to
  connect to unix:///tmp/mysock:0
  (Resource temporarily unavailable) in
  test.php on line 22

            回答 #1

赞同：1

时间：2009-05-28T21:30:19.793

检查您的`ulimit`. 您是否溢出了文件描述符表？

编辑：您拥有的积压值`accept()`是虚假的。大多数操作系统的最大传入连接队列大小为几十个，而不是几千个。

            回答 #2

赞同：0

时间：2010-09-12T21:34:39.243

我一直在看这个问题（通过谷歌得到这里），我发现了一个解决错误的解决方案：

```
PHP Warning: fsockopen(): unable to connect to unix:///tmp/mysock:0 (Resource temporarily unavailable) in test.php on line 22 
```

..是不在编写线程中使用 fsockopen() ；尝试这样的事情：

```
if (! ($cSock = socket_create(AF_UNIX, SOCK_STREAM, 0))) {
    exit("Failed to create socket");
    continue;
} else if (! socket_connect($cSock, IPC_SOCK)) {
    exit("Failed to connect socket");
} else {
    $bw = socket_write($cSock, $msg);
    if ($bw === false) {
        exit("Socket write failed, %s", array(socket_strerror(socket_last_error())));
    } else {
        exit("Wrote $bw bytes to socket");
    }
}
socket_shutdown($cSock);
socket_close($cSock); 
```

迟到总比不到好 ？;-)

        html - can i tilt an image easily using HTML or CSS?

ID：923209

赞同：4

时间：2009-05-28T21:07:50.853

标签：html, css

some designs on the Apple's user's webpage show a photo that is tilted slightly, like at a 5 or 10 degree angle.  while this is no big deal, it does make the webpage totally different from "all the rest".

is it true that currently using HTML or CSS, this can't be done yet?

like the big photo in the middle:

[alt text http://img7.imageshack.us/img7/383/phototilt.png](http://img7.imageshack.us/img7/383/phototilt.png)

(the program lets you choose photos and then create the page (html and jpg) dynamically for you)

            回答 #1

赞同：10

时间：2009-05-28T21:09:42.673

CCS 3 将提供这种可能性，但它仍然不是跨浏览器，而且你不能用传统的 HTML + CSS 来做到这一点......但是。

具有倾斜图像的网站通过在 Photoshop 中旋转它并使其背景透明来实现。这就是它的全部技巧。

**提示：**将该图片保存到您的高清并自己查看。这可能只是一个具有透明背景的方形图像，或者它可能将当前背景切得很好以适合那里。

            回答 #2

赞同：10

时间：2009-05-28T21:17:33.283

您*可以*这样做，但仅限于 Firefox 3.5+ 和 Safari 3.2+（以及最近基于 webkit 的浏览器）。`-moz-transform`两者都为 skew:和`-webkit-transform`分别提供浏览器特定的 CSS 扩展。

这是一个很好的例子，它用 div 构建了一个 3d 外观的立方体：（来自  [http://www.fofronline.com/2009-04/3d-cube-using-css-transformations/](http://www.fofronline.com/2009-04/3d-cube-using-css-transformations/)）

```
<div class="cube">
        <div class="topFace">
                <div>
                        Content
                </div>
        </div>
        <div class="leftFace">
                Content
        </div>
        <div class="rightFace">
                Content
        </div>
</div> 
```

和 CSS：

```
.cube {
        position: relative;
        top: 200px;
}

.rightFace,
.leftFace,
.topFace div {
        padding: 10px;
        width: 180px;
        height: 180px;
}

.rightFace,
.leftFace,
.topFace {
        position: absolute;
}
.leftFace {
        -webkit-transform: skewY(30deg);
        -moz-transform: skewY(30deg);
        background-color: #ccc;
}

.rightFace {
        -webkit-transform: skewY(-30deg);
        -moz-transform: skewY(-30deg);
        background-color: #ddd;
        left: 200px;
} 
```

            回答 #3

赞同：8

时间：2012-02-08T09:54:45.963

是的，使用 CSS3，您可以：

```
-webkit-transform: rotate(20deg);
   -moz-transform: rotate(20deg);
    -ms-transform: rotate(20deg);
     -o-transform: rotate(20deg);
        transform: rotate(20deg); 
```

所有现代浏览器和 IE9+ 都支持。

有关更多信息，请参阅[MDN 上的 CSS 转换。](https://developer.mozilla.org/en/CSS/transform#rotate)

            回答 #4

赞同：1

时间：2009-05-28T21:11:13.983

据我所知，你不能那样做。您确定您正在考虑的图像没有在 Photoshop 或类似软件中倾斜，而是像这样添加到页面中吗？

            回答 #5

赞同：1

时间：2009-05-28T21:11:40.470

不，你不能。

倾斜图像和文本仍然是 JavaScript juju。

**编辑**：或者，至少，你不能用 CSS2。从 CSS3 开始，有一个[`transform`](http://www.w3schools.com/cssref/css3_pr_transform.asp)属性，其中包括旋转。

            回答 #6

赞同：1

时间：2009-05-28T21:12:01.280

您可以使用 Apple 特定的 CSS 属性（很快就会被批准，然后他们会为它们删除 webkit 前缀）来执行此操作和动画效果，但它现在只会显示在 Safari 和 Chrome 中。尽管如此，它们看起来还是很漂亮的，而且 CSS 做起来也很简单。

现在它可能只是在 Photoshop 中完成，并且在那里也很好地消除了锯齿，因此它具有一致的跨浏览器外观。

            回答 #7

赞同：1

时间：2009-05-28T21:19:53.230

我们在工作中正在做类似的事情，我们必须在飞行中做。

您不能仅使用 html/css 来完成，但是我们通过 php 脚本使用图像库来自动生成它们，然后使背景透明。

            回答 #8

赞同：1

时间：2009-05-28T21:20:57.457

使用 PHP GD 库。让事情变得容易得多。

        apache-flex - Flex 3 工具提示

ID：923222

赞同：0

时间：2009-05-28T21:10:49.990

标签：apache-flex, actionscript-3, dynamic, components, tooltip

我正在使用自定义的高级自动完成组件。默认情况下，选定的项目没有工具提示，但我想使用标签作为我的工具提示。

arraylist allQuestions 是我的组件的数据提供者。

```
<components:AdvancedAutoComplete id="addQuizQuestions_txt" width="800" height="300" dataProvider="{allQuestions}" labelField="questionText"
                    showBrowseButton="true"    browserFields="questionText" allowMultipleSelection="true" allowDuplicates="true" /> 
```

allQuestions.questionText 应该是我想要的标签的路径。  

我已经研究过使用事件，例如 event.currentTarget，但我认为它们不存在用于工具提示。

有谁知道如何使用提供给组件的数据添加工具提示？

            回答 #1

赞同：2

时间：2009-05-29T14:05:46.977

您要在哪里添加工具提示？在自动完成的弹出窗口内？如果是这样，则在 itemRenderer 中的组件上添加工具提示属性并将其绑定到标签控件。这是一个例子：

您必须调查源代码以查看确切发生的位置...也可以在 AS3 代码中完成，但同样适用...在标签文本集上：

myImage.tooltip = _label.text;

        iis - 用于管理 IIS / Windows 环境的代码部署/版本控制的工具

ID：923231

赞同：0

时间：2009-05-28T21:11:59.113

标签：iis, version-control, deployment

我在 Linux 和 OSX 方面拥有深厚的背景，刚刚离开了一份基于这些平台构建系统的工作。

现在我有一个运行 IIS 的 Windows Server，它拥有许多不同的网站。它们中的大多数只是一堆 HTML、JS 和图像，以及一些用于一些客户工具的 ASP。（每个网站都有一组不同的客户工具，或者它们是相同的工具，但它们之间的代码更改很小。）我还添加了一个具有相同代码的开发 Web 服务器，但“前沿”的东西。

我需要一种有效的方法来管理对整个代码库的更改和更新（此后指的是所有站点的图像、html 和 asp）。当开发人员（或网站管理员）签入更改时，我希望它自动显示在开发人员服务器上，但应该手动推送到实时服务器。我很想只制作网站 SVN 存储库，但我担心让 web 开发人员必须登录服务器并通过命令行/tortise 触发 SVN 更新（天堂禁止，管理标签）的开销。

理想情况下，我还可以管理系统之间的 IIS 配置文件设置，但主要需要能够管理进程，并将其公开给我们的 ASP 开发人员和我们的网站管理员，他们都习惯于将文件上传到现场。

那么，关于工具的任何建议（除了一些使用 BAT 文件进行 SVN 黑客攻击 + 教网站管理员如何登录服务器并进行更新）或有助于解决此问题的工作流程？我什至考虑过使用 RPM 类型的包（当然也可以是一些 Windows 等效包）来管理实时服务器，但这似乎有点过多的开销。

            回答 #1

赞同：0

时间：2009-06-04T11:17:58.437

首先，您需要确定网站管理员如何知道您的 SCM 中的最新版本已准备好部署（我假设您希望在开发人员签入后进行某种程度的验收测试）。

根据上述答案，您应该能够定义在 Web 服务器上构建和更新“已批准”内容的步骤，然后编写脚本即可。

最后问题不是要运行的命令，而是知道 /when/ 运行它们，并且开发人员的最后一次签入不一定会 100% 工作（即使没有错误，两个并发更改，每个工作，可能会发生冲突） .

        .net - 使 NUnit 在第一次失败时不停止

ID：923233

赞同：3

时间：2009-05-28T21:12:13.933

标签：.net, unit-testing, nunit

我正在对数字列表进行 NUnit 测试。

我的代码是这样的：

```
numbers = GetListOfNumbers()
foreach number in numbers
      Assert.IsTrue(TestNumber(number)) 
```

我的问题是 NUnit 会在它遇到的第一个未通过测试的数字上停止测试。

如果有任何数字没有通过，是否有让 NUnit 仍然无法通过测试的方法，但是给我所有没有通过的数字的列表？

            回答 #1

赞同：7

时间：2009-05-28T21:34:36.960

作为一种解决方法，您可以尝试以下方法，而不是像这样使用 Assert.IsTrue ：

```
numbers = GetListOfNumbers()
List<number> fails = numbers.Where(currentNum=>!TestNumber(curentNum))
if (fails.Count > 0)
    Assert.Fail(/*Do whatever with list of fails*/) 
```

            回答 #2

赞同：6

时间：2009-05-28T21:16:07.920

NUnit 2.5 有数据驱动的测试；这将完全满足您的需求。它将遍历您的所有数据并为每个数字生成单独的测试用例。

[关联](http://www.nunit.org/index.php?p=testCase&r=2.5)

            回答 #3

赞同：0

时间：2009-05-28T21:15:10.557

这可以在 MBUnit 中使用“RowTest”测试方法来完成。但是，我不知道在 NUnit 中执行此操作的方法。

        visual-studio - 为什么会显示“已在解决方案中打开该名称的项目”？

ID：923235

赞同：26

时间：2009-05-28T21:12:36.523

标签：visual-studio, tfs

我最近将一个 VSS 数据库迁移到 TFS 2008。使用源代码管理资源管理器，我获得了包含 12 个项目的解决方案的最新版本。

当我在 VS 2005 中打开解决方案时，其中两个项目没有找到。我不确定为什么找不到这两个项目，但认为最简单的方法是删除它们并将它们重新添加到解决方案中。

当我这样做时，VS 给了我一个“具有该名称的项目已在解决方案中打开”。该项目未出现在解决方案资源管理器中，并且未列在 .sln 文件中。

有任何想法吗？

            回答 #1

赞同：39

时间：2011-09-14T12:36:37.000

我遇到了这个问题，我可以使用以下步骤解决它：

1.  从解决方案中删除项目。
2.  重新启动视觉工作室。
3.  将项目作为现有项目添加到解决方案中。

            回答 #2

赞同：22

时间：2009-07-28T21:44:05.863

我有同样的消息......似乎它来自（.csproj）项目文件。在第一个属性组下有一个名为

```
<ProjectTypeGuids>...</ProjectTypeGuids> 
```

这通常告诉 Visual Studio 以某种特定方式处理该项目。一些指南可以在[这里](http://www.mztools.com/Articles/2008/MZ2008017.aspx)找到。

首先制作该文件的备份副本。然后删除该部分可以帮助您像往常一样打开项目项目。似乎 Visual Studio 认为该项目不是 ProjectTypeGuids 中指定的类型。

            回答 #3

赞同：11

时间：2010-04-14T12:24:01.297

如果有人使用 AnkhSVN 而不是 TFS，那么 .sln 文件也可能需要以下几行：

```
GlobalSection(SubversionScc) = preSolution
    Svn-Managed = True
    Manager = AnkhSVN - Subversion Support for Visual Studio
EndGlobalSection 
```

在“全球”部分。

            回答 #4

赞同：4

时间：2011-04-04T19:24:15.147

删除 .suo 文件。构建解决方案。添加项目。

            回答 #5

赞同：3

时间：2010-03-23T17:38:27.130

这为我做到了：

1.  删除`<ProjectTypeGuids>...</ProjectTypeGuids>`每个项目中的部分
2.  重新打开每个项目，然后保存覆盖现有的项目文件，最后退出
3.  重新打开解决方案文件
4.  祈祷（可选）

            回答 #6

赞同：3

时间：2010-05-12T05:15:13.737

我不得不说删除该部分`<ProjectTypeGuids>...</ProjectTypeGuids>`可能会产生一些问题。事实上，这样的部分定义了项目的类型，如果删除，可能会禁用某些功能。例如，如果您的项目最初定义为智能设备 (C#)，则在删除上述部分后，设备上的调试可能无法正常工作。

            回答 #7

赞同：2

时间：2009-05-28T21:36:38.063

我会尝试手动编辑项目/解决方案文件，它们是文本并且很容易阅读。您可以在记事本中编辑该文件。要在 Visual Studio 中将文件作为文本打开，您需要先关闭解决方案。然后执行 file->open 并选择 sln 文件，但不要点击打开按钮，而是按右侧有箭头的位置并选择 open with.. 从那里您可以选择源代码编辑器（文本）。

            回答 #8

赞同：1

时间：2012-11-28T15:31:16.923

当我将运行 vs2010 的项目移动到另一台笔记本电脑时，以下内容对我有用。

我完全删除了以下内容并且它起作用了：

```
<ProjecctType>Guid of sorts</ProjectType>
<SccProjectName>Svn</SccProjectName>
<SccLocalPath>Svn</SccLocalPath>
<SccAuxPath>Svn</SccAuxPath>
<SccProvider>SubversionScc</SccProvider> 
```

            回答 #9

赞同：1

时间：2012-05-04T13:40:25.260

当我将网站迁移到 Web 应用程序项目时，我遇到了同样的问题。

1.  卸载网络应用程序。
2.  添加现有网站。
3.  重新加载 Web 应用程序。

            回答 #10

赞同：1

时间：2014-02-18T11:40:37.037

对于那些在处理 VSTO 项目时寻找这个的人......

在打开项目之前，请确保在您的计算机中安装了适用于 Visual Studio 的 Office 工具。

            回答 #11

赞同：1

时间：2016-02-15T11:20:00.213

我通过更改 Windows 的区域设置解决了这个问题。而不是“英语（欧洲）”，我使用“英语（美国）”。其他人报告了类似的行为，例如从“俄罗斯（乌克兰）”更改为“俄罗斯（俄罗斯）”等。-AlessandroSegala

为我工作。

参考：[http://answers.microsoft.com/en-us/windows/forum/windows_10-windows_install/customized-cultures-cannot-be-passed-by-lcid-only/26eb9d4b-7ddb-4774-8a40-7a7d84ba9277? auth=1&rtAction=1455534187354](http://answers.microsoft.com/en-us/windows/forum/windows_10-windows_install/customized-cultures-cannot-be-passed-by-lcid-only/26eb9d4b-7ddb-4774-8a40-7a7d84ba9277?auth=1&rtAction=1455534187354)

            回答 #12

赞同：0

时间：2018-08-25T13:11:55.567

在我的情况下，它是损坏的 vbproj 文件。缺少第一行：

```
<?xml version="1.0" encoding="utf-8"?> 
```

添加此行后，我不得不关闭解决方案，删除`.vs`文件夹并再次打开。

        c# - Linq将某些属性选择到另一个对象中？

ID：923238

赞同：28

时间：2009-05-28T21:12:52.387

标签：c#, .net, vb.net, linq, .net-3.5

所以说我有一个 Bloops 的集合

```
Class Bloop
  Public FirstName
  Public LastName
  Public Address
  Public Number
  Public OtherStuff
End Class 
```

然后我有一类 Razzies

```
Class Razzie
  Public FirstName
  Public LastName
End Class 
```

是否可以使用 Linq 从 Bloops 集合中的所有 Bloops 中选择 FirstName 和 LastName 并返回 Razzies 集合？还是我仅限于 For-Loop 来完成我的工作？

为了消除任何混淆，VB 或 C# 都可以。这也可能会导致我问（使用“Where”子句怎么样）的问题。

            回答 #1

赞同：45

时间：2009-05-28T21:16:18.247

```
List<Bloop> myBloops = new List<Bloops>;
//populate myRazzies
List<Razzie> myRazzies = myBloops.Select(x => new Razzie() { FirstName = x.FirstName, LastName = x.LastName}).ToList(); 
```

            回答 #2

赞同：29

时间：2009-05-28T21:17:36.217

这应该做的工作：

```
Dim results = From item In bloops _
              Select New Razzie() With _
              { _
                  .FirstName = item.FirstName, _
                  .LastName = item.LastName _
              } 
```

如果您想将结果从`IEnumerable<Bloop>`（LINQ 查询返回的内容）转换为数组 or `List<Bloop>`，只需分别附加对`ToArray()`or`ToList()`扩展方法的调用。

编辑：更正了代码，使其现在具有有效的 VB.NET 9 语法。

            回答 #3

赞同：2

时间：2011-05-06T10:04:21.753

```
public void Linq9()
{
    string[] words = { "aPPLE", "BlUeBeRrY", "cHeRry" };

    var upperLowerWords =
        from w in words
        select new { Upper = w.ToUpper(), Lower = w.ToLower() };

    foreach (var ul in upperLowerWords)
    {
        Console.WriteLine("Uppercase: {0}, Lowercase: {1}", ul.Upper, ul.Lower);
    }
} 
```

            回答 #4

赞同：0

时间：2009-05-28T21:31:55.873

[使用Enumerable.Select](http://msdn.microsoft.com/en-us/library/bb548891.aspx)可以完成从一种类型到另一种类型的转换

事实上，有一个来自 101 个 linq[样本](http://msdn.microsoft.com/en-us/vcsharp/aa336758.aspx)的样本显示了一个将整数转换为字符串的查询。

            回答 #5

赞同：0

时间：2013-01-31T04:53:20.100

```
 C# Sample - Thanks to earlier posters.

        List<clsObj> myList = new List<clsObj>();
        clsObj clsObjInstance = null;
        for (int i = 0; i < 10; i++)
        {
            clsObjInstance = new clsObj() { x = (i+1) % 3, a = "A" + i.ToString() };
            myList.Add(clsObjInstance);
        }

        List<int> extIntList = myList.Select(u => u.x).ToList();
        foreach (int u in extIntList)
            Console.Write(u.ToString() + "\t");

        List<string> extStringList = myList.Select(u => u.a).ToList();
        foreach (string u in extStringList)
            Console.Write(u + "\t"); 
```

        configuration - 如何让 TeamCity 排除 nunit 测试类别？

ID：923245

赞同：3

时间：2009-05-28T21:14:39.060

标签：configuration, nunit, continuous-integration, teamcity

我正在使用 TeamCity VisualStudio sln 配置来驱动我的 CI 构建。它运行我所有的 NUnit 测试——这一切都很好，但我不希望 TeamCity 使用 [Category("DatabaseTests")] 属性运行我的任何测试（因为它们命中了一个实际的数据库）。

在要排除的类别下的 NUnit 配置中，我只放置了**DatabaseTests**但它不起作用。有什么我想念的吗？有没有办法让我看到 teamcity 发送给 nunit 跑步者的内容？

            回答 #1

赞同：3

时间：2009-05-28T21:42:19.753

您可以打开 DEBUG 模式：

为 TeamCity 类启用“调试”日志级别。为此，请通过删除所有包含注释的行来编辑 logs/teamcity- (server|agent)-log4j.xml 文件。之后，调试消息将转到 teamcity-*.log 文件。

确保默认情况下轮换日志。启用调试后，将相关 appender 标记中的 maxBackupIndex 值增加到 10 甚至 20 个文件是有意义的（确保有足够的可用磁盘空间）。

...我从他们的[文档](http://www.jetbrains.net/confluence/display/TCD4/Reporting+Issues)中得到的。然后你可以看到正在发生的事情。

        .net - 反射和通用类型导致 null

ID：923250

赞同：1

时间：2009-05-28T21:15:51.477

标签：.net, reflection

我需要通过反射获取 IProcessor 的类型对象，根据文档我需要执行以下操作：

```
Type.GetType("IProcessor`1[System.Int32]") 
```

但是，这将返回 null。然后我尝试了：

```
Type.GetType(typeof(IProcessor<int>).FullName) 
```

仍然得到一个空值。

但是，我能够通过以下方式获取 Type 参数：

```
Type.GetType(typeof(IProcessor<int>).AssemblyQualifiedName) 
```

但不幸的是，我在呼叫站点上没有可用的版本、文化或公钥。关于如何获取类型对象的任何建议？

编辑：下面提到的错别字已更正编辑：在代码中使用 typeof 运算符不是一种选择。我需要从字符串中获取类型对象运行时

            回答 #1

赞同：5

时间：2009-05-29T01:47:12.647

由于问题中的示例存在语法错误，因此您必须更加小心地转录您所询问的代码；“FullName”和“AssemblyQualifiedName”需要在括号外，而不是直接在类型上。

因此，我假设您的意思是：

```
Type.GetType("IProcessor`1[System.Int32]"); 
```

`IProcessor`（注意和之间的反引号`1`，这很重要）

至少要使此语法起作用，您必须包含该类型所在的完整命名空间，例如，如果`IProcessor`在命名空间`MyApp.Interfaces`中，则代码应为：

```
Type.GetType("MyApp.Interfaces.IProcessor`1[System.Int32]"); 
```

但是请注意，这仅在您引用的类型位于您进行此调用的同一程序集内时才有效。如果不是，那么至少您将不得不将程序集名称添加到调用中，例如（假设它位于名为 的程序集中`MyAssembly`）：

```
Type.GetType("MyApp.Interfaces.IProcessor`1[System.Int32], MyAssembly"); 
```

            回答 #2

赞同：1

时间：2009-05-28T21:47:08.950

typeof 运算符需要一个类型名称，并直接返回 Type 对象。因此，如果您可以在代码中引用类型，则只需使用即可获取类型

```
typeof(IProcessor<int>) 
```

或者，对于开放的泛型版本，您然后使用反射构造一个封闭的类型

```
typeof(IProcessor<>) 
```

        .net - 有没有办法获得即将由 Linq2Sql 表达式运行的完全可执行的 SQL 字符串？

ID：923256

赞同：0

时间：2009-05-28T21:16:57.170

标签：.net, sql, linq, linq-to-sql, debugging

我知道您可以获得 SQL，但它是参数化的，但参数不可见。可以这么说，你能得到“完整”的字符串吗？

            回答 #1

赞同：2

时间：2009-05-28T21:21:54.647

Scott Guthrie 创建了一个插件，可以在调试器中使用。

[在这里得到它](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx)

        asp.net - 您可以将 asp:customvalidator 与 asp:ChangePassword 控件一起使用吗？

ID：923267

赞同：1

时间：2009-05-28T21:19:42.513

标签：asp.net, customvalidator

我正在寻找有关如何为 asp:ChangePassword 控件使用自定义验证控件的想法。在 asp:CustomValidator 控件上设置“ControlToValidate”属性的简单尝试会导致：

无法验证由“passwordValidation”的 ControlToValidate 属性引用的控件“changePassword1”。

谢谢。

            回答 #1

赞同：2

时间：2009-07-22T12:34:08.790

导致此错误消息的根本问题是 ChangePassword 控件没有在类级别设置“ValidationProperty”属性。如前所述，您可以在 CustomValidator 中省略 ControlToValidate 属性。这可能是 ChangePassword 控件的最佳方案。

如果您尝试将 CustomValidator 与自定义控件一起使用，请在自定义控件的类上设置 ValidationProperty：

```
[DefaultProperty("StateName"), ValidationProperty("StateName")]
public class StateBox: CompositeControl
{
    ... 
```

如果要将 CustomValidator 与未设置 ValidationProperty 属性的库控件一起使用，请从库控件派生一个类并在派生类上设置 ValidationProperty。

            回答 #2

赞同：1

时间：2009-05-28T21:23:52.317

如果您使用 javascript 直接获取控件，则可以使用 CustomValidator 验证任何内容。无法设置 ControlToValidate 意味着您无法获取 EventArgs 中的数据，必须自己获取。

            回答 #3

赞同：0

时间：2009-05-29T00:53:31.677

是的，只需使用模板：

[http://quickstarts.asp.net/QuickStartv20/util/srcview.aspx?path=~/aspnet/samples/ctrlref/login/ChangePasswordTemplates.src](http://quickstarts.asp.net/QuickStartv20/util/srcview.aspx?path=~/aspnet/samples/ctrlref/login/ChangePasswordTemplates.src)

[http://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/login/changepassword.aspx](http://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/login/changepassword.aspx)

只要 textbox-id 是“用户名”（或您想要验证的任何内容），您就可以向模板添加任何类型的验证器。

            回答 #4

赞同：0

时间：2009-05-28T21:25:33.983

您需要将 ChangePassword 控件更改为模板化控件才能使用自定义验证器。请务必将自定义验证器的验证组设置为与模板中的其他控件相同。或者，ChangePassword 控件具有可能满足您需要的 NewPasswordRegularExpression 属性。

        javascript - 为什么带有 jQ uery 变量的 addTextObject() 不起作用？

ID：923271

赞同：0

时间：2009-05-28T21:20:42.027

标签：javascript, jquery, windows-desktop-gadgets

在开发 Windows Vista/7 小工具并使用[addTextObject](http://msdn.microsoft.com/en-us/library/aa359355(VS.85).aspx) () 输出文本时，此方法有效：

```
var mytext = "Hello";
document.getElementById("background").addTextObject(mytext , "Verdana", 11, "white", 10, 10); 
```

但我不能让这个 jQuery 选择器进入一个变量来工作：

```
var mytext = $("#myid").text();
document.getElementById("background").addTextObject(mytext , "Verdana", 11, "white", 10, 10); 
```

它不起作用，它只写一个空字符串。为什么？

            回答 #1

赞同：0

时间：2009-05-28T22:07:47.830

我发现了原因。我的 div 中的内容是使用 jQuery 动态添加的。

```
<div id="myid"></div>

$("#myid").append("somedata"); 
var mytext = $("#myid").text();
System.Debug.outputString(mytext); // Empty 
```

出于某种原因，这在小工具中不起作用。它确实可以在纯 HTML 文件中工作...

静态内容在小工具中确实有效：

```
<div id="myid">somedata</div>

var mytext = $("#myid").text();
System.Debug.outputString(mytext); // Ok 
```

谁能解释我如何在侧边栏中查询动态添加的内容？更新：
[这](https://stackoverflow.com/questions/923489/is-there-a-way-to-query-html-xml-content-from-a-variable-using-jquery)解决了我的问题。

            回答 #2

赞同：0

时间：2009-05-28T23:06:48.740

试试[$(document).ready](http://docs.jquery.com/Tutorials:Introducing_%24%28document%29.ready%28%29)

```
 $(document).ready(function() {
    $("#myid").append("somedata"); 
    var mytext = $("#myid").text();
    System.Debug.outputString(mytext);
}); 

```

也许您的代码在 DOM 完成之前正在运行。

        ms-access - 使用带参数的访问查询导出为文本

ID：923274

赞同：2

时间：2009-05-28T21:21:48.920

标签：ms-access, export

问候，

我有一个访问查询，它使用内置参数（例如 [开始日期]）在运行查询时提示用户输入日期参数​​。

在大多数情况下，这工作正常，除了今天我尝试将查询导出到文本文件并且收到错误消息：

参数太少。预计2。

这是有道理的，因为查询 [start date] 和 [stop date] 中有两个参数，它出错的原因是我从未被提示提供值。  

如果我导出到 Excel，这可以正常工作，只是不能导出到文本文件。

有关如何解决此问题或允许我将查询导出到文本文件的任何建议？

谢谢，

[布雷特](https://stackoverflow.com/users/5836/brettski)

访问查询示例：

```
SELECT PR_EARN.Emp_No, PR_EARN.Pay_Code, PR_EARN.Hours, PR_EARN.Rate, PR_EARN.Pay_Amt, PR_EARN.Pay_Date
FROM PR_EARN
WHERE (((PR_EARN.Pay_Date) Between [Start Date] And [End Date])); 
```

            回答 #1

赞同：2

时间：2009-05-29T08:00:55.513

还有几个方法：

*   Microsoft 的[KB269671](http://support.microsoft.com/kb/269671/en-us)中提供了一种解决方法。

    基本上，您必须使用具有特殊语法的中间查询。

*   您还可以将查询更改为*Make Table*查询，然后导出其数据。

*   使用设置为查询的中间不可见数据表表单，`RecordSource`然后将其`FormLoad`事件导出为文本，然后关闭表单。

    只需打开表单就会提示用户输入参数，然后自动保存。

[罗伯特的答案](https://stackoverflow.com/questions/923274/exporting-to-text-using-access-query-with-parameters/923314#923314)可能仍然是最简单的。

            回答 #2

赞同：1

时间：2009-05-28T21:33:11.973

创建一个名为 Export 的新表单。在表单上放置两个文本框，并将它们命名为 StartDate 和 EndDate。保存表格。更改您的查询以阅读以下内容：

```
SELECT PR_EARN.Emp_No, PR_EARN.Pay_Code, PR_EARN.Hours, PR_EARN.Rate, PR_EARN.Pay_Amt, PR_EARN.Pay_Date
FROM PR_EARN
WHERE (((PR_EARN.Pay_Date) Between Forms!Export!StartDate And Forms!Export!EndDate)); 
```

双击打开表单。填写两个日期字段，并保持表单运行。以通常的方式导出您的查询。

            回答 #3

赞同：0

时间：2015-10-16T22:14:21.063

我能够通过使用 eval 函数来解决这个问题。所以而不是：

```
Between [Forms]![Reporting Import and Export]![date_exportstart] And [Forms]![Reporting Import and Export]![date_exportend] 
```

使用`Eval`：

```
Between Eval("[Forms]![Reporting Import and Export]![date_exportstart]") And Eval("[Forms]![Reporting Import and Export]![date_exportend]") 
```

        web-services - Delphi 7 Web 服务中 WSDL xml 规范的 url 在哪里？

ID：923277

赞同：1

时间：2009-05-28T21:22:47.343

标签：web-services, delphi, soap, soapui

这个问题是无意义的。困难是由于软件中的错误造成的。  

我正在尝试使用[SoapUI](http://www.soapui.org)访问网络服务。该网络服务是在 Delphi 7 中开发的。我可以使用 url 调用已发布的函数`http://server/my.dll/soap/IDataMod`。可以使用 url 中的 Web 浏览器访问 WSDL 文件的 html 表示形式`http://server/my.dll/wsdl/IDataMod`

但我找不到 WSDL xml 文件的 url。wsdl/IDataMod 页面是一个 html 文件。哪里可以买到真货？

我试过以下网址：

```
http://server/my.dll/wsdl?intf=IDataMod
http://server/my.dll/wsdl/IDataMod
http://server/my.dll/wsdl 
```

它们都返回一个 html 文档。

            回答 #1

赞同：1

时间：2009-05-29T22:49:59.257

快速回答：

网址是`http://server/my.dll/wsdl/IDataMod`

这个问题是无稽之谈，因为如果您可以看到 WSDL 的 HTML 表示，就会有一个指向 XML 文件的链接。

这确实是服务器中的一个错误。

这是肮脏的细节。该应用程序有自己的调度程序。当 URL 具有 /wsdl/ 时，它被委托给 TWSDLHTMLPublish。错误在于它应该已委托给 DispatchRequest 方法，该方法正确显示基于 URL 的 WSDL 的 XML 的 HTML。但它被委派给始终显示 HTML 表示的 ServiceInfo 方法。

            回答 #2

赞同：-1

时间：2009-05-28T22:12:16.307

尝试类似“soap/IDataMod?wsdl”

        oracle - 使用 Oracle 客户端 11 部署 .NET 应用程序所需的最低设置是什么？

ID：923283

赞同：37

时间：2009-05-28T21:23:47.047

标签：oracle, odp.net

能够部署与 Oracle 数据库通信的 .NET 应用程序所需的最小设置是什么？

            回答 #1

赞同：48

时间：2009-05-28T21:57:26.807

乔什-

非常感谢您花时间回答。您的指示帮助很大，并且与我自己发现的非常接近。

有趣的是，我发现它可以再瘦一点。

对于像我这样的人

1.  不希望他们的用户必须安装 ODAC 或全尺寸 Oracle 客户端
2.  不关心特定客户端安装的可重用性
3.  需要“clickOnce”兼容的解决方案

我找到了一种方法来做到这一点。

一种。下载“Oracle Instant Client 11.1.0.6 - Basic Lite”。湾。解压缩到任何文件夹并将以下文件复制到 Visual Studio 项目根目录：

*   oci.dll
*   ociw32.dll
*   orannzsbb11.dll
*   oraocci11.dll
*   oraociicus11.dll
*   msvcr71.dll（不是必需的，大多数 Windows 版本都应提供）

    （前五个是 Oracle Instant Client 所需的最低要求，最后一个是他们使用的 microsoft 公共运行时。）

C。下载 ODAC 11 XCopy（当前版本为 11.1.0.6）并解压缩。

*   OraOps11w.dll - 在 odp.net20 文件夹中，进入您的项目根目录。

    （此文件是 Oracle.DataAccess.dll 与之对话并用于处理 Instant Client 文件的文件）。

d。为了与 ClickOnce 部署兼容，请在您的项目中选择这些文件，并确保它们在您的项目中是“内容”和“复制本地”。然后清单将正确部署它们。

**结果**……** 添加到您的项目的有效负载是 30mb，这有点糟糕，但比 100+ 或 400+ 好得多，支持西方字符，但踢屁股** 1.  它不需要路径，

2.  不需要注册表项，

3.  在部署中是隔离的，不使用其他 Oracle 客户端安装，

4.  工程将使所有数据库恢复到 9.2。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-05-28T21:28:48.750

1.  下载 ODAC 11 XCopy 部署。

2.  提取 zip 文件并运行以下命令：

    install.bat odp.net20 c:\oracle\11.1\odac myoraclehome true

3.  从 11.1 目录复制文件并将它们放在应用程序可执行文件的子目录中（例如 debug\bin\oracle）

4.  将以下语句添加到您的 Main() 方法中。他们将更改路径，以便您的应用程序可执行文件将使用排除任何其他 oracle home 的 oracle 客户端。环境更改是您的进程独有的，并且在应用程序终止时不会产生持久影响：

    `Environment.SetEnvironmentVariable("PATH", Environment.CurrentDirectory + "\\oracle\\11.1\\odac;" + Environment.CurrentDirectory + "\\oracle\\11.1\\odac\\bin;", EnvironmentVariableTarget.Process);`

    `Environment.SetEnvironmentVariable("ORACLE_HOME", Environment.CurrentDirectory + "\\oracle\\11.1\\odac", EnvironmentVariableTarget.Process);`

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2012-11-06T19:23:18.040

不久前，这是让我的程序工作的线程（谢谢！）。我现在被告知 Oracle 不喜欢你挑选 6 个 dll 并将它们放入可执行文件夹中。所以现在，运行 install.bat odp.net2 c:\oracle odac 时安装的每个 dll 都必须放在您的可执行文件夹中（占用空间）

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2010-11-18T08:15:19.887

我正在使用 oracle 即时客户端 11g 运行。我发现部署所需的以下文件列表非常少：

```
OCI.dll
Oracle.DataAccess.dll
OraOCIEI11.dll
OraOps11w.dll 
```

只需安装完整的客户端并从 bin 文件夹中复制这些文件。

# c# - 帮助专门从 C# 背景学习 C++ 的指南

> ID：923288
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T21:25:37.043
> 
>         
> 
> 标签：c#, c++

如果您有丰富的 C# 经验，是否有任何人会推荐*专门学习 C++ 的指南/参考？*

有 C++ 指南，但很多都是从绝对基础开始的，我觉得我的 C# 学习内容已经涵盖了很多。

但是绝对基础可能是一件好事，我可能会叫错树 - 我想有些人可能会说“你应该认为它完全不同并单独学习它，否则你会错过一些东西”

实际上，我曾经在 C++ 中“还不错”，但一切都消失了……

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:31:34.643

有关 C# 到 C++ (Win32) 项目端口的有用信息。可能是一个很好的起点。

[http://blogs.cozi.com/tech/2008/03/index.html](http://blogs.cozi.com/tech/2008/03/index.html)

# sql-server - 如何在 SQL Server 中截断日期时间？

> ID：923295
> 
>         
> 
> 赞同：307
> 
>         
> 
> 时间：2009-05-28T21:28:03.747
> 
>         
> 
> 标签：sql-server, sql-server-2008, datetime, truncate

在 SQL Server 2008 中截断日期时间值（如删除小时、分钟和秒）的最佳方法是什么？

例如：

```
declare @SomeDate datetime = '2009-05-28 16:30:22'
select trunc_date(@SomeDate)

-----------------------
2009-05-28 00:00:00.000 
```

* * *

## 回答 #1

> 赞同：543
> 
>             
> 
> 时间：2009-05-28T21:35:55.977

这继续频繁地收集额外的选票，甚至几年后，所以我需要为现代版本的 Sql Server 更新它。对于 Sql Server 2008 及更高版本，这很简单：

```
cast(getDate() As Date) 
```

请注意，靠近底部的最后三段仍然适用，并且您通常需要退后一步，并首先找到避免演员表的方法。

但也有其他方法可以做到这一点。这里是最常见的。

**正确的方法（自 Sql Server 2008 以来的新方法）：**

```
cast(getdate() As Date) 
```

**正确方法（旧）：**

```
dateadd(dd, datediff(dd,0, getDate()), 0) 
```

这现在更老了，但它仍然值得了解，因为它还可以轻松适应其他时间点，例如一个月、分钟、小时或一年的第一时刻。

这种正确的方法使用作为 ansi 标准的一部分并保证可以工作的文档化函数，但它可能会慢一些。它的工作原理是找出从第 0 天到当天有多少天，然后将这些天添加回第 0 天。无论您的日期时间如何存储，也无论您的语言环境是什么，它都会起作用。

**快速方法：**

```
cast(floor(cast(getdate() as float)) as datetime) 
```

这是因为 datetime 列存储为 8 字节二进制值。将它们转换为浮点数，将它们降低以删除分数，当您将它们转换回日期时间时，值的时间部分就消失了。这一切都只是位移，没有复杂的逻辑，而且速度*非常*快。

请注意，这依赖于 Microsoft 可以随时更改的实施细节，即使是在自动服务更新中也是如此。它也不是很便携。在实践中，这种实现不太可能很快改变，但如果你选择使用它，意识到危险仍然很重要。现在我们可以选择将其投射为日期，这几乎没有必要。

**错误的方法：**

```
cast(convert(char(11), getdate(), 113) as datetime) 
```

错误的方法是转换为字符串、截断字符串并转换回日期时间。这是*错误*的，有两个原因：1）它可能不适用于所有语言环境和 2）它是最慢的方法......而且不仅仅是一点点；它比其他选项慢一个或两个数量级。

* * *

**更新**这最近得到了一些投票，所以我想补充一点，自从我发布这个我已经看到一些非常可靠的证据表明 Sql Server 将优化“正确”方式和“快速”方式之间的性能差异，这意味着您现在应该支持前者。

在任何一种情况下，您都希望**编写查询以避免一开始就需要这样做**。您很少会在数据库上进行这项工作。  

在大多数地方，数据库已经是你的瓶颈。通常，为提高性能而添加硬件最昂贵的服务器，以及最难正确添加硬件的服务器（例如，您必须平衡磁盘和内存）。从技术和商业角度来看，它也是最难向外扩展的；从技术上讲，添加 Web 或应用程序服务器比添加数据库服务器要容易得多，即使这是错误的，您也不必为 IIS 或 apache 的每个服务器许可证支付 20,000 美元以上。  

我要说明的一点是，只要有可能，您应该在应用程序级别完成这项工作。您发现自己在 Sql Server 上截断日期时间的*唯一*一次是当您需要按天分组时，即便如此，您可能应该将额外的列设置为计算列，在插入/更新时维护，或维护在应用程序逻辑中。从您的数据库中获取这种破坏索引、占用大量 CPU 资源的工作。

* * *

## 回答 #2

> 赞同：46
> 
>             
> 
> 时间：2009-05-28T22:15:46.160

仅适用于 SQL Server 2008

```
CAST(@SomeDateTime AS Date) 
```

如果需要，然后将其转换回日期时间

```
CAST(CAST(@SomeDateTime AS Date) As datetime) 
```

* * *

## 回答 #3

> 赞同：25
> 
>             
> 
> 时间：2011-05-31T12:02:27.243

只是为了获得更完整的答案，这是一种将任何日期部分向下截断并包括分钟的工作方式（替换`GETDATE()`为要截断的日期）。

这与公认的答案不同，因为您不仅可以使用`dd`（天），还可以使用任何日期部分（请参见[此处](http://msdn.microsoft.com/en-us/library/ms186819.aspx)）：

```
dateadd(minute, datediff(minute, 0, GETDATE()), 0) 
```

请注意，在上面的表达式中，`0`是年初的固定日期 (1900-01-01)。如果您需要截断到更小的部分，例如秒或毫秒，则需要采用更接近要截断的日期的常量日期以避免溢出。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-05-28T21:30:17.843

当我不得不这样做时，我在网上找到的片段是：

```
 dateadd(dd,0, datediff(dd,0, YOURDATE))
 e.g.
 dateadd(dd,0, datediff(dd,0, getDate())) 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-11-18T19:19:51.357

```
CONVERT(DATE, <yourdatetime>) or CONVERT(DATE, GetDate()) or CONVERT(DATE, CURRENT_TIMESTAMP) 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-06-25T04:14:47.053

在 SQl 2005 中，您的 trunc_date 函数可以这样编写。

(1)

```
CREATE FUNCTION trunc_date(@date DATETIME)
RETURNS DATETIME
AS
BEGIN
    CAST(FLOOR( CAST( @date AS FLOAT ) )AS DATETIME)
END 
```

第一种方法要干净得多。它只使用了 3 个方法调用，包括最后的 CAST() 并且不执行字符串连接，这是一个自动加号。此外，这里没有巨大的类型转换。如果您可以想象可以表示日期/时间戳，那么从日期转换为数字再转换回日期是一个相当简单的过程。

(2)

```
CREATE FUNCTION trunc_date(@date DATETIME)
RETURNS DATETIME
AS
BEGIN
      SELECT CONVERT(varchar, @date,112)
END 
```

如果您担心微软对日期时间 (2) 或 (3) 的实施可能没问题。

(3)

```
CREATE FUNCTION trunc_date(@date DATETIME)
RETURNS DATETIME
AS
BEGIN
SELECT CAST((STR( YEAR( @date ) ) + '/' +STR( MONTH( @date ) ) + '/' +STR( DAY(@date ) )
) AS DATETIME
END 
```

第三，更详细的方法。这需要将日期分解为年、月和日部分，以“yyyy/mm/dd”格式将它们组合在一起，然后将其转换回日期。此方法涉及 7 个方法调用，包括最后的 CAST()，更不用说字符串连接了。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2010-11-26T15:09:23.543

对于那些来这里寻找一种方法来将 DATETIME 字段截断为少于一整天（例如每分钟）的人，您可以使用以下方法：

```
SELECT CAST(FLOOR(CAST(GETDATE() AS FLOAT)) + (FLOOR((CAST(GETDATE() AS FLOAT) - FLOOR(CAST(GETDATE() AS FLOAT))) * 1440.0) + (3.0/86400000.0)) / 1440.0 AS DATETIME) 
```

所以如果今天是`2010-11-26 14:54:43.123`那么这将返回`2010-11-26 14:54:00.000`。

要更改它的间隔，请将 1440.0 替换为一天中的间隔数，例如：

```
24hrs          =   24.0  (for every hour)
24hrs / 0.5hrs =   48.0  (for every half hour)
24hrs / (1/60) = 1440.0  (for every minute) 
```

（始终将 a`.0`放在末尾以隐式转换为浮点数。）

* * *

对于那些想知道`(3.0/86400000)`在我的计算中是什么的人，SQL Server 2005 似乎并没有准确地从`FLOAT`转换到`DATETIME`准确，所以这在铺平之前增加了 3 毫秒。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2011-11-27T12:34:28.177

选择 cast(floor(cast(getdate() as float)) as datetime) 参考：[http ://microsoftmiles.blogspot.com/2006/11/remove-time-from-datetime-in-sql-server.html](http://microsoftmiles.blogspot.com/2006/11/remove-time-from-datetime-in-sql-server.html)

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2012-05-23T15:34:04.593

此查询应为您提供`trunc(sysdate)`与 Oracle 中相同的结果。

```
SELECT  * 
FROM    your_table
WHERE   CONVERT(varchar(12), your_column_name, 101)
      = CONVERT(varchar(12), GETDATE(), 101) 
```

希望这可以帮助！

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2012-11-07T07:36:41.990

您还可以`using Substring`从 datetime 变量中提取日期，然后转换回 datetime 将忽略时间部分。

```
declare @SomeDate datetime = '2009-05-28 16:30:22'
SELECT cast(substring(convert(varchar(12),@SomeDate,111),0,12) as Datetime) 
```

此外，您可以访问部分 datetime 变量并将它们合并到构造截断日期，如下所示：

```
SELECT cast(DATENAME(year, @Somedate) + '-' + 
       Convert(varchar(2),DATEPART(month, @Somedate)) + '-' +
       DATENAME(day, @Somedate) 
       as datetime) 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2014-02-14T08:26:16.443

甲骨文：

```
TRUNC(SYSDATE, 'MONTH') 
```

SQL 服务器：

```
DATEADD(DAY, - DATEPART(DAY, DateField) + 1, DateField) 
```

可以类似地用于从日期截断分钟或小时。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2014-08-01T15:02:10.583

你可以这样做（SQL 2008）：

> 声明 @SomeDate 日期 = getdate()

```
select @SomeDate 
```

* * *

2009-05-28

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2021-06-15T20:08:39.137

使用分析时，您可能需要大量的日期\时间截断。所以我做了一个小函数来帮助解决这个问题：

```
CREATE FUNCTION TRUNC_DATE
(
    @datetime datetime, -- datetime to be truncated
    @level VARCHAR(10)  -- truncation level: year, month, day, hour and minute
)
RETURNS DATETIME
AS
BEGIN

    IF (UPPER(@level) = 'YEAR')
       RETURN DATEADD(YEAR,   DATEDIFF(YEAR, 0, @datetime), 0)
    ELSE IF (UPPER(@level) = 'MONTH')
        RETURN DATEADD(MONTH,   DATEDIFF(MONTH, 0, @datetime), 0)
    ELSE IF(UPPER(@level) = 'DAY')
       RETURN DATEADD(DAY,   DATEDIFF(DAY, 0, @datetime), 0)
    ELSE IF (UPPER(@level) = 'HOUR')
       RETURN DATEADD(HOUR,   DATEDIFF(HOUR, 0, @datetime), 0)
    ELSE IF (UPPER(@level) = 'MINUTE')
       RETURN DATEADD(MINUTE,   DATEDIFF(MINUTE, 0, @datetime), 0)

    RETURN @datetime
END
GO 
```

评估函数（用你改变 GETDATE() 列）：

```
SELECT DBO.TRUNC_DATE(GETDATE(), 'YEAR')   YEAR;
SELECT DBO.TRUNC_DATE(GETDATE(), 'MONTH')  YEAR_MONTH;
SELECT DBO.TRUNC_DATE(GETDATE(), 'DAY')    YEAR_MONTH_DAY;
SELECT DBO.TRUNC_DATE(GETDATE(), 'HOUR')   YEAR_MONTH_DAY_HOUR;
SELECT DBO.TRUNC_DATE(GETDATE(), 'MINUTE') YEAR_MONTH_DAY_HOUR_MINUTE; 
```

输出：

[![在此处输入图像描述](https://i.stack.imgur.com/NPqWw.png)](https://i.stack.imgur.com/NPqWw.png)

* * *

## 回答 #14

> 赞同：-1
> 
>             
> 
> 时间：2011-11-27T12:16:56.277

TRUNC(aDate, 'DD') 将截断分钟、秒和小时

SRC：[http ://www.techonthenet.com/oracle/functions/trunc_date.php](http://www.techonthenet.com/oracle/functions/trunc_date.php)

# python - 在发出 HTTP 请求时在 python 中保持会话

> ID：923296
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2009-05-28T21:28:06.193
> 
>         
> 
> 标签：python, http, authentication

我需要编写一个 python 脚本来向同一个站点发出多个 HTTP 请求。除非我错了（我很可能是错的） urllib 为每个请求重新验证。由于我不会进入的原因，我需要能够进行一次身份验证，然后将该会话用于我的其余请求。  

我正在使用 python 2.3.4

* * *

## 回答 #1

> 赞同：29
> 
>             
> 
> 时间：2012-05-17T07:53:27.597

使用[请求](https://github.com/kennethreitz/requests)库。来自[http://docs.python-requests.org/en/latest/user/advanced/#session-objects](http://docs.python-requests.org/en/latest/user/advanced/#session-objects)：

> Session 对象允许您跨请求保留某些参数。它还在从 Session 实例发出的所有请求中保留 cookie。
> 
> ```
> s = requests.session()
> 
> s.get('http://httpbin.org/cookies/set/sessioncookie/123456789')
> r = s.get("http://httpbin.org/cookies")
> 
> print r.text
> # '{"cookies": {"sessioncookie": "123456789"}}' 
> ```

* * *

## 回答 #2

> 赞同：26
> 
>             
> 
> 时间：2009-05-28T21:32:41.753

如果要保留身份验证，则需要重用 cookie。我不确定 urllib2 在 python 2.3.4 中是否可用，但这里有一个关于如何做到这一点的示例：

```
req1 = urllib2.Request(url1)
response = urllib2.urlopen(req1)
cookie = response.headers.get('Set-Cookie')

# Use the cookie is subsequent requests
req2 = urllib2.Request(url2)
req2.add_header('cookie', cookie)
response = urllib2.urlopen(req2) 
```

* * *

## 回答 #3

> 赞同：16
> 
>             
> 
> 时间：2009-05-29T08:48:54.403

## 蟒蛇2

如果这是基于 cookie 的身份验证，请使用[HTTPCookieProcessor](http://docs.python.org/2/library/cookielib.html#examples)：

```
import cookielib, urllib2
cj = cookielib.CookieJar()
opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))
r = opener.open("http://example.com/") 
```

如果这是 HTTP 身份验证，请使用[basic 或 digest AuthHandler](http://docs.python.org/2/library/urllib2.html#examples)：

```
import urllib2
# Create an OpenerDirector with support for Basic HTTP Authentication...
auth_handler = urllib2.HTTPBasicAuthHandler()
auth_handler.add_password(realm='PDQ Application',
                          uri='https://mahler:8092/site-updates.py',
                          user='klem',
                          passwd='kadidd!ehopper')
opener = urllib2.build_opener(auth_handler)
# ...and install it globally so it can be used with urlopen.
urllib2.install_opener(opener)
urllib2.urlopen('http://www.example.com/login.html') 
```

...并为每个请求使用相同的开启者。

## 蟒蛇 3

在 Python3 中，urllib2 和 cookielib 分别被移动到[http.request](https://docs.python.org/3/library/urllib.request.html#examples)和[http.cookiejar](https://docs.python.org/3/library/http.cookiejar.html#examples)。

# javascript - 如何检测鼠标何时离开窗口？

> ID：923299
> 
>         
> 
> 赞同：124
> 
>         
> 
> 时间：2009-05-28T21:28:37.457
> 
>         
> 
> 标签：javascript, browser, mouse

我希望能够检测鼠标何时离开窗口，以便在用户的鼠标在其他地方时阻止事件触发。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：102
> 
>             
> 
> 时间：2010-07-06T15:12:37.980

## ***请记住，我的回答已经过时了。***

在 html 页面上实现拖放行为时，通常需要这种类型的行为。下面的解决方案在 MS Windows XP 机器上的 IE 8.0.6、FireFox 3.6.6、Opera 10.53 和 Safari 4 上进行了测试。

首先是 Peter-Paul Koch 的一个小功能；跨浏览器事件处理程序：

```
function addEvent(obj, evt, fn) {
    if (obj.addEventListener) {
        obj.addEventListener(evt, fn, false);
    }
    else if (obj.attachEvent) {
        obj.attachEvent("on" + evt, fn);
    }
} 
```

然后使用此方法将事件处理程序附加到文档对象 mouseout 事件：

```
addEvent(document, "mouseout", function(e) {
    e = e ? e : window.event;
    var from = e.relatedTarget || e.toElement;
    if (!from || from.nodeName == "HTML") {
        // stop your drag event here
        // for now we can just use an alert
        alert("left window");
    }
}); 
```

最后，这是一个嵌入了用于调试的脚本的 html 页面：

```
<html>
<head>
<script type="text/javascript">
function addEvent(obj, evt, fn) {
    if (obj.addEventListener) {
        obj.addEventListener(evt, fn, false);
    }
    else if (obj.attachEvent) {
        obj.attachEvent("on" + evt, fn);
    }
}
addEvent(window,"load",function(e) {
    addEvent(document, "mouseout", function(e) {
        e = e ? e : window.event;
        var from = e.relatedTarget || e.toElement;
        if (!from || from.nodeName == "HTML") {
            // stop your drag event here
            // for now we can just use an alert
            alert("left window");
        }
    });
});
</script>
</head>
<body></body>
</html> 
```

* * *

## 回答 #2

> 赞同：50
> 
>             
> 
> 时间：2014-10-13T04:02:37.890

如果您使用的是 jQuery，那么这个简短而甜蜜的代码怎么样 -

```
$(document).mouseleave(function () {
    console.log('out');
}); 
```

只要鼠标不在您的页面中，就会触发此事件。只需更改功能以执行您想要的任何操作。

你也可以使用：

```
$(document).mouseenter(function () {
    console.log('in');
}); 
```

当鼠标再次进入页面时触发。

来源：[https ://stackoverflow.com/a/16029966/895724](https://stackoverflow.com/a/16029966/895724)

* * *

## 回答 #3

> 赞同：30
> 
>             
> 
> 时间：2012-02-10T15:14:28.370

这对我有用：

```
addEvent(document, 'mouseout', function(evt) {
  if (evt.toElement == null && evt.relatedTarget == null) {
    alert("left window");
  }
}); 
```

* * *

## 回答 #4

> 赞同：28
> 
>             
> 
> 时间：2018-01-16T13:00:20.223

为了在不考虑滚动条和自动完成字段的情况下检测 mouseleave 或检查：

```
document.addEventListener("mouseleave", function(event){

  if(event.clientY <= 0 || event.clientX <= 0 || (event.clientX >= window.innerWidth || event.clientY >= window.innerHeight))
  {

     console.log("I'm out");

  }
}); 
```

条件说明：

```
event.clientY <= 0  is when the mouse leave from the top
event.clientX <= 0  is when the mouse leave from the left
event.clientX >= window.innerWidth is when the mouse leave from the right
event.clientY >= window.innerHeight is when the mouse leave from the bottom 
```

======================== 编辑========================= ======

document.addEventListener("mouseleave") 似乎不会在新的 firefox 版本上触发，mouseleave 需要附加到像 body 这样的元素或子元素。

我建议改用

```
document.body.addEventListener("mouseleave") 
```

或者

```
window.addEventListener("mouseout") 
```

* * *

## 回答 #5

> 赞同：11
> 
>             
> 
> 时间：2021-07-18T13:34:54.807

### 这是2021年的答案：

您可以在标签中使用`mouseleave`（并`mouseenter`在输入时检测）`html`（在 Chrome 91 和 Firefox 90 中测试）

尝试在下面的代码段中，通过悬停进出它。

```
document.documentElement.addEventListener('mouseleave', () => console.log('out'))
document.documentElement.addEventListener('mouseenter', () => console.log('in'))
```

* * *

## 回答 #6

> 赞同：9
> 
>             
> 
> 时间：2015-12-31T10:11:42.370

使用 onMouseLeave 事件可防止冒泡，并允许您轻松检测鼠标何时离开浏览器窗口。

```
<html onmouseleave="alert('You left!')"></html> 
```

[http://www.w3schools.com/jsref/event_onmouseleave.asp](http://www.w3schools.com/jsref/event_onmouseleave.asp)

* * *

## 回答 #7

> 赞同：5
> 
>             
> 
> 时间：2015-02-07T10:25:55.667

我已经尝试了以上所有方法，但似乎没有按预期工作。经过一番研究，我发现**e.relatedTarget**是**鼠标退出窗口之前**的**html**。

 **所以......我最终得到了这个：

```
 ~~document.body.addEventListener('mouseout', function(e) {
    if (e.relatedTarget === document.querySelector('html')) {
        console.log('We\'re OUT !');
    }
});~~ 
```

如果您发现任何问题或改进，请告诉我！

**2019 更新**

（正如 user1084282 发现的那样）

```
document.body.addEventListener('mouseout', function(e) {
    if (!e.relatedTarget && !e.toElement) {
        console.log('We\'re OUT !');
    }
}); 
```

* * *

## 回答 #8

> 赞同：5
> 
>             
> 
> 时间：2014-12-12T01:53:50.097

这些答案都不适合我。我现在正在使用：

```
document.addEventListener('dragleave', function(e){

    var top = e.pageY;
    var right = document.body.clientWidth - e.pageX;
    var bottom = document.body.clientHeight - e.pageY;
    var left = e.pageX;

    if(top < 10 || right < 20 || bottom < 10 || left < 10){
        console.log('Mouse has moved out of window');
    }

}); 
```

我将它用于拖放文件上传小部件。它不是绝对准确的，当鼠标距离窗口边缘一定距离时触发。

* * *

## 回答 #9

> 赞同：4
> 
>             
> 
> 时间：2016-02-19T12:21:26.080

也许这会对后来来这里的一些人有所帮助。
`window.onblur`和`document.mouseout`。

`window.onblur`在以下情况下触发：

*   `Ctrl+Tab`使用或切换到另一个窗口`Cmd+Tab`。

*   您将注意力（不仅仅是鼠标悬停）放在文档检查器上。

*   你切换桌面。

基本上任何时候该浏览器选项卡失去焦点。

```
window.onblur = function(){
    console.log("Focus Out!")
} 
```

`document.mouseout`在以下情况下触发：

*   您将光标移动到标题栏上。

*   `Ctrl+Tab`使用或切换到另一个窗口`Cmd+Tab`。

*   您打开将光标移到文档检查器。

基本上在任何情况下，当您的光标离开文档时。

```
document.onmouseleave = function(){
    console.log("Mouse Out!")
} 
```

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:33:58.497

我收回我说的话。有可能的。我写了这段代码，完美运行。

```
window.onload = function() {

    $span = document.getElementById('text');

    window.onmouseout = function() {
        $span.innerHTML = "mouse out";  
    }

    window.onmousemove = function() {
        $span.innerHTML = "mouse in";   
    }

} 
```

适用于 chrome、firefox、opera。Aint 在 IE 中进行了测试，但假设它可以工作。

编辑。IE总是会引起麻烦。要使其在 IE 中工作，请将事件从窗口替换为文档：

```
window.onload = function() {

    $span = document.getElementById('text');

    document.onmousemove = function() {
        $span.innerHTML = "mouse move";
    }

    document.onmouseout = function() {
        $span.innerHTML = "mouse out";
    }

} 
```

将它们结合起来进行跨浏览器踢屁股光标检测o0：P

* * *

## 回答 #11

> 赞同：3
> 
>             
> 
> 时间：2014-11-09T05:31:35.393

应用这个CSS：

```
html
{
height:100%;
} 
```

这确保了 html 元素占据了窗口的整个高度。

应用这个jQuery：

```
$("html").mouseleave(function(){
 alert('mouse out');
}); 
```

mouseover 和 mouseout 的问题在于，如果您将鼠标悬停/移出 html 到子元素，它将引发事件。当鼠标移动到子元素时，我给出的功能***没有被触发。***仅当您将鼠标移出/移入窗口时才会触发

只是为了让您知道您可以在用户在窗口中使用鼠标时执行此操作：

```
$("html").mouseenter(function(){
  alert('mouse enter');
}); 
```

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2019-06-20T02:57:12.620

我一个接一个地尝试，当时找到了一个最佳答案：

[https://stackoverflow.com/a/3187524/985399](https://stackoverflow.com/a/3187524/985399)

我跳过旧浏览器，所以我缩短了代码以在现代浏览器（IE9+）上工作

```
 document.addEventListener("mouseout", function(e) {
        let t = e.relatedTarget || e.toElement;
        if (!t || t.nodeName == "HTML") {
          console.log("left window");
        }
    });

document.write("<br><br>PROBLEM<br><br><div>Mouseout trigg on HTML elements</div>")
```

在这里您可以看到[浏览器支持](https://caniuse.com/#search=addEventListener)

我想那很短

但是问题仍然存在，因为[“mouseout”触发了文档中的所有元素](https://developer.mozilla.org/en-US/docs/Web/API/Element/mouseleave_event)。

为防止它发生，请使用[*mouseleave*](https://developer.mozilla.org/en-US/docs/Web/API/Element/mouseleave_event) (IE5.5+)。请参阅链接中的良好解释。

以下代码在不触发元素内部或外部的元素的情况下工作。也可以尝试在文档外拖动释放。

```
var x = 0

document.addEventListener("mouseleave", function(e) { console.log(x++) 
})

document.write("<br><br>SOLUTION<br><br><div>Mouseleave do not trigg on HTML elements</div>")
```

您可以在任何 HTML 元素上设置事件。但是不要启用该事件`document.body`，因为当您想要滚动但不想在其上触发 mouseLeave 事件时，当鼠标指针位于滚动条上方时，Windows 滚动条可能会缩小主体并触发。而是将其设置为打开`document`，如示例中所示。

* * *

## 回答 #13

> 赞同：3
> 
>             
> 
> 时间：2020-02-07T15:46:37.550

见[`mouseover`](https://developer.mozilla.org/docs/Web/API/Element/mouseover_event)和[`mouseout`](https://developer.mozilla.org/docs/Web/API/Element/mouseout_event)。

```
var demo = document.getElementById('demo');
document.addEventListener("mouseout", function(e){demo.innerHTML="";});
document.addEventListener("mouseover", function(e){demo.innerHTML="";});
```

```
div { font-size:80vmin; position:absolute;
      left:50%; top:50%; transform:translate(-50%,-50%); }
```

```
<div id='demo'></div>
```

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2017-11-09T22:14:14.683

这里的一些答案的组合。而且我只包含了一次显示模型的代码。当点击其他任何地方时，模型就会消失。

```
<script>
    var leave = 0
    //show modal when mouse off of page
    $("html").mouseleave(function() {
       //check for first time
       if (leave < 1) {
          modal.style.display = "block";
          leave = leave + 1;
       }
    });

    // Get the modal with id="id01"
       var modal = document.getElementById('id01');

    // When the user clicks anywhere outside of the modal, close it
       window.onclick = function(event) {
          if (event.target == modal) {
             modal.style.display = "none";
          }
       }
</script> 
```

* * *

## 回答 #15

> 赞同：1
> 
>             
> 
> 时间：2016-08-30T17:30:43.660

这可能有点棘手，但它只会在鼠标离开窗口时触发。它一直在捕获子事件，这解决了它

```
 $(window).mouseleave(function(event) {
    if (event.toElement == null) {
    //Do something
    }
  }) 
```

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T21:31:16.360

您可以对 body 标记执行 OnMouseOut 函数调用。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:04:18.553

如果你经常在 body 标签中监听 OnMouseOver，那么当事件没有发生时回调，但是，正如 Zack 所说，这可能非常难看，因为并非所有浏览器都以相同的方式处理事件，甚至有一些可能性即使在同一页面中的 div 上方，您也会丢失 MouseOver。

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2017-09-18T08:01:09.860

```
$(window).mouseleave(function() {
 alert('mouse leave');
}); 
```

* * *

## 回答 #19

> 赞同：-2
> 
>             
> 
> 时间：2014-11-28T07:32:27.240

这将在 chrome 中工作，

```
$(document).bind('dragleave', function (e) {
    if (e.originalEvent.clientX == 0){
        alert("left window");
    }
}); 
```

# asp.net-mvc - 在 ASP.NET MVC、动作过滤器或控制器中哪个首先被实例化？

> ID：923312
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T21:32:38.633
> 
>         
> 
> 标签：asp.net-mvc

在实例化控制器之前，MVC 动作过滤器属性是否运行？我有一个控制器的属性，我想从 ActionFilter 中检查它。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T21:44:12.277

根据 Professional ASP.NET MVC 1.0 book，ActionFilters 在控制器实例化后运行。到 OnActionExecuting（ActionFilter 调用的第一个方法）时，Controller 上下文可用。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T21:44:36.037

在触发动作过滤器的 OnActionExecuted 和 OnActionExecuting 事件之前，控制器将被实例化。您还可以通过传递给事件处理程序的“filterContext”参数访问控制器。

```
public class TestActionAttribute : FilterAttribute, IActionFilter
{
    #region IActionFilter Members

    public void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var controller = filterContext.Controller;
    }

    public void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var controller = filterContext.Controller;
    }

    #endregion
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:44:44.927

抽象类 System.Web.Mvc.ActionFilterAttribute（从这个类派生出你自己的 ActionFilter）有 4 个 OnXXX 方法：

*   OnAction执行

*   OnActionExecuted

*   OnResultExecuting

*   OnResultExecuted

我认为在 OnActionExecuting 你可以检查你的控制器：

```
YourController controller = filterContext.Controller as YourController
if(controller != null)
{
    // check your controller
} 
```

# entity-framework - EF4 - 自定义 ObjectContext 和继承问题

> ID：923315
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-05-28T21:33:52.797
> 
>         
> 
> 标签：entity-framework

进一步讨论我的上[一个问题](https://stackoverflow.com/questions/917718)。假设我从 Post 继承 BlogEntry 和 Comment。我现在想对它们进行一些定制。对博客文章的评论不需要标题，但评论需要用户参考，因此我将这两个字段从 Post 移到 Comment 和 Blog 条目中，如下所示：

```
public abstract class Post
{
    public virtual int Id { get; set; }
    public virtual string Text { get; set; }
    public virtual DateTime CreatedAt { get; set; }
}

public class BlogEntry : Post
{
    public virtual string Header { get; set; }
    public virtual Blog Blog { get; set; }
    public virtual IEnumerable<Comment> Comments { get; set; }
}

public class Comment : Post
{
    public virtual string Header { get; set; }
    public virtual int UserId { get; set; }
    public virtual BlogEntry BlogEntry { get; set; }
} 
```

现在我创建我的自定义对象上下文：

```
public class EntityContext : System.Data.Objects.ObjectContext
{
    public EntityContext() : base("name=Entities", "Entities")
    {
        this.Blogs = CreateObjectSet<Blog>();
        this.Posts = CreateObjectSet<Post>();
        this.Entries = CreateObjectSet<BlogEntry>();
        this.Comments = CreateObjectSet<Comment>(); 
    }
    public ObjectSet<Blog> Blogs { get; set; }
    public ObjectSet<Post> Posts { get; set; }
    public ObjectSet<BlogEntry> Entries { get; set; }
    public ObjectSet<Comment> Comments { get; set; }
} 
```

这给了我以下实际上非常具有描述性的错误消息：

> 测试方法抛出异常：System.ArgumentException：没有为指定的实体类型“BlogEntry”定义实体集。如果“BlogEntry”是派生类型，请改用基类型。例如，如果调用 CreateObjectSet() 并且 DiscontinuedProduct 是已知实体类型但未直接映射到 EntitySet，则会看到此错误。DiscontinuedProduct 类型可能是派生类型，其中父类型映射到 EntitySet，或者 DiscontinuedProduct 类型可能根本不映射到 EntitySet。参数名称：TEntity

现在我不是继承和东西的大师，但我看到的方式是添加一组条目和评论作为 ObjectSet< Post> 来解决我的问题？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-05-28T22:39:02.167

如果您`ObjectSet`为基类型（即`Post`）创建一个，您也不能为派生类型创建一个，因为您可以从该类型中检索继承层次结构中所有类型的实例`ObjectSet`。

即`ctx.Posts.OfType<BlogEntry>()`会返回 BlogEntry(s)。

所以答案是简单地删除其他两组。

例如，如果您需要添加，您可以这样做：

```
ctx.Posts.AddObject(new BlogEntry {....}); 
```

完全没有问题。

为了帮助您更轻松地编写查询，您可以向 ObjectContext 添加几个属性，如下所示：

```
public ObjectQuery<BlogEntity> Blogs{
   get{
       return ctx.Posts.OfType<BlogEntry>() as ObjectQuery<BlogEntry>;
   }
} 
```

评论也是如此。

希望这可以帮助

亚历克斯

# python - 将多个 html 文件抓取到 CSV

> ID：923318
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T21:34:57.490
> 
>         
> 
> 标签：python, sqlite, screen-scraping, beautifulsoup, mechanize

我正在尝试从硬盘驱动器上的 1200 多个 .htm 文件中删除行。在我的电脑上，它们位于“file:///home/phi/Data/NHL/pl07-08/PL020001.HTM”。这些 .htm 文件从 *20001.htm 到 *21230.htm 是连续的。我的计划是最终通过电子表格应用程序将我的数据扔到 MySQL 或 SQLite 中，或者如果我能从这个过程中得到一个干净的 .csv 文件，就直接输入。

这是我第一次尝试编写代码（Python）、抓取，我刚刚在我蹩脚的 pentium IV 上安装了 Ubuntu 9.04。不用说我是新手并且有一些障碍。

如何让 mechanize 按顺序浏览目录中的所有文件。机械化甚至可以做到这一点吗？mechanize/Python/BeautifulSoup 可以读取 'file:///' 样式的 url，还是有其他方法可以将其指向 /home/phi/Data/NHL/pl07-08/PL020001.HTM？以 100 或 250 个文件增量执行此操作还是仅发送所有 1230 个文件是否明智？

我只需要以“”开头并以“ `<tr class="evenColor">`”结尾的行`</tr>`。理想情况下，我只想要其中包含“SHOT”|“MISS”|“GOAL”的行，但我想要整行（每一列）。请注意，“**目标**”是粗体的，所以我必须指定这个吗？每个 htm 文件有 3 个表。

此外，我希望将父文件的名称（pl020001.htm）**包含在我抓取的行中，这样我就可以在最终数据库中自己的列中标识它们**。我什至不知道从哪里开始。这是我到目前为止所拥有的：  

```
#/usr/bin/python
from BeautifulSoup import BeautifulSoup
import re
from mechanize import Browser

mech = Browser()
url = "file:///home/phi/Data/NHL/pl07-08/PL020001.HTM"
##but how do I do multiple urls/files? PL02*.HTM?
page = mech.open(url)

html = page.read()
soup = BeautifulSoup(html)
##this confuses me and seems redundant
pl = open("input_file.html","r")
chances = open("chancesforsql.csv,"w")

table = soup.find("table", border=0)
for row in table.findAll 'tr class="evenColor"'
#should I do this instead of before?
outfile = open("shooting.csv", "w")

##how do I end it? 
```

我应该使用 IDLE 还是类似的东西？只是 Ubuntu 9.04 中的终端？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:45:59.170

你不需要机械化。由于我并不完全了解 HTML 内容，因此我首先会尝试查看匹配的内容。像这样：

```
import glob
from BeautifulSoup import BeautifulSoup

for filename in glob.glob('/home/phi/Data/*.htm'):
    soup = BeautifulSoup(open(filename, "r").read()) # assuming some HTML
    for a_tr in soup.findAll("tr", attrs={ "class" : "evenColor" }):
        print a_tr 
```

然后选择你想要的东西并用逗号将其写入标准输出（并将其重定向 > 到文件）。或者通过python编写csv。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:11:11.303

MYYN 的回答对我来说是一个很好的开始。我要指出我很幸运的一件事是：

```
import glob
    for file_name in glob.glob('/home/phi/Data/*.htm'):
        #read the file and then parse with BeautifulSoup 
```

我发现 the`os`和`glob`imports 对于运行目录中的文件非常有用。

此外，一旦您以这种方式使用 for 循环，您就`file_name`可以修改它以在输出文件中使用，以便输出文件名与输入文件名匹配。

# unit-testing - 什么是 ObjectMother？

> ID：923319
> 
>         
> 
> 赞同：22
> 
>         
> 
> 时间：2009-05-28T21:35:24.637
> 
>         
> 
> 标签：unit-testing, design-patterns

什么是 ObjectMother 以及此模式的常见使用场景是什么？

* * *

## 回答 #1

> 赞同：28
> 
>             
> 
> 时间：2009-05-28T21:40:16.577

> ObjectMother 从工厂模式开始，通过简单的方法调用交付预制的可测试对象。它通过促进创建对象的定制、在测试期间提供更新对象的方法以及在测试完成时从数据库中删除对象（如有必要）来超越工厂领域。
> 
>   
>   
> 
> 使用 ObjectMother 的一些原因：
> 
>   * 减少测试中的代码重复，提高测试可维护性
> 
>   * 使测试对象超级容易访问，鼓励开发人员编写更多测试。
> 
>   * 每个测试都使用新数据运行。
> 
>   * 测试总是自己清理。

( [http://c2.com/cgi/wiki?ObjectMother](http://c2.com/cgi/wiki?ObjectMother) )

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-05-28T23:31:06.697

请参阅“[测试数据构建器：对象母模式的替代方案](http://www.natpryce.com/articles/000714.html)”，了解为什么要使用测试数据构建器而不是对象母模式。它解释了两者是什么。  

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-10-02T13:09:21.853

如其他地方所述，ObjectMother 是一个用于生成对象的工厂，通常**（仅？）**用于单元测试。

它们非常有用的地方是生成复杂的对象，其中数据对测试没有特别重要的意义。

您可能在下面创建了一个空实例，例如

```
 Order rubishOrder = new Order("NoPropertiesSet");
    _orderProcessor.Process(rubishOrder); 
```

你会使用 ObjectMother 中的一个明智的

```
 Order motherOrder = ObjectMother.SimpleOrder();
    _orderProcessor.Process(motherOrder); 
```

这往往有助于解决被测试的类开始依赖于传入的合理对象的情况。  

例如，如果您在上面的 Order 类中添加了一些 OrderNumber 验证，您只需在 SimpleObject 类上实例化 OrderNumber 即可让所有现有测试通过，让您专注于编写验证测试。

如果您刚刚在测试中实例化了对象，则需要将其添加到每个测试中（令人震惊的是，我看到人们这样做的频率如此之高）。  

当然，这可以只提取到一个方法中，但是将它放在一个单独的类中允许它在多个测试类之间共享。  

另一个推荐的行为是为您的方法使用良好的描述性名称，以促进重用。每次测试只得到一个对象太容易了，这绝对是要避免的。最好生成代表一般属性而不是特定属性的对象，然后为您的测试进行自定义。例如，`ObjectMother.WealthyCustomer()`而不是`ObjectMother.CustomerWith1MdollarsSharesInBigPharmaAndDrivesAPorsche()`和`ObjectMother.CustomerWith1MdollarsSharesInBigPharmaAndDrivesAPorscheAndAFerrari()`

# tfs - 是否可以将 TFS 配置为不将文件标记为只读？

> ID：923320
> 
>         
> 
> 赞同：25
> 
>         
> 
> 时间：2009-05-28T21:35:30.437
> 
>         
> 
> 标签：tfs, rft

标题基本概括了所有内容。我正在使用 RFT、VS 插件，它允许我使用 GUI 编辑专有数据文件。问题是这个文件没有出现在 VS 中，当我开始通过 GUI 编辑它时，VS 不会自动检查它（可能是 VS 插件的错误）。所以，我必须在编辑之前手动检查它，否则插件会在尝试保存文件时崩溃（因为它是只读的），有时还会损坏这个项目的本地工作副本。如果 TFS 没有将未签出的文件标记为只读，一切都会容易得多。您知道是否有办法指示 TFS 将所有文件保持为非只读状态？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-28T21:55:02.973

不，您可以将其从源代码控制中排除，但这可能不是您想要的。  

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2010-07-29T18:27:20.537

我对 TFS 有同样的问题。我们的项目有一些小的 SQL Server 数据库文件，我们选择将它们置于源代码控制之下。我们通过将这些添加到项目构建的构建后语句来处理只读问题。我想我们也可以完成这个预构建。

属性 $(TargetDir)*.mdf -r

属性 $(TargetDir)*.ldf -r

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2011-10-17T11:59:17.543

已经有一段时间了，但是 - 我认为[这个链接](http://www.woodwardweb.com/teamprise/000333.html)实际上是答案。

> 当您进行结帐时，您实际上是在说“TFS，我想编辑我已经下载的文件的版本，可以吗？” TFS 然后查看该版本，并告诉您是否可以编辑它（基于您当时的安全权限以及是否有其他人锁定了该文件）。**如果您可以编辑该文件，TFS 将在您的本地计算机上将该文件标记为读/写并允许您继续。**

IE：当我 r.clicked 项目并选择“签出并编辑”时，r/o 标志被自动删除，我可以编译（使用前/后事件）然后再次“签入”。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2010-05-19T16:02:47.617

好吧，您可以获得最新的 samba 共享，它只吃只读位。

# .net - 如何保存剪贴板的内容

> ID：923323
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T21:35:56.367
> 
>         
> 
> 标签：.net, clipboard

有没有办法保留剪贴板的内容？我尝试了以下代码，但它不起作用。

```
Dim iData As IDataObject = Clipboard.GetDataObject()
...(use clipboard)
Clipboard.SetDataObject(iData) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T21:38:26.843

保留剪贴板内容的最简单方法是不使用剪贴板。剪贴板是*用户*的临时存储区域，而不是应用程序的临时存储区域，因此您尝试做的事情可能比破坏剪贴板更好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-12-16T22:27:13.243

您上面的代码以什么方式不起作用？当我在 C# 中尝试等效代码时，在调用 Clipboard.SetDataObject(iData) 时出现“CloseClipboard 失败（来自 HRESULT 的异常：0x800401D4 (CLIPBRD_E_CANT_CLOSE)）”异常。

但是，以下解决方法为我完成了这项工作：

```
// save
Dictionary<String, Object> d = new Dictionary<String, Object>();
IDataObject ido = Clipboard.GetDataObject();
foreach (String s in ido.GetFormats(false))
    d.Add(s, ido.GetData(s));

// ...

// restore
var da = new DataObject();
foreach (String s in d.Keys)
    da.SetData(s, d[s]);
Clipboard.SetDataObject(da); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T21:55:54.720

您可以使用 OpenClipboard 和 CloseClipboard。根据[MSDN](http://msdn.microsoft.com/en-us/library/ms649048(VS.85).aspx) ，打开剪贴板将阻止其他应用程序更改数据。

```
[DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true)]
    public static extern bool OpenClipboard(IntPtr hWndNewOwner);

    [DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true)]
    public static extern bool CloseClipboard(); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-07-12T22:35:42.373

我同意上下文很重要。就我而言，我想将格式化的、动态填充的封面文档粘贴到一些动态生成的文本（全部在 MS Word 中）的前面。这是我找到的解决方案（使用 VSTO 和 C#）：

```
 object start = 0;
                Word.Range startRng = a_TreatedDocument.Range(ref start, ref start);
                startRng.FormattedText = a_CoverPageDocument.Content.FormattedText; 
```

请注意，这适用于表格和格式化文本。

# html - IFRAME 之后的行不可见

> ID：923328
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-28T21:36:57.953
> 
>         
> 
> 标签：html, internet-explorer, firefox, iframe

IFRAME 之后的行在 IE 和 FF 中均不可见。参考下面的代码，让我知道我是否做错了什么。

```
<html>
<body>
line before iframe <br />
<iframe src="about:blank" />
<br /> line after iframe
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：22
> 
>             
> 
> 时间：2009-05-28T21:46:28.387

您需要关闭 iframe 标记。否则，当不支持 iframe 时，其后出现的内容将被视为“要显示的内容”。

（顺便说一句，我认为如果您使用 XHTML 编写 <iframe ... /> 那么 IE 会将其视为 HTML。IE 不将 XHTML 理解为 XHTML。它将其理解为 HTML。）

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-05-28T21:43:30.140

使用单独的关闭标签创建 iframe：

```
<html>
<body>
line before iframe <br />
<iframe src="about:blank"></iframe>
<br /> line after iframe
</body>
</html> 
```

当您使用它们的紧凑形式时，有些标签（我想到了 iframe 和 textarea）不喜欢它。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2011-05-18T08:24:23.267

我通过 iFrame 标签将 Facebook Connect 集成到我的网页中，如下所示：

```
<iframe src="..." style="..."></iframe> 
```

**它适用于除 IE8 之外的所有浏览器。**

现在我发现，**您必须提供文本**作为标签的内容。然后它完美地工作！

例子：

```
<iframe src="..." style="...">Your browser does not support iFrames</iframe> 
```

或者我现在使用的是以下内容（仅显示一个空格）：

**解决方案：**

```
<iframe src="..." style="...">&#160;</iframe> 
```

# visual-studio - 任务列表中可能会出现 aspx/ascx 文件中的 Visual Studio TODO 注释吗？

> ID：923333
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-05-28T21:37:53.383
> 
>         
> 
> 标签：visual-studio, comments

我们使用 Visual Studio 2008 开发 asp.net 网络表单。对于多语言支持，我们翻译所有文本。然而，在设计时，我们通常只输入英文文本，稍后再翻译（否则会中断工作流程）。  

我在选项中添加了一个“ToTranslate”标签。添加`//ToTranslate: something`C# 代码正确地将条目添加到任务列表。但是，我还没有弄清楚如何对 aspx 和 ascx 文件（我们的大多数用户文本所在的位置）执行相同的操作。

插入`<%-- //ToTranslate: something --%>`或`<%-- ToTranslate: something --%>`不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2009-05-31T03:23:09.513

在我看来，如果您将分隔符 <% 和 %> 单独放在一行上，它就可以正常工作。我所做的是：转到“工具”菜单并单击“选项”，然后在“环境”->“任务列表”下添加一个新的 ToTranslate 令牌。单击“确定”接受更改。回到 ASPX 页面，我自己在一行上添加了注释，并在一行上自己添加了代码分隔符。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2012-02-15T19:07:04.177

仅供参考，如果您想在**.Net MVC3 razor cshtml 文件**中执行此操作，语法如下：

```
@{
//TODO: Move this inline <style> css to a file
} 
```

请注意：您需要将结尾的 } 括号放在新行上，否则它将包含在 // 注释中。你可以像下面那样使用 /**/ 来完成它，并将它全部放在一行上，但它需要更多的输入，并且更难阅读。我的看法是，如果它让您感到恼火，那么评论在您的文件中占据了 3 行，那么更有动力解决问题并完全删除它:)

```
@{/*TODO: Move this inline <style> css to a file*/} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2019-08-23T00:07:56.470

您不需要 <% %> on 行本身。此示例显示了哪些有效，哪些无效：

```
<%//ToTranslate will work%>
<%/*ToTranslate will work*/%>
<!--ToTranslate won't work-->
<!--
ToTranslate won't work
--> 
```

这可能是因为 HTML 注释和某种形式的 aspx 注释之间的区别被混淆了——因为那是 html 注释的一部分？

[![aspx 中的注释](https://i.stack.imgur.com/QWsbH.png)](https://i.stack.imgur.com/QWsbH.png)

# cocoa - 如何将项目添加到 Interface Builder 的“库”窗口中的“用户媒体”类别？

> ID：923335
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-05-28T21:37:59.497
> 
>         
> 
> 标签：cocoa, interface-builder

Interface Builder 中的“库”窗口提供了一个“媒体”选项卡，其中列出了您可以从 nib 文件中引用的各种图像和声音资源。有一个“系统媒体”项列出了 OS X 提供的默认图像，如果您的 nib 是 Xcode 项目的一部分，您还可以浏览 Xcode 项目中包含的图像/声音。

还有第三项称为“用户媒体”，但至少对我来说，那里没有列出任何内容，而且似乎没有任何方法可以添加新项目。我尝试将图像拖到窗口中，但没有任何效果，并且在硬盘驱动器上找不到任何可能存储此类图像的明显位置。我将如何将项目添加到此列表中，以便我可以在 Interface Builder 中使用它们？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:32:03.087

当前项目中的媒体应在此处列出。尝试将 .png 拖到 xcode 项目的资源文件夹中，然后重新打开其中一个 xib。

# javascript - 调试在 Firefox 中不起作用 - Firebug

> ID：923338
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-28T21:38:22.103
> 
>         
> 
> 标签：javascript, firefox, extjs, firebug

我正在尝试使用 Firebug 在 Firefox 3.0.8 中调试基于 extJS 的 JavaScript 表单，但我的调试语句都不起作用。  在控制台中`console.log`产生错误。`console is not defined`该`debugger`声明不起作用。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2010-09-21T13:39:50.137

可能是您安装了另一个 Firefox 扩展程序，这使 Firebug 的控制台变得混乱。例如，我安装了“HttpWatch Basic”，它破坏了 console.log() .. 禁用了 HttpWatch，一切都又好了。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T04:01:13.767

您使用的是 Firefox 2.x 吗？

在尝试登录之前调用 loadFirebugConsole() 以显式加载记录器。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-04T11:33:55.783

你可以试试 window.console.log()。适用于 IE，在您的情况下可能适用于 FF3。

# eclipse - 从 IEEditorPart (Eclipse) 获取 ITextViewer

> ID：923342
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T21:39:46.670
> 
>         
> 
> 标签：eclipse, eclipse-rcp

Eclipse RCP 问题

我打开文件：

```
IWorkbenchPage page = PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage();
IEditorPart editorPart = IDE.openEditor(page, file); 
```

我还获得了以下文件：

```
IDocument doc = ((ITextEditor)editorPart).getDocumentProvider().getDocument(editorPart.getEditorInput()); 
```

我需要进入该文档的文本查看器（用于创建 LinkedModeUI），有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2011-09-24T00:25:39.800

以下对我有用：

```
IEditorPart editorPart = getSite().getPage().getActiveEditor();
if (editorPart != null) {
    ITextOperationTarget target =
            (ITextOperationTarget)editorPart.getAdapter(ITextOperationTarget.class);
    if (target instanceof ITextViewer) {
        ITextViewer textViewer = (ITextViewer)target;
        // ...
    } 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-06-05T11:24:16.157

1) 一个文档可以用多个编辑器打开。您必须迭代所有编辑器以查找文件的编辑器。2）查看器被封装在编辑器中。我认为唯一的方法是扩展编辑器类以添加吸气剂。或者重新定义它，如果继承者无法访问查看器。

# c# - C# 中的“字段初始值设定项不能引用非静态字段”是什么意思？

> ID：923343
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-28T21:39:56.763
> 
>         
> 
> 标签：c#, delegates

我不明白 C# 中的这个错误

> 错误 CS0236：字段初始值设定项无法引用非静态字段、方法或属性“Prv.DB.getUserName(long)”

对于以下代码

```
public class MyDictionary<K, V>
{
    public delegate V NonExistentKey(K k);
    NonExistentKey nonExistentKey;

    public MyDictionary(NonExistentKey nonExistentKey_) { }
}

class DB
{
    SQLiteConnection connection;
    SQLiteCommand command;

    MyDictionary<long, string> usernameDict = new MyDictionary<long, string>(getUserName);

    string getUserName(long userId) { }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-05-28T21:42:56.227

在构造函数之外使用的任何对象初始化程序都必须引用静态成员，因为在构造函数运行之前实例尚未被构造，并且直接变量初始化在概念上发生在任何构造函数运行之前。getUserName 是一个实例方法，但包含的实例不可用。

要修复它，请尝试将 usernameDict 初始化程序放在构造函数中。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-05-28T22:40:36.720

下面的链接可能会阐明为什么做你想做的事情可能不是一件好事，特别是第二个链接：

[为什么初始化器作为构造器以相反的顺序运行？第一部分](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/why-do-initializers-run-in-the-opposite-order-as-constructors-part-one)

[为什么初始化器作为构造器以相反的顺序运行？第二部分](https://docs.microsoft.com/en-us/archive/blogs/ericlippert/why-do-initializers-run-in-the-opposite-order-as-constructors-part-two)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:42:15.153

getUserName 是一个实例方法。

将其更改为静态，这可能会起作用。

或者

在构造函数中初始化字典。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:47:31.677

您不能这样做，因为必须先初始化实例，然后才能访问其类的属性。在类初始化之前调用字段初始化器。

如果您想使用 GetUserName-Method 的返回值初始化字段 usernameDict，您必须在构造函数中执行此操作或将 Method 设为静态方法。

# c# - DateTime 数组的二进制序列化

> ID：923347
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T21:40:20.537
> 
>         
> 
> 标签：c#, arrays, datetime, serialization, binary

当我使用 BinaryFormatter 序列化 Int32 数组时，我得到大约 400MB/s（一秒内 1 亿个项目），但是当我尝试序列化 DateTime 数组时，我得到的吞吐量只有大约 27MB/s（1 亿30 秒内的项目）。一个 DateTime 以序列化形式占用 8 个字节。我猜 BinaryFormatter 使用 ISerializable 接口，如果它实现了，所以我看了一下 DateTime 类型的 GetObjectData 实现：

```
void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)
{
    if (info == null)
    {
        throw new ArgumentNullException("info");
    }
    info.AddValue("ticks", this.InternalTicks);
    info.AddValue("dateData", this.dateData);
} 
```

我很困惑将 UInt64 和 Int64 添加到输出中，总和应该是 16 个字节，但这并不反映我的措施。那么 DateTime 是如何真正序列化为二进制的呢？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:26:50.070

它会超过 16 个字节，因为它也需要存储密钥。

您可以自己（直接）序列化刻度吗？或者; 我没有在这种情况下对其进行测试，但是您可以试一下[protobuf-net](http://code.google.com/p/protobuf-net/)（它是一个高性能的二进制序列化引擎）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T21:50:13.403

听起来您的 int 序列化受 I/O 限制，但您的 DateTime 序列化受 CPU 限制（显然，序列化 DateTime 比序列化 int 需要更多的 CPU 时间）。因此，您的测量值不会反映您的两种数据类型大小之间的确切比率。

# c# - 是否有现有的 C# 扩展方法库？或分享你自己的

> ID：923348
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T21:40:31.770
> 
>         
> 
> 标签：c#, extension-methods, boilerplate

> **可能重复：**
> 
>   [发布 C# .Net 的扩展好东西 (codeplex.com/extensionoverflow)](https://stackoverflow.com/questions/271398/post-your-extension-goodies-for-c-net-codeplex-com-extensionoverflow)

我喜欢 C# 3.0。我最喜欢的部分之一是扩展方法。

我喜欢将扩展方法视为可以应用于广泛的类基础的实用函数。我被警告说这个问题是主观的，可能会被关闭，但我认为这是一个很好的问题，因为我们都有“样板”代码来做一些相对静态的事情，比如“XML 的转义字符串”——但我还没有找到收集这些的地方。

我对执行日志记录/调试/分析、字符串操作和数据库访问的常用函数特别感兴趣。那里有这些类型的扩展方法的库吗？

编辑：将我的代码示例移至答案。（感谢 Joel 清理代码！）

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-28T21:58:14.213

您可能会喜欢[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)。

还有很多人喜欢这个：

```
public static bool IsNullOrEmpty(this string s)
{
    return s == null || s.Length == 0;
} 
```

但由于 10 次或更多次中有 9 次我正在检查它是否为*空*或空，我个人使用这个：

```
public static bool HasValue(this string s)
{
    return s != null && s.Length > 0;
} 
```

最后，我最近捡到的一个：

```
public static bool IsDefault<T>(this T val)
{
    return EqualityComparer<T>.Default.Equals(val, default(T));
} 
```

用于检查 DateTime、bool 或 integer 等值类型的默认值，或 null 等引用类型。它甚至适用于物体，这有点令人毛骨悚然。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:19:56.433

这是我的几个：

```
// returns the number of milliseconds since Jan 1, 1970 (useful for converting C# dates to JS dates)
public static double UnixTicks(this DateTime dt)
{
    DateTime d1 = new DateTime(1970, 1, 1);
    DateTime d2 = dt.ToUniversalTime();
    TimeSpan ts = new TimeSpan(d2.Ticks - d1.Ticks);
    return ts.TotalMilliseconds;
} 
```

和一个 ToDelimitedString 函数：

```
// apply this extension to any generic IEnumerable object.
public static string ToDelimitedString<T>(this IEnumerable<T> source, string delimiter, Func<T, string> action)
{
    if (source == null)
    {
        throw new ArgumentException("Source can not be null.");
    }

    if (delimiter == null)
    {
        throw new ArgumentException("Delimiter can not be null.");
    }

    string strAction = string.Empty;
    string delim = string.Empty;
    var sb = new StringBuilder();

    foreach (var item in source)
    {
        strAction = action.Invoke(item);

        sb.Append(delim);
        sb.Append(strAction);
        delim = delimiter;
    }
    return sb.ToString();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:34:15.890

这是使用 String.Join 编写的 Jeff 的 ToDelimitedString：

```
public static string ToDelimitedString<T>(this IEnumerable<T> source, string delimiter, Func<T, string> action) {
    // guard clauses for arguments omitted for brevity

    return String.Join(delimiter, source.Select(action));
} 
```

# xpcom - 从 nsIBinaryInputStream 创建图像

> ID：923349
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T21:40:53.157
> 
>         
> 
> 标签：xpcom, gecko

我使用一些包含压缩图像数据（如 jpeg 或 gif）的 js 技巧创建了一个二进制输入流。我想使用 imgITools::decodeImageData 或其他方式解码和显示这些数据，但还没有找到方法。我应该从哪里开始？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-10-09T23:19:19.337

最简单的方法是将图像数据读入字符串，base64 编码字符串，然后将其转换为 data: URL 并将其设置为图像的 src。不幸的是，stackoverflow 不允许我创建实时数据：链接，但它看起来像这样：

```
数据：图像/png；base64，iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAMklEQVRIx2NgGAWjYBQMFXAFDRMrR5GF/6H4CglyoxaOWjhq4aiFg7hoGwWjYBTQDgAAy8VWOfRR6fkAAAAAASUVORK5CYII="
```

# delphi - Delphi：在需要时提示 UAC 提升

> ID：923350
> 
>         
> 
> 赞同：40
> 
>         
> 
> 时间：2009-05-28T21:40:54.093
> 
>         
> 
> 标签：delphi, uac, elevation

我们需要在运行时将一些设置更改为 HKEY_LOCAL_MACHINE。

如果在运行时需要，是否可以提示 uac 提升，或者我是否必须启动第二个提升的进程来完成“肮脏的工作”？

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2009-06-05T19:11:06.747

我会以提升的身份重新启动自己，传递命令行参数，指示您想要做什么提升的事情。然后您可以直接跳到适当的表格，或者只是保存您的 HKLM 资料。

```
function RunAsAdmin(hWnd: HWND; filename: string; Parameters: string): Boolean;
{
    See Step 3: Redesign for UAC Compatibility (UAC)
    http://msdn.microsoft.com/en-us/library/bb756922.aspx

    This code is released into the public domain. No attribution required.
}
var
    sei: TShellExecuteInfo;
begin
    ZeroMemory(@sei, SizeOf(sei));
    sei.cbSize := SizeOf(TShellExecuteInfo);
    sei.Wnd := hwnd;
    sei.fMask := SEE_MASK_FLAG_DDEWAIT or SEE_MASK_FLAG_NO_UI;
    sei.lpVerb := PChar('runas');
    sei.lpFile := PChar(Filename); // PAnsiChar;
    if parameters <> '' then
        sei.lpParameters := PChar(parameters); // PAnsiChar;
    sei.nShow := SW_SHOWNORMAL; //Integer;

    Result := ShellExecuteEx(@sei);
end; 
```

Microsoft 建议的另一个解决方案是在进程外创建一个 COM 对象（使用专门创建的 CoCreateInstanceAsAdmin 函数）。我不喜欢这个想法，因为你必须编写和注册一个 COM 对象。

* * *

**注意：**没有“CoCreateInstanceAsAdmin”API 调用。这只是一些漂浮的代码。这是我偶然发现的 Dephi 版本。它显然是基于在通常隐藏的代码内部调用**CoGetObject时使用“** **Elevation:Administrator!new:** ”前缀为类 guid 字符串添加前缀的技巧：

 **```
function CoGetObject(pszName: PWideChar; pBindOptions: PBindOpts3; 
      const iid: TIID; ppv: PPointer): HResult; stdcall; external 'ole32.dll';

procedure CoCreateInstanceAsAdmin(const Handle: HWND; 
      const ClassID, IID: TGuid; PInterface: PPointer);
var
   BindOpts: TBindOpts3;
   MonikerName: WideString;
   Res: HRESULT;
begin
   //This code is released into the public domain. No attribution required.
   ZeroMemory(@BindOpts, Sizeof(TBindOpts3));
   BindOpts.cbStruct := Sizeof(TBindOpts3);
   BindOpts.hwnd := Handle;
   BindOpts.dwClassContext := CLSCTX_LOCAL_SERVER;

   MonikerName := 'Elevation:Administrator!new:' + GUIDToString(ClassID);

   Res := CoGetObject(PWideChar(MonikerName), @BindOpts, IID, PInterface);
   if Failed(Res) then 
      raise Exception.Create(SysErrorMessage(Res));
end; 
```

* * *

**另一个问题：**您如何处理在 Windows XP 中以标准用户身份运行的人？

* * *

## 回答 #2

> 赞同：22
> 
>             
> 
> 时间：2009-05-28T21:47:13.240

您不能“提升”现有流程。UAC 下的提升进程具有不同的令牌，具有不同的 LUID、不同的强制完整性级别和不同的组成员身份。这种级别的更改无法在正在运行的进程中完成 - 如果发生这种情况，那将是一个安全问题。

您需要启动第二个提升的进程来完成这项工作，或者通过创建一个在提升的 dllhost 中运行的 COM 对象。

[http://msdn.microsoft.com/en-us/library/bb756922.aspx](http://msdn.microsoft.com/en-us/library/bb756922.aspx)给出了一个示例“RunAsAdmin”函数和一个“CoCreateInstanceAsAdmin”函数。

编辑：我刚刚在你的标题中看到了“Delphi”。我列出的所有内容显然都是原生的，但如果 Delphi 提供对 ShellExecute 类功能的访问，您应该能够调整链接中的代码。

* * *

## 回答 #3

> 赞同：18
> 
>             
> 
> 时间：2015-02-17T23:03:35.407

[即用型代码](http://pastebin.com/w4X4pHpC)示例：

使用示例：

```
unit Unit1;

interface

uses
  Windows{....};

type
  TForm1 = class(TForm)
    Label1: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Button1: TButton;
    Button2: TButton;
    procedure FormCreate(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
  private
    procedure StartWait;
    procedure EndWait;
  end;

var
  Form1: TForm1;

implementation

uses
  RunElevatedSupport;

{$R *.dfm}

const
  ArgInstallUpdate     = '/install_update';
  ArgRegisterExtension = '/register_global_file_associations';

procedure TForm1.FormCreate(Sender: TObject);
begin
  Label1.Caption := Format('IsAdministrator: %s',        [BoolToStr(IsAdministrator, True)]);
  Label2.Caption := Format('IsAdministratorAccount: %s', [BoolToStr(IsAdministratorAccount, True)]);
  Label3.Caption := Format('IsUACEnabled: %s',           [BoolToStr(IsUACEnabled, True)]);
  Label4.Caption := Format('IsElevated: %s',             [BoolToStr(IsElevated, True)]);

  Button1.Caption := 'Install updates';
  SetButtonElevated(Button1.Handle);
  Button2.Caption := 'Register file associations for all users';
  SetButtonElevated(Button2.Handle);
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  StartWait;
  try
    SetLastError(RunElevated(ArgInstallUpdate, Handle, Application.ProcessMessages));
    if GetLastError <> ERROR_SUCCESS then
      RaiseLastOSError;
  finally
    EndWait;
  end;
end;

procedure TForm1.Button2Click(Sender: TObject);
begin
  StartWait;
  try
    SetLastError(RunElevated(ArgRegisterExtension, Handle, Application.ProcessMessages));
    if GetLastError <> ERROR_SUCCESS then
      RaiseLastOSError;
  finally
    EndWait;
  end;
end;

function DoElevatedTask(const AParameters: String): Cardinal;

  procedure InstallUpdate;
  var
    Msg: String;
  begin
    Msg := 'Hello from InstallUpdate!' + sLineBreak +
           sLineBreak +
           'This function is running elevated under full administrator rights.' + sLineBreak +
           'This means that you have write-access to Program Files folder and you''re able to overwrite files (e.g. install updates).' + sLineBreak +
           'However, note that your executable is still running.' + sLineBreak +
           sLineBreak +
           'IsAdministrator: '        + BoolToStr(IsAdministrator, True) + sLineBreak +
           'IsAdministratorAccount: ' + BoolToStr(IsAdministratorAccount, True) + sLineBreak +
           'IsUACEnabled: '           + BoolToStr(IsUACEnabled, True) + sLineBreak +
           'IsElevated: '             + BoolToStr(IsElevated, True);
    MessageBox(0, PChar(Msg), 'Hello from InstallUpdate!', MB_OK or MB_ICONINFORMATION);
  end;

  procedure RegisterExtension;
  var
    Msg: String;
  begin
    Msg := 'Hello from RegisterExtension!' + sLineBreak +
           sLineBreak +
           'This function is running elevated under full administrator rights.' + sLineBreak +
           'This means that you have write-access to HKEY_LOCAL_MACHINE key and you''re able to write keys and values (e.g. register file extensions globally/for all users).' + sLineBreak +
           'However, note that this is usually not a good idea. It is better to register your file extensions under HKEY_CURRENT_USER\Software\Classes.' + sLineBreak +
           sLineBreak +
           'IsAdministrator: '        + BoolToStr(IsAdministrator, True) + sLineBreak +
           'IsAdministratorAccount: ' + BoolToStr(IsAdministratorAccount, True) + sLineBreak +
           'IsUACEnabled: '           + BoolToStr(IsUACEnabled, True) + sLineBreak +
           'IsElevated: '             + BoolToStr(IsElevated, True);
    MessageBox(0, PChar(Msg), 'Hello from RegisterExtension!', MB_OK or MB_ICONINFORMATION);
  end;

begin
  Result := ERROR_SUCCESS;
  if AParameters = ArgInstallUpdate then
    InstallUpdate
  else
  if AParameters = ArgRegisterExtension then
    RegisterExtension
  else
    Result := ERROR_GEN_FAILURE;
end;

procedure TForm1.StartWait;
begin
  Cursor := crHourglass;
  Screen.Cursor := crHourglass;
  Button1.Enabled := False;
  Button2.Enabled := False;
  Application.ProcessMessages;
end;

procedure TForm1.EndWait;
begin
  Cursor := crDefault;
  Screen.Cursor := crDefault;
  Button1.Enabled := True;
  Button2.Enabled := True;
  Application.ProcessMessages;
end;

initialization
  OnElevateProc := DoElevatedTask;
  CheckForElevatedTask;
end. 
```

和支持单位本身：

```
unit RunElevatedSupport;

{$WARN SYMBOL_PLATFORM OFF}
{$R+}

interface

uses
  Windows;

type
  TElevatedProc        = function(const AParameters: String): Cardinal;
  TProcessMessagesMeth = procedure of object;

var
  // Warning: this function will be executed in external process.
  // Do not use any global variables inside this routine!
  // Use only supplied AParameters.
  OnElevateProc: TElevatedProc;

// Call this routine after you have assigned OnElevateProc
procedure CheckForElevatedTask;

// Runs OnElevateProc under full administrator rights
function RunElevated(const AParameters: String; const AWnd: HWND = 0; const AProcessMessages: TProcessMessagesMeth = nil): Cardinal; overload;

function  IsAdministrator: Boolean;
function  IsAdministratorAccount: Boolean;
function  IsUACEnabled: Boolean;
function  IsElevated: Boolean;
procedure SetButtonElevated(const AButtonHandle: THandle);

implementation

uses
  SysUtils, Registry, ShellAPI, ComObj;

const
  RunElevatedTaskSwitch = '0CC5C50CB7D643B68CB900BF000FFFD5'; // some unique value, just a GUID with removed '[', ']', and '-'

function CheckTokenMembership(TokenHandle: THANDLE; SidToCheck: Pointer; var IsMember: BOOL): BOOL; stdcall; external advapi32 name 'CheckTokenMembership';

function RunElevated(const AParameters: String; const AWnd: HWND = 0; const AProcessMessages: TProcessMessagesMeth = nil): Cardinal; overload;
var
  SEI: TShellExecuteInfo;
  Host: String;
  Args: String;
begin
  Assert(Assigned(OnElevateProc), 'OnElevateProc must be assigned before calling RunElevated');

  if IsElevated then
  begin
    if Assigned(OnElevateProc) then
      Result := OnElevateProc(AParameters)
    else
      Result := ERROR_PROC_NOT_FOUND;
    Exit;
  end;

  Host := ParamStr(0);
  Args := Format('/%s %s', [RunElevatedTaskSwitch, AParameters]);

  FillChar(SEI, SizeOf(SEI), 0);
  SEI.cbSize := SizeOf(SEI);
  SEI.fMask := SEE_MASK_NOCLOSEPROCESS;
  {$IFDEF UNICODE}
  SEI.fMask := SEI.fMask or SEE_MASK_UNICODE;
  {$ENDIF}
  SEI.Wnd := AWnd;
  SEI.lpVerb := 'runas';
  SEI.lpFile := PChar(Host);
  SEI.lpParameters := PChar(Args);
  SEI.nShow := SW_NORMAL;

  if not ShellExecuteEx(@SEI) then
   RaiseLastOSError;
  try

    Result := ERROR_GEN_FAILURE;
    if Assigned(AProcessMessages) then
    begin
      repeat
        if not GetExitCodeProcess(SEI.hProcess, Result) then
          Result := ERROR_GEN_FAILURE;
        AProcessMessages;
      until Result <> STILL_ACTIVE;
    end
    else
    begin
      if WaitForSingleObject(SEI.hProcess, INFINITE) <> WAIT_OBJECT_0 then
        if not GetExitCodeProcess(SEI.hProcess, Result) then
          Result := ERROR_GEN_FAILURE;
    end;

  finally
    CloseHandle(SEI.hProcess);
  end;
end;

function IsAdministrator: Boolean;
var
  psidAdmin: Pointer;
  B: BOOL;
const
  SECURITY_NT_AUTHORITY: TSidIdentifierAuthority = (Value: (0, 0, 0, 0, 0, 5));
  SECURITY_BUILTIN_DOMAIN_RID  = $00000020;
  DOMAIN_ALIAS_RID_ADMINS      = $00000220;
  SE_GROUP_USE_FOR_DENY_ONLY  = $00000010;
begin
  psidAdmin := nil;
  try
    // Создаём SID группы админов для проверки
    Win32Check(AllocateAndInitializeSid(SECURITY_NT_AUTHORITY, 2,
      SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_ADMINS, 0, 0, 0, 0, 0, 0,
      psidAdmin));

    // Проверяем, входим ли мы в группу админов (с учётов всех проверок на disabled SID)
    if CheckTokenMembership(0, psidAdmin, B) then
      Result := B
    else
      Result := False;
  finally
    if psidAdmin <> nil then
      FreeSid(psidAdmin);
  end;
end;

{$R-}

function IsAdministratorAccount: Boolean;
var
  psidAdmin: Pointer;
  Token: THandle;
  Count: DWORD;
  TokenInfo: PTokenGroups;
  HaveToken: Boolean;
  I: Integer;
const
  SECURITY_NT_AUTHORITY: TSidIdentifierAuthority = (Value: (0, 0, 0, 0, 0, 5));
  SECURITY_BUILTIN_DOMAIN_RID  = $00000020;
  DOMAIN_ALIAS_RID_ADMINS      = $00000220;
  SE_GROUP_USE_FOR_DENY_ONLY  = $00000010;
begin
  Result := Win32Platform <> VER_PLATFORM_WIN32_NT;
  if Result then
    Exit;

  psidAdmin := nil;
  TokenInfo := nil;
  HaveToken := False;
  try
    Token := 0;
    HaveToken := OpenThreadToken(GetCurrentThread, TOKEN_QUERY, True, Token);
    if (not HaveToken) and (GetLastError = ERROR_NO_TOKEN) then
      HaveToken := OpenProcessToken(GetCurrentProcess, TOKEN_QUERY, Token);
    if HaveToken then
    begin
      Win32Check(AllocateAndInitializeSid(SECURITY_NT_AUTHORITY, 2,
        SECURITY_BUILTIN_DOMAIN_RID, DOMAIN_ALIAS_RID_ADMINS, 0, 0, 0, 0, 0, 0,
        psidAdmin));
      if GetTokenInformation(Token, TokenGroups, nil, 0, Count) or
         (GetLastError <> ERROR_INSUFFICIENT_BUFFER) then
        RaiseLastOSError;
      TokenInfo := PTokenGroups(AllocMem(Count));
      Win32Check(GetTokenInformation(Token, TokenGroups, TokenInfo, Count, Count));
      for I := 0 to TokenInfo^.GroupCount - 1 do
      begin
        Result := EqualSid(psidAdmin, TokenInfo^.Groups[I].Sid);
        if Result then
          Break;
      end;
    end;
  finally
    if TokenInfo <> nil then
      FreeMem(TokenInfo);
    if HaveToken then
      CloseHandle(Token);
    if psidAdmin <> nil then
      FreeSid(psidAdmin);
  end;
end;

{$R+}

function IsUACEnabled: Boolean;
var
  Reg: TRegistry;
begin
  Result := CheckWin32Version(6, 0);
  if Result then
  begin
    Reg := TRegistry.Create(KEY_READ);
    try
      Reg.RootKey := HKEY_LOCAL_MACHINE;
      if Reg.OpenKey('\Software\Microsoft\Windows\CurrentVersion\Policies\System', False) then
        if Reg.ValueExists('EnableLUA') then
          Result := (Reg.ReadInteger('EnableLUA') <> 0)
        else
          Result := False
      else
        Result := False;
    finally
      FreeAndNil(Reg);
    end;
  end;
end;

function IsElevated: Boolean;
const
  TokenElevation = TTokenInformationClass(20);
type
  TOKEN_ELEVATION = record
    TokenIsElevated: DWORD;
  end;
var
  TokenHandle: THandle;
  ResultLength: Cardinal;
  ATokenElevation: TOKEN_ELEVATION;
  HaveToken: Boolean;
begin
  if CheckWin32Version(6, 0) then
  begin
    TokenHandle := 0;
    HaveToken := OpenThreadToken(GetCurrentThread, TOKEN_QUERY, True, TokenHandle);
    if (not HaveToken) and (GetLastError = ERROR_NO_TOKEN) then
      HaveToken := OpenProcessToken(GetCurrentProcess, TOKEN_QUERY, TokenHandle);
    if HaveToken then
    begin
      try
        ResultLength := 0;
        if GetTokenInformation(TokenHandle, TokenElevation, @ATokenElevation, SizeOf(ATokenElevation), ResultLength) then
          Result := ATokenElevation.TokenIsElevated <> 0
        else
          Result := False;
      finally
        CloseHandle(TokenHandle);
      end;
    end
    else
      Result := False;
  end
  else
    Result := IsAdministrator;
end;

procedure SetButtonElevated(const AButtonHandle: THandle);
const
  BCM_SETSHIELD = $160C;
var
  Required: BOOL;
begin
  if not CheckWin32Version(6, 0) then
    Exit;
  if IsElevated then
    Exit;

  Required := True;
  SendMessage(AButtonHandle, BCM_SETSHIELD, 0, LPARAM(Required));
end;

procedure CheckForElevatedTask;

  function GetArgsForElevatedTask: String;

    function PrepareParam(const ParamNo: Integer): String;
    begin
      Result := ParamStr(ParamNo);
      if Pos(' ', Result) > 0 then
        Result := AnsiQuotedStr(Result, '"');
    end;

  var
    X: Integer;
  begin
    Result := '';
    for X := 1 to ParamCount do
    begin
      if (AnsiUpperCase(ParamStr(X)) = ('/' + RunElevatedTaskSwitch)) or
         (AnsiUpperCase(ParamStr(X)) = ('-' + RunElevatedTaskSwitch)) then
        Continue;

      Result := Result + PrepareParam(X) + ' ';
    end;

    Result := Trim(Result);
  end;

var
  ExitCode: Cardinal;
begin
  if not FindCmdLineSwitch(RunElevatedTaskSwitch) then
    Exit;

  ExitCode := ERROR_GEN_FAILURE;
  try
    if not IsElevated then
      ExitCode := ERROR_ACCESS_DENIED
    else
    if Assigned(OnElevateProc) then
      ExitCode := OnElevateProc(GetArgsForElevatedTask)
    else
      ExitCode := ERROR_PROC_NOT_FOUND;
  except
    on E: Exception do
    begin
      if E is EAbort then
        ExitCode := ERROR_CANCELLED
      else
      if E is EOleSysError then
        ExitCode := Cardinal(EOleSysError(E).ErrorCode)
      else
      if E is EOSError then
      else
        ExitCode := ERROR_GEN_FAILURE;
    end;
  end;

  if ExitCode = STILL_ACTIVE then
    ExitCode := ERROR_GEN_FAILURE;
  TerminateProcess(GetCurrentProcess, ExitCode);
end;

end. 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2017-08-18T08:11:00.587

通常，将文本“Setup”或“Ins​​tall”放在您的 EXE 名称中的某处就足以使 Windows 以提升的权限自动运行，如果它是您正在编写的安装实用程序，那么它是非常值得做的，因为它很容易做到。

我现在在 Windows 7 上遇到问题，当没有以管理员身份登录时，并且在手动运行时必须使用右键单击以管理员身份运行（通过 Wise 安装向导运行程序仍然可以）

我看到 Delphi 10.1 Berlin 在 Project Options | 下有一个非常易于使用的新选项。应用。只需勾选启用管理员权限，清单就为您完成，非常简单！

[![项目选项](https://i.stack.imgur.com/CJSD3.png)](https://i.stack.imgur.com/CJSD3.png)

注意。确保您仅通过单独的安装程序进行此类更改，始终以提升的权限运行您的应用程序可能会导致其他事情出现问题，例如电子邮件，不再获取默认邮件配置文件。

编辑：2018 年 1 月：自 2017 年 8 月编写此答案以来，似乎已经发布了很多 Windows 更新，现在需要用户右键单击并以管理员身份运行几乎所有内容，即使是使用 Wise 构建的安装 exe。如果没有以管理员身份运行，即使 Outlook 也无法正确安装。似乎根本没有更多的自动提升。

# sql - 对多对一关系的聚合数据进行建模的有效方法（例如，stackoverflow 问题的投票数）

> ID：923352
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T21:41:24.593
> 
>         
> 
> 标签：sql, database, database-design, aggregate, relational

我很好奇什么是最好的建模方法以优化性能......不关心实时数据完整性

我将继续使用 stackoverflow 示例

```
Question
  id
  title
Votes
  id
  user
  question 
```

一个问题有很多票

然而，对于许多查询，我们只关心投票的总数（例如显示在问题旁边）。

良好的关系数据库理论会将两个实体（Q 和 V）创建为单独的关系，需要连接，然后是 sum 或 count 聚合调用。

另一种可能性是打破常规形式，偶尔将投票的总价值具体化为问题中的一个属性（例如 Question.votes）。读取性能会提高，但是，取决于您愿意让您的“投票”数据变得多么陈旧，它需要对该问题记录的更多权限......反过来又会阻碍性能。

可以使用涉及缓存等的其他技术。但我只是想知道，性能方面最好的解决方案是什么？假设该网站的流量更高，并且获得的选票数量比问题多得多。

也对非关系模型开放。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:57:10.690

在这种情况下，连接不太可能太慢，特别是如果您在 Votes 表中有 (question) 索引。

如果实在是太慢了，你可以在 Question 表中缓存投票数：

```
 id - title - votecount 
```

每当您记录投票时，您都可以更新投票计数。例如，来自存储过程或直接来自您的应用程序代码。

这些更新很棘手，但由于您并不担心一致性，我想如果投票有时不完全正确也没关系。要修复任何错误，您可以定期重新生成所有缓存计数，例如：

```
 UPDATE q
 SET votecount = count(v.question)
 FROM questions q
 LEFT JOIN votes v on v.question = q.id 
```

如果未找到问题，则聚合 count(v.question) 返回 0，而 count(*) 则返回 1。

如果锁定是一个问题，请考虑使用“with (nolock)”或“set transaction isolation level read uncommited”来绕过锁定（同样，基于数据完整性是低优先级。）

作为 nolock 的替代方案，请考虑“已提交的读取快照”，它适用于具有大量读取和较少写入活动的数据库。您可以通过以下方式打开它：

```
ALTER DATABASE YourDb SET READ_COMMITTED_SNAPSHOT ON; 
```

它适用于 SQL Server 2005 及更高版本。这就是 Oracle 默认的工作方式，也是 stackoverflow 本身使用的方式。甚至还有一个关于它的[编码恐怖博客条目](http://www.codinghorror.com/blog/archives/001166.html)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:08:33.070

我在社交网站上到处使用 sql 2005 的索引视图来处理这类事情。我们的负载绝对是读/写的高比率，所以它对我们很有效。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:18:47.357

我建议在应用程序的整个生命周期内将投票保留在内存中。为什么要为简单的计数而点击数据库，在某些时候您将加载该项目一次并根据请求询问初始金额是多少。它还与您如何实现存储库有很大关系，如果您的问题对象延迟加载投票但急切加载投票计数，那么您可以加快流程，同时不会将其保存在内存中。仍然将投票保留在 db 中，只需在您的应用程序中保留计数

# sql-server - SQL 2005 无法删除用户

> ID：923355
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T21:42:18.880
> 
>         
> 
> 标签：sql-server, sql-server-2005, user-management

我已将数据库从备份恢复到新服务器，但无法从数据库中删除旧模式。我为此数据库创建了一个新用户。新用户的名称不同（为了让其他开发人员更清楚），所以我对这个模式没有用处。我最终设法删除了 USER，但架构不会消失。  

我收到的错误是“无法删除架构”，因为它被对象“引用”

运行此脚本：

```
select * from sys.objects where schema_id = 5 
```

...显示此架构“拥有”的所有对象。

我的问题是我找不到改变这些对象所有权的方法。一定有办法吗？谢谢大家

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T21:45:59.870

将对象事物从模式源移动到模式目标的语法是：

```
ALTER SCHEMA Destination TRANSFER Source.Thing 
```

[这是](http://www.eggheadcafe.com/conversation.aspx?messageid=31693215&threadid=31693208)生成脚本以将所有对象传输到 dbo 模式的 SQL：

```
SELECT 'ALTER SCHEMA dbo TRANSFER ' + SCHEMA_NAME(schema_id) + '.' + name
FROM sys.tables
WHERE schema_id != SCHEMA_ID('dbo'); 
```

只传输一个特定的模式：

```
SELECT 'ALTER SCHEMA NewSchema TRANSFER ' + SCHEMA_NAME(schema_id) + '.' + name
FROM sys.tables
WHERE schema_name(schema_id) = 'OldSchema' 
```

# msbuild - TEAMBUILD：错误 MSB4057：项目中不存在目标“GetXapOutputFile”

> ID：923368
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T21:44:15.180
> 
>         
> 
> 标签：msbuild, silverlight-3.0, wcf-ria-services, tfsbuild

我在尝试在 Visual Studio 2008 上的 TeamExplorer 中通过 TeamBuild 运行我的构建时遇到此错误。

在 Build Machine 上，我安装了 VS SP1、Team Explorer、Silverlight 3 工具和 RIA 服务。

我可以在我的机器上直接在 Build Machine 上使用 Visual Studio 编译。但是我仍然无法通过 TeamBuild 进行编译，因为它“说”我缺少 GetXapOutputFile 目标。

我检查了 C:\Program Files\MSBuild\Microsoft\Silverlight\v3.0\Microsoft.Silverlight.Common.targets 文件，它确实有 GetXapOutputFile 目标：

```
<!--
============================================================
                        GetXapOutputFile

This stand-alone target returns the name of the built xap file.It
only makes sense to call this after a build
============================================================
-->
<Target
    Name="GetXapOutputFile"
    DependsOnTargets="_CreateSLProperties" 
    Outputs="$(XapOutputFile)"
/> 
```

知道我可能会错过什么吗？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2013-11-14T21:18:40.933

嗨，我正在尝试命令行构建并且遇到了同样的问题，这为我解决了：

'xxx.Web' 项目的属性菜单，'Silverlight Application' 选项卡，删除当前项并重新添加。之后，在构建...时，错误将消失。但我不知道为什么会这样。

在这里找到：[http ://connect.microsoft.com/VisualStudio/feedback/details/698689/error-msb4057-the-target-getxapoutputfile-does-not-exist-in-the-project](http://connect.microsoft.com/VisualStudio/feedback/details/698689/error-msb4057-the-target-getxapoutputfile-does-not-exist-in-the-project)

# regex - 用于 UrlRewriter Mod 的正则表达式

> ID：923372
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T21:45:34.863
> 
>         
> 
> 标签：regex

这是场景。我正在使用一个 url 重写器，它允许我指定模式并在它们匹配时进行重定向，这是非常典型的东西。

我想在我的规则底部添加一条新规则，它是一个包罗万象的规则，但只是在一定程度上。我不希望它捕获任何以 .aspx 结尾或只是空的东西。

到目前为止我有这个：

```
(.+)(?!\.aspx) 
```

我的想法是至少捕获一个或多个字符，除非它以 .aspx 结尾。

所以 default.aspx 不应该匹配，但默认会匹配。Product.aspx 将不匹配，但 product 会。

这也失败了：

```
 (\w+)(^\.aspx) 
```

任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:00:40.310

试试这个带有否定后向断言的正则表达式：

```
(.+)(?<!\.aspx)$ 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T21:55:45.607

也许有两个更简单的规则？

```
\.aspx$      # handle explicitly
.+           # catch all 
```

# svn - TortoiseSvn 错误：与管理目录同名

> ID：923375
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T21:46:27.313
> 
>         
> 
> 标签：svn, tortoisesvn

我正在使用 TortoiseSVN。我已经对一个空文件夹进行了结帐。一些文件被传输，但在某些时候我收到以下错误：

*错误：无法添加目录“D:\code\Website\ClientBin_svn”：

错误对象：与管理目录同名*  

我尝试删除该文件夹并将项目签出到另一个目录。它不起作用。当我尝试在不同局域网上的另一台计算机上检查项目时，它工作正常。有任何想法吗？

谢谢，冯迪普洛

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-28T23:02:46.457

您的存储库中有一个名为“_svn”或“.svn”的文件或文件夹。这是一个坏主意，因为您的 subversion 客户端已经使用其中一个作为保留名称，用于在本地工作副本中存储元数据。

打开存储库浏览器，在存储库中找到恶意文件或文件夹，然后将其删除（或重命名）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:56:50.740

查看您是否已将 TortoiseSVN 配置为使用`_svn`而不是`.svn`.

这是每个安装的配置选项，因此可能因一台计算机与另一台计算机不同。

右键单击文件夹，打开 TortoiseSVN 菜单，然后选择设置。底部名为“常规”的选项卡应具有该复选框。

现在，我不认为是那个复选框，因为你说名字是“ClientBin_svn”，但这是第一个打动我的东西。

Subversion 的管理目录是隐藏的 .svn 目录，它包含 svn 工作副本数据。

# sql-server - 有没有办法在 SQL Server 中执行 FIRST() ？

> ID：923382
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T21:48:42.517
> 
>         
> 
> 标签：sql-server

在我以前的 Access 时代，有一个 First() 函数可以让您将第一行作为聚合函数。SQL Server 中是否有任何等价物？

```
SELECT
  c.ID
, p.ID
, FIRST(p.ProductName)
, SUM(fee.Amount)
from Fee as f
INNER JOIN Product as p
ON p.ID = f.ProductID
INNER JOIN Customer as c
ON c.ID = p.CustomerID
GROUP BY c.ID, p.ID 
```

**编辑：**
我只想要任何行的值，因为它们都将是相同的。我试图对数据库友好，让它只给我它找到的第一个:)

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T21:52:28.750

这要看情况。

你的意思是“任何单行”？然后您可以使用 MIN 或 MAX，它应该适用于大多数数据类型。

但是，如果您的意思是“您可以找到的第一行”，那么答案是否定的。

这类似于告诉数据库引擎“我希望你给我一个符合这些标准的特定行，其中一个标准是你可以给我任何你想要的行”。

这样做的原因是，除非您对行进行排序，否则没有优先的概念，并且您无法以任何有意义的方式对行进行排序，从而以这种方式与组一起使用。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T21:54:17.157

你可以试试：

```
SELECT  c.ID, p.ID, 
(SELECT TOP 1 ProductName FROM Product ORDER BY ID) AS ProductName, 
SUM(fee.Amount)
FROM Fee as f
INNER JOIN   Product as pON p.ID = f.ProductID
INNER JOIN Customer as cON c.ID = p.CustomerIDGROUP BY c.ID, p.ID 
```

这个直接从表中获取第一个产品`Product`作为子查询。`ORDER BY ID`子查询中的 应该让您获得表中的第`ProductName`一个`Product`。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T21:50:45.743

您可以`SELECT TOP 1 * FROM ...`只获取第一行。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T21:51:12.527

不是我知道的，只需使用 MIN()

# .net - 如何处理来自 .net 远程处理的 http 302 重定向？

> ID：923383
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T21:49:06.510
> 
>         
> 
> 标签：.net, http, remoting, http-status-code-302

我需要能够将 http 302 重定向与使用 .net 远程处理的代码区分开来。

为了连接到适当的 url，我们按顺序尝试它们，直到一个有效。在大多数环境中，第一个 url 正确失败并出现 System.Net.WebException，状态为 WebExceptionStatus.NameResolutionFailure。但是，对于使用 OpenDNS 的客户，这会以 HTTP 302 响应的形式返回，重定向到他们的指南页面。因为我正在使用 .net Remoting，重定向被忽略，并且我收到的错误是 System.Runtime.Serialization.SerializationException，只能通过其消息“解析完成之前遇到流结束”来区分。

这是 opendns http 响应：HTTP/1.0 302 找到位置：http://guide.opendns.com/?url=demonstration.totallyinvalidexceptonmynetwork.com%2Fi%2Fdo%2Fnot%2Fexist.html[内容](http://guide.opendns.com/?url=demonstration.totallyinvalidexceptonmynetwork.com%2Fi%2Fdo%2Fnot%2Fexist.html)
    类型：文本/html 内容-长度：0 连接：关闭日期：2009 年 5 月 28 日星期四 20:46:26 GMT 服务器：OpenDNS 指南

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T06:48:21.993

我假设要发布您正在使用该`HttpWebRequest`对象的请求。`HttpWebResponse`然后你可以像下面这样在对象中收到响应。然后你可以检查`response.StatusCode`属性。如果是 302，则执行您的逻辑。

```
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
if (response.StatusCode = HttpStatusCode.Found)
{
   //your code here
} 
```

更新：如果你正在使用，`System.Net.Webclient`那么你可以使用你可以使用它的`ResponseHeaders`属性。[这](http://msdn.microsoft.com/en-us/library/system.net.webclient.responseheaders.aspx)是您可以使用它的方法。

# c# - 是否有任何关于编写软件安装程序的权威文档？

> ID：923384
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2009-05-28T21:49:33.873
> 
>         
> 
> 标签：c#, .net, installation, windows-installer, installshield

我已经阅读了一堆关于安装程序的文档，但没有遇到任何可以解释基本概念的好东西。我遇到的大多数安装程序软件都基于我根本不理解的类似“数据库”的结构。  

各种产品附带的所有文档 - 即 WiX、InstallAware、Wise、InstallShield 等，都希望您了解这些基本概念 [我只是不明白]，以便遵循他们所说的内容。

谁能指出我解释软件安装程序概念的文档方向，以便软件文档真正有意义？

* * *

## 回答 #1

> 赞同：17
> 
>             
> 
> 时间：2009-05-28T23:52:54.437

**更新**- 自从我的原始帖子[WiX：Windows Installer XML 开发人员指南](https://rads.stackoverflow.com/amzn/click/com/1590592972)已经发布，对于初学者来说也是一个很好的资源。（不过我自己并不觉得它那么好。）我仍然建议您阅读[Windows Installer 权威指南](http://www.microsoft.com/downloadS/details.aspx?familyid=6A35AC14-2626-4846-BB51-DDCE49D6FFB6&displaylang=en)作为起点。Windows Installer 和 WiX 不是你几天就能学会的东西，它需要几个月的时间。

* * *

去拿一份[Windows Installer 权威指南](https://rads.stackoverflow.com/amzn/click/com/1590592972)。我已经数不清有多少次我把它推荐给那些陷入概念并且正在努力理解 Windows Installer 如何工作的人。确保您也获取了[Windows Installer SDK](http://www.microsoft.com/downloadS/details.aspx?familyid=6A35AC14-2626-4846-BB51-DDCE49D6FFB6&displaylang=en)。

掌握 Windows Installer 是您学习的第一阶段，一旦深入了解，您将了解[InstallShield](http://www.installshield.com/)的工作原理（或视情况而定。）。Wise、InstallShield 等试图保护您免受底层概念的影响，并有自己的诡计/黑客来绕过 Windows Installer 的限制。

第二阶段（如果您认真了解 Windows Installer）正在学习[WiX](http://wix.sf.net/)（[WiX 教程](http://www.tramontana.co.hu/wix/)还不错，虽然它有点过时并且针对的是 WiX 2.0 而不是 3.0）并加入[wix-users 邮件列表](http://n2.nabble.com/wix-users-f687560.html). 在你读完上面提到的书之前不要加入用户列表，你会在你的头脑中得到很好的。那些不了解 Windows Installer 概念的人提出的问题在很大程度上会被忽略，但是那些做过功课的人会发现它是一个很好的资源。

本书未涵盖的内容是 Vista，Robert Flamings 关于[了解 UAC 和 Vista](http://blogs.msdn.com/rflaming/archive/tags/UAC+in+MSI/default.aspx)的博客文章（在 Vista 处于 beta 阶段时编写）是您可以找到的关于该主题的最佳信息。

Windows Installer 和 WiX 团队真正擅长的一件事是使文档（帮助文件）保持最新。每当我进行设置时，我通常会在一台显示器上打开**Wix.chm**和**Msi45.chm ;)**

除了文档，来自 WiX 和 Windows Installer 团队的人们的博客非常适合学习新技巧等。这里列出的太多了，但是一旦你知道了术语，你会发现它们中的大多数都会出现在谷歌搜索结果中。

如果这一切看起来太多了，请查看[NSIS](http://nsis.sf.net)。非常适合简单的“我只需要复制文件”类型的安装，而不适合企业部署。[如果您在两者之间纠结，那么当 setup 不只是 xcopy 时](http://blogs.msdn.com/robmen/)，不妨看看 Rob Mensching 的旧博客。那里的文章可能让我相信，从长远来看，深入学习底层的 Windows Installer 概念会有所收获。它有:)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:03:15.280

这[（MSDN，关于 Windows 安装程序）](http://msdn.microsoft.com/en-us/library/aa367449.aspx)是有关在 Windows 上安装的良好“常规”信息的最佳起点。所有“基于 msi”的安装程序都与这些概念相关。  

唯一的“其他”安装程序类型（在 Windows 世界中）是 NSIS，它实际上不适合企业安装（我不想在这里开始讨论程序安装程序与非程序安装程序）。  

安装东西真的很复杂，包含广告、还原点、补丁和转换等高级概念，但是当你“得到它”时，你可以做一些非常酷的事情，比如使用 SQL 2008 获得 TFS 2008的[变通方法。](http://geekswithblogs.net/etiennetremblay/archive/2008/08/11/sql-2008--tfs-2008-sp1-the-lowdownhellip.aspx)

TFS 2008 不支持 SQL 2008，但 TFS 2008 SP1 支持，所以您需要做的是使用如下命令“修补” TFS 2008 RTM 安装和 TFS 2008 SP1 安装：

```
msiexec /a C:\TFS\RTM\AT\vs_setup.msi /p C:\TFS\SP1Extract\TFS90sp1-KB949786.msp TARGETDIR=C:\TFS\ATIntegrated 
```

但结果是您无法将其作为“TFS 2008 with SP1”分发。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-06-03T03:48:06.827

我推荐以下提要：

[http://blog.deploymentengineering.com/feeds/posts/default](http://blog.deploymentengineering.com/feeds/posts/default)

[http://forum.installsite.net/newsfeed.php](http://forum.installsite.net/newsfeed.php)

[http://msmvps.com/blogs/installsite/rss.aspx](http://msmvps.com/blogs/installsite/rss.aspx)

[http://robmensching.com/blog/Rss.aspx](http://robmensching.com/blog/Rss.aspx)

[http://support.acresso.com/rss/acresso_is.xml](http://support.acresso.com/rss/acresso_is.xml)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:03:02.113

你可以试试

[Windows 安装程序资源](http://support.microsoft.com/kb/282477)（以下链接的起始页）

[Windows Installer](http://support.microsoft.com/default.aspx?scid=gp;en-us;wininst&sd=gn)（查看“Windows Installer 概述”）

[MSDN 上的 Windows 安装程序](http://msdn.microsoft.com/en-us/library/aa372866.aspx)（用于 SDK 信息）

希望有帮助...

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:07:18.893

我见过的关于 Windows Installer 的最佳介绍是 Phil Wilson 的书[Definitive Guide to Windows Installer](https://rads.stackoverflow.com/amzn/click/com/1590592972)。这是 2004 年编写的，没有 Vista 或 Win7 特定的功能。

我见过的最好的 Windows 安装程序站点是[www.installsite.org](http://www.installsite.org/)。它有一些介绍性文章，但面向专家。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:16:59.327

如果您的安装需求不是很复杂，我建议您尝试一下 InnoSetup。几年前，我在一套 Windows 应用程序安装程序上使用它，没有任何抱怨。比 InstallShield 和 MSI 简单得多，但您的里程可能会有所不同。

我与 InnoSetup 没有任何关系。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:07:08.413

查看代码是了解安装程序如何工作的好地方。

*   [下载](http://www.jrsoftware.org/iscvs.htm)或[浏览](http://cvs.jrsoftware.org/view/issrc/)Jordan Russell的[Inno Setup](http://www.jrsoftware.org/isinfo.php)的源代码。

*   [下载](http://sourceforge.net/project/showfiles.php?group_id=22049&package_id=15374)或[浏览](http://nsis.svn.sourceforge.net/viewvc/nsis/)[Nullsoft Scriptable Install System](http://nsis.sourceforge.net/)的源代码。

# oracle - Oracle：批量调用多个过程

> ID：923389
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T21:50:50.393
> 
>         
> 
> 标签：oracle, plsql, odp.net

我需要在事务中连续调用 Oracle 包中的多个不同过程。事实上，我需要调用他们大约 5000 次。我想知道我可以使用什么语法来批处理这些对 Oracle 的调用，所以我只需要一次往返。我试过了

```
PACKAGE.PROCA :1, :2; PACKAGE.PROCB :3, :4, :5; 
```

但我回来了 ORA00900：无效的 SQL 语句。

任何指针？我知道将参数数组传递给过程，但不幸的是，在这种情况下这并没有多大帮助。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:43:58.617

最简单的是匿名 PL/SQL 块。例如：

```
DECLARE
  v_file_loc varchar2(100) := '....';
  v_file_name varchar2(100) := '....';
  v_text varchar2(4000);
BEGIN
    dbms_output.put_line('Starting file read');
    fp := UTL_FILE.FOPEN(v_file_loc,v_file_name,'r');
    LOOP
        utl_file.GET_LINE(fp,v_text);
        dbms_output.put_line(v_text);
    END LOOP;
    UTL_FILE.FCLOSE(fp);
END;
/ 
```

然后，您可以进行额外的步骤，将其实际创建为数据库中的过程，然后简单地调用该过程。PS。末尾的斜线告诉 SQL*Plus 或 SQL Developer 执行代码。这取决于您使用什么来运行 SQL。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T21:54:54.753

并为每个呼叫产生一次网络往返？听起来就像是性能的死亡。重写存储过程可能会更好，这样您就可以减少网络流量。

# html - 如何显示修订历史，如修订

> ID：923398
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-28T21:52:44.147
> 
>         
> 
> 标签：html, diff, revision

Stack Overflow 如何以他们使用的类似 diff 的格式显示修订更改？

我不关心 Stack Overflow 本身；这只是描述我的要求的一种方便方式。我有一个文本字段更改的审计历史记录。我想以 Stack Overflow 显示修订历史更改的方式来显示更改。我记得 Jeff Atwood 讨论过 Stack Overflow 播客，但我在成绩单中找不到它，也不知道是什么播客。IIRC，它不是基于 .NET，也许是 Python？

这是供最终用户使用的，因此任何看起来像 Unix-like diff 的东西都出来了。显示两个块和文本，旧的和新的，并让他们弄清楚是很诱人的，但是 Stack Overflow 的修订历史要好得多。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T21:56:18.167

Python[`difflib`](http://docs.python.org/library/difflib.html)标准库提供了这种能力：

> 该模块提供用于比较序列的类和函数。例如，它可以用于比较文件，并且可以生成各种格式的差异信息，包括 HTML 和上下文以及统一差异。要比较目录和文件，另请参阅`filecmp`模块。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:09:09.997

由于您没有真正指定语言：我使用 PHP PEAR 包[Text_Diff](http://pear.php.net/package/Text_Diff/)完成了这项工作。

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-05-28T22:05:21.703

他们使用[Beyond Compare](https://blog.stackoverflow.com/2008/09/what-was-stack-overflow-built-with/)。据我所知，它不是本机 .NET 程序，但您可以将其用作命令行工具。

# php - PHP中浮点数的条件格式

> ID：923399
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T21:53:17.097
> 
>         
> 
> 标签：php

我正在从 php 页面（2.5、3.0 等）上的 mysql 数据库中检索浮点值

我想格式化这个值，如果它实际上是一个整数，它应该显示零小数位。（它应该输出 3 而不是 3.0，但输出 2.5 作为 2.5）

实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T21:58:08.973

我会尝试以下方式：

```
echo (intval($v) == $v) ? intval($v) : $v; 
```

但我想知道是否有更有效的方法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:17:35.033

您也可以在查询中进行格式化，这可能比在 php 中进行格式化要快，尤其是在您有很多行要处理的情况下。

就像是：

```
SELECT
    CASE 
        WHEN t.myColumn % 1 = 0 
            THEN FORMAT( t.myColumn, 0 ) 
            ELSE FORMAT( t.myColumn, 2 )
    END AS `formatted`
    ...
FROM myTable t
WHERE ... 
```

如果您想在数据库之外执行此操作，则相同的方法适用于 php：

```
$displayValue = $myValue % 1 == 0 
    ? number_format( $myValue, 0 ) 
    : number_format( $myValue, 2 ); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:30:38.347

如果要控制小数点右侧显示的位数，也可以使用 printf ：

```
 if (intval($v) == $v) printf("%d", intval($v)); else printf("%0.2f", $v); 
```

# .net - 如何在实体框架和 ASP.NET MVC 中伪造外键集合属性

> ID：923400
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-28T21:53:20.107
> 
>         
> 
> 标签：.net, asp.net-mvc, entity-framework, ado.net

在 Alex James 的博客文章[How to fake Foreign Key Properties in .NET 3.5 SP1](http://blogs.msdn.com/alexj/archive/2009/03/25/tip-7-faking-foreign-key-properties-in-net-3-5-sp1.aspx)中，他解释了如何将外键属性添加到实体对象。

我已经使用它来获取在强类型 ASP.NET MVC 应用程序中使用 DropDownList 的引用/导航属性，如下所述：

[具有 ADO.NET 实体框架的强类型 ASP.NET MVC](https://stackoverflow.com/questions/922402/strongly-typed-asp-net-mvc-with-ado-net-entity-framework)

我还需要处理集合。我可以使用 Tyler Garlick 的 CheckBoxList 而不是内置的 DropDownList。

[带有 CheckBoxList 的 ASP.NET MVC http://img241.imageshack.us/img241/5197/checkboxlistpeople.gif](http://img241.imageshack.us/img241/5197/checkboxlistpeople.gif)

但是如何扩展 ObjectContext 和我的 EntityObjects 来处理一对多的类型关系呢？

我是否扩展我的 Department EntityObject 类以包含 Guid 通用列表类型的 PersonIds 属性？如何处理 set 访问器？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:36:42.637

我假设您可以将选定的人员 ID 放入 Action 方法中，并且所有人员都已存在于数据库中……因为此表单只是创建与人员的关系并更新部门本身，而不是创建新员工。

在这种情况下，您想做这样的事情（伪代码）：

```
// get the department from the form using the model binder
Department updated = ... ;

// get the ids of the selected people from the form too.
var currentlySelectedStaffIds = ...;

// get the original department from the database 
// including the originally related staff
Department original = ctx.Departments.Include("Staff")
                      .First(dep => dep.Id = updated.Id);

// get the ids of all the originally related staff
var originalStaffIds = original.Staff.Select(s => s.Id).ToArray();

// get the People to be removed from the department
var removedStaff = (from staff in original.Staff
                   where !currentlySelectedStaffIds.Contains(staff.Id)
                   select staff).ToArray();

// get People added to the department (but attached to the context)
var addedStaff = currentlySelectedStaffIds.Except(originalStaffIds)
                 .Select(id => new Person {Id = id}).ToArray();

// Remove the original staff no longer selected.
foreach(var removed in removedStaff)
{
    original.Staff.Remove(removed);
}

// Attach the 'added' staff and build a new relationship for each one
foreach(var added in addedStaff){
   //Put the staff added to the department in the context
   ctx.AttachTo("People", added); 
   // build a new relationship
   original.Staff.Add(added); 
}

// Apply the changes from updated to the original entity
ctx.ApplyPropertyChanges("Departments", updated);
ctx.SaveChanges(); 
```

这基本上是你需要做的..

希望这可以帮助

亚历克斯

# javascript - 验证是否所有复选框都未选中的快速方法？

> ID：923407
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T21:56:00.333
> 
>         
> 
> 标签：javascript, html, validation, forms, input

如果取消选中所有复选框，是否有一种快速方法或功能可以告诉我真/假？不经过数组？（带有 JS 和 HTML）

我所有的复选框都具有相同的名称...

```
<form action="/cgi-bin/Lib.exe" method=POST name="checks" ID="Form2">
    <input type=checkbox name="us" value="Joe" ID="Checkbox1">
    <input type=checkbox name="us" value="Dan" ID="Checkbox2">
    <input type=checkbox name="us" value="Sal" ID="Checkbox3">
</form> 
```

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-28T22:01:13.287

对于如此微不足道的任务，jQuery 将是一大堆不必要的臃肿。如果您将它用于其他目的，请考虑使用它，但您只需要这样的东西：

```
function AreAnyCheckboxesChecked () {
  var checkboxes = document.forms.Form2.elements.us;
  for (var i = 0; i < checkboxes.length; i++) {
    if (checkboxes[i].checked) {
      return true;
    }
  }
  return false;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T22:01:07.657

你必须遍历它们。即使是像 jQuery 这样的库也会循环遍历它们，只是对你隐藏它。

```
var form = document.getElementById('Form2');
var inputs = form.getElementsByTagName('input');
var is_checked = false;
for(var x = 0; x < inputs.length; x++) {
    if(inputs[x].type == 'checkbox' && inputs[x].name == 'us') {
        is_checked = inputs[x].checked;
        if(is_checked) break;
    }
}
// is_checked will be boolean 'true' if any are checked at this point. 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T22:22:48.283

JavaScript：

```
var allischecked = (function(){
  var o = document.getElementById("Form2").getElementsByTagName("input");
  for(var i=0,l=o.length;i<l;i++){
    o[i].type === "checkbox" && o[i].name === "us" && o[i].checked || return false;
  }
  return true;
})(); 
```

使用 jQuery：

```
var allischecked = ($("#Form2 input:checkbox:not(checked)").length === 0); 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:00:14.350

总之，如果未选中所有内容，此剪辑将返回 true。一旦找到已检查的，它就会退出。

```
var a = document.getElementsByName("us");
for(var i=0; i<a.length; i++)
   if(a[i].checked)
      return false;
return true; 
```

（没有测试，但在概念上它是有效的）

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:08:39.623

你是什​​么意思

> 无需通过数组

?

你可以做

```
 function check() {
    var anyChecked = false;
    var form = document.getElementById('Form2');
    var checkboxes = form.getElementsByTagName('input');
    for(var i=0; i < checkboxes.length; i++) {
            if (checkboxes[i].checked) {
                anyChecked  = true;
                break;
            }
    } 
    alert("Checkboxes checked? " + anyChecked);
} 
```

[**工作演示**](http://jsbin.com/igama)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:30:00.670

如果您有大量不想循环测试的复选框，则使用此方法可能更有效。

```
var checked = 0;

$("input[type=checkbox]").live("click", function() {
    if($(this).attr("checked")) checked++;
    else checked--;
} 
```

然后你就可以像这样测试了。

```
if(checked === 0) {
    doSomething();
} 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2018-08-29T14:30:49.133

使用 jQuery 属性的正确解决方案`checked`：

```
$checkboxes = $('#Form2 input:checkbox');
$checkboxes.on('click', checkboxes);

function checkboxes() {
  var allChecked = $checkboxes.not(':checked').length == 0;
  console.log(allChecked);
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
<form action="/cgi-bin/Lib.exe" method=POST name="checks" ID="Form2">
    <input type=checkbox name="us1" value="Joe" ID="Checkbox1"><label>Joe</>
    <input type=checkbox name="us2" value="Dan" ID="Checkbox2"><label>Dan</>
    <input type=checkbox name="us3" value="Sal" ID="Checkbox3"><label>Sal</>
</form>
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2020-02-28T13:15:56.523

没有循环更容易

```
const toggleCheckboxes = checkbox => {
   if(checkbox.checked){
      return true
   }else{
      if(document.querySelectorAll(':checked').length === 0){
          // All are unchecked
          return false
      }
   }
} 
```

# android - Android - 用颜色填充位图

> ID：923408
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-28T21:56:06.090
> 
>         
> 
> 标签：android, bitmap, fill

我正在使用Android，我真的需要一种快速的方法来获取预定大小的位图以填充预定颜色。

但是，以下代码对我不起作用；

位图输入是可变位图

```
 int old = input.getPixel(0, 0);
    Canvas c = new Canvas(input);
    Rect rect = c.getClipBounds(); // The dimensions of the bitmap are returned
    c.drawARGB(a, r, g, b);
    int n = input.getPixel(0, 0);
    if(old==n)
        Log.e(TAG, "Values didn't change!");
    return input; 
```

请放心，“旧”值和 (a|r|g|b) 的值是不同的，但是使用带有可变位图的画布“绘制”了颜色，位图保留了它的旧值。

我会对任何采用位图和颜色值并返回填充该颜色的位图的方法感到满意。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-28T22:09:23.177

我没有提供足够的信息！

我的 alpha 值超出范围；

```
int a = 0xFF<<24 
```

所以当我打电话

```
c.drawARGB(a,r,g,b); 
```

它悄悄地失败了，并没有改变价值观。

# .net - 在 .NET 中共享程序集

> ID：923435
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T22:05:40.440
> 
>         
> 
> 标签：.net, assemblies

我们的应用程序使用大量自定义构建和第三方库，现在每个应用程序都有对这些程序集的私有引用，这意味着每个应用程序的 bin 文件夹都复制了引用的程序集。例如，应用程序 A 引用 log4net.dll、CustomLibA.dll、CustomLibB.dll 和应用程序 B 也引用 log4net.dll、CustomLibA.dll、CustomLibB.dll，这些程序集存储在以下结构中。

D:\Inetpub\wwwroot\ApplicationA\bin D:\Inetpub\wwwroot\ApplicationB\bin

我对这种安排有以下疑问：

1.  我认为随着应用程序数量和引用的增加，这会产生性能问题，因为每个应用程序都会加载所有这些程序集，这将导致虚拟地址碎片。我的假设对吗？

2.  我可以组织应用程序，使所有这些应用程序都引用来自公共文件夹的程序集并且在 bin 文件夹中没有私有副本吗？例如，程序集 log4net.dll、CustomLibA.dll、CustomLibB.dll 组织在以下文件夹中

D:\Inetpub\wwwroot\Apps\Common

并由组织如下的应用程序引用：

D:\Inetpub\wwwroot\Apps\ApplicationA D:\Inetpub\wwwroot\Apps\ApplicationB

这些应用程序中的 bin 文件夹将没有通用程序集。

这行得通吗？我试图通过将本地复制设置为 false 来做到这一点，但我得到“无法加载文件或程序集 xxxx”。

我知道我可以使用 GAC，但由于我们部署过程的性质，我想避免 GAC 用于某些自定义构建的库。

谢谢，哈里·克里希南。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:10:03.490

您始终可以为 appdomain 添加其他路径以在其他文件夹而不是 bin 或 gac 中查找引用。

AppDomain.AddReferencePath

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:30:42.477

如果您使用 GAC，则可能会为性能和代码共享带来额外的好处。请注意，让所有应用程序引用一个公共共享路径不会改变每个应用程序都将自己的程序集副本加载到内存中的事实。

共享路径给您的唯一好处是不必部署这些程序集的多个副本。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:11:07.760

我认为 GAC 是通用类库的最佳选择。您仍然可以将自定义库部署到本地 \bin 目录。

# mysql - Mysql子选择替代

> ID：923438
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:06:02.903
> 
>         
> 
> 标签：mysql, subquery

我有一个查询，我知道可以使用子选择来完成，但由于表大小很大（每个表 100k+ 行），我想找到一个使用连接的替代方法。这不是一个家庭作业问题，但用这样的术语分享一个例子更容易。

假设有两个表：

Students 

:id :name 

1 Tom 

2 Sally 

3 Ben

书籍

:id :student_id :book 

1 1 数学 101 

2 1 历史

3 2 NULL 

4 3 数学 101

我想找到所有没有历史书的学生。工作子选择是：

从 id 不在的学生中选择姓名（从 book = 'History' 的书籍中选择 student_id）；

这将返回 Sally 和 Ben。

感谢您的回复！

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:18:22.270

性能是问题吗？或者这只是一些避免子查询的理论（家庭作业？）问题？如果是性能，那么：

```
SELECT *
FROM studnets s
WHERE NOT EXISTS
(SELECT id FROM books WHERE student_id = s.id AND book = 'History') 
```

将比您在 MySQL 上执行的 IN 执行得更好（在其他一些数据库上，它们将执行等效）。这也可以改写为连接：

```
SELECT s.*
FROM studnets s
LEFT JOIN books b ON s.id = b.student_id AND b.book = 'History'
WHERE b.id IS NULL 
```

# visual-studio-2008 - 如何将 SQL Server 2008 Express 添加到先决条件列表

> ID：923439
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-28T22:06:32.933
> 
>         
> 
> 标签：visual-studio-2008, sql-server-2008, installation, sql-server-2008-express

如何将 SQL Server 2008 Express 添加到 Visual Studio 2008 SP1 MSI 安装程序项目的先决条件列表中。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-07-01T08:31:38.867

您必须从 MS 下载中心下载 SQL Server 2008 Bootstrapper（我认为它也包含在 VS2008 Express Edition 中）并将其复制到 C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages。“Packages”下的每个文件夹都是 Visual Studio 2008 SP1 MSI 安装程序项目中先决条件列表的一个条目。

顺便说一句 - 如果您想创建自定义引导程序，请查看文章
[创作自定义引导程序包](http://msdn.microsoft.com/en-us/library/aa730839(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-06-10T08:28:33.137

在 Visual Studio 2010 中，SQL Server 2008 Express 选项包含在先决条件列表中。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-06-10T08:20:54.777

SQL Server 2008 Express 的选项包含在先决条件列表中

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-07-21T08:22:52.217

1.  安装任何版本的 Visual Studio 2008 Express SP1。

2.  进入引导程序目录 (C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages) 并重命名 SqlExpress2008 和 WindowsInstaller4_5 目录。

3.  卸载 Visual Studio 2008 Express SP1（如果您不想保留它）。

复制粘贴自：[Sql Server Express 博客](http://blogs.msdn.com/sqlexpress/archive/2008/09/12/faq-installing-the-sql-server-2008-express-clickonce-bootstrapper-for-visual-studio-2008-sp1.aspx)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-06-04T00:09:41.913

据我所知，当 Visual Studio 2008 发布时，SQL Server 2008 还不存在，只有 2005 版本。所以我认为你在安装Visual Studio 2008的时候可能不会安装SQL Server 2005，然后再单独安装SQL Server 2008。

问候。

# .net - 是否可以使用 STSADM 在 MOSS/Sharepoint 中导出站点定义？

> ID：923450
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:09:10.510
> 
>         
> 
> 标签：.net, sharepoint, sharepoint-2007, moss, stsadm

是否可以使用 stsadm 导出站点定义（不是站点模板）？我正在寻找一种导出 ONET、WEBTEMP 和任何所需功能的方法。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-15T12:28:14.350

马特，

关于您的具体情况没有太多详细信息，但鉴于问题中的信息，这就是我认为您正在寻找的信息。

**假设**：您在场上部署了一个自定义站点定义，并且您想要获取它的源代码。

我可以想到两种方法来做到这一点：

1) 检查 12 hive 中的 \Templates\SiteTemplates 文件夹。是的，这些是默认的站点定义...... MS 有一个真正的问题，即在 SP 中一致地命名对象。此文件夹中的定义都有一个包含 ONET.xml 文件的 XML 子文件夹。

如果站点定义部署在解决方案 (.wsp) 中，则它可能不存在于配置单元的结构中（应该存在，但我有一段时间没有对此进行测试）。如果是这种情况，请使用选项 #2。

2) 使用要导出的定义在场上创建站点。使用 stsadm 将该站点导出到文件。该文件的结构非常简单。它是包含一个清单的压缩档案，该清单将提供内部-> 实际文件名的必要映射。该定义将包含在档案中。

# openssl - 使用 openssl 将私钥从 .cer 提取到 .pem

> ID：923453
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T22:09:42.710
> 
>         
> 
> 标签：openssl, certificate, ssl-certificate

如何导出嵌入在 .cer 文件中的私钥并使用 openssl 将其转换为 .pem。

**更新：**

如果我从 Apple 下载 .cer 文件并将其导入 KeyChain，我可以将私钥导出为 .p12 文件。如何使用 openssl 做到这一点？

[![替代文字](https://i.stack.imgur.com/VqGyJ.jpg)](https://i.stack.imgur.com/VqGyJ.jpg)

[（来源：[flickr.com](https://farm4.static.flickr.com/3417/3573762565_949ef958e4.jpg)）]  

[![替代文字](https://i.stack.imgur.com/9XlAq.jpg)](https://i.stack.imgur.com/9XlAq.jpg)

[（来源：[flickr.com](https://farm4.static.flickr.com/3562/3574569572_d29c8ca0b5.jpg)）]  

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-05-28T22:18:58.870

不幸的是 - 证书不包含私钥（它包含，但包含公钥）。您需要私钥源（通常是 .p12）来提取私钥。

希望这可以帮助。

# c++ - 在 Qt 中运行单独的进程或线程

> ID：923458
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-28T22:10:59.697
> 
>         
> 
> 标签：c++, multithreading, qt, concurrency

我正在编写我的第一个真正有用的软件。其中一部分将涉及用户查看图像，并选择接受或拒绝它。这样做会导致图像被保存到接受或拒绝的文件夹中，并且可能会旋转和/或调整大小。

目前，我的旋转/调整大小/保存操作正在暂停我的程序的执行，但我希望它发生在后台，以便立即显示下一张图像。

是在 Qt 中执行此操作以在单独的线程中处理图像的唯一方法，还是有其他方法？我还在研究 C++ 和 Qt，所以我不想因为潜入一个新领域而迷惑自己！

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-05-28T22:22:26.740

Qt 有线程支持。您可能会发现[此示例应用程序](http://doc-snapshot.qt-project.org/4.8/threads-queuedcustomtype-renderthread-cpp.html)很有趣，因为它与您所描述的有些相似。

此外，[这里是完整的 Qt 线程文档](http://doc.qt.digia.com/stable/thread-basics.html)。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:32:49.417

这类任务非常适合线程。仍然，您应该首先执行一个“正常”函数来执行它，然后在它工作时添加一个读取队列并调用相同处理函数的线程。

Qt 有很多工具可以帮助您，主要是大多数容器都是线程安全的，还有一些线程算法（如 map-reduce）。还是先同步试试吧。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T08:54:27.450

**已编辑**

抱歉，我很难将“排队的自定义类型示例”与要求联系起来。

据我从问题中可以看出，一旦用户接受或拒绝了图像，它必须是可选的旋转和/或缩放，并且始终保存到特定目录并继续下一个图像。（-> 不再与用户交互）
即使用户离开当前对话框，图像仍然必须保存。

“队列自定义类型示例”只处理一个图像，始终链接到 gui，当用户退出对话框时，线程操作停止。

因此，如果他从 Queued 示例开始他的程序，他可能会开始编写一个受互斥锁保护的图像队列，以便在有待处理的保存操作时将新图像添加到列表中。否则用户仍然需要等待挂起的操作。

第二个问题是他可能不想在对话框关闭时等待挂起的保存操作。

为了满足要求，我会做的是使用线程池。如果还需要旋转/缩放，则为线程池提供所需的保存操作并使用基于 QRunnable 的装饰器模式。所有排队都由库正确处理，即使用户离开当前对话框，也会执行挂起的操作。最后，我可能会使用 Queued 示例代码来加载新图像并为用户提供加载操作的等待指示。

我的 runnables 和装饰器可能看起来像这样......（可能是一些额外的构造函数来替换 set 函数）所以我可以很容易地添加这样的新操作`QThreadPool::globalInstance()->start(saver );`不使用任何低级同步对象。

```
class ImageDecorator : public QRunnable
{
    NextStep nextStep;
public:
    typedef boost::shared_ptr<QRunnable> NextStep;

    ImageDecorator(const NextStep& nextStep) : nextStep(nextStep) {
    }   

    ImageDecorator() : nextStep() {
    }

    // set/get image functions....

protected:
    void next() {
        if( nextStep )
            nextStep->run();
    }
};

class RotateImage : public ImageDecorator
{
public:
    typedef boost::shared_ptr<Image> Image;

    RotateImage(const NextStep& nextStep) : ImageDecorator( nextStep) {
    }   

    RotateImage() : ImageDecorator() {
    }
    // set angle functions....

private:
    void run()
    {
        // rotate the image
        // ...
        next();
    }
};

class ResizeImage : public ImageDecorator
{
public:
    typedef boost::shared_ptr<Image> Image;

    ResizeImage(const NextStep& nextStep) : ImageDecorator( nextStep) {
    }   

    ResizeImage() : ImageDecorator() {
    }
    // set size functions....

private:
    void run()
    {
        // resize the image
        next();
    }
};

class SaveImage : public ImageDecorator
{
public:
    typedef boost::shared_ptr<Image> Image;

    SaveImage(const NextStep& nextStep) : ImageDecorator(nextStep) {
    }   

    SaveImage() : ImageDecorator() {
    }
   // set fileName functions....

private:
    void run()
    {
        // save the image
        next();
    }
};

// save the image 
SaveImage *const saver( new SaveImage() );
saver->setImage( /*use shared pointer*/ );
saver->setFilename( ... );

QThreadPool::globalInstance()->start( saver );

// rotate and save the image 
const ImageDecorator::NextStep saver( new SaveImage() );
saver->setImage( /*use shared pointer*/ );
saver->setFilename( ... );
RotateImage *const rotateAndSave( new RotateImage( saver ) );
rotateAndSave->setImage( /*use shared pointer*/ );
rotateAndSave->setAngle( ... );

QThreadPool::globalInstance()->start( rotateAndSave );

// resize rotate  and  save the image 
const ImageDecorator::NextStep saver( new SaveImage() );
saver->setImage( /*use shared pointer*/ );
saver->setFilename( ... );
const ImageDecorator::NextStep rotateAndSave( new RotateImage( saver ) );
rotateAndSave->setImage(/*use shared pointer*/ );
rotateAndSave->setAngle( ... );
ResizeImage *const resizeRotateAndSave( new ResizeImage( rotateAndSave ) );
resizeRotateAndSave->setImage( /*use shared pointer*/ );
resizeRotateAndSave->setSize( ... );

QThreadPool::globalInstance()->start( resizeRotateAndSave ); 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2013-08-19T06:03:37.390

要么创建一个单独的线程，`QThread`要么使用线程池工作线程，`QRunnable`或者查看高级 QtConcurrent 类。[这](http://harmattan-dev.nokia.com/docs/library/html/qt4/qtconcurrent-imagescaling.html)是图像缩放的示例。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2013-08-19T08:20:05.333

最简单的方法是使用 QtConcurrent::run

# visual-studio - 在现有目录中创建项目/解决方案？

> ID：923461
> 
>         
> 
> 赞同：28
> 
>         
> 
> 时间：2009-05-28T22:11:21.973
> 
>         
> 
> 标签：visual-studio, ide, visual-studio-2005, visual-sourcesafe

如何在相同的现有目录中创建新项目和解决方案？无论我做什么，它都会为项目创建一个新的（子）目录并填充该目录而不是已经存在的目录。我清除了“为解决方案创建目录”复选框，以便它将解决方案和 dproject 放在同一文件夹中，而不是创建解决方案文件夹，但它仍然会继续制作项目子文件夹。

我怎样才能解决这个问题？！？

这困扰了我很长时间，但直到现在我一直能够忽略它或解决它。但现在它在我的客户项目中提高了我的生产力，我需要修复它。谢谢... RBarryYoung

（注：这是VS2005，软件开发团队版）

* * *

## 回答 #1

> 赞同：23
> 
>             
> 
> 时间：2009-05-28T22:18:55.157

在 Visual Studio 中，如果您没有打开解决方案，您可以选择

文件->新建->现有代码中的项目

选择项目类型

将您希望解决方案和项目文件所在的目录作为“项目文件位置”字段。

完成向导，您将在同一目录中拥有一个项目文件和解决方案文件。

**如果“现有代码项目”选项不可用**

使用 VS 的自定义功能制作自定义键盘快捷键、工具栏按钮或菜单项。

工具->自定义

选择“键盘”按钮以添加键盘快捷键，或选择“命令”选项卡以添加工具栏按钮或菜单项。您正在寻找的命令是：

文件->从现有代码新建项目

分配任何键盘快捷键或将图标拖动到您想要的任何菜单/工具栏。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2013-02-18T15:16:11.003

要在现有目录中创建解决方案，我发现最好的方法是从您实际想要的位置创建一个目录，然后使用您真正想要的目录名称作为解决方案的名称。

如果这不是您想要的名称（即您不希望您的解决方案名称与其所在目录的名称匹配），那么一旦您创建它，您可以通过右键单击它并选择来重命名解决方案“改名”。它不会重命名它所在的目录，也不会移动它。这是迄今为止最简单的方法。

您显然也可以对一个项目使用相同的技巧，但是如果您在一个目录中有多个项目，理想情况下它们构建的中间目录应该不同，否则如果您只想重建一个，您将遇到问题其中，它清除了中间目标目录。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:29:11.843

您始终可以手动移动内容并编辑 sln 文件以修复项目引用。例如，如果您希望解决方案文件与项目文件位于同一目录中，则可以从任何位置剪切解决方案文件并将其粘贴到项目文件目录中。然后您需要编辑解决方案文件以修复项目引用，以便解决方案在打开时可以找到项目。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:49:38.637

我不知道有什么开箱即用的解决方案适合您。但是，如果代码文件根据所需的结构组织到文件夹中，您也许可以组合一个工具来为您完成它。项目文件的结构并不复杂，它们是相当简单的 XML 文档，主要由项目中包含的文件列表组成。

我假设生成的项目文件可能仍需要一些体力劳动，但您应该能够获得代码来为您完成繁重的工作。你可能会得到一个漂亮的工具来发布在你的博客上。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2018-08-07T07:41:24.017

1.  打开现有项目。如果您还没有，请创建一个临时的。

2.  选择“文件”>“新建”>“项目”

3.  确保选中“创建新解决方案”

4.  选择您想要的项目类型。

5.  按确定创建项目

如果您在第一步中创建了一个临时项目，您现在可以将其删除

-> 现在您已经创建了一个项目，其中解决方案文件位于项目中
[![在此处输入图像描述](https://i.stack.imgur.com/xq1vx.png)](https://i.stack.imgur.com/xq1vx.png)

* * *

## 回答 #6

> 赞同：-2
> 
>             
> 
> 时间：2019-11-27T12:52:47.037

```
 public static class SlnFileGenerator
            {
                #region Public Methods
                public static string GetBatFileContent(string directoryPath, string slnFileName)
                {
                    if (directoryPath == null)
                    {
                        throw new ArgumentNullException(nameof(directoryPath));
                    }

                    if (slnFileName == null)
                    {
                        throw new ArgumentNullException(nameof(slnFileName));
                    }

                    var sb = new StringBuilder();
                    sb.AppendLine($"dotnet new sln --name {slnFileName}");

                    foreach (var csprojFile in Directory.GetFiles(directoryPath, "*.csproj", SearchOption.AllDirectories))
                    {
                        var relativePath = csprojFile.RemoveFromStart(directoryPath);

                        sb.AppendLine($"dotnet sln \"{slnFileName}.sln\" add \"{relativePath}\"");
                    }

                    sb.AppendLine("pause");

                    return sb.ToString();
                }
                #endregion
            } 
```

# iis-7 - IIS7 重写模块规则的备用 Web.Config

> ID：923462
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-28T22:11:26.747
> 
>         
> 
> 标签：iis-7, module, rewrite

是否可以像使用 appsettings 一样将 IIS7 重写模块创建的规则从根 Web 配置移动到其自己的 Web 配置文件中，如果可以，如何？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-07-14T17:44:58.043

我似乎无法让它工作，但它的描述方式是：

```
<rewrite>
   <rewriteMaps configSource="external.config">
   </rewriteMaps>
</rewrite> 
```

然后在 external.config 文件中添加您的规则：

```
<rewriteMaps>
  <rewriteMap ...
  ...
</rewriteMaps> 
```

您必须对整个 rewriteMap 部分执行此操作**：**根据此论坛帖子，您不能对 rewriteMap 执行此操作：[http ://forums.iis.net/t/1154113.aspx](http://forums.iis.net/t/1154113.aspx)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2012-09-12T18:10:43.123

这在 web.config 中对我有用：

```
<system.webServer>
    <rewrite>
      <rules configSource="web.rules.config" />
    </rewrite>
</system.webServer> 
```

一件很酷的事情是[IIS 配置编辑器](http://www.iis.net/downloads/microsoft/administration-pack)在您编辑规则并将更改写回外部文件时尊重此外部文件。

如果你放：

```
<system.webServer>
    <rewrite configSource="web.rules.config" />
</system.webServer> 
```

它不起作用，您会收到 HTTP 错误 500.19 内部服务器错误：

```
Error Code:   0x8007000d
Config Error: Unrecognized attribute 'configSource' 
```

谁能指出有关`rewrite`元素和`configSource`属性的权威 MSDN 帮助页面？system.webServer 上的[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms689429.aspx)没有提到 rewrite 元素，我无法通过谷歌找到 MSDN 页面。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-03-13T08:14:46.173

我找到了[配置文档](http://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-20-configuration-reference)，但它似乎没有涵盖 configSource 属性的使用。

我的猜测是该`<rules />`元素是作为具有[configSource](http://msdn.microsoft.com/en-us/library/system.configuration.sectioninformation.configsource.aspx)属性的 SectionInformation 实现的，而该`<rewrite />`元素是没有的[ConfigurationSection](http://msdn.microsoft.com/en-us/library/system.configuration.configurationsection.aspx)。

# sql-server-2005 - SQL Server 复制 - 添加新的存储过程 - 如何让它复制？

> ID：923465
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:12:48.087
> 
>         
> 
> 标签：sql-server-2005, stored-procedures, replication

我有一个使用合并复制的 SQL Server 2005 数据库。

我在发布者端添加了四个新的存储过程，但它们没有被复制。

发布属性“订阅选项”-“复制架构更改”设置为 True。

我怎样才能轻松地复制这些表，而无需向所有订阅者发送新快照？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2012-02-15T17:06:57.070

我找到了这段代码，也许它会有所帮助。

```
create table table2(pk int not null primary key, charcol char(20))
GO
sp_addarticle 'paul','table2','table2'
GO
sp_refreshsubscriptions 'paul'
GO
sp_addsubscription 'paul','table2',@@servername,'paulsub'
GO 
```

添加文章然后运行快照代理似乎重新初始化了整个发布。

# python - 匹配 HTML 中 P 标记内的文本

> ID：923472
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T22:16:13.540
> 
>         
> 
> 标签：python, html, regex

我想使用 python 正则表达式匹配 html 中每个段落中的内容。这些段落中总是有 BR 标签，如下所示：

```
<p class="thisClass">this is nice <br /><br /> isn't it?</p> 
```

我目前正在使用这种模式：

```
pattern = re.compile('<p class=\"thisClass\">(.*?)<\/p>') 
```

然后我正在使用：

```
pattern.findall(html) 
```

找到所有匹配项。但是，它只匹配我拥有的 28 个段落中的两个，看起来那是因为这两个段落中没有 BR 标签，而其余的则有。我究竟做错了什么？我能做些什么来修复它？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T22:22:03.340

我不认为它失败了，`<br/>`而是因为该段落分布在多行中。使用[DOTALL](http://docs.python.org/library/re.html#re.DOTALL)模式来解决这个问题：

```
pattern = re.compile('<p class=\"thisClass\">(.*?)<\/p>', re.DOTALL) 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:31:34.693

事实证明，答案是包含 re.S 作为允许“。”的标志。字符也匹配换行符。

```
pattern = re.compile('<p class=\"thisClass\">(.*?)<\/p>', re.S) 
```

这完美地工作。

# .net - 输出带有属性的xml

> ID：923478
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T22:18:05.237
> 
>         
> 
> 标签：.net, xml, xmlwriter

我如何获得这个输出？

```
<MSRP currency="USD">10.00</MSRP> 
```

writer.WriteElementString("MSRP", Convert.ToString(q.ItemPrice1));

writer.WriteAttributeString("货币", "MSRP", "USD");

这是错误：

状态为 Content 的令牌 StartAttribute 将导致无效的 XML 文档。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T22:21:46.633

```
writer.WriteStartElement( "MSRP" );
writer.WriteAttributeString( "currency", "USD" );
writer.WriteString( q.ItemPrice1.ToString() );
writer.WriteEndElement(); 
```

当您调用 WriteElementString 时，它会一次写入整个元素 - 以后没有机会添加属性。您必须使用 WriteStartElement 打开元素...然后使用 WriteEndElement 将其关闭。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:28:05.170

我相信这会成功。

```
writer.WriteStartElement("MSRP");
writer.WriteAttributeString("currency", "USD");
writer.WriteValue("10.00");
writer.WriteEndElement(); 
```

请参阅[msdn 上的文档](http://msdn.microsoft.com/en-us/library/4d1k42hb.aspx)

# jquery - 使用 jQuery 调用远程 ASMX 的问题

> ID：923481
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T22:18:28.167
> 
>         
> 
> 标签：jquery, web-services

一直在尽力正确理解这一点。XML、SOAP 和 JSON 响应之间有什么区别？以及如何知道如何调用响应是上述之一的 Web 服务？（......如果我偏离轨道，请纠正我）

我之所以问这个问题是因为我试图在我的 .NET3.5 webapp 中从 jQuery 调用远程 ASMX，但一点运气都没有！基本上我正在尝试调用 CurrencyConverter 方法，如下所示：[http ://www.webservicex.net/CurrencyConvertor.asmx?op=ConversionRate](http://www.webservicex.net/CurrencyConvertor.asmx?op=ConversionRate)

我可以看到它返回 XML，但以下代码不起作用：

```
$('#Currency').bind('change', function() {
    var targetDiv = '#Result'
    var currencyValue = $('#Currency option:selected').attr('value')
    var webMethod = 'http://www.webservicex.net/CurrencyConvertor.asmx/ConversionRate'
    var parameters = "{'FromCurrency':'GBP','ToCurrency':'" + currencyValue + "'}"

    $(targetDiv).html('loading...');

    $.ajax({
        type: "POST",
        url: webMethod,
        data: parameters,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(response) {
            $(targetDiv).html(response.d);
        },
        error: function(response) {
            $(targetDiv).html("Unavailable:" + response);
        }
    });
}); 
```

请有人可以帮助我，因为我真的迷路了！

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T23:10:48.170

我以前使用过这个网络服务。它期望并返回 XML。这是我用来在 Internet Explorer 中工作的代码（对于 Firefox，您需要使用 jsonp）。

```
$('#Currency').bind('change', function() {
    var targetDiv = '#Result'
    var currencyValue = $('#Currency option:selected').val();
    var webMethod = 'http://www.webservicex.net/CurrencyConvertor.asmx/ConversionRate';
    var parameters = "?FromCurrency=GBP&ToCurrency=" + currencyValue;

    $(targetDiv).html('loading...');

    $.ajax({
        type: "GET",
        url: webMethod + parameters ,
        contentType: "text/xml; charset=utf-8", 
        dataType: "xml", //for Firefox change this to "jsonp"
        success: function(response) {
            $(targetDiv).html(response.text);
        },
        error: function(xhr, textStatus, errorThrown) {
            $(targetDiv).html("Unavailable: " + textStatus);
        }
    });
)}; 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:47:56.783

[编辑] 您可以尝试的另一件事是将 JQuery 调用中的 dataType 更改为“xml”。如果这不起作用，您可以创建自己的代理 Web 服务来调用远程服务，然后以 JSON 格式返回数据。

我怀疑问题出在服务器端代码中。我不确定这是否适合您，但这里有一些工作代码显示 JQuery 调用我的 WebMethod。希望您可以将其与您的进行比较并使其正常工作。让我们知道解决方案是什么。我希望这有帮助。

```
[Server Code]

using System;
using System.ComponentModel;
using System.Data;
using System.Web;
using System.Web.Services;
using System.Web.Services.Protocols;

[WebService(Namespace = "http://tempuri.org/")]
    [WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
    [ToolboxItem(false)]
    [ScriptService]
    public class ForumService : System.Web.Services.WebService
    {

        [WebMethod]
        [ScriptMethod(UseHttpGet = false, ResponseFormat = ResponseFormat.Json)]
        public VoteCastResult CastQuestionVote(string itemID, QAForum.Bll.VoteType voteType)
        {
            try
            {
                User usr = SecurityHelper.GetOrCreateUser();
                Guid question = new Guid(itemID);
                return new QuestionVoteController().CastQuestionVote(usr, question, voteType);
            }
            catch (Exception ex)
            {
                return new VoteCastResult(VoteCastStatusType.otherIssue, 0, ex.Message);
            }
        }
    }

[JQuery Code]

    function AFTopicCastVote(clickContext, itemID, voteDirection, voteMethod)
    {
          $.ajax({
          type: "POST",
          contentType: "application/json; charset=utf-8",
          url: (AFServiceUrl + voteMethod),
          data: "{'itemID': '" + itemID + "','voteType': '" + voteDirection + "'}",
          dataType: "json",
          success: function (data, textStatus) {
                               AFTopicProcessVoteResult(clickContext, data.d);
                                //alert("data : " + data.d);
                            },

          error: function (  XMLHttpRequest, textStatus, errorThrown) 
          {
            alert("error casting vote: " + errorThrown);
          }
        });    
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2013-01-03T19:45:44.230

在页面加载功能中为客户端添加下一行....

```
 base.Response.AddHeader("Access-Control-Allow-Origin", "*");
        base.Response.AddHeader("Access-Control-Allow-Methods", "GET, POST, OPTIONS");
        base.Response.AddHeader("Access-Control-Allow-Headers", "X-Requested-With");
        base.Response.AddHeader("Access-Control-Max-Age", "86400"); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:32:32.693

问题与跨站点发布有关。您可能会收到错误`"Access to restricted URI denied code: 1012"`消息，因为您要发布到另一个域中的 Web 服务。

请参阅有关[错误 1012的帖子](https://stackoverflow.com/questions/51283/access-to-restricted-uri-denied-code-1012)

# jquery - 有没有办法使用 jQuery 从变量中查询 HTML/XML 内容？

> ID：923489
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:20:10.083
> 
>         
> 
> 标签：jquery, html, variables, css-selectors

如果我在这样的变量中有 HTML 内容：

```
var data = "<div id='myid'><div id='subid'>Text</div></div>"; 
```

有没有办法使用 jQuery 和选择器来查询这个？像这样，如果它是 HTML DOM：

```
var data = $("#myid > #subid").text(); 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:21:46.243

使用 jQuery 的[上下文](http://docs.jquery.com/Core/jQuery#expressioncontext)：

```
$doc = $("<div id='myid'><div id='subid'>Text</div></div>");
var data = $("#subid", $doc).text(); 
```

您的示例是错误的，因为它试图通过类（“.subid”）而不是通过 id（“#subid”）访问元素 - 此外，如果您有元素的 ID，则没有必要执行类似“ #myid > #subid" 因为每个文档只有一个 ID（如果你做得正确的话，至少），那么 jQuery 可以只使用本机 document.getElementById() 来查找元素。我测试了上面的，它工作正常。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:24:09.123

您可以使用此选择器。

```
var data = "<div id='myid'><div id='subid'>Text</div></div>";
var subIdText = $(data).find('#subid').text(); 
```

# c# - ORM 和层

> ID：923502
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T22:24:41.260
> 
>         
> 
> 标签：c#, design-patterns, orm

很抱歉，这里到处都是这一点……但我觉得自己就像一条追着我尾巴的狗，此时我都感到困惑。

我正在尝试查看开发 3 层解决方案（IL、BL、DL）的最简洁方法，其中 DL 使用 ORM 来抽象对数据库的访问。

我所见过的任何地方，人们都使用 LinqToSQL 或 LLBLGen Pro 来生成代表 DB 表的对象，并在所有 3 层中引用这些类。似乎 40 年的编码模式被忽略了——或者发生了范式转变，我错过了关于为什么这样做完全可以的解释部分。

然而，似乎仍然有一些基础希望成为数据存储机制不可知论 - 看看 LinqToSQL 刚刚发生了什么：针对它编写了很多代码 - 只是为了让 MS 放弃它......所以我想尽我所能隔离 ORM 部分，只是不知道如何。

所以，回到绝对基础，这里是我希望以非常干净的方式组装的基本部分：

我开始的程序集：UL.dll BL.dll DL.dll

主要类：

Message 类具有公开 MessageAddress 对象的集合（称为 MessageAddresses）的属性：

```
class Message 
{
    public MessageAddress From {get;}
    public MessageAddresses To {get;}
} 
```

每层的功能：

BL 向 UI 公开一个名为 GetMessage (Guid id) 的方法，该方法返回 Message 的一个实例。

BL 反过来包裹 DL。

DL 有一个 ProviderFactory，它包装了一个 Provider 实例。DL.ProviderFactory 公开（可能......我的问题的一部分）两个静态方法，称为 GetMessage(Guid id) 和 SaveMessage(Message message) 最终目标是能够交换为 Linq2SQL 编写的提供程序一个用于 LLBLGen Pro，或者另一个不针对 ORM 工作的提供程序（例如 VistaDB）。  

设计目标：我想要层分离。我希望每一层只依赖于它下面的层，而不是它上面的层。我希望 ORM 生成的类仅在 DL 层中。我希望 UL 与 BL 共享 Message 类。

因此，这是否意味着：

a) 消息在 BL 中定义 b) DB 表的 Db/Orm/Manual 表示（“DbMessageRecord”或“MessageEntity”，或其他 ORM 调用它）在 DL 中定义。c) BL 依赖于 DL d) 在调用没有 ref 或不知道 BL 的 DL 方法之前，BL 必须将它们转换为 BL 实体（例如：DbMessageRecord）？

UL：

```
Main() 
{
    id = 1;
    Message m = BL.GetMessage(id);
    Console.Write (string.Format("{0} to {1} recipients...", m.From, m.To.Count));
} 
```

提单：

```
static class MessageService 
{ 
    public static Message GetMessage(id)
    {
        DbMessageRecord message = DLManager.GetMessage(id);
        DbMessageAddressRecord[] messageAddresses = DLManager.GetMessageAddresses(id);

        return MapMessage(message, 
    }

    protected static Message MapMessage(DbMessageRecord dbMessage. DbMessageAddressRecord[] dbAddresses)
    {
        Message m = new Message(dbMessage.From);
        foreach(DbMessageAddressRecord dbAddressRecord in dbAddresses){
        m.To.Add(new MessageAddress (dbAddressRecord.Name, dbAddressRecord.Address);
    }
} 
```

深度学习：

```
static class MessageManager 
{
    public static DbMessageRecord GetMessage(id);
    public static DbMessageAddressRecord  GetMessageAddresses(id);
} 
```

问题： a) 显然，这迟早要做很多工作。b) 更多错误 c) 速度较慢 d) 由于 BL 现在依赖于 DL，并且正在引用 DL 中的类（例如 DbMessageRecord），因此似乎由于这些是由 ORM 定义的，因此您不能删除一个 Provider 并替换它与另一个，...这使得整个练习毫无意义...不妨在整个 BL 中使用 ORM 的类。e) 或者......在 BL 和 DL 之间需要另一个组件，并且需要另一个映射以使 BL 独立于底层 DL 类。

希望我能更清楚地提出问题……但我现在真的迷路了。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:35:07.823

这有点到处都是，让我想起了我第一次涉足 orm 和 DDD。我个人使用核心域对象、消息传递对象、消息处理程序和存储库。因此，我的 UI 向处理程序发送一条消息，该处理程序又通过存储库对我的对象进行水合，并在该域对象中执行业务逻辑。我使用 NHibernate 进行数据访问，使用 FluentNHibernate 进行类型化绑定，而不是使用松散的 .hbm 配置。

所以消息传递是我的 UI 和我的处理程序之间共享的所有内容，并且所有 BL 都在域上。

我知道我可能会为我的解释敞开心扉接受惩罚，如果不清楚，我稍后会辩护。

就我个人而言，我不是代码生成对象的忠实粉丝。

我必须继续添加这个答案。尝试将您的消息传递视为一个命令，而不是代表您的数据库的数据实体。我会给你一个我的简单类的例子和一个对我来说非常有效的基础设施决策，我不能把它归功于：

```
[Serializable]
public class AddMediaCategoryRequest : IRequest<AddMediaCategoryResponse>
{
    private readonly Guid _parentCategory;
    private readonly string _label;
    private readonly string _description;

    public AddMediaCategoryRequest(Guid parentCategory, string label, string description)
    {
        _parentCategory = parentCategory;
        _description = description;
        _label = label;
    }

    public string Description
    {
        get { return _description; }
    }

    public string Label
    {
        get { return _label; }
    }

    public Guid ParentCategory
    {
        get { return _parentCategory; }
    }
}

[Serializable]
public class AddMediaCategoryResponse : Response 
{
    public Guid ID;
}

public interface IRequest<T> : IRequest where T : Response, new() {}

[Serializable]
public class Response
{
    protected bool _success;
    private string _failureMessage = "This is the default error message.  If a failure has been reported, it should have overwritten this message.";
    private Exception _exception;

    public Response()
    {
        _success = false;
    }

    public Response(bool success)
    {
        _success = success;
    }

    public Response(string failureMessage)
    {
        _failureMessage = failureMessage;
    }

    public Response(string failureMessage, Exception exception)
    {
        _failureMessage = failureMessage;
        _exception = exception;
    }

    public bool Success
    {
        get { return _success; }
    }

    public string FailureMessage
    {
        get { return _failureMessage; }
    }

    public Exception Exception
    {
        get { return _exception; }
    }

    public void Failed(string failureMessage)
    {
        _success = false;
        _failureMessage = failureMessage;
    }

    public void Failed(string failureMessage, Exception exception)
    {
        _success = false;
        _failureMessage = failureMessage;
        _exception = exception;
    }
}

public class AddMediaCategoryRequestHandler : IRequestHandler<AddMediaCategoryRequest,AddMediaCategoryResponse>
{
    private readonly IMediaCategoryRepository _mediaCategoryRepository;
    public AddMediaCategoryRequestHandler(IMediaCategoryRepository mediaCategoryRepository)
    {
        _mediaCategoryRepository = mediaCategoryRepository;
    }

    public AddMediaCategoryResponse HandleRequest(AddMediaCategoryRequest request)
    {
        MediaCategory parentCategory = null;
        MediaCategory mediaCategory = new MediaCategory(request.Description, request.Label,false);
        Guid id = _mediaCategoryRepository.Save(mediaCategory);
        if(request.ParentCategory!=Guid.Empty)
        {
            parentCategory = _mediaCategoryRepository.Get(request.ParentCategory);
            parentCategory.AddCategoryTo(mediaCategory);
        }
        AddMediaCategoryResponse response = new AddMediaCategoryResponse();
        response.ID = id;
        return response;
    }
} 
```

我知道这种情况会一直持续下去，但这个基本系统在过去一年左右的时间里对我很有帮助

您可以看到处理程序允许域对象处理特定于域的逻辑

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:32:53.947

您似乎缺少的概念是 IoC / DI（即控制反转/依赖注入）。而不是使用静态方法，你的每一层应该只依赖于下一层的*接口*，并将实际实例注入到构造函数中。您可以将您的 DL 称为存储库、提供者或其他任何东西，只要它是底层持久性机制的干净抽象即可。

至于代表实体的对象（大致映射到表），我强烈建议不要使用两组对象（一组特定于数据库，另一组不是）。只要它们是 POCO（它们不应该真正知道它们是持久化的），或者甚至是 DTO（没有任何行为的纯结构），它们就可以被所有三层引用。使它们 DTO 更适合您的 BL 概念，但是我更喜欢让我的业务逻辑分布在我的域对象中（“OOP 风格”），而不是拥有 BL 的概念（“Microsoft 风格”）。

不确定 Llblgen，但 NHibernate + 任何 IoC（如 SpringFramework.NET 或 Windsor）都提供了非常干净的模型来支持这一点。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:49:50.710

这可能是一个过于间接的答案，但去年我在 Java 世界中遇到了这类问题，发现[Martin Fowler 的企业应用程序架构模式](http://martinfowler.com/books.html)很有帮助（另请参阅他的[模式目录](http://martinfowler.com/eaaCatalog/)）。许多模式处理您正在努力解决的相同问题。它们都非常抽象，帮助我组织我的思维，以便能够在更高的层次上看到问题。

我选择了一种使用 iBatis SQL 映射器来封装我们与数据库的交互的方法。（SQL 映射器从 SQL 表驱动编程语言数据模型，而像您这样的 ORM 则相反。）SQL 映射器返回数据传输对象的列表和层次结构，每个对象代表一些查询结果的一行。查询（以及插入、更新、删除）的参数也作为 DTO 传入。BL 层在 SQL Mapper 上进行调用（运行此查询、执行此插入等）并传递 DTO。DTO 上升到表示层 (UI)，在那里它们驱动模板扩展机制，生成数据的 XHTML、XML 和 JSON 表示。所以对我们来说，唯一流入 UI 的 DL 依赖项是一组 DTO，

如果你将福勒的书与其他海报可以提供的具体帮助结合起来，你会做得很好。这是一个有很多工具和经验的领域，所以应该有很多好的前进道路。

**编辑：** @Ciel，你说得对，一个 DTO 实例只是一个 POCO（或者在我的情况下是一个 Java POJO）。Person DTO 可以有一个名为“Jim”的名字字段，依此类推。每个 DTO 基本上对应于数据库表的一行，只是一组字段，仅此而已。这意味着它没有与 DL 紧密耦合，并且非常适合传递给 UI。福勒在第 4 页谈到了这些。401（第一个剪牙的模式不错）。  

现在我没有使用 ORM，它获取您的数据对象并创建数据库。我正在使用 SQL 映射器，这只是在 SQL 中打包和执行数据库查询的一种非常有效和方便的方式。我首先设计了我的 SQL（我碰巧很了解它），然后我设计了我的 DTO，然后设置我的 iBatis 配置来说明“select * from Person where personid = #personid#”应该返回给我一个 Java 列表人员 DTO 对象。我还没有使用过 ORM（Hibernate，例如，在 Java 世界中），但是使用其中一个，您首先要创建数据模型对象，然后根据它们构建数据库。  

如果您的数据模型对象具有各种特定于 ORM 的附加组件，那么我可以理解为什么您在将它们暴露给 UI 层之前会三思而后行。但是您可以在那里创建一个仅定义 POCO get 和 set 方法的 C# 接口，并在所有非 DL API 中使用它，并创建一个包含所有 ORM 特定内容的实现类：

```
interface Person ...

class ORMPerson : Person ... 
```

然后，如果您稍后更改 ORM，则可以创建备用 POCO 实现：

```
class NewORMPerson : Person ... 
```

这只会影响您的 DL 层代码，因为您的 BL 和 UI 代码使用 Person。

@Zvolkov（下）建议将这种“编码到接口，而不是实现”的方法提升到一个新的水平，建议您可以编写应用程序，使您的所有代码都使用 Person 对象，并且您可以使用[依赖注入](http://martinfowler.com/articles/injection.html)框架动态配置您的应用程序以创建 ORMPersons 或 NewORMPersons，具体取决于您当天要使用的 ORM

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:45:41.107

尝试使用存储库模式集中所有数据访问。就您的实体而言，您可以尝试实现某种翻译层来映射您的实体，这样它就不会破坏您的应用程序。这只是暂时的，可以让你慢慢重构你的代码。

显然我不知道你的代码库的全部范围，所以考虑一下痛苦和收获。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:50:56.760

我的意见只是，YMMV。

当我搞砸任何新技术时，我认为它应该满足两个标准，否则我就是在浪费时间。（或者我理解得不够好。）

1.  它应该简化事情，或者最坏的情况使它们不再复杂。

2.  它不应增加耦合或降低内聚性。

听起来您觉得自己正朝着相反的方向前进，我知道这不是 LINQ 或 ORM 的意图。

我自己对这种新东西的价值的看法是，它可以帮助开发人员将 DL 和 BL 之间的边界移到更抽象的领域。DL 看起来不像原始表，而更像对象。而已。（无论如何，我通常会非常努力地使用更重的 SQL 和存储过程来做到这一点，但我可能对 SQL 比一般人更舒服）。但是，如果 LINQ 和 ORM 还没有帮助您解决这个问题，我会说坚持下去，但这就是隧道尽头的地方；简化，并稍微移动抽象边界。

# vbscript - 如何使用 VbScript 创建选项对话框？

> ID：923503
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T22:25:17.983
> 
>         
> 
> 标签：vbscript

我有一个为某些操作调用 vsbscript 文件的第三方应用程序。我想提出一个带有选项选择的用户提示，可以是下拉列表或复选框或类似的选项。但是，我能找到的只是输入框选项。

我认为 HTA 不是我的选择（除非有办法从 .vbs 文件中调用它们？）

我的另一个想法是某种 ActiveX 控件，但我找不到在 WindowsXP/Vista 上默认可用的内置控件。

有人对我如何做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T05:14:01.670

简单的答案是，你真的不能。Tmdean 的解决方案是我能想到的唯一方法。也就是说，您可以修饰输入框，使其看起来不那么*可怕*。试一试，我认为这不是*史诗般*的失败：

```
Dim bullet
Dim response
bullet = Chr(10) & "   " & Chr(149) & " "
Do
    response = InputBox("Please enter the number that corresponds to your selection:" & Chr(10) & bullet & "1.) Apple" & bullet & "2.) Bannana" & bullet & "3.) Pear" & Chr(10), "Select Thing")
    If response = "" Then WScript.Quit  'Detect Cancel
    If IsNumeric(response) Then Exit Do 'Detect value response.
    MsgBox "You must enter a numeric value.", 48, "Invalid Entry"
Loop
MsgBox "The user chose :" & response, 64, "Yay!" 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-06-01T17:24:38.697

如果您想为此使用 hta，可以这样做。

VBScript：

```
 Set WshShell = CreateObject("WScript.Shell")
'Run the hta.
WshShell.Run "Test.hta", 1, true
'Display the results.
MsgBox "Return Value = " & getReturn
Set WshShell = Nothing

Function getReturn
'Read the registry entry created by the hta.
On Error Resume Next
     Set WshShell = CreateObject("WScript.Shell")
    getReturn = WshShell.RegRead("HKEY_CURRENT_USER\Volatile Environment\MsgResp")
    If ERR.Number  0 Then
        'If the value does not exist return -1
         getReturn = -1
    Else
        'Otherwise return the value in the registry & delete the temperary entry.
        WshShell.RegDelete "HKEY_CURRENT_USER\Volatile Environment\MsgResp"
    End if
    Set WshShell = Nothing
End Function 
```

然后根据需要设计hta，包括以下方法

```
 'Call this when the OK button is clicked.
Sub OK_Click
    For Each objradiobutton In Opt
         If objradiobutton.Checked Then
              WriteResponse objradiobutton.Value
        End If
    Next
    window.Close
End Sub

'Call this when the Cancel button is clicked.
Sub Cancel_Click
     WriteResponse("CANCEL")
     window.Close
End Sub

'Write the response to the registry
Sub WriteResponse(strValue)
    Set WshShell = CreateObject("WScript.Shell")
    WshShell.RegWrite "HKEY_CURRENT_USER\Volatile Environment\MsgResp", strValue
     Set WshShell = Nothing
End Sub 
```

我使用一组名为“Opt”的单选按钮进行选择，但您可以使用任何您想要的控件。

因为 hta 不能返回值，所以这将创建一个临时注册表项。如果您不喜欢弄乱注册表，您也可以将结果写入临时文本文件。

这种方法很好，因为您可以以任何您喜欢的方式设计 hta，而不是使用提供的输入框并选择数字（这就是 DOS）。

如果您扩展 hta 以根据传递给它的参数创建自己，这也可能会很好，例如传递标题、要显示的消息、选项数组、一组按钮。这样，您可以在需要从用户那里获取输入的任何时候使用相同的 hta。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2012-04-24T11:50:05.563

您可以使用 DialogLib 创建带有下拉列表和复选框的表单。DialogLib 仍处于早期阶段，但已经非常有用：[http ://www.soren.schimkat.dk/Blog/?p=189](http://www.soren.schimkat.dk/Blog/?p=189)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:46:42.790

试试[WshShell.Popup](http://www.devguru.com/technologies/wsh/17415.asp)。根据您可能对您有用的数据...

否则，您可以调查 PowerShell。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T04:34:42.547

一种选择是编写 Internet Explorer 脚本。您可以使用 VBScript 启动 IE 并加载本地 HTML 文件，并将 VBScript 子附加到表单的提交按钮（或任何其他 JavaScript 事件），然后可以关闭 IE 窗口作为其执行的一部分。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T17:21:40.470

您可以从 VBScript 启动 HTA。

```
Set shell = CreateObject("WScript.Shell")
shell.Run "Test.hta" 
```

编辑

既然你完全控制了 VBScript，你能让第 3 方 VBScript 简单地调用你的 HTA 吗？您可以将 UI 和任何处理代码放在 HTA 中。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-06-04T01:40:05.117

作为@TmDean 建议的一个示例，我有时会使用此类 IE 脚本（好吧，它编写了 IE6 脚本；我还没有尝试过最近的版本。）

```
class IEDisplay
    '~ Based on original work by Tony Hinkle, tonyhinkle@yahoo.com

    private TEMPORARY_FOLDER

    private objShell
    private objIE
    private objFSO
    private objFolder
    private strName
    private streamOut
    private objDIV

    private numHeight
    private numWidth
    private numTop
    private numLeft

    private sub Class_Initialize()
    Dim strComputer
    Dim objWMIService
    Dim colItems
    Dim objItem
    Dim arrMonitors( 10, 1 )
    Dim numMonitorCount

    Set objShell = WScript.CreateObject("WScript.Shell")
    Set objIE = CreateObject("InternetExplorer.Application")

    strComputer = "."
    Set objWMIService = GetObject( "winmgmts:\\" & strComputer & "\root\cimv2")
    Set colItems = objWMIService.ExecQuery( "Select  * from Win32_DesktopMonitor")

    numMonitorCount = 0 
    For Each objItem in colItems
        arrMonitors( numMonitorCount, 0 ) = objItem.ScreenHeight
        arrMonitors( numMonitorCount, 1 ) = objItem.ScreenWidth
        numMonitorCount = numMonitorCount + 1
    Next

    numHeight = arrMonitors( 0, 0 )
    numWidth = arrMonitors( 0, 1 )

    Set objFSO = CreateObject("Scripting.FileSystemObject")
    TEMPORARY_FOLDER = 2
    set objFolder = objFSO.GetSpecialFolder( TEMPORARY_FOLDER )
    strName = objFSO.BuildPath( objFolder, objFSO.GetTempName ) & ".html"
    WriteFileU strName, Join( Array( "<HTML><HEAD><TITLE>Information</TITLE></HEAD>", _
                     "<BODY SCROLL='NO'><CENTER><FONT FACE='arial black'> <HR COLOR='BLACK'>", _
                     "<DIV id='MakeMeAnObject'></DIV>", _
                     "<HR COLOR='BLACK'></FONT></CENTER></BODY></HTML>" ), vbCRLF ), WF_CREATE        
    numTop = 0
    numLeft = 0
    end sub

    Sub Init( strPosition )
    'NW, N, NE, W, CENTRE, E, SW, S, SE
    Select Case strPosition
    Case "NW"
        numTop = 0
        numLeft = 0
    Case "N"
        numTop = 0
        numLeft = ( numWidth / 2 ) - 250
    Case "NE"
        numTop = 0
        numLeft = numWidth - 500
    Case "W"
        numTop = ( numHeight / 2 ) - 55
        numLeft = 0
    Case "CENTRE"
        numTop = ( numHeight / 2 ) - 55
        numLeft = ( numWidth / 2 ) - 250
    Case "E"
        numTop = ( numHeight / 2 ) - 55
        numLeft = numWidth - 500
    Case "SW"
        numTop = numHeight - 110
        numLeft = 0
    Case "S"
        numTop = numHeight - 110
        numLeft = ( numWidth / 2 ) - 250
    Case "SE"
        numTop = numHeight - 110
        numLeft = numWidth - 500
    Case Else
        numTop = 0
        numLeft = 0
    End Select

    SetupIE( strName )
    Set objDIV = objIE.Document.All("MakeMeAnObject")
    end sub

    private sub Class_Terminate()
    'Close IE and delete the file
    objIE.Quit
    '~ optionally you may want to get rid of the temp file
    end sub

    public sub Display( strMsg, numMillisec )
    objDIV.InnerHTML = strMsg
    WScript.Sleep numMillisec
    end sub

    Private Sub SetupIE(File2Load)
     objIE.Navigate File2Load
     objIE.ToolBar = False
     objIE.StatusBar = False
     objIE.Resizable = False

     Do
     Loop While objIE.Busy

     objIE.Width = 500
     objIE.Height = 110
     objIE.Left = numLeft
     objIE.Top = numTop
     objIE.Visible = True
     objShell.AppActivate("Microsoft Internet Explorer")
    End Sub

end class 
```

这是缺少的（来自原始帖子）WriteFileU 函数

```
Const WF_APPEND = 1
Const WF_CREATE = 2

Const WF_FOR_APPENDING = 8
Const WF_FOR_WRITING = 2
Const WF_CREATE_NONEXISTING = True

Const CONST_READ = 1, CONST_WRITE = 2, CONST_APPEND = 8

Const AS_SYSTEMDEFAULT = -2, AS_UNICODE = -1, AS_ASCII = 0

Sub WriteFileU( sFilename, sContents, nMode )
  Dim oStream
  If nMode = WF_APPEND Then
    Set oStream = oFSO.OpenTextFile( sFilename, WF_FOR_APPENDING, WF_CREATE_NONEXISTING, AS_UNICODE )
  ElseIf nMode = WF_CREATE Then
    Set oStream = oFSO.OpenTextFile( sFilename, WF_FOR_WRITING, WF_CREATE_NONEXISTING, AS_UNICODE )
  Else
    STOP
  End If

  oStream.Write sContents
  oStream.Close
  Set oStream = Nothing
End Sub 
```

然后作为它的使用示例

```
set i = new IEDisplay 
a = array("NW", "N", "NE", "W", "CENTRE", "E", "SW","S","SE")
for each aa in a
    i.init aa
    i.display "Here in " & aa & " of screen", 1000
next 
```

现在这不是立即有用（特别是那里有一堆对我自己的实用程序例程的调用），但它提供了一个框架。通过修改存储的 HTML，您可以添加对列表框等的支持。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2020-04-22T19:06:58.327

我知道这已经晚了 11 年，但听起来这更符合原始请求的要求：

```
Sub CustomMsgBox(msg)
Dim ie, Style, FormExit
    Set ie = CreateObject("InternetExplorer.Application")
    ie.Navigate "about:blank"

    While ie.ReadyState <> 4: WScript.Sleep 100: Wend

    ie.Toolbar = False
    ie.StatusBar = False
    ie.Width = 450
    ie.Height = 275

    ie.document.body.innerHTML = "<title>Choose a Color</title><p class='msg'>Choose an option:</p>" & "<input type='radio' id='myRadio' name='colors' value='red'>Red</br><input type='radio' id='myRadio' name='colors' value='yellow'>Yellow</br><input type='radio' id='myRadio' name='colors' value='blue'>Blue"

    Set Style = ie.document.CreateStyleSheet
    Style.AddRule "p.msg", "font-family:calibri;font-weight:bold;"

    ie.Visible = True
    ie.Quit
End Sub 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2020-10-11T05:08:15.693

此代码在 HTA 文件中为我工作（我使用 WScript.Shell Run 从 VBS 打开）。诀窍是将数据返回到 VBS，这是我通过让 HTA 创建 VBS 读取的 XML 文件来完成的。

```
Sub CopySelect(sSrcId, sTargetId)
    Dim oTarget: Set oTarget = document.getElementById(sTargetId)
    Dim oSrc: Set oSrc = document.getElementById(sSrcId)
    Dim j, n, o

    oTarget.length = 0

    For j = 0 to oSrc.length - 1
        Set o = oSrc.options(j)
        Set n = document.createElement("option")
        n.text = o.text
        n.value = o.value
        oTarget.add n
    Next
End Sub 
```

# youtube - youtube 提要的预期延迟？

> ID：923513
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T22:27:44.687
> 
>         
> 
> 标签：youtube, youtube-api

我们从之前开发的内部视频系统切换到 YouTube，现在我已经开始为用户提供公共上传源。当我们第一次从主要用户的帐户中获得大约 150 个视频中的大约十几个时，问题就出现了。随着时间的推移，这个数字上升到大约 50 个，并且一直保持在那里。我在 YouTube API 论坛上发现了一篇关于延迟的帖子，但没有关于我能期待多长时间的消息。

有人有这方面的经验告诉我会发生什么吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-03T04:45:38.417

预期的延迟可能会有所不同，并在此处记录 ( [http://code.google.com/apis/youtube/2.0/reference.html](http://code.google.com/apis/youtube/2.0/reference.html) ) - 可以将其最小化的方法：

1) 将视频上传为公开。如果您先将视频作为私有视频上传，这将使视频无法快速编入索引

2) 向用户提要发出经过身份验证的请求，这将保证 API 拥有的最新数据。IE。[http://gdata.youtube.com/api/feeds/users/username/uploads](http://gdata.youtube.com/api/feeds/users/username/uploads)（带有“用户名”的开发密钥和身份验证令牌）而不是[http://gdata.youtube.com/api/feeds/videos？作者=用户名](http://gdata.youtube.com/api/feeds/videos?author=username)

# asp.net - 在 Visual Studio 中将网站项目与 Web 应用程序项目结合起来有哪些陷阱？

> ID：923525
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T22:30:09.237
> 
>         
> 
> 标签：asp.net, visual-studio, web-application-project

我有一个包含很多文件的网站项目，构建起来真的很慢。我要做的是创建一个 Web 应用程序项目，并在**资源管理器**中将所有文件添加到其中，包括 Bin 文件夹。在 Visual Studio 中，我不会添加这些文件（显示所有文件将显示它们），只会在我要处理的一个新文件夹中添加新文件。

我需要在 Web 应用程序项目中引用原始 Bin 文件夹中的几个程序集。另外，我将包含原始的 web.config 文件。

那么几天后我会怎么后悔呢？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:33:11.883

使用 Visual Studio 发布功能时，您不会支持所有旧的东西（我假设您无论如何都不会支持）。

我还假设您无法从新的 Web 应用程序项目中访问 App_Code 中的内容。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-30T23:05:28.503

我会自己添加一个答案。

Visual Studio 中的重建将清除 bin 文件夹...

# objective-c - 如何以编程方式触发由选择器描述的方法？

> ID：923528
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-28T22:31:09.313
> 
>         
> 
> 标签：objective-c

示例：我有一个像这样的选择器，我将它作为参数提供给另一个方法：

```
SEL mySelector = @selector(doSomething:); 
```

我想现在在该方法中调用该 doSomething 方法。

背景：我有一个执行一些核心动画动作的方法。它已经使用了 didStopSelector，当一切都完成时，它会调用一个特殊的内存管理方法。但是，我希望能够调用一个不带特殊参数的简单方法，然后再做一些事情。但是那个方法不应该负责调用内存管理方法，所以我需要触发一个我存储在 ivar 中的选择器，例如。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-28T22:34:03.830

```
[receivingObject performSelector:mySelector withObject:someParam]; 
```

`withObject`如果您的选择器不带任何参数，则有一个版本。请参阅 NSObject 的[文档](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSObject_Protocol/Reference/NSObject.html#//apple_ref/occ/intfm/NSObject/performSelector:)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:37:47.987

您可以调用`NSObject`'s`performSelector`方法：

```
- (id)performSelector:(SEL)aSelector withObject:(id)object;
- (id)performSelector:(SEL)aSelector withObject:(id)object1 withObject:(id)object2; 
```

# iphone - 如何让一段代码在单独的线程中运行？

> ID：923548
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-05-28T22:35:18.757
> 
>         
> 
> 标签：iphone, objective-c, multithreading, cocoa

我有几个这样的方法调用：

```
[self myFoo];
[self heavyStuff]; // this one in other thread
[self myBar]; 
```

我必须查看哪些类/方法？当我搜索“线程”时，会出现很多类、方法和函数。哪个最适合这里？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-05-28T22:38:38.440

你会做

```
[self performSelectorInBackground:@selector(heavyStuff) withObject:nil]; 
```

请参阅Apple 网站上的 NSObject[参考。](http://developer.apple.com/DOCUMENTATION/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html#//apple_ref/occ/instm/NSObject/performSelectorInBackground:withObject:)

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-05-28T23:08:33.480

对于“一劳永逸”，请尝试`[self performSelectorInBackground:@selector(heavyStuff) withObject:nil]`. 如果你有不止一个这样的操作，你可能想检查一下`NSOperation`它的子类`NSInvocationOperation`。`NSOperationQueue`托管线程池，并发执行操作的数量，并包括通知或阻塞方法来告诉您所有操作何时完成：

```
[self myFoo];

NSOperationQueue *operationQueue = [[NSOperationQueue alloc] init];
NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self                                                                                                                                   selector:@selector(heavyStuff) object:nil];

[operationQueue addOperation:operation];
[operation release];

[self myBar];

...

[operationQueue waitUntilAllOperationsAreFinished]; //if you need to block until operations are finished 
```

在较低级别，您可以使用 use `-[NSThread detachNewThreadSelector:@selector(heavyStuff) toTarget:self withObject:nil]`。

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2009-12-23T18:37:21.290

如果您只针对 Snow Leopard，您可以使用 Grand Central Dispatch：

```
 [self myFoo];
 dispatch_async(dispatch_get_global_queue(0, 0), ^{
     [self heavyStuff];
     dispatch_async(dispatch_get_main_queue(), ^{
       [self myBar];
     });
 }); 
```

但它不会在早期的系统（或 iPhone）上运行，而且可能有点矫枉过正。

**编辑**：它适用于 iOS 4.x 以来的 iPhone。

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-05-28T23:49:19.327

您在这里有很多很好的指导，但不要忘记花一些时间[阅读 Threading Programming Guide](http://developer.apple.com/documentation/Cocoa/Conceptual/Multithreading/Introduction/Introduction.html)。它不仅提供了很好的技术指导，还提供了并发处理的良好设计，以及如何更好地使用带线程和代替线程的运行循环。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T23:06:00.567

你可以使用 NSOperationQueue 和 NSInvocationOperation：

```
[self myFoo];

NSOperationQueue *operationQueue = [[NSOperationQueue alloc] init];
NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self                                                                   selector:@selector(heavyStuff) object:nil];
[operationQueue addOperation:operation];

[self myBar]; 
```

# python - python - 匹配数组返回值

> ID：923553
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T22:37:42.917
> 
>         
> 
> 标签：python, list

我想做一个类似模式匹配的函数来获取前两个元素，然后是数组返回值的其余部分。

例如，假设 perms(x) 返回一个值列表，我想这样做：

```
seq=perms(x)
a = seq[0]
b = seq[1]
rest = seq[2:] 
```

当然我可以缩短为：

```
[a,b] = seq[0:2]
rest  = seq[2:] 
```

我可以使用一些符号来做到这一点吗？

```
[a,b,more] = perms(x) 
```

或概念上：

```
[a,b,more..] = perms(x) 
```

PROLOG 和函数式语言确实像这样很好地进行列表分解！

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-28T22:41:11.477

你可以在 Python 3 中这样做：

```
(a, b, *rest) = seq 
```

有关更多详细信息，请参阅[扩展的可迭代解包 PEP](http://www.python.org/dev/peps/pep-3132/)。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T22:44:22.623

在 python 2 中，您的问题已经非常接近答案：

```
a, b, more = (seq[0], seq[1], seq[2:]) 
```

或者：

```
(a, b), more = (seq[0:2], seq[2:]) 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:43:54.420

对于 Python 2，我知道你可以用一个函数来做到这一点：

```
>>> def getValues(a, b, *more):
    return a, b, more

>>> seq = [1,2,3,4,5]
>>> a, b, more = getValues(*seq)
>>> a
1
>>> b
2
>>> more
(3, 4, 5) 
```

但不确定是否有任何方法可以像[Ayman 的 Python 3 建议那样做](https://stackoverflow.com/questions/923553/python-match-on-array-return-value/923562#923562)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-06-10T12:59:16.940

非常好，谢谢。

在战斗方面剖析数组的建议对我来说效果不佳，因为我实际上想对生成器表达式的返回进行模式匹配。

对于 perms(seq) 中的 (a, b, more): ...

我喜欢P3的方案，但要等Komodo支持！

# sql-server-2005 - SQL Server 2005 存储过程中的文本搜索

> ID：923555
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-28T22:38:04.463
> 
>         
> 
> 标签：sql-server-2005, stored-procedures

如何找到包含特定文本的存储过程？虽然我知道进行这种搜索的最佳位置是通过您的源代码控制工具，但是有没有办法在数据库中做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-05-28T22:41:26.873

```
SELECT ROUTINE_NAME, ROUTINE_DEFINITION 
    FROM INFORMATION_SCHEMA.ROUTINES 
    WHERE ROUTINE_DEFINITION LIKE '%your text here%' 
    AND ROUTINE_TYPE='PROCEDURE' 
```

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2012-07-18T05:15:13.640

```
SELECT DISTINCT o.name AS Object_Name,o.type_desc
FROM sys.sql_modules        m 
INNER JOIN sys.objects  o 
    ON m.object_id=o.object_id
WHERE m.definition Like '%Serach_Text%' 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:41:43.097

您可以搜索[sys.sql_modules](http://msdn.microsoft.com/en-us/library/ms175081.aspx)。定义包含程序的文本。该视图包含过程、视图、udfs 等。要限制自己使用存储过程，您应该在 object_id 上加入[sys.procedure](http://msdn.microsoft.com/en-us/library/ms188737.aspx)。

# javascript - 如何使用 YUI 按名称定位输入并在之后插入内容

> ID：923561
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T22:41:03.410
> 
>         
> 
> 标签：javascript, yui, append, element

如何使用 YUI 按名称定位文本输入并在其后插入 div？

例如，这不起作用：

```
<input name="some_name" type="text">

<script>
var el = new YAHOO.util.Element(document.createElement('div'));
var some_element = document.getElementsByName('some_name');

// doesn't work .... replacing 'some_element' with 'document.body' works
el.appendTo(some_element);

</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T07:45:18.523

如前所述， document.getElementsByName 返回一个数组。您可能希望为您的输入提供一个与 name 属性同名的 ID。（旁白：这对于表单来说是常见且良好的做法。当您这样做时，其他 js 库会提供有用的扩展。）

```
<input name="some_name" id="some_name" type="text">
<script>
(function () {
var el = new YAHOO.util.Element(document.createElement('div'));
// var some_element = document.getElementByName('some_name')[0];
var some_element = document.getElementsById('some_name'); // preferred, faster
// el.appendTo(some_element);
YAHOO.util.Dom.insertAfter(el,some_element);
})();
</script> 
```

还要注意使用**insertAfter 而不是 appendTo**。您不希望 el 成为输入元素的子元素。你希望它成为下一个兄弟姐妹。输入没有子级。最后，您将这些变量添加到全局命名空间。这可能是也可能不是问题，但是将代码包装在匿名函数中通常是一个好主意，除非您打算让变量具有全局范围并稍后重用它们，但是您可能希望为它们提供适当的命名空间.

希望有帮助（而不是太多的信息。）；）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T06:56:21.573

document.getElementsByName('some_name') 总是返回一个集合（一个数组），如果你确定名字是唯一的，你可以安全地写这个。

```
var some_element = document.getElementsByName('some_name')[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2015-04-01T22:46:18.377

使用 YUI 3，您现在可以这样[做](https://stackoverflow.com/a/21319966/274502)：

```
<script src="http://yui.yahooapis.com/3.18.1/build/yui/yui-min.js"></script>

<input id="some_id" type="text">

<script>
  YUI().use('node', function(Y) {
    var contentNode = Y.Node.create('<p>');
    contentNode.setHTML('This is a para created by YUI...');
    Y.one('#some_id').insert(contentNode, 'after');
  });
</script>
```

但请记住，[YUI 已停产](http://yahooeng.tumblr.com/post/96098168666/important-announcement-regarding-yui)！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2015-09-04T04:54:21.377

您基本上设置了一个条件并说 name="some_name"。

请参阅下面的代码并观察它仍然插入

段落。

```
<script src="http://yui.yahooapis.com/3.18.1/build/yui/yui-min.js"></script>

<input id="some_id" type="text" name="inpuname" >

<script>
  YUI().use('node', function(Y) {
    var contentNode = Y.Node.create('<p>');
    contentNode.setHTML('Paragraph created by YUI by searching for *INPUNAME*...');
    Y.one('input[name="inpuname"]').insert(contentNode, 'after');
  });
</script>
```

# php - 表单_POST数组问题

> ID：923563
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:41:19.447
> 
>         
> 
> 标签：php

我有以下代码：

```
if ( (isset($_GET['slAction'])) && ($_GET['slAction'] == "manage_label") )
{    
  $formData = getFormData();
  foreach ($formData as $key => $value)
    echo "(Key: $key, Value: $value )<br /> ";

}

// All form fields are identified by '[id]_[name]', where 'id' is the 
// identifier of the form type. Eg. label, store etc.
// The field identifier we want to return is just the name and not the id.  
  function getFormData()
  {
    $form_fields = array_keys($_POST); 

    for ($i = 0; $i < sizeof($form_fields); $i++) 
    {
      $thisField = $form_fields[$i];
      $thisValue = $_POST[$thisField];

      //If field is an array, put all it's values into one string 
      if (is_array($thisValue))
      {
        for ($j = 0; $j < sizeof($thisValue); $j++)
        {
          $str .= "$thisValue[$j],";
        }

        // Remove the extra ',' at the end
        $thisValue =  substr($str, 0, -1);

       //Assosiative array $variable[key] = value
       $formData[end(explode("_", $thisField))] = $thisValue;
      }
      else 
        $formData[end(explode("_", $thisField))] = $thisValue;      
    } 
    return $formData;
  } 
```

**这段代码的输出是：**

```
(Key: id, Value: 7276 )
(Key: name, Value: 911 Main brand )
(Key: email, Value: )
(Key: www, Value: )
(Key: categories, Value: Menswear,Womenswear,Shoes )
(Key: targetgroup, Value: )
(Key: keywords, Value: )
(Key: description, Value: Testing )
(Key: saveForm, Value: Save ) 
```

现在这是**我的问题**。名为“label_categories”的表单字段是复选框，并作为数组返回。如您所见，输出是“Menswear,Womenswear,Shoes”。如果我尝试'echo $formData['name']'，输出是“911 Main brand”。如果我尝试 'echo $formData['categories']. 输出为空白/空。

为什么我可以输出字符串'name'而不是字符串'categories'？在 getFormData() 函数中，我将数组转换为字符串......

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:54:30.967

该代码可以**大大**简化：

```
// 1\. no need for isset() check in the case where you're testing a value
// 2\. use single quotes for strings where possible
if ($_GET['slAction'] == 'manage_label') {    
  $formData = getFormData();
  // 3\. Good rule is to use braces even when not necessary
  foreach ($formData as $key => $value) {
    echo "(Key: $key, Value: $value )<br /> ";
  }
}

function getFormData() {
  // 4\. prefer explicit initialization
  $formData = array();
  // 5\. this foreach is much cleaner than a loop over keys
  foreach ($_POST as $k => $v) {
    // 6\. this is a lot cleaner than end(explode(...))
    $name = preg_replace('!.*_!', '', $k);
    if (is_array($v)) {
      // 7\. this implode() replaces 5 lines of code
      // and is MUCH clearer to read
      $formData[$name] = implode(',', $v);
    } else {
      $formData[$name] = $v;
    }
  }
  return $formData;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:15:41.360

而不是发布代码，请解释一下。

您不能回显 $_post['catagories'] 因为它不是字符串或数字。它是一个数组。

你可以 echo $_post['catagories'][nth number'] 或 echo implode(', ' $_post['catagories'])

# java - JAX-RS 非常适合实现 REST。你用什么来调用 Java 中的 REST 服务？

> ID：923566
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-28T22:41:45.953
> 
>         
> 
> 标签：java, rest, client, jax-rs

理想情况下，我正在寻找类似 JAX-RS 的东西（使用注释来描述我想要调用的服务），但允许调用使用其他技术（不是 JAX-RS）实现的 REST 服务。有什么建议吗？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-05-31T10:44:01.647

JAX-RS (JSR311) 没有定义客户端 API，但大多数 JAX-RS 实现都有一个，例如[Jersey](https://jersey.dev.java.net/nonav/apidocs/1.0.3/jersey/com/sun/jersey/api/client/package-summary.html)、[RESTeasy](http://www.jboss.org/file-access/default/members/resteasy/freezone/docs/1.0.2.GA/javadocs/org/jboss/resteasy/client/package-summary.html)或[Apache CXF](http://cxf.apache.org/javadoc/latest/org/apache/cxf/jaxrs/client/package-summary.html)。Restlet 框架还具有[客户端支持](http://www.restlet.org/documentation/1.1/api/org/restlet/Client.html)以及单独的[HTTP 客户端扩展](http://wiki.restlet.org/books/documentation_book_definition--20081027-003425/publications/html-chunked/output/dsy75-restlet.html#dsy75-restlet)。

由于这些是 REST 的专用库/框架，我建议您查看这些。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-06-02T01:39:56.167

您在评论中写道，您“希望获得比 HttpClient 更高级别的东西”。听起来[Restlet](http://restlet.org)会很完美。*它为实现和使用*RESTful Web 应用程序提供了一个高级 API，并为低级实现提供了即插即用适配器。

例如，要使用 Restlet 1.1 将 webform 发布到资源：

```
Client client = new Client(Protocol.HTTP);

Form form = new Form();
form.add("foo", "bar");
form.add("abc", "123");

Response response = client.post("http://host/path/to/resource", form.getWebRepresentation())

if (response.getStatus().isError()) {
    // deal with the error
    return;
}

if (response.isEntityAvailable()) {
    System.out.println(response.getEntity().getText());
} 
```

如果您需要在请求上设置更多选项，可以使用 Request 对象：

```
Form form = new Form();
form.add("foo", "bar");
form.add("abc", "123");

Request request = new Request(Method.POST, "http://host/path/to/resource");

request.setEntity(form.getWebRepresentation());

request.setReferrerRef("http://host/path/to/referrer");

Response response = client.handle(request); 
```

！

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:57:28.637

我建议你看看[WADL 项目](https://wadl.dev.java.net/)。WADL 之于 REST 就像[WSDL](http://www.w3.org/TR/wsdl)之于 SOAP。

您首先需要使用 WADL 定义 REST 接口。然后，您可以在其上运行 wadl2java 工具来为 REST 调用生成客户端存根。

一旦你有了 Web 服务的 WADL，你就可以实现一些工具来做其他事情，例如生成服务器端存根、生成文档等。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:45:09.690

*大部分来自 apache 的*HttpClient （参见*[http://hc.apache.org/httpcomponents-client-ga/](http://hc.apache.org/httpcomponents-client-ga/)）。*

 ** * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-06-24T13:43:41.667

正如 Gandalf 和 Darrel Miller 所说，HttpClient。

您不需要从 HTTP 参数构造 XML。XML 应该只是两个独立系统之间的接口。使用 HttpClient 可以让您使用 Java 中的 String 值，无需再从那里返回 XML。

如果此时您要返回 XML 以发送到另一个系统，您应该考虑在与另一个系统通信之前将值从 HTTP 参数移回您的域/应用程序逻辑。这对于保持应用程序逻辑与系统间通信的适当分离是必要的。

# visual-studio-2008 - 如何在 Visual Studio 2008 中为我的自定义用户控件提供设计时支持？

> ID：923570
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-28T22:43:26.493
> 
>         
> 
> 标签：visual-studio-2008, compact-framework, user-controls

我正在为 .NET Compact Framework 创建自定义用户控件，我希望保留设计时支持。

我想在 Visual Studio 2008 中认为这不再是曾经疯狂的几乎不可能完成的任务。

我希望有一个简单的教程可以告诉我，这很简单。

任何机会？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:09:54.193

您可以[在此处](http://msdn.microsoft.com/en-us/library/ms180794(VS.80).aspx)下载一个示例，该示例展示了如何整合 WYSIWYG 设计时体验。

[这里](http://msdn.microsoft.com/en-us/library/aa478960.aspx)还有另一个教程。查看“设计器”部分。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T18:13:37.910

[使用 Visual Studio 2005 创建和迁移智能设备自定义控件](http://msdn.microsoft.com/en-us/library/aa446500.aspx)

我更喜欢这个，看起来 VS 2008 的工作方式与 VS 2005 相同。页面底部也有下载。

# javascript - 通过变量动态实例化一个类

> ID：923575
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T22:45:08.177
> 
>         
> 
> 标签：javascript, mootools

如何通过输入变量名来实例化一个类？在一个类中考虑这个方法：

```
animate: function(el, build) { 
        console.log(build.effect); 
        var animationClass = new build.effect(el,build); 
}, 
```

Build 是一个包含很多东西的对象，但最重要的是一个“效果”。这个效果是一个独立动画类的名字——一个叫做“MarioKartMenu”。

console.log(build.effect) 打印出“MarioKartMenu”。但我当然得到： TypeError: Result of expression 'build.effect' [MarioKartMenu] is not a constructor。

如果我破坏活力并像这样编写代码：

```
animate: function(el, build) {
        var animationClass = new MarioKartMenu(el,build);
    }, 
```

它工作得很好。是否有可能像我试图做的那样让它充满活力？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T22:51:40.720

如果函数`MarioKartMenu`是在全局范围内定义的，您可以使用它的字符串名称访问它：

```
window["MarioKartMenu"] 
```

这是有效的，因为所有全局变量都是`window`对象的属性。

鉴于上述情况，您可以使用以下方法实现您想要的：

```
var menuConstructor = window[build.effect];
var animationClass = new menuConstructor(el, build); 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:55:19.093

只需将构造函数分配给`build.effect`（不是包含其名称的字符串），它应该可以工作：

```
animate = function(el, build) {
    var animationClass = new build.effect(el,build);
}
// ...

b = ...;
b.effect = MarioKartMenu;
animate(e, b); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:54:13.837

我的第一个想法是使用 JavaScript 的`eval()`运算符，尽管我知道这是一个不太优雅的解决方案。（像这样的事情：`var animationClass = eval("new "+build.effect+"(el, build)");`虽然我不确定这是正确的，因为我以前没有`eval()`这样使用过。）。艾曼的回答是对这个想法的一个更好的变体。

我的第二个想法是这`MarioKartMenu`不是适当的抽象。所以我会围绕它构建一个简单的类，它将效果名称作为第三个参数，并使用一条`switch()`语句在所有可用效果中进行选择，实例化正确的效果并返回它。

# javascript - 多行文本到剪贴板

> ID：923581
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T22:47:37.220
> 
>         
> 
> 标签：javascript, clipboard

有没有办法使用 javascript 将**多行**文本发送到剪贴板？

IE，我想发送：

```
abc
def
ghi 
```

并不是

```
abcdefghi 
```

*（虽然现在我需要学习如何用 Javascript 来做，但我不介意听听它是如何用其他语言完成的，比如 python）*

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T22:57:48.727

你试过'abc\r\ndef\r\nghi\r\n'

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:25:12.993

正如 Russ 建议的那样，将其作为一个带有回车符和换行符的字符串发送。

您回复 Russ 说“它不起作用”：它不起作用的症状是什么？

如果您从剪贴板复制到 HTML，请注意，当您将其插入 DOM 时，HTML DOM 不一定会保留空格（尤其是包括回车和换行字符）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:00:18.940

我还没有测试过，但是看看一些 jQuery 插件。
[http://plugins.jquery.com/taxonomy/term/657](http://plugins.jquery.com/taxonomy/term/657)

# spring - ibatis中如何传递全局属性

> ID：923585
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T22:48:05.877
> 
>         
> 
> 标签：spring

我正在为数据库交互层使用 ibatis 开发一个 Spring MVC 应用程序。我希望能够通过我的类路径中的属性文件（或通过 spring xml 配置）设置数据库的名称，这样我就可以为某个应用程序动态更改数据库，并且可以通过设置参数来更改并重新部署应用程序。

我正在寻找的是能够在现有数据库上设置数据库名称。假设我有一个名为 DB1 的系统，其中包含以下数据库：user、user_qa 和 user_dev。我希望能够参数化 SQL，而不是这样做：

```
SELECT * FROM user.Logins 
```

我会做

```
SELECT * FROM $database.user$.Logins 
```

因此，我可以更改 database.user 属性并重新部署应用程序，而不是每次更改数据库名称时都重写大量 SQL 语句。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:42:35.410

春天做起来很简单。假设你有一个基本的 conf 文件 [database.properties]：

```
jdbc.username = user
jdbc.host = mydbserver.com 
```

然后在您的 Spring config xml 文件中：

```
<bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
<property name="location">
<value>classpath:database.properties</value>
</property>
</bean> 
```

现在，您希望这些变量替换配置文件中的名称：

```
<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
<property name="host"><value>${jdbc.host}</value></property>
<property name="username"><value>${jdbc.username}</value></property>
</bean> 
```

# python - Windows中的Python环境变量？

> ID：923586
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:48:17.703
> 
>         
> 
> 标签：python, windows, testing, environment-variables

我正在开发一个脚本，该脚本一遍又一遍地运行带有其他脚本的程序以进行测试。

它目前的工作方式是我启动了一个 Python 脚本。该脚本调用程序并加载其他脚本。它会在 60 秒后终止程序，以便使用下一个脚本再次启动程序。

对于某些脚本，60 秒太长了，所以我想知道是否可以设置一个 FLAG 变量（不在主脚本中），这样当脚本完成时，它会设置 FLAG，所以主脚本并读取 FLAG 和杀死进程？

感谢您的帮助，我的写作可能令人困惑，所以如果您不能完全理解，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:55:33.400

当 script1.py 退出时，您可以使用[atexit](http://docs.python.org/library/atexit.html)编写一个小文件 (flag.txt)。mainscript.py 可以定期检查 flag.txt 的存在，当它找到它时，会杀死 program.exe 并退出。

编辑：我已经使用[this](http://code.activestate.com/recipes/416087/)设置了持久环境变量，但我只将它用于基于 python 的安装脚本。通常我对弄乱注册表很害羞。（这是用于 Windows 的顺便说一句）

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:54:30.103

这似乎是套接字的完美用例，尤其是[asyncore](http://docs.python.org/library/asyncore.html)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-02-23T14:36:00.797

您不能以这种方式使用环境变量。正如您所发现的，在设置应用程序完成后它不是持久的

# json - RESTful 有那么重要吗？

> ID：923588
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T22:48:59.917
> 
>         
> 
> 标签：json, http, rest, asp.net-web-api

我正在开发一个基于 Web 的应用程序，该应用程序使用基于 HTTP 的 JSON 的 API 在服务器和客户端之间进行通信。目标是可以使用通过此 Web 服务共享的相同在线数据开发具有不同目标的多个客户端（在线 Web 客户端、离线桌面客户端或第三方创建）。

现在，客户端和服务器之间的通信仅通过运行良好的系统通过 POST 发送。我阅读了大量关于 REST 以及使用 PUT、GET、POST 和 DELETE 使用 HTTP 实现 RESTful 的信息。我可以将我的 API 分成这些不同的类别，但这意味着更多的代码和对 API 的一些更改。

我的问题是：对于基于 HTTP 的 API 而言，RESTful 有多重要？它是推荐、选择还是近乎必需？

提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-05-28T23:36:14.313

作为一个[顽固的 RESTafarian](http://www.infoq.com/articles/rest-introduction)，我想说的是充分利用 HTTP（有问题的 REST 协议）。为什么？好吧，我将向您展示我昨天与我的一位非常聪明的好朋友（曾经是 IT 教授，仍然在讲课，无论走到哪里都踢屁股）的电子邮件交流中的两个片段；

> 昨天我通过了我的 mappodrhom 应用程序的一个重要里程碑
> 
>   ：我现在可以将长时间运行的后台计算启动
> 
>   到工作池中。当他们完成时，工作人员将他们的结果直接发布到 REST 资源中。这会触发更多的后台处理，所有这些都由依赖图控制。
> 
>   
>   
> 
> 有趣的是，这种 RESTful 后台
> 
>   实际上独立于我的特定应用程序。但我
> 
>   目前太累了，无法完全掌握后果:-)

有问题的后果是巨大的（它是一个 REST 框架，有很多小堆栈、事件、服务和应用程序，都有自己的可发现 URI，都具有相同的统一接口），并且就可扩展性和可伸缩性而言，它在它的简单性。如果您的应用程序是一个永远不会去旅行或遇到辣妹的小东西，是的，也许您不需要它。但是后来，我也说了同样的话，突然发现自己在去巴黎的火车上和一个可爱的女孩，她是俄罗斯人的秘密间谍，嗯，一件事导致了另一件事……

这是我的回答，并附有我自己的一些经验；

> 我觉得这听起来（请原谅我的法语）太棒了！我在使用自己的 REST 东西时遇到了类似的事情，因为中间层非常薄且透明，我可以按照我需要的方式扩展东西，而不必过多担心基础设施。这是一种如此自由，如此酷炫的事情，我的大脑快要爆炸了，还有一种令人担忧的好奇心，为什么更多人不这样做？

简而言之，只做 REST[的一半](http://www.innoq.com/blog/st/2007/04/19/rest_is_not_crud.html)就像根本不做。你只是将你的东西转移到一个不同的管道上，错过了一个简化的 API 到一个状态机、语义和实现解耦的核心，使用构建网络的原则（因此我会说你'你背后有相当成熟的想法），统一的界面，以及将 URI 作为建模的一部分。

我知道人们常说你可以挑选，一切都只是选择。它不是。[REST 只有在充分使用它时才有意义](http://www.infoq.com/articles/tilkov-rest-doubts)，但要说服你真正扩展你的大脑并做一些聪明的事情，我只能敢于让你切开 FUD（这完全是关于 RPC，只有 GET 和 POST 是必要的，你不需要它全部，相当于 JSON、SOAP 和其他类似的等等），并且更聪明地了解你如何制作应用程序。**是的，我敢你们！**

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-05-28T23:58:35.330

除非您打算利用超媒体，否则我不会费心尝试遵守 REST 约束。超媒体是拼图的一部分，它使系统大于其部分的总和。

您可以自由选择要在架构中尊重哪些 REST 约束，只需注意，为了能够调用最终结果 RESTful，唯一可选的约束是“代码下载”。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T22:55:45.860

它是一种将 Web 应用程序公开为具有明确定义的 API 的 Web 服务的选项之一。其他选项包括：

1.  没有 API - 应用程序没有真正的方法可以用作其他分布式系统中的组件

2.  SOAP - 一种用于定义 API 远程调用的 XML 格式

3.  JSON - 一种紧凑的信息交换格式，可用于创建自定义 API 格式（或根据需要用于构建 REST 系统）

4.  许多其他形式的远程过程调用和信息交换媒介。

REST 背后有一个很好的理想，但这并不意味着您必须为您的应用程序提供 REST API。如果收益不值得付出额外的努力，请不要打扰。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T22:54:21.653

这是一个建议。我很高兴你没有进入你需要进入的 RESTful，因为有一种叫做 Hi-Rest 和 Lo-REST 的东西。您可以通过谷歌搜索获得更多信息。我认识的一些行业资深人士不太关心这一点，但我确实发现，从长远来看，与 html 和 http 保持接近会帮助您并简化许多事情。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:00:04.387

我认为拥有它是一件好事，但不是必须的。根据我的经验，添加这种架构会增加项目的范围和复杂性，但它确实为整体增添了一定程度的优雅。我想说，如果你有时间和预算来做这个项目，那就去吧，如果没有，不要担心。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-05-28T22:54:51.557

服务 API 需要考虑的许多事情之一是最终用户可以轻松地使用它们。REST 正在获得非常强大的工具存在。

到目前为止，最大的开发组是 .NET 开发组，使用 ADO.NET for services (Astoria) 使用 Linq 使用 REST 非常简单且非常优雅。

# .net - .net 中的日志记录和刷新

> ID：923589
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:49:16.077
> 
>         
> 
> 标签：.net, file-io

我有一个看起来像这样的程序：

```
public partial class It
{
    static StreamWriter logging 
       = new StreamWriter(new FileStream(@"C:\log",FileMode.Create));

    void someFn()
    {
       logging.WriteLine("foo");
       logging.Flush();

       /// killed here in debugger with Shift+F5
    }
} 
```

文件不以“ `foo`”结尾的问题似乎没有发生刷新。我在这里滥用什么吗？我需要一个“返回时文件中的位”功能，这样的事情存在吗？

理想的情况是，如果我在那一点上中断，另一个过程将无法看到最后一行的写入。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:10:08.983

我记得我也遇到过这个问题。我认为您必须刷新底层 FileStream 而不是 StreamWriter

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:08:06.680

我认为您的代码应该按您的预期工作。我想知道您是否将构建模式设置为发布和/或您在调试器中看到的源代码与实际执行的代码之间存在差异。如果项目设置为在发布模式下构建，优化器可能会移动一些代码，并且您所在的源代码行可能无法准确表示优化代码中发生的情况。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:29:24.733

请你试试这个代码，让我们知道结果：

```
class Program
{
    static void Main(string[] args)
    {
        StreamWriter foo = new StreamWriter(new FileStream(@"C:\foo.txt", FileMode.Create));
        foo.WriteLine("foo");

        StreamWriter bar = new StreamWriter(new FileStream(@"C:\bar.txt", FileMode.Create));
        bar.WriteLine("bar");
        bar.Flush();
    }
} 
```

# ldap - 在 LDAP 中表示 RBAC 参与者

> ID：923594
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-28T22:51:01.097
> 
>         
> 
> 标签：ldap, rbac

当使用 LDAP 存储实现 RBAC 模型时（我使用 Apache Directory 1.0.2 作为测试平台），一些参与者显然可以映射到特定的对象类：

*   资源 - 我没有看到一个清晰的映射。applictionEntity 似乎只是为了这个目的而切线
*   权限 - 权限可以被视为单一用途的角色；显然我没有考虑 LDAP 权限，因为它们管理对 LDAP 对象和属性的访问，而不是对资源的 RBAC 权限
*   角色 - 直接映射到 groupOfNames 或 groupOfUniqueNames，对吗？
*   用户 - 人

在过去，我看到过在目录中不以任何方式处理资源的模型，并且权限和角色被映射到 Active Directory 组。

有没有更好的方式来代表这些演员？讨论模式的良好映射和意图的文档怎么样？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2012-10-12T09:40:27.657

RBAC 不是 RBAC 不是 RBAC，纸面上的 RBAC 很难，但在现实生活中几乎不可能实现。

每个人对 RBAC 都有自己的“想法”，并且大多数人对与 RBAC 相关的每一件事都使用不同的术语。通常，从 LDAP 实现的角度来看，您很少拥有所有“部分”来在 LDAP 中正确实现。

简单来说，“零件”是：

S = 主题 = 一个人或自动代理或用户

P = 权限 = 对目标资源访问模式的批准

T = 目标资源 = 您要为其分配权限的对象

角色至少需要关联权限和用户。目标资源可能完全在 LDAP 之外。因此，它可能是 Tomcat 服务器上的应用程序，或者只是读取 LDAP 服务器中“其他”条目的权利。

因此，通常您在 LDAP 中要做的最好的事情是设置一个具有用户列表的对象，如果 LDAP 中有一些资源，请为这些目标资源分配适当的目录权限。

**然后是小问题的实现。**

我们现在需要一个策略来实现我们的角色。因此，如果没有关于如何使用它的策略，我们的角色（我们将其称为 USER-READ-ONLY）是没有用的。

在我们的例子中，我们可以说 USER-READ-ONLY 角色可以读取我们组织中的任何内容。

所以我们现在有一个政策。此策略存储在哪里？策略的数字表示存储在“策略信息点”或 PIP 中。

我们如何解释 PIP 提供的政策？策略由策略决策点 (PDP) 解释。

谁决定主题（用户）是否可以访问资源？政策执行点 (PEP)。

将所有这些策略内容放在一起，我们最终得到策略的数字表示，由策略信息点提供给策略决策点，然后将决策传递给允许或拒绝访问的策略执行点。

那么在我们的 RBAC 故事中，PIP、PDP 和 PEP 在哪里？好吧，如果目标资源在 LDAP 目录中，那么它就是 PIP 的 LDAP 目录（我们可能对其进行了硬编码并且没有抽象，PIP 和 PEP 也是如此，这很容易。

但如果是我们的 Tomcat 应用程序，它必须是 Tomcat 应用程序内的一个可以中断的方法，知道必须使用一个方法说“我有这个主题（用户）并且他想要访问这个目标资源（库存）来执行这个权限（只读）”。

当然，所有这些东西都有一些标准。（Google XAML、RFC3198、ISO10181-3、NIST）但它们是与实际实现有很大差距的标准。

**所以请记住，RBAC 的真正实现很难。** 

当然，恕我直言，我们应该了解 RBAC，研究论文并将其作为战略方向，但在广泛的供应商和应用程序基础上的实际实施，我们还没有实现。

-吉姆

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2014-02-25T23:49:29.170

查看 Fortress，它是使用 LDAP 的 ANSI RBAC (INCITS 359) 的真实开源实现。  [http://iamfortress.org/](http://iamfortress.org/)

是的，实施起来相当困难，但我们已经在这个问题上工作了 10 多年。;-)

# language-agnostic - 您使用哪些工具来分析文本？

> ID：923597
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-28T22:52:43.607
> 
>         
> 
> 标签：language-agnostic, analysis, taxonomy

我需要一些灵感。对于一个爱好项目，我正在玩内容分析。我基本上是在尝试分析输入以将其与主题图相匹配。

例如：

*   “伊拉克之路” > 历史，中东

*   “Halloumni” > 中东美食

*   “宝马” > 德国，汽车

*   “奥巴马” > 美国

*   “黑斑羚” > 美国，汽车

*   “柏林墙” > 历史，德国

*   “Bratwurst” > 食品，德国

*   “芝士汉堡” > 食品，美国

*   ...

我一直在阅读很多关于分类学的内容，最后，无论我读到什么，都得出结论，所有人的标签都不一样，因此系统必然会失败。

我考虑过标记化输入和停用词列表，但它们当然需要大量的工作来提出和构建。建立单词和主题之间的相关链接似乎很累，而且永远不会结束，因为无论你处理什么语言，它都非常丰富，而且大多数语言也严重依赖于上下文。更别说维护了。

我想我需要想出*一些*聪明的东西，并用我希望它能够猜测的主题来训练它。有点像[Eliza 机器人](http://nlp-addiction.com/eliza/)。

无论如何，我不相信有什么东西可以开箱即用，但是有没有人有任何技术线索或示例可用于分析输入以提取*含义*？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:50:52.270

喂。我首先会在[OpenCalais](http://www.opencalais.com/)中查找文本或输入中的实体。很棒，而且我自己也用过很多次（来自路透社的人）。

之后，您可以进一步分析文本，在实体和单词之间创建关联。我可能会在[WordNet](http://en.wikipedia.org/wiki/WordNet)之类的东西中查找它们并尝试对它们进行典型化，或者甚至自动生成一些与您要映射的域相匹配的本体。

至于如何将它们整合在一起，您可以做很多事情；以上，或试图弄清楚单词是什么和意思的两遍或三遍模型。或者，如果您控制输入，则制作一种更易于解析的格式，或者走[NLP 的阴暗道路](http://en.wikipedia.org/wiki/Natural_language_processing)（这很有趣）。

或者您可以使用[Jena](http://jena.sourceforge.net/)之类的工具来解析任意 RDF 片段，尽管我自己不喜欢 RDF 前提（我是主题映射器）。我写了一些东西，在 WikiPedia 中查找单词、短语或名称，并根据 WikiPedia 页面中找到的语义对它们的命中率进行评分（如果需要，我可以告诉你更多细节，但工作不是更有趣吗？走出自己，想出比我更好的东西吗？:)，即。链接的数量、SeeAlso 的数量、文本的数量、讨论页面的大小等。

这些年来，我写了很多东西（甚至用 PHP 和 Perl；看看[Robert Barta 在 CPAN 上的 Topic Maps 东西](http://search.cpan.org/~drrho/)，尤其是 TM 模块中的一些有趣的东西），从引擎到解析器，再到中间奇怪的东西。关联数组将单词和短语分开，创建累积直方图以对其组件进行排序等等。这都是有趣的东西，但至于收缩包装的工具，我不太确定。每个人的目标和需求似乎都不一样。这取决于你想变得多么复杂和复杂。

无论如何，希望这会有所帮助。干杯! :)

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T20:41:10.530

[SemanticHacker](http://www.semantichacker.com/)完全符合您的要求，开箱即用，并且具有友好的 API。它在短句上有些不准确，但对于长文本来说却是完美的。

*   “伊拉克之路” > 社会/问题/战争与冲突/具体冲突

*   “Halloumni” > 不适用

*   “BMW” > 休闲/摩托车/品牌和型号

*   “奥巴马” > 社会/政治/保守主义

*   “黑斑羚” > 娱乐/汽车/品牌和型号/雪佛兰

*   “柏林墙” > 地区/欧洲/德国/国家

*   “Bratwurst” > 家/烹饪/肉类

*   “芝士汉堡” > 主页/烹饪/食谱收藏；地区/北美/美国/马里兰/地方

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:05:35.700

听起来您正在寻找贝叶斯网络实现。你可以通过使用[Solr 之](http://lucene.apache.org/solr/)类的东西来获得。

另请查看[CI-Bayes](https://ci-bayes.dev.java.net/)。Joseph Ottinger今年早些时候在 theserverside.net 上写[了一篇关于它的文章。](http://www.theserverside.com/tt/articles/article.tss?l=UsingCI-Bayes)

# c# - 从 WinForms 应用程序中删除 ClickOnce

> ID：923607
> 
>         
> 
> 赞同：45
> 
>         
> 
> 时间：2009-05-28T22:56:03.770
> 
>         
> 
> 标签：c#, .net, winforms, clickonce

我有一个要使用 ClickOnce 的 WinForms 应用程序。但事实证明 ClickOnce 不适用于我的应用程序，所以我想删除它。只是......似乎没有明显的方法可以做到这一点。没有“Un-ClickOnce”按钮。有谁知道我需要采取哪些步骤才能让我的应用程序像 ClickOnce 集成之前一样？

（我知道我可以创建一个新项目并将东西导入其中，但必须这样做似乎很愚蠢，所以我希望有另一种方法。）

* * *

## 回答 #1

> 赞同：116
> 
>             
> 
> 时间：2011-04-27T01:05:27.123

这里的其他回答不正确或没有帮助。说它永远不需要删除是不正确的。

我最近遇到的一个这样的例子是当应用程序需要管理权限时。任何将管理要求嵌入清单的尝试都将导致应用程序甚至无法编译，而 ClickOnce 仍然存在于解决方案中。

以下两个步骤使我能够关闭 ClickOnce（在 Visual Studio 2010 中）：

在项目属性中，

1.  *签名*选项卡：取消勾选“签署 ClickOnce 清单”

2.  *安全*选项卡：取消勾选“启用 ClickOnce 安全设置”

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-06-13T19:59:19.377

我同意其他人的观点，没有必要“删除 ClickOnce”。

如果您真的要这样做，IIRC 所有 ClickOnce 设置都在项目的 .csproj 文件中，因此请删除那里与 ClickOnce 相关的所有 XML 标记。（也许最容易与尚未使用 CO 部署的新应用程序进行比较，以查看哪些标签不存在）

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2010-10-28T08:46:58.230

如果您参考 Debug 文件夹中出现的 ClickOnce 应用程序部署清单文件，请转到项目属性 -> 安全并取消选中“启用 ClickOnce 安全设置”

您也可以转到 Project Properties -> Signing 并取消选中“Sign the ClickOnce manifests”，但这不是必需的，因为如果您第一次取消选中，它没有要签名的内容。

现在如果你去调试和删除 .application 文件，在重建时，不会再出现。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:11:18.030

我相信，一旦您停止部署 ClickOnce，剩下的唯一内容就是文件`publish.xml`，该文件会告诉您到目前为止已部署的内容以及您所处的版本。否则，您实际上没有什么需要担心的，只需`bin`像没有 ClickOnce 一样从文件夹中进行部署。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2019-05-20T21:01:33.350

以防万一这对任何人都有帮助...

我的问题特别是我有一个依赖的“类库”项目，该项目已选中“签署 clickonce 清单”但已禁用，因此无法取消选中。我的解决方案是：

*   将该项目转换为 Windows 应用程序，

*   重新打开属性面板，

*   从属性面板上的签名选项卡中删除单击一次清单签名，

*   将项目转换回“类库”。   

我认为这是一个 MS 错误（仍在我现在使用的 VS2019 16.0.1 中），但解决方法修复了它。

祝你好运！

# asp.net - 缓存 ListView 数据是一个可行的选择吗？

> ID：923611
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T22:57:43.517
> 
>         
> 
> 标签：asp.net, linq, linq-to-sql, listview, caching

这是我的场景： 1) 用户运行搜索以通过 LinqDataSource 检索值以在 ListView 中显示。2) 他们单击其中一个项目，将他们带到另一个可以检查详细信息的页面，可以进行进一步的向下钻取等。 3) 用户想要返回到原始 ListView 结果以选择另一个项目进行检查。

我可以看到可以传递查询字符串参数，允许每次用户返回 ListView 时重复查询，但似乎应该有一种方法来缓存结果。

不过，由于我使用的是 LinqDataSource，我相信每次运行查询时都会获取实际结果。我目前正在向 e.Results 提供“选择新 {blah, blah}”类型的 IEnumerable，因为它填充了匿名类型，所以无法转换为 List。

简而言之：1）尝试在用户会话中放置潜在的大查询结果是否有意义？2）如果是，List是合理的数据结构吗？3) 我是否需要求助于创建一个具有正确属性的类来保存匿名数据、枚举查询返回、填充列表？4) 对于这种类型的目标，是否有比 LinqDataSource 更好的选择？5) 或者，每次他们点击 ListView 时运行查询是否更有意义？

如果这不清楚，我很抱歉。如果有人能在我把一堆空闲时间引向错误的道路之前让我直截了当，我将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:19:15.690

首先，我建议您研究一下 ASP.NET 附带的[缓存机制](http://msdn.microsoft.com/en-us/library/system.web.caching.cache.aspx)，除非数据对于某个用户是私有的。

其次，我建议您以某种方式设计您的应用程序，以便创建自然点，您可以在查询数据库之前尝试从缓存中获取数据（并将数据插入缓存，并使用过期规则），但不要开始将内容放入缓存中，直到您确认它确实会有所作为。

衡量实际花费在检索数据上的时间，并在有影响的情况下使用缓存。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-11-03T18:46:50.210

我不确定从死里复活线程在 SO 上是否很酷，但这是我找到的回答这个问题的答案：

[http://weblogs.asp.net/pwelter34/archive/2007/08.aspx](http://weblogs.asp.net/pwelter34/archive/2007/08.aspx)

# c# - .NET 电子邮件内容 - 换行符

> ID：923616
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T22:59:38.413
> 
>         
> 
> 标签：c#, .net, email, outlook

我有一个应用程序可以向用户发送格式良好的处理日志。

当我在本地运行应用程序（调试模式）时，使用 [SMTPServer] 发送，日志以整齐的格式到达并且看起来如我所料。

当我在测试服务器上安装应用程序并将其配置为使用相同的 [SMTPServer] 发送时，日志到达我的收件箱并删除了换行符。

转换为 HTML 格式现在并不是一个真正的选择。

我意识到 Outlook 会剥离它们，但我很困惑为什么它只在来自服务器时才这样做。

想法？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T00:32:03.233

我不确定这会解决它，但尝试通过使用以下任一方法添加换行符：

```
System.Environment.NewLine 
```

或简单的“\n”。不过，前者是更好的做法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:28:50.073

尝试将日志信息写入两个框上的文件，以查看输出是否存在差异。如果它们相同，则问题可能出在邮件服务器的配置中，可能与默认电子邮件编码或类似的东西有关。如果它们不同，那么您可以对服务器设置远程调试，以在构建它时检查字符串/电子邮件，看看是否可以找到变体。

我从未见过 Vista 和 2003 之间（在默认配置中）有不同的行终止符，但我同意这是值得一看的……   

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:04:21.477

引入换行符的代码是什么？如果发送邮件的代码相同，并且通过同一服务器发送并由同一客户端使用，我会调查来源；日志本身。与系统在本地运行时的样子相比，它们在服务器上生成时看起来会有所不同吗？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T14:32:41.870

在电子邮件世界中，行只能以 "\r\n" (vbCrLf) 结尾。使用 Environment.NewLine 或 "\n" 或 "\r" 是不正确的，可能会导致问题。

新行必须以“\r\n”（不带引号）的组合结尾。

我不知道这是否是这里的问题，但是，如果您使用 StringBuilder 构建电子邮件，正确的方法是：

```
sb.Append( singleLineContent);
sb.Append( "\r\n" ); 
```

# java - java 类型擦除与 Field#getGenericType 和 Method#getGenericReturnType

> ID：923624
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-05-28T23:05:20.583
> 
>         
> 
> 标签：java, generics, type-erasure

据我了解，泛型是 Java 的编译时特性，编译后的字节码中不存在参数化类型信息。我现在发现了 Field#getGenericType 和 Method#getGenericReturnType 方法，从而打破了我的世界观。请帮我把它拼凑起来。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-28T23:23:48.410

对象的只是运行时类型被删除。例如：

```
Object obj = new ArrayList<String>(); 
```

`obj.getClass()`将返回`ArrayList.class`。你甚至可以看出它`ArrayList`有一个通用参数。但是没有办法判断`obj`是创建为`ArrayList<String>`, `ArrayList<Integer>`, `ArrayList<Object>`, `ArrayList`(raw) 还是其他任何东西。

静态类型信息仍然存在于类、方法等（尽管不是本地人）。这只是作为属性附加到类文件中的额外数据位，可在运行时使用。认为它与具有运行时保留的注释非常相似。有问题吗？

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T23:09:04.837

当您在 IDE 中处理一罐已编译的字节码时，您仍然可以获得通用的自动完成功能。这就是它的实现方式。基本上你是对的：类型并没有完全删除。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T23:59:40.053

字段和方法的静态泛型类型信息必须存在于已编译的类文件中，以便当您针对它编译其他源代码时，编译器可以进行类型检查。例如，当您编写使用类型变量的代码`ArrayList<E>`并在其上调用`get()`方法时，您没有`ArrayList`该类的源代码。编译器去查看编译后的类文件，得到`get()`方法的泛型返回类型，并意识到它返回的是泛型类型`E`，因此它可以进行类型检查。因此，必须存在泛型类型信息，以便编译器可以检查它。

# visual-studio-2008 - 作为 TFS 构建的一部分运行 WatiN 测试的超时问题

> ID：923629
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T23:06:03.173
> 
>         
> 
> 标签：visual-studio-2008, unit-testing, web-applications, tfs, watin

我已经在我的开发环境上运行了一个简单的 WatiN Web 测试，并试图让它在 TFS 构建服务器上运行。仅尝试加载具有以下异常的页面时失败：WatiN.Core.Exceptions.TimeoutException：Internet Explorer 忙时超时。

我已将测试超时设置为 3 分钟，这应该足够了。

我读过这可能是由 IE 保护模式引起的，但我不确定如何为 TFSService 帐户禁用它。

我在 Windows Server 2008 上使用 Visual Studio/TFS 2008。

有没有其他人遇到这个问题并找到了解决方案？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:27:02.210

我只在 Vista 上使用过 WatiN，它有类似的超时问题。当我切换到 FireFox 进行测试时，我更开心了。

无论如何，这是一个可能的解决方案：

[http://msdn.microsoft.com/en-us/magazine/dd744751.aspx](http://msdn.microsoft.com/en-us/magazine/dd744751.aspx)

> ASP.NET 开发服务器仅侦听 IPv4 上的请求，而不是 IPv6。如果您运行的是 Windows Vista 或 Windows Server 2008，对“localhost”的请求将默认解析为 ::1 的 IPv6 地址，而不是 127.0.0.1 的 IPv4 地址，WatiN 测试将失败。要解决此问题，请在 C:\Windows\System32\drivers\etc\hosts 文件中注释掉 IPv6 localhost 地址。这是带有“::1 localhost”的行。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T16:50:01.057

我找到了解决方案——它是为管理员关闭“IE 增强安全配置”。

下一个问题是，WatiN 认为它没有在 STA 线程中运行 - 我将就此发布一个单独的问题。

# sql - 如何避免在 SQL 视图中使用 getdate()？

> ID：923630
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-28T23:06:17.773
> 
>         
> 
> 标签：sql, sql-server, database, view

我正在编写一个数据库视图来总结一堆记录，其中日期列中的值在过去 7 天内。它看起来像这样：

```
CREATE VIEW RecentRecordSum AS
SELECT      t.ID,   
            SUM(t.SomeValue) AS ValueSum
FROM        SomeTable t
WHERE       t.RecordDate >= DATEADD(d,-7,GETDATE())
GROUP BY    t.ID 
```

有没有办法在 where 子句中不直接使用 GETDATE() ？

我正在使用 SQL Server 2000 和 2005。

查看查询计划表明 getdate() 调用的成本仅为整个查询的 0.03%（这比上面的要复杂得多），所以性能不是问题，但是我喜欢我的查询是确定性的.

理想情况下，我还想将 -7 参数公开为一列，以便可以在查询视图的 where 子句中使用它。目前，我正在考虑 7、14、28 天窗口的少量视图。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-28T23:30:54.387

您提出问题的一个原因可能是通过删除数据转换来使视图更加优化。无法在视图中执行此操作，您需要将其设为存储过程并将转换为变量：

```
CREATE PROCEDURE RecentRecordSum AS

DECLARE @adate DATETIME

SELECT @adate = DATEADD(d, -7, GETDATE())

SELECT      t.ID,   
            SUM(t.SomeValue) AS ValueSum  
FROM        SomeTable t  
WHERE       t.RecordDate >= @adate  
GROUP BY    t.ID 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:50:25.143

和其他人一样，在黑暗中再次开枪……

也许您希望将其设为索引视图，而 getdate() 无法做到这一点，因为它是一个不确定的函数。我过去通过从另一个仅包含

```
select getdate() 
```

这种间接级别足以欺骗 SQL Server 2000 并允许我使用模式绑定，但我不能保证这将适用于更高版本。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:11:04.270

```
SELECT CURRENT_TIMESTAMP

SELECT {fn NOW()} 
```

* * *

我可能误解了这个问题，如果您只是想移动 GetDate() 而不是替换它，您可以在 Have 子句中进行评估，即

```
CREATE VIEW RecentRecordSum AS
SELECT      t.ID,   
            SUM(t.SomeValue) AS ValueSum
FROM        SomeTable t
GROUP BY    t.ID, t.RecordDate
HAVING      t.RecordDate >= DATEADD(d,-7,GETDATE()) 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:16:30.080

如果我正确理解了这个问题，您总是可以尝试使用包含 GETDATE() 的集合进行内部连接，如下面的查询：

```
SELECT      t.ID,   
            SUM(t.SomeValue) AS ValueSum
FROM        SomeTable t
INNER JOIN (SELECT DATEADD(d,-7,GETDATE()) AS MIN_DATE) MIN_DATE_SET
ON t.RecordDate >= MIN_DATE_SET.MIN_DATE
GROUP BY    t.ID 
```

编辑：我查看了类似场景的查询计划，它们是相同的。YMMV。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T00:08:10.490

假设您有最近一天的数据，子查询可能会起作用：

```
CREATE VIEW RecentRecordSum AS
SELECT      t.ID,   
            SUM(t.SomeValue) AS ValueSum
FROM        SomeTable t
WHERE       t.RecordDate >= DATEADD(d,-7,(Select Max(RecordDate) From SomeTable))
GROUP BY    t.ID 
```

# c++ - Win32：模态对话框不返回焦点

> ID：923631
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:06:32.220
> 
>         
> 
> 标签：c++, c, windows, winapi

我正在编写一个win32 wrapper classes，主要是为了了解更多关于win32 编程的知识。为了解决 c 样式回调的问题，以下方法使用 SetWindowLong/GetWindowLong 存储/检索指针并将其传递给实际的 winproc。

```
LRESULT CALLBACK WinClass::WindowProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    // On window creation, WindowProc receives lParam as a LPCREATESTRUCT 
    // Store *this* pointer as long in GWL_USERDATA
    if (msg == WM_NCCREATE)
        ::SetWindowLong(hwnd, GWL_USERDATA, reinterpret_cast<long>(reinterpret_cast<LPCREATESTRUCT>(lParam)->lpCreateParams));

    // Retrieve the pointer
    WinClass *wnd = reinterpret_cast<WinClass*>(::GetWindowLongPtr(hwnd, GWL_USERDATA));

    // Call the actual winproc function
    if (wnd)
        return wnd->WndProc(hwnd, msg, wParam, lParam);
    // Default to DefWindowProc message handler function
    return ::DefWindowProc(hwnd, msg, wParam, lParam);
} 
```

Winclass 是包装由 CreateWindowEx 创建的主窗口的类。相同的 WindowProc 函数是包装模式对话框的 MDlgClass 的一部分。我正在这样调用对话框

```
DialogBox(GetModuleHandle(NULL), MAKEINTRESOURCE(id), hwnd, DialogProc); 
```

如果我将 NULL 作为 hWndParent 传递，则对话框作为无模式对话框可以正常工作，但如果我将 hwnd 传递，主窗口的句柄作为 hWndParent，则对话框作为模式对话框正常工作。但是，当我关闭对话框时，它不会将控制权传递回主父窗口吗？在 Visual Studio 中调试显示它挂在 WinMain 的消息泵中。

我想过使用哈希图来映射指针，但我宁愿使用 GetWindowLong 等。这可能吗？我尝试将对话框指针存储在 DWL_USER 中，但它没有帮助。

任何帮助将不胜感激，我仍然对Win32有所了解。

编辑：我正在使用 EndDialog 销毁对话框

编辑：我将指针存储在主窗口的 GWL_USERDATA 区域中，窗口不使用它，我只在第一次创建窗口时在 WinClass::WindowProc 中修改它。如果我不实例化对话框类，我知道指针被正确访问，因为应用程序响应通过 WindowProc 和 WM_COMMAND 处理的菜单命令。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T12:35:49.093

您不能将 WindowProc 用作 DialogProc。窗口过程在不处理消息时调用 DefWindowProc，并在处理时返回有意义的结果。对话框过程在不处理消息时返回 FALSE，在处理时返回 TRUE（处理 时除外`WM_INITDIALOG`），如果它们有需要从外部窗口过程返回的有意义的结果，则将其放置在`DWL_MSGRESULT`.

当您调用模态对话框函数 DialogBox 时，它会进入一个消息泵循环 - 它会向线程中的所有窗口发送消息，以便所有窗口继续绘制和处理输入 - 当对话框关闭时（使用 EndDialog），DialogBox程序应该返回。

当制作一个类来包装对话框时，通常的方法是将“this”指针传递给 DialogBoxParam 函数之一——它可以直接从`WM_INITDIALOG`消息中提取。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:53:19.147

您正在保存指向 lpCreateParams 的指针。关联的内存块是否有可能被释放或以其他方式破坏？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-31T03:58:26.393

```
//静态方法
BOOL CALLBACK WinClass::DlgProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
  // 在 GWL_USERDATA 中存储 *this* 指针
  如果（味精 == WM_INITDIALOG）
  {
        ::SetWindowLongPtr(hwnd, DWLP_USER, reinterpret_cast(lParam));
        m_hWnd = hWnd; // 我假设你真的不想继续传递 hwnd
  }

   WinClass* wnd = reinterpret_cast(::GetWindowLongPtr(hwnd, GWL_USERDATA));
   如果 (wnd)
       返回 wnd->DlgProcImpl(umsg, wParam, lParam);
   返回错误；
}

BOOL WinClass::DlgProcImpl(UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    开关（微信）
    {
        // 你的代码在这里

            返回错误；
    }

    返回错误；
}

INT_PTR WinClass:DoModalDialog(HINSTANCE hInst, HWND hwndParent, LPCTSTR 模板)
{
    返回 ::DialogBoxParam(hInst, 模板, hwndParent, WinClass::DlgProc, this);
}

```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:26:38.437

你是怎么关窗的？你在用`DestroyWindow`吗？当子窗口处于活动状态时，父窗口将被禁用。

# php - php中数组的选择性迭代

> ID：923636
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:08:49.563
> 
>         
> 
> 标签：php, arrays, loops

有没有一种方法可以遍历数组但对每个其他元素执行操作？即，如果我有一个包含 13 个元素的数组，我该如何只对元素 2、4、6、8、10 和 12 做一些事情？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T23:11:14.020

```
foreach($array as $val) {
  if(($i++ % 2) == 0) {
    ...do stuff here...
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:10:50.247

```
for ($i=1; $i<sizeof($array); $i+=2) {
  // do stuff to $array[$i]
} 
```

您也可以将其集成到 foreach 循环中：

```
$i = 0;
foreach ($array as $v) {
  if ($i++ & 1) continue;
  // do stuff to $v
} 
```

**注意：** `$i & 1`等价于`($i % 2) == 1`（或只是`$i % 2`）。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:51:30.867

已经发布的答案的另一个变体......类似于菲尔卡特的答案。如果数组有数字索引，您可以在 foreach 中使用它，而不是管理单独的计数器变量：

```
foreach ($array as $i => $v) {
  if (! ($i % 2)) {
  // do stuff to $v
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:12:19.090

修复 cletuses 答案以提高速度并修复错别字：

```
for ($i = 1, $j = count($array); $i < $j; $i += 2) {
    // code
} 
```

# iphone - timeIntervalSince1970 的奇怪行为

> ID：923638
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-28T23:09:28.487
> 
>         
> 
> 标签：iphone, objective-c, timestamp, nsdate

我看到一个奇怪的行为，试图从目标 C 中的纪元开始获得秒数。这个：

```
NSString *nowTimestamp = [NSString stringWithFormat:@"%d", 
                             [[NSDate date] timeIntervalSince1970]]; 
```

输出 15907296，当前时间戳应为 1243555623（05/28/2009 @ 7:08pm EST）。iPhone上的系统时间是正确的。我一生都无法弄清楚我做错了什么。有什么建议吗？

* * *

## 回答 #1

> 赞同：31
> 
>             
> 
> 时间：2009-05-28T23:34:51.507

timeIntervalSince1970 返回一个 NSTimeInterval，它是 double 的 typedef；%d 不是打印双精度的正确格式化程序（您需要 %f）。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T23:39:33.200

由于 return from`[[NSDate date] timeIntervalSince1970];`是双倍的，你可以试试这个：

```
NSString *nowTimestamp = [NSString stringWithFormat:@"%f", 
                         [[NSDate date] timeIntervalSince1970]]; 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:23:59.720

你确定结果`NSDate`是十进制整数吗？文档说它是双重的。你可以试试铸造。

此外，有时您会得到一个指针值而不是实际值，如果某些东西`NSNumber`在幕后，您可能需要使用`intValue`, 或`doubleValue`获取地址处的实际内容。

# asp.net - 在 ASP.NET 站点之间共享身份验证

> ID：923641
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:10:10.403
> 
>         
> 
> 标签：asp.net

我有两个 ASP.NET 站点（它们不能在同一个进程中运行），我需要在它们之间共享身份验证。如果用户在站点 A 中已通过身份验证，然后转到站点 B，我需要有一种方法与站点 B 共享此信息，这样就不会要求用户再次进行身份验证。两种方式都是如此。你如何分享这些信息？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T00:19:43.697

他们在同一个域中吗？

如果你有 app1.blah.com 和 app2.blah.com，这很容易做到。只需在 web.config 的 forms-section 中将域和名称设置为相同的值：

```
<authentication mode="Forms">
      <forms loginUrl="login.aspx"
        name=".COOKIENAME" 
        protection="All"  
        path="/" 
        domain="blah.com" 
        timeout="30" />
    </authentication> 
```

另一个好处是用户可以登录任一站点，并且如果他们转到另一个站点，仍将通过身份验证。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-08-28T02:36:25.663

如果您使用表单身份验证，您可以通过设置机器密钥来完成此操作。

请参阅：[跨应用程序的表单身份验证](http://msdn.microsoft.com/en-us/library/eb0zx8fc.aspx)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:40:44.477

选择一个站点作为处理所有登录的“主站点”。我们将一个站点称为 A，将非登录站点称为 B。

当用户在 A 上使用登录表单时，它应该设置一个带有一些唯一标识符的 cookie，例如 GUID。只要该 cookie 有效，用户就应该保持登录状态。

当用户访问站点 B 时，站点 B 应该使用自己的唯一标识符（另一个 GUID）设置一个 cookie，然后重定向到站点 A 上的登录，并在查询字符串中传递唯一 ID：`Response.Redirect("http://siteA.com/login.aspx?id=ABCDEF")`

当用户在 A 上的表单上登录时，我们应该使用用户 ID 和传递的唯一 ID 更新站点 B 的数据库 - 可能通过 Web 服务 - 基本上让站点 B 知道“当用户在他们的 cookie 中包含 ABCDEF点击您的网站，它实际上是 User387"。

然后重定向回站点 B。之前的 cookie 仍然设置，但站点 B 现在读取该 cookie 并找到相应的用户 ID，因此它知道用户是谁并允许访问。

当用户到达站点 A 时，如果他们之前已经登录到站点 A，它将识别他们的 cookie，按照与上述相同的步骤，并立即重定向。

这是每个单点登录服务所做的非常简单的版本。用户只会被发送到 A 的登录页面一次，无论他们从哪里开始（站点 A 或站点 B）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:23:30.300

查看[Windows 通信身份验证服务](http://msdn.microsoft.com/en-us/library/bb386582.aspx)。不会像您想要的那样完全处理单点登录，但它至少应该让人们使用相同的凭据全面登录。

# windows - 为什么微软的 _wspawnv 返回 EINVAL？

> ID：923647
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:11:17.000
> 
>         
> 
> 标签：windows, visual-c++, spawn

我正在调用 Microsoft 的 _wspawnv 函数，它不断返回 -1 并将 errno 设置为 22；errno.h 将其定义为 EINVAL。`mode`根据 Microsoft 的 _wspawnv 文档，只有在参数无效时才应返回此代码。我尝试在第一个参数中使用 _P_WAIT 和 _P_NOWAIT 调用它，并且都返回相同的错误。

* * *

**编辑：**令人惊讶的是，离开一天可以解决多少问题。我很快就意识到第二个参数中的文件名有引号。拿出来，问题就解决了。

故事的寓意——不要相信文档会告诉你一切。我没有花很多时间仔细检查文件名，因为文档没有将它列为可能的嫌疑人，即使错误代码暗示*任何*参​​数都可能无效。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:51:13.660

奇怪的是，[文档](http://msdn.microsoft.com/en-us/library/7zt1y878.aspx)还指出：

> 如果允许继续执行，这些函数将 errno 设置为 EINVAL，并返回 -1。没有产生新的进程。

应该信任多少？

此外，它不应该返回 EINVAL。它将 errno 设置为 EINVAL。

# c++ - 将整数复制到缓冲区 memcpy C++

> ID：923649
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T23:11:20.713
> 
>         
> 
> 标签：c++, pointers

基本上我想将指针的地址存储在缓冲区中。不要问我为什么

```
char * buff = "myBuff";
char * myData = (char*)malloc(sizeof(char*));
int addressOfArgTwo = (unsigned int)buff;
memcpy(myData, &addressOfArgTwo, sizeof(char*));

cout << "Int Val: " << addressOfArgTwo << endl;
cout << "Address in buffer:" << (unsigned int)*myData << endl; 
```

我不明白为什么上面的代码不起作用。它输出：

```
Int Val: 4472832
Address in buffer:0 
```

当 Buffer 中的 Int Val & Address 应该相同时。谢谢

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-28T23:17:26.193

您取消引用 char *，生成 char，然后将该 1 字节 char 转换为 int，而不是整个 4 字节地址（如果这是 32 位机器，则 64 位为 8 字节）。4472832 是十六进制的 444000。在 little-endian 机器上，你抓取最后一个 00。

```
*((unsigned int*)myData) 
```

应该会显示正确的数字。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-01-19T01:24:16.363

这通常很危险：

```
 *((unsigned int*)myData) 
```

Intel IA-32（每个人都习惯）支持非对齐访问，但其他一些架构不支持。它们要求变量对齐（1 字节边界上的 8 位数据、2 字节边界上的 16 位数据和 4 字节边界上的 32 位数据）。在需要对齐的架构上，未对齐的访问将返回损坏的数据或引发 CPU 异常。我在过去的工作中看到它在现实生活中导致了一个错误，一个微妙的错误导致文件系统损坏，因为我们正在使用的软件包附带的磁盘驱动程序（在嵌入式平台上）。

在这种孤立的情况下，您可以看到 myData 的地址来自 malloc()，这应该意味着它适合所有类型的指针对齐，但是如果您不知道，将较小的指针转换为较大的指针通常是一种危险的做法指针来自哪里。

从任意内存位置提取 32 位整数的安全方法是声明一个临时 32 位整数并对其执行复制，将源内存视为原始字符数组：

```
unsigned int GetUnalignedLittleEndianUInt32(void *address)
{
    unsigned char *uc_address = (unsigned char *)address;
    return (
        (uc_address[3] << 24) |
        (uc_address[2] << 16) |
        (uc_address[1] << 8) |
        uc_address[0]
    );
} 
```

或更一般地说（有一些函数调用开销）：

```
unsigned int GetUnalignedUInt32(void *address)
{
    unsigned int value;
    memcpy(&value, address, sizeof(value));
    return value;
} 
```

这实际上与您首先在此处获取指针所做的 memcpy() 正好相反。

虽然，将指针视为 int：

```
int addressOfArgTwo = (unsigned int)buff; 
```

正如迈克尔指出的那样，如果您在 32 位和 64 位架构之间移动，这也是危险的。指针并不总是 32 位整数。考虑使用稍后可以更改的 typedef。Linux 上的约定是指针与 long 大小相同。在 Windows 上，有类型定义 INT_PTR、UINT_PTR、LONG_PTR 和 ULONG_PTR。

所以，我最后建议（无论如何在 Windows 上）：

```
ULONG_PTR GetAddressAtAddress(void *address)
{
    ULONG_PTR value;
    memcpy(&value, address, sizeof(value));
    return value;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:18:30.510

代替：

```
(int)*myData 
```

它应该是：

```
*((int*)myData) 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:18:50.183

正如迈克尔所说，这条线应该是

```
cout << "Address in buffer:" << *((unsigned int*)myData) << endl 
```

# svn - SVN 火狐插件

> ID：923650
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T23:11:38.403
> 
>         
> 
> 标签：svn, plugins, firefox-addon

是否有作为 SVN 客户端的 firefox 插件？我已经在官方插件网站上查看过。我真的不想麻烦安装一个独立的客户端，那么目前是否有一个 firefox 插件或者我或其他人可以制作一个简单的方法？这对我来说非常有用。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:15:45.633

我找到[了这个 firefox SVN 扩展](https://addons.mozilla.org/en-US/firefox/addon/3416)，但它基本上只是访问[**TortoiseSVN**](http://tortoisesvn.tigris.org/)的快捷方式。

Tortoise 本身已集成到外壳中，并且非常易于使用。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2010-06-30T07:56:23.297

在 IE 中安装 SVN 插件。然后安装 IE Tab 插件。

在工具、IE 选项卡选项中，选择“始终使用当前引擎打开新 URL”。浏览到任何页面，右键单击并选择“在 IE 选项卡中打开”。现在输入 svn:\ url 并显示页面。为页面添加书签。

要再次打开 svn 页面，请右键单击书签并选择“在 IE 选项卡中打开”。

如果您总是使用书签，您可以取消选择“始终使用当前引擎打开新 URL”

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:36:53.830

要从存储库读取和下载文件，您只需使用任何 Web 浏览器，从 Subversion 1.6 甚至可以查看 HEAD 以外的其他版本。但是，您无法查看日志消息或变更集，也无法签出或提交文件，但是我怀疑 webclient 是否适合它。

补充：您还可以使用 webDAV 功能直接写入存储库中的文件（自动版本控制，详见[svnbook](http://svnbook.red-bean.com/en/1.2/svn.webdav.autoversioning.html)）

还有很多可以在浏览器中使用的 svn-webclients 这里有两个项目：
 [http ://www.websvn.info/](http://www.websvn.info/)

Polarion WebClient for SVN 还支持通过下载/上传周期添加文件和更改（不知道 websvn）[http://community.polarion.com/index.php?page=overview&project=svnwebclient](http://community.polarion.com/index.php?page=overview&project=svnwebclient)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:59:40.803

根据您的评论，在我看来，您对获得不需要安装并且可以从闪存驱动器运行的东西更感兴趣。

一种可能性是使用命令行客户端：
 [http ://www.open.collab.net/downloads/subversion/](http://www.open.collab.net/downloads/subversion/)

它带有一个 .exe 安装程序，但您可以解压缩它（我使用的是 7-zip，不确定是否重要）并从任何文件夹运行它。

这里还列出了其他几个客户端，也许你可以找到一个适合你的口味：
 [http ://en.wikipedia.org/wiki/Comparison_of_Subversion_clients](http://en.wikipedia.org/wiki/Comparison_of_Subversion_clients)

# html - HTML 的 tbody 的用途是什么？

> ID：923655
> 
>         
> 
> 赞同：33
> 
>         
> 
> 时间：2009-05-28T23:14:20.427
> 
>         
> 
> 标签：html, html-table

`tbody`有人在表格中使用 HTML 的主要原因是什么？它只是为了格式化目的吗？

我通常使用`head`和；`body`我没用过`thead`和`tbody`。

* * *

## 回答 #1

> 赞同：39
> 
>             
> 
> 时间：2009-05-28T23:15:51.500

为您的表赋予语义含义：

```
<table>
  <thead>
    <tr>
      <th>Person</th>
      <th>Amount</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Person1</td>
      <td>$5.99</td>
      <td>02/03/09</td>
    </tr>
    <tr>
      <td>Person2</td>
      <td>$12.99</td>
      <td>08/15/09</td>
    </tr>
  </tbody>
</table> 
```

[根据规范](http://www.w3.org/TR/html401/struct/tables.html#h-11.2.3)：

> 可以分别使用 THEAD、TFOOT 和 TBODY 元素将表格行分组为表格头部、表格底部和一个或多个表格主体部分。这种划分使用户代理能够支持独立于表头和表脚滚动表体。打印长表时，表头和表尾信息可能会在包含表数据的每一页上重复。
> 
> 表头和表脚应包含有关表列的信息。表体应包含表数据行。
> 
> 如果存在，则每个 THEAD、TFOOT 和 TBODY 都包含一个行组。每个行组必须包含至少一行，由 TR 元素定义。

除了重要的语义重要性（想想屏幕阅读器）之外，您还可以轻松地将标题与数据行分开。另一个相关的例子是 jQuery 插件，例如[Tablesorter](https://mottie.github.io/tablesorter/docs/) ( [original](https://web.archive.org/web/20160304000106/http://tablesorter.com/docs/) , archived ) 插件可以很容易地找出你的数据结构是什么样的。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-05-28T23:22:34.777

我发现 tbody 的一个很好的用途是允许行可滚动，同时保持列页眉和页脚可见。这仅适用于实际支持 css 的浏览器。对不起，没有 Internet Explorer！

```
<tbody style="height: 150px; overflow-y: scroll"> 
```

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2010-11-21T16:43:07.733

如果表的标题是每一行的第一列怎么办？在这种情况下，无法指定表的标题。它实际上会破坏 HTML，因为解析器会假设所有内容都是表格主体的一部分。

以及为什么该标签是必需的，因为 th 指定了标题字段 - 浏览器可以通过这些字段找出表的哪一部分是标题。

thead 和 tbody 有什么意义？它们适用于某些情况，而在其他情况下会破坏 HTML。它们复制了 th 的功能。它们使代码复杂化并可能导致问题 - 在我了解 tbody 之前，我认为 tr-s 是 table 的孩子。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T23:15:57.427

用于分隔 HTML 表格的页眉 (thead)、正文 (tbody) 和页脚 (tfoot) 部分。这**非常**有用。一个典型的用途是把你的列标题放在你的thead元素中，把数据放在tbody中。tfoot 元素不太常见，但有时很有用。

顺便说一句，即使您没有指定 tbody，它仍然是为您隐式创建的。

您也可以将其用于样式目的，例如：

```
table thead tr { background-color: yellow; }
table tbody tr { background-color: #C9C9C9; } 
```

它在 Javascript 和 jQuery 中也很有用，可以让表格具有可选择的行（仅作为一个示例）。您通常只对选择或突出显示 tbody 中的行感兴趣，而不是顶部的标题行。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:20:20.150

它可以用于样式，是的，它对于 jQuery 选择器也很有用，可以帮助区分您想要选择的元素。毕竟，您可以在*thead*或*tbody中有**tr*标签。

 *** * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2017-08-29T04:05:44.963

HTML 中的**thead**、**tbody**和**tfoot**元素用于根据表格的内容将表格行分组为逻辑部分。您想要这样做的主要原因有两个：

1.  允许正文独立于页眉和/或页脚滚动

2.  为了更容易将不同的样式规则应用于表格的不同部分。

```
<table>
  <thead>
  <tr>
     <th>Month</th>
     <th>Savings</th>
  </tr>
  </thead>
  <tfoot>
  <tr>
      <td>Sum</td>
      <td>$180</td>
  </tr>
  </tfoot>
  <tbody>
  <tr>
     <td>January</td>
     <td>$100</td>
  </tr>
  <tr>
      <td>February</td>
      <td>$80</td>
  </tr>
  </tbody>
</table>
```

# java - Eclipse 3.2 还是 3.4？

> ID：923662
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:16:08.020
> 
>         
> 
> 标签：java, eclipse

Eclipse 3.2 和 3.4 之间真的有很大区别吗？我目前使用的是 3.2。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-05-28T23:26:36.970

查看“新功能和值得注意的”页面以获取新功能列表。

*   [3.3 新的和值得注意的](http://giano.com.dist.unige.it/eclipseMirror/eclipse/downloads/drops/R-3.3-200706251500/whatsnew/eclipse-news.html)

*   [3.4 新的和值得注意的](http://update.eclipse.org/downloads/drops/R-3.4-200806172000/whatsnew3.4/eclipse-news.html)

就个人而言，从日常使用 3.4 来看，单独的改进可能不是很明显，但整体体验要好得多。如果我必须回到 3.3 或 3.2，我经常会发现一些东西不能按我的预期工作，然后想“啊，是的，这在 3.2 中不起作用”。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:27:11.977

读

*   [Eclipse 3.3 - 新的和值得注意的](http://archive.eclipse.org/eclipse/downloads/drops/R-3.3-200706251500/whatsnew/eclipse-news-part1.html)

*   [Eclipse 3.4 - 新的和值得注意的](http://update.eclipse.org/downloads/drops/R-3.4-200806172000/whatsnew3.4/eclipse-news.html)

以及即将发布的伽利略版本

*   [Eclipse 3.5 - Galileo - 新的和值得注意的](http://www.bigsoft.co.uk/blog/index.php/2008/12/10/eclipse-3-5-galileo-new-and-noteworthy)

如果您使用 CDT ，那么您肯定想要获得**重大改进（索引器、代码完成......）。**

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-10-22T00:33:14.767

也许您会对再次升级到 3.6 感兴趣！

[Eclipse 3.6 - Helios - 新的和值得注意的](http://www.bigsoft.co.uk/blog/index.php/2009/10/15/eclipse-3-6-helios-new-and-noteworthy)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:26:32.413

我换了，但没有看到很大的改进。不过，切换非常轻松，所以我会说“为什么不呢？”。

# vb.net - 如何判断系统托盘中的气球提示是否已关闭？

> ID：923665
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T23:17:03.743
> 
>         
> 
> 标签：vb.net, notifyicon, balloon

我有一个应用程序，它使用托盘中的 NotifyIcon 来隐藏/恢复应用程序，以及向用户弹出应用程序事件的通知。我的应用程序有一个通知队列，我使用 NotificationIcon.BalloonTipClosed 事件来确定何时重置气球并显示下一个通知（如果队列中有通知）。

此方法似乎在两种常见原因中都非常有效（用户让气球在超时时自行关闭，并且用户在气球中单击“X”以强制其关闭），但还有第三种情况，即 BalloonTipClosed 没有被调用：

1.  弹出通知气球

2.  当它可见时，用户右键单击通知图标以调出上下文菜单，导致气球消失

在这种情况下，BalloonTipClosed 事件不会被触发 - 我认为这是框架中的一个错误（我使用的是 2.0），但有人对此有想法吗？如果我没有收到此事件，我的应用程序总是认为有一个可见的气球（我有一个布尔值阻止它一次显示多个气球），并且只要它正在运行，它就永远不会再显示另一个图标。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-06-05T05:19:23.533

这属于对 Aarons 回答的评论，但我还不能发表评论。

如果您处理 NotifyIcon（以及 BalloonTipClosed）上的 BalloonTipClicked 和 MouseClick 事件，那么您可以捕获气球可以关闭的所有方式。你唯一需要注意的是几个场景会触发多个事件，所以一定要围绕它编写代码（比如 isClosed = true，然后在显示新气球时重置它）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T03:56:28.140

在 BalloonTipClicked 事件的事件处理程序中，我将检查是否单击了鼠标右键，以及是否将布尔值设置为 false。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-04T14:58:37.290

这就是我最终做的事情，尽管我并不特别喜欢这个解决方案。我在表单中添加了第二个计时器并将其设置为 10 秒。当弹出通知时（当我弹出一个通知时），我启动计时器，然后在 BalloonTipClosed 中停止它。如果计时器滴答作响（意味着 BalloonTipClosed 尚未运行），我会手动显示下一个提示。

结果是，如果它还没有触发，我会处理它。但是，如果有人有更好的解决方案，我愿意接受。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-06-05T10:40:45.820

我认为 Raymond Chen 关于气球通知的这篇文章可能会对您有所帮助：http:
 [//blogs.msdn.com/oldnewthing/archive/2009/05/04/9585032.aspx](http://blogs.msdn.com/oldnewthing/archive/2009/05/04/9585032.aspx)

# c# - Reporting Services 2005 报告每个部分后的免责声明页面

> ID：923679
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T23:21:41.550
> 
>         
> 
> 标签：c#, .net, sql-server, reporting-services

细节：  

我在带有 Visual Studio 2008 的 C# 应用程序中使用 Reporting Services 2005 来生成基于 SQL Server 2005 数据库的报告。应用程序使用 .net 报表查看器在本地查看报表，并且不使用报表服务器。每个人之后的报告中都有一个分页符。我目前只为 .rdlc 文件使用一个报告表来生成报告。

问题：

我的客户希望在分组结束后为报告中列出的每个人放置一个免责声明页面。客户希望能够在运行报告之前通过用户界面即时调整免责声明页面。请就我如何做到这一点提出建议。

任何帮助表示赞赏。

谢谢，

杰里米

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-28T23:53:13.453

你的意思是他们想在执行报告之前或之后即时调整它？如果以前，您可以不使用参数，将免责声明模板作为默认值，并在完成后将其提交给报告吗？然后，您可以将参数放在组页脚中。如果在那之后......祝你好运:) 报告将呈现为所选的任何格式。如果您在 html 中检索报告并拥有呈现的文件，则可能可以进行自定义解析，但似乎有点不合适。使用 SRS 已经有一段时间了，希望参数可以为你工作。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T11:36:54.720

另一种解决方案是创建另一个报告，其唯一目的是呈现免责声明内容。然后可以将免责声明报告嵌入（通过子报告：请参阅[http://msdn.microsoft.com/en-us/library/ms160348.aspx](http://msdn.microsoft.com/en-us/library/ms160348.aspx)）到您现有的报告中，从而允许您单独动态修改免责声明的内容。

您可以将实际的免责声明内容存储在 SQL Server 数据库表中，并通过您可以使用的任意数量的典型简单标准 .NET 控件对其进行更新。

根据先前的建议，这具有没有字符限制的优点。

# php - 从 PHP 脚本调用 Python 脚本时，在控制台运行时创建的临时文件不是通过 PHP 调用创建的

> ID：923680
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:21:44.467
> 
>         
> 
> 标签：php, python, linux

设想：

我有一个 php 页面，我在其中调用 python 脚本。

在命令行 (Linux) 上运行的 Python 脚本在命令行上显示输出，并将输出写入文件。

通过 php 运行的 Python 脚本也不执行任何操作。

阐述：

我在 PHP 中使用一个简单的系统命令来运行 python 脚本：

/var/www/html/1.php: system('/usr/python/bin/python3 ../cgi-bin/tabular.py 1');

/var/www/cgi-bin/tabular.py --这个python文件基本上是解析一个数据文件，使用python的正则表达式搜索特定的标题并将标题输出到stdout，以及将其写入文件。

这个 python 脚本中有一些执行的例程，所以我将打印语句用于调试。我注意到 PHP 页面中只有一些初始打印语句的输出，没有看到函数中实际执行某些操作的所有语句。

另外，作为我测试的一部分，我认为 py 脚本位于不同的文件夹中，所以让我将其更改为 /var/www/html 文件夹，不行。

我希望我捕获了足够详细的问题陈述，并且有人能够在他们的最后重现这个问题。如果我自己在这方面取得任何进展，我会注释这个问题。谢谢大家。

高拉夫

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T13:09:39.260

我敢打赌你的 py 脚本有一些错误，当从 PHP 内部调用它时会导致它中断。尝试

```
passthru('/usr/python/bin/python3 ../cgi-bin/tabular.py 1 2>&1'); 
```

进行调查（注意**2>&1**导致 stderr 被写入标准输出）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T05:14:54.243

**很可能是**权限问题。****

 **如果 apache 以 as 运行`apache`，那么它将无权写入文件，除非

1.  该文件归`apache`

2.  文件在组中`apache`且组可写

3.  该文件是世界可写的

这是多用户机器上的“棘手”问题，因为不同的人可以访问 Apache。  

尝试`chmod 666 output.txt`该文件，然后重新运行您的测试。

* * *

**注意事项：**

1.  让 python 脚本将输出写入数据库

2.  使用 PHP 的 popen 功能打开进程并通过管道进行通信

3.  使用 PHP 的正则表达式重写

4.  将输出文件写入 /tmp，然后在 python 脚本完成后立即使用 PHP 读取结果。

5.  ETC...

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:48:39.203

检查运行 python 脚本的用户是否在 CWD 中具有写入权限。此外，尝试使用 shell_exec() 或 passthru() 来调用脚本，而不是 system()。

# javascript - 通过按 Enter #2 阻止用户提交表单

> ID：923683
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-28T23:22:58.927
> 
>         
> 
> 标签：javascript, jquery, html

好吧，在上一个问题中，我问了同样的事情，但是当用户在文本框中时，我不会阻止提交的答案。

所以基本上我需要的是能够阻止一个人提交表单，除非明确点击提交按钮。

编辑：

基本上这样做的主要原因是这是一项雇主调查。这方面的人不会是最精通技术的人，我为之做这个的客户已经提出了这个要求。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-28T23:29:24.843

```
$('input').keydown(function(e){
    return e.keyCode !== 13;
}); 
```

...顺便说一句，我不建议这样做。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-08-25T15:49:09.093

我将表单设置为 onsubmit="return false" 并这样做了

```
<input type="button" value="Submit" onClick="document.Survey.submit()" style="font-size: 1.25em;"> 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T14:47:17.520

我建议使用 onsubmit 处理程序来阻止提交表单（返回 false），然后在单击按钮时使用 javascript 提交表单。

```
<form action="accion.htm" onsubmit="return false;">
    <input type="text" name="pepe" />
    <a onclick="this.parentNode.submit();" href="javascript:;">submit</a>
</form> 
```

请注意，这只是一个示例，不应内联添加事件处理程序，并且 this.parentNode.Submit() 仅`<a>`在表单的直接子级时才有效。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:17:40.330

为什么需要这样做？

**通过按Enter**提交表单是 Web 表单上的标准预期行为。

如果您要确保他们在填写或选择所有选项之前不会**意外**提交表单，请使用验证 javascript 函数来检查表单上所有字段中的条目。如果缺少什么，弹出一个警告框告诉他们缺少什么并返回**false**。（将 onsubmit='myValidateForm();' 选项添加到表单标签）

**如果填写了所有必需的数据，那么允许通过输入**以及单击按钮提交表单应该没有问题。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T14:51:12.177

如果表单有一个文本类型的输入，并且用户在该输入中按 Enter 键，则将根据 HTML 4 规范提交表单。防止这种情况发生的最简单方法是添加另一个隐藏的文本输入

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-10-16T01:02:58.073

我在哲学上同意那些说“你为什么要这样做？”的海报。但我也有人问我这种行为，所以我和你在同一条船上。

我之前使用过 Thirster42 的解决方案，但这只适用于 GET，而不是 POST。它似乎也是特定于浏览器的——当用户在文本框中输入时，Firefox 不会提交表单，但 Safari 会。（火狐 3.5.3、Safari 4.0.3、MacOSX）

我在网上看到的大部分内容都是[这样](http://www.html-faq.com/htmlforms/?stopformsubmit)的：“问：我该怎么做？答：基本上，你不需要。” 我相信这是因为跨平台和网络浏览器的行为不一致，适用于 Firefox 的可能不适用于 IE 或 Opera。此外，如果用户在浏览器中禁用了 javascript，则您不能依赖它。

话虽如此，这就是我所做的似乎有效的工作，从[这里](http://www.arraystudio.com/as-workshop/disable-form-submit-on-enter-keypress.html/comment-page-1#comments)和其他地方借来的。在 Firefox、Safari 和 IE 8 中测试。标头的 JavaScript：

```
function disableEnterKey(e)
{
   var key;
   if(window.event)
      key = window.event.keyCode;     // IE 
   else
      key = e.which;     // Firefox
   if(key == 13)
      return false;
   else
      return true;
 } 
```

然后在每个输入字段上：

```
:onKeyDown "return disableEnterKey(event);" 
```

我不太喜欢它，但如果它能让人们开心...

# vba - 如何测试 Excel 中的 Range 中是否包含单元格？

> ID：923684
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-28T23:23:11.127
> 
>         
> 
> 标签：vba, excel, event-handling

我在 Worksheet_Change 事件中的 Excel/VBA 中发现了一个问题。我需要将 Target.Dependents 分配给 Range，但如果它没有依赖项，则会出现错误。我尝试测试 Target.Dependents.Cells.Count 但这没有用。有任何想法吗？

```
Private Sub Worksheet_Change(ByVal Target As Range)

If Target.Cells.Count > 1 OR Target.Dependents.Cells.Count = 0 Then Exit Sub

Dim TestRange As Range

Set TestRange = Target.Dependents 
```

我也试过“Target.Dependents Is Nothing”。

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-05-29T20:26:22.357

简短的回答，没有办法在不引发错误的情况下测试家属，因为属性本​​身设置为在访问时引发错误并且没有任何错误。我不喜欢这个设计，但没有办法在不抑制错误的情况下阻止它。AFAIK 这是你能做到的最好的事情。

```
Sub Example()
    Dim rng As Excel.Range
    Set rng = Excel.Selection
    If HasDependents(rng) Then
        MsgBox rng.Dependents.Count & " dependancies found."
    Else
        MsgBox "No dependancies found."
    End If
End Sub

Public Function HasDependents(ByVal target As Excel.Range) As Boolean
    On Error Resume Next
    HasDependents = target.Dependents.Count
End Function 
```

说明，如果没有依赖项，则会引发错误，并且 HasDependents 的值与类型默认值保持不变，即 false，因此返回 false。如果有*家属*，则计数值永远不会为零。所有非零整数都转换为 true，因此当将 count 指定为返回值时，将返回 true。它与您已经在使用的非常接近。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:04:39.893

这是我发现使它工作的唯一方法，但我想要一个更好的解决方案：

```
On Error Resume Next
Dim TestRange As Range
Set TestRange = Target.Dependents

If TestRange.HasFormula And Err.Number = 0 Then ... 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:07:54.690

如发现：[http ://www.xtremevbtalk.com/t126236.html](http://www.xtremevbtalk.com/t126236.html)

```
 'Returns a Collection of all Precedents or Dependents found in the Formula of the Cell argument
    'Arguments      : 'rngCell' = the Cell to evaluate
    '               : 'blnPrecedents' = 'TRUE' to list Precedents, 'FALSE' to list Dependents
    'Dependencies   : 'Get_LinksFromFormula' function
    'Limitations    : does not detect dependencies in other Workbooks
    'Written        : 08-Dec-2003 by member Timbo @ visualbasicforum.com
    Function Get_LinksCell(rngCell As Range, blnPrecedents As Boolean) As Collection
    Dim rngTemp As Range
    Dim colLinksExt As Collection, colLinks As New Collection
    Dim lngArrow As Long, lngLink As Long
    Dim lngErrorArrow As Long
    Dim strFormula As String, strAddress As String
    Dim varLink
    On Error GoTo ErrorH

        'check parameters
        Select Case False
            Case rngCell.Cells.Count = 1: GoTo Finish
            Case rngCell.HasFormula: GoTo Finish
        End Select

        Application.ScreenUpdating = False

        With rngCell
            .Parent.ClearArrows

            If blnPrecedents Then
                .ShowPrecedents
            Else: .ShowDependents
            End If

            strFormula = .Formula

            'return a collection object of Links to other Workbooks
            If blnPrecedents Then _
                Set colLinksExt = Get_LinksFromFormula(rngCell)

    LoopArrows_Begin:
            Do 'loop all Precedent/Dependent Arrows on the sheet
                lngArrow = lngArrow + 1
                lngLink = 1

                Do
                    Set rngTemp = .NavigateArrow(blnPrecedents, lngArrow, lngLink)

                    If Not rngTemp Is Nothing Then
                        strAddress = rngTemp.Address(External:=True)
                        colLinks.Add strAddress, strAddress
                    End If

                    lngLink = lngLink + 1
                Loop

            Loop

    LoopArrows_End:
            If blnPrecedents Then
                .ShowPrecedents True
            Else: .ShowDependents True
            End If

        End With

        If blnPrecedents Then 'add the external Link Precedents
            For Each varLink In colLinksExt
                colLinks.Add varLink, varLink
            Next varLink
        End If

    Finish:
    On Error Resume Next
        'oh, one of the arrows points to the host cell as well!
        colLinks.Remove rngCell.Address(External:=True)

        If Not colLinks Is Nothing Then Set Get_LinksCell = colLinks
        Set colLinks = Nothing
        Set colLinksExt = Nothing
        Set rngTemp = Nothing
        Application.ScreenUpdating = True

        Exit Function
    ErrorH:
        'error while calling 'NavigateArrow' method
        If Err.Number = 1004 Then

            'resume after 1st and 2nd error to process both same-sheet
            '   and external Precedents/Dependents
            If Not lngErrorArrow > 2 Then
                lngErrorArrow = lngErrorArrow + 1
                Resume LoopArrows_Begin
            End If
        End If

        'prevent perpetual loop
        If lngErrorArrow > 3 Then Resume Finish
        lngErrorArrow = lngErrorArrow + 1
        Resume LoopArrows_End

    End Function

    'Returns a Collection of Range addresses for every Worksheet Link to another Workbook
    '   used in the formula argument
    'Arguments: 'rngCellWithLinks'  = the Cell Range containing the formula Link
    'Written        : 08-Dec-2003 by member Timbo @ visualbasicforum.com
    Function Get_LinksFromFormula(rngCellWithLinks As Range)
    Dim colReturn As New Collection
    Dim lngStartChr As Long, lngEndChr As Long
    Dim strFormulaTemp As String, strFilenameTemp As String, strAddress As String
    Dim varLink
    On Error GoTo ErrorH

        'check parameters
        Select Case False
            Case rngCellWithLinks.Cells.Count = 1: GoTo Finish
            Case rngCellWithLinks.HasFormula: GoTo Finish
        End Select

        strFormulaTemp = rngCellWithLinks.Formula
        'determine if formula contains references to another Workbook
        lngStartChr = Len(strFormulaTemp)
        strFormulaTemp = Replace(strFormulaTemp, "[", "")
        strFormulaTemp = Replace(strFormulaTemp, "]", "'")
        'lngEndChr = Len(strFormulaTemp)

        If lngStartChr = lngEndChr Then GoTo Finish

        'build a collection object of links to other workbooks
        For Each varLink In rngCellWithLinks.Parent.Parent.LinkSources(xlExcelLinks)
            lngStartChr = InStr(1, strFormulaTemp, varLink)

            If Not lngStartChr = 0 Then
                lngEndChr = 1
                strAddress = Mid(strFormulaTemp, lngStartChr + Len(varLink), lngEndChr)

    On Error Resume Next
                'add characters to the address string until a valid Range address is formed
                Do Until TypeName(Range(strAddress)) = "Range"
                    strAddress = Mid(strFormulaTemp, lngStartChr + Len(varLink), lngEndChr)
                    lngEndChr = lngEndChr + 1
                Loop
                'continue adding to the address string until it no longer qualifies as a Range
                If Not (lngStartChr + Len(varLink) + lngEndChr) > Len(strFormulaTemp) Then
                    Do Until Not IsNumeric(Right(strAddress, 1))
                        strAddress = Mid(strFormulaTemp, lngStartChr + Len(varLink), lngEndChr)
                        lngEndChr = lngEndChr + 1
                    Loop
                    'remove the trailing character
                    strAddress = Left(strAddress, Len(strAddress) - 1)
                End If

    On Error GoTo ErrorH
                strFilenameTemp = rngCellWithLinks.Formula
                'locate append filename to Range address
                lngStartChr = InStr(lngStartChr, strFilenameTemp, "[")
                lngEndChr = InStr(lngStartChr, strFilenameTemp, "]")
                strAddress = Mid(strFilenameTemp, lngStartChr, lngEndChr - lngStartChr + 1) & strAddress

                colReturn.Add strAddress, strAddress
            End If

        Next varLink
        Set Get_LinksFromFormula = colReturn

    Finish:
    On Error Resume Next
        Set colReturn = Nothing
        Exit Function

    ErrorH:
        Resume Finish

    End Function 
```

# c++ - 关于我在 C++ 代码中从未见过的特殊运算符的一些问题

> ID：923688
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-28T23:24:07.613
> 
>         
> 
> 标签：c++, syntax, c++-cli

我已经下载了 2008 年 6 月的 Phoenix SDK（编译器工具），当我阅读 Hello 示例的代码时，我真的感到迷茫。

```
public
ref class Hello
{
//--------------------------------------------------------------------------
//
// Description:
//
//    Class Variables.
//
// Remarks:
//
//    A normal compiler would have more flexible means for holding
//    on to all this information, but in our case it's simplest (if
//    somewhat inelegant) if we just keep references to all the
//    structures we'll need to access as classstatic variables.
//
//--------------------------------------------------------------------------

static Phx::ModuleUnit                 ^ module;
static Phx::Targets::Runtimes::Runtime ^ runtime;
static Phx::Targets::Architectures::Architecture       ^ architecture;
static Phx::Lifetime                   ^ lifetime;
static Phx::Types::Table               ^ typeTable;
static Phx::Symbols::Table                ^ symbolTable;
static Phx::Phases::PhaseConfiguration        ^ phaseConfiguration; 
```

2个问题：那个 ref 关键字是什么？那个符号是什么^？它在做什么

受保护：

```
 virtual void
  Execute
  (
     Phx::Unit ^ unit
  ) override; 
```

};

override 也是 C++ 关键字吗？它在我的 Visual Studio 中是这样着色的。我真的很想玩这个框架，但是这个高级 C++ 现在真的是一个障碍。谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-05-28T23:25:23.790

它不是标准 C++，而是[C++/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI)。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T23:28:10.070

它是用于 .NET 的 Microsoft 扩展。插入符号表示存储在托管堆上的对象的句柄。请参阅[Bran Bray 的](http://blogs.msdn.com/branbray/archive/2003/11/17/51016.aspx)博客以获得很好的描述。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T23:29:07.433

它是 C++/CLI - 编写为在 .Net 框架下作为托管代码运行的代码，而不是常规的 C++ 代码。

*   ref - 这个类是一个引用类型，它分配在托管堆中，将被垃圾回收

*   ^ - 此变量是托管实例的句柄

*   override - 此方法覆盖基类实现

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-05-28T23:30:15.107

这不是标准 C++ 的一部分。它是[C++/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI)，这是一种旨在替代[托管 C++](http://en.wikipedia.org/wiki/Managed_Extensions_for_C%2B%2B)的 Microsoft 语言规范：

> C++/CLI（通用语言基础结构）是 Microsoft 的语言规范，旨在取代 C++ 的托管扩展。完全修改以简化旧的托管 C++ 语法（现已弃用），它提供比托管 C++ 更清晰和代码可读性。C++/CLI 被 Ecma 标准化为 ECMA-372。它目前仅在 Visual Studio 2005 和 2008 中可用（也包含在速成版中）。

插入符号是指针的 C++/CLI 等效项，如 Rob Walker[对此问题](https://stackoverflow.com/questions/202463/what-does-the-caret-mean-in-c-cli)的回答中所述：

> ...插入符号是 *（指针）的托管等效项，在 C++/CLI 术语中称为“引用类型”的“句柄”（因为您仍然可以拥有非托管指针）。请参阅 Microsoft 的此
>   [概述](http://msdn.microsoft.com/en-us/library/ms379617(VS.80).aspx)
>   。

[在这篇博](http://blogs.msdn.com/hsutter/archive/2003/11/18/53509.aspx)文中讨论了“ref class X”而不是熟悉的“class X”的用法。

# php - 从数据库中提取组

> ID：923689
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:24:51.623
> 
>         
> 
> 标签：php, mysql

好吧，我有一个魔法卡网站，如果您单击主页上的集合，我会尝试从某个集合中提取所有卡片。www(dot)magiccards(dot)me 第一页的代码是：

```
 <?php

require("mysqlconnect.php");

$query = "SELECT COUNT(*) AS `Rows`, `set`,id FROM `magic_cards_copy`  GROUP BY `set` ORDER BY `set`";

$result = mysql_query($query) or die(mysql_error());

// Print out result
while($row = mysql_fetch_array($result)){
    $setlink = $row[1];
    $setlink = str_replace(" ", "", $setlink);
    $setlink = strtolower($setlink);
    $setlink = preg_replace("/[^a-z0-9]./","",$setlink);
    $setlink .= "-c-$row[2]";
    $setlink .= ".html";

    $navigation .= "< href=\"$setlink\">$row[1]</a> <small><i>($row[0])</i></small>";
}

require("template.php");

?> 
```

页面上的代码是：

```
 <?

require("mysqlconnect.php");

$cat=$_GET['cat'];

echo "Category: $cat<br>";

$query = "SELECT * FROM `magic_cards_copy` WHERE id = $cat ";

$result = mysql_query($query) or die(mysql_error());
$row = mysql_fetch_array($result);
echo "Set: $row[1]<br>";

?> 
```

代码如何从每组中提取卡片？任何帮助都会很棒。这对我来说更像是一个练习网站。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:57:31.540

我会创建一个有两列的表。第一列是 set-id（所有集合的唯一标识符），它会被索引以便快速查找。第二列是卡片的 ID。您可以将此表用于包含所有唯一卡的表上的 JOIN

顺便说一句，清理所有输入

```
$cat=$_GET['cat']; 
```

对 SQL 注入攻击开放。您还应该将其转换为整数。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:28:28.140

阅读数据库规范化。你应该做的是有一个“集合”表，在其中列出每个集合的 ID 号。然后在您的卡片数据库中，您有一个对应于该集合的 ID 号，而不是集合名称。

示例集表：

```
id    set
------------------
1     Set One Name
2     Set Two Name 
```

示例卡片表：

```
id    setid   card
-------------------------------------
1     1       Card One from First Set
2     1       Card Two from First Set
3     2       A card from Second Set 
```

当您想列出集合时，您只需从集合表中选择所有内容。当您想要列出一组卡片时，您可以选择所有卡片，其中集合 ID 是您要查找的任何内容。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:52:19.227

不太确定你在问什么，但首先要看的是，因为这是一个练习网站

```
$cat = mysql_real_escape_string($_GET['cat']); 
```

至少可以防止 SQL 注入黑客攻击。您应该始终练习安全性。
[PHP.not 关于 SQL 注入](http://uk.php.net/manual/en/security.database.sql-injection.php)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:56:06.253

从问题中不清楚您要做什么 - 例如，提供的两个 PHP 脚本之间的关系是什么，您是要从所有集合中提取卡片，还是从 GIVEN 集合中提取卡片？我将尝试回答这两个问题：

$_GET['cat'] 中的所有卡片：

```
<?php
$dbh = new PDO('mysql:dbname=testdb;host=127.0.0.1', 'dbuser', 'dbpass');
$stmt = $dbh->prepare('SELECT cardname from magic_cards_copy where set = :set');
$stmt->bindParam(':set', $_GET['cat'], PDO::PARAM_STR);
$stmt->execute();

while ($card = $stmt->fetch(PDO::FETCH_ASSOC)) {
  // display card here
} 
```

所有套装中的所有卡片：

```
<?php
$dbh = new PDO('mysql:dbname=testdb;host=127.0.0.1', 'dbuser', 'dbpass');
$query = $dbh->query('SELECT cardname from magic_cards_copy');

while ($card = $query->fetch(PDO::FETCH_ASSOC)) {
  // display card here
} 
```

请注意，我强烈建议您使用[PDO](http://php.net/pdo)，因为它可以保护您免受各种愚蠢的影响。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T02:39:12.167

```
echo "Category: $cat<br>"; 
```

这受[跨站点脚本](http://www.owasp.org/index.php/Cross-site_Scripting_(XSS))漏洞的影响。由于您将此用作练习站点，因此您应该了解安全漏洞以及如何避免它们。从阅读 OWASP 网站开始。

正如其他人所指出的，您还存在 SQL 注入缺陷。

此外，这是您网站的输出：

```
Category: 143345
Set: Alliances
You have an error in your SQL syntax; check the manual that corresponds to 
your MySQL server version for the right syntax to use near ''magic_cards_copy' 
WHERE category = 'Alliances' LIMIT 40' at line 1 
```

看起来您在表名周围使用了错误的分隔符。在表名周围使用反引号，而不是单引号。

您确实需要创建另一个表，以记录每组中每张卡的成员身份。这有时称为“多对多表”或“交集表”。尤其如此，因为 IIRC，一些万智牌卡可以属于多个系列。

所以这就是我的做法：

```
CREATE TABLE CardSets (
  set_id INT PRIMARY KEY AUTO_INCREMENT,
  set_name VARCHAR(40)
);

CREATE TABLE Cards (
  card_id INT PRIMARY KEY AUTO_INCREMENT,
  card_name VARCHAR(40)
  -- other card attributes, color, flavor text, etc.
);

CREATE TABLE CardSetManifest (
  set_id INT NOT NULL,
  card_id INT NOT NULL,
  -- other attributes of card specific to a given set, e.g. rarity
  PRIMARY KEY (set_id, card_id),
  FOREIGN KEY (set_id) REFERENCES CardSets(set_id),
  FOREIGN KEY (card_id) REFERENCES Cards(card_id)
); 
```

所以给定 a`set_id`你可以得到该集合中的牌数：

```
SELECT set_id, COUNT(*) FROM CardSetManifest GROUP BY set_id; 
```

给定 a`set_id`您可以获得该集合中的卡片列表：

```
SELECT m.set_id, m.card_id, c.card_name
FROM CardSetManifest m JOIN Cards c USING (card_id); 
```

# python - 如何在远程服务器上启动进程，断开连接，然后收集输出？

> ID：923691
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T23:25:14.133
> 
>         
> 
> 标签：python, testing, scripting

我正在用 python 编写自动化代码来测试网络应用程序的行为。因此，我的代码需要能够在网络中的服务器上启动进程/脚本（例如 tcpdump 或 python 脚本），断开连接，运行其他进程，然后返回并关闭/评估之前启动的进程。我的网络是 windows 和 linux 机器的混合体，所有机器都运行 sshd 和 python（通过 Cygwin 运行 windows 机器）。  

我考虑了几个想法，即： - 启动一个进程并通过尾随与号 (&) 将其移动到后台 - 以某种方式使用屏幕 - 使用 python 线程

我还应该考虑什么？根据您的经验，您发现完成此类任务的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T23:28:15.967

nohup 对于初学者（至少在 *nix 盒子上） - 并将输出重定向到一些日志文件，您当然可以在其中返回并监控它。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T23:29:23.610

因此，既然我了解了您真正想要的内容，我认为最好的解决方案是创建一个 lite 守护程序来运行您想要的任何进程。然后守护程序可以将输出转储到日志文件中，因此如果运行时间比您预期的要短，您仍然可以获得输出。这比摆弄屏幕更可靠。然而，应该指出的是，这可能是一个安全风险。如果这是您每 N 个时间段运行一次的任务，那么 cron 会工作得更好。

**原始答案**

[GNU Screen](http://www.gnu.org/software/screen/)是处理这个问题的好方法。

**编辑：**重新阅读您的问题后，我想我误解了您。您是否希望在本地机器上运行一个 python 脚本，该脚本将连接到远程机器并运行一些任意进程，然后能够再次连接到远程机器并检查日志或其他内容？

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:34:40.183

对于一个快速、轻量级的解决方案，您无法击败[screen](http://www.gnu.org/software/screen/)。如果您想完全自动化，将进程设置**为作为守护进程运行**并使用`syslog`. 您的系统可能有一个`start-stop-daemon`脚本，对于 C 代码，它也可能`daemon(3)`在 C 库中有一个调用。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:35:58.027

如果你想让一个脚本在你离开后继续运行，你可以通过“nohup”（man nohup）来调用它。您还可以将代码放入您调用的脚本中以使其自身守护进程...它分叉，使子进程成为守护进程，然后退出。快速搜索出现：[http ://code.activestate.com/recipes/278731/](http://code.activestate.com/recipes/278731/)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T14:11:33.940

而不是屏幕，因为它是针对单个进程的，我建议使用它的轻量级兄弟[dtach](http://dtach.sourceforge.net/)。

有关在 Python 中守护进程的相当完整的秘诀，请参阅ActiveState 手册中[的以 Python 方式创建守护进程。](http://code.activestate.com/recipes/278731/)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:31:34.417

`nohup`正如@Gandalf 提到的，除了后台& 之外，您还需要，否则当登录会话终止时，该进程将被SIGKILLed。如果您将输出重定向到日志文件，您稍后可以轻松查看它（并且不必在所有机器上安装 screen）。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:32:11.607

大多数商业产品在远程机器上安装“代理”。

在 linux 世界中，您有许多这样的代理。rexec 和 rlogin 和 rsh 都浮现在脑海中。

这些都是与远程主机上运行的守护进程通信的客户端。

如果您不想使用这些代理，您可以阅读它们并在纯 Python 中重新发明这些轮子。本质上，客户端（例如 rexec）与服务器（rexecd）通信以发送工作请求。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2014-01-02T18:09:41.453

如果您使用 python 来运行自动化...我会尝试使用 paramiko 自动化所有内容。这是一个用于 python 的多功能 ssh 库。您可以实时收集多行输出，然后在不再需要该进程时断开连接，让 ssh 为您完成杀戮，而不是返回输出。

# sql-server - 如何让 SSIS FTP 任务执行 FTP 脚本而不仅仅是上传文件？

> ID：923700
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:27:28.450
> 
>         
> 
> 标签：sql-server, ssis

我正在开发一个 SSIS 包，该包将一些数据从 DB 提取到文件中，然后将其上传到 FTP 服务器。我需要执行几个 FTP 命令，但似乎 SSIS FTP 任务只允许我指定源和目标位置。

有谁知道如何让 SSIS 执行 FTP 脚本而无需创建脚本任务和编写 VB.NET 代码？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-28T23:44:15.017

不幸的是，不，我认为您可能需要使用脚本任务。您应该能够找到一个 .Net FTP 库以重复使用（将其添加为参考），并且您可以将用户/传递/连接信息存储在变量中并在脚本中访问它以获得最大的可移植性/可维护性。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T00:01:13.843

有几条路线可以走...

假设您有一个可以从命令行运行的 FTP 客户端，您可以使用执行进程任务来运行 FTP 客户端。

或者，您可以创建一个 shell 脚本（如批处理脚本）来向 FTP 客户端发送命令，并使用执行进程任务来执行 shell 脚本。如果您需要向客户端发送一系列命令，并且不能通过一组输入参数完成所有操作，这将是必要的：即接受命令脚本作为输入参数的命令行 FTP 客户端（可能有一些更强大的 FTP 客户端可以执行此操作）。

最后，正如 Dane 所提到的，您的替代方法是使用脚本任务。这允许您使用托管代码 (VB.NET) 来执行更复杂的操作。您可以“滚动自己的”程序集来创建 FTP 连接、运行命令等，或者使用第三方程序集来避免自己编写 FTP 客户端，而只需编写一些 VB.NET 来使用它。

如果您正在了解在 .NET 中创建 FTP 客户端的一些基础知识，那么本文将帮助您入门： http: [//support.microsoft.com/kb/812404](http://support.microsoft.com/kb/812404)  虽然老实说，我还是会寻找第三方做你需要的图书馆。

# python - Python 任务栏小程序

> ID：923701
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T23:28:09.260
> 
>         
> 
> 标签：python, qt4, pyqt

我想编写一个可在 Linux 和 Windows 中使用的面板。理想情况下，它将使用 PyQT 用 Python 编写。

到目前为止，我发现的是 QSystemTrayIcon 小部件，虽然它非常有用，但这并不是我想要的。该小部件可让您将菜单附加到系统托盘上图标的左键和右键单击，然后您可以在某些情况下打开一个对话框。

我正在寻找可以让我编写类似 Gnome 允许您添加到任务栏的工具（他们称它们为面板）的东西。例如天气提要或处理器使用情况，就在任务栏上。而且也不在系统托盘区。

我写的更多的是一种工具，而不是反映一种状态的东西。

我知道我可以使用 GTK 及其同类在两个操作系统中本地编写此代码，但无论如何要使用 PyQT 或 WxWidget 编写，这样我就不必处理依赖问题？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T23:44:38.773

GNOME 面板中的小部件被称为小程序，据我所知，除了 Gtk 之外不可能用任何东西编写它们，因为您必须使用相应的 GNOME 库 libpanel-applet（在 C、C++ 或 Python 中）。

系统托盘图标不同，因为它们只允许在通知区域内显示图标，因为 Windows 只支持那里的图标。

我认为 Windows 上的面板机制（Vista、XP 确实只有通知区域）完全不同。除非有人已经编写了一个库来抽象 GNOME 面板和 Vista 侧边栏的差异，否则您必须自己做。

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T07:16:27.677

听起来您正在寻找[Plasmoids](http://www.youtube.com/watch?v=DzraMSNvhQI)，它可以集成到任务栏中。[在C++](http://techbase.kde.org/Development/Tutorials/Plasma/GettingStarted)和[Python](http://techbase.kde.org/Development/Tutorials/Plasma/PythonPlasmoid)中有 Plasmoid 教程。

但是，我不能说它是否适用[于 Windows 上的 KDE](http://windows.kde.org/)。

# iphone - 检查 .nib 或 .xib 文件是否存在

> ID：923706
> 
>         
> 
> 赞同：32
> 
>         
> 
> 时间：2009-05-28T23:29:17.010
> 
>         
> 
> 标签：iphone, objective-c, xcode, nib

`initWithNibName:bundle:`在尝试使用或类似方法加载之前检查 Nib 或 Xib 文件是否存在的最佳方法是什么？

* * *

## 回答 #1

> 赞同：68
> 
>             
> 
> 时间：2009-05-31T13:06:25.340

## 宏

```
#define AssertFileExists(path) NSAssert([[NSFileManager defaultManager] fileExistsAtPath:path], @"Cannot find the file: %@", path)
#define AssertNibExists(file_name_string) AssertFileExists([[NSBundle mainBundle] pathForResource:file_name_string ofType:@"nib"]) 
```

这是一组宏，您可以在尝试加载 a`.xib`或之前调用`.nib`它们，它们将有助于识别丢失的文件并吐出有关确切丢失内容的有用信息。

## 解决方案

**目标-C**：

```
if([[NSBundle mainBundle] pathForResource:fileName ofType:@"nib"] != nil) 
{
    //file found
    ...
} 
```

请注意，文档说明`ofType:`应该是文件的扩展名。然而，即使你使用 .xib，你也需要传递 `@"nib" 否则你会得到一个假阴性。

**斯威夫特**：

```
guard Bundle.main.path(forResource: "FileName", ofType: "nib") != nil else {
       ...
    } 
```

*（参见：[touti](https://stackoverflow.com/users/1160314/touti)的原始答案：[https](https://stackoverflow.com/a/55919888/89035) ://stackoverflow.com/a/55919888/89035 ）*

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2019-04-30T11:25:41.587

快速解决方案：

```
guard Bundle.main.path(forResource: "FileName", ofType: "nib") != nil else {
   ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:41:23.070

我在这里看到两种解决方案。

您可以只调用 initWithNibName:bundle: 并在异常失败时捕获异常（我喜欢这个想法，感觉很健壮）。您可能想要验证该异常实际上是“找不到文件”异常，而不是“内存不足”异常。

或者，您可以先检查 nib 的存在，使用 NSBundle 的 pathForResource:ofType:，它为不存在的文件返回 nil。

# global-variables - 全局变量的问题

> ID：923707
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:29:20.223
> 
>         
> 
> 标签：global-variables, php

我对 OOP 编程有点陌生，所以我很可能犯了一些愚蠢的错误。这是我的问题。运行我的代码时，出现以下错误：

> **致命错误：在第****30**行的**/application/libraries/Session.php 中**的非对象上调用成员函数 checkLogin()

 **下面是 Session.php 文件（我已经注释了第 30 行以便于查找）：

```
<?php
require_once(LIBPATH . 'MySQLDB.php');
require_once(LIBPATH . 'Authentication.php');

class Session {
public $url;
public $referrer;
public $redirect;

function Session() {
    $this->startSession();
}
function startSession() {
    global $auth;

    session_start();

    if (isset($_SESSION['url'])) {
        $this->referrer = $_SESSION['url'];
    } else {
        $this->referrer = '/';
    }
    $this->url = $_SESSION['url'] = $_SERVER['PHP_SELF'];
    if (isset($_SESSION['redirect'])) {
        $this->redirect = $_SESSION['redirect'];
    } else {
        $this->redirect = $_SESSION['redirect'] = '/';
    }

    $auth->checkLogin();         // LINE 30
}
function setRedirect($page) {
    $this->redirect = $_SESSION['redirect'] = $page;
}
} 
```

在我尝试解决问题时，我将 echo gettype($auth) 放在包含和类声明之间。结果输出是“对象”。然后我尝试在 startSession 函数中声明全局 $auth 后立即放置 echo gettype($auth) 。结果输出为“NULL”。知道我的问题可能是什么吗？谢谢。

**编辑：** $auth 在 Authentication.php 中声明

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:33:40.433

没有看到如何`$auth`定义`Authentication.php`，很难提供帮助。

另外，由于您是 OOP 的新手，所以让我第一个告诉您**globals 是 bad**。只是不要使用它们。如果你觉得必须这样做，很可能是因为你的设计不好。您应该重新考虑这一点，而不是使用全局变量来快速解决您的问题。相反，通过执行类似的操作来实例化您的`Authentication`类的新实例

```
$auth = new Authentication; 
```

确保`Authentication`实际上作为一个类和所有东西都正确设置。PHP 的在线文档有一个很好的[OOP 介绍](http://us.php.net/oop)，您可能也想看看。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:38:41.377

问题不在您实际显示的代码中。我非常有信心，真正的问题在于 Session 声明之后但在您实际创建它的实例之前。尝试插入 var_dump($auth); 就在你调用之前`new Session`，看看它是否真的设置在那里。然后您可以向后探测代码并找到它未设置的点。

此外，正如已经提到的：应该避免使用全局变量。更好的解决方案是将其`$auth`作为参数传递给构造函数`Session`并将其存储为类的成员变量。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T03:46:46.340

错误信息：

```
Fatal error: Call to a member function checkLogin() on a non-object in /application/libraries/Session.php on line 30 
```

表示 PHP 在 Authenrication.php 中找不到 checkLogin 函数。确保将 Authentication.php 中的类实例化到 Session.php 或将实例化变量传递给 Session 类。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-05-28T23:37:19.677

确保 $auth 在 Authentication.php 中声明为全局

# vba - 如何在 Outlook VB 宏中按“组”访问项目？

> ID：923711
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:29:47.993
> 
>         
> 
> 标签：vba, outlook

“组”是指启用查看->排列方式->在组中显示时获得的可折叠分类。这将例如文件夹中的消息划分为今天、昨天、上周、两周前等。我希望能够做的是遍历当前在给定组中分类的消息。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T09:32:28.480

是否有您想要的特定组，即今天等。如果是这样，如果您可以重新创建查询和搜索。

这里的例子

[http://msdn.microsoft.com/en-us/library/bb147594.aspx](http://msdn.microsoft.com/en-us/library/bb147594.aspx)

# sql - 从查询中删除双连接结果

> ID：923721
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:32:23.870
> 
>         
> 
> 标签：sql, tsql

我有一个查询，我在其中加入一个表格，以查找零件高度或宽度之间的不匹配。唯一的问题是，由于此连接，它将为每个部分返回每个未匹配项两次。我只想为每个未匹配返回一行，而不是两行。

这是表格：

```
tblTagGlass
JobID varchar
UnitCode varchar
PartCode varchar
PartQty int
TagHeight float
TagWidth float 
```

和查询：

```
select *
from tblTagGlass ttg
inner join tblTagGlass ttgC ON
ttg.JobID = ttgC.JobID
AND ttg.PartCode = ttgC.PartCode
where ttg.TagHeight != ttgC.TagHeight
or ttg.TagWidth != ttgC.TagWidth
order by ttg.PartCode 
```

结果：

```
INC375 U2-052 VT2-011 1 2013   1444.5   INC375 U2-028 VT2-011 1 2012.5 1444.5
INC375 U2-028 VT2-011 1 2012.5 1444.5   INC375 U2-052 VT2-011 1 2013   1444.5 
```

我希望这是有道理的...

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:40:30.187

尝试

```
select *
from tblTagGlass ttg
inner join tblTagGlass ttgC ON
ttg.JobID = ttgC.JobID
AND ttg.PartCode = ttgC.PartCode
where (ttg.TagHeight != ttgC.TagHeight OR ttg.TagWidth != ttgC.TagWidth)
AND ((ttg.TagHeight >= ttgC.TagHeight AND ttg.TagWidth >= ttgC.TagWidth) 
    OR (ttg.TagHeight > ttgC.TagHeight AND ttg.TagWidth < ttgC.TagWidth))
order by ttg.PartCode 
```

不同之处在于使用 > 来比较它们而不是 !=

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:03:53.670

让我们做一个假设：

*   主键（JobCode、UnitCode、PartCode）

您正在寻找的是具有相同 JobCode 和 PartCode 但具有不同 UnitCode 值的项目 - 并且 TagHeight 或 TagWidth （或两者）不同。因此，使用 UnitCode 上的 '>' 技巧来区分行并防止重复，但使用 '!=' 来检测 TagHeight 或 TagWidth 的差异：

```
SELECT *
    FROM tblTagGlass ttg JOIN tblTagGlass ttgC
         ON  ttg.JobID = ttgC.JobID
         AND ttg.PartCode = ttgC.PartCode
         AND ttg.UnitCode > ttgC.UnitCode
    WHERE (ttg.TagHeight != ttgC.TagHeight
       OR ttg.TagWidth != ttgC.TagWidth)
    ORDER BY ttg.PartCode 
```

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-05-28T23:41:29.280

问题变成了，您想要从行中获得哪些信息。它们是不同的行。

如果您只想要零件代码，这将起作用：

```
select ttg.PartCode
from tblTagGlass ttg
inner join tblTagGlass ttgC ON
ttg.JobID = ttgC.JobID
AND ttg.PartCode = ttgC.PartCode
where ttg.TagHeight != ttgC.TagHeight
or ttg.TagWidth != ttgC.TagWidth
group by ttg.PartCode
order by ttg.PartCode 
```

除此之外，您还需要确定跨行所需的信息聚合。

# sql-server - 如何从 ODBC 数据库导入表？

> ID：923731
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:36:31.537
> 
>         
> 
> 标签：sql-server, odbc, sqlbulkcopy

我有一个 ODBC 数据库（一些第三方数据库），其中有一堆表。我可以使用“GetSchema”来获取其中的表列表。我也可以利用 SQLBulkCopy 将这些表中的数据复制到 SQL Server 表中（仅当我在 SQL Server 中创建了具有相同结构的目标表时）。

但这是场景 - 对 ODBC 数据库应用了更新，现在它有一个新表（我可以通过比较 ODBC 数据库中的旧表和新表列表来弄清楚这一点。

有没有办法导入整个表（空或带有数据）或为源表生成 SQL 脚本，以便可以在使用批量复制操作之前创建目标表？

谢谢研发

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T02:22:09.360

为什么不使用导入/导出向导？您可以通过右键单击 SSMS 中的数据库并选择任务 > 导入数据来访问它。

在“选择源表和视图”页面上，单击“编辑映射”和“编辑 SQL”，如果您只想要 CREATE TABLE SQL，否则您也可以使用向导执行导入。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T11:20:40.807

使用 SQL Server 的导入功能将要求 DSN 与 SQL Server 存在于同一台计算机上。在这种情况下，我在另一台机器上有 ODBC 数据库。我还需要自动化这个，所以在这种情况下只有 .NET 解决方案是可行的。我可以在这台机器上安装 .NET 解决方案并通过 .NET SQL 连接提供程序连接到 SQL Server。

谢谢拉胡尔

# javascript - 通过外部接口接收复杂的 javascript 值

> ID：923736
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T23:37:38.303
> 
>         
> 
> 标签：javascript, delphi, com, browser, external

我正在尝试使用提供的外部对象通过 TWebBrowser（使用 TEmbeddedWB）接收并可能发送复杂值。例如; 在javascript中，我会尝试使用带有数组作为参数的暴露方法：

```
var test = [123, 'abc'];
external.someFunction(test);

//Or something more complex
var complexObject = {
  someMethod : function(){ return 1; },
  someProperty : 123,
  someArray : ['xyz', 3.14]
}
external.someFunction(complexObject); 
```

检查这两个示例的 VarType 告诉我这是一个 IDispatch。

```
function TSomeClass.someFunction(var Param : OleVariant) : OleVariant;
var
  vType : Integer;
begin
  vType := (VarType(Param) and VarTypeMask); //Says 9 (varDispatch)
  Result := true;
end; 
```

我对 COM 并不完全熟悉，也不知道如何使用它。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-06-01T13:15:27.123

您可以将 JScript 对象视为任何其他 OleVariant COM 对象。在数组方面有一些陷阱（几乎任何 JScript 对象本质上都是一个稀疏数组）。

将 JScript 对象放入 OleVariant 后，您可以像调用任何普通代码一样简单地调用它（当然无需编译时间检查）。

下面是一些处理数组的代码：

```
type
  TJScriptArray = class
  private
    FArray:   IDispatchEx;
    FCount:   Integer;
    function  GetProperty( const AName: String ): OleVariant;
    function  GetItem(Index: Integer): OleVariant;
  public
    constructor Create( AObj: OleVariant );
    destructor  Destroy; override;
  public
    property  Count: Integer read FCount;
    property  Item[Index: Integer]: OleVariant read GetItem; default;
  end;

function  VarToDispatchEx( const AObject: OleVariant ): IDispatchEx;
begin
  Result := nil;
  if VarType( AObject ) <> varDispatch then
    Exit;
  Supports( IDispatch(AObject), IDispatchEx, Result );
end;

function  IsJScriptArray( const AObject: OleVariant ): Boolean;
var
  temp: IDispatchEx;
begin
  temp := VarToDispatchEx( AObject );
  Result := temp <> nil;
end;

constructor TJScriptArray.Create(AObj: OleVariant);
begin
  inherited Create;
  FArray := VarToDispatchEx( AObj );
  if FArray = nil then
    raise Exception.Create( 'TJscriptArray called with invalid parameters.' );
  FCount := GetProperty( 'length' );
end;

destructor TJScriptArray.Destroy;
begin
  inherited Destroy;
end;

function TJScriptArray.GetItem(Index: Integer): OleVariant;
begin
  if Index > FCount then
    raise Exception.Create( 'Index out of bounds.' );
  Result := GetProperty( IntToStr( Index ) );
end;

function TJScriptArray.GetProperty(const AName: String): OleVariant;
var
  sz: WideString;
  id: Integer;
  res: Variant;
  ei: TExcepInfo;
  params: TDispParams;
  hr: HResult;
begin
  {
    ACTION: return the specified property from the jscript array
    NOTE:   since a jscript array is a sparse array there may be
            gaps. In that case a null variant is returned. This is
            signalled by the name (id) not existing.
  }
  sz := AName;
  hr := FArray.GetDispID( PWideChar(sz), 0, id );
  if hr = disp_e_UnknownName then begin
    Result := Null;
    Exit;
    end
  else
    OleCheck( hr );

  VarClear( res );
  FillChar( ei, sizeof(ei), 0 );
  FillChar( params, sizeof(params), 0 );
  OleCheck( FArray.InvokeEx( id, 0, dispatch_PropertyGet, @params, @res, @ei, nil ) );
  Result := res;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T04:10:25.783

虽然我没有直接做你正在尝试的事情。

使用 Variant，您实际上可以动态访问方法和属性。

基本上我怀疑您应该能够直接访问所有内容。

```
Param.Someproperty
Param.SomeArray[1]
Param.SomeMethod(); 
```

如果你弄错了，你不会得到编译时错误，所以要小心。

例如，以下代码可以编译，但会给出无效变体操作的运行时错误，因为没有动态分配给该变量。

```
var
 vo : OleVariant;
 v  : Variant;
begin
  v.DoThis;
  vo.DoThat;
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T05:28:44.987

您是否考虑过使用 JavaScript Object Notation (JSON) 序列化复杂数据？这将允许您序列化任意 JavaScript 对象，将它们作为简单的字符串传递并在 Delphi 代码中重构它们。

Delphi 2009 支持 JSON 作为新 DataSnap 的一部分（不确定独立使用是否容易）。还有一些可能有用的 Delphi JSON 实现：

签[出 lkjson](http://sourceforge.net/projects/lkjson)和[JSON - SuperObject](http://www.progdigy.com/?page_id=6)

我不是 JSON 方面的专家，但它似乎是一种相对简单有效的跨语言数据交换解决方案。

大卫

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2013-07-24T20:05:47.673

Javascript 中的对象[是关联数组](https://en.wikipedia.org/wiki/JavaScript#Prototype-based_.28Object-oriented.29)，属性名是键：`obj.prop`等价于`obj['prop']`.

常规数组只是将索引存储为属性的对象，因此它们的行为类似于稀疏数组。

Delphi 的 OleVariants 允许直接访问属性，但仅当它们的名称是有效的[Delphi 标识符](http://docwiki.embarcadero.com/RADStudio/en/Fundamental_Syntactic_Elements#Identifiers)时，它不喜欢使用数字索引作为属性名称（即`obj.0`不编译）。

可以读取具有无效标识符名称的属性，`DISPATCH_PROPERTYGET`如[Ryan 的响应](https://stackoverflow.com/a/934774/859646)中那样调用。

然而，Delphi 在`ComObj`单元中包含适当的例程来直接执行此操作：

```
uses ComObj;

...

function TSomeClass.someFunction(var Param : OleVariant) : OleVariant;
begin
  ShowMessage(Param.someProperty); // 123
  ShowMessage(GetDispatchPropValue(Param, 'someProperty')); // 123

  ShowMessage(Param.someArray.length); // 2
  ShowMessage(GetDispatchPropValue(Param.someArray, '0')); // xyz

  Result := true;
end; 
```

# vim - 检测文件更改，提供重新加载文件

> ID：923737
> 
>         
> 
> 赞同：56
> 
>         
> 
> 时间：2009-05-28T23:38:19.863
> 
>         
> 
> 标签：vim

我通常使用 gVim 进行编辑，但有时在远程连接到我的机器时使用 vim。

当我在 gVim 中打开一个文件并且它已经从外部更改（例如来自存储库的新更新）时，gVim 提供重新加载它。

然而，当 Vim 发生这种情况时，在您尝试保存文件之前它什么也不做。它只是警告您文件已更改，但不提供重新加载它。

是否有让 Vim 的行为匹配 gVim 的设置？

* * *

## 回答 #1

> 赞同：60
> 
>             
> 
> 时间：2010-04-28T20:41:48.167

如果要打开更新的文件，请使用

```
:e 
```

它应该重新加载打开的文件。

* * *

## 回答 #2

> 赞同：53
> 
>             
> 
> 时间：2009-05-29T19:09:00.547

正如[ashcatch](https://stackoverflow.com/users/85539/ashcatch)所说，该`:checktime`命令将检查磁盘上的更改并提示您重新加载。所以设置 Vim`checktime`在某些事件之后自动运行。使用哪个事件取决于您。一种可能性是使用`CursorHold`，它在您移动光标然后让它静止`updatetime`几毫秒后触发。（默认 4 秒。）

```
:au CursorHold * checktime 
```

您也可以将其设置为打开，`WinEnter`或者`BufWinEnter`每次在缓冲区/窗口之间切换时它都会更改。如果您真的很偏执，可以将其设置为打开，`CursorMoved`以便每次移动光标时它都会检查磁盘上的文件，但这可能有点矫枉过正并且可能会有点滞后。

见`:h checktime`, `:h updatetime`, `:h autocmd-events-abc`.

* * *

## 回答 #3

> 赞同：25
> 
>             
> 
> 时间：2009-05-29T04:41:30.623

这是使用名为 FileChangedShell 的自动命令完成的。我太新了，无法发布链接，但最好的办法是阅读 vim 文档的 autocmd 部分（谷歌）

但要点是在您的 vimrc 中设置类似于以下行的内容

```
:au FileChangedShell * echo "Warning: File changed on disk" 
```

* * *

## 回答 #4

> 赞同：10
> 
>             
> 
> 时间：2014-09-25T09:56:54.917

为了改进 Carper 的回答：

```
" Run checktime in buffers, but avoiding the "Command Line" (q:) window
au CursorHold * if getcmdwintype() == '' | checktime | endif 
```

如果没有这个检查，如果你尝试使用“命令行”(q:) 缓冲区，Vim 会输出错误，因为这个缓冲区不支持该`:checktime`命令。感谢 #vim 上的 kdlv 发现了这一点。

* * *

## 回答 #5

> 赞同：9
> 
>             
> 
> 时间：2009-05-29T05:41:44.270

您可以使用 手动触发检查`:checktime`。gvim 每次重新获得焦点时都会这样做，因此没有必要经常进行手动检查。

我不知道是否有不同的方法（比如自动检查某个时间间隔）。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2018-01-17T08:53:42.627

从这个[答案](https://stackoverflow.com/a/48296697/4940240)（参考 PhanHaiQuang 的答案[和](https://stackoverflow.com/users/407256/flukus)[flukus](https://stackoverflow.com/users/2467354/phan-hai-quang)的评论）

可以在需要时从 ex (whithin vim) 运行这个 oneliner（或者在打开日志文件时将每个命令放在 vimrc 中。）

`:set autoread | au CursorHold * checktime | call feedkeys("lh")`

解释：

- **autoread**：从外部更改时读取文件（但它本身不起作用，没有内部计时器或类似的东西。它只会在 vim 执行操作时读取文件，就像 ex 中的命令`:!`

- **CursorHold * checktime** : 当光标在 'updatetime' 中指定的时间（默认为 4000 毫秒）内未被用户移动时，执行 checktime，检查文件外部的更改

-**调用 feedkeys("lh")**：光标移动一次，左右移动。然后什么也没有发生（...这意味着，CursorHold 被触发，这意味着我们有一个**循环**）

# c# - 事务性sqlite？在 C# 中

> ID：923740
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-28T23:39:18.270
> 
>         
> 
> 标签：c#, sqlite

我正在编写一个原型应用程序。现在有些事情失败了，比如插入一个非唯一的列。在这种情况下，我想回滚我所做的一切。我怎么做？我还注意到在sqlite中我需要提交数据，在C#中它似乎是自动完成的，这让我怀疑有一个自动回滚选项？

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-05-28T23:43:41.053

回滚：看起来您正在寻找的是命令文本“INSERT OR ROLLBACK ...”

事务：sqlite 自动将每个命令放入自己的事务中，除非您明确说明何时开始。编辑：TML 在他的回答中更深入地解释了这部分

显式打开/提交事务的示例是：

```
using (DbTransaction dbTrans = myDBConnection.BeginTransaction())
{
     using (DbCommand cmd = myDBConnection.CreateCommand())
     {
         ...
     }
     dbTrans.Commit();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-05-28T23:43:03.037

[SQLite.org](http://www.sqlite.org/lockingv3.html)说：

> SQLite 版本 3 中对锁定和并发控制的更改还对事务在 SQL 语言级别的工作方式进行了一些细微的更改。默认情况下，SQLite 版本 3 在自动提交模式下运行。在自动提交模式下，一旦与当前数据库连接关联的所有操作完成，就会提交对数据库的所有更改。
> 
>   
>   
> 
> SQL 命令“BEGIN TRANSACTION”（TRANSACTION 关键字是可选的）用于使 SQLite 退出自动提交模式。请注意，BEGIN 命令不会获取数据库上的任何锁。在 BEGIN 命令之后，执行第一个 SELECT 语句时将获取一个 SHARED 锁。当执行第一个 INSERT、UPDATE 或 DELETE 语句时，将获取一个 RESERVED 锁。在内存缓存填满并且必须溢出到磁盘或事务提交之前，不会获取独占锁。这样，系统将阻止对文件文件的读取访问延迟到最后可能的时刻。

# iphone - iPhone 上的音频引擎

> ID：923759
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:44:55.840
> 
>         
> 
> 标签：iphone

我想为 iPhone 开发一个 voip 应用程序。你能告诉我如何才能获得良好的语音质量吗？我应该如何开始为 iPhone 开发一个好的音频引擎？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T06:54:14.977

如果你不够了解你需要回答这个问题，我会从别处开始。VoIP 是一个棘手的领域。

如果您必须这样做（即这是您的工作而您别无选择），我将从一些开源语音音频编解码器开始，例如[speex](http://www.speex.org/)。你可以把它移植到 iPhone 上，或者用它来学习。

# php - 编码标准：大量参数

> ID：923760
> 
>         
> 
> 赞同：14
> 
>         
> 
> 时间：2009-05-28T23:46:54.493
> 
>         
> 
> 标签：php, oop

嘿，我是刚毕业的大学生。我正在做一个我希望最终由其他人维护的项目。我一直在这个项目中遇到一个烦人的情况，那就是需要许多私有变量的对象，因此需要很长的构造函数。

除了变量命名之外，没有强制执行任何编码标准。我想知道如何处理这种情况。有时我担心我将来会在dailywtf上看到一些我自己的代码！

我很想尝试将其中一些争论包含在其他课程中，但在这种情况下，它真的没有意义。

这是一个完全没有问题的问题，还是应该而且很容易纠正的事情？

```
public function __construct($uCode = '', $uName = '', $uTime = '', $uArea = '', $uDomain = '', $uText = '', $uId = '', $uNum = '', $uVideo = 0, $uAudio = 0, $uImage = 0){ 
```

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-05-28T23:49:05.160

一般来说，如果你有超过 4 个参数，你最好使用临时对象或数组来代替。通常许多参数是可选的，这会变得非常尴尬并且很快就会出错。所以：

```
class MyClass {
  public function __construct($options) { ... }
...
}

$o = new MyClass(array(
  'uCode' => 'some value',
  'uText' => 'another value',
)); 
```

将其与以下内容进行比较：

```
$o = new MyClass('some value', '', '', '', '', 'another value'); 
```

请注意数组版本如何仅包含您要传递的内容。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T00:07:44.420

我倾向于倾向于 cletus 的解决方案，但另一种选择是使用 set() 函数来处理构造函数中并非绝对必要的任何值。

例如，如果需要 $uCode 和 $uName，但其余的都是可选的...

```
public function __construct($uCode = '', $uName = '') {}
public function setUTime($uTime) {}
public function setUArea($uArea) {}
... 
```

有时让你的设置器返回 $this 很有用，这样你就可以链接命令，如下所示：

```
$object = new MyObject($code, $name);
$object->setUTime($time)->setUArea($area)->...; 
```

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T00:02:06.243

使用构建器模式..在这里

[http://en.wikipedia.org/wiki/Builder_pattern](http://en.wikipedia.org/wiki/Builder_pattern)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:53:59.543

如果您有太多参数，则表明您的方法可能做得太多。尝试是否可以将任务分解为许多较小的任务并重构方法。如果失败，传入一个包含所有参数的类应该没问题。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T02:40:12.727

您可以将这么多参数分配给一个数组，然后将该数组传递给您的 __construct，这样您就只能有一个数组参数。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-06-01T23:52:55.260

你可以使用魔术方法

```
class abc {

    private $allowed = array(
        'uCode',
        'uId'
    );

    public function __set($name, $value) {
        if (in_array($name, $this->allowed)) {
            $this->$name = $value;
        }
    }

    public function __call($name, $args) {
        if (substr($name, 0, 4) == "set_") {
            $var = substr($name, 4);
            if (in_array($var, $this->allowed)) {
                $this->$var = $args[0];
            }
        }
    }

}

$abc = abc();
$abc->uCode = 123;
$abc->set_uId(123); 
```

# c# - C# Web 应用程序中的常量

> ID：923762
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-28T23:48:58.843
> 
>         
> 
> 标签：c#, .net, constants

为一分钱的价值创建一个常数是否有意义？例如，如果我需要将金额减少一美分。如果代码说：你认为它更具可读性吗？

```
amount -= Constants.StandardAmounts.Penny 
```

或者我是否应该不打扰而只使用 0.01。

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-05-28T23:57:10.153

在您的具体示例中，该特定常量并没有真正意义。减去一美分的两种最可能的情况是：

*   满足一些非常具体的业务/领域逻辑要求：

    如果是这样，常数不应该是`Penny = .01`，而是`StandardDeduction = .01`

*   处理更多任意/流动的数学：

    如果是这样，只需使用数字。

无论哪种情况，“Penny”都是毫无意义的。它没有添加任何有用的信息。这就像声明`constant HelloWorld = "HelloWorld"`. 每个对您的应用程序正在做什么（财务计算）甚至有模糊概念的程序员都了解 .01 是什么。常量应该由目的驱动。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:50:15.377

我会使用常数。不是因为一分钱的价值会改变，而只是为了让应用程序的未来维护者更清楚。

编辑：我想我也会考虑使用这个值的地方的数量。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T23:52:00.897

您甚至可以更改为以获得更好的可读性：

```
amount -= Standards.USCurrency.Penny 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T02:53:50.780

我会将递减放入一个方法中，然后适当地命名该方法（即远离标题中的一分钱）。因此，例如，如果您有一个超市应用程序并且每个客户都获得 1 美分的折扣，您可以调用 DeductCustomerLoyaltyAmount()。这有以下优点：

1.  任何阅读代码的人现在都可以**完全**理解为什么会发生递减。

2.  您可以更改递减值而不影响方法的含义。

3.  您的全球化代码（用于处理其他货币）是集中的。

# vb.net - 表单弹出窗口和交互

> ID：923766
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:49:59.403
> 
>         
> 
> 标签：vb.net, forms

如何让 Visual Basic 使用代码打开另一个表单？我曾多次尝试用谷歌搜索该解决方案，但从未找到任何可行的方法。

另外，VB 表单是否共享变量？有没有办法让一个表单将数据发送到另一个表单？

我知道这应该很简单，但我就是想不通。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-08T16:14:32.120

表单只不过是类，因此通过创建公共方法、属性或变量，您已经有可能在它们之间进行通信。您可以像创建对象一样创建新表单

```
Dim Frm As New MyNiceForm 
```

然后用`.Show`or显示它们`.ShowDialog`。

# c++ - 如何制作文件名和设置扩展名

> ID：923768
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:50:23.707
> 
>         
> 
> 标签：c++

```
#include <iostream>
#include <fstream>

using namespace std;
int main()
{
  string name;
  cout<<"What would you like new html file to be named?"<<endl;
  getline(cin,name);
  cout<<"Creating New Html File...Moment."<<endl;
  ofstream myfile (name);
  if(myfile.is_open())
  {                
  }
} 
```

我需要制作带有 .html 扩展名的 myfile 有人可以告诉我如何或给我写代码吗？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-05-28T23:54:09.317

```
string name;
cout<<"What would you like new html file to be named?"<<endl;
getline(cin,name);
cout<<"Creating New Html File...Moment."<<endl;

name+=".html"; // the crucial ommision?

ofstream myfile (name); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-28T23:55:48.610

您只需添加`.html`到文件名的末尾：

```
name.append(".html"); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T14:47:42.510

您是否要考虑用户输入的文件名已经以 ".html" 结尾的可能性？`name.substr(name.size()-5)`  在这种情况下，当然，在您检查名称中至少有 6 个字符之后，您可以使用 - 获得后缀。

# c# - 将基数为 10 的数字转换为 .NET 中任何基数的最快方法？

> ID：923771
> 
>         
> 
> 赞同：127
> 
>         
> 
> 时间：2009-05-28T23:50:51.930
> 
>         
> 
> 标签：c#, .net, int, base, number-systems

我有一个我写的旧的（ish）C#方法，它接受一个数字并将其转换为任何基数：

```
string ConvertToBase(int number, char[] baseChars); 
```

这并不是那么超级快速和整洁。在 .NET 中是否有一种好的、已知的方法来实现这一点？

我正在寻找允许我使用**任何**带有任意字符串的基础的东西。

这仅允许碱基 16、10、8 和 2：

```
Convert.ToString(1, x); 
```

我想用它来利用数字、所有小写字母和所有大写字母来实现非常高的基数。就像在[这个线程](https://stackoverflow.com/questions/656941/converting-decimals-to-sexagesimal-base-sixty-in-javascript)中一样，但对于 C# 而不是 JavaScript。

有谁知道在 C# 中执行此操作的好方法吗？

* * *

## 回答 #1

> 赞同：151
> 
>             
> 
> 时间：2009-05-29T00:03:24.803

[`Convert.ToString`](http://msdn.microsoft.com/en-us/library/14kwkz77.aspx)可用于将数字转换为指定基数中的等效字符串表示形式。

例子：

```
string binary = Convert.ToString(5, 2); // convert 5 to its binary representation
Console.WriteLine(binary);              // prints 101 
```

但是，正如评论所指出的，`Convert.ToString`仅支持以下有限但通常足够的基数集：2、8、10 或 16。

### 更新（以满足转换为任何基础的要求）：

我不知道 BCL 中有任何方法能够将数字转换为任何基数，因此您必须编写自己的小型实用程序函数。一个简单的示例看起来像这样（请注意，这肯定可以通过替换字符串连接来更快）：

```
class Program
{
    static void Main(string[] args)
    {
        // convert to binary
        string binary = IntToString(42, new char[] { '0', '1' });

        // convert to hexadecimal
        string hex = IntToString(42, 
            new char[] { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
                         'A', 'B', 'C', 'D', 'E', 'F'});

        // convert to hexavigesimal (base 26, A-Z)
        string hexavigesimal = IntToString(42, 
            Enumerable.Range('A', 26).Select(x => (char)x).ToArray());

        // convert to sexagesimal
        string xx = IntToString(42, 
            new char[] { '0','1','2','3','4','5','6','7','8','9',
            'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z',
            'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x'});
    }

    public static string IntToString(int value, char[] baseChars)
    {
        string result = string.Empty;
        int targetBase = baseChars.Length;

        do
        {
            result = baseChars[value % targetBase] + result;
            value = value / targetBase;
        } 
        while (value > 0);

        return result;
    }

    /// <summary>
    /// An optimized method using an array as buffer instead of 
    /// string concatenation. This is faster for return values having 
    /// a length > 1.
    /// </summary>
    public static string IntToStringFast(int value, char[] baseChars)
    {
        // 32 is the worst cast buffer size for base 2 and int.MaxValue
        int i = 32;
        char[] buffer = new char[i];
        int targetBase= baseChars.Length;

        do
        {
            buffer[--i] = baseChars[value % targetBase];
            value = value / targetBase;
        }
        while (value > 0);

        char[] result = new char[32 - i];
        Array.Copy(buffer, i, result, 0, 32 - i);

        return new string(result);
    }
} 
```

### 更新 2（性能改进）

使用数组缓冲区而不是字符串连接来构建结果字符串可以提高性能，尤其是在大数字上（参见方法`IntToStringFast`）。在最好的情况下（即最长可能的输入），这种方法大约快三倍。但是，对于 1 位数字（即目标基数中的 1 位数字），`IntToString`会更快。

* * *

## 回答 #2

> 赞同：87
> 
>             
> 
> 时间：2012-06-11T13:31:47.880

[**我最近写了一篇关于这个的博客**](http://www.pvladov.com/2012/05/decimal-to-arbitrary-numeral-system.html)。我的实现在计算过程中不使用任何字符串操作，这使得它**非常快**。支持转换为以 2 到 36 为基数的任何数字系统：

```
/// <summary>
/// Converts the given decimal number to the numeral system with the
/// specified radix (in the range [2, 36]).
/// </summary>
/// <param name="decimalNumber">The number to convert.</param>
/// <param name="radix">The radix of the destination numeral system (in the range [2, 36]).</param>
/// <returns></returns>
public static string DecimalToArbitrarySystem(long decimalNumber, int radix)
{
    const int BitsInLong = 64;
    const string Digits = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";

    if (radix < 2 || radix > Digits.Length)
        throw new ArgumentException("The radix must be >= 2 and <= " + Digits.Length.ToString());

    if (decimalNumber == 0)
        return "0";

    int index = BitsInLong - 1;
    long currentNumber = Math.Abs(decimalNumber);
    char[] charArray = new char[BitsInLong];

    while (currentNumber != 0)
    {
        int remainder = (int)(currentNumber % radix);
        charArray[index--] = Digits[remainder];
        currentNumber = currentNumber / radix;
    }

    string result = new String(charArray, index + 1, BitsInLong - index - 1);
    if (decimalNumber < 0)
    {
        result = "-" + result;
    }

    return result;
} 
```

我还实现了一个快速反函数，以防万一有人需要它：
 [**Arbitrary to Decimal Numeral System**](http://www.pvladov.com/2012/07/arbitrary-to-decimal-numeral-system.html)。

* * *

## 回答 #3

> 赞同：22
> 
>             
> 
> 时间：2016-01-25T23:26:39.803

**快速“*从*”和“*到*”方法**

我参加聚会迟到了，但我将以前的答案复合并改进了它们。我认为这两种方法比迄今为止发布的任何其他方法都快。我能够在单核机器上在不到 400 毫秒的时间内将 1,000,000 个数字从 36 转换为 36。

下面的示例适用于**base 62**。更改`BaseChars`数组以在任何其他基础之间进行转换。

```
private static readonly char[] BaseChars = 
         "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".ToCharArray();
private static readonly Dictionary<char, int> CharValues = BaseChars
           .Select((c,i)=>new {Char=c, Index=i})
           .ToDictionary(c=>c.Char,c=>c.Index);

public static string LongToBase(long value)
{
   long targetBase = BaseChars.Length;
   // Determine exact number of characters to use.
   char[] buffer = new char[Math.Max( 
              (int) Math.Ceiling(Math.Log(value + 1, targetBase)), 1)];

   var i = buffer.Length;
   do
   {
       buffer[--i] = BaseChars[value % targetBase];
       value = value / targetBase;
   }
   while (value > 0);

   return new string(buffer, i, buffer.Length - i);
}

public static long BaseToLong(string number) 
{ 
    char[] chrs = number.ToCharArray(); 
    int m = chrs.Length - 1; 
    int n = BaseChars.Length, x;
    long result = 0; 
    for (int i = 0; i < chrs.Length; i++)
    {
        x = CharValues[ chrs[i] ];
        result += x * (long)Math.Pow(n, m--);
    }
    return result;  
} 
```

**编辑（2018-07-12）**

已修复以解决 @AdrianBotor 发现的极端情况（见注释）将 46655 转换为基数 36。这是由一个小的浮点错误计算导致的，该错误`Math.Log(46656, 36)`恰好是 3，但 .NET 返回`3 + 4.44e-16`，这会导致输出缓冲区中出现额外字符.

* * *

## 回答 #4

> 赞同：11
> 
>             
> 
> 时间：2014-09-09T21:23:03.243

也可以使用已接受版本的略微修改版本，并根据需要调整基本字符串：

```
public static string Int32ToString(int value, int toBase)
{
    string result = string.Empty;
    do
    {
        result = "0123456789ABCDEF"[value % toBase] + result;
        value /= toBase;
    }
    while (value > 0);

    return result;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2014-02-04T10:02:25.563

参加这个聚会很晚，但我最近为一个工作项目编写了以下帮助类。它旨在将短字符串转换为数字并再次转换回来（一个简单的[完美哈希](http://en.wikipedia.org/wiki/Perfect_hash_function)函数），但它也将执行任意基数之间的数字转换。该`Base10ToString`方法实现回答了最初发布的问题。

需要传递给类构造函数的`shouldSupportRoundTripping`标志，以防止在转换为 base-10 并再次返回期间丢失数字字符串中的前导数字（鉴于我的要求，这很重要！）。大多数情况下，数字字符串中前导 0 的丢失可能不会成为问题。

无论如何，这是代码：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace StackOverflow
{
    /// <summary>
    /// Contains methods used to convert numbers between base-10 and another numbering system.
    /// </summary>
    /// <remarks>
    /// <para>
    /// This conversion class makes use of a set of characters that represent the digits used by the target
    /// numbering system. For example, binary would use the digits 0 and 1, whereas hex would use the digits
    /// 0 through 9 plus A through F. The digits do not have to be numerals.
    /// </para>
    /// <para>
    /// The first digit in the sequence has special significance. If the number passed to the
    /// <see cref="StringToBase10"/> method has leading digits that match the first digit, then those leading
    /// digits will effectively be 'lost' during conversion. Much of the time this won't matter. For example,
    /// "0F" hex will be converted to 15 decimal, but when converted back to hex it will become simply "F",
    /// losing the leading "0". However, if the set of digits was A through Z, and the number "ABC" was
    /// converted to base-10 and back again, then the leading "A" would be lost. The <see cref="System.Boolean"/>
    /// flag passed to the constructor allows 'round-tripping' behaviour to be supported, which will prevent
    /// leading digits from being lost during conversion.
    /// </para>
    /// <para>
    /// Note that numeric overflow is probable when using longer strings and larger digit sets.
    /// </para>
    /// </remarks>
    public class Base10Converter
    {
        const char NullDigit = '\0';

        public Base10Converter(string digits, bool shouldSupportRoundTripping = false)
            : this(digits.ToCharArray(), shouldSupportRoundTripping)
        {
        }

        public Base10Converter(IEnumerable<char> digits, bool shouldSupportRoundTripping = false)
        {
            if (digits == null)
            {
                throw new ArgumentNullException("digits");
            }

            if (digits.Count() == 0)
            {
                throw new ArgumentException(
                    message: "The sequence is empty.",
                    paramName: "digits"
                    );
            }

            if (!digits.Distinct().SequenceEqual(digits))
            {
                throw new ArgumentException(
                    message: "There are duplicate characters in the sequence.",
                    paramName: "digits"
                    );
            }

            if (shouldSupportRoundTripping)
            {
                digits = (new[] { NullDigit }).Concat(digits);
            }

            _digitToIndexMap =
                digits
                .Select((digit, index) => new { digit, index })
                .ToDictionary(keySelector: x => x.digit, elementSelector: x => x.index);

            _radix = _digitToIndexMap.Count;

            _indexToDigitMap =
                _digitToIndexMap
                .ToDictionary(keySelector: x => x.Value, elementSelector: x => x.Key);
        }

        readonly Dictionary<char, int> _digitToIndexMap;
        readonly Dictionary<int, char> _indexToDigitMap;
        readonly int _radix;

        public long StringToBase10(string number)
        {
            Func<char, int, long> selector =
                (c, i) =>
                {
                    int power = number.Length - i - 1;

                    int digitIndex;
                    if (!_digitToIndexMap.TryGetValue(c, out digitIndex))
                    {
                        throw new ArgumentException(
                            message: String.Format("Number contains an invalid digit '{0}' at position {1}.", c, i),
                            paramName: "number"
                            );
                    }

                    return Convert.ToInt64(digitIndex * Math.Pow(_radix, power));
                };

            return number.Select(selector).Sum();
        }

        public string Base10ToString(long number)
        {
            if (number < 0)
            {
                throw new ArgumentOutOfRangeException(
                    message: "Value cannot be negative.",
                    paramName: "number"
                    );
            }

            string text = string.Empty;

            long remainder;
            do
            {
                number = Math.DivRem(number, _radix, out remainder);

                char digit;
                if (!_indexToDigitMap.TryGetValue((int) remainder, out digit) || digit == NullDigit)
                {
                    throw new ArgumentException(
                        message: "Value cannot be converted given the set of digits used by this converter.",
                        paramName: "number"
                        );
                }

                text = digit + text;
            }
            while (number > 0);

            return text;
        }
    }
} 
```

这也可以被子类化以派生自定义数字转换器：

```
namespace StackOverflow
{
    public sealed class BinaryNumberConverter : Base10Converter
    {
        public BinaryNumberConverter()
            : base(digits: "01", shouldSupportRoundTripping: false)
        {
        }
    }

    public sealed class HexNumberConverter : Base10Converter
    {
        public HexNumberConverter()
            : base(digits: "0123456789ABCDEF", shouldSupportRoundTripping: false)
        {
        }
    }
} 
```

代码将像这样使用：

```
using System.Diagnostics;

namespace StackOverflow
{
    class Program
    {
        static void Main(string[] args)
        {
            {
                var converter = new Base10Converter(
                    digits: "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz",
                    shouldSupportRoundTripping: true
                    );

                long number = converter.StringToBase10("Atoz");
                string text = converter.Base10ToString(number);
                Debug.Assert(text == "Atoz");
            }

            {
                var converter = new HexNumberConverter();

                string text = converter.Base10ToString(255);
                long number = converter.StringToBase10(text);
                Debug.Assert(number == 255);
            }
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T07:37:34.720

[这个论坛帖子](http://www.vbforums.com/showthread.php?t=271359)中的这门课可以帮助你吗？

```
public class BaseConverter { 

public static string ToBase(string number, int start_base, int target_base) { 

  int base10 = this.ToBase10(number, start_base); 
  string rtn = this.FromBase10(base10, target_base); 
  return rtn; 

} 

public static int ToBase10(string number, int start_base) { 

  if (start_base < 2 || start_base > 36) return 0; 
  if (start_base == 10) return Convert.ToInt32(number); 

  char[] chrs = number.ToCharArray(); 
  int m = chrs.Length - 1; 
  int n = start_base; 
  int x; 
  int rtn = 0; 

  foreach(char c in chrs) { 

    if (char.IsNumber(c)) 
      x = int.Parse(c.ToString()); 
    else 
      x = Convert.ToInt32(c) - 55; 

    rtn += x * (Convert.ToInt32(Math.Pow(n, m))); 

    m--; 

  } 

  return rtn; 

} 

public static string FromBase10(int number, int target_base) { 

  if (target_base < 2 || target_base > 36) return ""; 
  if (target_base == 10) return number.ToString(); 

  int n = target_base; 
  int q = number; 
  int r; 
  string rtn = ""; 

  while (q >= n) { 

    r = q % n; 
    q = q / n; 

    if (r < 10) 
      rtn = r.ToString() + rtn; 
    else 
      rtn = Convert.ToChar(r + 55).ToString() + rtn; 

  } 

  if (q < 10) 
    rtn = q.ToString() + rtn; 
  else 
    rtn = Convert.ToChar(q + 55).ToString() + rtn; 

  return rtn; 

} 

} 
```

完全未经测试......让我知道它是否有效！（复制粘贴它以防论坛帖子消失或其他...）

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2011-11-05T16:48:02.023

我也在寻找一种将十进制数转换为 [2..36] 范围内的另一个基数的快速方法，因此我开发了以下代码。它易于遵循，并使用 Stringbuilder 对象作为字符缓冲区的代理，我们可以逐个字符地索引该字符缓冲区。与替代代码相比，该代码似乎非常快，并且比初始化字符数组中的单个字符要快得多。

对于您自己的使用，您可能更喜欢： 1/ 返回一个空白字符串而不是抛出异常。2/ 删除基数检查以使该方法运行得更快 3/ 用 32 个 '0' 初始化 Stringbuilder 对象并删除行 result.Remove(0, i);。这将导致字符串返回前导零并进一步提高速度。4/ 使 Stringbuilder 对象成为类中的静态字段，因此无论调用多少次 DecimalToBase 方法，Stringbuilder 对象都只会初始化一次。如果您执行此更改，上面的 3 将不再起作用。

我希望有人觉得这很有用:)

原子悖论

```
 static string DecimalToBase(int number, int radix)
    {
        // Check that the radix is between 2 and 36 inclusive
        if ( radix < 2 || radix > 36 )
            throw new ArgumentException("ConvertToBase(int number, int radix) - Radix must be between 2 and 36.");

        // Create a buffer large enough to hold the largest int value represented in binary digits 
        StringBuilder result = new StringBuilder("                                ");  // 32 spaces

        // The base conversion calculates the digits in reverse order so use
        // an index to point to the last unused space in our buffer
        int i = 32; 

        // Convert the number to the new base
        do
        {
            int remainder = number % radix;
            number = number / radix;
            if(remainder <= 9)
                result[--i] = (char)(remainder + '0');  // Converts [0..9] to ASCII ['0'..'9']
            else
                result[--i] = (char)(remainder + '7');  // Converts [10..36] to ASCII ['A'..'Z']
        } while ( number > 0 );

        // Remove the unwanted padding from the front of our buffer and return the result
        // Note i points to the last unused character in our buffer
        result.Remove( 0, i );
        return (result.ToString());
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2016-07-23T09:50:06.397

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConvertToAnyBase
{
   class Program
    {
        static void Main(string[] args)
        {
            var baseNumber = int.Parse(Console.ReadLine());
            var number = int.Parse(Console.ReadLine());
            string conversion = "";

            while(number!=0)
            {

                conversion += Convert.ToString(number % baseNumber);
                number = number / baseNumber;
            }
            var conversion2 = conversion.ToArray().Reverse();
            Console.WriteLine(string.Join("", conversion2));

       }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2020-06-16T06:21:21.520

这是一种相当简单的方法，但它可能不是最快的。它非常强大，因为它是可组合的。

```
public static IEnumerable<int> ToBase(this int x, int b)
{
    IEnumerable<int> ToBaseReverse()
    {
        if (x == 0)
        {
            yield return 0;
            yield break;
        }
        int z = x;
        while (z > 0)
        {
            yield return z % b;
            z = z / b;
        }
    }

    return ToBaseReverse().Reverse();
} 
```

将它与这个简单的扩展方法结合起来，现在可以得到任何基础：

```
public static string ToBase(this int number, string digits) =>
    String.Concat(number.ToBase(digits.Length).Select(x => digits[x])); 
```

它可以这样使用：

```
var result = 23.ToBase("01");
var result2 = 23.ToBase("012X");

Console.WriteLine(result);
Console.WriteLine(result2); 
```

输出是：

```
10111
11X

```

* * *

## 回答 #10

> 赞同：-1
> 
>             
> 
> 时间：2011-09-22T21:17:06.333

我使用它来将 Guid 存储为较短的字符串（但仅限于使用 106 个字符）。如果有人对此感兴趣，是我将字符串解码回数值的代码（在这种情况下，我使用 2 ulongs 作为 Guid 值，而不是对 Int128 进行编码（因为我使用的是 3.5 而不是 4.0）。为了清楚起见，代码是具有 106 个唯一字符的字符串 const。ConvertLongsToBytes 非常令人兴奋。

```
private static Guid B106ToGuid(string pStr)
    {
        try
        {
            ulong tMutl = 1, tL1 = 0, tL2 = 0, targetBase = (ulong)CODE.Length;
            for (int i = 0; i < pStr.Length / 2; i++)
            {
                tL1 += (ulong)CODE.IndexOf(pStr[i]) * tMutl;
                tL2 += (ulong)CODE.IndexOf(pStr[pStr.Length / 2 + i]) * tMutl;
                tMutl *= targetBase;
            }
            return new Guid(ConvertLongsToBytes(tL1, tL2));
        }
        catch (Exception ex)
        {
            throw new Exception("B106ToGuid failed to convert string to Guid", ex);
        }
    } 
```

* * *

## 回答 #11

> 赞同：-1
> 
>             
> 
> 时间：2012-03-17T00:01:25.910

我也有类似的需求，除了我还需要对“数字”进行数学运算。我在这里接受了一些建议，并创建了一个类来完成所有这些有趣的事情。它允许使用任何 unicode 字符来表示一个数字，并且它也适用于小数。

这个类很容易使用。只需创建一个数字作为类型`New BaseNumber`，设置一些属性，然后关闭。例程会自动在基数 10 和基数 x 之间切换，并且您设置的值保留在您设置的基数中，因此不会丢失准确性（直到转换，但即使这样，精度损失也应该非常小，因为这常规使用`Double`和`Long`尽可能）。

我无法控制这个程序的速度。它可能很慢，所以我不确定它是否适合提出问题的人的需求，但它肯定是灵活的，所以希望其他人可以使用它。

对于可能需要此代码来计算 Excel 中的下一列的其他任何人，我将包括我使用的利用此类的循环代码。

```
Public Class BaseNumber

    Private _CharacterArray As List(Of Char)

    Private _BaseXNumber As String
    Private _Base10Number As Double?

    Private NumberBaseLow As Integer
    Private NumberBaseHigh As Integer

    Private DecimalSeparator As Char = System.Globalization.CultureInfo.CurrentCulture.NumberFormat.NumberDecimalSeparator
    Private GroupSeparator As Char = System.Globalization.CultureInfo.CurrentCulture.NumberFormat.NumberGroupSeparator

    Public Sub UseCapsLetters()
        'http://unicodelookup.com
        TrySetBaseSet(65, 90)
    End Sub

    Public Function GetCharacterArray() As List(Of Char)
        Return _CharacterArray
    End Function

    Public Sub SetCharacterArray(CharacterArray As String)
        _CharacterArray = New List(Of Char)
        _CharacterArray.AddRange(CharacterArray.ToList)

        TrySetBaseSet(_CharacterArray)
    End Sub

    Public Sub SetCharacterArray(CharacterArray As List(Of Char))
        _CharacterArray = CharacterArray
        TrySetBaseSet(_CharacterArray)
    End Sub

    Public Sub SetNumber(Value As String)
        _BaseXNumber = Value
        _Base10Number = Nothing
    End Sub

    Public Sub SetNumber(Value As Double)
        _Base10Number = Value
        _BaseXNumber = Nothing
    End Sub

    Public Function GetBaseXNumber() As String
        If _BaseXNumber IsNot Nothing Then
            Return _BaseXNumber
        Else
            Return ToBaseString()
        End If
    End Function

    Public Function GetBase10Number() As Double
        If _Base10Number IsNot Nothing Then
            Return _Base10Number
        Else
            Return ToBase10()
        End If
    End Function

    Private Sub TrySetBaseSet(Values As List(Of Char))
        For Each value As Char In _BaseXNumber
            If Not Values.Contains(value) Then
                Throw New ArgumentOutOfRangeException("The string has a value, " & value & ", not contained in the selected 'base' set.")
                _CharacterArray.Clear()
                DetermineNumberBase()
            End If
        Next

        _CharacterArray = Values

    End Sub

    Private Sub TrySetBaseSet(LowValue As Integer, HighValue As Integer)

        Dim HighLow As KeyValuePair(Of Integer, Integer) = GetHighLow()

        If HighLow.Key < LowValue OrElse HighLow.Value > HighValue Then
            Throw New ArgumentOutOfRangeException("The string has a value not contained in the selected 'base' set.")
            _CharacterArray.Clear()
            DetermineNumberBase()
        End If

        NumberBaseLow = LowValue
        NumberBaseHigh = HighValue

    End Sub

    Private Function GetHighLow(Optional Values As List(Of Char) = Nothing) As KeyValuePair(Of Integer, Integer)
        If Values Is Nothing Then
            Values = _BaseXNumber.ToList
        End If

        Dim lowestValue As Integer = Convert.ToInt32(Values(0))
        Dim highestValue As Integer = Convert.ToInt32(Values(0))

        Dim currentValue As Integer

        For Each value As Char In Values

            If value <> DecimalSeparator AndAlso value <> GroupSeparator Then
                currentValue = Convert.ToInt32(value)
                If currentValue > highestValue Then
                    highestValue = currentValue
                End If
                If currentValue < lowestValue Then
                    currentValue = lowestValue
                End If
            End If
        Next

        Return New KeyValuePair(Of Integer, Integer)(lowestValue, highestValue)

    End Function

    Public Sub New(BaseXNumber As String)
        _BaseXNumber = BaseXNumber
        DetermineNumberBase()
    End Sub

    Public Sub New(BaseXNumber As String, NumberBase As Integer)
        Me.New(BaseXNumber, Convert.ToInt32("0"c), NumberBase)
    End Sub

    Public Sub New(BaseXNumber As String, NumberBaseLow As Integer, NumberBaseHigh As Integer)
        _BaseXNumber = BaseXNumber
        Me.NumberBaseLow = NumberBaseLow
        Me.NumberBaseHigh = NumberBaseHigh
    End Sub

    Public Sub New(Base10Number As Double)
        _Base10Number = Base10Number
    End Sub

    Private Sub DetermineNumberBase()
        Dim highestValue As Integer

        Dim currentValue As Integer

        For Each value As Char In _BaseXNumber

            currentValue = Convert.ToInt32(value)
            If currentValue > highestValue Then
                highestValue = currentValue
            End If
        Next

        NumberBaseHigh = highestValue
        NumberBaseLow = Convert.ToInt32("0"c) 'assume 0 is the lowest

    End Sub

    Private Function ToBaseString() As String
        Dim Base10Number As Double = _Base10Number

        Dim intPart As Long = Math.Truncate(Base10Number)
        Dim fracPart As Long = (Base10Number - intPart).ToString.Replace(DecimalSeparator, "")

        Dim intPartString As String = ConvertIntToString(intPart)
        Dim fracPartString As String = If(fracPart <> 0, DecimalSeparator & ConvertIntToString(fracPart), "")

        Return intPartString & fracPartString

    End Function

    Private Function ToBase10() As Double
        Dim intPartString As String = _BaseXNumber.Split(DecimalSeparator)(0).Replace(GroupSeparator, "")
        Dim fracPartString As String = If(_BaseXNumber.Contains(DecimalSeparator), _BaseXNumber.Split(DecimalSeparator)(1), "")

        Dim intPart As Long = ConvertStringToInt(intPartString)
        Dim fracPartNumerator As Long = ConvertStringToInt(fracPartString)
        Dim fracPartDenominator As Long = ConvertStringToInt(GetEncodedChar(1) & String.Join("", Enumerable.Repeat(GetEncodedChar(0), fracPartString.ToString.Length)))

        Return Convert.ToDouble(intPart + fracPartNumerator / fracPartDenominator)

    End Function

    Private Function ConvertIntToString(ValueToConvert As Long) As String
        Dim result As String = String.Empty
        Dim targetBase As Long = GetEncodingCharsLength()

        Do
            result = GetEncodedChar(ValueToConvert Mod targetBase) & result
            ValueToConvert = ValueToConvert \ targetBase
        Loop While ValueToConvert > 0

        Return result
    End Function

    Private Function ConvertStringToInt(ValueToConvert As String) As Long
        Dim result As Long
        Dim targetBase As Integer = GetEncodingCharsLength()
        Dim startBase As Integer = GetEncodingCharsStartBase()

        Dim value As Char
        For x As Integer = 0 To ValueToConvert.Length - 1
            value = ValueToConvert(x)
            result += GetDecodedChar(value) * Convert.ToInt32(Math.Pow(GetEncodingCharsLength, ValueToConvert.Length - (x + 1)))
        Next

        Return result

    End Function

    Private Function GetEncodedChar(index As Integer) As Char
        If _CharacterArray IsNot Nothing AndAlso _CharacterArray.Count > 0 Then
            Return _CharacterArray(index)
        Else
            Return Convert.ToChar(index + NumberBaseLow)
        End If
    End Function

    Private Function GetDecodedChar(character As Char) As Integer
        If _CharacterArray IsNot Nothing AndAlso _CharacterArray.Count > 0 Then
            Return _CharacterArray.IndexOf(character)
        Else
            Return Convert.ToInt32(character) - NumberBaseLow
        End If
    End Function

    Private Function GetEncodingCharsLength() As Integer
        If _CharacterArray IsNot Nothing AndAlso _CharacterArray.Count > 0 Then
            Return _CharacterArray.Count
        Else
            Return NumberBaseHigh - NumberBaseLow + 1
        End If
    End Function

    Private Function GetEncodingCharsStartBase() As Integer
        If _CharacterArray IsNot Nothing AndAlso _CharacterArray.Count > 0 Then
            Return GetHighLow.Key
        Else
            Return NumberBaseLow
        End If
    End Function
End Class 
```

现在让代码循环遍历 Excel 列：

```
 Public Function GetColumnList(DataSheetID As String) As List(Of String)
        Dim workingColumn As New BaseNumber("A")
        workingColumn.SetCharacterArray("@ABCDEFGHIJKLMNOPQRSTUVWXYZ")

        Dim listOfPopulatedColumns As New List(Of String)
        Dim countOfEmptyColumns As Integer

        Dim colHasData As Boolean
        Dim cellHasData As Boolean

        Do
            colHasData = True
            cellHasData = False
            For r As Integer = 1 To GetMaxRow(DataSheetID)
                cellHasData = cellHasData Or XLGetCellValue(DataSheetID, workingColumn.GetBaseXNumber & r) <> ""
            Next
            colHasData = colHasData And cellHasData

            'keep trying until we get 4 empty columns in a row
            If colHasData Then
                listOfPopulatedColumns.Add(workingColumn.GetBaseXNumber)
                countOfEmptyColumns = 0
            Else
                countOfEmptyColumns += 1
            End If

            'we are already starting with column A, so increment after we check column A
            Do
                workingColumn.SetNumber(workingColumn.GetBase10Number + 1)
            Loop Until Not workingColumn.GetBaseXNumber.Contains("@")

        Loop Until countOfEmptyColumns > 3

        Return listOfPopulatedColumns

    End Function 
```

您会注意到 Excel 部分的重要部分是 0 由重新编号中的 @ 标识。所以我只是过滤掉所有带有@的数字，然后得到正确的序列（A，B，C，...，Z，AA，AB，AC，...）。

* * *

## 回答 #12

> 赞同：-1
> 
>             
> 
> 时间：2020-04-24T20:29:47.937

这是基于 Pavel 的回答，但取消了他不必要的负数字符串连接。基数也是由传入的字符定义的，所以如果你想使用字符 ABC 将数字转换为基数 3，请传递“ABC” - 3 的字符串长度是基数：

# C＃

```
public static string ToBase(long base10, string baseChars = "0123456789ABCDEFGHIJKLMNOPQRTSUVWXYZ")
{
    if (baseChars.Length < 2)
        throw new ArgumentException("baseChars must be at least 2 chars long");
    if (base10 == 0L)
        return baseChars[0].ToString();
    bool isNegative = base10 < 0L;
    int radix = baseChars.Length;
    int index = 64; // because it's how long a string will be if the basechars are 2 long (binary)
    var chars = new char[index + 1]; // 65 chars, 64 from above plus one for sign if it's negative
    base10 = Math.Abs(base10);
    while (base10 > 0L)
    {
        chars[index] = baseChars[(int)(base10 % radix)];
        base10 /= radix;
        index--;
    }

    if (isNegative)
    {
        chars[index] = '-';
        index--;
    }

    return new string(chars, index + 1, chars.Length - index - 1);
} 
```

# VB.NET

```
Public Shared Function ToBase(base10 As Long, Optional baseChars As String = "0123456789ABCDEFGHIJKLMNOPQRTSUVWXYZ") As String

    If baseChars.Length < 2 Then Throw New ArgumentException("baseChars must be at least 2 chars long")

    If base10 = 0 Then Return baseChars(0)

    Dim isNegative = base10 < 0
    Dim radix = baseChars.Length
    Dim index As Integer = 64 'because it's how long a string will be if the basechars are 2 long (binary)
    Dim chars(index) As Char '65 chars, 64 from above plus one for sign if it's negative

    base10 = Math.Abs(base10)

    While base10 > 0
        chars(index) = baseChars(base10 Mod radix)
        base10 \= radix

        index -= 1
    End While

    If isNegative Then
        chars(index) = "-"c
        index -= 1
    End If

    Return New String(chars, index + 1, UBound(chars) - index)

End Function 
```

# sql - 将具有空值和重复项的行压缩为单行

> ID：923776
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-28T23:52:17.247
> 
>         
> 
> 标签：sql, sql-server, sql-server-2005

我不确定如何描述我想做的事情，所以我将使用一个人为的例子

在 SQL Server 2005 上，假设我有一个包含这样行的视图，称之为 vwGrades：

```
ID          AssnDate                AssnTxt       Sally       Ted         Bob
----------- ----------------------- ------------- ----------- ----------- -----------
2999        2007-09-22 00:00:00     Homework #1   20          NULL        NULL
2999        2007-09-22 00:00:00     Homework #1   NULL        0           NULL
2999        2007-09-22 00:00:00     Homework #1   NULL        NULL        24
2999        2007-09-22 00:00:00     Final Exam    57          NULL        NULL
2999        2007-09-22 00:00:00     Final Exam    NULL        0           NULL
2999        2007-09-22 00:00:00     Final Exam    NULL        NULL        35 
```

我如何查询它，这样我才能得到它，摆脱所有烦人的空值和重复行？

```
ID          AssnDate                AssnTxt       Sally       Ted         Bob
----------- ----------------------- ------------- ----------- ----------- -----------
2999        2007-09-22 00:00:00     Homework #1   20          0           24
2999        2007-09-22 00:00:00     Final Exam    57          0           35 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T00:30:10.757

```
Select
   ID,
   AssnDate,
   AssnTxt,
   Max(IsNull(Sally,0)) AS Sally,
   Max(IsNull(Ted, 0)) As Ted,
   Max(IsNull(Bob, 0)) As Bob
From vwGrades
Group By
  ID,
  AssnDate,
  AssnTxt 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:00:03.673

看起来像一个非规范化模式，您应该有一个 FirstName 列，而不是 Sally Ted 和 Bob。这将使查询更简单。你能重构吗？

# sql-server - 您将如何设计数据库以允许用户定义模式

> ID：923778
> 
>         
> 
> 赞同：16
> 
>         
> 
> 时间：2009-05-28T23:52:33.190
> 
>         
> 
> 标签：sql-server, database, entity-framework, schema, entity-attribute-value

如果您必须创建一个应用程序，比如博客应用程序，那么创建数据库模式相对简单。您必须创建一些表格、tblPosts、tblAttachments、tblCommets、tblBlaBla……就是这样（好吧，我知道，这有点简化，但您明白我的意思）。

如果您有一个应用程序，您希望允许用户**在运行时**定义部分模式，该怎么办。假设您要构建一个应用程序，用户可以在其中记录任何类型的数据。一个用户想要记录他的工作时间（开始时间、结束时间、项目 ID、描述），下一个想要收集烹饪食谱，其他人可能是股票报价、他们的婴儿每周的体重、他们每月花费的食物费用、他们的结果最喜欢的足球队或任何你能想到的东西。

你将如何设计一个数据库来保存所有非常不同类型的数据？你会创建一个可以保存所有类型数据的通用模式，你会创建反映用户数据模式的新表，还是你有另一个好主意来做到这一点？

如果它很重要：我必须使用 SQL Server / Entity Framework

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-12-15T02:44:34.183

让我们再试一次。

如果您希望他们能够创建自己的架构，那么为什么不使用 CREATE TABLE 语句来构建架构，哦，我不知道。你有一个完整的、功能齐全的、强大的数据库，可以做一些很棒的事情，比如定义模式和存储数据。为什么不使用它？

如果您只是要做一些临时属性，那么当然可以。

但如果是“全权委托，他们可以为所欲为”，那就让他们来吧。

他们必须了解 SQL 吗？嗯，没有。那是你的 UI 任务。作为工具和应用程序设计者，您的工作是向用户隐藏实现。因此，如果您需要关系等，请提供字段、线条和箭头的列表。随便。

多年来，人们一直在制作“最终用户”、“简单”的数据库工具。

“如果他们想添加一列怎么办？” 然后添加一列，数据库会这样做，至少大多数好的。如果没有，则创建新表，复制旧数据，删除旧表。

“如果他们想删除一列怎么办？” 看上面。如果您无法删除列，则将其从用户的逻辑视图中删除，使其看起来已被删除。

“如果他们有 110 亿行数据怎么办？” 然后他们有 110 亿行数据，而操作比他们有 1 行数据的时间要长 110 亿倍。如果他们有 110 亿行数据，他们可能无论如何都不应该使用您的系统。

“在数据库上实现数据库”的魅力让我无法理解。

“我这里有Oracle，我怎么能提供更少的功能，让用户更慢？？”

哎呀，我想知道。

* * *

## 回答 #2

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T02:18:07.700

您无法预测他们的数据需求会有多复杂。实体-属性-值是许多程序员使用的一种典型解决方案，但它可能就足够了，例如，如果用户的数据通常使用多个表进行建模。

我会将用户的自定义数据序列化为 XML 或 YAML 或 JSON 或类似的半结构化格式，并将其保存在文本 BLOB 中。  

您甚至可以创建*倒排索引*，以便在 BLOB 的属性中查找特定值。请参阅[http://bret.appspot.com/entry/how-friendfeed-uses-mysql](http://bret.appspot.com/entry/how-friendfeed-uses-mysql)（该技术适用于任何 RDBMS，而不仅仅是 MySQL）。

还可以考虑使用[Solr](http://lucene.apache.org/solr/)或[MongoDB](http://mongodb.org)等文档存储。这些技术不需要遵守关系数据库约定。您可以在运行时向任何文档添加新属性，而无需重新定义架构。但这是一种权衡——没有架构意味着您的应用程序不能依赖于整个集合中相似的文档/行。

* * *

我是实体-属性-值反模式的批评者。

[我在我的书SQL Antipatterns: Avoiding the Pitfalls of Database Programming](http://www.pragprog.com/titles/bksqla/sql-antipatterns)中写过 EAV 问题。

这是一个 SO 答案，我列出了 Entity-Attribute-Value 的一些问题：“[产品表，多种产品，每个产品都有很多参数](https://stackoverflow.com/questions/695752/#695860)。”

这是我前几天发布的一篇关于 EAV 问题的更多讨论的博客：“ [EAV FAIL](http://karwin.blogspot.com/2009/05/eav-fail.html) ”。

并且一定要阅读这篇博客“ [Bad CarRMa](http://www.simple-talk.com/opinion/opinion-pieces/bad-carma/) ”，了解如何尝试制作一个完全灵活的数据库几乎摧毁了一家公司。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T02:26:21.427

我会选择混合实体-属性-值模型，所以就像 Antony 的回复一样，您有 EAV 表，但您也有始终存在的默认列（和类属性）。

这是一篇关于你在做什么的[好文章:)](http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=2110957)

作为补充评论，我在几天内使用 Linq2Sql 为这种方法制作了一个原型，这是一个可行的解决方案。鉴于您提到了实体框架，我将看看版本 4 及其[POCO 支持](http://msdn.microsoft.com/en-us/library/dd456853(VS.100).aspx)，因为这将是注入混合 EAV 模型而不会污染您的 EF 架构的好方法。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T00:20:11.883

从表面上看，用于自定义用户数据的无模式或面向文档的数据库（例如[CouchDB](http://couchdb.apache.org/)或[SimpleDB](http://aws.amazon.com/simpledb/)）听起来很理想。但我想如果你不能使用除了 SQL 和 EF 之外的任何东西，那也无济于事。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T00:26:15.930

我不熟悉实体框架，但我倾向于实体-属性-值（[http://en.wikipedia.org/wiki/Entity-Attribute-Value_model](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model)）数据库模型。

因此，您的应用程序将创建属性（或属性集合），然后您的最终用户将完成这些值，而不是动态创建表和列。

但是，正如我所说，我不知道实体框架应该为您做什么，它可能不会让您采用这种方法。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T03:22:33.030

不是批评性评论，但它可能有助于节省一些时间来指出这是堂吉诃德圣杯类型的问题之一。大约 50 多年以来，人们一直在不断地寻求创建一个用户友好的数据库设计界面。

我能想到的唯一获得显着吸引力的准成功者是 1\. Excel（及其前身），2\. Filemaker（原始版本，而不是当前版本）和 3.（可能，但值得怀疑）Access . 请注意，前两个基本上仅限于一个表。

如果我们的集体传统智慧能帮助你打破障碍，我会感到惊讶。但这会很棒。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-12-15T02:41:38.493

与其重新实现 sqlservers “CREATE TABLE” 语句，这是多年前由可能比你或我更好的程序员团队完成的，为什么不以有限的方式向用户公开 SQLSERVER —— 让他们创建他们以有限的方式拥有自己的架构，并利用 SQLServer 的力量来正确地完成它。   

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:58:47.083

看看这篇[文章](http://blogs.msdn.com/adonet/archive/2009/04/04/edmgen2-now-with-reverse-engineering-options.aspx)你可以做到，但这是一项艰巨的工作:) 如果性能不是问题，那么 xml 解决方案也可以工作，尽管这也是很多工作。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:03:16.943

我只会给他们一份 SQL Server Management Studio 的副本，然后说，“发疯！” 为什么要在轮中重新发明轮子？

# wcf - 为网页和 Web 服务保留 NHibernate ISessionFactory 的最简单方法是什么？

> ID：923779
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-28T23:52:54.420
> 
>         
> 
> 标签：wcf, web-services, nhibernate

为网页和 Web 服务保留 NHibernate ISessionFactory 的最简单方法是什么？

***稍后我将进入 Rhino Commons 和 Windsor。我正在寻找基本概念。***

**它是否正确？**

我一直在尝试寻找有关如何尽可能简单地处理 ISessionFactory 的指导。我还在寻找一种适用于网页和 Web 服务的解决方案。我见过的例子是处理网页的，从来没有涉及到网络服务的主题。他们首先构建一个 Httpmodule，该模块创建 ISessionFactory 并将其存储在静态变量中（例如，Jeffrey Palermo 的 HybridSessionBuilder (jeffreypalermo.com/blog/use-this-nhibernate-wrapper-to-keep-your-repository-classes-simple/ ) 或在 NHibernate 的夏天（www.summerofnhibernate.com 参见第 13 节中的 StaticSessionManager）。我还注意到，尽管 ISessionFactory 实现了 IDisposable，但似乎没有人处理它。我猜他们只是让垃圾收集器处理当 Web 应用程序结束时，  

如果这一切都是真的，那么最简单的事情就是创建一些具有用于存储 ISessionFactory 的静态变量的类。此类将由网页和 Web 服务实例化和使用。每次实例化类时，我都会检查以确保静态 ISessionFactory 变量不为空。如果它为空，我重新创建它。因此，我通过在 Web 应用程序中创建某个类的实例（网页或 Web 服务）来保持 ISessionFactory 处于活动状态。ISessionFactory 位于静态变量中的事实意味着它由类的每个实例共享。由于会话工厂是线程安全的，这没关系。只要我不分享 ISessions，我就是金子。当没有人拥有这个公共类的实例时，

**这是保持 ISessionFactory 活动的基本原则吗？**

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T17:17:04.237

我想你基本上已经弄清楚了。

没有人处理会话工厂的原因是，一般来说，你真的不想这样做。构建会话工厂是一项极其昂贵的操作，可能需要几秒钟的时间，因此您希望尽可能长时间地坚持下去。.NET 运行时实际上会创建一个 s 池，`HttpApplication`并且可以随意创建/处置它们。因此，如果您可以将会话工厂存储在应用程序之外的`AppDomain`范围内，那将是更可取的，因为工厂将持续存在直到域被回收。将会话工厂声明为静态将实现这一点，这就是这样做的原因；请参阅[有关静态类的 MSDN 文档：](http://msdn.microsoft.com/en-us/library/79b3xss3.aspx)

> 静态构造函数只被调用一次，静态类在程序所在的应用程序域的整个生命周期内都保留在内存中。

因此，如果您将会话工厂容器设为静态并且从不显式处理它，它将保留在内存中直到`AppDomain`被回收，从而最大限度地提高该工厂实例的效用和应用程序的性能。

# iphone - 在 Mobile Safari / Webkit 上禁用文本突出显示放大镜

> ID：923782
> 
>         
> 
> 赞同：55
> 
>         
> 
> 时间：2009-05-28T23:53:15.620
> 
>         
> 
> 标签：iphone, webkit

我的 iPhone 网站中有一些元素没有任何文本，但需要用户单击并按住它们（DIV）。这会导致文本突出显示/编辑循环/光标出现，这真的很让人分心。

我知道有一条 CSS 规则可以删除在可点击元素被触摸时出现的黑框。有没有类似的东西可以禁用文本放大镜？

* * *

## 回答 #1

> 赞同：50
> 
>             
> 
> 时间：2009-05-29T00:00:20.287

刚收到开发者中心服务台的回复。我需要添加这个 CSS 规则：

```
-webkit-user-select: none; 
```

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2017-02-03T05:15:16.943

将此添加到 CSS

```
body {
-webkit-touch-callout: none;                /* prevent callout to copy image, etc when tap to hold */
-webkit-text-size-adjust: none;             /* prevent webkit from resizing text to fit */
-webkit-user-select: none;                  /* prevent copy paste, to allow, change 'none' to 'text' */} 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2014-11-06T13:45:55.900

使用这些 CSS 规则：

```
-webkit-touch-callout: none;
-webkit-user-select: none; /* Disable selection/copy in UIWebView */ 
```

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-12-08T06:40:24.307

这对于保护您不想复制或保存的内容（例如图像）也很有用：

```
#yourdiv img {-webkit-touch-callout: none; } 
```

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2016-03-07T23:51:54.400

这在 JS 中为我​​解决了这个问题：

```
document.getElementsByTagName("body")[0].addEventListener("touchstart",
 function(e) { e.returnValue = false }); 
```

似乎绕过了操作系统在那里捕捉触摸的任何东西。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2014-09-10T17:40:28.250

我在自己尝试时发现了这一点。首先，您必须将此规则添加到封闭元素：

```
-webkit-user-select: none; 
```

但这在 iPhone 上是不够的。事实证明，放大镜仍然可以出现，因为例如，父元素会接受选择，或者只是因为感觉像它。

然而，我随后发现了一些很酷的东西——如果你的元素向一个元素添加了一个`touchend`和`click`处理程序，那么 Apple 的 Safari 最终避免了导致放大镜出现的烦人的代码路径，可能意识到这个元素是为了一些 UI 交互，而不是选择文本。同样令人敬畏的是，如果您在屏幕顶部附近的元素上执行此操作，它还将取消横向模式下导航的外观！但是不确定如何在单击底部的元素时取消导航的外观，有没有人有解决方案？

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2021-12-21T01:08:53.953

在 IOS 15.2`-webkit-user-select: none;`上解决了这个问题，但只是部分解决了。

长按不再显示放大镜。但是，如果您双击并按住，它仍然会神奇地出现。

除了`event.preventDefault`touchstart 之外，仍然没有 100% 可靠的方法。但这也阻止了底层操作，因此带有长按工具提示的按钮之类的东西会中断。因此，它并不总是一种选择......

# ruby-on-rails - 如何在 Ruby on Rails 中验证一对 id 的唯一性？

> ID：923796
> 
>         
> 
> 赞同：55
> 
>         
> 
> 时间：2009-05-28T23:59:00.010
> 
>         
> 
> 标签：ruby-on-rails, validation, model, unique-constraint

假设在 Ruby 中进行以下数据库迁移：

```
    create_table :question_votes 做 |t|
      t.integer :user_id
      t.integer :question_id
      t.integer：投票

      t.timestamps
    结尾

```

进一步假设我希望数据库中的行包含唯一的 (user_id, question_id) 对。什么是正确的灰尘放入模型中以实现这一目标？

```
validates_uniqueness_of :user_id, :question_id
```

似乎只是使行由用户 id 唯一，并且由问题 id 唯一，而不是由对唯一。

* * *

## 回答 #1

> 赞同：95
> 
>             
> 
> 时间：2009-05-29T00:12:40.747

```
validates_uniqueness_of :user_id, :scope => [:question_id] 
```

如果您需要包含另一列（或更多），您也可以将其添加到范围中。例子：

```
validates_uniqueness_of :user_id, :scope => [:question_id, :some_third_column] 
```

* * *

## 回答 #2

> 赞同：27
> 
>             
> 
> 时间：2010-06-24T08:27:31.807

如果使用 mysql，您可以使用唯一索引在数据库中执行此操作。它是这样的：

```
add_index :question_votes, [:question_id, :user_id], :unique => true 
```

当您尝试保存 question_id/user_id 的双重组合时，这将引发异常，因此您必须进行试验并找出要捕获和处理的异常。

* * *

## 回答 #3

> 赞同：17
> 
>             
> 
> 时间：2015-02-06T12:01:14.037

最好的方法是同时使用两者，因为当唯一性验证通过时，rails 并不是 100% 可靠的。

您可以使用：

```
 validates :user_id, uniqueness: { scope: :question_id } 
```

为了安全起见 100%，请在您的数据库中添加此验证（MySQL ex）

```
 add_index :question_votes, [:user_id, :question_id], unique: true 
```

然后你可以在你的控制器中使用：

```
 rescue ActiveRecord::RecordNotUnique 
```

所以现在你是 100% 安全的，你不会有重复的值 :)

* * *

## 回答 #4

> 赞同：15
> 
>             
> 
> 时间：2012-08-16T07:13:09.590

来自[RailsGuides](http://edgeguides.rubyonrails.org/active_record_validations.html#uniqueness)。`validates`也可以：

```
class QuestionVote < ActiveRecord::Base
  validates :user_id, :uniqueness => { :scope => :question_id }
end 
```

* * *

## 回答 #5

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T00:14:09.480

除了编写自己的验证方法之外，您能做的最好的事情`validates_uniqueness_of`是：

```
validates_uniqueness_of :user_id, :scope => "question_id" 
```

这将检查 user_id 在与您尝试插入的记录具有相同 question_id 的所有行中是否唯一。

**但这不是你想要的**。

我相信您正在寻找数据库中唯一的`:user_id`组合`:question_id`。

在这种情况下，您需要做两件事：

1.  编写自己的验证方法。

2.  在数据库中创建一个约束，因为您的应用仍然有可能同时处理两条记录。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2016-07-15T17:41:13.457

当您创建新记录时，这不起作用，因为`id`您的父模型在验证时仍然不存在。

这应该对你有用。

```
class B < ActiveRecord::Base
  has_many :ab
  has_many :a, :through => :ab
end

class AB < ActiveRecord::Base
  belongs_to :b
  belongs_to :a
end

class A < ActiveRecord::Base
  has_many :ab
  has_many :b, :through => :ab

  after_validation :validate_uniqueness_b

  private
  def validate_uniqueness_b
    b_ids = ab.map(&:b_id)
    unless b_ids.uniq.length.eql? b_ids.length
      errors.add(:db, message: "no repeat b's")
    end
  end
end 
```

在上面的代码中，我得到了所有`b_id`参数的集合，然后比较唯一值和获得的 b_id 之间的长度是否相等。

if are equals 表示没有重复`b_id`。

**注意：不要忘记在数据库的列中添加唯一性**。

# django - 在 django auth 中重新排序用户

> ID：923799
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-05-28T23:59:20.040
> 
>         
> 
> 标签：django, django-admin

我有一个模型，其中有一个 ForeignKey 到内置用户模型，`django.contrib.auth`我对管理员中的选择框总是按用户的主键排序这一事实感到沮丧。

我宁愿让它按用户名的字母顺序排序，虽然我的本能不想摆弄 Django 的内部，但我似乎找不到更简单的方法来重新排序用户。

我能想到的最直接的方法是进入我的 Django 安装并添加

```
ordering = ('username',) 
```

到 User 模型的 Meta 类。

是否有某种我可以做的猴子补丁或任何其他侵入性较小的方式来修改用户模型的顺序？

或者，任何人都可以通过做出这种改变来破坏任何东西吗？

* * *

## 回答 #1

> 赞同：23
> 
>             
> 
> 时间：2009-05-29T01:31:26.563

有一种方法可以使用[ModelAdmin 对象](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#modeladmin-objects)来指定您自己的表单。通过指定您自己的表单，您可以完全控制表单的组成和验证。

假设具有 FK 的模型`User`是`Foo`。

你`myapp/models.py`可能看起来像这样：

```
from django.db import models
from django.contrib.auth.models import User

class Foo(models.Model):
    user = models.ForeignKey(User)
    some_val = models.IntegerField() 
```

然后，您将创建一个`myapp/admin.py`包含以下内容的文件：

```
from django.contrib.auth.models import User
from django import forms
from django.contrib import admin

class FooAdminForm(forms.ModelForm):
    user = forms.ModelChoiceField(queryset=User.objects.order_by('username'))

    class Meta:
        model = Foo

 class FooAdmin(admin.ModelAdmin):
     form = FooAdminForm

 admin.site.register(Foo, FooAdmin) 
```

完成此操作后，`<select>`下拉列表将根据用户名对用户对象进行排序。无需担心`Foo`...上的其他字段，您只需要在`FooAdminForm`类中指定覆盖。不幸的是，您需要为每个模型提供此自定义表单定义，该模型具有您希望在管理站点中显示的用户的 FK。

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-07-21T10:52:50.663

Jarret 上面的回答实际上应该是：

```
from django.contrib.auth.models import User
from django.contrib import admin
from django import forms
from yourapp.models import Foo

class FooAdminForm(forms.ModelForm):
    class Meta:
        model = Foo

    def __init__(self, *args, **kwds):
        super(FooAdminForm, self).__init__(*args, **kwds)
        self.fields['user'].queryset = User.objects.order_by(...)

class FooAdmin(admin.ModelAdmin):
    # other stuff here
    form = FooAdminForm

admin.site.register(Foo, FooAdmin) 
```

因此，每次创建表单时都会重新评估查询集，而不是在导入包含表单的模块时重新评估一次。

# css - 与 IE7 中的 Meyer 重置冲突的段落标签？

> ID：923806
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:00:28.353
> 
>         
> 
> 标签：css, browser, internet-explorer-7, css-reset

在处理一个相当小而简单的布局时，我决定使用 Meyer 的 CSS 重置规则来清除浏览器之间的一些预期差异。在我决定将几段添加到几个嵌套的 div 中之前，一切都运行得很好。

一旦我将段落标签放在第二个嵌套 div 中，父 div 和授权父 div 的背景图像在 IE7 中消失了。

删除段落标签（并使用未标记的文本）返回背景图像。此外，保留标签并删除对 reset.css 文件的引用会恢复背景图像。

显然，我不想采用其中任何一种方法来解决这个问题。这里有任何 CSS 大师知道发生了什么吗？

演示： http: [//www.sampsonresume.com/projects/patriot-depot/](http://www.sampsonresume.com/projects/patriot-depot/)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:38:48.913

奇怪的是，当我从`reset.css`文件中删除以下规则时，问题就解决了：

`background:transparent`

这条规则适用于第一大块匹配的元素，所以我不确定它从长远来看会产生什么影响。希望有更好的解决方案，因为我对编辑 Meyers 的 reset.css 以“解决”我的问题有点不安。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T02:29:49.440

它看起来像是 IE 中消失的内容错误的一个版本。

将 zoom:1 添加到 div.pd_horiz_content 和 div.pd_horiz_content_b。这将在 IE 中调用“hasLayout”，您的背景将显示出来。

您还可以通过向 div 添加尺寸（宽度：960px）来调用 hasLayout。在您的情况下，这可能更有意义，因为您的 div 具有基于背景图像的固定宽度。

# wpf - WPF - 从 DataTemplate 中拖动

> ID：923809
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:00:56.620
> 
>         
> 
> 标签：wpf, drag-and-drop, listbox, datatemplate

我有一个使用 DataTemplate 显示员工的 ListBox - 它看起来与[此屏幕截图](http://www.wpftutorial.net/images/listbox_datatemplate3.png)**非常**相似。我希望能够单击员工照片，将其拖放到 ListBox 之外的某个位置。我怎样才能做到这一点？我不确定如何捕获图像的 PreviewMouseLeftButtonDown 事件，因为它位于 DataTemplate 中。

编辑：DataTemplate 位于一个单独的程序集中，拖放逻辑需要位于具有 ListBox 的窗口中。

Edit2：我认为这样做的正确方法是使用命令，对吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T09:22:53.320

您没有提到数据模板在哪里。我将尝试介绍两种非常相似的可能性。

如果用户控件的资源中有数据模板，则可以在用户控件的代码隐藏文件中设置事件。

```
<UserControl.Resources>
    <DataTemplate DataType="{x:Type local:Staff}">
      <StackPanel>
        <TextBlock Text="{Binding Path=Name}"/>
        <Image Name="staffImage" PreviewMouseLeftButtonDown="staffImage_PreviewMouseLeftButtonDown"/>
      </StackPanel>
    </DataTemplate>
</UserControl.Resources> 
```

然后在 UserControl.cs

```
private void staffImage_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{

} 
```

现在，如果您在资源字典中使用日期模板，那么您可以执行完全相同的操作，但您需要为资源字典创建一个代码隐藏文件。[见这里](https://stackoverflow.com/questions/92100/is-it-possible-to-set-code-behind-a-resource-dictionary-in-wpf-for-event-handling)。

对于拖放演练本身...请参阅 Jamie Rodriguez 的[帖子](http://blogs.gotdotnet.com/jaimer/archive/2007/07/12/drag-drop-in-wpf-explained-end-to-end.aspx)。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-01-16T01:46:27.067

您可以将 ElementDragBehavior（类似的东西）添加到数据模板中。

silverlight 工具包中的另一个选项（我不确定它是否存在于 WPF 中，但它存在于 Silverlight 中）您可以在 ListBox 上方添加它：

```
<toolkit:ListBoxDragDropTarget AllowDrop="True"> 
```

这使得列表中的每个项目都可以拖动到其他具有该项目的 ListBoxes 中

# asp.net - 如何避免这些死锁？

> ID：923811
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:01:23.157
> 
>         
> 
> 标签：asp.net, sql-server, ado.net

我有一个例程正在更新我的业务实体。更新涉及大约 6 个不同的表。所有命令都在事务中执行。

最近，我需要在从数据库访问查找表的例程中添加一些代码。查找代码已存在于另一个业务对象中，因此我使用了该业务对象。例如：

```
Using tr As DbTransaction = myConnection.BeginTransaction()
    ExecuteCommand1(tr)
    ExecuteCommand2(tr)
    If myLookupTable.GetLookupTable().FindById(id).HasFlagSet Then
        ExecuteCommand3(tr)
    End If
End Using 
```

但是，查找表业务对象挂起/死锁。我认为这是因为它没有引用原始例程使用的事务。

在做了一些研究之后，我尝试将查找表逻辑放在它自己的事务中，`IsolationLevel`将`ReadUncommitted`. 这给了我想要的结果。但是，经过进一步的研究，我现在怀疑我是否正确实施了这一点。

假设我的查找表对象无法使用对活动事务的引用，我所描述的是否被认为是最佳实践？我觉得我可能错过了什么。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T01:00:46.453

如果您在事务中间进行读取，那么您应该在事务上下文下进行，而不是使用不同的事务和脏读。幸运的是，有一个简单的解决方案：不使用 ADO.Net 事务对象，而是使用 .Net [TransactionScope](http://msdn.microsoft.com/en-us/library/system.transactions.transactionscope.aspx)对象。ADO.Net 代码对它很敏感，并将在此事务中征集您的所有操作，包括您的其他业务组件读取。只需确保您的业务对象没有打开不同的连接，这将导致尝试将现有事务升级为分布式事务并将新连接加入其中。

另一种方法是在每次调用时传递您的 SqlConnection/SqlTransaction 对，但这会在您的代码中到处传播丑陋的东西。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:12:52.367

如果是我，我会重写逻辑，这样我就不必进行未提交的读取。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:33:37.083

避免死锁的黄金法则是在每个事务中始终以相同的顺序获取表锁。所以看看其他事务中的代码，看看他们采取表锁的顺序；然后确保您在交易中使用相同的订单。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:35:09.123

显然，您的查找正在尝试访问由事务 tr 独占锁定的行。如果您使用 readuncommitted 事务或在查找查询中使用 WITH(NOLOCK)，您将看到可能正在发生并影响查找逻辑的事务的所有未提交更改。所以我不太确定这会有多可取。

我认为如果您需要在该事务期间进行查找，最好找到一种方法来确保您的查找查询参与当前事务。如果所有这些操作都在同一个线程中执行，您可以做的一件事是在创建一个事务对象时将事务对象存储在线程本地存储中，并让 GetLookupTable 方法检查事务对象的线程本地存储，如果有是一个事务集，您可以从该事务对象获取连接。否则，您将创建一个新连接。这样，您的查找将成为该事务的一部分，并且它应该运行其逻辑而不会被当前事务阻塞，进而阻塞当前事务并因此导致死锁。

# c++ - 是否有用于将 EBNF 翻译为 boost::spirit 的翻译工具？

> ID：923817
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T00:03:52.917
> 
>         
> 
> 标签：c++, boost-spirit

翻译器也可以在 boost::spirit 中。我在互联网上找不到任何东西。也许我应该做一个？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:27:38.530

从[精神介绍](http://spirit.sourceforge.net/distrib/spirit_1_8_5/libs/spirit/doc/introduction.html)：

> 表达式模板允许我们在 C++ 中完全近似扩展巴科斯范式 (EBNF) 的语法。

所以你*几乎*可以编写简单的 EBNF，不需要*翻译器*。

我对spirit不太熟悉，不知道语法到底有什么不同，但是如果*spirit C++ EBNF*和*真正的EBNF*的差异很小，一个简单的[sed](http://en.wikipedia.org/wiki/Sed)脚本就足够了。

如果不是这样，您可以编写一个理解 EBNF 的精神解析器，然后使用 AST 创建作为该 AST 精神表示的 C++ 代码。

# macos - 如何从 OS X 获取“测量单位”设置？

> ID：923819
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:04:46.033
> 
>         
> 
> 标签：macos, preferences, units-of-measurement

我希望我的应用程序根据 OS X 国际首选项窗格中选择的设置以美国或公制显示测量值。

如何在我的代码中从操作系统获取这条信息？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T00:09:01.877

采用

```
BOOL usesMetic = [[[NSLocale currentLocale] objectForKey:NSLocaleUsesMetricSystem] boolValue]; 
```

# excel - 使用 VBA 在 MS Excel 中列出 MS Access 表的子集

> ID：923820
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:04:48.360
> 
>         
> 
> 标签：excel, ms-access, vba

我在以“RP_”开头的 MS Access 2002 数据库中有一系列存储查询/表。我想在 MS Excel 2002 电子表格的列表框菜单中列出这些表名。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T03:41:35.347

有很多方法可以实现这一目标。

这是一个：

*   将 ActiveX ComboBox 控件添加到您的表单（例如`ComboBox1`）并将其`LinkedCell`属性链接到您希望存储结果的单元格。

*   向 Excel 工作簿添加对*“Microsoft DAO 3.6 对象库”*的引用（ALT-F11 打开 IDE，然后菜单工具 > 引用...）。

    这些 MDAC 组件应该已经安装在所有最新的机器上。

    请注意，如果您使用 Office 2007，最好参考“ *Microsoft Office 12.0 Access 数据库引擎对象库”*，因为它还允许您打开较新的 ACCDB Access 2007 数据库。

*   在您的工作簿中插入一个新模块并将此代码放入其中：

    ```
    ' Fill the given combobox with all the tables and query names '
    ' starting with RP_ found in the given database. '
    Public Sub FillWithAccessEntities(PathToAccessDB As String, combox As ComboBox)
        Dim db As DAO.Database
        Dim td As DAO.TableDef
        Dim qd As DAO.QueryDef
        combox.Clear
        ' Open the db in exclusive and read-only mode '
        Set db = DBEngine.OpenDatabase(PathToAccessDB, True, True)
        For Each td In db.TableDefs
            If Left(td.Name, 3) = "RP_" Then
                combox.AddItem td.Name
            End If
        Next
        For Each qd In db.QueryDefs
            If Left(qd.Name, 3) = "RP_" Then
                combox.AddItem qd.Name
            End If
        Next
        db.Close
        Set db = Nothing
    End Sub 
    ```

*   例如，要初始化组合框，我们可以从工作簿的 Open 事件中调用此代码。

    在`ThisWorkbook`模块中，插入此代码，假设 ActiveX 组合框`ComboBox1`已添加到`Sheet1`：

    ```
    Sub Workbook_open()
        FillWithAccessEntities "c:\mydb.mdb", Sheet1.ComboBox1
    End Sub 
    ```

现在，当您打开文件时，组合框将自动填充数据库中的表和查询名称。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T03:29:16.060

您在 Excel 中遇到 ODBC 错误的问题可能是由数据库本身的权限问题引起的。默认情况下，管理员帐户（您可能使用的帐户）没有 MSysObjects 的读取权限。您可以通过进入用户权限并授予管理员帐户对该表的读取权限来修复它。这种方法的困难在于权限存储在本地计算机上的 system.mdw 文件中（假设您没有更改它）。这意味着您必须在每台使用您正在创建的代码的机器上修复权限。

但是，您可以使用 ADO 扩展库避开整个问题。假设你给它一个正确的数据库路径，下面发布的代码应该“运行”。

```
Option Explicit

Public Sub Example()
    EnumerateDBTables Range("A1:A2"), "C:\Test\db1.mdb"
End Sub

Public Sub EnumerateDBTables(ByVal target As Excel.Range, ByVal dbPath As _
    String, Optional ByVal clearSheet As Boolean = True)
    'Requires reference to Microsoft ADO Ext. 2.8 for DDL and Security
    'If you have trouble finding it, look here:
    'C:\Program Files\Common Files\System\ado\msadox28.tlb
    Dim cat As ADOX.Catalog
    Dim tbl As ADOX.Table
    Dim ws As Excel.Worksheet
    Dim lngRow As Long
    Dim lngCol As Long
    Set ws = target.Parent
    If clearSheet Then ws.UsedRange.Clear
    Set cat = New ADOX.Catalog
    cat.ActiveConnection = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & _
        dbPath
    'Add Headers:
    ws.Range(target.Cells(1, 1), target.Cells(1, 1).Offset(0, 3)) = _
        Array("Name", "Type", "Created", "Modified")
    lngRow = target.Row + 1&
    For Each tbl In cat.Tables
        lngCol = target.Column
        ws.Cells(lngRow, lngCol) = tbl.Name
        ws.Cells(lngRow, lngCol + 1&) = tbl.Type
        ws.Cells(lngRow, lngCol + 2&) = tbl.DateCreated
        ws.Cells(lngRow, lngCol + 3&) = tbl.DateModified
        lngRow = lngRow + 1&
    Next
    ws.UsedRange.Columns.AutoFit
End Sub 
```

**编辑：**

从技术上讲，您甚至可以在不编写任何代码的情况下完成此操作...所有程序中最优化的程序... 0 行:) 以下是如何：

```
- 打开要查询的数据库。
- 转到工具>安全>用户和组权限。
- 在标有“用户/组名”的框中，选择“管理员”。
- 在标有“对象名称”的框中选择“MysObjects”。
- 在标记为“权限”的区域（就在下方），选中名为“读取数据”的框
- 单击确定关闭数据库。
- 打开 Excel。
- 转到数据>导入外部数据>新数据库查询。
- 选择 MS Access 数据库。
- 取消选中“使用查询向导”。
- 单击确定。
- 浏览到数据库。
- 单击选项。
- 检查“系统表”。
- 单击确定。
- 建立您的查询。
- 单击关闭。
- 现在单击查看，然后单击 SQL。
- 粘贴您的 SQL。
- 现在通过右上角的红色 X 关闭窗口，系统将提示您输入目标范围。
- 多田！

```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T00:33:03.293

在 VBA 即时窗口中，打开 Access 数据库，我执行以下操作：

```
? access.CurrentData.AllQueries.Count
 11 
? access.CurrentData.AllQueries.Item(1).Name
ATP Underwrites Chinese 
```

因此，在 Access 中有一个 CurrentData coClass，它具有一个可以计数和逐项列出的 AllQueries 属性。

在 Excel 中定义对 Microsoft Access 对象的引用。然后在 VBA 模块中粘贴这样的内容：

```
Function Queryname(n As Integer) As Variant
    Dim v As Variant
    Dim c As Long
    c = Access.CurrentData.AllQueries.Count
    v = Access.CurrentData.AllQueries.Item(n).Name
    Queryname = v
End Function 
```

然后在一张纸上你应该可以说

```
=Queryname(1) 
```

并得到一些有用的东西。

顺便说一句，Access 必须在我认为的时间运行。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T02:19:34.420

在 Excel 中，您可以使用 ADO（ActiveX 数据对象）直接使用 Access 数据库。在 Excel 中使用 ADO 之前，您需要通过 Visual Basic 编辑器中的工具 > 引用来引用相应的库（例如 Microsoft ActiveX 数据对象 2.8 库）。[此页面](http://msdn.microsoft.com/en-us/library/ms680928(VS.85).aspx)应该让您开始了解如何使用 ADO。

您可能会发现[这个](http://msdn.microsoft.com/en-us/library/ms675853(VS.85).aspx)使用对象的`OpenSchema`方法`Connection`返回数据库中表的名称的示例以及连接到 Access 数据库的[这个示例](http://msdn.microsoft.com/en-us/library/aa141406(office.10).aspx)很有用

# c - 定义宏时do while(0)有什么用？

> ID：923822
> 
>         
> 
> 赞同：134
> 
>         
> 
> 时间：2009-05-29T00:05:12.633
> 
>         
> 
> 标签：c, macros, linux-kernel

> **可能的重复：**
> 
>   [C/C++ 宏中的 Do-While 和 if-else 语句](https://stackoverflow.com/questions/154136/do-while-and-if-else-statements-in-c-c-macros)
> 
>   [do { ... } while (0) — 它有什么用？](https://stackoverflow.com/questions/257418/do-while-0-what-is-it-good-for)

我正在阅读 linux 内核，发现很多这样的宏：

```
#define INIT_LIST_HEAD(ptr) do { \
    (ptr)->next = (ptr); (ptr)->prev = (ptr); \
} while (0) 
```

为什么他们使用它而不是简单地在 {} 中定义它？

* * *

## 回答 #1

> 赞同：149
> 
>             
> 
> 时间：2009-05-29T00:09:22.077

你可以在它后面加上一个分号，让它看起来和行为更像一个函数。它也适用于 if/else 子句。

如果没有 while(0)，您上面的代码将无法使用

```
if (doit) 
   INIT_LIST_HEAD(x);
 else 
   displayError(x); 
```

因为宏后面的分号会“吃掉” else 子句，而上面的甚至不会编译。

* * *

## 回答 #2

> 赞同：44
> 
>             
> 
> 时间：2009-05-29T00:11:47.080

它允许您将多个语句组合到一个宏中。

假设你做了类似的事情：

```
if (foo) 
    INIT_LIST_HEAD(bar); 
```

如果宏的定义没有封装 do { ... } while (0);，上面的代码将扩展为

```
if (foo)
    (bar)->next = (bar);
    (bar)->prev = (bar); 
```

这显然不是预期的，因为如果 foo 成立，则只会执行第一条语句。无论 foo 是否成立，都会执行第二条语句。

编辑： http: [//c-faq.com/cpp/multistmt.html](http://c-faq.com/cpp/multistmt.html)和[http://developer.apple.com/documentation/DeveloperTools/gcc-4.0.1/cpp/Swallowing-the-Semicolon.html的进一步解释#吞下分号](http://developer.apple.com/documentation/DeveloperTools/gcc-4.0.1/cpp/Swallowing-the-Semicolon.html#Swallowing-the-Semicolon)

# java - 2D 游戏中的跳跃数学

> ID：923825
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-29T00:06:30.227
> 
>         
> 
> 标签：java, math, 2d, physics

我在 J2ME 中工作，我的游戏循环执行以下操作：

```
public void run() {
        Graphics g = this.getGraphics();
        while (running) {
            long diff = System.currentTimeMillis() - lastLoop;
            lastLoop = System.currentTimeMillis();
            input();
            this.level.doLogic();
            render(g, diff);
            try {
                Thread.sleep(10);
            } catch (InterruptedException e) {
                stop(e);
            }
        }
    } 
```

所以它只是一个基本的游戏循环，该`doLogic()`函数调用场景中角色的所有逻辑函数并`render(g, diff)`调用场景`animateChar`中每个角色的`animChar`函数，然后，Character类中的函数将屏幕中的所有内容设置为：

```
protected void animChar(long diff) {
        this.checkGravity();
        this.move((int) ((diff * this.dx) / 1000), (int) ((diff * this.dy) / 1000));
        if (this.acumFrame > this.framerate) {
            this.nextFrame();
            this.acumFrame = 0;
        } else {
            this.acumFrame += diff;
        }
    } 
```

这确保了我必须根据机器从一个周期到另一个周期所花费的时间来移动所有东西（记住它是一部手机，而不是游戏装备）。我确信这不是实现这种行为的最有效方法，所以我完全愿意在评论中批评我的编程技巧，但我的问题是：当我让我的角色跳跃时，我所做的就是把他的*dy*为负值，例如 -200，我将布尔*跳转*设置为 true，这使角色上升，然后我调用了这个函数`checkGravity()`，以确保上升的所有内容都必须下降，`checkGravity`同时检查角色是否在平台上，所以为了您的时间，我将把它删掉一点：

```
public void checkGravity() {
        if (this.jumping) {
            this.jumpSpeed += 10;
            if (this.jumpSpeed > 0) {
                this.jumping = false;
                this.falling = true;
            }
            this.dy = this.jumpSpeed;
        }
        if (this.falling) {
            this.jumpSpeed += 10;
            if (this.jumpSpeed > 200) this.jumpSpeed = 200;
            this.dy = this.jumpSpeed;
            if (this.collidesWithPlatform()) {
                this.falling = false;
                this.standing = true;
                this.jumping = false;
                this.jumpSpeed = 0;
                this.dy = this.jumpSpeed;
            }
        }
    } 
```

所以，问题是，这个函数会更新*dy*而不管*diff*，使角色在慢速机器中像超人一样飞行，我不知道如何实现*diff*因子，这样当一个角色跳跃时，他的速度减慢与游戏速度成正比的方式。谁能帮我解决这个问题？或者给我指点如何**在 J2ME 中以正确的方式进行 2D 跳转**。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T00:20:44.457

您不应该根据经过的时间调整 jumpSpeed 吗？也就是说，速度可能会变化 -75/秒，因此您的差异应该是应用于 jumpSpeed 的变化量的权重。

因此，将 diff 传递给 checkGrav 并执行类似... jumpSpeed += (diff * (rate_per_second)) / 1000;

（假设差异以毫秒为单位）

（理想情况下，这会让它就像真正的重力：D）

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T00:14:16.123

为什么不通过 diff 缩放所有常量？

顺便说一句，我很尴尬地这么说，但我在一个商业游戏中工作，其中重力对角色的下降是上升的两倍。出于某种原因，人们更喜欢这个。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:25:38.147

这似乎更多是关于游戏设计的问题，而不是跳跃的数学问题。一个常见的问题是，在不同处理器上运行的游戏中，一个游戏会执行得更快，而在其他游戏上会执行得更慢（从而改变游戏的整体速度）。我不确定游戏中的常见做法是什么，但每当我制作自制的 2D 游戏（制作它们很有趣）时，我都会有游戏标记的概念。在更快的机器上

```
long diff = System.currentTimeMillis() - lastLoop;
lastLoop = System.currentTimeMillis(); 
```

会更低。等待时间将从差异中得出，以便游戏在大多数机器上以相同的速度运行。我也会在一个单独的线程中使用渲染方法，这样游戏速度就不会依赖于图形。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-04-22T13:19:00.543

我可以给出这样的公式（我在任何地方都使用它）。X是它的参数，从零开始，到跳跃的长度结束。如果你想让某人在某个高度 (H) 和某个长度 (L) 处跳跃，那么跳跃的功能将如下所示（并且看起来永远不会有所不同）：

> y = 减（幂（x - 跳跃长度除以 2）乘以 4 并乘以跳跃高度）除以长度的幂并在最后加上跳跃高度。
> 
>   
>   
> 
> y = -(xl/2)(xl/2)*4*h/(l*l) + h

如果你想让跳跃的物体落在某个东西上，那么你可以检查每个新的 X 是否大致站在一个平台上，如果它站在某个东西上，那么不要让它停下来，让它的 Y 位置正好等于平台的 Y。

如果您使用的是 Flash 或其他具有倒置 y 轴的底座，则将函数输出乘以 -1；

# visual-studio - 类似于 Mole 的 Visual Studio 可视化工具

> ID：923827
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-05-29T00:07:51.503
> 
>         
> 
> 标签：visual-studio, debugging, visualizer

Visual Studio 中 WPF 的 Mole 可视化工具是调试 WPF 应用程序的绝佳工具。我想知道的是，是否有一个具有类似 Mole 功能的可视化工具，可用于一般的 .Net 调试。我发现内置的手表功能有点繁琐。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-09-05T09:28:41.150

自 MOLE 3.0 版以来，该工具已能够与所有类型的 Visual Studio 项目一起使用。[有关该工具以及如何获取最新版本的更多信息，请参见此处。](http://www.codeproject.com/KB/macros/MoleForVisualStudioEdit.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-09-07T06:53:13.610

我编写了一个名为[BugAid](http://www.bugaidsoftware.com)的商业工具，它与 Mole 一样，允许搜索/过滤/更轻松地查看集合，但适用于您所要求的通用编程。它取代了 Visual Studio 的 DataTip 和 QuickWatch，以便在 VS 中提供这些功能，当鼠标悬停在变量上时（而不是通过 DebugVisualizer）。

**全面披露：**我是我在这里描述的工具的合著者。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2011-04-14T06:14:21.153

Mole 2010 适用于所有 .net 对象。我只是将它用于 winforms 应用程序和 WCF 服务，效果很好。

如果您想查看它，他们有一个免费演示[http://www.molosoft.com](http://www.molosoft.com)

干杯!

# testing - 生成人员数据的来源？

> ID：923830
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:08:20.130
> 
>         
> 
> 标签：testing, test-data

这只是一个切向的编程问题。在哪里可以找到易于解析的人名列表？这实际上只是填充材料，因此它们不需要太多押韵或理由。

或者，当您需要创建一堆虚拟帐户时，是否有相当于[lorem ipsum的程序员？](http://en.wikipedia.org/wiki/Lorem_ipsum)

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T00:17:46.007

[您可以从Project Euler](http://projecteuler.net)问题 22 中的[names.txt](http://projecteuler.net/project/names.txt)（46 KiB，逗号分隔值）中随机抽取名称。

* * *

**编辑**：[美国人口普查局](http://www.census.gov)有[名字和姓氏的统计数据](http://www.census.gov/genealogy/names/names_files.html)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-06-10T13:49:57.603

查看[http://www.generatedata.com](http://www.generatedata.com)

Benjamin Keen 创造了这个非常棒的工具，它可能适合你。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:17:09.067

你总是可以使用一堆名字和数字：

```
firsts = [ "Dave", "John", "Jane", "Jack", ...];
seconds = [ "McMuffin", "Frontage", "Bush", "McProgrammer", ...];

for f in firsts {
    for s in seconds {
        for( i=0; i<10; i++){
            tmp_user = f + "_" + s + i;
            // Add user to database
        }
    }
} 
```

如果您添加更多用户名，那就是相当多的用户名:)

**祝你好运**

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:15:40.943

如果你只需要一些文本而不关心它的外观，你可以使用 Excel 之类的东西来生成一个大的名称列表。

例如：在单元格 A1 中输入**="FirstName" & ROW(A1)**然后选择您想要的行数并填写。在 B 列中对姓氏执行相同操作，另存为 CSV 并导入您的数据库。

或者你可以变得更聪明一点：将一些名字放在 A 列中，将一些姓氏放在 B 列中。

C1 的公式：

```
=OFFSET(A$1,INT(RAND()*[[number_of_first_names]]),0) 
```

和 D1 类似的东西：

```
=OFFSET(B$1,INT(RAND()*[[number_of_last_names]]),0) 
```

# c# - 滚动时所有者绘制 ListView“拖尾”

> ID：923834
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:09:43.670
> 
>         
> 
> 标签：c#, graphics, listview, ownerdrawn

我有一个所有者绘制的 ListView，当我滚动时它会“涂抹”。它只影响最后显示的项目，因为它移动到列表的可见区域......

看起来像：

> 呸呸呸
> 
>   呸
> 
>   _

...已全部绘制在彼此相距 1 个像素的顶部。DrawItem 事件中的代码形式为

```
Rectangle rect = new Rectangle(e.Bounds.X + mIconSize.Width, 
   e.Bounds.Y, e.Bounds.Width, e.Bounds.Height);
e.Graphics.DrawString(episode.ToString(), this.Font, mBlackBrush, rect); 
```

我完全被难住了。任何想法不胜感激！戴夫

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T02:54:22.713

您可以通过从 ListView 派生并设置来为 ListView 启用双缓冲`DoubleBuffered = true`。一旦打开双缓冲，闪烁就会明显减少，尤其是在平铺视图中。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-01-29T22:45:39.967

详细视图绘图在 DrawSubItem(...) 中完成所有绘图。问题是 drawItem 被第一个项目调用，而 DrawSubitem 也是同一个项目......边界略有不同。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T22:16:04.083

此外，在表单自身的属性中，您可以启用 DoubleBuffer。此外，您可以使用几个命令。

通过在 google 上搜索 DoubleBuffer C# 可以找到更多信息（对不起，作为新用户，我无法发布链接）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-09-18T07:42:37.520

这是 ListView 控件中的一个已知错误。

# .net - 我可以合并两个 .NET 数据表，而不合并空值，而不必自己循环遍历这些行吗？

> ID：923835
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T00:10:11.203
> 
>         
> 
> 标签：.net

假设我有两个 .NET DataTables 填充如下，其中 ID 是主键，其中`null`表示 a `DBNull.Value`（不是 string `"null"`）：

```
    |表A | |表B
    |ID |列 1 |列 2 | |ID |列 1 |列 2 |
    |1 |富 |10 | |1 |zzz |空 |
    |2 |巴兹 |20 | |2 |空 |99 |

```

我想合并这些表，结果将是：

```
    |ID |列 1 |列 2 |
    |1 |zzz |10 |
    |2 |巴兹 |99 |

```

换句话说，我想将表 B 中的数据合并到表 A 中，就像这样`DataTable.Merge`做一样，但是当 ID 匹配时，我不想从表 B 中复制整行，我只想复制数据不为空的字段。

我可以通过两个表的行编写自己的循环来执行此操作，但我想知道库中是否已经有一个方法，这样我就不必重写我自己的`DataTable.Merge`.

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T13:40:34.377

老鼠……我不认为我要找的东西存在。

对于它的价值，如果有人看到这个和我有同样的需求，这是我最终得到的“滚动我自己的”代码：

```
 // Merge 
        foreach (DataRow br in tableB.Rows)
        {
            // This assumes a one-column primary key. In my case,
            // that's valid, but not for a general-purpose function.
            DataRow ar = tableA.Rows.Find(br[tableB.PrimaryKey[0]]);
            if (ar == null)
            {
                continue;
                // If I really wanted it to act like DataTable.Merge, it would
                // add the missing row to tableA rather than just skipping it.
                // again, I didn't implement this because I didn't need it.
            }
            foreach (DataColumn ac in tableA.Columns)
            {
                DataColumn bc = tableB.Columns[ac.ColumnName];
                if (bc != null && !br.IsNull(bc))
                    ar[ac] = br[bc];
            }
        } 
```

正如评论所表明的那样，这并没有完成 DataTable.Merge 所做的所有事情，并且做出了一些通常无效的假设。不过，解决这些问题并不难。我把它留在这里以防它对某人有帮助。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:12:13.743

你可以试试这个：

```
public static DataTable Union (DataTable First, DataTable Second)
{

      //Result table
      DataTable table = new DataTable("Union");

      //Build new columns
      DataColumn[] newcolumns = new DataColumn[First.Columns.Count];

      for(int i=0; i < First.Columns.Count; i++)
      {
          newcolumns[i] = new DataColumn(
          First.Columns[i].ColumnName, First.Columns[i].DataType);
      }

      table.Columns.AddRange(newcolumns);
      table.BeginLoadData();

      foreach(DataRow row in First.Rows)
      {
           table.LoadDataRow(row.ItemArray,true);
      }

      foreach(DataRow row in Second.Rows)
      {
          table.LoadDataRow(row.ItemArray,true);
      }

      table.EndLoadData();
      return table;
} 
```

从[这里](http://weblogs.sqlteam.com/davidm/archive/2004/01/15/724.aspx)（未测试）。

# python - 如何在 Python 模板语言 Mako 中调用仅在运行时知道名称的模板定义？

> ID：923837
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:10:25.023
> 
>         
> 
> 标签：python, templates, mako

我试图找到一种调用由上下文中可用数据确定的 def 模板的方法。

**编辑：**同一问题的更简单实例。

可以在上下文中发出对象的值：

```
# in python
ctx = Context(buffer, website='stackoverflow.com')

# in mako
<%def name="body()">
I visit ${website} all the time.
</%def> 
```

产生：

```
I visit stackoverflow.com all the time. 
```

我想允许根据数据自定义输出。

```
# in python 
ctx = Context(buffer, website='stackoverflow.com', format='text')

# in mako
<%def name="body()">
I visit ${(format + '_link')(website)} all the time. <-- Made up syntax.
</%def>

<%def name='html_link(w)'>
<a href='http://${w}'>${w}</a>
</%def>

<%def name='text_link(w)'>
${w}
</%def> 
```

更改`format`上下文中的属性应更改输出

```
I visit stackoverflow.com all the time. 
```

至

```
I visit <a href='http://stackoverflow.com'>stackoverflow.com</a> all the time. 
```

我在 中使用的**编造语法**`body` `def`显然是错误的。我需要什么来动态指定一个模板，然后调用它？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-30T19:33:33.737

玩弄 mako 的`local`命名空间，但这里有一个工作示例：

```
from mako.template import Template
from mako.runtime import Context
from StringIO import StringIO

mytemplate = Template("""
<%def name='html_link(w)'>
<a href='http://${w}'>${w}</a>
</%def>
<%def name='text_link(w)'>
${w}
</%def>
<%def name="body()">
I visit ${getattr(local, format + '_link')(website)} all the time.
</%def>
""")

buf = StringIO()
ctx = Context(buf, website='stackoverflow.com', format='html')
mytemplate.render_context(ctx)
print buf.getvalue() 
```

根据需要，这会发出：

```
I visit 
<a href='http://stackoverflow.com'>stackoverflow.com</a>
 all the time. 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:48:31.677

如果您首先生成模板（从另一个模板 :)，然后使用您的数据运行它呢？

# wpf - VB.NET 中的可绑定 LINQ (BLinq)

> ID：923840
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:11:26.037
> 
>         
> 
> 标签：wpf, vb.net, linq, data-binding

在我的一生中，我无法让 Bindable LINQ 与 VB.NET 一起工作。如何让 .AsBindable 扩展出现？

示例代码：

```
Class TestList : Inherits Bindable.Linq.Collection.BindableCollection(Of TestItem)
  'Some Helpers and stuff'
End Class

Class TestItem
  'Some Properties'
End Class 
```

想象一下，我神奇地想出了一个装满物品的集合。我会尝试以下内容

```
DataContext = From G In TheList.AsBindable Order By G.Name 
```

但是我在 .AsBindable 上收到一个错误，即“AsBindable 不是 TestList 的成员”

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:42:11.043

不要取笑我，但我所要做的就是 Import Bindable.Linq

# netbeans - 即使定义了库，也找不到 Netbeans Javadoc

> ID：923845
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T00:12:33.117
> 
>         
> 
> 标签：netbeans, javadoc

我有一个问题，Netbeans 根本无法识别外部库中的 Javadocs。我进入了库路径并指定了一个有效的 javadoc 路径（Netbeans 接受该路径而没有错误）。但即使在重新构建/打开关闭 Netbeans 之后，对于库中的所有项目，我仍然会收到“找不到 Javadoc”错误。

由于没有错误消息，我被困在哪里，我可以使用网络浏览器浏览文档。有任何想法吗？

NEtbeans 的版本是 6.5.1 文件在已添加到库属性的 ​​Javadoc 选项卡的目录中解压缩。图书馆按预期工作。

我试过清除 Netbeans 缓存无效。

* * *

我让它工作了。我删除了库，重新创建它添加了 Javadocs。现在它完美地工作了。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T10:20:45.310

您能否更具体一点：您的 NetBeans 版本是什么？这些 javadocs 在哪里？它们是否解压在单独的文件夹、zip 文件、jar 文件中？

以下是 NetBeans 6.5 的一个有效解决方案示例：

*   转到项目属性 > 库对话框

*   在“编译”选项卡上，按“添加 JAR/文件夹”按钮并找到您的库

*   在“编译”选项卡上按“编辑”按钮并选择您的库

*   添加路径： a) 该库的 docs 文件夹，包含 index.html 和其余文件；b) zip 文件，包含该库 docs 文件夹；

它应该可以在不重新构建项目或重新启动 NetBeans 的情况下工作。

如果您创建了自定义库，则可以通过“工具 > 库”以非常相似的方式对其进行编辑

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T10:26:38.370

听起来类似于我最近遇到的一个问题，结果我所要做的就是删除缓存以强制 NetBeans 重建。

如果@slink84 的建议没有帮助，您可以从[我关于stackoverflow的问题中尝试@dr Hanibbal Lecter 的方法](https://stackoverflow.com/questions/873432/netbeans-php-code-completion)

# html - 将 HTML 从控制器传递到视图

> ID：923847
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:12:45.113
> 
>         
> 
> 标签：html, asp.net-mvc

我已经创建了一个结构，可以根据给定的角色从数据库中检索，以返回菜单项。

现在，我需要创建一个递归方法来在控制器中呈现这个 HTML 并将这个 HTML 传递给查看。但我只是不知道如何在控制器中编写本机 HTML。有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T00:15:27.307

控制器根本不应该处理任何 HTML。这就是 MVC 中的视图的用途。您的控制器应该从模型中传递一个数据结构，并且视图应该将该数据结构呈现为 HTML。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-09-03T07:31:59.653

比您想象的要容易：

控制器：

```
ViewData["html"] = @"<a href='http://www.stackoverflow.com'>Stack Overflow</a>"; 
```

看法：

```
<%= ViewData["html"] %> 
```

我同意这不是最好的方法。我建议您在视图中编写 html 标记并替换模型中的值。  

例如

控制器：

```
ViewData["Title"] = "Stack Overflow";
ViewData["Url"] = @"http://www.stackoverflow.com"; 
```

看法：

```
<a href="<%=Html.Encode( ViewData["Url"] )%>">
     <%=Html.Encode( ViewData["Title"] )%></a> 
```

如果您必须创建很多，您可以使用部分视图/用户控件来封装公共标记。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T00:18:48.220

在控制器中呈现 HTML**绝对**不是 MVC（或您正在做的任何事情）的想法。HTML 必须在视图中处理。如果您想提供替代 UI（例如 Windows 应用程序）怎么办？HTML 并不真正适合 WinApp。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-09-03T07:06:46.173

您可以使用 HTML 帮助程序来创建 HTML。例如，我们有一个非常复杂的菜单系统，所以我们创建了一个 HtmlHelper 扩展。这是一个简单的 html 扩展（我使用 TagBuilders 使 HTML 更容易......当你有很多嵌套标签时非常方便）。

```
 public static String MyNewExtension(this HtmlHelper html, String extraVariable)
  {
        if (html == null)
        {
            throw new ArgumentNullException("html");
        }

        TagBuilder h1Tag = newTagBuilder("h1");
        h1Tag.InnerHtml = extraVariable;
        return h1Tag.ToString();
  } 
```

# java - 在 Java 中将字符串转换为十六进制

> ID：923863
> 
>         
> 
> 赞同：115
> 
>         
> 
> 时间：2009-05-29T00:18:37.223
> 
>         
> 
> 标签：java, string, hex

我正在尝试将类似“testing123”的字符串转换为java中的十六进制形式。我目前正在使用 BlueJ。

并且将其转换回来，除了向后之外，它是一样的吗？

* * *

## 回答 #1

> 赞同：215
> 
>             
> 
> 时间：2010-01-27T20:12:41.543

这是将其转换为十六进制的简短方法：

```
public String toHex(String arg) {
    return String.format("%040x", new BigInteger(1, arg.getBytes(/*YOUR_CHARSET?*/)));
} 
```

* * *

## 回答 #2

> 赞同：65
> 
>             
> 
> 时间：2010-10-15T09:06:38.883

为确保十六进制的长度始终为 40 个字符，BigInteger 必须为正数：

```
public String toHex(String arg) {
  return String.format("%x", new BigInteger(1, arg.getBytes(/*YOUR_CHARSET?*/)));
} 
```

* * *

## 回答 #3

> 赞同：53
> 
>             
> 
> 时间：2012-01-24T19:57:08.940

```
import org.apache.commons.codec.binary.Hex;
...

String hexString = Hex.encodeHexString(myString.getBytes(/* charset */)); 
```

[http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Hex.html](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Hex.html)

* * *

## 回答 #4

> 赞同：20
> 
>             
> 
> 时间：2009-05-29T00:34:55.257

编码为十六进制的数字必须代表字符的某种编码，例如 UTF-8。因此，首先将 String 转换为代表该编码中字符串的 byte[]，然后将每个字节转换为十六进制。

```
public static String hexadecimal(String input, String charsetName) throws UnsupportedEncodingException {
    if (input == null) throw new NullPointerException();
    return asHex(input.getBytes(charsetName));
}

private static final char[] HEX_CHARS = "0123456789abcdef".toCharArray();

public static String asHex(byte[] buf)
{
    char[] chars = new char[2 * buf.length];
    for (int i = 0; i < buf.length; ++i)
    {
        chars[2 * i] = HEX_CHARS[(buf[i] & 0xF0) >>> 4];
        chars[2 * i + 1] = HEX_CHARS[buf[i] & 0x0F];
    }
    return new String(chars);
} 
```

* * *

## 回答 #5

> 赞同：20
> 
>             
> 
> 时间：2016-05-01T21:25:51.077

使用[`DatatypeConverter.printHexBinary()`](https://docs.oracle.com/javase/7/docs/api/javax/xml/bind/DatatypeConverter.html#printHexBinary(byte[]))：

```
public static String toHexadecimal(String text) throws UnsupportedEncodingException
{
    byte[] myBytes = text.getBytes("UTF-8");

    return DatatypeConverter.printHexBinary(myBytes);
} 
```

示例用法：

```
System.out.println(toHexadecimal("Hello StackOverflow")); 
```

印刷：

```
48656C6C6F20537461636B4F766572666C6F77 
```

**注意**：这会导致一些额外的麻烦`Java 9`和更新，因为默认情况下不包含 API。供参考，例如看到[这个](https://github.com/http-kit/http-kit/issues/356) `GitHub`问题。

* * *

## 回答 #6

> 赞同：11
> 
>             
> 
> 时间：2012-04-11T07:37:22.127

这是另一个解决方案

```
public static String toHexString(byte[] ba) {
    StringBuilder str = new StringBuilder();
    for(int i = 0; i < ba.length; i++)
        str.append(String.format("%x", ba[i]));
    return str.toString();
}

public static String fromHexString(String hex) {
    StringBuilder str = new StringBuilder();
    for (int i = 0; i < hex.length(); i+=2) {
        str.append((char) Integer.parseInt(hex.substring(i, i + 2), 16));
    }
    return str.toString();
} 
```

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2013-08-15T20:34:05.247

所有基于 String.getBytes() 的答案都涉及根据字符集对字符串进行**编码。**您不一定要获得构成字符串的 2 字节**字符的十六进制值。**如果您真正想要的是相当于十六进制查看器，那么您需要直接访问字符。这是我在代码中用于调试 Unicode 问题的函数：

```
static String stringToHex(String string) {
  StringBuilder buf = new StringBuilder(200);
  for (char ch: string.toCharArray()) {
    if (buf.length() > 0)
      buf.append(' ');
    buf.append(String.format("%04x", (int) ch));
  }
  return buf.toString();
} 
```

然后， stringToHex("testing123") 会给你：

```
0074 0065 0073 0074 0069 006e 0067 0031 0032 0033 
```

* * *

## 回答 #8

> 赞同：5
> 
>             
> 
> 时间：2012-06-11T12:56:43.617

获取十六进制的整数值

```
 //hex like: 0xfff7931e to int
        int hexInt = Long.decode(hexString).intValue(); 
```

* * *

## 回答 #9

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T00:28:59.653

我会建议这样的事情，`str`你的输入字符串在哪里：

```
StringBuffer hex = new StringBuffer();
char[] raw = tokens[0].toCharArray();
for (int i=0;i<raw.length;i++) {
    if     (raw[i]<=0x000F) { hex.append("000"); }
    else if(raw[i]<=0x00FF) { hex.append("00" ); }
    else if(raw[i]<=0x0FFF) { hex.append("0"  ); }
    hex.append(Integer.toHexString(raw[i]).toUpperCase());
} 
```

* * *

## 回答 #10

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T00:39:35.060

```
byte[] bytes = string.getBytes(CHARSET); // you didn't say what charset you wanted
BigInteger bigInt = new BigInteger(bytes);
String hexString = bigInt.toString(16); // 16 is the radix 
```

您可以`hexString`在此时返回，但需要注意的是前导空字符将被剥离，如果第一个字节小于 16，则结果将具有奇数长度。如果您需要处理这些情况，您可以添加一些额外的代码用 0 填充：

```
StringBuilder sb = new StringBuilder();
while ((sb.length() + hexString.length()) < (2 * bytes.length)) {
  sb.append("0");
}
sb.append(hexString);
return sb.toString(); 
```

* * *

## 回答 #11

> 赞同：4
> 
>             
> 
> 时间：2013-11-19T12:52:20.967

转换十六进制代码中的字母和字母中的十六进制代码。

```
 String letter = "a";
    String code;
    int decimal;

    code = Integer.toHexString(letter.charAt(0));
    decimal = Integer.parseInt(code, 16);

    System.out.println("Hex code to " + letter + " = " + code);
    System.out.println("Char to " + code + " = " + (char) decimal); 
```

* * *

## 回答 #12

> 赞同：3
> 
>             
> 
> 时间：2014-10-17T21:13:19.757

换一种方式（十六进制到字符串），您可以使用

```
public String hexToString(String hex) {
    return new String(new BigInteger(hex, 16).toByteArray());
} 
```

* * *

## 回答 #13

> 赞同：2
> 
>             
> 
> 时间：2015-04-02T10:05:59.343

首先使用 getBytes() 函数将其转换为字节，然后将其转换为十六进制 ussign this ：

```
private static String hex(byte[] bytes) {
    StringBuilder sb = new StringBuilder();
    for (int i=0; i<bytes.length; i++) {
        sb.append(String.format("%02X ",bytes[i]));
    }
    return sb.toString();
} 
```

* * *

## 回答 #14

> 赞同：2
> 
>             
> 
> 时间：2021-09-06T06:15:33.477

没有外部库的一行 HEX 编码/解码（Java 8 及更高版本）：

编码：

```
String hexString = inputString.chars().mapToObj(c -> 
Integer.toHexString(c)).collect(Collectors.joining()); 
```

解码：

```
String decodedString = Stream.iterate(0, i -> i+2)
                .limit(hexString.length()/2 + Math.min(hexString.length()%2,1))
                .map(i -> "" + (char)Integer.parseInt("" + hexString.charAt(i) + hexString.charAt(i+1),16))
                .collect(Collectors.joining()); 
```

* * *

## 回答 #15

> 赞同：2
> 
>             
> 
> 时间：2019-09-10T08:53:08.633

使用来自多个线程的多人帮助..

我知道这已经得到解答，但我想为我遇到同样情况的任何其他人提供一个完整的编码和解码方法..

这是我的编码和解码方法..

```
// Global Charset Encoding
public static Charset encodingType = StandardCharsets.UTF_8;

// Text To Hex
public static String textToHex(String text)
{
    byte[] buf = null;
    buf = text.getBytes(encodingType);
    char[] HEX_CHARS = "0123456789abcdef".toCharArray();
    char[] chars = new char[2 * buf.length];
    for (int i = 0; i < buf.length; ++i)
    {
        chars[2 * i] = HEX_CHARS[(buf[i] & 0xF0) >>> 4];
        chars[2 * i + 1] = HEX_CHARS[buf[i] & 0x0F];
    }
    return new String(chars);
}

// Hex To Text
public static String hexToText(String hex)
{
    int l = hex.length();
    byte[] data = new byte[l / 2];
    for (int i = 0; i < l; i += 2)
    {
        data[i / 2] = (byte) ((Character.digit(hex.charAt(i), 16) << 4)
            + Character.digit(hex.charAt(i + 1), 16));
    }
    String st = new String(data, encodingType);
    return st;
} 
```

* * *

## 回答 #16

> 赞同：1
> 
>             
> 
> 时间：2015-12-14T22:58:47.043

**将字符串转换为十六进制**：

```
public String hexToString(String hex) {
    return Integer.toHexString(Integer.parseInt(hex));
} 
```

这绝对是最简单的方法。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2012-06-05T10:33:43.940

好多了：

```
public static String fromHexString(String hex, String sourceEncoding ) throws  IOException{
    ByteArrayOutputStream bout = new ByteArrayOutputStream();
    byte[] buffer = new byte[512];
    int _start=0;
    for (int i = 0; i < hex.length(); i+=2) {
        buffer[_start++] = (byte)Integer.parseInt(hex.substring(i, i + 2), 16);
        if (_start >=buffer.length || i+2>=hex.length()) {
            bout.write(buffer);
            Arrays.fill(buffer, 0, buffer.length, (byte)0);
            _start  = 0;
        }
    }

    return  new String(bout.toByteArray(), sourceEncoding);
} 
```

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2012-08-01T05:12:26.650

```
import java.io.*;
import java.util.*;

public class Exer5{

    public String ConvertToHexadecimal(int num){
        int r;
        String bin="\0";

        do{
            r=num%16;
            num=num/16;

            if(r==10)
            bin="A"+bin;

            else if(r==11)
            bin="B"+bin;

            else if(r==12)
            bin="C"+bin;

            else if(r==13)
            bin="D"+bin;

            else if(r==14)
            bin="E"+bin;

            else if(r==15)
            bin="F"+bin;

            else
            bin=r+bin;
        }while(num!=0);

        return bin;
    }

    public int ConvertFromHexadecimalToDecimal(String num){
        int a;
        int ctr=0;
        double prod=0;

        for(int i=num.length(); i>0; i--){

            if(num.charAt(i-1)=='a'||num.charAt(i-1)=='A')
            a=10;

            else if(num.charAt(i-1)=='b'||num.charAt(i-1)=='B')
            a=11;

            else if(num.charAt(i-1)=='c'||num.charAt(i-1)=='C')
            a=12;

            else if(num.charAt(i-1)=='d'||num.charAt(i-1)=='D')
            a=13;

            else if(num.charAt(i-1)=='e'||num.charAt(i-1)=='E')
            a=14;

            else if(num.charAt(i-1)=='f'||num.charAt(i-1)=='F')
            a=15;

            else
            a=Character.getNumericValue(num.charAt(i-1));
            prod=prod+(a*Math.pow(16, ctr));
            ctr++;
        }
        return (int)prod;
    }

    public static void main(String[] args){

        Exer5 dh=new Exer5();
        Scanner s=new Scanner(System.in);

        int num;
        String numS;
        int choice;

        System.out.println("Enter your desired choice:");
        System.out.println("1 - DECIMAL TO HEXADECIMAL             ");
        System.out.println("2 - HEXADECIMAL TO DECIMAL              ");
        System.out.println("0 - EXIT                          ");

        do{
            System.out.print("\nEnter Choice: ");
            choice=s.nextInt();

            if(choice==1){
                System.out.println("Enter decimal number: ");
                num=s.nextInt();
                System.out.println(dh.ConvertToHexadecimal(num));
            }

            else if(choice==2){
                System.out.println("Enter hexadecimal number: ");
                numS=s.next();
                System.out.println(dh.ConvertFromHexadecimalToDecimal(numS));
            }
        }while(choice!=0);
    }
} 
```

* * *

## 回答 #19

> 赞同：0
> 
>             
> 
> 时间：2015-09-16T09:26:49.197

```
new BigInteger(1, myString.getBytes(/*YOUR_CHARSET?*/)).toString(16) 
```

* * *

## 回答 #20

> 赞同：0
> 
>             
> 
> 时间：2016-10-18T17:02:44.730

[以下是一些](https://github.com/jamespedwards42/jhex#benchmarks)比较不同方法和库的基准。Guava 在解码方面击败了 Apache Commons Codec。Commons Codec 在编码方面击败了 Guava。JHex 在解码和编码方面都击败了他们。

### JHex 示例

```
String hexString = "596f752772652077656c636f6d652e";
byte[] decoded = JHex.decodeChecked(hexString);
System.out.println(new String(decoded));
String reEncoded = JHex.encode(decoded); 
```

一切都在[JHex 的单个类文件中](https://github.com/jamespedwards42/jhex/blob/master/src/main/java/com/fabahaba/encode/JHex.java#L7)。如果您不想在依赖关系树中再添加一个库，请随意复制粘贴。另请注意，在我弄清楚如何使用 Gradle 和 Bintray 插件发布多个发布目标之前，它只能作为 Java 9 jar 使用。

* * *

## 回答 #21

> 赞同：0
> 
>             
> 
> 时间：2019-03-30T07:23:48.720

检查此解决方案的 String to hex 和 hex to String 反之亦然

```
public class TestHexConversion {
public static void main(String[] args) {
    try{
        String clearText = "testString For;0181;with.love";
        System.out.println("Clear Text  = " + clearText);
        char[] chars = clearText.toCharArray();
        StringBuffer hex = new StringBuffer();
        for (int i = 0; i < chars.length; i++) {
            hex.append(Integer.toHexString((int) chars[i]));
        }
        String hexText = hex.toString();
        System.out.println("Hex Text  = " + hexText);
        String decodedText = HexToString(hexText);
        System.out.println("Decoded Text = "+decodedText);
    } catch (Exception e){
        e.printStackTrace();
    }
}

public static String HexToString(String hex){

      StringBuilder finalString = new StringBuilder();
      StringBuilder tempString = new StringBuilder();

      for( int i=0; i<hex.length()-1; i+=2 ){
          String output = hex.substring(i, (i + 2));
          int decimal = Integer.parseInt(output, 16);
          finalString.append((char)decimal);
          tempString.append(decimal);
      }
    return finalString.toString();
} 
```

输出如下：

> 明文 = testString For;0181;with.love
> 
> 十六进制文本 = 74657374537472696e6720466f723b303138313b776974682e6c6f7665
> 
> 解码文本 = testString For;0181;with.love

* * *

## 回答 #22

> 赞同：-1
> 
>             
> 
> 时间：2018-07-31T08:02:58.487

A short and convenient way to convert a String to its Hexadecimal notation is:

```
public static void main(String... args){
String str = "Hello! This is test string.";
char ch[] = str.toCharArray();
StringBuilder sb = new StringBuilder();
    for (int i = 0; i < ch.length; i++) {
        sb.append(Integer.toHexString((int) ch[i]));
    }
    System.out.println(sb.toString());
} 
```

# windows - 如何确定另一个进程（Windows）的键盘布局？

> ID：923866
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T00:19:30.887
> 
>         
> 
> 标签：windows, keyboard-layout

我正在开发一个需要记录和回放击键的程序。主进程作为服务运行，因此它需要一个配置程序来记录击键。

当系统默认键盘布局是（比如说）英语，而用户当前的键盘布局是（比如说）德语时，就会出现问题。用户在配置界面中输入一个“ü”字符，该字符被适当记录和存储。

现在用户运行记事本并尝试播放击键，这是由服务的子项完成的。当将输入转换为传递给 时`SendInput`，我们调用`VkKeyScan`，然后它告诉我们无法在此键盘上重现该字符（请记住默认键盘布局是英文）。

我真正想做的是同步服务的键盘布局和当前的前台应用程序，这样服务就可以重现用户可以使用键盘的任何字符。`GetKeyboardLayout`仅适用于当前进程。这必须在 32 位和 64 位上运行，因此消息挂钩是......不是首选:)。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-06-05T02:34:53.637

要检索前台窗口的键盘布局：

```
GetKeyboardLayout(GetWindowThreadProcessId(GetForegroundWindow(), NULL)) 
```

听起来您正在录制字符而不是击键。重播时不发送击键，您可以使用 SendMessage 发送带有录制字符的 WM_CHAR 消息而不是生成击键吗？

# vmware-server - 使用 iso 创建 VMware vmdk

> ID：923874
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-05-29T00:24:44.123
> 
>         
> 
> 标签：vmware-server, iso

谁能给我一些关于如何使用 Iso 创建 Vmware 环境的文档。

例如，有一个人制作了自己的 Ubuntu 版本，并添加了许多额外的程序。在我尝试这个之前，我将使用 vmware 服务器对其进行测试。但我对如何仅使用 ISO 文件执行此操作有点困惑。

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-05-29T00:34:24.213

只需创建一个新 VM 并将 ISO 附加到虚拟 CD-ROM 驱动器中。您可以在创建 VM 时执行此操作。当您启动它时，您将能够像在真机上一样安装它。

# flash - 如何使用 actionscript 3 创建一个自动滚动的动态 txt 字段？

> ID：923875
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:25:23.077
> 
>         
> 
> 标签：flash, actionscript-3, movieclip

我正在尝试将滚动文本添加到我正在处理的小型 mp3 播放器应用程序中，并且遇到了一些问题。也就是说，我对电影剪辑并不那么精通。

我想知道是否有人知道任何用于自动滚动文本或基本电影剪辑（帧等）的好的 actioncipt 3 教程。我找到了很多教程，但似乎都有些遥不可及。谢谢你的关注，丹

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T13:05:26.617

在我看来，使某些东西滚动的最简单的解决方案。

第 1 层（蒙版层 -> 为可滚动区域制作蒙版第 2 层（蒙版层）-> 将您的显示对象（文本字段/电影剪辑/..）放在那里

通过调整遮罩层的y轴来控制滚动

它很快而且绝对不难做到

# c# - 为什么我的汉字在c#字符串中显示不正确

> ID：923876
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T00:25:31.373
> 
>         
> 
> 标签：c#, asp.net, sql-server

我将中文和英文文本存储在 SQL Server 2005 数据库中并显示在网页上，但中文显示不正确。我一直在阅读有关该主题的内容并做了以下工作：

*   在我的 INSERT 语句中的文本之前使用了 N

*   将字段类型设置为 nvarchar

*   将页面的字符集设置为 UTF-8

当我将它们直接插入页面时，中文字符在页面中正确显示，即不要从数据库中获取它们

这些是应该显示的字：全澳甲流封已破100

这是从数据库中检索文本时显示的内容：å…¨æ¾³ç”²æµç¡®è¯Šç—...ä¾‹å·²ç ´1001

这似乎与 c# 中如何处理字符串有关，因为中文可以在经典 asp 中正确检索和显示

我还需要做些什么才能将数据从数据库中取出，放入字符串并在 aspx 页面上正确输出？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T04:55:49.073

到目前为止的信息是：

1.  您正在使用直接 SQL INSERT 脚本插入数据库。

2.  数据在数据库中出现损坏。

问题可能出在两个地方：

1.  在您的 INSERT 语句中，您是否使用 N 作为插入值的前缀？

    INSERT INTO #tmp VALUES（N'全澳甲流病例已破100'）

2.  如果在值前面加上 N，那么 String 对象是否包含正确的数据？

    String sql = "INSERT INTO #tmp VALUES (N'" + value + "')"

这里我假设**value**是一个 String 对象。

这个 String 对象是否包含正确的汉字？

尝试打印出它的值并查看。

**更新**：

假设 INSERT 查询的构造如下：

```
String sql = "INSERT INTO #tmp VALUES (N' " + value + "')" 
```

我假设**value**持有汉字。

你是直接把汉字赋值给value的吗？喜欢

```
String value = "全澳甲流确诊病例已破100"; 
```

上面的代码应该可以工作。但是，如果您进行了任何中间处理，则会导致问题。

之前做过本地化的TC项目；之前的架构师已经完成了一些 ASP 中必需的编码转换；但它们会在 .NET 中产生问题：

```
 String value = "全澳甲流确诊病例已破100";
  Encoding tc = Encoding.GetEncoding("BIG5");
  byte[] bytes = tc.GetBytes(value);
  value = Encoding.Unicode.GetString(bytes); 
```

上述转换是不必要的。在 .NET 中，只需直接分配即可：

```
 String value = "全澳甲流确诊病例已破100"; 
```

那是因为 String 常量和 String 对象本身是 Unicode 兼容的。

框架库，如File IO，在读取非Unicode编码的文件时，会将外部编码转换为Unicode；换句话说，框架将为您完成这项肮脏的工作。大多数时候您不需要执行手动编码转换。

**更新**：了解 ASP 用于将数据插入 SQL 服务器。

我写了一小段 ASP 来将一些中文字符插入 SQL 数据库，它可以工作。

我有一个名为“trans”的数据库，并在其中创建了一个表“temp”。**ASP 页以 UTF-8 编码。** 

```
<html>
<head title="Untitled">
<meta http-equiv="content-type" content="text/html";charset="utf-8">
</head>
<body>
<script language="vbscript" runat="server">

If Request.Form("Button1") = "Submit" Then

    SqlQuery = "INSERT INTO trans..temp VALUES (N'" + Request.Form("Text1") + "')"

    Set cn = Server.CreateObject("ADODB.Connection")
    cn.Provider = "sqloledb"
    cn.Properties("Data Source").Value = *********
    cn.Properties("Initial Catalog").Value = "TRANS"
    cn.Properties("User ID").Value = "sa"
    cn.Properties("Password").Value = **********
    cn.Properties("Persist Security Info").Value = False

    cn.Open
    cn.Execute(SqlQuery)
    cn.Close

    Set cn = Nothing

    Response.Write SqlQuery
End If

</script>
<form name="form1" method="post" action="input.asp">
    <input name="Text1" type="text" />
    <input name="Button1" value="Submit" type="submit" />
</form>        
</body>
</html> 
```

该表在我的数据库中定义如下：

```
 create table temp (data NVARCHAR(100)) 
```

多次提交ASP页面，我的表中包含正确的中文数据：

```
select * from trans..temp

data
----------------
test
测试
全澳甲流确诊病例已破100 
```

希望这能有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:39:50.240

角色是如何进入数据库的？您是通过存储过程输入它们吗？确保存储过程中的参数也是 nvarchar 并且在您从中调用过程的命令对象上的参数上。

更新：线程上的共识是数据库没有正确编码的 NVARCHAR 内容。这是我的最新*理论*：数据库具有 UTF8 字节。这些字节在从 ASP 输出时保持不变。ASP.NET 采用 UTF8 字节并将其解释为单字节字符。

尝试从数据库中获取字节，并将其解码为 UTF8，例如：

```
SqlCommand command = new SqlCommand("SELECT zhtext FROM TestTable", connection);
byte[] byteArray = (byte[])command.ExecuteScalar();
lblText.Text = Encoding.UTF8.GetString(byteArray); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T08:25:55.353

我的总结如下：

*   在 ASP 中正确显示的字符

*   SSMS 中显示的字符乱码

*   ASP.Net中显示的字符乱码

结论：数据库中的数据编码不正确，需要将数据迁移到 unicode 中，以便在 C# 中处理它们，正如 Ryan 所描绘的那样。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:38:57.213

在从数据库到 c# 字符串的往返过程中的某个时刻，这绝对是字符串编码的问题，但是从它的声音来看，您所做的一切都是正确的。

对于我们的数据库，我们将 Unicode 数据存储在 NVARCHAR() 列中，然后将它们读出为普通的 C# 字符串；无需更改文本编码。你使用什么样的数据对象（即DataSets，只是一个DataReader，LINQtoSQL）？

在我们的应用程序中，我们使用 FetchDataSet 读取存储过程的结果，然后执行 DataBinder.Eval() 来分配最终成为标签文本的字符串。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:00:20.713

您是否在 Windows 中安装了“支持东方语言”？是XP吗？如果是这种情况，您的数据可能一切正常，只是 SQL 管理工作室没有正确显示它。（即使没有“支持中文”，所有真字体都显示正常，但系统字体不显示）

# c# - 将标签插入sqlite DB，C#的问题

> ID：923877
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:25:34.247
> 
>         
> 
> 标签：c#, sqlite

我有 2 张桌子

```
 "CREATE TABLE if not exists tag_name( " +
        "tagid INTEGER PRIMARY KEY, " +
        "title TEXT UNIQUE);";

        "CREATE TABLE if not exists media_tags( " +
        "media_id INTEGER, " +
        "tagid INTEGER);"; 
```

然后我用这段代码插入它们。问题是，last_insert_rowid 不是我所期望的。我希望当 INSERT 被忽略时，它将返回导致插入失败的 rowid。例如，如果我插入“tag1”、“tag2”、“tag3”。然后插入“tag2”，我希望返回 2 而不是最后插入的成功的行。我该如何解决这个问题？

```
 void insertMediaTags(List<string> tags, long mediaId)
        {
            foreach(string tag in tags)
            {
                command.CommandText = 
                    "INSERT OR IGNORE INTO tag_name(title) VALUES(@title); " +
                    "SELECT last_insert_rowid() AS RecordID;";
                command.Parameters.Add("@title", DbType.String).Value = tag;
                long tagid = (long)command.ExecuteScalar();
                command.CommandText =
                    "INSERT INTO media_tags(media_id, tagid) " +
                    "VALUES(@media_id, @tagid);";
                command.Parameters.Add("@media_id", DbType.Int32).Value = mediaId;
                command.Parameters.Add("@tagid", DbType.Int64).Value = tagid;
                command.ExecuteNonQuery();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:45:59.743

这可能不是最好的解决方案，但使用 SELECT 语句并检查对象是否为空是可行的。

-edit- 我懒得更改和测试它，但代码应该做一个插入......出于货币安全原因不存在的地方（选择）。

```
 void insertMediaTags(List<string> tags, long mediaId)
    {
        foreach(string tag in tags)
        {
            long tagId;
            command.CommandText = "SELECT tagid FROM tag_name WHERE title=@title;";
            command.Parameters.Add("@title", DbType.String).Value = tag;
            object o = command.ExecuteScalar();
            if (o == null)
            {
                command.CommandText =
                    "INSERT OR IGNORE INTO tag_name(title) VALUES(@title); " +
                    "SELECT last_insert_rowid() AS RecordID;";
                command.Parameters.Add("@title", DbType.String).Value = tag;
                tagId = (long)command.ExecuteScalar();
            }
            else
                tagId = (long)o;

            command.CommandText =
                "INSERT INTO media_tags(media_id, tagid) " +
                "VALUES(@media_id, @tagid);";
            command.Parameters.Add("@media_id", DbType.Int32).Value = mediaId;
            command.Parameters.Add("@tagid", DbType.Int64).Value = tagId;
            command.ExecuteNonQuery();
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T02:33:03.550

如果您使用`INSERT OR REPLACE`而不是`INSERT OR IGNORE`，我相信这`last_insert_rowid`将如您所愿。

# c - 使用 LD_PRELOAD 替换 Linux 系统调用时出现问题

> ID：923880
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:26:30.623
> 
>         
> 
> 标签：c, linux, system-calls, library-interposition

我正在尝试编写一个允许运行二进制文件的程序，并在请求时用另一个文件替换某个文件。它是一个简单替换系统调用函数的库，与 LD_PRELOAD 一起使用。问题是它捕获打开读取（替代文件被读取），但写入总是回到实际的指定文件。还有其他我应该知道的“开放”系统调用吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T01:08:36.747

没关系——愚蠢的错误。

没有检查绝对路径和相对路径......

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T00:34:22.107

我不确定您的问题的原因是什么，但是在您的程序上使用[strace](http://sourceforge.net/projects/strace/)可能会提供一些见解。它应该是任何健全的 Linux 发行版的一部分。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T00:38:51.193

如果它对写作开放，它很可能会通过该`creat`功能（我猜`fopen`会将您重定向到那里）。检查您`fcntl.h`的完整列表。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:34:22.497

> 请求时用另一个文件替换某个文件

听起来你只检查输入文件（你检查文件名吗？）。您还需要检查并*替换*输出文件。

如果您的输出转到标准输出之一，那么您需要在 fork 到可执行文件之前关闭并使用输出替代品重新打开它们。

要查找可执行文件进行的所有系统调用，您可以使用[strace](http://en.wikipedia.org/wiki/Strace)。

要查找可执行文件进行的所有库调用，您可以使用[ltrace](http://en.wikipedia.org/wiki/Ltrace)。

# javascript - 将 HTML Canvas 捕获为 gif/jpg/png/pdf？

> ID：923885
> 
>         
> 
> 赞同：768
> 
>         
> 
> 时间：2009-05-29T00:28:27.797
> 
>         
> 
> 标签：javascript, html, canvas, export, png

是否可以将 html 画布中显示的内容捕获或打印为图像或 pdf？

我想通过画布生成一个图像，并能够从该图像生成一个 png。

* * *

## 回答 #1

> 赞同：796
> 
>             
> 
> 时间：2010-08-18T16:37:57.370

原始答案是针对类似问题的。这已被修改：

```
var canvas = document.getElementById("mycanvas");
var img    = canvas.toDataURL("image/png"); 
```

使用 IMG 中的值，您可以将其写为新图像，如下所示：

```
document.getElementById("existing-image-id").src = img; 
```

或者

```
document.write('<img src="'+img+'"/>'); 
```

* * *

## 回答 #2

> 赞同：119
> 
>             
> 
> 时间：2009-05-29T02:48:41.320

HTML5 提供 Canvas.toDataURL(mimetype)，它在 Opera、Firefox 和 Safari 4 beta 中实现。然而，有许多安全限制（主要与从另一个来源绘制内容到画布上有关）。

所以你不需要额外的库。

例如

```
 <canvas id=canvas width=200 height=200></canvas>
 <script>
      window.onload = function() {
          var canvas = document.getElementById("canvas");
          var context = canvas.getContext("2d");
          context.fillStyle = "green";
          context.fillRect(50, 50, 100, 100);
          // no argument defaults to image/png; image/jpeg, etc also work on some
          // implementations -- image/png is the only one that must be supported per spec.
          window.location = canvas.toDataURL("image/png");
      }
 </script> 
```

从理论上讲，这应该创建然后导航到中间有一个绿色方块的图像，但我还没有测试过。

* * *

## 回答 #3

> 赞同：48
> 
>             
> 
> 时间：2013-07-01T14:52:10.553

我想我会稍微扩大一下这个问题的范围，在这个问题上提供一些有用的花絮。

为了将画布作为图像获取，您应该执行以下操作：

```
var canvas = document.getElementById("mycanvas");
var image = canvas.toDataURL("image/png"); 
```

您可以使用它来将图像写入页面：

```
document.write('<img src="'+image+'"/>'); 
```

其中“image/png”是一种 mime 类型（png 是唯一必须支持的类型）。如果您想要一个受支持类型的数组，您可以按照以下方式执行操作：

```
var imageMimes = ['image/png', 'image/bmp', 'image/gif', 'image/jpeg', 'image/tiff']; //Extend as necessary 
var acceptedMimes = new Array();
for(i = 0; i < imageMimes.length; i++) {
    if(canvas.toDataURL(imageMimes[i]).search(imageMimes[i])>=0) {
        acceptedMimes[acceptedMimes.length] = imageMimes[i];
    }
} 
```

您只需每页运行一次 - 它永远不会在页面的生命周期中改变。

如果您希望用户在保存文件时下载文件，您可以执行以下操作：

```
var canvas = document.getElementById("mycanvas");
var image = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream"); //Convert image to 'octet-stream' (Just a download, really)
window.location.href = image; 
```

如果您使用不同的 mime 类型，请务必更改 image/png 的两个实例，而不是 image/octet-stream。还值得一提的是，如果在渲染画布时使用任何跨域资源，在尝试使用 toDataUrl 方法时会遇到安全错误。

* * *

## 回答 #4

> 赞同：42
> 
>             
> 
> 时间：2015-05-22T09:40:58.450

```
function exportCanvasAsPNG(id, fileName) {

    var canvasElement = document.getElementById(id);

    var MIME_TYPE = "image/png";

    var imgURL = canvasElement.toDataURL(MIME_TYPE);

    var dlLink = document.createElement('a');
    dlLink.download = fileName;
    dlLink.href = imgURL;
    dlLink.dataset.downloadurl = [MIME_TYPE, dlLink.download, dlLink.href].join(':');

    document.body.appendChild(dlLink);
    dlLink.click();
    document.body.removeChild(dlLink);
} 
```

* * *

## 回答 #5

> 赞同：20
> 
>             
> 
> 时间：2011-02-02T02:33:21.773

我会使用“ [wkhtmltopdf](http://wkhtmltopdf.org/) ”。它工作得很好。它使用 webkit 引擎（用于 Chrome、Safari 等），并且非常好用：

```
wkhtmltopdf stackoverflow.com/questions/923885/ this_question.pdf 
```

而已！

[试试看](http://wkhtmltopdf.org/)

* * *

## 回答 #6

> 赞同：15
> 
>             
> 
> 时间：2013-07-22T17:33:59.317

如果您通过服务器进行下载，这里有一些帮助（这样您可以命名/转换/后处理/等您的文件）：

- 使用发布数据`toDataURL`

- 设置标题

```
$filename = "test.jpg"; //or png
header('Content-Description: File Transfer');
if($msie = !strstr($_SERVER["HTTP_USER_AGENT"],"MSIE")==false)      
  header("Content-type: application/force-download");else       
  header("Content-type: application/octet-stream"); 
header("Content-Disposition: attachment; filename=\"$filename\"");   
header("Content-Transfer-Encoding: binary"); 
header("Expires: 0"); header("Cache-Control: must-revalidate"); 
header("Pragma: public"); 
```

- 创建图像

```
$data = $_POST['data'];
$img = imagecreatefromstring(base64_decode(substr($data,strpos($data,',')+1))); 
```

- 将图像导出[为 JPEG](https://stackoverflow.com/a/2570015/669677)

```
$width = imagesx($img);
$height = imagesy($img);
$output = imagecreatetruecolor($width, $height);
$white = imagecolorallocate($output,  255, 255, 255);
imagefilledrectangle($output, 0, 0, $width, $height, $white);
imagecopy($output, $img, 0, 0, 0, 0, $width, $height);
imagejpeg($output);
exit(); 
```

- 或[作为透明 PNG](https://stackoverflow.com/a/4813540/669677)

```
imagesavealpha($img, true);
imagepng($img);
die($img); 
```

* * *

## 回答 #7

> 赞同：10
> 
>             
> 
> 时间：2019-09-23T06:38:35.353

这是另一种方式，没有字符串，虽然我真的不知道它是否更快。而不是 toDataURL （正如这里提出的所有问题）。在我的情况下，想要阻止 dataUrl/base64，因为我需要一个数组缓冲区或视图。所以 HTMLCanvasElement 中的另一个方法是`toBlob`. （打字稿功能）：

```
 export function canvasToArrayBuffer(canvas: HTMLCanvasElement, mime: string): Promise<ArrayBuffer> {
  return new Promise((resolve, reject) => canvas.toBlob(async (d) => {
    if (d) {
      const r = new FileReader();
      r.addEventListener('loadend', e => {
        const ab = r.result;
        if (ab) {
          resolve(ab as ArrayBuffer);
        }
        else {
           reject(new Error('Expected FileReader result'));
        }
      }); r.addEventListener('error', e => {
        reject(e)
      });
      r.readAsArrayBuffer(d);
    }
    else {
      reject(new Error('Expected toBlob() to be defined'));
    }
  }, mime));
} 
```

Blob 的另一个优点是您可以创建 ObjectUrls 来将数据表示为文件，类似于 HTMLInputFile 的“文件”成员。更多信息：

[https://developer.mozilla.org/en/docs/Web/API/HTMLCanvasElement/toBlob](https://developer.mozilla.org/en/docs/Web/API/HTMLCanvasElement/toBlob)

* * *

## 回答 #8

> 赞同：8
> 
>             
> 
> 时间：2013-05-21T11:28:05.740

另一个有趣的解决方案是[PhantomJS](http://phantomjs.org/)。它是一个可使用 JavaScript 或 CoffeeScript 编写脚本的无头 WebKit。

用例之一是屏幕截图：您可以以编程方式捕获 Web 内容，包括 SVG 和 Canvas 和/或创建带有缩略图预览的网站截图。

最好的入口点是[屏幕截图](https://github.com/ariya/phantomjs/wiki/Screen-Capture)wiki 页面。

这是极地时钟的一个很好的例子（来自 RaphaelJS）：

```
>phantomjs rasterize.js http://raphaeljs.com/polar-clock.html clock.png 
```

您想将页面呈现为 PDF 吗？

```
> phantomjs rasterize.js 'http://en.wikipedia.org/w/index.php?title=Jakarta&printable=yes' jakarta.pdf 
```

* * *

## 回答 #9

> 赞同：4
> 
>             
> 
> 时间：2013-09-07T11:01:59.330

如果您使用的是 jQuery（很多人都这样做），那么您可以像这样实现公认的答案：

```
var canvas = $("#mycanvas")[0];
var img = canvas.toDataURL("image/png");

$("#elememt-to-write-to").html('<img src="'+img+'"/>'); 
```

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2021-07-15T17:02:56.323

关键是

> [canvas.toDataURL（类型，质量）](https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toDataURL)

* * *

我想为像我这样想要将 SVG 保存为 PNG 的人提供一个示例（如果您愿意，也可以添加一些文本），它可能来自在线资源或字体真棒图标等。

## 例子

100% javascript，没有其​​他 3-rd 库。

```
<script>
  (() => {
    window.onload = () => {
      // Test 1: SVG from Online
      const canvas = new Canvas(650, 500)
      // canvas.DrawGrid() // If you want to show grid, you can use it.
      const svg2img = new SVG2IMG(canvas.canvas, "https://upload.wikimedia.org/wikipedia/commons/b/bd/Test.svg")
      svg2img.AddText("Hello", 100, 250, {mode: "fill", color: "yellow", alpha: 0.8})
      svg2img.AddText("world", 200, 250, {mode: "stroke", color: "red"})
      svg2img.AddText("!", 280, 250, {color: "#f700ff", size: "72px"})
      svg2img.Build("Test.png")

      // Test 2: URI.data
      const canvas2 = new Canvas(180, 180)
      const uriData = "data:image/svg+xml;base64,PHN2ZyBjbGFzcz0ic3ZnLWlubGluZS0tZmEgZmEtc21pbGUtd2luayBmYS13LTE2IiBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhciIgZGF0YS1pY29uPSJzbWlsZS13aW5rIiByb2xlPSJpbWciIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDQ5NiA1MTIiIGRhdGEtZmEtaTJzdmc9IiI+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNMjQ4IDhDMTExIDggMCAxMTkgMCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzODUgOCAyNDggOHptMCA0NDhjLTExMC4zIDAtMjAwLTg5LjctMjAwLTIwMFMxMzcuNyA1NiAyNDggNTZzMjAwIDg5LjcgMjAwIDIwMC04OS43IDIwMC0yMDAgMjAwem0xMTcuOC0xNDYuNGMtMTAuMi04LjUtMjUuMy03LjEtMzMuOCAzLjEtMjAuOCAyNS01MS41IDM5LjQtODQgMzkuNHMtNjMuMi0xNC4zLTg0LTM5LjRjLTguNS0xMC4yLTIzLjctMTEuNS0zMy44LTMuMS0xMC4yIDguNS0xMS41IDIzLjYtMy4xIDMzLjggMzAgMzYgNzQuMSA1Ni42IDEyMC45IDU2LjZzOTAuOS0yMC42IDEyMC45LTU2LjZjOC41LTEwLjIgNy4xLTI1LjMtMy4xLTMzLjh6TTE2OCAyNDBjMTcuNyAwIDMyLTE0LjMgMzItMzJzLTE0LjMtMzItMzItMzItMzIgMTQuMy0zMiAzMiAxNC4zIDMyIDMyIDMyem0xNjAtNjBjLTI1LjcgMC01NS45IDE2LjktNTkuOSA0Mi4xLTEuNyAxMS4yIDExLjUgMTguMiAxOS44IDEwLjhsOS41LTguNWMxNC44LTEzLjIgNDYuMi0xMy4yIDYxIDBsOS41IDguNWM4LjUgNy40IDIxLjYuMyAxOS44LTEwLjgtMy44LTI1LjItMzQtNDIuMS01OS43LTQyLjF6Ij48L3BhdGg+PC9zdmc+"
      const svg2img2 = new SVG2IMG(canvas2.canvas, uriData)
      svg2img2.Build("SmileWink.png")

      // Test 3: Exists SVG
      ImportFontAwesome()
      const range = document.createRange()
      const fragSmile = range.createContextualFragment(`<i class="far fa-smile" style="background-color:black;color:yellow"></i>`)
      document.querySelector(`body`).append(fragSmile)

      // use MutationObserver wait the fontawesome convert ``<i class="far fa-smile"></i>`` to SVG. If you write the element in the HTML, then you can skip this hassle way.
      const observer = new MutationObserver((mutationRecordList, observer) => {
        for (const mutation of mutationRecordList) {
          switch (mutation.type) {
            case "childList":
              const targetSVG = mutation.target.querySelector(`svg`)
              if (targetSVG !== null) {
                const canvas3 = new Canvas(64, 64) //  Focus here. The part of the observer is not important.
                const svg2img3 = new SVG2IMG(canvas3.canvas, SVG2IMG.Convert2URIData(targetSVG))
                svg2img3.Build("Smile.png")
                targetSVG.remove() // This SVG is created by font-awesome, and it's an extra element. I don't want to see it.
                observer.disconnect()
                return
              }
          }
        }
      })
      observer.observe(document.querySelector(`body`), {childList: true})
    }
  })()

  class SVG2IMG {
    /**
     * @param {HTMLCanvasElement} canvas
     * @param {string} src "http://.../xxx.svg"  or "data:image/svg+xml;base64,${base64}"
     * */
    constructor(canvas, src) {
      this.canvas = canvas;
      this.context = this.canvas.getContext("2d")
      this.src = src
      this.addTextList = []
    }

    /**
     * @param {HTMLElement} node
     * @param {string} mediaType: https://en.wikipedia.org/wiki/Media_type#Common_examples_%5B10%5D
     * @see https://en.wikipedia.org/wiki/List_of_URI_schemes
     * */
    static Convert2URIData(node, mediaType = 'data:image/svg+xml') {
      const base64 = btoa(node.outerHTML)
      return `${mediaType};base64,${base64}`
    }

    /**
     * @param {string} text
     * @param {int} x
     * @param {int} y
     * @param {"stroke"|"fill"} mode
     * @param {string} size, "30px"
     * @param {string} font, example: "Arial"
     * @param {string} color, example: "#3ae016" or "yellow"
     * @param {int} alpha, 0.0 (fully transparent) to 1.0 (fully opaque) // https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Applying_styles_and_colors#transparency
     * */
    AddText(text, x, y, {mode = "fill", size = "32px", font = "Arial", color = "black", alpha = 1.0}) {
      const drawFunc = (text, x, y, mode, font) => {
        return () => {
          // https://www.w3schools.com/graphics/canvas_text.asp
          // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/fillText
          const context = this.context
          const originAlpha = context.globalAlpha
          context.globalAlpha = alpha
          context.font = `${size} ${font}`

          switch (mode) {
            case "fill":
              context.fillStyle = color
              context.fillText(text, x, y)
              break
            case "stroke":
              context.strokeStyle = color
              context.strokeText(text, x, y)
              break
            default:
              throw Error(`Unknown mode:${mode}`)
          }
          context.globalAlpha = originAlpha
        }
      }
      this.addTextList.push(drawFunc(text, x, y, mode, font))
    }

    /**
     * @description When the build is finished, you can click the filename to download the PNG or mouse enters to copy PNG to the clipboard.
     * */
    Build(filename = "download.png") {
      const img = new Image()
      img.src = this.src
      img.crossOrigin = "anonymous" // Fixes: Tainted canvases may not be exported

      img.onload = (event) => {
        this.context.drawImage(event.target, 0, 0)
        for (const drawTextFunc of this.addTextList) {
          drawTextFunc()
        }

        // create a "a" node for download
        const a = document.createElement('a')
        document.querySelector('body').append(a)
        a.innerText = filename
        a.download = filename

        const quality = 1.0
        // a.target = "_blank"
        a.href = this.canvas.toDataURL("image/png", quality)
        a.append(this.canvas)
      }

      this.canvas.onmouseenter = (event) => {
        // set background to white. Otherwise, background-color is black.
        this.context.globalCompositeOperation = "destination-over" // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation // https://www.w3schools.com/tags/canvas_globalcompositeoperation.asp
        this.context.fillStyle = "rgb(255,255,255)"
        this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)
        this.canvas.toBlob(blob => navigator.clipboard.write([new ClipboardItem({'image/png': blob})])) // copy to clipboard
      }
    }
  }

  class Canvas {

    /**
     * @description for do something like that: ``<canvas width="" height=""></>canvas>``
     **/
    constructor(w, h) {
      const canvas = document.createElement("canvas")
      document.querySelector(`body`).append(canvas)
      this.canvas = canvas;
      [this.canvas.width, this.canvas.height] = [w, h]
    }

    /**
     * @description If your SVG is large, you may want to know which part is what you wanted.
     * */
    DrawGrid(step = 100) {
      const ctx = this.canvas.getContext('2d')
      const w = this.canvas.width
      const h = this.canvas.height

      // Draw the vertical line.
      ctx.beginPath();
      for (let x = 0; x <= w; x += step) {
        ctx.moveTo(x, 0);
        ctx.lineTo(x, h);
      }
      // set the color of the line
      ctx.strokeStyle = 'rgba(255,0,0, 0.5)'
      ctx.lineWidth = 1
      ctx.stroke();

      // Draw the horizontal line.
      ctx.beginPath();
      for (let y = 0; y <= h; y += step) {
        ctx.moveTo(0, y)
        ctx.lineTo(w, y)
      }
      ctx.strokeStyle = 'rgba(128, 128, 128, 0.5)'
      ctx.lineWidth = 5
      ctx.stroke()
    }
  }

  function ImportFontAwesome() {
    const range = document.createRange()
    const frag = range.createContextualFragment(`
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/js/all.min.js" integrity="sha512-UwcC/iaz5ziHX7V6LjSKaXgCuRRqbTp1QHpbOJ4l1nw2/boCfZ2KlFIqBUA/uRVF0onbREnY9do8rM/uT/ilqw==" crossorigin="anonymous"/>
`)
    document.querySelector("head").append(frag)
  }
</script>
```

如果您想在 stackoverflow 上运行并将鼠标移动到图片上可能会出错

> DOMException：剪贴板 API 已被阻止，因为当前文档应用了权限策略

您可以将代码复制到本地计算机上并再次运行，就可以了。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2021-09-01T04:12:44.797

`upload image`来自`<canvas />`：

```
async function canvasToBlob(canvas) {
  if (canvas.toBlob) {
    return new Promise(function (resolve) {
      canvas.toBlob(resolve)
    })
  } else {
    throw new Error('canvas.toBlob Invalid')
  }
}

await canvasToBlob(yourCanvasEl) 
```

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2021-01-30T15:46:46.583

如果你想嵌入画布，你可以使用这个片段

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <canvas id=canvas width=200 height=200></canvas>
    <iframe id='img' width=200 height=200></iframe>
    <script>
        window.onload = function() {
            var canvas = document.getElementById("canvas");
            var context = canvas.getContext("2d");
            context.fillStyle = "green";
            context.fillRect(50, 50, 100, 100);
            document.getElementById('img').src = canvas.toDataURL("image/jpeg");
            console.log(canvas.toDataURL("image/jpeg"));
        }
    </script>
</body>
</html> 
```

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2020-06-21T21:00:56.587

简单的答案就是获取它的 blob 并将 img src 设置为该 blob 的新对象 URL，然后使用某个库将该图像添加到 PDF 中，例如

```
var ok = document.createElement("canvas")
ok.width = 400
ok.height = 140
var ctx = ok.getContext("2d");
for(let k = 0; k < ok.height; k++) 
  (
    k 
    % 
    Math.floor(
      (
        Math.random()
      ) *
      10
    )
    == 
    0
  ) && (y => {
    for(var i = 0; i < ok.width; i++) {
      if(i % 25 == 0) {
        ctx.globalAlpha = Math.random()
        ctx.fillStyle = (
          "rgb(" + 
          Math.random() * 255 + "," +
          Math.random() * 255 + "," +
          Math.random() * 255 + ")"
        );

        (wdth =>
          ctx.fillRect(
            Math.sin(
              i * Math.PI / 180
            ) * 
              Math.random() *
              ok.width,
            Math.cos(
              i * Math.PI / 180,
            ) * wdth + y,
            wdth,
            wdth
          )
        )(15)
      }
    }
  })(k)

ok.toBlob(blob => {
  k.src = URL.createObjectURL(blob)
})
```

```
<img id=k>
```

或者，如果您想使用低级字节数据，您可以获取画布的原始字节，然后根据文件规范，将原始图像数据写入数据的必要字节。您只需要调用`ctx.getImageData(0, 0, ctx.canvas.widht, ctx.canvas.height)`以获取原始图像数据，然后根据文件规范将其写入

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2017-12-13T21:27:32.717

您可以使用 jspdf 将画布捕获到图像或 pdf 中，如下所示：

```
var imgData = canvas.toDataURL('image/png');              
var doc = new jsPDF('p', 'mm');
doc.addImage(imgData, 'PNG', 10, 10);
doc.save('sample-file.pdf'); 
```

更多信息：[https ://github.com/MrRio/jsPDF](https://github.com/MrRio/jsPDF)

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2015-11-16T22:13:30.113

在某些版本的 Chrome 上，您可以：

1.  使用画图功能`ctx.drawImage(image1, 0, 0, w, h);`
2.  在画布上单击鼠标右键

# browser - 使用条款/隐私政策是否有标准文件名？

> ID：923890
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:29:58.527
> 
>         
> 
> 标签：browser, cross-browser, privacy

使用条款和隐私政策是否有标准文件名？

出于某种原因，我记得 Internet Explorer 和可能的其他浏览器曾经在当前网站上查找它们，并显示一个小警告图标...

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T00:50:26.707

您在寻找[P3P](http://en.wikipedia.org/wiki/P3P)吗？

> 隐私政策可以作为 XML 文件检索，也可以以紧凑的形式包含在 HTTP 标头中。适用于给定文档的 XML 策略文件的位置可以是：
> 
>   
>   
> 
> 1.  在文档的 HTTP 标头中指定
> 
> 2.  在文档的 HTML 头中指定
> 
> 3.  如果未指定以上任何一项，则使用**众所周知的位置 /w3c/p3p.xml**（对于类似的位置比较 /favicon.ico）

# visual-studio - 使用 VISTA 64 位配置新的开发人员 PC：我可以使用我的 32 位 Visual Studio

> ID：923896
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:32:29.520
> 
>         
> 
> 标签：visual-studio, windows-vista, 64-bit

我正要冒险建造一台 PC，它可能是 64 位的，我想这将使用 64 位 VISTA，因为 Windows 7 还没有推出。

我是一名 Visual Studio 2008 开发人员；我需要新版本的软件吗？我现在在 XP 上运行 32 位版本并部署到以 32 位模式运行 IIS 的 64 位 Windows 2003 服务器。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T00:34:05.663

Visual Studio 2008 只有 32 位版本。不过，这在 Vista x64 和 Win7 x64 上运行良好。

# javascript - Javascript 变量未正确显示

> ID：923904
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:34:30.467
> 
>         
> 
> 标签：javascript, windows-desktop-gadgets

我正在尝试创建一个 Vista 小工具，我已正确存储了 Date1 变量并尝试将其拉出：

```
<html>
<head>
<title>None</title>
<link href="style.css" rel="stylesheet" type="text/css">
<script type="text/javascript">
System.Gadget.settingsUI="settings.html";
System.Gadget.onSettingsClosed = settingsClosed; 

function settingsClosed(p_event) {
    // if OK button is clicked reload gadget
    if (p_event.closeAction == p_event.Action.commit) {
        // pull settings from here
        text1.value=System.Gadget.Settings.readString("Date1");
    }
}

</script>
</head>
<body>
<span class="stext">Last Serviced:<br />
    <span id="text1">Nothing Yet</span>
</span>
</body>
</html> 
```

使用 span 标签，text1 不显示任何内容。但是，如果我使用输入标签：

```
<input id="text1" type="text" /> 
```

然后数据会显示出来。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:37:31.117

```
text1.value=System.Gadget.Settings.readString("Date1"); 
```

span 标签没有 value 属性。尝试：

```
span1.innerHTML=System.Gadget.Settings.readString("Date1"); 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:39:25.933

你确定 <span> 标签在 <script> 标签内吗？

# .net - 用于从 ASP .NET 更新表的动态 SQL

> ID：923907
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:35:57.220
> 
>         
> 
> 标签：.net, sql, orm, dynamic-sql

我有一个 ASP.NET 3.5 应用程序，我希望允许用户选择一个表并允许对该表进行 CRUD 操作。用户将被限制在多个表中进行编辑，但是这些表甚至数据库在部署之后才会被知道；web.config 将设置连接和表。

所以我需要构建一个允许更新 SQL 数据库中的通用表的框架。我见过的大多数 ORM 都需要在编译时知道架构，所以我不能使用这些。最好的答案似乎是动态构建 SQL 查询字符串并使用 reg 表达式来确保有效输入并防止 SQL 注入。有没有更好的办法？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:49:08.597

是的。数据集和数据表对象怎么样？您可以通过动态 sql 语句填充这些内容，将它们直接绑定到一个好的编辑器网格控件，并且模式和列数据类型检查应该很容易。在 ORM 和 Linq 之前我们做过什么？！？！

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:10:55.777

动态 Linq 库令人难以置信。您可以将所有内容指定为字符串，除了表名。

[![替代文字](https://i.stack.imgur.com/IZDqy.png)](https://i.stack.imgur.com/IZDqy.png)

[（来源：[scottgu.com](http://www.scottgu.com/blogposts/dynquery/step2.png)）]

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

但是，请在此处查找有关如何通过动态映射 DataContext 在运行时选择表的想法：

[http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/09/27/25294.aspx](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/09/27/25294.aspx)

# regex - 当定义的字符串不存在时匹配的正确正则表达式是什么

> ID：923913
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:38:59.553
> 
>         
> 
> 标签：regex

我正在拼命地寻找一个匹配 a 到 z、A 到 Z、0 到 9 和“-”之间的任何内容的正则表达式。如果要检查的字符串等于“admin”，则相同的正则表达式不能匹配。

我试过这个：

`/^(?!admin)|([-a-z0-9]{1,})$/i`

但它不起作用，即使我添加了否定的前瞻内容，它也与字符串 admin 匹配。

我将这个正则表达式与 PHP (PCRE) 一起使用。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T00:51:01.417

在单个正则表达式中执行“A 而不是 B”是很棘手的。通常最好（更清晰，更容易）分两部分来做。如果这不是一个选项，它可以完成。你在正确的轨道上，消极的前瞻，但交替正在杀死你。

```
/^(?!admin$)[-a-zA-Z0-9]+$/ 
```

在 Perl 的扩展语法中，这是：

```
/
  ^               # beginning of line anchor
  (?!             # start negative lookahead assertion
     admin        #   the literal string 'admin'
     $            #   end of line anchor
  )               # end negative lookahead assertion
  [-a-zA-Z0-9]+   # one or more of a-z, A-Z, 0-9, or '-'
  $               # end of string anchor
/x 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T00:43:31.573

正则表达式是您唯一可用的工具吗？执行类似（Perl 语法）之类的操作可能更容易：

```
if ($string ne "admin" && $string =~ /^[-a-z0-9]+$/i) { ... 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:45:16.390

我认为如果您删除了“或”（`|`）运算符，它会起作用。现在你基本上是在说，如果是字母等就匹配，或者不等于 admin，所以它总是返回 true，因为当它等于 admin 时，它仍然匹配另一个表达式。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T00:54:52.657

^(?![\.]*[aA][dD][mM][iI][nN][\.]*$)([A-Za-z0-9]{1,}$)

尝试使用正则表达式测试工具，例如 code.google.com 上的 regex-freetool

# database - 按 ID 检索和保存数据库字段

> ID：923919
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:41:56.333
> 
>         
> 
> 标签：database, database-design

一个表中的数据通过 ID 引用到另一个表。例如，我有一个 ID 为 1-50 的州表。在另一个表“用户”中，我引用了该 ID，即。state= 4\. 当我需要将数据更新回“用户”时，如果状态发生变化，我的代码是否应该知道状态数据的编号？换句话说，如果新状态是 Alabama id=1，我应该在提交到数据库之前枚举吗？或者数据访问层是否应该在数据表中搜索新状态的id？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:50:43.883

具体情况取决于您的前端是什么，但通常您应该传递 id 以及州名，因此当用户选择 Alabama 时，id 1 会被传回您的 DAL，以便它可以在用户表直接到那个没有额外的选择。

例如，如果前端是一个网页，

```
<select>
    <option value=1>Alabama</option>
    ...
</select> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:03:55.947

如果您的数据库在引用状态主键列的用户表列上有正确的外键，则您永远不需要在数据库中执行额外的搜索检查。这样做将始终确保将合法值保留到您的用户记录中。

# c++ - 事件/任务队列多线程 C++

> ID：923922
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-05-29T00:43:08.233
> 
>         
> 
> 标签：c++, multithreading, queue, pthreads

我想创建一个可以从多个线程调用其方法的类。但不是在调用它的线程中执行该方法，而是应该在它自己的线程中执行它们。不需要返回结果，也不应该阻塞调用线程。

我在下面包含的第一次尝试实现。公共方法将函数指针和数据插入到作业队列中，然后工作线程会拾取该作业队列。然而，它并不是特别好的代码，并且添加新方法很麻烦。

理想情况下，我想将它用作一个基类，我可以轻松地添加方法（具有可变数量的参数），同时减少麻烦和代码重复。

有什么更好的方法来做到这一点？是否有任何现有的代码可以做类似的事情？谢谢

```
#include <queue>

using namespace std;

class GThreadObject
{
    class event
    {
        public:
        void (GThreadObject::*funcPtr)(void *);
        void * data;
    };

public:
    void functionOne(char * argOne, int argTwo);

private:
    void workerThread();
    queue<GThreadObject::event*> jobQueue;
    void functionOneProxy(void * buffer);
    void functionOneInternal(char * argOne, int argTwo);

};

#include <iostream>
#include "GThreadObject.h"

using namespace std;

/* On a continuous loop, reading tasks from queue
 * When a new event is received it executes the attached function pointer
 * It should block on a condition, but Thread code removed to decrease clutter
 */
void GThreadObject::workerThread()
{
    //New Event added, process it
    GThreadObject::event * receivedEvent = jobQueue.front();

    //Execute the function pointer with the attached data
    (*this.*receivedEvent->funcPtr)(receivedEvent->data);
}

/*
 * This is the public interface, Can be called from child threads
 * Instead of executing the event directly it adds it to a job queue
 * Then the workerThread picks it up and executes all tasks on the same thread
 */
void GThreadObject::functionOne(char * argOne, int argTwo)
{

    //Malloc an object the size of the function arguments
    int argumentSize = sizeof(char*)+sizeof(int);
    void * myData = malloc(argumentSize);
    //Copy the data passed to this function into the buffer
    memcpy(myData, &argOne, argumentSize);

    //Create the event and push it on to the queue
    GThreadObject::event * myEvent = new event;
    myEvent->data = myData;
    myEvent->funcPtr = &GThreadObject::functionOneProxy;
    jobQueue.push(myEvent);

    //This would be send a thread condition signal, replaced with a simple call here
    this->workerThread();
}

/*
 * This handles the actual event
 */
void GThreadObject::functionOneInternal(char * argOne, int argTwo)
{
    cout << "We've made it to functionTwo char*:" << argOne << " int:" << argTwo << endl;

    //Now do the work
}

/*
 * This is the function I would like to remove if possible
 * Split the void * buffer into arguments for the internal Function
 */
void GThreadObject::functionOneProxy(void * buffer)
{
    char * cBuff = (char*)buffer;
    functionOneInternal((char*)*((unsigned int*)cBuff), (int)*(cBuff+sizeof(char*)));
};

int main()
{
    GThreadObject myObj;

    myObj.functionOne("My Message", 23);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T01:05:34.647

[Futures](http://www.justsoftwaresolutions.co.uk/files/designing_mt_programs.pdf)库正在进入[Boost](http://www.boost.org)和 C++ 标准库。ACE 中也有类似的东西，但我不想向任何人推荐它（正如@lothar 已经指出的那样，它是 Active Object。）

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T14:10:18.653

下面是一个不需要“functionProxy”方法的实现。尽管添加新方法更容易，但它仍然很混乱。

Boost::Bind 和“Futures”似乎确实会整理很多东西。我想我会看看 boost 代码，看看它是如何工作的。谢谢大家的建议。

GThreadObject.h

```
#include <queue>

using namespace std;

class GThreadObject
{

    template <int size>
    class VariableSizeContainter
    {
        char data[size];
    };

    class event
    {
        public:
        void (GThreadObject::*funcPtr)(void *);
        int dataSize;
        char * data;
    };

public:
    void functionOne(char * argOne, int argTwo);
    void functionTwo(int argTwo, int arg2);

private:
    void newEvent(void (GThreadObject::*)(void*), unsigned int argStart, int argSize);
    void workerThread();
    queue<GThreadObject::event*> jobQueue;
    void functionTwoInternal(int argTwo, int arg2);
    void functionOneInternal(char * argOne, int argTwo);

}; 
```

GThreadObject.cpp

```
#include <iostream>
#include "GThreadObject.h"

using namespace std;

/* On a continuous loop, reading tasks from queue
 * When a new event is received it executes the attached function pointer
 * Thread code removed to decrease clutter
 */
void GThreadObject::workerThread()
{
    //New Event added, process it
    GThreadObject::event * receivedEvent = jobQueue.front();

    /* Create an object the size of the stack the function is expecting, then cast the function to accept this object as an argument.
     * This is the bit i would like to remove
     * Only supports 8 byte argument size e.g 2 int's OR pointer + int OR myObject8bytesSize
     * Subsequent data sizes would need to be added with an else if
     * */
    if (receivedEvent->dataSize == 8)
    {
        const int size = 8;

        void (GThreadObject::*newFuncPtr)(VariableSizeContainter<size>);
        newFuncPtr = (void (GThreadObject::*)(VariableSizeContainter<size>))receivedEvent->funcPtr;

        //Execute the function
        (*this.*newFuncPtr)(*((VariableSizeContainter<size>*)receivedEvent->data));
    }

    //Clean up
    free(receivedEvent->data);
    delete receivedEvent;

}

void GThreadObject::newEvent(void (GThreadObject::*funcPtr)(void*), unsigned int argStart, int argSize)
{

    //Malloc an object the size of the function arguments
    void * myData = malloc(argSize);
    //Copy the data passed to this function into the buffer
    memcpy(myData, (char*)argStart, argSize);

    //Create the event and push it on to the queue
    GThreadObject::event * myEvent = new event;
    myEvent->data = (char*)myData;
    myEvent->dataSize = argSize;
    myEvent->funcPtr = funcPtr;
    jobQueue.push(myEvent);

    //This would be send a thread condition signal, replaced with a simple call here
    this->workerThread();

}

/*
 * This is the public interface, Can be called from child threads
 * Instead of executing the event directly it adds it to a job queue
 * Then the workerThread picks it up and executes all tasks on the same thread
 */
void GThreadObject::functionOne(char * argOne, int argTwo)
{
    newEvent((void (GThreadObject::*)(void*))&GThreadObject::functionOneInternal, (unsigned int)&argOne, sizeof(char*)+sizeof(int));
}

/*
 * This handles the actual event
 */
void GThreadObject::functionOneInternal(char * argOne, int argTwo)
{
    cout << "We've made it to functionOne Internal char*:" << argOne << " int:" << argTwo << endl;

    //Now do the work
}

void GThreadObject::functionTwo(int argOne, int argTwo)
{
    newEvent((void (GThreadObject::*)(void*))&GThreadObject::functionTwoInternal, (unsigned int)&argOne, sizeof(int)+sizeof(int));
}

/*
 * This handles the actual event
 */
void GThreadObject::functionTwoInternal(int argOne, int argTwo)
{
    cout << "We've made it to functionTwo Internal arg1:" << argOne << " int:" << argTwo << endl;
} 
```

主文件

```
#include <iostream>
#include "GThreadObject.h"

int main()
{

    GThreadObject myObj;

    myObj.functionOne("My Message", 23);
    myObj.functionTwo(456, 23);

    return 0;
} 
```

编辑：为了完整起见，我用 Boost::bind 做了一个实现。主要区别：

```
queue<boost::function<void ()> > jobQueue;

void GThreadObjectBoost::functionOne(char * argOne, int argTwo)
{
    jobQueue.push(boost::bind(&GThreadObjectBoost::functionOneInternal, this, argOne, argTwo));

    workerThread();
}

void GThreadObjectBoost::workerThread()
{
    boost::function<void ()> func = jobQueue.front();
    func();
} 
```

对 functionOne() 的 10,000,000 次迭代使用 boost 实现大约需要 19 秒。然而，非升压实施仅花费了约 6.5 秒。所以慢了大约 3 倍。我猜想找到一个好的非锁定队列将是这里最大的性能瓶颈。但这仍然是一个很大的区别。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:20:12.060

[POCO](http://pocoproject.org/docs/)库在线程部分有一些类似的东西，称为 ActiveMethod（以及一些相关的功能，例如 ActiveResult）。源代码很容易获得并且易于理解。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T00:57:29.360

您可能对ACE[框架的](http://www.cs.wustl.edu/~schmidt/ACE.html)[ACE 模式](http://www.cs.wustl.edu/~schmidt/patterns-ace.html)之一的[Active Object](http://www.cs.wustl.edu/~schmidt/PDF/Act-Obj.pdf)感兴趣。

正如*Nikolai*指出的那样，[未来](http://www.justsoftwaresolutions.co.uk/threading/futures-and-tasks-in-c++0x.html)计划在[未来](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2561.html)某个时间使用标准 C++（双关语）。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:26:47.413

对于可扩展性和可维护性（以及其他能力），您可以为线程要执行的“作业”定义一个抽象类（或接口）。然后线程池的用户将实现此接口并将对象引用到线程池。这与 Symbian Active Object 设计非常相似：每个 AO 都是 CActive 的子类，并且必须实现 Run() 和 Cancel() 等方法。

为简单起见，您的界面（抽象类）可能很简单：

```
class IJob
{
    virtual Run()=0;
}; 
```

然后线程池或单线程接受请求将具有以下内容：

```
class CThread
{
   <...>
public:
   void AddJob(IJob* iTask);
   <...>
}; 
```

自然地，您将拥有多个任务，这些任务可以具有各种额外的设置器/获取器/属性以及您在任何行业中需要的任何东西。但是，唯一必须的是实现方法 Run()，它会执行冗长的计算：

```
class CDumbLoop : public IJob
{
public:
    CDumbJob(int iCount) : m_Count(iCount) {};
    ~CDumbJob() {};
    void Run()
    {
        // Do anything you want here
    }
private:
    int m_Count;
}; 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T08:42:34.337

您可以使用 Boost 的 Thread -library 来解决这个问题。像这样的东西（半伪）：

```
 class GThreadObject
{
        ...

        public:
                GThreadObject()
                : _done(false)
                , _newJob(false)
                , _thread(boost::bind(>hreadObject::workerThread, this))
                {
                }

                ~GThreadObject()
                {
                        _done = true;

                        _thread.join();
                }

                void functionOne(char *argOne, int argTwo)
                {
                        ...

                        _jobQueue.push(myEvent);

                        {
                                boost::lock_guard l(_mutex);

                                _newJob = true;
                        }

                        _cond.notify_one();
                }

        private:
                void workerThread()
                {
                        while (!_done) {
                                boost::unique_lock l(_mutex);

                                while (!_newJob) {
                                        cond.wait(l);
                                }

                                Event *receivedEvent = _jobQueue.front();

                                ...
                        }
                }

        private:
                volatile bool             _done;
                volatile bool             _newJob;
                boost::thread             _thread;
                boost::mutex              _mutex;
                boost::condition_variable _cond;
                std::queue<Event*>        _jobQueue;
}; 
```

另外，请注意[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)如何使我们能够更小、更好地管理此代码。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T11:33:12.777

这是我为类似目的编写的一个类（我将它用于事件处理，但您当然可以将它重命名为 ActionQueue ——并重命名它的方法）。

你像这样使用它：

使用您要调用的功能：`void foo (const int x, const int y) { /*...*/ }`

和：`EventQueue q;`

q.AddEvent (boost::bind (foo, 10, 20));

在工作线程中

q.PlayOutEvents();

注意：在条件下添加代码以阻止使用 CPU 周期应该相当容易。

代码（带有 boost 1.34.1 的 Visual Studio 2003）：

```
#pragma once

#include <boost/thread/recursive_mutex.hpp>
#include <boost/function.hpp>
#include <boost/signals.hpp>
#include <boost/bind.hpp>
#include <boost/foreach.hpp>
#include <string>
using std::string;

// Records & plays out actions (closures) in a safe-thread manner.

class EventQueue
{
    typedef boost::function <void ()> Event;

public:

    const bool PlayOutEvents ()
    {
        // The copy is there to ensure there are no deadlocks.
        const std::vector<Event> eventsCopy = PopEvents ();

        BOOST_FOREACH (const Event& e, eventsCopy)
        {
            e ();
            Sleep (0);
        }

        return eventsCopy.size () > 0;
    }

    void AddEvent (const Event& event)
    {
        Mutex::scoped_lock lock (myMutex);

        myEvents.push_back (event);
    }

protected:

    const std::vector<Event> PopEvents ()
    {
        Mutex::scoped_lock lock (myMutex);

        const std::vector<Event> eventsCopy = myEvents;
        myEvents.clear ();

        return eventsCopy;
    }

private:

    typedef boost::recursive_mutex Mutex;
    Mutex myMutex;

    std::vector <Event> myEvents;

}; 
```

我希望这有帮助。:)

马丁比尔斯基

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T12:22:34.097

你应该看看 Boost ASIO 库。它旨在异步调度事件。它可以与 Boost Thread 库配对以构建您描述的系统。

您需要实例化一个`boost::asio::io_service`对象并安排一系列异步事件（`boost::asio::io_service::post`或`boost::asio::io_service::dispatch`）。接下来，从*n 个*线程调用`run`成员函数。该对象是线程安全的，并保证您的异步处理程序只会在您调用.*`io_service``io_service::run`*

 *该`boost::asio::strand`对象对于简单的线程同步也很有用。

对于它的价值，我认为 ASIO 库是解决这个问题的一个非常优雅的解决方案。

# php - 在 PHP 中获取给定一周的开始和结束天数

> ID：923925
> 
>         
> 
> 赞同：34
> 
>         
> 
> 时间：2009-05-29T00:44:15.550
> 
>         
> 
> 标签：php, datetime

我正在尝试使用星期日作为开始日期和参考日期来获取星期范围`$date`，但我似乎无法弄清楚。

例如，如果我的 $date 是 2009-05-01，我会得到 2009-04-26 和 2009-05-02。2009-05-10 将产生 2009-05-10 和 2009-05-16。我当前的代码看起来像这样（我不记得我是从哪里取出它的，因为我忘了在评论中写下网址）：

```
function x_week_range(&$start_date, &$end_date, $date)
{
    $start_date = '';
    $end_date = '';
    $week = date('W', strtotime($date));
    $week = $week;

    $start_date = $date;

    $i = 0;
    while(date('W', strtotime("-$i day")) >= $week) {
        $start_date = date('Y-m-d', strtotime("-$i day"));
        $i++;
    }

    list($yr, $mo, $da) = explode('-', $start_date);

    $end_date = date('Y-m-d', mktime(0, 0, 0, $mo, $da + 6, $yr));
} 
```

我意识到它所做的只是在当前日期上增加 7 天。你会怎么做？

* * *

## 回答 #1

> 赞同：93
> 
>             
> 
> 时间：2009-05-29T01:16:42.380

我会利用 PHP 的[strtotime](http://www.php.net/strtotime)的优势：

```
function x_week_range(&$start_date, &$end_date, $date) {
    $ts = strtotime($date);
    $start = (date('w', $ts) == 0) ? $ts : strtotime('last sunday', $ts);
    $start_date = date('Y-m-d', $start);
    $end_date = date('Y-m-d', strtotime('next saturday', $start));
} 
```

对您提供的数据进行了测试，并且可以正常工作。不过，我并不特别喜欢你正在进行的整个参考。如果这是我的功能，我会是这样的：

```
function x_week_range($date) {
    $ts = strtotime($date);
    $start = (date('w', $ts) == 0) ? $ts : strtotime('last sunday', $ts);
    return array(date('Y-m-d', $start),
                 date('Y-m-d', strtotime('next saturday', $start)));
} 
```

并这样称呼它：

```
list($start_date, $end_date) = x_week_range('2009-05-10'); 
```

我不喜欢为这样的事情做数学。日期很棘手，我更喜欢让 PHP 弄清楚。

* * *

## 回答 #2

> 赞同：24
> 
>             
> 
> 时间：2013-07-03T02:55:20.780

对于仍在使用 mktime()、strtotime() 和其他 PHP 函数的每个人...试试 PHP5 [DateTime](http://php.net/manual/en/class.datetime.php)类。一开始我很犹豫，但它真的很容易使用。不要忘记使用 clone() 来复制您的对象。

编辑：此代码最近被编辑以处理当天是星期日的情况。在这种情况下，我们必须得到过去的星期六，然后加上一天来得到星期天。

```
$dt_min = new DateTime("last saturday"); // Edit
$dt_min->modify('+1 day'); // Edit
$dt_max = clone($dt_min);
$dt_max->modify('+6 days'); 
```

然后根据需要格式化。

```
echo 'This Week ('.$dt_min->format('m/d/Y').'-'.$dt_max->format('m/d/Y').')'; 
```

确保在代码中尽早设置时区。

```
date_default_timezone_set('America/New_York'); 
```

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2009-05-29T01:25:44.327

显然 date() 的 'w' 格式值或 DateTime 对象的格式方法会将星期几作为数字返回（默认情况下，0 = 星期日，1 = 星期一等）

您可以使用它并从当天减去它的值作为天数来找到一周的开始。

```
$start_date = new DateTime("2009-05-13");
$day_of_week = $start_date->format("w");

$start_date->modify("-$day_of_week day"); 
```

$start_date 现在将等于该周的星期日，从那里你可以添加 7 天来获得一周的结束或你有什么。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2013-08-05T19:30:54.507

根据@jjwdesign 的回答，我开发了一个函数，可以使用 DateTime 类计算特定日期一周的开始和结束。**将在 PHP 5.3.0++ 上运行**

不同之处在于您可以将所需的日期设置为 0（星期一）和 6（星期日）之间的“开始”。

这是功能：

```
if(function_exists('grk_Week_Range') === FALSE){
    function grk_Week_Range($DateString, $FirstDay=6){
        #   Valeur par défaut si vide
        if(empty($DateString) === TRUE){
            $DateString = date('Y-m-d');
        }

        #   On va aller chercher le premier jour de la semaine qu'on veut
        $Days = array(
            0 => 'monday',
            1 => 'tuesday',
            2 => 'wednesday',
            3 => 'thursday',
            4 => 'friday',
            5 => 'saturday',
            6 => 'sunday'
        );

        #   On va définir pour de bon le premier jour de la semaine     
        $DT_Min = new DateTime('last '.(isset($Days[$FirstDay]) === TRUE ? $Days[$FirstDay] : $Days[6]).' '.$DateString);
        $DT_Max = clone($DT_Min);

        #   On renvoie les données
        return array(
            $DT_Min->format('Y-m-d'),
            $DT_Max->modify('+6 days')->format('Y-m-d')
        );
    }
} 
```

结果 ：

```
print_r(grk_Week_Range('2013-08-11 16:45:32', 0));
print_r(grk_Week_Range('2013-08-11 16:45:32', 1));
print_r(grk_Week_Range('2013-08-11 16:45:32', 2));
print_r(grk_Week_Range('2013-08-11 16:45:32', 3));
print_r(grk_Week_Range('2013-08-11 16:45:32', 4));
print_r(grk_Week_Range('2013-08-11 16:45:32', 5));
print_r(grk_Week_Range('2013-08-11 16:45:32', 6));

Array
(
    [0] => 2013-07-29
    [1] => 2013-08-04
)
Array
(
    [0] => 2013-07-30
    [1] => 2013-08-05
)
Array
(
    [0] => 2013-07-31
    [1] => 2013-08-06
)
Array
(
    [0] => 2013-07-25
    [1] => 2013-07-31
)
Array
(
    [0] => 2013-07-26
    [1] => 2013-08-01
)
Array
(
    [0] => 2013-07-27
    [1] => 2013-08-02
)
Array
(
    [0] => 2013-07-28
    [1] => 2013-08-03
) 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2011-02-03T21:16:27.800

我决定改用[http://boonedocks.net/mike/archives/114-Figuring-the-Start-of-the-Week-with-PHP.html上的方法。](http://boonedocks.net/mike/archives/114-Figuring-the-Start-of-the-Week-with-PHP.html)

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:24:55.327

这是我的版本，它使用了与 Clay 类似的概念：

```
/**
 * Start of the week
 *
 * 0 = Sun, 1 = Mon, etc.
 */
define( 'WEEK_START', 0 );

/**
 * Determine the start and end dates for
 * the week in which the specified date
 * falls
 *
 * @param $date Date in week
 * @param $start Week start (out)
 * @param $end Week end (out)
 */
function week_bounds( $date, &$start, &$end ) {
    $date = strtotime( $date );
    // Find the start of the week, working backwards
    $start = $date;
    while( date( 'w', $start ) > WEEK_START ) {
        $start -= 86400; // One day
    }
    // End of the week is simply 6 days from the start
    $end = date( 'Y-m-d', $start + ( 6 * 86400 ) );
    $start = date( 'Y-m-d', $start );
} 
```

轻度测试。代码可能不是万无一失的，或者处理遥远过去或未来的日期。使用风险自负。请勿将代码浸入水中。不要将代码展示给那些有紧张情绪或讨厌美元符号的人。未在动物身上进行测试。素食者可以安全使用。作者保证代码永远不会和你说话。万一代码确实试图让您参与对话，作者建议您忽略它提供的任何和所有建议。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2014-08-22T09:24:33.283

使用它从任何给定日期获取“周”数。

```
//October 29, 2009 is my birthday
echo $week date('W', strtotime('2009-10-29'));
//OUTPUT: 44
//October 29 is the 44th week in the year 2009 
```

现在将 getWeekDates 函数的参数传递为“year (2009)”和“$week”。

```
function getWeekDates($year, $week, $start=true){
        $from = date("Y-m-d", strtotime("{$year}-W{$week}-1")); //Returns the date of monday in week
        $to = date("Y-m-d", strtotime("{$year}-W{$week}-7"));   //Returns the date of sunday in week

        if($start) {
            return $from;
        } else {
            return $to;
        }
        //return "Week {$week} in {$year} is from {$from} to {$to}.";
    } 
```

有关更多信息，请参阅此链接
[http://blog.ekini.net/2009/07/09/php-get-start-and-end-dates-of-a-week-from-datew/](http://blog.ekini.net/2009/07/09/php-get-start-and-end-dates-of-a-week-from-datew/)

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2012-04-26T21:47:20.417

在尝试找到 Paolo Bergantino 接受的答案的更简化版本时，我发现了一种非常好的方法来完成这项工作：

```
function x_week_range2($date) {
  $ts = strtotime($date);
  $start = strtotime('sunday this week -1 week', $ts);
  $end = strtotime('sunday this week', $ts);
  return array(date('Y-m-d', $start), date('Y-m-d', $end));
} 
```

'sunday this week' 字符串始终表示“本周**结束**时的星期日”。如果在星期日的时间戳上使用，它将是下一个星期日。这使您可以避免在 Paola 的解决方案中使用三元运算符。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2016-07-29T21:07:48.997

您现在可以使用 DateTime 获取一周的开始/结束日期

```
function getDateRangeForAllWeeks($start, $end){
    $fweek = getDateRangeForWeek($start);
    $lweek = getDateRangeForWeek($end);
    $week_dates = [];
    while($fweek['sunday']!=$lweek['sunday']){
        $week_dates [] = $fweek;
        $date = new DateTime($fweek['sunday']);
        $date->modify('next day');

        $fweek = getDateRangeForWeek($date->format("Y-m-d"));
    }
    $week_dates [] = $lweek;

    return $week_dates;
}

function getDateRangeForWeek($date){
    $dateTime = new DateTime($date);
    $monday = clone $dateTime->modify(('Sunday' == $dateTime->format('l')) ? 'Monday last week' : 'Monday this week');
    $sunday = clone $dateTime->modify('Sunday this week'); 
    return ['monday'=>$monday->format("Y-m-d"), 'sunday'=>$sunday->format("Y-m-d")];
} 
```

**用法**

```
print_r( getDateRangeForWeek("2016-05-07") );

print_r( getDateRangeForAllWeeks("2015-11-07", "2016-02-15") ); 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:18:19.990

老实说，我无法理解您发布的代码；）

我想这样的事情应该可以解决问题：

```
function get_week($date) {
        $start = strtotime($date) - strftime('%w', $date) * 24 * 60 * 60;
        $end = $start + 6 * 24 * 60 * 60;
        return array('start' => strftime('%Y-%m-%d', $start),
                     'end' => strftime('%Y-%m-%d', $end));
} 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:19:42.140

无需进行太多字符串操作，您就可以对时间戳做一些简单的数学运算。

```
function getDateRange(&$start, &$end, $date) {
  $seconds_in_day = 86400;
  $day_of_week = date("w", $date); 
  $start = $date - ($day_of_week * $seconds_in_day);
  $end = $date + ((6 - $day_of_week) * $seconds_in_day);
} 
```

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2015-03-30T19:02:11.080

基于 David Bélanger 的版本（不幸的是，我的代表不允许我发表评论作为对他的帖子的反应..）。

当输入日期为星期一且一周的第一天设置为星期一时，原始版本返回前一周，而不是当前版本。这是小修复（与原始功能的其余部分）：

```
if(function_exists('grk_Week_Range') === FALSE){
function grk_Week_Range($DateString, $FirstDay=6){

    if(empty($DateString) === TRUE){
        $DateString = date('Y-m-d');
    }

    # fix
    $dayOfWeek = date('N', strtotime($DateString));
    if ($dayOfWeek == ($FirstDay +1)) { $whichWeek = 'this '; }
    else { $whichWeek = 'last '; }

    $Days = array(
        0 => 'monday',
        1 => 'tuesday',
        2 => 'wednesday',
        3 => 'thursday',
        4 => 'friday',
        5 => 'saturday',
        6 => 'sunday'
    );

    # fix   
    $DT_Min = new DateTime( $whichWeek.(isset($Days[$FirstDay]) === TRUE ? $Days[$FirstDay] : $Days[6]).' '.$DateString);
    $DT_Max = clone($DT_Min);

    return array(
        $DT_Min->format('Y-m-d'),
        $DT_Max->modify('+6 days')->format('Y-m-d')
    );
}
} 
```

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2019-05-31T09:33:17.927

返回从开始 DateTime 到结束 DateTime 的天数的简单代码。使用 gmdate() 方法可以格式化日期/时间。

```
$start_str_date = strtotime($start_date);
$end_str_date = strtotime($end_date);
$interval_days = $end_str_date - $start_str_date;
$days = gmdate('d',$interval_days);
echo $days; 
```

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2020-06-14T23:05:53.730

我注意到这里的大多数答案都使用`strtotime/DateTime`. 虽然正确，但我个人宁愿在不使用英文单词的情况下计算日期。

这是一个使用的简单解决方案`mtkime`：

```
$now = time();
$day_of_week = (int)date('w', $now);

$week_start = mktime(0, 0, 0, date('n', $now), date('j', $now)-$day_of_week, date('Y', $now));
$week_end = mktime(23, 59, 59, date('n', $week_start), date('j', $week_start)+6, date('Y', $week_start)); 
```

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2020-09-23T15:22:55.823

```
function weekRange($year, $week){
        $dateFrom = new \DateTime();
        $dateFrom->setISODate($year, $week);
        $dateTo = new \DateTime();
        $dateTo->setISODate($year, $week, 7);

        return array(
            'week' => $dateFrom->format('Y-W'),
            'start'=> $dateFrom->format('Y-m-d'),
            'end' => $dateTo->format('Y-m-d')
        );
    } 
```

例子：

```
$weekInformation = weekRange(2020, 38);

echo $weekInformation['start']; 
// Display: 2020-09-14

echo $weekInformation['end']; 
// Display: 2020-09-20 
```

* * *

## 回答 #16

> 赞同：-1
> 
>             
> 
> 时间：2014-02-19T13:53:32.340

来自 PHP DateTime 文档：

```
<?php
$date = new DateTime();

$date->setISODate(2008, 2);
$startDay = $date->format('Y-m-d');

$date->setISODate(2008, 2, 7);
$endDay = $date->format('Y-m-d');
?> 
```

# model-view-controller - MVC 中的 StructureMap 控制器工厂和空控制器实例

> ID：923926
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-05-29T00:44:56.593
> 
>         
> 
> 标签：model-view-controller, null, controller, structuremap

我仍在尝试使用 StructureMap 解决问题，我遇到的问题之一是当将空控制器类型传递给它时，我的 Controller Factory 类爆炸了。这只发生在应用程序第一次构建时，之后每个后续构建都可以正常工作。即使我关闭 Visual Studio 并重新打开项目（我没有在 IIS 中运行它）。几乎就像是在进行某种缓存。这是控制器类的样子：

```
public class IocControllerFactory : DefaultControllerFactory
{
    protected override IController GetControllerInstance(Type controllerType)
    {
        try
        {
            return (Controller)ObjectFactory.GetInstance(controllerType);
        }
        catch (StructureMapException)
        {
            System.Diagnostics.Debug.WriteLine(ObjectFactory.WhatDoIHave());
            throw;
        }
    }
} 
```

有什么问题？我需要注册每个控制器吗？谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-10-29T19:17:32.353

大多数浏览器在您加载站点时都在寻找 favicon.ico，并且此行为可能涉及一些缓存，这可能解释了您提到的奇怪的“仅在第一次构建时失败”的事情。  

就我而言，这导致了控制器工厂中空控制器类型的问题。

在 global.asax 中添加一个`routes.IgnoreRoute("{*favicon}", new { favicon = @"(.*/)?favicon.ico(/.*)?" });`会使错误消失，请求应该落入文件系统，而不需要 MVC 在您的代码中寻找 favico.ico 控制器。

这是[关于此的 Gunnar Peipman 帖子的链接](http://weblogs.asp.net/gunnarpeipman/archive/2009/02/26/asp-net-mvc-ignore-requests-to-favicon-ico.aspx)

我通过在我的自定义控制器工厂类中覆盖 GetControllerType(string controllerName) 并检查每个请求的 controllerName 值是什么来发现的。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-06-20T13:10:33.887

我在围绕 ninject 构建的控制器工厂遇到了同样的问题。

当 MVC 无法解析路由表中的路由或路由指定不存在的控制器时，似乎 MVC 会将控制器类型传递给 null。我做了两件事来解决这个问题。您可能想要检查您的路由表并添加一个显示 404 错误页面的包罗万象的路由，如此处所述[.Net MVC Routing Catchall not working](https://stackoverflow.com/questions/318886/net-mvc-routing-catchall-not-working)

您还可以使用路由调试器检查出了什么问题。
[http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx) 

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-07-17T17:07:33.147

我遇到了类似的问题。我相信这是对不存在的图像、CSS 文件等的 HTTP 请求。

我们知道 MVC 路由首先查看请求的文件是否物理存在。如果没有，则 URL 将针对配置的路由进行测试。我认为对物理上不存在的图像的请求已传递给路由引擎，并且不匹配任何路由，因此使用了 NULL。

因此，要修复它，请使用[FireBug](http://www.getfirebug.com/)或其他东西来观察并修复损坏的 HTTP 请求。在开发过程中，我使用了这样的路由来暂时绕过这些问题（我所有的资源文件夹都以下划线开头，例如_Images、_Styles 等）：

```
routes.IgnoreRoute("_*");  // TODO: Remove before launch 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2012-10-24T12:56:49.323

我认为您需要做的事情与默认 MVC 控制器工厂对 GetControllerInstance 方法所做的事情完全相同。如果您查看位于[http://aspnetwebstack.codeplex.com/](http://aspnetwebstack.codeplex.com/)的 DefaultControllerFactory 的 Microsoft 源代码，您将看到当 controllerType 为 null 时 DefaultControllerFactory 会引发 404 异常。以下是我们根据这些信息执行此操作的方法：

```
 public class StructureMapControllerFactory : DefaultControllerFactory
 {
      protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
      {
           if (controllerType == null)
                return base.GetControllerInstance(requestContext, controllerType);
           var controller = ObjectFactory.GetInstance(controllerType);
           return (IController)controller;
      }
 } 
```

基本上，这将确保当用户输入无效路由时，应用程序将其作为 404 错误处理。

# .net - 解析格式奇怪的文件

> ID：923935
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:50:22.573
> 
>         
> 
> 标签：.net, vb.net, parsing, file

我需要解析一个文件，但数据的格式很奇怪，我不熟悉。

数据总是这样格式化。字段名称在左侧，数据在“=”右侧，所有字段始终按此顺序排列。

档案资料：

```
Report 1 of 1 
job_name = JOBNAME
job_no = JOB99999 job_id = 6750
rprt_id = 27811
rprt_name = SOMEDATA.SOMEUSER.JOBNAME.JOB099999.0000000.?
ftp_size = 999999 
job_group_name = 1
clas = Z
form = 9999 
user_id = SOMEUSER 
```

我的第一直觉是做这样的事情......

```
 'New up a class created to hold the data'
        Dim NFOData As New NFOData
        'Create counter for line numbers'
        Dim i As Integer = 1

        Using sr As New StreamReader(filename)
            While Not sr.EndOfStream
                Dim line As String = sr.ReadLine

                Select Case i
                    Case 2
                        NFOData.JobName = line.Substring(11)
                    Case 3
                        NFOData.JobNo = line.Substring(9)
                    Case 4
                        'snipped to save space'
                End Select

                i += 1
            End While
        End Using 
```

这对我来说似乎不是很干净或优雅。

有没有更优雅的方式来处理这样的解析文件？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:19:02.780

以下代码是 C#，但应该很容易转换为 VB。它使用字典将文件中的键映射到 a `PropertyInfo`，然后使用反射设置值。缺少对第一行的处理，也许还有一些小问题。

```
Dictionary<String, PropertyInfo> map = new Dictionary<String, PropertyInfo>();

map["job_name"] = typeof(NFOData).GetProperty("JobName");
map["job_no"] = typeof(NFOData).GetProperty("JobNo");
// ....

NFOData nfoData = new NfOData();

using (StreamReader sr = new StreamReader(filename))
{
    String line;

    while ((line = sr.ReadLine()) != null)
    {
        String[] parts = line.Split(new[] {" = "}, StringSplitOptions.None);

        map[parts[0]].SetValue(nfoData, parts[1], null);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T00:59:53.803

我可能会阅读每一行，将其拆分为 =，并将其放入字符串哈希中，其中字段名称是键，以便您可以通过字段名称引用它。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:13:47.127

这是 C#（对不起，我没有 VB）并且没有任何类型的错误检查，但是像 KeyValuePairs 列表这样的东西怎么样......

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;

namespace NVP
{
    class Program
    {
        static void Main(string[] args)
        {
            var nvp = new List<KeyValuePair<string, string>>();
            var fs = File.Open(@"c:\temp\report.txt", FileMode.Open);

            var sw = new StreamReader(fs);

            while (!sw.EndOfStream)
            {
                var line = sw.ReadLine();
                if (!String.IsNullOrEmpty(line) && line.Contains("="))
                {
                    var tmp = line.Split('=');
                    nvp.Add( new KeyValuePair<string, string>(tmp[0], tmp[1]));
                }
            }

            sw.Close();
            fs.Close();

            var str = nvp.Select(kv => kv.Key + " " + kv.Value);
            str.ToList().ForEach(Console.WriteLine);

            Console.ReadLine();
        }
    }
} 
```

# php - 在 PHP 中解析 Windows 环境变量

> ID：923942
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T00:53:50.180
> 
>         
> 
> 标签：php, windows, environment-variables

我想写入 Windows 临时目录中的文件。我知道在命令行中您可以使用环境变量`%TEMP%`来获得正确的路径，但是尝试执行以下操作：

```
file_put_contents("%TEMP%\\myfile.txt"); 
```

...不起作用，因为环境变量没有被解析。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T00:58:13.073

`getenv('TEMP')`或者`$_ENV['temp']`

顺便说一句，如果您正在使用临时文件，那么您可能需要查看[`tempnam()`](http://uk.php.net/manual/en/function.tempnam.php)and[`tmpfile()`](http://uk.php.net/manual/en/function.tmpfile.php)函数。

前者将在任何目录中保留一个临时文件名（尽管您可以让它在系统临时目录中创建一个文件）；后者实际上会创建一个临时文件并返回一个文件句柄资源，当句柄关闭时自动丢弃临时文件。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T00:54:33.750

[http://www.php.net/manual/en/function.getenv.php](http://www.php.net/manual/en/function.getenv.php)

file_put_contents(getenv('TEMP') . DIRECTORY_SEPARATOR . "myfile.txt");

# silverlight - prism silverlight 实例化一个新视图

> ID：923947
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T00:56:08.037
> 
>         
> 
> 标签：silverlight, prism

我需要在命令上实例化一个新视图

想象一下，我在一个模块中有一个“新员工”按钮，当你按下它时，我想创建一个新的员工视图，你按下它 3 次，我想要一个包含三个元素的选项卡，每个选项卡页都包含数据对于员工，您可以分别保存和/或关闭每个标签页。

如何使用 Prism 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-06-02T20:57:57.550

ViewInjectionComposition 快速入门有一个很好的例子来说明您正在寻找什么。

您所做的是将命令委托给控制器，将您的作用域区域从区域管理器中取出。获得范围区域后，解析一个新视图并将其添加到该区域。

这是快速入门中的一个片段，您可以轻松地对其进行修改以执行您想要的操作。

```
 public class EmployeesController : IEmployeesController
{
    private IUnityContainer container;
    private IRegionManager regionManager;

    public EmployeesController(IUnityContainer container, IRegionManager regionManager)
    {
        this.container = container;
        this.regionManager = regionManager;
    }

    public virtual void OnEmployeeSelected(BusinessEntities.Employee employee)
    {
        IRegion detailsRegion = regionManager.Regions[RegionNames.DetailsRegion];
        object existingView = detailsRegion.GetView(employee.EmployeeId.ToString(CultureInfo.InvariantCulture));

        if (existingView == null)
        {
            IProjectsListPresenter projectsListPresenter = this.container.Resolve<IProjectsListPresenter>();
            projectsListPresenter.SetProjects(employee.EmployeeId);

            IEmployeesDetailsPresenter detailsPresenter = this.container.Resolve<IEmployeesDetailsPresenter>();
            detailsPresenter.SetSelectedEmployee(employee);

            IRegionManager detailsRegionManager = detailsRegion.Add(detailsPresenter.View, employee.EmployeeId.ToString(CultureInfo.InvariantCulture), true);
            IRegion region = detailsRegionManager.Regions[RegionNames.TabRegion];
            region.Add(projectsListPresenter.View, "CurrentProjectsView");
            detailsRegion.Activate(detailsPresenter.View);
        }
        else
        {
            detailsRegion.Activate(existingView);
        }
    }
} 
```

# javascript - 如何通过原型 Ajax.Request() 传递 HTTP AUTH 值？

> ID：923948
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T00:56:37.333
> 
>         
> 
> 标签：javascript, ajax, curl, xmlhttprequest, prototypejs

有没有办法将 HTTP AUTH 用户名和密码与 Ajax.request() 一起传递？基本上，我试图找到相当于：

```
curl user:pass http://url.com 
```

似乎这必须可用，但我无法弄清楚。如果没有，还有其他 JS 替代方案吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T01:36:25.523

我不确定 Prototype，但您可以将用户名和密码作为底层`open`方法的第四个和第五个参数传递，`XmlHttpRequest`如下所示[。](https://developer.mozilla.org/en/XMLHttpRequest#open())

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:31:16.360

我知道有人为[ExtJs](http://www.extjs.com)库编写了一个用户扩展，它为标准 Ajax 请求中的基本身份验证提供配置选项，并自动处理 Base64 编码。

[http://extjs.com/forum/showthread.php?t=21681](http://extjs.com/forum/showthread.php?t=21681)

# git - 如何在 git 中备份私有分支

> ID：923956
> 
>         
> 
> 赞同：52
> 
>         
> 
> 时间：2009-05-29T01:01:06.700
> 
>         
> 
> 标签：git, merge, workflow, rebase, dropbox

我有一个本地分支，用于在 git 中进行日常开发工作。我的工作流程是：

1.  在 local_branch 上做事，提交

2.  获取源/主

3.  重新定位 local_branch 以赶上来自 origin/master 的新内容

这一切都很好，但是我遇到的大多数建议都说不应该“推送”私有分支，在这些分支上定期执行变基。

这里的问题是，在这种情况下，本地分支没有备份到服务器，保存工作的唯一方法是将其合并回“可推送”分支（即 origin/master）

在这种情况下，您对工作流程有何建议？

谢谢！

**更新**：我意识到我最初的要求之一（避免使用外部实用程序）是不必要的限制。

我目前的解决方案是将我所有的存储库存储在一个云同步文件夹中——这样我就可以免费获得备份。

* * *

## 回答 #1

> 赞同：52
> 
>             
> 
> 时间：2009-05-30T17:26:12.107

我使用 --mirror 选项并推送到个人备份存储库：

将其添加为遥控器：

```
git remote add bak server:/path/to/backup/repo 
```

做备份：

```
git push --mirror bak 
```

这将自动使您的备份存储库看起来像您的活动存储库 - 将根据需要创建、删除、更新（甚至强制/非快进）分支。您也可以为此创建别名：

```
git config alias.bak "push --mirror bak" 
```

然后，当您想要进行备份时，只需运行“git bak”即可。您也可以将其放入 cron 作业中。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-05-29T23:11:49.447

推动个人分支机构并没有错。通常不鼓励这样做，因为人们可能会根据您的分支开始工作，并且当您重新设置基准时，他们的更改会保持浮动。

我所做的是使用前缀来表示“这是我的分支，使用它需要您自担风险”，例如：**fc-general-cleanup**。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-05-29T02:13:44.167

另一种选择是将“local_branch”推送到“origin”存储库，但推送到该存储库中它自己的分支（不是“master”），即：

`git push origin local_branch:local_backup`

然后，当您准备好进行另一次备份时（并且在您进行了一些工作和变基之后），只需从原始存储库中删除备份分支，然后再将其推出：

`git push origin :local_backup`               <=== 从原点删除分支

`git push origin local_branch:local_backup`

这样，在“local_branch”从“origin/master”重新定位后，您就不会在推送“local_branch”时遇到问题。

如果删除备份分支让您感到紧张（直到您最终将工作提交给“master”），您可以始终使用新名称（例如“local_backup1”、“local_backup2”等）继续推送到新分支.

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:09:00.443

您可以设置另一个将所有分支推送到的远程存储库吗？要考虑的另一件事是备份本地机器上的所有内容（重要），包括 git repo。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:38:56.140

推送到您正在变基的同一个分支没有任何问题。这些图表应该说明为什么这可以正常工作：

可以说这是分支 local_branch 并对其进行几次提交（C 和 D）后提交图的样子。自从您分支 local_branch 以来，其他人已向 origin/master 提交了一次 (E)：

```
A -- B -- E [起源/主人]
      \
       \    
        \-- C -- D [local_branch]

```

然后在运行“git rebase origin/master”之后，提交图将如下图所示。"origin/master" 仍然是一样的，但是 "local_branch" 已经重新设置：

```
A -- B -- E [起源/主人]
           \
            \
             \-- C -- D [local_branch]

```

在这个阶段，如果你执行“git push origin local_branch:master”，那么它会导致一个简单的快进。“origin/master”和“local_branch”将是相同的：

```
A -- B -- E -- C -- D [origin/master],[local_branch]

```

现在你可以自由地在“local_branch”上做更多的工作。最终你可能会得到这样的东西：

```
A -- B -- E -- C -- D -- G -- I [起源/主人]
                     \
                      \
                       \-- F -- H [local_branch]

```

请注意，这看起来很像起始图。你可以一遍又一遍地重复这个过程。

你应该避免推到*其他*分支，一个你没有变基的分支。那就是你会遇到麻烦的地方（对于另一个分支，在你从“origin/master”重新定位之后，你的“local_branch”历史看起来突然被重写了）。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T02:01:09.543

[这就是我所做的](http://coders-log.blogspot.com/2009/05/creating-remote-branch-with-git.html)。但是 - 这不是私人的。我这样做是为了与自己合作（可以这么说）。它让我可以在两个或多个盒子上的同一个分支上工作。如果其他人可以访问共享存储库，他们可以看到我在分支上所做的工作。当然，在我的家庭回购中，没有其他人可以访问，所以它仍然是私有的。在 github 上，全世界都可以看到我的东西。就像他们真的很在乎一样。;)

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2012-09-05T07:50:09.837

与其依赖 Dropbox 来同步git repo 的*所有*文件，我更愿意使用**[`git bundle`](https://stackoverflow.com/questions/1251713/backup-of-github-repo/1251717#1251717)**. 它只生成*一个*文件（包括您所有的私有分支），然后将该文件与 DropBox 同步。

请参阅“[带有 Dropbox 的 Git](https://stackoverflow.com/questions/3632723/git-with-dropbox/3633346#3633346) ”

在“[备份本地 Git 存储库](https://stackoverflow.com/questions/2129214/backup-a-local-git-repository/2129286#2129286)”中，[Yars](https://stackoverflow.com/users/8047/yar)提到了与 Dropbox 的同步错误。

# google-app-engine - App Engine 中的超时异常的名称是什么？

> ID：923957
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T01:01:59.087
> 
>         
> 
> 标签：google-app-engine, exception

出于某种原因，我的印象是它只是被称为超时，但似乎不是。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-05-29T07:01:36.210

对于数据存储区调用，google.appengine.ext.db.Timeout 例外。对于超出的总（挂钟）持续时间，例外是 google.appengine.runtime.DeadlineExceededError。DeadlineExceeded 错误被抛出一次“软”，此时您有很短的时间返回响应并退出；如果你不这样做，它会再次被抛出，无法捕获，并且你的脚本会被毫不客气地终止。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-05-29T01:15:26.627

[文档的请求计时器](http://code.google.com/appengine/docs/python/runtime.html#The_Request_Timer)部分解释了超时异常处理：

> 请求处理程序生成并返回对请求的响应的时间有限，通常约为 30 秒。一旦达到最后期限，请求处理程序就会被中断。
> 
>   
>   
> 
> `DeadlineExceededError`Python 运行时环境通过从包中引发 , 来中断请求处理程序`google.appengine.runtime`。如果请求处理程序没有捕获此异常，就像所有未捕获的异常一样，运行时环境将向客户端返回 HTTP 500 服务器错误。
> 
>   
>   
> 
> 请求处理程序可以捕获此错误以自定义响应。在引发异常以准备自定义响应后，运行时环境为请求处理程序提供了更多时间（不到一秒）。
> 
> ```
> from google.appengine.runtime import DeadlineExceededError
> 
> class MainPage(webapp.RequestHandler):
>   def get(self):
>     try:
>       # Do stuff...
> 
>     except DeadlineExceededError:
>       self.response.clear()
>       self.response.set_status(500)
>       self.response.out.write("This operation could not be completed in time...") 
> ```
> 
>   
>   
> 
> 如果处理程序在第二个截止日期之前没有返回响应或引发异常，则处理程序终止并返回默认错误响应。
> 
>   
>   
> 
> 虽然请求可能需要长达 30 秒才能响应，但 App Engine 已针对具有短暂请求（通常需要几百毫秒）的应用程序进行了优化。高效的应用程序可以快速响应大多数请求。一个不能很好地与 App Engine 的基础架构一起扩展的应用程序。

DataStore 有自己的[TimeOut 异常](http://code.google.com/appengine/docs/python/datastore/exceptions.html)

> 该`google.appengine.ext.db`包提供以下异常类：
> 
>   
>   
> 
> [...]
> 
>   
>   
> 
> `exception Timeout()`
> 
>   当数据存储操作超过数据存储操作允许的最长时间时引发。

# c++ - 在我的应用程序中挂钩

> ID：923958
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T01:02:19.133
> 
>         
> 
> 标签：c++, hook

我应该怎么做才能实现类似钩子的系统？

这是我的设置：

我有这些静态库：

*   库

*   库

A 和 B 就像可以一起包含在同一个应用程序中的模块。问题是我在 A 中有一个想要向 B 公开的函数。我正在使用回调列表执行此操作……但我对这个想法不满意。所以我想我可以实现一个类似钩子的系统，就像 Win32API 一样，但我想听听专家的意见。

当然，我可以访问这两个源代码。

注意：我忘了提到我没有使用类，并且由于设计决定，我无法为该项目创建类或对象，因此此处不允许使用继承之类的东西。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:07:06.627

您是否考虑过将共享部分移到第三个库中？

在严格静态链接的场景中，挂钩机制不会带来太大的胜利 - 一个共享依赖关系以及额外的动态复杂性帮助。如果您有一个地方可以放置两个库都可以访问的钩子，那么只需将函数放在那里即可。

或者，只需从库 A 中导出函数，从库 B 中引用它，也许确保库以正确的顺序链接，并且链接器应该为您整理出来。

如果库 A 可能链接也可能不链接，并且您的工具链支持它，您可以将 B 中的函数的虚拟版本声明为弱符号，如果链接 A，则  该[弱符号将被覆盖。](http://en.wikipedia.org/wiki/Weak_symbol)

# mysql - 收集浏览量 MySQL 布局

> ID：923962
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T01:04:59.143
> 
>         
> 
> 标签：mysql

嘿，有人知道设置 MySQL 数据库以收集网页浏览量的正确方法吗？我想收集这些网页浏览量，以便稍后在图表中显示。我在下面列出了几种方法。

**选项 A：**
每次有人访问网站时计算综合浏览量并为每个带有时间戳的综合浏览量创建一个新行会更好吗？因此，50,000 个视图 = 50,000 行数据。

**选项 B：**
计算每天的浏览量，并有一行计算浏览量。每次有人访问该站点时，计数都会增加。因此，50,000 次查看 = 每天 1 行数据。每天都会创建一个新行。

上面的任何选项都是我想做的正确方法吗？还是有更好更有效的方法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:14:59.917

**选项 C**将解析来自 Web 服务器的访问日志。不需要额外的存储空间，存储各种额外的信息，甚至存储对图像和 JavaScript 文件的请求。

..

但是，如果您只想跟踪对运行您自己的代码的页面的访问，我肯定会**选择 Option A**，除非您期望您的网站上有大量流量。

这样，您可以在一天中的每小时创建概览，并存储比时间戳更多的信息（如访问的页面、用户的浏览器等）。您现在可能不需要它，但稍后您可能会感谢自己没有丢失这些信息。如果在某些时候表格变得太大，您总是可以想办法解决这个问题。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T02:11:07.840

如果您关心您的网页浏览量如何随一天中的时间而变化，选项 A 会保留该信息（尽管您可能仍会做一些分桶，例如每小时，以减少整体数据大小 - 但您可能会“稍后，关闭 -行”，同时归档所有详细信息）。选项 B 占用的空间要少得多，因为它会丢弃大量信息……您可能关心也可能不关心这些信息。如果你不知道你是否关心，我认为，有疑问，你应该保留更多而不是更少的数据——“总结和存档”过多的数据相当容易，但恢复数据一点也不容易'我聚集了;-)。所以，聚合风险更大……

如果您决定保留大量的每日数据，一种策略是使用多个表，例如每天一个；这将使处理旧数据变得最容易（对其进行汇总、存档、从实时数据库中删除），而不会减慢当前的“日志记录”。因此，比如说，5 月 29 日的综合浏览量将在 PV20090529 中——与前几天和后几天的不同表（这确实需要动态生成表名，或者`ALTER VIEW`在 cron-jobs 等中创造性地使用）没什么大不了！）。我经常发现这种“分片方法”具有出色的（有时甚至是意想不到的）投资回报，因为与单体数据库相比，数据库的扩展超出了最初的假设......

# sorting - 在视图或模型中过滤/排序？

> ID：923966
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-05-29T01:06:42.417
> 
>         
> 
> 标签：sorting, filtering, mvp

有一个数据对象列表和一些可视化的东西来表示每个对象，你会在哪里编写排序/过滤逻辑？为什么？

编辑：到目前为止所有的答案都很好，但我忘了添加另一个约束。如果我不想每次都重建视图怎么办？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:10:54.497

取决于排序/过滤操作的复杂性以及视图控件是否本机提供这些服务。如果视图控件提供过滤并且它只是重新格式化内存中的数据，则将其保留在视图中。如果排序/过滤器需要再次访问数据源，则将其全部保存在控制器中。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:31:35.563

答案在于数据。模型提供数据。如果所有数据都在视图中，则过滤和排序可以包含在视图中。如果数据被分块，模型必须传递数据并包含一些过滤/排序（视图可能仍然包含过滤/排序）。

控制器不应该包含这些功能，因为它是一种路由机制，不应该知道如何解释数据。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:09:49.553

我会在控制器中放入排序和过滤方法，并从视图中调用这些方法。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:09:56.433

您的视图应该只处理显示输出。将任何过滤/排序放入您的业务逻辑并将其返回到视图。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T02:22:16.833

我相信排序应该是分开的。您不应该对模型进行排序，因为您希望保持原样。基本上，模型中的更改意味着视图的重新渲染，而您可能不希望这样做（例如，如果您想为过滤器前后状态之间的过渡设置动画）。

我的建议是模型提供数据来创建视图的视觉对象列表和排序器对象。排序器对象将输出一个渲染列表，该列表只是一个链接到视觉对象的标识符列表（对象列表中的索引或其他）。ID 出现的顺序代表排序的顺序，任何不在渲染列表中的 ID 都会被隐藏。每次视图接收到渲染列表时，它都会更新它的显示。

# c# - 如何将此文本与正则表达式匹配？

> ID：923969
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-05-29T01:07:58.340
> 
>         
> 
> 标签：c#, regex

我试图制作一个正则表达式来匹配一段代码，但没有成功。该表达式在 vs2008 中不起作用。

我创建了这个：

```
/\*<parameters>\*/(?<value>[\r\n]*.*)/\*</parameters>\*/ 
```

要匹配的来源是：

```
/*<parameters>*/ 
@parameter blue
,@parameter2 red
,@parameter3 green
,@parameter4 yellow /*</parameters>*/ 
```

或更好：

```
/*<parameters>*/  \r\n @parameter blue \r\n ,@parameter2 red \r\n ,@parameter3 green \r\n ,@parameter4 yellow /*</parameters>*/ 
```

有谁能够帮我？

谢谢，罗德里戈·洛博

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T01:58:35.930

试试这个正则表达式：`/\*<parameters>\*/(?<value>[^/]*)/\*</parameters>\*/`

code.google.com 上的 regex-freetool 是一个玩弄真正 c# Regex 模式的好工具

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:55:56.373

`RegexOptions.Multiline`只会改变`^`and的语义`$`——你也需要`RegexOptions.Singleline`让`.`匹配行结束（我自己也陷入了困惑；-）。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:54:21.117

以下将解决问题：

```
/\*<parameters>\*/(.|\r|\n)*/\*</parameters>\*/ 
```

或者，如果您想从匹配本身中排除外部标记：

```
(?<=/\*<parameters>\*/)(.|\r|\n)*(?=/\*</parameters>\*/) 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T03:29:22.657

正如 Alex 所说，您可以使用 Singleline 修饰符让点匹配换行符（\r 和 \n）。您还可以使用内联形式 - `(?s)`- 在正则表达式本身中指定它：

```
(?s)/*<parameters>*/(?<value>.*?)/*</parameters>*/
```

还要注意不情愿的量词：“ `.*?`”。那是在文本中有不止一个潜在匹配的情况下；否则，您将从第一个`<parameters>`标签匹配到最后一个`</parameters>`标签。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:16:52.987

在您打开正则表达式“多行”选项后，您的正则表达式应该匹配您指定的所有文本。

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T01:58:25.680

我不想给你这个问题的鱼，所以你可能想试试这个来自 Ultrapico 的名为[Expresso](http://www.ultrapico.com/Expresso.htm)的免费工具（需要注册） 。

我曾多次使用 Regex 绊倒，而 Expresso 在所有情况下都挽救了这一天。

# c# - protobuf 和列表 - how to serialize / deserialize?
I have a List<object> with different types of objects in it like integers, strings, and custom types. All custom types are protobuf-adjusted. What I wanna do now i
问问题
matambo
问问题 2009-05-29T01:14:47.453
11883 次
This question shows research effort; it is useful and clear
7
This question does not show any research effort; it is unclear or not useful
Bookmark this question.
Show activity on this post.
I have a List<object> with different types of objects in it like integers, strings, and custom types. All custom types are protobuf-adjusted. What I wanna do now is to serialize / deserialize this list with protobuf.net. Up until now I suspect that I have to declare each and every type explicitly, which is unfortunately not possible with these mixed-list constructs. Because the binary formater has no problems to do these things I hope that I missed something and that you can help me out. So my question is how to deal with objects in protobuf.net.
(disclosure: I'm the author of protobuf-net)
BinaryFormatter is a metadata-based serializer; i.e. it sends .NET type information about every object serialized. protobuf-net is a contract-based serializer (the binary equivalent of XmlSerializer / DataContractSerializer, which will also reject this).
There is no current mechanism for transporting arbitrary objects, since the other end will have no way of knowing what you are sending; however, if you have a known set of different object types you want to send, there may be options. There is also work in the pipeline to allow runtime-extensible schemas (rather than just attributes, which are fixed at build) - but this is far from complete.
This isn't ideal, but it works... it should be easier when I've completed the work to support runtime schemas:
using System; using System.Collections.Generic; using ProtoBuf; [ProtoContract] [ProtoInclude(10, typeof(DataItem<int>))] [ProtoInclude(11, typeof(DataItem<string>))] [ProtoInclude(12, typeof(DataItem<DateTime>))] [ProtoInclude(13, typeof(DataItem<Foo>))] abstract class DataItem { public static DataItem<T> Create<T>(T value) { return new DataItem<T>(value); } public object Value { get { return ValueImpl; } set { ValueImpl = value; } } protected abstract object ValueImpl {get;set;} protected DataItem() { } } [ProtoContract] sealed class DataItem<T> : DataItem { public DataItem() { } public DataItem(T value) { Value = value; } [ProtoMember(1)] public new T Value { get; set; } protected override object ValueImpl { get { return Value; } set { Value = (T)value; } } } [ProtoContract] public class Foo { [ProtoMember(1)] public string Bar { get; set; } public override string ToString() { return "Foo with Bar=" + Bar; } } static class Program { static void Main() { var items = new List<DataItem>(); items.Add(DataItem.Create(12345)); items.Add(DataItem.Create(DateTime.Today)); items.Add(DataItem.Create("abcde")); items.Add(DataItem.Create(new Foo { Bar = "Marc" })); items.Add(DataItem.Create(67890)); // serialize and deserialize var clone = Serializer.DeepClone(items); foreach (DataItem item in clone) { Console.WriteLine(item.Value); } } }
c#.net-3.5protobuf-net
4
2 回答 2
This answer is useful
13
（披露：我是 protobuf-net 的作者）
BinaryFormatter是一个基于元数据的序列化器；即它发送关于每个序列化对象的.NET 类型信息。protobuf-net 是一个基于合约的序列化器（二进制等价于XmlSerializer/ DataContractSerializer，它也将拒绝这个）。
当前没有传输任意对象的机制，因为另一端无法知道您发送的是什么；但是，如果您有一组已知的要发送的不同对象类型，则可能有一些选项。管道中还有一些工作允许运行时可扩展的模式（而不仅仅是属性，它们在构建时固定）——但这还远未完成。
这并不理想，但它可以工作......当我完成支持运行时模式的工作时应该会更容易：
using System; using System.Collections.Generic; using ProtoBuf; [ProtoContract] [ProtoInclude(10, typeof(DataItem<int>))] [ProtoInclude(11, typeof(DataItem<string>))] [ProtoInclude(12, typeof(DataItem<DateTime>))] [ProtoInclude(13, typeof(DataItem<Foo>))] abstract class DataItem { public static DataItem<T> Create<T>(T value) { return new DataItem<T>(value); } public object Value { get { return ValueImpl; } set { ValueImpl = value; } } protected abstract object ValueImpl {get;set;} protected DataItem() { } } [ProtoContract] sealed class DataItem<T> : DataItem { public DataItem() { } public DataItem(T value) { Value = value; } [ProtoMember(1)] public new T Value { get; set; } protected override object ValueImpl { get { return Value; } set { Value = (T)value; } } } [ProtoContract] public class Foo { [ProtoMember(1)] public string Bar { get; set; } public override string ToString() { return "Foo with Bar=" + Bar; } } static class Program { static void Main() { var items = new List<DataItem>(); items.Add(DataItem.Create(12345)); items.Add(DataItem.Create(DateTime.Today)); items.Add(DataItem.Create("abcde")); items.Add(DataItem.Create(new Foo { Bar = "Marc" })); items.Add(DataItem.Create(67890)); // serialize and deserialize var clone = Serializer.DeepClone(items); foreach (DataItem item in clone) { Console.WriteLine(item.Value); } } }
于 2009-05-29T05:06:58.647 回答
This answer is useful
0
List<YourClass> list; ProtoBuf.Serializer.Deserialize<List<YourClass>>(filestream);
于 2015-06-02T10:12:53.700 回答
Related
1
android - 使用 Trigger.io 检测推送通知的到达
1
php - PHP：选中的单选按钮不起作用
1
ruby - 如何将一些文本附加到字符串并将其作为方法调用？
1
matlab - 如果存在获取未定义的变量
4
php - Doctrine QueryBuilder 删除与连接
2
java - 删除 GXT Tabpanel 的默认关闭选项卡选项？
2
asp.net - 访问性能计数器时“拒绝访问注册表项‘全局’”
1
c - Sublime Text 2 C 编译
1
python-3.x - Pillow 2.0 拒绝使用 zlib
3
tfs - 我在哪里管理 TFS 工作项标签，例如重命名或删除？
Reference
php × 1429865
c/c++ × 756500
nginx × 49975
mongodb × 159057
mybatis × 3233
anaconda × 13410
pycharm × 14671
python × 1902243
vscode × 56040
docker × 110988
github × 49000
flask × 49129
ffmpeg × 24037
jmeter × 16910
matplotlib × 63493
bootstrap × 54641

> ID：923977
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：
> 
>         
> 
> 标签：c#, .net-3.5, protobuf-net

I have a `List<object>` with different types of objects in it like integers, strings, and custom types. All custom types are protobuf-adjusted.
What I wanna do now is to serialize / deserialize this list with protobuf.net. Up until now I suspect that I have to declare each and every type explicitly, which is unfortunately not possible with these mixed-list constructs. Because the binary formater has no problems to do these things I hope that I missed something and that you can help me out.
So my question is how to deal with objects in protobuf.net.

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-05-29T05:06:58.647

（披露：我是 protobuf-net 的作者）

`BinaryFormatter`是一个基于元数据的序列化器；即它发送关于每个序列化对象的.NET 类型信息。protobuf-net 是一个基于合约的序列化器（二进制等价于`XmlSerializer`/ `DataContractSerializer`，它也将拒绝这个）。

当前没有传输*任意*对象的机制，因为另一端*无法*知道您发送的是什么；但是，如果您有一*组已知*的要发送的*不同对象类型，则可能有一些选项。*管道中还有一些工作允许运行时可扩展的模式（而不仅仅是属性，它们在构建时固定）——但这还远未完成。

* * *

这并不理想，但它可以工作......当我完成支持运行时模式的工作时应该会更容易：

```
using System;
using System.Collections.Generic;
using ProtoBuf;
[ProtoContract]
[ProtoInclude(10, typeof(DataItem<int>))]
[ProtoInclude(11, typeof(DataItem<string>))]
[ProtoInclude(12, typeof(DataItem<DateTime>))]
[ProtoInclude(13, typeof(DataItem<Foo>))]
abstract class DataItem {
    public static DataItem<T> Create<T>(T value) {
        return new DataItem<T>(value);
    }
    public object Value {
        get { return ValueImpl; }
        set { ValueImpl = value; }
    }
    protected abstract object ValueImpl {get;set;}
    protected DataItem() { }
}
[ProtoContract]
sealed class DataItem<T> : DataItem {
    public DataItem() { }
    public DataItem(T value) { Value = value; }
    [ProtoMember(1)]
    public new T Value { get; set; }
    protected override object ValueImpl {
        get { return Value; }
        set { Value = (T)value; }
    }
}
[ProtoContract]
public class Foo {
    [ProtoMember(1)]
    public string Bar { get; set; }
    public override string ToString() {
        return "Foo with Bar=" + Bar;
    }
}
static class Program {
    static void Main() {
        var items = new List<DataItem>();
        items.Add(DataItem.Create(12345));
        items.Add(DataItem.Create(DateTime.Today));
        items.Add(DataItem.Create("abcde"));
        items.Add(DataItem.Create(new Foo { Bar = "Marc" }));
        items.Add(DataItem.Create(67890));

        // serialize and deserialize
        var clone = Serializer.DeepClone(items);
        foreach (DataItem item in clone) {
            Console.WriteLine(item.Value);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2015-06-02T10:12:53.700

```
List<YourClass> list;
ProtoBuf.Serializer.Deserialize<List<YourClass>>(filestream); 
```

# asp.net - 将变量值从 javascript 传递到 ASP

> ID：923979
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-05-29T01:15:14.503
> 
>         
> 
> 标签：asp.net, jquery, drag-and-drop, hidden

在这个社区的帮助下，我已经能够将一段静态文本从 javascript（客户端）传递到 ASP 3.5（服务器端）！这段代码效果很好：

```
$('.drop').droppable({
    tolerance: "touch", // Here should be a string
    drop: function() {

    $('[id$="myHidden"]').val('Testy test test');
    __doPostBack('<%= HiddenButton.UniqueID  %>', '');
    alert($('[id$="myHidden"]').val());

    }

}); 
```

上面所做的是，当一个具有 .drop 类的元素被删除时，它会将字符串“Testy test test”分配给我的aspx页面上的隐藏字段。然后它回发到我在更新面板中的一个不可见按钮。隐藏按钮的点击事件触发，它会抛出一个显示隐藏元素内容的 msgbox，它总是“Testy test test”。

现在这是我遇到一些问题的地方。在我放入 dropzone 中的任何内容中，我不想将隐藏字段的值设置为静态字符串，而是将其设置为我放入 dropzone 中的任何内容的 ID。这是我改变的：

```
 $('[id$="myHidden"]').val($(ui.draggable).attr("id"));
    __doPostBack('<%= HiddenButton.UniqueID  %>', '');
    alert($('[id$="myHidden"]').val()); 
```

现在突然之间，当我放下一些东西时，它会粘在放置区上，并且不会触发任何放置事件。我弄坏了什么吗？还是我试图以错误的方式获取已删除元素的 ID？

如果它很重要，这里是相关的 aspx 页面内容：

```
<asp:Button ID="HiddenButton" runat="server" Text="Button" /> 
```

该按钮通常通过 css 隐藏，我只是暂时不隐藏它以进行测试。

编辑！！！！：

我也试过这个，但它不起作用（所以我可以排除'var'的事情？）

```
var foo = $(ui.draggable).attr("id")
    $('[id$="myHidden"]').val(foo);
    __doPostBack('<%= HiddenButton.UniqueID  %>', '');
    alert($('[id$="myHidden"]').val()); 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:39:38.870

在您的 drop 函数中，您没有提供任何形式参数：

```
drop: function() { 
```

应该

```
drop: function(ev, ui) { 
```

我在你的 drop 回调中猜测这个表达式：

```
$(ui.draggable).attr("id") 
```

失败，因为无法在函数范围内引用 ui 对象。

# asp.net-mvc - 在 ASP .NET MVC 中访问实体管理器

> ID：923986
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T01:17:30.490
> 
>         
> 
> 标签：asp.net-mvc, entity-framework

问候， 试图通过最好的方式来提供对我的实体管理器的访问，同时通过请求保持上下文打开以允许延迟加载。我看到很多类似下面的例子：

```
public class SomeController
{
     MyEntities entities = new MyEntities();
} 
```

我在此设置中看到的问题是，如果您有一层要调用的业务类，则最终必须将管理器作为参数传递给这些方法，如下所示：

```
public static GetEntity(MyEntities entityManager, int id)
{
      return entityManager.Series.FirstOrDefault(s => s.SeriesId == id);
} 
```

显然，我正在寻找一种好的、线程安全的方法，将 entityManager 提供给方法而不传递它。该方式还需要是可单元测试的，我之前将其放入 Session 的尝试不适用于单元测试。

我实际上正在为企业级应用程序寻找在 ASP .NET MVC 中处理实体框架的推荐方法。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:28:42.573

Entity Framework v1.0 在 Windows 窗体应用程序中表现出色，您可以随意使用对象上下文。特别是在 asp.net 和 mvc 中，它有点难。我对此的解决方案是使存储库或实体管理器更像 MVC 可以与之通信的服务。我创建了一种[通用的通用基础存储库](http://blog.zoolutions.se/post/2009/03/26/Generic-Repository-for-Entity-Framework.aspx)，只要我愿意，我就可以使用它，并且不再为正确地做太多事情而烦恼。我会尽量避免让对象上下文保持打开状态，甚至比 Web 应用程序中绝对需要的时间还要长一毫秒。

看看EF4。我开始在生产环境中使用 EF，当时它是 beta 0.75 或类似的版本，除了它有时是“艰​​苦的工作”之外，它并没有真正的问题。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T01:49:23.610

您可能想查看存储库模式（这里是使用 Linq to SQL[编写的存储库）。](http://www.codeproject.com/KB/architecture/linqrepository.aspx)

基本思想是，您实例化一个版本的存储库，而不是创建一个静态类。您可以将 EntityManager 作为参数传递给构造函数中的类 - 或者更好的是，可以为该类创建 EntityManager 的工厂，以便它可以执行管理器的工作单元实例化。

对于 MVC，我使用基本控制器类。在这个类中，您可以创建您的实体管理器工厂并使其成为该类的属性，以便派生类可以访问它。如果传入的实例为空，则允许它从构造函数中注入，但使用适当的默认值创建。每当控制器方法需要创建存储库时，它可以使用此实例传递到存储库，以便它可以创建所需的管理器。

通过这种方式，您摆脱了静态方法并允许在单元测试中使用模拟实例。通过传入一个工厂——它应该创建实现接口的实例，顺便说一句——你将你的存储库与实际的管理器类分离。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:35:47.957

不要在视图中延迟加载实体。不要在视图中进行业务层调用。在控制器中加载视图需要的所有实体，计算视图在控制器中需要的所有总和和平均值，等等。毕竟，这就是控制器的用途。

# c - 为什么在 1024 个连接后连接被拒绝？

> ID：923990
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-05-29T01:19:45.290
> 
>         
> 
> 标签：c, linux, sockets

我正在本地 Linux 服务器上进行测试，服务器和客户端都在同一台服务器上。大约 1024 次连接后，在我的代码中，我连接的地方，连接被拒绝。起初我以为选择的 fd_set_max 限制为 1024 并将服务器更改为轮询而不是选择，但我仍然没有超过这个数字。我的 ulimit -n 设置为 2048 并且我监视服务器上的 lsof 它达到大约 1033（不确定这是否是确切数字）并且失败。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-05-29T07:37:06.107

如果您的连接速度快于服务器调用速度`accept()`，则待处理连接队列可能已满。最大队列长度由`listen()`服务器中的第二个参数设置，`sysctl net.core.somaxconn`如果更低，则为（通常为 128）的值。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:21:19.470

也许您达到了打开文件描述符的进程限制。

我不确定我是否理解正确：您是否在同一进程中同时拥有服务器端和客户端？然后您将使用两倍的文件描述符。这与您在 ulimit 中看到的很接近。如果不是这种情况，问题可能出在服务器端吗？也许服务器进程用完了描述符并且不能再*接受*更多的连接。

[接受手册页](http://manpages.ubuntu.com/manpages/jaunty/man2/accept.2.html)提到您应该获得以下返回值：

> EMFILE
> 
>    已达到打开文件描述符的每个进程限制。
> 
>   
>   
> 
> ENFILE
> 
>   已达到打开文件总数的系统限制。

你得到什么错误代码？您显然只能将成功 _accept_ed 的连接添加到*select*或*poll 中*。

我知道您已经知道如何检查*ulimit*，但其他人可能不知道：

```
ulimit -a
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 40448
max locked memory       (kbytes, -l) 32
max memory size         (kbytes, -m) unlimited
open files                      (-n) 4096
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) 40448
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T01:59:07.083

服务器为它接受的每个连接打开一个单独的日志文件是否有任何危险？

其他组说服务器有什么上限？

在我照顾的一个程序中（几年前）有一些代码将最大文件大小设置为 1 MB。'可惜刚加的时候变大了，但是随着时间的流逝和文件限制的增长，后来就变小了！服务器是否有可能存在类似问题 - 它将打开文件的最大数量设置为 1024 之类的高得离谱的数字？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-29T02:15:59.607

对大多数琐碎的问题表示歉意:)
当您说“更改为轮询”时，您是否重新编译了服务器？服务器是否在同一帐户下运行？它是`fork`-ing 还是线程服务器？你在客户端上`errno == ECONNREFUSED`接到电话后`connect()`吗？你能确认你得到了对with`RST`的回应吗？客户端端口号是否被重用？状态有联系吗？`SYN``tcpdump``TIME_WAIT`

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-05-31T20:53:18.417

我在错误处理例程中看到了您使用 close(sock_fd) 语句所做的评论。  

您是否在使用后显式关闭套接字 - close() 或 shutdown()。

我猜不会。您实际上有 1024 多个并发活动连接？为了做到这一点，你必须有 pthreads 参与。那是对的吗？

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2011-01-26T12:51:05.630

我有同样的症状。即使增加 ulimit -n 我仍然无法处理超过 1024 个传入连接...

我的问题是我使用了 select，它无法处理高于 1024 的套接字 FD。所以当我增加限制时，我的问题实际上改变了！！！（一开始我没有注意到......）

因此，为了帮助任何有类似问题的人：

**如果你想要超过 1024 个套接字，你必须**

*   **增加**开放 FD的**限制**(ulimit -n)

*   并且您可能**不会使用 select** () （使用**poll** () 代替）

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2009-05-29T08:31:42.597

您的限制来自 linux 用户限制。如果未指定，则 linux 限制为 1024 个打开文件。要永久更改它，请编辑 /etc/security/limits.conf 并添加

用户软文件 16535 用户硬文件 16535

或从控制台尝试

ulimit -n 16535

问候

* * *

## 回答 #8

> 赞同：-1
> 
>             
> 
> 时间：2009-06-01T17:06:55.473

因此，经过更多研究.. 看起来我的服务器端监听的队列深度为 20。我认为这就是原因。你们中的任何人都认为这也是问题所在吗？

问候

# programming-languages - CLR 上的功能开发

> ID：923998
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-05-29T01:23:39.870
> 
>         
> 
> 标签：programming-languages, functional-programming, clr

如果这已经被问及回答，请指出我现有的问答，我将删除这个问题。我确实看了，没有看到这个回答。

CLR 平台除了 F# 之外，是否还有主要的函数式语言（如 LISP、Scheme、Haskell 等）？我说“主要是函数式”是因为我意识到有些 CLR 语言具有像 (Iron)Python 这样的函数式构造，但我不会将 Python 视为一种函数式语言。  

我之所以问，是因为我正在为工作中的其他一些开发人员做关于 FP 和并发的演示，他们在问我关于 F#（我们使用 Microsoft 工具堆栈），我想确保他们知道所有可能的选项。

* * *

编辑

从下面的答案：

[铁计划](http://www.codeplex.com/IronScheme)

[网点网](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/hs-dotnet)

[Scala](http://www.scala-lang.org)（用于 .Net）

[内梅尔](http://nemerle.org/Main_Page)

而且我已经看到了有关[Clojure](http://www.clojure.org)的 CLR 版本的内容。谢谢各位的意见。  

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:26:01.410

有[IronScheme](http://www.codeplex.com/IronScheme)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T07:48:17.833

Scala 端口也可用，但似乎不是最新的。

一些包含更多信息的链接：

[在 .NET 上开始使用 Scala](http://hestia.typepad.com/flatlander/2009/01/getting-started-with-scala-on-net.html)

[Scala .NET 生产准备好了吗？](https://stackoverflow.com/questions/743172/is-scala-net-production-ready)

[Microsoft .NET 上的 Scala](http://www.scala-lang.org/node/168)

另一种值得一试的语言显然是[Nemerle](http://nemerle.org/Main_Page)，它看起来可能是这个线程中最有用的建议！

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-05-29T07:24:21.640

[hs-dotnet](http://hackage.haskell.org/cgi-bin/hackage-scripts/package/hs-dotnet)允许您编写与 CLR 代码直接（和在进程内）接口的 Haskell 代码，但 Haskell 代码实际上并不在 CLR 上运行。

# php - mysql "with rollup" 查询变成了树形结构

> ID：923999
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-05-29T01:24:15.470
> 
>         
> 
> 标签：php, mysql, tree, hierarchy, rollup

**背景：**

我在 MySQL 中定义了这个“with rollup”查询：

```
 SELECT      
        case TRIM(company)
            when 'apple'        THEN 'AAPL'
            when 'microsoft'    THEN 'MSFT'
            else '__xx__'
        END as company        

        ,case TRIM(division)
            when 'hardware'         THEN Trim(division)
            when 'software'         THEN Trim(division)
            else '__xx__'
        END as division

        ,concat( '$' , format(sum(trydollar),0))    as  dollars
    FROM        pivtest
    GROUP BY    
        company, division with rollup 
```

它生成以下输出：

> ```
> AAPL;hardware;$279,296
> AAPL;software;$293,620
> AAPL;__xx__;$572,916
> MSFT;hardware;$306,045
> MSFT;software;$308,097
> MSFT;__xx__;$614,142
> __xx__;__xx__;$1,187,058 
> ```

如果您以前在 MySQL 中使用过“with rollup”查询，您很可能可以推断出我的源表的结构。

**问题：**

鉴于 MySQL 的原始输出，获得如下“树”结构的最简单方法是什么？

```
AAPL
    hardware;$279,296
    software;$293,620
        Total; $572,916
MSFT
    hardware;$306,045
    software;$308,097
        Total;$614,142
Total    
            $1,187,058 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T01:48:54.843

**最简单**的方法是在您用来接收和显示用户 MySQL 输出的任何客户端程序中执行此操作——在数据层中实现表示层功能绝对*不是*最容易的！-) 所以告诉我们您的客户端程序中使用的是什么语言 &c我们也许可以提供帮助...

编辑：应原始提问者的要求提供简单的 Python 客户端解决方案。

使用 Python 的 DB API，来自 DB 查询的结果可以最简单地视为元组列表。因此，这是一个根据需要格式化这些结果的函数：

```
def formout(results):
  marker = dict(__xx__='   Total')
  current_stock = None
  for stock, kind, cash in results:
    if stock != current_stock:
      print marker.get(stock, stock).strip()
      current_stock = stock
    if kind in marker and stock in marker:
      kind = ' '*8
    print '    %s;%s' % (marker.get(kind, kind), cash) 
```

`marker`是一个字典，用于将特殊标记映射`'__xx__'`到输出中的所需字符串（我为“中间”总计适当地填充它，所以当我打印最终的“总计”时，我把`.strip()`那些空白去掉）。我还使用它来检查前两列都是标记的特殊情况（因为在这种情况下，第二列需要改为空格）。如有必要，请随时在评论中询问 Python 习语的任何进一步说明和使用！

这是我使用提供的数据调用此函数时看到的输出（变成了一个包含 7 个元组的列表，每个元组有 3 个字符串）：

```
AAPL
    hardware;$279,296
    software;$293,620
       Total;$572,916
MSFT
    hardware;$306,045
    software;$308,097
       Total;$614,142
Total
            ;$1,187,058 
```

空间对齐与我在问题中看到的不同（就应该有多少空间而言，这有点不一致），但我希望它足够接近您想要的内容，以便您轻松调整这符合您的确切需求（因为无论如何您都必须将 Python 翻译成 PHP，所以空间调整应该是最少的）。************ 
```