# StackOverflow 问答 11569000-11569999

# hibernate - 在具有复合键的连接子类中休眠 IllegalArgumentException

> ID：11569010
> 
> 赞同：0
> 
> 时间：2012-07-19T20:45:02.640
> 
> 标签：hibernate, database-design, orm, hibernate-mapping

编辑 #2 - 在底部添加人员类。

这让我发疯！我认为这是一个映射问题，但我不确定。我是 Hibernate 的新手，我认为使用带有复合键的连接子类会让我很困惑。

当我打开会话并且消息是：

```
Initial SessionFactory creation failed.org.hibernate.PropertyAccessException:
IllegalArgumentException occurred calling getter of com.dave.test.Person.personId
Exception in thread "main" java.lang.ExceptionInInitializerError
at com.mkyong.util.HibernateUtil.buildSessionFactory(HibernateUtil.java:17)
at com.mkyong.util.HibernateUtil.<clinit>(HibernateUtil.java:8)
at com.mkyong.App.main(App.java:21)

Caused by: org.hibernate.PropertyAccessException: IllegalArgumentException occurred calling
getter of com.dave.test.Person.personId
at org.hibernate.property.BasicPropertyAccessor$BasicGetter.get 
(BasicPropertyAccessor.java:198)

Caused by: java.lang.IllegalArgumentException: object is not an instance of declaring class
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.hibernate.property.BasicPropertyAccessor$BasicGetter.get(BasicPropertyAccessor.java:172)
... 11 more 
```

第一个映射：

```
<hibernate-mapping>
  <class name="com.mkyong.stock.Appointment" table="appointment" catalog="physdb">
    <composite-id name="id" class="com.dave.test.AppointmentId">
        <key-property name="personId" type="int">
            <column name="person_id" />
        </key-property>
        <key-property name="apptdate" type="timestamp">
            <column name="apptdate" length="19" />
        </key-property>
    </composite-id>
    <many-to-one name="client" update="false" insert="false" fetch="select">
        <column name="person_id" not-null="true" />
    </many-to-one>
    <property name="location" type="string">
        <column name="location" length="45" not-null="true" />
    </property>
    <property name="fee" type="big_decimal">
        <column name="fee" precision="7" />
    </property>
    <property name="paid" type="big_decimal">
        <column name="paid" precision="7" />
    </property>
    <property name="serviceRendered" type="boolean">
        <column name="service_rendered" not-null="true" />
    </property>
  </class>
</hibernate-mapping> 
```

第二个映射：

```
<hibernate-mapping>
<class name="com.dave.test.Person" table="person" catalog="physdb">
    <id name="personId" >
        <column name="person_id" />
        <generator class="identity" />
    </id>
    <property name="firstName" type="string">
        <column name="first_name" length="45" not-null="true" />
    </property>
    <property name="lastName" type="string">
        <column name="last_name" length="45" not-null="true" />
    </property>
    <property name="phone" type="string">
        <column name="phone" length="15" />
    </property>
    <property name="cellPhone" type="string">
        <column name="`cell_phone`" length="15" />
    </property>

    <joined-subclass name="com.dave.test.Client" table="client" extends="Person">
            <key column="person_id" />
    <set name="appointments" cascade="all" inverse="true" lazy="false">
        <key column="person_id"/>
        <one-to-many class="com.dave.test.Appointment"/>
    </set>      

    <property name="complaint" type="string">
        <column name="complaint" not-null="true" />
    </property>
    <property name="notes" type="string">
        <column name="notes" not-null="false" />
    </property>
    <property name="doctor" type="string">
        <column name="doctor" not-null="false" />
    </property>
    </joined-subclass>

<joined-subclass name="com.dave.test.Therapist" table="therapist" extends="Person">
            <key column="person_id" />

    <property name="school" type="string">
        <column name="school" not-null="false" />
    </property>
    <property name="specialties" type="string">
        <column name="notes" not-null="false" />
    </property>
    <property name="hiredate" type="date">
        <column name="hiredate" not-null="true" />
    </property>
</joined-subclass>

 </class>
</hibernate-mapping> 
```

这些课程是：

```
public class Client extends Person implements java.io.Serializable {

private int personId;
private Person person;
private String complaint;
private String notes;
private String doctor;
private Set appointments = new HashSet();
public int getPersonId() {
    return this.personId;
}

public void setPersonId(int personId) {
    this.personId = personId;
}

}

public class Appointment implements java.io.Serializable {

private AppointmentId id;
private Client client;
private String location;
private BigDecimal fee;
private BigDecimal paid;
private boolean serviceRendered;

public AppointmentId getId() {
    return this.id;
}

public void setId(AppointmentId id) {
    this.id = id;
}
}

public class AppointmentId implements java.io.Serializable {

private int personId;
private Date apptdate;

public int getPersonId() {
    return this.personId;
}

public void setPersonId(int personId) {
    this.personId = personId;
}

}

public class Person implements java.io.Serializable {

private int personId;
private String firstName;
private String lastName;
private String phone;
private String cellPhone;
private Therapist therapist;
private Client client;

public int getPersonId() {
    return this.personId;
}

public void setPersonId(int personId) {
    this.personId = personId;
}
} 
```

当我弄清楚这一点时，我确定我会踢自己，但是有人可以帮帮我吗？谢谢戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T08:34:11.343

首先，`Client`类包含`personId`属性（加上 getter 和 setter）。由于`Client`extends `Person`，它继承了该`personId`属性。所以`Client`应该删除类中的那个。

第二件事，`Client`类包含对 a 的引用`Person`，除非客户端有另一个`Person`（has-a，不是 is-a），否则我认为这是错误的并且可能会导致问题（尽管未在 XML 中映射）。

# c# - 比较对象类型时 typeof 和 is 有什么区别？

> ID：11569017
> 
> 赞同：5
> 
> 时间：2012-07-19T20:45:31.510
> 
> 标签：c#, types, controls

> **可能重复：**
> [类型检查：typeof、GetType 或 is？](https://stackoverflow.com/questions/983030/type-checking-typeof-gettype-or-is)

所以我正在比较一个控件的类型，我想我可以做这样的事情。

```
if (control[0].GetType() is TSendForReview) 
```

但是，我收到以下警告。

```
The given expression is never of the provided ('MyApp.Controls.TSendForReview') type 
```

所以如果我把它切换到这个警告就会消失。

```
if (control[0].GetType() == typeof(TSendForReview)) 
```

在比较控件类型时，该警告究竟是什么意思以及 typeof 和 is 之间的区别是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T20:47:17.427

`GetType`返回 的实例，`System.Type`而 this 绝不是 的实例`TSendForReview`。您可能想使用

```
if(control[0] is TSendForReview) 
```

查看控件是否是您的类型的实例。

您修改后的版本获取控件的运行时类型并将其与`TSendForReview`. 这与使用 is 不同，因为它必须具有确切的类型，而`is`对于`TSendForReview`.

为什么要发出警告？

> 如果已知表达式始终为真或始终为假，则 is 关键字会导致编译时警告，但通常会在运行时评估类型兼容性。

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/scekt9xw.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:06:01.460

IS 运算符将为实现给定类型的所有对象返回 true。GetType 函数返回对象的类型实例。因此，根据您的场景将确定您希望如何执行类型检查。

取下面的代码

```
public interface IFoo { }
public class Foo : IFoo { }
public class FooDerived : Foo { } 
```

那么下面的检查总是错误的，因为 IFoo 是一个接口（同样适用于抽象类），因为没有具体的实现。这可能是编译器大喊大叫的。

```
obj.GetType() == typeof(IFoo) 
```

如果检查如下，则 Foo 和 FooDerived 都为 true，其他所有内容为 false。

```
obj is IFoo 
```

如果您想确保一个对象是特定类型，而不是任何实现该类型的对象，您将要执行如下检查，这对于 Foo 是正确的，但对于 FooDerived 不是。

```
obj.GetType() == typeof(Foo) 
```

# gson - 使用 gson 反序列化多种类型

> ID：11569018
> 
> 赞同：0
> 
> 时间：2012-07-19T20:45:32.103
> 
> 标签：gson

我从我的 http Web 服务收到以下 JSON 响应

```
{"status":100,"data":[{"name":"kitchen chair","price":25.99,"description":null}]} 
```

现在我希望能够反序列化它。我偶然发现了来自 Google 的 Gson，它起初对一些小型测试用例效果很好，但我在反序列化上述字符串时遇到了一些麻烦。

我知道该`data`字段中只有一个项目，但它可以包含多个项目，这就是为什么所有响应都将该`data`字段作为一个数组。

我正在阅读[Gson 用户指南](https://sites.google.com/site/gson/gson-user-guide)，理想情况下，我希望有一个`Response`具有两个属性的对象：`status`和`data`，但该`data`字段必须是一个`List`对象`Map`，这可能会让 Gson 很难。

然后我查看了[this](http://code.google.com/p/google-gson/source/browse/trunk/extras/src/main/java/com/google/gson/extras/examples/rawcollections/RawCollectionsExample.java)，这是一个更接近我的问题的示例，但我仍然无法弄清楚。在示例中，整个响应是一个数组，而我的 JSON 字符串有一个字符串元素，然后是一个数组。

我将如何最好地进行反序列化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T23:07:55.270

目前尚不清楚究竟已经尝试过什么似乎“对 Gson 来说很难”。

Gson 的最新版本简单地处理了这个问题。下面是一个例子。

**输入.json**

```
{
    "status":100,
    "data":
    [
        {
            "name":"kitchen chair",
            "price":25.99,
            "description":null
        }
    ]
} 
```

**响应.java**

```
import java.util.List;
import java.util.Map;

class Response
{
  int status;
  List<Map> data;
} 
```

**GsonFoo.java**

```
import java.io.FileReader;

import com.google.gson.Gson;

public class GsonFoo
{
  public static void main(String[] args) throws Exception
  {
    Response response = new Gson().fromJson(new FileReader("input.json"), Response.class);
    System.out.println(new Gson().toJson(response));
  }
} 
```

**输出：**

```
{"status":100,"data":[{"name":"kitchen chair","price":25.99}]} 
```

# avl-tree - 从 AVL 树到红黑树

> ID：11569021
> 
> 赞同：1
> 
> 时间：2012-07-19T20:45:41.840
> 
> 标签：avl-tree, red-black-tree, 2-3-4-tree

根据我的书，在 AVL 树中从偶数高度的节点到奇数高度的节点的红色链接着色给出了（完全平衡的）2-3-4 树，其中红色链接不一定是左倾的。但我不知道具体如何。当我尝试一些例子时，我一直卡住。有人可以为我说明一下吗？

# ruby-on-rails - Rails Asset Pipeline：在开发中提供字体时如何设置 Access-Control-Allow-Origin 标头？

> ID：11569023
> 
> 赞同：2
> 
> 时间：2012-07-19T20:45:45.230
> 
> 标签：ruby-on-rails, ruby, asset-pipeline, webfonts

为这些字体资源提供服务的 rails 项目与使用它的项目位于不同的域中。在生产中，我们可以轻松地将 Access-Control-Allow-Origin 标头添加到 Apache，因为 Apache 将负责提供静态资产。然而，在开发中，我们有相同的设置（dev.domain1.com 和 dev.domain2.com），除了 Rails 处理字体资源的服务（我假设）。

如何配置 Rails 以设置 Access-Control-Allow-Origin 标头以在开发模式下为这些资产提供服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T21:59:12.137

事实证明，答案比我想象的要容易。如果要在生产中添加此标头，**则需要启用 headers.mod**并配置 Apache 以在响应中设置此标头：

```
Header set Access-Control-Allow-Origin "*" 
```

开发中的解决方案是相同的。这样做的原因是即使 Rails 正在为资产提供服务，Apache 仍然能够设置标头。

# c# - 必应地图凭据不存在？

> ID：11569025
> 
> 赞同：1
> 
> 时间：2012-07-19T20:45:58.907
> 
> 标签：c#, wpf, soap, bing-maps

我正在搞乱 Bing Maps WPF 控件和 SOAP 服务，试图对一个点进行反向地理编码。我试图从[这个项目](http://www.codeproject.com/Articles/79123/Sample-WPF-Application-Consuming-Bing-Maps-Web-Ser)中实现一些代码，特别是这段代码：

```
private string ReverseGeocodePoint(string locationString)
          {
              string results = "";
              ReverseGeocodeRequest reverseGeocodeRequest = new ReverseGeocodeRequest();

              // Set the credentials using a valid Bing Maps key
              reverseGeocodeRequest.Credentials = new GeocodeService.Credentials();
              reverseGeocodeRequest.Credentials.ApplicationId = key;

              // Set the point to use to find a matching address
              GeocodeService.Location point = new GeocodeService.Location();
              string[] digits = locationString.Split(';');

              point.Latitude = double.Parse(digits[0].Trim());
              point.Longitude = double.Parse(digits[1].Trim());

              reverseGeocodeRequest.Location = point;

              // Make the reverse geocode request
              GeocodeServiceClient geocodeService = new GeocodeServiceClient();
              GeocodeResponse geocodeResponse = geocodeService.ReverseGeocode(reverseGeocodeRequest);

              if (geocodeResponse.Results.Length > 0)
                  results = geocodeResponse.Results[0].DisplayName;
              else
                  results = "No Results found";

              return results;
          } 
```

但是，当我尝试实现它时，我被告知：`Error: The type or namespace name 'Credentials' does not exist in the namespace 'GeocodeTest.GeocodeService' (are you missing an assembly reference?)`此错误发生在线：

```
reverseGeocodeRequest.Credentials = new GeocodeService.Credentials(); 
```

好奇，我决定通过对象浏览器看一下服务引用。显然，我`GeocodeService`的甚至没有`Credentials`会员。所以现在的问题是：

*   **我应该自己添加成员吗？如果是这样，我该怎么做？**
*   **如果没有，在提供凭证方面有哪些替代方案？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T04:26:43.400

The `Credentials` namespace/type doesn't exist for the service reference `GeocodeText.GeocodeService`. Instead, you have to use the `Credentials` from the Bing Maps WPF Control. The statement would look like so:

```
reverseGeocodeRequest.Credentials = new Microsoft.Maps.MapControl.WPF.Credentials(); 
```

# class - 在构造函数中调用静态方法——CoffeeScript

> ID：11569036
> 
> 赞同：4
> 
> 时间：2012-07-19T20:46:44.427
> 
> 标签：class, static, coffeescript

假设我正在声明一个 class `Game`。

```
class @Game
    constructor: ->
        @id = Game.generateNewGameId() # <---
    player1: null
    player2: null
    @generateNewGameId: -> "blahblah23" 
```

在这里，我使用`generateNewGameId`as `Game.generateNewGameId()`。

这是正确的方法还是有更好的方法？我试过使用`this::generateNewGameId()`但范围不同。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T21:23:38.707

如果你真的想`generateNewGameId`成为一个类方法，那么你可以使用[`@constructor`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/constructor)它：

> 返回对创建实例原型的 Object 函数的引用。请注意，此属性的值是对函数本身的引用 [...]

所以是这样的：

```
class Game
    constructor: ->
        @id = @constructor.generateNewGameId()
    @generateNewGameId: ->
        "blahblah23" 
```

请注意，如果您子类化，这将做正确的事情`Game`：

```
class C extends Game # With an override of the class method
    @generateNewGameId: ->
        'pancakes'    

class C2 extends Game # or without 
```

演示（请打开您的控制台）：http: [//jsfiddle.net/ambiguous/Vz2SE/](http://jsfiddle.net/ambiguous/Vz2SE/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T21:27:59.950

我认为您访问它的方式还可以。`@constructor.generateNewGameId()`如果您出于某种原因不想写，也可以这样做`Game.generateNewGameId()`，但我更喜欢后者。更新：由于[@mu 太短](https://stackoverflow.com/a/11569537/581845)了，`@constructor`允许你获取实例的构造函数，它可以不同于`Game`（在子类中），因此它具有更大的灵活性；如果在这种情况下需要这种灵活性，那么一定要这样做:)

如果`generateNewGameId`不能从`Game`类外部访问该函数，则可以使用私有函数而不是类方法：

```
class @Game
  gameIdCounter = 0
  generateNewGameId = -> gameIdCounter++
  constructor: ->
    @id = generateNewGameId()
  player1: null
  player2: null

console.log (new Game).id # -> 0
console.log (new Game).id # -> 1 
```

[coffeescript.org 上的示例](http://coffeescript.org/#try:class%20%40Game%0A%20%20gameIdCounter%20%3D%200%0A%20%20generateNewGameId%20%3D%20-%3E%20gameIdCounter%2B%2B%0A%20%20constructor%3A%20-%3E%0A%20%20%20%20%40id%20%3D%20generateNewGameId%28%29%0A%20%20player1%3A%20null%0A%20%20player2%3A%20null%0A%0Aconsole.log%20%28new%20Game%29.id%20%23%20-%3E%200%0Aconsole.log%20%28new%20Game%29.id%20%23%20-%3E%201)。

类中既有私有变量，`gameIdCounter`又有私有变量。`generateNewGameId``Game`

# sql - 用于从 PostgreSQL 中的字符串中提取 IP 地址的正则表达式

> ID：11569039
> 
> 赞同：1
> 
> 时间：2012-07-19T20:46:53.840
> 
> 标签：sql, regex, postgresql, pattern-matching, ip-address

我正在处理一个`ipaddr`名为 destination 的列的表，并且列中的条目看起来像并且属于类型`varchar`

```
tunnel://169.96.88.11:80/
url://169.96.88.30
169.96.88.59:443 
```

这些都是可能的。我想编写一个正则表达式语句，当它只匹配 IP 的前三个八位字节时返回 true，仅此而已。所以，以上三个例子都匹配`169.96.88`。

您如何编写正则表达式，以便我根据特定的 IP 地址子网选择表中的行？

```
select * from ipaddr where destination like '%169.96.88%' 
```

也就是说，我要收集在`169.96.88.*`块中具有目标条目的所有记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:52:49.640

```
tunnel://\(\([[:digit:]]\{1,3\}[.]\)\{4\}\):80/ -> \2 
```

此正则表达式提取 IP，并将其返回为 \2。

根据您使用的软件，您可以使用此正则表达式进行细微更改，“->”表示“返回”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:21:48.533

```
SELECT *
FROM   ipaddr 
WHERE  destination ~ '(://|^)169\.96\.88\.[0-9]'; 
```

模式从字符串的开头或以 开头`://`。
然后跟随网络，一个点和至少一个数字。

用 PostgreSQL 9.1.4 测试。请注意，我使用现在的默认值[`standard_conforming_strings`](http://www.postgresql.org/docs/current/interactive/runtime-config-compatible.html#GUC-STANDARD-CONFORMING-STRINGS)。否则你必须写：

```
WHERE  destination ~ E'(://|^)169\\.96\\.88\\.[0-9]'; 
```

# javascript - 为什么在尝试实例化空的backbone.js 视图时出现类型错误？

> ID：11569044
> 
> 赞同：0
> 
> 时间：2012-07-19T20:47:07.007
> 
> 标签：javascript, view, backbone.js, instantiation, typeerror

我正在学习backbone.js，并编写了一些非常简单的代码。

执行以下行时出现错误：

```
var myView = new View(); 
```

这是 Firebug 中的错误：

```
TypeError: i is not a function 
```

当我注释掉该行时，没有错误（当然......也没有视图对象）。

这是代码：

```
<body>
<script type="text/javascript">

        var Model        = Backbone.Model.extend({});       
        var Collection   = Backbone.Collection.extend({});
        var View         = Backbone.View.extend({});

        var myModel      = new Model();
        var myCollection = new Collection();
        var myView       = new View();

</script>
</body> 
```

**我的问题是：**

为什么**myModel**和**myCollection**可以正确实例化，而**myView**却没有？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:01:19.383

您的 HTML 脚本引用中缺少 Underscore 或 jQuery。

Backbone 需要 Underscore.js，并且应该与 jQuery 或 Zepto 一起用于 DOM 操作。特别是对于视图实例化，您需要 jQuery 或 Zepto。

您的 HTML 文件应以正确的顺序包含这些文件：

```
<script src="/path/to/jquery.js"></script>
<script src="/path/to/underscore.js"></script>
<script src="/path/to/backbone.js"></script> 
```

# c# - 如何在 WP8 中本地化 DatePicker 和 TimePicker

> ID：11569055
> 
> 赞同：1
> 
> 时间：2012-07-19T20:47:38.500
> 
> 标签：c#, windows-phone-7, xaml, datepicker, timepicker

我正在尝试本地化与 WP7 上的工具包关联的 DatePicker 和 TimePicker，但我不确定如何访问 Header 和应用程序栏文本。我找不到任何显示完成这些任务的方法的链接。是否有任何有用的链接，或者有人知道如何完成这些链接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T05:35:32.030

1.  下载工具包最新版本（2011 年 11 月）的源代码和示例的最简单方法，该工具包默认本地化为`DatePicker`和`TimePicker`.
2.  将它作为项目引用添加到您的解决方案。

如果您拥有 2011 年 11 月之前的 Toolkit 版本，

1.  再次将其添加为解决方案中的项目参考
2.  在项目方面，您的解决方案中采用了它。添加必要的 resx 文件。您可以看到有一个默认的 Resources.resx 文件，其中包含日期选择器的英文文本。为其他语言添加必要的 resx 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-19T13:32:14.620

这很简单：参数 - 语言。Xml代码：

```
<toolkit:DatePicker Language="ru-RU" Margin="-12, 0" Value="{Binding BirthDate, Mode=TwoWay}" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-09T13:08:50.100

另一个不修改 XAML 源的替代方法是在页面加载后修改“HeaderTitle”TextBlock。

```
 /// <summary>
    /// Called from app.xaml.cs if the user navigates to the DatePickerPage
    /// </summary>
    /// <param name="page">The page.</param>
    public static void DatePickerHook(PhoneApplicationPage page)
    {
        // Somehow modify the text on the top of the page...
        LoopThroughControls(page, (ui => {
            var tb = ui as TextBlock;
            if (tb != null && tb.Name == "HeaderTitle")
            {
                tb.Text = "<<Local Translation>>";
            }
        }));
    }

    /// <summary>
    /// Applies an action to every element on a page
    /// </summary>
    /// <param name="parent">The parent.</param>
    /// <param name="modifier">The modifier.</param>
    private static void LoopThroughControls(UIElement parent, Action<UIElement> modifier)
    {
        int count = VisualTreeHelper.GetChildrenCount(parent);
        if (count > 0)
        {
            for (int i = 0; i < count; i++)
            {
                UIElement child = (UIElement)VisualTreeHelper.GetChild(parent, i);
                modifier(child);
                LoopThroughControls(child, modifier);
            }
        }
        return;
    } 
```

以下是描述 app.xaml.cs 修改的博客文章的链接：[http ://blog.dotnetframework.org/2015/11/09/localise-datepicker-in-wp8-silverlighttoolkit-using-hooks/](http://blog.dotnetframework.org/2015/11/09/localise-datepicker-in-wp8-silverlighttoolkit-using-hooks/)

# html - 发布带有表格的表格，每行有多个输入，没有 Javascript

> ID：11569057
> 
> 赞同：0
> 
> 时间：2012-07-19T20:48:02.277
> 
> 标签：html, forms

这部分是一个学术问题，但我认为它可以在没有 javascript 的情况下正确完成，并且我希望尽可能让 javascript 远离表单数据的处理。

假设我有一个名为“名称”的文本输入，以及一个包含任意行数的表。每行有两个输入，分别命名为“颜色”和“形状”。

假设文本输入填写为“Shape-Set-1”，并且有 3 行具有以下颜色和形状值：

*   “蓝色”和“方形”
*   “绿色”和“圆形”
*   “黄色”和“三角形”

当我发布时，POST 数据将如下所示：

*   名称：“Shape-Set-1”
*   颜色：“蓝色”
*   颜色：“绿色”
*   颜色：“黄色”
*   形状：“方形”
*   形状：“圆形”
*   形状：“三角形”

伟大的！所有的数据都做到了！但是我怎么确定连接了哪种颜色和哪种形状？他们总是保证以正确的顺序收集吗？（我的猜测是否定的，因为它可能取决于浏览器，除非有一个标准）。有没有办法嵌套并让行在对象中报告它们的颜色和形状输入？

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:54:06.253

您需要为每一行指定一个 id，以便输入变为 Colour1 和 Shape1、Colour2 和 Shape2 等，然后您可以在服务器端解析键，确定允许您将两者链接在一起的数字。

我不知道表单如何序列化它们的数据并传递它，如果保证输入会按顺序出现，那么你知道颜色数组和形状数组索引 0 将与同一个项目相关（我不知道这是否不过，情况确实如此，可能值得研究）。

# php - 错误：已弃用：函数 Session_register

> ID：11569060
> 
> 赞同：0
> 
> 时间：2012-07-19T20:48:07.067
> 
> 标签：php, function

> **可能重复：**
> [如何修复 session_register() DEPRECATED 问题？](https://stackoverflow.com/questions/3682615/how-to-fix-the-session-register-deprecated-problem)

我最近为一个站点移动了切换主机。该网站在前端运行良好，但是当我尝试登录时，我收到以下错误

```
Deprecated: Function session_register() is deprecated in /home/content/69/9301569/html/cls.userlogin.php on line 31

Warning: session_register() [function.session-register]: Cannot send session cookie - headers already sent by (output started at /home/content/69/9301569/html/cls.userlogin.php:31) in /home/content/69/9301569/html/cls.userlogin.php on line 31

Warning: session_register() [function.session-register]: Cannot send session cache limiter - headers already sent (output started at /home/content/69/9301569/html/cls.userlogin.php:31) in /home/content/69/9301569/html/cls.userlogin.php on line 31

Warning: Cannot modify header information - headers already sent by (output started at /home/content/69/9301569/html/cls.userlogin.php:31) in /home/content/69/9301569/html/form-login.php on line 14 
```

我没有建立网站；刚搬家，所以我很迷茫。我将如何纠正这个错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:52:56.797

它抱怨的行将包含这样的行：

```
session_register("foo"); 
```

将其替换为：

```
$_SESSION['foo'] = $foo; 
```

替换`'foo'`并`$foo`用正在注册的任何名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:05:36.577

您正在使用在新服务器的 php 版本中修改的函数。尝试在其他服务器上部署应用程序，首先使用相同版本的 PHP

# r - 在 R 中拟合对数曲线

> ID：11569068
> 
> 赞同：7
> 
> 时间：2012-07-19T20:48:49.497
> 
> 标签：r, curve-fitting, linear-regression, logarithm

如果我在 R 中有一组线性点，我可以执行以下操作来绘制这些点，为它们拟合一条线，然后显示该线：

```
x=c(61,610,1037,2074,3050,4087,5002,6100,7015)
y=c(0.401244, 0.844381, 1.18922, 1.93864, 2.76673, 3.52449, 4.21855, 5.04368, 5.80071)

plot(x,y)    
Estimate = lm(y ~ x)    
abline(Estimate) 
```

现在，如果我有一组看起来像对数曲线拟合的点更合适，如下所示：

```
x=c(61,610,1037,2074,3050,4087,5002,6100,7015)        
y=c(0.974206,1.16716,1.19879,1.28192,1.30739,1.32019,1.35494,1.36941,1.37505) 
```

我知道我可以使用以下方法对 x 值的对数进行标准回归拟合：

```
logEstimate = lm(y ~ log(x)) 
```

但是，然后我如何将 logEstimate 转换回正常缩放并根据我之前的线性曲线绘制曲线？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T21:12:21.310

嗯，我不太清楚您所说的“根据我之前的线性曲线绘制曲线”是什么意思。

```
d <- data.frame(x,y)  ## need to use data in a data.frame for predict()
logEstimate <- lm(y~log(x),data=d) 
```

以下是获取预测值的三种方法：

(1) 用途`predict`：

```
plot(x,y)
xvec <- seq(0,7000,length=101)
logpred <- predict(logEstimate,newdata=data.frame(x=xvec))
lines(xvec,logpred) 
```

(2) 提取数值系数值：

```
coef(logEstimate)
## (Intercept)      log(x) 
##  0.6183839   0.0856404 
curve(0.61838+0.08564*log(x),add=TRUE,col=2) 
```

(3) 使用`with()`魔法（您需要在参数估计名称周围加上反引号，因为它们包含括号）

```
with(as.list(coef(logEstimate)),
      curve(`(Intercept)`+`log(x)`*log(x),add=TRUE,col=4)) 
```

也许你想要的是

```
est1 <- predict(lm(y~x,data=d),newdata=data.frame(x=xvec))
plot(est1,logpred) 
```

...虽然我不知道为什么...

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-19T21:22:56.843

我也不完全确定你的意思......但我猜有点不同。我认为您想为这些点拟合两个模型，一个是线性的，一个是记录的。然后，您要绘制点以及两个模型的函数形式。这是代码：

```
x=c(61,610,1037,2074,3050,4087,5002,6100,7015)
y=c(0.974206,1.16716,1.19879,1.28192,1.30739,1.32019,1.35494,1.36941,1.37505)

Estimate = lm(y ~ x)
logEstimate = lm(y ~ log(x))

plot(x,predict(Estimate),type='l',col='blue')
lines(x,predict(logEstimate),col='red')
points(x,y) 
```

![在此处输入图像描述](../Images/f3694e6b7a74fef8f2926823f943cacb.png)

* * *

针对评论中的第二个问题，线性回归确实总是返回预测变量的线性组合，但这并不一定意味着它是一条直线。想想你的`log`转变真正意味着什么：如果你适合，

```
y = log(x) 
```

这与拟合相同

```
exp(y) = x 
```

这意味着`x`随着线性增加，然后`y`将呈指数变化，这显然不是一条“直线”。但是，如果您在对数刻度上转换 x 轴，则显示的线将是直的。

# ruby-on-rails - rails：如何将自定义 json 添加到 json 输出

> ID：11569070
> 
> 赞同：0
> 
> 时间：2012-07-19T20:48:51.497
> 
> 标签：ruby-on-rails, json

渲染 json 时添加自定义 json 输出的最简单方法是什么？我见过人们覆盖 as_json 或 to_json 但他们通常排除属性或包含关联。有没有办法包含纯文本？

在我看来：

```
def show_json
    show_id = URI.decode(params[:id])
    show_id = show_id.gsub(/\s*$/,'')
    logger.debug "\nshow json: #{show_id}\n"
    @qtls = Qtl.find_by_sql("select * from qtls where qtl_name like '%#{show_id}%' or qtl_symbol in (select qtl_symbol from obs_traits where qtl_symbol like '%#{show_id}%' or trait_name like '%#{show_id}%');")
    render :json => @qtls
end 
```

这会返回类似：

```
[{qtl: {...qtl attributes..}},{... more qtls }] 
```

我想为每个 qtl 添加一个特定的字段。最好的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:07:31.400

覆盖 as_json 或使用一些 gem 来提供许多 json 模板，例如[https://github.com/fabrik42/acts_as_api](https://github.com/fabrik42/acts_as_api)

# mysql - mySQL 具有排除优化

> ID：11569071
> 
> 赞同：0
> 
> 时间：2012-07-19T20:48:57.110
> 
> 标签：mysql, query-optimization, having

我实际上已经设法让这个工作，但想知道是否有任何 Guru 能够提供更优化的方法：

```
SELECT `cfc`.`card_face_id`
FROM `card_face_color` AS `cfc`
INNER JOIN `color` AS `c` ON c.color_id = cfc.color_id
WHERE c.c_url IN ('black', 'blue')
AND card_face_id NOT IN (
    SELECT `cfc`.`card_face_id`
    FROM `card_face_color` AS `cfc`
    INNER JOIN `color` AS `c` ON cfc.color_id = c.color_id
    WHERE c.c_url NOT IN ('black', 'blue')
)
GROUP BY `cfc`.`card_face_id`
HAVING (COUNT(DISTINCT c.c_url) = 2) 
```

本质上，我正在尝试选择所有包含黑色和蓝色的 card_faces，但没有其他颜色（每个 card_face 可能最多 5 个）。尝试使用内部连接来实现，但这慢了近 25 倍。我对我的索引很满意，我只是对 Have 子句没有经验。

**更新**

`EXPLAIN`针对查询运行会显示这一点（对格式表示歉意）。

```
id select_type table type  possible_keys key      key_len ref                   rows Extra
1  PRIMARY     c      index PRIMARY,c_url c_url    50      NULL                  10   Using where; Using index; Using temporary; Using filesort
1  PRIMARY     cfc    ref   color_id      color_id 1       site.co.uk.c.color_id 1156 Using where; Using index
2  SUBQUERY    c      range PRIMARY,c_url c_url    50      NULL                  9    Using where; Using index
2  SUBQUERY    cfc    ref   color_id      color_id 1       site.co.uk.c.color_id 1156 Using index 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:45:40.143

这是另一种方法。我首先尝试将结果集限制为只有 2 种颜色的卡片面。让我知道性能是否更好。

```
SELECT cfc2.card_face_id, COUNT(*) AS cardcount2
FROM card_face_color cfc2 
  INNER JOIN color c ON cfc2.color_id=c.color_id AND c.c_url IN ('black','blue')
  INNER JOIN (SELECT cfc.card_face_id, COUNT(*) AS cardcount
              FROM card_face_color cfc
              GROUP BY cfc.card_face_id
              HAVING cardcount=2) AS color_counter ON cfc2.card_face_id=color_counter.card_face_id
GROUP BY cfc2.card_face_id
HAVING cardcount2=2 
```

**方法 2**

另一种现成的方法：

```
SELECT card_face_id, SUM(U.counter) AS counter FROM
(
SELECT cfc2.card_face_id, 1 AS counter
FROM card_face_color cfc2 
  INNER JOIN color c ON cfc2.color_id=c.color_id AND c.c_url IN ('black','blue')

UNION ALL

SELECT cfc2.card_face_id, 100 AS counter
FROM card_face_color cfc2 
  INNER JOIN color c ON cfc2.color_id=c.color_id AND NOT c.c_url IN ('black','blue')

) AS U
GROUP BY card_face_id
HAVING counter=2 
```

**方法 3** 我不确定你有多灵活，但在这种方法中我消除了内部连接：

```
SET @blue_id = (SELECT color_id FROM color WHERE c_url='blue');
SET @black_id = (SELECT color_id FROM color WHERE c_url='black');

SELECT card_face_id, SUM(U.counter) AS counter FROM
(
SELECT cfc2.card_face_id, 1 AS counter
FROM card_face_color cfc2 
WHERE cfc2.color_id IN (@blue_id,@black_id)

UNION ALL

SELECT cfc2.card_face_id, 100 AS counter
FROM card_face_color cfc2 
WHERE cfc2.color_id NOT IN (@blue_id,@black_id)

) AS U
GROUP BY card_face_id
HAVING counter=2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:54:40.937

这是查询的几个版本

1.  这是更好还是更糟？(~30ms)
    **按 group_concat 过滤**

    ```
    SELECT `cfc`.`card_face_id`
    FROM `card_face_color` AS `cfc`
    INNER JOIN `color` AS `c` ON c.color_id = cfc.color_id
    GROUP BY `cfc`.`card_face_id`
    HAVING GROUP_CONCAT(c.c_url ORDER BY c.c_url) = 'black,blue' 
    ```

2.  这可能更好地使用索引（〜35ms）
    **好= 2和坏= 0**

    ```
    SELECT `cfc`.`card_face_id`
    FROM `card_face_color` AS `cfc`
    INNER JOIN `color` AS `c` ON c.color_id = cfc.color_id
    GROUP BY `cfc`.`card_face_id`
    HAVING
      SUM(IF(c.c_url IN ('black','blue'), 1, NULL)) = 2 AND
      SUM(IF(c.c_url IN ('black','blue'), NULL, 1)) = 0 
    ```

3.  由于第二次失败，我这次用 DISTINCT 再试一次（~34ms）
    **总计 = 2 和好 = 2**

    ```
    SELECT `cfc`.`card_face_id`
    FROM `card_face_color` AS `cfc`
    INNER JOIN `color` AS `c` ON c.color_id = cfc.color_id
    GROUP BY `cfc`.`card_face_id`
    HAVING
      COUNT(DISTINCT c.c_url) = 2 AND
      COUNT(DISTINCT IF(c.c_url IN ('black','blue'), c.c_url, NULL)) = 2 
    ```

4.  让我们再扭曲一下，
    **total = 2 and bad = 0**

    ```
    SELECT `cfc`.`card_face_id`
    FROM `card_face_color` AS `cfc`
    INNER JOIN `color` AS `c` ON c.color_id = cfc.color_id
    GROUP BY `cfc`.`card_face_id`
    HAVING
      COUNT(DISTINCT c.c_url) = 2 AND
      COUNT(IF(c.c_url IN ('black','blue'), NULL, c.c_url)) = 0 
    ```

5.  只是为了测试所有组合，
    **好 = 2 和坏 = 0**

    ```
    SELECT `cfc`.`card_face_id`
    FROM `card_face_color` AS `cfc`
    INNER JOIN `color` AS `c` ON c.color_id = cfc.color_id
    GROUP BY `cfc`.`card_face_id`
    HAVING
      COUNT(DISTINCT IF(c.c_url IN ('black','blue'), c.c_url, NULL)) = 2 AND
      COUNT(IF(c.c_url IN ('black','blue'), NULL, c.c_url)) = 0 
    ```

# android - 将 JSONArray 解析为 TextView

> ID：11569072
> 
> 赞同：0
> 
> 时间：2012-07-19T20:49:07.333
> 
> 标签：android, arrays

有人可以帮助指导我如何将 JSONArray 解析为 TextViews 吗？到目前为止，每次我解析它时，它只显示最后的结果，而不是一切。

到目前为止，我有：

```
 try {
            standby_position = json.getString("standby_position");
            zone_name = json.getString("zone_name");
            zone_no = json.getString("zone_no");
            status = json.getString("status");

            JSONArray standby_list = json.getJSONArray("standby_list");

            for (int i1 = 0; i1 < standby_list.length(); i1++) {
                JSONObject c = standby_list.getJSONObject(i1);

            DRIVER = c.getString(driver);
            SINCE = c.getString(since);
            WAITING = c.getString(waiting);
            GPS_DATA = c.getString(gps_data);

            }

        } catch (JSONException e1) {
            // TODO Auto-generated catch block
            e1.printStackTrace();
        } 
```

我试图做：

```
 TextView information = (TextView) findViewById(R.id.information);
  information.setText ( DRIVER + SINCE + WAITING ); 
```

这是我要解析的内容：

```
 {
"driver": "819",
"gps_data": "1",
"last_geocode": "",
"lastLatitudeUpdate": "12/31/1969 5:00:00 PM",
"standby_position": "1",
"zone_name": "STK",
"zone_no": "STK",
"status": "Your are checked-in and currently #1 STK. (as of: 7/19/2012 1:50:02 PM)",
"standby_list": [
    {
        "driver": "291",
        "since": "12:33:00 PM",
        "waiting": "77",
        "gps_data": "0"
    },
    {
        "driver": "103",
        "since": "12:49:21 PM",
        "waiting": "61",
        "gps_data": "0"
    },
    {
        "driver": "287",
        "since": "12:51:00 PM",
        "waiting": "59",
        "gps_data": "0"
    },
    {
        "driver": "271",
        "since": "1:22:00 PM",
        "waiting": "28",
        "gps_data": "0"
    },
    {
        "driver": "819",
        "since": "8:58:36 AM",
        "waiting": "292",
        "gps_data": "1"
    }
]
 } 
```

当我这样做时，将显示唯一的最后一个解析 Json。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:55:07.813

您在一个循环中获取值，但您只为一个区域提供食物。当然，最后一个区域是唯一要显示的区域。如果您只需要在有限的时间内查看值，请尝试对列表的每个元素或“Toast.makeText(...)”使用文本视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:55:21.597

你总是重写这个变量。这就是为什么你总是只有最后一个 json

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T20:57:00.213

最后一个 JSON 是什么意思？

您指的是 JSONArray 中名为“standby_list”的最后一个对象吗？

如果是这样，那是因为您只处理最后一个。相反，您应该使用某种集合并在其上调用 Add 。

例如

```
class MyObject {
    public String driver, since, waiting, gps;
}

List<MyObject> list = new ArrayList<MyObject>();

for (int i1 = 0; i1 < standby_list.length(); i1++) {
    JSONObject c = standby_list.getJSONObject(i1);
    MyObject myContainer = new MyObject();   

    myContainer.driver = c.getString(driver);
    myContainer.since = c.getString(since);
    myContainer.waiting = c.getString(waiting);
    myContainer.gps = c.getString(gps_data);
    list.add(myContainer);
} 
```

# java - 在 JList 失去焦点后保持 JList 选择？

> ID：11569076
> 
> 赞同：4
> 
> 时间：2012-07-19T20:49:22.810
> 
> 标签：java, swing, jbutton, jlist, listselectionlistener

我正在尝试使用 JList 和按钮创建一个表单我想要做的是从 JList 中选择一个项目，然后按下按钮以执行取决于选择的操作。但是，一旦单击按钮，JList 就会失去焦点，选择消失，从而使按钮无法确定在 JList 中选择了哪个元素。

有针对这个的解决方法吗？提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:01:16.483

*   我看不到 Oracle JList 教程中的示例有任何问题

*   看看 ListSelectionListener

*   也许仔细使用 SelectionModes

*   你能描述一下你的目标是什么吗

代码示例

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.*;

public class ListDemo extends JPanel implements ListSelectionListener {

    private JList list;
    private DefaultListModel listModel;
    private static final String hireString = "Hire";
    private static final String fireString = "Fire";
    private JButton fireButton;
    private JTextField employeeName;

    public ListDemo() {
        super(new BorderLayout());
        listModel = new DefaultListModel();
        listModel.addElement("Jane Doe");
        listModel.addElement("John Smith");
        listModel.addElement("Kathy Green");
        list = new JList(listModel);
        list.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        list.setSelectedIndex(0);
        list.addListSelectionListener(this);
        list.setVisibleRowCount(5);
        JScrollPane listScrollPane = new JScrollPane(list);
        JButton hireButton = new JButton(hireString);
        HireListener hireListener = new HireListener(hireButton);
        hireButton.setActionCommand(hireString);
        hireButton.addActionListener(hireListener);
        hireButton.setEnabled(false);
        fireButton = new JButton(fireString);
        fireButton.setActionCommand(fireString);
        fireButton.addActionListener(new FireListener());
        employeeName = new JTextField(10);
        employeeName.addActionListener(hireListener);
        employeeName.getDocument().addDocumentListener(hireListener);
        String name = listModel.getElementAt(list.getSelectedIndex()).toString();
        JPanel buttonPane = new JPanel();
        buttonPane.setLayout(new BoxLayout(buttonPane, BoxLayout.LINE_AXIS));
        buttonPane.add(fireButton);
        buttonPane.add(Box.createHorizontalStrut(5));
        buttonPane.add(new JSeparator(SwingConstants.VERTICAL));
        buttonPane.add(Box.createHorizontalStrut(5));
        buttonPane.add(employeeName);
        buttonPane.add(hireButton);
        buttonPane.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));
        add(listScrollPane, BorderLayout.CENTER);
        add(buttonPane, BorderLayout.PAGE_END);
    }

    class FireListener implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            int index = list.getSelectedIndex();
            listModel.remove(index);
            int size = listModel.getSize();
            if (size == 0) { //Nobody's left, disable firing.
                fireButton.setEnabled(false);
            } else { //Select an index.
                if (index == listModel.getSize()) {
                    index--;
                }
                list.setSelectedIndex(index);
                list.ensureIndexIsVisible(index);
            }
        }
    }

    class HireListener implements ActionListener, DocumentListener {

        private boolean alreadyEnabled = false;
        private JButton button;

        public HireListener(JButton button) {
            this.button = button;
        }

        public void actionPerformed(ActionEvent e) {
            String name = employeeName.getText();
            if (name.equals("") || alreadyInList(name)) {
                Toolkit.getDefaultToolkit().beep();
                employeeName.requestFocusInWindow();
                employeeName.selectAll();
                return;
            }
            int index = list.getSelectedIndex(); //get selected index
            if (index == -1) { //no selection, so insert at beginning
                index = 0;
            } else {           //add after the selected item
                index++;
            }
            listModel.insertElementAt(employeeName.getText(), index);
            //listModel.addElement(employeeName.getText());
            employeeName.requestFocusInWindow();
            employeeName.setText("");
            list.setSelectedIndex(index);
            list.ensureIndexIsVisible(index);
        }

        protected boolean alreadyInList(String name) {
            return listModel.contains(name);
        }

        public void insertUpdate(DocumentEvent e) {
            enableButton();
        }

        public void removeUpdate(DocumentEvent e) {
            handleEmptyTextField(e);
        }

        public void changedUpdate(DocumentEvent e) {
            if (!handleEmptyTextField(e)) {
                enableButton();
            }
        }

        private void enableButton() {
            if (!alreadyEnabled) {
                button.setEnabled(true);
            }
        }

        private boolean handleEmptyTextField(DocumentEvent e) {
            if (e.getDocument().getLength() <= 0) {
                button.setEnabled(false);
                alreadyEnabled = false;
                return true;
            }
            return false;
        }
    }

    public void valueChanged(ListSelectionEvent e) {
        if (e.getValueIsAdjusting() == false) {

            if (list.getSelectedIndex() == -1) {
                fireButton.setEnabled(false);
            } else {
                fireButton.setEnabled(true);
            }
        }
    }

    private static void createAndShowGUI() {
        JFrame frame = new JFrame("ListDemo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JComponent newContentPane = new ListDemo();
        newContentPane.setOpaque(true); //content panes must be opaque
        frame.setContentPane(newContentPane);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {

            public void run() {
                createAndShowGUI();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T20:52:40.700

只需在每次进行选择时更新一个字段。您可以通过在您的 JList 上添加一个侦听器来做到这一点。

```
private class selectListener extends MouseAdapter {

    public void mouseClicked(MouseEvent e) {
        if (SwingUtilities.isLeftMouseButton(e)) { 
            currentSelected = list.getSelectedIndex();
        }
    }
} 
```

然后在按下按钮时使用该字段。

# java - 仅当包含在“testng 套件”中时，同一类中的依赖方法才会乱序运行；运行类独立尊重依赖关系

> ID：11569080
> 
> 赞同：0
> 
> 时间：2012-07-19T20:49:41.040
> 
> 标签：java, webdriver, selenium-webdriver, testng

我有一个使用 TestNG 注释的具有依赖方法的类

```
dependsOnMethods 
```

如果我只是从包中将其作为 TestNG 测试运行，则该测试 100% 的时间运行良好。

当我将测试包含在 TestNG Suite 中时，这些方法会出现乱序。是的，我正在使用：

```
 <test name="Test" preserve-order="true"> 
```

在我的 .xml 文件中。

套件中的所有其他测试都尊重方法排序并毫无问题地运行。是否有任何已知信息说明为什么会发生这种情况？

测试用例代码：

```
@Test(groups={ "Administration"})
public class RoleCrudTest extends AbstractIntegrationTest
{
protected static SeleniumActionHelper action;

    @Test
    public void inactiveRole() throws Exception
    {
        SeleniumHelper helper = new SeleniumHelper();
        action = new SeleniumActionHelper(driver);

        helper.login();

        String roleUrl = navigateToUrl("role/roles.xhtml");
        driver.get(roleUrl);

        assertEquals("Role:", findElementBySelector("span.portletButtonHeader").getText());

        WebElement roleName = findElementById("roleName");
        assertFalse(roleName.isEnabled());

        WebElement deptId = findElementById("deptid");
        assertFalse(deptId.isEnabled());
    }

    @Test(dependsOnMethods = "inactiveRole")
    public void createRole() throws Exception
    {
        WebElement addButton = findElementById("add");
        addButton.click();

        waitUntilAjaxRequestCompletes();

        WebElement roleName = findElementById("roleName");
        roleName.click();
        roleName.sendKeys("AAAAAAAA");

        WebElement deptId = findElementByXpath("(//button[@type='button'])[3]");
        deptId.click();

        WebElement dept = findElementByXpath("//div[@id='department_panel']/ul/li[2]");
        dept.click();

        WebElement checkbox = findElementByXpath("//li[@id='privileges:1']/div/span/div/div");
        checkbox.click();

        Thread.sleep(1000);

        WebElement save = findElementById("save");
        save.click();

        assertEquals("Role saved successfully", findElementBySelector("div.ui-growl-message > p").getText());
    }

    @Test(dependsOnMethods = "createRole")
    public void editUndo() throws Exception
    {
        Thread.sleep(1000);

        WebElement tableSort = findElementByXpath("//th[@id='tableSection:rolesListWrapped:j_idt85']/div/span[2]");
        tableSort.click();

        Thread.sleep(1000);

        WebElement createdRole = findElementByXpath("//tbody[@id='tableSection:rolesListWrapped_data']/tr[1]/td/div");
        createdRole.click();

        Thread.sleep(1000);

        WebElement roleName = findElementById("roleName");
        roleName.click();
        roleName.clear();
        roleName.sendKeys("edited");

        WebElement deptId = findElementByXpath("(//button[@type='button'])[3]");
        deptId.click();

        WebElement dept = findElementByXpath("//div[@id='department_panel']/ul/li[3]");
        dept.click();

        WebElement checkbox = findElementByXpath("//li[@id='privileges:1']/div/span/div/div/span");
        checkbox.click();

        WebElement checkbox2 = findElementByXpath("//li[@id='privileges:0']/div/span/div/div");
        checkbox2.click();

        Thread.sleep(1000);

        WebElement undo = findElementById("cancel");
        undo.click();

        String text = findElementById("roleName").getAttribute("value");
        String oldtext = "AAAAAAAA";

        assertTrue(text.equals(oldtext));
    }

    @Test(dependsOnMethods = "editUndo")
    public void editRole() throws Exception
    {
        Thread.sleep(1000);

        WebElement createdRole = findElementByXpath("//tbody[@id='tableSection:rolesListWrapped_data']/tr[1]/td/div");
        createdRole.click();

        Thread.sleep(1000);

        WebElement roleName = findElementById("roleName");
        roleName.click();
        roleName.clear();
        roleName.sendKeys("AAAAAAAAedited");

        WebElement deptId = findElementByXpath("(//button[@type='button'])[3]");
        deptId.click();

        WebElement dept = findElementByXpath("//div[@id='department_panel']/ul/li[3]");
        dept.click();

        WebElement checkbox = findElementByXpath("//li[@id='privileges:1']/div/span/div/div/span");
        checkbox.click();

        WebElement checkbox2 = findElementByXpath("//li[@id='privileges:0']/div/span/div/div");
        checkbox2.click();

        Thread.sleep(1000);

        WebElement save = findElementById("save");
        save.click();

        assertEquals("Role saved successfully", findElementBySelector("div.ui-growl-message > p").getText());
    }

    @Test(dependsOnMethods = "editRole")
    public void deleteRole() throws Exception
    {
        Thread.sleep(1000);

        WebElement deleteButton = findElementById("tableSection:delete");
        deleteButton.click();

        WebElement deleteConfirm = findElementById("confirmDelete:yes");
        deleteConfirm.click();

        Thread.sleep(500);

        assertEquals("Role deleted successfully", findElementBySelector("div.ui-growl-message > p").getText());

        waitUntilAjaxRequestCompletes();
    } 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T04:16:58.433

`dependsOnMethods`是您想要的，而不是`preserve-order`（实际上，`dependsOnGroups`建议使用`dependsOnMethods`，但两者都可以）。

如果您有显示问题的小测试用例，请发布

# database - Oracle 触发器无效

> ID：11569081
> 
> 赞同：2
> 
> 时间：2012-07-19T20:49:42.840
> 
> 标签：database, oracle, triggers, plsql

我是 SQL 新手，我正在尝试创建一个将插入审计表的触发器。

```
create or replace trigger late_ship_insert
  after insert on suborder
  for each row
declare
  employee int;
begin
  select emp_id 
    into employee
    from handles
   where order_no = :new.order_no;
  if :new.actual_ship_date > :new.req_ship_date then
    insert into ship_audit
      values (employee, :new.order_no, :new.suborder_no, :new.req_ship_date, :new.actual_ship_date);
end; 
```

错误：

```
Warning: execution completed with warning
trigger late_ship_insert Compiled. 
```

但是一旦我尝试插入语句，它就会告诉我触发器没有工作它来删除它。

```
Error starting at line 1 in command:
insert into suborder 
    values  ( 8, 3, '10-jun-2012', '12-jul-2012', 'CVS', 3) 
Error at Command Line:1 Column:12
Error report:
SQL Error: ORA-04098: trigger 'COMPANY.LATE_SHIP_INSERT' is invalid and failed re-validation
04098\. 00000 -  "trigger '%s.%s' is invalid and failed re-validation"
*Cause:    A trigger was attempted to be retrieved for execution and was
           found to be invalid.  This also means that compilation/authorization
           failed for the trigger.
*Action:   Options are to resolve the compilation/authorization errors,
           disable the trigger, or drop the trigger. 
```

任何想法是什么原因造成的，任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T20:58:11.600

格式化代码时出现的错误是您的`IF`语句缺少`END IF`

```
create or replace trigger late_ship_insert
  after insert on suborder
  for each row
declare
  employee int;
begin
  select emp_id 
    into employee
    from handles
   where order_no = :new.order_no;
  if :new.actual_ship_date > :new.req_ship_date then
    insert into ship_audit
      values (employee, :new.order_no, :new.suborder_no, :new.req_ship_date, :new.actual_ship_date);
  end if;
end; 
```

一般来说，您应该始终在语句中列出目标表的列，`INSERT`而不是依赖于您的`INSERT`语句为每一列指定一个值并以正确的顺序指定它们的事实。这将使您的代码更加健壮，因为例如当有人向表中添加其他列时它不会变得无效。看起来像这样（我猜测`ship_audit`表中列的名称）

```
create or replace trigger late_ship_insert
  after insert on suborder
  for each row
declare
  employee int;
begin
  select emp_id 
    into employee
    from handles
   where order_no = :new.order_no;
  if :new.actual_ship_date > :new.req_ship_date then
    insert into ship_audit( emp_id, order_no, suborder_no, req_ship_date, actual_ship_date )
      values (employee, :new.order_no, :new.suborder_no, :new.req_ship_date, :new.actual_ship_date);
  end if;
end; 
```

# jquery - 选择性停止传播jQuery

> ID：11569082
> 
> 赞同：2
> 
> 时间：2012-07-19T20:49:48.597
> 
> 标签：jquery, stoppropagation

Javascript代码：

```
$(".div1").click(function(event){
    event.stopPropagation();
    $(".div1 div").slideToggle();
});

$(".div2").click(function(event){
    event.stopPropagation ();
    $(".div2 div").slideToggle();
});

$(document).click(function(event){
    $(".div1 div,.div2 div").slideUp();
}); 
```

假设我单击并向`.div1`下`.div1 div`滑动。然后我单击`.div2`但`event.stopPropagation`执行时`.div1 div`不会向上滑动。所以我该怎么做？我不想放这段代码`$(".div1 div").slideUp();`，因为这样的 div 太多时没有意义

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:59:09.003

永远不要使用`Event.stopPropagation()`. 任何应用程序的所有层都应该始终能够在任何时候记录发生的事件。

而是使用`event.target`and traverse with`.closest()`来实现相同的目的。

以下将处理无限数量的 DIV，因此您无需重写代码。（PS：只需在`.box`您的父元素中添加一个以使一切更简单）

```
$(".box").on("click", function(event){
  const $div = $(this).find('div');
  $('.box > div').not($div).slideUp();
  $div.slideToggle();
});

$(document).on("click", function(event){
  if (!$(event.target).closest(".box").length) {
    $(".box > div:visible").slideUp();
  }
});
```

```
/*QuickReset*/ * {margin:0; box-sizing:border-box;}

.box{
  background:#eee;
  width:160px;
  padding:10px 0;
  margin:10px;
}
.box h2{
  cursor:pointer;
}
.box div{
  display:none;
  background:#aaa;
  color:#cf5;
}
```

```
Click on 'body' to close opened DIVs

<div class="div1 box">
  <h2>DIV 1</h2>
  <div>Lorem <br>Ipsum<br>....</div>
</div>

<div class="div2 box">
  <h2>DIV 2</h2>
  <div>Lorem <br>Ipsum<br>....</div>
</div>

<div class="div3 box">
  <h2>DIV 3</h2>
  <div>Lorem <br>Ipsum<br>....</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
```

# objective-c - 在 Obj-C 中用用户名定义全局常量

> ID：11569084
> 
> 赞同：0
> 
> 时间：2012-07-19T20:50:03.193
> 
> 标签：objective-c, cocoa

我想定义一个包含任何人的用户名的常量文件路径（例如`/Users/username/Desktop`......在我的具体情况下，它是我创建的目录`/var/spool/FolderICreate/username`）。

声明这个常量以便我的其他类可以识别它的最佳方法是什么？我目前有一个 globals.h 文件来包含需要查看全局变量的类，但我不确定如何设置该值。 `#define`显然需要一个硬编码的字符串文字，我不确定我是否可以或如何使用`extern const NSString*`. 我觉得这应该不难，但我不知所措。

- 编辑 -

正如人们正确指出的那样，我的代码是不必要的，因为我可以使用`NSUserName`等获取用户名，因此我将其删除。但我认为人们错过了我的问题的重点。我可以看到有多种方法可以获取我想要的路径名——如何将其声明为常量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:09:17.037

正如凯林指出的那样，对于您修改后的问题，您不需要一个常数。C 中的常量是在编译时定义的，您不知道编译时的值是什么。

你不想要这个问题的变量。你想要一个静态函数。Foundation 提供了许多类似你想要的东西的东西。如果您想要其他东西，请制作自己的静态函数`MYDirectoryForStuff()`。

不要创建非常量全局变量。那就是疯狂。然后，您必须在使用它们之前验证它们是否已初始化，这会导致各种细微的错误。如果您使用静态函数，那么它可以很容易地自初始化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T20:56:22.660

在重新实现 Foundation 框架中已经提供的一堆功能之前，请查看[NSPathUtilities 。](http://cocoadev.com/wiki/NSPathUtilities)你会在那里找到一堆专门针对你想要做的事情的方法。

要回答您实际提出的问题，没有直接的方法将变量声明为常量，然后在运行时更改其值……这违背了告诉编译器它是常量的目的。只需将头文件中的变量声明为 an`extern NSString *`并且只设置一次。:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T20:57:37.837

您永远不应该对用户的主文件夹可能在哪里做出任何假设。

检索当前用户主文件夹路径的正确方法是

`NSHomeDirectory()`

如果您希望访问用户主文件夹的标准子文件夹之一，也不要对它们的位置做出任何假设，而是使用

`NSSearchPathForDirectoriesInDomain()`

检索它们。例如，要获取文档文件夹：

```
NSArray *searchPaths = NSSearchPathForDirectoriesInDomain(
    NSDocumentDirectory, 
    NSUserDomainMask, 
    YES
);
NSLog(@"The documents folder is at %@", [searchPaths objectAtIndex:0]); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T20:55:31.293

Foundation 框架有一个功能：[`NSUserName()`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Functions/Reference/reference.html).

# javascript - 找不到变量 javascript 错误

> ID：11569085
> 
> 赞同：-3
> 
> 时间：2012-07-19T20:50:08.020
> 
> 标签：javascript

所以我试图运行一个幻灯片演示工具，下面的代码是假设初始化幻灯片，但我收到一个错误，类似于“未捕获的参考错误：未定义显示”，我不明白这是因为代码只需启动幻灯片。这是代码：

```
Reveal.initialize({
    // Display controls in the bottom  right corner
    controls: true,
    // Display a presentation progress bar
    progress: false,
    // Click above progress bar for quick  navigation - only works if progress is true
    progressNavigation: true,
    // If true; each slide will be pushed  to the browser history
    history: false,
    // Flags if mouse wheel navigation  should be enabled
    mouseWheel: true,
    // Apply a 3D roll to links on hover
    rollingLinks: true,
    // UI style
    theme: query.theme || 'default', //  default/neon
    // Transition style
    transition: query.transition || 'concave' // default/cube/page/concave/linear(2d)
}); 
```

等待启蒙。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:55:43.047

这在头脑中

```
 <link rel="stylesheet" href="reveal.css">

               /* jQuery needs to be attached */
               <script src="jquery.min.js" type="text/javascript"></script>

               /* Then just attach the Reveal plugin */
               <script src="jquery.reveal.js" type="text/javascript"></script> 
```

显然，您必须下载其中的每一个并将它们放入您的项目中 - 在网站上有一个说下载的链接，这就是您获得它的地方

# mysql - 如何使用 concat() 在单个 mysql 更新中追加到多个列

> ID：11569086
> 
> 赞同：0
> 
> 时间：2012-07-19T20:50:09.457
> 
> 标签：mysql, concat, multiple-columns

我无法弄清楚具有多个连接的 Mysql 更新的语法。我希望能够将一个字符串附加到存储在数据库中的字符串的末尾，但同时对多个列执行此操作。我可以一次做一列就好了

```
UPDATE `table1`.`column1` SET `category1` = CONCAT(category1,'$value[0]',) WHERE `id`='$id'; 
```

但是，当我尝试对同一个表中的多个列执行此操作时，会出现语法错误。

```
UPDATE `table1`.`column1`
SET `category1` = CONCAT(category1,'5'),
    `category2` = CONCAT(category2,'5'),
    `category3` = CONCAT(category3,'5'),
    `category4` = CONCAT(category4,'5'),
    `category5` = CONCAT(category5,'5'),
    `comments` = CONCAT(comments, 'jfsaklfsad')
WHERE `for_student_id`='46'; 
```

> “您的 SQL 语法有错误；”

我找不到分隔每个 concat 的语法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T20:57:11.527

根据 MySQL 文档，[`UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/update.html)不支持这种语法。您必须在 SET 之前引用表名，不包括列：

```
UPDATE `table1`
SET `category1` = CONCAT(category1,'5'),
    `category2` = CONCAT(category2,'5'),
    `category3` = CONCAT(category3,'5'),
    `category4` = CONCAT(category4,'5'),
    `category5` = CONCAT(category5,'5'),
    `comments`  = CONCAT(comments, 'jfsaklfsad')
WHERE `for_student_id`='46'; 
```

# android - ICS 上的 Android PorterDuffXfermode

> ID：11569089
> 
> 赞同：3
> 
> 时间：2012-07-19T20:50:18.800
> 
> 标签：android, android-4.0-ice-cream-sandwich, paint

有一些代码在 Android 2.2 上完美运行，但在 Android 4 中只产生黑色视图。那就是 onDraw 方法：

```
//Object initialization
Paint paint=new Paint();
PorterDuffXfermode exclude=new PorterDuffXfermode(PorterDuff.Mode.SRC_OUT);

paint.setAntiAlias(true);
paint.setDither(true);

//The dimensions are OK and they are at the center of the screen
canvas.drawBitmap(mask, screenWidth / 2 - pixelsToSp(100), screenHeight / 2 - pixelsToSp(100), paint);

paint.setXfermode(exclude);
//PS:targetRect is a portion of screen
canvas.drawBitmap(source, null, targetRect, p);
paint.setXfermode(null); 
```

PS：遮罩和聚光灯是两个位图。

没有设置 Xfermode 来绘制两个位图（对于我的范围不正确，但绘制在正确的位置和正确的大小）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T21:11:21.440

您需要禁用该特定的硬件加速`View`。有关更多详细信息，以及有关如何有选择地禁用硬件加速的信息，请参阅[硬件加速 - 不支持的绘图操作部分。](http://developer.android.com/guide/topics/graphics/hardware-accel.html#unsupported)例如：

```
myView.setLayerType(View.LAYER_TYPE_SOFTWARE, null); 
```

# jquery - 如何将 JsTree 与现有的数据库和 MVC 3 一起使用？

> ID：11569090
> 
> 赞同：-2
> 
> 时间：2012-07-19T20:50:18.827
> 
> 标签：jquery, sql-server, asp.net-mvc-3, model, jstree

我正在尝试使用现有数据库创建分层树。我浏览了 JsTree 文档，但我不明白如何将它与现有数据库一起使用。文档指出 jsTree 可以同时获取 html_data 和 Json_data 但我不明白如何使用现有数据库检索 Json 数据或 Html 数据。我发现的所有教程对现有的 MS SQL DB 没有任何意义。我需要一些帮助......不好，下面我已经包含了我正在使用的模型。我只需要视图和控制器方面的帮助，感谢您的帮助！

**现实模型**

```
//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Collections.Generic;

namespace DBFirstMVC.Models
{
    public partial class realistic
    {
        public string CAF_ID { get; set; }
        public string NDE_LEAD_DIRECTOR { get; set; }
        public string NDE_LEAD_MANAGER { get; set; }
        public string NDE_CC_DIRECTOR { get; set; }
        public string NDE_CC_MANAGER { get; set; }
        public Nullable<int> CC { get; set; }
        public string INVESTMENT_AREA { get; set; }
        public string MAJOR_PROGRAM { get; set; }
        public string DIVISION { get; set; }
        public string CLARITY_ID { get; set; }
        public string SPA { get; set; }
        public string PA { get; set; }
        public string PROJECT_NAME_ORIG { get; set; }
        public string PROJECT_NAME { get; set; }
        public string HIA { get; set; }
        public string HMP { get; set; }
        public string ERICSSON_IMPACT { get; set; }
        public string RESOURCE_MGR { get; set; }
        public string RESOURCE_TYPE { get; set; }
        public string RESOURCE { get; set; }
        public string PRIMARY_VENDOR { get; set; }
        public string DESCRIPTION { get; set; }
        public Nullable<int> CONFIDENCE_1Q { get; set; }
        public Nullable<int> CONFIDENCE_2Q { get; set; }
        public Nullable<int> CONFIDENCE_3Q { get; set; }
        public Nullable<int> CONFIDENCE_4Q { get; set; }
        public Nullable<System.DateTime> ACCOUNTING_PERIOD { get; set; }
        public Nullable<decimal> VALUE { get; set; }
        public int REALISTIC_PK { get; set; }
    }

} 
```

我需要处理的主要列是（按层次结构）INVESTMENT_AREA、MAJOR_PROGRAM、PROJECT_NAME。我还需要 INVESTMENT_AREA 和 MAJOR_PROGRAM 是不同的，这样我们就不会重复现有的区域或程序。

该站点的目标是让管理人员可以快速查看或折叠某些区域。我认为使用 jsTree 会是答案，但如果你有更好的选择，我会全力以赴！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:36:24.137

您应该将现有模型转换为 JSON。以下链接可能会对您有所帮助。 [1、2、3](https://stackoverflow.com/editing-help#comment-formatting) _ [_](http://json.codeplex.com/) _ [_](http://weblogs.asp.net/thangchung/archive/2010/08/26/customizing-the-converter-for-json-net.aspx)

# c# - 网格视图的问题

> ID：11569092
> 
> 赞同：0
> 
> 时间：2012-07-19T20:50:36.477
> 
> 标签：c#, asp.net, gridview

我正在使用模板来创建我的网格视图。I have have basically created a check box when once select creates a session variable and I then redirect the user to a separate page. 问题是事件没有触发创建包装器。

事件：

```
void cmd1_Click(object sender, EventArgs e)
    {

        Button txtdata = (Button)sender;

        inventoryBLL inv = new inventoryBLL();

        GridViewRow gvr = (GridViewRow)txtdata.NamingContainer;

        Label myControl = new Label();

        TableCell tc = gvr.Cells[0];
        // where GridView1 is the id of your GridView and indexOfCell is your index
        foreach (Control c in tc.Controls)
        {
            if (c is Label)
            {
                myControl = (Label)c;
            }
        }
        Label myControl1 = new Label();

        List<string> shipmentnames = new List<string>();
        List<string> asinlist = new List<string>();
        List<string> fnskulist = new List<string>();
        List<string> productlist = new List<string>();
        shipmentnames.Add(inv.shipmentname(_ShipmentID));
        asinlist.Add(myControl.Text);
        asinwrapper asin1 = new asinwrapper(asinlist, fnskulist, productlist, 0);
        asinwrapper.CreateSessionWrapper(asin1);
        ShipmentWrapper.CreateSessionWrapper(new ShipmentWrapper(shipmentnames));

    } 
```

我创建复选框的代码：

```
 CheckBox cmd1 = new CheckBox();                           

                        cmd1.Text = "Change";

                        cmd1.CheckedChanged += new EventHandler(cmd1_Click);

                        cmd1.AutoPostBack = true;

                        container.Controls.Add(cmd1); 
```

调用模板的代码

```
 bfield.HeaderTemplate = new GridViewTemplateShipmentItems(ListItemType.Header, "Change", FieldType.Label, ddlShipments.SelectedValue.ToString());

            bfield.ItemTemplate = new GridViewTemplateShipmentItems(ListItemType.Item, "Change", FieldType.ButtonAdd, ddlShipments.SelectedValue.ToString());

            grvList.Columns.Add(bfield);

            bfield = new TemplateField(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:55:43.710

好的，所以如果我理解正确，您在 Gridview 的一行中嵌入了复选框，对吗？

如果是这样，您必须使用 gridview 选定的行事件，（复选框事件现在被隐藏并且不会按预期运行）接下来找到复选框确定是否选中复选框重定向用户。

如果您愿意，我可以为您提供更精确的语法。

# java - 没有 JSF 的 Facelets

> ID：11569097
> 
> 赞同：7
> 
> 时间：2012-07-19T20:50:54.943
> 
> 标签：java, jsp, jsf, servlets, facelets

我正在学习 Java 语言并希望编写非常小的 Web 应用程序，因为 Facelets 似乎是 JSP 的替代品，而 JSF 似乎对于小型 Web 应用程序来说太过分了，我可以只学习 Facelets 并在没有整个 JSF 堆栈的情况下使用它吗? 还是我应该只为这个小型 Web 应用程序使用 JSP？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T15:02:15.803

它*可以*在没有 JSF 的情况下使用。只需在 in`FacesServlet`的 URL 模式**上**映射而不声明`*.xhtml``web.xml`

 **```
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html" 
```

在任何 Facelet 模板中。声明它们实际上并没有什么害处，但这样你就不会“意外”使用它们。您也可以在其中编写纯 HTML 并将表单提交到纯 servlet 并将 servlet 转发/重定向到 Facelet。

您只需要记住，使用 servlet 您最终会获得更多样板代码来收集请求参数、转换/验证它们、维护和更新模型值、调用业务操作，而所有这些重复的样板代码都是不必要的具有完全值得的 JSF 托管 bean。

此外，您不能将 Facelets 与基于请求的 MVC 框架一起使用，这些框架只有 JSP 标签库可用，如 Struts、Spring MVC 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T14:58:48.120

Facelets 是为 JSF 的需要而开发的，因此依赖于 JSF。如果您需要 JSP 模板，只需使用 <@import> 或更高级的库作为[Apache Tiles](http://tiles.apache.org/)。**

# html - 如何为打印的 HTML 文档的每一页添加样板页眉和页脚？

> ID：11569102
> 
> 赞同：1
> 
> 时间：2012-07-19T20:51:26.883
> 
> 标签：html, css, printing

我正在编写一个脚本来自动将纯文本测试文档转换为具有适当列宽、步数等的 HTML 表格。每个页面都会有一个大而长的表格的一部分。我还需要在每一页上都有一个页眉和页脚，以遵守该领域的 FDA 规定——它有关于版权、页码、部件号等的简单信息。

我注意到一些用于此任务的规定 CSS/HTML 工具似乎不起作用。

1）`@page`具有边距的规则和将内容放入这些边距的能力可以很好地解决这个问题，但我认为它从未实现过。

2）关于这个问题的许多建议答案：

[如何为 Web 文档的每个打印页面添加页眉和页脚（不受浏览器限制）？](https://stackoverflow.com/questions/5492677/how-to-add-a-header-and-footer-to-each-printed-page-of-a-web-document-without-b)

[有没有办法在每一页上打印网页页眉/页脚？](https://stackoverflow.com/questions/1722437/is-there-a-way-to-get-a-web-page-header-footer-printed-on-every-page)最终得到以下组合：页脚/页眉呈现在文本之上，或者以某种方式破坏了`page-break-inside`正文的呈现，因此每页上呈现半行。

是否仍然（鉴于答案和我尝试使用它们）不可能以干净的方式做到这一点？还是根本没有？我也不介意我必须使用什么浏览器才能正确打印它们。

# android - OpenGLES2.0 android 设备是否保证支持模板缓冲区？

> ID：11569106
> 
> 赞同：2
> 
> 时间：2012-07-19T20:51:53.083
> 
> 标签：android, opengl-es, opengl-es-2.0

OpenGLES2.0 android 设备是否保证至少支持一定数量（>0）的模板缓冲区位？

我看到了混杂的消息。规范中提到了模板测试，手册页中列出了各种模板功能，所以我认为这意味着它是核心 api 的一部分。

我还看到几种模板格式`GL_OES_STENCIL[148]`被列为扩展，所以我不确定这是否意味着声称“支持”OpenGLES2.0 的手机需要支持模板缓冲区，或者它们是否是可选扩展？

我还在一些地方读到一些安卓手机不支持模板缓冲区，尽管我没有看到他们指的是什么版本的 OpenGLES。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-20T08:15:42.603

来自[OpenGL ES 2.0 规范](http://www.khronos.org/registry/gles/specs/2.0/es_cm_spec_2.0.24.pdf)：

> **4.1 分片操作**
> 
> 支持所有 OpenGL 2.0 每个片段的操作，除了遮挡查询、逻辑操作、alpha 测试和颜色索引相关操作。支持深度和模板操作，但选定的配置不需要包含深度或模板缓冲区，但需要注意的是 OpenGL ES 2.0 实现必须支持至少一个深度位深度为 16 或更高且模板位深度的配置8 或更高。

这回答了你的问题了吗？

# javascript - javascript对不同单位的距离进行排序

> ID：11569108
> 
> 赞同：0
> 
> 时间：2012-07-19T20:51:58.350
> 
> 标签：javascript, jquery, arrays, sorting, google-maps-api-3

当以英里和英尺为单位返回单位时，如何对距离数组进行排序？

例如，我将获得 327 英尺 1.5 英里。20 英里。等问题是，当尝试按距离排序时，脚通常会排在最后，因为它的数值更高。是否有可能总是在数组中先用脚计算一些东西？

这是代码：

```
_locationset.sort(function (a, b) {
       return ((a.Distance < b.Distance) ? -1 : ((a.Distance >b.Distance) ? 1 : 0));
}); 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:55:20.200

我认为这是不可能的，您必须先将脚转换为英里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:03:06.220

我从您使用 Google Maps API 的标签猜测。您如何获得与谷歌地图 API 的距离？

来自 google maps API 的距离可以使用指定的单位系统以字符串表示形式提供，但它们也可以始终以米为单位的数字表示形式提供。您可以使用数字表示并对其进行排序吗？

[https://developers.google.com/maps/documentation/javascript/reference#Distance](https://developers.google.com/maps/documentation/javascript/reference#Distance)

# java - 从屏幕边缘到游戏中地图其他位置的 Java 箭头

> ID：11569109
> 
> 赞同：0
> 
> 时间：2012-07-19T20:51:58.343
> 
> 标签：java, algorithm, rotation, game-engine, angle

我的 Java 游戏屏幕边缘有一个箭头，它应该指向地图上其他位置的对象，但它只是一直绕着屏幕转而无法指向该对象，有什么想法吗？

这是我的代码：

```
float angle = (float)Math.toDegrees(Math.atan2(currentInteractive.getY()-player.pos[1], currentInteractive.getX()-player.pos[0]));
arrow.setRotation(angle);

float magnitude;
float abs_cos_angle = (float) Math.abs(Math.cos(angle));
float abs_sin_angle = (float) Math.abs(Math.sin(angle));
if (Main.DISPLAY_WIDTH/2*abs_sin_angle <= Main.DISPLAY_HEIGHT/2*abs_cos_angle)
{
    magnitude = Main.DISPLAY_WIDTH/2/abs_cos_angle;
}
else
{
    magnitude = Main.DISPLAY_HEIGHT/2/abs_sin_angle;
}
float ax = (float) (camera.viewPort.getCenterX() + Math.cos(angle)*magnitude);
float ay = (float) (camera.viewPort.getCenterY() + Math.sin(angle)*magnitude);

arrow.draw(ax, ay, Color.green); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-21T11:20:43.177

我解决了这个问题，原来是因为我没有将角度转换为弧度并且它弄乱了幅度，我还必须用括号封装数学的某些部分以确保它以正确的顺序计算。

这是我现在的代码：

```
Interactive currentInteractive = interactiveList.get(i);

currentInteractive.draw();

float angle = (float)Math.toDegrees(Math.atan2(currentInteractive.getY()-player.pos[1], currentInteractive.getX()-player.pos[0]));

arrow.setRotation(angle+90);

float magnitude;
float abs_cos_angle = (float) Math.abs(Math.cos(Math.toRadians(angle)));
float abs_sin_angle = (float) Math.abs(Math.sin(Math.toRadians(angle)));
if (Main.DISPLAY_WIDTH/2*abs_sin_angle <= Main.DISPLAY_HEIGHT/2*abs_cos_angle)
{
    magnitude = (Main.DISPLAY_WIDTH-20)/2/abs_cos_angle;
}
else
{
    magnitude = (Main.DISPLAY_HEIGHT-20)/2/abs_sin_angle;
}

float ax;
if(currentInteractive.pos[0] > player.pos[0]-(Main.DISPLAY_WIDTH/2) && currentInteractive.pos[0] < player.pos[0]+(Main.DISPLAY_WIDTH/2))
{
    ax = (float) currentInteractive.pos[0];
}
else
{
    ax = (float) (Math.cos(Math.toRadians(angle)) * magnitude) + camera.viewPort.getCenterX()-10;
}

float ay;
if(currentInteractive.pos[1] > player.pos[1]-(Main.DISPLAY_HEIGHT/2) && currentInteractive.pos[1] < player.pos[1]+(Main.DISPLAY_HEIGHT/2))
{
    ay = (float) currentInteractive.pos[1];
}
else
{
    ay = (float) (Math.sin(Math.toRadians(angle)) * magnitude) + camera.viewPort.getCenterY()-10;
}

arrow.draw(ax, ay, Color.green); 
```

# c++ - #include'ing .cpp 模板实现文件是一种不好的做法吗？

> ID：11569111
> 
> 赞同：2
> 
> 时间：2012-07-19T20:52:20.720
> 
> 标签：c++, templates, build, include

在我正在处理的一个项目中，我有一个相当大的模板类，我已经像这样实现了：

我有我的头文件

```
// MyBigClass.h
#ifndef MYBIGCLASS_H
#define MYBIGCLASS_H

template <typename T>
class MyBigClass {
   /* -- snip -- */
};

#include "MyBigClass.cpp"
#include "MyBigClass_iterator.cpp"
#include "MyBigClass_complicatedFunctionality_1.cpp"
#include "MyBigClass_complicatedFunctionality_2.cpp"

#endif 
```

然后我所有的实现文件看起来基本上是这样的：

```
// MyBigClass_foobar.cpp

template <typename T>
void MyBigClass<T>::member_1(){
   /* -- snip -- */
}

template <typename T>
int MyBigClass<T>::member_2(int foo, T & bar){
   /* -- snip -- */
}

// etc, etc 
```

在`main.cpp`中，我只包括`MyBigClass.h`，一切正常，编译正常。我将实现拆分为多个文件的原因是因为我更喜欢处理三个或四个 200-400 行文件，而不是一个 1200 行文件。这些文件本身的组织结构相当合理，例如仅包含嵌套类的实现或一组相互关联的成员函数。

我的问题是，这件事已经完成了吗？前几天我把这个给别人看时，我得到了一个奇怪的反应，所以我想知道这是否是一种不好的做法，或者是否有更好、更常用的方法来完成这样的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T20:53:56.903

*通常*不包含文件是惯例`cpp`（这样做时存在有限和奇异的情况），这可能是您看起来怪异的原因。

通常这种分离是通过将实现移动到一个`.impl`甚至一个`.h`文件而不是一个文件来完成的`cpp`。

不，分离模板的实现并将文件包含在标头中没有任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T20:54:44.677

所以... include`.cpp`是一种不好的做法，但是是什么阻止您使用头文件而不是`.cpp`? 例如提升使用`.ipp`文件...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T21:09:32.810

在处理过包含数千个或更多文件的 C/C++ 项目之后，这是我通常观察到的做法：

1.  将类定义保留在头文件中。不要在头文件中添加任何实现。内联函数和模板除外。最后我会谈到这一点。
2.  将所有函数和方法实现保存在 .c 或 .cpp 文件中。

这样做有根本原因。

1.  .h 文件充当任何人使用您在代码中实现的类/函数/和其他数据结构和 API 的参考点。任何不知道类结构的人都会首先参考 .h。
2.  您可以分发仅显示 .h 文件的库，而不显示您的实际实现。通常他们会提出外部 API（同样在 .h 文件中），这些 API 是库中任何代码的唯一入口点，如果希望共享代码，第三方可以使用这些 API。
3.  如果您在多个位置包含 .c 或 .cpp 文件 - 在编译过程中您不会看到任何错误 - 但链接器将摆脱抱怨重复符号的问题。由于它包含您包含的 .c/.cpp 文件的所有这些功能/方法部分的多个副本。

**例外**

1.  内联函数实现需要存在于 .h 文件中才能生效。在某些情况下，编译器可能会自动决定一段代码可以内联 - 但在某些情况下，它需要存在 inline 关键字。**注意：我在这里只谈论后者。**只有当它看到 inline 关键字时，编译器才会内联任何函数。换句话说，如果 .cpp 具有以下代码：

    A类；A.my_inline_method();

如果在编译此 cpp 文件时 my_inline_method() 作为内联函数对编译器不可见，则它不会内联此函数。

2.  在编译方面，模板类似于内联方法——当模板的代码需要由编译器在使用它的 .cpp 中生成时——它需要知道该模板的整个实现。由于模板代码生成是编译时而不是运行时。

我已经提到了这背后更常见的哲学。如果我错过了，请随时编辑此答案以添加更多内容。

此处有关模板内容的更多信息：[为什么模板只能在头文件中实现？](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)

编辑：根据@Forever 的评论进行更改以避免歧义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-27T02:26:08.077

我正在回答我自己的问题，以补充一点，模板实现的标准扩展似乎是`.tcc`. 它[被 github 的语法 highlighter 识别](https://github.com/github/linguist/blob/master/lib/linguist/languages.yml)`gcc`，并且在手册页中也提到：

> C++ 源文件通常使用后缀`.C`, `.cc`, `.cpp`, `.CPP`, `.c++`, `.cp`, 或`.cxx`;之一。C++ 头文件经常使用`.hh`, `.hpp`, `.H`, **or （用于共享模板代码）`.tcc`**；

如果我误解了`.tcc`扩展程序的预期用途，请告诉我，我将删除此答案！

# c# - 如何使用 C# 递归计算 Windows 中的文件和文件夹？

> ID：11569114
> 
> 赞同：1
> 
> 时间：2012-07-19T20:52:47.293
> 
> 标签：c#, recursion, filesystems, directory

***编辑 8/8/2012：*** *我对我正在使用的代码进行了一些重大更改，并希望对我遇到的最后一个问题提供一些新的帮助。我将重写这个问题的大部分内容。*

我有一个小程序，它递归地遍历目标目录下的每个文件和文件夹，检查特定字符的名称。它工作得很好，但我正在寻找有关如何使特定方法更快工作的帮助。

这是我目前正在使用的代码。这只是启动所有方法的几行代码：

```
if(getFullList(initialPathTB.Text))
            SearchFolder(); 
```

这些是您需要查看的两种方法：

```
private void SearchFolder()
{
    int      newRow;
    int      numItems = 0;

    numItems = itemsMaster.Length;

    for (int x = 0; x < numItems; x++)
    {
        if (hasIllegalChars(itemsMaster[x]) == true)
        {
            newRow = dataGridView1.Rows.Add();
            dataGridView1.Rows[newRow].Cells[0].Value = itemsMaster[x];
            filesFound++;
        }
    }
}

private bool getFullList(string folderPath)
{
    try
    {
        if (checkBox17.Checked)
            itemsMaster = Directory.GetFileSystemEntries(folderPath, "*", SearchOption.AllDirectories);
        else
            itemsMaster = Directory.GetFileSystemEntries(folderPath, "*", SearchOption.TopDirectoryOnly);
        return true;
    }
    catch (UnauthorizedAccessException e)
    {
        if(folderPath[folderPath.Length - 1] != '\\')
            folderPath += @"\";
        if (e.Message == "Access to the path '" + folderPath + "' is denied.")
        {
            MessageBox.Show("You do not have read permission for the following directory:\n\n\t" + folderPath + "\n\nPlease select another folder or log in as a user with read access to this folder.", "Access Denied", MessageBoxButtons.OK, MessageBoxIcon.Error);
            folderPath = folderPath.Substring(0, folderPath.Length - 1);
        }
        else
        {
            if (accessDenied == null)
                accessDenied = new StringBuilder("");
            accessDenied.AppendLine(e.Message.Substring(20, e.Message.Length - 32));
        }
        return false;
    }
} 
```

`initialPathTB.Text`填充有“F:\COMMON\Administration”之类的内容。

**这是我的问题。** 当传递给的顶层`folderPath`是用户没有读取权限的顶层时，一切正常。当顶级*目录和所有从属目录*都是用户具有读取权限的文件夹时，一切都会再次正常工作。问题在于用户对顶层具有读取权限但对更深层次的某些子文件夹没有读取权限的目录。这就是为什么`getFullList()`是布尔值；如果有任何 UnauthorizedAccessExceptions 则`itemsMaster`保持为空并`SearchFolder()`失败`numItems = itemsMaster.Length;`。

我想要的是填充`itemsMaster`其中的每个项目，`folderPath`并简单地跳过用户没有读取权限的项目，但我不知道如何在不递归爬取和检查每个目录的情况下做到这一点。

这段代码比我的旧方法运行*得快得多*，所以我不想完全放弃它。有什么方法可以使该`Directory.GetFileSystemEntries()`方法做我想要的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T20:57:36.970

```
Directory.GetFileSystemEntries(folderPath, "*", SearchOption.AllDirectories).Length 
```

或其他选项（使用此选项，请记住其中的前 3-5 个元素`fullstring`将是您应该删除的输出中的垃圾文本）：

```
Process process = new Process();
List<string> fullstring = new List<string>();

process.StartInfo.FileName = "cmd.exe";
process.StartInfo.RedirectStandardOutput = true;
process.StartInfo.RedirectStandardInput = true;
process.StartInfo.UseShellExecute = false;
process.OutputDataReceived += (sender, args2) => fullstring.Add(args2.Data);

process.Start();

process.StandardInput.WriteLine(@"dir /b /s c:\temp | find """" /v");
process.BeginOutputReadLine();

process.WaitForExit(10000); //or whatever is appropriate time

process.Close(); 
```

如果您想更好地跟踪错误，请进行以下更改：

全局声明`List<string> fullstring = new List<string>();`，然后更改如下事件处理程序`OutputDataReceived`：

```
 process.OutputDataReceived += new DataReceivedEventHandler(process_OutputDataReceived);
}

static void process_OutputDataReceived(object sender, DataReceivedEventArgs e)
{
    try
    {
        fullstring.Add(e.Data);
    }
    catch (Exception ex)
    {
        Debug.WriteLine(ex.ToString());
        //log exception
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:32:46.577

您写道：“我希望进度条实际指示程序在项目列表中的距离，因此我需要一些项目来将 ProgressBar.Maximum 属性设置为。”

这是一种特定的愿望，在给定的情况下，我不确定它是否值得。如果你的 ProgressBar 是（比如说）800 px 宽，1 个百分点就是 0.125px 宽。对于“超过 10 万个项目”的列表——让我们将其设为至少 100,000 个——您必须处理 8,000 个项目才能移动条形以移动单个像素。您的程序处理 8,000 个项目需要多长时间？这将帮助您了解您正在向用户提供什么样的实际反馈。如果花费的时间太长，即使它正在工作，它也可能看起来像是挂了。

如果您希望提供良好的用户反馈，我建议您将 ProgressBar 的样式设置为 Marquee 并提供“正在检查文件*#x* ”文本指示器。

# asp.net - 使用 RSA 加密 web.config

> ID：11569119
> 
> 赞同：0
> 
> 时间：2012-07-19T20:53:00.013
> 
> 标签：asp.net, encryption, web-config

当我使用 aspnet_regiis 加密 web.config 时，第一行说

```
configProtectionProvider="RsaProtectedConfigurationProvider" 
```

后来它说

```
<EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc" /> 
```

之后它说

```
<EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
      <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" /> 
```

当提供者是 RsaProtectedConfigurationProvider 类型时，我很困惑为什么三重线在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T20:57:57.460

您是否首先创建了要使用的密钥？

这是一个示例，向下滚动到网络农场场景：[msdn microsoft](http://msdn.microsoft.com/en-us/library/ms998283.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:13:34.483

这是用于加密 webconfig 中的方法**RsaProtectedConfigurationProvider****的**事件序列

 **```
 <appSettings configProtectionProvider="RsaProtectedConfigurationProvider">
<EncryptedData Type="http://www.w3.org/2001/04/xmlenc#Element"
  xmlns="http://www.w3.org/2001/04/xmlenc#">
  <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc" />
  <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
    <EncryptedKey xmlns="http://www.w3.org/2001/04/xmlenc#">
      <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-1_5" />
      <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
        <KeyName>XXXXXX</KeyName>
      </KeyInfo>
      <CipherData>
        <CipherValue>GW5cBFyCHZxAmSTGf+eKfIQmi7Vy450CGKEnMk8nJBW+3w0R4QZAEyneaZ0=</CipherValue>
      </CipherData>
    </EncryptedKey>
  </KeyInfo>
  <CipherData>
    <CipherValue>vH3V+KnNRAc9ps+AhzrrFf2HABiqI/dlnYCCDE+wxoUZ4CoVReswbyTKU4ZybcuxmUwV2z5kUNaAQ8Rmei3IsN7VRx7pVXjDtOT4osA0Jc</CipherValue>
  </CipherData>
</EncryptedData> 
```

帮助自己解决这个问题：[ete](http://msdn.microsoft.com/en-us/library/system.configuration.rsaprotectedconfigurationprovider.aspx)**

# java - 更改活动时应用程序崩溃

> ID：11569120
> 
> 赞同：0
> 
> 时间：2012-07-19T20:53:04.777
> 
> 标签：java, android, xml, eclipse, android-activity

更改活动时我的应用程序崩溃这是我的代码，我正在关注 youtube 上的教程，一切似乎都与他的代码完全一样。看看你能不能帮忙 一切似乎都井井有条，我完全复制了一切，

显现：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.helloworld"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".Splash"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="com.example.helloworld.MAINACTIVITY" />

                <category android:name="android.intent.category.DEFUALT" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

主要活动：

```
package com.example.helloworld;

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.app.Activity;

public class MainActivity extends Activity {

    int counter;
    Button add, sub;
    TextView display;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        counter = 0;
        add = (Button) findViewById(R.id.bAdd);
        sub = (Button) findViewById(R.id.bSub);
        display = (TextView) findViewById(R.id.tvDisplay);
        add.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {

                counter++;
                display.setText("Your Total is " + counter);
            }
        });
        sub.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {

                counter--;
                display.setText("Your Total is " + counter);
            }
        });
    }
} 
```

飞溅.java：

```
package com.example.helloworld;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
public class Splash extends Activity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub

        super.onCreate(savedInstanceState);
        setContentView(R.layout.splash);
        Thread timer = new Thread(){
            public void run(){
                try{
                    sleep(5000);

                } catch (InterruptedException e){
                    e.printStackTrace();
                }finally{
                    Intent openStartingPoint = new Intent("com.example.helloworld.MAINACTIVITY");
                    startActivity(openStartingPoint);
                }
            }
        };  
        timer.start();
    }
}

Logcat:

07-19 20:35:36.068: E/AndroidRuntime(1442): FATAL EXCEPTION: Thread-74
07-19 20:35:36.068: E/AndroidRuntime(1442): android.content.ActivityNotFoundException: No Activity found to handle Intent { act=com.example.helloworld.MAINACTIVITY }
07-19 20:35:36.068: E/AndroidRuntime(1442):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1512)
07-19 20:35:36.068: E/AndroidRuntime(1442):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1384)
07-19 20:35:36.068: E/AndroidRuntime(1442):     at android.app.Activity.startActivityForResult(Activity.java:3190)
07-19 20:35:36.068: E/AndroidRuntime(1442):     at android.app.Activity.startActivity(Activity.java:3297)
07-19 20:35:36.068: E/AndroidRuntime(1442):     at com.example.helloworld.Splash$1.run(Splash.java:23) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T20:58:37.367

尝试改变：

```
Intent openStartingPoint = new Intent("com.example.helloworld.MAINACTIVITY"); 
```

至：

```
Intent openStartingPoint = new Intent(Splash.this, MainActivity.class); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T21:07:31.523

我认为应用程序崩溃是因为您在意图过滤器中拼错了“DEFAULT”。

# aspdotnetstorefront - 在 XSLT 2.0 SQL 查询中使用查询字符串参数

> ID：11569122
> 
> 赞同：0
> 
> 时间：2012-07-19T20:53:12.513
> 
> 标签：aspdotnetstorefront

这是我正在使用的查询。假设用于访问此页面的 URL 是`http://www.domain.com/default.aspx?id=3`

```
 <query name="SimpleQuery" rowElementName="Table" runif="showpage">
    <sql>
      <![CDATA[
        select * from Table where ID = @QueryStringID
      ]]>
    </sql>
    <queryparam paramname="@QueryStringID"       paramtype="request" requestparamname="id"        sqlDataType="int" defvalue="0"  validationpattern="" />
  </query> 
```

所以这应该翻译这个查询：`select * from Table where ID = 3`，但它没有正确获取查询字符串参数。

根据 AspDotNetStorefront 文档（[http://manual.aspdotnetstorefront.com/p-157-xml-packages.aspx](http://manual.aspdotnetstorefront.com/p-157-xml-packages.aspx)），参数类型`request`可用于访问查询字符串变量，但我不知道如何。

任何帮助将不胜感激 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:27:13.487

看起来是对的。但是，由于您的 runif 属性 (runif="showpage")，您的查询可能不会执行。

从您引用的链接中执行：“runif 属性只能在某些情况下用于运行查询。该值应该是 querystring/form/cookie 参数或 appconfig 参数。如果指定的 querystring/form/cookie 参数或appconfig 参数不存在或为空，则不会执行查询。这可用于在使用表单字段提交页面之前不应运行查询的页面。

# spring-mvc - 使用带有 spring mvc 的 dojo 文本框

> ID：11569130
> 
> 赞同：0
> 
> 时间：2012-07-19T20:53:52.827
> 
> 标签：spring-mvc, dojo

我是一名后端开发人员，试图在 Spring MVC3 应用程序中使用 dojo 文本框。

该页面下方有一个文本框和一个dojo 数据网格。文本框用于捕获搜索条件。当用户在文本框中输入值并单击 ENTER 时，它应该触发一个 Spring 控制器，该控制器将根据数据网格中文本框中提供的条件进行搜索。

问题是

*1。我如何在 dojo 而不是普通的 javascript 中做到这一点。我不希望重新提交整个页面。

*2。控制器如何检索在文本框中输入的值。它们是否必须作为@ModelAttributes 传递或显示为@RequestParam

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T09:41:53.477

> 文本框用于捕获搜索条件。当用户在文本框中输入值并单击 ENTER 时，它应该触发一个 Spring 控制器，该控制器将根据文本框中提供的条件进行搜索

提交时，您需要使用映射 Spring 控制器的 URL 触发 dojo xhr.get() AJAX 调用。

```
var getAll = function (URL){
    var xhrArgs = {
            url : URL, // e.g. localhost:8080/projectname/entity?param1=value1
            handleAs : "json",
            headers : {
                "Content-Type" : "application/json"
            }
        };
    return dojo.xhrGet(xhrArgs);
}; 
```

在 spring 控制器中，您需要将此 url 映射到方法。如果它是一个单一的值来控制器 @RequestParam 会更好地使用

```
 @RequestMapping(value = "/entity")
        public List<Model> someMethod(@RequestParam("param1")String keyword) {
} 
```

# python - 使用 Python 连接 LinkPoint API - 通过 SSL 发送 XML 并进行身份验证

> ID：11569135
> 
> 赞同：0
> 
> 时间：2012-07-19T20:54:02.750
> 
> 标签：python, xml, api, https, linkpoint

我正在尝试使用 Python 成功连接到 LinkPoint 网关。对于那些不熟悉他们的 API 的人，您会得到一个`.pem`用于身份验证的文件。

我在使用此文件和通过 SSL 创建安全连接时遇到问题。

根据他们的 API 文档（顺便说一句，还有很多不足之处），我相信配置应该如下所示：

```
HOST = 'secure.linkpt.net'
API_URL = 'https://secure.linkpt.net/lpc/servlet/lppay'
PORT = 1129
cert_key = my_cert_key.pem 
```

使用此信息和有效`XML`字符串如何创建此连接？

我对`HTTP`Python 中的连接很陌生。我已经使用`POST`with成功实现了与其他 API 的连接`urllib2`。自然地，我的第一次尝试是从一个类似的方法开始的，希望我能偶然找到一个解决方案。

就像是：

```
headers = { 'User-Agent'     : 'Rico',
            'Content-type'   : 'text/xml; charset=\"UTF-8\"',
            'Content-length' : len(self.xml_string),
          }

# POST to First Data (Link Point)
req = urllib2.Request(API_URL, self.xml_string, headers)
response = urllib2.urlopen(req)
self.handleResponse(response.read()) 
```

我几乎不希望这会奏效，因为我没有提供有关`cert_key`或 的任何信息`PORT`。

在此尝试之后，我尝试使用从另一个[stackoverflow](https://stackoverflow.com/questions/9093289/how-to-create-a-dual-authentication-https-client-in-python-without-lgpl-libs)帖子的解决方案中找到的类似方法。不幸的是，由于我没有文件（我知道），所以我无法做到这`ca_certs`一点`cert`。

我尝试使用[请求](http://docs.python-requests.org/en/latest/index.html)，但找不到文档/示例让我理解它。

我也尝试过使用[Twisted](http://twistedmatrix.com/trac/)，我真的希望我能用它做点什么，但这感觉就像试图用破坏球打开一扇门。对我来说，这感觉有点矫枉过正。我只需要一个简单的连接/请求/响应......这似乎过于复杂。

我的下一个尝试是[PycURL](http://pycurl.sourceforge.net/)，但在这个过程中遇到了足够的绝望，我想我会来这里看看是否有人在深入研究之前有一些好的建议。

如果您认为我应该重新访问这些工具之一，请告诉我。我并没有花太多时间在这些上——只是让我的脚湿透了。如果您还可以向我指出一个很好的示例或详细的文档，那就太好了。

另外，我不希望自己使用标准`SSL`库来建立连接——如果我不需要的话，我不想重新发明轮子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T01:34:44.377

我能够用来获得有效连接的解决方案使用`httplib`如下：

```
import httplib

HOST = 'staging.linkpt.net'
API_URL = '/lpc/servlet/lppay'
PORT = 1129
CERTFILE = 'my_cert_file.pem'

headers = { 'User-Agent'     : 'Rico',
            'Content-type'   : 'text/xml; charset=\"UTF-8\"',
            'Content-length' : len(xml_str),
          }

conn = httplib.HTTPSConnection(HOST, PORT, cert_file = CERTFILE)
conn.putrequest("POST", API_URL)
conn.putheader(headers)
conn.endheaders()
conn.send(xml_str)
response = conn.getresponse() 
```

我还不能生成一个有效的请求。显然我错误地解释了 API 文档并不断得到一个`Malformed or unrecognized request.`，但至少我正在建立连接。

如果我能够确定有关此主题的更多有用信息，我将更新此答案。

更新：Link Point 客户服务员工告诉我，我使用的是旧的 API 文档。我已经尝试使用较新的版本，但仍然无法连接。我什至无法从他们的服务器得到响应。这不再是解决此问题的可能方法。

更新 2：我能够在另一篇文章[SSL Connection Using .pem Certificate With Python中解决了这个问题](https://stackoverflow.com/questions/11586880/ssl-connection-using-pem-certificate-with-python)

享受！

# iphone - 如何使用 ALAsset 获得图像的裁剪版本？

> ID：11569137
> 
> 赞同：13
> 
> 时间：2012-07-19T20:54:10.620
> 
> 标签：iphone, ios

我正在尝试获取使用 ALAsset 提取的图像的裁剪版本。具体来说，我从用户的照片库中选择项目，然后上传它们。问题是在库缩略图视图中，iOS 向我们展示了裁剪后的版本。当您选择该缩略图并使用 ALAsset 拉出该图像的资产时，我会得到完整分辨率版本。我做了一些研究，但找不到任何有助于获得第二个裁剪发生位置的坐标系的东西。

要对其进行测试，您需要 iOS5 来编辑库中的图像。在您的图片库中选择一张图片，选择“编辑”，然后裁剪图片。当您获得 ALAsset 时，您将获得完整的图像，如果您使用 iPhoto 进行同步，iPhoto 也会提取完整的图像。此外，您可以重新编辑图像并撤消裁剪。

这就是我获取图像的方式：

```
UIImage *tmpImage = [UIImage imageWithCGImage:[[asset defaultRepresentation] fullResolutionImage]]; 
```

显然，这给了我全分辨率的图像。有一个 fullScreenImage 标志，可以将全分辨率图像缩放到屏幕大小。那不是我想要的。

ALAssetRepresenation 类有一个比例字段，但这是一个浮点值，这也是我不想要的。

如果有人能告诉我在哪里可以找到这个裁剪的坐标系，我将不胜感激。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-15T11:09:13.767

您的选择：

### 选项 1 (ALAssetLibrary)

使用 的`- (CGImageRef)fullScreenImage`方法`AlAssetRepresentation`。

优点：

*   所有艰苦的工作都为您完成，您会得到一张看起来就像照片应用程序中的图像一样的图像。这包括裁剪和其他更改。简单的。

缺点：

*   分辨率是“屏幕尺寸”，仅与您使用的设备一样大，而不是裁剪图像的全部可能分辨率。如果这与您无关，那么这是一个完美的选择。

### 选项 2 (ALAssetLibrary)

`AdjustmentXMP`使用图像元数据中的键（@tom 所指的内容）提取裁剪数据。应用作物。

益处：

*   可以以最佳分辨率获得裁剪图像

缺点

*   您只能获得裁剪编辑，而不是任何其他调整（如红眼）
*   谁知道Apple将来会在“编辑”模式下支持什么，您将来可能需要应用更多编辑。
*   **这很复杂**，您首先必须解析 XML 数据以读取裁剪矩形，裁剪*未旋转*的图像，然后应用旋转。

### 选项 3（一厢情愿）

请求 Apple 提供一种方法，该方法`fullResolutionEditedImage`可以为您提供最佳质量的照片，并应用所有编辑。

优点：

*   一切都神奇地解决了。

缺点：

*   苹果可能永远不会添加这种方法。

### 选项 4 (UIImagePickerController)

*此选项仅在您使用图像选择器时适用，您不能直接将其与资产库一起使用*

在由返回的 NSDictionary 中`-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info`

`UIImagePickerControllerOriginalImage`您可以从键中提取完整尺寸的调整图像。将此图像保存在某处。然后，不要从资源库中检索图像，而是加载您制作的副本。

优点：

*   您将获得完整尺寸的图像，并进行调整
*   这是 Apple 为我们提供的唯一选项，用于获取具有*所有*调整（如红眼等）的全尺寸图像，而不仅仅是裁剪。*这在 iOS 7 中尤为重要，因为它引入了可以彻底改变图像的过滤器。*

缺点：

*   只能与图像选择器一起使用（不是`ALAssetRepresentation`）
*   您必须保留图像的全尺寸副本。根据此类图像的数量，您的应用程序的磁盘使用量可能会大幅增长。

*iOS 7 更新：*您可能希望考虑**Option 4**或**Option 1**，因为 iOS 7 现在支持许多操作，例如过滤器，您的用户可能会注意到它们是否丢失。这两个选项支持过滤器（和其他编辑），选项 4 为您提供更高分辨率的结果。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-09-26T18:38:13.070

使用 iOS 照片应用程序裁剪照片后，可以在 ALAssetRepresentation 的元数据字典中找到裁剪坐标。fullResolutionImage 会给你未裁剪的照片，你必须自己进行裁剪。

AdjustmentXMP 元数据不仅包含裁剪坐标，还指示是否已应用自动增强或移除红眼。

从 iOS 6.0 开始，CIFilter 提供 filterArrayFromSerializedXMP:inputImageExtent:error: 可能您可以在此处使用 ALAssetRepresentation 的 AdjustmentXMP 元数据并将 CIFilter 应用于 ALAssetRepresentation 的 fullResolutionImage 以重新创建修改后的图像。

请注意，iOS 照片应用程序处理 JPG 和 RAW 图像的方式不同。对于 JPG 图像，带有 XMP 元数据的新 ALAsset 存储在相机胶卷中。对于 RAW 图像，将 ALAssetRepresentation 添加到原始 ALAsset。我不确定这个额外的 ALAssetRepresentation 是否是修改后的图像，以及它是否具有 AdjustmentXMP 元数据。除了 JPG 和 RAW 图像之外，您还应该测试 RAW+JPG 图像的行为。

# sql-server - SQL Server P2P 复制恢复

> ID：11569138
> 
> 赞同：1
> 
> 时间：2012-07-19T20:54:11.267
> 
> 标签：sql-server, sql-server-2008

我有两个使用对等事务复制设置的 SQL Server 数据库。一切正常，但我无法弄清楚如何备份和恢复它们。

我可以在复制运行时执行还原吗？这里的最佳做法是什么？最终，我想使用第三方服务进行备份/恢复操作，但我想更多地了解它在 SQL Server 中的工作方式。

我整天都在谷歌搜索和 MSDNing 无济于事。任何帮助将不胜感激。

# r - ggplot中多元回归中的虚拟交互项

> ID：11569143
> 
> 赞同：1
> 
> 时间：2012-07-19T20:54:18.397
> 
> 标签：r, ggplot2

我想在 ggplot 中显示两个虚拟交互项的图表。

我的代码是

```
plot3<-ggplot(tobit, aes(issue_ideology_pre, issue_ideology_post, 
                         colour=factor(real_liberal_exposure)))
plot3<-plot3 + stat_smooth(method="lm", formula = "y~x",   
                           aes(fill=factor(real_liberal_exposure)), 
                           na.rm=TRUE, alpha=0.3, size=0.5)
plot3<-plot3 + scale_colour_manual(values=c("darkgrey", "blue"),
                                   name="Started liberal selective Exposure",
                                   labels=c("no", "yes"), breaks=c(0,1))
plot3<-plot3 + scale_fill_manual(values=c("darkgrey", "blue"),
                                 name="Started liberal selective Exposure",
                                 labels=c("no", "yes"), breaks=c(0,1))
plot3<-plot3 + scale_y_continuous(lim=c(1.00, 5), breaks=1:5) + 
  scale_x_continuous(lim=c(1.00, 5), breaks=1:5)
plot3<-plot3 + xlab("Issue-Ideology at t-1") + ylab ("Issue-Ideology at t") 
```

我已将所有自变量存储在`x`（减去交互作用）和因变量在`y`.

我知道有一种简单的方法可以用“效果”显示交互效果，但在我看来，ggplot 解决方案应该有两种不同的回归作为输出，一种是选择性暴露的，一种是非暴露的。

但是，当我从绘图编码中删除公式，从而只运行基于二元回归的回归时，结果是相同的。

对此有什么解释，还是我错过了什么？

# python - 在 Heroku 上为 Django 处理静态文件和模板的正确方法

> ID：11569144
> 
> 赞同：31
> 
> 时间：2012-07-19T20:54:22.577
> 
> 标签：python, django, heroku, static

我正在将我的 django 应用程序转移到 Heroku，我想知道处理静态文件的正确方法是什么。我只是通过 git 将它们推送到 Heroku 吗？或者我应该将它们存储在 SW3 上吗？另外，STATIC_ROOT 等应该是什么？

谢谢！

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-07-21T07:42:31.553

您应该将它们外部存储在 S3 之类的服务上 - 虽然 Heroku*可以*提供静态文件，但它并非旨在提供服务。

这是一个很好的 S3 入门入门：

[https://devcenter.heroku.com/articles/s3](https://devcenter.heroku.com/articles/s3)

使用 django-storages [http://django-storages.readthedocs.org/en/latest/index.html](http://django-storages.readthedocs.org/en/latest/index.html)将静态文件收集到您的 S3 存储桶并相应地提供它们。

这些是 S3 所需的必要设置：

```
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
STATICFILES_STORAGE = 'storages.backends.s3boto.S3BotoStorage'

AWS_ACCESS_KEY_ID = 'access-id'
AWS_SECRET_ACCESS_KEY = 'secret-key'
AWS_STORAGE_BUCKET_NAME = 'bucket-name'
AWS_PRELOAD_METADATA = True # necessary to fix manage.py collectstatic command to only upload changed files instead of all files 
```

MEDIA_ROOT 和 STATIC_ROOT 分别被 DEFAULT_FILE_STORAGE 和 STATICFILES_STORAGE 取代，因此不需要。但是，您需要将 MEDIA_URL 和 STATIC_URL 设置为类似

```
STATIC_URL = 'https://bucket-name.s3.amazonaws.com/static/'
ADMIN_MEDIA_PREFIX = 'https://bucket-name.s3.amazonaws.com/static/admin/' 
```

如果您想将静态和媒体文件存储在不同的子文件夹中，这是一个很好的解决方案：[https ://stackoverflow.com/a/10825691/674794](https://stackoverflow.com/a/10825691/674794)

您需要将 MEDIA_URL 和 STATIC_URL 设置为各自的新文件夹，例如

```
MEDIA_URL = 'https://bucket-name.s3.amazonaws.com/media/'
STATIC_URL = 'https://bucket-name.s3.amazonaws.com/static/' 
```

您还需要手动执行 manage.py collectstatic 并按照[https://devcenter.heroku.com/articles/django-assets#disabling_collectstatic](https://devcenter.heroku.com/articles/django-assets#disabling_collectstatic)禁用 Heroku 的自动 collectstatic ，因为 Heroku 的 collectstatic 每次您都会将每个静态文件重新上传到 S3即使文件没有被修改也推送，增加大量的传输和请求负载到 S3 并减慢你的推送速度。

然后像往常一样继续在您的模板中使用 {{ STATIC_URL }} ，您应该已经设置好了！

```
<link href='{{ STATIC_URL }}css/styles.css' type='text/css' rel='stylesheet'> 
```

如果您想从简单开始并选择不立即采取该路线，您可以按照 Cesar 在[Heroku - 处理 Django 应用程序中的静态文件](https://stackoverflow.com/questions/9047054/heroku-handling-static-files-in-django-app)的帖子中提到的帖子在您的 urls 配置中进行快速破解，尽管会显着减少在应用性能方面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-10T23:46:30.807

虽然如果您有很多静态内容，@Intenex 的答案可能仍然是要走的路，但 Heroku 建议使用 Whitenoise。

这是 Heroku 的文章，标题为“ [Django and Static Assets](https://devcenter.heroku.com/articles/django-assets) ”。

并且白噪声文档本身有一个很好的部分关于“[我不应该使用 Django-Storages 之类的东西将我的静态文件推送到 S3 吗？](http://whitenoise.evans.io/en/stable/#shouldn-t-i-be-pushing-my-static-files-to-s3-using-something-like-django-storages) ”

# python - 在关系数据库中用“多重继承”表示层次关系

> ID：11569152
> 
> 赞同：3
> 
> 时间：2012-07-19T20:55:01.370
> 
> 标签：python, sql, oop, database-design

我正在开发一个 python 程序，该程序允许用户通过将“标签”附加到文件来对文件进行分类。这些标签可以彼此处于层次关系中。例如，“猫”标签可以归类为“哺乳动物”标签的“后代”。因此，一旦文件被标记为“狗”，它也可以通过“哺乳动物”标签访问。

这些标签及其相互之间和与文件的关系显然需要存储在数据库中，而我最熟悉关系数据库。

我非常喜欢将树存储在关系数据库中的[Modified Pre-order Tree Traversal](http://www.sitepoint.com/hierarchical-data-database-2/)方法，因为它不需要递归并且需要更少的数据库查询。

但是，我也想促进与多个父母的标签。例如，“狗”可以是“哺乳动物”的孩子，也可以是“四足动物”的孩子，其中并非所有四足动物都是哺乳动物甚至动物（例如桌子），“哺乳动物”和“四足动物” -thing' 标签没有“共同祖先”。

有谁知道在保持 MPTT 方法的一些优点的同时在数据库中表示这种关系的方法？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:32:47.427

您所描述的是无环有向图，而不是树，因此您不能使用任何像 MPTT 这样的 sql“树存储”方法。[这是一篇演示此问题的邻接列表方法的文章。](http://www.codeproject.com/Articles/22824/A-Model-to-Represent-Directed-Acyclic-Graphs-DAG-o)

但是，我强烈建议您不要走这条路，不是因为实施困难，而是因为您最终会让用户感到困惑和沮丧。根据我的经验，用户对复杂的本体系统使用不当，很容易被它们混淆。要么使用没有父子关系的平面“标签”命名空间，要么使用每个节点最多有一个父节点的树形排列。

但是如果你想要一个图表，他最直接的方法是有一个这样的表格：

```
CREATE TABLE tag_relationships (
    tag_child_id INTEGER NOT NULL REFERENCES tags (id) ON UPDATE CASCADE ON DELETE CASCADE,
    tag_parent_id INTEGER NOT NULL REFERENCES tags (id) ON UPDATE CASCADE ON DELETE CASCADE,
    PRIMARY KEY (tag_child_id, tag_parent_id)
); 
```

您可能无法避免递归查询。当您想要创建匹配搜索时，使用您拥有的标签作为搜索条件并递归添加子标签，直到您拥有完整的标签列表。

您还必须小心创建循环。添加关系时，需要递归访问父节点，并确保不会两次出现在同一个节点。

*为了避免递归查询和帮助检测循环，您可以做的事情是通过使每个*节点的*所有*关系都显式化来稍微非规范化您的数据。我的意思是，假设 A 是 B 和 C 的孩子，C 是 D 的孩子。

 *而不是表示这一事实所需的最小边数：

```
tag_child_id  tag_parent_id
A             B
A             C
C             D 
```

您将使所有隐式关系（必须通过递归找到的）显式：

```
A             B
A             C
A             D
C             D 
```

请注意，我添加了`(A, D)`.*

# wpf - 如何从 wpf 表单视图模型访问用户控件中的组合框文本？

> ID：11569156
> 
> 赞同：1
> 
> 时间：2012-07-19T20:55:17.437
> 
> 标签：wpf, data-binding, mvvm, user-controls

我有一个用户控件，其中有 4 个组合框绑定到该用户控件的视图模型中的集合。

我以 wpf 形式使用了这个控件。这个 wpf 表单有自己的视图模型。

如何从 wpf 表单的视图模型中的 4 个组合框访问文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T06:24:50.653

编辑：我看到你有不同的视图模型。现在这取决于您的用户控件的使用和 mvvm 的使用:)

*   您可以使用 messenger 或 eventtaggregator 将 seleteditem 从 usercontrolviewmodel 通信到 mainviewmodel。
*   您还可以在用户控件中使用 RelativeSource 绑定将选定项直接绑定到您的主视图模型（用户控件只是控件的组合）。
*   您可以摆脱 usercontrol viewmodel 并将所有内容放入 mainviewmodel 并以我的旧示例
*   您可以在您的用户控件中为 SelectedItems 创建 DependencyProperties！（不是用户控件视图模型！）并将它们绑定到您的主视图模型中的属性。如果用户控件应该是真正的用户控件，我认为这是最干净的方式。

旧示例：在您的视图模型中：//真正的代码当然应该实现`INotifyPropertyChanged`并正确提升它

```
 public ObservableCollection<string> MyFirstCollection {get; set;}//init once, add,remove,clear to alter

 public string MySelectedCombobox1Value {get;set;} 
```

在您的用户控件中：

```
 <ComboBox ItemsSource="{MyFirstCollection }" SelectedItem="{Binding MySelectedCombobox1Value, Mode=TwoWay}" /> 
```

这一切都与你的问题有关。确保您设置`DataContext`正确。您可以使用 snoop 等工具进行检查。我发布的代码预计组合框的数据连接是视图模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:55:08.073

唯一干净的方法是使用绑定，唯一推荐的方法是用户控件公开`DependencyProperty`ViewModel 或单个文本属性（如 sellmeadog 建议的那样）以供使用。然后，您可以在父 ViewModel 中拥有一个直接绑定到该依赖属性的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:02:34.003

UserControl 应该继承您将其添加到的表单的数据上下文，该表单将是视图模型。UserControl 中的任何绑定都将与继承的数据上下文相关。您是否尝试将视图模型属性绑定到`ComboBox.Text`？

**更新**

对不起，误读了你的问题。没有看到用户控件已经有自己的视图模型。

虽然似乎有更好的方法，但您可以在用户控件上公开依赖属性，以公开每个组合框的文本。只是大声思考。

# winapi - AddFontResource() 与 AddFontResourceEx()

> ID：11569159
> 
> 赞同：2
> 
> 时间：2012-07-19T20:55:23.797
> 
> 标签：winapi, fonts

[从这里](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183326%28v=vs.85%29.aspx)可以看出，该函数`AddFontResource()`要求应用程序向`WM_FONTCHANGE`系统中的所有顶级窗口发送消息，但[AddFontResourceEx()](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183327%28v=vs.85%29.aspx)函数不需要这样做。为什么有区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:16:15.830

这是因为您通常只使用 Ex 版本添加其他进程无法看到的私有字体。所以没有必要告诉任何人。

如果您不使用 FR_PRIVATE 或 FR_NOT_ENUM 标志，*请*发送消息。

# vba - 使用 VBA 查找行的长度

> ID：11569161
> 
> 赞同：0
> 
> 时间：2012-07-19T20:55:37.077
> 
> 标签：vba

有没有办法在 VBA 中找到一行的长度（只计算非空的单元格）？先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:04:29.630

如果您对“长度”的想法与最后一个非空单元格匹配： [列中的最后一个非空单元格](https://stackoverflow.com/questions/5441885/last-non-empty-cell-in-a-column)

```
=INDEX(A:A,MAX((A:A<>"")*(ROW(A:A)))) 
```

Excel 2007+

# c# - 从具有多个选择的 TreeView 中删除节点 (TreeViewMS)

> ID：11569163
> 
> 赞同：1
> 
> 时间：2012-07-19T20:55:39.370
> 
> 标签：c#, treeview

我需要一个多选的树视图组件。所以我下载了“ [C# TreeView with multiple selection](http://www.codeproject.com/Articles/2756/C-TreeView-with-multiple-selection) ”。现在我无法删除项目。以下代码运行良好，但没有删除任何内容：

```
private void removeToolStripMenuItem_Click(object sender, EventArgs e)
{
    for (int i = 0; i < treeView1.SelectedNodes.Count; i++)
    {
        try
        {
            if (treeView1.Nodes[i].IsSelected)
            {
                treeView1.Nodes[i].Remove();
                i--;
            }
        }
        catch { }
    } 

        treeView1.Update();
        treeView1.Refresh();
} 
```

* * *

```
treeView1.SelectedNodes.Remove(); 
```

需要一个对象，但我不知道是哪个。

```
foreach (TreeNode tn in treeView1.SelectedNodes)
            tn.Remove(); 
```

由于集合已修改，因此引发异常。

有人可以帮我吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:02:21.340

尝试使用反向循环并在传递所选节点的节点集合上使用 Remove 方法

```
private void removeToolStripMenuItem_Click(object sender, EventArgs e) 
{ 
    for (int i = treeView1.SelectedNodes.Count - 1; i >= 0; i--)
    {
        TreeNode n = (TreeNode)treeView1.SelectedNodes[i];
        treeView1.Nodes.Remove(n);
    }
    treeView1.Update(); 
    treeView1.Refresh(); 
} 
```

此外，我认为您不必测试节点 IsSelected 是否因为您已经在使用 SelectedNodes 属性。（真的，我还没有检查这个自定义的树视图类是否是这种情况，但是名称表明包含的节点已经被选中）

# ruby-on-rails - 在 Heroku 上使用 Rails 3.2.3 进行机架重写

> ID：11569176
> 
> 赞同：3
> 
> 时间：2012-07-19T20:57:23.100
> 
> 标签：ruby-on-rails, heroku, rack, middleware, rack-middleware

我正在尝试在 Heroku cedar 堆栈上为 Rails 3.2.3 设置 rack-rewrite，并且在我看到的任何地方都说要添加如下内容：

```
config.middleware.insert_before(Rack::Lock, Rack::Rewrite) do
  # rewrite rules
end 
```

但是尝试在 Heroku 上运行它会给我错误：

```
`assert_index': No such middleware to insert before: Rack::Lock (RuntimeError) 
```

并且确实运行“heroku rake 中间件”并没有在列表中显示 Rack::Lock 在开发中 Rack::Lock 存在。

第一个问题是为什么 Heroku 上没有 Rack::Lock，对吗？第二个问题，如果不是在 Rack::Lock 之前，我应该在哪里插入 Rack::Rewrite？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T19:13:34.607

如果你使用线程安全！在生产中启用，没有 Rack::Lock... 所以改为：

```
config.middleware.insert_before(Rack::Runtime, Rack::Rewrite) do
  #your coolness here
end 
```

# mono - Mono.CSharp：如何将值/实体*注入*脚本？

> ID：11569177
> 
> 赞同：1
> 
> 时间：2012-07-19T20:57:30.213
> 
> 标签：mono

刚刚遇到 Mono.CSharp 的最新版本，并喜欢它提供的承诺。

能够解决以下所有问题：

```
namespace XAct.Spikes.Duo
{
class Program
{
    static void Main(string[] args)
    {
        CompilerSettings compilerSettings = new CompilerSettings();
        compilerSettings.LoadDefaultReferences = true;
        Report report = new Report(new Mono.CSharp.ConsoleReportPrinter());

        Mono.CSharp.Evaluator e;

        e= new Evaluator(compilerSettings, report);

        //IMPORTANT:This has to be put before you include references to any assemblies
        //our you;ll get a stream of errors:
        e.Run("using System;");
        //IMPORTANT:You have to reference the assemblies your code references...
        //...including this one:
        e.Run("using XAct.Spikes.Duo;");

        //Go crazy -- although that takes time:
        //foreach (Assembly assembly in AppDomain.CurrentDomain.GetAssemblies())
        //{
        //    e.ReferenceAssembly(assembly);
        //}
        //More appropriate in most cases:
        e.ReferenceAssembly((typeof(A).Assembly));

        //Exception due to no semicolon
        //e.Run("var a = 1+3");
        //Doesn't set anything:
        //e.Run("a = 1+3;");
        //Works:
        //e.ReferenceAssembly(typeof(A).Assembly);
        e.Run("var a = 1+3;");
        e.Run("A x = new A{Name=\"Joe\"};");

        var a  = e.Evaluate("a;");
        var x = e.Evaluate("x;");

        //Not extremely useful:
        string check = e.GetVars();

        //Note that you have to type it:
        Console.WriteLine(((A) x).Name);

        e = new Evaluator(compilerSettings, report);
        var b = e.Evaluate("a;");
    }
}
public class A
{
    public string Name { get; set; }
}
} 
```

这很有趣……可以在脚本的范围内创建一个变量，然后导出该值。

只有最后一件事要弄清楚......我如何在不使用静态的情况下获得一个值（例如，我想在其上应用规则脚本的域实体）（我正在考虑在网络应用程序中使用它） ?

我见过使用编译的委托——但那是针对以前版本的 Mono.CSharp 的，它似乎不再工作了。

有人对如何使用当前版本执行此操作有建议吗？

非常感谢。

参考：*[将变量注入 Mono.CSharp.Evaluator（运行时从字符串编译 LINQ 查询）](https://stackoverflow.com/questions/3788096/injecting-a-variable-into-the-mono-csharp-evaluator-runtime-compiling-a-linq-qu) * [http://naveensrinivasan.com/tag/mono/](http://naveensrinivasan.com/tag/mono/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-06-03T09:59:22.260

我知道差不多 9 年后，但我认为我找到了注入局部变量的可行解决方案。它使用静态变量，但仍然可以由多个评估者使用而不会发生冲突。

您可以使用一个静态`Dictionary<string, object>`来保存要注入的引用。假设我们在课堂上做这一切`CsharpConsole`：

```
public class CsharpConsole {
   public static Dictionary<string, object> InjectionRepository {get; set; } = new Dictionary<string, object>();
} 
```

这个想法是暂时将值放在那里，并以 GUID 作为键，这样多个评估器实例之间就不会有任何冲突。要注入这样做：

```
public void InjectLocal(string name, object value, string type=null) {
    var id = Guid.NewGuid().ToString();
    InjectionRepository[id] = value;
    type = type ?? value.GetType().FullName;
    // note for generic or nested types value.GetType().FullName won't return a compilable type string, so you have to set the type parameter manually
    var success = _evaluator.Run($"var {name} = ({type})MyNamespace.CsharpConsole.InjectionRepository[\"{id}\"];");
   // clean it up to avoid memory leak
   InjectionRepository.Remove(id);
} 
```

此外，对于访问局部变量，还有一种使用反射的解决方法，因此您可以使用 get 和 set 获得一个不错的 [] 访问器：

```
 public object this[string variable]
        {
            get
            {
                FieldInfo fieldInfo = typeof(Evaluator).GetField("fields", BindingFlags.NonPublic | BindingFlags.Instance);
                if (fieldInfo != null)
                {
                    var fields = fieldInfo.GetValue(_evaluator) as Dictionary<string, Tuple<FieldSpec, FieldInfo>>;
                    if (fields != null)
                    {
                        if (fields.TryGetValue(variable, out var tuple) && tuple != null)
                        {
                            var value = tuple.Item2.GetValue(_evaluator);
                            return value;
                        }
                    }
                }
                return null;
            }
            set
            {
                InjectLocal(variable, value);
            }
        } 
```

使用这个技巧，您甚至可以注入您的评估代码可以从脚本中调用的委托和函数。例如，我注入了一个打印函数，我的代码可以调用它来向 gui 控制台窗口输出一些内容：

```
 public delegate void PrintFunc(params object[] o);

        public void puts(params object[] o)
        {
            // call the OnPrint event to redirect the output to gui console
            if (OnPrint!=null)
               OnPrint(string.Join("", o.Select(x => (x ?? "null").ToString() + "\n").ToArray()));
        } 
```

`puts`现在可以像这样轻松地注入此函数：

```
 InjectLocal("puts", (PrintFunc)puts, "CsInterpreter2.PrintFunc"); 
```

只需从您的脚本中调用：

```
 puts(new object[] { "hello", "world!" }); 
```

请注意，还有一个本机函数`print`，但它直接写入 STDOUT，并且无法从多个控制台窗口重定向单个输出。

# database - 如何使用 git 迁移数据库？

> ID：11569180
> 
> 赞同：4
> 
> 时间：2012-07-19T20:57:45.223
> 
> 标签：database, git, migration

我做网站开发（主要是 Drupal 基础站点）并且有一个工作流程：

1.  许多开发人员在他们的**本地机器上工作**
2.  **开发人员使用 git 在开发机器**上合并他们的更改
***   当开发站点达到稳定点时，我们将推送到**暂存服务器**供客户端查看*   最后我们发布到**生产服务器****

 **git 可以很好地来回移动文件。我的问题是我如何将其合并并使用 git 将数据库与文件一起迁移？

一旦我能够将开发数据库向上移动，我如何将开发数据库与活动的生产数据库合并？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:09:52.593

最直接的开始是将数据库转储到一个文件中并将其存储在 git 以及源中。但请务必不要将此文件泄漏到生产 webroot 中，以免某些`schema.sql`内容无法通过 HTTP 轻松获得。将源存储在存储库的子目录`/webroot`和 db很方便，从而成为Web 服务器的实际根目录。`/db``/webroot`

然后你会看到一些更新和合并，甚至是围绕这个文件的冲突——这些应该像往常一样解决你的代码文件。

在模式代码和可执行代码的所有合并和冲突解决之后，您应该彻底测试您的应用程序端到端。**

# node.js - 使用 Express 在动态路由上提供静态文件

> ID：11569181
> 
> 赞同：72
> 
> 时间：2012-07-19T20:57:56.467
> 
> 标签：node.js, express

我想像通常那样提供静态文件，`express.static(static_path)`但像通常那样在动态路由上提供服务

```
app.get('/my/dynamic/:route', function(req, res){
    // serve stuff here
}); 
```

一位开发人员在此[评论](https://github.com/visionmedia/express/issues/582#issuecomment-876792)中暗示了一个解决方案，但我并不清楚他的意思。

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2012-07-19T21:06:07.287

好的。[我在 Express 的响应对象](https://github.com/expressjs/express/blob/master/lib/response.js)的源代码中找到了一个示例。这是该示例的略微修改版本。

```
app.get('/user/:uid/files/*', function(req, res){
    var uid = req.params.uid,
        path = req.params[0] ? req.params[0] : 'index.html';
    res.sendFile(path, {root: './public'});
}); 
```

它使用该`res.sendFile`方法。

**注意**：安全更改`sendFile`需要使用该`root`选项。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2015-09-11T02:04:13.943

我使用下面的代码来提供不同 url 请求的相同静态文件：

```
server.use(express.static(__dirname + '/client/www'));
server.use('/en', express.static(__dirname + '/client/www'));
server.use('/zh', express.static(__dirname + '/client/www')); 
```

虽然这不是你的情况，但它可能会帮助到这里的其他人。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-09-12T22:01:48.337

您可以使用`res.sendfile`或仍然可以使用`express.static`：

```
const path = require('path');
const express = require('express');
const app = express();

// Dynamic path, but only match asset at specific segment.
app.use('/website/:foo/:bar/:asset', (req, res, next) => {
  req.url = req.params.asset; // <-- programmatically update url yourself
  express.static(__dirname + '/static')(req, res, next);
});         

// Or just the asset.
app.use('/website/*', (req, res, next) => {
  req.url = path.basename(req.originalUrl);
  express.static(__dirname + '/static')(req, res, next);
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-03-31T08:14:27.910

这应该有效：

```
app.use('/my/dynamic/:route', express.static('/static'));
app.get('/my/dynamic/:route', function(req, res){
    // serve stuff here
}); 
```

文档指出动态路由`app.use()`有效。见[https://expressjs.com/en/guide/routing.html](https://expressjs.com/en/guide/routing.html)

# parsing - “hTTp/1.0”和“htTP/1.1”区分大小写吗？

> ID：11569183
> 
> 赞同：0
> 
> 时间：2012-07-19T20:57:58.233
> 
> 标签：parsing, http, specifications, rfc, standards-compliance

在 2002 年，Roy Fielding 指出[HTTP 版本在 RFC 勘误表中应该区分大小写](http://lists.w3.org/Archives/Public/ietf-http-wg/2002JulSep/0066.html)：

> 就个人而言，我从来没有打算让“HTTP”不区分大小写，而且我不知道有任何客户端将其发送为小写，也没有任何服务器将其接受为小写。这样做是浪费周期。 **所以，我想上面那段说：**
> 
> > HTTP 消息的版本由消息第一行中的 HTTP-Version 字段指示。 **HTTP 版本区分大小写**。

然而，[RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.1)似乎并没有随着他的提议而更新。

那么，HTTP 版本是否区分大小写？

换句话说，HTTP 客户端/服务器是否可以发送 HTTP 版本`hTtP/1.1`并且仍然声称符合 RFC？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T07:22:49.520

答案在这里：[http](http://tools.ietf.org/wg/httpbis/trac/ticket/1) ://tools.ietf.org/wg/httpbis/trac/ticket/1 。是的，正在更新 RFC 2616。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-10T11:38:43.253

添加到 Julian 两年前的回答，RFC 7230（取代 2616）现在明确指出[HTTP-Version 区分大小写](https://www.rfc-editor.org/rfc/rfc7230#page-80)：

> A2。对 RFC 2616 的更改
> 
> …………
> 
> HTTP 版本的 ABNF 产品已**明确区分大小写**。此外，版本号被限制为单个数字，因为已知实现会错误地处理多位版本号。（第 2.6 节）

和[第 2.6 节。协议版本控制](https://www.rfc-editor.org/rfc/rfc7230#section-2.6)：

> HTTP 消息的版本由消息第一行中的 HTTP-version 字段指示。HTTP 版本区分大小写。
> 
>      `HTTP-version = HTTP-name "/"` [`DIGIT`](https://www.rfc-editor.org/rfc/rfc5234#page-8) `"." DIGIT`
>      `HTTP-name = %x48.54.54.50 ; "HTTP", case-sensitive`

# jquery - jQuery-File-Upload——在其生命周期内唯一地识别文件

> ID：11569186
> 
> 赞同：1
> 
> 时间：2012-07-19T20:58:38.620
> 
> 标签：jquery, jquery-plugins

我在 Rails 应用程序中使用[jQuery File Upload的](https://github.com/blueimp/jQuery-File-Upload "jQuery File Upload")**基本设置**，即我没有使用股票 UI 或服务器端脚本。我想要的页面用户体验与插件中捆绑的用户体验非常不同。

我正在使用`add`、`done`和`progress`回调来实现我想要的 UX。但是，我无法弄清楚如何在整个“上传生命周期”中唯一标识特定文件。对于正在上传的每个文件，我想创建一个`div`并在其中显示进度条和文件缩略图。

现在我正在使用上传文件的文件名在整个生命周期中识别它并将其绑定到一个特定的`div`但是，一旦用户上传两个（或更多）具有相同名称的文件，它就会中断。

我该如何解决这个问题？

（我是否正确描述了这个问题？如果它太模糊或模棱两可，请告诉我）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T16:02:04.300

回调的第二个参数（数据）是与上传相关的，所以例如你可以保存'reference'到与上传相关的html进度。

```
$('#fileupload').fileupload({
    add: function (e, data) {
                data.whatever = $('<div></div>');
            }
}); 
```

# objective-c - 带有 UILabel 子视图缓存问题的 UITableViewCell

> ID：11569187
> 
> 赞同：1
> 
> 时间：2012-07-19T20:58:39.653
> 
> 标签：objective-c, ios, uitableview, uilabel

首先，请不要告诉我这是重复的。我知道这个问题已被多次询问和回答，但即使在阅读了其他人的解决方案之后，我似乎仍然无法让我的代码正常工作。

我的 UITableViewCell 包含 UILabel 子视图时遇到问题。UILabel 有时不会出现在某些单元格中，直到我滚动离开这些单元格并返回它们。这是我用来自定义单元格的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

UILabel *label;

if (cell == nil) {

    // cell is nil, create it

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                  reuseIdentifier:CellIdentifier];

    label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 50, 33)];
    label.tag = 888;

} else {

    label = (UILabel*)[cell.contentView viewWithTag:888];
    [label removeFromSuperview];

}

label.text = @"Label Text";
label.backgroundColor = [UIColor clearColor];
[label sizeToFit];
label.center = CGPointMake(cell.contentView.frame.size.width-label.frame.size.width/2-20, cell.contentView.frame.size.height/2);
[cell.contentView addSubview:label];

// customize cell text label
cell.textLabel.text = @"Cell Text";
cell.textLabel.textColor = [UIColor darkGrayColor];

return cell;
} 
```

当 dequeueReusableCellWithIdentifier:CellIdentifier 返回非 nil 值时，标签似乎正确显示，但如果返回值为 nil 并且必须实例化新单元格，则标签不会显示。

如果有人知道为什么会发生这种情况，我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T23:21:52.620

我看到你想做的几件事。

1）阅读“sizeToFit” - 描述说如果视图没有超级视图，你可能会得到奇怪的结果。

2）创建视图时，立即将其添加到单元格中。

3）调整单元格大小后，获取其大小，然后计算正确的框架 - 我建议不要使用“中心”，但我不知道您的代码不适用于事实。

4）在改变中心改变框架之前，硬编码如下：

```
CGRect r = label.frame;
r.origin = (CGPoint){ 20, 20 };
label.frame = r; 
```

这至少会让你相信新单元和旧单元都在正常工作。然后你可以计算你真正想要的帧，或者进一步使用中心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T05:10:45.613

不合时宜的有以下三点：

```
if (cell == nil) { // cell is nil, create it

    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                  reuseIdentifier:CellIdentifier];

    label = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 50, 33)];
    label.tag = 888;
    [cell.contentView addSubview:label]; // (1) DO THIS HERE

} else {

    label = (UILabel*)[cell.contentView viewWithTag:888];
    // (2) DON'T DO THIS:  [label removeFromSuperview];

}

label.text = @"Label Text";
label.backgroundColor = [UIColor clearColor];
[label sizeToFit];
label.center = CGPointMake(cell.contentView.frame.size.width-label.frame.size.width/2-20, cell.contentView.frame.size.height/2);
// (3) DON'T DO THIS HERE: [cell.contentView addSubview:label];
.... 
```

我假设 ARC 已打开，否则在将其添加到 contentView 后您需要一个 [label release]。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:22:25.857

不确定问题的原因，但您可以进行一些改进。也许其中一个解决了这个问题：

1.  在 dequeu 场景中，您从视图中删除标签，只是将其添加回来。相反，您应该将其保留在视图层次结构中。

2.  避免一直调整和移动标签。为什么不让它足够宽，将文本设置为右对齐。这样，您不必在 dequeue 场景中调整移动标签的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T23:48:23.430

似乎问题可能出在修改 cell.textLabel 上。该站点上的其他帖子建议，每当修改此标签时，实际上都会创建一个新标签并将其添加到单元格的内容视图中（而不是仅修改现有标签）。设置`cell.textLabel.backgroundColor = [UIColor clearColor];`似乎已经解决了问题

我仍然对此感到有些困惑，因为即使最后添加我的自定义标签子视图（在为 cell.textLabel 设置属性之后）也不能解决问题 - cell.textLabel 的背景颜色必须设置为透明/清晰。

# java - “保持登录”登录页面

> ID：11569189
> 
> 赞同：1
> 
> 时间：2012-07-19T20:58:52.523
> 
> 标签：java, jsp, login, remember-me, stay-logged-in

我想在我的 jsp 登录页面中实现保持登录或记住我。我正在使用基于容器的表单身份验证。我想我需要将用户的数据（例如用户 ID 和令牌）存储到 cookie 中，这是一种状态信息，用于确定用户是否已登录。另外我听说我们不应该存储用户的密码，即使它是加密的。

如果我存储了他们的密码和用户 ID，我可以在向用户显示登录页面之前通过将数据提交给 servlet 来自动让他们叹息。

如果我不存储他们的密码，我可以使用什么方法让他们自动登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:06:32.747

我建议您不要为此创建自己的框架，而是使用[spring-security](http://static.springsource.org/spring-security/site/)或[Apache Shiro](http://shiro.apache.org/)之类的东西，因为您的应用程序的安全性非常重要，而不是您通常想要从头开始构建的东西。

如果这纯粹是出于教育目的，我建议查看上述两个应用程序的代码，看看它们是如何处理它的。

我已经看到这实现为 cookie 中的安全令牌（具有到期日期），其值也存储在服务器上一段时间并与特定用户帐户相关联。当用户使用该 cookie 返回站点时，服务器会将其令牌值与 cookie 的值进行比较，如果匹配（且未过期）则让它们进入。

同样，最好使用预先存在和经过测试的库来完成此类工作。

祝你好运。

# matlab - 使用四元数对向量进行反旋转

> ID：11569192
> 
> 赞同：1
> 
> 时间：2012-07-19T20:59:01.503
> 
> 标签：matlab, rotation, quaternions

我有一组沿 x、y、z 方向（传感器主体框架）的加速度值。传感器在操作过程中多次倾斜和改变方向。使用陀螺仪、磁力计和加速度计，我能够以四元数格式（称为 Q）融合和提取 Roll、Pitch 和 Yaw 角。

现在，将加速度值反旋到全局 X、Y、Z 位置。我只是简单地 1\. 通过将标量部分设置为 0（称为 Acc）将加速度值转换为四元数 2\. 将加速度四元数相乘如下：Qtranspose * Acc * Q？

还是我的结论错了？我们如何贬低价值观？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-23T01:55:55.703

如果您已经有一个准确的四元数方向**q**，那么加速度的“未旋转”向量就是您所说的：

```
Ag = q* A q 
```

或者

```
Ag = q A q* 
```

取决于您用于四元数乘法的约定。（只需尝试两者，看看哪一个给你正确的重力矢量）。

请注意，A 和 Ag 是“纯四元数”——这是一个四元数，标量分量为 0，轴分量为加速度矢量。换句话说，如果你的四元数是 q = [wxyz]，那么 A = [0 ax ay az]。然后，您可以丢弃 Ag 的标量分量以获得未旋转的向量。确保加速度矢量的顺序与您的四元数矢量顺序一致。

# android - 从 WebService 检索坐标时为 OverlayItem 设置动画

> ID：11569196
> 
> 赞同：2
> 
> 时间：2012-07-19T20:59:24.080
> 
> 标签：android, android-mapview, overlayitem

我正在使用网络服务来跟踪汽车位置，并在地图上显示汽车位置，并带有叠加项目。我可以通过删除/添加overlayItem来刷新汽车的位置，但是我想将它从旧坐标动画到新坐标而不将其从地图中删除。可能吗 ？

# objective-c - 当 UIProgressView 已满时加载新视图

> ID：11569200
> 
> 赞同：1
> 
> 时间：2012-07-19T20:59:35.153
> 
> 标签：objective-c, ios, xcode, uinavigationcontroller, uiprogressview

所以我有一个 UIProgressView 作为一种加载栏。父 UIView 在导航控制器内，当 UIProgressView 已满时，我想转到导航层次结构中的下一个视图。关于如何做到这一点的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:33:29.487

您的进度视图可能会定期由 NSTimer 填充，对吗？

假设您想在十秒钟内将其分为十个部分。

每个 NSTimer 滴答都会添加：

```
progress = progress + 0.1;
if (progress == 1.0) {
[self.navigationController pushViewController:viewController animated:YES];
} 
```

进度是控制 UIProgressView 填充率的任何东西，而 viewController 是你的 viewController。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:05:39.590

[ self.navigationController pushViewController:yourViewController 动画：YES ]; ?

# azure - 3 个月 Windows Azure 试用在 3 周内被禁用

> ID：11569201
> 
> 赞同：2
> 
> 时间：2012-07-19T20:59:40.460
> 
> 标签：azure, statistics, trial, hosted

我的 3 个月试用帐户 Windows Azure 已在 3 周内被禁用。这怎么可能？我的项目中什么都没有，只有一个简单的 Asp.Net 网页。

我认为没有人知道我的页面并不断提出请求。

我在管理门户上找不到统计部分来检查我的流量...等等。

有人知道我在哪里可以查看托管服务的统计信息吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:05:27.360

该试用版每月提供 750 个计算小时。一旦你部署了你的应用程序，仪表就会滴答作响。也就是说，只要部署了某些东西，它就是一个计量资源。无论是消耗 0% 还是 100% 的 cpu/网络/内存，您都按小时付费。

现在：如果您为您的 asp.net 站点部署了一个小型实例，那么您不应该在 3 周内消耗 750 小时。您是否可以使用 Medium 实例进行部署？还是部署了 2 个小型实例？您的部署中是否有多个角色（因为每个角色至少有一个实例）？

在进行开发工作时，我给出的一点建议是：在一天结束时，当您不积极从事项目时，请删除部署（您以后总是可以重新部署到同一个地方）。这有助于节省大量时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:02:47.200

您无需根据对托管服务（即计算实例）的访问付费。只要你在那里部署了一些东西，你就会被收费。没有人可以去它，它仍然需要你花钱。

在门户网站上，您必须删除那里拥有的所有托管服务才能保留积分。例如，如果您同时拥有 Production 和 Staging 实例，他们会向您收取两者的计算小时数。您必须实际删除实例才能节省账单上的计算时间。

至于统计信息，我知道的获取访问统计信息的唯一方法是使用 azure 诊断功能。他们过去在账单上有更多详细信息（进/出转账等），但现在账单要短得多。

# css - CSS：如何使 div 与高度受限的图像大小相同

> ID：11569206
> 
> 赞同：3
> 
> 时间：2012-07-19T21:00:09.223
> 
> 标签：css, html

我一直在尝试使 div 与图像的大小完全相同，但我不知道图像的纵横比，我希望图像适合网页的整个高度。

我在 jsfiddle 使用 display:inline-block 进行了一些实验

[http://jsfiddle.net/jxKqp/4/](http://jsfiddle.net/jxKqp/4/)

虽然在 chrome 中加载网页时看起来不错，但如果调整网页大小，则无法正确符合。在Firefox中它根本不起作用。也许有更好的方法来将 div 约束到图像？

这是类似的内联代码

```
<!HTML>
<html>
 <head>
 <style type="text/css">
 .background_image {
   height:100%;
   width:auto;
   border: 5px solid #ff0000;
 }
 body {
  overflow:hidden;
 }
 div.container {
   position:relative;
   display:inline-block;
      border: 5px solid #00ff00;
  }
  div.inner {
     position:absolute;
     top:0;bottom:0;left:0;right:0;
     border: 5px solid #0000ff;
     border-style:groove;
     z-index:2;
     background:black;
     color:white;
     opacity:.5
}
</style>
</head>
<body>
<div class="container"> 
  <img    src="http://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Henry_ford_1919.jpg/470px-Henry_ford_1919.jpg" class="background_image"/>
  <div class="inner">
    I want to be same size as the image
  </div>
</div> 
```

​ `

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:04:37.650

取出所有这些东西：

```
 .background_image {
   height:100%;
   width:auto;
   border: 5px solid #ff0000;
 }
 body {
  overflow:hidden;
 } 
```

[演示](http://jsfiddle.net/jxKqp/6/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:09:40.963

如果您希望 div 在调整大小时进行调整，我相信您将需要 JavaScript。你可以很容易地使用 jQuery 的 resize() 函数来做你正在谈论的事情。

我将以下代码添加到您的小提琴中：

```
$(document).ready(function(){
    $(window).resize(function(){
        $('.inner').height($(window).height());
    });        
});​ 
```

这会将 div 的大小调整为窗口的高度（这也将是您定义的图像的高度）。

在此处查看新小提琴：http: [//jsfiddle.net/jxKqp/7/](http://jsfiddle.net/jxKqp/7/)

# mongodb - 在 Lithium 和 MongoDB 中使用嵌套文档/数组

> ID：11569208
> 
> 赞同：3
> 
> 时间：2012-07-19T21:00:20.303
> 
> 标签：mongodb, mongodb-php, lithium

我对 MongoDB 和 Lithium 都是新手，我真的找不到处理嵌套文档的“好方法”。我注意到当我尝试

```
$user = Users::find('first' ... );
$user->somenewfield = array('key' => 'val'); 
```

我为“somenewfield”得到的是一个 Document 对象。但是还有一个 DocumentArray 类——它们之间有什么区别？

当我打电话

```
$user->save(); 
```

这导致Mongo（如预期的那样）：

```
"somenewfield" : { 
 "key": "value" 
} 
```

好的，但是当我以后想向数组添加一个新的键值并尝试时

```
$user->somenewfield['newkey'] = 'newval';
var_dump($user->somenewfield->to('array')); // shows the old and the new key-value pairs
$user->save(); // does not work - the new pair is not added 
```

使用锂向文档添加新数组的正确方法是什么？更新数组/向数组添加新值的正确方法是什么？我应该给数组值一个键吗？

我在这里先向您的帮助表示感谢。我有点卡住了......阅读文档，阅读代码......但在某些时候很难单独找出所有内容:)

编辑：最后我发现我使用嵌套数组的方式是使用 $push 和 $pull：

```
Users::update(array('$push' => array('games' => (string) $game->_id)), 
  array(
    '_id' => $this->user()->_id, 
    'games' => array('$ne' => (string) $game->_id)), 
  array('atomic' => false)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-30T12:24:54.733

我认为处理子文档有一些怪癖，您可以尝试：

```
$somenewfield = $user->somenewfield;
$somenewfield->newkey = newvalue;
$user->somenewfield = $somenewfield;
$user->save(); 
```

或替代语法：

```
$user->{'somenewfield.newkey'} = $newvalue;
$user->save(); 
```

您应该能够在测试中找到更多示例（在文档的任何测试中查看测试/数据）。

# objective-c - 使用 Segue 传递对象

> ID：11569215
> 
> 赞同：1
> 
> 时间：2012-07-19T21:00:58.757
> 
> 标签：objective-c, xcode, properties, segue, cs193p

我无法理解 segues 以及它们如何工作和传递对象。基本上我有一个计算器，并试图绘制存储在数组中的对象。到目前为止，我有一个名为 Brain 的对象，它是 CalculatorBrain 的一个实例。现在，brain 有一个 NSArray 属性，我将其用作堆栈来存储变量。假设我将值 3 和 5 添加到数组中，然后想要继续。我将我的 segue 选择到一个名为“Graph”的按钮上，所以当我单击该按钮时，它会继续。我如何将大脑传递给我正在使用的新视图控制器？我有一个名为 setGraphingPoint 的属性，它在我认为应该接受传递的对象的新视图控制器中定义。另外，如果我通过一个 segue 传递大脑，值 3 和 5 会随之传递，还是会创建一个新的 CalculatorBrain 对象？这是我到目前为止所拥有的。

这是在新的视图控制器中定义的

```
@property (nonatomic, strong) CalculatorBrain *graphingPoint;
@synthesize graphingPoint = _graphingPoint;

-(void) setGraphingPoint:(CalculatorBrain*) graphingPoint{

_graphingPoint = graphingPoint;
[self.graphingView setNeedsDisplay];

} 
```

这是从旧的视图控制器调用的，它将有按钮来继续

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

if([segue.identifier isEqualToString:@"Graph"])
    [segue.destinationViewController setGraphingPoint:[self.brain program]]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:44:13.637

您可以使用协议。例如，你可以让你的 prepareForSegue 看起来像这样：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    id destination = segue.destinationViewController;
    if([destination conformsToProtocol:@protocol(GraphPointUsing)])
        [destination setGraphingPoint:[self.brain program]];
} 
```

然后，您只需要确保您要遵循的 ViewController 符合`GraphPointUsing`.

如果您不想使用协议，但仍想调用方法，`GraphPoint`可以这样做：

```
//In new ViewController suppose we want to call the method `foo` on `GraphPoint`
[self.graphingPoint foo];

//Or if we want to call a setter we can do
[self.graphingPoint setFoo:5]; 
```

# c - 如何调整位图大小

> ID：11569217
> 
> 赞同：2
> 
> 时间：2012-07-19T21:01:05.567
> 
> 标签：c

```
 // determine padding for scanlines
int padding =  (4 - (bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;

// iterate over infile's scanlines
for (int i = 0, biHeight = abs(bi.biHeight); i < biHeight; i++)
{
    for(int q = 0; q < n; q++)
    {
        // iterate over pixels in scanline
        for (int j = 0; j < bi.biWidth; j++)
        {
            // temporary storage
            RGBTRIPLE triple;

            // read RGB triple from infile
            fread(&triple, sizeof(RGBTRIPLE), 1, inptr);

            // write RGB triple to outfile
            for (int r = 0; r < n; r++)
                fwrite(&triple, sizeof(RGBTRIPLE), 1, outptr);

        }

    // skip over padding, if any
    fseek(inptr, padding, SEEK_CUR);

    //then add it back (to demonstrate how)
    for (int k = 0; k < padding; k++)
        fputc(0x00, outptr);
   }
} 
```

我正在尝试更改代码，以便可以将 bmp 的大小调整 n 倍（将 n 三倍添加到宽度和高度）。我找到了一种方法来迭代一个将调整宽度的 for 循环：`for (int r = 0; r < n; r++)`。我试图对高度做同样的事情，但我不知道为什么它不起作用。 `for (int q = 0; q < n; q++)`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:43:44.807

在行级别，您应该在单次读取像素`n`后对其进行写入。这是通过添加另一个内部循环来完成的。该复制的像素在`triple`操作期间驻留在 var 中。

在文件级别，您应该重复处理单行，多次读取和写入。

如果您的输入文件在磁盘上，它应该支持倒带。因此，您可以读取该行，写入它（在里面复制像素，如上所示），然后将文件倒回到该行的开头，再次读取该行，写入它，等等。

尝试在读取该行之前存储文件位置，并在每次需要处理时`ftell`将文件位置倒回到该点。`fseek`

# php - 如何覆盖/重载 BaseUser 的设置器（来自 FosUserBundle）？

> ID：11569218
> 
> 赞同：1
> 
> 时间：2012-07-19T21:01:05.090
> 
> 标签：php, symfony, fosuserbundle

我正在使用 Symfony 2.0。

我有一个从 BaseUser 扩展的 Employee 类

我需要覆盖`setUsername`方法（除其他外）：

我的方法是 Employee.php 是这样的：

```
public function setUsername()
{
    $name=$this->getName();

    $this->username=($name);//just an example
} 
```

但是当我清除缓存时出现错误：

```
MyBundle\Entity\Employee::setUsername() must be compatible with that of FOS\UserBundle\Model\UserInterface::setUsername() 
```

编辑：
我已经看到 FOS\UserBundle\Model\UserInterface 中的方法 setUsername 需要`$username`参数，但是我`setUsername`定义的函数不需要这个参数。更一般地说，我的问题是如何重新定义/覆盖方法以及如何将他自己的约束添加到 Fos User 中定义的字段和方法中。非常感谢

如何覆盖此功能？我试过`parent::setUsername()`但我有一个解析错误：

```
PHP Parse error:  syntax error, unexpected T_PAAMAYIM_NEKUDOTAYIM, expecting '(' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:07:53.393

函数定义为：

```
function setUsername($username); 
```

因此，您的功能必须相同，但您的功能缺少参数。添加它，你应该没问题。

这实际上与 Symfony2 或 FOS Bundle 无关，这就是 PHP 通常的工作方式。所以试着更正确地理解错误信息。并且下次看到你不完全理解的错误信息时，具体询问错误信息和你不清楚的部分。只是说：直接询问您*想*了解的部分。与您*尝试*做的部分无关（尝试并没有错，只是说，我们都在边做边学。但关键是要提出正确的问题；））

# c# - 类型或命名空间名称不存在

> ID：11569220
> 
> 赞同：1
> 
> 时间：2012-07-19T21:01:10.023
> 
> 标签：c#, asp.net-mvc-3

我知道这个网站上有几个类似的主题，但我找不到有效的解决方案。我有一个名为“SportsStore”的解决方案，它包含 3 个项目，所有项目都使用完整的 .NET 4 框架。这些项目被命名为“SportsStore.Domain”、“SportsStore.UnitTests”和“SportsStore.WebUI”。

在“SportsStore.WebUI”项目中，我创建了一个名为“Infrastructure”的文件夹，其中有一个名为“NinjectControllerFactory.cs”的类。它的完整代码如下。请注意顶部的最后一个“使用”语句：“使用 SportsStore.Domain.Abstract”。我的程序不会编译，它告诉我命名空间不存在。Intellisense 识别“SportsStore”，但只说“WebUI”是我的下一个选择。它根本无法识别“SportStore.Domain”。我已经尝试清理、重建、关闭、打开、重新启动、将所有项目的框架更改回客户端，然后返回完整，但似乎没有任何效果。

底线是我正在尝试访问我的 IProductRepository.cs 存储库文件，该文件是“SportsStore.Domain”项目中 SportsStore.Domain.Abstract 命名空间的一部分。

我希望这很容易纠正？提前致谢！

```
using System;
using System.Collections.Generic;
using System.Web.Mvc;
using System.Web.Routing;
using System.Linq;
using Ninject;
using Moq;
using SportsStore.Domain.Abstract;

//To begin a project that uses Ninject and/or Moq (mocking data) you
//need to add reference to them.  Easiest way is to select 'View', then
//'Other Windows', and 'Package Manager Console'.  Enter the commands:
//Install-Package Ninject -Project SportsStore.WebUI
//Install-Package Ninject -Project SportsStore.UnitTests
//Install-Package Moq -Project SportsStore.UnitTests

//We placed this file in a new folder called 'Infrastructure' within the 
//'SportsStore.WebUI' project.  This is a standard way to define what we
//need to do with Ninject since we are going to use Ninject to create our
//MVC application controllers and handle the dependency injection (DI).
//To do this, we need to create a new class and make a configuration
//change.

//Finally we need to tell MVC that we want to use this class to create
//controller objects, which we do by adding a statement to the 
//'Global.asax.cs' file in this 'SportsStore.WebUI' project.

namespace SportsStore.WebUI.Infrastructure
{
public class NinjectControllerFactory : DefaultControllerFactory
{
    private IKernel ninjectKernel;

    public NinjectControllerFactory()
    {
        ninjectKernel = new StandardKernel();
        AddBindings();
    }

    protected override IController GetControllerInstance(RequestContext requestContext, Type controllerType)
    {
        return controllerType == null
            ? null
            : (IController)ninjectKernel.Get(controllerType);
    }

    private void AddBindings()
    {
        //During development, you may not want to hook your IProductRepository to
        //live data yet, so here we can create a mock implementation of the data
        //and bind it to the repository.  This is MOQ in work - great tool to allow
        //you to develop real code and make it think it's using the live data.  This
        //uses the 'System.Linq' namespace
        Mock<IProductRepository> mock = new Mock<IProductRepository>();
        mock.Setup(m => m.Products).Returns(new List<Product>
        {
            new Product { Name = "Football", Price = 25 },
            new Product { Name = "Surf board", Price = 179 },
            new Product { Name = "Running shoes", Price = 95 }
        }.AsQueryable());
        ninjectKernel.Bind<IProductRepository>().ToConstant(mock.Object);
    }
 }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:13:56.860

为了让一个类访问在另一个程序集中声明的类型，您必须**引用**它们。如果您使用的是 Ninject（我想），那么您已经对 Ninject 程序集执行了此操作。

即使`Domain`是您的程序集，在同一个解决方案上，您也必须在 处引用它`WebUI`，否则它们将不会互相认识。

所以，让我们确保：

1.  右键单击您的`WebUI`项目
2.  选择**添加参考**
3.  转到**项目**选项卡
4.  选择`Domain`项目
5.  完毕！

重建，你很高兴！

问候

# entity-framework - 如何访问具有无法使用 Code First 建模的复合键的表？

> ID：11569224
> 
> 赞同：2
> 
> 时间：2012-07-19T21:01:16.527
> 
> 标签：entity-framework, ef-code-first, poco, code-first, entity-framework-5

我有一个无法更改但想使用 EF 访问的现有数据库。对于 90% 的数据库，我已经能够让 Code First EF 工作，这给我留下了非常深刻的印象。

我遇到了一个案例，我想知道如何通过导航属性建模或访问数据。

在一种情况下，表格是这样的（这个例子完全是虚构的，但代表了问题）：

```
CREATE TABLE Dog (
    id            INTEGER      PRIMARY KEY,
    name          VARCHAR(50)  NULL,
    breed_id      INTEGER      NOT NULL
);

CREATE TABLE Breed (
    id               INTEGER      NOT NULL,
    organization_id  INTEGER      NOT NULL,
    description      VARCHAR(100) NOT NULL, 
    Primary key (id, organization)
);

CREATE TABLE Organization (
    id            INTEGER      PRIMARY KEY,
    description   VARCHAR(100) NOT NULL
); 
```

在表品种中，组织代表已定义品种的组织。一只狗可以有多个品种，但程序只显示一个，结果由组织 ID“过滤” - 这是在设置程序时配置的值。

可能存在的数据示例如下：

```
id    organizationID    Description
 1                 1    Basset Hound
 2                 1    Great Dane
 2                 2    Grande Dane 
```

组织 2 选择将品种称为与组织 1 不同的东西。唯一的主键是 id 和组织 ID 的组合。狗有一个品种，但没有定义一个或多个相关组织的属性。它从另一个表中获取附加信息，或者从配置值（可能是枚举值）中获取狗的品种。

在我的例子中，要找到一个特定的狗品种，你必须有一个狗 id 和另一个与程序配置相关的信息（organization_id）。

狗、品种和组织类如下所示：

```
public class Dog {
  public int id  { get; set; };
  public string name  { get; set; };
  public int breedID  { get; set; };

  public virtual Breed { get; set; }           
}

public class Breed {
  public int id  { get; set; };
  public int organizationID  { get; set; };            
  public string description  { get; set; };

  public virtual Organization { get; set; }  
}

public class Organization {
  public int id  { get; set; };
  public string description  { get; set; };
} 
```

从代码中可以看出，我想在 Dog 上使用返回品种的“导航”属性，但不要认为我可以先在代码中配置它。

我尝试了一些不同的东西（在流利的 API 中，并把组织排除在外——因为这很容易）并且还会记录我认为不起作用的东西：

```
1) 
   modelBuilder.Entity<Dog>().HasKey(t => t.id);
   modelBuilder.Entity<Breed>().HasKey(t => t.id);
   modelBuilder.Entity<Dog>().HasRequired(d => d.Breed).WithMany().HasForeignKey(d => d.breedID); 
```

当然，这样做的问题是将返回多个品种并且实体框架将抛出​​异常，因为品种ID 本身不足以产生模型所要求的单个值。

```
2) 
   Change class dog:
      Remove:
          public virtual Breed { get; set; }
      Add:
          public virtual ICollection<Breed> Breeds { get; set; }

          public Breed Breed {
            get {
              // Assume 1 is configured organization value
              return Breeds.Single(t => t.OrganizationId == 1);
            };
            set {
              Breeds.Add(value);
            }
          }

     Change model:
        I don't know how to do this for the given classes.  Since it's a Collection, it must look something like

        modelBuilder.Entity<Dog>().HasMany(d => d.Breeds)...

        but I don't see how to specify that breedID is a foriegn key into the breed table. 
```

如果我能让模型工作，其余的都可以工作，但它确实看起来很奇怪而且效率低下。

```
 3)
    Change model to account for composite key (using first set of classes):
       modelBuilder.Entity<Breed>().HasKey(b => new { b.id, b.organizationId });

       modelBuilder.Entity<Dog>().HasRequired(t => t.Breed).WithMany().HasForeignKey(t => new { t.breedID, configuredValue }); 
```

我不知道如何像最后一行那样“注入”configuredValue，所以这也不起作用。

如果上述方法都不起作用，或者如果我找不到另一种方法来首先正确配置代码，那么我想指定当调用 Breed 导航属性 getter 时，它应该使用可以获取适当的查询繁殖并适当归还。

但是，我不想用 Context 调用弄脏我的 POCO 以返回查询结果。换句话说，我想在 Dog 上有一个看起来不像这样的属性：

```
public Breed Breed {
   get {
      return context.Breed.Where(b => b.id == this.id && b.organizationID == 1).Single();
   }
} 
```

理想情况下，它会像 Navigation 集合一样工作，EF 在其中发挥神奇作用并返回适当的结果。

直观地说，似乎我应该能够使用类似 POCO 的代码来配置它，或者使用/扩展代理来扩展配置以在调用访问器时使用我想要的特定查询。或者 - 似乎我应该能够在任何读取时填充属性并在写入时弄脏 POCO。我只是对 EF 不够熟悉，不知道如何做到这一点。

这可能吗？

作为第一篇文章的补充，因为我希望保持我的 POCO 类干净，我想我可能会实现 Repository 模式来封装我所描述的复杂查询，并支持其他操作。

查看我从 Code First 模型生成的 EDMX，也不清楚如何从数据库优先的角度实现该模型。

任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-29T15:46:42.220

简而言之，你不能那样做。你有不合逻辑的数据库结构（外键引用非唯一列），你必须将它映射到某个地方。您不能在 EF 配置中执行此操作，因为它是动态的，因此您必须在实体类中执行此操作。如果不直接调用实体类（或助手类）中的上下文，我认为没有办法做到这一点。

# javascript - 在 ios UI 自动化中滑动多个页面

> ID：11569226
> 
> 赞同：2
> 
> 时间：2012-07-19T21:01:28.107
> 
> 标签：javascript, automated-tests, ios-ui-automation

在 ios UI 自动化工具中工作，我目前被卡住了。我的问题是我正在尝试在 javascript 中的页面之间自动进行水平滑动，但我似乎无法让它工作。

我努力了：

“dragInsideWithOptions”

“flickInsideWithOptions”

“dragToFromDuration”

“flickFromTo”

target.dragFromToForDuration({x:50.00, y:200.00}, {x:300.00, y:200.00});

一个不断发生的问题是，当我只想让它定位到窗口上的某个位置以实际更改为新页面时，它一直定位到顶部导航栏。我在 UI 自动化的参考资料中看到的唯一信息涉及 rects()，似乎每次我指定 {x:, y:}{x:, y:} 坐标时，它都认为我在谈论工具栏或导航栏。它不在滚动视图中，所以我根本无法滚动“左”或“右”。我可以调用另一个函数来允许我的测试移动到不同的页面吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-10T10:37:30.233

试试这个，它对我来说非常有用：

伪代码： 1\. 确定要在其上执行滑动手势的单元格。例如：在表格视图单元格上执行滑动。2\. 通过点击单元格的开始和结束来记录事件以获得开始和结束的偏移量。

通过查看记录的点击事件，您可以在您选择 tapWithOptions 方法时获得点击偏移量。

例如：你会得到 tapWithOptions({tapOffset:{x:1.07, y:0.65}});

然后记下偏移量作为起始偏移量。例如：{startOffset:{x:0.03, y:0.44}

同样，对从末端抽头点的末端偏移执行上述操作。

例如：endOffset:{x:0.81, y:0.50}

一旦你得到了那个单元格的源和结束偏移量，

1.  对上述偏移量使用 dragInsideWithOptions 方法。

dragInsideWithOptions({startOffset:{x:0.03, y:0.44}, endOffset:{x:0.81, y:0.50},duration:1}

最后它看起来像下面这样： app.mainWindow().tableViews()["UBSTableView"].cells()[0].dragInsideWithOptions({startOffset:{x:0.03, y:0.44}, endOffset:{x:0.81 , y:0.50},持续时间:1}); app.mainWindow().tableViews()["UBSTableView"].cells()[0].buttons()[0].tap();

希望对大家有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-17T09:35:54.710

如果您使用的是 iOS7 模拟器，那么这些方法将不起作用。但是这些方法在设备上完全可以。尝试在设备上运行您的代码。希望对你有帮助

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-13T12:28:08.467

尝试使用超时值更新您的 dragFromToDuration 调用：

```
target.dragFromToForDuration({x:50.00, y:200.00}, {x:300.00, y:200.00}, 3); 
```

我希望这将有所帮助。

# sql - 将相关子查询转换为 JOIN

> ID：11569227
> 
> 赞同：2
> 
> 时间：2012-07-19T21:01:34.177
> 
> 标签：sql, oracle11g

我有一个相关的子查询，它会产生性能问题。作为一个相关的子查询，它也不接受索引提示。所以我试图将其转换为 JOIN 。请在下面找到原始查询和修改后的查询。修改后的查询不返回任何行，但原始查询返回 224 行。

如果在这种情况下使用 JOIN 而不是子查询甚至有意义，请了解我的 JOIN 查询有什么问题。谢谢。

```
select Area_CODE,
       due_DATE,
       RATE,

from SCHED S
where (s.Area_CODE = 11001 and 
   (s.COMP_CODE = 'a' 
   or
      (s.COMPANY_CODE = 'b' 
          and s.due_DATE <
          (
           select
               nvl( min(s1.due_DATE), to_date  ( '31-DEC-2999', 'DD-MM-YYYY') )
               from   SCHED s1
               where  s1.AREA_CODE = s.AREA_CODE 
               and s1.COMP_CODE = 'c'
          )
       )
    )
   )
order by a.EFF_DATE asc, s.due_DATE asc 
```

**修改后的查询：**

```
SELECT
  Area_CODE,
       due_DATE,
       RATE

from SCHED S
LEFT JOIN
  (
    SELECT
      NVL( MIN(s1.due_DATE), to_date ( '31-DEC-2999', 'DD-MM-YYYY') ) AS
      min_date,
      s1.AREA_CODE AS a_code
    FROM
      SCHED s1
    WHERE
      s1.COMPANY_CODE = 'c'
    GROUP BY
      s1.AREA_code
  )
  s2
ON
  s2.A_CODE = s.area_code
WHERE
  (
    s.area_code = 11001
  AND
    (
      s.COMP_CODE = 'a'
    OR
      (
        s.COMP_CODE = 'b' 
      and s.due_DATE < s2.min_date
      )
    )
  )
order by s.EFF_DATE asc, s.due_DATE asc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:47:46.467

不同之处在于给定区号没有日期

将左连接 (s2) 更改为内部连接

```
inner JOIN 
( 
    SELECT 
        min(s1.due_DATE) AS min_date, 
        s1.AREA_CODE AS a_code 
    FROM 
        (
            select Area_Code, due_date from SCHED WHERE COMPANY_CODE = 'c' 
            union
            select Area_Code, to_date('31-dec-2999','DD-MM-YYYY') from SCHED
        ) s1    
    GROUP BY 
        s1.AREA_code 
) s2 
```

# iphone - UIBarButtonItem 外观 iOS5 字体

> ID：11569230
> 
> 赞同：0
> 
> 时间：2012-07-19T21:01:38.327
> 
> 标签：iphone, objective-c, ios, uibarbuttonitem

我正在使用如下所示的一小段代码来更改导航栏标题应用程序的文本属性，并且效果很好。

```
[[UINavigationBar appearance] setTitleTextAttributes:
     [NSDictionary dictionaryWithObjectsAndKeys:
      [UIColor whiteColor], UITextAttributeTextColor,
      [UIColor grayColor], UITextAttributeTextShadowColor,
      [NSValue valueWithUIOffset:UIOffsetMake(0, -1)], UITextAttributeTextShadowOffset,
      [UIFont fontWithName:@"Cochin-BoldItalic" size:0.0], UITextAttributeFont,
      nil]]; 
```

但我也希望能够轻松地为 UIBarButtonItem 文本执行此操作，但我无法弄清楚，因为它不共享它出现的相同或相似的方法。

## 编辑

尝试了这段代码，没有对文本进行任何更改：

```
[[UIBarItem appearance] setTitleTextAttributes:
     [NSDictionary dictionaryWithObjectsAndKeys:
      [UIColor whiteColor], UITextAttributeTextColor,
      [UIColor grayColor], UITextAttributeTextShadowColor,
      [NSValue valueWithUIOffset:UIOffsetMake(0, -1)], UITextAttributeTextShadowOffset,
      [UIFont fontWithName:@"Cochin-BoldItalic" size:12.0], UITextAttributeFont,
      nil]
     forState:UIControlStateNormal]; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T21:13:13.150

您想使用 UIBarItem 的`- (void)setTitleTextAttributes:(NSDictionary *)attributes forState:(UIControlState)state`方法（UIBarButtonItem 继承自 UIBarItem）。

查看文档了解更多详情：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIBarItem_Class/Reference/Reference.html#//apple_ref/occ/cl/UIBarItem](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIBarItem_Class/Reference/Reference.html#//apple_ref/occ/cl/UIBarItem)

试试这个：

```
//Suppose you have initialized barButton elsewhere`
[barButton setTitleTextAttributes:
     [NSDictionary dictionaryWithObjectsAndKeys:
      [UIColor whiteColor], UITextAttributeTextColor,
      [UIColor grayColor], UITextAttributeTextShadowColor,
      [NSValue valueWithUIOffset:UIOffsetMake(0, -1)], UITextAttributeTextShadowOffset,
      [UIFont fontWithName:@"Cochin-BoldItalic" size:12.0], UITextAttributeFont,
      nil]
     forState:UIControlStateNormal]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-29T08:41:42.930

这似乎适用于 iOS 7.1：

```
[[UIBarButtonItem appearance] setTitleTextAttributes:@{NSForegroundColorAttributeName:[UIColor whiteColor],
                                 NSFontAttributeName:[UIFont fontWithName:@"Resamitz" size:16.0]}
                                            forState:UIControlStateNormal]; 
```

# c# - Oracle存储过程将多个结果集返回到.net

> ID：11569234
> 
> 赞同：1
> 
> 时间：2012-07-19T21:02:01.227
> 
> 标签：c#, .net, stored-procedures, oracle11g

我编写了以下存储过程以将多个数据集返回到我的前端 .Net 应用程序

```
create or replace PROCEDURE GET_EMPLOYEE_INFO 
(
  EMP_NO IN VARCHAR2,
  E_RECORD_SET1 OUT SYS_REFCURSOR,
  E_RECORD_SET2 OUT SYS_REFCURSOR,
  E_RECORD_SET3 OUT SYS_REFCURSOR,
  E_RECORD_SET4 OUT SYS_REFCURSOR
) AS 
BEGIN
  OPEN E_RECORD_SET1 FOR
    SELECT * FROM EMP.EMPLOYEES;

  OPEN E_RECORD_SET2 FOR
    SELECT * FROM EMP.CITIES;

  OPEN E_RECORD_SET3 FOR
    SELECT * FROM EMP.STATES;

  OPEN E_RECORD_SET1 FOR
    SELECT * FROM EMP.DURATION; 
```

每个查询都可以自行正确执行。当我执行存储过程时，它会显示结果集，但我不相信正在获取所有数据。在底部，它仍然显示“RUNNING IDE CONNECTION”。

*   程序是否循环？
*   类型有限制`SYS_REFCURSOR`吗？
*   我需要关闭这些游标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:21:28.647

*   我假设您的实际存储过程`END`最后没有丢失。您发布的代码不会编译。
*   我假设您的存储过程也在使用`EMP_NO`参数做一些事情。
*   我假设尽管名称暗示它是一个数字，但`EMP_NO`实际上被声明为一个字符串。

假设一切都是真的

*   为什么你认为所有数据都没有被获取？
*   “在底部，它仍然说”这句话所指的“它”是什么？这是您的 C# 应用程序吗？你骑？还有什么？
*   您发布的代码（假设`END`添加了它以便编译）不能循环。您的代码只是打开游标，不执行 SQL 语句，也不生成任何数据。在客户端应用程序开始获取数据之前不会发生这种情况。
*   尽管这是一个不寻常的设计，但拥有一个返回四个`SYS_REFCURSOR`参数的过程在语法上是完全有效的。这不会影响从游标中获取的数据。
*   是的，您的客户端应用程序需要在从它们获取所有数据后关闭这些游标。

# java - javamail 不工作。出现消息异常

> ID：11569235
> 
> 赞同：1
> 
> 时间：2012-07-19T21:02:01.970
> 
> 标签：java, jakarta-ee, classformaterror

我正在执行以下代码以使用 javamail 在 gmail 上发送电子邮件。

```
import java.util.Properties;
import javax.mail.*;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class JavaApplication1 {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put("mail.smtp.host", "smtp.gmail.com");
        props.put("mail.smtp.socketFactory.port", "465");
        props.put("mail.smtp.socketFactory.class",
                "javax.net.ssl.SSLSocketFactory");
        props.put("mail.smtp.auth", "true");
        props.put("mail.smtp.port", "465");

        Session session = Session.getDefaultInstance(props,
            new javax.mail.Authenticator() {
                protected PasswordAuthentication getPasswordAuthentication() {
                    return new PasswordAuthentication("goods.ramesh","mypassword");
                }
            });

        try {

            Message message = new MimeMessage(session);
            message.setFrom(new InternetAddress("goods.ramesh@gmail.com"));
            message.setRecipients(Message.RecipientType.TO,
                    InternetAddress.parse("goods.ramesh@yahoo.com"));
            message.setSubject("Testing Subject");
            message.setText("Dear Mail Crawler," +
                    "\n\n No spam to my email, please!");

            Transport.send(message);

            System.out.println("Done");

        } catch (MessagingException e) {
            throw new RuntimeException(e);
        }
    }
} 
```

但我收到以下错误堆栈跟踪：

```
java.lang.ClassFormatError: Absent Code attribute in method that is not native or abstract in class file javax/mail/MessagingException
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
    at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
    at java.lang.Class.getMethod0(Class.java:2685)
    at java.lang.Class.getMethod(Class.java:1620)
    at sun.launcher.LauncherHelper.getMainMethod(LauncherHelper.java:484)
    at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:476)
Exception in thread "main" Java Result: 1 
```

我没有得到 MessagingException 正在做什么以及它发生的原因。任何机构都可以帮助我摆脱这个例外吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-05T21:59:22.627

我有同样的 ClassNotFound 问题。我已经通过以下 POM 设置解决了

```
 <dependency>
        <groupId>javax</groupId>
        <artifactId>javaee-api</artifactId>
        <version>6.0</version>
        <type>jar</type>
        <scope>provided</scope>            
    </dependency> 

    <dependency>
        <groupId>org.glassfish.main.extras</groupId>
        <artifactId>glassfish-embedded-all</artifactId>
        <version>3.1.2</version>
    </dependency> 
```

我在我的 EJB UnitTesting 中使用了这个版本的*glassfish-embedded-all*，所以我的理解是这个 jar 包含 Java EE API 所需的所有类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:11:00.830

您可能使用了不包含任何内容的错误版本的 javaee.jar。

看看这篇文章：[http ://www.mkyong.com/hibernate/java-lang-classformaterror-absent-code-attribute-in-method-that-is-not-native-or-abstract-in-class -文件/](http://www.mkyong.com/hibernate/java-lang-classformaterror-absent-code-attribute-in-method-that-is-not-native-or-abstract-in-class-file/)

M。

# c# - 导致代码在运行时在不使用 PrepareMethod 的情况下进行预 JIT

> ID：11569238
> 
> 赞同：3
> 
> 时间：2012-07-19T21:02:13.007
> 
> 标签：c#, windows-phone-7, xna, jit

我需要使我的应用程序中的一些代码被预先JITted。该场景是在 Windows Phone 下运行的 XNA 游戏。当爆炸第一次发生时，当实现爆炸物理建模的方法被 JITted 时，会有一个明显的停顿。我知道这一点，因为这个问题也发生在 Windows 版本上，并且在程序集被 NGEN 时消失。我还使用了运行时 JITting 的方法，这里的一些答案中提到了该方法，[起源于 CodeProject](http://www.codeproject.com/Articles/31316/Pre-compile-pre-JIT-your-assembly-on-the-fly-or-tr)（使用反射和[`PrepareMethod`](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.runtimehelpers.preparemethod.aspx)）。

但是，我不能使用 NGEN，因为它是一个 Windows Phone 应用程序。我也不能使用`PrepareMethod`标记为的其他方法`SecurityCritical`，并且您不能在 Windows Phone 上调用它。

我不介意这可能需要一些时间，因为在显示加载屏幕时初始化将在单独的线程上发生。

是否有任何优雅的方法可以达到类似的结果，如果失败了，还有任何方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:06:56.867

到目前为止，在 Windows Phone 中，您唯一能做的就是强制该方法被 JITed 是通过实际调用它。

我会在您的应用程序加载时调用该方法，也许是在它显示加载屏幕或其他内容时。这样当用户在游戏中实际点击它时，JIT 已经被处理好了。

# objective-c - EXC_BAD_ACCESS，但不是在使用断点时

> ID：11569241
> 
> 赞同：1
> 
> 时间：2012-07-19T21:02:21.883
> 
> 标签：objective-c, ios, exc-bad-access

我的应用程序崩溃了。它发生在dismissModalViewControllerAnimated：消息上，但是......如果我在NSLog上设置一个断点，然后跳过，它会出现问题，EXC_BAD_ACCESS代码是2并且地址0x4：

```
Thread 1: EXC_BAD_ACCESS(code=2, address=0x4) 
```

我从来没有使用断点和 EXC_BAD_ACCESS 没有它们，有什么想法吗？

请注意，我的 appController 很好。（未在任何地方发布）。

```
if (appController.modalViewController) {
    NSLog(@"==== RETAIN COUNT ====> %d", appController.modalViewController.retainCount);

    [appController.modalViewController dismissModalViewControllerAnimated:NO];
} 
```

将计数日志保留为**1**

这也只发生在 iOS 4.2 上，我的应用程序只在 iPad 上运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:29:28.983

`retainCount`没用。不要叫它。

如果发生崩溃，则有回溯。请张贴。

* * *

> 我从来没有使用断点和 EXC_BAD_ACCESS 没有它们，有什么想法吗？

一般表示竞态条件；您的代码取决于线程 A 在线程 B 达到某个特定状态之前是否完成某些事情。需要回溯。

# ajax - 如何在strut2中停止 当函数返回 false 时从提交表单

> ID：11569243
> 
> 赞同：1
> 
> 时间：2012-07-19T21:02:24.940
> 
> 标签：ajax, struts2, dojo

```
<%@ taglib prefix="s" uri="/struts-tags" %>
<%@ taglib prefix="sx" uri="/struts-dojo-tags" %>

 <html>
 <head>
  <sx:head cache="true" />
<script>
   myfunction(a, b)
  {
      if ( a> b) 
      return true;
      else
      return false;   

  }
 </script>

</head> 
```

……

```
 <s:form  action="saveXXXX"  >

  .... fields....                    

  <s:submit onclick="return myfunction(a, b);" />  //THIS ONE WORKS - NON AJAX
  <sx:submit onclick="return myfunction(a, b);" /> //Using sx ajax tag 
<sj:submit onclick="return myfunction(a, b);" id="formSubmit1" targets="formResult"  value="AJAX Submit" button="true" />  //if using Jquery Plugin ajax tag

 //how to stop form submittal if function returns false.    

  </s:form> 
```

该表单使用 s:submit .. 工作，但现在我正在尝试使用 sx:submit ... 或 jquery 的 sj:submit ... 对其进行 ajaxfy

我想根据函数返回的内容使用 AJAX 有条件地提交表单。

怎么做到呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T02:11:03.917

你试过'onsubmit="return myFunction();" ' 标签内的属性？

> ```
> <s:form action="actionName" onsubmit="return myFunction();">
> ...
> </s:form> 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T06:22:18.607

而不是使用提交按钮，而是使用一个简单的按钮

```
<s:form  action="saveXXXX"  name="myForm">
    <input type="button" onclick="myfunction(a, b);"/>
</s:form> 
```

在你的功能中

```
function myfunction(a, b){
if ( a> b) 
      document.myForm.submit();
} 
```

# java - 找不到符号 HttpClient

> ID：11569246
> 
> 赞同：2
> 
> 时间：2012-07-19T21:02:31.360
> 
> 标签：java, compiler-errors, httpclient

这些事情对我来说从来没有多大意义。我正在尝试使用这个类：

[http://www.devdaily.com/java/jwarehouse/commons-httpclient-2.0.1/src/java/org/apache/commons/httpclient/ChunkedInputStream.java.shtml](http://www.devdaily.com/java/jwarehouse/commons-httpclient-2.0.1/src/java/org/apache/commons/httpclient/ChunkedInputStream.java.shtml)

每次编译时都会出现一堆错误，例如：

```
> /ChunkedInputStream.java:85: cannot find symbol
> symbol  : class HttpMethod
> location: class .ChunkedInputStream
>     private HttpMethod method;
>             ^
> /ChunkedInputStream.java:96: cannot find symbol
> symbol  : class HttpMethod
> location: class .ChunkedInputStream
>         final InputStream in, final HttpMethod method) throws IOException {
>                                     ^
> /ChunkedInputStream.java:283: cannot find symbol
> symbol  : variable HttpConstants
> location: class .ChunkedInputStream
>         String dataString = HttpConstants.getString(baos.toByteArray());
>                             ^
> /ChunkedInputStream.java:303: cannot find symbol
> symbol  : class Header
> location: class .ChunkedInputStream
>         Header[] footers = HttpParser.parseHeaders(in);
>         ^
> /ChunkedInputStream.java:303: cannot find symbol
> symbol  : variable HttpParser
> location: class .ChunkedInputStream
>         Header[] footers = HttpParser.parseHeaders(in); 
```

我不应该访问这些对象吗，因为它是包 org.apache.commons.httpclient 的一部分；? 我还将 apache http 客户端 jars 添加到我的应用程序中。是什么赋予了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:04:42.733

您需要确保导入位于程序的顶部。在项目中拥有 jar 是不够的，除非这些类不在同一个包中，否则您需要将`import`这些类显式地添加到您的程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:09:29.977

从内存来看，HttpClient 对 HttpCore 和了解 apache 有（@ 至少一个）项目依赖，可能更多，比如 io-commons 和日志记录

我结束了链接

*   Apache-mime4j
*   Commons 编解码器
*   共享日志
*   Http客户端（4）
*   HttpCore (4)
*   HttpMime (4)

但这可能有点矫枉过正，但它对我有用

# .net - C++ 和 C++ Cli 不接受 .net 形式

> ID：11569252
> 
> 赞同：0
> 
> 时间：2012-07-19T21:02:50.407
> 
> 标签：.net, c++-cli, native, managed

首先，我有两个代码：

ManagedGlobalsDeclaration.h

```
#ifndef MGD_H
#define MGD_H

#include "Editor.h"
#include <vcclr.h>

using namespace System;
using namespace Cube3D;

namespace Cube3D {
    class ManagedGlobals
    {
        public: 
            gcroot<Editor ^> MainEditor;
    };
}

#endif 
```

编辑器.h

```
#ifndef EDITOR_H
#define EDITOR_H

#include "System.h"                     
#include "AddRenderingPipelineCommand.h"
#include "AddMaterial.h"                
#include "P_Material.h"             
#include "P_UMesh.h"                    
#include "Log.h"
#include "ManagedGlobals.h"             //     <------ Error!

#include <vcclr.h>

namespace Cube3D {

    using namespace System;
    using namespace System::ComponentModel;
    using namespace System::Collections;
    using namespace System::Windows::Forms;
    using namespace System::Data;
    using namespace System::Drawing;

    void LoopRender(void);
    void GetRenderingOrder(void);
    String^ GetListbox2Item();

    TextureObject InstancedTexturing[10];
    UMesh InstancedMesh[10];

    /// <summary>
    /// Summary for Editor
    /// </summary>
    ref class Editor : public System::Windows::Forms::Form
    {
        // Bla bla bla.... 
```

ManagedGlobals.h

```
#ifndef MG_H
#define MG_H

#include "ManagedGlobals_Declaration.h"

extern ManagedGlobals MG;

#endif 
```

但是我的编译器在 ManagedGlobalsDeclaration 中告诉我它不知道 Editor。ManagedGlobals 类在 ManagedGLobalsDeclaration.h 中声明，然后（在其他地方）实际定义，所以这就是为什么我制作一个标题只是为了使用 extern。但是为什么它不识别编辑器？

```
Error 29 error C2065: 'Editor' : undeclared identifier 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:08:22.243

你有一个循环包含。尝试使用前向声明：

```
#ifndef MGD_H
#define MGD_H

#include <vcclr.h>

using namespace System;
using namespace Cube3D;

namespace Cube3D {
    ref class Editor;

    class ManagedGlobals
    {
        public: 
            gcroot<Editor ^> MainEditor;
    };
}

#endif 
```

# java - 使用变换矩阵旋转顶点

> ID：11569253
> 
> 赞同：1
> 
> 时间：2012-07-19T21:02:54.893
> 
> 标签：java, lwjgl

我正在尝试使用 lwjgl [Matrix4f](http://lwjgl.org/javadoc/org/lwjgl/util/vector/Matrix4f.html)类旋转顶点。我试过这段代码：

```
 float rotY = (float) Math.toRadians(180);

    Matrix4f transMat = new Matrix4f();
    transMat.rotate(rotY, new Vector3f(0.0f, 1.0f, 0.0f));
    transMat.translate(new Vector3f(1.0f, 0.0f, 0.0f));

    Vector4f vecPosMod = new Vector4f(1.0f, 0.0f, 0.0f, 1.0f);
    Matrix4f.transform(transMat, vecPosMod, vecPosMod); 
```

它应该将 a 旋转`Vector3f(1.0f, 0.0f, 0.0f)`180 度，但不幸的是，经过所有计算 vecPosMod 是`(-2.0, 0.0, 1.7484555E-7, 1.0)`. 我希望它是`(-1.0, 0.0, 0.0, 1.0)`。如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T04:27:17.153

您在旋转后沿 X 轴对矩阵应用平移。这是在执行旋转后将位置沿 X 轴平移一个单位，导致 -2.0 而不是 -1.0。

尝试这个：

```
 float rotY = (float) Math.toRadians(180);

  Matrix4f transMat = new Matrix4f();
  transMat.rotate(rotY, new Vector3f(0.0f, 1.0f, 0.0f));

  Vector4f vecPosMod = new Vector4f(1.0f, 0.0f, 0.0f, 1.0f);
  Matrix4f.transform(transMat, vecPosMod, vecPosMod); 
```

它给出以下结果：

```
(-1.0 0.0 8.742278E-8 1.0) 
```

在 java 中应用带有浮点数的旋转变换后，8.742278E-8 可能接近 0.0。

# css - iphone/ipad 上的背景图片 css 问题（无响应）

> ID：11569254
> 
> 赞同：0
> 
> 时间：2012-07-19T21:03:00.213
> 
> 标签：css, ios

我有一个网站，虽然没有响应，但在 iphone 或 ipad 上查看时应该只显示桌面网站的缩放版本。问题是我的主要背景图像由于某种原因被压缩。如果我调整浏览器的大小，我将无法重现这个问题，所以我只是在努力找出导致它的 iOS 上发生了什么。该网站是 - 任何帮助将不胜感激！

添加信息：问题似乎与 div.bg-main 及其背景图像设置有关，设置在 style.css 的第 243 行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:23:32.460

iOS 对背景图像有 2 兆像素的限制。您的图像是 1587*1340 = 2,126,580 像素 - 有点太多了。因此它会缩小它。

您可以使用该`background-size`属性将大小修复为您期望的大小。你会丢失一些细节，但它会是正确的大小。将此添加到您的 CSS 中：

```
.bg-main { -webkit-background-size: 1587px 1340px } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-05T08:55:20.173

您可以用 2 个部分切割大图像并将 2 个背景添加到 div。

像这样：

```
background: url(1.jpg) top center, url(2.jpg) bottom center 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:15:24.180

那个图像很大，也许这就是问题所在。尝试使用“保存为网络”来减小尺寸（尝试让设计与 .jpg 一起使用）。

# git - Git钩子检测包含特定字符串的文件更改

> ID：11569263
> 
> 赞同：3
> 
> 时间：2012-07-19T21:03:41.017
> 
> 标签：git, gitolite, githooks

如果他们的代码包含某个字符串，我想警告用户并通过电子邮件提醒人们。

现在我正在使用 post-receive 钩子，因为检测需要在服务器端完成。

我正在更新服务器端存储库并运行诸如`git diff-tree -r --name-only --no-commit-id $2 | xargs grep foo`检测错误字符串“foo”之类的东西。

这种方法的问题：

*   我不喜欢维护存储库服务器端的整个工作版本
*   它扫描整个文件，而不仅仅是更改。**编辑**我解决了这个问题，将上面的内容替换为：`git show $2 | grep ^+ ...`

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T05:45:57.337

如果您使用的是 gitolite V3（或“g3”），请尝试将支票放入[**VREF**](http://sitaramc.github.com/gitolite/vref.html)中。

> 对于适用于该用户的规则中以 VREF/ / 开头的每个 refex，都会触发`FOO`对被调用程序的调用`FOO`（[存储在 中`$LOCAL_CODE/VREF`](http://sitaramc.github.com/gitolite/cust.html#localcode)）。
> 请注意，如果 VREF 规则不适用于该用户，则甚至不会调用该程序。

您可以准确控制要将此警告应用于哪些（组）用户。
如果不满足您的条件（没有错误字符串），您可以拒绝推送。

但是，这仍然需要先更新工作目录（因为 Gitolite 默认只管理裸仓库）

# c# - 如何解析 XSD 以从中获取信息 使用 C# 的元素？

> ID：11569264
> 
> 赞同：12
> 
> 时间：2012-07-19T21:03:43.047
> 
> 标签：c#, c#-4.0, xsd

我有一个具有多种复杂类型和简单类型的 XSD（文件的一部分如下所示）。我需要解析这个文档以从复杂类型中引用的每个简单类型中获取 maxLength。任何人都可以就如何实现这一点提出一些建议吗？我需要以通用方式实现这一点，所以如果我查询“Setup_Type”，它应该给出以下输出。谢谢！

NewSetup/Amount = 12（来自嵌套simpleType的元素标签的名称属性由“/”和maxLength分隔）

新设置/名称 = 50

```
<xsd:complexType name="Setup_Type">
  <xsd:sequence>
    <xsd:element name="NewSetup" type="NewSetup_Type" minOccurs="1" maxOccurs="1" />
  </xsd:sequence>
</xsd:complexType>

<xsd:complexType name="NewSetup_Type">
  <xsd:sequence>
    <xsd:element name="Amount" type="Amount_Type"  minOccurs="1" maxOccurs="1" />
    <xsd:element name="Name" type="Name_Type"  minOccurs="1" maxOccurs="1" />
  </xsd:sequence>
</xsd:complexType>

<xsd:simpleType name="Amount_Type">
  <xsd:annotation>
    <xsd:documentation>Amount</xsd:documentation>
  </xsd:annotation>
  <xsd:restriction base="xsd:string">
    <xsd:maxLength value="12" />
  </xsd:restriction>
</xsd:simpleType>

<xsd:simpleType name="Name_Type">
  <xsd:annotation>
    <xsd:documentation>Name</xsd:documentation>
  </xsd:annotation>
  <xsd:restriction base="xsd:string">
    <xsd:maxLength value="50" />
  </xsd:restriction>
</xsd:simpleType> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-07-19T23:51:32.473

我过去曾看到过类似的问题（完全披露，我自己也问过类似的[问题](https://stackoverflow.com/q/7858926/250725)）。解析 XSD 不适合胆小的人。

您基本上有 2 个选项，第一个更容易实现，但可以通过对 XSD 的微小更改更容易破坏。第二个更健壮但难以实施。

**选项1：**

使用 LINQ（或其他 C# XML 解析器，如果您愿意）解析 XSD。由于 XSD 只是一个 XML，因此您可以将其加载到一个`XDocument`并通过 LINQ 读取它。

对于您自己的 XSD 示例：

```
<xsd:simpleType name="Amount_Type">
  <xsd:annotation>
    <xsd:documentation>Amount</xsd:documentation>
  </xsd:annotation>
  <xsd:restriction base="xsd:string">
    <xsd:maxLength value="12" />
  </xsd:restriction>
</xsd:simpleType> 
```

您可以访问 MaxLength：

```
var xDoc = XDocument.Load("your XSD path");
var ns = XNamespace.Get(@"http://www.w3.org/2001/XMLSchema");

var length = (from sType in xDoc.Element(ns + "schema").Elements(ns + "simpleType")
              where sType.Attribute("name").Value == "Amount_Type"
              from r in sType.Elements(ns + "restriction")
              select r.Element(ns + "maxLength").Attribute("value")
                      .Value).FirstOrDefault(); 
```

这并没有提供一种非常简单的按类型名称解析的方法，尤其是对于扩展类型。要使用它，您需要知道要查找的每个元素的确切路径。

**选项 2：**

这对于快速回答来说太复杂了*（注意：请参阅下面的编辑 - 我有一些时间并制定了一个可行的解决方案）*，所以我鼓励您查看我上面链接的我自己的问题。在其中，我链接了一个[很棒的博客](http://geekswithblogs.net/.NETonMyMind/archive/2006/05/02/76957.aspx)，该博客展示了如何认真地将 XSD 分解为多个部分，并可能允许您执行所需的搜索类型。您必须决定是否值得努力开发它（该博客显示了一个实现，`XmlReader`其中包含一个针对相关 XSD 进行验证的 XML，但您可以通过直接加载 XSD 并对其进行解析来轻松完成此操作。

在博客中找到的 2 个关键思想是：

```
// in the getRestriction method (reader in this context is an `XmlReader` that 
//  contains a XML that is being validated against the specific XSD
if (reader.SchemaInfo.SchemaElement == null) return null;
simpleType = reader.SchemaInfo.SchemaElement.ElementSchemaType as XmlSchemaSimpleType;
if (simpleType == null) return null;
restriction = simpleType.Content as XmlSchemaSimpleTypeRestriction;

// then in the getMaxLength method
if (restriction == null) return null;
List<int> result = new List<int>();
foreach (XmlSchemaObject facet in restriction.Facets) {
if (facet is XmlSchemaMaxLengthFacet) result.Add(int.Parse(((XmlSchemaFacet) facet).Value)); 
```

去年我实际上尝试了同样的事情来解析 XSD 作为复杂数据验证方法的一部分。我花了一周的大部分时间才真正了解正在发生的事情，并调整博客中的方法以适应我的目的。这绝对是实现您想要的最佳方式。

如果您想使用独立模式尝试此操作，您可以将 XSD 加载到`XmlSchemaSet`对象中，然后使用该`GlobalTypes`属性来帮助您找到您正在寻找的特定类型。

* * *

**编辑：** 我拿出我的旧代码并开始整理代码来帮助你。

首先加载您的架构：

```
XmlSchemaSet set; // this needs to be accessible to the methods below,
                  //  so should be a class level field or property

using (var fs = new FileStream(@"your path here", FileMode.Open)
{
    var schema = XmlSchema.Read(fs, null);

    set = new XmlSchemaSet();
    set.Add(schema);
    set.Compile();
} 
```

根据您提供的 XSD，以下方法应该可以为您提供接近所需的内容。它应该非常适合处理更复杂的结构。

```
public Dictionary<string, int> GetElementMaxLength(String xsdElementName)
{
    if (xsdElementName == null) throw new ArgumentException();
    // if your XSD has a target namespace, you need to replace null with the namespace name
    var qname = new XmlQualifiedName(xsdElementName, null);

    // find the type you want in the XmlSchemaSet    
    var parentType = set.GlobalTypes[qname];

    // call GetAllMaxLength with the parentType as parameter
    var results = GetAllMaxLength(parentType);

    return results;
}

private Dictionary<string, int> GetAllMaxLength(XmlSchemaObject obj)
{
    Dictionary<string, int> dict = new Dictionary<string, int>();

    // do some type checking on the XmlSchemaObject
    if (obj is XmlSchemaSimpleType)
    {
        // if it is a simple type, then call GetMaxLength to get the MaxLength restriction
        var st = obj as XmlSchemaSimpleType;
        dict[st.QualifiedName.Name] = GetMaxLength(st);
    }
    else if (obj is XmlSchemaComplexType)
    {

        // if obj is a complexType, cast the particle type to a sequence
        //  and iterate the sequence
        //  warning - this will fail if it is not a sequence, so you might need
        //  to make some adjustments if you have something other than a xs:sequence
        var ct = obj as XmlSchemaComplexType;
        var seq = ct.ContentTypeParticle as XmlSchemaSequence;

        foreach (var item in seq.Items)
        {
            // item will be an XmlSchemaObject, so just call this same method
            //  with item as the parameter to parse it out
            var rng = GetAllMaxLength(item);

            // add the results to the dictionary
            foreach (var kvp in rng)
            {
                dict[kvp.Key] = kvp.Value;
            }
        }
    }
    else if (obj is XmlSchemaElement)
    {
        // if obj is an XmlSchemaElement, the you need to find the type
        //  based on the SchemaTypeName property.  This is why your 
        //  XmlSchemaSet needs to have class-level scope
        var ele = obj as XmlSchemaElement;
        var type = set.GlobalTypes[ele.SchemaTypeName];

        // once you have the type, call this method again and get the dictionary result
        var rng = GetAllMaxLength(type);

        // put the results in this dictionary.  The difference here is the dictionary
        //  key is put in the format you specified
        foreach (var kvp in rng)
        {
            dict[String.Format("{0}/{1}", ele.QualifiedName.Name, kvp.Key)] = kvp.Value;
        }
    }

    return dict;
}

private Int32 GetMaxLength(XmlSchemaSimpleType xsdSimpleType)
{
    // get the content of the simple type
    var restriction = xsdSimpleType.Content as XmlSchemaSimpleTypeRestriction;

    // if it is null, then there are no restrictions and return -1 as a marker value
    if (restriction == null) return -1;

    Int32 result = -1;

    // iterate the facets in the restrictions, look for a MaxLengthFacet and parse the value
    foreach (XmlSchemaObject facet in restriction.Facets)
    {
        if (facet is XmlSchemaMaxLengthFacet)
        {
            result = int.Parse(((XmlSchemaFacet)facet).Value);
            break;
        }
    }

    return result;
} 
```

然后使用非常简单，您只需要调用该`GetElementMaxLength(String)`方法，它将以您提供的格式返回名称字典，并将值作为最大长度：

```
var results = GetElementMaxLength("Setup_Type");

foreach (var item in results)
{
    Console.WriteLine("{0} | {1}", item.Key, item.Value);                
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T00:16:04.953

```
public class result_tree
{
    public string nodevalue = "";

    public bool IsTerminal { get { return ChildCount == 0; } }

    public List<result_tree> children = new List<result_tree>();

    public int ChildCount { get { return children.Count; } }

    public result_tree(string v) { nodevalue = v; }

    private void print_children(bool skip, string prefix)
    {
        if (IsTerminal)
            Console.WriteLine(prefix + (prefix.Length==0?"":"/") + nodevalue);
        else
            foreach (result_tree rt in children)
                rt.print_children(false,prefix + (prefix.Length == 0 ? "" : "/") + (skip?"":nodevalue));
    }

    public void print_children()
    {
        print_children(true,"");
    }
}

static class Program
{
    private static void ValidationCallBack(object sender, ValidationEventArgs args)
    {
        Console.WriteLine(args.Message);
    }

    public static result_tree results;

    static string deref_simple(XmlSchemaSimpleType simp)
    {
        XmlSchemaSimpleTypeRestriction xsstr = (XmlSchemaSimpleTypeRestriction)simp.Content;
        foreach (object o in xsstr.Facets)
        {
            if (o.GetType() == typeof(XmlSchemaMaxLengthFacet))
            {
                XmlSchemaMaxLengthFacet fac = (XmlSchemaMaxLengthFacet)o;
                return fac.Value;
            }
        }
        return "";
    }

    static result_tree deref_complex(XmlSchema xs, XmlSchemaComplexType cplx)
    {
        result_tree rt = new result_tree(cplx.Name);

        if (cplx.Particle.GetType() == typeof(XmlSchemaSequence))
        {
            XmlSchemaSequence seq = (XmlSchemaSequence)cplx.Particle;
            foreach (object o in seq.Items)
            {
                if (o.GetType() == typeof(XmlSchemaElement))
                {
                    XmlSchemaElement elem = (XmlSchemaElement)o;

                    XmlQualifiedName name = elem.SchemaTypeName;

                    result_tree branch;

                    object referto = xs.SchemaTypes[name];
                    if (referto.GetType() == typeof(XmlSchemaComplexType))
                    {
                        branch = deref_complex(xs,(XmlSchemaComplexType)referto);
                        branch.nodevalue = elem.Name;
                    }
                    else if (referto.GetType() == typeof(XmlSchemaSimpleType))
                    {
                        XmlSchemaSimpleType st = (XmlSchemaSimpleType)referto;

                        branch = new result_tree(elem.Name + " = " + deref_simple(st).ToString());
                    }
                    else
                    {
                        branch = null;
                    }
                    if( branch != null )
                        rt.children.Add(branch);

                }
            }
        }

        return rt;
    }

    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {

        StreamReader sr = new StreamReader("aschema.xml");
        XmlSchema xs = XmlSchema.Read(sr, ValidationCallBack);
        XmlSchemaSet xss = new XmlSchemaSet();
        xss.Add(xs);
        xss.Compile();

        Console.WriteLine("Query: ");
        string q = Console.ReadLine();

        XmlQualifiedName xqn = new XmlQualifiedName(q);

        if (xs.SchemaTypes.Contains(xqn))
        {
            object o = xs.SchemaTypes[xqn];
            if (o.GetType() == typeof(XmlSchemaComplexType))
            {
                results = deref_complex(xs, (XmlSchemaComplexType)o);
                results.print_children();
            }   
        }
        else
        {
            Console.WriteLine("Not found!");
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:01:08.563

我的解决方案可能不是您正在寻找的。可能您更喜欢使用 System.Xml 类来处理此类信息。我不知道你希望这个解析器有多通用，反正这些只是我的 2 美分。我的代码只是使用旨在正确面对 99% 的可能性的正则表达式（我猜）。有人会说这就像用枪打苍蝇一样。反正就是这样：

```
using System.Text.RegularExpressions;
using System.IO;

static class Program
{
    static void main()
    {
        XsdFile file = new XsdFile(@"c:\temp\test.xsd");
        Console.WriteLine(file.Query("Setup_Type"));
    }
}

public class XsdFile
{

    Dictionary<string, XsdType> types;

    public XsdFile(string path)
    {
        string xsdBody = File.ReadAllText(path);
        types = XsdType.CreateTypes(xsdBody);
    }

    public string Query(string typename) {
        return Query(typename, "");
    }

    private string Query(string typename, string parent)
    {
        XsdType type;
        if (types.TryGetValue(typename, out type))
        {
            if (type.GetType() == typeof(ComplexType))
            {
                StringBuilder sb = new StringBuilder();
                ComplexType complexType = (ComplexType)type;
                foreach (string elementName in complexType.elements.Keys)
                {
                    string elementType = complexType.elements[elementName];
                    sb.AppendLine(Query(elementType, parent + "/" + elementName));
                }
                return sb.ToString();
            }
            else if (type.GetType() == typeof(SimpleType))
            {
                SimpleType simpleType = (SimpleType)type;
                return string.Format("{0} = {1}", parent, simpleType.maxLength);
            }
            else {
                return "";
            }
        }
        else
        {
            return "";
        }
    }
}

public abstract class XsdType
{

    string name;

    public XsdType(string name)
    {
        this.name = name;
    }

    public static Dictionary<string, XsdType> CreateTypes(string xsdBody)
    {

        Dictionary<string, XsdType> types = new Dictionary<string, XsdType>();

        MatchCollection mc_types = Regex.Matches(xsdBody, @"<xsd:(?<kind>complex|simple)Type[\s\t]+(?<attributes>[^>]+)>(?<body>.+?)</xsd:\1Type>", RegexOptions.Singleline);
        foreach (Match m_type in mc_types)
        {
            string typeKind = m_type.Groups["kind"].Value;
            string typeAttributes = m_type.Groups["attributes"].Value;
            string typeBody = m_type.Groups["body"].Value;
            string typeName;
            Match m_nameattribute = Regex.Match(typeAttributes, @"name[\s\t]*=[\s\t]*""(?<name>[^""]+)""", RegexOptions.Singleline);
            if (m_nameattribute.Success)
            {
                typeName = m_nameattribute.Groups["name"].Value;
                if (typeKind == "complex")
                {
                    ComplexType current_type = new ComplexType(typeName);
                    MatchCollection mc_elements = Regex.Matches(typeBody, @"<xsd:element(?<attributes>.+?)/>", RegexOptions.Singleline);
                    foreach (Match m_element in mc_elements)
                    {
                        Dictionary<string, string> elementAttributes = ParseAttributes(m_element.Groups["attributes"].Value);
                        string elementName;
                        string elementType;
                        if (!elementAttributes.TryGetValue("name", out elementName))
                            continue;
                        if (!elementAttributes.TryGetValue("type", out elementType))
                            continue;
                        current_type.elements.Add(elementName, elementType);
                    }
                    types.Add(current_type.name, current_type);
                }
                else if (typeKind == "simple")
                {
                    Match m_maxLength = Regex.Match(typeBody, @"<xsd:restriction[^>]+>.+?<xsd:maxLength.+?value=""(?<maxLength>[^""]+)""", RegexOptions.Singleline);
                    if (m_maxLength.Success)
                    {
                        string maxLength = m_maxLength.Groups["maxLength"].Value;
                        SimpleType current_type = new SimpleType(typeName);
                        current_type.maxLength = maxLength;
                        types.Add(current_type.name, current_type);
                    }
                }
            }
            else
            {
                continue;
            }
        }
        return types;
    }

    private static Dictionary<string, string> ParseAttributes(string value)
    {
        Dictionary<string, string> attributes = new Dictionary<string, string>();
        MatchCollection mc_attributes = Regex.Matches(value, @"(?<name>[^=\s\t]+)[\s\t]*=[\s\t]*""(?<value>[^""]+)""", RegexOptions.Singleline);
        foreach (Match m_attribute in mc_attributes)
        {
            attributes.Add(m_attribute.Groups["name"].Value, m_attribute.Groups["value"].Value);
        }
        return attributes;
    }

}

public class SimpleType : XsdType
{

    public string maxLength;

    public SimpleType(string name)
        : base(name)
    {
    }

}

public class ComplexType : XsdType
{

    //(name-type)
    public Dictionary<string, string> elements = new Dictionary<string,string>();

    public ComplexType(string name)
        : base(name)
    {
    }

} 
```

# google-app-engine - 通过 Sublime Text 2 构建系统在 App Engine 上部署

> ID：11569266
> 
> 赞同：2
> 
> 时间：2012-07-19T21:03:57.603
> 
> 标签：google-app-engine, sublimetext2

下面的代码工作正常，但在 shell 中我没有看到正在进行的部署日志。只有在部署完成时才会出现日志。有什么帮助吗？

```
{
  "cmd": ["appcfg.py --email=email --oauth2 --passin update", "$project_path"],
  "path": "C:/Program Files/Google/google_appengine",
  "encoding": "latin_1",
  "shell": "true"
} 
```

# iphone - 将数据从已解析数组插入数据库时 出现问题

> ID：11569273
> 
> 赞同：0
> 
> 时间：2012-07-19T21:04:45.747
> 
> 标签：iphone, objective-c, ios, sqlite

```
-(void)saveTheData:(InternetResource*)_resource
{
    currentResultsList= [[[NSMutableArray alloc] initWithArray:[iconnect.responseString JSONValue]] mutableCopy];
    //NSLog(@"Response String:  %@",iconnect.responseString);
    NSLog(@"bla bla%@",currentResultsList);
    NSString *databaseName = @"olympics_db3";//rodeo_database_details //rodeo_user_database
    NSLog(@"dsdsd %@",databaseName);
    NSString *path =[[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:databaseName];
}

sqlite3_stmt    *statement;
const char *dbpath = [path UTF8String];

if (sqlite3_open(dbpath,&sql) == SQLITE_OK)
{  
    NSInteger athleteID;
    NSInteger countryMedal;
    NSInteger eventID;
    NSString *result;
    NSInteger resultID;
    NSInteger sportID;
    NSInteger typeOfMedal;

    for(int i=0;i<[currentResultsList count];i++)
    {
        if ([[currentResultsList objectAtIndex:i] objectForKey:@"athleteID"]==(id)[NSNull null] || [[[currentResultsList objectAtIndex:i] objectForKey:@"athleteID"] length]==0)
        {
            athleteID=0;    

        }
        else
        {
             athleteID=[[[currentResultsList objectAtIndex:i] objectForKey:@"athleteID"] integerValue];
        }
        if ([[currentResultsList objectAtIndex:i] objectForKey:@"countryMedal"]==(id)[NSNull null] || [[[currentResultsList objectAtIndex:i] objectForKey:@"countryMedal"] length]==0)
        {
            countryMedal=0;
        }
        else
        {
            countryMedal=[[[currentResultsList objectAtIndex:i]objectForKey:@"countryMedal"]integerValue];
        }
        if ([[currentResultsList objectAtIndex:i] objectForKey:@"eventID"]==(id)[NSNull null] || [[[currentResultsList objectAtIndex:i] objectForKey:@"eventID"] length]==0)
        {
            eventID=0;
        }
        else
        {
        eventID= [[[currentResultsList objectAtIndex:i] objectForKey:@"eventID"]integerValue];
        }
        if ([[currentResultsList objectAtIndex:i] objectForKey:@"result"]==(id)[NSNull null] || [[[currentResultsList objectAtIndex:i] objectForKey:@"result"] length]==0)
        {
            result=@"";
        }
        else{
        result= [NSString stringWithFormat:@"%@",[[currentResultsList objectAtIndex:i] objectForKey:@"result"]];
        }
        if ([[currentResultsList objectAtIndex:i] objectForKey:@"resultID"]==(id)[NSNull null] || [[[currentResultsList objectAtIndex:i] objectForKey:@"resultID"] length]==0)
        {
            resultID=0;
        }
        else
        {
        resultID= [[[currentResultsList objectAtIndex:i] objectForKey:@"resultID"]integerValue];
        }
        if ([[currentResultsList objectAtIndex:i] objectForKey:@"sportID"]==(id)[NSNull null] || [[[currentResultsList objectAtIndex:i] objectForKey:@"sportID"] length]==0)
        {
            sportID=0;
        }
        else
        {
        sportID= [[[currentResultsList objectAtIndex:i] objectForKey:@"sportID"]integerValue];
        }
        if ([[currentResultsList objectAtIndex:i] objectForKey:@"typeOfMedal"]==(id)[NSNull null] || [[[currentResultsList objectAtIndex:i] objectForKey:@"typeOfMedal"] length]==0)
        {
            typeOfMedal=0;
        }
        else{
        typeOfMedal=[[[currentResultsList objectAtIndex:i] objectForKey:@"typeOfMedal"]integerValue];
        }
        NSString *insertSQL = [NSString stringWithFormat: @"INSERT INTO Result (`athleteID`,`countryMedal`,`eventID`,`result`,`resultID`,`sportID`,`typeOfMedal`) VALUES ('%d','%d', '%d','%@','%d','%d','%d')",athleteID,countryMedal,eventID,result,resultID,sportID,typeOfMedal];
        NSLog(@"InsertQery: %@", insertSQL);

        const char *insert_stmt = [insertSQL UTF8String];
        sqlite3_prepare_v2(sql, insert_stmt, -1, &statement, NULL);
        if (sqlite3_step(statement) == SQLITE_DONE)
        {
            NSLog(@"Data Inserted");
        }
        else
        {
            NSLog(@"Data Inserted failed");        
        }

        sqlite3_finalize(statement);
        sqlite3_close(sql);
    }
} 
```

}

# c# - 使用具有自己的事务范围的多个 DbContext

> ID：11569279
> 
> 赞同：2
> 
> 时间：2012-07-19T21:05:06.653
> 
> 标签：c#, sql-server, entity-framework-4, transactions

我需要同时从两个不同的 DbContext 访问数据，确保每个都使用 READ UNCOMMITTED 进行查询（*实际上，重要的是它不会锁定它迭代的行 - 将 WITH NO LOCK 添加到查询中也工作*）。

你如何使用实体框架来做到这一点？如果我将两个查询中的每一个都包装在 TransactionScope 中，它会尝试将事务提升到 MSDTC，这对我们来说不是一个选项。

```
private static IEnumerable<Image> EnumerateSourceImages()
{
    using (var dbContext = new SourceDbContext())
    {
        using (var transScope = new TransactionScope(
                                    TransactionScopeOption.RequiresNew,
                                    new TransactionOptions() {
                                            IsolationLevel = IsolationLevel.ReadUncommitted
                                        }
                                    )
                            )
        {
            var imagesSourceQuery = dbContext.ImageDatas
                                    .AsNoTracking()
                                    .OrderBy(imageData => imageData.ImageID)
            foreach (var image in imagesSourceQuery)
            {
                yield return image;
            }
            transScope.Complete();
        }
    }
}
private static IEnumerable<Image> EnumerateDestinationImages()
{
    using (var dbContext = new DestinationDbContext())
    {
        using (var transScope = new TransactionScope(
                                    TransactionScopeOption.RequiresNew,
                                    new TransactionOptions() {
                                            IsolationLevel = IsolationLevel.ReadUncommitted
                                        }
                                    )
                            )
        {
            var imagesSourceQuery = dbContext.ImageDatas
                                .AsNoTracking()
                                .OrderBy(imageData => imageData.ImageID)
            foreach (var image in imagesSourceQuery)
            {
                yield return image;
            }
            transScope.Complete();
        }
    }
}
private static void main(string[] args){
{
    IEnumerator<ItemImage> sourceImagesEnumerator = null;
    IEnumerator<ItemImage> destImagesEnumerator = null;
    try{
        sourceImagesEnumerator = EnumerateSourceImages().GetEnumerator();
        destImagesEnumerator = EnumerateDestinationImages().GetEnumerator();

        bool sourceHasMore = sourceImagesEnumerator.MoveNext();
        //Exception on next line about MSDTC Promotion
        bool destHasMore = destImagesEnumerator.MoveNext();
    } finally{
        if(sourceImagesEnumerator != null) sourceImagesEnumerator.Dispose();
        if(destImagesEnumerator != null) destImagesEnumerator.Dispose():
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:18:55.320

您是否尝试在连接字符串中设置 enlist=false ？

[http://forums.asp.net/t/1401606.aspx/1](http://forums.asp.net/t/1401606.aspx/1)

Brgrds，拉里

# ruby - Ruby 评估顺序

> ID：11569281
> 
> 赞同：1
> 
> 时间：2012-07-19T21:05:26.390
> 
> 标签：ruby

```
print sentence.scan(/\[(\w+)\]/).all? do |word|
    @words.keys.include? word[0].to_sym
end 
```

我已经打印了 的各个值，`@words.keys.include? word[0].to_sym`但它们并不都是真的，但它会打印`true`. 我认为这可能是因为它的评估是这样的：

```
(print sentence.scan(/\[(\w+)\]/).all?) do |word|
    @words.keys.include? word[0].to_sym
end 
```

但我希望它评估为

```
print (sentence.scan(/\[(\w+)\]/).all? do |word|
    @words.keys.include? word[0].to_sym
end) 
```

但是，添加括号会导致

```
syntax error, unexpected keyword_do_block, expecting ')' 
```

**如何更改评估代码段的顺序？**

**编辑：**

除非上述情况属实，否则我想返回 true 而不是 print，例如：

```
 @sentences.reject do |sentence|
        !(sentence.scan(/\[(\w+)\]/).all? { |word| @words.keys.include? word[0].to_sym })
    end 
```

但它拒绝一切。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:18:49.897

您正在以两种方式为自己制造痛苦：

1.  打印的论点是模棱两可的。你应该使用`print(...)`没有空格。

2.  Do/end 绑定不如`{...}`块紧密。同样，您的示例对于解析器来说有些模棱两可。

尝试不那么模棱两可的语法，并在查看替代结构之前看看是否可以解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T21:13:58.727

这个变体对我有用：

```
print (sentence.scan(/\[(\w+)\]/).all?{|word| words.keys.include? word[0].to_sym }) 
```

第二种变体：

```
print begin
  (sentence.scan(/\[(\w+)\]/).all? do |word|
    words.keys.include? word[0].to_sym
  end)    
end 
```

# netbeans - java.lang.NoClassDefFoundError: javax/persistence/Persistence...axis2 和 eclipselink

> ID：11569283
> 
> 赞同：0
> 
> 时间：2012-07-19T21:05:29.827
> 
> 标签：netbeans, eclipselink, axis2

我想在 netbeans 中部署axis2 web 服务，我在netbeans 中安装了插件axis2。我也使用 EclipseLink 2.0 连接数据库。当我在我创建的主类中使用时，我的连接成功。但是，当我尝试通过右键单击服务在 netbeans 中测试我的 Web 服务时，会抛出此异常：

[错误] javax/persistence/Persistence java.lang.NoClassDefFoundError: javax/persistence/Persistence at db.util.ManageConnection.getStatsEntityManagerFactory(ManageConnection.java:33) at services.LoginService.loginService(LoginService.java:31) at sun。 reflect.NativeMethodAccessorImpl.invoke0(Native Method) 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 在 java.lang.reflect.Method.invoke( Method.java:597) at org.apache.axis2.rpc.receivers.RPCUtil.invokeServiceClass(RPCUtil.java:194) at org.apache.axis2.rpc.receivers.RPCInOnlyMessageReceiver.invokeBusinessLogic(RPCInOnlyMessageReceiver.java:63) at org .apache.axis2.receivers.AbstractMessageReceiver。在 org.apache.axis2.transport.http.util.RESTUtil.invokeAxisEngine(RESTUtil.java:135) 的 org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:173) 接收(AbstractMessageReceiver.java:114)在 org.apache.axis2.transport.http.util.RESTUtil.processURLRequest(RESTUtil.java:130) 在 org.apache.axis2.transport.http.AxisServlet$RestRequestProcessor.processURLRequest(AxisServlet.java:825) 在 org.apache .axis2.transport.http.AxisServlet.doGet(AxisServlet.java:271) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:617) 在 javax.servlet.http.HttpServlet.service(HttpServlet.java:717 ) 在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java: org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)206) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 在 org.apache.catalina 的 org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:390) .core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 在 org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233) 在 org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191 ) 在 org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) 在 org.apache.catalina.core.StandardEngineValve 的 org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)。在 org.apache.catalina.connector.CoyoteAdapter.service 调用（StandardEngineValve.java:109）（CoyoteAdapter.java:293) 在 org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583) 在 org.apache.tomcat.util 的 org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:849) .net.JIoEndpoint$Worker.run(JIoEndpoint.java:454) at java.lang.Thread.run(Thread.java:662) 原因：java.lang.ClassNotFoundException: Class Not found : javax.persistence.Persistence at org .apache.axis2.deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:92) at java.lang.ClassLoader.loadClass(ClassLoader.java:306) at org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273 ) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/Persistenceorg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583) 在 org.apache.tomcat.util.net.JIoEndpoint$ 的 apache.coyote.http11.Http11Processor.process(Http11Processor.java:849) java.lang.Thread.run(Thread.java:662) 的 Worker.run(JIoEndpoint.java:454) 原因：java.lang.ClassNotFoundException：找不到类：org.apache.axis2 的 javax.persistence.Persistence。 deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:92) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:306) 在 org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) 在 java.lang .ClassLoader.loadClass(ClassLoader.java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/Persistenceorg.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583) 在 org.apache.tomcat.util.net.JIoEndpoint$ 的 apache.coyote.http11.Http11Processor.process(Http11Processor.java:849) java.lang.Thread.run(Thread.java:662) 的 Worker.run(JIoEndpoint.java:454) 原因：java.lang.ClassNotFoundException：找不到类：org.apache.axis2 的 javax.persistence.Persistence。 deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:92) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:306) 在 org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) 在 java.lang .ClassLoader.loadClass(ClassLoader.java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/Persistence在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint. java:454) at java.lang.Thread.run(Thread.java:662) 原因：java.lang.ClassNotFoundException：找不到类：org.apache.axis2.deployment.DeploymentClassLoader.findClass( DeploymentClassLoader.java:92) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:306) 在 org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) 在 java.lang.ClassLoader.loadClass(ClassLoader .java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/Persistence在 org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint. java:454) at java.lang.Thread.run(Thread.java:662) 原因：java.lang.ClassNotFoundException：找不到类：org.apache.axis2.deployment.DeploymentClassLoader.findClass( DeploymentClassLoader.java:92) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:306) 在 org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) 在 java.lang.ClassLoader.loadClass(ClassLoader .java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/Persistencecoyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583) at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454) at java.lang.Thread.run(Thread. java:662) 原因：java.lang.ClassNotFoundException: 类未找到：javax.persistence.Persistence at org.apache.axis2.deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:92) at java.lang.ClassLoader.loadClass( ClassLoader.java:306) at org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) at java.lang.ClassLoader.loadClass(ClassLoader.java:247) ... 还有 31 个 [错误] org. apache.axis2.AxisFault：javax/persistence/Persistencecoyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583) at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:454) at java.lang.Thread.run(Thread. java:662) 原因：java.lang.ClassNotFoundException: 类未找到：javax.persistence.Persistence at org.apache.axis2.deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:92) at java.lang.ClassLoader.loadClass( ClassLoader.java:306) at org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) at java.lang.ClassLoader.loadClass(ClassLoader.java:247) ... 还有 31 个 [错误] org. apache.axis2.AxisFault：javax/persistence/Persistencejava.lang.Thread.run(Thread.java:662) 处的 JioEndpoint$Worker.run(JIoEndpoint.java:454) 原因：java.lang.ClassNotFoundException：找不到类：org.apache 处的 javax.persistence.Persistence。 axis2.deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:92) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:306) 在 org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) 在 java .lang.ClassLoader.loadClass(ClassLoader.java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/Persistencejava.lang.Thread.run(Thread.java:662) 处的 JioEndpoint$Worker.run(JIoEndpoint.java:454) 原因：java.lang.ClassNotFoundException：找不到类：org.apache 处的 javax.persistence.Persistence。 axis2.deployment.DeploymentClassLoader.findClass(DeploymentClassLoader.java:92) 在 java.lang.ClassLoader.loadClass(ClassLoader.java:306) 在 org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) 在 java .lang.ClassLoader.loadClass(ClassLoader.java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/PersistencefindClass(DeploymentClassLoader.java:92) at java.lang.ClassLoader.loadClass(ClassLoader.java:306) at org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) at java.lang.ClassLoader.loadClass (ClassLoader.java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/PersistencefindClass(DeploymentClassLoader.java:92) at java.lang.ClassLoader.loadClass(ClassLoader.java:306) at org.apache.axis2.deployment.DeploymentClassLoader.loadClass(DeploymentClassLoader.java:273) at java.lang.ClassLoader.loadClass (ClassLoader.java:247) ... 还有 31 个 [错误] org.apache.axis2.AxisFault: javax/persistence/Persistence

我可以部署其他不包含与 eclipselink (entityManager...) 的连接的服务。

我在其他论坛中发现了同样的问题，但他们使用的是休眠，解决方案是添加到类路径中：hibernate-jpa-2.0-api-1.0.0.Final.jar，在这个链接[http://www。 coderanch.com/t/513512/ORM/databases/Error-java-lang-NoClassDefFoundError-javax](http://www.coderanch.com/t/513512/ORM/databases/Error-java-lang-NoClassDefFoundError-javax)

但我不知道 EclipseLink 有什么问题我不知道我是否添加其他库以及在哪里.. 非常感谢...

这是我的服务班

公共类登录服务 {

```
EntityManagerFactory emf = ManageConnection.
    getStatsEntityManagerFactory(PersistenceConfiguration.
    getPERSISTENCE_UNIT_NAME());

public String prubaServicioWeb(String nombre) {
    return nombre + " Welcome";

}

public void loginService(String whatever) {

    BankJpaController bankController = new
    BankJpaController(emf);
    Bank bank = new Bank();
    bank.setId(null);
    bank.setBankCode("BNSJ");
    bank.setName("Bank of America");
    bankController.create(bank);

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T16:17:39.360

您需要 javax.persistence_1.0.0.jar（如果仅使用 JPA 1.0）或 javax.persistence_2.0.4.v201112161009.jar（如果使用 JPA 2.0）中的 javax.persistence 类（jar 的名称可能略有不同，这是 2.4 里程碑附带的东西）。

These will be in the jlib/jpa directory of your EclipseLink download.

# extjs - 从 ExtJs 的组合框中获取完整的模型对象？

> ID：11569284
> 
> 赞同：15
> 
> 时间：2012-07-19T21:05:34.433
> 
> 标签：extjs, extjs4

如果我有一个商店支持的组合框选择，它在 ExtJS 4 下触发一个事件，我该如何获取由该选择表示的完整对象？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-07-20T00:32:23.343

通常，您可以使用[`findRecordByValue`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.form.field.ComboBox-method-findRecordByValue)组合框上的方法：

```
combobox.on('change', function(combobox, newValue, oldValue) {

   // Get the old and the new records.
   // NOTE: The underlying store is not guaranteed to 
   //       contain an associated record.
   var oldRecord = combobox.findRecordByValue(oldValue);
   if (oldRecord) {
      // Do something...
   }

   var newRecord = combobox.findRecordByValue(newValue);
   if (newRecord) {
      // Do something...
   }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T21:16:04.257

在发布我的问题后几乎立即想到了这一点。

我的问题是我绑定了错误的事件，我使用的是“更改”而不是“选择”。

选择事件为您提供包含其中完整对象的记录。

# excel - 按变量引用表列

> ID：11569288
> 
> 赞同：4
> 
> 时间：2012-07-19T21:05:42.770
> 
> 标签：excel, vba

这应该很简单，但我是 VBA 菜鸟。我已经阅读了很多论坛，发现除了过于复杂的代码，我无法破译以适应我的应用程序。

在 Excel 2007 中，我已经定义了一个表。由于我是论坛的新手，所以我无法发布图片，但该表有 3 列，标题行命名为 1 到 3，还有一个数据行，粗略如下所示：

```
Table1
+------+------+-------+
|1     |  2   |   3   |
+------+------+-------+
|Alpha |Bravo |Charlie|
+------+------+-------+ 
```

使用这个简单的表，以下工作，并返回文本“Alpha”。

```
Sub works()

    Dim item As String

    Sheets("Sheet1").Select
    item = ActiveSheet.Range("Table1[1]")
    MsgBox (item)

End Sub 
```

但我希望能够使用可调变量来引用表格列标题。为什么这不起作用：

```
Sub doesntwork()

    Dim item As String
    Dim i As String

    i = 1
    Sheets("Sheet1").Select
    item = ActiveSheet.Range("Table1[i]")
    MsgBox (item)

End Sub 
```

这一定是语法问题，但我没有运气在过去 10 多年中对 VBA 语法的所有各种迭代进行排序......

请帮忙！谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:26:05.983

如果您想引用结构化表的标题，那么这将为您提供对包含标题的范围的引用：

```
Dim rng as Range    
Set rng = Activesheet.Range("Table1[#Headers]") 
```

...如果您想按位置引用特定标题：

```
Dim rngHdr2    
Set rngHdr2 = rng.Cells(2) '2nd header cell 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:06:59.643

您需要使用连接将表名构建为字符串：

```
item = ActiveSheet.Range("Table1[" & i & "]") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-23T11:18:39.410

结合两个答案

子演示（）

```
Dim rng As Range
Dim celda As Range
Dim nroTabla As Integer
Dim nroFila  As Integer
Dim nroCol   As Integer

nroTabla = 1
nroFila = 2
nroCol = 3

Set rng = ActiveSheet.Range("Tabla" & nroTabla & "[#Headers]")
Set celda = rng.Cells(nroFila, nroCol)

celda.Value = 700 
```

结束子

# android - Android ICS 浏览器固定页眉样式消失

> ID：11569289
> 
> 赞同：0
> 
> 时间：2012-07-19T21:05:42.990
> 
> 标签：android, html, css, android-4.0-ice-cream-sandwich, android-browser

我在我的 Skyrocket 设备和模拟器上的 Android ICS 浏览器中发现了一个奇怪的错误。基本上，我拥有的固定标题几乎失去了它的所有样式（恢复为文本，尽管它仍然固定出现）。这似乎发生在存在 PJAX 转换或某些页面上（即使标题 HTML 和 CSS 在所有情况下都相同）。

您可以在我设置的暂存环境中看到这一点： [https](https://tt-chnicola.herokuapp.com/) ://tt-chnicola.herokuapp.com/ 用户：testuser 密码：密码

只需浏览一下，您就会明白我的意思。

更新：具体来说，我使用的是 4.0.3（API 级别 15），而我的手机是三星的 4.0.4

也发生在 4.0 (API 14)

它在 GB (API 10) 和 JB (API 16) 上运行良好，所以这似乎是 ICS 独有的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:54:00.720

所以这看起来确实是一个浏览器错误，但可以通过删除使用类似于以下技术的浮动“图像替换”元素来修复：

[https://stackoverflow.com/a/471538/235243](https://stackoverflow.com/a/471538/235243)

看起来被隐藏的文本正在出现并出于某种原因将整个标题推到视野之外。

# google-chrome-extension - 什么浏览器插件可以让你自动覆盖网站的 html

> ID：11569293
> 
> 赞同：0
> 
> 时间：2012-07-19T21:05:53.530
> 
> 标签：google-chrome-extension, firefox-addon

任何人都可以建议一个浏览器插件，让我在加载特定网站时覆盖网站。

**示例场景：**

每当我加载 yahoo.com 时，我都想更改它呈现 html 的方式和行为方式。

*   它需要能够操作 DOM。例如，它可以改变一个的属性`<img height="" width="" />`，例如图像的宽度和高度。
*   除了更改属性之外，它还需要能够注入新元素。例如我可以插入新的`<divs>`或`<p>`。
*   我还需要能够操作 head 标签，因为我喜欢为覆盖插入外部 CSS 和 JS。

我主要使用 Google Chrome 和 Mozilla Firefox。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:00:43.320

Chrome 通过用户脚本插件（也称为[greasemonkey](http://en.wikipedia.org/wiki/Greasemonkey)脚本）提供本机支持和Firefox。它们本质上是像扩展一样安装的 javascript 文件。在顶部，您定义了要运行脚本的域，并且您有权修改 DOM。[http://userscripts.org/](http://userscripts.org/)上有很多例子。在 chrome 中加载一些，然后查看 user.js 文件源以了解它们是如何工作的。

您也可以通过[Bookmarklet](http://en.wikipedia.org/wiki/Bookmarklet)来完成，但与 Greasemonkey 脚本相比，它们更像是一种黑客攻击

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T23:09:24.807

它被称为 Chrome 扩展中的[内容脚本](http://code.google.com/chrome/extensions/content_scripts.html)。

# c# - 在 Sitecore 中获取“标签”索引

> ID：11569294
> 
> 赞同：0
> 
> 时间：2012-07-19T21:05:54.537
> 
> 标签：c#, asp.net, sitecore

我正在使用 Sitecore，并且我有一个包含选项卡的网页。此选项卡可以有 1 个或多个子项。现在有一个促销控件，它会根据选择的选项卡而动态变化。

因此，如果我选择了 Tab1，那么该页面将显示一些促销信息。Tab2 可能有不同/相同的促销。这两个被放置在不同的控件中。

到目前为止，我得到的只是这段代码：

```
 Sitecore.Data.Database db = Sitecore.Context.Database;
        Item home = db.GetItem(Sitecore.Context.Site.StartPath);
        var getItems = (from Item item in currItem.Children.InnerChildren 
                        select item).ToList(); 
```

此查询的结果是 3 项。因为有 3 个选项卡。这些选项卡在转发器中，如下所示：

```
<asp:Repeater ID="rptPromo" runat="server" OnItemDataBound="rptPromo_ItemBound">
<ItemTemplate>
    <table width="100%">
          <tbody>
                 <tr>

                     <td>
                         <h2><sup><sc:Text ID="txtPromo" Field="PromoText" runat="server" /></sup></h2>
                    </td>

                 </tr>

           </tbody>
    </table>    
</ItemTemplate> 
```

如何获取选择了哪个选项卡的信息。我在一个单独的函数中更改了 PROMO 控件：

```
 protected void rptPromo_ItemBound (Object sender, RepeaterItemEventArgs e)
    {

        Item i = e.Item.DataItem as Item;
        Text txtPromo = e.Item.FindControl("txtPromo") as Text;
        //txtPromo.Attributes.Add("txtPromo", txtPromo);
        //HTMLControl hyperLinkLookUp = e.Item.FindControl("") as 
        string s;
    } 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:37:09.113

Text 控件需要知道 Item 上下文。如果未设置，则假定您所在的当前上下文项将导致 3 个重复的 PromoTexts 出现在转发器中（如果 PromoText 字段未出现在当前上下文项上，则根本没有）。

您已经`Field`在 Text 控件上定义了属性，因此您需要做的就是`Item`按如下方式分配其属性：

```
protected void rptPromo_ItemBound (Object sender, RepeaterItemEventArgs e)
{
    Item i = e.Item.DataItem as Item;
    Sitecore.Web.UI.WebControls.Text txtPromo = e.Item.FindControl("txtPromo") as Sitecore.Web.UI.WebControls.Text;
    txtPromo.Item = i;

    //txtPromo.Attributes.Add("txtPromo", txtPromo);
    //HTMLControl hyperLinkLookUp = e.Item.FindControl("") as 
    string s;
} 
```

# php - SQL 语法错误 [PHP|MYSQL]

> ID：11569298
> 
> 赞同：-2
> 
> 时间：2012-07-19T21:06:10.887
> 
> 标签：php, mysql, session, syntax

我今天在我的网站的公开资料上工作，但我遇到了问题。

我输入了所有信息，但是当我按下提交时，我得到：

您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 3 行的“WHERE id=1”附近使用正确的语法

代码 ：

```
 // contact to database

/// connection is OK 

//Get data in local variable
$v_name=$_POST['name'];
$v_age=$_POST['age'];
$v_job=$_POST['job'];
$v_interes=$_POST['interes'];
$v_hobbies=$_POST['hobbies'];
$v_family=$_POST['family'];
$v_pub_mail=$_POST['pub_mail'];
$v_profimg=$_POST['profimg'];
$v_about=$_POST['about'];

// check for null values
if ($v_name==""  /*or $v_msg==""*/)
echo "All fields must be entered, hit back button and re-enter information";
else{
$query="insert into user(name,pub_mail,age,job,interes,hobbies,family,about) values ('$v_name','$v_age','$v_job','$v_interes','$v_hobbies','$v_family','$v_pub_mail','$v_profimg','$v_about') WHERE id='$usrid'";
mysql_query($query)  or die(mysql_error());
echo "Your profile was updated .";
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:07:35.317

`INSERT`没有`WHERE`从句。如果您需要更新现有记录，那么您应该使用它`UPDATE`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:07:23.583

你不应该使用`WHERE`带有`INSERT`.

```
$query="insert into user(name,pub_mail,age,job,interes,hobbies,family,about) values ('$v_name','$v_age','$v_job','$v_interes','$v_hobbies','$v_family','$v_pub_mail','$v_profimg','$v_about'); 
```

我认为您想进行 UPDATE 而不是 INSERT ...

（顺便说一下，您的插入/更新不安全，不要忘记使用`addslashes`）

# xcode - mapView 没有缩放到坐标

> ID：11569304
> 
> 赞同：0
> 
> 时间：2012-07-19T21:06:29.150
> 
> 标签：xcode, ios5, mapkit

我已经查看了现有的问题，并相信我遵守了规则，但出于某种原因，我的地图没有缩放。我已经设置了一个断点，以确保我的坐标可以通过并且那里的一切似乎都正常。

下面是我的代码。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [self configureView];

    mapView = [[MKMapView alloc]initWithFrame:CGRectMake(20, 20, 260, 169)];
    mapView.delegate = self;
    mapView.mapType = MKMapTypeStandard;
    [self.view addSubview:mapView];
}

- (void)mapView:(MKMapView *)mapView regionWillChangeAnimated:(BOOL)animated {

   Bar *maps = self.detailItem;
   MKCoordinateSpan span;
   span.latitudeDelta = .02;
   span.longitudeDelta = .02;

   CLLocationDegrees latDegree = [maps.barLat doubleValue];
   CLLocationDegrees longDegree = [maps.barLong doubleValue];
   CLLocationCoordinate2D location = CLLocationCoordinate2DMake(latDegree, longDegree);

   MKCoordinateRegion region;
   region.center = location;
   region.span = span;
   [mapView setRegion:region animated:TRUE];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T02:36:34.580

我不完全清楚你在`mapView:regionWillChangeAnimated:`回调中试图做什么......当区域将要改变时（例如在用户平移或缩放时）被调用，并且你通过命令另一个区域改变来响应。也许这只是为了调试？

我认为您的问题是关于为什么您的地图不会缩放，对吗？

如果您想确保您的地图支持缩放，请添加以下代码：

```
mapView = [[MKMapView alloc]initWithFrame:CGRectMake(20, 20, 260, 169)];
mapView.delegate = self;
mapView.mapType = MKMapTypeStandard;
mapView.zoomEnabled = YES;
mapView.multipleTouchEnabled = YES; 
```

但是，我想知道您所看到的是否只是您的地图很小。它不到屏幕尺寸的一半。在模拟器上，我发现很难执行捏合手势（这会导致缩放），即使在我的真实设备上，我的两根手指也不容易进入那个小视图区域。但是，在这两个平台上，我确实看到了允许缩放的代码（iOS 5.0）。

你能增加`frame`你的地图的大小，并确保它不仅仅是在一个小区域内很难捏吗？

# eclipse - 调试 Eclipse 核心表达式

> ID：11569306
> 
> 赞同：2
> 
> 时间：2012-07-19T21:06:43.537
> 
> 标签：eclipse, debugging

我正在构建一个 Eclipse E4 RCP 应用程序。我有一个使用核心表达式的菜单项。有没有办法调试这个核心表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T06:33:37.060

我还没有使用 E4，但是在 3.x 中你可以调试表达式。表达式派生自类`org.eclipse.core.expressions.Expression`。

它们的类名与表达式匹配，例如`org.eclipse.core.internal.expression.WithExpression`实现*with*表达式。

假设您知道要调试的表达式类型，只需在`evaluate`类的方法中设置断点即可。

请注意，表达式被广泛使用，因此设置断点条件将为您节省大量断点命中。

# javascript - Javascript - 控制流

> ID：11569314
> 
> 赞同：2
> 
> 时间：2012-07-19T21:07:11.600
> 
> 标签：javascript, jquery

我需要一些关于 javascript 中“控制流”的最佳实践的帮助。在下面的示例中，我的 updateUI 函数无法正常工作，因为我的 saveData 函数尚未完成。

```
function save(data){
   saveData(data);
   updateUI();
} 
```

对于临时修复，我这样做了

```
function save(data){
if(saveData(data)){
   updateUI();
   }
} 
```

更新：这是我的 saveData 方法

```
function saveData(data){

$.ajax({
    url: url, // a variable, not important for this example
    data: data,
    type: "post",
    dataType: "json",
    success: function(data) { return true; },
    error: function(e) {
        console.log(e);
    }
}) 
```

如果存在这种方法，我觉得我应该学习“标准”方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:12:27.170

假设`saveData`正在调用 AJAX 函数（例如`$.ajax`），让它返回该 AJAX 函数的结果：

```
function saveData() {
    return $.ajax({
        url: url, // a variable, not important for this example
        data: data,
        type: "post",
        dataType: "json"
    }).fail(function(e) {
        console.log(e);
    });
} 
```

然后使用 jQuery 延迟链接来更新 UI：

```
saveData().done(updateUI).fail(showError); 
```

它允许您避免将回调函数传递到您的`saveData`调用中，从而使您可以将数据保存逻辑与 UI 逻辑完全分离。

**编辑** 我已经更新了代码，以展示如何包含一个默认`fail`处理程序，也使用延迟对象，但仍然返回，`promise`以便您可以在外部处理 UI 更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:08:57.137

这是因为您的 saveData 是异步方法。您需要在 oncomplete 事件中调用 updateUI()。

看看[这篇文章](http://joseoncode.com/2011/09/26/a-walkthrough-jquery-deferred-and-promise/)并阅读[promise()](http://api.jquery.com/promise/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:09:40.050

有几种方法可以做到这一点。

您可以为 saveData 方法提供一个回调函数——然后在 saveData 完成时调用该函数。

```
var saveData = function(data, cb){
    // do something with data to save it
    cb.apply(this, ['arguments', 'as', 'an','array']); // or use .call instead
} 
```

您可以实现一些事件，以便您的 updateUI 方法侦听一个事件，当它发生时会导致 updateUI 运行，当您完成 saveData 时会触发该事件。jQuery 提供了一个，以及 Backbone。

有很多方法可以完成这项工作——选择最适合您的方法。

# text - 从文本文件中获取不同的值

> ID：11569315
> 
> 赞同：0
> 
> 时间：2012-07-19T21:07:21.043
> 
> 标签：text, batch-file

我正在处理非常大的 FIX 消息日志文件。每条消息代表一组由 SOH 字符分隔的标签。

与 MQ 消息不同，单个 FIX 标记（和整体消息）不具有固定长度或位置。日志可能包含不同类型的消息（具有不同数量和标签序列）。

样本（多种类型的消息之一）：

```
07:00:32 -SEND:8=FIX.4.0(SOH)9=55(SOH)35=0(SOH)34=2(SOH)43=N(SOH)52=20120719-11:00:32(SOH)49=ABC(SOH)56=XYZ(SOH)10=075 
```

所以唯一确定的事情如下：（1）等号标签号唯一标识标签，（2）标签由SOH字符分隔。

对于特定标签（一次只有几个，而不是全部），我需要获取它们不同值的列表 - 如下所示：

49=ABC 49=DEF 49=GHI...

输出的格式并不重要。

我将不胜感激任何建议和建议。

亲切的问候，维克多·O。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T04:17:50.583

**选项1**

下面的批处理脚本具有不错的性能。它有以下限制

*   检查重复项时它会忽略大小写。
*   它可能无法正确保留值中包含`=`的所有值

**编辑**- 我的原始代码根本不支持`=`该值。我通过在变量名中添加一个额外的 SOH 字符来减少这种限制，并更改了用于解析值的分隔符。现在`=`，只要在`=`. 如果值在 之后有差异，`=`则将仅保留一个值。

请务必在顶部附近修复 SOH 变量的定义。

日志文件的名称作为第一个参数传递，请求的标签列表作为第二个参数传递（括在引号中）。

```
@echo off
setlocal disableDelayedExpansion

:: Fix the definition of SOH before running this script
set "SOH=<SOH>"
set LF=^

:: The above 2 blank lines are necessary to define LF, do not remove.

:: Make sure there are no existing tag_ variables
for /f "delims==" %%A in ('2^>nul set tag_') do set "%%A="

:: Read each line and replace SOH with LF to allow iteration and parsing
:: of each tag/value pair. If the tag matches one of the target tags, then
:: define a tag variable where the tag and value are incorporated in the name.
:: The value assigned to the variable does not matter. Any given variable
:: can only have one value, so duplicates are removed.
for /f "usebackq delims=" %%A in (%1) do (
  set "ln=%%A"
  setlocal enableDelayedExpansion
  for %%L in ("!LF!") do set "ln=!ln:%SOH%=%%~L!"
  for /f "eol== tokens=1* delims==" %%B in ("!ln!") do (
    if "!!"=="" endlocal
    if "%%C" neq "" for %%D in (%~2) do if "%%B"=="%%D" set "tag_%%B%SOH%%%C%SOH%=1"
  )
)

:: Iterate the defined tag_nn variables, parsing out the tag values. Write the
:: values to the appropriate tag file.
del tag_*.txt 2>nul
for %%A in (%~2) do (
  >"tag_%%A.txt" (
    for /f "tokens=2 delims=%SOH%" %%B in ('set tag_%%A') do echo %%B
  )
)

:: Print out the results to the screen
for %%F in (tag_*.txt) do (
  echo(
  echo %%F:
  type "%%F"
) 
```

**选项 2**

该脚本几乎没有限制，但速度明显较慢。我能看到的唯一限制是它不允许以值开头`=`（前导`=`将被丢弃）。

我创建了一个临时的“search.txt”文件，用于 FINDSTR /G: 选项。由于 FINDSTR 限制，我使用文件而不是命令行搜索字符串。命令行搜索字符串不能匹配许多 > 十进制 128 的字符。此外，文字反斜杠的转义规则在命令行上也不一致。请参阅[Windows FINDSTR 命令有哪些未记录的功能和限制？](https://stackoverflow.com/q/8844868/1012053)了解更多信息。

SOH 定义必须再次修复，第一个和第二个参数与第一个脚本相同。

```
@echo off
setlocal disableDelayedExpansion

:: Fix the definition of SOH before running this script
set "SOH="
set lf=^

:: The above 2 blank lines are necessary to define LF, do not remove.

:: Read each line and replace SOH with LF to allow iteration and parsing
:: of each tag/value pair. If the tag matches one of the target tags, then
:: check if the value already exists in the tag file. If it doesn't exist
:: then append it to the tag file.
del tag_*.txt 2>nul
for /f "usebackq delims=" %%A in (%1) do (
  set "ln=%%A"
  setlocal enableDelayedExpansion
  for %%L in ("!LF!") do set "ln=!ln:%SOH%=%%~L!"
  for /f "eol== tokens=1* delims==" %%B in ("!ln!") do (
    if "!!"=="" endlocal
    set "search=%%C"
    if defined search (
      setlocal enableDelayedExpansion
      >search.txt (echo !search:\=\\!)
      endlocal
      for %%D in (%~2) do if "%%B"=="%%D" (
        findstr /xlg:search.txt "tag_%%B.txt" || >>"tag_%%B.txt" echo %%C
      ) >nul 2>nul
    )
  )
)
del search.txt 2>nul

:: Print out the results to the screen
for %%F in (tag_*.txt) do (
  echo(
  echo %%F:
  type %%F
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T18:50:04.993

试试这个批处理文件。添加日志文件名作为参数。例如：

```
LISTTAG.BAT SOH.LOG 
```

它将显示所有标签 ID 及其唯一值。例如：

```
9=387
12=abc
34=asb73
9=123
12=xyz 
```

命名的文件`tagNNlist.txt`（其中`NN`是标签 ID 号）将用于查找唯一的标签 ID 和值，但在批次结束时作为报告保持不变。

`{SOH}`下面代码中显示的文本实际上是SOH*字符*（ASCII 0x01），所以复制粘贴代码后，应该将其更改为*SOH*字符。我必须替换该字符，因为它已被服务器剥离。使用*写字板*通过键入生成*SOH*字符，`0001`然后按`ALT+X`。使用批处理文件代码将该字符复制并粘贴到记事本中。

需要注意的一件事是，代码只会处理从第 16 列开始的行。`07:00:32 -SEND:`示例中的行将被忽略。我假设它们都以固定长度的文本开头。

变化：

*   通过标签 ID 将生成的标签列表文件更改为单独的文件。例如：`tag12list.txt`、`tag52list.txt`等。

*   删除了生成的标签列表文件中的标签 ID 号。例如：`12=abc`成为`abc`。

`LISTTAG.BAT`：

```
@echo off
setlocal enabledelayedexpansion
if "%~1" == "" (
  echo No source file specified.
  goto :eof
)
if not exist "%~1" (
  echo Source file not found.
  goto :eof
)
echo Warning! All "tagNNlist.txt" file in current
echo directory will be deleted and overwritten.
echo Note: The "NN" is tag id number 0-99\. e.g.: "tag99list.txt"
pause
echo.
for /l %%a in (0,1,99) do if exist tag%%alist.txt del tag%%alist.txt
for /f "usebackq delims=" %%a in ("%~1") do (
  rem *****below two lines strip the first 15 characters (up to "-SEND:")
  set x=%%a
  set x=!x:~15,99!
  rem *****9 tags per line
  for /f "tokens=1,2,3,4,5,6,7,8,9 delims={SOH}" %%b in ("!x!") do (
    call :dotag "%%b" %*
    call :dotag "%%c"
    call :dotag "%%d"
    call :dotag "%%e"
    call :dotag "%%f"
    call :dotag "%%g"
    call :dotag "%%h"
    call :dotag "%%i"
    call :dotag "%%j"
  )
)
echo.
echo Done.
goto :eof

rem dotag "{id=value}"
:dotag
for /f "tokens=1,2 delims==" %%p in (%1) do (
  set z=0
  if exist tag%%plist.txt (
    call :chktag %%p "%%q"
  ) else (
    rem>tag%%plist.txt
  )
  if !z! == 0 (
    echo %%q>>tag%%plist.txt
    echo %~1
  )
)
goto :eof

rem chktag {id} "{value}"
:chktag
for /f "delims=" %%y in (tag%1%list.txt) do (
  if /i "%%y" == %2 (
    set z=1
    goto :eof
  )
)
goto :eof 
```

# javascript - jQuery DIV 冲突

> ID：11569318
> 
> 赞同：0
> 
> 时间：2012-07-19T21:07:27.930
> 
> 标签：javascript, jquery, html

我发现以下脚本可以使菜单在滚动时跟随屏幕平滑动画。

但是，它会向下推页脚，导致页面高度扩大而没有更多内容。当它与页脚碰撞时，如何让它停止滚动？

这是代码：

```
$(function() {

    var $sidebar   = $("#indhold_right"), 
        $window    = $(window),
        offset     = $sidebar.offset(),
        topPadding = 0;

    $window.scroll(function() {
        if ($window.scrollTop() > offset.top) {
            $sidebar.stop().animate({
                marginTop: $window.scrollTop() - offset.top + topPadding
            }, "fast");
        } else {
            $sidebar.stop().animate({
                marginTop: 0
            });
        }
    });

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T02:58:11.753

让我们退后一步，看看为什么它会以这种方式发生。当您滚动`$window.scrollTop()`并且`offset.top`两者都更改时。但是，前者总是大于后者。因此，每次滚动时，您的 if 条件都会评估为 true，并且您正在调用它的 animate 函数。你没有停止。

我们如何制止？通过设置停止检查，您不会设置动画。当页面加载`$("#footer").offset().top`时，您开始时获取页脚高度。因此，检查`$window.scrollTop()`应小于页脚顶部。

那检查会起作用吗？是的，但它不会令人愉快（除非你想要那样），因为你的侧边栏有高度，并且停止只有在你的侧边栏顶部达到页脚高度（停止）后才起作用。因此，只需将侧边栏高度添加到您的停靠点。这不会 100% 准确，会有填充、边距和其他在此停止中未考虑的内容，但它看起来不错，我认为，您可以从那里继续。

**在我给你代码答案之前，请看一下[http://sscce.org/](http://sscce.org/)（正如@Zeta 所提到的）。始终遵循这一点。**我有一些时间和好心情。否则我什至不会看它。

下面是代码。工作示例 - [http://jsfiddle.net/H3Dqr/](http://jsfiddle.net/H3Dqr/)

```
$(function() {

    var $sidebar = $("#indhold_right"),
        $window = $(window),
        offset = $sidebar.offset(),
        topPadding = 0,
        stop = $("#footer").offset().top;

    $window.scroll(function() {
        if ($window.scrollTop() > offset.top) {
            if ($window.scrollTop() + $sidebar.height() < stop) {
                $sidebar.stop().animate({
                    marginTop: $window.scrollTop() - offset.top + topPadding
                }, "fast");
            }
        } else {
            $sidebar.stop().animate({
                marginTop: 0
            });
        }
    });

});​ 
```

# arrays - jQplot 将每个项目视为一个新项目

> ID：11569320
> 
> 赞同：0
> 
> 时间：2012-07-19T21:07:29.033
> 
> 标签：arrays, jqplot

我正在将 jQplot 用于条形图，但我遇到了问题。

以下是一些示例数据：

var s2 = [["28",425, null], ["23",424], ["24",417], ["25",390],["26",393], ["27" ,392], ["28",369]];

我遇到的问题是有两个相同的值，例如 28 和 jQplot 将其视为同一个项目有没有办法让它将其视为一个单独的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:22:10.470

将数据和标签分成两个单独的数组（数据和刻度），然后使用 CategoryAxisRenderer：

```
$(document).ready(function(){

    ticks = ['One', 'Two', 'Three', 'One', 'Two', 'One'];

    data = [12,14,6,21,17, 21];

    var opts = { 
        seriesDefaults: {
            renderer: jQuery.jqplot.BarRenderer
        },
        axes: {
            xaxis: {
                renderer: $.jqplot.CategoryAxisRenderer,
                ticks: ticks
            }
        }
    };

    plot1 = jQuery.jqplot ('chart1', [data], opts);

}); 
```

[在这里](http://jsfiddle.net/larsenmtl/KGp5a/1/)拉小提琴。

# c# - 需要帮助查找索引超出范围异常消息的原因

> ID：11569321
> 
> 赞同：-1
> 
> 时间：2012-07-19T21:07:29.677
> 
> 标签：c#

指数超出范围。必须是非负数且小于集合的大小。参数名称：索引

我有 WireObjectAnimation 类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Windows.Forms;
using DannyGeneral;

namespace AnimationEditor
{
    class WireObjectAnimation
    {
        private List<WireObjectCoordinates> wocl = new List<WireObjectCoordinates>();

        private WireObject wo1 = null;

        string name;
        int ndx;
        public WireObjectAnimation(string name,WireObject wo)
        {

            this.name = name;

            wo1 = wo;

            WireObjectCoordinates woc;
            woc = new WireObjectCoordinates(wo.woc);
            wocl.Add(woc);
            ndx = 0;

        }

        public void Save(string path , string fileName , PictureBox pb) 
        {
            int framesNumberX = 0;
            int framesNumberY = 0;
            string fn;
            string t = Path.GetFileNameWithoutExtension(this.name);
            if (File.Exists(path + "\\" + "DATABASE" + "\\" + fileName + "\\" + t + ".txt"))
            {
                try
                {
                    string f = Path.Combine(path + "\\" + "DATABASE" + "\\" + t + "\\" + fileName);
                    File.Delete(f);
                }
                catch (Exception ex)
                {
                    MessageBox.Show("Error: Could not delete file from disk. Original error: " + ex.Message);
                }

                fn = path + "\\" + "DATABASE" + "\\" + t + "\\" + fileName;
            }
            else
            {
                fn = path + "\\" + "DATABASE" + "\\" + fileName + "\\" + this.name + ".txt";
            }
            OptionsFile setting_file = new OptionsFile(fn);
            setting_file.SetKey("File Name", fn);
            setting_file.SetKey("Object Name", fileName);
            setting_file.SetKey("Animation Name", this.name);
            setting_file.SetKey("picturebox.Width", pb.Width.ToString());
            setting_file.SetKey("picturebox.Height", pb.Height.ToString());

            string[] xFrames = new string[wocl.Count];
            string[] yFrames = new string[wocl.Count];

            string X="";
            string Y="";
            for (int i = 0; i < wocl.Count; i++)
            {
                X  = string.Format("Frame_X_{0} ", i + 1);
                Y  = string.Format("Frame_Y_{0} ", i + 1);
                framesNumberX ++;
                framesNumberY ++;
                for (int j = 0; j < wocl[i].Point_X.Count; j++)
                {
                    xFrames[i] += string.Format("{0},", wocl[i].Point_X[j]);
                    yFrames[i] += string.Format("{0},", wocl[i].Point_Y[j]);

                }

                string tt = xFrames[i].Trim(",".ToCharArray());
                string yy =  yFrames[i].Trim(",".ToCharArray());

                 setting_file.SetKey(X, tt);
                 setting_file.SetKey(Y, yy);

            }

            int resultX = framesNumberX / 2;
            int resultY = framesNumberY / 2;
            setting_file.SetKey("Number Of Frames X", resultX.ToString()); 
            setting_file.SetKey("Number Of Frames Y", resultY.ToString());

        }

        public void Load(string path,string fileName)
        {
            int numberofframesX = 0;
            int numberofframesY = 0;
            string framesX = "";
            string framesY = "";
            string X = "";
            string Y = "";
            string t = path + "\\" + fileName;
            OptionsFile setting_file = new OptionsFile(t);
            string XX = setting_file.GetKey("Number Of Frames X");
            string YY = setting_file.GetKey("Number Of Frames Y");
            numberofframesX = Convert.ToInt32(XX);
            numberofframesY = Convert.ToInt32(YY);

            for (int i = 1; i < numberofframesX ; i++)
            {
            X  = string.Format("Frame_X_{0} ", i);
            framesX = setting_file.GetKey(X);
            List<string> floatStrings = new List<string>(framesX.Split(new char[] { ',' }));
            List<float> test = floatStrings.Select(tempStr => (float)Convert.ToDouble(tempStr)).ToList(); 

                wo1.woc.Point_X = test;  

            }
            for (int i = 1; i < numberofframesY; i++)
            {
                Y = string.Format("Frame_Y_{0} ", i);
                framesY = setting_file.GetKey(Y);
                List<string> floatStrings = new List<string>(framesY.Split(new char[] { ',' }));
                List<float> test = floatStrings.Select(tempStr => (float)Convert.ToDouble(tempStr)).ToList();
                wo1.woc.Point_Y = test;
            }
        }

        public void SetFrame(int frameNumber, WireObjectCoordinates woc)
        {
            wocl[frameNumber].Set(woc);
        }

        public WireObjectCoordinates GetFrame(int frameNumber)
        {
            if (frameNumber > wocl.Count)
            {
                throw new Exception("not allowed!");
            }

            if (frameNumber == wocl.Count)
            {
                WireObjectCoordinates woc;
                woc = new WireObjectCoordinates(wocl[wocl.Count - 1]); 

                wocl.Add(woc);
                return woc;
            }
            else
            {

                return wocl[frameNumber];
            }

        }
    }
} 
```

现在，当我加载加载函数时，我看到加载它的点很好。但后来我试图将 trackBar 栏滚动向右移动，然后我得到了异常。现在这条线： wo1.woc.Point_X = test; woc 有 4 个索引，每个索引中的 Point_X 和 Point_Y 都用每个索引中的数字填充。

在这个类中，我有 SetFrame 和 GetFrame 函数，并且我在 trackBar 的 Form1 滚动事件中使用 GetFrame：

```
private void trackBar1_Scroll(object sender, EventArgs e)
        {

            currentFrameIndex = trackBar1.Value;
            textBox1.Text = "Frame Number : " + trackBar1.Value;
            wireObject1.woc.Set(wireObjectAnimation1.GetFrame(currentFrameIndex)); 
            LoadPictureAt(trackBar1.Value, sender);

            button1.Enabled = false;
            button2.Enabled = false;
            button3.Enabled = false;
            button4.Enabled = false;
            button8.Enabled = false;
            SaveFormPicutreBoxToBitMapIncludingDrawings();

            return;

        } 
```

现在，当我将 trackBar 向右移动一次时，它应该从 Point_X 和 Point_Y 绘制下一组数字，而不是转到 WireObjectCoordinates 类并在那里抛出异常：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace AnimationEditor
{
    class WireObjectCoordinates
    {
        public List<float> Point_X = new List<float>();
        public List<float> Point_Y = new List<float>();

        public WireObjectCoordinates()
        {
        }

        public WireObjectCoordinates(WireObjectCoordinates w)
        {
            Point_X.AddRange(w.Point_X);
            Point_Y.AddRange(w.Point_Y);
        }

        public void Set(WireObjectCoordinates w)
        {
            for (int i = 0; i < Point_X.Count; i++)
            {
                Point_X[i] = w.Point_X[i];
                Point_Y[i] = w.Point_Y[i];
            }
        }
    }
} 
```

异常上线：Point_X[i] = w.Point_X[i]; Point_X[i] 现在包含从 [0] 到 [3] 的 4 个索引，每个索引包含一个数字，例如 332.0 333.0 334.0 335.0 而 w.Point_X[i] 现在只包含一个索引 [0]，并且该索引的数字为 332.0

我只是不明白为什么这条线上有例外。

这个想法是，当我将 trackBar 向右移动时，它应该从 wo1.woc.Point_Y 和 wo1.woc.Point_X 绘制下一个坐标，但我想我在 Load 函数中做错了什么？我不确定为什么它会抛出异常，并且只有当我将 trackBar 向右移动一次时才会抛出异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:16:12.277

在它周围抛出一个尝试捕获它在技术上不会解决问题，但它不会再崩溃并且只是阅读错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:28:54.580

你希望你的`for`循环如何工作？循环变量`i`从这个实例的列表`0`计数。`Point_X`但是如果另一个实例`w`有`Point_X`一个较低计数的列表，或者如果`Point_Y`列表`this`或`Point_Y`列表`w`有，它将失败。

如果你意识到`Point_X.Count`is`4`和`w.Point_X.Count`is only `1`，那么当`i`超过时`0`，表达式`w.Point_X[i]`将尝试读取列表中不存在的元素。这会引发“索引超出范围”的异常。

但也许你明白吗？

# magento - 我们可以使用 magmi 或 magento 的产品导入功能从实时服务器导入产品图像吗？

> ID：11569331
> 
> 赞同：0
> 
> 时间：2012-07-19T21:07:43.857
> 
> 标签：magento, magmi

我的所有图像都存储在实时站点中。我们可以使用 magmi 或 magento 的产品导入功能将这些所有图像从实时站点（由 .csv 文件中的图像名称映射）导入到我当前的站点吗？如下图所示：

![在此处输入图像描述](../Images/a421e979dfc0e373a00656d75b09dfb6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T01:44:56.107

您可以通过在 csv 文件中指定完整的图像路径来使用 magmi 导入图像。您需要`Image attributes processor`在 magmi 中启用插件。有关图像导入的详细文档在[这里](http://sourceforge.net/apps/mediawiki/magmi/index.php?title=Image_attributes_processor)

# c - 使用 if 语句将数组中的 nan 值切换为 0.0？

> ID：11569337
> 
> 赞同：3
> 
> 时间：2012-07-19T21:08:12.710
> 
> 标签：c, floating-point, nan

我正在用点和点之间的向量进行一些计算，当点非常靠近时，我得到 nan 并不奇怪。我现在要做的是删除我存储在数组中的数组中的所有 nan 值以及良好的数据。我希望只使用一些这样的代码：

```
 if( angle[i] == nan ) { angle[i] = 0.0 }; 
```

至少这是我尝试过的，当我尝试时会出错。有谁知道如何摆脱 nan 值并用 0.0 替换它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T21:18:32.533

假设这是 C 然后使用[isnan](http://linux.die.net/man/3/isnan) from `<math.h>`：

```
#include <math.h>

if (isnan(angle[i]))
{
    angle[i] = 0.0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T21:12:10.290

据我记得，在每一种语言中，NaN 都会将所有内容都与 false 进行比较，包括它自己。您可以使用此行为将其清除：

```
if( angle[i] != angle[i] ) { angle[i] = 0.0 }; 
```

这看起来像 C、C++ 或 Java；在所有这些中，这个技巧应该有效。

# r - 从绘图中删除线

> ID：11569339
> 
> 赞同：5
> 
> 时间：2012-07-19T21:08:14.893
> 
> 标签：r, graph, plot, line

只是一个简单的问题：我正在尝试在 R 中绘制一个图表，并且我已经介绍了如何做到这一点，但是如何删除我刚刚创建的一条线？例如：

```
x <- c(1, 2, 4, 5, 6.7, 7, 8, 10 )
y <- c(40, 30, 10, 20, 53, 20, 10, 5)

plot(x,y,main="X vs Y", xlab="X", ylab="Y")

lines(x,y,col="black",lty="dotted") 
```

这产生了一个很好的图表。但是，假设我想删除我之前创建的行（或者可能还有点？！）我应该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-06T20:33:45.007

在 R 基础中擦除的技巧是重绘所有内容，除了要在新绘图中擦除的内容

所以如果你：

```
plot(x,y,main="X vs Y", xlab="X", ylab="Y")
lines(x,y,col="black",lty="dotted") 
```

然后决定你不想要这条线然后你：

```
plot(x,y,main="X vs Y", xlab="X", ylab="Y") 
```

然后，如果你想抹去一切，那么你

```
plot.new() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-06T23:53:11.420

为了删除一行，您只需删除 line 命令并重新运行其余命令。

您应该将您的情节视为您的代码。您保存代码是因为它比实际的情节更能说明情节是什么。除非你有很多东西要画在你的情节中，否则重新绘制所有东西是相对微不足道的。您可能需要重新绘制数十次，直到它完全符合您的要求。仅供参考，在内心深处，这正是一些基于 GUI 的图形程序在您调整事物时所做的事情（取决于您调整的内容）。所以，从这个意义上说，R 并不是特别特别。

或者，将绘图另存为矢量图形（即 PDF），在兼容的矢量图形绘图程序（即 Illustrator）中打开，然后调整您的心声。

# javascript - 有没有办法告诉敲除等待重新计算计算值，直到定义视图模型之后？

> ID：11569341
> 
> 赞同：24
> 
> 时间：2012-07-19T21:08:23.260
> 
> 标签：javascript, knockout.js

我有一个复杂的视图模型，它是几百行带有大量可观察属性、计算可观察属性、可写计算可观察属性和函数的 javascript 代码。所以管理这个是一个相当大的挑战。

我不得不处理的一个烦人的问题是，当你定义它时，计算的 observable 会立即计算出来。因此，在定义可观察对象时使用尚未在视图模型中定义的变量会导致错误表明该变量尚未定义。它是……就在文件的后面。

这是一个人为的例子：

```
function ViewModel1​(args) {
    var self = this;

    self.firstName = ko.observable(args.firstName);
    self.lastName = ko.observable(args.lastName);
    self.fullName = ko.computed(function () {
        return self.firstName() + ' ' + self.lastName();
    });
}

function ViewModel2​(args) {
    var self = this;

    self.fullName = ko.computed(function () {
        // uh oh, where's firstName?
        return self.firstName() + ' ' + self.lastName();
    });
    self.firstName = ko.observable(args.firstName);
    self.lastName = ko.observable(args.lastName);
} 
```

使用`ViewModel1`将毫无问题。此时`fullName`已定义，`firstName`并且`lastName`已定义，因此它按预期工作。使用`ViewModel2`将不起作用。计算函数中会出现错误，说明`firstName`未定义。

到目前为止，我一直在做的是确保在定义所有因变量之后定义所有计算的 observables。这样做的问题是，这样做时，事情是在看似随机的地方定义的，而我宁愿将相关变量定义在一起。

我想出的一个很好的解决方案是定义一个“正在初始化”的 observable 集，`true`并让所有计算出的 observable 测试它是否仍在初始化，如果不是，则计算并返回值。这样，就不会尝试访问当前未定义的变量。

```
function ViewModel3(args) {
    var self = this;
    var initializing = ko.observable(true);

    self.fullName = ko.computed(function () {
        if (!initializing()) {
            return self.firstName() + ' ' + self.lastName();
        }
    });
    self.firstName = ko.observable(args.firstName);
    self.lastName = ko.observable(args.lastName);

    initializing(false);
} 
```

但这在我的情况下不是很实用。我有很多计算过的 observables，所以在所有这些中这样做会使它变得非常臃肿，记住我有很多这样的。节流它似乎没有什么区别。

**有没有办法告诉淘汰赛在尝试计算计算的可观察值之前等待？或者有没有更好的方法来构建我的代码来处理这个问题？**

我可能会创建一些辅助函数来管理初始化逻辑，但我仍然必须更改所有计算出的 observable 定义。我想我可以用猴子补丁淘汰赛来添加这个初始化逻辑，因为我不知道淘汰赛有这样的选项，我可能会这样做。我之前已经查看过计算的 observables 的来源，但我不知道其他地方是否已经有设置。

[jsfiddle 演示](http://jsfiddle.net/S29c8/1/)

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-07-19T21:32:10.430

Computed observables 接受一个`deferEvaluation`选项，该选项阻止初始评估发生，直到某些东西真正尝试检索计算的值。

你可以这样定义它：

```
self.fullName = ko.computed({
   read: function() {
       return self.firstName() + " " + self.lastName();
   },
   deferEvaluation: true
}); 
```

为了完整起见，您还可以像这样指定它：

```
this.fullName = ko.computed(function() {
       return this.firstName() + " " + this.lastName();
 }, this, { deferEvaluation: true }); 
```

或者你可以像这样包装它：

```
ko.deferredComputed = function(evaluatorOrOptions, target, options) {
   options = options || {};

   if (typeof evaluatorOrOptions == "object") {
       evaluatorOrOptions.deferEvaluation = true;   
   } else {
       options.deferEvaluation = true;
   }

   return ko.computed(evaluatorOrOptions, target, options);
}; 
```

# sql-server - 变量 A 中的数据或变量 B 中的数据或数据变量 A 为空且变量 B 为空的语法

> ID：11569343
> 
> 赞同：0
> 
> 时间：2012-07-19T21:08:34.840
> 
> 标签：sql-server, tsql, variables, null

我有一个用户请求，希望能够按员工 ID 值或员工姓名值选择数据。如果两者都没有被要求拉动所有员工。

我的第一个冲动是创建两个变量：`@EmpID`和`@Name`

然后

```
select a,b,c,d,e
where
(
    c between date1 and date 2
    and
    d > 0
)
and
(
    a in (@EmpID)
    or
    b = @Name
) 
```

`@Empid`如果我为or提供值，它会很好用`@Name`。

我想不通的是如何让它返回每个人 if`@EmpID is null`和`@Name is null`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:15:50.360

`OR`在您的子句中添加一个额外的语句`WHERE`：

```
and
    (
        (a = @EmpID)
        or
        (b = @Name)
        or
        (@EmpID IS NULL AND @Name IS NULL)
    ) 
```

如果两者都是和`@EmpID`，则所有员工都将被退回。请记住该子句：`@Name``NULL``WHERE`

```
(
    c between date1 and date 2
    and
    d > 0
) 
```

仍将适用于任何选定的员工。

# hadoop - Mahout 是否需要安装在 Hadoop 的主节点上？

> ID：11569344
> 
> 赞同：0
> 
> 时间：2012-07-19T21:08:40.200
> 
> 标签：hadoop, mahout

这是一个愚蠢的问题，但必须有人问。

我已经尝试在本地运行 Mahout，这很有效。现在，我希望由远程集群执行工作，而不是我的本地机器。

那么，我应该在 Hadoop 机器上部署 Mahout 代码，还是仍然可以在本地机器接口上使用 Hadoop 远程制作 Mahout？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:44:26.740

No, you don't install Hadoop programs on the Hadoop workers yourself. That would be a nightmare to maintain. Hadoop does it for you when you provide it the JAR file with all code via `hadoop jar`.

What runs on your local machine, when you run Mahout or anything else Hadoop-based, is a client program that uses Hadoop code to send info to a cluster to start work. That cluster might be local, or remote -- makes no difference to how you run the client, just what the client talks to.

# php - 更新我的记录

> ID：11569345
> 
> 赞同：0
> 
> 时间：2012-07-19T21:08:49.143
> 
> 标签：php, mysql

亲爱的朋友，我正在尝试更新重新编码，但总是出现以下消息

“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以在第 9 行的 '' 附近使用正确的语法”

代码看起来不错，但我不明白我做错了什么，有人可以帮忙。提前致谢。

```
<?php
if(isset($_POST['edit'])){
         // this id wil be pulled from the URL above. 
        $hot_id     = $_GET['hotl'];  
        $hotel_name = escape_value($_POST['title']);
        $hotel_star = escape_value($_POST['category']);
        $shortdes   = escape_value($_POST['shortdes']);
        $country    = escape_value($_POST['country']);
        $address    = escape_value($_POST['address']);
        $pcode      = escape_value($_POST['pcod']);
        $city       = escape_value($_POST['city']);         

        $query = "UPDATE Hotels SET  
                  hotel_name = '{$hotel_name}',
                  star ='{$hotel_star}',
                  description = '{$shortdes}',
                  country = '{$country}',
                  hotel_address = '{$address}',
                  hotel_postal_code = '{$pcode}',
                  hotel_city = '{$city}'
                  WHERE hotel_id = {$hot_id}";                
            $result = mysql_query($query, $connection);

            if(mysql_affected_rows() == 1){
            //Success
            }else{
            die("Some thing wrong with the Upadate: ". mysql_error());
            }

        }else{
        //error ocurred
        }
?> 
```

我在 PHP 和 Mysql 论坛上发布我的问题，因为我不知道问题出在哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:32:37.057

调试 SQL 语句（如上所述）的最简单方法是在提交查询之前回显查询，并准确查看要发送到数据库的内容。话虽这么说，你为什么不尝试在你的 $hot_id 变量周围加上一些引号（''）：

`WHERE hotel_id = '{$hot_id}'`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T21:41:28.723

Somewhere in the update there should be $hot_id:

```
"UPDATE Hotels SET  
    hotel_name = '{$hotel_name}', hotel_id = '{$hot_id}', etc 
```

# layer - 隐藏层使无用的滚动条出现

> ID：11569347
> 
> 赞同：0
> 
> 时间：2012-07-19T21:09:02.780
> 
> 标签：layer

所以我一直在尝试解决这个问题一段时间，我觉得我没有想法。

所以，我的网站中有层，即使滚动条被隐藏也能显示出来。即使不需要，用户也可以滚动我的网站。我想知道是否有一种方法可以使浏览器滚动条仅在此类图层设置为可见时才出现。

我一直在尝试使用 div 溢出，但问题是由于这些 div 被放置在一个设定的顶部值，它会在向下滚动时隐藏图层的上部内容。

任何人都知道如何使它工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T08:03:55.287

使用`display:none`风格而不是`visibility:hidden`风格。`visibility:hidden`仅使 an 元素不可见，但仍会计算其空间/布局。

# html - 图像在悬停时越过列表的元素

> ID：11569349
> 
> 赞同：0
> 
> 时间：2012-07-19T21:09:11.183
> 
> 标签：html, css

所以我在这里要做的是一个简单的水平 css 菜单，但是，每当用户将鼠标悬停在列表中的某个项目上时，我希望在所述项目上方显示一个小三角形这就是我想出的远 HTML：

```
<div id="navbar2">
        <div id="navholder">
            <ul id="nav2">
                   <li>
                        <a href="#">category one</a>
                   </li>
                   <li>
                        <a href="#">section two</a>
                   </li>
                   <li>
                        <a href="#">articles</a>
                   </li>
                   <li>
                        <a href="#">posts here</a>
                   </li>
                   <li>
                        <a href="#">category two</a>
                   </li>
            </ul>
        </div>
  </div> 
```

和应用于它的CSS：

```
ul#nav2
{
    background:url('images/redbar.png');
    list-style-type:none;
    height:50px;
}
#navbar2 ul li
{
    height:50px;
    display:inline;
    line-height:35px;
    padding-left:19px;
}
#navbar2 ul li:hover 
 {  
    height:50px;
    background-position: 50% 0%;
    background:url('images/Project_0040_Layer-21.png') no-repeat;
 }
 #navbar2 ul li a 
{
    color:#fff;
    text-decoration:none;
    font-size:10pt;
    } 
```

即使我在顶部中心指定了背景位置，它根本没有显示出来......我做错了什么？链接到 jsfiddle： http: [//jsfiddle.net/wWMjF/1/](http://jsfiddle.net/wWMjF/1/)，我基本上想要文本上方的小三角形，指向它而不是两侧

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:37:07.090

将背景样式连接到一行：

```
#navbar2 ul li:hover
{  
    height:50px;
    background:url('http://i.imgur.com/dyj8m.png') no-repeat center 0;
} 
```

请参阅[更新的小提琴示例](http://jsfiddle.net/wWMjF/2/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:54:27.027

我为你敲了这个。可能有点用。

[http://jsfiddle.net/wWMjF/11/](http://jsfiddle.net/wWMjF/11/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:37:30.660

使用[`background`](http://www.w3.org/TR/css3-background/#the-background)速记属性会将所有未指定的属性设置为其初始值：

> 'background' 属性是一个简写属性，用于在样式表的同一位置设置大多数背景属性。[...] 给定一个有效的声明，对于每一层，速记首先设置“背景图像”、“背景位置”、“背景尺寸”、“背景重复”、“背景- origin'、'background-clip' 和 'background-attachment' 到该属性的初始值，然后分配在声明中为该层指定的任何显式值。

要么使用

```
#navbar2 ul li:hover 
 {  
    height:50px;
    background-position: 50% 0%;
    background-image:url('images/Project_0040_Layer-21.png');
    background-repeat: no-repeat;
 } 
```

或者

```
#navbar2 ul li:hover 
 {  
    height:50px;
    background:url('images/Project_0040_Layer-21.png') no-repeat 50% 0%;
 } 
```

为了避免这种情况。

# mysql - MySQL 选择进入 返回 null 但查询返回一个值

> ID：11569351
> 
> 赞同：2
> 
> 时间：2012-07-19T21:09:17.417
> 
> 标签：mysql, select

出于某种原因，当我进行选择时，我无法让这个查询返回一个值。

给定一个 table `t10company`，我有一个名为`CompanyID`which is of的列`CHAR(8)`，它的值是： `MYCO0001`

如果我发出以下查询：

```
SELECT
    MAX(CONVERT(RIGHT(CompanyID, 4), UNSIGNED INTEGER))
    FROM t10company 
    WHERE LEFT(CompanyID, 4) = 'MYCO'
    GROUP BY LEFT(CompanyID, 4) 
    ORDER BY RIGHT(CompanyID, 4) LIMIT 1; 
```

我得到的返回值为 1，这是我所期望的。

如果我发出完全相同的查询，除了 with`INTO @myvar`然后执行 a`SELECT @myvar`它总是返回 NULL。它在我正在编写的存储过程中执行此操作，并且还在 MySQL Workbench 的查询窗口中执行此操作。我不知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:19:21.827

我使用这种形式为 MySQL 中的用户变量赋值

```
SELECT @myvar := MAX(CONVERT(RIGHT(CompanyID, 4), UNSIGNED INTEGER)) FROM ... 
```

根据 5.1 文档，这也应该有效：

```
SELECT MAX(CONVERT(RIGHT(CompanyID, 4), UNSIGNED INTEGER)) INTO @myvar FROM ... 
```

* * *

我进行了快速测试（MySQL 5.1），最后的 SELECT 显示 @myvar 被设置为 1。

```
CREATE TABLE t10company (CompanyID CHAR(8));
INSERT INTO t10company VALUES ('MYCO0001');
SET @myvar := NULL;
SELECT @myvar;
SELECT
MAX(CONVERT(RIGHT(CompanyID, 4), UNSIGNED INTEGER)) INTO @myvar
FROM t10company 
WHERE LEFT(CompanyID, 4) = 'MYCO'
GROUP BY LEFT(CompanyID, 4) 
ORDER BY RIGHT(CompanyID, 4) LIMIT 1;
SELECT @myvar; 
```

* * *

ORDER BY 子句中的表达式有点奇怪。

你为什么要这样订购？聚合只会返回一行。但目前尚不清楚 MySQL 是否忽略了这一点，因为 MySQL 可能无法确定所有满足 WHERE 子句的行都将被组合成一个单独的行。

对于这个特定的语句，LIMIT 1 是多余的。

~~我建议您在没有 ORDER BY 的情况下尝试一下，看看是否有什么不同。~~

~~否则，我倾向于同意聚合函数和 GROUP BY 可能是问题所在。如果是，他们可能的解决方法是将您的语句包装在一组括号中作为内联视图（给它一个别名），然后从内联视图中进行选择。~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:17:58.480

对于简单的 max()，您的查询中不需要“分组依据”、“排序依据”或“限制”。消除这些，如果这不起作用，请尝试围绕它包装另一个查询。

```
select
   value into @myvar
from (
     SELECT
        MAX(CONVERT(RIGHT(CompanyID, 4), UNSIGNED INTEGER)) as value
     FROM
        t10company 
     WHERE
        LEFT(CompanyID, 4) = 'MYCO'
     ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:46:02.983

这很奇怪。

如果将查询包含在另一个查询中，它似乎可以工作。

```
SELECT value FROM (
  SELECT MAX(CONVERT(RIGHT(CompanyID, 4), UNSIGNED INTEGER))
    AS value FROM t10company
  WHERE LEFT(CompanyID, 4) = 'MYCO'     
  GROUP BY LEFT(CompanyID, 4)
  ORDER BY RIGHT(CompanyID, 4) LIMIT 1
) AS weird INTO @myval; 
```

从 EXPLAIN 来看，查询的额外成本应该可以忽略不计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T21:15:49.390

如果您打算这样做，您需要添加`LEFT(CompanyID, 4)`到您的`SELECT`声明（之前）`FROM``GROUP BY LEFT(CompanyID, 4)`

# javascript - JQUERY UI - 选项卡 - 将数据加载到选项卡中，而不使用 IFRAME - 替代选项

> ID：11569352
> 
> 赞同：0
> 
> 时间：2012-07-19T21:09:17.843
> 
> 标签：javascript, jquery, ajax, jsp, jquery-tabs

我目前有一个 JSP 页面，其中包含一个基于 Jquery UI 的手风琴（基于页面的左侧），当您在此手风琴中选择一个选项时，它会启动一个新选项卡（选项卡位于这页纸）

加载到我的新选项卡中的内容来自我项目中的 JSP 页面。我正在使用 IFRAME 执行此操作，但我想知道是否有办法将此 JSP 的数据加载到选项卡中而不是 IFRAME？

该 JSP 包含动态数据、图像和文本。

如果它显示在选项卡本身而不是 IFRAME 中，它会更清晰 - 可用性不是很好。

我可以有哪些 IFRAME 的替代选项来执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:10:51.060

你可以使用jQuery的[加载](http://api.jquery.com/load/)功能，它非常简单易用。

一个很好的例子可以在这里看到：http: [//jsfiddle.net/SO_AMK/TR2kn/](http://jsfiddle.net/SO_AMK/TR2kn/)（点击展开）

一个更简单的例子：http: [//jsfiddle.net/SO_AMK/TR2kn/1/](http://jsfiddle.net/SO_AMK/TR2kn/1/)

但是，请注意，这不能跨域加载数据，因此数据必须在您的服务器上（有一些解决方法，但它们变得复杂）！

# assembly - Masm32 - 寻址模式和数组

> ID：11569353
> 
> 赞同：0
> 
> 时间：2012-07-19T21:09:21.417
> 
> 标签：assembly, x86, masm, addressing-mode

我对寻址模式有点困惑。

```
 array1 DWORD 200 DUP(?) 
```

如果我有这个声明：

```
mov EAX, [EBX + EDI + 10] 
```

EBX 是基数，EDI 是索引，+10 是说向 EDI 添加十个字节？那么，EDI 会返回 14 个字节长吗？并返回地址并将其放入EAX？

同样，

```
mov EAX, [EBX + EDI * 4] 
```

这是说在数组中的任何索引处，返回 4 个字节长吗？因为每个索引的数组长度为 4 个字节，对吧？我想我不明白 * 4 是做什么的！

此外，

```
 mov ECX, 100 ; loop counter
  mov ESI, 0

  top1:

  mov [array1 + ESI * 4], ECX

  inc ESI

  loop top1 
```

这会将数字 100 放入从索引零开始 4 字节大的数组中？那么，索引[0] = 100，索引[1]= 101，索引[2]= 102？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:25:02.353

```
mov EAX, [EBX + EDI + 10] 
```

取值 in`EBX`和 in 相加`EDI`并加 10，然后将此结果作为地址将 32 位值加载到`EAX`.

```
mov EAX, [EBX + EDI * 4] 
```

取 in 的值并将 in 的值`EBX`加 4 倍`EDI`，然后将结果作为地址将 32 位值加载到`EAX`.

最后一个存储从 100 开始的递减数字序列到从 开始的内存位置`array1`。`ECX`每次`loop`指令执行时递减，直到达到 0。每个递增值`ECX`存储的地址是`array1`加 4 倍`ESI`，在每次迭代时递增。

# asp.net - 如何以编程方式从 ASP.NET 代码隐藏提供 HTTP 404 并重定向到 404 页面？

> ID：11569355
> 
> 赞同：2
> 
> 时间：2012-07-19T21:09:26.323
> 
> 标签：asp.net, http-status-code-404

如果找不到请求的内容，我有一个 ASP.NET 应用程序有时会重定向到 404 页面。这是这样做的：

```
var data = MyDatabase.RetrieveData(dataID);
if (data == null)
   Response.Redirect("~/My404Page.aspx"); 
```

这对用户非常有用。但这会导致`302 Found`（重定向），而不是`404 Not Found`，这对于搜索爬虫来说并不理想。我想返回一个 404 状态代码并仍然向用户显示有用的内容。

著名[的互联网上最尴尬的 404 页面](http://visitsteve.com/404.html)就是这样做的；如果您在该域中输入错误的 URL 并使用 Fiddler 之类的内容查看结果，您实际上会得到一个 404 代码。

我试过这个：

```
Response.StatusCode = 404; 
```

这会正确设置 404 代码，但会继续呈现页面。我也试过这个：

```
throw new HttpException(404, "Not Found"); 
```

但这与任何其他未捕获的异常（通过重定向`302`到服务器错误页面）的作用相同。

我已经找到了一种通过一些自定义逻辑在我的应用程序中解决此问题的方法，这些逻辑涉及自己设置状态代码并编写 JavaScript 重定向到响应。但我想要的是一种在代码隐藏中表达该请求应该停止处理并重定向到 404 错误页面（我相信可以在 IIS 或 web.config 中指定）的方法。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:16:12.963

如果您不希望 302 重定向，则需要执行 Server.Transfer 而不是 Repsonse.Redirect。Response.Redirect() 将响应发送回浏览器，告诉它加载您的 ~/My404Page.aspx。Server.Transfer() 将控制权转移到您的 ~/My404Page.aspx 而无需返回浏览器，这意味着您的浏览器不会收到 302 重定向消息。

您还需要确保在 404 页面上将 Response.StatusCode 属性设置为 404。

或者，如果您抛出 HttpException，您可以通过将[redirectMode 属性设置为 ResponseRewrite](http://msdn.microsoft.com/en-us/library/h0hfz6fc%28v=vs.100%29.aspx)来重定向到您的自定义 404 页面，而无需在服务器中执行 302 。这仅适用于较新版本的 ASP.NET。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:15:29.657

在您的 Web 应用程序中使用该`CustomErrors`属性`web.config`：

```
<configuration>
  <system.web>
    <customErrors defaultRedirect="GenericError.htm"
                  mode="RemoteOnly">
      <error statusCode="404"
             redirect="My404Page.aspx"/>
    </customErrors>
  </system.web>
</configuration> 
```

# ms-access - Access 2007 中 VB 中的“未定义用户定义类型”错误

> ID：11569366
> 
> 赞同：5
> 
> 时间：2012-07-19T21:10:05.363
> 
> 标签：ms-access, vba, ms-access-2007, ms-office

我在以下代码行收到编译错误：

```
Dim oXL As Excel.Application 
```

代码在 MS Access 2007 中的 VB 中。上面的行是生成 MS Excel 文件的段的开头。对我来说显而易见的答案是确保在“工具”>“参考”下选中“Microsoft Office 12.0 对象库”。我已经这样做了，但错误仍然存​​在。Excel 是否需要并排安装才能正常工作？我做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-19T21:16:52.113

您需要参考`Microsoft Excel 12.0 Object Library`或使用后期绑定。如果您将与可能安装了不同版本 Excel 的用户共享您的项目，那么后期绑定几乎总是必要的。

对于后期绑定，您将改为：

```
Dim oXL as object
Set oXL = CreateObject("Excel.Application") 
```

然后您的代码应该可以按预期工作，而无需进行引用...假设您没有使用任何其他 Excel 特定值或对象。

# jquery - 记录图像位置

> ID：11569367
> 
> 赞同：0
> 
> 时间：2012-07-19T21:10:17.587
> 
> 标签：jquery, image, positioning

如果之前有人问过这个问题，我先道歉。我尝试研究我的问题，但似乎找不到答案。我有两个箭头图像，单击时会将 div 向左或向右“滑动”60 px，具体取决于单击哪个箭头。我想做的是记录div内第一个img的位置。每次图像发生变化时，我都想比较图像在 X 轴上的位置，并根据数字提供特定的动作。我编写了一个似乎不起作用的脚本（很可能我的逻辑完全关闭）并且每次都提示位置为 0。

```
var p = $("#hd_Thumbs img:first");
var offset = p.offset().left;

alert(offset);

if(offset >= 60) {
alert("No Bueno");

} 
```

谁能指出我正确的方向，或者可能提供一个我可以阅读的网址。我觉得我的逻辑和攻击计划都是错误的。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:19:42.467

谢谢 zerkms，因为我通过再次查看我的 HTML 文件找到了答案。我在 div 中有另一个名为 thumbs_Container 的 div，它正在收集我的图像。一旦我改变了我的代码，它就起作用了。对于遇到同样问题的任何人来说，逻辑似乎是正确的。他是我更正的代码：

```
var p = $("#thumbs_Container img:first");
var offset = p.offset().left;

alert(offset);

if(offset >= 60) {
alert("No Bueno");

} 
```

我的任何 HTML 都是：

```
<div id="hd_Thumbs">

<div id="thumb_Left"><img src="images/prev_Thumb.png" alt="Previous Thumbnail" width="60px" height="60px" onclick="prevThumb()" id="lefty"  /></div>
<div id="thumb_Right"><img src="images/next_Thumb.png" alt="Next Thumbnail" width="60px" height="60px" onclick="nextThumb()" id="righty"  /></div>
<div id="thumbs_Container">
<?php echo $xmlData; ?>
</div>
</div> 
```

# json - 自动网络爬虫

> ID：11569368
> 
> 赞同：1
> 
> 时间：2012-07-19T21:10:34.027
> 
> 标签：json, web-crawler

我正在编写一个需要从许多网站获取数据的爬虫。问题是每个网站都有不同的结构。如何轻松编写从（许多）不同网站（正确）下载数据的爬虫？如果网站结构发生变化，我需要重写爬虫，还是有其他方法？

可以使用哪些逻辑和实施的工具来提高自动网络爬虫（许多网站涉及不同的结构）挖掘的数据质量？

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:22:23.743

我假设您想以某种方式查询它，在这种情况下，您应该将数据存储在灵活的数据存储中。关系数据库不适合用于目的，因为它具有严格的模式，但是像[mongodb](http://www.mongodb.org/)这样可以让您存储半结构化数据而无需预先定义模式，但仍然提供强大的查询语言。

在爬虫代码中表示数据的方式也是如此。不要将数据映射到预先定义结构的类，而是使用可以在运行时更改的灵活数据结构。如果您使用的是 Java，则将数据反序列化为 HashMap。在其他语言中，这可能被称为字典或哈希。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:29:52.227

如果您从实际上希望允许您这样做的网站上抓取数据，那么他们很可能会提供某种网络服务，以允许您以结构化的方式查询他们的数据。

否则，您只能靠自己，甚至可能违反他们的使用条款。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T21:07:23.283

如果这些网站没有提供 API，那么你就冷了，你必须为遇到的每种数据格式编写单独的提取模块。如果网站改变了格式，那么你必须更新你的格式模块。一个标准的做法是为您正在抓取的每个网站都安装插件，并拥有一个测试框架，该框架使用您已经收集的数据进行回归测试。当测试失败时，您就知道出了问题，您可以调查是否必须更新格式插件或是否存在其他问题。

在不知道您正在收集什么样的数据的情况下，很难尝试假设如何提高所挖掘数据的“质量”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-20T08:30:23.003

Maybe you could find out whether the website allows you to access the data like API, if so, you could use this kind of structured data to your website directly. If not, you may need plugins for that. Or you could turn to other web crawlers with API access like [Octoparse](http://www.octoparse.com/), to find the way to access their API to your own web crawler.

# xslt - XPATH 选择类型元素名称为 xs:simpleType 的子元素

> ID：11569370
> 
> 赞同：3
> 
> 时间：2012-07-19T21:10:41.343
> 
> 标签：xslt, xpath

我正在尝试选择序列中实现类型的元素名称为 xs:simpleType 的所有子元素。

```
<xs:complexType name="Truck">
    <xs:complexContent>
        <xs:extension base="Car">
            <xs:sequence>
                <xs:element name="DriverName" type="Name">
                    ...
                </xs:element>
                <xs:element name="Engine" type="TruckEngine">
                    ...                   
                </xs:element>
            </xs:sequence>
        </xs:extension>
    </xs:complexContent>
</xs:complexType> 
```

“名称”类型如下所示：

```
<xs:simpleType name="Name">
    ...
</xs:simpleType> 
```

“卡车引擎”看起来像：

```
<xs:complexType name="TruckEngine">
    ... 
</xs:complexType> 
```

如何创建 XPATH 来选择元素 DriverName？到目前为止，我有类似 xs:complexType/xs:complexContent/xs:extension/xs:sequence/xs:element 的东西，但我不知道如何进一步改进我的选择。我很难搜索相关信息，因为我不确定使用什么术语来选择这样的东西。我已将示例修改为更通用的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T08:23:48.317

除非您知道架构作者使用的约定，否则尝试从架构文档中提取信息是困难的（几乎是不可能的）。例如，来自 DevNull 的解决方案（您已接受）仅适用于在同一模式文档中定义的类型，它仅适用于命名（非匿名）类型，并且仅适用于没有 targetNamespace 的模式文档.

对于更通用的解决方案，无论创作约定如何，它都适用于任何模式，不要尝试这样做：使用模式 API，它允许您在模式处理器分析后访问“熟”的模式组件。一种方法是使用为模式组件提供 Java API 的 Xerces，另一种方法是使用 Saxon 的 SCM 格式，该格式在单个文档中提供“已处理”模式组件的 XML 表示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:37:17.070

你可以使用：

```
//xs:element[@type = //xs:simpleType/@name] 
```

尽管我建议使用更明确的路径而不是使用`//`.

（编辑：更改`eq`为`=`）

# python - 为什么这个函数向后打印一个链表？

> ID：11569371
> 
> 赞同：4
> 
> 时间：2012-07-19T21:10:42.433
> 
> 标签：python, linked-list

我正在研究 Downey 的 How To Think Like a Computer Scientist，我对他的[Linked List](http://cs.nyu.edu/courses/fall12/CSCI-UA.0002-006/misc/httlacs.pdf)的 print_backward() 函数有疑问。

首先，这是 Downey 在 Python 中实现的链表：

```
 class Node:
     #initialize with cargo (stores the value of the node)
     #and the link. These are set to None initially.
     def __init__(self, cargo = None, next = None):
         self.cargo = cargo
         self.next = next

     def __str__(self):
         return str(self.cargo) 
```

我们给这个类以下货物和链接值：

```
 #cargo
 node1 = Node('a')
 node2 = Node('b')
 node3 = Node('c')
 #link them 
 node1.next = node2
 node2.next = node3 
```

为了打印链表，我们使用了 Downey 的另一个函数。

```
def printList(node):
     while node:
         print node,
         node = node.next

 >>>printList(node1)
 >>>a b c 
```

一切都非常简单。但我不明白以下函数中的递归调用如何允许向后打印链表。

```
def print_backward(list):
     if list == None : return
     print_backward(list.next)
     print list,

>>>print_backward(node1)
>>>c b a 
```

调用“list.next”作为 print_backward 的值不会简单地给你“b c”吗？

注意：下面的一些人指出这个函数设计得很糟糕，因为给定任何列表，我们不能证明它总是会达到基本情况。唐尼也在同一章后面指出了这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:29:57.077

在正向打印版本中，它在执行递归调用之前打印每个节点。在反向打印版本中，它在执行递归调用*后打印每个节点。*

这并非巧合。

这两个函数都会递归，直到到达列表的末尾。不同之处在于打印是在此过程中还是之后进行。

函数调用使用堆栈，这是一种后进先出数据结构，可记住在进行函数调用时计算机执行代码的位置。以一种顺序放入堆栈的内容以相反的顺序取出。因此，递归以与原始调用相反的顺序“展开”。打印发生在展开过程中，即在每个递归调用完成之后。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:21:49.617

```
def print_backward(list):
     if list == None : return
     print_backward(list.next)
     print list, 
```

> 调用“list.next”作为 print_backward 的值不会简单地给你“b c”吗？

不; 想象一下当 a->b->c 被传递给 print_backward 时会发生什么：

"[bc]" 被传递给 print_backward，然后 "a" 被打印出来。但是在打印“a”之前，“print_backward”会调用自身。所以：

*   [ abc ] 不是 None，所以 b->c 被传递给 print_backward
    *   [ bc ] 被传递给 print_backward
        *   [ c] 被传递给 print_backward
        *   没有传递给 print_backward
            *   返回
        *   然后打印“c”
    *   然后打印“b”
*   然后打印“a”
*   退出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T21:29:54.317

有时我发现更容易将递归视为仅构建要按特定顺序进行的调用列表。随着函数的继续，它会建立一堆调用，直到最终到达基本情况。基本情况是不需要进一步分解程序的情况；在这个函数中，基本情况是没有要打印的内容，在这种情况下，我们不做任何事情就离开`return`。

当我们展开函数调用的递归堆栈时，很酷的事情通常发生在返回的路上。目前，`print_backward`已在列表的每个元素上调用，它现在将“展开”，首先完成最近的调用，最后完成较早的调用。这意味着`print_backward`在最后一个元素上调用 created 的“实例”是第一个完成的，因此最后一个元素是第一个要打印的元素，然后是倒数第二个、倒数第三个等。 , 直到原始函数最终退出。

看一下发生的事情的这种表示：

```
print_backward(node1)            #first call to print_backward
    print_backward(node2)        #calls itself on next node
        print_backward(node3)    #calls itself on next node
            print_backward(None) #calls itself on None. We can now start unwinding as this is the base case:
        print Node3              #now the third invocation finishes...
    print Node2                  #and the second...
print Node1                      #and the first. 
```

虽然函数首先在较早的元素上调用，但实际打印该元素的部分出现在递归调用之后，因此在递归调用完成之前它不会真正执行。在这种情况下，这意味着在`print list`所有后面的元素都首先打印（以相反的顺序）之前，该部分不会执行，从而为您提供向后打印的列表元素。:D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T21:20:34.493

如果列表不是无，它调用 print_backward，然后打印列表的第一个成员。扩展，这就是发生的事情。您可以看到，当调用开始返回时，会打印“c”，然后是“b”，然后是“a”。

看起来在实际打印列表时，它会打印第一个节点

```
print_backward(list='a','b','c')
  print_backward(list='b','c')
    print_backward(list='c')
      print_backward(list=None)
        list is None, so return
      print 'c'
    print 'b','c'
  print 'a','b','c' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T21:14:49.900

它使用递归。它一直“压缩”到最后，然后在每次调用返回时打印每个元素。由于第一个要打印的是最近调用的，它向后打印列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-19T21:16:26.587

不，有两种递归：

1.  尾递归：如果函数返回后除了返回它的值之外什么都不做。函数调用不堆叠。
2.  首先找到基本情况的递归（在这种情况下，`null`，然后向后处理列表）。每个函数调用都被压入堆栈，以供以后处理。在您的示例中，该函数被堆叠为`'a'->'b'->'c'->null`，然后当堆栈被弹出时，作者通过向后打印表明：`if null return: print 'c' -> print 'b' -> print 'a'

在您的情况下，作者仅演示了一个不同的递归概念，并使用它来向后打印列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-19T21:16:47.170

您的节点如下所示：

```
node1 node2 node3
'a' => 'b' => 'c' => None 
```

在第一次调用 时`print_backward`，变量`list`的值为`'a'`，随后调用`print_backward`将进一步向下移动。请注意，`None`在您点击警卫（ ） 等等。`print_backward``'c'``print_backward``'b'`

虽然我认识到这是别人的代码，但这里有一些不好的做法——最好我现在告诉你，在你学习的时候而不是以后。首先，不要`list`用作变量名，因为它是 python 中内置函数/类型的名称。其次，相等性测试`if obj == None`最好由 完成`if obj is None`，最后，让你的类继承自`object`( `class node(object):`) 总是一个好主意，因为这使它成为一个新型类。

# flash-builder - Flash Builder 不再启动

> ID：11569379
> 
> 赞同：0
> 
> 时间：2012-07-19T21:11:28.153
> 
> 标签：flash-builder

好老的 Flash 生成器。现在不再开始了。多次重新安装后，我被卡住了。Adobe 没有帮助，所以我束手无策。这是日志：

```
!SESSION 2012-07-19 22:04:01.466 -----------------------------------------------
eclipse.buildId=I20100608-0911
java.version=1.6.0_33
java.vendor=Apple Inc.
BootLoader constants: OS=macosx, ARCH=x86, WS=cocoa, NL=en_US
Framework arguments:  -keyring /Users/ahmed/.eclipse_keyring -showlocation
Command-line arguments:  -os macosx -ws cocoa -arch x86 -keyring /Users/ahmed/.eclipse_keyring -consoleLog -showlocation

!ENTRY org.eclipse.equinox.p2.engine 4 4 2012-07-19 22:04:19.445
!MESSAGE An error occurred while committing the engine session for profile: epp.package.java.
!SUBENTRY 1 org.eclipse.equinox.p2.touchpoint.eclipse 4 0 2012-07-19 22:04:19.445
!MESSAGE 
!SUBENTRY 2 org.eclipse.equinox.p2.touchpoint.eclipse 4 0 2012-07-19 22:04:19.445
!MESSAGE Error saving manipulator.
!STACK 0
java.lang.NullPointerException
    at org.eclipse.equinox.internal.frameworkadmin.equinox.EquinoxFwConfigFileParser.saveFwConfig(EquinoxFwConfigFileParser.java:494)
    at org.eclipse.equinox.internal.frameworkadmin.equinox.EquinoxManipulatorImpl.save(EquinoxManipulatorImpl.java:407)
    at org.eclipse.equinox.internal.p2.touchpoint.eclipse.LazyManipulator.save(LazyManipulator.java:96)
    at org.eclipse.equinox.internal.p2.touchpoint.eclipse.EclipseTouchpoint.saveManipulator(EclipseTouchpoint.java:61)
    at org.eclipse.equinox.internal.p2.touchpoint.eclipse.EclipseTouchpoint.commit(EclipseTouchpoint.java:137)
    at org.eclipse.equinox.internal.p2.engine.EngineSession.commit(EngineSession.java:123)
    at org.eclipse.equinox.internal.p2.engine.Engine.perform(Engine.java:93)
    at org.eclipse.equinox.internal.p2.engine.Engine.perform(Engine.java:44)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.ProfileSynchronizer.executePlan(ProfileSynchronizer.java:768)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.ProfileSynchronizer.performAddRemove(ProfileSynchronizer.java:189)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.ProfileSynchronizer.synchronize(ProfileSynchronizer.java:128)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.Activator.synchronize(Activator.java:461)
    at org.eclipse.equinox.internal.p2.reconciler.dropins.Activator.start(Activator.java:176)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl$1.run(BundleContextImpl.java:711)
    at java.security.AccessController.doPrivileged(Native Method)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.startActivator(BundleContextImpl.java:702)
    at org.eclipse.osgi.framework.internal.core.BundleContextImpl.start(BundleContextImpl.java:683)
    at org.eclipse.osgi.framework.internal.core.BundleHost.startWorker(BundleHost.java:381)
    at org.eclipse.osgi.framework.internal.core.AbstractBundle.resume(AbstractBundle.java:389)
    at org.eclipse.osgi.framework.internal.core.Framework.resumeBundle(Framework.java:1130)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:559)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.resumeBundles(StartLevelManager.java:544)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.incFWSL(StartLevelManager.java:457)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:243)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:438)
    at org.eclipse.osgi.framework.internal.core.StartLevelManager.dispatchEvent(StartLevelManager.java:1)
    at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230)
    at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340)

!ENTRY org.eclipse.ui 2 0 2012-07-19 22:04:20.888
!MESSAGE Warnings while parsing the commands from the 'org.eclipse.ui.commands' and 'org.eclipse.ui.actionDefinitions' extension points.
!SUBENTRY 1 org.eclipse.ui 2 0 2012-07-19 22:04:20.889
!MESSAGE Commands should really have a category: plug-in='com.qnx.flashbuilder.multiplatform.qnx.ui', id='com.qnx.flashbuilder.multiplatform.qnx.ui.commands.OpenInfoCenter', categoryId='com.qnx.flashbuilder.multiplatform.qnx.ui.commands.category.help'

!ENTRY org.eclipse.core.net 1 0 2012-07-19 22:04:23.363
!MESSAGE System property http.nonProxyHosts has been set to local|*.local|169.254/16|*.169.254/16 by an external source. This value will be overwritten using the values from the preferences 
```

我不太清楚为什么会出现这个`Error saving manipulator`问题，愚蠢的 Flash Builder！

# java - 获取谷歌搜索结果的数量

> ID：11569381
> 
> 赞同：5
> 
> 时间：2012-07-19T21:11:29.333
> 
> 标签：java, search

我进行了很多搜索以使用 java 在 google 中检索搜索结果的数量，但没有任何效果。我也尝试过 Google 自定义搜索 API。我不想要结果的标题/网址，只想要找到的总结果数。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T21:38:14.580

通过使用自定义搜索 API，您走在了正确的道路上。

您从查询中获得的[响应 JSON](https://developers.google.com/custom-search/v1/using_rest#WorkingResults)中有一个`totalResults`键。只要抓住它的价值，你就完成了。

如果您希望 JSON 仅包含该值，请将[`fields`](https://developers.google.com/custom-search/v1/using_rest#st_params)参数添加到查询中，如下所示：

```
https://www.googleapis.com/customsearch/v1?key={YOUR_API_KEY}&cx={YOUR_SEARCH_ENGINE_ID}
    &q={YOUR_SEARCH_STRING}&alt=json&fields=queries(request(totalResults)) 
```

# php - Netbeans Git无法将文件添加到存储库

> ID：11569391
> 
> 赞同：2
> 
> 时间：2012-07-19T21:12:38.310
> 
> 标签：php, git, netbeans

NetBeans IDE 7.1.2，Git 用户指南 (http://netbeans.org/kb/docs/ide/git.html) 说我应该在初始化 Git 存储库后在项目窗口中看到一个文件提示.

我从未见过说添加了任何文件的顶部提示。

所以接下来我尝试了提交，提交对话框说没有文件。

于是我尝试创建一个分支并得到“COMMIT [HEAD] 不存在”！

桌面是 Windows 7，我是 Netbeans、Git 和 PHP 的新手，可能只是缺少一些非常基本的东西。

TIA，乔治

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:17:39.687

在提交文件之前，您需要添加它。命令行命令是：

```
> git add * 
```

我建议您在命令行上执行初始提交（当您使用 Windows 时，使用 git-bash 这是一个很棒的工具）。添加之后，Netbeans 应该能够进行提交，并且从那时起，Netbeans 应该能够按照宣布的方式工作。

万一你觉得 git-bash 更舒服，你可以*随时*回到那里。您可以将 Netbeans git 集成与 git bash 并行使用。Git 会处理这个问题。所以你得到了两个世界中最好的（只要谷歌你遇到的任何 git 问题，至少你应该能够在 git bash 中解决它——如果不是在 netbeans 中）。

# android - 如何在不使用 aapt 的情况下使用多个 -S 值 ?

> ID：11569393
> 
> 赞同：9
> 
> 时间：2012-07-19T21:12:48.370
> 
> 标签：android, aapt

我正在尝试通过从命令行使用 aapt 来构建 R.java。我指定多个`-S`目录，因为我有多个`res`目录。我正在使用以下方法构建：

```
aapt package \
  -M AndroidManifest.xml \
  -m -J gen \
  -S src/com/example/res \
  -S src/com/example/ui/res 
```

不幸的是，我收到以下错误：

```
src/com/example/ui/res/values/strings.xml:2: error: Resource at app1_name appears in overlay but not in the base package; use <add-resource> to add. 
```

目前，`src/com/example/ui/res/values/strings.xml`包含以下内容：

```
<resources>
    <string name="app1_name">MyAppName</string>
</resources> 
```

我宁愿不必将其更改为：

```
<resources>
    <add-resource type="string" name="app1_name">MyAppName</add-resource>
</resources> 
```

（这是在[https://groups.google.com/forum/?fromgroups#!topic/android-porting/bYfeLEjERjg](https://groups.google.com/forum/?fromgroups#!topic/android-porting/bYfeLEjERjg)上提出的，尽管它似乎并没有解决我的问题。）

我对`-S`论证应该如何运作的期望是否被误导了？

我能想到的唯一解决方法是将我的所有目录符号链接`-S`为根`res`目录的子目录并指定`res`为唯一`-S`目录。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-07-20T15:28:55.697

我相信解决方案是使用`--auto-add-overlay`标志。我通过使用`-v`详细模式运行默认的 Ant 构建脚本发现了这一点。

# javascript - gwt-exporter：导出接口

> ID：11569396
> 
> 赞同：2
> 
> 时间：2012-07-19T21:13:19.460
> 
> 标签：javascript, gwt

我在 GWT 中有一个项目，我正在尝试使用 GWT-exporter 导出到 javascript。问题是我有一个需要导出的接口并让客户端提供方法的实现。例如：

```
@Export

public interface Listener extends Exportable{
    public void method1();

    public void method2();
} 
```

有人可以帮我解决这个问题吗？如果我不能导出这个，我应该如何解决这个问题？我不太了解javascript，所以任何建议都会有所帮助。谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:35:42.540

你可以导出一个接口并使用它导出方法，但你不能从 js 实例化它的对象，除非你也导出一个类。如果要使用 js 函数提供方法的实现，则必须使用 @ExportClosure 注释。

# delphi - 在另一个表单上调用程序？

> ID：11569398
> 
> 赞同：3
> 
> 时间：2012-07-19T21:13:24.630
> 
> 标签：delphi, delphi-7, tadotable

我确定以前有人问过这个问题，但我似乎找不到。我使用下面的代码显示来自 MS Access 数据库的图像。但是，我想知道如何执行以下操作：

- 是否可以采取以下程序并以另一种形式“调用”它？

***场景***：三种形式。三表一库。我通过 TADOTable 组件和 TADOConnection 访问表。

每个表单都有一个按钮 (btnShowImage)，用于显示来自数据库的图片。为了让它当前工作，我需要将函数添加到表单中，然后在 btnShowImage.OnClick 中，添加如下所示的过程。这发生在所有三种形式上。我的问题是：有没有办法让它更有效率。由于将这段代码添加到所有三个表单似乎有点乏味，如果它基本上是相同的（请记住，在过程中，所有三个表单的表名都不同）。有没有更简单的方法（显示图像），而不必在每个表单上使用所有这些代码？

谢谢你的帮助！

*代码：*

```
...uses
    JPEG, ADODB, DB

function JpegStartsInBlob(PicField: TBlobField): integer;
var
  bS: TADOBlobStream;
  buffer: Word;
  hx: string;
begin
  Result := -1;
  bS := TADOBlobStream.Create(PicField, bmRead);
  try
    while (Result = -1) and (bS.Position + 1 < bS.Size) do begin
      bS.ReadBuffer(buffer, 1);
      hx := IntToHex(buffer, 2);
      if hx = 'FF' then begin
        bS.ReadBuffer(buffer, 1);
        hx := IntToHex(buffer, 2);
        if hx = 'D8' then
          Result := bS.Position - 2
        else if hx = 'FF' then
          bS.Position := bS.Position - 1;
      end;
    end;
  finally
    bS.Free
  end;
end;

procedure Tfrm3.btnShowImageClick(Sender: TObject);
var
  bS: TADOBlobStream;
  Pic: TJPEGImage;
begin
  bS := TADOBlobStream.Create(table1.FieldByName('Photo')
    as TBlobField, bmRead);
  bS.Seek(JpegStartsInBlob(table1.FieldByName('Photo') as TBlobField),
    soFromBeginning);
  Pic := TJPEGImage.Create;
  Pic.LoadFromStream(bS);
  frmOne.Image1.Picture.Graphic := Pic;
  Pic.Free;
  bS.Free;
end; 
```

代码位于：[http ://delphi.about.com/od/database/l/aa030601d.htm](http://delphi.about.com/od/database/l/aa030601d.htm)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:26:36.427

如果我有必须从 3 个不同表单上的按钮调用的代码，除了与每个单独表单的上下文有一些特定差异之外，这在所有地方几乎都是相同的，我会做的是获取代码，将其放入单位，并将差异转化为参数。例如：

```
procedure LoadJPEGImage(field: TBlobField; image: TImage);
var
  bS : TADOBlobStream;
  Pic : TJPEGImage;
begin
  bS := TADOBlobStream.Create(field, bmRead);   
  Pic := TJPEGImage.Create;
  try
    bS.Seek(JpegStartsInBlob(field), soFromBeginning);
    Pic.LoadFromStream(bS);
    image.Picture.Graphic := Pic;
  finally
    Pic.Free;
    bS.Free;
  end;
end; 
```

现在代码不关心表单或其任何细节；它只需要一个 TBlobField 来读取和一个 TImage 来绘制图片，您可以在任意数量的表单上使用它。

# iphone - 使用情节提要在 XCode 中更改条件后的视图

> ID：11569407
> 
> 赞同：0
> 
> 时间：2012-07-19T21:14:26.317
> 
> 标签：iphone, xcode, mobile

我正在开发 iPhone 应用程序。我想使用情节提要进行视图切换，但我有条件，我想在满足条件后进行更改。我怎样才能使用故事板做到这一点？

提前致谢..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T21:20:50.943

使用转场。

首先，您在故事板内部设置了这样的转场：

![第一张截图](../Images/bb44cd6cad939095969a299b7748c2a4.png)

然后，您将 segue 的标识符编辑为某种东西，在这种情况下，`NextView`：

![在此处输入图像描述](../Images/c4d4ca8e0b6cedcaab36ff6377d6b500.png)

然后，最后，在您的 ViewController 中，当您想要切换视图时，调用以下代码：

```
[self performSegueWithIdentifier:@"NextView" sender:self]; 
```

# c++ - 将带有指向数组的指针的类从 C++ 传递到 CUDA

> ID：11569408
> 
> 赞同：1
> 
> 时间：2012-07-19T21:14:47.483
> 
> 标签：c++, performance, cuda

我在 C++ 中有以下类：

```
template<typename T>
class dynArray {

 public:
    T *elements;
    int size;
    int capacity;
    int initCapacity;
} 
```

有什么方法可以复制此类的对象以在 CUDA 内核中使用`cudaMemcpy()`，而无需逐个复制其内容元素？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T08:47:33.830

## 最初的想法

对我来说，您似乎希望`std::vector<>`在 GPU 上拥有类似的东西。如果您只需要 GPU 全局内存中的数据或向量的大小，我会给出真正考虑的建议。恕我直言，GPU 上的代码实际上应该只修改数组的数据，而不是调整数组本身的大小。这是应该在主机上完成的事情。

[有一个名为AGILE](https://lamp2.tugraz.at/%7Eimt/joomla15/index.php/research/agile-gpu-image-reconstruction-library)的开源库，它实现了一个`GPUVector`基本上类似于`std::vector<>`GPU 上的东西。`GPUVector`存储容量、大小和指向 GPU 内存的指针。在 a 上运行的内核`GPUVector`获取指向内存区域的指针和大小作为参数，即内核调用看起来像这样：

```
GPUVector v;
[... initialize v...]
computationKernel<<<blockDim, gridDim>>>(v.data(), v.size()); 
```

将其翻译为您的课程，`GPUVector::data()`只会返回`dynArray::elements`（指向**GPU 内存**）并`GPUVector::size()`返回`dynArray::size`。应该保留在 CPU 端，`dynArray::size`因为您很可能不想从 GPU 代码修改它（例如，因为您无法`cudaMalloc`从 GPU 调用）。如果你不修改它，你也可以将它作为参数传递。

您可能想要查看的另一个库是[Thrust](http://thrust.github.com/)，它还在 GPU 上提供了类似 STL 的向量。

## dynArray 的一种复制方法

由于仍然需要复制整个数组，我建议采用以下方法：

```
template<typename T>
class dynArray 
{
  public:
    //! Copies this dynArray to the GPU and returns a pointer to the copy.
    void* copyToDevice()
    {
        // Copy the dynArray to the device.
        void* deviceArray;
        cudaMalloc(&deviceArray, sizeof(dynArray<T>));
        cudaMemcpy(deviceArray, this, sizeof(dynArray<T>), 
                   cudaMemcpyHostToDevice);

        // Copy the elements array to the device.
        void* deviceElements;
        cudaMalloc(&deviceElements, sizeof(T) * capacity);
        cudaMemcpy(deviceElements, elements, sizeof(T) * capacity, 
                   cudaMemcpyHostToDevice);

        // On the device, the elements pointer has to point to deviceElements.
        cudaMemcpy(deviceArray, deviceElements, sizeof(T*),
                   cudaMemcpyHostToDevice);

        return deviceArray;
    }

    T *elements;
    int size;
    int capacity;
    int initCapacity;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T07:46:37.060

我认为指针`element`将是一个问题，因为您必须`elements`单独复制数组的内容，然后指针会被弄乱（即它不会指向`element`GPU 上的数组）。我建议分别复制元素数组和大小/容量值。

# wpf - Devexpress ComboBoxEditSettings 未绑定到 WPF 中的 ViewModel

> ID：11569412
> 
> 赞同：2
> 
> 时间：2012-07-19T21:15:01.180
> 
> 标签：wpf, xaml, grid, devexpress

我在使用 ComboBoxEditSettings 时遇到了 DevExpress wpf 网格绑定问题。下面是网格。我将“关联井类型”列绑定到我的 ViewModel 上的一个属性。但是，当我从组合框中选择一些项目然后单击“确定”时，我会在单元格中看到所选项目，但它们不会绑定回我的 ViewModel。那么，我需要对“确定”按钮的点击事件做些什么吗？绑定中是否有我没有正确设置的东西？上述所有的？在此先感谢您的帮助。

```
<ctrls:GridControl Grid.Row="2" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" Margin="5" 
                               dx:ThemeManager.ThemeName="Office2007Blue"
                               x:Name="gridControlForms" VerticalAlignment="Stretch"
                               ShowLoadingPanel="{Binding TaxFormsIsBusy}"
                               ItemsSource="{Binding TaxFormList}" >
<ctrls:GridControl.Columns>
            <dxg:GridColumn FieldName="DisplayName" Header="Form Name" VisibleIndex="1" AllowMoving="False" />
            <dxg:GridColumn ReadOnly="True" FieldName="PrintSequence" Header="Print Sequence" VisibleIndex="2" AllowMoving="False" />
            <dxg:GridColumn Header="Associated Well Types" FieldName="SelectedWellTypes" VisibleIndex="3" AllowMoving="False" AllowBestFit="True" Width="300" >
                <dxg:GridColumn.EditSettings>
                            <dxe:ComboBoxEditSettings ItemsSource="{Binding WellTypes}" DisplayMember="WellType" ValueMember="RenditionStateFormWellTypeId" IsTextEditable="False" >
                                <dxe:ComboBoxEditSettings.StyleSettings>
                                            <dxe:CheckedComboBoxStyleSettings />
                                </dxe:ComboBoxEditSettings.StyleSettings>
                            </dxe:ComboBoxEditSettings>
                </dxg:GridColumn.EditSettings>
            </dxg:GridColumn>
</ctrls:GridControl.Columns>           
<ctrls:GridControl.View>
            <dxg:TableView ShowGroupPanel="False"  BestFitArea="All" AllowSorting="False" 
                                   FocusedRow="{Binding SelectedTaxForm, Mode=TwoWay}" AllowColumnFiltering="False" />
</ctrls:GridControl.View> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T13:43:31.370

我发现了问题：网格抛出“对象必须实现 IConvertible”错误。一旦发现这一点，我将 SelectedWellTypes 从 int 更改为 IEnumberable 类型的对象，并在视图模型中进行了适当的转换。这允许绑定发生。

# javascript - 服务器不会同时响应多个 AJAX 请求

> ID：11569413
> 
> 赞同：0
> 
> 时间：2012-07-19T21:15:04.117
> 
> 标签：javascript, ajax, linux

在我制作的网站中，我们使用箭头聊天插件。Arrowchat 在大约 30 秒内发送一次 AJAX 请求以获取在线 ppl 列表。

另一方面，网站的导航系统也使用 AJAX 请求从服务器获取响应并将内容加载到 div。

问题是当arrowchat 发送AJAX 请求时，如果用户点击导航链接，浏览器不会发送请求，直到arrowchat 的AJAX 请求完成。

我怎样才能让它运行 AJAX 请求并从服务器并行获取响应？

导航AJAX系统；

```
$("#ajax_content").load("page.php?querys..", function () {
                    $("body").animate({
                        scrollTop: 0
                    }, 800);
                }) 
```

编辑：我已经使用 AJAX 作为异步

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:30:43.570

您很可能被会话锁定。如果你在你的 php 中使用会话——那么只要你不再需要它就可以执行`session_write_close`。`page.php`

否则其他请求等待会话文件被解锁（在脚本结束时）

# linux - linux核心转储大小翻倍

> ID：11569415
> 
> 赞同：1
> 
> 时间：2012-07-19T21:15:17.077
> 
> 标签：linux, debugging, linux-kernel, stack-dump

我手头有一个相当奇怪的问题。我正在尝试使用 linux 2.6.35-14 设置 kdump/kexec。

一切正常，我正在通过“echo c > /proc/sysrq-trigger”影响崩溃。

但是，我看到每次调用崩溃时核心文件的大小都会生成双倍！:s:s

*   第一次崩溃：347Mb
*   第二次崩溃：622Mb
*   第三次崩溃：1.2Gb
*   第四次崩溃：2.2Gb

人们会知道为什么会这样吗？因此解决方案可能是什么？

非常感谢。

# regex - 正则表达式匹配相似分隔符之间的字符串

> ID：11569419
> 
> 赞同：1
> 
> 时间：2012-07-19T21:15:38.580
> 
> 标签：regex

我有一长串

Blah Blah Blah **** *Some text 1 blah* **** More Blah... **** *Some text 2 blah* **** blah bleh...

我想提取“**”之间的字符串，所以我会得到

> 一些文字 1 blah
> 
> 一些文字 2 等等

我尝试使用：

```
var expression = @"(?<=**)(.*?)(?=**)";
var matches = Regex.Matches(theLargeString, expression); 
```

但它抛出一个错误：

```
parsing "(?<=**)(.*?)(?=**)" - Quantifier {x,y} following nothing. 
```

我是正则表达式的新手......有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:30:34.730

你需要逃避 *s...

```
\*\*(.*?)\*\* 
```

正则表达式示例 1 ![在此处输入图像描述](../Images/b2a3e466f9293496f582c505d3c211a3.png)

# javascript - 使用 jquery.validate 遍历每个失败的规则

> ID：11569420
> 
> 赞同：1
> 
> 时间：2012-07-19T21:15:40.707
> 
> 标签：javascript, jquery, validation, jquery-validate, unobtrusive-validation

在使用 jquery.validate 库验证我的表单后，我需要能够遍历当前失败的规则。

我看过以下内容：

```
$('form').validate().errorList 
```

这将返回错误的消息和元素，但不返回失败规则的规则/名称。

```
$('form').validate().errorMap 
```

这只是返回一个元素 ID/消息对。

```
$('form').validate().settings.rules 
```

这将返回所有元素及其关联规则的列表，但没有指示当前失败的值。

我需要包含元素（或其 ID）和失败规则的东西。当然，一个元素可以映射到多个失败的规则。

如果有一个事件我可以与不显眼的库挂钩（因为并非所有事件似乎都受到不显眼的支持）会给我失败的规则和元素，这将是理想的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T17:08:33.863

如果您正在寻找一种可以与扩展一起使用的方法，您可以执行以下操作：

```
//update FormatAndAdd function to store failed rule values in data
var oldFormatAndAdd = validator.formatAndAdd;

validator.formatAndAdd = function (element, rule) {
    oldFormatAndAdd.apply(this, arguments);
    $.data(element, "failedMethod", rule.method);
};

var oldCheck = validator.check;

//update check to remove failed rules from data if element is valid
validator.check = function (element) {
    var result = oldCheck.apply(this, arguments);
    if (result) {
        $.data(element, "failedMethod", null);
    }
}; 
```

我只是将规则信息存储在数据中，但我相信您可以更新它来操作 errorList。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:31:22.663

validate() 函数初始化小部件；它不验证表单。您需要为无效表单指定处理程序，如下所示：

```
$("form").validate({
    invalidHandler: function(form, validator) { 
```

完成此操作后，**验证器对象将在其****errorList**属性中包含一组无效元素。

此处的完整文档：http: [//docs.jquery.com/Plugins/Validation/validate#options](http://docs.jquery.com/Plugins/Validation/validate#options)

根据您的评论，理论上您可以修改第 585 行以将规则方法包含到 errorList 中：

```
this.errorList.push({
    method: rule.method,
    message: message,
    element: element
}); 
```

我已经用基本规则对其进行了测试，但如果你有自定义函数验证器，你也应该尝试一下。

# facebook - 如果我不显示统计信息，我如何查看 Facebook 分享、Twitter 推文和 Google Plus 分享计数？

> ID：11569425
> 
> 赞同：0
> 
> 时间：2012-07-19T21:16:03.420
> 
> 标签：facebook, twitter

在我的网站上，我使用自定义 Facebook 分享、Twitter 推文和 Google Plus 分享按钮；但是，我没有向用户显示共享的数量。作为一名网络管理员，我如何才能在不向用户显示前端的情况下查看共享统计信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:37:54.950

您可以在 Google 网站管理员工具中查看 +1 统计信息（仪表板->流量->+1 报告）：

[https://www.google.com/webmasters/tools/search-impact?hl=en&siteUrl=YOURURLHERE](https://www.google.com/webmasters/tools/search-impact?hl=en&siteUrl=YOURURLHERE)

对于 Facebook，您可以查看“Facebook Insights”。更多信息在这里：

[https://www.facebook.com/help/?faq=122126631202357#How-do-I-see-Insights-for-my-website](https://www.facebook.com/help/?faq=122126631202357#How-do-I-see-Insights-for-my-website)？

[https://www.facebook.com/help/?faq=204330989603519#What-metrics-are-available-through-the-Insights-API](https://www.facebook.com/help/?faq=204330989603519#What-metrics-are-available-through-the-Insights-API)？

也许其他人可以在 Twitter 上提供信息。

# r - ROAuth 和推特，Mac OS X 10.7，R 2.15

> ID：11569426
> 
> 赞同：0
> 
> 时间：2012-07-19T21:16:10.720
> 
> 标签：r, api, twitter, oauth

我很难让我的 OAuth 正常工作，以便每小时可以对 twitter 的 API 进行 350 次调用。

我已经查看了其他几个具有类似主题的主题，但我的问题似乎有所不同：

[twitteR 和 ROAuth R 软件包安装](https://stackoverflow.com/questions/5589522/twitter-and-roauth-r-packages-install)

[推特和 ROAuth](https://stackoverflow.com/questions/9373157/twitter-and-roauth)

[TwitteR、ROAuth 和 Windows：注册成功，但证书验证失败](https://stackoverflow.com/questions/9916283/twitter-roauth-and-windows-register-ok-but-certificate-verify-failed)

我的代码如下：

```
 rm(list=ls())
    library("twitteR")
    library("ROAuth")
    requestURL <- "https://api.twitter.com/oauth/request_token"
    accessURL = "https://api.twitter.com/oauth/access_token"
    authURL = "https://api.twitter.com/oauth/authorize"
    cKey = "__________"
    cSecret = "__________"
    Cred <- OAuthFactory$new(consumerKey=cKey,
                consumerSecret=cSecret,
                requestURL=requestURL,
                accessURL=accessURL,
                authURL=authURL)
    Cred$handshake()
    registerTwitterOAuth(Cred) 
```

尽管尝试了相同代码的许多不同版本，重置了我的 API 密钥，甚至注册了一个新帐户并检索了一个新的 API 密钥，但我不断返回此错误：

```
 Error in Cred$handshake() : 
    Invalid response from site, please check your consumerKey and consumerSecret and try again. 
```

这绝对不可能是我的密钥/秘密的问题。还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:34:09.107

问题解决了：

我已经下载了这个新版本的 ROAuth (http://lists.hexdump.org/pipermail/twitter-users-hexdump.org/2012-February/000059.html) 但还没有重新启动 R！呃！

# java - EventHistoryCollector - 增加页面大小

> ID：11569431
> 
> 赞同：0
> 
> 时间：2012-07-19T21:16:19.323
> 
> 标签：java, vmware, page-size, vmware-sdk

我需要从 EventHistoryCollector 收集 20 个最新事件。`GetLatestEvents()`为我提供 10 个最新事件，并`readNextEvents()`以某种我无法使用的随意顺序让我获得多少我想要的事件。有没有办法为 EventHistoryCollector 设置页面大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:28:33.367

[在这里](http://pubs.vmware.com/vi-sdk/visdk250/ReferenceGuide/vim.HistoryCollector.html#setLatestPageSize)找到它。应该先用谷歌搜索：|

# python - 从子字符串中查找文件名

> ID：11569432
> 
> 赞同：1
> 
> 时间：2012-07-19T21:16:19.373
> 
> 标签：python, string, file

我有一个我保存的文件名列表，如下所示：

```
filelist = os.listdir(mypath) 
```

现在，假设我的一个文件类似于“ `KRAS_P01446_3GFT_SOMETHING_SOMETHING.txt`”。

但是，我提前知道的是我有一个名为“ `KRAS_P01446_3GFT_*`”的文件。如何仅使用“ `KRAS_P01446_3GFT_*`”从文件列表中获取完整的文件名？

作为一个更简单的例子，我做了以下事情：

```
mylist = ["hi_there", "bye_there","hello_there"] 
```

假设我有字符串`"hi"`。我将如何让它返回`mylist[0] = "hi_there"`。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:21:20.090

在第一个示例中，您可以只使用该`glob`模块：

```
import glob
import os
print '\n'.join(glob.iglob(os.path.join(mypath, "KRAS_P01446_3GFT_*"))) 
```

这样做*而*不是`os.listdir`.

第二个例子似乎与第一个（[XY 问题](http://www.perlmonks.org/?node_id=542341)？）关系不大，但这里有一个实现：

```
mylist = ["hi_there", "bye_there","hello_there"]
print '\n'.join(s for s in mylist if s.startswith("hi")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:20:49.567

如果您的意思是“给我所有以某个前缀开头的文件名”，那么这很简单：

```
[fname for fname in mylist if fname.startswith('hi')] 
```

如果你的意思是更复杂的东西——例如，像“some_*_file”这样的模式匹配“some_good_file”和“some_bad_file”，那么看看正则表达式模块。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:21:11.520

```
mylist = ["hi_there", "bye_there","hello_there"]
partial = "hi"
[fullname for fullname in mylist if fullname.startswith(partial)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T21:30:42.550

如果列表不是很大，您可以像这样进行逐项检查。

```
def findMatchingFile (fileList, stringToMatch) :
    listOfMatchingFiles = []

    for file in fileList:
        if file.startswith(stringToMatch):
            listOfMatchingFiles.append(file)

    return listOfMatchingFiles 
```

有更多的“pythonic”方式可以做到这一点，但我更喜欢这种方式，因为它更具可读性。

# java - 将一些代码从 ruby openssl 移植到 java

> ID：11569434
> 
> 赞同：0
> 
> 时间：2012-07-19T21:16:27.137
> 
> 标签：java, ruby, openssl

我有以下内容：

```
def from_code(code, secret)
  cipher = OpenSSL::Cipher::BF.new
  cipher.decrypt
  cipher.pkcs5_keyivgen(secret)
  data = cipher.update(Base64.decode64(code + "\n"))
  final = cipher.final
  plaintext = data + final
  plaintext
end 
```

我的目标是使用 commons.binary 和 javax.crypto （或任何其他依赖项，这很好）实现完全相同，但仅在 Java 中。我在搞乱 javax.crypto 但我想我会在这里问。先感谢您。

# batch-file - 如何将命令的输出存储在cmd中的变量中？

> ID：11569436
> 
> 赞同：0
> 
> 时间：2012-07-19T21:16:37.737
> 
> 标签：batch-file, cmd

我想在批处理编程中将命令的输出存储在变量中请帮助我..提前谢谢..

就像我想将 find 命令的输出存储在变量 p set p=find /c "chi*" "file.txt"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:39:28.850

假设您要存储行数而不是 find 产生的整行输出

```
for /f "tokens=3" %%i in ('find /c "chi*" "file.txt"') do set p=%%i 
```

注意：要存储整行，您可以使用`tokens=*`或`delims=`（等号后没有空格！）。

# javascript - javascript if 条件操作

> ID：11569438
> 
> 赞同：0
> 
> 时间：2012-07-19T21:16:43.637
> 
> 标签：javascript, extjs3

我需要一些关于我的 JS 逻辑的帮助。所以基本上我得到了一堆权限并将它们存储如下：

```
for( var i=0 ; i<permissions.length ; i++ ) {
    p[permissions[i].PERMISSION] = true;
} 
```

权限的值如下

p.SELECT_USER，

p.INSERT_USER,

p.UPDATE_USER 等

现在我想根据权限的值显示/隐藏一个窗口。我的 if 条件需要一些逻辑帮助所以基本上我想要类似的东西，

```
if( 'permissions beigns with the word SELECT' && 'permissions does not begin with any other word' ) {
    this.window.hide()
} else {
    this.window.show()
} 
```

有没有什么有效的方法我不能通过修改我的 for 循环来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:32:36.593

```
if( /^SELECT/.test(/*some permissionvalue*/) ) { /*...*/ } 
```

会很短，我想效率够高吗？

其他想法（一个衬里替换您的代码，如果`hide`并且`show`是包含的现有方法`this.window`）：

```
this.window[ /^SELECT/.test(/*some permissionvalue*/) ? 'hide' : 'show' ](); 
```

`/^SELECT/.test(/*some permissionvalue*/)`在这两个建议中意味着：*测试给定值是否以 'SELECT' 开头*。就像@Steve Wang 指出的那样，您可以替换它
`/*some permission value*/.indexOf('SELECT') === 0`以提高效率。

# python - json.loads() 失败

> ID：11569440
> 
> 赞同：1
> 
> 时间：2012-07-19T21:16:47.680
> 
> 标签：python, json, celery

所以我正在开发一个使用 celery 任务队列来发出 HTTP 请求的 django 项目。

在我的芹菜任务代码中，我有：

```
json.loads('{"content-type": "application/json"}')
print test.headers
json.loads(test.headers) 
```

结果是：

```
[2012-07-19 17:02:38,536: WARNING/PoolWorker-4] '{"content-type": "application/json"}'
[2012-07-19 17:02:38,569: ERROR/MainProcess] Task core.tasks.test_run[f304bcdd-72b3-4dd5-9abb-927dc29e7f65] raised exception: ValueError('No JSON object could be decoded',)
Traceback (most recent call last):
  File "/usr/local/bin/lib/python2.7/site-packages/celery/task/trace.py", line 212, in trace_task
    R = retval = fun(*args, **kwargs)     
  File "/opt/ironman_deploy/Ironman/core/tasks.py", line 18, in test_run
    json.loads(test.headers)
  File "/usr/local/bin/lib/python2.7/json/__init__.py", line 326, in loads
    return _default_decoder.decode(s)
  File "/usr/local/bin/lib/python2.7/json/decoder.py", line 366, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/usr/local/bin/lib/python2.7/json/decoder.py", line 384, in raw_decode
    raise ValueError("No JSON object could be decoded")
No JSON object could be decoded: No JSON object could be decoded 
```

我真的不知道发生了什么......显然json可以解码字符串，因为它不会失败上面的2行，但是当我通过引用传递字符串时，它似乎会窒息。

任何人都可以为我阐明这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:39:06.913

test.headers 可能是一个字典。如果你打印它，它会输出一些看起来像 JSON 的东西，但 test.headers 可能根本不是 JSON，解码它会导致 JSON 阻塞。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:35:16.963

Whats is "test.headers" 你的代码段没有说明这一点。如果 test.headers 被分配给第一个 json.loads 调用的结果，那么第二个显然会失败，因为您没有提供字符串。第二个调用应该是 json.dumps(test.headers)

# c# - 如何防止套接字/端口耗尽？

> ID：11569441
> 
> 赞同：17
> 
> 时间：2012-07-19T21:16:47.660
> 
> 标签：c#, multithreading, sockets, tcp

我正在尝试通过跨多个线程的请求来对网站进行性能测试。每个线程执行*n*次。（在 for 循环中）

但是，我遇到了问题。特别是带有内部异常的 WebException（“无法连接到远程服务器”）：

> 无法对套接字执行操作，因为系统缺少足够的缓冲区空间或队列已满 127.0.0.1:52395

我试图以每个线程 500 次迭代运行 100 个线程。

最初我`HttpWebRequest`在 System.Net 中使用向服务器发出 GET 请求。目前我正在使用`WebClient`，因为我假设每次迭代都使用一个新的套接字（所以在短时间内 100 * 500 个套接字）。我假设 WebClient （每个线程实例化一次）只会使用一个套接字。

我不需要一次打开 50 000 个套接字，因为我想发送 GET 请求、接收响应并关闭套接字，将其释放以供下一次循环迭代使用。我明白这将是一个问题

但是，即使使用 WebClient，也会请求一堆套接字，从而导致一堆套接字处于`TIME_WAIT`模式（使用 netstat 检查）。这会导致其他应用程序（如 Internet 浏览器）挂起并停止运行。

我可以用更少的迭代和/或更少的线程来运行我的测试，因为看起来套接字最终会退出这个 TIME_WAIT 状态。但是，这不是一个解决方案，因为它没有充分测试 Web 服务器的能力。

**问题：**

如何在每次线程迭代后显式关闭套接字（从客户端）以防止 TIME_WAIT 状态和套接字耗尽？

**代码：**

包装 HttpRequest 的类

*编辑：*在使用中包装了 WebClient，因此每次迭代都会实例化、使用和处置一个新的。问题仍然存在。

```
 public sealed class HttpGetTest : ITest {
    private readonly string m_url;

    public HttpGetTest( string url ) {          
        m_url = url;
    }

    void ITest.Execute() {
        using (WebClient webClient = new WebClient()){
            using( Stream stream = webClient.OpenRead( m_url ) ) {          
            }
        }
    }
} 
```

我的 ThreadWrapperClass 中创建新线程的部分：

```
public void Execute() {
    Action Hammer = () => {
        for( int i = 1; i <= m_iterations; i++ ) {
            //Where m_test is an ITest injected through constructor
            m_test.Execute();
        }       
    };
    ThreadStart work = delegate {
        Hammer();
    };
    Thread thread = new Thread( work );
    thread.Start();
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-19T21:48:01.727

Do you understand the purpose of TIME_WAIT? It's a period during which it would be unsafe to reuse the port because lost packets (that have been successfully retransmitted) from the previous transaction might yet be delivered within that time period.

You could probably tweak it down in the registry somewhere, but I question if this is a sensible next step.

My experience of creating realistic load in a test environment have proved very frustrating. Certainly running your load-tester from localhost is by no means realistic, and most network tests I have made using the .net http apis seem to require more grunt in the client than the server itself.

As such, it's better to move to a second machine for generating load on your server... however domestic routing equipment is rarely up to the job of supporting anywhere near the number of connections that would cause any sort of load on a well written server app, so now you need to upgrade your routing/switching equipment as well!

Lastly, I've had some really strange and unexpected performance issues around the .net Http client API. At the end of the day, they all use HttpWebRequest to do the heavy lifting. IMO it's nowhere near as performant as it could be. DNS is sychronous, even when calling the APIs asynchronously (although if you're only requesting from a single host, this isn't an issue), and after sustained usage CPU usage creeps up until the client becomes CPU constrained rather than IO constrained. If you're looking to generate sustained and heavy load, any request-heavy app reliant on HttpWebRequest is IMO a bogus investment.

All in all, a pretty tricky job, and ultimately, something that can only be proved in the wild, unless you've got plently of cash to spend on an armada of better equipment.

[Hint: I got much better perfomance from my own client written using async Socket apis and a 3rd party DNS client library]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T22:15:27.237

> Q: How do I explicitly close a socket ... in order to prevent TIME_WAIT states?

A: Dude, TIME_WAIT is an integral - and important! - part of TCP/IP itself!

You *can* tune the OS to reduce TIME_WAIT (which can have negative repercussions).

And you can tune the OS to increase #/ephemeral ports:

*   [http://msdn.microsoft.com/en-us/library/aa560610%28v=bts.20%29.aspx](http://msdn.microsoft.com/en-us/library/aa560610%28v=bts.20%29.aspx)

Here's a link on why TIME_WAIT exists ... and why it's a Good Thing:

*   [http://www.serverframework.com/asynchronousevents/2011/01/time-wait-and-its-design-implications-for-protocols-and-scalable-servers.html](http://www.serverframework.com/asynchronousevents/2011/01/time-wait-and-its-design-implications-for-protocols-and-scalable-servers.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T21:33:30.150

It's not an issue of closing sockets or releasing resources in your app. The TIME _WAIT is a TCP stack timeot on released sockets to prevent their re-use until such time as it is virtually impossible for any packets 'left over' from a previous connection to that socket to not have expired.

For test purposes, you can reduce the wait time from the default, (some minutes, AFAIK), to a smaller value. When load-testing servers, I set it at six seconds.

It's in the registry somewhere - you'll find it if you Google.

Found it:

[Change TIME_WAIT delay](http://www.pctools.com/guides/registry/detail/878/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-19T21:29:27.063

看起来您并没有强迫您的 WebClient 摆脱它分配的资源。您正在对返回的流执行 Using，但您的 WebClient 仍然有资源。

Either wrap your WebClient instantiation in a using block, or manually call dispose on it once you are done reading from the URL.

Try this:

```
public sealed class HttpGetTest : ITest {
    private readonly string m_url;

    public HttpGetTest( string url ) {
        m_url = url;        
    }

    public void ITest.Execute() {
        using( var m_webClient = new WebClient())
        {
            using( Stream stream = m_webClient.OpenRead( m_url ) ) 
            {

            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-27T16:40:22.447

You don't need to mess around with TIME_WAIT to accomplish what you want.

The problem is that you are disposing the WebClient every time you call Execute(). When you do that, you close the socket connection with the server and the TCP port keeps busy for the TIME_WAIT period.

**A better approach is to create the WebClient in the constructor of your HttpGetTest class and reuse the same object throughout the test.**

WebClient uses keep alive by default and will reuse the same connection for all its requests so in your case there will be only 100 opened connections for this.

# parsing - 电子邮件修剪

> ID：11569444
> 
> 赞同：0
> 
> 时间：2012-07-19T21:17:21.383
> 
> 标签：parsing, email, mime

在开始之前，请忘记我对 MIME 和基本邮件结构的无知。

我正在寻找一种通用方法来区分最新的电子邮件回复与存储在文本正文中的所有额外回复之间的区别。

例如雷鸟放巨人

- - - - - - - - - - - - 向前 - - - - - - - - - - - -

或者

- - - - - - - - - - - - 回复 - - - - - - - - - - - -

横幅，但 g-mail 似乎没有。[我阅读了这个 RFC](http://www.ietf.org/rfc/rfc2387.txt)，但它似乎没有涵盖我想要的内容。我也在寻找一种从电子邮件中删除签名的方法，但我假设在处理它们时没有标准。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:23:51.837

据我所知，没有规范。因此，这样做的唯一方法是跟踪消息 ID，然后将消息相互比较，以找出哪些部分是早期消息的一部分。

这就是 mac 邮件客户端所做的。

但这似乎不是您的想法。

所以：据我所知：你的计划中没有魔法标记。

至于签名：

在签名之前有一个双减号 + 换行符是一个很好的做法。但你不能总是依赖它。

# php - 如何让 Slim 框架工作而无需将 /index.php 放入 URL？

> ID：11569445
> 
> 赞同：7
> 
> 时间：2012-07-19T21:17:20.640
> 
> 标签：php, apache, .htaccess, url-rewriting, slim

我正在为 PHP 实现 Slim 框架，一切似乎都运行良好。但是，我可以让它工作的唯一方法是将 /index.php 放在 URL 中，如下所示：

> `http://www.example.com/index.php/members/1`

我希望它像这样工作：

> `http://www.example.com/members/1`

我觉得这与我的 .htaccess 有关系，但我不确定。这是我的.htaccess：

```
RewriteCond %{REQUEST_FILENAME} !-f
# RewriteRule ^ ./index.php [QSA,L]
RewriteRule ^ . [QSA,L] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:22:18.980

恢复注释的 ( `#`) 行并删除另一行应该会有所帮助。当你下载 Slim Framework 时，它[最初在 .htaccess](https://github.com/codeguy/Slim/blob/master/.htaccess)中也有这个。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ ./index.php [QSA,L] 
```

另外，你应该[学习编写重写规则](http://net.tutsplus.com/tutorials/other/a-deeper-look-at-mod_rewrite-for-apache/)，因为没有它你不会走得太远。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T09:20:55.183

我认为这个答案来晚了，但是按照这个链接[http://docs.slimframework.com/routing/rewrite/](http://docs.slimframework.com/routing/rewrite/)
的信息， 我需要将**AllowOverride All**语句添加到我的虚拟主机配置中，这对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-22T12:17:01.090

检查您的虚拟主机并全部允许OverRide。

```
 RewriteEngine On
   RewriteCond %{REQUEST_FILENAME} !-f
   RewriteRule ^ /index.php [QSA,L] 
```

# java - Android：glReadpixels 大于视口？

> ID：11569446
> 
> 赞同：1
> 
> 时间：2012-07-19T21:17:22.637
> 
> 标签：java, android, opengl-es, opengl-es-2.0, glreadpixels

我需要捕获比屏幕宽度更多的像素以保存更高分辨率的图像。我认为唯一的两个选择是使用一些 Matrix 命令将更多像素打包到屏幕中，或者使实际视图大于屏幕（我认为这是不可能的。）我可能应该让人们知道我是使用 OpenGL ES 2。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:22:54.900

您正在寻找的技术称为*Render to Texture*。本质上，您创建了一个屏幕外帧缓冲区，并将您的绘图调用重定向到此帧缓冲区而不是默认值。

您可以使帧缓冲区尽可能大（在硬件限制内）。

这看起来是一个合理的例子：

[http://blog.shayanjaved.com/2011/05/13/android-opengl-es-2-0-render-to-texture/](http://blog.shayanjaved.com/2011/05/13/android-opengl-es-2-0-render-to-texture/)

# django - 在 get_queryset 中过滤时重置 MultipleObjectMixin 分页

> ID：11569452
> 
> 赞同：2
> 
> 时间：2012-07-19T21:18:14.093
> 
> 标签：django, pagination, django-views, django-class-based-views

我正在使用自定义 mixin 将过滤器应用于使用 MultipleObjectMixin 分页的基于类的视图的查询集。当我应用过滤器以使当前页面超出数据集范围时，显然会得到 404。我想要做的是捕获此异常并将其重定向到新的最后一页。

我的 get_queryset 有问题的视图：

```
def get_queryset(self):
    filters = self.build_location_filter()
    if not filters == None:
        return models.Account.corporateAccounts(locations=self.build_location_filter)
    else:
        return models.Account.corporateAccounts() 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:44:32.043

尝试：

```
def get(self, request, *args, **kwargs):
    try:
        return super(MyView, self).get(request, *args, **kwargs)
    except Http404:
        if kwargs['page'] > self.paginator.num_pages:
            return HttpResponseRedirect(reverse('this_view_paged', kwargs={'page': self.paginator.num_pages}))
        else:
            # re-raise Http404, as the reason for the 404 was not that maximum pages was exceeded
            raise Http404(_(u"Empty list and '%(class_name)s.allow_empty' is False.")
                      % {'class_name': self.__class__.__name__}) 
```

**更新**

对不起。我真的以为 Django 添加`paginator`为实例变量。没有它*真的很*糟糕，因为它使这比它需要的困难100倍。分页器被隐藏在 中`paginate_queryset`，这实际上是从那里`Http404`得到的。这意味着，你甚至不能调用这个方法来获取你的分页器，因为你从中得到的只是一个异常。所以，你必须更深入，不幸的是重复了一些 Django 视图逻辑，我*讨厌*这样做，但这是我能看到的唯一前进道路。由于我们正在诉诸代码重复，无论如何，我现在要覆盖整个`paginate_queryset`方法。新代码直接从 Django 源代码复制而来，并在注释部分中注明了修改（我为后代保留了上面的原始代码）：

```
def paginate_queryset(self, queryset, page_size):
        """
        Paginate the queryset, if needed.
        """
        paginator = self.get_paginator(queryset, page_size, allow_empty_first_page=self.get_allow_empty())
        page = self.kwargs.get('page') or self.request.GET.get('page') or 1
        try:
            page_number = int(page)
        except ValueError:
            if page == 'last':
                page_number = paginator.num_pages
            else:
                raise Http404(_(u"Page is not 'last', nor can it be converted to an int."))
        try:
            page = paginator.page(page_number)
            # Moving this line after the try/except block because DRY
            #return (paginator, page, page.object_list, page.has_other_pages())
        except InvalidPage:
            # This used to raise a 404, but we're replacing this functionality
            #raise Http404(_(u'Invalid page (%(page_number)s)') % {
            #                    'page_number': page_number
            #})
            page = paginator.page(paginator.num_pages)

        return (paginator, page, page.object_list, page.has_other_pages()) 
```

# php - mod_rewrite 的总菜鸟

> ID：11569455
> 
> 赞同：1
> 
> 时间：2012-07-19T21:18:26.447
> 
> 标签：php, apache, .htaccess, mod-rewrite, shared-hosting

我正在尝试重写我的 URL 并遇到严重问题。我在 Godaddy linux 托管服务器上，它没有任何类型的配置文件或 .htaccess 文件。我使用以下重写信息创建了自己的 .htaccess 文件，但我不知道该怎么做：

```
RewriteEngine On
RewriteRule ^NSN/([^/]*)\.html$ /nsn.php?NSN=$1 [L] 
```

Godaddy 的人告诉我，我可以使用 URL 重定向来帮助解决这个问题，但我什至不确定这意味着什么。

如果有人可以帮助如何完成这项工作的后续步骤，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T01:24:22.180

Rewriting URLs is mapping the URL you see in the browser from the default to something more meaningful or memorable. The simplest example is something like this:

```
# Replace all html references with php
RewriteRule html php 
```

A [testing tool](http://htaccess.madewithlove.be/) will save time, and understanding how to use [aliases or redirects](http://httpd.apache.org/docs/current/rewrite/avoid.html) to avoid regular expressions may be helpful.

# python - 如何在 default.conf 文件中创建数组或列表

> ID：11569457
> 
> 赞同：4
> 
> 时间：2012-07-19T21:18:29.697
> 
> 标签：python, linux, configuration, webserver

我继承了一个 python 脚本，它从我认为是机器配置文件的 default.conf 文件中提取一些变量。

脚本的其中一个部分是从 .conf 文件中提取配置密钥，并期望有一个可能的选项列表，但是现在只有一个选项，我不确定如何制作，所以有多个选项.

```
[syndication]
name = Test Name
title = Test Title
categories = Category 1 
```

所以在上面的例子中，配置键是`syndication`，而我试图添加多个选项的变量是`category`。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-23T17:30:52.707

如果一行中的值太少，我会选择用逗号分隔它们，就像其他人举例的那样，否则根据[RFC822](https://www.rfc-editor.org/rfc/rfc822.html)标准，您可以按制表符开头的行来分割值：

*设置.conf：*

```
[syndication]
name = Test Name
title = Test Title
categories =
    Category 1
    Category 2
    Category 3 
```

*设置.py*：

```
#!/usr/bin/python
import ConfigParser

config = ConfigParser.ConfigParser()

# Reading
config.readfp(open('settings.conf'))
categories = config.get('syndication', 'categories').strip().split('\n')

# Appending
categories.append('Category 4')

# Changing
config.set('syndication', 'categories', '\n' + '\n'.join(categories))

# Storing
config.write(open('settings.conf', 'w')) 
```

您的新*settings.conf*：

```
[syndication]
name = Test Name
title = Test Title
categories = 
    Category 1
    Category 2
    Category 3
    Category 4 
```

*注意：*`:`您可以在or之后的第一行中放置一个值`=`，但作为一个值列表，我认为当您必须手动编辑文件时，从第二行开始更“可读”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T16:32:10.827

我认为您在配置文件中没有列表类型。但是，您可以执行逗号分隔值之类的操作：

```
[syndication]
name = Test Name
title = Test Title
categories = Category 1, Category 2 
```

然后在您的代码中将值拆分为 ,

```
values = [value.strip() for value in cfg.get('syndication', 'categories').split(',')] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T16:35:34.630

你还没有提到你是如何读取`.conf`文件的，所以我假设你正在使用[`ConfigParser`](http://docs.python.org/library/configparser.html).

我尝试设置`categories`为元组并使用`ConfigParser.write`，并最终在结果文件中得到元组的字符串表示形式。这对我来说意味着`ConfigParser`不支持多个选项。

您始终可以手动拆分选项：

```
categories = [option.strip() for option in config.get('syndication', 'categories').split(',')] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-24T05:47:21.450

它的工作方式可能与 python 的[日志配置文件格式](http://docs.python.org/py3k/library/logging.config.html#configuration-file-format)相同？在这种情况下`categories`，将是一个逗号分隔的列表（在记录配置文件的情况下，每个项目都指向配置文件中的特定部分）

# python - 迭代字典的值不起作用（错误是'int'对象不是可迭代的）

> ID：11569459
> 
> 赞同：0
> 
> 时间：2012-07-19T21:18:34.567
> 
> 标签：python, list, dictionary, iteration

> **可能重复：**
> [获取“int”对象不可迭代](https://stackoverflow.com/questions/11533650/getting-int-object-is-not-iterable)

所以我试图根据其他一些代码向字典添加一个值：

```
if not cat_sums.has_key(k):
        cat_sums[k] = 0
cat_sums[k] += value 
```

字典看起来像这样：

```
cat_sums =     defaultdict(<type 'list'>, {'composed': [0], 'elated': [0], 'unsure': [0], 'hostile': [0], 'tired': [0], 'depressed': [0], 'guilty': [0], 'confused': [0], 'clearheaded': [0], 'anxious': [0], 'confident': [0], 'agreeable': [0], 'energetic': [0]}) 
```

我得到：

```
 cat_sums[k] += value
TypeError: 'int' object is not iterable 
```

这是有道理的，因为 cat_sums[k] = [0] 对于第一次迭代，而 [0] 不是整数，它是一个列表。所以我尝试了这个：

```
print cat_sums[k[0]] 
```

看看它会输出什么，也就是说，看看我是否应该用 替换`cat_sums[k]`，`cat_sums[k[0]]`但是这给了我这个：

```
[] 
```

一个空列表。

那么如何添加到字典 cat_sums 中的值，遍历每个键呢？我在这里做错了什么？

请注意，为了澄清，值将等于某个大于或等于 0 的整数值（虽然，这可能会改变，并且稍后可能允许使用负整数，但目前还不允许）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:28:03.737

这个数据结构有点混乱。也许你应该尝试不同类型的 defaultdict：

```
cat_sums=defaultdict(int)
cat_sums[k]+=value 
```

当然，如果你想不断地向列表中添加元素：

```
cat_sums=defaultdict(list)
cat_sums[k].append(value)  #same thing as cat_sums[k]+=[value] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:29:10.463

我认为您不想使用`defaultdict(list)`- 看起来您想要这样做：

```
dd = defaultdict(int)
for x in y:
    dd[x] += 5 
```

附带说明：`if not cat_sums.has_key(k)`在 Python 上写为- 但如果我理解正确，则`if k not in cat_sums`不需要使用 a 。`defaultdict(int)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:25:14.103

您正在向列表中添加一个数字。尝试

```
if not cat_sums.has_key(k):
    cat_sums[k] = [0]
cat_sums[k][0] += value 
```

# c# - c#如何在注册表中写入十六进制值，而不是十进制值？

> ID：11569462
> 
> 赞同：2
> 
> 时间：2012-07-19T21:18:41.307
> 
> 标签：c#

如何在注册表中写入 DWORD 十六进制值？而不是十进制值，就像在这个代码示例中一样？

```
RegistryKey key = Registry.LocalMachine;
key = klase.CreateSubKey(@"SYSTEM\CurrentControlSet\Control\Windows");
key.SetValue("CSDVersion2", "100", RegistryValueKind.DWord);
key.Close(); 
```

解决办法是！

```
RegistryKey key = Registry.LocalMachine;
key = klase.CreateSubKey(@"SYSTEM\CurrentControlSet\Control\Windows");
key.SetValue("CSDVersion2", Convert.ToInt32("100", 16), RegistryValueKind.DWord);
key.Close(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:22:25.103

`SetValue`接受一个对象，所以你可以给它一个普通的 ol' 整数。我会做这样的事情：

```
key.SetValue("CSDVersion2", 0x100, RegistryValueKind.DWord); 
```

这会将 CSDVersion2 设置为十六进制的 0x100 或十进制的 256。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:20:21.643

使用[Convert.ToInt32(...)](http://msdn.microsoft.com/en-us/library/1k20k614.aspx)重载。

```
string strHexValue = Convert.ToInt32("100", 16).ToString(); 
```

基地在哪里`16`。

# jquery - CSS 过渡未执行

> ID：11569467
> 
> 赞同：0
> 
> 时间：2012-07-19T21:19:21.087
> 
> 标签：jquery, mobile, css, webkit, css-transitions

我目前正在尝试为`div`轮播型容器中的两个元素设置动画。这是 DOM 中出现的标记：

```
<div id="transitioner" style="width: 2880px; height: 775px; left: -1440px; ">
    <div id="view1" class="view active" style="width: 1440px; height: 775px; ">
        <header>
            <h1>This is page 1</h1>
        </header>
        <article style="height: 699px; ">
            <p>Tap me anywhere to go to the next view</p>
        </article>
        <footer>
            <p>This is my footer</p>
        </footer>    
    </div>
    <div id="view2" class="view" style="width: 1440px; height: 775px; ">
        <header style="">
            <h1>This is page 2</h1>
        </header>
    </div>
</div> 
```

这是`#transitioner`元素的 CSS：

```
#transitioner {
    position: absolute;
    top: 0;
    -webkit-transition: all 0.2s ease-in-out;
} 
```

最后，JS：

```
function GotoView(view)
{
    var roller = $('<div id="transitioner" />');
    roller.width((viewport.width * 2)).height(viewport.height);
    var current = $('.view.active').clone(true, true);
    $('.view.active').remove();
    current.prependTo(roller);

    var new_view = view.clone(true, true);
    view.remove();
    new_view.appendTo(roller);

    roller.appendTo($('body'));
    $('body').addClass('transitioning');
    //window.setTimeout(function() { roller.css({ left: 0 - viewport.width }) }, 2000);
    roller.css({ left: 0 - viewport.width });
} 
```

我更新了包含`div`（即`#transitioner`）的左侧位置，但除非我输入 a `setTimeout`，否则 CSS 转换不会执行，而是包含`div`简单地“跳转”到所需的新`left`偏移量。

我已经整理了一个 jsFiddle，所以你可以看到症状 > [http://jsfiddle.net/XPUPQ/](http://jsfiddle.net/XPUPQ/)

我的问题是：这是怎么回事，如果不使用 JS `setTimeout()`，有什么办法可以规避这种情况吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:24:35.180

您需要触发浏览器重排

[http://jsfiddle.net/XPUPQ/1/](http://jsfiddle.net/XPUPQ/1/)

例如，您可以这样做`$("body")[0].offsetWidth;`。

这实际上是[twitter bootstrap 使用](https://github.com/twitter/bootstrap/blob/master/js/bootstrap-modal.js#L66)的合法技术，例如

# c++ - 检测到堆损坏：在 Normal 块之后 (#126)

> ID：11569473
> 
> 赞同：2
> 
> 时间：2012-07-19T21:19:33.477
> 
> 标签：c++, memory, heap-memory, heap-corruption

我一生都无法弄清楚为什么会出现此调试错误：

检测到堆损坏：在 0x004cF6c0 CRT 的正常块 (#126) 后检测到应用程序在堆错误结束后写入内存。

我知道每当您使用 new 运算符时都需要释放内存，我这样做了，但我仍然遇到问题。

由于某种原因，程序在递归函数中没有正确结束。我对其进行了调试，并通过断点遍历了每一行代码。

在 countSum 中的 if 语句结束时，它以某种方式从 i 中减去 1，然后重新进入 if 块......它不应该这样做。

为什么会出现这种情况？

```
/*this program calculates the sum of all the numbers in the array*/

#include <iostream>
#include <time.h>

using namespace std;

/*prototype*/
void countSum(int, int, int, int*);

int main(){

    bool flag;
    int num;

    int sum = 0, j=0;
    int *array =  new int;

    do{

        system("cls");
        cout<<"Enter a number into an array: ";
        cin>>array[j];

        cout<<"add another?(y/n):";
        char choice;
        cin>>choice;
        choice == 'y' ? flag = true : flag = false;

        j++;

    }while(flag);

    int size = j;

    countSum(sum, 0, size, array);
    //free memory
    delete array;
    array = 0;

    return 0;
}

void countSum(int sum, int i, int size, int *array){

    if (i < size){
        system("cls");

        cout<<"The sum is  :"<<endl;
        sum += array[i];
        cout<<"...."<<sum;

        time_t start_time, stop_time;
        time(&start_time);

        do
        {
            time(&stop_time); //pause for 5 seconds
        }
        while((stop_time - start_time) < 5);

        countSum(sum, (i+1) , size, array); //call recursive function
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:22:21.580

`array`为单人提供足够的空间`int`：

```
int *array = new int; 
```

但可能会尝试插入多个，`int`这会导致写入不可用的内存。要么使用 a ，要么[`std::vector<int>`](http://en.cppreference.com/w/cpp/container/vector)必须事先知道分配`int`之前将输入的最大 s数。`array`

如果这是一个学习练习并且您不想使用`std::vector<int>`，您可以提示用户输入`int`他们希望输入的 s 数量：

```
std::cout << "Enter number of integers to be entered: ";
int size = 0;
std::cin >> size;
if (size > 0)
{
    array = new int[size];
} 
```

然后接受s 的`size`数量`int`。使用`delete[]`时使用`new[]`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:41:19.923

解决方案是设置大小 new int[size]....虽然我希望如果它是动态的，您不必设置大小。

# android - Android客户端终止连接

> ID：11569479
> 
> 赞同：1
> 
> 时间：2012-07-19T21:20:01.073
> 
> 标签：android, client, iostream

好的，所以我正在使用以下代码制作一个简单的 pc-android 服务器客户端应用程序：

```
package org.smiley.doom;

import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;

import java.net.InetAddress;
import java.net.Socket;
import java.net.UnknownHostException;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ImageView;
import android.widget.TextView;

public class ClientActivity extends Activity implements View.OnClickListener{

public static ImageView im;
public static Socket s;
public static boolean go;
public static TextView log;
Button send;
EditText tip;
InetAddress inet;
int rport;
String ip;
ObjectOutputStream out;
ObjectInputStream in;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    tip = (EditText) findViewById(R.id.etIP);
    send = (Button) findViewById(R.id.bSEND);
    im = (ImageView) findViewById(R.id.ivPIC);
    log = (TextView) findViewById(R.id.tvLog);

    s = null;
    in = null;
    out = null;

    send.setOnClickListener(this);
}

@Override
public void onClick(View arg0) {
    switch(arg0.getId()){
        case R.id.bSEND:
            byte[] b;
            int len;
                try {
                    inet = InetAddress.getByName("192.168.0.2");
                    s = new Socket(inet, 4321);
                    out = new ObjectOutputStream(s.getOutputStream());
                    in = new ObjectInputStream(s.getInputStream());
                    log.setText("Client opened");
                    len = in.readInt();
                    b = new byte[len];
                    in.read(b);
                    log.setText(b.length);
                    out.writeBoolean(true);
                    out.close();
                    in.close();
                    s.close();
                    System.out.println("Client closed");
                } catch (UnknownHostException e) {
                    log.setText(e.getMessage().toString());
                } catch (IOException e) {
                    log.setText(e.getMessage().toString());
                }
        break;
    }
}
} 
```

但是由于某种原因，当运行时，它会连接到服务器然后崩溃而不更改我的 textview 日志，我知道这不是服务器的问题，因为我在普通的 java 项目上运行了几乎完全相同的代码并且它完美连接。问题似乎是当它尝试设置对象输出/输入流时（因为这就是在日志更新和客户端请求连接之间发生的所有事情）但我无法弄清楚为什么我的生活

一如既往地感谢任何帮助:)

编辑：继承人我的 logcat

```
07-20 14:17:22.374: W/ResourceType(335): No package identifier when getting value for resource number 0x000096ce
07-20 14:17:22.374: D/AndroidRuntime(335): Shutting down VM
07-20 14:17:22.374: W/dalvikvm(335): threadid=1: thread exiting with uncaught exception (group=0x40015560)
07-20 14:17:22.385: E/AndroidRuntime(335): FATAL EXCEPTION: main
07-20 14:17:22.385: E/AndroidRuntime(335): android.content.res.Resources$NotFoundException: 
String resource ID #0x96ce
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.content.res.Resources.getText(Resources.java:201)
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.widget.TextView.setText(TextView.java:2857)
07-20 14:17:22.385: E/AndroidRuntime(335):  at 
org.smiley.doom.ClientActivity.onClick(ClientActivity.java:65)
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.view.View.performClick(View.java:2485)
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.view.View$PerformClick.run(View.java:9080)
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.os.Handler.handleCallback(Handler.java:587)
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.os.Handler.dispatchMessage(Handler.java:92)
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.os.Looper.loop(Looper.java:123)
07-20 14:17:22.385: E/AndroidRuntime(335):  at android.app.ActivityThread.main(ActivityThread.java:3683)
07-20 14:17:22.385: E/AndroidRuntime(335):  at java.lang.reflect.Method.invokeNative(Native Method)
07-20 14:17:22.385: E/AndroidRuntime(335):  at java.lang.reflect.Method.invoke(Method.java:507)
07-20 14:17:22.385: E/AndroidRuntime(335):  at 
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
07-20 14:17:22.385: E/AndroidRuntime(335):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
07-20 14:17:22.385: E/AndroidRuntime(335):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T22:47:11.430

你得到一个`ResourcesNotFoundException`因为你引用的资源之一无法在你的 XML 中解析。首先尝试在 Eclipse 中清理您的项目。您可以通过转到“项目 -> 清理”来执行此操作，并确保清理正确的项目。最后，确保`main.xml`您正在测试的 Android 版本可以访问您的布局文件。您可能将它放在设备无法访问的合格目录中（例如 xlarge 布局目录）。

这是相关的错误：

```
android.content.res.Resources$NotFoundException:
[ ... ]
at org.smiley.doom.ClientActivity.onClick(ClientActivity.java:65)
[ ... ] 
```

# php - preg_match_all 两个标签之间的正则表达式值

> ID：11569480
> 
> 赞同：1
> 
> 时间：2012-07-19T21:20:04.217
> 
> 标签：php, regex, preg-match-all

我正在尝试构建一个 preg_match_all 以便我可以使用该数组，但问题是我无法优化我的正则表达式来工作。

一个示例输入是：

```
#|First Name|#
This text shouldn't be caught
#|Second Value|# 
```

名字和第二个值都应该在数组中。

这是我尝试过的：

```
preg_match_all('/\#\|(.*?)\|\#\]/',$html, $out); 
```

和

```
preg_match_all ("/^#\|*\|#*$/i", $html, $out); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:23:02.833

试试这个正则表达式：

```
/\#\|(.*?)\|\#/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:24:25.720

第一个是正确的，它只包含`\]`接近尾声的内容，这打破了你想要的。使用

```
/\#\|(.*?)\|\#/ 
```

确实给了我正确的结果，匹配在`$out[1]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:26:42.960

尝试：

```
preg_match_all('/#\|(.*?)\|#/', $html, $out); 
```

不需要转义 #。要在 # 之间不指定 #，您也可以使用

```
preg_match_all('/#\|([^#]*)\|#/', $html, $out); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T21:27:01.510

有几件事，您需要添加“。” 你的酒吧之间的性格。这个字符意味着匹配任何字符，没有它你说匹配零个或多个'|' 人物。您还需要添加 m 修饰符以进行多行匹配。

```
/^#\|.*\|#$/im 
```

# redirect - 页面加载后 jQuery 移动重定向

> ID：11569484
> 
> 赞同：1
> 
> 时间：2012-07-19T21:20:22.440
> 
> 标签：redirect, jquery-mobile

我想在页面加载后立即使用 jQuery mobile 进行重定向。像这样的东西

```
<?php
... some php stuff here
?>
<html> 
    <head> 
        <link rel="stylesheet" href="css/jquery.mobile-1.1.1.min.css" />
        <script src="js/jquery-1.7.2.min.js"></script>
        <script src="js/jquery.mobile-1.1.1.min.js"></script>
    </head> 
<script>
        $.mobile.changePage("index.php");
</script> 
```

但是什么也没有发生...

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:30:38.840

什么都没有发生，因为 jQueryMobile 还没有做到这一点。

尝试：

```
$(document).bind('pageinit', function() {
      $.mobile.changePage("index.php");
}); 
```

您还可以尝试[http://jquerymobile.com/demos/1.1.1/docs/api/events.html中列出的一些事件](http://jquerymobile.com/demos/1.1.1/docs/api/events.html)

**编辑以下评论：** 以下工作对我来说是预期的：

```
<html>
    <head>
        <title>My Page</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.css" />
        <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>
        <script>
        $(document).bind('pageinit', function() {
            $.mobile.changePage("#pageTwo");
        });
        </script>
    </head>
    <body>
        <div id="firstPageId" data-role="page">
        Page One
        </div>
        <div id="pageTwo" data-role="page">
        Page Two
        </div>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:41:01.817

Please try this to end of your page and before `</body>` tag,

```
<script>
  $(window).load("index.php", function() {
     // stuff or not
  });
</script> 
```

**I hope help you. :)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:11:18.853

尝试使用 .live 在脚本中添加您的 page-id，如下所示：

```
 $('#mainpage').live('pageinit', function (event) {
    alert("hi");
    //$.mobile.changePage("index.php");

}); 
```

这是完整的示例：http: [//jsfiddle.net/KyKFE/](http://jsfiddle.net/KyKFE/)

另一方面，您也可以只使用普通的 javascript 函数或 php（如果是 .php 页面）来进行重定向。他们有很多不同的方法来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T21:21:55.093

你可以使用普通的 JavaScript，你不需要 jQuery：

```
window.location = "index.php"; 
```

要在页面加载后执行此操作，请添加一个`$(document).ready()`处理程序：

```
$(document).ready(function () {
   window.location = "index.php";
}); 
```

# joomla - Joomla 2.5 如果出现错误，我如何中止保存操作？

> ID：11569486
> 
> 赞同：0
> 
> 时间：2012-07-19T21:20:25.400
> 
> 标签：joomla, joomla-component

是否可以中止 Joomla 控制器中的保存操作？（管理员端）

例如：我有一个包含项目列表的视图。我点击 New Item 按钮，然后在下一页中输入所有必填字段并点击保存。我的表单还有一个文件上传字段，用于上传小图片。该图像必须为 25 x 25 像素，否则将不会保存新项目。

到目前为止，我发现中止保存操作的唯一方法（如果发现像图像大小这样的错误）是调用 cancel() 方法**parent::cancel();** 在控制器中。这会将用户带回项目列表。我需要知道是否有另一种方法可以重新加载**新项目表单视图**，其中包含上一篇文章中填写的所有字段，以便用户只需选择正确的图像并重新发布表单，而无需从头开始填写所有字段.

目前我对 cancel() 方法很好，如果用户点击浏览器的后退按钮，他可能会返回加载所有字段的表单，但我只是想知道是否有办法重新加载表单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T14:21:31.307

我认为如果不进行大量编码和黑客攻击，就没有办法做到这一点。您是否考虑过在上传图片之前尝试使用 JavaScript 测量图片的大小？还是让人们先保存正常数据，然后再索要图像？

# c++ - Qt中的“在设置MAKEFILE_GENERATOR之前使用操作系统范围”

> ID：11569495
> 
> 赞同：1
> 
> 时间：2012-07-19T21:20:49.460
> 
> 标签：c++, qt

我已经下载并安装了 Qt，我正在学习如何使用它。所以，我创建了一个新项目`myfristqt`（空项目）。然后我用这个代码添加了一个`main.cpp`文件：

```
#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication app(argc, argv);
    return app.exec();
} 
```

我注意到`#include <QApplication>`线的第一件事是用红线突出显示，好像`QApplication`是一个未知的标识符。所以，我编译它看看会发生什么，这是我得到的错误：

```
(internal):1: error : Using OS scope before setting MAKEFILE_GENERATOR 
```

知道为什么会这样吗？我正在使用 Windows XP

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T01:43:04.970

**MAKEFILE_GENERATOR**是一个 qmake 变量。

此变量包含生成 Makefile 时要使用的 Makefile 生成器的名称。此变量的值通常由 qmake 内部处理，很少需要修改。

它在 QTDIR/mkspecs/PLATFORM/qmake.conf 中定义。在您的 Windows XP 上，PLATFORM 可能是 cygwin-g++、win32-msvc200x。

# firefox - Google Maps v3 仅在 FIREFOX 中在右键单击事件中进行缩放

> ID：11569498
> 
> 赞同：4
> 
> 时间：2012-07-19T21:20:52.570
> 
> 标签：firefox, google-maps-api-3, contextmenu, mouseevent, google-maps-api-2

就我而言，发生了一些奇怪的事情，使用 GOOGLE MAPS API V3 当用户在地图上进行右键单击时，我创建了一个上下文菜单，但是，如果我尝试在 fIREFOX 中打开地图，当我右键单击以显示 ContextMenu 时，它的工作原理！但也进行了 ZOOM OUT，同时，我发现这仅在 FIREFOX 中发生......这里发生了什么？我做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-06T20:54:18.277

我在 Firefox 上遇到了同样的问题，右键单击，缩小。尝试添加右键单击功能时的主要问题。看来 disableDoubleClickZoom 解决了这个问题，但这是一个很好的功能，我不想失去它。

我所做的是创建两个事件侦听器，一个用于右键单击，一个用于正常单击。在右键单击事件中禁用双击缩放：

```
google.maps.event.addListener(map, 'rightclick', function(e) {
    map.set('disableDoubleClickZoom', true);
}); 
```

然后在正常单击时重新启用双击缩放功能：

```
google.maps.event.addListener(map, 'click', function(e) {
    map.set('disableDoubleClickZoom', false);       
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-30T10:19:48.910

我不认为这是 Firefox 中的错误，至少在我的浏览器中不是。相反，尝试像这样配置您的地图：

```
var mapOptions = {
  disableDefaultUI: true,
  draggable: false,
  scrollwheel: false,
  disableDoubleClickZoom: true,
  mapTypeId: google.maps.MapTypeId.ROADMAP
};
map = new google.maps.Map(element, mapOptions); 
```

所有[地图选项在这里](https://developers.google.com/maps/documentation/javascript/reference#MapOptions)。

# java - 带有游戏循环的 Java 和 Swing

> ID：11569501
> 
> 赞同：2
> 
> 时间：2012-07-19T21:21:16.877
> 
> 标签：java, swing, game-loop, roguelike

（不是这样）这里的简短问题。我正在使用 Swing 作为 UI 而不是控制台（这使得在 Eclipse 中更容易使用，等等），但我似乎遇到了障碍。

我遇到的问题是，当我进入游戏循环时，UI 将无法正常显示。我得到了一个丑陋的窗框，它在整个过程中给了我“纸牌”的效果，并且在运行时它的 RAM 使用量迅速增长。

我在这里错过了关于 Swing 的一些重要内容吗？我必须使用 Swing 的并发设置来执行此操作吗？如果是这样，最好的方法是什么？

完整代码如下：

```
package roguelike;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.FontMetrics;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.LinkedList;

import javax.swing.*;
import javax.swing.text.*;

public class roguelike {
    Color c_black = new Color(0x000000);
    Color c_white = new Color(0xffffff);
    Color c_red = new Color(0xff0000);
    Color c_blue = new Color(0x0000ff);
    Color c_green = new Color(0x00ff00);

    UI ui = null;
    Player me = null;
    Map gamemap = null;
    LinkedList<Character> keyqueue = new LinkedList<Character>();

    int charheight = 20;
    int charwidth = 80;

    public static void main(String[] args){
        SwingUtilities.invokeLater(new Runnable(){
            public void run(){
                roguelike game = new roguelike();
                game.run();
            }
        });
    }
    public roguelike(){
        gamemap = new Map();
        ui = new UI(charheight,charwidth,"Monospaced");
        me = new Player();
    }
    private class UI extends JFrame implements KeyListener{
        private static final long serialVersionUID = 9065411532125953842L;
        JPanel disp_screen = null;
        JTextPane disp_screen_text = null;
        StyledDocument disp_doc = null;
        Font mono_norm = null;
        int pxheight = 0;
        int pxwidth = 0;
        String[][] ctemp = new String[charheight][charwidth];
        String[][] stemp = new String[charheight][charwidth];

        public UI(int h,int w,String fontname){
            setVisible(true);
            charheight = h;
            charwidth = w;
            addKeyListener(this);

            this.setResizable(false);
            mono_norm = new Font(fontname,0,25);
            initScreen(h,w);
            add(disp_screen);
            makeStyles();
            try {
                disp_doc.insertString(0, "12345678901234567890123456789012345678901234567890123456789012345678901234567890\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20", disp_doc.getStyle("Default"));
            } catch (BadLocationException e) {
                e.printStackTrace();
            }

            Dimension temp = disp_screen.getSize();
            this.setSize(temp);
            this.setDefaultCloseOperation(EXIT_ON_CLOSE);           

            pack();
            try {
                disp_doc.remove(0, disp_doc.getLength());
            } catch (BadLocationException e) {
                e.printStackTrace();
            }
            renderMap(gamemap.getText(),gamemap.getStyles());

        }
        @Override
        public void keyPressed(KeyEvent e) {
            // TODO Auto-generated method stub

        }
        @Override
        public void keyReleased(KeyEvent e) {
            // TODO Auto-generated method stub

        }
        @Override
        public void keyTyped(KeyEvent e) {
            keyqueue.add(e.getKeyChar());
        }
        private void initScreen(int height, int width){
            FontMetrics metric = getFontMetrics(mono_norm);
            String temp = null;

            //generate a string of the right width from which to grab metrics
            for(int x=0;x<=width;x++){
                temp += '.';
            }
            pxwidth = SwingUtilities.computeStringWidth(metric, temp);
            pxheight = (metric.getHeight())*charheight;

            disp_screen = new JPanel();
            disp_screen_text = new JTextPane();
            disp_screen_text.setEditable(false);
            disp_screen_text.setAlignmentX(LEFT_ALIGNMENT);
            disp_screen_text.setAlignmentY(TOP_ALIGNMENT);
            disp_screen_text.setFont(mono_norm);
            disp_screen_text.setBackground(c_black);
            disp_screen_text.setForeground(c_green);
            disp_doc = disp_screen_text.getStyledDocument();

            disp_screen.add(disp_screen_text);
            disp_screen.setAlignmentX(LEFT_ALIGNMENT);
            disp_screen.setAlignmentY(TOP_ALIGNMENT);
            disp_screen.setLayout(new BoxLayout(disp_screen,BoxLayout.Y_AXIS));
        }
        private void makeStyles(){
            //The default style removes all special formatting and returns the text to standard nonsense
            Style sty_default = disp_doc.addStyle("Default", null);
            StyleConstants.setFontFamily(sty_default, "Monospaced");
            StyleConstants.setFontSize(sty_default, 18);
            StyleConstants.setForeground(sty_default, c_green);
            StyleConstants.setBackground(sty_default, c_black);
            StyleConstants.setItalic(sty_default, false);
            StyleConstants.setBold(sty_default, false);
            //StyleConstants.setSpaceAbove(sty_default, 0);
            //StyleConstants.setSpaceBelow(sty_default, 0);

            //The following styles apply certain effects. They are meant to be set without replacing styles
            Style sty_bold = disp_doc.addStyle("Bold", disp_doc.getStyle("Default"));
            StyleConstants.setBold(sty_bold,true);

            Style sty_ital = disp_doc.addStyle("Italic", disp_doc.getStyle("Default"));
            StyleConstants.setItalic(sty_ital, true);

        }
        private void clearMap(){
            try {
                disp_doc.remove(0, disp_doc.getLength());
            } catch (BadLocationException e1) {
                e1.printStackTrace();
            }
            try {
                //CLEAR THE MAP
                //For every row...
                for(int y=0;y<charheight;y++){
                    //For every column location in a row...
                    for(int x=0;x<charwidth;x++){
                        disp_doc.insertString(disp_doc.getLength(),".", disp_doc.getStyle("Default"));
                    }
                    disp_doc.insertString(disp_doc.getLength(),"\n", disp_doc.getStyle("Default"));
                }
            } catch (BadLocationException e){
                    e.printStackTrace();
            }
        }
        public void renderMap(String[][] chars, String[][] styles){
            System.out.print("Rendering map...");
            clearMap();
            ctemp = chars;
            stemp = styles;

            try {

                //For every row...
                for(int y=0;y<charheight;y++){
                    //For every column location in a row...
                    for(int x=0;x<charwidth;x++){
                        if(ctemp[y][x] != null){
                            if(stemp[y][x] == "D"){
                                disp_doc.remove((y*charwidth)+x, 1);
                                disp_doc.insertString((y*charwidth)+x,ctemp[y][x], disp_doc.getStyle("Default"));
                            } else if(stemp[y][x] == "B"){
                                disp_doc.remove((y*charwidth)+x, 1);
                                disp_doc.insertString((y*charwidth)+x,ctemp[y][x], disp_doc.getStyle("Bold"));
                            } else if(stemp[y][x] == "I"){
                                disp_doc.remove((y*charwidth)+x, 1);
                                disp_doc.insertString((y*charwidth)+x,ctemp[y][x], disp_doc.getStyle("Italic"));
                            } else{
                                disp_doc.remove((y*charwidth)+x, 1);
                                disp_doc.insertString((y*charwidth)+x,ctemp[y][x], disp_doc.getStyle("Default"));
                            }
                        }
                    }
                }
            } catch (BadLocationException e){
                e.printStackTrace();
                System.err.print(e.getCause());
            }
        }
    }

    //Handles the virtualized information of characters on the map. Does NOT handle display of map on screen
    //Displaying the screen happens by passing required data to the ui member
    private class Map{
        //Holds an array of map characters
        String[][] text = new String[charheight][charwidth];
        //Holds an array of styles associated with each map character
        String[][] styles = new String[charheight][charwidth];

        public Map(){
        }
        public String[][] getText(){

            return text;
        }
        public String[][] getStyles(){
            return styles;
        }
        public void putch(String thing, String styledef,int y, int x){
            text[y][x] = thing;
            styles[y][x] = styledef;
        }
    }

    private class Player{
        //Player location, [y][x]
        int[] location = {0,0};
        String sym = "@";
        public Player(){
        }
        public int[] getLocation(){
            return location;
        }
        public String getSymbol(){
            return sym;
        }
        public void setLocation(int y, int x){
            location[0]=y;
            location[1]=x;
        }
        public void setSymbol(String newsym){
            sym = newsym;
        }
        public void move(int dir){
            //Movement will be handled in an 8 directional fashion
            //North is 1, like below
            //     812
            //     703
            //     654
            //////////////////////
            switch(dir){
                case 0:
                    break;
                case 1:
                    location[0] += 1;
                    break;
                case 2:
                    location[0] += 1;
                    location[1] += 1;
                    break;
                case 3:
                    location[1] += 1;
                    break;
                case 4:
                    location[0] -= 1;
                    location[1] += 1;
                    break;
                case 5:
                    location[0] -= 1;
                    break;
                case 6:
                    location[0] -= 1;
                    location[1] -= 1;
                    break;
                case 7:
                    location[1] -= 1;
                    break;
                case 8:
                    location[0] += 1;
                    location[1] -= 1;
                default:
                    System.err.print("ERROR! "+dir+" is not a valid direction!");
                    break;
            }
        }
    }

    /////////////////////////////////////////////////////
    /////////////FUNCTIONS///////////////////////////////
    /////////////////////////////////////////////////////
    public void run(){
        boolean running = true;
        while(running){
            //Render Map
            gamemap.putch(me.getSymbol(), "D", me.getLocation()[0], me.getLocation()[1]);
            ui.renderMap(gamemap.getText(), gamemap.getStyles());
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            //Wait for player input
            if(keyqueue.isEmpty()){
                continue;
            }
            //Act on input
            else{
                char input = keyqueue.getFirst();
                keyqueue.removeFirst();
                if(input == 'w'){
                    me.move(1);
                }
                if(input =='a'){
                    me.move(7);
                }
                if(input == 's'){
                    me.move(5);
                }
                if(input == 'd'){
                    me.move(3);
                }
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:25:51.013

Swing 应用程序必须是事件驱动的——你的`game.run()`调用将阻止 Swing 做任何其他有用的事情。请注意，“事件”可能是用户事件、计时器或其他可能的东西。

如果您的设计需要`game.run()`或类似的东西运行并且永不返回，则可以在另一个线程（甚至 SwingWorker 后台线程）上完成，但必须在 Swing 线程上访问所有 UI 组件。

建议：您的键盘处理可以通过您编写的[KeyListener](http://docs.oracle.com/javase/6/docs/api/java/awt/event/KeyListener.html)轻松完成，附加到窗口或其他组件上的事件处理程序，然后在用户按下键时调用 - 即您不需要使用此设计进行轮询.

# clojure - 为什么 nailgun 服务器会抛出“无法确定文件的命名空间”错误？

> ID：11569505
> 
> 赞同：1
> 
> 时间：2012-07-19T21:21:38.763
> 
> 标签：clojure, leiningen, vimclojure, nailgun

我正在尝试让 vimclojure 继续运行，如果我做错了什么，我将不胜感激。当我尝试在我的一个 lein 项目中读取 project.clj 时出现错误：

```
; Use \p to close this buffer!

Could not determine the Namespace of the file.

This might have different reasons. Please check, that the ng server
is running with the correct classpath and that the file does not contain
syntax errors. The interactive features will not be enabled, ie. the
keybindings will not be mapped.

Reason:
Error executing Nail! (230)
connect: Connection refused 
```

以下是 ~/.vimrc 中的相关行

```
filetype off
call pathogen#runtime_append_all_bundles()
filetype plugin indent on
let g:vimclojure#HighlightBuiltins = 1
let g:vimclojure#ParenRainbow = 1
let vimclojure#NailgunClient = "/home/cnorton/bin/ng"
let vimclojure#WantNailgun = 1
:helptags ~/.vim/bundle/VimClojure/doc/ 
```

并且 nailgun 在 CLASSPATH 中

```
export CLASSPATH=/usr/share/java:/home/cnorton/bin:$CLASSPATH
export VIMCLOJURE_SERVER_JAR="$HOME/bin/server-2.3.0.jar" 
```

我错过了什么和/或我做错了什么？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T05:55:49.153

```
connect: Connection refused 
```

你没有启动服务器。或错误配置了服务器地址/端口。

# java - GAE/JavaMail 发送附件不起作用

> ID：11569506
> 
> 赞同：1
> 
> 时间：2012-07-19T21:21:47.740
> 
> 标签：java, google-app-engine

发送或转发电子邮件没有问题。但是，当我尝试将附件作为 mime multipart 发送时，附件不会被发送。我已经搜索了现有的帖子并尝试了多种修复方法。低级 MailService 可以工作，但 JavaMail 不能。我将发布两个代码片段，希望有人能给出答案。

发件人是应用管理员，但已在片段中更改。

什么有效，这是低级 API 调用：

```
 String htmlBody = "Data dump from " + host + ". See attached.";
        Properties props = new Properties();
        Session session = Session.getInstance(props, null); // not used
        MailService service = MailServiceFactory.getMailService();
        MailService.Message msg = new MailService.Message();
        msg.setSender("myUser@gmail.com");
        msg.setTo("anotherUser@gmail.com");
        msg.setSubject("Committee Participation Report");
        msg.setHtmlBody(htmlBody);
        MailService.Attachment attachment = new MailService.Attachment("data-dump.cvs",
                report.getBytes());
        msg.setAttachments(attachment);
        service.send(msg); 
```

什么不起作用，JavaMail API 调用：

```
 Properties props = new Properties();
    Session session = Session.getInstance(props, null);
    Message msg = new MimeMessage(session);
    msg.setFrom("admins");
    msg.addRecipient(Message.RecipientType.TO, "aUser@gmail.com");
    msg.setSubject("a subject");

    Multipart mp = new MimeMultipart();

    MimeBodyPart htmlPart = new MimeBodyPart();
    htmlPart.setContent(htmlBody, "text/html");     
    mp.addBodyPart(htmlPart);

    MimeBodyPart attachment = new MimeBodyPart();
    attachment.setDataHandler(new DataHandler(new ByteArrayDataSource(report.getBytes(), "text/comma-separated-values")));
    attachment.setFileName("cvsfile.csv");      
    mp.addBodyPart(attachment);

    msg.setContent(mp);
    Transport.send(msg); 
```

对带有或不带有附件的电子邮件使用相同的 API 会很好，所以如果有人能够让 JavaMail API 发送附件，我想知道如何。

# c# - 为什么在 DI 中使用接口而不是抽象类？

> ID：11569510
> 
> 赞同：9
> 
> 时间：2012-07-19T21:21:59.793
> 
> 标签：c#, dependency-injection

我开始了学习依赖注入的旅程，我看到为什么使用 DI 是个好主意的原因之一是它显式地指定了你的依赖项，这也使你的代码更加清晰。

我也注意到接口被大量使用，但我想知道为什么我们不使用抽象类来指定默认构造函数？

当然，抽象类中不能包含任何实现。

这不是吗：

```
abstract class FooBase
{
    protected IBar _bar;

    FooBase(IBar bar)
    {
        _bar = bar;
    }

    abstract void DoSomething();
    abstract void DoSomethingElse();
} 
```

更清楚地展示 FooBase 对象的依赖关系不仅仅是：

```
interface IFoo
{
    IBar Bar { get; }

    void DoSomething();
    void DoSomethingElse();
} 
```

?

请记住，我对这整个概念很陌生，所以要友善:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T21:26:34.350

一个技术原因——在没有多重继承的语言（Java/C#）中强制使用特定的父类将大大限制“接口”的实现自由。

请注意，“接口”一词背后隐藏着两个概念，这使得在 C# 中推理变得更加困难：

*   “接口”和抽象概念：定义明确的一组与对象交互的属性/方法；与对象一起工作的合同。
*   “接口”作为特定语言（C#/Java）中的类型 - 给定语言中合同的一种可能表示形式。

抽象/具体类可用于表示合同，但在 C# 中强制限制合同的实施者。

其他一些语言（如 C++）没有这样的限制，抽象类是一个不错的选择。其他语言（即“duck-types”JavaScript）没有这样的类/接口区别，但您仍然可以与对象有“契约”。

样本：

为了提供更多上下文，您应该自己在 C# 中达到此限制：DI 通常与某种形式的 TDD 一起使用，或者至少与基本单元测试一起使用。因此，您尝试编写一些使用 DI 抽象基类的代码和测试。

```
abstract class Duck { 
  abstract void Quack();
}
class ConcreteDuck : Duck {...} 
```

现在，如果您决定编写测试，您可能已经有可以帮助您模拟对象的测试类（如果您不使用现有的一次）

```
class MockBase {...}

class MockDuck : MockBase,?????? // Can't use Duck and MockBase together... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-19T21:31:27.623

接口定义了一个合约。Abstract 基类定义了一种行为。

本质上，您可以提供一个实现多个接口的类，然后可以将其注入到多个类中，但您将只有一个抽象基类（至少在 C# 中）。

考虑在容器中注册类型的点（最好是组合根）并考虑解决依赖关系的点（构造函数或属性）。

这个 SO 将涵盖更多[关于接口与基类的方面](https://stackoverflow.com/questions/56867/interface-vs-base-class)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T21:48:06.290

在 .NET 中，您只有单一继承。在这种情况下的语言/框架中，选择使用抽象类作为抽象可能会[“烧毁基类”](http://wiki3.cosc.canterbury.ac.nz/index.php/Don%27t_burn_your_base_class)。

这意味着您强制抽象的实现者从单个类继承，当强制他们这样做可能会导致严重不便，具体取决于实现是什么。

假设您有抽象类`Contract`。如果有人有他们自己`Base`想要使用的类，它只公开`protected`方法（对于继承者）。

因为方法是`protected`，所以不能使用封装（`Base`存储在字段中的实例）来访问`Base`抽象实现中的方法。

更糟糕的是，如果您无权访问 modify `Base`，那么您可能不得不求助于一些非常丑陋的解决方法（即反射）。

也就是说，使用接口，您可以让实现者选择从哪里继承，而不是限制他们的选择。

您将看到的典型模式是您始终为您的合约提供一个接口，并针对该接口对您的消费者进行编码。您*还*提供了一个抽象基类，该基类提供人们为了方便而*可以*派生的功能，但没有*义务从*.

此外，如果您可以以易于封装的形式提供此功能（对于我上面描述的条件），它会更加优化（您将有一个抽象类，它只调用公开的实例方法）。

# java - 从文件读取时的 java.net.URL 缓存

> ID：11569511
> 
> 赞同：7
> 
> 时间：2012-07-19T21:22:04.997
> 
> 标签：java, file, io

似乎java对URL（&文件）持有某种缓存。例如，我的类路径中的 jar 文件中有一个文件“resourcs.txt”。该文件的内容是：“版本 1”

```
new java.io.BufferedReader (new java.io.InputStreamReader( new URL("jar", "", "file:test.jar!/resourcs.txt").openConnection().getInputStream())).readLine() 
```

返回“版本 1”（如预期的那样）

我将文件内容更改为“版本 2”并再次调用此代码。我仍然得到“版本 1”

我怎样才能清除这个“缓存”。

注意：我发现它只发生在 Linux 上。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-29T14:00:22.767

由于`jar`URL 中使用的协议，连接是[sun.net.www.protocol.jar.JarURLConnection](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/sun/net/www/protocol/jar/JarURLConnection.java)的一个实例，它受益于[sun.net.www.protocol.jar.JarFileFactory中实现的缓存](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/sun/net/www/protocol/jar/JarFileFactory.java)

源代码确认`setUseCache(false)`on`URLConnection`实现将阻止使用该缓存。

我关于 Linux/Windows 行为差异的假设：来自 URLJarFileCloseController 接口的关闭事件通知在 Windows 上触发得更快，因为它不喜欢让文件句柄保持打开太长时间......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-21T16:09:55.760

其实简单的答案真的很接近sbridges给出的答案，但是不能用“new URLConnection(...)”来实例化URLConnection，因为它是一个抽象类。

你可以这样做：

```
 URL url = new URL(urlSrt);
    URLConnection con = url.openConnection();
    con.setUseCaches(false); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-29T04:45:29.727

您可以使用以下方法关闭 url 连接的缓存，

```
 URLConnection con = new URLConnection(new URL("jar", "", "file:test.jar!/resourcs.txt"));
  con.setUseCaches(false);
  new BufferedReader (new InputStreamReader(con.getInputStream())).readLine(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-28T23:03:37.703

我认为这是某种类加载问题，因为它是 jar-protocoll。

尝试以 zip 文件的形式打开您的 jar。

```
ZipFile zf = new ZipFile(file);
try {
  InputStream in = zf.getInputStream("resourcs.txt");
  // ... read from 'in' as normal
} finally {
  zf.close();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-25T16:40:16.063

如果您使用一些第三方代码，这应该可以工作：

```
url.openConnection().setDefaultUseCaches(false); 
```

# ios - 泄漏 CGImageMergeXMPPropsWithLegacyProps

> ID：11569512
> 
> 赞同：0
> 
> 时间：2012-07-19T21:22:10.203
> 
> 标签：ios, memory-leaks, cgimage, alassetslibrary

我正在跟踪我的 iOS 应用程序上的内存泄漏，并且我有一个奇怪的泄漏导致我的应用程序崩溃......负责的框架是：CGImageMergeXMPPropsWhithLegacyProps。在某些时候，我的应用收到了内存警告...

我正在像这样从 ALAsset 创建 UIImage ：

```
 ALAsset *asset = [assetsArray objectAtIndex:index];
    UIImage *image = [UIImage imageWithCGImage:[[asset defaultRepresentation] fullScreenImage]]; 
```

你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:52:14.613

希望这有帮助。我也使用 ALAsset，但遇到内存警告。我仍在为我的应用程序搜索我的解决方案...崩溃可能是因为 iOS 释放了您的视图或对象，因为内存警告。因此，也许防止内存警告很重要。将峰值内存保持在 30MB 以下。我遇到了 ipad2 50MB 的内存警告，但没有从 iphone4 得到它。总之，越低越好。首先，您可以使用仪器或以下代码测量内存。在记录代码中测量内存更容易。1.注册一个定时器，重复上报内存使用情况，这样可以看到内存使用的峰值。另一方面，我不知道为什么这个功能会逐渐增加内存。2.《iPhone Programming The Big Nerd Ranch Guide》一书中说iOS可能有24MB的图形内存” 过度使用图形内存通常是应用程序收到内存不足警告的原因。Apple 建议您不要使用超过 24 MB 的图形内存。对于 iPhone 屏幕大小的图像，使用的内存量超过半兆字节。每个 UIView、图像、Core Animation 层以及可以在屏幕上显示的任何其他内容都会占用分配的 24 MB 空间。（Apple 不建议对 NSString 等其他类型的数据设置任何最大值。）”因此，请查看图形内存使用情况。屏幕上可以显示的任何其他内容都会占用分配的 24 MB。（Apple 不建议对 NSString 等其他类型的数据设置任何最大值。）”因此，请查看图形内存使用情况。屏幕上可以显示的任何其他内容都会占用分配的 24 MB。（Apple 不建议对 NSString 等其他类型的数据设置任何最大值。）”因此，请查看图形内存使用情况。

```
NSTimer * timeUpdateTimer = [NSTimer timerWithTimeInterval:0.1 target:self selector:@selector(reportMem) userInfo:nil repeats:TRUE];
[[NSRunLoop mainRunLoop] addTimer:timeUpdateTimer forMode:NSDefaultRunLoopMode];

-(void) reportMem{
[self report_memory1];
}

-(void) report_memory1 {
struct task_basic_info info;
mach_msg_type_number_t size = sizeof(info);
kern_return_t kerr = task_info(mach_task_self(),
                               TASK_BASIC_INFO,
                               (task_info_t)&info,
                               &size);
natural_t freem =[self get_free_memory];
if( kerr == KERN_SUCCESS ) {
    NSLog(@"Memory in use %f %f(free)", info.resident_size/1000000.0,(float)freem/1000000.0);
} else {
    NSLog(@"Error with task_info(): %s", mach_error_string(kerr));
}

}

-(natural_t) get_free_memory {
mach_port_t host_port;
mach_msg_type_number_t host_size;
vm_size_t pagesize;
host_port = mach_host_self();
host_size = sizeof(vm_statistics_data_t) / sizeof(integer_t);
host_page_size(host_port, &pagesize);
vm_statistics_data_t vm_stat;

if (host_statistics(host_port, HOST_VM_INFO, (host_info_t)&vm_stat, &host_size) != KERN_SUCCESS) {
    NSLog(@"Failed to fetch vm statistics");
    return 0;
}

/* Stats in bytes */
natural_t mem_free = vm_stat.free_count * pagesize;
return mem_free;
} 
```

# php - PHP Mysql脚本错误

> ID：11569513
> 
> 赞同：1
> 
> 时间：2012-07-19T21:22:14.113
> 
> 标签：php, mysql

我也从 Unity 3d 内部的 C# 脚本发送数据。我想要做的是让页面显示我最终从中运行的任何查询的结果，并在 Unity 内部获取该页面的文本并显示它。这是一种非常笨拙的方法，但我只是从 PHP 和 mysql 开始 这是 unity 3d 给我的错误“警告：mysql_result()：提供的参数不是 WEBSITE.com/newget 中的有效 MySQL 结果资源.php 在第 30 行"

```
<?php
$db = mysql_connect('host, user, pass') or die('Could not connect: ' . mysql_error());

mysql_select_db('dbname') or die('Could not select database');

$gotString = mysql_real_escape_string($_GET['GetString'], $db);

$hash = $_GET['hash'];

//SELECT * FROM table_name

$real_hash = md5($gotString . $secretKey);

$secretKey = "KeyHERE";
$real_hash = md5($gotString . $secretKey);
$locString = "SELECT  A  FROM Quiz1 WHERE Question =  1";

if ($real_hash == $hash) {
    Compare();
}

function Compare() {
    if ($gotString == "1B") {
        $result = mysql_query("SELECT  B  FROM Quiz1 WHERE Question =  1") or die(mysql_error());
    } else {
        $result = mysql_query("SELECT  A  FROM Quiz1 WHERE Question =  1") or die(mysql_error());
    }
}

print( $result);
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:28:29.577

尝试使用

```
if (!$result) {
    die('error: ' . mysql_error());
} else {
    $row = mysql_fetch_array($result);
    var_dump($row);
} 
```

而不是 Print($result) ；在最后

# javascript - Javascript函数无法返回元素

> ID：11569516
> 
> 赞同：0
> 
> 时间：2012-07-19T21:22:19.030
> 
> 标签：javascript, jquery, handsontable

所以我目前正在为一个项目使用[Handsontable](http://handsontable.com/) jQuery 插件，并且我已经编写了一些自定义函数来使用它。

我目前遇到问题的函数是我编写的一个返回当前选定单元格的函数（当用户只选择了一个，而不是多个，并且是的，它已被选中）。

这是我的代码：

```
function getCurrentCell(){
    var selection = $('div.current');
    var left = selection.offset().left;
    var right = left + selection.width();
    var top = selection.offset().top;
    var bottom = top + selection.height();
    $('div.active').find('table').find('td').each(function(){
        if($(this).offset().left >= left && $(this).offset().left <= right && $(this).offset().top >= top && $(this).offset().top <= bottom){
            return this;
        }
    });
    return false;
} 
```

但是，每当我调用函数时，例如：

```
var cell = getCurrentCell(); 
```

然后尝试`alert(cell)`or `console.log(cell)`，我得到一个`false`返回值。

我最初的想法是坐标会以某种方式关闭，因此找不到符合条件的元素，所以我尝试通过添加来检查...

```
$(this).css('background-color', 'black'); 
```

...就在`return this`排队之前。这样，如果找到正确的表格单元格，它将在实际返回代码之前显示在屏幕上。有趣的是，正确的单元格*总是*会正确更改其背景颜色。所以，这个函数*正在*寻找正确的单元格，它正在执行 if 循环中的代码，但是当我尝试将返回值捕获到一个变量中时，该变量始终为 false。

任何帮助都会很棒！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:28:22.650

您正在使用[`.each()`](http://api.jquery.com/each)功能

```
.each(function(){
    ...
    return this;
});
return false; 
```

这将从回调中返回（如果`this`是，则可能停止每个循环`false`），但永远不会中断并从外部`getCurrentCell`函数返回！所以，那个总是会回来`false`的。

快速解决：

```
var result = false;
<...>.each(function(){
    if (<condition>) {
        result = <found element>;
        return false; // break each-loop
    }
});
return result; // still false if nothing found 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-03T00:06:25.103

目前有一种更好的方法可以让当前在 Handsontable 中被选中。只需使用 Handsontable 中的以下方法：

> `handsontable('getSelected')`- 以数组 [ `topLeftRow`, `topLeftCol`, `bottomRightRow`, `bottomRightCol`] 的形式返回当前选定单元格的索引
> 
> `handsontable('getCell', row, col)`- 给定的返回元素`row,col`

所有方法都在这里描述：[https ://github.com/warpech/jquery-handsontable](https://github.com/warpech/jquery-handsontable)

# sql - 获取每位患者的最高账单

> ID：11569521
> 
> 赞同：1
> 
> 时间：2012-07-19T21:22:33.070
> 
> 标签：sql, sql-server-2008, tsql

我有一张表，其中一个 ID 可以与多个账单相关联。我需要做的是找到`MAX`账单金额、ID 和最高 ( `MAX`) 账单的日期。问题是每人可能有数千张账单，在任何给定日期可能有数百张。

我的查询

```
select patientID, max(amountPaid) as maxPaid
from myTable
group by patientID 
```

给我我需要的东西，减去日期。我试图解决这个问题是

```
select t.patientID, t.maxPaid, myTable.billDate
from myTable
inner join
(
select patientid, max(amountPaid) as maxPaid
from myTable
group by patientID
) as t on t.patientID=myTable.patientID and =t.maxPaid=myTable.maxPaid 
```

给出的错误是`invalid column name maxPaid`。我尝试不给计算字段一个别名，但 SQL Server 也不接受 myTable.max(amountPaid)。解决此问题的最快方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:29:01.963

您当前方法的问题是，如果患者有两张最高金额的账单，您将同时获得这两张账单。

试试这个：

```
SELECT 
    patientid,
    amountPaid AS max_paid,
    billDate
FROM
(
    SELECT
        patientid,
        amountPaid,
        billDate,
        ROW_NUMBER() OVER (PARTITION BY patientid
                           ORDER BY amountpaid DESC) AS RowNumber
    FROM myTable 
) T1
WHERE T1.RowNumber = 1 
```

这将始终为每位患者返回一行，即使患者有两个具有相同最大值的账单`amountpaid`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:29:17.363

```
;WITH x AS (SELECT PatientID, BillDate, AmountPaid,
  rn = ROW_NUMBER() OVER (PARTITION BY PatientID ORDER BY AmountPaid DESC)
  FROM dbo.myTable
)
SELECT PatientID, BillDate, AmountPaid
FROM x
WHERE rn = 1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T21:27:36.797

根据您的描述，我认为您的意思是：

```
select t1.patientID, t2.maxPaid, t1.billDate
from myTable t1
inner join
(
    select patientid, max(amountPaid) as maxPaid
    from myTable
    group by patientID
) t2
on t1.patientID=t2.patientID 
and t1.amountPaid=t2.maxPaid 
```

# url - 检测页面中的更改，包括刷新

> ID：11569522
> 
> 赞同：0
> 
> 时间：2012-07-19T21:22:35.083
> 
> 标签：url, detection

所以我在一个 .tpl 文件中工作，这意味着我对 js、html 和 php 答案持开放态度。我想要做的是，每当有人刷新页面、体验 url 更改或退出浏览器时，我的网站都会根据这种状态变化采取行动。所以基本上，当他们以任何方式离开那个特定的地雷页面时，我会调用一个函数。我想要这个的原因是因为我将这个可编辑的图像保存在我的网站上。但是每当他们离开页面时，我都希望自动保存创建的图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:29:12.193

此任务分为客户端和服务器端部分。在客户端，您应该绑定到有趣的浏览器事件，触发一些后台 http 请求到您网站的某些服务 URL，这可能是 JS。在服务器端，你应该对这些请求提供相应的响应，这可能是 PHP。

只要这些服务 URL 会被各种访问者间歇性地调用，请务必留意来自哪个客户端窗口的请求。PHP 会话应该对您有所帮助。

我建议单独工作，首先让保存机制工作——只需将所有内容绑定到页面上的显式大按钮（`page close`、`url change`等），然后将每个按钮替换为与确切 JS 事件的绑定。请记住浏览器之间的差异。

# java - NumberFormatException 错误

> ID：11569523
> 
> 赞同：0
> 
> 时间：2012-07-19T21:22:44.347
> 
> 标签：java, hadoop, cygwin, mapreduce, numberformatexception

我正在通过 Cygwin 使用 Hadoop 运行 Mapreduce 作业。我收到以下 NumberFormatException 错误...知道如何在 try & catch 之外解决这个问题，因为我认为 try & catch 绕过了错误，但不允许我得到我期望的结果。

错误：

```
 12/07/19 17:10:31 INFO mapred.JobClient: Task Id : attempt_201207190234_0010_m_000000_2, Status : FAILED
java.lang.NumberFormatException: For input string: "MAX"
        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:48)
        at java.lang.Integer.parseInt(Integer.java:449)
        at java.lang.Integer.parseInt(Integer.java:499)
        at Node.<init>(Node.java:48)
        at GraphJob$SearchMapper.map(GraphJob.java:18) 
```

这是我的映射器和减少..

```
public class GraphJob {

public static class SearchMapper extends Mapper<Object, Text, Text, Text>{
    public void map(Object key, Text value, Context context)
                    throws IOException, InterruptedException{
        try{
        Node inNode = new Node(value.toString());
        if(inNode.getColor() == Node.Color.GRAY) {
            for(String neighbor : inNode.getEdges()) {
                Node adjacentNode = new Node();

                adjacentNode.setId(neighbor);
                int distance = inNode.getDistance() + 1;
                adjacentNode.setDistance(distance);
                if (distance < 2){
                    adjacentNode.setColor(Node.Color.GRAY);
                }
                else{
                    adjacentNode.setColor(Node.Color.BLACK);
                }
                adjacentNode.setParent(inNode.getId());
                context.write(new Text(adjacentNode.getId()), adjacentNode.getNodeInfo());
            }

            inNode.setColor(Node.Color.BLACK);
        }

        context.write(new Text(inNode.getId()), inNode.getNodeInfo());
        }catch(Exception e){

        }
    }
}

public static class SearchReducer extends Reducer<Text, Text, Text, Text> {
    public void reduce(Text key, Iterable<Text> values, Context context) throws IOException, InterruptedException {

        Node outNode = new Node();
        outNode.setId(key.toString());

        for (Text value : values) {
            Node inNode = new Node(key.toString() + "\t" + value.toString());

            if(inNode.getEdges().size() >0) {
                outNode.setEdges(inNode.getEdges());
            }
            if (inNode.getDistance() < outNode.getDistance()) {
                outNode.setDistance(inNode.getDistance());

                outNode.setParent(inNode.getParent());
            }
            if (inNode.getColor().ordinal() > outNode.getColor().ordinal()) {
                outNode.setColor(inNode.getColor());
            }
        }
        context.write(key, new Text(outNode.getNodeInfo()));

    }

}

public static void main(String[] args) throws Exception {

    Configuration conf = new Configuration();
    String[] otherargs = new GenericOptionsParser(conf, args).getRemainingArgs();
    Job job = new Job(conf, "GraphJob");
    job.setJarByClass(GraphJob.class);
    job.setMapperClass(SearchMapper.class);
    job.setReducerClass(SearchReducer.class);
    job.setOutputKeyClass(Text.class);
    job.setOutputValueClass(Text.class);
    FileInputFormat.addInputPath(job, new Path(otherargs[0]));
    FileOutputFormat.setOutputPath(job, new Path(otherargs[1]));
    System.out.println("start the job");
    System.exit(job.waitForCompletion(true) ? 0 : 1);
    }

} 
```

这是我的文本文件的示例..

```
1   2,7|0|GRAY|NULL
2   3,6,8|MAX|WHITE|NULL
3   2,4,5,6,8|MAX|WHITE|NULL
4   3,5,9|MAX|WHITE|NULL
5   3,4,8|MAX|WHITE|NULL
6   2,3|MAX|WHITE|NULL
7   1,8|MAX|WHITE|NULL
8   2,3,5,7,9|MAX|WHITE|NULL
9   4,8|MAX|WHITE|NULL 
```

输出文件应该是

```
1   2,7|0|BLACK|NULL
2   3,6,8|1|GRAY|1
7   1,8|GRAY|1
3   2,4,5,6,8|MAX|WHITE|NULL
4   3,5,9|MAX|WHITE|NULL
5   3,4,8|MAX|WHITE|NULL
6   2,3|MAX|WHITE|NULL
8   2,3,5,7,9|MAX|WHITE|NULL
9   4,8|MAX|WHITE|NULL 
```

但是使用 try & catch ... 来阻止错误.. 我只是得到..

```
1   2,7,|0|BLACK|NULL
2   |1|GRAY|1
7   |1|GRAY|1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:15:49.287

您可以在输入文件中将 MAX 更改为 Integer.MAX_VALUE 吗？例如：

```
1   2,7|0|GRAY|NULL
2   3,6,8|Integer.MAX_VALUE|WHITE|NULL
3   2,4,5,6,8|Integer.MAX_VALUE|WHITE|NULL
4   3,5,9|Integer.MAX_VALUE|WHITE|NULL
5   3,4,8|Integer.MAX_VALUE|WHITE|NULL
6   2,3|Integer.MAX_VALUE|WHITE|NULL
7   1,8|Integer.MAX_VALUE|WHITE|NULL
8   2,3,5,7,9|Integer.MAX_VALUE|WHITE|NULL
9   4,8|Integer.MAX_VALUE|WHITE|NULL 
```

您的输出文件应反映新值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:38:06.463

```
java.lang.NumberFormatException: For input string: "MAX" 
```

您正在尝试在代码中将 String 转换为 int 值。在调用作业之前，请确保您设置的值是 int。

# ruby - 在实例方法中使用 mixin 方法

> ID：11569532
> 
> 赞同：4
> 
> 时间：2012-07-19T21:23:15.250
> 
> 标签：ruby, gem

为什么这不起作用：

```
class Myclass
include HTTParty

   def dosomething
     base_uri("some_url")
   end

end 
```

base_uri 方法是 HTTParty 的一个类方法。如果我从我的类、任何实例方法之外或从类方法调用它，它工作正常，但是当尝试从实例方法调用它时，我得到“NoMethodError: undefined method `base_uri' for #”

为什么？不应该有某种方法可以从我的实例方法中引用 HTTParty 类，以便我可以调用该 HTTParty 类方法吗？

我可以将其更改为类方法，但我的类的每个实例都将具有相同的 base_uri 值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T21:30:27.297

为什么它不起作用？因为这不是 Ruby 的工作方式。同样，这不起作用：

```
class Foo
  def self.utility_method; ...; end
  def inst_method
    utility_method  # Error! This instance has no method named "utility_method"
  end
end 
```

您可以通过以下方式解决此问题：

```
class MyClass
  include HTTParty
  def dosomething
    HTTParty.base_uri("some_url")
  end
end 
```

让我们更深入地了解方法查找如何与模块一起工作。首先，一些代码：

```
module M
  def self.m1; end
  def m2; end
end

class Foo
  include M
end
p Foo.methods     - Object.methods #=> []
p Foo.new.methods - Object.methods #=> [:m2]

class Bar
  extend M
end
p Bar.methods     - Object.methods #=> [:m2]
p Bar.new.methods - Object.methods #=> []

class Jim; end
j = Jim.new
j.extend M
p j.methods       - Object.methods #=> [:m2] 
```

如我们所见，您可以使用`extend`来使对象（类或实例）对对象本身（而不是实例）使用模块的“实例”方法，但不能使模块的“类方法”成为被任何东西继承。你能得到的最接近的是这个成语：

```
module M2
  module ClassMethods
    def m1; end             # Define as an instance method of this sub-module!
  end
  extend ClassMethods       # Make all methods on the submodule also my own
  def self.included(k)
    k.extend(ClassMethods)  # When included in a class, extend that class with
  end                       # my special class methods

  def m2; end
end

class Foo
  include M2
end
p Foo.methods     - Object.methods #=> [:m1]
p Foo.new.methods - Object.methods #=> [:m2] 
```

*如果*模块使用了`HTTParty`上述模式，并因此使该`base_uri`方法在您的 上可用`MyClass`，那么您*可以*这样做：

```
class MyClass
  include HTTParty
  def dosomething
    self.class.base_uri("some_url")
  end
end 
```

...但这比直接引用拥有该方法的模块更重要。

最后，因为这可能对您有所帮助，所以这是我几年前制作的图表。（它缺少 Ruby 1.9 中的一些核心对象，`BasicObject`如

[![Ruby 方法查找流程](../Images/e7798b89585d3f13eb1b43fbbf3ad290.png)](http://phrogz.net/RubyLibs/RubyMethodLookupFlow.pdf)
[（来源：[phrogz.net](http://phrogz.net/RubyLibs/RubyMethodLookupFlow.png)）]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:33:58.710

```
class Myclass
  include HTTParty

  def dosomething
    Myclass.base_uri("some_url")
  end

end 
```

# c++ - 从 hWnd 获取（资源）ID

> ID：11569533
> 
> 赞同：5
> 
> 时间：2012-07-19T21:23:25.270
> 
> 标签：c++, winapi

在 ResourceHacker 中，当您打开可执行文件（Windows）时，您可以看到与对话框关联的标识符。有谁知道他们来自哪里？我的意思是，我怎样才能在我的 C++ 程序中做同样的事情来从 HWND 获取 ID？

顺便说一句，GetWindowLong(hwnd, GWL_ID) 返回 0。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T21:46:43.870

返回对话框中控件的`GetWindowLong(hwnd, GWL_ID)`标识符，但它不能用于对话框本身，因为对话框根本*没有*标识符。

与对话框关联的标识符实际上用于引用资源 blob 本身，而不是窗口。它们用于创建对话框（请参阅[CreateDialog()](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645434%28v=vs.85%29.aspx)。

创建对话框后，与原始模板或该标识符没有任何联系。实际上，该 ID 没有用处，对话框只是由它的`HWND`. 请注意，您可以使用相同的对话框资源创建多个不同的对话框。

这些标识符（通常）由资源编辑器按顺序分配，或者如果您手动创建资源，则手动分配。

有关该主题的更多信息，您可以阅读有关[CreateDialogIndirect()函数的信息，该函数在](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645436%28v=vs.85%29.aspx)*不*使用资源的情况下创建对话框。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-22T01:17:42.503

在这里您可以找到一个很好的答案：http: [//blogs.msdn.com/b/oldnewthing/archive/2005/07/08/436815.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2005/07/08/436815.aspx)

> 这就像问，“给定一盘食物，我如何恢复原始食谱和食谱的页码？” 通过对食物进行化学分析，您可能能够恢复“一个”食谱，但食物本身并没有说：“我来自烹饪的乐趣，第 253 页。”

所以答案是微软没有提供获取对话框ID的方法。他们本可以轻松地将其存储在任何地方以使其可用，但他们没有。

但是仍然有办法做到这一点，尽管它不是防弹的。你可以：

1.) 通过获取对话框的创建者文件`GetWindowModuleFileName()`

2.) 通过加载此 Exe 或 Dll`LoadLibraryEx(..., LOAD_LIBRARY_AS_IMAGE_RESOURCE)`

`EnumResourceNames()`3.) 通过名称中的对话框 ID枚举 Exe 或 Dll 中的所有 RT_DIALOG 资源：`ResourceName = MAKEINTRESOURCE(IDD_DIALOG_ID)`

4.) Create each enumerated dialog invisibly via `LoadResource()`, `LockResource()`, `CreateDialogIndirect()` but without showing the dialog with `ShowWindow()`.

5.) Enumerate the child controls in each dialog via `EnumChildWindows()` and compare them to your dialog.

6.) Release all handles and destroy the dialogs.

It is not very probable that there are two identical dialogs in a Exe/Dll file. But the problem is that in `WM_INITDIALOG` the programmer may eliminate (destroy) or add or modify child controls. So your search algorithm would have to be fault tolerant. This would be possible by counting the congruency between each dialog from the resources and your dialog. You could count for how many child controls the ID (`GetDlgCtrlID()`)and class name (`GetClassName()`) match. (e.g. Class="BUTTON" and ID = 311") While a programmer can easily change the text of a control or move it around, changing the ID is not very probable and does not make much sense and changing the class of a child control is even impossible.

As I said: It is not bullet proof, but you will find the ID of the resource that has most probably been used to create the dialog.

Be aware that not all dialogs come from a Microsoft resource. They can be created by a GUI framework that uses its own type of templates. In this case you will never find the Dialog ID because it simply does not exist.

# python - 带有生成器的 Python 嵌套循环不起作用（在某些情况下）？

> ID：11569535
> 
> 赞同：10
> 
> 时间：2012-07-19T21:23:35.783
> 
> 标签：python, generator, nested-loops

有人可以解释一下使用生成器的嵌套循环的行为吗？这是一个例子。

```
a = (x for x in range(3))
b = (x for x in range(2))
for i in a:
    for j in b:
        print (i,j) 
```

由于某种原因，在第一次迭代后不评估外循环。结果是，

```
(0, 0)
(0, 1) 
```

另一方面，如果将生成器直接插入循环中，它会达到我的预期。

```
for i in (x for x in range(3)):
    for j in (x for x in range(2)):
        print (i,j) 
```

给所有 3x2 对。

```
(0, 0)
(0, 1)
(1, 0)
(1, 1)
(2, 0)
(2, 1) 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-07-19T21:26:50.263

这是因为`b`生成器在外部 for 循环的第一次迭代期间耗尽。随后的迭代实际上将具有一个空的内部循环（如`for x in ()`），因此永远不会执行内部循环。这给人一种错误的印象，即以某种方式失败的是外部循环。

您的第二个示例有效，因为在那里为每个外部循环重新创建了内部生成器。要修复您的第一个示例，您必须执行相同的操作：

```
a = (x for x in range(3))
for i in a:
    b = (x for x in range(2))
    for j in b:
        print (i,j) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-19T21:37:53.560

@lazyr 已经出色地回答了这个问题，但我会指出作为参考，当使用嵌套生成器时，值得了解`itertools.product`...

```
for i, j in itertools.product(range(3), range(2)):
    print (i, j) 
```

或者（如果你有*很多*vals）：

```
for vals in itertools.product(range(45), range(12), range(3)):
    print (sum(vals)) 
```

它（恕我直言）可读并避免过多的缩进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-05T14:56:00.990

itertools.product 最适合这个例子。但是您可能在迭代期间需要更多选项。这是在不使用产品方法的情况下仍然在您的示例中获取产品的一种方法：

```
a = (range(2) for x in range(3))
for i in a:
    for j in i:
        print (i,j) 
```

此外，我使用pytoolz 功能帮助库中的[itertoolz.concat](https://toolz.readthedocs.org/en/latest/api.html#toolz.itertoolz.concat)来简化/扁平化这样的案例。concat 就像 itertools.chain 一样，但取而代之的是一个参数，它产生的迭代器被解开：

```
from pytoolz import itertoolz
a = (((x,y) for y in range(2)) for x in range(3))
for i,j in itertoolz.concat(a):
    print (i,j) 
```

因此，上面的方法看起来比 product 方法可读性差，但允许在每个循环级别进行更细粒度的转换/过滤。当然，在最终的迭代逻辑中你没有嵌套的 for 循环，这很好。

此外，如果您使用 pytoolz，您可能应该使用 cytoolz，它与编译成 C 的库相同。

# c# - 如何在 MS Visual Studio 2010 中创建 MS Access 2010 插件？

> ID：11569542
> 
> 赞同：2
> 
> 时间：2012-07-19T21:24:19.173
> 
> 标签：c#, visual-studio-2010, ms-access, ribbon-control

请您帮我如何在 MS Visual Studio 2010 中创建 MS Access 2010 插件？

在 VS 2010 Professional 中，只有用于创建 Excel、Word 加载项的模板，但没有用于 Access 的模板。

我可以在某处下载 MS Access 插件项目的模板吗？

# eclipse - Eclipse IAM 和 Maven 解析 pom.xml 中未列出的依赖项

> ID：11569544
> 
> 赞同：0
> 
> 时间：2012-07-19T21:24:27.673
> 
> 标签：eclipse, maven, pom.xml

我有两个 Java 项目：子项和父项，子项取决于父项。两个项目的项目布局如下图所示：

![在此处输入图像描述](../Images/e5bb2153a48a529afe0f596a1b5206c2.png)

Parent 和 Child 项目的 .class 路径分别在下面列出：

**家长：**

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry excluding="src/" kind="src" path=""/>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
    <classpathentry kind="output" path="bin"/>
</classpath> 
```

**孩子：**

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
    <classpathentry combineaccessrules="false" kind="src" path="/ParentProject"/>
    <classpathentry kind="output" path="bin"/>
</classpath> 
```

Child 依赖于 parent，如上面的 classpathentry 所示。

我使用[Eclipse Integration for Apache Maven 插件 (IAM)](http://maven.apache.org/eclipse-plugin.html)将这些 Java 项目转换为 Maven 项目。对应的 pom.xml 文件如下：

**家长：**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.parentco</groupId>
  <artifactId>ParentProject</artifactId>
  <version>0.0.1-SNAPSHOT</version>
</project> 
```

**孩子：**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.childco</groupId>
  <artifactId>ChildProject</artifactId>
  <version>0.0.1-SNAPSHOT</version>
</project> 
```

如您所见，子 pom.xml 不依赖于 Parent 工件。

我在两个项目上使用“全新安装”目标运行 Maven Build，从父项目开始，我看到工件被部署到我的本地存储库。太好了.... 但是等等.... Child 的 pom 没有列出对 Parent 的依赖项，但 Child 项目成功构建，如输出控制台中所示。

```
[DEBUG]   (f) packaging = jar
[DEBUG]   (f) pomFile = C:\Users\nji\workspace\ChildProject\pom.xml
[DEBUG]   (f) updateReleaseInfo = false
[DEBUG] -- end configuration --
[DEBUG] Using manager EnhancedLocalRepositoryManager with priority 10 for C:\Users\nji\.m2\repository
[INFO] Installing C:\Users\nji\workspace\ChildProject\target\ChildProject-0.0.1-SNAPSHOT.jar to C:\Users\nji\.m2\repository\org\childco\ChildProject\0.0.1-SNAPSHOT\ChildProject-0.0.1-SNAPSHOT.jar
[INFO] Installing C:\Users\nji\workspace\ChildProject\pom.xml to C:\Users\nji\.m2\repository\org\childco\ChildProject\0.0.1-SNAPSHOT\ChildProject-0.0.1-SNAPSHOT.pom
[DEBUG] Installing org.childco:ChildProject:0.0.1-SNAPSHOT/maven-metadata.xml to C:\Users\nji\.m2\repository\org\childco\ChildProject\0.0.1-SNAPSHOT\maven-metadata-local.xml
[DEBUG] Installing org.childco:ChildProject/maven-metadata.xml to C:\Users\nji\.m2\repository\org\childco\ChildProject\maven-metadata-local.xml
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.809s
[INFO] Finished at: Thu Jul 19 17:05:08 EDT 2012
[INFO] Final Memory: 15M/217M
[INFO] ------------------------------------------------------------------------ 
```

那么，Maven 是如何在 pom.xml 中没有显式条目的情况下实现这一点的，即使它在 .classpath 中删除了 Parent 的类路径条目？

这是项目被 mavenized 后的 .classpaths：

**家长：**

```
 <?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/J2SE-1.5"/>
    <classpathentry kind="con" path="org.eclipse.m2e.MAVEN2_CLASSPATH_CONTAINER"/>
    <classpathentry kind="output" path="target/classes"/>
</classpath> 
```

**孩子：**

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/J2SE-1.5"/>
    <classpathentry kind="con" path="org.eclipse.m2e.MAVEN2_CLASSPATH_CONTAINER"/>
    <classpathentry kind="output" path="target/classes"/>
</classpath> 
```

作为最后的手段，它只是悄悄地查看我的本地存储库吗？此外，如果我打开代码编辑器来编辑 Child 中依赖于 Parent 的类，我会得到解析错误，如果我将此依赖项添加到 child 的 pom.xml 中，这可能会得到修复。这不是 IAM 应该做的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:31:25.360

Maven 不会为您显式地将依赖项写入 pom.xml。但是，一旦您在任一 pom 文件（父文件或子文件）中列出了依赖项，那么 maven 应该能够在类路径中拥有所有依赖项，从而能够部署所有依赖项。

Maven 只构建一次类路径变量，其中将列出所有依赖项。因此您无需多次指定它。

# php - PHP exec() 带双引号参数

> ID：11569546
> 
> 赞同：1
> 
> 时间：2012-07-19T21:24:31.710
> 
> 标签：php, command-line-arguments

我在 Windows 上使用 PHP 的 exec() 函数运行命令时遇到问题。根据 PHP 网站上关于[exec()](http://php.net/manual/en/function.exec.php)的评论：

> 在 Windows 中，exec() 发出对“cmd /c your_command”的内部调用。

我的命令看起来像：

```
"path\to\program.exe" -flag1 attribute1 -flag2 attribute2 -flag3 "attribute3 attribute4" 
```

在我的本地命令提示符下定期执行此命令，没有 /c 标志，该命令运行良好。但是，随着 /c 标志的引入，命令提示符告诉我“系统找不到指定的路径”。

我认为命令提示符将双引号参数解释为另一个文件的路径，但这是我遇到的最远的问题。

有人对如何克服这个有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T17:49:29.103

我已经自己想出了答案...

仔细阅读 cmd.exe 的 /? 并试图破译这一点，我注意到一个重要的部分：

> 1.  如果满足以下所有条件，则保留命令行中的引号字符：
>     
>     
>     *   无 /S 开关（带引号）
>     *   正好两个引号字符
>     *   两个引号字符之间没有特殊字符，其中 special 是以下之一： & < >( ) @ ^ |
>     *   两个引号字符之间有一个或多个空格字符
>     *   两个引号字符之间的字符串是可执行文件的名称。
> 2.  否则，旧的行为是查看第一个字符是否是引号字符，如果是，则去除前导字符并删除命令行上的最后一个引号字符，保留最后一个引号字符之后的任何文本。要否定此行为，请在命令行的开头和结尾使用双引号 ""。

似乎在任何时候都有一对以上的引号，引号将从第二对引号中删除，然后继续。

一个相关的问题：[如何在使用 cmd.exe](https://stackoverflow.com/questions/355988/how-do-i-deal-with-quote-characters-when-using-cmd-exe)但不完全相关时处理引号字符，因为 PHP 不允许您通过在其调用上放置 /S 标志来修改其 exec() 命令（这肯定会很多更轻松）。

我已经设法通过使用 chdir() 直接将目录更改为 .exe 所在的文件夹，然后 chdir()'ing 回到我原来的工作目录来解决这个问题。这是一个非常 hacky 的解决方案，因为我很幸运我只有一组使用双引号的参数。如果有人要使用双引号有多个参数，我不知道如何解决...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-03-04T12:44:59.353

我也遇到了这个问题，其原因确实是您自己的答案中描述的“cmd /c”的内部使用。

我做了一些调查，发现这在 PHP 5.3 中得到了解决，这就是为什么一些评​​论者无法重现它的原因。

它在以下提交中得到修复：

[https://github.com/php/php-src/commit/19322fc782af429938da8d3b421c0807cf1b848a#diff-15f2d3ef68f383a87cce668765721041R221](https://github.com/php/php-src/commit/19322fc782af429938da8d3b421c0807cf1b848a#diff-15f2d3ef68f383a87cce668765721041R221)

对于仍然需要支持 PHP 5.2 的任何人来说，在您自己的代码中复制修复是相当容易的。代替：

```
$cmd = "...any shell command, maybe with multiple quotes...";
exec($cmd); 
```

采用

```
$cmd = "...any shell command, maybe with multiple quotes...";

if (strtoupper(substr(php_uname('s'), 0, 3)) == "WIN"
    && version_compare(PHP_VERSION, "5.3", "<")) 
{
    $cmd = '"' . $cmd . '"';
}

exec($cmd); 
```

这复制了 PHP 5.3 及更高版本的行为，与上面链接的提交中的方式相同。

请注意，这适用于所有 shell 命令，而不仅仅是我的示例中使用的 exec()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:26:25.783

只是一个猜测（我不熟悉 Windows 上的 PHP）：也许将引号转义为`"`become `""`？

```
"path\to\program.exe" -flag1 attribute1 -flag2 attribute2 -flag3 ""attribute3 attribute4"" 
```

无论解决方案是什么，请确保当有某种形式的用户输入作为参数传递给此命令时，您使用[escapeshellarg](http://php.net/manual/en/function.escapeshellarg.php)和/或[escapeshellcmd](http://www.php.net/manual/en/function.escapeshellcmd.php)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T21:47:40.083

我希望它会有所帮助

[escapeshellarg() — 转义要用作 shell 参数的字符串](http://www.php.net/manual/en/function.escapeshellarg.php)
[escapeshellcmd() — 转义 shell 元字符](http://www.php.net/manual/en/function.escapeshellcmd.php)

# document - InDesign CS5 脚本：如何将另一个 InDesign 文档放入新的 InDesign 文档中？

> ID：11569549
> 
> 赞同：0
> 
> 时间：2012-07-19T21:24:36.833
> 
> 标签：document, adobe-indesign, extendscript

我正在使用  `var newDoc = app.documents.add()` .

我正在尝试将另一个具有段落样式的预先存在的 InDesign 文档放入新文档中。我不简单使用的原因  `styledDocument.execute()`  是它打开了这个预先存在的文档，而我希望文档本身是“ `Untitled`”。

我试图用 来做到这一点  `newDoc.place(styledDocument)` ，但这是行不通的。该文档未按预期命名，但仅将样式化文档作为链接，并且***未***使用样式化文档中的样式填充  `Paragrah Styles`  窗口...

* * *

可以从  InDesign 菜单*中**手动*`File --> Place...`  将另一个 InDesign 文档打开到该文档中，其中该文档中的样式***确实***出现在    窗口中……但我想以编程方式执行此操作。所以，我假设    InDesign 菜单中的  . **`Paragrah Styles``File --> Place...``newDoc.place(oldDoc)`

* * *

这是我的代码（*不起作用*）：

```
var newDoc = app.documents.add();
newDoc.place(styledDocument); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T09:12:12.383

Wawawaaa，你的最终目的是什么？将 doc A 中的样式加载到 Doc B 中？如果是这样，为什么不使用文档的 importStyles 方法？如果您确实想将文档作为图像导入，您可以使用 place 方法并将文档指定为任何其他图像文件。**

# hadoop - 查找两列匹配的 TOP 3

> ID：11569550
> 
> 赞同：0
> 
> 时间：2012-07-19T21:24:41.400
> 
> 标签：hadoop, mapreduce, hive, hiveql

这是我的 Table1 中的以下数据

```
BID           PID                       TIME
---------+-------------------+----------------------
1345653       330760137950       2012-07-09 21:42:29
1345653       330760137950       2012-07-09 21:43:29
1345653       330760137950       2012-07-09 21:40:29
1345653       330760137950       2012-07-09 21:41:29
1345653       110909316904       2012-07-09 21:29:06
1345653       221065796761       2012-07-09 19:31:48 
```

因此，如果我需要澄清上述情况——我在上表中有这样的数据——对于用户`1345653`，我有这个 PID `330760137950` `four times`，但时间戳不同。所以我需要这样的输出 -

我需要的输出：-

```
1345653       330760137950       2012-07-09 21:43:29
1345653       330760137950       2012-07-09 21:42:29
1345653       330760137950       2012-07-09 21:41:29
1345653       110909316904       2012-07-09 21:29:06
1345653       221065796761       2012-07-09 19:31:48 
```

所以基本上如果`BID`和`PID`相同但不同`timestamps`，那么我需要按时间降序排序的前 3 名

为此，我`rank UDF`在 Hive 中创建了（用户定义的函数）。我写了下面的查询，但它对我不起作用。谁可以帮我这个事？

```
SELECT bid, pid, rank(bid), time, UNIX_TIMESTAMP(time)
FROM (
    SELECT bid, pid, time
    FROM table1
    where to_date(from_unixtime(cast(UNIX_TIMESTAMP(time) as int))) = '2012-07-09'
    DISTRIBUTE BY bid,pid
    SORT BY bid, time desc
) a
WHERE rank(bid) < 3; 
```

所以通过上面的查询，我得到这样的输出

```
1345653       330760137950       2012-07-09 21:43:29
1345653       330760137950       2012-07-09 21:42:29
1345653       330760137950       2012-07-09 21:41:29 
```

这是错误的，因为我缺少`Expected Output`上面的最后两行。谁能帮我这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:27:31.417

```
select bid, pid, [time] from (
    select bid, pid, [time], rank() over (partition by bid, pid order by [time] desc) as k 
    from #temp ) as x 
where k  <=3
order by bid, pid, time desc 
```

哦，我在 sql server 中。我不认为你是......

反正。我的建议是您将排名函数移动到您拥有的嵌套选择中。在外部选择你想要它小于三个的地方......我不知道你的语法。我不应该回答这个问题。对不起....大声笑

在这里： [http](http://ragrawal.wordpress.com/2011/11/18/extract-top-n-records-in-each-group-in-hadoophive/) ://ragrawal.wordpress.com/2011/11/18/extract-top-n-records-in-each-group-in-hadoopive/ 你的 rank() 在外部选择中......它需要在内心。不过，请在外部 where 语句中保留 < 4 或 <= 3 或其他任何内容。您的查询几乎看起来与该示例完全一样......只需要进行一些更改。

**基于链接和我对 Hive 的绝对缺乏知识......我想你可能想要这个：**

```
SELECT bid, pid, time
FROM (
    SELECT bid, pid, rank(time) as rank, time
    FROM $compTable 
    DISTRIBUTE BY bid, pid
    SORT BY bid, pid, time desc
) a
WHERE rank < 4
ORDER BY bid, pid, time desc 
```

而且我无法测试或编译，因为老实说，在您发布问题之前我不知道蜂巢是什么。（小世界，我知道，如此悲伤——如此真实）

# php - 如何使用 php 从多行表单更新 mysql 数据库

> ID：11569556
> 
> 赞同：3
> 
> 时间：2012-07-19T21:25:20.947
> 
> 标签：php, mysql, html, forms

我是 PHP 新手，整天都在努力解决这个问题。我有一个包含玩家详细信息的 MySQL 数据库。我想从数据库中选择它们并以表格的形式显示在表格中，这适用于下面的代码。

当我想更新行时，问题就出现了，可能是使用选项字段将播放器状态从活动状态变为非活动状态。当我按下提交时，我可以获得每个 pdbactive 字段的值 OK，但我无法获得 PID，这是对数据库进行更新的关键。

```
<form name="selected_players" action="" method="POST">
            <table border="1">
            <th>Player ID</th>
            <th>Player Name</th>
            <th>Player Surname</th>
            <th>Status</th>
            <th>Primary Team*</th>
            <?php
            // Then get the players from the players table who have got same team_name but no team_id yet....which would have be set if they were active
            $query = "select * from `player2012` where teamid ='$tid' and aru='A';";     
            $result = mysql_query($query) or die ("Error in query: $query " . mysql_error()); 
            $count = mysql_num_rows($result);  
            echo $count;
            //echo ("<br />");

            while ($row = mysql_fetch_assoc($result)) {

                    $player_id = $row["player_id"];     
                    $player_fname = $row["player_fname"];
                    $player_sname = $row["player_sname"];
                    $pactive = $row["active"];  
                    //echo ($pactive);
                    //echo ("<br />");  
                    ?>
                     <tr>
                        <td><input name"pid[]" id="pid[]" type="text" value="<?php echo $player_id ?>" /><?php echo $player_id ?></td>
                        <td><input name"player_fn[]" type="hidden" value="<?php echo $player_fname ?>" /><?php echo $player_fname ?></td>
                        <td><input name"player_sn[]" type="hidden" value="<?php echo $player_sname ?>" /><?php echo $player_sname ?></td>

                        <?php if($pactive=="1"){
                            ?>
                                <td><select name="pdbactive[]" id="pdbactive[]">
                                <option value="1" selected="selected">Active</option>
                                <option value="0">Not Active</option>
                                </td>
                        <?php  }
                        else
                        {
                            ?>
                                <td><select name="pdbactive[]" id="pdbactive[]">
                                <option value="1">Active</option>
                                <option value="0" selected="selected">Not Active</option>
                        </td>
                        <?php
                        }
                        ?>

                        <td>&nbsp;
                        </td>
                    </tr>
                 <?php
                     }
                  ?>
                </table>
            <p>&nbsp;</p>
            <p> When you have updated "status" for each of these players, please press submit button 
                <input name="Submit" type="submit" id="Sumbit" value="Submit" /> </p>
            </form>

            <?php

            mysql_free_result($result); 

            //if form has been pressed proccess it
            if($_POST["Submit"])
            {
                    //get data from form
                    $ractive = $_POST['pdbactive'];
                    $rid= $_POST['pid'];

                    for($i=0;$i<$count;$i++){
                            echo ($i);
                            echo ("<br />");
                            $stat=($ractive[$i]);
                            $idd=($rid[$i]);

                            $sql_insert="UPDATE 'player2012' SET active='$stat' where id='$idd'";
                            print($sql_insert);
                            echo ("<br />");
                            }
            }

            ?> 
```

目前我只想创建 SQL 语句，以便在开始更新数据库之前知道它可以工作。所以所有的回声和打印只是我试图找出答案

帮助！！！！！！！！！！！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:41:07.397

What's the exact name of the table you're trying to insert into ? (case-sensitive wise). If it's lowercase like in:
`UPDATE 'player2012' SET active='$stat' where id='$idd'`

- it should be fine, but it it's uppercase - you should remove the quotes:

`UPDATE player2012 SET active='$stat' where id='$idd'`.

Also, I would add: `echo $rid;` and inside the for-loop: `echo $idd;` to see what's the parameters I'm getting.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T09:56:36.930

解决了。

问题是我在表单输入名称上缺少一个“=”

```
<td><input name"pid[]" id="pid[]" type="text"..... 
```

应该读

```
<td><input name="pid[]" id="pid[]" type="text".... 
```

微妙但现在可以享受！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:38:17.193

我不是 100% 确定你在寻找什么，但我认为你想要一个选项，比如每个播放器旁边的复选框，如果选中了那个框并且你点击提交，它会删除那个播放器？

# jdom - 相当于 JDOM 中 DOM 的 normalize 函数

> ID：11569557
> 
> 赞同：0
> 
> 时间：2012-07-19T21:25:28.453
> 
> 标签：jdom, normalize

有人能告诉我类似于 JDOM 中 DOM 的 normalize() 的功能吗？我实际上想规范化 XML 内容并通过 XMLSerializer 对其进行序列化。

谢谢你山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:17:27.450

桑迪普。

JDOM 没有直接的“规范化”概念。不过，写一个不会特别难。另一方面，您的意图是以某种格式输出 XML，所有 JDOM 输出机制都会为您规范化数据。

因此，例如，如果您想将 JDOM 文档输出为纯 XML 文本，您可以使用 org.jdom2.output 中的 XMLOutputter 类并使用适当的 org.jdom2.output.Format 实例（例如 Format.getPrettyFormat() - 不要使用 getRawFormat() 因为原始格式化程序根本不会标准化输出）。

除了将 JDOM 文档输出为基于文本的 XML 之外，您还可以输出到 DOM 文档、SAX 偶数流甚至 StAX 流。这些中的每一个都将产生一个“标准化”输出。

所以，你想做的（可能）是：

```
Document mudoc = .....;
XMLOutputter xout = new XMLOutputter(Format.getPrettyFormat());
xout.output(mydoc, somestream); 
```

罗尔夫

# python - 转换 pyqt4 .py 文件以供使用

> ID：11569559
> 
> 赞同：1
> 
> 时间：2012-07-19T21:25:45.563
> 
> 标签：python, pyqt, pyqt4

我设计了一个 GUI 并将 .ui 文件转换为 .py 文件，我发现了很多奇怪的乱码。无论如何，任何人都可以帮助我将此语法转换为常规 python，以便我实际上可以将函数传递给按钮等。过去一天我一直在玩它，并取得了一些成就。

```
from PyQt4 import QtCore, QtGui

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName(_fromUtf8("MainWindow"))
        MainWindow.resize(929, 597)
        MainWindow.setWindowTitle(QtGui.QApplication.translate("MainWindow", "Intex | Server Monitor System", None, QtGui.QApplication.UnicodeUTF8))
        self.centralwidget = QtGui.QWidget(MainWindow)
        self.centralwidget.setObjectName(_fromUtf8("centralwidget"))
        self.plottab = QtGui.QTabWidget(self.centralwidget)
        self.plottab.setGeometry(QtCore.QRect(20, 10, 661, 511))
        self.plottab.setObjectName(_fromUtf8("plottab"))
        self.juliet = QtGui.QWidget()
        self.juliet.setObjectName(_fromUtf8("juliet"))
        self.label_2 = QtGui.QLabel(self.juliet)
        self.label_2.setGeometry(QtCore.QRect(20, 10, 111, 16))
        self.label_2.setText(QtGui.QApplication.translate("MainWindow", "Performance Monitor", None, QtGui.QApplication.UnicodeUTF8))
        self.label_2.setObjectName(_fromUtf8("label_2"))
        self.scrollArea_2 = QtGui.QScrollArea(self.juliet)
        self.scrollArea_2.setGeometry(QtCore.QRect(20, 30, 241, 221))
        self.scrollArea_2.setWidgetResizable(True)
        self.scrollArea_2.setObjectName(_fromUtf8("scrollArea_2"))
        self.scrollAreaWidgetContents_2 = QtGui.QWidget()
        self.scrollAreaWidgetContents_2.setGeometry(QtCore.QRect(0, 0, 237, 217))
        self.scrollAreaWidgetContents_2.setObjectName(_fromUtf8("scrollAreaWidgetContents_2"))
        self.scrollArea_2.setWidget(self.scrollAreaWidgetContents_2)
        self.label_13 = QtGui.QLabel(self.juliet)
        self.label_13.setGeometry(QtCore.QRect(330, 10, 111, 16))
        self.label_13.setText(QtGui.QApplication.translate("MainWindow", "Server Load Monitor", None, QtGui.QApplication.UnicodeUTF8))
        self.label_13.setObjectName(_fromUtf8("label_13"))
        self.scrollArea_10 = QtGui.QScrollArea(self.juliet)
        self.scrollArea_10.setGeometry(QtCore.QRect(330, 30, 241, 221))
        self.scrollArea_10.setWidgetResizable(True)
        self.scrollArea_10.setObjectName(_fromUtf8("scrollArea_10"))
        self.scrollAreaWidgetContents_10 = QtGui.QWidget()
        self.scrollAreaWidgetContents_10.setGeometry(QtCore.QRect(0, 0, 237, 217))
        self.scrollAreaWidgetContents_10.setObjectName(_fromUtf8("scrollAreaWidgetContents_10"))
        self.scrollArea_10.setWidget(self.scrollAreaWidgetContents_10)
        self.label_16 = QtGui.QLabel(self.juliet)
        self.label_16.setGeometry(QtCore.QRect(20, 270, 171, 16))
        self.label_16.setText(QtGui.QApplication.translate("MainWindow", "Incoming IP Adresses/Users", None, QtGui.QApplication.UnicodeUTF8))
        self.label_16.setObjectName(_fromUtf8("label_16"))
        self.scrollArea_13 = QtGui.QScrollArea(self.juliet)
        self.scrollArea_13.setGeometry(QtCore.QRect(20, 290, 241, 181))
        self.scrollArea_13.setWidgetResizable(True)
        self.scrollArea_13.setObjectName(_fromUtf8("scrollArea_13"))
        self.scrollAreaWidgetContents_13 = QtGui.QWidget()
        self.scrollAreaWidgetContents_13.setGeometry(QtCore.QRect(0, 0, 237, 177))
        self.scrollAreaWidgetContents_13.setObjectName(_fromUtf8("scrollAreaWidgetContents_13"))
        self.scrollArea_13.setWidget(self.scrollAreaWidgetContents_13)
        self.plottab.addTab(self.juliet, _fromUtf8(""))
        self.newjulietleft = QtGui.QWidget()
        self.newjulietleft.setObjectName(_fromUtf8("newjulietleft"))
        self.scrollArea = QtGui.QScrollArea(self.newjulietleft)
        self.scrollArea.setGeometry(QtCore.QRect(20, 30, 241, 221))
        self.scrollArea.setWidgetResizable(True)
        self.scrollArea.setObjectName(_fromUtf8("scrollArea"))
        self.scrollAreaWidgetContents = QtGui.QWidget()
        self.scrollAreaWidgetContents.setGeometry(QtCore.QRect(0, 0, 237, 217))
        self.scrollAreaWidgetContents.setObjectName(_fromUtf8("scrollAreaWidgetContents"))
        self.scrollArea.setWidget(self.scrollAreaWidgetContents)
        self.label = QtGui.QLabel(self.newjulietleft)
        self.label.setGeometry(QtCore.QRect(20, 10, 111, 16))
        self.label.setText(QtGui.QApplication.translate("MainWindow", "Performance Monitor", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setObjectName(_fromUtf8("label"))
        self.label_12 = QtGui.QLabel(self.newjulietleft)
        self.label_12.setGeometry(QtCore.QRect(330, 10, 111, 16))
        self.label_12.setText(QtGui.QApplication.translate("MainWindow", "Server Load Monitor", None, QtGui.QApplication.UnicodeUTF8))
        self.label_12.setObjectName(_fromUtf8("label_12"))
        self.scrollArea_9 = QtGui.QScrollArea(self.newjulietleft)
        self.scrollArea_9.setGeometry(QtCore.QRect(330, 30, 241, 221))
        self.scrollArea_9.setWidgetResizable(True)
        self.scrollArea_9.setObjectName(_fromUtf8("scrollArea_9"))
        self.scrollAreaWidgetContents_9 = QtGui.QWidget()
        self.scrollAreaWidgetContents_9.setGeometry(QtCore.QRect(0, 0, 237, 217))
        self.scrollAreaWidgetContents_9.setObjectName(_fromUtf8("scrollAreaWidgetContents_9"))
        self.scrollArea_9.setWidget(self.scrollAreaWidgetContents_9)
        self.label_15 = QtGui.QLabel(self.newjulietleft)
        self.label_15.setGeometry(QtCore.QRect(20, 270, 171, 16))
        self.label_15.setText(QtGui.QApplication.translate("MainWindow", "Incoming IP Adresses/Users", None, QtGui.QApplication.UnicodeUTF8))
        self.label_15.setObjectName(_fromUtf8("label_15"))
        self.scrollArea_12 = QtGui.QScrollArea(self.newjulietleft)
        self.scrollArea_12.setGeometry(QtCore.QRect(20, 290, 241, 181))
        self.scrollArea_12.setWidgetResizable(True)
        self.scrollArea_12.setObjectName(_fromUtf8("scrollArea_12"))
        self.scrollAreaWidgetContents_12 = QtGui.QWidget()
        self.scrollAreaWidgetContents_12.setGeometry(QtCore.QRect(0, 0, 237, 177))
        self.scrollAreaWidgetContents_12.setObjectName(_fromUtf8("scrollAreaWidgetContents_12"))
        self.scrollArea_12.setWidget(self.scrollAreaWidgetContents_12)
        self.plottab.addTab(self.newjulietleft, _fromUtf8(""))
        self.custom = QtGui.QWidget()
        self.custom.setObjectName(_fromUtf8("custom"))
        self.comboBox = QtGui.QComboBox(self.custom)
        self.comboBox.setGeometry(QtCore.QRect(20, 30, 74, 22))
        self.comboBox.setObjectName(_fromUtf8("comboBox"))
        self.comboBox.addItem(_fromUtf8(""))
        self.comboBox.setItemText(0, QtGui.QApplication.translate("MainWindow", "Hulk", None, QtGui.QApplication.UnicodeUTF8))
        self.comboBox.addItem(_fromUtf8(""))
        self.comboBox.setItemText(1, QtGui.QApplication.translate("MainWindow", "Superman", None, QtGui.QApplication.UnicodeUTF8))
        self.comboBox.addItem(_fromUtf8(""))
        self.comboBox.setItemText(2, QtGui.QApplication.translate("MainWindow", "Karma", None, QtGui.QApplication.UnicodeUTF8))
        self.comboBox.addItem(_fromUtf8(""))
        self.comboBox.setItemText(3, QtGui.QApplication.translate("MainWindow", "wdl", None, QtGui.QApplication.UnicodeUTF8))
        self.comboBox.addItem(_fromUtf8(""))
        self.comboBox.setItemText(4, QtGui.QApplication.translate("MainWindow", "Pong", None, QtGui.QApplication.UnicodeUTF8))
        self.label_3 = QtGui.QLabel(self.custom)
        self.label_3.setGeometry(QtCore.QRect(20, 10, 71, 16))
        self.label_3.setText(QtGui.QApplication.translate("MainWindow", "Select Server", None, QtGui.QApplication.UnicodeUTF8))
        self.label_3.setObjectName(_fromUtf8("label_3"))
        self.scrollArea_7 = QtGui.QScrollArea(self.custom)
        self.scrollArea_7.setGeometry(QtCore.QRect(20, 100, 241, 221))
        self.scrollArea_7.setWidgetResizable(True)
        self.scrollArea_7.setObjectName(_fromUtf8("scrollArea_7"))
        self.scrollAreaWidgetContents_7 = QtGui.QWidget()
        self.scrollAreaWidgetContents_7.setGeometry(QtCore.QRect(0, 0, 237, 217))
        self.scrollAreaWidgetContents_7.setObjectName(_fromUtf8("scrollAreaWidgetContents_7"))
        self.scrollArea_7.setWidget(self.scrollAreaWidgetContents_7)
        self.label_10 = QtGui.QLabel(self.custom)
        self.label_10.setGeometry(QtCore.QRect(20, 80, 111, 16))
        self.label_10.setText(QtGui.QApplication.translate("MainWindow", "Performance Monitor", None, QtGui.QApplication.UnicodeUTF8))
        self.label_10.setObjectName(_fromUtf8("label_10"))
        self.scrollArea_8 = QtGui.QScrollArea(self.custom)
        self.scrollArea_8.setGeometry(QtCore.QRect(360, 100, 241, 221))
        self.scrollArea_8.setWidgetResizable(True)
        self.scrollArea_8.setObjectName(_fromUtf8("scrollArea_8"))
        self.scrollAreaWidgetContents_8 = QtGui.QWidget()
        self.scrollAreaWidgetContents_8.setGeometry(QtCore.QRect(0, 0, 237, 217))
        self.scrollAreaWidgetContents_8.setObjectName(_fromUtf8("scrollAreaWidgetContents_8"))
        self.scrollArea_8.setWidget(self.scrollAreaWidgetContents_8)
        self.label_11 = QtGui.QLabel(self.custom)
        self.label_11.setGeometry(QtCore.QRect(360, 80, 111, 16))
        self.label_11.setText(QtGui.QApplication.translate("MainWindow", "Server Load Monitor", None, QtGui.QApplication.UnicodeUTF8))
        self.label_11.setObjectName(_fromUtf8("label_11"))
        self.label_14 = QtGui.QLabel(self.custom)
        self.label_14.setGeometry(QtCore.QRect(20, 340, 171, 16))
        self.label_14.setText(QtGui.QApplication.translate("MainWindow", "Incoming IP Adresses/Users", None, QtGui.QApplication.UnicodeUTF8))
        self.label_14.setObjectName(_fromUtf8("label_14"))
        self.scrollArea_11 = QtGui.QScrollArea(self.custom)
        self.scrollArea_11.setGeometry(QtCore.QRect(20, 360, 241, 111))
        self.scrollArea_11.setWidgetResizable(True)
        self.scrollArea_11.setObjectName(_fromUtf8("scrollArea_11"))
        self.scrollAreaWidgetContents_11 = QtGui.QWidget()
        self.scrollAreaWidgetContents_11.setGeometry(QtCore.QRect(0, 0, 237, 107))
        self.scrollAreaWidgetContents_11.setObjectName(_fromUtf8("scrollAreaWidgetContents_11"))
        self.scrollArea_11.setWidget(self.scrollAreaWidgetContents_11)
        self.plottab.addTab(self.custom, _fromUtf8(""))
        self.tab = QtGui.QWidget()
        self.tab.setObjectName(_fromUtf8("tab"))
        self.plottab.addTab(self.tab, _fromUtf8(""))
        self.pushButton = QtGui.QPushButton(self.centralwidget)
        self.pushButton.setGeometry(QtCore.QRect(510, 530, 75, 23))
        self.pushButton.setText(QtGui.QApplication.translate("MainWindow", "Refresh", None, QtGui.QApplication.UnicodeUTF8))
        self.pushButton.setObjectName(_fromUtf8("pushButton"))
        self.pushButton_2 = QtGui.QPushButton(self.centralwidget)
        self.pushButton_2.setGeometry(QtCore.QRect(600, 530, 75, 23))
        self.pushButton_2.setText(QtGui.QApplication.translate("MainWindow", "Exit", None, QtGui.QApplication.UnicodeUTF8))
        self.pushButton_2.setObjectName(_fromUtf8("pushButton_2"))
        self.progressBar = QtGui.QProgressBar(self.centralwidget)
        self.progressBar.setGeometry(QtCore.QRect(20, 530, 118, 23))
        self.progressBar.setProperty("value", 24)
        self.progressBar.setObjectName(_fromUtf8("progressBar"))
        self.scrollArea_3 = QtGui.QScrollArea(self.centralwidget)
        self.scrollArea_3.setGeometry(QtCore.QRect(710, 30, 191, 80))
        self.scrollArea_3.setWidgetResizable(True)
        self.scrollArea_3.setObjectName(_fromUtf8("scrollArea_3"))
        self.scrollAreaWidgetContents_3 = QtGui.QWidget()
        self.scrollAreaWidgetContents_3.setGeometry(QtCore.QRect(0, 0, 187, 76))
        self.scrollAreaWidgetContents_3.setObjectName(_fromUtf8("scrollAreaWidgetContents_3"))
        self.scrollArea_3.setWidget(self.scrollAreaWidgetContents_3)
        self.label_17 = QtGui.QLabel(self.centralwidget)
        self.label_17.setGeometry(QtCore.QRect(710, 10, 171, 16))
        self.label_17.setText(QtGui.QApplication.translate("MainWindow", "Alerts", None, QtGui.QApplication.UnicodeUTF8))
        self.label_17.setObjectName(_fromUtf8("label_17"))
        self.label_4 = QtGui.QLabel(self.centralwidget)
        self.label_4.setGeometry(QtCore.QRect(710, 130, 46, 13))
        self.label_4.setText(QtGui.QApplication.translate("MainWindow", "Plots", None, QtGui.QApplication.UnicodeUTF8))
        self.label_4.setObjectName(_fromUtf8("label_4"))
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtGui.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 929, 18))
        self.menubar.setObjectName(_fromUtf8("menubar"))
        self.menuFile = QtGui.QMenu(self.menubar)
        self.menuFile.setTitle(QtGui.QApplication.translate("MainWindow", "File", None, QtGui.QApplication.UnicodeUTF8))
        self.menuFile.setObjectName(_fromUtf8("menuFile"))
        self.menuEdit = QtGui.QMenu(self.menubar)
        self.menuEdit.setTitle(QtGui.QApplication.translate("MainWindow", "Edit", None, QtGui.QApplication.UnicodeUTF8))
        self.menuEdit.setObjectName(_fromUtf8("menuEdit"))
        self.menuAbout = QtGui.QMenu(self.menubar)
        self.menuAbout.setTitle(QtGui.QApplication.translate("MainWindow", "Help", None, QtGui.QApplication.UnicodeUTF8))
        self.menuAbout.setObjectName(_fromUtf8("menuAbout"))
        self.menuView = QtGui.QMenu(self.menubar)
        self.menuView.setTitle(QtGui.QApplication.translate("MainWindow", "View", None, QtGui.QApplication.UnicodeUTF8))
        self.menuView.setObjectName(_fromUtf8("menuView"))
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtGui.QStatusBar(MainWindow)
        self.statusbar.setObjectName(_fromUtf8("statusbar"))
        MainWindow.setStatusBar(self.statusbar)
        self.actionSave_Data = QtGui.QAction(MainWindow)
        self.actionSave_Data.setEnabled(False)
        self.actionSave_Data.setText(QtGui.QApplication.translate("MainWindow", "Save Data ", None, QtGui.QApplication.UnicodeUTF8))
        self.actionSave_Data.setShortcut(QtGui.QApplication.translate("MainWindow", "Ctrl+S", None, QtGui.QApplication.UnicodeUTF8))
        self.actionSave_Data.setObjectName(_fromUtf8("actionSave_Data"))
        self.actionPrint = QtGui.QAction(MainWindow)
        self.actionPrint.setText(QtGui.QApplication.translate("MainWindow", "Print            ", None, QtGui.QApplication.UnicodeUTF8))
        self.actionPrint.setShortcut(QtGui.QApplication.translate("MainWindow", "Ctrl+P", None, QtGui.QApplication.UnicodeUTF8))
        self.actionPrint.setObjectName(_fromUtf8("actionPrint"))
        self.actionExit = QtGui.QAction(MainWindow)
        self.actionExit.setText(QtGui.QApplication.translate("MainWindow", "Exit", None, QtGui.QApplication.UnicodeUTF8))
        self.actionExit.setObjectName(_fromUtf8("actionExit"))
        self.actionExit_2 = QtGui.QAction(MainWindow)
        self.actionExit_2.setText(QtGui.QApplication.translate("MainWindow", "Refresh", None, QtGui.QApplication.UnicodeUTF8))
        self.actionExit_2.setShortcut(QtGui.QApplication.translate("MainWindow", "Ctrl+R", None, QtGui.QApplication.UnicodeUTF8))
        self.actionExit_2.setObjectName(_fromUtf8("actionExit_2"))
        self.actionExit_3 = QtGui.QAction(MainWindow)
        self.actionExit_3.setText(QtGui.QApplication.translate("MainWindow", "Exit", None, QtGui.QApplication.UnicodeUTF8))
        self.actionExit_3.setShortcut(QtGui.QApplication.translate("MainWindow", "Ctrl+E", None, QtGui.QApplication.UnicodeUTF8))
        self.actionExit_3.setObjectName(_fromUtf8("actionExit_3"))
        self.actionCopy = QtGui.QAction(MainWindow)
        self.actionCopy.setText(QtGui.QApplication.translate("MainWindow", "Copy", None, QtGui.QApplication.UnicodeUTF8))
        self.actionCopy.setShortcut(QtGui.QApplication.translate("MainWindow", "Ctrl+C", None, QtGui.QApplication.UnicodeUTF8))
        self.actionCopy.setObjectName(_fromUtf8("actionCopy"))
        self.actionCut = QtGui.QAction(MainWindow)
        self.actionCut.setText(QtGui.QApplication.translate("MainWindow", "Cut", None, QtGui.QApplication.UnicodeUTF8))
        self.actionCut.setShortcut(QtGui.QApplication.translate("MainWindow", "Ctrl+Shift+C", None, QtGui.QApplication.UnicodeUTF8))
        self.actionCut.setObjectName(_fromUtf8("actionCut"))
        self.actionPaste = QtGui.QAction(MainWindow)
        self.actionPaste.setText(QtGui.QApplication.translate("MainWindow", "Paste", None, QtGui.QApplication.UnicodeUTF8))
        self.actionPaste.setShortcut(QtGui.QApplication.translate("MainWindow", "Ctrl+P", None, QtGui.QApplication.UnicodeUTF8))
        self.actionPaste.setObjectName(_fromUtf8("actionPaste"))
        self.actionContact_Us = QtGui.QAction(MainWindow)
        self.actionContact_Us.setText(QtGui.QApplication.translate("MainWindow", "Contact Us", None, QtGui.QApplication.UnicodeUTF8))
        self.actionContact_Us.setObjectName(_fromUtf8("actionContact_Us"))
        self.actionAbout = QtGui.QAction(MainWindow)
        self.actionAbout.setText(QtGui.QApplication.translate("MainWindow", "About", None, QtGui.QApplication.UnicodeUTF8))
        self.actionAbout.setObjectName(_fromUtf8("actionAbout"))
        self.actionDocumentation = QtGui.QAction(MainWindow)
        self.actionDocumentation.setText(QtGui.QApplication.translate("MainWindow", "Documentation", None, QtGui.QApplication.UnicodeUTF8))
        self.actionDocumentation.setObjectName(_fromUtf8("actionDocumentation"))
        self.actionPython_Interpreter = QtGui.QAction(MainWindow)
        self.actionPython_Interpreter.setText(QtGui.QApplication.translate("MainWindow", "Python Interpreter", None, QtGui.QApplication.UnicodeUTF8))
        self.actionPython_Interpreter.setObjectName(_fromUtf8("actionPython_Interpreter"))
        self.menuFile.addAction(self.actionSave_Data)
        self.menuFile.addAction(self.actionPrint)
        self.menuFile.addAction(self.actionExit_2)
        self.menuFile.addSeparator()
        self.menuFile.addAction(self.actionExit_3)
        self.menuEdit.addAction(self.actionCopy)
        self.menuEdit.addAction(self.actionCut)
        self.menuEdit.addAction(self.actionPaste)
        self.menuAbout.addAction(self.actionContact_Us)
        self.menuAbout.addSeparator()
        self.menuAbout.addAction(self.actionAbout)
        self.menuAbout.addSeparator()
        self.menuAbout.addAction(self.actionDocumentation)
        self.menuView.addAction(self.actionPython_Interpreter)
        self.menubar.addAction(self.menuFile.menuAction())
        self.menubar.addAction(self.menuEdit.menuAction())
        self.menubar.addAction(self.menuView.menuAction())
        self.menubar.addAction(self.menuAbout.menuAction())

        self.retranslateUi(MainWindow)
        self.plottab.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        self.plottab.setTabText(self.plottab.indexOf(self.juliet), QtGui.QApplication.translate("MainWindow", "Juliet", None, QtGui.QApplication.UnicodeUTF8))
        self.plottab.setTabText(self.plottab.indexOf(self.newjulietleft), QtGui.QApplication.translate("MainWindow", "Newjulietleft", None, QtGui.QApplication.UnicodeUTF8))
        self.plottab.setTabText(self.plottab.indexOf(self.custom), QtGui.QApplication.translate("MainWindow", "Custom", None, QtGui.QApplication.UnicodeUTF8))
        self.plottab.setTabText(self.plottab.indexOf(self.tab), QtGui.QApplication.translate("MainWindow", "Overall Analasys", None, QtGui.QApplication.UnicodeUTF8) 
```

)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T22:02:29.663

您不应该更改此文件。它是一个生成的文件。

您需要做的是创建一个继承自`Ui_MainWindow`.

创建一个新模块并执行以下操作：

```
import sys
from PyQt4 import QtCore, QtGui
import your_generated_module

class MyMain(QtGui.QMainWindow, your_generated_module.Ui_MainWindow):
    def __init__(self, parent=None):
        super(MyMain, self).__init__(parent)
        self.setupUi(self)  
        # example of an event - pushbutton
        self.connect(self.pushButton, 
                     QtCore.SIGNAL("clicked()"),
                     self.test_print)

    def test_print():
        print "It worked!"    

def main():
   app = QtGui.QApplication(sys.argv)
   main_window = MyMain()
   main_window.show()
   app.exec_()

if __name__ == '__main__':
   main() 
```

现在，如果您运行此代码，您将看到您的主窗口。单击按钮将打印“它工作！” 在标准输出（控制台）。

# ruby-on-rails-3 - gmaps4rails - 地图上的位置

> ID：11569564
> 
> 赞同：0
> 
> 时间：2012-07-19T21:26:06.360
> 
> 标签：ruby-on-rails-3, gmaps4rails

我想知道如何使用 gmaps4rails 从地图中获取纬度和经度信息，然后将其存储在我的数据库/模型中。

有任何想法吗？

谢谢

亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T22:29:30.907

[我在wiki上](https://github.com/apneadiving/Google-Maps-for-Rails/wiki/Javascript-goodies)写过

看看`Drop a marker and update fields attribute in a form`并获得一些灵感。

# php - 将二维数组转换为一维 PHP

> ID：11569566
> 
> 赞同：1
> 
> 时间：2012-07-19T21:26:13.537
> 
> 标签：php, arrays

我有一个数组（下面的示例），其中包含 3 个内容非常相似的数组。我想知道是否有一种简单的方法可以将所有内容放入一个数组中，而不是 3 个单独的数组。我尝试的一切似乎都只是覆盖了数据，而我只剩下第三个数组中的信息。

```
array
  0 => 
    array
      'america' => int 19
      'music' => int 6
      'states' => int 5
      'bank' => int 5
  1 => 
    array
      'america' => int 19
      'home' => int 3
      'society' => int 2
      'writers' => int 2
   2 => 
    array
      'america' => int 19
      'lutheran' => int 4
      'church' => int 4
      'national' => int 4
      'cruises' => int 3 
```

理想情况下，最终结果将如下所示：

```
array
          'america' => int 19
          'music' => int 6
          'states' => int 5
          'bank' => int 5
          'america' => int 19
          'home' => int 3
          'society' => int 2
          'writers' => int 2
          'america' => int 19
          'lutheran' => int 4
          'church' => int 4
          'national' => int 4
          'cruises' => int 3 
```

有什么解决办法吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:28:00.903

您将无法拥有具有相同键值的关联数组（即“美国”的 3 个键等）。当您尝试在数组中设置这些键时，您将简单地覆盖以前的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:37:38.840

> 我想知道是否有一种简单的方法可以将所有内容放入一个数组中

简短的回答是否定的。

您可以使用原始 int 的变量和发生次数的值创建一个类，然后让数组指向该类的对象。可以使用链表来实现相同的想法，尽管这两种方式都比你已经拥有的更复杂。

例如，键“美国”将指向一个对象，其中一个变量设置为 19，另一个变量设置为 3。

**问题：**您是否需要知道值来自哪个原始数组？如果是，那么我上面提到的将失去该属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:32:08.327

[http://php.net/manual/en/function.array-merge.php](http://php.net/manual/en/function.array-merge.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-15T20:17:15.380

```
function array_2d_to_1d($array)
                                    {
                                        $my_val=array();
                                        $my_key=array();
                                        foreach ($array as $value) {
                                             array_push($my_val, $value['cat_title']);
                                             array_push($my_key, $value['cat_id']);
                                         }

                                        $result = array_combine($my_key, $my_val);
                                        return $result;

                                    } 
```

# mongodb - 做 Mongo Indexing 时使用的磁盘空间会增加多少？

> ID：11569574
> 
> 赞同：1
> 
> 时间：2012-07-19T21:26:59.033
> 
> 标签：mongodb, indexing, diskspace

假设我有 1GB 的数据格式：{_id:ObjectId(), expiration:, value:}。可以说大约 1000000 条记录。

如果我对不存在的字段进行索引，例如“key”，（ db.mytest.ensureIndex({key:1}) ），那么一般来说，它会增加多少磁盘空间？

我在到期日做索引，会增加多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T21:06:12.910

索引的大小取决于被索引的文档数量和键大小。您应该能够通过将文档数量乘以密钥大小（Mongo 中的日期为 8 个字节）来估计到期日期索引的大致大小。但正如 Corey 指出的那样，测试是找出答案的最佳方式。

如果在不存在的字段上创建索引，则不应看到索引大小增加，因为没有任何内容可添加到 Btree。

# php - Oracle-00972：标识符太长我的 SQL 有什么问题？

> ID：11569583
> 
> 赞同：1
> 
> 时间：2012-07-19T21:27:39.810
> 
> 标签：php, sql, oracle

```
<?php

// This leaves the db connection in $conng require_once('/tms/http/html_docs/tease/csp/csp_tease.php');

    /* This a logging function. When called with:
     */

    function log_tkt_to_db($tkt_number, $date, $uid, $description, $conng)
    {
        echo "$tkt_number|$date|$uid|$description<br>";

        $sqlinsert = "insert into TEASE_TKTLOGS  VALUES ( \"$tkt_number\", \"$date\", \"$description\",  \"$uid\")";
        echo $sqlinsert . "<br>";
        $insert = OCIParse($conng, $sqlinsert);
        // OCIExecute($insert, OCI_COMMIT_ON_SUCCESS);
        OCIExecute($insert);
    }

log_tkt_to_db("00000000", "07/13/2012", "jt898u", "this a test, this is only a test", $conng);
?> 
```

我得到这个输出：

```
00000000|07/13/2012|jt898u|this a test, this is only a test
insert into TEASE_TKTLOGS (TICKET, DATE_TIME, CHANGE_DESC, ATTUID) VALUES ( "00000000", "07/13/2012", "this a test, this is only a test", "jt898u")

Warning: ociexecute() [function.ociexecute]: ORA-00972: identifier is too long in /appl/tms/http/html_docs/tease/dblog.php on line 17 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:38:13.473

这里有很多问题。

1.  最简单的答案是您需要使用单引号 ( `'`) 而不是双引号（请参阅[Oracle 数据库 SQL 参考](http://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements003.htm#i42617)中的*字符串文字*）
2.  你真的应该使用类似的东西[`oci_bind_by_name`](http://php.net/manual/en/function.oci-bind-by-name.php)而不是盲目地将你的值插入到查询中。为您节省解析和潜在的 SQL 注入。
3.  [`ociparse`](http://ee.php.net/manual/en/function.ociparse.php)自 PHP 5.4起[`ociexecute`](http://ee.php.net/manual/en/function.ociexecute.php)已弃用。而不是这些，您应该分别使用`oci_parse`和`oci_execute`。

# c# - protobuf-net 隐式合约

> ID：11569593
> 
> 赞同：5
> 
> 时间：2012-07-19T21:28:31.637
> 
> 标签：c#, serialization, protobuf-net

有没有人有一个工作示例，其中 protobuf-net 可以用作 BinaryFormatter 的替代品？这甚至可能吗？

实际上，我只需要一种消息类型的序列化程序，它看起来像

```
public class A {
  public B[] Bs { get;set; }
  public C[] Cs { get;set; }
} 
```

所有类型都在不同的程序集中定义并具有许多属性。是否有一个选项可以自动生成包含所有公共属性的原型合同，用于 A 类和其他使用的类型（B、C），比如

```
var formatter = ProtoBuf.Serializer.CreateFormatter<A>() 
```

只是工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T21:46:46.057

首先，protobuf-net 不打算，也不声称是 100% 的替代`BinaryFormatter`. 它的功能略有不同。

你愿意做一点反思吗？基本上是支持的`ImplicitFields`，但目前只能通过 获得`[ProtoContract]`，不能通过 方便地完成`RuntimeTypeModel`，这有点痛苦，并且在我的列表中。虽然，我应该指出，我认为隐式字段有点冒险，只有在你知道 DTO 内部不会改变的情况下才应该这样做！但是：要回答您的问题，您可以迭代您期望的类型，并将它们手动添加到模型中：

```
static void Main()
{
    Prepare(typeof(A), typeof(B), typeof(C));
    // if you really want to use IFormatter...
    var formatter = RuntimeTypeModel.Default.CreateFormatter(typeof (A));
    var obj = new A {Bs = new B[] {new B()}};
    using (var ms = new MemoryStream())
    {
        formatter.Serialize(ms, obj);
        ms.Position = 0;
        var clone = formatter.Deserialize(ms);
    }
}
static void Prepare(params Type[] types)
{
    if(types != null) foreach(var type in types) Prepare(type);
}
static void Prepare(Type type)
{
    if(type != null && !RuntimeTypeModel.Default.IsDefined(type))
    {
        Debug.WriteLine("Preparing: " + type.FullName);
        // note this has no defined sort, so invent one
        var props = type.GetProperties(); 
        Array.Sort(props, (x, y) => string.Compare(
            x.Name, y.Name, StringComparison.Ordinal));
        var meta = RuntimeTypeModel.Default.Add(type, false);
        int fieldNum = 1;
        for(int i = 0 ; i < props.Length ; i++)
        {
            meta.Add(fieldNum++, props[i].Name);
        }

    }
} 
```

注意`IFormatter`这里的使用是完全没有必要的；你也可以使用`RuntimeTypeModel.Default.Serialize(...)`or `Serializer.Serialize<T>(...)`。

作为脚注：我*建议*更多地定义模型......重复。例如：

```
RuntimeTypeModel.Default.Add(typeof(A)).Add("Bs", "Cs");
RuntimeTypeModel.Default.Add(typeof(B)).Add("Foo");
RuntimeTypeModel.Default.Add(typeof(C)).Add("Bar", "Blap", "Blop"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T23:04:33.677

这是我使用的 Prepare 函数的最终版本：

```
static void Prepare(params Type[] types)
        {
            foreach (var type in types)
            {
                if (type != null && !RuntimeTypeModel.Default.IsDefined(type))
                {
                    if (type.Namespace.StartsWith("System"))
                        return;

                    Debug.WriteLine("Preparing: " + type.FullName);
                    // note this has no defined sort, so invent one
                    var props = type.GetProperties();
                    Array.Sort(props, (x, y) => string.Compare(
                        x.Name, y.Name, StringComparison.Ordinal));
                    var meta = RuntimeTypeModel.Default.Add(type, false);
                    int fieldNum = 1;
                    for (int i = 0; i < props.Length; i++)
                        if (props[i].CanWrite)
                        {                            
                            meta.Add(fieldNum++, props[i].Name);

                            if (!RuntimeTypeModel.Default.IsDefined(props[i].PropertyType))
                                if (props[i].PropertyType.HasElementType)
                                    Prepare(props[i].PropertyType.GetElementType()); //T[]
                                else if (props[i].PropertyType.IsGenericType)
                                    Prepare(props[i].PropertyType.GetGenericArguments()); //List<T>
                                else
                                    Prepare(props[i].PropertyType);
                        }
                }
            }
        } 
```

如果有人感兴趣，这是我的基准测试的结果（序列化 + 反序列化）：

```
BinaryFormatter      10000 messages: 2.131s  5028 bytes/msg
Json.NET Bson        10000 messages: 1.679s  1071 bytes/msg
MetSys Bson          10000 messages: 1.581s  1035 bytes/msg
Protobuf             10000 messages: 0.145s   109 bytes/msg
MsgPack              10000 messages: 0.844s   106 bytes/msg 
```

笔记：

*   MetSys.Bson 库不能很好地处理十进制类型。
*   MsgPack 库存在只读属性问题

感谢 Marc 的帮助和这么棒的图书馆。

# java - 如何通过编程生成 KeyEvents 来模拟键盘输入（包括光标移动）

> ID：11569595
> 
> 赞同：0
> 
> 时间：2012-07-19T21:28:36.013
> 
> 标签：java, swing, cursor, jtextfield, keyevent

我试图通过以编程方式生成 KeyEvent 对象并将它们泵入事件队列来模拟键盘输入。这很好用，除了当字符被输入到 JTextField 中时，例如，光标（插入符号？）不会移动到始终位于输入值的末尾。例如，如果我们将插入符号表示为管道 | 那么这就是我得到的：

通过发送 KEY_PRESSED、KEY_TYPED、KEY_RELEASED 事件来模拟“A”按键，JTextField 值为：

|一个

也就是说，在输入 A 之后，光标/插入符号又回到了字段的开头。

如何让光标/插入符号像按下实际物理键时那样自动移动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:34:38.777

您是否尝试过在 JDK 中使用机器人类？

[http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html](http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:39:24.103

发出每个命令后，调用一个用于`setCaretPosition()`JTextField 中文本末尾的方法。如果您使用 J*Pane，这会容易得多，这样您就可以调用`getDocument()`并且您将拥有更多的控制权。

# c# - 找不到引用合同的默认端点元素：通过 Powershell cmdlet 连接到 WCF 端点

> ID：11569596
> 
> 赞同：4
> 
> 时间：2012-07-19T21:28:36.863
> 
> 标签：c#, .net, wcf, powershell, cmdlets

我创建了一个应该连接到我托管的 WCF 端点项目的类库。客户端项目定义了应与服务交互的命令行开关。

但是，我不断收到以下错误：

```
 Could not find default endpoint element that references contract Service1.MyService in the
 ServiceModel client configuration section. This might be because no configuration file was found
 for your application, or because no endpoint element matching this contract could be found in the
 client element. 
```

你知道问题可能是什么吗？

**编辑** 我拥有的是一个定义 cmdlet 的类库。我使用 .psd1 文件导入使用生成的 dll 文件的 Import-Module。

***EDIT2*** 再一次，我没有引用我的库的项目。调用定义的命令行开关的是 powershell，这些 cmdlet 应该连接到 WCF 端点

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T18:11:01.053

有这个工作：这是一个干净的解决方案：

```
internal static class ServiceClass
{

    internal static Object GetWCFSvc(string siteUrl)
    {

        Uri serviceUri = new Uri(siteUrl);
        EndpointAddress endpointAddress = new EndpointAddress(serviceUri);

        //Create the binding here
        Binding binding = BindingFactory.CreateInstance();

        ServiceClient client = new ServiceClient(binding, endpointAddress);            
        return client;
    }

}

internal static class BindingFactory
{
    internal static Binding CreateInstance()
    {
        BasicHttpBinding binding = new BasicHttpBinding();
        binding.Security.Mode = BasicHttpSecurityMode.TransportCredentialOnly;
        binding.Security.Transport.ClientCredentialType = HttpClientCredentialType.None;
        binding.UseDefaultWebProxy = true;
        return binding;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:34:22.723

在启动项目中创建带有端点的配置文件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T02:30:35.243

当您在 cmdlet 程序集中运行代码时，执行进程是 powershell.exe（在 %windir%\system32\WindowsPowershell\v1.0 或 %windir%\syswow64\WindowsPowershell\v1.0 中），因此任何 System. ServiceModel 配置需要在 powershell 配置文件 (powershell.exe.config) 中定义。

我猜这可能不是一个实用的选项，因此您可能需要手动配置服务客户端或通道工厂，而不是通过应用程序配置文件。

有关示例，请参见此处：http: [//msdn.microsoft.com/en-us/library/ms734681.aspx](http://msdn.microsoft.com/en-us/library/ms734681.aspx)

另一种选择可能是使用激活配置文件：http: [//msdn.microsoft.com/en-us/library/ff361644.aspx](http://msdn.microsoft.com/en-us/library/ff361644.aspx)

我不确定这对服务配置元素的效果如何。

# php - 从远程函数调用中获取字符串值

> ID：11569602
> 
> 赞同：2
> 
> 时间：2012-07-19T21:29:13.633
> 
> 标签：php, function, curl

我是 php 新手。我在 server1 上运行了一个 php 脚本，在服务器 2 上运行了另一个 php 脚本。为了从服务器 1 到 server2 进行远程调用，我使用 curl 函数。根据您在“ [PHP：远程函数调用并返回结果](https://stackoverflow.com/questions/7460577/php-remote-function-call-and-returning-the-result)？”上的帖子 我可以读取 server2 上的字符串。

但是，我的 server2 有一个返回字符串值的函数。现在，我需要从 server1 获取 server2 上函数的返回值。你能告诉我如何调用远程服务器上的函数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:31:28.107

如果你想像这样在 2 个独立的服务器之间传递数据，那么你需要选择一个传输层，XML 或 JSON 都很好，PHP 提供了内置解析。我个人更喜欢 JSON。

服务器 1 将使用 http 访问服务器 2... 请求数据应该在 GET 的 POST 中... 服务器 2 将通过 http 返回结果... 服务器 1 然后解析生成的 JSON 或 XML。

服务器 2 将基本上“回显”结果数据。XML 或 JSON 将有助于构建数组数据结果，并让您不必解析从服务器 2 回显的文本数据。

您显然需要添加一些安全措施以确保没有其他人可以访问服务器 2。

# .net - WPF中日历和日期选择器控件之间的区别？

> ID：11569606
> 
> 赞同：6
> 
> 时间：2012-07-19T21:29:21.417
> 
> 标签：.net, wpf, vb.net, wpf-controls

WPF中日历和日期选择器控件之间的区别？选择其中任何一个有什么标准吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T21:35:59.267

根据[DatePicker 文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.datepicker.aspx)：

> DatePicker 控件允许用户通过在文本字段中键入日期或使用下拉日历控件来选择日期。
> 
> DatePicker 控件的许多属性用于管理其内置的[Calendar](http://msdn.microsoft.com/en-us/library/system.windows.controls.calendar.aspx)，其功能与 Calendar 中的等效属性相同。[snip] 有关更多信息，请参阅[日历](http://msdn.microsoft.com/en-us/library/system.windows.controls.calendar.aspx)。

该文档中的日历链接直接指向 WPF 日历控件，因此...

据我了解，DatePicker 是一个必不可少的控件，它包含一个在用户单击下拉菜单之前不可见的日历，而日历始终可见，除非您提供额外的标记和代码来实现相同的效果。

因此，当您希望在页面上始终显示完整的日历时，您将使用日历，而当您想要更紧凑的内容时，您将使用 DatePicker。

当使用它来选择日期时，我个人总是选择 DatePicker，除非我有理由显示日历。例如，如果我正在创建一个应用程序，让我在注册过程中输入我的生日，我会使用 DatePicker。

我可能会在日程应用程序或约会日历中使用日历。这样的应用程序可能每天显示额外的数据，代表约会或安排的轮班。在这种情况下，我希望它始终可见。

但实际上，使用哪个是每个应用程序的设计决定。

# iphone - 正则表达式从字符串中获取一个数字

> ID：11569609
> 
> 赞同：1
> 
> 时间：2012-07-19T21:29:27.950
> 
> 标签：iphone, ios, regex

我想从字符串中获取一个数字。

字符串是： `"responseID: 1 is the return value";`

有时数字可能是 1、3、300、3000……

我正在尝试在目标 C 中为 iphone 执行此操作。

我试过`NSPredicate`and `NSRegularExpression`，但我似乎无法从正确的正则表达式开始。

我试过了`"*[0-9]+*"`；

当我调用正则表达式时，这是否会向我返回 "1" 、 "300" 或任何数字？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:30:43.910

`\d+`应匹配 1 个或多个数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:36:55.080

抱歉，我能够再次搜索并找到了我正在寻找的内容：请参阅： [Objective C: How to grab a number after a sub string from string](https://stackoverflow.com/questions/10291881/objective-c-how-to-grab-a-number-after-a-sub-string-from-string?rq=1)

# azure - 如何配置 Azure 缓存以使用我的自定义 IDataCacheObjectSerializer 类？

> ID：11569612
> 
> 赞同：3
> 
> 时间：2012-07-19T21:29:38.607
> 
> 标签：azure

如何在 Web 角色中配置 Azure 缓存以使用我的自定义 IDataCacheObjectSerializer 类？如果您想知道我为什么要使用自定义序列化程序：我想使用基于紧凑文本样式的 JSON(.net) 序列化与压缩相结合。在我的 .config 文件中，我可以启用压缩：

```
<dataCacheClient name="default" isCompressionEnabled="true"/> 
```

但是如何/在哪里告诉 Azure 缓存（预览版）使用我的自定义 IDataCacheObjectSerializer 类，该类使用 JSON 序列化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T16:42:46.037

Jagan Peri 有一篇[相关的博客文章](http://blogs.msdn.com/b/jagan_peri/archive/2012/08/23/custom-serializer.aspx)。

从帖子：

```
<dataCacheClients>
    <tracing sinkType="DiagnosticSink" traceLevel="Verbose" />

    <!-- This is the default config which is used for all Named Caches
    This can be overriden by specifying other dataCacheClient sections with name being the NamedCache name -->

    <dataCacheClient name="default" useLegacyProtocol="false">
        <autoDiscover isEnabled="true" identifier="WorkerRole1" />
        <!--<localCache isEnabled="true" sync="TimeoutBased" objectCount="100000" ttlValue="300" />-->
        <serializationProperties serializer="CustomSerializer" customSerializerType="Your.Fully.Qualified.Path.To.IDataCacheObjectSerializer,WorkerRole1" />
    </dataCacheClient>
</dataCacheClients> 
```

# ruby - 在 Helicon Zoo 上部署 Sinatra 模板

> ID：11569614
> 
> 赞同：1
> 
> 时间：2012-07-19T21:29:46.797
> 
> 标签：ruby, iis, sinatra

1.  [我使用Helicon Zoo](http://www.helicontech.com/zoo/)在带有 IIS 的 Windows Server 2008R2 上安装了 Ruby Hosting Package 和 Sinatra 。
2.  我使用 IIS 上的 Web 部署从[Helicon Zoo Templates](http://www.helicontech.com/zoo/templates.htm)下载并导入了 Sinatra 模板

现在导航到网站时出现此错误：

```
[tid-7800168] paths need to start with / (ArgumentError)
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:30:in `block in remap'
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:22:in `each'
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:22:in `map'
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:22:in `remap'
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/urlmap.rb:18:in `initialize'
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:142:in `new'
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:142:in `generate_map'
C:/Ruby19/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/builder.rb:128:in `to_app'
C:/Zoo/Workers/ruby/lib/app.rb:45:in `build_app'
C:/Zoo/Workers/ruby/lib/app.rb:16:in `initialize'
C:/Zoo/Workers/ruby/lib/worker.rb:4:in `new'
C:/Zoo/Workers/ruby/lib/worker.rb:4:in `initialize'
C:/Zoo/Workers/ruby/zoorack.rb:30:in `new'
C:/Zoo/Workers/ruby/zoorack.rb:30:in `<module:Zack>'
C:/Zoo/Workers/ruby/zoorack.rb:12:in `<main>' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-23T14:03:54.853

请将 Helicon Zoo 模块从 feed 升级到 1.0.0.47 版本。只需转到 Zoo -> Modules 并再次安装它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-23T13:11:05.090

尼尔，

几天前，我[在这里](https://stackoverflow.com/questions/11595286/paths-need-to-start-with-argumenterror)发布了一个类似的问题。正如您从 Yaroslav 的回复中看到的，Helicon Zoo 模块的更新版本可能会对您的情况有所帮助。我认为这与我的情况下的 IIS Express 安装有关（我无法通过 Web 平台安装程序成功安装它，必须直接从 MS 站点下载它+当我运行 ruby​​ Web 服务器时它可以工作） . 我认为我的问题不会对您有所帮助，但也许 Helicon 更新可能会帮助您？

# vbscript - VBS - csv 到文本文件

> ID：11569621
> 
> 赞同：0
> 
> 时间：2012-07-19T21:30:21.327
> 
> 标签：vbscript

我需要一个脚本来为 csv 文件中的每一行创建一个空文本文件。

我的 csv 文件有 3 列数据...

```
Along Came Polly,2003,192
American Beauty,1999,146
American Cousins,2007,286
An American Crime,2007,179 
```

我想为每一行创建一个空文本文件，并格式化为....

```
Along Came Polly (2003) Slot 192.txt
American Beauty (1999) Slot 146.txt
American Cousins (2007) Slot 286.txt
An American Crime (2007) Slot 179.txt 
```

有人可以帮我解决这个问题，因为我没有 vb 经验。

谢谢你，蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T04:40:47.797

这就是您可能正在寻找的

```
Option Explicit
Dim objFSO, objTextFile, strFileLine,objFile,strFileName

' Create the File System Object
 Set objFSO = CreateObject("Scripting.FileSystemObject")

 Set objTextFile=objFSO.OpenTextFile("C:\Documents and Settings\amolc\Desktop\SO\Sample.csv")  ''Mention Path of your CSV file here 

 Do Until objTextFile.atEndOfStream
     strFileLine =objTextFile.ReadLine
     strFileLine =Split(strFileLine,",")
     strFileName=strFileLine(0)&" ("&strFileLine(1)&") "&"Slot "&strFileLine(2)&".txt"
     Set objFile = objFSO.CreateTextFile("C:\Documents and Settings\amolc\Desktop\SO\"&strFileName)  ''Hardcoded path is the location where you can store your text file
Loop 
```

# cpu - 虚拟机的 CPU 利用率

> ID：11569622
> 
> 赞同：0
> 
> 时间：2012-07-19T21:30:23.240
> 
> 标签：cpu, virtual-machine, utilization

我有一台具有 4 个 CPU 的物理机。我想在上面安装一些虚拟机。我的工作目标是查找 CPU 利用率。但我很困惑虚拟机和物理机的 CPU 使用率是如何相关的。虚拟机的 CPU 利用率和物理机之间是否存在关系？我应该如何测量每个 VM 的 CPU 利用率？物理机的 CPU 利用率是多少？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T10:14:24.903

如果您使用任何启用 xen 的虚拟机管理程序，您可以在 Dom0（物理机）中使用 xenmon 或 xentop 来检查 VM 的利用率或性能。

您可以通过在命令行上键入 xentop（在我的情况下是 /usr/sbin/xentop）来执行此操作，这将为您提供您正在寻找的所有信息。或者，您可以在我的情况下使用 xenmon -l 命令（/usr/sbin/xenmon.py python 脚本），它显示有关您的虚拟机的所有实时信息。

# ruby-on-rails - 在 Rails 中渲染视图

> ID：11569630
> 
> 赞同：0
> 
> 时间：2012-07-19T21:30:45.130
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

很抱歉一个简单的问题，但我有点困惑试图按照 ruby​​ on rails 教程书

我在第 10 章并且很困惑，是的，我为了学习目的而欺骗了我的版本所以我有一个名为 customercustomers_controller.rb 的控制器

```
def show
    @customer = Customer.find(params[:id])
    @posts = @customer.posts
end 
```

然后我有以下文件夹 _post.html.erb

```
Welcome to a post 
```

他从显示客户文件中调用的内容遵循 /view/customer/show.html.erb

```
<% provide(:title, @customer.name) %>
<aside class="customer_show_nav">
<h1><%= @customer.name %></h1>
<%= @customer.email %>
</aside>

<div class="events">
    <%= render @posts %>
</div> 
```

但是当什么都不加载时，他的出现甚至没有欢迎来到一个帖子。我做错了什么？提前致谢。我正在关注教程[http://ruby.railstutorial.org/chapters/user-microposts#top](http://ruby.railstutorial.org/chapters/user-microposts#top) 10.22

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:34:00.213

如果`_post.html.erb`在`view/customers`

你这样做`view/customers/show.html.erb`

`<%= render 'controller_where_post_lives/post' %>`这将寻找`customers/_post.html.erb`

有时，您还需要`=`使用`<%= %>`rails 3

另外，show 用于显示一项，index 用于显示所有项目。

所以渲染你会做

```
<%= render :partial => "post", :collection => @posts %> 
```

**编辑：**

当你调用 render 时，你给它视图，这里没有对象。除非像上面那样传递一个集合。

[http://guides.rubyonrails.org/layouts_and_rendering.html](http://guides.rubyonrails.org/layouts_and_rendering.html)

此外，如果您只想渲染文本，您可以这样做`render :text => "OK"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T00:25:02.520

寻找[部分](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)解释。

# php - 为什么 suhosin.executor.allow_symlink 是一个安全问题？

> ID：11569633
> 
> 赞同：0
> 
> 时间：2012-07-19T21:31:03.313
> 
> 标签：php, security, symlink, suhosin

[如果目录之一是符号链接，](https://stackoverflow.com/questions/11560747/cant-open-file-in-php-if-one-of-directories-is-a-symlink)我遇到了这个 Can't open file in php 的问题

suhosin 文档说 suhosin.executor.allow_symlink

> 此标志在使用 open_basedir 时重新激活 symlink()，在 Suhosin >= 0.9.6 中默认禁用。在使用 open_basedir 时允许 symlink() 实际上存在安全风险。

为什么这是安全问题，如果它设置为 Off 或当我在 open_basedir 中使用根目录时会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:33:20.213

符号链接使“突破”网络服务器的 DocumentRoot 强加的伪 chroot 监狱变得微不足道。启用符号链接后，您可以指向服务器上的任何文件/目录，网络服务器将愉快地跟随符号链接，永远不知道它已离开 DocumentRoot 的范围。考虑一下如果您有以下情况会发生什么：

```
ln -s /etc/shadow /www/docroot/index.html
ln -s /etc/passwd /www/docroot/index2.html 
```

# c++ - 在接口的功能实现中

> ID：11569634
> 
> 赞同：2
> 
> 时间：2012-07-19T21:31:15.160
> 
> 标签：c++

在 Java 中，如果我有一个接口，我可以这样做：

```
blah.setOnClickListner(new OnClickListner() {
     public void clicked() { // do something }
} 
```

我可以在 C++ 中做类似的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:33:27.270

C++ 支持本地类。语法与任何类类型相同，除了成员函数和静态成员变量必须在类主体内定义，而不是稍后声明和定义（无法从封闭函数外部命名成员）。

从 C++11 开始，它们可以用作模板类型参数，这使得它们更加有用。

它看起来像：

```
void Parent::func( EventProducer* blah )
{
    struct LocalListener : OnClickListener
    {
        virtual void clicked() { ... }
    };
    struct FancyLocalListener : OnClickListener
    {
        Parent* p;
        FancyLocalListener(Parent* p) : p(p) {} // but use better variable names, please ;)
        virtual void clicked() { p->func2(); }
    };

    blah->addOnClickListener(new LocalListener());
    blah->addOnClickListener(new FancyLocalListener(this));
} 
```

（但要注意泄漏）

不过，C++ 倾向于不为此使用接口。更好的设计是为侦听器接受一个仿函数，它在 C++11 中允许使用 lambda（编译器为您创建本地类）。

# emacs - isearch/在emacs中出现可见区域

> ID：11569635
> 
> 赞同：3
> 
> 时间：2012-07-19T21:31:15.843
> 
> 标签：emacs

我对这里的术语有点不确定，但是是否有一些简单的方法可以在当前缓冲区的可见区域内进行增量搜索（或可能发生）？

最终，我想拥有类似增量[ace-jump-mode 的](http://www.emacswiki.org/emacs/AceJump)东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:45:21.277

您可以使用缓冲区缩小将正常的增量搜索限制在当前缓冲区的可见区域：

```
(defun window-search ()
  "Interactive search, limited to the visible portion of the buffer."
  (interactive)
  (save-restriction
    (narrow-to-region (window-start) (window-end))
    (isearch-forward))) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T22:08:13.693

选择感兴趣的区域并进行增量搜索。增量搜索仅限于选定区域。

# java - 执行时堆内存不足

> ID：11569637
> 
> 赞同：1
> 
> 时间：2012-07-19T21:31:24.317
> 
> 标签：java, spring, hibernate, hsqldb

上下文.xml

```
<jdbc:initialize-database data-source="dataSource" ignore-failures="ALL">
    <jdbc:script location="classpath:scrubd.sql"/>
</jdbc:initialize-database>

<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">  
    <property name="driverClassName" value="org.hsqldb.jdbc.JDBCDriver"/>
    <property name="url" value="jdbc:hsqldb:mem:mydb"/>
    <property name="username" value="sa"/>
    <property name="password" value=""/>
</bean>

<bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean"
      depends-on="dataSource"
      name="_sessFac"> 
    <property name="dataSource" ref="dataSource"/>      
    <property name="configLocation" value="hibernate.cfg.xml.incDTD"/>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.HSQLDialect</prop>
            <prop key="hibernate.hbm2ddl.auto">create</prop>
            <prop key="hibernate.show_sql">true</prop>
            <prop key="hibernate.connection.shutdown">true</prop>
        </props>
    </property>
</bean> 
```

当我在单元测试中运行我的 ant 目标时，在第一次初始化 spring 之后，我得到一个内存不足的错误。然而，当我通过简单地命名我的数据库`import.sql`并让休眠处理它来填充我的表时，我没有得到这个内存不足错误。

为什么会这样？

此外，Spring 将数据加载到数据库中所需的时间比休眠时间长约一秒钟。奖金指向任何可以解释原因的人。

StackTrace（来自蚂蚁）

```
Caused by: java.lang.OutOfMemoryError: Java heap space
at java.util.Arrays.copyOfRange(Arrays.java:2694)
at java.lang.String.<init>(String.java:234)
at java.lang.StringBuffer.toString(StringBuffer.java:561)
at org.apache.tools.ant.util.StringUtils.replace(StringUtils.java:92)
at org.apache.tools.ant.util.DOMElementWriter.encodedata(DOMElementWriter.java:501)
at org.apache.tools.ant.util.DOMElementWriter.write(DOMElementWriter.java:236)
at org.apache.tools.ant.util.DOMElementWriter.write(DOMElementWriter.java:221) 
```

导致它的 bean 必须是我的会话工厂，因为我不会称之为`<jdbc:initialize-database/>`“bean”。

我想根据堆栈跟踪说它正在将我的整个 sql 脚本读入一个字符串，因为它非常大；约 38K 行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-24T14:57:01.847

最后只是说把它搞砸，然后让休眠填充我的表格。我现在在进行单元测试时正在读取一个 20mB 的文件，而且我仍然没有遇到 hibernate 的内存不足错误，这让我认为如果你想在对它们进行单元测试之前填充你的表，不要'不要让春天来做。活到老，学到老。

# file-io - Fortran 可以直接从二进制文件中读取字节吗？

> ID：11569644
> 
> 赞同：7
> 
> 时间：2012-07-19T21:31:35.747
> 
> 标签：file-io, binary, fortran, byte, fortran90

我有一个二进制文件，我想用 Fortran 读取。问题是它不是由 Fortran 编写的，所以它没有记录长度指示符。所以通常的未格式化的 Fortran 读取将不起作用。

我有一个想法，我可能会偷偷摸摸地将文件作为格式化文件逐字节（或 4 字节乘 4 字节，实际上）读取到字符数组中，然后将字符的内容转换为整数并通过浮点数传递函数或可怕的等价语句。但这不起作用：我尝试一次读取 4 个字节，并且根据`inquire`语句的 POS 输出，读取跳过了大约 6000 个字节，并且字符数组加载了垃圾。

所以这是不行的。我忘记了这种方法中有一些细节吗？或者在 Fortran 中是否有一种完全不同且更好的方法来做到这一点？（顺便说一句，我也尝试读入一个`integer*1`数组和一个字节数组。即使这些代码可以编译，但当涉及到 read 语句时，代码崩溃了。）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-07-19T22:30:51.967

是的。

Fortran 2003 在语言中引入了流访问。在此之前，大多数处理器都支持与扩展等效的东西，可能称为“二进制”或类似的东西。

未格式化的流访问不会对文件强加任何记录结构。例如，要从对应于特定 Fortran 处理器的配套 C 处理器（如果有）中的单个 int 的文件中读取数据：

```
USE, INTRINSIC :: ISO_C_BINDING, ONLY: C_INT
INTEGER, PARAMETER :: unit = 10
CHARACTER(*), PARAMETER :: filename = 'name of your file'
INTEGER(C_INT) :: data
!***
OPEN(unit, filename, ACCESS='STREAM', FORM='UNFORMATTED')
READ (unit) data
CLOSE(unit)
PRINT "('data was ',I0)", data 
```

您可能仍然会遇到字节序和数据类型大小的问题，但这些方面与语言无关。

如果您正在写入 Fortran 2003 之前的语言标准，则可以将未格式化的直接访问读取到合适的整数变量中 - 它是 Fortran 处理器特定的，但适用于许多当前处理器。

# haskell - ++和：在haskell中有什么区别？

> ID：11569650
> 
> 赞同：4
> 
> 时间：2012-07-19T21:32:03.417
> 
> 标签：haskell, ghci

我不明白这个——

```
Prelude> "hi"++"there"
"hithere"
Prelude> "hi":"there"

<interactive>:12:6:
    Couldn't match expected type `[Char]' with actual type `Char'
    Expected type: [[Char]]
      Actual type: [Char]
    In the second argument of `(:)', namely `"there"'
    In the expression: "hi" : "there"
Prelude> 
```

为什么那也不返回“这里”？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T21:36:44.420

类型。在 GCHi 中试试这个：

```
Prelude> :t (:)
(:) :: a -> [a] -> [a]
Prelude. :t (++)
(++) :: [a] -> [a] -> [a] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-19T21:34:20.453

我现在明白了。第一个运算符必须是元素，而不是列表。

所以如果我这样做`'h':"ithere"`了，它会返回`"hithere"`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-20T00:07:17.297

运算符`:`是列表的构造函数之一。`"hello"`也是如此`'h':'e':'l':'l':'o':[]`。您可以想象列表的定义如下：（不是真正的 haskell 语法）

```
data List a = (:) a (List a) | [] 
```

`:`通过获取一个元素和一个列表来构造一个列表。这就是为什么类型是`a->[a]->[a]`.

`++`连接列表的方法是使用`:`原语定义的：

```
(++) :: [a] -> [a] -> [a]
(++) []     ys = ys
(++) (x:xs) ys = x : xs ++ ys 
```

# jquery - IE 中的经典 ASP 会话和 jQuery

> ID：11569653
> 
> 赞同：0
> 
> 时间：2012-07-19T21:32:11.603
> 
> 标签：jquery, session, asp-classic, session-state

我正在为我的项目中的用户编写一个控制面板，我有一个`DIV`元素并使用`$('.user-situation').load('userpanel.asp')`.

我有一个模式登录表单，它将数据发送到 json 中的身份验证页面：

```
$.getJSON("authenticate.asp?U=u.val()"+"&P=p.val()"+"&format=json&jsoncallback=?", function(data){

   if(data.Status == "Successful"){

       $('.user-situation').load('userpanel.asp');

   }

}); 
```

在身份验证页面中，我设置了一些会话，其中一个是`Session("ID")` 如您所见，成功登录后我在 div 中重新加载了 userpanel.asp，因为我想在那里显示用户选项。

userpanel.asp 代码是这样的（简化）

```
if Session("ID")= "" then
 Response.Write ("You must log in to using of site options")
else
 Response.Write (" some options write here ")
end if 
```

这在 FF 和 Chrome 和 Opera 中完美运行但在 IE (9) 中成功登录后刷新页面时，userpanel.asp 显示第一个条件结果！

为什么？！我的错在哪里？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:38:50.163

IE 可能正在缓存 userpanel.asp，尝试在加载调用的末尾生成并附加一个随机数查询字符串，如下所示：

```
//generate random number and assign to rnd
$('.user-situation').load('userpanel.asp?rand='+rnd+''); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:45:44.297

它可能正在缓存初始页面结果。（IE 总是试图比我们所有人都聪明……但失败了。）

我建议使用唯一编号对查询字符串进行加盐处理，该编号在页面重新加载时始终不同。尝试：

```
$('.user-situation').load('userpanel.asp?' + Math.floor(Math.random()*1701)); // 1701 is just a number I... well... Yeah, I'm a Trekkie nerd. 
```

无论如何，这会让浏览器认为你以前从未见过这个 URL，如果是缓存问题，这将解决问题。

# java - Camel Jetty 异步路由问题

> ID：11569655
> 
> 赞同：0
> 
> 时间：2012-07-19T21:32:16.560
> 
> 标签：java, apache, jetty, apache-camel

我正在尝试在 Apache Camel 中将 Jetty 延续与 AsyncProcessor 一起使用，并且不得不遇到问题。基本上，我希望 Jetty Web 请求等到多播/聚合路由完成，然后用结果填充 servletResponse。所以我的骆驼路线文件如下，

```
 <route>
        <from ref="incomingJettyEndpoint"/>
        <inOnly uri="direct:multiCastRoute"/>
                    <process ref="asyncProcessor"/> 
    </route>
            <route>
                    <!-- Aggregator -->
            </route> 
```

我在试图用来发回响应的交换标头中传递延续对象。谁能帮助我使用 asyncProcessor 以便线程在那里等待并且不完成继续？另外，我可以在返回所有多播消息后从聚合器通知 asyncProcessor 以便我可以写回结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-27T22:04:44.057

在`inOnly`您的路线上意味着它不处理响应。

只是使用`to`，比如

```
<route>
    <from ref="incomingJettyEndpoint"/>
    <to uri="direct:multiCastRoute"/>
    <process ref="asyncProcessor"/> 
</route>
<route>
    <!-- Aggregator -->
</route> 
```

# php - cakephp外键不是主键

> ID：11569658
> 
> 赞同：5
> 
> 时间：2012-07-19T21:32:31.350
> 
> 标签：php, cakephp, cakephp-model

我有一个用 cakephp 2.0 开发的网站，我想在两个表之间建立关系：

活动成分

```
1   id  int(10) UNSIGNED    No  None    AUTO_INCREMENT  
2   type_id     tinyint(2)  No  None        
3   activity_id     int(11)     No  None        
4   ingredient_id   int(10)     No  None        
5   created     datetime 
```

行动

```
1   id  int(10) UNSIGNED    No  None    AUTO_INCREMENT  
2   type_id     tinyint(2)  No  None        
3   language    char(2)     No  None        
4   text    varchar(100)        No  None        
5   created     datetime 
```

我想将这两个表与字段“type_id”相关联。我已经在这种模式下完成了我的代码：

```
 class Action extends AppModel{
    public $name = 'Action'; //non utilizzata nel sito è il nome del modello alla fine per migliorare la compatibilità

    public $belongsTo = array(
        'ActivityIngredients' => array(
            'className'     => 'ActivityIngredients',
            'conditions'    => '',
            'order'         => '',
            'foreignKey'    => 'type_id'
        )
    ); 
```

}

```
class ActivityIngredients extends AppModel{
        public $name = 'ActivityIngredients'; //non utilizzata nel sito è il nome del modello alla fine per migliorare la compatibilità

        public $belongsTo = array(
            'Activity' => array(
                'className'     => 'Activity',
                'conditions'    => '',
                'order'         => '',
                'foreignKey'    => 'activity_id'
            ),
            'Ingredient' => array(
                'className'     => 'Ingredient',
                'conditions'    => '',
                'order'         => '',
                'foreignKey'    => 'ingredient_id'
            )
        );

        public $hasMany = array(
            'Action' => array(
                'className' => 'Action',
                'conditions' => '',
                'dependent' => true,
                'foreignKey'   => 'type_id',
                'associatedKey'   => 'type_id'
            )
        );
    } 
```

它没有检索到正确的数据。似乎它需要外键的 id。这是视图：

```
<?php foreach ($user['Activity'] as $activities) {
var_dump($activities);
?>
    <div class="line-cnt"><div class="line">
    </div>
</div>
<h2>Attività</h2>
<div class="table">
    <div>
        <div>Activity created</div><div><?php echo $activities['created']; ?>
        </div>
    </div>
    <div>
        <div>Actions text</div><div><?php echo $activities['Action']['text']; ?></div>
    </div>
    <div>
        <div>ActivityIngredient ingredient_id</div><div><?php echo $activities['ActivityIngredients']['ingredient_id']; ?></div>
    </div>
</div>
<?php
}
?> 
```

控制器是一个简单的查询，查找所有并递归 3 到与表合作的用户中

```
$this->User->recursive = 3;
        $user = $this->User->read();

        if (empty($username) || $username != $user['User']['username']) {
            $this->redirect(array ('action'=>'view',$id,$user['User']['username']));
        }

        $this->set('user', $user); 
```

请帮帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T04:41:07.923

首先，如果您在“activity_ingredients”表中使用“id”字段，那么您应该将其用作另一个表中的外键。

外键是关系表中与另一个表的候选键匹配的字段。

即使您尝试在“actions”表中使用 type_id 作为外键，那么 type_id 在您的 activity_ingredients 表中也必须是唯一的，如果是这样，那么您可以将 ActivityIngredient 模型定义为：

```
class ActivityIngredients extends AppModel{
    public $primaryKey = 'type_id';
    public $name = 'ActivityIngredients'; //non utilizzata nel sito è il nome del modello alla fine per migliorare la compatibilità

    public $belongsTo = array(
        'Activity' => array(
            'className'     => 'Activity',
            'conditions'    => '',
            'order'         => '',
            'foreignKey'    => 'activity_id'
        ),
        'Ingredient' => array(
            'className'     => 'Ingredient',
            'conditions'    => '',
            'order'         => '',
            'foreignKey'    => 'ingredient_id'
        )
    );

    public $hasMany = array(
        'Action' => array(
            'className' => 'Action',
            'conditions' => '',
            'dependent' => true,
            'foreignKey'   => 'type_id',
            'associatedKey'   => 'type_id'
        )
    );
} 
```

你的行动模型将保持不变。因此，您将能够获取所需的记录。

即使您不同意将“type_id”定义为表中的外键。那么这段代码将非常适合您的情况。

```
class ActivityIngredients extends AppModel{
public $name = 'ActivityIngredients'; //non utilizzata nel sito è il nome del modello alla fine per migliorare la compatibilità

public $belongsTo = array(
    'Activity' => array(
        'className'     => 'Activity',
        'conditions'    => '',
        'order'         => '',
        'foreignKey'    => 'activity_id'
    ),
    'Ingredient' => array(
        'className'     => 'Ingredient',
        'conditions'    => '',
        'order'         => '',
        'foreignKey'    => 'ingredient_id'
    )
);

public $hasMany = array(
    'Action' => array(
        'className' => 'Action',
        'conditions' => '',
        'dependent' => true,
        'foreignKey'   => false,
        'finderQuery'   => 'select * from actions as `Action` where
                            `Action`.`type_id` = {$__cakeID__$} '
    )
); 
```

}

我相信这会给你想要的结果。请询问它是否不适合您。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-19T22:52:29.707

在 cakephp 中，您可以分配[模型的主键](http://book.cakephp.org/2.0/en/models/model-attributes.html#primarykey)。相信你也可以把classname放在外键关联中。例如

```
'foreignKey'   => 'Classname.type_id' 
```

# c - 如何包含可能存在或不存在的头文件？

> ID：11569659
> 
> 赞同：8
> 
> 时间：2012-07-19T21:32:31.093
> 
> 标签：c, gcc, include, header-files

假设我在 foo.h 中定义了 BAR。但是 foo.h 可能不存在。我如何包含它，而不会让编译器抱怨我？

```
#include "foo.h"

#ifndef BAR
#define BAR 1
#endif

int main()
{
    return BAR;
} 
```

因此，如果 BAR 在 foo.h 中定义为 2，那么如果 foo.h 存在则程序将返回 2，如果 foo.h 不存在则返回 1。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T21:43:47.870

一般来说，你需要做一些外部的事情来做到这一点 - 例如，通过做一些事情来玩弄搜索路径（如评论中所建议的那样）并提供一个空`foo.h`作为后备，或者将`#include`内部包裹一个`#ifdef HAS_FOO_H`...`#endif`和`HAS_FOO_H`由编译器开关设置（`-DHAS_FOO_H`用于 gcc/clang 等）。

如果您知道您正在使用特定的编译器，并且可移植性不是问题，请注意某些编译器确实支持将可能存在或可能不存在的文件作为扩展名包含在内。例如，参见 clang 的[`__has_include`](http://clang.llvm.org/docs/LanguageExtensions.html#__has_include)特性。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-07-19T21:40:30.143

使用像[GNU Autoconf](http://www.gnu.org/software/autoconf/)这样的工具，这就是它的设计目的。（在 Windows 上，您可能更喜欢使用[CMake](http://cmake.org/)）。

所以在你的`configure.ac`，你会有这样的一行：

```
AC_CHECK_HEADERS([foo.h]) 
```

哪个，在运行之后`configure`，会定义`HAVE_FOO_H`，你可以像这样测试：

```
#ifdef HAVE_FOO_H
#include "foo.h"
#else
#define BAR 1
#endif 
```

如果您打算走 autotools 路线（即 autoconf 和 automake，因为它们可以很好地协同工作），我建议您从这个[优秀的教程](http://www.lrde.epita.fr/~adl/autotools.html)开始。

# python - 使用 python 需求文件，您可以控制安装包依赖项的顺序吗？

> ID：11569660
> 
> 赞同：2
> 
> 时间：2012-07-19T21:32:31.730
> 
> 标签：python, scipy, pip, setup.py

通常你会希望所有的包都声明它们的依赖关系，但有时这是你无法控制的，对于大型或复杂的包来说，“fork it”并不容易。

例如，SciPi 需要 NumPy，但没有指定它。因此，对于您无法控制的软件包，有没有办法告诉 setup.py 或 pip 以特定顺序安装？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-22T04:06:20.267

**2015 年 4 月 13 日更新**：正如[@Garrett 评论](https://stackoverflow.com/questions/11569660/with-a-python-requirements-file-can-you-control-order-of-installing-package-depe/11597690?noredirect=1#comment47207400_11597690)的那样，安装顺序行为在 pip v6.1.0 中发生了变化。取自[pip v7.0.0.dev0 文档](https://github.com/pypa/pip/blob/d043e4bcce6456b73920bedf69b1a0a4942ceff8/docs/reference/pip_install.rst#installation-order)：

> 从 v6.1.0 开始，pip 在其依赖项之前安装依赖项，即按“拓扑顺序”。这是目前唯一与订单相关的承诺点。虽然 pip 将按照安装参数的顺序或需求文件中的项目的顺序安装东西可能是巧合的，但这并不是一个承诺。

* * *

**初步答案（过时）**：

使用带有`pip`. 由于 0.8.3 版本`pip`按照它们在需求文件中列出的顺序安装包。

# java - 在java中使用同步块来阻止一次访问多个方法

> ID：11569666
> 
> 赞同：0
> 
> 时间：2012-07-19T21:32:53.237
> 
> 标签：java, multithreading, synchronization

如果我有两种方法：

```
public class A {

    public void doSomething() {
        synchronized(A.class) {
            //synchronized block here
        }
    }

    public void doSomethingElse() {
        synchronized(A.class) {
           //synchronized block here
        }
    }
} 
```

所以我的问题是，这种`A.class`行为像全局锁吗？`doSomething()`意思是在另一个线程正在执行时一个线程执行方法会被阻塞`doSomethingElse()`吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:05:54.467

> A.class 像全局锁一样吗？

任何`synchronized`块都会锁定特定对象。锁定`A.class`充当`ClassLoader`您正在运行的对象的“全局”锁定，因为 Java 保证`A.class`每个加载程序中只有一个对象实例。 `A.class`是一个对象，就像`new A()`是一个对象。

锁定`A.class`与锁定静态方法相同：

```
public class A {
    public static synchronized void someStaticMethod() {
        // in here you are locked on A.class as well
    }
    public void doSomething() {
        synchronized (A.class) {
            // this block is locked on the same object as someStaticMethod()
        }
    }
} 
```

相比之下，当您锁定实例方法（与静态方法相反）时，它与锁定`A`正在执行的实例相同。换句话说`this`：

```
public class A {
    public synchronized void someInstanceMethod() {
        // in here you are locked on the instance of A (this)
    }
    public void doSomething() {
        synchronized (this) {
            // this block is locked on the same instance of A
        }
    }
} 
```

同样，它是关于所讨论的特定对象。这是[关于 locks 的 Java 文档](http://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T13:42:11.657

您的示例会将线程锁定在由同一类加载器加载的 A 类的*所有*实例中获取锁的所有方法之外，因此，如果任何一个线程获取锁，该锁会阻止所有其他线程访问该对象上的任何这些方法或该类的任何其他对象。通常设置这样的东西可能是一个坏主意。锁将不必要地粗粒度（导致线程等待，即使它们只想访问属于不存在共享的不同实例的数据）并且会过度限制并发性。如果你有一个真正需要这个的设计，你应该质疑你的设计。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:35:46.557

它获得对象锁，所有其他线程将被阻塞，直到`current thread releases the lock`。根据java规范：

> 同步方法在执行之前获取监视器（第 17.1 节）。对于类（静态）方法，使用与方法类的 Class 对象关联的监视器。对于实例方法，使用与 this（调用该方法的对象）关联的监视器

.

# google-plus - Google+：同一页面上的多个 +1，不同的内容

> ID：11569668
> 
> 赞同：2
> 
> 时间：2012-07-19T21:33:04.220
> 
> 标签：google-plus

我试图找到答案（在开发文档和这里），但没有运气。

“+1 按钮”在普通页面（只有一个 +1）上工作正常。但是我有一个包含多个实体的页面（使用 Drupal 的术语：显示多个节点的视图），我想在其中添加“共享按钮”。到目前为止，我已经添加了 Twitter 和 Facebook。Twitter 是最简单的，因为它只接受你给它的字符串。Facebook 接受一个 url，但你可以指定你自己的 url。当我尝试为 +1 指定我自己的网址时，我收到此错误：

```
Unsafe JavaScript attempt to access frame with URL http://one80.seasites.se/whats-up from frame with URL https://plusone.google.com/_/+1/hover?hl=sv&url=http%3A%2F%2Fone80.seasites.se%2Fwhats-up%2Fl%25C3%25B6rdag&t=1342724634133&source=widget&isSet=false&referer=http%3A%2F%2Fone80.seasites.se%2Fwhats-up&jsh=m%3B%2F_%2Fapps-static%2F_%2Fjs%2Fgapi%2F__features__%2Frt%3Dj%2Fver%3Dr4LFRxx-_oY.sv.%2Fsv%3D1%2Fam%3D!ZCfx2q5v6YmYvWjcTQ%2Fd%3D1%2Frs%3DAItRSTNI50TT3SY8R9klRLc_1sBJ5_Rp3g#id=I3_1342724634541&parent=http%3A%2F%2Fone80.seasites.se&rpctoken=619983104&_methods=mouseEvent%2CtrackingEvent%2ConVisibilityChanged%2C_onopen%2C_ready%2C_onclose%2CcloseOrHideThisBubble%2C_close%2C_open%2C_resizeMe%2C_renderstart. Domains, protocols and ports must match.
 rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:173
ec.a.v rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:173
xh rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:203
q.get rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:211
ec.w rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:173
Rh rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:208
q.w rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:220
Rb rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:30
Xg rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:187 
```

（匿名函数）rs=AItRSTOQ10u7fGwgD-LqzsOa-fsgdlhDCg:226

为了解释我为什么要使用单独的 URL：每个节点都类似于一个事件，每个节点都有自己的 url（包含图像和文本/信息）。因此，当您单击“喜欢”（对于 FB）时，它会获取标题、信息和图像并将其包含在帖子中（因此它显示“发生了什么事 - 聚会”，而不是通用的“发生了什么事”并且没有/相同的图像）。我想用 G+ 来做同样的事情。

有没有办法为 G+ 做到这一点？我错过了什么吗？？

我想这样做的一种方法是为每个节点使用一个 iframe，并仅使用 g+-按钮拉入一个特殊版本的“节点页面”。但这是一个非常讨厌的 hack（而且设置起来并不那么有趣）。

欢迎任何想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T20:19:59.880

您看到的错误实际上是由于 Chrome 中的问题造成的。+1 按钮应该会自动恢复。

您可以使用`href` [属性](https://developers.google.com/+/plugins/+1button/#plusonetag-parametershttps://developers.google.com/+/plugins/+1button/#plusonetag-parameters)显式指定目标页面。在实践中，您的标记将如下所示：

```
<g:plusone href="http://example.com/targeturl"></g:plusone> 
```

或者像这样使用 HTML5 语法：

```
<div class="g-plusone" data-href="http://example.com/targeturl"></div> 
```

如果这些不起作用，您可以分享一个链接到您认为它不起作用的页面吗？我可以看看:)

# c - unsigned char 的隐式转换（算术转换与赋值）

> ID：11569669
> 
> 赞同：2
> 
> 时间：2012-07-19T21:33:06.130
> 
> 标签：c, casting

在做某事并遇到类似于以下的代码：

```
#define MODULUS(a,b)        ((a) >= 0 ? (a)%(b) : (b)-(-a)%(b))

unsigned char w;
unsigned char x;
unsigned char y;
char z;

/* Code that assigns values to w,x and y.  All values assigned 
   could have been represented by a signed char. */

z = MODULUS((x - y), w); 
```

据我了解，算术`(x - y)`将在任何类型转换之前完成，并且宏将始终评估为`(a)%(b)`- 因为结果将是一个始终大于或等于零的无符号字符。但是，代码按预期运行，我认为我的理解存在缺陷。所以...

我的问题是：

1.  在计算表达式之前是否会发生到有符号字符的隐式类型转换？

2.  是否存在上述代码不起作用的情况（例如，如果无符号值足够大以至于无法用有符号值表示）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:35:09.887

> 在计算表达式之前是否会发生到有符号字符的隐式类型转换？

`int`不，在计算表达式之前会发生转换`x - y`¹。因此结果可能是否定的。

> 是否存在上述代码不起作用的情况（例如，如果无符号值足够大以至于无法用有符号值表示）？

如果`sizeof int == 1`，整数提升会将 s 提升`unsigned char`为`unsigned int`s，这可能会产生错误的结果，因为在模 by 之前，由于无符号算术，会执行`w`模 by 。`UINT_MAX + 1`

¹ 默认整数提升。

# python - 使用 Sympy 在 Python 中集成

> ID：11569670
> 
> 赞同：3
> 
> 时间：2012-07-19T21:33:10.957
> 
> 标签：python, sympy

我目前`Sympy`用来帮助我进行数学计算。现在，我正在尝试执行数值积分，但每次运行脚本时都会出现错误。这是脚本：

```
from sympy import *
cst = { 'qe':1.60217646*10**-19, 'm0':N(1.25663706*10**-6) }

d = 3.6*10**-2
l = 20.3*10**-2
n = 217.0
I = 10.2

# Circum of loops
circ = l/n;
# Radius
r = N( circ/(2*pi) )
# Flux through a ring a distance R from the ceter
def flux(rad, I, loopRad):
    distFromWire = loopRad - rad
    bPoint = cst['m0']*I/(2*pi*distFromWire)
    return ( bPoint*2*pi*rad )

# Integrate from r=0 to r=wireRad
x = Symbol('x')
ig = Symbol('ig')
ig = flux(x, I, r)
print(ig)
integrate(ig*x,x) 
```

我确信实际的物理/数学可能有问题，但现在我只想把它整合起来。这是我运行脚本时得到的输出：

```
8.05359718208634e-5*x/(-6.28318530717959*x + 0.000935483870967742)
Traceback (most recent call last):
  File "script.py", line 34, in <module>
    integrate(ig*x,x)
  File "C:\Python27\lib\site-packages\sympy\utilities\decorator.py", line 24, in threaded_func
    return func(expr, *args, **kwargs)
  File "C:\Python27\lib\site-packages\sympy\integrals\integrals.py", line 847, in integrate
    return integral.doit(deep = False)
  File "C:\Python27\lib\site-packages\sympy\integrals\integrals.py", line 364, in doit
    antideriv = self._eval_integral(function, xab[0])
  File "C:\Python27\lib\site-packages\sympy\integrals\integrals.py", line 577, in _eval_integral
    parts.append(coeff * ratint(g, x))
  File "C:\Python27\lib\site-packages\sympy\integrals\rationaltools.py", line 42, in ratint
    g, h = ratint_ratpart(p, q, x)
  File "C:\Python27\lib\site-packages\sympy\integrals\rationaltools.py", line 124, in ratint_ratpart
    H = f - A.diff()*v + A*(u.diff()*v).quo(u) - B*u
  File "C:\Python27\lib\site-packages\sympy\core\decorators.py", line 75, in __sympifyit_wrapper
    return func(a, sympify(b, strict=True))
  File "C:\Python27\lib\site-packages\sympy\polys\polytools.py", line 3360, in __mul__
    return f.mul(g)
  File "C:\Python27\lib\site-packages\sympy\polys\polytools.py", line 1295, in mul
    _, per, F, G = f._unify(g)
  File "C:\Python27\lib\site-packages\sympy\polys\polytools.py", line 377, in _unify
    F = f.rep.convert(dom)
  File "C:\Python27\lib\site-packages\sympy\polys\polyclasses.py", line 277, in convert
    return DMP(dmp_convert(f.rep, f.lev, f.dom, dom), dom, f.lev)
  File "C:\Python27\lib\site-packages\sympy\polys\densebasic.py", line 530, in dmp_convert
    return dup_convert(f, K0, K1)
  File "C:\Python27\lib\site-packages\sympy\polys\densebasic.py", line 506, in dup_convert
    return dup_strip([ K1.convert(c, K0) for c in f ])
  File "C:\Python27\lib\site-packages\sympy\polys\domains\domain.py", line 85, in convert
    raise CoercionFailed("can't convert %s of type %s to %s" % (a, K0, K1))
sympy.polys.polyerrors.CoercionFailed: can't convert DMP([1, 0], ZZ) of type ZZ[_b1] to RR
[Finished in 0.3s with exit code 1] 
```

编辑：好的，所以我取出程序正在使用的数字并将其放入 wolfram alpha 中。结果表明积分不收敛，因此出现错误。我想这只是一个数学错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T08:17:17.680

将符号库用于数值工作是一个非常糟糕的主意。只需使用 scipy/numpy。话虽如此，对于这样一个简单的积分，您可以使用 sympy。但是，您实际上应该使用 sympy 表达式，而不是将所有内容都转储到不透明的函数中。

首先，了解python中的变量是如何工作的：

```
ig = Symbol('ig')
ig = flux(x, I, r) 
```

此操作后`ig`不再是 Symbol，它只是 的返回值`flux`。

定义所有符号，然后用它们表达。积分足够简单，sympy 可以处理它。

最后，像您的情况一样简单的积分`const*x/(x-const)`应该手工完成，而不是浪费在软件上。

[编辑]：我已经干净地重写了它，但由于错误，仍然 sympy 无法正确集成。您可以在邮件列表或问题跟踪器上报告它，他们会尝试更正它。话虽如此，表达式是如此简单，以至于可以手动集成。

[编辑2]：

```
In [5]: integrate(a*x/(b*x+c), x)
Out[5]: 

  ⎛         ⎛ 2        ⎞⎞
  ⎜x   c⋅log⎝b ⋅x + b⋅c⎠⎟
a⋅⎜─ - ─────────────────⎟
  ⎜b            2       ⎟
  ⎝            b        ⎠ 
```

# mysql - 从连接表中按 MAX(date) 选择

> ID：11569671
> 
> 赞同：2
> 
> 时间：2012-07-19T21:33:11.443
> 
> 标签：mysql, sql

我正在运行这个查询。

```
SELECT 
  t1.quantity, 
  t2.transaction_date, 
  t1.product_id 
FROM 
  ezsystem_usah.invoice_line AS t1     
  INNER JOIN ezsystem_usah.invoices AS t2 
    ON t1.invoice_id = t2.id_invoices 
WHERE 
  t2.customer_id = '8000004C-1325619329' 
  AND ( product_id = '8000016F-1325198704' 
     OR product_id = '80000027-1324422404' OR ...); 
```

结果表是：

```
quantity | transaction_date | product_id
7          2012-01-04         8000016F-1325198704
8          2012-03-05         8000016F-1325198704
1          2012-01-05         11111111-1324422404
...        ...                ... 
```

我想根据特定 product_id 的 MAX(transaction_date) 选择行，以便产生如下内容：

```
quantity | transaction_date | product_id
8          2012-03-05         8000016F-1325198704
1          2012-01-05         11111111-1324422404 
```

换句话说，从joined table中，我想选择EACH product id的最新条目。

我努力了：

```
SELECT 
  t1.quantity, 
  MAX(t2.transaction_date), 
  t1.product_id 
FROM 
  ezsystem_usah.invoice_line AS t1 
  INNER JOIN ezsystem_usah.invoices AS t2 ON t1.invoice_id = t2.id_invoices 
WHERE 
  t2.customer_id = '8000004C-1325619329' 
  AND (product_id = '8000016F-1325198704' OR product_id = '80000027-1324422404' OR ...)     
GROUP BY 
 t1.product_id; 
```

但是数量不对。

我没有尝试过但我认为可能有效的另一种方法是使用`HAVING MAX(transaction_date) = ([sub query])`，但它似乎很昂贵。

最坏的情况是，我可以为每个产品一个一个地运行查询，但如果可能的话，我想避免这种情况。

谢谢，戴恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:01:50.057

这应该可以满足您的要求并且相当有效。产品在内部循环中使用 IN () 检查，因此如果您在 product_id 和 customer_id 上有索引，它应该运行得非常快。还建议对 t1.invoice_id 进行索引。

```
SELECT 
  t1.quantity, 
  transaction_date, 
  product_id 
FROM 
  ezsystem_usah.invoice_line AS t1     
  JOIN (
    SELECT t3.transaction_date, t3.product_id, t3.id_invoices 
        FROM ezsystem_usah.invoices t3
        JOIN
( SELECT MAX(transaction_date) AS max_transaction_date,
    product_id
    FROM ezsystem_usah.invoices
    WHERE product_id IN (
      '8000016F-1325198704', '80000027-1324422404'
      )
    AND customer_id = '8000004C-1325619329'
    GROUP BY product_id ) AS uniqued
    ON ( t3.transaction_date = uniqued.max_transaction_date
        AND t3.product_id = uniqued.product_id
    )
) AS t2 
ON t1.invoice_id = t2.id_invoices; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:52:56.963

Does this do the trick?

```
SELECT 
  t1.quantity, 
  transaction_date,
  product_id
FROM 
  ezsystem_usah.invoice_line AS t1 
  INNER JOIN ezsystem_usah.invoices AS t2 ON t1.invoice_id = t2.id_invoices 
WHERE 
  t2.customer_id = '8000004C-1325619329' 
  AND product_id IN ( '8000016F-1325198704', '80000027-1324422404' )   
  AND transaction_date = ( SELECT MAX( inv.transaction_date ) 
                           FROM ezsystem_usah.invoices inv 
                             INNER JOIN ezsystem_usah.invoice_line ln 
                               ON    inv.customer_id = t2.customer_id
                                 AND ln.invoice_id = inv.id_invoices 
                                 AND ln.product_id = t1.product_id
                         ) 
```

I took a guess which tables contain the fields `product_id` and `transaction_date` as it's not clear from the original query.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:08:59.117

这是一个比较简单的公式

```
with t as (<your query here>)
select t.*
from t join
     (select t.product_id, max(t.transaction_date) as maxdate
      from t
      group by t.product_id
     ) tmax
     on t.product_id = tmax.product_id and
        t.transaction_date = tmax.maxdate 
```

此解决方案只要求您使用“with”子句包含一次查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-20T14:38:19.327

您的替代方案是子查询（由其他答案提供），或以下反连接（自连接）：

```
SELECT 
  t1.quantity, 
  t2.transaction_date, 
  t1.product_id 
FROM 
  ezsystem_usah.invoice_line AS t1 
  INNER JOIN ezsystem_usah.invoices AS t2
    ON t1.invoice_id = t2.id_invoices 
  LEFT JOIN ezsystem_usah.invoices AS t3
    ON t3.transaction_date > t2.transaction_date
    AND t3.id_invoices = t2.id_invoices
WHERE 
  t2.customer_id = '8000004C-1325619329' AND
  (t1.product_id = '8000016F-1325198704' OR t1.product_id = '80000027-1324422404' OR ...) AND
  t3.id_invoices IS NULL
GROUP BY 
t1.product_id 
```

这个想法是，如果找到日期大于当前行的发票，它将排除该行。我可能没有完全正确的额外加入。我正在对主键进行一些猜测。

# android - 为 Android 选项卡操作栏重用 Fragment 和 layout.xml

> ID：11569679
> 
> 赞同：0
> 
> 时间：2012-07-19T21:33:49.273
> 
> 标签：android, android-listview, android-fragments, android-actionbar, android-tabs

我正在编写我的第一个 Android 应用程序并面临一个问题:( 我正在使用 Eclipse，该应用程序旨在从 Android 4.0.3 运行。

我在视图顶部有一个选项卡操作栏，由 4 个选项卡组成。其中三个具有相同的结构：一个带有两个单选按钮的单选组和一个列表视图。这些选项卡基于相同的数据，将用于过滤数据。radioButton 的文本取决于选项卡，并将进一步过滤数据。

最后一个选项卡具有完全不同的布局和功能。

我制作了两个片段和两个布局（一个用于前三个，一个用于最后一个选项卡）。第一个片段是管理无线电组和列表视图。我还有一个适配器来设置数据模型，具体取决于选择的选项卡和按钮。但不知何故，我就是无法让它正常工作。单选按钮的 不会刷新，并且列表仅在第一次加载活动时显示。不会抛出异常。

我的方法错了吗？

这是我的主要活动：

```
 @Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.list_main);

    appContext = getApplicationContext();

    dataholder = (P1DataHolder) getIntent().getSerializableExtra(
            "data"); //Hold all the data

    final ActionBar mainBar = getActionBar();
    mainBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    mainBar.setDisplayOptions(0, ActionBar.DISPLAY_SHOW_TITLE);

    // create the fragments with the name of parent tab
    Fragment aFragment = new ListFragment(
            MyApplication.TAB_A);
    Fragment bFragment = new ListFragment(
            MyApplication.TAB_B);
    Fragment cFragment = new ListFragment(
            MyApplication.TAB_C);
    Fragment settingFragment = new P1SettingFragment();

    // Fragment A
    ActionBar.Tab tabA = mainBar.newTab().setText(
            MyApplication.TAB_A);
    tabA.setTabListener(new TabsListener(aFragment));

    // Fragment B
    ActionBar.Tab tabB = mainBar.newTab().setText(
            MyApplication.TAB_B);
    tabB.setTabListener(new TabsListener(bFragment));

    // Fragment C
    ActionBar.Tab tabC = mainBar.newTab().setText(
            MyApplication.TAB_C);
    tabC.setTabListener(new TabsListener(cFragment));

    // Settings
    ActionBar.Tab tabSetting = mainBar.newTab().setText(
            MyApplication.TAB_SETTING);
    tabSetting.setTabListener(new TabsListener(settingFragment));

    // Adding Tabs to actionbar
    mainBar.addTab(tabA);
    mainBar.addTab(tabB);
    mainBar.addTab(tabC);
    mainBar.addTab(tabSetting);

} 
```

编辑：框架代码

```
public class ListFragment extends Fragment {

private ArrayList<Recipe> listAll;
private ArrayList<Recipe> listNotCookedYet;
private CustomListView ls;
private SectionComposerAdapter adapter;
private Activity parent;
private String tabTag; // Tab state from Parent
private View view;
private SegmentedRadioGroup segmentText;
private RadioButton rbAll;
private RadioButton rbNotCookedYet;

public ListFragment(String tabTag, ArrayList<Recipe> listAll, ArrayList<Recipe> listNTY) {
    this.tabTag = tabTag;
    this.listAll = listAll;
    this.listNotCookedYet = listNTY;
}

public String getTabTag(){
    return this.tabTag;
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    // Inflate the layout for this fragment
    view = inflater.inflate(R.layout.list_with_section, container,
            false);
    parent = getActivity();

    // get Elements
    segmentText = (SegmentedRadioGroup) view
            .findViewById(R.id.segment_text);
    rbAll = (RadioButton) view.findViewById(R.id.button_list_all);
    rbNotCookedYet = (RadioButton) view
            .findViewById(R.id.button_list_notcookedyet);

    // Set Content
    if (parent != null && parent instanceof ListMainActivity) {

        ListDataHolder holder = ((ListMainActivity) parent)
                .getDataHolder();

        adapter = new SectionComposerAdapter(parent, holder);
        adapter.getCount();
        initialize(adapter);

        System.out.println("ANZAHL ALL: " + listAll.size());
        System.out.println("ANZAHL UNCOOKED: " + listNotCookedYet.size());

        //The default text is "all (*)" and "not cooked yet (*)"
        rbAll.setText(rbAll.getText().toString()
                .replace("*", listAll.size() + ""));
        rbNotCookedYet.setText(rbNotCookedYet.getText().toString()
                .replace("*", listNotCookedYet.size() + ""));

        segmentText
                .setOnCheckedChangeListener(new OnCheckedChangeListener() {

                    @Override
                    public void onCheckedChanged(RadioGroup group,
                            int checkedId) {

                        if (rbAll.getId() == checkedId) {
                            adapter.setDataModel(tabTag, true);
                            System.out.println("CHECKED: All");

                        }

                        else if (rbNotCookedYet.getId() == checkedId) {
                            adapter.setDataModel(tabTag, false);
                            System.out.println("CHECKED: Not Yet");
                        }

                    }
                });

    }
    return view;
}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

}

private void initialize(SectionComposerAdapter adapter) {
    ls = (CustomListView) view
            .findViewById(R.id.list_services);
    ls.setPinnedHeaderView(LayoutInflater.from(parent).inflate(
            R.layout.item_composer_header, ls, false));
    ls.setAdapter(adapter);
    ls.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

            Intent intent = new Intent(view.getContext(),
                    RecipeActivity.class);
            startActivityForResult(intent, 0);

        }
    });
} 
```

ListDataHolder 已按字母顺序对数据进行分段，并将它们作为单独的 Arraylist 保存为每个选项卡和每个单选按钮选择（因此有 6 个数组列表）。

这是我的适配器：

```
public class SectionComposerAdapter extends CustomListAdapter {

private Activity activity;
private ListDataHolder dataholder;
private static LayoutInflater inflater = null;
private ImageLoader imageLoader;
private List<Pair<String, ArrayList<Recipe>>> data;

public SectionComposerAdapter(Activity a, ListDataHolder holder) {
    activity = a;
    this.dataholder = holder;
    inflater = (LayoutInflater) activity
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    imageLoader = new ImageLoader(activity.getApplicationContext());
    data = dataholder.getAllData(dataholder.getAZRecipeAll());
}

public void setDataModel(String tab, boolean all) {
    if (MyApplication.TAB_A.equals(tab)) {
        if (all) {
            data = dataholder.getAllData(dataholder.getAZRecipeAll());
        } else {
            data = dataholder.getAllData(dataholder
                    .getAZRecipeNotCookedYet());
        }
    } else if (MyApplication.TAB_B.equals(tab)) {
        if (all) {
            data = dataholder.getAllData(dataholder.getMeatRecipeAll());
        } else {
            data = dataholder.getAllData(dataholder
                    .getMeatRecipeNotCookedYet());
        }
    } else if (MyApplication.TAB_C.equals(tab)) {
        if (all) {
            data = dataholder
                    .getAllData(dataholder.getVegetarianRecipeAll());
        } else {
            data = dataholder.getAllData(dataholder
                    .getVegetarianRecipeNotCookedYet());
        }
    }

}

@Override
public int getCount() {
    int res = 0;
    for (int i = 0; i < data.size(); i++) {
        res += data.get(i).second.size();
    }
    return res;
}

@Override
public Recipe getItem(int position) {
    int c = 0;
    for (int i = 0; i < data.size(); i++) {
        if (position >= c && position < c + data.get(i).second.size()) {
            return data.get(i).second.get(position - c);
        }
        c += data.get(i).second.size();
    }
    return null;
}

@Override
public long getItemId(int position) {
    return position;
}

@Override
protected void onNextPageRequested(int page) {
}

@Override
protected void bindSectionHeader(View view, int position,
        boolean displaySectionHeader) {
    if (displaySectionHeader) {
        view.findViewById(R.id.list_section_header).setVisibility(
                View.VISIBLE);
        TextView lSectionTitle = (TextView) view
                .findViewById(R.id.list_section_header);
        lSectionTitle
                .setText(getSections()[getSectionForPosition(position)]);
    } else {
        TextView lSectionTitle = (TextView) view
                .findViewById(R.id.list_section_header);
        lSectionTitle
                .setText(getSections()[getSectionForPosition(position)]);
        view.findViewById(R.id.list_section_header)
                .setVisibility(View.GONE);
    }
}

@Override
public View getAmazingView(int position, View convertView, ViewGroup parent) {
    View vi = convertView;
    if (vi == null)
        vi = inflater.inflate(R.layout.list_row, null);

    TextView recipename = (TextView) vi.findViewById(R.id.recipe_name);
    TextView recipevip = (TextView) vi.findViewById(R.id.recipe_fav_mark);
    ImageView thumb_image = (ImageView) vi.findViewById(R.id.list_image);

    Recipe recipe = new Recipe();
    recipe = getItem(position);

    // Setting all values in listview
    recipename.setText(recipe.getTitle);
    recipevip.setText(recipe.isFav() ? "FAV" : "");
    imageLoader.DisplayImage(recipe.getImage_thumbnail(), thumb_image);

    return vi;
}

@Override
public void configurePinnedHeader(View header, int position, int alpha) {
    TextView lSectionHeader = (TextView) header;
    lSectionHeader.setText(getSections()[getSectionForPosition(position)]);
    // lSectionHeader.setBackgroundColor(alpha << 24 | (0xbbffbb));
    // lSectionHeader.setTextColor(alpha << 24 | (0x000000));
}

@Override
public int getPositionForSection(int section) {
    if (section < 0)
        section = 0;
    if (section >= data.size())
        section = data.size() - 1;
    int c = 0;
    for (int i = 0; i < data.size(); i++) {
        if (section == i) {
            return c;
        }
        c += data.get(i).second.size();
    }
    return 0;
}

@Override
public int getSectionForPosition(int position) {
    int c = 0;
    for (int i = 0; i < data.size(); i++) {
        if (position >= c && position < c + data.get(i).second.size()) {
            return i;
        }
        c += data.get(i).second.size();
    }
    return -1;
}

@Override
public String[] getSections() {
    String[] res = new String[data.size()];
    for (int i = 0; i < data.size(); i++) {
        res[i] = data.get(i).first;
    }
    return res;
} 
```

该列表在没有选项卡和单选按钮的情况下工作正常。监听器也工作正常，我在日志中看到选项卡和单选按钮的变化。我只是无法让他们正确地一起工作。

提前谢谢你，我希望得到一些提示；）

戴安娜

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T17:04:47.570

呃...多么尴尬，我花了两天时间在代码中寻找问题，而答案却如此简单。我有从其他选项卡的 url 返回的空数据。

对不起！

# twitter-bootstrap - Twitter Bootstrap：在响应式设计中折叠手风琴 div

> ID：11569682
> 
> 赞同：1
> 
> 时间：2012-07-19T21:33:57.120
> 
> 标签：twitter-bootstrap, accordion

我有一个响应式布局，我想让一个 div 在移动浏览器上自动折叠，而不是在平板电脑或台式机上，（即当屏幕小于 480 像素时，div 将折叠成一个可以切换到打开的栏单击时。）
我无法使其正常工作（类似于导航崩溃）。
有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T19:25:52.610

也许[响应式导航栏](http://twitter.github.com/bootstrap/components.html#navbar)技术的某些变体可能对您有用。

# java - Java 中的 Project Euler #19（减 1）

> ID：11569685
> 
> 赞同：1
> 
> 时间：2012-07-19T21:34:17.863
> 
> 标签：java, calendar

您将获得以下信息，但您可能更愿意自己做一些研究。

1900 年 1 月 1 日是星期一。三十天有九月、四月、六月和十一月。其余的都有三十一个，仅保存二月，它有二十八，风雨无阻。在闰年，二十九。闰年出现在任何能被 4 整除的年份，但不会出现在一个世纪，除非它能被 400 整除。在 20 世纪（1901 年 1 月 1 日至 2000 年 12 月 31 日）有多少个星期日是一个月的第一天？

我一直得到 172，答案是 171。我不确定可能是什么问题，我已经尝试了所有方法，但我一直得到 172。感谢您的帮助。

```
public static void main(String args[]){
    int year=1901;
    boolean isLeapYear=false;
    int totalSundays=0;
    int currentDay=1;//Starts on a Monday
    while(year<=2000){
        isLeapYear=false;
        if((year%4)==0){
            if((year%100)==0 && (year%400)==0){
                isLeapYear=true;
            } else if((year%100)==0 && (year%400)!=0){
                isLeapYear=false;
            } else {
                isLeapYear=true;
            }
        }
        System.out.println("The Year Is: "+year);
        System.out.println("*******************************");
        for(int month=1;month<=12;month++){
            System.out.println("The Month is: "+month+" currentDay is :  "+currentDay);
            if(currentDay==7){
                totalSundays++;
            }
            if(month==1 || month==3 || month==5 || month==7 || month==8 || month==10 || month==12){
            //January,March,May,July,August,October,December
                currentDay+=3;
            } else if(month==4 || month==6 || month==9 || month==11){ 
            //April,June,September,November
                currentDay+=2;              
            } else if(month==2 && isLeapYear){
            //February has 29 days in a Leap Year
                currentDay+=1;
            } 

            if(currentDay>7){
                currentDay=currentDay-7;
            }
            System.out.println("Updated Current Day Is :  "+currentDay);
        }
        System.out.println("*******************************");
        year++;
    }
    System.out.println("The total number of Sundays that fell in the first of the month is: "+totalSundays);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-19T21:38:42.297

你从错误的一天开始。1901 年 1 月 1 日实际上是星期二（所以`currentDay = 2`。）进行更改会导致 171：http: [//ideone.com/mh4MJ](http://ideone.com/mh4MJ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-14T22:34:26.647

如果不使用日历，它将是：

```
static int getDays(int month, int year){
    switch (month){
    case 4:case 6: case 9: case 11:
        return 30;
    case 2:
        return (isLeapYear(year))?29:28;
    }
    return 31;
}

static boolean isLeapYear(int year){
    boolean leap = false;
    if(year%4==0){
        if(year%100==0){
            leap = (year%400==0)?true:false;
        }
        else{
            leap = true;
        }
    }
    return leap;
}

static int q19(){
    int year = 1901;
    // Sun:1 Mon: 2 ...
    int firstDay = 3; // 1 Jan 1901 was Tuesday 
    int sundays = 0;
    for(int i=year;i<2001;i++){
        int days_In_Month = getDays(1,i);
        int dif = days_In_Month%7;
        if(i!=year)
            firstDay = (dif+firstDay)%7;
        if(firstDay == 1) sundays++;
        for(int m = 2;m<=12;m++){
            firstDay = (dif+firstDay)%7;
            if(firstDay == 1) sundays++;
            days_In_Month = getDays(m,i);
            dif = days_In_Month%7;
        }
    }
    return sundays;
} 
```

# soap - Apache CXF 验证错误

> ID：11569696
> 
> 赞同：0
> 
> 时间：2012-07-19T21:35:16.607
> 
> 标签：soap, cxf

我正在将 apache cxf 用于肥皂客户端。当我对服务器进行肥皂调用时，我`SoapFaultException`从库中得到一个验证错误，并且没有进一步的信息。有没有人知道它可能是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T22:27:53.773

我想到了。问题是服务器在无效的请求格式上出错并抛出了一个验证错误，我认为这包含在肥皂错误中。必须放入登录拦截器才能做到这一点。

谢谢。

# php - Windows 上的用于 PHP 的 SublimeText 2 CodeIntel？

> ID：11569702
> 
> 赞同：1
> 
> 时间：2012-07-19T21:35:56.307
> 
> 标签：php, sublimetext, sublimetext2, code-intelligence

刚刚在我的 Windows 7 x64 PC 上通过 PackageControll 插件安装了[SublimeCodeIntel](https://github.com/Kronuz/SublimeCodeIntel)以获得最新的（v 2.0.1）SublimeText 2，当我尝试自动完成简单类方法'foo'时没有效果：

```
<?php
    class Foo {
        public function foo($a) { echo $a; }
    }
    $f = new Foo();
    $f->
?> 
```

有什么建议么？PS 另外 .codeintel 目录不包含任何日志文件，是的，我在插件安装后重新启动了 SublimeText 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T06:27:38.940

这个问题似乎已经解决了。

手动下载最新版本的 SublimeCodeIntel 为我解决了这个问题。我基本上从 Sublime\Data\Packages 目录中删除了“SublimeCodeIntel”文件夹，并将整个 repo 直接从 github 克隆到该文件夹​​中，并按预期工作！:)

[https://github.com/Kronuz/SublimeCodeIntel](https://github.com/Kronuz/SublimeCodeIntel)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T13:44:13.890

是的，Sublime 2.0.1 有问题 你需要等待 CodeIntel 更新

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T19:23:00.480

下面是 CodeIntel 为我为 PHP 工作的原因：

1.  删除 .codeintel/db/php 下的所有文件（对于 Windows 7，它位于 C:\Users\[name]\.codeintel\db\php）
2.  重新启动崇高文本 2

# vb.net - 将纬度/经度 GPS 坐标转换为 EXIF 有理字节数组

> ID：11569704
> 
> 赞同：0
> 
> 时间：2012-07-19T21:36:03.690
> 
> 标签：vb.net, gps, jpeg, exif, exifworks

我在将 GPS 坐标转换为可以存储为 EXIF 信息的字节数组时遇到问题。

[这个问题](https://stackoverflow.com/questions/5280479/how-to-save-gps-coordinates-in-exif-data-on-android)指出 EXIF 坐标应表示为三个有理数：`degrees/1, minutes/1, seconds/1`. 我没有问题将十进制坐标转换为那个。例如`42.1234567`很容易转换为`42/1, 7/1, 24/1`.

我的问题是，当我将其写入图像 EXIF 信息时，我不明白如何将其表示为字节数组。我正在使用的库称为[ExifWorks](http://www.codeproject.com/Articles/4956/The-ExifWorks-class)，我在 VB.NET 中使用它。

ExifWorks`setProperty`方法需要三件事：EXIF 字段 ID、作为数据的字节数组和数据类型。这是我如何使用它：

```
ew.SetProperty(TagNames.GpsLatitude, byteArrayHere, ExifWorks.ExifDataTypes.UnsignedRational) 
```

我也试过：

```
ew.SetPropertyString(TagNames.GpsLatitude, "42/1, 7/1, 24/1") 
```

这也行不通。

所以，我的问题是，如何将度-分-秒坐标转换为字节数组？到目前为止，我尝试过的所有内容都以无效的 EXIF 信息告终，并且不起作用。一个通用的解决方案很好......不一定必须在 VB.net 中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:34:08.733

我已经想通了。这是解决方案：

```
Private Shared Function intToByteArray(ByVal int As Int32) As Byte()
    ' a necessary wrapper because of the cast to Int32
    Return BitConverter.GetBytes(int)
End Function

Private Shared Function doubleCoordinateToRationalByteArray(ByVal doubleVal As Double) As Byte()
    Dim temp As Double

    temp = Math.Abs(doubleVal)
    Dim degrees = Math.Truncate(temp)

    temp = (temp - degrees) * 60
    Dim minutes = Math.Truncate(temp)

    temp = (temp - minutes) * 60
    Dim seconds = Math.Truncate(temp)

    Dim result(24) As Byte
    Array.Copy(intToByteArray(degrees), 0, result, 0, 4)
    Array.Copy(intToByteArray(1), 0, result, 4, 4)
    Array.Copy(intToByteArray(minutes), 0, result, 8, 4)
    Array.Copy(intToByteArray(1), 0, result, 12, 4)
    Array.Copy(intToByteArray(seconds), 0, result, 16, 4)
    Array.Copy(intToByteArray(1), 0, result, 20, 4)

    Return result
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T05:00:10.840

你会得到更好的精度（到 0.001 弧秒，这是一英寸）

```
 Dim milliseconds = Math.Truncate(temp* 1000.0)

     ...

     Array.Copy(intToByteArray(milliseconds), 0, result, 16, 4)
     Array.Copy(intToByteArray(1000), 0, result, 20, 4) 
```

# c++ - 提取两个词之间的域

> ID：11569709
> 
> 赞同：1
> 
> 时间：2012-07-19T21:36:36.840
> 
> 标签：c++, regex, linux, unix, gcc

我在日志文件中有一些这样的行：

11-test.domain1.com 记录...

37-user1.users.domain2.org 记录...

48-me.server.domain3.net 记录...

**如何在没有子域的情况下提取每个域？介于 "-" 和 "Logged" 之间的东西**。

我在 c++ (linux) 中有以下代码，但它不能很好地提取。如果您当然有一些示例，则返回提取字符串的某些函数会很棒。

```
 regex_t    preg;
       regmatch_t mtch[1];
       size_t     rm, nmatch;
       char tempstr[1024] = "";
       int start;
       rm=regcomp(&preg, "-[^<]+Logged", REG_EXTENDED);
       nmatch = 1;
       while(regexec(&preg, buffer+start, nmatch, mtch, 0)==0) /* Found a match */
               {
                 strncpy(host, buffer+start+mtch[0].rm_so+3, mtch[0].rm_eo-mtch[0].rm_so-7);
                 printf("%s\n", tempstr);
                 start +=mtch[0].rm_eo;
                 memset(host, '\0', strlen(host));
               }
       regfree(&preg); 
```

谢谢！

PS 不，我不能为此使用 perl，因为这部分位于由其他人制作的更大的 c 程序中。

编辑：

我用这个替换代码：

```
 const char *p1 = strstr(buffer, "-")+1;
   const char *p2 = strstr(p1, " Logged");
   size_t len = p2-p1;
   char *res = (char*)malloc(sizeof(char)*(len+1));
   strncpy(res, p1, len);
   res[len] = '\0'; 
```

这可以很好地提取整个域，包括子域。如何从 abc.def.domain.com 中仅提取 domain.com 或 domain.net ？

strtok 是一个不错的选择，我如何计算最后一个点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:50:51.443

```
#include <vector>
#include <string>
#include <boost/regex.hpp>

int main()
{
    boost::regex re(".+-(?<domain>.+)\\s*Logged");
    std::string examples[] = 
    {
        "11-test.domain1.com Logged ...",
        "37-user1.users.domain2.org Logged ..."
    };
    std::vector<std::string> vec(examples, examples + sizeof(examples) / sizeof(*examples));
    std::for_each(vec.begin(), vec.end(), [&re](const std::string& s)
    {
        boost::smatch match;
        if (boost::regex_search(s, match, re))
        {
            std::cout << match["domain"] << std::endl;
        }
    });
} 
```

[http://liveworkspace.org/code/1983494e6e9e884b7e539690ebf98eb5](http://liveworkspace.org/code/1983494e6e9e884b7e539690ebf98eb5) something like this with boost::regex. Don't know about pcre.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:43:04.437

Is the in a standard format? it appears so, is there a split function?

**Edit:** Here is some logic. Iterate through each domain to be parsed Find a function to locate the index of the first string "-" Next find the index of the second string minus the first string "Logged" Now you have the full domain.

Once you have the full domain "Split" the domain into your object of choice (I used an array) now that you have the array broken apart locate the index of the value you wish to reassemble (concatenate) to capture only the domain.

**NOTE** Written in C#

Main method which defines the first value and the second value

```
`static void Main(string[] args)
        {
            string firstValue ="-";
            string secondValue = "Logged";
            List domains = new List { "11-test.domain1.com Logged", "37-user1.users.domain2.org Logged","48-me.server.domain3.net Logged"};
            foreach (string dns in domains)
            {
                Debug.WriteLine(Utility.GetStringBetweenFirstAndSecond(dns, firstValue, secondValue));
            }
        }
`
```

Method to parse the string:

```
`public string GetStringBetweenFirstAndSecond(string str, string firstStringToFind, string secondStringToFind)
        {
            string domain = string.Empty;

            if(string.IsNullOrEmpty(str))
            {
                //throw an exception, return gracefully, whatever you determine
            }
            else
            {
                //This can all be done in one line, but I broke it apart so it can be better understood.
                //returns the first occurrance.
                //int start = str.IndexOf(firstStringToFind) + 1;

                //int end = str.IndexOf(secondStringToFind);

                //domain = str.Substring(start, end - start);

                //i.e. Definitely not quite as legible, but doesn't create object unnecessarily
                domain = str.Substring((str.IndexOf(firstStringToFind) + 1), str.IndexOf(secondStringToFind) - (str.IndexOf(firstStringToFind) + 1));

                string[] dArray = domain.Split('.');

                if (dArray.Length > 0)
                {
                    if (dArray.Length > 2)
                    {
                        domain = string.Format("{0}.{1}", dArray[dArray.Length - 2], dArray[dArray.Length - 1]);
                    }
                }
            }

            return domain;
        }
`
```

# batch-file - 如何解决批处理编程代码中的这个错误？

> ID：11569711
> 
> 赞同：0
> 
> 时间：2012-07-19T21:36:43.777
> 
> 标签：batch-file

我正在尝试制作字符串的子字符串并在 cmd 中打印但无法做到。

```
set p=mnopq
for /L %a in (1,1,5) Do (
   set q=%p:~%%a%,1
   echo %q%
) 
```

但它给出了错误请帮我解决这个问题。提前谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T06:09:11.397

这将需要*延迟扩展*功能`SETLOCAL`（请参阅`cmd /?`使用帮助）。它不能按预期工作的原因是因为命令后面的`for`命令被视为参数，所以`%`除了用于`for`命令的变量之外，任何基于变量都将立即展开。

这是更正的批处理命令。

```
@echo off
setlocal enabledelayedexpansion
set p=mnopq
for /L %%a in (1,1,5) Do (
  set q=!p:~%%a,1!
  echo !q!
) 
```

# php - silex 将表单数据传递到另一个页面？

> ID：11569719
> 
> 赞同：0
> 
> 时间：2012-07-19T21:37:23.970
> 
> 标签：php, symfony, silex

我对silex和symfony真的很陌生。这是我第一次涉足silex。我有一些代码在我的 app.php 文件中创建了我的表单，这些代码通过一些黑客攻击以及从文档中复制和粘贴。

现在我如何将这些数据传递到另一个页面？

我想创建一个只转储 post/get 数组的页面，让我了解如何传递 get/post 变量。

这是我的应用程序文件的一部分：

```
<?php
/** /src/app.php */
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\Response;

    /**
     * Register new application
     */
    $app = new Application();
    // skip to the form part ...
        $app->match('/', function (Request $request) use ($app) {
            // some default data for when the form is displayed the first time
            $data = array(
                'name' => 'Your name',
                'email' => 'Your email',
            );

            $form = $app['form.factory']->createBuilder('form', $data)
                ->add('name')
                ->add('email')
                ->add('gender', 'choice', array(
                    'choices' => array(1 => 'male', 2 => 'female'),
                    'expanded' => true,
                ))
                ->getForm();

            if ('POST' == $request->getMethod()) {
                $form->bindRequest($request);

                if ($form->isValid()) {
                    $data = $form->getData();

                    // do something with the data

                    // redirect somewhere
                    return $app->redirect('completed');
                }
            }

            // display the form
            return $app['twig']->render('index.html', array('form' => $form->createView()));
        }); 
```

然后我会创建一个这样的页面吗？

```
<?php  // app.php  
    $app->match('complete') use function ($app) {
          // sorry psuedocode
         foreach ($REQUEST as $key=> $var) {
         echo "$key: $var";
         }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T07:51:59.243

您可以尝试使用前锋。[http://silex.sensiolabs.org/doc/usage.html#fowards](http://silex.sensiolabs.org/doc/usage.html#fowards)

```
// where params is the values from your POST
$subRequest = Request::create('/otherpage', 'GET', $params);

return $app->handle($subRequest, HttpKernelInterface::SUB_REQUEST); 
```

# javascript - Chrome 扩展：不安全的 JavaScript 尝试使用 URL 访问框架 域、协议和端口必须匹配

> ID：11569723
> 
> 赞同：2
> 
> 时间：2012-07-19T21:37:43.377
> 
> 标签：javascript, google-chrome-extension, gmail

此答案指定了如何访问 gmail.com [https://stackoverflow.com/a/9439525/222236上所有 iframe 的内容](https://stackoverflow.com/a/9439525/222236)

但是在 mail.google.com 上它会抛出这个错误：

```
Unsafe JavaScript attempt to access frame with URL https://plus.google.com/u/0/_/... from frame with URL https://mail.google.com/mail/u/0/#inbox. Domains, protocols and ports must match. 
```

我尝试添加`*://plus.google.com/*`到扩展清单的匹配项，但没有帮助。

更新：在访问内容之前检查 url 有效，但目前我的逻辑非常粗略，因为它只检查 google plus：

```
 if(-1==iframes[i].src.indexOf('plus.google.com')) {
            contentDocument = iframes[i].contentDocument;
            if (contentDocument && !contentDocument.rweventsadded73212312) {
                // add poller to the new iframe
                checkForNewIframe(iframes[i].contentDocument);
            }
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T09:12:44.803

由于[同源策略](https://developer.mozilla.org/En/Same_origin_policy_for_JavaScript)，访问被阻止。
避免错误的正确方法是排除来自不同来源的帧。你的逻辑确实很粗糙。它不专门查看主机名，也不考虑其他域。
反转逻辑以获得稳健的解决方案：

```
if (iframes[i].src.indexOf(location.protocol + '//' + location.host) == 0 ||
    iframes[i].src.indexOf('about:blank') == 0 || iframes[i].src == '') { 
```

此*白名单*的解释：

*   `protocol://host/`= `https://mail.google.com`。
    显然，必须允许当前主机
*   `about:blank`和一个空字符串
    这些框架由 GMail 动态创建和编写脚本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:03:34.427

`mail.google.com`并且`plus.google.com`不是同一个域。现代 Web 浏览器中的 JavaScript 实现不允许跨域脚本。

在不诉诸各种骇客的情况下，解决此问题的正确方法是通过 CORS ( [http://en.wikipedia.org/wiki/Cross-origin_resource_sharing](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing) )，在这种情况下您无法使用它。

# jquery - jQuery-UI 升级在以前工作的代码中引入了错误

> ID：11569734
> 
> 赞同：0
> 
> 时间：2012-07-19T21:38:36.430
> 
> 标签：jquery, jquery-ui

我有一个用于拖放的简单 jQuery 例程，我最近从 1.7.2 升级到 1.8.21，现在当我删除项目时，我收到错误消息“未捕获的类型错误：无法调用未定义的方法“搜索”

通过搜索找不到任何东西，所以我希望有人以前见过这个。

这是代码：

```
$("#frame").droppable({
    drop: function(ev, ui) {
        if (ui.helper.attr('id').search(/drag[0-9]/) != -1){
            counter++;
            var element=$(ui.draggable).clone();
            element.addClass("tempclass");
            $(this).append(element);
            $(".tempclass").attr("id","sig_"+counter);
            //$(this).css('z-index', 100+counter);
            $("#sig_"+counter).removeClass("tempclass");
            var x = event.pageX - $(this).offset().left + 4;
            var y = event.pageY - $(this).offset().top + 4;
            $(this).find("input").val(x+","+y);
            $("div#stop").text("STOP: \nLeft: "+ x + "\nTop: " + y);
            //Get the dynamically item id
            draggedNumber = ui.helper.attr('id').search(/drag([0-9])/)
            itemDragged = "dragged" + RegExp.$1
            //console.log(itemDragged)

            $("#sig_"+counter).addClass(itemDragged);
        }
    }
}); 
```

jQuery 版本：1.7.2 jQuery-UI 版本：1.8.21 浏览器：Chrome 20.0.1132

更新：我似乎找到了一些“有效”的东西，但我觉得它不合适，因为我正在使用一个预先存在的项目。（我尝试复制，但没有用。）我更改了两行，都包含相同的失败代码：

```
ui.helper.attr('id') 
```

至

```
ui.draggable.attr('id') 
```

我想这只会在我的特定情况下有效，并且可能也应该包含“可拖动”块，但它目前有效。

# linux-kernel - 使用 Qemu 进行内核仿真

> ID：11569741
> 
> 赞同：1
> 
> 时间：2012-07-19T21:39:20.733
> 
> 标签：linux-kernel, virtualization, qemu, busybox

我实际上是在尝试使用 Qemu 和 busybox 来模拟​​ linux 内核。到目前为止，我制作了这个内核映像： [http](http://depositfiles.com/files/l9x9veg09) ://depositfiles.com/files/l9x9veg09 并使用这些参数启动了 Qemu：qemu-system-x86_64 -m 256 -s -hda rootfs.img -kernel linux-2.6.34.12/arch /x86/boot/bzImage -append "root=/dev/sda \ init=/bin/sh" 但是一旦内核启动，我会收到一条消息：内核恐慌。没有找到初始化。尝试将 init= 选项传递给内核......我虽然在参数中添加“init=/bin/sh”可以解决问题，但它没有。我是这个领域的初学者。有人可以帮我弄这个吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-20T03:46:44.557

使用 Busybox 时，您希望将 -initrd initramfs 而不是 init=/bin/sh 传递给 qemu。试试这个

```
qemu-system-x86_64 -m 256 -s -hda rootfs.img -kernel linux-2.6.34.12/arch/x86/boot/bzImage -initrd initramfs -append "root=/dev/sda" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T10:08:33.487

我终于通过使用静态链接的busybox的预构建版本（在网站上找到）使它工作。旧版本是动态链接的，将其编译为静态可执行文件真的很痛苦（glibc 似乎不再支持静态链接）。

# javascript - 将 rel="lightbox" 添加到其中包含 .jpg 和 .gif 的链接

> ID：11569744
> 
> 赞同：2
> 
> 时间：2012-07-19T21:39:32.623
> 
> 标签：javascript, jquery, attributes, add

我正在尝试制作一个简单的脚本，将 rel="lightbox" 添加到 href 中带有 .jpg 或 .gif 的链接中。有人能帮我吗？我看不到错误。谢谢你。

```
<script type="text/javascript">

       $('a[href*=".jpg"]').each(function() {
          $('a[href*=".gif"]').each(function() {
              $(this).attr('rel','lightbox'); 
          });
       });

</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:42:34.650

您正在定位具有包含“.jpg”和“.gif”的 href 属性的链接。尝试使用以“.jpg”或“.gif”结尾的 href 属性定位链接：

```
<script type="text/javascript">
       $('a[href$=".jpg"], a[href$=".gif"]').each(function() {
          $(this).attr('rel','lightbox'); 
       });
</script> 
```

*更新* 要在 DOM 准备好时运行脚本，请将函数附加到 domready 事件：

```
<script type="text/javascript">
$(document).ready(function() {
       $('a[href$=".jpg"], a[href$=".gif"]').each(function() {
          $(this).attr('rel','lightbox'); 
       });
});
</script> 
```

# php - 发送纯文本电子邮件

> ID：11569745
> 
> 赞同：1
> 
> 时间：2012-07-19T21:39:38.067
> 
> 标签：php, swiftmailer

我正在尝试将纯文本电子邮件发送给将为我处理它们的公司。我正在使用 Swift Mailer 库，据我所知 - 我没有问题。但是我向其发送消息的公司表示，他们将所有数据都放在一行中。当我使用这个脚本给自己发送一封电子邮件时，它看起来很完美——每条数据都在单独的一行上。

这是我正在使用的脚本。这很简单。

```
<?php   
$to="";

$bcc="";

$subject = "Quote" ;

$domain = $_SERVER['HTTP_HOST'];

    //Message
$message = "Domestic Quote Request\n";
$message .= "Full Name: $_POST[name]\n";
$message .= "Email: $_POST[email]\n";
$message .= "Phone: $_POST[phone]\n";
$message .= "Pickup Date: $_POST[shipdate]\n";
$message .= "Pickup City or Zip: $_POST[pickupzip]\n";
$message .= "Drop Off City or Zip: $_POST[dropoffzip]\n";
$message .= "Year: $_POST[vehicleyear]\n";
$message .= "Make: $_POST[vehiclemake]\n";
$message .= "Model: $_POST[vehiclemodel]\n";
$message .= "Carrier Type: $_POST[carriertype]\n";
$message .= "This Quote is from $domain";

require_once 'lib/swift_required.php';

// Create the Transport
// Mail
$transport = Swift_MailTransport::newInstance();

// Create the Mailer using your created Transport
$mailer = Swift_Mailer::newInstance($transport);

// Create the message
$the_message = Swift_Message::newInstance()

// Give the message a subject
->setSubject($subject)

// Set the From address with an associative array
->setFrom($_POST['email'])

// Set the To addresses with an associative array
->setTo(array($to))

->setEncoder(Swift_Encoding::get8BitEncoding())

// Give it a body
->setBody($message, 'text/plain', 'us-ascii');

//Check is BCC Field is emtpy. 
if ( !empty($bcc) ) 
{   //The BCC Field is not empty so set it.  
    $the_message->setBcc(explode(',', $bcc));
}

// Send the message
$result = $mailer->send($the_message); 
    }
    header("location:index.php?s=1");
?> 
```

以下是公司所说的他们收到的内容的示例：

```
Domestic Quote Request  Full Name: Test  Email: someone@somewhere.com  Phone: 555-555-5555     Pickup Date: 07/02/2012  Pickup City or Zip: 12938  Drop Off City or Zip: 23981  Year: 2009  Make: Audi  Model: A4  Carrier Type: enclosed carrier  This Quote is from awebsite.com 
```

这就是我给自己发电子邮件时收到的信息。

```
Domestic Quote Request
Full Name: Test
Email: someone@somewhere.com
Phone: 555-555-5555
Pickup Date: 07/02/2012
Pickup City or Zip: 12938
Drop Off City or Zip: 23981
Year: 2009
Make: Audi
Model: M4
Carrier Type: enclosed carrier
This Quote is from awebsite.com 
```

该公司表示，他们认为线索是以自由文本而不是纯文本形式发送的。有这样的事吗？我从未听说过自由文本。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:44:49.550

我唯一能想到的是，他们正在查看电子邮件的 Web 客户端会解析 HTML 格式的电子邮件。所以不是 \n 尝试`<br />`也许。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-14T00:07:57.867

电子邮件正文需要 Microsoft \r\n 行尾。标头需要 Linux \n 行结尾。

# android - 自定义类上的不可序列化异常 - Android

> ID：11569746
> 
> 赞同：4
> 
> 时间：2012-07-19T21:39:43.080
> 
> 标签：android, android-intent, intentservice, notserializableexception

所以我试图将我通过意图创建的类的实例传递给新的活动。

```
public class Room implements Serializable{

    /**
     * 
     */
    private static final long serialVersionUID = 6857044522819206055L;

    int roomID;

    String roomName;

    ArrayList<MarkerHolder> markerHolders = new ArrayList<MarkerHolder>();

    public int getRoomID() {
        return roomID;
    }
    public void setRoomID(int roomID) {
        this.roomID = roomID;
    }

    public String getRoomName() {
        return roomName;
    }
    public void setRoomName(String roomName) {
        this.roomName = roomName;
    }       

    public ArrayList<MarkerHolder> getMarkerHolders() {
        return markerHolders;
    }
    public void setMarkerHolders(ArrayList<MarkerHolder> markerHolders) {
        this.markerHolders = markerHolders;
    }       
}

public class MarkerHolder implements Serializable{
    /**
     * 
     */
    private static final long serialVersionUID = -7334724625702415322L;
    String marker;
    String markerTag;
    public String getMarker() {
        return marker;
    }
    public void setMarker(String marker) {
        this.marker = marker;
    }
    public String getMarkerTag() {
        return markerTag;
    }
    public void setMarkerTag(String markerTag) {
        this.markerTag = markerTag;
    }
} 
```

我试着通过那门课

```
Intent svc = new Intent(this, RoomUploader.class);
svc.putExtra("room", room);

try{           
    startService(svc);  
}catch (Exception e){
     e.printStackTrace();
} 
```

而且我不断收到一个我无法弄清楚的不可序列化异常。这两个类都实现了可序列化并具有序列 ID。成员变量只是字符串、整数和另一个类的数组，该类也可序列化，仅包含字符串。据我所知，所有这些东西都应该是可序列化的，还有什么可能导致这个错误？提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T21:49:01.343

这些课程是您活动的内部课程还是其他课程？如果是这样，它们有对其外部类的引用（可能是可序列化的，也可能不是可序列化的），您可以通过创建这些类来解决这个问题`static`。

例子：

```
public static class Room implements Serializable
{
    //your implementation
}

public static class MarkerHolder implements Serializable
{
    //your implementation
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:44:12.770

尝试将 ArrayList 更改为 MarkerHolder 的本机数组：

```
MarkerHolder[] markerHolders; 
```

更新：我的错。我一直使用本机数组进行序列化，所以不知道 ArrayList 确实是可序列化的。

您的代码看起来正确。logcat 中打印的确切错误消息是什么（即哪个类引发了序列化异常）？

另一种解决方案（更多工作）是让您的对象实现 Parcable 接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:02:08.300

尝试使用**getApplicationContext()**或**上下文**代替此。

# zend-framework - Zend 框架为同一控制器提供多条路由

> ID：11569747
> 
> 赞同：1
> 
> 时间：2012-07-19T21:39:46.387
> 
> 标签：zend-framework, routes, zend-route

我正在尝试在我的网站上设置 Zend 分页，以便我可以使用 Paul Irish 的 jquery 无限滚动插件，但我的路线有问题。我目前为我的组织者页面设置了这些路线：

```
//Organizer searches
    $route = new Zend_Controller_Router_Route('organizer/index/:filter/:page',
                                                array('controller'=> 'organizer',
                                                'action'=> 'index')); 
    $router->addRoute('organizer', $route);
    $route = new Zend_Controller_Router_Route('organizer/index/:filter',
                                                array('controller'=> 'organizer',
                                                'action'=> 'index')); 
    $router->addRoute('organizer', $route); 
```

它按此顺序正确匹配`organizer/index/popular`，但如果我在其上添加页码，过滤器突然出现空值。如果我切换订单，`organizer/index/popular/2`效果很好，但`organizer/index/popular`不再有效。我只能使用更具体的路线，因为这是我需要进行分页的路线，但我想同时包含这两种路线，以适应尝试键入 url 的用户，或者以防我忘记更改代码中某处的链接。我可以使用 Zend 将多个路由合并到同一个控制器吗？如果是这样，我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:56:48.077

您需要为路线指定不同的名称。您将它们都称为“组织者”，因此第二个每次都替换第一个。

您也可以通过为 page 变量设置默认值来轻松地使用一条路由完成此操作：

```
$route = new Zend_Controller_Router_Route(
    'organizer/index/:filter/:page',
    array(
        'controller'=> 'organizer',
        'action'=> 'index',
        'page' => 1
    )
); 
$router->addRoute('organizer', $route); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:56:19.890

您添加到路由器的每条路由都必须具有唯一的名称，因此您要添加的第二条路由必须具有不同的名称，因为您当前的代码会覆盖该路由`organizer`。将第二个调用更改为`$router->addRoute()`如下所示：

```
$router->addRoute('organizer2', $route ); 
```

# javascript - 部分网页在新窗口中

> ID：11569749
> 
> 赞同：1
> 
> 时间：2012-07-19T21:39:53.703
> 
> 标签：javascript, asp.net-mvc-3, html

如果我在页面上有一些隐藏元素，其中包含一些内容，我该如何创建一个链接，当用户点击它时，浏览器会打开一个新窗口并显示内容（只有内容，例如一些 json 数据）？

附言。我知道在页面上隐藏一些内容可能是个坏主意。最好放一个可以从服务器获取内容的操作链接。但它涉及许多其他令人头疼的问题，并且不是我创建了页面，所以如果有一个相对简单的解决方案，请告诉我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:43:37.190

Please use [http://okonet.ru/projects/modalbox/index.html](http://okonet.ru/projects/modalbox/index.html) with inline content setting

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:27:58.760

打开第二页时，您可以将隐藏元素的（URL 编码）内容作为参数传递给 URL。然后，该参数可以（未编码并）在加载时插入到第二页的正文中。

以下示例在 OS X 上本地运行。在其他操作系统上，该示例可能需要放置在实际的 Web 服务器上才能运行：

**page1.html**：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Page 1</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
function openwindow(){
    window.open("page2.html?html="+escape($("#myDiv").html()));
}
</script>
<style>
.hidden {
    visibility: hidden;
}
</style>
</head>
<body>

<a href="javascript:openwindow();">Click Me!</a>

<div class="hidden" id="myDiv">
<img src="http://upload.wikimedia.org/wikipedia/commons/thumb/6/6e/HTML5-logo.svg/200px-HTML5-logo.svg.png">
<p>See the HTML5 <a href="http://www.w3.org/TR/2012/WD-html5-20120329/">specification</a></p>
</div>

</body>
</html> 
```

**page2.html**

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Page 2</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>
jQuery.extend({
    // from: http://paulgueller.com/2011/04/26/parse-the-querystring-with-jquery/

    parseQuerystring: function(){
        var nvpair = {};
        var qs = window.location.search.replace('?', '');
        var pairs = qs.split('&');
        $.each(pairs, function(i, v){
            var pair = v.split('=');
            nvpair[pair[0]] = pair[1];
        });
        return nvpair;
    }
});
</script>
<script>
    $(document).ready(function(){
        $(document.body).html(unescape(jQuery.parseQuerystring().html));
    });
</script>
<style>
.hidden {
    visibility: hidden;
}
</style>
</head>
<body>

<!-- this will be replaced -->

</body>
</html> 
```

# c++ - 有什么方法可以更快地处理“可预测的分支”？

> ID：11569750
> 
> 赞同：2
> 
> 时间：2012-07-19T21:39:54.293
> 
> 标签：c++, performance, optimization, conditional, x86-64

我有一些代码，其中有两个或三个分支，你不知道它们会走哪条路，但是在它们第一次被击中后，要么 100% 确定，要么接近确定，相同的路径将再次发生。我注意到使用 __builtin_likely 在避免分支未命中方面并没有多大作用。即使在短时间内重复调用我的函数时分支预测做得很好……只要在调用我的函数之间发生其他事情，性能就会大大降低。有什么方法可以解决这个问题或我可以研究一些技术？有什么办法可以以某种方式“标记”这些分支，以便在流浪后再次到达它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:03:56.873

您可以使用模板为每个代码路径生成不同版本的函数，然后在运行时使用函数指针来选择一个，当您找出条件的走向​​时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:41:58.333

分支预测器和编译器内在函数就是你所拥有的。充其量，您可以查看程序集并尝试自己手动进行一些优化，但您不会发现太多。

# android - 您如何将 ORMLite 与抽象类一起使用？

> ID：11569751
> 
> 赞同：1
> 
> 时间：2012-07-19T21:39:59.167
> 
> 标签：android, ormlite

我有一个基类`Peripheral`。类`Sensor`和`Master`是`Peripheral`. 我需要 ORMlite 来实例化我之前保存的外围对象。显然，由于其抽象性，任何反射实例化的尝试`Peripheral`都会导致 a 。`ClassInstantiationException`我怎样才能让 ORMlite 加载任何`Peripheral`对象，因为`Peripheral`它是抽象的？

这是我正在做的示例：

```
@DatabaseTable(tableName="Peripheral")
abstract class Peripheral {
    @DatabaseField(generatedId="true")
    int _ID;
    @DatabaseField
    int mSerial;
}

class Sensor extends Peripheral {
}

class Master extends Peripheral {
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:44:13.840

> 由于 Peripheral 是抽象的，我如何让 ORMlite 加载任何 Peripheral 对象？

我认为您的问题源于`@DatabaseTable`需要在`Sensor`和`Master`类上的事实。在基类上也不会伤害它，但在那里不会被检测到。

这将有一个名为`"Peripheral"`用于两个超类的表。基类中的任何字段（例如`mSerial`）都将被检测并用作两个超类中的字段。

唯一的限制是 ORMLite 无法区分`Sensor`和`Master`。它现在缺少允许您获取所有行 a`Sensor`并获取所有行 a 的功能`Master`。此外，如果超类有自己的字段标记为 ，它不能为它们生成模式`@DatabaseField`。

*编辑：*

重申[ORMlite](http://ormlite.com/)（截至 2013 年 3 月）不支持*同一张表中的*多个子类很重要。子类*将从*基类继承数据库字段，但它们必须各自位于自己的表中。这是邮件列表上[有关此主题的讨论。](https://groups.google.com/forum/?fromgroups=#!topic/ormlite-dev/U-LExLQBAws)

为此，您可以有 3 个表：1 个用于基类信息，2 个用于子类。子类表将具有关联的基类行的外键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:37:04.223

格雷是正确的，当我第一次问这个问题时，我忘记了那个反思规则。我已经解决了反射限制和 ORMlite 目前在超类之间没有区别的限制。这是我的结构：

```
class Peripheral {
    @DatabaseField(generatedId)
    int _ID;
    @databaseField
    int serial;
    // ... Methods ommitted to be succint
}

class PeripheralWrapper extends Peripheral {
    final Peripheral mBase;
    PeripheralWrapper(Peripheral peripheral) {
        mBase = peripheral;
    }
    // ... Methods are overridden but call the base's methods instead
}

class Sensor extends PeripheralWrapper {
    Sensor(Peripheral peripheral) {
        super(peripheral);
    }
}

class Master extends PeripheralWrapper {
    Master(Peripheral peripheral) {
        super(peripheral);
    }
}

// This is the work around

@DatabaseTable(tableName="Peripheral")
class BasePeripheral extends Peripheral {
} 
```

这种解决方法实际上很简单。现在我只对 basePeripheral 进行膨胀，然后根据需要将它们传递到包装器中。包装的所有膨胀和委托都在 PeripheralFactory 中完成。

# cuda - calculate concentrations using CUDA

> ID：11569753
> 
> 赞同：0
> 
> 时间：2012-07-19T21:40:10.507
> 
> 标签：cuda

Sorry for start new question, I tried to use histogram.cu(in thrust example) to do the concentration, but its(brute force) time consuming if the number of particles are over 100k(takes about 5secs). What I want to do is calculate how many particles in each cell of the domain? assume cell size is 1 X 1 X 1, domain size is 100 X 100 X 100, there are 50k particles pos are (50, 50, 50),20k particles pos are (15, 15, 15),30k particles pos are (20, 20, 20). so cell(50, 50, 50) has 50k particles, cell(15, 15, 15)has 20k, cell(20, 20, 20)has 30k, no particles in other cells

my code is this posPtr* is an array of particles, device_cons* gonna be the output of concetration of each cell. But it doesnt work well, please help.(I think my shared memory control has some problem)

```
__global__ void concentration_kernel(float3* posPtr, uint* device_cons) 
{
    __shared__ uint cache[256];
    uint x = threadIdx.x + blockIdx.x * blockDim.x;
    uint y = threadIdx.y + blockIdx.y * blockDim.y;
    uint offset = x + y * blockDim.x * gridDim.x; 

    float3 posf3 = posPtr[offset];//make_float3(43.5,55,0.66);//
    uint cellIndex = (uint)(posf3.z+1)*153*110 + (uint)(posf3.y)*153 + (uint)posf3.x;

    cache[threadIdx.x] = device_cons[cellIndex];
    __syncthreads();
    uint a = cache[threadIdx.x];
    a++;
    cache[threadIdx.x] = a;
    __syncthreads();

    device_cons[cellIndex] = cache[threadIdx.x]; 
} 
```

thanks!

for better understanding here is my c++ code

```
for(uint i=0; i<numParticles; i++)
{
  float3 posf3 = dev_pos[i]; 
  uint cellIndex = (uint)(posf3.z)*153*110 + 
       (uint)(posf3.y)*153 + (uint)posf3.x; 
  dev_con[cellIndex]++;
} 
```

the domain size is(152, 110, 30) thats why I do

```
uint cellIndex = (uint)(posf3.z)*153*110 + 
       (uint)(posf3.y)*153 + (uint)posf3.x; 
```

to get the cellindex of particles at Thanks

I figured it out.... use atomicAdd()...

# javascript - infinite ajax scroll not loading javascript

> ID：11569761
> 
> 赞同：3
> 
> 时间：2012-07-19T21:41:02.997
> 
> 标签：javascript, jquery

SO basically I am using this plugin

[https://github.com/webcreate/Infinite-Ajax-Scroll](https://github.com/webcreate/Infinite-Ajax-Scroll)

It fits my needs perfectly and is working pretty seamless.

My website is articles, the problem is the javascript only appears for the first page of data.

For example, my facebook like buttons, hover effect, etc etc only works for the original rows loaded, not for the rows loaded by the plugin when you scroll to load more.

Anyone experience this issue and know how to approach this.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T08:47:31.340

由于 IAS 的 0.1.5 版有一个名为 的新选项`onRenderComplete`，这是一个回调函数，您可以在将新项目添加到 DOM 后重新初始化其他 javascript 代码。

您可以在此处阅读更多信息：[https ://github.com/webcreate/infinite-ajax-scroll#onrendercomplete](https://github.com/webcreate/infinite-ajax-scroll#onrendercomplete)

基本上，您可以将任何代码`$(document).ready()`放入此回调中。

# google-apps-script - Set Value on a DIFFERENT Sheet in Google Apps Script

> ID：11569764
> 
> 赞同：2
> 
> 时间：2012-07-19T21:41:09.680
> 
> 标签：google-apps-script

I want to do a variation on the ["Sending emails from a Spreadsheet" tutorial on the Google Developers page](https://developers.google.com/apps-script/articles/sending_emails).

I want to do exactly what they walk me through EXCEPT that when it comes to marking the cell in each row every time the e-mail is sent, I want to mark that on a SEPARATE sheet.

So, on the sheet "NeedReminders", my script finds the e-mail addresses of members to whom the e-mail should be sent in column A (which then becomes variable "emailAddress"). It sends the e-mail to that address.

THEN--and here's where I need help--I want the script to go to the "Master" sheet, find the row where emailAddress is in column X, and--in that same row--set the value of column BT.

Shouldn't be difficult. I just don't necessarily know how to do the "find the row where columm X equals emailAddress and set value of BT to today's date" part.

Who can help? Thanks in advance!

Here's my code so far (I'm always embarrassed to show my code because I'm sure it's terrible juvenile, so be gentle, please!):

```
function sendDuesReminder() {
  var sheet = SpreadsheetApp.openById('___').getSheetByName('NeedReminders');
  var startRow = 4; // There are a bunch of headers and other nonsense.
  var valueSheet = SpreadsheetApp.openById('___').getSheetByName('Master');

  // Determine how many rows to process
  var rowRange = sheet.getRange(3,4); // On my sheet, cell D3 counts how many members are on the list of people who need a reminder e-mail.
  var rowData = rowRange.getValue();
  // End Determine how many rows to process

  // Send e-mail
  var dataRange = sheet.getRange(startRow, 1, rowData, 2);
  var data = dataRange.getValues();
  for (i in data) {
    var row = data[i];
    // var emailAddress = row[0]; //Column A: E-mail Address
    var name = row[1]; //Column B: First Name
    var subject = "Reminder About Dues for Newcomers & Neighbors";
    MailApp.sendEmail("matt@twodoebs.com", subject, "Hi, " + name + ". It's been some time since we received your online registration for Newcomers & Neighbors. But we don't seem to have received your dues payment, yet. So we wanted to drop you a quick line and remind you about it." + "\n\n" + "If you think we should have received your payment by now or there's some kind of a mistake, please let us know by responding to this message." + "\n\n" + "Otherwise, please send a check for __ made payable to ___ to:" + "\n\n" + "___" + "\n" + "___" + "\n" + "___" + "\n" + "___" + "\n\n" + "Thanks! Please don't hesitate to reach out if you have any questions." + "\n" + "___" + "\n" + "___" + "\n\n" + "Best wishes," + "\n\n" + "Kati" + "\n" + "Membership Director",
                     {name:"___"});

  // End Send E-Mail

  // Set that an a-(Experimental)
  var valueRange = valueSheet.getRange // Here's where I kind of break down . . . I need *something* here that searches the sheet for emailAddress
  setValue(today()) //I'm also not sure that this is the right way to set the value as today's date
  SpreadsheetApp.flush();
    // End Set value
  }
  Browser.msgBox("OK. Reminder messages have been sent. doebtown rocks the house!")
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:22:16.190

如果你还在苦苦挣扎，试试这个：

```
var emails = valueSheet.getRange('X:X').getValues();
var targetRange = valueSheet.getRange('BT:BT');
var dates = targetRange.getValues();
for (var j=0; j<emails.length; ++j) {
    if (emails[j][0] == emailAddress) {
        dates[j][0] = new Date();
        break;
    }
}
targetRange.setValues(dates); 
```

# .net - 如何从序列化中排除特定类型？

> ID：11569766
> 
> 赞同：11
> 
> 时间：2012-07-19T21:41:17.007
> 
> 标签：.net, serialization, .net-4.0, sgen

我`sgen`用一吨的类型来对抗我的程序集。我想从序列化中排除 2 种类型。我似乎无法找到一种方法来做到这一点。

我看到`sgen`有一个`/type`开关来指定特定类型，但没有排除特定类型。

有没有办法从序列化中排除特定类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T07:20:24.930

除了将您希望排除的类型放在不同的程序集中之外，您不能从序列化程序生成中排除类型。

**更新**

其他海报提出了排除特定类型的其他可能性，根据您的用例具有不同的适用性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-22T08:40:21.770

您可以尝试通过将类标记为 来更改要从 Xml 序列化中排除的类的访问权限`internal`，然后 sgen.exe 应该跳过该类。

```
internal class NotToBeSerialized
{
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-07-23T15:58:12.360

为防止该类包含在 sgen 处理中，请确保它没有无参数构造函数。

正如对这个问题[Why XML-Serializable class need a parameterless constructor](https://stackoverflow.com/q/267724/361714)的回答所解释的那样，序列化需要任何权限级别的无参数构造函数才能工作。**将无参数构造函数设为私有是不够**的，将 if 从 sgen 处理中排除。

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2013-02-13T11:47:58.590

不确定您是否正在寻找这个，但您可以通过在类定义之前提及 [NonSerialized] 来将您自己的类排除在序列化之外。因此，如果您想排除特定类型，则必须从它继承并创建自己的类

```
[NonSerialized]
public class Point
{
    public int x, y;
} 
```

# c++ - 有没有办法将 'std::vector 2d' 作为指向 '2d c array' 的指针传递给函数

> ID：11569770
> 
> 赞同：1
> 
> 时间：2012-07-19T21:41:31.390
> 
> 标签：c++, stl

有没有办法将 'std::vector 2d' 作为指向 '2d c array' 的指针传递给函数。

我知道您可以将 std::vector 1d 作为指向 c 数组的指针传递给某个函数。例如，函数：

```
void foo(char* str); //requires the size of str to be 100 chars

std::vector<char> str_;
str_.resize(100);
foo(&str_[0]); //works 
```

我想知道二维向量是否也可以像函数一样

```
void foo(char** arr_2d); 
```

和矢量

```
std::vector<std::vector<char>> vector_2d; 
```

我尝试了以下代码，但我收到了一些与堆损坏相关的错误。

```
std::vector<std::vector<unsigned char>> vector_2d;
//assuming function expects the size of the vector to be 10x10  
vector_2d.resize(10);
for(int i=0;i<10;i++)
{
    vector_2d[i].resize(10);
}
foo(&vector_2d[0]);//error here 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:58:19.163

以下是您可以执行的操作：

```
std::vector< std::vector<unsigned char> > vector_2d;
vector_2d.resize(10);
std::vector<unsigned char*> ptrs(vector_2d.size());
for(int i=0;i<10;i++)
{
    vector_2d[i].resize(10);
    ptrs[i] = &vector_2d[i][0];
}
foo(&ptrs[0]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:56:32.847

不，你不能那样做。原因是它`char**`是一个指向 的指针`char`，但`&vector_2d[0]`它的类型是`std::vector<char>*`。

我建议您更改函数的接口以获取二维向量（您可能希望将其重新设计为一个包含单个`std::vector<char>`并提供`operator()(int x,int y)`访问`(x,y)`缓冲区元素的类。或者，您可以根据需要创建所需的数据结构：

```
std::vector<std::vector<char> > data2d;
std::vector<char *> iface_adapter;
iface_adapter.reserve(data2d.size());
for ( unsigned int i = 0; i < data2d.size(); ++i ) {
   iface_adapter.push_back( &data2d[i][0] );
}
foo( &iface_adapter[0] ); 
```

# android - The galaxy nexus cuts off the splash screen image because of the navigation bar

> ID：11569775
> 
> 赞同：0
> 
> 时间：2012-07-19T21:42:11.063
> 
> 标签：android, splash-screen

My app contains splash screens (1230x720 50px for status bar) for xhdpi devices. On the samsung galaxy s2,s3, the splash image fills the entire screen and it looks good. However, on the galaxy nexus, the navigation bar seems to be 90-100px tall and the splash image becomes too skinny. Since all these devices are xhdpi, how do I work around showing the full splash image for the galaxy nexus?

I've thought about a couple options. 1 - the SYSTEM_UI_FLAG_HIDE_NAVIGATION flag would surely work with some workarounds, but my app is running off of 2.3.4 so the flag is not found.

2- The image currently is not that bad, but if I could atleast center it within the splash screen, then it would be fine.

thank you.

edit: here's my xml for the splash screen

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

     <ImageView android:id="@+id/splash_image_view"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
          android:layout_gravity="top"
          android:scaleType="fitStart"
          android:gravity="top"/>

     <ProgressBar android:id="@+id/progressBar"
          android:layout_width="fill_parent"
          android:layout_height="wrap_content"
          android:layout_gravity="center_horizontal|top"
          android:progress="0"
          style="?android:attr/progressBarStyleHorizontal" />     
</FrameLayout> 
```

Answer:

I figured it out by going to the API documentation and using the hard-coded int value instead of the SYSTEM_UI_FLAG_HIDE_NAVIGATION flag.

the code is just 0x2 (2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-22T23:51:35.387

根据OP的编辑：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent">

     <ImageView android:id="@+id/splash_image_view"
          android:layout_width="fill_parent"
          android:layout_height="fill_parent"
          android:layout_gravity="top"
          android:scaleType="fitStart"
          android:gravity="top"/>

     <ProgressBar android:id="@+id/progressBar"
          android:layout_width="fill_parent"
          android:layout_height="wrap_content"
          android:layout_gravity="center_horizontal|top"
          android:progress="0"
          style="?android:attr/progressBarStyleHorizontal" />     
</FrameLayout> 
```

# c# - reading a CSV into a Datatable without knowing the structure

> ID：11569777
> 
> 赞同：4
> 
> 时间：2012-07-19T21:42:27.963
> 
> 标签：c#, .net, csv, datatable

I am trying to read a CSV into a datatable.

The CSV maybe have hundreds of columns and only up to 20 rows.

It will look something like this:

```
+----------+-----------------+-------------+---------+---+
|  email1  |     email2      |   email3    | email4  | … |
+----------+-----------------+-------------+---------+---+
| ccemail1 | anotherccemail1 | 3rdccemail1 | ccemail |   |
| ccemail2 | anotherccemail2 | 3rdccemail2 |         |   |
| ccemail3 | anotherccemail3 |             |         |   |
| ccemail4 | anotherccemail4 |             |         |   |
| ccemail5 |                 |             |         |   |
| ccemail6 |                 |             |         |   |
| ccemail7 |                 |             |         |   |
| …        |                 |             |         |   |
+----------+-----------------+-------------+---------+---+ 
```

i am trying to use [genericparser](http://www.codeproject.com/Articles/11698/A-Portable-and-Efficient-Generic-Parser-for-Flat-F) for this; however, i believe that it requires you to know the column names.

```
string strID, strName, strStatus;
using (GenericParser parser = new GenericParser())
{
    parser.SetDataSource("MyData.txt");

    parser.ColumnDelimiter = "\t".ToCharArray();
    parser.FirstRowHasHeader = true;
    parser.SkipStartingDataRows = 10;
    parser.MaxBufferSize = 4096;
    parser.MaxRows = 500;
    parser.TextQualifier = '\"';

    while (parser.Read())
    {
      strID = parser["ID"];  //as you can see this requires you to know the column names
      strName = parser["Name"];
      strStatus = parser["Status"];

      // Your code here ...
    }
} 
```

is there a way to read this file into a datatable without know the column names?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T22:06:58.623

就是这么简单！

```
 var adapter = new GenericParsing.GenericParserAdapter(filepath);
        DataTable dt = adapter.GetDataTable(); 
```

这将自动为您完成所有工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T21:48:35.783

我查看了源代码，您也可以通过列索引访问数据，就像这样

```
var firstColumn = parser[0] 
```

将 0 替换为列号。列数可以使用

```
parser.ColumnCount 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-19T22:01:45.817

我对此不熟悉`GenericParser`，我建议使用类似[`TextFieldParser`](http://msdn.microsoft.com/en-us/library/microsoft.visualbasic.fileio.textfieldparser.aspx),[`FileHelpers`](http://filehelpers.sourceforge.net/quick_start.html)或 this的工具[`CSV-Reader`](http://www.codeproject.com/Articles/9258/A-Fast-CSV-Reader)。

但是这种简单的手动方法也应该有效：

```
IEnumerable<String> lines = File.ReadAllLines(filePath);
String header = lines.First();
var headers = header.Split(new[]{','}, StringSplitOptions.RemoveEmptyEntries);
DataTable tbl = new DataTable();
for (int i = 0; i < headers.Length; i++)
{
    tbl.Columns.Add(headers[i]);
}
var data = lines.Skip(1);
foreach(var line in data)
{
    var fields = line.Split(new[]{','}, StringSplitOptions.RemoveEmptyEntries);
    DataRow newRow = tbl.Rows.Add();
    newRow.ItemArray = fields;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-13T19:07:04.083

我使用通用解析器来做到这一点。在第一次运行循环时，我得到列名，然后引用它们以将它们添加到列表中

就我而言，我已经对数据进行了透视，但如果它对某人有帮助，这里是一个代码示例

```
 bool firstRow = true;
        List<string> columnNames = new List<string>();
        List<Tuple<string, string, string>> results = new List<Tuple<string, string, string>>();

        while (parser.Read())
        {
            if (firstRow)
            {
                for (int i = 0; i < parser.ColumnCount; i++)
                {
                    if (parser.GetColumnName(i).Contains("FY"))
                    {
                        columnNames.Add(parser.GetColumnName(i));
                        Console.Log("Column found: {0}", parser.GetColumnName(i));
                    }
                }
                firstRow = false;
            }

            foreach (var col in columnNames)
            {
                double actualCost = 0;
                bool hasValueParsed = Double.TryParse(parser[col], out actualCost);
                csvData.Add(new ProjectCost
                {
                    ProjectItem = parser["ProjectItem"],
                    ActualCosts = actualCost,
                    ColumnName = col
                });
            }
        } 
```

# c# - 与 VBA 相比，VSTO 性能较慢

> ID：11569780
> 
> 赞同：2
> 
> 时间：2012-07-19T21:42:38.947
> 
> 标签：c#, performance, excel, vba, vsto

我是stackoverflow的新手，因此我将直接从我的问题开始。

我有几年通过集成 VBA 为 Excel 开发宏的经验，半年前我开始学习新语言 C#。我喜欢它，它的可能性，我还找到了通过 Visual Studio 直接在 C# 中开发 Office 插件的选项（需要 VSTO）。我遇到的问题是，在进行了多次测试后，我尝试比较使用 C# 创建的插件和使用 VBA 创建的宏的速度（例如，将字符串“测试字符串”分别粘贴到从 A1 到 A10 000 的每个单元格）。问题是集成的 VBA 比使用 Visual Studio (C#) 创建的插件快几倍。当时我决定不为这个问题而烦恼，但后来我遇到了同样的问题，但这一次而不是 cca 10 秒（VBA）过程花费了 2 多分钟！

在对谷歌进行研究之后，我发现 VSTO 在性能方面并不好，尤其是当您需要您的应用程序与 Excel 交互时（因此有一些方法可以解决该问题，例如将数据保存到动态数组中，然后直接填充整个数组到活动表）；但是在某些情况下，您只需要与 excel 进行交互（就像我必须动态取消保护工作簿中的许多工作表......在这里您只需要说 ActiveSheet.Unprotect）

我对你们的问题是，除了缓慢的 VSTO 之外，还有其他方法吗，如何为易于部署的 Excel/Word/其他 Office 产品创建（可能是其他一些软件）插件？非常感谢你。

问候，罗伯特

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-20T07:56:37.553

VSTO-Excel 的性能问题是由于需要在 VBA/VB6 使用的 Excel 的 Com 接口之上添加 Interop 层。所以 VSTO 使用这种方法与 Excel 交互总是会很慢。

可以使用 Excel DNA（免费）和 Addin Express（非免费）等产品将 XLL 接口与 C# 一起使用。使用这个接口会很快，但它比 Com 接口更受限制。

这是用于开发 UDF的[各种技术的比较。](http://fastexcel.wordpress.com/2011/07/07/excel-udf-technology-choices-snakes-ladders-with-vba-vb6-net-c-com-xll-interop/)

分发 VBA 代码很容易 - 要么创建一个在应用程序级别运行的插件 (XLA/XLAM)，要么分发一个带有嵌入式 VBA 代码的工作簿，用于特定于文档的解决方案。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-09T04:36:39.743

单独填充 10000 个单元格会让您认为 VSTO 非常慢。使用您提到的动态数组方法，我可以在很短的时间内完成它：

```
static public void PopulateABigNumberOfCells(Excel.Application xlApp, DataTable dataTable)
{
//Turn off Excel updating
SwitchApplicationSettings(xlApp,false);

//Populate a 2D array - via a DataTable in this example
object[,] values = (object[,])Array.CreateInstance(typeof(object), new int[2] { dataTable.Rows.Count, dataTable.Columns.Count }, new int[2] { 1, 1 });
for (int i = 0; i < dataTablea.Rows.Count; i++)
{
 for (int j = 0; j < dataTable.Columns.Count; j++)
 {
  values[i + 1, j + 1] = dataTable.Rows[i][j] == DBNull.Value ? 0 : dataTable.Rows[i][j];
 }
}

//Populate all cells in one swoop 
leftCellNum = XlHelper.ColumnNameToNumber(leftColumn);
string rightBottom = XlHelper.ColumnNumberToName(leftCellNum + dataTable.Columns.Count - 1);
using (var targetRange = xlApp.Range[leftColumn + (startingRow) + ":" + rightBottom + (startingRow + dataTable.Rows.Count - 1)].WithComCleanup())
{
targetRange.Resource.Value2 = values;
}

//Turn on Excel updating
SwitchApplicationSettings(xlApp,true);
}

static public void SwitchApplicationSettings(Excel.Application xlApp, bool on)
{
xlApp.ScreenUpdating = on;
xlApp.DisplayAlerts = on;
xlApp.Calculation = on ? XlCalculation.xlCalculationAutomatic : XlCalculation.xlCalculationManual;;
xlApp.UserControl = on;
xlApp.EnableEvents = on;
} 
```

我使用[VSTO Contrib](http://jake.ginnivan.net/vsto-com-interop)来获得更好的内存管理。

除非您专门讨论单独填充数千个单元格，否则使用对象模型并不比 VBA 慢 12 倍。

# php - 从 PHP 循环创建两个主列

> ID：11569782
> 
> 赞同：1
> 
> 时间：2012-07-19T21:42:56.370
> 
> 标签：php, html, css, loops, html-table

我有六列输出。内容是从数组中获取的（创建为 php 数组，然后作为 js 数组发送）。包含数组 $set 的示例行如下：

```
 $set[] = array('q'=>'&#22696;&#27700;','qurl'=>'001','a1'=>'o','a2'=>'ui','f'=>'m','m'=>'4sh','e'=>'3'); 
```

假设我有四行内容。我的代码目前生成这个：

```
Col 1 Col 2 Col 3 Col 4 Col 5 Col 6
Col 1 Col 2 Col 3 Col 4 Col 5 Col 6
Col 1 Col 2 Col 3 Col 4 Col 5 Col 6
Col 1 Col 2 Col 3 Col 4 Col 5 Col 6 
```

我需要将这四行放入两组主要的列中。所以像这样：

```
Col 1 Col 2 Col 3 Col 4 Col 5 Col 6        Col 7 Col 8 Col 9 Col 10 Col 11 Col 12
Col 1 Col 2 Col 3 Col 4 Col 5 Col 6        Col 7 Col 8 Col 9 Col 10 Col 11 Col 12 
```

这样做的有效方法是什么？我当前的代码如下所示：

```
…
$js_array = json_encode($set);
…

<table>
    <?php $counter = 0;
    while ($counter < 20) :
    $item = $set[$counter]?>
        <tr class="q<?php echo $counter; ?>">                   
            <form>
            <td><h5><?php echo $counter+1; ?></h5></td>
            <td><a class="question" href="javascript:soundManager.play('<?php echo $item['qurl'] ?>','audio/part2/type3/type3_<?php echo $item['qurl'] ?>.mp3');"><?php echo $item['q'] ?></a></td>
            <td><?php echo $item['f'] ?></td>
            <td><input class="a1" type="text" name="a1" maxlength="4" size="2" /></td>
            <td><?php echo $item['m'] ?>&nbsp;<input class="a2" type="text" name="a2" maxlength="4" size="2" /><?php echo $item['e'] ?></td>
            <td><input class="submit submit-<?php echo $counter; ?>" type="submit" value="Submit" /></td></form>
        </tr>
    <?php $counter++; ?>
    <?php endwhile; ?>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:02:21.303

你可以这样做：

```
$total = 24;

//loop through rows     
for($i = 0; $i < $total; $i++) {
    //start new table?
    if($i == 0 || $i == ($total/2)) {
        if($i > 0) { //second table cell values
            echo '</table>';
            $j_val = 7;
            $j = $j_val;
        } else { //first table cell values
            $j_val = 1;
            $j = $j_val;
        }

        echo '<table>';
    }

    echo '<tr>';

    $total_cells = ($j + 6);

    for(; $j < $total_cells; $j++) {
        echo '<td>' . $j . '</td>';
    }

    //reset j to default
    $j = $j_val;

    echo '</tr>';
}

echo '</table>'; 
```

# performance - Going from OpenGL ES 1.1 to ES 2 just for performance issues

> ID：11569789
> 
> 赞同：1
> 
> 时间：2012-07-19T21:43:47.147
> 
> 标签：performance, opengl-es

I have read a lot about the pros and cons of going from ES 1.1 to ES 2 and I just wanted to clarify one thing. The game I have made, using ES 1.1, has performance issues (runs slow and low FPS) on some devices and I just wanted to know if I make the change to ES 2 would it help? The game makes use of lighting, blending and texturing. I am not wishing to jazz it up or change effects in anyway, just simply increase performance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:50:42.537

It's difficult to say what kind of performance increase you could expect between GLES 1.1 and GLES 2.0 without knowing how you built your renderer. *Ideally*, yes, you will see a performance increase by going to GLES 2.0\. This may be because whatever platform you're using is handling GLES 1.1 APIs through GLES 2.0, but again, it depends a lot on what you're doing.

I'd recommend first profiling your program to see what's causing the performance issues before you decide it's an issue with your choice of API. It might be because you're constantly reloading some textures or you're not doing state management properly or maybe you're for some reason just doing something that's blocking the rest of your code. Again, without knowing your code, it's not really possible for anyone to say for sure that your game's performance will improve just by changing APIs.

# objective-c - NSUserDefaults 正确存储 NSDate，然后在第二次检索后返回 null

> ID：11569802
> 
> 赞同：2
> 
> 时间：2012-07-19T21:44:52.373
> 
> 标签：objective-c, ios, nsdate, nsuserdefaults

我正在尝试使用 NSUserDefaults 存储和检索 a`startTime`和`endTime`NSDate。存储它们似乎不是问题：

```
self.convertedStringToDate = convertDate
NSLog(@"This should read 16:00: %@", self.convertedStringToDate);

NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];

[userDefaults setObject:convertDate forKey:@"startDate"];
[userDefaults synchronize]; 
```

然后我检索它只是为了确保它正确存储和检索：

```
NSDate* temporaryDate = (NSDate*)[userDefaults objectForKey:@"startDate"];
NSLog(@"Now User Defaults, should read 16:00: %@", temporaryDate); 
```

查看我的 NSLog，一切都很好：

```
2012-07-19 14:38:26.002 app[1973:707] This should read 16:00: 2012-07-19 16:00:00 +0000
2012-07-19 14:38:26.022 app[1973:707] Now User Defaults, should read 16:00: 2012-07-19 16:00:00 +0000 
```

现在的问题是，当我再次检索日期时，在另一种方法中，日期出现为空：

```
 NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
 NSDate *tmpDate = (NSDate*)[userDefaults objectForKey:@"startTime"];
 NSLog(@"Retreiving date, should be 16:00: %@",tmpDate); 
```

如本日志所示：

```
2012-07-19 14:38:26.107 app[1973:707] Retreiving date, should be 16:00: (null) 
```

有没有人有任何想法？我也尝试不检索支票中的日期，但日期继续返回 null（这也没有意义，NSUSerDefaults 是存储这些键和对象的数据库）。我还尝试存储`retained`对象的属性，但仍然无济于事。我错过了什么？

**编辑：阅读您自己的代码以了解愚蠢的错误很重要。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T21:49:06.860

代码是正确的，但...

tmpDate = [userDefaults objectForKey:@" **startTime** "];

应该

tmpDate = [userDefaults objectForKey:@" **startDate** "];

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-22T18:39:08.507

这就是为什么你应该总是定义字符串常量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-23T00:15:00.973

在NSString上做一个分类，代码是：NSString+date.h @interface (NSString) make class methods +(NSString)today; @end NSString+date.m @implimentation (NSString) +(NSString)today { NSDateFormatter *formatter = [[NSDateFormatter alloc]init]; [格式化设置时间样式：NSDateFormatShortStyle]；[格式化程序 setDateStyle:NSDateFormatShortStyle]; NSDate *今天 = [NSDate 日期]；NSString *theDate = [格式化字符串FromDate:today]; 返回日期；}

在其他类 NSString *theDate =[NSString today]; 不搞乱默认设置很容易，否则任何事情都会让你有更多的时间来担心比获取和设置日期更重要的事情

# matlab - MATLAB：在 Xaxis 上绘制时间 - 重叠标签

> ID：11569804
> 
> 赞同：3
> 
> 时间：2012-07-19T21:45:08.190
> 
> 标签：matlab, plot

我在 xaxis 上绘制时间时遇到困难。我有一些重叠的标签。见下文：

![阴谋](../Images/2a0c01613eb88f6b88b57c6fb146e5e2.png)

这是我的代码：

```
time=datenum(0,0,0,0,0,timeinseconds);
labs=1:10:length(time);

figure(3);
plotyy(time,xvalue,time,dens);
datetick('x','HH:MM');
set(gca,'XTick',time(labs),'XTickLabel',time(labs)); 
legend('xval','CDF');
title('Crash on Oct.10 2008 at 15:59pm');
xlabel('Time'); 
```

首先，为什么标签与旧标签重叠？其次，如何让标签旋转 90 度？我尝试了其他一些 matlab 函数来转换标签，但似乎没有一个能够处理时间格式标签。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:32:36.697

调用`plotyy`你创建两个`axis`对象。您的重叠问题可能来自这样一个事实：您只修改了一组轴，而将另一组保留为最初设置。

一种选择是在您调用时处理两个创建的轴`plotyy`：

```
[AX, H1, H2] = plotyy( time, xvalue, time, dens); 
```

您的第一个选项是设置两个轴，包含在 handlers 数组中`AX`，通过将属性更改`'XTick'`为：

```
set( AX(1), 'XTick', time(labs), 'XTickLabel', time(labs));
set( AX(2), 'XTick', time(labs), 'XTickLabel', time(labs)); 
```

但是您也可以选择将第二个轴的标签留空，替换上面的第二行：

```
set( AX(1), 'XTick', time(labs), 'XTickLabel', time(labs));
set( AX(2), 'XTick', time(labs), 'XTickLabel', []); 
```

[plotyy](http://www.mathworks.co.uk/help/techdoc/ref/plotyy.html)和[Using Multiple X-and Y-Axes](http://www.mathworks.co.uk/help/techdoc/creating_plots/f1-11215.html)的官方文档可以为您提供进一步的帮助。

* * *

如果您看一下那里的示例，即[plotyy](http://www.mathworks.co.uk/help/techdoc/ref/plotyy.html)文档：

```
figure
x = 0:0.01:20;
y1 = 200*exp(-0.05*x).*sin(x);
y2 = 0.8*exp(-0.5*x).*sin(10*x);
[AX,H1,H2] = plotyy(x,y1,x,y2,'plot'); 
```

和你之前做的一样，试着只修改`AX(2)`，这相当于你写的`gca`：

```
set(AX(2),'XtickLabel',1:0.1:20) 
```

您会观察到发生了相同的重叠错误。

关于将标签旋转 90 度，恐怕 Matlab 目前不支持。但是，您可能可以使用 FileExchange 上的可用软件包之一完成此操作。xticklabelrotate或[Rotate Tick Label](http://www.mathworks.com/matlabcentral/fileexchange/8722)可能是其中之一[。](http://www.mathworks.com/matlabcentral/fileexchange/3486-xticklabelrotate)

# ajax - AJAX 不能与 XAMPP 一起使用，还是不可能

> ID：11569805
> 
> 赞同：0
> 
> 时间：2012-07-19T21:45:19.383
> 
> 标签：ajax

我对 AJAX 还比较陌生，我想弄清楚为什么我的简单测试不起作用。从我读到的 AJAX 将无法在一个域下工作，并且会弹出诸如跨站点和远程服务器之类的单词。无论如何，我的问题是我不确定我的代码是否错误，或者只是我想要做的事情是不可能的。当我单击按钮时，我创建了一个简单的 ajax 请求来提交数据。这是第一个脚本的代码。

```
<html>
  <head>
    <script type="text/javascript" >
      function load(thediv, thefile) {
        if (window.XMLHttpRequest) {
          xmlhttp = new XMLHttpRequest();   
        } 
        else {
          xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');
        }   
        xmlhttp.onreadystatechange = function() {
          if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById(thediv).innerHTML = xmlhttp.responseText;
          }     
        }
        xmlhttp.open('GET', thefile, true);
        xmlhttp.send();
      }
    </script>
  </head>
  <body>
    <input type="submit" onclick="load('adiv', 'hello.php');">
    <div id="adiv"></div>
  </body>
</html> 
```

这是文件**hello.php的代码**

```
<?php
  echo 'aaa';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:50:21.583

AJAX 只是在后台完成的一个 http 请求。但是，是的，有一些安全限制会阻止您对任意服务器执行正常的 ajax 请求。

您的代码缺少的实际上是设置您将请求发送到的 URL。您已将`hello.php`load() 函数作为参数，但您从未真正**使用**过它。所以你正在做一个AJAX请求......“无处”。

# java - Java：覆盖子类中的抽象方法

> ID：11569807
> 
> 赞同：8
> 
> 时间：2012-07-19T21:45:40.153
> 
> 标签：java, oop

我真的应该知道这一点，但由于某种原因，我不明白以下内容。

我的抽象类包含以下抽象方法：

```
protected abstract RuleDTO createRowToBeCloned(RuleDTO ruleDTO); 
```

我还有另一堂课如下：

```
EvaluationRuleDTO extends from RuleDTO 
```

然后在我的抽象类的子类中，由于“必须覆盖或实现超类型方法”，我有以下不允许的实现：

```
protected EvaluationRuleDTO createRowToBeCloned(EvaluationRuleDTO ruleDTO) { 
```

但是，允许以下情况：

```
protected EvaluationRuleDTO createRowToBeCloned(RuleDTO ruleDTO) { 
```

我意识到这可能是一个基本问题，但我有点困惑。为什么我可以在覆盖的方法中返回 RuleDTO 的子类，但我不能传入子类？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-19T21:52:48.307

你打破了 Liskov 原则：超类可以做的一切，子类必须能够做。超类声明了一个接受任何类型 RuleDTO 的方法。但是在您的子类中，您只接受 EvaluationRuleDTO 的实例。如果您执行以下操作会发生什么？

```
RuleDTO rule = new EvaluationRuleDTO();
rule.createRowToBeCloned(new RuleDTO()); 
```

EvaluationRuleDTO 是 RuleDTO，因此它必须履行 RuleDTO 定义的合同。

但是，子类中的方法可能会返回 EvaluationRuleDTO 的实例而不是 RuleDTO，因为约定将返回 RuleDTO，而 EvaluationRuleDTO 是 RuleDTO。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-19T21:48:45.833

这是因为当你重写一个方法时，你必须使用相同类型或更通用（更广泛）的类型作为参数类型，而不是更窄的类型。

考虑一下。如果你可以使用更窄的类型覆盖一个方法，你会破坏多态能力，你不同意吗？因此，这样做，您将违反JB Nizet 在回答中所说的[Liskov 替换原则。](http://en.wikipedia.org/wiki/Liskov_substitution_principle)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-19T21:49:29.917

Java 允许覆盖的返回类型协变，因此您可以将覆盖的返回类型指定为派生更多的类型。但是，Java 不允许覆盖的参数类型协变。

前者安全的原因是您返回的对象将至少具有较少派生类型的功能，因此依赖该事实的客户端仍然能够正确使用返回的对象。

不过，论点并非如此。如果它是合法的，用户可以调用抽象方法并传入一个派生较少的类型（因为这是在抽象类上声明的类型），但是你的派生重写可能会尝试将参数作为派生更多的类型来访问（它不是）导致错误。

理论上，Java 可以允许参数类型*逆变*，因为这是类型安全的：如果被覆盖的方法只需要一个*较少*派生的参数，您就不会意外地使用不存在的方法或字段。不幸的是，这目前不可用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T21:48:56.427

Java 1.5 具有[协变返回](https://blogs.oracle.com/sundararajan/entry/covariant_return_types_in_java)类型，这就是它有效的原因

> 子类方法的返回类型 R2 可能与超类方法的返回类型 R1 不同，但 R2 应该是 R1 的子类型。即，子类可以返回类型可能是超类返回类型的子类型。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-19T21:53:25.827

在早期的 Java 中情况并非如此，但在 Java 5.0 中发生了变化。

> 同一个类中不能有两个方法，其签名仅因返回类型而异。在 J2SE 5.0 发布之前，一个类也确实不能覆盖它从超类继承的方法的返回类型。在本技巧中，您将了解 J2SE 5.0 中允许协变返回类型的新特性。这意味着子类中的方法可以返回一个对象，该对象的类型是该方法返回的类型的子类，在超类中具有相同的签名。此功能消除了对过多类型检查和强制转换的需要。

来源： [http ://www.java-tips.org/java-se-tips/java.lang/covariant-return-types.html](http://www.java-tips.org/java-se-tips/java.lang/covariant-return-types.html)

*这意味着覆盖方法的返回类型将是被覆盖方法的返回类型的子类型。*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-23T18:28:39.690

请看以下代码：

```
class A {
    A foo(A a) {
        return new A();
    }
}

class B extends A {
    @Override
    // Returning a subtype in the overriding method is fine,
    // but using a subtype in the argument list is NOT fine!
    B foo(B b) {
        b.bar();
        return new B();
    }
    void bar() {
        // B specific method!
    }
} 
```

是的，好的，B 是 A，但是如果有人这样做会发生什么：

```
B b = new B();
b.foo(new A()); 
```

A 没有 bar 方法。这就是为什么参数不能是被覆盖方法中参数类型的子类型的原因。

在覆盖方法中返回 A 或 B 很好。以下代码段将编译并运行得很好..

```
class A {
    A foo(A a) {
        return new B(); // B IS AN A so I can return B!
    }
}

class B extends A {
    @Override
    B foo(A b) {
        return new B(); // Overridden method returns A and 
                        // B IS AN A so I can return B!
    }

    public static void main(String[] args) {
        A b = new B();
        final A foo = b.foo(new B());
        // I can even cast foo to B!
        B cast = (B) foo;
    }
} 
```

# java - 应用服务器启动时的 Spring Security LDAP 配置 BeanCreationException

> ID：11569812
> 
> 赞同：1
> 
> 时间：2012-07-19T21:45:48.850
> 
> 标签：java, spring, spring-security, ldap

我正在尝试将我的 Spring 3.1 应用程序连接到我的内部 Zimbra LDAP 服务器。我正在做一些可能非常愚蠢的事情，我看不到问题所在。我确定我定义的组和用户群以及过滤器术语可能存在问题，但这不应该在应用服务器启动时导致 BeanCreationException，不是吗？我可以用另一双眼睛...

例外的简短版本：

“无法将 LdapAuthenticationProvider 转换为属性提供者 [0] 所需的类型 AuthenticationProvider”

完整的例外：

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.authentication.ProviderManager#0': Cannot create inner bean '(inner bean)' of type [org.springframework.security.config.authentication.AuthenticationManagerFactoryBean] while setting bean property 'parent'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name '(inner bean)#16': FactoryBean threw exception on object creation; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.authenticationManager': Initialization of bean failed; nested exception is org.springframework.beans.ConversionNotSupportedException: Failed to convert property value of type 'java.util.ArrayList' to required type 'java.util.List' for property 'providers'; nested exception is java.lang.IllegalStateException: Cannot convert value of type [org.springframework.security.ldap.authentication.LdapAuthenticationProvider] to required type [org.springframework.security.authentication.AuthenticationProvider] for property 'providers[0]': no matching editors or conversion strategy found 
```

相关的 Spring 配置文件入口：

```
<security:authentication-manager>
    <security:ldap-authentication-provider
        group-search-filter="member={0}"
        group-search-base="ou=groups"
        user-search-base="ou=people"
        user-search-filter="uid={0}"
    />        
</security:authentication-manager>

<security:ldap-server url="ldap://<correct IP and port>" manager-dn="uid=zimbra,cn=admins,cn=zimbra" manager-password="<private>" /> 
```

感谢您提供的任何见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-01T06:51:39.343

这看起来像是您包含的 Spring 库之间的不匹配。您需要确保您的 Spring Security LDAP 库与您的其他 Spring Security 库版本匹配。

例如：

```
spring-security-web-3.1.0.RELEASE.jar
spring-security-core-3.1.0.RELEASE.jar
spring-security-config-3.1.0.RELEASE.jar
spring-security-ldap-3.1.0.RELEASE.jar 
```

# c++ - 指针引用类赋值

> ID：11569815
> 
> 赞同：0
> 
> 时间：2012-07-19T21:46:16.093
> 
> 标签：c++, class, pointers, reference, g++

以下场景的语法是否有问题：

如果我有 Foo 类和 Foo1 类，并且我的 Foo 类有 Foo1 类型的私有成员：

.h 文件：

```
class Foo{
  Foo1 *oFoo;
public:
  Foo(Foo1 &Fooy);
} 
```

.cc 文件：

```
Foo::Foo(Foo1 &Fooy){
  oFoo = &Fooy;
} 
```

上述构造函数中的赋值是否合法？我是 C++ 新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:50:19.333

它应该`oFoo`代替`Foo`，并且成员应该在初始化列表中初始化：

```
Foo::Foo(Foo1 &Fooy): oFoo(&Fooy) {
} 
```

否则没关系。考虑制作构造函数`explicit`以防止不需要的隐式强制转换。

# video - 锁定标志在direct3d中做了什么

> ID：11569816
> 
> 赞同：2
> 
> 时间：2012-07-19T21:46:33.477
> 
> 标签：video, rendering, direct3d

我正在使用 direct3d 渲染 yuv 视频数据。基本流程是：

在这个表面上使用 CreateOffscreenPlain lockrectangle 创建一个 yv12 表面以获取数据指针，将 yuv 数据复制到它。从这个表面拉伸矩形到后台缓冲区调用存在以显示后台缓冲区。

在 LockRectangle 调用中有一个 LockFlags 参数，我们一直在使用 LockFlags.Discard，这听起来意味着我们将覆盖整个缓冲区。

这似乎在某些英特尔板载图形设备上引起了一些问题（目前有例外），而如果我将 LockFlags 更改为 LockFlags.None，问题似乎就消失了。我这样做是否创造了竞争条件？

我想我可能需要了解这里锁定的必要性。显示器是 32 位 rgb，所以我猜 yuv 到 rgb 的转换是在 stretchrectangle 调用上完成的。这个过程是同步的还是异步的？我想我已经读过礼物是异步的，但这对我来说并不重要，因为这是对我不直接接触的后缓冲区的操作。

如果这些问题没有意义，我深表歉意，我认为到目前为止我还没有很好地处理这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T18:46:34.440

我假设您使用的是 D3D9？无论哪种方式，它在所有 API 上都是一样的。

使用“D3DLOCK_DISCARD”时，您应该始终重写缓冲区中的所有数据。听起来你可能不是？

如果您的意图是重写缓冲区中的所有数据，出于性能原因，您确实希望使用“丢弃”。如果您只写数据的一部分，您可以使用“无”。

[http://msdn.microsoft.com/en-us/library/windows/desktop/bb147263(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb147263(v=vs.85).aspx) “如果图形处理器在使用 D3DLOCK_DISCARD 调用锁定时仍在使用缓冲区，则指向返回一个新的内存区域，而不是旧的缓冲区数据。”

# .net - 既然 connect.microsoft.com 需要 Visual Studio 2012，您如何提交 .NET 的错误报告？

> ID：11569817
> 
> 赞同：1
> 
> 时间：2012-07-19T21:46:34.717
> 
> 标签：.net, visual-studio-2010, bug-reporting

微软似乎已经取消了为 Visual Studio 和 .Net 提交错误报告的功能。如果您单击“报告错误”，它会将您带到[此页面](http://connect.microsoft.com/VisualStudio/)。

如果您单击“提交错误”，它会将您带到[这里](https://connect.microsoft.com/VisualStudio/content/content.aspx?ContentID=27774)它告诉您的地方

> 如果您要提交有关 Visual Studio 2010 和 .NET Framework 的反馈，请使用 MS 论坛或直接通过 [http://support.microsoft.com](http://support.microsoft.com)联系 MS 支持或致电 1-800-MICROSOFT。

如果我转到他们为 MS Forms 提供的链接，我找不到任何提交错误的地方。

既然他们更改了“Microsoft Connect”以提交 .NET 的错误，我该去哪里？

* * *

**更新：**感谢您的帮助，[这是给感兴趣的人的错误报告](https://connect.microsoft.com/VisualStudio/feedback/details/754705/setting-null-to-a-directoryentry-properties-value-during-user-creation-thowes-execption)。展开“细节”例如代码以重现问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:05:59.437

查看包含您引用的措辞的页面底部。

> ![在此处输入图像描述](../Images/0e31c7ba58d20e1e9265cd862155d4ae.png)

我点击链接，登录，并获得了 .NET Framework 的 Connect 错误提交表单：

> ![在此处输入图像描述](../Images/424f93e6a880060474729a2b2271a2cf.png)

# shell - 具有多个条件的 Sed

> ID：11569823
> 
> 赞同：3
> 
> 时间：2012-07-19T21:47:10.577
> 
> 标签：shell, unix, sed, criteria, conditional-statements

我有 3 个`sed`命令：

```
sed -n 's/.*domain=\([^&]*\).*sdk_ver=\([^&]*\).*/\1 \2/p' inputfile > outputfile
sed -n 's/.*sdk_version=\([^&]*\).*domain=\([^&]*\).*/\2 \1/p'  inputfile > outputfile
sed -n 's/.*domain=\([^&]*\).*sdk_version=\([^&]*\).*/\1 \2/p' inputfile > outputfile 
```

每个命令都有一个标准。我只想将 3 个命令放入 1 个命令中，以获得一个输出文件，其中包含所有结果作为三个标准的联合。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-19T21:57:31.907

### 使用多个 Sed 表达式

您可以将多个 sed 表达式放在由换行符分隔的脚本中，或者作为由**-e**选项分隔的多个表达式。例如：

```
sed -n -e 's/.*domain=\([^&]*\).*sdk_ver=\([^&]*\).*/\1 \2/'      \
       -e 's/.*sdk_version=\([^&]*\).*domain=\([^&]*\).*/\2 \1/'  \
       -e 's/.*domain=\([^&]*\).*sdk_version=\([^&]*\).*/\1 \2/p' \
       inputfile > outputfile 
```

在此示例中，sed 将在每个输入行上按顺序运行表达式，并且仅在处理完序列中的最终表达式后打印模式空间。当然还有其他方法可以做到这一点，但鉴于你的例子，这似乎是最合适的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-22T15:02:05.313

`sed -e`允许在一行中写入`;`单独的命令。

```
sed -e 's/.*domain=\([^&]*\).*sdk_ver=\([^&]*\).*/\1 \2/ ; s/.*sdk_version=\([^&]*\).*domain=\([^&]*\).*/\2 \1/ ; s/.*domain=\([^&]*\).*sdk_version=\([^&]*\).*/\1 \2/p' 
```

小修正 - 不需要“-ne”。只是“-e”只会起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:54:07.343

这不行吗？

```
sed -n 's/.*domain=\([^&]*\).*sdk_ver=\([^&]*\).*/\1 \2/p' inputfile | sed -n 's/.*sdk_version=\([^&]*\).*domain=\([^&]*\).*/\2 \1/p' | sed -n 's/.*domain=\([^&]*\).*sdk_version=\([^&]*\).*/\1 \2/p' > outputfile 
```

# publish-subscribe - CQRS + 事件溯源：（是否正确）命令通常是点对点通信的，而域事件是通过 pub/sub 通信的？

> ID：11569825
> 
> 赞同：6
> 
> 时间：2012-07-19T21:47:28.320
> 
> 标签：publish-subscribe, cqrs, event-sourcing, dddd

不知道如何缩短该标题。

我基本上是在尝试围绕 CQRS (http://en.wikipedia.org/wiki/Command-query_separation) 和相关概念的概念。

尽管 CQRS 不一定包含消息传递和事件溯源，但它似乎是一个很好的组合（从结合这些概念的许多示例/博客文章中可以看出）

给定某事物状态更改的用例（比如更新关于 SO 的问题），您是否认为以下流程是正确的（如最佳实践）？

*   系统发出一个聚合 UpdateQuestionCommand，它可能被分成几个较小的命令：针对问题聚合根的 UpdateQuestion 和针对用户聚合根的 UpdateUserAction（用于计数点等）。这些是使用点对点消息异步发送的。

*   聚合根做他们的事情，如果一切顺利，分别触发事件 QuestionUpdated 和 UserActionUpdated，其中包含外包给事件存储的状态.. 要持久化 yadayada，只是为了完整，这里不是重点。

*   这些事件也被放在发布/订阅队列中进行广播。任何订阅者（其中可能是一个或多个创建读取视图的投影仪）都可以自由订阅这些事件。

一般问题：确实是最佳实践，命令是点对点的（即：接收者是已知的）而事件是广播的（即：接收者是未知的）？

假设上述情况，允许通过 pub/sub 而不是点对点广播命令的优点/缺点是什么？

例如：在使用 Saga (http://blog.jonathanoliver.com/2010/09/cqrs-sagas-with-event-sourcing-part-i-of-ii/) 时广播命令可能会出现问题，因为Saga 在其中一个聚合根失败的情况下需要发挥的中介作用受到阻碍，因为 saga 不知道从哪个聚合根开始参与。

另一方面，我看到了允许广播命令的优势（灵活性）。

非常感谢任何帮助我清理头脑的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-20T17:06:29.490

是的，对于 Command 或 Query，只有一个且只有一个接收器（因此您仍然可以进行负载平衡），但对于事件，可能有零个或多个接收器（订阅者）

# c++ - 从 Spotify 在 Windows 上当前播放的歌曲中获取元数据

> ID：11569827
> 
> 赞同：5
> 
> 时间：2012-07-19T21:47:33.040
> 
> 标签：c++, windows, metadata, playback, spotify

我想为 Windows 播放一个简单的程序，该程序从 Spotify 获取有关当前播放歌曲的数据。标准方法似乎是获取 Spotify 的窗口标题并提取艺术家和歌曲名称。问题是您无法获得有关专辑或播放列表等的任何信息。

在 Mac 和 Unix 上，这似乎是可能的。（请参阅[http://community.spotify.com/t5/Desktop-Linux/Conky-Spotify-quot-Now-Playing-quot-scripts/td-p/26825](http://community.spotify.com/t5/Desktop-Linux/Conky-Spotify-quot-Now-Playing-quot-scripts/td-p/26825)和[如何从 Cocoa 获取当前在 Spotify Mac 中播放的曲目](https://stackoverflow.com/questions/11236413/how-to-get-currently-playing-track-in-spotify-mac-from-cocoa)） .

我正在寻找的是一种在 Windows 上获取此元数据（如果有）的类似方法。我几乎独立于编程语言，可能是c、c#、c++、java、autoit...

# iphone - iPhone 上每分钟自动更新屏幕

> ID：11569828
> 
> 赞同：0
> 
> 时间：2012-07-19T21:47:35.323
> 
> 标签：iphone, ios

我有一个倒计时 TextField，我喜欢在我的 iPhone 应用程序中每分钟自动更新一次。

当特定屏幕可见时，它应该倒计时 - 当切换到另一个屏幕时，倒计时显然不能更新。

返回屏幕时，倒计时应再次继续...

处理这个的正确方法是什么？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:57:55.630

我会使用一个`NSTimer`. 这是[NSTimer](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSTimer_Class/Reference/NSTimer.html)的文档。

这是一段关于如何设置计时器并让它调用方法的代码片段：

```
NSTimer *theTimer = [NSTimer timerWithTimeInterval:60 target:self selector:@selector(updateTime) userInfo:nil repeats:NO]; 
```

此计时器将在`updateTime`每次触发时调用该方法。我已将其设置为不重复，而是在每次调用该`updateTime`方法时创建一个新计时器。这样，如果您离开`UIViewController`后面，它将不会继续射击`NSTimer`。

这是一个通用`updateTime`方法：

```
-(void) updateTime
{
    //Update user interface

    NSTimer *theTimer = [NSTimer timerWithTimeInterval:60 target:self selector:@selector(updateTime) userInfo:nil repeats:NO];
} 
```

以`timeInterval`秒为单位，因此此计时器将每 60 秒触发一次。您可能希望将其缩短一点，例如 30 秒，甚至 1 秒，然后检查系统时间以查看何时需要更新倒计时。

我希望这会有所帮助！

# c# - .NET 4 中的 URL 重写

> ID：11569833
> 
> 赞同：0
> 
> 时间：2012-07-19T21:47:48.987
> 
> 标签：c#, asp.net, url-rewriting

.NET 4 中 URL 重写的最佳解决方案是什么。我正在寻找一种简单的解决方案来重写 URL，例如

将“myurl.com/ApplicationName/Kohls”转换为“myurl.com/ApplicationName/index.html?store=Kohls”，这样我就可以通过查询字符串访问变量“Kohls”。

我目前正在使用 Global.asax，它一直在为上述情况工作 - 但在用户输入 myurl.com/Application 的情况下，我遇到了麻烦，在 Application 之后没有“/”或任何内容。

我目前有这个：

```
 protected void Application_BeginRequest(object sender, EventArgs e)
    {
        String CurrentURLPath = Request.Path.ToUpper();

        Match nothingAfterRoot = Regex.Match(CurrentURLPath, @"/ApplicationName(/)?$", RegexOptions.IgnoreCase);
        if (nothingAfterRoot.Success)
        {
            HttpContext myContext = HttpContext.Current;
            myContext.RewritePath("/ApplicationName/Default.aspx?store=ABC");
        }
        else
        {
            Match match = Regex.Match(CurrentURLPath, @"/ApplicationName(/)?(\w)*$", RegexOptions.IgnoreCase);
            if (match.Success)
            {
                CurrentURLPath = CurrentURLPath.Trim('/');
                String store= CurrentURLPath.Split("ApplicationName/".ToCharArray())[1];
                HttpContext myContext = HttpContext.Current;
                myContext.RewritePath(String.Format("/ApplicationName/Default.aspx?store={0}", store));
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:07:54.203

> .NET 4 中 URL 重写的最佳解决方案是什么

如果可以选择使用 MVC 框架。URL 重写是默认设置。

对于传统的 asp.net 站点，我将 UrlRewritingNet.UrlRewriter.dll 与以下内容一起用于我的 web.config 文件：

```
<configSections>
    <section name="urlrewritingnet" restartOnExternalChanges="true" 
        requirePermission="false" type="UrlRewritingNet.Configuration.UrlRewriteSection, 
        UrlRewritingNet.UrlRewriter" />
</configSections>

<system.web>
    <urlrewritingnet rewriteOnlyVirtualUrls="true" contextItemsPrefix="QueryString" 
         defaultPage="default.aspx" defaultProvider="RegEx"       
         xmlns="http://www.urlrewriting.net/schemas/config/2006/07">
        <rewrites>
          <add name="ArticleUrlRewrite" virtualUrl="^~/a-(.*)-([\w-]*)\.aspx" 
               rewriteUrlParameter="ExcludeFromClientQueryString" 
               destinationUrl="~/article.aspx?id=$1" ignoreCase="true" />
        </rewrites>
    </urlrewritingnet>
</system.web> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:17:42.497

您可以使用 ShortURL-dotnet 将 bit.ly/XXXX 之类的 URL*重写*为*www.mysite.com/index.htm*

它将默认错误页面更改为重定向文件，并且根据该值是否存在，它将您重定向到真实的 URL。

如果您对此解决方案感兴趣，可以在 [http://sourceforge.net/projects/shorturl-dotnet/找到更多信息](http://sourceforge.net/projects/shorturl-dotnet/)

```
using System;
using System.Web;

public partial class Redirection : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        ShortUrl.Container oShortUrl;

        if (ShortUrl.Utils.HasValue(Request.QueryString["page"].ToString())) // checks in case ISAPIRewrite is being used
        {
            oShortUrl = ShortUrl.Utils.RetrieveUrlFromDatabase(Request.QueryString["page"].ToString());
        }
        else // using IIS Custom Errors
        {
            oShortUrl = ShortUrl.Utils.RetrieveUrlFromDatabase(ShortUrl.Utils.InternalShortUrl(Request.Url.ToString()));
        }

        if (oShortUrl.RealUrl != null)
        {
            Response.Redirect(oShortUrl.RealUrl);
        }
        else
        {
            Response.Redirect("MissingUrl.aspx");
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:53:04.167

如上所述，如果可以选择，MVC 是一种很好的方法。

如果您运行的是 IIS 7，则可以使用 URL Rewrite 模块：

[http://learn.iis.net/page.aspx/460/using-the-url-rewrite-module/](http://learn.iis.net/page.aspx/460/using-the-url-rewrite-module/) 和 [http://www.microsoft.com/en-us/download/details.aspx?id=7435](http://www.microsoft.com/en-us/download/details.aspx?id=7435)

如果您正在运行 IIS6，则可以使用上面提到的 urlrewritingnet，或者我更喜欢使用 IIRF：

[http://iirf.codeplex.com/](http://iirf.codeplex.com/)

mod-rewrite 的相似性和基于正则表达式的规则使其非常强大

# java - ebean 映射到 BYTEA 的数据类型是什么？

> ID：11569838
> 
> 赞同：3
> 
> 时间：2012-07-19T21:48:08.487
> 
> 标签：java, file-upload, playframework, playframework-2.0, ebean

我有戏！2.0.2 需要在数据库中存储一些文件的应用程序。我们将 Ebean 用于我们的 ORM。我相信我的数据库中需要一个 BYTEA 列来存储文件，但我不确定在我的模型中使用什么数据类型。

我应该使用某种`Blob`吗？还是只是一个`byte[]`？还是我应该使用另一种数据类型？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-20T06:53:17.747

要使用 Ebean 创建 blob，您需要使用带有 @Lob 注释的字节数组

```
@Lob
public byte[] image; 
```

您需要在 File <-> 字节数组之间进行转换，因此将文件存储在文件系统中可能更容易？（除了在 FS 中存储文件比在 DB 中存储文件更便宜）

# r - 绘制修改后的点和线图 - 可变性为 r 中的“尖峰”图

> ID：11569842
> 
> 赞同：4
> 
> 时间：2012-07-19T21:48:26.323
> 
> 标签：r, graph, ggplot2

在解释细节之前，这是我的数据：

```
set.seed (1234) 
datas <- data.frame (Indv = 1:20, Xvar = rnorm (20, 50, 10),
Yvar = rnorm (20, 30,5), Yvar1 = rnorm (20, 10, 2),
Yvar2 = rnorm (20, 5, 1), Yvar3 = rnorm (20, 100, 20),
Yvar4 = rnorm (20, 15, 3)) 
```

我想准备一个图（Metroglymph），它本质上是点图，但是（Xvar 和 Yvar 的）点（Xvar 和 Yvar）具有从缩放到其余变量（Yvar1、Yvar2、Yvar3、Yvar4）的点的尖峰（线）。每个钉子都是有序的，最好用颜色编码。

```
require(ggplot2)
ggplot(datas, aes(x=Xvar, y=Yvar)) +
    geom_point(shape=1, size = 10) + theme_bw() 
```

![在此处输入图像描述](../Images/7bda48b4faa0bf2c930e7a1e10fb2874.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T23:32:06.977

这是一种可能对您有帮助的方法。它使用`stat_spoke()`来自 ggplot2。您的每个 y 变量都在 4 次单独调用中映射到辐条半径`stat_spoke`。

```
plot_1 = ggplot(datas, aes(x=Xvar, y=Yvar)) +
         stat_spoke(aes(angle=(1/8)*pi, radius=Yvar1), colour="#E41A1C",size=1) +
         stat_spoke(aes(angle=(3/8)*pi, radius=Yvar2), colour="#377EB8",size=1) +
         stat_spoke(aes(angle=(5/8)*pi, radius=Yvar3), colour="#4DAF4A",size=1) +
         stat_spoke(aes(angle=(7/8)*pi, radius=Yvar4), colour="#984EA3",size=1) +
         geom_point(shape=1, size = 10)

ggsave("plot_1.png", plot_1) 
```

![在此处输入图像描述](../Images/daef66e0fe2214de213357a517e82a92.png)

根据您的数据和特定需求，转换变量以使其更适合绘图可能是有意义的。

```
normalize = function(x) {
    new_x = (x - mean(x)) / sd(x)
    new_x = new_x + abs(min(new_x))
    return(new_x)
}

plot_2 = ggplot(datas, aes(x=Xvar, y=Yvar)) +
         stat_spoke(aes(angle=(1/8)*pi, radius=normalize(Yvar1)), colour="#E41A1C", size=1) +
         stat_spoke(aes(angle=(3/8)*pi, radius=normalize(Yvar2)), colour="#377EB8", size=1) +
         stat_spoke(aes(angle=(5/8)*pi, radius=normalize(Yvar3)), colour="#4DAF4A", size=1) +
         stat_spoke(aes(angle=(7/8)*pi, radius=normalize(Yvar4)), colour="#984EA3", size=1) +
         geom_point(shape=1, size = 10)

ggsave("plot_2.png", plot_2) 
```

![在此处输入图像描述](../Images/94c08a762ee3e854984e7b57b80d52f6.png)

**重要警告：**对于相同的辐条半径值，如果线更垂直，则绘制线的幅度会更大，如果线更水平，则绘制线的幅度会更小。这是因为 x 的范围大约是数据集 y 范围的两倍。随着 x 与 y 轴比的变化，绘制的角度也变得扭曲。添加`coord_equal(ratio=1)`解决了这个问题，但可能会引入其他问题。 ![在此处输入图像描述](../Images/a496b8dc81549cd7b08e3796f7c4c3d7.png)

## **编辑：无循环绘图**

这很有趣，也很有教育意义。键入重复的代码可能会更省时！如果有人可以提供改进此代码的建议，请发表评论。

```
library(reshape2)

dat2 = melt(datas, id.vars=c("Indv", "Xvar", "Yvar"), 
            variable.name="spoke_var", value.name="spoke_value")

# Apply normalization in a loop. Can plyr do this more gracefully?.
for (var_name in levels(dat2$spoke_var)) {
    select_rows = dat2$spoke_var == var_name
    norm_dat = normalize(dat2[select_rows, "spoke_value"])
    dat2[select_rows, "spoke_value"] = norm_dat
}

# Pick an angle for each Yvar, then add angle column to dat2.
tmp = data.frame(spoke_var=unique(dat2$spoke_var))
tmp$spoke_angle = seq(from=pi/8, by=pi/4, length.out=nrow(tmp))
dat2 = merge(dat2, tmp)

plot_4 = ggplot(dat2, aes(x=Xvar, y=Yvar)) +
         stat_spoke(data=dat2, size=1,
                    aes(colour=spoke_var, angle=spoke_angle, radius=spoke_value)) +
         geom_point(data=datas, aes(x=Xvar, y=Yvar), shape=1, size=7) +
         coord_equal(ratio=1) +
         scale_colour_brewer(palette="Set1") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-20T00:05:22.667

这是更多手动方法：

```
set.seed (1234)
datas <- data.frame (Indv = 1:20, Xvar = rnorm (20, 50, 10),
Yvar = rnorm (20, 30,5), Yvar1 = rnorm (20, 10, 2),
Yvar2 = rnorm (20, 5, 1), Yvar3 = rnorm (20, 100, 20),
Yvar4 = rnorm (20, 15, 3))
datas$SYvar1 <- 2 + scale (datas$Yvar1)
datas$SYvar2 <- 2 +  scale (datas$Yvar2)
datas$SYvar3 <- 2 + scale (datas$Yvar3)
datas$SYvar4 <- 2 +  scale (datas$Yvar4)

    require(ggplot2)
    p <- ggplot(datas, aes(x=Xvar, y=Yvar)) +  
   geom_point(size = 10, pch = 19, col = "yellow2")
    p + geom_segment(aes(x = Xvar, y = Yvar, xend = Xvar + SYvar1, 
   yend = Yvar), col = "red4", size = 1) +
    geom_segment(aes(x = Xvar, y = Yvar, xend = Xvar, 
    yend = Yvar + SYvar2), col = "green4", size = 1) +
    geom_segment(aes(x = Xvar, y = Yvar, xend = Xvar-2.5,
    yend = Yvar + SYvar3), col = "darkblue", size = 1) +
    geom_segment(aes(x = Xvar, y = Yvar, xend = 
     Xvar - SYvar4, yend = Yvar ), col = "red", size = 1) +
    theme_bw() 
```

![在此处输入图像描述](../Images/f6ad1927a6da074a44231847f525d4fd.png)

# jquery - 删除所有非 br 和 span 标签？

> ID：11569843
> 
> 赞同：1
> 
> 时间：2012-07-19T21:48:26.557
> 
> 标签：jquery, ajax

有什么方法可以从 html 字符串中删除所有非 span 和非 br html 标签？但是将文本保留在其中？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:52:02.580

试试这个：

```
$(elem).find('*').not('br, span').unwrap() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T14:49:30.840

我用了：

```
$content = $(elem);
$content.find(':not(br, span)').contents().unwrap();
$content.find(':not(br, span)').remove() 
```

第一行解开所有有内容的元素（如`<span>some text</span>`），第二行将删除所有剩余的没有内容的元素（如`<hr />`,`<img />`等）

# jquery - 在列表的开头/结尾禁用下一个/上一个

> ID：11569846
> 
> 赞同：1
> 
> 时间：2012-07-19T21:48:52.350
> 
> 标签：jquery, traversal

我希望能够在第一个框中隐藏/禁用上一个链接并在最后一个框中禁用下一个链接，因为此时您可以继续单击最后一个框的下一个，当您这样做时它会中断为单击上一个不再起作用。[在小提琴中查看演示](http://jsfiddle.net/aaronk85/FmQNZ/)

```
<span id="wrapper">
<span id="prev"><a href="#">Go to Prev</a></span>
<span id="content">
    <div class="box">1</div>
    <div class="box">2</div>
    <div class="box">3</div>
    <div class="box">4</div>
    <div class="box">5</div>
    <div id="start" class="box">6</div>
    <div class="box">7</div>
</span>
<span id="next"><a href="#">Go to Next</a></span> 
```

```
 var $curr = $("#start");
$curr.css("display", "inline");
$("#prev a").click(function () {
  $curr = $curr.prev();
  $(".box").css("display", "");
  $curr.css("display", "inline");
});

$("#next a").click(function () {
  $curr = $curr.next();
  $(".box").css("display", "");
  $curr.css("display", "inline");
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:58:16.447

**编辑**以尊重您的项目需求：

## *[jsFiddle 演示（隐藏按钮）](http://jsfiddle.net/LBzK7/3/)*

```
var currN = 5;
var boxN = $('#content .box').length;
$('#content .box').eq(currN).show();

function displayBox(){
    pr= currN === 0      ? $('#prev').hide() : $('#prev').show() ;
    nx= currN === boxN-1 ? $('#next').hide() : $('#next').show() ;
    $('.box').eq(currN).show().siblings().hide();
}

$("#prev, #next").click(function () {
    var whichBtn = this.id==='next' ? currN++ : currN--;
    displayBox();
}); 
```

* * *

你不需要禁用你的按钮，做一个**循环！**

## *[jsFiddle 演示](http://jsfiddle.net/LBzK7/)*

```
var $curr = $("#start");
var currN = $curr.index();
var boxN = $('#content .box').length;

$curr.css("display", "inline");

function displayBox(){
    if(currN === -1){
        currN = boxN-1;
    }else{
       currN = currN % boxN;
    }
    $('.box').eq(currN).show().siblings().hide();
}

$("#prev a").click(function () {
    currN--;
    displayBox();
});

$("#next a").click(function () {
    currN++;
    displayBox();
}); 
```

* * *

我在这里创建了一个简化版本（你不需要`#start`）：

## *[jsFiddle 演示 2（简化）](http://jsfiddle.net/LBzK7/1/)*

这就是你所需要的：

```
var currN = 5;   // set here start slide! (zero index based)
var boxN = $('#content .box').length;
$('#content .box').eq(currN).show();

function displayBox(){
    var curBox = currN === -1 ? currN=boxN-1 : currN=currN%boxN;
    $('.box').eq(currN).show().siblings().hide();
}

$("#prev, #next").click(function () {
    var whichBtn = this.id==='next' ? currN++ : currN--
    displayBox();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T21:55:53.240

我会这样做：

[http://jsfiddle.net/mBXYL/](http://jsfiddle.net/mBXYL/)

```
var $curr = $("#start");
$curr.css("display", "inline");
$("#prev a").click(function() {
    $curr = $curr.prev();
    $(".box").css("display", "");
    $curr.css("display", "inline");
    $("#next").show();
    if (!$curr.prev().length) {
        $("#prev").hide();
    }
});

$("#next a").click(function() {
    $curr = $curr.next();
    $(".box").css("display", "");
    $curr.css("display", "inline");
    $("#prev").show();
    if (!$curr.next().length) {
        $("#next").hide();
    }
});​ 
```

# css - 如何使用流体中心（充分利用空间）和侧边栏上的可变长度制作 3 列布局

> ID：11569847
> 
> 赞同：0
> 
> 时间：2012-07-19T21:48:53.487
> 
> 标签：css

如何制作具有流体中心（充分利用空间）和侧边栏可变长度的 3 列布局？

侧边栏的宽度取决于句子的长度，因此没有固定的宽度。

中心列将占据剩余的可用空间。

使用“table”标签可以轻松完成。我不知道如何在 CSS 中做到这一点。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T22:43:23.410

这有帮助吗？： http: [//jsfiddle.net/eNDPG/1/](http://jsfiddle.net/eNDPG/1/)

# python - Python interpreting a string or SMS to match words

> ID：11569852
> 
> 赞同：0
> 
> 时间：2012-07-19T21:49:18.820
> 
> 标签：python, regex

> **Possible Duplicate:**
> [Matching incorrectly spelt words with correct ones in python](https://stackoverflow.com/questions/11563615/matching-incorrectly-spelt-words-with-correct-ones-in-python)

I have to interpret an incoming SMS that looks something like these:

SHOP NAME : CITY

Annies pet shop new york

Budds Calerfonia

Kelvins Boat Shop San Fransico

Karel Boom West palm beach

I have a list of cities and a list of shop names that I have to compare the sms with, if the shop name is there, great, is the city is there, perfect.

Now the thing is, people will spell these wrong etc. And because there is no separator like a comma, how would i know where the word is, starts and stops ?

I have looked at using the levenshtein function, and that returns the closest match in a list. But what if there is no match? Then I have to tell the user, sory, nothing matches your sms etc etc.

How will you go about doing that? Bare in mind, each sms campaign might have different number of parameters.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T12:40:14.063

1）我认为没有办法修复所有错误，你需要决定你要修复什么样的错误以及可以用于数据的格式。不要让它太模糊。对于非常模糊的预测，您可能会认为垃圾是有效的，并且很难理解决策路径和修复错误。

2) 有几种模糊匹配方式。我建议您接下来查看：[https ://stackoverflow.com/questions/682367/good-python-modules-for-fuzzy-string-comparison](https://stackoverflow.com/questions/682367/good-python-modules-for-fuzzy-string-comparison)

3）将所有空格换行符和额外字符替换为单个空格。标记您的文本会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T12:37:49.163

如果没有匹配，那么您可以手动检查短信或自动发回短信，表明商店/城市无法识别。如果您识别其中一个，则可以添加一些规则以猜测另一个参数。例如，如果城市被识别，然后查看该城市是否只有一家商店并自动添加...我建议您在属性之间添加某种分隔符..例如用逗号`SHOP, CITY`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-20T12:23:41.240

如果传入的 SMS 在每行之后都有 \n，您可以将其拆分。

# python - Django: assigning a foreignKey object a value of current user

> ID：11569855
> 
> 赞同：1
> 
> 时间：2012-07-19T21:49:31.520
> 
> 标签：python, django, django-admin

I'm trying to override the `save()` method in the admin so when my publisher-users are creating their customer-users, the publisher field is automatically assigned a value of current user.

```
ValueError: Cannot assign "User: foo": "SimpleSubscriber.publisher" must be a "Publisher" instance. 
```

I used this tutorial to get started: [here.](http://www.b-list.org/weblog/2008/dec/24/admin/)

```
def save_model(self, request, obj, form, change):
    if not change:
        obj.publisher = request.user
    obj.save() 
```

this is the save method override. The only users who can access the admin are publishers, and both the Publisher and SimpleSubscriber models are user models:

```
class Publisher(User):
    def __unicode__(self):
        return self.get_full_name()

class SimpleSubscriber(User):
    publisher = models.ForeignKey(Publisher)
    address = models.CharField(max_length=200)
    city = models.CharField(max_length=100)
    state = USStateField()
    zipcode = models.CharField(max_length=9)
    phone = models.CharField(max_length=10)
    date_created = models.DateField(null=True)
    sub_type = models.ForeignKey(Product)
    sub_startdate = models.DateField()
    def __unicode__(self):
        return self.last_name 
```

What can I replace `request.user` with in order to assign each new SimpleSubscriber to the current publisher user?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T21:57:04.520

您必须替换`request.user`为`Publisher`.

一种方法是：

```
Publisher.objects.get(**{Publisher._meta.get_ancestor_link(User).name: request.user}) 
```

当然，它会在您每次调用它时进行查找，因此您可能希望将您的应用程序设计为对每个请求执行此操作。

另一种方法是（稍微）滥用 django 模型系统——其中一个模型从另一个模型继承，相应的父模型实例和子模型实例具有相同的`id`（默认情况下）；

```
Publisher.objects.get(id = request.user.id) 
```

# c# - Restrict generic parameter on interface to subclass

> ID：11569857
> 
> 赞同：10
> 
> 时间：2012-07-19T21:49:46.253
> 
> 标签：c#, generics, parameters, restrictions

The following is contrived, but bear with me:

```
interface Clonable<TSubClass>
{
    TSubClass Clone();
} 
```

How can I restrict TSubClass to be of the implementing type?

i.e only let the implementor do this:

```
class Dog : Clonable<Dog>
{
    Dog Clone() 
    {
        ....
    }
} 
```

Not this:

```
class BadDog : Clonable<Rabbit>
{
    Rabbit Clone()
    {
        ....
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-19T21:54:46.573

你[不能](http://blogs.msdn.com/b/ericlippert/archive/2011/02/03/curiouser-and-curiouser.aspx)强制执行，只能通过约定和文档......

我的惯例是使用类似`TSelf`.

```
interface ICloneable<TSelf> where TSelf : ICloneable<TSelf> { ... } 
```

另请注意，任何实现或继承此接口的非具体构造都应通过...传递约束

```
[Serializable]
abstract class SerializableCloneable<TSelf> : ICloneable<TSelf> 
  where TSelf : SerializableCloneable<TSelf> { ... } 
```

**注意**：我已经在[NRoles](http://code.google.com/p/nroles/)中使用调用你的[self-type parameter`S`](http://codecrafter.blogspot.ca/2012/06/self-types-in-nroles.html)的约定实现了这个检查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-19T22:22:38.003

您不能在编译时强制执行此操作，因为 .NET 泛型没有模板特化或鸭子类型。

但是，您可以包含一个静态构造函数（类型初始化程序），该构造函数使用反射在加载时断言关系。好的，C# 不允许您在接口上放置静态构造函数（即使 .NET 确实允许），因此您需要使用模块初始化程序或您自己调用的函数。此外，您还需要搜索实现接口的类型，包括尚未加载的类型（您可以订阅`Assembly.Load`事件，以便在将来加载类型时得到通知）。

# php - PHP Session variables resetting with each page load

> ID：11569858
> 
> 赞同：0
> 
> 时间：2012-07-19T21:49:48.343
> 
> 标签：php, session

My session variables are resetting every time I load a new page.

I have included a `header.php` file to each script with the `session_start()` function at the very top like so:

```
session_start();
error_reporting(E_ERROR); 
```

I have also checked to make sure that the `session_id` is the same across all pages and it is.

I checked my web host's php_ini config file and I saw that the `session.save_path` was set to `/tmp`. I changed it to `/var/lib/session/` like someone had suggested on this site and I began to get odd warnings in my code.

> **Warning**: session_start() [function.session-start]: open(/var/lib/php/session//sess_97fca6d21c7ffa8333cd42eaa87f2eac, O_RDWR) failed: Permission denied (13) in **/home/mforsyth/public_html/Beesting/header.php** on line **2**

I do not know what to do to fix this problem. Any help would be useful. If more details are needed please let me know.

EDIT: I have changed the folder back to /tmp and have made sure i can read/write into it and I can. I have also echoed the session id on every page and it all comes out the same. Also it seems that the session only lasts for one page

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:56:24.187

发生的事情是 php 尝试使用它写入 ThinkingMonkey 提到的目录的一些信息来跟踪您的会话。

由于 php/webserver 进程的用户无法写入该目录，因此失败。因此，您没有获得会话。

找出进程在哪个用户下运行，并授予他对该目录的读/写权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-20T20:35:38.313

谢谢您的帮助。在进一步调查并与我的主人讨论此事后，我能够得出结论，问题不在于写入 /tmp 文件夹的能力。实际上问题出在我的 header.php 包含文件中的一个 javascript 函数。

```
function logout()
{
    <?
session_destroy();
?>
alert("you have been logged out");
} 
```

它避免了它在函数中的事实，这可能是我看到两种语言的编译方式不同的错。我做了一个简单的 ajax 调用来处理会话销毁，现在一切都很好。我想知道那里是否还有其他人有类似的问题，这是否对他们有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-20T09:25:37.940

尝试重启webserver和php服务，如果是nginx/php-fpm，试试

```
root@server > service nginx restart
root@server > service php-fpm restart 
```

这应该够了吧！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-07T20:47:18.913

有同样的一般问题，结果出于某种原因我使用 JavaScript 来删除会话 cookie。

```
document.cookie = '[session_name]' +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;'; 
```

# javascript - Where can I find a plugin that will zoom in and out a div's content with a slider?

> ID：11569860
> 
> 赞同：0
> 
> 时间：2012-07-19T21:50:06.750
> 
> 标签：javascript, jquery

Are there any plugins that allows zooming in and out a div and it's content via a slider?

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:56:36.270

请使用 JQUERY 参考这个漂亮的缩放滑块。它可以帮助你

[缩放滑块](http://tympanus.net/codrops/2010/12/27/portfolio-zoom-slider/)

# android - 两次发送相同的短信

> ID：11569866
> 
> 赞同：2
> 
> 时间：2012-07-19T21:50:34.377
> 
> 标签：android, android-emulator, sms

我正在尝试制作一个 sms android 应用程序，但我遇到了一个我以前从未见过的错误，即使在谷歌中我也没有找到类似的东西。所以，如果你能帮助我...我会很高兴

由于某种原因，该程序同时发送两条消息（相同的短信）。但它只发生在生产中。当我使用模拟器时，一切正常！它只发送一次短信...

我试过很多手机和很多电话运营商，但错误总是发生。我真的不知道如何发现正在发生的事情，因为它只发生在真实手机中而不是模拟器中......

**代码如下：**

```
private void sendSMS(String phoneNumber, String message, Context context) {
    ContextWrapper cw = new ContextWrapper(context);
    Context baseContext = cw.getBaseContext();

    Intent intentSMS = new Intent(baseContext, SMSManagerService.class);
    intentSMS.putExtra("celNumber", phoneNumber);
    intentSMS.putExtra("textMessage", message);

    Random s = new Random(System.currentTimeMillis());
    PendingIntent pendingIntent = PendingIntent.getService(cw, s.nextInt(), intentSMS, PendingIntent.FLAG_ONE_SHOT);
    try {
        pendingIntent.send();
    } catch (CanceledException e) {
    }
} 
```

SMSManagerService.class

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Bundle intentExtras = intent.getExtras();
    if (intentExtras != null) {
        String phoneNumber = intentExtras.getString("celNumber");
        String message = intentExtras.getString("textMessage");

        if (isContentValid(phoneNumber, message)) {
            sendSMS(phoneNumber, message);
        }
    }

    return super.onStartCommand(intent, flags, startId);
}

 private void sendSMS(String phoneNumber, String message) {
    sentPI = registerSMSSent(phoneNumber, message);
    deliveredPI = registerSMSdelivered();

    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber, null, message, sentPI, deliveredPI);
} 
```

所以..任何人...任何提示？！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:07:19.960

嗨 :) 好吧，我可能是错的，但没有`pendingIntent.send();`发送消息？另外，在调试模式下，试着看看 LogCat 说什么 :) 也许你会在那里找到答案 ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T20:47:35.333

也许你会在[这里](http://developer.android.com/reference/android/telephony/SmsManager.html)找到答案，这种[教程](https://sites.google.com/site/androidappcourse/labs/lab-7)也很有用

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T08:19:00.260

我没有立即看到这里有什么问题。你能把你的电脑和你的安卓手机连接起来，在你的代码中的某个地方放一个换行符，然后用这种方式调试吗？这样，您可以`sendSMS`两次检查它是如何进入 SMSManagerService.class 的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-25T21:16:38.107

只是为了澄清问题并给出答案......

这是运行 sms 应用程序的 android 上的错误，具体取决于手机和 android 版本。

该错误与此处相关： [Google code Android inssues](https://code.google.com/p/android/issues/detail?id=26953)

一种可能的，这对我有用，在这里相关： [Android sendTextMessage 在执行时发送两条相同的消息，如何解决？](https://stackoverflow.com/questions/9706039/android-sendtextmessage-sends-two-identical-messages-on-exceution-how-to-fix)

# iphone - Tint of UIBarButtonItem doesn't match color I set

> ID：11569871
> 
> 赞同：1
> 
> 时间：2012-07-19T21:50:39.353
> 
> 标签：iphone, xcode, uibarbuttonitem, uicolor, tint

The background color for my view in RGB format is R: 111/255 G: 209/255 B: 229/255

I tried setting the tint of the UIBarButtonItem using:

```
CGFloat nRed=111.0/255.0;
CGFloat nGreen=209.0/255.0;
CGFloat nBlue=229/255.0;
UIColor *myColor=[[UIColor alloc]initWithRed:nRed green:nBlue blue:nGreen alpha:1];
[[UIBarButtonItem appearance] setTintColor:myColor]; 
```

The color does change for all the UIBarButtonItems I have in the project...but it is still noticeably different from the color of my background. Any thoughts?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:59:54.313

您不需要调用该`appearance`方法。只需这样做：

```
//Suppose you have a variable barButtonItem
barButtonItem.tintColor = [UIColor blueColor]; 
```

# php - Javascript 和 PHP 将数据导出到文件

> ID：11569875
> 
> 赞同：3
> 
> 时间：2012-07-19T21:50:51.130
> 
> 标签：php, javascript

我有一个按钮。通过单击按钮，我想将网页上显示的一些数据导出到文件以供下载。

我这样做是这样的：我有一个`export.php`. 我将数据作为参数发送到 PHP 文件（另一个参数是文件名），PHP 服务器创建一个文件并写入数据，然后发送文件。代码就像：

```
$filename = $_GET['filename'] . '.csv';
$export = $_GET['export'];
$writer = fopen($filename, 'w') or die('cannot create');
fwrite($writer, $export . "\n");
fclose($writer);

header('Content-Type: text/csv');
header('Content-Disposition: attachment; filename='.basename($filename));
readfile($filename);
unlink($filename);

exit(); 
```

对于数据较短的情况，它可以正常工作。但是如果数据很长，由于数据是作为 URL 的一部分传递的，我会得到“Request-URI Too Large”错误。

有没有其他方法可以做到这一点？是否可以使用 JavaScript 直接写入数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-19T21:59:10.320

听起来您正在使用 GET 发送到 export.php，而您应该使用 POST。GET 限制为 2048 个字符，而 POST 则不受限制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:02:01.607

您需要将数据发布到服务器。将您的 FORM 标记中的 METHOD 更改为 POST（在您的 html 中而不是您的 php 代码中）。

每个浏览器都会限制查询字符串的大小/URL 的长度，并且该限制[取决于浏览器](https://stackoverflow.com/questions/812925/what-is-the-maximum-possible-length-of-a-query-string)。但是，您可以将大量数据发布到服务器。唯一的限制是用户的上行带宽和他们的耐心有多快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-19T22:03:56.330

不要将数据作为查询字符串传递，而是使用 javascript 创建一个 iframe 并构建一个表单，然后将其发布到 php 文件。

如果你使用 jquery 有一个很好的教程[http://tutorialzine.com/2011/05/generating-files-javascript-php/](http://tutorialzine.com/2011/05/generating-files-javascript-php/)

# ruby-on-rails - Rails 3.2 友好的 url 按日期路由

> ID：11569876
> 
> 赞同：5
> 
> 时间：2012-07-19T21:50:54.343
> 
> 标签：ruby-on-rails, ruby-on-rails-3, url-routing

我想实现 blog\news 应用程序，它能够：

1.  显示根目录下的所有帖子：`example.com/`
2.  显示所有回答某年的帖子：`example.com/2012/`
3.  显示所有回答某年某月的帖子：`example.com/2012/07/`
4.  按日期和标签显示一些帖子：`example.com/2012/07/slug-of-the-post`

所以我为`routes.rb`文件创建了一个模型：

```
# GET /?page=1
root :to => "posts#index"

match "/posts" => redirect("/")
match "/posts/" => redirect("/")

# Get /posts/2012/?page=1
match "/posts/:year", :to => "posts#index",
  :constraints => { :year => /\d{4}/ }

# Get /posts/2012/07/?page=1
match "/posts/:year/:month", :to => "posts#index",
  :constraints => { :year => /\d{4}/, :month => /\d{1,2}/ }

# Get /posts/2012/07/slug-of-the-post
match "/posts/:year/:month/:slug", :to => "posts#show", :as => :post,
  :constraints => { :year => /\d{4}/, :month => /\d{1,2}/, :slug => /[a-z0-9\-]+/ } 
```

所以我应该在`index`行动中使用参数，并通过行动中的 slug 来发布`show`（检查日期是否正确是一个选项）：

```
# GET /posts?page=1
def index
  #render :text => "posts#index<br/><br/>#{params.to_s}"
  @posts = Post.order('created_at DESC').page(params[:page])
  # sould be more complicated in future
end

# GET /posts/2012/07/19/slug
def show
  #render :text => "posts#show<br/><br/>#{params.to_s}"
  @post = Post.find_by_slug(params[:slug])
end 
```

我还必须`to_param`为我的模型实现：

```
def to_param
  "#{created_at.year}/#{created_at.month}/#{slug}"
end 
```

这就是我在 api/guides/SO 中通宵搜索所学到的全部内容。

但问题是*奇怪的事情不断发生*，因为我刚接触 Rails：

1.  当我去时`localhost/`，应用程序中断并说它已调用`show`操作但数据库中的第一个对象已被接收为：年（原文如此！）：

    ```
    No route matches {:controller=>"posts", :action=>"show", :year=>#<Post id: 12, slug: "*", title: "*", content: "*", created_at: "2012-07-19 15:25:38", updated_at: "2012-07-19 15:25:38">} 
    ```

2.  当我去`localhost/posts/2012/07/cut-test`同样的事情发生时：

    ```
    No route matches {:controller=>"posts", :action=>"show", :year=>#<Post id: 12, slug: "*", title: "*", content: "*", created_at: "2012-07-19 15:25:38", updated_at: "2012-07-19 15:25:38">} 
    ```

我觉得有一些很简单的东西我没有做过，但我找不到它是什么。

无论如何，这篇文章在解决后会很有帮助，因为只有 url 中没有日期的 slug 和类似但没有用的问题的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-20T13:40:25.600

问题出在 post 的路径助手使用 as 中，因为第一个*参数*`post_path(post)`必须是 year，因为我`:as => :post`在.*`routes.rb`*

 *尽管如此，为了使整个解决方案清晰，这里需要采取一些措施来使所有这些都正常工作：

1.  您必须为每个匹配项添加正确的路径助手名称，例如

    ```
    # Get /posts/2012/07/slug-of-the-post
    match "/posts/:year/:month/:slug", <...>,
      :as => :post_date 
    ```

    现在您可以`post_date_path("2012","12","end-of-the-world-is-near")`在视图中使用。

    ,相同`posts_path`，如果命名正确的话。`posts_year_path("2012")``posts_month_path("2012","12")`

    我建议不要`:as => :post`在该匹配中使用，也不要`to_param`在模型文件中创建，因为它可能会破坏您不期望的东西（`active_admin`对我而言）。

2.  控制器文件`posts-controller.rb`应填写需要提取和检查日期正确性的帖子。尽管如此，在这种状态下它是可以的并且没有破坏任何东西。

3.  模型文件`posts.rb`应填写正确格式的年月提取，例如：

    ```
    def year
      created_at.year
    end

    def month
      created_at.strftime("%m")
    end 
    ```

    `to_param`正如我已经注意到的那样，没有真正需要的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T05:05:41.210

这是您的完整 routes.rb 文件吗？听起来你可能有一个前面的`resources :posts`条目，它基本上匹配`/posts/:id`. 此外，我从您发布的路由文件中看不到任何可能导致从根路径重定向到帖子的内容，因此它必须是其他内容。*

# vba - VBA Like operator with curly brackets

> ID：11569878
> 
> 赞同：1
> 
> 时间：2012-07-19T21:51:14.240
> 
> 标签：vba, ms-word

In VBA (for Word), I am trying to test the beginning of a string for roman numerals.

The following code works (e.g., to test whether the string "Mystr" contains the roman numeral "I"):

```
If Mystr Like "[A-Z]" Then 
.Style = "Heading 1" End If 
```

The following code does not work (e.g., to test whether Mystr contains the roman numeral "II" or "III"):

```
If Mystr Like "[A-Z]{1,2,3}" Then
.Style = "Heading 1" End If 
```

Does "Like" not accept curly brackets? If not, how could I achieve the same result?

Thank you.

# java - JFrame Resizing

> ID：11569879
> 
> 赞同：2
> 
> 时间：2012-07-19T21:51:16.140
> 
> 标签：java, swing, user-interface, jframe, miglayout

I switched to the MigLayout and when I drag the window smaller the components resize, but when I drag it bigger than the size when I start the program, they don't get bigger. How do I make it so it resizes bigger and smaller?

```
public SpriteEditor() {
    SubstanceColorChooserUI col = new SubstanceColorChooserUI();
    while (mode == 0);
    setResizable(true);
    setTitle("DawnGuard Index 32/34 Editor");
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setSize(483, 374);
    setLocationRelativeTo(null);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    setContentPane(contentPane);

    textField = new JTextField();
    textField.setColumns(10);

    JButton btnLoadCache = new JButton("Load cache");
    btnLoadCache.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            try {
                String loc = textField.getText();
                if (loc.equals("")) {
                    JOptionPane.showMessageDialog(SpriteEditor.this, "Please specify a location for the cache.", "Unable to load", JOptionPane.ERROR_MESSAGE);
                    return;
                }
                if (!loc.endsWith("\\"))
                    loc = loc + "\\";
                cache = new Store(loc);
                loadImages();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(SpriteEditor.this, "Cache failed to initialize.\n" + e.getMessage(), "Unable to load", JOptionPane.ERROR_MESSAGE);
            }
        }
    });

    JSplitPane splitPane = new JSplitPane();
    splitPane.setDividerLocation(150);
    splitPane.setContinuousLayout(true);

    JPanel panellie = new JPanel();
    panellie.setLayout(new BorderLayout(0, 0));
    panel = new ImagePanel(null);

    scrollPane_1 = new JScrollPane();
    panellie.add(scrollPane_1, "Center");

    scrollPane_1.setViewportView(panel);
    splitPane.setRightComponent(panellie);

    JPanel panel_1 = new JPanel();
    splitPane.setLeftComponent(panel_1);
    panel_1.setLayout(new BorderLayout(0, 0));

    JScrollPane scrollPane = new JScrollPane();
    panel_1.add(scrollPane, BorderLayout.CENTER);

    model = new DefaultListModel<ListedImage>();
    list = new JList<ListedImage>(model);
    list.addListSelectionListener(new ListSelectionListener() {
        public void valueChanged(ListSelectionEvent arg0) {
            if (arg0.getValueIsAdjusting())
                return;
            ListedImage img = list.getModel().getElementAt(list.getSelectedIndex());
            panel.setImage(img.getImage());
        }
    });
    scrollPane.setViewportView(list);

    progressBar = new JProgressBar();
    progressBar.setStringPainted(true);
    progressBar.setDoubleBuffered(true);

    contentPane.setLayout(new MigLayout("", "[328px][13px][112px]", "[23px][279px][14px]"));
    contentPane.add(textField, "cell 0 0,growx,aligny center");
    contentPane.add(btnLoadCache, "cell 2 0,growx,aligny top");
    contentPane.add(splitPane, "cell 0 1 3 1,grow");
    contentPane.add(progressBar, "cell 0 2 3 1,grow");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-05T21:29:39.033

在布局定义中，您有：

```
contentPane.setLayout(new MigLayout("", "[328px][13px][112px]", "[23px][279px][14px]")); 
```

好吧，您可以尝试告诉布局填充布局约束`fill`，现在您应该告诉当面板随着行/列约束增长时应该增长哪些列和行`grow`。所以...

```
contentPane.setLayout(new MigLayout("fill", "[328px, grow][13px][112px]", "[23px][279px, grow][14px]")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T21:58:27.883

我猜最大尺寸太小了，您正在尝试设置比对象的最大尺寸更大的尺寸。尝试设置最大宽度和最大高度。祝你好运。

# php - Marking choices as selected when using choice Field Type in Symfony2

> ID：11569881
> 
> 赞同：0
> 
> 时间：2012-07-19T21:51:27.057
> 
> 标签：php, symfony

So, I'm building a small form with a choice. However, I want to pre-select some of those options, as if I was applying `selected="selected"`. I could not find how can this be done in the docs. Help? :D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T08:31:25.243

要为表单设置默认值，需要在表单的基础数据类中设置这些值。假设底层数据类是一个实体，则可以在构造时在该实体中默认值。如果您不使用实体注释并且不想更改生成的实体类，则可以将默认值设置为实体类的新实例并将其用作表单的数据。

例如，对于具有角色数组和方法 setRoles(array $roles) 的用户实体，可以在用户实体的构造函数中默认角色，如下所示（为清楚起见，使用硬编码字符串）：

```
public function __construct()
{
    $this->setRoles(array('ROLE_USER', 'ROLE_READER', 'ROLE_EDITOR');
} 
```

或者，可以在表单显示之前在控制器中默认角色（没有表单类和硬编码字符串的简单示例）：

```
$allRoles = array('ROLE_USER', 'ROLE_READER', 'ROLE_EDITOR', 'ROLE_ADMIN', 'ROLE_SUPER_ADMIN');

$user = new User();
$user->setRoles(array('ROLE_USER', 'ROLE_READER', 'ROLE_EDITOR');

$form = $this->createFormBuilder($user)
    ->add('username', 'text')
    ->add('roles', 'choice',  array('choices' => array_combine($allRoles, $allRoles),
                                    'multiple' => true)
    ->getForm();

return $this->render('AcmeTaskBundle:Default:new.html.twig', array(
    'form' => $form->createView(),
)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-26T18:18:03.163

最终比我想象的要简单：

```
$form['form[selectionMenu]']->select(1); 
```

# sql - Can't attach the sample database in SQL Server 2012

> ID：11569882
> 
> 赞同：1
> 
> 时间：2012-07-19T21:51:29.340
> 
> 标签：sql, sql-server, sql-server-2012, sql-server-2012-express

I have downloaded the sample database for SQL Server 2012 Express but I am having the following error message whenever I try to attach it:

> The database 'AdventureWorks2012' cannot be opened because it is version 706\. This server supports version 655 and earlier. A downgrade path is not supported.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T21:52:27.257

Sounds like the server you are trying to attach the database to is not SQL Server 2012\. This may be the version of Management Studio / Management Studio Express you're using, but I suspect `SELECT @@VERSION;` will tell you something different. It may just be a connection string mixup if you have multiple instances of SQL Server installed, otherwise you should [download and install SQL Server 2012 Express from here](http://www.microsoft.com/en-us/download/details.aspx?id=29062).

# objective-c - Why is my delegate method being sent to its parent view after being sent to the delegate?

> ID：11569883
> 
> 赞同：0
> 
> 时间：2012-07-19T21:51:33.430
> 
> 标签：objective-c, ios, delegates

I apologise ahead of time for the question title. I'm not quite sure how to succinctly describe my issue.

I'm having trouble with this delegate method I set up. I'm trying present a simple login screen modally. My issue is my login view gets a method called to it after I dismiss it.

Specifically, Xcode logs this:

```
*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[LoginViewController login:]: unrecognized selector sent to instance [memory address]' 
```

LoginViewController.h

```
#import <UIKit/UIKit.h>

@protocol LoginViewControllerProtocol;

@interface LoginViewController : UIViewController

@property (weak, nonatomic) IBOutlet UITextField *userNameTextField;
@property (weak, nonatomic) IBOutlet UITextField *userPasswordTextField;
@property (weak, nonatomic) IBOutlet UIButton *loginButton;
@property (nonatomic, weak) NSObject<LoginViewControllerProtocol> *loginViewControllerDelegate;

@end

@protocol LoginViewControllerProtocol <NSObject>
- (void)loginViewController:(LoginViewController *)controller didLogin:(NSString *)userName;
@end 
```

LoginViewController.m

```
- (IBAction)login
{
   if ([self.loginViewControllerDelegate respondsToSelector:@selector(loginViewController:didLogin:)]) {
        [self.loginViewControllerDelegate loginViewController:self didLogin:self.userNameTextField.text];              
    }
} 
```

The delegate: (TestViewController.m)

```
- (void)loginViewController:(LoginViewController *)controller didLogin:(NSString *)userName
{
    [self dismissModalViewControllerAnimated: YES]; 
    didLogIn = YES;

} 
```

I can't see why the delegate method is being sent back to the dismissed view.

Any help would be greatly appreciated!

Edit: I apologise for leaving this out. This occurs in the view controller that calls LoginViewController. The delegate method also exists here.

TestViewController.m

```
if (!didLogIn) {
        //launch login view modally
        LoginViewController* loginController = [[LoginViewController alloc] initWithNibName: @"LoginViewController" bundle: nil]; 
        loginController.loginViewControllerDelegate = self;
        loginController.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
        loginController.modalPresentationStyle = UIModalPresentationFormSheet;

        NSLog(@"LoginViewControllerDelegate: %@", self.description);
        NSLog(@"LoginViewController: %@", loginController.description);
        [self presentModalViewController:loginController animated: YES]; 
```

TestViewController.h

```
#import <UIKit/UIKit.h>
#import "LoginViewController.h"

@class NuanceGuidHandler;

@interface TestViewController : UIViewController <LoginViewControllerProtocol>

@property (weak, nonatomic) IBOutlet UILabel *partnerGuidLabel;
@property (weak, nonatomic) IBOutlet UILabel *userGuidLabel;
@property (strong, nonatomic) NuanceGuidHandler *nuanceGuidHandler;
@property (nonatomic) BOOL didLogIn;
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T13:23:23.730

代表的事情是红鲱鱼。

> ***由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[LoginViewController login:]: unrecognized selector sent to instance [memory address]”

表示类的对象`LoginViewController`已发送消息`login:`，它不知道如何处理。

您已将该操作连接到一个名为 的方法`login:`，并且在您的控制器中您的操作定义为`login`。正如任何医生都会告诉你的那样，结肠非常重要。在界面生成器中断开并重新连接操作，或者将登录方法签名从

```
- (IBAction)login 
```

至

```
- (IBAction)login:(id)sender 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:02:38.330

您似乎正在做以下两件事之一：

1.  当您混合模态视图控制器时，您似乎没有在任何地方声明您的委托。

    modalviewcontroller.delegate = self

2.  我不确定这是否会导致问题，但您在 LoginViewController.h 中有双重协议声明。这在过去弄乱了我的代表的东西，它可能会也可能不会导致您的问题。

# jquery - 从 PHP、MySQL 生成的 XML 填充 JPlayer 播放列表

> ID：11569888
> 
> 赞同：0
> 
> 时间：2012-07-19T21:52:18.057
> 
> 标签：jquery, mysql, xml, jplayer, playlist

我正在尝试从 .php 文件生成的 XML 为 JPlayer 创建一个动态播放列表。这是 .js 文件的代码：

```
$(document).ready(function(){
    var cssSelector = { jPlayer: "#jquery_jplayer_1", cssSelectorAncestor: "#jp_container_1" };
    var playlist = []; // Empty playlist
    var options = { swfPath: "../js", supplied: "ogg, mp3" };
    var myPlaylist = new jPlayerPlaylist(cssSelector, playlist, options);

$.get ("xml_audio.php", {}, function (xml) {
    $('Track', xml).each (function (i) {

    var   title = $(this).attr('title');
    var   track_name = $(this).attr('track_name');
    var   mp3 = 'audio/' + track_name + '.mp3';
    var   ogg = 'audio/' + track_name + '.ogg';

    var obj = ({title: title, mp3: mp3, ogg:ogg});
        alert(obj);
    playlist.push (obj);
    });  /*end of xml .each loop */
}); /* end of xml .get loop */
}); /**end of document.ready loop */ 
```

XML 输出正确，并且正在提取变量。问题似乎出在以“var obj =”开头的代码行中，警报以 [object Object] 的形式返回。语法有问题吗？或者也许 attr 是问题所在？播放器正在加载，但没有播放列表。感谢您的帮助，谢丽尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T15:22:41.030

当我更改一行时，上面的代码有效。代替：

```
 playlist.push(obj); 
```

我用了：

```
 myPlaylist.add(obj); 
```

等等。

# javascript - 无法读取未定义 JavaScript 的属性“名字”

> ID：11569889
> 
> 赞同：0
> 
> 时间：2012-07-19T21:52:23.470
> 
> 标签：javascript

我有以下基本 javascript 函数，当 onClick 事件发生时我会调用它

```
function testMe() {
    var oForm = document.forms["ExampleForm"]["First Name"].value;
    console.log(oForm);
    if (oForm == "") {
        window.alert("This is a test");
    }
    return false;
} 
```

但是，每次单击该按钮时，都会`Cannot read property "First Name" of undefined javascript`在控制台中收到错误消息。表单元素`First Name`存在并做表单名称`ExampleForm`

我忽略了什么或做错了什么？

**编辑 0**

尽管我在[http://jsfiddle.net/3Ayd8](http://jsfiddle.net/3Ayd8)上运行的示例可以正常工作，但当我在内部网站的页面上运行相同的代码时，它不起作用。

**编辑 1**

这是输出`console.log(document.forms)`

```
<form method="post" action="sample.aspx" id="form">

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form'];
if (!theForm) {
    theForm = document.form;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>

<script type="text/javascript">
    //<![CDATA[

function NewDocument(parentNodeId, classId){ 
    if (parent != window) { 
        parent.NewDocument(parentNodeId, classId); 
    } else { 
        window.top.document.location = '/default.aspx?section=content&action=new&nodeid=' + parentNodeId + '&classid=' + classId; 
    } 
}
function NotAllowed(action){ 
    if (parent != window) { 
        parent.NotAllowed('', action); 
    } else { 
        window.top.document.location = '/default.aspx?section=content&action=notallowed&subaction=' + action; 
    } 
}
function DeleteDocument(nodeId) { 
    if (parent != window) { 
        parent.DeleteDocument(nodeId); 
    } else { 
        window.top.document.location = '/default.aspx?section=content&action=delete&nodeid=' + nodeId; 
    } 
}
function EditDocument(nodeId) { 
    if (parent != window) { 
        parent.EditDocument(nodeId); 
    } else { 
        window.top.document.location = '//default.aspx?section=content&action=edit&nodeid=' + nodeId; 
    } 
}
//]]>
<input type="hidden" name="vmode" id="vmode" value="2">
</div>
<script src="/GetResource.ashx?scriptfile=%2fCMSScripts%2fcmsedit.js" type="text/javascript"></script>
<script src="/ScriptResource.axd?d=aK015nKOf8Jw44OCiklcSydFiWaSIB9l6ZwdCQaMAWlevtaFiOw7Urzac1pIZ9Rs0&amp;t=34d147fd" type="text/javascript"></script>
<script src="/ScriptResource.axd?d=aK015nKOf8Jw44OCiklcSydFiWaSIB9l6ZwdCQaMAWm_idfkOBcdRXBrkc0cxAR10&amp;t=34d147fd" type="text/javascript"></script>
<div class="aspNetHidden">

    <input type="hidden" name="__SCROLLPOSITIONX" id="__SCROLLPOSITIONX" value="0">
    <input type="hidden" name="__SCROLLPOSITIONY" id="__SCROLLPOSITIONY" value="0">
</div>
    <div id="manPortal" style="background:none;">
    <div id="CMSHeaderPad" style="height: 22px; line-height: 0px; "></div><div id="CMSHeaderDiv" style="position: fixed; top: 0px; left: 0px; right: 0px; bottom: auto; z-index: 10000; overflow: hidden; width: 100%; ">
<script type="text/javascript">
    //<![CDATA[
if ( (parent != null) && (parent.IsCMSDesk) ) { infoElem = document.getElementById('manPortal_pnlPreviewInfo'); if (infoElem) {if ( infoElem.style ) { infoElem.style.display = 'none'; } else { infoElem.display = 'none'; } }}
//]]>
</script><!-- -->
    </div>
</div><script type="text/javascript">
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('manScript', 'form', [], [], [], 90, '');
//]]>
</script>

<script type="text/javascript" src="/jquery-1.4.2.min.js"></script>
 <script type="text/javascript" src="/jquery-ui-1.8.10.custom.min.js"></script>
<script type="text/javascript" src="/plugins.js"></script>
<script type="text/javascript" src="/script.js?v=0.4"></script>

    <div class="zoneMainContent">
<div class="one-col-layout">
    <div class="col-one">
    <script type="text/javascript">
function testMe() {
    console.log(document.forms);
    console.log(document.getElementById("ExampleForm"));
    return false;
}
</script>

    <input id="FirstName" name="FirstName" type="text" value=""> <input name="submit" onclick="return testMe();" type="submit" value="submit">

    </div>
</div>
        <div style="clear:both;line-height:0px;height:0px;"></div>
    </div>
</div></form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T21:55:13.297

元素名称或 ID 中不能有空格。

这是根据[HTML 规范](http://www.w3.org/TR/html401/types.html#type-name)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:51:01.157

1.  您应该使用“FirstName”而不是“First Name”。这不是主要问题，因为在文档中找不到“ExampleForm”。

2.  如果您在 iFrame 中有“ExampleForm”并且您尝试从外部文档访问它，那么您的尝试将失败，在这种情况下，您需要从 iFrame 内的页面访问“ExampleForm”

3.  如果您的页面位于 iframe 内，并且您尝试访问外部文档中的“ExampleForm”，那么您可以使用 window.parent 属性

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T21:59:32.280

从表单 ExampleForm 中提交的 First Name 的 FirstName 中删除空格。

```
function testMe() {
    var oForm = document.forms["ExampleForm"]["FirstName"].value;
    console.log(oForm);
    if (oForm == "") {
        window.alert("This is a test");
    }
    return false;
} 
```

希望这可以帮助

# asp.net-mvc-3 - 如何将 RijndaelManaged 生成的 KEY 和 IV 存储在数据库中以备后用？

> ID：11569891
> 
> 赞同：1
> 
> 时间：2012-07-19T21:52:28.197
> 
> 标签：asp.net-mvc-3, encryption, rijndaelmanaged

让我首先说....是的，过去两天我在这里阅读了大量帖子。不，我对加密一无所知，所以不要打扰......你不应该玩火评论......

我有一个 asp.net MVC3 应用程序，并希望使用每个用户的密钥加密用户上传的照片。我想保存此密钥并将其用于同一用户的任何进一步上传和解密。（虽然，我想我可以为每张照片存储一个密钥，这与这个问题并不真正相关，但是......）

我从这里的代码开始：http: [//www.codeproject.com/Articles/33344/Photo-Video-Viewer-with-Encryption-Capability](http://www.codeproject.com/Articles/33344/Photo-Video-Viewer-with-Encryption-Capability)

它工作正常。它加密照片并将它们解密为一个新文件，一切都很好。“on the fly 版本”也可以工作并返回一个 MemoryStream，我可以将它用于我的 WebImage。但是，正如您所看到的，该示例是一次加密和解密，并且密钥是一个全局变量（我不知道它是什么，我只是在测试时使用了自动生成的密钥。

所以，我需要有人告诉我如何为每个用户在数据库中存储生成的密钥（我猜是 IV？告诉你我对 enc 一无所知......），然后提取那个（那些）值退出以用于动态解密。我不会费心发布我所有的代码，因为它几乎与上述网站上的相同。

我在这里阅读了另一篇文章，它说要使用：

```
string x = Convert.ToBase64String(RMCrypto.Key); 
```

然后，当我想解密时，我使用了：

```
RMCrypto.Key = Convert.FromBase64String(x); 
```

我以这种方式将密钥和 IV 都存储在我的 SQL DB 中，但是当我提取值并尝试解密时，我得到一个错误，即数据不是预期的长度。

也许我完全不在基地，或者可能是三行代码......如果需要更多信息，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T21:55:53.083

您应该在数据库中存储实际的字节数组（是的；键和 IV）。
你根本不需要字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-20T02:36:36.880

您可以将它们存储为二进制列值。话虽如此，加密数据的保护与保护它的密钥一样安全。换句话说，将密钥与您保护的数据一起存储有点像狐狸守卫鸡舍之类的事情。但是，如果您不担心 PCI 合规性等问题，那么这笔交易可能还不算太糟糕。

如何将其转换为二进制

```
private void UpdateDb(byte[] key, byte[] iv)
{
    using (SqlConnection db = new SqlConnection(connectionString))
    using (SqlCommand cmd = new SqlCommand("insert into (key, iv) values (@key, @iv)", db))
    {
        db.Open();
        cmd.Parameters.AddWithValue("@key", key);
        cmd.Parameters.AddWithValue("@iv", iv);
        cmd.ExecuteNonQuery();
    }

} 
```

为了使它更难一点，您可以为您保护的每条记录（图像）生成一个新的密钥和 IV，然后将其存储起来，这样如果有人我们至少要获得一个密钥，他们就不会公开您的所有数据。祝你好运！

# javascript - 使用easyscroll时jquery变量在url中没有改变

> ID：11569902
> 
> 赞同：0
> 
> 时间：2012-07-19T21:53:16.560
> 
> 标签：javascript, jquery, jquery-plugins

$catcount 在传递时保持不变，即使它改变了它的值，url 发送相同的旧值

```
<script type="text/javascript">
    var $catcount=1;
    jQuery(document).ready(
        function() {

            jQuery('.scroll_container').scrollExtend(
                {   
                    'target': 'div#scroll_items',           
                    'url': 'populates.php', 
                    'newElementClass': 'list_item more_content',
        'ajaxSettings': {'data':'cid='+$catcount},
        'onSuccess':function(){
                                    jQuery('.scroll_container').scrollExtend('enable');
                                    $catcount++;
                                    alert($catcount);
                                  }     
                }
            );

        }
    );
   </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:11:54.187

```
<script type="text/javascript">
    var $catcount=1;
    jQuery(document).ready(
        function() {

            jQuery('.scroll_container').scrollExtend(
                {   
                    'target': 'div#scroll_items',           
                    'url': function() {
                             return 'populates.php?cid='+$catcount;
                     },
                    'newElementClass': 'list_item more_content',
                    'onSuccess':function(){
                                    jQuery('.scroll_container').scrollExtend('enable');
                                    $catcount++;

                     }     
                });

        }
    );
   </script> 
```

# php - 在PHP结果中添加复选框，并在一段时间后使用java将它们一一打开

> ID：11569904
> 
> 赞同：0
> 
> 时间：2012-07-19T21:53:25.047
> 
> 标签：php, javascript, function, checkbox

这是我的 JavaScript。

```
function thisimg(id,recordid)
{
var newid = "addlink_"+id;
var countid = "count_"+id;
var url = "../updateclick.php";
$.post(url,{dbid:recordid},function(data) {  document.getElementById(countid).innerHTML = data; });
var url =document.getElementById(newid).value;
window.open (url,"mywindow","status=1");
} 
```

这是我的 PHP 回声

```
echo "<div class='title box'  onclick='thisimg(".$counter.",".$row['id'].")'><div style='float:left'><img src='".$imgpath."' alt='SimCity Social $name' title='$caption' height='50' width='50' /></div> <div class='click' style='float:right;'><b>Clicks <br/> <div id='count_".$counter."'> ".$click." </div> <input type='hidden' id='addlink_".$counter."' value='".$app_link."' rel='nofollow'</b></div><div style='float:left; width:100px; overflow:hidden; white-space: pre;'> <b> ".$name."</b><br/>".$beforetime."</div></div>"; 
```

我想修改此代码以在标题框中添加复选框，并修改 JavaScript 自动函数以在新窗口中打开选中的标题框'$app_link' URL 10 秒并关闭它。每个复选框 URL 一个一个打开 10 秒。请给出一些建议或示例代码开始。

请帮忙。

谢谢你的阅读。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T23:31:01.870

注意，你有一个标题和一个盒子类（同一个标签的两个不同的类），空格是html标签的类属性的分隔符。

这是一个复选框：

```
<input type="checkbox" id="foo" value="bar" /> 
```

创建您自己的复选框并将其放在另一个标签中，这是第一步。其他需求对我来说是无法理解的，但我想我可以给你有用的提示。

Use jQuery, that's the second step.

Use a class for your tag with the applink, I'll call this class "app-link" for now, this is the third step.

I assume that the parent of all your checkboxes in this issue will be of type of box and the jQuery code is here:

```
$('.box > input[type="checkbox"]').each(function(){
   if ($(this).prop("checked")
   {
      var url = $(this).parent().find(".app-link").val();
      //Do whatever you want with this URL...
   } 
}); 
```

Use the (untested) code above, this is the fourth step.

Finally you should make your window opening, this link might help you: [http://www.webdeveloper.com/forum/showthread.php?t=169300](http://www.webdeveloper.com/forum/showthread.php?t=169300)

Best regards, Lajos Árpád.

# python - 在 mac 上使用 python 观察目录更改

> ID：11569908
> 
> 赞同：0
> 
> 时间：2012-07-19T21:54:05.763
> 
> 标签：python, macos

正如标题所述，我需要使用 python 观察目录的更改（主要用于文件添加）

[我在这里](https://stackoverflow.com/questions/182197/how-do-i-watch-a-file-for-changes-using-python)偶然发现了一些解决方案，但没有一个能正常工作

1.一个解决方案是使用“fcntl”，我在我的系统上尝试过，但失败并出现错误“无属性 F_SETSIG”。谷歌搜索它没有任何用处

2.Python模块看门狗安装失败，因为我没有xcode，我不想下载（太大而无法下载，这么小的工作有很多不必要的东西）

接受的解决方案是特定于 Windows 的，没有大包的其他人都不能在 osx 上工作

所以最后我不想要任何涉及 XCODE、PyQT、轮询、繁忙循环的解决方案（即每隔几秒检查一次 DIR）

Applescripts 默认支持这个，所以我认为 python 也应该没有任何大的模块/包

顺便说一句，我正在使用 OS X 10.7.2 和 python 2.7.3

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:05:50.493

您要使用的 API 是[FSEvents](https://developer.apple.com/library/mac/#documentation/Darwin/Conceptual/FSEvents_ProgGuide/Introduction/Introduction.html) API。Python 不附带与该 API 的绑定，因此您需要创建自己的绑定或使用诸如[MacFSEvents](http://pypi.python.org/pypi/MacFSEvents/0.2.1)或[python-watchdog](http://code.google.com/p/python-watchdog/)之类的库。然而，你真的应该只安装 Xcode——这些库需要编译 C 绑定，而 Xcode 是获得 C 编译器的最简单方法。

如果你真的想避免 Xcode，你可以使用[ctypes 模块](http://docs.python.org/library/ctypes.html)滚动你自己的绑定，但这将是一个很大的痛苦。

> Applescripts 默认支持这个，所以我认为 python 也应该没有任何大的模块/包

倒霉。可用的各种第三方库并不大，它们只需要一个 C 编译器即可工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:09:28.417

我现在在 osx 上使用看门狗。它工作得很好。安装 xcode。或者只是编译器的命令行工具。

您可以在没有 xcode 的情况下安装 gcc 编译器：[https ://github.com/kennethreitz/osx-gcc-installer](https://github.com/kennethreitz/osx-gcc-installer)

如果你真的想要一个 applescript 方法，你可以使用 python 绑定 appscript：[http](http://appscript.sourceforge.net/py-appscript/index.html)
://appscript.sourceforge.net/py-appscript/index.html 我也使用这些，它们工作得很好。

> 所以最后我不想要任何涉及 XCODE、PyQT、轮询、繁忙循环的解决方案（即每隔几秒检查一次 DIR）

基本上你是说你什么都不想要。任何解决方案都将使用一种轮询形式。无论是系统触发还是应用程序繁忙循环。您只需要花一点时间来安装编译器即可使用您选择的解决方案。

# java - 页面关闭后如何以编程方式调用 Eclipse F5 Refresh

> ID：11569910
> 
> 赞同：2
> 
> 时间：2012-07-19T21:54:13.873
> 
> 标签：java, eclipse-plugin, command

我一直在尝试在 Eclipse 中以编程方式调用刷新 (F5) 并获得 NotHandledException, handler not found 错误。帮助将不胜感激。

在我的课上： NewPreferencePage extends PreferencePage implements IWorkbenchPreferencePage 我有以下代码：

```
@Override        
public void dispose() {

    super.dispose();

    final String COMMAND_ID = "org.eclipse.ui.file.refresh";
    IHandlerService handlerService = PlatformUI.getWorkbench().getService(IHandlerService.class);

    try {
        handlerService.executeCommand(COMMAND_ID,null);
    } catch (ExecutionException ex) {
        ex.printStackTrace();
    } catch (NotDefinedException ex) {
        ex.printStackTrace();
    } catch (NotEnabledException ex) {
        ex.printStackTrace();
    } catch (NotHandledException ex) {
        ex.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:17:36.740

您可以使用`IResource#refreshLocal()`，它具有（几乎）相同的效果。以下是单个文件的示例，但您可以以相同的方式进行项目：

```
IResource dfile = ResourcesPlugin.getWorkspace().getRoot().getFile(path);
dfile.create(blahblahblah, true, new NullProgressMonitor()); // obviously you don't need this, it's just an example
dfile.refreshLocal(IResource.DEPTH_ZERO, null); 
```

请参阅[常见问题解答 我应该何时使用 refreshLocal？](http://wiki.eclipse.org/FAQ_When_should_I_use_refreshLocal?)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-08T14:41:32.160

我只是在为类似的问题而苦苦挣扎，只想在这里分享我的见解...

背景：我正在使用 GMF 编辑器，并希望以编程方式添加许多节点和边。执行此操作的“正确”方法是添加许多 create-node-and-element-commands，这将创建模型元素和视图，但是为了快速原型化解决方案，我只是添加了模型元素并让GMF 自己找出节点。这对节点来说工作得很好，但是用 . 刷新编辑器需要边缘`F5`。

我查看了对键绑定的`plugin.xml`搜索。`F5`但是，调用命令不起作用，因为它会检查选择，显然选择是`null`在执行我的实际命令（创建元素的命令）时。但是，在检查之后，该命令实际执行的操作对我有用（刷新图表并显示新创建元素的所有节点和边）：

```
EObject modelElement = ((View) ((EditPart) structuredSelection
        .getFirstElement()).getModel()).getElement();
List editPolicies = CanonicalEditPolicy
        .getRegisteredEditPolicies(modelElement);
for (Iterator it = editPolicies.iterator(); it.hasNext();) {
    CanonicalEditPolicy nextEditPolicy = (CanonicalEditPolicy) it.next();
    nextEditPolicy.refresh();
} 
```

或更短：

```
CanonicalEditPolicy.getRegisteredEditPolicies(modelElement)
        .forEach(CanonicalEditPolicy::refresh); 
```

也就是说，当然，假设 (a) 您有一个 GMF 编辑器，并且 (b) 您可以访问模型元素和/或编辑部分，最好是图表本身。你可以得到这样的：

```
PlatformUI.getWorkbench().getActiveWorkbenchWindow().getActivePage().getActiveEditor(); 
```

# tomcat - Solr 错误实例化请求处理程序

> ID：11569917
> 
> 赞同：0
> 
> 时间：2012-07-19T21:54:53.933
> 
> 标签：tomcat, solr

好吧，我放弃了。我找不到解决方案。全文：我正在使用在 Jetty 上运行的 ManifoldCF v.5.1 连接到 Opentext（一切正常，我可以抓取 Opentext），现在我在连接的 tomcat 7 上运行了 Solr 4.0 Alpha，以获取 ManifoldCF 的输出。但是，一旦 ManifoldCF 尝试将数据交给 Solr。我收到此错误：

```
SEVERE: null:org.apache.solr.common.SolrException: lazy loading error
        at org.apache.solr.core.RequestHandlers$LazyRequestHandlerWrapper.getWra
ppedHandler(RequestHandlers.java:256)
        at org.apache.solr.core.RequestHandlers$LazyRequestHandlerWrapper.handle
Request(RequestHandlers.java:238)
        at org.apache.solr.core.SolrCore.execute(SolrCore.java:1561)
        at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter
.java:442)
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilte
r.java:263)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl
icationFilterChain.java:243)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF
ilterChain.java:210)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV
alve.java:224)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextV
alve.java:185)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.j
ava:151)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.j
ava:100)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:
929)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineVal
ve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.jav
a:405)
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java
:269)
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(
AbstractProtocol.java:515)
        at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoin
t.java:300)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
Caused by: org.apache.solr.common.SolrException: Error Instantiating Request Han
dler, org.apache.solr.handler.extraction.ExtractingRequestHandler failed to inst
antiate org.apache.solr.request.SolrRequestHandler
        at org.apache.solr.core.SolrCore.createInstance(SolrCore.java:434)
        at org.apache.solr.core.SolrCore.createRequestHandler(SolrCore.java:477)
        at org.apache.solr.core.RequestHandlers$LazyRequestHandlerWrapper.getWra
ppedHandler(RequestHandlers.java:247)
        ... 19 more
Caused by: java.lang.ClassCastException: class org.apache.solr.handler.extractio
n.ExtractingRequestHandler
        at java.lang.Class.asSubclass(Unknown Source)
        at org.apache.solr.core.SolrResourceLoader.findClass(SolrResourceLoader.
java:399)
        at org.apache.solr.core.SolrCore.createInstance(SolrCore.java:420)
        ... 21 more 
```

我在 solarconfig.xml 中尝试了几个请求处理程序，它们都以同样的方式失败。我读到 apache-solr-cell*.jar 必须在 solr.war 中，但我似乎无法确认或使用 ant 合并它。请指教...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T08:54:57.957

也许您需要删除`startup="lazy"`此请求处理程序的属性？

# java - 将 SVG 图像提交给 Servlet

> ID：11569921
> 
> 赞同：2
> 
> 时间：2012-07-19T21:55:16.730
> 
> 标签：java, jquery, web-applications, svg

我正在编写一些关于 Java Web 应用程序的报告。我的要求之一是能够将报告数据导出为 PDF。报告由几个元素组成，主要是由 Highcharts 提供的 HTML 表格和 SVG 图表。

Highcharts 有一个内置函数可以将他们的图形导出为 PDF，但是我需要一个包含其他 HTML 数据的文档，所以除了编写我自己的代码之外别无选择。由于 Highcharts 图形是在客户端创建的，因此我需要将其 SVG 输出提交到服务器，以便能够在 PDF 文档中包含图像。

我的第一个（也许是幼稚的）方法是创建一个带有隐藏输入的表单，例如：

```
<form id="fileExport" method="POST" action="servlet/FileExportServlet">
    <input type="hidden" id="svgParam" name="svgParam" />
</form> 
```

然后我会将隐藏输入的值设置为图形的 svg 代码，如下所示：

```
$("div#getPDF").live("click", function()
{
    //the chart svg data is inside a div with class highcharts-container
    //I copy the svg to the hidden input that I will submit
    $("#svgParam").val($(".highcharts-container").html());

    //submit the form with the hidden input
    $("#fileExport").submit();
}); 
```

我面临的问题是，显然 SVG 数据对于隐藏输入的值来说太大了，所以当它到达服务器时它被截断。我以这种方式提交表单，因为我不想刷新页面以开始下载。

我在想也许我可以将 SVG 元素编码为 Data URI，但我想它也不会阻止截断，尽管它在大多数情况下会产生更短的字符串。

有谁知道将 SVG 数据传输回服务器的方法？（最好也允许一些其他参数）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:04:46.300

如果您的表单使用 POST 操作，则数据不会被截断。

话虽如此，使用文本阵营发送二进制数据令人不安。我会尝试：

a) 将其作为文件附件发送（但您的用户可能需要设置字段值）。

b) 将其与 HTML 分开直接发送到您的服务器（例如，使用 CURL）

c) 至少，继续使用隐藏字段，但至少对数据使用 encode64。

# jquery-ui-dialog - jQuery UI 对话框越来越多地调用提交回调

> ID：11569922
> 
> 赞同：0
> 
> 时间：2012-07-19T21:55:33.173
> 
> 标签：jquery-ui-dialog, jquery

我从 JQuery UI 网站获取了 JQuery UI 对话框表单示例。

因为我想要这样，一旦打开对话框并显示表单，按下键提交表单，我在 onReady() 中添加了以下内容：

$.extend($.ui.dialog.prototype.options, { open: function() { var $this = $(this);

```
 // focus first button and bind enter to it
      $this.parent().find('.ui-dialog-buttonpane button:first').focus();
      $this.keypress(function(e) {
          if( e.keyCode == 13 ) {
              $this.parent().find('.ui-dialog-buttonpane button:first').click();
              return false;
          }
      });
  } 
```

});

这完全可以解决问题（我的意思是 click() 在必须触发时触发），但是会发生以下情况：

当表单首次通过按键提交时，提交执行一次。

如果我重新打开对话框，然后按一下键再次提交，则表单会提交两次。

如果我重新打开对话框，然后按一下键再次提交，则表单会提交三次，依此类推...

这可以用以下小提琴进行测试：http: [//jsfiddle.net/fWW2E/](http://jsfiddle.net/fWW2E/)

让我补充一点，通过单击专用的“提交”按钮可以正常工作，只有在涉及按键时才会失败。

有任何想法吗 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:14:25.137

因为因为您在“打开”时分配它并且您的按钮正在“关闭”对话框。

当它被调用时：

`$('something').dialog('close');`

实际上并没有删除元素，它只是隐藏它。因此，下次您单击打开“新”对话框时，您实际上只是再次显示第一个对话框。然而，每次打开时都会再次触发“open”事件，这会在其上添加一个新的按键处理程序。

这是小提琴。我实际上在控制台上写出了该元素上的当前处理程序数组。每次打开对话框时，您都会看到有另一个按键处理程序。

[演示](http://jsfiddle.net/fWW2E/1/)

# ruby-on-rails-3.1 - 通过运行功能测试来调试控制器方法

> ID：11569933
> 
> 赞同：0
> 
> 时间：2012-07-19T21:56:41.283
> 
> 标签：ruby-on-rails-3.1, devise, tdd, ruby-debug

我处于运行功能测试时需要逐步执行控制器方法的情况。我使用 ruby​​-debug 通过我的应用程序进行调试。我的应用程序是使用 ruby​​-1.8.7 的 rails 3.1 应用程序。我可以使用调试我的代码

rails server --debugger 或 rails console --debugger

我还可以通过在模型中插入“调试器”来停止代码并运行它各自的单元测试。

但我无法对控制器做同样的事情。那就是我无法通过在控制器的方法中插入“调试器”来停止代码并运行它各自的功能测试。

有没有人遇到过这个问题？

我还使用设计进行身份验证，所以我需要将以下行添加到我的 test_helper

```
class ActionController::TestCase
  include Devise::TestHelpers

  def login_user
    @request.env["devise.mapping"] = Devise.mappings[:user]
    @user.confirm!
    sign_in @user
  end
end 
```

不确定我是否会影响调试器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T01:48:11.457

当我运行功能测试时，我无法停止在控制器方法中插入的调试器，因为我遇到了 before_filter

# flash - 如何强制 TinyMCE 使用 flash youtube embed 而不是 iframe？

> ID：11569937
> 
> 赞同：1
> 
> 时间：2012-07-19T21:56:57.947
> 
> 标签：flash, iframe, youtube, tinymce

我正在使用 TinyMCE 3.4.9 并试图强制媒体插件始终使用 Flash 嵌入而不是 iFrame 嵌入。

出于安全原因，我不想允许嵌入任何 iFrame。

我已手动格式化 URL 以获取 Flash 嵌入对象而不是 iFrame 对象。

IE-

*   Flash 嵌入：[http ://www.youtube.com/v/fWNaR-rxAic](http://www.youtube.com/v/fWNaR-rxAic)
*   iFrame 嵌入： [http ://www.youtube.com/watch?v=fWNaR-rxAic](http://www.youtube.com/watch?v=fWNaR-rxAic)

有没有办法做到两者之一：

1.  更改嵌入文件/URL 字段时，修改 URL，以便默认嵌入 Flash 对象。（http://www.youtube.com/watch?v=fWNaR-rxAic 将转换为[http://www.youtube.com/v/fWNaR-rxAic](http://www.youtube.com/v/fWNaR-rxAic)）
2.  更改对 youtube 的调用，以便 youtube 返回 Flash 对象而不是 iFrame。

我的 TinyMCE 初始化代码是：

```
<script language="javascript" type="text/javascript">
    tinyMCE.init(
        {
            paste_remove_styles : true,
            gecko_spellcheck : true,
            theme_advanced_font_sizes : "1,2,3,4,5",
            extended_valid_elements:"script[charset|defer|language|src|type]",
            theme : "advanced",
            mode: "exact",
            plugins: "inlinepopups,emotions,searchreplace,paste,media",
            elements : "blogcontent",
            theme_advanced_toolbar_location : "top",
            theme_advanced_toolbar_align : "left",
            theme_advanced_buttons1 : "bold,italic,underline,strikethrough,sub,sup,|,fontselect,fontsizeselect,forecolor,|,link,unlink,|,backcolor",
            theme_advanced_buttons2 : "justifyleft,justifycenter,justifyright,|,search,replace,|,image,charmap,emotions, media,|,undo,redo",
            theme_advanced_buttons3 : "",
            theme_advanced_resize_horizontal : false,
            theme_advanced_resizing : false,
            file_browser_callback : 'file_browser',
            relative_urls : false,
            remove_script_host : false,
            paste_retain_style_properties : "font-size,color,font-family,background-color",
            setup : 
                function(ed)
                {
                    ed.onKeyUp.add(
                        function(ed, e)
                        {
                            ed.nodeChanged();
                        }
                    );
                }
        }
    );

</script> 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T17:18:22.647

由于我还没有找到强制嵌入 youtube 视频的方法，因此我为 iframe 安全问题创建了一个解决方法。

我已将 iframe 添加到允许的标签列表中，并在保存后向用户显示内容时，我将白名单过滤器应用于任何 iframe，该过滤器会提取白名单中没有 src 的任何 iframe。

```
function filterIframeBySource($text, $allowed_sources)
{
    // regex to retrieve just the iframes
    $regex      = '/<iframe[0-9a-zA-Z \.\/=>:\-"]*<\/iframe>/';
    $matches    = array();
    $reg_pos    = preg_match($regex, $text, $matches);

    // loop through each match and check the src for that iframe
    $src_expression = '/ src="http:\/\/('.str_replace('.', '\.', implode('|', $allowed_sources)).')[0-9a-zA-Z\/-]*" /';
    foreach($matches as $match)
    {
        $src_pos    = preg_match($src_expression, $match);

        if($src_pos !== false && $src_pos === 0)
            $text   = str_replace($match, '[Removed iFrame]', $text);
    }
    return $text;
} 
```

希望这可以帮助。

# c# - DataContractSerializer 序列化到特定的 xml 节点

> ID：11569939
> 
> 赞同：2
> 
> 时间：2012-07-19T21:57:06.533
> 
> 标签：c#, xml, linq-to-xml, datacontractserializer

我想提供一种在应用程序中保存工作的方法。这是一种项目功能。项目需要序列化为 XML。我已经让 DataContractSerializer 生成 XML，但我需要能够在 XML 文件中选择一个位置以使其序列化，而不是为自己编写一个完整的文件，因为将有多个项目，我需要能够从 Projects XML 文件中单独反序列化这些项目。

我想要的 XML：

```
<Projects>
    <Project>
        <ID>...</ID>
        <Name>...</Name>
        <LastEdited>...</LastEdited>
        ...
    </Project>
    <Project>...</Project>
    <Project>...</Project>
</Projects> 
```

然后，我将使用 Linq to XML 根据项目 ID 进行序列化和反序列化以导航文档。

有什么建议么？非常感谢提前。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T16:38:58.003

找到了一种方法来做到这一点。它有它的障碍，但是一旦你把所有东西都包括在内，它就会非常顺利地工作。

要生成 XML：

```
DataContractSerializer ser = new DataContractSerializer(typeof(Project));
StringBuilder objectSB = new StringBuilder();
XmlWriter objectWriter = XmlWriter.Create(objectSB);
//I'm using this method in the object I want to serialize (hence the 'this')
ser.WriteObject(objectWriter, this);
objectWriter.Flush(); 
```

然后，您可以将 StringBuilder 转换为 Linq to XML 的 XElement：

```
Xelement xProject = Xelement.Parse(objectSB.ToString()); 
```

对于反序列化：

```
DataContractSerializer ser = new DataContractSerializer(typeof(Project));
Project project = (CoilProject)ser.ReadObject(xProject.CreateReader()); 
```

有几次我使用 Linq to XML 编辑 XML 而不进行反序列化和重新序列化。由于 DataContractSerializer 添加的命名空间，这变得很有必要：

```
//place this somewhere in your project's namespace
public static class MyExtensions
{
    public static IEnumerable<XElement> ElementsAnyNS(this XElement source, string localName)
    {
        return source.Elements().Where(e => e.Name.LocalName == localName);
    }

    public static XElement ElementAnyNS(this XElement source, string localName)
    {
        return source.Elements().Where(e => e.Name.LocalName == localName).Select(e => e).Single();
    }
} 
```

这些扩展方法允许您从序列化对象中选择一个或多个元素，而无需担心命名空间。[我从Pavel Minaev](https://stackoverflow.com/a/1145671/1080957)对[Ignore namespaces in LINQ to XML](https://stackoverflow.com/questions/1145659/ignore-namespaces-in-linq-to-xml)的回答中改编了这些扩展方法。

# ruby-on-rails - 提供符号而不是字符串时，包含验证失败

> ID：11569940
> 
> 赞同：5
> 
> 时间：2012-07-19T21:57:08.930
> 
> 标签：ruby-on-rails

我的模型是这样的：

```
class Client < ActiveRecord::Base
  VALID_STATES = %w(active suspended closed)
  validates :status, :inclusion => { :in => VALID_STATES }
end 
```

如果状态来自表单（作为字符串），则验证工作正常，但我喜欢执行以下操作：

```
@client.status = :active 
```

这会引发状态不在列表中的错误，显然那是因为`%w`也不会生成符号数组，有没有解决这个问题而不最终使用字符串的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-19T22:00:07.417

您可以为状态定义一个设置器，例如：

```
 def status=(new_status)
      super new_status.to_s
    end 
```

# ruby-on-rails - 如何在 Rails 中自动加载外部 gem？

> ID：11569944
> 
> 赞同：1
> 
> 时间：2012-07-19T21:57:38.290
> 
> 标签：ruby-on-rails, gem

我最近将我的 rails-app 之外的 rails 模型外部化为 gem (models_gem)。

当我的 rails 项目导入 models_gem 时，我必须执行： require 'model' ，才能使用该模型。如何自动导入我的 models_gem 中的所有模型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:28:07.960

您可以在 Gemfile 中执行此操作，例如：

```
gem 'models_gem', require: 'models_gem' 
```

或修复您的 gem 并在 lib/models_gem.rb

```
ActiveRecord::Base.send(:include, ModelsGem) 
```

这取决于你的宝石是如何制作的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:27:30.213

当你需要一个 gem 时，它需要 lib/gem_name.rb。如果您需要该文件中的所有模型，理论上它们应该加载到您的应用程序中。

# objective-c - 如何将 NSDateComponents 存储到 NSUserDefaults 中？

> ID：11569948
> 
> 赞同：1
> 
> 时间：2012-07-19T21:57:49.887
> 
> 标签：objective-c, ios

我想将一个 NSDateComponents 存储到 NSUserDefaults，所以需要先将它包装在一个 NSData 中，如何做到这一点？

或者，还有另一种将 NSDateComponent 存储到用户默认值的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-19T22:07:27.917

`NSDateComponents`符合`NSCoding`协议，因此您可以使用`NSKeyedArchiver`/`NSKeyedUnarchiver`来完成这项工作。这是一些示例代码：

```
NSDateComponents *cmp = ...;
//Encoding
NSMutableData *data= [NSMutableData data];

NSKeyedArchiver *archiver = [[NSKeyedArchiver alloc] initForWritingWithMutableData:data];

[archiver encodeObject:cmp];
[archiver finishEncoding];

//Decoding
NSKeyedUnarchiver *unarchiver = [[NSKeyedUnarchiver alloc] initForReadingWithData:data];

NSDateComponents *decoded = [unarchiver decodeObject];

[unarchiver finishDecoding]; 
```

# c# - 计算字符串中字母数字字符的优雅方法？

> ID：11569951
> 
> 赞同：6
> 
> 时间：2012-07-19T21:58:15.790
> 
> 标签：c#, .net, string, linq, alphanumeric

我正在寻找一种优雅的方式，最好是一个简短的 linq 表达式，来计算给定字符串包含多少个字母数字字符。

我现在这样做的“无聊”方式是这样的：

```
int num = 0;
for (int i = 0; i < password.Length; i++)
{
    if (!char.IsLetterOrDigit(password, i))
    {
        num++;
    }
}
if (num < MinRequiredNonAlphanumericCharacters)
    return false; 
```

这已经相当短了，但我相信通过一些 linq 魔法，这可以用更短、同样易于理解的表达来完成，对吧？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-07-19T22:03:03.070

这是获取字母和数字计数的快速而肮脏的 LINQ 方法：

```
password.Count(char.IsLetterOrDigit) 
```

这更像是您正在做的事情的直接副本：

```
password.Count(c => !char.IsLetterOrDigit(c)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:02:06.840

```
int num = password.Where((t, i) => !char.IsLetterOrDigit(password, i)).Count();

if (num < MinRequiredNonAlphanumericCharacters)
    return false; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:00:33.173

你可以用一行正则表达式来做到这一点。这是否可以理解是一个有争议的问题。

```
num = new Regex(@"\w", RegexOptions.IgnoreCase).Matches(input).Count 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T22:05:54.740

您可以使用`Take()`来确保您不会检查超出必要的字母：

```
int minCount = password.Where(x => !char.IsLetterOrDigit(x)).Take(MinRequired).Count();
if (minCount < MinRequired) { // No good } 
```

我们的想法是，我们只会继续检查，直到您达到最低数量。到那时，我们可以停下来，因为我们知道我们有一个可接受的密码。`Take()`尽可能多地取走，没有更多，所以如果没有足够的，它只会返回一个比你请求的数字少的数字。

# android - 自定义标题栏问题 - 软键盘移动它

> ID：11569955
> 
> 赞同：0
> 
> 时间：2012-07-19T21:58:38.963
> 
> 标签：android, android-layout

我正在使用自定义标题栏，设置为：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/actionbar_compat"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="horizontal" /> 
```

我的活动布局如下：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
<Button android:id="@+id/toggle_title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="top"
    android:text="@string/toggle_title" />

<ImageView
    android:id="@+id/logoView"
    android:layout_gravity="center"
    android:layout_height="100dip"
    android:layout_width="100dip"
    android:layout_marginTop="30dip"
    android:src="@drawable/ic_launcher" />

<RelativeLayout
    android:id="@+id/relativeLayout1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:paddingLeft="50dip"
    android:paddingRight="50dip"
    android:layout_marginTop="40dip"
    >

    <EditText
        android:id="@+id/loginUser"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:inputType="text|textEmailAddress" >

        <requestFocus />
    </EditText>

    <EditText
        android:id="@+id/loginPassword"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/loginUser"
        android:layout_marginTop="8dip"
        android:inputType="textPassword" />

    <Button
        android:id="@+id/loginButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_below="@+id/loginPassword"
        android:text="login" />

    <Button
        android:id="@+id/registerButton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/loginButton"
        android:layout_below="@+id/loginPassword"
        android:text="register" />
</RelativeLayout> 
```

当我触摸密码字段时，软键盘会出现并将所有内容移动到顶部，以使其适合，同时仍然能够看到我正在编辑的文本框。问题是它也在移动标题栏并使其部分不可见。

在这种情况下，如何防止标题栏移动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T10:00:51.507

写在你的清单文件 android:windowSoftInputMode="adjustPan"

# php - 来自特定 htaccess 重写的 403 禁止错误

> ID：11569956
> 
> 赞同：1
> 
> 时间：2012-07-19T21:58:40.203
> 
> 标签：php, .htaccess, url

我正在使用`.htaccess`'`RewriteRule`将 url 重定向到客户端的正确页面，一切正常，除了重写单词目录！我收到 403 禁止错误。

这是我的代码：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule ^catalogue$ /catalogue.php
</IfModule> 
```

这导致：

![在此处输入图像描述](../Images/d68f766170ec254581f7ad8e342eb9eb.png)

现在，让我发疯的是，如果我将代码切换到`RewriteRule ^catalog$ /catalogue.php`或`RewriteRule ^cataloguee$ /catalogue.php`浏览到相应的 url，页面显示没有错误。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T00:32:56.197

看起来正在发生的事情是某种`DirectorySlash`功能正在启动（当它认为您正在尝试访问目录时添加一个斜杠）。最好不要将其关闭，因此只需使用尾部斜杠匹配 URI：

```
 RewriteRule ^catalogue/?$ /catalogue.php [L] 
```

# php - 正在打电话 可能重复： 多个 PHP 标记 有没有区别： 和 在使用的时间和资源方面？ 如果您有疑问 - 测量 总是喜欢可读的解决方案 phpperformance 4 2 回答 2 This answer is useful 2 如果您有疑问 - 测量 总是喜欢可读的解决方案 于 2012-07-19T22:00:04.603 回答 This answer is useful 0 我的第一个想法是也许。 话虽如此，我曾经为一个每秒点击数千次的网站编写代码，并尝试了两种方式。我没有看到任何明显的差异。我没有经验证据，但在我对高容量网站的测试中，这似乎没有什么区别。 于 2012-07-19T22:01:57.327 回答 Related 2 php - MVC 设计 - 从 JS 控件到 PHP 视图 2 android - ICS 上的蓝牙聊天示例看起来很乱 1 javascript - 从 Omnibar 搜索时，如何让 Chrome 不转义搜索词？ 1 assembly - 如何让 GNU 汇编器输出 ELF 对象而不是 Mach-O 对象？ 2 recursion - 使用二进制递归对数组元素求和 1 php - 在进度条之外显示投票进度条的百分比 1 css - IE9 中不显示背景图片 1 python - 如何结合 django 和 gevent 的基础知识？ 3 javascript - jQuery用逗号缩短长数字 3 c# - 如何开始在 Metro 应用程序中使用 MVVM？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：11569957
> 
> 赞同：0
> 
> 时间：
> 
> 标签：php, performance

> **可能重复：**
> [多个 PHP 标记](https://stackoverflow.com/questions/10979626/multiple-php-tags)

有没有区别：

```
<?php echo "n" ?>
<?php echo "i" ?>
<?php echo "g" ?> 
```

和

```
<?php
    echo "t";
    echo "i";
    echo "t";
?> 
```

在使用的时间和资源方面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:00:04.603

1.  如果您有疑问 - 测量
2.  总是喜欢可读的解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:01:57.327

我的第一个想法是也许。

话虽如此，我曾经为一个每秒点击数千次的网站编写代码，并尝试了两种方式。我没有看到任何明显的差异。我没有经验证据，但在我对高容量网站的测试中，这似乎没有什么区别。

# sql - 如何在单个进程中模拟 SQL Server 中的死锁？

> ID：11569964
> 
> 赞同：29
> 
> 时间：2012-07-19T21:59:40.387
> 
> 标签：sql, sql-server, unit-testing, deadlock, raiserror

我们的客户端代码检测到死锁，等待一段时间，然后重试请求最多 5 次。重试逻辑根据错误号 1205 检测死锁。

我的目标是测试各种存储过程中的死锁重试逻辑和死锁处理。我可以使用两个不同的连接创建死锁。但是，我想在单个存储过程本身内部模拟死锁。

死锁会引发以下错误消息：

> 消息 1205，级别 13，状态 51，第 1 行
> 事务（进程 ID 66）在锁定资源上与另一个进程死锁，并已被选为死锁牺牲品。重新运行事务。

我看到此错误消息位于[`sys.messages`](http://msdn.microsoft.com/en-us/library/ms187382.aspx)：

```
select * from sys.messages where message_id = 1205 and language_id = 1033

message_id language_id severity  is_event_logged   text
1205       1033        13        0                 Transaction (Process ID %d) was deadlocked on %.*ls resources with another process and has been chosen as the deadlock victim. Rerun the transaction. 
```

我无法使用以下方法引发此错误[`RAISERROR`](http://msdn.microsoft.com/en-us/library/ms178592.aspx)：

```
raiserror(1205, 13, 51) 
```

> 消息 2732，级别 16，状态 1，第 1 行
> 错误号 1205 无效。该数字必须从 13000 到 2147483647，并且不能是 50000。

我们的死锁重试逻辑检查错误号是否为 1205。死锁需要与普通死锁具有相同的消息 ID、级别和状态。

有没有办法模拟死锁（使用 RAISERROR 或任何其他方式）并*仅通过一个进程*获得相同的消息编号？

我们的数据库使用 SQL 2005 兼容性，尽管我们的服务器从 2005 到 2008 R2 有所不同。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-08-07T16:09:26.587

正如许多人指出的那样，答案是否定的，单个进程本身无法可靠地死锁。我想出了以下解决方案来模拟开发或测试系统上的死锁。

在 SQL Server Management Studio 窗口中运行以下脚本。（仅在 2008 R2 上测试。）您可以根据需要让它一直运行。

在要模拟死锁的地方，插入对`sp_simulatedeadlock`. 运行您的进程，应该会发生死锁。

完成测试后，停止 SSMS 查询并运行底部的清理代码。

```
/*
This script helps simulate deadlocks.  Run the entire script in a SQL query window.  It will continue running until stopped.
In the target script, insert a call to sp_simulatedeadlock where you want the deadlock to occur.
This stored procedure, also created below, causes the deadlock.
When you are done, stop the execution of this window and run the code in the cleanup section at the bottom.
*/
set nocount on

if object_id('DeadlockTest') is not null
    drop table DeadlockTest

create table DeadlockTest
(
    Deadlock_Key int primary key clustered,
    Deadlock_Count int
)
go

if exists (select * from sysobjects where id = object_id(N'sp_simulatedeadlock')
           AND objectproperty(id, N'IsProcedure') = 1)
drop procedure sp_simulatedeadlock
GO

create procedure sp_simulatedeadlock
(
    @MaxDeadlocks int = -1 -- specify the number of deadlocks you want; -1 = constant deadlocking
)
as begin

    set nocount on

    if object_id('DeadlockTest') is null
        return

    -- Volunteer to be a deadlock victim.
    set deadlock_priority low

    declare @DeadlockCount int

    select @DeadlockCount = Deadlock_Count -- this starts at 0
    from DeadlockTest
    where Deadlock_Key = 2

    -- Trace the start of each deadlock event.
    -- To listen to the trace event, setup a SQL Server Profiler trace with event class "UserConfigurable:0".
    -- Note that the user running this proc must have ALTER TRACE permission.
    -- Also note that there are only 128 characters allowed in the trace text.
    declare @trace nvarchar(128)

    if @MaxDeadlocks > 0 AND @DeadlockCount > @MaxDeadlocks
    begin

        set @trace = N'Deadlock Test @MaxDeadlocks: ' + cast(@MaxDeadlocks as nvarchar) + N' @DeadlockCount: ' + cast(@DeadlockCount as nvarchar) + N' Resetting deadlock count.  Will not cause deadlock.'
        exec sp_trace_generateevent
            @eventid = 82,  -- 82 = UserConfigurable:0 through 91 = UserConfigurable:9
            @userinfo = @trace

        -- Reset the number of deadlocks.
        -- Hopefully if there is an outer transaction, it will complete and persist this change.
        update DeadlockTest
        set Deadlock_Count = 0
        where Deadlock_Key = 2
        return
    end

    set @trace = N'Deadlock Test @MaxDeadlocks: ' + cast(@MaxDeadlocks as nvarchar) + N' @DeadlockCount: ' + cast(@DeadlockCount as nvarchar) + N' Simulating deadlock.'
    exec sp_trace_generateevent
        @eventid = 82,  -- 82 = UserConfigurable:0 through 91 = UserConfigurable:9
        @userinfo = @trace

    declare @StartedTransaction bit
    set @StartedTransaction = 0
    if @@trancount = 0
    begin
        set @StartedTransaction = 1
        begin transaction
    end

    -- lock 2nd record
    update DeadlockTest
    set Deadlock_Count = Deadlock_Count
    from DeadlockTest
    where Deadlock_Key = 2

    -- lock 1st record to cause deadlock
    update DeadlockTest
    set Deadlock_Count = Deadlock_Count
    from DeadlockTest
    where Deadlock_Key = 1

    if @StartedTransaction = 1
        rollback    
end
go

insert into DeadlockTest(Deadlock_Key, Deadlock_Count)
select 1, 0
union select 2, 0

-- Force other processes to be the deadlock victim.
set deadlock_priority high

begin transaction

while 1 = 1
begin

    begin try

        begin transaction

        -- lock 1st record
        update DeadlockTest
        set Deadlock_Count = Deadlock_Count
        from DeadlockTest
        where Deadlock_Key = 1

        waitfor delay '00:00:10'

        -- lock 2nd record (which will be locked when the target proc calls sp_simulatedeadlock)
        update DeadlockTest
        set Deadlock_Count = Deadlock_Count
        from DeadlockTest
        where Deadlock_Key = 2

        rollback

    end try
    begin catch
        print 'Error ' + convert(varchar(20), ERROR_NUMBER()) + ': ' + ERROR_MESSAGE()
        goto cleanup
    end catch

end

cleanup:

if @@trancount > 0
    rollback

drop procedure sp_simulatedeadlock
drop table DeadlockTest 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2016-09-02T19:51:35.733

您可以通过运行来利用 Microsoft 似乎不急于修复的错误

```
use tempdb

begin tran
go

CREATE TYPE dbo.IntIntSet AS TABLE(
    Value0 Int NOT NULL,
    Value1 Int NOT NULL
)
go

declare @myPK dbo.IntIntSet;
go

rollback 
```

此 SQL 将导致与自身发生死锁。更多细节在 Aaron Bertand 的博客[http://sqlperformance.com/2013/11/t-sql-queries/single-tx-deadlock](http://sqlperformance.com/2013/11/t-sql-queries/single-tx-deadlock)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-21T01:00:16.300

（显然我没有足够的声誉来添加评论。所以发布作为答案。）

死锁至少需要两个进程。唯一的例外是查询内并行死锁，这是不可能重现的。

但是，您可以在运行完全相同的查询（或 sp）的两个进程上模拟死锁。[这里](https://sqlindian.wordpress.com/2012/07/06/sql-server-deadlocks-and-live-lockscommon-patterns/)有一些想法

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-11-18T11:02:43.383

这可以从单个会话可靠地工作。使用服务代理激活来调用死锁所需的第二个线程。

注1：不包括清理脚本
注2：必须启用服务代理：ALTER DATABASE dbname SET ENABLE_BROKER WITH ROLLBACK IMMEDIATE；

```
EXEC sp_executesql N'
CREATE OR ALTER PROCEDURE DeadlockReceive 
AS
DECLARE @MessageBody NVARCHAR(1000);
RECEIVE @MessageBody = CAST(message_body AS NVARCHAR(1000) )FROM DeadlockQueue
SELECT @MessageBody
EXEC sp_executesql @MessageBody;'

IF EXISTS (SELECT * FROM sys.services WHERE name = 'DeadlockService') DROP SERVICE DeadlockService
IF OBJECT_ID('DeadlockQueue') IS NOT NULL DROP QUEUE dbo.DeadlockQueue
IF EXISTS (SELECT * FROM sys.service_contracts WHERE name = 'DeadlockContract') DROP CONTRACT DeadlockContract
IF EXISTS (SELECT * FROM sys.service_message_types WHERE name = 'DeadlockMessage') DROP MESSAGE TYPE DeadlockMessage
DROP TABLE IF EXISTS DeadlockTable1 ;
DROP TABLE IF EXISTS DeadlockTable2 ;

CREATE MESSAGE TYPE DeadlockMessage VALIDATION = NONE;
CREATE QUEUE DeadlockQueue WITH STATUS = ON, ACTIVATION (PROCEDURE_NAME = DeadlockReceive, EXECUTE AS SELF, MAX_QUEUE_READERS = 1);
CREATE CONTRACT DeadlockContract AUTHORIZATION dbo (DeadlockMessage SENT BY ANY);
CREATE SERVICE DeadlockService ON QUEUE DeadlockQueue (DeadlockContract);

CREATE TABLE DeadlockTable1 (Value INT); INSERT dbo.DeadlockTable1 SELECT 1;
CREATE TABLE DeadlockTable2 (Value INT); INSERT dbo.DeadlockTable2 SELECT 1;

DECLARE @ch UNIQUEIDENTIFIER
BEGIN DIALOG @ch FROM SERVICE DeadlockService TO SERVICE 'DeadlockService' ON CONTRACT DeadlockContract WITH ENCRYPTION = OFF ;
SEND ON CONVERSATION @ch MESSAGE TYPE DeadlockMessage (N'
set deadlock_priority high;
begin tran; 
update DeadlockTable2 set value = 5;
waitfor delay ''00:00:01'';
update DeadlockTable1 set value = 5;
commit')

SET DEADLOCK_PRIORITY LOW
BEGIN TRAN
    UPDATE dbo.DeadlockTable1 SET Value = 2
    waitfor delay '00:00:01';
    UPDATE dbo.DeadlockTable2 SET Value = 2
COMMIT
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-25T10:23:26.010

在 C# 中使用 Parallel 重现的最简单方法，例如

```
 var List = ... (add some items with same ids)

    Parallel.ForEach(List, 
        (item) =>
    {

        ReportsDataContext erdc = null;
        try
        {
            using (TransactionScope scope = new TransactionScope())
            {
                erdc = new ReportsDataContext("....connection....");
                var report = erdc.Report.Where(x => x.id == item.id).Select(x => x);
                report.Count++
                erdc.SubmitChanges();

                scope.Complete();
            }

            if (erdc != null)
                erdc.Dispose();
        }
        catch (Exception ex)
        {
            if (erdc != null)
                erdc.Dispose();
            ErrorLog.LogEx("multi thread victim", ex);
        } 
```

更感兴趣的是如何在真正的跨线程情况下防止该错误？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-26T16:26:22.367

我很难让保罗的回答起作用。我做了一些小改动以使其正常工作。

关键是在过程本身内开始和回滚 sp_simulatedeadlock 事务。我没有对保罗回答中的程序进行任何更改。

```
DECLARE @DeadlockCounter INT = NULL

SELECT @DeadlockCounter = 0

WHILE @DeadlockCounter < 10
BEGIN
    BEGIN TRY
    /* The procedure was leaving uncommitted transactions, I rollback the transaction in the catch block */
        BEGIN tran simulate
            Exec sp_simulatedeadlock

        /* Code you want to deadlock */

        SELECT @DeadlockCounter = 10
    END TRY
    BEGIN CATCH
        Rollback tran simulate

        PRINT ERROR_MESSAGE()

        IF (ERROR_MESSAGE() LIKE '%deadlock%' OR ERROR_NUMBER() = 1205) AND @DeadlockCounter < 10
            BEGIN
                SELECT @DeadlockCounter +=1
                PRINT @DeadlockCounter

                IF @DeadlockCounter = 10
                BEGIN
                    RAISERROR('Deadlock limit exceeded or error raised', 16, 10);
                END
            END
    END CATCH
END 
```

# tomcat - 在 Tomcat 上的域内创建子域

> ID：11569965
> 
> 赞同：0
> 
> 时间：2012-07-19T21:59:43.103
> 
> 标签：tomcat, dns, subdomain

我在 tomcat 服务器上托管一个 Web 应用程序，例如当前 URL 是 www.mysite.com 我计划创建我的网站的移动版本，我希望能够使用 URL m.mysite.com 访问它

如何使用我的域 mysite.com 创建子域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:14:29.117

您需要将记录添加到您的 DNS 服务器：

*   选项一：指向您的 IPv4/IPv6 地址的 A 和/或 AAAA
*   选项二：指向您的 www 子域的 CNAME 记录

此外，您的服务器需要知道它应该在该虚拟主机上显示其他内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:12:45.150

1.  您应该设置您的 DNS 区域以使子域指向您在托管服务器上的任何 IP 地址。检查您是否可以 ping 您的`m.mysite.com`.
2.  您应该确保您的网络服务器将响应带有标头的 HTTP 请求`Host: m.mysite.com`。这可以称为`VirtualHost`.

# javascript - 将 JS 中的变量插入 Django 表单输入字段

> ID：11569967
> 
> 赞同：3
> 
> 时间：2012-07-19T21:59:44.687
> 
> 标签：javascript, python, html, django

我正在编写一个支付员工在两个城市之间的里程的表格。我正在使用 Google Maps API 来获取信息。我正在运行一个产生变量的脚本`drivingDistanceMiles`。我想在我的 Django 表单中填充该字段`mileage`，该表单保存到 python 变量`distance`中。

这是我的表单html的片段：

```
<form action="" method="post"><% csrf_token %}
{{  form.non_field_errors  }}
<div class="fieldWrapper">
    {{  form.distance.errors  }}
    <label for="id_distance">Mileage claim:</label>
    {{  form.distance  }}
</div> 
```

在入口上方的页面上有一个距离计算器。

在我的 forms.py`distance = forms.CharField(max_length=20, required = False)`中。我将其设为 CharField 而不是 IntField，以防我的员工（不是最精通计算机的一群）在末尾添加“英里”一词。

`drivingDistanceMiles`问题：当用户在距离计算器中输入他们的城市信息时，是否可以获得自动填充的值？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-19T22:09:40.307

如果您使用纯 javascript（不是 jQuery 或任何框架），您可以通过`document.getElementById('id_distance').value`. 您可以通过以下方式设置它的值`document.getElementById('id_distance').value = <some_var>;`

# iphone - iPhone上图像的文件路径

> ID：11569968
> 
> 赞同：1
> 
> 时间：2012-07-19T21:59:52.113
> 
> 标签：iphone, objective-c, ios, photo

我有兴趣将文件（图像）从 iPhone 库/相机胶卷上传到远程 Web 服务器。我已经有一个脚本可以将任何文件从手机上传到网络服务器。但是，我假设要从 iPhone 上传图像，我需要该图像的路径。一旦用户从相机胶卷中选择所述图像，有什么方法可以做到这一点？即，如何获取相机胶卷中所选图像的文件路径？

我试过无济于事。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-19T22:10:27.497

您将需要查看[ALAssetsLibrary](http://developer.apple.com/library/ios/#DOCUMENTATION/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html)功能 - 这些功能可让您访问存储在 iOS 设备上的照片和视频库中的照片和视频。

具体来说，类似：

```
ALAssetsLibrary *assets = [[ALAssetsLibrary alloc] init];

[assets enumerateGroupsWithTypes:ALAssetsGroupSavedPhotos
    usingBlock:^(ALAssetsGroup *group, BOOL *stop) {
        [group enumerateAssetsUsingBlock:^(ALAsset *asset, NSUInteger index, BOOL *stop) {
            //the ALAsset should be one of your photos - stick it in an array and after this runs, use it however you need
        }
    }
    failureBlock:^(NSError *error) {
        //something went wrong, you can't access the photo gallery
    }
]; 
```

**编辑**

如果您使用的是 UIImagePickerController 而不是纯粹的编程方法，这将大大简化它：

在：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    UIImage *img = [info objectForKey:UIImagePickerControllerEditedImage];
    //you can use UIImagePickerControllerOriginalImage for the original image

    //Now, save the image to your apps temp folder, 

    NSString *path = [NSTemporaryDirectory() stringByAppendingPathComponent:@"upload-image.tmp"];
    NSData *imageData = UIImagePNGRepresentation(img);
    //you can also use UIImageJPEGRepresentation(img,1); for jpegs
    [imageData writeToFile:path atomically:YES];

    //now call your method
    [someClass uploadMyImageToTheWebFromPath:path];
} 
```

# c# - MongoDB 集合到 .Net 字典的最佳实践

> ID：11569970
> 
> 赞同：0
> 
> 时间：2012-07-19T21:59:54.610
> 
> 标签：c#, mongodb, mongodb-.net-driver

我有一个对内存数据执行快速操作的应用程序。此数据在内存中表示为`Dictionary<MyKey,MyData>`. 这`MyKey`是一个包含一些字符串标签的类：

```
public class MyKey
{
    string tag1;
    string tag2;
    ... 
} 
```

并且`MyData`是一个包含一些文本的对象。

我想将它作为文档集合存储在 MongoDB 中，例如：

```
{
    tag1: "foo1",
    tag2: "foo2",
    mydata: { ... }
},
{
    tag1: "bar1",
    tag2: "bar2",
    mydata: { ... }
}... 
```

这样我就可以使用 mongodb 选择器：

```
db.MyCollection.find({tag1: "foo1"}) 
```

但是编写序列化器/反序列化器变得非常烦人，因为一对一的映射会这样做：

```
{
    mykey: { tag1: "foo1", tag2: "foo2"},
    mydata: { ... }
} 
```

我觉得这是一个很常见的问题。实现这一目标的最佳解决方案是什么？我想保留原来的 Dictionary 结构，但我不想为 Serializer 重新发明轮子。

我可以遵循任何想法/教程吗？这甚至是我应该做的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-19T22:14:02.800

这种形式的文件没有问题：

```
{
    mykey: { tag1: "foo1", tag2: "foo2"},
    mydata: { ... }
} 
```

您仍然可以查询它。

```
db.collection.find({'mykey.tag1': 'foo1'}) 
```

这回答了你的问题了吗？是否还有其他需要该文档结构的特殊原因？

# php - 如何从 HTML 表单中获取 PHP 值？

> ID：11569971
> 
> 赞同：2
> 
> 时间：2012-07-19T21:59:56.187
> 
> 标签：php, html

我有一个 HTML 表单，如下所示：

```
<form enctype="multipart/form-data" action=" " method="post">
<input name="username" type="text"/>
<input type="submit" value="Upload" class="btn btn-primary"/><br/>
</form> 
```

我希望这个表单的用户在输入框中输入数据。然后我希望这个数据是 PHP 字符串的值 - 例如，用户输入的 HTML 表单的值在`$username = "MY_NAME";`哪里。`MY_NAME`

如果用户在输入框中输入例如`"STACKOVERFLOW"`我希望 PHP 字符串是`$username = "STACKOVERFLOW";`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-19T22:01:31.367

表单提交时，需要从[`$_POST`](http://php.net/manual/en/reserved.variables.post.php)数组中获取值

您可以`print_r($_POST)`查看它包含的所有内容（所有表单字段）并单独引用它们。

用户名将是`$_POST['username']`

我建议阅读有关使用表单和 PHP 的教程……[这是一个很好的教程](http://www.tizag.com/phpT/forms.php/)

由于您显然是初学者，因此我会为您提供更多帮助：

为您的提交按钮命名：

```
<form enctype="multipart/form-data" action="" method="post">
    <input name="username" type="text"/>
    <input type="submit" name="submit" value="Upload" class="btn btn-primary"/><br/>
</form> 
```

因为`action`是空白，所以会POST到当前页面。在文件的顶部，您可以通过检查是否`$_POST['submit']`已设置来检查表单是否已提交（我为您的提交按钮提供了该名称）。

```
if(isset($_POST['submit'])) {
    // form submitted, now we can look at the data that came through
    // the value inside the brackets comes from the name attribute of the input field. (just like submit above)
    $username = $_POST['username'];

    // Now you can do whatever with this variable.
}
// close the PHP tag and your HTML will be below 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-19T22:04:48.903

首先检查表单是否已提交：

```
<form enctype="multipart/form-data" action=" " method="post">
<input name="username" type="text"/>
<input type="submit" name="Submit" value="Upload" class="btn btn-primary"/><br/>
</form>

if($_POST['Submit'] == "Upload")
{

    $username = $_POST['username'];

} 
```

# php - Ajax & Jquery 表单提交

> ID：11569973
> 
> 赞同：0
> 
> 时间：2012-07-19T22:00:03.633
> 
> 标签：php, jquery, ajax, forms

我正要用这个把头发从头上拔下来。

我确定问题很简单，我是 Jquery 的 Ajax 新手，我只是忽略了一些东西。但是，这很烦人。每次提交表单时，页面都会刷新并`.ajax`抛出`error:`. 这可能是什么原因造成的？我知道我肯定会将我的表单值传递给 Jquery。并且`newcomment.php`正在工作。我可以向它发布常规表单，但不能使用 jquery。

```
function postPhotoComment() {

    var comment = $("#comment").val();
    var album = $("#album").val();
    var photo = $("#photo").val();
    var dataString = "comment="+comment+"&album="+album+"&photo="+photo;

    $.ajax({
        type: "POST",
        url: "/includes/actions/photo-gallery/newcomment.php",
        data: dataString,
        success: function(res) {
            alert("Posted!");
        }
            error: function(res) {
            alert("Error!");
        }
    })  
} 
```

编辑：这是我的 html 表单：

```
<form>
    <textarea id="comment" placeholder="Post Comment..."></textarea>
    <input id="album" type="hidden" value="<?php echo "$a"?>"/>
    <input id="photo" type="hidden" value="<?php echo "$p.$ext"?>"/><br/>
    <button id="photo-comment-submit" onclick="postPhotoComment()">Post</button>
</form> 
```

我还注意到，如果我提供输入s，Chrome 会将它们像变量`name`一样放入 url 栏中。`GET`每次页面刷新后，它都会`?`在 url 的末尾添加 。因此，它似乎试图定期提交表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:08:47.763

如果您调用 AJAX 表单提交代码的函数是表单的`onSubmit`方法，则您需要停止默认操作的发生——也就是说，您要停止正常提交。

为此，请使用对象的`preventDefault`方法`event`：

```
function postPhotoComment(evnt) {
    evnt.preventDefault();

    // existing code continues...

} 
```

您也可以`false`从您的事件中返回，但请注意，这样做在不同的浏览器中会产生不同的效果，并且它不像调用`preventDefault`或`stopPropagation`直接调用那样明确或可靠。

**编辑** 另外，错误处理程序可能会被调用，因为您的代码启动了 XHR 请求，但是当浏览器启动默认操作（提交表单）时，它会取消任何未决的 XHR 请求。这导致错误处理程序被触发。

**编辑 2**我创建了一个带有工作演示的 jsFiddle：http: [//jsfiddle.net/wXrAU/](http://jsfiddle.net/wXrAU/)

**文档**

*   `event.preventDefault`MDN 上的方法 - [https://developer.mozilla.org/en/DOM/event.preventDefault](https://developer.mozilla.org/en/DOM/event.preventDefault)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:09:49.367

您是否返回 false 以停止浏览器的默认操作？

```
$('form').submit(function(){
    var dataString = $(this).serialize(); // shortcut

    $.ajax({
        type: "POST",
        url: "/includes/actions/photo-gallery/newcomment.php",
        data: dataString,
        success: function(res) {
            alert("Posted!");
        }
        error: function(res) {
             alert("Error!");
        }
    });

  return false;// cancels the default action
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T23:10:33.613

我实际上通过简单地删除`<form>`标签来解决这个问题。反正我不需要它们。但现在一切似乎都正常了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-19T22:05:23.753

提交时请确保您`return false;`向表单提交，否则它仍然会作为“正常”表单提交而不使用 Ajax 并重新加载页面。

编辑：阅读评论后，我认为这最适合您： `<form action="url.php" onsubmit="return false;"></form>`

带有适当代码的 jsFiddle：http: [//jsfiddle.net/SO_AMK/ZVgNv/](http://jsfiddle.net/SO_AMK/ZVgNv/)

PHP 有点搞砸了，但它可以工作。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2012-07-19T22:03:29.450

确保您编写了一个有效的、可通过 HTTP 访问的 url，而不仅仅是脚本的路径，例如

```
function postPhotoComment() {

    var comment = $("#comment").val();
    var album = $("#album").val();
    var photo = $("#photo").val();
    var dataString = "comment="+comment+"&album="+album+"&photo="+photo;

    $.ajax({
        type: "POST",
        url: "http://yoursite.com/whatever/newcomment.php", // here
        data: dataString,
        success: function(res) {
            alert("Posted!");
        }
            error: function(res) {
            alert("Error!");
        }
    })  
} 
```

因为 JavaScript 是一种客户端语言。它对您的文件系统结构或任何类似的东西一无所知。而 AJAX 请求是基于 HTTP 协议的。

# sql - SQL SELF JOIN 连接列

> ID：11569978
> 
> 赞同：0
> 
> 时间：2012-07-19T22:00:29.410
> 
> 标签：sql

> **可能重复：**
> [在 MS SQL Server 2005 中模拟 group_concat MySQL 函数？](https://stackoverflow.com/questions/451415/simulating-group-concat-mysql-function-in-ms-sql-server-2005)

我有两张桌子，即`ServiceEntryPart`和`Part`。一个服务条目可以有多个部分。我想要做的是为同一个服务条目连接不同的部分。我正在寻找的最后一个条目是如下所示"

```
 ServiceEntryID     PartDescription
       3            2 ~ xyz Manager | 3 ~ Elevator 
```

在 Column Part Description 中，不同的部件 id 连接在一列中，方法是先使用部件 id，后跟 tilda，部件描述，后跟管道字符，并且 serviceentry 部分中不同部件的格式相同。任何帮助都将不胜感激。谢谢

请在下面找到结构

```
dbo.ServiceEntryPart
ID   ServiceEntryID   PartID
266  2                1
234  3                2
234  3                3
233  5                4

dbo.Part
ID  PartDescription   
1   Sample Manager
2   xyz Manager
3   Elevator 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:11:58.013

```
SELECT ServiceEntryID, PartDescription = 
    STUFF((SELECT ' | ' + CAST(b.ID AS NVARCHAR) + ' ~ ' + PartDescription
           FROM Part b
            INNER JOIN ServiceEntryPart c
                ON c.PartId = b.ID
           WHERE c.ServiceEntryID = a.ServiceEntryID
           FOR XML PATH('')), 1, 3, '')
FROM ServiceEntryPart a
GROUP BY ServiceEntryID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T22:11:49.680

在下一个 url 中，您可以找到许多方法来完成这项工作，我建议您使用**该教程中描述的 blackbox XML 方法**，这是最简单的方法。

[在 Transact-SQL 中连接行值](http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/)

像这样的东西...

```
SELECT dbo.ServiceEntryPart.ServiceEntryID,
   ( SELECT dbo.Part.ID + '~' + dbo.Part.PartDescription + ','
       FROM dbo.Part
      WHERE dbo.ServiceEntryPart.PartID = dbo.Part.ID
      ORDER BY dbo.Part.ID
        FOR XML PATH('') ) AS PartDescription
  FROM dbo.ServiceEntryPart
  GROUP BY dbo.ServiceEntryPart.ServiceEntryID 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T22:04:01.823

[http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/](http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/)

# mysql - 防止“连接过多”（ConnectionPool 不是答案，正在寻找 mysql 服务器端解决方案）

> ID：11569981
> 
> 赞同：0
> 
> 时间：2012-07-19T22:01:01.327
> 
> 标签：mysql, database, connection

几周前，我发布了一个关于排队数据库访问请求的问题，以防止在发生大量并发数据库请求时出现“连接过多”错误。人们告诉我 ConnectionPool 是我当时同意的正确方法。但是，我终于意识到这不是解决方案，尤其是当有很多不同的客户端通过网络访问 mysql 服务器时，因为连接池在客户端，它不能防止所有客户端的连接总和超过最大连接数mysql服务器。

我认为mysql服务器上应该有一些中间件作为队列或池工作，有人熟悉吗？谢谢你。

我知道这个问题被广泛提出，我也很惊讶，好像没有完整的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T22:10:08.973

HAProxy 应该为您执行 TCP 级别的排队。不过，在中间构建一个应用程序服务器会比 TCP 更有意识地处理传入流。这可能需要重写服务器和客户端，但可以让您更好地控制正在发生的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-19T22:24:27.473

你问的其实是一个相当复杂的问题。

首先你需要确定数据中的错位是否可以接受，例如：如果你在数据库中存储收到的 Likes 的数量，你在 12:00:00 询问这个数字，DB 中的数字是500，有人在12:00:01发了一个LIKE，你在12:00:02再次查询；是否可以再次收到“500”，即使正确的数字应该是 501，只要过一会儿答案“501”就出来了吗？

如果这是可以接受的（YouTube 中臭名昭著的“301 错误”），那么您可能会开始缓存一些 SELECT 响应。

您甚至可以将它们缓存在中间件中，即有一个特殊的进程连续运行并占用一个与 MySQL 的连接，并在队列中回答请求。您可以在服务器内部将它作为端口 8001 上的 Web 服务器运行，并使用 Apache ReverseProxy、HAproxy、磅或 NginX 位置在外部代理它。

即使比较棘手，您也可以对特殊的 UPDATE/DELETE 查询执行相同的操作。

如果有的话，最好先缓存通过 AJAX 异步运行的查询，因为使用代理序列化查询可能会明显降低应用程序的速度。

你有一个三重目标：

*   尽可能快地在 MySQL 上运行查询（查看索引和 MySQL 缓存）以释放 ConnectionPool 并使其尽可能轻负载。
*   重构应用程序以便从查询中提取所有信息（例如，具有特定属性的行数以及作为数据的行通常使用两个查询检索，但是通过适当的管理，您只需要一个和一个 SQLNumRows() 调用。另外，当一个查询可能一次性返回所有信息时，通常会运行具有不同信息的类似查询：通常，一个查询用于检查用户/密码，另一个查询用于获取完整的用户配置文件）。
*   将尽可能多的调用转移到根本不绑定到 MySQL 的东西（NginX、中间件）或轻微（排队进程）；在后一种情况下，使用已知数量的连接以可预测地运行。

不幸的是，没有简单的“灵丹妙药”来解决这个问题（当然，除了增加连接数，可能会在几个作为主从运行的主机上复制数据库。虽然不是真正的灵丹妙药，但它更容易设计和实现） .

# javascript - 检查是否使用 JavaScript 在 iPad 中加载视频

> ID：11569982
> 
> 赞同：0
> 
> 时间：2012-07-19T22:01:10.030
> 
> 标签：javascript, html, video, html5-video

我在检查 iPad 中是否正在加载视频时遇到了一些问题。我需要检查是否加载，因为我正在循环加载所有视频，增量为 video_1.mp4、video_2.mp4、video_3.mp4。但是，它似乎忽略了“readyState”并直接进入 else 语句。

这是代码：

```
function loadMedia() {
var media = document.getElementsByTagName("video")[0];

if (media.readyState === 4) {
    alert("Video has been loaded!");
} else {
    alert("Video hasn't been loaded!");
}
} 
```

iPad是否支持readyState？

**编辑：添加了更多代码。**

loadMedia 函数通过匿名函数绑定到 window.onload。

```
window.onload = (function () {
    loadMedia();
}); 
```

这是HTML：

```
<video class="video" controls="controls" poster="images/posters/tb_1.jpg" preload="metadata">
    <source src="media/tb_1.mp4" type="video/mp4; codecs='avc1.42E01E, mp4a.40.2'" />
    We apologize, but your browser does not support this video. Please consider an upgrade.
</video> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T22:14:16.417

Apple 文档似乎至少表明`readyState`自 iOS 3.0 以来就存在媒体元素：http: [//developer.apple.com/library/safari/#documentation/AudioVideo/Reference/HTMLMediaElementClassReference/HTMLMediaElement/HTMLMediaElement.html](http://developer.apple.com/library/safari/#documentation/AudioVideo/Reference/HTMLMediaElementClassReference/HTMLMediaElement/HTMLMediaElement.html)

这也许是一种间接的文档，但它是某种东西。

由于在设备上启动 JS 调试器可能很烦人，您可能需要更改此设置：

```
alert("Video hasn't been loaded!") 
```

对此：

```
alert("Video hasn't been loaded! " + media.readyState); 
```

如果您在浏览器中打开控制台（并且，如果您愿意，切换到`console.log()`而不是`alert()`），这应该会告诉您问题是 readyState 未定义（因此可能不受支持），或者问题可能`media`是未定义（似乎不太可能）。

当然，您可能还发现了一个错误。如果他们允许这样的事情，您可能想搜索 Apple 的错误跟踪器。

# python - 在python中使用minidom修改（更改特定元素）XML文件

> ID：11569988
> 
> 赞同：3
> 
> 时间：2012-07-19T22:01:35.017
> 
> 标签：python, xml, minidom

我有 n xml 文件，我想在其中更改三个元素。它是第一、第八和第十`<string>`元素。所以我想最简单的方法是这样的（但我愿意接受任何其他建议，谢谢！！）：

```
DOM = xml.dom.minidom
doc = DOM.parse(open(FILENAME))

a = doc.getElementsByTagName('string')
for i in range(len(a)):
    if i == 0:
        a[i] = new Element with new Text
    if i == 7:
        a[i] = new Element with new Text
    if i == 9:
        a[i] = new Element with new Text 
```

那基本上是我的文件：

```
<plist version="1.0">
<dict>
    <key></key>
    <string>CHANGE THIS</string>
    <string>aaa</string>
    <key>aaa</key>
        <dict>
            <key>aaa</key>
            <dict>
                <key>aaa</key>
                <string>aaa</string>
                <key>aaa</key>
                <false/>
            </dict>
            <key>aaa</key>
            <dict>
                <key>aaa</key>
                <string>aaaa.png</string>
                <key>aaa</key>
                <string>aaa</string>
                <key>aaa</key>
                <string>aaa</string>
            </dict>
        </dict>
        <key></key>
        <true/>
        <key></key>
        <string></string>
    <key></key>
    <string>CHANGE THIS</string>
    <key></key>
    <string></string>
    <key></key>
    <string>AND CHANGE THIS</string>
    <key></key>
    <string></string>
    <key></key>
    <string></string>
    <key></key>
    <key></key>
    <true/>
    <key></key>
    <string></string>
    <key></key>
    <key></key>
</dict>
</plist> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-23T07:57:15.310

我终于明白了这一点。

```
a = doc.getElementsByTagName('string')
for i in range(len(a)):
    if i == 0:
        a[i].firstChild.nodeValue = myvalue1
    if i == 7:
        a[i].firstChild.nodeValue = myvalue2
    if i == 9:
        a[i].firstChild.nodeValue = myvalue3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-18T09:51:28.900

有 3 个元素标签名为“ `string`”，而您只需要更改其中的 3 个。因此，您可以通过不循环其他 10 个元素来改进您的解决方案：

```
a = doc.getElementsByTagName('string')
a[0].firstChild.nodeValue = myvalue1
a[7].firstChild.nodeValue = myvalue2
a[9].firstChild.nodeValue = myvalue3 
```

这是一个很好的方法，因为如果您的 XML 文件有 100 万个条目，那么当您只需要处理其中的几个条目时，循环遍历它们并不好。

# active-directory - 使用 C# 扩展 LDAP 查询

> ID：11569997
> 
> 赞同：2
> 
> 时间：2012-07-19T22:02:25.670
> 
> 标签：active-directory, ldap, active-directory-group

我目前在这里有几种方法：

```
public ADHelper()
        {

           connection =  InitializeConnection();

        }

        private DirectoryEntry InitializeConnection()
        {
            DirectoryEntry ldapConnection = new DirectoryEntry("LDAP://servername.domain.com:389/DC=domain,DC=com");
            ldapConnection.Username = "user"
            ldapConnection.Password = "password";

            ldapConnection.AuthenticationType = AuthenticationTypes.Secure;
            return ldapConnection;

        } 
```

我想创建另一种方法来检查该域中是否存在对象。我目前正在执行以下操作：

```
public bool Exists(string objectPath)
        {
            bool found = DirectoryEntry.Exists("LDAP://" + objectPath);
            return found;
        } 
```

但这迫使我指定整个 LDAP 字符串。我想在 Exists() 方法中简单地使用 OU 和 CN 参数扩展初始 ldapConnection 。有没有办法在不公开 Initialize() 方法的情况下实现这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T21:53:48.550

也许是这样的：

```
public bool AccountExists(string userEmail)
{
    using (var root = GetLdapRoot())
    {
        using (var searcher = new DirectorySearcher(root))
        {
            searcher.Filter = string.Format("(&(objectClass=User)(mail={0}))", userEmail);
            searcher.PropertiesToLoad.Add("email");
            var result = searcher.FindAll();
            return result.Count > 0;
        }
    }
}

private static DirectoryEntry GetLdapRoot()
{
    return new DirectoryEntry("LDAP://DC=com"); //or whatever your root domain is. Set credentials if you need to
} 
```

通过设置过滤器并具体说明要加载的属性，搜索将更加有效。通过使用根目录作为 LDAP:// 字符串，您应该搜索整个目录。