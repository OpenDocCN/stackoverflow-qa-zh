# StackOverflow 问答 10034000-10034999

# http-status-code-404 - Smarty 网站内页无法正常工作

> ID：10034004
> 
> 赞同：2
> 
> 时间：2012-04-05T18:30:56.140
> 
> 标签：http-status-code-404

我正在由 Smarty 中的其他程序员完成的站点中执行一项任务。

**我的任务的基本流程**

1.  在管理面板中，用户上传 CSV 文件

2.  使用 cron 将 CSV 文件数据存储在 MySQL 数据库中。这是 Godaddy 的共享主机。

现在 cron 正在执行，但数据未导入。我必须解决这个问题。这是我最近几天正在处理的任务。注意 - 它没有完成。我正在做。

**问题**

今天客户发送了一封电子邮件，该网站的内页无法正常工作。但我只在网站的管理面板中工作。我确定我在管理文件夹中工作。客户说前端在我开始工作之前就已经工作了。

我的疑问是，当我调查这个问题时，我得到了线索。也就是说主页工作正常，主页的菜单从数据库中正确加载。只有少数页面只有在具有 SEF URL 时才会出现 404 错误，即 1) `http://www.example.com/category/Baseball-MLB`- 是 SEF url 并且不工作，但它在 URL 中工作正常 -`http://www.example.com/category.php?arg1=Baseball-MLB`

相同类型的链接适用于许多页面，但不适用于 SEF 网址。

我不确定是什么导致了这个问题。我在论坛中尝试过，但没有得到解决方案。该网站已上线，因此我必须尽快修复它。

# objective-c - Xcode 中的标签问题

> ID：10034006
> 
> 赞同：0
> 
> 时间：2012-04-05T18:31:02.250
> 
> 标签：objective-c, xcode, tags

我有一个显示 9 个 UIImageViews 的应用程序，并且我正在添加用户删除它们的功能。该代码工作正常，除了我在界面生成器中使用标签时遇到一些问题。似乎我的代码根据其在数组中的位置删除了 ImageView 中的图像。所以，如果我有 3 个 UIImageViews，我会将第一个 UIImageViews 标记设置为 1，第二个图像视图的标记设置为 2，第三个设置为 3。我尝试先删除第三个，然后我收到错误： **终止应用程序到期未捕获的异常 NSRangeException，原因：** * *'*****-[__NSArrayM removeObjectAtIndex:]: 索引 3 超出范围 [0 .. 1]'****

 **这是我正在使用的代码：

```
 - (IBAction)deleteButtonPressed:(id)sender {
    NSLog(@"Sender is %@", sender);
    UIAlertView *deleteAlertView = [[UIAlertView alloc] initWithTitle:@"Delete"
                                                              message:@"Are you sure you want to delete this photo?"
                                                             delegate:self
                                                    cancelButtonTitle:@"No"
                                                    otherButtonTitles:@"Yes", nil];
    [deleteAlertView show];
    int imageIndex = ((UIButton *)sender).tag;
    deleteAlertView.tag = imageIndex;

}

- (void)alertView: (UIAlertView *) alertView 
clickedButtonAtIndex: (NSInteger) buttonIndex
{

    if (buttonIndex != [alertView cancelButtonIndex]) {
        NSLog(@"User Clicked Yes. Deleting index %d of %d", alertView.tag, [array count]);
        NSLog(@"The tag is %i", alertView.tag);
        [self.array removeObjectAtIndex: alertView.tag];
        NSLog(@"After deleting item, array count  = %d", [array count]);
    NSLog(@"Returned view is :%@, in view: %@", [self.view viewWithTag:alertView.tag], self.view);
        ((UIImageView *)[self.view viewWithTag:alertView.tag]).image =nil;
    }

    [self.user setObject:self.array forKey:@"images"];
} 
```

我必须将第一个图像放在数组的 0 索引中，但我知道你不能有 0 标记，因为它是默认标记。所以，我不知道如何解决这个问题。非常感谢任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:40:14.677

我不认为静态标签作为索引号会起作用，因为即使你第一次删除它是正确的，如果你删除不是最后一个数组元素的东西，标签和数组偏移量的匹配也会改变。

您最好编写一个方法来遍历数组并返回带有匹配标记的项目。或者，如果您想通过标签直接访问，请使用字典并使用标签构建键。

标签匹配的代码如下所示：

```
- (UIImageView *)viewForTag:(NSInteger)tag {
    UIImageView *found = nil;
    for (UIImageView *view in self.array) {
        if (tag == view.tag) {
            found = view;
            break;
        }
    }
    return found;
}

- (void)alertView: (UIAlertView *) alertView clickedButtonAtIndex: (NSInteger) buttonIndex {
    // ...

    // Replacing: [self.array removeObjectAtIndex: alertView.tag];
    UIImageView *view = [self viewForTag:alertView.tag];
    if (view) {
        [self.array removeObject:view];
    }

    // ...
} 
```**

# ruby-on-rails - 在 ruby on rails 3 中使用 minimagick 仅缩放图像宽度

> ID：10034007
> 
> 赞同：2
> 
> 时间：2012-04-05T18:31:05.263
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rmagick, minimagick

我正在使用这种方法来调整图像的大小：

```
version :big do
            process :resize_to_fit => [560, 200]
            process :convert => :png
          end 
```

但是通过这种方法，我可以写出一个固定的高度。

我只想缩放或调整宽度图像。

我希望图像的高度是自动的，并将图像缩放到给定的宽度。

如何缩放或调整大小，只有宽度图像？

**我正在使用[minimagick 和 carrierwave](http://carrierwave.rubyforge.org/rdoc/classes/CarrierWave/MiniMagick.html)。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T19:21:28.160

实际上很容易做到这一点。这是一个例子：

```
 version :column do
    process :resize_to_fit => [250, nil]
  end 
```

这个版本将被重新调整，以便宽度是指定的值（在我的例子中是 250），并且将保留纵横比。

# java - 枚举的基本方法调用

> ID：10034009
> 
> 赞同：3
> 
> 时间：2012-04-05T18:31:11.907
> 
> 标签：java, methods, enums, invoke

我正在学习 Java 枚举，我想知道检查多个枚举的匹配值以调用特定方法的最佳方法是什么。我在下面定义了两个单独的枚举，getValue 方法的 colName 参数使用它们来确定要执行的方法。所以枚举驱动方法调用。必须有比我下面的方法更有效的方法来做到这一点。有什么建议么？

**我想避免必须执行以下操作（伪代码）：**

```
 if(colName.equalsIgnoreCase("ATTRIBUTEONE") || 
       colName.equalsIgnoreCase("ATTRIBUTETWO") || 
          colName.equalsIgnoreCase("ATTRIBUTETWO")){
             callAsStringMethod();
    } else if(colName.equalsIgnoreCase("ATTRIBUTEFOUR")){
         callAsIntegerMethod();
    } 
```

**我尝试使用枚举：**

```
 public class RowHelper implements IRowHelper
            public static enum StringAttributes {
                ATTRIBUTEONE,
                ATTRIBUTETWO,
                ATTRIBUTETHREE;
            }

            public static enum IntegerAttributes {
                ATTRIBUTEFOUR,
                ATTRIBUTEFIVE,
                ATTRIBUTESIX,
                ATTRIBUTESEVEN;
            }
            @Override
            public String getValue(String colName) throws Exception{    
                boolean colFound=false;
                Object retValue = null;
                for (EConstants.StringAttributes attribute : EConstants.StringAttributes.values()) {
                    if(colName.toUpperCase().equals(attribute)){
                        retValue = callAsStringMethod();
                        colFound=true;
                    }
                }
                for (EConstants.IntegerAttributes attribute : EConstants.IntegerAttributes.values()) {
                    if(colName.toUpperCase().equals(attribute)){
                        retValue = callAsIntegerMethod();
                        colFound=true;
                    }
                }
                if(!colFound)
                           throw new Exception("column not found");

                if(retValue instanceof String )
                    return (String) retValue;
                else
                    return retValue.toString();
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:38:22.313

试试这个：

```
public String getValue(String colName) throws Exception {

    final String name = colName != null ? colName.trim().toUpperCase() : "";

    try {
        EConstants.StringAttributes.valueOf(name);
        return callAsStringMethod().toString();
    } catch (Exception e1) {
        try {
            EConstants.IntegerAttributes.valueOf(name);
            return callAsIntegerMethod().toString();
        } catch (Exception e2) {
            throw new Exception("column not found");
        }
    }

} 
```

根据问题的最新编辑，该方法现在返回适当的值。

**编辑 ：**

根据 Kirk Woll 和 Louis Wasserman 的基准，循环`values`执行比执行`try/catch`. 所以这是原始代码的简化版本，希望它更快一点：

```
public String getValue(String colName) throws Exception {

    final String name = colName != null ? colName.trim().toUpperCase() : "";

    for (EConstants.StringAttributes attribute : EConstants.StringAttributes.values())
        if (name.equals(attribute))
            return callAsStringMethod().toString();

    for (EConstants.IntegerAttributes attribute : EConstants.IntegerAttributes.values())
        if (name.equals(attribute))
            return callAsIntegerMethod().toString();

    throw new Exception("column not found");

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T20:06:31.777

好吧，这是一个奇怪的设计._。无论如何，你可以使用枚举，但我想这样：

```
public interface RowAttribute {
    String getValue(IRowHelper rowHelper);
}

public class StringRowAttribute implements RowAttribute {
    @Override
    public String getValue(IRowHelper rowHelper) {
         return rowHelper.callAsStringMethod();
    }    
}

public class IntegerRowAttribute implements RowAttribute {
    @Override
    public String getValue(IRowHelper rowHelper) {
         return rowHelper.callAsIntegerMethod().toString();
    }    
}

public class RowHelper implements IRowHelper {
    private static final RowAttribute INTEGER_ATTRIBUTE = new IntegerRowAttribute();
    private static final RowAttribute STRING_ATTRIBUTE = new StringRowAttribute();

    private static enum Attribute {
            ATTRIBUTEONE(INTEGER_ATTRIBUTE),
            ATTRIBUTETWO(INTEGER_ATTRIBUTE),
            ATTRIBUTETHREE(INTEGER_ATTRIBUTE);
            ATTRIBUTEFOUR(STRING_ATTRIBUTE),
            ATTRIBUTEFIVE(STRING_ATTRIBUTE),
            ATTRIBUTESIX(STRING_ATTRIBUTE),
            ATTRIBUTESEVEN(STRING_ATTRIBUTE);

            private final RowAttribute attribute;

            private Attribute(RowAttribute attribute) {
                this.attribute = attribute;
            }

            public RowAttribute getAttributeResolver() {
                return this.attribute;
            }
    }
    @Override
    public String getValue(String colName) throws Exception {
        final String name = colName != null ? colName.trim() : "";
        for (Attribute attribute : Attribute.values()) {
            if (attribute.name().equalsIgnoreCase(name)) {
                return attribute.getAttributeResolver().getValue(this);
            }
        }
        throw new Exception(String.format("Attribute for column %s not found", colName));
    }
} 
```

然后，您不需要创建多个枚举并使用它的强大功能来遍历可能的值。您只需要将方法 callAsStringMethod/callAsIntegerMethod 公开。另一种方法是在 RowHelper 中插入实现。像这样的东西：

```
public class RowHelper implements IRowHelper {
    public interface RowAttribute {
        String getValue();
    }
    private static final RowAttribute INTEGER_ATTRIBUTE = new RowAttribute() {
        @Override
        public String getValue() {
            return callAsIntegerMethod().toString();
        }
    };
    private static final RowAttribute STRING_ATTRIBUTE = new RowAttribute() {
        @Override
        public String getValue() {
            return callAsStringMethod();
        }
    };
    ...
    @Override
    public String getValue(String colName) throws Exception {
        ...
        if (attribute.name().equalsIgnoreCase(name)) {
            return attribute.getAttributeResolver().getValue();
        }
        ...
    } 
```

}

无论如何，我不明白你的方法是如何在没有将 colName 作为参数传递给它的情况下真正获得属性值的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:32:28.373

坦率地说，使用多个枚举执行此操作的最有效方法是使它们成为相同的枚举。真的没有更好的办法了。

也就是说，您可以使用`Enum.valueOf(EnumClass.class, name)`指定名称来查找该类型的枚举值，而不是您拥有的循环，而不是像您正在做的那样循环。

# jquery - jQuery AFTER 点击事件

> ID：10034014
> 
> 赞同：2
> 
> 时间：2012-04-05T18:32:13.117
> 
> 标签：jquery, jquery-plugins

我正在尝试修改一个 Jquery 插件来修复错误。

以下是所有关联在一起的代码：

```
$('.' + settings.activeClass).live('click', function(){
    select(this);
    alert( $('#pg li.selected').height() );
    .......
});

function select(el){
hideSelected(function(){
    $(el).addClass('selected').removeClass('active');
    $(el).animate(settings.selectedCSS, 'slow');

});
} 
```

因此，在添加“选定”类之前，高度约为 116px

```
$(el).addClass('selected').removeClass('active'); 
```

添加'selected'类后，高度应该是大约378px，显示在呈现的html页面上，高度更新为378px

```
alert( $('#pg li.selected').height() ); 
```

但是，当我尝试打印高度的值时，它仍然捕获了添加“选定”类之前的旧值。

这是奇怪的部分，我添加了警告框以在添加“选定”类之后打印高度值，它应该获取高度的新值，但显然不是。

所以，我想到了一个解决方案，也许 JQuery 在点击事件后有某种事件？或任何替代解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:36:08.520

您的动画将执行警报的异步。您需要处理您希望在动画回调中实现的任何内容：

[http://api.jquery.com/animate/](http://api.jquery.com/animate/)

就像：

```
$('.' + settings.activeClass).live('click', function(){
  select(this);
  // NOT HERE alert( $('#pg li.selected').height() );
  .......
});

function select(el){
  hideSelected(function(){
    $(el).addClass('selected').removeClass('active');
    $(el).animate(settings.selectedCSS, 'slow', function(){
      //here
      alert( $('#pg li.selected').height() );
    });
  });
} 
```

编辑：正如我的评论中提到的，您还可以选择传递一个布尔参数来告诉动画函数处理异步或同步：

动画 API：[http ://api.jquery.com/animate/](http://api.jquery.com/animate/)

与处理队列相关的具体文本：

`.animate( properties, options )` *properties ：动画将向其移动的 CSS 属性映射。options 传递给方法的附加选项的映射。

支持的键：

1.  持续时间：确定动画将运行多长时间的字符串或数字。
2.  easing：一个字符串，指示用于过渡的缓动函数。
3.  完成：动画完成后调用的函数。step：动画的每一步之后要调用的函数。
4.  queue：一个布尔值，指示是否将动画放入效果队列。如果为 false，动画将立即开始。从 jQuery 1.7 开始， queue 选项也可以接受一个字符串，在这种情况下，动画被添加到由该字符串表示的队列中。

5.  specialEasing：由 properties 参数定义的一个或多个 CSS 属性及其相应的缓动函数的映射（添加 1.4）。

* -**直接取自 jquery.com 的文本 - 保留所有权利 jquery**

# php - 大数组，问题呼应

> ID：10034016
> 
> 赞同：-3
> 
> 时间：2012-04-05T18:32:17.210
> 
> 标签：php, arrays, echo

我遇到了这个问题，试图回显一个大数组。

print_r 看起来像这样： [http ://codepaste.net/5js97a](http://codepaste.net/5js97a)

在 foreach 循环中像这样回显前 2 行是没有问题的：$item['name']，但是对于数组内部更深的其余行，我只是得到一个错误。

谢谢！

**代码：**

```
function categories($parent = NULL) {
      $query = $this->db->where('parent_id', $parent)->get('categories');
      $results = $query->result_array();

      foreach($results as $result) {
           $child_array = Forummodel::categories($result['id']);
           if(sizeof($child_array) == 0) {
                array_push($results, $result['name']);
           } else {
                array_push($results, array($result['name'], $child_array));
           }
      }

      return $results;
} 
```

我也在使用codeigniter

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:33:07.797

您正在不断增加的数组上进行迭代。这是您的代码：

```
function categories($parent = NULL) {
    $query = $this ->db ->where('parent_id', $parent) ->get('categories');
    $results = $query->result_array();
    foreach($results as $result) {
        $child_array = Forummodel::categories($result['id']);
        if(sizeof($child_array) == 0) {
            array_push($results, $result['name']);
        } else {
            array_push($results, array($result['name'], $child_array));
        }
    }
    return $results;
} 
```

foreach 正在向下迭代数组`$results`，并且您在每个循环中添加它，此外，当您遇到`$result`不包含“id”或“名称”的迭代时，您可能会收到错误消息。如果您仍然想这样做，您可能希望将子数组放入另一个数组并在 foreach 循环之后合并它们。

# java - 单击JButton“输入”时如何将JTextField中的文本设置为JLabel

> ID：10034018
> 
> 赞同：0
> 
> 时间：2012-04-05T18:32:32.687
> 
> 标签：java, swing

我以为是这样的（但事实证明它什么也没做！）：

```
public void actionPerformed(ActionEvent e) {

    String labelID = e.getActionCommand();
    JTextField EnterName = new JTextField();
    JLabel NameINLabel = new JLabel();
    String random = new String();
    random = EnterName.getText();

    if (labelID == "Enter Name"){
        NameINLabel.setText(random);
    }
} 
```

我的按钮工作正常，没有任何问题。但是当我单击“输入名称”按钮时，jlabel 没有任何反应。帮助PLZ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T08:20:59.553

我同意 vaisakh，您需要在事件处理程序之外声明您的组件。您还需要将它们添加到内容窗格中。要比较字符串的内容，您应该使用`.equals("")`or`compareTo("")`方法。

# ruby - Ruby gem：如何在启动时运行初始化？

> ID：10034019
> 
> 赞同：0
> 
> 时间：2012-04-05T18:32:34.117
> 
> 标签：ruby, ruby-on-rails-3, gem

我正在将 Rails 插件转换为 gem，它在 init.rb 中有初始化，用于在插件启动时为插件运行。但是当我将此插件转换为 gem 时，此代码不再运行！我应该怎么做才能在 gem 启动时执行代码？

并且初始化是特定于 Rails 的，它需要 ::Rails.root

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:53:37.707

我的构建当前显示弃用警告，例如

> 弃用警告：您在供应商/插件中有 Rails 2.3 风格的插件！Rails 4.0 将删除对这些插件的支持。将它们移出并将它们捆绑到您的 Gemfile 中，或者将它们作为 lib/myplugin/* 和 config/initializers/myplugin.rb 折叠到您的应用程序中。有关更多信息，请参阅发行说明： [http](http://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-rc2-has-been-released) ://weblog.rubyonrails.org/2012/01/04/rails-3-2-0-rc2-has-been-released 。（从 $PROJECT_HOME/config/environment.rb:8 调用）

我认为这有你的答案；）

编辑：我刚刚意识到，如果它在加载 gem 时运行，也许也可以。在这种情况下，`lib/same-name-as-gem.rb`加载 gem 时自动需要（通过 bundler/rubygems）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:38:39.833

使用 Railties 初始化为我修复和问题。init.rb 没有在适当的时间运行来配置 Rails.root。

# actionscript-3 - flash config 常量的替代方法是什么？

> ID：10034021
> 
> 赞同：2
> 
> 时间：2012-04-05T18:32:59.160
> 
> 标签：actionscript-3, flash, config

我们有一个用 Flash 和 as3 构建的项目。它是一种我们想要完全自定义的视频播放器。我们有不同的图像和配色方案，我们希望能够非常快速地改变它们。现在我们有配置常量，我们可以为不同的方案打开和关闭。在代码中有大量不同的地方，图像等被改变了。

当我们创建一个新的配色方案或其他什么时，我们需要创建一个新的配置。然后我们必须遍历所有代码并正确放入。

基本上，对于我们如何采用当前的 Flash 项目（也许是 flex？）并使其可更快地进行定制的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:47:18.380

将所有可配置参数移至 XML 定义。

为每个定制创建多个 XML 文档。

在代码中，为可配置参数建立默认值，然后加载 XML 和 XML 文档的引用值作为对这些默认值的覆盖。

对于生产构建，如果加载外部资源是部署问题，则可以将 XML 嵌入到程序集中。

通过加载不同的配置 XML 文档，您可以在运行时更改定义，并且通过使用动态配置模型，您可以起草一个主题编辑器来实时查看更改。

配置模型.as

```
package
{
    import flash.events.Event;
    import flash.net.URLLoader;
    import flash.net.URLRequest;

    public class ConfigurationModel
    {

        /** ======== configuration ======== */

        public static var color:uint = 0xff00ff;

        public static var fontName:String = "Arial";

        /** ======== serialization ======== */

        public static function loadConfiguration(url:String):void
        {
            var loader:URLLoader = new URLLoader(new URLRequest(url));
            loader.addEventListener(Event.COMPLETE, completeHandler);
        }

        protected static function completeHandler(event:Event):void
        {
            var xml:XML = new XML(event.target.data);

            if (xml.color)
                color = xml.color;

            if (xml.fontName)
                fontName = xml.fontName;
        }

    }
} 
```

示例配置：AcmeClientConfiguration.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <color>0xff0000</color>
    <fontName>Calibri</fontName>
</configuration> 
```

# jsp - 从 JSP 调用 servlet 并返回到 JSP 中的同一行

> ID：10034022
> 
> 赞同：0
> 
> 时间：2012-04-05T18:33:08.397
> 
> 标签：jsp

是否可以从 JSP 调用 servlet 并且 servlet 返回到在同一 JSP 中调用它的同一行？

就像在 c/c++ 中调用另一个函数的函数一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:35:54.197

使用`<jsp:include>`.

```
<p>Blah blah.</p>
<jsp:include page="/servletURL" />
<p>Lorem ipsum.</p> 
```

请注意，应该生成 HTML 的 servlet 通常是一种气味。此外，如果 servlet 旨在预处理某些数据，您应该反过来调用它：通过其 URL 而不是 JSP 调用 servlet，并让 servlet 将请求转发给 JSP。另请参阅[我们的 servlets 标签 wiki 页面](https://stackoverflow.com/tags/servlets/info)。

# android - 跟踪用户交互 Android

> ID：10034023
> 
> 赞同：-1
> 
> 时间：2012-04-05T18:33:14.093
> 
> 标签：android

我是 Android 新手，正在开发一个在后台运行的应用程序，作为收集用户活动的服务。到目前为止，我的应用程序能够获取有关用户使用的其他应用程序的 Time_Start、Time_End 和名称的信息。

我想改进我的应用程序，以便能够计算用户在使用其他应用程序时进行的交互次数（如用户点击、触摸......）。有什么帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:49:33.517

如果触摸事件/按键在您的活动上下文或应用程序上下文*之外*， AFAIK**将无法捕捉它们。**我认为这***违反***了一般的设计原则（每个应用程序都在自己的 DVM 中被沙盒化）。

**此外，Android 提供了 Intents 机制来跟踪某些特定*操作*，而不是用户与移动设备的每次交互。所以，我认为这似乎不可能。**

# c# - Telerik 中 gridtemplateColumn 组合框的索引更改事件

> ID：10034024
> 
> 赞同：1
> 
> 时间：2012-04-05T18:33:18.363
> 
> 标签：c#, asp.net, combobox, telerik, radgrid

我可以写代码。在这个我可以使用一个模板列&在这个我构建一个 RadCombobox。当它的索引更改时，我想影响下面的文本框。Link 将 Combo box 的选中值设置为 Text on below TextBox。组合框和文本框是不同模板列的不同控件。

我可以像这样编写组合框的控件：

```
<telerik:RadComboBox ID="cmbGID" runat="server" DataSourceID="SqlDataSource8" DataTextField="Name"
                        DataValueField="ID" AutoPostBack="True" OnSelectedIndexChanged="cmbGID_SelectedIndexChanged"> 
```

但我不知道这个事件的参数是这样的：

```
protected void cmbGID_SelectedIndexChanged()
{
       //code...
} 
```

任何人请告诉我参数并告诉我是否可以设置 txtValue.Text = cmbGID.SelectedValue.ToString()...???

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T11:26:41.670

我得到了这个问题的解决方案......

这是通过以下代码工作的：

```
protected void cmbGrp_SelectedIndexChanged(object sender, RadComboBoxSelectedIndexChangedEventArgs e)
{
    RadComboBox ddlCtrl = sender as RadComboBox;
    GridEditableItem dataItem = ddlCtrl.NamingContainer as GridEditableItem;
    RadComboBox cmbCtrl = dataItem.FindControl("cmbSetNo") as RadComboBox;
    RadTextBox txtCtrl = dataItem.FindControl("cmbSetNo") as RadTextBox;
    txtCtrl.Text = ddlctrl.SelectedValue.ToString();

    string query = "QUERY";

    ds.Clear();
    ds = c.getDataSet(query);

    cmbCtrl.DataSource = ds.Tables[0];
    cmbCtrl.DataTextField = "NO";
    cmbCtrl.DataValueField = "RecordID";
    cmbCtrl.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:42:03.860

像这样的东西应该工作：

```
protected void vmbGID_SelectedIndexChanged(object sender, EventArgs e)
{
    var ddlCtrl = sender as RadComboBox;
    if (ddlCtrl != null)
    {
        var dataItem = ddlCtrl.Parent as GridDataItem;
        if (dataItem != null)
        {
            var txtCtrl = dataItem.FindControl("txtValue") as RadTextBox;
            if (txtCtrl != null)
            {
                txtCtrl.Text = ddlCtrl.SelectedValue;
            }
        }
    }
} 
```

# java - 如何将 JButtons 合并到图形中？

> ID：10034028
> 
> 赞同：1
> 
> 时间：2012-04-05T18:33:39.623
> 
> 标签：java, swing, user-interface, graphics, jbutton

我正在尝试编写棋盘游戏 RISK 的在线版本。我想把 JButtons 放在板上。所以基本上我希望 JButtons 在一些图像之上，但是我无法让它工作。这是我的代码：

```
 public void main(String[] args){
    JFrame frame = new JFrame("RISK");
    frame.setSize(800, 600);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JPanel panel = new JPanel();
    panel.setLayout(null);
    frame.add(panel);
    JButton button = new JButton("test");
    button.setBounds(100, 100, 150, 150);
    panel.add(button);

    frame.setVisible(true);
    frame.add(new graphics());
 }

 public void paintComponent(Graphics g) {
    super.paintComponent(g);
    try{
      BufferedImage board = ImageIO.read(new File("board.jpg"));
    }catch(IOException e){}
    g.drawImage(board, 0, 0, null);
 } 
```

非常感谢您提前。- 您的答案不需要参考这个特定的代码，只需一个带有图形和 JButtons 的一般示例就可以了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:44:31.327

如果您愿意，可以在按钮上添加图像。这是一个示例代码。

```
 BufferedImage myPictur =ImageIO.read(getClass().getResourceAsStream("/resources/shoppingicon.png"));
JButton shoppingButton = new JButton("Shopping",new ImageIcon(myPicture)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T18:57:43.990

首先，对于在线应用程序，特别是 Web，Swing 无法工作，因为它是为桌面应用程序设计的。如果您想要类似 Swing 的 Web 应用程序，请使用

*   Java 网络启动

*   小程序

*   GWT

现在让底部包含背景图像使用：

```
BufferedImage buferedImage;
JButton buttonImage;

buferedImage = ImageIO.read(getClass().getResourceAsStream("button-image-1.jpg")); 
buttonImage = new JButton("Start", new ImageIcon(buferedImage)); 
```

# api - 为什么 Mage_Persistent 会破坏 /api/wsdl?soap

> ID：10034032
> 
> 赞同：1
> 
> 时间：2012-04-05T18:34:23.420
> 
> 标签：api, session, magento

我在 Magento CE 1.6.1.0 中收到以下错误

`Warning: session_start() [<a href='function.session-start'>function.session-start</a>]: Cannot send session cookie - headers already sent by (output started at /home/dev/env/var/www/user/dev/wdcastaging/lib/Zend/Controller/Response/Abstract.php:586) in /home/dev/env/var/www/user/dev/wdcastaging/app/code/core/Mage/Core/Model/Session/Abstract/Varien.php on line 119`

访问时`/api/soap/?wsdl`

显然，在`session_start()`已经输出了 WSDL 文件的全部内容之后正在尝试 a ，从而导致错误。

为什么magento在输出所有数据后尝试启动会话？我很高兴你问。所以它看起来`controller_front_send_response_after`被 Mage_Persistent 钩住以便调用`synchronizePersistentInfo()`，这反过来又导致它`session_start()`被触发。

有趣的是，这并不*总是*发生，最初加载的 WSDL 对我来说很好，最初我绞尽脑汁想看看我们的安装可能进行了哪些自定义来导致这种情况，但是我已经完成了跟踪似乎表明这一切都完全发生在核心内部。

我们也经历了一点点（完全不相关的）对 Mage_Persistent 的陌生感，这让我更愿意在这一点上举手，所以它。

我已经对 SO 进行了一些搜索，并发现了一些与整个“标头已发送”相关的问题，但不是这种特定情况。

有什么想法吗？

哦，我的临时解决方法只是通过`persistent/options/enable`配置数据禁用 Mage_Persistent。我还进行了一些研究，以了解是否可以观察事件以便*仅为*WSDL 控制器禁用此模块（因为这似乎是唯一有问题的模块），但看起来该模块依赖仅在此配置标志上确定它的启用状态。

更新：已报告错误：[http ://www.magentocommerce.com/bug-tracking/issue?issue=13370](http://www.magentocommerce.com/bug-tracking/issue?issue=13370)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:16:42.973

我会向 Magento 团队报告这是一个错误。Magento API 控制器都通过标准 Magento 动作控制器对象进行路由，并且所有这些对象都继承自`Mage_Api_Controller_Action`该类。这个类有一个`preDispatch`方法

```
class Mage_Api_Controller_Action extends Mage_Core_Controller_Front_Action
{
    public function preDispatch()
    {
        $this->getLayout()->setArea('adminhtml');
        Mage::app()->setCurrentStore('admin');
        $this->setFlag('', self::FLAG_NO_START_SESSION, 1); // Do not start standart session
        parent::preDispatch();
        return $this;
    }
    //...
} 
```

其中包括设置一个标志以确保 API 方法不会启动正常的会话处理。

```
$this->setFlag('', self::FLAG_NO_START_SESSION, 1); 
```

所以，听起来好像有代码`synchronizePersistentInf`假设存在会话对象，并且当它使用它时，会话被初始化，导致您看到的错误。通常，这不是问题，因为此时每个其他控制器都已初始化会话，但 API 控制器明确将其关闭。

就修复而言，您最好的选择（可能是您从 Magento 支持获得的快速回答）将禁用默认配置设置的持久购物车功能，然后为需要它的特定商店启用它。这将使购物车

自己提出解决方案将是一个未知领域，我想不出一种方法来做到这一点，它不是非常糟糕/不稳定。最直接的方法是重写`synchronizePersistentInf`调用它的父方法的类，除非您检测到这是一个 API 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-12T22:29:18.280

这个答案并不意味着取代现有的答案。但是我想在这里删除一些代码，以防有人遇到这个问题，并且注释实际上不允许代码格式化。

我使用了一个简单的`local`代码池覆盖`Mage_Persistent_Model_Observer_Session`来退出函数中的任何 URL 路由`/api/*`

不期望此修复程序需要非常长寿或升级友好，b/c 我希望他们在下一个版本左右修复此问题。

```
public function synchronizePersistentInfo(Varien_Event_Observer $observer)
{
    ...

    if ($request->getRouteName() == 'api') {
        return;
    }

    ...
} 
```

# javascript - range.toString() 截断 javascript 按键事件中的最后一个字符

> ID：10034035
> 
> 赞同：1
> 
> 时间：2012-04-05T18:34:55.710
> 
> 标签：javascript, jquery, keypress, contenteditable

我正在编写一个函数来解析 contenteditable div 中的内联单词并用锚标签替换标签（@...，#...）。我在 keyup 事件中触发它，它运行良好。问题是我不仅想在用户点击空格之后替换标签，而且在他们点击非单词字符之后。由于 keyup 事件只能访问按下的键，而不是输入的实际字符，因此我无法识别标点符号。

我所做的只是更改按键事件，现在我的函数在创建锚点时省略了标签的最后一个字符。这是我的代码：http: [//jsfiddle.net/jwoah12/CcwSt/115/](http://jsfiddle.net/jwoah12/CcwSt/115/)。

wordStart 和 wordEnd 似乎有正确的值，但 j.toString() 产生错误的结果。

谢谢，
贾里德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:46:01.703

尝试以下操作：

在按键时，获取输入的字符，将其保存在变量中。在 keyup 上，查看变量中的值，如果是您要查找的标点符号，则执行替换逻辑。

# java - Android：带有单选按钮的 IF 语句不起作用

> ID：10034036
> 
> 赞同：2
> 
> 时间：2012-04-05T18:34:56.553
> 
> 标签：java, android

我正在尝试制作一个测验应用程序，因此有 5 个带有可能答案的单选按钮，只有 1 个是正确的。然后是一个提交按钮，它有一个 onClick="clickMethod" 来处理提交。

我的 clickMethod 看起来像这样：

```
public void clickMethod(View v){
                RadioGroup group1 = (RadioGroup) findViewById(R.id.radioGroup1);
                int selected = group1.getCheckedRadioButtonId();
                RadioButton button1 = (RadioButton) findViewById(selected);
                if (button1.getText()=="Right Answer")
                    Toast.makeText(this,"Correct!",Toast.LENGTH_SHORT).show();
                else
                    Toast.makeText(this,"Incorrect.",Toast.LENGTH_SHORT).show();
    } 
```

但是无论如何我都无法让 IF 语句起作用。如果我尝试使用“button1.getText()”作为参数制作吐司，它会打印“正确答案”字符串，但由于某种原因在 IF 语句中它不起作用，即使我检查了 ELSE 也总是执行正确答案。

有谁知道可能会发生什么或更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:39:17.890

您没有正确比较字符串。

> 当我们必须比较 String 对象引用时，使用 == 运算符。如果两个 String 变量指向内存中的同一个对象，则比较返回 true。否则，比较返回 false。请注意，'==' 运算符不会比较 String 对象中存在的文本内容。它只比较 2 个字符串指向的引用。

在这里阅读：[http ://www.javabeginner.com/learn-java/java-string-comparison](http://www.javabeginner.com/learn-java/java-string-comparison)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:39:27.630

您应该使用`equals`String 方法进行字符串比较：

```
public void clickMethod(View v){
    RadioGroup group1 = (RadioGroup) findViewById(R.id.radioGroup1);
    int selected = group1.getCheckedRadioButtonId();
    RadioButton button1 = (RadioButton) findViewById(selected);
    if ("Right Answer".equals(button1.getText())) {
        Toast.makeText(this,"Correct!",Toast.LENGTH_SHORT).show();
    } else {
        Toast.makeText(this,"Incorrect.",Toast.LENGTH_SHORT).show();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:39:34.700

在 Java 中，您不能将字符串与`==`必须使用的字符串进行比较`equals()`：

```
if (button1.getText().equals("Right Answer")) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T18:41:05.983

如果你想在 Java 中比较对象，你必须使用 equals() 方法而不是 == 运算符。

```
if (button1.getText().toString().equals("Right Answer")) {
 Toast.makeText(this,"Correct!",Toast.LENGTH_SHORT).show();
} else {
 Toast.makeText(this,"Incorrect.",Toast.LENGTH_SHORT).show();
} 
```

# performance - (TSQL) INSERT 查询加倍时间

> ID：10034040
> 
> 赞同：0
> 
> 时间：2012-04-05T18:35:10.720
> 
> 标签：performance, tsql, optimization, insert

我有一个相当复杂的多连接 TSQL SELECT 查询，它运行大约 8 秒并返回大约 30 万条记录。这是目前可以接受的。但是我需要多次重复使用该查询的结果，所以我将查询的结果插入到临时表中。表是预先创建的，其列与 SELECT 查询的输出相匹配。但是，只要我执行 INSERT INTO ... SELECT - 执行时间就会增加一倍以上，超过 20 秒！执行计划显示，46% 的查询成本用于“表插入”，38% 用于表假脱机（Eager Spool）。

知道为什么会发生这种情况以及如何加快速度吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:14:26.380

根据您提供的信息，我可以提出一些建议。如果您不关心脏读，您可以随时更改事务隔离级别（如果您使用的是 MS T-SQL）

```
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
select ... 
```

这可能会加快您的初始查询速度，因为不需要对您查询的数据进行锁定。如果您不使用 SQL Server，请在 Google 上搜索如何使用您正在使用的技术执行相同的操作。

对于插入部分，您说您正在插入临时表。您的数据库是否支持在临时表上添加主键或索引？如果是这样，则在其中有一个作为索引列的虚拟列。另外，您是否尝试过使用常规数据库表？根据您的设置，使用它可能会加快您的插入时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:00:33.833

“为什么”很难说，我们需要更多的信息。（尽管我的 SWAG 与日志记录有关……）

但是，10 次中有 9 次的解决方案是使用 SELECT INTO 来制作您的临时表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:44:37.320

我将从查看标准调整项目开始。磁盘在执行吗？是否有足够的资源（IO、RAM、CPU 等）？RDBMS 中是否存在瓶颈？听起来像问题，但锁定发生了什么？其他代码是否给出类似的结果？其他代码是否有效？

# jquery - 与jquery合并/压缩时jquery Confirm插件不起作用

> ID：10034041
> 
> 赞同：2
> 
> 时间：2012-04-05T18:35:15.287
> 
> 标签：jquery, confirmation

我找到[了这个用于内联确认的 jquery 插件](http://nadiana.com/jquery-confirm-plugin)。我将所有 js 文件压缩/合并为一个以优化 http 请求（这是手册）。现在这个文件的顶部是 jquery Library 1.7.1，然后我放了内联确认插件。因此，当位于带有 jquery 库的文件中时，此插件不起作用。我的问题是什么？

例如：正常：除了（这个工作）

```
<script type="text/javascript" src="./js/jquery.js"></script>
<script type="text/javascript" src="./js/inline-confirmation.js"></script> 
```

例如：压缩到一个文件（jquery + inline-confirmation）不工作

```
<script type="text/javascript" language="javascript" src="./js/main.js"></script> 
```

内联确认插件：

```
jQuery.fn.confirm = function(options) {
  options = jQuery.extend({
    msg: 'Are you sure?',
    stopAfter: 'never',
    wrapper: '<span></span>',
    eventType: 'click',
    dialogShow: 'show',
    dialogSpeed: '',
    timeout: 0
  }, options);
  options.stopAfter = options.stopAfter.toLowerCase();
  if (!options.stopAfter in ['never', 'once', 'ok', 'cancel']) {
    options.stopAfter = 'never';
  }
  options.buttons = jQuery.extend({
    ok: 'Yes',
    cancel: 'No',
    wrapper:'<a href="#"></a>',
    separator: '/'
  }, options.buttons);

  // Shortcut to eventType.
  var type = options.eventType;

  return this.each(function() {
    var target = this;
    var $target = jQuery(target);
    var timer;
    var saveHandlers = function() {
      var events = jQuery.data(target, 'events');
      if (!events && target.href) {
        // No handlers but we have href
        $target.bind('click', function() {document.location = target.href});
        events = jQuery.data(target, 'events');
      } else if (!events) {
        // There are no handlers to save.
        return;
      }
      target._handlers = new Array();
      for (var i in events[type]) {
        target._handlers.push(events[type][i]);
      }
    }

    // Create ok button, and bind in to a click handler.
    var $ok = jQuery(options.buttons.wrapper)
      .append(options.buttons.ok)
      .click(function() {
      // Check if timeout is set.
      if (options.timeout != 0) {
        clearTimeout(timer);
      }
      $target.unbind(type, handler);
      $target.show();
      $dialog.hide();
      // Rebind the saved handlers.
      if (target._handlers != undefined) {
        jQuery.each(target._handlers, function() {
          $target.click(this.handler);
        });
      }
      // Trigger click event.
      $target.click();
      if (options.stopAfter != 'ok' && options.stopAfter != 'once') {
        $target.unbind(type);
        // Rebind the confirmation handler.
        $target.one(type, handler);
      }
      return false;
    })

    var $cancel = jQuery(options.buttons.wrapper).append(options.buttons.cancel).click(function() {
      // Check if timeout is set.
      if (options.timeout != 0) {
        clearTimeout(timer);
      }
      if (options.stopAfter != 'cancel' && options.stopAfter != 'once') {
        $target.one(type, handler);
      }
      $target.show();
      $dialog.hide();
      return false;
    });

    if (options.buttons.cls) {
      $ok.addClass(options.buttons.cls);
      $cancel.addClass(options.buttons.cls);
    }

    var $dialog = jQuery(options.wrapper)
    .append(options.msg)
    .append($ok)
    .append(options.buttons.separator)
    .append($cancel);

    var handler = function() {
      jQuery(this).hide();

      // Do this check because of a jQuery bug
      if (options.dialogShow != 'show') {
        $dialog.hide();
      }

      $dialog.insertBefore(this);
      // Display the dialog.
      $dialog[options.dialogShow](options.dialogSpeed);
      if (options.timeout != 0) {
        // Set timeout
        clearTimeout(timer);
        timer = setTimeout(function() {$cancel.click(); $target.one(type, handler);}, options.timeout);
      }
      return false;
    };

    saveHandlers();
    $target.unbind(type);
    target._confirm = handler
    target._confirmEvent = type;
    $target.one(type, handler);
  });
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T01:53:00.763

我同意 rgin 的观点，我们可能需要查看整个文件（并且您可能应该将其分开），但我认为可能只是文件被缓存了。按 ctrl-F5 或手动清除缓存。

# mysql - 如何在结果集中添加一列并在该字段中设置值？

> ID：10034043
> 
> 赞同：1
> 
> 时间：2012-04-05T18:35:17.287
> 
> 标签：mysql

我有两张桌子

**人们**

```
name    id

man1    456
man2    123
man3    789 
```

**笔记**

```
content id

testing 123
hello   456 
```

`people`如果该人的注释存在，我有两个查询从表中选择记录。

`SELECT * FROM PEOPLE WHERE ID IN (SELECT ID FROM NOTES)`

```
name    id

man1    456
man2    123 
```

和

SELECT * FROM PEOPLE WHERE ID NOT IN（从注释中选择 ID）

```
name    id

man3    789 
```

我想在结果集中（不在实际表中）创建一列，并根据是否存在注释来设置字段的值。

```
name    id  does_note_exist

man1    456 yes
man2    123 yes
man3    789 no 
```

执行此操作的适当语法是什么？我正在寻找这样的东西：

```
IF ID IN (SELECT ID FROM NOTES)
   does_note_exist = yes        

IF ID NOT IN (SELECT ID FROM NOTES)
   does_note_exist = no 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:39:43.397

你需要一个`LEFT OUTER JOIN`：

```
SELECT 
    p.id, 
    p.name,
    CASE WHEN n.id IS NULL THEN 'no' ELSE 'yes' END AS does_note_exist
FROM people p
LEFT OUTER JOIN notes n
ON n.id = p.id
GROUP BY n.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:38:10.043

有很多方法可以做到这一点 - 我想我会使用案例声明： [http ://dev.mysql.com/doc/refman/5.0/en/case-statement.html](http://dev.mysql.com/doc/refman/5.0/en/case-statement.html)

# objective-c - 当 Cocoa 应用程序中的主线程被阻塞时，UI 不会更新

> ID：10034045
> 
> 赞同：3
> 
> 时间：2012-04-05T18:35:22.430
> 
> 标签：objective-c, multithreading, nsprogressindicator

我在我的主线程中使用 NSProgressIndicator 在我运行整个方法时更新进度。现在，当我最终从不同的类文件中调用一个对象，并等待该对象返回到我的主线程的值时，我注意到 NSProgressIndicator 将消失。我知道这是因为主线程被阻塞，直到我从另一个对象获得返回值。

所以我的问题是在主线程中更新 UI 而不阻塞它并让其他对象在后台运行并根据需要将值返回给主线程的推荐方法是什么。我知道如何使用块，但不允许块操作返回值。我需要的是帮助这个伪代码的东西：

```
-(IBAction) main {

//Update progress indicator UI to show progress
//perform an call to another object from another class.
// wait till i get its return value.
//Update progress indicator UI to show progress
// Use this return value to do something.
//Update progress indicator UI to show progress

} 
```

当调用另一个对象时，我注意到我已经完全消失了确定的 NSProgressIndicator，因为主线程被阻塞了。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T18:46:30.077

您上面的代码不是正确的方法。由于`main`永不返回，进度指示器将永远不会更新。您必须在主线程上快速返回。

相反，您要做的是设置一个后台块，在各个点更新主线程上的进度指示器。因此，例如：

```
- (IBAction)start:(id)sender {
  dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);

  dispatch_async(queue, ^{
    dispatch_async(dispatch_get_main_queue(), ^{[self.progress setProgress:0];});

    // Doing some stuff
    dispatch_async(dispatch_get_main_queue(), ^{[self.progress setProgress:.25];});

    // Doing more stuff
    dispatch_async(dispatch_get_main_queue(), ^{[self.progress setProgress:.75];});
  });
} 
```

（是的，这会导致队列保留`self`，但在这里没关系，因为`self`没有保留队列。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T18:44:28.027

[您可以使用 GCD ( Grand Central Dispatch](http://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html) )实现您正在寻找的东西。

这是一个帮助您入门的示例：

```
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0ul);
    dispatch_async(queue, ^{
        // Perform async operation
                dispatch_sync(dispatch_get_main_queue(), ^{
                    // Update UI
                });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:49:33.590

听起来您的操作应该在单独的线程中运行，这可以通过多种方式完成，但使用 NSOperationQueue 和自定义 NSOperation 类（设置它们比听起来更容易）或使用 NSInvokeOperation 类可能最容易实现。

然后，您可以使用 NSNotificationCenter 在主线程中将消息发送回您的类，或者使用键值观察 (KVO) 将消息设置为观察者。

最重要的是，您有多种选择，并且要做出最好的选择，应该了解底层技术。我会亲自从 Apple 的[Threaded Programming Guide](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Multithreading/Introduction/Introduction.html)开始，然后再读一遍，以确保在构建解决方案之前提取了所有优点。

# csv - 设置 WorkbookSaveAsArgs (Workbook) 对象的 TextCodepage 属性

> ID：10034049
> 
> 赞同：2
> 
> 时间：2012-04-05T18:35:36.743
> 
> 标签：csv, excel

伙计们，我正在尝试将used的`TextCodepage`属性设置为方法 SaveAs 的参数。用于将 .xls 文件转换为 .csv 文件。但是，此属性接收一个通用对象，我不知道如何正确设置它。在 msdn 文档中，它只[对 Microsoft Excel 中的所有语言说 Ignored。](http://msdn.microsoft.com/en-us/library/ff841185.aspx)或未[在美国英语 Excel 中使用。](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.excel.workbook.saveas%28v=vs.80%29.aspx). 当我的文档被转换时，它会生成无效字符，因为我的输入文件是葡萄牙语。因此，我需要一种接受这种语言的编码模式。有什么建议么？`WorkbookSaveAsArgs``Workbook`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-20T02:46:14.803

我只能建议使用 FileFormat:=xlUnicodeText 而不是 xlCSV 进行保存。但这样做时请使用“.csv”文件扩展名。这应该保留您的葡萄牙语字符。

# php - PHP Conditional > 如何知道什么不匹配？

> ID：10034052
> 
> 赞同：0
> 
> 时间：2012-04-05T18:35:47.670
> 
> 标签：php, conditional

如果我有声明：

```
$a = 1;
$b = 2;
$c = 3;
if($a == 1 && $b == 2 && $c == 3)
{
  echo 'correct';
}
else
{
  echo 'what variable's weren't matched';
} 
```

有没有办法知道什么没有看而不是单独写所有东西？

干杯!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:37:39.933

不，您的表达式已转换为布尔值，因此除了再次检查相等性之外，您无法找出触发“假”的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:39:32.000

您需要单独测试每个，但您可以执行以下操作：

```
$a = 1;
$b = 2;
$c = 3;

$a_matched = $a == 1;
$b_matched = $b == 1;
$c_matched = $c == 1;

if($a_matched && $b_matched && $c_matched)
{
  echo 'correct';
}
else
{
  if (!$a_matched) echo 'a did not match!';
  if (!$b_matched) echo 'b did not match!';
  if (!$c_matched) echo 'c did not match!';
} 
```

但这还不够清楚：

```
$a = 1;
$b = 2;
$c = 3;

if($a == 1 && $b == 2 && $c == 3)
{
  echo 'correct';
}
else
{
  if (!$a == 1) echo 'a did not match!';
  if (!$b == 2) echo 'c did not match!';
  if (!$c == 3) echo 'b did not match!';
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T18:47:24.900

其实，呵呵，我收回我的评论。您可以依靠布尔短路来设置一个变量，该变量指示条件的最后一部分为真：

```
if (($x = 'a') && $a == 1 && ($x = 'b') && $b == 2 && ($x = 'c') && $c == 3) {
  echo "correct\n";
} else {
  echo "$x is wrong\n";
} 
```

请注意，我永远不会在生产代码中编写它，因为它很愚蠢并且很难理解应该发生的事情。但至少玩起来很有趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:40:09.137

没有！那是不可能的。不过，您可以使用数组让生活变得更简单：

```
$results  = array(1, 2, 4);
$expected = array(1, 2, 3);
$count    = count($results);
$wrong    = array();

for($i = 0; $i < $count; $i++) {
    if($results[$i] !== $expected[$i]) {
        $wrong[] = $i;
    }
}

if(count($wrong) > 0) {
    echo "There were wrong ones. They were at positions: " . implode(', ', $wrong);
} else {
    echo "All good!";
} 
```

例如。

# java - Java新手。使用 Context 和 openFileInput 从文件读取问题

> ID：10034054
> 
> 赞同：-1
> 
> 时间：2012-04-05T18:35:56.597
> 
> 标签：java, android, android-context, contextpath

在过去的几个小时里，我一直在尝试自己做这件事，但有点失去了它。

我要做的就是打开一个文件，读取它并将其显示到控制台；而已。

**我正在使用 eclipse 为 android 2.3.3 开发。**

我已经尝试使用一堆不同的方式来处理我在这里和其他网站上找到的代码。这是我现在拥有的以及它的全部名称：

在 OnCreate 函数中：

```
setContentView(new TestMap(this)); 
```

测试地图类：

```
TestMap(Context context){
        super(context);
        // might need to be on the panel class
        loadTileFile("worldonelayout.txt", context); 
```

在同一个班：

```
private void loadTileFile (String filename, Context context){
        FileInputStream input = null;
        InputStreamReader reader = null;

        char[] inputBuffer = new char[256];
        String data = null;

        try {
            input = context.openFileInput("worldonelayout.txt");
            reader = new InputStreamReader(input);
            reader.read(inputBuffer);
            data = new String(inputBuffer);
            System.out.println(data);
            Toast.makeText(context, "Text read", Toast.LENGTH_SHORT).show();

        } catch (Exception e) {
            e.printStackTrace();
            Toast.makeText(context, "Text not read", Toast.LENGTH_SHORT).show();

        } finally {
            try {
                input.close();
                reader.close();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    } 
```

此代码不起作用。它总是遇到异常。

“/data/data/com.name.somethingiremoved/files/worldonelayout.txt（没有这样的文件或目录）”。

这发生在第一次 CATCH 中。顺便说一句，我的文件位于根目录中：`Documents\Eclipse\workspace\project\worldonelayout.txt`. 我还可以在左侧的浏览器中看到该文件

从我在这里和其他网站上看到的情况来看，这与从 Activity 派生的 Context 类有关吗？我不想将此代码与我的活动放在同一类中。有办法解决这个问题吗？

如果您需要我提供更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:49:31.077

打开的文件是在手机的文件系统上寻找文件，而不是在电脑的文件系统上。它会告诉你它希望在哪里找到它 - 在 /data/data/com.name.somethingirmoved/files/worldonelayout.txt 下的手机上

# asp.net - 如何在 SQL Server 的 log4net 配置中使用存储过程进行日志记录

> ID：10034055
> 
> 赞同：9
> 
> 时间：2012-04-05T18:35:58.667
> 
> 标签：asp.net, sql-server-2008, stored-procedures, logging, log4net

如何更新`commandText`存储过程的和参数部分，以便可以通过 log4net 将错误记录到 SQL Server？

我使用的是 SQL Server 2008，我的 appender 配置如下所示：

```
<appender name="ADONetAppender" type="log4net.Appender.ADONetAppender">
  <bufferSize value="100"/> 
  <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"/> 
  <connectionString value="server=MYSERVER; uid=MYUSER; pwd=MYPASS; database=MYDB"/> 
  <commandText 
    value="INSERT INTO Log ([Date],[Thread],[Level],[Logger],[Message],[Exception]) VALUES (@log_date, @thread, @log_level, @logger, @message, @exception)"

    />
  <parameter>
    <parameterName value="@log_date"/> 
    <dbType value="DateTime"/> 
    <layout type="log4net.Layout.RawTimeStampLayout"/>
  </parameter>
  <parameter>
    <parameterName value="@thread"/> 
    <dbType value="String"/> <size value="255"/> 
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%thread"/>
    </layout>
  </parameter>
  <parameter>
    <parameterName value="@log_level"/> 
    <dbType value="String"/> 
    <size value="50"/> 
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%level"/>
    </layout>
  </parameter>
  <parameter>
    <parameterName value="@logger"/> 
    <dbType value="String"/> 
    <size value="255"/> 
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%logger"/>
    </layout>
  </parameter>
  <parameter>
    <parameterName value="@message"/> 
    <dbType value="String"/> 
    <size value="4000"/> 
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%message"/>
    </layout>
  </parameter>
  <parameter>
    <parameterName value="@exception"/> 
    <dbType value="String"/> 
    <size value="2000"/> 
    <layout type="log4net.Layout.ExceptionLayout"/>
  </parameter>
</appender> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T18:39:54.083

试用：

```
 <commandText value="StorProcName" />
 <commandType value="StoredProcedure" />

 <parameter>
    <parameterName value="@log_date" />
    <dbType value="DateTime" />
    <layout type="log4net.Layout.RawTimeStampLayout" />
 </parameter>
 ... all parameters ... 
```

[log4net 在线配置示例页面](http://logging.apache.org/log4net/release/config-examples.html)：

> CommandText是 **准备好的语句或存储过程**。准备好的语句或存储过程的每个参数都使用其名称、数据库类型和呈现参数值的布局来指定。

# ffmpeg - ffprobe 显示 h264 流的比特率为 0.0 或 N/A

> ID：10034059
> 
> 赞同：4
> 
> 时间：2012-04-05T18:36:27.257
> 
> 标签：ffmpeg, bitrate

我有一个 11 分钟的 .mkv 文件，其中包含一个 h264 视频流，占用 184MB 空间。我想减小这个文件的大小。我想我可以降低比特率。但是 ffprobe 不输出任何内容。事实上，它说文件的长度是根据比特率计算的，因此可能不准确，但是在摘要或 [FORMAT] 条目中都没有比特率：

```
> ffprobe -show_format file.mkv
[matroska,webm @ 0x7f8e8084b200] Estimating duration from bitrate, this may be inaccurate
Input #0, matroska,webm, from 'file.mkv':
  Duration: 00:11:11.59, start: 0.000000, bitrate: N/A
    Stream #0.0: Video: h264 (High), yuv420p, 1280x720 [PAR 1:1 DAR 16:9], 29.97 fps, 29.97 tbr, 1k tbn, 59.94 tbc (default)
    Stream #0.1: Audio: aac, 48000 Hz, 5.1, s16 (default)
[FORMAT]
...
bit_rate=0.000000 
[/FORMAT] 
```

谢谢你。

编辑：我的理解是 H.264 是一种协议。因此，根据 ffprobe 文档，我无法判断 h264 编解码器使用什么实现。如果有人知道，我将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T20:44:11.710

文件大小 / 假定持续时间 = 比特率。（184 MB * 8192 [将 MB 转换为千比特]）/671 秒 = ~2246 千比特每秒。当然这是整个文件的平均比特率，而不仅仅是视频流。

如果您要针对特定​​的输出文件大小（例如 100 MB）并希望音频占用 128 kb/s：（100 MB * 8192）/671 秒 = 1220 kb/s 总比特率 - 128 kb/s 所需音频比特率 = 1092 kb/s 视频比特率。

实际输出文件的最终结果可能会有所不同。

# ruby-on-rails - 在 Heroku 上部署时 Ruby 模型 ID 发生变化

> ID：10034067
> 
> 赞同：0
> 
> 时间：2012-04-05T18:37:14.440
> 
> 标签：ruby-on-rails, ruby, heroku

我有一个模型（患者），我在添加新患者时设置了它自己的 ID。这是 db/schema.rb 的摘录：

```
t.integer   "my_patient_id",      :null => false 
```

出于某种原因，超出我的理解，当在本地运行*rails 服务器*并在本地添加患者时，`my_patient_id`它应该工作，即当用户输入值 123 时，该`my_patient_id`值也是 123。但是，在 Heroku 上部署时，`my_patient_id`似乎获取自动生成的（和连续的）值。

我的 Gemfile 看起来像：

```
group :development, :test do
  gem 'sqlite3-ruby'
  gem 'ruby-debug19', :require => 'ruby-debug'
end
group :production do
  gem 'pg'
end 
```

任何想法，将不胜感激。非常感谢！

# facebook - 我可以创建一个应用程序来监控用户在 Facebook 上的活动吗？

> ID：10034069
> 
> 赞同：-2
> 
> 时间：2012-04-05T18:37:19.350
> 
> 标签：facebook, facebook-graph-api, feed

我希望创建一个我和我的朋友会订阅的应用程序，然后它可以使用所需的权限（一种社交网络统计信息）监控新闻提要中的项目计数。

我阅读了开发人员文档，但我无法确定是否可能。订阅我的应用程序（并允许权限）对我的朋友来说是一次性的过程。从那时起，我的应用程序是否可以随时为订阅用户读取[Graph API](http://en.wikipedia.org/wiki/Facebook_Platform#Graph_API)中提到的字段（无需用户参与）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:54:48.957

不。

Facebook 曾经拥有“offline_access”权限，它可以让应用程序拥有一个不会过期的访问令牌。

不久前，尽管 Facebook 弃用了此权限，如*[Removal of offline_access permission](http://developers.facebook.com/roadmap/offline-access-removal/)*中所述。

令牌有效期最长（据我所知）是 60 天。如果您想延长该时间范围，您必须让用户与您的应用程序进行交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T23:36:17.077

您可能对使用Facebook的[实时更新 API感兴趣。](http://developers.facebook.com/docs/reference/api/realtime/)使用它，您将不再需要不断地“轮询”Graph API。相反，Facebook 会将更新发送到您的服务器。

以下是 API 的一些示例实现，[https://github.com/facebook/real-time/tree/master/samples](https://github.com/facebook/real-time/tree/master/samples)。

# node.js - 为什么它不调用 a.html

> ID：10034070
> 
> 赞同：-1
> 
> 时间：2012-04-05T18:37:19.590
> 
> 标签：node.js

```
 var http = require('http');
 http.createServer(function (req, res) {

if (req.url == '/') 
{
    req.url += "a.html";
    //facebookAPI(req,res);
}

    }).listen(1337); 
```

当我在浏览器中输入地址时，它没有调用该 URL。任何想法谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:05:23.457

这是您如何提供该文件的方法。这是未经测试的！

```
var http = require('http');
var fs = require('fs');
http.createServer(function (req, res) {
    if (req.url == '/') 
    {
        fs.readFile('a.html', 'utf8', function(err, data) {
          if(err) {
            res.end('Error Loading File');
            return;
          }

          res.end(data);
        });
    } else {
        res.writeHead(404, {'Content-Type': 'text/plain'});
        res.end('file not found');
    }
}).listen(1337); 
```

有更好的方法来完成同样的事情，但这应该让你开始。

# regex - 文本到 HTML 字符串解析一个 la Reddit 评论

> ID：10034071
> 
> 赞同：0
> 
> 时间：2012-04-05T18:37:22.937
> 
> 标签：regex, parsing, reddit

在过去的几个小时里，我一直在浏览 Reddit (https://github.com/reddit/reddit/wiki) 的源代码，但找不到我要找的东西：执行平面的函数文本到 HTML 的转换以供他们评论。

如果您不熟悉，网站上有一个表格，向您展示如何格式化您的评论并将您的纯文本转换为 html 以用于链接、粗体、斜体等。

**链接：** [http ://www.reddit.com/r/technology/comments/rupkj/5000_artists_line_up_for_a_pirate_bay_promotion/c48sy1v](http://www.reddit.com/r/technology/comments/rupkj/5000_artists_line_up_for_a_pirate_bay_promotion/c48sy1v) *（点击“回复”然后点击“格式化帮助”查看格式化选项表。）*

**样本输入：**

```
This should be: **bold** and **I'm also bold**

This should be: *italic* and *I'm italic too*

This should be: ~~strikethrough text~~

This should be: [A Link To Google.com](http://www.google.com)

This should be A list:
*This is a list
*Of differnet
*Things that I like 
```

知道如何使用正则表达式优雅地完成此任务吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T21:38:08.033

正如评论中所说，您可能正在寻找[Markdown](http://daringfireball.net/projects/markdown/)。

# url - SEO - DirectoryIndex 重复内容

> ID：10034077
> 
> 赞同：0
> 
> 时间：2012-04-05T18:37:56.860
> 
> 标签：url, seo, duplicates, directoryindex

在我正在处理的网站上，将有大约 7 个不同的目录。我`DirectoryIndex`在 my中使用`.htaccess`to 指向`index.php`，因此您可以转到`site.com/menu/`or`site.com/menu/index.php`并获取其他 6 个目录的相同内容，依此类推。

我知道重复的内容应该是不好的。这会导致任何 SEO 问题，还是搜索引擎足够聪明，可以理解它是一个`DirectoryIndex`并且只索引一次结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T15:36:02.877

使用 DirectoryIndex 是一种非常常见的做法。如果操作正确，这不是问题。但是，它可能会引入重复的内容。

*   选择一个是“规范的”。您可能希望使用 site.com/menu/ 作为规范。谁想在 url 中看到“index.php”？
*   切勿链接到非规范版本。而不是 href="index.php" 使用 href="./" 用户不应该通过单击站点在 url 中看到“index.php”。
*   如果您这样做，Googlebot 可能甚至永远不会知道文件的真实名称是什么，并且不会有任何问题。如果 Googlebot 确实开始抓取其中包含“default.php”的 url，则使用规范标签告诉 Google 哪个是它应该注意的正确 url。

# c# - 在 Getter 中将 PropertyChanged 提升到自己的属性时的行为？

> ID：10034082
> 
> 赞同：-1
> 
> 时间：2012-04-05T18:38:33.820
> 
> 标签：c#, wpf, silverlight, inotifypropertychanged

我正在这样做：

```
public string FirstName
{
    get
    {
        //Actual Code was doing something to change the value here
        this._FirstName = "Hello";
        this.OnPropertyChanged("FirstName");
        return this._FirstName;
    }
    set {
        if (this._FirstName == value)
            return;
        this._FirstName = value;
        this.OnPropertyChanged("FirstName");
    }
} 
```

如您所见，我在 FirstName 属性中提出了 FirstName 属性更改。我原以为这将是一个无限循环，`FirstName`getter 将继续调用自己。但奇怪的是***并没有发生。***

然后我尝试将 raise 属性更改放在里面`BackgroundWorker`：

```
public string _FirstName { get; set; }
public string FirstName
{
    get
    {
        BackgroundWorker worker = new BackgroundWorker();
        worker.DoWork += (sender, e) =>
            {
                Thread.Sleep(2000);
            };
        worker.RunWorkerCompleted += (sender, e) =>
            {
                this._FirstName = "Hi Hi";
                this.OnPropertyChanged("FirstName");
            };
        worker.RunWorkerAsync();
        return this._FirstName;
    }
    set {
        if (this._FirstName == value)
            return;
        this._FirstName = value;
        this.OnPropertyChanged("FirstName");
    }
} 
```

好了，这次是无限循环。 **但是为什么在第一种情况下没有发生呢？**

PS我不是想破坏程序，只是我在调试其他人的程序，他们在这里做的事情就像第一个案例一样。但该物业没有被第二次调用。

更新：测试用例 2 的 StackTrace：

我通过将此属性绑定到 TextBox 并在`FirstName`getter 上设置断点来测试它，我可以看到断点被无限次命中。

```
at Person.get_FirstName()  

at RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor)  

at RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)  

at RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)  

at RuntimePropertyInfo.GetValue(Object obj, BindingFlags invokeAttr, Binder binder, Object[] index, CultureInfo culture)  

at RuntimePropertyInfo.GetValue(Object obj, Object[] index)  

at CLRPropertyListener.get_Value()  

at PropertyAccessPathStep.get_Value()  

at PropertyPathListener.ReconnectPath()  

at <>c__DisplayClass4.<BreakOnSharedType>b__3()  

at RuntimeMethodHandle.InvokeMethod(Object target, Object[] arguments, Signature sig, Boolean constructor)  

at RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder...... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:51:03.723

按照设计，该`PropertyChanged`事件仅在属性值更改时引发。在 getter 中引发事件是不正确的，但它本身不会导致无限循环，甚至不会使用属性的第二个定义（使用`BackgroundWorker`）。

*但是*，`PropertyChanged`当消费者订阅您的事件时，在您的 getter 中引发几乎肯定会导致无限循环，因为事件处理程序通常会做的第一件事是通过其 getter 获取属性的新值。

即使在您的代码的第一个版本中，下面非常典型的示例也会导致无限循环：

```
Person person = new Person();
person.PropertyChanged += (object sender, PropertyChangedEventArgs e) =>
{
    Console.WriteLine("New name: " + person.FirstName);
};
person.FirstName = "ABC"; 
```

我的假设是你得到一个无限循环，因为你有一个事件订阅，它在你的第二个测试中访问 getter。

**编辑**：您将属性绑定到`TextBox`; 这解释了无限循环。在场景下，Silverlight（以及 WPF）订阅`PropertyChanged`您绑定到其类型实现的任何对象的事件`INotifyPropertyChanged`；这就是它设法将状态更新从您的代码隐藏对象传播到 UI 控件的方式。在其订阅的事件处理程序中，Silverlight 显然需要检索属性的新值，它通过调用属性 getter 来实现，从而实现无限循环。

但是，我确实相信，如果您使用属性的第一个定义（没有`BackgroundWorker`）并将对象绑定到`TextBox`.

# javascript - 光标移动问题的 iframe 设计模式

> ID：10034083
> 
> 赞同：1
> 
> 时间：2012-04-05T18:38:35.440
> 
> 标签：javascript, html, google-chrome

我在设计模式下有一个 iframe。当我开始输入文本并且框架区域结束时，滚动条被添加但光标保持在同一个地方。即使我能够写更多的文字。这仅在 chrome 中发生。它在Firefox中工作。这是 jsfiddle 网址

[http://jsfiddle.net/rG9EV/1/](http://jsfiddle.net/rG9EV/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T13:37:18.267

这是一个[已知的 Chrome 错误](http://crbug.com/20844)。您无能为力，只能使用另一种“在线编辑器”技术。

# gradle - 创建一个测试二进制文件的 Jar - Gradle

> ID：10034084
> 
> 赞同：51
> 
> 时间：2012-04-05T18:38:36.010
> 
> 标签：gradle

我正在使用最新版本的 Gradle（里程碑 9），并且试图弄清楚如何创建一个包含所有测试二进制文件的 Jar。

根据我在互联网上找到的内容，以下内容应该有效：

```
task packageTests(type: Jar) {
  from sourceSets.test.classes
} 
```

但是我得到了一个-

> 无法在源集测试上获取只写属性“类”的值。

编码我想要实现的目标的正确方法是什么？

现在是否以某种方式弃用了属性“类”？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2012-04-05T22:08:47.397

更改`sourceSets.test.classes`以`sourceSets.test.output`解决问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2021-04-12T18:06:28.117

2021 年现在有 Kotlin DSL，所以最新的答案是这样的：

```
tasks.register<Jar>("packageTests") {
    from(sourceSets.test.get().output)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-04T09:00:04.620

我用 Gradle / Groovy 这样做：

[https://github.com/tomasbjerre/gradle-scripts/commit/d550e6bf79574b4920b7910e48ebd94ca959cece](https://github.com/tomasbjerre/gradle-scripts/commit/d550e6bf79574b4920b7910e48ebd94ca959cece)

```
 task testJar(type: Jar, dependsOn: testClasses) {
    classifier = 'test'
    from sourceSets.test.allSource
  } 
```

# android - 如何将返回按钮添加到 Android Web App

> ID：10034085
> 
> 赞同：0
> 
> 时间：2012-04-05T18:38:38.010
> 
> 标签：android, eclipse, web-applications, webview

我正在尝试整理一个网络应用程序，但找不到一种可能的方法来包括通过手机的软键使用后退按钮。我该怎么做呢？即我想使用手机上的返回按钮返回上一个查看的网页。

谢谢

约旦

```
 package com.wear2gym;

import android.app.Activity;
import android.os.Bundle;
import android.view.Window;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Toast;

public class Wear2gym extends Activity
{
    final Activity activity = this;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
        setContentView(R.layout.main);
        WebView webView = (WebView) findViewById(R.id.WebView);
        webView.getSettings().setJavaScriptEnabled(true);

        webView.setWebChromeClient(new WebChromeClient() {
            public void onProgressChanged(WebView view, int progress)
            {
                activity.setTitle("Pumping some iron...");
                activity.setProgress(progress * 100);

                if(progress == 100)
                    activity.setTitle(R.string.app_name);
            }
        });

        webView.setWebViewClient(new WebViewClient() {
            @Override
            public void onReceivedError(WebView view, int errorCode, String description, String failingUrl)
            {
                 Toast.makeText(activity, "Sorry but there is no internet connection! " , Toast.LENGTH_LONG).show();
                 view.loadUrl("file:///android_asset/nointernet.html");
                // Handle the error
            }

            @Override
            public boolean shouldOverrideUrlLoading(WebView view, String url)
            {
                view.loadUrl(url);
                return true;
            }
        });

        webView.loadUrl("http://wear2gym.co.uk");
        webView.canGoBack();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:49:27.617

我不推荐 onBackPressed() ，因为它仅在 API 级别 5 后可用

你会在这里找到很好的信息：http: [//developer.android.com/guide/webapps/webview.html](http://developer.android.com/guide/webapps/webview.html)

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    // Check if the key event was the Back button and if there's history
    if ((keyCode == KeyEvent.KEYCODE_BACK) && myWebView.canGoBack() {
        myWebView.goBack();
        return true;
    }
    // If it wasn't the Back key or there's no web page history, bubble up to the default
    // system behavior (probably exit the activity)
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:47:28.803

覆盖`onBackPressed()`方法：

```
@Override
public void onBackPressed() {

    if(mWebView.canGoBack()) {
        mWebView.goBack();
    }
    else {
        super.onBackPressed();
    }
} 
```

这将返回`WebView`直到它不能返回，在这种情况下它将退出`Activity`

# c# - “不精确的故障”和 SIMD

> ID：10034089
> 
> 赞同：4
> 
> 时间：2012-04-05T18:38:52.607
> 
> 标签：c#, cil

我正在查看[CIL Spec](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-335.pdf)。在附录中，它谈到了“不精确的错误”，这意味着用户可以指定空引用异常等的确切顺序可以放宽。附录讨论了 JITer 可以使用它来提高性能的各种方法。

一个引起我注意的特定小节：

> **F.5.2 向量化循环**
> 
> 向量化循环通常需要知道两件事：
> 
> 1.  循环迭代是独立的
>     
>     
> 2.  循环迭代的次数是已知的。
>     
>     
> 
> 在对可能出现故障的检查放宽的方法中，第 1 部分经常是错误的，因为出现故障的可能性会导致从每个循环迭代到后续循环迭代的控制依赖性。在宽松的方法中，可以忽略这些控制依赖性。在大多数情况下，宽松的方法通过允许将检查提升到循环之外来简化矢量化。然而，即使这种提升是不可能的，忽略故障隐含的交叉迭代依赖性对于“短向量”SIMD 硬件（如 IA-32 SSE 或 PowerPC Altivec）的向量化可能是至关重要的。
> 
> 例如，考虑这个循环：
> 
> ```
> for (k = 0; k < n; k++) {
>    x[k] = x[k] + y[k] * s[k].a;
> } 
> ```
> 
> 其中 s 是引用数组。即使在宽松的上下文中，对空引用的检查也不能脱离循环。但是轻松确实允许成功应用“展开和卡纸”。循环可以展开 4 倍以创建聚合迭代，并将检查提升到每个聚合迭代的顶部。

也就是说，如果 JITer 使用这些宽松的故障，则表明循环可以自动转向 SIMD 操作。规范建议您可以使用 System.Runtime.CompilerServices.CompilationRelaxations 枚举来设置这些宽松的故障。但在实际的 C# 中，枚举只有 NoStringInterning 选项，没有任何其他选项。我已经尝试将 System.Runtime.CompilerServices.CompilationRelaxationsAttribute 设置为从[其他来源](http://www.gnu.org/software/dotgnu/pnetlib-doc/System/Runtime/CompilerServices/CompilationRelaxations.html)提取的一些 int 代码，但生成的 x86 程序集没有区别。

据我所知，微软官方 JIT 并没有实现这一点。而且我知道 Mono 有[Mono.Simd](http://docs.go-mono.com/index.aspx?link=N%3aMono.Simd)命名空间，所以我猜它也没有实现这个。

所以我很好奇我是否缺少关于该附录（以及第 12.6.4 节“优化”，也谈到了这一点）的一些历史记录。如果两个主要供应商都没有真正实施它，为什么它在标准中？微软是否有计划在未来开展这项工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:46:06.130

> 所以我很好奇我是否缺少关于该附录（以及第 12.6.4 节“优化”，也谈到了这一点）的一些历史记录。如果两个主要供应商都没有真正实施它，为什么它在标准中？微软是否有计划在未来开展这项工作？

我怀疑这是专门为了提供允许在某些时候实现它而不破坏实现或需要更改规范的选项。

> 但在实际的 C# 中，枚举只有 NoStringInterning 选项，没有其他选项

这是因为这`NoStringInterning`是目前唯一受支持的选项。由于 C# 中的枚举是可扩展的（它只是一个底层整数类型），因此可以轻松扩展运行时的未来版本以支持其他选项。

请注意，[在 VS UserVoice](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2212443-c-and-simd)站点上有一些建议供 Microsoft 在这方面进行改进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:08:23.210

这就是必须编写 CLI 规范的人的负担，他还不知道在抖动中实际实现这一点是否可行。那会在以后发生。

SIMD 是一个问题，它有一个非常硬的变量对齐要求。至少在编写 x86 抖动时，尝试对未对齐的变量应用 SIMD 指令会产生硬总线故障。不太确定在编写 x64 抖动时的最新技术是什么，但今天它仍然非常昂贵。x86 抖动不能比 4 字节对齐做得更好，x64 不能比 8 做得更好。它可能需要下一代 128 位内核来获得 16 字节对齐才能真正有效。我不会为此屏住呼吸:)

# matlab - 在图像中拉伸椭圆以形成圆形

> ID：10034095
> 
> 赞同：2
> 
> 时间：2012-04-05T18:39:27.447
> 
> 标签：matlab, image-processing

我想在图像中拉伸一个椭圆对象，直到它形成一个圆圈。我的程序当前输入一个带有椭圆物体（例如，硬币在一个角度）的图像，对其进行阈值化和二值化，使用边缘检测/bwboundaries() 隔离感兴趣的区域，并执行 regionprops() 来计算长轴/短轴长度.

本质上，我想使用“MajorAxisLength”作为直径并在短轴上拉伸对象以形成一个圆。任何关于我应该如何解决这个问题的建议将不胜感激。我已经附加了一些代码供您阅读（不幸的是，我没有足够的声誉来上传图像，二值化图像看起来像黑色背景上的白色椭圆）。

**编辑**：我还想将此技术应用于**图像的灰度版本**，以检查拉伸的样子。

代码片段：

```
rgbImage = imread(fullFileName);
redChannel = rgbImage(:, :, 1);
binaryImage = redChannel < 90;
labeledImage = bwlabel(binaryImage);
area_measurements = regionprops(labeledImage,'Area');
allAreas = [area_measurements.Area];
biggestBlobIndex = find(allAreas == max(allAreas));
keeperBlobsImage = ismember(labeledImage, biggestBlobIndex);
measurements = regionprops(keeperBlobsImage,'Area','MajorAxisLength','MinorAxisLength') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T04:42:48.380

您知道圆的直径，并且您知道圆心是长轴和短轴相交的位置。因此，只需根据直径计算半径`r`，对于图像中的每个像素，检查该像素与圆心的欧几里得距离是否小于`r`. 如果是这样，请将像素着色为白色。否则，别管它。

```
[M,N] = size(redChannel);
new_image = zeros(M,N);
for ii=1:M
    for jj=1:N
        if( sqrt((jj-center_x)^2 + (ii-center_y)^2) <= radius )
            new_image(ii,jj) = 1.0;
        end
    end
end 
```

这可以通过使用 meshgrid 函数结合逻辑索引来优化以避免循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-11T17:55:04.043

多亏了 matlab 论坛上的大量帮助，我终于设法弄清楚了所需的转换。我想我会把它贴在这里，以防其他人需要它。

```
 stats = regionprops(keeperBlobsImage, 'MajorAxisLength','MinorAxisLength','Centroid','Orientation');
    alpha = pi/180 * stats(1).Orientation;
    Q = [cos(alpha), -sin(alpha); sin(alpha), cos(alpha)];
    x0 = stats(1).Centroid.';
    a = stats(1).MajorAxisLength;
    b = stats(1).MinorAxisLength;
    S = diag([1, a/b]);
    C = Q*S*Q';
    d = (eye(2) - C)*x0;
    tform = maketform('affine', [C d; 0 0 1]');
    Im2 = imtransform(redChannel, tform);
    subplot(2, 3, 5); 
    imshow(Im2); 
```

# python - 如何为自定义类重载`float()`？

> ID：10034097
> 
> 赞同：14
> 
> 时间：2012-04-05T18:39:27.953
> 
> 标签：python, floating-point, operator-overloading, overloading

如何实现重载的方法`float()`，即当我编写的类的实例传递给时调用它`float()`？

我开始编写自己的`Fraction`课程：

```
class Fraction:
    def __init__(self, num = 0, denom = 1):
        self.num = float(num)
        self.denom = float(denom) 
```

现在我希望能够做到这一点：

```
float(Fraction()) 
```

我尝试使用下面的方法，但没有奏效。

```
def float(self):
    return self.num / self.denom 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-05T18:44:48.470

在您的类上定义[`__float__()`](http://docs.python.org/reference/datamodel.html#emulating-numeric-types)特殊方法。

```
class MyClass(object):
    def __float__(self):
         return 0.0

float(MyClass())   # 0.0 
```

请注意，此方法必须返回一个`float`! 假设两个操作数都是整数，那么在 3.0 之前的 Python 版本中，计算默认`self.num / self.denom`返回一个`int`。在这种情况下，您只需确保其中一个操作数是浮点数：`float(self.num) / self.denom`例如。

# c - 变量在一个函数中具有值，传递给另一个函数时为 0？

> ID：10034102
> 
> 赞同：0
> 
> 时间：2012-04-05T18:39:36.563
> 
> 标签：c, cuda

所以我的问题是，我将一个变量按值（它是一个浮点数）从我的 C 代码中的一个函数传递给另一个函数。由于某种原因，通过后变量为 0。我有多个其他浮点数按值传递，它们不是 0（都在同一个函数调用中），所以我不明白为什么会这样。它可能就像我没有看到的一些错字一样简单：

```
int cuda_call(float *h_DataA, float *h_Kernel, int numSmooths, float kernelSum, int KERNEL_R, int KERNEL_W, int DATA_W){

    printf("\n What am I here?: %f \n", kernelSum);
    convolutionProgram(h_DataA, h_Kernel, numSmooths, kernelSum, KERNEL_R, KERNEL_W, DATA_W);
    return 1;
}

extern "C" void convolutionProgram(float *h_DataA, float *h_Kernel, int numSmooths, float kernelSum, int KERNEL_R, int KERNEL_W, int DATA_W);

void convolutionProgram(float *h_DataA, float *h_Kernel, int numSmooths, float kernelSum, int KERNEL_R, int KERNEL_W, int DATA_W){

    printf("\n what am I now? %f \n", kernelSum);
    float
        *d_DataA,
        *d_DataB,
        *d_Temp,
    *d_Kernel;
       .......
} 
```

当我在被调用函数中得到第二个打印时，它是 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:29:18.627

也许您最终以某种方式混合了调用约定 (ABI)。例如，第一个编译单元可能正在执行`cdecl`调用，而第二个编译单元使用`fastcall`.

[http://en.wikipedia.org/wiki/X86_calling_conventions](http://en.wikipedia.org/wiki/X86_calling_conventions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:44:44.773

您是否可能没有为其中一个 c 文件重建目标文件？这看起来像是一个签名不匹配，它可以由函数签名更改引起，而无需重建两个目标文件。

# javascript - 如何将信息返回到 Objective-C 中的 javascript 函数？

> ID：10034103
> 
> 赞同：1
> 
> 时间：2012-04-05T18:39:37.297
> 
> 标签：javascript, iphone, objective-c

假设我有一个带有一些 javascript 函数的 UIWebView。我希望这些 javascript 函数能够从我的应用程序请求信息，并且我的应用程序应该返回它。我可以使用[URL Schemes](http://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW18)获取请求，但是我不知道如何将信息返回给 javascript 函数。

将 javascript 变量注入 UIWebView，然后以变量作为参数再次调用 javascript 函数是最好的方法吗？或者有什么方法可以用于 UIWebView？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:53:51.507

通过注入 Javascript`stringByEvaluatingJavaScriptFromString`绝对没问题。

另一个方向会更好地处理`webView:shouldStartLoadWithRequest:navigationType:`

[How to Properly Call ObjectiveC From Javascript](http://blog.techno-barje.fr/post/2010/10/06/UIWebView-secrets-part3-How-to-properly-call-ObjectiveC-from-Javascript/) (incl. Callback to JS) 详细描述了它，包括源代码。

使用 Objective-C returnValue 的示例 JS 代码：

```
NativeBridge.call("objCMethod", ["firstArgument"], function (returnValue) {
    if (returnValue) {
      // whatever
    } else {
      // whatever
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:59:00.583

使用异步通信。有一个用于 Objective C 例程的 Javascript 函数，以使用所需的任何回复参数回调到 Javascript。Javascript 回调函数甚至可以是通过 URL 方案发送到 Objective C 代码的参数之一。

# javascript - Html 5 data-attributes into jquery plugin options format

> ID：10034106
> 
> 赞同：0
> 
> 时间：2012-04-05T18:39:51.330
> 
> 标签：javascript, jquery, html

除了 jquery 插件选项之外，我还想用 html5 数据属性覆盖这些值。

* * *

这是选项的所需格式：

```
var defaults = {
   text: {
      color: 'red',
      opacity: 0.5
   },
   button: {
      width: 100,
      height: 30
   }
} 
```

我想像这样格式化数据属性：

```
<div data-text="color:'red', opacity: 0.5"></div> 
```

...但是您将无法读取此数据`o.text.color`，因为它根本不存在。但是里面有数据`o.text`。

如何格式化数据属性以便我可以使用 获取值`o.text.color`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:46:35.090

只需将格式为 json 字符串的对象传递给属性，jQuery 数据就会为您解析它。

```
<div class="test" data-test='{ "test1":"Lorem","test2":"Ipsum" }'></div> 
```

另请参阅[更新的小提琴](http://jsfiddle.net/fBc4E/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-28T10:26:38.110

这不是很干净，让我想起了 HTML 中的 onclick 事件。为什么不将它们分成 data-test1="Lorem" & data-test2="Ipsum"？

插件可能是这样的（扩展 jquery 插件样板）：

```
function Plugin( element, options, objD ) {
    this.element = element;
    this.options = $.extend( {}, defaults, options, objD );
    this._defaults = defaults;
    this._name = pluginName;
    this.init();
}

$.fn[pluginName] = function ( options ) {
  return this.each(function () {
    if (!$.data(this, "plugin_" + pluginName)) {
        var objD = $(this).data();
        $.data(this, "plugin_" + pluginName, new Plugin( this, options, objD ));
    }
  });
}; 
```

我不是大师，但对我来说效果很好

# jsp - arraylist 动态显示在行和列中

> ID：10034108
> 
> 赞同：0
> 
> 时间：2012-04-05T18:39:56.930
> 
> 标签：jsp, dynamic, arraylist, rows

我有一个数组列表。想要动态显示行和列中的值。例如，如果 arrylist 的大小为 59，我将保持列可配置为 20 或 15，并将大小除以列并得到编号。在数组列表中显示数据的行数。我无法弄清楚循环。这将在 jsp 中完成，并且假设我将列保留为 15 。59/15 =3 ，所以行数 = 3+1=4，3 行 45 个值，第 4 行 14 个。根据配置的列，它应该显示在下一行。

例如：1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31....（列数 =15）。

但是如果配置 noofcolumns=10 那么它应该在 10 列和 6 行中显示值（每行 10 个，第 6 行 9 个）。我正在尝试在 jsp 中进行拨号。

谢谢

更新：

这是我的代码，但它在一列中打印值..在 div 内垂直..希望它在 15 列和 4 行中显示

```
ArrayList<String> list= someList.get(1);     
for(int j= 1;j< list.size();j++) { 
String value = list.get(j); 
    { 
    %> <td> <input type="checkbox" id="checkboxid" name="checkboxid" value="<%=value%>" /><%=value %><br /> </td> <%
    }
} 
%> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-08T18:08:51.450

您应该尝试有 2 个循环。用列迭代行。确保你有一个正确的数据显示和迭代对象结构。

更多地考虑框架以纠正对象结构

# javascript - 声明一个带有数组的变量以及一个日期范围

> ID：10034109
> 
> 赞同：-2
> 
> 时间：2012-04-05T18:40:00.580
> 
> 标签：javascript, jquery, arrays, variables, range

我在这里更新了我的代码。我已经将范围放在了我需要在 datepicker 中的 beforeShowDays 中引用以禁用那些日子的 availableDays 函数中。

```
function unavailableDays(date) {

function createDateRange(first, last) {
var date = [];

for(var j = first; j < last; j.setDate(j.getDate() + 7))
dates.push(new Date(j.getTime()));

return date;
}

var disabledDays = createDateRange(new Date("1978-08-10"), new Date("1978-11-05"));

//date array to be disabled
var disabledDays = ["1963-3-10", "1963-3-17", "1963-3-24", "1963-3-31", "1965-9-18"];

var yy = date.getFullYear(), mm = date.getMonth(), dd = date.getDate();
for (i = 0; i < disabledDays.length; i++) {
if($.inArray(yy + '-' + (mm+1) + '-' + dd,disabledDays) != -1 || new Date() < date) {
return [false];
} }
return [true]; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:58:08.947

```
function createDateRange(first, last) {
    var dates = [];

    for(var i = first; i < last; i.setDate(i.getDate() + 7))
        dates.push(new Date(i.getTime()));

    return dates;
}

var disabledDays = createDateRange(new Date("1978-08-10"), new Date("1978-11-05")); 
```

[样本](http://jsfiddle.net/zC6aw/ "样本")

# linux - 从 IPsec 隧道转发流量

> ID：10034111
> 
> 赞同：-2
> 
> 时间：2012-04-05T18:40:07.633
> 
> 标签：linux, ipsec

设置：路由器 (192.168.50.1) 和 linux 主机 (192.168.50.10) 之间的 IPsec 隧道。

我想将流量（通过隧道到达主机）从主机转发到外部网络。

设置`ip_forward=1`没有帮助

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:25:41.247

你确定这不是路由问题？隧道的两端都是 RFC-1918 地址空间（所谓的私有地址空间），“外部网络”中的主机无法理解。您可能需要对路由器上的流量进行 NAT。

如果您认为这不是问题所在，请尝试转储流量（使用 tcpdump）以查看线路上实际移动的内容。

# ruby - Fuzzystringmatch gem 错误

> ID：10034114
> 
> 赞同：1
> 
> 时间：2012-04-05T18:40:18.707
> 
> 标签：ruby, gem, fuzzy-logic

我正在尝试使用`fuzzy-string-match`宝石。如果我尝试加载`irb`并输入，`require 'fuzzystringmatch'`我会收到所有这些错误

```
/Users/user/.rvm/gems/ruby-1.9.3-p125/gems/fuzzy-string-match-0.9.3/lib/fuzzystringmatch/inline/jarowinkler.rb:41:30: error: implicit conversion loses
  integer precision: 'size_t' (aka 'unsigned long') to 'int' [-Werror,-Wshorten-64-to-32]
_max = s1; _max_length = strlen(s1);
                       ~ ^~~~~~~~~~
/Users/user/.rvm/gems/ruby-1.9.3-p125/gems/fuzzy-string-match-0.9.3/lib/fuzzystringmatch/inline/jarowinkler.rb:42:30: error: implicit conversion loses
  integer precision: 'size_t' (aka 'unsigned long') to 'int' [-Werror,-Wshorten-64-to-32]
_min = s2; _min_length = strlen(s2);
                       ~ ^~~~~~~~~~
/Users/user/.rvm/gems/ruby-1.9.3-p125/gems/fuzzy-string-match-0.9.3/lib/fuzzystringmatch/inline/jarowinkler.rb:45:30: error: implicit conversion loses
  integer precision: 'size_t' (aka 'unsigned long') to 'int' [-Werror,-Wshorten-64-to-32]
_max = s2; _max_length = strlen(s2);
                       ~ ^~~~~~~~~~
/Users/user/.rvm/gems/ruby-1.9.3-p125/gems/fuzzy-string-match-0.9.3/lib/fuzzystringmatch/inline/jarowinkler.rb:46:30: error: implicit conversion loses
  integer precision: 'size_t' (aka 'unsigned long') to 'int' [-Werror,-Wshorten-64-to-32]
_min = s1; _min_length = strlen(s1); 
```

我做错什么了吗？我没有更改代码或任何东西。我将如何解决这个问题？有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T20:02:27.203

我通过 sym 将 /usr/bin/cc 链接到 /usr/bin/gcc 解决了这个问题。我在 Mountain Lion 上，Apple 的 LLVM 正在处理这些警告错误。

所以，我明确链接：

`ln -sf /usr/local/Cellar/apple-gcc42/4.2.1-5666.3/bin/gcc-4.2 /usr/bin/cc`

# java - 找出哪个方法叫我

> ID：10034118
> 
> 赞同：4
> 
> 时间：2012-04-05T18:40:36.777
> 
> 标签：java, reflection

我正在寻找一种方法来获取调用我的完整方法签名。

例如：

```
public class Called {

    public void whoCallMe() {
        System.out.println("Caller Method: " + new Throwable().getStackTrace()[1].getMethodName());
    }
}

public class Caller {

public static void run(int i) {
    new Called().whoCallMe();
}

public static void run(String str) {
    new Called().whoCallMe();
}

public static void run(boolean b) {
    new Called().whoCallMe();
}

/** MAIN **/
public static void main(String[] args) {
    run("hi");
} 
```

我实现 whoCallMe() 方法的方式我可以看到 run 方法调用了它，但是由于我 3 次重载我不能说哪一个是调用者，因为 whoCallme 只返回“run”作为方法名称。

你们知道我可以获得完整方法签名的其他方式吗 run(java.lang.String) ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:44:54.373

您可以使用 AspectJ 创建一个适用于每个方法调用的方面，并将有关被调用方法的详细信息添加到每个线程堆栈中，然后在方法完成后将其删除。当然，它会非常昂贵。很可能你不想这样做。你也不想扔任何东西来找出谁打电话给你。

**基本上你的问题的答案是：不要这样做。解释为什么你认为你想这样做，有人会给你一个很好的选择。**

另外，想一想，您可以争辩说方法重载（而不是覆盖！）被认为是有害的。您真的需要多个具有不同参数和相同名称的不同方法吗？

# python - Django中的表单提交疑难解答/数据库管理？

> ID：10034121
> 
> 赞同：0
> 
> 时间：2012-04-05T18:40:54.697
> 
> 标签：python, django, forms

所以在我的模型中。我有 blank=True 以便输入的表格可以是空白的。但是当用户提交表单时，它会在数据库中写入一个空白项目，而这并不是我真正希望它会做的事情。是否有其他选项来控制空白表单的处理方式？

编辑：最后，我希望表单将所有带有字符的字段添加到数据库中，并省略所有没有输入字符的字段。

模型.py

```
class Cashtexts(models.Model):
    cashcode = models.CharField(max_length=100, blank=True) #change me to a website filter
    superPoints_Link = models.CharField(max_length=100, blank=True)#chance to "superPoints _Username"
    varolo_username = models.CharField(max_length=100, blank=True)
    swagbucks_username = models.CharField(max_length=100, blank=True)
    neobux_username = models.CharField(max_length=100, blank=True)
    topline_id = models.CharField(max_length=100, blank=True)
    Paidviewpoint_id = models.CharField(max_length=100, blank=True)
    cashcrate_id = models.CharField(max_length=100, blank=True) 
```

这是视图

```
def submit_win(request):
    if request.method == 'POST':
        if Cashtexts.objects.filter(cashcode=request.POST['cashcode']).exists() or Cashtexts.objects.filter(superPoints_Link=request.POST['superPoints_Link']).exists() or Cashtexts.objects.filter(varolo_username= request.POST['varolo_username']).exists() or Cashtexts.objects.filter( swagbucks_username = request.POST['swagbucks_username']).exists() or Cashtexts.objects.filter(neobux_username = request.POST['neobux_username']).exists() or Cashtexts.objects.filter(superPoints_Link=request.POST['topline_id']).exists() or Cashtexts.objects.filter(superPoints_Link=request.POST['Paidviewpoint_id']).exists() or Cashtexts.objects.filter(superPoints_Link=request.POST['cashcrate_id']).exists() == False:
            form = CashtextsForm(request.POST)
            if form.is_valid():
                c={}
                c.update(csrf(request))
                form.save()
                return render_to_response('submitted_page.html',c)
        else: #Error message reading wither you didnt insert codes or you enter the same code twice
            error = 'you have already entered that code'
            ref_create = CashtextsForm()
            return render_to_response('submit.html', {'ref_create': ref_create,'error':error})
    else: #displays the page when the user asks to go to the submit page
        ref_create = CashtextsForm()
        return render_to_response('submit.html', {'ref_create': ref_create}, RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T22:32:35.800

> 我希望表单输入包含字符的所有字段，并希望表单省略输入空字符串，我意识到我可以使用多个提交按钮来执行此操作，但这对于超过 2 或 3 个字段来说变得很痛苦。

好吧，如果您不想要空字符串，那么我只能假设您想要 None 为空的字段。首先，您需要模型（以及数据库）来允许这样做，否则它将无法工作。

我相信以下应该有效：（虽然我不确定你为什么真的想要这个）

```
class Cashtexts(models.Model):
    cashcode = models.CharField(max_length=100, null=True, blank=True, default=None) 
```

# ruby - 如何在 irb 进程上运行 gdb 或 valgrind？

> ID：10034123
> 
> 赞同：2
> 
> 时间：2012-04-05T18:40:58.040
> 
> 标签：ruby, bash, gdb, irb

我正在编写一个 Ruby C 扩展，并且经常需要运行 GDB 或 Valgrind 来查找错误。为了调试我的规格，我使用这个：

```
namespace :spec do  
  RSPEC_CMD = [ 'ruby', '-S', 'rspec', '-Ilib:ext', SPECDIR ]

  desc "Run specs under GDB."
  task :gdb => [ :compile ] do |task|
          cmd = [ 'gdb' ] + GDB_OPTIONS
          cmd += [ '--args' ]
          cmd += RSPEC_CMD
          run( *cmd )
  end

  desc "Run specs under Valgrind."
  task :valgrind => [ :compile ] do |task|
          cmd = [ 'valgrind' ] + VALGRIND_OPTIONS
          cmd += RSPEC_CMD
          run( *cmd )
  end
end 
```

不幸的是，这对 IRB 不起作用，因为 IRB 是 Ruby 脚本而不是可执行文件。

我想答案是非常微不足道的，但我不知道足够的 shell 魔法来自己弄清楚。

需要注意的是，我需要能够*使用*IRB（输入命令），而不仅仅是*运行*IRB。

那么在 GDB（或 Valgrind）中运行 IRB 的命令是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-16T07:59:27.263

查看我在这里的 /usr/bin/irb （使用`which irb`），它只有`#!/usr/bin/ruby1.8`第一行中的 shebang（即在这种情况下，/usr/bin/ruby1.8 是实际运行的可执行文件）。所以你会把它交给gdb：

```
$ gdb -- /usr/bin/ruby1.8 
```

然后你可以指定 /usr/bin/irb 作为 Ruby 的参数，给你 irb 提示，因此：

```
(gdb) run /usr/bin/irb
Starting program: /usr/bin/ruby1.8 /usr/bin/irb
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
irb(main):001:0> print "Hello world\n"
Hello world
=> nil
irb(main):002:0> 
```

另外，我发现这个单线对我有用：

```
$ gdb -ex run --args /usr/bin/ruby1.8 /usr/bin/irb 
```

# c# - 为什么 XmlTextReader 在 WhitespaceHandling 设置为 None 或 Significant 时跳过节点

> ID：10034127
> 
> 赞同：1
> 
> 时间：2012-04-05T18:41:14.763
> 
> 标签：c#, xml-serialization, .net-2.0

我正在为此拔头发。我使用 XmlReader 进行了一些手动反序列化 - 没什么大不了的，做了无数次。但这是我想不通的事情。

这是示例 xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<Theme name="something" version="1.0.0.0">
  <Thumbnail length="1102">[some base64 encoded data]
</Thumbnail>
  <Backgrounds>
    <string>Themes\something\Backgrounds\file1</string>
    <string>Themes\something\Backgrounds\file2</string>
    <string>Themes\something\Backgrounds\file3</string>
  </Backgrounds>
  <Stickers>
    <string>Themes\something\Stickers\stick1</string>
    <string>Themes\something\Stickers\stick1</string>
    <string>Themes\something\Stickers\stick1</string>
  </Stickers>
  <PreviewImages>
    <string>Themes\something\Preview\rh_01.jpg</string>
    <string>Themes\something\Preview\rh_02.jpg</string>
    <string>Themes\something\Preview\rh_03.jpg</string>
  </PreviewImages>
</Theme> 
```

这是反序列化代码（有点简化）：

```
public void ReadXml(System.Xml.XmlReader reader)
{       
    /* Read attributes - not important here */

    while (reader.Read())
    {
        Console.WriteLine("Main: {0} {1}", reader.NodeType, reader.Name);
        switch (reader.Name)
        {
            case Xml.Elements.Thumbnail:
                this._thumbnail = Xml.DeserializeBitmap(reader);
                Console.WriteLine("Inner: {0} {1}", reader.NodeType, reader.Name);
                break;
            case Xml.Elements.Backgrounds:
                this._backgrounds = Xml.DeserializeListOfStrings(reader);
                break;
            case Xml.Elements.Stickers:
                this._stickers = Xml.DeserializeListOfStrings(reader);
                break;
            case Xml.Elements.PreviewImages:
                this._previewImages = Xml.DeserializeListOfStrings(reader);
                break;
        }

        if (reader.NodeType == System.Xml.XmlNodeType.EndElement
                && reader.Name == Xml.Root)
            break;
    }
} 
```

**问题：**

`this._thumbnail`反序列化后，位于***缩略图***节点`reader`的关闭元素上。然后在循环的开头被调用......并且定位在***字符串***节点的起始元素上。***背景***元素被跳过！为什么？*`reader.Read()``while``reader`*

 ***当`reader`is`XmlTextReader`并且它的`WhitespaceHandling`属性设置为`WhitespaceHandling.None`or时会发生这种情况`WhitespaceHandling.Significant`。

如果它设置为`WhitespaceHandling.All`一切都按预期工作。调用后`reader.Read()`定位`reader`在***背景***节点的起始元素上。

* * *

**[编辑]**我在示例代码中添加了两个调试行。

我得到`WhitespaceHandling.All`了这个：

```
Main: Whitespace 
Main: Element Thumbnail
Inner: EndElement Thumbnail
Main: Element Backgrounds
Main: Whitespace 
Main: Element Stickers
Main: Whitespace 
Main: Element PreviewImages
Main: Whitespace 
Main: EndElement Theme 
```

我得到`WhitespaceHandling.Significant`了这个：

```
Main: Element Thumbnail
Inner: EndElement Thumbnail
Main: Element string
Main: Text 
Main: EndElement string
Main: Element string
Main: Text 
Main: EndElement string
Main: Element string
Main: Text 
Main: EndElement string
Main: EndElement Backgrounds 
```

* * *

**[编辑 2]**调整了调试输出，使其更具可读性。

如您所见，调试输出`WhitespaceHandling.Significant`结束于`</Backgrounds>`. 那是因为我`Xml.DeserializeListOfStrings`还没有检查它是否定位正确并且“意外”将文档读取到最后。但这不是这个问题的范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T23:05:47.897

我头痛的原因是`XmlReader.ReadElementContentAsBase64`我用来反序列化`<Thumbnail>`节点的方法。我正在循环试验它：

```
private static byte[] ReadBytes(System.Xml.XmlReader reader)
{
    byte[] buffer = new byte[128];
    int length = XmlConvert.ToInt32(reader[Xml.Attributes.Length]);

    using (MemoryStream ms = new MemoryStream(length))
    {
        int count = 0;

        do
        {
            count = reader.ReadElementContentAsBase64(buffer, 0, buffer.Length);
            ms.Write(buffer, 0, count);

        } while (ms.Length < length);

        return ms.GetBuffer();
    }
} 
```

但是 MSDN 说：

> 如果计数值高于文档中的字节数，或者等于文档中的字节数，则 XmlNodeReader 读取文档中所有剩余的字节并返回读取的字节数。下一个 ReadElementContentAsBase64 方法调用返回零并将阅读器移动到 EndElement 节点之后的节点。
> 
> **如果在所有元素内容都被消费之前调用 Read**，阅读器的行为可能就像消费了第一个内容然后调用了 Read 方法。这意味着读者将阅读所有文本，直到遇到结束元素。然后它将读取结束标记节点，读取下一个节点，然后将自己定位在下一个后续节点上。

似乎尽管阅读到元素内容的末尾（我知道数据长度，所以理论上我可以做到这一点），但`XmlReader`并没有考虑到我已经“消耗”了所有元素的内容。这导致了 MSDN 中描述的一些意外行为。

和的`XmlReader`行为相同。我的代码可以使用，因为在最后一次调用之后，跳过了不重要的空格。如果源 xml 文件不包含换行符和制表符，我的代码也会失败。`WhietespaceHandling.All``WhietespaceHandling.Significant``WhietespaceHandling.All``XmlReader.ReadElementContentAsBase64``reader``WhietespaceHandling.All`

解决方案是修改 while 循环以`XmlReader.ReadElementContentAsBase64`在所有字节为红色之后再进行一次调用。这种方法的缺点是，在附加调用之后，将`reader`移动*到 EndElement 节点之后的节点*。

```
do
{
    count = reader.ReadElementContentAsBase64(buffer, 0, buffer.Length);
    if (count > 0)
        ms.Write(buffer, 0, count);

} while (count > 0); 
```

也可以使用`XmlTextReader.ReadBase64`方法一次读取整个元素内容，但由于我的类实现了 IXmlSerializable，我被迫只使用`XmlReader`base，所以这种方法对我不可用。***

# javascript - 用jQuery替换数字而不改变样式或其他所有内容

> ID：10034132
> 
> 赞同：0
> 
> 时间：2012-04-05T18:41:29.037
> 
> 标签：javascript, jquery

如何用拉丁数字替换阿拉伯数字，因为它不会将数字更改为 div:style 并且不会更改标签和...？怎么可能做到？

**演示：http:** [//jsfiddle.net/mCUvT/](http://jsfiddle.net/mCUvT/)

```
<div class="myGrid">
    <b style="top: 50px;">123456789-10-11-12</b>
    <br />
    <span style="margin: 20px 0 10px 5px">05-10-1390</span>
    <a href="http://blog.jsfiddle.net/" style="left: 20px">our blog</a>
</div>​

var grid= $(".myGrid");
grid.html(grid.html().replace(/0/g,"&#1776;"));
grid.html(grid.html().replace(/1/g,"&#1777;"));
grid.html(grid.html().replace(/2/g,"&#1778;"));
grid.html(grid.html().replace(/3/g,"&#1779;"));
grid.html(grid.html().replace(/4/g,"&#1780;"));
grid.html(grid.html().replace(/5/g,"&#1781;"));
grid.html(grid.html().replace(/6/g,"&#1782;"));
grid.html(grid.html().replace(/7/g,"&#1783;"));
grid.html(grid.html().replace(/8/g,"&#1784;"));
grid.html(grid.html().replace(/9/g,"&#1785;")); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:48:51.303

好的，花了一些时间来破解解码部分..但效果很好..我认为你不能转换只是替换整个 html，而是你需要解析每个`#textNode`并转换它们。请参阅下面的递归函数，它检查 textNode 并转换它们。

[**演示**](http://jsfiddle.net/skram/mCUvT/13/)

**免责声明**：请注意，下面的代码是一个草稿版本，肯定可以做很多改进。我会把它留给你或其他 SO 用户来纠正我。

**代码：**

```
var numConversion = {
    '0': '&#1776;',
    '1': '&#1777;',
    '2': '&#1778;',
    '3': '&#1779;',
    '4': '&#1780;',
    '5': '&#1781;',
    '6': '&#1782;',
    '7': '&#1783;',
    '8': '&#1784;',
    '9': '&#1785;'
};

$(document).ready(function() {
    var grid = $(".myGrid");

    var gridContent = grid.contents();
    convertText(gridContent);

    function convertText(contents) {
        contents.each(function() {
            if (this.nodeType == 3) {
                this.nodeValue =
                $("<div/>").html(convert(this.nodeValue)).text();
            } else if (this.nodeType == 1) {
                convertText($(this).contents());
            }
        });
    }

    $(".myGrid").html(grid.html());

    function convert(txt) {
        var resultTxt = '';
        var textChar = '';
        for (var i = 0; i < txt.length; i++) {
            textChar = txt.charAt(i);
            if (numConversion.hasOwnProperty(textChar)) {
                resultTxt += numConversion[textChar];
            } else {
                resultTxt += textChar;
            }
        }

        return resultTxt;
    }
}); 
```

# python - 创建对象列表

> ID：10034135
> 
> 赞同：0
> 
> 时间：2012-04-05T18:41:38.943
> 
> 标签：python, list, class

我正在开发一个基于文本的小游戏，但我在创建这个列表时遇到了麻烦`Food`，我想把我所有的`Food`（汉堡或热狗）都放在`listOfFood`. 在我的示例中，我只包括了两个，但它们都是以食物为基础的。

稍后我将遍历我`listOfFood`的做某事。我抽象了我的代码来提问（因为它有太多行，而其他信息与它无关）。

```
class Food():
    def __init__(self):
        self.name = 'Food'

class HotDog(Food):
    def __init__(self):
        Food.__init__(self)

class Burger(Food):
    def __init__(self):
        Food.__init__(self)

def createFoodList(myOrders):
    # A list that contain all the food (either Burger or Hotdog)
    listOfFood = []

    # Depend what is the type of the food, create that many food object
    # and then append it to the list of food
    if myOrders[0][0] == 'HotDog':
        for number in myOrder[0][1]:
            listOfFood.append(HotDot())
    if myOrders[0][1] == 'Burger':
        for number in myOrder[0][1]:
            listOfFood.append(Burger())

    return listOfFood

todayOrders = [['HotDog', 10], ['Burger', 5]]
print(createFoodList(todayOrders)) 
```

我想知道是否可以使用列表理解或类似方法来使我的`createFoodList`功能更好？因为我的想法是有很多不同的种类`Food`，所以如果我可以返回这个食物列表，基于`todayOrders`列表`['type of food', count]`并返回`[food, food, food.. ]`。我现在做的方式真的很复杂很长（我感觉这不是正确的方式）。

非常感谢。

**编辑：**除了列表理解之外，我还能做些什么来替换 if 语句`createFoodList`？这是决定的`[[food, count], [food, count]..]`，我创建了那个食物并将它附加到我的列表中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:45:39.100

```
foodmap = {'HotDog': HotDog, 'Burger': Burger}

print [foodmap[f]() for (f, c) in todayOrders for x in range(c)] 
```

`foodmap[f]`评估为`HotDog`or `Burger`（这些是类 - 不是类名，类本身）。调用`someclass()`创建一个实例，`soemclass`调用时不传递任何参数`someclass.__init__`。因此`foodmap[f]()`结合了这两者 - 它在其中查找类`foodmap`并使用该类来创建该类的实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T19:26:48.207

这看起来更像是工厂模式。您可以尝试以下解决方案

```
>>> class Food():
    def __init__(self,name='Food'):
        self.name = name
    def __repr__(self):
    return self.name

>>> class HotDog(Food):
    def __init__(self):
        Food.__init__(self,'HotDog')

>>> class Burger(Food):
    def __init__(self):
        Food.__init__(self,'Burger')

>>> def createFoodList(myOrders):
    return [apply(order[0]) for order in myOrders for i in xrange(0,order[1]) if callable(order[0])]

>>> todayOrders = [[HotDog, 10], [Burger, 5]]
>>> print(createFoodList(todayOrders))
[HotDog, HotDog, HotDog, HotDog, HotDog, HotDog, HotDog, HotDog, HotDog, HotDog, Burger, Burger, Burger, Burger, Burger] 
```

# floating-point - 为什么 NaN 不等于 NaN？

> ID：10034149
> 
> 赞同：152
> 
> 时间：2012-04-05T18:43:01.573
> 
> 标签：floating-point, language-agnostic, nan, ieee-754

相关的 IEEE 标准定义了一个数字常量 NaN（不是数字），并规定 NaN 应该与自身不相等。这是为什么？

我熟悉的所有语言都实现了这个规则。但它经常会导致严重的问题，例如当 NaN 存储在容器中时的意外行为，当 NaN 在正在排序的数据中时等等。更不用说，绝大多数程序员都希望任何对象都等于自身（在他们了解 NaN 之前），因此让他们感到惊讶增加了错误和混乱。

IEEE 标准经过深思熟虑，所以我确信 NaN 与自身比较是不好的，这是有充分理由的。我只是无法弄清楚它是什么。

编辑：请参阅[IEEE754 NaN 值的所有比较返回 false 的理由是什么？](https://stackoverflow.com/questions/1565164/what-is-the-rationale-for-all-comparisons-returning-false-for-ieee754-nan-values)作为权威答案。

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2014-05-14T23:06:12.737

**接受的答案是 100% 没有问题 WRONG**。没有半点错误，甚至一点点错误。我担心当这个问题在搜索中弹出时，这个问题会在很长一段时间内混淆和误导程序员。

NaN 旨在通过所有计算传播，像病毒一样感染它们，所以如果在你深入复杂的计算中某个地方遇到 NaN，你就不会冒出一个看似明智的答案。否则，通过恒等式 NaN/NaN 应等于 1，以及所有其他结果，例如 (NaN/NaN)==1、(NaN*1)==NaN 等。如果您认为您的计算在某处出错（四舍五入产生了零分母，产生 NaN) 等，那么你可能会从你的计算中得到非常不正确（或更糟糕：略微不正确）的结果，而没有明显的指示说明原因。

在探索数学函数的值时，NaN 在计算中也有很好的理由；链接文档中给出的示例之一是查找函数 f() 的 zeros()。完全有可能在用猜测值探测函数的过程中，你将探测一个函数 f() 没有产生合理结果的函数。这允许 zeros() 查看 NaN 并继续其工作。

NaN 的替代方法是在遇到非法操作（也称为信号或陷阱）时立即触发异常。除了您可能会遇到巨大的性能损失外，当时无法保证 CPU 会在硬件中支持它，或者操作系统/语言会在软件中支持它；每个人在处理浮点时都是自己独特的雪花。**IEEE 决定在软件中将其显式处理为 NaN 值，以便它可以跨任何操作系统或编程语言移植。正确的浮点算法通常在所有浮点实现中都是正确的**，无论是 node.js 还是 COBOL（哈哈）。

理论上，您不必设置特定的#pragma 指令、设置疯狂的编译器标志、捕获正确的异常或安装特殊的信号处理程序来使看似相同的算法实际正常工作。不幸的是，一些语言设计者和编译器编写者一直忙于尽其所能撤消此功能。

请阅读有关 IEEE 754 浮点历史的一些信息。这也是对委员会成员回答的类似问题的回答：[对于 IEEE754 NaN 值的所有比较返回 false 的理由是什么？](https://stackoverflow.com/questions/1565164/what-is-the-rationale-for-all-comparisons-returning-false-for-ieee754-nan-values/1573715#1573715)

[《专访浮点老人》](http://www.eecs.berkeley.edu/~wkahan/ieee754status/754story.html)

[《IEEE 浮点格式的历史》](http://cnx.org/content/m32770/latest/)

[每个计算机科学家都应该知道的浮点运算知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

* * *

## 回答 #2

> 赞同：116
> 
> 时间：2012-04-05T18:45:18.907

嗯，`log(-1)`给了`NaN`，`acos(2)`也给了`NaN`。这是否意味着`log(-1) == acos(2)`？显然不是。`NaN`因此，不等于自身是完全有道理的。

差不多两年后重新审视这个，这里有一个“NaN-safe”比较函数：

```
function compare(a,b) {
    return a == b || (isNaN(a) && isNaN(b));
} 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2012-04-08T01:50:42.900

我最初的回答（从 4 年前开始）从现代的角度批评了这个决定，而不了解做出决定的背景。因此，它没有回答这个问题。

正确答案在[这里](https://stackoverflow.com/a/1573715/336527)给出：

> `NaN`!=`NaN`源于两个务实的考虑：
> 
> `isnan( )`[...] NaN 在 8087 算术中形式化时没有谓词；有必要为程序员提供一种方便有效的检测 NaN 值的方法，这种方法不依赖于`isnan( )`可能需要很多年的编程语言

这种方法有一个缺点：它使 NaN 在许多与数值计算无关的情况下不太有用。例如，很久以后，当人们想用它`NaN`来表示缺失值并将它们放入基于散列的容器中时，他们就做不到了。

如果委员会预见到未来的用例，并认为它们足够重要，那么他们可能会选择更冗长的，`!(x<x & x>x)`而不是`x!=x`作为`NaN`. 然而，他们的关注点更加务实和狭隘：为数值计算提供最佳解决方案，因此他们认为他们的方法没有问题。

===

原答案：

很抱歉，尽管我很欣赏票数最高的答案中的想法，但我不同意。NaN 并不意味着“未定义” - 请参阅[http://www.cs.berkeley.edu/~wkahan/ieee754status/IEEE754.PDF](http://www.cs.berkeley.edu/~wkahan/ieee754status/IEEE754.PDF)第 7 页（搜索“未定义”一词）。正如该文件所证实的，NaN 是一个定义明确的概念。

此外，IEEE 的方法是尽可能遵循常规数学规则，如果不能，则遵循“最小意外”规则 - 参见[https://stackoverflow.com/a/1573715/336527](https://stackoverflow.com/a/1573715/336527)。任何数学对象都等于它自己，所以数学规则意味着 NaN == NaN 应该是 True。我看不出有任何有效和有力的理由来偏离这样一个主要的数学原理（更不用说不太重要的比较三分法规则等）。

结果，我的结论如下。

IEEE 委员会成员对此并没有想得很清楚，并且犯了一个错误。由于很少有人了解 IEEE 委员会的方法，或者关心标准对 NaN 的确切说明（也就是说：大多数编译器对 NaN 的处理无论如何都违反了 IEEE 标准），所以没有人发出警报。因此，这个错误现在嵌入到标准中。它不太可能被修复，因为这样的修复会破坏很多现有代码。

编辑：[这是一个](https://mail.python.org/pipermail/python-ideas/2012-October/016627.html)非常有用的讨论的帖子。注意：要获得公正的观点，您必须阅读整个线程，因为 Guido 与其他一些核心开发人员的观点不同。然而，Guido 个人对这个话题并不感兴趣，并且在很大程度上遵循了 Tim Peters 的建议。如果有人支持 Tim Peters 的论点`NaN != NaN`，请在评论中添加它们；他们很有机会改变我的看法。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-04-05T18:47:27.867

一个不错的属性是：如果`x == x`返回 false，`x`则为`NaN.`

（可以使用此属性来检查是否`x`存在`NaN`。）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-04-02T12:43:06.867

试试这个：

```
var a = 'asdf';
var b = null;

var intA = parseInt(a);
var intB = parseInt(b);

console.log(intA); //logs NaN
console.log(intB); //logs NaN
console.log(intA==intB);// logs false 
```

如果 intA == intB 为真，那可能会导致您得出结论 a==b，但显然不是。

另一种看待它的方式是，NaN 只是为您提供有关不是什么东西的信息，而不是它是什么。例如，如果我说“苹果不是大猩猩”和“橙子不是大猩猩”，你会得出结论“苹果”==“橙子”吗？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-19T18:54:26.340

实际上，数学中有一个概念被称为“统一”值。这些值是经过精心构建的扩展，用于协调系统中的外围问题。例如，您可以将复平面中的无限远环视为一个点或一组点，而一些以前自命不凡的问题就消失了。还有其他关于集合基数的例子，你可以证明你可以选择无限连续统的结构，只要 |P(A)| > |一个| 什么都没有。

免责声明：我只是根据我对数学学习期间一些有趣的警告的模糊记忆来工作。如果我在代表我上面提到的概念方面做得很糟糕，我深表歉意。

如果您想相信 NaN 是一个单独的值，那么您可能会对某些结果感到不满，例如等式运算符没有按照您期望/想要的方式工作。但是，如果您选择相信 NaN 更像是由一个单独的占位符表示的“坏”的连续统一体，那么您对等式运算符的行为非常满意。换句话说，你看不到你在海里钓到的鱼，但你钓到了另一条看起来一样但同样臭的鱼。

# entity-framework - 实体框架代码优先 + WCF DataService - 无法使其工作

> ID：10034150
> 
> 赞同：2
> 
> 时间：2012-04-05T18:43:01.980
> 
> 标签：entity-framework, ef-code-first, wcf-data-services

当我尝试询问服务时 - 我得到了一个例外

> 无法加载返回类型“System.Linq.IQueryable”的元数据

Inet 说该服务找不到模型文件。但是我使用代码优先，并且没有这样的文件。

我用`Microsoft.Data.Services`.

你可以说我的连接字符串是错误的。

但是当我尝试 init 时`myDbContext`，我的数据库是在没有表的情况下创建的。

创建上下文后没有断点被命中。

我能做些什么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T14:27:16.263

您可能缺少字段中的数据成员属性和类中的 datacontract 属性。

最好在您的 db 和 wcf 之间有一些轻量级，以便您可以添加特殊属性或创建复杂实体以在 wcf 端点中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T04:14:29.613

如果您缺少有关 EF Code First 和 WCF 数据服务的信息，请提供信息。

> 在 .NET Framework 4 中有两个程序集用于创建和使用 WCF 数据服务：**System.Data.Services.dll**和 **System.Data.Services.Client.dll**。如果您尝试将这些与 DbContext 和 Code First 类一起使用，它们将无法开箱即用。问题在于 DbContext，而不是 Code First。构建这些程序集时 DbContext 不存在，因此他们不理解它。

解决方法是要么使用**ObjectContext**（*DbConext 下使用 ObjectcContext*）

**[或者]**

使用**2011 年 3 月的 CTP**，其中包含知道如何使用 DbContext 的固定程序集（Microsoft.Data.Services.dll 和 Microsoft.Data.Services.Client.dll）。

查看 msdn 文章了解详情：

[http://msdn.microsoft.com/en-us/magazine/hh852588.aspx](http://msdn.microsoft.com/en-us/magazine/hh852588.aspx)

# jquery - JQuery 通配符替换 URL

> ID：10034151
> 
> 赞同：1
> 
> 时间：2012-04-05T18:43:02.347
> 
> 标签：jquery

我需要替换这个网址

http:///prod/ap4s/appleproducts/iphone/4S

和

http:///prods.aspx?prod_id=ap4s

从现有 url 中获取 productId "ap4s" 并将其作为查询字符串传递。

```
('a').each(function(){
   $(this).attr('href')    <--- Modify href here.. 
} 
```

我认为替换在这里没有太大帮助。所以寻找一些更好的选择或一些建议以朝着正确的方向前进......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:05:59.880

```
$('a').each(function(){
   $(this).attr('href','http:///prods.aspx?prod_id='+$(this).attr('href').split('/')[3]) 
} 
```

# regex - htaccess如何将子目录重定向到外部URL

> ID：10034152
> 
> 赞同：5
> 
> 时间：2012-04-05T18:43:04.120
> 
> 标签：regex, apache, .htaccess, mod-rewrite, redirect

我试过：

```
//301 Redirect Old File
Redirect 301 www.mydomain.com/subdirectory http://newurl.com 
```

但这让我进入了不存在的 newurl.com/subdirectory。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T19:26:24.853

启用 mod_rewrite 和 .htaccess，然后将此代码添加到 DOCUMENT_ROOT 下的 .htaccess 中：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} ^(www\.)?mydomain\.com$ [NC]
RewriteRule ^subdirectory/?$ http://newurl.com [L,R=301,NC] 
```

# javascript - javascript 上的安卓游戏

> ID：10034156
> 
> 赞同：0
> 
> 时间：2012-04-05T18:43:23.187
> 
> 标签：javascript, android, android-layout

我想为安卓创建一个真心话大冒险游戏。我实际上正在考虑一个用户界面，它会有一个瓶子，当用户允许它可以旋转时。 **我的问题是我可以在 android javascript 中做到这一点吗？** 因为我对 js 有一点了解，而且网上可能有一些与我的工作相关的代码。任何相关的建议或代码将不胜感激谢谢

我也可以在android上使用像jquery这样的javascript库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:45:15.653

使用[phonegap](http://phonegap.com/start/)进行开发可能会对您的项目有所帮助。是的，phonegap 确实支持 jquery 进行 android 开发。

# css - Chrome链接错误，添加甚至没有定义的样式（我认为）

> ID：10034158
> 
> 赞同：0
> 
> 时间：2012-04-05T18:43:48.243
> 
> 标签：css, google-chrome

在我的网站上，我有如下链接，（为了方便而缩短）

```
<a><h2 class="playerBar"></h2></a> 
```

有问题的 css 规则是，

```
.playerBar {border: 1px solid #222;} 
```

这是访问链接**之前**的样子，

[http://www.images.novactown.com/eg1.png](http://www.images.novactown.com/eg1.png "h2 .playerBar 是带有图像的黑条，其边框为 #222 的 1px")

请注意，它位于“**朋友**”选项卡上。

要创建错误效果，请单击第一个`h2`，它将带您进入该人的帐户页面。一旦将选项卡从**帐户**切换到**朋友**，然后再次单击第一个 h2，再次将选项卡切换到**朋友**，你会得到类似的东西......

[http://www.images.novactown.com/eg2.png](http://www.images.novactown.com/eg2.png "h2 .playerBar 现在有橙色边框，悬停时变为红色。")

我试过设置`a:visited`但没有任何反应，而且它只发生在 chrome 中（在 IE 和 MOZ 中测试）

这是问题的链接

[http://www.novactown.com/account?id=1#_friends](http://www.novactown.com/account?id=1#_friends)

（此外，此错误仅在从“**帐户**”选项卡开始时发生，然后如果您从一开始就加载“**朋友**”选项卡，则切换到“**朋友**”选项卡一切正常）

 **是什么原因造成的，我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:50:32.143

所以它`outline-color: red;`在你的锚标签上呈现。

我会尝试设置`outline:0`，或 `outline-color: none;`在您的 li/anchor 上。**

# vim - 在 Mac Lion 上设置终端 Vim 配色方案

> ID：10034160
> 
> 赞同：0
> 
> 时间：2012-04-05T18:43:54.703
> 
> 标签：vim, macvim

我刚刚将我的 Mac 更新为 lion，我正在尝试配置 bash 和 vim 配色方案。

我创建了`~/.vim/colors`文件夹并将配色方案放在那里。由于某种原因，文本颜色都是相同的。所以它要么全是绿色，要么全是青色，要么全是黄色。macvim 和终端 vim 也一样。

在我开始配置之前，我安装了 CSApprox 插件。也许这会以某种方式阻止它正常工作。

如何在 Mac Lion 上设置终端 Vim 配色方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T07:06:12.367

我不得不添加

```
:syntax on 
```

到我的.vimrc，然后它工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T15:20:10.173

也许吧，如果可以的话，你可以试试`gvim`。如果没问题，那么说明`terminal`问题的原因。如果`gvim`遇到同样的问题，它会显示`vim`插件或配置（在 .vimrc 文件中）将是原因。通过这种方式，可以避免不必要地删除插件或重新配置。

# r - R中的Fama MacBeth标准错误

> ID：10034161
> 
> 赞同：5
> 
> 时间：2012-04-05T18:43:55.787
> 
> 标签：r, regression, standard-error, panel-data

有谁知道是否有一个包可以在 R 中运行 Fama-MacBeth 回归并计算标准误差？我知道该`sandwich`程序包及其估计 Newey-West 标准误差以及提供聚类功能的能力。但是，我没有看到任何关于 Fama-MacBeth 的信息。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-12T14:21:56.953

该`plm`软件包可以估计 Fama-MacBeth 回归和 SE。

```
require(foreign)
require(plm)
require(lmtest)
test <- read.dta("http://www.kellogg.northwestern.edu/faculty/petersen/htm/papers/se/test_data.dta")
fpmg <- pmg(y~x, test, index=c("year","firmid")) ##Fama-MacBeth

> ##Fama-MacBeth
> coeftest(fpmg)

t test of coefficients:

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 0.031278   0.023356  1.3392   0.1806    
x           1.035586   0.033342 31.0599   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
```

但是请注意，此方法仅在您的数据可以强制转换为`pdata.frame`. （如果你有它会失败`"duplicate couples (time-id)"`。）

有关详细信息，请参阅：

*   [R中的Fama-MacBeth和Cluster-Robust（按公司和时间）标准错误](http://landroni.wordpress.com/2012/06/02/fama-macbeth-and-cluster-robust-by-firm-and-time-standard-errors-in-r/)

# c++ - 汽车在我的游戏 C++ 中无法正确移动

> ID：10034166
> 
> 赞同：0
> 
> 时间：2012-04-05T18:44:27.603
> 
> 标签：c++, game-physics, trigonometry

我去过这个网站试图整理我的汽车运动。[http://www.helixsoft.nl/articles/circle/sincos.htm](http://www.helixsoft.nl/articles/circle/sincos.htm)

由于我使用过的 sin 和 cos，我一直在将汽车绕一圈移动时遇到问题，尽管该站点确实使用定点数并且我想使用浮点数，但我认为我已经正确完成了。

这是我的代码

```
 if(myEngine->KeyHeld(Key_W))
    {
        length -= carSpeedIncrement;
    }
    if(myEngine->KeyHeld(Key_S))
    {
        length += carSpeedIncrement;
    }
    if(myEngine->KeyHeld(Key_A))
    {
        angle -= 0.01f;
    }
    if(myEngine->KeyHeld(Key_D))
    {
        angle += 0.01f;
    }

    carVolocityX = length * (sin(angle));
    carVolocityZ = length * (cos(angle));

    carPositionX += carVolocityX; 
    carPositionZ += carVolocityZ; 

    car[0]->MoveX((carPositionX * sin(angle)) * frameTime);
    car[0]->MoveZ((carPositionZ * cos(angle)) * frameTime); 
```

我对如何做这个动作的新想法持开放态度，但它必须使用向量。任何人都可以看到我在哪里出错了。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:40:05.577

根据您对 MoveX 和 MoveZ 的看法，我认为问题在于您试图将绝对位置传递给期望速度的函数。尝试

```
car[0]->MoveX(carVolocityX * frameTime);
car[0]->MoveZ(carVolocityZ * frameTime); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:48:54.960

为什么在计算速度矢量和计算汽车的新位置时都应用 sin 和 cos？

您的代码看起来像是在尝试使用键盘驾驶汽车。如果是这种情况，试试这个

```
car[0]->MoveX((carPositionX) * frameTime);
car[0]->MoveZ((carPositionZ) * frameTime); 
```

请注意，我发现在实际计算距离期间应用 frameTime 更清楚，并建议进行此编辑：

```
carPositionX += carVolocityX * frameTime; 
carPositionZ += carVolocityZ * frameTime; 

car[0]->MoveX((carPositionX));
car[0]->MoveZ((carPositionZ)); 
```

相反，如果您只想将其绕一圈移动，并且不允许“A”和“D”影响角度，

```
car[0]->MoveX((carPositionX * sin(angularVelocity * totalTime)));
car[0]->MoveZ((carPositionZ * cos(angularVelocity * totalTime))); 
```

您可以使用键来调整（新）变量 angularVelocity，或者只是分配一个常数来查看它的工作情况。变量 totalTime 是自模拟开始以来的总时间。

# python - python菱形继承以及派生类的父类中super()的使用

> ID：10034175
> 
> 赞同：6
> 
> 时间：2012-04-05T18:44:52.060
> 
> 标签：python, python-2.7, multiple-inheritance

首先，我必须为没有更好的标题道歉。如果您找到更合适的，请随时更改它。

基本上，我一直被 Python 的多重继承行为所困扰。在我[之前的 SO 问题](https://stackoverflow.com/questions/10018757/how-does-the-order-of-mixins-affect-the-derived-class)中，我被指示阅读[Python 的 C3 MRO](http://www.python.org/getit/releases/2.3/mro/)。这确实有助于我更好地理解 Python 中的多重继承。就在我以为我掌握了它的时候，我碰到了以下场景，我似乎无法理解。

```
class UltimateBase(object):
    def check(self):
        print 'base check'

class AMixin1(UltimateBase):
    def check(self):
        print 'check A'

class BMixin1(UltimateBase):
    def check(self):
        print 'check B'

class CMixin1(UltimateBase):
    def check(self):
        print 'check C'

class AMixin2(UltimateBase):
    def check(self):
        print 'check A'
        return super(AMixin2, self).check()

class BMixin2(UltimateBase):
    def check(self):
        print 'check B'
        return super(BMixin2, self).check()

class CMixin2(UltimateBase):
    def check(self):
        print 'check C'
        return super(CMixin2, self).check()

class MyView1(AMixin1, BMixin1, CMixin1):
    pass

class MyView2(AMixin2, BMixin2, CMixin2):
    pass

class MyView3(AMixin1, BMixin2, CMixin2):
    pass

class MyView4(AMixin2, BMixin1, CMixin2):
    pass

class MyView5(AMixin2, BMixin2, CMixin1):
    pass

class MyView6(AMixin1, BMixin1, CMixin2):
    pass

class MyView7(AMixin1, BMixin2, CMixin1):
    pass

class MyView8(AMixin2, BMixin1, CMixin1):
    pass

myview1 = MyView1()
myview2 = MyView2()
myview3 = MyView3()
myview4 = MyView4()
myview5 = MyView5()
myview6 = MyView6()
myview7 = MyView7()
myview8 = MyView8()

myview1.check()
print '------------------------'
myview2.check()
print '------------------------'
myview3.check()
print '------------------------'
myview4.check()
print '------------------------'
myview5.check()
print '------------------------'
myview6.check()
print '------------------------'
myview7.check()
print '------------------------'
myview8.check()
print '------------------------' 
```

输出：

```
check A
------------------------
check A
check B
check C
base check
------------------------
check A
------------------------
check A
check B
------------------------
check A
check B
check C
------------------------
check A
------------------------
check A
------------------------
check A
check B
------------------------ 
```

我可以根据观察输出找出一个模式，但它让我不理解这个结果背后的基本原理。

我有一些问题，例如，为什么`myview2.check()`返回

```
check A
check B
check C
base check 
```

不是

```
check A
base check 
```

在我看来，我错过了关于多重继承的关键部分。请为我填补空白。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:48:55.203

当您调用 时`myview2.check()`，它会遍历兄弟姐妹，然后调用基类。每当其中一个遍历命中`AMixin1`,`BMixin1`或`CMixin1`时，它就会停止，因为这些类不调用`super(..., self).check()`.

正如 Benn 所指出的，这在[官方 Python 文档](http://docs.python.org/library/functions.html?highlight=super#super)中有所描述。如果你仔细想想，它几乎必须以这种方式工作。子类将假定在子类调用之前未调用基类方法`super()`。如果是（或者，更糟糕的是，如果它取决于列出其兄弟姐妹的顺序），那么事情就会变得非常难以处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-14T12:59:48.223

试图让我明白同样的问题。我发现以下代码有助于简化问题：

（基本上，当`super`一个类的所有 s 都被击中时，该类被调用。）

```
class A:
  def f(self):
    print("............A: the common base of B and C")

class B(A):
  def f(self):
    print("........B: the left base of D")
    super().f()

class C(A):
  def f(self):
    print("........C: the right base of D")
    super().f()

class D(B,C):
  def f(self):
    print("....D: the top class")
    super().f()

d = D()

d.f() 
```

输出：

```
....D: the top class
........B: the left base of D
........C: the right base of D
............A: the common base of B and C 
```

[在线试用](https://repl.it/LFiI/0)

# entity-framework-4 - 实体框架 4.3.1 DBContext 连接

> ID：10034181
> 
> 赞同：0
> 
> 时间：2012-04-05T18:45:05.497
> 
> 标签：entity-framework-4

我正在尝试从 DbContext 访问底层数据库和连接对象，以便在库例程中运行一些 SQL“旧样式”。这个库例程使用 DbContext，因为它可以从许多地方调用。这在 4.1 中有效，但是在 4.3.1 中我遇到了错误......

这是相关代码的大纲

```
using (testentities te = new testentities())
{
    var result = CallGeneric(te, some parameters);
}

public static Results CallGeneric(DbContext db, some parameters);
{
    var connection = (SqlConnection)db.Database.Connection;

    // do some stuff here

} 
```

在 EF 4.1 中，这有效，我可以直接使用连接。我使用 NuGet 更新到 EF 4.3.1，这不再有效。关于如何获得底层连接的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-09T18:10:29.573

解决方案是卸载 EF 4.1，然后重新安装 EF 4.3.1

# php - FireFox & IE Jquery 不工作

> ID：10034183
> 
> 赞同：0
> 
> 时间：2012-04-05T18:45:08.300
> 
> 标签：php, javascript, jquery, ajax

我为验证码创建了 PHP GD 图像，`image.php` 每次生成动态验证码图像时都会调用该文件。

* * *

在`signup.php`我有

```
<img alt="" src="image.php"> 
<input type="button" id="btn" value="cant read captcha">
<!--btn is to load another captcha--> 
```

* * *

脚本.js

```
$("#btn").click(function(){  
    $("img").attr('src','image.php');
}); 
```

适用于 Chrome、Safari 和 Opera，但不适用于 IE 和 Firefox。

**我该如何解决这个问题或有任何替代解决方案？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:59:05.547

dom加载后代码是否运行？如果没有，请尝试：

```
$(function(){
  $("#btn").click(function(){ 
    $("img").attr('src','image.php');  
  });
}); 
```

你的控制台有错误吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T19:12:14.593

尝试在 url 末尾添加随机数，这可能是缓存问题，例如

```
$("#btn").click(function(){  
    $(this).prev("img").attr('src','image.php?rnd='+Math.random());
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:06:26.033

也许尝试这种添加查询字符串的方法来防止浏览器缓存。

[如何在 jQuery 中重新加载/刷新元素（图像）](https://stackoverflow.com/questions/2104949/how-to-reload-refresh-an-elementimage-in-jquery)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T19:08:00.417

试试这个代码

```
$(function(){

  $("#btn").live("click",function(){ 

       $("img").attr('src','image.php');  

  });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-06T04:53:54.443

**$("image").attr("src","image.php?timestamp=" + new Date().getTime());**

* * *

我认为这是缓存
firefox 的问题，即不会一次又一次地从源中选择图像，
但它通过更改图像名称从缓存中加载
它现在在所有浏览器中都为我工作，
thanx 每一个

# firefox - DOCTYPE 在 Firefox 中不起作用

> ID：10034190
> 
> 赞同：0
> 
> 时间：2012-04-05T18:45:40.973
> 
> 标签：firefox, doctype

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"         
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
     <html>
    <head>
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Pragma"  content="no-cache">
    <meta http-equiv="Expires" content="-1">

        <Script language = JavaScript>
            function addOptionList(selectbox,text,value )
            {
                var optn = document.createElement('OPTION');
                optn.text = text;
                optn.value = value;
                selectbox.options.add(optn);
            }
            function removeOptionList(listbox,i){
                listbox.remove(i);
            }
            function addOption_list(fromvar,tovar){ 
                for(i=fromvar.options.length-1;i>=0;i--)    {
                    var userlist=fromvar;
                    if(fromvar[i].selected){
                        addOptionList(tovar, fromvar[i].value, fromvar[i].value);
                        removeOptionList(userlist,i);

                    }
                }
            }

        </Script>

    <table align='center'>
        <tr>
            <td ><select multiple name='userlist' id='userlist' >
                <option value='aaa'>aaa</option>
                <option value='bbb'>bbb</option>                
            </select></td>
            <td align='center' valign='middle'>
                <input value='--&gt;'  
                     onClick='addOption_list(userlist,pouser);' type='button'>
                <br><input value='&lt;--' 
                     onClick='addOption_list(pouser,userlist);' type='button'></td>
            <td><select multiple  name='pouser' id='pouser'>
                <option id='test' value='ccc'>ccc</option>              
            </select></td>
        </tr>
    </table>
</body>
</HTML> 
```

我正在使用上面的代码从左侧框中选择一个名称并将其移动到右侧框。该代码在带有/不带有 DOCTYPE 的 IE 中工作。但是当我使用 DOCTYPE 时，它在 Firfox 中停止工作。我花了很多时间在上面，但仍然无法弄清楚问题所在。另外，我是 Javascript 的新手，所以请用下面的代码解释我的问题（当我使用 DOCTYPE 时）。在此先感谢您的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T01:42:10.383

您依赖于在窗口中显示为全局属性的 id 元素（例如`userlist`）。Firefox 仅在 quirks 模式下执行此操作，这就是文档类型很重要的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:50:04.470

您的标记与 DOCTYPE 不匹配。即您没有使用有效的 XHTML 1.0 标记。

将你的代码粘贴[到 xhtml 验证器中](http://validator.w3.org/#validate_by_input)，它会告诉你哪里出了问题。

# git - 推送到 GitHub 时如何保持本地文件的日期和时间

> ID：10034191
> 
> 赞同：5
> 
> 时间：2012-04-05T18:45:44.197
> 
> 标签：git, github

我想将我的一个旧存档项​​目推送到 GitHub，并且我想保留原始文件日期（27/08/2011）。可能吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:21:23.083

每个提交都存储提交的创作日期以及提交提交到存储库的日期。

执行`git log --format=fuller`存储库操作将打印这些日期。

当您推送到 GitHub 时，这些提交将被推送且未经修改，其中包含所有元数据信息。因此，将保留执行这些提交的日期。

# javascript - JS Clock - 有没有更优雅的方式来编写这段代码？

> ID：10034192
> 
> 赞同：-3
> 
> 时间：2012-04-05T18:45:45.327
> 
> 标签：javascript, date, clock

所以我创建了这个显示日期和时间的时钟。有没有更优雅的方式来编写这段代码，因为由于某种原因它看起来很乱，即使它做了我想要它做的事情。

谢谢

这是代码：http: [//jsfiddle.net/vkramer/X4PMg/](http://jsfiddle.net/vkramer/X4PMg/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:50:26.477

是的。让我们暂时忽略几乎缩小的 CSS。JavaScript 有数组字面量。你应该使用那些。所以这：

```
var showClock = function(){  
   var now = new Date();
   var hours = now.getHours();  
   var minutes = now.getMinutes();  
   var seconds = now.getSeconds();

   if ( hours < 10 ){
    hours = "0" + hours;
   }
   if ( minutes < 10 ){
    minutes = "0" + minutes;
   }
   if ( seconds < 10 ){
    seconds = "0" + seconds;
   }
   document.getElementById("hours").innerHTML = hours;
   document.getElementById("minutes").innerHTML = minutes;
   document.getElementById("seconds").innerHTML = seconds;

   setTimeout("showClock();", 100);
};  

var showDate = function(){
    var now = new Date();  
    var d = now.getDay();
    var m = now.getMonth();
    var y = now.getFullYear();
    var dayOfMonth = now.getDate();

    var day_name = new Array(7);
        day_name[0]="Sunday"
        day_name[1]="Monday"
        day_name[2]="Tuesday"
        day_name[3]="Wednesday"
        day_name[4]="Thursday"
        day_name[5]="Friday"
        day_name[6]="Saturday"

    var month_name = new Array(11);
        month_name[0] = "January"
        month_name[1] = "February"
        month_name[2] = "March"
        month_name[3] = "April"
        month_name[4] = "May"
        month_name[5] = "June"
        month_name[6] = "July"
        month_name[7] = "August"
        month_name[8] = "September"
        month_name[9] = "October"
        month_name[10] = "November"
        month_name[11] = "December"

   document.getElementById("day").innerHTML = day_name[now.getDay()];
   document.getElementById("month").innerHTML = month_name[now.getMonth()];
   document.getElementById("year").innerHTML = y;
   document.getElementById("dayOf").innerHTML = dayOfMonth;

}
showClock();
showDate(); 
```

变成这样：

```
var showClock = function() {  
   var now = new Date();
   var hours = now.getHours();  
   var minutes = now.getMinutes();  
   var seconds = now.getSeconds();

   if ( hours < 10 ) {
       hours = "0" + hours;
   }
   if ( minutes < 10 ) {
       minutes = "0" + minutes;
   }
   if ( seconds < 10 ){
       seconds = "0" + seconds;
   }

   document.getElementById("hours").innerHTML = hours;
   document.getElementById("minutes").innerHTML = minutes;
   document.getElementById("seconds").innerHTML = seconds;

   setTimeout("showClock();", 100);
};  

var showDate = function() {
    var now = new Date();  
    var d = now.getDay();
    var m = now.getMonth();
    var y = now.getFullYear();
    var dayOfMonth = now.getDate();

    var day_name = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];

    var month_name = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

   document.getElementById("day").innerHTML = day_name[now.getDay()];
   document.getElementById("month").innerHTML = month_name[now.getMonth()];
   document.getElementById("year").innerHTML = y;
   document.getElementById("dayOf").innerHTML = dayOfMonth;
}

showClock();
showDate(); 
```

然后，永远不要将字符串传递给`setTimeout`. 不要制作变量，不要使用它们。

```
function showClock() {  
   var now = new Date();
   var hours = now.getHours();  
   var minutes = now.getMinutes();  
   var seconds = now.getSeconds();

   if(hours < 10) {
       hours = "0" + hours;
   }

   if(minutes < 10) {
       minutes = "0" + minutes;
   }

   if(seconds < 10) {
       seconds = "0" + seconds;
   }

   document.getElementById("hours").innerHTML = hours;
   document.getElementById("minutes").innerHTML = minutes;
   document.getElementById("seconds").innerHTML = seconds;

   setTimeout(showClock, 100);
} 

function showDate() {
    var now = new Date();

    var day_name = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
    var month_name = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

   document.getElementById("day").innerHTML = day_name[now.getDay()];
   document.getElementById("month").innerHTML = month_name[now.getMonth()];
   document.getElementById("year").innerHTML = now.getFullYear();
   document.getElementById("dayOf").innerHTML = now.getDate();
}

showClock();
showDate(); 
```

其他东西也是如此，但这使它可以接受。另外，不要再假装使用 HTML5。A`<section>`在那里完全错误，你应该只使用 a `<div>`。

# c# - 使用 memberOf 的 LDAP 身份验证

> ID：10034195
> 
> 赞同：1
> 
> 时间：2012-04-05T18:45:54.570
> 
> 标签：c#, asp.net, active-directory, ldap

我有一个 asp.net (C#) 设置来使用 LDAP 进行身份验证。一切正常，我可以使用我们目录中的任何用户登录。问题是，我需要将某些页面限制为特定组中的人。我正在使用登录视图+帐户文件夹方法。

我的网站设计很简单，它有三个页面，一个对所有人可见（在帐户文件夹之外），另外两个需要身份验证。我希望一组可以访问两个网页，而另一组只能访问其中一个页面。

我试过了：

```
String group = "group";
if (!User.IsInRole(group)) {
    Response.Redirect("login.aspx");
} 
```

但无论我的用户不在该组中。我有一个 LDAP 浏览器，我知道我肯定在组中。LDAP 浏览器显示“memberOf”和“CN=group”。

有什么我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:52:44.550

您是否尝试过添加域名？

您也可以使用 App.Config 实现此功能：http: [//bytes.com/topic/asp-net/answers/300187-web-config-authorization-help](http://bytes.com/topic/asp-net/answers/300187-web-config-authorization-help)

编辑：

[这](http://geekswithblogs.net/joycsharp/archive/2008/02/18/asp.net-role-based-security-the-basics.aspx)是使用 App.Config 在 ASP.NET 中基于角色的安全性的更好链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:56:55.720

当您`FormsAuthenticationTicket`为用户创建时，`UserData`就是为该用户指定“角色”的内容。

[http://msdn.microsoft.com/en-us/library/system.web.security.formsauthenticationticket.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.formsauthenticationticket.aspx)

举个例子：

```
FormsAuthenticationTicket authTicket = new FormsAuthenticationTicket(1,
    username, DateTime.Now, DateTime.Now.AddMinutes(30),
    isPersist, "group");

//I'll add more example code for the sake of completing the example
string encryptTick = FormsAuthentication.Encrypt(authTicket);
HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName,
                encryptTick);
if (isPersist)
    cookie.Expires = authTicket.Expiration;
Response.Cookies.Add(cookie); 
```

这应该允许您上面的代码工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T20:27:57.393

如果您对您的域使用集成身份验证，并且您已将模拟设置为 true，则可以通过删除 ASPNET（和任何其他全局组）对目录的权限来锁定应用程序的区域，并添加指定的 AD您想要访问的组。

我肯定会记录这一点，因为我继承了一个使用这种方法的系统，并且它让我绊倒了几个小时，以确定执行访问控制的位置。

# jquery - jQuery UI 对话框的简单替换？

> ID：10034209
> 
> 赞同：1
> 
> 时间：2012-04-05T18:46:32.377
> 
> 标签：jquery, asp.net-mvc, jquery-ui

我已经开始使用 ASP MVC4，我注意到他们使用 jQuery UI 对话框。我喜欢这个想法，但希望有一个更轻量级的仅基于 jQuery 的解决方案。

有人知道我可以使用任何简单的对话框插件或其他可以代替 jQuery UI 的插件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T18:52:39.713

jQuery 中没有内置对话框。您将不得不自己构建一个或使用一些现有的对话框。这就是创建 jQuery UI 项目的原因——提供一些常用的 UI 元素。我不知道您所说的更轻量级究竟是什么意思，但您可以[构建一个自定义 jQuery UI 包](http://jqueryui.com/download)，其中仅包含您需要的功能，从而优化 javascript 的大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T18:56:03.333

你可以试试这个[http://jquery.malsup.com/block/#dialog](http://jquery.malsup.com/block/#dialog)它有一堆样本

或者你可以看看这个[http://trentrichardson.com/Impromptu/index.php](http://trentrichardson.com/Impromptu/index.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:03:29.400

即使有可用的**轻量级**替代品，我也建议不要使用它。我认为的原因是 jQuery UI 有更好的文档和社区支持。

# php - C++ 的功能是否比 PHP 少？

> ID：10034210
> 
> 赞同：1
> 
> 时间：2012-04-05T18:46:34.743
> 
> 标签：php, c++, c

我正在学习 C++；我已经精通PHP。我阅读了 C++ 和 PHP 之间的区别。我读过的文章都没有提到 PHP 的内置函数比 C++ 多得多。

现在，我正在尝试在 C++ 中拆分一个字符串，但我发现了这个：[Split a string in C++?](https://stackoverflow.com/questions/236129/how-to-split-a-string-in-c) 在 PHP 中，我可以简单地做`explode($delimiter,$string)`

我错过了什么吗？还是说 PHP 有比 C++ 更多的内置函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:52:37.287

C++ 和 PHP 都有包含新函数和类的库的概念。

许多 PHP 函数只是完成更复杂事情的更简单方法，例如，`explode`可以使用`split`and`strpos`来编写。

C++ 也是如此，我发现 C++ 在这方面更精简，当然有时你必须编写自己的`explode`，或者只是使用其他人创建的其他库。

至于哪个有更多，我认为这并不重要，两者都是可扩展的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:56:21.773

*PHP 之于 C++ 就像 Java 之于 Javascript*

它们作为一个整体是完全**不同的语言。**

是的，PHP 是用 C++ 构建的，这并不**意味着**它们将具有相同的功能。

***其他***语言是用构建到 PHP 和 C++ 以及其他更高级别语言的机器代码构建的，但这并不意味着我可以做到：`1000101010111010011000`在 PHP 中，意味着什么......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:01:31.650

C++ 更接近于汇编语言。虽然 std 库（和 std++ 库）中有数千个函数部分，但您会觉得有更多的解释语言库，例如 PHP（用 C/C++ 编写），这并不奇怪。

C 和 C++ 都力求在程序员和底层机器之间提供最小的干扰（同时仍然保持表面上的可移植性）。因此，库的创建留给程序员来实现以适应他们手头的任务。虽然这会为您带来更多的努力，但生成的代码可以非常高效并产生令人印象深刻的性能增强。

当然，由您决定性能提升是否值得付出更多努力的权衡。

祝你学习顺利。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:01:56.813

C++ 的部分优点在于它是基本的，并且没有污染命名空间的内置函数。

许多内置在其他语言中的函数/对象/算法是 C++ 标准模板库 (STL) 的一部分。STL 是核心语言规范的一部分，但要使用功能，您需要包含正确的标头。

如果您想学习 C++，您应该熟悉 STL 和 Boost 库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T19:29:22.233

仅仅因为 C++ 没有 PHP 所具有的特定功能，并不意味着 C++ 总体上具有较小的标准库。我猜 C++ 标准库也有很多 PHP 没有的功能。例如，PHP 在其标准库中没有编译时有理算术。

我不知道哪种语言有更大的标准库。您只需要获取每种语言的文档并计算函数的数量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T21:35:47.990

> C++ 的功能是否比 PHP 少？

PHP 和 C++ 具有相同数量的函数：一个函数构造可以表达一定数量的总函数。在 C++ 中增加可能的函数数量可能比在 PHP 中更容易，以防您将来某个时间达到此限制。

> 我错过了什么吗？还是说 PHP 有比 C++ 更多的内置函数。

我不是 C++ 专家，但我很确定就内置函数而言，PHP 比 C++“更多”，但你不能这样比较，因为语言太不同了。虽然在 C / C++ 中默认情况下没有很多内置函数是明智的，但在 PHP 中则相反，因为它是一种可以使用的脚本语言，所以多年来它被塞满了函数。

或者这样表述：您使用 C++ 作为一种语言来生成那些稍后编译为 PHP 绑定（扩展）的函数，只要您在 PHP 中加载扩展，就可以使用这些函数。但你永远不会反过来做。

# jquery - 同位素附加问题

> ID：10034213
> 
> 赞同：7
> 
> 时间：2012-04-05T18:46:35.497
> 
> 标签：jquery, filter, jquery-isotope

我正在使用同位素来构建一个平滑的网格画廊。目前我在附加功能方面遇到问题：http: [//isotope.metafizzy.co/docs/methods.html#appended](http://isotope.metafizzy.co/docs/methods.html#appended)

如果我这样调用附加

```
$('#loadMore').click(function(){
    val='<div class="content-box masonry-brick img11"><a href="#"><img src="images/1.jpg" style="width: 290px; height: 163.36666666666667px; "><div class="portfolio-more"><div class="portfolio-icon"></div></div></a><div class="content-box-content"><h3 class="post-info">Lifestyle / People</h3><h2>Street Life</h2></div></div>';

    var $container = $('#grid-gallery');
    $container.isotope( 'appended', val)

    return false;
  }); 
```

然后同位素吐出以下错误消息：

```
[content] has no method 'filter' 
```

如果我将定位添加到 div，那么它工作正常，除了新元素加载到该位置并保持固定。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-30T14:22:48.557

改变：

```
$container.isotope( 'appended', val); 
```

到

```
$container.isotope( 'append', $(val) ); 
```

或者如果你想让它更干净，你可以这样做......

```
$('#loadMore').click(function(){

    val= $('<div class="content-box masonry-brick img11"><a href="#"><img src="images/1.jpg" style="width: 290px; height: 163.36666666666667px; "><div class="portfolio-more"><div class="portfolio-icon"></div></div></a><div class="content-box-content"><h3 class="post-info">Lifestyle / People</h3><h2>Street Life</h2></div></div>');

    var $container = $('#grid-gallery');
    $container.isotope( 'insert', val );

    return false;
}); 
```

# drupal-6 - CKeditor 在 drush up (6.22 -> 6.25) 后停止工作

> ID：10034215
> 
> 赞同：0
> 
> 时间：2012-04-05T18:46:39.720
> 
> 标签：drupal-6, ckeditor

我有安装/工作 CKeditor 的 6.22 drupal 站点。在我使用 drush up 后，网站本身正在运行*，但*我不再拥有 ckeditor 提供的“可视”编辑器。

知道如何让它重新运行吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T15:07:03.720

嗯，这很容易。那就是将从 ckeditor 站点（称为程序）下载的 ckeditor 的内容解压缩到模块/ckeditor 中的问题。它会添加很多文件到 modules/ckeditor/ckeditor

# ruby-on-rails - RoR - 私信回复算法

> ID：10034218
> 
> 赞同：0
> 
> 时间：2012-04-05T18:46:53.867
> 
> 标签：ruby-on-rails, activerecord, model

我有以下私信模型

```
belongs_to :from_user, class_name: 'User'
belongs_to :to_user, class_name: 'User'
belongs_to :thread, class_name: 'Message', foreign_key: 'parent_message_id'
has_many :replies, class_name: 'Message'
attr_accessible :subject, :body
scope :original_message, where("parent_message_id IS NULL") 
```

我已将所有视图设置为将消息显示为线程，并且我想在底部放置一个快速回复表单。对于设置 to_user 的最佳方式，我完全是脑筋急转弯，因为线程中的任何给定消息都可能属于当前用户或另一端的用户。有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:56:27.490

我有类似的要求，我所做的是添加 javascript 以根据单击线程的“回复”按钮的位置移动回复文本区域。

在回复时，您可以设置当前用户正在回复的帖子的变量，并且根据帖子的所有者，您可以添加 to_user

如果是平面对话（如在论坛中）或像在[railscasts.com](http://railscasts.com/)中的线程对话，这应该可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:06:10.130

如果线程中只有两个用户，那么我们可以假设`from_user`or `to_user`is `current_user`，这意味着不是的那个是`current_user`另一方。所以：

```
orig_msg = @thread.messages.original_message

if orig_msg.from_user == current_user
  other_user = orig_msg.to_user
else
  other_user = orig_msg.from_user
end 
```

或者：

```
other_user = orig_msg.to_user
other_user = orig_msg.from_user unless orig_msg.from_user == current_user 
```

或者：

```
other_user = orig_msg.from_user == current_user ?
               orig_msg.to_usr : orig_msg.from_user 
```

# javascript - 使用 .click 函数在表格中显示元素。如何区分使用循环填充的表中的元素？

> ID：10034221
> 
> 赞同：0
> 
> 时间：2012-04-05T18:47:15.513
> 
> 标签：javascript, php, jquery, html-table

如何区分使用循环填充的表中的元素？这样当我使用 Javascript 在点击时显示元素时，它会显示正确的元素？

目前，当我单击评论时，它只显示第一项，然后其余行不起作用。

当用户单击评论按钮时，我希望出现一个文本区域。问题是，因为它是一个表格，我如何制作它，以便表格中的每个评论按钮都显示其表格中的框。我需要为表中的每一行添加一个递增的 id 吗？

**这是Javascript：**

```
$('#postcomment').click(function(){
$('#comment_text').css('display','inline');
}) 
```

**这是PHP：**

```
<table>
<?php
foreach ($posts as $key => $list){
echo "<tr>";
echo "<td>
<a id='postcomment'>Comment</a>
<textarea  id='comment_text' style='display:none;placeholder='Type your comment.'></textarea>
      </td>";
echo "</tr>";               
}
?>
</table> 
```

最好的解决方案是给每一行一个唯一的ID，我该怎么做？另外，我将如何调用 Javascript 来为每个唯一 ID 工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:51:26.123

`id`s 在文档中必须是唯一的。而是使用一个类。一旦你这样做了，你可以使用诸如`parent`、`siblings`、`find`等的东西来根据你点击的元素的位置找到合适的元素。

像这样的东西：

```
$('.postcomment').click(function(){
    $(this).next('.comment_text').css('display','inline');
}); 
```

# ruby - Ruby/EventMachine 数据包解析器

> ID：10034229
> 
> 赞同：2
> 
> 时间：2012-04-05T18:47:35.663
> 
> 标签：ruby, eventmachine

我正在尝试编写一个可以打包/解包结构化二进制数据包的自定义 EM::Protocol 模块。数据包结构应该定义为名称/格式对，可以是字符串、其他一些易于解析的格式，或者是某种 DSL。

一些快速的代码来理解这个想法：

```
module PacketProtocol
    def self.included(base)
        base.extend ClassMethods
    end

    def receive_data(data)
        # retrieve packet header
        # find matching packet definition
        # packet.unpack(data)
    end

    module ClassMethods
        def packet(defn)
            # create an instance of Packet (see blow) and shove it
            # somewhere i can get to later.
        end
    end
end

module MyHandler
    include PacketProtocol
    packet '<id:S><len:S><msg:A%{len}>'
end

EM.run do
     EM.start_server '0.0.0.0', 8080, MyHandler
end 
```

我的目标是最小化运行时复杂性。每次执行的数据包定义都是静态的，所以我想避免这种（粗略的）实现：

```
class Packet
    FmtSize = {
        'S' => 2, 
        'A' => Proc.new {|fmt| fmt[1..-1].to_i }
    }

    def initialize(defn)
        @fields = defn.scan(/<([^>]+):([^>]+)>/)
    end

    def pack(data)
        data.values.pack @fields.map { |name, fmt| fmt % data }.join
    end

    def unpack(defn)
        data = {}
        posn = 0
        @fields.each do |name, len|
            fmt = len % data
            len = FmtSizes[fmt[0]]
            len = len.call(fmt) if len.class == Proc
            data[name.to_sym] = bytes[posn..posn + len - 1].unpack(fmt)[0]
            posn += len
        end
        data
    end
end

data = { :id => 1, :len => 5, :msg = 'Hello' }
packet = Packet.new '<id:S><len:S><msg:A%{len}>'
packed = packet.pack(data)

require 'benchmark'

Benchmark.bm(7) do |x|
    x.report('slow') {
        100000.times do
            unpacked = packet.unpack(packed)
        end
    }
    x.report('fast') {
        100000.times do
            data = {}
            data[:id] = packed[0..1].unpack('S' % data)
            data[:len] = packed[2..3].unpack('S' % data)
            data[:msg] = packed[4..8].unpack('A%{len}' % data)
        end
    }
end

# output:
#              user     system      total        real
# slow     1.970000   0.000000   1.970000 (  1.965525)
# fast     0.140000   0.000000   0.140000 (  0.146227) 
```

在这两个示例中，使用 Packet 类似乎要慢几个数量级。

所以。问题是：

有没有一种方法（或 gem）可以让您在运行时生成代码（而不是简单地评估字符串）？

**编辑：**

刚刚找到[BinData](http://bindata.rubyforge.org/)。虽然它的功能集很好，但它的基准测试也慢得多。

# php - 检查向 PHP 发送请求的 Flash 文件的位置

> ID：10034234
> 
> 赞同：0
> 
> 时间：2012-04-05T18:48:00.473
> 
> 标签：php, flash, superglobals

我有一个位于我的网站上的 flash 文件，我有一个 PHP 文件，它每 5 分钟从 flash 文件中获取请求。我想确保发送请求的 Flash 文件位于我的网站上，而不是其他地方。我该怎么做。PHP 的全局变量中是否有任何可以帮助我的东西，或者我还能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:55:48.963

```
var url:String=stage.loaderInfo.url;
var goodPattern:RegExp=/^(http:\/\/)(www\.)?stackoverflow\.com/;
if (goodPattern.test(url)==true) {
    trace("This flash is hosted on stackoverflow");
} else {
    trace("This flash is hosted not on stackoverflow");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:00:37.810

您可能会从中得到一些东西，`$_SERVER['HTTP_REFERER']`但`$_SERVER['REMOTE_HOST']`这些信息可能会被欺骗。

有许多方法可用于确保请求来自特定/合法来源。我最初想到的发件人验证技术是使用[数字签名](http://en.wikipedia.org/wiki/Digital_signature)。如果您想避免使用公私密钥对，并且由于请求来自接收的同一服务器，那么使用[预共享密钥](http://en.wikipedia.org/wiki/Pre-shared_key)可能是合适的（只需确保使用盐进行散列）。

# ruby - 为什么安装 RDOCS 和 RI 比实际 gem 需要更长的时间？

> ID：10034237
> 
> 赞同：4
> 
> 时间：2012-04-05T18:48:22.780
> 
> 标签：ruby, rubygems, rdoc, ri

安装 gem 并等待 2 秒以安装 gem，然后等待 30 秒等待我从未使用过的文档（谷歌，任何人？）总是令人沮丧。当本地文档通常甚至无益时，我们为什么要强制自己执行此约定？

我知道您可以使用`gem install rails --no-ri --no-rdoc`跳过该步骤，但有没有办法在默认情况下简单地跳过文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:55:58.253

将标志添加到您的`~/.gemrc`文件中。

从[文档](http://docs.rubygems.org/read/chapter/11)：

> `gem`在您的主目录中查找配置文件`.gemrc`，但您可以根据需要在命令行上指定另一个文件（使用`--config-file modifier`）。只会处理一个配置文件：命令行上最右边的一个，或者 default `$HOME/.gemrc`，或者根本没有。
> 
> 您可以在配置文件中指定三项内容：
> 
> *   每次`gem`运行时使用的命令行参数
> *   “RDoc”的命令行选项（生成文档时使用）
> *   `GEMPATH`设置
> 
> 配置文件本身是“YAML”格式。这是一个例子：
> 
> ```
> gem:  --local --gen-rdoc --run-tests
> rdoc: --inline-source --line-numbers
> gempath:
>  - /usr/local/rubygems
>  - /home/gavin/.rubygems 
> ```
> 
> 这样的配置文件的效果是：
> 
> *   `gem`仅运行“本地”操作（除非您指定`--remote`或`--both`在命令行上）
> *   `gem`每次安装时都会生成 RDocs 并运行单元测试（好主意！）
> *   当它生成 RDocs 时，将使用给定的参数
> *   `/usr/local/rubygems`并将`/home/gavin/rubygems`用作您的`$GEM_PATH`设置

# .net - Task<> 和 IAsyncOperation<> 有什么区别

> ID：10034239
> 
> 赞同：24
> 
> 时间：2012-04-05T18:48:25.710
> 
> 标签：.net, task-parallel-library, microsoft-metro

我正在写一个地铁应用程序。

这有效：

```
 HttpClient client = new HttpClient();
    var bytes = await client.GetByteArrayAsync(new Uri("www.microsoft.com")); 
```

这不会：

```
 var folder = Windows.Storage.ApplicationData.Current.LocalFolder;
    var file = await folder.GetFileAsync("text.txt"); 
```

第一个返回 Task<>，第二个返回 IAsyncOperation<>

有什么不同？为什么有两种不同的类型？如何修复第二个样本？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-06T14:50:16.317

`IAsyncOperation`是一个地铁异步操作。你可以`await`一个`IAsyncOperation`.

但是，您不能使用`IAsyncOperation`with`Task.WhenAll`或`Task.WhenAny`。要`IAsyncOperation`通过这些方法使用实例，您应该从 调用[`AsTask`](https://docs.microsoft.com/en-us/dotnet/api/system.windowsruntimesystemextensions.astask?view=dotnet-plat-ext-3.1)扩展方法（以前称为`StartAsTask`）`System.Runtime.WindowsRuntime`，如下所示：

```
var folder = Windows.Storage.ApplicationData.Current.LocalFolder;
var fileTask = folder.GetFileAsync("text.txt").AsTask(); 
```

# xpages - com.ibm.xsp.component.UIIncludeComposite 记录在哪里？

> ID：10034241
> 
> 赞同：3
> 
> 时间：2012-04-05T18:48:38.787
> 
> 标签：xpages

谁能告诉我 com.ibm.xsp.component.UIIncludeComposite 记录在哪里？我在帮助文件中搜索 UIIncludeComposite 但什么也没找到。

在 Mastering xPages 中只有一个简短的提及。

com.ibm.xsp.component.UIIncludeComposite 是在为自定义控件调用 getComponent 时由 getComponent 返回的对象的类。

事实上，有什么记录在哪里？我认为作为新手 xPage 程序员最大的挫折是缺乏文档或在哪里可以找到它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T19:20:35.450

Java 类记录在可在[http://www-10.lotus.com/ldd/ddwiki.nsf/dx/Domino_Designer_Extensibility_APIs_Javadoc_8.5.3](http://www-10.lotus.com/ldd/ddwiki.nsf/dx/Domino_Designer_Extensibility_APIs_Javadoc_8.5.3)获得的 Javadoc 中，它指向特定类的此页面： [http://public.dhe .ibm.com/software/dw/lotus/Domino-Designer/JavaDocs/DesignerAPIs/com/ibm/xsp/component/UIIncludeComposite.html](http://public.dhe.ibm.com/software/dw/lotus/Domino-Designer/JavaDocs/DesignerAPIs/com/ibm/xsp/component/UIIncludeComposite.html)

升级包 1 和扩展库的一般文档可在此处获得： [http ://www-10.lotus.com/ldd/ddwiki.nsf/xpViewCategories.xsp?lookupName=Domino%20Designer%20XPages%20Extension%20Library](http://www-10.lotus.com/ldd/ddwiki.nsf/xpViewCategories.xsp?lookupName=Domino%20Designer%20XPages%20Extension%20Library)

# jruby - Jruby 中的“需要”宝石错误

> ID：10034243
> 
> 赞同：0
> 
> 时间：2012-04-05T18:48:46.973
> 
> 标签：jruby

我在 ruby​​ 1.8 中运行 Jruby 1.6.7

我可以安装 gem：[https](https://github.com/consti/tupalo-kdtree) ://github.com/consti/tupalo-kdtree 。

我有以下代码：

```
require 'kdtree'
require 'benchmark'

  def setup_tree(len)
    @points = (0...len).map { |i| [rand_coord, rand_coord, i ] }
    @kdtree = KDTree.new(@points)
  end

  def distance(a, b)
    x, y = a[0] - b[0], a[1] - b[1]
    x * x + y * y
  end

  def rand_coord
    rand(0) * 10 - 5
  end

  def test_nearestk

    pt = []
    @list = []
    20000.times do
      pt = [rand_coord, rand_coord]
     # kdtree search
      @list << @kdtree.nearest(pt[0],pt[1])     #puts pt

      end
       puts "Points from search #{@list.size}"
       puts "Points in graph #{@kdsize}"

  end
   @kdsize = 50000 
   setup_tree(@kdsize)
Benchmark.bm do |x| 
  x.report do
test_nearestk
end
end 
```

但是，当我在 Jruby 中运行它时 - 我得到了错误

```
LoadError: no such file to load -- kdtree
  require at org/jruby/RubyKernel.java:982
  require at /home/charlie/.rvm/rubies/jruby-head/lib/ruby/shared/rubygems/custom_require.rb:36
   (root) at newtest.rb:2 
```

它很奇怪，因为它甚至无法找到 kdtree - 当我知道它在那里时 - 安装了 gem。我已经清理了 gemset 并在 RVM 下创建了一个新的，但仍然是同样的错误。在 jruby 下是否有不同的“要求”方式？还是有其他问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T23:59:52.933

将此添加到顶部

```
require 'rubygems' 
```

# javascript - jQuery滑块重定向图像

> ID：10034246
> 
> 赞同：2
> 
> 时间：2012-04-05T18:48:54.960
> 
> 标签：javascript, jquery, jquery-plugins, slider, slideshow

我正在使用[jQuery Blinds Slideshow](http://www.littlewebthings.com/projects/blinds/)作为图像滑块。当我点击它时，我想将第一个滑动图像重定向到[http://google.com 。](http://google.com)我使用`a`这样的html标签：

```
<div class="slideshow">
   <ul>
      <li><a href="http://google.com"><img src="lemons/1.jpg" alt="lemon" /></a></li>
      <li><img src="lemons/2.jpg" alt="lemon tea" /></li>
   </ul>
</div>

<a href="#" onclick="$('.slideshow').blinds_change(0)">1</a>
<a href="#" onclick="$('.slideshow').blinds_change(1)">2</a> 
```

但它不起作用。
我的问题是当我点击它时如何将第一个滑动图像重定向到 google.com？
提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T22:02:59.623

这是我修改原始jquery-blinds的快速而肮脏的东西。将它放在一个新的 JS 文件中，并将其命名为 jquery.blinds-0.9-with-hyperlinks.js 或其他名称，并将其包含在当前 jquery-blinds 代码的位置。

它应该适用于您在上面发布的 HTML。它只是检查是否有任何图像包含在“标签”中，如果是，则在单击时将图像重定向到该链接。

```
/*!
 * jQuery Blinds
 * http://www.littlewebthings.com/projects/blinds
 *
 * Copyright 2010, Vassilis Dourdounis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * Modified by Thomas Antony ( http://www.thomasantony.net ) on 06-Apr-2012
 * Added image hyperlinking functionality
 *
 */
(function($){

    $.fn.blinds = function (options) {

        $(this).find('li').hide();
        $(this).addClass('blinds_slideshow');

        settings = {};
        settings.tile_orchestration = this.tile_orchestration;

        settings.h_res = 12;
        settings.v_res = 1;

        settings.width = $(this).find('li:first').width();
        settings.height = $(this).find('li:first').height();

        jQuery.extend(settings, options);

        tiles_width = settings.width / settings.h_res;
        tiles_height = settings.height / settings.v_res;

        // Get image list
        blinds_images = [];
        blinds_links = [];

        $(this).find('img').each(function (i, e) {
            blinds_images[blinds_images.length] = {'title': e.alt, 'src': e.src}
            // Code added to allow for linking functionality -- Thomas
            if( $(e).parent().is('a') && $(e).parent().attr('href') != undefined)
            {
                blinds_links[i] = $(e).parent().attr('href');
            }else{
                blinds_links[i] = "";
            }
        });

        // Create blinds_container
        $(this).append('<div class="blinds_container"></div>');

        blinds_container = $(this).find('.blinds_container');
        blinds_container.css({
            'position'  : 'relative', 
            'display'   : 'block', 
            'width'     : settings.width, 
            'height'    : settings.height, 
//          'border'    : '1px solid red', // debuging
            'background': 'transparent url("' + blinds_images[1]['src'] + '") 0px 0px no-repeat'
        } );

        // Setup tiles
        for (i = 0; i < settings.h_res; i++)
        {
            for (j = 0; j < settings.v_res; j++)
            {
                if (tile = $(this).find('.tile_' + i + '_' + j))
                {
                    h = '<div class="outer_tile_' + i + '_' + j + '"><div class="tile_' + i + '_' + j + '"></div></div>';
                    blinds_container.append(h);
                    outer_tile = $(this).find('.outer_tile_' + i + '_' + j);
                    outer_tile.css({
                        'position'  : 'absolute',
                        'width'     : tiles_width,
                        'height'    : tiles_height,
                        'left'      : i * tiles_width,
                        'top'       : j * tiles_height
                    })

                    tile = $(this).find('.tile_' + i + '_' + j);
                    tile.css({
                        'position'  : 'absolute',
                        'width'     : tiles_width,
                        'height'    : tiles_height,
                        'left'      : 0,
                        'top'       : 0,
//                      'border'    : '1px solid red', // debuging
                        'background': 'transparent url("' + blinds_images[0]['src'] + '") -' + (i * tiles_width) + 'px -' + (j * tiles_height) + 'px no-repeat' 
                    })

                    jQuery.data($(tile)[0], 'blinds_position', {'i': i, 'j': j});
                }
            }
        }

        jQuery.data(this[0], 'blinds_config', {
            'h_res': settings.h_res,
            'v_res': settings.v_res,
            'tiles_width': tiles_width,
            'tiles_height': tiles_height,
            'images': blinds_images,
            'img_index': 0,
            'change_buffer': 0,
            'tile_orchestration': settings.tile_orchestration
        });

        // Add redirection code for the links -- Thomas 
        var container = this[0];    // Need this to get config data within click handler
        jQuery.data(this[0], 'blinds_links', blinds_links);

        blinds_container.click(function(){
            var config = jQuery.data(container, 'blinds_config');
            if(blinds_links[config.img_index] != "")
            {
                window.location.href = blinds_links[config.img_index]
            }
        }); 
        $(this).update_cursor(); // Set correct cursor for first image -- Thomas
        // Modified code ends

    }

    $.fn.blinds_change = function (img_index) {

        // reset all sprites
        config = jQuery.data($(this)[0], 'blinds_config');
        for (i = 0; i < config.h_res; i++)
        {
            for (j = 0; j < config.v_res; j++) {
                $(this).find('.tile_' + i + '_' + j).show().css('background', 'transparent ' + 'url("' + config.images[config.img_index]['src'] + '") -' + (i * config.tiles_width) + 'px -' + (j * config.tiles_height) + 'px no-repeat');
            }
        }

        $(this).children('.blinds_container').css('background', 'transparent url("' + blinds_images[img_index]['src'] + '") 0px 0px no-repeat' );

        config.img_index = img_index;
        jQuery.data($(this)[0], 'blinds_config', config);

        for (i = 0; i < config.h_res; i++)
        {
            for (j = 0; j < config.v_res; j++) {
                t = config.tile_orchestration(i, j, config.h_res, config.v_res);

                config = jQuery.data($(this)[0], 'blinds_config');
                config.change_buffer = config.change_buffer + 1;
                jQuery.data(this[0], 'blinds_config', config);

                $(this).find('.tile_' + i + '_' + j).fadeOut(t, function() {
                    blinds_pos = jQuery.data($(this)[0], 'blinds_position');
                    config = jQuery.data($(this).parents('.blinds_slideshow')[0], 'blinds_config');

                    $(this).css('background', 'transparent ' + 'url("' + config.images[config.img_index]['src'] + '") -' + (blinds_pos.i * config.tiles_width) + 'px -' + (blinds_pos.j * config.tiles_height) + 'px no-repeat');

                    config.change_buffer = config.change_buffer - 1;
                    jQuery.data($(this).parents('.blinds_slideshow')[0], 'blinds_config', config);

                    if (config.change_buffer == 0) {
//                      $(this).parent().parent().children().children().css('width', config.tiles_width);
                        $(this).parent().parent().children().children().show();
                    }

                });
            }
        }
        $(this).update_cursor();
    }

    $.fn.tile_orchestration = function (i, j, total_x, total_y) {
        return (Math.abs(i-total_x/2)+Math.abs(j-total_y/2))*100;
    }

    // Function to update cursor to a "hand" if image is linked -- Thomas
    $.fn.update_cursor = function()
    {
        // Change cursor if image is hyperlinked
        var config = jQuery.data($(this)[0], 'blinds_config');
        var blinds_links = jQuery.data($(this)[0], 'blinds_links'); // get links from saved data

        console.log(config.img_index);
        if(blinds_links[config.img_index] != "")
        {
            $(this).find('.blinds_container').css('cursor','pointer');
        }else{
            $(this).find('.blinds_container').css('cursor','auto');
        }
    }

})(jQuery); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:55:19.390

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $('a:first').click(function(){
        window.location.href = 'http://google.com/';
    });
});
</script> 
```

或者

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $('div.slideshow img:first').click(function(){
        window.location.href = 'http://google.com/';
    });
}); 
```

# php - 如何在不使用 .htaccess 的情况下隐藏 .php 文件扩展名？

> ID：10034249
> 
> 赞同：0
> 
> 时间：2012-04-05T18:49:05.273
> 
> 标签：php

我在尝试从 url 隐藏 .php 扩展名时遇到问题

我被要求隐藏它，因为它们位于共享主机上，所以我认为我无法访问 .htacess 所以是否有另一种方法可以通过每次选择锚点时调用的 php 函数来隐藏它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:56:01.200

这真的是关于隐藏`.php`还是更多的是关于拥有更清晰的 URL？

如果您确实无法访问`.htaccess`（即您的主机已通过 关闭此功能`AllowOverride None`）并假设您也无法为您的 VHost 更新 Apache conf 设置，那么您能做的最好的可能是

```
http://example.com/page.php/my/clean/url 
```

默认情况下，Apache 会将这个 URL 发送到`page.php`它之后的所有内容。这是在不访问`mod_rewrite`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:50:36.127

.htaccess 是您可以在共享服务器上访问的内容，而不是 httpd.conf，您不会。

使用以下内容将 .htaccess 文件放在文档根目录中

```
FAIL 
```

如果您的网站停止加载，那么您可以使用 .htaccess :)

当然，^ 那是个玩笑。

# php - @header() 和 header() 函数之间的 PHP 区别

> ID：10034251
> 
> 赞同：3
> 
> 时间：2012-04-05T18:49:21.833
> 
> 标签：php, header

> **可能重复：**
> [参考 - 这个符号在 PHP 中是什么意思？](https://stackoverflow.com/questions/3737139/reference-what-does-this-symbol-mean-in-php)

在 PHP 中调用 @header() 和 header() 函数有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:51:04.000

`@`抑制错误：

[http://php.net/manual/en/language.operators.errorcontrol.php](http://php.net/manual/en/language.operators.errorcontrol.php)

通常，您不想这样做

# php - 如何用 PHP 读取图像？

> ID：10034255
> 
> 赞同：7
> 
> 时间：2012-04-05T18:49:31.267
> 
> 标签：php, image

我知道

```
$localfile = $_FILES['media']['tmp_name']; 
```

鉴于使用了 POST 方法，将获得图像。我正在尝试读取与我的代码位于同一目录中的图像。我如何读取它并将其分配给上面的变量？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T18:52:37.413

您发布的代码不会读取图像数据，而是读取其文件名。如果需要检索同一目录下的图片，可以[`file_get_contents()`](http://php.net/manual/en/function.file-get-contents.php)使用 检索其内容，可以直接输出到浏览器：

```
$im = file_get_contents("./image.jpeg");
header("Content-type: image/jpeg");
echo $im; 
```

否则，您可以使用[GD 库](http://www.php.net/manual/en/function.imagecreatefromjpeg.php)读取图像数据以进行进一步的图像处理：

```
$im = imagecreatefromjpeg("./image.jpeg");
if ($im) {
  // do other stuff...
  // Output the result
  header("Content-type: image/jpeg");
  imagejpeg($im);
} 
```

最后，如果您*不知道*所需图像的文件名（但如果它与您的代码位于同一位置，则应该），您可以使用 a`glob()`查找所有 jpeg，例如：

```
$jpegs = glob("./*.jpg");
foreach ($jpegs as $jpg) {
  // print the filename
  echo $jpg;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-15T06:15:18.980

如果要读取图像然后将其渲染为图像

```
$image="path-to-your-image"; //this can also be a url
$filename = basename($image);
$file_extension = strtolower(substr(strrchr($filename,"."),1));
switch( $file_extension ) {
    case "gif": $ctype="image/gif"; break;
    case "png": $ctype="image/png"; break;
    case "jpeg":
    case "jpg": $ctype="image/jpeg"; break;
    default:
}

header('Content-type: ' . $ctype);
$image = file_get_contents($image);
echo $image; 
```

如果您的路径是 url，并且它使用 https:// 协议，那么您可能需要将协议更改为 http

[工作小提琴](http://phpfiddle.org/main/code/8qpe-icz4)

# javascript - JavaScript switch 语句并将返回应用于函数参数

> ID：10034257
> 
> 赞同：0
> 
> 时间：2012-04-05T18:49:32.107
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用 switch 语句在 jqPlot jQuery 插件上的模式之间切换。

如何将我的值从开关应用到函数参数？

我有

```
type = detectType(gType); 
```

我需要显示它，其中类型在下面的参数中。它不返回该值：

```
function detectType(value){
    switch(value){
        case 'bar':
            return 'renderer:$.jqplot.BarRenderer,';
            break;
        case 'pie':
            return 'renderer: $.jqplot.PieRenderer,';
            break;
    }
}

function generateGraph(id,gType) {
    type = detectType(gType);
    var s1 = [2, 6, 7, 10];
    var s2 = [7, 5, 3, 4];
    var s3 = [14, 9, 3, 8];

$.jqplot(''+id+'', [s1, s2, s3], {
        stackSeries: true,
        captureRightClick: true,
        seriesDefaults: {
            type
            rendererOptions: {
                barMargin: 30,
                highlightMouseDown: true   
            },
            pointLabels: {
                show: true
            }
        },
        axes: {
            xaxis: {
                renderer: $.jqplot.CategoryAxisRenderer
            },
            yaxis: {
                padMin: 0
            }
        },
        legend: {
           show: true,
           location: 's',
           placement: 'outside'
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:54:41.220

`type`你不能用字符串做你想做的事情。这是无效的语法。

相反，`detectType`应该只返回渲染器对象本身，而不是作为字符串。然后，将其分配给`renderer`您的系列默认值。像这样：

```
function detectType(value){
    switch(value){
        case 'bar':
            return $.jqplot.BarRenderer;

        case 'pie':
            return $.jqplot.PieRenderer;
    }
} 
```

然后：

```
//...
seriesDefaults: {
    renderer: type
    //...
}
//... 
```

# c++ - C++ - 连续内存和多态性

> ID：10034263
> 
> 赞同：1
> 
> 时间：2012-04-05T18:50:00.620
> 
> 标签：c++, memory-management

我有一个名为的基类`GameObject`，其他类从该基类派生。我想知道通过 `GameObjects`在连续内存中分配所有派生类来处理内存分配是否会提高性能。

我最终会在每个游戏引擎框架中迭代所有这些。

我的问题是，在这种情况下，连续内存存储是否比在没有连续性的情况下分配内存给我更快的迭代时间？在这两种情况下，我都必须保留一个指向游戏对象的指针向量，因为它们的大小会有所不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T18:59:56.600

由于缓存和局部性，迭代连续内存中的对象可能效果更好。但是，我建议您构建这两个系统并实际分析它们。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:24:35.027

我不确定我是否理解这个问题。您是否在问是否更好地将所有对象预先分配在一个巨大的内存块中并将指向该子部分的指针存储在内存中？如果是这样，请不要这样做。

由于系统必须请求较大块的连续内存，而不是较小块的不连续内存，而不是更快，因此您更有可能减慢速度。请记住块分配、分页等。您可能会请求 100 兆字节的连续内存，但它实际上并不连续。一堆它在磁盘中，无论如何都被分解成页面。

然后你会面临这样的问题：你是一次性分配所有游戏对象以获得连续内存还是按需创建它们？你真的要为这个小优化预分配吗？如果您需要创建一个新对象并且您的连续内存块不够大，会发生什么？等等

真的，我只是在这里集思广益潜在的问题。就像其他评论所说的那样，这是一个过早优化的例子。

现在，如果您将所有指针存储在一个连续的数组中，而不是一个根据其当前大小增长和复制的向量中，那肯定会更快，但即便如此，除非您绝对知道游戏对象的数量，否则最好只分配一个足够大的向量，以至于它只增长一两次。

# sql - 如何从一个存储过程中从 SYS_REFCURSOR 中获取数据并在另一个过程中使用它？

> ID：10034266
> 
> 赞同：9
> 
> 时间：2012-04-05T18:50:13.490
> 
> 标签：sql, oracle, stored-procedures, database-cursor

我有一个存储过程，其基本布局如下，它返回一个 sys_refcursor 作为结果集。（从技术上讲，它会重复四个，但为了清楚起见，我只说一个）。结果集是从临时表中选择的。

```
procedure aProcedure
( C1 in out sys_refcursor
) is
begin
--populate Temp_Table here with a stored proc call;
OPEN C1 FOR
SELECT Cols
FROM TEMP_TABLE; 
```

我需要使用不同的存储过程将此结果集从 C1 插入到永久表中。这是可行的还是我需要重新构建结果集？

我已经能够找到有关在 oracle 之外使用游标和结果集的信息，但不能在其内部使用它们。

我知道从第一个存储过程中进行插入可能是有意义的，但这并不是我真正需要的。永久保存结果集是一项可选要求。

感谢您提供任何有用的信息。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-05T23:04:09.527

假设调用者知道`aProcedure`正在打开的游标的结构，你可以做这样的事情。

```
declare
  l_rc sys_refcursor;
  l_rec temp_table%rowtype;
begin
  aProcedure( l_rc );
  loop
    fetch l_rc
     into l_rec;
    exit when l_rc%notfound;

    dbms_output.put_line( l_rec.col1 );
  end loop;
  close l_rc;
end;
/ 
```

如果您无法获取记录类型，您还可以获取许多其他标量局部变量（数量和类型必须匹配`aProcedure`其列表中指定的列的数量和类型`SELECT`）。就我而言，我定义`aProcedure`为返回两个数字列

```
declare
  l_rc sys_refcursor;
  l_col1 number;
  l_col2 number;
begin
  aProcedure( l_rc );
  loop
    fetch l_rc
     into l_col1, l_col2;
    exit when l_rc%notfound;
    dbms_output.put_line( l_col1 );
  end loop;
  close l_rc;
end; 
```

# c# - 为什么我不能在 .ascx 中添加这个“自定义控件”？

> ID：10034277
> 
> 赞同：0
> 
> 时间：2012-04-05T18:50:40.640
> 
> 标签：c#, .net, custom-controls

我的 .ascx 位于文件夹 /cms/context/ 中，它被称为 Test.ascx （在 .NET 4.0，WebForms 上）。

当我尝试添加时：

```
<%@ Register TagPrefix="iz" Namespace="IZ.WebFileManager" Assembly="IZ.WebFileManager" %>

<div>
    <iz:FileManager ID="FileManager1" runat="server" Height="400" Width="600">
        <RootDirectories>
            <iz:RootDirectory DirectoryPath="~/images/" Text="My Documents" />
        </RootDirectories>
    </iz:FileManager>    
</div> 
```

我得到：

> System.NullReferenceException。在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

为什么？我该如何解决？谢谢

PS如果我将相同的代码放在母版页上它也可以工作......

堆栈跟踪 ：

> [NullReferenceException：对象引用未设置为对象的实例。] IZ.WebFileManager.FileView.OnPreRender(EventArgs e) +167 System.Web.UI.Control.PreRenderRecursiveInternal() +112 System.Web.UI.Control.PreRenderRecursiveInternal () +221 System.Web.UI.Control.PreRenderRecursiveInternal() +221 System.Web.UI.Control.PreRenderRecursiveInternal() +221 System.Web.UI.Control.PreRenderRecursiveInternal() +221 System.Web.UI.Page .ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +4200

[这](http://code.google.com/p/izwebfilemanager/downloads/detail?name=IZWebFileManager_2_7_0_Bin_Demo.zip&can=2&q=)是您可以获取该插件的链接。我只是将 DLL 放入 Bin 文件夹并将该代码写入我的 Web 用户控件。总是在母版页上使用，但在 WUC 中我遇到了麻烦......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:56:43.557

如果您只指定命名空间和程序集，您将只获得控件的 ascx.cs 部分，而不是代码前端文件 (.ascx) 因为您的代码隐藏文件 (.ascx.cs) 取决于您的代码前端文件(.ascx) 要实际实例化您声明的所有内容，您需要在 register 指令中包含 Src

```
<%@ Register Src="~/cms/context/Test.ascx" TagPrefix="iz" TagName="Test" %> 
```

如果您在没有代码前端文件（过去称为“自定义控件”）的情况下创建控件，则只需指定命名空间和程序集即可，但如果您想使用代码前端文件（“用户控制”）您需要指定来源。

All the built-in controls within the asp.net framework are created as Custom Controls which means that it was harder for Microsoft to write them (they couldn't use ascx files) but it's easier for us to consume them (single register line in web.config enables for all pages)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T18:53:06.390

我很确定您缺少源参考：

```
<%@ Register Src="~/cms/context/Test.ascx" TagPrefix="iz" TagName="Test" %> 
```

# c# - 通过引用同一程序集的多个版本生成的警告是否可以忽略？

> ID：10034278
> 
> 赞同：1
> 
> 时间：2012-04-05T18:50:46.337
> 
> 标签：c#, visual-studio

我当前的项目之一是将共享库的数据类型从版本 3 转换为版本 4。数据模型已经在许多方面进行了修改，破坏了 API（例如，大量`Shared.Type.DumbName`更改`Shared.Type.SmartName`），因此转换过程将不是简单的一对一映射。

为了进行这种转换，我在库的版本 4 中引用版本 3，并使用[外部别名](http://msdn.microsoft.com/en-us/library/ms173212%28v=vs.80%29.aspx)来解析相关类型。[我已经设置了一个测试项目，它使用必要的绑定重定向](http://msdn.microsoft.com/en-us/library/2fc472t2.aspx)引用了库的两个版本）。测试项目似乎运行正常，但在构建过程中我收到以下警告：

> 无法解决“Shared, Version=4.0.0.0, Culture=neutral, PublicKeyToken=[token]”和“Shared, Version=3.6.8.0, Culture=neutral, PublicKeyToken=[token]”之间的冲突。任意选择“Shared, Version=4.0.0.0, Culture=neutral, PublicKeyToken="。C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets 1360

和

> 发现同一依赖程序集的不同版本之间存在冲突。C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets 1360

可以安全地忽略这些警告吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-09T10:19:45.470

修复警告的最佳实践，警告不能一直被忽略。这些警告与版本控制和框架有关，请确保在所有项目中引用相同版本的 dll。

# unit-testing - FakesAssemblies 文件是否应该添加到源代码管理中？

> ID：10034285
> 
> 赞同：7
> 
> 时间：2012-04-05T18:51:07.910
> 
> 标签：unit-testing, mocking, visual-studio-2012

VS11 中的新 Fakes 框架允许您在单元测试项目中创建程序集引用的假（模拟或存根）实现。当一个程序集被伪造时，VS11 为每个伪造生成两个文件：

```
/FakesAssemblies/[Project].Fakes.dll
/FakesAssemblies/[Project].Fakes.xml 
```

这些文件是否应该添加到源代码管理中？我的假设是否定的，因为它们是自动生成的，但想知道是否有人有其他意见。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T10:15:59.043

自动生成不应成为存储库中存在的区别因素。毕竟，各种自动生成的文件都经常出现在那里——例如设计器文件。

问题是，一直生成额外的假货组装可能很耗时。Microsoft 发布了有关如何尝试优化的[指南：](http://msdn.microsoft.com/en-us/library/hh708916%28v=vs.110%29.aspx#bkmk_optimizing_build_times)

> Fakes 程序集的编译可以显着增加您的构建时间。您可以通过在单独的集中项目中为 .NET 系统程序集和第三方程序集生成 Fakes 程序集来最小化构建时间。由于此类程序集在您的机器上很少更改，因此您可以在其他项目中重用生成的 Fakes 程序集。

因此，很少更改的、基于 .NET FCL / 3rd 方的假程序集应该是存储库的一部分，以加快构建过程。基于您自己的代码的代码可能最好是动态生成的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-04-30T00:50:26.147

根据[http://hamidshahid.blogspot.com.au/2012/11/microsoft-fakes-framework.html](http://hamidshahid.blogspot.com.au/2012/11/microsoft-fakes-framework.html)

> 每当编译项目时，都会生成“FakesAssemblies”文件夹及其中的所有文件。这很重要，因为如果您要为更改组件的装配添加假货，则 FakesAssemblies 的生成将确保所有更改都反映在生成的装配中。

同样[在 GitHub 中，建议](https://github.com/github/gitignore/blob/master/VisualStudio.gitignore)在 .gitignore 中排除它们

```
# Microsoft Fakes
FakesAssemblies 
```

如果您担心构建期间的生成时间，您可以只指定您需要的内容并[禁用存根](https://stackoverflow.com/a/31305010/52277)

```
mscorlib.fakes:
<Fakes xmlns="http://schemas.microsoft.com/fakes/2011/">
  <Assembly Name="mscorlib" Version="4.0.0.0" />
  <StubGeneration Disable="true"/>
  <ShimGeneration>
    <Clear />
    <Add FullName="System.Environment"/>
    <Add FullName="System.TimeZoneInfo"/>
    <Add FullName="System.DateTime"/>
  </ShimGeneration>
</Fakes>
System.fakes:
<Fakes xmlns="http://schemas.microsoft.com/fakes/2011/">
  <Assembly Name="System" Version="4.0.0.0"/>
  <StubGeneration Disable="true" /> 
  <ShimGeneration Disable="true" /> 
</Fakes> 
```

# c# - How should I increment a number for a round robin threading scenario with least contention?

> ID：10034289
> 
> 赞同：4
> 
> 时间：2012-04-05T18:51:22.300
> 
> 标签：c#, multithreading, interlocked

If many threads are calling `GetNextNumber` simultaneously with the following code, `GetNextNumber` will return 1 more times than any other numbers.

```
private class RoundRobbinNumber
{
    private int _maxNumbers = 10;
    private int _lastNumber;

    private RoundRobbinNumber(int maxNumbers)
    {
        _maxNumbers = maxNumbers;
    }

    public int GetNextNumber()
    {
        int nextNumber = Interlocked.Increment(ref _lastNumber);
        if (_lastNumber > _maxNumbers)
        {
            Interlocked.CompareExchange(ref _lastNumber, 1, _maxNumbers);
            nextNumber = 1;
        }
        return nextNumber;
    }
} 
```

Is there a way to reset the `_lastNumber` back to one, and reliably return an incremented number for each thread calling `GetNextNumber()`, without having to use a lock?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:01:52.730

The trick is to do the operation in a loop until it is successful. I provide a general template for this approach in my answer [here](https://stackoverflow.com/a/3736006/158779).

```
public int GetNextNumber()
{
  int initial, computed;
  do
  {
    initial = _lastNumber;
    computed = initial + 1;
    computed = computed > _maxNumbers ? computed = 1 : computed;
  } 
  while (Interlocked.CompareExchange(ref _lastNumber, computed, initial) != initial);
  return computed;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-08T17:28:07.167

Andrey's answer without conditional statements:

```
using System;
namespace Utils
{
    public class RoundRobinCounter
    {
        private int _max;
        private int _currentNumber = 0;

        public RoundRobinCounter(int max)
        {
            _max = max;
        }

        public int GetNext()
        {
            uint nextNumber = unchecked((uint)System.Threading.Interlocked.Increment(ref _currentNumber));
            int result = (int)(nextNumber % _max);
            return result;
        }
    }
} 
```

And here is a [.net fiddle](https://dotnetfiddle.net/O6rO6N) running this code.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-06-21T23:58:48.433

Not sure if if helps anyone but this could be even simpler:

```
class RoundRobinNumber
{
    private int _maxNumbers = 10;
    private int _lastNumber = 0;

    public RoundRobinNumber(int maxNumbers)
    {
        _maxNumbers = maxNumbers;
    }

    public int GetNextNumber()
    {
        int nextNumber = Interlocked.Increment(ref _lastNumber);

        int result = nextNumber % _maxNumbers;  

        return result >= 0 ? result : -result;
    }
} 
```

# java - 是否可以显式访问嵌套类的包含类的实例成员？

> ID：10034291
> 
> 赞同：1
> 
> 时间：2012-04-05T18:51:26.400
> 
> 标签：java, nested-class, scoping

java中是否有关键字允许从嵌套类中显式调用包含实例（或其超类）的成员？

**设想**

```
public class Superclass {
    public void doSomething() {
        // do something that's of interest to the superclass
    }
}

public class Subclass extends Superclass {
    @Override
    public void doSomething() {
        // do something that's of interest to the subclass
        // possibly call super.doSomething()
    }

    private class NestedClass {
        private void doSomething() {
            // do something that's of interest to the nested class
            // calling doSomething() here without an explicit scope
            // specifier results in a stack overflow
        }

        private void doSomethingElse() {
            if (somethingOfInterestToTheSubclassIsNotImportant) {
                // just invoke the superclass's doSomething() method
            } else {
                // invoke the subclass's doSomething() method
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:52:55.963

哦，完全。只需使用`Subclass.this.doSomething()`, 或`Subclass.super.doSomething()`获取超类方法。

# ruby-on-rails - 用于保存报告过滤器的 gem

> ID：10034293
> 
> 赞同：0
> 
> 时间：2012-04-05T18:51:34.550
> 
> 标签：ruby-on-rails, filtering

我正在建立一个新网站，用户可以在其中创建自己的报告。报告由块组成，块可以是图形或表格。所以这样的块可视化了一些数据。用户可以选择哪些对象是该块的源以及该块的过滤器。他可以从现有块编辑这些过滤器。报告已保存，因此稍后可以调用此类报告，并且图形和表格中的数据会更新。

Ruby On Rails 中是否有任何宝石或方法可以实现保存此类数据过滤？

一种方法是在创建块时生成 SQL 代码，但我必须保存大量信息才能编辑这样的块。

谢谢劳伦斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-07T12:56:19.053

您可以将报告过滤器存储在 nosql 数据库中，例如 mongodb。使用此解决方案，将这些参数存储和检索为 JSON 文档将非常容易。

# c# - ASP.NET 会话变量未在具有 Ajax 扩展的页面上设置

> ID：10034298
> 
> 赞同：0
> 
> 时间：2012-04-05T18:52:16.973
> 
> 标签：c#, asp.net, ajax, session, redirect

另一天，另一个愚蠢的新手 ASP.NET 问题......

在我的 ASP.NET Web 应用程序中，当我需要在移动到新页面时保留值时，我选择了设置会话变量和重定向的方法。这一直工作得很好，但后来我添加了 AjaxControlToolkit。现在，在包含来自该工具包的控件的页面上，会话变量不会在重定向时设置。一件很奇怪的事情。除了某种奇怪的名称冲突之外，我无法立即想到任何会导致问题的东西，但我已经通过尝试用无意义的名称来解决这个问题。

这是一些代码示例...我所做的是：

```
Session["SearchTermText"] = search_term;
Response.Redirect("SearchResult.aspx", false); 
```

...在母版页代码隐藏中。以前它运行良好，并且仍然可以在没有 Ajax 工具包控件的页面上完美运行。非常非常奇怪。

我知道 Ajax 往返不会以某种方式重置我的*所有*会话变量，因为一些已经设置的会话数据（例如我的登录）即使在带有 Ajax 工具包控件的页面上也是如此。

有没有人见过这样的事情？

# sql-server - 解析字符串的存储过程

> ID：10034299
> 
> 赞同：1
> 
> 时间：2012-04-05T18:52:23.040
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, stored-procedures

我需要编写一个输入为字符串的存储过程。

输入字符串包含由管道分隔符分隔的变量名称及其值，如下所示：

```
Name =Praveen | City=Hyderabad | Mobile=48629387429| Role=User| etc 
```

在存储过程中，我声明了变量，比如`@x, @y, @z, @t`获取值

```
@x=Praveen (Name value)
@y=Hyderabad (City Value)
@z=48629387429(Mobile Value)
@t=User(Role Value) 
```

输入字符串也可以具有任何顺序的值，例如

```
City=Hyderabad | Mobile=48629387429 | Role=User | Name =Praveen |etc 
```

一旦我将值解析为`@x, @y, @z, @t`etc，我必须在存储过程中使用这些值。

请让我如何解析输入字符串以分别获取`Name, City, Mobile, Role` into`@x, @y, @z`和的值`@t`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T20:01:53.747

一种可能的解决方案是使用 XML

```
DECLARE @text VARCHAR(1000) 
        ,@xml xml

SELECT @text = 'City=Hyderabad | Mobile=48629387429 | Role=User | Name =Praveen'

SELECT @text = REPLACE(@text,'|','"')
    ,@text = REPLACE(@text,'=','="')
    ,@text = '<row ' + @text + '"/>'

SELECT @xml = CAST(@text AS XML)

select 
    line.col.value('@Name[1]', 'varchar(100)') AS Name
    ,line.col.value('@City[1]', 'varchar(100)') AS City
    ,line.col.value('@Mobile[1]', 'varchar(100)') AS Mobile 
    ,line.col.value('@Role[1]', 'varchar(100)') AS Role 
FROM @xml.nodes('/row') AS line(col) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:09:34.740

假设您的输入参数称为@Text。

```
DECLARE @Text varchar(255),
    @x varchar(255)

SET @Text = 'Name=Praveen | City=Hyderabad | Mobile=48629387429| Role=User'

-- Added to show how to account for non-trailing |
SET @Text = @Text + ' | ';

SET @x = LTRIM(RTRIM(substring(
         @Text,
         charindex('Name=', @Text) + LEN('Name='),
         charindex(' | ', @Text, charindex('Name=', @Text)) - LEN('Name=')
         )))

SELECT @x 
```

然后只需对@y、@z、@t 重复此操作，将 Name= 更改为您的休息时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:20:43.447

我绝对建议在程序端而不是数据端进行字符串解析。话虽这么说，如果您绝对必须尝试做类似的事情：

```
DECLARE @String [nvarchar](256) = 'Name=Praveen | City=Hyderabad | Mobile=48629387429 | Role=User |'

DECLARE @name [nvarchar](256) = (SELECT SUBSTRING(@String, CHARINDEX('Name=', @String)+5, CHARINDEX('|', @String)))

DECLARE @city [nvarchar](256) = (SELECT SUBSTRING(@String, CHARINDEX('City=', @String)+5, CHARINDEX('|', @String)))

DECLARE @mobile [nvarchar](256) = (SELECT SUBSTRING(@String, CHARINDEX('Mobile=', @String)+7, CHARINDEX('|', @String)))

DECLARE @role [nvarchar](256) = (SELECT SUBSTRING(@String, CHARINDEX('Role=', @String)+5, CHARINDEX('|', @String)))

SELECT RTRIM(LTRIM(LEFT(@name, CHARINDEX('|', @name)-1))) AS Name,
        RTRIM(LTRIM(LEFT(@city, CHARINDEX('|', @city)-1))) AS City,
        RTRIM(LTRIM(LEFT(@mobile, CHARINDEX('|', @mobile)-1))) AS Mobile,
        RTRIM(LTRIM(LEFT(@role, CHARINDEX('|', @role)-1))) AS Role 
```

这将返回：

```
 Name    | City      | Mobile      | Role
________________________________________________
 Praveen | Hyderabad | 48629387429 | User 
```

*请注意，`CHARINDEX`在初始查询中添加的长度等于搜索字符串。*

"Name=" 等于 5 个字符，所以我们加 5 以将索引移过 = 符号，"Mobile=" 等于 7，所以我们加 7。

同样，在最后的`SELECT`查询中，我们从每个中减去 1`CHARINDEX`以删除 | 象征。

资料来源：

[子串](http://msdn.microsoft.com/en-us/library/ms187748.aspx)

[CHARINDEX](http://msdn.microsoft.com/en-us/library/ms186323.aspx)

[剩下](http://msdn.microsoft.com/en-us/library/ms177601.aspx)

[LTRIM](http://msdn.microsoft.com/en-us/library/ms177827.aspx)

[RTRIM](http://msdn.microsoft.com/en-us/library/ms178660.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T20:24:37.130

这是使用循环进行字符串操作的一种有趣方式。请注意我们如何定义我们的@x、@y 等变量来获取特定值。

```
-- Simulate proc parameter
declare @input nvarchar(max) = 'Name =Praveen | City=Hyderabad | Mobile=48629387429| Role=User'

-- OP's preferred destination vars
declare @x nvarchar(max) = 'Name'
declare @y nvarchar(max) = 'City'
declare @z nvarchar(max) = 'Mobile'
declare @t nvarchar(max) = 'Role'

-- The key/value delimiters we are expecting
declare @recordDelim nchar(1) = '|'
declare @valueDelim nchar(1) = '='

-- Temp storage
declare @inputTable table (
      name nvarchar(128) not null primary key
    , value nvarchar(max) null
)

-- Get all key/value pairs
while ltrim(rtrim(@input)) != '' begin
    insert into @inputTable (name) select ltrim(rtrim(replace(left(@input, isnull(nullif(charindex(@recordDelim, @input), 0), len(@input))), @recordDelim, '')))
    select @input = ltrim(rtrim(right(@input, len(@input) - isnull(nullif(charindex(@recordDelim, @input), 0), len(@input)))))
end

-- Separate keys and values
update @inputTable
set name = ltrim(rtrim(left(name, isnull(nullif(charindex(@valueDelim, name) - 1, 0), len(name)))))
    , value = ltrim(rtrim(right(name, len(name) - isnull(nullif(charindex(@valueDelim, name), 0), len(name)))))

-- Populate the variables
-- If any are null, then this key/value wasn't present
set @x = (select value from @inputTable where name = @x)
set @y = (select value from @inputTable where name = @y)
set @z = (select value from @inputTable where name = @z)
set @t = (select value from @inputTable where name = @t) 
```

此外，从您输入中的不规则间距来看，我猜您想要修剪所有进入的内容（这就是为什么这个 proc 到处都这样做的原因）。

# ios - 存储在应用程序委托中的对象似乎不存在

> ID：10034300
> 
> 赞同：0
> 
> 时间：2012-04-05T18:52:33.957
> 
> 标签：ios, ios5, uiapplicationdelegate

也许我误解了它应该如何工作，但我在应用程序委托中创建了一个对象，并在选项卡栏控制器上设置了该对象，但是当我转到其他选项卡时，它似乎不再存在。

这是我在应用程序委托中唯一引用它的地方。

AppDelegate.h

```
@property (strong, nonatomic) Encounter *encounter; 
```

AppDelegate.m

```
@synthesize encounter; 
```

这是我在选项卡控制器的第一页上设置它的地方。这是唯一一次在初始选项卡控制器视图中引用它。loadEncounter 方法只是将来自 web api 的 json 结果传递给它。然后我加载设置视图标签的值。

```
ehrxAppDelegate *app = [[UIApplication sharedApplication]delegate];
app.encounter = [[Encounter alloc] init];
[app.encounter loadEncounter:result];

nameLabel.text = app.encounter.subscriber_name;
locationlabel.text = app.encounter.location_name;
dateLabel.text = app.encounter.encounter_time;
genderLabel.text = app.encounter.subscriber_gender;
dobLabel.text = app.encounter.subscriber_dob;
statusLabel.text = app.encounter.admission_status;
detailsLabel.text = app.encounter.details; 
```

这就是我在选项卡控制器的第二个视图上访问它的方式。我的印象是，因为我在第一个视图上设置了它的值，所以我可以在第二个视图上抓住它并再次使用它。

```
ehrxAppDelegate *app = [[UIApplication sharedApplication]delegate];
self.encounters = app.encounter.encounters;

[self.tableView reloadData]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:07:06.463

app.encounter.encounters 是否在第一个视图中工作。由于您仍然可以访问 app.encounter ，因此该对象似乎在您的 vire 控制器中仍然存在。所以可能会遇到遇到.encounters 变量的问题。

你是怎么设置的`encounters`？

# python - 使用 Python Sphinx 引用长名称

> ID：10034303
> 
> 赞同：15
> 
> 时间：2012-04-05T18:52:37.723
> 
> 标签：python, python-sphinx, restructuredtext, cross-reference

我正在为我的 Python 模块（使用 Sphinx 和 reST）编写文档，并且我发现当交叉引用其他 Python 对象（模块、类、函数等）时，完整的对象名称最终会非常长。通常它超过 80 个字符，我想不惜一切代价避免。

这是一个例子：

```
def exampleFunction():
    '''Here is an example docstring referencing another
    :class:`module1.module2.module3.module4.module5.ReallyLongExampleClassName`

    ''' 
```

问题是，在为**RealLongExampleClassName**类创建文档时，我为 full path name 生成了它`module1.module2.module3.module4.module5.ReallyLongExampleClassaName`。

我想知道有没有办法解决这个问题？我尝试了以下方法，但没有成功：

1）在模块名称中间添加换行符。例子：

```
:class:`module1.module2.module3.module4.
module5.ReallyLongExampleClassName` 
```

2) 以不同的（但仍然是 Python 可导入的）方式引用类名。例子：

```
:class:`module1.module2.ReallyLongClassName` 
```

我相信，由于文档`ReallyLongClassName`与完整路径名相关联，Sphinx 无法将缩短版本与完整命名版本相关联。

**编辑 2012 年 4 月 5 日**：

根据 j13r 的回答/建议（见下文），我尝试了以下方法：

```
:class:`module1.module2.module3.module4.module5\
ReallyLongExampleClassName` 
```

这很成功。让它工作的唯一警告是，第二行之前不能有空格（在文档字符串中使用它时非常令人沮丧）。因此，要使我的原始示例工作，它看起来像：

```
def exampleFunction():
    '''Here is an example docstring referencing another
    :class:`module1.module2.module3.module4.module5.\
ReallyLongExampleClassName`

    ''' 
```

好看，也丑。如果您要在之前放置空格`ReallyLongExampleClassName`以将其缩进到与它上面的行相同的级别，则输出将包含空格，因此 Sphinx 将尝试引用类似`module1.module2.module3.module4.module5.ReallyLongExampleClassName`.

我还应该注意，我尝试了其他两种变体，但没有奏效：

```
 # Note: Trying to put a space before the '\'
    :class:`module1.module2.module3.module4.module5\. \
ReallyLongExampleClassName`

    # Note: Trying to leave out the '\'
    :class:`module1.module2.module3.module4.module5.
ReallyLongExampleClassName` 
```

我正在寻找一个不涉及破坏文档字符串格式的解决方案，但我想它会这样做......我认为我实际上更喜欢超过 80 个字符的行。

感谢 j13r 的回答！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-08T21:43:40.670

根据 sphinx 文档（[https://www.sphinx-doc.org/en/master/usage/restructuredtext/domains.html#cross-referencing-python-objects](https://www.sphinx-doc.org/en/master/usage/restructuredtext/domains.html#cross-referencing-python-objects)），您可以在目标类之前使用一个点：

```
:class:`.ReallyLongExampleClassName` 
```

或者

```
:class:`.module5.ReallyLongExampleClassName` 
```

让 sphinx 搜索类：

> ...如果名称以点为前缀，并且没有找到完全匹配的，则将目标作为后缀，并搜索具有该后缀的所有对象名称。例如，:py:meth:`.TarFile.close`引用 tarfile.TarFile.close() 函数，即使当前模块不是 tarfile。由于这可能会变得模棱两可，如果有多个可能的匹配项，您将收到来自 Sphinx 的警告。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-10T10:26:50.300

您可以`~`用作前缀，它完全符合您的要求。

[http://sphinx-doc.org/markup/inline.html#xref-syntax](http://sphinx-doc.org/markup/inline.html#xref-syntax)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-03T02:28:33.897

另一种策略是使用 reST [Substitutions](http://www.sphinx-doc.org/en/stable/rest.html#substitutions)。`:class:`这将让您通过稍后调用交叉引用来节省文本中的更多空间：

```
def exampleFunction():
    '''Here is an example docstring referencing another
    |ReallyLongExampleClassName|

    .. |ReallyLongExampleClassName| replace:: 
                                    :class:`.ReallyLongExampleClassName`

    ''' 
```

如果您在许多文件中引用同一个类，则可以使用[rst_epilog](http://www.sphinx-doc.org/en/stable/config.html#confval-rst_epilog)设置将替换项放在 Sphinx conf.py 文件中。从狮身人面像文档：

> **rst_epilog**
> 
> 将包含在每个读取的源文件末尾的 reStructuredText 字符串。这是添加应该在每个文件中可用的替换的正确位置。一个例子：
> 
> ```
> rst_epilog = """
> .. |psf| replace:: Python Software Foundation
> """ 
> ```
> 
> 0.6 版中的新功能。

那么你的文档字符串就是：

```
def exampleFunction():
    '''Here is an example docstring referencing another
    |ReallyLongExampleClassName|

    ''' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T22:06:35.557

在黑暗中狂野刺伤。也许这有效：

```
:class:`module1.module2.module3.module4.\
module5.ReallyLongExampleClassName` 
```

这将是有效的 Python

```
import scipy.\
stats 
```

# c# - c# 中如何处理数字？

> ID：10034308
> 
> 赞同：0
> 
> 时间：2012-04-05T18:52:48.627
> 
> 标签：c#

> **可能的重复：**
> [ValueTypes 如何从 Object (ReferenceType) 派生并且仍然是 ValueTypes？](https://stackoverflow.com/questions/1682231/how-do-valuetypes-derive-from-object-referencetype-and-still-be-valuetypes)

我能够编写这样的代码，

```
String s = 10.ToString(); 
```

ToString() 仅在该特定对象继承类“Object”时才会出现（当然，所有类都继承了 c# 中的 Object）。10号是否也继承了“对象”类。如果有怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T18:57:58.340

> 10号是否也继承了“对象”类。如果有怎么办？

根据规范，该文字`10`由编译器解释为`Int32`. `Int32`继承自`object`。因此，`10`是从 继承的类型的实例`object`。因此，它有一个名为 的实例方法`ToString`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T18:56:27.563

很简单，包括文字在内的所有原语都是 .NET 中的对象，因此继承了 .NET 对象具有的所有方法（包括 ToString()）。有关原语到 .NET 对象的映射，请参阅 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/ms228360](http://msdn.microsoft.com/en-us/library/ms228360(v=VS.80).aspx) (v=VS.80).aspx 。

# iphone - Interface Builder 中标签的行高（前导）

> ID：10034314
> 
> 赞同：0
> 
> 时间：2012-04-05T18:53:12.130
> 
> 标签：iphone, interface-builder

是否可以在界面生成器中更改标签的行高？我发誓这在以前是可能的，但我现在找不到选项。

仅供参考，这是指单个段落中文本行之间的空间（多行标签）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:12:30.320

我不相信使用默认控件可以做到这一点。您正在考虑的功能可能是`Align baselines`UILabels 的选项。请注意，您可以使用 CoreGraphics 的 NSString 附加项自己轻松实现此功能。

# javascript - 使用特定于浏览器的右键单击上下文菜单覆盖特定于站点的 JavaScript 右键单击 上下文菜单

> ID：10034315
> 
> 赞同：5
> 
> 时间：2012-04-05T18:53:13.987
> 
> 标签：javascript, internet-explorer, firefox, google-chrome, contextmenu

在 Mozilla Firefox、Internet Explorer 和/或 Google Chrome 中有没有办法覆盖站点特定的右键上下文菜单（通过 JavaScript 启动），以便显示浏览器上下文菜单？我希望能够在上下文菜单中使用浏览器插件选项，但有些网站不允许这样做。如果您对这些浏览器中的任何一个有任何经验，请回复，我会为您投票。

一个例子：

打开 Google Mail 并右键单击收件箱中的邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T08:04:44.463

出于安全原因，站点管理员通常会这样做。但是，如果您了解一点 HTML / JavaScript，就可以轻松解决这个问题。只需调整您的“mousedown”/“click”处理程序。如果是 jQuery，您可能想要禁用 'contextmenu' 事件。

根据[http://www.techpanache.com/how-to/enable-right-click-menu-on-chrome-and-firefox/](http://www.techpanache.com/how-to/enable-right-click-menu-on-chrome-and-firefox/) ，有一些浏览器扩展可以实现这一点：

*   允许从 Chrome[右键单击](https://chrome.google.com/webstore/detail/hompjdfbfmmmgflfjdlnkohcplmboaeo)
*   火狐的[RightToClick](https://addons.mozilla.org/en-US/firefox/addon/righttoclick/)

# c# - 如何替换 lambda 委托

> ID：10034322
> 
> 赞同：1
> 
> 时间：2012-04-05T18:54:01.630
> 
> 标签：c#, delegates, lambda

（删除了不必要的混乱）

**编辑 1**

似乎我的问题不是很清楚...... doh...... :)

所以 ....

如何写这个：

```
instance.Method(e => OtherClass.Fill(e, instance2.A, instance3.B)); 
```

像这样：

```
instance.Method(new Action<IDataReader>(OtherClass.Fill)); 
```

当“方法”签名为：

```
void Method(Action<IDataReader> reader) 
```

“填充”签名是：

```
void Fill(IDataReader reader, string a, string b); 
```

**更新**

我想出了一种替代实现，但它仍然会导致调试器介入该 Fill 调用。不再有 lambda 表示法，但它似乎仍然介入，啊……

```
instance.Method(delegate(IDataReader e) { OtherClass.Fill(e, instance2.A, instance3.B); }); 
```

**解决方案**

似乎我只需要一个从委托调用的附加方法，然后该方法将调用传递给下一个方法（Fill），并带有另外两个参数：

```
instance.Method(this.Foo);

[DebuggerStepThrough()]
private void Foo(IDataReader reader)
{
    OtherClass.Fill(reader, this.instance2.A, this.instance3.B)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:39:20.273

问题是，您的代码必须在某个地方传递这些额外的参数，而您的调试经验将贯穿该过程。我可以为您提供的最好的方法是将参数传递一点。

任何一个：

```
Action<IDataReader> wrapper = reader => this.Fill(reader, instance2.A, instance3.B);
instance.Method(wrapper); 
```

或者：

```
Func<Action<IDataReader, string, string>, Action<IDataReader>> reducer = arity3 => reader => arity3(reader, instance2.A, instance3.B);
instance.Method(reducer(this.Fill)); 
```

但很明显，这两种解决方案仍然会让调试器“遍历”代码。如果不实际*传递*参数，则无法传递参数。

# google-sheets - Google 电子表格中的换行符未在 Google 图表中输出

> ID：10034323
> 
> 赞同：2
> 
> 时间：2012-04-05T18:54:05.353
> 
> 标签：google-sheets, google-visualization, google-spreadsheet-api

这段代码工作得很好，除了一个小的格式问题我找不到一个简单的方法来解决。作为数据源的谷歌电子表格在列中有换行符。但是，在表格中，它们看起来好像只是由空格格式化。我尝试在数据表中使用 allowHthml 选项（在将换行符转换为
标签之后），但这会删除所有格式并使表格看起来很糟糕。我也尝试过“Formatter”类，但这似乎更倾向于连接字段，并且也遵循相同的 no-html 规则。

任何人都知道我在这里缺少的东西可以让换行符在表格中正确显示而不会破坏格式。我想简单地将换行符添加到字段中，以便它们正确显示。

您可以将其复制/粘贴到 jsLint 中，它会运行并向您显示我在说什么。

```
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load('visualization', '1', {packages: ['table']});
</script>
<script type="text/javascript">

function drawVisualization() {

  var opts = {dataType:'jsonp'};

  var query = new google.visualization.Query('https://docs.google.com/spreadsheet/pub?key=0AiEVKSSB6IaqdDZBTGJqV0lLZEV3YS0teXZkOWR4M3c&output=html', opts);

  query.setQuery("select * ");

  // Send the query with a callback function.
  query.send(handleQueryResponse);
}

function handleQueryResponse(response) {  
  // Create and populate the data table.
  var data = response.getDataTable();

    // Create and draw the visualization.
  visualization = new google.visualization.Table(document.getElementById('table'));
  visualization.draw(data, null);
}
google.setOnLoadCallback(drawVisualization); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-12T22:57:44.873

这可能是一个 hacky 解决方案，但是使用 JavaScript 方法将[字符串中的所有换行符替换为 <br /> 标签](https://stackoverflow.com/questions/784539/replace-all-line-break-in-a-string-with-br-tag-in-javascript)怎么样？我还添加了少量 CSS，以便新表格具有底部垂直对齐（就像原始电子表格一样）。

```
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load('visualization', '1', {packages: ['table']});
</script>
<script type="text/javascript">

function drawVisualization() {
  var opts = {dataType:'jsonp'};
  var query = new google.visualization.Query('https://docs.google.com/spreadsheet/pub?key=0AiEVKSSB6IaqdDZBTGJqV0lLZEV3YS0teXZkOWR4M3c&output=html', opts);

  query.setQuery("select * ");

  // Send the query with a callback function.
  query.send(handleQueryResponse);
}

function handleQueryResponse(response) {
  // Create and populate the data table.
  var data = new google.visualization.DataTable(
        response.getDataTable().toJSON().split("\\n").join("<br />"));

  var opts = {'allowHtml': true};

  // Create and draw the visualization.
  visualization = new google.visualization.Table(document.getElementById('table'));
  visualization.draw(data, opts);
}

google.setOnLoadCallback(drawVisualization);

</script>

<style type="text/css">
.google-visualization-table-td{
    vertical-align: bottom;
}
</style>
<div id="table"></div> 
```

# python - python distutils可以编译CUDA代码吗？

> ID：10034325
> 
> 赞同：11
> 
> 时间：2012-04-05T18:54:12.307
> 
> 标签：python, cuda

我有 CUDA 代码，我想使用 distutils 为 Python 构建一个动态库。但即使安装了“nvcc”编译器，distutils 似乎也无法识别“.cu”文件。不知道如何完成它。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-09T01:13:26.343

Distutils 默认无法编译 CUDA，因为它不支持同时使用多个编译器。默认情况下，它仅根据您的平台设置为编译器，而不是根据您拥有的源代码类型。

我在 github 上有一个示例项目，其中包含一些猴子补丁到 distutils 中，以支持这一点。示例项目是一个 C++ 类，它管理一些 GPU 内存和一个 CUDA 内核，包装在 swig 中，并且全部使用`python setup.py install`. 重点是数组操作，所以我们也在使用 numpy。内核对这个示例项目所做的所有事情就是将数组中的每个元素加一。

代码在这里：[https](https://github.com/rmcgibbo/npcuda-example) ://github.com/rmcgibbo/npcuda-example 。这是 setup.py 脚本。整个代码的关键是`customize_compiler_for_nvcc()`.

```
import  os
from os.path import join as pjoin
from setuptools import setup
from distutils.extension import Extension
from distutils.command.build_ext import build_ext
import subprocess
import numpy

def find_in_path(name, path):
    "Find a file in a search path"
    #adapted fom http://code.activestate.com/recipes/52224-find-a-file-given-a-search-path/
    for dir in path.split(os.pathsep):
        binpath = pjoin(dir, name)
        if os.path.exists(binpath):
            return os.path.abspath(binpath)
    return None

def locate_cuda():
    """Locate the CUDA environment on the system

    Returns a dict with keys 'home', 'nvcc', 'include', and 'lib64'
    and values giving the absolute path to each directory.

    Starts by looking for the CUDAHOME env variable. If not found, everything
    is based on finding 'nvcc' in the PATH.
    """

    # first check if the CUDAHOME env variable is in use
    if 'CUDAHOME' in os.environ:
        home = os.environ['CUDAHOME']
        nvcc = pjoin(home, 'bin', 'nvcc')
    else:
        # otherwise, search the PATH for NVCC
        nvcc = find_in_path('nvcc', os.environ['PATH'])
        if nvcc is None:
            raise EnvironmentError('The nvcc binary could not be '
                'located in your $PATH. Either add it to your path, or set $CUDAHOME')
        home = os.path.dirname(os.path.dirname(nvcc))

    cudaconfig = {'home':home, 'nvcc':nvcc,
                  'include': pjoin(home, 'include'),
                  'lib64': pjoin(home, 'lib64')}
    for k, v in cudaconfig.iteritems():
        if not os.path.exists(v):
            raise EnvironmentError('The CUDA %s path could not be located in %s' % (k, v))

    return cudaconfig
CUDA = locate_cuda()

# Obtain the numpy include directory.  This logic works across numpy versions.
try:
    numpy_include = numpy.get_include()
except AttributeError:
    numpy_include = numpy.get_numpy_include()

ext = Extension('_gpuadder',
                sources=['src/swig_wrap.cpp', 'src/manager.cu'],
                library_dirs=[CUDA['lib64']],
                libraries=['cudart'],
                runtime_library_dirs=[CUDA['lib64']],
                # this syntax is specific to this build system
                # we're only going to use certain compiler args with nvcc and not with gcc
                # the implementation of this trick is in customize_compiler() below
                extra_compile_args={'gcc': [],
                                    'nvcc': ['-arch=sm_20', '--ptxas-options=-v', '-c', '--compiler-options', "'-fPIC'"]},
                include_dirs = [numpy_include, CUDA['include'], 'src'])

# check for swig
if find_in_path('swig', os.environ['PATH']):
    subprocess.check_call('swig -python -c++ -o src/swig_wrap.cpp src/swig.i', shell=True)
else:
    raise EnvironmentError('the swig executable was not found in your PATH')

def customize_compiler_for_nvcc(self):
    """inject deep into distutils to customize how the dispatch
    to gcc/nvcc works.

    If you subclass UnixCCompiler, it's not trivial to get your subclass
    injected in, and still have the right customizations (i.e.
    distutils.sysconfig.customize_compiler) run on it. So instead of going
    the OO route, I have this. Note, it's kindof like a wierd functional
    subclassing going on."""

    # tell the compiler it can processes .cu
    self.src_extensions.append('.cu')

    # save references to the default compiler_so and _comple methods
    default_compiler_so = self.compiler_so
    super = self._compile

    # now redefine the _compile method. This gets executed for each
    # object but distutils doesn't have the ability to change compilers
    # based on source extension: we add it.
    def _compile(obj, src, ext, cc_args, extra_postargs, pp_opts):
        if os.path.splitext(src)[1] == '.cu':
            # use the cuda for .cu files
            self.set_executable('compiler_so', CUDA['nvcc'])
            # use only a subset of the extra_postargs, which are 1-1 translated
            # from the extra_compile_args in the Extension class
            postargs = extra_postargs['nvcc']
        else:
            postargs = extra_postargs['gcc']

        super(obj, src, ext, cc_args, postargs, pp_opts)
        # reset the default compiler_so, which we might have changed for cuda
        self.compiler_so = default_compiler_so

    # inject our redefined _compile method into the class
    self._compile = _compile

# run the customize_compiler
class custom_build_ext(build_ext):
    def build_extensions(self):
        customize_compiler_for_nvcc(self.compiler)
        build_ext.build_extensions(self)

setup(name='gpuadder',
      # random metadata. there's more you can supploy
      author='Robert McGibbon',
      version='0.1',

      # this is necessary so that the swigged python file gets picked up
      py_modules=['gpuadder'],
      package_dir={'': 'src'},

      ext_modules = [ext],

      # inject our custom trigger
      cmdclass={'build_ext': custom_build_ext},

      # since the package has c code, the egg cannot be zipped
      zip_safe=False) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-02-01T22:48:07.450

作为`distutils`/的替代方案`setuptools`，您可以使用[`scikit-build`](https://scikit-build.readthedocs.io/en/latest/index.html)（与`CMakeLists.txt`、`pyproject.toml`和`setup.cfg`/一起`setup.py`）：

```
import sys
from pathlib import Path
from skbuild import setup
from setuptools import find_packages

# https://github.com/scikit-build/scikit-build/issues/521#issuecomment-753035688
for i in (Path(__file__).resolve().parent / "_skbuild").rglob("CMakeCache.txt"):
    i.write_text(re.sub("^//.*$\n^[^#].*pip-build-env.*$", "", i.read_text(), flags=re.M))

setup(cmake_args=[f"-DPython3_ROOT_DIR={sys.prefix}"],
      packages=find_packages(exclude=["tests"])) 
```

# sql-server - 是否可以在单个分区上运行 DBCC CHECKDB？

> ID：10034327
> 
> 赞同：3
> 
> 时间：2012-04-05T18:54:23.217
> 
> 标签：sql-server, sql-server-2008

是否可以在 sql server 的单个分区上运行 DBCC CHECKDB？我知道如果分区位于单独的文件组上，我们可以使用 CHECKFILEGROUP，但是如果分区不在单独的文件组上怎么办？是否可以使用 CHECKDB 指定分区号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T19:09:55.477

不——当我重写 CHECKDB 时，我从来没有写过仅分区的一致性检查。CHECKFILEGROUP 是您唯一的选择。

谢谢

# java - 只有整数的对象的哈希码

> ID：10034328
> 
> 赞同：0
> 
> 时间：2012-04-05T18:54:32.120
> 
> 标签：java, hashcode

您如何以一般（和高性能）的方式实现哈希码，同时最大限度地减少具有 2 个或更多整数的对象的冲突？

更新：正如许多人所说，你不能完全消除结肠（老实说没有考虑过）。所以我的问题应该是如何以适当的方式最小化碰撞，并进行编辑以反映这一点。

使用 NetBeans 的自动生成失败；例如：

```
public class HashCodeTest {
    @Test
    public void testHashCode() {
        int loopCount = 0;
        HashSet<Integer> hashSet = new HashSet<Integer>();
        for (int outer = 0; outer < 18; outer++) {
            for (int inner = 0; inner < 2; inner++) {
                loopCount++;
                hashSet.add(new SimpleClass(inner, outer).hashCode());
            }
        }
        org.junit.Assert.assertEquals(loopCount, hashSet.size());
    }

    private class SimpleClass {
        int int1;
        int int2;

        public SimpleClass(int int1, int int2) {
            this.int1 = int1;
            this.int2 = int2;
        }

        @Override
        public int hashCode() {
            int hash = 5;
            hash = 17 * hash + this.int1;
            hash = 17 * hash + this.int2;
            return hash;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T18:57:55.347

> 您能否以一般（和高性能）的方式为具有 2 个或更多整数的对象实现哈希码，而无需使用 colisions。

当散列到 32 位（一个整数）由超过 32 位（如 2 个或更多整数）组成的东西时，从技术上讲，零冲突是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:01:31.680

这是 eclipse 自动生成的：

```
@Override
public int hashCode() {
    final int prime = 31;
    int result = 1;
    result = prime * result + getOuterType().hashCode();
    result = prime * result + int1;
    result = prime * result + int2;
    return result;
} 
```

使用此代码，您的测试用例通过...

PS：别忘了实施`equals()`！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T18:57:08.237

没有办法完全消除哈希冲突。您的方法基本上是减少冲突的首选方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T18:58:18.923

创建零冲突的哈希方法是不可能的。散列方法的想法是您正在获取大量对象并将其映射到一组较小的整数。您能做的最好的事情就是尽量减少您在对象子集中遇到的碰撞次数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T19:43:59.893

正如其他人所说，减少碰撞比消除碰撞更重要——特别是因为你没有说你的目标是多少桶。与 2 个桶中有 5 个项目相比，1000 个桶中有 5 个项目的零碰撞要容易得多！即使有很多存储桶，1000 个存储桶与 1001 个存储桶的碰撞看起来也会大不相同。

需要注意的另一件事是，您提供的哈希很有可能甚至不是 HashMap 最终使用的哈希。例如，如果您查看[OpenJDK HashMap 代码](http://www.docjar.com/html/api/java/util/HashMap.java.html)，您会看到您的密钥的 hashCodes 是通过一个私有`hash`方法（该链接中的第 264 行）放置的，该方法重新对它们进行哈希处理。因此，如果您在创建一个精心构建的自定义哈希函数以减少冲突（而不仅仅是一个简单的、自动生成的）时遇到麻烦，请确保您还了解谁将使用它以及如何使用它。

# c# - Task.Factory.StartNew() 重载

> ID：10034330
> 
> 赞同：8
> 
> 时间：2012-04-05T18:54:41.153
> 
> 标签：c#, compiler-errors, task

我有非常简单的代码：

```
static void Main(string[] args)
{
    var task = Task.Factory.StartNew(GetInt);

    var task2 = Task.Factory.StartNew(
        () =>
        {
            return GetInt();
        });
}

static int GetInt()
{
    return 64;
} 
```

为什么第一个任务会出现编译器错误？方法签名（没有参数，返回类型是`int`）是相等的，不是吗？

我知道一个解决方案（这很简单`var task = Task.Factory.StartNew<int>(GetInt);`：），但我想知道上面的代码有什么问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:01:25.817

由于方法签名相同，您会收到一个模棱两可的调用错误。返回值不是签名的一部分。

由于您没有提供显式返回类型，编译器不知道该采用哪个。

[C# 中的方法签名](https://stackoverflow.com/questions/8808703/method-signature-in-c-sharp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:13:11.303

因为编译器无法决定使用这两个重载中的哪一个：

```
StartNew(Action)
StartNew<TResult>(Func<TResult>) 
```

原因是返回类型不是 C# 中重载解决方案的一部分（与您不能有两个仅在返回类型不同的重载一样），因此编译器无法决定`GetInt`应该是 an`Action`还是 a `Func<T>`。通过调用强制使用通用版本`StartNew<int>(GetInt)`将提供所需的信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T19:11:22.700

作为记录，这里有另外两种方法（编译）：

```
var task3 = Task.Factory.StartNew((Func<int>)GetInt);
var task4 = Task.Factory.StartNew(() => GetInt()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T19:06:23.287

将有助于显示异常：*“以下方法或属性之间的调用不明确：'System.Threading.Tasks.TaskFactory.StartNew(System.Action)'和'System.Threading.Tasks.TaskFactory.StartNew(System.Func )'"*

如果你看一下，有两种可能的方法：

```
public Task<TResult> StartNew<TResult>(Func<TResult> function);
public Task StartNew(Action action); 
```

如果您添加`<int>`或提供 a`Func<int>`您会强制它采用第一个签名。没有那个你的代码是模棱两可的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T18:58:50.453

您会收到编译错误，因为 StartNew 方法接受了具有各种重载的 Action（返回 void）或 Func（返回某些东西）谓词，而不是直接委托。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T19:08:35.177

正如其他人所说，您需要将 GetInt 作为函数传递给 StartNew，或者指定您打算通过提供泛型类型从 StartNew 返回一个值。否则，编译器不知道您打算创建什么样的任务......这是模棱两可的。

```
static void Main(string[] args)
{
    var task = Task.Factory.StartNew<int>(GetInt);

    var task2 = Task.Factory.StartNew(
        () =>
        {
            return GetInt();
        });
}

static int GetInt()
{
    return 64;
} 
```

# iphone - 如何在纵向模式下通过 AVAssetExportSession 导出视频资产

> ID：10034337
> 
> 赞同：7
> 
> 时间：2012-04-05T18:55:15.313
> 
> 标签：iphone, video, avfoundation, assets, avassetexportsession

当我通过 AVAssetExportSession 导出视频资产时，结果文件处于陆地空间模式。（通过iTunes->应用程序->文件共享->我的应用程序抓取的文件）。如何以纵向模式导出视频资产（旋转它）？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-06T12:15:47.423

来自 iPhone 捕获设备的视频始终是横向的，无论捕获时设备的方向是什么。

如果要旋转视频，“简单”的解决方案是为导出会话的视频轨道分配一个变换。

在 AVComposition 对象中创建 2 个可变轨道：

```
AVMutableCompositionTrack *videoTrack = [composition addMutableTrackWithMediaType:AVMediaTypeVideo preferredTrackID:kCMPersistentTrackID_Invalid];
AVMutableCompositionTrack *audioTrack = [composition addMutableTrackWithMediaType:AVMediaTypeAudio preferredTrackID:kCMPersistentTrackID_Invalid]; 
```

将您的媒体曲目添加到您的作品的曲目中：

```
...        
BOOL videoResult = [videoTrack insertTimeRange:sourceCMTime 
                                       ofTrack:[tracks objectAtIndex:0] 
                                        atTime:currentTime 
                                         error:&error];

BOOL audioResult = [audioTrack insertTimeRange:sourceCMTime 
                                       ofTrack:[tracks objectAtIndex:0] 
                                        atTime:currentTime 
                                         error:&error];
... 
```

添加所有轨道后，将变换应用到合成的视频轨道：

```
 CGAffineTransform rotationTransform = CGAffineTransformMakeRotation(M_PI_2);
//    CGAffineTransform rotateTranslate = CGAffineTransformTranslate(rotationTransform,360,0);
    videoTrack.preferredTransform = rotationTransform; 
```

（注意transform是以左上角为原点的，所以旋转后需要平移，但在iPhone 4S，iOS 5.1上测试，现在似乎是围绕中心进行旋转。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-24T10:04:10.873

同时 U 变换轨道时应设置合成 renderSize，因为它可能超出框架或出现黑色块：

```
self.mutableVideoComposition.renderSize = CGSizeMake(assetVideoTrack.naturalSize.height,assetVideoTrack.naturalSize.width); 
```

# algorithm - 具有最多 n 个点的整数的数组的排序算法

> ID：10034340
> 
> 赞同：1
> 
> 时间：2012-04-05T18:55:48.020
> 
> 标签：algorithm, sorting

给定一个包含整数的数组，每个整数距其最终位置最多 n 个位置，最好的排序算法是什么？

我一直在思考这个问题，我似乎无法找到一个好的策略来开始处理这个问题。有人可以指导我吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T23:52:58.720

我将列表（大小为 N）拆分为 2n 个子列表（使用从零开始的索引）：

列表 0：元素 0、2n、4n、...
列表 1：元素 1、2n+1、4n+1、...
...
列表 2n-1：元素 2n-1、4n-1、...

**这些列表中的每一个显然都是排序的。**

现在合并这些列表（一次重复合并 2 个列表，或者使用一个最小堆和每个列表中的一个元素）。

**就这样。**时间复杂度为 O(N log(n))。

这在 Python 中很容易：

```
>>> a = [1, 0, 5, 4, 3, 2, 6, 8, 9, 7, 12, 13, 10, 11]
>>> n = max(abs(i - x) for i, x in enumerate(a))
>>> n
3
>>> print(*heapq.merge(*(a[i::2 * n] for i in range(2 * n))))
0 1 2 3 4 5 6 7 8 9 10 11 12 13 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:10:44.930

对于最初的随机数组/元素集合，[堆排序](http://www.sorting-algorithms.com/heap-sort)非常快。在伪代码中，这种排序将按如下方式实现：

```
# heapify
for i = n/2:1, sink(a,i,n)
→ invariant: a[1,n] in heap order

# sortdown
for i = 1:n,
    swap a[1,n-i+1]
    sink(a,1,n-i)
    → invariant: a[n-i+1,n] in final position
end

# sink from i in a[1..n]
function sink(a,i,n):
    # {lc,rc,mc} = {left,right,max} child index
    lc = 2*i
    if lc > n, return # no children
    rc = lc + 1
    mc = (rc > n) ? lc : (a[lc] > a[rc]) ? lc : rc
    if a[i] >= a[mc], return # heap ordered
    swap a[i,mc]
    sink(a,mc,n) 
```

对于不同的情况，例如“少数独特”的“几乎排序”，算法可以以不同的方式工作并且更有效。有关各种情况下带有动画的算法的完整列表，请参见[这个精彩的网站](http://www.sorting-algorithms.com/)。

我希望这有帮助。

附言。对于几乎排序的集合（如上所述），插入排序是您的赢家。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:28:49.783

我建议使用[梳子排序](http://en.wikipedia.org/wiki/Comb_sort)，只需以等于最大距离（或大约在那里）的间隙大小开始它。预计为 O(n log n)（或者在您的情况下为 O(n log d)，其中 d 是最大位移），易于理解，易于实现，并且即使元素的位移超出您的预期，也可以工作。如果您需要有保证的执行时间，您可以使用堆排序之类的东西，但过去我发现空间或计算时间的开销通常不值得，最终几乎实现了其他任何东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-23T13:24:10.427

自`each integer being at most n positions away from its final position`：

1) 对于最小整数（也就是最终排序数组中的第 0 个整数），它的当前位置必须在 A[0...n] 中，因为第 n 个元素距离第 0 个位置有 n 个位置

2) 对于第二小的整数（也就是最终排序数组中的第一个整数，从零开始），它的当前位置必须在 A[0...n+1]

3) 对于第 i 个最小的整数，它的当前位置必须在 A[in...i+n]

我们可以使用一个 (n+1) 大小的最小堆，其中包含一个滚动窗口来对数组进行排序。您可以在此处找到更多详细信息：

[http://www.geeksforgeeks.org/nearly-sorted-algorithm/](http://www.geeksforgeeks.org/nearly-sorted-algorithm/)

# ios - 在 iOS 设备上产生超声波

> ID：10034346
> 
> 赞同：0
> 
> 时间：2012-04-05T18:56:04.600
> 
> 标签：ios, iphone, audio

我想从 iPhone 设备产生超声波。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:00:43.360

至少 iPhone 4s 的额定频率为 20Hz - 20,000Hz，这意味着它不能产生超声波频率。

我怀疑任何大众市场的 iOS 设备都会产生超声波频率。

[http://www.apple.com/iphone/iphone-4/specs.html](http://www.apple.com/iphone/iphone-4/specs.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:05:49.537

我知道没有标准配备超声波换能器的手机。大多数手机上的小型扬声器在超声波频率下可能会有一些响应，但 D>A 转换器和音频放大器不会。

你需要特殊的硬件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T18:57:33.363

在您的计算机上创建声音（可能是[http://www.blackcatsystems.com/software/audiotoolbox.html](http://www.blackcatsystems.com/software/audiotoolbox.html)？），将其存储为 WAV（或任何其他兼容格式）并使用 iOS 上的音频播放功能进行播放。

**编辑**

好的，所以手机本身无法做到这一点。

构建一些可以发射频率高于 20,000Hz 的声波的定制硬件，然后开发一个应用程序来利用这些硬件。

# .net - 在 VB.NET 4 下创建系统服务时出现线程/定时器问题

> ID：10034359
> 
> 赞同：3
> 
> 时间：2012-04-05T18:56:46.617
> 
> 标签：.net, vb.net, multithreading, service, cron

我认为在 VB .NET 下创建一个简单的系统服务将是小菜一碟。男孩，我错了吗。首先，我通过 Google 发现一般帖子说您应该使用 Windows.Forms.Timer。然后，我发现相互矛盾的信息表明您必须通过代码从计时器类派生计时器才能使其工作。然后，人们使用各种可用的线程报告各种问题。由于显而易见的原因，我无法使用 VS 2010 即时调试器调试线程（尽管我不知道是否有其他方法可以做到这一点）。哇，当没有明确的指南时，这一切是多么令人困惑……

我的项目是一个应用程序启动器（类似于 cron），它将在一定秒数内定期启动。我正在尝试使用 Process.Start() 方法。我有一个 Beep() 函数作为第一条指令，Process.Start 以及一个 Process.WaitForExit 方法使它作为最后一条指令阻塞。我让我的代码通过计时器来执行此操作，但现在我开始使用线程。执行上没有区别。被覆盖的 OnStart 方法确实启动了（正如我通过调试确定的那样），但是在生产中启动服务时什么也没有发生，就好像它忽略了我的所有代码一样。将循环和逻辑放在 OnStart 方法中会产生一个不会启动的进程。我知道这是一个线程问题，但我也知道必须强制使用线程。我现在对如何完成这项工作感到目瞪口呆。

除了服务类之外，我还实现了从 MSDN 逐字复制的 ServiceInstaller 和 ProcessInstaller。

这是我正在尝试使用的一些代码。请注意，这仅反映了我的代码在尝试在线程而不是计时器中实现逻辑时的当前状态（这对我来说是最佳的）：

```
 Dim config As String
    Dim configValues(2) As String
    Dim objReader As System.IO.StreamReader
    Dim interval As Integer
    Dim launchProcess As Process

    While True
        Beep()
        ' This sub runs every time the elapsed milli-seconds of the timer pass
        ' Sp add your code here.

        config = "30 c:\WiFiDropOutFix\start.vbs"

        Try
            objReader = New System.IO.StreamReader("C:\WiFiDropOutFix\config.txt")
            config = objReader.ReadToEnd
            objReader.Close()
        Catch ex As Exception

        End Try

        configValues = config.Split(New Char() {" "c})
        interval = Convert.ToInt32(configValues(0))

        If Not interval > 0 And Not interval < 61 Then
            interval = 10
        End If

        launchProcess = Process.Start(configValues(1))
        launchProcess.WaitForExit()

        Thread.Sleep(interval * 1000)

    End While
End Sub 
```

这是我请求的 OnStart 代码：

```
Protected Overrides Sub OnStart(ByVal args() As String)

    appLaunchLogicThread = New Thread(AddressOf appLaunchLogic)
    appLaunchLogicThread.Start()

End Sub 
```

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:57:52.383

尝试转到服务控制面板，编辑服务的属性，然后选中“交互式服务”或“**允许服务与桌面交互**”选项。如果您尝试启动一个新进程并在屏幕上看到它，除非启用此选项，否则不会发生任何事情。

此外，将服务的**登录凭据**设置为**管理员**，以确保它不是**权限问题**。如果它有效，那么您已经发现了问题所在。

另一个提示：将所有处理代码编写为您可以轻松调试的**普通****应用程序**，一旦所有错误都被消除并且您知道代码完美无缺，然后将**其实现为服务**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T17:49:57.323

好的，我设法找到了我的项目无法正常工作的原因。我确实记得看到有人说 [STAThread] 指令对于已启动的进程在服务中执行是必需的，并且它必须放在 Main 函数之前。Codeproject 已经为 C# 中的 Windows 服务发布了一个[cron 项目，它使用了这个指令。](http://www.codeproject.com/Articles/10992/Implementing-a-small-Cron-service-in-C)我将不得不更多地查看这个已发布的项目，但它可能无法在 VB .NET 中实现。在这一点上，我不明白如何通过 VB .NET Visual Studio 服务模板通过 Main 函数/类合并服务启动器，因为它似乎已经自行启动。

此外，我终于设法找到了一个 Windows cron 服务程序，它可以在几秒钟内运行，它没有强制性的商业许可，可以免费使用，并且注册成本低廉（根据网站上的说明）。它被称为[WinCron](http://www.wincron.com/)。

# javascript - 带有插值折线图的谷歌图表

> ID：10034363
> 
> 赞同：4
> 
> 时间：2012-04-05T18:56:59.690
> 
> 标签：javascript, charts

[https://google-developers.appspot.com/chart/interactive/docs/gallery/linechart](https://google-developers.appspot.com/chart/interactive/docs/gallery/linechart)

我正在使用上面显示的谷歌折线图，我想要多条线，但一条线可能有数据，而另一条数据没有。

所以，基本上有一个选项可以让我做类似的事情。

```
data.addRows([
      ['2004', 1000, 400],
      ['2005', null, 460],
      ['2006',  860, null],
      ['2007', 1030, 540]
]); 
```

并有一条线通过`(2004, 1000)`而`(2005, 860)`不是`(2004, 1000)`to `(2005, 0)`to `(2006, 860)`？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T03:08:37.173

对于折线图，您可以使用[此处](https://google-developers.appspot.com/chart/interactive/docs/gallery/linechart)提到的 interpolateNulls 选项。

将其设置为 true 将使其插入适当的值。

# java - 如何在自签名服务器和客户端证书上调用 https get 方法

> ID：10034369
> 
> 赞同：1
> 
> 时间：2012-04-05T18:57:15.743
> 
> 标签：java, apache, http, https, servlet-3.0

我已经设置了 Apache tomcat 5 来​​支持 ssl。创建自签名证书并将客户端证书导入服务器的信任库并将p12文件导入浏览器并可以访问https上的页面。如何使用 java 实现相同的功能？

以下是我正在尝试但没有任何成功的代码......

```
//reference  : http://vafer.org/blog/20061010073725/    http://www.mkyong.com/java/java-//https-client-httpsurlconnection-example/

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.URL;
import java.security.KeyManagementException;
import java.security.KeyStore;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;
import java.security.SecureRandom;
import java.security.UnrecoverableKeyException;
import java.security.cert.CertificateException;

import javax.net.ssl.HttpsURLConnection;
import javax.net.ssl.KeyManagerFactory;
import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLPeerUnverifiedException;
import java.security.cert.Certificate;

public class HttpClientTutorial {

    @SuppressWarnings("unused")
    private static javax.net.ssl.SSLSocketFactory getFactory( File pKeyFile, String pKeyPassword ) throws NoSuchAlgorithmException, KeyStoreException, CertificateException, IOException, UnrecoverableKeyException, KeyManagementException  
    {
          KeyManagerFactory keyManagerFactory = KeyManagerFactory.getInstance("SunX509");
          KeyStore keyStore = KeyStore.getInstance("PKCS12");

          InputStream keyInput = new FileInputStream(pKeyFile);
          keyStore.load(keyInput, pKeyPassword.toCharArray());
          keyInput.close();

          keyManagerFactory.init(keyStore, pKeyPassword.toCharArray());

          SSLContext context = SSLContext.getInstance("TLS");
          context.init(keyManagerFactory.getKeyManagers(), null, new SecureRandom());

          return context.getSocketFactory();
    }

       private static void print_https_cert(HttpsURLConnection con){

            if(con!=null){

              try {

            System.out.println("Response Code : " + con.getResponseCode());
            System.out.println("Cipher Suite : " + con.getCipherSuite());
            System.out.println("\n");

            Certificate[] certs = con.getServerCertificates();
            for(Certificate cert : certs){
               System.out.println("Cert Type : " + cert.getType());
               System.out.println("Cert Hash Code : " + cert.hashCode());
               System.out.println("Cert Public Key Algorithm : " + cert.getPublicKey().getAlgorithm());
               System.out.println("Cert Public Key Format : " + cert.getPublicKey().getFormat());
               System.out.println("\n");
            }

            } catch (SSLPeerUnverifiedException e) {
                e.printStackTrace();
            } catch (IOException e){
                e.printStackTrace();
            }

             }

           }

           private static void print_content(HttpsURLConnection con){
            if(con!=null){

            try {

               System.out.println("****** Content of the URL ********");            
               BufferedReader br = 
                new BufferedReader(
                    new InputStreamReader(con.getInputStream()));

               String input;

               while ((input = br.readLine()) != null){
                  System.out.println(input);
               }
               br.close();

            } catch (IOException e) {
               e.printStackTrace();
            }

               }

           }

    public static void main(String[] args) throws IOException, UnrecoverableKeyException, KeyManagementException, NoSuchAlgorithmException, KeyStoreException, CertificateException {
        URL url = new URL("https://localhost:8443/SpringSec2");
        HttpsURLConnection con = (HttpsURLConnection) url.openConnection();
        con.setSSLSocketFactory(getFactory(new File("src/Client.p12"), "client"));

          //dumpl all cert info
         print_https_cert(con);

         //dump all the content
         print_content(con);

    }

}

*************************************************************************************** 
```

例外：

```
javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
at com.sun.net.ssl.internal.ssl.Alerts.getSSLException(Unknown Source)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.fatal(Unknown Source)
at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Unknown Source)
at com.sun.net.ssl.internal.ssl.Handshaker.fatalSE(Unknown Source)
at com.sun.net.ssl.internal.ssl.ClientHandshaker.serverCertificate(Unknown Source)
at com.sun.net.ssl.internal.ssl.ClientHandshaker.processMessage(Unknown Source)
at com.sun.net.ssl.internal.ssl.Handshaker.processLoop(Unknown Source)
at com.sun.net.ssl.internal.ssl.Handshaker.process_record(Unknown Source)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.readRecord(Unknown Source)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.performInitialHandshake(Unknown Source)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(Unknown Source)
at com.sun.net.ssl.internal.ssl.SSLSocketImpl.startHandshake(Unknown Source)
at sun.net.www.protocol.https.HttpsClient.afterConnect(Unknown Source)
at sun.net.www.protocol.https.AbstractDelegateHttpsURLConnection.connect(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)
at java.net.HttpURLConnection.getResponseCode(Unknown Source)
at sun.net.www.protocol.https.HttpsURLConnectionImpl.getResponseCode(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:45:42.487

由于您正在做自签名证书，因此您需要提供自己的 TrustManager。代码中的行

`SSLContext context = SSLContext.getInstance("TLS"); context.init(keyManagerFactory.getKeyManagers(), null, new SecureRandom());`

中的第二个参数`context.init`是 TrustManager，用于管理您可以信任的服务器。您基本上需要创建自己的扩展`X509TrustManager`。可以在[http://www.howardism.org/Technical/Java/SelfSignedCerts.html](http://www.howardism.org/Technical/Java/SelfSignedCerts.html)找到该代码的示例。搜索`NaiveTrustManager`，你会看到它`checkServerTrusted()`没有实现，这意味着它信任一切。首先尝试一下，看看是否有效。完成后，您可能需要考虑实施更强的检查。

# php - 为什么我的复选框没有选中？

> ID：10034374
> 
> 赞同：0
> 
> 时间：2012-04-05T18:57:46.407
> 
> 标签：php, javascript, jquery, json

我已经构建了一个表单，它使用 JSON 从 MYSQL 数据库中提取品牌列表。拉进来的品牌应该改变表单中对应的输入品牌元素。但由于某种原因，我没有让这个工作。

我的代码：

**JSON**

```
 [{"pkFavorietemerken":"1","merken":"Adidas"},{"pkFavorietemerken":"2","merken":"Boss"},{"pkFavorietemerken":"3","merken":"Burberry"},{"pkFavorietemerken":"4","merken":"Christian Dior"},{"pkFavorietemerken":"5","merken":"D&G"},{"pkFavorietemerken":"6","merken":"Diesel"},{"pkFavorietemerken":"7","merken":"Dolce & Gabanna"},{"pkFavorietemerken":"8","merken":"Emporio Armani"}] 
```

**查询：**

```
 $("document").ready(function(){
     $.getJSON("jason2.php", function(data) {
         $.each(data, function(){
             $("[value=this.merken]").attr("checked","checked");
         });
     }); 
```

**HTML：**

```
<form name="form1" method="post" action="something.php">                        
        <ul>
            <li><input type="checkbox" name="merk[]" value="Adidas"/>Adidas</li>
            <li><input type="checkbox" name="merk[]" value="Airforce"/>Airforce</li>
            <li><input type="checkbox" name="merk[]" value="Armani"/>Armani</li>
            <li><input type="checkbox" name="merk[]" value="Asics"/>Asics</li>
            <li><input type="checkbox" name="merk[]" value="Bikkemberg"/>Bikkemberg</li>
            <li><input type="checkbox" name="merk[]" value="Bjorn Borg"/>Bjorn Borg</li>
            <li><input type="checkbox" name="merk[]" value="BlueBlood"/>BlueBlood</li>
            <li><input type="checkbox" name="merk[]" value="Boss"/>Boss</li>
            <li><input type="checkbox" name="merk[]" value="Brunotti"/>Brunotti</li>
            <li><input type="checkbox" name="merk[]" value="Burberry"/>Burberry</li>
        </ul>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T18:59:35.903

尝试更换：

```
$("[value=this.merken]").attr("checked","checked"); 
```

和：

```
$("[value='" + this.merken + "']").attr("checked","checked"); 
```

# python - Django admin 内联模型定制

> ID：10034375
> 
> 赞同：1
> 
> 时间：2012-04-05T18:57:47.893
> 
> 标签：python, django, django-admin

有没有办法将 django admin inline-models 与类似模型的集群分离？

一点上下文：我有一个名为 Page 的模型，它有两个内联模型，TextBlock 和 GalleryContainer。我会根据在页面管理编辑器中添加的顺序在模板上呈现 TextBlocks 和 GalleryContainers。默认的 django-admin 显示如下所示：

![django-admin 显示](../Images/a080c02f8050b533f46cdbd75e5ca4ad.png)

我希望它显示为：

*   画廊容器 1
*   文本块 1
*   画廊容器 2

但我不知道该怎么做。任何朝着正确方向的建议或推动都会有很大帮助。提前致谢。（我也希望我的问题有意义......）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T17:11:59.790

如果您想要列和图库之间的关系，您的模型应该反映这一点。所以如果我理解正确：一个页面有名称和列。列具有文本、图库（可选）和排序。

模型.py：

```
class Page(models.Model):
   name = models.CharField(max_length=200)

class Gallery(models.Model):
   name = models.CharField(max_length=200)

class Column(models.Model):
   page = models.ForeignKey(Page)
   text = models.TextField()
   gallery = models.ForeignKey(Gallery, null=True, blank=True) # Optional
   ordering = models.IntegerField()

   class Meta:
       ordering = ('ordering', ) 
```

此示例显示了如何通过 IntegerField 进行排序。如果您想根据添加的时间对列进行排序，请替换

```
ordering = models.IntegerField() 
```

和

```
models.datetimeField(auto_now_add=True) 
```

在您的 admin.py 中：

```
class ColumnInline(admin.TabularInline): # or StackedInline
    model = Column

class PageAdmin(admin.ModelAdmin):
    inlines = [
        ColumnInline,
    ] 
```

注意：我将您的“画廊显示名称”作为“名称”放在画廊中。为画廊命名一次更有意义。但是，如果一个画廊位于更多不同名称的地方，那么您需要在 Column 模型上使用一个字段（例如，'gallery_display_name=models.CharField(max_lenght=200)'）。

这是你问题的答案吗？我希望它有帮助！

# python - 在python中截断字符串

> ID：10034377
> 
> 赞同：29
> 
> 时间：2012-04-05T18:57:48.527
> 
> 标签：python, truncate

有人给了我一个截断字符串的语法，如下所示：

```
string = "My Text String"

print string [0:3] # This is just an example 
```

我不确定这叫什么（字符串 [0:3] 语法），所以我很难在互联网上查找它并了解它是如何工作的。到目前为止，我认为它是这样工作的：

*   string[0:3] # 返回字符串的前 3 个字符
*   string[0:-3] # 将返回字符串的最后 3 个字符
*   string[3:-3] # 似乎截断了前 3 个字符和后 3 个字符
*   string[1:0] # 我返回 2 个单引号....不确定这是在做什么
*   string[-1:1] # 和上一个一样

无论如何，我可能还可以添加一些其他示例，但我的观点是我是这个功能的新手，我想知道它叫什么以及在哪里可以找到更多信息。我确定我只是在某处缺少一个很好的参考。

感谢您的任何建议，迈克

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-05T19:00:20.593

它被称为*切片*。来自 Common Sequence Operations 下的 python 文档：

> **s[i:j]**
> 
> 从 i 到 j 的 s 切片被定义为具有索引 k 的项目序列，使得 i <= k < j。如果 i 或 j 大于 len(s)，则使用 len(s)。如果 i 被省略或 None，使用 0。如果 j 被省略或 None，使用 len(s)。如果 i 大于或等于 j，则切片为空。

[来源](http://docs.python.org/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-05T19:34:35.233

正如@Uku 和@thebjorn 所说，它被称为[切片](http://docs.python.org/tutorial/introduction.html#strings)

但是一种更简单的思考方法是将 String 视为列表，例如，您可以这样做：

```
text = 'Any String'
for letter in text:
    print letter 
```

如果您想在字符串中获取特定字母，则相同：

```
>> text = 'Any String'
>> text[4]
'S' 
```

ps.：记住它是从零开始的，所以 text[4] 返回第 5 个字母。

使用 Slice，它将从原始字符串返回一个“子字符串”文本 [i:j]，其中“i”是初始索引（包括），“j”是结束索引（不包括），例如：

```
>> text = 'Any String'
>> text[4:6] # from index 4 to 6 exclusive, so it returns letters from index 4 and 5
'St'
>> text[0:4]
'Any '
>> text[:4] # omiting the "i" index means i = 0
'Any '
>> text[4:] # omitting the "j" index means until the end of the string 
```

负索引相对于字符串的结尾，就像从负索引替换为“len(text) + i”一样。

在我们的例子中 len(text) 是 10，负索引 -1 就像使用 text[9] 获取最后一个元素，-2 将返回最后一个元素，依此类推。

在您发送的示例中， string[0:-3] 应该返回除最后 3 个字符之外的所有内容，而 string[3:-3] 应该返回除前 3 个和后 3 个字符之外的所有内容。

希望它有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T19:02:40.123

它被称为切片，阅读更多关于它的信息，例如：http: [//docs.python.org/tutorial/introduction.html#strings](http://docs.python.org/tutorial/introduction.html#strings)

# c++ - C++中需要什么引用

> ID：10034384
> 
> 赞同：0
> 
> 时间：2012-04-05T18:58:06.877
> 
> 标签：c++

今天有人问我这个问题。在 C++ 中需要引用什么，为什么在 C++ 中`Bjarne Stroustrup`考虑`reference`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T19:05:10.007

这是 Stroustrup 的解释：[http ://www2.research.att.com/~bs/bs_faq2.html#pointers-and-references](http://www2.research.att.com/~bs/bs_faq2.html#pointers-and-references)

> C++ 继承了 C 的指针，因此我无法删除它们而不会导致严重的兼容性问题。引用对一些事情很有用，但我在 C++ 中引入它们的直接原因是支持运算符重载。

这是一个例子：

```
void f1(const complex* x, const complex* y) // without references
{
    complex z = *x+*y;  // ugly
    // ...
}

void f2(const complex& x, const complex& y) // with references
{
    complex z = x+y;    // better
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:04:07.843

如果您想知道此类问题的答案，请阅读他本人写的一本名为《C++ 的设计与演变》的书：

[http://www2.research.att.com/~bs/dne.html](http://www2.research.att.com/~bs/dne.html)

或者，请参阅此处，他在其中详细解释了答案：

[http://www2.research.att.com/~bs/bs_faq2.html#pointers-and-references](http://www2.research.att.com/~bs/bs_faq2.html#pointers-and-references)

去引用：

> C++ 继承了 C 的指针，因此我无法删除它们而不会导致严重的兼容性问题。引用对一些事情很有用，但我在 C++ 中引入它们的直接原因是支持运算符重载。例如：

```
void f1(const complex* x, const complex* y) // without references
{
    complex z = *x+*y;  // ugly
    // ...
}

void f2(const complex& x, const complex& y) // with references
{
    complex z = x+y;    // better
    // ...
} 
```

# asp.net-mvc-3 - 使用 PetaPoco MVC3 进行高效分页

> ID：10034388
> 
> 赞同：1
> 
> 时间：2012-04-05T18:58:12.710
> 
> 标签：asp.net-mvc-3, petapoco

有什么方法可以使用 petapoco 和 mvc3 进行有效的分页。目前我正在提取所有记录，这当然不是一个完美的方法。

使用 LINQ skip() take() 非常容易。

注意：这将在拍卖门户中实施，并且数据库将非常庞大。

请高手指点一下。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:05:33.967

[文档](http://www.toptensoftware.com/Articles/74/PetaPoco-Paged-Queries)中有一个如何进行分页查询的示例。这是[新的 API](http://www.toptensoftware.com/Articles/89/Some-Minor-PetaPoco-Improvements)。

# sql-server - 全表扫描是否读取所有列（对于每一行）？

> ID：10034391
> 
> 赞同：3
> 
> 时间：2012-04-05T18:58:28.607
> 
> 标签：sql-server, oracle

假设我有一个包含 3 列的表 - 名字、中间名、姓氏 - 按此顺序.. 也没有索引，所有字段都是 varchar。

如果我进行全表扫描以确定表中是否存在给定的名字。Oracle（或 MSSQL）是否也必须通读所有其他列？（或者是否足够聪明地跳过它们？）。

如果我搜索的是第二列而不是第一列呢？必须阅读第一列吗？如果第一列是具有接近 2000 字节数据的 varchar 呢？..是否必须读取所有字节，还是会以某种方式跳过它们？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T19:09:27.260

对于程序员来说，“读取”的定义可能是“将查看内存地址并读取每个字节”，但对于数据库，这个定义是不正确的。在数据库中，“读取”意味着“访问磁盘并获取内存中的数据”。由于 Oracle 和 SQL Server 都是面向页面的行存储，因此是的，所有列都将被“读取”。[一旦考虑行外存储](http://technet.microsoft.com/en-us/library/ms189087.aspx)等，事情就会变得复杂，如果考虑[缓冲池](http://en.wikipedia.org/wiki/Cache_%28computing%29)，事情就会变得非常混乱。但是对于那个级别的细节，您需要更详细地表达问题（您想要实现什么以及您为什么要问？）并且您还需要非常详细地了解存储格式。

附带说明一下，SQL Server 和 Oracle 都支持[列存储](http://en.wikipedia.org/wiki/Column-oriented_DBMS)格式，该格式明确设计用于以面向列的方式读取（即不读取不需要的列），但这不太可能是您想要的，并且列存储是一种非常，非常，特例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T19:02:17.510

数据页中的所有数据都会被读取，除非它没有被查询和越界存储。当 varchar(max) 列超过 8k 数据时，它将在一组新页面中继续。未查询该字段时不会读取这些页面。

# gwt - GWT dygraph 未显示（折叠在左上角）

> ID：10034401
> 
> 赞同：0
> 
> 时间：2012-04-05T18:59:20.870
> 
> 标签：gwt, resize, google-visualization, dygraphs

我正在尝试在 GWT 应用程序中创建一个 dygraph（使用 gviz）。dygraph 在左上角显示为折叠图表。我可以看到那个角落的滑块。如果我调整浏览器窗口的大小，图表会按预期显示。

我想过调用 chart.resize(width,height) 但得到一个错误 chart has no method resize。

任何想法如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T22:04:00.943

当您使用 GViz 时，您很可能使用的是包装器，而不是真正的 dygraph 对象。

“chart.date_graph.resize(width, height)”对你有用吗？

# excel - 通过检查EOF读取excel表中的整个单元格

> ID：10034402
> 
> 赞同：1
> 
> 时间：2012-04-05T18:59:27.827
> 
> 标签：excel, ms-access, vba

如何通过仅检查 EOF 来读取 excel 工作表（整个单元格）而不指定任何列范围，而不是使用 VBA 将所有结果动态放入 MS Access。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:15:07.427

您可以使用类`Cells`的属性`Worksheet`并进行迭代，直到找到您选择的 EOT 条件，例如。空单元格。

像这样的东西：

```
Dim w As Worksheet: Set w = ActiveSheet
Dim r As Long: r = 1
Dim vSQL As String

Do While w.Cells(r, 1).Text <> ""
    vSQL = "INSERT INTO MyTable1(Col1) VALUES(" & w.Cells(r,1).Text & ")" 
    yourFavoriteMethodToInvokeSQL vSQL

    r = r + 1
Loop 
```

# android - Osmdroid 离线模式在缩放后更新图块

> ID：10034404
> 
> 赞同：2
> 
> 时间：2012-04-05T18:59:50.197
> 
> 标签：android, osmdroid, android-mapview

我正在开发一个使用 Osmdroid 以离线模式显示地图的 Android 应用程序。当我想通过在地图上捏合或使用内置缩放控件来放大或缩小时，我遇到了问题。当我放大地图图块时，并不总是正确渲染，当我缩小地图时有时地图中有一些灰色图块，有时一切都可以渲染。它与地图上显示的位置无关。我的地图图块存储在 osmdroid zip 文件中，Mapnik 源位于 /mnt/sdcard/osmdroid 文件夹中。我正在使用 osmdroid-3.0.7。

因此，欢迎任何帮助。

请参阅下面的代码（代码中未包含我的包含）：

```
public class MapActivity extends OSMapActivity {

private ArrayList<String[]> mapPointData;
private ArrayList<String[]> multiData;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    super.setContentView(R.layout.map);

    setABTitle(getIntent().getExtras().getStringArray("geoLoc")[0]);
    actionButtonVisible(getIntent().getExtras().getBoolean("routeList"));

    initLayout();
    setHomePoint();
}

@Override
protected void onResume() {
    super.onResume();
    Prefs.clearMapPrefs(this);
}

private void initLayout() {

    c = this;
    // Buttons @ top of the activity
    doseeBN = (ImageView) findViewById(R.id.mapDoseeBN);
    eatdrinkBN = (ImageView) findViewById(R.id.mapEatdrinkBN);
    nightlifeBN = (ImageView) findViewById(R.id.mapNightlifeBN);
    sleepBN = (ImageView) findViewById(R.id.mapSleepBN);

    // The LinearLayout with the ScrollView for the Subcategories in "Do & See"
    doseeLL = (LinearLayout) findViewById(R.id.doseeSubCatLL);
    top10BN = (Button) findViewById(R.id.mapDoseeTop10BN);
    monumentsBN = (Button) findViewById(R.id.mapDoseeMonumentsBN);
    museumBN = (Button) findViewById(R.id.mapDoseeMuseumsBN);
    cultureBN = (Button) findViewById(R.id.mapDoseeCultureBN);
    attractionsBN = (Button) findViewById(R.id.mapDoseeAttractionBN);
    shoppingBN = (Button) findViewById(R.id.mapDoseeShoppingBN);
    marketBN = (Button) findViewById(R.id.mapDoseeMarketBN);

    // Init of the map an mapcontroller
    mapView = (MapView) findViewById(R.id.osmMV);
    mapView.setTileSource(TileSourceFactory.MAPNIK);
    mapController = mapView.getController();
    mapController.setZoom(16);
    mapView.setUseDataConnection(false);

    mapView.setBuiltInZoomControls(true);
    mapView.setMultiTouchControls(true);
   // mapView.setDrawingCacheEnabled(true);

    mapData = new ArrayList<String[]>();
    mapPointData = new ArrayList<String[]>();
    multiData = new ArrayList<String[]>();
}

private void setHomePoint() {
    //GeoPoint centerPt = new GeoPoint(50.89489, 4.34140); // Point of Grand Place Brussels

    homeLat = Double.parseDouble(getIntent().getExtras().getStringArray("geoLoc")[1]);
    homeLong = Double.parseDouble(getIntent().getExtras().getStringArray("geoLoc")[2]);

    GeoPoint centerPt = new GeoPoint(homeLat, homeLong);

    if (checkMapRange(Double.parseDouble(getIntent().getExtras().getStringArray("geoLoc")[1]), 
            Double.parseDouble(getIntent().getExtras().getStringArray("geoLoc")[2]))) {
        mapController.setCenter(centerPt);

        Drawable marker = getResources().getDrawable(R.drawable.ic_pin_marker);

        ArrayList<OverlayItem> items = new ArrayList<OverlayItem>();
        items.add(new OverlayItem("Here I am!", "Hello", centerPt));
        ItemizedOverlay<OverlayItem> itemOverlay = 
                                new ItemizedIconOverlay<OverlayItem>(items, marker, null, new DefaultResourceProxyImpl(this));
        mapView.getOverlays().add(itemOverlay);
        mapView.invalidate();
    } else {
        mapController.setCenter(new GeoPoint(50.89489, 4.34140));
        mapController.setZoom(11);
        Action.alert(this, getResources().getString(R.string.alert_title_notinregion), 
                getResources().getString(R.string.alert_message_notinregion), false);
        mapView.setClickable(false);
    }
}

public void onClickMapPointsBN(View v) {

    switch(v.getId()) {
    case R.id.mapDoseeBN:
        setPrefsCategory("DOSEE", doseeBN, "btn_map_dosee", "btn_map_dosee_pressed");
        break;
    case R.id.mapEatdrinkBN:
        setPrefsCategory("EATDRINK", eatdrinkBN, "btn_map_eatdrink", "btn_map_eatdrink_pressed");
        break;
    case R.id.mapNightlifeBN:
        setPrefsCategory("NIGHTLIFE", nightlifeBN, "btn_map_nightlife", "btn_map_nightlife_pressed");
        break;
    case R.id.mapSleepBN:
        setPrefsCategory("SLEEP", sleepBN, "btn_map_sleep", "btn_map_sleep_pressed");
        break;
    }

    setPOIs();
}

public void onClickDoseeListBN(View v) {
    switch (v.getId()) {
    case R.id.mapDoseeTop10BN:
        setDosseSubCat(Definitions.doseeList[0], top10BN);
        break;
    case R.id.mapDoseeMuseumsBN:
        setDosseSubCat(Definitions.doseeList[2], museumBN);
        break;
    case R.id.mapDoseeCultureBN:
        setDosseSubCat(Definitions.doseeList[3], cultureBN);
        break;
    case R.id.mapDoseeAttractionBN:
        setDosseSubCat(Definitions.doseeList[4], attractionsBN);
        break;
    case R.id.mapDoseeShoppingBN:
        setDosseSubCat(Definitions.doseeList[5], shoppingBN);
        break;
    case R.id.mapDoseeMarketBN:
        setDosseSubCat(Definitions.doseeList[6], marketBN);
        break;
    default:
        setDosseSubCat(Definitions.doseeList[1], monumentsBN);
        break;
    }

    setPOIs();
}

private void setPrefsCategory(String cat, ImageView btn, String image, String imageSelected) {
    boolean sel = Prefs.getBoolean(this, "map" + cat, false);

    Prefs.setBoolean(this, "map" + cat, !sel);
    setCategoryImage(btn, image, imageSelected, sel);

    if (cat.equalsIgnoreCase("DOSEE")) {
        if (sel) {
            doseeLL.setVisibility(View.GONE);
        } else {
            doseeLL.setVisibility(View.VISIBLE);

            for (String s : Definitions.doseeList) {
                if (s.equals(Definitions.doseeList[1])) {
                    Prefs.setBoolean(this, "mapDS_" + s, true);
                } else {
                    Prefs.setBoolean(this, "mapDS_" + s, false);
                }
            }
        }

        setSubcategoryColor(sel);
    }
}

private void setCategoryImage(ImageView btn, String image, String imageSelected, boolean selected) {
    String devLang = Prefs.getString(this, "devLanguage", "en");

    if (!devLang.equalsIgnoreCase("en")) {
        image += "_" + devLang;
        imageSelected += "_" + devLang;
    }

    if (selected) {
        btn.setImageResource(this.getResources().getIdentifier(image, "drawable", getPackageName()));
    } else {
        btn.setImageResource(this.getResources().getIdentifier(imageSelected, "drawable", getPackageName()));
    }
}

private void setSubcategoryColor(boolean doseeSelected) {
    setDoseeSubCatTextColor(true, top10BN);
    setDoseeSubCatTextColor(doseeSelected, monumentsBN);
    setDoseeSubCatTextColor(true, museumBN);
    setDoseeSubCatTextColor(true, cultureBN);
    setDoseeSubCatTextColor(true, attractionsBN);
    setDoseeSubCatTextColor(true, shoppingBN);
    setDoseeSubCatTextColor(true, marketBN);
}

private void setPOIs() {
    mapView.getOverlays().clear();
    mapView.invalidate();
    mapData.clear();

    setHomePoint();

    boolean selected;

    for (String category : Definitions.categoryList) {
        selected = Prefs.getBoolean(this, "map" + category, false);

        Log.d("VB.Map", "Category: " + category + " selected: " + selected);
        if (selected) {
            if (category.equalsIgnoreCase("DOSEE")) {
                boolean subSelected;

                for (String subcategory : Definitions.doseeList) {
                    subSelected = Prefs.getBoolean(this, "mapDS_" + subcategory, false);

                    if (subSelected) {
                        getSqlData(category, subcategory);
                    }
                }
            } else {
                getSqlData(category, null);
            }
        }
    }

    removeMapDataItems();
    //mapPointData = mapData;
    //multiDataLocationSelector();
    setMapDataPoints();
    //setMultiMapPoints();
}

private void getSqlData(String category, String subCategory) {
    ArrayList<String[]> sqlData = SqlDB.db.getCategoryItems(Adjust.rewriteCategoryName(category), subCategory);

    for (String[] data : sqlData) {
        mapData.add(data);
    }
}

private void removeMapDataItems() {
    for (int i = 0; i < mapData.size(); i++) {
        if ((mapData.get(i)[13].equalsIgnoreCase("")) || (mapData.get(i)[14].equalsIgnoreCase(""))) {
            mapData.remove(i);
            i--;
        }
    }
}

private void setDosseSubCat(String subCat, Button btn) {
    boolean selected = Prefs.getBoolean(this, "mapDS_" + subCat, false);

    Prefs.setBoolean(this, "mapDS_" + subCat, !selected);

    setDoseeSubCatTextColor(selected, btn);
}

private void setDoseeSubCatTextColor(boolean selected, Button btn) {
    if (selected) {
        btn.setTextColor(Definitions.colorDoseeSubcat);
    } else {
        btn.setTextColor(Definitions.colorDoseeSubcatSelected);
    }
}

private void setMapDataPoints() {
    if (mapData != null) {
        ArrayList<OverlayItem> mapOverlays = new ArrayList<OverlayItem>();
        OverlayItem overlayItem;

        for (String[] item : mapData) {
            multiData.add(item);
            if (existsInOverlayItems(item, mapOverlays)) {
                overlayItem = new OverlayItem("-1", "", new GeoPoint(Float.parseFloat(item[13]), Float.parseFloat(item[14])));
                overlayItem.setMarker(getResources().getDrawable(R.drawable.ic_pin_multiple));
            } else {
                overlayItem = new OverlayItem(item[0], "", new GeoPoint(Float.parseFloat(item[13]), Float.parseFloat(item[14])));
                overlayItem.setMarker(getResources().getDrawable(getResources().getIdentifier(item[15], "drawable", getPackageName())));
            }

            mapOverlays.add(overlayItem);
        }

        setMapOverlays(mapOverlays);
    }
}

private boolean existsInOverlayItems(String[] item, ArrayList<OverlayItem> overlayItemList) {
    for (int i = 0; i < overlayItemList.size(); i++) {
        if ((new GeoPoint(Double.parseDouble(item[13]), Double.parseDouble(item[14]))).equals(overlayItemList.get(i).mGeoPoint)) {
            overlayItemList.remove(i);
            return true;
        }
    }

    return false;
}

private void setMapOverlays(ArrayList<OverlayItem> overlays) {  
    ItemizedOverlay<OverlayItem> itemOverlays = new ItemizedIconOverlay<OverlayItem>(
            overlays, getResources().getDrawable(R.drawable.ic_pin_marker), new ItemizedIconOverlay.OnItemGestureListener<OverlayItem>() {

        public boolean onItemLongPress(int arg0, OverlayItem item) {
            mapOverlayItemPressed(Integer.parseInt(item.mTitle), item);
            return false;
        }

        public boolean onItemSingleTapUp(int arg0, OverlayItem item) {
            mapOverlayItemPressed(Integer.parseInt(item.mTitle), item);
            return false;
        }
    }, new DefaultResourceProxyImpl(this));

    mapView.getOverlays().add(itemOverlays);

    mapView.invalidate();
}

private void mapOverlayItemPressed(int itemId, OverlayItem overlayItem) {
    if (itemId == -1) {
        Collect.multiPOIList.clear();

        for (String[] item : multiData) {
            if ((new GeoPoint(Double.parseDouble(item[13]), Double.parseDouble(item[14]))).equals(overlayItem.mGeoPoint)) {
                Collect.multiPOIList.add(item);
            }
        }

        Action.alertWithListView(this, getResources().getString(R.string.alert_title_multiplepoi), false);

    } else {
        SqlDB.db.getItemsById(itemId);

        Bundle b = new Bundle();
        b.putInt("listSelection", 0);

        Action.newIntent(c, DetailActivity.class, b);
    }
}

private boolean checkMapRange(double lat, double lng) {
    double mapLatMax = 50.922085;
    double mapLatMin = 50.781631;
    double mapLongMin = 4.240723;
    double mapLongMax = 4.490662;

    if ((lat > mapLatMin) && (lat < mapLatMax)) {
        if ((lng > mapLongMin) && (lng < mapLongMax)) {
            return true;
        }
    }
    return false;
} 
```

}

这里是 OSMapActivity 的代码：

```
public class OSMapActivity extends ActionbarActivity {

protected Context c;

protected MapView mapView;
protected MapController mapController;
protected ArrayList<String[]> mapData;

protected ImageView doseeBN;
protected ImageView eatdrinkBN;
protected ImageView nightlifeBN;
protected ImageView sleepBN;
protected LinearLayout doseeLL;

protected Button top10BN;
protected Button monumentsBN;
protected Button museumBN;
protected Button cultureBN;
protected Button attractionsBN;
protected Button shoppingBN;
protected Button marketBN;

protected double homeLat;
protected double homeLong;

public void onClickABActionButton(View v) {
    boolean actionButton = Prefs.getBoolean(this, "abActionButtonRoute", false);

    if (actionButton) {
        // TODO Add with current location => location manager in separate class
        /*GPS.init(this);
        GPS.enableGPSProvider();
        GPS.enableNetworkProvider();
        //Action.loadApp(this, Intent.ACTION_VIEW, Uri.parse("geo:50.89489,4.34140?daddr=Heiveld+21+Opwijk"));
        Action.loadApp(this, Intent.ACTION_VIEW, Uri.parse("http://maps.google.com/maps?saddr=" + GPS.latitude + "," + GPS.longitude
                                                            + "&daddr=Heiveld+21+1745+Opwijk"));
        GPS.stop();*/
        Action.loadMapsWithMyLocation(this, homeLat, homeLong);
    } else {
        Collect.dbList.clear();

        for (String[] data : mapData) {
            Collect.dbList.add(data);
        }

        // TODO Load new intent with list
        Action.newIntent(this, MapListActivity.class, null);

    }
} 
```

}

谢谢你的帮助。

氪

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:51:51.360

我在 3.0.6 版上提出了一个关于此的[问题。](http://code.google.com/p/osmdroid/issues/detail?id=289&can=1&sort=-id)在评论中，作者说它是在 2 月 1 日修复的。由于 3.0.7 jar 的日期为 1 月 29 日，我认为修复程序不在其中。我现在坚持使用 3.0.5 版本，虽然循环地图在其中不起作用，并且瓷砖加载可能有点闪烁。但是，如果您的地图处于离线状态，它们应该会加载得非常快，并且闪烁可能不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T07:37:13.390

我不是 100% 确定这是否与此处报告的问题相同：

[OSMDroid 谷歌群组](https://groups.google.com/group/osmdroid/browse_frm/thread/c5e3a8ddff041350?hl=en)

如果是这样，那么解决方案（目前）似乎是下载当前的 OSMDroid 源代码并构建您自己的 .jar 库。无需更改源，但瓷砖加载问题已修复。

# c++ - 如何使用 C++ 或 C 在大文件中查找特殊值

> ID：10034409
> 
> 赞同：1
> 
> 时间：2012-04-05T19:00:00.197
> 
> 标签：c++, c, algorithm, file

我想使用 C++ 或 C 在大型（> 500 MB）文本文件中找到一些值。我知道可能的匹配值只能存在于每行的开头，并且它的长度正好是十个字符。好的，我可以逐行读取整个文件，使用 substr() 搜索值或使用正则表达式，但这有点难看而且非常慢。我考虑使用嵌入式数据库（例如 Berkeley DB），但我要搜索的文件是非常动态的，每次都将其导入数据库时​​遇到问题。由于内存的限制，无法一次将整个文件加载到内存中。提前谢谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:08:56.810

这似乎不太适合 C/C++。由于问题的定义需要解析整行文本，并在前 10 个字符上执行模式匹配，因此解释的东西，如 python 或 perl 似乎更简单。

怎么样：

```
import os
pattern ='0123456789'   # <-- replace with pattern

with open('myfile.txt') as f:
    for line in f:
        if line.startswith(pattern):
            print "Eureka!' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T19:05:47.273

我看不出你将如何比使用 stdio 库更快地做到这一点，将每一行依次读入缓冲区，然后使用,`strchr`或类似的东西。鉴于您对问题的描述，这已经是相当理想的了。没有什么魔法可以避免逐行遍历文件以查找您的模式。`strcmp``strncmp`

也就是说，如果您在行首处理正好十个字符的固定模式，那么这里几乎肯定不需要正则表达式——*这*会不必要地慢，而且我不会使用正则表达式库。

如果你真的，真的需要在最后几微秒内完成，并且模式实际上是恒定的并且在一行的开头，你可能可以`memchr`在读入缓冲区中查找 "\npattern" 或一些这样的（也就是说，在您的搜索中包括换行符），但您听起来好像模式不是完全恒定的。假设它不是完全恒定的，最明显的方法（见第一段）是最明显的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:43:50.850

如果您要查找大量值，那么您想使用[Aho-Corasick](http://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_string_matching_algorithm)。该算法允许您创建一个单一的有限状态机，它可以同时搜索集合中任何字符串的所有出现。这意味着您可以一次搜索文件并找到您要查找的每个值的所有匹配项。上面的维基百科链接有一个 Aho-Corasick 的 C 实现的链接。如果您想查看我编写的 Go 实现，可以查看[此处](https://github.com/runningwild/stringz/blob/master/core/aho_corasick.go)。

如果您正在寻找单个或很少数量的值，那么您最好使用[Boyer-Moore](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)。尽管在这种情况下您可能只想使用 grep，它可能与您为此应用程序编写的任何内容一样快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:14:32.433

在搜索之前使用内存映射文件怎么样？

[http://beej.us/guide/bgipc/output/html/multipage/mmap.html](http://beej.us/guide/bgipc/output/html/multipage/mmap.html)

一种方法可能是加载和搜索内存中的第一个 64 MB，卸载它然后加载下一个 64 MB，依此类推（以 4 KB 的倍数，这样您就不会忽略任何可能在块边界处拆分的文本）

还可以查看 Boyer Moore 字符串搜索

[http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm](http://en.wikipedia.org/wiki/Boyer%E2%80%93Moore_string_search_algorithm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T19:28:01.843

是的，这可以快速完成。到过那里。做到了。但是，很容易引入错误。

诀窍在于管理缓冲区的末尾，因为您将读取一个充满数据的缓冲区，搜索该缓冲区，然后继续下一个。由于该模式可能跨越两个缓冲区之间的边界，因此您最终会编写大部分代码来涵盖这种情况。

无论如何，在边界情况之外，您有一个如下所示的循环：

```
unsigned short *p = buffer;
while( (p < EOB) && ( patterns[*p] ) ) ++p; 
```

这假设 EOB 已被适当地初始化，并且 patterns[] 是一个包含 65536 个值的数组，如果您不能位于模式的开头，则为 0，如果可以，则为 1。

根据您的 CR/LF 和字节顺序约定，设置为 1 的模式可能包括 \nx 或 \rx，其中 x 是 10 个字符模式中的第一个字符。或者 x\n 或 x\r 用于其他字节顺序。如果您不知道字节顺序或约定，您可以包括所有四个。

一旦有了候选位置（EOL 后跟第一个字节），您就可以检查剩余的 9 个字节。构建模式数组是提前离线完成的。两个字节模式适合一个足够小的数组，这样您在进行索引时不会有太多的内存抖动，但是您可以像使用单字节一样快两倍地压缩数据。

您可以在其中添加一个疯狂的优化，那就是在缓冲区的末尾写一个标记，并将其放入您的模式数组中。但是那个哨兵必须是不能出现在文件中的东西。不过，它将循环缩减为一项测试、一项查找和一项增量。

# javascript - 在带有触摸屏的 Windows 上禁用屏幕调整大小

> ID：10034411
> 
> 赞同：2
> 
> 时间：2012-04-05T19:00:03.130
> 
> 标签：javascript, html, google-chrome, multi-touch

我正在开发一个类似演示文稿的本地站点（将是本地的，显示在多个屏幕上，仅此而已），我选择在 chrome 上开发（你知道，对所有整洁的东西的支持都很棒）。Chrome 将在 Windows 7（或者可能是 8，谁知道呢？）之上以全屏窗口的形式运行

该应用程序/网站将可通过多点触摸屏进行操作。

**然而！**

由于屏幕是多点触控的，因此在捏合时所有内容都会放大/缩小。有办法禁用这个吗？（即使有一个单独的应用程序可以在后台运行，不知道）。另外，我希望以后能够在应用程序中使用多点触控，但在自定义的东西上，而不是在屏幕调整大小上......

顺便说一句，我尝试了我在 iphone 应用程序上使用的技巧：

```
document.addEventListener('mousemove', function(e){ e.preventDefault(); }, false); 
```

和：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> 
```

但它似乎不起作用。

Sooo...有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:49:30.307

我正在做一个类似的项目（基于浏览器的多点触摸屏数字信息亭）并遇到了同样的问题。

由于我没有在 Chrome 中找到解决方法，我正在切换到 Firefox。您可以通过导航到“about:config”并将 browser.gesture.pinch.in 和 browser.gesture.pinch.out 的值更改为“”来禁用 Firefox 中的捏缩放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-12T11:02:54.557

目前最好的解决方案（直到谷歌更新 chrome，如果他们愿意的话）是在你的触摸屏/鼠标/触摸板设置中禁用手势。控制面板->鼠标->设备设置->（选择设备）->设置->禁用捏缩放。

# c# - 首先使用带有实体代码的自然键

> ID：10034425
> 
> 赞同：0
> 
> 时间：2012-04-05T19:00:52.760
> 
> 标签：c#, entity-framework-4.1, ef-code-first

所以，我正在使用实体框架，现在需要如何设置我自己的主键。

我使用 [Key] 数据注释，但是当我坚持实体时，即使我之前设置了该属性，该字段也会自动生成。

任何的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:12:02.230

我相信在您的 [Key] 属性中，您需要指定 DatabaseGeneratedOption 如下：

```
[Key, DatabaseGenerated(DataBaseGeneratedOption.None)] 
```

# java - Android 应用程序未显示在“所有应用程序”中

> ID：10034426
> 
> 赞同：0
> 
> 时间：2012-04-05T19:01:12.010
> 
> 标签：java, android, android-manifest

在我对我的应用程序进行了一些更改后，它会以不同的顺序显示活动，应用程序图标不再出现在 android 设备上的“所有应用程序”屏幕中。但是，它确实显示在“最近”屏幕上。我认为这与我的清单文件中的配置错误有关。我希望 ServerChoiceActivity 是图标所代表的那个，它是从最近的屏幕启动它时启动的，但是“所有应用程序”或“已下载”页面上没有图标的事实让我很困惑.

我的清单文件的应用程序部分：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" android:debuggable="true">
    <activity android:name=".ServerChoiceActivity"
        android:screenOrientation="portrait">
        <intent-filter>
            <action android:name="android.intent.action.MAIN"/>
            <category android:name="android.intent.category.LAUNCHER"/>
            <data android:mimeType="image/*"/>
            <category android:name="android.intent.category.DEFAULT"/>
        </intent-filter>
    </activity>
    <activity android:name=".ServerSettingsActivity" android:screenOrientation="portrait" android:label="@string/settings_title">
        <intent-filter>

        </intent-filter>
    </activity>
    <activity
        android:name=".ImageShareActivity"
        android:label="@string/app_name"
        android:screenOrientation="portrait">
        <intent-filter>
            <action android:name="android.intent.action.SEND"/>
            <data android:mimeType="image/*"/>
        </intent-filter>
    </activity>
    <activity
        android:screenOrientation="portrait"
        android:name=".MultiImageUploadActivity"
        android:taskAffinity="test.affinity"
        android:label="@string/multiupload_title">
        <intent-filter>

        </intent-filter>
    </activity>
    <activity 
        android:screenOrientation="portrait" 
        android:taskAffinity="test.affinity"
        android:noHistory="true"
        android:label="Bucket"
        android:name=".BucketActivity">
        <intent-filter>

        </intent-filter>
    </activity>
</application> 
```

有什么建议么？该应用程序在我启动时按预期工作，并且工作正常，包括在我修改清单文件之前显示图标。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:31:24.887

可能是因为你的`ServerChoiceActivity`意图过滤器中有这个：

```
<data android:mimeType="image/*"/> 
```

# c# - 如何从以下 C# 代码更改集合中的名称？

> ID：10034428
> 
> 赞同：1
> 
> 时间：2012-04-05T19:01:22.193
> 
> 标签：c#

我有以下代码，它将返回所有当前学期。如何识别集合中是否有“Summer”学期并动态替换为“Summer I”？

```
return activeSemester.Select(c => new ActiveSemester
        {
            id = c.SemesterId,
            name = c.Name, // Here I want to check if it is Summer               
        }).ToList(); 
```

**更新：** 夏季学期有 3 个夏季名称，但日期不同。我只想按顺序命名。每个人都有唯一的 SemesterId。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T19:02:27.387

```
return activeSemester.Select(c => new ActiveSemester
{
    id = c.SemesterId,
    name = c.Name == "Summer" ? "Summer I" : c.Name
}).ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T20:02:59.887

所以你可以准确地解释你的 3 个不同的夏季课程，我认为有条件的方法会更有意义。如果您实现任何类型的递增方法并将未正确排序的数据传递给此方法，则可以将日期或学期 id 匹配时标记`ActiveSemster`为`"Summer I"``"Summer II"`

您可以将条件直接包含在 LINQ 查询中，也可以创建一个方法来根据日期或学期 id 识别夏季

```
return activeSemester.Select(c => new ActiveSemester
{
    id = c.SemesterId,
    name = c.Name == "Summer" ? GetSummmer(c.StartDate, c.EndDate) : c.Name
}).ToList(); 
```

* * *

```
private string GetSummer(DateTime startDate, DateTime endDate)
{
    if (startDate == summer1Start || endDate == summer1End)
        return "Summer I";
    if (startDate == summer2Start || endDate == summer2End)
        return "Summer II";
    if (startDate == summer3Start || endDate == summer3End)
        return "Summer III";

    return "Unknown Summer";
}

private string GetSummer(Integer semesterId)
{
    if (semesterId == summer1Id)
        return "Summer I";
    if (semesterId == summer2Id)
        return "Summer II";
    if (semesterId == summer3Id)
        return "Summer III";

    return "Unknown Summer";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:03:29.257

```
return activeSemester.Select(c => new ActiveSemester
        {
            id = c.SemesterId,
            name = c.Name.Replace("Summer", "Summer I") // Here I want to check if it is Summer               
        }).ToList(); 
```

当我在它的时候：你为什么要调用 .ToList()？这几乎总是错误的，通常使用 IEnumerable<T> 而不是 IList<T> 或 List<T> 更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T21:02:44.553

对于为任何学期分配任何学期编号的通用解决方案，您可以通过按学期开始日期进行排序来执行以下操作。这样您就不必依赖日期或 ID 的相等。不像 psubsee2003 答案那样优雅或执行。`ConvertToRomanNumeral`可以通过搜索SO来实现。

```
public IEnumerable<ActiveSemester> GetActiveSemesters()
{
  int summerSemesterNumber = 1;
  int winterSemesterNumber = 1;
  foreach (ActiveSemester activeSemester in _activeSemesters.OrderBy(c => c.StartDate))
  {
    if (activeSemester.Name == "Summer")
    {                        
      yield return new ActiveSemester(activeSemester)
                       {
                         Name = string.Format("{0} {1}", activeSemester.Name,  
                           ConvertToRomanNumeral(summerSemesterNumber++))
                       };
    }
    else if (activeSemester.Name == "Winter")
    {                        
      yield return new ActiveSemester(activeSemester)
                       {
                         Name = string.Format("{0} {1}", activeSemester.Name,
                           ConvertToRomanNumeral(winterSemesterNumber++))
                       };
    }
    else
    {
      yield return new ActiveSemester(activeSemester);
    }
  }
} 
```

# android - Android：使用 LayoutInflater.inflate 将自定义参数传递给构造函数

> ID：10034430
> 
> 赞同：3
> 
> 时间：2012-04-05T19:01:26.363
> 
> 标签：android, custom-component, layout-inflater

这一直困扰着我一段时间，我的搜索都没有产生结果。如果我有一个自定义的 GUI 元素，我可以像使用普通组件一样使用 LayoutInflater 对其进行充气。通货膨胀调用导致调用我的自定义 GUI 元素的构造函数，一切都很好。

但是，如果我想在元素的构造函数中添加自定义参数怎么办？有没有办法可以在使用 LayoutInflater 时传递这个参数？

例如：

在主 xml 中，我的布局有一个支架：

```
<LinearLayout
    android:id="@+id/myFrameLayoutHolder"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >
</LinearLayout> 
```

和一个 MyFrameLayout.xml 文件：

```
 <com.example.MyFrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/MyFLayout"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_weight="1 >
    <!-- Cool custom stuff -->
 </com.example.MyFrameLayout> 
```

和一个充气电话：

```
LayoutInflater MyInflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
LinearLayout myFLayoutHolder = (LinearLayout) findViewById(R.id.myFrameLayoutHolder);

MyFrameLayout L = ((MyFrameLayout) MyInflater.inflate(R.layout.MyFLayout, myFLayoutHolder, false));
myFLayoutHolder.addView(L); 
```

如果在扩展 FrameLayout 的类中，我向构造函数添加了一个参数，我会崩溃：

```
public class MyFrameLayout extends FrameLayout {
    private int myInt;

    public MyFrameLayout(Context context) {
        this(context, null);
    }

    public MyFrameLayout(Context context, AttributeSet attrs) {
        this(context, attrs, 0, 0);
    }

    public MyFrameLayout(Context context, AttributeSet attrs, int defStyle, int myParameter) {
        super(context, attrs, defStyle);
        myInt = myParameter;
        //Amazing feats of initialization
    }
} 
```

现在，通过定义我在布局膨胀后立即调用的自定义 init 方法来解决这个问题很容易，但这对我来说似乎很笨拙。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:01:22.197

您不能使用自己的参数定义构造函数，因为您的构造函数签名与 FrameLayout 自己的构造函数签名冲突，并且您不是在调用`super(context, attrs, defStyle);`，而是在调用`super(context, attrs);`此构造函数不完整的构造函数。

您必须完全按原样定义所有三个本机构造函数：

```
FrameLayout(Context context)
FrameLayout(Context context, AttributeSet attrs)
FrameLayout(Context context, AttributeSet attrs, int defStyle) 
```

您可以做的是在 xml 中使用您自己的（自定义）属性，然后在 MyFrameLayout 的**attrs**对象中检索它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T20:00:03.413

如果自定义组件是通过 XML 文件或 inflate 方法膨胀的。您不要在构造中传递元素，因为这在 android 中不受支持。

# javascript - SECURITY_ERR：在两个站点上应用 document.domain 时出现 DOM 异常 18。我该如何解决这个问题？

> ID：10034431
> 
> 赞同：6
> 
> 时间：2012-04-05T19:01:26.700
> 
> 标签：javascript, cross-domain, user-agent, same-origin-policy, domexception

我在内部服务器上有一个页面 server1.mydomain.com/page.jsp，在另一个内部服务器上有另一个页面 10.xxx:8081/page.aspx。

在 server1.mydomain.com 上，我在 page.jsp 中设置 document.domain，如下所示：

```
//page.jsp on server1.mydomain.com
document.domain = document.domain; 
```

当我在 document.domain 上发出警报时，它显示为 server1.mydomain.com。

在 10.xxx 服务器上，我在 page.aspx 中设置了 document.domain，结果是这样的：

```
//page.aspx on 10.x.x.x
document.domain = "server1.mydomain.com";
// test if same-origin policy violation occurs
document.getElementById("div_el").innerHTML = window.top.location.href; 
```

在 Safari 5.1.5 中，控制台上会弹出一个错误：

```
SECURITY_ERR: DOM Exception 18: An attempt was made to break through the security policy of the user agent." 
```

据我了解，当您设置 document.domain 时，端口号设置为 null；所以，你必须在两端设置它，我做了。然后，发生了这个错误，我在摸索为什么。这与我使用 10.xxx 而不是实际域名有关吗？

谢谢你。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T19:09:57.773

您只能用于`document.domain`从更具体的子域更改为不太具体的域。像...

```
console.log(document.domain); // server1.mydomain.com

document.domain = 'mydomain.com'

console.log(document.domain); // mydomain.com 
```

它不能用于设置更具体的子域或完全不同的域。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:09:23.107

您只能设置`document.domain`为其当前值或当前设置的超域。因此，“foo.something.com”的页面可以将其设置为“something.com”，但不能设置为“something.else.com”。

# sql - Visual basic / sql - 无法转换类型

> ID：10034434
> 
> 赞同：0
> 
> 时间：2012-04-05T19:01:35.530
> 
> 标签：sql, vb.net

尝试从表中选择一些记录时遇到此错误消息。

我的脑子现在被枪杀了..有什么想法吗？谢谢！

我的读者是，

```
Public myReader As SqlCeDataReader
Dim currentMatch(1) As String

cmd.CommandText = "SELECT schoolid,opponent " & _
                  "FROM TEAM_SCHEDULE WHERE seasonid = " & i & _
                  " AND gameid = " & 1 & " ORDER BY id"
myReader = cmd.ExecuteReader()
Do While myReader.Read()
    currentMatch(0) = myReader.GetString(0)
    currentMatch(1) = myReader.GetString(1)
Loop 
```

![错误](../Images/b015dbaa8707138e5ac8228cd866319b.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:04:16.483

有根据的猜测：

`schoolid`被定义为`INT`，但由于某种原因，您使用`GetString`而不是`GetInt32`获取它。

```
Do While myReader.Read()
    currentMatch(0) = myReader.GetInt32(0).ToString()
    currentMatch(1) = myReader.GetString(1)
Loop 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T09:30:01.183

为什么不使用数据表？

```
 Public myReader As SqlCeDataReader
 Dim currentMatch(1) As String

 cmd.CommandText = "SELECT schoolid,opponent " & _
              "FROM TEAM_SCHEDULE WHERE seasonid = " & i & _
              " AND gameid = " & 1 & " ORDER BY id"
 Dim dt as new DataTable 

 dt.load(cmd.ExecuteReader()) 
```

如果需要，可以使用 linq 查询结果数据表

```
 dim QueryResults = from p as datarow in dt.rows where p.seasonid<10 select p 
```

或选择一个列表

```
 dim MyObjList = (from p as datarow in dt.rows select seasonid = p.seasonid,  gameid = p.gameid).ToList 
```

# php - 使用 PHP/ASP.net 编辑 AD 帐户并具有无缝身份验证

> ID：10034435
> 
> 赞同：0
> 
> 时间：2012-04-05T19:01:40.760
> 
> 标签：php, iis, authentication, active-directory

我有点熟悉如何在企业网络中使用 IIS 在 PHP/ASP.net 应用程序中设置无缝身份验证，但我有一个问题，到目前为止我一直在努力寻找答案。

在禁用匿名身份验证并启用 Windows 身份验证（即设置了无缝身份验证）的情况下，具有在 Active Directory 中添加/修改用户（到同一个“容器”中）功能的 PHP/ASP.net 脚本将只适用于具有正确的管理员权限，即在 php 中使用 just `ldap_bind($conn);`，还是必须强制用户提供登录凭据才能在`ldap_bind()`函数中使用？

请理解我对AD的了解和理解有限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T10:00:36.610

通常，LDAP 请求在连接具有特定*授权状态*的连接上传输，LDAP 客户端检查来自服务器的响应以获取成功或失败的指示。`bind`成功的请求会更改连接的授权状态。

因此，成功的请求取决于连接的授权状态。适当保护的 LDAP 服务器应要求应用程序`bind`（以更改连接的授权状态）以使某些请求（例如`add`and `modify`, `search and`compare`）成功。

# c# - 等价于 sql 的 Linq 查询

> ID：10034438
> 
> 赞同：1
> 
> 时间：2012-04-05T19:01:53.347
> 
> 标签：c#, linq, linq-to-sql, linq-to-entities

我在 Linq 中有这段代码。任何人都可以提供 t-sql。谢谢！

```
var tsr = from t in db.Tngs
from l in t.TngUsr
from td in t.TngDepts
from u in db.Users
where t.TId == tId && u.UserId == l.UserId && u.Departments.DeptId == td.Departments.DeptId 
```

从左外数第二个/第三个是？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T19:05:55.793

尝试在[LinqPad](https://www.linqpad.net/)中运行它。它将显示您的 linq 代码的 T-SQL 等效项。它甚至会将该 linq 表达式转换为等效的 Lambda 表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:09:25.650

看起来是这样的：

```
SELECT t, l, td, u
FROM Tngs
JOIN TngUser ON TngUser.UserID = Users.UserID
JOIN Users ON Users.UserID = TngUser.UserID
JOIN Departments ON DepartmentID = tngDepartmentID
WHERE Tngs.TId = tId 
```

# java - JNLP 从相对地址加载 jar

> ID：10034441
> 
> 赞同：0
> 
> 时间：2012-04-05T19:01:59.497
> 
> 标签：java, jakarta-ee, jnlp, java-web-start

```
<?xml version="1.0" encoding="UTF-8"?>
<jnlp spec="1.0+"
        codebase="**http://10.177.213.120:8080/Sample/**" href="sample-webstart.jnlp">
    <information>
        <title>Sample Screen</title>
        <vendor>John Doe</vendor>
    </information>
    <resources>
        <!-- Application Resources -->
        <j2se version="1.6+"
              href="http://java.sun.com/products/autodl/j2se"/>
        <jar href="Sample.jar" main="true" />

    </resources>

    <security>
        <all-permissions />
    </security>

    <application-desc
         name="Screen"
         main-class="script.ScriptFrame">
     </application-desc>
     <update check="always"/>
</jnlp> 
```

该代码库属性，我无法在不使用完整 IP 的情况下加载使此 jnlp 工作。有没有办法我可以使那个相对或动态改变它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:08:59.340

> 有没有办法让我成为那个亲戚..

仅适用于嵌入式小程序。

> ..或动态更改它。

当然，我猜 JNLP servlet 会动态地填充代码库，或者稍微调整一下就可以了。

# java - 如何在衍生项目中将 jar 资源加载到 META-INF\resources 中？

> ID：10034442
> 
> 赞同：1
> 
> 时间：2012-04-05T19:02:03.790
> 
> 标签：java, tomcat, wicket, war, wicket-1.5

我有一个核心 Web-Base.jar 文件，其中包含我在 Web 应用程序中使用的共享组件。

我正在使用 Wicket 1.5。在尝试解决问题时，我正在浏览[javadoc](http://wicket.apache.org/apidocs/1.5/)并发现[MetaInfStaticResourceReference](http://wicket.apache.org/apidocs/1.5/org/apache/wicket/request/resource/MetaInfStaticResourceReference.html)，我认为这可以提高我的应用程序效率和简单性。

如何设置 Web-Base，以便将 Web-Base 列为依赖项的 Web 应用程序将必要的资源添加到最终 .war 文件中的 META-INF/resources/* 中？

**注意：**我正在使用

*   检票口 1.5.5
*   马文
*   Tomcat 6（刚开始考虑升级到 Tomcat 7。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-10T10:41:32.717

这仅适用于 Tomcat 7，因为这仅在 Servlet3 规范中受支持。将资源放在 $PROJECT/src/main/resources/META-INF/resources/ 文件夹中。

# .net - 绑定到 ReadOnly 的 DataGrid 只能在新行对象上编辑

> ID：10034443
> 
> 赞同：0
> 
> 时间：2012-04-05T19:02:10.523
> 
> 标签：.net, wpf, xaml, datagrid

当我向 DataGrid 添加新行，从而创建一个新对象时，只有新行是可编辑的。在我添加新行之前，DataGrid 应该是可编辑的。我在 create 方法中将 readonly 设置为 false 并通知 UI，但仍然只有新创建的行是可编辑的。有没有人对为什么会这样有任何想法/建议？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T20:09:37.470

您的问题不清楚，为什么您将 readonly 设置为 false，希望对您有所帮助

```
public partial class Window2 
{
    public ObservableCollection<Foo> Foos { get; set; }
    public Window2()
    {
        InitializeComponent();
        DataContext = this;
        Foos = new ObservableCollection<Foo>(new List<Foo>
                                                 {
                                                     new Foo{ Column1 = "Some Data 1" , Column2 = "Some Data 1"},
                                                     new Foo{ Column1 = "Some Data 2" , Column2 = "Some Data 2"},
                                                 });
    }
}    
public class Foo
{
    public String Column1 { get; set; }
    public String Column2 { get; set; }

} 
```

```
<DataGrid ItemsSource="{Binding Foos}" AutoGenerateColumns="True" /> 
```

您可以查看： http: [//www.codeproject.com/Articles/30905/WPF-DataGrid-Practical-Examples](http://www.codeproject.com/Articles/30905/WPF-DataGrid-Practical-Examples)

# html - 如何为居中容器中的两列设置相同的高度？

> ID：10034448
> 
> 赞同：1
> 
> 时间：2012-04-05T19:02:36.403
> 
> 标签：html, ruby-on-rails, css

如何在 CSS 中创建等高列？我在互联网上发现的只是一种颜色背景，但我有一个白色背景。每列必须有一个圆角边框，左列可能有很多容器。我如何创建它，使列相等，我的意思是左右？另外，如果右列的高度小于左列的高度，如照片所示，我该怎么做？它必须被拉伸。

![在此处输入图像描述](../Images/98f6e5b105b000bcb622fa82134131ad.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:18:36.100

您可以使用显示表。不幸的是，与 IE7 不兼容。尽管我鼓励人们放弃对它的支持。我公司刚做了。这里还有其他可用的技术，但我认为从语义上讲这是最优雅的。

[http://css-tricks.com/fluid-width-equal-height-columns/](http://css-tricks.com/fluid-width-equal-height-columns/)

[http://jsfiddle.net/7HgwA/1](http://jsfiddle.net/7HgwA/1)

CSS

```
body { padding: 10px; }
#container { 
    display: table; 
    width: 600px; 
    margin: 0 auto; 
    overflow: auto; 
    border: 1px solid gray; 
    border-radius: 20px; 
    padding: 10px; 
}

#container > div { display: table-cell; }
#container div { border: 1px solid gray; border-radius: 20px; padding: 20px;  }
#left > div { height: 100px; margin-bottom: 10px; background: white; } 

#left { width: 150px;  background: lightgray; }
#container #spacer { width: 20px; border: none; padding: 0px; } 
```

HTML

```
<div id="container">
    <div id="left">
        <div>Some content</div>
        <div>Some content</div>
        <div>Some content</div>
        <div>Some content</div>
    </div>
    <div id="spacer"></div>
    <div id="right">
        <p>Lorem ipsum dolor sit</p>
    </div>
</div>​ 
```

# sql - SQL中的多列相乘

> ID：10034453
> 
> 赞同：0
> 
> 时间：2012-04-05T19:02:54.133
> 
> 标签：sql, sas

> **可能重复：**
> [SAS proc SQL 和数组](https://stackoverflow.com/questions/6381103/sas-proc-sql-and-arrays)

我正在尝试使用 SQL 在 SAS 中多次计算多列的比率。例如，我想要：

```
(((start*start_period)+(middle*middle_period)+(end*end_period))/number_days) AS azmonth; 
```

问题在于，虽然`start_period`、`middle_period`、`end_period`和`number_days`是常数，而`start`、`middle`和`end`是一组需要以相同方式相乘的大约 7 个集合。除了为每个人打出来之外，还有其他方法吗？

1.  Start_per Mid_per End_per Start1....Start20 Mid1...Mid20 End1...End20
2.  .3-------------.6------------.1-----10--------15----- -26--------45-----61-----08

我知道我可以为每个开始、中间和结束做一个单独的等式，但我希望有一种方法可以做到，而不必单独复制/粘贴编辑它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-08T19:15:00.777

在运行 PROC SQL 之前编写一个宏来为您生成重复代码，然后在 proc SQL 中的适当位置调用该宏。如果您在数据步骤中执行此操作，另一种选择是为开始、中间和结束变量定义 3 个数组，然后使用 do 循环重复计算 20 次。

[如此处](https://stackoverflow.com/questions/6381103/sas-proc-sql-and-arrays)所见。

[该消息来源](http://www.sascommunity.org/wiki/Arrays_and_Proc_SQL_Question)声称 PROC SQL 本身没有循环功能 - 我不确定这是否属实。如果是这样，宏可能是唯一的解决方案。

# python - 通过计算传播 NaN

> ID：10034455
> 
> 赞同：3
> 
> 时间：2012-04-05T19:02:58.140
> 
> 标签：python, python-3.x, nan, numerical

通常，NaN（不是数字）通过计算传播，因此我不需要在每个步骤中检查 NaN。这几乎总是有效，但显然也有例外。例如：

```
>>> nan = float('nan')
>>> pow(nan, 0)
1.0 
```

我发现了[以下评论](http://en.wikipedia.org/wiki/NaN#Function_definition)：

> 通过算术运算传播安静的 NaN 允许在一系列运算结束时检测到错误，而无需在中间阶段进行大量测试。但是，请注意，根据语言和函数的不同，NaN 可以在表达式中以静默方式删除，这将为所有其他浮点值提供恒定结果，例如 NaN^0，它可以定义为 1，因此通常稍后进行测试需要设置一个 INVALID 标志来检测所有引入 NaN 的情况。
> 
> 为了满足那些希望更严格地解释幂函数应该如何作用的人，2008 年标准定义了两个额外的幂函数；pown(x, n) 其中指数必须是整数，而 powr(x, y) 则在参数为 NaN 时返回 NaN，否则求幂将给出不确定的形式。

有没有办法通过 Python 检查上面提到的 INVALID 标志？或者，是否有任何其他方法可以捕获 NaN 不传播的情况？

动机：我决定使用 NaN 来处理缺失数据。在我的应用程序中，缺少输入会导致结果丢失。它工作得很好，除了我描述的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:34:56.710

我意识到自从被问到这个问题已经过去了一个月，但是我遇到了一个类似的问题（即`pow(float('nan'), 1)`在一些 Python 实现中抛出异常，例如 Jython 2.52b2），我发现上面的答案并不完全是我的寻找。

使用 6502 建议的 MissingData 类型似乎是可行的方法，但我需要一个具体的例子。我尝试了 Ethan Furman 的 NullType 类，但发现它不适用于任何算术运算，因为它不会强制数据类型（见下文），而且我也不喜欢它明确命名每个被覆盖的算术函数。

从 Ethan 的示例和我在[这里](http://code.activestate.com/recipes/307618-class-with-default-method-handler/)找到的调整代码开始，我来到了下面的课程。尽管该类被大量注释，但您可以看到它实际上只有几行功能代码。

关键点是： ***1.***使用 coerce() 返回两个 NoData 对象，用于混合类型（例如 NoData + float）算术运算，以及两个字符串用于基于字符串（例如 concat）的操作。 ***2.***使用 getattr() 为所有其他属性/方法访问返回一个可调用的 NoData() 对象 ***3.***使用 call() 来实现 NoData() 对象的所有其他方法：通过返回一个 NoData() 对象

以下是它的一些使用示例。

```
>>> nd = NoData()
>>> nd + 5
NoData()
>>> pow(nd, 1)
NoData()
>>> math.pow(NoData(), 1)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: nb_float should return float object
>>> nd > 5
NoData()
>>> if nd > 5:
...     print "Yes"
... else:
...     print "No"
... 
No
>>> "The answer is " + nd
'The answer is NoData()'
>>> "The answer is %f" % (nd)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: float argument required, not instance
>>> "The answer is %s" % (nd)
'The answer is '
>>> nd.f = 5
>>> nd.f
NoData()
>>> nd.f()
NoData() 
```

我注意到将 pow 与 NoData() 一起使用会调用 ** 运算符，因此可以与 NoData 一起使用，但使用 math.pow 并不会，因为它首先尝试将 NoData() 对象转换为浮点数。我很高兴使用非数学 pow - 希望 6502 等在他们在上面的评论中遇到 pow 问题时使用 math.pow。

我想不出解决方法的另一个问题是使用格式 (%f) 运算符...在这种情况下，没有调用 NoData 的方法，如果您不提供浮点数，运算符就会失败。无论如何，这就是课程本身。

```
class NoData():
"""NoData object - any interaction returns NoData()"""
def __str__(self):
    #I want '' returned as it represents no data in my output (e.g. csv) files
    return ''        

def __unicode__(self):
    return ''

def __repr__(self):
    return 'NoData()'

def __coerce__(self, other_object):
    if isinstance(other_object, str) or isinstance(other_object, unicode):
        #Return string objects when coerced with another string object.
        #This ensures that e.g. concatenation operations produce strings.
        return repr(self), other_object  
    else:
        #Otherwise return two NoData objects - these will then be passed to the appropriate
        #operator method for NoData, which should then return a NoData object
        return self, self

def __nonzero__(self):
    #__nonzero__ is the operation that is called whenever, e.g. "if NoData:" occurs
    #i.e. as all operations involving NoData return NoData, whenever a 
    #NoData object propagates to a test in branch statement.       
    return False        

def __hash__(self):
    #prevent NoData() from being used as a key for a dict or used in a set
    raise TypeError("Unhashable type: " + self.repr())

def __setattr__(self, name, value):
    #This is overridden to prevent any attributes from being created on NoData when e.g. "NoData().f = x" is called
    return None       

def __call__(self, *args, **kwargs):
    #if a NoData object is called (i.e. used as a method), return a NoData object
    return self    

def __getattr__(self,name):
    #For all other attribute accesses or method accesses, return a NoData object.
    #Remember that the NoData object can be called (__call__), so if a method is called, 
    #a NoData object is first returned and then called.  This works for operators,
    #so e.g. NoData() + 5 will:
    # - call NoData().__coerce__, which returns a (NoData, NoData) tuple
    # - call __getattr__, which returns a NoData object
    # - call the returned NoData object with args (self, NoData)
    # - this call (i.e. __call__) returns a NoData object   

    #For attribute accesses NoData will be returned, and that's it.

    #print name #(uncomment this line for debugging purposes i.e. to see that attribute was accessed/method was called)
    return self 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T19:14:25.553

如果它只是`pow()`让您头疼，您可以轻松地重新定义它以`NaN`在您喜欢的任何情况下返回。

```
def pow(x, y):
    return x ** y if x == x else float("NaN") 
```

如果`NaN`可以用作指数，您还需要检查它；这引发了一个`ValueError`例外，除非基数为 1（显然根据理论，任何幂的 1，即使不是数字，也是 1）。

（当然`pow()`实际上需要三个操作数，第三个是可选的，我将作为练习留下哪个省略...）

不幸的是，`**`运算符具有相同的行为，并且无法为内置数字类型重新定义它。抓住这一点的一种可能性是编写`float`该实现的子类`__pow__()`并将`__rpow__()`该类用作您的`NaN`值。

Python 似乎不提供对计算设置的任何标志的访问。即使确实如此，您也必须在每次单独操作后进行检查。

**事实上，进一步考虑，**我认为最好的解决方案可能是简单地使用一个虚拟类的实例来处理缺失值。Python 将阻塞您尝试对这些值执行的任何操作，引发异常，您可以捕获异常并返回默认值或其他任何内容。如果缺少所需的值，则没有理由继续进行其余的计算，因此应该可以例外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T20:54:54.203

回答您的问题：不，无法使用普通浮点数检查标志。但是，您可以使用提供更多控制的 Decimal 类**。. .** 但速度有点慢。

您的另一种选择是使用`EmptyData`or`Null`类，例如这个：

```
class NullType(object):
    "Null object -- any interaction returns Null"
    def _null(self, *args, **kwargs):
        return self
    __eq__ = __ne__ = __ge__ = __gt__ = __le__ = __lt__ = _null
    __add__ = __iadd__ = __radd__ = _null
    __sub__ = __isub__ = __rsub__ = _null
    __mul__ = __imul__ = __rmul__ = _null
    __div__ = __idiv__ = __rdiv__ = _null
    __mod__ = __imod__ = __rmod__ = _null
    __pow__ = __ipow__ = __rpow__ = _null
    __and__ = __iand__ = __rand__ = _null
    __xor__ = __ixor__ = __rxor__ = _null
    __or__ = __ior__ = __ror__ = _null
    __divmod__ = __rdivmod__ = _null
    __truediv__ = __itruediv__ = __rtruediv__ = _null
    __floordiv__ = __ifloordiv__ = __rfloordiv__ = _null
    __lshift__ = __ilshift__ = __rlshift__ = _null
    __rshift__ = __irshift__ = __rrshift__ = _null
    __neg__ = __pos__ = __abs__ = __invert__ = _null
    __call__ = __getattr__ = _null

    def __divmod__(self, other):
        return self, self
    __rdivmod__ = __divmod__

    if sys.version_info[:2] >= (2, 6):
        __hash__ = None
    else:
        def __hash__(yo):
            raise TypeError("unhashable type: 'Null'")

    def __new__(cls):
        return cls.null
    def __nonzero__(yo):
        return False
    def __repr__(yo):
        return '<null>'
    def __setattr__(yo, name, value):
        return None
    def __setitem___(yo, index, value):
        return None
    def __str__(yo):
        return ''
NullType.null = object.__new__(NullType)
Null = NullType() 
```

您可能想要更改`__repr__`和`__str__`方法。另外，请注意`Null`不能用作字典键，也不能存储在集合中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-05T19:23:42.470

为什么使用`NaN`它已经有另一个语义而不是使用`MissingData`你自己定义的类的实例？

在实例上定义操作`MissingData`以获取传播应该很容易......

# silverlight - 使用 Segoe WP 字体的等宽文本块

> ID：10034456
> 
> 赞同：4
> 
> 时间：2012-04-05T19:03:01.060
> 
> 标签：silverlight, xaml, windows-phone

我有一个从 100 到 500 的数值，它每秒左右变化一次。因为 Segoe WP 的数字字符是可变宽度的，所以文本在更改时会跳转。

在 XAML 文件中使用 Segoe WP 字体；有没有办法用等宽（固定宽度）字符渲染数字（或任何）文本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-25T00:27:21.223

一种解决方法是改用*“Segoe UI”*字体系列，它具有等宽数字，并且相当相似。

# eclipse - 如何在生产模式下运行 maven/eclipse/GWT/playN 应用程序？

> ID：10034458
> 
> 赞同：2
> 
> 时间：2012-04-05T19:03:06.043
> 
> 标签：eclipse, gwt, maven, playn

如果您想使用以下过程在生产模式下从 eclipse 启动 playN/GWT/maven 应用程序，似乎存在问题：

1.  右键单击 playn-showcase-html 并选择 Goolge-GWT 编译

    `Compiling module playn.showcase.Showcase Resolving com.google.gwt.validation.client.constraints.AbstractDecimalMaxValidator Found type 'com.google.gwt.validation.client.constraints.AbstractDecimalMaxValidator' Found type 'javax.validation.constraints.DecimalMax' [WARN] Detected warnings related to 'javax.validation.Constraint'. Is validation-<version>.jar on the classpath? Specify -logLevel DEBUG to see all errors. [WARN] Ignoring unresolvable annotation type javax.validation.Constraint Compiling 1 permutation Compiling permutation 0... Compile of permutations succeeded Linking into /Users/bryan/dev/playn-samples/showcase/html/target/playn-showcase-html-1.0-SNAPSHOT/showcase Link succeeded Compilation succeeded -- 19.459s`

    有人知道这些警告是关于什么的吗？

2.  右键单击 playn-showcase-html 并选择 Run As web application

3.  在浏览器中转到 URL [http://127.0.0.1:8888/Showcase.html](http://127.0.0.1:8888/Showcase.html)，您会收到一条错误消息`GWT module 'showcase' may need to be (re)compiled`。

解决此问题的唯一方法似乎是交换步骤 1 和 2，但这似乎只是倒退。我认为问题在于，当您从 eclipse 运行 Web 应用程序时，gwt maven 插件正在再次编译/部署工件，这是您之前的 GWT 编译步骤的一步。

无论如何，这并不是什么大不了的事，因为您可以颠倒步骤以使其正常工作，但我只是好奇是否有人找到了解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T20:26:40.820

我建议你尝试直接用maven编译/运行它，而不是通过Eclipse，首先进入你的游戏根目录并执行以下操作：

`mvn clean package`

那应该可以毫无问题地编译您的游戏，然后

`mvn test -Ptest-html`

这应该在[http://localhost:8080/中运行你的游戏](http://localhost:8080/)

希望这会有所帮助，我强烈建议尽可能直接使用 maven，因为 Eclipse 有很多不兼容的问题。

# android - 当我向一个人发送短信时，我如何获得其他用户的位置作为回报？

> ID：10034462
> 
> 赞同：-1
> 
> 时间：2012-04-05T19:03:19.217
> 
> 标签：android, sms, broadcastreceiver

代码显示了我到目前为止所做的事情。现在我需要做的是，当我向对方发送短信时，我会找回他的位置，而且我也想在谷歌地图上显示位置！！

显现

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.mehul.googlemaps"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk android:minSdkVersion="8" />
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.SEND_SMS"/>
<uses-permission android:name="android.permission.RECEIVE_SMS"/>

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name">   

    <uses-library android:name="com.google.android.maps" />
    <activity
        android:name=".Main"
        android:label="@string/app_name" >
         <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".HelloWorld" />

</application>

</manifest> 
```

主.java

```
import java.io.IOException;
import java.util.List;
import java.util.Locale;
import com.google.android.maps.GeoPoint;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;
import com.google.android.maps.MyLocationOverlay;
import com.google.android.maps.Overlay;
import com.google.android.maps.OverlayItem;
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.graphics.drawable.Drawable;
import android.location.Address;
import android.location.Criteria;
import android.location.Geocoder;
import android.location.Location;
import android.location.LocationListener;
import android.location.LocationManager;
import android.net.Uri;
import android.os.Bundle;
import android.util.Log;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.Toast;

public class Main extends MapActivity implements LocationListener {
/** Called when the activity is first created. */
MapView map;
long start;
long stop;
int x, y;
GeoPoint touchedPoint;
Drawable d;
List<Overlay> overlayList;
LocationManager lm;
String towers;
int lat ;
int longi; 

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button button = (Button)findViewById(R.id.button1);
    button.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub

            Intent intent = new Intent(Main.this, HelloWorld.class);
            startActivity(intent);
        }
    });

    map = (MapView)findViewById(R.id.mv);
    map.setBuiltInZoomControls(true);

    Touchy t = new Touchy();
    overlayList = map.getOverlays();
    overlayList.add(t);

    d = getResources().getDrawable(R.drawable.pinn);

    //Placing pintpoint
    lm = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    Criteria crit = new Criteria();

    towers = lm.getBestProvider(crit, false);
    Location location = lm.getLastKnownLocation(towers);

    if (location != null){
        lat = (int) (location.getLatitude() *1E6);
        longi= (int) (location.getLongitude() *1E6);

        GeoPoint ourLocation = new GeoPoint(lat,longi);
        OverlayItem overlayItem = new OverlayItem(ourLocation, "Hi!!", "2nd");
        CustomPinPoint custom = new CustomPinPoint(d, Main.this);   
        custom.insertPinpoint(overlayItem);
        overlayList.add(custom);
    }else{
        Toast.makeText(Main.this, "Couldnt get provider", Toast.LENGTH_SHORT).show();
    }

}

@Override
protected void onPause() {
    // TODO Auto-generated method stub

    super.onPause();
    lm.removeUpdates(this);
}

 @Override
protected void onResume() {
    // TODO Auto-generated method stub

    super.onResume();
    lm.requestLocationUpdates(towers, 500, 1, this );
}

    @Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}

class Touchy extends Overlay{
    public boolean onTouchEvent(MotionEvent e, MapView m){
    if (e.getAction() == MotionEvent.ACTION_DOWN){
        start = e.getEventTime();

    }
    if (e.getAction() == MotionEvent.ACTION_UP){
        stop = e.getEventTime();
        x = (int) e.getX();
        y = (int) e.getY();
        touchedPoint = map.getProjection().fromPixels(x, y);

    }
    if (stop - start > 1500){
        AlertDialog alert = new AlertDialog.Builder(Main.this).create();
        alert.setTitle("Pick Option");

        alert.setButton("Hello", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub

                OverlayItem overlayItem = new OverlayItem(touchedPoint, "Hi!!", "2nd");
                CustomPinPoint custom = new CustomPinPoint(d, Main.this);   
                custom.insertPinpoint(overlayItem);
                overlayList.add(custom);

        }
        });
        alert.setButton3("Get Address", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub
            Geocoder geocoder = new Geocoder(getBaseContext(), Locale.getDefault());
            try{
                List<Address> address = geocoder.getFromLocation(touchedPoint.getLatitudeE6() / 1E6, touchedPoint.getLongitudeE6() / 1E6 , 1);
                if (address.size() > 0){
                    String display = "";
                    for (int i = 0; i<address.get(0).getMaxAddressLineIndex(); i++){

                        display += address.get(0).getAddressLine(i) + "\n";
                    }
                    Toast t = Toast.makeText(getBaseContext(), display, Toast.LENGTH_LONG);
                    t.show();
                }
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }finally{
            }
        }});
        alert.setButton2("Toggle View", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub

                if (map.isSatellite()){
                    map.setSatellite(false);
                    map.setStreetView(true);
                }else{
                    map.setStreetView(false);
                    map.setSatellite(true);
                }
            }
});
        alert.setButton("Place a Pin", new DialogInterface.OnClickListener() {

            public void onClick(DialogInterface dialog, int which) {
                // TODO Auto-generated method stub

                OverlayItem overlayItem = new OverlayItem(touchedPoint, "Hi!!", "2nd");
                CustomPinPoint custom = new CustomPinPoint(d, Main.this);   
                custom.insertPinpoint(overlayItem);
                overlayList.add(custom);

            }

        });
        alert.show();
        return true;
    }

        return false;
    }

}

public void onLocationChanged(Location l) {
    // TODO Auto-generated method stub
    lat = (int) (l.getLatitude() *1E6);
    longi = (int) (l.getLongitude() *1E6);
    GeoPoint ourLocation = new GeoPoint(lat,longi);
    OverlayItem overlayItem = new OverlayItem(ourLocation, "Hi!!", "2nd");
    CustomPinPoint custom = new CustomPinPoint(d, Main.this);   
    custom.insertPinpoint(overlayItem);
    overlayList.add(custom);

}

public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}

public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}

public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

}

} 
```

Helloworld.java

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.widget.Toast;

public class HelloWorld extends Activity
{

        protected void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        setContentView(R.layout.helloworld);

        Intent sendIntent = new Intent(Intent.ACTION_VIEW);
        sendIntent.putExtra("sms_body", "Content of the SMS goes here..."); 
        sendIntent.setType("vnd.android-dir/mms-sms");
        startActivity(sendIntent);
            }

} 
```

如果还有其他需要，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:18:24.103

假设其他人也将安装您的应用程序，您可以创建一个`BroadcastReceiver`响应 android.provider.Telephony.SMS_RECEIVED 操作的应用程序。接收者应该实现`onReceive`，检测消息是否来自您的应用程序（我猜在消息正文中使用一些特殊键？），从接收的附加信息中提取消息和原始电话号码`Intent`，然后触发一个位置监听器，然后发送一条短信回...

同样`BroadcastReceiver`也可以检测消息中是否包含纬度/经度，将坐标存储在一些持久存储中，并发送广播意图告诉您的 MapActivity 使用新坐标更新它的地图......

# android - Android扩展apk问题

> ID：10034463
> 
> 赞同：3
> 
> 时间：2012-04-05T19:03:20.713
> 
> 标签：android, apk, expansion

我们最近开始使用新的 Google 扩展 APK 机制。总的来说，它运作良好，但对我们来说似乎有些不稳定。一些问题：

1.  一些用户会随应用程序一起下载扩展应用程序，而其他用户则不会，我们的应用程序必须自行下载。有谁知道什么时候自动运行，什么时候不自动运行？

2.  有时当我们需要自己下载扩展文件时，Google Play 会返回文件大小 -1 和 URL 为 null，表示扩展文件不存在。如果我再次运行该应用程序，第二次它通常会返回一个有效的大小和 URL。有没有其他人看到这种片状？

以下是代码的基础知识：

这就是我们设置调用以通过回调验证许可的方式

```
 policy = new APKExpansionPolicy( context, new AESObfuscator( SALT, context.getPackageName(), deviceId ) );
    mChecker = new LicenseChecker( context, policy, BASE64_PUBLIC_KEY );
    mLicenseCheckerCallback = new MyLicenseCheckerCallback();
    mChecker.checkAccess( mLicenseCheckerCallback ); 
```

然后在回调中我们为 allow() 方法提供了这个（当许可证有效时）。

```
 public void allow( int reason )
    {
        String expansionFileName = policy.getExpansionFileName( APKExpansionPolicy.MAIN_FILE_URL_INDEX );
        String expansionURL = policy.getExpansionURL( APKExpansionPolicy.MAIN_FILE_URL_INDEX );
        long expansionFileSize = policy.getExpansionFileSize( APKExpansionPolicy.MAIN_FILE_URL_INDEX );
    } 
```

我们刚刚发布了带有这个新代码的应用程序，但是大量用户得到了 -1 作为扩展文件大小和 null 作为 url。这会导致用户无法安装扩展文件。通常，如果他们再次运行该应用程序，它将在第二次（或第三次）时运行。

有人对可能发生的事情有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-25T20:45:13.833

您得到 -1 是因为如果您尝试再次联系许可服务器，APKExpansionPolicy 会以本地缓存结果响应 - 但 URL、文件大小和文件名未缓存，并且在第一次真正响应后丢失。APKExpansionPolicy 不缓存这些结果，这里是来自 APKExpansionPolicy 源代码的注释，它解释了它：

> 扩展 URL 不提交首选项，而是在前端处理许可证响应时存储。

因此，您需要在获得第一个成功响应后立即将这些值存储在首选项中（在*允许*回调方法中）；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:18:56.863

[Android Developers 上](http://android-developers.blogspot.com/2012/03/android-apps-break-50mb-barrier.html)的博文提到了 #1：

> 在大多数较新的设备上，当用户从 Android Market 下载您的应用程序时，扩展文件将自动下载，并且在下载扩展文件之前不会开始退款期限。在旧设备上，您的应用将在首次运行时下载扩展文件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-26T09:43:09.757

添加到[Daniel Novak 的回答](https://stackoverflow.com/a/11197087/148241)中，如果您在调用之前重置策略`checkAccess()`，这将强制它提出新的许可证请求，因此检索 URL：

```
policy.resetPolicy(); 
```

如果您确定需要 URL（即，如果您已经检查过扩展文件是否丢失），您可能只想这样做。

# c++ - 多处理浏览器？

> ID：10034468
> 
> 赞同：0
> 
> 时间：2012-04-05T19:03:29.870
> 
> 标签：c++, windows, browser, multiprocessing, inter-process-communicat

我想知道哪个框架/接口/API 的 Set 最适合用于创建多进程浏览器，我希望能够使用 UDP/TCP 进行进程间通信。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:36:55.653

我认为你最好的选择是利用 WebKit2。它是从一开始就为沙盒/多进程支持而设计的。

[http://trac.webkit.org/wiki/WebKit2](http://trac.webkit.org/wiki/WebKit2)

# c - 使用位运算符的条件语句

> ID：10034470
> 
> 赞同：12
> 
> 时间：2012-04-05T19:03:43.600
> 
> 标签：c, conditional, bit-manipulation, bitwise-operators

所以我看到这个问题已经被问过了，但是答案有点模糊和无益。好的，我只需要使用 "& ^ ~ ! + | >> <<" 来实现 ac 表达式

表达式需要类似于：a ? 乙：丙

所以，据我所知，表达式需要看起来像：

`return (a & b) | (~a & c)`

这在 a = 0 时有效，因为将其与 b 相乘将给出零，然后 or 表达式将返回右侧，`(~a & c)`这有效，因为 ~0 给出全 1，并且将 c 与全一相加返回 c。

但是，当 a > 0 时，这不起作用。有人可以尝试解释为什么会这样，或者如何解决它吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-05T19:15:24.197

我会`a`使用 , 转换为布尔值`!!a`以获得 0 或 1 `x = !!a`。

然后我会在二进制补码中否定它。由于您没有可用的一元减号，因此您使用 2 的补码否定的定义：反转位，然后加一：`y = ~x + 1`。这将清除所有位或设置所有位。

然后我`and`直接用一个变量`y & b`，它与另一个相反：`~y & c`。这将为其中一个表达式提供 0，而为另一个表达式提供原始变量。当我们`or`将它们放在一起时，零将不起作用，因此我们将获得原始变量，保持不变。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:09:40.383

换句话说，如果 a 为（即 0），则需要`a`将所有位设置为 0，如果 a 为真（即），则需要将所有位设置为 1。`false``a``a > 0`

对于前一种情况，工作已经为您完成；对于后者 - 尝试计算表达式的结果`~!1`。

# javascript - 如何清除我的用户画布绘图？

> ID：10034476
> 
> 赞同：-1
> 
> 时间：2012-04-05T19:04:15.777
> 
> 标签：javascript, html, canvas, draw

我有这个 html5 绘图应用程序，可以在画布元素上很好地绘制。我的问题是，我有一个橡皮擦的 img，我希望用户能够单击它，它会擦除​​画布。如果您还可以告诉我如何将笔画颜色更改为白色，则额外的业力点。

这是我的html：

```
<div id="draw_area">

<canvas id="myCanvas" />
<p>browser sucks, here's links blah blah blah</p>
</canvas>
</div> 
```

这是补充它的JS：

```
 var points = new Array();
var outlineImage = new Image();

function clearCanvas(){
 context.clearRect(0, 0, canvas.width, canvas.height);
}

if (window.addEventListener) {
    window.addEventListener('load', function () {
        var canvas, context, tool;

        function init() {
            // Find the canvas element.
            canvas = document.getElementById('imageView');
            if (!canvas) {
                alert('Error: I cannot find the canvas element!');
                return;
            }

            if (!canvas.getContext) {
                alert('Error: no canvas.getContext!');
                return;
            }

            // Size the canvas:
            canvas.width = 367;
            canvas.height= 249;

            // Get the 2D canvas context.
            context = canvas.getContext('2d');
            if (!context) {
                alert('Error: failed to getContext!');
                return;
            }

            // Pencil tool instance.
            tool = new tool_pencil();

            // Attach the mousedown, mousemove and mouseup event listeners.
            canvas.addEventListener('mousedown', ev_canvas, false);
            canvas.addEventListener('mousemove', ev_canvas, false);
            canvas.addEventListener('mouseup', ev_canvas, false);
        }

        // This painting tool works like a drawing pencil which tracks the mouse
        // movements.
        function tool_pencil() {
            var tool = this;
            this.started = false;

            // This is called when you start holding down the mouse button.
            // This starts the pencil drawing.
            this.mousedown = function (ev) {
                context.beginPath();
                context.moveTo(ev._x, ev._y);
                tool.started = true;
            };

            // This function is called every time you move the mouse. Obviously, it only
            // draws if the tool.started state is set to true (when you are holding down
            // the mouse button).
            this.mousemove = function (ev) {
                if (tool.started) {
                    context.lineTo(ev._x, ev._y);
                    context.stroke();
                }
            };

            // This is called when you release the mouse button.
            this.mouseup = function (ev) {
                if (tool.started) {
                    tool.mousemove(ev);
                    tool.started = false;
                }
            };
        }
        // The general-purpose event handler. This function just determines the mouse
        // position relative to the canvas element.
        function ev_canvas(ev) {
            if (navigator.appName == 'Microsoft Internet Explorer' || navigator.vendor == 'Google Inc.' || navigator.vendor == 'Apple Computer, Inc.') { // IE or Chrome
                ev._x = ev.offsetX;
                ev._y = ev.offsetY;
            } else if (ev.layerX || ev.layerX == 0) { // Firefox
                ev._x = ev.layerX - this.offsetLeft;
                ev._y = ev.layerY - this.offsetTop;
            } else if (ev.offsetX || ev.offsetX == 0) { // Opera
                ev._x = ev.offsetX;
                ev._y = ev.offsetY;
            }
            // Call the event handler of the tool.
            var func = tool[ev.type];
            if (func) {
                func(ev);
            }
            points.push(ev);
        }

        init();

    }, false);
    } 
```

我想我需要一个重绘功能，但我真的不知道我在谈论这个问题。非常感谢任何见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:13:11.880

假设您的背景颜色是白色，这是 clearRect 将给您的，那么您需要做的就是在用户选择橡皮擦时将笔触颜色更改为白色。这可以很容易地完成

```
context.strokeStyle = 'white'; 
```

有关更改颜色的更多信息，请参阅[http://www.w3.org/TR/2dcontext/#fill-and-stroke-styles](http://www.w3.org/TR/2dcontext/#fill-and-stroke-styles)。

如果您的橡皮擦图像是在画布上绘制的，那么您将必须在您的`mousedown`或`mouseup`事件处理程序中检测它的点击。如果它在画布之外，那么只需添加一个`onclick`函数来设置`strokeStyle`它被点击的时间。但是，如果您希望橡皮擦擦除所有内容，请执行

```
function clearCanvas(){
  context.clearRect(0, 0, context.canvas.width, context.canvas.height);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:17:23.723

您的变量在调用`canvas`的范围内不可用。`clearCanvas`虽然还有其他方法可以解决此问题，但只需执行以下操作：

```
function clearContext( ctx ){
  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
} 
```

并在您调用它时将上下文传递给您的函数。

但是请注意，如果您的上下文以任何方式进行转换，上述内容将不会清除整个可见区域。为了防止这种情况，您可能需要：

```
function clearContext( ctx ){
  ctx.save();
  ctx.setTransform(1,0,0,1,0,0);
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  ctx.restore();
} 
```

# c - 当指针为 NULL 时，while (*next != NULL) 循环不退出

> ID：10034479
> 
> 赞同：3
> 
> 时间：2012-04-05T19:04:32.783
> 
> 标签：c, pointers

请有人帮我解决这个问题，当 *next == NULL 并尝试在 Visual Studio 2010 Express 中使用错误的 ptr 调用 strlen(*next) 时，以下 C 代码中的 while 循环似乎没有退出。我已经尝试了我能想到的一切都无济于事。该代码尝试在字符串数组中查找最短和最长的字符串。

```
char *stringsInArray[] = {"green mats", "cat", "sat", "on", "the", "green mat", NULL};
char *shortest, *longest, **current, **next, **end;

current = stringsInArray;
next = stringsInArray + 1;
shortest = stringsInArray[0];
longest = stringsInArray[0];

while (*next != NULL) 
{
    if (strlen(*current) < strlen(*next))
    {
        if (strlen(shortest) > strlen(*next))
            shortest = *next;
        if (strlen(*current) < strlen(shortest))
       shortest = *current;
        if (strlen(*next) > strlen(longest))
            longest = *next;
    }  
    else
    if (strlen(*current) > strlen(*next))
    {
        if (strlen(*current) > strlen(longest))
      longest = *current;
        if (strlen(*next) < strlen(shortest))
      shortest = *next;
    }
    else // strlen(*stringsInArray) == strlen(*next)
    {
        // do nothing
    }

   *current++;
   *next++;
} 

printf("shortest string: %s\n",*shortest);
printf("longest string: %s\n",*longest); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:29:12.677

你***应该***改变

```
*current++;
*next++; 
```

至

```
current++;
next++; 
```

两者都可以增加，但前者也取消引用/返回值`current`and `next`; 这是不需要的。

但是，您的问题是：

```
printf("shortest string: %s\n", *shortest);
printf("longest string: %s\n",  *longest); 
```

在这里，您尝试使用字符串作为格式打印字符。

这应该有效：

```
printf("shortest string: %s\n", shortest);
printf("longest string: %s\n",  longest); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:30:42.013

代码实际上按预期工作-您只需要更改

```
printf("shortest string: %s\n",*shortest);
printf("longest string: %s\n",*longest); 
```

至

```
printf("shortest string: %s\n",shortest);
printf("longest string: %s\n",longest); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-01-24T00:07:25.970

%s 需要一个指向 char 的指针，即 char *。因此，它必须是最短和最长的，它们是指针，而不是 *shortest 和 *longest，它们是指针位置的值

# actionscript-3 - AS3 - 获取谷歌分析状态

> ID：10034481
> 
> 赞同：0
> 
> 时间：2012-04-05T19:04:42.383
> 
> 标签：actionscript-3, google-analytics, tracking

我正在使用 Google Analytics for Flash。如何确定跟踪器是否正常工作？

这是代码：

```
import com.google.analytics.GATracker;
import com.google.analytics.AnalyticsTracker;

var tracker:AnalyticsTracker;
tracker = new GATracker(this, "UA-123456789-1", "AS3", false); 
```

这出现在 GA 调试模式中：

> 用户在线：Gif 请求 #0 失败
> 
> 用户离线：已发送 Gif 请求 #0

谢谢。乌里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T12:50:25.490

我今天面临同样的问题。我[从谷歌找到了解释](https://developers.google.com/analytics/devguides/collection/other/flashTrackingIntro?hl=ru-RU#troubleshooting)：目前，Flash 跟踪可用于网页中嵌入的任何 Flash 内容。目前不支持跟踪从 Adob​​e Air、Shockwave 或通过 Flash IDE（例如使用测试影片）发送的数据。

我想只有用谷歌分析来跟踪闪存数据的方法——使用桥接方法（ga.js）。或者使用其他分析网站，例如[appanalytics](http://www.appanalyticshq.com/)。

# python - Django 的实时选项（Websockets、flash、轮询）？

> ID：10034484
> 
> 赞同：9
> 
> 时间：2012-04-05T19:05:18.040
> 
> 标签：python, django, websocket, real-time

可以作为 python 包安装的 django 有哪些实时“推送”选项？我想避免做一些事情，比如实时安装独立的网络服务器。

本质上，我正在寻找类似 pusher.com（云系统）或[这个用于 django 的 socket.io 构建](https://github.com/stephenmcd/django-socketio)（具有构建状态：失败）的东西，用于聊天和其他各种推送操作。

[此处](https://stackoverflow.com/questions/7465110/realtime-solution-for-django)建议使用 Ape ，但似乎需要您将 Ape 设置为服务器。如果要求不高，是否有任何解决方案可以直接构建到 django 中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-08T06:04:43.743

自编写答案以来（2012年）；很多东西都变了。

现在进行系统实时更新的首选方法是使用 websockets；它正在被正式化并作为标准[RFC 6455](https://www.rfc-editor.org/rfc/rfc6455)提出。[MDN 上的这个页面对](https://developer.mozilla.org/en/docs/WebSockets)这项技术有很好的概述。

另一种新兴技术是[服务器发送事件](https://developer.mozilla.org/en-US/docs/Server-sent_events)，它是[W3C 提案草案](http://dev.w3.org/html5/eventsource/)。

[swampdragon](http://swampdragon.net/)和[django-socketio](http://django-socketio.readthedocs.org/en/latest/)等项目可以让您在项目中更轻松地集成实时功能。

* * *

任何实时系统都有两个主要组件：

1.  从浏览器到服务器的连接保持打开状态。
2.  侦听此连接然后响应的服务器。
3.  用于存储和通知消息的系统/标准。

好吧，也许是三个组件。

由于 django 不能实时工作，任何提供实时推送/更新的解决方案都需要另一个服务器/服务来接受消息，然后通知侦听器未决消息。

Django 将是在通道（队列/存储桶）上将消息（写入）推送到该服务器的应用程序。侦听器然后订阅一个频道以接收消息通知。由于连接保持打开状态；消息是“实时”检索的。

Django 在所有这一切中确实扮演着最小的角色。有多种实现提供实时通知工作所需的三个组件。

我真的很喜欢[juggernaut](https://github.com/maccman/juggernaut)，因为它设置起来超级简单，并且使用 node.js，在服务器端组件方面不需要太多。我更喜欢它的另一个原因是因为它除了 WebSocket 之外还支持 Adob​​e Flash Socket（以及其他，请参阅链接）。

访问它的 api 也非常简单——事实上，如果你已经在使用 redis（你真的应该使用它，因为它[很容易使用](http://unfoldthat.com/2011/09/14/try-redis-instead.html)），你不需要另一个 API，因为你可以将消息发送到 redis，juggernaut 会读取它们，或者你可以使用它的 Python API。此[烧瓶片段中](http://flask.pocoo.org/snippets/80/)的一个简单示例：

向通道发送（写入）消息：

```
>>> from juggernaut import Juggernaut
>>> jug = Juggernaut()
>>> jug.publish('channel', 'The message') 
```

听这个：

```
<script type=text/javascript
  src=http://localhost:8080/application.js></script>
<script type=text/javascript>
  var jug = new Juggernaut();
  jug.subscribe('channel', function(data) {
    alert('Got message: ' + data);
  });
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-09T19:18:03.560

Django 是为网页服务而构建的，在 django 中没有开箱即用的东西来支持 websockets。最快/最简单的选择是 pusher.com（我非常喜欢它）。您可以从 pusher.com 之类的东西开始，如果您围绕它编写一个快速包装器，您可以使用 socket.io 或任何其他 Web 套接字服务器将其替换为您自己的服务器，只需更改包装器/接口以连接到新服务器. 只要确保您编写它时能够随时切换后端即可。

如果你真的想开始运行你自己的套接字服务器，那么有一些项目可以让你在 django 中轻松使用套接字：

*   [django-websocket](http://pypi.python.org/pypi/django-websocket)
*   [django-socketio](https://github.com/stephenmcd/django-socketio)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-08T05:34:00.807

您实际上可以从[Tornadio2](https://github.com/mrjoes/tornadio2)提供 Django ，Tornado 中的 socketio 的工作实现。如果您想在您的实时应用程序中构建任何程度的复杂性，您可能需要一个将会话映射到通道并处理多播的 redis pubsub 后端。为此，您可能想看看[Brukva](https://github.com/evilkost/brukva)。另请阅读 Yuval Adam关于此主题的[博客文章。](http://blog.y3xz.com/post/24691592929/a-modern-python-stack-for-a-real-time-web-application)最后，Tony Abou Assaleh 的[示例包](https://github.com/tgcondor/django-tornadio2)和[帖子](http://tony.abou-assaleh.net/web-development/html5-web-sockets-in-django)将在为 django 设置 Tornadio2 时提供有用的基础参考。

# java - 带有@SessionScoped Bean 的Java web-app 如何知道浏览器是否重新启动？

> ID：10034487
> 
> 赞同：0
> 
> 时间：2012-04-05T19:05:34.997
> 
> 标签：java, jsf, web-applications

这是一个非常基本的问题。我正在从一本关于 JSF Web 应用程序的教科书中学习，并使用 @SessionScoped Bean 来管理会话。书中提到，如果你关闭浏览器，会话就会结束，这很容易通过测试来验证。但我不确定如何通知网络应用程序浏览器已关闭并重新打开。我在本地找不到任何 cookie 商店。那么网络应用程序是如何获取这些信息的呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:07:41.877

这是一个具有魔力的[会话 Cookie 。](http://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T10:36:55.827

事实上，当您到达应用程序的任何网页时，您就会启动一个 http 会话。然后您的浏览器存储一个 sessionId 用作后续请求的标识符。

因此，当浏览器关闭时，您的应用程序无法知道这一点。

从服务器端完成会话的唯一方法是在 web.xml 中设置超时。如果在触发超时之前没有来自浏览器的请求，则将调用此会话的托管 bean 中带有 @PreDestroy 注释的所有方法，然后将在服务器端清理所有内容。

# sql - 在 SQL 中，使用括号和 OR 是什么意思？

> ID：10034489
> 
> 赞同：1
> 
> 时间：2012-04-05T19:05:42.913
> 
> 标签：sql, oracle, operator-precedence, associativity

例子：

```
select count(*) from my table
where
column1 is not null
and
(column1 = 4 OR column1 = 5) 
```

示例 2：

```
select count(*) from my table
where
column1 is not null
and
column1 = 4 OR column1 = 5 
```

在具有真实列名的数据库中，我得到两个不同的结果。带括号的那个是正确的，因为如果我这样做：

```
select count(*) from my table
where
column1 is not null
and
column1 = 4 
```

进而

```
select count(*) from my table
where
column1 is not null
and
column1 = 5 
```

并将它们加在一起，我得到了正确的答案......我想。与上面括号的第一个示例相同。

为什么我通过改变 OR 测试的优先级得到不同的结果？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T19:14:14.367

它不是 Oracle 或 SQL。这是基本的布尔逻辑。AND 条件比 OR“更强”（优先），这意味着它将首先被评估：

```
column1 is not null
and
column1 = 4 OR column1 = 5 
```

方法

```
column1 is not null
and
column1 = 4 
```

首先评估，然后在这和之间应用 OR`column1 = 5`

添加括号可确保先评估 OR，然后再评估 AND。

和数学很像：

```
2 * 3 + 5 = 6 + 5 = 11 
```

但

```
2 * (3 + 5) = 2 * 8 = 16 
```

更多阅读：http: [//msdn.microsoft.com/en-us/library/ms190276.aspx](http://msdn.microsoft.com/en-us/library/ms190276.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:12:59.453

这归结为您的表达式是否被解析为：

```
(column1 is not null and column1 = 4) OR column1 = 5 
```

或者

```
column1 is not null and (column1 = 4 OR column1 = 5) 
```

看到不同？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-05-04T15:13:21.440

括号很重要，`(A AND B) OR C` ≠ `A AND (B OR C)` 就像数学一样：`(0 * 1) + 2` ≠ `0 * (1 + 2)`

但是，您可以选择不使用括号：SQL 没有运算符优先级规则，因此它严格地从左到右计算表达式。例如：

```
true OR false AND false 
```

是假的，就像

```
(true OR false) AND false 
```

尽管

```
true OR (false AND false) 
```

是真的。

# javascript - jQuery/Javascript 将链接成为解决方案吗？

> ID：10034491
> 
> 赞同：0
> 
> 时间：2012-04-05T19:05:45.770
> 
> 标签：javascript, jquery

虚拟.html：

```
<button id="do">Do</button> 
```

外部.js：

```
$("#do").click(function() {
  history.go(-1);
  alert('One page back');
  history.go(1);
  alert('back from were you started');
}); 
```

将执行 history.go(-1); 并结束。

在最终的使用场景中，它将与由多个选项卡组成的 jQuery UI 选项卡一起使用，并且通常 history.go(-1) 将保留在同一页面上，但通常会返回到同一页面上的另一个选项卡。

我可以通过链接解决这个问题吗？它会是什么样子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:06:46.137

`history.go(...)` **离开**当前页面，任何在其上运行的 js 都会停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:42:39.757

这里有一些可以帮助你的东西。这使用一个数组来推送/弹出选项卡的历史记录。

[http://jsfiddle.net/wgxjz/6/](http://jsfiddle.net/wgxjz/6/)

编辑：这不是防弹的，但它是可以继续的。

# mysql - MySQL 一对多关系：GROUP_CONCAT 或 JOIN 或两者兼而有之？

> ID：10034494
> 
> 赞同：1
> 
> 时间：2012-04-05T19:05:50.090
> 
> 标签：mysql

我需要有关 MySQL 查询的帮助。我有三张桌子：

```
`product_category` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(255) NOT NULL,
PRIMARY KEY  (`id`)
);

`order_products` (
  `id` int(11) NOT NULL auto_increment,
  `name` varchar(255) NOT NULL,
  `qty` int(11) NOT NULL,
  `unit_price` decimal(11,2) NOT NULL,
  `category` int(11) NOT NULL,
  `order_id` int (11) NOT NULL,
   PRIMARY KEY  (`id`)
);

`orders` (
  `id` int(11) NOT NULL auto_increment,
  `date` varchar(255) NOT NULL,
  PRIMARY KEY  (`id`)
 ); 
```

我有一个查询，按产品类别（在某个日期范围内）计算所有订单的小计。它看起来像这样：

```
 SELECT 
   SUM(op.unit_price * op.qty) as amt, 
   c.name as category_name 
 FROM 
   order_products op, 
   product_category c, 
   orders o 
 WHERE 
   op.category = c.id 
 AND 
   op.order_id = o.id
 AND
   o.date > 'xxxxxxx' 
 GROUP BY 
   c.id 
```

这很好用，但现在我想将单个产品及其小计添加到每一行，以便得到如下结果：

```
c.name|amt|op.name (1) - op.subtotal (1), op.name (2), op.subtotal (2), etc.... 
```

我发现使用 GROUP_CONCAT 可以很容易地通过添加以下内容来显示名称：

```
GROUP_CONCAT(op.name) as product_name 
```

到 SELECT 子句，但对于我的生活，我无法弄清楚如何让每个产品的小计显示在产品名称旁边。我有一种感觉，它涉及嵌套在 GROUP_CONCAT 内的连接或 CONCAT 的组合，但我尝试过的任何方法都没有奏效。有任何想法吗？

@piotrm 有一个想法，它似乎应该起作用（如下），但由于某种原因，它返回以下内容：

```
SELECT  `subtotals` 
FROM  `product_category` 
WHERE  `c`.`category_name` =  'Fragrance'AND.`amt` =  '23164.50'AND.`subtotals` = CAST(     0x6c6f76656c696c7920454454202d203631302e30302c20466f72657665726c696c79202e313235206f7a2045445020726f6c6c657262616c6c202d20313831372e35302c20666f72657665726c696c79206361636865706f74202d2039302e30302c20666f72657665726c696c7920312f38206f756e63652070617266756d206f696c20726f6c6c657262616c6c202d20313833302e30302c20666f72657665726c696c792070657266756d696e6720626f6479206c6f74696f6e202d203938312e30302c20666f72657665726c696c7920332e34206f756e6365206561752064652070617266756d207370726179202009202d203535382e30302c20666f72657665726c696c79205363656e74656420566f746976652043616e646c65202d203132302e30302c20454450202620426f6f6b20736574202d203334332e30302c20666f72657665726c696c7920332e34206f756e6365206561752064652070617266756d207370726179202d2031363831352e3030 AS 
BINARY ) ; 
```

一旦我从原始 SELECT 子句中取出 s.subtotal ，它就会提取正确的产品名称。JOIN 查询正确地提取产品及其关联的 category_id 和小计。如果不在这里造成混乱，我就无法将两者结合在一起。还有其他想法吗？

**解决方案**

@piotrm 的查询基本上是正确的，除了 GROUP_CONCAT 正在寻找字符串的集合。所以最终的查询看起来像这样：

```
SELECT c.name AS category_name,
       SUM( s.subtotal ) AS amt,
       GROUP_CONCAT( CONCAT(s.name, ' - ', cast(s.subtotal as char) ) SEPARATOR ', ')                           AS subtotals
FROM 
       product_category c 
JOIN 
   (SELECT op.category, op.name, sum(op.qty*op.unit_price) AS subtotal
FROM order_products op
JOIN orders o ON o.id = op.order_id
WHERE o.date > '0'
GROUP BY op.category, op.name ) s 
ON s.category = c.id
GROUP BY c.name 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:52:54.370

尝试：

```
SELECT 
    SUM(op.unit_price * op.qty) as amt, 
    c.name as category_name,
    group_concat(concat(op.name, '-', op.qty, ',' , 
                 op.unit_price*op.qty) separator '|')
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T21:27:13.620

从您的查询中猜测，您的表中还有`order_id`您`order_products`在表定义中未提及的字段。您的查询应如下所示：

```
SELECT c.name AS category_name,
             SUM( s.subtotal ) AS amt,
             GROUP_CONCAT( CONCAT(s.name, ' - ', s.subtotal ) SEPARATOR ', ' ) AS subtotals
FROM 
    product_category c 
JOIN 
  ( SELECT op.category, op.name, sum(op.qty*op.unit_price) AS subtotal
    FROM order_products op
    JOIN orders o ON o.id = op.order_id
    WHERE o.date > '2012-03-31'
    GROUP BY op.category, op.name ) s 
  ON s.category = c.id
GROUP BY c.name 
```

不过，您的数据库架构很奇怪，订单表看起来可以删除，并且该日期已移至 order_products，因为对于每个 order_products 行，您都引用了 orders 表。通常是另一种方式 - 订单表中 product_id 字段引用的每个产品都有很多订单。订单中的日期列也是 varchar 类型 - 为什么不是日期或日期时间？

# java - 当我尝试在 Eclipse 中启动服务器时，为什么 Tomcat 会“内存不足”？

> ID：10034497
> 
> 赞同：2
> 
> 时间：2012-04-05T19:05:55.877
> 
> 标签：java, eclipse, jakarta-ee, tomcat, maven

当我单击以使用我的网络应用程序启动（字面意思是立即）tomcat 服务器时，它会显示以下错误：http: [//i67.photobucket.com/albums/h282/jamesekki/error.jpg](http://i67.photobucket.com/albums/h282/jamesekki/error.jpg)

奇怪的是应用程序仍然可以成功构建并且运行良好。问题是它会减慢开发时间，因为每次我需要部署任何更改时都会收到此错误。

这是我的日食 ini：http: [//i67.photobucket.com/albums/h282/jamesekki/Capture.jpg](http://i67.photobucket.com/albums/h282/jamesekki/Capture.jpg)

有任何想法吗？

我尝试过的事情： 1\. 以 128 兆的增量增加 xms/xmx 一直到 4 gigs（仍然失败） 2\. 增加 permsize/maxpermsize 类似于上面的增量（仍然失败）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:12:43.403

也许这些将有助于解释：

[http://www.mulesoft.com/tomcat-oome-out-of-memory-error](http://www.mulesoft.com/tomcat-oome-out-of-memory-error)

[http://baskarfelix.wordpress.com/2008/08/06/out-of-memory-errorjava-heap-space/](http://baskarfelix.wordpress.com/2008/08/06/out-of-memory-errorjava-heap-space/)

如果您不考虑 Eclipse，我也很想知道您是否有同样的问题。创建一个 WAR 文件，将其添加到 Tomcat /webapps 目录，然后使用命令 shell 和 /bin 目录中的启动脚本启动 Tomcat。如果你仍然有问题，我会说你应该看看 Tomcat 和你的 JVM 是如何配置的。如果你不这样做，它会告诉我 Eclipse 是问题所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T07:35:17.293

你的设置对我来说很好。您可以尝试对 [1] tomcat 进行分析以查看启动时会发生什么，或者尝试删除本地服务器和运行时的粗略方法，看看它是否有助于新的。如果失败，请重新下载最新的 Eclipse Java EE 版本，然后从头开始设置。

虽然这不是最好的解决方案（如果问题再次出现，您仍然没有合适的解决方案），但如果花费太长时间，有时还是值得的。

[1] 您可以使用 JProfiler 或 YourKit Profiler 进行分析。两者都有试用版。JVisualVM 也是 JDK 附带的替代方案。但是，如果 Tomcat 立即崩溃，这可能是一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T18:21:02.587

感谢大家的投入。我能够将其缩小到整个问题的根本原因。我的服务层的 src/main/resources/lib 中有一个外部 api jar 文件，无论出于何种原因，Eclipse 似乎都不喜欢这样。一旦我把它移出那个位置，它就解决了这个问题。谁能解释为什么这可能会导致问题？仅用于学习目的。谢谢！

# uinavigationcontroller - 构建 MonoTouch.Dialog 应用程序

> ID：10034500
> 
> 赞同：10
> 
> 时间：2012-04-05T19:06:03.670
> 
> 标签：uinavigationcontroller, xamarin.ios, monotouch.dialog, dialogviewcontroller

从[Xamarin.com](http://docs.xamarin.com/ios/tutorials/MonoTouch.Dialog)上的示例中，您可以构建基本`M.T. Dialog`应用程序，但如何构建现实生活中的应用程序？

你：

1）从那里创建一`DialogViewController`棵树`view/RootElement`，或者，

`DialogViewController`2）为每个视图创建一个`UINavigationController`并根据需要使用并推送它？

根据您的回答，更好的回答是如何？我已经构建了示例任务应用程序，所以我了解向表格添加元素，单击它以转到“下一个”视图进行编辑，但如何单击以进行非编辑？如果答案是数字 1，如何单击按钮，转到下一个视图？

**修订**：

可能没有一个正确的答案，但我想出的似乎对我们有用。上面的数字 2 是选择的，下面是当前存在的代码示例。我们所做的是创建一个导航控制器`AppDelegate`并在整个应用程序中访问它，如下所示：

```
public partial class AppDelegate : UIApplicationDelegate
{
    public UIWindow window { get; private set; }
    //< There's a Window property/field which we chose not to bother with

    public static AppDelegate Current { get; private set; }
    public UINavigationController NavController { get; private set; }

    public override bool FinishedLaunching (UIApplication app, NSDictionary options)
    {
        Current = this;
        window = new UIWindow (UIScreen.MainScreen.Bounds);
        NavController = new UINavigationController();

        // See About Controller below
        DialogViewController about = new AboutController();
        NavController.PushViewController(about, true);

        window.RootViewController = NavController;
        window.MakeKeyAndVisible ();
        return true;
    }
} 
```

然后每个`Dialog`都有这样的结构：

```
public class AboutController : DialogViewController
{
    public delegate void D(AboutController dvc);
    public event D ViewLoaded = delegate { };

    static About about;
    public AboutController()
        : base(about = new About())
    {
        Autorotate = true;
        about.SetDialogViewController(this);
    }

    public override void LoadView()
    {
        base.LoadView();
        ViewLoaded(this);
    }
}

public class About : RootElement
{
    static AboutModel about = AboutVM.About;

    public About()
        : base(about.Title)
    {
        string[] message = about.Text.Split(...);
        Add(new Section(){
            new AboutMessage(message[0]),
            new About_Image(about),
            new AboutMessage(message[1]),
        });
    }

    internal void SetDialogViewController(AboutController dvc)
    {
        var next = new UIBarButtonItem(UIBarButtonSystemItem.Play);
        dvc.NavigationItem.RightBarButtonItem = next;
        dvc.ViewLoaded += new AboutController.D(dvc_ViewLoaded);
        next.Clicked += new System.EventHandler(next_Clicked);
    }

    void next_Clicked(object sender, System.EventArgs e)
    {
        // Load next controller
        AppDelegate.Current.NavController.PushViewController(new IssuesController(), true);
    }

    void dvc_ViewLoaded(AboutController dvc)
    {
        // Swipe location: https://gist.github.com/2884348
        dvc.View.Swipe(UISwipeGestureRecognizerDirection.Left).Event +=
            delegate { next_Clicked(null, null); };            
    }
} 
```

根据需要创建元素的子类：

```
public class About_Image : Element, IElementSizing
{
    static NSString skey = new NSString("About_Image");
    AboutModel about;
    UIImage image;

    public About_Image(AboutModel about)
        : base(string.Empty)
    {
        this.about = about;
        FileInfo imageFile = App.LibraryFile(about.Image ?? "filler.png");
        if (imageFile.Exists)
        {
            float size = 240;
            image = UIImage.FromFile(imageFile.FullName);
            var resizer = new ImageResizer(image);
            resizer.Resize(size, size);
            image = resizer.ModifiedImage;
        }
    }

    public override UITableViewCell GetCell(UITableView tv)
    {
        var cell = tv.DequeueReusableCell(skey);
        if (cell == null)
        {
            cell = new UITableViewCell(UITableViewCellStyle.Default, skey)
            {
                SelectionStyle = UITableViewCellSelectionStyle.None,
                Accessory = UITableViewCellAccessory.None,
            };
        }
        if (null != image)
        {
            cell.ImageView.ContentMode = UIViewContentMode.Center;
            cell.ImageView.Image = image;
        }
        return cell;
    }

    public float GetHeight(UITableView tableView, NSIndexPath indexPath)
    {
        float height = 100;
        if (null != image)
            height = image.Size.Height;
        return height;
    }

    public override void Selected(DialogViewController dvc, UITableView tableView, NSIndexPath indexPath)
    {
        //base.Selected(dvc, tableView, path);
        tableView.DeselectRow(indexPath, true);
    }
} 
```

@miquel

工作流的当前想法是一个应用程序，它以 Default.png 的 jpg 开始，淡入第一个视图，并带有一个可以移动到主应用程序的流控制按钮。这个视图是我之前工作的`M.T.D. (MonoTouch.Dialog)`，它是一个带有图像的文本行表。单击每一行时，它会移动到另一个视图，该视图具有更详细的行/文本。

该应用程序还支持应用程序内购买，因此如果客户希望购买更多产品，则切换到另一个视图进行购买交易。这部分是切换到 的主要原因`M.T.D.`，因为我认为`M.T.D.`这对它来说是完美的。

最后会有一个设置视图来重新启用购买等。

PS如何知道应用程序何时未最小化？我们想再次显示图像的淡入淡出。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:34:20.637

我也使用了您所说的选项 2，它工作得非常好，因为您可以在每个根视图的基础上编辑工具栏选项等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-28T09:17:47.003

我一直在问自己同样的问题。我使用了[Funq](http://funq.codeplex.com/)依赖注入框架，并为每个视图创建了一个新的 DialogViewController。这实际上与我之前开发 ASP.NET MVC 应用程序所使用的方法相同，这意味着我可以很好地分离控制器逻辑。我为每个视图子类化 DialogViewController，它允许我将特定控制器所需的任何应用程序数据传递给控制器​​。我不确定这是否是推荐的方法，但到目前为止它对我有用。

我也查看了 TweetStation 应用程序，我发现它是一个有用的参考，但相关文档明确指出它并不是试图作为如何构建 MonoTouch 应用程序的示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-02T10:27:42.457

选项 2 更可行，因为它还可以让您对每个`DialogViewController`. 如果您想有条件地加载视图，它也会有所帮助。

# performance - TSQL：哪种实数类型导致更快的比较

> ID：10034510
> 
> 赞同：3
> 
> 时间：2012-04-05T19:06:47.157
> 
> 标签：performance, tsql, floating-point, decimal, real-datatype

TSQL 类型（MSSQL）中：real、float 和 decimal；哪种类型会导致更快的比较？

十进制会使用硬件 FPU 计算还是纯粹在软件中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-22T12:47:38.567

小数不能使用 FPU。您可以使用映射到 FPU 支持的标准 IEEE 浮点数的 float 或 real 获得最佳性能。

浮点数 = 双实数 = 单数

当然，单人更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:25:38.660

这些相对比较是 >、< 还是相等比较 =、!= ？

浮点数和实数是近似数据类型，而小数是实际表示。如果你在做平等，你会想要远离浮点数和实数。这样就剩下小数了。

SQL Server 很可能不会去 FPU 进行相关比较。FPU 和其他协处理器用于算术运算。

# c++ - C++ LNK 2019 来自不同项目但在同一个解决方案中

> ID：10034511
> 
> 赞同：0
> 
> 时间：2012-04-05T19:06:47.667
> 
> 标签：c++

我正在尝试创建一个项目来调用另一个项目，所以它应该允许我从另一个项目调用头文件，但是一旦我调用，就会出现 lnk 错误 2019。

我不明白为什么会这样。

最初我认为这是编译器的问题。但慢慢地我意识到，这个项目不能相互联系。任何可以帮助我克服问题的解决方案。

例子 ：

创建了一个日期项目（其中包含与 date.h 和 time.h 工作正常的 datetime.h 链接）创建了一个电源项目 - 仅存储浮点变量。创建了一个输入项目来存储上述两个项目的日期和功率。但是一旦我声明了一个输入输入；它有链接器问题

源代码如下.. ***Input.h***

```
#ifndef INPUT_H
#define INPUT_H
//#include "../Date/DateTime.h"
#include "../Power/Power.h"

class Input{
public:
    Input();
    //{
        /*DateTime datetime;
        SetDateTime(datetime);*/
    //}

    friend ostream& operator << (ostream &output, const Input &value);
    friend istream & operator>>( istream &input, Input &value );
    void SetPower(Power power){
        mpower = power;
    }
    Power GetPower(){
        return mpower;
    }
    //get and set method of variable DateTime
    /*void SetDateTime(DateTime datetime);
    DateTime GetDateTime();*/
private:
    string test;
    Power mpower;
    //DateTime m_datetime;
};

#endif 
```

***输入.cpp 文件***

```
ostream& operator << (ostream &output, const Input &value){
    output<<"test";
    //<<value.test;
    //output<<value.m_datetime<<endl;
    return output;
}
istream & operator>>( istream &input, Input &value ){
    //input>>value.m_datetime;
    return input;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:20:00.200

这是问题的描述（http://msdn.microsoft.com/en-us/library/799kze2z%28v=vs.100%29.aspx）“函数'function'中引用的未解析的外部符号'symbol'”

它就是这样。您需要链接实际定义符号/对象的库或实现在哪里。通常头文件仅包含声明，但链接器在编译后也需要您的实现，因为您正在引用主项目中的那些（您的主项目正在使用这些对象）。因此链接器无法链接您的代码。

在 VS2010 中，转到 Configuration Properties->Linker->General->Additional Library Directories 并指定您的库路径。然后转到 Configuration Properties->Linker->Input->Additional Dependencies 并指定 lib 的名称（Power.lib ？）

希望有帮助。让我知道这是否能解决您的问题。

# php - 公共网络服务器尝试使用私有 IP 查询内部网络上的 sqlserver

> ID：10034512
> 
> 赞同：1
> 
> 时间：2012-04-05T19:06:53.537
> 
> 标签：php, mysql, port

我正在使用 php 向现有数据库发送查询，以将现有登录凭据用于基于 Web 的程序，以允许访问成员部分页面。我的网络服务器是公共的，有一个公共 ip 和一个私人 ip。但是，我的 sql server 坐在本地局域网上，没有公共 ip。我对php很陌生，但我觉得我写得很好。当我在我的电脑上使用虚拟数据库托管网站供内部使用时，该代码的效果非常好。我在我的电脑上设置了 Apache 来运行 php 代码并设置了一个 sql 数据库用于测试目的。通过在网络浏览器中输入我的 192.168.xx，我可以访问该站点并从办公室的任何其他计算机上登录和退出。

现在该站点已移至 Web 服务器，并且我正在链接到它不想工作的另一台服务器上的活动数据库。我很确定我没有任何编码错误导致这是一个配置问题。我想知道应该在哪里打开哪些端口？现有的数据库用户是否能够从远程私有 IP 查询数据库？我意识到这可能是一个初学者的问题，但我已经四处寻找了好几天，我的大脑被炸了。在建立这种类型的连接时，我需要一份基本清单，列出要查找或设置的主要事项。

网站在 192.168.1.1 上运行，公共 IP 为 173.72.173.x
SQL DB 在 192.168.1.2 上运行
我使用“用户”和“密码”登录到 sql 服务器上的 sql 引擎，所以我使用的配置文件：

```
$server = "192.168.1.2:3306";   // server to connect to.

$database = "myusers";      // the name of the database.

$db_user = "user";      // mysql username to access the database with.

$db_pass = "password";      // mysql password to access the database with.

$table = "dbo.users";       // the table that this script will set up and use. 
```

我将它调用到需要查询任何内容的每个文件中。

那么这些设置正确吗？或者我是否需要在我的 sql 引擎上创建另一个用户才能从远程主机访问数据库？端口呢？sql server开了3306，就这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T00:40:19.440

如果您使用 MySQL（您提到了端口 3306），您很可能希望检查 MySQL 服务器上的 my.cnf 配置文件，并让它允许远程连接。

`bind-address = 127.0.0.1`只需通过在其前面放置一个哈希`#`并禁用接口绑定来快速搜索并评论它。

由于您没有指定您正在使用的操作系统，我无法确定它是否可能绑定到特定的 NIC。自己试试。

# sockets - TCP 连接上的 Solaris 10 64 位“断管”

> ID：10034513
> 
> 赞同：0
> 
> 时间：2012-04-05T19:06:59.013
> 
> 标签：sockets, solaris, pipe

我创建了一个简单的客户端/服务器 TCP 连接。

如果服务器已经在运行，并且客户端启动之后一切正常。

**问题**如果客户端在服务器之前启动 - >客户端以“Broken Pipe”退出

客户端代码：

```
 char *sUceTcpIP="127.0.0.1";
     int  isUceTcpPort=51515;

     struct sockaddr_in dest; 
     memset(&dest, 0, sizeof(dest));
     dest.sin_family = AF_INET;
     dest.sin_addr.s_addr = inet_addr(sUceTcpIP); 
     dest.sin_port = htons(isUceTcpPort);   

     while ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) <= 0) ;
     while (connect(sockfd,(struct sockaddr *) &dest,sizeof(dest)) < 0)
     { sleep(1); }
     strcpy(buffer,"sometext");
     send(sockfd,buffer,strlen(buffer)+1,0); <---- Broken Pipe 
```

*   gdb 回溯显示要从 /64/libc.so 中的 __so_send 调用的信号

*   我尝试将 NON-Blockin、Linger、Reuse、Sleeps 设置为客户端/服务器，但没有任何效果。

*   我也试过信号（SIGPIPE，SIG_IGN）；在客户端

**这似乎是一个巨大的BUG。**

任何帮助/解决方法的人？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T18:58:42.380

看来我们需要删除并重新创建套接字：

```
connect: 
while ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) <= 0) ;
if (connect(sockfd,(struct sockaddr *) &dest,sizeof(dest)) < 0)
 { 
   close(sockfd); <--- close it
   sleep(1); 
   goto connect; 
 } 
```

为什么我们需要重新创建袜子没有意义，但它可以工作。如果有人知道更多，请随意。

# sql-server - 使用 SQL Server 2008 归档生产数据库插入/更新

> ID：10034519
> 
> 赞同：0
> 
> 时间：2012-04-05T19:07:29.113
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2

我在第二个 SQL Server 实例中有一个生产数据库和一个存档数据库。

当我在生产数据库中插入或更新（NOT DELETE）数据时，我需要在存档数据库中插入或更新相同的数据。

这样做的好方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:16:43.773

如果它们在同一个数据库实例中，假设它不是很多表，那么触发器将是微不足道的。

如果它的大小增加，您可能需要研究 SQL Server 复制。微软花了很多时间和金钱来做正确的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T07:56:10.083

复制也将复制您的删除。但是，不从存档数据库中删除删除可能会导致唯一索引出现问题，其中一个值在生产数据库中有效，但在存档数据库中无效，因为这些值已经存在于那里。如果您的设计意味着这不是问题，那么生产表中的一个简单触发器将为您执行此操作：

```
CREATE TRIGGER TR_MyTable_ToArchive ON MyTable FOR INSERT, UPDATE AS
BEGIN
    SET ROW_COUNT OFF
    -- First inserts
    SET IDENTITY_INSERT ArchiveDB..MyTable ON -- Only if identity column is used
    INSERT INTO ArchiveDB..MyTable(MyTableKey, Col1, Col2, Col3, ...)
    SELECT MyTableKey, Col1, Col2, Col3, ...
    FROM inserted i LEFT JOIN deleted d ON i.MyTableKey = d.MyTableKey
    WHERE d.MyTableKey IS NULL
    SET IDENTITY_INSERT ArchiveDB..MyTable OFF -- Only if identity column is used

    -- then updates
    UPDATE t SET Col1 = i.col1, col2 = i.col2, col3 = i.col3, ...
    FROM ArchiveDB..MyTable t INNER JOIN inserted i ON t.MyTableKey = i.MyTableKey
        INNER JOIN deleted d ON i.MyTableKey = d.MyTableKey
END 
```

这假定您的存档数据库与生产数据库位于同一台服务器上。如果不是这种情况，您需要创建一个链接服务器条目，然后替换`ArchiveDB..MyTable`为`ArchiveServer.ArchiveDB..MyTable`，其中`ArchiveServer`是链接服务器的名称。

但是，如果您的生产数据库已经有很多负载，请记住，这会使负载加倍。为了避免这种情况，您可以在每个表中添加一个更新标志字段，并在数据库负载最低的时候（例如凌晨 1 点）运行计划任务。然后，您的触发器将在生产数据库中将该字段设置`I`为插入或`U`更新，计划任务将根据该字段的值在存档数据库中执行然后更新或插入，然后将该字段重置为`NULL`一次它已经完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T20:50:03.190

如果您正在考虑为此使用触发器，那么您可能需要考虑生产数据库的负载大小。如果它是非常密集的数据库，请考虑使用一些高可用性解决方案，例如复制或镜像或日志传送。根据您的需求，任何一种解决方案都可以为您服务。同时，您应该考虑您的“冷”恢复解决方案，这些解决方案需要根据您实施的内容进行更改。

# php - PHP 将数组组合成一个大数组

> ID：10034521
> 
> 赞同：3
> 
> 时间：2012-04-05T19:07:30.293
> 
> 标签：php, arrays

是否可以组合数组，并基本上将它们附加到一个大数组，如下所示：

```
$a = array(1,2,3,4);
$b = array(5,6,7,8);
$c = array(1,2,3,4); 
```

这样输出将是：

```
$result = array(1,2,3,4,5,6,7,8,1,2,3,4); 
```

这可能吗？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-05T19:08:26.830

[http://php.net/manual/en/function.array-merge.php](http://php.net/manual/en/function.array-merge.php)

```
$a = array(1,2,3,4);
$b = array(5,6,7,8);
$c = array(1,2,3,4);

$out = array_merge($a, $b, $c); 
```

结果：

```
Array
(
    [0] => 1
    [1] => 2
    [2] => 3
    [3] => 4
    [4] => 5
    [5] => 6
    [6] => 7
    [7] => 8
    [8] => 1
    [9] => 2
    [10] => 3
    [11] => 4
) 
```

# asp.net-mvc - 选择要建模的 SelectListItem

> ID：10034525
> 
> 赞同：0
> 
> 时间：2012-04-05T19:07:54.903
> 
> 标签：asp.net-mvc, asp.net-mvc-3, drop-down-menu

我有一个列表要传递给我在 ViewBag 中的视图：

```
public ActionResult ContactUs()
    {
        List<SelectListItem> reasons = new List<SelectListItem>();
        reasons.Add(new SelectListItem
        {
            Selected = true,
            Text = "Billing/Payment question",
            Value = "Billing/Payment question"
        });
        reasons.Add(new SelectListItem
        {
            Text = "Complaint",
            Value = "Complaint"
        });

        ViewBag.reasons = reasons;
        return View();
    }

[HttpPost]
public ActionResult ContactUs(ContactUs form)
{
    //some code
    return View("ContactUs");
} 
```

模型：

```
[Required]
public String Reason { get; set; } 
```

浏览：

```
@model #####.ViewModels.ContactUs
@using (Html.BeginForm("ContactUs","Home", FormMethod.Post))
{
   @Html.DropDownListFor(Model => Model.Reason,  (IEnumerable<SelectListItem>) ViewBag.reasons);
} 
```

我需要创建一个 dropdownlist ，也许 DropDownList("reasons") （应该是更好的编写方式）形成 ViewBag.reasons 并将**选定**的值作为属性 String Reason 传递给我的模型。只是对 DropDownList/DropDownListFor 的使用感到困惑。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T19:09:56.977

模型：

```
public class MyModel
{
    [Required]
    public String Reason { get; set; }
} 
```

控制器：

```
public ActionResult Index()
{
    var reasons = new List<SelectListItem>();
    reasons.Add(new SelectListItem
    {
        Selected = true,
        Text = "Billing",
        Value = "Billing"
    });
    reasons.Add(new SelectListItem
    {
        Text = "Complaint",
        Value = "Complaint"
    });
    ViewBag.reasons = reasons;
    return View(new MyModel());
} 
```

看法：

```
@model MyModel
...
@Html.DropDownListFor(
    x => x.Reason, 
    (IEnumerable<SelectListItem>)ViewBag.reasons,
    "-- select a reason --"  
) 
```

* * *

但我建议您摆脱 ViewBag 并使用真实视图模型：

```
public class MyViewModel
{
    [Required]
    public string Reason { get; set; }

    public IEnumerable<SelectListItem> Reasons { get; set; }
} 
```

然后控制器操作将填充视图模型并将其传递给视图：

```
public ActionResult MyAction()
{
    var reasons = new List<SelectListItem>();
    reasons.Add(new SelectListItem
    {
        Text = "Billing",
        Value = "Billing"
    });
    reasons.Add(new SelectListItem
    {
        Text = "Complaint",
        Value = "Complaint"
    });

    var model = new MyViewModel
    {
        // Notice how I am using the Reason property of the view model
        // to automatically preselect a given element in the list
        // instead of using the Selected property when building the list
        Reason = "Billing",
        Reasons = reasons
    };

    return View(model);
} 
```

最后在您的强类型视图中：

```
@model MyViewModel
...
@Html.DropDownListFor(
    x => x.Reason,
    Model.Reasons,
    "-- select a reason --"  
) 
```

# jquery - 即使在焦点和按键删除后如何将文本保留在文本字段中？

> ID：10034527
> 
> 赞同：0
> 
> 时间：2012-04-05T19:08:10.523
> 
> 标签：jquery, css, textbox, placeholder

我知道我可以使用`placeholder="some text here..."`，但是如何使它在按键而不是焦点时删除文本？是否可以使用 CSS 或如何使用 jQuery 来实现它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:55:25.723

如果您想要一个允许您轻松考虑任何默认文本值的通用解决方案，请考虑以下解决方案：

[http://jsfiddle.net/KM43e/](http://jsfiddle.net/KM43e/)

所有具有“填充文本”类名称的输入将默认为它们初始化的文本，如果您在字段中留下空文本，则会重置。

**JavaScript：**

```
jQuery(function ($) {

    // Removes the defualt text on key press
    function keyDown (e) {
        var input = $(e.target);

        if (input && !input.data('data-entered')) {
                input.data('data-entered', true);
                input.val("");
        }
    }

    // Restore the default text if empty on blur
    function blur(e) {
        var input = $(e.target);

        if (input && input.val() === "") {
                input.data('data-entered', false);
                input.val(input.data('blank-value'));
        }
    }

    $('.populated-text').each(function () {
        var input = $(this);
        input.data('blank-value', input.val());
        input.data('data-entered', false);
        input.keydown(keyDown);
        input.blur(blur);
    });

});​ 
```

**示例输入：**

```
<input type="text" value="Some text here..." class="populated-text">
<input type="text" value="Any default text you like" class="populated-text">
<input type="text" value="Will be used as empty" class="populated-text">​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:14:20.800

它并不完美，但这里有一个像新浏览器这样的占位符的尝试：

**JS--**

```
//when the input is clicked, select it's text so the cursor doesn't start typing in the middle of your placeholder text
​$('input').on('click', function () {

    //by selecting the input on click we mimic the focus event
    $(this).select();
}).on('keyup', function () {

    //if the input is un-touched
    if (this.value == '' || this.value == '[Your Name]') {

        //make the input in-active
        this.className = '';

        //and make sure the placeholder is still showing
        this.value = '[Your Name]';
    } else {

        //since something has been entered into the input, add the active class to make the text black
        this.className = 'active';
    }
});​​​ 
```

**CSS——**

```
input {
    color : grey;
}
​input.active {
    color : black;
}​ 
```

这使得输入默认为灰色文本，当用户输入内容时，它会变为黑色。

**HTML --**

```
​&lt;input type="text" value="[Your Name]" />​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

这是一个演示：http: [//jsfiddle.net/2VfwW/](http://jsfiddle.net/2VfwW/)

您可以将占位符添加到`placeholder`属性中，然后检查对该属性的支持，如果它不存在，您可以运行上面的代码，但首先将每个输入的值设置为`placeholder`属性的值：

```
$(function () {

    //find all input elements with a placeholder attribute
    $('input[placeholder]').val(function () {

        //set the value of this input to the value of its placeholder
        return $(this).attr('placeholder');
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:11:26.567

像下面这样的 jQuery 应该可以工作。

```
$('#myElement').keypress(function() { this.val = ''; } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:11:44.597

使用 Javacript：

```
<input type="text" onfocus="if(this.value == 'Your text'){this.value=''}" value='Your text' /> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T19:12:26.387

如果您在文本字段中有值并且只想在用户在文本字段中输入键时清除它，您可以这样做：

```
$("#myTextfield").keypress(function() {
    $(this).val("");
}); 
```

下一位检查用户是否在文本字段中输入了任何内容；如果没有，当它失去焦点时添加一个占位符。

```
$("#myTextfield").blur(function() {
    if($(this).val() === "") {
        $(this).val("Search...");
    }
}); 
```

# php - PHP'if' 跨越不同的代码块

> ID：10034533
> 
> 赞同：1
> 
> 时间：2012-04-05T19:08:46.080
> 
> 标签：php

好的，有人刚刚向我展示了一段 PHP 代码，在文件末尾我看到了一个 `<?php } ?>`. 我认为这应该会产生编译错误，但事实并非如此。

为什么是：

```
<?php
  if(1==1){
?>
X
<?php } ?> 
```

有效的？

将语句拆分为多个 php 块是否安全？

PS：我期待从答案中得到更多的东西然后“是”：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:10:15.383

是的，这很好，但我建议：

```
<?php if(1==1):?>
X
<?php endif; ?> 
```

它使它更具可读性，然后是随机`{`的`}`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:13:36.333

从[手册](http://php.net/manual/en/language.basic-syntax.phpmode.php)：

> PHP 解析器会忽略一对开始和结束标记之外的所有内容，这允许 PHP 文件具有混合内容。这允许 PHP 嵌入到 HTML 文档中，例如创建模板。

欢迎来到 PHP 的神秘世界。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:09:49.363

安全的？是的。

可读吗？并不真地。

尽可能避免将 PHP 逻辑与 HTML 混合。很少有这是一个好主意，因为它使阅读和理解您的代码变得困难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:09:52.713

是的，这很好。

对于大块 HTML，退出“php 模式”通常很有用——您会看到这种技术在 HTML 和 PHP 混合的任何地方使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T19:10:32.940

它是有效的，但`not recommended`如果你想拥有一个长期可维护和可读的代码。

您必须记住，每次从 PHP 中“退出”时，您都在输入 HTML。

# javascript - Windows 7 使用什么来呈现桌面小工具，我为什么要使用“g:”标签？

> ID：10034534
> 
> 赞同：1
> 
> 时间：2012-04-05T19:08:53.153
> 
> 标签：javascript, html, css, windows-7, windows-desktop-gadgets

这实际上是一个两部分的问题，但它们有点相关：

1.  Windows 7 如何呈现桌面小工具？我正在尝试使用 CSS 设置我的一些 HTML 元素的样式，但并非所有内容都按预期运行。我的 CSS 是由 IE 9、IE 8 呈现，还是由计算机上安装的任何最新版本的 IE 呈现？

2.  使用“g:”标签有什么意义，比如`<g:background>`or `<g:text>`？与使用 JavaScript 和 CSS 操作标准 HTML 元素相比，有什么特别的好处吗？似乎它们的全部好处是使代码的可移植性降低。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-12T11:49:13.730

它使用安装的任何版本的 IE 来呈现小工具，但是根据我的经验，它总是使用它的 IE7 兼容版本。我认为这只是因为兼容的原因。

在处理具有透明背景的小工具时`g:text`， 、 等标签非常有用。`g:background`如果您只使用纯 HTML，它们会在半透明像素上呈现洋红色伪影。他们还使用更好的字体渲染器——大概是 DirectWrite 或类似的——所以它们看起来更好。

基本上，如果你给你的小工具只使用 1 位不透明度，据我所知，没有理由使用`g:`标签。如果您的小工具需要更多，您必须使用它们。

# data-structures - 持久与不可变的数据结构

> ID：10034537
> 
> 赞同：20
> 
> 时间：2012-04-05T19:09:10.563
> 
> 标签：data-structures, immutability, object-persistence

持久和不可变的数据结构有什么区别吗？Wikipedia 在讨论持久性时指的是不可变数据结构，但我感觉两者之间可能存在细微差别。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-23T07:55:38.467

*不变性*是一种实现技术。除此之外，它还提供*持久性*，这是一个接口。持久性 API 类似于：

*   `version update(operation o, version v)``o`对 version执行操作`v`，返回一个新版本。如果数据结构是不可变的，则新版本是一个新结构（可能共享旧结构的不可变部分）。如果数据结构不是不可变的，则返回的版本可能只是一个版本号。该版本`v`仍然是有效版本，并且不应`observe`因为此更新而以任何方式更改 - 更新仅在返回的版本中可见，而不是在`v`.
*   `data observe(query q, version v)`在版本中观察数据结构`v`而不更改它或创建新版本。

有关这些差异的更多信息，请参阅：

*   [*Haim Kaplan 在Handbook on Data Structures and Applications*中的“持久数据结构”一章](http://www.math.tau.ac.il/~haimk/papers/persistent-survey.ps)
**   [Driscoll 等人的“使数据结构持久化”。](http://www.cs.cmu.edu/~sleator/papers/Persistence.htm)*   [麻省理工学院 6.851 的 2012 年春季第一讲：高级数据结构](http://courses.csail.mit.edu/6.851/spring12/lectures/L01.html)*

 ** * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-09-04T17:47:33.777

是，有一点不同。不可变数据结构在创建后不能以任何方式修改。有效修改它的唯一方法是制作一个可变副本或类似的东西（例如稍微修改您传递给新的构造函数的参数）。另一方面，持久数据结构是可变的，因为公开的 API 似乎允许对数据结构进行更改。但实际上，任何更改都将保留指向现有数据结构（以及每个先前结构）的指针；它们似乎只是改变了数据结构，因为公开的 API 返回一个新指针，该指针可能包括指向先前数据结构子集的指针（在树中，例如，我们将指向其子树未因操作）。*

# php - MySQL - 这是明智的吗？

> ID：10034538
> 
> 赞同：0
> 
> 时间：2012-04-05T19:09:21.273
> 
> 标签：php, mysql, html

我正在使用 MySQL 作为我花费数周时间的简单“社交网络”的主数据库。

与所有社交网络一样，用户需要与他们的朋友建立联系才能使其具有社交性。

我的理论是在我的`user`数据库中添加另一列并将其命名为连接。在那里，我将存储一串用逗号分隔的用户 ID，然后在需要时将它们拆分。

我的另一个理论是创建一个全新的表`connections`并使用两列“user_1”和“user_2”。然后，当搜索朋友时，数据库将执行选择以查找他们的 id 等等。

但问题是：什么是最有效的？如果我要支持大量用户，使用选项 2 是否有风险？

一些建议将不胜感激，

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T19:12:25.390

规范化结构（选项 #2）对于构建您描述的数据类型非常可取。查询具有两个整数列的窄表比拆分不断增长的 ID 列表要高效得多。

我建议阅读不同的规范化形式：[http](http://en.wikipedia.org/wiki/Database_normalization) ://en.wikipedia.org/wiki/Database_normalization （参见“规范化形式”）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:12:42.883

第二种方法要好得多。您正在使用表“连接”创建用户之间的关系。这样您就可以创建“n:m”关系。如果您想添加某种连接类型（“love interest”、“friend”），您可以轻松地将其添加到表格中，但不能添加到字符串中。

还有另一个好处：您不必考虑用户拥有的连接数。你会用什么来连接？一个`varchar`？一个`text`？你真的想每次都解析这个烂摊子吗？您如何确保不会添加两次连接？

tldr;：使用表格来显示关系。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T19:12:06.190

选项 1 不会有好的结局。去一张单独的桌子。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T19:12:16.853

毫无疑问，调用一个单独的表`connections`会更容易。在一列中有多个值违背了数据库的目的，你能想象用选项 1 搜索 user1 的所有朋友吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T19:13:24.623

MySQL 当然可以通过选项 2 提供良好的性能。选择朋友和进行计算更容易。您可以使用缓存、多台服务器、负载平衡等做很多事情。

现实地说：当您接触到大量用户时，无论如何您都将重写系统以整合您在此过程中学到的所有经验教训。

# c# - 为什么 Collection.IMongo.Save() 不会返回？

> ID：10034545
> 
> 赞同：0
> 
> 时间：2012-04-05T19:09:42.510
> 
> 标签：c#, asp.net-mvc-2, mongodb

我正在使用 MongoDB，我正在尝试保存，但它只是不返回？？

这是我的控制器：

```
public ActionResult doSomething(FormCollection collection)
        {
           if (collection == null || collection.Count == 0)
                return View(Tenant);

           var acct = new Account();

           var whitelist = new String[]{"Name"};
           TryUpdateModel(acct, whitelist, collection.ToValueProvider());

           Tenant.Name = acct.Name;

           Tenant.Save();              

           return View(Tenant);
        } 
```

这是保存方法：

```
public override void Save(){
    var acct = Application.Session.GetCollection<Account>();
     acct.Save(this);
 } 
```

当它到达 acct.Save() 行时，它永远不会返回。任何线索为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T09:59:36.890

除非您使用安全模式，否则这不会返回（嗯，返回 null），请参阅：

[http://api.mongodb.org/csharp/1.4/html/2cdf9e5b-d850-994f-c6ba-54ded02c7589.htm](http://api.mongodb.org/csharp/1.4/html/2cdf9e5b-d850-994f-c6ba-54ded02c7589.htm)

这通常是 MongoDB 的工作方式，即默认情况下使用“即发即弃”的方法进行写入/更新。如果你想让你的应用程序阻塞或等待结果，那么安全模式或写关注方法就在那里，所以你可以这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-14T16:20:31.033

问题是我试图使用 DateTime 将数据存储为 MongoObject 但 MongoDB 只有以下数据类型：

Integer（32 位有符号值） Long（64 位有符号值） Double（64 位 IEEE754 fp 值） String

[http://code.google.com/p/morphia/wiki/PropertyAnnotation](http://code.google.com/p/morphia/wiki/PropertyAnnotation)

# java - 检查服务器架构设计的客户端连接？

> ID：10034553
> 
> 赞同：0
> 
> 时间：2012-04-05T19:10:14.643
> 
> 标签：java, client, rmi

我有一台服务器和大约 150 台客户端机器。所有客户端都注册到服务器，服务器对注册的客户端进行方法调用（回调）。

在这个系统中，服务器会定期 ping 所有连接的客户端（ping 是一种回调方法）（连接活动检查）。但是，如果我在一个线程中执行所有客户端的 ping 操作。由于在不可用的客户端上等待方法调用的时间，它工作得太慢了。如果连接断开，它会等待超时发生。所以等待时间太长了。我对连接活性检查有一个新想法。
我将为每个连接的客户端创建一个线程。每个线程只会控制自己的客户端。所以所有系统连接检查都将由这些线程完成。

有用吗？

这个项目还有其他专业的offer吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:15:45.773

在检查您的客户端时，服务器充当它们的客户端，因此它实际上是双向公平正确的架构。如果您希望中央节点了解客户端状态，请通过在一定间隔内使用心跳消息轮询客户端来让客户端向服务器“问好”。一旦服务器没有收到下一个预期的心跳，客户端就被认为是死的。启动更多线程不会带来优势，反而会导致性能下降。考虑使用工作线程或某种演员模式来处理心跳。

# data-structures - 基于节点的数据结构的不变性

> ID：10034560
> 
> 赞同：0
> 
> 时间：2012-04-05T19:10:41.030
> 
> 标签：data-structures, immutability

如果想提供一个不可变的版本，例如 LinkidList，是否有任何通用的方法，使用链接的节点序列来实现？我知道在 ArrayList 的情况下，您将复制底层数组，但在这种情况下，这对我来说并不那么明显......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-27T21:04:42.027

不可变列表的表示方式基本上与常规链表相同，只是所有通常会修改列表的操作都返回一个新的。这个新列表不一定需要包含整个先前列表的副本，但可以重复使用其中的元素。

我建议通过以下方式实现以下操作：

*   在前面弹出元素：只需返回指向下一个节点的指针。复杂度：O(1)。
*   将元素推到前面：创建一个指向旧列表的第一个节点的新节点并将其返回。O(1)。
*   将列表 a 与列表 b 连接：复制整个列表 a 并让最终节点中的指针指向列表 b 的开头。请注意，这比可变列表上的相同操作要快。O（长度（a））。
*   在位置 x 插入：将所有内容复制到 x，在副本的后面添加一个带有新元素的节点，并让该节点指向位置 x + 1 处的旧列表。O(x)。
*   删除位置 x 处的元素：实际上与插入相同。牛）。
*   排序：您可以只使用普通的快速排序或合并排序。它并不比在可变列表上快得多或慢得多。唯一的区别是您不能就地排序，但必须排序到副本。O(n*log n)。

# ruby-on-rails - 呈现 JSON 响应后是否可以运行控制器方法？

> ID：10034565
> 
> 赞同：1
> 
> 时间：2012-04-05T19:10:59.807
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个类似这样的控制器方法：

```
def suggestions
  # Stuff
  render :json => {"success" => true'}
end 
```

渲染响应后是否可以运行方法？如果可能的话，我不想阻止前端。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:24:39.643

是的，该方法将继续执行直到结束。您真正需要注意的唯一问题是再次意外调用渲染。您只能调用一次渲染。

# html - 我可以使用 css 将所需属性添加到输入字段吗？

> ID：10034569
> 
> 赞同：1
> 
> 时间：2012-04-05T19:11:14.460
> 
> 标签：html, recaptcha, required-field

我的表单中有一个 recaptcha 小部件，我希望它是强制性的。因为我对我的 html 中的小部件没有任何直接控制权，所以我想知道是否可以在渲染后向它添加所需的属性。

IE。如果我添加以下 CSS

```
#recaptcha_response_field{background-color:#000000;} 
```

它确实为recaptcha 小部件文本字段着色。同样，如果有某种方法可以通过 css 为输入字段设置 required="required" 属性，我可以使其成为强制性的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:17:04.710

以下内容是否适合您：

```
$(function() {
    $("#recaptcha_response_field").attr('required','required');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:15:09.940

如果我理解正确，这应该可以解决问题：

```
$(function() {
    $("#recaptcha_response_field").css({background-color:#000000;});
}); 
```

没有 jQuery：

```
document.onload = function() {
    document.getElementById("recaptcha_response_field").style['background-color'] = '#000000';
}; 
```

我不是 100% 确定第二个，但我现在无法测试它。

# bash - 分配变量会导致 SFTP 失败

> ID：10034572
> 
> 赞同：0
> 
> 时间：2012-04-05T19:11:25.803
> 
> 标签：bash, shell, unix, sftp

我正在尝试编写一个 shell 脚本，它从文本文件中获取一组参数，然后根据这些参数执行 SFTP。基本上，我正在获取每日网络统计日志并将其移动到中心位置。

我遇到的问题是 SFTP 基于我分配变量的方式而失败。我已经调试并发现while循环通过回显变量循环可以正常工作。我得到的错误是连接已关闭。

```
#!/bin/sh
source /home/ntadmin/webstats/bin/webstats.profile
source /home/ntadmin/webstats/bin/webstats.blogs.profile

DATE=`date +%m%d%Y`

SOURCE_FILE="`echo $WS_BC_SOURCE_FILE | sed -e 's/mmddyyyy/'$DATE'/'`"

IFS="," 
while read WS_BLOG_NAME WS_BLOG_SOURCE_VAR WS_BLOG_DEST_VAR WS_BC_SERVER1;
do

#Step 1 SFTP
cd $PERL_DIR
if $PERL_DIR/sftp.pl $WS_BC_SERVER1 $WS_BC_ID $WS_BC_PW $WS_BLOG_SOURCE_VAR/$SOURCE_FILE $WS_BLOG_DEST_VAR/$SOURCE_FILE
then
 echo 'SFTP complete'
else
 echo 'SFTP failed!'
 exit 1
fi

#Step 2 - Check that ftp was successful (that the files exist)
if [ -e $WS_BLOG_DEST_VAR/$SOURCE_FILE ]
then
echo "FTP of $WS_BLOG_SOURCE_VAR/$SOURCE_FILE from $WS_BC_SERVER1 was successful"
else
echo "FTP of $WS_BLOG_SOURCE_VAR/$SOURCE_FILE from $WS_BC_SERVER1 was not successful!"
exit 1
fi

done < blogs_array.txt
exit 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T21:33:56.257

没有足够的信息来确定出了什么问题，但这里有一个调试方法。尝试用这样的调试脚本替换 perl 脚本中实际的 sftp 命令，您应该能够快速定位问题。

```
#!/usr/bin/perl
print "arguments passed to $0\n";
$i=0;
while (defined $ARGV[$i]) {
  print "arg ".($i+1)." is <$ARGV[$i++]>\n"
} 
```

# c# - 向 UI 公开数据库 ID

> ID：10034576
> 
> 赞同：6
> 
> 时间：2012-04-05T19:11:53.290
> 
> 标签：c#, sql, asp.net-mvc-3, design-patterns

这是针对数据形式的网络表单的初学者模式问题。我阅读了[暴露数据库 ID - 安全风险？](https://stackoverflow.com/questions/396164/exposing-database-ids-security-risk)并且接受的答案让我认为这是浪费时间，但是等等......

我有一个引用业务逻辑库的 MVC 项目，以及引用相同的 NHibernate SQL 存储库的程序集。如果有什么东西迫使我直接从我的控制器代码库中引用这些存储库，我就会知道出了什么问题。但是当这些控制器在 URL 参数中与数据库记录 ID 交谈时，它只是*看起来*是错误的吗？

我无法想象那些 ID 会变得无法使用（通过 MVC 操作）。我*认为*我不需要两个 UI 实体对应于数据库中的同一行。我不打算让控制器以任何方式解释 ID。代理键将产生零差异。尽管如此，我还是想解决这个问题，因为关于理性设计的假设并不比跳层依赖更好。

*您将如何制作一个仅引用业务逻辑程序集并在 BL 对象和仅对该会话有意义的 GUID 中进行对话的 Web 应用程序，而该程序集使用数据库 ID 保留事务？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T19:25:44.357

我不是安全专家，但我可以向用户公开某些 ID，例如产品 ID、用户 ID 以及用户通常可以阅读的任何内容，这意味着如果我向用户展示产品，则显示其产品身份证不是问题。

用户不直接与之交互的系统内部的东西，比如事务 ID，我不向用户显示，不是害怕他们以某种方式编辑它，而是因为那不是对他们有用的信息。

通常在表单中，我会将操作点指向“mysite.com/messages/view/5”，其中 5 是他们想要查看的消息。在**所有**这些操作中，我始终通过执行简单的数据库检查并确保登录用户等于消息所有者来确保用户有权查看它（修改或删除，需要任何功能）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T21:11:16.153

如果需要，您可以加密或散列您的 id。使用会话 ID 作为盐。这取决于上下文。您希望目录页面清晰且易于复制的公共购物网站。用户帐户管理员可以对 id 进行加密，因此用户无法通过 url 入侵他人的帐户。

我不认为这是默默无闻的安全。如果恶意用户拥有一个被盗用的帐户，他们可以查看以该用户身份登录时设置的所有表单字段、url id 和 cookie 值。然后，他们可以在以其他用户身份登录时尝试使用这些来升级权限。但是通过使用会话 ID 作为盐来保护它们，您已经锁定了该数据，因此它仅在一个会话中有用。这些页面甚至无法添加书签。他们能弄清楚你的保护措施吗？可能。但很可能他们只是转移到另一个站点。如果有人想上车，锁上你的车门实际上并不能阻止任何人进入你的车，但它会让事情变得更难，所以每个人都这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T20:01:36.283

要非常非常小心，因为参数篡改会导致数据修改。在公开这些 id 时，必须非常小心地将关于“谁可以访问哪些 id”的规则构建到您的应用程序中。

例如，如果您要根据 OrderId 更新订单，请在 where 子句中包含用于加载和更新的内容： where order.orderid=passedInOrderId 和 Order.CustomerId=

我开发了一个扩展来帮助在 MVC 中存储 id 可用这里：

[http://mvcsecurity.codeplex.com/](http://mvcsecurity.codeplex.com/)

我还在我的安全课程中谈到了这一点：[Hack Proofing your ASP.NET MVC and Web Forms Applications](http://pluralsight-training.net/microsoft/Courses/TableOfContents?courseName=hack-proofing-dotnet-app)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T22:42:51.900

除了这些响应之外，有时最好使用明显的 id，这样人们就可以破解 url 以获得他们想要的信息。例如，www.music.com\artist\acdc 或 www.music.com\arist\smashing-pumpkins。如果它对您的用户有意义，并且如果您可以通过 URL 增加用户从页面中理解的信息，那就更好了，特别是如果您的细分市场年轻或精通技术，那么使用 id 对您有利。这也将提高您的搜索引擎优化。我会说当它没有用时，然后对其进行编码。一个开发人员只需要一个错误就不会根据会话检查客户 ID，并且您会暴露整个客户群。

但是，当然，您的单元测试应该抓住这一点！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T19:46:18.450

虽然您会发现有些人说 ID 只是一个实现细节，但在大多数系统中，您需要一种唯一标识域实体的方法，并且您很可能会为该标识符生成一个 ID。*ID由数据库生成*的事实是一个实现细节；但是一旦生成，它就成为域实体的属性，因此在需要引用实体的任何地方使用它是完全合理的。

# wix - Wix - 从浏览对话框获取信息以显示在编辑（不是路径编辑）框中？

> ID：10034583
> 
> 赞同：0
> 
> 时间：2012-04-05T19:12:23.837
> 
> 标签：wix, windows-installer

我正在构建一个安装程序，其中给定页面要求目录。不幸的是，我不允许（客户）将初始值强制输入条目（它必须为空白），因此使用 PathEdit 已被淘汰——我必须使用原始编辑控件。我添加了一个调用 BrowseDlg 的浏览按钮，但问题是：如何显示在浏览对话框中输入的值？

我已经看到了复制原始页面的建议，因为我无法更新初始页面上的原始文本框。虽然这似乎可行，但我怎样才能获得该页面的第二个副本？打开浏览对话框的按钮调用 SpawnDialog。将其作为 NewDialog 执行看起来真的很俗气，并且与在安装位置使用 Browse 对话框不匹配，它只是弹出的位置。但是当 SpawnDialog 返回时，它只是停留在同一页面上。没有任何条件可以让我添加一个 NewDialog 以转到第二页或任何其他页面。

关于如何继续的任何想法，以便我可以显示输入的浏览值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T21:41:01.173

我建议使用类似于这篇文章的自定义操作和编辑框。您可以使用 FolderBrowserDialog 而不是 OpenFileDialog。它对我有用，但在第二次安装时，该字段将填充以前的值。

[http://community.saasgrid.com/developers/b/team/archive/2011/02/17/wix-managed-custom-actions-openfiledialog-example.aspx](http://community.saasgrid.com/developers/b/team/archive/2011/02/17/wix-managed-custom-actions-openfiledialog-example.aspx)

# c# - 为什么 "\n" 在 Windows 上换行？

> ID：10034585
> 
> 赞同：29
> 
> 时间：2012-04-05T19:12:26.077
> 
> 标签：c#, .net, windows, newline

Windows 上的换行标记应该是`CR+LF`，而在 Unix 上，它只是`LF`.

所以当我使用类似的东西时`Console.Write("line1\nline2");`，为什么它会“正常”工作并给我两条线？我希望这`\n`不起作用，并且只有一个组合`\r\n`会起作用。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-04-05T19:15:00.250

`'\n'`是换行符。传统上，它会导致打印机将纸张卷起一行。`'\r'`是回车字符，传统上它会导致打印头移动到纸张的最左边缘。

在以这种方式解释字符的打印机和控制台上，输出`line1\nline2`将是

```
line1
     line2 
```

许多控制台（和编辑器）会将 '\n' 解释为您要开始一个新行*并将*光标定位在该新行的开头。这就是你在这里看到的。

您应该使用[Environment.NewLine](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)而不是硬编码任何特定的常量。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-05T19:55:49.973

这只是底层 Windows 控制台的标准行为。`0x0A`如果您输出到控制台，本机 C 应用程序将执行完全相同的操作。

当然，你应该使用[`Environment.NewLine`](http://msdn.microsoft.com/en-us/library/system.environment.newline.aspx)你的新线路。在 Windows 和类 Unix 系统上`Environment.NewLine`解析为。`\r\n``\n`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T19:15:16.810

文件编码！=`Console`解释。

换句话说，虽然`CR`+的“Windows 标准”`LF`存在于文件中，但只有`LF`, or`\n`已经在控制台窗口中产生了适当的回车和换行解释。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-08-26T00:07:10.520

我迟到了很多年。但是，[https:](https://en.wikipedia.org/wiki/Newline) //en.wikipedia.org/wiki/Newline 很好地解释了 NEWLINE 转义序列如何在编程语言和文本/二进制输出的上下文中工作。

归根结底 - 大多数编程语言在编写文本时将“\n”翻译成本机平台的 NEWLINE 序列。并且，在阅读文本时将原生平台的 NEWLINE 序列翻译成“\n”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T19:23:58.407

根据我的经验，当您使用 WriteLine() 输出到控制台时，它接受 \n 转义字符。当您使用 StreamWriter 并调用 WriteLine() 时，它会让您键入 \r\n 以移动到新行。我假设控制台已被编程为接受 \n 转义字符而没有回车 \r。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-05T19:23:22.760

\n 是换行符。在 *nix 和 Windows 系统上，它应该创建 2 行。\r 是回车，它将书写工具移动到行首。

大多数现代控制台/编辑器都具有足够的弹性，可以将 \n 解释为 \r\n

# java - 为什么内部类构造函数中的外部类对象的 LocalVariableTable 中没有条目（Java 字节码）

> ID：10034588
> 
> 赞同：1
> 
> 时间：2012-04-05T19:12:31.923
> 
> 标签：java, compiler-construction, jvm, bytecode, inner-classes

Step1：我编译了以下代码：

```
public class OuterClass {
class InnerClass{

    }
} 
```

我有 OuterClass.class 和 OterClass$InnerClass.class

Step2：我使用javap检查内部类的字节码。很奇怪，构造方法使用了“1:aload_1”，但是在LocalVariableTable中，只有一个“this”的入口可以被aload_0访问。我假设 aload_1 是将传入参数（外部类对象的引用）加载到堆栈顶部。

我的问题：为什么编译器不为其创建一个条目（传递给构造函数的外部类的引用）？

我尝试使用 Jsdk 1.4 和 openjdk 1.6。

```
~$ javap -v -c OuterClass\$InnerClass
Compiled from "OuterClass.java"
class OuterClass$InnerClass extends java.lang.Object
  SourceFile: "OuterClass.java"
  InnerClass: 
   #24= #1 of #22; //InnerClass=class OuterClass$InnerClass of class OuterClass
  minor version: 0
  major version: 50
  Constant pool:
const #1 = class    #2; //  OuterClass$InnerClass
const #2 = Asciz    OuterClass$InnerClass;
const #3 = class    #4; //  java/lang/Object
const #4 = Asciz    java/lang/Object;
const #5 = Asciz    this$0;
const #6 = Asciz    LOuterClass;;
const #7 = Asciz    <init>;
const #8 = Asciz    (LOuterClass;)V;
const #9 = Asciz    Code;
const #10 = Field   #1.#11; //  OuterClass$InnerClass.this$0:LOuterClass;
const #11 = NameAndType #5:#6;//  this$0:LOuterClass;
const #12 = Method  #3.#13; //  java/lang/Object."<init>":()V
const #13 = NameAndType #7:#14;//  "<init>":()V
const #14 = Asciz   ()V;
const #15 = Asciz   LineNumberTable;
const #16 = Asciz   LocalVariableTable;
const #17 = Asciz   this;
const #18 = Asciz   LOuterClass$InnerClass;;
const #19 = Asciz   SourceFile;
const #20 = Asciz   OuterClass.java;
const #21 = Asciz   InnerClasses;
const #22 = class   #23;    //  OuterClass
const #23 = Asciz   OuterClass;
const #24 = Asciz   InnerClass;

{
final OuterClass this$0;

OuterClass$InnerClass(OuterClass);
  Code:
   Stack=2, Locals=2, Args_size=2
   0:   aload_0
   1:   aload_1
   2:   putfield    #10; //Field this$0:LOuterClass;
   5:   aload_0
   6:   invokespecial   #12; //Method java/lang/Object."<init>":()V
   9:   return
  LineNumberTable: 
   line 3: 0

  LocalVariableTable: 
   Start  Length  Slot  Name   Signature
   0      10      0    this       LOuterClass$InnerClass;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T13:08:00.357

这`LocalVariableTable`纯粹是出于调试目的 - 它对执行没有影响。因此，它只包括源可见变量，因为这是调试器感兴趣的。没有理由包括编译器生成的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:17:55.093

我认为这只是因为它不需要局部变量表中的条目，因为它是一个不需要以任何其他方式引用的参数，而不是作为参数。

# iphone - 使用自定义 segue 动画将一个视图替换为另一个视图？

> ID：10034593
> 
> 赞同：1
> 
> 时间：2012-04-05T19:12:54.563
> 
> 标签：iphone, ios, cocoa-touch, uistoryboardsegue

我正在尝试实现 SUBJ，但无法使目标转场出现在我的动画中。我想为视图更改制作动画，其中新的 segue 将取代旧的。目前我的执行方法如下所示：

```
- (void) perform {

UIViewController *src = (UIViewController *) self.sourceViewController;
UIViewController *dst = (UIViewController *) self.destinationViewController;

[UIView animateWithDuration:2.0
                 animations:^{

                 //tried a lot of staff to make dst view to fall from top at the same time as current view falling to bottom but failed. 

                 src.view.transform=CGAffineTransformMakeTranslation(0, 480);
                 }
                 completion:^(BOOL finished){ 
                     [[self sourceViewController] presentModalViewController:[self destinationViewController] animated:NO];
                 }
    ];
} 
```

任何想法如何添加到我的动画块从顶部出现的新视图？

非常感谢！

编辑：

```
- (void) perform {

    UIViewController *src = (UIViewController *) self.sourceViewController;
    UIViewController *dst = (UIViewController *) self.destinationViewController;

    src.view.transform = CGAffineTransformMakeTranslation(0, 0);
    dst.view.transform = CGAffineTransformMakeTranslation(0, -480);

    [UIView animateWithDuration:2.0
                 animations:^{
                         [src.view addSubview:dst.view];
                         src.view.transform = CGAffineTransformMakeTranslation(0, 460);

                     }
                     completion:^(BOOL finished){ 
                         [src presentModalViewController:dst animated:NO];
                     }
     ];

} 
```

这就是我最后的做法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:25:51.517

我不太明白你所说的新旧是什么意思，所以我假设新 = dst 和旧 = src。

```
- (void) perform {

   UIViewController *src = (UIViewController *) self.sourceViewController;
   UIViewController *dst = (UIViewController *) self.destinationViewController;

   src.view.transform = CGAffineTransformMakeTranslation(0, 0);
   dst.view.transform = CGAffineTransformMakeTranslation(0, -480);

   [UIView animateWithDuration:2.0
                 animations:^{
                     [src presentModalViewController:dst animated:NO];
                     src.view.transform = CGAffineTransformMakeTranslation(0, 480);
                     dst.view.transform = CGAffineTransformMakeTranslation(0, 0);
                 }
   ];
} 
```

这应该这样做。

# c++ - 使用 swig 将 Iterable C++ 类传递给 Python

> ID：10034595
> 
> 赞同：1
> 
> 时间：2012-04-05T19:13:02.090
> 
> 标签：c++, python, iterator, swig

我尝试实现一个应该是可迭代的 C++ 类。到目前为止，我已经写了这个：

```
class XYByFrameIterator {
 public:
  XYByFrameIterator(vector<xy>& precalc) :_precalc(precalc), _current(precalc.begin()), _end(precalc.end()) {}

  XYByFrameIterator* __iter__() { cout << "__iter__" << endl; return this;}

  xy& next() throw (Stop_Iteration) {
    if (_current == _end)
      throw Stop_Iteration();
    xy& ret = *_current;
    _current++;
    return ret; 
  }

 private:
  vector<xy>& _precalc;
  vector<xy>::iterator _current;
  vector<xy>::iterator _end;
}; 
```

要将我的自定义 C++`Stop_Iteration`异常转换为 Python`StopIteration`异常，我将其添加到 swig 接口文件中：

```
%typemap(throws) Stop_Iteration %{
  PyErr_SetNone(PyExc_StopIteration);
  SWIG_fail;
%} 
```

但不幸的是，这只在某些情况下有效。例如，以下 python 代码按预期打印 x/y 值。

```
it = fa.xyByFrameIterator(43)
for xy in it:
    print(xy.x)
    print(xy.y) 
```

但是，如果我直接在循环中实例化迭代器，它就会崩溃：

```
for xy in fa.xyByFrameIterator(43):
    print(xy.x)
    print(xy.y) 
```

输出：

```
__iter__
44.2233009338
5.83165979385
segmentation fault 
```

**更新：**

[阅读此答案](http://permalink.gmane.org/gmane.comp.programming.swig/9949)后，我找到了解决方案。我认为该`__iter__`方法在传递给 Python 后有问题。现在我`__iter__`通过 swig 接口文件直接在 Python 代码中插入。现在看起来像这样：

```
%typemap(throws) Stop_Iteration %{
  PyErr_SetNone(PyExc_StopIteration);
  SWIG_fail;
%}
%extend XYByFrameIterator
{
%insert("python") %{
    def __iter__(self):
        return self
%}
} 
```

还有我的 C++ 代码：

```
class XYByFrameIterator {
 public:
  XYByFrameIterator(vector<xy>& precalc) :_precalc(precalc), _current(precalc.begin()), _end(precalc.end()) {}
  xy& next() throw (Stop_Iteration) {
    if (_current == _end)
      throw Stop_Iteration();
    xy& ret = *_current;
    _current++;
    return ret; 
  }

 private:
  vector<xy>& _precalc;
  vector<xy>::iterator _current;
  vector<xy>::iterator _end;
}; 
```

这项工作很安静，但我更喜欢 swig 接口文件中的每个迭代器类没有（或更少）代码的解决方案。

# c# - 无法连接到 ftp：(407) 需要代理身份验证

> ID：10034596
> 
> 赞同：0
> 
> 时间：2012-04-05T19:13:07.467
> 
> 标签：c#, .net, ftp

我需要连接到一个 ftp 并从中下载一个文件，但我无法连接到它。我已经指定了凭据并且能够通过我的浏览器进行连接，但不能通过 .NET。

```
 FtpWebRequest downloadRequest = (FtpWebRequest)WebRequest.Create(ftpSite + "/" + TOC);
        downloadRequest.Method = WebRequestMethods.Ftp.DownloadFile;
        downloadRequest.Credentials = new NetworkCredential(userName, pass);
        FtpWebResponse response = (FtpWebResponse)downloadRequest.GetResponse(); //execption thrown here
        Stream responseStream = response.GetResponseStream();
        StreamReader reader = new StreamReader(responseStream);

        reader.ReadLine();

        while (!reader.EndOfStream)
            data.Add(reader.ReadLine());

        reader.Close(); 
```

它会抛出`WebException`407 错误，我不太清楚为什么。我的老板也很困惑。有什么见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:19:22.930

您是否尝试使用命令行 FTP 客户端来执行此操作？

我希望您收到的错误消息已经解释了问题 - 您位于应用程序级防火墙后面，需要您使用代理进行身份验证。您的浏览器可能已经配置为执行此操作。请咨询您的网络管理员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:20:01.747

您很可能正坐在需要身份验证的 FTP 代理后面。

尝试初始化

```
downloadRequest.Proxy 
```

使用适当的代理凭据，例如

```
WebProxy proxy = new WebProxy("http://proxy:80/", true); 
proxy.Credentials = new NetworkCredential("userId", "password", "Domain"); 
downloadRequest.Proxy = proxy; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-02T23:09:54.907

将`<defaultProxy />`元素放入 app.config / web.config 下`<system.net>`的 with`useDefaultCredentials="true"`可能会有所帮助。根据您的网络设置，这可能会避免您需要在应用程序中硬编码代理帐户详细信息。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.net>
    <defaultProxy useDefaultCredentials="true" />
  </system.net>
</configuration> 
```

# jquery - 需要在 PhoneGap (Cordova) 项目中手动刷新 Admob 广告

> ID：10034597
> 
> 赞同：1
> 
> 时间：2012-04-05T19:13:07.597
> 
> 标签：jquery, jquery-mobile, cordova, admob

我正在使用 PhoneGap + jquery mobile 构建一个简单的内容应用程序。我的 AdMob 横幅位于每个页面的底部。广告正确显示，但我需要它们在用户在页面之间来回切换时更新/刷新。因为我使用的是 jqm 的 ajax 转换，所以页面被缓存，并且脚本永远不会重新加载。我还尝试在 AdMob 管理选项中找到一个选项来设置刷新频率，但如果我使用的是网站嵌入代码，它似乎不存在。

我试过这个：

```
var admobscript = '<script type="text/javascript" src="http://mmv.admob.com/static/iphone/iadmob.js"><\/script>';
$('#admobbanner').html(admobscript); 
```

但没有运气。无论如何，这感觉像是一个丑陋的解决方案，我觉得我错过了一些更优雅的东西。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:37:46.200

如果您通读[文档](http://support.google.com/admob/bin/answer.py?hl=en&answer=1704625)，他们会提供一些获取广告的方法：

您可以执行以下操作：

```
_admob.fetchAd(document.getElementById('admobbanner')); 
```

或者您可以将广告存储在 iframe 中并像这样刷新它：

```
<iframe id="admob_ad" style="position: absolute; width: 320px; height: 48px; left: 0px; top: 0px;" noresize="noresize" frameborder="0" src="http://your_site.com/your_admob_web_page.html"></iframe>

<script>
   ...
   // refresh the IFRAME where you want to display a new ad
   var adIframeEl = document.getElementById("admob_ad");

   adIframeEl.src = adIframeEl.src;
   ...
</script> 
```

# java - 单击android应用程序后访问ArrayList

> ID：10034603
> 
> 赞同：0
> 
> 时间：2012-04-05T19:13:26.227
> 
> 标签：java, android, arraylist, onclicklistener

我目前正在尝试在 android 中创建一个 3d 游戏，但我正在努力解决一些问题。

在我的游戏中单击方向按钮后的某个时间点，我尝试访问一个 ArrayList，但我的 ArrayList（之前填充的）似乎现在是空的。

那是线程问题吗？

```
@Override 
public void Update(ArrayList<ArrayList<IModel>> Database) {
    this.DataBase = Database;
    System.out.println("---> " + this.DataBase.get(0));  //WORKING                             
}

Button up_btn = (Button) findViewById(R.joystick.up);
up_btn.setOnClickListener(new View.OnClickListener() {
    @Override public void onClick(View v) {
        System.out.println("--------->" + DataBase.get(0)); //NOT WORKING   
    }
}); 
```

这是我的整个代码；

```
 public class PlayerController extends Activity implements IController
 {
//Properties

private ArrayList<ArrayList<IModel>> DataBase = null;
private GLSurfaceView mGLView;

//Virtual

@Override public void Update(ArrayList<ArrayList<IModel>> Database)
{
    this.DataBase = Database;
    System.out.println("---> " + this.DataBase.get(0));                             //WORKING
}

@Override protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    this.mGLView = new MySurfaceView(this);

    LayoutInflater inflater = getLayoutInflater();
    this.getWindow().addContentView(this.mGLView, new ViewGroup
            .LayoutParams(ViewGroup.LayoutParams.FILL_PARENT,
            ViewGroup.LayoutParams.FILL_PARENT));
    this.getWindow().addContentView(inflater.inflate(R.layout.footer, null), new ViewGroup
            .LayoutParams(ViewGroup.LayoutParams.FILL_PARENT,
            ViewGroup.LayoutParams.FILL_PARENT));
    this.getWindow().addContentView(inflater.inflate(R.layout.play, null), new ViewGroup
            .LayoutParams(ViewGroup.LayoutParams.FILL_PARENT, (int)80));

    //Joystick buttons

    Button up_btn = (Button) findViewById(R.joystick.up);
    up_btn.setOnClickListener(new View.OnClickListener()
    {
        @Override public void onClick(View v)
        {
            System.out.println(">>>>>" + DataBase.get(0));           //NOT WORKING..
            //UpMotionListener();
        }
    });

}

@Override protected void onPause()
{
    super.onPause();
    mGLView.onPause();
}

@Override protected void onResume()
{
    super.onResume();
    mGLView.onResume();
}

public void UpMotionListener()
{
    //System.out.println(">>>>>>>>>" + DataBase.get(0));                //NOT WORKING
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:15:32.503

`this`第二种情况是 的实例`OnClickListener`，因此您需要完全限定它，或者完全删除它`this`，例如：

```
EnclosingClass.this.dataBase.get(0); 
```

或者

```
dataBase.get(0); 
```

请注意，我以小写开始变量名，以匹配 Java 的命名约定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:36:03.907

在调用 Update 和 onClick 之间是否有其他东西正在修改/清除 ArrayList？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:25:55.493

好吧，实际上你的问题是你不懂 Java 语言，但是这是可以解决的。以下是您缺少的特定知识的快速概述：[http ://www.oursland.net/tutorials/java/innerclasses/](http://www.oursland.net/tutorials/java/innerclasses/)

现在，直接回答您的问题：

尝试在没有“this”的情况下引用数据库。在它面前。

new View.OnClickListener() 中的 this.DataBase.get(0) 指的是当您说 new OnClickListener 时创建的匿名内部类，而不是您创建数据库成员的实例类。当您使用“this”时，您说的是*此类*，并且由于 this 在您的侦听器内部，它指的是内联创建的类，并且“数据库”成员变量超出范围。

# xpath - xpath 选择第一个表

> ID：10034613
> 
> 赞同：5
> 
> 时间：2012-04-05T19:14:21.073
> 
> 标签：xpath, mechanize

我有 xpath

```
page.search("//table[@class='campaign']//table") 
```

它返回两个表。

我只需要选择第一张桌子。此行不起作用：

```
page.search("//table[@class='campaign']//table[1]") 
```

如何只选择第一张桌子？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-05T19:17:18.313

这也困扰着我。我仍然不完全知道为什么您的解决方案不起作用。但是，这应该：

```
page.search("//table[@class='campaign']/descendant::table[1]") 
```

**编辑**：正如[文档](http://www.w3.org/TR/xpath/)所说，

> “位置路径与位置路径`//para[1]`的含义不同`/descendant::para[1]`。后者选择第一个后代para元素；前者选择其父母的第一个para子元素的所有后代para元素。”

多亏了你的问题，我终于明白为什么会这样了:)。因此，根据您的结构和需求，这应该可行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-25T22:12:23.283

除了使用 XPath 表达式来选择第一个匹配元素，您还可以找到所有这些元素，然后将其删减：

```
first_table = page.search("//table[@class='campaign']//table").first 
```

...或者更好的是，使用仅选择第一个[`at`](http://mechanize.rubyforge.org/Mechanize/Page.html#method-i-at)：

```
first_table = page.at("//table[@class='campaign']//table") 
```

另请注意，使用 CSS 选择器语法可以更简单地找到您的表达式：

```
first_table = page.at("table.campaign table") 
```

# android - 更新 XML 文件

> ID：10034617
> 
> 赞同：0
> 
> 时间：2012-04-05T19:14:41.353
> 
> 标签：android, xml

我有一个可以打开和解析的文件，其中一些类别可以修改。我想知道如何使用新值更新原始 Xml 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T23:05:54.153

我假设 XML 文件是一个普通的顺序文件。如果是这样，您可以*尝试*只更新一个标签，但重写整个文件会更容易、更安全。

# css - Dreamweaver 显示具有额外垂直空间的 div

> ID：10034618
> 
> 赞同：0
> 
> 时间：2012-04-05T19:14:52.917
> 
> 标签：css, dreamweaver

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Test</title>

<link href="tester.css" rel="stylesheet" type="text/css" />
</head>

<body>
<div class="tray">  
    <div class="tray_header">THIS IS A HEADER</div>
    <div class="container">
        <div class="red_line"></div>
        <div class="text_1">THIS IS THE FIRST LINE OF TEXT</div>
        <div class="text_1">THIS IS THE SECOND LINE OF TEXT</div>
    </div>
</div>
</body>
</html> 
```

你好！首先，这不是与浏览器相关的问题。当您在 Dreamweaver 中打开它时，第二行和第三行文本会在红线下方向下移动大约 20 像素左右。

问题是他们不应该。它们应该藏在红线的正下方。

现在这就是它变得奇怪的地方——如果你在任何浏览器中查看它，它就是这样做的——位于红线下方（根据需要）。

通常我只会说搞砸了，它是 Dreamweaver 错误或其他什么。然而，在真正的文档中（我已经剥离了代码并且只包含了最基本的必需品，因此可以在没有所有其他项目妨碍的情况下查看它）有更多的文本行，它们之间有红线分隔符，所以他们只是不断地在布局中添加越来越多的垂直空间，并且很难看到页面上的其他项目。

我已经完成并在所有规则上添加了零填充和边距，认为这可能存在一些问题，但无济于事。

有趣的是，如果您删除红色的 div 行，下面的文本会弹出它应该在的位置（如预期的那样）。

有任何想法吗？

下面是文档的 CSS：

```
body {
width:      100%;
height:     100%;
margin:     0 auto;
padding:    0;
background-color:   #900;
font-family:    Arial, Helvetica, sans-serif;
}

.tray {
width:      290px;
margin:     120px auto 0;
padding:    0;
position:   relative;
}

.tray_header {
width:      290px;
height:     28px;
margin:     0;
padding:    0;
position:   relative;
color:      #FFFFFF;
font-size:  20px;
text-shadow:    0px 2px 2px #000;
text-align: center; 
}

.container {
width:      290px;
margin:     0;
padding:    0;
position:   relative;
}

.red_line {
width:      252px;
height:     2px;
background-color:   #CB0000;
margin:     6px 18px;
padding:    0;
position:   relative;
}

.text_1 {
width:      252px;
margin:     0 0 0 18px;
padding:    0;
position:   relative;
color:      #FFFFFF;
font-size:  15px;   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T03:24:29.730

Dreamweaver 的设计视图（以及与此相关的实时视图）包含奇怪的 CSS 呈现错误，不应被视为“真实”视图。由于受限的工作空间、隐藏元素图标的存在或只是单纯的怪异，在浏览器中看起来非常完美的东西在设计视图中可能看起来“关闭”。更改代码以使其在设计视图中工作不是很好地利用时间并且可能会破坏事情。

简而言之，始终使用浏览器进行测试。如果那里看起来不错，那么你就准备好了。

# nservicebus - 与 nservicebus 集成

> ID：10034627
> 
> 赞同：0
> 
> 时间：2012-04-05T19:16:01.923
> 
> 标签：nservicebus

我需要将 .net2.0 应用程序与 nservicebus 集成。实际上，我只需要这个 .net2.0 向 nservicebus 队列发送消息。

我应该自己创建它吗？有什么我应该注意的技巧，所以当我升级到 nservicebus4 时，它不会坏掉吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T21:34:45.943

using .net 2.0 will be a problem with trying to reference nservicebus. i don't think there is any straightforward way to reference nservicebus from a 2.0 application (outside of using a very old version, which would have problems too).

the shortest path would probably be to upgrade the framework version to 4.0\. why not just do this? if you're talking about making changes and sending messages, you must have access to the source code and the ability to change it.

next after that might be to serialize a message yourself and send it with system.messaging. i think this is what you mean by "create it by myself." you'd definitely want to test that your messages still work if updating to another version of nservicebus on the handling side. udi is insistent on backward compatibility in updating versions of software, so i'd expect nservicebus would exhibit this probably and that your messages would still work, but you would want to make sure.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-07T13:46:40.353

要将应用程序与 NServiceBus “集成”，只需在您的解决方案中包含对*NServiceBus.dll*、*NServiceBus.Core.dll*和*NServiceBus.Host.exe*的二进制引用。

尝试下载[示例](http://docs.particular.net/samples/)。

# postgresql - PostgreSQL经纬度查询

> ID：10034636
> 
> 赞同：32
> 
> 时间：2012-04-05T19:16:26.380
> 
> 标签：postgresql, postgis

我在 PostgreSQL 数据库的表中有`latitude`列`longitude`，`location`我正在尝试使用 PostgreSQL 函数执行距离查询。

我阅读了手册的这一章：

[https://www.postgresql.org/docs/current/static/earthdistance.html](https://www.postgresql.org/docs/current/static/earthdistance.html)

但我想我在那里遗漏了一些东西。

我该怎么做？是否有更多可用示例

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2014-08-05T13:49:22.487

这是使用点运算符的另一个示例：

**初始设置**（只需运行一次）：

```
create extension cube;
create extension earthdistance; 
```

然后是查询：

```
select (point(-0.1277,51.5073) <@> point(-74.006,40.7144)) as distance;

     distance     
------------------
 3461.10547602474
(1 row) 
```

请注意，它`points`是使用**LONGITUDE FIRST**创建的。根据[文档](http://www.postgresql.org/docs/current/static/earthdistance.html)：

> 点被视为（经度，纬度）而不是反之亦然，因为经度更接近 x 轴的直观概念，纬度更接近 y 轴。

这是糟糕的设计......但就是这样。

您的输出将以**英里**为单位。

> 给出地球表面上两点之间的法定英里距离。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-04-05T19:37:52.853

此模块是可选的，未安装在默认的 PostgreSQL 安装中。您必须从 contrib 目录安装它。

您可以使用以下函数来计算坐标之间的近似距离（以英里为单位）：

```
 CREATE OR REPLACE FUNCTION distance(lat1 FLOAT, lon1 FLOAT, lat2 FLOAT, lon2 FLOAT) RETURNS FLOAT AS $$
DECLARE                                                   
    x float = 69.1 * (lat2 - lat1);                           
    y float = 69.1 * (lon2 - lon1) * cos(lat1 / 57.3);        
BEGIN                                                     
    RETURN sqrt(x * x + y * y);                               
END  
$$ LANGUAGE plpgsql; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-03-21T18:27:18.397

[使用Haversine 公式](http://www.movable-type.co.uk/scripts/latlong.html "Haversine formula")的@strkol 答案的更准确版本

```
CREATE OR REPLACE FUNCTION distance(
    lat1 double precision,
    lon1 double precision,
    lat2 double precision,
    lon2 double precision)
  RETURNS double precision AS
$BODY$
DECLARE
    R integer = 6371e3; -- Meters
    rad double precision = 0.01745329252;

    φ1 double precision = lat1 * rad;
    φ2 double precision = lat2 * rad;
    Δφ double precision = (lat2-lat1) * rad;
    Δλ double precision = (lon2-lon1) * rad;

    a double precision = sin(Δφ/2) * sin(Δφ/2) + cos(φ1) * cos(φ2) * sin(Δλ/2) * sin(Δλ/2);
    c double precision = 2 * atan2(sqrt(a), sqrt(1-a));    
BEGIN                                                     
    RETURN R * c;        
END  
$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100; 
```

输入以度为单位（例如 52.34273489、6.23847），输出以米为单位。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-04-05T20:10:38.560

假设您已正确安装 earthdistance 模块，这将为您提供两个城市之间的英里距离。此方法使用更简单的基于点的地球距离。请注意，point() 的参数首先是经度，然后是纬度。

```
create table lat_lon (
  city varchar(50) primary key,
  lat float8 not null,
  lon float8 not null
);

insert into lat_lon values
('London, GB', 51.67234320, 0.14787970),
('New York, NY', 40.91524130, -73.7002720);

select 
  (
  (select point(lon,lat) from lat_lon where city = 'London, GB') <@>
  (select point(lon,lat) from lat_lon where city = 'New York, NY')
  ) as distance_miles

distance_miles
--
3447.58672105301 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-22T05:14:16.263

另一种 Haversine 公式，返回里程。（[来源](https://gist.github.com/carlzulauf/1724506)）

```
CREATE OR REPLACE FUNCTION public.geodistance(
    latitude1 double precision,
    longitude1 double precision,
    latitude2 double precision,
    longitude2 double precision)
  RETURNS double precision AS
$BODY$
SELECT asin(
  sqrt(
    sin(radians($3-$1)/2)^2 +
    sin(radians($4-$2)/2)^2 *
    cos(radians($1)) *
    cos(radians($3))
  )
) * 7926.3352 AS distance;
$BODY$
  LANGUAGE sql IMMUTABLE
  COST 100; 
```

# .net - .NET 日志框架设计

> ID：10034637
> 
> 赞同：2
> 
> 时间：2012-04-05T19:16:33.233
> 
> 标签：.net, logging, log4net

我们将 log4net 用于我们当前的应用程序日志记录，但我不喜欢我们目前围绕它构建的日志记录框架的方式。例如，它目前有一个单点故障，如果由于某种原因它无法连接到日志服务器，那么您将没有日志记录。我想将它构建为一个灵活但简单的框架，允许我指定一个或多个“备份”附加程序以在主附加程序失败时使用（例如，如果日志服务器关闭，则写入文件反而）。

你们有没有人偶然发现过这样的东西，你喜欢并且觉得写得很好？我不介意自己动手​​，但我非常喜欢不要重新发明轮子

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-22T10:37:13.700

[Seq](http://getseq.net)和[Serilog](http://serilog.net)的组合支持这一点：记录器将所有事件缓冲到一组滚动文件中，然后异步读取这些文件并使用 HTTP/S 将它们发送到服务器。

配置如下：

```
var log = new LoggerConfiguration()
    .WriteTo.Seq("http://my-seq-server", bufferBaseFilename: "C:\\Logs\\myapp")
    .CreateLogger(); 
```

我在这两个项目上工作——渴望得到一些关于这种方法如何符合要求的反馈（如果你足够幸运能够切换到 Serilog ;)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T20:12:16.693

我没有遇到任何已经建成的东西。我建议您制作自己的 appender，它使用现有的 appender，但添加属性以在发生故障时做什么。您可以使用[AppenderSkeleton](http://logging.apache.org/log4net/release/sdk/log4net.Appender.AppenderSkeleton.html)作为新附加程序的基类，然后从那里调用您要使用的附加程序的附加函数。

因此，当 log4 使用您的记录器时，它将是这样的（注意：这不完整，但应该给您一个起点）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using log4net.Appender;
using log4net.Core;

namespace logger {
    class FailoverAppender : AppenderSkeleton {

        protected override void Append(LoggingEvent loggingEvent) {
            // Send the log message to the web service.
            try {
                FirstAppender.Append(loggingEvent);
            }
            catch (Exception e) {
                try{
                    SecondAppender.Append(loggingEvent);
                }
                catch (Exception e2){
                    ErrorHandler.Error("An error occurred while connecting to the logging service.", e);
                }
            }
        }
    }
} 
```

我希望这可以帮助您入门，也许如果您完成了它，您也可以在这里发布解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-13T16:01:25.417

我实际上决定改用 NLog，因为 log4net 设置起来很痛苦。NLog 更易于使用，更易于设置，并且代码库保持最新（log4net 几乎被废弃）

# php - Symfony 2：禁用独白

> ID：10034638
> 
> 赞同：0
> 
> 时间：2012-04-05T19:16:34.260
> 
> 标签：php, symfony, bundles, monolog

是否可以禁用 Symfony 2 的核心包，例如 Monolog 记录器？

我正在开发一个没有太多花哨要求的应用程序，除了它应该是超快和尽可能轻量级。我猜 Symfony 2 在我的情况下并不是最好的框架，但对我来说，它使用了最好的原则，使用起来很愉快，而且我以后可能会利用很多捆绑包。

所以，我的问题如标题所示，是否可以完全禁用日志记录（至少在生产环境中），如果可以，是否也可以禁用其他此类功能？

PS：我知道禁用捆绑包的最简单和最干净的方法是将其从内核中删除，但是使用它的代码会发生什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:33:25.720

实际上，Symfony2 非常适合您的需求。由于它是一个解耦的框架，您可以只包含您想要的功能。您可以从配置文件中禁用独白。

此外，还有[Silex](http://silex.sensiolabs.org/)，这是一个使用 Symfony 组件构建的微型框架，旨在实现相对较小的工作轻量和快速。

# android - Android 操作栏中的自动滚动标题（选取框）

> ID：10034639
> 
> 赞同：5
> 
> 时间：2012-04-05T19:16:42.947
> 
> 标签：android, android-widget, android-actionbar, android-scroll

如果 Android ActionBar 的标题太大，是否有可能使标题自动滚动（选框）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-07-10T13:09:27.173

好吧，我已经这样做了：

```
Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);
setSupportActionBar(toolbar);

    try {
        Field f = toolbar.getClass().getDeclaredField("mTitleTextView");
        f.setAccessible(true);
        TextView toolbarTextView = (TextView) f.get(toolbar);
        toolbarTextView.setEllipsize(TextUtils.TruncateAt.MARQUEE);
        toolbarTextView.setFocusable(true);
        toolbarTextView.setFocusableInTouchMode(true);
        toolbarTextView.requestFocus();
        toolbarTextView.setSingleLine(true);
        toolbarTextView.setSelected(true);
        toolbarTextView.setMarqueeRepeatLimit(-1);

        // set text on Textview

        toolbarTextView.setText("Hello Android ! This is a sample marquee text. That's great. Enjoy");
    } catch (NoSuchFieldException e) {
    } catch (IllegalAccessException e) {
    } 
```

希望这会帮助你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:23:10.450

您可以尝试实现我对[这个问题](https://stackoverflow.com/questions/8607707/how-to-set-a-custom-font-in-the-actionbar-title/8748802#8748802)的回答并添加`android:ellipsize="marquee"`到 TextView...？值得一试。

# vim - 在 vim 命令中设置标记（标签）

> ID：10034645
> 
> 赞同：0
> 
> 时间：2012-04-05T19:17:09.817
> 
> 标签：vim

通常我输入 m 后跟 c 来设置一个标记（标签） c ，我可以使用它与 'c 一起跳到这个位置。现在，我尝试在 vim 中定义一个设置标记的命令

```
:command! Setmark mc 
```

但随着

```
:Setmark 
```

我明白了

```
E14: invalid address 
```

因为，显然， c 不是命令，而是类似于命令 m 的参数。如何在 vim 命令/脚本中为标记设置有效地址？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:21:10.553

您必须将普通命令包装在 下`:normal`，这是一个前命令（`:command`.

```
:command! Setmark normal mc 
```

* * *

或者使用正确的[`:mark`](http://vimdoc.sourceforge.net/htmldoc/motion.html#%3amark)前命令：

```
:command! Setmark mark c 
```

帮助包含完整的详细信息。

# php - 循环中的 PHP include_once 或 require_once

> ID：10034652
> 
> 赞同：1
> 
> 时间：2012-04-05T19:17:37.643
> 
> 标签：php

关于 include/requre_once 的快速问题。我有一些代码对于几个页面来说是通用的，我觉得将它们放在一个文件中从每个页面调用而不是重复代码会更好。

我在 while 循环中调用 include_once，我注意到我必须使用 include('file.php') 否则它只会加载（并显示）一次。我猜我的假设（错误地）是它将在第一个循环中加载它并将代码保留在缓存中，以避免每次循环迭代都必须访问磁盘。

我四处寻找“load_once_and_cache”类型的命令，但没有找到任何东西。

有没有人对此有任何建议，或者将代码放在每个页面中是唯一的选择。

再次感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T19:19:01.020

这是一种让内容进入循环的非常低效的方法。PHP 需要在每次`include()`调用时从磁盘读取文件。你最好创建一个函数（可能在包含的文件中）。包含一次定义函数的文件，然后在循环中调用该函数。

依赖包含文件的输出并不总是好的做法，除非在编写视图时（即使那样我会在做之前三思而后行）。要求将文件包含在循环中会产生流控制和文件包含的奇怪混合，这可能难以调试和维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T00:36:15.287

由于您周围的空气闻起来像一个复杂的结构和大量的代码，我将假设您正在使用 OOP 技术来完成工作。

在这种情况下，也许您会希望将自动加载类视为一种更高效、更快速的方法：

[http://php.net/manual/en/language.oop5.autoload.php](http://php.net/manual/en/language.oop5.autoload.php)

您还需要阅读评论以充分了解正在发生的事情并找到一些真正的方法来管理各种情况。

# javascript - 从 Javascript 解析 JSON 时如何维护顺序？

> ID：10034655
> 
> 赞同：15
> 
> 时间：2012-04-05T19:17:41.310
> 
> 标签：javascript, json

我发送页面的数据以 JSON 编码，使用 Javascript 解析，然后使用循环显示在 HTML SELECT 元素中。数据到达时已经排序，但我在解码 JSON 字符串时无法保持正确的顺序，这会使应用于数据的排序无效。

样本数据：`{"test":{"4":"first","5":"second","3":"third"}}`

使用 jQuery 的 JSON 解析器和 Javascript 的 eval() 函数，我得到以下结果：

`{"test":{"3":"third","4":"first","5":"second"}}`

不能修改数据的格式，并且键（“4”、“5”、“3”）必须保持相同的顺序。真实数据要复杂得多，但这个示例很好地说明了我的问题。

从 Javascript 解析 JSON 数据时，如何保持其顺序？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T19:19:30.297

如果要保持顺序，请使用数组。这应该是在javascript中维护顺序的唯一方法。

# apache-flex - Flash Builder：如何刷新数据网格数据？

> ID：10034656
> 
> 赞同：0
> 
> 时间：2012-04-05T19:17:45.013
> 
> 标签：apache-flex, datagrid, flash-builder

我试图在用户更新数据库后刷新数据网格以反映更新的数据。那可能吗？我有以下代码：

脚本

```
protected function updataHandler(event:MouseEvent):void
{
   updateJobsResult.token = Service.updateJobs(updateJobData);
   //The database will be updated after users click the update button
   //I want to update datagrid dataprovider to show the updated data.

}

<s:datagrid dataprovider="jobdata">
//jobdata comes from from database query
..................
..................

</datagrid>

<s:form>
//when user selects the row in datagrid, the cell values will 
//pop in this form and user can update the form
.................
.................
</form>

<s:button click="updateHandler"> 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:17:06.323

最简单的方法是在服务成功响应时刷新 dataProvider**作业数据**（您不想在服务器抛出错误之前更新视图）。如果你用`[Bindable]`数据网格标记它，它将立即自动更新。

如果您更喜欢使用唯一标识符（如果可用），也可以直接在 dataProvider 中替换单个项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-08T11:56:49.857

有两种方法可以做到这一点：

1.  更新数据库后，您可以再次检索数据并将其分配给数据提供者。

2.  当您向数据库发送更新请求时，您也会直接更新数据提供者。

# php - 如何仅显示一次 CSS 通知（最佳方法）

> ID：10034660
> 
> 赞同：2
> 
> 时间：2012-04-05T19:17:54.087
> 
> 标签：php, notifications

今天我在 Facebook 上，注意到当您进入具有新功能的页面时，他们如何向您显示通知，但在您单击关闭后，通知会永远消失。如果你什么都不做，通知会一直存在，如果你点击关闭，那么你可以清除缓存，更改计算机，注销并重新登录，通知将不会出现。

我的问题是，存储该信息的最佳方式是什么？如何存储用户已经看到该通知，这样我就不必再次显示它？

饼干？会议？数据库？Javascript？

如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:19:39.903

没有什么*可怕的*想法。

无论您是否检查过通知，它们都可能保存在数据库中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T19:21:58.237

1.  将通知保存在某个通知队列（数据库）中
2.  检查是否应该显示通知（PHP，用户访问适合通知的站点）。
3.  如果通知适合当前上下文，则显示通知 (PHP + CSS)。
4.  如果用户关闭通知，则发送 AJAX 请求以从通知队列 (JavaScript) 中清除通知。

通知队列应保存在数据库中。会话或 cookie 对此不可靠。

然而，这只是一个假设，也是*我*实现通知接口的方式，但我猜 Facebook 的实现非常相似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:34:06.057

## 客户端

您不会看到太多的选项卡间通信，但如果使用得当，它会非常棒，并且为您的 Web 应用程序提供了一些巨大的优势（例如节省带宽）。

我曾经有一个很好的例子，但我找不到它，所以我将在这里展示一个快速原型。

我假设您在整个代码中都有 jQuery 和 jQuery Cookie 插件。

```
<script type="text/javascript">

    var cookie = document.cookie;
    var timer = setTimeout(function(){
        if(document.cookie!=cookie){
            cookie = document.cookie;
            jQuery('#notes').text(jQuery.cookie('notes'));
        }
    }, 500);

    function send(msg){
        // update server
        /* you usually would do an ajax call here */
        // update client tabs
        jQuery.cookie('notes', msg);
    }
</script>

<div id="notes"></div>
<button onclick="send('Hi');" value="Hi"/>
<button onclick="send('Bye');" value="Bye"/> 
```

## 服务器端

在服务器上，他们可能并不真的需要这个通知数据，所以我会冒险猜测内存表（易失性存储）——它既快速又高效。如果需要，您也可以设置 PHP 会话以使用这些表。无论哪种情况，这里都没有什么神秘或超凡脱俗的，这是完全正常的技术。

# tcl - 如何在 TCL 中创建 RFC 3339 时间戳？

> ID：10034664
> 
> 赞同：3
> 
> 时间：2012-04-05T19:18:08.087
> 
> 标签：tcl

我继承了一个 TCL 脚本（我对该语言的熟悉度为零）并且需要向它添加一个 RFC 3339 时间戳：

```
2012-04-05T12:13:32.123456-08:00
```

搜索谷歌后，我没有找到任何显示微秒或时区偏移的方法（我找到了一种显示时区名称的方法，但这无济于事）。
有没有办法在不调用外部进程的情况下做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T21:37:04.760

在 TCL8.5 中，您可以尝试以下命令：

```
% clock format [clock seconds] -format "%Y-%m-%dT%T%z"
2012-04-05T16:06:07-0500 
```

除了亚秒级分辨率之外，这为您提供了一切。该`clock microseconds`命令将为您提供以微秒为单位的时间，但我找不到与之匹配的格式字符串标识符。您可以使用它从头开始构建自己的命令：

```
proc timestamp_rfc3339 {} {
    set us [clock microseconds]
    set sec [expr {$us / 1000000}]
    set micro [expr {$us % 1000000}]
    set ts [clock format $sec -format "%Y-%m-%dT%T"]
    regexp {(...)(..)} [clock format $sec -format "%z"] matched tzh tzm
    return [format "%s.%06s%s:%s" $ts $micro $tzh $tzm]
} 
```

运行它会产生一个时间戳，如`2012-04-05T16:35:06.366378-05:00`.

**编辑：**更新代码示例以合并 user1179884 的调整（请参阅评论）并包装在 proc 中。

# mysql - 如何在 MySQL 中生成数据？

> ID：10034668
> 
> 赞同：6
> 
> 时间：2012-04-05T19:18:20.783
> 
> 标签：mysql, sql

这是我的 SQL：

```
SELECT 
  COUNT(id),
  CONCAT(YEAR(created_at), '-', MONTH(created_at), '-', DAY(created_at))
FROM my_table
GROUP BY YEAR(created_at), MONTH(created_at), DAY(created_at) 
```

即使在没有创建 ID 的日子里，我也希望显示一行。现在我错过了大量没有活动的日子。

关于如何更改此查询以做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T19:23:33.187

SQL 在返回不在数据库中的数据方面是出了名的糟糕。*您可以找到日期间隔*的开始值和结束值，但很难获取所有日期。

解决方案是创建一个日历表，其中每个日期都有一条记录，然后将其外连接到您的查询中。

这是一个假设 created_at 是 DATE 类型的示例：

```
SELECT calendar_date, COUNT(`id`)
FROM calendar LEFT OUTER JOIN my_table ON calendar.calendar_date = my_table.created_at
GROUP BY calendar_date 
```

（我猜 created_at 确实是 DATETIME，所以你必须做更多的体操才能加入表格）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-04-10T00:28:06.103

**大概的概念**

在 MySQL 中生成数据有两种主要方法。一种是在运行查询时动态生成数据，另一种是将数据保存在数据库中并在必要时使用它。当然，如果您要经常运行查询，第二个会比第一个快。但是，第二个将需要数据库中的一个表，其唯一目的是生成丢失的数据。它还要求您具有足够的权限来创建该表。

**动态数据生成**

这种方法涉及使`UNION`s 生成一个可用于连接实际表的假表。可怕且重复的查询是：

```
select aDate from (
  select @maxDate - interval (a.a+(10*b.a)+(100*c.a)+(1000*d.a)) day aDate from
  (select 0 as a union all select 1 union all select 2 union all select 3
   union all select 4 union all select 5 union all select 6 union all
   select 7 union all select 8 union all select 9) a, /*10 day range*/
  (select 0 as a union all select 1 union all select 2 union all select 3
   union all select 4 union all select 5 union all select 6 union all
   select 7 union all select 8 union all select 9) b, /*100 day range*/
  (select 0 as a union all select 1 union all select 2 union all select 3
   union all select 4 union all select 5 union all select 6 union all
   select 7 union all select 8 union all select 9) c, /*1000 day range*/
  (select 0 as a union all select 1 union all select 2 union all select 3
   union all select 4 union all select 5 union all select 6 union all
   select 7 union all select 8 union all select 9) d, /*10000 day range*/
  (select @minDate := '2001-01-01', @maxDate := '2002-02-02') e
) f
where aDate between @minDate and @maxDate 
```

无论如何，它比看起来简单。它使用`10`数值生成派生表的笛卡尔积，因此结果将包含查询中派生表数量的`10^X`行。`X`在此示例中，有`10000`日期范围，因此您可以表示`27`多年的时间段。如果您需要更多，`UNION`请在查询中添加另一个并更新间隔，如果您不需要太多，您可以`UNION`从派生表中删除 s 或单个值。澄清一下，您可以通过应用带有`WHERE`子句`@minDate`和`@maxDate`变量的过滤器来微调日期时间段（但不要使用比您使用笛卡尔积创建的时间段更长的时间段）。

**静态数据生成**

此解决方案将要求您在数据库中生成一个表。该方法与前一种方法类似。您必须首先将数据插入该表：整数范围从`1`到`X`where`X`是最大所需范围。同样，如果您不确定只需插入`100000`值，您就可以创建`273`多年的日期范围。因此，一旦获得整数序列，就可以将其转换为如下日期范围：

```
select '2012-01-01' + interval value - 1 day aDay from seq
having aDay <= '2012-01-05' 
```

假设一个名为 的表`seq`名为`value`. 顶部是*起始*日期，底部是*截止*日期。

**把它变成有用的东西**

好的，现在我们生成了日期周期，但我们仍然缺少一种查询数据并将缺失值显示为实际值的方法`0`。这就是`left join`救援的地方。为了确保我们都在同一个页面上，a`left join`与 an 相似，`inner join`但只有一个区别：它将保留连接的左表中的所有记录，而不管右表是否有匹配的记录. 换句话说， an`inner join`将删除连接中所有不匹配的行，而`left join`将保留左表中的行，并且对于在右表中没有匹配记录的左侧记录，`left join`将填充该“空间”有一个`null`价值。

因此，我们应该将我们的域表（具有“缺失”数据的表）与我们新生成的表连接起来，将后者放在连接的左侧，将前者放在右侧，以便考虑所有元素，无论它们是否存在在域表中。

例如，如果我们有一个`domainTable`包含字段的表，`ID, birthDate`并且我们希望查看每天`birthDate`前`5`几天所有的计数，并且如果计数显示该值，则可以运行以下查询：`2012``0`

```
select allDays.aDay, count(dt.id) from (
  select '2012-01-01' + interval value - 1 day aDay from seq
  having aDay <= '2012-01-05'
) allDays
left join domainTable dt on allDays.aDay = dt.birthDate
group by allDays.aDay 
```

这会生成一个包含所有必需天数的派生表（注意我正在使用静态数据生成）并`left join`针对我们的域表执行一个，因此所有天都将被显示，无论它们在我们的域表中是否具有匹配值。另请注意，`count`应在具有`null`不计入值的字段上完成。

**需要考虑的注意事项**

1) 查询可用于查询其他时间间隔（月、年）对代码进行小的更改

2）而不是硬编码您可以查询的日期`min`和`max`域表中的值，如下所示：

```
select (select min(aDate) from domainTable) + interval value - 1 day aDay
from seq
having aDay <= (select max(aDate) from domainTable) 
```

这将避免生成不必要的记录。

**实际回答你的问题**

我想你应该已经弄清楚如何做你想做的事了。无论如何，这里有一些步骤，以便其他人也可以从中受益。首先，创建*整数表*。其次，运行这个查询：

```
select allDays.aDay, count(mt.id) aCount from (
    select (select date(min(created_at)) from my_table) + interval value - 1 day aDay
    from seq s
    having aDay <= (select date(max(created_at)) from my_table)
) allDays
left join my_table mt on allDays.aDay = date(mt.created_at)
group by allDays.aDay 
```

我想`created_at`是一个日期时间，这就是你以这种方式连接的原因。然而，这恰好是 MySQL 本地存储日期的方式，所以我只是按日期字段分组，但将其`created_at`转换为实际`date`数据类型。你可以用这个[fiddle](http://sqlfiddle.com/#!2/5d9bd/1)来玩它。

这是动态生成数据的解决方案：

```
select allDays.aDay, count(mt.id) aCount from (
  select @maxDate - interval a.a day aDay from
  (select 0 as a union all select 1 union all select 2 union all select 3
   union all select 4 union all select 5 union all select 6 union all
   select 7 union all select 8 union all select 9) a, /*10 day range*/
  (select @minDate := (select date(min(created_at)) from my_table),
          @maxDate := (select date(max(created_at)) from my_table)) e
   where @maxDate - interval a.a day between @minDate and @maxDate
) allDays
left join my_table mt on allDays.aDay = date(mt.created_at)
group by allDays.aDay 
```

如您所见，查询的框架与前一个相同。唯一改变的是派生表`allDays`的生成方式。现在，派生表的生成方式也和我之前添加的略有不同。这是因为在示例文件中，我只需要一个`10`-day 范围。如您所见，它比添加`1000`日期范围更具可读性。这是动态解决方案的[小提琴](http://sqlfiddle.com/#!2/5d9bd/2)，因此您也可以使用它。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-13T02:01:08.803

在一个查询中执行此操作的方法：

```
SELECT COUNT(my_table.id) AS total,
 CONCAT(YEAR(dates.ddate), '-', MONTH(dates.ddate),  '-', DAY(dates.ddate))
FROM (
   -- Creates "on the fly" 65536 days beginning from 2000-01-01 (179 years)
   SELECT DATE_ADD("2000-01-01", INTERVAL (b1.b + b2.b + b3.b + b4.b + b5.b + b6.b + b7.b + b8.b + b9.b + b10.b + b11.b + b12.b + b13.b + b14.b + b15.b + b16.b) DAY) AS ddate FROM
   (SELECT 0 AS b UNION SELECT 1) b1,
   (SELECT 0 AS b UNION SELECT 2) b2,
   (SELECT 0 AS b UNION SELECT 4) b3,
   (SELECT 0 AS b UNION SELECT 8) b4,
   (SELECT 0 AS b UNION SELECT 16) b5,
   (SELECT 0 AS b UNION SELECT 32) b6,
   (SELECT 0 AS b UNION SELECT 64) b7,
   (SELECT 0 AS b UNION SELECT 128) b8,
   (SELECT 0 AS b UNION SELECT 256) b9,
   (SELECT 0 AS b UNION SELECT 512) b10,
   (SELECT 0 AS b UNION SELECT 1024) b11,
   (SELECT 0 AS b UNION SELECT 2048) b12,
   (SELECT 0 AS b UNION SELECT 4096) b13,
   (SELECT 0 AS b UNION SELECT 8192) b14,
   (SELECT 0 AS b UNION SELECT 16384) b15,
   (SELECT 0 AS b UNION SELECT 32768) b16
 ) dates
 LEFT JOIN my_table ON dates.ddate = my_table.created_at
 GROUP BY dates.ddate
 ORDER BY dates.ddate 
```

仅当您要测试并且没有在问题上指示“my_table”时才需要下一个代码：

```
create table `my_table` (
    `id` int (11),
    `created_at` date 
); 
insert into `my_table` (`id`, `created_at`) values('1','2000-01-01');
insert into `my_table` (`id`, `created_at`) values('2','2000-01-01');
insert into `my_table` (`id`, `created_at`) values('3','2000-01-01');
insert into `my_table` (`id`, `created_at`) values('4','2001-01-01');
insert into `my_table` (`id`, `created_at`) values('5','2100-06-06'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T16:31:14.953

试验台：

```
create table testbed (id integer, created_at date);
insert into testbed values
       (1, '2012-04-01'),
       (1, '2012-04-30'),
       (2, '2012-04-02'),
       (3, '2012-04-03'),
       (3, '2012-04-04'),
       (4, '2012-04-04'); 
```

我也使用`any_table`，我像这样人工创建的：

```
create table any_table (id integer);
insert into any_table values (1), (2), (3), (4), (5), (6), (7), (8), (9), (10);
insert into any_table select * from any_table; -- repeat this insert 7-8 times 
```

您可以使用数据库中的任何表，只要该表的行数超过`max(created_dt) - min(created_dt)`范围，至少 365 行才能涵盖一年。

询问：

```
SELECT concat(year(dr._date),'-',month(dr._date),'-',day(dr._date)),
       -- or, instead of concat(), simply: dr._date
       count(id)
  FROM (
        SELECT date_add(r.mindt, INTERVAL @dist day) _date,
               @dist := @dist + 1 AS days_away
          FROM any_table t
          JOIN (SELECT min(created_at) mindt,
                       max(created_at) maxdt,
                       @dist := 0
                  FROM testbed) r
         WHERE date_add(r.mindt, INTERVAL @dist day) <= r.maxdt) dr
  LEFT JOIN testbed tb ON dr._date = tb.created_at
 GROUP BY dr._date; 
```

# java - 对服务器套接字客户端使用 Executor 而不是新线程

> ID：10034670
> 
> 赞同：1
> 
> 时间：2012-04-05T19:18:24.720
> 
> 标签：java, multithreading, serversocket, executor, executors

我目前正在编写一个多个客户端将连接到的服务器。通信协议基本上是服务器向客户端发送任务，客户端在执行任务时响应。客户端保持与服务器的连接，并且永远不应断开连接。

目前我正在启动一个新线程来处理每个客户端。在精神上，我目前的解决方案是这样的：（来自[Java Concurrency in practice 的](http://jcip.net/listings/ThreadPerTaskWebServer.java)来源）

```
public class ThreadPerTaskWebServer {
    public static void main(String[] args) throws IOException {
        ServerSocket socket = new ServerSocket(80);
        while (true) {
            final Socket connection = socket.accept();
            Runnable task = new Runnable() {
                public void run() {
                    handleRequest(connection);
                }
            };
            new Thread(task).start();
        }
    }

    private static void handleRequest(Socket connection) {
        // request-handling logic here
    }
} 
```

但我想使用 Executors，因为它们看起来更稳定且可扩展性更好。因此，为了让服务器能够向客户端发送消息，我需要将客户端与运行它们的 Executor 分开跟踪。因此，如果我将客户端放在 CopyOnWriteArrayList 客户端中的位置，然后在 Server 类中有类似的内容：

```
Socket clientSocket = serverSocket.accept();
// The runnable that takes care of a client 
ClientHandler c = new ClientHandler(clientSocket, this);
// Start executing the ClientHandler
exec.execute(c);
// Add clients to CopyOnWriteArrayList
clients.add(c); 
```

这将允许我遍历 CopyOnWriteArrayList 以便向所有客户端发送命令并删除断开连接的客户端。这是一个强大的解决方案吗？如果一个可运行对象由于某种原因会传播一个异常给它，那么 Executor 会发生什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:31:09.953

如果您选择每个连接方法的线程并且您不想使用 NIO api，我相信这是一个很好的解决方案。但请记住，如果您的池大小小于并发请求的数量，那么您的客户端将处于待处理状态，直到之前的请求结束。

关于如果您的任务出现异常会发生什么：线程终止但执行程序将创建其他线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:25:25.580

> 这是一个强大的解决方案吗？

是的，我想是这样。您需要确保在固定大小的池中分配正确数量的线程或使用动态池。

> 如果一个可运行对象由于某种原因会传播一个异常给它，那么 Executor 会发生什么？

如果您的代码抛出 a `RuntimeException`，则执行代码的执行器池线程将停止，但池线程计数将减少，如果服务尚未关闭，则会创建另一个线程。所以线程池会继续正常运行。

> 这将允许我遍历 CopyOnWriteArrayList 以便向所有客户端发送命令并删除断开连接的客户端

当然，除非您保存对它们的引用，否则您不需要删除断开连接的那些。否则我不能真正评论这个要求。

# android - 如果设备中安装了 facebook 应用程序，我的 android 应用程序中的 facebook 登录问题

> ID：10034671
> 
> 赞同：0
> 
> 时间：2012-04-05T19:18:24.967
> 
> 标签：android, facebook

我正在开发使用 facebook 登录我的应用程序的应用程序。

为此，我在我的应用程序中实现了 facebook，当设备中没有安装 facebook 应用程序时，这可以正常工作。

如果 facebook 应用程序安装在 android 设备中，并且在尝试从我的应用程序登录 facebook 时，它不起作用。但是在检查设备中安装的 facebook 应用程序时，我登录了。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:36:07.360

在你的 onActivityResult() 活动中调用 facebook 授权..你必须有类似的东西：

```
mFacebookObject.authorizeCallback(requestCode, resultCode, data); 
```

如果通过活动（即 facebook 应用程序）进行授权，则会调用此方法

您也可以强制您的应用程序始终使用登录框（请参阅 Facebook.java 代码），但建议使用 fbk 活动来获取已经维护的会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:28:15.290

您应该在 facebook 集成的代码中看起来更好；）
问题在于，如果您的设备上安装了 facebook 应用程序、库 startActivityToResult 并将用户重定向到 facebook 应用程序。所以你需要重写 onActivityResult 并处理自动化的结果。

# css - CSS 导航栏在 IE 和 FF 中没有正确排列

> ID：10034675
> 
> 赞同：0
> 
> 时间：2012-04-05T19:19:02.307
> 
> 标签：css, internet-explorer, firefox, navigation, position

我的 CSS - 导航栏有问题 - 它在 IE、FF 和 Safari 中没有正确排列。我尝试更改 IE 和 !IE 的边距、填充、if 语句，但它仍然无法在不同的计算机/显示器上正确排列。网站是 [http://www.couponallies.com][1]。

这是导航栏的代码 - 右上角、主导航和第二个子导航栏。

任何解决方案，建议都非常感谢！

```
 <!--[if IE]>
    #smallmenuright{position: relative;}
    #smallmenuright li{
        margin:0px 0px 0px 0px;
        padding:0px 0px 0px 0px;
        list-style:none;
        position:absolute;
        top:1px;
    }
    #smallmenuright li, #smallmenuright a{height:60px;display:block;}

    #rss{left:943px;width:92px;}
    #rss{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') 0 0;}
    #rss a:hover{background: url('http://www.couponallies.com/CPhotos/submenu3b.png') 0px -82px;}

    #twitter{
        left:1035px;
        width:92px;
    }
    #twitter{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') -92px 0;}
    #twitter a:hover{background: url('http://www.couponallies.com/CPhotos/submenu3b.png') -92px -82px;}

    #facebook{
        left:1127px;
        width:92px;
    }
    #facebook{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') -183px 0;}
    #facebook a:hover{background: url('http://www.couponallies.com/CPhotos/submenu3b.png') -183px -82px;}

    #contact{
        left:1219px;
        width:92px;
    }
    #contact{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') -274px 0;}

    #contact a:hover{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') -274px -82px;}
<![endif]-->

<!--[if !IE]>
#smallmenuright{position: relative;}
#smallmenuright li{
    margin: 0px 0px 0px 5px;
    padding:0px 0px 0px 0px;
    list-style:none;
    position:absolute;
    top:1px;
}
    #smallmenuright li, #smallmenuright a{height:60px;display:block;}

    #rss{left:943px;width:92px;}
    #rss{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') 0 0;}
    #rss a:hover{background: url('http://www.couponallies.com/CPhotos/submenu3b.png') 0px -82px;}

    #twitter{
    left:1035px;
    width:92px;
}
    #twitter{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') -92px 0;}
    #twitter a:hover{background: url('http://www.couponallies.com/CPhotos/submenu3b.png') -92px -82px;}

    #facebook{
    left:1127px;
    width:92px;
}
    #facebook{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') -183px 0;}
    #facebook a:hover{background: url('http://www.couponallies.com/CPhotos/submenu3b.png') -183px -82px;}

    #contact{
    left:1219px;
    width:92px;
}
#contact{background:url('http://www.couponallies.com/CPhotos/submenu3b.png') -274px 0;}
#contact a:hover{background: url('http://www.couponallies.com/CPhotos/submenu3b.png') -274px -82px;}
<![endif]-->

/*MAIN NAVIGATION BAR */

<!--[if IE]>
#navlist{position:relative;top:-30px;z-index:1;padding:0px 0px 0px 0px;}
#navlist li{
    margin: 0px 0px 0px 0px;
    padding:0px 0px 0px 0px;
    list-style:none;
    position:absolute;
    top:180px;}

#navlist li, #navlist a{height:51px;display:block;}

#home{left:31px;width:160px;}
#home{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') 0 0;}
#home a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') 0 -50px;}

#what{
    left:191px;
    width:160px;
}
#what{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -160px 0;}
#what a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -160px -50px;}

#coupons{
    left:351px;
    width:160px;
}
#coupons{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -320px 0;}
#coupons a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -320px -50px;}

#couponcodes{
    left:511px;
    width:160px;
}
#couponcodes{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -480px 0;}
#couponcodes a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -480px -50px;}

#dailydeals{
    left:671px;
    width:160px;
}
#dailydeals{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -640px 0;}
#dailydeals a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -640px -50px;}

#freestuff{
    left:831px;
    width:160px;
}
#freestuff{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -800px 0;}
#freestuff a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -800px -50px;}

#about{
    left:991px;
    width:160px;
}
#about{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -960px 0;}
#about a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -960px -50px;}

#beginners{
    left:1151px;
    width:160px;
}
#beginners{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -1120px 0;}
#beginners a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -1120px -50px;}
<![endif]-->

<!--[if !IE]>
#navlist{position:relative;top:-30px;padding:0px 0px 0px 0px;}
#navlist li{
    margin: 0px 0px 0px 5px;
    padding:0px 0px 0px 0px;
    list-style:none;
    position:absolute;
    top:180px;
}
#navlist li, #navlist a{height:51px;display:block;}

#home{left:31px;width:160px;}
#home{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') 0 0;}
#home a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') 0 -50px;}

#what{
    left:191px;
    width:160px;
}
#what{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -160px 0;}
#what a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -160px -50px;}

#coupons{
    left:351px;
    width:160px;
}
#coupons{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -320px 0;}
#coupons a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -320px -50px;}

#couponcodes{
    left:511px;
    width:160px;
}
#couponcodes{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -480px 0;}
#couponcodes a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -480px -50px;}

#dailydeals{
    left:671px;
    width:160px;
}
#dailydeals{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -640px 0;}
#dailydeals a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -640px -50px;}

#freestuff{
    left:831px;
    width:160px;
}
#freestuff{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -800px 0;}
#freestuff a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -800px -50px;}

#about{
    left:991px;
    width:160px;
}
#about{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -960px 0;}
#about a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -960px -50px;}

#beginners{
    left:1151px;
    width:160px;
}
#beginners{background:url('http://www.couponallies.com/CPhotos/sprites6.jpg') -1120px 0;}
#beginners a:hover{background: url('http://www.couponallies.com/CPhotos/sprites6.jpg') -1120px -50px;}
<![endif]-->

/*CSS FOR SMALL SUBMENU - POLICIES AND TOOLBAR DOWNLOAD */

/*FOR INTERNET EXPLORER ONLY */
<!--[if IE]>
#submenu{position:relative;height:37px;padding:0px 0px 0px 0px;}
#submenu li{
    margin:0px 10px 0px 0px;
    padding:0px 0px 0px 0px;
    list-style:none;
    position:absolute;
    top:230px;
}
#submenu li, #submenu a{height:36px;display:block;}

#policies{left:31px;width:139px;}
#policies{background:url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') 0 0;}
#policies a:hover{background: url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') 0px -35px;}

#toolbar{left:170px;width:139px;
}
#toolbar{background:url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') -414px 0;}
#toolbar a:hover{background: url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') -414px -35px;} 
<![endif]-->

/* FOR ALL OTHER BROWSERS - POSITIONING IS DIFFERENT */
<!--[if !IE]>
#submenu{position:relative;height:37px;padding:0px 0px 0px 0px;}

#submenu li{
    margin: 0px 0px 0px 5px;
    padding:0px 0px 0px 0px;
    list-style:none;
    position:absolute;
    top:230px;
}
#submenu li, #submenu a{height:36px;display:block;}

#policies{left:31px;width:139px;}
#policies{background:url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') 0 0;}
#policies a:hover{background: url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') 0px -35px;}

#toolbar{left:170px;width:139px;
}
#toolbar{background:url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') -414px 0;}
#toolbar a:hover{background: url('http://www.couponallies.com/CPhotos/submenuB_new.jpg') -414px -35px;}
<![endif]-->
</style>
</head>

<body>
<a class="header"></a>

<ul id="smallmenuright">
  <li id="rss"><a href="http://feeds2.feedburner.com/CouponAllies"></a></li>
  <li id="twitter"><a href="http://twitter.com/couponallies"></a></li>
  <li id="facebook"><a href="http://www.facebook.com/couponallies/app_128953167177144"></a></li>
  <li id="contact"><a href="mailto:services@couponallies.com"></a></li>
</ul>

<ul id="navlist">
  <li id="home"><a href="http://www.couponallies.com"></a></li>
  <li id="what"><a href="http://www.couponallies.com/coupon-allies/2011/03/welcome.html"></a></li>
  <li id="coupons"><a href="http://www.couponallies.com/coupon-allies/coupon-center-printable-electronic-offers.html"></a></li>
  <li id="couponcodes"><a href="http://www.couponallies.com/coupon-allies/coupon-codes.html"></a></li>
  <li id="dailydeals"><a href="http://www.couponallies.com/coupon-allies/daily-deals.html "></a></li>
  <li id="freestuff"><a href="http://www.couponallies.com/coupon-allies/free-stuff.html "></a></li>
  <li id="about"><a href="http://www.couponallies.com/coupon-allies/about.html"></a></li>
  <li id="beginners"><a href="http://www.couponallies.com/coupon-allies/just-for-beginners.html "></a></li>
</ul>

<ul id="submenu">
  <li id="policies"><a href="http://www.couponallies.com/coupon-allies/coupon-policies-.html"></a></li>
  <li id="toolbar"><a href="http://couponallies.ourtoolbar.com/"></a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:27:32.930

良好的基于​​列表的菜单的规则：

*   重置您的列表：`ul, li {list-style:none;padding:0;margin:0}`
*   `LI`永远不要为（除了`position`,`float`和`display`）设置样式
*   `display:block`在您的`A`-tag上使用
*   将所有样式放在`A`-tag上

请参阅我的教程：[preview.moveable.com/JM/ilovelists](http://preview.moveable.com/JM/ilovelists)

# arrays - 如何按值从数组中删除一个元素

> ID：10034678
> 
> 赞同：390
> 
> 时间：2012-04-05T19:19:18.110
> 
> 标签：arrays, ruby

我在 Ruby 中有一系列元素

```
[2,4,6,3,8] 
```

`3`例如，我需要删除具有值的元素

我怎么做？

* * *

## 回答 #1

> 赞同：554
> 
> 时间：2012-04-05T19:22:39.623

我想我已经弄清楚了：

```
a = [3, 2, 4, 6, 3, 8]
a.delete(3)
#=> 3
a
#=> [2, 4, 6, 8] 
```

* * *

## 回答 #2

> 赞同：252
> 
> 时间：2014-03-17T21:08:48.770

借用评论中的**特拉维斯**，这是一个更好的答案：

> 我个人喜欢`[1, 2, 7, 4, 5] - [7]`哪个结果`=> [1, 2, 4, 5]`来自`irb`

*我修改了他的答案，发现 3 是他的示例数组中的第三个元素。对于那些没有意识到 3 在数组中的位置 2 的人来说，这可能会导致一些混乱。*

* * *

## 回答 #3

> 赞同：73
> 
> 时间：2014-09-18T02:23:43.260

另外一个选项：

```
a = [2,4,6,3,8]

a -= [3] 
```

这导致

```
=> [2, 4, 6, 8] 
```

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2016-12-31T18:29:36.553

我不确定是否有人说过这一点，但是 Array.delete() 和 -= *value*将删除数组中传递给它的值的每个实例。为了删除特定元素的第一个实例，您可以执行类似的操作

```
arr = [1,3,2,44,5]
arr.delete_at(arr.index(44))

#=> [1,3,2,5] 
```

可能有更简单的方法。我并不是说这是最佳实践，但这是应该得到认可的。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2016-11-27T13:47:19.330

假设您想在数组中的多个位置按值删除 3，我认为执行此任务的 ruby​​ 方法是使用 delete_if 方法：

```
[2,4,6,3,8,3].delete_if {|x| x == 3 } 
```

您还可以使用 delete_if 删除“数组数组”场景中的元素。

希望这能解决您的查询

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2015-06-26T01:36:06.733

我喜欢`-=[4]`其他答案中提到的删除值为4的元素的方式。

但是有这种方法：

```
[2,4,6,3,8,6].delete_if { |i| i == 6 }
=> [2, 4, 3, 8] 
```

[在“基本数组操作](https://rubymonk.com/learning/books/1-ruby-primer/chapters/1-arrays/lessons/34-arrays-the-basics)”中的某处提到`map`函数之后。

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2014-10-17T07:30:28.267

您可以简单地运行：

```
[2,4,6,3,8].delete(3) 
```

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2015-03-28T07:53:50.450

A`.delete_at(3)` `3`这里是位置。

* * *

## 回答 #9

> 赞同：15
> 
> 时间：2016-03-28T23:43:46.920

以下是一些基准：

```
require 'fruity'

class Array          
  def rodrigo_except(*values)
    self - values
  end    

  def niels_except value
    value = value.kind_of?(Array) ? value : [value]
    self - value
  end
end

ARY = [2,4,6,3,8]

compare do
  soziev  { a = ARY.dup; a.delete(3);               a }
  steve   { a = ARY.dup; a -= [3];                  a }
  barlop  { a = ARY.dup; a.delete_if{ |i| i == 3 }; a }
  rodrigo { a = ARY.dup; a.rodrigo_except(3);         }
  niels   { a = ARY.dup; a.niels_except(3);           }
end

# >> Running each test 4096 times. Test will take about 2 seconds.
# >> soziev is similar to barlop
# >> barlop is faster than steve by 2x ± 1.0
# >> steve is faster than rodrigo by 4x ± 1.0
# >> rodrigo is similar to niels 
```

再次使用包含大量重复项的更大数组：

```
class Array          
  def rodrigo_except(*values)
    self - values
  end    

  def niels_except value
    value = value.kind_of?(Array) ? value : [value]
    self - value
  end
end

ARY = [2,4,6,3,8] * 1000

compare do
  soziev  { a = ARY.dup; a.delete(3);               a }
  steve   { a = ARY.dup; a -= [3];                  a }
  barlop  { a = ARY.dup; a.delete_if{ |i| i == 3 }; a }
  rodrigo { a = ARY.dup; a.rodrigo_except(3);         }
  niels   { a = ARY.dup; a.niels_except(3);           }
end

# >> Running each test 16 times. Test will take about 1 second.
# >> steve is faster than soziev by 30.000000000000004% ± 10.0%
# >> soziev is faster than barlop by 50.0% ± 10.0%
# >> barlop is faster than rodrigo by 3x ± 0.1
# >> rodrigo is similar to niels 
```

甚至更大，重复更多：

```
class Array          
  def rodrigo_except(*values)
    self - values
  end    

  def niels_except value
    value = value.kind_of?(Array) ? value : [value]
    self - value
  end
end

ARY = [2,4,6,3,8] * 100_000

compare do
  soziev  { a = ARY.dup; a.delete(3);               a }
  steve   { a = ARY.dup; a -= [3];                  a }
  barlop  { a = ARY.dup; a.delete_if{ |i| i == 3 }; a }
  rodrigo { a = ARY.dup; a.rodrigo_except(3);         }
  niels   { a = ARY.dup; a.niels_except(3);           }
end

# >> Running each test once. Test will take about 6 seconds.
# >> steve is similar to soziev
# >> soziev is faster than barlop by 2x ± 0.1
# >> barlop is faster than niels by 3x ± 1.0
# >> niels is similar to rodrigo 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-11-20T14:06:21.917

我改进了 Niels 的解决方案

```
class Array          
  def except(*values)
    self - values
  end    
end 
```

现在你可以使用

```
[1, 2, 3, 4].except(3, 4) # return [1, 2]
[1, 2, 3, 4].except(4)    # return [1, 2, 3] 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2020-01-24T17:40:03.740

在 ruby​​ 中编译所有不同的删除选项

> **delete** - 按值删除匹配的元素。如果多个值匹配，它将全部删除。如果您不关心出现的次数或确定单次出现，请使用此方法。

```
a = [2, 6, 3, 5, 3, 7]
a.delete(3)  # returns 3
puts a       # return [2, 6, 5, 7] 
```

> **delete_at** - 删除给定索引处的元素。如果您知道索引，请使用此方法。

```
# continuing from the above example
a.delete_at(2) # returns 5
puts a         # returns [2, 6, 7] 
```

> **delete_if** - 删除块为真的每个元素。这将修改数组。调用块时，数组会立即更改。

```
b = [1, 2, 5, 4, 9, 10, 11]
b.delete_if {|n| n >= 10}.  # returns [1, 2, 5, 4, 9] 
```

> **拒绝**- 这将返回新数组，其中包含给定块为假的元素。以此维持顺序。

```
c = [1, 2, 5, 4, 9, 10, 11]
c.reject {|n| n >= 10}.  # returns [1, 2, 5, 4, 9] 
```

> **拒绝！**- 与**delete_if**相同。调用块时，数组可能不会立即更改。
> 
> 如果要从数组中删除多个值，最好的选择如下。

```
a = [2, 3, 7, 4, 6, 21, 13]
b = [7, 21]
a = a - b    # a - [2, 3, 4, 6, 13] 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2018-08-18T02:07:03.100

非破坏性去除首次出现：

```
a = [2, 4, 6, 3, 8]
n = a.index 3
a.take(n)+a.drop(n+1) 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-11-02T17:53:59.653

如果您还想使此删除操作可链接，因此您可以删除一些项目并继续对结果数组进行链接操作，请使用`tap`：

```
[2, 4, 6, 3, 8].tap { |ary| ary.delete(3) }.count #=> 4 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-07-28T12:15:12.297

你也可以猴子修补它。我从来不明白为什么 Ruby 有一个`except`方法 for`Hash`但没有 for `Array`：

```
class Array
  def except value
    value = value.kind_of(Array) ? value : [value]
    self - value
  end
end 
```

现在你可以这样做：

```
[1,3,7,"436",354,nil].except(354) #=> [1,3,7,"436",nil] 
```

或者：

```
[1,3,7,"436",354,nil].except([354, 1]) #=> [3,7,"436",nil] 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-09-14T03:15:26.697

因此，当您多次出现 3 并且只想删除第一次出现的 3 时，您可以简单地执行以下操作。

```
arr = [2, 4, 6, 3, 8, 10, 3, 12]

arr.delete_at arr.index 3

#This will modify arr as [2, 4, 6, 8, 10, 3, 12] where first occurrence of 3 is deleted. Returns the element deleted. In this case => 3. 
```

# bash - bash 中强大的书签系统

> ID：10034684
> 
> 赞同：0
> 
> 时间：2012-04-05T19:19:47.183
> 
> 标签：bash, directory, bookmarks

是否有任何可用的书签系统可以`bash`让我用别名代替真实目录？

我熟悉`cdargs`并使用`cdb`,`ca`等在目录之间移动。

我正在考虑一个允许我输入的工具：

```
diff ./file openb(x)/file 
```

where`openb(x)`将是书签系统中已别名为 x 的目录（以便`cdb x`,`cpb file x`等所有工作）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T14:35:22.943

查看书签系统[bookmarks.sh](http://lug.fh-swf.de/shell/#bookmarks)。从自述文件：

## 壳牌变量

命令

```
bookmark -e 
```

从每个现有的和新的书签中导出一个 shell 变量。添加此行以`~/.bashrc`永久使用此功能。对于书签

```
vm    '/home/vmware.shared-folders' 
```

变量`vm`将被导出。已经存在的变量不会被覆盖。该变量可以与 shell 命令一起使用，例如

```
diff ./file $vm/file 
```

要仅导出一个变量，请使用例如

```
bookmark -e vm 
```

## 解决书签

要偶尔在不导出变量的情况下解析书签，请使用`bm`：

```
diff ./file `bm vm`/file 
```

请注意反引号：`bm`是一个shell函数。

# struts2 - 属性标签的默认值 (struts2)

> ID：10034686
> 
> 赞同：1
> 
> 时间：2012-04-05T19:20:00.330
> 
> 标签：struts2

我试图让一个默认值来自 JSP 页面中的一个 bean，但我无法获得提取值的表达式。我正在使用的一个示例 JSP 是

```
<%@ page contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="s" uri="/struts-tags" %>

<html>
    <head>
        <title> Testing OGNL conversions </title>
    </head>
  <body>
       The data stored is
       <s:property value="dataField" /><br/>
       The property of thisdata is 
       <s:property value="thisdata" default="%{dataField}" /><br/>
       <s:property value="dataField" />
  </body>
</html> 
```

我得到以下输出

```
The data stored is YES 
The property of thisdata is %{dataField} 
YES 
```

假设 struts.xml 和类是正确的（因为 YES 正在打印，正如预期的那样，它们应该是）我怎样才能从 dataField 中获取默认值（是的，我知道愚蠢的名字，但是对于测试代码它对我来说足够了）

dataField 存在于 bean 中，但 thisdata 不存在（这样做是为了获得要打印的默认值）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T21:16:03.093

不针对 OGNL 评估属性标记的默认参数。

所以你可以使用 struts if/elseif/else 标签（或等效的 JSTL）：

```
 <s:if test="somevar1 == null">
        <s:property value="someVar2"/>
    </s:if>
    <s:else>
        <s:property value="someVar1"/>
    </s:else> 
```

OGNL 在 value 属性中进行评估，因此三元组节省了大量空间：

```
<s:property value="somevar1 == null?someVar2:someVar1"/> 
```

进一步注意...属性标签的 value 属性最初设置为 action 类（在迭代器中，这将是您所期望的），因此通常需要设置 value 属性以使默认值按预期工作，如果未提供，则标签输出与`<s:property/>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:33:06.423

我前一段时间做过 Struts2，所以不完全确定，但试试这个。

标签的[文档](http://struts.apache.org/2.0.12/docs/property.html)`s:property`提到了在不存在`default`时使用的内容。`value`因此，请尝试删除该`value`属性并拥有`default="%{datafield}"`

# android - android浏览器和socket io

> ID：10034688
> 
> 赞同：7
> 
> 时间：2012-04-05T19:20:00.360
> 
> 标签：android, node.js, socket.io

我无法让套接字 io 在连接时为 android 浏览器发送响应。我记录了参数并且它们出现在服务器端，看起来客户端没有正确连接。我禁用了 jsonp，但我听说 android 无论如何都会退回到 xhr。

```
socket.on('connect',function (data) {
            socket.emit('setNickAndRoom', {nick: nick}, function(response){
//response. nothing :(.
});
});

client.on("setNickAndRoom", function(nick, fn,_){
//etc etc

fn({msg :nick});
}); 
```

这适用于所有浏览器（甚至是移动 safari、移动 FF、移动 chrome beta）。我必须刷新 android 浏览器 4-5 次才能最终连接。顺便说一句，我正在使用流线型 js (_)

**更新**这似乎只发生在wifi上

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T07:06:12.113

目前有限的选择：

[http://code.google.com/p/weberknecht/](http://code.google.com/p/weberknecht/)

[https://github.com/TooTallNate/Java-WebSocket](https://github.com/TooTallNate/Java-WebSocket)

[https://github.com/Gottox/socket.io-java-client](https://github.com/Gottox/socket.io-java-client)

就 WebSockets 而言听起来不错。Socket.IO 的特定有线协议似乎尚未在 Java 中实现，因此您可能必须自己处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T05:39:19.090

按照[socket io website](http://socket.io/)，您似乎没有正确使用它。

尝试改变`socket.on('connect',function (data) {`

至

`socket.on('connection',function (data) {`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T10:54:17.900

值得一提的是，下面这个简单的示例适用于我的 Android 浏览器。让我们知道您是否需要任何特定的东西，这在下面没有介绍 -***重要：****将 IP 号码和端口更改为适合您环境的任何内容*：

```
var express = require('express'),
    socketio = require('socket.io'),
    app = express.createServer(),
    io = socketio.listen(app);

var index = "<!doctype html>\
<html>\
  <head>\
    <script src=/socket.io/socket.io.js></script>\
    <script>\
        var socket = io.connect('http://10.0.1.29:3000');\
        function send() {\
            socket.emit('foo', 'Ben', function(data) {\
                alert(data);\
            });\
        }\
    </script>\
  </head>\
  <body>\
  <button onclick='send();'>Send</button>\
</html>";

app.get('/', function(req, res) {
    res.send(index);
});

io.sockets.on('connection', function(socket) {
    socket.on('foo', function(name, f) {
        f('Hello ' + name);
    });
});

app.listen(3000); 
```

# c# - 跳过数组中的最后一个元素并返回所有其他元素 C#

> ID：10034690
> 
> 赞同：5
> 
> 时间：2012-04-05T19:20:06.817
> 
> 标签：c#, arrays, skip

我想返回除最后一个元素之外的所有元素。我看了看可能使用 Skip() 方法，但感到困惑。谁能帮帮我？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T19:22:23.227

在这种情况下你不能使用`Skip()`，但你必须使用[`Take()`](http://msdn.microsoft.com/en-us/library/bb503062.aspx).

```
var result = list.Take(list.Length-1); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T19:23:02.017

使用`Take`：

```
list.Take(list.Length-1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:22:30.747

您可以[`Enumerable.Take()`](http://msdn.microsoft.com/en-us/library/bb503062.aspx)为此使用：

```
var results = theArray.Take(theArray.Length - 1); 
```

这将让您枚举除数组中最后一个元素之外的所有元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:23:22.903

您可以执行以下操作：

```
var array = ...;
var arrayExceptLasElement = array.Take(array.Length-1); 
```

希望有帮助！

# javascript - javascript post form.submit();

> ID：10034693
> 
> 赞同：0
> 
> 时间：2012-04-05T19:20:33.890
> 
> 标签：javascript, forms, post, submit

嗨，我正在尝试使用 javascript 将两个字符串发布到另一个 PHP 页面（字符串是动态的，将由 JS 例程在运行时创建）

我想使用下面的代码打开一个新窗口并在该页面的代码中检索发布的数据

我使用以下代码发布

```
var title_string = "title1|title2";
var barcode_string = "barcode1|barcode2";
var path="create_labels.php";
var method = "post";
var params = "titles=" + title_string + "&barcodes=" + barcode_string;
    // The rest of this code assumes you are not using a library.
// It can be made less wordy if you use one.
var form = document.createElement("form");
form.setAttribute("method", method);
form.setAttribute("action", path);
form.setAttribute("target", "_blank");

for(var key in params) {
    if(params.hasOwnProperty(key)) {
        var hiddenField = document.createElement("input");
        hiddenField.setAttribute("type", "hidden");
        hiddenField.setAttribute("name", key);
        hiddenField.setAttribute("value", params[key]);

        form.appendChild(hiddenField);
     }
}

document.body.appendChild(form);
form.submit(); 
```

为简单起见，我暂时创建了两个字符串（标题和条形码），我将通过 form.submit 上的帖子传递

我不确定的是参数的创建，我这样做对吗？该代码确实会打开一个新窗口，但无论出于何种原因，我都无法检索发布的数据，我认为我将其发布错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:32:32.600

你见过那个表格的输出吗？您正在为参数字符串的每个字符创建隐藏字段。你确定要这样做吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:33:07.420

`params`是一个字符串，而不是一个对象，因此它没有任何键。您最终会处理字符串的每个字符并得到以下结果：

```
<input type="hidden" name="0" value="t">
<input type="hidden" name="1" value="i">
<input type="hidden" name="2" value="t">
<input type="hidden" name="3" value="l">
<input type="hidden" name="4" value="e">
<input type="hidden" name="5" value="s">
<input type="hidden" name="6" value="=">
<input type="hidden" name="7" value="t">
<input type="hidden" name="8" value="i">
<input type="hidden" name="9" value="t"> 
```

... ETC ...

您可能需要这段[代码](http://snipplr.com/view/55145/)来转换它。

# c# - 删除datagridview和访问表中的多行

> ID：10034699
> 
> 赞同：0
> 
> 时间：2012-04-05T19:21:07.053
> 
> 标签：c#, ms-access, datagridview, ms-access-2007

我有一个可以访问的电影表，与 OleDBConnection 和 Datagridview1 组件连接。有这样的代码：

```
if (this.dataGridView1.SelectedRows.Count > 0)
        {
            string queryString = "SELECT movieID, Title, MovieYear, Country,Located, Description, Poster, Actors, FilmDirector, Type FROM Movie,movieType WHERE movietype.typeID = Movie.typeID";
            foreach (DataGridViewRow dgvrCurrent in dataGridView1.SelectedRows)
            {
                 int currentRow = int.Parse(dataGridView1.CurrentCell.RowIndex.ToString());
                try
                {
                    string movieIDString = dataGridView1[0, currentRow].Value.ToString();
                    movieIDInt = int.Parse(movieIDString);                

                    string queryDeleteString = "DELETE FROM Movie where movieID = " + movieIDInt + ";";
                    OleDbCommand sqlDelete = new OleDbCommand();
                    sqlDelete.CommandText = queryDeleteString;
                    sqlDelete.Connection = database;
                    sqlDelete.ExecuteNonQuery();
                    loadDataGrid(queryString);
                 }
                catch (Exception ex) { }

            }

        } 
```

它必须删除选定的多行，但它不会:(

我的错误在哪里，你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:35:08.397

我认为， loadDataGrid(queryString) 应该在 for 循环之外。这只是一个猜测，但不确定。

```
if (this.dataGridView1.SelectedRows.Count > 0)
    {
        string queryString = "SELECT movieID, Title, MovieYear, Country,Located, Description, Poster, Actors, FilmDirector, Type FROM Movie,movieType WHERE movietype.typeID = Movie.typeID";
        foreach (DataGridViewRow dgvrCurrent in dataGridView1.SelectedRows)
        {
             int currentRow = int.Parse(dataGridView1.CurrentCell.RowIndex.ToString());
            try
            {
                string movieIDString = dataGridView1[0, currentRow].Value.ToString();
                movieIDInt = int.Parse(movieIDString);                

                string queryDeleteString = "DELETE FROM Movie where movieID = " + movieIDInt + ";";
                OleDbCommand sqlDelete = new OleDbCommand();
                sqlDelete.CommandText = queryDeleteString;
                sqlDelete.Connection = database;
                sqlDelete.ExecuteNonQuery();                    
             }
            catch (Exception ex) { }
        }

        loadDataGrid(queryString);
    } 
```

# svn - 从客户端创建一个 SVN 存储库。

> ID：10034702
> 
> 赞同：3
> 
> 时间：2012-04-05T19:21:26.697
> 
> 标签：svn, tortoisesvn

假设我刚刚开始了一个新项目，并想为它创建一个存储库，只是一个客户端，而不是 SVN 服务器的实际管理员。我该怎么做？

我可以在服务器本身创建一个存储库，但我不能从客户端创建一个存储库，例如 Tortoise，我可以创建分支、标签等，但没有存储库。

obs：tortoise 的create repository 在本地创建它，而不是在实际的svn 服务器上。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T20:53:25.170

根据[SVN 邮件列表中的帖子](http://svn.haxx.se/tsvnusers/archive-2007-02/0005.shtml)（以及 SVN 用户的常识），不可能*使用 SVN 客户端*远程创建存储库。例如，如果您愿意，您可以编写一个在服务器上创建存储库的 Web 应用程序*。*但是，如果服务器不在您的控制范围内，那么您就不走运了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-29T18:16:24.737

所以，这可能不是您正在寻找的解决方案，但我有类似的情况（我有一些实习生在服务器上没有管理员权限，但我不想每次都为他们创建新的存储库当他们创建一个新项目并想要签入时。同样，我不想每次我想签入一些全新的简单测试项目时都必须启动 CollabNet 来创建一个新的 repo。）

*我在没有*标准 Trunk/Branches/Tabs 结构的服务器上创建了一个个性化的“根”存储库（例如“InternNameProjects”），并将 URL 提供给实习生。他现在可以使用 TSVN`Browse Repo`访问该 url，并在那里创建一个新文件夹。然后使用[Import In Place](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-dug-import.html#tsvn-dug-import-in-place)指令将新项目放入该文件夹（两个步骤：1\. 从顶部签出，2\. 提交）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T20:57:28.323

如果您要为服务器使用[Subversion Edge 之](http://www.open.collab.net/products/subversion/SVNedge.html)类的东西，您将获得一个用于配置和管理服务器的 Web UI，它允许您从 Web 浏览器创建存储库。此外，Subversion Edge 有一个[REST API](http://blogs.collab.net/subversion/2012/03/subversion-server-automation/)，可让您以编程方式使用服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-29T18:53:39.800

Subversion 客户端只能在现有存储库上运行，所以不能。您不能使用 Subversion 客户端*创建存储库。*您可以做几件事：

*   您可以编写一个允许用户创建 Subversion 存储库的 Web 应用程序。使用 JavaScript 或 PHP 编写这样的应用程序并不难。如果您将 Apache 定义`httpd`为指定`SVNParentPath`，则将新存储库添加到 指定的目录`SVNParentPath`将使该 Subversion 存储库可通过 Apache 访问`httpd`。您甚至不必重新启动 Apache。
*   *您可以通过说而不是repository* just *project*来重新定义摆脱这种情况的方式。也就是说，不是每个存储库一个项目的多个存储库，而是一个存储库具有多个项目。然后，有人可以`svn mkdir $REPO/trunk/$project`从他们的 Subversion 客户端创建一个新项目。他们将拥有自己的新项目，并且可以将其视为单独的 Subversion 存储库。

# php - Android中JSONArray的空答案

> ID：10034705
> 
> 赞同：0
> 
> 时间：2012-04-05T19:21:33.637
> 
> 标签：php, android, sql, json

我有这个 PHP 代码，以及一个带有“Question”、“answer1”、“answer2”、“Question_id”的数据库，当我从 PHP 进行 SQL 查询并对答案进行编码以发送 Android 应用程序时，只有“问题”字段为空，我读到它可能是代码，但我的数据库是用 utf-8 编码的。我也尝试使用 PHP 中的“utf8_encode”函数将结果转换为 utf-8，但它不起作用，所以我寻求帮助：P

这是代码（我删除了连接到数据库的代码和一些未使用的行......）

```
$sql=mysql_query("SELECT * FROM Questions");
$num_rows = mysql_num_rows($sql);
$max_value = (int)$num_rows;
$quest_id = rand ( 1, $max_value);
$sql=mysql_query("SELECT * FROM Questions WHERE id_quest = $quest_id");

$row = mysql_fetch_array($sql);
$output[]=$row;

    echo(json_encode($output));
mysql_close(); 
```

非常感谢 :D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T19:29:44.413

不要使用两个查询，而是尝试只使用一个。它可能无法解决问题，但它减少了对数据库的调用次数：

```
SELECT * FROM Questions ORDER BY RAND() LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T20:28:50.077

我认为你有点误会了。您的数据库可能以 UTF8 编码，但 php 与数据库***之间的通信不是***（默认为 latin1 / ISO-8859-1）。

除非你正在做一个

```
mysql_query('SET CHARACTER SET utf8'); 
```

您没有与我们分享的某个地方，*这*就是您应该研究的解决方案。

# http - 如何确定 HTTP 请求是来自浏览器还是来自 Web 服务之类的其他东西？

> ID：10034707
> 
> 赞同：19
> 
> 时间：2012-04-05T19:21:38.180
> 
> 标签：http, http-headers, httprequest

如何确定 HTTP 请求是来自浏览器还是来自 Web 服务之类的其他东西？

我知道有一个用户代理，但这似乎主要用于网络浏览器。例如，我知道请求来自谷歌地图或 youtube。请求来自连接的设备。

如果他们有不同的用户代理，我可以举个例子。

谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-05T19:26:45.970

绝对无法确定请求是来自浏览器还是其他发出 HTTP 请求的东西。

HTTP 协议允许客户端任意设置用户代理。

可以尝试确定另一端的东西是否是浏览器，例如通过执行 JavaScript 并测量结果。然而，一些机器人可以执行 JavaScript，并不是所有的浏览器都执行 JavaScript，因此这种测试类型永远不会是完美的。

行为良好的“机器人”（如常见的搜索引擎蜘蛛）将使用特定于它们的用户代理来识别自己。这里有一个非常全面的用户代理列表：

[http://www.user-agents.org/](http://www.user-agents.org/)

[http://www.botsvsbrowsers.com/](http://www.botsvsbrowsers.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:28:57.240

您无法确定，但您可以解析 User-Agent 标头并了解它可能是什么。

这是其中一些的列表。我怀疑它的全面性，但你应该明白： [http ://www.zytrax.com/tech/web/browser_ids.htm](http://www.zytrax.com/tech/web/browser_ids.htm)

# android - 具有动态条目的自定义 ListPreference

> ID：10034709
> 
> 赞同：7
> 
> 时间：2012-04-05T19:21:42.660
> 
> 标签：android

我需要 ListPreference 中的动态条目，因此我不能使用传统的 XML 设置方式，其中有大量在线资料。到目前为止，我有以下设置，如下所示。问题是，当我运行此命令时，我看到带有标题和消息的对话框，但即使我知道条目和值不为空，也没有显示任何条目（我知道我的条目和值是相同的，但如果我不这样做，我会得到错误提供的条目）

```
 my.preference.DynamicPreference
            android:title="@string/date_format"
            android:dialogMessage="@string/profile_info_date_format"
            android:entryValues="@array/date_format_values"
            android:entries="@array/date_format_values" 
```

```
public class DynamicPreference extends ListPreference {
    private int index;

    public DynamicPreference(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public DynamicPreference(Context context) {
        super(context);
    }

    @Override
    protected void onPrepareDialogBuilder(AlertDialog.Builder builder) {
        builder.setTitle(getTitle());
        builder.setMessage(getDialogMessage());
        builder.setSingleChoiceItems(entries(), -1, new DialogInterface.OnClickListener() {
            @Override
            public void onClick(DialogInterface dialogInterface, int i) {

            }
        });
        super.onPrepareDialogBuilder(builder);
    }

    @Override
    public void setEntries(CharSequence[] sequence) {
        CharSequence[] entries = listObjects().toArray(new CharSequence[listObjects().size()]);
        super.setEntries(entries);
    }

    @Override
    public void setEntryValues(CharSequence[] sequence) {
        CharSequence[] values = getContext().getResources().getStringArray(R.string.date_format);
        super.setEntryValues(values);
    }
}
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-12T09:43:26.103

android:dialogMessage 是一个很好的起点，谢谢@MH。发现它。Bellow是我结束的简单设置，我希望有人会发现它有帮助

```
<my.preference.DynamicPreference
        android:title="@string/local_time"
        android:key="profile_info_local_time"
        /> 
```

```
 public class DynamicPreference extends ListPreference {

    public DynamicPreference(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public DynamicPreference(Context context) {
        super(context);
    }

    @Override
    protected View onCreateDialogView() {
        ListView view = new ListView(getContext());
        view.setAdapter(adapter());
        setEntries(entries());
        setEntryValues(entryValues());
        setValueIndex(initializeIndex());
        return view;
    }

    private ListAdapter adapter() {
        return new ArrayAdapter(getContext(), android.R.layout.select_dialog_singlechoice);
    }

    private CharSequence[] entries() {
        //action to provide entry data in char sequence array for list
    }

    private CharSequence[] entryValues() {
        //action to provide value data for list
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T21:22:50.243

我可以看到为什么它没有按预期工作的一些潜在可能性：

1.  从哪里来`listObjects`？它的存在表明它是一个成员变量，但我没有看到它在任何地方被设置或初始化。检查您是否没有使用“空”列表来填充对话框，因为这可能会导致其中没有任何项目。

2.  或者，您是否曾明确调用`setEntries(...)` *and* `setEntryValues(...)`？我在问，因为 ListPreference 在内部没有使用这两个设置器 - 它直接使用私有成员变量（`mEntries`and `mEntryValues`）。换句话说，如果你自己不调用这两个函数，没有人会，这意味着数组也永远不会在超类上设置；因此是空对话框。

3.  类似于我的第一个观察：什么是`entries()`？它坐在 中`onPrepareDialogBuilder`，但似乎没有在任何地方声明。

也许最好开始添加更多的代码片段，因为根据缺少的所有内容，无法判断问题的确切根源在哪里......

**编辑：**好的，我设置了一个快速测试项目来按照您的步骤操作。您的问题的解决方案实际上非常简单：去掉`android:dialogMessage`属性，您的列表项应该会显示出来——我必须补充一点，我只用普通的`ListPreference`.

如果你去查看源代码很容易发现问题`ListPreference`，扩展自`DialogPreference`。在`ShowDialog()`以下可以找到：

```
285        View contentView = onCreateDialogView();
286        if (contentView != null) {
287            onBindDialogView(contentView);
288            mBuilder.setView(contentView);
289        } else {
290            mBuilder.setMessage(mDialogMessage);
291        }
292        
293        onPrepareDialogBuilder(mBuilder); 
```

现在，正如您所看到的，这一切都取决于 onCreateDialog 返回的内容，因为在`onPrepareDialogBuilder`调用时，已经决定要显示什么。那么让我们来看看：

```
336    protected View onCreateDialogView() {
337        if (mDialogLayoutResId == 0) {
338            return null;
339        }
340        
341        LayoutInflater inflater = (LayoutInflater) getContext().getSystemService(
342                Context.LAYOUT_INFLATER_SERVICE);
343        return inflater.inflate(mDialogLayoutResId, null);
344    } 
```

它似乎试图膨胀`mDialogLayoutResId`. 如果未设置或不可用，它将返回`null`，然后才会显示对话框“消息”。内容（包含项目的列表）仅在引用了有效布局时才会显示。如果您希望同时显示内容和消息，则需要使用该`android:dialogLayout`属性添加自定义对话框布局，并添加一个`TextView`with`android:id="@android:id/message"`作为 id。在 a 的情况下`ListPreference`，默认情况下，消息将显示在列表下方。

请注意，您**无需**扩展内置 ListPreference 即可以编程方式添加条目和值。简单调用`setEntries(...)`并`setEntryValues(...)`在 ListPreference 实例上使用您希望它显示的数据。

此外，对于您的`DynamicPreference`子类，您更改的任何行为都可能在您`super.onPrepareDialogBuilder(builder)`在方法结束时一直调用时被覆盖。如前所述：我刚刚使用默认值对此进行了测试`ListPreference`，它似乎可以正常工作并且可以满足您的所有要求。

# git - 从 teamcity buildstep 运行 git 命令

> ID：10034710
> 
> 赞同：3
> 
> 时间：2012-04-05T19:21:54.197
> 
> 标签：git, teamcity

我想从遥控器中提取最新的更改，我有一个步骤

```
git fetch origin +refs/changes/*:refs/remotes/origin/changes/* 
```

通过从 C:\Program Files (x86)\Git\cmd\Git 调用 git 配置为命令行

但是，当 teamcity 运行命令时，它只是等待，等待，等待..

```
Starting: C:\Windows\system32\cmd.exe /s /c ""c:\Program Files (x86)\Git\cmd\git" fetch origin"
[11:54:31]in directory: C:\BuildAgent\work\99b8cd174ffcc354
[11:55:04]Process exited with code 1 
```

11:55 的退出代码 1 是我停止构建，因为运行 fetch 命令花费了超过一分钟。我已经等得更久了。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-30T08:51:40.550

帕维尔评论道：

> 要调试此类问题，您应该登录到代理机器并在启动代理进程的用户下执行完全相同的命令。很可能它也会挂起。

我们在构建步骤之一中使用 git push，它挂在构建服务器上。你可能会发现，你需要告诉 git origin remote 是可信的，并且它应该始终是可信的。当您第一次尝试连接到不受信任的远程主机时，它会出现在控制台中。

一旦你在一个构建代理上完成了一次，你应该能够从所有构建代理之间的构建代理 git 文件夹中复制 known_hosts 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-08T16:34:19.920

在您的构建代理中运行完全相同的 cmd 问题可能是在 known_hosts 文件中缺少远程主机

# jquery - Fancybox iframe 在编译器中工作，但在浏览器中不工作

> ID：10034712
> 
> 赞同：1
> 
> 时间：2012-04-05T19:21:56.337
> 
> 标签：jquery, html, fancybox

我在将fancybox iframe 加载到浏览器中时遇到问题。我不确定它是什么（我觉得它很愚蠢），我可以用手。

编译器使灯箱正常工作，但是当我将它移到浏览器中时，它就坏了。我认为这是我的服务器的问题，但是当我直接从桌面打开文件时，它仍然给出同样的错误。任何帮助表示赞赏！

Javascript

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
<script type="text/javascript" src="http://image.iloqal.com/lib/fe5c1570746107757c1c/m/1/DTVLBjqueryfancybox2.js"></script>
<link rel="stylesheet" type="text/css" href="http://image.iloqal.com/lib/fe5c1570746107757c1c/m/1/DTVLBjqueryfancybox.css" media="screen" />
<script type="text/javascript">
    $(document).ready(function() {

        $("#various3").fancybox({
            'width'             : 1000,
            'height'            : 500,
            'autoScale'         : false,
            'transitionIn'      : 'none',
            'transitionOut'     : 'none',
            'type'              : 'iframe'
        });
    });
</script> 
```

HTML

```
<a id="various3" class="iframe" href="http://www.google.com">Iframe</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:36:56.217

您应该确保页面上没有任何 Javascript 错误。当我加载您的页面时，它以：

> 获取[http://www.localdtvdealer.com/Script/pageTracking.js](http://www.localdtvdealer.com/Script/pageTracking.js) /justintest1/:7

和

> 未捕获的 ReferenceError：未定义 SaveAnalyticData /justintest1/:39

单击我得到的链接后（除了一个空的灯箱）：

> event.layerX 和 event.layerY 在 WebKit 中被破坏和弃用。它们将在不久的将来从引擎中移除。

如果这是一个新项目，请将您的[jQuery 升级到 1.7+](https://stackoverflow.com/questions/7825448/webkit-issues-with-event-layerx-and-event-layery)。

> 获取[http://image.iloqal.com/lib/fe5c1570746107757c1c/m/1/blank.gif](http://image.iloqal.com/lib/fe5c1570746107757c1c/m/1/blank.gif) 404（未找到）jquery.min.js:4

添加丢失的图像

> 拒绝显示文档，因为 X-Frame-Options 禁止显示。

我认为这是真正的问题。您不允许嵌入要嵌入的内容（其他域？）。这是一个安全预防错误。它可以防止页面上的恶意 i-frames。

# c# - 当树视图没有焦点时，C# WinForms 突出显示树节点

> ID：10034714
> 
> 赞同：34
> 
> 时间：2012-04-05T19:22:01.607
> 
> 标签：c#, winforms, treeview, treenode

我正在制作一个界面来编辑游戏的场景。基本上它由具有嵌套条件和动作的事件组成。因此，我计划使用两个树视图 - 一个用于选择事件，另一个用于选择要编辑的事件内的条件/操作。

现在，你看，如果我选择一个事件（在左侧树视图中）然后尝试在右侧树视图中选择某些内容，左侧树视图将停止显示蓝色选择矩形。这显然很糟糕，因为现在用户不知道他正在编辑哪个事件！

我发现保留有关当前选择的某种信息的唯一方法是使用 SelectedImageIndex，但这只是一个不同的小图像。

在没有关注树视图的情况下，还有其他方法可以突出显示树节点吗？我知道我可以只使用 Graphics.DrawRectangle 什么的，但我听说绘图应该在 Paint 事件中完成，而 treeview 没有绘图事件......所以我想如果我在失去焦点的情况下绘制它，然后拖动表格掉出屏幕什么的，会被“抹去”吗？

无论如何，如果您有想法，请告诉我（除了为选定的和未选定的树节点使用单独的图标）。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-04-05T19:26:06.883

您正在寻找的`HideSelection`是`TreeView`.

**来自 MSDN：**

> 获取或设置一个值，该值指示即使在树视图失去焦点时，选定的树节点是否仍保持突出显示。

链接：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.treeview.hideselection.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.treeview.hideselection.aspx)

**代码：**

```
TreeView.HideSelection = false; 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-04-05T19:33:09.980

它仍然显示，但仅以浅灰色显示，这取决于您的屏幕和当前设置，可以接近可见！

覆盖 OnDrawNode 事件。因此，您创建和新类（称为“SpecialTreeView”）继承自 Microsoft，`TreeView`例如`class SpecialTreeView : TreeView`. 然后添加以下事件覆盖：

```
protected override void OnDrawNode(DrawTreeNodeEventArgs e)
{
    TreeNodeStates treeState = e.State;
    Font treeFont = e.Node.NodeFont ?? e.Node.TreeView.Font;

    // Colors.
    Color foreColor = e.Node.ForeColor;
    string strDeselectedColor = @"#6B6E77", strSelectedColor = @"#94C7FC";
    Color selectedColor = System.Drawing.ColorTranslator.FromHtml(strSelectedColor);
    Color deselectedColor = System.Drawing.ColorTranslator.FromHtml(strDeselectedColor);

    // New brush.
    SolidBrush selectedTreeBrush = new SolidBrush(selectedColor);
    SolidBrush deselectedTreeBrush = new SolidBrush(deselectedColor);

    // Set default font color.
    if (foreColor == Color.Empty)
        foreColor = e.Node.TreeView.ForeColor;

    // Draw bounding box and fill.
    if (e.Node == e.Node.TreeView.SelectedNode)
    {
        // Use appropriate brush depending on if the tree has focus.
        if (this.Focused)
        {
            foreColor = SystemColors.HighlightText;
            e.Graphics.FillRectangle(selectedTreeBrush, e.Bounds);
            ControlPaint.DrawFocusRectangle(e.Graphics, e.Bounds, foreColor, SystemColors.Highlight);
            TextRenderer.DrawText(e.Graphics, e.Node.Text, treeFont, e.Bounds,
                                         foreColor, TextFormatFlags.GlyphOverhangPadding);
        }
        else
        {
            foreColor = SystemColors.HighlightText;
            e.Graphics.FillRectangle(deselectedTreeBrush, e.Bounds);
            ControlPaint.DrawFocusRectangle(e.Graphics, e.Bounds, foreColor, SystemColors.Highlight);
            TextRenderer.DrawText(e.Graphics, e.Node.Text, treeFont, e.Bounds,
                                         foreColor, TextFormatFlags.GlyphOverhangPadding);
        }
    }
    else
    {
        if ((e.State & TreeNodeStates.Hot) == TreeNodeStates.Hot)
        {
            e.Graphics.FillRectangle(SystemBrushes.Window, e.Bounds);
            TextRenderer.DrawText(e.Graphics, e.Node.Text, hotFont, e.Bounds,
                                         System.Drawing.Color.Black, TextFormatFlags.GlyphOverhangPadding);
        }
        else
        {
            e.Graphics.FillRectangle(SystemBrushes.Window, e.Bounds);
            TextRenderer.DrawText(e.Graphics, e.Node.Text, treeFont, e.Bounds,
                                         foreColor, TextFormatFlags.GlyphOverhangPadding);
        }
    }
} 
```

编译代码，您应该在设计器的工具箱中看到“SpecialTreeView”。将您的 TreeView 替换为使用相同名称的新视图，唯一不同的是选择颜色。选中的时候会`selectedColor`，不选中的时候会`deselectedColor`。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-12-22T00:50:28.553

**快速解决方案：**

设置属性：

*   `HideSelection = false;`
*   `DrawMode = TreeViewDrawMode.OwnerDrawText;`

然后在 DrawNode 事件处理程序中简单地做：

```
private void treeView1_DrawNode(object sender, DrawTreeNodeEventArgs e) {
  e.DrawDefault = true;
} 
```

在 Windwos 7 上，这会恢复旧的渲染，包括选择周围的虚线框（实际上看起来有点过时）。文本将是有焦点的白色，没有焦点的黑色。背景保持蓝色且可见。

这个答案并不新鲜，其他的也包含这些步骤，但这是最少需要的（至少在 Windows 7 中，没有测试其他操作系统）。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2014-10-09T12:50:24.713

不是绝对完美的解决方案，但非常接近：

```
treeView.HideSelection = false;
treeView.DrawMode = TreeViewDrawMode.OwnerDrawText;
treeView.DrawNode += (o, e) =>
{
    if (!e.Node.TreeView.Focused && e.Node == e.Node.TreeView.SelectedNode)
    {
        Font treeFont = e.Node.NodeFont ?? e.Node.TreeView.Font;
        e.Graphics.FillRectangle(Brushes.Gray, e.Bounds);
        ControlPaint.DrawFocusRectangle(e.Graphics, e.Bounds, SystemColors.HighlightText, SystemColors.Highlight);
        TextRenderer.DrawText(e.Graphics, e.Node.Text, treeFont, e.Bounds, SystemColors.HighlightText, TextFormatFlags.GlyphOverhangPadding);
    }
    else
        e.DrawDefault = true;
};
treeView.MouseDown += (o, e) =>
{
    TreeNode node = treeView.GetNodeAt(e.X, e.Y);
    if (node != null && node.Bounds.Contains(e.X, e.Y))
        treeView.SelectedNode = node;
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2019-10-10T12:57:24.787

找到了一个更简单的方法：

1.  设置 TreeView.HideSelection = True
2.  将以下内容添加到 TreeView.AfterSelect-Callback：

> ```
> private void treeViewBenutzerverwaltung_AfterSelect(object sender, TreeViewEventArgs e)
> {
>     // Select new node
>     e.Node.BackColor = SystemColors.Highlight;
>     e.Node.ForeColor = SystemColors.HighlightText;
>     if (_lastSelectedNode != null)
>     {
>         // Deselect old node
>         _lastSelectedNode.BackColor = SystemColors.Window;
>         _lastSelectedNode.ForeColor = SystemColors.WindowText;
>     }
>     _lastSelectedNode = e.Node;
> } 
> ```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-08-12T00:10:52.397

与上一个类似，但外观更类似于 Win10 标准：

```
treeView.HideSelection = false;
treeView.DrawMode = TreeViewDrawMode.OwnerDrawText;

treeView.DrawNode += (o, e) =>
{
    if (e.Node == e.Node.TreeView.SelectedNode)
    {
        Font font = e.Node.NodeFont ?? e.Node.TreeView.Font;
        Rectangle r = e.Bounds;
        r.Offset(0, 1);
        Brush brush = e.Node.TreeView.Focused ? SystemBrushes.Highlight : Brushes.Gray;
        e.Graphics.FillRectangle(brush, e.Bounds);
        TextRenderer.DrawText(e.Graphics, e.Node.Text, font, r, SystemColors.HighlightText, TextFormatFlags.GlyphOverhangPadding);
    }
    else
        e.DrawDefault = true;
};

treeView.MouseDown += (o, e) =>
{
    TreeNode node = treeView.GetNodeAt(e.Location);
    if (node != null && node.Bounds.Contains(e.Location)) treeView.SelectedNode = node;
}; 
```

# c# - 使用带有泛型参数的方法作为回调

> ID：10034715
> 
> 赞同：0
> 
> 时间：2012-04-05T19:22:13.750
> 
> 标签：c#, function, delegates, callback

让我们看看这种情况：

```
private Func<int, int> callback;
public SomeClass(Func<int, int> callback)
{
    this.callback = callback;
} 
```

然后稍后我们可以调用该函数

```
callback(5); 
```

它会返回一个数字。

现在，我想要的是如下

```
private Func<T1, T2> callback;
public SomeClass(Func<T1, T2> callback)
{
    this.callback = callback;
} 
```

该委托将接受一个带有类似签名的函数

```
public T1 SomeFunc<T1, T2>(T2) 
```

并且可以被调用

```
callback<int, string>("hello") 
```

这将返回一个 int。

这可以在 C# 中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:25:19.870

当然可以，但是您还需要使该类成为通用类。

```
Class SomeClass<T1, T2>
{
    private Func<T1, T2> callback;
    public SomeClass(Func<T1, T2> callback)
    {
        this.callback = callback;
    }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:26:32.043

如果您在本地存储回调，最简单的方法是使类通用：

```
public class SomeClass<TParam, TReturn>
{
    private Func<TParam, TReturn> _callback;

    public class SomeClass(Func<TParam, TReturn> callback)
    {
        _callback = callback;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T20:07:17.627

使用属性，您将不得不像其他海报所说的那样使该类通用。

它看起来有点奇怪，但如果你不希望你的类是泛型的，那么你可以使用泛型方法来获取和设置回调函数，但缺点是你必须设计一些方法来跟踪类型因为您需要将它们传递给回调。不确定这实际上会有多大用处。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{

    public class CallbackTest
    {
        public CallbackTest(){}

        private object _CallBack = null;

        public Func<T1, T2> GetCallBack<T1,T2>()
        {            
                return (Func<T1, T2>)_CallBack;
        }

        public void SetCallBack<T1, T2>(Func<T1, T2> value)
        {
            _CallBack = value;
        }

    }
    class Program
    {
        static void Main(string[] args)
        {

            CallbackTest t = new CallbackTest();
            t.SetCallBack(new Func<int, int>(x => x * x));

            Console.WriteLine(t.GetCallBack<int, int>()(10));

            t.SetCallBack(new Func<string, string>(x => x.ToUpper()));

            Console.WriteLine(t.GetCallBack<string, string>()("test"));

            Console.ReadLine();

        }
    }
} 
```

# css - 减少dom元素，可以用span代替div吗？

> ID：10034717
> 
> 赞同：0
> 
> 时间：2012-04-05T19:22:25.757
> 
> 标签：css, dom, html

我有几个用于图表的 div 元素。Yslow 是说减少 DOM 元素。

我可以用吗：

```
<span class="col1 left"></span><span class="col2 center"></span><span class="col3 right"></span> 
```

代替：

```
<div class="col 1 left"></div><div class="col2 center"></div><div class="col3 right"></div> 
```

减少 DOM 元素，还是 span 一个 DOM 元素？

到目前为止，我总共有大约 900 个。非常感谢任何想法或建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:23:49.813

`span`也是一个 DOM 元素。所以对于 DOM 元素的数量，它不会产生影响。要减少 DOM 元素的数量，您需要考虑每个元素是否真的必要。

您还可以使用不同的 HTML 创建相同的可视页面吗？使用更少的元素将使其清晰易读。也许您通过添加一些并不真正需要的额外元素使事情变得过于复杂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:24:11.170

我相信几乎任何 HTML 标记都会成为浏览器的 DOM 元素。

# extjs - Sencha Touch 2：向表单面板添加选项卡

> ID：10034719
> 
> 赞同：0
> 
> 时间：2012-04-05T19:22:38.547
> 
> 标签：extjs, sencha-touch-2

我正在尝试将以下选项卡添加到以下面板，位于面板的顶部和底部工具栏之间。这可能吗？您能否举例说明如何组合这两个文件？

谢谢你的帮助！

控制板：

```
Ext.define('Myapp.view.Product', {
    extend: 'Ext.form.Panel',
    id: 'productCard',

    config: {
        modal: true,
        hideOnMaskTap: false,
        centered: true,
        height: '95%',
        width: '98%',
        items: [
            {
                docked: 'top',
                xtype: 'toolbar',
                title: '',
                id: 'productTitle'
            },
            {
                docked: 'bottom',
                xtype: 'toolbar',
                items: [
                    {
                        text: 'Close',
                        ui: 'back',
                        id: 'closeProductCard'
                    }
                ]
            }
        ]
    }
}); 
```

标签

```
Ext.define('Myapp.view.Tabs', {
extend: 'Ext.tab.Panel',
    requires: [
        'Ext.field.Toggle'
    ],

    config: {
        activeItem: 0,
        tabBar: {
            docked: 'top',
            autoScroll: 'auto',
            ui: 'neutral',
            layout: {
                pack: 'center'
            }
        },
        items: [
            {
                title: 'Tab 1',
                xtype: 'formpanel',
                items: [
                    {
                        xtype: 'fieldset',
                        defaults: {
                            labelWidth: '35%',
                            labelAlign: 'top'
                        },
                        items: [
                            {
                                xtype: 'togglefield',
                                name: 'toggle',
                                label: 'Toggle'
                            }
                        ]
                    }
                ]
            },
            {
                title: 'Tab 2',
                xtype: 'formpanel',
                items: [
                    {
                        xtype: 'fieldset',
                        defaults: {
                            labelWidth: '35%',
                            labelAlign: 'top'
                        },
                        items: [
                            {
                                xtype: 'togglefield',
                                name: 'toggle',
                                label: 'Toggle'
                            }
                        ]
                    }
                ]
            }
        ]
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:55:55.900

```
Ext.define('Myapp.view.Product', {
    extend: 'Ext.tab.Panel',
    requires: [
    'Ext.field.Toggle'
    ],

    config: {
        activeItem: 0,
        tabBar: {
            docked: 'top',
            autoScroll: 'auto',
            ui: 'neutral',
            layout: {
                pack: 'center'
            }
        },
        items: [{
            xtype:'toolbar',
            docked:'top'
        }, {
            docked: 'bottom',
            xtype: 'toolbar',
            items: [
            {
                text: 'Close',
                ui: 'back',
                id: 'closeProductCard'
            }
            ]
        },
        {
            title: 'Tab 1',
            xtype: 'formpanel',
            items: [{
                xtype: 'fieldset',
                defaults: {
                    labelWidth: '35%',
                    labelAlign: 'top'
                },
                items: [{
                    xtype: 'togglefield',
                    name: 'toggle',
                    label: 'Toggle'
                }
                ]
            }
            ]
        },{
            title: 'Tab 2',
            xtype: 'formpanel',
            items: [{
                xtype: 'fieldset',
                defaults: {
                    labelWidth: '35%',
                    labelAlign: 'top'
                },
                items: [{
                    xtype: 'togglefield',
                    name: 'toggle',
                    label: 'Toggle'
                }
                ]
            }
            ]
        }
        ]
    }
}); 
```

好的，我将两个视图合并到产品视图中。这将显示带有顶部和底部工具栏的选项卡面板。希望这仍然适用于它作为详细信息页面的动态

# html - CSS 和嵌入视频调整大小

> ID：10034721
> 
> 赞同：0
> 
> 时间：2012-04-05T19:22:46.213
> 
> 标签：html, css

我正在从我的数据库中检索视频嵌入 url。

在我的数据库中，我的视频是 600x450。我想要做的是使它们更小并将它们放在一个`<td>`. 为了实现这一点，我使用模板 lite 标签编写了以下 CSS：

```
<style type="text/css">
{literal}
  div.embed
  {
    width:  200px;
    height: 100px;
  }
{/literal}
</style> 
```

我的标记如下：

```
<tr>
  <td>Fragmanlar</td>
  <td>
    <div class="embed"/> 
      {foreach value=movieF from=$movieFragman}
        {$movieF.embedCode} 
      {/foreach}
    </div>
  </td>                
</tr> 
```

问题是我的视频大小没有受到影响，它超出了我的`<td>`.

图片：

![在此处输入图像描述](../Images/e14e01b16eadbe14963df50e18641e6c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:28:19.363

您不能定位视频容器本身，您需要定位实际的视频元素。如果它们在 范围内`div.embed`，您可以修改此选择器以获取特殊性：

```
div.embed video {
  width:  200px;
  height: 100px;
} 
```

当然，这假设您使用的是 HTML5[`video`](http://msdn.microsoft.com/en-us/ie/hh410106#_HTML5_video_audio)标记。如果不是，您可能需要定位`embed`或`object`，具体取决于您显示视频的方式。

例如，您可能有以下内容：

```
<object width="560" height="315">
  <param name="movie" value="http://www.youtube.com/v/NWHfY_lvKIQ?version=3&amp;hl=en_US"></param>
  <param name="allowFullScreen" value="true"></param>
  <param name="allowscriptaccess" value="always"></param>
  <embed src="http://www.youtube.com/v/NWHfY_lvKIQ?version=3&amp;hl=en_US" type="application/x-shockwave-flash" width="560" height="315" allowscriptaccess="always" allowfullscreen="true"></embed>
</object> 
```

您可以同时针对 the`object`及其`embed`子项：

```
div.embed object,
div.embed embed {
  width:  200px;
  height: 100px;
} 
```

另一方面，您的开始标签不应自行关闭，因为这可能会导致识别其中的嵌套元素时出现问题。

```
<div class="embed">
  <video...>
    <source... />
  </video>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:28:55.240

您似乎不小心使用`<div class="embed" />`. 你想要`<div class="embed">`的。（注意缺少正斜杠）

```
<tr>
    <td> Fragmanlar </td>
    <td>
        <div class="embed"> 
            {foreach value=movieF from=$movieFragman}
            {$movieF.embedCode} 
            {/foreach
            }
        </div>
    </td>
</tr>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

# javascript - 简单的 jQuery 分页

> ID：10034724
> 
> 赞同：4
> 
> 时间：2012-04-05T19:22:49.780
> 
> 标签：javascript, jquery, html, css, pagination

我有一个页面，上面有大约 50 个 div。我想将这些 div 分成六个一组，这样客户就不会得到“信息过载”。我为我的问题创建了一个简单的[示例/简化的测试用例](http://jsfiddle.net/hyvZN/)。如您所见，有很多 div，我希望它在页面加载时仅显示前六个，但是当您单击第 2 页或下一个时，会显示下六个等等。您所在页码的类别也应设置为 have `class="current"`。

到目前为止，我已经尝试过使用 jQuery，但我一直卡住了！任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-05T19:45:04.627

当请求页面时，隐藏所有内容 div，然后遍历它们并显示那些应该出现在“页面”上的内容：

```
showPage = function(page) {
    $(".content").hide();
    $(".content").each(function(n) {
        if (n >= pageSize * (page - 1) && n < pageSize * page)
            $(this).show();
    });        
} 
```

[http://jsfiddle.net/jfm9y/184/](http://jsfiddle.net/jfm9y/184/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-05T21:10:23.360

这段代码的一部分并不漂亮，但我认为它可以完成工作

```
var currentpage = 1;
var pagecount = 0;

function showpage(page) {
    $('.content').hide();
    $('.content').eq((page-1)*6).show().next().show().next().show().next().show().next().show().next().show();
    $('#pagin').find('a').removeClass('current').eq(page).addClass('current');

}

$("#pagin").on("click", "a", function(event){
    event.preventDefault();
    if($(this).html() == "next") {
        currentpage++;
    }
    else if($(this).html() == "prev") {
        currentpage--;
    } else {
            currentpage = $(this).html();
    }
    if(currentpage < 1) {currentpage = 1;}
    if(currentpage > pagecount) {currentpage = pagecount;}
    showpage(currentpage);
});                                                                  

$(document).ready(function() {
    pagecount = Math.floor(($('.content').size()) / 6);
    if (($('.content').size()) % 6 > 0) {
        pagecount++;
    }

    $('#pagin').html('<li><a>prev</a></li>');
    for (var i = 1; i <= pagecount; i++) {
        $('#pagin').append('<li><a class="current">' + i + '</a></li>');
    }
    $('#pagin').append('<li><a>next</a></li>');
    showpage(1);

});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-24T04:01:07.773

以下代码取自[https://deltafrog.com/pagination-jquery-without-plugin/](https://deltafrog.com/pagination-jquery-without-plugin/)

```
jQuery('document').ready(function(){
var item_per_page=5;
var $block=jQuery('.block');
var block_count=$block.length;
var number_of_pages=Math.ceil(block_count/item_per_page);

//append pagination in body
jQuery('body').append("<div class='pagination'></div>");
for(var i=1; i<=number_of_pages; i++){
    jQuery('.pagination').append("<div class='page'>"+i+"</div>");  
}

//activate first page
jQuery(".page:first-child").addClass('active');
jQuery('.block').filter(function( index ) { return index < item_per_page;}).addClass('active');

//activate pagination on click
jQuery('body').delegate('.page','click',function(){
    var page_index=jQuery(this).index();
    var start=page_index*item_per_page;
    $block.removeClass('active');
    jQuery(".page").removeClass('active');
    jQuery(".page").eq(page_index).addClass('active');
    for(var j=0;j<item_per_page;j++){
        $block.eq(start+j).addClass('active');
    }

});

}); 
```

# yii - Yii 关系问题

> ID：10034725
> 
> 赞同：1
> 
> 时间：2012-04-05T19:22:51.567
> 
> 标签：yii

我对 Yii 的关系有疑问。我正在使用 CGridView 在视图中显示表格。

我的模型中有以下关系：

`'relationName' => array(self::BELONGS_TO, OtherModelName, link_id),`

当我像下面的示例一样调用 CGridView 中的值时，它可以正常工作：

`'relationName.field_name',`

当我尝试调用数组中的值时，如下例所示：

`array('header'=>'tableHeaderName', 'value'=>'$data->relationName->field_name'),`

我的页面失败，我收到以下错误：`Trying to get property of non-object`

有什么想法或建议吗？非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T23:08:47.510

我自己最近也遇到过这个问题。你需要这样的东西：

```
array(
    'header'=>'tableHeaderName',
    'value'=>'(isset($data->relationName)) ? $data->relationName->field_name : null',
) 
```

如果关系并不总是存在，Yii 会发疯。因此，如果您的数据/关系有任何差距，那么您就会遇到问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T12:36:51.977

检查您`relationName`是否与您的任何数据库表具有相同的名称。

# java - 在 Spring 3 中将 PropertyOverrideConfigurer 与带注释的类一起使用

> ID：10034732
> 
> 赞同：4
> 
> 时间：2012-04-05T19:23:19.647
> 
> 标签：java, spring, spring-mvc

**编辑**：这里有一些解释为什么接受的答案对我有用，以及对其他人来说可能是什么问题。

在我的 foo-app-servlet.xml 中，我有这一行：

```
<context:component-scan base-package="com.foo.app" /> 
```

之前用spring2的时候，我所有的service beans都来自applicationContext.xml，现在直接在foo-app-servlet.xml中引入。在我的项目中，servlet 有自己的一组覆盖，因此我需要在 servlet 覆盖文件而不是 applicationContext 覆盖文件中进行覆盖。

覆盖时，如果你没有命名你的组件，那么它确实使用了它的小写版本，所以要覆盖 OrderService.foo，你可以这样做：

```
orderService.foo=bar 
```

**结束编辑**

我正在开发一个从 spring 2.5 升级到 spring 3 的项目，因此同时具有基于 xml 和注释的配置。我们之前曾使用 PropertyOverrideConfigurer 来更改不同环境中的属性，并取得了巨大成功。我现在正在处理使用 authorize.net 的代码，我需要确保我不会从开发环境向他们发送任何内容。

为了实现这一点，我想用 PropertyOverrideConfigurer 覆盖我的“testMode”属性。这对于通过 xml 配置的 bean 非常有用，但我不知道如何使用注释配置的类来做到这一点。

这是我在 applicationContext.xml 中的覆盖片段：

```
<bean class="org.springframework.beans.factory.config.PropertyOverrideConfigurer">
    <property name="location" value="file:${user.home}/override.properties" />
    <property name="localOverride" value="true" />
    <property name="ignoreResourceNotFound" value="true" />
</bean> 
```

这是具有我要覆盖的属性的类：

```
@Component
public class OrderService {
    private static Log logger = LogFactory.getLog(OrderService.class);

    @Autowired @Qualifier("OrderDAO") private OrderDAO orderDao;

    @Autowired private SiteManager siteManager;
    String authorizenetProperties = "classpath:authorizenet.properties";

    private Boolean testMode = false;

    public Boolean getTestMode() {
        return testMode;
    }

    public void setTestMode(Boolean testMode) {
        this.testMode = testMode;
    }

} 
```

我尝试了一些不起作用的方法：

```
com.foo.services.OrderService.testMode=true
OrderService.testMode=true 
```

可以在这里做我想做的事吗？spring 3 有新的首选方式吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-24T19:02:42.507

使用`PropertyOverrideConfigurer`属性文件中的键作为 bean name.bean 属性。当`@Component`自动扫描您的配置时，Spring 会将 bean 命名为以小写开头的非限定类名。在您的情况下，`OrderService`bean 应该命名为`orderService`. 因此，以下应该有效。

```
orderService.testMode=true 
```

您还可以通过将名称传递给组件注释来命名 bean，例如`@Component("OrderService")`或`@Component("com.foo.services.OrderService")`。这些在 Spring 3.x 中都不是新的。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:50:22.597

发布此非最佳解决方案：

您可以使用另一个 bean 解决此问题：

应用程序上下文.xml：

```
 <bean id="SiteProperties" class="com.foo.utilities.SiteProperties">
        <property name="serviceUrl" value="http://localhost:8080" />
        <property name="authorizationTestMode" value="false" />
    </bean> 
```

订单服务.java：

```
@Component
public class OrderService {
    private static Log logger = LogFactory.getLog(OrderService.class);

    @Autowired @Qualifier("OrderDAO") private OrderDAO orderDao;

    @Autowired private SiteManager siteManager;
    @Autowired private SiteProperties siteProperties;
    String authorizenetProperties = "classpath:authorizenet.properties";
} 
```

因此，只需创建一个 xml 配置的 bean 并将注解配置的 bean 注入您。

如果有人知道，我仍然想知道执行此操作的“正确”方法。

谢谢！

# c# - 从外部 C# 应用程序自动化 PowerPoint VBA 加载项

> ID：10034738
> 
> 赞同：0
> 
> 时间：2012-04-05T19:23:33.450
> 
> 标签：c#, ms-office, powerpoint

我正在设计一个 C# 应用程序，它将打开一个 PowerPoint 演示文稿，将带有动画的幻灯片拆分为单独的幻灯片，然后将整个演示文稿导出为一系列 JPG 图像。我在 Visual Studio 2010 和 Microsoft Office 2010 中工作。

该项目以[PPspliT](http://www.dia.uniroma3.it/~rimondin/downloads.php)为中心，这是另一个开发人员慷慨提供的 VBA 宏和插件，并且运行良好！（谢谢！）本质上，我希望使用外部 C# 应用程序（而不是另一个宏或 Office 加载项）自动执行此加载项。我当前的代码基于[Microsoft 的一个有用示例](http://support.microsoft.com/kb/306683)。如果要转换的 PowerPoint 文件包含`PPspliT_main`宏，`RunMacro`则示例中的函数在这样使用时可以正常工作：

`RunMacro(oPP, new Object[]{"'pres1.ppt'!PPspliT_main"});`

但是，如果宏未保存在 PowerPoint 文件本身中，则`RunMacro`函数的代码会抛出 a `TargetInvocationException`，因为宏不存在（即使安装了加载项）。我希望能够利用加载项的功能，以便可以操作任何 PowerPoint 文件，而不仅仅是其中保存了宏的文件。我想有一种简单的方法可以做到这一点。

一个类似于 的函数`Application.CommandBars.ExecuteMso("Copy")`似乎正是我所需要的，但从我读过的内容来看，听起来只有内置函数有一个 idMso，但没有自定义函数（比如这个）。这是真的？或者我可能需要编辑 PPspliT 宏代码本身以“公开”它，以便从我的 C# 应用程序中调用它？

我已经进行了大量搜索以寻找解决方案，并且发现了许多与我正在寻找的相似的文章/帖子，但它们似乎都不同，以至于它们不适用于我的情况。我是使用宏/加载项的新手，所以我的术语/理解也可能有点偏离。

任何指导将不胜感激。在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-07T17:43:07.847

您将要使用`PPspliT_main`而不是`pres1.ppt'!PPspliT_main`作为最后一个参数。

包括`pres1.ppt`告诉 PowerPoint 专门在该文件中查找宏，而仅询问宏名称应该允许您调用在加载的加载项中定义的任何公共子或函数。

# ruby-on-rails - 瑞克失败了！无法将哈希转换为字符串？

> ID：10034742
> 
> 赞同：1
> 
> 时间：2012-04-05T19:23:50.113
> 
> 标签：ruby-on-rails, ruby

如何更好地调试此消息？跟踪显示来自我的一个文件 - application.rb 的 3 行：

```
18 module CustomApp
19   class Application < Rails::Application
...
49 # Enable the asset pipeline 
```

有没有办法准确找出哪个文件引发了这个错误？

最后的痕迹：

```
/home/user/.rvm/gems/ruby-1.9.3-p0/gems/figaro-0.2.0/lib/figaro/railtie.rb:8:in `update' 
```

我觉得我已经碰壁了..出于这个原因，虽然我急于修复这个错误，但我更急于找出如何更好地调试这些消息？像“Can't convert Hash into String in somefile.rb:112”这样的事情肯定会很容易处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:49:20.683

要了解 ruby​​-debug：http: [//bashdb.sourceforge.net/ruby-debug.html](http://bashdb.sourceforge.net/ruby-debug.html)

要了解调试 Rails： http: [//guides.rubyonrails.org/debugging_rails_applications.html](http://guides.rubyonrails.org/debugging_rails_applications.html)

错误来自此文件：

```
lib/figaro/railtie.rb line 8 
```

该文件中的代码块：

```
path = Rails.root.join("config/application.yml")
ENV.update(YAML.load(File.read(path)) || {}) if File.exist?(path) 
```

解决问题的一种方法是使用 ruby​​-debug：

```
gem install ruby-debug 
```

并编辑该文件以使其显示更好的错误：

```
path = Rails.root.join("config/application.yml")
if File.exist?(path)
   debugger  
   f = File.read(path)  
   y = YAML.load(f)
   ENV.update(y || {})
end 
```

# c# - 向.Net中的进程提供输入时，如何确定输入将发送到哪个appdomain？

> ID：10034744
> 
> 赞同：2
> 
> 时间：2012-04-05T19:24:00.407
> 
> 标签：c#, .net, process, appdomain

我已经使用`System.Diagnostics.Process`该类创建了一个进程。这里是代码

```
Process p = new Process()
            {
                StartInfo = new ProcessStartInfo(@"some.exe")
            {
                CreateNoWindow = true,
                ErrorDialog = false,
                RedirectStandardError = true,
                RedirectStandardInput = true,
                RedirectStandardOutput = true,
                StandardErrorEncoding = Encoding.UTF8,
                StandardOutputEncoding = Encoding.UTF8,
                WindowStyle = ProcessWindowStyle.Hidden,
                UseShellExecute = false
            }

            };
            p.OutputDataReceived += (sender, r) =>
            {
                Console.WriteLine(r.Data);
            };
            p.Start();

            p.BeginOutputReadLine();
            int counter = 0;

            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);
            p.StandardInput.WriteLine("INPUT" + counter++);

            p.WaitForExit();
            Console.ReadKey();
        } 
```

并在 some.exe 中创建 2 个应用程序域，它们实际上是控制台应用程序。使用`AppDomain.ExecuteAsselbly("path to exe")` 所以当我向进程提供输入时，第一个加载的 appdomain 正在接受所有输入，而第二个没有接受它。
有什么方法可以确定哪个 appdomain 应该接受输入？编辑：-
我突然意识到 AppDomain 一词在这里使用不正确。实际上我的意思是当前进程中的哪个线程应该接受输入。

# sql - 由于外键不存在，无法将主键添加到 AS400 表

> ID：10034745
> 
> 赞同：1
> 
> 时间：2012-04-05T19:24:07.703
> 
> 标签：sql, ibm-midrange, db2-400

我在 IBMi/System-i/iSeries/AS400 上有一个表，它没有外键、主键或任何类型的约束。我正在尝试使用 SQL 添加主键：

`ALTER TABLE MYLIB.TBLGB ADD CONSTRAINT MYLIB.R_MYLIB_PK_GB PRIMARY KEY (GBAPP, GBTSK, GBSET, GBSTP)`

结果是：

`Error: [SQL0538] The FOREIGN key in constraint R_MYLIB_PK_GB in MYLIB not same as the parent key. Cause . . . . . : The FOREIGN key in constraint R_MYLIB_PK_GB in MYLIB is not the same as the parent key of table *N in *N. The FOREIGN key must have the same number of columns as the parent key and the data type and attributes of the FOREIGN key must be identical to the data type and attributes of the corresponding column of the parent key. Recovery . . . : Correct the statement so that the description of the FOREIGN key conforms to that of the parent key of the specified table.`

我对此完全感到困惑，因为绝对没有外键链接到该表。事实上，我已经从这个库中的所有表中删除了所有约束。我可以查看什么来确定是什么阻止了这个？

另一个有趣的细节是，这在其他基本相同的库上运行良好......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-17T14:16:06.347

很可能，保存和恢复的顺序不正确。该表具有不应保存且应在保存前删除的属性。还原导致新系统上的数据库目录包含不一致的元素。

如果不是，那么下一个可能性（并且几乎是唯一的其他可能性）是数据库目录在还原完成之前已经存在不一致。这些可能是由不当关闭或其他操作引起的。

第一步应该是：

```
RCLDBXREF OPTION(*CHECK) 
```

如果报告了问题，请运行：

```
RCLDBXREF OPTION(*FIX) 
```

如果系统对于 RCLDBXREF 命令来说太旧，请使用：

```
RCLSTG SELECT(*DBXREF) 
```

旧版本没有可用的“*CHECK”选项。

根据数据库的大小和复杂性、所需的重新同步次数和服务器的一般性能特征，其中任何一个都可以运行 10 分钟到几个小时。大多数无法解释的数据库目录问题（除了那些需要 PTF 的问题）都可以通过其中任何一个解决。

通常首选 RCLDBXREF 命令，但有些问题需要使用 RCLSTG 替代命令。RCLSTG 存在重大限制，因此请务必阅读命令 [Help]。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:54:37.317

[使用DSPFD](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=%2Fcl%2Fdspfd.htm)和[DSPDBR](http://publib.boulder.ibm.com/infocenter/iseries/v5r4/index.jsp?topic=%2Fcl%2Fdspdbr.htm)命令检查文件描述和数据库关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T20:01:54.757

约束由模式限定。因此，除非您还有一个名为 mylib 的模式，否则请删除限定条件。

它抱怨表的原因可能是因为它试图在模式 systables 中找到一个表，但这纯粹是猜想。

# xml - 使用 xml.dom.minidom 文档的 Python 问题。使用 toprettyxml() 的子元素之间的额外空行

> ID：10034747
> 
> 赞同：2
> 
> 时间：2012-04-05T19:24:20.353
> 
> 标签：xml, python-3.x, minidom

请多多包涵，因为我对 python（以及更大的编程社区）非常陌生，但我一直在由一位比我更有经验的同事指导。我们正在尝试编写一个读取 XML 的 python 脚本文件并挑选数据的某些部分，编辑一些变量值，然后重新组合 XML。我们遇到的问题是数据在使用 toprettyxml() 传递回新的 do 时被格式化的方式

基本上，文件的上半部分有一堆我们根本不需要修改的元素，所以我们试图完全抓取这些元素，然后在我们重新组合时将它们附加到根。同一页面上同一级别的一些较低元素被挑选成内存中的较小项目，并在最低的子级别重新组合。那些被手动重新组装和附加的工作正常。

所以这里应该大致是相关的代码位：

```
def __handleElemsWithAtrributes(elem):
    #returns empty element with all attributes of source element
    tmpDoc = Document()
    result = tmpDoc.createElement(elem.item(0).tagName)
    attr_map = elem.item(0).attributes
    for i in range(attr_map.length):
        result.setAttribute(attr_map.item(i).name,attr_map.item(i).value)
    return result

def __getWholeElement(elems):
    #returns element with all attributes of source element and all contents
    if len(elems) == 0:
        return 0
    temp = Document()
    for e in elems:
        result = temp.createElement(e.tagName)
        attr_map = e.attributes
        for i in range(attr_map.length):
            result.setAttribute(attr_map.item(i).name,attr_map.item(i).value)
        result = e
    return result

def __init__():
      ##A bunch of other stuff I'm leaving out...
                f = xml.dom.minidom.parse(pathToFile)
                doc = Document()

                modules = f.getElementsByTagName("Module")
                descriptions = f.getElementsByTagName("Description")
                steptree = f.getElementsByTagName("StepTree")
                reference = f.getElementsByTagName("LessonReference")

                mod_val = __handleElemsWithAtrributes(modules)
                des_val = __getWholeElement(descriptions)
                step_val = __getWholeElement(steptree)
                ref_val = __getWholeElement(reference)

                if des_val != 0 and mod_val != 0 and step_val != 0 and ref_val != 0:
                    mod_val.appendChild(des_val)
                    mod_val.appendChild(step_val)
                    mod_val.appendChild(ref_val)
                    doc.appendChild(mod_val)
               o.write(doc.toprettyxml()) 
```

不，这里的标签没有准确地保留，因为我从几个不同的区域复制了，但我相信你明白了要点。

基本上，我使用的输入看起来像这样：

```
<Module aatribute="" attribte2="" attribute3="" >
<Description>
    <Title>SomeTitle</Title>
    <Objective>An objective</Objective>
    <Action>
        <Familiarize>familiarize text</Familiarize>
    </Action>
    <Condition>
        <Familiarize>Condition text</Familiarize>
    </Condition>
    <Standard>
        <Familiarize>Standard text</Familiarize>
    </Standard>
    <PerformanceMeasures>
        <Measure>COL text</Measure>
    </PerformanceMeasures>
    <TMReferences>
        <Reference>Reference text</Reference> 
    </TMReferences>
</Description> 
```

然后当它重新组装时，它看起来像这样：

```
<Module aatribute="" attribte2="" attribute3="" >
<Description>

    <Title>SomeTitle</Title>

    <Objective>An objective</Objective>

    <Action>

        <Familiarize>familiarize text</Familiarize>

    </Action>

    <Condition>

        <Familiarize>Condition text</Familiarize>

    </Condition>

    <Standard>

        <Familiarize>Standard text</Familiarize>

    </Standard>

    <PerformanceMeasures>

        <Measure>COL text</Measure>

    </PerformanceMeasures>

    <TMReferences>

        <Reference>Reference text</Reference> 

    </TMReferences>

</Description> 
```

如何让它停止制作所有额外的空行？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-06T22:35:29.070

我有同样的问题。问题是，每次 Python 跳行时，它都会在你的树中为它添加一个 textNode。因此，`topprettyxml()`这是一个非常恶毒的功能，因为它会在您不知道的情况下将节点添加到您的树中。

其中一个解决方案是在开始解析文件时找到一种方法来擦除所有无用的文本节点（我现在正在寻找它，仍然没有找到“漂亮”的解决方案）。

逐个节点删除：

```
def cleanUpNodes(nodes):
    for node in nodes.childNodes:
        if node.nodeType == Node.TEXT_NODE:
            node.data = ''
    nodes.normalize() 
```

来自[http://mail.python.org/pipermail/xml-sig/2004-March/010191.html](http://mail.python.org/pipermail/xml-sig/2004-March/010191.html)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-10-13T15:02:19.277

谢谢你这递归工作！

```
def cleanUpNodes(self,nodes):
        for node in nodes.childNodes:
            if node.nodeType == node.TEXT_NODE and (node.data.startswith('\t') or node.data.startswith('\n') or node.data.startswith('\r') ):
                node.data = ''
            if node.nodeType == node.ELEMENT_NODE:
                self.cleanUpNodes(node)
        nodes.normalize() 
```

# android - Android makefile：在目录树中构建所有源代码，而不是一一列出文件

> ID：10034748
> 
> 赞同：0
> 
> 时间：2012-04-05T19:24:21.560
> 
> 标签：android, makefile, java-native-interface

我正在将 iPhone 游戏 (c++) 移植到 Android，我才刚刚开始。

在 Android.mk 文件中，我必须列出所有需要构建的源文件，如下所示：

```
LOCAL_SRC_FILES := importgl.c demo.c etc.c 
```

我正在移植的游戏包含数百个 .cpp 文件，有没有办法将所有源代码包含在目录树中？

**编辑：**也许有什么方法可以让eclipse自动更新makefile？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T21:34:49.747

使用[`wildcard`函数](http://www.gnu.org/software/make/manual/make.html#Wildcard-Function)有什么用？

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_SRC_FILES := $(wildcard $(LOCAL_PATH)/*.cpp) 
```

# php - 在 PHP 中按日期时间对数组中的数组进行排序

> ID：10034753
> 
> 赞同：5
> 
> 时间：2012-04-05T19:25:02.760
> 
> 标签：php, arrays, datetime, sorting

我目前在 PHP 中有一个问题，我想按创建日期对这些帖子进行排序，以便它们可以按降序显示。我一直在寻找一个 PHP 函数来做到这一点，但没有运气。

有一个简单的解决方案吗？任何想法将不胜感激:)

```
array
      0 => 
        array
          'post_id' => string '1' (length=1)
          'user_id' => string '3' (length=1)
          'post' => string 'this is a post' (length=14)
          'created' => string '2012-04-05 20:11:38' (length=19)
     1 => 
        array
          'post_id' => string '2' (length=1)
          'user_id' => string '2' (length=1)
          'post' => string 'this is a post' (length=14)
          'created' => string '2012-04-05 20:11:38' (length=19)
     2 => 
        array
          'post_id' => string '3' (length=1)
          'user_id' => string '5' (length=1)
          'post' => string 'this is a post' (length=14)
          'created' => string '2012-04-05 20:11:38' (length=19) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T19:38:04.450

试试这个：

```
<?php
$a=array(
      0 => 
        array(
          'post_id' => '1',
          'user_id' => '3',
          'post' => 'this is a post',
          'created' => '2012-04-05 20:11:40'
          ),
     1 => 
        array(
          'post_id' => '2',
          'user_id' => '2',
          'post' => 'this is a post',
          'created' => '2012-04-05 20:11:39'
          ),
     2 => 
        array(
          'post_id' => '3',
          'user_id' => '5',
          'post' => 'this is a post',
          'created' => '2012-04-05 20:11:38'
          )
);
function cmp($a,$b){
    return strtotime($a['created'])<strtotime($b['created'])?1:-1;
};

uasort($a,'cmp');
print_r($a);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-20T11:53:51.960

按指定的mysql日期时间字段和顺序对记录/ assoc_arrays数组进行排序：

```
 function build_sorter($key, $dir='ASC') {
        return function ($a, $b) use ($key, $dir) {
            $t1=strtotime(is_array($a)?$a[$key]:$a->$key);
            $t2=strtotime(is_array($b)?$b[$key]:$b->$key);
            if($t1==$t2) return 0;
            return (str_to_upper($dir)=='ASC'?($t1 < $t2):($t1 > $t2)) ? -1 : 1;
        };
    }

    // $sort - key or property name 
    // $dir - ASC/DESC sort order or empty
    usort($arr, build_sorter($sort, $dir)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:27:38.520

您可以使用[`strtotime()`](http://us.php.net/manual/en/function.strtotime.php)将时间戳转换为整数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-05T19:38:37.540

您可以使用自定义排序函数对数组进行排序，如下所示：

```
function cmp($a, $b) {
    if($a['created'] < $b['created']) {
        return 1;
    } else if ($a['created'] > $b['created']) {
        return -1;
    } else  {
        // The only option left is that they are equal
        return 0;
    }
}

usort($array, cmp); 
```

有关 usort 的更多信息，请查看[php 手册页](http://php.net/manual/en/function.usort.php)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T19:40:04.550

您可以使用[usort()](http://php.net/manual/en/function.usort.php)函数，该函数允许您根据自己的标准对数组进行排序。

```
function cmp($a, $b)
{
    if ($a['created'] == $b['created']) {
        return 0;
    }

    return ($a['created'] < $b['created']) ? 1 : -1;
}

usort($myArray, "cmp");

print_r($myArray); 
```

或者，如果您想转换为时间：

```
function cmp($a, $b)
{
    if ($a['created'] == $b['created']) {
        return 0;
    }

    $aInt = strtotime($a['created']);
    $bInt = strtotime($b['created']);

    return ($aInt < $bInt) ? 1 : -1;
} 
```

# android - ArrayList 只存储两个值

> ID：10034756
> 
> 赞同：1
> 
> 时间：2012-04-05T19:25:22.483
> 
> 标签：android, database, arraylist

```
public class ClientGame extends Activity implements OnClickListener{
Button Answer1, Answer2, Answer3, Answer4;
TextView txtQuest;
DatabaseHelper dbHelper;
Cursor cur;
String qid;
String[] _ids = {};
ArrayList<String> idList;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.clientgame);

    dbHelper = new DatabaseHelper(this);
    cur = dbHelper.getRandomQuestion();
    startManagingCursor(cur);
    qid = cur.getString(cur.getColumnIndex(DatabaseHelper.colID));

    idList = new ArrayList<String>();
    idList.add(qid);        // i take the current id 

    try
    {
        Intent extras = getIntent();
        String ID = extras.getStringExtra("_id");
        idList.add(ID); // add the previous one
        _ids = (String[]) idList.toArray(new String[0]);

        score = (TextView)findViewById(R.id.textView2);
        score.setText("Your score is " + idList);
    }
    catch(Exception e)
    {
    }

    Answer1 = (Button) findViewById(R.id.button1);
    Answer1.setText(answer1);
    Answer1.setOnClickListener(this);
    Answer2 = (Button) findViewById(R.id.button2);
    Answer2.setText(answer2);
    Answer2.setOnClickListener(this);
    Answer3 = (Button) findViewById(R.id.button3);
    Answer3.setText(answer3);
    Answer3.setOnClickListener(this);
    Answer4 = (Button) findViewById(R.id.button4);
    Answer4.setText(answer4);
    Answer4.setOnClickListener(this);    

                                                }

@Override
public void onPause()   {
    super.onPause();
    finish();           }

@Override
public void onClick(View view)  {  //correct answer check and store skore and id
    if (view == findViewById(R.id.button1))
    {           
        int i = 1;
        String ID = cur.getString(cur.getColumnIndex("_id"));

        Intent ini = new Intent(ClientGame.this, ClientGame.class);
        ini.putExtra("_id", ID);
        startActivity(ini);             
    }   

    if (view == findViewById(R.id.button2))
    {
        int i = 1;
        String ID = cur.getString(cur.getColumnIndex("_id"));

        Intent ini = new Intent(ClientGame.this, ClientGame.class);
        ini.putExtra("_id", ID);
        startActivity(ini);             
    }
    if (view == findViewById(R.id.button3))
    {
        int i = 1;
        String ID = cur.getString(cur.getColumnIndex("_id"));

        Intent ini = new Intent(ClientGame.this, ClientGame.class);
        ini.putExtra("_id", ID);
        startActivity(ini);             
    }
    if (view == findViewById(R.id.button4))
    {
        int i = 1;
        String ID = cur.getString(cur.getColumnIndex("_id"));

        Intent ini = new Intent(ClientGame.this, ClientGame.class);
        ini.putExtra("_id", ID);
        startActivity(ini);             
    }

} 
```

这里的问题是在 textview 上只显示了两个 id。最后一个和当前。我想显示用户想要的所有ID。当然不是无限的。那么我如何创建一个数组列表，假设有十个值，并且每次都存储 id？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T21:10:52.240

您只在列表中添加了两个 ID，因此行为是正确的。如果您的活动被多次创建并且您想使用上次添加的值，则必须做两件事：

*   将列表声明为静态成员：

    静态 ArrayList idList；

*   改变你分配它的方式，如下所示：

    if (idList == null) { idList = new ArrayList(); }

这将做你想要的。我建议不要再次启动活动，只需在单击按钮时更新 TextView 中的文本。

编辑 - - -

要更新 TextView 而不是再次启动活动，请执行以下操作：

```
score.setText(score.getText().toString() + ", " + ID) 
```

我只是在现有文本的末尾添加了一个逗号和新的 id。当然，您可能希望以不同的方式对其进行格式化。拥有显示的文本和新的文本应该足以获得所需的格式。

# java - java将信息存储到对象中

> ID：10034760
> 
> 赞同：-4
> 
> 时间：2012-04-05T19:25:40.720
> 
> 标签：java

这可能是一件容易的事，但我脑子里放了个屁。我创建了一个对象

```
 Student s = new Student(); 
```

我需要在该对象中存储信息。我用谷歌搜索了它，但找不到如何编码。我可以发布完整的代码，但我想自己做一些工作。我在网上看到一些帖子，人们在使用我还没有学过的代码，所以我很困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:27:56.587

那么你需要在你的`Student`类中有成员变量，例如：

```
String name; 
```

然后实现 getter 和 setter ：

```
public String getName() {
    return name;
}
public void setName(String aName) {
   name = aName;
} 
```

最后在你的程序中：

```
Student s = new Student();
s.setName("Nicolas"); 
```

由于这是涉及 OO 编程的最基本内容，我真的建议您阅读一些有关 Java 的书籍和教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:28:10.580

您可以在设置值的学生类中创建设置器/访问器方法。或用于`s.[variable]`直接访问变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:36:18.897

正如上面的帖子和评论所说，你真的应该多读一点Java，因为这是一个需要解决的非常基本的问题。但这里有一个小代码片段，可以根据您需要对学生执行的操作，帮助您朝着正确的方向前进：

```
//The class name and visibility (also static or non-static if relevant)
public class Student {

//Variables, aka the data you want to store
String name;
double GPA;
boolean honorStudent;

//A setter method, setting a specific variable to a given value
public void setName(String input) {
    name = input;
}

//A getter method, returning the data you're looking for
public String getName() {
    return name;
}

//There would most likely be getters and setters for all
//of the variables mentioned above

//A lot of the time constructors are used to automatically
//set these variables when an instance of the class is created
public Student() {
    name = "My name!";
    GPA = 3.5;
    honorStudent = true;
}

//And of course if you want to make new students with custom
//data associated with them, you can overload the constructor
public Student(String newName, double newGPA, boolean newHonorStudent) {
    name = newName;
    GPA = newGPA;
    honorStudent = newHonorStudent;
}

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:41:42.250

[http://docs.oracle.com/javase/tutorial/java/javaOO/classes.html](http://docs.oracle.com/javase/tutorial/java/javaOO/classes.html)

您将在上面的链接中找到您所询问的信息。Java 教程是一个很棒的免费资源！

# php - 如何找到用户之间的联系，以便我可以创建一个封闭的朋友圈？

> ID：10034764
> 
> 赞同：12
> 
> 时间：2012-04-05T19:25:46.960
> 
> 标签：php, mysql, connection

**大家好，**

首先，我不是想创建一个社交网络，**facebook**已经够大了！（漫画）我选择了这个问题作为例子，因为它完全符合我想要做的事情。

想象一下，我在 MySQL 中有一个`users`表和一个`user_connections`带有“朋友请求”的表。如果是这样，它会是这样的：

```
Users Table:

userid  username
1       John
2       Amalia
3       Stewie
4       Stuart
5       Ron
6       Harry
7       Joseph
8       Tiago
9       Anselmo
10      Maria

User Connections Table:

userid_request  userid_accepted
2               3
7               2
3               4
7               8
5               6
4               5
8               9
4               7
9               10
6               1
10              7
1               2 
```

现在我想**找到**朋友之间的圈子并**创建一个结构数组**并将该圈子放在数据库中（**没有一个数组可以包含另一个已经拥有的相同朋友**）。

```
Return Example:

    // First Circle of Friends
    Circleid => 1
    CircleStructure => Array(
        1 => 2,
        2 => 3,
        3 => 4,
        4 => 5,
        5 => 6,
        6 => 1,
    )
    // Second Circle of Friends
    Circleid => 2
    CircleStructure => Array(
        7 => 8,
        8 => 9,
        9 => 10,
        10 => 7,
    ) 
```

我正在尝试考虑一种算法来做到这一点，但我认为这将花费大量的处理时间，因为它会随机搜索数据库，直到它“关闭”一个圆圈。

**PS：**一个圆的最小结构长度是3个连接，限制是100个（所以守护进程不会搜索整个数据库）

**编辑：**

我想过这样的事情：

```
function browse_user($userget='random',$users_history=array()){

    $user = user::get($userget);

    $users_history[] = $user['userid'];

    $connections = user::connection::getByUser($user['userid']);
    foreach($connections as $connection){
        $userid = ($connection['userid_request']!=$user['userid']) ? $connection['userid_request'] : $connection['userid_accepted'];

        // Start the circle array
        if(in_array($userid,$users_history)) return array($user['userid'] => $userid);

        $res = browse_user($userid, $users_history);

        if($res!==false){
            // Continue the circle array
            return $res + array($user['userid'] => $userid);
        }
    }

  return false;
}

while(true){

    $res = browse_user();

    // Yuppy, friend circle found!
    if($res!==false){
            user::circle::create($res);
    }

    // Start from scratch again!
} 
```

这个函数的问题是它可以搜索整个数据库而不找到最大的圆，或者最好的匹配。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-05T23:04:08.300

在大型数据集上进行这种操作对于单个批次来说几乎总是一项（太大）的工作。在处理大量数据时，您应该不断地构建索引。每次添加“用户”或与另一个“用户”成为“朋友”时进行圈子测试，并将结果圈子存储在索引表中。然后当一个新的“用户”注册或成为另一个“用户”的“朋友”时，你应该使用你的索引数据库来根据旧的圈子找到新的圈子。

**编辑：**

我对这个问题非常感兴趣，所以我做了一个关于如何解决这个问题的 boisvert 想法的概念验证类。我将代码放在 GitHub 上：[https](https://github.com/alfreddatakillen/Six-Degrees-of-Separation) ://github.com/alfreddatakillen/Six-Degrees-of-Separation （在这里发布会有点乱）。

它似乎工作得很好。但是，我还没有使用大量数据对其进行测试。我很确定您将不得不对此进行优化，因为它基本上是一种蛮力攻击，存储途中的每一步......（如果您确实优化或使用代码，如果您推送更改，我会很高兴到 GitHub - 我可能想自己在未来的项目中使用它。）

:-)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-13T08:17:04.427

Alfred Godoy 的回答非常有用，因为应该逐步进行处理。我会尝试充实一些具体的细节。

我将讨论由“边”连接的“节点”，而不是“人”成为“朋友”。循环从 3 个增加到 4 个（或 n 到 n+1）个节点是不正确的。几个边，不形成一个循环，可以被一个新的边闭合，形成一个新的循环。

因此，我们应该维护一个边链列表，而不是（或同样）作为循环列表。例如假设这个连接表：

```
userid_request  userid_accepted
2               7
3               7
3               8 
```

然后链表应该包含这个：

```
chainid  start  end  length
1        2      3    2
1        2      8    3
2        7      8    2 
```

这种结构让您可以记录和检索任意长度的链，并给定链的两端，使用 id 和长度跟踪它。它需要空间......但这就是为您在图表中搜索周期的内存成本。它可以简化，具体取决于您想要做什么；详细说明。

顺便说一句，我假设图是无向的——换句话说，从一个节点到另一个节点的边是双向的。在连接中，id 最低的节点将始终是“请求”，而 id 最高的节点在“accepted”端。

添加新节点时，您要维护链表并查看新节点是否关闭链循环。它涉及几个查询。我给你一个。

假设在 Connection 表中添加了一个新条目：

```
userid_request  userid_accepted
@new_request    @new_accepted 
```

您可以使用查询来选择任何此类循环。您已经知道新链接及其两个节点，因此您只需要寻找一个关闭它的链：

```
select chainid, length
from chain
where (start = @new_request and end = @new_accepted)
or (end = @new_request and start = @new_accepted) 
```

（请注意，由于图形不是定向的，因此您必须寻找两个循环配置）。

为了维护链表，每次添加一条边：

*   寻找节点延长的现有链
*   寻找长度为 2 的新链。

然后当节点被移除时，你应该取出相应的链和循环——链表就足够大了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-14T08:29:04.607

您是否正在尝试做[六度分离之类的事情](http://en.wikipedia.org/wiki/Six_degrees_of_separation)

这首先看起来是一个 NP-hard 问题，因为为了计算每个圆，您必须遍历图中的每个节点以找到所有可能的圆。我相信没有简单的方法可以做到这一点，而且很可能没有办法实时做到这一点。

因此，您可能应该在作业中执行此类计算，缓存结果以提高效率。

在我的脑海中，如果我们将这个问题视为图，每个用户作为一个节点，每个关系作为一个权重为 1 的边，我们可以使用广度优先搜索从用户 1 中找到最大权重为 6 的所有路径. 在每个节点遍历（总权重为 6）中，我们搜索起始节点和当前节点是否共享一条边。如果是这样，我们关闭圆圈。它将以 2 的圆圈开始并向前扩展。如果我们达到权重 6 并且最终节点不与起始节点共享一条边，我们将丢弃该圆。

可能在真实的情况下，为了加快速度，您可以尝试为每个用户计算一个较小的总权重（比如 3）的圈子，然后尝试加入圈子以获得最多 6 个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-12T19:54:25.910

只是创建圈子的一个想法 - 每次用户尝试查看圈子时都会加载此函数：

1.  找到尚未加入任何圈子的朋友最多的用户（#1）。
2.  循环他的所有朋友，寻找一个 (#2) 拥有最多朋友但尚未加入任何圈子的人
3.  以同样的方式循环所有新找到的朋友的朋友，直到循环结束，限制 20？
4.  检查找到的最后一个用户（#20）是否是第一个用户的朋友
5.  如果是，圈完整
6.  如果不是，请检查（#19 的）朋友中是否有第一个用户的朋友。
7.  如果不是，请检查（#18 的）朋友中是否有第一个用户的朋友。
8.  继续向后循环用户，直到有人与第一个用户成为朋友
9.  圆圈完成

奇怪的尝试方式，我知道

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-17T16:28:49.007

我认为对于这种类型的工作，您应该使用 NOSQL 数据库，该数据库擅长您正在寻找的东西，可能是像 Neo4j 这样的图形数据库。

# c++ - 为什么 VC++ 2010 允许这个编译？

> ID：10034768
> 
> 赞同：5
> 
> 时间：2012-04-05T19:26:04.807
> 
> 标签：c++, visual-c++

```
std::vector<const int> vci;
vci.push_back(1);
vci[0] = 2; 
```

元素类型为`const int`时，赋值语句不应该分配给 a`const int&`吗？这不能与 LLVM 3.0 一起编译。为什么 VC++ 允许它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T19:31:13.837

虽然它是未定义的行为并且基本上*任何事情都*可能发生，包括您所看到的，但我已经跟踪到这似乎是库与标准的不兼容。特别是 VS2010 库中定义的标准分配器不符合标准。

标准规定这`std::vector<T,Allocator>::value_type`是一个 typedef 到`Allocator::value_type`. 现在默认分配器（如果没有提供）是`std::allocator<T>`for which `value_type`，根据*表 28*必须*与 T 相同*。现在在 VS2010 中标准分配器的实现`const`从类型参数中删除了限定符，所以`std::allocator<const T>::value_type`is`T`和 not `const T`。

重要的是要注意，编译器本身并不会不符合接受您提供的代码，因为它是未定义的行为，编译器可以随意做。但另一方面，在`std::allocator`执行中存在不符合项。

~~您自己已经回答了这个问题：它是*Undefined Behavior*。编译器不需要提供诊断，操作的结果可以是任何东西。检测到类型不可分配并提供有意义的错误消息（或不提供）是实现质量的一个案例~~

# php - PHP 过滤器（多个下拉列表）

> ID：10034770
> 
> 赞同：1
> 
> 时间：2012-04-05T19:26:08.927
> 
> 标签：php, mysql, search, filter

我已经浏览了互联网，甚至在这里，但是由于我缺乏 php 知识，我发现很难让它工作。我觉得我很接近（我认为）。

我正在尝试制作一个过滤页面，人们可以在其中过滤手机品牌，例如包装随附的分钟数（目前，只有两个功能，但一旦我有了这个工作，我计划添加更多）。

提前致谢！

好的，足够的细节 - 这是我的代码

过滤器.php：

```
 <?php
        include('db.php');  // include your code to connect to DB.
        $tbl_name="mobile";     //your table name

        $sql="SELECT DISTINCT model FROM $tbl_name ORDER BY model ASC"; 
        $result=mysql_query($sql); 
            $sql1="SELECT DISTINCT minutes FROM $tbl_name ORDER BY model ASC"; 
    $result1=mysql_query($sql1); 

    $model_o=""; 

    while ($row=mysql_fetch_array($result)) { 

        $model=$row["model"]; 
        $model_o.="<OPTION VALUE=\"$model\">".$model; 

    } 

    $minutes_o=""; 

    while ($row=mysql_fetch_array($result1)) { 

         $minutes=$row["minutes"]; 
        $minutes_o.="<OPTION VALUE=\"$minutes\">".$minutes;
    } 

    ?>
    <form action="result.php" method="post">
    <SELECT NAME=Model> 
    <OPTION VALUE=0>Choose 
    <?=$model_o?> 
    </SELECT> 
    <SELECT NAME=Model> 
    <OPTION VALUE=0>Choose 
    <?=$minutes_o?> 
    </SELECT> 
    <input type="submit" value="search phones" />
    </form> 
```

结果.php

```
<?php
    include('db.php');  // include your code to connect to DB.
    $tbl_name="mobile";     //your table name

$whereClauses = array(); 
if (! empty($_POST['Model'])) $whereClauses[] ="model='".mysql_real_escape_string($_POST['Model'])."'"; 
if (! empty($_POST['minutes'])) $whereClauses[] ="minutes='".mysql_real_escape_string($_POST['minutes'])."'"; 
$where = ''; 
if (count($whereClauses) > 0) { $where = ' WHERE '.implode(' AND ',$whereClauses); } 
$sql = mysql_query("SELECT * FROM $tbl_name".$where); 

        while($row = mysql_fetch_array( $sql )) 
        {
            echo "<tr>
                  <td><img src='".$row['image_url']."' alt='some_text'/></br>".$row['model']."</td>
                  <td>".$row['tariff']."</td>
                  <td>".$row['minimumcontractterm']."</td>
                  <td>".$row['minutes']."</td>
                  <td>".$row['texts']."</td>
                  <td>".$row['linerental']."</td>
                  <td>£".$row['dealcost']."</td>
                  <td>".$row['free_gift']."</td>
                  <td><button type='submit' class='green' onClick=parent.location='test/deal.php?id='><span>View</span></button></td>
    </tr>";

        // Your while loop here

        }
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-06T12:15:03.630

使用不同的方法。首先获得首选的移动品牌。和第二个选择框中的分钟。然后使用一个按钮，它将两个选择框的值都提取到 php 函数中，您可以在其中查询结果。就这样。

# javascript - 摆脱返回字符串中的时间戳

> ID：10034775
> 
> 赞同：0
> 
> 时间：2012-04-05T19:26:27.740
> 
> 标签：javascript, jquery, date, timestamp

我想摆脱这个返回字符串中的时间戳。我目前得到：“您已选择：Fri Sep 08 1978 00:00:00 GMT-0400 (EDT)”

代码是：

```
var chosenDates = $.datepicker.parseDate('yy-mm-dd', dateText);
$('.info').html('You have selected:' + '<br />' + chosenDates.toString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:32:54.543

`toString`您可以在方法中指定格式。例如：

```
var chosenDates = $.datepicker.parseDate('yy-mm-dd', dateText); 
$('.info').html('You have selected:' + '<br />' + chosenDates.toString('dd-MM-yyyy')); 
```

**编辑：**或者如果你想使用与日期选择器相同的格式：`yy-mm-dd`

**编辑：**您也可以尝试使用以下`formatDate`功能：

```
var chosenDates = $.datepicker.parseDate('yy-mm-dd', dateText); 
var backToString = $.datepicker.formatDate('yy-mm-dd', chosenDates);
$('.info').html('You have selected:' + '<br />' + backToString); 
```

# ravendb - 如何限制对 ravendb 管理面板的访问？

> ID：10034780
> 
> 赞同：9
> 
> 时间：2012-04-05T19:26:34.387
> 
> 标签：ravendb, ravendb-studio

在默认情况下运行 Raven.Server.exe 时，管理面板在 IP:PORT 地址可见。如何限制特定用户访问此面板？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-06T01:37:22.517

Steve，我们将 RavenDB 作为 Windows 服务运行，并使用 Windows 身份验证来控制访问。如果要使用 Windows 身份验证，可以将配置设置为仅允许 Windows 组访问。这样，您可以通过控制谁在 windows 组中来限制对用户的访问。

```
<add key="Raven/Authorization/Windows/RequiredGroups" value="WindowsDomain\RavenDBG"/>
<add key="Raven/AnonymousAccess" value="None"/> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-05T22:55:21.330

Steve，RavenDB 默认使用 windows 身份验证，管理工作室也不例外。您可以根据需要切换到 OAuth，这也适用于管理工作室。因此，如果您想坚持使用 raven 默认的 Windows 身份验证，只需将匿名访问设置为 none，并确保只有您喜欢的用户才能访问 raven 数据文件夹。如果你在域环境中运行，我建议你仔细检查一下，因为如果没有明确禁用域用户很可能被授予访问权限。

# javascript - 在这种情况下如何进行原型继承？

> ID：10034781
> 
> 赞同：0
> 
> 时间：2012-04-05T19:26:42.960
> 
> 标签：javascript, inheritance, prototype

我怎样才能用这个例子做继承。

**我正在尝试创建一个用作单例的对象文字。在此我想提取我的课程。除此之外，这些类应该在适用时相互继承**。

像这样：

```
var Singleton = {

    car: function() {
        this.engine= true;
    },

    ford: function() {
        this.color = 'red';
    }
}; 
```

**我想让福特从酒吧继承，但我不能这样做**：

```
 ford: function() {
        this.color = 'red';
        this.prototype = new this.car();
    } 
```

**有任何想法吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:03:41.557

```
var Something = {

    foo: function() {
        this.greet = 'hello';
    },
    bar: function() {
        this.color = 'blue';
    }
};

Something.bar.prototype = new Something.foo();
alert((new Something.bar()).greet) 
```

这是[继承的入门](http://elsamman.com/?p=4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:40:39.880

如果你试图`bar`继承的属性，`foo`那么你可以做这样的事情（注意，这样你就不会继承原型属性）：

```
var Something = {
    foo: function() {
        this.greet = 'hello';
    },
    bar: function() {
        Something.foo.call(this);
        this.color = 'blue';
    }
}; 
```

然后像这样使用它：

```
var bar = new Something.bar();
bar.color // blue
bar.greet // hello 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:43:31.580

你可以这样做：

```
function Foo() {
    this.greet = "hi!";
}

Bar.prototype = new Foo;

function Bar(color) {
    Foo.apply(this.arguments);
    this.color = color;
}

var myBar = new Bar("red"); 
```

以这种方式创建的 A`Bar`将同时具有 `greet`和`color`属性。此方法保留 Prototype 属性。

# c++ - C/C++ linux 共享库可以通过将磁盘上自己的文件覆盖到更新版本来自动更新吗？

> ID：10034785
> 
> 赞同：3
> 
> 时间：2012-04-05T19:26:51.757
> 
> 标签：c++, linux, shared-libraries, auto-update

本题主要针对Linux平台编译的共享库（.so文件）。下次启动依赖于它的程序时，是否会自动加载新的库文件？如果没有，是否有不同的方法来实现这种无声的、独立的库更新？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-05T19:32:53.853

如果您删除然后重新创建相同的文件，许多基于 Unix 的操作系统具有允许此类内容的文件系统。据 Vlad Lazarenko 和我所知，Windows 和 DOS 是唯一不能做到这一点的操作系统。

只要打开一个文件，它就会一直保存到不需要它为止。当你删除它时，它在 fs 中是不可见的，但它仍然存在。它适用于所有类型的文件。

但是您可能需要 root 权限才能在库上执行此操作。您应该注意多个库之间的同步和依赖关系。您可以快速将 h 运行到 liba v1.0 只能与 libb v1.0 一起使用的情况，并且当您自动更新 liba 时，它会失败。

至少有两个著名的程序正在使用这种技术：*apt*和*rpm*。

**编辑**：如果您按照删除/重新创建模式更新您的库，那真的没有问题。您的旧但正在使用的库仍然存在于内存和磁盘中。如有必要，您的操作系统能够在磁盘上重新加载库的一部分。

只要*所有*使用它的程序都关闭，您的库仍然在磁盘上。甚至对于 libc 也是如此。这就是为什么当你更新你的 libc 时，你会被邀请重新启动几乎所有使用它的服务，以便将它们更新为新的二进制代码。

这也是为什么您可以热更新Linux系统而无需重新启动它多年的主要原因。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T20:30:39.520

如果在 Linux 上，具有良好的 Linux 文件系统（例如 ext3 或 ext4 或 btrfs），您可以使用它更新`libfoo.so`进程和程序（例如`bar`）中的共享库（例如）（例如`dlopen`-ing that `libfoo.so`）

你最好有

1.  将[（2）](http://linux.die.net/man/2/rename)旧的重命名`libfoo.so`为例如`libfoo-old.so`
2.  [dlopen(3)](http://linux.die.net/man/3/dlopen)的新版本`libfoo.so`
3.  到`dlsym`你想要的里面
4.  也许[dlclose(3)](http://linux.die.net/man/3/dlclose)旧版本的旧版`dlopen`句柄；如果没有活动的调用框架指向，你只能这样做`libfoo-old.so`（否则你的程序在返回到这样的调用框架时会崩溃）。
5.  取消[链接（2）](http://linux.die.net/man/2/unlink)如果`libfoo-old.so`需要

（您可以避免`rename`，甚至可以`unlink`使用 active `dlopen`-ed 库；如果没有进一步的目录条目或进程文件描述符指向它，内核将删除它；我不建议这样做，例如为了简化潜​​在`core`转储的调试）。

一个更简单但更“泄漏”的替代方案是 never `dlclose`。在实践中，一个程序可以`dlopen`有几十万`*.so`，不用担心。请参阅我的旧[manydl.c](http://starynkevitch.net/Basile/manydl.c)示例。

另请阅读有关[动态软件更新](https://en.wikipedia.org/wiki/Dynamic_software_updating)的信息。

为了更好地理解 Linux 上的共享库，请阅读 Drepper 的论文[*如何编写共享库*](https://www.akkadia.org/drepper/dsohowto.pdf)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:41:01.053

你已经收到了一些很好的答案（尤其是 Coreen 的），所以我想我会问一个问题。你真的想这样做吗？除非您正在修复错误，并保证不会更改函数签名......最好提高版本号并部署新版本，不是吗？

# .net - 如何访问 RadGridView 中计算列的单元格的值

> ID：10034786
> 
> 赞同：0
> 
> 时间：2012-04-05T19:26:53.683
> 
> 标签：.net, wpf, telerik, radgridview

有没有办法在 RadGridView 中获取计算列的值？

我的代码中有一部分在其中迭代了 RadGridView 中显示的所有项目。计算列的值不存在。我想知道我怎样才能得到它们。

现在我正在迭代网格绑定到的项目集合。我正在使用 GridViewExpressionColumn 将此计算的列添加到网格中。

编辑：

```
 GridViewColumn column = new GridViewExpressionColumn
                    {
                        UniqueName = columnViewModel.LayoutColumnId.ToString(),
                        Name = name,
                        Expression = expression,
                        IsReadOnly = isReadOnly,
                        ToolTipTemplate = CreateTooltip(columnViewModel.FormulaText),
                        IsSortable = false,
                        IsFilterable = false
                    };

    grid.Columns.Add(column) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:57:58.733

首先，确保每列都以 UniqueName 命名。

然后在遍历每个网格项时，您可以使用代码访问文本：（对于 ASP.NET AJAX）

```
foreach (GridDataItem DataItem in grid1.Items)
{
    var CalculatedColumnText = DataItem["CalculatedColumn"].Text;
} 
```

（用于 WPF/SILVERLIGHT） -[来自 Telerik 论坛](http://www.telerik.com/community/forums/wpf/gridview/radgridview-export-doesn-t-export-columns-of-type-gridviewexpressioncolumn.aspx#1902841)

```
 var col = GridView1.Columns["CalculatedColumn"] as GridViewExpressionColumn;
        foreach (var GridItem in GridView1.Items)
        {                
            var cellValue = col.GetValueForItem(GridItem);

        } 
```

您可以将文本转换为您需要的任何数据类型。

编辑：起初我认为它是 ASP.NET 而不是 WPF/Silverlight。我把两个答案都留下了。

# windows - .NET 应用程序“异常处理消息”中的 Vista 异常

> ID：10034787
> 
> 赞同：8
> 
> 时间：2012-04-05T19:27:01.890
> 
> 标签：windows, exception, windows-vista

# 背景

我在 4.0 框架上构建了一个 VB .NET 应用程序，主要功能的一部分是内置的 AxWMPLib.AxWindowsMediaPlayer，它允许我们将文件路径作为 URL 传递给播放器，然后通过内置的媒体播放器播放它。我的开发平台是 Windows 7 上的 VS 2010 Pro。

# 问题

我们最近开始在多个操作系统上测试这个应用程序。该应用程序在多台 win7 机器上的 Win 7 上运行良好，有些用于开发，有些则不用于开发。问题是当我们在 Vista 上运行应用程序时。应用程序在打开文件后第一次尝试播放文件时会抛出错误

![在此处输入图像描述](../Images/5db9a99a5b4041363e4550b96aea1f14.png)

它在大多数情况下都会这样做，但并非总是如此，而且在几次它没有引发错误的情况下，我一直无法建立模式。此外，它只对它播放的第一个文件执行此操作，而不是对后续文件执行此操作。并且它避开了用于错误处理的 Try 捕获。

# 研究

我对这个问题做了很多研究。我发现它似乎困扰着其他媒体播放器和网站，甚至是某些机器上的 WMP。一些文章指向特定的 Windows KB 更新，另一些文章建议运行修复磁盘来修复潜在的坏 dll。我已经尝试了很多都没有成功，因为问题在我必须测试的两台 Vista 机器上仍然存在。

# 代码

这是发生此错误时调用的方法

```
Public Sub playSelected(ByVal fileStr As String)
    If File.Exists(fileStr) Then
        Debugging.DebugPrint(" Play: " & fileStr)
        MediaPlayer.URL = fileStr
        Try
            MediaPlayer.Ctlcontrols.play()
        Catch ex As Exception
            MessageBox.Show("Could Not play the selected File please try again.  Exception : " + ex.Message)
        End Try
    Else
        Debugging.DebugPrint(" File Does not Exist: " & fileStr)
    End If 
End Sub 
```

# 目的

我希望找到一种方法来通过代码处理此异常，如果它是从我正在使用的一个.NET 控件中抛出的，则可能进行预览或狙击。如果可能的话，我宁愿通过代码来处理这个问题。如果有人也有关于这个特定错误的其他信息，那也是受欢迎的。

# 解析度

感谢 jornare 提供的信息并朝着正确的方向前进，我将解释我的解决方案，以及下面的代码，希望对您有所帮助。

首先，我必须以几种不同的方式修改推荐的答案。在调用上述 playSelected 方法的类中声明了以下两行。

```
Public Declare Function SetErrorMode Lib "kernel32.dll" (ByVal uMode As System.UInt32) As System.UInt32
Private Const SEM_FAILCRITICALERRORS As System.UInt32 = &H1 
```

您将看到添加了名为 SEM_FAILCRITICALERRORS 的 Const 变量，这是将变量的值设置为 1 所必需的，在这种情况下，变量的名称非常具体，因为它与 SetErrorMode 方法中的标志 var 名称匹配，当设置为 true 此标志禁用 CriticalErrors 显示。我还将 .dll ext 添加到 Lib 调用中，尽管它可能不是必需的。

下面是我的新 playSelected 方法

```
Public Sub playSelected(ByVal fileStr As String)
    If File.Exists(fileStr) Then
        If isVista Then
            oldErrMode = SetErrorMode(SEM_FAILCRITICALERRORS)
        End If
        Debugging.DebugPrint(" Play: " & fileStr)
        MediaPlayer.URL = fileStr
        Try
            MediaPlayer.Ctlcontrols.play()
        Catch ex As Exception
            MessageBox.Show("Could Not play the selected File please try again.  Exception : " + ex.Message)
        End Try
        If isVista Then
            criticalFailureTimer.Interval = 2000
            criticalFailureTimer.AutoReset = False
            criticalFailureTimer.Start()
        End If
    Else
        Debugging.DebugPrint(" File Does not Exist: " & fileStr)
    End If

End Sub 
```

现在这很重要！最初我在 ctlcontrols.play 调用后将 SetErrorMode 恢复为 oldErrMode，但发现这并没有阻止错误。我在我的 win7 机器上将我的 VS 设置为调试模式，并逐行执行代码。我发现代码直到 sub 结束后才真正尝试播放文件。这就是您看到计时器调用的原因。我设置了一个 2 秒的计时器给自己一个缓冲区，这样它就可以在错误模式设置正确的情况下开始播放过程。下面是我用于计时器经过事件的代码

```
'in my Constructor
If My.Computer.Info.OSFullName.Contains("Vista") Then
    isVista = True
    AddHandler criticalFailureTimer.Elapsed, AddressOf criticalTimerExpired
End If
'end of Constructor portion

Private Sub criticalTimerExpired(sender As Object, e As ElapsedEventArgs)
    SetErrorMode(oldErrMode)
End Sub 
```

最后一个警告，我会给出这个。据我了解，此过程会禁用显示严重错误，因此请注意，在我的情况下，我无法找到由引发的错误引起的任何特定错误或系统不稳定，因此我暂时禁用此功能以增加程序的可用性。我不建议您每次遇到系统错误时都这样做，因为该错误通常指向程序中应该修复的缺陷/错误。此外，在我看来，您永远不需要永久关闭严重错误，这意味着确保在完成后重新打开它们。我希望这些信息能帮助并感谢那些回答或支持该问题的人的时间和知识。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-15T19:22:57.250

根据我在网上找到的信息，这可能是由错误的 WMP 插件、codek 或显示驱动程序引起的。还发现您应该能够通过在 WMP 开始加载媒体文件之前调用 Windows API 函数 SetErrorMode(SEM_FAILCRITICALERRORS) 来抑制此错误。

因此，对于 Vb 类似：

```
'declare
Private Declare Function SetErrorMode Lib "kernel32" (ByVal wMode As Long) As Long

'call it
Dim oldErrMode  As Long
oldErrMode = SetErrorMode(SEM_FAILCRITICALERRORS)

'Do your stuff here

'Set it back
SetErrorMode(oldErrMode ) 
```

我还没有测试过这个，所以让我知道这是否有帮助。

# jquery - jQuery Datepicker 在 dateFormat 切换后不更新日期？

> ID：10034791
> 
> 赞同：0
> 
> 时间：2012-04-05T19:27:22.287
> 
> 标签：jquery, datepicker

我需要在一个函数中更新所有日期选择器的 dateFormat，这样我就不必手动更改所有现有的日期选择器。

```
$('.hasDatepicker').datepicker('option', 'dateFormat', "MM d, yy");
$('.hasDatepicker').datepicker('refresh'); 
```

那行不通:(有类似`dateFormat`经验的人有答案吗？

# r - 如何在 R 中读取由不等间距分隔的列的表

> ID：10034800
> 
> 赞同：1
> 
> 时间：2012-04-05T19:28:03.043
> 
> 标签：r, parsing, dataframe

这是数据框的一列。我想进一步分成 4 列。问题是每列之间的空间根据数字而不同。

```
 -92 -100    0   29   
  ··   ··    0   29  
   0    0    0    0  
  --   --   --   --
 -93   21   ··   ·· 
```

第一行 // -92 和 -100 之间有 1 个空格，100 和 0 之间有 4 个空格，0 和 29 之间有 3 个空格。

第 2 行 第 1 列和第 2 列之间有 3 个空格，第 2 和第 3 列之间有 3 个空格，第 3 和第 4 列之间有 3 个空格

第三行
每列之间有 4 个空格

每列之间的第 4 行
3 空格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:55:16.083

我认为问题的答案（在编辑问题以将数据布局更改为等距字体之后）`read.fwf`是在“utils”包中，因此它应该可以在不需要加载任何东西的情况下使用。

```
read.fwf(file=textConnection(" -92 -100    0   29   
   ··   ··    0   29  
    0    0    0    0  
   --   --   --   --
  -93   21   ··   ··"), header=FALSE, widths=c(4,5,4,4))
#------------------
    V1    V2   V3   V4
1  -92  -100      0   
2   ··    ··      0   
3    0     0      0   
4   --    --    - -   
5  -93    21    · · 
```

# c - 编译错误 - sysdeps/i386/elf/start.S 和未定义的 main 引用

> ID：10034802
> 
> 赞同：1
> 
> 时间：2012-04-05T19:28:12.103
> 
> 标签：c, linux, clipper

我正在使用一个名为 Harbor 的开发平台来使用 Clipper 代码创建一个在 32 位 SuSe 上运行的 Linux 可执行文件。

我已经可以创建一个仍然需要平台外部库的可执行文件，但我需要创建一个独立的可执行文件。Harbor 允许我通过包含所有需要的库来做到这一点，但是当我尝试以下编译命令时：

```
hbmk test3 -static 
```

我得到以下错误输出：

```
Harbour 2.0.0 (Rev. -1) 
Copyright (c) 1999-2010, http://www.harbour-project.org/ 
Compiling 'test3.prg'... 
Lines 3, Functions/Procedures 1 
Generating C source output to 'test3.c'... Done. 
/usr/lib/gcc/i586-suse-linux/4.5/../../../crt1.o: In function 
`_start': 
/usr/src/packages/BUILD/glibc-2.11.2/csu/../sysdeps/i386/elf/start.S: 
115: undefined reference to `main' 
./test3.o: In function `HB_FUN_MAIN': 
test3.c:(.text+0x17): undefined reference to `hb_vmExecute' 
./test3.o: In function `hb_vm_SymbolInit_TEST3': 
test3.c:(.text+0x4e): undefined reference to `hb_vmProcessSymbols' 
./test3.o:(.data+0x38): undefined reference to `HB_FUN_QOUT' 
/tmp/cc5KcKMd.o: In function `hb_lnk_SetDefault_build': 
hb-build-root-24212.c:(.text+0x1e): undefined reference to 
`hb_vmSetDefaultGT' 
/tmp/cc5KcKMd.o: In function `_hb_lnk_ForceLink_build': 
hb-build-root-24212.c:(.text+0x8): undefined reference to 
`HB_FUN_HB_GT_STD' 
collect2: ld returned 1 exit status 
```

我此时的代码非常简单和愚蠢：

```
function main() 
? "All done." 
return nil 
```

（它基本上将“All done.”输出到屏幕上，这就是我所做的一切，直到我可以让它正确编译为止。）

从我试图追查这个问题的 90 分钟来看，它听起来要么找不到函数“main”（显然在那里），或者 c 编译器需要 -g 参数集——这是我能做到的t 这样做是因为我自己并没有真正解决编译器问题——Harbor 编译器自己做所有事情......

我还想指出路径

```
/usr/src/packages/BUILD 
```

我的系统上是空的！但是，顶部错误中提到的完整路径被硬编码到文件 crt1.o...

我什至尝试告诉编译器创建 ac 对象并对其进行编译，但它不会为 c 编译器生成正确的输入文件，而且我对 Clipper 和 c 都很陌生...

如果我没有正确标记这个问题，我深表歉意——这是我的第一篇 stackoverflow 帖子——但我在这里看到了很多关于其他主题的知识渊博的答案，所以我决定试一试。如果需要更多信息，请告诉我。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-06T20:48:22.223

我想出了一个解决办法。

我安装了一份 Debian（而不是 OpenSuSe）并再次尝试，这次我不再遇到上面的错误。

遇到了一些缺少库的问题，并且在编译器不断抱怨缺少它们之后，不得不安装 gcc 和各种 zlib 或 libz 库：

```
/usr/bin/ld: cannot find -l[xyz] 
```

但我一直在尝试使用 Synaptic 包管理器的搜索和安装库，直到它起作用。

最后，又少了一个库：

```
/usr/bin/ld: cannot find -lz 
```

那个需要一些谷歌的工作，但我发现我需要安装的库是**zlib1g-dev**，安装后，它编译正常！

下一个障碍是，当在另一台计算机上运行新的可执行文件时，它需要更多的库，所以我告诉我的编译器包含所有静态库——它终于奏效了！

所以现在我有了我工作的独立可移植可执行文件，希望其他人遇到同样的问题（尽管不太可能）并在这里找到帮助。

问题解决了。

# spring-mvc - 春天MVC | requestDispatcher & sendRedirect

> ID：10034804
> 
> 赞同：4
> 
> 时间：2012-04-05T19:28:18.643
> 
> 标签：spring-mvc

是否有提供框架/特定方式，我们可以执行 requestDispatcher 和 sendRedirect 类似于简单的 Java EE MVC 应用程序？

请提出方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T20:13:08.120

你可以像这样在春天重定向

```
@RequestMapping(method = RequestMethod.POST)
    public String processForm(ModelMap model) {            
        // process form data

        model.addAttribute("notification", "Successfully did it!");
        return "redirect:/form";
    } 
```

# .net - 配置 IPv4 和 6 时获得本地机器完全限定域名的最可靠方法

> ID：10034806
> 
> 赞同：1
> 
> 时间：2012-04-05T19:28:19.860
> 
> 标签：.net, ipv6

我需要本地机器 (app01.example.com) 的 FQDN。

通常，我会使用 System.Net.Dns.GetHostName()，但如果您查看[Dns.GetHostName() 文档底部的社区内容](http://msdn.microsoft.com/en-us/library/system.net.dns.gethostname.aspx)，您会注意到在使用时有一些奇怪的行为启用了 IPv4 和 6 的机器。

我不*知道*运行我的代码的服务器是否会配置 IPv6。他们绝对会配置 IPv4。

鉴于这些限制，您认为获取我的机器的 FQDN 最可靠的方法是什么？

参考 SO 问题：

*   [如何获取本地机器名称？](https://stackoverflow.com/questions/662282/how-do-i-get-the-local-machine-name)
*   [SystemInformation.ComputerName、Environment.MachineName 和 Net.Dns.GetHostName 之间的区别](https://stackoverflow.com/questions/1233217/difference-between-systeminformation-computername-environment-machinename-and)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T13:30:11.513

```
Dns.GetHostEntry("localhost").HostName 
```

其他人在[这里](http://blogs.microsoft.co.il/blogs/zuker/archive/2010/06/05/get-the-fully-qualified-domain-name-fqdn-in-net-c.aspx)发布了这个。

# cakephp - CakePHP：身份验证错误，即使是允许的操作

> ID：10034807
> 
> 赞同：2
> 
> 时间：2012-04-05T19:28:40.377
> 
> 标签：cakephp, authentication

在我的 Cake 应用程序中，我正在执行基本身份验证。我更喜欢保持简单和语义化（不喜欢 ACL），所以我只是检查用户的角色，并相应地允许或拒绝。

现在，授权所有功能都按预期进行，但我遇到了一个奇怪的问题，无论用户是否尝试允许的操作，都会显示 Auth 错误消息。在他们注销后它仍然可见。

这是应用控制器：

```
public $components = array(
    'Session',
    'Password',
    'Auth' => array(
        'loginRedirect' => array('controller' => 'users', 'action' => 'index'),
        'logoutRedirect' => array('controller' => 'pages', 'action' => 'display', 'home'),
        'authError' => "Sorry, you're not allowed to do that.",
        'authorize' => array('Controller')
    ),
    'RequestHandler'
);

public function beforeFilter() {
    $this->set('loggedIn', $this->Auth->loggedIn());
    $this->set('current_user', $this->Auth->user());
    $this->set('admin', $this->_isAdmin());
    $this->set('coach', $this->_isCoach());
    $this->Auth->allow('login', 'logout', 'display');
}

public function isAuthorized($user) {
    if (isset($user['role']) && $user['role'] === 'admin') {
        return true;
    }
    return false;
} 
```

来自另一个控制器的 beforeFilter 和 isAuthorized：

```
public function beforeFilter() {
    parent::beforeFilter();
}

public function isAuthorized($user) {
    if ($user['role'] === 'coach') {
        if ($this->action === 'index') {
            return true;
        }
        if (in_array($this->action, array('view', 'edit', 'delete'))) {
            $id = $this->request->params['pass'][0];
            $this->User->id = $id;
            if ($this->User->field('client_id') === $user['client_id'] ) 
                return true;
            } else {
                return false;
            }
        }
        return false;
    }
    return parent::isAuthorized($user);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T21:32:33.323

我决定在我的用户控制器中执行此操作，并且一切似乎都运行良好，而且它更干净/更具可读性：

```
public function isAuthorized($user = null) {
    switch($this->action) {
        case "index":
        case "add":
            if ($user['role'] == 'coach') {
                return true;
            }
            break;

        case "view":
        case "edit":
        case "delete":
            $id = $this->request->params['pass'][0];
            $this->User->id = $id;
            if ($user['role'] == 'coach' && $this->User->field('client_id') == $user['client_id']) {
                return true;
            }
            break;
    }
    return parent::isAuthorized($user);
} 
```

# ruby-on-rails - 无法在 rails 2.3.8 上卸载 rake 0.9

> ID：10034812
> 
> 赞同：3
> 
> 时间：2012-04-05T19:28:52.293
> 
> 标签：ruby-on-rails, rubygems, rake, ruby-on-rails-2, rakefile

我正在处理一个遗留 Rails 2.3.8 项目并设置一个开发服务器。

当我尝试运行时出现错误`rake`，我意识到我安装了错误版本的 Rake，在 Rakefile 中它说：

```
s.add_dependency 'rake', '>= 0.7.1' 
```

我安装了 0.9.2.2。当我尝试卸载时，我得到

> 错误：执行 gem ... (Gem::InstallError) 时无法卸载，请检查`gem list -d rake`

我没有安装 RVM，我看到的所有与解决此问题相关的帖子都提到了 RVM，所以我被卡住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:46:46.747

我自己遇到了这个错误。我不知道*为什么*会这样，但我确实想出了如何解决它。

它给出了一个错误，因为它有一个 gemspec 记录，而 gem 目录中没有实际的 gem。

您可以通过手动删除 gem 目录中的 gemspec 来解决此问题。

首先，您需要弄清楚 gem 认为它的位置。您可能可以这样做：

```
 echo $GEM_PATH 
```

如果你在 *nix 上，你也可以试试`/usr/lib/ruby/gems/`

否则谷歌找出如何找到你的宝石目录。

gem 目录有子目录，我发现与修复相关的子目录是：`gems` `specifications`和`cache`

你正在寻找类似的东西`rake-0.9.2.2`

如果要在其中找到 gem，`gems`那么它会为我卸载，但事实并非如此。但是我确实找到`rake-0.9.2.2.gemspec`了 in`specifications`和`rake-0.9.2.2.gem`in `cache`。当我删除这两个时，我不再收到错误消息。

# django - django 将旧的日期时间字段转换为新的 1.4 日期时间，在 SQLite 中具有时区意识

> ID：10034823
> 
> 赞同：4
> 
> 时间：2012-04-05T19:29:34.607
> 
> 标签：django, django-models

我有一个 django 1.3 项目，我正在添加将按特定时间表运行的文本通知。因此，我需要该应用程序能够感知时区。看起来 django 1.4 处理得很好。问题是我使用 SQLite for db，它不存储时区信息，所以我必须转换。我是 django 新手。关于如何将 SQLlite 中的日期时间字段转换为时区感知字段的任何建议。

顺便说一句，当我在升级到 django 1.4 并激活时区支持后启动 manage.py shell 时，我收到以下消息：

```
RuntimeWarning: SQLite received a naive datetime (2012-04-05 15:18:49.939725) while 
time zone support is active. RuntimeWarning) 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T21:51:28.147

您不会将 SQlite 中的日期时间字段转换为时区感知字段。在 SQlite 中，日期时间仍然是幼稚的，但会转换为 UTC。并且可以在应用程序级别使用时区感知日期时间。

例如，当您从 SQlite 查询具有日期时间字段的模型实例时，Django：

1.  从 SQLite 获取原始日期时间，将其设置为具有 UTC 时区的感知日期时间
2.  因此，当您访问 model_instance.datetime_field 时，它已经知道时区并本地化为 UTC
3.  然后在模板中，例如，您可以将其本地化到当前时区

**编辑**：更正了我最初的错误答案，关于你在模型实例上得到了什么。

如果当前 SQlite 数据库中的日期时间不是 UTC，则需要进行一次性迁移以将它们全部转换为 UTC。（而 UTC 我只是指天真的 UTC 值。作为 SQlite - 以及 MySQL - 没有存储时区信息的日期时间字段）

我建议您非常仔细和彻底地阅读时区相关文档：[https ://docs.djangoproject.com/en/1.4/topics/i18n/timezones/](https://docs.djangoproject.com/en/1.4/topics/i18n/timezones/)

这很容易出错。

是的，您将获得`RunTimeWarning`代码“提供”天真的日期时间给 Django 进行保存的每个实例。您必须逐步修复这些问题，让它们具有时区意识。

# c++ - 如何使用 Qt 构建静态库和可执行文件？

> ID：10034825
> 
> 赞同：31
> 
> 时间：2012-04-05T19:29:42.853
> 
> 标签：c++, qt, qmake

为了简化情况，假设有 2 个文件：`core.cpp`和`main.cpp`.

`core.cpp`包含程序的功能并`main.cpp`包含基本`main()`实现。

我想要 Qt（使用 qmake 和 .pro 文件）

*   先建`core.a`后
*   使用它并`main.cpp`构建`main.exe`.

如何在 qmake 文件中进行设置？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-04-05T21:39:34.067

文件系统布局：

```
MyProject
|_ myproject.pro
|_ core
   |_ core.cpp
   |_ core.h
   |_ core.pro
|_ app
   |_ main.cpp
   |_ app.pro 
```

我的项目.pro：

```
TEMPLATE = subdirs
CONFIG += ordered
SUBDIRS = core \
          app
app.depends = core 
```

核心.pro：

```
TEMPLATE = lib
CONFIG += staticlib
HEADERS = core.h
SOURCES = core.cpp 
```

应用程序专业版：

```
TEMPLATE = app
SOURCES = main.cpp
LIBS += -L../core -lcore
TARGET = ../app-exe # move executable one dire up 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-02T20:54:01.253

如果您正在使用静态库中的资源，您也应该将它们导入您的应用程序中。`Q_INIT_RESOURCE`是将资源文件导入应用程序的方式。

假设您有一个资源文件，其文件名与`myResources.qrc`静态库中的一样。然后，您应该在应用程序中初始化它，如下所示：

```
QApplication a(argc, argv);

Q_INIT_RESOURCE(resources); //Magic is here.

MainWindow w;
w.show();
a.exec(); 
```

对于 Masci 给出的很好的例子，.pro 文件可能会被修改如下：

```
TEMPLATE = lib
CONFIG += staticlib
HEADERS = core.h
SOURCES = core.cpp
RESOURCES += myResources.qrc 
```

# ruby-on-rails - Backbone + Jasmine 在路由器中测试 AJAX 成功回调

> ID：10034827
> 
> 赞同：1
> 
> 时间：2012-04-05T19:29:58.440
> 
> 标签：ruby-on-rails, backbone.js, coffeescript, jasmine

假设我有以下骨干路由​​器：

```
class App.Routers.ThingsRouter extends Backbone.Router
  initialize: -> new App.Collections.ThingsCollection()

  index: ->
    that = this
    @collection.fetch success: ->
      view = new App.Views.ThingsIndex(collection: that.collection)
      $('#app-container').html(view.render().el) 
```

我需要编写一个 Jasmine 间谍来监视它并确保它`App.Views.ThingsIndex()`被调用。但是，由于它是 AJAX，因此以下内容不起作用：

```
describe 'index', ->
  @router = new App.Routers.ThingsRouter()
  spyOn(@router.collection, 'fetch')
  fake = { render: -> '' }
  @previewsIndexStub = spyOn(Periscope.Views, 'PreviewsIndex').andReturn(fake)
  @router.index()
  expect(@previewsIndexStub).toHaveBeenCalled() 
```

因为 Jasmine 在 AJAX 调用完成之前运行了期望函数。有没有像这样测试回调的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:36:06.893

使用 jasmines 内置的 waitsFor & 运行方法，以便在执行期望函数之前等待 ajax 调用完成。有关这两个函数的文档，请参阅[Jasmine - 异步规范](https://github.com/pivotal/jasmine/wiki/Asynchronous-specs)。

```
describe 'index', ->
  @router = new App.Routers.ThingsRouter()
  spyOn(@router.collection, 'fetch')
  fake = {}; fake.render = -> '';
  @previewsIndexStub = spyOn(Periscope.Views, 'PreviewsIndex').andReturn(fake)
  @router.index()
  waitsFor => @previewsIndexStub.wasCalled
  ###
  Or if you want to wait for the method to be called more than once
  use form waitsFor => @previewsIndexStub.callCount > 1
  ###
  runs => expect(@previewsIndexStub).toHaveBeenCalled() 
```

# java - java错误字符串不适用于参数（列表 )

> ID：10034831
> 
> 赞同：0
> 
> 时间：2012-04-05T19:30:19.650
> 
> 标签：java, string, list, arraylist

嗨，我不断收到以下错误：

> UnitForm 类型中的方法`setOfficeCode(String)`不适用于参数 ( `List<String>`)

我拥有的java代码是：

```
public static void main(String[] args)   
   {   
       UnitForm uform = (UnitForm) form;

      List<String> lines = new ArrayList<String>();   

      lines.add("Once upon a midnight dreary");   
      lines.add("While I pondered weak and weary");   
      lines.add("Over many a quaint and curious volume of forgotten lore");   

      String[] linesArr = lines.toArray(new String[lines.size()]);   

      for (String line : linesArr)   
      {   
         System.out.println(line);   
      }  

      uform.setOfficeCode(lines);
   } 
```

我正在尝试将行中包含的内容输出到我的jsp中的formbean，如果我将setOfficeCode转换为列表，我在jsp上看到的内容会出现[]，就像[在许多古朴而好奇的被遗忘的传说中, Hi, Bye] 而且我不希望括号出现在 jsp 上的数据周围，我想将它们分成单独的行而不是整个字符串，以便 hi 在新行上，而 bye 在新线等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:31:56.647

您`setOfficeCode`需要一个字符串作为参数，并给它一个字符串列表。要么更改`setOfficeCode`定义，使其接受一个列表，要么在方法调用时只传递列表中的一个字符串。

另外，您不需要数组转换，您也可以这样做：

```
for (String line : lines)   
{   
   System.out.println(line);   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:35:04.957

setOfficeCode{String input) 不等于 setOfficeCode(List input)。

该错误准确而明确地告诉您出了什么问题。

所以，你的问题实际上是不了解你的代码是如何工作的。

您需要做的是在以适当的 HTML 格式输出数据之前准备数据，或者修改您的 JSP 以处理列表而不仅仅是字符串。

最简单的方法是使用 commons-lang 库（可能已经在您的类路径中）并执行以下操作：

`uform.setOfficeCode(StringUtils.join(lines, "<br/>"));`

# c++ - C++ 缓冲池？

> ID：10034839
> 
> 赞同：2
> 
> 时间：2012-04-05T19:31:10.700
> 
> 标签：c++, stl

我有一个强大的用例来预先分配我需要的所有内存并在完成后释放它。

我提出了这个真正简单的缓冲池 C++ 实现，我必须对其进行测试，但我不确定我尝试使用的指针算法是否允许我这样做。基本上是我接下来要做的事情并发布。我更喜欢这个想法的一些技巧，而不是依赖任何类型的内存处理程序，这只会使客户端代码更加复杂。

```
#include <stdio.h>
#include <queue>

#include "utils_mem.h"

using namespace std;

template <class T>
class tbufferpool {
private:
    const int m_initial;
    const int m_size;
    const int m_total;
    T*        m_buffer;
    vector<T*> m_queue;

public:
    // constructor
    tbufferpool(int initial, int size) : m_initial(initial), m_size(size), m_total(initial*size*sizeof(T)) {
        m_buffer = (T*) malloc(m_total);
        T* next_buffer = m_buffer;
        for (int i=0; i < initial; ++i, next_buffer += i*size) {
            m_queue.push_back(next_buffer);
        }
    }

    // get next buffer element from the pool
    T* next() {
        // check for pool overflow
        if (m_queue.empty()) {
            printf("Illegal bufferpool state, our bufferpool has %d buffers only.", m_initial);
            exit(EXIT_FAILURE);
        }
        T* next_buffer = m_queue.back();
        m_queue.pop_back(); 
        return next_buffer;
    }

    // release element, make it available back in the pool
    void release(T* buffer) {
        assert(m_buffer <= buffer && buffer < (buffer + m_total/sizeof(T)));
        m_queue.push_back(buffer);
    }

    void ensure_size(int size) {
        if (size >= m_size) {
            printf("Illegal bufferpool state, maximum buffer size is %d.", m_size);
            exit(EXIT_FAILURE);
        }
    }

    // destructor
    virtual ~tbufferpool() {
        free(m_buffer);
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:55:16.633

首先，当你增加一个指向 T 的指针时，它将指向内存中 T 的下一个元素。

```
m_queue.push(m_buffer + (i*size*sizeof(T))); 
```

这应该像

```
m_buffer = (T*) malloc(m_total);
T* next = m_buffer;
for (int i=0; i < initial; ++i) {
    m_queue.push(next++);
} 
```

第二，

```
assert(m_buffer <= buffer && buffer < m_total); 
```

它应该像

```
assert(m_buffer <= buffer && buffer <= m_buffer + m_total/sizeof(T)); 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:59:40.033

我不明白你为什么要“包装” STL queue<> 容器。只需将您的“缓冲区”放入队列中，然后根据需要提取地址。当您完成缓冲区中的“段”时，只需将其从队列中弹出并自动释放。因此，您只需拥有实际的缓冲区类，而不是指向缓冲区的指针。

它只是让我觉得重新发明了轮子。现在，由于您需要一次分配整个事物，因此我将使用`vector`not queue，因为`vector<>`可以在构造时立即分配所有类型，并且`push_back()`除非需要，否则该方法不会重新分配，与`pop_back()`. 有关使用的方法，请参见[此处。](http://en.cppreference.com/w/cpp/container/vector)

不过，基本上，这是我粗略的想法：

```
#include <myType.h> // Defines BufferType

const int NUMBUFFERS = 30;

int main()
{
    vector<BufferType> myBuffers(NUMBUFFERS);
    BufferType* segment = &(myBuffers[0]);    // Gets first segment
    myBuffers.pop_back(); // Reduces size by one

    return 0;
} 
```

我希望这能给你一个大致的想法。您可以这样使用向量中的缓冲区，并且只有一次分配或取消分配，如果您愿意，您可以使用类似堆栈的逻辑。该`dequeue`类型也可能值得一看，或者其他标准容器，但如果它只是“我只想要一个分配或解除分配”，我只会使用向量，甚至可能使用指向数组的智能指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T23:37:02.313

我使用对象池发现的一些东西：

我不确定一次分配所有对象。我喜欢从包含对其自己池的私有引用的“pooledObject”类中继承所有池对象，因此允许使用简单、无参数的“释放”方法，并且我始终绝对确定一个对象总是被释放回它的自己的游泳池。我不确定如何使用静态数组 ctor 使用池引用加载每个实例 - 我总是在循环中一个接一个地构造对象。

另一个有用的私有成员是“已分配”布尔值，在对象被解池时设置并在释放时清除。这允许池类检测对象是否被释放两次，并且立即除外。如果不立即检测到“两次发布”错误，可能会非常讨厌——奇怪的行为或崩溃会在几分钟后发生，而且通常发生在另一个模块的另一个线程中。最好尽快检测双重释放！

我发现将我的池级别转储到 1 秒计时器上的状态栏是有用且令人放心的。如果发生泄漏，我可以看到它正在发生，并且通常，当数字急剧下降时，我可以通过我正在进行的活动来了解泄漏的位置。谁需要 Valgrind:)

关于线程，如果您必须使池线程安全，则使用阻塞队列会有所帮助。如果池用完，试图获取对象的线程可以等到它们被释放，应用程序就会变慢而不是崩溃/死锁。另外，要小心重新。虚假分享。您可能必须使用“填充”数组数据成员来确保没有两个对象共享缓存行。

# authentication - 如何从 openSSO/openAM 系统获取用户名？

> ID：10034846
> 
> 赞同：1
> 
> 时间：2012-04-05T19:31:49.333
> 
> 标签：authentication, cookies, opensso, openam

我目前正在使用 openAM 来保护我的一个使用 Java EE Web 代理的小型 Web 应用程序。有人尝试访问该应用程序，他们被重定向到 openAM 实例，他们登录，然后转到该应用程序。简单的东西。

我想要 openAM 将成功使用的用户名传递给网络应用程序。据我了解，应该为此使用“会话属性”。在管理员中，我转到我的 Java EE webagent 并打开“应用程序”选项卡以查看“会话属性处理”。我看到 HTTP_COOKIE 是获取的选择。

1）如果正确设置，我是否应该在cookie中看到用户名作为明文？2）我在会话映射中输入什么值来获取用户名？我如何找到数据存储中与此相对应的值？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-30T23:42:13.303

我们在代理中使用 HTTP_HEADER。因此，如果您已经在使用代理（听起来像您），那么以下内容应该适合您。在 OpenAM Web 控制台中：

*   访问控制 > 顶级领域 > 代理 > Web / J2EE / 等 > 点击一个代理
*   应用程序选项卡 > 配置文件属性处理部分 > 配置文件属性获取模式：
*   单击“HTTP_HEADER”选项
*   配置文件属性映射：
*   Map Key：[uid] ...对应的Map Value：uid
*   单击添加。添加后它应该看起来像 [uid]=uid。将您需要的与属性匹配的任何其他映射添加到后端身份验证系统。我们的是ldap。

在您的 Web 应用程序中，检索 HTTP 标头元素并查找令牌。它应该看起来像这样：AQIC5wM2LY4RfckcedfzxGrgVYevbKR-SgBkuemF4Cmm5Qg。*AAJTSQABMDE。*

然后，您可以使用 OpenAM REST 接口来验证和检索与令牌关联的属性，例如用户名、密码、cn 等。要检索所有属性，URL 将如下所示：

```
http://<OpenAM_Host>:<Port>/<deploy_uri>/identity/attributes?subjectid=AQIC5wM2LY4RfckcedfzxGrgVYevbKR-SgBkuemF4Cmm5Qg.*AAJTSQABMDE.* 
```

您还可以像这样指定所需的属性：

```
http://<OpenAM_Host>:<Port>/<deploy_uri>/identity/attributes?subjectid=AQIC5wM2LY4RfckcedfzxGrgVYevbKR-SgBkuemF4Cmm5Qg.*AAJTSQABMDE.*&attributenames=uid&attributenames=userpassword 
```

参考：
[https://wikis.forgerock.org/confluence/display/openam/Use+OpenAM+RESTful+Services](https://wikis.forgerock.org/confluence/display/openam/Use+OpenAM+RESTful+Services)
[http://openam.forgerock.org/openam-documentation/openam-doc-source/doc/dev-guide /index/chap-rest.html](http://openam.forgerock.org/openam-documentation/openam-doc-source/doc/dev-guide/index/chap-rest.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T09:47:37.133

1) 是的，代理会创建明文 cookie（如果用户发送恶意的，它会重新创建它们就好了），但是使用 HTTP_HEADER 方法传递属性被认为是更好的解决方案（因为它不存储在客户端） .

2）会话属性处理仅在您实际在会话中存储某些内容时才有效。为此，您可以使用身份验证所有核心设置中的“用户属性映射到会话属性”功能，或者编写一些自定义模块来保存派生值。否则，如果您只想获取用户的 uid，则使用配置文件属性处理（uid 键 HTTP_UID 值，您的应用将看到 HTTP_UID cookie/header）。

# xml - XSLT：如何仅输出本地化数据？

> ID：10034848
> 
> 赞同：5
> 
> 时间：2012-04-05T19:32:05.603
> 
> 标签：xml, xslt, xpath, localization, xquery

给定以下 XML：

```
<?xml version="1.0" encoding="UTF-8" ?>
<?xml-stylesheet type="text/xsl" href="form.xsl"?>
<Document>
  <Translations>
    <Translation name="Resource">Invariant Resource</Translation>
    <Translation name="Resource" lang="en">English Resource</Translation>
    <Translation name="Resource" lang="en-CA">Canadian English Resource</Translation>
    <Translation name="Resource" lang="en-GB">British English Resource</Translation>
    <Translation name="Message">Invariant Message</Translation>
    <Translation name="Message" lang="en">English Message</Translation>
    <Translation name="Message" lang="en-CA">Canadian English Message</Translation>
    <Translation name="Message" lang="en-AU">Australian English Message</Translation>
  </Translations>
</Document> 
```

我需要选择一组翻译元素，以便该集合包含“名称”属性的唯一值，以及给定语言环境的“最佳匹配”（'en-US'、'es-MX'、'fr'、 ETC。）。当我说最佳匹配时，我想首先查找具有完全匹配语言环境的元素，然后仅根据前两个字符查找匹配，然后查找未指定语言的元素。

例如，如果我在转换上述数据时传入“en-CA”的语言环境，我想得到以下两个元素：

```
<Translation name="Resource" lang="en-CA">Canadian English Resource</Translation>
<Translation name="Message" lang="en-CA">Canadian English Message</Translation> 
```

但如果我传入“en-GB”，我想得到：

```
<Translation name="Resource" lang="en-GB">British English Resource</Translation>
<Translation name="Message" lang="en">English Message</Translation> 
```

最后，如果我传入一个诸如“es”或“es-MX”之类的值，我希望得到：

```
<Translation name="Resource">Invariant Resource</Translation>
<Translation name="Message">Invariant Message</Translation> 
```

我对 XSLT 非常陌生，但我认为我有一些有用的东西。我只需要知道是否有更好的方法（更简单、更优雅、更高效等）

这是我的第一次尝试：

```
<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output encoding="utf-8" indent="yes" method="xml" omit-xml-declaration="yes"/>

  <xsl:key match="Translation" name="TranslationName" use="concat(@name,':',@lang)"/>

  <xsl:template match="/">
    <!-- locale parameter for translation -->
    <xsl:param name="locale"/>

    <xsl:for-each select="Document/Translations/Translation[@lang=$locale or @lang=substring($locale,1,2) or not(@lang)]">
      <xsl:choose>
        <xsl:when test="@lang=$locale and count(key('TranslationName', concat(@name,':',$locale)))=1">
          <xsl:element name="p">
            <xsl:value-of select="."/>
          </xsl:element>
        </xsl:when>
        <xsl:when test="@lang=substring($locale,1,2) and count(key('TranslationName', concat(@name,':',$locale)))=0">
          <xsl:element name="p">
            <xsl:value-of select="."/>
          </xsl:element>
        </xsl:when>
        <xsl:when test="not(@lang) and count(key('TranslationName', concat(@name,':',$locale))|key('TranslationName', concat(@name,':',substring($locale,1,2))))=0">
          <xsl:element name="p">
            <xsl:value-of select="."/>
          </xsl:element>
        </xsl:when>
      </xsl:choose>
    </xsl:for-each>
  </xsl:template>
</xsl:stylesheet> 
```

这是我第一次发布问题，所以如果我需要添加/编辑/删除任何内容，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T22:06:18.413

如果您可以使用 msxsl:node-set 等，您可以这样做：

```
<xsl:template match="/">
    <xsl:param name="locale" select="'en-AU'"/>
<!-- locale parameter for translation -->
    <xsl:variable name="sorted">
        <xsl:for-each select="Document/Translations/Translation">
            <xsl:sort select="@name"/>
            <xsl:sort select="not(@lang=$locale)"/>
            <xsl:sort select="not(starts-with(@lang, substring($locale,1,2)))"/>
            <xsl:sort select="@lang"/>
            <xsl:copy-of select="."/>
        </xsl:for-each>
    </xsl:variable>
    <xsl:for-each select="msxsl:node-set($sorted)/*">
        <xsl:if test="position() = 1 or @name!=preceding-sibling::*[1]/@name">
            <xsl:copy-of select="."/>
        </xsl:if>
    </xsl:for-each>
</xsl:template> 
```

PS这可能适用于标准1.0

```
<xsl:template match="/">
    <xsl:param name="locale" select="'en-AU'"/>
<!-- locale parameter for translation -->
    <xsl:variable name="path" select="Document/Translations/Translation"/>
    <xsl:for-each select="$path">
        <xsl:variable name="curName" select="$path[@name=current()/@name]"/>
        <xsl:if test="count($curName[1] | .)=1">
            <xsl:for-each select="$curName">
            <xsl:sort select="not(@lang=$locale)"/>
            <xsl:sort select="not(starts-with(@lang, substring($locale,1,2)))"/>
            <xsl:sort select="@lang"/>
            <xsl:if test="position()=1">
                <xsl:copy-of select="."/>
            </xsl:if>
            </xsl:for-each>
        </xsl:if>
    </xsl:for-each>
</xsl:template> 
```

PPS 如果您不想排序，您可以只进行过滤（保留文档顺序）。此外，不同的分组机制：

```
<xsl:template match="/">
    <xsl:param name="locale" select="'en'"/>
    <xsl:variable name="locale-lang" select="substring($locale,1,2)"/>
<!-- locale parameter for translation -->
    <xsl:variable name="path" select="Document/Translations/Translation"/>
    <xsl:for-each select="$path[not(preceding-sibling::Translation/@name=@name)]">
        <xsl:variable name="curName" select="$path[@name=current()/@name]"/>
        <xsl:variable name="test1" select="$curName[@lang=$locale]"/>
        <xsl:variable name="test2" select="$curName[@lang=$locale-lang]"/>
        <xsl:variable name="test3" select="$curName[starts-with(@lang, $locale-lang)]"/>
        <xsl:variable name="test4" select="$curName[not(@lang)]"/>
        <xsl:choose>
            <xsl:when test="$test1">
                <xsl:copy-of select="$test1[1]"/>
            </xsl:when>
            <xsl:when test="$test2">
                <xsl:copy-of select="$test2[1]"/>
            </xsl:when>
            <xsl:when test="$test3">
                <xsl:copy-of select="$test3[1]"/>
            </xsl:when>
            <xsl:when test="$test4">
                <xsl:copy-of select="$test4[1]"/>
            </xsl:when>
        </xsl:choose>
    </xsl:for-each>
</xsl:template> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T03:09:52.167

**这个简短而简单的转换（无变量，`xsl:choose`, `xsl:when`, `xsl:otherwise`, `xsl:if`, xsl:sort, `xsl:element`）**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:param name="pCode" select="'en-GB'"/>

 <xsl:key name="kTransName" match="@name" use="."/>

 <xsl:key name="Resource" match="Translation[@name='Resource']"
          use="@lang"/>
 <xsl:key name="Message" match="Translation[@name='Message']"
          use="@lang"/>
 <xsl:key name="Resource" match="Translation[@name='Resource']"
                          use="boolean(@lang)"/>
 <xsl:key name="Message" match="Translation[@name='Message']"
                          use="boolean(@lang)"/>

 <xsl:template match="/">

  <xsl:for-each select=
   "/*/*/*/@name[generate-id()=generate-id(key('kTransName', .)[1])]">
      <xsl:copy-of select=
       "key(., $pCode)
       |
        key(., substring($pCode, 1, 2))
          [not(key(current(), $pCode))]
       |
        key(., 'false')
          [not(key(current(), $pCode)
              |
               key(current(), substring($pCode, 1, 2))
              )
          ]
       "/>
   </xsl:for-each>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<Document>
    <Translations>
        <Translation name="Resource">Invariant Resource</Translation>
        <Translation name="Resource" lang="en">English Resource</Translation>
        <Translation name="Resource" lang="en-CA">Canadian English Resource</Translation>
        <Translation name="Resource" lang="en-GB">British English Resource</Translation>
        <Translation name="Message">Invariant Message</Translation>
        <Translation name="Message" lang="en">English Message</Translation>
        <Translation name="Message" lang="en-CA">Canadian English Message</Translation>
        <Translation name="Message" lang="en-AU">Australian English Message</Translation>
    </Translations>
</Document> 
```

**产生想要的正确结果**：

```
<Translation name="Resource" lang="en-GB">British English Resource</Translation>
<Translation name="Message" lang="en">English Message</Translation> 
```

**如果我们将全局/外部参数更改为**：

```
 <xsl:param name="pCode" select="'en-CA'"/> 
```

**再次产生正确的结果**：

```
<Translation name="Resource" lang="en-CA">Canadian English Resource</Translation>
<Translation name="Message" lang="en-CA">Canadian English Message</Translation> 
```

**如果我们将全局/外部参数更改为**：

```
 <xsl:param name="pCode" select="'es-MX'"/> 
```

**再次产生了想要的结果**：

```
<Translation name="Resource">Invariant Resource</Translation>
<Translation name="Message">Invariant Message</Translation> 
```

# grails - 为什么我得到 javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated only in production？

> ID：10034849
> 
> 赞同：2
> 
> 时间：2012-04-05T19:32:06.630
> 
> 标签：grails, ssl, https, httpclient

我有一个 grails 1.3.7 应用程序，它使用 apache HttpClient 对第三方进行 https api 调用。我点击的第三方 URL 具有有效证书。我像这样创建并执行我的请求：

```
HttpClient client = new DefaultHttpClient()

List<BasicNameValuePair> queryParams = new ArrayList<BasicNameValuePair>()
queryParams.add(new BasicNameValuePair("a_parameter", "a_parameter_value"))

URI uri = URIUtils.createURI("https", "third.party.address", 443, "/some/url/for/us", URLEncodedUtils.format(queryParams, "UTF-8"), null)
HttpGet httpGet = new HttpGet(uri)

try {
    log.debug "Sending request to ${uri}"
    return client.execute(httpGet)
} catch(HttpException e) {
    log.error "HttpException during location lookup request: ${e}"
    return
} catch(IOException e) {
    log.error "IOException during location lookup request: ${e}"
    return
} 
```

当我在开发模式下运行我的项目时，这很好用。我还可以直接从 curl 和我的浏览器调用相同的 URL，没有错误。但是，一旦我的项目被构建到一个 war 文件中并放在一个定义了证书/密钥库的 tomcat 实例上，以便客户端可以使用 https 连接到我们，我的请求开始失败，并出现以下 IOException：

```
javax.net.ssl.SSLPeerUnverifiedException: peer not authenticated 
```

我试图找出这里的失败点。

**为什么从 curl 或我的开发模式发出 https 请求与从配置了 https 的 tomcat 实例发出 https 请求不同？**

tomcat 实例不可公开访问，但是当我从浏览器连接到它时没有证书问题（chrome 表示证书很好，详细的 curl 请求也是如此）。

无论如何，我都不是 https/ssl 专家，所以我正在寻求帮助来解释什么是错误的，为什么它是错误的，以及我该如何解决它。我可以提供任何其他需要的信息。

**---更新---** 我启用了`javax.net.debug`下面的建议，输出包括以下错误：

```
java.lang.RuntimeException: Unexpected error: java.security.InvalidAlgorithmParameterException: the trustAnchors parameter must be\
 non-empty 
```

我的谷歌搜索让我认为这个问题是因为我在启动 tomcat 时使用了以下 java opt：

```
-Djavax.net.ssl.trustStore=/path/to/tomcat/conf/myStore.jks 
```

如果这是真的，我怎样才能在 myStore.jks 中添加我需要的东西，而不是覆盖默认值，让每个人都开心？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-11T03:58:26.257

我已经多次看到这个错误。我使用以下实用程序从使用 SSL 的站点获取证书。去这里并抓住[InstallCert](https://github.com/escline/InstallCert)。编译并运行此实用程序。您可以使用此实用程序生成的文件作为密钥库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T21:27:16.250

对我来说，最终的解决方案是我们用我们自己的 java opt 覆盖了默认的 java 信任库。这导致第三方发送的证书看起来无效，因为我们的 myStore.jks 中没有任何默认根证书。

通过将我们的自签名证书添加到默认的 java 证书 (/lib/security/cacerts) 并删除 java opt，一切都很好。

另一种方法是将默认 java 存储中的所有内容添加到您的自定义存储中并仍然使用 java opt。无论您发现哪个更适合您的情况。

# c# - SocketAsyncEventArgs？- 简单的例子

> ID：10034854
> 
> 赞同：3
> 
> 时间：2012-04-05T19:32:23.347
> 
> 标签：c#, sockets, xna, multiplayer, socketasynceventargs

随着我的 XNA TopDown Shooter 游戏的继续进行，是时候实现多人游戏功能了。因为客户端和服务器每秒必须处理大量数据（每秒 60 个数据包，包括位置、旋转和其他玩家数据），所以我必须建立一个稳定且快速的网络系统。

我的问题：在一台服务器和多个客户端之间创建一个非常快速、高性能的网络连接的最佳选择是什么？如果答案是 SocketAsyncEventArgs，您是否知道 Internet 上某个地方的一个简单、干净的示例，说明如何使用此高级类发送和接收数据？我似乎找不到一个我理解的好例子。

谢谢你的时间！

巴斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T00:23:42.390

这是一个关于它的博客

[http://socketeering.blogspot.com/](http://socketeering.blogspot.com/)

链接中的几个 youtube 视频

# java - Java 创建内存不足实例

> ID：10034865
> 
> 赞同：1
> 
> 时间：2012-04-05T19:33:32.830
> 
> 标签：java, weblogic, out-of-memory

为了测试目的，我需要故意创建一个内存不足的实例。有谁知道最快的方法来做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T19:40:30.387

取决于您要做什么，但这应该足够了：

`double[] d = new double[Integer.MAX_VALUE];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:46:39.283

```
import java.util.ArrayList;

class TestOome {

    public static void main(String[] args) {
        long start = System.currentTimeMillis();
        byte[] buffer = new byte[2^20];
        ArrayList<String> list = new ArrayList<String>();
        try {
            while (true) {
                list.add("Lollygobblenlissbomb");
            }
        } catch (Throwable t) {
            long end = System.currentTimeMillis();
            buffer = null;
            System.err.println(t + " in " + (end-start) + " millis.");
        }
    }
} 
```

## 本地输出

```
java.lang.OutOfMemoryError: Java heap space in 1152 millis.
Press any key to continue . . . 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:37:18.933

运行一个递归函数，它在没有基本/锚点的情况下调用自己。每个递归调用都会创建一个堆栈。所以应该很快。

# c# - C# Linq 合并两个字典

> ID：10034867
> 
> 赞同：7
> 
> 时间：2012-04-05T19:33:34.107
> 
> 标签：c#, linq, merge, functional-programming

如何使以下方法更具功能性 linq 风格？

```
 public static Dictionary<T, T> MergeDict<T, T>(Dictionary<T, T> a, Dictionary<T, T> b)
    {
        var e = new Dictionary<T, T>();

        a.Concat(b).ToList().ForEach(pair =>
        {
            e[pair.Key] = pair.Value;
        });

        return e;
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-05T19:43:00.900

要继续重复丢弃方式，只需分组并在组中取一个获胜项目（例如最后一个）。

```
first.Concat(second)
  .GroupBy(kvp => kvp.Key, kvp => kvp.Value)
  .ToDictionary(g => g.Key, g => g.Last()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-05T19:37:44.297

您可以直接使用[ToDictionary](http://msdn.microsoft.com/en-us/library/bb548657.aspx)：

```
public static Dictionary<T, T> MergeDict<T, T>(Dictionary<T, T> a, Dictionary<T, T> b)
{
     return a.Concat(b).ToDictionary(kvp => kvp.Key, kvp => kvp.Value);
} 
```

请注意，这将在重复键的情况下引发异常。

如果您需要处理重复键，则需要决定如何处理。例如，这将从“b”中删除重复项：

```
public static Dictionary<T, T> MergeDict<T, T>(Dictionary<T, T> a, Dictionary<T, T> b)
{
     return a.Concat(b.Where(kvp => !a.ContainsKey(kvp.Key)).ToDictionary(kvp => kvp.Key, kvp => kvp.Value);
} 
```

要获得与原始行为相同的行为，您可以采用另一种方式（保留“b”中的 KeyValuePair 值）：

```
public static Dictionary<T, T> MergeDict<T, T>(Dictionary<T, T> a, Dictionary<T, T> b)
{
     return b.Concat(a.Where(kvp => !b.ContainsKey(kvp.Key)).ToDictionary(kvp => kvp.Key, kvp => kvp.Value);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T19:39:51.523

也许是这样的。

```
public static IDictionary<T, U> Merge<T, U>(this IDictionary<T, U> first, IDictionary<T, U> second)
{
    return first.Concat(second).ToDictionary(kvp => kvp.Key, kvp => kvp.Value);
} 
```

# c - 从 32 位应用程序中查找 64 位进程的模块名称

> ID：10034872
> 
> 赞同：1
> 
> 时间：2012-04-05T19:33:51.217
> 
> 标签：c, winapi

我正在使用 Win Api 函数 GetModuleBaseName 从当前窗口中检索进程名称（我的应用程序是在 Win7 64 位上运行的 32 位）：

```
HWND Handle = GetForegroundWindow();
DWORD lpdwProcessId;
HANDLE PID; 

WCHAR ProcessName[1024];
GetWindowThreadProcessId(Handle,&lpdwProcessId);
PID=OpenProcess(PROCESS_ALL_ACCESS,false,lpdwProcessId);
if (PID)
{
    if(GetModuleBaseName(PID,NULL,ProcessName,sizeof ProcessName) == 0) {
        wcscpy(ProcessName,  L"??");
        DWORD er = GetLastError();
        printf("error code: %i\n", GetLastError());
    }
}
else
{
    wcscpy(ProcessName,  L"??");
} 
```

此代码适用于所有 32 位程序，但不适用于 64 位程序，例如 MSPaint，其中返回的最后一个错误是

```
错误 299：ERROR_PARTIAL_COPY：“仅 ReadProcessMemory 的一部分或
WriteProcessMemory 请求已完成。”

```

MSDN 没有记录为什么会发生此特定错误。我在某处读到，由于 32 位和 64 位程序之间的问题，EnumProcessModulesEx 可能会发生此错误，但 GetModuleBaseName 没有提到这样的事情。有没有办法知道这是从哪里来的以及如何解决它？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-05T22:04:01.730

[Documentation for GetModuleBaseName](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683196%28v=vs.85%29.aspx) suggests that calling GetProcessImageFileName or QueryFullProcessImageName will be more reliable than calling GetModuleBaseName with a NULL module handle.

# node.js - 在 Heroku 上部署 BrowserQuest

> ID：10034875
> 
> 赞同：1
> 
> 时间：2012-04-05T19:34:33.483
> 
> 标签：node.js, heroku

我可以将我的代码部署到 Heroku，但似乎状态总是崩溃。我必须配置哪些东西才能设置好这些东西？

# c - 从内核验证文件数字签名

> ID：10034877
> 
> 赞同：-2
> 
> 时间：2012-04-05T19:34:39.357
> 
> 标签：c, file, kernel, sign

我可以从内核驱动程序检查文件是否使用真实证书（如 VeriSign 或 GlobalSign）签名？有人有可以做到这一点的代码吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:52:49.723

不。虽然内核对某些加密操作有一些支持，但它没有完整的 SSL 实现（这对于验证证书链是必要的），也没有嵌入的受信任 CA 列表。

# jquery - JQuery单击附加元素不适用于下拉

> ID：10034878
> 
> 赞同：1
> 
> 时间：2012-04-05T19:34:40.333
> 
> 标签：jquery, delegates, click, append, bind

在我清空它的内容并附加新的内容后，我无法让我的下拉菜单仍然有效。

这是我遇到问题的页面（最初尝试选择壁纸分辨率，然后从顶部的 5 个中选择不同的壁纸并重试）： [http ://www.nba.com/warriors/wallpapertest_020.html](http://www.nba.com/warriors/wallpapertest_020.html)

在 $(document).ready 我有：

```
 $(".dropdown dd ul li a").click(function() {
            var text = $(this).html();
            $(".dropdown dt a span").html(text);
            $(".dropdown dd ul").hide();
        }); 
```

这第一次工作正常，但是当我更改下拉列表的内容时，它停止工作。有没有办法调用 .ready() 函数来识别新添加的内容？或者更好的方法来做到这一点？

我也尝试过这样的 delegate() ，但这会阻止它完全运行：

```
 $(".dropdown dd ul li").delegate('a', 'click', function() {
            var text = $(this).html();
            $(".dropdown dt a span").html(text);
            $(".dropdown dd ul").hide();
        }); 
```

任何帮助将不胜感激:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:42:49.527

尝试使用`on()`

```
$(".dropdown dd ul li a").on('click', function() {
            var text = $(this).html();
            $(".dropdown dt a span").html(text);
            $(".dropdown dd ul").hide();
        }); 
```

# facebook - 使用 FOSUserBundle 在 oAuth 上进行 Symfony 身份验证

> ID：10034880
> 
> 赞同：4
> 
> 时间：2012-04-05T19:34:53.707
> 
> 标签：facebook, symfony, oauth-2.0, fosuserbundle

我正在使用 FOSUserBundle 对数据库中的用户进行身份验证，现在我想通过 oAuth 服务（如 Facebook、Twitter 等）添加身份验证。如何以最好的方式做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T10:11:55.013

我发现这个捆绑包[https://github.com/hwi/HWIOAuthBundle/](https://github.com/hwi/HWIOAuthBundle/) 它应该可以解决我的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T14:44:36.757

查看 FOS Facebook 捆绑包： [https ://github.com/FriendsOfSymfony/FOSFacebookBundle](https://github.com/FriendsOfSymfony/FOSFacebookBundle)

他们已经解决了你的问题:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T08:11:08.743

Symfony2中的OAuth有很多解决方案：

作为客户（使用 Facebook、Twitter 或 Google 进行身份验证）：

FOSFacebookBundle、FOSTwitterBundle 或 HWIOAuthBundle

如果您只寻找 oAuth 身份验证，我强烈推荐**HWIOAuthBundle** ( [https://github.com/hwi/HWIOAuthBundle/ )。](https://github.com/hwi/HWIOAuthBundle/)

OAuth服务器有一个解决方案：

FOSOAuthServerBundle ( [https://github.com/FriendsOfSymfony/FOSOAuthServerBundle/](https://github.com/FriendsOfSymfony/FOSOAuthServerBundle/) )。

# python - 非英语语言（CJK 等）中的 n-gram 名称分析

> ID：10034881
> 
> 赞同：7
> 
> 时间：2012-04-05T19:34:58.953
> 
> 标签：python, nlp, similarity, n-gram, cjk

我正在对人员数据库进行重复数据删除。对于第一遍，我遵循基本的两步过程，以避免对整个数据库进行 O(n^2) 操作，如[文献中所述](http://nike.psu.edu/publications/jcdl05.pdf)。首先，我“阻塞”——遍历整个数据集，并根据名称中存在的 n-gram 和首字母对每条记录进行分类。其次，使用 Jaro-Winkler 比较每个 bin 的所有记录，以衡量它们代表同一个人的可能性。

我的问题 - 名称是 Unicode。其中一些（尽管不多）名称是 CJK（中日韩）语言。我不知道如何为这些语言中的首字母之类的东西[找到单词边界。](https://stackoverflow.com/questions/1738788/python-split-unicode-string-on-word-boundaries)我不知道 n-gram 分析是否对名称可以是 2 个字符的语言中的名称有效。我也不知道字符串编辑距离或其他相似性指标在这种情况下是否有效。

语言程序员或母语人士有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-09T08:49:01.857

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-06T12:19:35.353

对于中国人来说，大多数名字由三个字符组成：第一个字符是姓（！），其他两个字符是人名，例如
毛泽东=姓毛和个人姓名泽东。还有一些2字的名字，第一个字是姓，第二个字是人名。4 个字符的名称很少见，但通常拆分为 2-2。

看到这里，对中文名字进行 n-gram 分析并没有多大意义——你只是在研究什么是最常见的中文姓氏/人名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T21:44:33.493

因此，进行双元样式匹配是在日语中进行搜索的常见技巧，但是您可以使用更好的方法来确定单词边界。在我过去参与的一个项目中，我们使用[mecab](http://sourceforge.net/projects/mecab/)获得了相当好的结果，用于日本品牌名称和其他一些文本。我想你可以通过在日本名字列表上训练它来获得更好的性能。遗憾的是它在 C 中，但我们最终还是通过 JNI 在 Java 中使用了它，你可以在你的 python 代码中做类似的事情。

# javascript - jQuery：add() 性能；有没有更好的办法？

> ID：10034882
> 
> 赞同：5
> 
> 时间：2012-04-05T19:35:00.950
> 
> 标签：javascript, jquery, arrays, performance, add

我想做的事：将页面上的所有类似元素（某种类型）分组到一个对象中，我以后可以对其进行迭代——或者对其中的每个元素应用彻底的更改。

我的代码成功地完成了给定的任务，但是当元素数量增加到 200-300+ 时，性能急剧下降并且用户已经注意到了。我已经隔离了有问题的代码行，并想知道是否有另一种方法可以解决同样的问题。

根据我在它们周围放置的计时器，add() 函数似乎是有问题的操作。起初，执行该操作所需的时间是 0.001，但会一直增长，直到元素数量达到 300 个，并且每个附加元素需要大约 0.1 秒，并且继续减慢。

我已经[研究](http://net.tutsplus.com/tutorials/javascript-ajax/10-ways-to-instantly-increase-your-jquery-performance/)了（[以及更多](http://jquery-howto.blogspot.com/2009/06/javascript-for-loop-vs-jquery-each.html)）jQuery 性能增强能力，并实现了其中的一些（即 3 个），但它们并没有给我带来任何有意义的性能提升。令人惊讶的是，对于 Firefox（300 多次 add() 调用），此代码在 1 秒内 (!) 执行，而 Chrome 和 IE 大约需要 10-20 倍或更长时间......

这是我的代码：

```
rowsToChange = $([]);
// Grab all the ids greater than whichever one I'm currently looking at:
var arr = $.makeArray($("[id^=stackLocatorLinkFillUp]:gt("+(uniqueID-1)+")"));
for (var i=0; i<arr.length; i++) {
    $this = arr[i];
    // <<< VARIOUS CONDITIONALS that make this as selective as possible REMOVED >>>
    startTimer = new Date().getTime();
    // **************************
    // PROBLEMATIC LINE FOLLOWS when 200+ records:
    rowsToChange = rowsToChange.add($this);
    // Grows from .001 to .1xx after 300 iterations
    console.log("innertiming:"+(new Date().getTime() - startTimer)/1000);
    // **************************
} 
```

最终结果如下所示（通过 Chrome Inspector）：

```
[<div style=​"display:​none" id=​"stackLocatorLinkFillUp1">​itemType=BOUND&ccLocale=PERIODICAL​&lt;/div>​, 
<div style=​"display:​none" id=​"stackLocatorLinkFillUp2">​itemType=BOUND&amp;ccLocale=PERIODICAL​&lt;/div>​,
...
] 
```

最终我按如下方式处理所有这些（我**喜欢**它的简单性！）：

```
var superlink = "...new <a> goodness to display for all elements...";
rowsToChange.html(superlink).css("display","block"); 
```

这看起来可能是一个有效的解决方案（[不同的添加方法？](https://stackoverflow.com/questions/7242947/is-there-any-difference-in-jquerysel1-addsel2-and-jquerysel1-sel2)）但我*更愿意*继续收集对象列表，以便最后一行可以发挥其魔力。

（[我不是被](https://stackoverflow.com/users/1106925/am-not-i-am)指出以下不正确 - 关于串联；谢谢'我不是'）

似乎 add() 操作必须连接字符串，因为这似乎是其他人面临的主要问题之一。但是将我的 add() 语句转换为 += 看起来不起作用。

感谢您检查这一点；

铬：18.0.1025.142 m 火狐：11.0 IE：8.0.7600.16385

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T19:42:20.960

第一次观察：`add`保存前一个元素集。试试`rowsToChange = jQuery.merge(rowsToChange, [$this]);`吧。

第二个观察：似乎`rowsToChange`最终将成为与您调用的元素完全相同的元素集`$.makeArray`。为什么不直接保存原始集？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T18:14:22.957

DCoder 展示了如果您使用`for`循环，如何将信息适当地合并在一起。但是，如果您来到这里并使用`.each()`循环，请使用以下内容。

主要区别在于括号是不必要/必要的，具体取决于`'this'`. 它似乎也被普遍接受，`.each()`至少*比*原生 javascript`for`循环慢一些。（[来自 2009 年的证据](http://jquery-howto.blogspot.com/2009/06/javascript-for-loop-vs-jquery-each.html)）（[时间 test_copied 从上面的问题](http://net.tutsplus.com/tutorials/javascript-ajax/10-ways-to-instantly-increase-your-jquery-performance/)）

```
var $this, rowsToChange = $([]);
// slower than a for loop
$("[id^=stackLocatorLinkFillUp]:gt("+(uniqueID-1)+")").each( function() {
    // If statements <removed> that decide whether or not to include in the new container
    $this = $(this); // probably unnecessary under most situations
    rowsToChange = jQuery.merge(rowsToChange, $this);
}); 
```

对删除的 if 语句决定的新子组的每一部分进行操作！

```
rowsToChange.html("..."); 
```

感谢所有查看问题、花时间回答、投票等的人！

# python - 25GB 数据的高效 XML 解析

> ID：10034883
> 
> 赞同：2
> 
> 时间：2012-04-05T19:35:01.040
> 
> 标签：python, xml, xml-parsing, beautifulsoup, lxml

我的目标是解析 25 GB 的 XML 数据。下面给出了此类数据的一个示例：

```
<Document>
<Data Id='12' category='1'  Body="abc"/>
<Data Id='13' category='1'  Body="zwq"/>
.
.
<Data Id='82018030' category='2' CorrespondingCategory1Id='13' Body="pqr"/> 
```

但是..考虑到我拥有的“25 GB”数据...我的方法效率很低。请提出一些改进我的代码的方法或替代方法。还请包含一个小示例代码，以使事情更清楚。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:48:16.427

您可能会发现 SAX 解析器更适合此任务。SAX 解析器不是构建 DOM，而是将 XML 文件转换为元素流并调用您提供的函数来处理每个元素。

好消息是，与 DOM 解析器相比，SAX 解析器可以非常快速且节省内存，有些甚至不需要一次提供所有 XML，当您拥有 25 GB 的 XML 时，这将是理想的选择。

不幸的是，如果您需要任何上下文信息，例如“我想要标签`<B>`，但只有在标签内`<A>`”，您必须自己维护它，因为解析器给您的只是“开始标签`<A>`，开始标签`<B>`，结束标签`<B>`，结束标签`<A>`”。它从不明确告诉你 tag`<B>`在 tag 内`<A>`，你必须从你所看到的中弄清楚。一旦你看到一个元素，它就消失了，除非你自己记住它。

这对于复杂的解析工作来说非常麻烦，但你的工作可能是可以管理的。

碰巧 Python 的标准库在`xml.sax`. 您可能想要类似`xml.sax.xmlreader.IncrementalParser`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:41:20.003

查看您的问题后，我的第一个建议是使用关系数据库，例如 MySQL 或 sqlite。将您的 XML 数据放入此表单并不难，然后查询该数据将更加直接和快速。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-05T20:04:11.783

您的初始算法在 O(n^2) 中运行，这对于 25GB 的数据将非常慢。理想情况下，您会将其降低到 O(n) 或 O(n log n)。在没有关于数据的任何其他信息（例如类别 1 或 2 是否更小等）的情况下，您可以执行以下操作（即 O(n)）：

```
from lxml import objectify
f=open('myfile25GB', 'r')
text=f.read()
root=objectify.fromstring(text)

cat_one_bodies = {}
for e in root.attrib['Document'].row:
    category = int(e.attrib['category'])
    body = e.attrib['Body']
    if category == 1:
        e_id = int(e.attrib['Id'])
        cat_one_bodies[e_id] = body
    else: #Assuming there are only 2 categories
        cat_one_id = int(e.attrib['CorrespondingCategory1Id'])
        print "Cat1 Body: '%s' Cat2 Body: '%s'" % (body, cat_one_bodies[cat_one_id]) 
```

虽然这不会解析您的文件，但希望它向您展示了这个想法。它可能会使用相当多的内存（因为它维护字典中的所有 category1 主体），所以这可能是一个考虑因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T22:19:44.833

在目前在 Saxon-EE 中实现的 XSLT 3.0（草案）中，您可以编写一个流式转换来解决这个问题，如下所示：

```
<xsl:stylesheet version="3.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:map="http://www.w3.org/2005/xpath-functions/map">
<xsl:mode streamable="yes"/>
<xsl:template match="/">
  <xsl:iterate select="Document/Data">
    <xsl:param name="map" select="map{}"/>
    <xsl:choose>
      <xsl:when test="@category='1'">
        <xsl:next-iteration>
          <xsl:with-param name="map" select="map:put($map, string(@Id), string(@Body))"/>
        </xsl:next-iteration>
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="'Cat1 Body: ', 
                              $map(@CorrespondingCategoryId), 'Cat2 Body', @Body"/>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:iterate>
</xsl:template> 
```

我还没有对此进行测试（这是四天假期前夕的深夜......）但如果您有兴趣采用这种方法，我将很乐意提供帮助。XSLT 3.0 仍然是一个草案规范并且相当流畅。它的重点是使用流式方法解决此类问题，该方法使用有界内存处理非常大的文档。Saxon-EE 9.4 实现了规范的快照。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-05T22:32:18.043

如果 ID 是按升序排列的，那么您可以推出自己的函数来读取文件中任何位置的元素。然后你可以扫描整个文件，对于每个元素，你可以使用二进制搜索算法找到对应的元素。该事物将在 O(n log n) 中运行，同时仍使用可忽略不计的内存量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T11:53:24.447

尝试使用 lxml 中的 iterparse。我认为它将适合您希望处理的问题。

# javascript - 在 JavaScript 中从 img 读取 EXIF 数据（跨域友好）

> ID：10034886
> 
> 赞同：3
> 
> 时间：2012-04-05T19:35:10.853
> 
> 标签：javascript, image, canvas, binary-data, exif

我最近开始构建一个小书签，用于显示网站上任何图像的 EXIF 数据。我选择使用 Nihilogic 的[binary.js 和 exif.js](http://www.nihilogic.dk/labs/exif/)库。对于托管在与父页面相同域中的图像，该脚本运行良好。但是因为它使用 XHR 来读取图像的二进制数据，并且因为 XHR 仅限于同源请求，所以我无法访问任何跨站点托管图像的二进制数据。

**有没有办法在本地（或至少不使用 XHR）加载图像的二进制数据来保留 EXIF 数据？**

我已经探索了其他几个方向，但我担心我对它们的理解不够好，无法确定是否有解决方案：

*   JSONP - 我假设没有办法将二进制数据放入其中之一。
*   [画布标签](https://stackoverflow.com/questions/934012/get-image-data-in-javascript)- 这些似乎产生与 PHP 不同的 base64 编码，我怀疑 EXIF 数据不再存在于新编码中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:55:39.933

允许 Javascript 对同源图像和启用 cors 的图像执行特殊操作（如在画布上），因为浏览器可以安全地假设这些操作一开始就可以上传到服务器。但是接下来就复杂了...

> 我无法访问任何跨站点托管图像的二进制数据。

是的，一般来说，你不能这样做是非常重要的。更重要的是，你不能用书签做你想做的事。

你不能用画布做到这一点，因为这里的 cors 规则很严格[（有充分的理由！）](http://simonsarris.com/blog/480-understanding-the-html5-canvas-image-security-rules)

简而言之，一般的推理几乎完全相同。浏览器处于独特的安全位置：互联网上的一个随机页面可以向您显示您的私人信息，例如假设图像 C:\MyPhotos\privateImage1.jpg，假设它可以猜测该文件路径。

But that webpage is most certainly not allowed to *do* anything with that file other than show it to you. It can't read the binary information (EXIF information or pixel information). JavaScript is not allowed to know what that image looks like or nearly *any* data associated with it.

If it was able to figure that out, a random webpage would be able to try a bunch of file paths and maybe come across an image on your hard drive, and then upload the binary data of that image to a server, in effect stealing your private image.

* * *

A browser extension would be far more suited to this task than a (JavaScript) bookmarklet because of this.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:54:24.210

纯粹来自客户？我对此表示怀疑。XHR'ing 一个运行类似的本地 PHP 脚本怎么样`exif_imagetype()`？此功能适用于远程和图像。

# php - PHP - 数组值的计数频率

> ID：10034889
> 
> 赞同：1
> 
> 时间：2012-04-05T19:35:23.867
> 
> 标签：php, arrays, count, frequency

php中有没有办法计算一个值在大数组中存在的频率？

所以如果我有一个这样的数组：

```
$array = "1,2,3,4,joe,1,2,3,joe,joe,4,5,1,6,7,8,9,joe"; 
```

有没有办法输出一个新数组，告诉我（和排序）哪个最常用以及每个数组有多少？

```
$result = array(
    [joe] => 4
    [1] => 3
    [2] =>2
    etc...
    ) 
```

我看过 php array_count_values，但这可以按最多 - > 最少排序吗？还是有更简单的方法？

谢谢大家！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-05T19:39:35.847

计数后对它们进行排序[`arsort()`](http://php.net/arsort)

```
$result = array_count_values(explode(',', $array));
arsort($result);

Array
(
    [joe] => 4
    [1] => 3
    [2] => 2
    [4] => 2
    [3] => 2
    [9] => 1
    [8] => 1
    [5] => 1
    [6] => 1
    [7] => 1
) 
```

# java - 同步块和监控对象

> ID：10034890
> 
> 赞同：10
> 
> 时间：2012-04-05T19:35:33.890
> 
> 标签：java

嗨，有人可以解释一下以下代码中的同步代码是否会限制对线程的访问。如果是，它与如果我们使用“this”而不是“msg”作为监控对象有何不同。

```
public void display(String msg)    
{    
    synchronized(msg)    
    {    
        for(int i=1;i<=20;i++)    
          {    
               System.out.println("Name= "+msg);    
          }  
    }   
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-05T19:42:18.193

仅当两个线程使用完全相同的*msg*对象调用此方法时，您编写的方法才会阻塞。

如果您*对此*进行同步，那么在给定时间只有一个线程能够调用该方法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-05T19:43:35.657

```
synchronized(this) 
```

意味着只锁定这个对象实例。如果您有多个线程使用此对象实例并调用此方法，则在同步块内一次只能访问一个线程。

```
synchronized(msg) 
```

表示锁定基于 msg 字符串。如果您有多个线程使用此对象实例并调用此方法，则如果 msg 是不同的实例，则多个线程可以在此同步块内访问。注意 Java 如何处理字符串相等以避免令人惊讶的效果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T19:44:25.767

> 如果在以下代码中，同步代码将限制对线程的访问

是的。该块不能在同一个`String`对象上同时调用一次以上[实际上，在该`String`对象上同步的所有块]。

> 如果我们使用“this”而不是“msg”作为监控对象，它有什么不同？

`synchronized(this)`防止同一对象对所有块的并发访问，在这种情况下，作为`this`方法的对象，将无法两次进入同步块。

**例如**[使用类似 java 的伪代码]：

```
s1 = s2;
Thread1:
MyObject o = new MyObject();
o.display(s1);
Thread2:
MyObject o = new MyObject();
o.display(s2); 
```

当前方法不允许线程1和线程2同时调用块

然而：

```
MyObject o = new MyObject();
Thread1:
o.display("s1");
Thread2:
o.display("s2"); 
```

不会显示它们之间的阻塞行为 - 监视器被每个“s1”和“s2”捕获而不会相互干扰。

# bash - 如何在 gnuplot 中绘制一个自动从 y 数据中减去最小值的图？

> ID：10034891
> 
> 赞同：5
> 
> 时间：2012-04-05T19:35:42.020
> 
> 标签：bash, gnuplot

我正在绘制 gnuplot 中大量文件的创建时间，以查看它们是否按时间线性创建（它们不是）。

这是我的代码：

```
#!/bin/bash

stat -c %Y img2/*png > timedata

echo "set terminal postscript enhanced colour
set output 'file_creation_time.eps'
plot 'timedata'" | gnuplot 
```

我遇到的问题是 y 数据是自 unix 开始时间以来的创建时间（以秒为单位），因此该图在 y 轴上只有 1.333...e+09。我希望将第一个文件的创建时间缩放为零，以便相对创建时间可读。

我在许多数据绘图上下文中遇到了这个问题，所以我希望能够在 gnuplot 中做到这一点，而不是求助于 awk 或一些实用程序来预处理数据。

我知道第一次将是最小的，因为文件是连续命名的，所以有没有办法访问文件中的第一个元素，比如

```
`plot 'data' using ($1-$1[firstelement])` 
```

?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-06T02:59:09.050

我认为你可以做这样的事情......（以下内容未经测试，但我认为它应该可以工作......）。基本上，您必须绘制文件两次——第一次通过 gnuplot 获取有关数据集的统计信息。第二次，你使用你在第一次运行中找到的东西来绘制你真正想要的东西。

```
set terminal unknown
plot 'datafile' using 1:2
set terminal post enh eps color
set output 'myfile.eps'
YMIN=GPVAL_Y_MIN
plot '' u 1:($2-YMIN) 
```

如果你有 gnuplot 4.6，你可以用这个`stats`命令做同样的事情。 [http://www.gnuplot.info/demo/stats.html](http://www.gnuplot.info/demo/stats.html)

**编辑**看来您希望第一点提供偏移量（对不起，误读了问题）...

如果您希望第一个点提供偏移量，您可以执行类似的操作（同样，未经测试——需要 gnuplot >= 4.3）：

```
first=0;
offset=0;
func(x)=(offset=(first==0)?x:offset,first=1,x-offset)
plot 'datafile' using (func($1)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T21:25:29.837

Gnuplot 接受 unix 命令，所以你可以这样说

```
gnuplot> plot "< tail -3 test.dat" using 1:2 with lines 
```

为了只绘制最后三行。你可以使用这样的东西来达到你的目的。此外，如果你想绘制让我们说从第 1000 行到 2000

```
plot "<(sed -n '1000,2000p' filename.txt)" using 1:2 with lines 
```

您可以查看[此网站](http://t16web.lanl.gov/Kawano/gnuplot/index-e.html)以获取更多示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-06T04:06:59.920

[我在这里](https://stackoverflow.com/questions/3376655/how-to-subtract-a-constant-number-from-a-column)找到了一个相关的 stackoverflow 问题，并从其中一个答案中利用了 awk 脚本：

```
#!/bin/bash

stat -c %Y img2/*png > timedata

echo "set terminal postscript enhanced colour
set output 'file_creation_time.eps'
unset key
set xlabel 'file number'
set ylabel 'file creation time (after first)'
plot \"<awk '{if(NR==1) {shift = \$1} print (\$1 - shift)}' timedata\"" | gnuplot 
```

输出看起来像这样（这些不是我在我的问题中谈论的数据，但类似）： ![在此处输入图像描述](../Images/b9abe74b029d8a90afdaf04c9c66d325.png)

所以，gnuplot 可以做我想做的事，但它确实取决于 UNIX 环境......

我还尝试了 mgilson 的方法：

```
plot 'timedata'
YMIN=GPVAL_Y_MIN
plot '' u ($1-YMIN) 
```

但是 gnuplot（我的版本是 4.4.2）没有正确找到最小值。它接近了；看起来它的绘制使得 y 范围的最小值为 0： ![在此处输入图像描述](../Images/57610ba37dd69caa8f91f2a424ddf755.png)

# c# - Rx Extensions 是否为我提供类似于 jQuery.Deferred 的功能？

> ID：10034893
> 
> 赞同：0
> 
> 时间：2012-04-05T19:35:53.467
> 
> 标签：c#, asynchronous, system.reactive

我的 C# 应用程序中有一些需要异步的功能。这是一个相当简单的工作流程，所以我不需要花哨，我基本上需要相当于[jQuery.Deferred](http://api.jquery.com/category/deferred-object/)。

我的方法应该返回一个人们可以附加成功和失败处理程序的对象。成功或失败处理程序将只触发一次。我还需要一种在异步过程完成时触发成功/失败的方法。

所以我想要这样的东西：

```
var asyncTask = ReadSomeStatsFrom("a-really-big-file.txt");
asyncTask.OnSuccess += (stats) => Console.WriteLine("Completed " +stats.ToString());
asincTask.OnFail += (err) => Console.WriteLine("Uh Oh "+err.ToString());
//return control to the calling method and go on to do other stuff 
```

是的，我可以创建线程并模拟这种事情，就像几年前我上次需要这个功能时所做的那样，但是现在没有新的东西可以让这一切变得更整洁吗？我一直在听说 Rx，它似乎正在解决类似的问题领域（显然还有更多）。

所以***问题 1***：我在研究 Rx 的这个功能时是否走在正确的轨道上？如果不是我应该调查的。

和***问题 2***：上面的例子如何看待 rx，包括实际上表示任务成功或结束`ReadSomeStatsFrom()`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-07T10:18:13.840

Rx 似乎非常适合您的需求。

如果`ReadSomeStatsFrom`可以同步写入，那么试试这个：

```
Observable
    .Start(() => ReadSomeStatsFrom("a-really-big-file.txt"))
    .Subscribe(
        stats => Console.WriteLine("Completed " + stats.ToString()),
        err => Console.WriteLine("Uh Oh " + err.ToString())); 
```

我同意 TPL 可能也很合适，但 Rx 在很多方面都比 TPL 更具表现力。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-05T19:45:04.487

也可以查看任务并行库。它随 clr 一起提供，更适合您的需求。Rx 主要用于事件流，而不是单个事件。

我看过一个示例，其中异步 io（您的文件读取）几乎直接包装在 tpl 任务中，但这可能是 4.5 的功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-05T20:00:16.993

Task Parallel Library 是您正在寻找的，这里的链接[http://msdn.microsoft.com/en-us/library/ee372288.aspx](http://msdn.microsoft.com/en-us/library/ee372288.aspx)将解释该库的功能。

具体来说，您希望将处理您的响应视为页面上讨论的延续。

# java - Appengine DevMode：拒绝访问（“java.lang.RuntimePermission”“accessClassInPackage.sun.security.util”）

> ID：10034900
> 
> 赞同：1
> 
> 时间：2012-04-05T19:36:45.490
> 
> 标签：java, google-app-engine, ubuntu, openjdk, objectify

我将我的 PC 升级到 Ubuntu 12.04，然后恢复了我的工作区和 Eclipse 的备份。现在，当我尝试启动我的 AppEngine/GWT 应用程序时，我遇到了 java 安全管理器的问题。

```
Caused by: java.security.AccessControlException: access denied ("java.lang.RuntimePermission" "accessClassInPackage.sun.security.util")
    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:366)
    at java.security.AccessController.checkPermission(AccessController.java:555)
    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
    at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:252) 
```

我正在使用 appengine SDK 1.6.4 和 Objectify4

我的java版本是

OpenJDK Runtime Environment (IcedTea7 2.1) (7~u3-2.1-1ubuntu3) OpenJDK 64-Bit Server VM (build 22.0-b10, mixed mode)

我已经尝试回到 jdk 6 但这并没有帮助。我还尝试通过更改 java.policy 文件并定义本地策略文件来解决此问题。到目前为止没有运气。我从 svn 下载了 AppEngine SDK 源代码，但行号并不匹配，但我可以看到设置了更严格的安全管理器。

此处的完整堆栈跟踪...任何帮助表示赞赏：

```
java.lang.ExceptionInInitializerError
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at sun.security.jca.ProviderConfig$2.run(ProviderConfig.java:224)
    at sun.security.jca.ProviderConfig$2.run(ProviderConfig.java:206)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.security.jca.ProviderConfig.doLoadProvider(ProviderConfig.java:206)
    at sun.security.jca.ProviderConfig.getProvider(ProviderConfig.java:187)
    at sun.security.jca.ProviderList.getProvider(ProviderList.java:232)
    at sun.security.jca.ProviderList.getService(ProviderList.java:330)
    at sun.security.jca.GetInstance.getInstance(GetInstance.java:157)
    at java.security.Security.getImpl(Security.java:695)
    at java.security.AlgorithmParameters.getInstance(AlgorithmParameters.java:146)
    at sun.security.x509.AlgorithmId.decodeParams(AlgorithmId.java:121)
    at sun.security.x509.AlgorithmId.<init>(AlgorithmId.java:114)
    at sun.security.x509.AlgorithmId.parse(AlgorithmId.java:381)
    at sun.security.x509.X509Key.parse(X509Key.java:168)
    at sun.security.x509.CertificateX509Key.<init>(CertificateX509Key.java:75)
    at sun.security.x509.X509CertInfo.parse(X509CertInfo.java:705)
    at sun.security.x509.X509CertInfo.<init>(X509CertInfo.java:169)
    at sun.security.x509.X509CertImpl.parse(X509CertImpl.java:1747)
    at sun.security.x509.X509CertImpl.<init>(X509CertImpl.java:196)
    at sun.security.provider.X509Factory.engineGenerateCertificate(X509Factory.java:97)
    at java.security.cert.CertificateFactory.generateCertificate(CertificateFactory.java:339)
    at sun.security.provider.JavaKeyStore.engineLoad(JavaKeyStore.java:747)
    at sun.security.provider.JavaKeyStore$JKS.engineLoad(JavaKeyStore.java:55)
    at java.security.KeyStore.load(KeyStore.java:1214)
    at com.google.appengine.api.urlfetch.dev.LocalURLFetchService.getTrustStore(LocalURLFetchService.java:190)
    at com.google.appengine.api.urlfetch.dev.LocalURLFetchService.createValidatingScheme(LocalURLFetchService.java:206)
    at com.google.appengine.api.urlfetch.dev.LocalURLFetchService.createHttpClient(LocalURLFetchService.java:252)
    at com.google.appengine.api.urlfetch.dev.LocalURLFetchService.init(LocalURLFetchService.java:298)
    at com.google.appengine.api.channel.dev.LocalChannelService.createFetchService(LocalChannelService.java:83)
    at com.google.appengine.api.channel.dev.LocalChannelService.init(LocalChannelService.java:62)
    at com.google.appengine.tools.development.ApiProxyLocalImpl.startServices(ApiProxyLocalImpl.java:581)
    at com.google.appengine.tools.development.ApiProxyLocalImpl.access$700(ApiProxyLocalImpl.java:46)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$2.run(ApiProxyLocalImpl.java:564)
    at com.google.appengine.tools.development.ApiProxyLocalImpl$2.run(ApiProxyLocalImpl.java:562)
    at java.security.AccessController.doPrivileged(Native Method)
    at com.google.appengine.tools.development.ApiProxyLocalImpl.getService(ApiProxyLocalImpl.java:561)
    at com.google.appengine.tools.development.ApiProxyLocalImpl.resolveDeadline(ApiProxyLocalImpl.java:233)
    at com.google.appengine.tools.development.ApiProxyLocalImpl.doAsyncCall(ApiProxyLocalImpl.java:214)
    at com.google.appengine.tools.development.ApiProxyLocalImpl.makeSyncCall(ApiProxyLocalImpl.java:147)
    at com.googlecode.objectify.cache.TriggerFutureHook.makeSyncCall(TriggerFutureHook.java:154)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.google.appengine.tools.development.agent.runtime.Runtime.invoke(Runtime.java:112)
    at com.googlecode.objectify.cache.TriggerFutureHook$1.invoke(TriggerFutureHook.java:212)
    at $Proxy35.makeSyncCall(Unknown Source)
    at com.google.apphosting.api.ApiProxy.makeSyncCall(ApiProxy.java:101)
    at com.google.apphosting.api.ApiProxy.makeSyncCall(ApiProxy.java:50)
    at com.google.appengine.api.channel.ChannelServiceImpl.createChannelImpl(ChannelServiceImpl.java:59)
    at com.google.appengine.api.channel.ChannelServiceImpl.createChannel(ChannelServiceImpl.java:34)
    at com.klawt.server.NavLinkApp.setupUser(NavLinkApp.java:71)
    at com.klawt.server.NavLinkApp.handle(NavLinkApp.java:47)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.routing.Router.doHandle(Router.java:431)
    at org.restlet.routing.Router.handle(Router.java:648)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.engine.application.StatusFilter.doHandle(StatusFilter.java:154)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.engine.CompositeHelper.handle(CompositeHelper.java:211)
    at org.restlet.engine.application.ApplicationHelper.handle(ApplicationHelper.java:84)
    at org.restlet.Application.handle(Application.java:377)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.routing.Router.doHandle(Router.java:431)
    at org.restlet.routing.Router.handle(Router.java:648)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.routing.Router.doHandle(Router.java:431)
    at org.restlet.routing.Router.handle(Router.java:648)
    at org.restlet.routing.Filter.doHandle(Filter.java:159)
    at org.restlet.routing.Filter.handle(Filter.java:206)
    at org.restlet.engine.CompositeHelper.handle(CompositeHelper.java:211)
    at org.restlet.Component.handle(Component.java:392)
    at org.restlet.Server.handle(Server.java:516)
    at org.restlet.engine.ServerHelper.handle(ServerHelper.java:72)
    at org.restlet.engine.adapter.HttpServerHelper.handle(HttpServerHelper.java:152)
    at org.restlet.ext.servlet.ServerServlet.service(ServerServlet.java:1089)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:60)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:122)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:78)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:369)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.security.AccessControlException: access denied ("java.lang.RuntimePermission" "accessClassInPackage.sun.security.util")
    at java.security.AccessControlContext.checkPermission(AccessControlContext.java:366)
    at java.security.AccessController.checkPermission(AccessController.java:555)
    at java.lang.SecurityManager.checkPermission(SecurityManager.java:549)
    at com.google.appengine.tools.development.DevAppServerFactory$CustomSecurityManager.checkPermission(DevAppServerFactory.java:252)
    at java.lang.SecurityManager.checkPackageAccess(SecurityManager.java:1529)
    at java.lang.ClassLoader$1.run(ClassLoader.java:490)
    at java.lang.ClassLoader$1.run(ClassLoader.java:488)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.lang.ClassLoader.checkPackageAccess(ClassLoader.java:488)
    at sun.security.pkcs11.SunPKCS11.<clinit>(SunPKCS11.java:63)
    ... 121 more 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-06T16:48:44.577

在尝试了不同的 Appengine SDK 版本后，在 openJDK 6 和 7 之间切换，我最终删除了 openJDK 并下载了 Oracle JDK 6，设置了 JAVA_HOME 和 PATH。

甲骨文 JDK 工作！

所以这是一个 Ubuntu 12.04 / OpenJDK 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-21T16:22:40.370

一个旧的，但我确认这也适用于 Windows 10 64 位。就我而言，已经能够将 Oracle jre-6u45-windows-i586.exe 与 Firefox 10 和 Oracle Forms 一起使用。它是唯一的 JRE，所有其他 JRE 都导致访问被拒绝（“java.lang.RuntimePermission”等。谢谢 :)

# java - 如何获取给定节点的属性？

> ID：10034910
> 
> 赞同：0
> 
> 时间：2012-04-05T19:37:52.957
> 
> 标签：java, xml-parsing

我正在尝试编写 DOM XML 解析。我的 XML 文件

```
<?xml version="1.0"?>
<BLAH>
    <AgentNm type="citi1">
        <accName>accName1</accName>
        <accType>accType1</accType>
        <someThing>someThing1</someThing>
        <amt>100000</amt>
    </AgentNm>
    <AgentNm type="citi2">
        <accName>accName2</accName>
        <accType>accType2</accType>
        <someThing>someThing2</someThing>
        <amt>200000</amt>
    </AgentNm>
</BLAH> 
```

我尝试遵循java代码

```
DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
            DocumentBuilder docBuilder = docBuilderFactory.newDocumentBuilder();
            Document doc = docBuilder.parse (new File("c:\\file.xml"));
            // normalize text representation
            doc.getDocumentElement ().normalize ();
            System.out.println ("Root element of the doc is " +doc.getDocumentElement().getNodeName());
            NodeList agentNm = doc.getElementsByTagName("AgentNm");
            int totalAgentNm = agentNm.getLength();
            System.out.println("Total no of Agents : " + totalAgentNm);
            for(int s=0; s<agentNm.getLength() ; s++){
                Node firstPersonNode = agentNm.item(s);
                if(firstPersonNode.getNodeType() == Node.ELEMENT_NODE){
                    Element firstPersonElement = (Element)firstPersonNode;
                    PrintNodeElem(firstPersonElement,"type");
                 }//end of if clause
            }//end of for loop with s var
        static void PrintNodeElem(Element nodeElem,String elem){
         NodeList someThingList = nodeElem.getElementsByTagName(elem);
         Element ageElement = (Element)someThingList.item(0);
         NodeList textAgeList = ageElement.getChildNodes();
         System.out.println(elem+" : " +((Node)textAgeList.item(0)).getNodeValue().trim());
    } 
```

但是，当我尝试执行上述方法时，我得到空指针异常。谁能解释我，如何解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:03:09.450

如果您想要给定节点的属性，我建议您使用 XPath。这要容易得多。 [http://onjava.com/onjava/2005/01/12/xpath.html](http://onjava.com/onjava/2005/01/12/xpath.html)

# c - fgets() 在多次执行后崩溃

> ID：10034912
> 
> 赞同：0
> 
> 时间：2012-04-05T19:37:55.403
> 
> 标签：c, fgets

我正在编写一个程序来破解 CRC16。我在输出文件并保留计算出的 CRC16 时遇到了一些问题（不知道为什么当我将它写入文件时它会改变）。所以我在这里做的是读取输入文件，将它写入带有一些乱码的输出文件，然后我再次读取输出文件并计算它的 CRC16。如果它与所需的 CRC16 匹配，则完成。然而，在一系列执行之后， fgets() 方法会因 Seg 错误而崩溃。

任何人都可以帮助我吗？请忽略性能问题，这是一个测试。

```
int main(int argc, char* argv[]){

        char outfile[strlen(argv[1])];
        strcpy(outfile,argv[1]);

        strcat(outfile,".crack");

        char crc16[5];
        strcpy(crc16,argv[2]);
        char newcrc16[5];
        char gebrish[80];
        char cat[2];
        int full = 1;
        int p = 0;
        int i,j,k;

        for(i=32; i< 128;i++)
                for(j=32; j< 128; j++)
                        for(k=32; k < 128; k++){
                                gebrish[0] =i;
                                gebrish[1] =j;
                                gebrish[2] =k;
                                gebrish[3] = '\n';
                                gebrish[4] ='\0';

                                boost::crc_16_type result;

                                FILE* file;
                                FILE* out;
                                char line[100];

                                printf("read out\n");
                                out = fopen(outfile,"w");

                                printf("read file\n");
                                file = fopen(argv[1],"r");
                printf("wrt\n");
                                while(fgets(line,80,file) != NULL){
                                        fputs(line,out);
                                }
                                fputs(gebrish,out);

                                fclose(file);
                                fclose(out);

                                printf("read gain\n");
                                out = fopen(outfile,"r");

                                while(fgets(line,80,out) != NULL){
                                        result.process_bytes(line,strlen(line));
                                        printf("%s",line);
                                }

                                int crc = result.checksum();

                                sprintf(newcrc16,"%x",crc);
                                printf("%s",newcrc16);

                                if(strcmp(crc16,newcrc16) == 0){

                                        printf("%s",gebrish);
                                        return 0;

                                }
                        }

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T19:43:20.020

这会导致缓冲区溢出：

```
char outfile[strlen(argv[1])];
strcpy(outfile,argv[1]);

strcat(outfile,".crack"); 
```

因为没有足够的空间`outfile`来终止空字符和`".crack"`. 它将覆盖它不应该覆盖的内存，并且*可能*是分段错误的原因。

改成：

```
 char outfile[strlen(argv[1]) + 1 + 6];
    strcpy(outfile,argv[1]);

    strcat(outfile,".crack"); 
```

在访问`argv`元素之前，通过检查确保它们已提供`argc`：

```
if (argc > 2)
{
    /* Safe to use argv[1] and argv[2]. */
} 
```

也检查返回值`fopen()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T19:49:46.253

该错误很可能是由于未检查 open 的返回值，然后在错误文件上调用 fgets。如果后续操作依赖于系统调用的返回，则应始终检查它们。即使关闭也可能失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-07T00:29:48.350

问题是我试图在不同的时刻从同一个文件中读取和写入，而没有在使用后调用 fclose()。这样，在执行了一些循环后，它会因 STATUS_VIOLATION 而崩溃。我不知道为什么它没有立即崩溃，但我所做的只是在读取文件以进行 CRC16 计算后添加一个 flcose() 。

# c++ - std::map 构造函数的奇怪用法

> ID：10034914
> 
> 赞同：3
> 
> 时间：2012-04-05T19:38:18.257
> 
> 标签：c++, stl

我搜索了 std::map 运行时排序的实现并找到了这个解决方案： [STL std::map dynamic ordering](https://stackoverflow.com/questions/4457679/stl-stdmap-dynamic-ordering)

我很清楚，但我不明白，如何在 std::map 的构造函数中使用 OrderingType。std::map 有一个构造函数，它获取一个比较器对象作为参数。所以从我的角度来看，使用这样的代码是正常的：

```
int main()
{
   Ordering<int> test_ordering( ASCENDING );   
   CUSTOMMAP map1( test_ordering );

   return 0;
} 
```

但是上述主题的代码也可以编译：

```
int main()
{
   CUSTOMMAP map1( ASCENDING );
   //...
   return 0;
} 
```

我不明白它为什么起作用：std::map 的构造函数不能获取 OrderingType 枚举的参数，而不是 Ordering 类对象本身。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T19:42:08.990

如果使用`Ordering<int>`您的枚举的构造函数未声明为`explicit`，则它被视为“转换构造函数”，当编译器需要从您的枚举类型转换为该`Ordering<int>`类型时，可以自动插入该构造函数。所以编译器有效地采取了这个：

```
CUSTOMMAP map1( ASCENDING ); 
```

并将其转化为：

```
CUSTOMMAP map1( Ordering<int>(ASCENDING) ); 
```

这称为**隐式转换**。

# .net - Freetype .net 包装器问题（试图写入受保护的内存异常）

> ID：10034915
> 
> 赞同：0
> 
> 时间：2012-04-05T19:38:20.027
> 
> 标签：.net, freetype2

我正在尝试为 .net 设置 freetype2，但我仍然不够幸运。所以我正在使用[这个问题](https://stackoverflow.com/questions/6207176/compiling-freetype-to-dll-as-opposed-to-static-library)的答案。目前，我尝试使用 Init_FreeType 函数时遇到一个异常，我试图将其写入受保护的内存。我使用的代码如下：

```
Intptr library = new Intptr();
FreeType.FT.Init_FreeType(library); 
```

包装器中 Init_FreeType 函数的声明如下：

```
[DllImport(FT_DLL, EntryPoint = "FT_Init_FreeType"), SuppressUnmanagedCodeSecurity]
public static extern int Init_FreeType(IntPtr /*IntPtr LibraryRec_*/ alibrary); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T22:18:03.253

在我看来，声明`Init_FreeType`是错误的。应该是：

```
public static extern int Init_FreeType(ref IntPtr alibrary); 
```

（参数是 a `ref`）。并称之为：

```
IntPtr library = IntPtr.Zero;
FreeType.FT.Init_FreeType(ref library); 
```

我怀疑正在发生的事情是`Init_FreeType`将传递的值视为引用并尝试将库句柄存储在该内存位置。但是由于您传递的是指针的*值*（而不是指针的位置），它就会陷入困境。

回复评论的更多信息：

[FT_Init_FreeType](http://freetype.sourceforge.net/freetype2/docs/reference/ft2-base_interface.html#FT_Init_FreeType)的文档将其定义为：

```
FT_EXPORT( FT_Error ) FT_Init_FreeType( FT_Library  *alibrary ); 
```

`FT_Error`是一个`int`，并且`FT_Library`是

```
typedef struct FT_LibraryRec_  *FT_Library; 
```

所以你肯定需要`ref`on call。托管原型应该如我上面所示。

堆栈不平衡几乎肯定是由错误的调用约定引起的。在 .NET 中，默认调用约定是 stdcall。在我看来，FreeType 正在使用 cdecl 调用约定。所以你`DllImport`应该是：

```
[DllImport(FT_DLL, EntryPoint="FT_Init_FreeType", 
    CallingConvention=CallingConvention.Cdecl), SuppressUnmanagedCodeSecurity] 
```

# python - 删除列表中的尾随空元素

> ID：10034917
> 
> 赞同：14
> 
> 时间：2012-04-05T19:38:50.427
> 
> 标签：python, list

是否有一种优雅的 Pythonic 方法可以从列表中删除尾随的空元素？一种`list.rstrip(None)`。所以

```
[1, 2, 3, None, 4, None, None] 
```

应该导致

```
[1, 2, 3, None, 4] 
```

我想这可以概括为删除任何特定值的尾随元素。

如果可能的话，我希望将其作为单行（可读）表达式完成

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-05T19:41:48.337

如果您只想摆脱`None`值并留下零或其他虚假值，您可以这样做：

```
while my_list and my_list[-1] is None:
    my_list.pop() 
```

要删除所有虚假值（零、空字符串、空列表等），您可以执行以下操作：

```
my_list = [1, 2, 3, None, 4, None, None]
while not my_list[-1]:
    my_list.pop()
print(my_list)
# [1, 2, 3, None, 4] 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-05T19:45:02.500

以下显式检查`None`元素：

```
while l and l[-1] is None:
    l.pop() 
```

可以概括如下：

```
f = lambda x: x is None
while l and f(l[-1]):
    l.pop() 
```

您现在可以定义不同的函数`f`来检查其他条件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-05T19:51:51.610

```
def remove_trailing(l, remove_value=None):
    i = len(l)
    while i > 0 and l[i - 1] == remove_value:
        i -= 1
    return l[:i] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-05T19:45:46.670

尝试这个

```
>>> x=[1, 2, 3, None, 4, None, None]
>>> while x[-1] is None:
    x.pop() 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-05T19:51:20.970

对于单线解决方案：

```
In [30]: from itertools import dropwhile

In [31]: list(reversed(tuple(dropwhile(lambda x: x is None, reversed([1, 2, 3, None, 4, None, None])))))
Out[31]: [1, 2, 3, None, 4] 
```

如果你想重用它，这里有一个无点风格的定义：

```
In [36]: from functional import compose, partial

In [37]: varargs = lambda *args: args

In [38]: compose_mult = compose(partial(reduce, compose),varargs) # compose which takes variable number of arguments. Innermost function to the right.

In [39]: compose_mult(list, reversed, tuple, partial(dropwhile, lambda x: x is None), reversed)([1, 2, 3, None, 4, None, None])
Out[39]: [1, 2, 3, None, 4] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-05T20:35:41.007

我从未接受过答案，因为我对所提供的解决方案并不满意。这是另一个我不完全满意的解决方案（1 行，没有库依赖项）：

```
a = [1, 2, None, 3, None, None]
reduce(lambda l, e: [e]+l if l or e is not None else [], reversed(a), []) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-05T19:57:40.033

如果您正在寻找单线，它可能是这样的：

```
a = [1, 2, 3, None, 4, None, None]
b = [x for n, x in enumerate(a) if any(y is not None for y in a[n:])]
print b 
```

请注意，它是二次的（在最坏的情况下）。

对于任何虚假值，它甚至更简单：

```
b = [x for n, x in enumerate(a) if any(a[n:])] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-05T20:06:15.393

如果你真的需要牺牲可读性，我会这样做。

```
>>> from itertools import takewhile
>>> l=[1,2,3,None,4,5,None,None]
>>> l[:-len(list(takewhile(lambda x: x==None, reversed(l))))]
[1,2,3,None,4,5] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-15T08:12:05.203

The [`more_itertools`](https://github.com/erikrose/more-itertools) project implements `rstrip` for any iterable:

```
iterable = [1, 2, 3, None, 4, None, None]
list(mit.rstrip(iterable, lambda x: x in {None}))
# [1, 2, 3, None, 4] 
```

`more_itertools.rstrip` accepts an iterable and predicate. See the [source code](https://github.com/erikrose/more-itertools/blob/master/more_itertools/more.py#L1361) for details.

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-04-05T21:30:10.617

递归+切片呢？

```
>>> rstrip = lambda x, elts=(None,): rstrip(x[:-1], elts) if x and x[-1] in elts else x
>>> rstrip([1, 2, 3, None])
[1, 2, 3]
>>> rstrip([1, 2, 3, None], (None, 3))
[1, 2] 
```

注意：我假设您不是在这里寻找计算效率最高的解决方案......

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2012-04-05T20:04:18.327

这是另一个单线：

```
>>> l = [1, 2, 3, None, 4, None, None]
>>> [l[i] for i in range(len("".join(map(lambda x: {None: " "}.get(x, "_"), l)).rstrip()))]
[1, 2, 3, None, 4] 
```

这些东西很有趣！

**编辑**

我刚刚意识到列表理解是完全没有必要的。切片应该可以正常工作：

```
>>> l[:len("".join(map(lambda x: {None: " "}.get(x, "_"), l)).rstrip())] 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-02-05T12:38:29.357

关于什么：

```
[a[i] for i in range(len(a)) if a[i:] != [None] * (len(a) - i) ] 
```

# iphone - 在 iPhone 上打开与 SQLITE 数据库的连接太慢

> ID：10034918
> 
> 赞同：0
> 
> 时间：2012-04-05T19:38:55.140
> 
> 标签：iphone, xcode, ipad, sqlite, fmdb

我创建了一个简单的 iPhone/iPad 应用程序，它从 SQLITE 数据库中读取一些数据并将其显示在屏幕上。数据库添加到 Xcode 项目中，只需要读取（而不是写入）。在模拟器中，这一切都很好，但是当我在我的 iPhone 上运行这个应用程序时，它太慢了。

我已经向应用程序添加了一些性能分析，因此我能够确定应用程序的哪个部分运行缓慢。似乎打开与数据库的连接在 iPhone 上大约需要 0.8 - 0.9 秒，在 iPad 上大约需要 0.004 秒。我使用 SQLLITE 框架和 FMDB 包装器进行了测试，但结果是一样的。

为什么在 iPhone 上这么慢？有没有办法提高性能？

谢谢，丹尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T20:36:44.570

你多久打开一次？如果您可以打开它一次，并保持该手柄打开并重复使用它，那可能会解决您的问题。

还是它打开的这个单一实例是太大的负担？

# unit-testing - 单元测试基本控制器

> ID：10034924
> 
> 赞同：1
> 
> 时间：2012-04-05T19:39:27.807
> 
> 标签：unit-testing, zend-framework, phpunit, code-coverage

我有许多简单的控制器类，它们使用 Doctrine 的实体管理器来检索数据并将其传递给视图。

```
public function indexAction() {
    $pages = $this->em->getRepository('Model_Page')->findAll();
    $this->view->pages = $pages;
} 
```

**我们究竟应该在这里测试什么？**

*   我可以在操作上测试路由以确保正确配置
*   我可能会测试是否正在设置适当的视图变量，但这很麻烦

该`findAll()`方法可能应该位于可以使用模拟数据进行测试的存储库层中，但这构成了一种不同*类型*的测试，并使我们回到了问题

> 作为控制器测试的一部分，我们应该测试什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:01:59.233

控制器为您的应用程序保存核心逻辑。尽管简单的“索引”控制器操作没有任何特定功能，但那些验证/主动使用数据并生成视图模型的操作几乎具有系统的大部分功能。

例如，考虑登录表单。每当发布登录数据时，控制器应验证登录名/密码并返回： 1) 只要登录良好，就返回索引页面。显示欢迎，{user} 文本。2）到登录页面，说在db中找不到登录名。3）到登录页面，说在数据库中找不到密码。

这三种类型的输出构成了完美的测试用例。您应该验证正确的视图模型/视图正在通过适当的操作发送回客户端。

你不应该把控制器看成神秘的东西。它只是另一个代码片段，它像任何其他代码一样被测试——任何给用户带来商业价值的复杂逻辑都应该被测试。

另外，我建议使用带有 Cucumber 之类的框架的验收测试来生成有意义的测试用例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-10T21:51:02.210

控制器可能是最难测试的东西，因为它有很多依赖项。从理论上讲，您应该完全隔离地对其进行测试，但正如您已经看到的那样 - 它没有任何意义。

可能您应该从功能测试或验收测试开始。它整体测试您的控制器操作。我同意之前的回答，您应该尝试验收测试工具。但 Cucumber 适用于 Ruby，对于 PHP，您可以尝试使用[Codeception](http://codeception.com/)。它使测试变得简单而有意义。

在 Codeception 页面上还有一篇关于[如何测试示例控制器](http://codeception.com/docs/06-UnitTestsScenarios)的文章。

# ios - 空权限数组在 iOS 下没有得到正确的授权回调

> ID：10034928
> 
> 赞同：0
> 
> 时间：2012-04-05T19:39:48.697
> 
> 标签：ios, authentication, permissions, facebook-oauth

我们的 iOS 应用需要“publish_stream”权限。我们现在将其删除并传入一个空字符串 NSArray，但它不会反映在身份验证屏幕中。

它不断告诉用户“这个应用程序可能会代表你发布，包括状态更新、照片等等。” 我们似乎无法重置它。

```
- (void)facebookLogin
{
    NSArray *permissions = [NSArray arrayWithObjects: @"",nil]; // was @"publish_stream"
    // Look here for a list of available permissions:
    // http://developers.facebook.com/docs/reference/api/permissions/
    [_facebook authorize:permissions];
} 
```

我们尝试传入 nil 而不是空字符串 NSArray 但这没有帮助。开发者页面的 App Settings 中是否有 auth 选项需要调整？

有任何想法吗？

谢谢！贡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T04:32:36.867

这显然是最近的一个错误。[在此处](https://developers.facebook.com/bugs/273948536030203?browse=search_4f9024e9e3a232279544264)查看开发者论坛。希望他们能尽快解决。

# php - 使用组合框在文本字段中获取值

> ID：10034929
> 
> 赞同：0
> 
> 时间：2012-04-05T19:39:48.807
> 
> 标签：php, javascript, html, combobox

当从组合框中选择值时，我想从数据库中将值放入文本字​​段

ps：组合框中的值和我想要进入文本字段的值来自数据库中的同一个表

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T19:47:57.013

如果选择框中的值与文本字段中所需的值相同，则可以使用 jQuery 执行此操作：

```
$("select").on('change',function(){
    $("input").val($("select option:selected").val());
});​ 
```

只需用这些字段的选择器替换`select`和`input`，这一切都在客户端处理，这是一个演示：http: [//jsfiddle.net/JKirchartz/JwjX3/](http://jsfiddle.net/JKirchartz/JwjX3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T09:35:30.147

我的朋友说：

```
$('select').change(function(){
            var t = $('select').val();
            $('input').val(t);            
          }); 
```

# scala - 使用 LIFT 处理 HTTP OPTIONS 动词

> ID：10034931
> 
> 赞同：1
> 
> 时间：2012-04-05T19:39:56.527
> 
> 标签：scala, lift, options, cors

我正在使用 LIFT 来提供 RESTful API，并且我希望此 API 允许使用 CORS（跨源资源共享）进行 POST 请求。我确实有 CORS 处理 GET 请求。

我遇到了麻烦，因为跨域 POST 首先在给定的 URL 上调用 OPTIONS，而我还没有弄清楚如何使用 LIFT 接受 OPTIONS 请求。

我的问题是：我需要混合或写入我的`serve{}`块，以便我可以允许 HTTP 动词 OPTIONS 用于 LIFT 中的给定路径？

现在使用 curl 我得到：

```
curl -X OPTIONS http://localhost:8080/path => [404] 
```

我正在使用 LIFT 2.4-M5 和 Scala 2.9.1

编辑：根据[pr1001](https://stackoverflow.com/users/46768/pr1001)的建议，我试图像这样扩展[RestHelper](http://scala-tools.org/mvnsites/liftweb-2.4/#net.liftweb.http.rest.RestHelper)：

```
import net.liftweb.http.provider._
import net.liftweb.http._

trait RestHelper extends net.liftweb.http.rest.RestHelper {
    protected object Options {
        // Compile error here with options_?
        // because net.liftweb.http.Req uses LIFT's RequestType
        def unapply(r: Req): Option[(List[String], Req)] =
            if (r.requestType.options_?) Some(r.path.partPath -> r) else None
    }
}

@serializable
abstract class RequestType extends net.liftweb.http.RequestType {
    def options_? : Boolean = false
}

@serializable
case object OptionsRequest extends RequestType {
    override def options_? = true
    def method = "OPTIONS"
}

object RequestType extends net.liftweb.http.RequestType {
    def apply(req: HTTPRequest): net.liftweb.http.RequestType = {
        req.method.toUpperCase match {
            case "OPTIONS" => UnknownRequest("OPTIONS")
            case _ => net.liftweb.http.RequestType.apply(req)
        }
    }

    def method = super.method
} 
```

我觉得这是我应该做的更多工作，因为我不想用我自己的 RequestType impl扩展[Req 。](http://scala-tools.org/mvnsites/liftweb-2.4/#net.liftweb.http.Req)

当谈到 Scala 时，我肯定处于较低的技能水平，所以我希望有人可以提供一个更简单的解决方案，因为我确信我缺少一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T20:15:24.883

你在使用[RestHelper](http://scala-tools.org/mvnsites/liftweb-2.4/#net.liftweb.http.rest.RestHelper)吗？如果是这样，您将指定要响应的请求类型并返回[LiftResponse](http://scala-tools.org/mvnsites/liftweb-2.4/#net.liftweb.http.LiftResponse)。`OptionRequest`在传递给的部分函数中，Lift 中没有（尚未）使用，`serve()`但您应该能够使用自己的版本扩展[RequestType 。](http://scala-tools.org/mvnsites/liftweb-2.4/#net.liftweb.http.RequestType)使用[UnknownRequest](http://scala-tools.org/mvnsites/liftweb-2.4/#net.liftweb.http.UnknownRequest)（如中`UnknownRequest("OPTION")`）也可以解决问题。

这可能也值得在[邮件列表中](https://groups.google.com/forum/#!forum/liftweb)提出，因为 CORS 支持将是一个有用的补充......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-06T20:34:53.790

非常感谢 pr1001 的建议。我能够使它与以下内容一起工作：

```
import net.liftweb.http._

class RequestTypeImproved(requestType: RequestType) {
    def options_? : Boolean = requestType.method == "OPTIONS"
}

trait RestHelper extends net.liftweb.http.rest.RestHelper {
    implicit def req2ReqImproved(requestType: RequestType): RequestTypeImproved = {
        new RequestTypeImproved(requestType)
    }

    protected object Options {
        def unapply(r: Req): Option[(List[String], Req)] =
            if (r.requestType.options_?) Some(r.path.partPath -> r) else None
    }
} 
```

然后：

```
serve {
    case req @ "path" Options _ => {
        LiftResponse(...)
    }
} 
```

# php - 使用 RegEx 时出现未知修饰符错误

> ID：10034936
> 
> 赞同：0
> 
> 时间：2012-04-05T19:40:13.017
> 
> 标签：php, regex, preg-match, preg-match-all

我对常规表达式不是很了解，所以我不明白为什么会出现这个错误。

我正在使用以下代码来匹配字符串中的所有电子邮件`$str`并将它们保存在数组中`$match`：

```
preg_match_all(
    "/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/",
    $str,
    $match
); 
```

显然，正则表达式（我从[这里](http://www.w3.org/TR/html-markup/datatypes.html#form.data.emailaddress)得到）中存在问题，因为我收到了这个错误：

> 警告：preg_match_all() [function.preg-match-all]: Unknown modifier '=' in C:\xampp\htdocs\project\Framework\Sanitizer.class.php 第 38 行

有人可以告诉我有什么问题吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-05T19:45:41.420

您必须在等号之前转义正斜杠，例如：

```
preg_match_all(
    "/^[a-zA-Z0-9.!#$%&’*+\/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/",
    $str,
    $match
); 
```

“/”是整个表达式的分隔符，因此必须在正则表达式本身中进行转义

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-05T19:45:31.240

您需要使用反斜杠转义该字符串中的许多字符。您想逃避的一些是： /?^{|} 。

我会这样写：

```
preg_match_all(
    "/^[a-zA-Z0-9.!#$%&’*+\/=\?\^_`\{\|\}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/",
    $str,
    $match
); 
```

我发现这个网站在匹配电子邮件地址方面非常有用：

[http://www.regular-expressions.info/email.html](http://www.regular-expressions.info/email.html)

# c# - 为什么我应该在使用位图时保持流打开

> ID：10034942
> 
> 赞同：2
> 
> 时间：2012-04-05T19:40:53.190
> 
> 标签：c#, .net

我不知道为什么我在使用`Bitmap`or时应该保持流打开`Image`。

我尝试关闭流并以多种方式使用我的图像，一切都很好。

`Image`问题是如果在初始化对象后继续关闭流，在什么情况下会出现异常？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-05T19:46:45.213

该类`Image`在创建时不会通过[`Image.FromFile`](http://msdn.microsoft.com/en-us/library/system.drawing.image.fromfile.aspx)或读取整个图像[`Image.FromStream`](http://msdn.microsoft.com/en-us/library/system.drawing.image.fromstream.aspx)，而只会读取足以响应基本查询（例如大小和像素格式）的内容。

只有当您尝试以任何方式访问像素（通常通过在屏幕上绘制图像）时，它才会读取图像数据。

这种惰性意味着它需要在其生命后期需要访问底层流（或文件）时。

# android - 如何授予android mediaserver文件写入权限？

> ID：10034946
> 
> 赞同：0
> 
> 时间：2012-04-05T19:41:02.937
> 
> 标签：android, permissions, android-ndk

我正在开发几个正在编译到 Android 4.0.3 ICS 中的 AudioEffect 子类...我正在尝试将原始 PCM 数据转储到文件中，但是由于 AudioEffects 在 mediaserver 进程的上下文中运行，因此似乎没有文件写入权限可用的。

```
fopen("/data/local/tmp/pcm_in.pcm", "w"); 
```

正在返回一个 NULL 指针和 errno 13（权限被拒绝）。

有什么想法可以授予媒体服务器此权限，或写入我可以访问的文件夹吗？我正在编译操作系统，所以一切顺利......

**更具体地说：**这些本机/系统服务的权限是如何确定的？我不认为他们有 AndroidManifest.xml ......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T20:45:35.550

我怀疑问题是您没有权限在`/data/local/tmp`. 事实上，我什至不确定 Android 上是否存在该目录。

相反，您应该将私有存储用于应用程序或将文件保存到 SD 卡。有关更多信息，请参见：http: [//developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-28T07:26:05.673

也许您可以创建一个具有权限的文件夹。

```
root@android:/mount -o remount,rw /
root@android:/mkdir test
root@android:/chown media:media test
root@android:/chmod 777 test 
```

然后你可以做任何你想做的事。

zB

```
fopen("/test/pcm_in.pcm", "w"); 
```

# java - 任何 Java 插件/代码来管理上传的文件？

> ID：10034965
> 
> 赞同：0
> 
> 时间：2012-04-05T19:43:05.343
> 
> 标签：java, spring, hibernate

根据目前的需求，用户会上传大尺寸的文件，以后可能会喜欢下载。我无法将上传的文件存储在数据库中，因为文件的大小很大，如果我将上传的文件存储在数据库中，性能会受到影响。任何人都知道任何在网络服务器上提供有效文件管理并维护文件链接的java插件，以便在请求链接时可以下载文件。此外，代码将确保用户只能下载他们上传的那些文件，他们不能仅仅通过修改下载链接等来下载任何文件。我使用 spring3 作为框架。

请建议如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-05T20:38:19.907

如果你对文件系统有写访问权，为什么不把它们保存在那里？然后您生成一个唯一 ID 并将哈希/文件关系保存在 db 中，然后您需要提供 ID 以从 servlet 获取文件提要

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-05T20:41:06.020

将文件内容存储在 Web 应用程序之外的文件系统的一部分上，这样您就无法更改链接。

然后，您可以在 db 上存储该文件的路径，并仅在用户有权读取该文件时才返回它们。

请注意，不要将所有文件存储在同一个文件夹中，否则文件数量可能会增长太多。所以想办法用更多的文件夹级别来存储它们。

# php - 我想将 xampp 1.7.7 链接到 php CLI

> ID：10034966
> 
> 赞同：2
> 
> 时间：2012-04-05T19:43:06.587
> 
> 标签：php, phpunit, xampp, pear, ubuntu-11.10

我在本地机器上以 root 身份使用 ubuntu 11.10，我已经安装了 xampp 1.7.7，并且我是 ubuntu 的新手，同时遵循 sitepoint 上的教程（http://www.sitepoint.com/getting- started-with-pear/) 关于如何安装 pear 以使用 PhpUnit，当时我没有注意到，但似乎我在 CL 中安装或使用了现有的 php 版本 5.3.6 来做到这一点，pear 安装也是建立在这个版本，在安装xampp的同时，我现在有两个版本的php，xampp的5.3.8和5.3.6，无论如何，我想做的是使用现有的xampp php版本并在其上构建pear，使所有我通过 xampp.so 我的工作是：

1.  如何卸载php V5.3.6 及其pear 安装？
2.  如何将 CL 与 php 版本链接。xampp 的？
3.  如何在 php 版本上构建下一个 pear 安装。xampp 的？
4.  我想要我所有的网络开发人员。通过xampp工作，我还需要卸载什么，以避免这种混乱吗？4.

我在 attampet 中执行了以下操作来解决问题：

1.  我在 bash 中写了这个：

    gedit ~/.bashrc

2.  我将其添加到 ~/.bashrc 文件的末尾以尝试更改环境路径：

    导出路径=/opt/lampp/bin:$PATH 导出路径=/opt/lampp/lib/php:$PATH 导出路径=/opt/lampp/lib/php/PHPUnit/pearcmd.php:$PATH

3.  我使用'php -v'和'pear list'检查了php和pear版本，我得到了一个输出：

    PHP 5.3.8 (cli)（构建时间：2011 年 9 月 19 日 13:29:27） 版权所有 (c) 1997-2011 The PHP Group Zend Engine v2.3.0，版权所有 (c) 1998-2011 Zend Technologies

和梨：

```
Installed packages, channel pear.php.net:
=========================================
Package          Version State
Archive_Tar      1.3.9   stable
Console_Getopt   1.3.1   stable
PEAR             1.9.4   stable
PHPUnit          1.3.2   stable
Structures_Graph 1.0.4   stable
XML_Util         1.2.1   stable 
```

1.  当我运行时：'phpunit MessageTest.php'：我明白了

    PHP 警告：require_once(PHP/CodeCoverage/Filter.php)：无法打开流：第 38 行的 /usr/bin/phpunit 中没有此类文件或目录

    警告：require_once(PHP/CodeCoverage/Filter.php)：无法打开流：第 38 行的 /usr/bin/phpunit 中没有这样的文件或目录 PHP 致命错误：require_once()：无法打开所需的 'PHP/CodeCoverage/Filter .php' (include_path='.:/php/includes:/opt/lampp/lib/php:/opt/lampp/bin:/opt/lampp/lib/php/PEAR') 在 /usr/bin/phpunit 上第 38 行

5.我运行了其他问题中报告的以下命令作为该错误的解决方案：

```
sudo apt-get remove phpunit
sudo pear channel-discover pear.phpunit.de
sudo pear channel-discover pear.symfony-project.com
sudo pear channel-discover components.ez.no
sudo pear update-channels
sudo pear upgrade-all
sudo pear install --alldeps phpunit/PHPUnit
sudo apt-get install phpunit 
```

并将 php.ini 的包含路径更新为：

```
include_path = ".:/php/includes:/opt/lampp/lib/php:/opt/lampp/bin:/opt/lampp/lib/php/PEAR" 
```

php 文件 MessageTest.php：

```
<?php
  require 'PHPUnit/Autoload.php';
  $path = '/opt/lampp/lib/php/PEAR';
  set_include_path(get_include_path() . PATH_SEPARATOR . $path);

  require_once 'PHPUnit/Framework/TestCase.php';
  require_once 'Message/Controller/MessageController.php';

  class MessageTest extends PHPUnit_Framework_TestCase{
    private $message;
    public function setUp() {
      $this->message = new MessageController();
    }
    public function tearDown() {
    } 
    public function testRepeat(){
      $yell = "Hello, Any One Out There?";  
      $this->message->repeat($yell); //sending a request
      $returnedMessage = $this->message->repeat($yell);//get a response
      $this->assertEquals($returnedMessage, $yell);
    }  
  }
?> 
```

我正在尝试测试的 MessageController.php 中的 MessageController 类

```
<?php

  class MessageController { 
    public function actionHelloWorld() {
      echo 'helloWorld';  
    }
    public function repeat($inputString){
      return $inputString;
    }
  }
  $msg = new MessageController;
?> 
```

我没有使用任何 PHP 框架，我只是让文件和类听起来就是这样。

我仍然得到同样的错误：

```
PHP Warning:  require_once(PHP/CodeCoverage/Filter.php): failed to open stream: No such file or directory in /usr/bin/phpunit on line

Warning: require_once(PHP/CodeCoverage/Filter.php): failed to open stream: No such file or directory in /usr/bin/phpunit on line 38
PHP Fatal error:  require_once(): Failed opening required 'PHP/CodeCoverage/Filter.php' (include_path='.:/php/includes:/opt/lampp/lib/php:/opt/lampp/bin:/opt/lampp/lib/php/PEAR') in /usr/bin/phpunit on line 38 
```

当然，我在这里要求越来越高，我浪费了很多时间并且对此感到非常沮丧，希望你们不要厌倦阅读我的问题，感谢您的帮助

提前致谢， Mohamad elbialy

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-08T02:10:40.437

最后，我得到了关于如何将 xampp 的 php 和 pear 链接到 CL（ubuntu 的 bash shell）的问题的答案，在终端窗口中键入以下内容：

```
gedit ~/.bashrc 
```

文件打开，您将以下内容添加到文件末尾：

```
export PATH=/opt/lampp/bin:$PATH 
```

并确保在终端中键入以下内容：

```
echo $PATH 
```

您将在回显路径中看到“/opt/lampp/bin”以及默认添加的其他路径，这是在搜索论坛、其他 stackoverflow 和超级用户问题 2-3 天后对我有用的唯一方法

要检查 CL 是否处理 xampp 的 php 和 pear 版本，请键入以下内容：

1.  `php -v`显示php的版本
2.  `pear list`显示 pear 的版本以及 pear 依赖包

现在，我一直在这样做以使 PHPunit 在 CL 中工作 5 天，想象一下这种挫败感，作为 Ubuntu 的新手，我做了很多 sudo 而不是 sudo 命令，这对我来说错过了整个事情，所以我决定重新安装 ubuntu（删除我安装的所有 pear、php 和 phpunit 包，但无法跟踪他们的路径）所以从新的 ubuntu 11.10 和 xampp 1.7.7 开始，我做了以下操作来使 phpunit 工作：

1.  我用 cL 为 xampp 的 php 和 pear 创建了链接（我在上面写了），在 CL 中键入以下步骤：
2.  `sudo /opt/lampp/bin/pear uninstall phpunit`（xampp 是 1.2.something，我想安装 3.6.10）
3.  `sudo /opt/lampp/bin/pear list`（PHPunit 不存在，这是一个检查），按照 PHPunit 手册[1中的建议执行以下步骤](http://www.phpunit.de/manual/3.6/en/installation.html)
4.  `sudo /opt/lampp/bin/pear config-set auto_discover 1`（打开下载通道什么的）
5.  `sudo /opt/lampp/bin/pear install pear.phpunit.de/PHPUnit`（这会安装版本 3.6.10），现在输入 CL：（ `sudo /opt/lampp/bin/phpunit --version`这显示了 3.6.10 的版本，是的，你已经成功了）

我使用/opt/lampp/bin/phpunit，让您看到快速结果，不，您不需要在工作路径中包含任何内容，您已经完成了，您需要关闭该终端并打开一个新终端并仅输入, phpunit --version, 你会得到同样的结果，它就在那里，它都是你的

笔记：

1.  我使用'/opt/lampp/bin/something 然后是命令'，通过xampp的php和pear强制我的安装，这不是必需的（因为你设置了环境路径），但这就是你做事时的方式花费超过 5 天的搜索时间。
2.  我尝试使用 xampp 的 phpunit 1.2.something，但它似乎不适用于命令行，我不知道为什么而且我不想这样做，所以如果这种情况发生在你身上并且你想要 ver.1.2.something，找到所有版本，使用此链接（[http://pear.phpunit.de/](http://pear.phpunit.de/)）中的说明并执行相同的步骤来安装它，我没有尝试该链接中的方法，如果您遇到困难，您可以评论此答案，

# windows-phone-7 - windows-phone-7 平台是否可以访问 PC/SC API？

> ID：10034978
> 
> 赞同：1
> 
> 时间：2012-04-05T19:44:00.423
> 
> 标签：windows-phone-7, smartphone, apdu, pcsc

我浏览了 Windows Phone 7 文档网站，但无法找到是否可以在这个平台上编写一个可以使用 APDU 命令/响应 (ISO7816) 与智能手机的 SIM 卡通信的应用程序。

是否可以为此使用 PC/SC 或其他 API，如果可以，我在哪里可以找到有关它的一些文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-05T22:38:26.177

手机不支持。

可以在互操作解锁的情况下做到这一点，但是您无法提交市场。

# c# - 如何让子类属性不是超级和子在一起

> ID：10034982
> 
> 赞同：2
> 
> 时间：2012-04-05T19:44:16.057
> 
> 标签：c#, .net, reflection

```
public class ReflectionBase
    {
        public String ParentProperty1 { get; set; }
        public String ParentProperty2 { get; set; }        
    }

    public class Reflection : ReflectionBase
    {
        public String ChildProperty1 { get; set; }

        public Reflection()
        {
            var property = this.GetType().GetProperties();
        }    
    } 
```

**结果：**
ParentProperty1
ParentProperty2
ChildProperty1
**我需要：**
ChildProperty1

当我调用 GetProperties() 它给了我所有当前类属性和基类，但我只需要当前类属性。

任何帮助请...

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-05T19:45:48.207

用于[`BindingFlags.DeclaredOnly`](http://msdn.microsoft.com/en-us/library/system.reflection.bindingflags.aspx)忽略继承的成员：

```
var properties = this.GetType().GetProperties(
    BindingFlags.Public | BindingFlags.Instance | BindingFlags.DeclaredOnly); 
```

# jquery - jQuery和prototype.js冲突，jQuery怎么保持为$？

> ID：10034991
> 
> 赞同：7
> 
> 时间：2012-04-05T19:44:52.470
> 
> 标签：jquery, prototypejs

所以我正在开发一个同时使用 jQuery 和prototype.js 的网站，但是它们相互冲突。

我进行了相当多的研究，发现人们解决此问题的唯一方法是使用

```
<script>
 jQuery.noConflict();

 // Use jQuery via jQuery(...)
 jQuery(document).ready(function(){
   jQuery(\"div\").hide();
 });

 // Use Prototype with $(...), etc.
 $('someid').hide(); 
```

但是我不想将 $ 更改为 jQuery，因为这意味着我必须编辑相当多的预先编写的代码。有没有办法阻止它们发生冲突并将 jQuery 保留为 $？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-05T19:48:27.347

您可以创建一个闭包（在 末尾`body`），而不是使用 document ready，例如：

```
(function($) {
  //jQuery stuff
  $('.elem') // $ refers to jQuery
})(jQuery); 
```

如果我正确理解你的问题

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-05T19:47:52.623

不，不是我听说过的。为了尽量减少代码转换的痛苦，你可以这样做：

```
var j$ = jQuery.noConflict(); 
```

然后，您可以将 jQuery`$`调用替换为`j$`. 您甚至可以使用简单的搜索/替换调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-05T19:51:09.523

```
( function($){
   // $('jquery here')
})(jQuery); 
```

函数内的所有 jquery 代码都可以使用`$`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-05T19:51:59.160

有一种简单的方法可以做到这一点，将你已经编写好的代码包装到一个函数中并将 jQuery 传递给它。这样你就可以保留你已经写好的代码，并且只使用 jQuery 作为新代码的标识符：

```
(my_old_stuff = function($){
   $.my_existing_function(){
       alert('i allready exist');
   };
)(jQuery);

jQuery.my_existing_function(); 
```

那应该行得通。

另一方面：用 jQuery 替换 $ 似乎并不是自动替换的任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-26T13:21:29.180

虽然这是一篇很老的帖子，但我确实遇到了同样的问题。有很多选项可以处理它。我不会碰预先编写的代码，让原型 js 使用 $。

来自[jQuery 文档](https://learn.jquery.com/using-jquery-core/avoid-conflicts-other-libraries/)

```
<!-- Loading jQuery before other libraries. -->
<script src="jquery.js"></script>
<script src="prototype.js"></script>
<script>

// Use full jQuery function name to reference jQuery.
jQuery( document ).ready(function() {
    jQuery( "div" ).hide();
});

// Use the $ variable as defined in prototype.js
window.onload = function() {
    var mainDiv = $( "main" );
};

</script> 
```

这是所有可用的选项。

[https://learn.jquery.com/using-jquery-core/avoid-conflicts-other-libraries/](https://learn.jquery.com/using-jquery-core/avoid-conflicts-other-libraries/)

# java - 会话中的弹簧存储对象

> ID：10034993
> 
> 赞同：40
> 
> 时间：2012-04-05T19:44:59.743
> 
> 标签：java, spring, servlets, spring-mvc

我想用 Spring 实现一个购物车，所以我需要`Cart`在会话中保存一个对象（具有 products、paymentType 和 deliveryType 等属性）。我尝试使用 bean 和属性“范围”设置为“会话”来创建它，但它不起作用，我应该在我的控制器或`Cart`类中使用一些额外的注释吗？任何示例用法都会非常有帮助:-) 在此先感谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-05T19:56:03.537

```
@Component
@Scope("session")
public class Cart { .. } 
```

进而

```
@Inject
private Cart cart; 
```

如果它在 Web 上下文中声明（dispatcher-servlet.xml），它应该可以工作。另一种选择是使用原始会话并将您的购物车对象放在那里：

```
@RequestMapping(..)
public String someControllerMethod(HttpSession session) {
    session.setAttribute(Constants.CART, new Cart());
    ...
    Cart cart = (Cart) session.getAttribute(Constants.CART);
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-05T20:12:13.100

如果您将购物车直接注入您的控制器，则可能会出现问题，因为您的控制器是单例范围的（默认情况下），它比您注入的 bean 范围更广。这篇出色的文章概述了您正在尝试做的四种方法：[http](http://richardchesterwood.blogspot.co.uk/2011/03/using-sessions-in-spring-mvc-including.html) ://richardchesterwood.blogspot.co.uk/2011/03/using-sessions-in-spring-mvc-include.html 。

以下是解决方案的快速摘要：

1.  将控制器范围限定为会话范围（`@scope("session")`在控制器级别上使用），并且控制器中只有一个购物车实例。
2.  将控制器范围限定为请求并注入会话范围的购物车。
3.  只需直接使用会话 - 有点混乱，IMO。
4.  使用 Spring 的注解`<aop:scoped-proxy/>`。

所有方法都有其优点和缺点。我通常选择选项 2 或 4。选项 4 实际上非常简单，并且是我见过[的 Spring 记录的唯一方法。](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/beans.html#beans-factory-scopes-other-injection)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-16T18:49:06.967

您只需要使用会话和代理模式添加 Scope 注释，如下所示

```
@Component
@Scope(value="session", proxyMode=ScopedProxyMode.TARGET_CLASS)
public class ShoppingCart implements Serializable{
} 
```

无论您需要在哪里使用购物车对象，都可以自动装配它

```
@Service
public class ShoppingCartServiceImpl implements ShoppingCartService {
    Logger logger = LoggerFactory.getLogger(ShoppingCartServiceImpl.class);

    @Autowired
    ShoppingCart shoppingCart;
} 
```

披露：我开发了一个示例项目，它使用 spring MVC、angularJS 和 bootstrap 来演示 Spring Session 范围 -
[https://github.com/dpaani/springmvc-shoppingcart-sample](https://github.com/dpaani/springmvc-shoppingcart-sample)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-04-29T00:40:01.190

尝试自动连接 HttpSession 和 spring 将注入 HttpSession 的代理 `@Autowired private HttpSession httpSession;`

# sql - SSRS - 如何获取列中一组 12 条记录的小计

> ID：10034994
> 
> 赞同：1
> 
> 时间：2012-04-05T19:45:02.397
> 
> 标签：sql, tsql, reporting-services, matrix, reporting

我是 SSRS 的新手。

我有一份报告应该显示 60 个月（显示 5 年，如 1999 年 1 月、1999 年 2 月等直到 60 个月结束）及其相应的销售额。我想获得前 12 个月（即第一年）的平均值，依此类推。是否可以？我的数据集只是逐行给了我所有 60 个月的数据。我正在为我的报告使用矩阵。

谢谢，用户 007。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-05T20:05:24.330

我会在矩阵中添加一些嵌套的行分组。更高级别的组将按年份排列，这将允许您在矩阵中拥有一行来汇总/平均该年度的所有数据。内部组将按月计算，在您的数据集返回它们时为您提供单独的月份行。

[以下是有关定义和使用组的一些信息](http://technet.microsoft.com/en-us/library/dd255263%28v=sql.105%29.aspx)

# combinators - FParsec 样式；证明组合器和单子风格之间的差异？

> ID：10034998
> 
> 赞同：2
> 
> 时间：2012-04-05T19:45:12.077
> 
> 标签：combinators, fparsec

我是 F# 的新手，大约两个月，我最近完成了[FParsec 教程](http://www.quanttec.com/fparsec/tutorial.html)并开始寻找更多示例。我读得越多，我就越困惑，然后我开始看到对样式的引用。我寻找更多样式并想出了这个列表。

*   组合器风格
*   单子风格
*   箭头样式
*   直接风格

有人可以列出所有样式并解释和演示每种样式如何解决常见问题，例如解析

```
“(abc 
  (b CDEF 
   (de 1 E) 
   (f 234)
  ) 
  (h 3) 
  (jkl H) 
 )” 
```

进入

```
[Lower "abc";
 Group[Lower "b"; Upper "CDEF"; 
  Group [Lower "de"; Number "1"; Upper "E"];
  Group [Lower "f"; Number "234"]]; 
 Group [Lower "h"; Number "3"];
 Group [Lower "jkl"; Upper "H"]
] 
```

使用

```
Type out = 
| Lower of string
| Upper of string
| Number of string
| Group of out list 
```

编辑

我从[FParsec 中的注释和基于分隔符的语法中选择了组合子和单子样式](https://stackoverflow.com/a/4252829/1243762)

直接样式始终显示为直接样式单子解析器

箭头样式出现在[Parsec: Direct Style Monadic Parser Combinators For The Real World](http://research.microsoft.com/pubs/65201/parsec-paper-letter.pdf)我还没有阅读所有这些。

编辑

根据建议

## 组合器风格

```
type out =
| Lower of string
| Upper of string
| Number of string
| Group of out list

type Parser = Parser<out, unit>

let isUpper = fun c -> isAsciiUpper c 
let upper : Parser = 
    many1Satisfy isUpper .>> ws 
    |>> fun x -> Upper(x)

let isLower = fun c -> isAsciiLower c 
let lower : Parser= 
    many1Satisfy isLower .>> ws
    |>> fun x -> Lower(x)

let isNumber = fun c -> isDigit c 
let number : Parser =
    many1Satisfy isNumber .>> ws
    |>> fun x -> Number(x)

let groupRef, groupImpl = createParserForwardedToRef()

let item : Parser = 
    lower <|> upper <|> number <|> groupRef

let items = 
    many item .>> ws 
    |>> fun x -> Group(x)

do groupImpl := between (pchar '(') (pchar ')') items .>> ws 

let test () =
    match run groupRef "(abc (b CDEF (de 1 E) (f 234)) (h 3) (jkl H) )" with
    | Success(result, _, _)   -> printf "Success: %A" result
    | Failure(errorMsg, _, _) -> printf "Failure: %s" errorMsg 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-16T01:17:46.353

## 单子风格

```
type out =
| Lower of string
| Upper of string
| Number of string
| Group of out list

type Parser = Parser<out, unit>

let isUpper = fun c -> isAsciiUpper c 
let upper : Parser =  parse {
    let! x = many1Satisfy isUpper 
    do! ws 
    return Upper(x)
    }

let isLower = fun c -> isAsciiLower c 
let lower = parse {
    let! x = many1Satisfy isLower
    do! ws 
    return Lower(x)
    }

let isNumber = fun c -> isDigit c 
let number = parse {
    let! x = many1Satisfy isNumber
    do! ws 
    return Number(x)
    }

let groupRef, groupImpl = createParserForwardedToRef()

let group =  parse {
    let! x = groupRef
    do! ws
    return x
    }

let item  = 
    lower <|> upper <|> number <|> group

let items = parse {
    let! x = many item   
    do! ws        
    return Group(x)
    }

do groupImpl := between (pchar '(') (pchar ')') items

let test () =
    match run group "(abc (b CDEF (de 1 E) (f 234)) (h 3) (jkl H) )" with
    | Success(result, _, _)   -> printf "Success: %A" result
    | Failure(errorMsg, _, _) -> printf "Failure: %s" errorMsg 
```