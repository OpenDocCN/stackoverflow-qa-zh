# StackOverflow 问答 11850000-11850999

# c++ - CORBA::String_var -> 我不能为这种类型的类字段分配任何值

> ID：11850002
> 
> 赞同：3
> 
> 时间：2012-08-07T16:13:31.057
> 
> 标签：c++, string, corba

我有一个简单的课程：

```
class MyExample : public POA_Example
{
   CORBA::String_var field;

   public:
             char* getField();
             void setField(const char* f);
};

char* MyExample::getField()
{
   return CORBA::string_dup(this->field.out());
}

void MyExample::setField(const char* f)
{
   this->field = CORBA::string_dup(f);
} 
```

和主要应用程序：

```
#include "MyExample.h"
#include <iostream>
using std::cout;

int main()
{
  MyExample e;
  e.setField("Hello");
  cout << e.getField() << "\n";
  return 0;
} 
```

我使用omniORB，我上面给出的代码没有显示任何内容......这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:20:06.717

试试这个，它对我有用：

```
interface Example
{
    string getString();
    void setString(in string s);
    long getLong();
    void setLong(in long l);

};

#include "example.hh"

class MyExample : public POA_Example
{
    private:

        CORBA::Long l;
        CORBA::String_var s;

    public:

        char* getString();
        void setString(const char* s);
        ::CORBA::Long getLong();
        void setLong(::CORBA::Long l);
};

#include "MyExample.h"

char* MyExample::getString(){
    return CORBA::string_dup(this->s.in());
}

void MyExample::setString(const char* s){
    this->s = CORBA::string_dup(s);
}

::CORBA::Long MyExample::getLong(){
    return this->l;
}

void MyExample::setLong(::CORBA::Long l){
    this->l = l;
}

#include "MyExample.h"
#include <omniORB4/CORBA.h>
#include <omniORB4/Naming.hh>
#include <iostream>
using std::cout;
using std::cerr;

int main(int argc, char **argv)
{
    MyExample me;

    me.setLong(1234654);
    cout << "Long: " << me.getLong() << "\n";

    me.setString("Hello");
    cout << "String: " << me.getString() << "\n";

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T00:00:43.473

如果您使用的是omniORB，您可能必须至少调用`orb_init()`字符串操作才能正常工作。否则，您拥有的代码似乎很好。

（尽管您不必调用`string_dup()`该`setField()`函数，因为`String_var`当您为其分配一个 时，该类会自动执行此操作`const char*`。）

（而且你通过调用`e.getField()`你的. 来泄漏内存`cout`。但这不应该阻止你看到一些东西。）

# gwt - scribe no source code is available 错误

> ID：11850004
> 
> 赞同：0
> 
> 时间：2012-08-07T16:13:36.610
> 
> 标签：gwt, scribe

我正在尝试将 Scribe 与 GWT 一起使用，但每当我切换到设计器视图时，我都会收到 scribe 错误：

> org.scribe.oauth.oauthService 类型没有可用的源代码；你忘了继承一个必需的模块吗？

我导入了 scribe jar 以及 commons 编解码器。

我还有其他几个类似的错误，有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:31:34.287

是什么`org.scribe.oauthService`？

如果您尝试使用[此类](https://github.com/fernandezpablo85/scribe-java/blob/master/src/main/java/org/scribe/oauth/OAuthService.java)，则适当的限定名称是：

```
org.scribe.oauth.OAuthService 
```

# maven - 在这个 Maven PHP 项目中组织和复制资源的最佳方式

> ID：11850007
> 
> 赞同：0
> 
> 时间：2012-08-07T16:13:39.743
> 
> 标签：maven

我正在考虑什么是组织和复制某些资源的最佳方式，我正在寻找一些关于什么是最佳方式的建议。

我正在开发一个 PHP 应用程序，我正在使用 maven 来管理项目（测试、依赖项、打包等）我正在使用一个外部库（代码点火器，一个 PHP MVC 框架），它通过提供最新的[稳定版本github](https://github.com/EllisLab/CodeIgniter/tree/2.1-stable)。（在这种情况下，我对 github 版本感兴趣，因为它包含一些尚未发布的修复程序，可供从网站下载。）

每次我编译/打包应用程序时，我想从 github 检索一个副本（或使用本地缓存的版本）。我对此进行了一些谷歌搜索，它似乎并不那么简单。我正在考虑在我的个人 Maven 存储库中为代码点火器创建一个 Maven 工件并将其添加为依赖项。虽然这是我开始怀疑这是否是最好的方法。

有关该项目的更多信息：

*   webroot 位于 src/main/webapp/
*   对于不使用 Maven 的开发人员，我可能决定将 webroot 的位置更改为更简单的位置，但是向开发人员了解 Maven 目录结构是可以接受的。
*   我想将自定义开发的 PHP 文件与 Code Igniter 文件分开（并在运行测试之前覆盖它们）。

在这种情况下，什么是好的 Maven 解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T10:24:27.770

首先，您应该问自己主要目标是什么。PHP 本身对战争文件一无所知，（正式使用的）apache httpd 也不了解它。PHP 更喜欢 PHAR 文件。您是使用 php-maven 还是尝试以自己的方式解决它？也许你应该在 php-maven 分享你的工作。[请参阅https://groups.google.com/forum/?fromgroups#!forum/maven-for-php](https://groups.google.com/forum/?fromgroups#!forum/maven-for-php)上的 google 组

您不应该尝试与 Maven 约定作斗争。所以实际上这是一个 maven 项目，源代码应该放在 src/main/webapp 或 src/main/php 或 src/main/resources （你可能知道）。引导 php 开发人员进入通用的 maven 文件结构并不难。由于 PHP 项目不是很直观（大多数框架都有自己的打包和文件布局），PHP 开发人员应该很好地学习“所有源代码都转到 src/main/php”。

所以要问你的问题：

1）您对代码点火器的描述实际上是在描述快照。Maven 很好地处理快照。所以剩下的唯一问题是：如何让它们自动导入。PHP-Maven alrweady 有一个 pear 项目的导入器、几个 web 下载，甚至 github 下载。我认为这个导入器可以很容易地从 github 下载快照构建。这只是如何通知更新版本（或查找它们的时间间隔）的问题。

2) 依赖管理在 PHP-Maven 中通过添加对 php 包含路径的依赖或将其提取到特定文件夹（或用户定义文件夹）来解决。应该足够灵活。

3）我不知道代码点火器本身。您正在寻找的解决方案取决于 code igniter 的行为是否类似于 zend 框架（一个可以轻松了解常见目录结构的简单库），还是它的行为类似于 flow3（仅适用于其自己的自定义目录结构）。因此，如果代码点火器位于一个非常不同的文件夹中（php-maven 中的 target/php-deps 或类似的文件夹）并且您的点火器 webapp 位于目标/类中是可以接受的，那么您应该始终从代码点火器文件中定义您的自定义文件。

# symfony - 如何在 symfony/twig 中创建一个将表单重置为 empty_value 的按钮？

> ID：11850009
> 
> 赞同：0
> 
> 时间：2012-08-07T16:13:48.490
> 
> 标签：symfony, twig

我有一个我正在创建的表单，`empty_value`每个选项都有一个。我想要一个默认为该选项的重置按钮。典型的表单重置按钮只会重置为最近的 POST 请求。有没有办法访问它`empty_value`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:39:41.413

不是最佳解决方案，因为它涉及页面重新加载，但为什么不让这个重置按钮重新加载页面（加载页面的 url，不带 post 参数）。这将为您提供一个包含所有空值的表单。

# internet-explorer - IE7位置：相对问题

> ID：11850012
> 
> 赞同：0
> 
> 时间：2012-08-07T16:13:55.937
> 
> 标签：internet-explorer, positioning

请使用 IE7查看[http://sources.freehosting.bg/home.html 。](http://sources.freehosting.bg/home.html)

您会注意到 position:relative 元素像这样向上移动： http: [//store.picbg.net/pubpic/CC/12/78f69fd1cdb4cc12.PNG](http://store.picbg.net/pubpic/CC/12/78f69fd1cdb4cc12.PNG)

有人可以帮我解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:57:15.853

我得到了它！

只需要添加位置：相对于已移动元素的父元素。

# java - 使用 Jackson 序列化和反序列化 Java 泛型：StackOverflowError

> ID：11850013
> 
> 赞同：0
> 
> 时间：2012-08-07T16:14:10.477
> 
> 标签：java, serialization, jackson, deserialization

我目前正在研究一个使用泛型并且有点复杂的模型。我知道已经回答了类似的问题，但没有一个明确回答我的问题。

这是我的模型：

```
@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = As.WRAPPER_OBJECT, property = "type")
@JsonSubTypes(
              { 
                  @Type(value = Cls2.class, name = "Cls2") 
              })
abstract class Cls1<T> implements Serializable
{
    private T myObj;

    public T getMyObj()
    {
        return myObj;
    }

    public Cls1(T obj)
    {
        myObj = obj;
    }
    @JsonTypeName("Cls2")
    public static class Cls2<E extends Int1> extends Cls1<E> implements Serializable
    {
        public Cls2()
        {
            super(null);
        }
    }
}

@JsonTypeName("ChildContainer")
class ChildContainer extends ParentContainer<OtherBean>
{

}

@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = As.WRAPPER_OBJECT, property = "type")
@JsonSubTypes(
              { 
                  @Type(value = ChildContainer.class, name = "ChildContainer") 
              })
class ParentContainer<T extends RootBean> implements Int1
{

}

@JsonTypeName("OtherBean")
class OtherBean extends RootBean
{

}

@JsonTypeName("RootBean")
class RootBean implements Int1
{

}

@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = As.WRAPPER_OBJECT, property = "type")
@JsonSubTypes(
              { 
                  @Type(value = RootBean.class, name = "RootBean"),
                  @Type(value = OtherBean.class, name = "OtherBean")
              })
interface Int1 extends Serializable
{

} 
```

我的目标是使用杰克逊进行序列化和反序列化，如下所示：

```
public static void main(String[] args) throws Exception
    {

        Cls2<ChildContainer> req = new Cls2<ChildContainer>();

        File file = new File("==some-file-path==");

        ObjectMapper mapper = new ObjectMapper();

        mapper.writeValue(file, req);

        //read it back using mapper.readValue(file, clazz) --Not sure about this
    } 
```

我在序列化过程中收到以下 java.lang.StackOverflowError ：

```
Exception in thread "main" java.lang.StackOverflowError
    at java.lang.Class.getDeclaringClass(Native Method)
    at org.codehaus.jackson.map.type.TypeBindings._resolveBindings(TypeBindings.java:290)
    at org.codehaus.jackson.map.type.TypeBindings._resolve(TypeBindings.java:221)
    at org.codehaus.jackson.map.type.TypeBindings.findType(TypeBindings.java:138)
    at org.codehaus.jackson.map.type.TypeFactory._fromVariable(TypeFactory.java:951)
    at org.codehaus.jackson.map.type.TypeFactory._constructType(TypeFactory.java:493)
    at org.codehaus.jackson.map.type.TypeFactory.findTypeParameters(TypeFactory.java:423)
    at org.codehaus.jackson.map.type.TypeFactory.findTypeParameters(TypeFactory.java:395)
    at org.codehaus.jackson.map.type.TypeBindings._resolveBindings(TypeBindings.java:299)
    at org.codehaus.jackson.map.type.TypeBindings._resolveBindings(TypeBindings.java:290)
    at org.codehaus.jackson.map.type.TypeBindings._resolve(TypeBindings.java:221)
    at org.codehaus.jackson.map.type.TypeBindings.findType(TypeBindings.java:138)
    at org.codehaus.jackson.map.type.TypeFactory._fromVariable(TypeFactory.java:951)
    at org.codehaus.jackson.map.type.TypeFactory._constructType(TypeFactory.java:493)
    at org.codehaus.jackson.map.type.TypeFactory.findTypeParameters(TypeFactory.java:423)
    at org.codehaus.jackson.map.type.TypeFactory.findTypeParameters(TypeFactory.java:395)
    at org.codehaus.jackson.map.type.TypeBindings._resolveBindings(TypeBindings.java:299)
    at org.codehaus.jackson.map.type.TypeBindings._resolveBindings(TypeBindings.java:290) 
```

任何帮助都深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:56:00.300

堆栈跟踪表明类型解析中的无限递归`Cls2`扩展了它本身嵌套的类。这似乎是杰克逊的一个极端案例错误（[报告它](http://jira.codehaus.org/browse/JACKSON)！）。同时，提取`Cls2`到一个独立的类而不是嵌套在它的超类中应该可以解决这个问题。

# php - 为什么 php 不适用于我的表单？

> ID：11850019
> 
> 赞同：0
> 
> 时间：2012-08-07T16:14:29.790
> 
> 标签：php, html, forms, validation

在向我的公司发送电子邮件之前，我一直在尝试验证此表单。它不会验证表单，它只会在有人点击提交时发送。没有验证发生，我不知道该怎么做。

这是表格的一小部分

```
<tr>
<td><label for="reason3">Reason for Leaving?</label></td>
<td><input type="text" id="reason3" name="reason3" class="c3"></td>
</tr>
<tr>
<td colspan="2">
<hr size="1.5" color="#000000" noshade></td>
</tr>
<tr>
<td><label for="maywe">May we contact the employers listed above?<br>
If not, indicate which you do not wish us to contact:</label></td>
<td><input type="text" id="maywe" name="maywe" class="c3"></td>
</tr>
<tr>
<td><label for="additional">Any additonal information you would like us to<br>
consider when reviewing your application?</label></td>
<td><input type="text" id="additional" name="additional" class="c3"></td>
</tr>
<tr>
<td colspan="2">
<hr size="1.5" color="#000000" noshade></td>
</tr>
<tr>
<td colspan="2">
<div class="c2">
<hr size="1.5" color="#000000" noshade>
        The above information is true and complete to the best of my knowledge. Should I become<br>
employed by <a href="http://www.creativeurethanes.com/">Creative Urethanes, Inc.,</a> any false statements on this application may be<br>
considered sufficient cause for dismissal.<br>
        I understand that filling out this application does not indicate that there are necessarily any<br>
vacant positions at this time, nor does it in any way obligate this Company.<br>
        I acknowledge that I have read Creative Urethanes' <a href="Memo.html">Memo on Right to Know</a>. <input type="checkbox" name="Yes" value="Yes"><span class="c1"><sup><i>*</i></sup></span><br>
<br></div>
</td>
</tr>
<tr>
<td colspan="2">
<hr size="1.5" color="#000000" noshade></td>
</tr>
<tr>
<td colspan="2">Sign electronically with your full name and SSN.</td>
</tr>
<tr>
<td><label for="electronicsignfn"><u>Full</u> <u>Name</u><span class="c1"><sup><i>*</i></sup></span></label></td>
<td><input type="text" id="electronicsignfn" name="electonicsignfn" class="c3"></td>
</tr>
<tr>
<td><label for="electronicsignssn"><u>S.S.N.</u><span class="c1"><sup><i>*</i></sup></span></label></td>
<td><input type="text" id="electronicsignssn" name="electronicsignssn" class="c3"></td>
</tr>
<tr>
<td><label for="emailaddress"><u>Email</u> <u>Address</u><span class="c1"><sup><i>*</i></sup></span></label></td>
<td><input type="text" id="emailaddress" name="emailaddress"></td>
</tr>
<tr>
<td colspan="2">
<hr size="1.5" color="#000000" noshade></td>
</tr>
<tr>
<td><input type="submit" id="field89" name="field89" class="c3" value="Submit"></td>
<td><input type="reset" id="field90" name="field90" class="c3" value="Reset"></td>
</tr>
</table>
</form>
</body>
</html> 
```

这是php

```
<?php
if ($_POST['submitted']==1) {
$errormsg = "";
if ($_POST[first_name]){
$first_name = $_POST[first_name];
}
else{
$errormsg = "Please enter your first name";
}
if ($_POST[last_name]){
$last_name = $_POST[last_name];
}
else{
$errormsg = "Please enter your last name";
}
if ($_POST[ssn]){
$ssn = $_POST[ssn];
}
else{
$errormsg = "Please enter your Social Security Number";
}
if ($_POST[phone]){
$phone = $_POST[phone];
}
else{
$errormsg = "Please enter your phone number";
}
if ($_POST[address]){
$address = $_POST[address];
}
else{
$errormsg = "Please enter your address";
}
if ($_POST[city]){
$city = $_POST[city];
}
else{
$errormsg = "Please enter your city";
}
if ($_POST[state]){
$state = $_POST[state];
}
else{
$errormsg = "Please select your state";
}
if ($_POST[zip]){
$zip = $_POST[zip];
}
else{
$errormsg = "Please enter your 5 digit zip code";
}
if ($_POST[position]){
$position = $_POST[position];
}
else{
$errormsg = "Please enter N/A if open for discussion";
}
if ($_POST[wage]){
$wage = $_POST[wage];
}
else{
$errormsg = "Please enter 0.00 if open for discussion";
}
if ($_POST[Emergencycontactname]){
$Emergencycontactname = $_POST[Emergencycontactname];
}
else{
$errormsg = "Please enter your emergency contact's name";
}
if ($_POST[Emergencycontactaddress]){
$Emergencycontactaddress = $_POST[address];
}
else{
$errormsg = "Please enter your emergency contact's address";
}
if ($_POST[Emergencycontactcity]){
$Emergencycontactcity = $_POST[Emergencycontactcity];
}
else{
$errormsg = "Please enter your emergency contact's city";
}
if ($_POST[Emergencycontactstate]){
$Emergencycontactstate = $_POST[Emergencycontactstate];
}
else{
$errormsg = "Please select your Emergency contact's state";
}
if ($_POST[Emergencycontactzip]){
$Emergencycontactzip = $_POST[Emergencycontactzip];
}
else{
$errormsg = "Please enter your emergency contact's 5 digit zip code";
}
if ($_POST[Emergencycontactphone]){
$Emergencycontactphone = $_POST[Emergencycontactphone];
}
else{
$errormsg = "Please enter your emergency contact's phone number";
}
if ($_POST[hightest]){
$highest = $_POST[highest];
}
else{
$errormsg = "Please enter your highest level of education";
}
if ($_POST[degree]){
$degree = $_POST[degree];
}
else{
$errormsg = "Please enter N/A if none";
}
if ($_POST[age]){
$age = $_POST[age];
}
else{
$errormsg = "Please enter yes or no";
}
if ($_POST[problems]){
$problems = $_POST[problems];
}
else{
$errormsg = "Please enter yes or no";
}
if ($_POST[shiftwork]){
$shiftwork = $_POST[shiftwork];
}
else{
$errormsg = "Please enter yes or no";
}
if ($_POST[apprenticeship]){
$apprenticeship = $_POST[apprenticeship];
}
else{
$errormsg = "Please enter yes or no";
}
if ($_POST[disabilities]){
$disabilities = $_POST[disabilities];
}
else{
$errormsg = "Please enter yes or no";
}
if ($_POST[ifyes]){
$ifyes = $_POST[ifyes];
}
else{
$errormsg = "if you answered no to above question, put N/A";
}
if ($_POST[accommodate]){
$accommodate = $_POST[accommodate];
}
else{
$errormsg = "if you answered N/A to above question, put N/A";
}
if ($_POST[experience]){
$experience = $_POST[experience];
}
else{
$errormsg = "Please enter yes or no";
}
if ($_POST[ifyes2]){
$ifyes2 = $_POST[ifyes2];
}
else{
$errormsg = "if you answered no to above question, put N/A";
}
if ($_POST[cname]){
$cname = $_POST[cname];
}
else{
$errormsg = "Please enter company name";
}
if ($_POST[caddress]){
$caddress = $_POST[caddress];
}
else{
$errormsg = "Please enter company address";
}
if ($_POST[cphone]){
$cphone = $_POST[cphone];
}
else{
$errormsg = "Please enter company phone number";
}
if ($_POST[ccperson]){
$ccperson = $_POST[ccperson];
}
else{
$errormsg = "Please enter contact person's name";
}
if ($_POST[ctype]){
$ctype = $_POST[ctype];
}
else{
$errormsg = "Please enter type of work";
}
if ($_POST[cwage]){
$cwage = $_POST[cwage];
}
else{
$errormsg = "Please enter wage earned";
}
if ($_POST[cstart]){
$cstart = $_POST[cstart];
}
else{
$errormsg = "Please enter date started";
}
if ($_POST[cend]){
$cend = $_POST[cend];
}
else{
$errormsg = "Please enter date ended";
}
if ($_POST[creason]){
$creason = $_POST[creason];
}
else{
$errormsg = "Please enter reason for leaving";
}
if ($_POST[cname2]){
$cname2 = $_POST[cname2];
}
else{
$errormsg = "Please enter company name, or type N/A";
}
if ($_POST[caddress2]){
$caddress2 = $_POST[caddress2];
}
else{
$errormsg = "Please enter company address, or type N/A";
}
if ($_POST[cphone2]){
$cphone2 = $_POST[cphone2];
}
else{
$errormsg = "Please enter company phone number, or type N/A";
}
if ($_POST[ccperson2]){
$ccperson2 = $_POST[ccperson2];
}
else{
$errormsg = "Please enter contact person's name, or type N/A";
}
if ($_POST[ctype2]){
$ctype2 = $_POST[ctype2];
}
else{
$errormsg = "Please enter type of work, or type N/A";
}
if ($_POST[cwage2]){
$cwage2 = $_POST[cwage2];
}
else{
$errormsg = "Please enter wage earned, or type N/A";
}
if ($_POST[cstart2]){
$cstart2 = $_POST[cstart2];
}
else{
$errormsg = "Please enter date started, or type N/A";
}
if ($_POST[cend2]){
$cend2 = $_POST[cend2];
}
else{
$errormsg = "Please enter date ended, or type N/A";
}
if ($_POST[creason2]){
$creason2 = $_POST[creason2];
}
else{
$errormsg = "Please enter reason for leaving, or type N/A";
}
if ($_POST[cname3]){
$cname3 = $_POST[cname3];
}
else{
$errormsg = "Please enter company name, or type N/A";
}
if ($_POST[caddress3]){
$caddress3 = $_POST[caddress3];
}
else{
$errormsg = "Please enter company address, or type N/A";
}
if ($_POST[cphone3]){
$cphone3 = $_POST[cphone3];
}
else{
$errormsg = "Please enter company phone number, or type N/A";
}
if ($_POST[ccperson3]){
$ccperson3 = $_POST[ccperson3];
}
else{
$errormsg = "Please enter contact person's name, or type N/A";
}
if ($_POST[ctype3]){
$ctype3 = $_POST[ctype3];
}
else{
$errormsg = "Please enter type of work, or type N/A";
}
if ($_POST[cwage3]){
$cwage3 = $_POST[cwage3];
}
else{
$errormsg = "Please enter wage earned, or type N/A";
}
if ($_POST[cstart3]){
$cstart3 = $_POST[cstart3];
}
else{
$errormsg = "Please enter date started, or type N/A";
}
if ($_POST[cend3]){
$cend3 = $_POST[cend3];
}
else{
$errormsg = "Please enter date ended, or type N/A";
}
if ($_POST[creason3]){
$creason3 = $_POST[creason3];
}
else{
$errormsg = "Please enter reason for leaving, or type N/A";
}
if ($_POST[maywe]){
$maywe = $_POST[maywe];
}
else{
$errormsg = "Type names of companies you do not want us to contact, or type, ok all";
}
if ($_POST[additional]){
$additional = $_POST[additional];
}
else{
$errormsg = "Type N/A if you do not have any additional information";
}
if ($_POST[electronicsignfn]){
$electronicsignfn = $_POST[electronicsignfn];
## Heading ##    }
else{
$errormsg = "Please enter your full name";
}
if ($_POST[electronicsignssn]){
$electronicsignssn = $_POST[electronicsignssn];
}
else{
$errormsg = "Please enter your Social Security Number";
}
if ($_POST[emailaddress]){
$emailaddress = $_POST[emailaddress];
}
else{
$errormsg = "Please enter your email address";
}
else{
if ($errormsg){ //if there is already an error, add next error
$errormsg = $errormsg;
}else{
}
}
}
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:31:12.233

为了让您的 PHP 读取表单数据，需要做一些事情。首先，正如 Waygood 建议的那样，最好将您的 $_POST 值更改为在传递的变量名称周围加上单引号。

```
//For example:
$_POST[address]; 

// Should change to:
$_POST['address']; //Notice the single quotes around the word address 
```

**其次，正如约翰回答的那样，在您的html 表单**中没有引用传递的**提交**值，您需要在表单中添加一个隐藏的输入（标签之间的任何位置），该输入包含 1 的值来制作您的第一条语句true 以便执行其余的 php 代码。

 **```
<!-- Put this input tag anywhere between your opening and closing form tags in your html -->
<form method="POST" action="your_submission_page.php">
    <input type="hidden" name="submitted" value="1" />
</form> 
```

最后，最好**将**表单中的所有错误通知用户，这样他们就不会在提交表单之前遇到一个又一个错误。您应该做的是构建一个动态的错误消息数组，检查是否有任何错误，然后将它们全部显示出来。

```
<?php
    // Create a dynamic array for the error messages and validate everything before sending them back to the form that shows them

    // Here is a sample of your code with the dynamic array built in
    $error_msgs = array ();   
    $error = 0; //Error flag     

    if ($_POST['cwage2']){
        $cwage2 = $_POST['cwage2'];
    } else {
        $error_msgs[] = "Please enter wage earned, or type N/A";
        $errors++; //Flag to let the code know that there are errors, used in every case
    }

    if ($_POST['cstart2']){
        $cstart2 = $_POST['cstart2'];
    } else {
        $error_msgs[] = "Please enter date started, or type N/A";
        $errors++; //Flag to let the code know that there are errors, used in every case
    }

    // Finally at the end, check to see if there are any errors and display them all
    if ($errors > 0) {
        //Display the amount of errors first
        echo "There were " . $errors . " errors in your submission, please correct them.<br/>";

        //Then display your error array
        foreach ($error_msgs as &$msg) {                
            echo $msg . "<br/>"; 
        }
    } else {
        // Add code here to submit the form however you'd like

    }

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T16:16:47.920

我没有看到名为的表单字段`submitted`，如果没有它，您的 PHP 验证代码将不会被触发。尝试改变：

```
if ($_POST['submitted']==1) { 
```

像这样更通用的东西：

```
if ('POST' === $_SERVER['REQUEST_METHOD']) { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T16:19:56.847

好的@KibaHeitfield

更改对数组元素的引用：

```
$_POST[first_name] 
```

到：

```
$_POST['first_name'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T16:56:24.460

1.  没有 if 跟随 else

    else{ if ($errormsg){ //如果已经有错误，添加下一个错误 $errormsg = $errormsg; }别的{

    ```
    } 
    ```

    }

2.  $错误消息 = $错误消息；没有任何意义。

3.  Errormsg 已分配但从未使用过。使用 echo $errormsg;
4.  $_POST[first_name] 应该是 $_POST['first_name']
5.  而不是 $_POST['submitted'] 使用 if($_POST['field89'] == 'Submit')
6.  你为什么不尝试一个小表格并在它开始工作时展开。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T16:18:56.263

或者你可以简单地检查这种方式

```
if($_POST){
 //form is posted do your work here
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-07T16:26:46.443

您似乎无法显示错误。尝试将此添加到您的 php 代码的脚下：

```
echo $errormsg; die(); 
```

代替

```
$errormsg = $errormsg; 
```

让我们知道会发生什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-07T16:37:37.997

您是否提供了表单的方法（“GET”、“POST”）？**

# php - preg_match() 或用于检查货币的类似函数

> ID：11850022
> 
> 赞同：0
> 
> 时间：2012-08-07T16:14:49.340
> 
> 标签：php, regex, syntax, preg-match

```
1.449,00
1.000.000,55
19,90
etc
etc 
```

我知道我上面列出的内容非常多变，但存在货币的可能性。我正在寻找一个`preg_match()`示例或任何其他功能来处理上述可能的情况。我尝试了下面的示例，但它无法正常工作。有没有机会给我一个最合适的模式呢？

```
if (! preg_match('/^[0-9.,]$/', $currency)) { echo 'No good.'; } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T16:23:24.577

像这样的东西应该工作：

```
/^((?:\d{1,3}[,\.]?)+\d*)$/ 
```

这匹配：

```
^         - Start of string
(         - Capture the following:
 (?:      
  \d{1,3} - One to three digits
  [,\.]?  - And an optional separator (comma or period)
 )+       - One or more times
 \d*      - Zero or more digits
)
$         - End of string 
```

它通过迭代匹配分隔符左侧的所有内容（如果存在）来工作，然后必须`\d*`选择任何可选的货币分数。

您可以看到它通过[了所有测试](http://regexr.com?31ovb)。

**编辑：**更新的正则表达式如下所示：

```
^((?:\d\.\d{3}\.|\d{1,3}\.)?\d{1,3},\d{1,2})$ 
```

我们匹配的地方：

*   `\d\.\d{3}\.`- 一位数字、句号、三位数字、句号或
*   `\d{1,3}\.`- 一位和三位数字，句号
*   以上都不是（因为`?`）

然后，我们匹配：

*   `\d{1,3},`- 一到三位数字和一个逗号，后跟
*   `\d{1,2}` - 一位或两位数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:16:37.577

`+`在之后添加`]`以允许多个字符。

# php - 亚马逊 MWS PHP-API 访问和打印装箱单

> ID：11850023
> 
> 赞同：0
> 
> 时间：2012-08-07T16:14:49.717
> 
> 标签：php, amazon-mws

如何使用带有 PHP 的亚马逊 MWS 访问和打印装箱单？过程是什么，如果可能，步骤是什么？例子会很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T23:15:55.163

因为您在谈论 MWS 和“装箱单”，所以我假设以下内容是正确的：

*   你是亚马逊卖家
*   您自己发送包裹（MFN / 商家履行），而不是使用 AFN / FBA（亚马逊履行）

要创建装箱单，您大致必须执行以下操作：

1.  从亚马逊 MWS 服务器获取“订单报告”。返回的 XML 将包含您所有未完成订单的详细信息，包括：送货地址、数量、SKU 和产品名称。
2.  通过“OrderAcknowledgment”API 调用确认收到这些订单
3.  使用上述数据创建漂亮的 HTML 文件、图像、PDF 文件或任何其他可以打印为装箱单的文件

当您使用它时，您可能想查看“OrderFulfillment”调用。这让亚马逊知道您实际上已经发货。您链接的示例 PHP 代码应该可以帮助您完成第 1 步和第 2 步。

（供将来参考：可在[https://developer.amazonservices.com/](https://developer.amazonservices.com/)获得 PHP、C# 和 Java 中的示例客户端代码。按照 API 文档链接获取当前版本）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:44:12.267

由于使用了装箱单，我对您的问题感到有些困惑。

亚马逊提供标签，但标签用于区分同一 SKU 的多个卖家，其本身并不是装箱单。为 AFN 订单下订单时，亚马逊会生成自己的装箱单，然后通过您自己的流程将 MFN 订单发送给您进行处理。

但是，假设您正在寻找亚马逊标签，我快速浏览了所有 API，并没有看到任何关于打印它们的信息。据我所知，这只能通过卖家中心获得，但是如果有任何 API 具有该功能，它将是提要 API。

我建议在[https://sellercentral.amazon.com/forums/forum.jspa?forumID=35](https://sellercentral.amazon.com/forums/forum.jspa?forumID=35)上创建一个帐户并询问那里的人 - 几个亚马逊员工的监控论坛和 Oneida Books 是常驻大师，几乎可以回答任何与 API 相关的东西。

# angularjs - 从服务器获取数据的推荐方式

> ID：11850025
> 
> 赞同：145
> 
> 时间：2012-08-07T16:14:57.217
> 
> 标签：angularjs

在 AngularJS 中不使用`$resource`.

有`$resource`很多限制，例如：

1.  没有使用正确的期货
2.  不够灵活

* * *

## 回答 #1

> 赞同：230
> 
> 时间：2012-08-07T16:14:57.217

在某些情况下，与后端交谈时 $resource 可能不合适。这显示了如何在不使用资源的情况下设置类似 $resource 的行为。

```
angular.module('myApp').factory('Book', function($http) {
  // Book is a class which we can use for retrieving and 
  // updating data on the server
  var Book = function(data) {
    angular.extend(this, data);
  }

  // a static method to retrieve Book by ID
  Book.get = function(id) {
    return $http.get('/Book/' + id).then(function(response) {
      return new Book(response.data);
    });
  };

  // an instance method to create a new Book
  Book.prototype.create = function() {
    var book = this;
    return $http.post('/Book/', book).then(function(response) {
      book.id = response.data.id;
      return book;
    });
  }

  return Book;
}); 
```

然后在您的控制器中，您可以：

```
var AppController = function(Book) {
  // to create a Book
  var book = new Book();
  book.name = 'AngularJS in nutshell';
  book.create();

  // to retrieve a book
  var bookPromise = Book.get(123);
  bookPromise.then(function(b) {
    book = b;
  });
}; 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-03-04T02:38:39.620

我建议您使用[$resource](http://docs.angularjs.org/api/ngResource.%24resource)。

它可能会在 Angularjs 的下一个版本中支持（url 覆盖）。然后，您将能够像这样编写代码：

```
// need to register as a serviceName
$resource('/user/:userId', {userId:'@id'}, {
    'customActionName':    {
        url:'/user/someURI'
        method:'GET',
        params: {
            param1: '....',
            param2: '....',
        }
    },
     ....
}); 
```

并且返回回调可以像这样在 ctrl 范围内处理。

```
// ctrl scope
serviceName.customActionName ({
    paramName:'param',
    ...
}, 
function (resp) {
    //handle return callback
}, 
function (error) {
    //handler error callback
}); 
```

可能您可以处理更高抽象级别的代码。

# jquery - 使用 jQuery UI 成功删除可放置的功能

> ID：11850026
> 
> 赞同：5
> 
> 时间：2012-08-07T16:14:57.677
> 
> 标签：jquery, jquery-ui

我有以下代码，它允许您在页面上拖放元素，并在成功拖放时运行一个名为 saveRatings 的方法，传递元素的 id。

```
 $('.draggable').draggable({
                revert: true
            });

            $('.droppable').droppable({
                drop: function( event, ui ) {
                    draggedID = ui.draggable.attr("id");
                    droppedID = $(this).attr("id");
                    Global.showLoader('Saving...');
                    quiz1.saveRatings(draggedID, droppedID);
                }
            }); 
```

计划是，一旦成功放置，它将删除拖动的项目并从放置的元素中删除可放置类，以防止其他元素也被放置在那里：

```
saveRatings: function ( choiceId, ratingId ) {

                // Hide the dragged choice
                $('div#' + choiceId).hide();

                // Remove droppable behaviour
                $('div#' + ratingId).removeClass('ui-droppable');
                $('div#' + ratingId).removeClass('droppable');
                $('div#' + ratingId).addClass('done');

} 
```

删除部分与删除类一样工作正常，但元素仍然允许将其他元素放在其上......即使我已经从元素中删除了 droppable 和 ui-droppable 类......

任何想法为什么这不起作用？由于完整的代码库相当大（但不会直接影响这一点），我无法展示小提琴，但上面的示例应该足以解释这个问题，希望有一个解决方案。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-07T16:18:38.787

使用`disable`：

```
$('#' + ratingId).droppable('disable') 
```

此外，您无需`'div#'`在按 ID 选择时指定，因为 ID 是唯一的。

[演示](http://jsfiddle.net/NXDhE/)（使用破坏）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-18T11:10:25.777

您可以使用：

```
$('#' + ratingId).droppable('destroy') 
```

这将从元素中永久删除可放置行为。如果要重新初始化它，只需使用与第一次初始化时相同的初始化代码再次使元素可放置。

有关更多信息，请参阅文档：[http ://api.jqueryui.com/droppable/#method-destroy](http://api.jqueryui.com/droppable/#method-destroy)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-29T05:32:32.980

已接受答案中的解决方案破坏了 droppaple，这意味着它似乎只是禁用了它。但是，如果您这样做，您以后将无法再次启用它。根据[文档](http://docs.jquery.com/UI/API/1.8/Droppable#options)，在不破坏元素的情况下执行此操作的正确方法是：

```
//Get or set the disabled option, after init.
//getter
var disabled = $( ".selector" ).droppable( "option", "disabled" );
//setter
$( ".selector" ).droppable( "option", "disabled", true ); 
```

# callstack - 向缓冲区注入恶意代码后如何维护运行时堆栈？

> ID：11850028
> 
> 赞同：1
> 
> 时间：2012-08-07T16:14:57.787
> 
> 标签：callstack, buffer-overflow

我正在阅读以下关于缓冲区溢出的论文： [http ://www1.telhai.ac.il/sources/private/academic/cs/557/2659/Materials/Smashing.pdf](http://www1.telhai.ac.il/sources/private/academic/cs/557/2659/Materials/Smashing.pdf)

根据论文中的例子，攻击者将代码注入溢出的缓冲区，并修改返回地址指向缓冲区的地址。由于注入的代码和局部变量都位于堆栈上，攻击者不应该确保她/他在代码溢出缓冲区之前为局部变量留出足够的空间吗？从广义上讲，我很困惑当代码和局部变量都在堆栈上时如何维护堆栈......是否有局部变量覆盖注入代码的机会？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:38:01.987

一种解决方案是不使用任何局部变量。这不一定是对小代码的大约束，无论如何都要调用其他东西来完成它的工作。（非常相对地说它不是一个很大的限制，它超出了我的范围，但由于这不是最容易编写的代码，因此在这种情况下它不是一个很大的限制）。

但这甚至没有必要。堆栈看起来像：

```
Function A Arg 2
Function A Arg 1
Function A Arg 0
Return Address into caller
Function A Local 1
Function A Local 0
Function B Arg 1
Function B Arg 0
Return Address into place in Function A's executable code.
Function B Local 2
Function B Local 1
Function B Local 0
Function C Arg 0
Return Address into place in Function B's executable code.
Function C Local 3
Function C Local 2
Function C Local 1
Function C Local 0
... 
```

缓冲区溢出使其看起来像：

```
Function A Arg 2
Function A Arg 1
Function A Arg 0
Return Address into caller
Function A Local 1
NastyCode bytes 0-3
NastyCode bytes 4-7
NastyCode bytes 8-B
NastyCode bytes C-E
NastyCode bytes F-10
NastyCode bytes 10-13
NastyCode bytes 14-17
NastyCode bytes 18-1B
NastyCode bytes 1F-20
...
NastyCode arg 0 (etc.)
Return Address (of NastyCode [may not even be valid, may return to original caller, or may jump into something it'll set up]).
NastyCode Local 2
NastyCode Local 1
NastyCode Local 0
Return Address (should be of Function F, into a point in Function E but it's changed to point to byte 0 of NastyCode)
Function F Local 2
Function F Local 1
Function F Local 0 
```

因此写入堆栈的可执行代码可以远离该代码的本地变量。

# regex - grep 正则表达式在两个已知字符串之间拉出一个字符串

> ID：11850031
> 
> 赞同：1
> 
> 时间：2012-08-07T16:15:12.493
> 
> 标签：regex, linux, grep

我正在解析的文件中有一串文本，我几乎明白了，但不确定我错过了什么

我使用的基本表达式是

```
cat cred.txt | grep -m 1 -o '&CD=[^&]*' 
```

我得到的结果

```
&CD=u8AA-RaF-97gc_SdZ0J74gc_SdZ0J196gc_SdZ0J211 
```

我**不想要结果字符串中的`&CD=`部分**，我该怎么做。

我解析的字符串是：

```
webpage.asp?UserName=username&CD=u8AA-RaF-97gc_SdZ0J74gc_SdZ0J196gc_SdZ0J211&Country=USA 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:20:04.827

如果你`grep`知道 Perl 正则表达式：

```
grep -m 1 -oP '(?<=&CD=)[^&]*' cred.txt 
```

如果不：

```
sed '1s/.*&CD=\([^&]*\).*/\1/' cred.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:37:38.340

给这只猫剥皮的方法很多。

扩展你的管道：

```
grep -o 'CD=[^&]*' cred.txt | cut -d= -f2 
```

或者在 sed 中进行替换：

```
sed -r 's/.*[&?]CD=([^&]*).*/\1/' cred.txt 
```

或者变得非常花哨并在 awk 中解析实际的 QUERY_STRING：

```
awk -F'?' '{ split($2, a, "&"); for(i in a){split(a[i], kv, "="); out[kv[1]]=kv[2];} print out["CD"];}' 
```

# regex - Vim 正则表达式替换

> ID：11850033
> 
> 赞同：22
> 
> 时间：2012-08-07T16:15:22.253
> 
> 标签：regex, vim

我认为这是一个非常简单的解决方案，但我一直试图找到大约一个小时的答案，但似乎无法弄清楚。

我正在尝试在 Vim 中进行查找/替换，它将替换一系列以四位数字开头`103`并后跟`123`相同四位数字的数字，如下所示：

`1033303`-> `1233303`
`1033213`->`1233213`

我最接近的是：

```
%s/103\d\{4}/123\0/g 
```

但是，这会导致整个数字与 匹配`\0`，如下所示：

`1033303`->`1231033303`

非常感谢您的帮助

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-07T16:16:59.930

你很亲密

```
%s/103\(\d\{4}\)/123\1/g 
```

`\(`和之间的模式是一个子匹配，`\)`可以按出现顺序等访问。有关更多信息，请参阅。`\1``\2``:help \(`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-07T16:44:50.343

现在没有捕获组！

```
:%s/103\ze\d\{4}/123/g 
```

`\ze`将在那里设置比赛的结束。这允许您匹配整个模式，但只对其中的一部分进行替换。

```
:h /\ze
:h /\zs 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-07T16:17:50.040

使用捕获组：

```
%s/103\(\d\{4}\)/123\1/g 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T16:18:47.497

试试这个：

```
%s#103\(\d\{4}\)#123\1#g 
```

# android - 如何测量 Android webview 对象上的页面内容长度？

> ID：11850038
> 
> 赞同：1
> 
> 时间：2012-08-07T16:15:43.177
> 
> 标签：android, webview, measure

我想加载 url 以在我的应用程序中嵌入 webview，并测量 webview 上的下载字节大小。任何人都可以告诉我如何在从嵌入式 webview 下载之前获取页面大小。如何测量页面内容长度字节大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:25:33.377

有关如何查找下载大小的信息，请参阅[此答案。](https://stackoverflow.com/a/2983420/790439)`Content-length`但还要注意，如果您加载网页，则无法准确测量此大小，因为该页面可能包含 css、javascript 和/或图像，只有在您知道它们的 url 后才能找到它们的大小。这意味着您必须解析网页，这意味着您必须先下载它。

# jquery - 从 id 和类 jquery 中选择 div

> ID：11850040
> 
> 赞同：0
> 
> 时间：2012-08-07T16:15:53.413
> 
> 标签：jquery, class, html, show

我有这个结构：

```
<div id="list_articles">
  <div id="article">
    <label>Select:</label><input type="checkbox" class="checked_art" id="1001" />
    <div id="hide" style="display:none;" class="1001">
      //Code here...
    /div>
  </div>
  <div id="article">
    <label>Select:</label><input type="checkbox" class="checked_art" id="1002" />
    <div id="hide" style="display:none;" class="1002">
      //Code here...
    /div>
  </div>
</div> 
```

我想要做的是，当我选中我的复选框时，根据复选框的 id 获取“隐藏”，例如：如果我选中这个：

```
<input type="checkbox" class="checked_art" id="1001" /> 
```

我想删除的样式

```
<div id="hide" style="display:none;" class="1001"> 
```

我一直在用 Jquery 尝试这种方式：

```
$(".checked_art").live('click',function()
{
   var id = $(this).attr('id');
   var checked = $(this).attr('checked');
   var a = "#hide ."+id;
   if(checked == 'checked')
   {
    $(a).show();
   }
   else
   {
    $(a).hide();
   }
} 
```

但它只适用于第一个元素，我希望它对所有元素都这样做，有什么帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:18:35.573

```
$(".checked_art").click(function(){
    $(this).next().toggle();
}); 
```

顺便说一句，ID 必须是唯一的。

**[jsFiddle 示例](http://jsfiddle.net/j08691/UhsGB/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:21:57.067

首先，`.live()`已被弃用。如果您使用的是最新版本的 jQuery，您应该使用`.on()`：

```
$(document).on("click", ".checked_art", function() {
     // ...
}); 
```

此外，ID 必须是唯一的。因此，您应该更改使“隐藏”标识符成为`class`属性而不是`id`属性。

此外，您的`id`和`class`属性应该以字母开头，而不是数字。您可以通过为每个以数字开头的属性加上公共字符串（例如“e”）来解决此问题。例如，您可以将“1001”更改为“e1001”。

无论如何，您的问题是 和 之间的`id`空间`class`。这个：

```
var a = "#hide ."+id; 
```

应该是这样的：

```
var a = ".hide."+id; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:21:19.703

首先，将此行更改为使用 class 而不是 id：

```
<div style="display:none;" class="1001 hide"> 
```

然后，更改您的函数以使用类`.hide`而不是 id`#hide`并删除选择器`.hide`和`.1001`选择器之间的空格（表示在同一级别上）

```
$(".checked_art").on('click',function()
{
   var id = $(this).attr('id');
   var checked = $(this).attr('checked');
   var a = ".hide."+id;
   if(checked == 'checked')
   {
    $(a).show();
   }
   else
   {
    $(a).hide();
   }
} 
```

但是，更简单的代码将是（基于您的 HTML）：

```
$(".checked_art").on('click',function()
{
    if ($(this).is(':checked')) {
        $(this).next('div.hide').hide();
    } else {
        $(this).next('div.hide').show();
    }
} 
```

或者，更简单：

```
$(".checked_art").on('click',function()
{
    $(this).next('div.hide').toggle();
} 
```

# c++ - 使用 void* 作为 STL 中的固定宽度记录

> ID：11850043
> 
> 赞同：3
> 
> 时间：2012-08-07T16:16:00.907
> 
> 标签：c++, stl

我有一个包含 N 条记录的连续缓冲区，每个 W 字节宽。N 和 W 在编译时都是未知的**。**N*M 是 500mb 的订单。我想在标准 STL 算法中使用它，例如 sort() 或 nth_element()。我手头有一个比较器。是否有任何已经实施的方法可以做到这一点？

到目前为止，我想出了两种方法：

1）使用一个额外的向量，用索引 0...N 填充，对其进行排序（使用自定义比较器）而不是数据，使其类似于排序顺序的数据记录，然后根据该向量移动数据记录。缺点：额外的内存，修复数据记录顺序的额外困难，这有点不重要。

2）创建一些自定义迭代器（它知道 W），它将返回一些类似于记录的临时“虚拟”类实例，并为该类重载 swap() 以便它交换内存块。缺点：有些棘手，有些脆弱（需要遵循一些 STL 内部机制，例如知道将使用 swap()）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T16:23:43.250

您的第二个选项 - 编写自定义迭代器 - 是一种可行的方法并且效果很好。

你不需要依赖`swap`被使用：你只需要重载你的代理对象的赋值运算符，当迭代器被取消引用时你返回。

（请注意，在 C++11 中，“交换”元素的算法和函数需要使用`swap`通过 ADL 找到的函数。不过，重载赋值运算符仍然是更可取的，特别是如果您只是移动字节数组。）

我不知道我脑海中的一般实现，但作为一个起点，您可以[`stride_iterator`](http://cxxreflect.codeplex.com/SourceControl/changeset/view/2ab4aa208c09#cxxreflect%2fcore%2fiterator.hpp)从我的一个库（靠近文件底部）看一下。它包装一个字节数组并覆盖算术运算符以一次将迭代器移动 N 个字节，其中 N 仅在运行时才知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:23:27.990

我会选择第二种方法，但通过提供自定义复制语义，而不是使用自定义`swap`. 使迭代器值类型成为一个包含`void*`成员的类，并具有复制该成员指向的记录的复制构造函数和赋值运算符。这不依赖于任何实现细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T16:24:17.820

我会投票支持选项 2），但您实际上并不需要`swap()`为您的存根类重载。你只需要：

*   创建迭代器返回的“存根”类
*   实现分配一块宽度为 W 的内存的默认 ctor
*   实现分配宽度为 W 的内存块的复制 ctor，并复制输入的内存块
*   重载赋值运算符，以便将内存块从一个实例复制到另一个实例。

这样，`swap()`将自动为您的班级工作。

# javascript - 结合一种方法来隐藏或显示内容

> ID：11850044
> 
> 赞同：0
> 
> 时间：2012-08-07T16:16:00.807
> 
> 标签：javascript, jquery

我想知道如何将隐藏功能和显示功能组合成 1 个切换功能，可以淡入内容或淡出内容，我猜这个参数会更新淡入淡出方法：

这是我目前在我的对象中使用 jQuery 的 JS 工作，但完全错误：

```
toggleAlertOverlay: function (state) {
  var instance = this;
  if (state === hide) {
    instance.selector.fadeOut();
  }
  elseif(state === show) {
    instance.selector.fadeIn();
  }
},
toggleAlertOverlay(hide); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:19:24.903

尝试使用[`.fadeToggle()`](http://api.jquery.com/fadeToggle/)

> .fadeToggle() 方法为匹配元素的不透明度设置动画。在可见元素上调用时，一旦不透明度达到 0，该元素的显示样式属性就会设置为 none，因此该元素不再影响页面的布局。

```
$(<element>).fadeToggle(); 
```

`<element>`有效选择器在哪里......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:22:05.777

```
var toggleState = 'none';
toggleAllertOverlay: function()
{
    if(toggleState == 'none')
    {
        $('#element').fadeIn();
        toggleState == 'showing';
    }
    else
    {
        $('#element').fadeOut();
        toggleState == 'none';
    }
} 
```

只是一个基于你所拥有的概念。注意函数外部的变量。它在外面，所以它不会在功能完成后被破坏。但除此之外，如果这不适合您，您可以尝试其他各种方法。直到并包括 jQuery`toggle()`

# java - Java：当用户停止调整窗口大小时做某事

> ID：11850047
> 
> 赞同：0
> 
> 时间：2012-08-07T16:16:10.383
> 
> 标签：java, javafx-2, propertychangelistener

我目前正在使用可调整大小的 JavaFX 2.0 编写 gui。当用户调整窗口大小时，一个大矩形会随之调整大小。现在我需要将这个矩形的新边界推到一个漂浮在矩形内并且可能不会越过它的边界的图像上。

我想过通过 ChangeListener 更新边界，但我不希望它经常更新边界。完美的解决方案是“ChangeIsOverListener”，它在更改结束时更新边界一次。

有人可以帮帮我吗？

提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:17:27.297

您可能能够在窗口调整大小的任一侧捕获鼠标按下和鼠标向上事件 - 但您是否看到这些事件将取决于 AWT 系统，也可能取决于 O/S。

否则，您将不得不在窗口调整事件中使用计时器在最后一个窗口调整事件之后的几毫秒内触发一个单独的事件，这样如果在最后一个窗口调整事件中没有更改，您就认为该大小已“完成” ，比如说，1/2 秒。时间量将是用户感知的滞后与您要处理的调整大小数量之间的折衷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:12:07.953

也许你可以每`x`毫秒比较一下窗口的大小，当在这个时间间隔内没有变化时，你就知道变化结束了。

# php - PHP - CodeIgniter 下载远程文件

> ID：11850053
> 
> 赞同：3
> 
> 时间：2012-08-07T16:16:32.563
> 
> 标签：php, codeigniter

我在下载文件时遇到了 CodeIgniter 的问题。

该代码在单独的 php 文件中完美运行，但是当我将代码放入 CodeIgniter 时：该文件将成功下载，但已损坏:(。

注意：我正在处理来自远程服务器的视频文件。

编码：

```
$file = fopen ($link, "r");
if (!$file) {
    echo "<p align='center' style='color:#FF0101;'>Unable to open remote file :(, Please try again in a few minutes.</p>";
}else{
    ob_clean();
    header("Pragma: public");
    header("Expires: 0");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); 
    header("Content-Type: application/force-download");
    header("Content-Type: application/octet-stream");
    header("Content-Type: application/download");

    header('Content-Disposition: attachment; filename=zxc.3gp');
    //header("Content-Transfer-Encoding: binary");
    //header("Content-Length: ".$video_size);

    while (!feof ($file)) {
        $line = fgets ($file, 1024);
        echo $line;
        ob_flush();
        flush();
    }
    fclose($file);
    die();
} 
```

我在新的 CodeIgniter 项目中尝试了这段代码：

```
public function index()
{
    $link = 'http://mamprogr.net.tc/tmp/1.3gp';
    $this->load->helper('download');
    force_download('1.3gp',$link);
} 
```

但不工作:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T16:50:55.163

尝试CodeIgniter 的[force_download()](http://codeigniter.com/user_guide/helpers/download_helper.html)助手，看看它是否有帮助

```
force_download($name, $data); 
```

**更新**

我注意到您尝试提供直接链接作为 force_download() 函数的第二个参数 - 但是，它需要“数据” - 见下文 -

```
$data = file_get_contents("/local/path/to//1.3gp"); // Read the file's contents
//or perhpas $data = fopen(......);
$name = '1.3gp';

force_download($name, $data); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-26T12:27:22.893

您的解决方案解决了下载问题。然而，当播放文件时，你会得到一个错误：

Windows Media Player cannot play the file. The Player might not support the file type or might not support the codec that was used to compress the file.

I tried quicktime and realplayer and still the video refuses to play.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-08T07:41:47.923

in my case download link on external site is `https://example.com/test.apk` I use the following and it works like charm ,codeignighter version is 4

```
return redirect()->to('https://example.com/test.apk'); 
```

# vim - 屏幕分离和 SSH 注销后 Vim 键绑定丢失

> ID：11850062
> 
> 赞同：0
> 
> 时间：2012-08-07T16:17:12.897
> 
> 标签：vim, ssh, key-bindings, freeze, gnu-screen

在我经常使用的服务器之一（Ubuntu 11.04）上，每当我执行以下操作时，我都会得到一个挂起的注销：

1.  通过 SSH 登录
2.  开始画面
3.  运行 Vim
4.  {编辑文件等}
5.  分离屏幕会话
6.  注销服务器（“退出”）

完成后，它挂起。（说“注销”，似乎从未真正注销）。此外，下次我登录并重新连接我的屏幕会话时，我的所有键绑定似乎都在 Vim 中消失了。这包括一些插件的全部功能，比如 NERDTree。

我尝试了这些动作的几种不同组合。例如，如果我在分离屏幕之前退出 Vim，它就不会这样做。如果我根本不运行 Vim，或者根本不运行 screen，它也不会这样做。

知道这里会发生什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T18:41:49.830

我发现了问题所在。我将 SSH 客户端配置为为该服务器转发 X。禁用它可以解决问题。我真的不明白为什么的细节，但就是这样。

# c# - 接口和类设计建议

> ID：11850063
> 
> 赞同：1
> 
> 时间：2012-08-07T16:17:21.037
> 
> 标签：c#

我的第一次基于界面的编程时间以及如何设计界面的一些困惑。

我为两个节点之间的关系创建了一个接口，如下所示：

```
public interface IOWLRelation
{
    IOWLRelation AddSubClass(IOWLClass parent, IOWLClass child);
} 
```

然后我创建了实现这个接口的类，如下所示：

```
class OWLRelation: IOWLRelation
{
    public OWLClass Parent { get; set; }
    public OWLClass Child { get; set; }

    public IOWLRelation AddSubClass(IOWLClass parent, IOWLClass child)
    {
        this.Parent = (OWLClass) parent;
        this.Child = (OWLClass) child;
        return this;
    }

} 
```

首先，你认为我声明这些类和接口的方式有什么不好的做法吗？现在我的困惑是关于我在我的类中定义的这两个公共属性：我是否还需要在接口中定义它们？另外，如果我想在这个类中添加一个枚举成员怎么办？无论我添加到我的课程中，我都应该将它添加到它的界面中吗？

更重要的是在方法实现中，我将接口传递给该方法的参数，它是坏的还是正确的？我应该通过接口还是应该通过他们的真实课程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:23:06.760

如果从 IOWLRelation 继承的其他类也需要父/子，那么还要在接口中定义这些属性（在这种情况下，可能会将接口重命名为更通用的名称）。

在界面中，您应该定义您希望继承的类拥有的所有属性/方法（至少）。

通过接口完全没有问题。实际上它可能比实际的类更好，因为接口更通用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T16:32:26.007

在这种情况下，我会稍微不同地执行您的实现。如果您仔细考虑某人使用您的界面的工作流程，那会有点混乱。您必须首先创建一个 OWLRelation 对象，然后调用 AddSubClass 方法，该方法只返回您已经创建的对象。我会改用工厂方法：

```
public interface IOwlRelation
{
    OwlClass Parent { get; }
    OwlClass Child { get; }
}

public class OwlRelation : IOwlRelation
{
    public OwlClass Parent { get; private set; }
    public OwlClass Child { get; private set; }

    public static IOwlRelation Create(OwlClass parent, OwlClass child)
    {
        return new OwlRelation
        {
            Parent = parent,
            Child = child
        };
    }
} 
```

请注意 Create 方法是静态的，因此您不必为了获取它的实例而创建它的实例。此外，Parent 和 Child 类通过接口是只读的，但您可以从类内部设置它们。这通常是防止属性在以后被覆盖的好习惯，但您不一定必须这样做。我还将这些类重命名为使用普通的驼峰式大小写，即使是首字母缩略词，因为这是 C# 命名标准的一部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T16:34:15.267

根据如何使用接口来考虑接口。如果调用者想知道 Parent 或 Child，那么你想在接口中公开它。如果它们只是实现细节，那么不要将它们包含在接口中。

关于这些事情并没有真正严格的规则，因为这完全取决于接口的使用方式。

我想说的是`AddSubClass`，如果您总是将参数转换为 an `OWLClass`，您可能需要考虑这对调用者是否有意义。他们会尝试通过传递两个不同的实现来调用它`IOWLClass`吗？如果他们这样做，演员将抛出异常。这可以接受吗？

# .net - TeamCity 从版本文件中读取和更新版本号

> ID：11850065
> 
> 赞同：7
> 
> 时间：2012-08-07T16:17:24.940
> 
> 标签：.net, teamcity, version-numbering

我们正在使用 TeamCity 作为 CI 服务器，并且我们一直在考虑如何实现一种方法来对我们的版本进行版本控制，该方法既安全（即人为错误的可能性最小）又需要尽可能少的努力。到目前为止，以下似乎是最合乎逻辑的：

1.  创建一个版本文件（或使用 assemblyinfo.cs）。版本信息将采用....格式。此文件将检入我的 VCS。
2.  运行 TeamCity 构建
3.  TeamCity 从步骤 1 中读取版本文件，挑选出每个单独的数字并设置相应的 TeamCity 构建参数（这样我以后可以将它们用于创建 nuget 包和标记等事情）
4.  TeamCity 自动增加最终的“构建计数”值。
5.  TeamCity 将新版本信息保存回版本文件（使用更新的“构建计数”）
6.  然后，TeamCity 会运行我的其余构建步骤、构建文件、运行单元测试、设置正确的程序集版本等。
7.  TeamCity 最终将文件检查回 VCS

我们相信这样做的好处是如果我们需要修复旧版本，那么版本号将是正确的，TeamCity 可以简单地使用旧版本文件，并像往常一样增加构建计数。这确实假设我们正在正确更新我们的主要/次要/补丁版本。这有望与即将发布的 TeamCity 7.1 功能很好地配合使用，该功能允许您通过自定义构建对话框选择要构建的分支。

从到目前为止我已经读过的内容来看，这些操作在 TeamCity 中应该是可能的，但我们正在寻找最简单的方法来解决这个问题，因为我们只是一个两人的装备，而且我们负担不起大笔投资大量时间成为 Nant 或 powershell 的专家，却发现它可能无法达到我们想要的效果。

所以我想总结一下我的问题如下：

1.  我提议的可能吗？
2.  如果是，那么考虑到我在 Nant、powershell 等方面的有限经验，最好的工具是什么（即对于命令行和脚本经验扩展到简单 DOS 操作和一点 VBScript 的人来说，这是最快的学习工具）

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T17:17:28.660

对于您的第一个问题：是的，有可能：

1.  将 .git(.svn, .hg etc) 目录添加到 VCS 规则
2.  使用您最喜欢的脚本语言在 teamcity（命令行运行器）中读取构建脚本中的版本号并对其进行增量。
3.  通过[交互协议设置内部版本号](http://confluence.jetbrains.net/display/TCD7/Build+Script+Interaction+with+TeamCity#BuildScriptInteractionwithTeamCity-ReportingBuildNumber)
4.  使用您喜欢的脚本语言更新版本文件中的内部版本号
5.  执行构建步骤
6.  执行提交和推送，因为您在最后一步的构建目录中已经有 .git(.svn, .hg etc) 目录

抱歉，我无法回答您的第二个问题，因为我不知道任何适用于 Windows 的工具。在 linux 上，我会使用 bash。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-05-30T15:57:18.820

**使用PowerShell**运行器类型添加构建步骤

将**脚本**字段设置为**源代码**

在**ScriptSource**字段中输入以下内容：

```
# Get AssemblyInfo file's contents
$file = "GlobalAssemblyInfo.cs"
$contents = get-content $file -Raw

# Regex to get the version number from AssemblyInfo file contents
$regex = new-object System.Text.RegularExpressions.Regex ('(^\s*\[\s*assembly\s*:\s*((System\s*\.)?\s*Reflection\s*\.)?\s*AssemblyVersion(Attribute)?\s*\(\s*@?\")(?<version>.*?)(\"\s*\)\s*\])', [System.Text.RegularExpressions.RegexOptions]::MultiLine)

# Get the version number
$version = $regex.Match($contents).Groups["version"].Value

# Update TeamCity buildNumber parameter using stdout
echo "##teamcity[buildNumber '$($version)']" 
```

# eclipse - eclipse中的项目类路径

> ID：11850071
> 
> 赞同：1
> 
> 时间：2012-08-07T16:17:34.857
> 
> 标签：eclipse, jar, project

我有一个关于在 Eclipse 中将文件夹/ja​​rs/库添加到项目的问题。

假设我从 Internet 上下载了一个包含库的文件夹，我是将其添加为文件夹、外部 jar 还是类文件夹？

无论哪种方式，我都添加了它，它现在是可用库的一部分，但我的程序中仍然出现错误，说该类不可用。

然后我尝试将 $CLASSPATH 修改为文件夹所在的位置，但仍然出现错误。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:28:03.440

只需尝试以下操作（如果您的项目是 Web 应用程序）：

*   将您的库（我认为是 jar 文件）添加到您的`WebContent/WEB-INF/lib`文件夹中。您可以做的只是简单地复制 jar（即 Ctrl+C）然后粘贴到这个 Eclipse 文件夹中。这样，库将自动添加到构建路径中。

或者，您可以按照此示例中概述的三个步骤中的任何一个：http: [//www.wikihow.com/Add-JARs-to-Project-Build-Paths-in-Eclipse-(Java)](http://www.wikihow.com/Add-JARs-to-Project-Build-Paths-in-Eclipse-%28Java%29)

我会先亲自尝试*Method-3*（这正是我在下面提供的评论中提到的）。

如果这不起作用，请尝试在您的问题中添加更多细节。例如，您下载了哪个库（如果您遗漏了我们不知道的内容，可能会有所帮助）。另外，你得到的错误到底是什么？如果您无法发布图片，只需复制错误内容即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T16:39:29.510

添加所有 JAR 后，尝试按 Ctrl + Shift + O（如橙色）。这应该重新组织导入并尝试添加任何丢失的导入。

例如，转到 excelToText.java 并按 Ctrl + Shift + O 或单击 Source -> Organize Imports，如下所示：

![在此处输入图像描述](../Images/f73ce34497b95ec4ee440d3aca94a2fd.png)

那么当你保存文件（文件->保存）时，你看到错误消失了吗？

观看**[此](http://www.youtube.com/watch?v=BkOKLbX1qzY)**视频以了解其工作原理。

# android - 单击图像时如何将与图像关联的字符串值分配给文本小部件

> ID：11850074
> 
> 赞同：1
> 
> 时间：2012-08-07T16:17:41.987
> 
> 标签：android, android-widget

```
 package com.me.trial;

    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View.OnClickListener;
    import android.widget.ImageView;

    public class TrialActivity extends Activity {
        /** Called when the activity is first created. */
        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.main);

            ImageView img = (ImageView)findViewById(R.id.imageView1);

            img.setClickable(true);
            OnClickListener l;

        }

        private void hasBeenClicked(<method invoked when the user has clicked>){

        }
    }

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <RelativeLayout
            android:id="@+id/relativeLayout1"
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >

            <TextView
                android:id="@+id/textView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignParentLeft="true"
                android:layout_alignParentTop="true"
                android:layout_marginLeft="56dp"
                android:text="Large Text"
                android:textAppearance="?android:attr/textAppearanceLarge" />

            <EditText
                android:id="@+id/editText1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_alignLeft="@+id/textView1"
                android:layout_alignRight="@+id/textView1"
                android:layout_below="@+id/textView1"
                android:layout_marginTop="64dp" >

                <requestFocus />

            </EditText>

            <ImageView
                android:id="@+id/imageView1"
                android:layout_width="match_parent"
                android:layout_height="match_parent"
                android:layout_alignParentLeft="true"
                android:layout_alignParentTop="true"
                android:scaleType="fitEnd"
                android:tag="Employee name"
                android:src="@drawable/img18" />

            </RelativeLayout>
          </LinearLayout>
 </LinearLayout> 
```

我需要应用程序传递一些与之关联的字符串值，以便在用户单击图像后立即将其传递到文本中。我如何使用 android 中的单击侦听器来实现以下任务。没有必要填写我给出的代码片段。欢迎任何关于设计的新想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:23:13.423

您可以将文本设置为 `Tag`图像，以便您可以获取该文本 onClick 事件。`Tag`可以在 XML 中设置，也可以动态设置。

```
public class TrialActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ImageView img = (ImageView)findViewById(R.id.imageView1);
        img.setTag("YOur text");
        img.setClickable(true);
        img.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
                   String urText= arg0.getTag().toString(); 
                   EditText edt = (EditText)findViewById(R.id.editText1);
                   edt.setText(urText);
        }
      });      
    }
} 
```

此代码演示了如何动态实现您的要求。

# html - 如何在 eBay 上删除导航栏？

> ID：11850075
> 
> 赞同：0
> 
> 时间：2012-08-07T16:17:42.757
> 
> 标签：html, css, ebay-api

我正在尝试在 eBay 上创建自定义产品页面[http://www.ebay.co.uk/itm/Que-Modular-Shotgun-Microphone-Kit-/271032405588?pt=UK_Music_Instruments_Microphones_MJ&hash=item3f1aca4e54#ht_2243wt_971](http://www.ebay.co.uk/itm/Que-Modular-Shotgun-Microphone-Kit-/271032405588?pt=UK_Music_Instruments_Microphones_MJ&hash=item3f1aca4e54#ht_2243wt_971)，但遇到了麻烦删除导航栏和标题栏。

在左侧导航栏的显示设置中，我已取消所有框，但类别列表仍然出现，我无法将其删除。

这是一个没有左侧导航和标题的产品页面示例[http://www.ebay.co.uk/itm/2009-ROYAL-MINT-FIRST-YEAR-ISSUE-GOLD-PROOF-QUARTER-SOVEREIGN-COIN -BOX-COA-/400288750395?pt=Coins_BritishProofs_RL&hash=item5d33119b3b#ht_2655wt_1190](http://www.ebay.co.uk/itm/2009-ROYAL-MINT-FIRST-YEAR-ISSUE-GOLD-PROOF-QUARTER-SOVEREIGN-COIN-BOX-COA-/400288750395?pt=Coins_BritishProofs_RL&hash=item5d33119b3b#ht_2655wt_1190)所以你可以看到我想要实现的目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:27:59.627

如果您将 jquery 添加到您的页面，您可以执行此命令，它将从页面中删除：

`jQuery(".tb-cw").find('table:eq(5)').find('td:first').remove()`

# sharepoint - 表视图共享点列表

> ID：11850080
> 
> 赞同：0
> 
> 时间：2012-08-07T16:17:54.683
> 
> 标签：sharepoint, ms-access

需要您在以下查询中输入 -

在表格视图中打开共享点链接表后，字段部分对我来说是灰色的..如下文所述，我想在共享点链接列表的列上设置索引..如何激活此部分？

感谢您的投入..

这与下面的帖子有关

[Sharepoint 链接表索引](https://stackoverflow.com/questions/11647844/index-on-sharepoint-linked-table)

![在此处输入图像描述](../Images/46d4a67eef4823adf13c9cf6d36a59a7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T13:32:20.473

好吧，如果您的光标在 ID 列中，所有内容都将变灰，因为在所需的自动编号 ID 列中您无法更改任何内容。如果您将光标移动到其他列中，则功能区上的选项应该不会变灰并启用。

我想以上是一个很长的镜头，我假设您将光标移出 ID 列，或者至少单击了要更改的列。因此，您显示的图片是正确的，因为您的光标位于 ID 列中，如前所述，您无法更改有关该 ID 列的任何内容。

# c# - 等待嵌套的 BackgroundWorkers 完成

> ID：11850084
> 
> 赞同：0
> 
> 时间：2012-08-07T16:18:00.657
> 
> 标签：c#, .net, wpf, vb.net, backgroundworker

我有一个生成 BackgroundWorker 的 UI 按钮。这个 BackgroundWorker 产生了几个执行某些操作的 BackgroundWorker。有没有办法在主 BackgroundWorker 中等待所有内部 BackgroundWorkers 完成？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T16:21:56.247

您可以创建[Semaphore](http://msdn.microsoft.com/en-us/library/system.threading.semaphore.aspx)，将其传递给生成的后台工作人员，然后在后台工作人员代码结束时调用[Release](http://msdn.microsoft.com/en-us/library/6caa9s64.aspx)方法。在主要工作人员调用[WaitOne](http://msdn.microsoft.com/en-us/library/58195swd.aspx)的确切次数等于产生的工作人员的数量。确保将所有内容都包含在内，`try ... finally`以便在出现问题时您的应用程序不会挂起。

如果您使用的是 .net 4，请考虑使用[SemaphoreSlim](http://msdn.microsoft.com/en-us/library/system.threading.semaphoreslim.aspx)，它是具有相同功能的轻量级版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:20:44.920

在您的主要工作人员代码中，您可以检查其他工作人员的[IsBusy 属性](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.isbusy.aspx)

*“获取一个值，该值指示 BackgroundWorker 是否正在运行异步操作。”*

```
Private Sub BackgroundWorkerMaster_DoWork(sender As System.Object, e As System.ComponentModel.DoWorkEventArgs) Handles BackgroundWorkerMaster.DoWork
    Do While bgwChild1.IsBusy AndAlso bgwChild2.IsBusy
        System.Threading.Thread.Sleep(1) 'wait for a small amount of time
    Loop
End Sub 
```

# ms-access - 多选列表框上的Dcount？

> ID：11850085
> 
> 赞同：1
> 
> 时间：2012-08-07T16:18:09.463
> 
> 标签：ms-access, ms-access-2003

又是我。This code works fine when only 1 item is selected, however when more than one item is selected I get the error "syntax error (comma) in query expression" on the following line of code: intCountNull = DCount("*", "Scrubbed ", strCriteria & " 为空")

这是我的代码：

```
Private Sub Command29_Click()
Dim strCriteria As String
Dim intCountNull As Integer
Dim varItem As Variant

'On Error GoTo Err_Command29_Click

Me.Fields_Values.RowSource = ""

For Each varItem In Me!List101.ItemsSelected
strCriteria = strCriteria & "," & Me!List101.ItemData(varItem)
Next varItem

strCriteria = Right(strCriteria, Len(strCriteria) - 1)

intCountNull = DCount("*", "Scrubbed", strCriteria & " Is Null")
Fields_Values.RowSource = intCountNull & " null values found in " & strCriteria

Exit_Command29_Click:
    Exit Sub
'Err_Command29_Click:
    'MsgBox "Please select a field" 
```

结束子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T20:03:34.387

*... when more than one item is selected I get the error "syntax error (comma) in query expression" on the following line of code:`intCountNull = DCount("*", "Scrubbed", strCriteria & " Is Null")`*

那讲得通。如果列表框选择为“field1”、“field3”和“field4”，您`DCount()`将抛出错误 #3075，“*查询表达式 'field1,field3,field4 Is Null'中的语法错误（逗号）。* ”

该`DCount()`表达式将像以下 SELECT 语句一样计算：

```
SELECT Count(*)
FROM Scrubbed
WHERE field1,field3,field4 Is Null 
```

数据库引擎肯定会抱怨该`WHERE`条款。您不能给它一个字段名称列表并询问它是否列表`Is Null`。您将不得不单独询问每个字段是否`Is Null`.

这就是为什么您会收到该错误的解释。但是，我认为你需要改变你的方法。

在您遍历选定项目时构建`RowSource`值列表字符串。（确保您将值列表作为 . 的行源类型属性。）这是一个经过测试的示例，它可以满足您的需求。 `Fields_Values``List101``Fields_Values`

```
Private Sub Command29_Click()
    Dim strCriteria As String
    Dim intCountNull As Integer
    Dim varItem As Variant
    Dim strRowSource As String

    Me.Fields_Values.RowSource = ""
    For Each varItem In Me!List101.ItemsSelected
        strCriteria = "[" & Me!List101.ItemData(varItem) & _
            "] Is Null"
        intCountNull = DCount("*", "Scrubbed", strCriteria)
        'Debug.Print strCriteria, intCountNull '
        strRowSource = strRowSource & ";" & intCountNull & _
            " null values found in " & _
            Me!List101.ItemData(varItem)
    Next varItem

    'Debug.Print strRowSource '
    If Len(strRowSource) > 0 Then
        strRowSource = Mid(strRowSource, 2)
        Me.Fields_Values.RowSource = strRowSource
    End If
    'Debug.Print strRowSource '
End Sub 
```

此外，我不明白为什么用户甚至应该被允许点击`Command29`，除非`List101`包含选定的项目。所以考虑禁用`Command29`，直到做出选择。

```
Private Sub Form_Load()
    Me.Command29.Enabled = False
End Sub

Private Sub List101_AfterUpdate()
    Me.Command29.Enabled = (Me.List101.ItemsSelected.Count > 0)
End Sub 
```

最后，我建议你帮自己一个忙，给你的控件起有意义的名字...... `Command29`可能是`cmdShowNullCounts`并且`List101`可能是`lstFieldNames`。当您处理数十个控件时，有意义的名称特别有用。当您需要在几个月后重新访问表单设计时，您也会发现它们很有帮助。将来必须接任的任何其他人都会感谢您的礼貌。

# android - 在 android 上即时切换视频摄像头

> ID：11850089
> 
> 赞同：0
> 
> 时间：2012-08-07T16:18:15.313
> 
> 标签：android, xamarin.android

我知道这是可能的，因为我的 droid 手机附带的相机应用程序可以做到这一点，但就我的一生而言，我似乎无法动态切换摄像头来拍摄视频或标准摄像头（这让我怀疑我做的不对！）

目前，我有一个按钮事件

```
btnSwitchCamera.Click += new EventHandler(btnSwitchCamera_Click); 
```

在此之前，我检查了摄像头的数量 - 如果只有一个摄像头，则未启用该事件。

开关代码如下所示

```
private void btnSwitchCamera_Click(object s, EventArgs e)
    {
        if (isBackCamera == false)
        {
            try
            {
                RunOnUiThread(delegate
                {
                    camera.Release();
                    camera = Android.Hardware.Camera.Open(1);
                });
            }
            catch (Java.Lang.RuntimeException)
            {
                alertMsg(context, Application.Context.Resources.GetString(Resource.String.videoErrorTitle),
                    Application.Context.Resources.GetString(Resource.String.videoFailToConnect));
                return;
            }
            isBackCamera = true;
        }
        else
        {
            try
            {
                RunOnUiThread(delegate
                {
                    camera.Release();
                    camera = Android.Hardware.Camera.Open(0);
                });
            }
            catch (Java.Lang.RuntimeException)
            {
                alertMsg(context, Application.Context.Resources.GetString(Resource.String.videoErrorTitle),
                    Application.Context.Resources.GetString(Resource.String.videoFailToConnect));
                return;
            }
            isBackCamera = false;
        }
    } 
```

如果我单击该按钮，应用程序就会死机，声称我无法连接到该服务。

视频记录代码没什么特别的——它是一个设置表面、做支架和开始/停止记录的沼泽标准。

我这样做对吗？从文档中，我需要释放相机，然后使用适当的相机编号打开相机（Android.Hardware.Camera.NumberOfCameras - 1）

清单已正确设置。

谢谢

保罗

# java - 如何在 Java 中捕获同时执行多个查询的响应时间？

> ID：11850090
> 
> 赞同：1
> 
> 时间：2012-08-07T16:18:17.180
> 
> 标签：java, sql, multithreading

我正在开发一个 Java 工具，它必须将包含一组查询（大约 1000 个）的文本文件作为输入，一起执行它们，并打印出每个查询所用的响应时间。

我认为我们需要为此使用线程。我们该怎么做？我们应该先创建一个连接，然后为每个查询启动一个新线程吗？

要求是创建一个文件，其中包含查询以及旁边打印的响应时间。

此外

1.  计划从主程序获取数据库连接，将其与执行查询的查询一起传递给线程。这是正确的方法吗？
2.  由于它将是一个文本文件，因此将获取数组列表中的所有查询，并将从 while 迭代器循环中调用线程。还有更好的方法吗？
3.  如何写响应时间？我应该将所有查询与时间一起存储，最后将其写入文本文件，还是应该在线程执行每个查询后立即写入？

任何帮助将不胜感激。谢谢

编辑：这是一个为性能团队开发的工具，用于在数据库有大约 1000 个并发命中时检查查询的响应时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:36:07.577

你的问题太模糊了。
例如，您是否有例如 1000 个 SQL 传递给 SQL 服务器以作为批处理执行？
在这种情况下，您可以这样做：

```
long start = System.currentTimeMillis();  
execute SQL script  
System.out.println("took:"+System.currentTimeMillis() - start); 
```

如果您有一系列 sql 查询要作为独立于应用程序的操作运行并且想要测量平均时间，您可以使用执行器提交任务，添加每个任务的时间（类似于上面），最后划分按完成的查询数。

更新：
您可以为此使用线程池。
示例（省略异常处理）：

```
 Collection<Callable<Long>> sqlTasks = new ArrayList<Callable<Long>>();  
   sqlTasks.add(new Callable<Long>(){  

    @Override  
    public Long call() throws Exception {  
        long start = System.currentTimeMillis();  
        // DO SQL QUERY HERE   
        //return delay  
        return System.currentTimeMillis() - start;  
       }  
    });  
    //ADD MORE TO THE QUEUE 
    ExecutorService threadPool = Executors.newCachedThreadPool();  
    List<Future<Long>> results = threadPool.invokeAll(sqlTasks);  
    long totalDelay = 0;  
    for(Future<Long> delay:results){  
        System.out.println("Delay for task"+delay.get());  
        totalDelay += delay.get();  
    }  
    System.out.println("Average Delay per task"+totalDelay / sqlTasks.size()); 
```

您将 SQL 查询添加到队列中，它们由线程[池中](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)的线程执行并返回其延迟。
但是您还应该提及您正在尝试的 SQL DB。也许已经有一个性能工具可以做到这一点

# android - 当活动进入前台时，转到主要活动而不是堆栈顶部

> ID：11850098
> 
> 赞同：0
> 
> 时间：2012-08-07T16:18:41.130
> 
> 标签：android, android-activity, lifecycle, android-lifecycle

我有 3 个活动，然后我从 A 导航到 B，从 B 导航到 C。堆栈是 CBA（顶部是 C）。C Activity 有一个 Runnable，它可以在每个时间间隔运行，并连接到更新 UI 的 Web 服务。如果活动 C 进入后台，被销毁然后再次进入前台，则任务从主活动 A 开始。我想回到 C 活动。有可能吗？

在模拟器中工作正常，但在我的智能手机中只运行这个应用程序，总是破坏整个应用程序..我能做些什么吗？如果我提供与 UI 分离的服务，是否可以改善这一点？

Edit2：我在 AndroidManifest 上尝试了这个声明

```
 <activity android:name=".ActivityA" android:label="@string/app_name" 
        android:alwaysRetainTaskState="true">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />    
        </intent-filter> 
        <intent-filter>
            <action android:name="android.intent.action.VIEW"/> 
            <category android:name="android.intent.category.DEFAULT"/>
            <category android:name="android.intent.category.BROWSABLE"/>
            <data android:scheme="oauthht" android:host="hattrick"/>
        </intent-filter>          
    </activity>
    <activity android:name=".ActivityB" android:label="@string/ActivityB"
              android:screenOrientation="portrait"></activity>
    <activity android:name=".ActivityC" android:label="@string/ActivityC" 
              android:screenOrientation="portrait"
              android:launchMode="singleTask"> 
```

Edit2：以及调用活动的代码：

在主要活动 A 中：

```
public void onClickButtonB(View button) { 
    Intent intent = new Intent();
    intent.setComponent(new ComponentName(this,ActivityB.class));
    startActivity(intent);
} 
```

在活动 B 中：

```
 Bundle bundle = new Bundle();
 bundle.putLong("selectedMatch", matchID);           

 Intent liveIntent = new Intent(); 
 liveIntent.setComponent(new ComponentName(ActivityB.this, ActivityC.class));
 liveIntent.putExtras(bundle);
 startActivity(liveIntent); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T09:55:59.847

我知道是哪个问题。应用程序在后台崩溃，但异常被捕获。这会在后台重新启动应用程序并误导我。:-S

# controller - 如何将全局负载掩码添加到 Sencha Tabpanel 的主控制器？

> ID：11850104
> 
> 赞同：0
> 
> 时间：2012-08-07T16:19:08.900
> 
> 标签：controller, sencha-touch-2, mask, tabpanel

我的基于 tabpanel 的应用程序快完成了，但我想通过添加一个全局加载掩码来改进它，它出现在我的 tabpanel 的每次点击上，并在呈现特定选项卡的内容后消失。

我有点不清楚我应该听什么，我是否应该在 activeitemchange 上激活加载掩码，然后使用全局绘制事件取消掩码？我假设最有效的方法是在我的主控制器中，因为那时我只需要做一次而不是拥有多个侦听器（就像我发现的唯一示例中一样）。这似乎有效，我在单击选项卡项时得到一个加载掩码，但我不确定如何取消对绘制事件的屏蔽：

```
Ext.define('TCApp.controller.Main', {
extend: 'Ext.app.Controller',

config: {
refs: {
     tabpanel: 'tabpanel'
},
control: {
     tabpanel: {
     activeitemchange: 'onActiveItemChange'
                   }
         }
},
onActiveItemChange: function (self, newItem) {
    Ext.Viewport.setMasked({ xtype: 'loadmask', message: 'Loading...', indicator:true});
    console.log('Activeitemchanged');
}
}); 
```

这是最好的方法，将`Ext.Viewport.setMasked(false);`绘制事件放在主控制器中吗？我不确定该怎么做。

我也一直在读这个，但我认为它没有多大帮助：

[http://senchaexamples.com/2012/03/05/determining-when-the-active-item-changes-on-an-ext-tabpanel-container-in-sencha-touch-2/](http://senchaexamples.com/2012/03/05/determining-when-the-active-item-changes-on-an-ext-tabpanel-container-in-sencha-touch-2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:08:42.523

我不确定当您更改选项卡面板上的活动项目时，它会触发“绘制”事件（您可以对其进行测试）。在我的脑海中（没有测试过这个）你有几个选择。您可以尝试在选项卡面板的控件配置中添加“激活”事件......根据文档，当容器中的项目被激活时会触发。

如果这不起作用，那么您可以为 onActiveItemChange 函数尝试类似的方法：

```
onActiveItemChange: function (self, newItem) {
    Ext.Viewport.setMasked({ xtype: 'loadmask', message: 'Loading...', indicator:true});
    console.log('Activeitemchanged');
    newItem.on('painted', this.hideMask, this);
    //might need to try newItem.element.on('painted', this.hideMask, this);
},
hideMask: function() {
    Ext.Viewport.setMasked(false);
} 
```

# matlab - 色调到波长映射

> ID：11850105
> 
> 赞同：10
> 
> 时间：2012-08-07T16:19:15.157
> 
> 标签：matlab, image-processing, colors

是否有一种算法可以在给定色调值（0 度到 360 度之间）的情况下找出颜色的波长。MATLAB中是否有相同的内置函数？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-08T04:19:30.833

*虽然 Mark Ransom 和 Franco Callari 完全正确，您无法恢复感知颜色的光谱，也无法将色调值明确映射到波长，但如果您只想要相应的单色*波长，您绝对可以拼凑一些东西。

270 到 360 之间的色相循环部分是另一个问题。光谱中没有对应于粉红色或洋红色的东西，所以我们假设我们只使用 0 到 270 度之间的色调值。

估计可见光谱的可用部分为 400-650nm，具有波长`L`（nm）和色调值`H`（度），您可以即兴发挥：

```
 L = 650 - 250 / 270 * H 
```

650是最大波长，250是波长范围，270是色调范围。

我认为这应该是正确的方向，但当然可能还有改进的余地。[在可见光谱图上比较输入](http://www.thomaselectronics.com/telecine/images/TL_Spec_UM.gif)[色调](http://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/HueScale.svg/500px-HueScale.svg.png)和相应颜色，然后稍微调整值，您可能可以获得更好的结果。

[![色调到波长函数的图](../Images/a77d80b634e40ad87d3170c288e9c019.png)](https://i.stack.imgur.com/NVvgj.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T02:08:04.577

简短的回答：不。给定的色调通常可以由三倍无穷大的波长产生。

> “物理颜色”是纯[光谱颜色](https://en.wikipedia.org/wiki/Spectral_color)（在可见范围内）的组合。原则上存在无限多不同的光谱颜色，因此所有物理颜色的集合可以被认为是一个无限维[向量空间](https://en.wikipedia.org/wiki/Vector_space)（[希尔伯特空间](https://en.wikipedia.org/wiki/Hilbert_space)）。这个空间通常用 H[颜色]表示。从技术上讲，物理颜色的空间可以被认为是[单纯形上的](https://en.wikipedia.org/wiki/Simplex)[拓扑锥](https://en.wikipedia.org/wiki/Cone_(topology))，其顶点是光谱颜色，[质心为白色](https://en.wikipedia.org/wiki/Centroid)单纯形的颜色，圆锥顶点处的黑色，以及与任何给定顶点相关联的单色颜色，该顶点沿从该顶点到顶点的线的某处取决于其亮度。
> 
> ## . . .
> 
> 该系统意味着对于不在色度图边界上的任何色调或非光谱颜色，有无限多个不同的物理光谱都被感知为该色调或颜色。因此，一般来说，没有我们认为（比如说）特定版本的棕褐色的光谱颜色组合之类的东西。相反，有无数种可能性可以产生这种确切的颜色。纯光谱颜色的边界颜色只能响应纯粹在相关波长的光来感知，而“紫色线”上的边界颜色只能由纯紫色和纯紫色的特定比例产生。可见光谱颜色末端的纯红色。
> 
> [![](../Images/c78d9fd6249c1ce69fc153a18326e043.png "CIE 1931 xy 色度图，显示 sRGB 颜色空间的色域。 （点击查看源图）")](https://en.wikipedia.org/wiki/Color_vision#/media/File:Cie_Chart_with_sRGB_gamut_by_spigget.png)
> 
> CIE 色度图呈马蹄形，其曲线边缘对应所有光谱颜色（光谱[轨迹](https://en.wikipedia.org/wiki/Locus_(mathematics))），其余直边对应最饱和的[紫色](https://en.wikipedia.org/wiki/Purple)，[红色](https://en.wikipedia.org/wiki/Red)和[紫色](https://en.wikipedia.org/wiki/Violet_(color))的混合色。
> 
> *（[**来源**](https://en.wikipedia.org/wiki/Color_vision#Mathematics_of_color_perception)）*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-09-12T14:10:59.407

可以找到颜色/色调的主波长。但正如所说，大多数颜色都不是单色的，相同的颜色可以用不同的“混合”波长构成。即同色异谱。此外，对于额外光谱的品红色和紫色，只能指定互补波长。即与白色相加混合的色调/主要波长。还必须指定白色，因为由于适应，它不是绝对的白色。同样在心理上，我们对色调的感知并不遵循主要的色调线。Se Munsell 和 NCS 系统。

在这里，您可以根据 RGB 值或不同的 CIE 系统计算主波长：[http](http://www.brucelindbloom.com/index.html?Calc.html) ://www.brucelindbloom.com/index.html?Calc.html 我没有公式。

然后，您可以将 RGB 转换为 HSL 或类似的转换。并且往返于 Munsell 或 NCS 感知色调（NCS 值是专有的，因此您必须付费并使用他们的软件）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-10T00:03:40.203

我无法提供简单的解决方案，但您需要考虑以下几点：

*   光谱的可见部分大约在 380nm（UV 边界）和 780nm（IR 边界）之间。但是你看到的（色调）取决于触发的视锥细胞。在 660nm 以上，M-cone 根本没有被触发，所以 660nm 和 780nm 之间的一切都是色调 0°。
*   在 580nm 你有黄色，色调为 60°，最纯的绿色约为 535nm，即 120°，最纯的蓝色（240°）约为 457nm。
*   如果你应用一个线性函数，黄色应该是 597nm - 它不是，所以你需要一个更复杂的方法。
*   在蓝色以上，红色锥体仍然会被触发，直到我们看到紫色，但我们不会在更高的频率上再次达到红色，所以你不能超过大约 300°。
*   300° 和 360° 之间的色调范围在可见光谱中没有等效值，它只能通过将高频光（蓝色或紫色）与红光混合来模拟，这会导致紫线上的品红色和红色之间出现某种颜色。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-02-13T21:32:05.710

我发现这个网站可以将给定的波长转换为色调。通过一些工作，您实际上可以扭转这个过程。这并不理想，但在解决这个问题时，我更信任应用数学顾问而不是我自己。就是这样。

[https://www.johndcook.com/wavelength_to_RGB.html](https://www.johndcook.com/wavelength_to_RGB.html)

```
function convert(input) {
    var w = parseFloat(input);

    if (w >= 380 && w < 440) {
        r = -(w - 440) / (440 - 380);
        g = 0.0;
        b = 1.0;
    } else if (w >= 440 && w < 490) {
        r = 0.0;
        g = (w - 440) / (490 - 440);
        b = 1.0;
    } else if (w >= 490 && w < 510) {
        r = 0.0;
        g = 1.0;
        b = -(w - 510) / (510 - 490);
    } else if (w >= 510 && w < 580) {
        r = (w - 510) / (580 - 510);
        g = 1.0;
        b = 0.0;
    } else if (w >= 580 && w < 645) {
        r = 1.0;
        g = -(w - 645) / (645 - 580);
        b = 0.0;
    } else if (w >= 645 && w < 781) {
        r = 1.0;
        g = 0.0;
        b = 0.0;
    } else {
        r = 0.0;
        g = 0.0;
        b = 0.0;
    }

    // Let the intensity fall off near the vision limits
    if (w >= 380 && w < 420)
        factor = 0.3 + 0.7 * (w - 380) / (420 - 380);
    else if (w >= 420 && w < 701)
        factor = 1.0;
    else if (w >= 701 && w < 781)
        factor = 0.3 + 0.7 * (780 - w) / (780 - 700);
    else
        factor = 0.0;

    var gamma = 0.80;
    var R = (r > 0 ? 255 * Math.pow(r * factor, gamma) : 0);
    var G = (g > 0 ? 255 * Math.pow(g * factor, gamma) : 0);
    var B = (b > 0 ? 255 * Math.pow(b * factor, gamma) : 0);

    return [R, G, B]
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-19T16:54:41.060

没有转换，因为它们不重叠。

Hue 让您在 RGB 色彩空间中移动，通常是几乎所有消费类数字设备都使用的[sRGB 。](https://en.wikipedia.org/wiki/SRGB)这是我们的视觉系统在正常条件下（由[CIE 1931](https://en.wikipedia.org/wiki/CIE_1931_color_space)定义）识别的颜色的子集，并且根本不与在单色波长的光下感知的鲜艳颜色线重叠。

尽管从 0-120（红橙色到黄绿色）和接近 240（靛蓝）的色调相当接近，但如果您不关心所有褪色的绿色和蓝色，sRGB 是非常实用的，您可以伪造紫色和红色通过使它们分别在 270 或 330 左右变暗色调来结束全光谱，而唯一无法真正近似的地方是 180 左右，计算机青色根本不接近单色的充满活力的蓝绿色。

# truncate - 如何防止 PowerCharts 截断轴标签？

> ID：11850118
> 
> 赞同：0
> 
> 时间：2012-08-07T16:20:20.740
> 
> 标签：truncate, fusioncharts, clip

在Flash版PowerCharts的ErrorLine图表中，如果图表中的类别过多，最右边的X轴标签会被剪掉。有没有办法阻止 PowerCharts 裁剪最右边的 X 轴标签，或者这是 PowerCharts 中的错误？

以下是一个示例 XML，它将重现我在与 700x480 像素的 ErrorLine 结合时遇到的问题：

```
<chart caption="An example graph" xAxisName="X Axis" yAxisName="Y Axis" showValues="0" >
  <categories>
    <category label="0" />  <category label="1" />  <category label="2" />  <category label="3" />  <category label="4" />
    <category label="5" />  <category label="6" />  <category label="7" />  <category label="8" />  <category label="9" />
    <category label="10" /> <category label="11" /> <category label="12" /> <category label="13" /> <category label="14" />
    <category label="15" /> <category label="16" /> <category label="17" /> <category label="18" /> <category label="19" />
    <category label="20" /> <category label="21" /> <category label="22" /> <category label="23" /> <category label="24" />
    <category label="25" /> <category label="26" /> <category label="27" /> <category label="28" /> <category label="29" />
    <category label="30" /> <category label="31" /> <category label="32" /> <category label="33" />
  </categories>
  <dataset seriesName="A">
    <set value="0" />   <set value="0" />   <set value="1" />   <set value="2" />   <set value="4" />
    <set value="8" />   <set value="16" />  <set value="32" />  <set value="64" />  <set value="128" />
    <set value="192" /> <set value="224" /> <set value="240" /> <set value="248" /> <set value="252" />
    <set value="254" /> <set value="255" /> <set value="255" /> <set value="254" /> <set value="252" />
    <set value="248" /> <set value="240" /> <set value="224" /> <set value="192" /> <set value="128" />
    <set value="64" />  <set value="32" />  <set value="16" />  <set value="8" />   <set value="4" />
    <set value="2" />   <set value="1" />   <set value="0" />   <set value="0" />
  </dataset>
</chart> 
```

为了更好地衡量，这是我用来设置图表的 HTML：

```
<div id="chartContainer"></div>
<script type="text/javascript">
  var testChart = new FusionCharts( "ErrorLine.swf", "testChartId", "700", "480", "0", "1" );
  testChart.setXMLUrl("_Truncation.xml");
  testChart.render("chartContainer");
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T08:31:50.743

我想这在最新版本中已修复。尝试升级到最新版本并检查。

# android - 将 ListView 上的 OnItemClick 重定向到真正触摸的 Item 视图

> ID：11850121
> 
> 赞同：0
> 
> 时间：2012-08-07T16:20:27.590
> 
> 标签：android, android-layout, android-widget

我有一个列表视图，它显示每一行/项目的视图列表（一个列表项目可以有例如 2 或 3 个按钮）。所有项目都设置为不可聚焦且不可点击。这种方式点击调用我的 ListView OnClick 的项目。我现在想要做的是在真正的点击视图上调用 performClick() （因为它被设置为不可聚焦/cickable，所以什么也没做）。这可能吗？我试图找到一种基于单击位置获取视图的方法，但没有找到任何东西，另一方面，列表视图的 onItemClick 单击处理程序似乎也没有获得触摸的 x/y。我知道为此我可以使用 OnTouchEvent 但我将无法知道单击了哪个项目等...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:06:11.157

好吧试试这个，可能对你有帮助......为按钮和ListItem设置一个通用的onClick。

```
@override
public void onClick(View v) {
    Sting position=v.getTag().toString();               //<--- like this
    //task to do when clicks on the view...
    switch (v.getId()) {
    case R.id.<id_of_the_button1>:  
           //task to do when clicks on the button 1         
    break;
    case R.id.<id_of_the_button2>:  
           //task to do when clicks on the button 2         
    break;
} 
```

在自定义适配器中实现 OnClickListener 并使用上面的 onClick 覆盖它。

# html - 按钮在 Chrome/FF 中看起来很棒，但在 IE 中却大失败——可以让它工作吗？

> ID：11850123
> 
> 赞同：-1
> 
> 时间：2012-08-07T16:20:31.683
> 
> 标签：html, css, button

见 JFiddle：http: [//jsfiddle.net/Zfnz2/](http://jsfiddle.net/Zfnz2/)

互联网上的好人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:24:46.397

让 IE 发挥 CSS 奇迹的一种方法是使用[CSS3 Pie](http://css3pie.com/)。

它可以创造奇迹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:20:54.760

在 IE>6 上使用以下语法：

```
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f1d805', endColorstr='#e7b223',GradientType=0 );
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fac601', endColorstr='#f18e06',GradientType=0 );  //hover 
```

它应该按预期工作！

# php - 在mysql中重新排序/重置列唯一ID

> ID：11850124
> 
> 赞同：0
> 
> 时间：2012-08-07T16:20:32.970
> 
> 标签：php, mysql, sql, database

我不知道很多mysql。我在同一台服务器上有两个表：

**A.艺术家**

```
id | artist_name 
--------------------
8  | XXXX      |          
1  | YYYY      |          
5  | ZZZZ      | 
```

**专辑**

```
id | artist_id | album_name
-----------------------------
1 |      5     | Album 1  
2 |      1     | Album 2
3 |      8     | Album 3 
```

因此，我想重新排序该`artist_id`列，同时我想将`A.artists`'`id`列从 reordered更改`artist_id` `id`。有可能这样的事情吗？我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:56:15.473

首先，您需要了解 SQL 中的表是无序的。因此，您不能为表指定排序。您可以指定查询的顺序。

我的猜测是你想加入这两个表来获得专辑的名字：

```
select al.*, ar.name
from albums al join
     artists ar
     on al.artist_id = ar.id
order by ar.name 
```

表达您的问题的方式是您要重新分配ID。通常，这不是必需的，因为 id 仅用于唯一标识行。如果您有充分的理由重新分配 ID，请修改您的问题或提出新问题，包括原因。

# java - 使用多个 Java 正则表达式

> ID：11850125
> 
> 赞同：0
> 
> 时间：2012-08-07T16:20:35.553
> 
> 标签：java, regex, string, parsing

我正在尝试提取电子邮件并使用模式（EMAIL_PATTERN）将其替换为空格。运行以下命令时，传入完整文档时不会产生任何输出。该模式将仅匹配整个区域。所以这意味着如果我们只传入电子邮件，电子邮件将被匹配并被替换为空格。但以下方法的目的是查找电子邮件，不需要之前的手动提取。在 tempString 中的电子邮件被替换后，我想将它用于下一个模式。我应该将我想在一种方法中使用的模式组合起来，还是应该将它们放在不同的方法中？以下是我现在拥有的代码。我还有其他模式，但由于我的方法无法正常工作，我还没有发布它们。

```
private static final String EMAIL_PATTERN = "[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})";
public static void main (String[] args) {
//Document takes in a ID, student information(which includes email, address, phone, name),   school, and text   
Document r = new Document("", "FirstName LastName, Address, example@email.com,    phoneNumber", "School", "experience", "text");
            personalEmailZone(r);

 }
public static Document personalEmailZone(Document doc){
    //tempString is the personal information section of a resume
    String tempPI = doc.tempString();
    if(doc.tempString().matches(EMAIL_PATTERN) == true){
        //Pattern pattern = Pattern.compile("");
        Pattern pattern = Pattern.compile(EMAIL_PATTERN);
        Matcher matcher = pattern.matcher(tempPI);
        String emailTemp = "";
        if(matcher.find()){
            emailTemp = matcher.group();
            System.out.println(emailTemp);
            //PI.replace(emailTemp, "");
            System.out.println(emailTemp.replace(emailTemp, ""));
            tempPI = tempPI.replace(emailTemp, "");
            System.out.println(tempPI);
        }
    }
    return doc;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:50:40.400

您可以将模式放置在不同的方法中，这些方法返回修改后的字符串以供文本模式使用。例如

```
String tempPI = doc.tempString();
tempPI = applyPattern1(tempPI);
tempPI = applyPattern2(tempPI)
tempPI = applyPattern3(tempPI); 
```

您的代码没有显示任何输出，因为`doc.tempString().matches(EMAIL_PATTERN) == true`. 也许那里不需要它，因为它希望整个字符串都是电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:52:04.883

你有几个问题：

```
public static Document personalEmailZone(Document doc){
    //tempString is the personal information section of a resume
    String tempPI = doc.tempString();
    if(doc.tempString().matches(EMAIL_PATTERN) == true){ 
```

上面的语句尝试将*整个*文档与电子邮件地址模式进行匹配。`doc.tempString()`除非仅包含一个电子邮件地址而没有其他内容，否则这将不匹配。

```
 //Pattern pattern = Pattern.compile("");
        Pattern pattern = Pattern.compile(EMAIL_PATTERN);
        Matcher matcher = pattern.matcher(tempPI);
        String emailTemp = "";
        if(matcher.find()){
            emailTemp = matcher.group();
            System.out.println(emailTemp);
            //PI.replace(emailTemp, "");
            System.out.println(emailTemp.replace(emailTemp, "")); 
```

不知道上面是干什么用的。如果您的代码达到这一点，它总是会打印一个空行。

```
 tempPI = tempPI.replace(emailTemp, "");
            System.out.println(tempPI);
        } 
```

由于没有循环，您将只替换第一次出现的电子邮件地址。如果您希望替换所有事件，则需要循环输入。

```
 }
    return doc; 
```

At this point you haven't actually modified `doc`, so you're returning the document in its original form, with email addresses included.

```
} 
```

Look at the Javadoc for [`String#replaceAll(String regex, String replacement)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)

# wpf - 工作簿在 Excel 2010 中移动后 ElementHost 不刷新

> ID：11850127
> 
> 赞同：2
> 
> 时间：2012-08-07T16:20:42.733
> 
> 标签：wpf, excel, c#-4.0, vsto, excel-2010

我在 Windows 7 x64、.NET 4.0 上的 Excel 2010 32 位中的 CustomTaskPane 上的 ElementHost 有一个奇怪的问题

移动工作簿窗口后，不会重新绘制主机（或主机本身）内部的控件。为了说明这一点，我创建了示例：

```
 _host = new ElementHost { Dock = DockStyle.Fill, BackColorTransparent = false, BackColor = Color.Blue };
    _userControl = new UserControl();
    _userControl.Controls.Add(_host);
    _taskPane = CustomTaskPanes.Add(_userControl, "Pane");
    _taskPane.Visible = true; 
```

为简单起见，我省略了子控件，因为结果是相同的。

这是它的预期外观： ![在此处输入图像描述](../Images/c755d7a5096f0163b561fc4a09bf0aad.png)

现在我移动了一些工作簿，我得到： ![在此处输入图像描述](../Images/e47d3e5401bbd2ec37c1d740cbde8d14.png)

显然灰色和黑色区域不是预期的（与实际控制托管的结果相同）。_host refresh 解决了这个问题——重绘自身和孩子，但问题是我没有在 VSTO 中找到任何事件来检测工作簿何时被移动。

问题：

1.  这些黑色/灰色区域来自哪里？
2.  是否有可能避免/修复它以及如何？
3.  （作为一种解决方法）是否可以检测工作簿窗口移动，以便我可以刷新 _host 并祈祷它是唯一发生的情况？（馊主意）

其他测试表明，Windows 窗体控件不会受到这种行为的影响。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T14:10:42.510

您应该将真正的 XAML 用户控件放入 ElementHost。

在您的 WPF 用户控件中，使用背景颜色 = 蓝色创建一个网格。

不要依赖元素宿主本身

还要检查更新，VSTO 中的 elementHost 有很多错误。

# spring - 使用 maven 和 spring 部署不同环境

> ID：11850130
> 
> 赞同：1
> 
> 时间：2012-08-07T16:20:50.953
> 
> 标签：spring, maven, deployment

我有两个属性文件：

```
environment.properties:
 - project.host.db3.database.name=oracle

application.properties:
 - database.name=${project.host.db3.database.name} 
```

第一个代表环境变量，第二个代表要在 spring 项目中使用的属性，在此配置中，我尝试设置 environment.properties 但当然它不起作用：

```
<bean id="systemPropertiesLoader"   
class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
        <property name="targetObject" value="#{@systemProperties}" />
        <property name="targetMethod" value="putAll" />
        <property name="arguments">
    <util:properties location="classpath:environment.properties" />
</property>
</bean>

<bean id="propertyPlaceholderConfigurer"
class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
depends-on="systemPropertiesLoader">
<property name="locations">
    <list>
        <value>classpath:application.properties</value>
    </list>
</property>

<!-- bean using database.name --> 
```

它可行吗？如果不可行，人们如何在他们的项目中拥有不可知的属性（如 database.name），并且只部署一个文件（war、jar 等）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T06:46:56.147

好吧，只要您像这样定义属性，它似乎对于定义的 beans xml 是可行的：

```
<bean id="propertyPlaceholderConfigurer"
class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
depends-on="systemPropertiesLoader"> 
```

但是，如果您尝试从 servlet 访问属性：

```
this.getClass().getClassLoader().getResourceAsStream("application.properties"); 
```

你有机会得到这个：

```
bad port configuration: ${project.host.db3.database.port}
java.lang.NumberFormatException: For input string: "${project.host.db3.database.port}" 
```

作为对 yorkw 的回答，现在我可以在多个环境中部署相同的战争，并使用 -Denvironment=development 配置主机，因此我可以部署用于开发、生产等的属性文件，并且只需使用：

```
<bean id="systemPropertiesLoader"   
class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
        <property name="targetObject" value="#{@systemProperties}" />
        <property name="targetMethod" value="putAll" />
        <property name="arguments">
    <util:properties location="classpath:**${environment}/**environment.properties" />
</property>
</bean> 
```

否则，我应该在部署每个环境之前替换 application.properties。我相信有比这更好的解决方案。

# ios - 制作表单时Xcode在输入时设置默认按钮

> ID：11850132
> 
> 赞同：8
> 
> 时间：2012-08-07T16:20:56.320
> 
> 标签：ios, objective-c, xcode, cocoa, button

我正在使用 Objective-c 和可可在 Xcode 中制作表单。在界面生成器中，我有 2 个文本字段和 2 个按钮。当我构建项目并运行它时，两个按钮都没有被选中（以蓝色突出显示，而不是白色）。当用户在文本字段中书写时，ENTER 键需要触发其中一个按钮被按下。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-07T16:26:52.930

您在 IB 中为您的按钮设置 Key Equivalent 值。只需单击属性检查器中的该字段并按回车键。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T22:58:22.140

苹果文档的链接在这里：http: [//developer.apple.com/library/mac/#documentation/cocoa/conceptual/Button/Articles/MakingaButtontheDefaultButton.html](http://developer.apple.com/library/mac/#documentation/cocoa/conceptual/Button/Articles/MakingaButtontheDefaultButton.html)

此代码将返回键设置为默认值：

```
[myButton setKeyEquivalent:@"\r"]; 
```

文档中未提及，但要以编程方式删除该密钥，您将使用：

```
[myButton setKeyEquivalent:@""]; 
```

# c# - 提供托管元数据服务的功能

> ID：11850137
> 
> 赞同：1
> 
> 时间：2012-08-07T16:21:30.397
> 
> 标签：c#, powershell, sharepoint-2010

我创建了一个 PowerShell 脚本：

1.  使用 Get-SPServiceApplicationPool、Get-SPMetadataServiceApplicationProxy 和 Get-SPMetadataServiceApplication 检查服务是否已配置
2.  使用相应的 Remove-* cmdlet 删除应用程序池、代理和服务（如果存在）
3.  使用对应的 New-* cmdlet 创建应用程序池、代理和服务
4.  如果未启用，则启用分类和元数据导航功能
5.  创建并填充组和术语集

我想在 C# 中将其实现为具有 FeatureActivated 事件中的功能事件接收器的功能。我在第一步就遇到了第一个问题（可能还有更多）。在试图弄清楚如何自己从 C# 获取 SPIisWebServiceApplicationPool 一段时间后，我反编译了 Microsoft.SharePoint.Powershell 以查看 Get-SPServiceApplicationPool cmdlet 是如何实现的，它是通过访问 Microsoft.SharePoint 程序集中的 SPIisWebApplicationSettings 来完成的。它使用 SPIisWebApplicationSettings.Default.ApplicationPools 枚举。该类被标记为内部类，通过在 Microsoft.SharePoint 程序集上包含 InternalsVisibleTo 属性，允许从 Microsoft.SharePoint.Powershell 程序集对其进行访问。

因此，如果没有破解和重新编译 Microsoft.SharePoint 程序集以让我的程序集 InternalsVisibleTo 访问并且没有在我的功能中托管 PowerShell，我如何检查 SPIisWebServiceApplicationPool 是否存在，如果存在则将其删除，然后创建一个新的 SPIisWebServiceApplicationPool？此外，不喜欢使用反射来访问内部类......我正在寻找我在 SharePoint API 中缺少的东西，这将使我能够做到这一点。

# java - 可以在 JDBC / MySQL 中检索更新的行吗？

> ID：11850139
> 
> 赞同：0
> 
> 时间：2012-08-07T16:21:34.907
> 
> 标签：java, mysql, sql, jdbc

```
preparedStatement.executeUpdate() 
```

返回更新的行数。到目前为止，就我的研究而言，不可能进行更新查询来检索更新的行，但这似乎是一个基本功能，我显然遗漏了一些东西。如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T19:02:37.360

根据对问题的第一条评论，这在 MySQL 中根本不可能。PostgreSQL 支持`UPDATE...RETURNING`这个特性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:26:41.613

如果您使用 executeQuery 而不是 executeUpdate，您会得到一个结果集。

~~然后，将存储过程更改为函数，并在函数末尾的选择中返回更改后的行。AFAIK，您不能从 MySQL 中的过程返回数据（与 Microsoft SQL 服务器相反）。~~

编辑：上面删除的建议是不可能的。JDBC 规范不允许在查询语句中更新（请参阅这个答案：[http](http://bugs.mysql.com/bug.php?id=692) ://bugs.mysql.com/bug.php?id=692 ）。

但是，如果您知道要更新的行的 WHERE 子句，则始终可以先选择它们，以获取主键，执行更新，然后再对它们执行选择。然后你得到改变的行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-07T17:31:28.077

当您触发preparedStatement.executeUpdate() 时，您已经有了行标识符，您可以使用它来唯一地标识要更新的行——您需要使用相同的标识符来进行查询并获取更新的行。您无法使用 JDBC api 一次性完成更新和检索。

# vb.net - 使用 Json (.NET) 从 App_Data 读取

> ID：11850144
> 
> 赞同：1
> 
> 时间：2012-08-07T16:21:45.700
> 
> 标签：vb.net, json, streamreader

我们在大学有一个家庭作业，使用 MVC 和 VB 创建一个本地网站，它将从 Json 文件（即位于 App_Data 文件夹中）读取一些种子数据并填充数据库。问题是，我不确定如何让 Json 从 App_data 中的文件中读取，而无需为其分配完整地址。
发生了什么，几乎是我给它一个地址：

```
File.ReadFile("~/App_Data/emails.json") 'Also tried "App_Data/emails.json" 
```

之后，我将此路径（作为文件名）传递给 StreamReader：

```
Using fileRead As New IO.StreamReader(filename)
  Json read stuff 
```

而不是将此地址读取为项目的地址（“C:\Users\BlueLight\Desktop\Codes\VBA\NMCAss2\App_Data\emails.json”）它抛出一个异常，它
“找不到一部分路径 'C:\Program Files (x86)\Common Files\Microsoft Shared\DevServer\10.0\App_Data\emails.json'。” 所以，它在不同的地方搜索。
我可以将此路径重定向到我的 App_Data，而不使用完整路径吗？或者，也许我的逻辑有问题？

提前致谢。

更新：我尝试用“App_Data\filename.json”和“'~\App_Data\filename.json”之类的“\”反转“/”，但它仍然不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T15:36:44.357

显然，修复它的最佳方法是使用

```
System.Web.HttpContext.Current.Server.MapPath("~/App_Data/namemails.json") 
```

完美运行。

# objective-c - 具有 Run-to-Completion 语义的 KVO - 有可能吗？

> ID：11850145
> 
> 赞同：3
> 
> 时间：2012-08-07T16:21:46.680
> 
> 标签：objective-c, cocoa, architecture, key-value-observing, reentrancy

我最近遇到了 KVO 的重入问题。为了形象化这个问题，我想展示一个最小的例子。考虑一个`AppDelegate`类的接口

```
@interface AppDelegate : UIResponder <UIApplicationDelegate>
@property (strong, nonatomic) UIWindow *window;
@property (nonatomic) int x;
@end 
```

以及它的实现

```
@implementation AppDelegate

- (BOOL)          application:(__unused UIApplication *)application
didFinishLaunchingWithOptions:(__unused NSDictionary *)launchOptions
{
    __unused BigBugSource *b = [[BigBugSource alloc] initWithAppDelegate:self];

    self.x = 42;
    NSLog(@"%d", self.x);

   return YES;
}

@end 
```

**出乎意料的是，这个程序将43**打印到控制台。

原因如下：

```
@interface BigBugSource : NSObject {
    AppDelegate *appDelegate;
}
@end

@implementation BigBugSource

- (id)initWithAppDelegate:(AppDelegate *)anAppDelegate
{
    self = [super init];
    if (self) {
        appDelegate = anAppDelegate;
        [anAppDelegate addObserver:self 
                        forKeyPath:@"x" 
                           options:NSKeyValueObservingOptionNew 
                           context:nil];
    }
    return self;
}

- (void)dealloc
{
    [appDelegate removeObserver:self forKeyPath:@"x"];
}

- (void)observeValueForKeyPath:(__unused NSString *)keyPath
                      ofObject:(__unused id)object
                        change:(__unused NSDictionary *)change
                       context:(__unused void *)context
{
    if (appDelegate.x == 42) {
        appDelegate.x++;
    }
}

@end 
```

如您所见，某些不同的类（可能在您无权访问的第三方代码中）可能会为属性注册一个不可见的观察者。每当属性的值发生变化时，这个观察者就会被同步调用。

因为调用发生在另一个函数的执行过程中，这会引入各种并发/多线程错误，尽管程序在单个线程上运行。更糟糕的是，在客户端代码中没有明确通知的情况下发生了更改（好吧，您可以预期，每当您设置属性时都会出现并发问题......）。

在 Objective-C 中解决这个问题的最佳实践是什么？

*   是否有一些常见的解决方案可以自动恢复运行到完成的语义，这意味着 KVO-Observation 消息通过事件队列，在当前方法完成执行并恢复不变量/后置条件之后？

*   不暴露任何属性？

*   用布尔变量保护对象的每个关键功能以确保无法重入？例如：`assert(!opInProgress); opInProgress = YES;`在方法的开头，在方法`opInProgress = NO;`的结尾。这至少会在运行时直接揭示这些错误。

*   或者是否有可能以某种方式退出 KVO？

**更新**

根据 CRD 的回答，这里是更新的代码：

`BigBugSource`

```
- (void)observeValueForKeyPath:(__unused NSString *)keyPath
                      ofObject:(__unused id)object
                        change:(__unused NSDictionary *)change
                       context:(__unused void *)context
{
    if (appDelegate.x == 42) {
        [appDelegate willChangeValueForKey:@"x"]; // << Easily forgotten
        appDelegate.x++;                          // Also requires knowledge of
        [appDelegate didChangeValueForKey:@"x"];  // whether or not appDelegate  
    }                                             // has automatic notifications
} 
```

`AppDelegate`

```
+ (BOOL)automaticallyNotifiesObserversForKey:(NSString *)key
{
    if ([key isEqualToString:@"x"]) {
        return NO;
    } else {
        return [super automaticallyNotifiesObserversForKey:key];
    }
}

- (BOOL)          application:(__unused UIApplication *)application
didFinishLaunchingWithOptions:(__unused NSDictionary *)launchOptions
{
    __unused BigBugSource *b = [[BigBugSource alloc] initWithAppDelegate:self];

    [self willChangeValueForKey:@"x"];
    self.x = 42;
    NSLog(@"%d", self.x);    // now prints 42 correctly
    [self didChangeValueForKey:@"x"];
    NSLog(@"%d", self.x);    // prints 43, that's ok because one can assume that
                             // state changes after a "didChangeValueForKey"
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T19:33:53.603

您要求的是手动更改通知，并且受 KVO 支持。这是一个三个阶段的过程：

1.  您的课程将覆盖您希望推迟通知的任何属性的`+ (BOOL)automaticallyNotifiesObserversForKey:(NSString *)theKey`返回，并推迟到其他情况；`NO``super`
2.  在更改您调用的属性之前`[self willChangeValueForKey:key]`；和
3.  当你准备好通知发生时，你打电话`[self didChangeValueForKey:key]`

您可以很容易地在此协议上进行构建，例如，很容易记录您更改的密钥并在退出之前触发它们。

如果您直接更改属性的支持变量并需要触发 KVO，*您*还可以使用`willChangeValueForKey:`和`didChangeValueForKey`打开自动通知。

 *[Apple 的文档](http://tinyurl.com/8gce9d9)中描述了该过程以及示例。*

# javascript - 通过 postMessage() 进行通信

> ID：11850154
> 
> 赞同：1
> 
> 时间：2012-08-07T16:22:19.847
> 
> 标签：javascript, firefox-addon, firefox-addon-sdk

我正在开发 Firefox 扩展，我需要能够在插件脚本和内容脚本之间进行通信。我有一个工作方向：将脚本的 URL 从插件脚本传递到内容脚本。但是，我也需要能够朝相反的方向前进。我的 main.js 文件如下所示：

```
var data = require("self").data;
var pageMod = require("page-mod");
pageMod.PageMod({
  include: "https://trello.com/board/*",
  contentScriptWhen: 'end',
  contentScriptFile: data.url("scrumello_beta.user.js"),
  onAttach: function(worker) {
    worker.postMessage(data.url("scrumello_beta.js"));
    worker.on("message", function(addonMessage)
    {
        console.log(addonMessage);
    });
  }
}); 
```

在客户端脚本中，我有以下方法：

```
 function OpenProcess(SCRNumber)
    {
        self.postMessage(SCRNumber); 
    } 
```

但是，当调用此方法时，我收到以下错误：

```
Timestamp: 8/7/2012 12:15:58 PM
Error: NS_ERROR_XPC_NOT_ENOUGH_ARGS: Not enough arguments [nsIDOMWindow.postMessage]
Source File: resource://jid0-3mulsijczmtjeuwkd5npayasqf8-at-jetpack/scogan-3/data/scrumello_beta.js
Line: 1038 
```

这可以防止 worker.on("message"... 事件被触发。据我所知， postMessage 只接受一个参数，所以这里的任何帮助将不胜感激。

编辑：我已将 postMessage 调用更改为

```
self.postMessage(SCRNumber, "*"); 
```

我将它包装在 console.log 中，两者都在打印，所以我必须假设消息实际上是在发布的。但是，main.js 中的事件处理程序从不接收消息，因为我在其中的 console.log 从未打印过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:12:16.593

这就是我的做法。（请注意，我从未使用过`self.postmessage`）

插件脚本 (main.js) 到内容脚本通信：

```
contentPage = pageMod.PageMod({
  onAttach: function(worker) {

    // Post a message directly to the content script
    worker.postMessage("any thing you want to respond");

    // Depending on the message, respond with different data
    worker.port.on('getFact', function() {
      worker.postMessage("any thing you want to respond");
    });
    worker.port.on('getEnabled', function() {
      worker.postMessage("any thing you want to respond");
    });
  }
}); 
```

--

这是响应附加脚本的内容脚本：

```
// Get data from the addon script
self.on('message', function(msg) {
  // Do something depending on the message passed
}); 
```

--

最后，内容脚本可以像这样与附加脚本通信：

```
self.port.emit("message to send to add-on script") 
```

上面的代码会触发`worker.port.on`main.js中的代码。

# jquery - 如何在jquery中正确执行函数

> ID：11850155
> 
> 赞同：1
> 
> 时间：2012-08-07T16:22:25.980
> 
> 标签：jquery, function

我很难让 jquery 函数按照我的意愿行事。我相信悬停处理程序已被多次注册，导致它反复触发，但我不确定如何正确执行。任何帮助将不胜感激。

```
function hoverOptions(target)
{
 var option = target.children('.option');
 var tooltip = option.children('.tooltip');

 option
 .fadeToggle(150, function() { console.log('option'); })
 .hover(function() { console.log('tooltip'); });
};

$(document).on('hover', '#myElement', function()                
{      
 $(hoverOptions($(this)));
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:28:30.940

我认为您正在注册此活动两次。

```
function hoverOptions(target)
{
 var option = target.children('.option');
 var tooltip = option.children('.tooltip');

 option
 .fadeToggle(150, function() {console.log('option');)} 
 .hover(function(){console.log('tooltip')});
};

$(document).on('hover', '#myElement', function()                
{
     hoverOptions($(this));
}; 
```

如果你想在 jQuery 命名空间中声明你的方法：

```
$.hoverOptions = function(target){ //Your code } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:29:37.047

当您似乎想要调用它们时，您正在注册悬停事件。

此外，您仅将事件委托给一个元素。事件委托只是在事件涉及许多元素的情况下才真正是一个好主意。

尚不完全清楚您想要什么，但我对此进行了猜测（请注意简化的代码）。

```
//on hover to #myElement, fade toggle the .option child
$('#myElement').on('hover', function() {;
    $(this).children('.option').fadeToggle(150, function() {
        console.log('option');
    });
});

//on hover to .option elements, toggle the .tooltip child
$('.option').hover(function() { $(this).children('.tooltip').toggle(); }); 
```

# ipad - KineticJS Sprite 在 iPad 上无法正常工作

> ID：11850157
> 
> 赞同：0
> 
> 时间：2012-08-07T16:22:33.873
> 
> 标签：ipad, sprite, kineticjs

我正在使用 KineticJS 做一个小游戏。对于角色移动的动画，我使用的是 spritesheet。

在桌面（使用不同的浏览器）中，角色动画效果很好，就像在 Android 中一样。但是，在 iPad 上，它出错了。我很确定这是因为 iOS 平台，因为 Safari、Chrome 或 UIWebView 都没有显示 Spritesheet 的正确行为。

有人能帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:29:58.527

完成。该错误与 iOS 设备支持的最大分辨率有关。

# php - 繁重的 mysql 视图打破了 phpmyadmin

> ID：11850158
> 
> 赞同：0
> 
> 时间：2012-08-07T16:22:45.210
> 
> 标签：php, mysql, phpmyadmin

我的 mysql 数据库中有一些非常有用的视图。

其中一些需要一段时间才能运行（最多 6 分钟），这对我来说很好。它们用于诸如日终报告之类的事情。

phpMyAdmin 喜欢在渲染它的各种显示时显示记录数和其他统计信息...这需要运行视图查询，并导致 php 执行超时...。使 phpmyadmin 无法使用（更不用说计算数量的 cpu 时间丢失了）我目前不需要运行的视图中的行数）。

有没有办法关闭这些无关的表（在我的案例视图中）统计信息以使 phpMyAdmin 再次可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T02:22:14.570

埃里克，

我相信最新版本的 phpMyAdmin4.0.1 beta 可以规避这个问题......有点。您可以在左侧面板中导航到您需要的表格，而无需加载右侧面板（在所有表格上加载），包括繁重的视图。

我使用 phpMyAdmin 作为商业用户的简单报告工具，所以这个最新版本很好，因为他们无需等待右侧窗格加载即可获得所需的视图。

我同意 Williamvicary 的观点，如果你只是在做开发，那就找一个更好的工具。SQLYog 很棒（甚至是社区版）。如果你在 Mac 上，还有 SequelPro。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:27:30.533

我建议你放弃使用 PhpMyAdmin 并使用类似下面的东西，几年前我停止使用 PhpMyAdmin 并且从未回头。

Mysql 工作台：[http](http://www.mysql.com/products/workbench/) ://www.mysql.com/products/workbench/ （免费）

SQLYog：[http](http://www.webyog.com/en/) ://www.webyog.com/en/ （付费，但值得 - 惊人的实用程序）

# jquery - jQuery Dialog - 来自不同链接的相同对话框

> ID：11850159
> 
> 赞同：0
> 
> 时间：2012-08-07T16:23:00.113
> 
> 标签：jquery, jquery-ui-dialog

[几天来，我一直无法解决我在这里](https://stackoverflow.com/questions/11833008/jquery-dialog-external-links-javascript-not-working/11833134)遇到的问题，所以我试图想出一个替代方案来实现同样的目标。我决定不对表单使用外部文件，而是在我的 html 文件内部使用它。我现在遇到的问题是对话框只显示包 1 而不是包 2。

编码：

```
<script type="text/javascript">
    $('#PackageBook').dialog({
        autoOpen: false,
        width: 500,
        height: 400
    });

    $('#PackageBookOpen').click(function(){
        $('#PackageBook').dialog('open');
        return false;
    });
</script>
<body>
    <div id="Package1" class="packageDialog">
        <div id="order">
            <a id="PackageBookOpen" title="Package Booking" class="ui-state-default ui-corner-all" href="#"><img src="images/order.png"></a>
        </div>
    </div>
    <div id="Package2" class="packageDialog">
        <div id="order">
            <a id="PackageBookOpen" title="Package Booking" class="ui-state-default ui-corner-all" href="#"><img src="images/order.png"></a>
        </div>
    </div>
    <div id="PackageBook" class="packageBookDialog" title="Package Booking">
        <form name="package" action="">
               //Form 
        </form>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:28:38.607

您不能拥有多个相同的 ID。改用类选择器，例如

```
 $('.packageBookOpen').click(function(){
        $('#PackageBook').dialog('open');
        return false;
    }); 
```

并将类 packageBookOpen 添加到适当的元素。

# java - AspectJ：一个方面内多个通知的执行顺序（优先级）

> ID：11850160
> 
> 赞同：6
> 
> 时间：2012-08-07T16:23:04.093
> 
> 标签：java, aop, aspectj

类使用编译时编织。

想象一下我有方面类：

```
@Aspect
public class SecurityInterceptor {

    @Pointcut("within(@org.springframework.stereotype.Controller *)")
    public void beanAnnotatedWithController() {}

    @Pointcut("execution(public * *(..)) && args(*,httpReq)")
    public void publicMethods(HttpServletRequest httpReq) {}

    @Pointcut("beanAnnotatedWithController() && publicMethods(httpReq)")
    public void controllerMethods(HttpServletRequest httpReq) {}

    @Pointcut("execution(public * *(..)) && args(httpReq)")
    public void publicMethodsRequestOnly(HttpServletRequest httpReq) {}

    @Pointcut("beanAnnotatedWithController() && publicMethodsRequestOnly(httpReq)")
    public void controllerMethodsOneArg(HttpServletRequest httpReq) {}

    @Around(value = "controllerMethods(httpReq)")
    public Object populateSecurityContext(final ProceedingJoinPoint joinPoint, HttpServletRequest httpReq) throws Throwable {
        return popSecContext(joinPoint, httpReq);
    }

    @Around(value = "controllerMethodsOneArg(httpReq)")
    public Object populateSecurityContextOneArg(final ProceedingJoinPoint joinPoint, HttpServletRequest httpReq) throws Throwable {
        return popSecContext(joinPoint, httpReq);
    }

} 
```

`@DeclarePrecedence`确定执行顺序的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-31T17:04:00.353

[请阅读 AspectJ 文档的语言语义](http://www.eclipse.org/aspectj/doc/next/progguide/semantics-advice.html)部分中的“建议优先级”段落。

**方面**的优先级可以明确声明，**单个方面内的建议**优先级由文档中描述的规则确定，并且不能更改，AFAIK。所以`@DeclarePrecedence`在这种情况下不会帮助你，只会改变方面文件中的建议顺序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-09-07T12:33:43.343

如果您正在寻找多个方面的顺序，您可以创建一个方面，例如：

```
@Aspect
@DeclarePrecedence("AuthorizationAspect, MySpecialAspect, LastAspect")
public class CoordinationAspect {
    // empty
} 
```

这确实会在多个方面起作用。在一个方面是另一回事，不能改变AFAIK，但我不明白为什么这会是一个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-04-03T11:26:26.550

> 当在同一方面定义的两条通知都需要在同一连接点运行时，排序是未定义的（因为无法通过 javac 编译类的反射来检索声明顺序）。考虑将此类建议方法折叠为每个方面类中的每个连接点的一个建议方法，或者将建议部分重构为单独的方面类 - 可以在方面级别订购。

来自此处的 Spring AOP 文档（第**6.2.4.7 节。建议订购**）[https://docs.spring.io/spring/docs/2.0.x/reference/aop.html](https://docs.spring.io/spring/docs/2.0.x/reference/aop.html)

如果它有助于你来这里寻找这个。

# iphone - 如何在 XCODE 中使用 + 命名项目

> ID：11850167
> 
> 赞同：0
> 
> 时间：2012-08-07T16:23:19.487
> 
> 标签：iphone, xcode

我需要为我将调用 appname+ 的应用程序创建一个项目。好的，问题是当我按下创建项目并在产品名称中我在捆绑标识符中设置 appname+ 时，有 - 而不是 +。

我该怎么称呼它？

然后当应用程序在设备上时我如何使它成为+？

谢谢。

# sql-server - sql server 合并两个表中的值

> ID：11850170
> 
> 赞同：3
> 
> 时间：2012-08-07T16:23:27.773
> 
> 标签：sql-server, sql-server-2008, sql-server-2005

一般来说，我是 SQL 新手，甚至对 MS SQL 也是新手。如果标题不清楚我想要什么，我深表歉意。

我有两个表，一个旧表，我想从中获取数据到一个新表中。这些表具有完全相同的列，但行数不同。新表对旧表中的每个值都有多个副本，旧表仅出现 2 次。请参阅下面两列的比较：字母和金额。

新表：

```
A  0 
A  0
A  0
B  0
B  0 
```

旧表：

```
A  12
A  0
B  10
B  0
C  23 
```

我想要实现的是将旧表中的金额列的值添加到新表中第一次出现的字母中，如下所示：

```
A  12 
A  0
A  0
B  10
B  0 
```

内连接导致所有值都被填充（因此所有 A 都设置为 12）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:40:55.320

试试这个：

```
DECLARE @test1 TABLE(col1 varchar(2),idn int)
insert into @test1
VALUES('A',0),
('A',0),
('A',0),
('B',0),
('B',0)

DECLARE @test2 TABLE(col1 varchar(2),idn int)
insert into @test2
VALUES('A',12),
('A',0),
('B',10),
('B',0),
('C',23)

;WITH CTE as (select *,ROW_NUMBER() over (partition by col1 order by col1) as rn from @test1)

update c SET c.idn=b.idn
from CTE c inner join (select col1,SUM(idn) as idn from @test2
group by col1) b
on c.col1 = b.col1 
where c.rn=1

select * from @test1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:48:14.143

**[点击这里查看演示](http://www.sqlfiddle.com/#!3/91bc3/1)**

```
declare @t table
(
    val varchar(2),
    digit int
)

insert into @t(val, digit)values('A', 0)
insert into @t(val, digit)values('A', 0)
insert into @t(val, digit)values('A', 0)
insert into @t(val, digit)values('B', 0)
insert into @t(val, digit)values('B', 0)

declare @t1 table
(
    val varchar(2),
    digit int
)

insert into @t1(val, digit)values('A', 12)
insert into @t1(val, digit)values('A', 0)
insert into @t1(val, digit)values('B', 10)
insert into @t1(val, digit)values('B', 0)
insert into @t1(val, digit)values('C', 23)

Select k.val, isNull(sum(k.digit + k1.digit), 0) as Digit from 
(
    Select ROW_NUMBER() over(partition by val order by val) as rowid, * from @t
)K
Left Join
(
    Select ROW_NUMBER() over(partition by val order by val) as rowid, * from @t1
)K1
on k.val = k1.val AND K.rowid = K1.rowid
group by k.val, K.rowid 
```

# django - django 在 dotcloud 上的并发请求

> ID：11850173
> 
> 赞同：1
> 
> 时间：2012-08-07T16:23:30.223
> 
> 标签：django, multithreading, apache, dotcloud

我有一个要迁移到 dotcloud 的 django 应用程序。Django 内部和我的应用程序中的许多操作都不是异步的，即它们阻塞线程直到它们完成。当我使用 Apache 时，这并没有造成问题，因为每个请求都会打开一个不同的线程。但在 dotcloud 使用的 nginx/uwsgi 中似乎并非如此。看起来，uwsgi 有一个 --enable-threads 和 --threads 选项可用于多线程，但是：

1.  不清楚 uwsgi dotcloud 使用什么版本，是否支持这些功能
2.  由于我没有其他人问这个问题，我想知道这是否真的是让并发请求运行的正确方法（使用线程）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T07:40:56.000

您可以使用[Gunicorn](https://docs.djangoproject.com/en/dev/howto/deployment/wsgi/gunicorn/)运行 Django 。反过来，Gunicorn 支持多个[worker 类](http://gunicorn.org/configure.html#worker-class)，人们报告成功运行 gunicorn+gevents+django [[1]](https://stackoverflow.com/questions/9282628/making-django-go-green) [[2]](http://dbinit.com/blog/going-green/)。

要在 dotCloud 上使用它，您可能必须使用 dotCloud 的自定义服务。如果这是您想尝试的东西，我个人会从 dotCloud[使用自定义服务重新实现 python 服务](https://github.com/kencochrane/python-on-dotcloud)开始，并在其中将 uwsgi 替换为 gunicorn。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:07:22.087

我来这里寻找一些线索，我找到了，谢谢！不过，要真正让东西正常工作，还需要做大量的腿部工作。

这是 github 上的一个示例应用程序，它在 dotcloud 上使用 gunicorn、gevent 和 socketio：

[https://github.com/t1m0thy/django-tictactoe/tree/dotcloud](https://github.com/t1m0thy/django-tictactoe/tree/dotcloud)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-07T17:40:58.470

线程是 python 中的一个问题——GIL 不允许它们同时运行。所以多处理是一个答案。

或者你可以看看gevent。实际上 gevent 是一种 hack（python 堆栈的猴子补丁）等等，但它允许启动绿色线程。我不确定 gevent 是否可以与 django 结合使用，但谷歌知道；）

# java - 标记的语法错误，; 预期的？

> ID：11850178
> 
> 赞同：0
> 
> 时间：2012-08-07T16:23:51.363
> 
> 标签：java

我在我的程序中评论了我所有的错误。我的程序的重点是通过用户输入的任何内容来移动我的输入文件。我注释掉的错误对我来说毫无意义，因为这一切都很有意义，而且计算机并没有按照我想要的方式读取它。不要与我评论其中一个标记的错误之一是“，”相混淆。其他的是“（”和“）”。这些都是错误，在我评论它们的行中的某处需要一个分号。

这是程序的样子：

```
import java.util.*;
import java.io.*;

class CaesarCipher
{
 public static void main (String [] args) throws FileNotFoundException
 {
  Scanner keyboard = new Scanner(System.in);
  System.out.println("What shift should I use? ");
  int shift = keyboard.nextInt();
  System.out.println("What is the name of the input file? ");
  String name = keyboard.next();
  File f = new File(name);
  Scanner inFile = new Scanner(f);
  System.out.println("What is the name of the output file? ");
  String text = keyboard.nextLine();
  PrintWriter outFile = new PrintWriter(text);
  String encrypted = "";

  while (inFile.hasNextLine())
  {
     String line = inFile.nextLine();
      if ( shift == 1)
     encrypted = caesarEncipher(line, shift);
      else if (shift == 2)
     encrypted = caesarDecipher(line, shift);// the method caesarDecipher(java.lang.String, int) is undefined for the type CaesarCipher
      System.out.println(encrypted);
      outFile.println(encrypted);
  }
 }
  static String caesarEncipher(String text ,int shift) throws FileNotFoundException
  {
   String t = "";
   int i = 0;
   while (i < t.length())
   {  
    if (shift < 0)
    {
        shift = (shift % 26) + 26;
     }
        int move = (char) ((text.charAt(0) - 'A' + shift) % 26 + 'A');
        t += move;
        i++;
        System.out.println(t);
        outFile.println(t);
        return "DONE!";
     }
                                                          // for each token listed, it expects the semi colon.
     static String caesarDecipher(String text, int shift) throws FileNotFoundException // Syntax error on token "(", "," , ")", ; expected      
     {
      return caesarEncipher(input, -shift);
      }
     }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:28:55.237

您的`caesarDecipher`方法定义嵌入在方法中`caesarEncipher`。这不是合法的 Java，而且你把可怜的编译器弄糊涂了。

严格的缩进使这些事情变得非常清楚。如果您使用的是 IDE 或 emacs，请寻找工具来重新缩进整个文件（Unix 下也有命令行工具）：

对于 Eclipse ：`Ctrl`++`Shift``F`

对于 Emacs：突出显示区域（整个文件），然后：`Esc` `Ctrl`+`\`或`Alt`+ `Ctrl`+`\`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:29:35.767

您错过了方法 caesarEncipher 的结束 }。使用意图更快地发现这些错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:30:56.310

你在你`}`的最后失踪

```
static String caesarEncipher(String text ,int shift) throws FileNotFoundException 
```

最后你还有一个额外的

```
static String caesarDecipher(String text, int shift) throws FileNotFoundException 
```

另请注意，当您在此 ^ 方法中返回时，您正在使用`input`此方法中未定义的变量。也许你`text`认为这是你的论点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T16:31:00.643

如前所述，您缺少一个右括号。我建议使用[IDE](http://en.wikipedia.org/wiki/Integrated_development_environment)来发现这些错误。许多人喜欢[eclipse](http://www.eclipse.org/)但我个人喜欢[Intellij](http://www.jetbrains.com/idea/)。Eclipse 是免费的，而 intellij 的完整版不是。

# linux - Bash - for 循环中的多个条件

> ID：11850179
> 
> 赞同：1
> 
> 时间：2012-08-07T16:23:52.283
> 
> 标签：linux, bash, shell, loops

我正在尝试执行具有多个条件的 for 循环，但我没有在网上找到有关如何执行此操作的任何信息

对于愚蠢的问题，我很抱歉，但我刚开始在 linux 中编程

我在这里做错了什么？

```
 #!/bin/bash

j=0

for line in `cat .temp_` || j in `seq 0 19`
do
    ...

done 
```

错误说语法错误，我不能使用 ||

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T16:25:32.000

```
for line in `cat .temp_`
do
    if ! grep -Fxq $line $dictionary && [ $j -lt 20 ]
    then
        echo $line >> $dictionary
        j=$((j+1))
    fi
    [ $j -gt 20 ] && break
done 
```

您无法`for`在 shell 的循环中检查条件。你必须在一个额外的声明中做到这一点。在这种情况下：

```
[ $j -gt 20 ] && break 
```

另一种解决方案，没有`break`：

```
while read line && [ $j -lt 20 ]
do
    if ! grep -Fxq $line $dictionary && [ $j -lt 20 ]
    then
        echo $line >> $dictionary
        j=$((j+1))
    fi
done < .temp_ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T16:33:10.570

您正在尝试将两种不同样式的`for`-loop 组合为一个。相反，如果值`j`变得太大，只需中断：

```
j=0
while read -r line; do
    [[ j >= 20 ]] && break
    ...
done < ._temp 
```

（顺便说一句，这是在 bash 中迭代文件的首选方法。`for`如果文件太大，使用 -loop 会遇到问题，因为您实际上是使用文件的全部内容构建命令行。）

[更新：以下是基于我对循环目的的猜想。有关真实上下文，请参阅[在 bash 中从文件中计算单词出现次数](https://stackoverflow.com/questions/11850823/calculate-word-occurrences-from-file-in-bash)。]

实际上，您可以省去循环。您正在从 .temp_ 中查找最多 20 行尚未出现在名称在字典中的文件中的行，对吗？

```
sort -u .temp_ | grep -f $dictionary -Fx -v -m 20 >> $dictionary 
```

这将`grep`只调用一次，而不是每行一次`.temp_`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:40:59.170

一个简单的嵌套for循环？

```
for line in `cat file`; do for j in {0..19}; do
     your_commands
done; done 
```

如果我理解正确（你想在每行运行一个命令 20 次）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-12-22T04:21:51.857

一旦我需要处理目录中的所有文件，但仅在第 n 个文件或所有文件被处理之前：

```
count=1
nth=10
for f in folder/*; do
  ((count++))
  # process $f
  if [[ $count -gt $nth ]] 
  then
    break
  fi
done 
```

# javascript - 将字符串转换为多维数组

> ID：11850180
> 
> 赞同：0
> 
> 时间：2012-08-07T16:23:54.650
> 
> 标签：javascript, html, multidimensional-array

我有一个嵌套的 for 循环，它创建一个表示多维数组的空字符串值。一旦 for 循环完成，结果是这样的：

```
"[[0,0,0,0],[0,0,0,0]]" 
```

我想将它添加到我的代码中的多维数组中，我该怎么做？

我试过了：

```
map = eval("[[0,0,0,0],[0,0,0,0]]"); 
```

但这不会产生我正在寻找的正确的多维数组。

我希望能够像这样使用数组：

```
map[0][1] == 1; 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:27:07.473

`JSON.parse()`您可以使用( [MDN docu](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/parse) )解析字符串。

```
var str = "[[0,0,0,0],[0,0,0,0]]";

var map = JSON.parse( str ); 
```

但是，在您的示例中，没有条目 equaling `1`，因此您的要求`map[0][1] == 1`不会以这种方式得到满足。

# firefox - “权限”需要获取网站数据然后将表单发送到另一个网站

> ID：11850184
> 
> 赞同：0
> 
> 时间：2012-08-07T16:24:03.150
> 
> 标签：firefox, google-chrome, google-chrome-extension, firefox-addon

拥有一个从 Gmail 获取数据的扩展程序，然后将信息发送到另一个站点，例如`example.com`.

我应该在清单文件中指定哪些权限？

（扩展实际上可以在 Chrome 中运行而无需指定它们）

哪个应该是 Firefox 中的等效操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T20:59:40.890

Chrome 中的权限为：

```
"permissions": [
  "https://mail.google.com/*", "*://example.com/*"
] 
```

这确保您可以访问这两个站点。至于 Firefox，您无需指定任何内容 - Firefox 扩展始终可以访问所有网站。

# hadoop - Cassandra - Hive 集成

> ID：11850186
> 
> 赞同：4
> 
> 时间：2012-08-07T16:24:11.470
> 
> 标签：hadoop, cassandra, hive

集成 Cassandra 和 Hive 的最佳实践是什么？

[Stackoverflow（ Cassandra 与 Hive](https://stackoverflow.com/questions/5935787/cassandra-wih-hive) ）上的一个老问题指向 Brisk，它现在已成为仅限订阅的 Datastax Enterprise 产品。

谷歌搜索只指向两个开放的 jira 问题，

*   [https://issues.apache.org/jira/browse/CASSANDRA-4131](https://issues.apache.org/jira/browse/CASSANDRA-4131)
*   [https://issues.apache.org/jira/browse/HIVE-1434](https://issues.apache.org/jira/browse/HIVE-1434)

但它们都没有导致在两个项目之一中提交任何代码。

集成 Cassandra 和 Hive 修补 Cassandra/Hive 源代码的唯一方法是什么？您在堆栈中使用哪种解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T16:54:23.797

Datastax 目前有一个[用于 Hive 的开源 Cassandra 存储处理程序。](https://github.com/riptano/hive)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T05:35:23.473

一个月前我做了同样的研究，得出了同样的结论。Brisk 不再作为社区下载提供，除了修补 Cassandra/Hive 代码之外，在 Cassandra 数据库中抛出 map/reduce 作业的唯一方法是使用 DSE——Datastax Enterprise，我相信它可以免费用于任何用途，但生产集群。

您可能会看一下基于[HDFS的](http://hadoop.apache.org/hdfs/)[HBase](http://hbase.apache.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-11T10:49:27.187

这是一个带有 cassandra 2.0 和 hadoop 2 的 git de cassandra hive 驱动程序， [https://github.com/2013Commons/hive-cassandra](https://github.com/2013Commons/hive-cassandra)

和其他 cassandra 1.2

[https://github.com/dvasilen/Hive-Cassandra/tree/HIVE-0.11.0-HADOOP-2.0.0-CASSANDRA-1.2.9](https://github.com/dvasilen/Hive-Cassandra/tree/HIVE-0.11.0-HADOOP-2.0.0-CASSANDRA-1.2.9)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-27T14:49:33.293

您可以使用集成框架或集成套件来解决此问题。请查看我的演示文稿“ [Hadoop 之外的大数据 - 如何集成您的所有数据](http://www.kai-waehner.de/blog/2013/04/26/slides-from-nosqlmatters-big-data-beyond-apache-hadoop-how-to-integrate-all-your-data-with-apache-camel-and-talend/)”，了解有关如何将开源集成框架和集成套件与 Hadoop 一起使用的更多信息。

例如，Apache Camel（集成框架）和 Talend Open Studio for Big Data（集成套件）是两个开源解决方案，为 Cassandra 和 Hadoop 提供连接器。

# perl - 为什么我的 Perl CGI 程序返回服务器错误？

> ID：11850192
> 
> 赞同：4
> 
> 时间：2012-08-07T16:24:25.790
> 
> 标签：perl, apache2, cgi, cgi-bin

我最近开始学习 cgi，并在 vbox 中设置了一个 Ubuntu 服务器。我编写的第一个程序是在 Python 中通过 ssh 使用 vim。然后我在我的 Windows 7 工作站上安装了 Eclipse 并创建了完全相同的 Perl 文件；只是一个简单的 hello world 交易。

我尝试运行它，我得到了 500，而同一目录 (/usr/lib/cgi-bin) 中的 Python 代码显示正常。沮丧的是，我检查并三重检查了权限，并且它以 #!/usr/bin/perl 开头。我还检查了 AddHandler 是否设置为 .pl。一切都设置得很好，一时兴起，我决定使用 vim 在服务器中编写与 Python 文件相同的完全相同的代码。

瞧，它奏效了。我比较了它们，以为我疯了，它们完全一样。那么，有什么关系呢？为什么在 Eclipse 上的 Windows 7 中创建的文件与使用 vim 在 Ubuntu 服务器中创建的文件不同？它们是否有不同的二进制标头或其他东西？这真的会影响我的开发环境。

```
#!/usr/bin/perl
print "Content-type: text/html\n\n";
print "Testing."; 
```

阿帕奇错误日志：

```
[Tue Aug 07 12:32:02 2012] [error] [client 192.168.1.8] (2)No such file or directory:     exec of '/usr/lib/cgi-bin/test.pl' failed
[Tue Aug 07 12:32:02 2012] [error] [client 192.168.1.8] Premature end of script headers: test.pl
[Tue Aug 07 12:32:02 2012] [error] [client 192.168.1.8] File does not exist: /var/www/favicon.ico 
```

这是我得到的持续错误。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-07T17:38:51.747

`\r`我认为当您在 Windows 中编写 Perl 脚本时，您的 Perl 脚本的第一行中有一些虚假字符。

例如，我在 Windows 上创建了以下文件：

```
#!/usr/bin/perl

code goes here 
```

当使用 hexdump 查看时，它显示：

```
00000000 23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0d   |#!/usr/bin/perl.|
00000010 0a 0d 0a 63 6f 64 65 20 67 6f 65 73 20 68 65 72 |...代码去她|
00000020 65 0d 0a |e..|
00000023

```

请注意我在其中标出的`0d`- 。`\r`如果我尝试使用它运行它，`./test.pl`我会得到：

```
zsh: ./test.pl: 错误的解释器: /usr/bin/perl^M: 没有这样的文件或目录

```

而如果我在 UNIX 机器上用 Vim 编写相同的代码，我会得到：

```
00000000 23 21 2f 75 73 72 2f 62 69 6e 2f 70 65 72 6c 0a |#!/usr/bin/perl.|
00000010 0a 63 6f 64 65 20 67 6f 65 73 20 68 65 72 65 0a |.code 在这里。|
00000020

```

您可以通过以下几种方式之一解决此问题：

1.  您可能可以让您的编辑器保存“UNIX 行尾”或类似内容。
2.  保存后您可以在文件上运行`dos2unix`或类似操作
3.  您可以使用 sed:`sed -e 's/\r//g'`或类似的。

您的 apache 日志应该能够确认这一点（如果他们没有在您的开发服务器上稍微提高日志记录）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:58:52.367

当然可以。

*   一个环境可能安装了另一个可能没有的模块。
*   Perl 可能安装在两个环境中的不同位置。
*   环境可能有不同版本的 Perl。
*   环境可能具有不同的操作系统。
*   权限可能在其中一种环境中设置不正确。
*   ETC

但是，与其像这样疯狂地推测，为什么不检查错误日志以了解您实际遇到的错误？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:50:07.470

不，它们只是文本文件。当然，可以通过使用`system()`或其他依赖于环境的类似服务来编写不可移植的程序。

# postgresql - SQL 状态：“11”处或附近出现 42601 语法错误

> ID：11850194
> 
> 赞同：2
> 
> 时间：2012-08-07T16:24:40.683
> 
> 标签：postgresql, datetime, plpgsql, dynamic-sql

我有一个表`address_all`，它被几个地址表继承。`address_history`从父表继承`history_all`并保留当前地址信息。我正在创建继承`address_all`表并将信息从新表复制`address_history`到新表的新表。

我的存储过程如下所示。当我调用它时，我遇到了一些错误。为了更好地解释错误，我使用了行号。

```
1  CREATE OR REPLACE FUNCTION somefunc()
2  RETURNS void AS
3  $BODY$
4  DECLARE
5   year_id INTEGER;
6   month_id INTEGER;
7   week_id INTEGER;
8   addresstablename text; 
9   backupdays text;
10 BEGIN
11  week_id := EXTRACT(DAY FROM TIMESTAMP 'now()');
12  month_id := EXTRACT(MONTH FROM TIMESTAMP 'now()');
13  year_id := EXTRACT(YEAR FROM TIMESTAMP 'now()');
14  addresstablename := 'address_history_' || week_id || '_' || month_id || '_' || year_id;
15  backupdays:= date_trunc('hour',CURRENT_TIMESTAMP - interval '7 days');
16  EXECUTE 'create table ' || addresstablename || '() INHERITS (address_all)';
17  EXECUTE 'insert into ' || addresstablename || ' select * from address_history where address_timestamp >= ' || backupdays || ''; --AS timestamp without time zone);  
18 END;
19 $BODY$
20 LANGUAGE 'plpgsql' VOLATILE; 
```

当我运行时：

```
select somefunc() 
```

我收到此错误：

```
ERROR:  syntax error at or near "12"
LINE 1: ...story where address_timestamp >= 2012-07-31 12:00:00-0...
                                                         ^
QUERY:  insert into address_history_7_8_2012 select * from address_history where address_timestamp >= 2012-07-31 12:00:00-04
CONTEXT:  PL/pgSQL function "somefunc" line 14 at EXECUTE statement

 ********** Error **********

ERROR: syntax error at or near "12"
SQL state: 42601
Context: PL/pgSQL function "somefunc" line 14 at EXECUTE statement 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T17:05:13.193

试试这个大大简化的形式：

```
CREATE OR REPLACE FUNCTION somefunc()
  RETURNS void AS
$func$
DECLARE
 addresstablename text := 'address_history_' || to_char(now(), 'FMDD_MM_YYYY');

BEGIN
 EXECUTE 
 'CREATE TABLE ' || addresstablename || '() INHERITS (address_all)';

 EXECUTE
 'INSERT INTO ' || addresstablename || '
  SELECT *
  FROM   address_history
  WHERE  address_timestamp >= $1'
 USING date_trunc('hour', now() - interval '7 days');

END
$func$ LANGUAGE plpgsql; 
```

### 要点：

*   您可以在声明时在 plpgsql 中分配变量。简化代码。

*   用于[`to_char()`](http://www.postgresql.org/docs/current/interactive/functions-formatting.html#FUNCTIONS-FORMATTING-TABLE)格式化您的日期。简单得多。

*   `now()`并`CURRENT_TIMESTAMP`做同样的事情。

*   如果您想要当前时间戳，请不要引用`'now()'`，使用（不带引号）。`now()`

*   使用该[`USING`子句 with`EXECUTE`](http://www.postgresql.org/docs/current/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)，因此您不必转换`timestamp`to`text`和 back - 可能会像您一样遇到**引用**问题。更快、更简单、更安全。

*   在`LANGUAGE plpgsql`,`plpgsql`是一个关键字，不应被引用。

*   您可能想检查表是否已经存在[`CREATE TABLE IF NOT EXISTS`](http://www.postgresql.org/docs/current/interactive/sql-createtable.html)，自 PostgreSQL 9.1 起可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:27:53.683

显然您需要引用backupdays，否则它不会被视为解析时间戳的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:07:32.927

您正在使用字符串操作构建 SQL，因此您必须像使用任何其他语言一样正确引用所有内容。您[需要了解一些功能](http://www.postgresql.org/docs/current/interactive/functions-string.html#FUNCTIONS-STRING-OTHER)：

*   `quote_ident`: 引用一个标识符，例如表名。
*   `quote_literal`: 引用一个字符串以用作字符串文字。
*   `quote_nullable`: 一样，`quote_literal`但也可以正确处理 NULL。

这样的事情会更好地为您服务：

```
EXECUTE 'create table ' || quote_ident(addresstablename) || ...
EXECUTE 'insert into '  || quote_ident(addresstablename) || ... || quote_literal(backupdays) ... 
```

在您的情况下，这些`quote_ident`电话不是必需的，但它们是一个好习惯。

# objective-c - 将 YouTube 视频嵌入墙壁

> ID：11850195
> 
> 赞同：0
> 
> 时间：2012-08-07T16:24:50.677
> 
> 标签：objective-c, ios, youtube

我有一个应用程序，它有一面墙，其中可以有文本和 YouTube 链接。我想要做的是检测该视频是否来自 YouTube，这并不难，但另一部分是在应用程序内播放它，而不是退出它。我觉得很难做到。

我应该查看 UIWebView，还是只会播放所有视频？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:39:29.347

如果您在 uiwebview 中打开 youtube 链接，这将为您提供适当的体验。

为此，请创建一个 webview 并以模态方式（或在 navigationController 中）显示它。然后将带有 youtube 链接的 URL 请求发送到 webview。然后，您将不得不手动或自动关闭 web 视图。

在 UIWebView和[UIWebView 模态 YouTube 播放器“完成”按钮操作](https://stackoverflow.com/questions/5959367/uiwebview-modal-youtube-player-done-button-action)中查看[YouTube 视频](https://stackoverflow.com/questions/7539214/youtube-video-in-uiwebview)。

# c# - property.GetValue(dynamictype,null) 抛出 RuntimeBinderException

> ID：11850198
> 
> 赞同：0
> 
> 时间：2012-08-07T16:25:04.600
> 
> 标签：c#, dynamic

我有一个动态类型对象，我想从对象中获取每个属性的所有值。

```
dynamic row = .... 
```

我正在使用`property.GetValue(row, null)`抛出一个 RuntimeBinderException。如何检索此值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:51:56.170

这将遍历所有*公共属性*：

```
 dynamic something = new {id = "1", name = "name"};
    Type type = something.GetType();
    var properties = type.GetProperties();
    foreach (var property in properties)
    {
        var value = property.GetGetMethod().Invoke(something, null);
        Console.WriteLine(string.Format("{0}:{1}", property.Name, value));
    } 
```

# ruby-on-rails - form_for 在 Rails 3 中无法正常工作

> ID：11850200
> 
> 赞同：0
> 
> 时间：2012-08-07T16:25:09.047
> 
> 标签：ruby-on-rails, ruby-on-rails-3

嗨，我有一个简单的应用程序，我使用 form_for 助手创建了一个表单。提交时，当我尝试在触发的操作中访问模型对象时，我没有正确获取其中的所有信息。一些属性变为空白。我已经花了几个小时来尝试调试问题，但无济于事。任何帮助将不胜感激。导轨 3.2 红宝石 1.9.2

表单代码是：signup.html.erb

```
<%= form_for (@user) , :url => { :action => "signup" ,:method=>"post"} do |u| %>
  <p>
    <%= u.label :login %>
    <%= u.text_field :login ,:size => 20 %>
  </p>
  <p>
    <%= u.label :password %>
    <%= u.text_field :password,:size => 20 %>
  </p>
  <p>
    <%= u.label :password_confirmation %>
    <%= u.text_field :password_confirmation,:size => 20 %>
  </p>
  <p>
    <%= u.label :email %>
    <%= u.text_field :email ,:size => 20 %>
  </p>
  <%= u.submit %>
<% end %> 
```

user_controller.rb 的“注册”操作的代码是

```
 def signup

      @user = User.new(params[:user])

       if request.post?  

        if @user.save!

          session[:user] = User.authenticate(@user.login, @user.password)
          flash[:message] = "Signup successful"
          redirect_to :action => "index"          
        else

          flash[:warning] = "Signup unsuccessful"
        end
      end

    end 
```

当我单击提交按钮时，出现以下错误

```
 ActiveRecord::RecordInvalid in UserController#signup

Validation failed: Password can't be blank, Password doesn't match confirmation

Rails.root: /Users/kabir/ror/mmeter1
Application Trace | Framework Trace | Full Trace

app/controllers/user_controller.rb:42:in `signup'

Request

Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"yTC5i0HKltD4z40f0AQhir58CF9Pz+19VnKi3lvT6aE=",
 "user"=>{"login"=>"abcde",
 "password"=>"123456",
 "password_confirmation"=>"123456",
 "email"=>"abcde@kk.com"},
 "commit"=>"Create User",
 "method"=>"post"} 
```

用户的模型验证是

```
 validates_presence_of :login, :email, :password, :password_confirmation, :salt
  validates_uniqueness_of :login, :email
  validates_confirmation_of :password 
```

在提交之前为表单生成的源代码是

```
<form accept-charset="UTF-8" action="/user/signup?method=post" class="new_user" id="new_user" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="yTC5i0HKltD4z40f0AQhir58CF9Pz+19VnKi3lvT6aE=" /></div>
  <p>
    <label for="user_login">Login</label>
    <input id="user_login" name="user[login]" size="20" type="text" />
  </p>
  <p>
    <label for="user_password">Password</label>
    <input id="user_password" name="user[password]" size="20" type="text" />
  </p>
  <p>
    <label for="user_password_confirmation">Password confirmation</label>
    <input id="user_password_confirmation" name="user[password_confirmation]" size="20" type="text" />
  </p>
  <p>
    <label for="user_email">Email</label>
    <input id="user_email" name="user[email]" size="20" type="text" />
  </p>
  <input name="commit" type="submit" value="Create User" />
</form> 
```

我还在 user_controller 的注册操作中记录了@user 的值，它显示了以下值

```
The user params is {"login"=>"abcde", "password"=>"123456", "password_confirmation"=>"123456", "email"=>"abcde@kk.com"}
The user object is --- !ruby/object:User
attributes:
  id: 
  username: 
  password: 
  created_at: 
  updated_at: 
  login: abcde
  hashed_password: !binary |-
    MzFiNDk4MGRmMTU2OTEwOThhNDdkYzNjOTZhOTFjYWFiOTVkN2NiOA==
  email: abcde@kk.com
  salt: tgCV8xIfxS 
```

请注意，用户名和密码字段变为空白。任何帮助表示赞赏。

这是模型代码

```
 class User < ActiveRecord::Base
 # prevent the following fields from being updated through a post
 # request. ie, these fields cannot be updated as a result of a form
 # submittion. They can only be updated from within the model itself.
  attr_protected :id, :salt
  attr_accessible :login,:password,:password_confirmation,:email

 # set the basic validation rules for the different attributes of the user
  validates_length_of :login, :within => 3..40
 #  validates_length_of :password, :within => 5..40
  validates_presence_of :login, :email, :password, :password_confirmation, :salt
  validates_uniqueness_of :login, :email
  validates_confirmation_of :password
 #  validates_format_of :email, :with => /^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i, :message => "Invalid email" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:44:32.617

第一件事。id 为空，因为对象尚未保存。用户名是空白的，因为您在表单中将其称为登录。由于您有一个登录字段，我建议您只删除用户名，或将表单中的登录字段重命名为用户名，然后删除登录字段。确保使用数据库迁移来删除该列：

```
 rails g migration remove_username_from_users 
```

然后在迁移代码中

```
 def up
   remove_column :users, :username
 end

 def down
   add_column :users, :username, :string
 end 
```

现在，对于密码列，您是否使用 attr_accessible 设置白名单？请发布您的型号代码。我问，因为它可能不允许大量分配密码，所以它没有被设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-10T11:46:15.070

你没有发布你的整个模型（它缺少一个结尾），你确定你没有额外的代码吗？密码已存储在 hashed_pa​​ssword 中并从 password 和 password_confirmation 中删除，并且某些方法正在这样做。那是因为使用这两个字段是不安全的，因为它们是明文。

因此，无论是在您的模型中，还是包含的 gem 都会改变用户的保存，这会破坏您的验证。

也许您使用了此页面中的代码？

[http://www.napcsweb.com/blog/2010/03/11/basic-authentication-in-ruby-on-rails-in-case-you-forgot/](http://www.napcsweb.com/blog/2010/03/11/basic-authentication-in-ruby-on-rails-in-case-you-forgot/)

并提示：在您的表单中使用 password_fields 而不是 text_fields ...

# jquery - jQuery标题属性到文本框

> ID：11850202
> 
> 赞同：2
> 
> 时间：2012-08-07T16:25:17.340
> 
> 标签：jquery

我是 jquery 的新手。我的应用程序中有一个链接列表。我希望能够获取任何链接的标题属性，并在单击链接时将其放在页面上的文本框中。这是我到目前为止所得到的，但它不起作用：

```
 <p><a href="#" title="text I want to get">Link 1</a></p>
 <p><a href="#" title="more text I want to get">Link 2</a></p>
 <p><input id="myTextBox" type="text">​&lt;/p>

$("a").attr("title").click(function () {
$('#myTextBox').attr($(this).attr());
}); 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:27:27.283

您有很多正确的关键字，但它们的连接并不完全正确。例如，`.attr()`getter 是不可链接的。

这将获取所有具有标题的链接并将点击处理程序添加到它们：

```
$('a[title]').on('click', function(){ 
  $('#myTextBox').val( $(this).attr('title') );
  //                            ^^ this returns a string and passes it to .val()
}); 
```

单击时，文本框的值将替换为链接的标题属性值。

这可能会更冗长一些。如果您是新手，我建议您最初编写类似这样的内容，因为它使调试变得更加容易。一旦您对 jQuery 的处理方式更加熟悉，更密集的链式方法将更加自然。

```
$('a[title]').on('click', function(){ 
  var $link = $(this);
  var titleText = $link.attr('title');
  var $textbox = $('#myTextBox');
  $textbox.val(titleText);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:35:18.230

我可以在一定程度上看到导致您生成此内容的逻辑，但我强烈建议您阅读[文档](http://docs.jquery.com)和[API 参考](http://api.jquery.com)，以便您更好地了解要做什么。

也就是说，这应该为您解决问题：

```
$('p').on('click', 'a', function(){
    var title = $(this).attr('title');
    $("#myTextBox").val( title );
}); 
```

一个解释，这样你就可以了解这里发生了什么：

`click()`我没有使用 ，而是使用`on()`，它代表事件而不是将它们附加到特定事件。因此，如果它检测到任何元素上的单击事件`p`，并且只要该元素的目标是该给定元素内的`a`元素*，*`p`它就会执行处理程序。

然后，我们将`title`点击链接的属性值赋给变量`title`。

然后我们只需将`value`输入的属性设置为所述标题变量，瞧。

祝你好运！

# python - cherrypy 作为 gevent-socketio 服务器

> ID：11850203
> 
> 赞同：1
> 
> 时间：2012-08-07T16:25:20.810
> 
> 标签：python, socket.io, cherrypy, gevent

我刚开始使用`gevent-socketio`，非常棒！

但我一直在使用默认设置`socketioserver`和`socketio_manage`聊天教程，想知道如何`socketio`与`cherrypy`.

本质上，我该如何转换：

```
class MyNamespace(BaseNamespace):...

def application(environ, start_response):
    if environ['PATH_INFO'].startswith('/socket.io'):
        return socketio_manage(environ, { '/app': MyNamespace})
    else:
        return serve_file(environ, start_response)

def serve_file(...):...

sio_server = SocketIOServer(
    ('', 8080), application, 
    policy_server=False) sio_server.serve_forever() 
```

变成正常`cherrypy server`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T14:06:14.640

Gevent-socketio 基于 Gevent，以及 Gevent 的 web 服务器。有两种实现：pywsgi，纯python，wsgi，使用libevent的http实现。

请参阅此处以“pywsgi.WSGIServer 和 wsgi.WSGIServer 之间的区别”开头的段落：

[http://www.gevent.org/servers.html](http://www.gevent.org/servers.html)

只有那些服务器是“绿色的”，因为它们将控制权交给了 Gevent 循环......所以你只能使用那些服务器 afaik。这样做的原因是服务器在请求的最开始就存在，并且会知道如何处理“升级”和 websockets 协议协商，并且它将在下一层（SocketIO）的“环境”内传递值会期望并知道如何处理。

您还需要使用 gevent-websocket 包。因为它是绿色的（而 gevent-socketio 是基于该包的）。您不能只交换 websocket 堆栈。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T07:05:41.203

CherryPy 不实现 socket.io 协议，也不支持内置 WebSocket。但是，CherryPy 有一个扩展名为[ws4py](https://github.com/Lawouach/WebSocket-for-Python)，它仅在其堆栈顶部实现裸 WebSocket 协议。你可能可以从那里开始。

# php - PHP mysql REGEXP 准备好的语句

> ID：11850205
> 
> 赞同：1
> 
> 时间：2012-08-07T16:25:26.320
> 
> 标签：php, mysql, regex, prepared-statement

我对 MYSQL 和准备好的语句很陌生。我有一些查询需要更改为准备好的语句。问题在于这个 REGEXP 查询：

```
$objects = mysql_query("SELECT * FROM $table WHERE parent REGEXP ',". 
    $item .",|^". $item .",|,". $item ."\$|^". 
    $item ."\$'") or die(mysql_error()); 
```

您如何将其转换为带有占位符的准备好的声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T21:21:58.843

您应该在准备好的语句查询中使用 CONCAT 函数，而不是使用经典的 . 常规查询的连接符号。这应该可以解决问题:)

# c# - 如何保证 CancellationTokens 是最新的？

> ID：11850207
> 
> 赞同：6
> 
> 时间：2012-08-07T16:25:32.360
> 
> 标签：c#, .net, multithreading, task-parallel-library, cancellation-token

Microsoft在 .NET 4 中给出了这个使用示例[。](http://msdn.microsoft.com/en-us/library/dd997396)`CancellationToken`

```
using System;
using System.Threading;
using System.Threading.Tasks;
class Program
{
    static void Main()
    {

        var tokenSource2 = new CancellationTokenSource();
        CancellationToken ct = tokenSource2.Token;

        var task = Task.Factory.StartNew(() =>
        {

            // Were we already canceled?
            ct.ThrowIfCancellationRequested();

            bool moreToDo = true;
            while (moreToDo)
            {
                // Poll on this property if you have to do
                // other cleanup before throwing.
                if (ct.IsCancellationRequested)
                {
                    // Clean up here, then...
                    ct.ThrowIfCancellationRequested();
                }

            }
        }, tokenSource2.Token); // Pass same token to StartNew.

        tokenSource2.Cancel();

        // Just continue on this thread, or Wait/WaitAll with try-catch:
        try
        {
            task.Wait();
        }
        catch (AggregateException e)
        {
            foreach (var v in e.InnerExceptions)
                Console.WriteLine(e.Message + " " + v.Message);
        }

        Console.ReadKey();
    }
} 
```

但是，[我的理解](https://stackoverflow.com/a/11748507/546561)是，如果在一个线程上修改了变量，由于缓存，另一个线程可能无法获得修改后的值。并且由于在`CancellationToken`主线程上取消了，线程如何`Task`确保`CancellationToken`它正在检查实际上是最新的？

为什么不能`Task`读取令牌的缓存值？

**注意：**我提出这个问题的动机是想知道我是否需要`CancellationToken`将实例变量设置为`volatile`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-07T16:28:47.897

这是在内部处理的`CancellationTokenSource`。用于跟踪 CTS 状态的私有变量被标记为[volatile](http://msdn.microsoft.com/en-us/library/x13ttww7.aspx)，这可以防止内部状态检查过时。

> 我提出这个问题的动机是想知道我是否需要我的 CancellationToken 实例变量是可变的。

您不需要这样做，因为检查是在内部处理的，并且已经为您正确处理。

基本上，当您从 中创建 a 时`CancellationToken`，`CancellationTokenSource`令牌包含对原始源的引用。这个引用永远不会改变，所以调用`ThrowIfCancellationRequested`内部检查源的状态。由于源状态是它本身`volatile`，它永远不是“陈旧”的数据。

# c# - 如何实现动态本地化asp net

> ID：11850209
> 
> 赞同：3
> 
> 时间：2012-08-07T16:25:37.440
> 
> 标签：c#, asp.net-mvc, localization

我正在尝试提出动态本地化 asp net mvc 网站的最佳方法。作为网站的管理员，应该能够随时更改任何语言的任何字符串，而无需重新编译。我开始认为使用 SQL 是个好主意，但这会严重影响性能。

我的另一个想法是将本地化存储在 xml 文件中，然后根据需要从它们中读取。但是，我不知道从哪里开始。我已经看到了一些关于如何使用资源文件执行此操作的指南，但这些指南是编译的，不能即时编辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:53:28.923

我认为[这篇](http://www.hanselman.com/blog/GlobalizationInternationalizationAndLocalizationInASPNETMVC3JavaScriptAndJQueryPart1.aspx)文章可能对你有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:14:57.267

虽然我没有亲自使用它，但请看一下 Rick Strahl（微软 MVP）的 [http://www.west-wind.com/weblog/posts/2009/Apr/01/Updated-WestwindGlobalization-Data-Driven -Resource-Provider-for-ASPNET](http://www.west-wind.com/weblog/posts/2009/Apr/01/Updated-WestwindGlobalization-Data-Driven-Resource-Provider-for-ASPNET)它可能非常适合您的需求。

它在 NuGet 上可用[http://nuget.org/packages/Westwind.Globalization](http://nuget.org/packages/Westwind.Globalization)。

另外值得注意的是这个页面涵盖了对 MVC 的支持[http://www.west-wind.com/westwindwebtoolkit/Docs/index.htm?page=_2r1166lmq.htm](http://www.west-wind.com/westwindwebtoolkit/Docs/index.htm?page=_2r1166lmq.htm)

# c# - 在 MVC3、C# 中使用视图模型中的新数据更新视图

> ID：11850210
> 
> 赞同：1
> 
> 时间：2012-08-07T16:25:47.820
> 
> 标签：c#, asp.net-mvc-3, view, model

我在控制器中有 ajax 动作调用，在它更新数据库并成功完成后，我可以这样做：

```
return PartialView("Overview", mydatamodel); 
```

然后在成功中这样做：

```
success: function (data) { 
            // do something with the data => refresh some
            // portion of your DOM
            $('#someDivId').html(data);
        } 
```

它可以正常工作，但我需要的是要更新视图模型中的集合，并使用新数据再次渲染整个视图。

我可以这样做，例如我有提交按钮，然后用新数据更新整个视图，但是如果我有 ajax 调用，我该怎么做。

这是我以前的帖子的链接，其中有更多详细信息： [MVC3 在提交后接收新模型数据](https://stackoverflow.com/questions/11849616/mvc3-receiving-the-new-model-data-after-submit)

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:27:40.283

如果要更新整个视图，请不要使用 AJAX。只需使用提交按钮。AJAX 的全部意义在于只更新视图的一部分而不离开当前页面。

顺便说一句，您可以使用以下方式在客户端重定向`window.location.href`：

```
success: function (data) { 
    window.location.href = '@Url.Action("Overview", "SomeController")';
} 
```

但如果您总是在成功的 AJAX 回调中重定向，则确实没有必要这样做。在这种情况下，您不应该使用 AJAX。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T16:31:00.617

您通常将 AJAX 准确地用于只希望在请求完成后更新部分视图的情况。

如果您出于某种原因需要在这种情况下使用 AJAX（例如，使用`DELETE`HTTP 动词发送请求），您可能会执行类似的操作

```
window.location.href = '/Items/123'; 
```

在您的`success`回调函数中，这有效地触发了整页更新。

# menu - 减小表达式引擎中发布菜单的大小

> ID：11850212
> 
> 赞同：0
> 
> 时间：2012-08-07T16:25:51.220
> 
> 标签：menu, expressionengine

我对ee很陌生。我有一个使用它构建的网站，但它不是一个传统的网站。只有一个页面，所有内容都围绕该页面存在，使用 jquery 滚动导航。

我想建立一个常规站点：

```
Page structure - 
           home
           about
           Services
                   Web design
                   Photography
                   graphic Design
           Portfolio
           Contact 
```

我要避免的是在发布下拉菜单中有大量频道字段列表（就像我以前的网站上一样）

如何最好地组织渠道？我试图了解页面模块，但我仍然会有大量未组织的频道条目。

我认为拥有一个名为“Pages”的频道是最好的开始。然后是每个页面的通道字段。好的....但是我需要为每个页面的每个部分创建大量的字段条目：

```
Pages ->
     Home 
     Home page featured image
     Home page left column
     home page right column
     About
     About featured image
     about main content
     Services featured image
     Services main content
     Web design featured image 
     Web Design main content
     Photography featured image
     Photography main content 
```

但我想要的是树结构再有两个层次

```
Pages ->
     Home ->
             Home page featured image
             Home page left column
             home page right column
     About ->
             About featured image
             about main content
     Services ->         
             Services featured image
             Services main content
                      Web Design ->
                                   Web design featured image 
                                   Web Design main content
                      Photography ->
                                   Photography featured image
                                   Photography main content 
```

有什么建议或想法吗？当我想点击一个页面并将该页面的所有字段放在一起时，我是否应该忍受大量的频道字段，以便主页特色图片、主页左栏和主页右栏是所有从同一条目同时编辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-15T13:56:25.907

不确定我是否完全理解您的问题，但我猜您在后端和前端构建导航时遇到问题？

[http://devot-ee.com/add-ons/zoo-flexible-admin](http://devot-ee.com/add-ons/zoo-flexible-admin)这个插件允许您重新构建控制面板菜单以适应不同的用户组。因此，您可以根据需要对发布频道导航进行分组，并将其缩小到任意大小。因此，您可以调用导航“编辑主页”并在下拉菜单中拥有所有相应的频道。

我还使用这个插件在前端[http://devot-ee.com/add-ons/navee上通过导航来构建](http://devot-ee.com/add-ons/navee)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T22:59:53.610

您还可以考虑 Structure 附加组件。 [http://devot-ee.com/add-ons/structure](http://devot-ee.com/add-ons/structure)

# javascript - 在 IE 和 FIREFOX 上看不到 AS3 XML 上的 PAGEFLIP

> ID：11850213
> 
> 赞同：0
> 
> 时间：2012-08-07T16:25:55.777
> 
> 标签：javascript, html, xml, flash, actionscript

我有一个问题，我想看看是否有人可以帮助我...

我正在使用从以下网址下载的 PAGEFLIP：http://pageflip.hu/[这个](http://pageflip.hu/)项目位于 JOOMLA 文章中：[http ://estudiantes.iems.edu.mx/index.php?option=com_k2&view=item&id= 334](http://estudiantes.iems.edu.mx/index.php?option=com_k2&view=item&id=334)

我的问题是我只能在 Chrome 和 Safari 上看到 PAGEFLIP，但它不能在 IE 和 Firefox 上运行，这不是兼容性问题，因为它在 Firefox 和 IE 上本地运行...

我正在搜索，我认为当我更改 URL 时问题就出现了......这是原始代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
    <head>
        <title>PageFlip4</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="css/pageflip_scalable.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="js/swfobject.js"></script>
        <script type="text/javascript">
            var flashvars = {};
            flashvars.XMLFileName = "pageflipdata.xml";
            flashvars.DataFolder = "pageflipdata/";

            if (swfobject.getQueryParamValue("page")) {
                flashvars.StartPage = swfobject.getQueryParamValue("page");
            } else {
                flashvars.StartPage = "1";
            }

            flashvars.StartAutoFlip = "true";
            flashvars.AutoStart = "true";
            var params = {};

            params.scale = "noscale";
            params.salign = "TL";
            params.wmode = "transparent";
            params.allowscriptaccess = "always";
            params.allowfullscreen = "true";
            params.menu = "true";
            params.bgcolor = "#FFFFFF";

            var attributes = {};
            swfobject.embedSWF("pageFlip.swf", "pageflip", "100%", "100%", "10.0.0", false, flashvars, params, attributes);
        </script>
      <link rel="stylesheet" href="css/lightbox.css" type="text/css" media="screen" />      
      <script src="js/prototype.js" type="text/javascript"></script>
      <script src="js/scriptaculous.js?load=effects" type="text/javascript"></script>
      <script src="js/lightbox++.js" type="text/javascript"></script>
      <script type="text/javascript">
            function GroupDelegate(id) {
                var objLink = document.getElementById(id);
                Lightbox.prototype.start(objLink);
            }
            function LightboxDelegate(url,caption) {
                var objLink = document.createElement('a');
                objLink.setAttribute('href',url);
                objLink.setAttribute('rel','lightbox');
                objLink.setAttribute('title',caption);
                Lightbox.prototype.start(objLink);
            }
      </script>
    </head>

    <body>
        <div id="pageflip" style="margin: 0;"></div>
        <a id="group1" href="pageflipdata/pages/demo_page_A.png" rel="lightbox[demoGroup1]" title="Page A, group Called from PageFlip Hotspot"></a>
        <a id="group2" href="pageflipdata/pages/demo_page_B.png" rel="lightbox[demoGroup1]" title="Page B, group Called from PageFlip Hotspot"></a>
        <a id="group3" href="pageflipdata/pages/demo_page_C.png" rel="lightbox[demoGroup1]" title="Page C, group Called from PageFlip Hotspot"></a>     
    </body>
</html> 
```

我在 Firefox 和 IE 上看不到它当我从此 SCRIPT 行更改 URL 时（这是我的在线代码）：

```
<script type="text/javascript">

            var flashvars = {};
            flashvars.XMLFileName = "pageflipdata.xml";
            flashvars.DataFolder = "http://estudiantes.iems.edu.mx/cired/swfs/ae/fl/noumeno/obj/pageflipdata/";

            if (swfobject.getQueryParamValue("page")) {
                flashvars.StartPage = swfobject.getQueryParamValue("page");
            } else {
                flashvars.StartPage = "1";
            }

            flashvars.StartAutoFlip = "true";
            flashvars.AutoStart = "true";
            var params = {};

            params.scale = "noscale";
            params.salign = "TL";
            params.wmode = "transparent";
            params.allowscriptaccess = "always";
            params.allowfullscreen = "true";
            params.menu = "true";
            params.bgcolor = "#FFFFFF";

            var attributes = {};
            swfobject.embedSWF("http://estudiantes.iems.edu.mx/cired/swfs/ae/fl/noumeno/obj/pageFlip.swf", "pageflip", "100%", "100%", "10.0.0", false, flashvars, params, attributes);

        </script> 
```

所以，我认为不正确的是我写它的方式，一种语法问题。

有人知道我可以尝试解决什么。太感谢了！;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T15:34:57.313

尝试为 XML 提供完整路径

或者可以使用 HTML 之类的

# ruby-on-rails - rails 服务器不会运行 WEBrick

> ID：11850214
> 
> 赞同：1
> 
> 时间：2012-08-07T16:25:58.650
> 
> 标签：ruby-on-rails

我是一个新手，正在尝试遵循 Rails 教程并已成功运行来自[http://railsinstaller.org/的安装例程](http://railsinstaller.org/)

我也安装了mysql

我用过命令> rails new simple_cms -d mysql

这似乎运行成功

当我运行 Rails 服务器时

这是下面的输出 - 似乎没有在端口 3000 上启动 WEBrick

非常感谢

================

> /usr/local/rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.3.11/lib/mysql2.rb:9:in '来自 /usr/local/rvm/gems/ruby-1.9.3 -p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in block (2 levels) in require' from /usr/local/rvm/gems/ruby-1.9.3-p194@ global/gems/bundler-1.1.5/lib/bundler/runtime.rb:66:in block in require' 来自 /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1 .5/lib/bundler/runtime.rb:55:in 需要'来自 /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler.rb： 119:in '来自 /usr/local/rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.7/lib/rails/commands.rb:53:in 块来自 /usr/local/ rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.7/lib/rails/commands.rb:50:in `require': dlopen(/usr/local/rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle, 9): Library not loaded: libmysqlclient.18.dylib (LoadError)
> Referenced from: /usr/local/rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle Reason: image not found - /usr/local/rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.3.11/lib/mysql2/mysql2.bundle from /usr/local/rvm/gems/ruby-1.9.3-p194/gems/mysql2-0.3.11/lib/mysql2.rb:9:in` `require' from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:68:in` `each' from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:66:in` `each' from /usr/local/rvm/gems/ruby-1.9.3-p194@global/gems/bundler-1.1.5/lib/bundler/runtime.rb:55:in` `require' from /Users/amelrose/Sites/simple_cms/config/application.rb:7:in``require' from /usr/local/rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.7/lib/rails/commands.rb:53:in` `tap' from /usr/local/rvm/gems/ruby-1.9.3-p194/gems/railties-3.2.7/lib/rails/commands.rb:50:in` '来自脚本/rails:6:in `require' from script/rails:6:in`'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:57:55.837

我有同样的问题。因为在 Mac OS X 上，mysql 通常`/usr/local/mysql`安装`libmysqlclient`在`/usr/lib`.

在终端中运行它：

```
sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib 
```

# mysql - mysql IF EXISTS 返回错误

> ID：11850215
> 
> 赞同：0
> 
> 时间：2012-08-07T16:26:01.433
> 
> 标签：mysql

> **可能重复：**
> [MySQL：如果列不存在，如何添加？](https://stackoverflow.com/questions/3242080/mysql-how-to-add-a-column-if-it-doesnt-already-exist)

我使用的一个工具正在运行这个查询，但它失败了。我正在尝试帮助调试，但无法找出问题所在：

```
IF EXISTS( SELECT NULL FROM INFORMATION_SCHEMA.COLUMNS 
WHERE table_name = 'TOWNY_RESIDENTS' 
AND table_schema = 'minecraft'
AND column_name != 'town-ranks') 
THEN
ALTER TABLE TOWNY_RESIDENTS (ADD 
`town-ranks`  mediumtext,
`nation-ranks`  mediumtext
); 
```

内部选择查询工作正常。似乎 if exists 语法是错误的，但我不知道怎么做。像这样的网站上的例子显示了类似的想法......

错误是：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'IF EXISTS( SELECT NULL FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name = 'TOW' at line 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:44:19.987

`ALTER TABLE``IF EXISTS`在 MySQL中不支持。您可以运行您的`ALTER TABLE`语句并忽略由此产生的错误。

另一种选择是`SELECT INTO OUTFILE`在 information_schema 上执行以在必要时生成`ALTER TABLE`语句，然后获取该文件以执行该`ALTER TABLE`语句。

# wpf - 在 DataGrid 的单元格中设置 TextTrimming (CharacterEllipsis)

> ID：11850217
> 
> 赞同：6
> 
> 时间：2012-08-07T16:26:21.477
> 
> 标签：wpf, wpfdatagrid

我想将 TextTrimming 属性 (CharacterEllipsis) 应用于 WPF DataGrid 单元格中的文本。

![没有设置 TextTrimming 的 DataGrid 单元格](../Images/3b3ff02c4105dfb2aa5866bc76296a6a.png)

[我在这个答案](https://stackoverflow.com/questions/3671608/wpf-datagrid-how-do-i-set-columns-to-textwrap)（下面的代码）中应用了自定义 DataGridCell 模板，它运行良好，除了图中第一个超链接列）现在是空的。

![在文本列上设置了 TextTrimming，但缺少超文本列内容](../Images/cc4d58b07d6ca425b7d5336fcfc895c7.png)

```
<Style TargetType="DataGridCell">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type DataGridCell}">
                <Border Padding="3" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
                    <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
                        <ContentPresenter.ContentTemplate>
                            <DataTemplate>
                                <TextBlock TextTrimming="CharacterEllipsis" Text="{Binding Text}"/>
                            </DataTemplate>
                        </ContentPresenter.ContentTemplate>
                    </ContentPresenter>
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

我可以在视觉树中看到两种列类型的区别： ![可视化树中的数据网格行（未应用自定义模板时）](../Images/373ec775143c00774f67bebae8c07601.png)

但不明白如何使用此信息将 TextTrimming 应用于 TextBlock 的两种类型的列。谢谢你的时间 ;）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T13:54:52.290

I finally ended up with the following solution (more like a workaround, but it works fine):

1) I assigned an **x:Key** to the style in question and applied it as a **CellStyle** to all DataGridTextColumns that should have their contents trimmed and ellipsisized whenever they don't fit

2) To apply ellipsis trimming in DataGridHyperlinkColumns, in **App.xaml** I added the following style:

```
<Style TargetType="{x:Type TextBlock}">
    <Setter Property="TextTrimming" Value="CharacterEllipsis"></Setter>
</Style> 
```

which will apply to all implicitly generated TextBlocks (as described in [CodeNaked's answer](https://stackoverflow.com/a/5812213/889779)). This might seem a bit overkill, but I can't see much difference in rendering performance and Hyperlinks are now trimmed as expected.

# objective-c - 为什么我的 Objective-C 代码不会导致 xCode 中的错误？

> ID：11850218
> 
> 赞同：0
> 
> 时间：2012-08-07T16:26:21.147
> 
> 标签：objective-c, ios, xcode

我很困惑。我在 Finder 中复制并粘贴了 3 个文件，然后回到我的 xCode 项目中。我现在调整了 xib 并对 .h 和 .m 文件进行了相应的更改，但是这三个文件似乎没有被编译。现在我有一个明显的语法错误，但 xCode 似乎并不在意。我什至可以在模拟器中运行该应用程序。

我实际上并没有重构我现有的代码来使用新的视图控制器，但这不重要，对吧？到底是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T16:28:30.387

它们还没有被编译。

在您的项目设置中转到“构建阶段”、“编译源”，然后单击“+”

添加 .m 文件，然后它们将编译。

编辑：为了一起避免这个问题——我意识到当我向我的项目添加新文件时，我的项目在添加文件对话框中没有被选中，这就是它没有被添加到编译源列表的原因。在添加之前检查它可以防止必须手动进行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:32:48.640

就像在编译之前在@RyanG 中添加一个步骤一样，尝试从菜单产品-> 清理中清理你的代码。

# c# - 调用动态对象的方法

> ID：11850222
> 
> 赞同：1
> 
> 时间：2012-08-07T16:26:25.363
> 
> 标签：c#, vb.net, dynamic-class-creation

当两个对象都是动态创建时，如何从另一个对象方法调用/调用一个对象的方法？

情况如下：

我有两个动态创建的对象，每个对象对应一个不同的类

```
objA
   Method1A()
objB
   Method1B() 
```

我想打电话给`objA`'s `method1A()`from `objB`'s `method1B()`。

我怎样才能做到这一点/你推荐什么方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:34:34.883

为了调用某种类型的实例方法，您需要该类型的实例。因此，如果`Method1B`应该调用实例方法，则`objA`可以将此实例作为参数传递给该方法：

```
public void Method1B(ObjA objA)
{
    objA.Method1A();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-14T17:00:03.490

如果有可能“`objA`在`objB`”之后创建，那么您就有了一个循环。你现在不能用单独的程序集来解决这个问题，除非你可以避免循环声明；然后您可以在没有循环调用的情况下编译一个程序集，然后在构建其他程序集之后使用它重新编译。您可以在这里尝试相同的方法，但除非您知道周期以及可以在哪里暂时中断它们，否则您需要进行一些分析。

请注意[，这个问题](https://stackoverflow.com/q/3169942/256431)要求并获得类似于我的方法来处理普通程序集之间的循环依赖关系。

# php - PUT/DELETE 标头重定向

> ID：11850224
> 
> 赞同：0
> 
> 时间：2012-08-07T16:26:31.973
> 
> 标签：php, api, rest

我正在尝试在 PHP 中进行标头重定向，执行以下操作：

```
header("Location: http://www.domain.com/some/url");
exit; 
```

这在发出 GET 和 POST 请求时工作正常，但它似乎不适用于 PUT 和 DELETE 请求。

我试过做：

```
header("Location: DELETE/PUT http://www.domain.com/some/url");
exit; 
```

但这似乎不起作用，直接调用url也可以正常工作。我可以在标头调用之前和之后回显一些文本，所以一切正常，似乎只是忽略了 PUT 和 DELETE 请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:07:53.793

[类似的问题](https://stackoverflow.com/a/653102/1156688)，可能相同的答案适用于您

> 标头函数用于将 HTTP 响应标头发送回用户（即您不能使用它来创建请求标头。
> 
> 请问你为什么要这样做？为什么要模拟 POST 请求，因为您可以就在那儿，然后以某种方式对数据采取行动？我当然假设 script.php 驻留在您的服务器上。
> 
> 要创建 POST 请求，请使用 fsockopen() 打开与主机的 TCP 连接，然后在 fsockopen() 返回的处理程序上使用 fwrite()，并使用您在 OP 中的标头函数中使用的相同值。或者，您可以使用 cURL。

PS：我看到它也显示在`Linked`标签下:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:30:02.897

使用`Location`不是设置 HTTP 方法标头的正确方法。

尝试以下操作：

```
header("Request-Type: DELETE");
header("Location: http://www.domain.com/some/url");
exit; 
```

但是，我不确定您是否可以`header()`单独设置请求类型。我知道你可以使用 cURL。

# google-drive-api - Google Drive SDK - Php Client Library - 下载一个可以找到类的文件？

> ID：11850229
> 
> 赞同：2
> 
> 时间：2012-08-07T16:26:44.287
> 
> 标签：google-drive-api

我尝试使用此方法下载文件

```
/**
 * Download a file's content.
 *
 * @param Google_DriveService $service Drive API service instance.
 * @param File $file Drive File instance.
 * @return String The file's content if successful, null otherwise.
 */
function downloadFile($service, $file) {
  $downloadUrl = $file->getDownloadUrl();
  if ($downloadUrl) {
    $request = new Google_HttpRequest($downloadUrl, 'GET', null, null);
    $httpRequest = Google_Client::$io->authenticatedRequest($request);
    if ($httpRequest->getResponseHttpCode() == 200) {
      return $httpRequest->getResponseBody();
    } else {
      // An error occurred.
      return null;
    }
  } else {
    // The file doesn't have any content stored on Drive.
    return null;
  }
} 
```

在那里找到：[https ://developers.google.com/drive/v2/reference/files/get](https://developers.google.com/drive/v2/reference/files/get)

但我不知道在图书馆的哪里可以找到我需要包含的这两个类：

> *   **Google_HttpRequest**
> *   **Google_Client**

库：[http ://code.google.com/p/google-api-php-client/](http://code.google.com/p/google-api-php-client/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:42:54.320

在这里检查：

[http://code.google.com/p/google-api-php-client/source/browse/#svn%2Ftrunk%2Fsrc%2Fio](http://code.google.com/p/google-api-php-client/source/browse/#svn%2Ftrunk%2Fsrc%2Fio)

和

[http://code.google.com/p/google-api-php-client/source/browse/#svn%2Ftrunk%2Fsrc%253Fstate%253Dclose](http://code.google.com/p/google-api-php-client/source/browse/#svn%2Ftrunk%2Fsrc%253Fstate%253Dclosed)

# sql - 我将如何在 Linq 中执行此 SQL？

> ID：11850235
> 
> 赞同：3
> 
> 时间：2012-08-07T16:27:04.083
> 
> 标签：sql, linq-to-sql

```
 SELECT   Sum(dbo.amzOrdersItem.price) as SubTotal, 
          Sum(dbo.amzOrdersItem.shippingPrice) as ShippingTotal, 
          Sum(dbo.amzOrdersItem.price) + Sum(dbo.amzOrdersItem.shippingPrice) as OrderTotal
 FROM     dbo.amzOrders INNER JOIN
          dbo.amzOrdersItem ON dbo.amzOrders.amzOrderId = dbo.amzOrdersItem.amzOrderId
 WHERE    dbo.amzOrders.id = '14818'
 GROUP BY dbo.amzOrders.id 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:40:26.250

查询将如下所示：

```
var query =
    from order in db.amzOrders
    join item in db.amzOrdersItems on order.amzOrderId equals item.amzOrderId
    where order.Id == 14818
    group item by order.Id into g
    select new
    {
        SubTotal = g.Sum(i => i.Price),
        ShippingTotal = g.Sum(i => i.ShippingPrice),
        OrderTotal = g.Sum(i => i.Price) + g.Sum(i => i.ShippingPrice),
    }; 
```

我不确定 L2SQL 查询提供程序是否能够`OrderTotal`确定正确地翻译该行，希望它足够简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:41:51.337

也许这个（但未经测试）：

```
var result = from order in Context.amzOrders
             where order.id == '14818'

             from orderItems in Context.amzOrdersItem
               on order.amzOrderId equals orderItems.amzOrderId
             into orderItemsJoinData

             let subTotal = orderItemsJoinData.Sum( item => item.price )

             let shippingTotal = orderItemsJoinData.Sum( item => item.shippingPrice )

             select new 
             {
                 SubTotal = subTotal ,
                 ShippingTotal = shippingTotal,
                 OrderTotal = subTotal + shippingTotal
             }; 
```

# css - iOS防止位置固定元素缩放

> ID：11850237
> 
> 赞同：4
> 
> 时间：2012-08-07T16:27:15.400
> 
> 标签：css, ios, zooming, responsive-design, css-position

我有一个响应式站点的位置：固定；标题 > 导航

我希望用户能够在离开位置时放大页面内容：固定；单独的元素。这可能吗？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-15T12:42:50.027

是的，我会使用 Jquery 来解决它。有许多响应式脚本可以完成我认为您正在尝试完成的事情。试试 Zoomooz.js。您可以在 Github 或作者网站上找到它。

```
anne.aukia.com/zoomooz/
github.com/jaukia/zoomooz/zipball/master 
```

希望有帮助。

# html - css 来设计一个dashbard 模板

> ID：11850239
> 
> 赞同：0
> 
> 时间：2012-08-07T16:27:29.437
> 
> 标签：html, css

我正在尝试为我的仪表板设计和简单的 CSS 模板。喜欢顶部显示徽标和标题，左侧显示菜单，中心显示基于菜单的信息，右侧显示一些信息，底部显示一些联系信息。我喜欢页面的左/中/右侧可以垂直和水平滚动。滚动时，我需要标题始终显示在浏览器上。

有人可以帮我吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

<title>Dashboard Layout</title>
<STYLE type="text/css">
#top {
height: 100px;
widht: auto;
border-bottom: 5px solid;
}

#left {
height: auto;
width: 350px;
border: 1px solid;
float: left;
overflow: scroll;

}

#content {
width: auto;
height: auto;
float: left;
overflow: scroll;
}

#right {
height: auto;
width: 350px;
float: right;
overflow: auto;
}

#bottom {

height: 50px;
width: auto;
}

</STYLE>

</head>
<body>

<div id="top">

        <h3><b>Dashboard</b></h3>

</div>

<div id="middle">

<div id="left">

        <h3><b>Menu</b></h3>
</div>

<div id="content">

         <div id="div1" </div>

</div>

<div id="right">
        <h3><b>Definitions</b></h3>

</div>

</div>

<div id="bottom">

        <p>This dasboard prodides info about systems.</p>
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:18:46.967

要使无论您的滚动与否始终可见的 div，请使用：

```
.visibleDiv
{
    position: fixed;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:57:06.580

是的，正如 Karan 所说，您必须修复标题的位置（#top）。固定元素相对于浏览器窗口定位。

```
#top {
position: fixed;
width: 100%
top: 0;
height: 100px;
border-bottom: 5px solid;
} 
```

然后你会看到你的内容 div (#middle) 开始与标题重叠，所以你应该留出一个上边距。

```
#middle {
margin-top: 100px /* the same height as your header */
} 
```

而且因为你浮动了几个 div，我建议你在它们之后[clearfix](http://www.webtoolkit.info/css-clearfix.html)来调整父 div 的高度。

网上有很多很棒的 CSS 菜单和标题教程，所以谷歌一下吧！:]

# c# - 如何制作分页 ListView？

> ID：11850244
> 
> 赞同：0
> 
> 时间：2012-08-07T16:27:40.407
> 
> 标签：c#, mvvm, microsoft-metro

我有一长串项目，我需要在 ListView 中显示它们。然后我需要页面使用计时器自动旋转。做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:27:40.407

（Windows 8 风格的 UI/Metro 应用程序）

在您的视图中：将 {Binding PagedItems} 添加到 ListView 的 ItemSource 属性中。

在您的视图模型中：

```
public class ViewModel : INotifyPropertyChanged {

    public ObservableCollection<Item> PagedItems {get;set;}
    private DispatcherTimer _timer;

    private ObservableCollection<Item> _itemsToPage;
    private int _itemsPerPage;
    private int _currentPage;

    public ViewModel() {
        _itemsToPage = new ObservableCollection<Item>(); // replace this with whatever your items are

        _timer = new DispatcherTimer {Interval = new TimeSpan(0,0,0,10)};
        _timer.Tick += NextPage;
        _timer.Start();
    }

    private void NextPage(object sender, object e) {
        if (_itemsToPage < _itemsPerPage) return;

        if (_currentPage * _itemsPerPage >= _itemsToPage) _currentPage = 1;
        else _currentPage++;

        // the key line
        PagedItems = new ObservableCollection<Item>(
            _itemsToPage.Skip((_currentPage-1) * _itemsPerPage)
                .Take(_itemsPerPage));

        OnPropertyChanged("PagedItems") // you need to implement INotifyPropertyChanged
    }
} 
```

基本思想：每 x 秒根据您要分页的列表中的项目子集创建一个新列表。您会注意到`(_currentPage-1) * _itemsPerPage`每页上第一项的元素编号。

# c# - INotifyPropertyChanged 事件未调用事件处理程序

> ID：11850245
> 
> 赞同：1
> 
> 时间：2012-08-07T16:27:41.360
> 
> 标签：c#, silverlight, mvvm, inotifypropertychanged

我在 SL 4.0 中做了一些 MVVM 工作，并且我有一个永远不会被调用的事件处理程序，尽管事件触发并且是非空的。

首先，我附加了事件处理程序。我逐步完成了这个，并注意到在添加事件处理程序之后，PropertyChanged 不再为空，但是，它的 invocationCount 仍然是 0，它的 invocationList 仍然是空的。这不是预期的吧？

```
node.PropertyChanged += new System.ComponentModel.PropertyChangedEventHandler(OnMonitoredDataSourceNodePropertyChanged); 
```

接下来，我更改一个属性，并调用我的 OnPropertyChanged 方法，如下所示：

```
OnPropertyChanged("CheckState"); 
```

触发该方法。我逐步完成，在检查 PropertyChanged 事件时，它不是预期的 NULL，但是它的 invocationCount 为 3，并且 invocationList 有 4 个对象，其中最后一个是 NULL。这对我来说毫无意义，应该只有之前分配的 1 个处理程序。相反，它是其他一些列表，并且不包括我的原始处理程序。

```
public void OnPropertyChanged(string propertyName) {
        if (this.PropertyChanged != null) {
            this.PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

因此，PropertyChanged 被触发，但我的处理程序从未被调用。在这个问题上，我一直在用头撞墙几个小时，感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:52:14.293

您的代码没有问题，因为它出现在问题中。这表明 1）您的代码与此处表示的不同，或者 2）您在第一部分中添加侦听器的实例不是您正在触发的实例`OnPropertyChanged`。2号是我的赌注。

为了对此进行测试，您应该调试您的应用程序，在添加侦听器和触发的位置放置一个断点`OnPropertyChanged`。

在 Visual Studio 中，当第一个断点被命中时，在变量引用的实例上[创建一个对象 ID 。](http://blogs.msdn.com/b/zainnab/archive/2010/03/04/make-objectid-vstipdebug0015.aspx)`node`让您的应用程序继续执行。

当第二个断点命中时`OnPropertyChanged`，检查 上的对象 ID `this`。您会发现实例是否相同。

在所有的调试中，确定你的假设是什么。因为那是你的错误所在。

# javascript - 如何根据所选的列表视图项使按钮的行为有所不同？

> ID：11850247
> 
> 赞同：1
> 
> 时间：2012-08-07T16:27:43.570
> 
> 标签：javascript, jquery, jquery-mobile, jquery-events

我正在创建一个 jQuery Mobile 网站，并且正在努力解决一些基本概念。例如，我有一个带有导航按钮的页眉，例如“在地图上显示”。在它下面，我有一个带有项目的可折叠列表视图。当用户单击或展开列表视图项目时，我该如何制作，以便当他们单击导航按钮以显示在地图上时，它将使用所选项目的 ID 来更新地图。基本上，一个按钮的 href 取决于当前选择的内容。我该如何处理？我应该为此使用 3rd 方库还是其他方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:56:05.790

假设您有一个处理地图显示的对象：

```
var Map = new ( function() {
   this.selectedItem = null;
   this.changeSelectedItem = function( itemID ) {
      this.selectedItem = itemID;
   }
   this.displaySelectedItem = function() {
      // display item here using this.selectedItem

   }
} )(); 
```

如果您有这样的列表项：

```
<li class="listItems" data-id="1">Some Item</li> 
```

然后你可以像这样附加一个处理程序：

```
$( '.listItems' ).click( function() {
   var itemID = $( this ).data( 'id' );
   Map.changeSelectedItem.call( Map, itemID );
} ); 
```

通过这种方式，您将 UI 事件处理程序附加到 Map 对象的 changeSelectedItem 方法。您可以类似地将 displaySelectedItem 方法附加到 UI 处理程序。这有意义吗？

# java - 使用 Java 的 htmlunit.WebClient 和多个代理进行多线程

> ID：11850248
> 
> 赞同：2
> 
> 时间：2012-08-07T16:27:52.283
> 
> 标签：java, multithreading, proxy, webclient, htmlunit

我正在使用 Java 和 htmlunit 的 WebClient 编写一个多线程刮板。我正在使用代理池，并且我有一个简单的类来处理它们。它有代理列表，您可以调用 GetProxy 函数来获取列表中下一个代理的 IP 和端口。我已经对其进行了彻底的测试，并且我已经确认它可以在任意数量的线程上按预期工作。

从那里我有一个 getHTML 函数，我可以在其中传递一个 URL 和一个代理，它会为我返回页面：

```
public String getHTML(String URL, ProxyData pData)
{
    WebClient webClient = new WebClient();
    String pageAsXml = "";

    webClient.setJavaScriptEnabled(false);

    ProxyConfig pConf = new ProxyConfig(pData._host, pData._port);
    webClient.setProxyConfig(pConf);

    try
    {
        HtmlPage page = webClient.getPage(URL);
        pageAsXml = page.asXml();
    }
    catch (FailingHttpStatusCodeException e)
    {
        e.printStackTrace();
    }
        catch (MalformedURLException e)
    {
        e.printStackTrace();
    }
        catch (IOException e)
    {
        e.printStackTrace();
    }

    webClient.closeAllWindows();

    return pageAsXml;
} 
```

如果我在代码中设置 WebClients 代理设置后将它们写入控制台，它似乎是正确的 IP。在调试模式下单步执行也证实了这一点。但是，返回的结果 HTML 似乎并未反映更改后的代理。

我正在使用 WhatIsMyIP 的自动化页面来检查我的代理以查看它们是否正常工作 (http://automation.whatismyip.com/n09230945.asp)。每次我得到一个页面后，我都会编写传递给函数的代理，代理 WebClient 说它在页面加载时正在使用，然后在 HTML 中返回的代理到控制台。前两个总是匹配得很好，但返回的 IP 是关闭的。他们第一次都是正确的，但随后他们似乎开始重用代理。并且代理并不总是在同一个线程中被重用。他们似乎只是选择了一个已经存在的随机代理。

似乎代理在被实际替换之前被随机重用了一段时间，甚至跨线程。即使我设置了一个新的代理，并且 WebClient 似乎知道我已经设置了一个新的代理，但它似乎仍然使用旧的代理。

那么是什么原因造成的，我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-06-25T18:12:14.187

这里有一个框架，它基本上通过 htmlunit 为您在代理池上执行多线程：[https ://github.com/subes/invesdwin-webproxy](https://github.com/subes/invesdwin-webproxy)

它还解决了其他问题，例如 htmlunits javascript 解析器实例过多耗尽 cpu 和其他问题。也许代码可以提示您在自己的框架中以这种方式使用 htmlunit 时可以做哪些不同的事情。

# javascript - 删除两个字符串正则表达式之间的所有内容

> ID：11850253
> 
> 赞同：1
> 
> 时间：2012-08-07T16:28:04.547
> 
> 标签：javascript, jquery, regex

我有以下内容：

```
<span class="hello" id="something somemore"> blah blah blah </span> 
```

我的正则表达式不是我最强的能力，如果有人可以在 javascript 正则表达式中帮助我，我将不胜感激。

我想删除所有内容/任何内容，包括 from `<span`to`>`然后最后删除`</span>`.

我正在使用`.replace(myregexhere, "");`替换其他项目，但我正在努力做到以上几点。

另外，如果有更简单或更好的选择，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T16:52:45.300

如果你真的想使用正则表达式替换，试试这个：

```
var newstring = oldstring.replace(/<span[^>]*>([^<]*)<\/span>/, "$1"); 
```

`<span>`请注意，如果任何 html 标签介于和之间，这将不起作用`</span>`。如果那里有 html 标签，请改用类似的[东西](https://stackoverflow.com/a/11850294/1337398)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T16:30:09.613

你想要这样的东西：

```
~<span.+?>~ 
```

和

```
~</span>~ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T16:30:44.097

为什么不[`replaceWith()`](http://api.jquery.com/replaceWith/)改用：

```
var something = $('#something').text();
$('#something').replaceWith(something); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-07T16:32:48.207

使用 jQuery：

```
$('span').remove(); 
```

或者对于每个带有“hello”类的跨度：

```
$('span .hello').remove(); 
```

或者对于每个 id 为 "somemore" 的元素，

```
$("#something somemore").remove(); 
```

# android - 如何使用 Ant 为 Android 构建 Gideros 项目？

> ID：11850254
> 
> 赞同：2
> 
> 时间：2012-08-07T16:28:12.720
> 
> 标签：android, ant, build, gideros

就是这样，其实。我宁愿不使用 Eclipse，而想使用命令行。

我试图构建它而不做任何特别的事情，但它给了我这样的错误：

```
package com.giderosmobile.android.player does not exist
cannot find symbol AudioDevice
 etc. 
```

另外，如果可能的话，我想使用另一个 IDE 并在整个过程中使用命令行。这可能吗？如果是，如何？

这是我在这里的第一个问题，所以如果我问错了，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:32:19.687

首先，我注意到没有包含 ant 构建文件，并且缺少其他一些东西。所以首先要做的事情...

```
{sdkdir}/tools/android update project --path [locationToProject] 
```

将生成您的构建文件和其他所有内容。

但看起来从尝试构建这个失败，因为它想要导入位置

```
com.giderosmobile.android.player.* 
```

您可能缺少该依赖项或软件包名称不正确...

**[编辑]**

我交换了这一行：

```
import com.giderosmobile.android.player.*; 
```

和

```
import com.giderosmobile.android.player.AudioDevice;
import com.giderosmobile.android.player.JavaNativeBridge; 
```

它使用'ant debug'构建得很好。希望有帮助！

**[编辑 2]**

将“gideros.jar”移动到 libs 文件夹中

# python - 在添加数据之前使用 Python gdata 清除工作表中的行

> ID：11850257
> 
> 赞同：4
> 
> 时间：2012-08-07T16:28:15.517
> 
> 标签：python, gdata-api

我有一个谷歌电子表格，我正在使用 python 脚本和 gdata 库填充值。如果我多次运行脚本，它会将新行附加到工作表中，我希望脚本在填充之前先清除行中的所有数据，这样我每次运行时都有一组新数据脚本。我试过使用：

```
UpdateCell(row, col, value, spreadsheet_key, worksheet_id) 
```

但是没有像这样运行两个 for 循环，有没有更清洁的方法？此外，这个循环似乎非常慢：

```
for x in range(2, 45):
      for i in range(1, 5):
        self.GetGDataClient().UpdateCell(x, i, '', 
                                         self.spreadsheet_key,
                                         self.worksheet_id) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-04T20:04:00.063

不确定您是否解决了这个问题，但是关于加快清除当前数据的速度，请尝试使用[批处理请求](http://code.google.com/p/gdata-python-client/wiki/UsingBatchOperations)。例如，要清除工作表中的每个单元格，您可以执行以下操作：

```
cells = client.GetCellsFeed(key, wks_id)
batch_request = gdata.spreadsheet.SpreadsheetsCellsFeed()

# Iterate through every cell in the CellsFeed, replacing each one with ''
# Note that this does not make any calls yet - it all happens locally
for i, entry in enumerate(cells.entry):
  entry.cell.inputValue = ''
  batch_request.AddUpdate(cells.entry[i])

# Now send the entire batchRequest as a single HTTP request
updated = client.ExecuteBatch(batch_request, cells.GetBatchLink().href) 
```

如果你想做一些事情，比如保存列标题（假设它们在第一行），你可以使用 CellQuery：

```
# Set up a query that starts at row 2
query = gdata.spreadsheet.service.CellQuery()
query.min_row = '2'

# Pull just those cells
no_headers = client.GetCellsFeed(key, wks_id, query=query)

batch_request = gdata.spreadsheet.SpreadsheetsCellsFeed()

# Iterate through every cell in the CellsFeed, replacing each one with ''
# Note that this does not make any calls yet - it all happens locally
for i, entry in enumerate(no_headers.entry):
  entry.cell.inputValue = ''
  batch_request.AddUpdate(no_headers.entry[i])

# Now send the entire batchRequest as a single HTTP request
updated = client.ExecuteBatch(batch_request, no_headers.GetBatchLink().href) 
```

或者，您也可以使用它来更新您的单元格（也许更符合您的需要）。文档的链接提供了一种基本方法，即（从文档中复制，以防链接发生变化）：

```
import gdata.spreadsheet
import gdata.spreadsheet.service

client = gdata.spreadsheet.service.SpreadsheetsService()
# Authenticate ...

cells = client.GetCellsFeed('your_spreadsheet_key', wksht_id='your_worksheet_id')

batchRequest = gdata.spreadsheet.SpreadsheetsCellsFeed()

cells.entry[0].cell.inputValue = 'x'
batchRequest.AddUpdate(cells.entry[0])
cells.entry[1].cell.inputValue = 'y'
batchRequest.AddUpdate(cells.entry[1])
cells.entry[2].cell.inputValue = 'z'
batchRequest.AddUpdate(cells.entry[2])
cells.entry[3].cell.inputValue = '=sum(3,5)'
batchRequest.AddUpdate(cells.entry[3])

updated = client.ExecuteBatch(batchRequest, cells.GetBatchLink().href) 
```

# php - 如何根据所选商店更改 magento 中的面包屑

> ID：11850258
> 
> 赞同：0
> 
> 时间：2012-08-07T16:28:19.060
> 
> 标签：php, breadcrumbs, magento-1.7

我已经建立了一个包含 5 家商店的网站，我希望面包屑中的主页链接作为商店名称。例如：如果我在商店 2 中，那么我希望面包屑是 2 > 页面标题而不是主页 > 页面标题。

非常感谢你提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-13T07:58:57.580

您需要创建一个静态块。

转到 CMS-> 静态块。在这里，您可以创建一个名为 custom_block 的静态块。

然后转到 CMS->Widgets 为每个商店创建一个名为 store1_widget1 的小部件，并将其可见性设置为相应的商店。在该小部件中，您可以编写内容或显示图像或任何其他内容。

在 head 部分的 CMS.xml 文件中调用这个名为 custom_block 的静态块，您就完成了。

这将帮助你。

# python - GAE - 将图像从移动设备上传到 blobstore

> ID：11850263
> 
> 赞同：3
> 
> 时间：2012-08-07T16:28:32.577
> 
> 标签：python, google-app-engine

[我已经能够使用此处](https://stackoverflow.com/questions/81451/upload-files-in-google-app-engine)提供的代码（在主要基于 GAE 文档的评论之一中）成功地将图像上传到我的 Google App Engine Blobstore 。

以下是完整代码供参考：

```
import os
import urllib

from google.appengine.ext import blobstore
from google.appengine.ext import webapp
from google.appengine.ext.webapp import blobstore_handlers
from google.appengine.ext.webapp import template
from google.appengine.ext.webapp.util import run_wsgi_app

class MainHandler(webapp.RequestHandler):
    def get(self):
        upload_url = blobstore.create_upload_url('/upload')
        self.response.out.write('<html><body>')
        self.response.out.write('<form action="%s" method="POST" enctype="multipart/form-data">' % upload_url)
        self.response.out.write("""Upload File: <input type="file" name="file"><br> <input type="submit" name="submit" value="Submit"> </form></body></html>""")

        for b in blobstore.BlobInfo.all():
            self.response.out.write('<li><a href="/serve/%s' % str(b.key()) + '">' + str(b.filename) + '</a>')

class UploadHandler(blobstore_handlers.BlobstoreUploadHandler):
    def post(self):
        upload_files = self.get_uploads('file')
        blob_info = upload_files[0]
        self.redirect('/')

class ServeHandler(blobstore_handlers.BlobstoreDownloadHandler):
    def get(self, blob_key):
        blob_key = str(urllib.unquote(blob_key))
        if not blobstore.get(blob_key):
            self.error(404)
        else:
            self.send_blob(blobstore.BlobInfo.get(blob_key), save_as=True)

def main():
    application = webapp.WSGIApplication(
          [('/', MainHandler),
           ('/upload', UploadHandler),
           ('/serve/([^/]+)?', ServeHandler),
          ], debug=True)
    run_wsgi_app(application)

if __name__ == '__main__':
  main() 
```

但是，此代码要求在包含图像数据的`GET`请求之前在请求中创建上传 url ：`POST`

```
def get(self):
  upload_url = blobstore.create_upload_url('/upload') 
```

当我尝试从移动设备发送图像时，我想将服务器代码推送到该`def post(self):`功能下的单个代码块中，但我在执行此操作时遇到了麻烦。

将上面的行移到`def post(self):`代码中似乎并不能解决问题。

**有任何想法吗？**

干杯! 布雷特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-30T17:15:59.133

是的，您可以使用 urlfetch 将其设为一个代码块。这是我的方法：

```
class UploadHandler(blobstore_handlers.BlobstoreUploadHandler):
    def post(self):
        upload_files = self.get_uploads('file')
        if len(upload_files) > 0 :
            blob_info = upload_files[0]
            self.response.write(str(blob_info.key()))
        else:
            self.error(404) 

class SomeHandler(webapp.RequestHandler):
    def post(self):
        file = self.request.POST.get('file')
        if (file is not None):
            # Use urlfetch to call to the blob upload url and get result
            # Just copy the same request body and header and pass to UploadHandler here
            result = urlfetch.fetch(
                url= blobstore.create_upload_url('/upload'),
                payload=self.request.body,
                method=urlfetch.POST,
                headers=self.request.headers)
            if result.status_code == 200:
                blob_key_str = result.content
                # Get blob key
                blob_key = blobstore.BlobKey(blob_key_str)
                # Maybe a url for the file
                blob_url = images.get_serving_url(blob_key_str, 400) 
```

这样，您始终可以将文件上传到 SomeHandler，而不必先获取上传 URL，然后再仅上传。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:52:34.847

这不适用于默认的 Blobstore 上传处理程序：它需要两个请求：第一个创建一次性下载 url，第二个实际执行 POST 到此 url。

如果您想一次性完成所有操作，请创建自己的[文件上传处理程序](http://blog.thomnichols.org/2009/12/restful-file-upload-for-appengine)并使用新的 Blobstore API 来[写入文件](https://developers.google.com/appengine/docs/python/blobstore/overview#Writing_Files_to_the_Blobstore)。

# javascript - 触发事件被接收两次。如何找到鬼视图？

> ID：11850264
> 
> 赞同：0
> 
> 时间：2012-08-07T16:28:34.987
> 
> 标签：javascript, backbone.js

我实例化了 ChildView 几次。在 ChildViews 中有一个触发器。一旦触发，就会调用父级中的一个函数来设置模型。问题是，触发器只触发一次（至少我可以看到一次），但父级收到两个。我知道鬼视图，但我如何找到它们？我不使用全局命名空间，我使用 require.js。

```
vParentView = require 'views/parentview'

class vParentView

    render: ->
        view1 = new ChildView()
        view1.on 'data changed', @updateModel, @
        view2 = new ChildView()
        view2.on 'data changed', @updateModel, @
        view3 = new ChildView()
        view3.on 'data changed', @updateModel, @
        etc...

    updateModel: (data) ->
        @model.set data.attr, data.options 
```

我删除了上下文 @ 以查看哪个视图触发了 updateModel() 两次，也许它们来自不同的视图，但不是。所以，同一个视图会触发 updateModel 两次。

编辑： ChildView 的代码有点无趣：

```
vChildView = require 'views/childview'

class vChildView

    events:
        'change input.someclass': 'onChangeInput'
        'change textarea.someclass': 'onChangeInput'

    onChangeInput: (e) ->
        @trigger 'data changed'

    render: ->
        html = _.template tpl

        @$el.html html

        @ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:48:35.057

Derick Bailey 就此写了一篇非常深入的博文：http: [//lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/](http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:15:01.193

多一点你的代码会有所帮助（就像@Brendan Delumpa 说的）

在像您这样的情况下，事情发生并且您不知道为什么以及触发它们的原因，我通常会`console.log('')`像这样在每个功能下放置一个

```
class vParentView

    render: ->
        console.log 'vParentView -> render'
        ...

    updateModel: (data) ->
        console.log 'vParentView -> updateModel'
        ... 
```

`Developer Tools`在此之后，如果我仍然不知道问题出在哪里，我将逐行添加一些断点，直到我发现哪个触发了两次相同的事情

# iphone - 核心数据，无法检索/设置到我的属性。最常见的错误？

> ID：11850266
> 
> 赞同：1
> 
> 时间：2012-08-07T16:28:42.327
> 
> 标签：iphone, ios5, core-data, uiviewcontroller

主题：核心数据，无法从 VC 中检索/设置我的属性。最常见的错误？

*通过该站点进行搜索，但**无法完全得到我需要的答案**（尽管有很多很好的提示），所以我想我发布这个问题，希望它能解决我几周以来遇到的问题！是的，很沮丧，你大概知道这种感觉！所以任何帮助都会很棒 - 谢谢！:-)*

## 概览：

iOS 5.1 项目。让核心数据正常工作（在 main.h/NSLog 中测试），但我在**从其他视图控制器检索和设置实体属性（数据）时遇到问题**。Xcode 可以识别来自其​​他视图控制器的 AppDelegate 中的我的单例“AppContent”，但不能识别实体名称及其属性。

### **对此最常见的错误是什么？**

我有一种感觉，我只是错过了在正确的位置导入一些文件等......

## 更多细节；

仅供参考：我正在尝试使用 Matt Campell 推荐的方法，该方法在 AppDelegate 中创建一个单例，可以**在整个应用程序**中使用它来处理来自任何视图控制器的 managedObjectContext，并将数据检索并保存到 Core Data，它是实体及其各自的属性。这是通过将以下两个文件导入应用程序来完成的；

**应用内容.h**

```
#import <Foundation/Foundation.h>
#import "Contest.h"  // Root Entity in CD model
#import "Player.h"

@interface AppContent : NSObject

+(AppContent *)sharedContent;

@property(strong, readonly) id rootObject;

-(void)save;
-(void)rollback;

@end 
```

**应用内容.m**

```
#import "AppContent.h"
#import <CoreData/CoreData.h>

@interface AppContent()

-(NSURL *)dataStoreURL;
@property (nonatomic, strong, readonly) NSManagedObjectModel *managedObjectModel;
@property (nonatomic, strong, readonly) NSPersistentStoreCoordinator *persistentStoreCoordinator;
@property (nonatomic, strong, readonly) NSManagedObjectContext *managedObjectContext;

@end

@implementation AppContent
NSManagedObjectModel *_managedObjectModel;
NSPersistentStoreCoordinator *_persistentStoreCoordinator;
NSManagedObjectContext *_managedObjectContext;
id _rootObject;

static AppContent *singletonInstance = nil;

+ (AppContent *)sharedContent{
    @synchronized(self){
        if (singletonInstance == nil)
            singletonInstance = [[self alloc] init];

        return(singletonInstance);
    }
}

- (NSURL *)dataStoreURL {

    NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];

    return [NSURL fileURLWithPath:[docDir stringByAppendingPathComponent:@"DataStore.sql"]];
}

- (NSManagedObjectModel *)managedObjectModel {
    if (_managedObjectModel) {
        return _managedObjectModel;
    }
    _managedObjectModel = [NSManagedObjectModel mergedModelFromBundles:nil];    
    return _managedObjectModel;
}

- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {
    if (_persistentStoreCoordinator) {
        return _persistentStoreCoordinator;
    }

    NSError *error = nil;
    _persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    if (![_persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType
                                               configuration:nil
                                                         URL:[self dataStoreURL]
                                                     options:nil
                                                       error:&error]) {
        NSLog(@"Unresolved Core Data error with persistentStoreCoordinator: %@, %@", error, [error userInfo]);
    }    

    return _persistentStoreCoordinator;
}

- (NSManagedObjectContext *)managedObjectContext {
    if (_managedObjectContext) {
        return _managedObjectContext;
    }

    if ([self persistentStoreCoordinator]) {
        _managedObjectContext = [[NSManagedObjectContext alloc] init];
        [_managedObjectContext setPersistentStoreCoordinator:[self persistentStoreCoordinator]];
    }

    return _managedObjectContext;
}

-(id)rootObject{
    if(_rootObject)
        return _rootObject;

// #warning Replace [CHANGE] with your root object entity name
    NSString *entityName = @"Contest";
    NSManagedObjectContext *context = [self managedObjectContext];
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    NSEntityDescription *entity = [NSEntityDescription entityForName:entityName
                                          inManagedObjectContext:context];
    request.entity = entity;
    NSArray *listOfObjects = [context executeFetchRequest:request
                                                error:nil];
    if([listOfObjects count] == 1){
        _rootObject = [listOfObjects lastObject];
        return _rootObject;
    }
    _rootObject = [NSEntityDescription insertNewObjectForEntityForName:entityName
                                            inManagedObjectContext:context];

    // Adding some testdata (only first time...)
    // Contest
    Contest *c = _rootObject;
    c.name = @"Big Game 1";

    // Players
    Player *p1 = (Player *) [NSEntityDescription insertNewObjectForEntityForName:@"Player"
                                                          inManagedObjectContext:context];
    p1.name = @"Player One";
    [c addPlayersObject:p1];

    Player *p2 = (Player *) [NSEntityDescription insertNewObjectForEntityForName:@"Player"
                                                              inManagedObjectContext:context];
    p2.name = @"Player Two";
    [c addPlayersObject:p2];

    [self save];

    return _rootObject;
}

-(void)save{
    NSError *error = nil;
    NSManagedObjectContext *context = [self managedObjectContext];
    if([context hasChanges])
        [context save:&error];
    if(error)
        NSLog(@"Warning: Error saving to data store.  %@", error);
}

-(void)rollback{
    NSManagedObjectContext *context = [self managedObjectContext];
    if([context hasChanges])
        [context rollback];
}

@end 
```

## 以下是模型文件（由 CD 模型编辑器创建）；

**竞赛.h**

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@class Player;

@interface Contest : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSSet *players;
@end

@interface Contest (CoreDataGeneratedAccessors)

- (void)addPlayersObject:(Player *)value;
- (void)removePlayersObject:(Player *)value;
- (void)addPlayers:(NSSet *)values;
- (void)removePlayers:(NSSet *)values;

@end 
```

**竞赛.m**

```
#import "Contest.h"
#import "Player.h"

@implementation Contest

@dynamic name;
@dynamic players;

@end 
```

**播放器.h**

```
#import <Foundation/Foundation.h>
#import <CoreData/CoreData.h>

@class Contest;

@interface Player : NSManagedObject

@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) Contest *contests;

@end 
```

**播放器.m**

```
#import "Player.h"
#import "Contest.h"

@implementation Player

@dynamic name;
@dynamic contests;

@end 
```

## 这是一个视图控制器

试图在这里获取核心数据实体及其属性，但 Xcode 看到的是 appContent 但无法识别它，并且在构建它时会出现错误“找不到属性播放器”......

**竞赛播放器VC.h**

```
#import <UIKit/UIKit.h>
#import <CoreData/CoreData.h>
#import "AppContent.h"

@interface contestPlayerVC : UIViewController

@property (strong, nonatomic) IBOutlet UITextField *playerNameField;
@property (strong, nonatomic) IBOutlet UITextField *playerMailField;
@property (strong, nonatomic) IBOutlet UIButton *playerSaveButton;

@property (weak, nonatomic) AppContent *content;

// Test
// @property (nonatomic, strong) NSManagedObjectContext *managedObjectContext;

- (IBAction)playerChooseImage:(UIButton *)sender;

- (IBAction)dismissModal:(UIButton *)sender;

- (IBAction)hideKeyboard:(id)sender;

- (IBAction)playerSave:(UIButton *)sender;

@end 
```

**matchPlayerVC.m** 不显示孔文件，因为问题出在方法 viewDidLoad...

```
#import "contestPlayerVC.h"

@interface contestPlayerVC ()

@end

@implementation contestPlayerVC
@synthesize playerNameField, playerMailField, playerSaveButton, content;

- (void)viewDidLoad {

    [super viewDidLoad];
    // Do any additional setup after loading the view.

    // Call 1 - seems to work ok
    self.content = [AppContent sharedContent];

////// Call 2 - gives error, can't find property "player" - WHY?
    // Trying to set textfield to CD Entity "Player" and it's property "name"
    self.playerNameField.text = self.content.player.name;

    NSLog(@"Player is: %@", self.content.player.name);

    // Call 3 - works ok
    NSLog(@"Content is: %@", self.content.description);

}
... 
```

## 有什么提示或建议吗？谢谢！:-)

顺便说一句：很抱歉，这篇文章很长，我不确定还有什么方法可以很好地描述我的问题，让任何人都能理解。如果您阅读了所有内容 - 我印象深刻，如果您能帮我解决这个问题，我会非常高兴。可能我完全错过了一些基本的东西。谢谢 ;-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:38:49.373

您的错误，无法在 上找到`player`属性`self.content`，是因为您的 AppContent 类未声明该名称的任何属性。让我们一次一行地浏览您的代码：

```
self.content = [AppContent sharedContent]; 
```

Now`self.content`是一个 AppContent 类型的对象，因此以后的任何调用都`self.content.something`将查找在该类上声明的可见方法或属性（通常在“AppContent.h”中）。

```
self.playerNameField.text = self.content.player.name; 
```

我们在这里寻找一个`player`在 AppContent 对象中命名的属性，它的标题是：

```
#import <Foundation/Foundation.h>
#import "Contest.h"  // Root Entity in CD model
#import "Player.h"

@interface AppContent : NSObject

+(AppContent *)sharedContent;

@property(strong, readonly) id rootObject;

-(void)save;
-(void)rollback;

@end 
```

没有一个`@property`命名的地方`player`——你有一个`rootObject`属性，你导入了“Player.h”头文件，但你从来没有声明你试图访问的属性。您需要添加如下一行：

```
@property(strong) Player * player; 
```

并将`@synthesize`其放在您的“AppContent.m”文件中，或者提供适当的访问器方法来支持该属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T13:35:16.700

@user1578933 好的，让我们倒退一下，想想每个部分负责什么：

*   **比赛**是负责与比赛相关的所有事情的根（第一个）对象，包括球员的姓名和名单
*   **球员**对球员的一切负责，包括球员的名字
*   **AppContent**负责管理对象图（检索对象图以便您可以使用它并记住用户添加和删除的内容）
*   **matchPlayerVC**负责呈现内容（来自 AppContent）

在您的应用程序中，一切都以**Contest**开始。在您的**AppContent**实现中，您有生成该属性**rootObject**的代码，这是第一次创建**Contest对象的地方。**

**注意**您已将其定义为**id**，因为您正在为我们的程序直接复制此代码，但您也可以将**rootObject**定义为类型**Contest**，如下所示：

```
-(Contest *) rootObject; 
```

这是您进入对象图的入口点。这个想法是您将访问**AppContent**（使用 Singleton 模式），然后检索**Contest**对象。**Contest**对象将具有NSSet**对象**集合，其中包含对集合中每个玩家的引用。

这是一个如何在视图控制器中使用它的示例：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    self.content = [AppContent sharedContent];

    //get reference to the root object contest
    Contest *theContest = (Contest *)self.content.rootObject;

    //get an array based reference to the players in theContest
    NSArray *players = [theContest.players allObjects];

    //Example of getting a reference to an individual player:
    Player *p1 = [players objectAtIndex:0];

} 
```

这本质上就是将这些内容添加到视图控制器的方式；对于表格视图控制器，您将使用索引路径行属性来找出播放器进入哪个表格视图单元格（请参阅 cellForRowAtIndexPath）。

@user1578933 - 在阅读了这篇文章以及您留在[移动应用掌握学院](http://institute.mobileappmastery.com/iostrainingpack/core-data/)的文章之后，您似乎对对象图以及所有这些对象关系的总体组织方式缺乏一些了解。我最近在此处添加了一些关于如何使用和思考[Objective-C 对象图](http://institute.mobileappmastery.com/iostrainingpack/introduction-to-ios-sdk/)的附加内容。另外，我会再次仔细查看有关 Objective-C、表视图和核心数据的部分。

# android - 将数据保存在 SD 卡上

> ID：11850273
> 
> 赞同：0
> 
> 时间：2012-08-07T16:29:15.513
> 
> 标签：android

我正在编写一个小游戏，我想将分数和音量（启用或禁用）保存在 sd 卡上，我的两个功能的代码是：

```
public static void load(FileIO files) {
    BufferedReader in = null;
    try {
        in = new BufferedReader(new InputStreamReader(
                files.readFile(".save")));
        soundEnabled = Boolean.parseBoolean(in.readLine());
        for (int i = 0; i < 5; i++) {
            highscores[i] = Integer.parseInt(in.readLine());
        }
    } catch (IOException e) {
        // :( It's ok we have defaults
    } catch (NumberFormatException e) {
        // :/ It's ok, defaults save our day
    } finally {
        try {
            if (in != null)
                in.close();
        } catch (IOException e) {
        }
    }
} 
```

//-----------------------

```
public static void save(FileIO files) {
    BufferedWriter out = null;
    try {
        out = new BufferedWriter(new OutputStreamWriter(
                files.writeFile(".save")));
        out.write(Boolean.toString(soundEnabled));
        for (int i = 0; i < 5; i++) {
            out.write(Integer.toString(highscores[i]));
        }

    } catch (IOException e) {
    } finally {
        try {
            if (out != null)
                out.close();
        } catch (IOException e) {
        }
    }
} 
```

当程序运行时，这段代码是可以的，但是如果我重新启动我的设备，分数就会丢失..你知道为什么吗？

谢谢！！

ps：FileIO类是：

```
 public class AndroidFileIO implements FileIO {
    Context context;
    AssetManager assets;
    String externalStoragePath;

    public AndroidFileIO(Context context) {
       this.context = context;
       this.assets = context.getAssets();
       this.externalStoragePath = Environment.getExternalStorageDirectory()
            .getAbsolutePath() + File.separator;
    }

    public InputStream readAsset(String fileName) throws IOException {
       return assets.open(fileName);
    }

    public InputStream readFile(String fileName) throws IOException {
       return new FileInputStream(externalStoragePath + fileName);
    }

    public OutputStream writeFile(String fileName) throws IOException {
       return new FileOutputStream(externalStoragePath + fileName);
    }

    public SharedPreferences getPreferences() {
       return PreferenceManager.getDefaultSharedPreferences(context);
    }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:37:57.277

这里有两个问题。首先，out.write 不会在每次调用结束时插入换行符，您必须手动执行此操作。所以发生的事情是，当您在 cal 中执行 readline 来解析布尔值时，您实际上正在使用文件中的所有数据。其次，您需要在离开该函数之前刷新并关闭文件，以确保不会在缓冲区中留下任何数据。

这是应该工作的保存重写：

```
public static void save(FileIO files) {
BufferedWriter out = null;
try {
    out = new BufferedWriter(new OutputStreamWriter(
            files.writeFile(".mrnom")));
    out.write(Boolean.toString(soundEnabled));
    out.write("\n");
    for (int i = 0; i < 5; i++) {
        out.write(Integer.toString(highscores[i]));
        out.write("\n");

    }
    out.flush();
    out.close();
} catch (IOException e) {
} finally {
    try {
        if (out != null)
            out.close();
    } catch (IOException e) {

    }
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-14T23:16:57.863

我是第一次编程，但我使用共享首选项解决了这个问题。这样您就可以避免在更新应用程序时丢失数据。

# python - Python suds 中带前导下划线的参数

> ID：11850275
> 
> 赞同：2
> 
> 时间：2012-08-07T16:29:18.007
> 
> 标签：python, suds

我正在使用一个 SOAP 服务，该服务具有用前导下划线定义的变量（假设是私有的，但文档中有必须使用它们的特定示例）。在 WSDL 中，它看起来像这样：

```
<xsd:element maxOccurs="1" minOccurs="0" name="__encoded_query" type="xsd:string"/> 
```

通过一些实验，我已经确定，在我的 client.service 调用中使用命名参数，我可以正常分配变量，除了具有前导下划线的变量。

例如：

```
client.service.getRecords( name='server1' ) 
```

生成正确的 XML：

```
<ns1:getRecords>
  <name>server1</name>
</ns1:getRecords> 
```

但如果我尝试使用带下划线的参数：

```
client.service.getRecords( __encoded_query='name=server1' ) 
```

生成的 XML 根本不包含参数：

```
<ns1:getRecords/> 
```

我不确定这是否是我不熟悉的语法细微差别（Python 或 suds），或者可能是 suds 试图通过基于私有变量约定保护变量来“聪明”。无论如何，这是使用此 Web 服务的记录方式，因此我需要弄清楚如何获得 suds 以生成包含`__encoded_query`块的 XML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T11:40:10.170

这不是你的错，这是一个[记录在案的泡沫问题](https://fedorahosted.org/suds/ticket/330)。

# java - 并非所有站点都可以由 java NIO 代理。为什么？

> ID：11850280
> 
> 赞同：0
> 
> 时间：2012-08-07T16:29:46.093
> 
> 标签：java, proxy, nio

我已经使用 Java NIO 通道实现了简单的代理服务器，但是有一个问题，一些站点运行良好，但其他站点在其主机的技术页面上给出关于未知路径或重定向的错误，并显示资源不存在。是我的错还是某些网站不允许代理？

ProxyServer 是这样工作的：我输入“localhost”并在浏览器中接收在代码中设置的站点。并且来自浏览器的请求我只是以这种方式在目标站点上重新发送：

```
private void connect(SelectionKey key) throws IOException {
    SocketChannel channel = ((SocketChannel) key.channel());
    Attachment attachment = (Attachment) key.attachment();
    channel.write(attachment.buffer);
} 
```

所以'key' - 是目标站点的SelectionKey，在attachment.buffer中我存储发送到代理服务器的请求。

那么，我的代码有些磨损，还是它刚刚关闭了通过站点代理的机会？

**更新 1.**我想，我发现了一个问题。因为我将请求从 localhost 重定向到远程服务器，所以在字段 HOST 中的请求中我有“localhost”。似乎有些站点忽略了此字段，其他站点尝试使用并重定向到 404 页面，因为找不到我要的“本地主机”。所以问题是如何在目标服务器名称的请求中更改字段“主机”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T22:40:29.367

目标服务器对您的 NIO 代码一无所知，也不知道您是代理还是真正的客户端。

如果您收到错误页面，则代理正在工作，而*被代理的资源*就是问题所在：它不存在，您无权访问，等等。在您的代码中您无能为力，也没有你应该担心的原因。只需将错误页面发送给客户端，就像发送其他任何内容一样。

为什么该方法在未连接并执行其他操作时称为 connect() ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T08:59:35.230

我发现了一个问题。在代理后提交的 HOST 包含“localhost”，因此一些站点接受它，其他站点不接受。将此字段的值替换为真实主机可解决问题。

# excel - 通过 EXCEL VBA 为每个值创建新列，将与 ID 匹配的列中的值复制到新工作表

> ID：11850282
> 
> 赞同：0
> 
> 时间：2012-08-07T16:29:51.870
> 
> 标签：excel, vba, grouping, copying

我有一个要求，其中一个 ID 下有一组值（此 ID 对于每个组都是唯一的）。我希望通过 excel VBA 为每个值创建新列，将组的值复制到新工作表中。说，这是我的主要工作表

```
订单号。账单项目
==============================
12345 100 比萨
12345 200 巧克力
12345 300 咖啡
12345 400 比萨1
12345 500 饮料
12456 600 比萨
12456 700 巧克力
12456 800 比萨1
12360 900 比萨
12360 1000 巧克力
12360 1100 咖啡
```

我想要像下面这样的o/p：

```
订单号。PIZZA PIZZA1 CHOCO COFFEE COFFEE1 饮料
==================================================== ==============  
12345 100 400 200 300 500  
12456 600 800 700    
12360 900 1000 1100
```

我希望将主工作表中存在的值复制到新工作簿的相应列中，例如“PIZZA”值应该根据正确的“订单号”复制到新工作簿。如在主表中。需要一个 excel VBA 来做到这一点。请帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:45:21.390

听起来像是数据透视表的工作。将订单号放在“行”部分，将“项目”放在“列”部分，将“帐单”放在“值”部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:26:22.437

使用名为 Sheet1 和 Sheet2 的工作表创建一个新工作簿（可以通过更改代码中的常量来更改名称）添加一个主模块和 3 个类模块（在 VBA 编辑器中单击 Inser > Module 和 Insert Class Module，Alt F11 开始）重命名类模块如下：Bill、Item 和 Order

将以下代码添加到 Class 模块 Bill

```
Option Explicit

Public ID As String
Public ItemName As String 
```

将以下内容添加到 Class 模块 Item

```
Option Explicit

Public Name As String
Public ColumnNumber As Long

Private Sub Class_Initialize()
    ColumnNumber = 0
End Sub 
```

将以下代码添加到类模块顺序

```
Option Explicit

Public Bills As Collection
Public ID As String

Public Sub AddBill(BillID As String, ItemName As String)
    Dim B As Bill

    Set B = New Bill
    B.ID = BillID
    B.ItemName = ItemName
    Bills.Add B
End Sub

Private Sub Class_Initialize()
    Set Bills = New Collection

End Sub 
```

将以下代码添加到您的主穆勒

```
Option Explicit
Const ORDER_TXT As String = "Order No." 'text in the header cell for order number column
Const INPUT_SHEET_NAME As String = "Sheet1"
Const OUTPUT_SHEET_NAME As String = "Sheet2"
Const FIRST_OUTPUT_COL As Long = 2
Const FIRST_OUTPUT_ROW As Long = 2

Dim Orders As Collection
Dim Items As Collection

Sub process_data()

Dim sh As Worksheet
Dim HeaderRow As Long
Dim HeaderCol As Long
Dim CurRow As Long
Dim CurOrder As Order
Dim CurItemCol As Long
Dim CurItem As Item
Dim CurBill As Bill

'Get Info from input sheet
CurItemCol = FIRST_OUTPUT_COL + 1
HeaderRow = 1
HeaderCol = 1
Set Orders = New Collection
Set Items = New Collection

If FindCell(ORDER_TXT, INPUT_SHEET_NAME, sh, HeaderRow, HeaderCol, False) Then
CurRow = HeaderRow + 1
Do While sh.Cells(CurRow, HeaderCol).Value <> ""
    Set CurOrder = GetOrder(sh.Cells(CurRow, HeaderCol).Value)
    If sh.Cells(CurRow, HeaderCol + 1).Value <> "" Then
        If sh.Cells(CurRow, HeaderCol + 2).Value <> "" Then
            Set CurItem = GetItem(sh.Cells(CurRow, HeaderCol + 2).Value)
            If CurItem.ColumnNumber = 0 Then
                'its a new item
                CurItem.ColumnNumber = CurItemCol
                CurItemCol = CurItemCol + 1
            End If
            'now add this bill to the order
            Call CurOrder.AddBill(sh.Cells(CurRow, HeaderCol + 1).Value, CurItem.Name)
        End If 'could add else with error message here
    End If
    CurRow = CurRow + 1
Loop

'now put data on output sheet
'find output sheet
For Each sh In ThisWorkbook.Sheets
    If sh.Name = OUTPUT_SHEET_NAME Then Exit For
Next

'Add check here that we found the sheet

CurRow = FIRST_OUTPUT_ROW
'write headers
sh.Cells(CurRow, FIRST_OUTPUT_COL).Value = ORDER_TXT
For Each CurItem In Items
    sh.Cells(CurRow, CurItem.ColumnNumber).Value = CurItem.Name
Next
'Write Orders
For Each CurOrder In Orders
    CurRow = CurRow + 1
    sh.Cells(CurRow, FIRST_OUTPUT_COL).Value = CurOrder.ID
    For Each CurBill In CurOrder.Bills
        sh.Cells(CurRow, GetColumnNumber(CurBill.ItemName)).Value = CurBill.ID
    Next
Next

End If
End Sub
Function GetColumnNumber(ItemName As String) As Long
Dim I As Item

GetColumnNumber = 1 'default value
For Each I In Items
    If I.Name = ItemName Then
        GetColumnNumber = I.ColumnNumber
        Exit Function
    End If
Next
End Function
Function GetOrder(OrderID As String) As Order
Dim O As Order

For Each O In Orders
    If O.ID = OrderID Then
        Set GetOrder = O
        Exit Function
    End If
Next
'if we get here then we didn't find a matching order
Set O = New Order
Orders.Add O
O.ID = OrderID
Set GetOrder = O

End Function
Function GetItem(ItemName As String) As Item
Dim I As Item

For Each I In Items
    If I.Name = ItemName Then
        Set GetItem = I
        Exit Function
    End If
Next
'if we get here then we didn't find a matching Item
Set I = New Item
Items.Add I
I.Name = ItemName
Set GetItem = I

End Function
Function FindCell(CellText As String, SheetName As String, sh As Worksheet, row As Long, col As Long, SearchCaseSense As Boolean) As Boolean
Const GapLimit As Long = 10

'searches the named sheet column at a time, starting with the column and row specified in row and col
'gives up on each row if it finds GapLimit empty cells
'gives up on search if it finds do data un GapLimit columns

Dim RowFails As Long
Dim ColFails As Long
Dim firstrow As Long

FindCell = False
firstrow = row
ColFails = 0
RowFails = 0

'find sheet
For Each sh In ThisWorkbook.Sheets
    If sh.Name = SheetName Then Exit For
Next

If sh.Name = SheetName Then
    Do 'search columns
        ColFails = ColFails + 1
        Do  'search column
            If sh.Cells(row, col).Value = "" Then
                RowFails = RowFails + 1
            Else
                If ((sh.Cells(row, col).Value = CellText And SearchCaseSense) Or (UCase(sh.Cells(row, col).Value) = UCase(CellText) And (Not SearchCaseSense))) Then
                    FindCell = True
                    Exit Function
                End If
                RowFails = 0
                ColFails = 0
            End If
            row = row + 1
        Loop While RowFails <= GapLimit
        col = col + 1
        row = firstrow
        RowFails = 0
    Loop While ColFails < GapLimit
End If
End Function 
```

运行例程 process_data（来自 excel 的 Alt F8）

该程序不考虑同一订单上具有相同商品（例如咖啡）的多张账单，只会出现一张账单，我不知道您想如何处理这种情况。代码需要检查和错误处理例程，以使其对无效数据具有鲁棒性，我添加了一些注释作为提示。

希望这可以帮助

# regex - 检查用户输入是有效的 CSS 宽度值

> ID：11850287
> 
> 赞同：0
> 
> 时间：2012-08-07T16:30:08.247
> 
> 标签：regex, preg-replace

我允许用户输入我需要确保是有效的 CSS 宽度值的宽度值。

使用正则表达式，我如何从用户输入中获得两个匹配项，其中`$matches[0] =`一个数字值 AND`$matches[1] =`要么`px`要么`%`？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:35:09.463

```
(\d*)(px|%)? 
```

第一个捕获的项目将是数字，第二个捕获的项目将是 px 或 %。

# javascript - Jquery停止提交并从表单获取数据

> ID：11850295
> 
> 赞同：3
> 
> 时间：2012-08-07T16:30:43.637
> 
> 标签：javascript, jquery, pug

我正在尝试使用 jquery 从表单中获取数据并使用以下代码停止表单提交：

```
$form = $('form#signup')
$form.submit(function(event){
  event.preventDefault();
  var $input=$('#signup :input')
  console.log($input.username)
  alert($input.username)
}) 
```

但是表单仍然`post`是数据并且没有出现警报框。此外，firebug 会引发错误`$ is not defined`并且 Node.js 崩溃

表格（以玉书写）：

```
html
  head
    script(src='javascripts/signupValidation.js')
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')
    script(src='javascripts/validator.js')
  body
    form(id='signup',method='post',action='/signup')
      label Firstname
      input(type='text', name='firstname')
      label Lastname
      input(type='text', name='lastname')
      label Username
      input(type='text', name='username')
      label Password
      input(type='password', name='password')
      label Password again
      input(type='password', name='password2')
      label Email
      input(type='email', name='email')

  input(type='submit',value='Sign up', onclick="") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:34:00.053

如果您的表单相关 JS 在文件`signupValidation.js`中，您需要将包含该文件的脚本调用移动到jquery 包含*之后。*

我可能也会稍微清理一下表单代码：

```
$('form#signup').on('submit', function(event){
  event.preventDefault();
  var $input = $(this).find('[name=username]');
  console.log($input.val());
  alert($input.val());
}) 
```

您可能也有兴趣查看[`.serialize()`](http://api.jquery.com/serialize/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:32:34.777

您需要阻止表单提交`return false`：

```
$form.submit(function(event){

  var $input=$('#signup :input');
  console.log($input.username);
  alert($input.username);

 // data = array of all the information collected from the input tags
 //data = $form.serizalize(); will also work
 data = $(this).serialize();    

  return false;
}); 
```

`data`将是一个包含您需要的信息的数组，我建议`console.log(data)`您查看它的所有结构，然后您可以根据需要使用它，例如：

```
if(data.something == anything){
    doThis();
} 
```

我强烈建议`;`在你的 javascript 句子末尾添加一个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:35:34.167

您的代码有问题[表单提交没有问题]

`$input.username`是无效的 jQuery 来引用另一个元素。

```
var usernameInput = $input.filter('[name="username"]'); 
```

看起来您没有在 document.ready 上添加代码，因此您可能没有将其附加到任何内容。将其更改为：

```
jQuery( function() {
    $form = $('form#signup');
    $form.submit(function(event){
    });
} 
```

看起来你在 jQuery 代码之前包含了验证代码。我敢打赌，在浏览器中查看 JavaScript 控制台会有一些不错的错误消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-25T20:49:13.050

像其他人一样，我对这样的代码很幸运：

```
$(document).ready(function(){
    // Prevent form submission
    $( "form" ).submit(function( event ) {
      event.preventDefault();
    });
}); 
```

防止表单提交。而且，现在页面上的脚本很常见，这些脚本会在您的背后添加一些糖果涂层功能，例如动画和 HTML 表单的“摇晃”效果。在这种情况下，这些脚本可能会阻碍，因为它们可能有自己的 javascript-fu 用于提交。

# iphone - 如何控制 UIPickerView 组件的滚动？

> ID：11850297
> 
> 赞同：2
> 
> 时间：2012-08-07T16:30:50.033
> 
> 标签：iphone, ios, uipickerview

当第一个组件仍在滚动时，是否可以防止 UIPickerView 中的第二个组件滚动？即让用户一次只滚动一个组件。

如果是，你建议怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:34:11.197

可能最简单的方法是使用透明视图覆盖选择器，该视图可以在选择器滚动时基本上丢弃触摸事件。我相信您将需要发明一种算法来确定选择器是否正在滚动 - 例如，您的数据源是否被要求提供有关某些部分的信息。

当您收到此消息：didSelectRow: 时，您就知道滚动已停止。

在透明视图中，您将需要基本上覆盖选择器，并且只让活动段上方的事件通过。我没有特别这样做，但读过其他人这样做。您应该能够在本网站或 iOS 事件的 Apple 文档中找到有关“吃”或“传递”事件的说明。

另外，如果是我，我会在透明视图中添加三个半透明视图，并为每个视图着色一点不同的颜色，这样您就可以确定是否正确分割了叠加层（即每个部分都正确结束您要阻止的段）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T23:42:28.440

您将不得不子类化 UIScrollView 并覆盖 touchesShouldBegin 和 touchesShouldCancelInContentView 方法。

然后，您可以有几个选项，最简单的方法是将 bool 变量设置为 false，如果一个正在移动，并且如果该 bool 为 false 返回 true，则在触摸中应该取消。

反正我就是这样做的。

# http - 如何强制浏览器不下载带有 content-disposition:attachment 标头的文件

> ID：11850298
> 
> 赞同：5
> 
> 时间：2012-08-07T16:30:53.630
> 
> 标签：http, browser, http-headers, content-disposition

例如：

```
<iframe src="http://otherdomainidontcontrol.com/blah.csv"></iframe> 
```

而 blah.csv 有这个标题：

```
Content-Disposition: attachment; filename=blah.csv; 
```

是否可以强制`blah.csv`在 iframe 中渲染而不是下载？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T17:15:04.817

实际上，我们一直在为我们的应用程序研究这个问题，因为我们希望浏览器能够渲染嵌入的文件，如果它能够这样做 - 如果不能，我们希望浏览器以适当的名称下载文件。

如果您将 Content-Disposition 标头更改为内联而不是附件，它将以这种方式工作 - 如果浏览器能够这样做，浏览器将呈现文件，如果不能，则文件将按照您在Content-Disposition 标头的文件名部分

`response.headers['Content-Disposition'] = "inline; filename=name.extension"`

但是，如果如您所说，您的 blah.csv 带有该标题并且您无法拦截或更改它，那么我同意没有办法解决它。“附件”部分指定要下载的文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-13T08:18:51.347

我认为没有办法绕过 Content-Disposition（出于安全原因，这可能是好的）。

# css - 将元素定位在父元素的底部

> ID：11850306
> 
> 赞同：3
> 
> 时间：2012-08-07T16:31:24.033
> 
> 标签：css

有没有人知道一种干净的、跨浏览器的在父元素的基础上定位元素的方式，而不使用绝对定位？

即，我希望本示例[http://jsfiddle.net/27kwE/21/](http://jsfiddle.net/27kwE/21/)中的粉色和橙色块位于广场的底部，而不是顶部。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:34:46.523

你可以加：

```
display:table-cell;
vertical-align:bottom; 
```

到容器 CSS。

**[jsFiddle 示例](http://jsfiddle.net/j08691/27kwE/9/)**

# javascript - ul 手风琴中的活动非活动链接

> ID：11850308
> 
> 赞同：0
> 
> 时间：2012-08-07T16:31:30.227
> 
> 标签：javascript, jquery, html, css, accordion

我试图让活动和非活动链接在我的手风琴 ul 列表中正常工作。

主菜单正确突出显示，但是一旦我单击菜单或子菜单中的其他链接，该链接就不会突出显示。我试过了`:active`，`:selected`但没有一个不起作用。我在这里创建了一个小提琴：http: [//jsfiddle.net/laziale/zM2Lw/1/](http://jsfiddle.net/laziale/zM2Lw/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:34:47.527

听起来您希望当鼠标悬停在文本上时文本显示为不同的颜色？如果是这样，请尝试编辑 styles.css 的第 803 行以添加新的字体颜色（例如，`color: yellow;`），然后添加新的选择器： `.arrowsidemenu div.unselected a:hover{color:yellow}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:06:14.810

`a:active {color: #123456}`如果您希望链接在单击时更改为某种颜色，那么就是您要查找的内容。`a:visited`将为已经访问过该链接所指向的任何页面的用户更改链接的颜色。

[http://www.w3schools.com/css/css_link.asp](http://www.w3schools.com/css/css_link.asp)

**编辑**

你的 CSS 中的第 871 行`.arrowsidemenu ul li a:hover{ color:Aqua; }`

之后添加一个新类`.arrowsidemenu ul li a:active { color: purple; }`

它会起作用的！

# csv - 逗号分隔文件的单词列表

> ID：11850309
> 
> 赞同：1
> 
> 时间：2012-08-07T16:31:42.450
> 
> 标签：csv, comma

我正在制作一个简单的文字游戏来娱乐，我有一个双重问题。我正在尝试使用 word/excel 或通过 OS X 的 unix 提示将五个字母的单词列表（在屏幕截图的左侧显示）转换为 CSV 文件（在右侧）。所以第一个问题是转txt 文件转换为 CSV 的格式化文本。

我的第二个问题：在我的游戏中，随机出现 5 个字母。您必须对它们重新排序，以便它们从 5000 字的文本文件中组成一个单词。这 5 个随机字母可以是多个单词，例如为“among”提供的字母也可以是“mango”。所以我的问题是是否可以通过 5000 字的文本文件并找到（并排列）可以用相同字母组成的单词？

任何提示或帮助将不胜感激！

截图：http: [//i.stack.imgur.com/2EVpB.png](http://i.stack.imgur.com/2EVpB.png)

# jquery - 以编程方式更改内容时检测文本框更改

> ID：11850310
> 
> 赞同：1
> 
> 时间：2012-08-07T16:31:51.583
> 
> 标签：jquery

我有一个文本框，它链接到这样的 jquery 事件处理程序：

```
$('#SomeDiv').on({

   mouseenter: ....
   mouseleave: ....
   blur: ....
   keyup: function() { HandlerForKeyUp($(this)); } ,
   change: function() { HandlerForKeyUp($(this)); } 

}, '.MyTextBoxes'); 
```

基本上，`HandlerForKeyUp`是一个显示文本框中字母数量的计数器的功能。当用户输入时它工作正常。

但是，如果我这样写：

```
$('#SomeTextBox').val(SomeValue); 
```

HandlerForKeyUp 函数不会触发，即使我已经`change`在处理程序中映射了事件`.on`并且 SomeTextBox 属于类`MyTextBoxes`并对所有其他事件做出反应。基本上，如果用户键入计数器有效，但如果我在运行时设置文本框的值，则计数器函数不会触发。

关于如何改变这一点的任何想法？

感谢您的建议。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T16:34:40.260

您需要手动触发更改事件。

`$('#SomeTextBox').val(SomeValue).change();`

# python - 2D 到 3D numpy 数组的高效转换

> ID：11850312
> 
> 赞同：1
> 
> 时间：2012-08-07T16:31:58.390
> 
> 标签：python, arrays, numpy

我有一个数据数组，其中包含 N 个粒子在时间步长 1 到 M 上的 ndim 坐标。数组中的列通常代表每个粒子“p”的 (x,y,z)，数组中的每一行代表另一个时间点' t'：

```
x_t1p1  y_t1p1  z_t1p1  x_t1p2  y_t1p2  z_t1p2  ...  x_t1pN  y_t1pN  z_t1pN
x_t2p1  y_t2p1  z_t2p1  x_t2p2  y_t2p2  z_t2p2  ...  x_t2pN  y_t2pN  z_t2pN
...
x_tMp1  y_tMp1  z_tMp1  x_tMp2  y_tMp2  z_t1p2  ...  x_tMpN  y_tMpN  z_tMpN 
```

我想将数组转换为 3D 格式，以便每个粒子位于 numpy 数组的不同（M x ndim）“切片”中。我目前正在执行以下操作：

```
import numpy as np
def datarray_to_3D(data, ndim=3):
    (nr,nc) = data.shape
    nparticles = nc/ndim
    dat_3D = np.zeros([nr,ndim,nparticles])
    for i in range(nparticles):
        dat_3D[:,:,i] = data[:,i*ndim:(i+1)*ndim]
    return dat_3D 
```

我有 NumPy 的基本知识，但想提高我对数组操作的熟练程度。如何重写上述函数以消除循环并使用更“NumPythonic”的结构？

谢谢你。

-C

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:44:46.657

原始解决方案，与您的功能略有不同。

```
def datarray_to_3D(data, nparticles=3):
    nr, nc = data.shape
    data = data.reshape(nr, nparticles, nc/nparticles)
    return np.rollaxis(data, 2, 1) 
```

更新：我已经更新了我的原始答案，以使我的错误更清楚，感谢 unutbu 抓住它。我的解决方案`nparticles`作为一个论点而不是`ndim`where `nparticles * ndim == data.shape[1]`。我犯了这个错误，部分原因是我更改了变量的名称`ndim`。在这种情况下，我会避免`ndim`用作变量名，因为它`data.ndim`与数组维数的属性过于相似。这是更新的解决方案，但我已经替换`ndim by`了 dim1`。它更类似于您的原始功能。

```
def datarray_to_3D(data, dim1=3):
    nr, nc = data.shape
    data = data.reshape(nr, nc/dim1, dim1)
    return np.rollaxis(data, 2, 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:50:45.447

怎么样：

```
def alt_3D(data, ndim=3):
    nr, nc = data.shape
    result = data.reshape(nr,-1,3).transpose(0,2,1)
    return result 
```

例如，如果

```
data = np.arange(18).reshape((-1,6)) 
```

然后`alt_3D(data)`产生：

```
[[[ 0  3]
  [ 1  4]
  [ 2  5]]

 [[ 6  9]
  [ 7 10]
  [ 8 11]]

 [[12 15]
  [13 16]
  [14 17]]] 
```

（这与 Bago 的答案不同。）

# wpf - Josh Smith 的 MVVM 选项卡未选中

> ID：11850315
> 
> 赞同：0
> 
> 时间：2012-08-07T16:32:09.540
> 
> 标签：wpf, mvvm, observablecollection, tabitem

我有一个 MVVM 应用程序，它使用像 Josh Smith 的示例这样的选项卡。每个 TabItem (View) 代表一个单独的 ViewModel。

在某些视图上，有绑定到 ObservableCollections 的 DataGrid。到目前为止一切正常。但是，当我开始编辑数据网格时，例如在单元格中键入内容，然后在点击“输入”提交更改之前，切换到另一个选项卡，我真的无法回到前一个选项卡。Tab 内容发生变化，但 tabitem 保持未选中状态。我想我必须以某种方式停止数据网格的编辑模式，但我该如何在 MVVM 应用程序中做到这一点？对于 ICollectionViewSource 我知道我可以这样做

```
 IEditableCollectionView list = (ListCollectionView)this.ItemsView;
  if (list.IsEditingItem) list.CommitEdit();
  if (list.IsAddingNew) list.CommitNew(); 
```

但我不能为 ObservableCollection 做到这一点。我是否必须将绑定更改为可观察集合的视图，还是有其他方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T15:04:03.843

要自动退出网格的编辑模式，请查看这个 SO 问题：[WPF DataGrid - 如何自动退出编辑模式？](https://stackoverflow.com/questions/4880270/wpf-datagrid-how-to-automatically-exit-edit-mode)

我还建议查看必须`IEditableObject`在网格中编辑的模型类的接口。这为您提供了一种一致的方式来实现**添加**数据并针对对象数据的更改（或更改的**回滚）对其进行****编辑**。

 **`IEditableObject`要求您实现以下方法：

```
BeginEdit()
CancelEdit()
EndEdit() 
```

DataGrid 已经被设计为使用`IEditableObject`开箱即用的对象。

WPF 博士在这里写了一篇关于接口的好文章：[ItemsControl: 'E' is for Editable Collection](http://drwpf.com/blog/2008/10/20/itemscontrol-e-is-for-editable-collection/)并且在这篇 MSDN 文章中有一些用于将 IEditableObjects 与 dataGrid 一起使用的示例代码：[How to: Implement Validation with the DataGrid Control](http://msdn.microsoft.com/en-us/library/ee622975.aspx)**

# ruby - 计算红宝石中特定数组值的总和？

> ID：11850319
> 
> 赞同：0
> 
> 时间：2012-08-07T16:32:32.187
> 
> 标签：ruby, arrays, hashmap, hash-of-hashes, pivotaltracker

Pivotal Tracker 是我使用的一个项目管理工具。我正在使用 Pivotal Tracker Ruby Gem 来访问 API。

我正在尝试使用他们分配给他们的点数创建每个成员的哈希值。

最终结果应类似于：

```
{"Joe Jones"=>5, "Jane Smith"=>6, "John Doe"=>3} 
```

我已经在`@members`.

我编写了下面的代码来帮助我创建每个成员的哈希值以及他/她分配的相应数量的故事，但我真正需要的是`estimate`分配给他们的每个故事的值的总和（估计是一个给定的故事）。

```
#creates a hash of members to number of stories assigned.
    for i in 0..@members.length-1
      my_hash[@members[i]] = project.stories.all(:owned_by => @members[i], :current_state => ['started', 'unstarted']).length
    end 
```

所以，我想知道，对于每个成员，我如何总结该特定成员`estimate`的每个故事的价值。**注意**：未估计的故事在估计字段中有-1，不应包含在总和中。`owned_by`

 **关于如何修改上述循环以遍历每个故事并对估计值求和（不包括负 1s）的任何帮助将不胜感激。我觉得有一些不错的 Ruby 柔术可以完成这件事！

`project.stories.all(:owned_by => @members[i], :current_state => ['started', 'unstarted'])`如果人们想知道格式，则返回的示例数据：

```
[#<PivotalTracker::Story:0x007f9d6b8 @id=314, @url="http://www.pivotaltracker.com/", @created_at=#<DateTime: 2012-06-18T20:23:42+00:00 ((2456097j,73422s,0n),+0s,2299161j)>, @accepted_at=nil, @project_id=12345, @name="Test ", @description="This is the description for \"Test\"", @story_type="feature", @estimate=5, @current_state="unstarted", @requested_by="joe jones", @owned_by="joe jones", @labels=nil, @jira_id=nil, @jira_url=nil, @other_id=nil, @integration_id=nil, @deadline=nil, @attachments=[]>, #<PivotalTracker::Story:0x007f9d6b8 @id=315, @url="http://www.pivotaltracker.com/", @created_at=#<DateTime: 2012-06-18T20:25:20+00:00 ((2456097j,73520s,0n),+0s,2299161j)>, @accepted_at=nil, @project_id=12345, @name="Test 2", @description="This is the description for \"Test 2\"", @story_type="feature", @estimate=3, @current_state="unstarted", @requested_by="joe jones", @owned_by="joe jones"", @labels=nil, @jira_id=nil, @jira_url=nil, @other_id=nil, @integration_id=nil, @deadline=nil, @attachments=[]>, #<PivotalTracker::Story:0x007f9d6b8 @id=316, @url="http://www.pivotaltracker.com/story/", @created_at=#<DateTime: 2012-06-18T20:25:26+00:00 ((2456097j,73526s,0n),+0s,2299161j)>, @accepted_at=nil, @project_id=12345, @name="Test 3", @description="Description for Test 3 ", @story_type="feature", @estimate=-1, @current_state="started", @requested_by="joe jones", @owned_by="joe jones", @labels=nil, @jira_id=nil, @jira_url=nil, @other_id=nil, @integration_id=nil, @deadline=nil, @attachments=[]>] 
```

PS 关于如何使这个标题更具描述性的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:06:02.507

我想这就是你要找的东西：

```
for i in 0..@members.length-1
  my_hash[@members[i]] = project.stories.all(:owned_by => @members[i], :current_state => ['started', 'unstarted']).inject(0) do |sum, single_story|
    single_story.estimate > 0 ? sum + single_story.estimate : sum
  end
end 
```

查看文档[Enumerable#inject](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-inject)了解详细信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:35:16.300

只需在此处编写打高尔夫球的代码，但此代码段也可以解决问题！

```
Hash[@members.collect {|member| Array(member, Project.storie_estimates_for(@member).inject(&:+))}] 
```

我会在`Project`模型中添加 storie_estimates_for(member) 方法，该方法将为该成员的所有故事返回一组估计值（当然不是负数！）！

FWIW，`for`循环被认为是邪恶的！[http://blog.grayproductions.net/articles/the_evils_of_the_for_loop](http://blog.grayproductions.net/articles/the_evils_of_the_for_loop)

此外，[inject](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-inject)是一种使用累加器将数组缩减为单个对象的方法。如果您查看`inject`方法的形状：

```
ary.inject(initial) {|accumulator, element| do_something_with_accumulator_and_element } 
```

返回累加器的最终值。**

# nuget - 在 IIS 5.1 上创建 NuGet 服务器

> ID：11850326
> 
> 赞同：0
> 
> 时间：2012-08-07T16:33:03.153
> 
> 标签：nuget, iis-5, nuget-server

我想创建一个远程 NuGet 服务器。我已按照此处的说明进行操作：

[http://docs.nuget.org/docs/creating-packages/hosting-your-own-nuget-feeds](http://docs.nuget.org/docs/creating-packages/hosting-your-own-nuget-feeds)

当我 F5 并在调试模式下查看它时，一切正常......所以我决定发布到远程服务器。

一切都很好，除了...当我从默认页面单击“此处”链接查看包提要时...我收到 404 错误。我在调试模式下没有收到此错误。

我假设它没有正确地提供饲料。任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T20:16:47.587

我也试图让同一台服务器在 IIS 5 站点上运行，但无论我似乎更改了哪些设置，我都无法让它工作。

相反，我最终使用了[ProGet](http://inedo.com/proget)，它带有自己的内置 Web 服务器并且是免费的。

希望这可以帮助，

-朗尼

# mysql - 视图中的 MySQL 交叉表

> ID：11850333
> 
> 赞同：0
> 
> 时间：2012-08-07T16:33:33.123
> 
> 标签：mysql, views, pivot, crosstab, unpivot

我有以下数据。

```
RecordID    |RecValue1  |RecValue2  |RecValue3              |Fields
1072        |130227     |0          |                       |Document_Number
1072        |1241388    |0          |                       |Supplier_Number
1072        |20008968   |0          |                       |Invoice_Number
1072        |           |0          |1995-04-21 00:00:00    |Invoice_Date
1072        |           |0          |1995-04-23 00:00:00    |Posting_Date
1072        |Invoice    |0          |                       |Document_Type
1072        |           |0          |1995-05-12 17:46:32    |Paid_Date
1072        |F609       |0          |                       |Entry_ID 
```

有没有办法在视图中创建交叉表。Fields 列包含字段标题，并且每个相应的字段都应该有其关联的值，但具有 1 个记录 ID。因此，在示例中，RecordID 1072 应汇总为一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:56:06.240

您的部分问题是您的表结构。不幸的是 MySQL 没有`PIVOT/UNPIVOT`函数，所以你需要用一个`UNION ALL`then`CASE`语句来做到这一点：

```
SELECT RecordId,
  MAX(CASE WHEN Fields = 'Document_Number' THEN recvalue END)  Document_Number,
  MAX(CASE WHEN Fields = 'Supplier_number' THEN recvalue END)  Supplier_number,
  MAX(CASE WHEN Fields = 'Invoice_number'  THEN recvalue END)  Invoice_number,
  MAX(CASE WHEN Fields = 'Invoice_Date' THEN recvalue END)  Invoice_Date,
  MAX(CASE WHEN Fields = 'Posting_Date' THEN recvalue END)  Posting_Date,
  MAX(CASE WHEN Fields = 'Document_type' THEN recvalue END)  Document_type,
  MAX(CASE WHEN Fields = 'Paid_Date' THEN recvalue END)  Paid_Date,
  MAX(CASE WHEN Fields = 'Entry_ID' THEN recvalue END)  Entry_ID
FROM
(
  SELECT RecordId, RecValue1 RecValue, fields
  FROM test
  UNION ALL
  SELECT RecordId, RecValue2 RecValue,fields
  FROM test
  UNION ALL
  SELECT RecordId, RecValue3 RecValue, fields
  FROM test
) unpvt
GROUP BY RecordId 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/72dae/13)

此查询从三个 recvalue 列中获取所有值并将其放入一列，以便您可以将这些值转换为单行数据。

# sql-server - sql server coalesce 获取第一个非空日期

> ID：11850334
> 
> 赞同：1
> 
> 时间：2012-08-07T16:33:35.707
> 
> 标签：sql-server, sql-server-2008, sql-server-2005

我正在使用 SQL Server 2008。我想知道这是否是获得第一个非空日期的最佳代码：

```
 select actualdate = coalesce((select date1 from table1), (select date2 from table2)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:10:17.083

您可以`IsNull`在这种情况下使用。

* * *

`Coalesce``Not Null`当你有超过一列来获得价值时应该使用。

## 例子

```
select ISNULL((select top 1 OBJECT_ID from sys.objects), 0)
go
select coalesce((select top 1 OBJECT_ID from sys.objects), 0) 
```

**[单击此处查看 SQL Profiler 阅读](http://i.stack.imgur.com/LuuZB.png)**

* * *

您`Top`在查询中缺少语句，否则您可能会遇到以下错误。

> 子查询返回超过 1 个值。当子查询跟随 =、!=、<、<=、>、>= 或子查询用作表达式时，这是不允许的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T06:16:12.700

如果您可以使用一些通用 id 连接两个表，则可以使用以下查询。

```
select @actualdate = CASE WHEN t1.date1 is null then t2.date else t1.date end
from table1 t1 inner join table2 t2
on t1.id=t2.id 
```

如果您在这 2 个表之间没有任何共同的 id，请尝试使用带有 row_number() 的 CTE 来加入 2 个表。

# c - 如何在 linux 上链接 .la 库文件

> ID：11850336
> 
> 赞同：6
> 
> 时间：2012-08-07T16:33:52.287
> 
> 标签：c, linux, gcc, shared-libraries

我正在使用一个开源库，它构建到像 libshared.la 这样的文件。我可以使用普通的 gcc 命令静态链接这个文件吗？我比较熟悉 .so 文件的动态链接和 .a 文件的静态链接。虽然不确定.la。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-07T16:36:58.677

那是一个 libtool 文件。您可以使用它`libtool`：

```
$ libtool --mode=link gcc -g -O -o test test.o \
                     /usr/local/lib/libhello.la 
```

更多关于`libtool`：

*   [http://www.gnu.org/software/libtool/manual/html_node/Using-libtool.html](http://www.gnu.org/software/libtool/manual/html_node/Using-libtool.html)

# c# - 如何在 C# 中使用 stringbuilder 添加图像按钮？

> ID：11850339
> 
> 赞同：0
> 
> 时间：2012-08-07T16:33:57.200
> 
> 标签：c#, imagebutton, stringbuilder

我想在后面的 c# 代码中添加图像按钮。我正在使用 stringBuilder 在后面的代码中创建我的 html 标签。我想添加带有 html 标记的图像按钮。我该怎么做呢？

```
 StringBuilder sbWorkMap = new StringBuilder();
    IList<WorkMapNode> workMapNode = 
    WorkMapNode.GetByWorkMapModuleId(item.WorkMapModuleId); 

    foreach (var node in workMapNode) {

    ImageButton imgBtn = new ImageButton();
    imgBtn.ID = node.WorkMapNodeId.ToString();
    imgBtn.ImageUrl = "~/images/check.jpg";

    if (node.Url != null) {
            sbWorkMap.Append("<h4><a href='" + node.Url + "'>" + node.Name + "</a></h4>");
    }
    else {
            sbWorkMap.Append("<h4>" + node.Name + "</h4>");
    }
}

// I'm adding the string builder to Place holder control
phWorkMap.Controls.Add(new LiteralControl(sbWorkMap.ToString())); 
```

**问题**

如何将 imgBtn 添加到 sbWorkMap？我想为我创建的每个节点添加图像按钮！

**应该看起来像这样**

ImageButton1 节点 1

ImageButton2 节点 2

ImageButton3 节点 3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:46:25.477

无需渲染 HTML，您可以直接将图像添加到页面：

```
ImageButton imgBtn = new ImageButton();

imgBtn.ImageUrl = @"~images\April.jpg";

this.Form.Controls.AddAt(0, imgBtn); 
```

索引是应该放置图像的位置。您也可以将其放置在其他控件中。

# facebook - 是否可以使用 Facebook 图表访问 Facebook 上的用户群组？

> ID：11850341
> 
> 赞同：1
> 
> 时间：2012-08-07T16:34:00.320
> 
> 标签：facebook, facebook-graph-api

我的意思是当人们可以制作朋友的子列表时（即工作朋友、家人、亲密朋友）。

是否可以访问这些，因为我希望我的应用程序让用户定位特定的朋友群以向其发送消息，而无需手动选择每个人？

任何对“facebook 群组”、“facebook 朋友群组”或“朋友列表”的搜索都会显示有关如何访问主要朋友列表的信息——我已经可以做到了。

有没有人设法做到这一点？一方面我认为由于隐私问题可能会被禁止，另一方面我认为 Facebook 更希望用户可以在应用程序中向朋友群发送消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T16:37:44.073

你肯定可以得到这些数据。有一个特定的[权限](https://developers.facebook.com/docs/authentication/permissions/)称为`user_friendlists`. 您必须向您的用户请求该权限，一旦获得该权限，您所要做的就是查询此 Graph 端点 -

```
https://graph.facebook.com/USER_ID/friendlists 
```

它会返回与此类似的数据 -

```
{
  "data": [
    {
      "id": "XXX", 
      "name": "Close Friends", 
      "list_type": "close_friends"
    }, 
    {
      "id": "YYY", 
      "name": "♥", 
      "list_type": "user_created"
    }, 
    {
      "id": "ZZZ", 
      "name": "Offline", 
      "list_type": "user_created"
    }, 
    {
      "id": "AAA", 
      "name": "The Office", 
      "list_type": "work"
    }, 
    {
      "id": "BBB", 
      "name": "Acquaintances", 
      "list_type": "acquaintances"
    }, 
    ... 
```

如您所见，这里有两种类型的朋友列表。自动生成的，例如

*   亲密的朋友
*   熟人

还有一些我手动创建的自定义 -

*   ♥</li>
*   离线
*   办公室

要获取这些列表中列出的实际朋友，请使用`/members`终点。

```
https://graph.facebook.com/USER_ID/FRIENDLIST_ID/members 
```

* * *

这只是*读取*权限，您需要额外的权限`manage_friendlists`才能创建/编辑这些列表。

# java - 将 JTable 添加到 JTabbedPane？

> ID：11850344
> 
> 赞同：2
> 
> 时间：2012-08-07T16:34:21.157
> 
> 标签：java, swing, jtable, jtabbedpane

我正在尝试将 JTable 添加到 JTabbedPane。它很好，但是，列的标题不可见。

这是我的代码的相关点点滴滴：

```
JTabbedPane jp = new JTabbedPane();
static JTable t1 = new JTable();
static MainFrame f = new MainFrame();
static DefaultTableModel model = new javax.swing.table.DefaultTableModel(); 

    f.scroll.add(jp);
    f.scroll.setViewportView(jp);
    jp.addTab("Tab 1", null, t1, "");
    t1.setModel(model);

    model.addColumn("Description");
    model.addColumn("Change");
    model.setRowCount(1);
    model.fireTableStructureChanged(); 
```

其中 f 是 JFrame 而 f.scroll 是 JScrollPane

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:39:22.627

1.  添加`JTable`到`JScrollPane`then`TableHeader`应该是可见的，然后添加`JScrollPane`到`JTabedpane`，否则必须以`TableHeader`编程方式添加

2.  不要调用`model.fireTableStructureChanged();`，这个事件在 used 中正确实现`DefaultTableModel`

3.  更好的方法是创建列，添加行，将这两个值放入[DefaultTableModel](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/DefaultTableModel.html#DefaultTableModel%28java.util.Vector,%20int%29)（[Object](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/DefaultTableModel.html#DefaultTableModel%28java.lang.Object%5B%5D%5B%5D,%20java.lang.Object%5B%5D%29)或[Vector](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/DefaultTableModel.html#DefaultTableModel%28java.util.Vector,%20java.util.Vector%29)）

4.  将此模型添加到`JTable`，例如`table = new JTable(myModel);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:43:01.700

不要将 JTabbedPane 添加到滚动窗格，然后将表格添加到选项卡窗格，只需将选项卡窗格添加到框架 (f)，然后将滚动窗格添加到其中的选项卡 1，然后将表格设置为视口滚动窗格。

结构：

```
JFrame {
    JTabbedPane {
        Tab 1 {
            JScrollPane {
                JTable
            }
        }
        Tab 2 {

        }
        tab 3 {

        }
    }
} 
```

# python - 使用 python lxml.etree 处理巨大的 XML 文件

> ID：11850345
> 
> 赞同：22
> 
> 时间：2012-08-07T16:34:25.530
> 
> 标签：python, lxml

我想`lxml.etree`在 Python 中解析一个巨大的 xml（>200MB）。我尝试使用`etree.parse`加载 XML 文件，但由于文件大小，这不起作用：

```
etree.parse('file.xml')Traceback (most recent call last):
File "<stdin>", line 1, in <module>
  File "lxml.etree.pyx", line 2706, in lxml.etree.parse (src/lxml/lxml.etree.c:49958)
  File "parser.pxi", line 1500, in lxml.etree._parseDocument (src/lxml/lxml.etree.c:71797)
  File "parser.pxi", line 1529, in lxml.etree._parseDocumentFromURL (src/lxml/lxml.etree.c:72080)
  File "parser.pxi", line 1429, in lxml.etree._parseDocFromFile (src/lxml/lxml.etree.c:71175)
  File "parser.pxi", line 975, in lxml.etree._BaseParser._parseDocFromFile (src/lxml/lxml.etree.c:68173)
  File "parser.pxi", line 539, in lxml.etree._ParserContext._handleParseResultDoc (src/lxml/lxml.etree.c:64257)
  File "parser.pxi", line 625, in lxml.etree._handleParseResult (src/lxml/lxml.etree.c:65178)
  File "parser.pxi", line 565, in lxml.etree._raiseParseError (src/lxml/lxml.etree.c:64521)
lxml.etree.XMLSyntaxError: Excessive depth in document: 256 use XML_PARSE_HUGE option, line 1276, column 7 
```

由于我想使用 xpath 表达式，我必须先解析文件。因此，我如何解析 XML 文件？我如何使用`XML_PARSE_HUGE`连接到`lxml.etree`？

谢谢！

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-08-07T16:41:07.767

尝试创建一个自定义`XMLParser`实例：

```
from lxml.etree import XMLParser, parse
p = XMLParser(huge_tree=True)
tree = parse('file.xml', parser=p) 
```

# objective-c - 根据变量的内容访问不同的单例数据

> ID：11850347
> 
> 赞同：-1
> 
> 时间：2012-08-07T16:34:29.680
> 
> 标签：objective-c, variables, cocos2d-iphone, singleton

我在 iPhone 上使用 cocos2d，我设置了一个单例来存储玩家的所有数据和变量，我需要知道这是否可行，所以在伪代码中它会是这样的：

```
players * playersDataManager = [players playersSaveDataManager];
selected = "sword"
name = (@"%@AttRange",selected);
AttRange = playersDataManager.name; 
```

会根据选择的玩家而`name`改变，因此 `AttRange 也会改变。我只是不知道如何在实际代码中设置它。这是我正在使用的实际代码：

```
-(void)showAttackRange:(NSMutableString *)selected {
    players * playersDataManager = [players playersSaveDataManager];
    NSMutableString * name1 = [NSMutableString stringWithString:@"MaxRange"];
    [name1 insertString:selected atIndex:0];

    int r = [playersDataManager valueForKey:name1];
    NSLog(@"%@%i",name1,r);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:51:22.387

它被称为“键值编码”

要在您的示例代码中使用它：

```
Players * playersDataManager = [Players playersSaveDataManager];
NSString *selected = @"sword"; 
NSString *propertyName = [NSString stringWithFormat:@"%@AttRange", selected);
AttRange value = [playersDataManager valueForKey:propertyName]; 
```

假设您的`Players`类具有类型和名称的属性，该属性`AttRange swordAttRange`是`@synthesized`带有默认访问器的，或者，如果您为属性指定了自定义访问器，它们将遵循预期的命名方案。

（有关 KVC 在访问器命名方案方面的期望的更多信息，请阅读文档...）

Apple 文档：[键值编码编程指南](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/KeyValueCoding.html)

编辑：使用 KVC 获取标量值返回一个`NSNumber`对象：[Apple Documentation -> KVC Scalar and Structure support](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/KeyValueCoding/Articles/DataTypes.html#//apple_ref/doc/uid/20002171-BAJEAIEE)

# security - htaccess 一次允许 1 个唯一的 url/链接访问页面

> ID：11850350
> 
> 赞同：0
> 
> 时间：2012-08-07T16:34:34.963
> 
> 标签：security, .htaccess

我在 wordpress 中使用 S2member 插件来生成对 PPV 内容（体育赛事视频）的访问。这设置为付款后的单页访问。当用户点击购买时，它会将他们带到贝宝，然后在付款后将他们重定向回受限页面，并使用唯一的 url 字符串something.com/?s2member_sp_access=635v545d52504p4i4q5v645n5c3j313e5f3c3u493t3d3h3d323d5e4a3t3v3a3c3737373135483c3uh4f3b49483c3uh4f3

现在我的问题是，虽然每个购买的用户都会获得一个唯一的 url 字符串，但他们可以将其复制并发送给其他人，并将内容访问权限授予他们想要的任何其他人，而无需付费。

我想关闭这个漏洞，方法是设置一些东西，只允许一个唯一的 url（字符串）同时访问页面。因此，即使他们将网址泄露出去，也只有一个人可以同时进入，从而导致多个用户免费使用。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:49:39.480

最终，对于希望重新分发内容的用户，您无能为力。即使您将 URL 设为一次性使用，客户仍然可以下载一次并复制给其他人。为了抵消这种情况，您可能会考虑使用水印使每个客户的内容都独一无二，这样您至少可以知道是哪个客户重新分发了内容，如果您在野外找到副本。

话虽如此，您提出的问题没有意义。您说“只允许一个唯一的 url（字符串）同时访问页面”但是 url（字符串）不访问网页，用户代理可以！

至少有两件事可以让客户更难重新分发用于下载内容的 URL，并可能阻止随意重新分发的尝试。两者都要求您在访问 URL 时运行一些代码（脚本等），它们本身并不是您将要进行的配置`.htaccess`。

*   使 URL 一次性使用。

    每当访问唯一 URL 时，请检查一个数据库，该数据库标记每个唯一 URL 之前是否已被使用过。如果之前没有使用过，请标记为已使用。如果之前已经使用过，则拒绝该请求。

    **亲**：容易

    **缺点**：对于下载中断或中断的用户来说*非常*烦人。他们不能重试！

*   使用 cookie 使 URL 仅在一个浏览器中有效。

    每当访问唯一 URL 时，检查用户代理是否提供了具有特定名称的 cookie。如果不是，这可能是第一次访问此 URL。检查您的数据库，看看是否应该已经为这个唯一的 URL 设置了 cookie。如果是，则拒绝该请求。如果否，则为此 cookie 选择一个新的随机值并将其设置在您的数据库中，然后将其与响应一起返回。如果用户代理*确实*提供了一个 cookie，请根据您的数据库检查它的值以确保它是正确的，并且只有在是时才允许请求。

    **优点**：一位客户可以从一个浏览器无限次访问该 URL

    **缺点**：聪明的用户可以从他们的浏览器中复制 cookie 值并将其发布，以便其他人可以在他们的浏览器中手动设置它并阻止您的保护方案。

# javascript - 具有不同纹理的多个体素。表现

> ID：11850359
> 
> 赞同：1
> 
> 时间：2012-08-07T16:34:53.847
> 
> 标签：javascript, three.js

我需要将多个体素（立方体等于）添加到同一个场景几何体中，但每个体素都有不同的纹理。

由于有超过 500 个体素，我的性能存在严重错误。

这是我的代码：

```
texture = crearTextura(voxel.text,color,voxelSize);
material = new THREE.MeshBasicMaterial({ map: texture });       
mesh = new THREE.Mesh(new THREE.CubeGeometry(voxelSize, voxelSize, voxelSize, 1, 1, 1,material),faceMaterial);
scene.add(mesh); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T00:31:48.263

您需要将所有立方体批处理成一个几何体。

看看这个例子： http: [//mrdoob.github.com/three.js/examples/webgl_geometry_minecraft.html](http://mrdoob.github.com/three.js/examples/webgl_geometry_minecraft.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T16:04:20.673

最后，我创建了一个与所有立方体的 geoemtry 合并。

在此更改之前，我曾在多维数据集中通过鼠标单击来处理交叉点。

我尝试解决这个问题，但没有奏效：

使用所有网格添加几何合并和数组的代码：

```
var geometry = new THREE.Geometry();
for( var i = 0; i < voxels.length; i++ ){
  var voxel = voxels[i];
  color = voxel.color; 
  texture = textPlaneTexture(voxel.text,color,voxelSize);
  material = new THREE.MeshBasicMaterial({ map: texture });            
  mesh = new THREE.Mesh(new THREE.CubeGeometry(voxelSize, voxelSize, voxelSize, 1, 1, 1, material));

  mesh.name = voxel.name;
  mesh.position.x = voxel.x * voxelSize + offset_x;
  mesh.position.y = voxel.y * voxelSize + offset_y;
  mesh.position.z = voxel.z * voxelSize + offset_z;

  //  
  objects.push( mesh );

  THREE.GeometryUtils.merge( geometry, mesh );
}

//Add geometry to scene
mesh = new THREE.Mesh( geometry, new THREE.MeshFaceMaterial() );
scene.add( mesh );      
... 
```

双击鼠标事件

```
function onDocumentMouseDoubleClick( event ) {
  if (event.target instanceof HTMLCanvasElement) {
    event.preventDefault();

    mouse2D.x = ( event.clientX / widthChart ) * 2 - 1;
    mouse2D.y = - ( (parseInt(event.clientY) - offset_mouse_y) / heightChart ) * 2 + 1;     

    mouse3D = projector.unprojectVector( mouse2D.clone(), camera );
            ray.direction = mouse3D.subSelf( camera.position ).normalize();
    var intersects = ray.intersectObjects( objects );

    if ( intersects.length > 0 ) {
      if ((intersects[ 0 ].object.name != 'undefined') && (intersects[ 0 ].object.name != '')) {
        //Object clicked
      };
    };      
  };
}; 
```

# c# - 仅当图像较新时如何从 HTTP 下载图像？

> ID：11850360
> 
> 赞同：6
> 
> 时间：2012-08-07T16:34:53.957
> 
> 标签：c#, .net, http

我想实现以下功能：

1.  AC# 客户端连接到 HTTP 服务器并将图像下载到磁盘。

2.  下次客户端启动时会检查服务器上的图像是否比磁盘上的图像新，在这种情况下，客户端会覆盖磁盘上的图像。

对我来说，下载图像很容易，但我不确定如何检查服务器上的图像是否更新。我怎么能实现它？我想我可以检查时间戳或图像大小（或两者），但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T16:40:43.280

尝试`If-Modified-Since`请求字段。[http://en.wikipedia.org/wiki/List_of_HTTP_header_fields](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields) 我不确定每个服务器都完全支持它。因此，如果不支持它并且您仍然会获得文件（如果支持则不是 304），您可以计算校验和，如果它们不同，请考虑修改文件。或者只是覆盖 - 你将永远拥有最新版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T17:06:16.827

HttpWebRequest 可以只使用 IE 缓存，所以如果所有图像都将在该缓存中，并且重写文件（但不必下载）的成本是可以接受的，您可以使用它。

如果您需要自己处理，那么：

鉴于：

```
string uri; //URI of the image.
DateTime? lastMod; // lastModification date of image previously recorded. Null if not known yet.
string eTag; //eTag of image previously recorded. Null if not known yet. 
```

您必须在最后存储这些，并在开始时再次检索它们（当不是新图像时）。这取决于你，因为剩下的工作：

```
var req = (HttpWebRequest)WebRequest.Create(uri);
if(lastMod.HasValue)
  req.IfModifiedSince = lastMod.Value;//note: must be UTC, use lastMod.Value.ToUniversalTime() if you store it somewhere that converts to localtime, like SQLServer does.
if(eTag != null)
  req.AddHeader("If-None-Match", eTag);
try
{
  using(var rsp = (HttpWebResponse)req.GetResponse())
  {
    lastMod = rsp.LastModified;
    if(lastMod.Year == 1)//wasn't sent. We're just going to have to download the whole thing next time to be sure.
      lastMod = null;
    eTag = rsp.GetResponseHeader("ETag");//will be null if absent.
    using(var stm = rsp.GetResponseStream())
    {
      //your code to save the stream here.
    }
  }
}
catch(WebException we)
{
  var hrsp = we.Response as HttpWebResponse;
  if(hrsp != null && hrsp.StatusCode == HttpStatusCode.NotModified)
  {
    //unfortunately, 304 when dealt with directly (rather than letting
    //the IE cache be used automatically), is treated as an error. Which is a bit of
    //a nuisance, but manageable. Note that if we weren't doing this manually,
    //304s would be disguised to look like 200s to our code.

    //update these, because possibly only one of them was the same.
    lastMod = hrsp.LastModified;
    if(lastMod.Year == 1)//wasn't sent.
      lastMod = null;
    eTag = hrsp.GetResponseHeader("ETag");//will be null if absent.
  }
  else //some other exception happened!
    throw; //or other handling of your choosing
} 
```

正确实施时，电子标签比上次修改的更可靠（注意更改的亚秒级分辨率，并反映由于不同的 Accept-* 标头而导致的不同响应）。虽然有些实现是错误的（没有特别调整的网络场上的 IIS6，带有 mod-gzip 的 Apache），因此值得取出与电子标签相关的代码并按日期进行。

编辑：如果您想进一步实现 HTTP 缓存，您还可以存储 expires 和 max-age （如果它们都存在并且不同意前者，则使用后者）并完全跳过下载，如果它早于那些值建议。我已经这样做了并且效果很好（我有一个由各种 URI 返回的 XML 创建的对象的内存缓存，如果 XML 是新的或没有更改，我会重新使用该对象），但是它可能与您的需求无关（如果您希望比服务器建议的更新鲜，或者如果您总是在那个窗口之外）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T16:45:19.607

您需要阅读[RFC 2616和相关 RFC（在](http://www.rfc-editor.org/rfc/rfc2616.pdf)[http://www.rfc-editor.org/cgi-bin/rfcsearch.pl](http://www.rfc-editor.org/cgi-bin/rfcsearch.pl)搜索 1616 ）。特别值得一提的是，第 13 节*，HTTP 中的缓存*，第 47-62 页。然后阅读相关的请求/响应标头和您可能会返回的相关状态代码。

`HttpWebRequest`您可以通过和`HttpWebResponse`类访问所有标题和状态值。

但是应该注意，您可以向服务器询问您想要的任何内容：最终是服务器决定是否向您发送该 URI 的新表示。您可能希望使用 HTTP[`HEAD`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4)动词而不是其[`GET`](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3)动词来向服务器询问资源。

> HEAD 方法与 GET 相同，只是服务器不能在响应中返回消息体。响应 HEAD 请求的 HTTP 标头中包含的元信息应该与响应 GET 请求发送的信息相同。此方法可用于获取有关请求所隐含的实体的元信息，而无需传输实体主体本身。这种方法通常用于测试超文本链接的有效性、可访问性和最近的修改。

# c++ - c++ omp 原子捕获 - 语法？

> ID：11850367
> 
> 赞同：3
> 
> 时间：2012-08-07T16:35:24.017
> 
> 标签：c++, openmp

非常简单的代码，看不出为什么编译器会抛出关于我使用的错误`omp atomic capture`

// my_class.h

```
class my_class
{

my_class()
{ }

static int class_int;
static int get_next_int();

}; 
```

// my_class.cpp

```
int my_class::get_next_int()
{
   int next_int;
  #pragma omp atomic capture
  next_int = class_int++;

  return next_int;
} 
```

编译器错误：

```
my_class.cpp: In static member function 'static int 
my_class::get_next_int()':

my_class.cpp:2069: error: expected end of line before 'capture'
my_class.cpp:2070: error: invalid operator for '#pragma omp atomic' before '=' token 
```

可能与它有关`static`吗？我无法想象为什么...

如果我`pragma omp critical`改用，那么它工作正常（没有编译器错误）。

PS我有 `#include <omp.h>` 所有.h和.cpp。我`-fopenmp`像往常一样链接到

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T10:51:35.283

该`capture`子句是在 OpenMP 3.1 中引入的。您需要一个兼容的编译器：

*   从 v4.7 开始的 GCC
*   自 v10.1 以来的英特尔编译器
*   从 v12.3 开始的 Oracle Solaris Studio
*   许多[其他编译器](http://openmp.org/wp/openmp-compilers/)除了...
*   MSVC（所有版本，包括 2012），**不支持**高于 2.0 的 OpenMP 版本。

GCC 4.4.5 不支持 OpenMP 3.1。它仅支持 OpenMP 3.0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:40:15.497

如果您使用的是 Microsoft 编译器，它不支持指令的[子句。](http://msdn.microsoft.com/en-us/library/8ztckdts%28v=vs.100%29)`omp atomic`

将您的代码更改为 just`#pragma omp atomic`并且根据 ms 文档，编译器将做正确的事情。让我怀疑。:)

# ruby - 为什么我的日期字段在会话中不起作用？

> ID：11850369
> 
> 赞同：1
> 
> 时间：2012-08-07T16:35:43.720
> 
> 标签：ruby, ruby-on-rails-3.1

当我在控制器中执行此操作时：

```
def new
    @army = Army.new(strength: session[:last_army_strength], 
                     type_id: session[:last_type]),
                     date: session[:last_date])
end

def create
    @army = current_user.armies.new(params[:army])
    session[:last_army_strength] = params[:army][:strength]
    session[:last_type] = params[:army][:type_id]
    session[:last_date] = params[:army][:date]
    respond_to do |format|
      if @army.save
        format.html { redirect_to new_army_path, :notice => "New army added" }
      else
        format.html { render :new }
      end
    end
  end
end 
```

`type_id`和`strength`字段已保存，但我的字段`date`会自行重置。为什么是这样？

# c# - PS Move 示例代码，它工作了吗？

> ID：11850370
> 
> 赞同：0
> 
> 时间：2012-08-07T16:35:52.313
> 
> 标签：c#, visual-studio-2010, ps3

我正在尝试使用以下网址提供的 PS Move-me 示例代码： [http ://code.google.com/p/moveme/](http://code.google.com/p/moveme/) 我正在使用 Visual Studio Express 2010。将 C# 解决方案导入 VS（旧版本）后。我还构建并添加了请求的 OpenTK dll。尽管表明要在 x86 中构建并全部构建（从 2011 年开始在 PS 论坛上提出了建议的解决方案）。我仍然遇到示例代码运行的情况，但是代码没有接收到 Move-me 控制器的数据。使样品有点垃圾。我可以得到代码的唯一操作是连接到 PS3 上的 Move-me 服务器，使控制器隆隆作响，然后校准控制器。没有数据返回。我难住了！我想使用 PS Move-me 作为鼠标控制器进行调查，我正在做周围的指点设备，例如 PS Move Me。

非常感谢您对此的任何意见。看不出如何在这方面取得进展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T10:04:55.650

经过大量搜索和催促，发现 Visual Studio 版本和转换机制导致编译出现一些奇怪的问题。由于代码旨在构建 x86 32 位，在将项目转换为 c# 的最新 Visual Studio Express 后，在 64 位机器上选择正确的目标平台不会产生正确的影响。简而言之，我放弃了 Sony 示例代码并使用 Java 实现 (code.google.com/p/move-me-java) 在 PS3 上使用 move.me 服务器编写鼠标指针

# java - 需要主要方法协助

> ID：11850373
> 
> 赞同：0
> 
> 时间：2012-08-07T16:36:04.423
> 
> 标签：java

我已经编写了以下代码，我已经设法测试了 Get 语句，但是如何测试下面代码中的 void 语句，如您所见，我使用 flygplan2.andraHojd 更改了 int，但是如何显示结果我可以在 skrivaUTinfo 类中展示它吗）

请看下面的代码

```
//Klass
public class FlygPlan {
    int hojd;
    int flygriktning;
    int hastighet;
    String modellbeteckning;
    //Konstruktor
    public FlygPlan(int hojd, int flygriktning, int hastighet, String modellbeteckning) {
        this.hojd = hojd;
        this.flygriktning = flygriktning;
        this.hastighet = hastighet;
        this.modellbeteckning = modellbeteckning;

    }
    //Main-metoden
    public static void main(String[] args) {
        FlygPlan flygplan1 = new FlygPlan (1000, 1, 60 , "Hejsan");
        FlygPlan flygplan2 = new FlygPlan (10, 4, 70, "Sohail");
        flygplan1.skrivaUt();

        flygplan2.andraHojd(60,70);

    }

    public void andraHojd(int hojd, int nyHojd)
    {
        hojd = nyHojd;
    }
    public static int visaHojd(int hojd)
    {
        return hojd;
    }
    public void andraRiktning(int flygriktning, int nyFlygriktning)
    {
        flygriktning = nyFlygriktning;
    }
    public static int visaRiktning(int flygriktning)
    {
        return flygriktning;
    }
    public void andraHastighet(int hastighet, int nyHastighet)
    {
        hastighet = nyHastighet;
    }
    public static int visaHastighet(int hastighet)
    {
        return hastighet;
    }
    public void andraModellBeteckning(int modellbeteckning, int nyModellbeteckning)
    {
        modellbeteckning = nyModellbeteckning;
    }
    public static String visaModellBeteckning(String modellbeteckning)
    {
        return modellbeteckning;

    }

    public void skrivaUt()
    {
    System.out.println(" flygets modellbeteckning är " +modellbeteckning);
    System.out.println(" flygets flygriktning är " +flygriktning);
    System.out.println(" flygets hastighet är " +hastighet);
    System.out.println(" flyget flyger på  höjd(m) " +hojd);

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:47:06.727

`void`表示方法不返回任何内容。

一种测试方法是放置 a`System.out.println()`并检查它是否被调用。并且您可以在调用 setter 后使用 getter 打印该值。

我确实在您的代码中看到了一些问题：

A.`static`返回实例成员的getter方法；

B. getter 通常不带任何参数。我不认为你想那样做。

```
public static int visaHastighet(int hastighet)
{
    return hastighet;
} 
```

它应该是这样的：

```
public int visaHastighet()
{
    return hastighet;
} 
```

C. 您的设置器放置不正确，因为它只修改局部变量。

```
public void andraHojd(int hojd, int nyHojd)
{
    hojd = nyHojd;
} 
```

它应该是这样的：

```
public void andraHojd(int hojd)
{
    hojd = nyHojd;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:47:46.173

```
public void andraHojd(int hojd, int nyHojd)
{
    hojd = nyHojd;
} 
```

这个 setter 方法以及类似的方法可能不是您想要的。您将一个整数变量作为参数传递`(hojd)`并根据另一个方法参数设置它的值`(nyHojd)`。当方法存在时，这种状态变化将丢失。我想你想要的是：

```
public void andraHojd(int hojd)
{
    this.hojd = hojd;
} 
```

至于你的问题：

> 如何测试下面代码中的 void 语句，如您所见，我使用 flygplan2.andraHojd 更改 int，但是如何显示更改的结果，我可以在 skrivaUTinfo 类中显示它）

您可以在类上编写一个`toString()`方法来打印出它的成员字段，然后简单地在一个实例上调用它`FlygPlan`

@Override public String toString() { return "hojd = " + this.hojd" + " flygriktning = " this.flygriktning; }

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:42:30.807

我最初发现这段代码有几处有问题。

你为什么做你的吸气剂`static`？这意味着它们不与任何特定的对象实例相关联，因此实际上无法工作。

但是，您不会注意到这一点，因为您*将一个值传递给*您的“getter”，该方法*直接返回 out*。这是有意的（可能不是，因为该方法什么都不做）？Getter 通常不带参数，并返回一个实例字段，例如：

```
public int visaHojd()
{
    return hojd;
} 
```

在类似的意义上，您将两个参数传递给您的 setter，这也是不寻常的 - 特别是您的方法再次什么都不做（它设置*一个局部变量*然后退出，没有“外部可见”的更改）。`hojd`您传入的第一个参数会*隐藏*该`hojd`字段并将其隐藏，因此该字段永远不会更新。您可以将 setter 简单地编写为：

```
public void andraHojd(int nyHojd)
{
    hojd = nyHojd;
} 
```

* * *

要回答有关测试的实际问题，您需要考虑这些方法实际声明的用途。在类的上下文中，setter 的声明效果是什么？对于这个简单的类，这意味着对 getter 的下一次调用将返回该值。所以你不能孤立地测试那个方法；您需要一起调用这些方法来测试它们是否满足此要求。

可能是这样的：

```
public void testSetter() {
    int testValue = 42; // arbitrary
    FlygPlan testObj = new FlygPlan();

    // do the test
    testObj.andraHojd(testValue);
    int result = testObj.visaHojd();

    // assert correctness, i.e. that the same value was returned from the
    // getter as was passed to the setter (would usually use something like
    // JUnit here)
    assert testValue == result;
} 
```

# java - 无法在另一台 PC 上执行 JAR 文件

> ID：11850376
> 
> 赞同：1
> 
> 时间：2012-08-07T16:36:23.220
> 
> 标签：java, swing, deployment, jar

我已经使用 NetBeans 创建了一个 Swing GUI，并且能够在我的本地计算机上成功执行它。但是，每当我在另一台 PC 上执行 JAR 文件`gui_test.jar`时，都会出现如下所示的错误。

包中的类`gui_test`是：

*   gui.gui
*   StreamGobbler.java

## 错误

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at gui_test.gui.walk(gui.java:967)
at gui_test.gui.<init>(gui.java:1030)
at gui_test.gui$17.run(gui.java:1030)
at java.awt.event.InvocationEvent.dispatch (Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$000(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)

at jaya.awt.Eyentgueue.dispatchEyent(Unknown Source)
at jaya.awt.EyentDispatchIhread.punpOneEyentForFilters(Unknown Source)
at jaya.awt.EyentDispatchIhread.punpEyentsForFilter(Unknown Source)
at jaya.awt.EyentDispatchIhread.punpEyentsForHierarchy(Unknown Source)
at jaya.awt.EyentDispatchIhread.punpEyents(Unknown Source)
at jaya.awt.EyentDispatchIhread.punpEyents(Unknown Source)
at java.awt.EyentDispatchIhread.run(Unknown Source) 
```

任何解决问题的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:56:00.163

以下是可能的。

1.  您已经在新版本的 Java 中开发了它，而“其他”机器正在使用旧版本
2.  另一台机器的 JRE 问题
3.  构建问题。在 netbeans 中尝试干净 > 重建

这就是我能想到的。在其他几台具有相同 Java 版本的机器上尝试此操作，然后只有您可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:40:39.980

我对 Netbeans 不太熟悉，但我确实记得从 Netbeans 将 GUI 导入 Eclipse 时遇到问题。这可能是因为 Netbeans GUI 使用了某些库。

检查这个问题和这个答案，它可能会对你有所帮助 [https://stackoverflow.com/a/4498151/975959](https://stackoverflow.com/a/4498151/975959)

# sql - 为什么我的“left join on”会抛出“unexpected token: on”错误？

> ID：11850380
> 
> 赞同：3
> 
> 时间：2012-08-07T16:37:00.743
> 
> 标签：sql, hibernate, ejb

我有两个查询要运行：

```
2012-08-07 11:24:02,561 ERROR [org.hibernate.hql.PARSER] (http-0.0.0.0-8080-12) line 1:105: unexpected token: ON
2012-08-07 11:24:02,686 ERROR [org.jboss.aspects.tx.TxPolicy] (http-0.0.0.0-8080-12) javax.ejb.EJBTransactionRolledbackException: org.hibernate.hql.ast.QuerySyntaxException: unexpected token: ON near line 1, column 105 
[SELECT count(o) from ejb.entity.News o LEFT JOIN NewsNewsDistributionServiceLink p ON o.id = p.newsId WHERE o.statusId = ?1 AND p.newsDistServiceCode is ?2]

2012-08-07 11:26:15,605 ERROR [org.hibernate.hql.PARSER] (http-0.0.0.0-8080-12) line 1:105: unexpected token: ON
2012-08-07 11:26:15,609 ERROR [org.jboss.aspects.tx.TxPolicy] (http-0.0.0.0-8080-12) javax.ejb.EJBTransactionRolledbackException: org.hibernate.hql.ast.QuerySyntaxException: unexpected token: ON near line 1, column 105 
[SELECT count(o) from entity.News o LEFT JOIN NewsNewsDistributionServiceLink p ON o.id = p.newsId WHERE o.companyId = ?1 AND o.statusId = ?2 AND p.newsDistServiceCode is ?3] 
```

我在 SQuirreL SQL 客户端中运行了以下命令：

```
select * from news n left join news_news_distribution_service_link nl
on n.id=nl.news_id
where news_distribution_service_code is null 
```

这将返回结果，但是当我为我的 java servlet 翻译它时，它会抛出该错误。

新闻表：

```
id -PK
company_id
user_id
title
type_id
status_id
location
is_immediate
contents
created_date
last_modified_date
release_date
delete_date
corrected_news_id
can_distribute
was_distributed 
```

NewsNewsDistLink 表：

```
id -PK 
news_id - this is equal to the id in News
news_distribution_service_code 
```

代码：

```
String _query = "SELECT COUNT(o) FROM News o " + (filter.tierGroup != null ? TIER_GROUP_JOIN : "") + "WHERE ";
            WhereClauseBuilder builder = getWhereClause(filter);
            _query+= builder.where.toString();

            Query query = em.createQuery(_query);
            query.setHint("org.hibernate.cacheable", true);
            builder.bind(query); 
```

whereClauseBuilder() 基本上在“where”之后添加参数，bind() 基本上将参数与 ?# 及其值绑定。最后，p.newsDistServiceCode 大多数时候很可能为空（>95%）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:42:32.510

因为查询不是 SQL 查询，而是 HQL 查询。SQL 和 HQL 是两种不同的语言。SQL 作用于表和列，而 HQL 作用于 Hibernate 实体和关联。

请参阅[休眠文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#queryhql)。

# ios - 在 iOS 应用程序中找不到过度分配的原因（使用仪器）

> ID：11850381
> 
> 赞同：0
> 
> 时间：2012-08-07T16:37:04.010
> 
> 标签：ios, memory-management, memory-leaks, instruments

我正在使用 Instruments 来检查我的应用程序的分配。最差的类别是“Malloc 5.00 KB”，达到 20 甚至 30 MB。当我进入内部时，我看到这些分配中几乎 100% 来自 Foundation Library，称为“[NSConcreteMutableData initWithCapacity]”

我无法在我的代码中找到这些分配的来源，也无法在网络上找到有关此功能的任何详细信息...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T06:48:27.637

好的 找到了！在检查了我的大部分代码 5 次（！）而没有发现问题之后，我开始怀疑 3​​rd 方库。

问题出在 ASIHTTPRequest 库中。我使用了该库的旧（2011 年中）版本。一旦我用最新版本替换它，大部分问题都得到了解决。

现在我必须处理 SBJsonParser 和 NSDataFormatter 泄漏，我完成了 :)

谢谢

# android - Android：将相机中的图像保存在画布上

> ID：11850397
> 
> 赞同：0
> 
> 时间：2012-08-07T16:38:17.633
> 
> 标签：android, image, android-camera, android-canvas

我需要从相机中获取图像并将其保存在另一个图像中。我怎样才能做到这一点？然后我想将这个新图像保存在 SD 卡上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:50:27.597

1）这是一个如何使用android相机的教程： [tutorial](http://www.vogella.com/articles/AndroidCamera/article.html)

2) 要将相机图像覆盖在位图上，您必须： - 创建位图 - 创建具有对该位图的引用的画布 - 将图片从相机绘制到画布。（由于您在使用画布时没有制作此位图的副本，因此更改将应用​​于您创建的位图）。

3）要保存位图，可以使用我写的这个方法：

```
/**
     * <b><i>public void writeBitmapToMemory(String filename, Bitmap bitmap)</i></b>
     * <br>
     * Since: API 1
     * <br>
     * <br>
     * Write a bitmap to the phone's internal storage.
     * 
     * @param filename 
     * The name of the file you wish to write to.
     *
     *      
     */

    public void writeBitmapToMemory(String filename, Bitmap bitmap) {
        FileOutputStream fos;
        // Use the compress method on the Bitmap object to write image to the OutputStream
        try {
            fos = game.openFileOutput(filename, Context.MODE_PRIVATE);
            // Writing the bitmap to the output stream
            bitmap.compress(Bitmap.CompressFormat.PNG, 100, fos);
            fos.close();
            // this.gameEngineLog.d(classTAG, "Bitmap successfully written: " + filename);
        } 
        catch (FileNotFoundException e) {
            e.printStackTrace();
            // this.gameEngineLog.d(classTAG, "Bitmap couldn't be written: " + filename);

        } 
        catch (IOException e) {
            e.printStackTrace();
            this.gameEngineLog.d(classTAG, "Bitmap couldn't be written: " + filename);

        }

    } 
```

# ajax - WordPress WP_ajax 不工作

> ID：11850398
> 
> 赞同：1
> 
> 时间：2012-08-07T16:38:22.083
> 
> 标签：ajax, wordpress

已经看了几个小时的 WP ajax 文档，但仍然无法弄清楚。我正在开发一个插件，这是为了更新它的选项而无需刷新页面。我已经设法通过 wp-load 完成它，但知道这是不好的做法，并希望正确地做到这一点。

我将把 javascript 移动到一个单独的 .js 文件中，一旦我完成了所有工作并开始工作。

所有代码都在一个页面上。尝试通过 ajax 更新一些选项，但它不起作用。响应说它成功，但 current_form 选项没有被更新。任何帮助将不胜感激。

代码现在更新为：

```
wp_enqueue_script( 'AWNT_save_form_data', plugin_dir_url( __FILE__ ) . 'includes/save_form_data.js', array( 'jquery' ) );

wp_localize_script( 'AWNT_save_form_data', 'MyAjax', array(
    // URL to wp-admin/admin-ajax.php to process the request
    'ajaxurl'          => admin_url( 'admin-ajax.php' ),

    // generate a nonce with a unique ID "myajax-post-comment-nonce"
    // so that you can check it later when an AJAX request is sent
    'postCommentNonce' => wp_create_nonce( 'myajax-post-comment-nonce' ),
    )
);

add_action('wp_ajax_AWNT_save', 'AWNT_save_callback');

function AWNT_save_callback() {
update_option('current_form', '5');
$nonce = $_POST['postCommentNonce'];
if ( ! wp_verify_nonce( $nonce, 'myajax-post-comment-nonce' ) )
    die ( 'Busted!');
update_option('current_form', 'foo');
echo get_option('current_form');
die();
} 
```

JS 文件 (save_form_data.js)：

```
 jQuery(document).ready(function($) {
$('#save').click(function() { 
        var data = {
            action: 'AWNT_save',
            postCommentNonce : MyAjax.postCommentNonce,
            form_name : $('#form_name').val(),
customC: $('#customC').is(":checked"),
no_throttle: $('#no_throttle').is(":checked"),
form_code : $('#form_code').val()};

        jQuery.post( MyAjax.ajaxurl, data, function(response) {
            alert('Response: ' + response);
        });
    });
}); 
```

正在添加脚本，看到响应为 0 的警报，但 update_option 要么没有被调用，要么不起作用。current_form 保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:52:51.207

您应该阅读[http://www.garyc40.com/2010/03/5-tips-for-using-ajax-in-wordpress/](http://www.garyc40.com/2010/03/5-tips-for-using-ajax-in-wordpress/)

首先**分离 javascript**文件并使用**wp_enqueue_script**添加它。然后使用**wp_localize_script**将 nonce 和 ajaxurl 传递给您的 javascript 文件。

**在function.php中**

```
wp_localize_script( 'your-js-file', 'MyAjax', array(
    // URL to wp-admin/admin-ajax.php to process the request
    'ajaxurl'          => admin_url( 'admin-ajax.php' ),

    // generate a nonce with a unique ID "myajax-post-comment-nonce"
    // so that you can check it later when an AJAX request is sent
    'postCommentNonce' => wp_create_nonce( 'myajax-post-comment-nonce' ),
    )
);

// if both logged in and not logged in users can send this AJAX request,
// add both of these actions, otherwise add only the appropriate one
add_action( 'wp_ajax_AWNT_save', 'AWNT_save_callback' );
add_action('wp_ajax_nopriv_AWNT_save', 'AWNT_save_callback' );

function AWNT_save_callback() {

//CHeck  nonce FIRST HERE

$nonce = $_POST['postCommentNonce'];

// check to see if the submitted nonce matches with the
// generated nonce we created earlier
if ( ! wp_verify_nonce( $nonce, 'myajax-post-comment-nonce' ) )
    die ( 'Busted!')

update_option('current_form', 'foo');
echo get_option('current_form');

die();
} 
```

在您的 javascript 文件中

```
 jQuery(document).ready(function($) {
$('#save').click(function() { 
        var data = {
            action: 'AWNT_save',
            postCommentNonce : MyAjax.postCommentNonce,
            form_name : $('#form_name').val(),
customC: $('#customC').is(":checked"),
no_throttle: $('#no_throttle').is(":checked"),
form_code : $('#form_code').val()};

        jQuery.post( MyAjax.ajaxurl, data, function(response) {
            alert('Response: ' + response);
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-07T23:11:05.830

我做了一个快速测试（粗略的测试），这是我的工作代码。

```
wp_enqueue_script( 'AWNT_save_form_data', get_stylesheet_directory_uri() . '/inc/save_form_data.js', array( 'jquery' ) );
wp_localize_script( 'AWNT_save_form_data', 'MyAjax', array(
    // URL to wp-admin/admin-ajax.php to process the request
    'ajaxurl'          => admin_url( 'admin-ajax.php' ),
    // generate a nonce with a unique ID "myajax-post-comment-nonce"
    // so that you can check it later when an AJAX request is sent
    'postCommentNonce' => wp_create_nonce( 'myajax-post-comment-nonce' ),
    )
);
add_action('wp_ajax_AWNT_save', 'AWNT_save_callback');
function AWNT_save_callback() {
    update_option('current_form', '5');
    $nonce = $_POST['postCommentNonce'];
    if ( ! wp_verify_nonce( $nonce, 'myajax-post-comment-nonce' ) )
        die ( 'Busted!');
    update_option('current_form', 'foo');
    echo get_option('current_form');
    die();
}
add_action( 'admin_menu', 'register_menu_pages', $priority = 10, $accepted_args = 1 );
function register_menu_pages() {
    add_menu_page('AWNT', 'awnt custom', 'manage_options', 'awntCustom', 'awnt_menu', 'dashicons-admin-site', 6 );
}
function awnt_menu () {
    ?>
    <form method="post">
        <input type="text" id="form_name" name="form_name">
        <input type="text" id="form_code" name="form_code">
        <input type="checkbox" id="customC" name="customC">
        <input type="checkbox" id="no_throttle" name="no_throttle">
        <input type="submit" name="save" value="Save" id="save">
    </form>
    <?php
} 
```

Javascript代码是：

```
jQuery(document).ready(function($) {
    $('#save').on('click', function(e) {
        e.preventDefault(); 
        var data = {
            action: 'AWNT_save',
            postCommentNonce : MyAjax.postCommentNonce,
            form_name : $('#form_name').val(),
            customC: $('#customC').is(":checked"),
            no_throttle: $('#no_throttle').is(":checked"),
            form_code : $('#form_code').val()
        };
        jQuery.post( MyAjax.ajaxurl, data, function(response) {
            alert('Response: ' + response);
        });
    });
}); 
```

我认为这同样适用于您，除非您有任何其他 javascript 冲突。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-12-03T11:37:37.740

这应该是

```
add_action( 'wp_ajax_AWNT_save_callback', 'AWNT_save_callback' );
add_action('wp_ajax_nopriv_AWNT_save_callback', 'AWNT_save_callback' ); 
```

我的意思是钩子的名字是错误的。

# c# - 单个 TextBlock 中的替代文本

> ID：11850403
> 
> 赞同：2
> 
> 时间：2012-08-07T16:38:35.483
> 
> 标签：c#, wpf, xaml

我需要根据两个模型属性替换单个显示的文本约 4 秒。具体来说，我的模型是价格、出价和要价属性。我有以下文本块绑定到价格。

```
<ControlTemplate x:Key="QuotePrice" >
    <TextBlock Style="{StaticResource PriceCellStyle}" Text="{Binding Price}">
</ControlTemplate> 
```

如果模型的 Ask 属性发生变化，我想在同一个 texblock 中显示 Price 和 Ask 之间切换。

我认为可行的选项是创建两个文本块，一个绑定到价格，一个绑定到询问，也许使用故事板，交替两个 texblocks 的可见性。但是，如果可能的话，我想避免使用两个文本块。关于如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:41:40.200

> 但是，如果可能的话，我想避免使用两个文本块。关于如何做到这一点的任何建议？

使用两个 TextBlock 实例将是最简单的，也可能是最优雅的解决方案。

但是，如果您希望坚持使用单个 TextBlock，则可以在运行时更新绑定。或者，您也可以绑定到一个新属性（即：）`PriceOrAsk`，并根据需要在 DataContext 中更改它的值。

# sage - 使用 Sage 计算大量字段中的最大阶数

> ID：11850418
> 
> 赞同：1
> 
> 时间：2012-08-07T16:39:28.803
> 
> 标签：sage

我正在 SAGE 中编写一个程序，除其他外，它必须计算“大”数字字段的最大阶数。我正在处理的数字字段不仅具有相当大的度数（到目前为止我必须处理的数字字段约为 40），而且判别式也非常大。
不幸的是，这使得无法使用 SAGE 用于计算最大订单的标准内置函数 - 该命令`K.maximal_order()`太费时了。让我具体说明以下代码中使用的符号：
Qa12 指定一个带有整数环的数字字段（即最大顺序）`OO`。需要计算的是`OOK`的扩展`K`的最大阶数`Qa12`。现在，在 MAGMA 中，这可以使用以下代码完成：

```
subOrderK:=ext<OO | y^2-kappa12>;
subOrderK:=AbsoluteOrder(subOrderK);
D:=Discriminant(subOrderK);
for p in PrimeDivisors(D) do
    subOrderK:=pMaximalOrder(subOrderK,p);
end for;
OOK:=subOrderK; 
```

这在相当短的时间内运行，即通常不到一分钟。我没有找到直接翻译它的方法，因为 SAGE 中的前两行代码似乎没有类似的东西。很可能是我遗漏了一些东西，所以如果你认为你确实知道翻译前两行的方法，那么请告诉我。如果计算字段的扩展名，则代码应如下所示：

```
K.<c> = Qa12.extension(y^2-kappa12)
K.<alpha> = K.absolute_field()
subOrderK = K.order(alpha)
D = subOrderK.discriminant()
for p in factor(D):
    subOrderK = K.maximal_order(p[0])
OOK = subOrderK 
```

现在，这段代码有两个问题，第一个是所述数字字段的判别式很大，分解它是不可能的。换句话说，我还没有测试过for循环。你有什么方法可以避免处理这些巨大的判别器吗？for 循环是我不安全的第二个地方：因为（再次 - 据我所知）没有直接模拟`pMaximalOrder(subOrderK,p)`上面的 MAGMA 命令，我希望 SAGE 会“记住”之前的`subOrderK`值for 循环，因此重新创建了 MAGMA 命令的效果。真的是这样吗？如果注意，您是否找到避免此问题的方法？

注意：
几天前我在 ask.sagemath 上发布了基本相同的问题，但到目前为止无济于事。

# python - 自定义 Python 列表排序

> ID：11850425
> 
> 赞同：111
> 
> 时间：2012-08-07T16:39:42.767
> 
> 标签：python, list, sorting

我正在重构我的一些旧代码并遇到了这个问题：

```
alist.sort(cmp_items)

def cmp_items(a, b):
    if a.foo > b.foo:
        return 1
    elif a.foo == b.foo:
        return 0
    else:
        return -1 
```

该代码有效（我在大约 3 年前编写了它！）但是我在 Python 文档的任何地方都找不到这个东西，每个人都用它`sorted()`来实现自定义排序。有人可以解释为什么这有效吗？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-08-07T16:49:06.373

作为旁注，这是实现相同排序的更好选择：

```
alist.sort(key=lambda x: x.foo) 
```

或者：

```
import operator
alist.sort(key=operator.attrgetter('foo')) 
```

查看[排序](http://wiki.python.org/moin/HowTo/Sorting/)方法，它非常有用。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-08-07T16:44:47.610

它记录[在这里](http://docs.python.org/library/stdtypes.html#mutable-sequence-types)。

> sort() 方法采用可选参数来控制比较。
> 
> cmp 指定两个参数（列表项）的自定义比较函数，该函数应返回负数、零或正数，具体取决于第一个参数被认为小于、等于还是大于第二个参数： cmp=lambda x,y : cmp(x.lower(), y.lower())。默认值为无。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-03-18T03:26:22.477

就像这个例子一样。你想对这个列表进行排序。

```
[('c', 2), ('b', 2), ('a', 3)] 
```

输出：

```
[('a', 3), ('b', 2), ('c', 2)] 
```

您应该按第二项对元组进行排序，然后是第一项：

```
def letter_cmp(a, b):
    if a[1] > b[1]:
        return -1
    elif a[1] == b[1]:
        if a[0] > b[0]:
            return 1
        else:
            return -1
    else:
        return 1 
```

然后将其转换为关键函数：

```
from functools import cmp_to_key
letter_cmp_key = cmp_to_key(letter_cmp)) 
```

现在您可以使用自定义排序顺序：

```
[('c', 2), ('b', 2), ('a', 3)].sort(key=letter_cmp_key) 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2018-08-06T12:41:35.323

这在 Python 3 中不起作用。

您可以使用 functools cmp_to_key 让旧式比较函数工作。

```
from functools import cmp_to_key

def cmp_items(a, b):
    if a.foo > b.foo:
        return 1
    elif a.foo == b.foo:
        return 0
    else:
        return -1

cmp_items_py3 = cmp_to_key(cmp_items)

alist.sort(cmp_items_py3) 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2020-10-13T05:49:23.803

我知道很多人已经发布了一些很好的答案。但是，我想建议一种无需导入任何库的好方法。

```
l = [(2, 3), (3, 4), (2, 4)]
l.sort(key = lambda x: (-x[0], -x[1]) )
print(l)
l.sort(key = lambda x: (x[0], -x[1]) )
print(l) 
```

输出将是

```
[(3, 4), (2, 4), (2, 3)]
[(2, 4), (2, 3), (3, 4)] 
```

输出将根据我们以元组格式提供的参数的顺序进行排序

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-08-01T15:52:23.607

更好的是：

```
student_tuples = [
    ('john', 'A', 15),
    ('jane', 'B', 12),
    ('dave', 'B', 10),
]

sorted(student_tuples, key=lambda student: student[2])   # sort by age
[('dave', 'B', 10), ('jane', 'B', 12), ('john', 'A', 15)] 
```

取自：[https ://docs.python.org/3/howto/sorting.html](https://docs.python.org/3/howto/sorting.html)

# java - MongoDB - Java - 结合逻辑 OR 和逻辑 AND 的最简单方法是什么？

> ID：11850427
> 
> 赞同：0
> 
> 时间：2012-08-07T16:39:45.510
> 
> 标签：java, mongodb

我有以下查询作为示例：年份 = 2012 OR 年份 = 2011 AND name = John OR name = Mike AND County = USA OR country = Canada

使用 JAVA 驱动程序构建它的最佳方法是什么？使用 DBObject 有点棘手，因为它实际上是一个 Map，所以键必须是不同的。我也找不到 QueryBuilder 的一个像样的例子（即一个使用循环的例子）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:19:47.460

使用`$in`运算符而不是`$or`为此。我不熟悉 Java 驱动程序，但您的查询对象应该如下所示：

```
{
    year: { $in: [2012, 2011] },
    name: { $in: ['John', 'Mike'] },
    country: { $in: ['USA', 'Canada'] }
} 
```

# jquery - 附加过滤选项数组以选择：NOT_FOUND_ERR: DOM Exception 8

> ID：11850429
> 
> 赞同：1
> 
> 时间：2012-08-07T16:39:52.383
> 
> 标签：jquery, filter, append, options

为简洁起见，以下代码是我正在使用的代码的略微截断版本：希望它足以说明问题。如果有帮助，我可以设置一个 jsfiddle 吗？

无论如何：我正在创建一个 jquery 对象数组，然后过滤掉其值在一个已选择值数组中的任何值，然后尝试将结果附加到我的选择框。

我认为问题在于我从 filter() 操作中得到了什么。它显示为一个对象数组，但每个对象都以“e.fn.e.init[1]”开头。当我尝试将该对象数组附加到选择框时，我得到**NOT_FOUND_ERR: DOM Exception 8**

```
var selected_roles = [2,4],
all_roles = [];

// these lines generated from PHP
all_roles.push( $('<option value="3">Doctor</option>') );
all_roles.push( $('<option value="4">Dentist</option>') );
all_roles.push( $('<option value="2">Biscuit Designer</option>') );
all_roles.push( $('<option value="7">International Playboy</option>') );

function getAvailableRoleOptions(){
    var out = all_roles;
    return out.filter( function(element) {
        return $.inArray( parseInt( $(element).attr('value') ), selected_roles ) === -1;
    });
}

$options = getAvailableRoleOptions();

$('#job_select').empty().append( $options ); 
```

什么是过滤功能返回给我？我是否需要在某处使用 get() ，如果需要，在哪里？我什至可以做我想做的事吗？我对这一切都错了吗？:)

谢谢 ：）

# c# - Windows XP 中的重叠控件

> ID：11850431
> 
> 赞同：2
> 
> 时间：2012-08-07T16:40:13.720
> 
> 标签：c#, .net, vb.net

我在 Windows 7 的 VS 2010 中开发了一个 Windows 桌面应用程序；当我在 Windows XP 中安装该应用程序时，一些文本框和标签相互重叠。

简而言之，在将基于 Windows 7 构建的应用程序安装到 Windows XP 之后，视觉设计过程失败了，我的控件现在重叠了。

我可以寻找什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:03:40.673

听起来像是两个操作系统中的 DPI 设置不匹配。根据记忆，Windows 7 的默认设置高于 Windows XP。

如何检查，更改两个版本中的值：

[Windows 7 - DPI 显示大小设置 - 更改](http://www.sevenforums.com/tutorials/443-dpi-display-size-settings-change.html)

[增大或减小屏幕上对象和文本的大小](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/display_use_large_or_small_fonts.mspx?mfr=true)

如果您希望同时满足这两种默认设置，则需要设计您的应用程序以应对差异。查看 Control.Anchor 和 Control.Dock 属性以获取有关如何确保适当控制大小的详细信息：

[Control.Anchor 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.anchor.aspx)

[Control.Dock 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.dock.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:02:53.183

你有 Win7 和 WinXP 以不同的 DPI 运行吗？XP 默认为 96 dpi，而我相信 Win7 默认为 120。这可能会导致您所描述的视觉差异。

您可以在 Win7 中的控制面板\外观和个性化\显示中查看设置。“小”是 96 dpi，“中”是 120。

# eclipse - 新的 TML 文件不会在 Eclipse 中自动编译？

> ID：11850435
> 
> 赞同：0
> 
> 时间：2012-08-07T16:40:28.473
> 
> 标签：eclipse, tapestry

我正在学习 Tapestry 5 教程，我注意到对 TML 文件（或新的 TML 文件）的更改不会从 Eclipse 内部自动编译。我只能通过进入命令行和“mvn package”来获得新的 TML 文件或对任何 TML 文件的更改。这不可能。

在 Eclipse 中，这是一个 Maven 项目，我执行了整个“mvn eclipse:eclipse -DdownloadSources=true”，所以很难相信 eclipse 项目没有正确配置。

就好像 *tml 文件不符合自动复制到目标目录的条件，就像编译的 *java 文件或 *properties 文件一样。

我必须做些什么才能配置此项目以进行更多交互式调试？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T12:27:09.823

就个人而言，我总是向 Jetty 添加一个测试依赖项并使用以下类启动它。因为代码是从 eclipse 的类路径运行的，所以无论 eclipse 看到什么，jetty web 应用程序也会看到。因此，资源目录永远不会有任何问题。

```
<dependency>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>jetty</artifactId>
    <version>6.1.26</version>
</dependency> 
```

```
package jetty;
import org.apache.tapestry5.SymbolConstants;
import org.mortbay.jetty.Connector;
import org.mortbay.jetty.Server;
import org.mortbay.jetty.handler.ContextHandlerCollection;
import org.mortbay.jetty.nio.SelectChannelConnector;
import org.mortbay.jetty.webapp.WebAppContext;

/**
 * For jetty 6
 * @see http://docs.codehaus.org/display/JETTY/Embedding+Jetty#comment-4391085
 */
public class JettyWebServer {
    public static String     context = "/";
    public static int         port     = 8069;

    private Server jettyServer;

    public void start() throws Exception {
        System.setProperty(SymbolConstants.PRODUCTION_MODE, "false");

        jettyServer = new Server();
        Connector connector = new SelectChannelConnector();
        connector.setPort(port);
        connector.setHost("127.0.0.1");
        jettyServer.addConnector(connector);

        WebAppContext context = new WebAppContext("src/web/", JettyWebServer.context);
        context.setLogUrlOnStart(true);
        context.setParentLoaderPriority(true);
        jettyServer.setStopAtShutdown(true);

        ContextHandlerCollection contexts = new ContextHandlerCollection();
        contexts.addHandler(context);
        jettyServer.setHandler(contexts);

        jettyServer.start();
    }

    public void join() throws Exception {
        jettyServer.join();
    }

    public void stop() throws Exception {
        if (jettyServer != null)
            jettyServer.stop();
    }

    public static void main(String[] args) throws Exception {
        JettyWebServer server = new JettyWebServer();
        try {
            server.start();
            server.join();
        } finally {
            server.stop();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T19:41:37.113

我假设您的模板文件位于类文件旁边`src/main/java`？您需要确保 Maven 将来自该位置的文件视为除了通常`/resources`位置之外的资源。此配置应该有效：

```
<resources>
    <resource>
        <directory>src/main/resources</directory>
    </resource>
    <resource>
        <directory>src/main/java</directory>
        <includes>
            <include>**/*</include>
        </includes>
        <excludes>
            <exclude>**/*.java</exclude>
        </excludes>
    </resource>
</resources> 
```

这也使 Maven Eclipse 插件（和 M2 集成）按预期运行。

# javascript - 面向对象的 JavaScript 共享方法变量

> ID：11850436
> 
> 赞同：0
> 
> 时间：2012-08-07T16:40:29.080
> 
> 标签：javascript

为什么这不起作用？

```
function thing() {

    var bigvar;

    function method1() {
        bigvar = 1;
    }

    function method2() {
        alert(bigvar);
    }

    this.method1 = method1;
}

var a = new thing();
a.method1();
a.method2();
​ 
```

我想让method2工作，但它没有..有没有办法让这个工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:41:39.687

你没有`method2`像`method1`现在这样公开。

```
this.method1 = method1;
this.method2 = method2;  //<-- missing this 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:43:00.437

为什么你有`this.method1 = method1`但没有`this.method2 = method2`？试试看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:51:05.100

为什么不这样做？

```
function thing() {

    var bigvar;

    this.method1 = function () {
        bigvar = 1;
    }

    this.method2 = function () {
        alert(bigvar);
    }

}

var a = new thing();
a.method1();
a.method2();​ 
```

# jquery - 在设定的持续时间后显示隐藏元素

> ID：11850439
> 
> 赞同：0
> 
> 时间：2012-08-07T16:40:47.517
> 
> 标签：jquery

我打算让下图中的图像`div`最初被隐藏，但在页面加载后大约 1200 毫秒显示。

但是，它不起作用。我的 jQuery 在某处应该是错误的..

HTML：

```
<div id="zz">
    <img src='images/number2.png' />
</div> 
```

查询：

```
<script type="text/javascript">

    $('#zz').hide().delay(1200).fadeIn('normal');

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:46:15.883

您的代码是正确的（假设您使用的是 jQuery 1.4 或更高版本 - delay() 是在 1.4 中添加的）。可能发生的情况是您在 DOM 完成加载之前调用脚本？

尝试像这样包装你的电话：

```
$(function(){
  $('#zz').hide().delay(1200).fadeIn('normal');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:43:06.407

通过 CSS 隐藏 div，而不是 jquery。然后使用不带 hide 命令的 jquery 语句的其余部分。

[在这里演示](http://jsfiddle.net/NotInUse/uxT9Y/)

# c# - 使用 SqlMethods.Like 匹配整个单词

> ID：11850440
> 
> 赞同：-2
> 
> 时间：2012-08-07T16:40:48.600
> 
> 标签：c#, asp.net, linq

我的代码如下，在 like 子句中带有正则表达式：

```
string f = "example";

var likestr = string.Format("%[^a-zA-Z]{0}[^a-zA-Z]%", f);

var q = SearchColumn.Where(x => SqlMethods.Like(x.Search_Col, likestr)); 
```

尽管它返回值，但它错过了有效的结果。

例如，当搜索“example”时，它会找到“An Example Bank”，但找不到“Example Personal Finance (EPF)”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:42:18.690

我猜问题是您的喜欢在搜索条件之前和之后都**需要**一个字母以外的字符，并且如果条件位于数据库字段的开头或结尾，则该字符将不起作用。

因此，如果您搜索 Example，您会找到“An Example Bank”，而不是“Example Bank”。

我不确定是否有更快的方法使用 Sql，但这应该可以。

```
var f = "example"'

var likestr1 = string.Format("%[^a-zA-Z]{0}[^a-zA-Z]%", f);
var likestr2 = string.Format("%[^a-zA-Z]{0}", f);
var likestr3 = string.Format("{0}[^a-zA-Z]%", f);

var q = SearchColumn.Where(x => 
           SqlMethods.Like(x.Search_Col, likestr1) || 
           SqlMethods.Like(x.Search_Col, likestr2) || 
           SqlMethods.Like(x.Search_Col, likestr3) ||
                          (x.Search_Col == f)
         ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-12T08:39:12.100

为什么不使用 Contains() 方法？

```
var f = "example"
var q = from x in MyTable where x.Search_Col.Contains(f) select x; 
```

# excel - 计算excel值查找

> ID：11850442
> 
> 赞同：-1
> 
> 时间：2012-08-07T16:40:58.793
> 
> 标签：excel

假设我们有单元格值：

```
A+B
A+C
A+E+F
A
B+F 
```

现在，我们使用 countif 对 A,B,C 进行计数，而 E,F 被归类为其他类别，那么我们如何计算其他人 (E,F)

条件：

1.  其他人将有一个“+”号
2.  其他将不包括 A、B、C。

对于上面的例子：

计数 A:4、B:2、C:1（使用 countif）、其他（E、F）：总数为 3，唯一为 2（如何？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:28:25.563

假设数据在 A 列中，以下是您的示例的一些公式：

```
A      =COUNTIF(A:A,"*A*")
Others =SUM(COUNTIF(A:A,{"*+E*","*+F*"}))
Unique =SUM(N(COUNTIF(A:A,"*"&{"A","B","C","D","E","F"}&"*")=1)) 
```

您可以列出您的字母（A、B、C、D、E、F）`C1:C6`并填写`D1:D6`频率的 COUNTIF 公式。

*跟进*

`A1:A5`如果您想在不参考值 E、F的情况下查找范围内除 A、B、C 以外的计数，您可以尝试输入：

```
=SUMPRODUCT(LEN(SUBSTITUTE(A1:A5&"+",{"","+","A","B","C"},""))*{-2,-1,1,1,1}) 
```

该公式将字符串中各种值的替换长度与字符串长度进行比较（不进行任何替换）。如果将更多字母添加到列表中，`-2`则应调整 的第一个值，使数组的总和为零。对于搜索超过一个字符长度的字符串，除以字符串的长度，例如用于`ABC`数组`1/3`的相应元素并调整第一个值，使数组总和为零。

# powershell - 如何格式化 Powershell Get-Culture cmdlet 输出？

> ID：11850446
> 
> 赞同：0
> 
> 时间：2012-08-07T16:41:15.870
> 
> 标签：powershell

我有一个大写的大写文本和重复文本文件。我使用 PowerShell 删除重复项并使所有内容都小写。现在，我想将每个单词的第一个字母大写。为此，我使用了以下内容；

```
$var = (Get-Content "C:\FilePath")
(Get-Culture).TextInfo.ToTitleCase($Var) 
```

这就像一个魅力，但输出从每行的一个字符串变成了一个巨大的文本块。我无法格式化这个，Select-Object，Sort，Export-Csv 都没有帮助我。有什么办法可以防止琴弦粘在一起吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:03:38.347

`$var`是一个数组，所以你可以把它当作一个数组来处理：

```
$var = (Get-Content "C:\FilePath")
foreach ($line in $var) {
    (Get-Culture).TextInfo.ToTitleCase($line)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T08:20:44.040

出于性能原因，我将保存一次对文本信息的引用（代替为每一行调用 Get-Culture）并在 foreach 循环中使用它：

```
$textInfo = (Get-Culture).TextInfo
Get-Content C:\FilePath | Foreach-Object {  $textInfo.ToTitleCase($_) } 
```

# mysql - 这个 mysql 查询（与联合）可以优化吗？

> ID：11850448
> 
> 赞同：0
> 
> 时间：2012-08-07T16:41:21.217
> 
> 标签：mysql

我有其他人配置的这个查询需要很长时间才能执行，我想知道是否有任何方法可以优化它。

```
SELECT COUNT( t2.ticker ) /  '99' AS PctNewHigh_Yearlyarray 
FROM (
    SELECT t1.ticker, ROUND( SUM( t1.close ) , 2 ) as DailyChange
    FROM (
        SELECT b.ticker, b.close
        FROM broad b
        WHERE b.Date1 =  '2012-07-30 00:00:00'

        UNION

        SELECT b.ticker, MAX( b.close ) * -1 
        FROM broad b
        WHERE b.Date1 >  '2011-07-31 00:00:00'
        GROUP BY b.Ticker
        ORDER BY ticker
    ) t1 
    GROUP BY t1.ticker
) t2
WHERE DailyChange = 0 
```

数据库结构为：

```
CREATE TABLE `broad` (
  `idbroad` int(11) NOT NULL AUTO_INCREMENT,
  `Date1` datetime DEFAULT NULL,
  `Date2` varchar(10) DEFAULT NULL,
  `Ticker` varchar(45) DEFAULT NULL,
  `Open` double DEFAULT NULL,
  `High` double DEFAULT NULL,
  `Low` double DEFAULT NULL,
  `Close` double DEFAULT NULL,
  `Vol` double DEFAULT NULL,
  `TC2k_IG` varchar(100) DEFAULT NULL,
  `MS2` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`idbroad`),
  KEY `indx_Date1` (`Date1`),
  KEY `indx_Ticker` (`Ticker`),
  KEY `indx_High` (`High`),
  KEY `indx_Close` (`Close`),
  KEY `indx_TC2k_IG` (`TC2k_IG`),
  KEY `indx_Vol` (`Vol`),
  KEY `indx_Open` (`Open`),
  KEY `indx_Low` (`Low`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8; 
```

希望您能提供帮助，如果需要更多数据，请告诉我。
所有数据都是股市数据，例如

```
INSERT INTO `broad` (`idbroad`, `Date1`, `Date2`, `Ticker`, `Open`, `High`, `Low`, `Close`, `Vol`, `TC2k_IG`, `MS2`) VALUES
(726, '2002-10-10 00:00:00', '20021010', 'A', 10.95, 11.13, 10.8, 10.85, 48534, 'EXAMPLE NAME', ''); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T11:57:37.780

这应该产生相同的结果，但速度更快。

```
SELECT COUNT( t2.ticker ) /  '99' AS PctNewHigh_Yearlyarray 
FROM (
    SELECT t1.ticker, ROUND( SUM( t1.close ) , 2 ) as DailyChange
    FROM (
        SELECT b.ticker,
        MIN(CASE WHEN b.Date1 > '2011-07-31 00:00:00' THEN b.close * -1 ELSE b.close END) AS close
        FROM broad b
        WHERE b.Date1 >= '2011-07-31 00:00:00'
        GROUP BY b.Ticker
        ORDER BY NULL
    ) t1 
    GROUP BY t1.ticker
) t2
WHERE DailyChange = 0 
```

您应该发布一个`EXPLAIN SELECT ...`来自（可能是您的和我的）查询，以确定是否使用了以及使用了哪个索引。如果您合并一些索引而不是拥有这么多索引可能会更好。

# vb.net - 如何在目标函数中使用枚举类型的参数实现反射

> ID：11850454
> 
> 赞同：-2
> 
> 时间：2012-08-07T16:41:40.520
> 
> 标签：vb.net

这是一个测试代码：

```
Public Class Class2
   Public GoodName as String
   Public Function someFunction ()
   End Function
End Class

Public Class Class1
    Public Enum ENUM_VAL1_
       abc = 1
       def = 2
    End Enum

    Public Enum ERROR_VAL1_
       yhn = 1
       ujm = 2
    End Enum

    Public Function fun1(byval _enumArg1 as ENUM_VAL1_,
                         byval _stringArg as String,
                         byref _classArg Class2) as ERROR_VAL1_
       ... SOMETHING HERE
       return something
    End Function
End Class 
```

和测试

```
 Dim asm As Assembly = Assembly.LoadFrom(<the source>)
    If asm Is Nothing Then Return Nothing

    Dim typ As Type = asm.GetType(<namespace>.<class1>)
    If typ Is Nothing Then Return Nothing

    Dim obj As Object = Activator.CreateInstance(typ)
    If obj Is Nothing Then Return Nothing

    Dim arg As Object() = New Object() {ENUM_VAL1_.abc, "qazxsw", New Class2}

    Dim res As Object = typ.InvokeMember( _
        "fun1", _
        BindingFlags.[Default] Or BindingFlags.InvokeMethod, _
        Nothing, _
        obj, _
        arg) 
```

[ `Dim res As Object = typ.InvokeMember( _ "fun1", _ BindingFlags.[Default] Or BindingFlags.InvokeMethod, _ Nothing, _ obj, _ arg)`] 返回错误：`function '[fullname]' not found.`

然后我意识到 fun1 签名与我的调用不同（即使枚举值是整数）。我做了一些研究，发现当目标程序集上的属性或函数具有与标准类型不同的参数时如何实现反射的“一些”示例。但我成功地将这些样本“概念”转化为我的需要。

所以，在这里我放了一些带有虚拟枚举类型的虚拟类，只是为了指出问题的根源。

原始代码是关于 windows 防火墙/端口 (win7/xp/vista) 的，其中有许多枚举值，包括来自 firewallApi.dll 和 Hnetcfg.dll 的类型。

我遇到的问题是我不能“InvokeMember”（也是“SetProperties”和“SetProperties”）使用说：

```
Dim args As Object() = New Object() {"SQL", 6, "1433", 1} 
```

我的程序集函数具有这些参数类型。

```
Public Function PortExists( _
    ByVal _ruleName As String, _
    ByVal _protocol As NET_FW_IP_PROTOCOL_, _
    ByVal _remotePorts As String, _
    ByVal _direction As NET_FW_RULE_DIRECTION_ _
) As FW_ERROR_CODE 
```

好的，为简化起见，我制作了自己的枚举类型（无需安装额外的库）

```
Public Function PortExists( _
    ByVal _ruleName As String, _
    ByVal _protocol As FW_IP_PROTOCOL, _
    ByVal _remotePorts As String, _
    ByVal _direction As FW_RULE_DIRECTION _
) As FW_ERROR_CODE 
```

不知何故，参数“6”和“1”应该分别转换为`FW_IP_PROTOCOL`和`FW_RULE_DIRECTION`类型......

我不知道怎么办！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:55:46.250

好的，这是解决方案。

当我们从反射中使用 Invoke 方法时，我们必须将参数作为对象（object ()）传递，并且类型完全匹配。即使枚举类型的值是一个整数（这是我最初遇到问题的地方），我必须将此值转换为引用程序集类型的确切枚举类型。所以下面的函数 <_FEnumToObject> 将完成这项工作。我添加了 _F 以将我所有的私有函数推到列表底部并将它们分组（IDE 属性列表）；_S 将代表 subs 和 _P 代表属性...

```
Private Function _FEnumToObject( _
    ByVal _typeName As String, _
    ByVal _typeValue As String _
) As Object
    Dim enumType As Type = m_Assembly.[GetType](_typeName)
    Dim enumInfo As FieldInfo = enumType.GetField(_typeValue)
    Dim valueINT As Integer = CInt(enumInfo.GetValue(enumType))
    Dim valueOBJ As Object = [Enum].ToObject(enumType, valueINT)
    Return valueOBJ
End Function 
```

下一个函数 <_FProtocolToObject> 用于将协议值（枚举）转换为对象。

```
Public Function _FProtocolToObject(ByVal _protocol As FW_IP_PROTOCOL) As Object
    'where <m_AssemblyRef> is like "wf7."
    Return _FEnumToObject(m_AssemblyRef + "FW_IP_PROTOCOL", _protocol.ToString)
End Function 
```

这是最后的电话：

```
Public Function PortExists( _
    ByVal _ruleName As String, _
    ByVal _protocol As FW_IP_PROTOCOL, _
    ByVal _portNumber As Integer _
) As Boolean
    If m_AssemblyNotFound Then Return False
    Static mi As MethodInfo = m_RemoteType.GetMethod("PortExists")
    Dim m As FW_ERROR_CODE = FW_ERROR_CODE.UNKNOWN
    Try
        Dim a As Object = New Object() _
            { _
                _ruleName, _
                _FProtocolToObject(_protocol), _
                _portNumber _
            }
        m = mi.Invoke(m_RemoteObject, a)

    Catch ex As Exception
        'some error handler here...

    End Try
    Return (m = FW_ERROR_CODE.SUCCESS)
End Function 
```

我还发布了一些额外的代码，以在我的示例代码中呈现一些无法解释/未设置的变量分配。

```
Private ReadOnly Property _PAssemblyPath() As String
    Get
        Dim ad As String = IO.Path.Combine(My.Application.Info.DirectoryPath, "bin")
        Dim af As String = IO.Path.Combine(ad, _PAssemblyName + ".dll")
        Return af
    End Get
End Property 
```

公共子新（）

```
 m_AssemblyPath = _PAssemblyPath
    m_AssemblyRef = _PAssemblyName + "."
    m_ClassPath = m_AssemblyRef + _PClassName

    If IO.File.Exists(m_AssemblyPath) Then

        Dim name As New AssemblyName()
        name.CodeBase = m_AssemblyPath
        m_Assembly = AppDomain.CurrentDomain.Load(name)
        m_RemoteObject = m_Assembly.CreateInstance(m_ClassPath)
        m_RemoteType = m_Assembly.[GetType](m_ClassPath)
        m_AssemblyNotFound = False

    Else
        'some error handler here

    End If

End Sub 
```

假设“SCSysInfo”是一个用于检查操作系统系统等的实用程序类......

```
Private ReadOnly Property _PClassName() As String
    Get
        Dim s As String = "CFwRule"
        If SCSysInfo.IsWin7 Then
            s += "7"
        ElseIf SCSysInfo.IsWinVista Then
            s += "Vista"
        ElseIf SCSysInfo.IsWinXP Then
            s += "XP"
        End If
        Return s
    End Get
End Property
Private ReadOnly Property _PAssemblyName() As String
    Get
        Dim s As String = String.Empty
        If SCSysInfo.IsWin7 Then
            s = "fw7"
        ElseIf SCSysInfo.IsWinVista Then
            s = "fwv"
        ElseIf SCSysInfo.IsWinXP Then
            s = "fwxp"
        End If
        Return s
    End Get
End Property 
```

我的班级中的“PortExists”函数（上面部分列出）还有两个用于 vista 和 win7 的签名。我必须提到的一件事是反射不能识别方法/属性的多重签名。使用反射时，方法或属性必须只有一个签名。谈谈我的情况：win7、vista 和 xp 为要编程的端口公开了完全不同的属性。在每个程序集中（我在各自的环境中编译），都有“相同”的方法和属性具有不同数量的参数。从我的“适配器”类（上面发布了其中的一部分）中，我从具有 3 个不同签名的所有 3 个程序集中调用“相同”方法（基于操作系统，我选择适当的签名）。所以，我对“PortExists”方法的所有 3 个签名都在我的“适配器”类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:40:50.620

通常，一个好的设计会使反射变得多余。我的建议是让不同的对象实现一些定义要调用的函数的通用接口。

常见定义：

```
Public Enum MyValueEnum
    value1 = 1
    value2 = 2
End Enum

Public Enum MyErrorEnum
    error1 = 1
    error2 = 2
End Enum

Public Class SomeClass
    Public GoodName As String

    Public Function SomeFunction() As Object
        Return Nothing
    End Function
End Class 
```

界面

```
Public Interface IMyInterface
    Function TheFunction(ByVal val As MyValueEnum, ByVal name As String, _
                         ByRef someObject As SomeClass) As MyErrorEnum
End Interface 
```

实现接口的两个不同的类

```
Public Class SomeImplementation
  Implements IMyInterface

  Public Function TheFunction(ByVal val As MyValueEnum, ByVal name As String, _
                              ByRef someObject As SomeClass) As MyErrorEnum _
      Implements IMyInterface.TheFunction
      '...
      Return MyErrorEnum.error1
  End Function
End Class

Public Class SomeOtherImplementation
  Implements IMyInterface

  Public Function TheFunction(ByVal val As MyValueEnum, ByVal name As String, _
                              ByRef someObject As SomeClass) As MyErrorEnum _
      Implements IMyInterface.TheFunction
      '...
      Return MyErrorEnum.error2
  End Function
End Class 
```

考试

```
Dim obj As IMyInterface
Dim result As MyErrorEnum

obj = New SomeImplementation()
result = obj.TheFunction(MyValueEnum.value1, "test", New SomeClass())

obj = New SomeOtherImplementation()
result = obj.TheFunction(MyValueEnum.value2, "another test", New SomeClass()) 
```

# javascript - Chrome/Tampermonkey 用户脚本存储在文件系统的什么位置？

> ID：11850460
> 
> 赞同：40
> 
> 时间：2012-08-07T16:42:25.553
> 
> 标签：javascript, google-chrome, userscripts, tampermonkey

Chrome/Tampermonkey 用户脚本存储在文件系统的什么位置？

我想直接编辑用户脚本，而不是使用浏览器内的编辑器。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-08T08:25:07.700

Tampermonkey 脚本非常容易通过 Tampermonkey 选项卡进行更新。请参阅[Tampermonkey 常见问题解答](http://forum.tampermonkey.net/viewtopic.php?f=16&t=78)，或者尝试一下。

Tampermonkey 脚本存储在一个特殊的 SQLite 数据库中，并且不能以文件形式直接编辑。
**更新：**从[版本 3.5.3630 开始](http://tampermonkey.net/changelog.php?ext=dhdg&more=true#v3.5.3630)，Tampermonkey 脚本现在使用 Chrome 的扩展存储进行存储。它们仍然不能以文件形式编辑，但 Tampermonkey (derjanb) 的开发人员帮助制作[了一个 Python 脚本来提取它们。](https://gist.github.com/derjanb/9f6c10168e63c3dc3cf0)

* * *

对于Chrome和 Chromium 浏览器，Chrome 用户脚本（与***Tampermonkey***脚本不同）存储如下：

```
视窗XP：
  Chrome：%AppData%\..\Local Settings\Application Data\Google\Chrome\User Data\Default\Extensions\
  Chromium：%AppData%\..\Local Settings\Application Data\Chromium\User Data\Default\Extensions\  

Windows Vista/7/8：
  Chrome：%LocalAppData%\Google\Chrome\User Data\Default\Extensions\
  Chromium：%LocalAppData%\Chromium\User Data\Default\Extensions\

Linux：
  铬：~/.config/google-chrome/Default/Extensions/
  铬：~/.config/chromium/Default/Extensions/

Mac OS X：
  铬：〜/图书馆/应用程序支持/谷歌/铬/默认/扩展/
  Chromium：~/Library/Application Support/Chromium/Default/Extensions/

```

请参阅[此答案](https://stackoverflow.com/a/5259212/331508)或[此 Google Groups 主题](http://productforums.google.com/forum/#!topic/chrome/6EVtjeaWObs/discussion%5B1-25%5D)。
请注意，Chrome 用户脚本会自动生成带有自动生成清单的 Chrome 扩展程序。

**然而：**

1.  就地编辑这些文件将不起作用。Chrome 会忽略和/或覆盖更改。
2.  [对于用户脚本，请按照此答案](https://stackoverflow.com/a/5259212/331508)设置您的环境，以便于编辑和更新。
3.  **Tampermonkey 脚本**的存储方式不同。 ~~它们由 Tampermonkey 存储在一个特殊的 SQLite 数据库中，并且不能以这种方式直接编辑。~~ 更新：这已更改为[版本 3.5.3630](http://tampermonkey.net/changelog.php?ext=dhdg&more=true#v3.5.3630)左右。往上看。

# c++ - 在类中使用泛型类成员

> ID：11850461
> 
> 赞同：1
> 
> 时间：2012-08-07T16:42:27.303
> 
> 标签：c++, templates, generics, polymorphism

基于我的问题：[C++ 无法建立对“父”对象的句柄引用——循环包含或未定义的类型错误](https://stackoverflow.com/questions/11832208/c-cannot-establish-handle-reference-to-parent-object-circular-includes-or)我想创建一个具有两个泛型类型成员的类（称为节点），一个指向类型的泛型指针待确定的父对象和指向一组待确定子对象的元素的通用指针向量。存在于双向树结构中的对象将从 Node 继承，并在数据可用时在必要时填充其父成员和子成员。这是到目前为止我对 Node.h 所做的：

```
#include <vector>

#ifndef NODE_H_
#define NODE_H_

template<typename T> class parent{};
template<typename T2> class child{};
class Node{

private:
parent<T>* parent_ptr;
vector<child<T2>>* children_ptr;

public:
 //some accessor methods will go here to get and set the parent and children
};
#endif /*NODE_H_*/ 
```

显然这不是在 C++ 中使用模板的正确方法，因为我收到错误 C2065“'T' is an undeclared identifier”和 C4430“缺少类型说明符 - 假定为 int”错误。我在这里找到了一些关于创建模板类和函数的有用文档：[http](http://www.cprogramming.com/tutorial/templates.html) ://www.cprogramming.com/tutorial/templates.html但该教程和我能找到的任何其他文档似乎都没有涵盖使用模板来声明泛型类非模板类中的成员；我相当确定这（或类似的东西）是我需要为我的用例做的，那么在标准 C++ 类中声明和使用泛型成员变量的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:51:54.713

您绝对应该花一些时间了解模板的工作原理，并从简单的东西开始。我花了数年时间才能够创建复杂的模板对象，而无需进行大量编译器错误调试，甚至花费了更长的时间来设计代码结构以最小化这种复杂性。

但这就是我认为你的意图。您的模板中有太多信息，只需要将类型名称删除到 Parent 和 Child（或者 T 和 T2，如果您愿意的话——尽管这些名称令人困惑）。

```
#include <vector>

#ifndef NODE_H_
#define NODE_H_

template<typename Parent, typename Child>
class Node{

private:
Parent* parent_ptr;
std::vector<Child*> children_ptr;

public:
 //some accessor methods will go here to get and set the parent and children
};
#endif /*NODE_H_*/ 
```

另外作为旁注，您可能需要父母所有权的情况，父母拥有他们的孩子并在他们完成后释放他们的记忆（如果每个孩子都由一个父母拥有）。在这种情况下，向量将变为：

```
vector<Child> children; 
```

否则，您需要为如何删除树创建一个很好的结构。另一种方法是使用智能指针，一旦它们未使用就会自行删除（适用于难以跟踪的抽象结构）。请参阅C++ 更高版本中的[Boost Smart Pointers](http://www.boost.org/doc/libs/1_50_0/libs/smart_ptr/smart_ptr.htm)或等效项，尽管它们需要特别注意循环引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T16:51:43.947

除了向您已经包含的数据添加其他信息之外，`parent`我看不到您需要什么。`node`这是链表中的典型情况，您需要注入一个`next`和 `prev`指针来维护结构。

当您已经在处理指针时，这似乎没有必要：

```
template<typename Parent, typename Child>
class Node {
  Parent* parent;
  std::vector<Child*> children;
}; 
```

对我来说，这仍然是一个非常多的指针，还没有对象管理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T16:53:33.243

你的代码应该这样写：

```
template<typename Parent, typename Child>
class Node
{
private:
    Parent* parent_ptr;
    vector<Child>* children_ptr;

public:
    //some accessor methods will go here to get and set the parent and children
}; 
```

按照你的方式，只有（空）`parent`类有`T`模板参数，只有（空）`child`类有`T2`模板参数。

另外，我不认为你真的想要一个指向`vector`. 你有可能这样做，但这是一个非常奇怪的用法。

但实际上，我认为简单地使用继承会更有意义：

```
class Node
{
private:
    Node* parent_ptr; // a pointer to a Node, or any Node-derived object
    vector<Node*>* children_ptr; // a vector of pointers to Nodes or Node-derived objects

public:
    //some accessor methods will go here to get and set the parent and children
}; 
```

不过， A `vector`of 指针很烦人。我可能会将我`vector`的类包装在一个内部处理内存分配的类中，或者查找一些 C++11 STL 智能指针类。

# jquery - css / jquery中的移动（触摸）设备友好下拉菜单

> ID：11850466
> 
> 赞同：15
> 
> 时间：2012-08-07T16:42:41.360
> 
> 标签：jquery, css, ipad, mobile, drop-down-menu

我一直在阅读有关此主题的许多主题，这是一个在移动设备上友好的下拉菜单。很多时候，最好在下拉菜单上设置非悬停动作。有一些变通方法，其中一个是下拉项的主超链接应链接到主题标签。

这使它可以在移动设备上运行，但对于普通的桌面用户来说，这会令人困惑。所以解决方案是为桌面用户提供一个正常的下拉菜单，其中第一个超链接也链接到一个页面。对于移动用户，点击一个项目将打开下拉菜单，但第二次点击主项目将打开相应的页面。

我看过以下网站，不知何故他们的菜单工作方式完全一样： [http](http://www.hgtv.com/) ://www.hgtv.com/ 您可以在平板电脑上查看并单击主菜单，再次点击该项目，您就会明白我的意思.

但是我怎样才能为我自己的网站找到或下载完全相同的设置？

提前致谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-09-11T03:47:56.547

这是我的工作：

```
function isTouchDevice(){
    return typeof window.ontouchstart !== 'undefined';
}

jQuery(document).ready(function(){
    /* If mobile browser, prevent click on parent nav item from redirecting to URL */
    if(isTouchDevice()) {
        // 1st click, add "clicked" class, preventing the location change. 2nd click will go through.
        jQuery("#menu-main-menu > li > a").click(function(event) {
            // Perform a reset - Remove the "clicked" class on all other menu items
            jQuery("#menu-main-menu > li > a").not(this).removeClass("clicked");
            jQuery(this).toggleClass("clicked");
            if (jQuery(this).hasClass("clicked")) {
                event.preventDefault();
            }
        });
    }
}); 
```

我将它用于我的 WordPress 网站。在桌面浏览器（非触摸浏览器）上，当单击主菜单项时，它将直接转到链接的位置。悬停时，它将显示下拉菜单。

对于移动设备（触摸浏览器），当触摸主菜单项时，它将展开下拉菜单，如果再次单击它将转到新位置。我还添加了“重置”代码行以使这部分工作：如果您触摸第一个主菜单项（展开下拉菜单），然后触摸第二个主菜单项（展开第二个下拉菜单），然后触摸第一个主菜单再次单击项目，它仍将表现为下拉列表，直到再次单击。如果没有这条线，它将直接进入新位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-17T18:52:54.010

这是一种与设备无关的技术（不确定我对功能检测的信任程度。许多现代浏览器报告支持触摸事件，即使界面是鼠标）我曾经使悬停菜单按预期在触摸屏上工作（即防止当我们只想第一次点击触发悬停时，过早地“点击”顶部菜单链接的触摸事件）。

诀窍是要认识到触摸悬停+单击事件将在彼此的顶部发生。即悬停事件将几乎立即跟随单击事件。我们可以检测到这一点并阻止点击通过......仅在悬停事件后经过一定时间阈值时才允许点击触发。

在桌面上进行测试时，无论我点击多快，我都无法让悬停和点击之间的经过时间快于大约 150 毫秒。在 iPad（第 4 代）上进行测试时，悬停和点击之间的经过时间始终约为 7 - 8 毫秒。所以我选择了 50ms 的阈值时间来允许点击。我写的 jQuery 函数如下（假设一个标准的嵌套列表 CSS 悬停菜单）：

```
 function initNav(){
    // make drop-downs work properly with touchscreens by preventing instant hover-click
    $( some_selector_for_your_top_level_list_items ).each(function(){
      var li = $(this);
      li.mouseover(function(){
        // store time of hover event
        li.data( 'hoverTime', new Date().getTime() );
      });
      li.children('a').click(function(){
        // only allow click if at least 50ms has elapsed since hover
        return ( new Date().getTime() - li.data('hoverTime') ) > 50;
      });
    });
  } 
```

到目前为止，工作就像一个魅力。对于速度慢得多的设备来说，50 毫秒可能太低了。

对于非 JS，您仍将默认 CSS 悬停行为作为后备​​。

希望这对人们有所帮助，因为我找不到一个不涉及可疑功能检测和/或使用 JS 重写 CSS 悬停行为的好的插入式解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T17:28:29.263

您将不得不处理多个事件才能在移动和桌面浏览器中获得该功能。

如果您查看该示例菜单，则将鼠标悬停以展开，而在移动设备上，您希望单击/触摸以展开。

我尝试实现此目的的一种方法是为桌面设置“悬停”侦听器，但为移动设备使用“触摸”事件侦听器。

为此，您必须向 jQuery 添加自定义事件，例如“触摸”。有关执行此操作的方法，请参见下面的帖子：

[如何在 iPad 版 Safari 中使用 jQuery 识别触摸事件？是否可以？](https://stackoverflow.com/questions/4755505/how-to-recogized-touch-event-using-jquery-for-ipad-safari-browser-is-it-possibl)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-29T06:08:29.277

试试这个：[http ://suanaikyeo.com/blog/make_dropdown/](http://suanaikyeo.com/blog/make_dropdown/)

我已经尝试过了，它适用于悬停和点击事件..

# html - 相对于滚动 DIV 定位固定 DIV？

> ID：11850467
> 
> 赞同：2
> 
> 时间：2012-08-07T16:42:42.403
> 
> 标签：html, css

我正在尝试在我的网站上放置一个浮动菜单，该菜单位于浏览器的中心。

![滚动条](../Images/0c92100a152bc4f0fe52a0e72906a156.png)

我已经制作了静态 div“位置：固定”并设置了“左：0”。我希望静态 div 和其余滚动内容之间的差距保持不变。我尝试将两个 div 包装在一个居中对齐的父 div 中，但这不起作用。

你知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:05:17.693

我认为这就是您想要的...固定的 div 只是您所期望的固定位置。滚动有一个左边距，可以将其从固定的边缘推开一定的量（改变它来改变间隙）。然后有一个包装器 div，如您在问题中所说的那样居中，将它们全部放在页面中间。

[演示](http://jsbin.com/ojiqeq/1/)

HTML

```
<div id="wrap">
  <div id="fix">test</div>
  <div id="scr">test<br /></div>
</div> 
```

CSS

```
#wrap {
  width: 500px;
  background-color:#F00;
  margin: 0 auto;
}
#fix {
  border: 1px solid #ccc;
  height: 100px;
  width: 200px;
  position: fixed;
}

#scr {
  border: 1px solid #000;
  margin-left: 220px;
  position: relative;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:08:34.617

好吧，我迟到了，但你可以像这样设置 body 标签：

```
body {
    margin-left: 200px;
} 
```

[jsFiddle 示例](http://jsfiddle.net/rzQPa/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:04:00.547

由于您对 div 的宽度及其位置一无所知，我可以建议一个非常简单的解决方案：静态 div 必须具有固定宽度和滚动宽度 - 左侧边距等于静态宽度加上某个值（间隙宽度）

```
div#static
{
   width: 200px;
   ...
}

div#scrolling
{
   margin-left:180px;
   ...
} 
```

间隙将具有 20px 的恒定值

# log4j - 如何在码头上使用电梯配置日志记录

> ID：11850470
> 
> 赞同：1
> 
> 时间：2012-08-07T16:42:58.190
> 
> 标签：log4j, jetty, lift

这是log4j在lift的配置

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM
        "http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/xml/doc-files/log4j.dtd">
<log4j:configuration threshold="trace" xmlns:log4j="http://jakarta.apache.org/log4j/">
    <appender name="CA" class="org.apache.log4j.FileAppender">
        <param name="File" value="sample.log"/>
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern" value="[%d{ISO8601}] %-8r [%t] %-5p %c %x - %m%n"/>
        </layout>
    </appender>
    <root>
        <level value="trace"/>
        <appender-ref ref="CA"/>
    </root>
</log4j:configuration> 
```

这是 Boot.scala 中的相关部分

```
Logger.setup = Full(Log4j.withFile(getClass.getResource("/props/default.log4j.xml"))) 
```

我在码头 6.22 上运行电梯应用程序。当我使用“jetty service start”启动jetty时，它会在jetty tmp_dir文件夹/var/cache/jetty/tmp/sample.log中创建日志文件

如何配置它以在另一个位置创建日志文件？例如码头日志文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:52:16.480

由于您仅在 FileAppender 声明中使用文件名“sample.log”，因此 Jetty 将日志文件存储在其工作目录中。

解决方案是指定绝对路径，或者可能使用变量。例如：

```
<param name="File" value="${java.io.tmpdir}/sample.log"/> 
```

将 sample.log 存储在依赖于操作系统的 java.io.tmpdir 中。

花括号内的值是系统属性。您可以在命令行上将任何内容指定为系统属性，然后在 Log4J 文件中访问它。例如：

```
java -Dmyloggingdir=/var/tmp/myloggingdir 
```

接着：

```
<param name="File" value="${myloggingdir}/sample.log"/> 
```

如果 Jetty 日志目录是系统属性，那么您应该能够访问它。

# c - Ubuntu 上 C 语言中的 sqrt

> ID：11850478
> 
> 赞同：-1
> 
> 时间：2012-08-07T16:43:25.330
> 
> 标签：c

我必须编写一个程序来查找用户输入的整数的平方根。但是我遇到了一个问题——程序不计算sqrt。我在互联网上搜索了问题，阅读了所有解决方案，但他们没有帮助我。在这个论坛上有很多关于这个主题的问题，但是那里描述的解决方案对我不起作用。

实际上，`sqrt`当用户输入整数时，函数不起作用。当我设置一个值时，它可以完美运行。换句话说，它找到一个sqrt 的常量，但不是变量。

我用这段代码编译它（因为到处都是写的）`gcc -o sqrt -lm sqrt.c`

我在 Ubuntu 上工作。

这是代码：

```
#include<stdio.h>
#include<math.h>
main()
{
int a;
double b=sqrt(a);
scanf("%i", &a);
printf("sqrt of integer is %lf", b);
getchar();
getchar();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T16:44:24.010

> ```
> int a;
> double b=sqrt(a);
> scanf("%i", &a); 
> ```

您`a`在初始化之前使用变量 ( )。`scanf`应该在`sqrt`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T16:53:04.407

要为已经编写的两个好的答案添加一些内容：您需要记住，C 中的主要指令序列是线性的 - 首先编写的指令首先执行。如果我们谈论数学，可以说“让 b 成为**函数**sqrt(a)，然后找出 b(a) 是什么”。实际上，您可以通过定义自己的函数在 C 中做到这一点，但那是另一回事。注意：计算机并没有按照您的想法去做。它做你告诉它做的事情。

# spring-mvc - @会话属性

> ID：11850481
> 
> 赞同：1
> 
> 时间：2012-08-07T16:43:42.357
> 
> 标签：spring-mvc

当控制器方法重定向到任何 url 时，框架会自动将所有模型属性附加到 url 查询字符串中，即使这些属性存储在会话中。

有什么办法可以禁用该自动附加。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T06:43:50.500

如果您使用的是 Spring 3.1，则可以`RedirectAttributes`在控制器方法中用作参数。当您重定向到另一个控制器时，使用此对象传递属性。

例子：

```
 @RequestMapping(value = "/accounts", method = RequestMethod.POST)
 public String handle(Account account, BindingResult result, RedirectAttributes redirectAttrs) {
     if (result.hasErrors()) {
         return "accounts/new";
     }
     // Save account ...
     redirectAttrs.addAttribute("id", account.getId()).addFlashAttribute("message", "Account created!");
     return "redirect:/accounts/{id}";
 } 
```

资源：

[Spring 3.1 参考](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/servlet/mvc/support/RedirectAttributes.html)

# parallel-processing - 在 unix 集群上找不到函数：matlab 并行：未定义的函数

> ID：11850483
> 
> 赞同：1
> 
> 时间：2012-08-07T16:43:48.007
> 
> 标签：parallel-processing, cluster-computing, undefined, matlab

我正在尝试在大型集群上运行并行作业；所有代码和功能在我的计算机上都可以正常工作（Mac OS 10.7 和 Matlab v7.13.0.564 (R2011b)），但是集群上有些东西不起作用（unix-redhat 5.5 - kernel = 2.6.18-238.12.1.el5 Matlab v7.13.0.564 (R2011b)

以下是在我的机器上正常运行但在集群上失败的命令序列。该函数`add2nums`位于子目录`./lib`中，并且也在下面记录。

```
function out = add2nums(num1, num2)
    out = num1+num2;
end 
```

发生了什么事，我该如何解决？

```
>> addpath('./lib')

>> which add2nums

/My_Matlab_Path/lib/add2nums.m (matlab sees the function on my machine and on unix cluster)

>> sched = findResource('scheduler','type','local');

>> job = createParallelJob(sched,'configuration','local');

>> task = createTask(job,@add2nums,1,{[1 2],[3 4]},'CaptureCommandWindowOutput',true);   

>> addpath('./lib')

>> submit(job)

>> waitForState(job)

>> task

task =

Task ID 1 from Job ID 19 Information
====================================

                     State : finished
                  Function : @add2nums
                 StartTime : Tue Aug 07 10:27:44 MDT 2012
          Running Duration : 0 days 0h 0m 1s

- Task Result Properties

           ErrorIdentifier : MATLAB:UndefinedFunction
              ErrorMessage : Undefined function 'add2nums' for input arguments of type 'double'. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T15:29:59.613

找到了解决方案；在这种情况下，它可能特定于我正在研究的 unix 系统架构。我从一个文件系统提交作业，它们在单独的（临时）目录中运行 - 在单独的文件系统上。我认为这些实际上是不同建筑物中的不同硬件，但我并不肯定。

解决方法是添加以下行：

> p = 'PATH_TO_LOCAL_DIRECTORY_OF_FUNCTIONS';
> 
> 设置（作业，'FileDependencies'，{p}）；

我之前曾尝试设置 FileDependencies 属性 - 但我之前使用了一个路径，无论出于何种原因，matlab 工作人员都无法使用。我的解决方案是将我的整个子函数目录复制到运行 unix 作业的远程（临时）目录；只要“FileDependencies”属性指向它，这个远程目录就对 matlab 工作人员是本地的并且可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T00:01:59.437

阅读[文档](http://www.mathworks.com/help/toolbox/distcomp/bqur7ev-2.html#bqur7ev-9)，您似乎需要设置文件和路径依赖项。

请参阅并行作业对象的[FileDependencies](http://www.mathworks.com/help/toolbox/distcomp/filedependencies.html)和[PathDependencies](http://www.mathworks.com/help/toolbox/distcomp/pathdependencies.html)属性。

# java - 无法发现“无法访问的代码”

> ID：11850488
> 
> 赞同：1
> 
> 时间：2012-08-07T16:44:21.620
> 
> 标签：java

我的程序中有一些没有意义的东西。可能是我的 while 语句在它的循环中嵌入了几个不同的 if 语句。但主要错误是在我的while循环之后，我似乎无法弄清楚。我评论了错误在哪里。

这是程序的样子：

```
import java.util.*;
import java.io.*;

class MorseCode 
{
 public static void main (String [] args) throws FileNotFoundException
 {
  Scanner keyboard = new Scanner(new File("myfile.txt")); 
  String text = " "; 

while (keyboard.hasNextLine())
{
 text = keyboard.nextLine(); 
 morse(text); // Goes through morse(text);
 String code = ""; // String is declared 
 code = morse(text); 
 System.out.println(code); // prints the code which is being called upon morse(text)
 }
  keyboard.close(); 
}
 static String morse(String text)
 {
  String code = "";
  int i = 0;
  while (true) { 
  if (text.charAt(i) == 'a' || text.charAt(i) == 'A')
    System.out.print(".-");
  if (text.charAt(i) == 'b' || text.charAt(i) == 'B')
    System.out.print("-...");
  if (text.charAt(i) == 'c' || text.charAt(i) == 'C')
    System.out.print("-.-.");
  if (text.charAt(i) == 'd' || text.charAt(i) == 'D')
    System.out.print("-..");
  if (text.charAt(i) == 'e' || text.charAt(i) == 'e')
    System.out.print(".");
  if (text.charAt(i) == 'f' || text.charAt(i) == 'F')
    System.out.print("..-."); 
  if (text.charAt(i) == 'g' || text.charAt(i) == 'G')
    System.out.print("--.");
  if (text.charAt(i) == 'h' || text.charAt(i) == 'H')
    System.out.print("....");
  if (text.charAt(i) == 'i' || text.charAt(i) == 'I')
    System.out.print("..");
  if (text.charAt(i) == 'j' || text.charAt(i) == 'J')
    System.out.print(".---");
  if (text.charAt(i) == 'k' || text.charAt(i) == 'K')
    System.out.print("-.-");
  if (text.charAt(i) == 'l' || text.charAt(i) == 'L')
    System.out.print(".-..");
  if (text.charAt(i) == 'm' || text.charAt(i) == 'M')
    System.out.print("--");
  if (text.charAt(i) == 'n' || text.charAt(i) == 'N')
    System.out.print("-.");
  if (text.charAt(i) == 'o' || text.charAt(i) == 'O')
    System.out.print("---");
  if (text.charAt(i) == 'p' || text.charAt(i) == 'P')
    System.out.print(".--.");
  if (text.charAt(i) == 'q' || text.charAt(i) == 'Q')
    System.out.print("--.-");
  if (text.charAt(i) == 'r' || text.charAt(i) == 'R')
    System.out.print(".-.");
  if (text.charAt(i) == 's' || text.charAt(i) == 'S')
    System.out.print("...");
  if (text.charAt(i) == 't' || text.charAt(i) == 'T')
    System.out.print("-");
  if (text.charAt(i) == 'u' || text.charAt(i) == 'U')
    System.out.print("..-");
  if (text.charAt(i) == 'v' || text.charAt(i) == 'V')
    System.out.print("...-");
    if (text.charAt(i) == 'w' || text.charAt(i) == 'W')
    System.out.print(".--");
  if (text.charAt(i) == 'x' || text.charAt(i) == 'X')
    System.out.print("-..-");
  if (text.charAt(i) == 'y' || text.charAt(i) == 'Y')
    System.out.print("-.--");
  if (text.charAt(i) == 'z' || text.charAt(i) == 'Z')
    System.out.print("--..");
  if (text.charAt(i) == '1')
    System.out.print(".----");
  if (text.charAt(i) == '2')
    System.out.print("..---");
  if (text.charAt(i) == '3')
    System.out.print("...--");
  if (text.charAt(i) == '4')
    System.out.print("....-");
  if (text.charAt(i) == '5')
    System.out.print(".....");
  if (text.charAt(i) == '6')
    System.out.print("-....");
  if (text.charAt(i) == '7')
    System.out.print("--...");
  if (text.charAt(i) == '8')
    System.out.print("---..");
  if (text.charAt(i) == '9')
    System.out.print("----.");
  if (text.charAt(i) == '0')
    System.out.print("-----");
  if (text.charAt(i) == '-')
    System.out.print("...");
  if (text.charAt(i) == ' ')
    System.out.print(".......");
  i++;  
  }
   if (i < text.length());  //Unreachable code 
    return code;

 }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T16:46:48.983

将括号向下移动一个（在 i++ 之后），如下所示：

```
 if (text.charAt(i) == '0')
            System.out.print("-----");
        if (text.charAt(i) == '-')
            System.out.print("...");
        if (text.charAt(i) == ' ')
            System.out.print(".......");
        i++;  
        if (i < text.length())  //Reachable code now :)
            return code;
        }
    }
} 
```

这样你就可以真正到达检查你是否准备好爆发的地方

您还可以将 while 循环的条件从 true 更改为 (i < text.length())，但您当前的代码表明您正在尝试执行上述操作，但只是放错了括号:)

另外，不确定您在这里要做什么；您要打印还是退回？code 的值永远不会从 "" 改变，但你仍然返回它。我认为你应该用 code+= 替换打印，这样你才能真正返回适当的东西，然后你可以做 System.out.println(morse("Something"));

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-07T16:49:03.287

您的 while 循环永远不会终止。

如果您想遍历文本字符串中的字符，我建议您更改：

`while (true) {`

至

`while (i < text.length()) {`

`code`然后在while循环完成后简单地返回。

我还建议您使用**if-else**语句而不是一系列 if 语句，这样就不必为每个字符评估所有 if 条件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-07T16:48:27.280

是你的`while(true)`。循环永远不会结束，因此永远不会到达循环之后的代码。

使用设置为 true 的布尔变量。

```
boolean x = true;
while (x) {...} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-07T16:46:24.597

您使用`while (true) {`- 这将永远不会终止。

如果您想使用：

```
while (keyboard.hasNext()) { 
```

那么您需要将 Scanner 实例传递给您的 morse 方法。一般来说，虽然最好让这种方法只做一项工作——翻译。为什么不使用 a`Map<String, String>`来存储您的莫尔斯翻译并使用 translateMorse 方法？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-07T16:47:14.957

您的程序将永久卡在 while(true) 循环中，因为根据定义，真条件始终为真。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-07T17:17:43.760

**1.**你的代码**永远不会终止**，因为它在一个`Infinite while loop`.

**2.**你`while( i<text.length() )` **代替** `while(true)`

**3.**我会进一步**不鼓励**使用`if`or`if-else`梯子，当有两到三个条件要检查时它是可以的，但是**对于像你上面例子中的东西**，使用`switch statement`.

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-08-07T16:49:37.610

你的while循环应该是
`while (i < text.length()) {`

并且应该删除无法访问的 if 语句，您应该在那里做
`return code;`

# mysql - 在 MySQL 视图中创建一个不存在的字段

> ID：11850496
> 
> 赞同：0
> 
> 时间：2012-08-07T16:45:11.963
> 
> 标签：mysql, views

如果可能的话，我想在 MySQL 视图中创建一个不存在的字段。

说`select * from authors`

然后，如果存在一个字段并且它是 1，我想添加一个字段`image`并为其分配一个值`tick.gif`。这可能吗？

这样我就可以轻松地使用一个相当闪存的网格程序！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:48:53.207

你可以试试

```
select a.*, if(a.living = 1, "tick.gif", NULL) as image from authors a 
```

# java - 分布式自然任务和 Akka

> ID：11850501
> 
> 赞同：0
> 
> 时间：2012-08-07T16:45:59.063
> 
> 标签：java, distributed-computing, akka, message-passing

这是我的问题的简化版本：

1.  在我们拥有的服务器上`n*m`- 类型的矩阵`int[][]`，我们将该矩阵拆分为一组`n`行向量并将它们放入队列中。
2.  当队列准备好（充满向量）时，我们循环并将每个向量发送到`k`网络上某处的一个客户端，当且仅当客户端可以自由获取向量时（一些客户端状态以消息的形式检查-通过会很方便）。
3.  所有客户端对给定的向量执行相同的操作 - 它们计算向量的范数（长度）并将结果发送回存储它的服务器。
4.  当所有客户端都完成后，服务器会在启动初始作业的机器上打印结果。

我将在 Java 中使用[Akka](http://akka.io/)分布式计算框架。您能否告诉我从哪里开始学习 Akka 工具，因为我还不知道如何使用它。演员可能是那些客户..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:56:47.507

Akka 有一个[入门教程](http://doc.akka.io/docs/akka/2.0.1/intro/getting-started-first-java.html)，该教程通过与您所描述的过程非常相似的过程来计算 Pi。

当然还有一个[Scala 版本](http://doc.akka.io/docs/akka/2.0.1/intro/getting-started-first-scala.html)。

# vb.net - 继承层次结构中的事件处理程序序列是否已修复？

> ID：11850507
> 
> 赞同：1
> 
> 时间：2012-08-07T16:46:17.063
> 
> 标签：vb.net, events, inheritance, event-handling

我有一个基类，一个从基类继承的中间类，以及一个从中间类继承的顶级类。我在基类中定义了一个事件并从一个方法中引发它。我在中间类中为基类事件定义了一个处理程序，也在顶级类中定义了相同的处理程序。当事件触发时，中间类处理程序首先被击中，然后是顶级处理程序。

如果我继续向链中添加更多类（ultra 继承自 top，supreme 继承自 ultra 等），事件处理程序会首先在最基本的类中被调用（例如，middle、top、ultra、supreme）。

这个序列总是成立吗？如果没有，什么可以/会使它以不同的顺序运行？

我观察的顺序非常适合这个功能；我只是想确保它能够始终如一地工作。

我知道事件不能保证以任何顺序触发，但这是框架在编译时知道的，作为代码的作者，我可以说在运行时不会为此事件添加/删除委托，也不会该事件是否会在基础及其子类链之外被消耗；事实上，它受到保护。

我不知道幕后发生了什么，但也许它在编译期间设置了序列，因此在运行时它已经完成了？

编辑：为了清楚我在做什么，我正在添加示例。

```
Public Class BaseClass

  Protected Event Hello(ByRef Cancel As Boolean)

  Public Sub SayHello()
    Dim Cancel As Boolean
    RaiseEvent Hello(Cancel)
  End Sub

End Class

Public Class MiddleClass
  Inherits BaseClass

  Private Sub MiddleClass_Hello(ByRef Cancel As Boolean) Handles Me.Hello
    'This appears to always get called first
  End Sub

End Class

Public Class TopClass
  Inherits MiddleClass

  Private Sub TopClass_Hello(ByRef Cancel As Boolean) Handles Me.Hello
    'This appears to always get called second
  End Sub

End Class

Public Class UltraClass
  Inherits TopClass

  Private Sub UltraClass_Hello(ByRef Cancel As Boolean) Handles Me.Hello
    'This appears to always get called third
  End Sub

End Class

'...and so on 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T04:26:08.567

在您的特定代码示例中，订单将按照您的预期行事。

当您有一个标记为 的方法时，`Handles Me....`VB 编译器所做的所有事情就是在构造函数的最开始处粘贴一个隐藏的 AddHandler 语句。构造函数从基类型运行到派生类型，因此基类型的隐藏 AddHandler 将在派生类型中的 AddHandler 之前运行。*只要您的 RaiseEvent 是按照添加处理程序的顺序引发事件*，那么是的，您会看到现在看到的顺序。对于像您这样的简单 VB 事件，这种行为极不可能改变。

请注意我上面的警告：如果事件不是一个简单的事件，而是一个自定义事件，其中基类可以为 AddHandler 和 RaiseEvent 指定它自己的行为，那么所有的赌注都没有了。没有什么能阻止我制作自己的 RaiseEvent 以我想要的任何随机顺序运行处理程序（假设它甚至运行所有处理程序！）如果 Base 类不是你拥有的东西，如果你假设排序，我会小心。

通常，具有细微排序要求的事件处理程序通常会创建难以调试的代码位。如果可以，最好避免。如果基/派生的顺序很重要，您可以通过使用重写的方法使代码更清晰，并让派生类型在适当的位置调用 MyBase。

# php - $.ajax 不从 php 执行 jquery 代码

> ID：11850508
> 
> 赞同：-1
> 
> 时间：2012-08-07T16:46:23.223
> 
> 标签：php, jquery, html

我正在尝试从 ajax 调用的 php 页面执行 jquery 代码。

更改 div.error 的 html

这是代码（如果有更简单的方法，只需告诉/发布）：-no $.load

HTML/jQuery: jquery.js 已经链接

```
<input type='text' id='test'>
<div id='error' style='display:inline-block;'>CHANGE HERE</div><bR>
<input type='submit' value='run' id='button'>

<script type='text/javascript'>
$('#button').click(function(){
$.ajax({
    url: "test.php",
    type: "POST",
    data: "test="+ test,
    success: function(jqXHR){
    },
    error: function() {
        alert('error');
    }
});
});
</script> 
```

测试.php

```
<script type='text/javascript'>
$('#error').html('working');
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:47:52.777

您正在使用的`test`变量似乎没有在任何地方声明。先尝试硬编码。此外，`{key:value}`语法是首选的，因为它确保在发送到服务器时正确地对值进行 url 编码：

```
data: { test: 'some value' } 
```

如果要使用变量，请确保已声明它：

```
$('#button').click(function() {
    var test = 'foo bar';
    $.ajax({
        url: 'test.php',
        type: 'POST',
        data: { test: test },
        success: function(data) {

        },
        error: function() {
            alert('error');
        }
    });
}); 
```

此外，如果您希望 javascript 在您的 php 脚本中执行，请删除`<script>`标签：

```
$('#error').html('working'); 
```

并在您的调用中指定`dataType`参数：`script``$.ajax`

```
dataType: 'script' 
```

另一种可能性是让您的`test.php`脚本简单地返回值：

```
working 
```

然后在成功回调中刷新 DOM：

```
success: function(data) {
    $('#error').html(data);
}, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:51:59.290

内部的 JavaScript`test.php`不会运行，因为你从来没有告诉过它。它不仅会运行，因为您加载了它。它需要在 DOM 中才能运行。

试试这个：

```
$.ajax({
    url: "test.php",
    type: "POST",
    data: "test="+ test,
    success: function(data){
        $(data).filter('script').appendTo('head');
    },
    error: function() {
        alert('error');
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:50:17.003

您的 test.php 脚本应该输出您想要显示的内容。

它应该看起来像：

```
echo "<html>";
echo "<div>working</div>";
echo "</html>"; 
```

以便它返回一些东西。现在，您只返回 javascript。

# c# - 通过转换其单位来制作数据库的副本

> ID：11850511
> 
> 赞同：0
> 
> 时间：2012-08-07T16:46:45.177
> 
> 标签：c#, sqlite

我的应用程序需要两个单位（`SI`，`US`）的数据库。一旦用户选择使用`SI`单位，退出时我需要将值转换为`US`并将其保存在 US DB

假设用户选择（SI 单位）并对其中一个表格上的变量 THickness 进行一些编辑。

退出时，我也应该将这些保存在 SI 单位数据库中。目前，该程序仅在一个数据库中执行所有保存输入....和其他内容。

关于如何实现这一点的任何输入都会很好

这是我到目前为止所做的 在退出时，为模式创建创建另一个连接，

```
private void btnExit_Click(object sender, EventArgs e)
{
    DbConnection c = CreateConnectionForSchemaCreation("STAR-SI.Sqlite");
    this.Close();   
}

public DbConnection CreateConnectionForSchemaCreation(string fileName)
{
    var connOther = new SQLiteConnection();
    connOther.ConnectionString = new DbConnectionStringBuilder()
    {
        {"Data Source", fileName},
        {"Version", "3"},
        {"FailIfMissing", "False"},
    }.ConnectionString;

    connOther.Open();
    return connOther;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:51:53.257

如果用户来回转换多次怎么办？似乎每次用户切换单位时都必须重新生成数据库是不必要的复杂。

SI 单位的每个可能选择与美国测量中的相应选择之间是否存在明确的 1:1 映射？

我会建议以下之一：

*   如果存在 1:1 映射，则以 SI 或 US 单位之一存储，并在需要时转换为应用层中的另一个
*   如果没有 1:1 映射，则在单个数据库中为 SI 和 US 单位设置可为空的列。将用户的选择存储在适当的列中，并将另一列设为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:22:35.997

执行此操作的方法错误，您应该将 UnitOfMeasure 字段与值一起存储。

例如

```
"Weight 1",1,"kilogram"
"Weight 2",2.2,"lb" 
```

然后在用户的个人资料中，他们偏好 SI 或 US，您可以根据数据操作的需要进行转换。

几个数据库函数、一个额外的列、一个保存 UOM 的表和一个用于转换的表，工作完成。

更不用说您可以处理系统转换，例如 16 盎司到英镑等，这些代码几乎完全相同。

# sql - 如何快速加入top 1

> ID：11850515
> 
> 赞同：0
> 
> 时间：2012-08-07T16:46:50.933
> 
> 标签：sql, sql-server

我有一个带有设备的表，还有一个带有性能计数器的表。所以我有设备 A，可以说性能计数器表中有 1000 个条目。我正在尝试获取所有设备，其中 2500 台，以及它们最近的性能计数器。我使用了 Outer Apply，它确实实现了预期的结果，但查询需要 5 分钟才能执行。

这是获取我正在寻找的信息的最佳方式还是有更好的方式？这个查询的性能是否正常，我只是要求太多了？我正在考虑每晚创建第三个“临时”表来保存这些数据，以便我可以快速显示和查询信息。这样的最佳实践是什么？

这是我当前的查询：

```
 select * from Device D
      OUTER APPLY
          ( select top 1 *
              FROM PerformanceCounterValues
              where instance_id = D.pkid
              order by collection_time desc
           ) as tbl2 
```

- - - 解决了 - -

这是我最后的实际查询，它在 0 秒内工作。

```
SELECT pkid, D.IDDevice, D.IDHardware, H.IDRecorder, D.Name, D.Description, H.Name as HardwareName, H.URI, R.HostName, R.Name as RecorderInstance, tbl2.collection_time, tbl2.raw_value, tbl2.calculated_value
  FROM [Surveillance].[dbo].[PerformanceCounterInstance] PCI
  JOIN [Surveillance].[dbo].[Devices] D on D.IDDevice = (SELECT REPLACE(STUFF([instance_name],1,CHARINDEX('[',[instance_name]),''),']',''))
  JOIN [Surveillance].[dbo].[Hardware] H on H.IDHardware = D.IDHardware
  JOIN [Surveillance].[dbo].[Recorders] R on R.IDRecorder = H.IDRecorder
    OUTER APPLY
    ( select top 1 *
        FROM [Surveillance].[dbo].[PerformanceCounterValue]
        where instance_id = PCI.pkid
        order by collection_time desc
        ) as tbl2
  where category_name = 'VideoOS Recording Server Device Storage'
  and D.Enabled = 1 
```

只是设置了使速度增加的索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:53:48.073

尝试

```
 select D.pkid, max(PerformanceCounterValues.collection_time)
  from Device D
  join PerformanceCounterValues
  on  PerformanceCounterValues.instance_id = D.pkid 
  group by D.pkid 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:53:43.830

我不确定什么索引最适合`outer apply`查询，但您可以尝试`(instance_id, collection_time)`为此添加索引：

```
 SELECT 
        d.*                --- whatever columns you need from Device 
      , p.*                --- and from PerformanceCounterValues
   FROM Device AS d
     JOIN
       ( SELECT instance_id, 
                MAX(collection_time) AS max_collection_time
         FROM PerformanceCounterValues
         GROUP BY instance_id
       ) AS grp
       ON  grp.instance_id = d.pkid
     JOIN PerformanceCounterValues AS p
       ON  p.instance_id = grp.instance_id 
       AND p.collection_time = grp.max_collection_time ; 
```

如果您在问题中添加查询的执行计划也会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:26:48.993

尝试直接在连接上选择前一个，我在一个表中有大约 20,000 个相应的条目，我想从日志表中获取第一个条目时间。我的查询在 2 秒内执行（MsSql 2008）

```
select D.pkid, pvc.*
from Device D
join PerformanceCounterValues as pcv on pcv.PrimaryKey = (SELECT top(1) PrimaryKey From      PerformanceCounterValues WHERE instance_id = D.pkid ORDER BY collection_time ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T15:13:51.887

启用索引并使用此查询：

```
SELECT pkid, D.IDDevice, D.IDHardware, H.IDRecorder, D.Name, D.Description, H.Name as HardwareName, H.URI, R.HostName, R.Name as RecorderInstance, tbl2.collection_time, tbl2.raw_value, tbl2.calculated_value
  FROM [Surveillance].[dbo].[PerformanceCounterInstance] PCI
  JOIN [Surveillance].[dbo].[Devices] D on D.IDDevice = (SELECT REPLACE(STUFF([instance_name],1,CHARINDEX('[',[instance_name]),''),']',''))
  JOIN [Surveillance].[dbo].[Hardware] H on H.IDHardware = D.IDHardware
  JOIN [Surveillance].[dbo].[Recorders] R on R.IDRecorder = H.IDRecorder
    OUTER APPLY
    ( select top 1 *
        FROM [Surveillance].[dbo].[PerformanceCounterValue]
        where instance_id = PCI.pkid
        order by collection_time desc
        ) as tbl2
  where category_name = 'VideoOS Recording Server Device Storage'
  and D.Enabled = 1 
```

# database - 在zend中连接不同数据库的最佳解决方案是什么

> ID：11850516
> 
> 赞同：1
> 
> 时间：2012-08-07T16:47:01.210
> 
> 标签：database, zend-framework

假设我想在 ZEND 中的两个不同数据库上运行相同的查询？什么是最好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T04:28:26.603

让我向您介绍 ORM。

您可能想要下载和使用[Doctrine2](http://www.doctrine-project.org/)，学习它几乎不需要一两天的时间，并且考虑到您知道使用 JOIN 的逻辑等，使用 createQueryBuilder SQL 脚本会更容易。

开始尝试 Doctrine CLI，一旦你准备好了，你可能会手动使用它！

享受编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:40:14.333

创建一个适配器（实际上是代理），它将在它自己的内部适配器上执行查询。但是您需要注意其中一个调用失败或结果不同的情况。

如果您的用例是数据库的复制，我建议使用[现成的解决方案](http://dev.mysql.com/doc/refman/5.0/en/replication.html%29)

# hibernate - Spring Hibernate vs jdbc模板vs spring orm

> ID：11850521
> 
> 赞同：9
> 
> 时间：2012-08-07T16:47:24.260
> 
> 标签：hibernate, spring-data, spring-orm

我们有一个以 MySQL 数据库和 Spring 作为框架的项目。我对 Spring 很陌生，希望实现数据库访问层，发现有几个选项可用，比如

*   使用 Spring + Hibernate
*   使用 Spring JDBC 模板
*   使用 Spring ORM 模块

我浏览了 stackoverflow 中的各种帖子，并在网上做了一些研究，但每个问题都有不同的答案，支持不同的选项。此外，我确实看到了关于 Spring JDBC 模板现在不被推荐的提及。

应用程序每小时可能有大约 1000 个事务，大约有 60% 的读取和 40% 的写入。

任何人都可以帮助我找到关于 3 个选项中哪一个适合以及为什么的答案？或者，如果您可以向我指出一些资源，那也将不胜感激。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-08-07T16:57:38.580

Hibernate 只是 Spring 支持的众多 ORM 解决方案之一；其他列[在此处](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/orm.html)。

如果满足以下所有条件，您可能会选择 ORM：

1.  你有一个实体对象模型来映射关系数据。
2.  您喜欢 ORM 层为您生成的 SQL。
3.  您的架构很好地符合 ORM 解决方案的要求。
4.  您没有使用很多存储过程。
5.  您认为您无法比 ORM 更好地优化 SQL。

如果其中任何一个不正确，那么 ORM 可能不适合您。

Spring JDBC 模板轻巧简单。我敢打赌，它可以满足您提出的要求。我建议您继续这样做，直到您发现您的要求驱使您使用 ORM。如果您遵循典型的 Spring 习惯用法并创建基于接口的持久层，这将意味着注入一个实现而不是另一个实现。

# jquery - Masonry IE9 始终只显示一列

> ID：11850526
> 
> 赞同：3
> 
> 时间：2012-08-07T16:47:35.677
> 
> 标签：jquery, jquery-masonry

我的 Masonry 在 ie9 中总是只有一列，尽管在 Firefox 中它显示的列很好。我在小提琴中放了一个简单的例子：http: [//jsfiddle.net/vNXGB/](http://jsfiddle.net/vNXGB/)

它是一样的，有或没有浮动：左。无论我尝试了三个 imagesLoaded 脚本中的哪一个，以及我是否有图像，它似乎都是一样的：

[https://gist.github.com/1539102](https://gist.github.com/1539102)

[https://github.com/desandro/imagesloaded/](https://github.com/desandro/imagesloaded/)

[https://github.com/alexanderdickson/waitForImages](https://github.com/alexanderdickson/waitForImages)

那么这会在我的 Fiddle 代码中留下问题吗？我尝试在其他地方应用 CSS，尝试将 IE 设置重置为默认值，清除 IE 缓存，上传我的网站，使其不在本地主机上，等等。

有任何想法吗？谢谢。:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-15T10:02:23.973

好吧，以防其他人也被永久卡在这一点上，这是desandro（作者）的答案：

> 感谢您提交此错误 :)
> 
> 看起来这是由一些 CSS 引起的
> 
> .brick { 边距：0 自动 10 像素自动；}
> 
> 这些自动导致 IE 将砖块的宽度测量为占据容器的整个宽度。将其更改为边距：0 0 10px 0; 似乎解决了它。
> 
> 见[http://codepen.io/desandro/pen/sflJa](http://codepen.io/desandro/pen/sflJa)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-18T15:12:21.827

谢谢詹妮弗，

我只想补充一点，这个问题/解决方案也适用于 Metafizzy 的 Packery。我没有测试过同位素，但如果你也在那里找到它，我不会感到惊讶。

# javascript - 使用 Javascript 获取用户的 Github 存储库列表

> ID：11850527
> 
> 赞同：5
> 
> 时间：2012-08-07T16:47:38.207
> 
> 标签：javascript, api, github, repository

首先，感谢您的阅读。

我在 GitHub 上托管我当前的项目。使用 GitHub Pages，我]托管我的个人博客，[您可以在此处访问该博客](http://yonaba.github.com/)。

在博客上，我有一个专门介绍我目前正在从事的所有项目的页面。基本上，我想通过查询 GitHub 自动显示我所有正在进行的项目的列表。

虽然谷歌搜索了很多，我发现[这可以使用 JavaScript 来实现](http://aboutcode.net/2010/11/11/list-github-projects-using-javascript.html)。我试过了，但没有按预期工作。加载页面时，我只收到短信“查询 GitHub 以获取存储库”。似乎什么也没有发生。

我联系了 GitHub 维护人员，他们友好地回答说这种技术使用了过时的 GitHub API 版本。

由于我在 JavaScript 方面没有经验，任何人都可以帮我解决它吗？

问候，
罗兰。

* * *

这是我在[HTML 页面中使用的代码](http://yonaba.github.com/projects.html)

```
<div id="opensource-projects"></div> 

<!-- JavaScript to load and display repos from GitHub -->
<script src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/javascripts/git.js" type="text/javascript"></script>
<script type="text/javascript">
  $(function() {
    $("#opensource-projects").loadRepositories("Yonaba");
  });
  </script> 
```

然后，在文件`git.js`中，我有以下内容：

```
// http://aboutcode.net/2010/11/11/list-github-projects-using-javascript.html

jQuery.githubUser = function(username, callback) {
  jQuery.getJSON("http://github.com/api/v1/json/" + username + "?callback=?", callback);
}

jQuery.fn.loadRepositories = function(username) {
  this.html("<span>Querying GitHub for " + username +"'s repositories...</span>");

  var target = this;
  $.githubUser(username, function(data) {
    var repos = data.user.repositories;
    sortByNumberOfWatchers(repos);

    var list = $('<dl/>');
    target.empty().append(list);
    $(repos).each(function() {
      list.append('<dt><a href="'+ this.url +'">' + this.name + '</a></dt>');
      list.append('<dd>' + this.description + '</dd>');
    });
  });

  function sortByNumberOfWatchers(repos) {
    repos.sort(function(a,b) {
      return b.watchers - a.watchers;
    });
  }
}; 
```

@jcolebrand：感谢您的帮助，但我并没有真正理解您的意思。我也尝试向 Chrome 的控制台发送一些命令。我猜`$`是 jQuery 的别名，不是吗？好吧，发送相同的东西控制台只输出多个对象，描述我的回购。惊人的！
我认为现在的问题是正确解析它们并显示它们。哎呀，我需要为此学习JavaScipt语法......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-12T15:34:00.453

您发布的脚本不起作用，因为 URL 用于较旧的 API。将 URL 更改为此，它应该适合您。

```
https://api.github.com/users/YOUR_USERNAME_HERE/repos?callback=CALLBACK 
```

注意：`callback=<YOUR_CALLBACK>`是可选的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T17:00:48.940

[http://developer.github.com/v3/](http://developer.github.com/v3/)非常明确地说明了如何做到这一点。事实上，因为我在那里和这里的用户名是一样的，让我给你看。

我在 github 上打开了我的 repo 页面，[https://github.com/jcolebrand](https://github.com/jcolebrand)（到目前为止这很明显）并在 Chrome 中按 F12。

我询问是否确实安装了 jQuery，因为我在做示例时喜欢快捷方式。

然后我完全从 API 页面进行了测试`$.getJSON('//api.github.com/users/jcolebrand/repos',{},function(data){console.log(data)})`，正如它所说，你瞧，我被授予了我自己看到的五个 repos。

以下是我没有做的事情：我没有获得 API 密钥，我没有通过 API 工作，并且我使用了我现有的凭据。记住这些事情，但这就是如何改进它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T01:15:57.113

您也可以使用 github API 库。这个库是我最喜欢的[https://github.com/michael/github](https://github.com/michael/github)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-06T12:22:52.590

`JQuery`使用 , 的快捷方式扩展到 @JColebrand 的答案`XMLHttpRequest`，`$.getJson()`这是一个在 2020 年有效的 API 调用。

```
 user = 'tik9'
        apirepo = `https://api.github.com/users/${user}`

   listrepos = document.createElement('ul')
        document.getElementById('github').appendChild(listrepos)
        $.getJSON(apirepo + '/repos', function (data) {
            console.log('data now', data)

            function compare(a, b) {
                if (a.watchers > b.watchers) {
                    return -1
                }
                if (a.watchers < b.watchers) {
                    return 1
                }
                return 0
            }

            data.sort(compare)
            data.forEach(v => {

                listItemRepo = document.createElement('li')
                listrepos.appendChild(listItemRepo)
                hlink = document.createElement('a')
                listItemRepo.appendChild(hlink)
                hlink.textContent = `${v.description} | Stars: ${v.watchers}`
                hlink.href = v.html_url
            })
        })
```

```
<html>
<head>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>

<h4><span id=repocount></span> Github Repositories</h4>
        <div id=github></div>
```

# css - 从纵向到横向断点的响应式站点上的 iOS 缩放问题

> ID：11850534
> 
> 赞同：1
> 
> 时间：2012-08-07T16:47:54.350
> 
> 标签：css, responsive-design, media-queries

因此，在我的 iOS 设备上从纵向模式切换到横向模式时，我的响应式网站出现了一个奇怪的问题。您可以在这里查看实时站点：http: [//www.aptify.com](http://www.aptify.com)

如果您以纵向模式查看站点，请旋转放大的 iOS 设备。

我目前有以下元：

`<meta name="viewport" content="width=device-width; initial-scale=1.0" />`

我发现了一个与此类似的问题：[Media Queries - Landscape Mode on iPhone way too oversized](https://stackoverflow.com/questions/6521830/media-queries-landscape-mode-on-iphone-way-too-oversized)，但是这个问题从未得到正确答案。唯一的答案确实提到了使用类似于我上面的标签的东西，但它只是：`<meta name="viewport" content="width=device-width" />`没有`initial-scale=1.0`- 这有什么不同吗？

我还想指出，这不会发生在 android 设备上，只有 iOS 设备。

有没有人以前解决过这个问题？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T05:25:00.843

我在笔记中包含了一个链接来帮助解决这种情况。另一种解决方法是使用[Jeremy Keith 的“Orientation and scale”文章](http://adactio.com/journal/4470/)中概述的代码。

```
<script type="text/javascript">
var metas = document.getElementsByTagName('meta');
var i;
if (navigator.userAgent.match(/iPhone/i)) {
  for (i=0; i<metas.length; i++) {
    if (metas[i].name == "viewport") {
      metas[i].content = "width=device-width, minimum-scale=1.0, maximum-scale=1.0";
    }
  }
  document.addEventListener("gesturestart", gestureStart, false);
}
function gestureStart() {
  for (i=0; i<metas.length; i++) {
    if (metas[i].name == "viewport") {
      metas[i].content = "width=device-width, minimum-scale=0.25, maximum-scale=1.6";
    }
  }
}
</script> 
```

如果您想忽略您的用户权限并且不允许他们放大他们的设备，您还可以将元视口设置为以下内容，这将解决问题

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

# php - 插入 mysql 表时，多个选项注册不正确

> ID：11850535
> 
> 赞同：0
> 
> 时间：2012-08-07T16:48:04.727
> 
> 标签：php, html, jsfiddle

我有 2 个下拉菜单形式“类别”和“子类别”。在“类别”中，我有音乐和电影选项，在子类别中，我有“流行”和“摇滚”(f1) 选项，在电影“喜剧”和“戏剧”(f2) 中有选项。问题是，使用代码，我的电影子类别应注册如下（cat，subcat）：film-drama=2,5 和 film-comedy=2,6 但是在输入时它们都注册为 2,0 mysql表。这是代码：

```
 <form action='submitsite.php' method='POST'>
 <table>
 <tr>
 <td>category(optional)</td>
 <td><select name='cat' id = "opts" onchange = "showForm()">
 <option value = "0">Select</option>
 <option value = "1">music </option>
 <option value = "2">film </option>
 </select> 

 <div id = "f1" style="display:none">
 <form name= "subcat">
 <select name='subcat' id = "opts" onchange = "showForm()">
 <option value = "0">Select</option>
 <option value = "3">pop</option>
 <option value = "4">rock </option>
 </select>
 </form>
 </div>

 <div id = "f2" style="display:none">
 <form name= "subcat">
 <select name='subcat' id = "opts" onchange = "showForm()">
 <option value = "0">Select</option>
 <option value = "5">comedy</option>
 <option value = "6">drama</option>
 </select>
 </form>
 </div>

 <script type = "text/javascript">
 function showForm()
{
 var selopt = document.getElementById("opts").value;
 if (selopt == 1) 
{
  document.getElementById("f1").style.display="block";
  document.getElementById("f2").style.display="none";
}
 if (selopt == 2) 
{
  document.getElementById("f2").style.display="block";
  document.getElementById("f1").style.display="none";
} 
```

}

这是变量声明和mysql查询：

```
$cat=$_POST['cat'];
$subcat=$_POST['subcat'];

$sql="INSERT INTO favorites VALUES('$cat','$subcat')"; 
```

这不是 mysql 问题，我只是添加了该部分以提供更好的整体情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:15:10.757

HTML 中不能有嵌套表单。标记无效，我猜您在提交时会遇到意外行为。解决方案是使用单一表格。有不止一种方法可以做到这一点，但这里有一个例子：

HTML 代码：

```
<form action='submitsite.php' method='POST'>
<table>
<tr>
<td>category(optional)</td>
<td><select name='cat' id = "opts" onchange = "showForm()">
<option value = "0">Select</option>
<option value = "1">music </option>
<option value = "2">film </option>
</select> 

<div id = "f1" style="display:none">
<select name='subcat1' id = "opts" onchange = "showForm()">
<option value = "0">Select</option>
<option value = "3">pop</option>
<option value = "4">rock </option>
</select>
</div>

<div id = "f2" style="display:none">
<select name='subcat2' id = "opts" onchange = "showForm()">
<option value = "0">Select</option>
<option value = "5">comedy</option>
<option value = "6">drama</option>
</select>
</div>
</form>
.... 
```

PHP代码：

```
$cat = $_POST['cat'];
$subcat = $_POST['subcat' . $cat]; 
```

请记住，在进一步使用之前，必须验证所有用户提交的值。在这种情况下，您将检查`is_numeric()`，检查它是否在您接受的值范围内，并可能转换为`int`.

# java - Android、Proguard 和 XmlPullParser：NoSuchMethodError

> ID：11850536
> 
> 赞同：0
> 
> 时间：2012-08-07T16:48:12.093
> 
> 标签：java, android, proguard, xmlpullparser

我正在使用 XmlPullParser ，当应用程序通过`Proguard`，并且 apk 在设备上运行时，它给了我以下错误：

```
08-06 17:10:26.717: E/AndroidRuntime(2527):
   Caused by: java.lang.NoSuchMethodError: org.xmlpull.v1.XmlPullParser.d 
```

我已`-ignorewarnings`在我的 proguard.cfg 中添加，否则无法通过`Proguard`.

这是我的[proguard.cfg](http://pastebin.com/8mj5WUaR)文件的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:16:43.153

你混淆了你不应该有的方法。您需要保持拉解析器代码完整。添加：

```
-keep public class org.xmlpull.** 
```

到您的 proguard.cfg 文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:19:58.207

你在你的 proguard 配置文件中想要的是 -keep 而不是 -ignorewarnings

```
-keep class org.xmlpull.** { *; } 
```

有关更多详细信息，请参阅以下网址

[http://android-developers.blogspot.com/2010/09/proguard-android-and-licensing-server.html](http://android-developers.blogspot.com/2010/09/proguard-android-and-licensing-server.html)

> **但是等等，我的应用程序现在崩溃了**
> 
> > 大多数崩溃的发生是因为 Proguard 混淆了您的应用程序需要的东西，例如在 AndroidManifest 或布局中引用的类，或者可能从 JNI 或反射调用的东西。此处提供的 Proguard 配置试图避免混淆大多数这些情况，但在边缘情况下，您最终可能会看到 ClassNotFoundException 之类的东西。
> 
> 您可以对 procfg.txt 文件进行编辑以保留已被混淆的类。添加：
> 
> ```
> -keep public class * [my classname] 
> ```
> 
> 应该有帮助。有关如何防止 Proguard 混淆特定事物的更多信息，请参阅 Proguard 手册。具体来说，保留部分。为了安全起见，请尽量使您的应用程序保持尽可能少的内容。
> 
> procfg.txt 中提供的标准设置适用于许多应用程序，并且会捕获许多常见情况，但它们绝不是全面的。我们所做的其中一件事是让 Proguard 在 obf 目录中创建一堆输出文件来帮助您调试这些问题。
> 
> mapping.txt 文件解释了你的类是如何被混淆的。将构建提交到 Market 后，您需要确保保留它，因为您将需要它来破译您的堆栈跟踪。

# sql-server - 在 SQL Server 中插入新列和丢失的数据

> ID：11850546
> 
> 赞同：0
> 
> 时间：2012-08-07T16:48:48.277
> 
> 标签：sql-server, visual-studio-2010

要向表中添加新列，我在 Visual Studio 2010 的服务器资源管理器中双击表的名称，然后右键单击以插入新列。但问题是，在我运行与数据库连接的应用程序后，新列就消失了。

关闭 Visual Studio 后，添加到数据库的所有新数据都消失了。但是当我使用应用程序时，数据在数据库中，因为我可以加载并查看我刚刚添加的新数据。剩下的唯一数据是我在 Visual Studio 中创建数据库和表时添加的数据。

我正在使用 mdf 文件。我检查了 mdf 文件是否在 Bin/Debug 中。奇怪的一件事是服务器资源管理器.mdf 和.mdf1 中有两个.mdf 数据库。这是我试图改变的最后一个。

有什么问题？感谢您的帮助！我需要尽快把这个任务交给我的老师。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T16:56:31.980

尝试使用 T-sql：

```
Alter table table1 add col1 datatype. 
```

然后尝试向其中插入数据：

```
INSERT INTO table1(col1,col2...)
VALUES(v1,v2...) 
```

然后你尝试测试。

# php - PHP 联系表单在所有字段中提交 1

> ID：11850549
> 
> 赞同：1
> 
> 时间：2012-08-07T16:48:54.557
> 
> 标签：php, forms, contact

我最近为我的一个自由客户开发了一个网站，在他们的网站中有一个联系表和一个估价请求表。

每天一次，两种表格都被提交并通过电子邮件发送到指定的电子邮件地址。但是，提交的表单显然不是来自真实用户，这是因为所有字段都包含数字 1。例如，名称字段将是名称：1，地址字段将是地址：1。对于所有输入文本字段，甚至单选框和复选框表单字段，都会重复数字 1。

下面是我用来提交估算表单请求的 PHP 文件的副本。

```
<?
$subject="Associated Sennott Contractors Request For Estimate From:".$_GET['firstname'];
$headers= "From: ".$_GET['email']."\n";
$headers.='Content-type: text/html; charset=iso-8859-1';
mail("email@gmail.com", $subject,  "
    <html>
        <head>
            <title>Associated Sennott Contractors Request For Estimate</title>
    </head>
<body>
    <p><strong>Associated Sennott Contractors Request For Estimate</strong></p>
    <p>
        First Name: ".$_GET['firstname']." <br />
        Last Name: ".$_GET['lastname']." <br />
        Company Name: ".$_GET['company']." <br />
        Address 1: ".$_GET['address1']." <br />
        Address 2: ".$_GET['address2']." <br />
        City: ".$_GET['city']." <br />
        State: ".$_GET['state']." <br />
        Zip: ".$_GET['zip']." <br />
        Phone: ".$_GET['phone']." <br />
        Fax: ".$_GET['fax']." <br />
        Email: ".$_GET['email']." <br /><br />

        <strong>Property Type:</strong><br />
        Residential Single Family: ".$_GET['singlefamily']." <br />
        Residential Multi-Family: ".$_GET['multifamily']." <br />
        Residential Out-Building : ".$_GET['outbuilding']." <br />
        Commercial Office: ".$_GET['commercial']." <br />
        Retail Store: ".$_GET['retail']." <br />
        Restaurant: ".$_GET['restaurant']." <br />
        Industrial Building: ".$_GET['industrial']." <br /><br />

        <strong>Requested Services:</strong><br />
        Fire, Water or Wind Damage Restoration: ".$_GET['restoration']." <br />
        Scope of Loss Estimate to Insurance Company: ".$_GET['scope']." <br />
        Smoke Odor Remediation: ".$_GET['smoke']." <br />
        Exterior Remodeling or Siding: ".$_GET['exterior']." <br />
        Interior Remodeling: ".$_GET['interior']." <br />
        Hardwood and Laminate Flooring: ".$_GET['flooring']." <br />
        Finish Carpentry: ".$_GET['carpentry']." <br />
        Demolition and Debris Removal: ".$_GET['demo']." <br />
        Exterior Decks, Patios and Fencing: ".$_GET['patio']." <br />
        Other: ".$_GET['other']." <br /><br />

        <strong>Additional Information:</strong><br />
        Message: ".$_GET['info']."
    </p>  
</body>
</html>" , $headers);
header( 'Location: thankyou.html' ) ;
?> 
```

您还可以通过以下链接查看 PHP 代码：http: [//sennottcontractors.com/home-repair-estimate/quote-code.html](http://sennottcontractors.com/home-repair-estimate/quote-code.html)

然后，您可以查看下面实际表单的 HTML 代码：

```
<!DOCTYPE>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Request An Estimate Form</title>
<script type="text/javascript">
function formSubmit()
{
document.getElementById("estimate-form").submit();
}
</script>

</head>
<body>
<fieldset>
<legend><h3>Request a Home Restoration Estimate</h3></legend>
    <form id="estimate-form" name="estimate-form" target="_parent" method="get" action="quote.php" onsubmit='return formValidator()'>
        <p><strong>Contact Information</strong></p>
            <p>First Name: *<br />
            <input type="text" size="40" name="firstname" id="firstname" /></p>
            <p>Last Name: *<br />
            <input type="text" size="40" name="lastname" id="lastname" /></p>
            <p>Company Name:<br />
            <input type="text" size="40" name="company" id="company" /></p>
            <p>Address 1: *<br />
            <input type="text" size="40" name="address1" id="address1" /></p>
            <p>Address 2:<br />
            <input type="text" size="40" name="address2" id="address2" /></p>
            <p>City: *<br />
            <input type="text" size="30" name="city" id="city" /></p>
            <p>State: *<br />
            <input type="text" size="5" name="state" id="state" /></p>
            <p>Zip: *<br />
            <input type="text" size="10" name="zip" id="zip" /></p>
            <p>Phone: *<br />
            <input type="text" size="20" name="phone" id="phone" /></p>
            <p>Fax:<br />
            <input type="text" size="20" name="fax" id="fax" /></p>
            <p>Email: *<br />
            <input type="text" size="40" name="email" id="email" /></p>
        <br />
        <p><strong>Property Type</strong> *</p>
            <p><input type="checkbox" name="singlefamily" id="singlefamily"/> Residential Single Family</p>
            <p><input type="checkbox" name="multifamily" id="multifamily"/> Residential Multi-Family <em>(Condominium, apartment, town house, ect)</em></p>
            <p><input type="checkbox" name="outbuilding" id="outbuilding"/> Residential Out-Building <em>(Garage, shed, ect)</em></p>
            <p><input type="checkbox" name="commercial" id="commercial"/> Commercial Office</p>
            <p><input type="checkbox" name="retail" id="retail"/> Retail Store</p>
            <p><input type="checkbox" name="restaurant" id="restaurant"/> Restaurant</p>
            <p><input type="checkbox" name="industrial" id="industrial"/> Industrial Building</p>
        <br />
        <p><strong>Requested Services</strong> *</p>
            <p><input type="checkbox" name="restoration" id="restoration"/> Fire, Water or Wind Damage Restoration</p>
            <p><input type="checkbox" name="scope" id="scope"/> Scope of Loss Estimate to Insurance Company</p>
            <p><input type="checkbox" name="smoke" id="smoke"/> Smoke Odor Remediation</p>
            <p><input type="checkbox" name="exterior" id="exterior"/> Exterior Remodeling or Siding</p>
            <p><input type="checkbox" name="interior" id="interior"/> Interior Remodeling</p>
            <p><input type="checkbox" name="flooring" id="flooring"/> Hardwood and Laminate Flooring</p>
            <p><input type="checkbox" name="carpentry" id="carpentry"/> Finish Carpentry</p>
            <p><input type="checkbox" name="demo" id="demo"/> Demolition and Debris Removal</p>
            <p><input type="checkbox" name="patio" id="patio"/> Exterior Decks, Patios and Fencing</p>
            <p><input type="checkbox" name="other" id="other"/> Other</p>
        <br />
    <p><strong>Additional Information</strong><br />
    Please provide any information regarding details of your home restoration project or additional information to your requested services.</p>
    <p><textarea rows="10" cols="65" id="info" name="info"></textarea></p>
    <button type="submit" id="submit" onclick="formSubmit()">Submit</button>
    </form>
    <p>* Required Fields</p>
</fieldset>
</body>
</html> 
```

使用上述 PHP 文件和代码的 Request an Estimate 表单，您可以通过以下链接查看：http: [//sennottcontractors.com/home-repair-estimate/index.html](http://sennottcontractors.com/home-repair-estimate/index.html)

同样，“请求估算表”和“联系表”每天都提交一次，每个表单字段中的数字为 1。

我的猜测是，这可能是 PHP 文件本身的问题，也可能是托管网站的服务器端的问题。

请帮忙！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:01:18.377

这个问题的一部分是您需要使用表单随机数或“令牌”。

表单.php

```
<?php
session_start();

$_SESSION['token'] = md5(mt_rand() . unique_id('form', TRUE));

...

?>
<form>
<input type="hidden" value="<?php print $_SESSION['token']; ">
...
</form> 
```

进程.php

```
<?php
session_start();

if($_SESSION['token'] !== $_POST['token'])
{
    die('They did not load the form!');
}

...

(validation)

...

$db->insert($record); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:52:40.120

您的表格在技术上没有任何问题。您自己说了问题的原因：“......提交的表单显然不是来自真实用户......”。所以解决方案是让你的表单反机器人。请参阅专业网站管理员网站上的这个问题，了解如何做到这一点：[让您的网站反机器人？](https://webmasters.stackexchange.com/questions/3544/make-your-site-anti-bot)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T16:53:58.890

你没有做任何验证。你能指望什么？

任何人都可以抓取表单字段，创建 URL（因为您使用的是 GET 而不是 POST），然后如果他们愿意就提交它。您可能遇到的是一个机器人，它试图弄清楚它是否可以劫持您的表单以将电子邮件发送到它想要发送的位置。

您应该做的是切换到使用 POST 并检查`$_SERVER['HTTP_REFERER']`变量以确保它来自您的表单（至少）。您也可以使用 CAPTCHA，但这些变得越来越不可靠。您可以更进一步，使用验证类为每个字段设置规则以及每个字段中允许包含哪些类型的数据。

表单很容易操作，因此如果您希望表单提交具有任何完整性，您应该在服务器端进行验证。客户端验证并没有什么坏处，只是将其用于用户体验目的，而不是确保数据完整性。

# android - 无法在我的 Mac 上找到 keytool 来签署我的 apk 文件

> ID：11850556
> 
> 赞同：1
> 
> 时间：2012-08-07T16:49:48.110
> 
> 标签：android, macos, keytool

我已经使用 phonegap Build 创建了我的 .apk 文件，我正在尝试对其进行签名。

我知道我可以使用以下命令执行此操作：

```
$ keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -validity 10000 
```

但是当我在终端中运行它时，我得到'找不到命令'？

我在mac上运行它，所以从我读过的内容来看，我已经安装了所需的JDK（我有xcode）我想可能是PATH没有正确设置为keytool，但我找不到任何简单的有关重置此的信息。

任何帮助将不胜感激。我一定错过了一些非常简单的东西，因为签署应用程序不可能这么难？！？！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-02-06T20:37:17.857

这对我来说是一场噩梦，这样一个看似简单的任务却花费了太多时间。

在 Mac 上找到 Keytool

首先在命令提示符中输入：

`/usr/libexec/java_home -v 1.7`

它会吐出类似的东西：

```
/Library/Java/JavaVirtualMachines/jdk1.7.0_51.jdk/Contents/Home 
```

keytool 与`javac`. IE：

```
/Library/Java/JavaVirtualMachines/jdk1.7.0_51.jdk/Contents/Home/bin 
```

从 bin 目录中，您可以使用 keytool。

我通常使用`APK`工具`Eclipse`来签署密钥，但我过去生成了指纹并且没有记录它。我需要 keytool 来告诉我那个值......

希望这对其他人有帮助

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-02-18T00:15:02.890

`'./'`只是我必须在 keytool 位置的前面添加一个注释。

钥匙工具位置

```
/Applications/Android Studio.app/Contents/jre/jdk/Contents/Home/bin/keytool 
```

命令运行

```
./keytool -genkey -v -keystore ~/key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias key 
```

希望对某人有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T16:56:20.513

确保您已`cd`进入 android-sdk/platform-tools 目录（keytool [最有可能] 所在的目录）。如果您不在包含 keytool 的目录中，则不会找到该命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T04:48:33.740

`keytool`附带 Java 开发工具包 (JDK)。因此，查找包含 javac、java 的目录，您会发现那里存在 keytool。您可以直接从该目录运行它或设置 PATH。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-12T15:12:56.977

在 Mac 上运行时，我遇到了同样的错误。
删除“$”对我有用，然后提示输入详细信息以创建密钥库。

然后我很难找到密钥库，因为我认为它会在我的用户帐户下的*.android*中，但它实际上是直接保存到我的用户帐户 [cd users/YourUserName]

希望对遇到同样问题的人有所帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-30T09:39:29.457

如果您安装了 Android Studio，keytool 的新位置是

```
/Applications/Android\ Studio.app/Contents/jre/Contents/Home/bin/ 
```

# linux - 在 Linux 上使用 libpcap 的最有效方法

> ID：11850558
> 
> 赞同：3
> 
> 时间：2012-08-07T16:50:00.670
> 
> 标签：linux, libpcap

我有一个在 Linux (2.6.38.8) 上运行的应用程序，使用 libpcap (>1.0) 捕获通过以太网传输的数据包。我的应用程序使用了接近 100% 的 CPU，我不确定我是否尽可能高效地使用 libpcap。

我正在努力寻找 pcap 可调参数和性能之间的任何关联。

这是我的简化代码（错误检查等省略）：

```
// init libpcap
pcap_t *p = pcap_create("eth0", my_errbuf);
pcap_set_snaplen(p, 65535);
pcap_set_promisc(p, 0);
pcap_set_timeout(p, 1000);
pcap_set_buffer_size(p, 16<<20); // 16MB
pcap_activate(p);

// filter
struct bpf_program filter;
pcap_compile(p, &filter, "ether dst 00:11:22:33:44:55", 0, 0);
pcap_setfilter(p, &filter);

// do work
while (1) {
    int ret = pcap_dispatch(p, -1, my_callback, (unsigned char *) my_args);
    if (ret <= 0) {
        if (ret == -1) {
            printf("pcap_dispatch error: %s\n", pcap_geterr(p));
        } else if (ret == -2) {
            printf("pcap_dispatch broken loop\n");
        } else if (ret == 0) {
            printf("pcap_dispatch zero packets read\n");
        } else {
            printf("pcap_dispatch returned unexpectedly");
        }
    } else if (ret > 1) {
        printf("processed %d packets\n", ret);
    }
} 
```

使用 1000 毫秒超时和 2M、4M 和 16M 缓冲区大小时的结果在高数据速率（~200 1kB 数据包/秒）下是相同的：pcap_dispatch 始终返回 2。根据 pcap_dispatch 手册页，我希望pcap_dispatch 在缓冲区已满或超时到期时返回。但是返回值为 2 时，这两个条件都不应该满足，因为只读取了 2kB 的数据，并且只经过了 2/200 秒。

如果我降低数据速率（约 100 个 1kB 数据包/秒），pcap_dispatch 会返回 2 到 7，因此将数据速率减半会影响每个 pcap_dispatch 处理的数据包数量。（我认为数据包越多越好，因为这意味着操作系统和用户空间之间的上下文切换更少——这是真的吗？）

超时值似乎也没有什么区别。

在所有情况下，我的 CPU 使用率都接近 100%。

我开始怀疑我是否应该尝试使用 PF_RING 版本的 libpcap，但从我在 SO 和 libpcap 邮件列表中阅读的内容来看，libpcap > 1.0 无论如何都会执行零拷贝，所以可能没有意义。

任何想法，指针非常感谢！G

# mysql - MySQL：从函数调用过程

> ID：11850561
> 
> 赞同：2
> 
> 时间：2012-08-07T16:50:16.717
> 
> 标签：mysql

是否可以从 MySQL 中的函数调用过程？我收到错误“不允许从函数返回结果集”。我希望将过程调用的结果插入到函数变量中，就像我直接在函数中执行 SELECT INTO 一样。

该函数（简化）定义为

```
create function my_function()
   returns int deterministic
   begin
     declare some_parameter int;
     declare the_result int;

     call my_procedure(some_parameter, the_result)

     return the_result;

   end; 
```

该过程（简化）定义为：

```
create procedure my_procedure(in my_parameter int, out my_result int)
    begin
        select 1 
        from dual;
   end; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:07:14.667

本质上，没有。函数正在寻找数据类型，而不是记录（这是从过程返回的内容）。

# abap - ABAP VA02 用户退出以阻止最终用户从销售订单中删除行项目

> ID：11850563
> 
> 赞同：0
> 
> 时间：2012-08-07T16:50:28.970
> 
> 标签：abap

我已修改用户出口“MV45AFZB”FORM“userexit_check_xvbap_for_delet”，以防止用户从 t-code VA02 中的销售订单中删除行项目。但是，如果他们双击该行项目并进入计划行。他们被允许删除行项目。我需要编写什么 FORM 或其他用户出口才能阻止这种情况发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T12:54:16.813

如果用户删除了订单项，您可以在 USEREXIT_SAVE_DOCUMENT_PREPARE 中放置一些代码来阻止用户保存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T20:49:41.850

USEREXIT_CHECK_XVBEP_FOR_DELET 也是添加附加代码的表单。它将阻止用户从计划的行中删除行项目。

[http://scn.sap.com/thread/756922](http://scn.sap.com/thread/756922)

# c# - 将 .db 转换为二进制

> ID：11850564
> 
> 赞同：0
> 
> 时间：2012-08-07T16:50:39.913
> 
> 标签：c#

我正在尝试将 .db 文件转换为二进制文件，以便可以将其流式传输到 Web 服务器。我对 C# 很陌生。我已经在网上查看了代码片段，但我不确定下面的代码是否让我走上了正确的轨道。读取数据后如何写入数据？是否会`BinaryReader`自动打开并读取整个文件，以便我可以将其以二进制格式写出来？

```
class Program
{
    static void Main(string[] args)
    {
        using (FileStream fs = new FileStream("output.bin", FileMode.Create))
        {
            using (BinaryWriter bw = new BinaryWriter(fs))
            {
                long totalBytes = new System.IO.FileInfo("input.db").Length;
                byte[] buffer = null;

                BinaryReader binReader = new BinaryReader(File.Open("input.db", FileMode.Open)); 
            }
        }
    }
} 
```

编辑：流式传输数据库的代码：

```
[WebGet(UriTemplate = "GetDatabase/{databaseName}")]
public Stream GetDatabase(string databaseName)
{
    string fileName = "\\\\computer\\" + databaseName + ".db";

    if (File.Exists(fileName))
    {
        FileStream stream = File.OpenRead(fileName);

        if (WebOperationContext.Current != null)
        {
            WebOperationContext.Current.OutgoingResponse.ContentType = "binary/.bin";
        }

        return stream;
    }

    return null;
} 
```

当我打电话给我的服务器时，我什么也得不到。当我对图像/.png 的内容类型使用相同类型的方法时，它可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:55:02.350

您发布的所有代码实际上都会将文件 input.db 复制*到*文件*output.bin*。您可以使用 File.Copy 完成相同的操作。

BinaryReader 只会读入文件的所有字节。将字节流式传输到需要二进制数据的输出流是一个合适的开始。

一旦有了与文件相对应的字节，就可以将它们写入 Web 服务器的响应，如下所示：

```
using (BinaryReader binReader = new BinaryReader(File.Open("input.db", 
                                                 FileMode.Open))) 
{
    byte[] bytes = binReader.ReadBytes(int.MaxValue); // See note below
    Response.BinaryWrite(bytes);
    Response.Flush();
    Response.Close();
    Response.End();
} 
```

注意：代码*binReader.ReadBytes(int.MaxValue)*仅用于演示概念。不要在生产代码中使用它，因为加载大文件会很快导致 OutOfMemoryException。相反，您应该以块的形式读取文件，以块的形式写入响应流。

有关如何执行此操作的指导，请参阅此答案

[https://stackoverflow.com/a/8613300/141172](https://stackoverflow.com/a/8613300/141172)

# php - 如何在函数中使用数组来获取我想要的值

> ID：11850573
> 
> 赞同：0
> 
> 时间：2012-08-07T16:51:13.953
> 
> 标签：php, arrays, function

我正在尝试在 wordpress 主题中使用此功能，以便我只能获得我想要的价值而不是全部收集的价值。我对在函数中使用数组不太熟悉，因此我需要您的专家帮助才能使其正常工作，我将非常感激。

这是我的代码

```
function gallery_artist($arg=null, $arg2=null, $arg3=null){

    global $png_gallery_meta;
    $png_gallery_meta->the_meta();

    $gallery = get_post_meta(get_the_ID(), $png_gallery_meta->get_the_id(), TRUE);

    $gallery_value = $gallery['image_artist'];
    $artist_info = $gallery_value;

    $string = $artist_info;
    $artist = substr($string, 0, stripos($string, "/") );

    // getting first name and last name from user id
    $author_first_name = get_userdata(basename($string))->first_name;

    $author_last_name = get_userdata(basename($string))->last_name;

    $author_full_name = $author_first_name . ' ' . $author_last_name;

    $user_id = '<a href=" ' . get_author_posts_url(basename($string)) . ' " title="more submissions of ' . $author_first_name .' '. $author_last_name . ' " >' . $artist . '</a>';

    $arg = $author_first_name;      
    echo $arg;

    $arg2 = $author_last_name;      
    echo $arg2;

    $arg3 = $user_id;
    echo $arg3;     

} 
```

之后我想使用这个函数来获得我想要的任何值，而不是不必要地渲染所有三个来收集。意味着如果我只想要名字而不是只为此传递值，它将只呈现名字等等..

这里我想如何使用一些东西。但你可以建议任何代码和函数类型我没有问题。

```
<?php call_user_func_array('gallery_artist', array('first_name','last_name','artist_id') ) ?> 
```

大大大大谢谢大家..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:09:37.920

尝试用这个替换底部：

```
if(!is_null($arg))
{
    $arg = $author_first_name;      
    echo $arg;
}

if(!is_null($arg2))
{
    $arg2 = $author_last_name;      
    echo $arg2;
}

if(!is_null($arg3))
{
    $arg3 = $user_id;
    echo $arg3;
} 
```

# python - Python，解压 .jar 文件，不起作用

> ID：11850574
> 
> 赞同：2
> 
> 时间：2012-08-07T16:51:21.247
> 
> 标签：python, jar, unzip

因此，我正在尝试`.jar`使用以下代码解压缩文件：它不会解压缩，只有 20 / 500 个文件，并且没有文件夹/图片当我`.zip`在文件名中输入文件时，也会发生同样的事情。有人有什么建议吗？

```
import zipfile
zfilename = "PhotoVieuwer.jar"
if zipfile.is_zipfile(zfilename):
    print "%s is a valid zip file" % zfilename
else:
    print "%s is not a valid zip file" % zfilename
print '-'*40

zfile = zipfile.ZipFile( zfilename, "r" )

zfile.printdir()
print '-'*40

for info in zfile.infolist():
    fname = info.filename

    data = zfile.read(fname)

    if fname.endswith(".txt"):
        print "These are the contents of %s:" % fname
        print data

    filename = fname
    fout = open(filename, "w")
    fout.write(data)
    fout.close()
    print "New file created --> %s" % filename
    print '-'*40 
```

但是，它不起作用，它可能会解压缩 500 个文件中的 10 个文件有人可以帮我解决这个问题吗？

已经谢谢了！

我尝试添加 Python 告诉我的内容，我得到了：哎呀！您的修改无法提交，因为：

正文限制为**30000 个**字符；您输入**了 153562** ，只有错误是：

```
Traceback (most recent call last):
  File "C:\Python27\uc\TeStINGGFDSqAEZ.py", line 26, in <module>
    fout = open(filename, "w")
IOError: [Errno 2] No such file or directory: 'net/minecraft/client/ClientBrandRetriever.class' 
```

解压出来的文件：

```
amw.Class
amx.Class
amz.Class
ana.Class
ane.Class
anf.Class
ang.Class
ank.Class
anm.Class
ann.Class
ano.Class
anq.Class
anr.Class
anx.Class
any.Class
anz.Class
aob.Class
aoc.Class
aod.Class
aoe.Class 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:32:57.040

此回溯告诉您需要了解的内容：

```
Traceback (most recent call last):
  File "C:\Python27\uc\TeStINGGFDSqAEZ.py", line 26, in <module>
    fout = open(filename, "w")
IOError: [Errno 2] No such file or directory: 'net/minecraft/client/ClientBrandRetriever.class' 
```

错误消息说文件`ClientBrandRetriever.class`不存在或目录`net/minecraft/client`不存在。当打开一个文件用于编写 Python 时，它会创建它，所以文件不存在不会是问题。必须是目录不存在的情况。

考虑到这行得通

```
>>> open('temp.txt', 'w') 
<open file 'temp.txt', mode 'w' at 0x015FF0D0> 
```

但这并没有，给你得到的几乎相同的回溯：

```
>>> open('bogus/temp.txt', 'w')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IOError: [Errno 2] No such file or directory: 'bogus/temp.txt' 
```

创建目录修复它：

```
>>> os.makedirs('bogus')
>>> open('bogus/temp.txt', 'w')
<open file 'bogus/temp.txt', mode 'w' at 0x01625D30> 
```

在打开文件之前，您应该检查目录是否存在并在必要时创建它。

所以要解决你的问题，更换这个

```
fout = open(filename, 'w') 
```

有了这个

```
head, tail = os.path.split(filename) # isolate directory name
if not os.path.exists(head):         # see if it exists
    os.makedirs(head)                # if not, create it
fout = open(filename, 'w') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:36:00.883

如果`python -mzipfile -e PhotoVieuwer.jar dest`有效，那么您可以：

```
import zipfile

with zipfile.ZipFile("PhotoVieuwer.jar") as z:
    z.extractall() 
```

# visual-studio-2010 - 创建具有多个文件夹和文件的 Visual Studio 2010 项目模板

> ID：11850576
> 
> 赞同：1
> 
> 时间：2012-08-07T16:51:23.307
> 
> 标签：visual-studio-2010, itemtemplate, visual-studio-sdk

过去几天我一直在阅读这方面的信息，虽然我取得了一些进展，但我还是有点迷茫。

我创建了一个类、文件和文件夹的集合，我想将它们组合在一起作为 Visual Studio 项模板。

把它想象成一个“模块”。

这个想法是他们添加这个“模块项模板”，Visual Studio 将插入文件夹和文件并相应地重命名它们。

这不是项目模板，而是项目模板，因为它需要添加到他们正在处理的现有项目中，在该项目中（而不是作为单独的项目）。

通过使用 Visual Studio 2010 SP1 SDK 项目模板模板，我几乎得到了它。

问题是当我使用 $safeitemname$ 时，我在每个类中得到不同的名称。

我希望当他们添加项目并将其命名为“MyModule”时，$safeitemname$ 的值将是“MyModule”。

这没有发生。相反，每个生成的类文件都会获得与生成的文件名匹配的 $s​​afeitemname$ 的不同值。

因此，例如，如果我有一个 MyModuleConfig.cs 类，并且我有另一个像这样的类文件设置：

```
public class $safeitemname$Config
{
} 
```

而不是获取用户输入“MyModule”和配置的项目名称，该类被命名为“MyModuleConfigConfig”。

如何告诉它仅使用用户在使用模板在“添加项目”对话框中创建模块时输入的原始名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T16:53:20.107

好吧，在发布此消息几秒钟后，我发现我应该改用 $fileinputname$ ！

这似乎正是我想要的，谢谢，自我！

# java - 使用 Linkedin Rest API 的 Jackson 对象映射方法

> ID：11850580
> 
> 赞同：0
> 
> 时间：2012-08-07T16:51:47.567
> 
> 标签：java, jackson, linkedin

在处理 Linkedin Rest API 时，很多字段的格式如下：

```
"positions":
{
  "_total": 1,
  "values": [{"title": "Software Developer"}]
} 
```

代替：

```
"positions":
{
  [{"title": "Software Developer"}] 
} 
```

当我尝试将 json 映射到 Position 对象时，这会导致很多麻烦。我正在使用 Java 和 Jackson 来解析 JSON 响应。有没有办法设置对象映射器，使其自动忽略“_total”和“values”字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T02:51:34.723

显然@kpentchev 为这个问题提供了一个可行的解决方案，但我个人倾向于尽可能避免手动解析器。在这种情况下，我最终编写了一种包装类来映射原始 json：

```
public class PositionWrapper
{
  private Long _total;
  private List<Position> values;

  //setter and getter
} 
```

虽然这种方式有点多余，但它避免了使用手动包装器。对我来说效果很好，即使是嵌套对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:20:50.063

我认为不可能将 ObjectMapper 配置为自动执行此操作。

您可以尝试编写自己的解析器，类似于以下内容：

```
JsonFactory f = new JsonFactory();
JsonParser jp = f.createJsonParser(new File("positions.json"));
List<Position> positions = new LinkedList<Position>();
jp.nextToken(); // will return JsonToken.START_OBJECT (verify?)
while (jp.nextToken() != JsonToken.END_OBJECT) {
  String fieldname = jp.getCurrentName();
  jp.nextToken(); // move to value, or START_OBJECT/START_ARRAY
  if ("positions".equals(fieldname)) { // contains an object
    Position pos = new Position();
    while (jp.nextToken() != JsonToken.END_OBJECT) {
      String namefield = jp.getCurrentName();
      jp.nextToken(); // move to value
      if ("value".equals(namefield)) {
        pos.setValue(jp.getText());
      } 
  }
}
jp.close(); 
```

# node.js - node.js Redis GET

> ID：11850587
> 
> 赞同：0
> 
> 时间：2012-08-07T16:52:02.633
> 
> 标签：node.js, redis

我正在尝试从 Redis 数据库中获取值。代码：

```
 callback(null, 'Please enter PIN.');
                                    read = db.get(cmd + ':pin');
                                    console.log(read);
                                    n = db.get(cmd + ':name');
                                    waitingType = 'pin';
                                    wait = 1; 
```

但是，当`console.log(read)`我得到`true`. 为什么我没有得到 的价值`db.get(cmd + ':pin')`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-12T23:04:02.017

Node 旨在使用 lambda 函数来传递回调。尝试将您的其余决定作为行为传递给各种响应：

```
read = db.get(cmd + ':pin', function(result) {
    console.log(read);
    // like this
    // ... and so on
}); 
```

此外，您可能想进一步了解 Redis，您可以一次检索所有字段。请参阅[HMGET](http://redis.io/commands/hmget)。我认为您可以改进存储数据的结构以更好地适应应用程序逻辑。

```
// for example:
// set like this, where id is some front stuff you know ahead of time, 
// like the expected username from a login form, that is expected to be unique
// you may concatenate and hash, just make this unique
db.hmset("authData:" + id, {id:'uniqID', pin:0666, name:'that guy'});

// get like this
db.hmget("authData:" + id, function(err, data) {
    console.log(['data will contain id, pin and name keys', data]);
});

//output:
/* [
    'data will contain id, pin and name keys', 
    {id:'uniqID', pin:0666, name:'that guy'}
    ]
*/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T16:58:43.080

db.get 是异步的，因此当您的程序到达 console.log(read) 时，db 调用尚未完成

# asp.net - 当 .aspx 文件上的 Web 服务器控件在后面的代码中重新定义时会发生什么？

> ID：11850590
> 
> 赞同：0
> 
> 时间：2012-08-07T16:52:09.433
> 
> 标签：asp.net

```
Mark Up:
<asp:Label ID="Status" runat="server" Visible="false" />

Code Behind:

public partial class Files : System.Web.UI.Page
    {
        protected System.Web.UI.WebControls.Label Status;
        protected void Page_Load(object sender, EventArgs e)
        {
            Status.
        }
    } 
```

现在，每当我尝试在 Page_Load 处理程序中使用标签*Status时，我都会收到警告，因为**该成员被多次定义*。我的问题是为什么在将其重新定义为实例成员时没有收到警告？实际上是否可以继续进行控制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:03:09.190

您已经`Label Object`在 Designer 中使用了 Status。您可以检查设计器 .cs 类的声明吗？同名变量不能声明两次。

更正的代码如下...

## 标记：

```
<asp:Label ID="Status" runat="server" Visible="false" /> 
```

## 代码背后：

```
public partial class Files : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
        {
            //Pseudo Code
            //Status.PropertyName....
        }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:54:26.203

你不需要这一行：

```
protected System.Web.UI.WebControls.Label Status; 
```

因为当您在 ASP.net 布局中声明控件时，它会自动创建为页面类的字段。

# javascript - javascript 这会返回未知属性

> ID：11850592
> 
> 赞同：2
> 
> 时间：2012-08-07T16:52:25.803
> 
> 标签：javascript, jquery, ajax, oop

我刚刚编写了那段代码，并在警告部分收到错误消息，告诉我 this.words 没有定义。我猜 jquery 部分更改了“this”值，因为在注释所在的位置，我可以访问数组。

现在我卡住了，因为我不想让单词属性全局（是什么让它运行）。所以我想问你一种在保持“OOP”风格的同时解决问题的方法。

```
function game()
{
    this.difficulty = 0;
    this.mode = 0;
    this.words = new Array();

    this.loadWords = function()
    {
        //request word pool
        $.ajax({
            type:"GET",
            url:"word.php",
            data:{mode:this.mode, difficulty:this.difficulty}
        }).done(function(html) {
            alert(this.words.length);
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:55:08.057

这似乎是一个范围界定问题。`this`不再引用`.done`函数内的游戏对象。尝试

```
this.loadWords = function()
{
    var that = this;
    //request word pool
    $.ajax({
        type:"GET",
        url:"word.php",
        data:{mode:this.mode, difficulty:this.difficulty}
    }).done(function(html) {
        alert(that.words.length);
    });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T16:55:48.000

```
function Game()
{
    this.difficulty = 0;
    this.mode = 0;
    this.words = new Array();
    this.wordsLoaded = $.proxy(this.wordsLoaded, this);
}

var method = Game.prototype;

method.loadWords = function() {

    $.ajax({
        type:"GET",
        url:"word.php",
        data:{mode:this.mode, difficulty:this.difficulty},
        success: this.wordsLoaded
    });

};

method.wordsLoaded = function() {
    alert( this.words.length );
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-07T16:54:14.457

处理程序中的值`this`已更改，``done()`因此它不再是您的对象。您可以通过将副本保存`this`到另一个变量中来修复它，如下所示：

```
function game()
{
    this.difficulty = 0;
    this.mode = 0;
    this.words = new Array();

    this.loadWords = function()
    {
        var self = this;
        //request word pool
        $.ajax({
            type:"GET",
            url:"word.php",
            data:{mode:this.mode, difficulty:this.difficulty}
        }).done(function(html) {
            alert(self.words.length);
        });
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T16:54:36.363

通过执行以下操作在内部保存游戏功能：

`var _self = game;`

那样你做`_self.difficulty`，，`_self.words.length`等等......他们将能够访问它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T17:04:05.330

你可以看看

[http://javascript.crockford.com/private.html](http://javascript.crockford.com/private.html)

有关 javascript 中私有、受保护和公共的更多想法，但这里有一个解决方案：

**未经测试的代码**

```
function game() {
    var difficulty = 0;
    var mode = 0;
    var words = [];
    this.loadWords = function()
    {
        //request word pool
        $.ajax({
            type:"GET",
            url:"word.php",
            data:{mode:this.mode, difficulty:this.difficulty}
        }).done(function(html) {
            alert(this.words.length);
        });
    }
} 
```

您也需要一个 getter `words`，但基本上有一种方法可以初始化它，通过调用函数和任何其他访问是通过 getter。

**未经测试的代码**

    function game() { var 难度 = 0; 变种模式= 0；变种词= []；var that = this; this.loadWords = function() { //请求词池 $.ajax({ type:"GET", url:"word.php", data:{mode:that.mode,difficult:that.difficulty} }).完成（函数（html）{警报（this.words.length）；}）；} }

我添加了一个`that`变量并将其设置为`this`, 以帮助包含该值，但在 ajax 调用中直接调用`mode`变量可能就足够了，但可能需要使用`that`. 此外，`this`函数之前可能是一个问题，不确定，我需要使用调试器来查看实际发生的情况并查看实际使用的内容。

我错过了`this`.ajax 调用的内部，这是最初的问题。

# php - 通过 POST 将 XML 发送到另一台服务器

> ID：11850593
> 
> 赞同：0
> 
> 时间：2012-08-07T16:52:27.427
> 
> 标签：php, javascript, xml, post

我正在处理一个非常糟糕的 API，需要我发送这个 XML：

```
<?xml_version string(335) ""1.0" encoding="utf-16"?>
<GetTicketAction xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <CompanyName>*name*</CompanyName>
    <IntegrationLoginId>*id*</IntegrationLoginId>
    <IntegrationPassword>*password*</IntegrationPassword>
    <SrServiceRecid>*recordId*</SrServiceRecid>
</GetTicketAction> 
```

通过 POST (as `actionString`) 发送到不受我控制的服务器。我已经用 JavaScript（不能，交叉脚本）和 CURL（得到“这需要加密错误”）进行了尝试。文档中的任何地方都没有提到加密，它说可以使用“完全信任”在 IE 中使用 JS 来完成。

内容类型`application/x-www-form-urlencoded`是否有帮助。

有没有办法用 JS 和/或 PHP 发送这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T12:58:59.167

经过多年痛苦的 API 慢慢让我发疯，我发现它不希望我通过标准 CURL 模式发送 XML

```
$data = array(
    "actionString" => $xml
); 
```

相反，我要做的是：

```
$data = 'actionString=<?xml_version string(335) ""1.0" encoding="utf-16"?>
<GetTicketAction xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <CompanyName>*name*</CompanyName>
    <IntegrationLoginId>*id*</IntegrationLoginId>
    <IntegrationPassword>*password*</IntegrationPassword>
    <SrServiceRecid>*recordId*</SrServiceRecid>
</GetTicketAction>' 
```

未来的 API 编写者：让这成为一个警告。我真的希望一个疯狂的精神病患者知道这家伙睡在哪里。

# c# - 使用 PileExclusion 解决数独难题

> ID：11850595
> 
> 赞同：0
> 
> 时间：2012-08-07T16:52:34.580
> 
> 标签：c#, java, algorithm, sudoku

我试图解决数独难题。我的算法使用 PileExclusion 来消除每个节点的可能性。在某些谜题中，每个节点都可以得到 1 个可能值的答案。在某些其他节点上，对于大多数节点，我得到一个可能的答案，但在某些节点上，我有多个可能的值（这是正确的值）。是否有任何其他优化可以进一步减少答案？或者我应该对某些值做出假设？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T18:30:12.463

还有许多其他技术可以排除值。我最近遇到了这个页面：

[http://www.sudokuwiki.org/sudoku.htm](http://www.sudokuwiki.org/sudoku.htm)

32 种方法，在你不得不诉诸试错之前。

# python - Python类定义分配属性

> ID：11850603
> 
> 赞同：3
> 
> 时间：2012-08-07T16:53:03.900
> 
> 标签：python

我尝试在空闲时执行这段代码并出现以下错误，

```
class Myclass():
    i = 1

x = Myclass()
x.y = 10
x.i=10
x.i
# 10
x.y
# 10 
```

这个类只有1个属性'i'，但是当我分配xy = 10时，Python将如何允许它工作。这不是问题吗？我该如何防止它发生？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:00:42.470

正如其他答案所提到的，这是一个功能而不是错误。

如果您只想强制执行一组有限的属性，您可以使用[`__slots__`](http://docs.python.org/reference/datamodel.html#slots)新[样式类](http://docs.python.org/glossary.html#term-new-style-class)（继承自的类`object`）：

```
class Myclass(object):
    __slots__ = ['i']

>>> x = Myclass()
>>> x.i = 10
>>> x.y = 10
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: 'Myclass' object has no attribute 'y' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T16:57:20.280

与 Java 等许多其他语言不同，Python 动态分配类成员。这意味着您不需要在类的定义中包含变量就可以分配给它。

另请注意，与您分配的类变量之间存在差异：

```
class Myclass():
     i = 1 
```

和一个班级成员：

```
class Myclass():
    def __init__(self):
        self.i = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:57:18.540

这就是你在 Python 中定义类变量的方式。您可以使用一些“魔术”功能来防止这种行为，但通常不建议这样做。

# javascript - Rally App SDK 2.0：自定义看板中不提供退出策略

> ID：11850604
> 
> 赞同：1
> 
> 时间：2012-08-07T16:53:11.670
> 
> 标签：javascript, rally

使用 Rally 代码作为基础的自定义看板似乎没有退出策略字段？它似乎正在检查以下值：

```
this._isToggledOn('PORTFOLIO_ITEM_KANBAN_POLICIES') 
```

但是，即使检查似乎返回 true，并且添加了“显示策略”复选框，退出策略在选中时也不会正确呈现。

# c# - 策略模式与依赖注入

> ID：11850606
> 
> 赞同：14
> 
> 时间：2012-08-07T16:53:16.700
> 
> 标签：c#, design-patterns, dependency-injection, strategy-pattern

策略模式与依赖注入有何不同？

即以下是您可以使用策略模式执行的操作：

```
class Foo{
   private readonly ISortAlgo _sortAlgo;

  public Foo(ISortAlgo sortAlgo)
  {
     _sortAlgo = sortAlgo;
  }

  public void Sort()
  {
    _sortAlgo.sort();
  }

} 
```

使用 DI 你可以做同样的事情，本质上你可以有构造函数、设置器、接口等注入。它会产生与策略模式相同的效果。我知道 DI 还包含其他原则，例如松散耦合、可测试性、布线等。

在实施方面，我没有看到太大的区别。

策略模式和DI有什么区别？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-07T17:07:05.030

首先，*依赖注入*不仅有*构造函数注入*作为注入方法，还有*属性*、*方法注入*和*环境上下文*。

其次，*策略*定义了*行为*，因此客户可以选择与他的需求相匹配的特殊行为。而*依赖注入*与外部依赖的抽象一起工作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-07T16:59:52.060

[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)允许在运行时选择对象的行为（即它的算法），而依赖[注入](http://en.wikipedia.org/wiki/Dependency_injection)允许删除硬编码的依赖关系。

因此，他们不是竞争对手。它们的实现可能相似，但是它们的目标是不同的。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-07T17:01:01.887

策略允许您更改对象的行为。DI 是一种允许您依赖抽象的设计模式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-07T17:03:25.647

依赖注入是一种模式，可以帮助您拆分构造表单逻辑，这对于测试和系统可扩展性非常有用。它也可以用于其他模式适合的地方，例如 Singleton。

策略模式解决了一个不同的问题。它让运行时通过多态来选择算法 - 在 OOP 中。

当然，他们可以一起工作。

# java - 添加 0 但转换为 int 时不显示为两位数

> ID：11850609
> 
> 赞同：1
> 
> 时间：2012-08-07T16:53:21.717
> 
> 标签：java, date, printing, integer

`0`如果日期是个位数，我想在日期前添加一个。所以我做了一个代码：

```
public class Zero {

    /**
    * @param args
    */
    public static void main(String[] args) {
        // TODO Auto-generated method stub
        String zero="0";
        Calendar cal = new GregorianCalendar();
        int day1 = cal.get(Calendar.DAY_OF_MONTH);
        String seven1=Integer.toString(day1);
        System.out.println(""+seven1);
        System.out.println(""+day1);
        String added=zero.concat(seven1);
        System.out.println(""+added);
        int change=Integer.parseInt(added);
        System.out.println(""+change);
    }

} 
```

所以当我打印`change`它时，它只打印`7`不`07`。实际上我想制作`int` `07`而不是`7`. 那么打印应该做哪些修改`07`呢？

**注意**- 我没有`if-else`故意提到检查一位数或多位日期，因为它没有问题！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T16:56:24.103

使用[SimpleDateFormat](http://docs.oracle.com/javase/6/docs/api/java/text/SimpleDateFormat.html)格式化日期。

你的模式将是`dd`。

```
SimpleDateFormat sdf = new SimpleDateFormat("dd");
System.out.println(sdf.format(new Date())); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:10:49.850

试试这个`SimpleDateFormat`

```
System.out.println(new SimpleDateFormat("dd").format(new Date())); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:58:15.943

您是否考虑过使用[SimpleDateFormat](http://download.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)对象？这将使您对格式有高度的控制。该文本`dd`将为您提供一个零填充的日期值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T16:58:21.137

尝试使用[http://docs.oracle.com/javase/1.4.2/docs/api/java/text/DecimalFormat.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/DecimalFormat.html)

正确的用法是

```
int day = Calendar.Day_OF_Month;
DecimalFormat df = new DecimalFormat("00"); 
System.out.println(df.format(day)); 
```

另外，不要忘记 java 月份从 0 开始：/

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T16:59:48.537

一个快速的解决方案是：

```
int change = Integer.parseInt(added);
if (change < 10) {
   System.out.println("0" + change);
} else {
   System.out.println(change);
} 
```

然而，更好的解决方案是使用[NumberFormat 类](http://docs.oracle.com/javase/6/docs/api/java/text/NumberFormat.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-07T16:56:02.093

```
public String addZero(String input) {
    if(input.length() == 1)
        return "0" + input;
    return input;
} 
```

如果字符串为 1 位，该方法只会在字符串的开头添加一个零，因此如果您将其交给“1”，它将返回“01”，如果您将其交给“11”，它将返回“11”。我想这就是你想要的。

# c++ - 将 Gtk::Grid 重复添加到 Gtk::Box

> ID：11850611
> 
> 赞同：0
> 
> 时间：2012-08-07T16:53:32.387
> 
> 标签：c++, linux, user-interface, inheritance, gtkmm

我有一个只包含一个网格的 Window 对象。我想使用 Gtk::Builder 来获取指向网格的指针，然后使用一些 Gtk::Box`Gtk::Box->pack_end()`多次将网格添加到其中（每次都使用操纵的内容）。

虽然每次`pack_end()`调用我都会得到：

`gtk_box_pack: assertion 'gtk_widget_get_parent (child) == NULL' failed`在我的终端中，没有任何东西被添加到框中。

我应该怎么办？

谢谢

***编辑：目标：我希望将数据库表的条目放入每个记录的精美小部件中，尽管所有记录一个接一个地垂直显示。我想我可以在 Glade 中将精美的小部件创建为窗口，并使用 Gtk::Builder 获取指向它的指针。所以在幻想的 Glade 文件中，我有一个窗口，其中包含一个具有我自定义外观的网格。当我尝试 , 时`add`出现`pointer to the fancy *grid*`上述`to`错误`visible window's Box`。我希望我很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T07:33:25.177

这是解决方案`gtk_box_pack: assertion 'gtk_widget_get_parent (child) == NULL' failed`：

首先需要做的就是你应该在没有窗口的情况下绘制小部件，因此当加载构建器时，它不会有父级，因此断言成功。

虽然这里还有一点：当我将网格的第一个实例添加到 Box 时，第二个实例再次导致相同的错误。经过几次试验和错误后，我意识到在每次交互中，您应该使用`Gtk::Builder::create_from_file()`创建一个新的无父网格实例以便能够使用，并且这样可以工作。

性能必须有很大差异，以防记录数量很大，但是 Gtk::Widget 的复制构造函数是私有的，直接复制是不可能的，因为这不是我的主要痴迷，所以我没有坚持关于解决这个“性能”问题。

# http - 无法从 chrome 或 ping 访问 Microsoft.com 站点，但可以从 IE 访问

> ID：11850614
> 
> 赞同：1
> 
> 时间：2012-08-07T16:53:37.753
> 
> 标签：http

我该怎么做才能从 Chrome 访问 Microsoft.com？

我遇到了一个问题：当我尝试访问任何其他网站时，都可以。当我尝试任何 MS 网站时，它都会失败。

当我通过 IE - 它成功了。两种方式都尝试了很多次，通过 chrome 始终失败，通过 IE 始终成功

* * *

细节：

Chrome 给我：错误 101 (net::ERR_CONNECTION_RESET)

在 stackoverflow 上查找某人显然与 Facebook.com 有类似的问题，但关闭了线程（“太宽泛的问题！”）[https://stackoverflow.com/posts/11616375/](https://stackoverflow.com/posts/11616375/)

* * *

我 ping microsoft.com 并超时。

Tracert 给了我这个：

```
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\pashute>tracert microsoft.com

Tracing route to microsoft.com [64.4.11.37] over a maximum of 30 hops:

1     5 ms     3 ms     3 ms  DSL6740U.Home [10.0.0.138]
2    22 ms    27 ms    34 ms  bzq-179-37-1.static.bezeqint.net [212.179.37.1]
3     *       22 ms    21 ms  bzq-218-103-210.red.bezeqint.net [81.218.103.210]
4    23 ms    22 ms    22 ms  bzq-179-75-198.static.bezeqint.net [212.179.75.198]
5     *        *        *     Request timed out.
6    80 ms    81 ms    81 ms  bzq-179-124-122.static.bezeqint.net [212.179.124.122]
7     *        *        *     Request timed out.
8     *        *        *     Request timed out.

etc etc. 

Trace complete. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T16:59:38.660

我不知道为什么 chrome 无法访问，但 Microsoft 由于 Dos 攻击而阻止了 icmp 协议，因此您无法 ping，因为 ping 使用 icmp 协议。

来源：[点击这里](http://www.computerhope.com/issues/ch001054.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T19:34:48.883

清除所有 Chrome 浏览历史！！！

问题解决了！[*谢谢埃尔诺拉·斯图尔特！！*]

* * *

首先，我只清除了历史并“从一开始”就开始了。- 没有帮助。

然后清空一切。- 我可以打开微软！！

在这里找到[雅虎答案](http://ph.answers.yahoo.com/question/index?qid=20110707035508AAijObG)！

来自雅虎问答的内容：

> 清除您的网络历史记录并再次尝试浏览 Microsoft。

# ruby-on-rails - Rails 以错误的顺序保存模型

> ID：11850615
> 
> 赞同：0
> 
> 时间：2012-08-07T16:53:39.193
> 
> 标签：ruby-on-rails, has-one

我已经四处寻找了一段时间，似乎无法弄清楚是什么原因造成的，我有一个模型正在保存一名志愿者以及他的家庭和工作地址。我改变了一些东西（似乎无法弄清楚我的生活是什么），现在地址没有设置。

这是我的主要模型：

```
class HumanVolunteer < ActiveRecord::Base

  has_one :primaryPhone, :class_name => "PhoneNumber", :foreign_key => "id", :primary_key => "phone_id"
  has_one :primaryEmail, :class_name => "Email", :foreign_key => "id", :primary_key => "email_id"
  has_one :work_adr, :class_name => "Address", :foreign_key => "id", :primary_key => "workaddressid"
  has_one :home_adr, :class_name => "Address", :foreign_key => "id", :primary_key => "homeaddressid"

  attr_accessible :firstName, :lastName, :homeaddressid, :notes, :status, :workaddressid, :home_adr, :work_adr, 
              :primaryPhone, :primaryEmail, :home_adr_attributes, :work_adr_attributes, :primaryPhone_attributes, 
              :primaryEmail_attributes

  accepts_nested_attributes_for :home_adr 
  accepts_nested_attributes_for :work_adr 
  accepts_nested_attributes_for :primaryPhone
  accepts_nested_attributes_for :primaryEmail
end 
```

和地址模型：

```
class Address < ActiveRecord::Base
  attr_accessible :city, :line1, :line2, :notes, :state, :zipcode
  belongs_to :human_volunteer
end 
```

这是来自 human_volunteers_controller 的片段

```
# GET /human_volunteers/new
  # GET /human_volunteers/new.json
  def new
    @human_volunteer = HumanVolunteer.new
    @human_volunteer.build_home_adr
    @human_volunteer.build_work_adr
    @human_volunteer.build_primaryPhone
    @human_volunteer.build_primaryEmail

    # Set the Breadcrumbs for this page
    @breadcrumbs = { "Dashboard" => "/", "Human Volunteers" => "/human_volunteers"}
    @current_page = "New Volunteer"

    respond_to do |format|
      format.html # new.html.erb
      format.json { render :json => @human_volunteer }
    end
  end

  # GET /human_volunteers/1/edit
  def edit
    @human_volunteer = HumanVolunteer.find(params[:id])
    if(@human_volunteer.home_adr.nil?)
      @human_volunteer.build_home_adr
    end

    if(@human_volunteer.work_adr.nil?)  
      @human_volunteer.build_work_adr
    end

    if(@human_volunteer.primaryPhone.nil?)
      @human_volunteer.build_primaryPhone
    end

    if(@human_volunteer.primaryEmail.nil?)
      @human_volunteer.build_primaryEmail
    end

    @breadcrumbs = { "Dashboard" => "/", "Human Volunteers" => "/human_volunteers"}
    @current_page = "Edit Volunteer: <em>" + @human_volunteer.firstName + " " + @human_volunteer.lastName + "</em>";
  end

  # POST /human_volunteers
  # POST /human_volunteers.json
  def create
    # create the volunteer
    @human_volunteer = HumanVolunteer.new(params[:human_volunteer])

    respond_to do |format|
      if @human_volunteer.save
        format.html { redirect_to @human_volunteer, :notice => @human_volunteer.firstName + ' ' + @human_volunteer.lastName + ' was successfully created.' }
        format.json { render :json => @human_volunteer, :status => :created, :location => @human_volunteer }
      else
        format.html { render :action => "new" }
        format.json { render :json => @human_volunteer.errors, :status => :unprocessable_entity }
      end
    end
  end

  # PUT /human_volunteers/1
  # PUT /human_volunteers/1.json
  def update
    @human_volunteer = HumanVolunteer.find(params[:id])

    respond_to do |format|
      if @human_volunteer.update_attributes(params[:human_volunteer])
        format.html { redirect_to @human_volunteer, :notice => @human_volunteer.firstName + ' ' + @human_volunteer.lastName + ' was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render :action => "edit" }
        format.json { render :json => @human_volunteer.errors, :status => :unprocessable_entity }
      end
    end
  end 
```

我可以通过查看日志看到我认为的问题，首先保存人类志愿者，使用空值作为地址键，然后保存地址（电话号码和电子邮件模型也有同样的问题，它们的设置相同到地址），然后保存地址，然后人类志愿者再也不会用新值更新：

```
 Parameters: {"authenticity_token"=>"dD+ut6noFPw8mJHq4rUJpuNBD1o+q0Hi8a+qOeetzMc=", "utf8"=>"✓", "human_volunteer"=>{"lastName"=>"Koch", "work_adr_attributes"=>{"line1"=>"", "line2"=>"", "zipcode"=>"", "state"=>"", "city"=>""}, "primaryEmail_attributes"=>{"email"=>""}, "primaryPhone_attributes"=>{"number"=>""}, "notes"=>"", "home_adr_attributes"=>{"line1"=>"123 Who Knows land", "line2"=>"", "zipcode"=>"11741", "state"=>"TS", "city"=>"testville"}, "firstName"=>"Ken", "status"=>"Investigative Candidate"}}
   (0.2ms)  BEGIN
   (0.2ms)  COMMIT
   (0.2ms)  BEGIN
   (0.1ms)  COMMIT
   (0.1ms)  BEGIN
   (0.1ms)  COMMIT
   (0.1ms)  BEGIN
   (0.1ms)  COMMIT
   (0.1ms)  BEGIN
  SQL (2.3ms)  INSERT INTO "human_volunteers" ("created_at", "email_id", "firstName", "homeaddressid", "lastName", "notes", "phone_id", "status", "updated_at", "workaddressid") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["email_id", nil], ["firstName", "Ken"], ["homeaddressid", nil], ["lastName", "Koch"], ["notes", ""], ["phone_id", nil], ["status", "Investigative Candidate"], ["updated_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["workaddressid", nil]]
  SQL (0.8ms)  INSERT INTO "phone_numbers" ("created_at", "notes", "number", "phone_id", "phone_type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["created_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["notes", nil], ["number", ""], ["phone_id", nil], ["phone_type", nil], ["updated_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00]]
  SQL (0.7ms)  INSERT INTO "emails" ("created_at", "email", "notes", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["email", ""], ["notes", nil], ["updated_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00]]
  SQL (0.9ms)  INSERT INTO "addresses" ("city", "created_at", "line1", "line2", "notes", "state", "updated_at", "zipcode") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["city", ""], ["created_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["line1", ""], ["line2", ""], ["notes", nil], ["state", ""], ["updated_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["zipcode", nil]]
  SQL (0.5ms)  INSERT INTO "addresses" ("city", "created_at", "line1", "line2", "notes", "state", "updated_at", "zipcode") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["city", "testville"], ["created_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["line1", "123 Who Knows land"], ["line2", ""], ["notes", nil], ["state", "TS"], ["updated_at", Tue, 07 Aug 2012 16:47:16 UTC +00:00], ["zipcode", 11741]]
  (17.8ms)  COMMIT 
```

编辑：如果有任何帮助，这里是日志中旧条目的示例：

```
Started POST "/human_volunteers" for 127.0.0.1 at Sat Jul 28 09:08:59 -0400 2012
Processing by HumanVolunteersController#create as HTML
  Parameters: {"human_volunteer"=>{"firstName"=>"Ken", "work_adr"=>{"city"=>"", "state"=>"", "zipcode"=>"", "line1"=>"", "line2"=>""}, "status"=>"Trainee", "home_adr"=>{"city"=>"fdsa", "state"=>"Nasdf", "zipcode"=>"11729", "line1"=>"asdf fdsafd", "line2"=>""}, "primaryEmail"=>"ken.koch@essencedesigns.net", "primaryPhone"=>"6316813806", "lastName"=>"Koch", "notes"=>"\r\nHes a good guy"}, "authenticity_token"=>"bgbecE+nMxNrPtleNOLfO/MqRib0cXmDMqL5JaPyC10=", "utf8"=>"✓"}
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "emails" ("created_at", "email", "notes", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["email", "ken.koch@essencedesigns.net"], ["notes", nil], ["updated_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00]]
  [1m[36m (19.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "phone_numbers" ("created_at", "notes", "number", "phone_id", "phone_type", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["created_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["notes", nil], ["number", "6316813806"], ["phone_id", nil], ["phone_type", nil], ["updated_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00]]
  [1m[35m (56.9ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (2.5ms)[0m  INSERT INTO "addresses" ("city", "created_at", "line1", "line2", "notes", "state", "updated_at", "zipcode") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"  [["city", ""], ["created_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["line1", ""], ["line2", ""], ["notes", nil], ["state", ""], ["updated_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["zipcode", nil]]
  [1m[36m (9.4ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "addresses" ("city", "created_at", "line1", "line2", "notes", "state", "updated_at", "zipcode") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["city", "Deer Park"], ["created_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["line1", "294 West 15th St"], ["line2", ""], ["notes", nil], ["state", "NY"], ["updated_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["zipcode", 11729]]
  [1m[35m (7.0ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.1ms)[0m  INSERT INTO "human_volunteers" ("created_at", "email_id", "firstName", "homeaddressid", "lastName", "notes", "phone_id", "status", "updated_at", "workaddressid") VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10) RETURNING "id"  [["created_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["email_id", 5], ["firstName", "Ken"], ["homeaddressid", 14], ["lastName", "Koch"], ["notes", "\r\nHes a good guy"], ["phone_id", 11], ["status", "Trainee"], ["updated_at", Sat, 28 Jul 2012 13:08:59 UTC +00:00], ["workaddressid", 13]]
  [1m[36m (6.1ms)[0m  [1mCOMMIT[0m
Redirected to http://localhost:3000/human_volunteers/1
Completed 302 Found in 178ms (ActiveRecord: 112.1ms) 
```

我能够回顾日志并找到一个有效的日志，而human_volunteer 是最后插入的东西。它首先插入地址、电子邮件、电话，然后在插入志愿者时使用这些 ID。

编辑：我还可以报告我没有收到任何错误，一切都通过了，只是数据没有连接。

任何想法可能导致订单发生变化？我看不到我改变了任何影响这一点的东西。

更新：当我将这些行更改为：

```
 has_one :workaddress, :class_name => "Address", :foreign_key => "id", :primary_key => "workaddress"
  has_one :homeaddress, :class_name => "Address", :foreign_key => "id", :primary_key => "homeaddress" 
```

它每次都尝试使用addressid 1，我得到了

```
ActiveRecord::RecordNotUnique (PG::Error: ERROR:  duplicate key value violates unique constraint "addresses_pkey"
DETAIL:  Key (id)=(1) already exists. 
```

此外，如果我取出 primary_key 字段，它似乎可以工作，但它会尝试将它们都设置为相同的地址，并且我得到相同的错误，除了下一个 id （每次尝试时为 22、23、24 等）

也许这可以说明问题？我会继续四处打探。

非常感谢， - 肯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T17:37:16.713

我想出了一个似乎可行的解决方案。

由于最初设置了 id 后，一切似乎都正常工作，我只是在控制器中的 create 操作下手动将其链接起来：

```
@human_volunteer.homeaddress.save
@human_volunteer.homeaddressid = @human_volunteer.homeaddress.id
@human_volunteer.workaddress.save
@human_volunteer.workaddressid = @human_volunteer.workaddress.id 
```

现在，在创建志愿者时设置了地址，其他一切都应该很好地执行。

我能看到的唯一额外考虑因素是确保当我将验证器添加到地址时，地址可以在允许创建整个事物之前实际验证。

谢谢大家，

-肯

# asp.net - 以编程方式与网页交互

> ID：11850622
> 
> 赞同：1
> 
> 时间：2012-08-07T16:54:08.977
> 
> 标签：asp.net, python, automation, python-3.x, webpage

[http://www.apsalin.com/convert-cartesian-to-geodetic.aspx](http://www.apsalin.com/convert-cartesian-to-geodetic.aspx)

我想写一个python程序，打开上面的网页，用特定的值填写3个文本框，点击“转换”按钮，然后提取答案。实现这一目标的最佳方法是什么？我听说过 mechanize 但这不适用于 Python 3。

如果在 python 中没有可用的方法，那么自动化网站交互的另一种好方法是什么？我对任何类型的程序或编程语言持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:00:06.193

你可以看看[mechanize](http://wwwsearch.sourceforge.net/mechanize/)。它应该拥有实现目标所需的一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:31:28.527

Python 3 是先决条件吗？如果没有，您可以查看[selenium](http://seleniumhq.org/)。被描述为主要用于自动化测试的**浏览器自动化工具。**有可用的[Python 绑定](http://pypi.python.org/pypi/selenium)。我目前使用这些。

# javascript - jQuery .trigger() 多个事件

> ID：11850625
> 
> 赞同：25
> 
> 时间：2012-08-07T16:54:15.140
> 
> 标签：javascript, jquery, triggers

我正在编写一个 jQuery 插件并使用`.on`and`.trigger`作为我的发布/订阅系统。但是，我想在不同的场景中触发多个事件。

这可以像`.on`方法一样作为一个字符串执行吗？

目标：

```
$this.trigger("success next etc");    // doesn't work 
```

当前解决方案：

```
$this
    .trigger("success")
    .trigger("next")
    .trigger("etc");                  // works, triggers all three events 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-07T17:18:21.187

JQuery 本身不支持触发多个事件，但是您可以编写自定义扩展方法`triggerAll`

```
(function($) {
    $.fn.extend({
        triggerAll: function (events, params) {
            var el = this, i, evts = events.split(' ');
            for (i = 0; i < evts.length; i += 1) {
                el.trigger(evts[i], params);
            }
            return el;
        }
    });
})(jQuery); 
```

并像下面这样称呼它：

```
$this.triggerAll("success next etc"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-07T17:04:15.510

你所拥有的很好......你不能使用逗号分隔的列表触发多个事件。trigger() 构造函数只需要一个事件名称和可选的附加参数来传递给事件处理程序。

另一种选择是触发附加到元素的所有事件，但是，如果您需要在不同的场景中触发特定事件，这可能无法满足您的需求：

```
$.each($this.data('events'), function(k, v) {
    $this.trigger(k);
});​ 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-08-07T17:15:39.857

以防万一其他人在以后的生活中偶然发现这个问题，我通过创建一个自定义 jQuery 函数来解决这个问题。

```
$.fn.triggerMultiple    =   function(list){
    return this.each(function(){
        var $this = $(this); // cache target

        $.each(list.split(" "), function(k, v){ // split string and loop through params
            $this.trigger(v); // trigger each passed param
        });
    });
};

$this.triggerMultiple("success next etc"); // triggers each event 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-25T14:29:25.370

您可以**扩展原始的[.trigger()](https://api.jquery.com/trigger/)**方法原型：

```
(function($) {
  const _trigger = $.fn.trigger;
  $.fn.trigger = function(evtNames, data) {
    evtNames = evtNames.trim();
    if (/ /.test(evtNames)) {
      evtNames.split(/ +/).forEach(n => _trigger.call(this, n, data));
      return this;
    }
    return _trigger.apply(this, arguments);
  };
}(jQuery));

$("body").on({
  foo(e, data) { console.log(e, data); },
  bar(e, data) { console.log(e, data); },
  baz(e, data) { console.log(e, data); },
});

$("body").off("bar"); // Test: stop listening to "bar" EventName
$("body").trigger(" foo    bar baz ", [{data: "lorem"}]); // foo, baz
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
```

代码解释

```
 // Keep a reference to the original prototype
const _trigger = $.fn.trigger;

$.fn.trigger = function(evtNames, data) {

  // Remove leading and ending whitespaces 
  evtNames = evtNames.trim();

  // If the string has at least one whitespace
  if (/ /.test(evtNames)) {

    // Split names into Array (Treats multiple spaces as one)
    evtNames.split(/ +/)
    // Call the original .trigger() method for one eventName (and pass data)
      .forEach(n => _trigger.call(this, n, data));

    // End here.
    // Return this (Element) to maintain jQuery methods chainability for this override.
    return this;
  }

  // No whitespaces detected
  // Pass all arguments to the original .trigger() Method immediately.
  // The original method already returns this (Element), so we also need to 
  // return it here to maintain methods chainability when using this override. 
  return _trigger.apply(this, arguments);
}; 
```

# javascript - javascript滑块在magento主页上不起作用

> ID：11850629
> 
> 赞同：1
> 
> 时间：2012-08-07T16:54:38.410
> 
> 标签：javascript, magento, slider

我正在开发几个不同的 magento 网站。我在其中两个站点上实现了一个滑块，但在第三个站点上它不起作用。我猜 javascript 与另一个文件冲突，但我无法弄清楚是哪个文件或为什么它会发生冲突。我已经包含`var j$ = jQuery.noConflict();`了，就像我在其他网站上所做的那样，但它仍然无法正常工作。您可以在[此处查看](http://wrestlinguniverse.muvdigital.com)它正在运行的站点之一，而它不运行的站点在[此处](http://wadjetworldwide.com)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:22:27.347

`<p>`通过关闭所见即所得，我能够通过删除静态块内图像周围的标签来解决问题。尽管它会在您保存后自动添加段落标签，但它还是起作用了。

# java - Java 集合仅保留最后插入的 n 个成员

> ID：11850631
> 
> 赞同：4
> 
> 时间：2012-08-07T16:54:53.233
> 
> 标签：java, collections

正如标题所述，我正在寻找一个 java 集合，只保留插入到集合中的最后 N 个对象。这个 FIFO 集合不需要实现随机访问或支持改变 N。

我能找到的所有集合要么是阻塞的（ [LinkedBlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/LinkedBlockingQueue.html) ） ，要么是无限大小的（[ArrayDeque](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayDeque.html)）。我找到了 org.eclipse.jetty.util.ArrayQueue 但你可能猜到这对我的项目带来了相当不必要的依赖，而且非常复杂，因为它支持更改 N 所以它不是我需要的。

你知道是否有办法用一个非常常见的 java 库来实现它，还是我必须自己编写它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T16:59:09.953

查看[Apache Commons CircularFifoBuffer](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/buffer/CircularFifoBuffer.html)

> CircularFifoBuffer 是一个具有固定大小的先进先出缓冲区，如果已满则替换其最旧的元素。
> 
> 一个 CircularFifoBuffer 的移除顺序是基于插入顺序的；元素的删除顺序与添加顺序相同。迭代顺序与删除顺序相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:45:46.730

我只想编写一个包装类，其中包含一个私有 Queue 或 Deque 实例和一个公共 insert 方法，如果在客户端尝试插入额外成员时队列已经满，则该方法的行为符合您的需要。大小可以通过构造函数传入，任何属于 Queue 或 Deque 的方法，如果您需要可用但已经按照您的需要运行，您可以简单地转发到私有实例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-26T01:01:10.970

在 Guava 15.0 之后，EvictingQueue 具有固定大小，如果已满则替换其最旧的元素。

# html - CSS 高度和边框右问题

> ID：11850632
> 
> 赞同：1
> 
> 时间：2012-08-07T16:54:55.677
> 
> 标签：html, css, height, border

我怎样才能让`border-right`我的第一个`.section`div 与其他部分 div 的高度相同，以便当用户输入更多内容时，它们都保持相同的高度。

为了帮助说明这一点，我创建了一张图片和[Jsfiddle](http://jsfiddle.net/tcLyp/)来帮助您理解我的意思。

![在此处输入图像描述](../Images/9b398c6dfd387f6f3c90f55796a0c61f.png)

我试过搞乱 static `heights`，`min-height`但我想要完成的事情没有成功。

除了我目前在 jsfiddle 中执行此操作的方式之外，还有什么更好的方法吗？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T16:57:55.100

对于部分..而不是`display: inline-block;`使用`display: table-cell;`

[更新的小提琴](http://jsfiddle.net/NotInUse/tcLyp/1/)

*   旧版本的 Internet Explorer 可能无法正常运行。

# web-applications - 规范流网络界面

> ID：11850635
> 
> 赞同：2
> 
> 时间：2012-08-07T16:55:05.193
> 
> 标签：web-applications, nunit, specflow

有人知道可以运行 SpecFlow 或 NUnit 测试的 Web 应用程序吗？基本上，我让我的客户定义验收测试，我希望他们能够执行他们针对登台服务器定义的测试。

找了找，能找到几个像 Nunit Web 这样的老死项目，但没有找到真正符合我要求的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-28T16:53:55.040

以下是一些可能感兴趣的 specflow 工具的链接。

来自 Specflow 网站：

**[规格日志](http://www.speclog.net/)**

SpecLog 是 TechTalk 用于敏捷需求工程的协作工具，与 SpecFlow 和 ALM 工具（目前用于 Team Foundation Server、Visual Studio Online 和 JIRA）的强大集成。

功能文件从源代码控制存储库链接到其他规范工件的上下文，例如用户故事或业务目标。

SpecLog 允许在地图（例如 Story Maps、Impact Maps、功能树）中可视化和结构化 Gherkin 特征文件，并使用图片、链接和其他文档等更多文档工件来扩展特征文件。这有助于提供更全面的生活文档并增强 Gherkin 场景的可读性。

该文档还可以导出为 HTML，这样更容易与利益相关者共享，并允许将 Gherkin 场景与其他文档系统（例如操作手册、用户参考等）链接起来。SpecLog 还允许离线工作以支持仅偶尔连接到网络的用户。

* * *

**[健身](http://fitnesse.org/)**

完全集成的独立 wiki 和验收测试框架

在 FitNesse 中创建的 wiki 页面作为测试运行。可以针对应用程序本身测试规范，从而在规范和实现之间进行往返。

* * *

**[为 JIRA 行事](http://hindsightsoftware.com/solutions/behave-for-jira/)**

是一个将 specflow 挂钩到 JIRA 的 jira 插件。

# ios - ios - UITableViewCells 未扩展以适合文本

> ID：11850637
> 
> 赞同：0
> 
> 时间：2012-08-07T16:55:08.570
> 
> 标签：ios, ios5, uitableview

我正在尝试使 UITableView 中的单元格适应其中文本的长度。如果文本太长，单元格会长得更高以适应它。

我正在尝试这样的事情：

```
cell.textLabel.numberOfLines = 0;
cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;

cell.textLabel.text = [[name stringByAppendingString:@": "] 
                               stringByAppendingString:comment]; 
```

但是发生的情况是，单元格只是试图将文本放入相同的垂直空间量中，并且不会变得更高。

有人知道我在这里做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T16:56:45.443

您需要使用单元格高度委托。看看这里：[动态 UITableViewCell 高度](https://stackoverflow.com/questions/8903369/dynamic-uitableviewcell-height)。

您需要做的是计算文本高度，然后将单元格的高度设置为该高度。
具体这种方法：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
    NSString *yourText = [someArray objectAtIndex:indexPath.row];
    CGSize constraint = CGSizeMake(320 /*cell width*/, CGFLOAT_MAX);
    CGSize size = [yourText sizeWithFont:[UIFont systemFontOfSize:FONT_SIZE] constrainedToSize:constraint lineBreakMode:UILineBreakModeWordWrap];
    CGFloat height = MIN(size.height, 44.0f);

    return height;
} 
```

# zend-framework - Zend 2 路由器设置

> ID：11850639
> 
> 赞同：0
> 
> 时间：2012-08-07T16:55:12.677
> 
> 标签：zend-framework, routing

**我对ZF2**非常陌生，不知道如何设置全局路由器。我知道如何在模块级别设置：

[http://packages.zendframework.com/docs/latest/manual/en/user-guide/routing-and-controllers.html](http://packages.zendframework.com/docs/latest/manual/en/user-guide/routing-and-controllers.html)说：

> URL 到特定操作的映射是使用模块的 module.config.php 文件中定义的路由完成的。我们将为我们的相册操作添加一条路线。这是带有新代码注释的更新配置文件。

```
// The following section is new and should be added to your file
'router' => array(
    'routes' => array(
        'album' => array(
            'type'    => 'segment',
            'options' => array(
                'route'    => '/album[/:action][/:id]',
                'constraints' => array(
                    'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                    'id'     => '[0-9]+',
                ),
                'defaults' => array(
                    'controller' => 'Album\Controller\Album',
                    'action'     => 'index',
                ),
            ),
        ),
    ),
), 
```

有没有办法为整个应用程序配置默认行为？或者我必须在每个模块中进行配置？ **config/application.config.php**将是一个合乎逻辑的地方。它在某处有记录吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T22:16:49.513

您的 ZF2 模块定义的内容`getConfig()`与所有其他模块配置合并，如果某些配置键发生冲突，最终被加载的模块替换。因此，您`getConfig()`已经影响了整个应用程序，其范围不仅限于您的模块。

# .net - 带有位掩码的正则表达式？

> ID：11850643
> 
> 赞同：4
> 
> 时间：2012-08-07T16:55:49.120
> 
> 标签：.net, regex, bitmask

我有一个部分二进制数据流，我想在字符串中某个位置的字节中设置某个位时进行匹配。

这是 .NET 中的现有系统，使用`System.Text.RegularExpressions`它配置了许多模式 - 当某些模式匹配时，匹配会触发一个动作。

我正在连接一个设备，其中一个指标仅在位域中可用。

我能看到的唯一选择是匹配设置了该位的所有字节的整个等价类。

这是一个梅特勒-托利多秤界面。

流看起来像这样：

```
STX
SWA
SWB
SWC
WEIGHT (6 bytes ASCII)
TARE (6 bytes ASCII)
0x0D (CR)
(Optional checksum) 
```

其中`SWA`, `SWB`,`SWC`是状态字字节，我对 . 的第 3 位感兴趣`SWB`。

它们总是将所有这些状态字中的第 5 位设置为 1，以便`0x20`在未设置任何位时它是一个空格 ( )。所以在实践中，没有其他状态位通过，在( - ) 和 SPACE ( - )`SWB`之间交替。实际上，秤也可能在我不关心的其他状态下发送位 0 和 4。`(``0x50``01010000``0x20``00100000`

所以我可以匹配`..[\(all other equivalent characters]..{6}.{6}\r\0`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:02:37.423

对于正则表达式，字符是不可分割的原子单元，因此您需要创建一个字符类来匹配字符中的位。

有两种方法可以在字符类中包含或排除一组字符 - 通过单独列出它们，如在 中`[asdfg]`，或通过指定范围，如在 中`[a-z]`。

在最坏的情况下，您的组将包含覆盖单个位的 128 个元素。但是，如果您要匹配高阶位，则可以使用范围将连续字符组合在一起。

例如，匹配位 8 是

```
[\u0080-\u00FF] 
```

匹配位 7 是

```
[\u0040-\u007F\u00C0-\u00FF]` 
```

匹配位 6 是

```
[\u0020-\u003F\u0060-\u007F\u0060-\u007F\u00E0-\u00FF] 
```

等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:26:42.400

如果我理解正确，唯一可能的值`SWB`是 (in binary) `001xx00x`，您只需要使用正则表达式来区分`001x000x`(bit 3 = `0`) 和`001x100x`(bit 3 = `1`)。那是对的吗？如果是这样，那么您可以使用此字符类来检测位 3 = 的`0`时间：

```
[\u0020\u0021\u0030\u0031] 
```

而这个用于检测位 3 = 的`1`时间：

```
[\u0028\u0029\u0038\u0039] 
```

如果 有更多不同的可能值`SWB`，那么可能值得做一些更聪明的事情，但事实上，我认为没有必要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:19:05.233

除非我理解错了-您希望对字符串以外的事物应用正则表达式（在上面的示例中，位域）。

查看链接到方法以在流上应用正则表达式匹配的[这个线程。](https://stackoverflow.com/questions/1962220/apply-a-regex-on-stream)然后，您可以正确地将数据提供给匹配器，即

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T19:19:34.097

你有一个来自慢速输入设备的短的、固定长度的记录流。使用正则表达式来读取/解析这似乎是使用锤子来驱动螺丝。

为什么不直接将带有 a 的数据读`BinaryReader`入自定义类并将其作为对象处理呢？更容易理解，更容易维护。

像这样的东西：

```
 static void Main( string[] args )
    {
        using ( Stream       s      = OpenStream() )
        using ( BinaryReader reader = new BinaryReader( s , Encoding.ASCII ) )
        {
            foreach ( ScaleReading reading in ScaleReading.ReadInstances(reader) )
            {
                if ( !reading.IsValid ) continue ; // let's just skip invalid data, shall we?
                bool isInteresting = (reading.StatusB & 0x08) == 0x08 ;
                if ( isInteresting )
                {
                    ProcessInterestingReading(reading) ;
                }
            }
        }

        return;
    } 
```

`ScaleReading`看起来像这样的地方：

```
class ScaleReading
{

    private ScaleReading( byte[] data , int checkSum )
    {
        this.Data             = data                            ;
        this.CheckSum         = checkSum                        ;
        this.ComputedCheckSum = ComputeCheckSumFromData( data ) ;

        this.STX     = data[0] ;
        this.StatusA = data[1] ;
        this.StatusB = data[2] ;
        this.StatusC = data[3] ;
        this.Weight  = ToInteger( data, 4, 6 ) ;
        this.Tare    = ToInteger( data, 10,6 ) ;
        this.CR      = data[16] ;

    }

    private int ToInteger( byte[] data , int offset , int length )
    {
        char[] chs   = Encoding.ASCII.GetChars( data , offset , length ) ;
        string s     = new String( chs ) ;
        int    value = int.Parse( s ) ;

        return value ;
    }

    private int ComputeCheckSumFromData( byte[] data )
    {
        //TODO: compute checksum from data octets
        throw new NotImplementedException();
    }

    public bool IsValid
    {
        get
        {
            bool isValid = ComputedCheckSum == CheckSum
                        && STX              == '\x0002'  // expected STX char is actually STX
                        && CR               == '\r'      // expected CR  char is actually CR
                        ;
            return isValid ;
        }
    }

    public byte[] Data             { get ; private set ; }
    public int    ComputedCheckSum { get ; private set ; }
    public int    CheckSum         { get ; private set ; }

    public byte STX     { get ; private set ; } // ?
    public byte StatusA { get ; private set ; } // might want to make each of status word an enum
    public byte StatusB { get ; private set ; } // might want to make each of status word an enum
    public byte StatusC { get ; private set ; } // might want to make each of status word an enum
    public int  Weight  { get ; private set ; }
    public int  Tare    { get ; private set ; }
    public byte CR      { get ; private set ; }

    public static ScaleReading ReadInstance( BinaryReader reader )
    {
        ScaleReading instance = null;
        byte[]       data     = reader.ReadBytes( 17 );

        if ( data.Length > 0 )
        {
            if ( data.Length != 17 ) throw new InvalidDataException() ;

            int checkSum = reader.ReadInt32() ;
            instance     = new ScaleReading( data , checkSum );

        }

        return instance;

    }

    public static IEnumerable<ScaleReading> ReadInstances( BinaryReader reader )
    {
        for ( ScaleReading instance = ReadInstance(reader) ; instance != null ; instance = ReadInstance(reader) )
        {
            yield return instance ;
        }
    }

} 
```

# css - IE下日文字符渲染不统一

> ID：11850645
> 
> 赞同：0
> 
> 时间：2012-08-07T16:55:49.973
> 
> 标签：css, internet-explorer, fonts

当我为我的客户开发一个日本网站时，我遇到了以下情况：

![在此处输入图像描述](../Images/2cc8ff523a23175207be464d5aa76b3a.png) 在屏幕截图中，平假名/片假名渲染和汉字渲染看起来像是使用了两种不同的字体

在谷歌浏览器和其他现代浏览器中：

![在此处输入图像描述](../Images/5c79955c65eaaf0d1caf043f819ed689.png)

不仅限于日语，如果我使用简体中文（GB2312），也会出现这种问题；繁体中文（Big5）没有这个问题

IE中的渲染看起来很糟糕，主要观众将使用IE，我该如何解决这个问题？

**我没有在 CSS 中指定任何字体**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:52:50.540

最有可能的是，渲染确实使用了两种（或更多）不同的字体。要解决此问题，请为内容指定一个字体列表，选择字体以便 a) 每个字体都包含您正在使用的所有字符，并且 b) 访问者将使用的计算机至少包含其中一种字体。

作为一个粗略的起点，请查看[http://en.wikipedia.org/wiki/List_of_Microsoft_Windows_fonts](http://en.wikipedia.org/wiki/List_of_Microsoft_Windows_fonts)

不同浏览器行为的原因是浏览器有不同的默认字体和回退策略（用于在浏览器的默认字体不包含所有需要的字符时选择备用字体）。

声明语言也是一个好主意：`<html lang="ja">`. 它可能会影响浏览器的字体选择，因此选择适合日文的字体。但是，当您在文档中指定字体时，这通常无关紧要。

# javascript - 当用户单击通知 Div 之外的任何位置时，使通知 Div 淡出

> ID：11850647
> 
> 赞同：0
> 
> 时间：2012-08-07T16:55:55.420
> 
> 标签：javascript, jquery

我正在制作具有通知“按钮”的网站。当用户单击此按钮时，通知 div 将出现在按钮的底部。

我想让它的行为像 facebook 中的通知一样。当用户单击通知 div 元素之外的任何位置时，通知将消失。

到目前为止，我已经成功地使通知 div 在单击通知按钮时淡入和淡出。我正在使用 jquery 来执行此操作。

但是，当用户单击通知 div 之外的任何位置时，我不知道如何使其淡出。

谁能帮我？

这是我制作的代码：

```
<div id="notifikasi" style="position:relative; cursor:pointer">Notification<sup style="padding: 2px 4px 2px 4px; background: red"></sup>
    <div id="theNotif" style="position: absolute; top: 20px; left: 0px; background: #fff; color: #000; border: solid 1px #999; z-index: 999; padding: 10px 20px 10px 0px; width:200px; display:none">
        <ul>
            <li>Some Notification</li>
            <li>Some Notification</li>
            <li>Some Notification</li>
        </ul>
    </div>
</div>

<script>
$('#notifikasi').click(function(){
    if($('#theNotif').css('display') == 'none'){
        $('#theNotif').fadeIn('fast');
    }
    else{
        $('#theNotif').fadeOut('fast');
    }
});
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:00:37.537

尝试这个：

```
$(document).mouseup(function (e)
{
    var myDiv = $("#theNotif");
    if (myDiv.has(e.target).length === 0)
        myDiv.hide();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:00:40.017

怎么样：

```
$('#notifikasi').click(function(){
    $('#theNotif').fadeIn('fast', function() {
        $(document).one('click', function(e) {
            $('#theNotif').fadeOut('fast');
        });
    });
});

// prevent triggering when clicking the actual notification
$('#theNotif').click(function() { return false; });​ 
```

[演示](http://jsfiddle.net/LZDXN/)

一旦通知淡入，一个一次性点击监听器将被添加到监听任何点击的文档中。

* * *

**编辑**

自己玩过这样的游戏后，我得出的结论`.one`并不像我最初想象的那么有用，因为它需要一些其他的解决方法。我使用它的原因是我不得不不断地听每一个文档点击，只是为了覆盖通知打开的场景。

相反，我决定使用绑定和取消绑定更简洁的方法。

```
function closeNotification(e) {
   if($(e.target).closest('#theNotif').length > 0) {
      // notification or child of notification was clicked; ignore
      return;
   }

   $('#theNotif').fadeOut('fast');
   $(document).unbind('click', closeNotification);
};

$('#notifikasi').click(function(){
    $('#theNotif').fadeIn('fast', function() {
        $(document).bind('click', closeNotification);
    });
}); 
```

[演示](http://jsfiddle.net/LZDXN/1/)

上面的代码在概念上与原始代码非常相似。淡入后，在文档中注册一个点击监听器。这一次，*在*文档点击监听器中进行检查，查看点击的元素是`#theNotif`还是 的子元素`#theNotif`，在这种情况下关闭函数立即退出。

否则，它会继续关闭通知，然后立即取消绑定侦听器。

请注意，您必须使用命名函数，而不是您可能在 jQuery 中使用的匿名内联函数，以便能够正确解除绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:20:29.877

当鼠标移动到notifikasi时设置一个变量（比如a = 1），当移动到外面时取消设置。对于 Notif 也是如此。现在

```
$(document).click(function(){
    if(a == 0){
        if($('#theNotif').css('display') == 'block' || $('#theNotif').css('display') == ''){
            $('#theNotif').fadeOut('fast');
        }
    }
}); 
```

# c++ - mysql c++客户端使用valgrind查找内存泄漏

> ID：11850650
> 
> 赞同：5
> 
> 时间：2012-08-07T16:56:00.337
> 
> 标签：c++, linux, memory-leaks, valgrind, memory-leak-detector

我正在使用 valgrind 来尝试追踪内存泄漏是从 mysql 分发的 mysql c++ 客户端。

在示例 (resultset.cpp) 和我自己的程序中，都有一个 56 字节的块没有被释放。在我自己的程序中，我将泄漏跟踪到对 mysql 客户端的调用。

以下是我运行测试时的结果：

```
valgrind --leak-check=full --show-reachable=yes ./my-executable

==29858== Memcheck, a memory error detector
==29858== Copyright (C) 2002-2009, and GNU GPL'd, by Julian Seward et al.
==29858== Using Valgrind-3.6.0.SVN-Debian and LibVEX; rerun with -h for copyright info
==29858== Command: ./my-executable
==29858==
==29858==
==29858== HEAP SUMMARY:
==29858==     in use at exit: 56 bytes in 1 blocks
==29858==   total heap usage: 693 allocs, 692 frees, 308,667 bytes allocated
==29858==
==29858== 56 bytes in 1 blocks are still reachable in loss record 1 of 1
==29858==    at 0x4C284A8: malloc (vg_replace_malloc.c:236)
==29858==    by 0x400D334: _dl_map_object_deps (dl-deps.c:506)
==29858==    by 0x4013652: dl_open_worker (dl-open.c:291)
==29858==    by 0x400E9C5: _dl_catch_error (dl-error.c:178)
==29858==    by 0x4012FF9: _dl_open (dl-open.c:583)
==29858==    by 0x7077BCF: do_dlopen (dl-libc.c:86)
==29858==    by 0x400E9C5: _dl_catch_error (dl-error.c:178)
==29858==    by 0x7077D26: __libc_dlopen_mode (dl-libc.c:47)
==29858==    by 0x72E5FEB: pthread_cancel_init (unwind-forcedunwind.c:53)
==29858==    by 0x72E614B: _Unwind_ForcedUnwind (unwind-forcedunwind.c:126)
==29858==    by 0x72E408F: __pthread_unwind (unwind.c:130)
==29858==    by 0x72DDEB4: pthread_exit (pthreadP.h:265)
==29858==
==29858== LEAK SUMMARY:
==29858==    definitely lost: 0 bytes in 0 blocks
==29858==    indirectly lost: 0 bytes in 0 blocks
==29858==      possibly lost: 0 bytes in 0 blocks
==29858==    still reachable: 56 bytes in 1 blocks
==29858==         suppressed: 0 bytes in 0 blocks
==29858==
==29858== For counts of detected and suppressed errors, rerun with: -v
==29858== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 8 from 6) 
```

我对此有几个问题：

1.  我应该如何解释 --show-reachable 块？
2.  该块对我尝试将错误归零有用吗？
3.  如果该块没有用，valgrind 是否有另一种机制可以帮助我追踪泄漏？
4.  如果没有，是否有其他工具（希望是 Linux 上的 OSS）来帮助我缩小范围？

提前致谢..

**更新：**这是我在系统上找到的用于定义 pthread_exit 的代码。我不确定这是被调用的实际来源。但是，如果是这样，任何人都可以解释可能出了什么问题吗？

```
void
pthread_exit (void *retval)
{
    /*  specific to PTHREAD_TO_WINTHREAD  */

    ExitThread ((DWORD) ((size_t) retval));  /*  thread becomes signalled so its death can be waited upon  */
    /*NOTREACHED*/
    assert (0); return;  /*  void fnc; can't return an error code  */
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T17:00:58.987

可访问仅意味着当程序退出时，这些块在范围内具有引用它们的有效指针，这表明程序在退出时没有显式释放所有内容，因为它依赖于底层操作系统来执行此操作。您应该寻找的是*丢失*的块，其中内存块丢失了对它们的所有引用并且不能再被释放。

因此，这 56 个字节可能是在 main 中分配的，这并没有明确释放它们。您发布的内容没有显示内存泄漏。它显示 main 释放所有内容，但 main 分配的内容除外，因为 main 假设当它死时，所有内存都将由内核回收。

具体来说，它是 pthread（主要）做出了这个假设（这是对过去 15 年以上在生产中发现的所有内容的该死的有效假设）。释放在退出时仍然具有有效引用的块的需要是一个有争议的点，但对于这个特定的问题，所有需要提到的是做出了假设。

**编辑**

它实际上并没有在退出时清理某些东西，但正如解释的那样，一旦它到达那个点，`pthread_exit()`它可能不需要（或者很可能*不需要）。*

# regex - 使用正则表达式获取文本

> ID：11850654
> 
> 赞同：0
> 
> 时间：2012-08-07T16:56:11.577
> 
> 标签：regex, preg-replace, preg-match

我的句子如下：

`First learning of regular expression.`

`First learning`而且我只想`expression`通过正则表达式进行提取。

我从哪里开始/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:08:04.183

正如已经指出的那样，像您要求的那样匹配文字字符串是不寻常的，但更常见的是匹配模式，例如几个单词字符后跟一个空格字符等......

这是一个匹配几个单词字符（az、AZ、0-9 和 _）的模式，后跟一个空格，然后是几个单词字符等......它最终捕获了三个组。第一组将匹配前两个单词，第二部分匹配单词，最后一部分匹配第五个单词和前面的空格。

```
$words = "First learning of regular expression.";
preg_match(/(\w+\s\w+)\s(\w+\s\w+)(\s\w+)/, $words, $matches);
$result = matches[1]+matches[3]; 
```

我希望这符合您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T16:58:46.617

正则表达式用于模式匹配，这意味着我们需要知道要匹配的模式。

如果你真的只想要这些字符串，你只需使用`First learning`和`expression`作为你的模式。

正如@orique 所说，这有点毫无意义；你不需要RegEx。如果您想要更复杂的东西，则需要解释您要匹配的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T16:59:12.873

正则表达式通常不像您正在做的那样用于匹配文字文本，而是用于匹配文本模式。如果您坚持使用正则表达式，则必须匹配琐碎的表达式

```
(First learning|expression) 
```

# java - 如何在 JRE 上禁用 IPv6 堆栈用于 IPv4 IP？

> ID：11850655
> 
> 赞同：48
> 
> 时间：2012-08-07T16:56:16.863
> 
> 标签：java, jvm, ipv6, jvm-arguments

正如您在下面的屏幕截图中看到的那样，eclipse 和 Android SDK 管理器（以及其他 Java 程序）正在尝试通过 IPv6 TCP/IP 堆栈连接到 IPv4 Internet IP，而 Proxifier（代理管理器程序，没关系）无法支持。

![Eclipse 连接到 Internet 失败](../Images/f23526105b4cc103b690a79ec0e2162a.png)![Android SDK Manager 连接互联网失败](../Images/d041ce92fd6f04ef72eb7e8d89b2bd82.png)

如何在 Java 中禁用 IPv6？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2012-08-07T18:03:51.800

我想将它用于一些我无法控制运行该 Java 应用程序的程序，因此以这个`_JAVA_OPTIONS=-Djava.net.preferIPv4Stack=true`环境变量结束。[（在这里](http://mindprod.com/jgloss/javaexe.html#JAVAOPTIONS)阅读 _JAVA_OPTIONS ）

如果您使用的是 Windows，只需在 Windows cmd 上运行此命令：
`setx _JAVA_OPTIONS -Djava.net.preferIPv4Stack=true`

感谢 Jason Nichols 提醒这个 JVM 参数 :)

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-08-07T17:01:43.437

你试过吗（从命令行）

```
-Djava.net.preferIPv4Stack=true 
```

或（来自您的代码）

```
System.setProperty("java.net.preferIPv4Stack" , "true"); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-01-17T20:51:14.147

也许有点晚了，但对我来说，这两种解决方案都没有奏效。所以我包括了这个选项，因为它在[这里](https://serverfault.com/questions/390840/how-does-one-get-tomcat-to-bind-to-ipv4-address)说明：

```
-Djava.net.preferIPv4Addresses=true 
```

而且以下我在文件 /etc/sysctl.conf 的末尾添加了一行

```
net.ipv6.conf.all.disable_ipv6 = 1 
```

和

```
sudo sysctl -p 
```

正如这里所解释的[那样](https://pario.no/2011/12/09/disable-ipv6-on-ubuntu-11-10/)。为了检查 ipv6 是否被禁用，只需执行：

```
ip a | grep inet 
```

# php - xbtit annouce external without pid

> ID：11850659
> 
> 赞同：0
> 
> 时间：2012-08-07T16:56:30.490
> 
> 标签：php, bittorrent

我安装了脚本“ [xbtit](https://sourceforge.net/projects/xbtit/) ”，我希望使用带有外部种子的 php 宣布。

当我向外部发送新的 torrent 时，一切运行正常，但是当我在客户端中添加 .torrent 时，我收到一条错误消息，告诉我用 PID 重新加载 torrent，但它是外部 torrent，我停用了拒绝设置跟踪器！

如果有人知道解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T07:08:56.000

尝试删除（或评论）这部分`announce.php`：

```
if ($pid=="" || !$pid)
   show_error("Please redownload the torrent. PID system is active and pid was not found in the torrent");
} 
```

它应该工作

# apache - 如何重定向直接点击

> ID：11850664
> 
> 赞同：1
> 
> 时间：2012-08-07T16:56:57.507
> 
> 标签：apache, .htaccess

我确定以前有人问过这个问题，但我不知道它会叫什么。

我做了一个快速的谷歌搜索，并在这里搜索。

也许最好问一下，我如何重定向`http://site.com/shop`到指定的 URL，`http://othersite.com/page`而不影响它`http://site.com/shop/?q=test`或任何其他 $_GET。

```
RewriteRule ^shop http://othersite.com/page [R=301,L] 
```

工作正常，除了它还会影响`http://site.com/shop/?q=test`我想要工作的链接。

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:03:43.383

您可以使用 mod_rewrite 来匹配查询字符串（或查看是否没有查询字符串）：

```
RewriteEngine On
# blank query string
RewriteCond %{QUERY_STRING} ^$
# check host
RewriteCond %{HTTP_HOST} site\.com$ [NC]

RewriteRule ^shop/?$ http://othersite.com/page [R=301,L] 
```

# css - 如何打破 CSS 继承？

> ID：11850665
> 
> 赞同：9
> 
> 时间：2012-08-07T16:57:12.720
> 
> 标签：css

我创建了一个网络小部件。我的客户放在他们的网站上。基本上在加载时它会调用 web 服务并加载特定于客户端的数据。

结果它看起来像：

```
<div class="widget">
   <div class="container">
   </div>
</div> 
```

我动态地将 CSS 样式应用于我的小部件类。看起来与我们的企业风格一致。

问题是当客户端应用程序样式覆盖我在运行时应用的样式时。

例如，如果客户有，它会覆盖我的样式：

```
body {
  margin: 0 auto;
  padding: 0;
  width: 90%;
  font: 70%/1.4 Verdana, Georgia, Times, "Times New Roman";
} 
```

有没有办法打破继承？只是说具有类小部件样式的任何 div 都不会继承父样式。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T17:03:23.170

我不认为你可以打破 CSS 继承，但你可以尝试通过遵循 CSS 特异性规则来规避它。

一篇好的特异性文章

[http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

尝试`!important`在小部件中添加样式以使其具有比默认样式更高的特异性。

```
#myWidget{
    font: 100%/1 "Times New Roman", Serif !important;
} 
```

**编辑**

如果客户端也在使用`!important`它可能会导致问题。如果您可以通过示例设置 jsFiddle.com，我们可以帮助您找到问题。

我希望这会有所帮助！

**编辑2**

请注意，添加路径`!important`应该是最后的手段，因为它是样式规则的“王牌”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:08:48.587

您不能强制元素不继承父样式。

但是，您可以覆盖您不想更改的所有可能的样式。如果您的 CSS 特异性高于客户的特异性，那么您的样式将在页面上占主导地位/表达。

看：

[CSS 特异性来自 css-tricks.com](http://css-tricks.com/specifics-on-css-specificity/)

根据您的示例，使用下面的代码将比`body`声明更具体，因此覆盖：

```
.widget .container {
    font-family: Arial;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:03:09.623

您不能这样破坏样式继承，但可以确保您的样式更重要或以正确的顺序加载，以便您的样式排在首位。

看看`!important`标签。

或者，如果您在他们的样式表之后加载您的样式表，那么您的样式表将成为先例（除非他们的样式表是内联的）。您可以在正文加载后使用 Javascript 加载样式（但是您会得到“闪烁”效果）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T17:10:40.083

你也可以试试`inline styling`。内联样式具有最高优先级。如果客户端覆盖使用导入的样式表，这将起作用。

就像其他人提到的那样，另一种选择是`!important`.

您还可以在[http://www.w3.org/TR/CSS2/cascade.html](http://www.w3.org/TR/CSS2/cascade.html)阅读相关规范，其中准确描述了它们的级联方式。如果上述技巧不起作用，也许规格会给你一个线索，或者你会确定这是不可能的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-10-22T07:49:05.110

使用 !important css 属性被认为是一种不好的做法。因为它引入了优先级冲突的可能性，并且从长远来看使得排除 css 故障变得极其困难。

解决这个问题的一个不那么侵入性的方法是用一个 id 来分隔你的小部件，并在你的样式表中，使用“通用”选择器重置一些最重要的样式声明，例如：

```
#myWidget *{
  margin: 0;
  padding: 0;
  background: none;
  border: none;
} 
```

例如。然后，专门定义您的覆盖。

# javascript - jquery 不会在 IE 中加载内容

> ID：11850673
> 
> 赞同：-1
> 
> 时间：2012-08-07T16:57:46.240
> 
> 标签：javascript, jquery, internet-explorer, division

我在 IE 中预览网站时遇到问题。对于所有其他浏览器，该网站运行良好，但不适用于邪恶的浏览器。我一直在尝试解决这个问题，但没有成功。我想我可能没有想法了。:/ 有没有人可以指出我正确的方向并帮助我解决问题。

在这个地址可以看到网站：http: [//www.flyingcowproduction.com/platinumlimoservices](http://www.flyingcowproduction.com/platinumlimoservices)

如果您单击任何菜单按钮，jquery 将不会在 IE 中加载内容:(

非常非常感谢提前

最好的祝福，

-达沃林

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:06:10.173

您的 javascript 在此行中断：

```
var iframe = $("#jQuery_history")[0].contentWindow.window; 
```

jquery.history.js，第 33 行无法获取属性“contentWindow”的值：对象为空或未定义

* * *

如果您转到服务页面，它会再次中断

```
showArea(id[0]); 
```

PageNavigation.js，第 296 行字符 3 'showArea' 未定义

第二个可能只是由于第一个错误而发生。

* * *

**PS - 在 IE 中，按 F12 并使用脚本调试器，你可以在谷歌的帮助下解决这个问题。**

# php - PHP正则表达式崩溃apache

> ID：11850676
> 
> 赞同：10
> 
> 时间：2012-08-07T16:58:01.140
> 
> 标签：php, regex, windows, apache

我有一个匹配模板系统的正则表达式，不幸的是，它似乎在一些适度琐碎的查找中使 apache （它在 Windows 上运行）崩溃。我已经研究了这个问题，并且有一些关于增加堆栈大小等的建议，但这些建议似乎都不起作用，而且我真的不喜欢通过增加限制来处理这些问题，因为它通常只是将 bug 推到了未来。

无论如何，关于如何更改正则表达式以使其不太可能出错的任何想法？

这个想法是抓住最里面的块（在这种情况下`{block:test}This should be caught first!{/block:test}`），然后我将 str_replace 出开始/结束标签并通过正则表达式重新运行整个事情，直到没有剩下的块。

正则表达式：

```
~(?P<opening>{(?P<inverse>[!])?block:(?P<name>[a-z0-9\s_-]+)})(?P<contents>(?:(?!{/?block:[0-9a-z-_]+}).)*)(?P<closing>{/block:\3})~ism 
```

样本模板：

```
<div class="f_sponsors s_banners">
    <div class="s_previous">&laquo;</div>
    <div class="s_sponsors">
        <ul>
            {block:sponsors}
            <li>
                <a href="{var:url}" target="_blank">
                    <img src="image/160x126/{var:image}" alt="{var:name}" title="{var:name}" />
                </a>
            {block:test}This should be caught first!{/block:test}
            </li>
            {/block:sponsors}
        </ul>
    </div>
    <div class="s_next">&raquo;</div>
</div> 
```

我想这是一个长镜头。:(

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:09:51.843

您可以使用`atomic group: (?>...)`or来抑制/限制回溯并通过技术`possessive quantifiers: ?+ *+ ++..`加速匹配。`unrolling loop`我的解决方案：

`\{block:(\w++)\}([^<{]++(?:(?!\{\/?block:\1\b)[<{][^<{]*+)*+)\{/block:\1\}`

我已经从[http://regexr.com?31p03](http://regexr.com?31p03)进行了测试。

匹配`{block:sponsors}...{/block:sponsors}`：
`\{block:(sponsors)\}([^<{]++(?:(?!\{\/?block:\1\b)[<{][^<{]*+)*+)\{/block:\1\}`
[http ://regexr.com?31rb3](http://regexr.com?31rb3)

匹配`{block:test}...{/block:test}`：
`\{block:(test)\}([^<{]++(?:(?!\{\/?block:\1\b)[<{][^<{]*+)*+)\{/block:\1\}`
[http ://regexr.com?31rb6](http://regexr.com?31rb6)

另一个解决方案：
在 PCRE 源代码中，您可以从以下位置删除注释`config.h`：
`/* #undef NO_RECURSE */`

以下文本副本来自`config.h`：
PCRE 使用递归函数调用来处理匹配时的回溯。这有时可能是堆栈大小有限的系统的问题。定义 NO_RECURSE 以获取在 match() 函数中不使用递归的版本；相反，它通过使用 pcre_recurse_malloc() 创建自己的堆栈以从堆中获取内存。

或者你可以改变`pcre.backtrack_limit`和`pcre.recursion_limit`从`php.ini`（http://www.php.net/manual/en/pcre.configuration.php）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T02:52:55.613

试试这个：

```
'~(?P<opening>\{(?P<inverse>[!])?block:(?P<name>[a-z0-9\s_-]+)\})(?P<contents>[^{]*(?:\{(?!/block:(?P=name)\})[^{]*)*)(?P<closing>\{/block:(?P=name)\})~i' 
```

或者，以可读的形式：

```
'~(?P<opening>
  \{
  (?P<inverse>[!])?
  block:
  (?P<name>[a-z0-9\s_-]+)
  \}
)
(?P<contents>
  [^{]*(?:\{(?!/block:(?P=name)\})[^{]*)*
)
(?P<closing>
  \{
  /block:(?P=name)
  \}
)~ix' 
```

最重要的部分是在`(?P<contents>..)`组中：

```
[^{]*(?:\{(?!/block:(?P=name)\})[^{]*)* 
```

一开始，我们唯一感兴趣的字符是左大括号，所以我们可以用 .slurp 任何其他字符`[^{]*`。只有在我们看到 a 之后，我们才会检查它是否是标签`{`的开头。`{/block}`如果不是，我们继续消费它并开始扫描下一个，并根据需要重复。

`{block:sponsors}`使用 RegexBuddy，我通过将光标放在标记开头并进行调试来测试每个正则表达式。然后我从结束`{/block:sponsors}`标记中删除了结束大括号以强制匹配失败并再次调试它。你的正则表达式成功了 940 步，失败了 2265 步。我的成功了 57 步，失败了 83 步。

在旁注中，我删除了`s`修饰符是因为我没有使用点 ( `.`)，而`m`修饰符是因为它从来不需要。我还使用了命名的反向引用 `(?P=name)`，而不是`\3`按照@DaveRandom 的优秀建议。而且我避开了所有的大括号（`{`和`}`），因为我发现这样更容易阅读。

* * *

**编辑：**如果你想匹配*最里面*的命名块，改变正则表达式的中间部分：

```
(?P<contents>
  [^{]*(?:\{(?!/block:(?P=name)\})[^{]*)*
) 
```

...对此（正如@Kobi 在他的评论中所建议的那样）：

```
(?P<contents>
  [^{]*(?:\{(?!/?block:[a-z0-9\s_-]+\})[^{]*)*
) 
```

最初，该`(?P<opening>...)`组会抓取它看到的第一个开始标签，然后该`(?P<contents>..)`组会消费任何东西——包括其他标签——只要它们不是与该`(?P<opening>...)`组找到的结束标签匹配的结束标签。（然后`(?P<closing>...)`小组会继续消费。）

现在，该`(?P<contents>...)`组拒绝匹配*任何*标签，打开或关闭（注意`/?`开头的），无论名称是什么。所以正则表达式最初开始匹配`{block:sponsors}`标签，但当它遇到`{block:test}`标签时，它会放弃匹配并返回搜索开始标签。它再次从`{block:test}`标签开始，这一次在找到结束标签时成功完成匹配`{/block:test}`。

像这样描述它听起来效率低下，但事实并非如此。我之前描述的技巧，啜饮非牙套，淹没了这些错误开始的影响。在几乎每个位置都进行负前瞻的地方，现在只有在遇到`{`. 正如@godspeedlee 建议的那样，您甚至可以使用所有格量词：

```
(?P<contents>
  [^{]*+(?:\{(?!/?block:[a-z0-9\s_-]+\})[^{]*+)*+
) 
```

...因为你知道它永远不会消耗它以后必须回馈的任何东西。这会加快速度，但这并不是必需的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-15T08:43:43.297

解决方案是否必须是单个正则表达式？一种更有效的方法可能是简单地查找第一次出现的`{/block:`（可能是简单的字符串搜索或正则表达式），然后从该点向后搜索以找到其匹配的开始标签，适当地替换跨度并重复直到没有更多块。如果每次都从模板顶部开始查找第*一个*结束标记，那么这将为您提供嵌套最深的块。

镜像算法也可以工作 - 查找最后一个开始标签，然后从那里向前搜索相应的结束标签：

```
<?php

$template = //...

while(true) {
  $last_open_tag = strrpos($template, '{block:');
  $last_inverted_tag = strrpos($template, '{!block:');
  // $block_start is the index of the '{' of the last opening block tag in the
  // template, or false if there are no more block tags left
  $block_start = max($last_open_tag, $last_inverted_tag);
  if($block_start === false) {
    // all done
    break;
  } else {
    // extract the block name (the foo in {block:foo}) - from the character
    // after the next : to the character before the next }, inclusive
    $block_name_start = strpos($template, ':', $block_start) + 1;
    $block_name = substr($template, $block_name_start,
        strcspn($template, '}', $block_name_start));

    // we now have the start tag and the block name, next find the end tag.
    // $block_end is the index of the '{' of the next closing block tag after
    // $block_start.  If this doesn't match the opening tag something is wrong.
    $block_end = strpos($template, '{/block:', $block_start);
    if(strpos($template, $block_name.'}', $block_end + 8) !== $block_end + 8) {
      // non-matching tag
      print("Non-matching tag found\n");
      break;
    } else {
      // now we have found the innermost block
      // - its start tag begins at $block_start
      // - its content begins at
      //   (strpos($template, '}', $block_start) + 1)
      // - its content ends at $block_end
      // - its end tag ends at ($block_end + strlen($block_name) + 9)
      //   [9 being the length of '{/block:' plus '}']
      // - the start tag was inverted iff $block_start === $last_inverted_tag
      $template = // do whatever you need to do to replace the template
    }
  }
}

echo $template; 
```

# php - 如何在 PHP 中配置多个 doc_root？

> ID：11850677
> 
> 赞同：0
> 
> 时间：2012-08-07T16:58:01.003
> 
> 标签：php, configuration, nginx

我正在添加第二个域，托管在除前一个文件夹之外的另一个文件夹中。无论如何要添加另一个目录来`doc_root`配置？我曾尝试使用逗号和空格来分隔两条路径（例如`doc_root = "/path1 /path2"`），但它们都不起作用。我必须省略这个配置吗？我认为它不安全。

（我知道我可以将它们放在一个路径中，但重写我在脚本中使用的那些绝对路径将是一项非常艰巨的工作）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T23:18:55.137

我偶然在PHP的手动安装页面上发现了这个评论......

> Bill dot Rook 在 Gmail dot com 18-Sep-2005 03:09
> 
> doc_root =".;c:\inetpub\wwwroot" 似乎确实适用于虚拟网站。这可能是一个更好的选择，然后注释掉该行。

[http://php.net/manual/bg/install.windows.manual.php](http://php.net/manual/bg/install.windows.manual.php)

# php - 在 PHP 中拆分 Xpath

> ID：11850681
> 
> 赞同：0
> 
> 时间：2012-08-07T16:58:17.390
> 
> 标签：php, xpath

将被解析的 HTML：

```
<tr>
 <td>18</td>
 <td>1:0 <img src="./img/goal.gif"></td>
 <td>18</td>
 <td>Player1</td>
 <td>Team1</td>
</tr>
<tr>
 <td>34</td>
 <td><img src="./img/sub.gif"></td>
 <td>13 <img src="./img/in.gif"><br>11 <img src="./img/out.gif"></td>
 <td>Player1<br>Player2</td>
 <td>Team2</td>
</tr> 
```

td[3] 和 td[4] 有时有两个值，当有两个值（除以 br）时，我需要将它们拆分，以便行（在本例中为 tr[2]）显示两次，一次与Player1 和 Player2 都这样：

```
tr[1] 18, goal, 18, Player1, Team1
tr[2] 34, in, 13, Player1, Team2
tr[2] 34, out, 11, Player2, Team2 
```

所以基本上休息前的所有内容都是一个条目的一部分，休息之后的所有内容都是另一个条目。当只有一个值时，两行都必须有它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T22:40:49.597

我认为这在 XPath 1 中是不可能的，但在 XPath 2 中你可以使用：

```
/tr/(if (.//br) then 
(td[1], "in",  td[3]/text()[1], td[4]/text()[1], td[5],
 td[1], "out", td[3]/text()[2], td[4]/text()[2], td[5])
else (td[1], "goal", td[3], td[4], td[5])
) 
```

使用 //br 来检测它是哪种情况，并返回相应的元组。

由于序列不能嵌套，所以这个查询的结果值是这样的单个序列（带有类型注释）

```
sequence: (
  node: 18, string: goal, node: 18, node: Player1, node: Team1, 
  node: 34, string: in, node: 13, node: Player1, node: Team2, 
  node: 34, string: out, node: 11, node: Player2, node: Team2) 
```

您可以在每 5 个元素处轻松拆分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:14:42.477

我会假设 <br/> 会工作。但是，请注意您使用的是 <br>（缺少正斜杠）。这会改变你的代码吗？

另外，为什么不使用一些代码来诱导某些行的“rowspan”或“colspan”？

# java - 是否有包装非通用集合的通用集合库？

> ID：11850684
> 
> 赞同：0
> 
> 时间：2012-08-07T16:58:32.403
> 
> 标签：java, java1.4

我要工作的是有点过时的 JVM，它只支持 Java 1.4。我想在我的代码中使用泛型，这可以根据这篇文章[http://www.ibm.com/developerworks/java/library/j-jtp02277/index.html](http://www.ibm.com/developerworks/java/library/j-jtp02277/index.html)来实现。不幸的是，我们库中的 Collections 类不是通用的，它们不能被替换（这意味着我不能使用[http://download.oracle.com/otndocs/jcp/jsr14-2.4-ea-demo-oth-JPR/](http://download.oracle.com/otndocs/jcp/jsr14-2.4-ea-demo-oth-JPR/)）。一个明显的解决方案是为所有主要类编写通用包装器 - ArrayList、HashMap、HashSet 并创建通用接口 Map 等。这是一项相当大的工作，所以我想知道是否可能已经有一个提供此功能的库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:07:10.857

你可以为 JVM 1.4 编译你的代码吗？

如果您的代码是为 Java5（6 或 7）编译的，您可能会收到“类文件中的错误版本”-错误。

如果您使用任何已编译的库，都必须针对 Java 1.4 进行编译。

# django - Django 评论应用中后续评论的电子邮件通知

> ID：11850693
> 
> 赞同：1
> 
> 时间：2012-08-07T16:59:09.953
> 
> 标签：django, email, django-forms, django-signals, django-comments

我正在使用股票[Django 评论框架](https://docs.djangoproject.com/en/dev/ref/contrib/comments/)。将复选框添加到评论表单以允许评论者收到未来评论的通知的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:14:42.407

这没有内置到[django 评论框架](https://docs.djangoproject.com/en/dev/ref/contrib/comments/)中，所以你必须自己做。

您可以对`Comment`模型进行子类化以包含一个布尔字段，该字段跟踪评论者是否希望收到有关该评论的通知，然后包装`post_comment`视图以检测此设置 - 对于每个新评论，收集该对象的所有其他评论并创建想要通知的用户列表，然后使用[`django-notifications`](https://github.com/jtauber/django-notification/)或类似的方法实际发送通知。

在前端，您只需要覆盖`templates/comments/form.html`以包含您的新字段，这样就足够简单了。

这太高了，无法提供任何代码示例，因此您必须自己处理它，并在出现问题时回来。

# c# - 如何在 OData 的 EF Code First 模型中隐藏标识列

> ID：11850694
> 
> 赞同：0
> 
> 时间：2012-08-07T16:59:09.203
> 
> 标签：c#, entity-framework, odata

这确实是一个 EF Code First 问题，但有时 OData 的上下文会有所不同。问题很简单。我们的基础 SQL Server 表/视图将标识列作为（代理）主键。它们还有一个“代码”字段，代表用户熟悉的唯一标识符。简单示例： CarModel: Id = 3, Code = 'Ford'; 我已成功创建 EF 模式和 OData 以使用“代码”字段作为导航键进行导航，使用数据注释，并且基础表/视图在这些列上有索引，因此这是可以接受的。但我真的很想将 Id 列作为键，并作为模型中的导航属性，但不让它显示在响应中。也许这就是 OData 部分有所作为的地方，因为我不希望对响应进行任何复杂的拦截和重塑。将列设置为“私有”甚至“内部”会在模型生成期间引发错误：“表 X 未定义键”

是否可以在 EF 模型中定义标识列，但不能将其作为 OData 实体/响应的一部分？

* * *

**编辑：**

所以，我下面的评论仍然有效。这对于标识/键列都不是一个好主意，“隐藏”它们也不会让模型正确编译。然而，感谢@mreyeros 的一些链接和 Vitek Karas 的 social.msdn 帖子，这里有一些注释。System.Data.Services 命名空间有一个`IgnorePropertiesAttribute`. 它允许“隐藏”模型中的属性。但是，正如 Vitek 所说，它目前仅适用于 ReflectionProvider，不适用于 EF。（如果您使用的是 NuGet 托管版本，则需要确保引用正确的库。

也就是说，流畅的配置 API*将*在 EF/OData 中工作：

```
modelBuilder.Entity<Foo>().Ignore(f => f.Password); 
```

然而，它不仅在响应中隐藏了一个属性，它还在模型和数据库中隐藏了它（这对于只读查询模型可能是可以的）。因此，如果您将导航键标记为隐藏，则模型将无法编译。如果您将任何其他属性标记为隐藏，但在 QueryInterceptor 中引用它，则会引发异常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-05-11T17:23:19.643

您需要做的是创建一个返回原始实体的投影子集的 odata 控制器。

```
//in WebApi Config Method
config.MapHttpAttributeRoutes();

ODataConventionModelBuilder builder = new ODataConventionModelBuilder();
builder.EntitySet<FullEntity>("FullData");
builder.EntitySet<SubsetEntity>("SubsetData");
config.Routes.MapODataServiceRoute("odata", "odata", builder.GetEdmModel());

config.Routes.MapHttpRoute(
  name: "DefaultApi",
  routeTemplate: "api/{controller}/{action}/{id}",
  defaults: new { id = RouteParameter.Optional, action = "GET" }
);
SetupJsonFormatters();
config.Filters.Add(new UncaughtErrorHandlingFilterAttribute()); 
```

...然后有两个 Odata 控制器，一个用于 FulLData，一个用于 SubsetData（具有不同的安全性），

```
namespace myapp.Web.OData.Controllers
{
    public class SubsetDataController : ODataController
    {
        private readonly IWarehouseRepository<FullEntity> _fullRepository;
        private readonly IUserRepository _userRepository;

        public SubsetDataController(
            IWarehouseRepository<fullEntity> fullRepository,
            IUserRepository userRepository
            )
        {
            _fullRepository = fullRepository;
            _userRepository = userRepository;
        }

public IQueryable<SubsetEntity> Get()
        {
            Object webHostHttpRequestContext = Request.Properties["MS_RequestContext"];
            System.Security.Claims.ClaimsPrincipal principal =
                (System.Security.Claims.ClaimsPrincipal)
                    webHostHttpRequestContext.GetType()
                        .GetProperty("Principal")
                        .GetValue(webHostHttpRequestContext, null);
            if (!principal.Identity.IsAuthenticated)
                throw new Exception("user is not authenticated cannot perform OData query");

            //do security in here

            //irrelevant but this just allows use of data by Word and Excel.
            if (Request.Headers.Accept.Count == 0)
                Request.Headers.Add("Accept", "application/atom+xml");

            return _fullRepository.Query().Select( b=>
                    new SubsetDataListEntity
                    {
                        Id = b.Id,
                        bitofData = b.bitofData
                    }
          } //end of query
   } //end of class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:40:34.460

我不是 100% 确定是否是这种情况，但是，如果将“ScaffoldColumn(false)”属性应用于要隐藏的属性，它可能会起作用。这是该属性的[MSDN条目](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.scaffoldcolumnattribute.aspx)

# intellij-idea - IntelliJ 有时不尊重断点

> ID：11850701
> 
> 赞同：6
> 
> 时间：2012-08-07T16:59:50.937
> 
> 标签：intellij-idea, breakpoints

我有以下代码：

```
/*01*/ final BlockingQueue<CsvFileRow> allRows = new LinkedBlockingQueue<CsvFileRow>();
/*02*/ ExecutorService exec = Executors.newFixedThreadPool(3);
/*03*/ Callable<Void> producer = new Callable<Void>() {
/*04*/   @Override
/*05*/   public Void call() throws Exception {
/*06*/     System.out.println("Before producer");
/*07*/     produceDataRows(allRows);
/*08*/     System.out.println(" After producer");
/*09*/     return null;
/*10*/   }
/*11*/ };
/*12*/ Callable<Void> consumer = new Callable<Void>() {
/*13*/   @Override
/*14*/   public Void call() throws Exception {
/*15*/     System.out.println("Before consumer");
/*16*/     consumeDataRows(allRows);
/*17*/     System.out.println(" After consumer");
/*18*/     return null;
/*19*/   }
/*20*/ };
/*21*/ exec.submit(producer);
/*22*/ exec.submit(consumer);
/*23*/ exec.shutdown();
/*24*/ exec.awaitTermination(10, TimeUnit.DAYS);
/*25*/ assert Boolean.TRUE; 
```

我在第 7、16、21 和 25 行有断点。运行代码在断点 21,7 和 25 处停止 - 跳过断点 16！但是，代码已经执行，请看输出：

```
Before producer
Before consumer
 After consumer
 After producer 
```

现在，如果我删除断点 7，那么调试器会在断点 21,16 和 25 处停止。

这是一个非常烦人的问题。事实上，在其他场景中，我注意到 IntelliJ 会忽略断点，这非常令人不安。

我错过了什么吗？

# tomcat - Tomcat 和 SSL，一个站点在 https 上，两个站点在 http 上

> ID：11850709
> 
> 赞同：0
> 
> 时间：2012-08-07T17:00:36.240
> 
> 标签：tomcat, ssl

我有一台带有 TOMCAT 的服务器，我想配置多个站点，我可以在 https 上配置一个站点，在 http 上配置其他站点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T20:10:51.427

是的，Tomcat 支持虚拟主机。下载您正在使用的主要版本的最新版本（假设您使用的是当前受支持的版本）并阅读 Virtual Hostinbg HOW-TO，它是 Tomcat 文档的一部分。

# objective-c - 在 initWithNib 分配另一个视图控制器

> ID：11850715
> 
> 赞同：0
> 
> 时间：2012-08-07T17:00:53.400
> 
> 标签：objective-c, ios, cocoa, ipad, ios4

我只是好奇是否可以说我有一个 webView 的单例属性，我试图在另一个 viewController 的初始化点分配。编译器正在生成指示“不兼容的指针类型”的错误。

我不确定它为什么这样做，因为该类的超类仍然是 UIViewController。这里的任何帮助将不胜感激。

谢谢。

下面的代码：

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {

    self = [super initWithNibName:nil bundle:nil];

    if (self) {

        // Work your initialising magic here as you normally would
        if ([[CartCheckout sharedInstance] universalVC]) {
            //self = [[CartCheckout sharedInstance] universalVC];
            NSLog(@"testing");
            self = [[CartCheckout sharedInstance] universalVC];
        }
        NSLog(@"initWithNibName allocated");
    }

    return self; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T05:31:37.553

发生这种情况是因为您尝试对其进行分配的实际实例的视图控制器的类型不正确，它们共享一个超类并不重要。

在这种情况下，self 是一种且只有一种类型，即视图控制器子类的类型。

此外，即使它们是相同的类型，Objective C 也不会让您用任何东西替换 init 方法中的类实例。

init 方法是实例分配方法，如果您返回指向您实际所在实例之外的其他内容的指针，您将立即崩溃。

所以你有两个问题，一是你试图将一个单例实例注入到一个 init 方法中，二是你试图劫持视图的容器。

这些都行不通。在需要时实例化正确类型的 viewController 以配合您的视图。

你想要的是这样的：

```
MyUniversalViewController *universalVC = [MyUniversalViewController alloc] initWithNibName:@"blabla 
```

尝试在构造函数中切换类型为时已晚。

# c++ - 如何在 C++ 中计时事件？

> ID：11850717
> 
> 赞同：4
> 
> 时间：2012-08-07T17:00:59.100
> 
> 标签：c++

我希望能够获得在我的 C++ 程序中做某事所需的纳秒数。

对象创建，函数完成它的时间等。

在`Java`中，我们会按照以下方式做一些事情：

```
 long now = System.currentTimeMillis();
    // stuff
    long diff = (System.currentTimeMillis() - now); 
```

你会如何在 C++ 中做同样的事情？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-07T19:35:14.820

标准 C++ 中的`<chrono>`库提供了执行此操作的最佳方法。这个库为时钟提供了一个标准的、类型安全的、通用的 API。

```
#include <chrono>
#include <iostream>

int main() {
    using std::chrono::duration_cast;
    using std::chrono::nanoseconds;
    typedef std::chrono::high_resolution_clock clock;

    auto start = clock::now();
    // stuff
    auto end = clock::now();
    std::cout << duration_cast<nanoseconds>(end-start).count() << "ns\n";
} 
```

时钟的实际分辨率会因实现而异，但此代码将始终以纳秒为单位显示结果，尽可能准确地给出实现的滴答周期。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:55:15.890

在 C++11 中，您可以使用 chrono 库执行此操作，其中 -

> 类模板 std::chrono::duration 表示一个时间间隔。它由 Rep 类型的滴答计数和滴答周期组成，其中滴答周期是编译时有理常数，表示从一个滴答到下一个滴答的秒数。

目前在 GCC 4.5.1 中实现。（还没有在 VC++ 中）。有关函数调用的Ideone.com[执行时间，请参阅](http://ideone.com/3VobQ)[cppreference.com](http://en.cppreference.com/w/cpp/chrono)的示例代码

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:03:10.063

看看`clock`和`clock_t`。对于您正在谈论的解决方案，我认为 C++ 中没有本机支持。要获得有意义的值，您必须对多次调用或构造进行计时，或者使用分析器（需要）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:02:53.443

多次询问和回答。

*   [如何在 Windows 上使用 C++ 进行高分辨率计时？](http://cplus.about.com/od/howtodothingsi2/a/timing.htm)
*   [C++ 在 Linux 上获取毫秒时间——clock() 似乎无法正常工作](https://stackoverflow.com/questions/588307/c-obtaining-milliseconds-time-on-linux-clock-doesnt-seem-to-work-properl)
*   [代码中的高分辨率计时部分](https://stackoverflow.com/questions/700392/high-resolution-timing-part-of-your-code)
*   [使用 C++ 和 Linux 的高分辨率计时器？](https://stackoverflow.com/questions/538609/high-resolution-timer-with-c-and-linux?lq=1)

如果你使用 C++11，你可以考虑[`chrono`](http://www.cplusplus.com/reference/std/chrono/).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T17:45:31.527

我今天早些时候问了这个确切的问题。我目前最好的解决方案是使用 SDL，并调用：

```
uint32 a_time = SDL_GetTicks(); // Return uint32 count of milliseconds since SDL_Init was called 
```

尽管这可能会给您带来很多开销，即使您只是使用计时器功能初始化 SDL。(SDL_Init(SDL_INIT_TIMER)。

希望这对您有所帮助 - 我决定将此作为解决方案，因为它是可移植的。

# c# - 如何从用户 c# windows 窗体获取输入

> ID：11850723
> 
> 赞同：-2
> 
> 时间：2012-08-07T17:01:30.950
> 
> 标签：c#, input, type-conversion

```
int value=Convert.int32.TryPase(textbox2.text, out Number); 
```

这是我的代码，我想使用“文本框”从用户那里获取输入，但是这个代码不起作用。

请告诉我如何以 int 值从用户那里获取输入。(c# gui)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:04:16.710

`TryPase`首先调用此方法`TryParse`，然后返回`bool`。所以你的代码应该是这样的：

```
int value;
if (!Convert.Int32.TryPase(textbox2.text, out value))
   //Show error 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:10:07.423

是的，安德烈是正确的。还有其他一些方法可以做到这一点，不使用布尔值

```
int value = Convert.ToInt32(textbox2.Text);
int value = Int32.Parse(textBox2.Text); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T13:16:27.760

```
int value;
if (Int32.TryParse(textbox2.Text), value)
{
    // display error
} 
```

另请参阅： [如何：将字符串转换为 int（C# 编程指南）](http://msdn.microsoft.com/en-us/library/bb397679.aspx)

# php - PHP 中的 SplFileObject 与 fopen

> ID：11850726
> 
> 赞同：17
> 
> 时间：2012-08-07T17:01:53.637
> 
> 标签：php, file-io, fopen, spl, splfileobject

与PHP`fopen`相比，使用的优缺点是什么？`SplFileObject`

据我所见，`SplFileObject`在适用的情况下抛出异常，这使得在`try...catch`用于错误处理时很方便。除此之外，还有其他理由推荐其中一个吗？

（奖励：为什么叫它`SplFileObject`？`Spl`代表什么？为什么不简单`FileObject`？）

**更新：**的一个限制`SplFileObject`是它（还）没有`close`成员函数。在某些情况下，这可能是一个问题（例如：[Unlink 和 SplFileObject](https://stackoverflow.com/questions/6066145/unlink-and-splfileobject)）。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-05-15T15:25:45.183

SPL 代表标准 PHP 库。

`SplFileObject`在内部使用创建的流资源`fopen`。所以你的问题应该是什么时候使用`SplFileObject`或直接使用流资源很有趣？

`SplFileObject`优点：

*   `SplFileObject`为文件操作提供 OOP 方法（`fread`在 PHP 5.5.11`fputcsv`中添加，在 PHP 5.4 中添加）。

*   `SplFileObject`实现了几个有用的 PHP 接口，以支持使用其他[SPL 迭代器](http://php.net/spl.iterators.php)来更好地操作您的文件。

`SplFileObject`主要缺点是它不能访问其内部流资源。PHP 函数最初是为了直接使用流资源而构建的。不提供访问其自己的内部流资源的事实`SplFileObject`使其无法与许多 PHP 内置函数一起使用：

*   [php 流过滤器](http://php.net/stream)的使用很差`SplFileObject`。您需要依赖`php://filter`元包装器，这限制了它们的用处。

*   无法使用`SplFileObject`with`cURL`

总而言之，`SplFileObject`流资源是不可互换的。**使用流资源和用户空间实现可以实现****任何使用，但反之则不然`SplFileObject``SplFileObject`**。

因此，根据用例使用创建的流资源`fopen`可能是比依赖`SplFileObject`.

至于 close 方法，你不需要一个......你只需将处理程序设置为 null 即可释放/关闭内部流资源。

```
$file = new SplFileObject('/path/to/my/file'); //the file handler is created
$file = null; //the file handler is closed 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T17:25:47.737

Spl 代表标准 PHP 库。

主要优点是面向对象，它更适合某些方法（不是所有方法，也就是说）。如果您必须提供用于处理文件的类（如自定义格式等），这是一个不错的选择，因为您可以继承`SplFileObject`并拥有已经内置的基本功能。

这里的主要问题是你想用你的代码实现什么——你需要打开一个文件一次，读取它的数据然后使用它，还是你需要用一个（甚至更多）文件做更复杂的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:20:05.103

Spl 是 PHP 中的一个标准库，可以制作很多不错的东西。

使用 SplFileObject 的一个很好的理由是它使您的代码面向对象。如果您愿意，您可以在自己的代码库中扩展该类，并使其在使用文件时做一些不错的事情，并且已经涵盖了基础知识。

# ios - iOS - XCode 4.4 - 使用分析的潜在内存泄漏

> ID：11850727
> 
> 赞同：0
> 
> 时间：2012-08-07T17:01:55.473
> 
> 标签：ios, memory

我在我的第一个 iPhone 应用程序上运行了分析，我发现了一些潜在的内存泄漏。该应用程序本身在模拟器上运行良好。我想做正确的事情并清除潜在的内存泄漏，但有些令人费解。也许有人可以在这里帮助我？

提前致谢。

码头。

**错误 1)**分析器显示“存储在 tempDate 和 tempAns 中的对象的潜在泄漏”

```
#import "Answer.h"

@implementation Answer
@synthesize answerTiming; 
@synthesize xPosition; 
@synthesize earlyOrLate; 
@synthesize hit; 

+ (Answer *) createAnswerWithTiming :(NSDate *)paramTiming andXPosition :(float) xPosition
{
NSDate * tempDate = [[NSDate alloc] initWithTimeInterval:0 sinceDate:paramTiming];
Answer * tempAns = [[Answer alloc] init ];
[tempAns setAnswerTiming:tempDate];
[tempDate release];
[tempAns setXPosition:xPosition]; 
[tempAns setEarlyOrLate:0];
[tempAns setHit:false];

return tempAns; 
}

- (void)dealloc {
[answerTiming release];
[self release];
[super dealloc]; 
}

@end 
```

**错误 2)**分析器显示（见下文）

```
- (void)viewDidLoad
{
[super viewDidLoad];

   ........
   ...

UIImage * perfectImage = [UIImage imageNamed: @"perfect.png"];
self.perfectImageView2 = [[UIImageView alloc]initWithImage:perfectImage]; 
```

// 方法返回具有 +1 保留计数的目标 C 内容

```
[self.perfectImageView2 setFrame:CGRectMake(145.0f,
                                            150.0f,
                                            self.perfectImageView2.image.size.width,
                                            self.perfectImageView2.image.size.height)];

self.view.backgroundColor = [UIColor whiteColor];

UIImage * levelUpImage = [UIImage imageNamed:@"levelup.png"];
self.levelUpImageView = [[UIImageView alloc] initWithImage:levelUpImage];
[self.levelUpImageView setFrame:CGRectMake(100.0f,
                                            400.0f,
                                            self.levelUpImageView.image.size.width,
                                            self.levelUpImageView.image.size.height)]; 
```

//对象泄漏，分配的对象在此执行路径的后面没有引用，并且保留计数为+1

```
self.view.backgroundColor = [UIColor whiteColor];
} 
```

**错误 3)**

```
- (NSMutableArray *) generateQuestionTapAnswers:(NSString *) answersString withFirstBeat:    (NSDate *) firstBeatTime
{
NSArray * notesToDraw = [answersString componentsSeparatedByCharactersInSet: [NSCharacterSet characterSetWithCharactersInString: @" "]];

float noteValueOffset = 0.0; 

NSMutableArray * answerArray = [[NSMutableArray alloc] init ]; 
```

// 方法返回一个具有 +1 保留计数的目标 C 对象

```
for (int i=1; i < notesToDraw.count; i++) // i = 0 is the time signature
{
 .....
}
return answerArray; 
```

// 对象作为拥有引用返回给调用者（单个保留计数转移给调用者） // 对象泄漏：分配并存储到 answerArray 中的对象是从名称 generateQuestionTapAnswers 不以 copy、mutableCopy 开头的方法返回的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:17:52.237

关于您的第一个和第三个警告，编译器将假定您将在“名称以`alloc`、`new`、`copy`或开头的方法”中创建一个对象`mutableCopy`（请参阅[高级内存管理编程指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmRules.html)）。因此，如果您要返回 +1 对象，请确保您的方法名称以这四个前缀之一开头。如果您创建一个没有这些前缀之一的 +1 对象，它会不高兴。因此，对于错误 #1，如果您将该方法重命名为`newAnswerWithTiming`，则该警告应该会消失。（但是，如果调用方法没有在它们之后清理，警告将被转移到该例程，但让我们一步一步来。）

同样对于错误＃3，如果您将该方法重命名为类似`newAnswerArrayFromQuestionTapAnswers`（或其他什么...我不确定我是否理解您的方法名称...只要确保它以 开头`new`），您同样会消除该警告. 在这两种情况下，只要确保在适当的时候释放它，因为调用这两个各自方法的人现在“拥有”这些对象并负责清理它们。

`[self release]`顺便说一句，您`dealloc`在讨论错误 #1 时不需要这样做。（坦率地说，我很惊讶它不会产生错误。）你不需要它，因为如果它还`self`没有`retainCount`为零，那么你一开始就不会到达`dealloc`。

Regarding error #2, how are the properties `perfectImageView2` and `levelUpImageView` defined? If `retain` or `strong`, you're creating something with a +2 `retainCount`, and you probably want to add an `autorelease` after the `alloc`/`init`.

# java - 根据 URL 应用网站品牌/功能

> ID：11850728
> 
> 赞同：0
> 
> 时间：2012-08-07T17:02:00.337
> 
> 标签：java, jsp, properties, themes

我正在创建一系列网站，它们将共享一个通用的 java 代码库，但每个网站都有不同的外观和感觉，并且对数据库的调用略有不同。每个站点都有一个唯一的 URL（www.siteA.com、www.siteB.com）。

必要的数据库信息存储在属性文件中，这些文件似乎在部署应用程序时加载（到 JBoss 4.2.3 服务器）。CSS 和图像位于静态文件夹中。

我想要的是：

*   用户输入 www.siteA.com
*   “无品牌”网站已初始化
*   Java（或任何需要）检查 URL 以查看要加载的文件
*   从 siteA 资源文件夹加载 siteA.properties 和 siteA.css
*   siteA 的自定义站点提供给客户端

如果输入 www.siteB.com，则会加载其所有信息。当我想添加一个新的站点 C 时，我将创建一个站点 C 资源文件夹，将 SiteC 版本的属性和 CSS 放入其中，底层公共代码应该注意注意到输入了 www.siteC.com 并抓取从新文件夹中。所有这些都应该发生，而不必重新部署所有站点共有的任何元素。

我想我已经大致弄清楚了如何让 CSS/images 工作，但我无法以这种方式加载属性文件。

这甚至可能吗？我什至无法找到有关该过程的高级讨论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T18:37:47.913

为什么不查找 HOST http 标头并使用 PHP 脚本输出每个服务器的相关信息。您可以使用存储在服务器某处的 HTML 文件中的文件来输出常见内容。

# javascript - 使用 jQuery 从 AJAX 结果中查找和执行/提取嵌入式 JavaScript

> ID：11850732
> 
> 赞同：0
> 
> 时间：2012-08-07T17:02:17.663
> 
> 标签：javascript, jquery, ajax

我正在执行 AJAX 请求以获取生成的 html 页面。我想在结果中找到一个特定的 div 并将其注入到请求来自的页面中。我还想包含可能位于此 div 内的嵌入式脚本或脚本链接。这是我想使用 AJAX 获得的页面的简单示例

```
<html>
<head>
    <script>alert("don't want this")</script>
</head>
<body>
<div id='findMe'>
    <p>Some content</p>
    <script>alert("want only this")</script>
</div>
<script>alert("don't want this")</script>
</body>
</html> 
```

所以我只想提取ID为findMe的div。这是我在执行请求的页面中的内容

```
<script>
$(document).ready(function(){

    $.ajax({
          url: "ajax.htm",
          success: function(data){  

            $(data).filter("#findMe").appendTo("#output");

          },
          dataType: "html"
    });

});
</script>

<div id='output'></div> 
```

但是缺少脚本标记，并且没有出现警报。它似乎已从 div 中取出。如果我做

```
console.log($(data)) 
```

我可以将每个脚本标签视为一个文档片段，但是在弹出之前我如何知道哪个在 div 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:05:01.490

你可以试试：

```
$(data).find('#findMe').appendTo('#output'); 
```

**或者**

```
$('<div/>').append(data).filter("#findMe").appendTo("#output"); 
```

附加`data`到演示`div`（DOM 中不存在）并对其进行过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:06:49.687

我认为您必须使用 .find() 而不是过滤当前 jQuery 集合的 .filter()：

```
$(data).find("#findMe").appendTo("#output"); 
```

但我不确定脚本标签是否会被执行..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T21:09:18.987

我不得不将结果视为 XML。使用 jQuery .find() 在 XML 对象中找到我要查找的元素，选择实际节点（数组 pos 0），将节点的内容转换为字符串，并注入输出 div。这是我发现执行仅包含在目标 div 中的脚本的唯一方法。

```
$.ajax({
    url: "ajax.htm",
    success: function (data){

        var node = $(data).find("#findMe")[0];

        if(node.xml)
        {
            $("#output").html(node.xml)
        }
        else if(new XMLSerializer())
        {
            $("#output").html((new XMLSerializer()).serializeToString(node));
        }
    },
    dataType: "xml"
}); 
```

# java - 如何在 Hibernate 中执行这样的查询？加入

> ID：11850735
> 
> 赞同：0
> 
> 时间：2012-08-07T17:02:20.607
> 
> 标签：java, hibernate, join

我有几个使用注释映射到数据库的对象类，需要一些帮助来解决如何组合 Hibernate 查询以获得我想要的结果。

我正在使用休眠 3.6.5。我一直在使用 Criteria，但对 Query 等感到满意，如果它有效的话！

我是 Hibernate 的新手（可以管理简单的标准来按属性过滤对象，但连接的东西是全新的），所以答案（或建议阅读）中的任何解释都会很棒。

RawRead 有一个包含字符串的标记代码字段。Checkpoint、IncidentItem 和 Guard 类也都具有 TagCode 属性。

我想检索 TagCode 与任何其他类（IncidentItem、Guard、Checkpoint）中的任何 tagcode 值都不匹配的所有 RawRead 对象。

一种大脑转储/伪 SQL 代码：

```
select raw.* from 
    RAWREADS raw, checkpoints c, GUARDS g, INCIDENTITEMS i 
    where 
    raw.tagcode != c.TAGNO
    and raw.TAGCODE != g.IDTAG
    and raw.TAGCODE != i.IDTAG; 
```

我意识到这不会是有效的等，只是我的想法的一个例证。

你能建议用 Hibernate 语言看什么吗？

**编辑/添加：** RawRead 对象映射到 Guard 和 Checkpoint（有一个名为 checkpoint 的属性和一个名为 guard 的属性，它们都是这些类的实例 - 都是 @ManyToOne）。

IncidentItem 没有到其他类的任何映射。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:07:05.717

为了在 HQL 中连接对象，必须在应用程序级别的注释中映射它们之间的关系。如果没有映射关系，您将需要在普通 SQL 中执行这样的查询。

# java - 获取未解决的导入

> ID：11850737
> 
> 赞同：0
> 
> 时间：2012-08-07T17:02:38.927
> 
> 标签：java, eclipse, eclipse-plugin

我正在编写 eclipse 插件，它在所有源文件中查找未解析的导入。`IProblem`我发现使用或`IMarker`对象会很有帮助。这是代码示例

```
public IMarker[] findJavaProblemMarkers(ICompilationUnit cu) 
  throws CoreException {
  IResource javaSourceFile = cu.getUnderlyingResource();
  IMarker[] markers = 
     javaSourceFile.findMarkers(IJavaModelMarker.JAVA_MODEL_PROBLEM_MARKER,
        true, IResource.DEPTH_INFINITE);
} 
```

从[这里](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.isv/guide/jdt_api_classpath.htm)

我不知道如何从`IProblem`或`IMarker`关于哪个导入导致编译问题（未解决的导入）获取信息。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:05:21.150

[http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.isv/guide/jdt_api_classpath.htm](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.isv/guide/jdt_api_classpath.htm)

IProblem 接口中有一个不同 int 值的列表，代表不同的错误；如果您能以某种方式获取文件的错误代码，则可以使用它们。（例如，ImportNotVisible、ImportNotFound 等）。只需检查错误 ID 是否与导入失败的错误 ID 之一匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T18:56:07.477

IMarker 知道 IMarker 标记的 java 源代码的行号和开始和停止字符。您可以获取 java 源字符串的子字符串，如果标记类型表明类或导入有问题，您可以在项目的类路径中搜索与该子字符串匹配（或类似）的类或包。

# wpf - 我们可以为 FrameworkPropertyMetadata 默认值设置最小值吗

> ID：11850738
> 
> 赞同：1
> 
> 时间：2012-08-07T17:02:48.873
> 
> 标签：wpf, c#-4.0

这是代码：

```
new FrameworkPropertyMetadata( (uint) 100,... 
```

我们可以在这里设置最大值为100，有没有办法设置最小值呢？假设我希望这个默认值在 5 到 100 之间？我翻遍了谷歌没有找到任何答案。任何人都可以提出一个解决方案。谢谢！

根据 Reed Copsey 尝试的代码

```
public static bool IsValidReading(object value)
{
    uint v = (uint)value;
    return (!v.Equals(0));
} 
```

完整代码：

```
public static readonly DependencyProperty Result =
            DependencyProperty.Register(
                "ResultLimit", typeof( uint ), typeof( UI ),
                new FrameworkPropertyMetadata( ( uint )10, new PropertyChangedCallback( ResultChanged ) ), IsValidReading ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:04:47.973

该值不是最大值 - 它是*默认*值。

无法直接在元数据中指定最小值或最大值。这应该通过使用依赖属性注册的[回调来处理。](http://msdn.microsoft.com/en-us/library/ms745795.aspx)

# iframe - 使用 iFrames，如何停止 target=_blank

> ID：11850746
> 
> 赞同：2
> 
> 时间：2012-08-07T17:03:10.843
> 
> 标签：iframe, target

我正在将 iframe 用于我不拥有的单独域，但我希望链接保留在我的 iframe 中，但它们使用 target=_blank

从我搜索的内容来看似乎不可能，但我想我会在放弃之前问

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:08:04.487

理论上，您可以使用父页面中的一些 JavaScript 来连接子页面，使用一些伪代码`$("#iframeID").contents()`来获取框架内容，然后使用类似于`$("a").target = "_self"`您需要查找 jQuery 以获取确切语法的东西。

问题是这在跨域上不起作用，除非[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

# cocos2d-iphone - COCOS2d CCLabelTTF 不随玩家分数更新 - 使用 CCLayer 类

> ID：11850748
> 
> 赞同：0
> 
> 时间：2012-08-07T17:03:23.010
> 
> 标签：cocos2d-iphone

我将非常感谢您提供的任何建议，因为我对自己遇到的问题越来越感到沮丧 - 我也很感激我遇到的问题是由于我缺乏知识/理解。

为了进一步扩展我的知识和扩展自己，我选择创建一个 PlayerStats 类来处理球员得分 - 以及时间、健康等。

我的 GameLevelLayer 和 PlayerStats 类实现如下：

GameLevelLayer.m 如下：

```
#import "GameLevelLayer.h"
#import "Player.h"
#import "PlayerStats.h"

@interface GameLevelLayer() {
  CCTMXTiledMap *map;
  Player *player;
  PlayerStats *playerStats;
}

@end

@implementation GameLevelLayer

@synthesize grabber = _grabber;

+(CCScene *) scene
{
    CCScene *scene = [CCScene node];
    GameLevelLayer *layer = [GameLevelLayer node];
    PlayerStats *hudLayer = [PlayerStats node];

   [scene addChild: layer];
   [scene addChild: hudLayer];

return scene;
}

-(id) init {

if( (self=[super init]) ) {

    CGSize screenSize = [[CCDirector sharedDirector] winSize];

    playerStats = [[PlayerStats alloc]init];
    ...........
   } 
```

PlayerStats.m 如下：

```
-(id) init
   {
     if ((self = [super init])) {

     CGSize screenSize = [[CCDirector sharedDirector] winSize];
     score = [CCLabelTTF labelWithString:@"Score : 0" dimensions:CGSizeMake(100,20) hAlignment:UITextAlignmentRight fontName:@"Marker Felt" fontSize:(18.0)];

     int margin = 5;

     score.position = ccp(screenSize.width - (score.contentSize.width/2) - margin, score.contentSize.height/2 + margin);

     [self addChild:score z:99];
   }
     return self;
 }

-(void)numberOfItemsCollected:(int)collected {

    NSString *str = [score string];
    CCLOG(@"What does the label say %@", str);
    // This is actually displaying the correct string of what the score should be .. 

    [score setString:[NSString stringWithFormat:@"Score : %d", collected]];

} 
```

当（来自 GameLevelLayer.m）我启动

```
 [playerStats numberOfItemsCollected:5]; 
```

CCLog 显示标签应显示 Score : 5 但标签本身不会更新。

任何建议将不胜感激，因为我非常清楚我误解了这个问题。我认为问题在于我正在更新的图层不是我认为的那个......

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T07:51:32.703

我已将 CCLabelTTF *score 声明为 PlayerStats 类标头中的实例变量。远离代码的夜晚有多么不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-25T13:51:57.273

最后我设法解决了这个问题，将字符串设置为空字符串，然后将其重新设置为您的字符串

```
[label setString:@""];
[label setString:yourString]; 
```

# jquery - IE7 和 IE8 的 jQuery UI 对话框问题

> ID：11850750
> 
> 赞同：2
> 
> 时间：2012-08-07T17:03:29.533
> 
> 标签：jquery, asp.net, jquery-ui

我有一个 Asp.Net webforms 页面，其中包含一个隐藏的 .Net 用户控件 (hidden.ascx)，当单击按钮时，它会显示在 jQuery UI 对话框中。现在，这在 IE9 和 Chrome 中运行良好。

但是，在 IE8 中，对话框被推到页面底部而不是居中。

在 IE7 中，对话框居中但只读（因为对话框中的所有控件都是只读的......我也无法通过单击右上角的“x”来关闭对话框 - 基本上整个页面都无法使用直到我刷新页面）。

我正在使用**jQuery 1.5.1**和**jQuery UI 1.8.11**，并确保为核心、对话框、位置和小部件添加引用。

这是显示隐藏用户控件的 jQuery 调用：

```
 $('#button').click(function(){
  showUserControl();
});

function showUserControl(){
  var d = $('#container').dialog({
    modal: true,
    position: 'center',
    autoOpen: false,
    title: 'show .net user control',
    width: 500,
    show: 'puff',    
  }).height('auto');

  d.dialog("open");
} 
```

这是一些 hidden.ascx 控件（为这篇文章简化）：

```
<fieldset id="container" class="layoverForm" style="display: none">   

    <div id="status">
        <asp:ValidationSummary ID="vsErrors" ValidationGroup="audit" ShowSummary="true" DisplayMode="BulletList" runat="server" />
    </div>    
    <div class="row">
        <span class="label">Choose One:<b>*</b></span>
        <span class="control">
            <asp:DropDownList ID="cboPickList" ValidationGroup="audit" runat="server"></asp:DropDownList>
            <asp:RequiredFieldValidator ID="rfvPickList" ValidationGroup="form" ControlToValidate="cboPickList" InitialValue="" Display="None" Text="*" runat="server" ErrorMessage="Please choose one."></asp:RequiredFieldValidator>
        </span>
    </div>
    <div class="row">
      <asp:Button ID="btnSubmit" Text="Submit" runat="server" />
    </div> </fieldset> 
```

正如你所看到的，非常简单的东西真的。但是，我似乎无法找到解决此问题的方法，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T16:56:13.770

问题是，在 IE7 中，为了使模式正常工作，您还必须将捕获点击的 div 附加到您附加对话框 div 的同一位置。添加`$('.ui-widget-overlay').appendTo('form:first');`到弹出窗口的 openOn 函数应该可以解决问题。所以整个声明块看起来像这样：

```
function showUserControl(){
    var d = $('#container').dialog({
    modal: true,
    position: 'center',
    autoOpen: false,
    title: 'show .net user control',
    width: 500,
    show: 'puff',
    open: function (event, ui) {
        $(this).parent().appendTo(jQuery("form:last"));
        $('.ui-widget-overlay').appendTo('form:first');
    },
  }).height('auto');

  d.dialog("open");
} 
```

# android - 尝试使用线程在服务内部循环以处理主页按钮

> ID：11850751
> 
> 赞同：0
> 
> 时间：2012-08-07T17:03:30.977
> 
> 标签：android, multithreading, service, handler, sharedpreferences

我试图在处理程序中每 2 秒循环一次，以使用 sharedpreference 标志 isHomeActive 模拟主页按钮按下。它将尝试每 2 秒检查一次服务内的标志是否处于活动状态。如果值为 no，它将尝试重新启动应用程序，但如果值为 yes，则不会重新启动应用程序。到目前为止，我无法让循​​环正常工作

主要活动的 onResume 和 onPause：

```
 @Override
  public void onPause()
  {
      super.onPause();
      SharedPreferences home = PreferenceManager.getDefaultSharedPreferences(PhysicalTheftDialog.this);
      Editor edit=home.edit();
      edit.putString("isHomeActive", "no");
      edit.commit();      

  }

  @Override
  public void onResume()
  {
      super.onResume();
      SharedPreferences home = PreferenceManager.getDefaultSharedPreferences(PhysicalTheftDialog.this);
      Editor edit=home.edit();
      edit.putString("isHomeActive", "yes");
      edit.commit();      
  } 
```

服务类内部的循环：

```
 SharedPreferences sp = PreferenceManager.getDefaultSharedPreferences(PhysicalTheftService.this);
    final String isHomeActive = sp.getString("isHomeActive", "");

    Runnable myRunnable = new Runnable() {
        public void run() {
             while (isHomeActive.equals("no")) {
                  try {
                          Intent physicaldialog = new Intent(PhysicalTheftService.this, PhysicalTheftDialog.class);
                          physicaldialog.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                          PhysicalTheftService.this.startActivity(physicaldialog);
                      Thread.sleep(2000);

                    } catch (InterruptedException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } 

             }
        }
   }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:09:17.340

您只会填充`isHomeActive`一次，因此该值永远不会改变。您需要在循环内填充它。

# objective-c - 铿锵声：错误：-Z-reserved-lib-stdc++：在更新到 xCode 4.4 后出现“-c”时，“链接器”输入未使用

> ID：11850757
> 
> 赞同：3
> 
> 时间：2012-08-07T17:04:07.940
> 
> 标签：objective-c, ios, xcode, xcode4.4

我刚刚将 xcode 更新到 4.4 版本，我目前正在处理的项目正在抱怨：

```
clang: error: -Z-reserved-lib-stdc++: 'linker' input unused when '-c' is present 
```

命令 /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang 失败，退出代码为 1

你知道我应该检查什么来解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:07:31.247

该问题与 coreplot 有关：[CorePlot failed to build in XCode 4.4](https://stackoverflow.com/questions/11772545/coreplot-failed-to-build-in-xcode-4-4)。只需更新 coreplot，一切都会顺利编译。

# powershell - 使用 powershell 删除文本块

> ID：11850761
> 
> 赞同：1
> 
> 时间：2012-08-07T17:04:23.100
> 
> 标签：powershell

所以我需要删除多个txt文件中的几块txt。文件如下所示：

```
Header
Value
Data
   <DefaultValue>
       sdf
         asdfsdf
       asfkfkf
   </DefaultValue>
Data3
Data2
   <DefaultValue>
       sdfdffff
          asdfsasdfddf
       asfkf
   </DefaultValue>**
Dat
End 
```

我需要删除以 DefaultValue 开头**并以****/DefaultValue**结尾的行块

 **结果应如下所示：

```
Header
Value
Data
Data3
Data2
Dat
End 
```

不幸的是，它不是格式正确的 XML 文件，因此无法删除 XML 节点。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:43:05.397

我用它来解决添加第三方 Join-String 函数的需要：

```
$filePath = '.\Desktop\new  3.txt'
$text = ""
Get-Content $filePath | % {$text += $_ + "NEWLINE"}
$text = $text -Replace "<Default.+?DefaultValue>",""
$text.Replace("NEWLINE","`r`n") 
```

产出：

```
Header
Value
Data

Data3
Data2
   **
Dat
End 
```

为了使这个重复，你想做这样的事情：

```
Get-ChildItem -Path C:\logs\ -Filter "*.txt" | % {
    $text = ""
    Get-Content $_.FullName | % {$text += $_ + "NEWLINE"}
    $text = $text -Replace "<Default*DefaultValue>",""
    $text.Replace("NEWLINE","`r`n") | Out-File $_.FullName -Force
} 
```

祝你好运，备份你的数据，然后回来查看其他用户的更优雅的答案。**

# python - 如何使用 Python 连接到多个 sqlite3 数据库

> ID：11850762
> 
> 赞同：3
> 
> 时间：2012-08-07T17:04:30.610
> 
> 标签：python, sqlite

这与我之前的查询有些相关..

[用 Python 读取一个大文件](https://stackoverflow.com/questions/11809925/reading-a-big-file-with-python)

问题出在运行时，所以建议我使用 sqlite3 数据库，它将时间减少到毫秒，我很高兴，现在我唯一的问题是，连接到同一文件夹中的不同数据库文件。所有数据库文件都有相同的表。

我正在使用的代码，只读取第一个，似乎没有检查其他数据库。

输出是当老师输入学生ID时，如果在数据库表中找到相关记录，则应该返回相关记录。

我的代码是这样的，但我确信我做错了什么，如果它是一个愚蠢的，请原谅我，因为它是第一次使用 sqlite3。

```
#other codes above not related to this part
databases = []
directory = "./Databases"
for filename in os.listdir(directory):
    flname = os.path.join(directory, filename)
    databases.append(flname)

for database in databases:
    conn = sqlite3.connect(database)
    conn.text_factory = str
    cur = conn.cursor()
    sqlqry = "SELECT * FROM tbl_1 WHERE std_ID='%s';" % (sudentID)
    try:
        c = cur.execute(sqlqry)
        data = c.fetchall()
        for i in data:
            print "[INFO] RECORD FOUND"
            print "[INFO] STUDENT ID: "+i[1]
            print "[INFO] STUDENT NAME: "+i[2]
            #and some other info
        conn.close()
    except sqlite3.Error as e:
        print "[INFO] "+e 
```

感谢任何指导

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:05:15.433

@Whiskey，有时尝试将问题分解为一个最小的示例并查看它是否有效或在哪里出错会有所帮助。由于您能够在打开数据库名称时看到正在打印的数据库名称，因此我的猜测可能是查询或数据库中的数据存在问题，即使记录似乎在那里。当您说它没有找到您要查找的记录时，它只是什么都不打印，还是在您的异常处理程序中打印出“[INFO]”行？

我整理了以下最小示例，就我对您的问题的理解而言，它似乎有效。我唯一要添加到其他所有人的建议是将您的查询参数化，而不是直接使用原始输入来使您的应用程序更安全一些。希望能帮助到你：

```
import os, sqlite3

"""
Create the test databases:

sqlite3 Databases/test_db1.db

sqlite> CREATE TABLE foo ( id INTEGER NOT NULL, name VARCHAR(100), PRIMARY KEY (id) );
sqlite> 

sqlite3 Databases/test_db2.db
sqlite> CREATE TABLE foo ( id INTEGER NOT NULL, name VARCHAR(100), PRIMARY KEY (id) );
sqlite> INSERT INTO foo VALUES (2, 'world');

"""

databases = []
student_id = 2

directory = "./Databases"
for filename in os.listdir(directory):
    flname = os.path.join(directory, filename)
    databases.append(flname)

for database in databases:

    try:

        with sqlite3.connect(database) as conn:

            conn.text_factory = str
            cur = conn.cursor()
            sqlqry = "SELECT * FROM foo WHERE id=:1;"
            c = cur.execute(sqlqry, [student_id])

            for row in c.fetchall():
                print "-- found: %s=%s" % (row[0], row[1])

    except sqlite3.Error, err:
        print "[INFO] %s" % err 
```

# c++ - 将双精度转换为字符串。Boost 库似乎不起作用，并且 sstream 导致“SEG FAULT”

> ID：11850766
> 
> 赞同：1
> 
> 时间：2012-08-07T17:04:47.940
> 
> 标签：c++, boost, casting, double, lexical

我有一个简单的问题，我认为我只是在做一些导致 SEGFAULT 的愚蠢行为。

我只是想将双变量转换为字符串，然后将它们“strcat()”放在一起，并将生成的串联字符串放入 GTK 标签中。（应该很简单吧？！）

这是我的代码的一部分：

```
double fps_target = 2.71828
std::string fps_target_string;
std::stringstream convert;
convert << fps_target;
fps_target_string = convert.str();
g_print("seg fault occurs below");
label_fps_target = gtk_label_new(strcat("FPS Target: ", 
    (const char*) fps_target_string.c_str())); 
```

为什么它不能工作？！:(

我尝试使用 Boost::Lexical_Cast 东西，但没有奏效：

```
double fps_target = 3.14159;
const char* fps_target_string = (const char*) (boost::lexical_cast<std::string>(fps_target)); 
```

任何帮助是极大的赞赏。如果任何一种方法都有效，那将是很棒的，但我并不真正关心如何去做，只要我能用字符串得到一个双倍的 cat ！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T17:13:07.067

它甚至不应该编译。确保将编译器的警告和一致性级别设置为高。从长远来看，这将为您节省很多麻烦。

让我们看一下[`strcat`签名](http://en.cppreference.com/w/cpp/string/byte/strcat)：

```
char *strcat( char *dest, const char *src ); 
```

所以，它需要一个`char*`作为第一个参数。但是`"FPS Target: "`具有`char const[13]`衰减到的类型`char const*`，不能作为 a 传递`char*`。`char*`允许修改，但`char const*`不允许（字符串文字不可变！）。第一个参数是`char*`因为这是放置结果的缓冲区。你不能把它放在那个字符串文字中，因为：

1.  字符串文字是只读的；
2.  该字符串文字不够大。

第二个参数不需要强制转换，因为返回类型`c_str()`已经是`char const*`.

连接字符串的最简单方法是使用`std::string`C 库字符串操作函数，而不必费心。

```
std::string result = "FPS Target: " + fps_target_string;
g_print("seg fault doesn't occur below");
label_fps_target = gtk_label_new(result.c_str()); 
```

由于代码已经在使用 a `stringstream`，因此更简单的方法是将两个部分都插入流中。

```
std::stringstream convert;
convert << "FPS Target: " << fps_target;
std::string result = convert.str();
g_print("seg fault doesn't occur below");
label_fps_target = gtk_label_new(result.c_str()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:13:47.883

`strcat()`使用第一个参数作为输出缓冲区。当然`strcat("FPS Target: "...)`会崩溃。分配一个缓冲区并将其作为第一个参数传递。

`const char* fps_target_string = (const char*) boost::lexical_cast<std::string>(fps_target)`不会编译，因为没有从 std::string 到`const char*`.

# matlab - 如何使用凸包函数在Matlab中提取形成3维多边形凸包的点？

> ID：11850771
> 
> 赞同：0
> 
> 时间：2012-08-07T17:05:19.827
> 
> 标签：matlab, convex-hull, convex-polygon, convex-optimization

我在 Matlab 中使用不同的凸包函数来查找形成凸包的点坐标。但是，这些函数返回三角形矩阵。如何指定这些点？谢谢。塞皮德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:38:22.077

我不确定我是否完全理解你的问题。也许如果以下内容没有阐明您可以编辑您的帖子以包含您正在使用的 MATLAB 函数的名称和一段代码？

`convhull`MATLAB中的函数*确实*返回凸包中的坐标索引。

在以下示例中，`(x(k), y(k))`是坐标。（直接取自[convhull doc](http://www.mathworks.com/help/techdoc/ref/convhull.html)）

```
xx = -1:.05:1; yy = abs(sqrt(xx));
[x,y] = pol2cart(xx,yy);
k = convhull(x,y);
plot(x(k),y(k),'r-',x,y,'b+') 
```

![卷积示例](../Images/4bbbf7e78fe4fb41101d3ba39b568499.png)

如果您使用的是相同的东西`convexhull`（[convexhull doc](http://www.mathworks.com/help/techdoc/ref/delaunaytri.convexhull.html)）。

```
x = rand(10,1);
y = rand(10,1);
dt = DelaunayTri(x,y);
k = convexHull(dt);
plot(x,y, '.', 'markersize',10); 
hold on;
plot(x(k), y(k), 'r'); 
hold off; 
```

![凸包示例](../Images/d466e17fc45d612f65a0f276fa210264.png)

# apache - Apache 虚拟主机导致 403

> ID：11850772
> 
> 赞同：0
> 
> 时间：2012-08-07T17:05:43.323
> 
> 标签：apache, zend-framework, virtual

我在 Windows 7 上使用 wamp。在安装 zend 并设置虚拟主机之前，我没有遇到任何问题。我现在尝试访问本地主机时收到 403。

在我的 httpd-vhosts.conf 中：

```
NameVirtualHost *:80

<VirtualHost *:80>
   DocumentRoot "C:/wamp/path to project"
   ServerName .local
   SetEnv APPLICATION_ENV development

  <Directory "C:/wamp/path to project">
       Options Indexes MultiViews FollowSymLinks
       AllowOverride All
       Order allow,deny
       Allow from all
   </Directory>
</VirtualHost> 
```

在我的 httpd.conf 中：

听 80

项目的路径是读、写、修改。

据我所知，我已经正确配置了虚拟主机，但我得到了 403。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:36:06.083

也许在您的目录`httpd.conf`中`AllowOverride None`设置了您的`c:/wamp/`目录，这就是您无法更改它的原因。

# c# - 当用户转到新行时，文本框会动态更改高度

> ID：11850774
> 
> 赞同：0
> 
> 时间：2012-08-07T17:05:52.057
> 
> 标签：c#, wpf, textbox, height

在 WPF 应用程序中，我有一个文本框。我已经设置`AcceptReturn`为`true` 但是当用户单击输入时我需要使文本框更大。我的意思是当前当用户点击回车键时，光标会转到一个新行，但是文本框仍然是相同的高度，上面的行现在被隐藏了。我可以根据内容动态更改 textboxHeight 吗？

谢谢

PS：我不能使用 textarea 我需要留在文本框

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:28:46.783

我建议保持当前大小并使用垂直滚动条。但是，如果您正在做一些真正需要它的事情，请将您的 TextBox 放入一个网格中。将网格行高设置为自动。将文本框的高度设置为自动。将文本框的 VerticalAlignment 设置为 Stretch。在下面的代码中，我保留了滚动条设置。您可以更改您认为合适的设置。

```
 <Grid>
        <Grid.RowDefinitions>
           <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <TextBox Grid.Row="0" x:Name="scriptTextBox" Margin="10" Height="Auto" Width="Auto" FontFamily="Consolas, Courier New" 
                 HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto"
                 MaxLines="9999" AcceptsReturn="True" AcceptsTab="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" 
                 Text="{Binding Path=Script, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                 />
     </Grid> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:49:09.510

你说你需要使用文本框。您至少可以使用覆盖的文本框吗？这在我的测试中效果很好：

```
public class AutoHeightTextbox : TextBox {

    protected override Size ArrangeOverride(Size arrangeBounds) {
        Size unboundSize = new Size(this.Width, double.PositiveInfinity);
        Size textSize = base.MeasureOverride(unboundSize);
        this.Height = textSize.Height;
        return base.ArrangeOverride(arrangeBounds);
    }

} 
```

# pdf - 在 Linux 上使用 Ghostscript 减小 PDF 文件大小不起作用

> ID：11850776
> 
> 赞同：13
> 
> 时间：2012-08-07T17:05:58.703
> 
> 标签：pdf, size, resolution, ghostscript, image-resizing

我有大约 50-60 个 1.5MB 大的 pdf 文件（图像）。现在我不想在我的论文中包含这么大的 pdf 文件，因为这会让下载、阅读和打印变得很痛苦。所以我尝试使用 ghostscript 来执行以下操作：

```
gs \
  -dNOPAUSE -dBATCH \
  -sDEVICE=pdfwrite \
  -dCompatibilityLevel=1.4 \
  -dPDFSETTINGS="/screen" \
  -sOutputFile=output.pdf \
    L_2lambda_max_1wl_E0_1_zg.pdf 
```

但是，现在我的 1.4MB pdf 是 1.5MB 大。

我做错什么了？有什么方法可以检查pdf文件的分辨率吗？我只需要 300dpi 图像，所以任何人都建议使用`convert`来更改分辨率，或者有什么方法可以更改图像分辨率（降低它）`gs`，因为当我使用时图像非常粗糙`convert`

我如何使用转换：

```
 convert \
     -units PixelsPerInch \
      ~/Desktop/L_2lambda_max_1wl_E0_1_zg.pdf \
     -density 600 \
      ~/Desktop/output.pdf 
```

## 示例文件

[http://dl.dropbox.com/u/13223318/L_2lambda_max_1wl_E0_1_zg.pdf](http://dl.dropbox.com/u/13223318/L_2lambda_max_1wl_E0_1_zg.pdf)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-07T17:56:05.203

如果您运行 Ghostscript `-dPDFSETTINGS=/screen`，这只是一种捷径。事实上，您会（隐含地）获得一大堆使用的设置，您可以使用以下命令进行查询：

```
gs \
  -dNODISPLAY \
  -c ".distillersettings {exch ==only ( ) print ===} forall quit" \
| grep '/screen' 
```

在我的 Ghostscript (v9.06prerelease) 上，我得到以下输出（稍作编辑以增加可读性）：

```
/screen 
  << /DoThumbnails false 
     /MonoImageResolution 300 
     /ColorImageDownsampleType /Average 
     /PreserveEPSInfo false 
     /ColorConversionStrategy /sRGB 
     /GrayImageDownsampleType /Average 
     /EmbedAllFonts true 
     /CannotEmbedFontPolicy /Warning 
     /PreserveOPIComments false 
     /GrayImageResolution 72 
     /GrayACSImageDict << 
                        /ColorTransform 1 
                        /QFactor 0.76 
                        /Blend 1 
                        /HSamples [2 1 1 2] 
                        /VSamples [2 1 1 2] 
                      >> 
     /ColorImageResolution 72 
     /PreserveOverprintSettings false 
     /CreateJobTicket false 
     /AutoRotatePages /PageByPage 
     /MonoImageDownsampleType /Average 
     /NeverEmbed [/Courier 
                  /Courier-Bold 
                  /Courier-Oblique 
                  /Courier-BoldOblique 
                  /Helvetica 
                  /Helvetica-Bold 
                  /Helvetica-Oblique 
                  /Helvetica-BoldOblique 
                  /Times-Roman 
                  /Times-Bold 
                  /Times-Italic 
                  /Times-BoldItalic 
                  /Symbol 
                  /ZapfDingbats] 
     /ColorACSImageDict << 
                          /ColorTransform 1 
                          /QFactor 0.76 
                          /Blend 1 
                          /HSamples [2 1 1 2] 
                          /VSamples [2 1 1 2] >> 
     /CompatibilityLevel 1.3 
     /UCRandBGInfo /Remove 
>> 
```

我想知道您的 PDF 是否包含大量图像，并且这种转换是否会造成不受欢迎的事情（使用“错误”参数重新采样图像）会增加文件大小......

如果是这种情况（图像繁重的 PDF），请告诉我，我会用一些建议来更新这个答案......

* * *

## 更新

我查看了 DNA 提供的示例文件。有趣的...

不，它不**包含**任何*图像*。

相反，它包含一个大流（使用 压缩`/FlateDecode`），其中包含大约 700.000+ (!!) 个操作，主要是 PDF 语言中的单个向量操作，例如：
`m`(moveto)、
`l`(lineto)、
`d`(setdash)、
`w`(setlinewidth)、
`S`(stroke)、
`s`(closepath and stroke)、
`W*`(eoclip)
`rg`和`RG`(setrgbcolor)
等等。

*（该 PDF 代码的 AFAICS 编写效率非常低（但可以完成它的工作），因为它确实连接了许多短笔划而不是“长”笔划，并且几乎每个笔划都再次定义了颜色（即使它与以前相同），并具有所有其他开销（开始行程，结束行程，...）。*

Ghostscript在这里`-dPDFSETTINGS=/screen`没有**任何**效果（例如，没有要下采样的图像）。增加的文件大小（准确地说是 +48 kByte）可能是由于 Ghostscript 在解释文件时将一些内部描边等命令重新组织为不同的顺序。

**因此，对于 PDF 文件大小，您无能为力**...

*   **...除非您将这些 PDF 页面中的每一个都转换为*真实*的图像，例如 PNG：**

```
    GS\
      -o out72.png \
      -sDEVICE=pngalpha\
       L_2lambda_max_1wl_E0_1_zg.pdf

```

（我使用`pngalpha`输出来获得透明背景。）*'out.png'*的图像尺寸是`259x213px`，文件大小现在是 70 kByte。但我敢肯定你不会喜欢它的质量:-)

输出质量“差”，因为 Ghostscript 使用 72 dpi 的默认分辨率。

既然你说你想要 300dpi，命令变成这样：

```
gs \
  -o out300.png \
  -sDEVICE=pngalpha \
  -r300 \
   L_2lambda_max_1wl_E0_1_zg.pdf 
```

现在的文件大小是 750 kByte，图像尺寸是`1080x889`像素。

* * *

## 更新 2

由于*好奇*现在很流行... :-) ...我试图在 Mac 上的 Adob​​e Acrobat X Pro 的帮助下减小文件大小。

你想知道结果吗？

执行*“另存为...（减小文件大小的 PDF）”* ——过去对我来说总是产生非常好的结果！-- 创建了一个 1,8++ MByte 文件 (+29%)。我想这绝对将 Ghostscript 的性能（文件大小增加 +3%）置于现实的角度！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T20:04:05.347

DNA 决定使用灰度 PNG。他创建它们的方式分为两个步骤：

1.  **第 1 步：**使用 Ghostscript 的设备和设置，将彩色 PDF 页面（例如[**这个**](http://dl.dropbox.com/u/13223318/L_2lambda_max_1wl_E0_1_zg.pdf)）转换为灰度 PDF 页面。`pdfwrite`
    `-dColorConversionStrategy=/Gray`
    `-dProcessColorModel=/DeviceGray`
2.  **第 2 步：**使用 Ghostscript 的`pngalpha`设备以 300 dpi 的分辨率（`-r300`在 GS 命令行上）将灰度 PDF 页面转换为 PNG。

这将他的初始文件大小从 1.4 MB 减少到 0.7 MB。

但是这个工作流程有以下缺点：

*   *与直接从 PDF 中以相同分辨率编写的**颜色**输出相比，它会丢失所有颜色信息，而不会节省太多磁盘空间！*

DNA 的工作流程有 2 种替代方案：

1.  （彩色）PDF ->（彩色）PNG 的一步转换，使用 Ghostscript 的`pngalpha`设备和原始 PDF 作为输入（相同的 300 dpi 分辨率设置）。这将具有以下优势：

    *   *它会将颜色信息保留在 PNG 输出中，只需要更多的磁盘空间！*
2.  （彩色）PDF -> 灰度 PNG 的一步转换，使用 Ghostscript 的`pnggray`设备和原始 PDF 作为输入（300 dpi 分辨率的相同设置），具有以下优点/缺点：

    *   *它会丢失 PNG 输出中的颜色信息。*
    *   *它会丢失 DNA 工作流程中保留的透明背景。*
    *   *它将节省**大量**磁盘空间，因为文件大小将下降到 DNA 工作流程输出的 20% 左右。*

因此，您可以下定决心并并排查看输出大小和质量，这里有一个 shell 脚本来演示差异：

```
#!/bin/bash
#
# 文案 (c) 2012 <kurt.pfeifle@gmail.com>
# 许可：知识共享（CC BY-SA 3.0）

功能回声做（）{
        回声
        回声“命令：${*}”
        回声“--------”
        回声
        “${@}”
}

[ -d 出] || mkdir 输出

回声
echo "我们假设所有 PDF 页面都是一页 PDF！"
echo "（否则我们必须包含类似 '%03d' 的内容"
echo " 进入输出文件名以获得分页输出)"
回声

回声'
 # 将彩色 PDF 转换为灰度 PDF。
 # 如果 PDF 有透明背景（大多数都有），
 # 这将在输出中保持透明。）
 # 注意：因为我们不使用分辨率，
 # pdfwrite 将使用其默认值“-r720”。
 # (然而，这个设置只会影响光栅对象...)
'
对于我在 *.pdf 中
做
echo_do gs \
 -o "out/${i}---pdfwrite-devicegray-gs.pdf" \
 -sDEVICE=pdf写入\
 -dColorConversionStrategy=/灰色\
 -dProcessColorModel=/DeviceGray \
 -dCompatibilityLevel=1.4 \
  “${i}”
完毕

回声'
 # 使用 Alpha 通道将（之前生成的）灰度 PDF 转换为 PNG
 #（Alpha通道可以使背景透明）
'
for i in out/*pdfwrite-devicegray*.pdf
做
echo_do gs \
 -o "out/$(basename "${i}")---pngalpha-from-pdfwrite-devicegray-gs.png" \
 -sDEVICE=pngalpha\
 -r300 \
  “${i}”
完毕

回声'
 # 使用 Alpha 通道将（彩色）PDF 转换为灰度 PNG
 #（Alpha通道可以使背景透明）
'
对于我在 *.pdf 中
做
# 以下仅对 'pdfwrite' 输出设备需要，'pngalpha' 不需要！
# -dProcessColorModel=/DeviceGray
echo_do gs \
 -o "out/${i}---pngalphagray_gs.png" \
 -sDEVICE=pngalpha\
 -dColorConversionStrategy=/灰色\
 -r300 \
  “${i}”
完毕

回声'
 # 使用 Alpha 通道将（颜色）PDF 转换为（颜色）PNG
 #（Alpha通道可以使背景透明）
'
对于我在 *.pdf 中
做
echo_do gs \
 -o "out/${i}---pngalphacolor_gs.png" \
 -sDEVICE=pngalpha\
 -r300 \
  “${i}”
完毕

回声'
 # 将（彩色）PDF 转换为灰度 PNG
 #（这里没有Alpha通道，因此[大部分]白色背景）
'
对于我在 *.pdf 中
做
echo_do gs \
 -o "out/${i}---pnggray_gs.png" \
 -sDEVICE=png灰色\
 -r300 \
  “${i}”
完毕

echo "所有输出都在 ./out/ ..."
回声

```

运行此脚本并并排比较不同的输出。

是的，'direct-grayscale-PNG-from-color-PDF-using-pnggray-device' 可能看起来*比*另一个更糟糕（并且它不具有透明背景） - 但它也只是文件大小的 20%。另一方面，如果你想通过牺牲一点磁盘空间来购买更多质量 - 你可以使用`-r400`而不是`-r300`......

# php - 分布式环境中的 PHP XDebug（云）

> ID：11850785
> 
> 赞同：1
> 
> 时间：2012-08-07T17:06:16.680
> 
> 标签：php, azure, cloud, xdebug, azure-storage

据我所知，PHP 分析工具 XDebug 将其结果保存到文件中。但是，当应用程序在云分布式环境中运行时，处理这些文件是很困难的。管理这种情况的最佳做法是什么？XDebug 中有什么方法（最好是可以放置自定义处理程序/回调的地方）可以用来将结果保存到共享存储中吗？

（免责声明：我的应用程序在 MS Azure 平台上运行）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:15:28.337

是的，这是可能的，您可以在 Azure 诊断中将**xdebug.profiler_output_dir**与[DirectoryConfiguration一起使用。](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.windowsazure.diagnostics.diagnosticmonitorconfiguration.directories.aspx)DirectoryConfiguration 将获取 LocalResource 的内容并将其保存到 blob 存储。

这是你需要做的：

1.  创建一个使用本地资源路径更新 xdebug.ini 的启动任务（如果您打算使用脚本执行此操作，可以从[此处开始）](http://blog.smarx.com/posts/using-a-local-storage-resource-from-a-startup-task)
2.  将 DiagosticsManager 配置为使用该目录并将其发送到您的 Blob 存储。看看[这个](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.windowsazure.diagnostics.diagnosticmonitorconfiguration.directories.aspx)例子。

完成此操作后，您可以使用任何存储客户端（如 Cloud Storage Studio、CloudXplorer 等）访问您的结果。

# c#-4.0 - 如何模拟一个类的单个方法？

> ID：11850790
> 
> 赞同：2
> 
> 时间：2012-08-07T17:06:50.300
> 
> 标签：c#-4.0, rhino-mocks

我是使用 Mocking 框架来模拟对象以进行单元测试的新手。我目前正在使用 Rhino Mocks，我认为它会有一种方法来做我找不到的事情。这是一个 LinqPad 程序（只需将其复制并粘贴到 C# 程序查询中，它就可以工作），它显示了我正在尝试做的事情：

```
public interface MyTest{
    int A(int i);
    string B(int i);
}

/// This is an actual class that is a black box to me.
public class ActualClass : MyTest {
    public int A(int i){
        // Does some work
        return ++i;
    }

    public string B(int i){
        return A(i).ToString();
    }
}

/// I'd like to create a mocked class that uses an instance of the actual class 
/// to provide all of the implementations for the interface except for a single method
/// where I can check the parameter values, and provide my own return value, 
/// or just call the actual class
public class MockedClass : MyTest {

    private ActualClass _actual;
    public MockedClass(ActualClass actual){
        _actual = actual;
    }
    public int A(int i){
        if(i == 1){
            return 10;
        }else{
            return _actual.A(i);
        }
    }

    public string B(int i){
        return _actual.B(i);
    }
}

void Main()
{
    var mock = new MockedClass(new ActualClass());
    mock.A(0).Dump();
    mock.A(1).Dump();
    mock.A(2).Dump();
    mock.B(0).Dump();
    mock.B(1).Dump();
    mock.B(2).Dump();
} 
```

* * *

结果：

```
1
10
3
1
2
3 
```

我该怎么做才能模拟这个进行单元测试。我需要某种依赖注入器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T17:51:43.017

是的，您可以根据传入的参数更改模拟对象的返回值。我不会采用混合真实依赖项和模拟依赖项的方法——真实依赖项中的错误有太多机会潜入到你的测试。

这是您可以在 MyTest 接口上使用的示例，它检查模拟方法的输入参数并相应地设置返回值：

```
var mock = MockRepository.GenerateStub<MyTest>();
mock.Stub(m => m.A(Arg<int>.Is.Anything))
    .Return(99)
    .WhenCalled(mi =>
                    {
                        var arg = Convert.ToInt32(mi.Arguments[0]);
                        switch (arg)
                        {
                            case 0:
                                mi.ReturnValue = 10;
                                break;
                            case 1:
                                mi.ReturnValue = 20;
                                break;
                            case 2:
                                mi.ReturnValue = 30;
                                break;
                            default:
                                mi.ReturnValue = -1;
                                break;
                        }
                    }); 
```

请注意，“Return(99)”是必需的，因为当您存根返回值的方法时，Rhino.Mocks**要求**您定义要抛出的异常或定义返回值。即使我们不使用返回值（因为我们在 WhenCalled 处理程序中提供了自己的返回值），它仍然必须定义，否则 Rhino.Mocks 将在第一次调用存根时抛出异常。

# jquery - JQUERY 显示隐藏在 CSS 上的 div

> ID：11850794
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:07:08.807
> 
> 标签：jquery, css, html, hidden

也许我应该早点问这个……

我有一个从 sql 表中加载所有项目的 DIV。然后我有一些用于按颜色过滤的复选框，因此如果用户选择蓝色，则将重新加载 DIV，将蓝色作为颜色并仅显示蓝色项目。

一旦用户点击，我想在加载蓝色项目时显示一个“加载”.gif。也许它非常短，或者可能需要 3 秒左右......

我的选择是：

*   在我的主 DIV 中有另一个 DIV，其中包含 .gif 并且不显示 CSS。然后使用 JQUERY 我将不得不显示它然后隐藏它......如果这个选项很好，我可以使用什么样的 JQUERY？

*   在过滤后加载结果之前，使用 JQUERY 加载加载 DIV

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:16:10.473

最简单的方法是让页面中的 div，通常靠近页面底部，用 css 隐藏：

```
<div id="loading">
    <img src="img/loading.gif" alt="Loading." />
</div> 
```

CSS：

```
#loading {
    display:none;
    /* some more code to position the div where you want */
} 
```

js：

```
$("#loading").toggle(); // or .show() / .hide() 
```

见小提琴：http: [//jsfiddle.net/Gwmah/](http://jsfiddle.net/Gwmah/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-11T08:33:29.240

jQuery 提供了几个有用的函数来显示 html 元素

*   隐藏（）显示（）
*   切换（）

    ```
    //your css would be like this
    #divToDisplay {
        display:none;
    }

    $('document').ready(function() {

        $('#divToDisplay').show();
    });

    //or to make it show hide on click use toggle()
    $('document').ready(function() {

         $('#divToDisplay').toggle();
    });

    //you can also use slideToggle() to give some animation for show and hide
    $('document').ready(function() { 

        $('#divToDisplay').slideToggle( "slow" );
    } 
    ```

# javascript - 需要帮助以更好地练习 Jquery 代码

> ID：11850795
> 
> 赞同：0
> 
> 时间：2012-08-07T17:07:08.857
> 
> 标签：javascript, jquery

我试图让我的 jquery 代码在这里看起来更好。我的功能工作正常，但我想知道是否有人可以让我的代码不那么难看。非常感谢！

**HTML**

```
<div class='image_layout'>
    <a href='#'><img src=' a.jpg '/></a> 
          <br><p class='credits'>hahahah 
          <br>Agency: Agency1
          <br>Picture ID: 5 </p> 
</div> 
```

**jQuery**

```
$('#image_layout').on('hover', 'img', function() {
    $(this).parent().next().next().fadeIn('fast');
})
$('#image_layout').on('mouseout', 'img', function() {
    $(this).parent().next().next().fadeOut('fast');
})​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:12:28.097

您可以将两个函数传递给 jQuery hover - 一个用于 mousein，一个用于 mouseout。只要您没有动态添加的图像，就可以进行此更改。如果您正在淡出的元素具有 ID 或类，您的代码也会简单得多：

```
$('#image_layout img').hover(
    function () {
        $(this).closest('.someClass').fadeIn('fast');
    },
    function () {
        $(this).closest('.someClass').fadeOut('fast');
    }
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:10:47.207

我会使用`.eq`而不是两个`next`语句，此外，hover 需要两个函数，第一个用于`mouseenter`事件，第二个用于`mouseout`

```
$('#image_layout').hover('hover', 'img', function () {
    $(this).parent().eq(2).fadeIn('fast');
}, function () {
    $(this).parent().eq(2).fadeOut('fast');
}) 
```

**参考**

*   [看看`eq`这里](http://api.jquery.com/eq/)
*   [`hover`在这里阅读](http://api.jquery.com/hover/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:10:54.183

```
$('.image_layout').on('hover', 'img', function (e) {
    if(e.type == 'mouseover') {
        $(this).closest('.image_layout').find('.credits').stop().fadeIn('fast');
    } else {
        $(this).closest('.image_layout').find('.credits').stop().fadeOut('fast');
    }
}) 
```

你也可以这样做：

```
$('.image_layout').on('hover', 'img', function() {
    $(this).closest('.image_layout').find('.credits').stop().fadeIn('fast');
}, function() {
    $(this).closest('.image_layout').find('.credits').stop().fadeOut('fast');
}); 
```

如果您确定除了悬停图像不会导致元素褪色，您可以简单地编写：

```
$('.image_layout').on('hover', 'img', function() {
    $(this).closest('.image_layout').find('.credits').stop().fadeToggle('fast');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T17:13:59.267

查看[Douglas Crockford 的 JS 样式指南](http://javascript.crockford.com/code.html)。他会让你的代码看起来像（有改进）：

```
var obj = $('#image_layout img');
obj.mouseover( function(){
  $(this).parent([selector]).next([selector]).fadeIn('fast');
});

obj.mouseout( function(){
    $(this).parent([selector]).next([selector]).fadeOut('fast');
}); 
```

您不需要`on`，只需直接调用该函数即可。

# html - 为什么我的 HTML 中的 CDATA 部分没有呈现？

> ID：11850804
> 
> 赞同：2
> 
> 时间：2012-08-07T17:07:45.850
> 
> 标签：html, xml, xhtml, cdata

我正在写一份关于 HTML 中的 XML 注入攻击的报告。因此，我将拥有（损坏的）HTML 内容作为我的 HTML 的内容。因此，我试图将我的 HTML 内容包装在 CDATA 块中，但它似乎确实可以正确呈现。

我有（[由 W3C 验证](http://validator.w3.org/#validate_by_input)）文档：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>report</title>
    </head>
    <body>
        <div><![CDATA[AuthType=<META HTTP-EQUIV="Set-Cookie" Content="USERID=&lt;SCRIPT&gt;alert('XSS')&lt;/SCRIPT&gt;">]]></div>
    </body>
</html> 
```

根据我对[维基百科文章](http://en.wikipedia.org/wiki/Cdata)的理解，这意味着内容应该“标记为解析器仅解释为字符数据，而不是标记”。所以输出应该是

```
AuthType=<META HTTP-EQUIV="Set-Cookie" Content="USERID=&lt;SCRIPT&gt;alert('XSS')&lt;/SCRIPT&gt;"> 
```

然而，在这两个`Chrome 21.0.1180.60 m`和`Firefox 14.0.1`所有呈现的是

```
]]> 
```

到底是怎么回事？`<![CDATA[`从第一个到第一个的所有内容不应该都`]]>`出现在屏幕上，就好像每个角色都被逃脱了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-07T17:38:40.953

CDATA 部分仅在 XML 解析模式下被浏览器识别。如您所见，在旧版 HTML 模式下，会发生奇怪的事情。

因此，您需要配置服务器以发送带有 XHTML Content-Type 的文档。这反过来会阻止旧版本的 IE（最高 IE 8）根本不呈现文档。

将 HTML 标记显示为 HTML 文档的内容的实用方法是： a) 将每个标记呈现`<`为`&lt;`和每个标记`&`为`&amp;`。适用于 XHTML 中的旧版 HTML 和德。b) 将数据包装在一个`xmp`元素中。在旧版 HTML 中工作（仅 - 所以没有 XML Content-Type，但只是声明一个 XHTML 文档类型并不重要，无论如何它都会被忽略）。例子：

```
<xmp><![CDATA[AuthType=<META HTTP-EQUIV="Set-Cookie" Content="USERID=&lt;SCRIPT&gt;alert('XSS')&lt;/SCRIPT&gt;">]]></xmp> 
```

`xmp`标记还暗示了等宽字体和类似`pre`呈现空白的地方。但是这些可以用 CSS 覆盖。该`xmp`元素很久以前就从 HTML 规范中删除了，但浏览器很好地支持了该元素。

# php - 带有复选框的 Jquery fullcalendar 插件

> ID：11850811
> 
> 赞同：4
> 
> 时间：2012-08-07T17:08:10.413
> 
> 标签：php, jquery, fullcalendar

只是想知道是否有任何支持事件旁边复选框的完整日历 jquery 插件。目的只是在已完成的任务上做一些标记。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T19:16:10.923

您可以随时深入研究代码。

我编辑了“slotSegHtml”函数，结果如下：

[http://jsfiddle.net/V1tOr/HZjVt/11/](http://jsfiddle.net/V1tOr/HZjVt/11/)

注意事件中的“完成”道具：

```
{
    title: 'Lunch',
    start: new Date(y, m, d+1, 12, 0),
    end: new Date(y, m, d+1, 14, 0),
    allDay: false,
    completed : true
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T15:56:07.660

以下是不涉及编辑 fullcalendar 源的两个选项：

**选项 1：** 如果您只是想区分已完成任务和未完成任务，则无需修改完整日历源。我很幸运只使用 CSS 将小图标放在全日历事件上：

```
/* Completed task */
div.fc-event.completed-task div.fc-event-inner
{
    background-image: url('checkbox-icon.png');
    background-position: bottom right;
    background-repeat: no-repeat;
} 
```

然后，您只需将事件对象上的“className”字段设置为“完成任务”。您可以在服务器上或在 JavaScript 中执行此操作。

**选项 2：** 如果您需要比仅显示背景图像更复杂的东西，您可以使用 fullcalendar 提供的“eventRender”或“eventAfterRender”回调，以便以您喜欢的任何方式操作事件对象的 DOM 元素（包括添加复选框）。

# authentication - 服务堆栈与 IIS 中的文件服务性能

> ID：11850812
> 
> 赞同：3
> 
> 时间：2012-08-07T17:08:10.457
> 
> 标签：authentication, iis, servicestack

我们将服务堆栈用于 Web 服务 API。我们编写了一个“获取文件”例程来获取文件，而不是让 IIS 直接提供文件，因为我们需要服务器端身份验证逻辑。

我们`RestServiceBase<Foo>.OnGet`通过返回一个来返回一个文件`IStreamWriter`，它是这样实现的：

```
public void WriteTo(Stream responseStream)
{
    Stream filedata = File.OpenRead(_filepath);
    filedata.CopyTo(responseStream);
} 
```

**问题：**这比 IIS 直接提供文件要慢 50% 到 100%。

我是否从服务堆栈错误地返回了文件？我可以做些什么来加快速度吗？

* * *

或者，有什么方法可以将我们的身份验证方案（我们希望完全无状态，因此在服务器机器上没有缓存凭据）插入 IIS，以便 IIS 以某种方式调用我们的服务器来验证每个请求，然后提供文件本身?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T21:20:33.373

### 本机代码与托管代码

IIS 将使用本机代码来提供静态文件，并且可能会采用一些积极的内存缓存来实现其性能。

由于 ServiceStack 是一个 .NET 库，其代码直接写入 ASP.NET 的响应流，因此在托管 .NET 代码中流式传输文件时更难获得更快的速度。您可以通过将文件加载到内存中并改为写入原始字节来进一步提高性能。

### 利用 HTTP 缓存

这就是为什么如果您必须使用托管代码，您应该尽最大努力利用 HTTP 缓存，这是我们在[StaticFileHandler](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/WebHost.EndPoints/Support/StaticFileHandler.cs)中所做的- 即 ServiceStack 用于提供其静态内容的内容，例如 css/js/html 页面。

### 注册一个原始 HttpHandler

尽管 ServiceStack 的请求管道已经过高度优化（即不会增加太多开销），但您仍然可以通过注册自己的自定义来绕过它并自己`IHttpHandler`处理原始 ASP.NET 请求 - 这将是 .NET 代码中最快的选项，例如：

```
SetConfig(new EndpointHostConfig { 
    RawHttpHandlers = { MiniProfilerHandler.MatchesRequest },
}); 
```

这就是内置 MiniProfiler 用来提供其静态内容的内容。[MatchesRequest](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/MiniProfiler/UI/MiniProfilerHandler.cs#L21)只需要计算`IHttpRequest`它是否应该处理请求（通过返回 IHttpHandler 的实例）或不（返回 null）：

```
public static IHttpHandler MatchesRequest(IHttpRequest request)
{
    var file = Path.GetFileNameWithoutExtension(request.PathInfo);
    return file != null && file.StartsWith("ss-") 
        ? new MiniProfilerHandler()
        : null;
} 
```

除此之外，ServiceStack 的独立版本（即 HttpListener 主机）应该提供比 ASP.NET 更好的原始吞吐量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T10:07:46.643

在 IIS I/O 线程到 CLR 线程池上的线程的上下文切换中存在惩罚，如果您将 (asp config) MaxConcurrentRequestsPerCPU 设置为 0 您的 CLR 代码，您应该能够减轻这种情况（可能有其他后果尽管）

请参阅 [http://blogs.msdn.com/b/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx](http://blogs.msdn.com/b/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx)

我不知道windows是否允许“零复制”：文件（从不离开内核模式并跳过套接字上的缓冲区到文件句柄操作）但如果支持，IIS肯定会使用它（使其比用户中的CLR更快模式 .. ）

# iphone - 在 iOS 上绘制图形：使用图层还是覆盖 drawRect？

> ID：11850813
> 
> 赞同：2
> 
> 时间：2012-08-07T17:08:15.073
> 
> 标签：iphone, ios, ipad, calayer, drawrect

通读文档，我不清楚覆盖 UIView 的 drawRect 或使用图层是否合适。

我将渲染两种图表。折线图和单条条形图。两者都会有沿轴的刻度和与刻度对齐的文本。下面我只显示每个轴的四个刻度，但可能还有更多。

1.  绘制刻度的更好方法是什么？我应该为每个刻度使用一个单独的图层，还是使用在单独的视图上一次渲染它们*`drawRect`*？

2.  *`UILabel`*除了为每个文本使用单独的文本之外，还有其他方法来呈现文本吗？

3.  对于条形图，我使用的*`CAGradientLayer`*是条形图。对于折线图，甚至可以使用图层来渲染它吗？

**示例图**

![在此处输入图像描述](../Images/abcb19c4261ff66531502d715da2fa1f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T17:20:14.427

最后，我使用了覆盖`drawRect`和`CALayer`/的组合`CAShapeLayer`。现在已经完成了从头开始实现这一切的过程，我将使用形状和图层。

形状和层的方法非常高效，并且是一种更强大的解决方案。最后，如果你在做动画之类的事情，它需要更少的代码。

# c++ - Arduino阵列内存使用

> ID：11850815
> 
> 赞同：0
> 
> 时间：2012-08-07T17:08:35.757
> 
> 标签：c++, arrays, string, arduino

如果我在全局范围内声明一个数组，它会占用内存来存储它。但是，如果我在函数（例如）中声明一个数组（我使用两种类型，一种是 char 数组，另一种是 int 数组），`setup()`一旦数组超出范围，内存会自动释放吗？

我相信这发生在一些变量上，比如 int 或 byte。我只是想知道这是否也适用于数组。

另外，由于我读到了包含大量字符串的程序，因此最好将它们存储在程序空间中，进行诸如

```
lcd.print("Hello") 
```

函数结束后仍然用完“Hello”字符串的内存（假设打印函数没有将它存储在其他地方）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:11:59.110

对于第二个问题：

宏会将字符串存储在`F()`progmen 中，而不是使用[RAM](http://en.wikipedia.org/wiki/Random-access_memory)，因此您不再有此问题：

```
lcd.print(F("Hello")); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-10T12:21:27.540

至于你的第一个问题：是的。函数内部声明的所有变量只在函数内部有效，直到函数返回，然后自动释放。这有一些含义：

1.  在变量超出范围之后，例如，在函数返回之后，您*不能使用指向本地声明变量的指针。*（*不要*从您的函数返回指向本地数组的指针！） - 但是，从声明块/函数中调用其他函数时，将该指针传递给其他函数是完全合法*的*。

2.  局部变量存储在本地堆栈中，因此当调用函数时，堆栈需要有足够的空间增长相应的字节数。

3.  这些变量使用的内存量*不*计入*编译时*“已用”RAM 的计算中。

# haskell - 列表列表列表

> ID：11850821
> 
> 赞同：12
> 
> 时间：2012-08-07T17:08:51.650
> 
> 标签：haskell

什么是表示类型的好方法`LoL a`，作为...的列表列表`a`？嵌套级别是任意的，但在外部列表的所有元素上都是统一的。

我想到的情况是对列表的成员应用分组，然后对每个子组应用下一个分组，依此类推。预先不知道一个人必须申请多少个分组。因此：

```
rGroupBy :: [(a -> a -> Bool)] -> [a] -> [...[a]...] 
```

类型签名的额外布朗尼点`rGroupBy`;-)

例子：

假设`deweyGroup i`根据第 i 个数字对元素进行分组

```
rGroupBy [deweyGroup 1, deweyGroup 2] 
         ["1.1", "1.2.1", "1.2.2", "2.1", "2.2", "3"] 
```

给出：

```
[ [ [ "1.1" ], [ "1.2.1", "1.2.2" ] ],
  [ [ "2.1" ], [ "2.2" ] ],
  [ [ "3" ] ]
] 
```

**后记**

一天后，我们有 4 个优秀且互补的解决方案。我对答案很满意；谢谢你们。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-07T21:22:35.593

强制所有分支具有相同深度的约束的另一种方法是使用嵌套数据类型：

```
data LoL a = One [a] | Many (LoL [a])

mapLoL :: ([a] -> [b]) -> LoL a -> LoL b
mapLoL f (One xs) = One (f xs)
mapLoL f (Many l) = Many $ mapLoL (map f) l

rGroupBy :: [a -> a -> Bool] -> [a] -> LoL a
rGroupBy [] xs = One xs
rGroupBy (f:fs) xs = Many $ mapLoL (groupBy f) $ rGroupBy fs xs 
```

扩展 的定义`LoL`，我们非正式地看到，

```
LoL a = [a] | [[a]] | [[[a]]] | ... 
```

然后我们可以说，例如：

```
ghci> rGroupBy [(==) `on` fst, (==) `on` (fst . snd)] [ (i,(j,k)) | i<-[1..3], j<-[1..3], k<-[1..3]] 
```

去取回

```
Many (Many (One [[[(1,(1,1)),(1,(1,2)),(1,(1,3))]],[[(1,(2,1)),(1,(2,2)),(1,(2,3)), ... 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-07T17:58:51.083

你实际上拥有的是一棵树。尝试用递归数据结构表示它：

```
data LoL a = SoL [a] | MoL [LoL a] deriving (Eq, Show)

rGroupBy :: [(a -> a -> Bool)] -> [a] -> LoL a
rGroupBy (f:fs) = MoL . map (rGroupBy fs) . groupBy f
rGroupBy []     = SoL

deweyGroup :: Int -> String -> String -> Bool
deweyGroup i a b = a!!idx == b!!idx where idx = 2*(i-1) 
```

`rGroupBy [deweyGroup 1, deweyGroup 2] ["1.1", "1.2.1", "1.2.2", "2.1", "2.2", "3.0"]`给出：

```
MoL [MoL [SoL ["1.1"],
          SoL ["1.2.1","1.2.2"]],
     MoL [SoL ["2.1"],
          SoL ["2.2"]],
     MoL [SoL ["3.0"]]
    ] 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-07T21:18:45.217

如果你想强制执行统一深度，有一个（相当）标准的技巧可以做到这一点，涉及多态递归。我们要做的是有一个“更深”的构造函数来告诉列表嵌套的深度，然后是一个带有深度嵌套列表的最终“here”构造函数：

```
data GroupList a = Deeper (GroupList [a]) | Here a deriving (Eq, Ord, Show, Read) 
```

实际上，定义的类型有一个美学选择，您可能希望在代码中有所不同：`Here`构造函数采用单个`a`而不是`a`s 列表。这种选择的后果有点分散在这个答案的其余部分。

这是一个显示列表列表的此类值的示例；它有两个`Deeper`对应于它所拥有的深度二嵌套的构造函数：

```
> :t Deeper (Deeper (Here [[1,2,3], []]))
Num a => GroupList a 
```

下面是一些示例函数。

```
instance Functor GroupList where
    fmap f (Here   a ) = Here   (f a)
    fmap f (Deeper as) = Deeper (fmap (fmap f) as)
    -- the inner fmap is at []-type

-- this type signature is not optional
flatten :: GroupList [a] -> GroupList a
flatten (Here   a ) = Deeper (Here a)
flatten (Deeper as) = Deeper (flatten as)

singleGrouping :: (a -> a -> Bool) -> GroupList [a] -> GroupList [a]
singleGrouping f = flatten . fmap (groupBy f)

rGroupBy :: [a -> a -> Bool] -> [a] -> GroupList [a]
rGroupBy fs xs = foldr singleGrouping (Here xs) fs 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-07T19:37:54.400

我相信下面的例子应该接近你的想法。首先我们声明类型级别的自然数。然后我们定义向量，将它们的长度作为幻像类型（参见[Haskell 中的固定长度向量，第 1 部分：使用 GADT](http://www.haskell.org/pipermail/haskell/2005-May/015815.html)）。然后我们为 ... 的列表的嵌套列表定义一个结构，该结构将深度作为幻像类型。最后我们可以定义正确的类型`rGroupBy`。

```
{-# LANGUAGE GADTs #-}
{-# LANGUAGE EmptyDataDecls #-}

import Data.List (groupBy)

data Zero
data Succ n

data Vec n a where
    Nil  ::                 Vec Zero a
    Cons :: a -> Vec n a -> Vec (Succ n) a

data LList n a where
    Singleton :: a           -> LList Zero a
    SuccList  :: [LList n a] -> LList (Succ n) a

-- Not very efficient, but enough for this example.
instance Show a => Show (LList n a) where
    showsPrec _ (Singleton x)   = shows x
    showsPrec _ (SuccList lls)  = shows lls

rGroupBy :: Vec n (a -> a -> Bool) -> [a] -> LList (Succ n) a
rGroupBy Nil
    = SuccList . map Singleton
rGroupBy (Cons f fs)
    = SuccList . map (rGroupBy fs) . groupBy f

-- TEST ------------------------------------------------------------

main = do
    let input = ["1.1", "1.2.1", "1.2.2", "2.1", "2.2", "3"]

    -- don't split anything
    print $ rGroupBy Nil input
    -- split on 2 levels
    print $ rGroupBy (Cons (deweyGroup 1) 
                           (Cons (deweyGroup 2) Nil))
               input 
  where
    deweyGroup :: Int -> String -> String -> Bool
    deweyGroup i a b = a!!idx == b!!idx where idx = 2*(i-1) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-09T04:15:30.497

作为一个类型黑客练习，可以使用标准列表来实现这一点。

我们只需要一个任意深度的 groupStringsBy 函数：

```
{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances, FlexibleContexts,
  UndecidableInstances, IncoherentInstances,
  TypeFamilies, ScopedTypeVariables #-}

import Data.List
import Data.Function

class StringGroupable a b where
    groupStringBy :: Pred -> a -> b

instance (StringGroupable a b, r ~ [b]) => StringGroupable [a] r where
    groupStringBy f = map (groupStringBy f)

instance (r ~ [[String]]) => StringGroupable [String] r where
    groupStringBy p = groupBy p 
```

像这样工作：

```
*Main> let lst = ["11","11","22","1","2"]
*Main> groupStringBy ((==) `on` length) lst
[["11","11","22"],["1","2"]]
*Main> groupStringBy (==) . groupStringBy ((==) `on` length) $ lst
[[["11","11"],["22"]],[["1"],["2"]]] 
```

所以我们可以直接使用这个函数（虽然要倒序排列）：

```
inp = ["1.1", "1.2.1", "1.2.2", "2.1", "2.2", "3"]

deweyGroup :: Int -> String -> String -> Bool
deweyGroup i a b = a!!idx == b!!idx where idx = 2*(i-1)

-- gives: [[["1.1"],["1.2.1","1.2.2"]],[["2.1"],["2.2"]],[["3"]]]
test1 = groupStringBy (deweyGroup 2) . groupStringBy (deweyGroup 1) $ inp 
```

但是如果你想使用你的原始样本，我们也可以破解它。首先，我们需要一个可变参数函数，它将所有参数（但最后一个以相反的顺序）通过管道`.`传递，然后将结果函数应用于最后一个参数：

```
class App a b c r where
    app :: (a -> b) -> c -> r

instance (b ~ c, App a d n r1, r ~ (n -> r1)) => App a b (c -> d) r where
    app c f = \n -> app (f . c) n

instance (a ~ c, r ~ b) => App a b c r where
    app c a = c a 
```

像这样工作：

```
*Main> app not not not True
False
*Main> app (+3) (*2) 2
10 
```

然后使用我们的谓词类型的自定义规则对其进行扩展`type Pred = String -> String -> Bool`：

```
type Pred = String -> String -> Bool

instance (StringGroupable b c, App a c n r1, r ~ (n -> r1)) => App a b Pred r where
    app c p = app ((groupStringBy p :: b -> c) . c) 
```

最后将其包装起来`rGroupBy`（提供`id`功能是管道中的第一个）：

```
rGroupBy :: (App [String] [String] Pred r) => Pred -> r
rGroupBy p = app (id :: [String] -> [String]) p 
```

现在它应该适用于任何数量的类型的分组谓词，`Pred`产生的深度列表等于提供的谓词的数量：

```
-- gives: [["1.1","1.2.1","1.2.2"],["2.1","2.2"],["3"]]
test2 = rGroupBy (deweyGroup 1) inp

-- gives: [[["1.1"],["1.2.1","1.2.2"]],[["2.1"],["2.2"]],[["3"]]]
test3 = rGroupBy (deweyGroup 1) (deweyGroup 2) inp

-- gives: [[[["1.1"]],[["1.2.1","1.2.2"]]],[[["2.1"]],[["2.2"]]],[[["3"]]]]
test4 = rGroupBy (deweyGroup 1) (deweyGroup 2) (deweyGroup 1) inp 
```

所以这是可能的（并且可能可以简化），但与往常一样，不建议将这种黑客用于除练习之外的任何事情。

# linux - 从bash中的文件计算Word出现

> ID：11850823
> 
> 赞同：5
> 
> 时间：2012-08-07T17:08:52.777
> 
> 标签：linux, bash, shell, uniq

对于这个非常菜鸟的问题，我很抱歉，但我对`bash`编程有点陌生（几天前开始）。基本上我想要做的是保留一个文件与另一个文件的所有单词出现

我知道我可以这样做：

```
sort | uniq -c | sort 
```

问题是在那之后我想获取第二个文件，再次计算出现次数并更新第一个文件。之后我拿了第三个文件等等。

我现在正在做的事情没有任何问题（我正在使用`grep`,`sed`和`awk`），但它看起来很慢。

我很确定有一个非常有效的方法，只需要一个命令左右，使用`uniq`，但我不知道。

你能带我走正确的路吗？

我还粘贴了我写的代码：

```
#!/bin/bash
#   count the number of word occurrences from a file and writes to another file #
#   the words are listed from the most frequent to the less one                 #

touch .check                # used to check the occurrances. Temporary file
touch distribution.txt      # final file with all the occurrences calculated

page=$1             # contains the file I'm calculating
occurrences=$2          # temporary file for the occurrences

# takes all the words from the file $page and orders them by occurrences
cat $page | tr -cs A-Za-z\' '\n'| tr A-Z a-z > .check

# loop to update the old file with the new information
# basically what I do is check word by word and add them to the old file as an update
cat .check | while read words
do
    word=${words}       # word I'm calculating
    strlen=${#word}     # word's length
    # I use a black list to not calculate banned words (for example very small ones or inunfluent words, like articles and prepositions
    if ! grep -Fxq $word .blacklist && [ $strlen -gt 2 ]
    then
        # if the word was never found before it writes it with 1 occurrence
        if [ `egrep -c -i "^$word: " $occurrences` -eq 0 ]
        then
            echo "$word: 1" | cat >> $occurrences
        # else it calculates the occurrences
        else
            old=`awk -v words=$word -F": " '$1==words { print $2 }' $occurrences`
            let "new=old+1"
            sed -i "s/^$word: $old$/$word: $new/g" $occurrences
        fi
    fi
done

rm .check

# finally it orders the words
awk -F": " '{print $2" "$1}' $occurrences | sort -rn | awk -F" " '{print $2": "$1}' > distribution.txt 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T17:59:51.430

好吧，我不确定我是否明白你想要做的事情的重点，但我会这样做：

```
while read file
do
  cat $file | tr -cs A-Za-z\' '\n'| tr A-Z a-z | sort | uniq -c > stat.$file
done < file-list 
```

现在你有了所有文件的统计信息，现在你可以简单地聚合它：

```
while read file
do
  cat stat.$file
done < file-list \
| sort -k2 \
| awk '{if ($2!=prev) {print s" "prev; s=0;}s+=$1;prev=$2;}END{print s" "prev;}' 
```

使用示例：

```
$ for i in ls bash cp; do man $i > $i.txt ; done
$ cat <<EOF > file-list
> ls.txt
> bash.txt
> cp.txt
> EOF

$ while read file; do
> cat $file | tr -cs A-Za-z\' '\n'| tr A-Z a-z | sort | uniq -c > stat.$file
> done < file-list

$ while read file
> do
>   cat stat.$file
> done < file-list \
> | sort -k2 \
> | awk '{if ($2!=prev) {print s" "prev; s=0;}s+=$1;prev=$2;}END{print s" "prev;}' | sort -rn | head

3875 the
1671 is
1137 to
1118 a
1072 of
793 if
744 and
533 command
514 in
507 shell 
```

# php - 如何在 SOAP 中发送数组？

> ID：11850824
> 
> 赞同：2
> 
> 时间：2012-08-07T17:08:53.183
> 
> 标签：php, xml, soap, soapui, soap-client

我有一个 PHP 文件，它发送 SOAP 请求

```
$client = new SoapClient('http://xyz');
$client->call('example', array('param1'=>'value2') 
```

我想使用 SoapUI 执行相同的请求：

```
<soapenv:Envelope [..]>
   <soapenv:Header/>
   <soapenv:Body>
      <urn:call soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
         <param1 xsi:type="xsd:string">example</param1>
         <param2 xsi:type="xsd:anyType">
            ??
         </param2>
      </urn:call>
   </soapenv:Body>
</soapenv:Envelope> 
```

如何在 XML 中对上述示例进行编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:17:39.950

它应该是这样的：

```
<soapenv:Envelope [..]>
   <soapenv:Header/>
   <soapenv:Body>
      <urn:call soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
         <param1 xsi:type="xsd:string">example</param1>
         <param2 xsi:type="xsd:anyType">
            <param1 xsi:type="xsd:string">value2</param1>
         </param2>
      </urn:call>
   </soapenv:Body>
</soapenv:Envelope> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:15:31.627

使用`json_encode()`然后将数组作为字符串表示形式发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T19:05:22.223

在这种情况下，有一个不错的 PHP SOAP 客户端函数：`$client->__getLastRequest()`

它表明，请求是这样构建的：

```
<param2 xsi:type="ns2:Map">
    <item xsi:type="ns2:Map">
        <key xsi:type="xsd:string">param1</key>
        <value xsi:type="xsd:string">param2</value>
    </item>
</param2> 
```

# gwt - smartgwt 绘图

> ID：11850829
> 
> 赞同：2
> 
> 时间：2012-08-07T17:09:20.013
> 
> 标签：gwt, smartgwt

我是 GWT 的新手，正在从事一个涉及 RPC 和 MySQL 的项目。我想动态绘制一个网络图，其中包括椭圆和带箭头的线。我正在考虑使用 SmartGWT DrawOval 和 DrawLinePath。

1) 仅将 SmartGWT 用于绘制形状并将 GWT 用于布局/小部件/RPC/等其他事物是否有意义？

2）我知道建议不要将 GWT 和 SmartGWT 混合使用，所以我想知道我是否可以安全地将绘图小部件与其他 GWT 组件一起使用。

3) 有没有比 SmartGWT 更好的绘图方法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:15:40.357

1.  不，您的方法不是一个好方法，因为您的第二个方法的答案。
2.  不，它不安全，因为不推荐。最好只为您的 UI 元素使用 SmartGWT 组件。但我怀疑你在这里有点困惑。只有 UI 元素不能混用。GWT 的所有其他工具（即 RPC 机制）可以并且实际上将被要求成为您的解决方案的一部分。
3.  我看到以下选项：

    *   为您的所有图层/小部件使用 SmartGWT UI 元素，当然还可以使用您确定的绘图形状来创建您的解决方案。
    *   使用 GWT 元素并使用其他绘图库来实现您的目标。可以是：[gwt-connectors](http://code.google.com/p/gwt-connectors/)、[raphaelgwt](http://code.google.com/p/raphaelgwt/)、[lib-gwt-svg](http://code.google.com/p/lib-gwt-svg/)，具体取决于连接器或简单的线条是否足以满足您的要求。
    *   使用 SmartGWT UI 元素并嵌入上述库之一以涵盖提供的元素不支持的情况。这可能很棘手，因为这种婚姻的成功并不总是得到保证，但也不能被忽视。通过使用 lib-gwt-svg，我通过这种方法取得了成功。

# javascript - 如何从 jQuery 获取变量到函数？

> ID：11850830
> 
> 赞同：1
> 
> 时间：2012-08-07T17:09:19.867
> 
> 标签：javascript, jquery, variables, scope

但是由于某种原因，当我将变量**data**放入**naughty**时，它没有**data**的内容。

```
function cookie() {
    var naughty = 'aaa';
    $.post('/cookie', function(data) {
        naughty = data;
    });
    alert(naughty); // sends "aaa"
} 
```

为什么？

**更新：**谢谢！现在我明白了，因为 $.post() 是异步的，所以 alert(naughty) 将在它被填充**数据***之前*执行。

 **现在我有一个**子问题**：当我关闭异步时，只有函数 cookie() 会推迟执行还是整个浏览器引擎会冻结，直到 AJAX 完成？

**更新2：**是的，@Kevin B，你是对的，**顽皮**永远不会被填满......我在第一个代码示例中犯了错误。我很幸运，所有答案都是有效的，只有第二个代码示例:-)

正如@Kevin B 所指出的， async=false 将在 jQuery 1.8 中贬值。它会冻结浏览器，直到请求完成......

**子问题 #2：**在这个 AJAX 请求之后，我在 cookie() 中有更多代码。那么，我可以以某种方式暂停 cookie() 的执行直到 AJAX 完成，而不用 async=false 冻结整个浏览器？还是我必须找到编码这个想法的新方法（使用完整/成功回调）？

最后编辑：我意识到我想要的是 ASYNC:FALSE ......所以我只是使用它。顺便提一句。ASYNC:FALSE 不会从 jQuery 中删除！只有特殊类型的用例才会......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-07T17:11:44.063

这是一个竞赛条件。由于 .post() 是一个异步函数，警报会在 naughty 重置为数据之前执行。

如果您希望在继续之前返回响应，您可以使用 .ajax 并将 async 设置为 false。

[如何在 jQuery 中停止 $.post 异步工作？](https://stackoverflow.com/questions/6326450/how-can-i-stop-post-in-jquery-working-asynchronously)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-07T17:12:40.770

只需这样做：

```
function cookie() {
    var naughty = 'aaa';
    $.post('/cookie', function(data) {
        naughty = data;
        callNaughty(naughty);
    });

}

function callNaughty(naughty) {
  alert(naughty); 
} 
```

**或者**

```
function cookie() {
    var naughty = 'aaa';
    $.post('/cookie').done(function(data) {
        naughty = data;
        alert(naughty)
    });
} 
```

由于`$.post()`是异步的，所以`naughty`会在响应到达后更新。

### 笔记

`async: false`在 jQuery 1.8 中已弃用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:13:36.923

这是因为 $.post 是异步的。在请求页面并且尚未调用函数（数据）时，执行立即离开该行，因此数据为空。空数据是警报接收的内容。这只能在请求完成后才能工作，例如以警报语句必须等待的同步方式

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:18:12.940

我的猜测是 $.post 正在异步工作。因此，在执行后回调之前会调用您的警报。如果您将警报放在 post 回调中，您应该得到正确的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T17:14:13.167

由于`$.post`它是一个`ajax`请求，它本质上是异步的，所以你想要做的是确保在你的`ajax`请求完成后，然后做任何你想做的事情：

```
function cookie() {
    var naughty ;
    $.post('/cookie', function(data) {
        naughty = data;
    }).done(function(){
        alert(naughty);
    });
} 
```**

# iis - 在 UrlScan.ini 中用分号指定字符串

> ID：11850833
> 
> 赞同：1
> 
> 时间：2012-08-07T17:09:42.917
> 
> 标签：iis, user-agent, ini, urlscan

我想在 IIS 6 上使用 UrlScan 阻止用户代理。但是我无法在字符串中使用分号指定用户代理。我认为这是一个非常常见的场景，但我找不到任何关于如何在 UrlScan.ini 中转义分号的答案（其中分号用于评论）。这是规则：

```
RuleList=DenyUserAgent
[DenyUserAgent]
DenyDataSection=AgentStrings
ScanHeaders=User-Agent
[AgentStrings]
Mozilla/5.0 (Windows NT 5.1; rv:6.0) Gecko/20100101 Firefox/10.0.2 
```

我对其进行了测试，它阻止了所有以“Mozilla/5.0 (Windows NT 5.1”) 开头的用户代理，因为它将字符串的其余部分视为注释。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T11:38:58.120

似乎您需要对它进行 URL 转义，即 %3B

有关示例，请参见[http://learn.iis.net/page.aspx/476/common-urlscan-scenarios/](http://learn.iis.net/page.aspx/476/common-urlscan-scenarios/)；他们有一个这样的例子是阻止查询字符串中的分号以阻止 SQL 注入攻击

# java - 通过Spring使用@Requestmapping的.jsp页面POST表单不起作用

> ID：11850834
> 
> 赞同：2
> 
> 时间：2012-08-07T17:09:47.620
> 
> 标签：java, spring, jsp, spring-mvc

当我尝试使用提交按钮在 jsp 页面中调用我的表单发布时，页面似乎正在重新加载，但我的 @Requestmapping 方法中没有发生任何事情被调用。

这是 Spring 注释的 java 方法：

```
 @RequestMapping(value = "/TimeTracking.jsp", method = RequestMethod.POST)
    public String changeTheWeek(HttpServletRequest request) {

      if ("Previous Week".equals(request.getParameter("changeWeek"))) {
          this.subtractOneWeek();
      } if ("Next Week".equals(request.getParameter("changeWeek")))
      {
        this.addOneWeek();  
      }

        return "redirect:TimeTracking.jsp";
    } 
```

这是jsp页面的表单：

```
<form name="ChangeWeek" method="POST" action="TimeTracking.jsp">
        <span> <input name="changeWeek" type="submit" value="Previous Week"/> Hours for the week of
            <%=currentWeek.firstDayOfThisWeek()%> until <%=currentWeek.lastDayOfThisWeek()%>
            <input name="changeWeek" type="submit" value="Next Week"/>
        </span>
</form> 
```

这是我的 spring-servlet.xml 文件：

```
<?xml version="1.0" encoding="windows-1252"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:aop="http://www.springframework.org/schema/aop"
xmlns:tx="http://www.springframework.org/schema/tx"
xsi:schemaLocation="
   http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
   http://www.springframework.org/schema/context
   http://www.springframework.org/schema/context/spring-context-3.0.xsd
   http://www.springframework.org/schema/mvc
   http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd
   http://www.springframework.org/schema/aop
   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
   http://www.springframework.org/schema/tx
   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

<!-- Use @Component annotations for bean definitions -->
<context:component-scan base-package="controllers, daos, map, models, session, testControllers"  scoped-proxy="targetClass" />
<!-- added this because I think it makes annotations work? -->
<context:annotation-config />

<!-- Use @Controller annotations for MVC controller definitions -->
<mvc:annotation-driven />

<bean
    class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor"
    lazy-init="false" />

<!-- Add JPA support -->
<bean id="emf"
    class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" lazy-init="false" >
    <property name="persistenceUnitName" value="SpaceTime" />
    <property name="jpaDialect" ref="jpaDialect" />
    <property name="jpaVendorAdapter" ref="jpaAdapter" />
    <property name="loadTimeWeaver">
        <bean
            class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
    </property>
</bean>
<bean id="jpaDialect" class="org.springframework.orm.jpa.vendor.HibernateJpaDialect"
    lazy-init="false" />
<bean id="jpaAdapter"
    class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"
    lazy-init="true">
    <property name="databasePlatform" value="org.hibernate.dialect.MySQLDialect" />
    <property name="database" value="MYSQL" />
    <property name="showSql" value="false" />
</bean>
<!-- Ref: http://static.springsource.org/spring/docs/2.5.x/reference/metadata.html#metadata-annotations-required -->
<bean
    class="org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor" />
<bean id="myDataSource"
    class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="com.mysql.jdbc.Driver" />
    <property name="url" value="jdbc:mysql://192.168.0.44:3306/userexample" />
    <property name="username" value="nathan" />
    <property name="password" value="nathan" />
</bean>
<!-- Add Transaction support -->
<bean id="myTxManager" class="org.springframework.orm.jpa.JpaTransactionManager" lazy-init="false" >
    <property name="entityManagerFactory" ref="emf" />  
</bean>

<!-- Use @Transaction annotations for managing transactions -->
<tx:annotation-driven transaction-manager="myTxManager"
    proxy-target-class="false" />
<!-- View resolver -->
<bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/" />
    <!-- <property name="suffix" value=".jsp"/> -->
</bean>
<!-- Use @Transaction annotations for managing transactions -->
<tx:annotation-driven transaction-manager="myTxManager" />

</beans> 
```

这是 web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" version="2.5">
 <servlet>
<servlet-name>spring</servlet-name>
<servlet-class>
  org.springframework.web.servlet.DispatcherServlet
</servlet-class>
<load-on-startup>2</load-on-startup>
</servlet>
<servlet-mapping>
<servlet-name>spring</servlet-name>
<url-pattern>*.html</url-pattern>
</servlet-mapping>
<session-config>
<session-timeout>30</session-timeout>
</session-config>
<welcome-file-list>
<welcome-file>jsp-pages/LogIn.jsp</welcome-file>
</welcome-file-list>
</web-app> 
```

这是完整的java类（不仅仅是方法）

```
package controllers;

import javax.servlet.http.HttpServletRequest;

import models.CurrentWeek;
import models.User;

import org.joda.time.MutableDateTime;
import org.joda.time.format.DateTimeFormat;
import org.joda.time.format.DateTimeFormatter;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.servlet.ModelAndView;

/**
 * this is the controller for current week, it lets you change the current week
 * and get values from the current week
 * 
     * @author CorayThan
 * 
 */
@Controller
public class CurrentWeekController {

@Autowired
private User user;

@Autowired
private CurrentWeek currentWeek;

/**
 * @return the user
 */
public User getUser() {
    return user;
}

/**
 * @param user the user to set
 */
public void setUser(User user) {
    this.user = user;
}

/**
 * @return the currentWeek
 */
public CurrentWeek getCurrentWeek() {
    if (currentWeek==null) {
        this.createNewCurrentWeek();
    }
    return currentWeek;
}

/**
 * @param currentWeek the currentWeek to set
 */
public void setCurrentWeek(CurrentWeek currentWeek) {
    this.currentWeek = currentWeek;
}

/**
 * no arg constructor
 */
public CurrentWeekController() {

}

/**
 * this is a post method called when a button is clicked on the time tracking
 * jsp page. It reloads the page with a different week
 * @param pageWeek
 * @param request
 * @return
 */

  @RequestMapping(value = "/TimeTracking.jsp", method = RequestMethod.POST)
    public String changeTheWeek(HttpServletRequest request) {

      if ("Previous Week".equals(request.getParameter("changeWeek"))) {
          this.subtractOneWeek();
      } if ("Next Week".equals(request.getParameter("changeWeek")))
      {
        this.addOneWeek();  
      }

        return "redirect:TimeTracking.jsp";
    }

/**
 * this is the default method to show the time tracking page
 * @return
 */
//  @RequestMapping(value = "/TimeTracking.jsp")
//    public ModelAndView showTimeTracking() {
//        
//        return new ModelAndView("/TimeTracking.jsp", "command", this.getCurrentWeek());
//    }

/**
 * This creates a current week object by accepting a calendar. If that
 * calendar is set to Saturday, it will set all the days in that current
 * week object as calendars otherwise it will set all the days in that week
 * starting with the current day and counting back to Monday (the first day
 * of the week)
 * 
 * @param calendar
 * @return
 */
public CurrentWeek createCurrentWeek(MutableDateTime theCurrentDate) {

    int day = checkForNull(theCurrentDate);

    switch (day) {

    case 7:
        MutableDateTime sunday = (MutableDateTime) theCurrentDate.clone();
        this.getCurrentWeek().setSunday(sunday);
        theCurrentDate.addDays(-1);
        day--;
    case 6:
        MutableDateTime saturday = (MutableDateTime) theCurrentDate.clone();
        this.getCurrentWeek().setSaturday(saturday);
        theCurrentDate.addDays(-1);
        day--;
    case 5:
        MutableDateTime friday = (MutableDateTime) theCurrentDate.clone();
        this.getCurrentWeek().setFriday(friday);
        theCurrentDate.addDays(-1);
        day--;
    case 4:
        MutableDateTime thursday = (MutableDateTime) theCurrentDate.clone();
        this.getCurrentWeek().setThursday(thursday);
        theCurrentDate.addDays(-1);
        day--;
    case 3:
        MutableDateTime wednesday = (MutableDateTime) theCurrentDate
                .clone();
        this.getCurrentWeek().setWednesday(wednesday);
        theCurrentDate.addDays(-1);
        day--;
    case 2:
        MutableDateTime tuesday = (MutableDateTime) theCurrentDate.clone();
        this.getCurrentWeek().setTuesday(tuesday);
        theCurrentDate.addDays(-1);
        day--;
    case 1:
        MutableDateTime monday = (MutableDateTime) theCurrentDate.clone();
        this.getCurrentWeek().setMonday(monday);
        break;
    default:
        this.setCurrentWeek(null);
        break;

    }
    return this.getCurrentWeek();

}

/**
 * @param theCurrentDate
 * @return
 */
private int checkForNull(MutableDateTime theCurrentDate) {
    int day = 0;
    if (theCurrentDate != null) {
        day = theCurrentDate.getDayOfWeek();
    }
    return day;
}

/**
 * makes a new current week
 * 
 * @return
 */

public CurrentWeek createNewCurrentWeek() {
    MutableDateTime dateTime = MutableDateTime.now();
    CurrentWeek currentWeek = new CurrentWeek();
    this.setCurrentWeek(currentWeek);

    return createCurrentWeek(dateTime);
}

/**
 * subtracts one week from a currentweek
 * 
 * 
 * @return
 */
public void subtractOneWeek() {

    MutableDateTime newMonday = (MutableDateTime) this.getCurrentWeek().getMonday().clone();
    newMonday.addDays(-7);

    this.setCurrentWeek(createCurrentWeek(newMonday));

}

/**
 * adds one week to a currentweek
 * 
 * @param currentWeek
 * @return
 */
public void addOneWeek() {

    MutableDateTime newMonday = (MutableDateTime) this.getCurrentWeek().getMonday().clone();
    newMonday.addDays(7);

    this.setCurrentWeek(createCurrentWeek(newMonday));
}

/**
 * TODO: make this method into a method that accepts a current week and
 * checks if you can add a week to it without going entirely into the future
 * 
 * @param currentWeek
 * @return
 */
public CurrentWeek checkIfCurrentWeekIsEntirelyInFuture() {
    return this.getCurrentWeek();

}

/**
 * returns the first day of the week as a date time
 * 
 * @return
 */

public String firstDayOfThisWeek() {

    MutableDateTime firstDay = (MutableDateTime) this.getCurrentWeek().getMonday().clone();
    firstDay.addDays(-1);

    DateTimeFormatter dateFormatter = DateTimeFormat.forPattern("MM/dd/yyyy");

    return dateFormatter.print(firstDay);
}

/**
 * returns the last day of this week as a date time
 * 
 * @return
 */

public String lastDayOfThisWeek() {

    MutableDateTime firstDay = (MutableDateTime) this.getCurrentWeek().getMonday().clone();
    firstDay.addDays(5);

    DateTimeFormatter dateFormatter = DateTimeFormat.forPattern("MM/dd/yyyy");

    return dateFormatter.print(firstDay);
}

} 
```

最后，这是表单所在的完整 TimeTracking.jsp 页面：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<jsp:useBean id="timeTracking"
class="controllers.TimeTrackingController" scope="request" />
<jsp:useBean id="currentWeek" class="controllers.CurrentWeekController"
scope="request" />
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Time Tracking Page</title>
<script type="text/javascript" src= "../javascriptpages/timeTracking.js"></script>

</head>

<body>

<div>
    <h1>User Time Tracking Page</h1>
</div>
<div id="content">

<form name="ChangeWeek" method="POST" action="TimeTracking.jsp">
        <span> <input name="changeWeek" type="submit" value="Previous Week"/> Hours for the week of
            <%=currentWeek.firstDayOfThisWeek()%> until     <%=currentWeek.lastDayOfThisWeek()%>
            <input name="changeWeek" type="submit" value="Next Week"/>
        </span>
</form>

        <table border="1">
            <tr>
                <th>Sunday</th>
                <th>Monday</th>
                <th>Tuesday</th>
                <th>Wednesday</th>
                <th>Thursday</th>
                <th>Friday</th>
                <th>Saturday</th>
            </tr>
            <tr>
                    <td><%=timeTracking.totalWorkTimeForOneDate(currentWeek.getCurrentWeek().getSunday())%>    </td>
                <td><%=timeTracking.totalWorkTimeForOneDate(currentWeek.getCurrentWeek().getMonday())%></td>
                <td><%=timeTracking.totalWorkTimeForOneDate(currentWeek.getCurrentWeek().getTuesday())%></td>
                <td><%=timeTracking.totalWorkTimeForOneDate(currentWeek.getCurrentWeek().getWednesday())%></td>
                <td><%=timeTracking.totalWorkTimeForOneDate(currentWeek.getCurrentWeek().getThursday())%></td>
                <td><%=timeTracking.totalWorkTimeForOneDate(currentWeek.getCurrentWeek().getFriday())%></td>
                <td><%=timeTracking.totalWorkTimeForOneDate(currentWeek.getCurrentWeek().getSaturday())%></td>
            </tr>
        </table>

        <input type="button" value="<%=timeTracking.displayClockButton()%>"
            onClick="clockInOrOutReloadPage()">

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:34:10.883

在您的 web.xml 中，您有 *.html 扩展名的映射，同时尝试访问映射为 .jsp 的页面。

您需要将映射更改为

> @RequestMapping(value = "TimeTracking")

并将html表单的动作修复为`action ="TimeTracking.html"`

另外，如果您是 Spring MVC 新手并想使用它的功能，请查看 Spring MVC Showcase demo [http://blog.springsource.org/2010/07/22/spring-mvc-3-showcase/](http://blog.springsource.org/2010/07/22/spring-mvc-3-showcase/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T03:40:19.583

将 spring servlet 的 web.xml url-pattern 更改为 * 或将操作名称更改为 TimeTracking.html 并将 requestmapping 的 value 属性更改为 /TimeTracking.html。从jsp页面我了解到我们使用输入类型作为按钮而不是提交并且按钮上也有一个事件，尝试更改输入类型以提交操作名称和requestmapping的值属性更改为TimeTracking.html .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T21:29:33.470

您的网址格式是 *.html。因此，将您的操作更改为*TimeTracking.html*。并将您的请求映射更改为*/TimeTracking.html*

# php - 表单输入选项的 CakePHP 自定义标签

> ID：11850835
> 
> 赞同：2
> 
> 时间：2012-08-07T17:09:50.303
> 
> 标签：php, forms, cakephp, label, cakephp-2.0

我有一个创建发票的表单，发件人和收件人表单输入取自数据库中的可用列表。

```
accounts(id,...., company_name, abn) ---> id is primary
users(id, username, title, firstname, surname,...) ---> id is primary
accounts_users(id, account_id, user_id) --->account_id from accounts, user_id from users 
```

每个用户只能属于一个帐户，但一个帐户可以有多个用户。根据登录用户的身份，表单输入是 account_id。

在发票控制器中：

```
 $accounts3=$this->User->AccountsUser->find('list', array(
        'fields'=>array('account_id','account_id'),'conditions' => array(
        'user_id' => $this->Auth->user('id'))));

$accounts=$this->User->Relationship->find('list', array('fields'=>array('receiver_id'),'conditions' =>  array('sender_id' => $accounts2))); 
```

在 addInvoice 视图中：

```
<?php
echo $this->Form->create('Invoice', array('action'=>'addinvoice'));
echo $this->Form->input('sender_id',array('label'=>'Sender: ', 'options' => array('$accounts3' => 'COMPANY NAME')));
echo $this->Form->input('receiver_id',array('label'=>'Receiver: ', 'type' => 'select', 'options' => $accounts));
echo $this->Form->input('active', array('label' => 'Schedule?', 'options' => array('1'=>'Send','0'=>'Schedule'), 'default'=>'1'));
echo $this->Form->hidden('templates_id', array('default'=>'0'));
echo $this->Form->end('Submit'); 
```

在这种情况下，“公司名称”的标签是硬编码的，需要用表中的动态标签`company_name`替换`accounts`。

更复杂一点，接收者标签需要`company_name`来自`accounts`，或者如果`company_name`是`NULL`，（所以他们是个人帐户，而不是企业帐户）它将`username`来自`users`。

尝试的解决方案：***`$sendername`在`InvoicesController`

```
$sendername=$this->User->Account->find('list', array('fields'=>array('company_name'),'conditions' => array('account_id' => $accounts3))); 
```

或者

```
$sendername=$this->User->AccountsUser->find('list', array('fields'=>array('id','company_name'),'conditions' =>  array('user_id' => $this->Auth->user('id')))); 
```

这些似乎不起作用，想知道在 CakePHP 中是否有可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T19:52:52.270

```
$accounts3 = $this->User->AccountsUser->Account->find('list', array(
    'fields' => array('company_name'),
    'joins' => array(
        array(
            'alias' => 'AccountsUser',
            'table' => 'accounts_users',
            'type' => 'left',
            'conditions' => array('AccountsUser.account_id = Account.id'),
        )    
    ),
    'conditions' => array(
        'AccountsUser.user_id' => $this->Auth->user('id'),
    )
));

// find all accounts with id => label from accounts table
// where AccountsUser.user_id = id of logged in user
// label being user.username when company_name is null or company_null if not null
$this->User->AccountsUser->Account->virtualFields['label'] = 'CASE WHEN Account.company_name IS NULL THEN User.username ELSE Account.company_name END';
$accounts = $this->User->AccountsUser->Account->find('list', array(
    'fields' => array('label'),
    'joins' => array(
        array(
            'alias' => 'AccountsUser',
            'table' => 'accounts_users',
            'type' => 'left',
            'conditions' => array('AccountsUser.account_id = Account.id'),
        ),
        array(
            'alias' => 'User',
            'table' => 'users',
            'type' => 'left',
            'conditions' => array('AccountsUser.user_id = User.id'),
        ),    
    ),
    'conditions' => array(
        'AccountsUser.user_id' => $this->Auth->user('id'),
    )
)); 
```

不确定这是否是您想要的，以及我是否正确理解了这个问题，但希望它能给您一些启发。

# c - 两台 64 位机器之间的 TCP 套接字编程

> ID：11850836
> 
> 赞同：1
> 
> 时间：2012-08-07T17:09:55.347
> 
> 标签：c, sockets

我正在尝试使用 C 中的 TCP 套接字编程实现客户端-服务器程序通信。它位于两台安装了 linux OS 的 64 位机器之间。我想在两个进程之间传输一个 c-struct。

为此，我尝试使用一个包 - unpack() 功能。

请考虑以下代码片段

```
/*---------------------------------------------------------
on the sending side I have: 
---------------------------------------------------------*/

struct packet {
 int64_t x;
 int64_t y;
 int64_t q[maxSize];
} __attribute__((packed));

int main(void)
{
 // build packet
 struct packet pkt;
 pkt.x = htonl(324);
 pkt.y = htonl(654);
 int i;
 for(i = 0; i< maxSize; i++){
    pkt.q[i] = i; **// I also try pkt.q[i] = htonl(i);**
 }
  // and then do the send
}

/*-----------------------------------------------------------------------------
 in the receiving side: 
 -----------------------------------------------------------------------------*/
struct packet {
 int64_t x;
 int64_t y;
 int64_t q[maxSize];
} __attribute__((packed));

static void decodePacket (uint8_t *recv_data, size_t recv_len)
{
 // checking size
 if (recv_len < sizeof(struct packet)) {
     fprintf(stderr, "received too little!");
     return;
 }

struct packet *recv_packet = (struct packet *)recv_data;

int64_t x = ntohl(recv_packet->x);
int64_t y = ntohl(recv_packet->y);
int i;
printf("Decoded: x=%"PRIu8" y=%"PRIu32"\n", x, y);

 for(i=0;i<maxSize;i++){
  **//int64_t res = ntohl(recv_packet->q[i]);  I also try to print res**          
  printf("%"PRIu32"\n" , recv_packet->q[i]);     
 }
} 

int main(int argc, char *argv[]){
 // receive the data and try to call decodePacket()
 int8_t *recv_data = (int8_t *)&buf; //buf is the data received
 size_t recv_len = sizeof(buf);
 **decode_packet(recv_data, recv_len);**  
}

//----------------------------------------------------------------------------- 
```

现在的问题是我在结构中正确接收 x 和 y 的值，但是对于结构中的数组 q 我收到一个奇怪的数字，可能是内存占用值，（我尝试使用 memset() 填充在从另一端接收数据之前按零排列，在这种情况下，接收到全零的值）

我不明白为什么我没有收到 struct 中数组的正确值。

**请注意**，我在放入 struct 之前填充数组时尝试使用和不使用 htonl()，另一方面：在从 struct 解码数组时使用和不使用 ntohl()

任何帮助将不胜感激，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:16:52.017

> ```
> size_t recv_len = sizeof(buf);
> decode_packet(recv_data, recv_len); 
> ```

这段代码确保将错误的大小传递给`decode_packet`. 因此，当`decode_packet`继续检查时`recv_len < sizeof(struct packet)`，该测试毫无意义 -**无论接收到多少字节，它都会通过**。

`recv`您需要从调用返回的值中获取大小。我最好的猜测是，确实您收到的字节数比您预期的要少。

* * *

虽然发送和接收结构非常方便，但它通常是徒劳的。手动序列化数据或使用一些显式机制可能是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T23:07:19.643

您没有向我们展示`send`and`recv`部分，这更有可能是错误的。我的猜测是您正确地接收了数组中的第一个项目，并且它们在某些时候“变成”垃圾，对吗？

好吧，@cnicutar 是正确的，但让我稍微扩展一下......

首先，当您调用时，`send`您必须检查返回值并查看是否所有字节都已传输。如果您的结构很大（例如大于底层套接字缓冲区），您将需要多次调用来传输整个结构。与 相同`recv`，**不要指望您会在一次`recv`通话**中收到整个消息，不要指望每个人都会收到与相应呼叫`recv`发送的相同数量的数据。`send`始终检查已收到多少字节，并`recv`在必要时再次调用（指向传入缓冲区中的正确位置并减少要接收的字节数）。

所以可能发生了什么，您没有收到足够的数据（也许您甚至没有传输所有数据）并且只有传入缓冲区的开头被填充。因此，结构的其余部分是垃圾或（当您调用时`memset`）保持零初始化。

还要注意两者`send`并`recv`返回`ssize_t`而不是`size_t`可能的负值（表示错误）。

# javascript - div调整大小事件不起作用

> ID：11850839
> 
> 赞同：1
> 
> 时间：2012-08-07T17:10:16.200
> 
> 标签：javascript, jquery, html

我有一棵展开和折叠的树，每当容器 div 改变大小时，我想做一些其他的事情，但是 .resize() 似乎没有按我的意愿工作。

我在下面的 jsfiddle 上发布了代码：

[http://jsfiddle.net/2nXtu/](http://jsfiddle.net/2nXtu/)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:13:18.663

`resize()`是用于调整浏览器窗口大小的事件。

只需将状态更新器放在重复点击事件中：

```
$('.dup').live('click', function(){
    var clone = $(this).clone();
    $(this).parent().append( clone );
    $('.height').html( $('.content-body').height() );
    $('.status').html('Resizing');
}); 
```

[这](http://jsfiddle.net/purmou/2nXtu/5/)是在行动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-14T10:19:29.283

我这样做的一种方法是使用脏检查技术。

基本上，您首先检查要监视的 div 的大小，然后注册一个以指定间隔（例如 500 毫秒）运行的函数并再次检查 div 大小。如果尺寸与触发某些事件或运行某些功能之前的尺寸相比发生了变化并存储新尺寸。如果您围绕变量创建有效的闭包，它会很好地工作。

# windows-phone-7 - Windows Phone 中的通话结束通知和启动应用程序

> ID：11850842
> 
> 赞同：0
> 
> 时间：2012-08-07T17:10:26.337
> 
> 标签：windows-phone-7

Windows Phone（任何版本）是否提供通话开始/结束通知？如果是，是否可以在通话结束时启动应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:13:41.487

不，目前这是不可能的。请参阅[其他](https://stackoverflow.com/questions/5059656/windows-phone-7-events-triggered-on-phone-call-connect-and-phone-call-disconne)问题，其中 OP 想要做类似的事情。

# iphone - UIButton 以编程方式创建但未显示在视图中（调用了 addSubview）

> ID：11850847
> 
> 赞同：1
> 
> 时间：2012-08-07T17:10:47.987
> 
> 标签：iphone, objective-c, ios, uibutton

有一个`AppDelegate`和一个`MainViewController`。在创建时，`MainViewController`设置背景图像并应将其显示在. 差不多就是这样，但我看不到。`UIButton``AppDelegate``MainViewController``UIButton`

仅出于对齐目的，我在 IB 中创建`IBOutlet`并连接了按钮。

主视图控制器.h

```
@property (strong, nonatomic) IBOutlet UIButton *searchBtn; 
```

主视图控制器.m

```
@synthesize searchBtn; 
```

AppDelegate.m

```
@synthesize mainVC;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // ViewController > setup:
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.mainVC = [[MainViewController alloc] initWithNibName:@"MainViewController" bundle:nil];
    self.window.rootViewController = self.mainVC;
    self.window.backgroundColor = [UIColor whiteColor];

    // Buttons > Set background images:
    [self.mainVC.searchBtn setImage:[UIImage imageNamed:@"search.png"] forState:UIControlStateNormal];

    [self.mainVC.view addSubview:self.mainVC.searchBtn];

    [self.window makeKeyAndVisible];

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-07T17:18:59.553

`IBOutlet`首先，如果您以编程方式创建它，则不需要。

其次，您可能希望将按钮的创建移到`viewDidLoad`视图控制器而不是`AppDelegate`. 这是您的视图控制器的业务。

`alloc init`第三，如果您以编程方式创建它，您可能应该使用您的按钮：

```
UIButton *button = [[UIButton alloc] initWithFrame:CGRectMake(...)];
[button setBackgroundImage:someImage];
[button addTarget:self action:@selector(something:) forControlEvents:UIControlEventTouchUpInside];
[self.view addSubview:button]; 
```

类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:19:32.170

您应该首先在 MainViewController 类中添加按钮，而不是 AppDelegate。

您还应该在 MainViewController 中设置视图的背景，而不是 AppDelegate。

它应该如下所示：

AppDelegate.m

@synthesize mainVC;

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // ViewController > setup:
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.mainVC = [[MainViewController alloc] initWithNibName:@"MainViewController" bundle:nil];
    self.window.rootViewController = self.mainVC;

    [self.window makeKeyAndVisible];

    return YES;
} 
```

在你的 MainViewController.m 的 viewDidLoad 中放这个

```
- (void)viewDidLoad {
    [super viewDidLoad];
    // Buttons > Set background images:
    [searchBtn setBackgroundImage:[UIImage imageNamed:@"search.png"] forState:UIControlStateNormal];

    //If you adding the button in Interface Builder you don't need to add it again
    //[self.view addSubview:self.mainVC.searchBtn];
} 
```

# regex - 使用 grep 正则表达式解析文本 从文件中的多行文本中提取文本

> ID：11850855
> 
> 赞同：1
> 
> 时间：2012-08-07T17:11:15.033
> 
> 标签：regex, linux, grep

我在文件中有一大段文本：

```
<tr bgcolor="#F9F9F9">
     <td align="left">8/7/2012 11:23:42 AM</td>
     <td align="left"><em>Here is the text I want to parse out</em></td>
     <td class="ra">9.00</td>
     <td class="ra">297.00</td>
     <td class="ra">0.00</td>
     <td class="ra">0.00</td>
     <td class="ra">$0.00</td>
     <td class="ra">$0.50</td>
     <td class="ra"></td>
 </tr> 
```

使用 grep 我想最终得到的结果是

**这是我要解析的文本**

我现在正在处理代码

```
cat file.txt | grep -m 1 -oP '<em>[^</em>]*' 
```

但这不起作用...感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:17:32.273

正确的正则表达式是`(?<=<em>).*?(?=</em>)`.

所以，试试：

```
grep -m 1 -oP '(?<=<em>).*?(?=</em>)' file.txt 
```

# mysql - 借方/贷方/支付服务的数据库设计

> ID：11850856
> 
> 赞同：2
> 
> 时间：2012-08-07T17:11:42.847
> 
> 标签：mysql, database, database-design, accounting

我有一个我正在设计的网络服务，它向用户支付完成某些任务的费用。例如，如果用户点击一个链接，他们将获得 0.10 美元到他们的帐户。用户每天最多可以执行 20 次这些任务中的任何一项。为了让用户请求向他们支付资金，他们的账户余额必须为 5 美元。

我正在尝试确定跟踪交易和账户的最佳方式。我的设计目前看起来如下：

```
Accounts
---------
| account_id | member_id | balance  |
-------------------------------------
| 1          | 1         | 497.8500 | -- System Account
| 2          | 5         | 2.1500   |

Transactions
------------
| transaction_id | account_id | type_id | task_id | date | amount |
-------------------------------------------------------------------
| 1              | 1          | Debit   | 1       | date | -1.10  |
| 2              | 2          | Credit  | 1       | date | 1.10   |
| 3              | 1          | Debit   | 1       | date | -1.05  |
| 4              | 2          | Credit  | 1       | date | 1.05   | 
```

这种设计基于复式记账的会计原则。现在我的困境是：从技术上讲，用户在请求“支付”之前不会收到这笔钱。“支付”包括用户提交请求、请求被批准、从他们的账户余额中扣除的钱并通过 PayPal 发送给他们。所以我的问题是，如果用户尚未请求付款，从系统余额中实际扣除金额是否是个好主意？他们账户中的钱可用于为网站上的其他东西提供资金，它也会在 30 天不活动后过期。

我的想法是保持交易表不变，并设计另一个名为 payouts 的表，其结构如下

```
Payouts
-------
| payout_id | account_id | date | amount |
------------------------------------------
| 1         | 2          | date | $2.00  | 
```

但是，我如何在交易表中反映支出？似乎不完整。

我是否应该将任务与交易表分开并仅在用户请求付款时才输入交易记录？我不确定这样做是否会失去审计能力。

有没有人有一些见识？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:44:36.847

只需使用另一个帐户/分类帐/资产负债表代码

```
So on getting the 10c 
Your account is - 10c
Their payout account is + 10c
When the balance on their payout account > $5, then can request one.
When they do debit the amount from payout account, credit it to Payoutpending account
When it confirmed debit payout pending and credit payed out.
If it's rejected debit payout pending and credit payout account 
```

.

哦，你真的需要考虑存储余额，而不是计算和报告它，你会陷入正确的混乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:21:30.470

关于跟踪付款的业务要求是什么？

您的企业是否需要以日期、金额等作为单独事件（双重输入）来跟踪付款，还是他们只需要知道已请求付款。

如果以上任何一种情况属实，或者很有可能，考虑到其他公司的做法（想想合并），最好附上一个支付表，就像你跟踪支付一样。

您能否详细说明复式输入的要求。我会尝试在您的设计中尽可能明确地保留业务规则。

希望这可以帮助。我们可以在评论中继续对话，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:28:27.340

我的记账能力有限，所以虽然希望能帮上忙，但我觉得我不完全有资格给你一个答案。。

因此，虽然我认为您相当接近纯会计模型，但我认为在这种情况下，支出也应该是交易。

如果用户需要了解何时将现金添加到他们的帐户，则此列表还应包含支出。如果用户收到 5 倍的 1 美元，一次支付 5 美元，他的账户余额应该最终为 0。

因此，由于您正确地进行了两项交易，这意味着实际付款会从他们的帐户中扣除 5 美元，但这也需要去某个地方。所以我觉得一旦支付，应该有一个单独的账户“支付”。

但是.. 我的程序员想知道.. 在这种情况下，您真的想要在您的数据库中进行双重簿记吗？实际付款时，无需使用系统账户即可推算所有数字。

因此，您实际上并没有错过任何真实信息。如果现金确实总是来自系统帐户，并且用户无法将余额转移到其他帐户。

# ruby - 我如何找出红宝石中不同图像之间的颜色相似性？

> ID：11850859
> 
> 赞同：1
> 
> 时间：2012-08-07T17:12:04.397
> 
> 标签：ruby, image, image-processing

假设，我有一堆彩色图片，我想按它们的主要颜色对它们进行分组。所以最后我得到所有蓝色的图片，黄色的，绿色的，灰色的和其他不同的组，有点像谷歌图片搜索可以做到。此外，我不想要少于 3 张图片的组，并将属于这些组的图片放入下一个最佳颜色组（所以我也需要组相似度）。

我该怎么办？我不知道。

在红宝石。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:27:40.247

我会使用具有欧几里得距离的颜色直方图来测量图像之间的颜色相似度。 [单击此处](http://scien.stanford.edu/pages/labsite/2002/psych221/projects/02/sojeong/)并搜索颜色直方图定义。这是解决此类问题的一种非常简单的方法

# xaml - 在 C#/XAML Metro 应用程序中封装网页

> ID：11850863
> 
> 赞同：0
> 
> 时间：2012-08-07T17:12:36.120
> 
> 标签：xaml, windows-runtime, windows-store-apps, winrt-xaml

在 msdn 文档中，它说在 HTML/CSS/JS Metro 应用程序中可以将 iFrame 添加到页面，并且可以从“网络上下文”加载网站内容

对于这个 Metro 应用程序，我更愿意使用 C#/XAML 工作，我只想用它来封装一个网站。

在 XAML 页面中显示网站的正确方法是什么？XAML 中是否有等效的 iFrame？可以做成全屏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:23:16.673

您可以使用 WebView 类在 XAML 应用程序中显示 HTML 内容。

# java - 如何通过电子邮件 Android 发送从相机拍摄的照片

> ID：11850864
> 
> 赞同：2
> 
> 时间：2012-08-07T17:12:36.910
> 
> 标签：java, android, eclipse

我正在编写一个用于教育目的的应用程序，其中用户从相机拍摄照片并通过电子邮件发送。我写了几乎所有的代码，除了代码 whi 但我不知道怎么做，因为我正在学习 android。这是我的代码，我应该在这段代码中添加什么：

```
package com.umer.practice2;

 import java.io.IOException;

 import android.app.Activity;
 import android.content.Intent;
 import android.graphics.Bitmap;
 import android.os.Bundle;
 import android.view.View;
 import android.widget.Button;
 import android.widget.EditText;
 import android.widget.ImageButton;
 import android.widget.ImageView;
 import android.widget.TextView;

 public class SendPhoto extends Activity implements View.OnClickListener{

TextView tv1,tv2;
EditText e1,e2;
ImageView pi;
ImageButton pb;
Button pb1,pb2;
Intent photo;
Bitmap bmp;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.sendphoto);

    pb1.setOnClickListener(this);
    pb2.setOnClickListener(this);

    pb.setOnClickListener(this);
    initializeView();
}

private void initializeView() {
    // TODO Auto-generated method stub
    tv1= (TextView) findViewById(R.id.pt1);
    tv2= (TextView) findViewById(R.id.pt2);

    e1= (EditText) findViewById(R.id.pe1);
    e2= (EditText) findViewById(R.id.pe2);

    pi= (ImageView) findViewById(R.id.p1);
    pb= (ImageButton) findViewById(R.id.pib2);

    pb1= (Button) findViewById(R.id.pbut1);
    pb2= (Button) findViewById(R.id.pbut2);
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub

    switch(v.getId())
    {
    case R.id.pbut1:
        String email[]={e2.getText().toString()};

        Intent emailIntent= new Intent(android.content.Intent.ACTION_SEND);
        emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, email);
        emailIntent.setType("image/jpeg");
        startActivityForResult(emailIntent, 1);
        break;
    case R.id.pib2:
        photo= new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
        startActivityForResult(photo,2); 
        break;
    case R.id.pbut2:
        try {
            getApplicationContext().setWallpaper(bmp);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        break;
    }
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    // TODO Auto-generated method stub
    super.onActivityResult(requestCode, resultCode, data);

    Bundle extras = data.getExtras();
    bmp = (Bitmap) extras.get("data");
    pi.setImageBitmap(bmp);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:36:03.777

在您的 onActivityResult 方法中，您应该将位图保存到 SD 卡上的文件中，接下来您应该将文件附加到电子邮件意图中。

如何将图像保存到 SD 卡上的文件 [如何将位图保存到手机的图库中？](https://stackoverflow.com/questions/8686007/how-to-save-a-bitmap-into-phones-gallery)

如何将文件附加到电子邮件意图： [尝试将文件从 SD 卡附加到电子邮件](https://stackoverflow.com/questions/587917/trying-to-attach-a-file-from-sd-card-to-email)

# c++ - 如何在 C++ 中重定向断言输出？

> ID：11850867
> 
> 赞同：0
> 
> 时间：2012-08-07T17:12:52.900
> 
> 标签：c++, redirect, assert, stderr, ofstream

当参数为假时，是否可以将*断言*输出重定向到文件？我知道它的默认行为是向 stderr 写一条消息，但是以下内容没有按我的预期工作：

```
#include <iostream>
#include <assert>
#include <fstream>
using namespace std;
//---------------------------------------------------------------------------
int main(int argc, char* argv[])
{
   ofstream ofs;
   ofs.open("test.txt", ios_base::out);
   ofs << "A";
   cerr << "B";
   cerr.rdbuf(ofs.rdbuf());
   cerr << "C";
   assert(1 == 2);
   return 0;
}
//--------------------------------------------------------------------------- 
```

结果*test.txt*：

```
AC 
```

并导致标准输出：

```
B
Assertion failed: 1 == 2, file C:\xxx\Unit1.cpp, line 14
Abnormal program termination 
```

我期待在标准输出中打印的最后两行在*test.txt*文件中。我也尝试过使用，而不是...

```
cerr.rdbuf(ofs.rdbuf()); 
```

以下：

```
freopen("test.txt", "a", stderr); 
```

但效果不佳。

我还看到一些帖子（如[C：如何将 stderr 从 System-command 重定向到 stdout 或文件？](https://stackoverflow.com/questions/3019630/c-how-to-redirect-stderr-from-system-command-to-stdout-or-file)）建议*dup2重定向流，例如在**unistd.h*中定义的 stderr 。但我在 Windows 上使用 C++Builder，它似乎不可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T18:30:46.753

您可以将所有输出重定向到 stderr，或将任何其他标准文件句柄重定向到程序开始时的文件。

```
 freopen( "error.log","w",stderr); 
```

在这里阅读：

[http://support.microsoft.com/kb/58667](http://support.microsoft.com/kb/58667)

@edit：如果输出到标准输出，那么你需要做：

```
 freopen( "error.log","w",stdout ); 
```

如果你想追加而不覆盖error.log：

```
 freopen( "error.log","aw",stdout ); 
```

# objective-c - 崩溃日志中的“应用程序特定回溯”是什么？

> ID：11850868
> 
> 赞同：4
> 
> 时间：2012-08-07T17:12:57.867
> 
> 标签：objective-c, macos, debugging

我注意到在我的应用程序在 OS X 上的崩溃日志中，第一部分之一是“特定于应用程序的回溯”。它显示了这样的内容：

```
Application Specific Backtrace 1:
0   CoreFoundation                      0x00007fff8acef716 __exceptionPreprocess + 198
1   libobjc.A.dylib                     0x00007fff8d723470 objc_exception_throw + 43
2   CoreFoundation                      0x00007fff8ad7df07 -[__NSDictionaryM setObject:forKey:] + 135
3   My App                              0x00000001030c6f72 My App + 81778
4   My App                              0x00000001030c7969 My App + 84329
5   AppKit                              0x00007fff8c3d5afa -[NSIBObjectData nibInstantiateWithOwner:topLevelObjects:] + 1012
6   AppKit                              0x00007fff8c5ec1d6 -[NSNib _instantiateNibWithExternalNameTable:] + 610
7   AppKit                              0x00007fff8c5ebf43 -[NSNib instantiateNibWithOwner:topLevelObjects:] + 254
8   AppKit                              0x00007fff8c5eb4f7 -[NSViewController loadView] + 184
9   AppKit                              0x00007fff8c593349 -[NSViewController view] + 41
10  My App                              0x00000001030cae69 My App + 97897
11  My App                              0x00000001030cbb3a My App + 101178
12  AppKit                              0x00007fff8c590322 -[NSTableView _sendDelegateHeightOfRow:] + 130
13  AppKit                              0x00007fff8c5900db -[NSTableView _uncachedRectHeightOfRow:] + 197
14  AppKit                              0x00007fff8c58ff2c -[_NSTableRowHeightStorage _cacheRowHeights] + 163
15  AppKit                              0x00007fff8c54a6f5 -[_NSTableRowHeightStorage _ensureRowHeights] + 80
16  AppKit                              0x00007fff8c5680cb -[_NSTableRowHeightStorage computeRowAtPoint:] + 38
17  AppKit                              0x00007fff8c567fd9 -[NSTableView rowAtPoint:] + 306
18  AppKit                              0x00007fff8c566af7 -[NSTableView rowsInRect:] + 375
19  AppKit                              0x00007fff8c597ca4 _NSTVVisibleRowsForUpdate + 673
20  AppKit                              0x00007fff8c5971e5 -[NSTableRowData _unsafeUpdateVisibleRowEntries] + 96
21  AppKit                              0x00007fff8c597001 -[NSTableRowData updateVisibleRowViews] + 119
22  AppKit                              0x00007fff8c56f0fb -[NSTableView viewWillDraw] + 165
23  AppKit                              0x00007fff8c44cbed __22-[NSView viewWillDraw]_block_invoke_0 + 307
24  CoreFoundation                      0x00007fff8ace80b6 __NSArrayEnumerate + 582
25  AppKit                              0x00007fff8c44c92d -[NSView viewWillDraw] + 244
26  AppKit                              0x00007fff8c44bf84 -[NSView _sendViewWillDrawInRect:clipRootView:] + 1525
27  AppKit                              0x00007fff8c4183f1 -[NSView displayIfNeeded] + 1044
28  AppKit                              0x00007fff8c4c429e -[NSClipView _immediateScrollToPoint:] + 7852
29  AppKit                              0x00007fff8c4c2342 -[NSClipView scrollToPoint:] + 268
30  AppKit                              0x00007fff8c58acdd -[NSScrollView scrollClipView:toPoint:] + 426
31  AppKit                              0x00007fff8c4c20cc -[NSClipView _scrollTo:animateScroll:flashScrollerKnobs:] + 1626
32  AppKit                              0x00007fff8c39d579 -[NSClipView _scrollTo:animate:] + 28
33  AppKit                              0x00007fff8caab2a1 __31-[NSScrollView _snapRubberBand]_block_invoke_0610 + 1989
34  AppKit                              0x00007fff8ca2412a ____NSPeriodicInvokerScheduled_block_invoke_0 + 57
35  libdispatch.dylib                   0x00007fff8a013f3d _dispatch_call_block_and_release + 15
36  libdispatch.dylib                   0x00007fff8a0100fa _dispatch_client_callout + 8
37  libdispatch.dylib                   0x00007fff8a0149ab _dispatch_after_timer_callback + 22
38  libdispatch.dylib                   0x00007fff8a0100fa _dispatch_client_callout + 8
39  libdispatch.dylib                   0x00007fff8a0122d7 _dispatch_source_invoke + 691
40  libdispatch.dylib                   0x00007fff8a011349 _dispatch_queue_invoke + 72
41  libdispatch.dylib                   0x00007fff8a0150cd _dispatch_main_queue_callback_4CF + 220
42  CoreFoundation                      0x00007fff8ac9181e __CFRunLoopRun + 1614
43  CoreFoundation                      0x00007fff8ac90dd2 CFRunLoopRunSpecific + 290
44  HIToolbox                           0x00007fff85323774 RunCurrentEventLoopInMode + 209
45  HIToolbox                           0x00007fff85323512 ReceiveNextEventCommon + 356
46  HIToolbox                           0x00007fff853233a3 BlockUntilNextEventMatchingListInMode + 62
47  AppKit                              0x00007fff8c414fa3 _DPSNextEvent + 685
48  AppKit                              0x00007fff8c414862 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 128
49  AppKit                              0x00007fff8c40bc03 -[NSApplication run] + 517
50  AppKit                              0x00007fff8c3b0656 NSApplicationMain + 869
51  My App                              0x00000001030b4554 My App + 5460
52  ???                                 0x0000000000000002 0x0 + 2 
```

我知道那是在主线程上运行的代码，但它显示在该部分中，而不是在 Thread 0 回溯中，看起来像这样：

```
Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0   libsystem_kernel.dylib          0x00007fff8588d212 __pthread_kill + 10
1   libsystem_c.dylib               0x00007fff8e1fab34 pthread_kill + 90
2   libsystem_c.dylib               0x00007fff8e23edfa abort + 143
3   libc++abi.dylib                 0x00007fff888abf87 abort_message + 257
4   libc++abi.dylib                 0x00007fff888a9936 default_terminate() + 28
5   libobjc.A.dylib                 0x00007fff8d7238f3 _objc_terminate() + 91
6   libc++.1.dylib                  0x00007fff8694c8fe std::terminate() + 20
7   libobjc.A.dylib                 0x00007fff8d72365e objc_terminate + 9
8   libdispatch.dylib               0x00007fff8a01010e _dispatch_client_callout + 28
9   libdispatch.dylib               0x00007fff8a0149ab _dispatch_after_timer_callback + 22
10  libdispatch.dylib               0x00007fff8a0100fa _dispatch_client_callout + 8
11  libdispatch.dylib               0x00007fff8a0122d7 _dispatch_source_invoke + 691
12  libdispatch.dylib               0x00007fff8a011349 _dispatch_queue_invoke + 72
13  libdispatch.dylib               0x00007fff8a0150cd _dispatch_main_queue_callback_4CF + 220
14  com.apple.CoreFoundation        0x00007fff8ac9181e __CFRunLoopRun + 1614
15  com.apple.CoreFoundation        0x00007fff8ac90dd2 CFRunLoopRunSpecific + 290
16  com.apple.HIToolbox             0x00007fff85323774 RunCurrentEventLoopInMode + 209
17  com.apple.HIToolbox             0x00007fff85323512 ReceiveNextEventCommon + 356
18  com.apple.HIToolbox             0x00007fff853233a3 BlockUntilNextEventMatchingListInMode + 62
19  com.apple.AppKit                0x00007fff8c414fa3 _DPSNextEvent + 685
20  com.apple.AppKit                0x00007fff8c414862 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 128
21  com.apple.AppKit                0x00007fff8c40bc03 -[NSApplication run] + 517
22  com.apple.AppKit                0x00007fff8c3b0656 NSApplicationMain + 869
23  com.mycompany.myapp             0x00000001030b4554 0x1030b3000 + 5460 
```

“特定于应用程序的回溯”有什么意义，为什么主线程回溯中不包含该代码？

（要清楚，我不是在问如何调试此代码，我只是在寻找有关崩溃日志本身的结构和含义的解释。谢谢！）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T18:56:44.387

这就是异常处理的工作原理。您在创建 NSException 的主线程上有一个异常（它包含有关异常的所有信息，包括当前堆栈跟踪）。抛出异常对象后，控件被传递给调用堆栈中最近的处理程序，在 throw 和 catch 点之间展开堆栈。如果一个异常没有被捕获，它会被一个称为未捕获异常处理程序的函数拦截。未捕获的异常处理程序总是会导致程序退出，但可能会在此发生之前执行一些任务。默认的未捕获异常处理程序在退出程序之前将消息记录到控制台。

因此，在您的情况下，**Application Specific Backtrace**是引发异常时的堆栈跟踪，而**Thread 0 Crashed:: Dispatch queue: com.apple.main-thread**是应用程序被杀死时的堆栈跟踪。

请注意，到目前为止，堆栈跟踪是相同的：

```
10  libdispatch.dylib               0x00007fff8a0100fa _dispatch_client_callout + 8
11  libdispatch.dylib               0x00007fff8a0122d7 _dispatch_source_invoke + 691
12  libdispatch.dylib               0x00007fff8a011349 _dispatch_queue_invoke + 72
13  libdispatch.dylib               0x00007fff8a0150cd _dispatch_main_queue_callback_4CF + 220
14  com.apple.CoreFoundation        0x00007fff8ac9181e __CFRunLoopRun + 1614
15  com.apple.CoreFoundation        0x00007fff8ac90dd2 CFRunLoopRunSpecific + 290
16  com.apple.HIToolbox             0x00007fff85323774 RunCurrentEventLoopInMode + 209
17  com.apple.HIToolbox             0x00007fff85323512 ReceiveNextEventCommon + 356
18  com.apple.HIToolbox             0x00007fff853233a3 BlockUntilNextEventMatchingListInMode + 62
19  com.apple.AppKit                0x00007fff8c414fa3 _DPSNextEvent + 685
20  com.apple.AppKit                0x00007fff8c414862 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 128
21  com.apple.AppKit                0x00007fff8c40bc03 -[NSApplication run] + 517
22  com.apple.AppKit                0x00007fff8c3b0656 NSApplicationMain + 869 
```

# excel - 通过按下宏按钮将行从一张表复制并插入到另一张表

> ID：11850874
> 
> 赞同：2
> 
> 时间：2012-08-07T17:13:21.517
> 
> 标签：excel, vba

我有这个工作簿：我需要一个宏按钮，我的用户可以单击“单击此处复制”，然后我需要一个代码来复制标题为“TC-Star Here”的工作表的第 5-25 行，并且我需要将复制的行插入（我需要粘贴的行不会自动删除以前存在的行，因此插入的行必须将以前的行向下移动）到另一个名为“时间卡”的工作表中。插入的行，我需要从单元格 A1 开始编码插入它们。因此，每次单击宏按钮时，都会复制行并插入未修改/删除的先前数据。

到目前为止我有这个代码：

```
Sub CopyInfo()
On Error GoTo Err_Execute
    Sheet2.Range("A1:F11").Value = Sheet1.Range("A1:F11").Value
    Sheet1.Range("A1:F11").Copy
    Sheet2.Range("A1").InsertCopiedCells
Err_Execute:
    MsgBox "All have been copied!"

End Sub 
```

但是每次单击该按钮时，它都会将行粘贴到现有行上。

请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T00:47:48.593

这是你正在尝试的吗？

```
Sub CopyInfo()
    On Error GoTo Err_Execute

    Sheet1.Range("A1:F11").Copy
    Sheet2.Range("A1").Rows("1:1").Insert Shift:=xlDown

Err_Execute:
    If Err.Number = 0 Then MsgBox "All have been copied!" Else _
    MsgBox Err.Description
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:18:21.850

这条线

`Sheet2.Range("A1:F11").Value = Sheet1.Range("A1:F11").Value`

正在将 Sheet2 上的这些单元格的值设置为 Sheet1 上的值 - 也就是说，它正在复制这些值并替换那里的值。然后，您正在执行复制插入操作。

删除/注释掉那一行，看看会发生什么。

另外，我相信复制区域和粘贴区域的大小必须相同。尝试制作`Sheet2.Range("A1:F11").InsertCopiedCells`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-13T08:48:37.537

简单 - 使用循环（另外，关闭 ScreenUpdating 以大大加快处理时间）以下会将名为“Sheet2”的工作表中的所有行复制到名为“Sheet1”的工作表中的同一行

```
Sub CopyOver()
    Application.ScreenUpdating = False
    For j = 1 To 1560 'Or however many rows u have
        On Error GoTo Err_Execute
        Sheets("Sheet2").Rows(j).Copy
        Sheets("Sheet1").Rows(j).Insert Shift:=xlDown
    Next j
    Application.ScreenUpdating = True
    Err_Execute:
        If Err.Number = 0 Then MsgBox "All have been copied!" Else _
        MsgBox Err.Description
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-11T06:33:20.120

Thx for the post duder~，每个答案提供者都解决了我的问题~。
这是我在 excel 中的编码使用，每个选择都将插入到工作表 2，

```
 Private Sub CommandButton2_Click()

      Selection.Copy
      Sheet2.Range("A4").Rows("1:1").Insert Shift:=xlDown
      Sheets("Sheet1").Select
      Application.CutCopyMode = False
      Selection.Delete Shift:=xlUp

  End Sub 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-31T07:38:14.633

```
Sub Test()
    With ActiveSheet
    lastrow = .Cells(.rows.Count, "A").End(xlUp).Row
    lastrow = lastrow - 1
    MsgBox lastrow
    End With
End Sub 
```

# objective-c - AVFoundation Recording - 奇怪的错误：索引超出范围

> ID：11850876
> 
> 赞同：0
> 
> 时间：2012-08-07T17:13:28.087
> 
> 标签：objective-c, ios, avfoundation

在我的应用程序中进行视频录制时，我现在很可能发生了最奇怪的错误。使用 AVFoundation，我在视图中设置了所有内容以初始化相机。除了设备水平朝上或朝下放置时，一切都很好。我应该提到这是在 iPad 2/3 上。

根据调试器，这是一个例外：

```
*** AVCaptureFileOutput: ignoring exception '*** -[__NSArrayM objectAtIndex:]: index 0
beyond bounds for empty array' that raised during delegate method 
```

现在，只要我单击记录，就会发生此错误，并且仅当设备面朝上或面朝下水平时才会发生。如果我然后旋转设备，即使在这两个方向上，我也可以正常录制。这让我相信，当视图首次出现时设备的当前/默认方向正在影响录制。我只是不确定为什么会发生这个错误，这不是我的代码 - 我已经尝试过为`objectAtIndex:`设置断点，它什么也没返回，我为异常抛出设置了断点，这只会让我对汇编代码进行长时间的追逐。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:30:37.603

在我使用 UIWebView 之前，我也遇到过这样的事情。从这句话`ignoring exception`（我也见过）推断出来，你的应用程序不会崩溃，是吗？如果没有，那么这似乎是 Apple 代码中的内部错误，您只能做两件事：向 Apple 提交错误报告，然后执行系统所做的 - 忽略它。

# php - 我正确使用 $_POST['var'] 吗？

> ID：11850877
> 
> 赞同：1
> 
> 时间：2012-08-07T17:13:29.947
> 
> 标签：php, forms, post

所以我正在使用 wordpress，但 wordpress 社区似乎对严格的 PHP 或任何可以在这种情况下提供帮助的东西知之甚少。

我有一个名为 Gravity Forms 的插件，我用它来创建一个非常精细的表单/调查。不过，这笔交易是一个多部分的表单，我不确定如何获取从第一个到第二个的所有表单数据。

我可以通过查询字符串传递数据，但我传递了 25 个信息字段，所以它不太适合我。

提交 form1 后，我可以让它重定向到第二页，其中有一些代码，比如

```
$foo = $_POST['field_1_1']; 
```

其中 field_1_1 是前一个表单中输入的名称？

我以前使用 $_GET 查询字符串，但我不确定我刚才所说的示例是否是如何使用 $_POST

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:28:29.170

您可以`$_SESSION`在 PHP 中使用在请求之间保留的变量（最多配置您的 PHP 会话的时间——通常是几个小时）

或者，您也可以（在网络使用方面效率低下）将旧表单数据输出到`<input type="hidden">`元素中。如果您要这样做，我会考虑使用[序列化](http://php.net/manual/en/function.serialize.php)功能

如果您在大规模生产环境中做某事，您可能还想查看 memcache 或 redis db

您可能希望考虑的其他事情是使用 JS 在客户端进行分页，以便在填写所有页面后提交表单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:24:43.290

如果您打算使用单独的表单，也许您会发现使用 $_SESSION 超全局数组在会话中临时保存 $_POST 数据很有用。

或者您可以使用 JavaScript 拆分长格式并将其发送一次到最终目的地。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:14:28.083

是的，这是正确的用法。只需确保您的表单使用该`POST`方法提交即可。

只需确保（如您所愿`$_GET`）用户输入不可信。一定要清理它们以进行数据库交互。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:15:32.093

是的，像这样改变你的表格：

```
<form method="post" action="page_to_post_to.php" name="form1" id="form1">
    ....
</form> 
```

您正在将`method`to`post`和 the更改`action`为新页面。新页面是您可以从中访问`$_POST`变量的页面。

# javascript - 游戏应用程序 BIGINT UNSIGNED 值超出范围

> ID：11850878
> 
> 赞同：0
> 
> 时间：2012-08-07T17:13:33.960
> 
> 标签：javascript, mysql, sql, node.js

这是一个游戏应用程序，我希望用户在着火时受到伤害。我宁愿不允许负 hp(health points) 但这个查询正在使我的服务器崩溃，因为数据超出了范围。

```
UPDATE game_moblist set hp=GREATEST(0,(hp-100)) WHERE id=2923 
```

错误消息：#1690 - BIGINT UNSIGNED 值超出 '( `legends`. `game_moblist`. `hp`- 100)' 的范围

我认为最好的只会让0通过。我有点担心只是设置 hp 因为如果两个查询同时造成损坏，我可能会失去其中一个的效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:19:59.470

尝试反引号你的列标识符：

```
UPDATE `game_moblist` set `hp`=GREATEST(0,(`hp`-100)) WHERE `id`=2923 
```

# c++ - 指向 const 值的 const 数组指针

> ID：11850882
> 
> 赞同：10
> 
> 时间：2012-08-07T17:13:41.143
> 
> 标签：c++, arrays, constants, const-correctness

如果我创建一个全局常量值数组，例如

```
const int SOME_LIST[SOME_LIST_SIZE] = {2, 3, 5, 7, 11}; 
```

是否可以以任何方式修改 SOME_LIST？

我怎样才能写出这样的 SOME_LIST 指向一个 const 内存位置，并且本身就是一个 const 指针（即不能指向其他地方）？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-07T17:30:52.083

有 3 个主要的指针示例涉及“const”关键字。（见此[链接](http://www.cprogramming.com/tutorial/const_correctness.html)）

首先：声明一个指向常量变量的指针。指针可以移动，并改变它所指向的东西，但不能修改变量。

```
const int* p_int; 
```

其次：声明一个指向变量的“不可移动”指针。指针是“固定的”，但可以修改数据。必须声明并分配此指针，否则它可能指向 NULL，并固定在那里。

```
int my_int = 100;
int* const constant_p_int = &my_int; 
```

第三：声明一个指向常量数据的不可移动指针。

```
const int my_constant_int = 100; (OR "int const my_constant_int = 100;")
const int* const constant_p_int = &my_constant_int; 
```

你也可以使用这个。

```
int const * const constant_p_int = &my_constant_int; 
```

另一个很好的参考请看[这里](http://duramecho.com/ComputerInformation/WhyHowCppConst.html)。我希望这会有所帮助，虽然在写这篇文章时我意识到你的问题已经得到了回答......

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-08-07T17:16:36.603

你拥有它的方式是正确的。

此外，您不需要提供`SOME_LIST_SIZE`; C++ 会从初始化程序中自动计算出来。

# ios - viewControllers 初始化 *before* 应用程序 didFinishLaunching

> ID：11850883
> 
> 赞同：4
> 
> 时间：2012-08-07T17:13:41.237
> 
> 标签：ios, uiviewcontroller, uiapplicationdelegate

我发现了一个案例，在应用程序委托中的应用程序 didFinishLaunching 方法*之前调用了我的一些视图控制器的 initWithCoder 方法。*（我已经通过设置断点并查看调用顺序来确认这一点）

我正在使用故事板。UITabBarController 是初始视图控制器。部分问题在于情节提要以未知的顺序创建对象；也许它是在应用程序启动之前创建视图控制器。

无论如何，问题是我正在注册初始用户默认值。这必须在程序的任何部分查看它们之前发生。因此，我试图找到保证首先执行注册代码的位置。

有没有这样的地方？

注意：这个线程讨论了一点，但没有真正的结论......

[ViewDidLoad 在 AppDelegate didFinishLaunchingWithOptions 被执行之前运行！](https://stackoverflow.com/questions/6139667/viewdidload-runs-before-appdelegate-didfinishlaunchingwithoptions-gets-executed?rq=1)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:39:41.557

初始化用户默认值的标准方法是在应用程序委托中的“+(void)initialize”方法中：

```
+ (void)initialize
{
    if(self == [MyAppDelegate class]) {
        ...
    }
} 
```

这保证在任何委托方法收到消息之前运行。

PS：在从该方法返回之前，我在 didLaunch 方法中实例化了一大堆 viewController。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:27:28.323

这是很自然的（也是使用 InterfaceBuilder 很糟糕的原因之一）。在 application:didFinishLaunchingWithOptions: 中，您通常依赖已经从相应的 NIB/XIB 文件创建的主窗口和主视图控制器。两种解决方案：

一（首选）：在应用程序中手动实例化东西：didFinishLaunchingWithOptions:。因此，您可以控制任何初始化的执行顺序。

二：使用`__attribute__((constructor(XXX)))`函数——它们保证在main之前被调用，并且XXX数字越小，特定的构造函数被调用的越早。然而，这种方法是不可取的，因为它不是标准的 C（只是一个编译器扩展），而且它也很容易变得非常混乱。

# asana - 在任务中添加关注者

> ID：11850884
> 
> 赞同：1
> 
> 时间：2012-08-07T17:13:46.503
> 
> 标签：asana

我可以在创建任务时添加一系列关注者吗？还有addTag & addProject。该任务以只读方式写入追随者。谢谢你，鲁斯兰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T02:29:21.500

文档确实说追随者是只读的，但不是在您创建任务时。因此，当您创建任务时，像这样的一些 JSON 可以让您设置关注者：

```
{ "data" : {  "name": "task name", "workspace": 12345, "assignee" : 56123, "followers": [6677, 1234]  } } 
```

但是，一旦创建了 API，您就不能（还）通过 API 更改关注者。

# c# - 如何在编译期间从 C# 调用未知的本机函数

> ID：11850893
> 
> 赞同：3
> 
> 时间：2012-08-07T17:14:30.240
> 
> 标签：c#, interop, pinvoke, native

在运行时，我得到了一个`String`名称、一个排序的对象数组和一些关于本机函数的附加信息（dllpath、calltype 等）。

让我们假设所有信息都在一个`CallInformation`对象中。

我怎样才能调用这个本机函数？

注意： - 我在运行前没有提供 dll。- 我没有在运行前提供呼叫信息。- 我不知道运行前调用参数的数量或类型。- 我不知道运行前的返回类型。

[Web 上](http://www.codeproject.com/Articles/27298/Dynamic-Invoke-C-DLL-function-in-C)有关调用本机函数的常用信息涉及调用

*   已知 dll 中的已知函数类型
*   未知 dll 中的已知函数类型

我需要的是

*   未知 dll 中的未知函数类型

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:20:00.653

解决方案将涉及 Reflection.Emit。您必须根据您的 CallInformation 动态生成一个包含使用适当 DllImport 属性装饰的 PInvoke 签名的类。抱歉，没有代码，但考虑到冗长的 Reflection.Emit API，它不能归结为值得发布的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:17:22.393

动态制作委托签名并使用反射调用它。
只需查看如何动态创建委托、如何加载本机函数、如何使用反射调用函数并将它们连接在一起。

# android - Trigger.io 和 KendoUI Mobile - 布局/视图直到触摸才会显示

> ID：11850895
> 
> 赞同：3
> 
> 时间：2012-08-07T17:14:39.847
> 
> 标签：android, android-webview, kendo-ui, trigger.io

我正在尝试使用 trigger.io 和 Kendoui Mobile。关键是，当在模拟器上启动移动应用程序时，一切都像预期的那样工作 - 但是当它在 android 手机上运行时，布局/视图不会显示，直到您触摸屏幕或将手机转为横向，反之亦然。

曾经出现过 kendoui 的标签条，您可以毫无问题地在视图之间切换。但是如果您重定向到具有不同布局的另一个视图，您必须再次触摸屏幕以显示内容（它只显示正文的背景，直到触摸）。

Telerik 的人目前不知道它是从哪里来的，因为他们用 phonegap 对其进行了测试，没有任何问题。

也许 trigger.io 的家伙可以找出它发生的原因？

最好的问候马克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-22T16:57:43.513

看起来这是 Android 4.0 上的硬件加速问题，可能是 Kendo UI 使用的任何硬件加速转换与特定版本的 Android 之间的不幸交互。

Phonegap 似乎默认禁用了硬件加速，这就是它们不会受到影响的原因。

作为修复，我们将添加一个选项来禁用该特定 Android 版本的硬件加速，我们将在本周末推出。

# ios - ios-Facebook SDK 3.0 发布状态更新时出现错误 5

> ID：11850899
> 
> 赞同：13
> 
> 时间：2012-08-07T17:14:58.383
> 
> 标签：ios, facebook, facebook-ios-sdk

我正在尝试使用新的（测试版）facebook ios sdk 3.0 在应用程序中添加 facebook 集成。我只想在 facebook 上发布状态更新。我使用 FBLoginView 登录到 facebook。我按照 facebook 上的说明将我的应用程序 ID 放在 plist 中。我输入了一些代码发布到 facebook。

```
(void)viewDidLoad
{
[super viewDidLoad];
NSArray *perms;
perms = [NSArray arrayWithObjects:@"status_update", nil];
FBLoginView *loginview = 
[[FBLoginView alloc] initWithPermissions:perms];

loginview.frame = CGRectOffset(loginview.frame, 5, 5);
loginview.delegate = self;

[self.view addSubview:loginview];
// Do any additional setup after loading the view, typically from a nib.

}

- (IBAction)poststatus:(UIButton *)sender {
NSString *message = [NSString stringWithFormat:@"Test staus update"];

[FBRequestConnection startForPostStatusUpdate:message
                            completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {

                                [self showAlert:message result:result error:error];

                            }];
}
- (void)showAlert:(NSString *)message
       result:(id)result
        error:(NSError *)error {

NSString *alertMsg;
NSString *alertTitle;
if (error) {
    alertMsg = error.localizedDescription;
    alertTitle = @"Error";
} else {
    NSDictionary *resultDict = (NSDictionary *)result;
    alertMsg = [NSString stringWithFormat:@"Successfully posted '%@'.\nPost ID: %@", 
                message, [resultDict valueForKey:@"id"]];
    alertTitle = @"Success";
}

UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:alertTitle
                                                    message:alertMsg
                                                   delegate:nil
                                          cancelButtonTitle:@"OK"
                                          otherButtonTitles:nil];
[alertView show];
} 
```

奇怪的是，这段代码只运行一次。首次验证用户身份后，我可以成功发布 ONE 状态更新。之后，所有后续尝试都将失败，并出现 FBiOSSDK 错误 5（在控制台中，错误：HTTP 状态代码：400）。解决此问题的唯一方法是从 facebook 帐户中删除该应用程序并重新进行身份验证。我不确定问题是什么。我在网上寻找解决方案，但找不到任何东西。如果有人知道如何解决这个问题，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-07T07:02:58.433

com.facebook.sdk 错误 5 在使用 Facebook iOS sdk 时总是很烦人。大多数情况下，它附带控制台错误：HTTP 状态代码：400。它认为 Facebook iOS sdk 中有一个错误会随机产生此错误。我认为这个错误是由于某些原因而发生的，当它发生时，sdk 没有提供错误的实际原因。

**几个可能的原因**

*   sdk 中的每个请求都是通过完成块完成的，我们实际上将其作为参数传递给 completionHandler。当一个块正在进行中并发出另一个请求时，会发生此错误。一个简单的例子可能是如果您已经在某个按钮操作上编写了在 Facebook (startForPostStatusUpdate::) 上发帖的请求。在单击单个按钮时它会正常工作，但如果你双击按钮它会抛出这个错误 com.facebook.sdk 错误 5

*   如果您在当前会话未打开时尝试发布。例如，一旦使用 Facebook 登录，然后终止应用程序，然后重新打开，然后尝试在 Facebook 上共享，结果 -> com.facebook.sdk 错误 5。在这种情况下，尝试使用重新打开会话

*   Facebook 不允许重复发布相同的状态，他们认为这可能是某种垃圾邮件，例如，如果您尝试更新状态并且您已经硬编码了一个字符串，可以说 @“这是一个测试状态更新”，您再次冒充然后再次。经过 5 到 10 次尝试后，他们将不再允许您这样做。导致 com.facebook.sdk 错误 5。如果是这种情况，您应该更改您的状态字符串并尝试更新。

*   Facebook 为特定用户定义了使用 sdk 发布状态的限制。例如，如果您尝试更新状态并且您已经完成了 15 到 20 次状态更新。他们不会让你做更多 Resulting -> com.facebook.sdk error 5\. 在这种情况下，尝试从你的 Facebook 帐户取消对应用程序的授权并重新授权，或者尝试使用其他 Facebook 帐户

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-27T06:41:17.940

这个问题似乎没有答案。我检查了 SDK 附带的 FB 示例，在这些示例中也发生了相同的错误。因此，这意味着在几次状态更新 (15-20) 之后，Facebook 就达到了该特定用户的限制。如果您注销该用户并以其他用户身份登录，则可以成功发布。

如果我能找到任何扩展来限制设置，我会回复。Facebook 也不允许发布相同的帖子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T15:12:14.803

使用代理！

FB ios SDK 只是对 graph.facebook.com/....?access_token=..... 的 HTTP 请求的包装

因此，您可以轻松复制请求或使用 HTTP 代理来查看真实的服务器答案（这不是错误 5 ！）。

# unix - ipv6 我无法从外部连接

> ID：11850900
> 
> 赞同：1
> 
> 时间：2012-08-07T17:15:03.197
> 
> 标签：unix, networking, ipv6, freebsd, netbsd

我正在测试 IPv6 网络（使用 FreeBSSD .0、VMWare、NAT），但我无法通过 IPv6 地址从外部（本地主机）连接（使用 IPv4，它工作正常）。如何正确设置网络？

```
[root@ /home/osmund]# cat /etc/rc.conf
hostname=""
ipv6_activate_all_interfaces="YES"
ifconfig_em1_ipv6="inet6 2001:db8:1::1 prefixlen 64"
#ipv6_enable="YES"
ipv6_network_interface="em1"
ifconfig_le0="DHCP"
sshd_enable="YES"
# Set dumpdev to "AUTO" to enable crash dumps, "NO" to disable
dumpdev="AUTO"
[root@ /home/osmund]# ifconfig
em1: flags=8843<UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST> metric 0 mtu 1500
    options=8<VLAN_MTU>
    ether 00:0c:29:8f:45:74
    inet6 2001:db8:1::1 prefixlen 64
    inet6 fe80::20c:29ff:fe8f:4574%em1 prefixlen 64 scopeid 0x2
    inet 192.168.124.133 netmask 0xffffff00 broadcast 192.168.124.255
    nd6 options=23<PERFORMNUD,ACCEPT_RTADV,AUTO_LINKLOCAL>
    media: Ethernet autoselect
    status: active
plip0: flags=8810<POINTOPOINT,SIMPLEX,MULTICAST> metric 0 mtu 1500
    nd6 options=23<PERFORMNUD,ACCEPT_RTADV,AUTO_LINKLOCAL>
lo0: flags=8049<UP,LOOPBACK,RUNNING,MULTICAST> metric 0 mtu 16384
    options=3<RXCSUM,TXCSUM>
    inet6 ::1 prefixlen 128
    inet6 fe80::1%lo0 prefixlen 64 scopeid 0x4
    inet 127.0.0.1 netmask 0xff000000
    nd6 options=23<PERFORMNUD,ACCEPT_RTADV,AUTO_LINKLOCAL>
[root@ /home/osmund]# ping6 2001:db8:1::1
PING6(56=40+8+8 bytes) 2001:db8:1::1 --> 2001:db8:1::1
16 bytes from 2001:db8:1::1, icmp_seq=0 hlim=64 time=0.529 ms
16 bytes from 2001:db8:1::1, icmp_seq=1 hlim=64 time=0.133 ms
^C
--- 2001:db8:1::1 ping6 statistics ---
2 packets transmitted, 2 packets received, 0.0% packet loss
round-trip min/avg/max/std-dev = 0.133/0.331/0.529/0.198 ms

[root@ /home/osmund]# 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T13:45:39.220

您是否尝试过使用桥接网络？

# javascript - 超大 JavaScript 滑块添加说明

> ID：11850901
> 
> 赞同：0
> 
> 时间：2012-08-07T17:15:05.733
> 
> 标签：javascript, slider, supersized

我在超大滑块中添加了描述。它可以工作，但是当我检查代码时，包含描述的 div 是空的。

在 index.html 中：

```
 <div id="slidedescription"></div>
        ....

        slides : [ // Slideshow Images
        {image : 'img1.jpg', description : '<div"><ul><li><a href="">Text</a></li></ul></div>', title : '<h3>Text</h3>', thumb : 'img1Thumb.jpg', thumbTitle : 'Text'},
        {image : 'img2.jpg', description : '<div><ul><li><a href="">Text</a></li></ul></div>', title : '<h3>Text</h3>', thumb : 'img2Thumb.jpg', thumbTitle : 'Text'}, 
        {image : 'img3.jpg', description : '<div><ul><li><a href="">Text</a></li></ul></div>', title : '<h3>Text</h3>', thumb : 'img3Thumb.jpg', thumbTitle : 'Text'}
       ]
         });
        }); 
```

在 supersized.shutter.min.js 中：

```
 afterAnimation:function(){...

          if(a(vars.slide_description).length){
(api.getField("description"))?a(vars.slide_description).html(api.getField("description")):a(vars.slide_description).html("")
           }

           a.supersized.themeVars={ ...
           slide_description:"#slidedescription", 
```

问题是：我希望输出在 HTML 页面结果中的 div 元素中，但现在：

```
 <div id="slidedescription"> </div> 
```

是空的，我希望结果是：

```
 <div id="slidedescription">
        <div ><ul><li><a href="">Text</a></li></div>
        <div ><ul><li><a href="">Text</a></li></div>
        <div ><ul><li><a href="">Text</a></li></div>
        </div> 
```

有可能实现吗？我想是的，但你能帮我解决这个问题吗？

此致。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T12:06:45.983

你的意思是这样的吗？如果有任何帮助，请查看源代码：[http ://www.krijnen.com/opcafe.shtml](http://www.krijnen.com/opcafe.shtml)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T13:18:05.277

您应该将以下代码的适当部分添加到*theme\supersized.shutter*：

```
afterAnimation : function(){
        if (api.options.progress_bar && !vars.is_paused) theme.progressBar();
        var description = api.getField("description");
        if (typeof description != 'undefined') {
            $('#slidedescription').html(description);
        } else {
            $('#slidedescription').html('');
        }
    }, 
```

请注意，您可能还需要编辑*demo.html*文件中的路径

```
<script type="text/javascript" src="theme/supersized.shutter.min.js"> </ script> 
```

至

```
<script type="text/javascript" src="theme/supersized.shutter.js"> </ script> 
```

此外，您应该将上面的部分代码添加到 '_init: function ()' 中，该描述是在运行画廊后看到的。

# xml - 使用 servicestack 通过 REST 返回 xml 文件不变

> ID：11850910
> 
> 赞同：1
> 
> 时间：2012-08-07T17:16:08.033
> 
> 标签：xml, servicestack

嗨，我想知道是否有人修改了 servicestack 中的 restfiles 示例，以便它可以从文件系统返回未更改的 xml 文件？

换句话说，充当网络服务器（IIS、cassini 或 apache 等），但使用 servicestack 附带的 REST 映射。

目前响​​应是预先格式化的，我看不出如何改变它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T20:30:04.323

RestFiles 示例已经展示了如何[从文件系统返回物理文件](https://github.com/ServiceStack/ServiceStack.Examples/blob/master/src/RestFiles/RestFiles.ServiceInterface/FilesService.cs#L30)：

```
return new HttpResult(targetFile, asAttachment:true); 
```

这显示了使用自定义 HttpResult 返回下载文件的另一个示例：[https ://stackoverflow.com/a/9843621/85785](https://stackoverflow.com/a/9843621/85785)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T09:51:22.423

我只想展示我对原始问题的解决方案，以防其他人希望修改 restfiles 示例的行为。mod允许您在不更改文件内容的情况下将xml或其他文件类型返回给浏览器：

```
public override object OnGet(Files request)
{
    var targetFile = GetAndValidateExistingPath(request);
    var isDirectory = Directory.Exists(targetFile.FullName);
    var hasParameters = this.RequestContext.AbsoluteUri.ToString().Contains("?") ? true : false;

    if (!isDirectory && request.ForDownload)
        return new HttpResult(targetFile, asAttachment:true);

    if (string.IsNullOrEmpty(targetFile.Name) || hasParameters)
    {
        var response = isDirectory
            ? new FilesResponse { Directory = GetFolderResult(targetFile.FullName) }
            : new FilesResponse { File = GetFileResult(targetFile) };
        return response;
    }
    return new HttpResult(targetFile);
} 
```

所以基本上如果传入的请求为空或有参数，那么我们返回一个文件响应，否则我们返回一个直接显示文件内容的 HttpResult。我希望这对某人有用。

神话：如果代码有问题..让我们知道。我试图将示例转换为 .Net 4.0，但它在某处中断并且 /#!files 中的 ajax 文件内容查看和列表部分不显示。（也许我在 vs2010 转换期间在 web.config 中丢失了一些东西）。您会在不久的将来发布示例的 4.0 兼容版本吗？...再次感谢您的出色工作

# c# - 图片框上的鼠标事件？

> ID：11850914
> 
> 赞同：1
> 
> 时间：2012-08-07T17:16:23.973
> 
> 标签：c#, .net, winforms, mouseevent, picturebox

我有一个带有我制作的自定义图像的“开始”按钮。我没有弄乱 C#.net 的这一部分，但我对 VB.NET 有所了解。

我见过人们有类似`public void picturebox_MouseDown()`的东西，但似乎没有一个有效。我正在尝试在给出鼠标事件时更改图像。

`MouseDown` 会将图像更改为 StartButtonDown

`MouseUp` 将图像更改为 StartButtonUp

`MouseEnter`将图像更改为 StartButtonHover

`MouseLeave`将图像更改为 StartButtonUp

有什么具体的我应该做的吗，我已经用谷歌搜索了大约一个小时，但仍然没有找到任何可以帮助我的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T12:19:49.253

这是我写的与您需要的非常相似的东西。

```
using System;
using System.Drawing;
using System.Windows.Forms;

public partial class ImageButton : PictureBox
{
    private Image _upImage, _downImage, _hoverImage;

    [System.ComponentModel.Browsable(true),
     System.ComponentModel.Category("Images")]
    public Image UpImage
    {
        get { return _upImage; }
        set
        {
            if (value != null)
            {
                _upImage = value;
                this.Image = _upImage;
            }
        }
    }

    [System.ComponentModel.Browsable(true),
     System.ComponentModel.Category("Images")]
    public Image DownImage
    {
        get { return _downImage; }
        set
        {
            if (value != null)
            {
                _downImage = value;
            }
        }
    }

    [System.ComponentModel.Browsable(true),
     System.ComponentModel.Category("Images")]
    public Image HoverImage
    {
        get { return _hoverImage; }
        set
        {
            if (value != null)
            {
                _hoverImage = value;
            }
        }
    }

    public ImageButton()
    {
        InitializeComponent();
    }

    protected override void OnMouseDown(MouseEventArgs e)
    {
        if (DownImage != null)
            this.Image = DownImage;

        base.OnMouseDown(e);
    }

    protected override void OnMouseUp(MouseEventArgs e)
    {
        if (UpImage != null)
            this.Image = UpImage;

        base.OnMouseUp(e);
    }

    protected override void OnMouseEnter(EventArgs e)
    {
        if (HoverImage != null)
            this.Image = HoverImage;

        base.OnMouseEnter(e);
    }

    protected override void OnMouseLeave(EventArgs e)
    {
        if (UpImage != null)
            this.Image = UpImage;

        base.OnMouseLeave(e);
    }

} 
```

我所做的是继承自标准`PictureBox`以制作`ImageButton`. 我有三个属性用于在`Image`没有鼠标操作的情况下显示 (UpImage)、在`Image`触发 MouseDown 事件时显示 (DownImage) 以及`Image`在鼠标悬停在控件上时显示 (HoverImage)。

请注意，您应该添加对 MouseUp 和 MouseLeave 事件的检查。如果我单击图像并将鼠标拖离控件，控件将再次从 UpImage 转到 DownImage 再到 UpImage，因为即使我的鼠标仍然向下，我已经离开了控件 (MouseLeave)。当鼠标离开控件时，您可能希望 DownImage 保持显示。此外，当 MouseUp 事件发生时，您应该检查鼠标是否仍悬停在控件上。如果是，您将希望显示 HoverImage 而不是 UpImage。

您还可以检查使用了哪个鼠标按钮。也许您只希望图像通过左键单击来更改，而不是右键或中间。

但这应该让你开始。

# android - Android ListView setTypeFace 和 setBackgroundDrawable

> ID：11850915
> 
> 赞同：1
> 
> 时间：2012-08-07T17:16:26.680
> 
> 标签：android, android-listview, android-arrayadapter

我有一个带有 OnItemClickListener 的 ListView，我在其中设置背景以指示该行已被选中

```
itemList.setOnItemClickListener(new OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView<?> arg0, View v, int position, long id) {

        String item = (String) arg0.getItemAtPosition(position);
        boolean itemSelected = selectedItems.contains(item);

        if (!itemSelected) {
            selectedItems.add(item);
            v.setBackgroundDrawable(getResources().getDrawable(R.drawable.listitem_selected));
        } else {
            selectedItems.remove(item);
            v.setBackgroundDrawable(null);
        }
    }); 
```

如果我为我的 ListView 使用默认适配器，则 ListView 行会正确突出显示

```
ArrayList<String> listOfItems = new ArrayList<String>();

....
final ArrayAdapter<String> itemAdapter = new ArrayAdapter<String>(this, R.layout.list_item, listOfItems); 
```

如果我使用扩展 ArrayAdapter 的自定义适配器，以便我可以将 TextView 的字体设置为自定义字体，则字体会正确设置，但背景突出显示不再起作用。有任何想法吗？

```
public class ListItemAdapter extends ArrayAdapter<String> {
    private final Context context;
    private final ArrayList<String> values;

    public ListItemAdapter(Context context, ArrayList<String> values) {
        super(context, R.layout.list_item, values);
        this.context = context;
        this.values = values;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        LayoutInflater inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View rowView = inflater.inflate(R.layout.list_item, parent, false);
        TextView textView = (TextView) rowView.findViewById(R.id.text1);

        Typeface tf = Typeface.createFromAsset(getContext().getAssets(), "fonts/font-file.otf"); 
        textView.setTypeface(tf);
        textView.setText(values.get(position));
        return rowView;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:00:59.583

尝试这个。它对我有用。它也可能对你有帮助。

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View rowView = inflater.inflate(R.layout.list_item, parent, false);
    TextView textView = (TextView) rowView.findViewById(R.id.text1);

    Typeface tf = Typeface.createFromAsset(getContext().getAssets(), "fonts/font-file.otf"); 
    textView.setTypeface(tf);
    textView.setText(values.get(position));

    rowView.setOnClickListener(new OnClickListener() {              
        @Override
        public void onClick(View arg0) {
            arg0.setBackgroundResource(R.drawable.<background>);                    
        }
    });
    return rowView;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:51:41.550

您还需要在 getView() 方法中设置 rowView 背景

# ruby-on-rails - 在模型实例创建期间自动将列设置为 created_at

> ID：11850919
> 
> 赞同：0
> 
> 时间：2012-08-07T17:16:58.070
> 
> 标签：ruby-on-rails, ruby, activerecord, callback

我有以下模型（`sort_timestamp`是日期时间）：

```
class Post < ActiveRecord::Base
  [snip attr_accessible]
  acts_as_nested_set
  after_create :set_sort_timestamp

  private
  def set_sort_timestamp
    self.sort_timestamp = self.created_at
  end
end 
```

我正在使用[https://github.com/collectiveidea/awesome_nested_set](https://github.com/collectiveidea/awesome_nested_set)。此代码未设置`sort_timestamp`。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:41:36.170

除非我错过了您在这里所做的事情的重点，否则您可能正在寻找`before_create`是否希望在创建行时保存它。否则，您必须添加`self.save`到该方法中，但这会导致额外的数据库调用，因此`before_create`可能是更好的选择。

（基本上，您之前所做的流程是创建模型，将其保存到数据库中，然后对象将其属性修改`sort_timestamp`为`created_at`；这是在您的数据库提交之后，并且仅在内存中执行（所以不是持久化，除非您稍后在代码中以另一种方式持久化它）。

编辑：实际上，这可能行不通，因为 created_at 可能不会在创建记录之前设置。几个选项：

1）添加`self.save`到方法的末尾`after_create` 2）`Time.now`如果时间`sort_timestamp`和`created_at`不必完全相同则使用。或者，3) 尝试向迁移添加默认值：[How to use created_at value as default in Rails](https://stackoverflow.com/questions/9087494/how-to-use-created-at-value-as-default-in-rails)

# objective-c - 在 iSGL3d 中实现非 2 次幂纹理

> ID：11850922
> 
> 赞同：4
> 
> 时间：2012-08-07T17:17:14.193
> 
> 标签：objective-c, ios, opengl-es, isgl3d

我已经编写了一个严重依赖 iSGL3d 进行 3D 渲染的应用程序，现在我已经到了需要开始调整纹理大小的地步，因为内存分配的原因。

我的应用程序使用非常大的纹理 (1024x1024)，从那个到 512x512 是不可接受的

因此，以 GL ES 2.0 为基础，我想将我的纹理稍微减少到更接近 700x700

我知道这是可能的，因为我在前世煞费苦心地手写了使用非 2 次幂纹理的 OpenGL 代码

但是我花了很长时间试图筛选 iSGL3d 的代码以找到我可以影响这种变化的地方......现在该项目似乎被放弃了。

基本上，默认情况下，即使您使用 GLES 2.0 实例，iSGL3d 也只会制作一个二次幂位图并将您的纹理转储到其中，留下一堆透明像素。这是毫无价值的。

将纹理大小强制为非二次方图像会产生 GL 错误。我假设这是因为我没有在任何需要强制的地方正确地强制它，或者 iSGL3d 没有正确使用 GLES 2.0，因为它应该是

任何指针都会很有用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T19:16:46.513

> 仅仅通过禁用 mipmapping，即使是有效的纹理也无法绘制

您是否将这些纹理的缩小采样设置为不使用 mipmap？它默认为 mipmap 选项，因此如果您不使用 mipmap，则必须将其设置为其他值。

例如

```
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); 
```

# php - 自动加载实用程序函数

> ID：11850923
> 
> 赞同：1
> 
> 时间：2012-08-07T17:17:15.793
> 
> 标签：php, function

我有几个相互独立的函数，我曾经将它们包装在一个类中，这样我就可以通过`spl_autoload_register()`. 但是后来我的实用程序类变得如此之大，现在几乎有 1000 行。

现在我正在考虑将每个函数分离到每个类/文件中。

如果您认为这是一个好主意，您认为最好的方法是什么：

```
// load_foo.php
class load_foo
{
    public function __construct ($params,..)
    {

    }
}

// usage
new load_foo($params); 
```

或者

```
// load_foo.php
class load_foo
{
    public static function exec ($params,..)
    {

    }
}

// usage
load_foo::exec($params); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T14:07:33.550

由于显然您不使用“对象”的概念，因此最好使用“静态”选项 load_foo::exec($params);

话虽如此，我相信“将每个函数分离到每个类/文件中”。太过分了，你会得到太多的文件和类。即使这些功能不相关（如您的评论所建议的那样），请尝试将它们放入您使用自动加载器加载的几个文件中。

另一方面，您可以使用加速器，例如 APC 或 xcache。这些将保留代码的预编译版本，大大减少加载文件的性能影响。

# iphone - 将 CGPoints 集转换为 CATransform3D 以歪斜图像

> ID：11850924
> 
> 赞同：3
> 
> 时间：2012-08-07T17:17:16.917
> 
> 标签：iphone, image, core-graphics, quartz-graphics

我有一个包含梯形部分的图像，我需要将其转换为方形（去偏斜）。我真的很难理解 3D 转换矩阵，不知道从哪里开始。

目前我有 4 个 CGPoints 代表一个倾斜的形状，我也有 4 个 CGPoints 代表一个统一的矩形。我如何将最初的 4 个 CGPoints 转换为 3D 变换矩阵来歪斜图像？

我基本上是在寻找它的反面：[iPhone image stretching (skew)](https://stackoverflow.com/questions/2351586/iphone-image-stretching-skew)

第一个图像将是输入形状，方形图像将是输出。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T17:46:25.367

找到 2 个最高的 CGPoints，并将它们调平，同时对 2 个最低的 CGPoints、2 个最左边的 CGPoints 和 2 个最右边的 CGPoints 进行这个级别。

```
//assuming skewpoint1 & skewpoint2 are the highest points
if (skewpoint1.y < skewpoint2.y) 
   skewpoint1.y += speed;
   skewpoint2.y -= speed;
else
   skewpoint1.y -= speed;
   skewpoint2.y += speed; 
```

对最左边的 2 个和最右边的 2 个 CGPoints 的最低点和 x 值执行类似的操作。

您还可以添加一个捕捉功能，用于当点之间的速度小于 2xspeed 时捕捉到两者的中心点，即

```
if (abs(skewpoint1.y - skewpoint2.y) < (speed*2))
    //depending on which CGPoint is higher
    skewpoint1.y += (abs(skewpoint1.y - skewpoint2.y)/2);
    skewpoint2.y -= (abs(skewpoint1.y - skewpoint2.y)/2); 
```

# java - 哈希码（）与等于（）

> ID：11850929
> 
> 赞同：4
> 
> 时间：2012-08-07T17:17:32.903
> 
> 标签：java, collections, hashset

我有下面这两个类..

```
class Emp //implements Comparable
{
      String name,job;
      public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getJob() {
        return job;
    }
    public void setJob(String job) {
        this.job = job;
    }
    public int getSalary() {
        return salary;
    }
    public void setSalary(int salary) {
        this.salary = salary;
    }
    int salary;
      public Emp(String n,String j,int sal)
      {
         name=n;
         job=j;
         salary=sal;
       }
      public void display()
      {
        System.out.println(name+"\t"+job+"\t"+salary);
       }

  public boolean equals(Object o)
      {

         Emp p=(Emp)o;
          return this.name.equals(p.name)&&this.job.equals(p.job) &&this.salary==p.salary;
       }
  /* public int hashCode()
       {
          return name.hashCode()+job.hashCode()+salary;
       }
     */

      /* public int compareTo(Object o)
       {
          Emp e=(Emp)o;
          return this.name.compareTo(e.name);
           //return this.job.compareTo(e.job);
        //   return this.salary-e.salary;

        }*/
} 
```

另一个是..

```
import java.util.*;
class EmpHsDemo
{
      public static void main(String arg[])
      {
          HashSet set=new HashSet();
          set.add(new Emp("Ram","Trainer",34000));
          set.add(new Emp("Ram","Trainer",34000));
          set.add(new Emp("Ravi","Administrator",44000));
          set.add(new Emp("Sachin","Programmer",24000));
          set.add(new Emp("Priyanka","Manager",54000));
          set.add(new Emp("Anupam","Programmer",34000));
          set.add(new Emp("Sachin","Team Leader",54000));
          System.out.println("There are "+set.size()+" elements in the set.");
          System.out.println("Content of set are : ");
          Iterator itr=set.iterator();
          while(itr.hasNext())
          {
            Emp e=(Emp)itr.next();
            System.out.print(e.hashCode()+"\t");   
            e.display();
          }   

          System.out.println("**********************************");
        Emp e1=new Emp("Ravi","Administrator",44000);
        System.out.println("Removing following Emp from the set...");
        System.out.print(e1.hashCode()+"\t");
        e1.display();
        set.remove(e1);
        System.out.println("No. of elements after removal "+set.size());
       /* Emp e2=new Emp("Anupam","Programmer",34000);
        System.out.println("Searching following Emp in the set...");
        System.out.print(e2.hashCode()+"\t");
        e2.display();
        System.out.println("Results of searching is : "+set.contains(e2));*/
      }
} 
```

现在我正在做一项研究

> 1.  如果我评论 hashcode() 方法而不是评论 equals () 方法，它将使用它允许重复，因为 Ram 与内存地址一起显示两次，我得到以下结果..

```
There are 7 elements in the set.
Content of set are : 
374283533   Priyanka    Manager 54000
1660364311  Ram Trainer 34000
1340465859  Ravi    Administrator   44000
2106235183  Sachin  Programmer  24000
2031692173  Ram Trainer 34000
603737068   Anupam  Programmer  34000
148669801   Sachin  Team Leader 54000
**********************************
Removing following Emp from the set...
1807500377  Ravi    Administrator   44000
No. of elements after removal 7 
```

> 2\. 如果我取消注释 hashcode() 方法和 equals () 方法，我会得到这个结果

```
There are 6 elements in the set.
Content of set are : 
1546622676  Sachin  Team Leader 54000
-302767206  Anupam  Programmer  34000
149315535   Ravi    Administrator   44000
199998062   Sachin  Programmer  24000
1407883922  Priyanka    Manager 54000
597555555   Ram Trainer 34000
**********************************
Removing following Emp from the set...
149315535   Ravi    Administrator   44000
No. of elements after removal 5 
```

> 3\. 如果我只评论 equals() 方法而不是 hashcode() 那么我得到以下结果

```
There are 7 elements in the set.
Content of set are : 
1546622676  Sachin  Team Leader 54000
-302767206  Anupam  Programmer  34000
149315535   Ravi    Administrator   44000
199998062   Sachin  Programmer  24000
1407883922  Priyanka    Manager 54000
597555555   Ram Trainer 34000
597555555   Ram Trainer 34000
**********************************
Removing following Emp from the set...
149315535   Ravi    Administrator   44000
No. of elements after removal 7 
```

请告知这三种方法背后的原因是什么..！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-07T17:20:25.350

不值得阅读您发布的所有信息。

Joshua Bloch 说 hashCode 和 equals 应该一起被覆盖。 [这是](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)你应该怎么做的，没有例外。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T17:24:30.857

一个 HashSet 有许多桶。它使用`hashCode()`来确定元素属于哪个桶，然后在该桶中，它用于`equals()`查找该元素是否存在于该桶中。

这些方法的默认实现是`hashCode()`使用系统标识哈希码，这可能是它的内存位置，但其独特之处在于系统将尝试使用所有“合理实用”的尝试来使两个对象不具有相同的系统标识哈希码，和 equals 比较两个对象的内存位置。（请注意，系统身份哈希码不能保证产生唯一的哈希值；相反，它会非常、非常、非常地努力为您提供唯一的哈希值。有关此问题的进一步阅读，请参阅[Java 错误 6321873。](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6321873)）

因此，有了这些知识，可以通过各种方法的逻辑应用来预测不同的方法，无论它们是实现还是使用默认实现。

在您的第一种情况下，Ram 出现在两个不同的存储桶中，因此这两个 Ram 对象永远不会相互比较。它们使用以下行进行比较（至少在 Sun 实现中）

```
if (e.hash == hash && ((k = e.key) == key || key.equals(k))) { 
```

这是迭代桶中的每个对象。它们的哈希值不相等，因此永远不会检查确定对象本身是否等于提供的对象。

在您的第二种情况下，它可以按您预期的那样工作，请注意具有两个不同职位和薪水的人将被视为不同的人。

在您的第三种情况下，Ram 两次进入同一个存储桶。但是因为使用了默认的 equals 方法，并且这两个对象是不同的对象，所以它被添加了第二次。

同样值得重申的是，达菲莫的回答完全忽略了您的问题；在 99.9% 的情况下，我会说这是错误的做法，我们应该首先了解您的问题范围。这是极少数可以忽略您的问题的情况**之一。**你**永远不**应该只覆盖 hashcode 和 equals 之一。你应该**永远**都不做或两者都做，永远不要只做一个。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-07T17:24:34.067

**1.**当**2 个对象相等**时，它们应该有`same hashcode`.

**2.**如果有 2 个对象，`same hascode,`那么它们**必须互相调用 equals() 来查看它们是否相等。**

**3.**如果哈希码匹配**，则不需要它们都相等。**

**4.**因此，当方法被**覆盖**时，**方法也必须被覆盖，这一点****非常重要。**`equals()`**`hashcode()`**

 ******5.** `HashSet`当取一个对象时，**检查这个对象在哪里** `HashSet`，那么是否有任何具有**相同hashcode的对象，**如果有那么**两个都被放入一个**带有**标签**`same hashcode`的桶中，然后**互相**调用看看，如果他们**真的是平等的。****`equals()`**

 ***** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:31:48.077

`HashSet`用作`HashMap`数据的内部表示。`HashSet.add()`并 `HashSet.remove()`致力于`hash`价值（您在`hashCode()`方法中提供的价值。一旦您发表评论`hashCode()`，所有赌注都将取消。

在这个问题上，我的心在某种程度上与达菲莫有关，但另一方面，我几乎同样恶毒地反对做某事，因为你的权威在不理解的情况下告诉了你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T17:48:03.740

corsiKa 已正确回答。只需添加几个点来简化事情。@user1582269 您正在使用 Set Algo 和 Hashing 是使用了数据结构。根据 Set 概念 - Set 中的每个元素都应该是唯一的。不允许重复元素。在哪个基础上元素将是独一无二的？为了实现这种唯一性，应该重写 equals() 方法。即 Emp 1 应该与 Emp 2 不同。现在您使用的是 Hash Data Structure 。散列确保如何存储、检索和搜索元素。为了使散列有效地工作散列函数，即 hashCode() 应该被覆盖，这样就不会发生任何冲突。

应该阅读 corsiKa 的解释以获得关于散列的更多解释。因此，如果您不覆盖 hashCode()，默认 hashCode() 实现将返回一些存储桶 id（假设数组中的某个索引）例如 4。因此，如果 empX 元素已经存储在存储桶 id 4 中，并且对于另一个员工 empY 相同如果返回 hashCode 即 4，那么 empX 和 empY 之间就会发生冲突。

希望这能澄清你的疑问。********

# actionscript-3 - AS3 PrintJob start() Chrome 21.0.1180.60 m 打印未添加 SWF 页面

> ID：11850930
> 
> 赞同：0
> 
> 时间：2012-08-07T17:17:33.070
> 
> 标签：actionscript-3, flash, google-chrome, printing

一直在工作的代码突然不行了。

打印在所有浏览器中都可以正常工作，即使是 MAC 上的 Chrome（Chrome v: 21.0.1180.57 > 报告是最新的。）

正在通过 AddPage 添加一个影片剪辑。然后打印出来。

预期的行为是在其他浏览器中打印影片剪辑。相反，即使绕过 Chrome 的打印预览并使用标准打印预览，SWF 本身也会被打印出来。

有任何想法吗？通用代码如下。代码没有那么重要。这已经为数千名用户工作了几个月。昨天突然出现 Chrome 问题。

```
if(myPrintJob.start()) {

     if (myPrintJob.addPage(containerElement, rect, options)){
          pageCount++;
     }

     Provider.testProvider("service.userPrinted", dataStr, userPrintedResult, onFault); 

     if (pageCount > 0) {
          myPrintJob.send();
     }              
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T15:14:40.840

跟进：

其他用户报告了同样的错误。它已被 Google 工程师标记为“已启动”。有人声称他有解决办法。

[http://code.google.com/p/chromium/issues/detail?id=141082](http://code.google.com/p/chromium/issues/detail?id=141082) 请参阅下面的评论：

> 评论 11 来自 viettrun...@chromium.org，8 月 24 日（2 天前）
> 
> 可能使用 AS3 PrintJob API 并看到此问题的人在完成后忘记调用 .send()。（这会使 Pepper Flash 混淆为进行“正常”打印，而不是强制完成仍然打开的 PrintJob 并打印。）
> 
> 尽管如此，我有一个改变让它工作....
> 
> 状态：开始

# c# - 如何显示数组元素出现的次数

> ID：11850935
> 
> 赞同：6
> 
> 时间：2012-08-07T17:17:53.423
> 
> 标签：c#, arrays

我是 C# 新手，希望能在这个话题上得到一些帮助。我有一个包含元素的数组，我需要显示每个项目出现的次数。

例如，在 中`[1, 2, 3, 4, 4, 4, 3]`，`1`出现 1 次，`4`出现 3 次，以此类推。

我已经完成了以下操作，但不知道如何将其放入 foreach/if 语句中...

```
int[] List = new int[]{1,2,3,4,5,4,4,3};
foreach(int d in List)
{
    if("here I want to check for the elements")
} 
```

谢谢你，对不起，如果这是一个非常基本的......

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-07T17:21:00.947

您可以通过[Enumerable.GroupBy](http://msdn.microsoft.com/en-us/library/bb534501.aspx)处理此问题。我建议查看有关 Count 和 GroupBy 的[C# LINQ 示例](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b)部分以获取指导。

在您的情况下，这可以是：

```
int[] values = new []{1,2,3,4,5,4,4,3};

var groups = values.GroupBy(v => v);
foreach(var group in groups)
    Console.WriteLine("Value {0} has {1} items", group.Key, group.Count()); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-07T17:21:29.067

您可以保留`Dictionary`找到的项目及其相关计数。在下面的示例中，`dict[d]`通过其值引用元素。例如`d = 4`.

```
int[] List = new int[]{1,2,3,4,5,4,4,3};
var dict = new Dictionary<int, int>();
foreach(int d in List)
{
    if (dict.ContainsKey(d))
        dict[d]++;
    else
        dict.Add(d, 1);
} 
```

当`foreach`循环终止时，您将在`dict`. 您可以通过访问获取每个项目的计数`dict[d]`，其中`d`是原始列表中的某个整数值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-07T17:36:23.340

LINQ 的答案很好，但如果你想自己做：

```
int[] numberFound = new int[6];
int[] List = new int[] { 1, 2, 3, 4, 5, 4, 4, 3 };
foreach (int d in List)
{
    numberFound[d]++;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-07T17:23:31.637

```
var list = new int[] { 1, 2, 3, 4, 5, 4, 4, 3 };
var groups = list.GroupBy(i => i).Select(i => new { Number = i.Key, Count = i.Count() }); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2017-05-02T05:07:47.390

私有静态无效CalculateNumberOfOccurenceSingleLoop()

{

```
 int[] intergernumberArrays = { 1, 2, 3, 4, 1, 2, 4, 1, 2, 3, 5, 6, 1, 2, 1, 1, 2 };

        Dictionary<int, int> NumberOccurence = new Dictionary<int, int>();
        for (int i = 0; i < intergernumberArrays.Length; i++)
        {
            if (NumberOccurence.ContainsKey(intergernumberArrays[i]))
            {
                var KeyValue = NumberOccurence.Where(j => j.Key == intergernumberArrays[i]).FirstOrDefault().Value;
                NumberOccurence[intergernumberArrays[i]] = KeyValue + 1;
            }
            else
            {
                NumberOccurence.Add(intergernumberArrays[i], 1);
            }
        }
        foreach (KeyValuePair<int, int> item in NumberOccurence)
        {
            Console.WriteLine(item.Key + " " + item.Value);
        }
        Console.ReadLine();

    } 
```

# javascript - javascript改变画布中球的速度

> ID：11850936
> 
> 赞同：1
> 
> 时间：2012-08-07T17:17:58.093
> 
> 标签：javascript, html, canvas

我有一个球在画布上弹跳，我试图改变球的运动速度，但我没有让它工作。我正在尝试实现速度，就像我在做球的颜色和球的宽度一样，但它不起作用。代码中的 setInterval 改变了速度，但不能让它从 speedx 输入中获取值。

javascript:

```
function draw(){
 var canvas = document.getElementById('ball');
 context = ball.getContext('2d');
 //context.clearRect(150,50,750,750);
 context.beginPath();
 context.fillStyle="#0000ff";
 context.arc(x,y,10,20,Math.PI*2,true);
  context.closePath();
  lineColor = document.getElementById('lineColor').value;
  lineWidth = document.getElementById('lineWidth').value;
    speed = document.getElementById('speedx').value;
        setInterval(draw,speed); 

        if (lineWidth)
        {
            context.lineWidth=lineWidth;
        }
        if (lineColor)
        {
            context.strokeStyle=lineColor;
            context.stroke();
        }
} 
```

HTML：

```
 Ball Width: <input type="text" id="lineWidth"></input>
Ball Color: <input type="text" id="lineColor"></input>
Ball Speed X:<input type="text" id="speedx"></input> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:32:01.750

看起来好像您正在设置一千个计时器而从未停止以前的计时器，因为您使用的是 setInterval 而不是 setTimeout。这基本上每次调用draw时都会创建一个新的计时器，并且每次每个计时器都有一个间隔时都会调用draw。我认为这使它始终以最快的速度运行。

此外，从这段代码中还不清楚 x 和 y 的设置位置。

此外，在每次迭代中查找上下文并不是最佳性能。

# linux - 如何使用正则表达式重命名 linux shell 中的文件？

> ID：11850943
> 
> 赞同：1
> 
> 时间：2012-08-07T17:18:54.613
> 
> 标签：linux, shell, batch-processing, file-rename, batch-rename

我有一些文件：

```
/var/www/media/0001/0001_123456_12.jpg
/var/www/media/0002/0002_123456_12.jpg
/var/www/media/0003/0003_123456_12.jpg 
```

我想将它们重命名为：

```
/var/www/media/0001/0001_test.jpg
/var/www/media/0002/0002_test.jpg
/var/www/media/0003/0003_test.jpg 
```

我的想法是找到第一个`_`，删除文件的其余部分，直到`.`添加`test`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:22:09.883

[这是perl](http://www.perlmonks.org/?node_id=277174)中的一个解决方案，它允许您使用正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T17:24:55.800

```
find /var/www/media/ -name \*.jpg -exec sh -c '
  a=$(echo {} | sed s/_123456_/_/);
  [ "$a" != "{}" ] && mv "{}" "$a" ' 
```

您在 中找到所有 jpg 文件，`/var/www/media`并为每个文件运行以下命令：

```
a=$(echo {} | sed s/_123456_/_/)
[ "$a" != "{}" ] && mv "{}" "$a" 
```

在这个命令之后，`a`变量已经改写了里面的文件名：

```
a=$(echo {} | sed s/_123456_/_/) 
```

我们比较`a`变量和实名（`{}`），它们不等于文件必须重命名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:37:28.287

如果可以安装`mmv`包，那么这些操作就变得容易了。使用`mmv`，你可以做你想做的事：

```
cd /var/www/media
mmv '*/*_123456_*.jpg' '#1/#2_test.jpg' 
```

这是 mmv 手册页：http: [//manpages.ubuntu.com/manpages/lucid/man1/mln.1.html](http://manpages.ubuntu.com/manpages/lucid/man1/mln.1.html)

# variables - Grails 1.3.6 - 对象字段似乎失去了价值

> ID：11850945
> 
> 赞同：0
> 
> 时间：2012-08-07T17:19:00.090
> 
> 标签：variables, grails

我是 Grails 的新手，使用的是旧版本的 Grails (1.3.6/8)。我有一个带有一些变量的对象，这些变量没有保留我分配给它们的东西。

```
class NiftyController {

    try
    {
        SomeGrid someGrid = new SomeGrid()
        def selectedDate = params.specifiedDate
        ...
        someGrid.selectedDate = selectedDate
        someGrid.longDate = Calendar.getInstance().getTimeInMillis()
        println someGrid.selectedDate // prints, say, 08/06/2012
        println someGrid.longDate // prints, say, 1302558890256
        ....
        doSomeWork(someGrid)
    }

    def doSomeWork = { SomeGrid someGrid ->
        println someGrid.selectedDate // prints '' (empty)
        println someGrid.longDate // prints 8 - the number for the current month.
    }
} 
```

我完全摸不着头脑——我使用 Java，这种类型的分配变量数据丢失是新的，对我来说根本没有意义。谁能弄清楚这里发生了什么？我猜这是 Grails 独有的某种可见性问题，但我无法确定。

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T19:34:29.623

如果`doSomeWork`它本身不需要是控制器动作，我会将其设为普通方法而不是闭包：

```
private doSomeWork(SomeGrid someGrid) {
  //...
} 
```

将其作为闭包，Grails 可能会将`SomeGrid`参数视为命令对象并尝​​试直接从`params`.

# iphone - 在两个视图中连接动作和对象？

> ID：11850949
> 
> 赞同：0
> 
> 时间：2012-08-07T17:19:14.347
> 
> 标签：iphone, ios

如何将按钮与不同视图中的对象标签链接？我是否需要在两个头文件中创建属性，如果不需要，我如何链接两者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:24:41.490

我认为你应该退后一步，改变你对设计代码方式的思考方式。一个按钮不应该改变另一个视图中的标签。这违反了 MVC 设计模式。我建议你看看这个。[http://www.bit-101.com/blog/?p=1969](http://www.bit-101.com/blog/?p=1969)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:33:50.880

以下是从导航堆栈中的前一个视图更改文本标签的示例：

```
int controllers = self.navigationController.viewControllers.count;
PreviousViewController *view = [self.navigationController.viewControllers objectAtIndex:controllers - 2];
view.questionLabel.text = [self.questionsArray objectAtIndex:indexPath.row]; 
```

# python - 解压以 ASCIIZ 字符串结尾的结构

> ID：11850950
> 
> 赞同：6
> 
> 时间：2012-08-07T17:19:25.833
> 
> 标签：python, struct

我正在尝试用来`struct.unpack()`拆分以 ASCII 字符串结尾的数据记录。

记录（它恰好是 TomTom ov2 记录）具有以下格式（存储小端序）：

*   1 个字节
*   总记录大小为 4 字节 int（包括此字段）
*   4字节整数
*   4字节整数
*   可变长度字符串，以空字符结尾

`unpack()`要求字符串的长度包含在您传递的格式中。我可以使用第二个字段和记录其余部分的已知大小（13 个字节）来获取字符串长度：

```
str_len = struct.unpack("<xi", record[:5])[0] - 13
fmt = "<biii{0}s".format(str_len) 
```

然后继续进行完整的解包，但由于字符串是空终止的，我真的希望`unpack()`能为我做这件事。如果我遇到一个不包括其自身大小的结构，那么拥有它也很好。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-14T23:15:35.800

我制作了两个新功能，它们应该可以用作标准打包和解包功能的替代品。它们都支持“z”字符来打包/解包 ASCIIZ 字符串。格式字符串中“z”字符的位置或出现次数没有限制：

```
import struct

def unpack (format, buffer) :
    while True :
        pos = format.find ('z')
        if pos < 0 :
            break
        asciiz_start = struct.calcsize (format[:pos])
        asciiz_len = buffer[asciiz_start:].find('\0')
        format = '%s%dsx%s' % (format[:pos], asciiz_len, format[pos+1:])
    return struct.unpack (format, buffer)

def pack (format, *args) :
    new_format = ''
    arg_number = 0
    for c in format :
        if c == 'z' :
            new_format += '%ds' % (len(args[arg_number])+1)
            arg_number += 1
        else :
            new_format += c
            if c in 'cbB?hHiIlLqQfdspP' :
                arg_number += 1
    return struct.pack (new_format, *args) 
```

以下是如何使用它们的示例：

```
>>> from struct_z import pack, unpack
>>> line = pack ('<izizi', 1, 'Hello', 2, ' world!', 3)
>>> print line.encode('hex')
0100000048656c6c6f000200000020776f726c64210003000000
>>> print unpack ('<izizi',line)
(1, 'Hello', 2, ' world!', 3)
>>> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-07T17:19:25.833

实际上，尺寸较小的记录相当容易处理，因为`struct.calcsize()`它会告诉您它期望的长度。您可以使用它和数据的实际长度来构造一个`unpack()`包含正确字符串长度的新格式字符串。

此函数只是 的包装器`unpack()`，允许在最后一个位置使用新的格式字符，该字符将删除终端 NUL：

```
import struct
def unpack_with_final_asciiz(fmt, dat):
    """
    Unpack binary data, handling a null-terminated string at the end 
    (and only at the end) automatically.

    The first argument, fmt, is a struct.unpack() format string with the 
    following modfications:
    If fmt's last character is 'z', the returned string will drop the NUL.
    If it is 's' with no length, the string including NUL will be returned.
    If it is 's' with a length, behavior is identical to normal unpack().
    """
    # Just pass on if no special behavior is required
    if fmt[-1] not in ('z', 's') or (fmt[-1] == 's' and fmt[-2].isdigit()):
        return struct.unpack(fmt, dat)

    # Use format string to get size of contained string and rest of record
    non_str_len = struct.calcsize(fmt[:-1])
    str_len = len(dat) - non_str_len

    # Set up new format string
    # If passed 'z', treat terminating NUL as a "pad byte"
    if fmt[-1] == 'z':
        str_fmt = "{0}sx".format(str_len - 1)
    else:
        str_fmt = "{0}s".format(str_len)
    new_fmt = fmt[:-1] + str_fmt

    return struct.unpack(new_fmt, dat) 
```

* * *

```
>>> dat = b'\x02\x1e\x00\x00\x00z\x8eJ\x00\xb1\x7f\x03\x00Down by the river\x00'
>>> unpack_with_final_asciiz("<biiiz", dat)
(2, 30, 4886138, 229297, b'Down by the river') 
```

# javascript - 如果 body id 是特定值，则执行函数

> ID：11850952
> 
> 赞同：0
> 
> 时间：2012-08-07T17:19:27.590
> 
> 标签：javascript, function, exists

我只想在我的网站的一个页面上执行一项功能，其中正文的 ID 为#modulePage16460412。我有下面的脚本不起作用。

```
<script type="text/javascript">
if($('#modulePage16460412').length > 0 ) {
$(function()
{
$(window).bind('load',
    function(e)
    {
    window.setTimeout(function()
        {
         $.colorbox({opacity:0.3, href:"/storage/support/colorbox/offer.html"});
        }, /*timeout->*/ 2000);
    });
});
}
</script> 
```

是否也可以仅在他们第一次访问该页面时执行该功能，而如果他们返回该页面则不再执行？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T17:25:07.440

您可以将函数放在具有指定 ID 的主体负载上选择它...如果不存在具有此 ID 的元素，则该函数将永远不会触发。

```
$('#modulePage16460412').load(function() { // this will not be called unless an element with that ID has loaded into the DOM

     // ... your code here.

}); 
```

并触及“单次执行”部分（这确实应该是一个新问题......但是哦，好吧）你可以使用 localStorage 来保持设置。

[http://jsfiddle.net/rlemon/ET9Zg/](http://jsfiddle.net/rlemon/ET9Zg/)

在你的情况下，像

```
if( !getData('someKey') ) {
   // ok so they have not been here.
   setData('someKey', 1); //  now set the data so this won't get hit again.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-07T17:24:31.900

您定义了一个函数，但没有在任何地方调用。

所以把所有东西都放在某个函数中并调用。

并将 if($('#modulePage16460412').length > 0 ) 替换为 if($('#modulePage16460412'))，因为当 jquery 找不到 id 为 #modulePage16460412 的元素时，它将返回空数组。empty_array.length = 0，所以它总是正确的。

```
$('document').ready(function(){

if($('#modulePage16460412')) {
$(function()
{
$(window).bind('load',
    function(e)
    {
    window.setTimeout(function()
        {
         $.colorbox({opacity:0.3, href:"/storage/support/colorbox/offer.html"});
        }, /*timeout->*/ 2000);
    });
});
}

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-07T17:53:00.437

也许更简单的方法？

```
$( document ).ready( function() { // runs code only after DOM ready
   if ( $( '#modulePage16460412' ).length > 0 ) { // runs code only if id found
       window.setTimeout( function() {
          $.colorbox( { opacity:0.3, href:"/storage/support/colorbox/offer.html" } );
       }, 2000 );
   }
} ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:22:29.110

您需要将条件放入其中，`$(function(){`以便在 JavaScript 查询（未加载的）DOM 是否存在 ID 之前实际加载 body 标记。

```
$(function(){
    if($('#modulePage16460412').length) {

        ...

    }
}); 
```

# javascript - jQuery：div中两个位置之间有多少个元素

> ID：11850956
> 
> 赞同：0
> 
> 时间：2012-08-07T17:19:37.767
> 
> 标签：javascript, jquery, html

我有一个令人沮丧的问题，我不知道如何解决。

**我的问题**：如何确定视口中两个位置之间存在多少个元素（在这种情况下是可滚动的 div）？

假设我有`<div>`一个高度为 150 像素的可滚动，但有一个 450 像素的视口，其中大部分都被隐藏了。div 有 30px 高的孩子，其中 15 个。

**问题 2**：我怎样才能找出 n1 和 n2 之间存在多少个第一个孩子，这似乎很容易，但事实证明并非如此。

我创建了一个[jsFiddle](http://jsfiddle.net/q9uaC/6/)，我在其中部分解决了解决方案，如果将 top 值设置为 0，它会起作用，但如果是其他任何东西，它就不起作用。例如，通过这个解决方案，我能够确定在 0 到 200px 之间有 7 个可见的 div。但是如果我改变它来确定有多少在 30px 和 230px 之间，它会告诉我 0，什么时候应该是 7。

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T17:23:51.770

试试这个：

```
var $this = $(this),
    topOffset = $this.offset().top;
if (topOffset >= top && topOffset <= bottom) {
    elements++;
} 
```

这将检查当前元素（在 中`each()`）的顶部偏移量是否大于`top`变量的值，`elements`然后才增加。这样，您就不需要不断更新`height`变量。

正如您[在此处](http://jsfiddle.net/purmou/q9uaC/11/)看到的那样，这很有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:24:22.463

更改它，使“高度”开始等于顶部值。

你的 javascript 应该是：

```
var container = $('div#container'),
top = 30,
bottom = 230,
height = top,
elements = 0;

container.find('div').each(function(n)
{
  if (top <= height && height < bottom)
{
    height = height + $(this).height();
    elements++;
    console.log(top, bottom, height, elements);
}
});

$('span.top').text(top);
$('span.btm').text(bottom);
$('span.num').text(elements); 
```

这对我有用，祝你好运！

# java - Maven：存储库

> ID：11850958
> 
> 赞同：1
> 
> 时间：2012-08-07T17:19:46.330
> 
> 标签：java, maven

我在版本控制系统 (git) 中有一个小型 Java 项目，由 4 个开发人员共享。我正在考虑在这个项目中使用 Maven 作为构建工具。

依赖管理是一个想要的功能，但我不想要： - 依赖的自动更新（因为这可能会破坏我的软件）。- 依靠 Internet 连接从远程存储库下载依赖项并能够编译我的代码。

因此，问题：

1) 我可以将 Maven 配置为使用本地依赖项（例如，在 VCS 中共享的 jars）吗？我没有在多个项目之间共享多个依赖项，并且我的依赖项很少会更新，因此恕我直言，使用 Maven 存储库不值得。

2) 如果我选择使用 Maven 存储库，我可以在本地网络中配置一个吗？我不想要远程存储库镜像或远程存储库的门户。我想要一个带有我的依赖项的独立存储库，位于本地网络中的服务器上。

3）如果我对远程存储库使用默认的 Maven 方法，我可以在第一次下载所有依赖项后关闭依赖项更新吗？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-07T17:25:09.827

回答1：

是的，您可以，谷歌搜索系统范围依赖项，但是：这样做不是一个好主意，因为您将删除其中一个关键功能。

```
<dependency>
  <groupId>com.mycompany</groupId>
  <artifactId>app-lib</artifactId>
  <version>3.1.0</version>
  <scope>system</scope>
  <systemPath>${project.basedir}/libs/app-lib-3.1.0.jar</systemPath>
</dependency> 
```

回答2：

是的，你可以： - [Artifactory](http://www.jfrog.com/home/v_artifactory_opensource_overview/) - [Nexus](http://www.sonatype.org/nexus/)

回答3：

是的你可以。对于这种情况，您可以使用 ---offline 标志**或**更好的方法：释放所有依赖项。

一些想法：您想使用依赖管理系统，而不使用依赖管理，这听起来很奇怪。

如果您担心库中的更改可能会破坏您的代码，请不要使用 SNAPSHOT。尝试一种版本方案。我们用

xyz

*   如果 z 在版本中更改，则 jar 应该是兼容的。
*   如果 y 改变，你将不得不改变 youz 代码
*   如果 x 发生变化……那么一切都需要更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-07T18:06:56.963

您对依赖 Internet 连接的担忧是有道理的，但我认为它并没有您想象的那么糟糕。

从中央存储库下载依赖项后，它会保存到硬盘驱动器上的缓存中（位于“~/.m2/repository”）。从那时起，将使用缓存中的副本，并且不再需要 Internet 连接来编译您的应用程序。

当你在 Maven 中编译你的第一个项目时，它必须下载一大堆东西。但在那之后，所有后续的编译都会变得更快，他们不需要下载任何东西。

此外，Maven 的版本控制方案使得依赖项的所有“发布”版本一旦部署到中央存储库**就不能更改。**例如，如果我使用“commons-io”的“2.2”版本，我知道这个版本的库将始终保持不变。不发布新版本就无法进行更改。

但是，“快照”版本*可以*更改。如果库的版本是快照，那么它将以“-SNAPSHOT”结尾（例如，“1.2-SNAPSHOT”表示该库最终将作为“1.2”发布）。我不认为中央存储库允许快照构建。无论如何，您都不应该在生产代码中使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T04:40:01.980

我认为只有在第一次编译时才需要 Internet 连接，但每当我更改代码时，我都会收到几个下载消息。像这样的消息：

下载：[http ://repo.maven.apache.org/maven2/org/eclipse/core/resources/maven-metadata.xml](http://repo.maven.apache.org/maven2/org/eclipse/core/resources/maven-metadata.xml)

下载：[http ://repository.springsource.com/maven/bundles/external/org/eclipse/core/resources/maven-metadata.xml](http://repository.springsource.com/maven/bundles/external/org/eclipse/core/resources/maven-metadata.xml)

下载：[http ://repository.springsource.com/maven/bundles/release/org/eclipse/core/resources/maven-metadata.xml](http://repository.springsource.com/maven/bundles/release/org/eclipse/core/resources/maven-metadata.xml)

下载：[https ://oss.sonatype.org/content/repositories/snapshots/org/eclipse/core/resources/maven-metadata.xml](https://oss.sonatype.org/content/repositories/snapshots/org/eclipse/core/resources/maven-metadata.xml)

这是为什么？Maven 是在这些存储库中寻找更新，还是有其他原因经常下载这些元数据 xml？

# java - Java 中的 ClassFormatError

> ID：11850969
> 
> 赞同：4
> 
> 时间：2012-08-07T17:20:25.507
> 
> 标签：java

我正在尝试帮助遇到 ClassFormatError 的客户。错误消息说

```
bytecode array size > 65535 at offset=66370 
```

堆栈跟踪指示在尝试调用实用程序类中的静态方法时发生错误。我无法在我自己的系统上重现该错误。

我尝试用谷歌搜索这个问题（search=classformaterror“字节码数组大小”，包括引号）并找到其他软件的错误报告，但没有任何帮助。我也尝试在这里搜索，但找不到涉及此特定错误消息的结果。（也许我只是没能找到它们……）

知道可能导致此问题的原因是什么吗？我不能发布代码或实际的堆栈跟踪，因为它是专有的。

提前感谢您可以给我的任何指示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T17:35:02.913

要进一步详细说明 Jon Skeet 的回应：

类文件格式为每个方法的字节码数组指定了一个 4 字节长度的字段，但实际上某些结构（局部变量表、行号表和异常表）将其限制为 65535。

其中前两个是可选的，如果您在没有调试信息的情况下编译您的类，则不会编译，但第三个是强制性的。当然，如果方法的后半部分没有异常处理，编译器可能不会注意到。或者更糟糕的是，它可能会溢出并编译损坏的 try-catch 块。

无论哪种方式，实用程序类中的一个或多个方法都太大了，即使没有硬编码的长度限制，也可能应该拆分。

更新：当然，在代码验证器的描述中，代码长度明确限制为 65536 字节。但不可避免地会有一些实现更多地将其视为指导方针。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:22:43.413

这表明实用程序类方法基本上太大了，需要拆分。不同的编译器会输出不同数量的代码——我猜不同的虚拟机也可能或多或少地严格执行约束。

此外，您*可能会*发现在没有调试信息的情况下编译实用程序类会使该方法低于限制 - 但最好将其拆分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-10T22:18:22.490

我想分享 Java VM 规范中的以下内容 - Java SE 7 Edition（准确地说是第 4.7.3 段）：

> end_pc 是独占的这一事实是 Java 虚拟机设计中的一个历史性错误：如果一个方法的 Java 虚拟机代码正好是 65535 字节长并且以 1 字节长的指令结束，那么该指令就不能被保护由异常处理程序。编译器编写者可以通过将任何方法、实例初始化方法或静态初始化程序（任何代码数组的大小）生成的 Java 虚拟机代码的最大大小限制为 65534 字节来解决此错误。

所以这似乎是编译器特定的功能。必须说生成如此巨大的代码块在 Java 中应该不是问题（考虑到合理的设计），但在使用自动生成的代码时可能会成为问题。

# javascript - 在 JavaScript 中将 Blob 对象转换为 base64

> ID：11850970
> 
> 赞同：24
> 
> 时间：2012-08-07T17:20:25.667
> 
> 标签：javascript, image, google-chrome, base64, blob

我正在尝试实现一个粘贴处理程序以从用户的剪贴板获取图像。我希望它只在 Google Chrome 上运行，我不担心其他浏览器。

这是我在 Internet 上找到的方法的一部分，我正在尝试对其进行调整。

```
// Get the items from the clipboard
var items = e.clipboardData.items;
    if (items) {
    // Loop through all items, looking for any kind of image
        for (var i = 0; i < items.length; i++) {
            if (items[i].type.indexOf("image") !== -1) {
                // We need to represent the image as a file,
                var blob = items[i].getAsFile();
                // and use a URL or webkitURL (whichever is available to the browser)
                // to create a temporary URL to the object
                var URLObj = window.URL || window.webkitURL;
                var source = URLObj.createObjectURL(blob);
                createImage(source);
                }
            }
        } 
```

该方法有效，如果我使用我的“源”作为图像对象的 src，我可以显示图像。问题是谷歌浏览器中的图像源将是这样的：`blob:http://localhost:8080/d1328e65-ade2-45b3-a814-107cc2842ef9`

我需要将此图像发送到服务器，因此我想将其转换为 base64 版本。例如：

```
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArgAAAAjCAIAAADwnO7RAAAKMWlDQ1BJQ0MgUHJvZmlsZQAASImdlndUU9kWh8+9N71QkhCKlNBraFICSA29SJEuKjEJEErAkAAiNkRUcERRkaYIMijggKNDkbEiioUBUbHrBBlE1HFwFBuWSWStGd+8ee/Nm98f935rn73P3Wfvfda6AJD8gwXCTFgJgAyhWBTh58WIjYtnYAcBDPAAA2wA4HCzs0IW+EYCmQJ82IxsmRP4F726DiD5+yrTP4zBAP+flLlZIjEAUJiM5/L42VwZF8k4PVecJbdPyZi2NE3OMErOIlmCMlaTc/IsW3z2mWUPOfMyhDwZy3PO4mXw5Nwn4405Er6MkWAZF+cI+LkyviZjg3RJhkDGb+SxGXxONgAoktwu5nNTZGwtY5IoMoIt43kA4EjJX/DSL1jMzxPLD8XOzFouEiSniBkmXFOGjZMTi+HPz03ni8XM...iCIBWnh+P9w9C+9eMzvhCl1iOElK09ruc2wqGhfH/uKEV30FlJkmRZJklydFuW/FdwhYFCkCBBggQJEuS/gWC4FCRIkCBBggQZlmCgECRIkCBBggQZlmCgECRIkCBBggQZFmzhwoXXWoYgQYIECRIkyHUK5vF4rrUMQYIECRIkSJDrFHLktYOCBAkSJEiQIP/NkLt3777WMgT5thLstwoSJEiQ7zxYsEUhyJWxbdu2u++++1pLESRIkCBBvl6Csx6CBAkSJEiQIMPy3dkMOsg3T7A5KkiQIEG+8wQDhSBXTjBQCBIkSJDvPMGuhyBBggQJEiTIsFwXLQr9H6bOjtYeP2mONbOj2Hut9y6/x+nlJSBCQnXkgG3Brh8Q4lqbOpAmPDqUGShex9lPDlfB4sU5I97b/8kuevygYUgYsAksAPg9fkbDQN/e1kNvVw76nfYeiTCG6sjLd5fv58rsFmxRCBIkSJDvPP8f+HtxbDVRPI8AAAAASUVORK5CYII= 
```

在第一段代码中，我有一个代表文件的 blob 对象。我尝试了几种方法，但没有得到正确的表示。如何使用它来创建 base64 表示？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-08-08T17:47:02.560

Nick Retallack 在此页面上的回答[如何从剪贴板功能粘贴图像在 Gmail 和 Google Chrome 12+ 中工作？](https://stackoverflow.com/questions/6333814/how-does-the-paste-image-from-clipboard-functionality-work-in-gmail-and-google-c)做我想要的。

所以新的代码是：

```
var items = e.clipboardData.items;
if (items) {
// Loop through all items, looking for any kind of image
    for (var i = 0; i < items.length; i++) {
        if (items[i].type.indexOf("image") !== -1) {
            // We need to represent the image as a file,
            var blob = items[i].getAsFile();

            var reader = new FileReader();
                reader.onload = function(event){
                    createImage(event.target.result); //event.target.results contains the base64 code to create the image.
                };
                reader.readAsDataURL(blob);//Convert the blob from clipboard to base64
            }
        }
    } 
```

# node.js - Express 中跨子域的会话

> ID：11850977
> 
> 赞同：10
> 
> 时间：2012-08-07T17:20:52.390
> 
> 标签：node.js, express, subdomain, session-cookies, vhosts

我正在使用 Express with Node 中的 vhost 功能来管理我的应用程序的多个子域。该应用程序使用相同的会话密钥和密钥，我相信我使用了正确的会话 cookie 设置：

```
cookie: {
          path     : '/',
          domain   : '.example.com',
          httpOnly : false,
          maxAge   : 1000*60*60*24*30*12    //one year(ish)
        } 
```

我在我的常规站点上设置了一个会话变量，其中子域未定义，例如[http://example.com](http://example.com)，如下所示：

```
req.session.rep_id = rep._id;
res.redirect('https://' + company.name + '.example.com/'); 
```

但是当我将它们重定向到 subdomain.example.com 时，会话没有将 rep_id 键设置为任何内容。似乎会话正在子域之间重置。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T18:16:21.827

一些想法：

尝试从`.example.com`. 我的想法是，您正在尝试设置仅子域的 cookie，同时仍在根域上。我已经读过设置的 cookie`example.com`也将在所有子域上可用。

尝试不要立即将用户重定向到子域，以首先验证 cookie 是否在您的根域上工作。检查服务器的响应标头，然后查看浏览器是否在下一个请求中保留了 cookie。仅当您确定它正常工作时才导航到子域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-19T05:53:53.587

使用 .save() 方法，回调将确保设置 cookie 然后重定向类似的东西 -

```
req.session.rep_id = rep._id;
    req.session.save(()=>{
      res.redirect('https://' + company.name + '.example.com/');
    }) 
```

# ruby-on-rails-3 - heroku 资产预编译超时问题

> ID：11850980
> 
> 赞同：2
> 
> 时间：2012-08-07T17:21:01.840
> 
> 标签：ruby-on-rails-3, heroku, jrubyonrails

我们有一个正在扩展的 Rails 站点。它使用 jruby、bootstrap 和一些第三方库 - 预编译需要很长时间。heroku 部署的超时限制太长了。有没有办法修改超时值，以便我们能够将我们的存储库推送到 heroku 并进行预编译？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T01:25:57.343

在本地预编译并关闭heroku预编译？

# android - Android 使用处理程序将数据从 TCP 线程发送到不同的活动

> ID：11850982
> 
> 赞同：1
> 
> 时间：2012-08-07T17:21:14.220
> 
> 标签：android, multithreading, tcp, handler

我有一个 MainActivity，它是创建 TCP 工作线程的默认启动 Activity。该 TCP 线程从服务器接收一些数据并将其传递给当前显示的 Activity，表示还有两个名为 Activity1 和 Activity2 的 Activity 将显示接收到的数据。

我如何使用 Handlers 实现这一点？这是我所拥有的概述......如果我完全错了，请提出解决方案或更改所有内容。

```
public class MainActivity extends Activity
{
    public static TCPFunctions tcp = null;
    public static Handler handler;

    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        handler = new Handler();
        tcp = new TCPFunctions(this, handler);
        tcp.start();
    }
} 
```

----------------------------------------TCP 线程类-------- --------------------------

```
public class TCPFunctions extends Thread
{
    public Handler handler;
    //socket and io streams are here and they work properly

    Public TCPFunctions(MainActivity main, Handler _handler)
    {
        this.main = main;
    handler = _handler;
    }

    public void run()
    {
        Intent showActivity1 = new Intent(main, Activity1.class);
        main.startActivity(showActivity1);
        while(true)
        {
            directories = new Vector<String>();
            directories = (Vector<String>) inputStream.readObject();
            Message msg = Message.obtain();
            msg.obj = directories;
            handler.sendMessage(msg);
            directories = null;
        }
    }
} 
```

现在说在 Activity1 我想要这个目录对象...可以说我的 Activity1 有一个按钮，按下该按钮时会向服务器发送请求以获取目录对象...由 TCP 线程接收...现在我该怎么做在 Activity1 中获取它并更新 UI ...

基本上，目录对象是字符串的 Vetor，我想在 Activity1/Activity2 中包含的 ListView 上显示字符串

```
public class Activity1 extends Activity implements OnClickListener,OnItemClickListener
{
    private ListView directoryList;
    private Button rootButton;
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fileexplorer);
        directoryList = (ListView) findViewById(R.id.directories);
        rootButton.setOnClickListener(this);
        directoryList.setOnItemClickListener(this);
    }

    public void onClick(View v)
    {
        switch(v.getId())
        {
            case R.id.root_button:
            Log.d(TAG, "FileExplorer: Root Button Pressed");
            //request for directories made here
            break;
        }
    }
 // What should be the Handler code to get the directories ?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T18:07:21.720

第一：处理程序执行可运行对象并处理创建它的线程中的消息。因此，如果您希望 Activity1 对来自 TCPFunctions 的数据做出反应，您有两个选择。任何一个：

-MainActivity，它在您当前的代码中创建了处理程序，需要对消息做出反应，获取数据，并将其发送到 Activity1

- 或者 Activity1 需要是创建处理程序的那个。

在任何一种情况下，关于如何对发送的消息做出反应的问题的核心答案是，您需要通过子类化处理程序来覆盖 handleMessage() 方法。这是您可以使用的样板代码片段（来自 Android 开发者网站上的一个示例应用程序）

```
 mUpdateHandler = new Handler() {
            @Override
        public void handleMessage(Message msg) {
            String chatLine = msg.getData().getString("msg");
            addChatLine(chatLine);
        }
    }; 
```

# installation - 如何使用 NSIS 为 WinZip 安装程序设置应答文件/.ini

> ID：11850984
> 
> 赞同：-1
> 
> 时间：2012-08-07T17:21:19.570
> 
> 标签：installation, nsis, ini, winzip

我正在创建一个安装程序，它可以一次安装多个程序和文件包，其中一个是 WinZip，我希望 WinZip 安装程序在后台运行，从我收集的`/s`内容来看，它将使它在静默模式下运行，但是安装程序仍然没有安装。我相信这是因为在 WinZip 安装过程中必须做出的选择。所以我的问题是如何设置它以在后台静默安装 WinZip？我需要一个答案文件吗？如果是这样，我该如何设置？任何帮助都会很棒！

*我在 NSIS 文件中的代码片段：

```
Section
IfFileExists "C:\Program Files\WinZip\WINZIP32.EXE" Dont_Install 
SetOutPath $TEMP
File "Installerfiles\WinZip165.exe"
DetailPrint "Starting Winzip installation"
ExecWait "/s WinZip165.exe"
Delete $TEMP\WinZip165.exe
SetOutPath $INSTDIR
Goto done
Dont_Install:
MessageBox MB_OK "You seem to have this program \
(WinZip) already installed"  
done:
SectionEnd 
```

*注意我已经看到了关于静默安装的其他问题，这个问题更特定于 WinZip，并且与如果需要我将如何建立答案文件有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-07T21:16:22.493

`ExecWait "/s WinZip165.exe"`显然是错误的，应该是，`ExecWait '"$TEMP\WinZip165.exe" /S'`但我不认为 WinZip 使用基于 NSIS 的安装程序......

他们确实提供了 .MSI，您可能想看看。他们的知识库包含一些有用的技巧，例如[this](http://kb.winzip.com/kb/entry/229/ "使用 WinZip MSI 文件进行命令行安装")和[this](https://web.archive.org/web/20091110175038/http://kb.winzip.com/kb/entry/11/ "如何自定义我的 WinZip MSI？")。您还可以通过谷歌搜索[找到](http://web.archive.org/web/20080916195246/http://www.appdeploy.com/packages/detail.asp?id=914)其他一些提示...

如果您对它们的静默安装模式有任何其他问题，您应该联系[WinZip 支持](https://www.winzip.com/win/en/contact.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T13:51:25.073

由于我还没有足够的声誉，因此我无法评论 Anders 的回复，这是我个人用来静默安装 msi 安装程序的命令，它是从我想安装多个程序时使用过多次的安装程序复制而来的.

```
ExecWait '"msiexec" /i "$TEMP\MSI Installer.msi" /qn' 
```

这是假设您接受 Anders 的建议并尝试使用 WinZip 的 msi 版本。

Anders 还提到了您的代码中的一个错误，即您没有使用您尝试运行的安装程序的完整路径。我还想指出，将路径用单引号括起来总是一个好主意。例如，当您这样做时：

```
Delete $TEMP\WinZip165.exe 
```

像这样添加单引号：

```
Delete '$TEMP\WinZip165.exe' 
```

这也适用于你做你的

```
SetOutPath '$TEMP' 
```

和

```
SetOutPath '$INSTDIR' 
```

虽然您可以在没有单引号的情况下摆脱大多数情况，但如果您遇到包含空格的路径，如果您尝试将路径传递给宏或其他东西，它会让您头疼，因为它分隔了空格和将字符串分成多个部分。每当您处理可能有也可能没有空格的 Windows 路径时，这只是一个好习惯。

顺便说一句，我不接受这个答案，我打算将它作为安德斯已经说过的话的后续行动。

# forms - 带有托管文件的表单在表单错误时出现奇怪的行为

> ID：11850985
> 
> 赞同：0
> 
> 时间：2012-08-07T17:21:23.300
> 
> 标签：forms, drupal

我创建了一个带有关联图像字段的内容类型。每个用户都能够看到此内容类型的所有节点的列表，并且应该能够在适当的字段中上传新图像。我尝试了很多解决方案，但最后我尝试使用表单和托管文件。

在包含所有节点列表的页面中，我正在为每个节点创建一个带有表单的灯箱。每个表单都是这样创建的：

```
function coverupload_form($form, &$form_state, $uid, $relid) {

$form['#attributes']['id'] = 'coverup-'.$relid;

$form_state['storage']['rid'] = $relid;

$cliente = cataloghi_user_edit_get_cliente($uid);

$release = node_load($relid);

$form['cover'] = array(
    '#title' => 'Carica la cover per la release '.$release->title,
    '#description' => 'I file caricati devono avere estensione \'.jpeg\', risoluzione di 1440x1440 e dimensione massima di 5MB', 
    '#type' => 'managed_file',
    '#upload_location' => 'public://clienti/'.$cliente->title.'/cover',
    '#upload_validators' => array(
      'file_validate_extensions' => array('jpeg, jpg'),
      // Pass the maximum file size in bytes
      'file_validate_size' => array(5*1024*1024),
      'file_validate_image_resolution' =>array('1440x1440', '1440x1440'),
    ),
);

$form['submit'] = array(
    '#type' => 'submit',
    '#value' => t('CARICA'),
);

return $form;
}

function coverupload_form_submit($form, &$form_state) {

$file = file_load($form_state['values']['cover']);
// Change status to permanent.
$file->status = FILE_STATUS_PERMANENT;
// Save.
file_save($file);

$nodo = node_load($form_state['storage']['rid']);

$nodo->field_release_copertina['und'][0] = (array)$file;

 if($nodo = node_submit($nodo)) { // Prepare node for saving
    node_save($nodo);
 }

} 
```

所有表单都有 display: none ，当用户点击封面上传按钮时，灯箱中只会显示相应的表单。

好吧，验证图像后一切正常。当图像未经过验证时（例如低于 1440x1440 像素），问题就开始了。

如果我用检查器检查灯箱，则会生成正确数量的表单，但它们都引用同一个节点（例如，它们都有 id 'coverup-17'）。

我已经检查了所有内容，似乎每次都将正确的值传递给表单，所以我开始认为这可能是与我对表单的理解不足有关的问题。

尝试不同类型的方法会更好吗？

感谢和抱歉，如果这有点混乱......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T11:06:03.963

我设法解决了这个问题。这取决于我在同一页面上有多个相同表单的实例。

我实现了 hook_forms()。

```
function mymodule_forms($form_id, $args) {
  $forms = array();
  if(strpos($form_id, 'coverupload_form_') === 0) {
    $forms[$form_id] = array(
      'callback' => 'coverupload_form',
      'callback arguments' => array($args[0], $args[1]),
    );
  }

  return $forms;
} 
```

然后我将表单调用更改为

```
drupal_render(drupal_get_form('coverupload_form_'.$relid, $arg1, $arg2)); 
```

# django - django中的路径应用程序

> ID：11850988
> 
> 赞同：0
> 
> 时间：2012-08-07T17:21:55.353
> 
> 标签：django, path

我想在 "setting.py" 中获取所有已安装应用程序的绝对路径。

```
app_list = [ app for app in Myproject.settings.INSTALLED_APPS ] 
```

我列出了应用程序，但我如何才能获得所有这些应用程序的绝对路径。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T19:28:58.627

真的不可能做你想做的事。我的意思是你*几乎*可以到达那里，但没有真正的功能，特别是，Python 不区分类、方法和变量。它们都算作模块的属性。

首先，`INSTALLED_APPS`是一个字符串元组。因此，为了获得任何有用的信息，您需要将它们作为模块加载：

```
for app in settings.INSTALLED_APPS:
    module = __import__(app) 
```

然后，一旦你有了实际的模块，你就可以调用`dir`它来获取它的属性列表：

```
for app in settings.INSTALLED_APPS:
    module = __import__(app)
    print dir(module) 
```

而且，这就是你能做到的。它将输出模块中设置的所有内容，而不仅仅是类。从这里开始，除了类之外，我能想到的唯一办法就是假设遵循命名约定并查找以大写字母开头的项目。这并不完全科学，但这就是你所得到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T07:30:15.917

今天我解决了我的问题。我写了这段代码，它只是工作。对于有限名称类，我找到“models.Model”固有的类名称。您可以更改它并享受它。此代码还可以在模块的深度 1 中查找文件。它可以改变。

```
app_list = [app for app in training.settings.INSTALLED_APPS if "task" in app]
for module in app_list:
    module1 = __import__(module)
    temp = module1.__path__
    files_path = [temp[0] + os.sep + files_name for files_name in os.listdir(temp[0]) if
                  os.path.splitext(files_name)[1] == ".py"]

    p = re.compile(r'class\s*\w*\s*\(models.Model\):')
    for file in files_path:
        infile = open(file)
        text = infile.read()
        all_class = p.findall(text)
        print [class_name[6:][:-15] for class_name in all_class] 
```

# jquery - 使用jQuery通过索引获取多个元素

> ID：11850990
> 
> 赞同：5
> 
> 时间：2012-08-07T17:21:56.297
> 
> 标签：jquery, jquery-selectors

有没有办法使用 jQuery 通过索引获取多个元素——比如[.eq()](http://api.jquery.com/eq/)，但是你可以传入一个数组而不是单个索引？像这样的东西：

```
var arrIndexes = [0, 4, 5];
var stuff = $("#datatable tbody tr").eq(arrIndexes).css('background-color', 'red'); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-07T17:31:43.520

只需使用过滤器（索引）中的第一个参数并使用 indexOf 查找

```
var arrIndexes = [0, 4, 5];
$("#datatable tbody tr").filter(function(index) {
    return arrIndexes.indexOf(index) > -1;
}).css('background-color', 'red'); 
```

演示：http: [//jsbin.com/ivexut/1/](http://jsbin.com/ivexut/1/)

如果您需要旧版浏览器，您可能需要添加函数 indexOf：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-07T17:25:38.057

**[您可以使用 jquery 的过滤器功能对选择器返回的对象集合应用自定义过滤器，您可以在此处](http://api.jquery.com/filter/)**阅读有关过滤器的更多信息

**[现场演示](http://jsfiddle.net/rajaadil/QLwpP/)**

```
$("#datatable tbody tr").filter(function(){
   if(arrIndexes.indexOf($(this).index()) != -1)
       return $(this);
}).css('background-color', 'red'); 
```

# java - 在Java中的类文件中声明接口

> ID：11850994
> 
> 赞同：1
> 
> 时间：2012-08-07T17:22:13.973
> 
> 标签：java

在 Objective-C 中，我们可以在同一个头文件中定义协议和实现。例如：

```
@class GamePickerViewController;

@protocol GamePickerViewControllerDelegate <NSObject>
  - (void)gamePickerViewController:
    (GamePickerViewController *)controller 
    didSelectGame:(NSString *)game;
@end

@interface GamePickerViewController : UITableViewController

@property (nonatomic, weak) id <GamePickerViewControllerDelegate> delegate;
@property (nonatomic, strong) NSString *game;

@end 
```

这样，如果我包含 .h 文件，我将可以访问文件中定义的协议。我正在Java中寻找类似的结构，因为我发现它在某些我想避免创建太多文件（接口文件+类文件）的情况下很有用。这样我就可以声明：

```
public class MyImplementation implements AnotherClass.MyInterface{
      AnotherClass otherClass;
} 
```

我认为接口内的嵌套类是要走的路。我是对的吗？或者Java中没有类似的东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-07T17:32:14.333

您可以嵌套类，并且嵌套类是公共静态的，这允许它们在同一个源文件中（虽然不常见，但将它们放在一个包中并使用单独的源文件更正常）

例如这是允许的

```
public class AnotherClass {

    public static interface MyInterface{
        // Interface code
    }

    public static class MyClass{
        //class code
    }
} 
```

在另一个文件中

```
public class MyImplementation implements AnotherClass.MyInterface{

} 
```

另一种选择是

```
public interface MyInterface{
    public static class MyClass implements MyInterface{
    }
} 
```

然后使用 MyInterface.MyClass 访问该类（请参阅`java.awt.geom.Point`有关此类结构的示例）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-07T17:26:46.763

您可以像这样嵌套类和接口，并让它们公开！但是，您不能实现/扩展类/接口，其中扩展的类嵌套在要扩展的类中

所以这行不通：

```
class A extends A.B {
    public class B {

    }
} 
```

在那里公开 B 类很好，但顶级类不能扩展内部类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-07T17:24:11.480

使用嵌套类，您可以实现类似的目标：将实现与接口一起打包，例如：

```
public interface MyInterface
{
    public class Implementation implements MyInterface
    {

    }
} 
```

现在你已经有了`MyInterface`一个具体的实现`MyInterface.Implementation`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-07T17:23:34.897

您可以做的是定义接口，然后将默认实现作为匿名内部类，类静态变量。

```
interface AProtocol {
    String foo();

    static final AProtocol DEFAULT_IMPLEMENTATION = new AProtocol(){
            @Override
            public String foo(){
                return "bar!";
            }
        };
} 
```

你是这个意思吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-07T17:29:03.600

Java API 经常用类来做这种事情。例如[JFormattedTextFiled.AbstractFormatter](http://docs.oracle.com/javase/7/docs/api/javax/swing/JFormattedTextField.AbstractFormatter.html)。请注意，声明包含`static`修饰符。我不明白为什么你也不能用接口来做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-13T12:41:06.920

```
interface B {
   public void show();

   class b implements B {
      public void show() {
         System.out.println("hello");
      }
   }
}

class A extends B.b {
   public static void main(String ar[]) {
      B.b ob=new B.b();
      ob.show();
   }
} 
```