# StackOverflow 问答 000269000-000269999

# c# - 处理 COM+ (VB) 中的自定义 .Net 异常？

> ID：269001
> 
> 赞同：1
> 
> 时间：2008-11-06T15:03:08.307
> 
> 标签：c#, vb.net, com, interop, com-interop

我即将开始编写一个 .Net 组件，该组件将从 VB COM+ 服务中调用（新组件是一个 DLL，它调用 Web 服务并根据响应返回）。我不确定如何处理调用 VB 中的 .Net 代码中可能出现的错误情况。

我担心的两种错误是：

*   如果不满足先决条件，我可能想抛出的异常（例如，作为参数提供的开始日期在作为参数提供的结束日期之后不到 3 个月；我可能想抛出 StartDateNotValidException）
*   作为 Web 服务调用的一部分可能发生的异常（超时、404 等）。

如果发生其中任何一种情况，我想向用户返回一些特定的反馈和/或将一些信息记录到日志中。我曾考虑从 .Net 代码返回 Int 返回代码并避免异常，但调用的 VB 代码可能最终会迁移到 .Net，所以如果可能的话，我想使用异常。

[我在MSDN](http://msdn.microsoft.com/en-us/library/9ztbc5s1.aspx)上读到COM Interop 会自动将标准库异常转换为 HRESULT；有没有人有使用这个的经验？这可以用来将自定义 .Net 异常转换为我可以在 VB 中处理的错误条件吗？

谢谢，尼克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T15:43:55.637

我确信我以前看过它，但这是我以前的工作，所以我无法检查细节。我认为我们从 COMException 继承了我们的异常类并设置了正确的 ErrorCode（在非托管代码中应该翻译为 HResult）。这非常好，因为您可以在非托管代码中使用 HResult 以及在托管客户端中正确处理类型化异常。

请让我知道它是否真的有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-20T16:55:04.560

我最终使用了以下方法：

*   有一个大字典，将我们特定于应用程序的 VB 错误代码映射到我们特定于应用程序的 C# 自定义异常
*   编写一个将 C# 异常转换为 VB 错误代码的方法（反之亦然）
*   从包含方法调用中发生的任何业务异常的方法中返回一个字符串数组（目前只有其中两个）

这样做的原因是修改我们的异常树来扩展 COMException 太麻烦了（反正比上面的更麻烦）。因此，我从未尝试过从 COMException 继承并检查 ErrorCode 是否正确转换为 HResult。

不过感谢您的建议，并为没有尝试过而道歉。

# c - 如何使格式文档快捷方式适用于 Visual Studio 2008 中的 C 源文件？

> ID：269003
> 
> 赞同：6
> 
> 时间：2008-11-06T15:03:12.397
> 
> 标签：c, visual-studio, visual-studio-2008, visual-studio-2005

如何使`Ctrl`++在纯 C 文件中工作`K`？`D`我真的很喜欢 C# 中的自动格式化，我也想在 C 中拥有相同的功能。

我正在使用 Visual Studio 2008，但如果这也适用于 Visual Studio 2005，它可能会有所帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T16:07:21.407

在 Visual Studio 2003 中，`Ctrl`+ `K`、`Ctrl`+`F`允许您格式化选择。这个和其他格式化文本的组合键可以在菜单*Edit* → *Advanced*中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-18T15:54:30.083

在 Visual Studio 2010 和 2008 中 - 选择的格式可以通过 CTRL+E CTRL+F..

我想因为 C/C++ 可能会充斥着大量的预处理器指令和定义等 - 格式化整个文档太难处理了..

# sql - pgSQL 中的子选择

> ID：269005
> 
> 赞同：-3
> 
> 时间：2008-11-06T15:03:32.770
> 
> 标签：sql, postgresql

我正在尝试在 pgsql aka postgresql 中进行子选择，但我发现的示例不起作用：

```
SELECT id FROM (SELECT * FROM table); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T15:12:22.143

我只需要为子选择添加一个 AS，如下所示：

```
SELECT id FROM (SELECT * FROM table) AS aliasname; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T15:11:30.227

我认为你需要类似的东西：

```
SELECT * FROM table WHERE id IN (SELECT id FROM table2); 
```

我不明白你的非工作子查询试图做什么，看起来你可以说`SELECT id FROM table`因为目前它不是有效的 SQL92 语法。

# web-applications - 为用 Lisp 编写的 Web 应用程序提供服务的首选方式是什么？

> ID：269009
> 
> 赞同：2
> 
> 时间：2008-11-06T15:05:04.000
> 
> 标签：web-applications, lisp, nginx, httpserver

我一直在研究 Nginx（我首选的网络服务器）的模块以服务于 Lisp 网络应用程序，但我找不到任何东西。

是否有 Nginx 的模块，或者有更好的方法来服务 Lisp webapps？如果是这样，它们是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T15:48:18.077

如果 Nginx 支持代理，你总是可以代理到在 localhost 上运行的 Hunchentoot 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-30T04:21:52.667

如果您对使用 Apache 感兴趣，总有[mod_lisp 。](http://www.cliki.net/mod_lisp "mod_lisp")（就像 ruby​​ webapps 的 Phusion Passenger。） Nginx 很好，但每次你想扩展它时都必须编译它，这不太直观。不过保持速度很快。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-08T14:32:46.897

你可以在 nginx 后面使用 hunchentoot。无需单独安装任何模块，您就可以通过 nginx 将请求定向到 hunchentoot。

```
upstream hunchentoot { server 127.0.0.1:5050; } 
```

在`location {}`指令的某个地方；

```
if (!-f $request_filename) {

proxy_pass http://hunchentoot;
} 
```

这对我有用。nginx/1.4.2。

# sql-server - SQL2000 中的 BCP 输出错误：SQLState = 37000，NativeError = 4060

> ID：269010
> 
> 赞同：2
> 
> 时间：2008-11-06T15:06:16.850
> 
> 标签：sql-server, stored-procedures, jdbc, sql-server-2000, bcp

我创建了一个 proc 来获取我机器上本地数据库中的所有用户表。我希望能够使用 BCP 和 SQL 创建我所有表的平面文件。它是通过 Windows 身份验证连接的 SQL 2000 中的虚拟数据库。我在 WinXP SP2 中设置了我的环境路径变量。我创建了新用户来访问数据库，关闭了我的防火墙，使用受信任的连接。我已经尝试了几十个论坛，没有运气。

在 dos 命令提示符下，我得到了同样的错误。

SQLState = 37000，NativeError = 4060 错误 = [Microsoft][ODBC SQL Server Driver][SQL Server]无法打开登录“[HelpDesk-EasyPay”中请求的数据库。登录失败。

这是我的SP：

```
@Path VARCHAR(100),
    @UserName VARCHAR(15),
    @PassWord VARCHAR(15),
    @ServerName VARCHAR(15)
AS 

set quoted_identifier off
set nocount on

declare @n int
declare @db varchar(40)
set @db=DB_NAME()
declare @TableName varchar(15) 
declare @bcp varchar(200)
select identity(int,1,1) as tblNo,name tblname into #T from Sysobjects where xtype='u'
select @n=COUNT(*) from #T

WHILE (@n>0)
BEGIN
    SELECT @TableName=tblname FROM #T WHERE tblno=@n
    PRINT 'Now BCP out for table: ' + @TableName
    SET @bcp = "master..xp_cmdshell 'BCP " + "[" + @db + ".." + @TableName + "]" + " OUT" + @Path + "" + @TableName+".txt -c -U" + @UserName + " -P" + @PassWord + " -S" + @ServerName + " -T" + "'" 
    EXEC(@bcp)
    SET @n=@n-1
END

DROP TABLE #T 
```

任何人都可以建议。这似乎是连接问题或 BCP ？没有把握。

编辑：我从查询分析器运行它，因为我有 118 个表要输出到平面文件。我似乎同意这是一个身份验证问题，因为我尝试使用用户名 sa 密码 root 连接到主数据库。这是它的设置，我得到同样的错误： SQLState = 37000, NativeError = 4060

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T13:43:25.163

您的括号延伸到整个限定表名称 - 只有个别组件应该被括号：

```
bcp [HelpDesk-EasyPay].dbo.[customer] out d:\MSSQL\Data\customer.bcp -N -Utest -Ptest -T 
```

应该工作，所以你想要：

```
SET @bcp = "master..xp_cmdshell 'BCP " + "[" + @db + "]..[" + @TableName + "]" + " OUT" + @Path + "" + @TableName+".txt -c -U" + @UserName + " -P" + @PassWord + " -S" + @ServerName + " -T" + "'" 
```

在你的代码中。看起来您提供的错误消息已被截断，否则您将能够看到它正在尝试打开数据库“[HelpDesk-EasyPay.dbo.customer]”，当然，它不存在，即使它这样做，你会得到一个没有指定表的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-23T13:39:46.550

我对 OUT 有同样的问题（减号字符会杀死所有事件 ^ 不起作用）

我用QUERYOUT避免它。像这样 ：

```
SET  @s = 'BCP "SELECT * FROM [HelpDesk-EasyPay].dbo.customers" QUERYOUT myfile.txt ...' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-10T09:23:04.223

也许有人会派上用场：我对 SQL Server 2017 也有同样的问题。原因是数据库名称周围的方括号。

# .net - 关于 .Net 中 DefaultValueAttribute 类的使用

> ID：269017
> 
> 赞同：1
> 
> 时间：2008-11-06T15:07:30.903
> 
> 标签：.net, asp.net, default-value

所以这里是简单的代码：

```
 [System.ComponentModel.DefaultValue(true)]
    public bool AnyValue { get; set; } 
```

我确定我不会再次将 AnyValue 设置为 false（我刚刚创建了它）。此属性是 ASP.NET 的 Page 类的属性。我正在检查按钮事件处理函数中的值。但不知何故，它仍然是错误的。我想知道它实际上何时设置为真？在编译时？什么时候实例化类？

你觉得我做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T15:10:04.003

DefaultValue 不**设置**值。

它的作用是告诉 VisualStudio 默认值是什么。当在表单上选择一个可视元素（按钮、列表框等）并显示“属性”面板时，VS 会将设置为 DefaultValue 中给出的值之外的属性值**加粗。**

因此，在您的情况下，由于 AnyValue 为 false，但其 DefaultValue 为 true，因此将在“属性”面板中以粗体显示**false 。**如果您要手动将其更改为“true”，则它将显示为非粗体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T15:23:22.497

那么按照我的意思设置默认值的最佳方法是什么？

这对我来说似乎是个好方法；

```
 private bool myVal = true;
    public bool MyVal
    {
        get { return myVal; } 
        set { myVal = value; }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T22:04:43.823

如前所述，它不设置值。

除了`PropertyGrid`,`[DefaultValue]`还被各种序列化器实现使用，例如`XmlSerializer`和`DataContractSerializer`。对于信息，还有第二种模式：`bool ShouldSerialize{Name}()`所有 3 都尊重。

# database - 是否有一种报表或交叉表可以优雅地显示这些数据？

> ID：269022
> 
> 赞同：1
> 
> 时间：2008-11-06T15:09:29.277
> 
> 标签：database, crystal-reports, reporting

我有这种形式的数据，

```
Article ID  Company A   Company B   Company C
1            Featured    Mentioned   --
2            Mentioned   Featured    Mentioned
3            Mentioned   --          --
4            Featured    Mentioned   Mentioned
5            Mentioned   Mentioned   Featured 
```

例如，我想展示在一篇以 A 公司为特色的文章中提到了多少次 B 公司。我可以编写一个手动查询来回答这个问题，但是，我认为也许有一种更优雅的方式可以在网格中显示所有组合的计数。然后有人可以看到在一篇文章中提到了多少次公司 C，其中公司 A 或 B 被提及，反之亦然。

有没有人对如何解决这个问题有任何建议？我今天只是没有创意，我能想到的只是蹩脚的、蛮力的、手动的方法；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T15:48:17.080

如果您可以在每一列上添加过滤器下拉列表，例如 Excel 中的自动过滤器，用户可以为公司 A 选择“提及”，为公司 B 选择“精选”，显示的行数将是答案“多少”的问题。

# c# - 如何在 .NET 中使用内联注释来记录成员？

> ID：269026
> 
> 赞同：7
> 
> 时间：2008-11-06T15:10:40.507
> 
> 标签：c#, .net, documentation, documentation-generation, xml-documentation

如何在 .Net 中记录内联成员？让我解释。大多数从注释中提取文档的工具都支持某种内联文档，您可以在其中在成员声明之后添加简要说明。就像是：

```
public static string MyField; /// <summary>Information about MyField.</summary> 
```

有没有办法在 C# 或 .NET 语言中做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T15:15:13.540

不，你不能。XML 注释仅支持作为块级注释，这意味着它必须放在您正在记录的代码元素之前。从 .NET 代码中提取 XML 注释的常用工具不了解如何解析这样的内联注释。如果您需要这种能力，您将需要编写自己的解析器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T15:16:50.167

没有内置的方法可以做到这一点。XML 文档系统是分层的；`<summary />`它定义了标签和紧随其后的数据之间的关系。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T15:12:26.450

是的，把它放在你想评论的东西之前

```
/// <summary>Information about MyField.</summary>
public static string MyField; 
```

# asp.net - Asp.net - 捕获 SQL Server sql 错误的最佳位置

> ID：269032
> 
> 赞同：2
> 
> 时间：2008-11-06T15:11:22.223
> 
> 标签：asp.net, sql-server

对于 Asp.net Web 应用程序，最好：

1.  在 sql 存储过程中捕获错误并测试代码中的返回值或
2.  只是让错误发生在 sql 中（不要处理它）并依赖 ado.net 在代码中引发错误。

这里有哪些最佳实践？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T15:56:56.343

适用于此的一般规则是在尽可能靠近源的位置捕获错误。SQL Server 现在具有“try ... catch ...”错误捕获语法。所以使用它。一点点额外代码的开销是微不足道的，如果您的 SP 中有多个语句，您可以调整 RAISERROR 中的字符串以帮助定位问题。

在界面中，捕获 SP 错误事件并以与处理程序代码中的其他错误捕获相同的方式处理它应该不难。

这是存储过程中更被忽视的“最佳实践”之一，它比“常规”代码更重要，因为使用 step=through 调试器更棘手。

一种有用的模式是在您的 SP 中处理此问题，就像您希望在任何其他不透明 SDK 库中处理它一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T15:19:22.503

根据这篇[文章](http://blogs.msdn.com/ericlippert/archive/2008/09/10/vexing-exceptions.aspx)，这是一种“愚蠢的”异常——即如果在 SP 中发生错误，这意味着 SP 或数据本身有问题。

我的建议是在 aps.net 中捕获错误，因为您有更多可能记录错误以及传递给 SP 以调查问题的所有参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T15:15:21.107

我对库或其他服务器（包括数据库查询）的所有潜在错误生成调用使用 try/catch。我主要是开发人员而不是 DBA，所以我用我最精通的语言处理错误，C# 而不是 SQL。我相信每个程序员都会有所不同。在我的书中，不处理错误永远不会好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T15:15:32.370

我两个都喜欢——

*   存储过程调用 RAISEERROR，这在 ADO.NET 中表现为异常
*   存储过程返回错误代码，以防一个存储过程调用另一个存储过程

一般来说，我总是在 try-catch 中进行 db 调用

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T15:39:45.567

数据层中最可能的故障模式是错误的用户输入值，例如请求不存在的记录。大多数其他错误是由有缺陷的代码引起的，通常在测试时会立即被发现。我喜欢捕获 db 错误，并且总是抛出一个自定义错误，其中包含有关请求的数据和上下文的更多信息。然后错误冒泡备份调用堆栈，如果它是用户可纠正的错误，我可以提醒他们注意这一事实。否则，当错误到达堆栈顶部时，将调用应用程序的中央错误页面处理程序。最糟糕的事情是发现错误，而不是让它再次冒泡。除非与 com 组件或外部系统通信，否则返回代码是过时的结构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T15:48:58.573

理想情况下，您的 Web 应用程序不知道后端或数据访问。所以它不应该处理与 sql 相关的错误——那些应该由数据访问层处理。但是 Web 应用程序需要通过向最终用户提供友好的消息来优雅地处理故障。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T18:21:10.857

我想说这取决于您在存储过程中所做的事情以及您想对发生的某些错误做什么。有时我在 sp 中处理它，但有时我让它上升到数据层代码。

请记住，有时您在使用 sql server 2005 try/catch 时可能会错过错误，请参阅[我的帖子](https://stackoverflow.com/questions/222119/sql-server-2005-errormessage-not-showing-full-message)。而在代码中（在我的例子中是 C#），您可以访问 SqlErrorCollection 对象中的所有错误。

只需绝对确定您在存储过程中的错误处理是经过深思熟虑的，并且任何不确定性都留给您必须记录所有内容的数据层代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T19:28:52.657

答案是你需要两者都做。有些错误实际上是从数据库引擎下线触发的。当然，它们的来源会根据您连接到数据库的实际方式（OLBC、OLEDB 等）而有所不同。你必须找到处理这些的方法。一些错误（例如死锁错误）也需要在应用程序级别进行处理。

除了错误之外，接收和处理来自 SQL Server 数据库引擎的消息也是一个好主意。这些与错误非常相似，可以为应用程序提供许多有用的诊断信息。如果您使用 System.Data.SQLClient，则需要创建一个 SqlInfoMessageEventHandler 委托，标识处理事件的方法，以侦听 SqlConnection 类上的 InfoMessage 事件。您会发现诸如严重性和状态之类的消息上下文信息作为参数传递给回调，因为从系统的角度来看，这些消息就像错误一样。我希望这有帮助！

# asp.net - asp.net 中的连接池

> ID：269042
> 
> 赞同：0
> 
> 时间：2008-11-06T15:13:37.197
> 
> 标签：asp.net, database, ado.net

我一直在stackoverflow中寻找它但没有成功......

是否可以在 asp.net 中进行连接池？值得吗？如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T15:16:53.943

它实际上非常简单，只需将以下参数添加到您的连接字符串和（在代码中或在 web.config 中）和 ASP.NET 将拿起其余的：

```
Min Pool Size=5; Max Pool Size=60; Connect Timeout=300; 
```

*注意：连接超时以秒为单位，不是必需的。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-06-16T08:55:28.857

默认情况下，最大池为 100

# javascript - 使用 JavaScript 删除 URL 中的片段，不导致页面重新加载

> ID：269044
> 
> 赞同：46
> 
> 时间：2008-11-06T15:14:06.790
> 
> 标签：javascript, html, url, fragment-identifier

**背景：**我有一个 HTML 页面，可以让您扩展某些内容。由于这种扩展只需要加载页面的一小部分，它是通过 JavaScript 完成的，而不是通过定向到新的 URL/HTML 页面。但是，作为奖励，用户可以永久链接到此类扩展部分，即向其他人发送一个 URL，例如

*[http://example.com/#foobar](http://example.com/#foobar)*

并立即为该其他用户打开“foobar”类别。这可以使用 parent.location.hash = 'foobar'，所以这部分很好。

**现在的问题是：**当用户关闭页面上这样一个类别时，我想再次清空URL片段，即将[http://example.com/#foobar](http://example.com/#foobar)变成[http://example.com/](http://example.com/)来更新永久链接显示. 但是，这样做`parent.location.hash = ''`会导致重新加载整个页面（例如在 Firefox 3 中），我想避免这种情况。使用`window.location.href = '/#'`不会触发页面重新加载，但会在 URL 中留下看起来不太好看的“#”符号。那么在流行的浏览器中是否有一种方法可以在不触发页面刷新的情况下删除包含“#”符号的 URL 锚点？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-12-11T16:20:07.130

正如其他人所提到的， HTML5 中的[replaceState](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history#The_replaceState%28%29.C2.A0method)可用于删除 URL 片段。

这是一个例子：

```
// remove fragment as much as it can go without adding an entry in browser history:
window.location.replace("#");

// slice off the remaining '#' in HTML5:    
if (typeof window.history.replaceState == 'function') {
  history.replaceState({}, '', window.location.href.slice(0, -1));
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-06T15:22:40.967

既然您正在控制对哈希值的操作，为什么不使用表示“无”的标记，例如“#_”或“#default”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-06T19:44:29.860

您可以使用闪亮的新 HTML5`window.history.pushState`和`replaceState`方法，如[ASCIIcasts 246: AJAX History State](http://asciicasts.com/episodes/246-ajax-history-state)和[GitHub 博客中所述](https://github.com/blog/760-the-tree-slider)。这使您可以更改整个路径（在同一源主机内），而不仅仅是片段。要试用此功能，请使用最近的浏览器浏览[GitHub 存储库。](https://github.com/chrisboyle/sgtpuzzles)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-01-05T09:29:51.700

还有另一种选择，而不是使用哈希，您可以使用`javascript: void(0);` 示例：`<a href="javascript:void(0);" class="open_div">Open Div</a>`

我想这也取决于您何时需要这种链接，因此您最好检查以下链接：

如何使用它：[http](http://www.brightcherry.co.uk/scribbles/2010/04/25/javascript-how-to-remove-the-trailing-hash-in-a-url/) ://www.brightcherry.co.uk/scribbles/2010/04/25/javascript-how-to-remove-the-trailing-hash-in-a-url/ 或查看关于什么的辩论这里更好：[我应该为 JavaScript 链接使用哪个“href”值，“#”还是“javascript:void(0)”？](https://stackoverflow.com/questions/134845/href-for-javascript-links-or-javascriptvoid0)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-07T16:52:09.857

将此代码放在头部。

```
<script type="text/javascript">
    var uri = window.location.toString();
    if (uri.indexOf("?") > 0) {
        var clean_uri = uri.substring(0, uri.indexOf("?"));
        window.history.replaceState({}, document.title, clean_uri);
    }
</script> 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-06T15:28:42.297

```
$(document).ready(function() {
        $(".lnk").click(function(e) {
            e.preventDefault();
            $(this).attr("href", "stripped_url_via_desired_regex");
        });
    }); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-07-16T16:58:19.217

所以使用

`parent.location.hash = ''`第一的

然后做

```
window.location.href=window.location.href.slice(0, -1); 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2011-01-05T09:58:20.450

正如其他人所说，你不能这样做。另外......说真的，作为[jQuery Ajaxy](http://balupton.com/sandbox/jquery-ajaxy/demo/)的作者——我已经部署了完整的 ajax 网站多年了——我可以保证没有最终用户曾经抱怨过，或者甚至可能注意到有这个散列的事情正在发生，用户不要’只要它有效并且他们得到他们想要的东西，就不会在乎。

一个合适的解决方案是 HTML5 PushState/ReplaceState/PopState ;-) 它不再需要片段标识符： [https](https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history) ://developer.mozilla.org/en/DOM/Manipulating_the_browser_history 对于支持此功能的 HTML5 和 HTML4 兼容项目HTML5 状态功能检查[https://github.com/browserstate/History.js](https://github.com/browserstate/History.js) :-)

# .net - 如何在 Visual Studio 生成的 MSI 中更改 .InstallState 文件的位置

> ID：269046
> 
> 赞同：3
> 
> 时间：2008-11-06T15:15:15.383
> 
> 标签：.net, visual-studio, installation

我有一个使用 Visual Studio 安装项目创建的 MSI 文件。安装程序会在应用程序目录中生成一个 .InstallState 文件。有没有办法让这个文件在不同的位置而不是默认位置生成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T18:18:51.363

您需要设置 InstallStateDir 的值。
您需要覆盖 Commit/Install/Rollback/Uninstall 并设置 InstallStateDir (IE Con​​text["InstallStateDir"] = @"c:\mydir") 的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-12-21T22:48:15.890

这也应该通过从命令行指定 /InstallStateDir="c:\myfolder" 来工作（请参阅 KB946503）。但是，InstallContext 正在将所有参数名称转换为小写，这会破坏 AssemblyInstaller 中的以下代码，期望找到混合大小写的参数名称：

```
private string GetInstallStatePath(string assemblyPath)
{
    string str2 = base.Context.Parameters["InstallStateDir"];
    assemblyPath = Path.ChangeExtension(assemblyPath, ".InstallState");
    if (!string.IsNullOrEmpty(str2))
    {
        return Path.Combine(str2, Path.GetFileName(assemblyPath));
    }
    return assemblyPath;
} 
```

设置`Context["InstallStateDir"]`可能有助于保存状态；但是，由于之前加载的状态`Uninstall`可以修改上下文，因此在微软修复上述方法之前，这不是可行的解决方案`AssemblyInstaller.GetInstallStatePath`。

# c# - 如何确定从母版页显示哪个子页？

> ID：269050
> 
> 赞同：25
> 
> 时间：2008-11-06T15:15:21.170
> 
> 标签：c#, asp.net, master-pages

我正在母版页上编写代码，我需要知道正在显示哪个子（内容）页面。如何以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2010-07-09T18:14:15.160

我用这个：

```
string pageName = this.ContentPlaceHolder1.Page.GetType().FullName; 
```

它以这种格式“ASP.default_aspx”重新调整类名，但我发现对于大多数用途来说这很容易解析。

希望有帮助！

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-11-06T16:29:34.437

最好让`ContentPage`通知`MasterPage`。这就是为什么`ContentPage`有一个`Master`属性而`MasterPage`没有`Child`属性。最好的做法是在 上定义一个属性或方法，并`MasterPage`通过.`Master``ContentPage`

如果您使用此技术，最好明确指定 MasterPage 的类名。这使得在 ContentPage 中使用 MasterPage。

例子：

```
//Page_Load
MyMaster m = (MyMaster)this.Master;

m.TellMasterWhoIAm(this); 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-06T15:37:06.103

这听起来像是一个坏主意。大师的想法是它不应该关心那里的页面，因为这是每个页面的所有通用代码。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-08-23T12:33:07.010

我有理由检查母版页中的子页。

我的母版页上有所有菜单选项，如果未设置某些系统设置，则需要禁用它们。

如果不是，则会显示一条消息并禁用按钮。由于设置页面是此母版页的内容页面，我不希望该消息继续显示在所有设置页面上。

这段代码对我有用：

```
 //Only show the message if on the dashboard (first page after login)
                if (this.ContentPlaceHolder1.Page is Dashboard)
                {
                    //Show modal message box
                    mmb.Show("Warning Message");
                } 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-07-08T11:50:57.423

使用下面的代码。

```
Page.ToString().Replace("ASP.","").Replace("_",".") 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-06T15:20:28.133

您可以使用：

[Request.CurrentExecutionFilePath](http://msdn.microsoft.com/en-us/library/system.web.httprequest.currentexecutionfilepath(loband).aspx)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2015-07-30T07:45:11.917

这是我对问题的解决方案（此代码进入母版页后面的代码）：

```
if (Page.TemplateControl.AppRelativeVirtualPath == "~/YourPageName.aspx")
{
   // your code here
} 
```

或者更复杂一点，但可读性较差：

```
if (Page.TemplateControl.AppRelativeVirtualPath.Equals("~/YourPageName.aspx", StringComparison.OrdinalIgnoreCase))
{
   // your code here
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-03-25T08:28:59.050

```
Request.CurrentExecutionFilePath; 
```

或者

```
Request.AppRelativeCurrentExecutionFilePath; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T15:23:35.240

我在我的一个项目中做了类似的事情，以根据正在加载的页面动态附加 css 文件。我只是从请求中获取文件的名称：

```
this.Request.Url.AbsolutePath 
```

然后从那里提取文件名。我不确定如果您正在重写 URL，这是否会起作用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-27T10:28:12.547

您可以通过获取最后一个段或请求来做到这一点，我将成为表单名称

```
string pageName = this.Request.Url.Segments.Last(); 

if (pageName.Contains("EmployeeTermination.aspx"))
{

} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-10-14T09:56:45.943

你可以试试这个：

`<%: this.ContentPlaceHolder1.Page.GetType().Name.Split('_')[0].ToUpper() %>`

将该代码`title`放在`Site.Master`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-05-11T13:18:37.880

```
string s =   Page.ToString().Replace("ASP.directory_name_","").Replace("_aspx",".aspx").Replace("_","-");
        if (s == "default.aspx")
              { /* do something */ } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-20T12:41:29.263

我正在使用这么多答案

```
<%if(this.MainContent.Page.Title != "mypagetitle") { %>
<%}%> 
```

这使得排除任何单个页面变得容易，并且由于您比较一个字符串，您甚至可以为 exclude_pagetitle 之类的页面添加前缀并比较标题的子字符串。我通常使用它来从某些我不想加载的功能中排除登录页面，例如会话超时和实时聊天。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-11-24T05:39:44.617

下面的代码就像一个迷人的..试试看

```
string PName = Request.UrlReferrer.Segments[Request.UrlReferrer.Segments.Length - 1]; 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2008-11-06T15:22:18.677

您应该可以从母版页代码中获得 Page.Request.Url.PathAndQuery 或 Url Uri 对象的其他属性之一。

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2008-11-06T15:40:34.037

您可以在代码隐藏中检查页面类型：

```
// Assuming MyPage1, MyPage2, and MyPage3 are the class names in your aspx.cs files:

if (this.Page is MyPage1)
{
  // do MyPage1 specific stuff
}
else if (this.Page is MyPage2)
{
  // do MyPage2 specific stuff
}
else if (this.Page is MyPage3)
{
  // do MyPage3 specific stuff
} 
```

# sql-server - osql.exe 可以独立运行吗？

> ID：269053
> 
> 赞同：3
> 
> 时间：2008-11-06T15:15:56.973
> 
> 标签：sql-server, osql

我有一个从 microsoft sql server 工具目录运行 osql.exe 并运行脚本的程序。

问题是在没有安装 sql server 的计算机上，缺少此工具。所以我的问题是是否可以将它作为独立运行（以及可能需要的任何 dll），这意味着从应用程序的本地目录中的 Process.Start 运行它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-08T19:37:39.097

是的你可以。只需复制二进制文件即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T15:18:43.893

你为什么要产生osql？

我已经编写了简单的程序来使用 SMO 执行脚本 - 主要受[这篇文章的](http://weblogs.asp.net/jgalloway/archive/2006/11/07/Handling-_2200_GO_2200_-Separators-in-SQL-Scripts-_2D00_-the-easy-way.aspx)启发。

**编辑**

这篇文章的要点是使用[SQL Server Management Objects (SMO)](https://msdn.microsoft.com/en-gb/library/ms162169.aspx)。 [`Server.ConnectionContext.ExecuteNonQuery`](http://msdn2.microsoft.com/en-us/library/microsoft.sqlserver.management.common.serverconnection.executenonquery.aspx)解析带有`GO`语句的 SQL。

# c++ - 如何在 MFC 应用程序退出时设置错误级别

> ID：269054
> 
> 赞同：4
> 
> 时间：2008-11-06T15:16:45.987
> 
> 标签：c++, windows, mfc, batch-file, cmd

我有一个我帮助维护的 MFC 旧版应用程序。我不太确定如何识别 MFC 的版本，而且我认为它不会有所作为。

该应用程序可以在命令行上接受一些参数；我希望能够在退出应用程序时设置错误级别，以允许 bat/cmd 文件检查失败并做出适当的响应。

我不相信 exit() 会起作用（老实说还没有尝试过），因为这是一个 MFC 应用程序。任何人都知道如何设置 MFC 应用程序返回的错误级别？我可以只使用exit()吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T15:21:02.127

我不能对此表示赞赏，所以请不要回复。

CWinApp::ExitInstance(); 返回我的退出代码；

这会将错误级别返回给调用批处理文件，供您评估并采取行动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-16T16:50:02.973

如果您的应用程序拒绝在您运行它的 DOS shell 中更新 ERRORLEVEL，无论您在程序代码中做什么，使用“start /wait”运行您的应用程序可能会有所帮助，以便 shell 被锁定直到您的程序结束.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T15:18:57.153

[这里](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/00d97998-f0b2-439a-9fa3-5dbcdd47cac4/)列出了几个解决方案，我无法评论哪个更好，但我相信其中至少有一个可以让你到达那里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T18:19:02.890

我总是成功地从 CWinApp::ExitInstance 返回错误代码。我相信默认实现将返回退出消息中的值。因此，如果这更容易，您可以使用 AfxPostQuitMessage。但是我没有亲自测试过第二种方法。

# c# - 如何将索引字段添加到 Linq 结果

> ID：269058
> 
> 赞同：62
> 
> 时间：2008-11-06T15:17:46.173
> 
> 标签：c#, linq

假设我有一个这样的数组：

```
string [] Filelist = ... 
```

我想创建一个 Linq 结果，其中每个条目在数组中的位置如下所示：

```
var list = from f in Filelist
    select new { Index = (something), Filename = f}; 
```

第一项的索引为 0，第二项的索引为 1，依此类推。

我应该为表达式 Index= 使用什么？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2008-11-06T15:19:35.873

不要使用查询表达式。使用[它的重载`Select`传递给你一个索引](http://msdn.microsoft.com/en-us/library/bb534869.aspx)：

```
var list = FileList.Select((file, index) => new { Index=index, Filename=file }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T15:27:05.123

```
string[] values = { "a", "b", "c" };
int i = 0;
var t = (from v in values
select new { Index = i++, Value = v}).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-26T12:00:47.760

您**无法**使用纯 LINQ 查询表达式（带有`from.. where.. select..`子句的表达式）获取索引。

但是，这并不意味着您必须完全放弃这种 LINQ 查询样式。

您只需要**摆脱 LINQ 查询表达式**并使用`.Select(item, index)`方法重载。

```
var newestExistingFilesWithIndexes = 
    (from f in Filelist
     // we love LINQ query expressions
     where f.Exists
     // and we use it anywhere possible
     orderby f.LastModified descending
     select f)
     // but sometimes we have to get out and use LINQ extension methods
    .Select((f, index) => new { Index = index, Filename = f.Fullname}); 
```

或者假设，您需要根据项目索引过滤列表...

```
var newestExistingFilesOnlyEvenIndexes = 
     // use the Select method overload to get the index
    (from f in Filelist.Select((file, index) => new { file, index })
     // only take item with an even index
     where f.index % 2 == 0
     where f.file.Exists
     orderby f.file.LastModified descending
     select f.file); 
```

# python - 是否有尝试猜测某些字节的字符编码的 Python 库函数？

> ID：269060
> 
> 赞同：18
> 
> 时间：2008-11-06T15:18:20.227
> 
> 标签：python, email, character-encoding, invalid-characters

我正在用 Python 编写一些邮件处理软件，在标头字段中遇到奇怪的字节。我怀疑这只是格式错误的邮件；消息本身声称是 us-ascii，所以我认为没有真正的编码，但我想在不抛出`UnicodeDecodeError`.

所以，我正在寻找一个函数，它需要 a`str`和可选的一些提示，并尽最大努力给我一个`unicode`. 我当然可以写一个，但如果存在这样的函数，它的作者可能已经更深入地考虑了解决这个问题的最佳方法。

我也知道 Python 的设计更喜欢显式而不是隐式，并且标准库旨在避免在解码文本时使用隐式魔法。我只想明确地说“继续猜测”。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-06T16:13:29.367

+1 用于[chardet](http://web.archive.org/web/20110709171259/http://chardet.feedparser.org/docs/faq.html)模块（由 建议[`@insin`](https://stackoverflow.com/questions/269060/is-there-a-python-library-function-which-attempts-to-guess-the-character-encoding/269105#269105)）。

它不在标准库中，但您可以使用以下命令轻松安装它：

```
$ pip install chardet 
```

[示例](http://web.archive.org/web/20111003070626/http://chardet.feedparser.org/)：

```
>>> import chardet
>>> import urllib
>>> detect = lambda url: chardet.detect(urllib.urlopen(url).read())
>>> detect('http://stackoverflow.com')
{'confidence': 0.85663169917190185, 'encoding': 'ISO-8859-2'}    
>>> detect('https://stackoverflow.com/questions/269060/is-there-a-python-lib')
{'confidence': 0.98999999999999999, 'encoding': 'utf-8'} 
```

如果没有，请参阅[安装 Pip 。](http://guide.python-distribute.org/installation.html#installing-pip)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-07T21:03:20.330

据我所知，标准库没有函数，尽管按照上面的建议编写一个函数并不难。我认为我正在寻找的真正东西是一种解码字符串并保证它不会引发异常的方法。string.decode 的 errors 参数就是这样做的。

```
def decode(s, encodings=('ascii', 'utf8', 'latin1')):
    for encoding in encodings:
        try:
            return s.decode(encoding)
        except UnicodeDecodeError:
            pass
    return s.decode('ascii', 'ignore') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-07T02:31:26.907

我发现做到这一点的最好方法是迭代地尝试使用 try except 块内的每个最常见的编码来解码预期。

# string - 如何使用调用库函数节点将字符串传递回labview

> ID：269062
> 
> 赞同：4
> 
> 时间：2008-11-06T15:18:32.613
> 
> 标签：string, dll, labview

我想使用LabVIEW的调用库函数节点来访问一个DLL函数，并让这个函数返回一个字符串以显示在我的VI上。我该怎么做呢？我很高兴从我的 DLL 中返回数字，但我真的很难找到任何关于如何返回字符串的示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-07T05:30:49.383

至少有几种方法可以从调用库函数节点返回字符串：

1.  从您的 DLL 函数返回一个 C 字符串指针，并将调用库函数节点配置为具有“C 字符串指针”的返回类型。注意，返回的字符串必须在函数返回后才有效，所以不能是指向栈上分配的字符串的指针。它必须是以下之一：在堆上分配、静态分配、常量字符串文字等。

    看起来`examples/dll/regexpr/Regular Expression Solution/VIs/Get Error String.vi`在LabVIEW目录中采用了这种方法。

2.  在您的 VI 中分配一个字符串，使用 Azim 建议的“C 字符串指针”参数将其传递给调用库函数节点，然后覆盖其在 DLL 中的内容。分配字符串的一种方法是使用 Initialize Array 创建所需大小的 u8 数组，然后使用 Byte Array To String 将其转换为字符串。

    确保您传入的字符串足够大以容纳字符串的内容，并确保将字符串长度传递给 DLL，以便它知道缓冲区有多大。我相信默认参数是一个空字符串。如果您的 VI 的第一次猜测不够大，那么确定正确的字符串长度可能需要调用 DLL 两次。

3.  使用“字符串句柄”参数将字符串传递给调用库函数节点，并根据需要使用 DLL 中的 LabVIEW 函数来调整字符串的大小。这要求您的 DLL 专门设计为与 LabVIEW 交互，并且需要链接到 LabVIEW 提供的静态库。

    此方法的一个示例随 LabVIEW 一起提供`examples/dll/hostname/hostname.vi`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T17:50:34.053

我从您的问题中假设您已经有一个可以将数字返回给 Labview 的 DLL。为了从 DLL 返回一个字符串，我创建了一个带有以下 C++ 函数的 DLL

```
void returnString(char myString[])
{
  const char *aString = "test string";
  memcpy(myString, aString, 12);
} 
```

然后在 Labview 中，我使用调用库函数节点并将其配置如下

```
    库名称或路径：c:\path\to\my\custom.dll
           函数名称：返回字符串
           调用约定：C

    参数：
           参数：返回类型
                类型：无效

           参数：arg1
                类型：字符串
                字符串格式：C 字符串指针

    函数原型：
        无效返回字符串（CStr arg1）；

```

将框图中的 arg1 输出连接到字符串指示器并运行。字符串“test string”应该出现在前面板上。

我试图让 returnString 函数的类型为 CStr ，如

```
CStr returnString()
{ ...
 } 
```

但是在编译 DLL 项目时出现构建错误。

更新

感谢@bk1e 评论，不要忘记在 Labview 中为字符串预分配空间。

# .net - 引用 COM 对象 ActiveD 或 MSXML2 时出现大量构建警告

> ID：269063
> 
> 赞同：12
> 
> 时间：2008-11-06T15:18:43.487
> 
> 标签：.net, msbuild, com-interop, tlbimp

将项目从 .NET 1.1 移动到 .NET 2.0 后，MsBuild 会针对某些 COM 对象发出大量警告。

测试示例代码（实际代码无关紧要，仅用于创建警告）：

```
using System;
using System.DirectoryServices;
using ActiveDs;
namespace Test
{
    public class Class1
    {
        public static void Main(string[] args)
        {
            string adsPath = String.Format("WinNT://{0}/{1}", args[0], args[1]);
            DirectoryEntry localuser = new DirectoryEntry(adsPath);
            IADsUser pUser = (IADsUser) localuser.NativeObject;
            Console.WriteLine("User = {0}", pUser.ADsPath);
        }
    }
} 
```

警告消息看起来像

*C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Microsoft.Common.targets：警告：运行时封送处理程序无法封送“ITypeLib.RemoteGetLibAttr”的至少一个参数。因此，此类参数将作为指针传递，并且可能需要不安全的代码来操作。*

观察：

*   ActiveDs（11 个警告）和 MSXML2（54 个警告）会发生这种情况。
*   我们自己的 COM 对象没有看到。
*   `<Reference>`.csproj 文件中的条目包含属性`WrapperTool = "tlbimp"`
*   尽管有所有警告，但在运行的系统中没有发现任何问题。

知道如何摆脱警告吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-10-19T11:40:53.080

我遇到了同样的问题，并通过编辑项目文件（.csproj）来修复它，遵循这里的建议：

[https://social.msdn.microsoft.com/Forums/vstudio/en-US/7a7c352b-20cb-4931-b3b5-27e899016f75/turning-off-msbuild-warnings-msb3305?forum=msbuild](https://social.msdn.microsoft.com/Forums/vstudio/en-US/7a7c352b-20cb-4931-b3b5-27e899016f75/turning-off-msbuild-warnings-msb3305?forum=msbuild)

我在每个构建配置的属性组中添加了以下键：

```
<ResolveComReferenceSilent>True</ResolveComReferenceSilent> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-09-10T00:29:27.800

根据[MDSN 文章中关于 TLBIMP for 2.0](http://msdn.microsoft.com/en-us/library/tt0cf3sx(VS.80).aspx)的评论，您无法在不自己运行 TLBIMP 的情况下解决此问题。

使用 VS 很容易重现您的问题。我还从 VS 注释提示中手动复制了它运行 TLBIMP：

```
 tlbimp c:\WINNT\system32\activeds.tlb /out:interop.activeds.dll 
```

解决方法是使用 /silent 开关

```
 tlbimp c:\WINNT\system32\activeds.tlb /silent /out:interop.activeds.dll 
```

正如 MSDN 文章中的评论所指出的，COM 引用变成了对您自己构建的互操作程序集的 .net 程序集引用。

我不是 VS 专家，但我通过向以下项目添加预构建来完成这项工作：

```
 "$(DevEnvDir)\..\..\SDK\v2.0\bin\tlbimp" c:\WINNT\system32\activeds.tlb
            /namespace:ActiveDs /silent /out:"$(ProjectDir)interop.activeds.dll" 
```

构建一次，所以我有一个 dll 来添加浏览选项卡的引用。在我的项目根目录中添加了对 interop.activeds.dll 的引用，然后再次构建。您可能希望以其他方式执行此操作，例如通过 C++ 项目使用外部 make 文件。这更像是一个 POC。

请注意 MSBUILD 与 VS 的一个有趣区别，$(DevEnvDir) 有一个尾随反斜杠，但 MSBUILD 没有。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-08-22T03:12:30.197

您可以通过以下方式停止警告：

```
    #pragma 警告禁用警告列表
    #pragma warning 恢复警告列表

```

其中警告列表是以逗号分隔的警告编号列表。

该警告意味着您正在导入的类型库包含无法转换为托管代码的内容，但可以在不安全的代码块中使用指针操作来处理。该代码在 .Net 1.1 中也无法翻译，但是编译器不够聪明，无法警告您如果使用其中一种警告您的方法可能会陷入陷阱。

# visual-studio - 那里存在哪些调试可视化工具？

> ID：269067
> 
> 赞同：6
> 
> 时间：2008-11-06T15:19:03.847
> 
> 标签：visual-studio, debugging, debuggervisualizer

我知道这个问题：[您使用哪些（第三方）调试 Visual Studio 2005/2008 的可视化工具？](https://stackoverflow.com/questions/100548/which-third-party-debug-visualizers-for-visual-studio-20052008-do-you-use)

但我不想知道您使用什么调试可视化工具，我想知道有哪些调试可视化*工具*。

我只找到了 Mole ( [http://www.codeproject.com/KB/macros/MoleForVisualStudioEdit.aspx](http://www.codeproject.com/KB/macros/MoleForVisualStudioEdit.aspx) )，这很棒。但那里必须有更多吗？

开导我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T15:35:04.797

从快速的网络搜索...

相关问题的博客文章中引用了一个：

*   [http://blogs.msdn.com/dparys/archive/2007/10/23/das-debugger-visualizer-item-template.aspx](http://blogs.msdn.com/dparys/archive/2007/10/23/das-debugger-visualizer-item-template.aspx)
*   [LINQ to SQL 调试可视化工具](http://weblogs.asp.net/scottgu/archive/2007/07/31/linq-to-sql-debug-visualizer.aspx)
*   [图形调试可视化工具](http://www.codeproject.com/KB/macros/GraphicDebuggerVisualizer.aspx)
*   [Windows 身份调试可视化工具](http://geekswithblogs.net/khanna/archive/2006/01/05/64903.aspx)
*   [Conchango XML 调试可视化工具](http://blogs.conchango.com/howardvanrooijen/archive/2005/11/24/2424.aspx)
*   [SubSonic Collections 调试可视化工具](http://subsonicproject.com/utility/debug-visualizer-for-subsonic-collections/)
*   [PowerShell 调试可视化工具](http://www.codeplex.com/PoSHDebugVisualizer)
*   [Xml 可视化工具 v.2](http://www.codeplex.com/XmlVisualizer)
*   [WCF 可视化工具](http://www.codeplex.com/WCFVisualizer)
*   [WPF 依赖对象可视化工具](http://www.codeplex.com/dathanliblikdepo)
*   [数据库连接可视化器](http://www.codeplex.com/dbvisualizer)
*   [BizTalk 2006 的调试器可视化工具：MessageContext](http://blogs.msdn.com/gzunino/archive/2006/03/20/555788.aspx)
*   [数据集调试可视化工具](http://cs.rthand.com/blogs/blog_with_righthand/pages/Righthand-Dataset-Debugger-Visualizer.aspx)
*   [GUID 调试可视化工具](http://devmatter.blogspot.com/2006/04/guid-debugger-visualizer-for-visual.html)
*   [调试检查器](http://www.visualstudiogallery.com/ExtensionDetails.aspx?ExtensionID=f52d4c99-a49f-4d5e-9251-97669a15038d)
*   [WPF 画笔可视化工具](http://brushvisualizer.codeplex.com/)
*   [表达式树可视化器](https://github.com/zspitz/ExpressionTreeVisualizer)
*   [ANTLR4 解析树可视化工具](https://github.com/zspitz/ANTLR4ParseTreeVisualizer)
*   [日期时间可视化工具](https://github.com/zspitz/DateTimeVisualizer)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-29T13:57:39.503

还有[Regex Kit](http://osherove.com/blog/2005/11/26/announcing-regex-kit-regular-expression-visualizers-for-vs-2.html)，一个正则表达式调试器可视化工具。

# c# - ObservableCollection 还监视集合中元素的变化

> ID：269073
> 
> 赞同：32
> 
> 时间：2008-11-06T15:20:01.083
> 
> 标签：c#, collections

是否存在具有以下特征的集合（BCL 或其他）：

如果集合发生更改，则发送事件；如果集合中的任何元素发送事件，则发送`PropertyChanged`事件。有点像`ObservableCollection<T>`where`T: INotifyPropertyChanged`和集合也在监视元素的变化。

我可以自己包装一个可观察的集合，并在添加/删除集合中的元素时执行事件订阅/取消订阅，但我只是想知道是否有任何现有的集合已经这样做了？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-06T15:28:17.353

自己做了一个快速的实现：

```
public class ObservableCollectionEx<T> : ObservableCollection<T> where T : INotifyPropertyChanged
{
    protected override void OnCollectionChanged(NotifyCollectionChangedEventArgs e)
    {
        Unsubscribe(e.OldItems);
        Subscribe(e.NewItems);
        base.OnCollectionChanged(e);
    }

    protected override void ClearItems()
    {
        foreach(T element in this)
            element.PropertyChanged -= ContainedElementChanged;

        base.ClearItems();
    }

    private void Subscribe(IList iList)
    {
        if (iList != null)
        {
            foreach (T element in iList)
                element.PropertyChanged += ContainedElementChanged;
        }
    }

    private void Unsubscribe(IList iList)
    {
        if (iList != null)
        {
            foreach (T element in iList)
                element.PropertyChanged -= ContainedElementChanged;
        }
    }

    private void ContainedElementChanged(object sender, PropertyChangedEventArgs e)
    {
        OnPropertyChanged(e);
    }
} 
```

承认，当实际更改的属性位于包含的元素上时，在集合上触发 PropertyChanged 会有点令人困惑和误导，但它符合我的特定目的。可以使用在 ContainerElementChanged 内触发的新事件来扩展它

想法？

编辑：应该注意，BCL ObservableCollection 仅通过显式实现公开 INotifyPropertyChanged 接口，因此您需要提供强制转换才能附加到事件，如下所示：

```
ObservableCollectionEx<Element> collection = new ObservableCollectionEx<Element>();
((INotifyPropertyChanged)collection).PropertyChanged += (x,y) => ReactToChange(); 
```

EDIT2：增加了对 ClearItems 的处理，感谢 Josh

EDIT3：为 PropertyChanged 添加了正确的取消订阅，感谢 Mark

EDIT4：哇，这真的是边学边学:)。KP 指出，当 a 包含的元素发生变化时，该事件是在集合作为发送者而不是元素时触发的。*他建议在标有new*的类上声明一个 PropertyChanged 事件。这会有一些问题，我将尝试用下面的示例来说明：

```
 // work on original instance
  ObservableCollection<TestObject> col = new ObservableCollectionEx<TestObject>();
  ((INotifyPropertyChanged)col).PropertyChanged += (s, e) => { Trace.WriteLine("Changed " + e.PropertyName); };

  var test = new TestObject();
  col.Add(test); // no event raised
  test.Info = "NewValue"; //Info property changed raised

  // working on explicit instance
  ObservableCollectionEx<TestObject> col = new ObservableCollectionEx<TestObject>();
  col.PropertyChanged += (s, e) => { Trace.WriteLine("Changed " + e.PropertyName); };

  var test = new TestObject();
  col.Add(test); // Count and Item [] property changed raised
  test.Info = "NewValue"; //no event raised 
```

您可以从示例中看到，“覆盖”事件具有副作用，您需要非常小心在订阅事件时使用哪种类型的变量，因为这决定了您接收哪些事件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-07-23T08:14:36.177

@soren.enemaerke：我会在您的回答帖子上发表此评论，但我不能（我不知道为什么，也许是因为我没有很多代表点）。无论如何，我只是想我会提到在您发布的代码中，我认为 Unsubscribe 不能正常工作，因为它正在创建一个新的内联 lambda，然后尝试删除它的事件处理程序。

我会将添加/删除事件处理程序行更改为：

```
element.PropertyChanged += ContainedElementChanged; 
```

和

```
element.PropertyChanged -= ContainedElementChanged; 
```

然后将 ContainedElementChanged 方法签名更改为：

```
private void ContainedElementChanged(object sender, PropertyChangedEventArgs e) 
```

这将识别出删除是针对与添加相同的处理程序，然后正确删除它。希望这可以帮助某人:)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T16:17:32.043

如果你想使用框架内置的东西，你可以使用[FreezableCollection](http://msdn.microsoft.com/en-us/library/aa346595.aspx)。然后你会想听[Changed 事件](http://msdn.microsoft.com/en-us/library/system.windows.freezable.changed.aspx)。

> 当 Freezable 或其包含的对象被修改时发生。

这是一个小样本。collection_Changed 方法将被调用两次。

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();

        FreezableCollection<SolidColorBrush> collection = new FreezableCollection<SolidColorBrush>();
        collection.Changed += collection_Changed;
        SolidColorBrush brush = new SolidColorBrush(Colors.Red);
        collection.Add(brush);
        brush.Color = Colors.Blue;
    }

    private void collection_Changed(object sender, EventArgs e)
    {
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-06T00:10:21.190

我会使用[ReactiveUI 的](http://www.reactiveui.net/) `ReactiveCollection`：

```
reactiveCollection.Changed.Subscribe(_ => ...); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T16:04:11.993

查看[C5 通用集合库](http://www.itu.dk/research/c5)。它的所有集合都包含事件，您可以使用这些事件为添加、删除、插入、清除项目或集合更改时附加回调。

我正在为该库的一些扩展工作[，](http://c5.xpdm.us)在不久的将来应该允许“预览”事件允许您取消添加或更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-02T00:34:23.053

@soren.enemaerke 做出此回复是为了发布正确的代码，因为您答案的评论部分会使其无法阅读。我在解决方案中遇到的唯一问题是触发`PropertyChanged`事件的特定元素丢失了，您无法在`PropertyChanged`通话中知道。

```
col.PropertyChanged += (s, e) => { Trace.WriteLine("Changed " + e.PropertyName) 
```

为了解决这个问题，我创建了一个新类`PropertyChangedEventArgsEx`并更改了`ContainedElementChanged`您类中的方法。

*新班级*

```
public class PropertyChangedEventArgsEx : PropertyChangedEventArgs
{
    public object Sender { get; private set; }

    public PropertyChangedEventArgsEx(string propertyName, object sender) 
        : base(propertyName)
    {
        this.Sender = sender;
    }
} 
```

*改变你的班级*

```
 private void ContainedElementChanged(object sender, PropertyChangedEventArgs e)
    {
        var ex = new PropertyChangedEventArgsEx(e.PropertyName, sender);
        OnPropertyChanged(ex);
    } 
```

在此之后，您可以通过强制转换来获取实际`Sender`元素`col.PropertyChanged += (s, e)``e``PropertyChangedEventArgsEx`

```
((INotifyPropertyChanged)col).PropertyChanged += (s, e) =>
        {
            var argsEx = (PropertyChangedEventArgsEx)e;
            Trace.WriteLine(argsEx.Sender.ToString());
        }; 
```

同样，您应该注意`s`这里是元素的集合，而不是触发事件的实际元素。因此类中的新`Sender`属性`PropertyChangedEventArgsEx`。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-04T21:52:35.917

Rxx 2.0 包含与此[转换运算](https://rxx.codeplex.com/SourceControl/latest#Main/Source/Rxx/System/Reactive/NotifyCollectionChangedExtensions.cs)[符](https://rxx.codeplex.com/SourceControl/latest#Main/Source/Rxx/System/Reactive/Linq/Observable2%20-%20PropertyChanges.cs)一起使用的运算符，可以轻松实现您的目标。`ObservableCollection<T>`

```
ObservableCollection<MyClass> collection = ...;

var changes = collection.AsCollectionNotifications<MyClass>();
var itemChanges = changes.PropertyChanges();
var deepItemChanges = changes.PropertyChanges(
  item => item.ChildItems.AsCollectionNotifications<MyChildClass>()); 
```

`MyClass`和支持以下属性更改通知模式`MyChildClass`：

*   [INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/System.ComponentModel.INotifyPropertyChanged(v=vs.110).aspx)
*   [属性]更改的事件模式（旧版，供组件模型使用）
*   WPF 依赖属性

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-07T22:10:06.360

最简单的方法就是做

```
using System.ComponentModel;
public class Example
{
    BindingList<Foo> _collection;

    public Example()
    {
        _collection = new BindingList<Foo>();
        _collection.ListChanged += Collection_ListChanged;
    }

    void Collection_ListChanged(object sender, ListChangedEventArgs e)
    {
        MessageBox.Show(e.ListChangedType.ToString());
    }

} 
```

.net sence 2.0 中的[BindingList](https://msdn.microsoft.com/en-us/library/ms132742(v=vs.110).aspx)类。每当集合中的项目触发时，它都会触发它的`ListChanged`事件`INotifyPropertyChanged`。

# c - 你如何使用 Ruby/DL？这是正确的吗？

> ID：269080
> 
> 赞同：3
> 
> 时间：2008-11-06T15:21:04.747
> 
> 标签：c, ruby, interface, rspec, rubydl

我正在尝试编写 RSPEC（ruby 风格的 BDD）和 Windows 应用程序之间的接口。应用程序本身是用一种晦涩难懂的语言编写的，但它有一个 C API 来提供访问权限。我已经使用 Ruby/DL，但即使是最基本的 DLL 方法调用也很难工作。这是我目前在一个名为 gt4r.rb 的文件中所拥有的：

```
require 'dl/import'

module Gt4r
  extend DL::Importable
  dlload 'c:\\gtdev\\r321\\bin\\gtvapi'

  # GTD initialization/termination functions
  extern 'int GTD_init(char *[], char *, char *)'
  extern 'int GTD_initialize(char *, char *, char *)'
  extern 'int GTD_done(void)'
  extern 'int GTD_get_error_message(int, char **)'
end 
```

到目前为止，我的阅读表明这就是我所需要的，所以我写了一个 RSPEC 示例：

```
require 'gt4r'

@@test_environment = "INCLUDE=C:\\graphtalk\\env\\aiadev\\config\\aiadev.ini"
@@normal_user = "BMCHARGUE"

describe Gt4r do
  it 'initializes' do
      rv = Gt4r.gTD_initialize @@normal_user, @@normal_user, @@test_environment
      rv.should == 0
  end
end 
```

而运行时...

```
C:\code\GraphTalk>spec -fs -rgt4r gt4r_spec.rb

Gt4r
- initializes (FAILED - 1)

1)
'Gt4r initializes' FAILED
expected: 0,
     got: 13 (using ==)
./gt4r_spec.rb:9:

Finished in 0.031 seconds

1 example, 1 failure 
```

返回值 (13) 是一个实际的返回代码，表示错误，但是当我尝试将 gTD_get_error_message 调用添加到我的 RSPEC 时，我无法让参数正常工作。

我是否朝着正确的方向前进，任何人都可以指出我可以尝试的下一件事吗？

谢谢，布雷特

* * *

对此问题的跟进，显示了当我尝试从目标库中获取错误消息时失败的部分：

```
require 'gt4r'

@@test_environment = "INCLUDE=C:\\graphtalk\\env\\aiadev\\config\\aiadev.ini"
@@normal_user = "BMCHARGUE"

describe Gt4r do
  it 'initializes' do
      rv = Gt4r.gTD_initialize @@normal_user, @@normal_user, @@test_environment
      Gt4r.gTD_get_error_message rv, @msg
      @msg.should == ""
      rv.should == 0
  end
end 
```

我希望在@msg 中返回错误消息，但是运行时我得到以下信息：

```
Gt4r
(eval):5: [BUG] Segmentation fault
ruby 1.8.6 (2008-08-11) [i386-mswin32]

This application has requested the Runtime to terminate it in an unusual way.
Please contact the application's support team for more information. 
```

如果我使用符号 (:msg) 来代替：

```
C:\code\GraphTalk\gt4r_dl>spec -fs -rgt4r gt4r_spec.rb

Gt4r
- initializes (ERROR - 1)

1)
NoMethodError in 'Gt4r initializes'
undefined method `to_ptr' for :msg:Symbol
(eval):5:in `call'
(eval):5:in `gTD_get_error_message'
./gt4r_spec.rb:9:

Finished in 0.046 seconds

1 example, 1 failure 
```

显然我错过了一些关于在 ruby​​ 和 C 之间传递参数的东西，但是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T17:59:28.093

普遍的共识是您希望尽可能避免深度学习。（英文）文档非常粗略，界面很难用于除琐碎示例之外的任何内容。

Ruby 原生 C 接口更容易编程。或者您可以使用 FFI，它填补了与 DL 类似的利基，最初来自 rubinius 项目，最近被移植到“普通”ruby。它有一个更好的界面，使用起来也不会那么痛苦：

[http://blog.headius.com/2008/10/ffi-for-ruby-now-available.html](http://blog.headius.com/2008/10/ffi-for-ruby-now-available.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T18:03:51.627

> 返回值 (13) 是一个实际的返回代码，表示错误，但是当我尝试将 gTD_get_error_message 调用添加到我的 RSPEC 时，我无法让参数正常工作。

它可能有助于发布错误而不是有效的代码:)

基本上，一旦你开始不得不像 (int, char **) 那样处理指针，事情就会变得丑陋。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-22T08:15:50.367

您需要为要写入的 msg 分配数据指针，因为否则 C 将无处可写错误消息。使用 DL.mallo。

# c++ - 模板类中是否可以有模板类？

> ID：269081
> 
> 赞同：1
> 
> 时间：2008-11-06T15:21:20.270
> 
> 标签：c++, oop, visual-c++, templates

```
template <class M, class A> class C { std::list<M> m_List; ... } 
```

上面的代码可以吗？我希望能够做类似的事情。

为什么我问的是我收到以下错误：

```
Error 1 error C2079: 'std::_List_nod<_Ty,_Alloc>::_Node::_Myval' uses undefined class 'M'   C:\Program Files\Microsoft Visual Studio 9.0\VC\include\list    41 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T15:51:23.577

我的猜测：您在某处转发声明的类 M，并且仅在模板实例化之后才完全声明它。

我的提示：给你的正式模板参数一个与实际参数不同的名称。（即M级）

```
// template definition file
#include <list>

template< class aM, class aT >
class C {
    std::list<M> m_List;
    ...
}; 
```

错误的前向声明示例，导致上述错误：

```
// bad template usage file causing the aforementioned error
class M;
...
C<M,OtherClass> c; // this would result in your error

class M { double data; }; 
```

正确声明的示例，不会导致错误：

```
// better template usage file
class M { double data; }; // or #include the class header
...

C<M,OtherClass> c; // this would have to compile 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T15:24:03.990

是的。这是很常见的。

正如 xtofl 所提到的，参数的前向声明会在模板实例化时导致问题，这看起来就像错误消息所暗示的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T15:41:25.673

这是一个非常常见的用法。

您应该确保在创建类 C 的第一个实例之前完全声明了指定为模板参数的类 M。也许您缺少头文件包含，或者这是一个命名空间问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T15:35:55.810

是的。

STL 经常将它用于分配器和迭代器之类的东西。

看起来您遇到了其他问题。也许您错过了在...中首次声明的离线方法主体定义中的模板，您省略了？

# asp.net - 验证 ASP.net 成员身份中的用户 ID、忘记问题和忘记答案

> ID：269084
> 
> 赞同：0
> 
> 时间：2008-11-06T15:21:52.467
> 
> 标签：asp.net

我有一个带有用户 ID 和问答的 ASP.net 页面

我需要验证用户名，答案是否正确

我不需要启用密码检索

我的密码是散列的

怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T15:24:42.663

您使用的是 ASP.NET 成员资格提供程序吗？如果是这样，那么系统将为您进行身份验证，您只需在您网站的每个文件夹的 web.config 中设置适当的权限。只需确保包含登录表单、注册表单等的文件夹（匿名用户可以访问的所有内容，是的，登录需要这些内容，因为他们在实际登录之前是匿名的）设置为允许匿名用户。

您不能使用散列密码检索密码，因为它是一种陷门（即一种方式）加密并且无法逆转。散列密码的唯一选择是发布新密码。

# .net - .NET 运行时 2.0 服务中的错误

> ID：269090
> 
> 赞同：0
> 
> 时间：2008-11-06T15:23:32.463
> 
> 标签：.net, asp.net, .net-3.5, .net-2.0, 64-bit

我们有一个写入数据库的自定义服务（SQL 2005）。这是一个完整的 64 位环境（DB、.NET 服务）。每天早上，当我们的数据量激增时，我们的一台服务器就会崩溃。在另一台服务器上，我们运行良好。我能够注意到两台机器之间的唯一区别是遇到崩溃的那台还安装了 .NET 3.5。

有没有其他人见过这种行为？

这是今天崩溃的事件日志条目：

事件类型：错误
事件源：.NET 运行时 2.0 错误报告
事件类别：无
事件 ID：1000
日期：2008 年 11 月 6 日
时间：09 :35:03
用户：N/A
计算机：RDDARWIN02
描述：
错误应用程序 servicehost.exe ，版本 2.0.6.6，标记 48eb7b7a，故障模块 kernel32.dll，版本 5.2.3790.4062，标记 462643a7，调试？0，故障地址0x0000000000027d8d。

[有关详细信息，请参阅http://go.microsoft.com/fwlink/events.asp](http://go.microsoft.com/fwlink)上的帮助和支持中心 。
数据：
0000：41 00 70 00 70 00 6c 00 应用
0008：69 00 63 00 61 00 74 00 icat
0010：69 00 6f 00 6e 00 20 00 离子。
0018：46 00 61 00 69 00 6c 00 失败
0020：75 00 72 00 65 00 20 00 肯定。
0028: 20 00 73 00 65 00 72 00 .ser
0030: 76 00 69 00 63 00 65 00 副
0038: 68 00 6f 00 73 00 74 00 主机
0040: 2e 00 65 00 78 00 65 8
: 20.exe 00 32 00 2e 00 30 00 .2...0。
0050: 2e 00 36 00 2e 00 36 00 ..6...6。
0058：20 00 34 00 38 00 65 00 .4.8.e。
0060：62 00 37 00 62 00 37 00 b.7.b.7。
0068：61 00 20 00 69 00 6e 00 一个。.in
0070：20 00 6b 00 65 00 72 00 .ker
0078：6e 00 65 00 6c 00 33 00 nel3。
0080：32 00 2e 00 64 00 6c 00 2...dl
0088：6c 00 20 00 35 00 2e 00 升。.5...
0090：32 00 2e 00 33 00 37 00 2...3.7。
0098: 39 00 30 00 2e 00 34 00 9.0...4。
00a0：30 00 36 00 32 00 20 00 0.6.2。.
00a8：34 00 36 00 32 00 36 00 4.6.2.6。
00b0：34 00 33 00 61 00 37 00 4.3.a.7。
00b8：20 00 66 00 44 00 65 00 .fDe
00c0：62 00 75 00 67 00 20 00 错误。
00c8：30 00 20 00 61 00 74 00
0..at 00d0：20 00 6f 00 66 00 66
00.off 00d8：73 00 65 00 74 00 20 00 设置。
00e0：30 00 30 00 30 00 30 00 0.0.0.0。
00e8：30 00 30 00 30 00 30 00 0.0.0.0。
00f0：30 00 30 00 30 00 32 00 0.0.0.2。
00f8：37 00 64 00 38 00 64 00 7.d.8.d。
0100: 0d 00 0a 00 ....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T17:05:10.667

您是否尝试在崩溃之前将调试器附加到正在运行的代码？也许你可以找出问题出在哪里。

您还可以使用 adplus 获取进程的转储，然后在 windbg 中使用该转储来帮助追踪问题。像这样的东西应该给你你正在寻找的转储文件：

adplus -crash -pn servicehost.exe

# sql - 我如何记住在 CONNECT BY 查询中 PRIOR 应该走哪条路

> ID：269093
> 
> 赞同：6
> 
> 时间：2008-11-06T15:24:03.010
> 
> 标签：sql, oracle

我的记性很糟糕。每当我在 Oracle 中执行 CONNECT BY 查询时——我的意思是*每次*——我都必须认真思考，通常通过反复试验来确定 PRIOR 应该使用哪个参数。

我不知道为什么我不记得了——但我不记得了。

有没有人有一个方便的记忆助记符所以我总是记得？

例如：

**要从一个节点向下**走一棵树 - 显然我必须查一下 :) - 你可以执行以下操作：

```
select
    *
from
    node
connect by
    prior node_id = parent_node_id
start with
    node_id = 1 
```

所以 - 我从`node_id`1 开始（分支的顶部），查询查找`parent_node_id`= 1 的所有节点，然后向下迭代到树的底部。

要**上**树，先验在父节点上：

```
select
    *
from
    node
connect by
    node_id = prior parent_node_id
start with
    node_id = 10 
```

因此，从某个分支（`node_id = 10`在本例中）开始，Oracle 首先获取与 10`parent_node_id`相同的所有节点`node_id`。

**编辑**：我**仍然**犯了这个错误，所以我想我会添加一个澄清的编辑来扩展接受的答案 - 这就是我现在记得的方式：

```
select
    *
from
    node
connect by
    prior node_id = parent_node_id
start with
    node_id = 1 
```

我现在读的这个 SQL 的“英文”版本是……

> 在 NODE 中，从 所在的行开始，`node_id = 1`选择的下一行与其上（前）行`parent_node_id` 相等。`node_id`

**编辑**：Quassnoi 提出了一个很好的观点——你编写 SQL 的顺序让事情变得容易多了。

```
select
    *
from
    node
start with
    node_id = 1
connect by
    parent_node_id = prior node_id 
```

这对我来说感觉更清楚了——“开始于”给出了选择的第一行，而“连接方式”给出了下一行——在这种情况下，node_id = 1 的孩子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-16T00:18:47.570

我总是尝试将`JOIN`'s 中的表达式按以下顺序排列：

```
joined.column = leading.column 
```

这个查询：

```
SELECT  t.value, d.name
FROM    transactions t
JOIN
        dimensions d
ON      d.id = t.dimension 
```

可以被视为“对于每个事务，找到对应的维度名称”，或者“对于每个维度，查找所有对应的事务值”。

因此，如果我搜索给定的交易，我将表达式按以下顺序排列：

```
SELECT  t.value, d.name
FROM    transactions t
JOIN
        dimensions d
ON      d.id = t.dimension
WHERE   t.id = :myid 
```

，如果我搜索一个维度，那么：

```
SELECT  t.value, d.name
FROM    dimensions d
JOIN
        transactions t
ON      t.dimension = d.id
WHERE   d.id = :otherid 
```

前一个查询很可能首先在 上使用索引扫描`(t.id)`，然后在 ( `d.id`) 上，而后一个查询将首先在 上使用索引扫描`(d.id)`，然后在 上`(t.dimension)`，您可以很容易地在查询本身中看到它：搜索的字段在左侧。

驱动表和驱动表在 a 中可能不那么明显`JOIN`，但它就像`CONNECT BY`查询的钟声一样清晰：`PRIOR`行是驱动的，非`PRIOR`驱动的。

这就是为什么这个查询：

```
SELECT  *
FROM    hierarchy
START WITH
        id = :root
CONNECT BY
        parent = PRIOR id 
```

意思是“找到所有`parent`给定的行`id`”。此查询构建层次结构。

这可以这样处理：

```
connect_by(row) {
  add_to_rowset(row);

  /* parent = PRIOR id */
  /* PRIOR id is an rvalue */
  index_on_parent.searchKey = row->id;

  foreach child_row in index_on_parent.search {
    connect_by(child_row);
  }
} 
```

这个查询：

```
SELECT  *
FROM    hierarchy
START WITH
        id = :leaf
CONNECT BY
        id = PRIOR parent 
```

意思是“找到`id`给定的行`parent`”。这个查询构建了一个祖先链。

**始终放在`PRIOR`表达式的正确部分。**

**`PRIOR column`将搜索所有行视为一个常数。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T15:29:06.273

考虑选择记录的顺序：每条记录上的链接返回列必须与所选的 PRIOR 记录上的链接转发列匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-06T13:51:56.180

每次都难以可视化的部分原因是因为有时数据被建模为`id`+ `child_id`，有时它被建模为`id`+ `parent_id`。根据数据建模的方式，您必须将`PRIOR`关键字放在相反的一侧。

我发现的诀窍是始终通过您尝试构建的树的叶节点来观察世界。

所以（作为叶子节点）当我查找时，我看到了我的父节点，我也可以将其称为`PRIOR`节点。因此，我`ID`的和他的一样`CHILD_ID`。所以在这种情况下`PRIOR child_id = id`。

当数据以相反的方式建模时（即当我持有我父母的身份证而不是他持有我的身份证时）， my`parent_id`的值与 his 相同`id`。因此在这种情况下`PRIOR id = parent_id`。

# wcf - 创建具有多个命名空间的 WCF 消息

> ID：269096
> 
> 赞同：0
> 
> 时间：2008-11-06T15:24:27.780
> 
> 标签：wcf, datacontract

我正在尝试创建一个 WSTransfer 实现（我意识到 Roman Kiss 已经为 WCF 编写了一个 - 但它实际上并不符合规范）

由于 WSTransfer 是松散耦合的，我最终放弃了服务联系人的数据契约；所以每个创建消息看起来像消息创建（消息请求）。

这很好用，一切都很可爱，直到需要回击的时候。

我遇到的问题是构建 WSTransfer 响应的方式。以 create 为例，响应看起来像

```
<wxf:ResourceCreated>
  <wsa:Address>....</wsa:Address>
  <wsa:ReferenceProperties>
    <xxx:MyID>....</xxx:MyId>
  </wsa:ReferenceProperties>
</wxf:ResourceCreated> 
```

如您所见，响应消息中有 3 个不同的 XML 命名空间。

现在，参与其中就很容易了；你可以（即使你没有公开它），创建一个数据合约并设置值并回火

```
Message response = Message.CreateMessage(request.Version, 
            "http://schemas.xmlsoap.org/ws/2004/09/transfer/CreateResponse",
            resourceCreatedMessage); 
```

但是，在为响应中的子元素设置不同的命名空间时会出现问题；看来 WCF 的数据合同不这样做。即使使用

```
[MessageBodyMember(Namespace="....")] 
```

在响应类中的各个元素上似乎没有进行任何更改，所有内容都成为为合同类指定的命名空间的一部分。

那么如何将不同的命名空间应用于 WCF 消息中的各个元素？是通过合同，还是通过其他一些诡计多端的游戏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T15:38:32.667

在这种情况下，当您需要精确控制 XML 输出时，您应该使用 XmlSerializer 而不是 DataContract 或 MessageContract 序列化。以下是有关如何执行此操作的更多信息：

[http://msdn.microsoft.com/en-us/library/ms733901.aspx](http://msdn.microsoft.com/en-us/library/ms733901.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T16:42:00.700

所以跟进jezell的回答；手动创建消息时使用 XmlSerialization 的问题是根的子元素的元素名称被破坏。发生这种情况是因为尽管在您手动创建消息时将操作合同标记为 [XmlSerializerFormat]，但仍使用了 DataContractSerializer。

您不能将 XmlSerializer 传递给 Message.CreateMessage()，因为它需要一个 XmlObjectSerializer，而 XmlSerializer 不是。

所以答案似乎是为 XmlSerializer 编写一个包装类，它以 XmlObjectSerializer 作为其基类（[这是一个示例](http://blogs.msdn.com/andrewarnottms/archive/2008/01/18/using-the-xmlserializer-as-an-xmlobjectserializer-with-wcf.aspx)）并将其传入；以及您的消息保存类。

不幸的是，在 XML 中设置前缀还不够聪明。所以你最终会收到类似的消息

```
<ResourceCreated xmlns="http://schemas.xmlsoap.org/ws/2004/09/transfer" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                 xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Address xmlns="http://schemas.xmlsoap.org/ws/2004/08/addressing/">http://localhost:8731/Design_Time_Addresses/AddTests/WSTransfer/</Address>
  <ReferenceType xmlns="http://schemas.xmlsoap.org/ws/2004/08/addressing/"></ReferenceType> 
```

但这都是等价的。

# c# - C# 读回加密的密码

> ID：269101
> 
> 赞同：5
> 
> 时间：2008-11-06T15:25:22.383
> 
> 标签：c#, hash

我正在使用下面的代码将密码保存到注册表，如何将其转换回来？下面的代码不是我的，但它加密得很好。

谢谢

```
using System.Security.Cryptography;

public static string EncodePasswordToBase64(string password)
{  byte[] bytes   = Encoding.Unicode.GetBytes(password);
   byte[] dst     = new byte[bytes.Length];
   byte[] inArray = HashAlgorithm.Create("SHA1").ComputeHash(dst);
   return Convert.ToBase64String(inArray);
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-11-06T15:28:57.087

SHA1 是*哈希*算法，不是加密算法。散列算法是一种单向函数，它将数据转换为该数据的散列，但无法从散列中取回原始数据。加密算法是将数据转换为加密数据的双向函数，然后可以将加密数据转换回原始数据。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-06T15:54:03.760

要安全地存储密码以便回读，请使用[ProtectedData](http://msdn.microsoft.com/en-us/library/system.security.cryptography.protecteddata.aspx)类。

```
public static string ProtectPassword(string password)
{
    byte[] bytes = Encoding.Unicode.GetBytes(password);
    byte[] protectedPassword = ProtectedData.Protect(bytes, null, DataProtectionScope.CurrentUser);
    return Convert.ToBase64String(protectedPassword);
}

public static string UnprotectPassword(string protectedPassword)
{
    byte[] bytes = Convert.FromBase64String(protectedPassword);
    byte[] password = ProtectedData.Unprotect(bytes, null, DataProtectionScope.CurrentUser);
    return Encoding.Unicode.GetString(password);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-06T15:28:18.197

将用户输入的任何内容作为密码来访问系统，以相同的方式对其进行加密，然后比较加密的值，这是正常的方法。我很确定 SHA1 是一种陷门加密，即无法回溯。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-06T15:29:20.050

你没有。

SHA1 是哈希，而不是加密。这是一种单向操作；转换回来是不可能的。

（好吧，严格来说这不是真的；如果你有一个可能的 SHA1 值和纯文本值的表，一个彩虹表，那么你可能很幸运）

此外，您应该对哈希值加盐，因为您现在很容易受到彩虹表攻击。杰夫在他的博客上谈得[更多](http://www.codinghorror.com/blog/archives/000949.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T15:29:39.627

好的，所以我知道这不是在回答您的具体问题，但是您为什么要将其转换回来？

如果要进行比较以提供身份验证，标准方法是加密此文本 ALSO，并将存储的密码与提供的密码进行比较。

这更安全，因为这意味着原始密码永远不需要解密。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T15:28:20.147

我认为使用哈希的要点之一是它们不能被计算回来。

正如其他人所说，根据用户密码计算哈希并与存储的哈希值进行比较。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-06T19:02:44.207

为了使用 System.Security.Cryptography.ProtectedData 类，您必须在项目中添加对 System.Security 的引用。

（鼠标右键单击 References 文件夹，选择“Add Reference...”，在 .NET 选项卡上找到 System.Security）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T15:37:35.150

嗯，只是好奇，但这不会为所有相同长度的密码返回相同的哈希值吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T16:44:44.390

You want to use encryption not hashing. SHA is fine but use the encryption methods for it. The problem with encryption is always where to put the key for it. You didn't mention whether this was a workstation or server you were doing this on. On a server, I find it better to just use ACL's to restrict access to the reg key. Admins can usually access the encryption key anyway...you have to have some trust somewhere. On a workstation then you can go with encryption and store the key in code or use a certificate and restrict access to it at least in a corp environment...not for sale software).

You can use the ProtectedData class but be aware that it uses user profiles for its key usage and as such you have to make sure you are impersonating the user who has the profile with the key you need. This may or may not be trivial and may or may not cause headaches and security issues.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T16:01:25.820

使用上面您自己的代码片段，您想要做的是在用户最初选择密码时调用该方法 - 但在密码字符串中的某处（通常在开头或结尾）添加称为[盐的密码。](http://en.wikipedia.org/wiki/Salt_(cryptography))然后，当用户稍后尝试进行身份验证时，他们输入他们的密码，您通过相同的方法运行该密码和散列，如果两个散列相等，则密码相等且有效的统计上极好的机会。

话虽这么说，SHA1 已知有弱点，您应该选择更强大的算法。如果你想留在SHA家族，SHA512还是不错的。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-30T02:29:15.520

我注意到最近添加了 XMLEncryptedData 类。对于将数据加密到 XML 文件，XMLEncryptedData 方法是否比 DPAPI 方法更可取？

# wpf - 从 WPF 中的 UserControl 继承

> ID：269106
> 
> 赞同：34
> 
> 时间：2008-11-06T15:26:35.437
> 
> 标签：wpf, inheritance, user-controls

我对 WPF 相当陌生，并且在从用户控件继承时遇到问题。

我创建了一个用户控件，现在我需要从该控件继承并添加更多功能。

以前有人做过这种事情吗？任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-06T15:32:48.543

好吧..你创建你的基本控制

```
public abstract class BaseUserControl : UserControl{...} 
```

然后在 XAML 文件中：

```
<Controls:BaseUserControl x:Class="Termo.Win.Controls.ChildControl"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:Controls="clr-namespace:Namespace.Of.Your.BaseControl"> 
```

这应该有效。

**编辑：**嗯.. 当您有一个没有 XAML 的基本控件然后从它继承时，此示例很有用。反过来（从带有 Xaml 的基本控件） - 我不确定你可以如何去做。

**EDIT2：**显然从[这篇文章+评论](http://michaelsync.net/2008/03/24/silverlight-2-beta1-user-control-inheritance)我认为你想要的可能是不可能的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-11-07T06:56:50.817

AFAIK你不能继承xaml，你只能继承后面的代码。

我们最近在我们的项目中遇到了同样的问题。我们最终解决问题的方法是创建一个用户控件并将其添加到“子”用户控件。

如果这不起作用/帮助看看这个： http: [//geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx](http://geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx) [1](http://geekswithblogs.net/lbugnion/archive/2007/03/02/107747.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-23T18:06:13.740

我可能有一些解决方案：组合而不是继承 - 我想出了控制，它具有可通过数据绑定从外部分配的“内容槽”，请查看我的[SO 线程](https://stackoverflow.com/questions/1029955/wpf-template-or-usercontrol-with-2-or-more-contentpresenters-to-present-conte/)。

使用示例：

```
<UserControl ... >

    <!-- My wrapping XAML -->
        <Common:DialogControl>
                <Common:DialogControl.Heading>
                        <!-- Slot for a string -->
                </Common:DialogControl.Heading>
                <Common:DialogControl.Control>
                        <!-- Concrete dialog's content goes here -->
                </Common:DialogControl.Control>
                <Common:DialogControl.Buttons>
                        <!-- Concrete dialog's buttons go here -->
                </Common:DialogControl.Buttons>
        </Common:DialogControl>
    <!-- /My wrapping XAML -->

</UserControl> 
```

与代码隐藏中的一些处理代码一起，它将成为对话窗口的一个很好的基础组件。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-10-20T15:19:29.513

您不能继承它自己的 xaml 代码。但是，创建代码隐藏的抽象类将允许您从派生类对象在代码中进行编辑。

Xaml 代码：{ Window1.xaml }

```
<Window 
x:Class="WPFSamples.Window1"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
Height="auto" Width="256" Title="WPF Sameples">
  <Grid>
    <Button x:Name="Button1" VerticalAlignment="Center" HorizontalAlignment="Center" Content="Click Me"/>
  </Grid>
</Window> 
```

代码隐藏：{ Window1.xaml.cs }

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WPFSamples
{
    /// <summary>
    /// Interaction logic for Window1.xaml
    /// </summary>
    public abstract partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }
    }
} 
```

派生类：{ DisabledButtonWindow.cs }

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace WPFSamples
{
    public sealed class DisabledButtonWindow : Window1
    {
        public DisabledButtonWindow()
        {
            Button1.IsEnabled = false;
        }
    }
} 
```

虽然您不能从它自己的 wpf 源继承，但您可以将此“Window1”控件用作所有其他派生控件的模板。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-30T13:59:38.480

您可以通过使用`delegate`.

本质上，您需要创建一个`YourInterface`包含所需功能的接口 ( )，然后让用户控件和您的类都实现该接口。

接下来，确保用户控件具有对类型对象的引用`IYourInterface`，以便当您的用户控件尝试调用 的方法时`Interface`，它会调用您的类的方法。

因为用户控件和类都实现了相同的接口，所以它们可以被视为同一种对象——这意味着您可以将它们都放入类型为对象的集合中`IYourInterface`。这应该给你你想要的行为。

在 ASP.NET 中，我经常使用这种技术，方法是让我的类从`abstract class`祖先那里继承。我不明白为什么 WPF 不支持这个。:(

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-25T17:31:15.457

我认为您可以这样做，但您必须重新定义您在子类的 xaml 中引用的任何函数以及可能的其他一些内容。

IE 如果您在基类 xaml 中订阅了按钮单击事件，则需要覆盖子类中的按钮单击并调用基类按钮单击事件。

不能百分百确定细节，因为这是我的同事代码，但我认为这将为希望在未来实现此功能的任何人提供一个开始。

# apache-flex - 在 Function 中访问 savedThis 属性

> ID：269110
> 
> 赞同：5
> 
> 时间：2008-11-06T15:27:11.193
> 
> 标签：apache-flex, flash, actionscript-3

当我在 Flash 调试器中并保存了一些回调时，我可以看到函数有一个名为的属性，该属性`savedThis`对于了解回调的来源非常有用。

我正在尝试从代码中访问该属性，但由于某种原因我不能。

`callback.savedThis`抛出一个错误，因为它找不到该属性，可能是因为它是私有的。

所以我尝试向 Function 类添加一个方法，让我可以访问它：

```
Function.prototype.getSavedThis = function()
{
    return this.savedThis
} 
```

但它给了我关于找不到该属性的相同错误，即使我可以在调试器中看到它。有没有办法访问它？

**注意**：我不打算在生产代码中使用它，我正在制作一些类来帮助我通过自动化一些数据收集来帮助我进行调试，并且无需向每个保存的回调添加代码就可以获取这些信息非常有用通知这个对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-16T17:18:48.807

*您可以使用“ arguments.callee* ”属性 获取对调用函数的引用。
例如：

* * *

```
bar( arguments.callee );
public function bar( caller:Function ) : void { trace( caller ); } 
```

# apache-flex - 在 Flex 项目中放置原型代码的最佳位置

> ID：269119
> 
> 赞同：0
> 
> 时间：2008-11-06T15:28:47.803
> 
> 标签：apache-flex, actionscript, cairngorm

我正在制作一个 Flex 项目，使用 Cairngorm 库，并尝试将代码保持在良好的 MVC 结构中。我刚刚添加了一些代码以将原型函数添加到内置类（我将方法“包含”添加到 Array），我想知道您认为将此代码放在我的项目中何处的最佳实践结构体？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T14:45:45.023

老实说，最好对 Array 进行子类化或组合，而不是修改其原型。修改原型可能会导致维护阶段的混乱，这是使用像 Cairngorm 这样的框架的主要原因之一。

如果创建一个新类不适合您，那么还可以考虑创建一个实用程序类。

Flex 实际上已经有一个名为 ArrayUtil 的实用程序类和一个可以执行您想要的功能的函数：`ArrayUtil.getItemIndex`.

```
var obj1:Object = new Object();
var obj2:Object = new Object();
var myArray : Array = [obj1, obj2];
ArrayUtil.getItemIndex(obj1, myArray);    // returns 0
ArrayUtil.getItemIndex(obj2, myArray);    // returns 1
ArrayUtil.getItemIndex(obj3, myArray);    // returns -1 
```

[教程](http://livedocs.adobe.com/flex/3/langref/mx/utils/ArrayUtil.html)

# c# - 我转换为 Short 的二进制数据是否有效？

> ID：269124
> 
> 赞同：1
> 
> 时间：2008-11-06T15:29:14.887
> 
> 标签：c#, binary, bit-shift

我正在读取由一台设备生成的二进制日志文件。

我有一个字节[]中的数据。

如果我需要读取两个字节来创建一个短的，我可以这样做：

```
short value = (short)(byte[1] << 8);
value += byte[2]; 
```

现在我知道该值对于有效数据是正确的。

我怎么知道文件是否被弄乱了，让我们说值 FF FF 在字节数组的这两个地方？

当我查看将 FF FF 转换为 short 的结果值时，我得到 -1。

这是 FF FF 的正常值吗？还是计算机刚刚遇到某种短路并使用无效数据翻转？

出于我的目的，所有这些数字都将是积极的。如果 FF FF 实际上是一个短的 -1，那么我只需要验证我的所有结果都是正数。

谢谢你，
基思

*顺便说一句，我也在阅读其他数字数据类型。我会在这里展示它们只是因为。Read 函数是从 byte[] 读取的基本部分。所有其他数据类型的读取都使用基本的 Read() 函数。*

```
 public byte Read()
    {
        //advance position and then return byte at position 

        byte returnValue;
        if (_CurrentPosition < _count - 1)
        {
            returnValue= _array[_offset + ++_CurrentPosition];
            return returnValue;
        }
        else
            throw new System.IO.EndOfStreamException
                   ("Cannot Read Array, at end of stream."); 
    }

    public float ReadFloat()
    {
        byte[] floatTemp = new byte[4];
        for (int i = 3; i >= 0; i--)
        {
            floatTemp[i] = Read();
        }

        float returnValue = System.BitConverter.ToSingle
            (floatTemp, 0);

        if (float.IsNaN(returnValue))
        {
            throw new Execption("Not a Number");    
        }
        return returnValue;
    }

    public short ReadInt16()
    {
        short returnValue = (short)(Read() << 8);
        returnValue += Read();
        return returnValue;
    }

    public int ReadInt32()
    {
        int returnValue = Read() << 24;
        returnValue += Read() << 16;
        returnValue += Read() << 8;
        returnValue += Read();
        return returnValue;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T15:37:58.830

`0xffff`（所有位等于 1）对于有符号的短裤是 -1，是的。阅读[Two 的补码](http://en.wikipedia.org/wiki/Two's_complement)以了解有关详细信息的更多信息。您可以切换到更大的数据类型，或者（按照 Grzenio 的建议）只使用无符号类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T15:48:49.730

好吧，你似乎已经找到`BitConverter`了单身。现在让我们看看我们是否可以将它用于其他所有事情......

```
MemoryStream mem = new MemoryStream(_array);

float ReadFloat(Stream str)
{
   byte[] bytes = str.Read(out bytes, 0, 4);
   return BitConverter.ToSingle(bytes, 0)
}

public int ReadInt32(Stream str)
{
   byte[] bytes = str.Read(out bytes, 0, 4);
   return BitConverter.ToInt32(bytes, 0)
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T15:35:39.850

您是否尝试使用 ushort（无符号短）？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T15:59:03.563

[我认为使用System.BitConverter](http://msdn.microsoft.com/en-us/library/system.bitconverter_members.aspx)类会更好。

专门用于[缩短 ToInt16](http://msdn.microsoft.com/en-us/library/system.bitconverter.toint16.aspx)方法。

你没有在你的问题中提到它，但你也应该确保你知道硬件设备正在写入它的数据的字节序。从你的例子中看起来浮点数是小端序，但整数是大端序? 我怀疑硬件设备会在其二进制数据输出中混合字节序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T16:48:04.087

是的 0xFFFF 是 -1 对于有符号的短。

另外，你为什么不使用这个[`BinaryReader`类](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T15:37:01.563

“short”的 FFFF 值为 -1，但“unsigned short”的 FFFF 值为 65536。

在这种情况下，如果您确定所有值都是正数，则应确保使用的是无符号短路。

# windows - Atl 服务未注册

> ID：269133
> 
> 赞同：3
> 
> 时间：2008-11-06T15:32:55.067
> 
> 标签：windows, service, atl

我正在尝试使用注册 atl 服务

ExeName.exe /服务

如此处所述：http: [//msdn.microsoft.com/en-us/library/74y2334x (VS.80).aspx](http://msdn.microsoft.com/en-us/library/74y2334x(VS.80).aspx)

但是，这样做之后，它并没有出现在我的服务控制面板中（我通过在 vista 的开始框中键入 Services 进入的那个）。

我试图挖掘 atl 代码以查看它处理 /service 开关的位置，但找不到它，尽管我可以找到处理 /RegServer 和 /UnregServer 的代码

这曾经有效，我以前以某种方式设法注册了此服务。但是，现在我已经移动了它的位置，并且无法再次注册它。当我运行 ExeName.exe /service 时，如果我先执行 /RegServer，它会作为本地服务器启动，但我希望它作为服务安装。

我是否遗漏了什么，您知道 /service 开关的处理在哪里完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-08T00:09:39.487

使用开箱即用的 CAtlServiceModule::Install 方法运行，您必须在每个参数上使用正确的大写字母 - “/Service”、“/UnregServer”等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T15:58:00.163

在黑暗中射击：你在 Vista 上运行吗？如果是这样，请确保您以完整的管理员权限运行。否则，您可能正在通过虚拟化注册此应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T00:44:21.243

与 JaredPar 一样，尝试使用具有完全管理员权限的 Power Shell 命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T16:29:31.613

检查您是否不小心在 atlbase.h 中定义的类 CAtlServiceModuleT 中的函数 ParseCommandLine 的名称中键入了某些字符

如果你这样做了，这个函数的一个版本也在基类中，这意味着一切都会很好地编译，你可能需要一整天的时间才能发现这个愚蠢的错误！

;-)

# c++ - 您如何为交叉编译的代码构建单元测试？

> ID：269135
> 
> 赞同：-1
> 
> 时间：2008-11-06T15:33:04.457
> 
> 标签：c++, unit-testing

我的新项目的目标是嵌入式 ARM 处理器。我有一个构建系统，它使用在 Ubuntu linux 机器上运行的交叉编译器。我喜欢尽可能多地使用单元测试，但我对如何进行此设置有点困惑。

我看不到如何在 ARM 设备本身上运行单元测试（如果我错了，请有人纠正我）。我认为我最好的选择是使用自己的本机编译器在构建机器上编译代码以进行单元测试。这种方法是否存在根本缺陷？在不同平台上进行单元测试是浪费时间吗？

我计划在构建机器上使用 CppUnit，使用本机编译器进行单元测试。然后，我将交叉编译 ARM 处理器的代码，并在目标设备本身上进行集成和系统测试。您将如何构建源代码和测试代码以防止它变成一团糟？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T15:52:59.223

对于嵌入式设备，这取决于您拥有的接口（硬件）。

例如，我处理的运动控制卡使用命令行界面。他们发布的 IDE 使用它作为与卡交互的主要方法。无论我使用的是 PCI、IDE、串行还是以太网，它的工作方式都是一样的。

他们为编程提供的 DLL 提供了对命令行界面的访问权限。所以我可以发送一个字符串，然后读回响应。所以我为我的单元测试所做的就是在我的开发机器上挂（或挂在）一张物理卡。我在上传软件后向它发送命令，阅读响应，如果它们是正确的，它就通过了测试。

我还有额外的硬件，一个黑盒子，如果你愿意的话，它可以模拟一台通常连接运动控制卡的机器。它有助于自动设置，但有一个手动阶段，因为我必须设置开关来模拟机器上的不同设置。

我通过使用数字 I/O 卡并将其输出馈送到运动控制卡的输入，反之亦然，从而实现了更高程度的自动化。

我发现对于大多数硬件，您必须拥有某种类型的模拟器硬件。

软件模拟器附带的罕见软件包例外。

我知道这可能并不理想，因为并非每个开发人员都可以在他们的办公桌上拥有其中一个。我的硬件模拟器，所以我可以把它交给当时在运动控制软件上工作的任何人。如果它不能便携，那么就可以使用专用的测试或硬件开发计算机。

最后，它归结为您的硬件细节以及制造商在软件和模拟器方面提供的支持。为了帮助您更多，您需要发布更多细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T19:24:33.163

在嵌入式行业的十多年里，我已经看到了很多方法。在我现在的公司：

*   我们的一款产品有足够的马力（和空间）在目标板上运行测试。它有点慢，我们不能把所有的蟒蛇都粘在我们想要的盒子上，但它运作良好。
*   我们的一个产品没有空间，所以我们在 x86 中编译所有我们可以使用的库（任何不依赖于硬件的东西）并在桌面上运行单元测试。它并不完美，但总比没有好。
*   我们的组件之一是在异国情调硬件上的超轻量级电源吝啬鬼，因此几乎不可能进行单元测试。如上所述，核心算法（DES 等）在 x86 上进行了测试，但大部分代码都必须作为一个整体进行现场测试。这需要大量的代码审查。

# oracle - Oracle - 并行模式更新技术……有吗？

> ID：269145
> 
> 赞同：3
> 
> 时间：2008-11-06T15:36:09.600
> 
> 标签：oracle

是否有任何技术可以让您并行更新生产模式？

目标是在将更新应用于生产中的模式时实现零停机时间。Weblogic 10 对其 Java EE 应用程序具有类似的功能，您可以在其中部署新版本的应用程序，新连接会转到新应用程序，而现有连接会继续连接到旧应用程序。当所有旧连接完成/超时时，旧应用程序将退役，新应用程序继续运行......零停机时间。

Oracle中有类似的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T22:26:09.100

是的。有在线重新定义包。

[DBMS_重新定义](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_redefi.htm#CBBJJAIF)

但我怀疑这会给您零停机时间，这并不能说明对模式的所有可能更改。这使您可以进行一些表更改。我认为您需要定义零以及您想要进行的更改的范围。通常，如果您更改数据库，您也必须更改您的客户端。如果您更改了数据库，客户端如何从旧的 proc 签名自动切换到新的 proc 签名 - 瞬间？

数据库不像应用程序那样工作。从 tableA 到 tableB 要么有一个 FK，要么没有......它不能不存在当前连接，并且仅以与您的应用程序相同的方式存在于新连接。数据库不一样。

话虽如此，有传言称 Oracle 正在开发包版本控制……因此您可以连接到包的特定版本以简化此类迁移。但同样......这适用于包，DBMS_redef 适用于表......但这不是您数据库的总和。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-01T19:45:11.287

Oracle release today 11gr2, it has edition-based redefinition: [http://download.oracle.com/docs/cd/E11882_01/server.112/e10881/chapter1.htm#NEWFTCH1](http://download.oracle.com/docs/cd/E11882_01/server.112/e10881/chapter1.htm#NEWFTCH1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T22:54:44.457

取决于您在“模式”中的意思或包括什么。如果您想添加或删除索引，可以“进行中”完成，尽管它需要一个可能会暂停活动一段时间的锁。在最新的 Oracle 版本中，它不需要在构建索引的整个时间内都持有锁，只需片刻即可锁定更改。如果您有短期交易，则不应引起注意。在某些情况下，这也适用于表（例如，添加可为空的列或默认列）。

如果您使用 PL/SQL（尤其是包），事情可能会稍微复杂一些。为 11gR1 提出了增强功能以​​支持进行中的应用程序升级，但它已被推出，现在预计在 11gR2 中（可能在明年上半年推出）。同时，一种解决方法是一种多模式解决方案。假设您的数据位于一个模式（“黄色”）中并且您当前的应用程序代码在“蓝色”模式中运行，您将新应用程序加载到“绿色模式”中。您将连接一个一个地从蓝色切换到绿色。一旦您的连接都使用“绿色”，您可以停用“蓝色”，直到下一次升级（当“蓝色”成为新应用程序并且“绿色”停用时）。

如果您拥有真正的 24/7 系统，您可能总是需要进行一些升级。例如，添加一个新列作为可选，升级应用程序以设置它，然后使其成为强制性（可能与一些预先存在的行的数据更改脚本）。

# java - 了解 JDBC 内部结构

> ID：269160
> 
> 赞同：3
> 
> 时间：2008-11-06T15:38:52.200
> 
> 标签：java, jdbc

[1] 在 JDBC 中，为什么要首先使用 Class.forName("some driver name") 加载驱动程序。为什么 SUN 不负责在 getConnection() 方法本身中加载驱动程序。如果我将驱动程序名称作为参数传递给 getConnection() 方法。

[2] 我想了解 JBDC 内部。任何指向它的指针都值得赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T15:44:41.610

使用 JDBC 4，您不再需要使用 Class.forName(...) 请参阅[此处](http://www.artima.com/lejava/articles/jdbc_four.html)的一篇文章来解释这一点：

> 连接到数据库需要在客户端的 VM 中加载合适的 JDBC 数据库驱动程序。在 JDBC 的早期，通常通过 Class.forName() 加载合适的驱动程序，传入实现 JDBC Driver 接口的类的名称。DriverManager 类后来提供了一种更灵活的方法来管理客户端应用程序中的 JDBC 驱动程序。为了使驱动程序可用，必须使用驱动程序的类名调用 DriverManager 的 registerDriver()。或者，您可以通过 jdbc.drivers 系统属性指定要加载的驱动程序。当 DriverManager 初始化时，它会尝试加载与该属性关联的驱动程序。
> 
> JDBC 4 添加了***J2SE 服务提供者***机制作为另一种指定数据库驱动程序的方法。为此，驱动程序 JAR 文件必须包含文件 META-INF/services/java.sql.driver。该文件必须包含一行，其中包含 JDBC 驱动程序的 Driver 接口实现的名称。如果需要，在 DriverManager 上调用 getConnection() 将加载如此打包的驱动程序。加载驱动程序时，会创建驱动程序的一个实例，然后调用 registerDriver() 以使该驱动程序可供客户端使用。

有关 JDBC 的更多信息，请查看[Sun 的 JDBC 链接](http://java.sun.com/products/jdbc/download.html)。与其他一些规范相比，JDBC 4.0 规范读起来比较好……

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T15:52:44.137

如果只给 java.sql 提供 JDBC 协议名称，它就无法知道要加载哪个类。可以说 JDBC 驱动程序 jar 文件应该能够在其清单中或 META-INF/ 下的其他位置指定协议名称和驱动程序类。在我看来，您最好自己构建驱动程序实例，而不是尝试使用硬连线字符串或繁琐的服务文件加载类。

JDBC 本身并不多。源代码在 JDK 的 src.zip 中。DriverManager 是带有代码的类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T11:11:25.560

*工具包*是对的。从 JDBC 4.0 开始，驱动程序将使用**J2SE Service Provider**自动注册自己的机制。不幸的是，并非所有 JDBC 供应商都更新了他们的驱动程序来这样做。我还认为目前支持 JDBC 4.0 的 JDBC 驱动程序并不多。同时，您将需要创建一个 Driver 的实例来注册驱动程序。然后，DriverManager 将检查每个注册的驱动程序是否接受为 DriverManager.getConnection() 传递的 JDBC url。您可以启用驱动程序日志记录以查看如果驱动程序已注册并且 DriverManager 尝试找到合适的驱动程序会发生什么。因此只需调用 DriverManager.setLogStream() 或 DriverManager.setLogWriter() 之前。

这是我知道的 JDBC 4.0 驱动程序之一：http: [//www.inetsoftware.de/products/jdbc/mssql/merlia](http://www.inetsoftware.de/products/jdbc/mssql/merlia/)

# .net - 为什么字体选择器对话框中没有显示已安装的字体？

> ID：269162
> 
> 赞同：4
> 
> 时间：2008-11-06T15:39:31.650
> 
> 标签：.net, winforms, visual-studio-2008, fonts

我在我的开发机器上安装了一种 OpenType 字体，希望随后能够为表单上的标签选择该字体。

该字体在 MS Word 中可用，因此我有理由相信它安装正常，但我在 Visual Studio 中的标签的字体选择器对话框中看不到该字体。我还检查了工具>选项中的字体设置，它也不存在。[从这个答案](https://stackoverflow.com/questions/106712/how-to-make-sure-a-font-exists-before-using-it-with-net#106724)运行代码不会列出字体。我试过重新启动 VS.Net。

我还能做些什么来让这个字体出现在 Visual Studio 中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-07T21:07:47.683

GDI+ 不支持 OpenType，只支持 TrueType。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T15:43:29.600

如果您还没有尝试重新启动 Visual Studio，我会尝试一下。

假设你已经这样做了，c:\windows\fonts\ 中列出的字体好吗？如果是，您可能想尝试删除它，然后在打开该窗口时通过“文件”>“安装新字体...”菜单重新安装该字体。

只是一些想法和尝试的东西。希望能帮助到你！

# .net - 基于值在 ASP.Net 中隐藏和显示内容

> ID：269164
> 
> 赞同：0
> 
> 时间：2008-11-06T15:40:07.890
> 
> 标签：.net, asp.net, controls, user-interface

如果没有设置数据，我正在寻找一种优雅的解决方案，用于从 ASP.Net 页面中删除内容。让我再解释一下。

我在页面上有一些数据块，其中包含一些带有单独值的子部分。如果没有为其中一个值设置数据，我需要隐藏它（这样它就不会占用空间）。此外，如果没有设置子部分中的任何值，则也需要将其隐藏。最后，如果块/面板中没有任何子部分可见，那么我需要隐藏整个内容。

使用嵌套面板/DIV 实现布局

```
<Panel id="block">
    <Panel id="sub1">
        <Panel id="value1-1">blah</Panel>
        <Panel id="value1-2">blah</Panel>
    </Panel>
    <Panel id="sub2">
        <Panel id="value2-1">blah</Panel>
        <Panel id="value2-2">blah</Panel>
    </Panel>
</panel> 
```

我想知道是否有人在不编写一堆嵌套的**If..Else**语句并且不创建一堆自定义控件的情况下实现这样的事情有任何体面的想法。无论我实现什么，都需要足够健壮以处理标记中的变化，而无需不断地操纵代码隐藏。

我希望有一种方法可以通过一些简单的标记更改（自定义属性）和 PageLoad 或 PreRender 上的递归函数调用来做到这一点。

任何帮助是极大的赞赏。

## 编辑：

好的，所以这个棘手的是子部分中可能有其他控件不影响控件的隐藏和显示。并且每个*值*面板都可能包含不影响是否显示的控件。例子：

```
<Panel id="sub2">
    <Image id="someImage" src="img.png" />
    <Panel id="value2-1">
        <Label>blah</Label>
        <TextBox id="txtValue" />
    </Panel>
    <Panel id="value2-2">blah</Panel>
</Panel> 
```

这是一个过于简化的例子，但离我需要担心的不远。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T15:47:26.910

如果您可以编写函数来为每个组返回真/假，则可以避免递归遍历，例如

```
<Panel id="block" runat="server" visible="<%=IsBlockVisible%>">
    <Panel id="sub1" runat="server" visible="<%=IsSubVisible(1)%>">
        <Panel id="value1-1">blah</Panel>
        <Panel id="value1-2">blah</Panel>
    </Panel>
    <Panel id="sub2" runat="server" visible="<%=IsSubVisible(2)%>">
        <Panel id="value2-1">blah</Panel>
        <Panel id="value2-2">blah</Panel>
    </Panel>
</panel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T15:43:43.827

使用递归。以节点一阶遍历控制树。根据控制值适当使用节点的可见属性。如果父母设置为不可见，则不要拜访孩子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T15:45:53.323

我认为你在递归的正确轨道上。但我会远离自定义属性——坚持标准。您真正需要的是通过递归方法在每个面板上设置 Visible 属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T15:53:00.063

如果您有严格的层次结构块/子/值并且数据来自数据库，我建议嵌套中继器和返回 3 个结果集的存储过程

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T15:57:43.563

我认为我们需要更多地了解您想要实现的目标，以便首先确定它是否是正确的方法。

# c# - 在表单中打开应用程序 - C# 或 VB.NET

> ID：269170
> 
> 赞同：8
> 
> 时间：2008-11-06T15:41:13.083
> 
> 标签：c#, vb.net, winforms

我正在编写一个应用程序，我希望能够在其中显示另一个应用程序。（想像一个带有小框的窗口窗体，或者一个显示完全独立应用程序的选项卡。）

这是可以做到的吗？如果是这样，任何人都可以就如何去做吗？

我正在寻找 C# 或 VB.NET 世界中的东西。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T15:49:27.997

您需要来自另一个应用程序的窗口的 hWnd（句柄）。然后，您需要在应用程序中使用 hWnd 容器控件（System.Windows.Forms.Control.Handle 属性）。

然后你需要使用 Win32API 函数[SetParent](http://www.pinvoke.net/default.aspx/user32/SetParent.html)，这就是你所需要的。SetParent 页面上的示例很少，应该可以满足您的需要。

# sql - 从 SQL 生成随机值

> ID：269172
> 
> 赞同：1
> 
> 时间：2008-11-06T15:41:39.527
> 
> 标签：sql, sql-server, tsql

看起来 SQL Server 像大多数其他产品一样随机函数确实不是那么随机。所以我们有这个很好的小函数来生成一个 10 字符的值。有没有更好的方法来完成以下工作。我打赌有。

```
DECLARE @SaltCount INT;
SELECT @SaltCount = COUNT(*) FROM tmp_NewLogin;
PRINT 'Set Salt values for all records' + CAST(@SaltCount AS VARCHAR(10))
DECLARE @CharPool CHAR(83);
DECLARE @Salt VARCHAR(10);
SET @CharPool = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!"#$%&()*+,-./:;<=>?@';

SET NOCOUNT ON;
updateSaltValue:
    SET @Salt = ''
    SELECT @Salt = @Salt + SUBSTRING(@CharPool, number, 1) FROM
    (
    SELECT TOP 10 number FROM MASTER..[spt_values] WHERE TYPE = 'p' AND Number BETWEEN 1 AND 83
    ORDER BY NEWID()
    ) AS t

    UPDATE TOP(1) [table] SET [Salt] = @Salt WHERE [Salt] IS NULL

IF (@@ROWCOUNT > 0)
    GOTO updateSaltValue

SET NOCOUNT OFF;

PRINT 'Completed setting salts for all records'; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T18:09:52.783

大多数程序员都犯了重新发明随机化功能的错误，最终得到的东西根本不是随机的。我建议您坚持使用内置的 RAND() 函数。播种一次，然后根据需要获取尽可能多的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T20:15:16.073

重塑兰德是灾难的根源。您在哪里注意到它的行为不正确？我认为你甚至不需要播种。SQL Server 应该自己播种它就好了。当您在测试算法等时需要多次生成相同的“随机”序列时，应该只需要播种。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T15:56:34.503

根据 rand() 函数的在线书籍：如果未指定种子，Microsoft SQL Server 2005 数据库引擎会随机分配一个种子值。对于指定的种子值，返回的结果始终相同。
您可以通过快速而肮脏的技巧来避免这种情况：

1.  像这样创建视图：

    ```
    create view [dbo].[wrapped_rand_view]
    as
    select rand( ) as random_value 
    ```

2.  接下来创建从视图读取的函数：

    ```
    create function [dbo].[wrapped_rand]()
    returns float
    as
    begin
    declare @f float
    set @f = (select random_value from wrapped_rand_view)
    return @f 
    ```

这样，您每次调用 Wrapped_rand() 函数时都有随机种子，并且在 0 和 1 之间有不同的随机值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T00:48:08.173

使用 Rand() 函数......并用其他随机的东西作为种子，比如当前 sysDate 或当前时间戳中的毫秒数......或者调用 NewId() 函数......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T16:59:28.980

不是您拥有的全字母随机性，而是一种随机性：

```
select substring(replace(newid(),'-',''),0,10) 
```

**编辑：**我从评论中了解到 newid() 对随机性不是很好，尤其是与子字符串结合使用时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-27T11:44:22.303

有时需要使用临时密码重置密码或为新用户生成随机密码。

以下存储过程根据配置结果的四个参数创建随机字符串。

```
> create proc [dbo].uspRandChars
>     @len int,
>     @min tinyint = 48,
>     @range tinyint = 74,
>     @exclude varchar(50) = '0:;<=>?@O[]`^\/',
>     @output varchar(50) output as 
>     declare @char char
>     set @output = ''
>  
>     while @len > 0 begin
>        select @char = char(round(rand() * @range + @min, 0))
>        if charindex(@char, @exclude) = 0 begin
>            set @output += @char
>            set @len = @len - 1
>        end
>     end 
```

# c# - 在 Global.asax 的 Application_Start 方法中访问缓存时出错

> ID：269174
> 
> 赞同：2
> 
> 时间：2008-11-06T15:42:18.307
> 
> 标签：c#, asp.net, iis, global-asax

我正在尝试访问 Global.asax 的 Application_Start 方法中的缓存。我正在尝试访问 Context.Cache。当我从 Visual Studio 运行代码时，它工作得很好，但是当我从 IIS 在服务器上运行它时，我得到：会话状态在此上下文中不可用。我想在应用程序启动时在缓存中植入一些值。如何从 Application_Start 获取缓存？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T15:53:56.910

哇。我找到了答案。使用变量 HttpRuntime.Cache 而不是 Context.Cache。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-01T21:24:42.363

是的，这在 IIS7 中随着切换到集成模式而发生了变化。Application_Start 执行较早，因此 HttpContext 不可用。

Visual Studio 使用 Cassini，这在几个方面与完整的 IIS 不同。查看新发布的[IIS Express](http://learn.iis.net/page.aspx/868/iis-express-overview/)，它也可以与 Visual Studio 一起使用。它是 IIS 7.5 的独立版本，因此您不会遇到使用 Cassini 进行测试时不存在的生产问题。

# linux - 商品 Linux 存储场的最佳分布式文件系统

> ID：269179
> 
> 赞同：34
> 
> 时间：2008-11-06T15:43:54.373
> 
> 标签：linux, filesystems, distributed-computing, distributed-system

我有很多备用的英特尔 linux 服务器（数百台），并希望将它们用于网络托管和文件共享环境中的分布式文件系统。这不适用于 HPC 应用程序，因此高性能并不重要。主要要求是高可用性，如果一台服务器离线，存储在其硬盘上的数据仍然可以从其他节点获得。它必须通过 TCP/IP 运行并提供标准的 POSIX 文件权限。

我看过以下内容：

*   Lustre ( [http://wiki.lustre.org/index.php?title=Main_Page](http://wiki.lustre.org/index.php?title=Main_Page) )：*非常*接近，但它不为节点上的数据提供冗余。您必须使用 RAID 或 DRBD 使数据成为 HA。由 Sun 和开源支持，因此应该存在一段时间

*   gfarm（[http://datafarm.apgrid.org/](http://datafarm.apgrid.org/)）：看起来它提供了冗余，但以复杂性和可维护性为代价。不如 Lustre 得到很好的支持。

有没有人对这些或任何其他可能有效的系统有任何经验？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-06T15:45:33.357

还要检查[GlusterFS](http://www.gluster.org/)

**编辑（2012 年 8 月）：** [Ceph](http://ceph.com/)终于准备好了。最近，作者成立了[Inktank](http://www.inktank.com/)，这是一家独立公司，为其出售商业支持。根据一些介绍，可挂载的 POSIX 兼容文件系统是最上层，尚未真正经过测试，但下层已经在生产中使用了一段时间。

有趣的部分是 RADOS 层，它提供了一个基于对象的存储，通过`librados`库（可用于多种语言）和与 Amazon S3 兼容的 RESP API 进行“本机”访问。任何一个都足以为 Web 服务添加大量存储。

[该视频](https://www.youtube.com/watch?v=UXcZ2bnnGZg)很好地描述了理念、架构、能力和现状。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-10-11T09:56:53.037

在我看来，Linux 上最好的文件系统是 MooseFS，它很新，但我有机会将它与 Ceph 和 Lustre 进行比较，我肯定 MooseFS 是最好的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-06T20:21:16.830

Gluster 目前受到了很多媒体的关注：

[http://www.gluster.org/](http://www.gluster.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-22T02:02:28.163

Lustre 一直在为我们工作。它并不完美，但它是我们尝试过的唯一没有因负载过大而崩溃的东西。我们仍然不时遇到 LBUGS，处理 100TB + 文件系统绝非易事，但 Lustre 系统已经工作并提高了性能和可用性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-19T12:06:56.617

如果不是有人强迫你使用它，我也强烈建议使用 Lustre 以外的任何东西。从我从其他人那里听到的以及也让我自己做噩梦很长一段时间的事实是，Lustre 在各种情况下很容易崩溃。如果系统中只有一个客户端发生故障，它通常会在持有一些重要的全局锁的同时将自己置于无休止的 do_nothing_loop 模式 - 所以下次另一个客户端尝试访问相同的信息时，它也会挂起。因此，您通常最终会重新启动整个集群，我想这是您通常会尝试避免的事情；）

像 FhGFS (http://www.fhgfs.com) 这样的现代并行文件系统在这里更加健壮，并且还允许您做一些不错的事情，例如在同一台机器上运行服务器和客户端组件（尽管内置的 HA 功能仍在开发，正如他们团队中的某个人告诉我的，但从我听说的情况来看，他们的实施将非常棒）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-27T16:26:10.150

[Ceph](http://ceph.newdream.net/)看起来是一个很有前途的新进入这个领域。该网站声称它尚未准备好用于生产用途。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-12T16:13:14.130

我读了很多关于分布式文件系统的文章，我认为 FhGFS 是最好的。

[http://www.fhgfs.com/](http://www.fhgfs.com/)

值得一试。在以下位置查看更多信息：

[http://www.fhgfs.com/wiki/](http://www.fhgfs.com/wiki/)

# pinvoke - 在 P/Invoking 时未找到 DLL 时，如何获取有关丢失的特定非托管 DLL 的消息？

> ID：269181
> 
> 赞同：4
> 
> 时间：2008-11-06T15:44:13.857
> 
> 标签：pinvoke

当您链接到一个非托管库（例如“A.dll”），该库又链接到另一个库（“B.dll”），并且 B.dll 丢失时，您将收到有关加载失败的运行时错误消息'B.dll'。

但是，当您从托管代码中 P/Invoke 到“A.dll”时，您会得到这种形式的一般异常：

未处理的异常：System.DllNotFoundException：无法加载 DLL 'A.dll'：找不到指定的模块。

从托管代码执行 p/invoking 时，如何获得指出无法加载的特定非托管 dll 文件的错误消息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T15:48:01.493

我认为没有任何特定的 API 可以用来查明为什么`LoadLibrary`（底层 Win32 API）对于“A.dll”失败。我建议使用[Dependency Walker](http://www.dependencywalker.com/)之类的工具来解决 DLL 加载错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T15:46:35.537

我不确定您如何以异常的形式获得此信息。当我遇到这个问题时，我通常会尝试使用depends.exe 打开DLL。如果 DLL 只是从其当前位置加载，那么它非常好并且报告存在的缺失依赖项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T13:32:18.223

您将无法从异常中得到答案，但您可以通过 Process Monitor 来完成（通过大量工作）。本文讨论了如何以及还包括一个工具来扫描进程监视器日志以查找特定问题。

[http://tech.blinemedical.com/debug-could-not-load-file-or-assembly-or-one-of-its-dependencies/](http://tech.blinemedical.com/debug-could-not-load-file-or-assembly-or-one-of-its-dependencies/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-18T20:59:29.597

Fusion Log Viewer 是调试 .NET 应用程序中的程序集加载问题的好工具。

要识别一般文件加载问题，您可以使用 Process Monitor。

# java - 除了 EAR 和 EJB，我还能从 Java EE 应用程序服务器中获得哪些在 Tomcat 等 servlet 容器中无法获得的信息？

> ID：269186
> 
> 赞同：23
> 
> 时间：2008-11-06T15:45:16.490
> 
> 标签：java, tomcat, jakarta-ee, application-server

我们使用 Tomcat 来托管基于 WAR 的应用程序。我们是 servlet 容器兼容的 J2EE 应用程序，但 org.apache.catalina.authenticator.SingleSignOn 除外。

我们被要求迁移到商业 Java EE 应用程序服务器。

1.  我看到的改变的第一个缺点是成本。无论应用服务器收费多少，Tomcat都是免费的。
2.  其次是复杂性。我们既不使用 EJB 也不使用 EAR 特性（当然不，我们不能），并且没有错过它们。

那么我没有看到的好处是什么？

我没有提到的缺点是什么？

* * *

提到的是...

1.  JTA - Java Transaction API - 我们通过数据库存储过程控制事务。
2.  JPA - Java Persistence API - 我们使用 JDBC 和存储过程来持久化。
3.  JMS - Java 消息服务 - 我们使用 XML over HTTP 进行消息传递。

这个不错，请多多指教！

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-02-08T19:14:46.573

当我们以 Java EE 6 将 Apache Tomcat 认证为[Apache TomEE](http://tomee.apache.org/comparison.html)为目标时，这里有一些我们必须填补的空白才能最终通过 Java EE 6 TCK。

不是一个完整的列表，而是一些即使有现有答案也可能不明显的亮点。

## 没有事务管理器

任何经过认证的服务器都绝对需要事务管理。在任何 Web 组件（servlet、过滤器、侦听器、jsf 托管 bean）中，您应该能够`UserTransaction`像这样获得注入：

*   `@Resource UserTransaction transaction;`

您应该能够使用`javax.transaction.UserTransaction`来创建事务。您在该事务范围内触及的所有资源都应在该事务中注册。这包括但不限于以下对象：

*   `javax.sql.DataSource`
*   `javax.persistence.EntityManager`
*   `javax.jms.ConnectionFactory`
*   `javax.jms.QueueConnectionFactory`
*   `javax.jms.TopicConnectionFactory`
*   `javax.ejb.TimerService`

例如，如果在 servlet 中启动事务，则：

*   更新数据库
*   向主题或队列触发 JMS 消息
*   创建一个计时器以在稍后的某个时间进行工作

.. 然后其中一件事情失败了，或者您只是选择调用`rollback()`，`UserTransaction`那么所有这些事情都被撤消了。

## 无连接池

很清楚有两种连接池：

*   事务感知连接池
*   非事务感知连接池

Java EE 规范并不严格要求连接池，但是如果你有连接池，它应该是事务感知的，否则你将失去事务管理。

这基本上意味着：

*   同一事务中的每个人都应具有来自池的相同连接
*   在事务完成（提交或回滚）之前，不应将连接返回到池中，无论是否有人调用`close()`了`DataSource`.

Tomcat 中用于连接池的通用库是 commons-dbcp。我们也想在 TomEE 中使用它，但是它不支持事务感知连接池，因此我们实际上将该功能添加到 commons-dbcp（是的，Apache）中，并且从 commons-dbc 版本 1.4 开始。

请注意，将 commons-dbcp 添加到 Tomcat 仍然不足以获得事务连接池。您仍然需要事务管理器，并且您仍然需要容器来完成注册与`TransactionManager`via`Synchronization`对象的连接的管道。

在 Java EE 7 中，有人谈论添加一种标准方法来加密 DB 密码并将它们与应用程序一起打包到安全文件或外部存储中。这将是 Tomcat 不支持的另一项功能。

## 没有安全集成

WebServices 安全性、JAX-RS SecurityContext、EJB 安全性、JAAS 登录和 JAAC 都是默认情况下不会在 Tomcat 中“挂钩”的安全概念，即使您单独添加 CXF、OpenEJB 等库也是如此。

当然，这些 API 都假设在 Java EE 服务器中协同工作。我们必须做很多工作才能让所有这些协作并在 Tomcat `Realm`API 之上完成，以便人们可以使用所有现有的 Tomcat`Realm`实现来驱动他们的“Java EE”安全性。它实际上仍然是 Tomcat 安全性，它只是很好地集成。

## JPA 集成

是的，您可以将 JPA 提供程序放入 .war 文件中，并在没有 Tomcat 帮助的情况下使用它。使用这种方法，您不会得到：

*   `@PersistenceUnit EntityManagerFactory`注入/查找
*   `@PersistenceContext EntityManager`注入/查找
*   连接`EntityManager`到事务感知连接池
*   JTA 托管`EntityManager`支持
*   扩展的持久性上下文

JTA-Managed`EntityManager`基本上意味着同一事务中希望使用 an 的两个对象`EntityManager`都将看到相同的`EntityManager`内容，并且无需显式传递`EntityManager`。所有这些“传递”都是由容器为你完成的。

这是如何实现的？很简单，`EntityManager`你从容器中得到的是假货。这是一个包装。当您使用它时，它会在当前事务中查找 real`EntityManager`并将调用委托给`EntityManager`. 这就是神秘`EntityManager.getDelegate()`方法的原因，因此用户可以根据需要获取**真正的**EntityManager 并使用任何非标准 API。这样做当然要非常小心，永远不要保留对委托的引用，`EntityManager`否则您将遇到严重的内存泄漏。当事务完成时，委托`EntityManager`通常会被刷新、关闭、清理和丢弃。如果您仍然持有一个引用，您将阻止对该引用`EntityManager`以及它所持有的所有数据进行垃圾收集。

*   `EntityManager`保存对从容器中获得的a 的引用总是安全的
*   引用它是不安全的`EntityManager.getDelegate()`
*   要非常小心地引用`EntityManager`您通过 an 创建的自己的引用`EntityManagerFactory`——您对它的管理负有 100% 的责任。

## CDI 集成

我不想过度简化 CDI，但我发现它有点太大了，而且很多人没有认真看 - 它在很多人的“总有一天”列表上:) 所以这里只是几个亮点我想一个“网络人”会想知道。

你知道在一个典型的 web 应用程序中的所有投入和获取吗？`HttpSession`整天把东西拉进拉出？使用`String`你从`HttpSession`. 您可能已经使用实用程序代码为您执行此操作。

CDI 也有这个实用程序代码，它被称为`@SessionScoped`. 任何带有注释的对象`@SessionScoped`都会被放入并跟踪`HttpSession`。您只需通过请求将对象注入到您的 Servlet 中`@Inject FooObject`，CDI 容器就会以与我描述的事务跟踪相同的方式跟踪“真实”FooObject 实例`EntitityManager`。Abracadabra，现在你可以删除一堆代码了 :)

做任何`getAttribute`事`setAttribute`吗`HttpServletRequest`？好吧，你也可以用`@RequestScoped`同样的方法删除它。

当然还有`@ApplicationScoped`消除你可能正在做的`getAttribute`电话`setAttribute``ServletContext`

为了让事情变得更酷，任何像这样跟踪的对象都可以实现一个`@PostConstruct`在创建 bean 时调用的`@PreDestroy`方法，以及在所述“范围”完成时通知的方法（会话完成，请求结束，应用程序正在关闭）向下）。

CDI 可以做得更多，但这足以让任何人想要重写旧的 web 应用程序。

## 一些挑剔的东西

Java EE 6 中添加了一些在 Tomcat 驾驶室中没有添加的东西。它们不需要大的解释，但确实占了“填补空白”的很大一部分。

*   支持`@DataSourceDefinition`
*   支持全球 JNDI ( `java:global`, `java:app`, `java:module`)
*   `@Resource MyEnum myEnum`通过和枚举注入
*   `@Resource Class myPluggableClass`通过and进行类注入
*   支持`@Resource(lookup="foo")`

小问题，但以可`DataSource`移植的方式在应用程序中定义、在 web 应用程序之间共享 JNDI 条目以及简单地说“查找并注入它”的能力非常有用

## 结论

如前所述，不是完整的列表。没有提到 EJB、JMS、JAX-RS、JAX-WS、JSF、Bean Validation 和其他有用的东西。但是，当人们谈论 Tomcat 是什么和不是什么时，至少有一些经常被忽视的东西。

另请注意，您可能认为的“Java EE”可能与实际定义不符。有了 Web Profile，Java EE 就缩小了。这是**故意**解决“Java EE 太重，我不需要所有这些”的问题。

如果您将 EJB 从 Web 配置文件中删除，则剩下的内容如下：

*   Java 小服务程序
*   Java 服务器页面 (JSP)
*   Java ServerFaces (JSF)
*   Java 事务 API (JTA)
*   Java 持久性 API (JPA)
*   Java 上下文和依赖注入 (CDI)
*   Bean 验证

这是一个非常有用的堆栈。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T16:11:09.763

除非您想要正确的 EJB，否则您不需要全栈 J2EE 服务器（商业或非商业）。

您可以拥有大多数 J2EE 功能（例如 JTA、JPA、JMS、JSF）而无需全栈 J2EE 服务器。全栈 j2ee 的唯一好处是容器将以声明方式代表您管理所有这些。随着 EJB3 的出现，如果您需要容器管理的服务，使用一个是一件好事。

您还可以拥有免费的全栈服务器，例如 Glasfish、Geronimo 或 JBoss。

您还可以使用嵌入式 Glasfish 运行嵌入式 j2ee 容器管理服务，例如，就在 Tomcat 中。

如果您想使用为您很好地管理的会话 bean、消息 bean、计时器 bean，即使使用集群和故障转移，您可能需要一个 EJB 容器。

我建议管理层根据功能需求考虑升级。其中一些 EJB 容器可能只是使用嵌入式 Tomcat 作为他们的网络服务器，所以有什么好处！

有些经理只是喜欢为事情买单。让他们考虑捐赠城市庇护所，或者直接选择 BEA。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T16:31:13.340

如果您被要求迁移到商业 J2EE 服务器，原因可能与 J2EE 堆栈无关，而是出于非技术考虑。

使用 Tomcat 无法获得的商业 J2EE 产品提供的一件事是技术支持。

这可能不是您的考虑因素，具体取决于您的 Web 应用程序应该满足的服务级别。当您尝试找出 Tomcat 的问题时，您的应用程序是否会停止运行，或者这会是一个主要问题吗？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T15:52:40.987

成本不一定是不利因素，因为有一些免费的 J2EE 服务器，例如 JBoss 和 Glassfish。

您的问题假定 (J2EE = Servlet + EJB + EAR)，因此，如果您不使用 EJB 或 EAR，那么除了使用 Servlet 容器之外没有任何意义。事实并非如此，J2EE 包含的远不止这些。示例包括：

*   JTA - Java 事务 API
*   JPA - Java 持久性 API
*   JMS - Java 消息传递规范
*   JSF - 用组件构建用户界面的技术

干杯，多纳尔

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T16:32:38.300

事实上，由于有大量可用的包和库，几乎没有 EJB 容器提供不能添加到现代 servlet 容器（ala Tomcat）中。因此，如果您想要这些功能中的任何一个，您可以“点菜”获得它们，也就是说，成本是将这些功能集成到您的应用程序的过程。

如果您现在没有“缺少”这些功能中的任何一个，那么从实际的角度来看，您可能不需要它们。

总而言之，现代 EJB 容器非常好，并且预集成了所有这些服务，使它们在某种程度上更易于使用，如果您需要它们的话。有时，将功能放在附近且方便使用就足以让人们探索其在应用程序中的潜力，而不是将功能的集成过程视为采用的障碍。

凭借免费 EJB 容器的质量，真的很难想象购买一个会有多大用处，尤其是考虑到您目前没有真正的需求。

但是，我确实鼓励您实际购买并使用它并探索该平台。Glassfish 非常容易上手并且非常好，并且应该可以轻松地按原样（或进行非常小的调整）处理您的 WAR。

作为一项规则，当涉及到运行 Tomcat 与 EJB 容器之间时，问题真的是为什么不使用一个？专门针对 Glassfish 来说，我发现它比 Tomcat 更易于使用，主要区别在于它可以比 Tomcat 具有更大的内存占用（特别是对于小型应用程序），但在大型应用程序上你甚至不会注意到. 对我来说，内存命中没什么大不了的，对其他人来说可能是个问题。

它为我提供了所有这些优秀功能的单一来源，而无需为第 3 方选项爬网。

# wxpython - 如何在 wxGlade 创建的文件中插入版权声明？

> ID：269189
> 
> 赞同：1
> 
> 时间：2008-11-06T15:45:39.517
> 
> 标签：wxpython, wxwidgets, copyright-display, wxglade

我使用 wxGlade 创建使用 wxWidgets 的 Python 脚本。wxGlade 直接操作 XML 文件，这些文件描述了基于 wxWidgets 的 GUI。这些文件具有 *.wxg 扩展名。从 *.wxg 文件中，可以生成实际以多种语言之一运行 GUI 的代码，我正在使用它来生成 Python 代码。

我想在我的 *.wxg 文件和生成的代码中添加版权声明。我尝试手动编辑 *.wxg 文件并将我的版权声明添加为 HTML 注释，但在 wxGlade 中编辑文件并保存编辑后的版本后，我的注释消失了。

每次从 wxGlade 保存后，如何在不手动编辑这些文件的情况下向这些文件添加版权声明？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-30T00:11:11.557

要向 wxGlade 生成的文件添加版权声明，您必须手动插入版权声明。您必须对生成的每个文件执行此操作。确保您不必*每次*生成文件时都这样做的诀窍是执行以下操作：

1.  第一次生成你的源代码
2.  将您的版权声明添加到文件中
3.  如果 wxGlade 还没有自动完成，请在 wxGlade 生成的代码周围加上

    ```
    # begin wxGlade:
    # end wxGlade 
    ```

4.  确保未选中“覆盖现有源”复选框（右键单击树顶部的应用程序，并在应用程序属性的底部找到此复选框）

如果您对这方面的更多信息感兴趣，请查看[此页面](http://wxglade.sourceforge.net/tutorial.php)- 第*9 节。Notes*包含您想要的信息（抱歉，无法链接到此部分，因为它没有锚点）。

# c# - C# Binding：如何禁用 BindingList 中的 CurrencyManager，以便不维护当前项目位置并且不发出信号？

> ID：269193
> 
> 赞同：2
> 
> 时间：2008-11-06T15:47:09.170
> 
> 标签：c#, data-binding, binding, currencymanager

我有两个数据绑定到同一个 BindingList 的 ListBox。

问题是当从 GUI 更改选定项时，它会更改 BindingList 中的位置，然后 BindingList 会向另一个 ListBox 发出信号以更改其选定项。

所以我有两个 ListBoxes Selected Item 也同步，这对我不利。

我想保持同步的项目列表。没有光标位置。

如何禁用该光标以使其不被维护？

示例代码（只需在设计时将两个 ListBoxes 添加到 Form 并注册 SelectedIndexChanged 事件并使用按钮注册按钮单击事件）：

```
public partial class Form1 : Form
{
    BindingList<string> list = new BindingList<string>();

    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        list.Add("bla1");
        list.Add("bla2");
        list.Add("bla3");

        this.listBox1.DataSource = list;
        this.listBox2.DataSource = list;
    }

    private void listBox1_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (listBox1.SelectedIndex != -1)
            System.Diagnostics.Trace.WriteLine("ListBox1: " + listBox1.SelectedItem.ToString());
    }

    private void listBox2_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (listBox2.SelectedIndex != -1)
            System.Diagnostics.Trace.WriteLine("ListBox2: " + listBox2.SelectedItem.ToString());
    }

    // Register this event to a button
    private void button1_Click(object sender, EventArgs e)
    {
        list.Add("Test");
    }
} 
```

谢谢，--冉。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-10T13:28:06.767

将此行添加到`Form_Load`：

```
this.listBox1.BindingContext = new BindingContext(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T22:40:47.947

将 listBox1 和 listBox2 声明为以下类型似乎会导致所需的行为。

```
class MyListBox: ListBox {

    protected override void OnSelectedIndexChanged (EventArgs a) {
        if (DataManager != null) {
            DataManager.SuspendBinding();
        }
    }

} 
```

问候，坦伯格

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-10T13:13:56.750

我对这个问题的解决方案是使用普通 List 而不是 BindingList 并在 Form 对象上调用（在更改之前）： this.BindingContext[Your List].SuspendBinding(); 并在更改为 List this.BindingContext[Your List].ResumeBinding(); 这将更新所有有界控件。

[请注意，此处的 MSDN 链接](http://msdn.microsoft.com/en-us/library/w67sdsex.aspx)中也注明了这一点：

> “如果你绑定了一个没有实现IBindingList接口的数据源，比如ArrayList，那么当数据源更新的时候，绑定的控件的数据就不会更新了。比如你有一个组合框绑定到了一个ArrayList并且数据被添加到 ArrayList 中，这些新项将不会出现在组合框中。但是，您可以通过在控件绑定到的 BindingContext 类的实例上调用 SuspendBinding 和 ResumeBinding 方法来强制更新组合框。”

# java - SAX 解析器中断 ñ

> ID：269207
> 
> 赞同：2
> 
> 时间：2008-11-06T15:52:00.643
> 
> 标签：java, xml, encoding, sax

我通过扩展默认处理程序在 Java 中实现了 SAX 解析器。XML 在其内容中有一个ñ。当它击中这个角色时，它会破裂。我在字符方法中打印出 char 数组，它只是以 ñ 之前的字符结束。解析器似乎在此之后停止，因为即使还有更多内容，也没有调用其他方法。即 endElement 方法不再被调用。有没有人遇到过这个问题或对如何处理有任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T16:18:40.137

文件的编码是什么？确保文件的编码修饰与其匹配。您的解析器可能默认为 ascii 或 ISO-8859-1。您可以像这样设置编码

```
<?xml version="1.0" encoding="UTF-8"?> 
```

UTF-8 将覆盖该字符，只需确保这是文件实际所在的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T16:20:22.537

如果您以 ASCII 格式保存 XML，则只能使用 8 位字符表的下半部分（前 128 个字符）。要在 XML 中包含重音字符或其他非英语字符，您必须将 XML 保存为 UTF-8 或转义您的字符，如 ñ 对于ñ。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-29T21:26:24.287

我遇到了这个问题。您提供的 XML 流必须我读为 ascii，在代码中将 ascii 编码为“UTF-8”或将其更改为字符流，一切都会好起来的。

这样的事情会帮助你：

```
File F = new File(C://Location);
BuffeReader Readfile = new BufferReader(F);
InputSource Encode = new InputSource(Readfile);
Encode.setEncoding("UTF-8"); 
```

# java - 处理 UTF-8 编码

> ID：269212
> 
> 赞同：2
> 
> 时间：2008-11-06T15:53:09.813
> 
> 标签：java, xml, unicode, encoding, utf-8

我们有一个在 Weblogic 服务器上运行的 Java 应用程序，它从 JMS 或 MQ 队列中提取 XML 消息并将其写入另一个 JMS 队列。应用程序不会以任何方式修改 XML 内容。我们使用 BEA 的 XMLObject 来读取消息并将消息写入队列。

XML 消息包含编码类型声明为 UTF-8。

当 XML 包含超出正常 ASCII 范围的字符（例如 £ 符号）时，我们会遇到问题。当从队列中读取消息时，我们可以看到 £ 符号是完整的，但是一旦我们将其写入目标队列， £ 符号就会丢失并被替换为 Â£。

我检查了操作系统级别设置（区域设置），一切似乎都很好。我还应该检查什么以确保不会发生这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T19:08:06.113

> 一旦我们将其写入目标队列，£ 符号就会丢失并被替换为 Â£

这告诉我该字符被*写*为 UTF-8，但它被*读取*为好像它是像 ISO-8859-1 这样的单字节编码。（对于 U+00A0..U+00BF 范围内的任何字符，如果将其编码为 UTF-8 并将其解码为 ISO-8859-1，则最终会得到两个字符序列**`ÃX`**，其中**`X`**是原始字符。 ) 我会查看接收 JMS 队列的编码设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T19:24:37.580

您应该使用`InputStream`、`OutputStream`和`byte[]`来处理 XML 文档，而不是`Reader`、`Writer`和`String`。在 JMS 的世界中，`BytesMessage`与`TextMessage`.

每个 XML 文档都在内部指定其字符编码，并且所有 XML 处理 API 都面向获取字节流，并在必要时找出正确的字符编码以供自己使用。基于文本的 API 只是在那里......我猜是为了迷惑人们！无论如何，应用程序应该让 XML 处理器处理字符编码问题，而不是试图自己管理它（或使用面向文本的 API，而对字符编码问题没有深入的了解）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T16:04:43.240

如果没有更多细节，我猜有一种方法可以选择在未指定的地方进行编码，并且默认为 ISO-8859-1。通常，检查 InputStream/OutputStream 和 Reader/Writer 之间传递的任何内容。

例如，[OutputStreamWriter](http://java.sun.com/j2se/1.4.2/docs/api/java/io/OutputStreamWriter.html)采用您可以省略的可选编码。

# .net - 用于同一应用程序的 MySQL 和 SQL Server

> ID：269213
> 
> 赞同：2
> 
> 时间：2008-11-06T15:53:20.140
> 
> 标签：.net, database, enterprise-library

在不实际编码两个 DAL 的情况下实现这种 DB 不可知论的好方法是什么？我听说数据访问应用程序块适用于此。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T15:58:32.080

您还可以查看各种 ORM 库，例如 NHibernate。当您针对多个数据库时，最好寻找一种可以从配置文件或代码创建数据库的工具。这将防止您必须在 MySQL 和 MSSql 中创建相同的数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:32:21.623

一种选择是使用 System.Data 命名空间中的 IDbConnection、IDbCommand 等类进行编码，而不是使用 System.Data.SqlClient 中的 SQL Server 特定类（SqlConnection、SqlCommand）或相应的 MySQL 特定类。您仍然需要为您正在使用的特定数据库创建连接类的实例，但从那里您可以使用通用接口。

[http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/1175d7ea-f5b4-442f-9155-08bf8b2ba06c/](http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/1175d7ea-f5b4-442f-9155-08bf8b2ba06c/)和[http://www.15seconds.com/issue/040127.htm](http://www.15seconds.com/issue/040127.htm)有一些示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T16:11:51.197

使用 MySQL 的 ADODB 抽象库。本机 MySQL 库调用非常丑陋和原始，因此无论如何您都可能需要更高级别的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T16:43:30.087

好吧，正如其他人指出的那样，尝试将自己从所涉及的实际类中抽象出来。正如 AHd54 指出的那样，这可能涉及使用接口，或者类似的东西。

但这只会让你成功一半。

您需要执行的 SQL 也会有所不同，如下所示：

*   参数名称语法
*   位置参数与命名参数
*   函数名称
*   一些语法差异，比如如何指定*只给我前 N 行*

如果您需要涵盖所有这些内容，并且不能或不会使用 ORM（尽管它们很少让您 100% 到达那里），那么一种方法是创建您自己的类，这些类不仅抽象出所涉及的实际类，但也会进行某种类型的 SQL 重写来处理代码差异。

我已经走上了重写的道路，因此，如果您需要对此的指示，请在此答案中添加评论并提出问题，我将相应地更新答案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-12T05:10:52.323

使用 ERD 图表工具构建纯逻辑设计，然后让它为您的每个选项生成 DDL。

您可以查看 DBDesigner ...

[http://www.fabforce.net/downloads.php](http://www.fabforce.net/downloads.php)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-01T15:38:01.143

ORM 框架将帮助您实现与 RDBMS 无关的基础架构，但如果您使用 UDF 和存储过程，您仍然必须保留单独的 DAL。因此，您可能不会使用触发器、T-SQL、更新视图和 CLR 托管的 C# 代码。您只需映射实体和对象。

ADO.NET 在大多数项目中都能做得很好。如果您需要在 MSSQL 或 MySQL 之间切换，您可以像这样轻松实现与提供者无关的访问：

```
 private static DbProviderFactory _provider = DbProviderFactories.GetFactory(WebConfigurationManager.ConnectionStrings["database"].ProviderName);
    private static string _connectionString = WebConfigurationManager.ConnectionStrings["database"].ConnectionString;

    public static DbParameter CreateParameter(string name, object value)
    {
        DbParameter parameter = _provider.CreateParameter();
        parameter.ParameterName = name;
        parameter.Value = value;
        return parameter;
    }

    public static DataTable SelectAsTable(string query, DbParameter[] parameters)
    {
        using (DbConnection connection = _provider.CreateConnection())
        {
            connection.ConnectionString = _connectionString;
            using (DbDataAdapter adapter = _provider.CreateDataAdapter())
            {
                adapter.SelectCommand = connection.CreateCommand();
                adapter.SelectCommand.Parameters.AddRange(parameters);
                adapter.SelectCommand.CommandText = query;

                DataTable table = new DataTable();
                adapter.Fill(table);
                connection.Close();
                return table;
            }
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-01T15:42:12.117

最好的方法是使用 O/RM 工具（实际上通常是*任何数据库访问层）。*我更喜欢 ActiveRecord，它是 nHibernate 的包装器......

这是一些使用 AR 的示例源代码；[Stacked 中运算符对象的代码](http://code.google.com/p/stacked/source/browse/trunk/WebSite/App_Code/Operator.cs)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-12-14T20:41:55.070

.net [Provider 模型](http://dotnetslackers.com/articles/designpatterns/howtowriteaprovidermodel.aspx)是专门为解决这个问题而设计的。通过提供一个“提供程序”类来处理您的所有数据库交互并从精心设计的基类继承，您可以以最小的努力换出后端提供程序（用于 sql、mySql (blech)、xml 或其他）。

此外，根据我的经验，ORM 生成的代码无法与有能力的开发人员编写的代码竞争，并且通常会产生更多由它解决的维护问题。ORM 是另一个抽象层，它会导致更慢、更占用资源的代码，这些代码只对那些不熟悉 SQL 的来龙去脉的人来说是必需的。

# c++ - C++ 不能消除 pimpl 成语吗？

> ID：269223
> 
> 赞同：19
> 
> 时间：2008-11-06T15:56:44.270
> 
> 标签：c++, language-design, compiler-theory, pimpl-idiom

据我了解，pimpl 习惯用法的存在只是因为 C++ 强制您将所有私有类成员放在标题中。如果标头仅包含公共接口，理论上，类实现的任何更改都不需要重新编译程序的其余部分。

我想知道的是为什么 C++ 的设计不是为了提供这样的便利。为什么它要求一个类的私有部分在标题中公开显示（不是双关语）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T20:36:38.773

我认为这里有一个混淆。问题不在于标题。标头不做任何事情（它们只是在几个源代码文件中包含源文本的公共位的方法）。

问题在于，C++ 中的类声明必须定义实例工作所需的所有内容，无论是公共的还是私有的。（Java 也是如此，但是对外部编译类的引用的工作方式使得不需要使用任何像共享头这样的东西。）

即使您只使用公共部分，人们也需要知道所使用的具体类以及如何使用其构造函数来交付实现，这是常见的面向对象技术（不仅仅是 C++ 技术）的本质。（3，下）中的设备将其隐藏。（1，下面）中的实践将关注点分开，无论您是否这样做（3）。

1.  使用只定义公共部分的抽象类，主要是方法，并让实现类从该抽象类继承。因此，使用通常的标题约定，有一个abstract.hpp 是共享的。还有一个 implementation.hpp 声明了继承的类，并且只传递给实现实现方法的模块。implementation.hpp 文件将#include "abstract.hpp" 用于它所做的类声明，因此抽象接口的声明只有一个维护点。

2.  现在，如果你想强制隐藏实现类声明，你需要有某种方法来请求构造一个具体实例而不拥有特定的、完整的类声明：你不能使用 new 也不能使用本地实例. （但您可以删除。）辅助函数的引入（包括其他类上提供对类实例的引用的方法）是替代品。

3.  与用作抽象类/接口的共享定义的头文件一起或作为头文件的一部分，包括外部辅助函数的函数签名。这些功能应该在作为特定类实现的一部分的模块中实现（因此它们可以看到完整的类声明并可以使用构造函数）。辅助函数的签名可能很像构造函数的签名，但它返回一个实例引用作为结果（这个构造函数代理可以返回一个 NULL 指针，如果你喜欢这种东西，它甚至可以抛出异常）。辅助函数构造一个特定的实现实例并将其作为对抽象类实例的引用返回。

任务完成。

Oh, and recompilation and relinking should work the way you want, avoiding recompilation of calling modules when only the implementation changes (since the calling module no longer does any storage allocations for the implementations).

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T16:07:03.420

这与对象的大小有关。除其他外，h 文件用于确定对象的大小。如果没有在其中给出私有成员，那么您将不知道新的对象有多大。

但是，您可以通过以下方式模拟您想要的行为：

```
class MyClass
{
public:
   // public stuff

private:
#include "MyClassPrivate.h"
}; 
```

这不会强制执行该行为，但它会从 .h 文件中获取私有内容。不利的一面是，这增加了另一个要维护的文件。此外，在视觉工作室中，智能感知不适用于私人成员 - 这可能是一个加号或减号。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-06T17:48:16.150

你们都忽略了问题的重点-

为什么开发人员必须输入 PIMPL 代码？

对我来说，我能想出的最佳答案是我们没有一种很好的方式来表达允许您对其进行操作的 C++ 代码。例如，编译时（或预处理器，或其他）反射或代码 DOM。

C++ 迫切需要其中一种或两种可供开发人员使用以进行元编程。

然后你可以在你的 public MyClass.h 中写这样的东西：

```
#pragma pimpl(MyClass_private.hpp) 
```

然后编写你自己的，非常简单的包装器生成器。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-06T16:02:59.497

有人会给出比我更冗长的答案，但快速响应有两个方面：编译器需要知道结构的所有成员以确定存储空间要求，编译器需要知道这些成员的顺序以以确定的方式生成偏移量。

语言已经相当复杂了。我认为在代码中拆分结构化数据定义的机制将是一场灾难。

通常，我总是看到用于以 Pimpl 方式定义实现行为的[策略类。](http://en.wikipedia.org/wiki/Policy-based_design)我认为使用策略模式还有一些额外的好处——更容易交换实现，可以轻松地将多个部分实现组合成一个单元，这允许您将实现代码分解为功能性、可重用单元等。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-06T16:02:44.460

可能是因为在通过值传递其实例、在其他类中聚合它等时需要类的大小？

如果 C++ 不支持值语义，它会很好，但它确实支持。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T17:33:28.567

对，但是...

你需要阅读 Stroustrup 的“Design and Evolution of C++”一书。它会抑制 C++ 的使用。

# sql - 谁能推荐一个好的 SQL 解析器？

> ID：269228
> 
> 赞同：5
> 
> 时间：2008-11-06T15:57:39.040
> 
> 标签：sql, database, parsing, ddl

我正在尝试编写一个工具，可以将数据库的架构与安装脚本中的 SQL 进行比较。从数据库中获取信息非常简单，但我在解析安装脚本时遇到了一些麻烦。

我使用了一些出现在 Google 上的解析器，但它们似乎有些不完整。理想情况下，我想找到一个相当稳定并且有一半像样文档的开源解析器。

此外，我并不真正关心特定于某些数据库的类型和语法。需要检查的数据库非常简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T16:32:59.530

I've used [SQL Compare](http://www.red-gate.com/products/SQL_Compare/index.htm?gclid=CLDSg5j94JYCFQOuFQodpTzlPQ) and it's excellent.

You could run the install script to create a new db and then compare the existing db to the new db.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:03:38.577

[通用 SQL 解析器](http://www.sqlparser.com/)是不错的。您可能已经找到了它，但是既然您说 SQL 非常简单，它对您没有什么用？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T16:04:40.557

一些数据库，比如 postgresql，可以让你查询当前的模式。所以你可以换个方向：你可以创建 SQL 语句来查询你需要的字段和表，以查看它们是否在数据库的模式中，而不是尝试获取模式和解析 SQL。

这是一个示例：[postgresql 模式元数据](http://www.alberton.info/postgresql_meta_info.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T16:44:36.060

Seriously, especially for simple databases, your SQL Server has a great SQL parser built in.

Create a schema and load it up. Compare the data, then drop the schema when you're done.

If you're afraid of running the DDL, then perhaps using one of the several, lightweight, embedded servers will do the job for you (like Derby if you run Java).

Then you get the parsed SQL and access to the tables just like you do now.

You have the database, you may as well leverage it if you can.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-26T08:12:34.550

如果您有 DDL 来创建表，请解析表名并为此添加一些生成的表名。根据您使用的 SQL 引擎，您有不同的方式来查询架构：

使用 SQLite：

```
PRAGMA table_info(my_table)
PRAGMA table_info(temporary_my_table) 
```

或在 MySQL 上：

```
 SELECT table_name, column_name, data_type
FROM information_schema.columns
WHERE table_schema = 'my_schema'
AND (table_name LIKE '%my_table'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T16:08:34.277

SQL Server 可能能够为您完成其中的一些工作。它提供了一个非常好的依赖关系树，可以通过 SDK 访问。

# c++ - 有一种方法可以将复制构造函数声明为非公开并使用默认的复制构造函数？

> ID：269241
> 
> 赞同：0
> 
> 时间：2008-11-06T16:02:54.130
> 
> 标签：c++, constructor, copy

我正在开发一个不那么小的类（它经常更改），我不需要提供公共复制构造函数和复制分配。该类具有具有值语义的对象，因此默认复制和分配工作。

该类在层次结构中，具有虚拟方法，因此我提供了一个虚拟 Clone() 以避免切片并执行“多态复制”。

我不想声明复制分配和构造受保护并定义它们（并与更改保持同步），除非我有一些特殊的事情要执行。

有人知道是否还有其他方法吗？

谢谢！

UgaSoft

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T16:25:38.220

来自多态层次结构的对象，具有值语义 ? 这里不对劲。

如果您确实需要您的类具有值语义，请查看 J.Coplien 的 Envelop-Letter Idiom 或这篇关于常规对象的文章 [1]。

[1] 肖恩父。“超越物体”。了解我们编写的软件。[http://stlab.adobe.com/wiki/index.php/Papers_and_Presentations](http://stlab.adobe.com/wiki/index.php/Papers_and_Presentations)。C++ 连接。2005 年 11 月。

高温下，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T16:13:00.553

我认为 C++ 语言中没有任何东西可以让你这样做。虽然我很想在这一点上是错误的。

我过去遇到过这个问题并提出了以下解决方案。假设班级是C1。

1.  定义一个名为 Data 的私有内部类
2.  把我所有我想在 C1 中删除的成员放在数据上
3.  定义一个受保护的复制构造函数，它只在 C1 之间复制 Data 实例。

这种方法有几个缺点。也就是说，它感觉有点不自然，并且消除了直接的字段访问（可以通过小的访问器函数来缓解）。

这是一种迂回的方式来做你正在寻找的事情，但它避免了你必须手动编写复制构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T16:26:10.683

也许我找到了解决方案...

我可以放入我的根基类（或者我可以创建一个小的接口类，没有数据成员，并执行多重继承）这里是空的受保护的复制构造函数。我不会在派生类中重新定义 Copy ctor，如果是默认的就可以了。现在客户端无法访问默认复制ctor（因为无法访问基础），但默认工作！

有人反对吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-04T08:22:06.950

如果你可以使用 C++0x...

```
class A
{
    protected:
        A(const A&) = default;
}; 
```

# windows - 如何在客户机器上调试死锁的 Windows 应用程序

> ID：269243
> 
> 赞同：0
> 
> 时间：2008-11-06T16:03:17.297
> 
> 标签：windows, debugging

我有一个偶尔会死锁的多线程 Windows 应用程序。这不可避免地发生在客户系统上，而不是在软件测试时。获取应用程序当前状态的 Windows Minidump 的最简单方法是什么？如果它也可以终止应用程序，以便用户可以重新启动它并继续使用系统，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:07:23.873

请参阅 Microsoft 支持文章[如何使用 ADPlus 对“挂起”和“崩溃”进行故障排除](http://support.microsoft.com/default.aspx?scid=kb;en-us;Q286350)，以及有用的博客文章[使用 ADPlus 调试生产应用程序](http://mattonsoftware.com/archive/2006/09/21/debugging-production-applications-using-adplus.aspx)。

这两篇文章都是关于“ADPlus”的，这是一个随 Windows 调试工具一起提供的 VBScript 工具，可用于从生产环境生成小型转储（以后可以在开发机器上使用 WinDbg 加载）。ADPlus 有很多功能和很多选项，因此可能需要一些阅读、实验和练习才能找到在您的环境中使用它的最佳方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T16:23:47.910

在 Vista 中，您可以直接从任务管理器创建转储文件。右键单击进程选项卡中的进程，然后选择“创建转储文件”。

在 Vista 之前，我更喜欢 ntsd 路线，因为虽然它并不完全对用户友好，但它无需用户安装任何其他软件即可工作，而且说明实际上很容易遵循。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T16:07:42.203

我知道如何实现这一目标。只是我的技术有点笨拙。所有 Windows 2000 和更高版本的系统都有一个基本的命令行调试器作为默认安装的一部分，称为 NTSD。我现在做的是运行：

```
ntsd -pn MyApp.exe 
```

当调试器控制台出现时，我可以在调试器控制台中输入以下内容：

```
.dump c:\my-deadlock.mdmp
.kill 
```

我正在寻找的是一种更干净、更容易放入电子邮件给客户以便运行的东西。我已经看到它提到某个地方（谷歌暂时找不到），您可以使用 drwtsn32.exe 提取故障转储并终止应用程序。

编辑：可以稍微简化命令：

`ntsd -pn MyApp.exe -c ".dump c:\my-deadlock.mdmp; .kill"`

`.detach`如果进程没有最终挂起（例如长时间的网络超时）并且您希望进程继续运行，则可以发出该命令。

# vba - 事件 - 已编辑文档

> ID：269252
> 
> 赞同：2
> 
> 时间：2008-11-06T16:07:11.627
> 
> 标签：vba, events, ms-word

编辑文档时是否有事件？如果没有，有谁知道我在哪里可以找到可用 VBA 事件的列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:27:55.843

Here are the events for the document object:

[http://msdn.microsoft.com/en-us/library/aa140279(office.10).aspx](http://msdn.microsoft.com/en-us/library/aa140279(office.10).aspx)

**Events**

```
DocumentBeforeClose : Immediately before any open document closes. 
DocumentBeforePrint : Before any open document is printed. 
DocumentBeforeSave : Before any open document is saved. 
DocumentChange : A new document is created, when an existing document is opened, or when another document is made the active document. 
DocumentOpen : A document is opened. 
EPostageInsert : A user inserts electronic postage into a document. 
EPostagePropertyDialog : A user clicks the E-postage Properties (Labels and Envelopes dialog box) button or Print Electronic Postage toolbar button. This event allows a third-party software application to intercept and show their properties dialog box. 
MailMergeAfterMerge : After all records in a mail merge have merged successfully. 
MailMergeAfterRecordMerge : After each record in the data source successfully merges in a mail merge. 
MailMergeBeforeMerge : A merge is executed before any records merge. 
MailMergeBeforeRecordMerge : As a merge is executed for the individual records in a merge. 
MailMergeDataSourceLoad : The data source is loaded for a mail merge. 
MailMergeDataSourceValidate : A user performs address verification by clicking Validate in the Mail Merge Recipients dialog box. 
MailMergeWizardSendToCustom : The custom button is clicked on step six of the Mail Merge Wizard. 
MailMergeWizardStateChange : A user changes from a specified step to a specified step in the Mail Merge Wizard. 
NewDocument : A new document is created. 
Quit : The user quits Word. 
WindowActivate : Any document window is activated. 
WindowBeforeDoubleClick : The editing area of a document window is double-clicked, before the default double-click action. 
WindowBeforeRightClick : The editing area of a document window is right-clicked, before the default right-click action. 
WindowDeactivate : Any document window is deactivated. 
WindowSelectionChange : The selection changes in the active document window. 
WindowSize : The application window is resized or moved. 
```

There are also Auto Macros:

AutoNew, AutoOpen, AutoExec, AutoExit

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-05T18:13:29.140

命令是 WindowSelectionChange

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T15:26:08.717

要拦截任何 Word 命令，您可以：

1.

按 Alt+F8 调出“宏”对话框，在显示“宏输入”的位置，选择“字命令”。

2.

查找并选择您要拦截的命令之一——例如，要拦截您需要查找 FilePrint 和 FilePrintDefault 的打印命令。要拦截保存命令，您需要找到 FileSave、FileSaveAs 和 FileSaveAll

3.

在显示“宏”的位置，选择要存储宏的模板，然后单击“创建”。

4.

执行命令所需的代码将为您编写；只需添加您自己的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-21T08:40:28.107

您可以尝试使用 autohotkey 来监听按键事件，看看我的代码：

[捕获 MS Word 的 keydown 事件](https://stackoverflow.com/questions/31470984/capturing-keydown-event-of-ms-word)

# sql-server - SQL 2005 sql登录ip限制

> ID：269253
> 
> 赞同：2
> 
> 时间：2008-11-06T16:07:14.123
> 
> 标签：sql-server, security, login

有没有办法将 Microsoft SQL Server 2005 标准版（sql 处于混合模式）上的特定 SQL 2005 登录限制为特定 IP 地址，而其他登录（Windows 身份验证的登录）不受影响？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-28T14:49:02.773

我使用以下触发器来限制对特定登录 - IP 组合的访问。

```
CREATE TRIGGER [LOGIN_IP_RESTRICTION]
    ON ALL SERVER FOR LOGON
AS
BEGIN
    DECLARE @host NVARCHAR(255);

    SET @host = EVENTDATA().value('(/EVENT_INSTANCE/ClientHost)[1]', 'nvarchar(max)');

    IF(EXISTS(SELECT * FROM master.dbo.IP_RESTRICTION 
        WHERE UserName = SYSTEM_USER))
    BEGIN
        IF(NOT EXISTS(SELECT * FROM master.dbo.IP_RESTRICTION 
            WHERE UserName = SYSTEM_USER AND ValidIP = @host))
        BEGIN
            ROLLBACK;
        END
    END
END; 
```

表 IP_RESTRICTION 的 DDL：

```
CREATE TABLE [dbo].[IP_RESTRICTION](
    [UserName] [varchar](255) NOT NULL,
    [ValidIP] [varchar](15) NOT NULL,
    [Comment] [nvarchar](255) NULL,
 CONSTRAINT [PK_IP_RESTRICTION] PRIMARY KEY CLUSTERED 
([UserName] ASC, [ValidIP] ASC) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-15T13:05:40.267

是的，你可以这样做。您需要按照此处所述编写登录触发器：

[http://technet.microsoft.com/en-us/library/bb326598.aspx](http://technet.microsoft.com/en-us/library/bb326598.aspx)

在过去的十五分钟里，我一直在玩弄它，但取得的成功有限，但也许这里还有其他人完成了按 IP 地址进行 DDL 登录触发器过滤，可以显示源代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-16T11:52:17.810

**几句警告！**

如果您发现此脚本有**任何**问题，并在您意识到之前注销，您将自己锁定在 SQL Server 之外。

然后，您将需要以最小模式离线重新启动服务器 -f

然后在所有服务器上删除触发器 [LOGIN_IP_RESTRICTION]

那你就有机会回来了。我怎么知道？我刚刚犯了那个错误，在我弄清楚如何重新进入并取下扳机之前，我有一些肠子松动的时刻。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T16:10:50.077

我已将系统上的登录限制为单个 IP 地址，只需使用防火墙即可。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-07T02:05:24.773

SQL Server 可以通过服务器管理器映射到多个端口/IP 配置，但是 AFAIK 没有办法将登录方法绑定到端口/IP。

我唯一能想到的是创建一个触发器 FOR LOGON 并在该触发器内测试事件数据，例如：

SELECT EVENTDATA().value ('(/EVENT_INSTANCE/LoginType)','nvarchar(max)'), EVENTDATA().value ('(/EVENT_INSTANCE/ClientHost)','nvarchar(max)')

...如果您不喜欢您发现的内容，可能会调用 RAISEERROR 或 ROLLBACK 可能会终止连接？

希望这可以帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T02:30:52.243

为什么需要通过 IP 地址进行限制？如果您的所有用户都通过了身份验证，只需在 SQL Server 上设置组权限，并允许或拒绝您想要的组。

如果问题是不同用户使用具有相同 SQL 登录名的应用程序（您提到您使用的是混合模式），那么问题是您为什么要允许使用这些应用程序的某些用户访问 SQL Server，而不允许其他用户？在应用程序中实现安全性，不要在数据库级别反弹它们。

# bison - bison / yacc 是否有现代（例如 CLR）替代品？

> ID：269256
> 
> 赞同：1
> 
> 时间：2008-11-06T16:07:40.690
> 
> 标签：bison

我刚刚重新编写了一些使用野牛编写的类似编译器的旧代码。当我这样做的时候，我想知道现代的等价物是什么？是否有一个不错的 .NET（或类似的）编译器编写框架，它采用 BNF 语法并拆分出一个进行解析的 DLL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T16:11:10.357

还有[ANTLR](http://www.antlr.org)，一个用 Java 实现的非常广泛使用的解析器生成器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T16:38:15.947

我在自己的动态语言解释器中使用 Gardens Point GPPG 和 GPLEX。GPPG 和 GPLEX 已被 Microsoft 采用为 Visual Studio 200x SDK 中的 MPPG 和 MPLEX。这意味着为您的语言的语法着色创建 Visual Studio 语言扩展非常容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T16:09:14.260

查看 Gardens Point 解析器生成器。这是一个类似 YACC/BISON 的 C# 实现

[GPPG](http://plas.fit.qut.edu.au/gppg/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T16:24:12.420

我推荐[Coco/R](http://www.ssw.uni-linz.ac.at/coco/)。它与 JavaCC 非常相似。支持 C#、Java、C++、F#、VB.Net、Oberon 和其他语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T16:11:27.687

一个快速的谷歌搜索发现了[Gardens Point Parser Generator](http://plas.fit.qut.edu.au/gppg/)。

# c# - 在内存中查找 DLL 的地址

> ID：269263
> 
> 赞同：3
> 
> 时间：2008-11-06T16:09:47.737
> 
> 标签：c#, dll, addressing

我刚刚进入低级编程（读/写内存之类的东西）并且遇到了一个我找不到答案的问题。

我要读取的信息有一个地址，该地址与内存中加载的 DLL 相关，例如，它位于 mydll.dll + 0x01234567。我遇到的问题是 dll 在内存中移动，但偏移量保持不变。无论如何要找出这个dll在内存中的位置。

我目前正在尝试最好在 c# 中执行此操作，但我将感谢大多数高级语言的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T14:05:39.063

我尝试了 Rob Walker 建议的方法，但无法让它工作（我认为它不起作用，因为 dll 是作为另一个可执行文件的一部分加载的，所以不容易找到）。

然而，我确实发现了一个对我有用的解决方案，所以这里是：

我创建了一个 Process 类型的对象

```
String appToHookTo = "applicationthatloadedthedll";
Process[] foundProcesses = Process.GetProcessesByName(appToHookTo)
ProcessModuleCollection modules = foundProcesses[0].Modules;
ProcessModule dllBaseAdressIWant = null;
foreach (ProcessModule i in modules) {
if (i.ModuleName == "nameofdlliwantbaseadressof") {
                    dllBaseAdressIWant = i;
                }
        } 
```

现在您有了模块，您只需执行 dllbaseAdressIWant.BaseAddress 即可获取值。

希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:19:05.580

从 Win32 的角度来看，您需要使用[GetModuleHandle](http://msdn.microsoft.com/en-us/library/ms683199(VS.85).aspx)和[GetModuleInformation](http://msdn.microsoft.com/en-us/library/ms683201(VS.85).aspx)函数。这些使您可以按名称查找模块句柄，然后检索信息，包括有关该句柄的基地址。

使用标准 P/Invoke 包装器包装这些 API 应该很简单。

# excel - Excel 电子表格中的多个单元格背景颜色

> ID：269267
> 
> 赞同：5
> 
> 时间：2008-11-06T16:10:57.703
> 
> 标签：excel, formatting, vba

Excel 在“格式”菜单下有一个条件格式...选项，可让您根据其值更改单元格的样式/颜色/字体/任何内容。但它只允许三个条件。

如何让 Excel 根据单元格的值显示六种不同的背景单元格颜色？（IE 如果值为“红色”，则使单元格变为红色，如果值为“蓝色”，则变为蓝色等）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T16:14:19.350

您将需要在 VBA 中编写一些内容。

请参阅此处的示例：[Get Around Excels 3 Criteria Limit in Conditional Formatting](http://www.ozgrid.com/VBA/excel-conditional-formatting-limit.htm)：

```
Private Sub Worksheet_Change(ByVal Target As Range)

Dim icolor As Integer

    If Not Intersect(Target, Range("A1:A10")) is Nothing Then

        Select Case Target

            Case 1 To 5
                icolor = 6
            Case 6 To 10
                icolor = 12
            Case 11 To 15
                icolor = 7
            Case 16 To 20
                icolor = 53
            Case 21 To 25
                icolor = 15
            Case 26 To 30
                icolor = 42
            Case Else
                'Whatever
        End Select

        Target.Interior.ColorIndex = icolor
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T16:50:54.597

Excel 2007 允许三个以上的条件。引用[此 Microsoft 页面](http://msdn.microsoft.com/en-us/library/bb286672(office.11).aspx)：

编辑：啊，链接代码中有一个“功能”：括号中引用的链接中的括号没有得到正确处理。该链接是： http: [//msdn.microsoft.com/en-us/library/bb286672 (office.11​​).aspx](http://msdn.microsoft.com/en-us/library/bb286672(office.11).aspx)

> Excel 2007 中条件格式更改的其他好处是能够指定三个以上的条件、重新排序条件以及将多个条件解析为 True。

除此以外。恐怕您会陷入所描述的混乱替代方案中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-07T22:03:45.823

把它放在你的 VBA 项目中的一个模块中。然后，您可以突出显示工作表中的一个范围，并从“工具”>“宏”>“宏”菜单项运行子程序，为所选范围内的每个单元格着色。

```
Public Sub ColorCells()

Dim cell, rng As Range
Dim color As Integer
Dim sheet As Worksheet

Application.ScreenUpdating = False
Application.StatusBar = "Coloring Cells"

    Set rng = Application.Selection
    Set sheet = Application.ActiveSheet

For Each cell In rng.cells

        Select Case Trim(LCase(cell))

            Case "blue"

                color = 5

            Case "red"

                color = 3

            Case "yellow"

                color = 6

            Case "green"

                color = 4

            Case "purple"

                color = 7

            Case "orange"

                color = 46

            Case Else

                color = 0
        End Select

    sheet.Range(cell.Address).Interior.ColorIndex = color

Next cell

Application.ScreenUpdating = True
Application.StatusBar = "Ready"

End Sub 
```

如果用户在单元格中输入新的颜色名称，那么您可以将其放在 VBA 项目的工作表代码中，以便在用户将颜色名称输入单元格时为单元格着色

```
Private Sub Worksheet_Change(ByVal Target As Range)

If Target.cells.Count > 1 Then Exit Sub

Dim color As Integer

        Select Case Trim(LCase(Target))

            Case "blue"

                color = 5

            Case "red"

                color = 3

            Case "yellow"

                color = 6

            Case "green"

                color = 4

            Case "purple"

                color = 7

            Case "orange"

                color = 46

            Case Else

                color = 0

        End Select

Target.Interior.ColorIndex = color

End Sub 
```

编辑：在 case 语句表达式周围添加了 Trim 函数以进行测试，以便忽略单元格中的意外前导/尾随空格:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T00:33:56.597

您可以使用 VBA 宏来执行此操作...

这是一个 vba 宏，如果需要很多案例，可能会更好 [http://chandoo.org/wp/2008/10/14/more-than-3-conditional-formats-in-excel/](http://chandoo.org/wp/2008/10/14/more-than-3-conditional-formats-in-excel/)

您需要以您想要格式化整个范围的方式预先格式化“n”个单元格。然后使用该网址中的宏来获得效果。

# c++ - 如何在 C++ 中实现大 int

> ID：269268
> 
> 赞同：81
> 
> 时间：2008-11-06T16:11:02.213
> 
> 标签：c++, biginteger, bignum, largenumber

我想在 C++ 中实现一个大的 int 类作为编程练习——一个可以处理大于 long int 的数字的类。我知道已经有几个开源实现，但我想自己编写。我试图了解正确的方法是什么。

我了解一般策略是将数字作为字符串获取，然后将其分解为较小的数字（例如单个数字），并将它们放入数组中。此时，实现各种比较运算符应该相对简单。我主要关心的是如何实现加法和乘法。

我正在寻找一种通用的方法和建议，而不是实际的工作代码。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-06T20:59:34.097

一个有趣的挑战。:)

我假设您想要任意长度的整数。我建议采用以下方法：

考虑数据类型“int”的二进制性质。考虑使用简单的二进制运算来模拟 CPU 中的电路在添加事物时所做的事情。如果您有更深入的兴趣，请考虑阅读[有关半加器和全加器的维基百科文章](http://en.wikipedia.org/wiki/Half_adder)。你会做类似的事情，但你可以降到最低水平 - 但是因为懒惰，我想我会放弃并找到一个更简单的解决方案。

但在讨论任何关于加、减、乘的算法细节之前，让我们先了解一些数据结构。当然，一种简单的方法是将内容存储在 std::vector 中。

```
template< class BaseType >
class BigInt
{
typedef typename BaseType BT;
protected: std::vector< BaseType > value_;
}; 
```

您可能需要考虑是否要制作固定大小的向量以及是否要预分配它。原因是对于不同的操作，您必须遍历向量的每个元素 - O(n)。您可能想知道一个操作的复杂程度，而一个固定的 n 就是这样做的。

但是现在来一些关于对数字进行操作的算法。您可以在逻辑级别上执行此操作，但我们将使用这种神奇的 CPU 能力来计算结果。但是我们将从 Half-Adders 和 FullAdders 的逻辑说明中接替的是它处理进位的方式。例如，考虑如何实现**+= 运算符**。对于 BigInt<>::value_ 中的每个数字，您将添加它们并查看结果是否产生某种形式的进位。我们不会按位进行，而是依赖于 BaseType 的性质（无论是 long 还是 int 或 short 或其他）：它会溢出。

当然，如果您将两个数字相加，结果一定大于这些数字中较大的一个，对吧？如果不是，则结果溢出。

```
template< class BaseType >
BigInt< BaseType >& BigInt< BaseType >::operator += (BigInt< BaseType > const& operand)
{
  BT count, carry = 0;
  for (count = 0; count < std::max(value_.size(), operand.value_.size(); count++)
  {
    BT op0 = count < value_.size() ? value_.at(count) : 0, 
       op1 = count < operand.value_.size() ? operand.value_.at(count) : 0;
    BT digits_result = op0 + op1 + carry;
    if (digits_result-carry < std::max(op0, op1)
    {
      BT carry_old = carry;
      carry = digits_result;
      digits_result = (op0 + op1 + carry) >> sizeof(BT)*8; // NOTE [1]
    }
    else carry = 0;
  }

  return *this;
}
// NOTE 1: I did not test this code. And I am not sure if this will work; if it does
//         not, then you must restrict BaseType to be the second biggest type 
//         available, i.e. a 32-bit int when you have a 64-bit long. Then use
//         a temporary or a cast to the mightier type and retrieve the upper bits. 
//         Or you do it bitwise. ;-) 
```

其他算术运算也类似。哎呀，您甚至可以使用 stl 函子 std::plus 和 std::minus，std::times 和 std::divides，...，但请注意进位。:) 您还可以通过使用加号和减号运算符来实现乘法和除法，但这非常慢，因为这会重新计算您在每次迭代中之前调用加号和减号时已经计算的结果。对于这个简单的任务，有很多很好的算法，[使用](http://en.wikipedia.org/wiki/Multiplication_algorithm) [维基百科](http://en.wikipedia.org/wiki/Division_algorithm)或网络。

当然，您应该实现标准运算符，例如`operator<<`（只需将 value_ 中的每个值向左移动 n 位，从`value_.size()-1`... 开始，记住进位 :)，`operator<`-您甚至可以在这里进行一些优化，检查粗略的位数`size()`。等等。然后通过 befriendig std::ostream 让你的课程变得有用`operator<<`。

希望这种方法有帮助！

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-11-06T16:18:47.063

大型 int 类需要考虑的事项：

1.  数学运算符：+、-、/、*、% 不要忘记您的类可能位于运算符的任一侧，运算符可以链接，其中一个操作数可以是 int、float、double 等.

2.  I/O 操作符：>>、<< 在这里，您可以了解如何根据用户输入正确创建类，以及如何格式化输出。

3.  转换/强制转换：弄清楚你的大 int 类应该转换成哪些类型/类，以及如何正确处理转换。快速列表将包括 double 和 float，并且可能包括 int（带有适当的边界检查）和 complex（假设它可以处理范围）。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-11-06T20:00:17.773

有一个完整的部分：[计算机编程的艺术，第 2 卷：半数值算法，第 4.3 节多精度算术，第 265-318 页（第 3 版）]。您可能会在第 4 章“算术”中找到其他有趣的材料。

如果您真的不想查看其他实现，您是否考虑过您要学习的内容是什么？有无数的错误要犯，发现这些错误是有益的，也是危险的。在识别重要的计算经济和具有适当的存储结构以避免严重的性能问题方面也存在挑战。

给你的一个挑战问题：你打算如何测试你的实现以及你打算如何证明它的算术是正确的？

您可能希望对另一个实现进行测试（而不看它是如何做到的），但是要进行概括而不期望进行令人痛苦的测试水平，这将需要更多的时间。不要忘记考虑故障模式（内存不足问题、堆栈不足、运行时间过长等）。

玩得开心！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-11-06T16:20:38.043

加法可能必须在标准线性时间算法中完成，
但对于乘法，您可以尝试[http://en.wikipedia.org/wiki/Karatsuba_algorithm](http://en.wikipedia.org/wiki/Karatsuba_algorithm)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-06T16:14:06.357

一旦您在数组中获得了数字的数字，您就可以像普通手写一样进行加法和乘法运算。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-06T16:15:47.053

不要忘记您不需要将自己限制为 0-9 作为数字，即使用字节作为数字 (0-255)，您仍然可以像处理十进制数字一样进行长手算术。你甚至可以使用一个 long 数组。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-06T16:22:03.873

我不相信使用字符串是正确的方法——尽管我自己从未编写过代码，但我认为使用基本数字类型的数组可能是更好的解决方案。这个想法是，您只需扩展您已经拥有的内容，就像 CPU 将单个位扩展为整数一样。

例如，如果你有一个结构

```
typedef struct {
    int high, low;
} BiggerInt; 
```

然后，您可以手动对每个“数字”（在本例中为高位和低位）执行本机操作，同时注意溢出条件：

```
BiggerInt add( const BiggerInt *lhs, const BiggerInt *rhs ) {
    BiggerInt ret;

    /* Ideally, you'd want a better way to check for overflow conditions */
    if ( rhs->high < INT_MAX - lhs->high ) {
        /* With a variable-length (a real) BigInt, you'd allocate some more room here */
    }

    ret.high = lhs->high + rhs->high;

    if ( rhs->low < INT_MAX - lhs->low ) {
        /* No overflow */
        ret.low = lhs->low + rhs->low;
    }
    else {
        /* Overflow */
        ret.high += 1;
        ret.low = lhs->low - ( INT_MAX - rhs->low ); /* Right? */
    }

    return ret;
} 
```

这是一个有点简单的例子，但它应该是相当明显的，如何扩展到一个结构，该结构具有你正在使用的任何基本数字类的可变数量。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-11-06T16:14:39.147

使用你在一年级到四年级学到的算法。
从个位列开始，然后是十位，依此类推。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-06T16:19:49.760

就像其他人说的那样，以老式的长手方式进行操作，但不要在基数 10 中执行此操作。我建议在基数 65536 中执行所有操作，并将内容存储在长数组中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-06T16:20:45.670

如果您的目标体系结构支持数字的 BCD（二进制编码的十进制）表示，您可以获得一些硬件支持，以支持您需要执行的普通乘法/加法。让编译器发出 BCD 指令是您必须阅读的内容......

摩托罗拉 68K 系列芯片具有此功能。并不是说我很苦或什么。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-06T16:34:31.463

我的开始是有一个任意大小的整数数组，使用 31 位和 32 位作为溢出。

起始操作将是 ADD，然后是 MAKE-NEGATIVE，使用 2 的补码。在那之后，减法变得微不足道，一旦你有了加法/减法，其他一切都是可行的。

可能有更复杂的方法。但这将是数字逻辑的幼稚方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-05T01:01:28.457

可以尝试实现这样的事情：

[http://www.docjar.org/html/api/java/math/BigInteger.java.html](http://www.docjar.org/html/api/java/math/BigInteger.java.html)

单个数字 0 - 9 只需要 4 位

因此，一个 Int Value 每个最多允许 8 位数字。我决定坚持使用一组字符，所以我使用双倍的内存，但对我来说它只被使用了 1 次。

此外，当将所有数字存储在一个 int 中时，它会使它过于复杂，如果有的话，它甚至可能会减慢它的速度。

我没有进行任何速度测试，但查看 Java 版本的 BigInteger 似乎它做了很多工作。

对我来说，我做以下

```
//Number = 100,000.00, Number Digits = 32, Decimal Digits = 2.
BigDecimal *decimal = new BigDecimal("100000.00", 32, 2);
decimal += "1000.99";
cout << decimal->GetValue(0x1 | 0x2) << endl; //Format and show decimals.
//Prints: 101,000.99 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-08-07T08:58:44.533

计算机硬件提供了存储整数和对其进行基本算术运算的便利；通常这仅限于某个范围内的整数（例如，最多 2^{64}-1）。但是可以通过程序支持更大的整数；下面是一种这样的方法。

使用*位置数字系统*（例如流行的 base-10 数字系统），任何任意大的整数都可以表示为base中的*数字*`B`序列。因此，此类整数可以存储为 32 位整数数组，其中每个数组元素都是 base 中的一个数字`B=2^{32}`。

我们已经知道如何使用带有 base 的数字系统来表示整数`B=10`，以及如何在这个系统中执行基本的算术运算（加、减、乘、除等）。执行这些操作的算法有时被称为教科书算法。我们可以将这些 Schoolbook 算法应用（进行一些调整）到任何 base `B`，因此可以对 base 中的大整数实现相同的操作`B`。

要将这些算法应用于任何 base `B`，我们需要进一步了解它们并处理以下问题：

*   在这些算法中产生的各种中间值的范围是多少。

*   迭代加法和乘法产生的最大进位是多少。

*   如何估计长除法中的下一个商数。

（当然，可以有其他算法来执行这些操作）。

可以在[此处](http://bioinfo.ict.ac.cn/%7Edbu/AlgorithmCourses/Lectures/Lec5-Fast-Division-Hasselstrom2003.pdf)（初始章节）、[此处](https://mathsanew.com/articles/implementing_large_integers_introduction.pdf)（由我编写）和[此处](https://members.loria.fr/PZimmermann/mca/mca-cup-0.5.3.pdf)找到一些算法/实现细节。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2010-03-12T17:02:34.037

从您的整数字符串中减去 48 并打印以获取大位数。然后执行基本的数学运算。否则我将提供完整的解决方案。

# asp.net-mvc - ASP.NET MVC 验证问题

> ID：269285
> 
> 赞同：0
> 
> 时间：2008-11-06T16:18:09.577
> 
> 标签：asp.net-mvc

我有这个简单的控制器：

```
public class OneController : Controller
{
    [AcceptVerbs(HttpVerbs.Get)]
    public ActionResult Create()
    {
        return View();
    }

    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(IList<TestModel> m)
    {
        return View(m);
    }
} 
```

还有一个非常简单的视图，其中包含两个 TestModel 类型的对象，并正确索引。当我提交包含无效数据的表单时，我会看到突出显示错误的视图。但是，当我重新提交它（不更改任何内容）时，我收到此错误：

> [NullReferenceException：对象引用未设置为对象的实例。] System.Web.Mvc.DefaultModelBinder.UpdateCollection(ModelBindingContext bindingContext, Type itemType) +612 System.Web.Mvc.DefaultModelBinder.BindModelCore(ModelBindingContext bindingContext) +519 System. Web.Mvc.DefaultModelBinder.BindModel(ModelBindingContext bindingContext) +829 System.Web.Mvc.ControllerActionInvoker.GetParameterValue(ParameterInfo parameterInfo) +313 System.Web.Mvc.ControllerActionInvoker.GetParameterValues(MethodInfo methodInfo) +399 System.Web.Mvc.ControllerActionInvoker .InvokeAction(ControllerContext controllerContext, String actionName) +232 System.Web.Mvc.Controller.ExecuteCore() +152 System.Web.Mvc.ControllerBase。执行(RequestContext requestContext) +86 System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +28 System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext) +332 System.Web.Mvc .MvcHandler.ProcessRequest(HttpContext httpContext) +55 System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +28 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +358 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +64Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext) +55 System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +28 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute( ) +358 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +64Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext) +55 System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +28 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute( ) +358 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +64

关于如何调试这个的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T18:55:29.027

我已经在看那篇文章，并发现了我遇到的错误（微妙，但很关键）。如果您使用 Html.Hidden 使用索引呈现隐藏字段，帮助程序将“累积”先前的值，因此您最终会得到一个隐藏的说法 index=1，下一个说法 index=1,2。

将助手调用更改为手动编码的隐藏字段修复了该问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T18:24:24.207

不确定我是否可以在没有看到更多代码以及您的表单设置方式的情况下回答。但是，您可以查看[Phil Haack关于](http://www.haacked.com)[模型绑定到列表](http://www.haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)的博客文章。
希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-09T02:00:49.867

谢谢你修复它！

我换了

```
<%= Html.Hidden("submitFormFields.index", controlID) %> 
```

和

```
<input type="hidden" id="submitFormFields.index" name="submitFormFields.index" value="<%=controlID %>" /> 
```

我们是否应该将此报告为错误 - 为 ASP.Net MVC RC1 修复它会很好

# python - What mime-type should I return for a python string

> ID：269292
> 
> 赞同：3
> 
> 时间：2008-11-06T16:19:58.590
> 
> 标签：python, http, mime-types

I have a web API that returns python dictionaries or lists as a response that I eval() in python scripts that use the API, for completness I wanted to set a proper content-type but not sure what would be best to use "text/x-python" or maybe "application/python", or something else?

[edit] I'm also outputting JSON, I'm doing Python as an option mainly for internal use.[/edit]

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T16:38:35.510

I doubt there's an established MIME type. Have you considered using JSON instead, it is almost the same as a Python dict, and has a better established culture of tools and techniques.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-07T12:59:35.877

The authoritative registry is [at IANA](http://www.iana.org/assignments/media-types/) and, no, there is no standard subtype for Python. So, do not use type like "application/python" but you may use private subtypes such as "text/x-python" (the one I find in the mime-support package on my Debian).

# css - 显示未知长度的字符串时，最好的 UI/CSS 组合是什么？

> ID：269298
> 
> 赞同：6
> 
> 时间：2008-11-06T16:20:42.020
> 
> 标签：css, user-interface, list

我有一个在浮动列表中显示的项目列表，列表中的每个项目都具有固定宽度，因此每行有两个。防止这种可怕事情发生的最佳做法是什么：

[替代文字 http://x01.co.uk/floated_items.gif](http://x01.co.uk/floated_items.gif)

可能性：

*   在显示数据之前修剪到指定数量的字符。需要猜测有多少字符是“安全的”。
*   溢出：隐藏。哈基。
*   删除背景，每个项目只有一个顶部边框。

可能但很愚蠢：

*   通过溢出在每个项目中都有一个滚动条：自动，这看起来很可怕。
*   将背景图像添加到容器中。不能保证总是有相同数量的项目，所以这个选项不可用。

对这个恼人的问题的任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:26:43.833

您是否使用固定字体大小，即以 px 为单位指定？如果不是，您还需要考虑每个浏览器的各种文本大小选项，这可能会使修剪字符串的概念变得多余。如果它已修复，那么可能会查看您可以放入多少个 W 并将您的文本限制为该 -3 并附加一个省略号，不确定该列表的用途，所以这是一种方法。

就我个人而言，我可能会使用溢出：隐藏，因为它涵盖了所有可能发生的情况并确保它始终保持您的布局一致。

我想最后一个选择是严格控制可以添加到列表中的内容，并首先防止问题发生。正如他们所说，预防胜于治疗，尽管可能无济于事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:32:07.210

有一些脚本可以通过比较两个块中的 li 并使它们都等于最高的来帮助解决这个问题。

通常，与其从 css 的角度思考什么是最好的，不如考虑你想要什么样的演示文稿，然后让 css/JavaScript 达到你想要的效果。

如果这只是您想要的，请考虑使用渐变背景图像突出显示 li 的顶部并建议该块而不实际填充它。

* * *

添加链接到 jQuery 解决方案：[均衡](http://plugins.jquery.com/project/equalizeCols)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T16:51:48.730

一种解决方案是使用基于 alpha 的 PNG，它会在最后 10px 左右将文本慢慢淡化为容器的背景色。如果某些文本比长文本短得多，那看起来会很好，但是在文本等于容器的情况下，它可能看起来有点傻。

当然，结合 display: hidden 和 white-space: no-wrap

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T11:22:06.757

从可访问性的角度来看，简单地隐藏标题并不是一个好主意，因为这可能会隐藏因视力不佳而增加字体大小的人的内容。当你的设计被糟糕的分辨率或类似的障碍物击中时，它应该能够漂浮，即使它漂浮在不那么令人赏心悦目的东西上。

现在，如果我正确理解您的背景图像问题，我相信您的问题可以使用 ALA 关于[滑动门](http://www.alistapart.com/articles/slidingdoors/)的文章中描述的技术来解决，其中背景图像随内容扩展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T11:26:36.577

这里有一些争议给你..使用桌子？

听起来您对我来说有一个数据网格，表格可以为您解答这个问题吗？

它还提出了一个问题，您是否真的希望这些项目具有相同的高度，或者只是在它们后面有相同数量的黑色背景？您可以将黑色应用于行的背景，然后创建带有边框和边距的中心白色分隔符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-08T17:43:52.370

您可以尝试使用：

```
ul li{
  display:block;
  float:left;
  width:6em;
  height:4em;
  background-color:black;
  color:white;
  margin-right:1em;
}
ul{
  height:100%;
  overflow:hidden;
}
div{
  height:3em;
  overflow:hidden;
  background-color:blue;
} 
```

虽然不知道跨浏览器一致性。编辑：这是我假设的 html：

```
<div>
<ul>
<li>asdf
<li>asdf trey  tyeu ereyuioquoi
<li>fdas dasf erqwt ytwere r
<li>dfsaklñd s jfañlsdjf ñkljdk ñlfas
<li>ksdflñajñldsafjñlksdjfñalksdfjlkdhfc,v.mxzn
</ul>
</div> 
```

# java - 匿名课程是个坏主意吗？

> ID：269303
> 
> 赞同：8
> 
> 时间：2008-11-06T16:23:23.233
> 
> 标签：java

在使用了一段时间之后，我不禁觉得在使用匿名类时你被迫跳过的圈子是不值得的。

你最终会得到`final`所有的地方，无论什么代码都比你使用命名良好的内部类更难阅读。

那么使用它们有什么好处呢？我肯定错过了什么。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T16:26:43.880

优点是它是闭包的实现。它很笨重，但它是目前我们在 Java 中最好的。换句话说，您不必仅仅为了保留您已经在某处作为局部变量获得的某些状态而创建一个新类。

我有[一篇比较 C# 和 Java 闭包的文章](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)，以及为什么它们首先有用，这可能会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T16:33:18.390

好吧，我通常只在需要为单一目的实现接口时才使用它（以及具有很少功能的接口或代码，因为真的很快丑陋）......就像下面的例子：

```
this.addListener(new IListener(){
    public void listen() {...}
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T16:26:36.923

我通常将匿名类限制为几行。任何比 5 长的东西，都可以创建一个命名类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T16:41:39.967

我向您推荐[这篇](http://www.developer.com/java/other/article.php/3300881)我觉得很有启发性的文章。

您说**final**关键字无处不在，但是对于本地类，您仍然必须传递封闭类的状态，这也可能不利于可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-03T21:02:28.810

Anynomous 类可能很有用。但是我经常看到的并没有用。很多匿名类太大，降低了可读性。一些专家使用许多相同的匿名类。何时使用匿名类是个好主意，但没有严格的规则，但有一些经验法则：

1.  大而复杂的类不应该是匿名的。

2.  必须保证容器类的可读性。

3.  干燥 - 不要重复自己。不要创建两个相同的匿名类。

4.  如果您有很多不相同但相似的匿名类，那么您应该确定这些类中可以重用的部分。尝试使用模板方法模式。

减少冗余对于代码和软件的质量很重要。“复制和粘贴”是编程中的一种反模式，因为原始代码段可能包含错误。如果有人复制那段代码，那么他就会复制错误。十周后，其他人发现了该错误并修复了它，但另一个错误仍在代码中，并且需要额外的十周时间才能找到并修复它。W

# windows-vista - Autorun.inf - 未指定发布者

> ID：269308
> 
> 赞同：3
> 
> 时间：2008-11-06T16:24:34.370
> 
> 标签：windows-vista, autorun

我有以下 autorun.inf

```
[Autorun]
action="Blah, Inc."
open=marketing.exe
icon=blah.ico
label="Blah, Inc." 
```

在 Vista 上，自动运行对话框显示“未指定发布者”。如何指定发布者？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T17:28:50.933

Bogdan 是对的：你需要签署你的可执行文件。为此，您可以使用Microsoft 的*SignTool*。取自[MSDN](http://msdn.microsoft.com/en-us/library/aa387764.aspx)：

> *SignTool 工具是一个命令行工具，用于对文件进行数字签名、验证文件中的签名或为文件添加时间戳。(...) 该工具安装在 Microsoft Windows 软件开发工具包 (SDK) 安装路径的 \Bin 文件夹中。SignTool 作为 Windows SDK 的一部分提供，您可以将其作为适用于 Windows Server 2008 和 .NET Framework 3.5 的 Windows SDK 的一部分下载。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T17:18:59.640

您可以通过签署可执行文件来指定发布者，而不是通过将其写入 autorun.inf 文件。

怎么做...打败我，我是一名 Java 开发人员。也许别人可以告诉你怎么做。

# data-binding - 如何使用 ObjectDataSource 在代码中将数据表正确设置为网格视图？

> ID：269309
> 
> 赞同：0
> 
> 时间：2008-11-06T16:24:47.160
> 
> 标签：data-binding, datatable, objectdatasource

我在网页上有一个 ID 为 ObjectDataSource1 的 ObjectDataSource。我还有一个 gridview，我在其中将 ObjectDataSource.ID 绑定到 GridView.DataSourceID。我遇到的问题是，当文本框中的文本发生更改时，代码调用 BrokerageTransactions.GetAllWithDt，它返回一个 DataTable。我想将此数据表设置为 GridView 的 DataSource，但它告诉我不能将 DataSouce 和 DataSourceId 设置在一起。我怎样才能解决这个问题？代码如下。还。为什么在使用 ObjectDataSource 时不能设置 DataSourceID 和 DataSource？

谢谢，X

```
protected void BrokerageChange(Object sender, EventArgs e)
{
    BrokerageTransactions brokerageaccountdetails = 
                          new BrokerageTransactions();

    DataSet ds = BrokerageAccount.GetBrkID2(new 
                 Guid(Membership.GetUser().ProviderUserKey.ToString()), 
                 ddlBrokerageDetails.SelectedItem.Text.ToString());

    foreach (DataRow dr in ds.Tables[0].Rows)
    {
        brokerageaccountdetails.BrokerageId = 
                                new Guid(dr["BrkrgId"].ToString());
    }

    ddlBrokerageDetails.SelectedItem.Value = 
                        brokerageaccountdetails.BrokerageId.ToString();

    if (txtTransactionsTo.Text != "" 
        && txtTransactionsFrom.Text != "")
        ObjectDataSource1.FilterExpression = 
        "convert(CreateDt,System.DateTime)>Convert('" + 
         Convert.ToDateTime(txtTransactionsFrom.Text) + "',System.DateTime) 
         and Convert(CreateDt,System.DateTime)<convert('"
         + Convert.ToDateTime(txtTransactionsTo.Text.ToString()) + 
         "',System.DateTime)";
    else if (txtTransactionsFrom.Text != "")
            ObjectDataSource1.FilterExpression =
            "convert(CreateDt,System.DateTime)>convert('" +
             Convert.ToDateTime(txtTransactionsFrom.Text) + 
            "',System.DateTime)";
    else if (txtTransactionsTo.Text != "")
            ObjectDataSource1.FilterExpression = 
            "convert(CreateDt,System.DateTime)
            <convert('" 
            + Convert.ToDateTime(txtTransactionsTo.Text.ToString()) +  
            "',System.DateTime)";
    else
        ObjectDataSource1.FilterExpression = " ";

    grvBrokerage.DataSourceID = ObjectDataSource1.ID;
    grvBrokerage.DataBind();

    DateTime dtTransFrom = Convert.ToDateTime("1/1/1900");
    DateTime dtTransTo = System.DateTime.Today;

    //TransactionsTo Box is Empty
    if ((txtTransactionsFrom.Text.Length > 2) 
    && (txtTransactionsTo.Text.Length < 2)) 
    {
        dtTransFrom = Convert.ToDateTime(txtTransactionsFrom.Text);
        dtTransTo = System.DateTime.Today;
    }

    //TransactionsFrom Box is Empty
    if ((txtTransactionsFrom.Text.Length < 2) 
    && (txtTransactionsTo.Text.Length > 2))
    {
       dtTransFrom = Convert.ToDateTime("1/1/1900");
       dtTransTo = Convert.ToDateTime(txtTransactionsTo.Text);
    }

    //TransactionsFrom Box and TransactionsTo Box is Not Empty
    if ((txtTransactionsFrom.Text.Length > 2) 
    && (txtTransactionsTo.Text.Length > 2))
    {
        dtTransFrom = Convert.ToDateTime(txtTransactionsFrom.Text);
        dtTransTo = Convert.ToDateTime(txtTransactionsTo.Text);
    }
    // Fails Here
    grvBrokerage.DataSource = 
    BrokerageTransactions.GetAllWithDt(brokerageaccountdetails.BrokerageId, 
                                       dtTransFrom, 
                                       dtTransTo);
    grvBrokerage.DataBind();  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T16:42:26.237

你有两个选择：

*   根本不要使用 ObjectDataSource。您只需使用 DataSource 属性并每次都以语法方式设置它。
*   您使用 GridView 的 DataSourceID 属性并添加 2 个普通 asp:Parameters 并设置默认值。在 ObjectDataSource_Selecting 事件中，您可以通过 e.InputParameters[] 设置这些参数

希望这可以帮助。

# c# - .Net 数据处理建议

> ID：269310
> 
> 赞同：1
> 
> 时间：2008-11-06T16:25:12.340
> 
> 标签：c#, .net, database, persistence, text-files

我刚开始写一个应用程序。它需要做的部分工作是对营养信息数据库进行查询。我所拥有的是美国农业部的[SR21 数据集](http://www.ars.usda.gov/Services/docs.htm?docid=17478)，格式为平面分隔的 ASCII 文件。

我需要的是建议。我正在寻找将这些数据导入应用程序并在运行时轻松快速地查询它的最佳方法。我会将它用于所有标准的东西。动态填充控件、数据网格、计算等。我还需要进行用户特定的持久数据存储。这不会是一个商业应用程序，所以希望这会打开可能性。我对 .Net Framework 3.5 很好，所以在访问数据时可以使用 Linq（只是不知道它是否是最好的解决方案）。那么，对于这种场景下的持久化存储有哪些建议呢？我应该注意什么样的陷阱？当然，总是很欣赏示例的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T16:28:52.987

它看起来很小，所以我会制定一个合适的对象模型，将全部加载到内存中，然后使用 LINQ to Objects。

我不太确定您在“持久存储”方面要问什么-您不只是在读取数据吗？你不是已经在文本文件中有了吗？我不知道你为什么要介绍其他东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T16:30:20.177

我会将平面文件导入 SQL Server 并通过标准 ADO.NET 功能进行访问。就数据查询和操作而言，数据库访问不仅总是比文件 I/O 更好（更健壮和强大），而且您还可以利用 SQL Server 的缓存功能，特别是因为这些营养数据也不会改变经常。

如果您需要定期下载更新的平面文件，那么请考虑开发一种服务来轮询这些文件并自动导入 SQL Server。

编辑：我指的是 SQL Server，但可以随意使用任何 DBMS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T16:31:21.000

我的想法是将数据导入 SQL Server（如果您不打算部署应用程序，请使用 Express），因为它对我来说是一个熟悉的来源。或者，您可以使用文本文件处理程序创建一个 ODBC 数据源，以获得类似数据库的连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T16:57:18.967

我同意您将从数据库中受益，特别是对于快速查询，如果您正在保存用户对数据的更改，则更是如此。为了将平面文件数据加载到 SQL Server（包括 Express）中，您可以使用 SSIS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-20T05:14:34.707

使用 Linq 或文本数据列出方法

1.创建一个列表。

2.逐行（或所有行）读取文本文件。

3.处理线路 - 获取所需数据并附加到列表中。

4.处理列表以供进一步使用。

持久性存储将是文件，而 List 是易失的。

# c - 有没有比解析 /proc/self/maps 更好的方法来找出内存保护？

> ID：269314
> 
> 赞同：18
> 
> 时间：2008-11-06T16:26:08.937
> 
> 标签：c, linux, system-calls, mprotect, virtualquery

在 Linux（或 Solaris）上，有没有比`/proc/self/maps`反复手动解析更好的方法来确定您是否可以读取、写入或执行存储在内存中一个或多个地址的任何内容？

例如，在 Windows 中，您有`VirtualQuery`.

在 Linux 中，我可以`mprotect`更改这些值，但我无法将它们读回。

此外，除了做一些非常侵入性的事情并在进程中的所有线程上使用并拦截任何可能影响内存的尝试之外，还有什么方法可以知道这些权限何时更改（例如，当有人`mmap`在我背后使用文件时）地图？`ptrace``syscall`

**更新：**

不幸的是，我在 JIT 内部使用了它，它几乎没有关于它正在执行的代码的信息来获得常量的近似值。是的，我意识到我可以拥有可变数据的常量映射，例如 Linux 使用的 vsyscall 页面。我*可以*放心地假设初始解析中未包含的任何内容都是可变且危险的，但我对该选项并不完全满意。

现在我要做的是阅读`/proc/self/maps`并构建一个结构，我可以通过二进制搜索来获得给定地址的保护。任何时候我需要了解一个不在我的结构中的页面，我会重新阅读 /proc/self/maps 假设它已经被同时添加，否则我将要进行段错误。

似乎解析文本以获取此信息并且不知道它何时更改是非常笨拙的。（`/dev/inotify`几乎对任何东西都不起作用`/proc`）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T17:40:45.307

我不知道`VirtualQuery`Linux 上的等价物。但是其他一些可能有效也可能无效的方法是：

*   您设置了一个捕获 SIGBUS/SIGSEGV 的信号处理程序并继续您的读取或写入。如果内存受到保护，您的信号捕获代码将被调用。如果不是，则不会调用您的信号捕获代码。不管怎样，你赢了。

*   您可以跟踪每次调用`mprotect`并构建相应的数据结构，以帮助您了解区域是否受到读或写保护。如果您可以访问所有使用`mprotect`.

*   您可以通过将代码与重新定义函数的库链接来监控`mprotect`进程中的所有调用`mprotect`。然后，您可以构建必要的数据结构来了解某个区域是读保护还是写保护，然后调用系统`mprotect`来真正设置保护。

*   您可以尝试使用`/dev/inotify`和监视文件`/proc/self/maps`是否有任何更改。我想这个不起作用，但应该值得一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-17T00:18:59.900

有点是/是/proc/[pid|self]/pagemap，内核中的文档，这里有警告： [https](https://lkml.org/lkml/2015/7/14/477) ://lkml.org/lkml/2015/7/14/477 所以它不是完全无害的.. .

# asp.net - Auto-Generate Binded Columns/Fields for a DetailsView

> ID：269316
> 
> 赞同：0
> 
> 时间：2008-11-06T16:26:17.890
> 
> 标签：asp.net, visual-studio

In Visual Studio I have set up a DetailsView and an ObjectDataSource which connects with my BLL.

```
<asp:DetailsView runat="server" ID="UserProfileview" DataSourceID="UserData" AutoGenerateRows="False"> 
```

```
<asp:ObjectDataSource ID="UserData" runat="server" TypeName="UoM.Business.Core.UserAccount" SelectMethod="Read">
<SelectParameters>
    <asp:QueryStringParameter QueryStringField="id" Direction="input" Type="Int32" Name="Id" DefaultValue="" />
</SelectParameters> 
```

I am not sure how so Visual Studio can automatically show me all the columns/fields so I can start modifying it instead of typing in each column manually.

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-22T03:10:03.680

如果您设置`AutoGenerateRows="False"`，则必须手动添加绑定列的标签。

# c# - How can you detect on runtime if your sql-server 2005 instance is a 32 or 64 bit instance?

> ID：269317
> 
> 赞同：1
> 
> 时间：2008-11-06T16:26:31.743
> 
> 标签：c#, sql-server, sql-server-2005

How can you detect if your sql-server 2005 instance is a 32 or 64 bit instance from C# code? If you know some documentation on this issue, please let me know.. Thanks!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:31:58.817

Use [SERVERPROPERTY](http://msdn.microsoft.com/en-us/library/ms174396.aspx) ( propertyname )

With property name Edition.

64-bit versions of the Database Engine append (64-bit) to the version.

```
SELECT SERVERPROPERTY ( 'Edition' ) 
```

For me on my x64 machine returns the following string value: Enterprise Edition (64-bit)

You could also check the env variable PROCESSOR_ARCHITECTURE to see what the machine itself is running as.

# windows - Windows虚拟目录配置帮助上的apache

> ID：269326
> 
> 赞同：20
> 
> 时间：2008-11-06T16:29:05.013
> 
> 标签：windows, apache, configuration, virtual-hosts

我正在通过 Xampplite 在 Windows XP 上运行 Apache，并且可以使用帮助配置我的虚拟目录。这是我希望在我的开发盒上做的事情：

1.  我希望我的源文件位于 xampp htdocs 目录之外
2.  在我的本地机器上，我可以在[http://myproject访问项目](http://myproject)
3.  我本地网络上的其他人可以通过 my.ip.address/myproject 访问该项目
4.  保持 localhost 指向 xampp 的 htdocs 文件夹，以便我可以轻松添加其他项目。

通过编辑 Windows 主机文件，并在 xampp 的 apache\conf\extra\httpd-vhosts.conf 文件中添加一个虚拟目录，我有 1 和 2 工作。我不会立即看到如何在不搞砸 4 的情况下执行 3。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-06T16:42:03.163

想通了：为#3使用**Alias ，而不是 VirtualHost，因此：**

```
Alias /myproject "C:/path/to/my/project"
<Directory "C:/path/to/my/project">
  Options Indexes FollowSymLinks MultiViews ExecCGI
  AllowOverride All
  Order allow,deny
  Allow from all
</Directory> 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-06T19:51:21.970

## 完成您的需求清单。

1）制作目录：

> mkdir c:\xampp\sites\myproject

2) 编辑 c:\windows\system32\drivers\etc\hosts 使其包含这一行：

> 127.0.0.1 我的项目

并将以下内容添加到 c:\xampp\apache\conf\extra\httpd-vhosts.conf：

> ```
>  NameVirtualHost myproject:80
> 
>   <VirtualHost myproject:80>
>   DocumentRoot c:/xampp/sites/myproject
>   Options Indexes FollowSymLinks Includes ExecCGI
>    AllowOverride All
>   Order allow,deny
>   Allow from all  
>   </Directory> 
> ```

3) 将以下行添加到 c:\xampp\apache\conf\httpd.conf 的末尾：

> ```
>  Alias /myproject/  "/xampp/sites/myproject/"
> 
>   <Directory "/xampp/sites/myproject">
>   AllowOverride None
>   Options None
>   Order allow,deny
>   Allow from all
>   </Directory> 
> ```

4) 单独保留 c:\xampp\apache\conf\httpd.conf 中的 DocumentRoot、Directory 等来完成此操作。作为参考，这些行将是：

> ```
>  DocumentRoot "/xampp/htdocs"
> 
>   <Directory />
>    Options FollowSymLinks
>    AllowOverride None
>    Order deny,allow
>    Deny from all
>   </Directory>
> 
>   <Directory "/xampp/htdocs">
>    Options Indexes FollowSymLinks Includes ExecCGI
>    AllowOverride All
>    Order allow,deny
>    Allow from all
>   </Directory> 
> ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-16T13:07:29.573

首先启用：LoadModule alias_module modules/mod_alias.so

```
<IfModule alias_module>
  Alias /ddd "D:/prj/customer/www"

  <Directory "D:/prj/customer/www">
    Options Indexes FollowSymLinks Includes ExecCGI
    AllowOverride all
    Order allow,deny
    Allow from all
  </Directory>
</IfModule> 
```

在 WAMP 2.2 上测试及其工作：http://localhost/ddd

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-05T00:30:22.033

在 httpd.conf 中添加以下行，比照：

```
<IfModule alias_module>
    Alias /angular-phonecat "C:/DEV/git-workspace/angular-phonecat"
</IfModule>

<Directory "C:/DEV/git-workspace/angular-phonecat">
    Options Indexes FollowSymLinks Includes ExecCGI
    AllowOverride all
    Order allow,deny
    Allow from all
    Require all granted
</Directory> 
```

重新启动 Apache 服务器后，这对我的 (Windows) XAMPP 安装非常有用。我必须添加“要求全部授予”，但除此之外它与上述答案几乎相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-11T07:52:41.150

> NameVirtualHost myproject:80 < VirtualHost myproject:80 >
> </Directory >

一定是：

> NameVirtualHost myproject:80 < VirtualHost myproject:80 >
> **</VirtualHost>**

问候;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-21T04:50:29.097

解决了这个问题。它缺少目录标签。

```
NameVirtualHost myproject:80
<VirtualHost myproject:80>
    DocumentRoot "D:/Solution"
    <Directory "D:/Solution">
        Options Indexes FollowSymLinks Includes ExecCGI
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>    
</VirtualHost> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-12-04T10:35:38.400

以最简单的方式和更少的步骤解决问题无需创建虚拟主机只需更改目标目录的位置即可。

这是我为配置所做的：我通过编辑 C:/xampp/apache/conf/httpd.conf 文件完成了我在 httpd.conf 文件中所做的更改 在 ScriptAlias /cgi-bin/ 之后添加了此脚本"C:/xampp/apache)/"

Alias /projectXYZ "C:/pathtomyproject" Options Indexes FollowSymLinks MultiViews ExecCGI AllowOverride All Order allow,deny Allow from all

Pathtomyproject = 项目的完整路径

并更改了 Document Root DocumentRoot "C:/pathtomyproject" 的 url

现在通过停止服务器重新启动 Apache 服务器。我已经停止了 Apache 服务器，然后再次启动了 Apache 服务器。

来源：[http ://bytespedia.blogspot.com/2013/12/creating-virtual-directory-in-apache.html](http://bytespedia.blogspot.com/2013/12/creating-virtual-directory-in-apache.html)

# sql-server - What are some useful third-party SSIS components (data flow or control flow)?

> ID：269331
> 
> 赞同：0
> 
> 时间：2008-11-06T16:30:29.317
> 
> 标签：sql-server, ssis, components

The number of products out there right now still seems to be slim.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-17T11:55:57.647

[Konesan 行号转换](http://www.sqlis.com/post/Row-Number-Transformation.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T16:33:06.957

I've had good success using [TableDifference](http://www.sqlbi.com/Projects/TableDifference/tabid/74/language/en-US/Default.aspx) for data warehousing scenarios.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T16:34:16.267

The [Konesans Trash Destination Adapter](http://www.konesans.com/trashdest.aspx) can be very useful during development.

# maintenance - 补丁 vs. 修补程序 vs. 维护版本 vs. 服务包 vs

> ID：269352
> 
> 赞同：42
> 
> 时间：2008-11-06T16:35:37.217
> 
> 标签：maintenance, patch, servicepacks, hotfix

当您处于版本 1 和版本 2 之间时，您如何维护您的软件？

Patch、Hotfix、Maintenance Release、Service Pack 和其他术语在我看来都是模糊的，根据您与谁交谈而具有不同的定义。

您将发布之间的增量维护工作称为什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-11-06T16:43:07.403

当我听到这些术语时，我想到的是：

*   补丁 - 公开发布的更新以修复已知错误/问题
*   修补程序 - 更新以修复一个非常具体的问题，并不总是公开发布
*   维护版本 - 服务包或软件版本之间的增量更新，以修复多个未解决的问题
*   Service Pack - 修复了许多突出问题的大型更新，通常包括早于 Service Pack 的所有补丁、修补程序、维护版本

话虽如此，这根本不是我们进行更新的方式。我们只是增加版本和/或内部版本号（基于日期）并将其称为“更新”。对于我发现更容易的大多数软件，您可以轻松地看到一台计算机正在运行 1.1.50 和 1.2.25，并且知道哪个更新。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-09-08T04:09:19.863

**修补程序**是在系统仍处于活动状态（热）时应用的特定问题的修复程序。这来自较旧的术语，例如**hotswapping**和**hotswitching**。是的，这个词现在经常被不参与该行业的人滥用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-12-17T22:33:27.130

我想指出[http://semver.org/](http://semver.org/)尝试以理智的方式定义版本号，并且那里给出的定义实际上非常适合我如何使用版本号（或者我希望我如何使用它们:) )

至于术语定义，我发现补丁和修补程序非常相似，除了“修补程序”如果对服务进行，通常不会广播。

维护版本和服务包非常接近版本号的两个名称。如果您有像 XYZ 这样的版本号结构，则维护版本将是 Z，Service Pack 将是 Y。不过，我真的只在大型企业产品中听说过这些术语。我更熟悉次要/市长版本条款。

当然，每家商店都有自己对术语的使用，这取决于您所针对的用户类型。例如，对于 MMO 的最终用户，每个更新都是一个“补丁”，因为用户必须“给他们的客户端打补丁”才能应用它，而对于更常见软件的最终用户，您通常只有“更新”一词和“新版”（新市长版）。

# c# - 您可以将数据添加到没有数据源的数据网格吗？

> ID：269354
> 
> 赞同：4
> 
> 时间：2008-11-06T16:36:07.917
> 
> 标签：c#, asp.net, datagrid, controls

我有一个带有 5 个模板列的 DataGrid，

但是，当我尝试将一些动态创建的控件添加到网格中时，它会失败，因为没有行。

- 我可以添加一个空白行并使用它吗？如何？- 或者其他方式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T16:37:54.390

我很确定您必须绑定到数据源。但是创建自己的`DataTable`并用一些虚拟信息在其中插入一行是很容易的。

```
//pseudo code:

DataTable dt = new DataTable();
DataColumn dc = new DataColumn("column1");
dt.Columns.Add(dc);
DataRow dr = dt.NewRow();
dr["column1"] = "value1";
dt.Rows.AddNew(dr);

myDataGrid.DataSource = dt;
myDataGrid.DataBind(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-18T06:01:31.713

如果您使用的是未绑定的 DataGridView，则可以创建新行，然后将它们添加到 DataGridView。您的问题涉及 DataGrid，但您将其标记为 DataGridView。

```
// Sample code to add a new row to an unbound DataGridView
DataGridViewRow YourNewRow = new DataGridViewRow();

YourNewRow.CreateCells(YourDataGridView);
YourNewRow.Cells[0].Value = "Some value";
YourNewRow.Cells[1].Value = "Another value";

YourDataGridView.Rows.Add(YourNewRow); 
```

# delphi - Delphi 应用程序可以像 Visual Studio 那样有双快捷键吗？（即 Ctrl-k Ctrl-k）

> ID：269359
> 
> 赞同：3
> 
> 时间：2008-11-06T16:38:01.253
> 
> 标签：delphi, vcl, shortcut

如标题所述，我的应用程序需要双快捷键（即**Ctrl-k Ctrl-k**是 VS.NET 中的 Toggle Bookmark 键）。我想知道你们中是否有人在 Delphi 中找到了解决方案？我怀疑通过修改 VCL 的核心可以做到，但有没有更简单的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T17:38:39.290

[SynEdit](http://synedit.sourceforge.net/)在 SynEditKey*.* 文件中具有/具有此功能（我自己正在查看 1.03 版），并带有用于快捷方式的编辑器。也许您不能简单地将它们集成到您的应用程序中，但代码有望提供一些指导。

# .net - ActiveMQ .net 客户端锁定

> ID：269363
> 
> 赞同：1
> 
> 时间：2008-11-06T16:38:33.483
> 
> 标签：.net, activemq

我使用 Apache.NMS 和 Apcahe.NMS.ActiveMQ（1.0 版）库编写了一个 Windows 服务。该服务使用来自供应商服务器的 ActiveMQ 消息。

该服务启动连接并侦听消息（我处理 OnMessage 事件）

该连接是事务连接，因此我在每条消息后调用 commit。

当服务启动时，一切都运行良好，并且会持续一段时间。但是，它运行一段时间后，将不再消费消息。即使我重置服务。通常需要重新启动我的服务和供应商服务器（tomcat）才能让事情重新开始。供应商坚持认为他们没有任何问题。

任何一方（客户端或服务器）都没有抛出异常 - 它只是“卡住”。

我应该考虑使用 Spring.Messaging.Nms 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-14T17:15:20.030

我发现了这个问题。建立连接和消息侦听器后，服务进入 Thread.Sleep(500) 循环。哑的。我重构了服务以在 OnStart 中启动所有内容并在 OnStop 中处理它。

自从这样做以来，一切都运行良好。

键盘和椅子之间发生经典 ID-10-T 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-19T22:54:42.837

我的代码有点不同。我没有在循环中进行轮询，而是设置了一个响应“OnMessage”事件的侦听器。我的代码类似于下面的代码。我的实际代码中有很多不相关的东西，但精神是一样的——希望这会有所帮助。

```
factory = new Apache.NMS.ActiveMQ.ConnectionFactory("tcp://activemq:61616");

connection = factory.QueueConnection(factory, "MyQueue", AcknowledgementMode.AutoAcknowledge)

consumer = connection.Session.CreateConsumer(connection.Queue, "2 > 1"); //Get every msg

consumer.Listener += new MessageListener(OnMessage);

private void OnMessage(IMessage message)
{
  //Process message here.;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T13:30:12.447

没关系，我在这里找到了它：

[使用 ActiveMQ 和 NMS 进行事务性消息处理](http://remark.wordpress.com/articles/transactional-message-processing-with-activemq-and-nms/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-19T17:37:16.317

我们刚刚使用 .Net 服务与 ActiveMQ 交谈时遇到了完全相同的问题，但我们的服务在仅传递大约 10-20 条消息后就锁定了。

已经尝试过使用和不使用 spring 框架，没有它会稍微好一些（除非我在想象事情）。

你介意检查一下这段代码并告诉我它是否与你自己的相似吗？

```
ConnectionFactory connectionFactory = new ConnectionFactory("tcp://activemq:61616");

Connection connection = (Connection)connectionFactory.CreateConnection();
connection.Start();

Session session = (Session)connection.CreateSession(AcknowledgementMode.AutoAcknowledge);
IDestination queue = session.GetQueue("test.queue");

MessageConsumer consumer = (MessageConsumer)session.CreateConsumer(queue);

for (int i = 0; i < 1000; i++)
{
    IMessage msg = consumer.Receive();
    if (msg != null)
        Console.WriteLine((msg as ITextMessage).Text);
} 
```

# c# - 无法添加列，因为它的 CellType 属性为空异常

> ID：269365
> 
> 赞同：17
> 
> 时间：2008-11-06T16:38:39.677
> 
> 标签：c#, datagridview

我对以下代码有疑问。当我使用调试器时，遇到以下行时出现异常：

```
dgvCalls.Columns.Insert(1, msisnnColumn); 
```

我得到一个例外：

> 无法添加列，因为其 CellType 属性为空。

奇怪的是，我为其他一些 DataGridViews 创建了相同的过程，并且效果很好。

```
if (!(dgvCalls.Columns.Contains("DirectionImage")))
                {
                    directionIconColumn = new DataGridViewImageColumn();
                    directionIconColumn.Name = "DirectionImage";
                    directionIconColumn.HeaderText = "";
                    dgvCalls.Columns.Insert(0, directionIconColumn);
                    directionIconColumn.CellTemplate = new DataGridViewImageCell();
                }
                if (!(dgvCalls.Columns.Contains("msisndColumn")))
                {
                    msisnnColumn = new DataGridViewColumn();
                    msisnnColumn.Name = "msisndColumn";
                    msisnnColumn.HeaderText = "Klic";
                    dgvCalls.Columns.Insert(1, msisnnColumn);
                    msisnnColumn.CellTemplate = new DataGridViewTextBoxCell();
                } 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-06T16:43:09.650

```
dgvCalls.Columns.Insert(1, msisnnColumn);
msisnnColumn.CellTemplate = new DataGridViewTextBoxCell(); 
```

尝试翻转这两行。这可能会奏效。

# apache - What access does Apache 2.0 need in Windows Server 2003 in order to start as a service?

> ID：269366
> 
> 赞同：0
> 
> 时间：2008-11-06T16:39:01.313
> 
> 标签：apache, permissions, apache2, windows-server-2003

Until this morning, I have had Apache 2.0 running as a service using a local account which was configured with appropriate permissions. Sometime yesterday, someone must have changed something, and now Apache 2.0 won't start as a service under this account.

I made the account an Administrator temporarily, and Apache 2.0 starts fine.

I tried following the access listed in the [official documentation](http://httpd.apache.org/docs/2.0/platform/windows.html), but it seems to require more access. **Does anyone know what access Apache 2.0 needs to start as a service?**

I'm running Apache 2.0.63 with SVN 1.4.6 and mod_auth_sspi for windows domain authentication.

I also checked the syntax of the configuration file from command-line using the **-t** parameter, but I received the message **Syntax OK**.

Here's the error I get when starting as a service from command-line:

```
X:\>net start apache2
The Apache2 service is starting.
The Apache2 service could not be started.

A service specific error occurred: 1.

More help is available by typing NET HELPMSG 3547.

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T21:29:10.463

验证您的服务是否仍具有“作为服务登录”用户权限。如果您的计算机是域的一部分，则帐户权限或用户权限可能已被组策略重置。

您可以使用 Apache 帐户执行“运行方式”并从命令行运行 Apache 吗？这将告诉您是否存在其他权限问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-17T02:03:42.530

在 apache 配置文件中将“LogLevel”指令设置为“debug”。

从命令行执行 Apache 并使用“-X”参数，这样 Apache 就不会派生进程。

Apache 应该输出更多信息来帮助调试您的问题。

# .net - 检测 .NET 对象的属性值的变化？

> ID：269367
> 
> 赞同：4
> 
> 时间：2008-11-06T16:39:30.687
> 
> 标签：.net, properties, object

我有一个用于*插入/显示*和*更新*的表单。在编辑模式 ( *update* ) 中，当我将我的`BO`回传给控制器时，为了执行对数据存储的更新，检查任何属性值是否已更改的最佳方法是什么？

```
textbox1.text = CustomerController.GetCustomerInformation(id).Name 
```

从控制器返回一个客户对象。我需要检查对象是否脏了才能执行更新。我假设从客户端发送的对象必须与从控制器发送的对象进行比较：

```
CustomerController.Save(customer) 
```

这通常是如何完成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T16:40:53.307

一个好的方法是在对象上设置一个 IsDirty 标志，并让所有可设置的属性在更改时更新该标志。加载对象时将标志初始化为 false。

示例属性如下所示：

```
public string Name {
    get { return _name; }
    set {
        _name = value;
        _isDirty = true;
    }
} 
```

然后，当您取回对象时，您可以简单地检查一下`Customer.IsDirty`是否需要将更改提交到数据库。作为额外的奖励，您会从结果文本中获得一些幽默感:)（*哦，那些肮脏的顾客*）

您还可以选择始终保存对象，无论它是否已更改，我的偏好是使用标志。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T17:05:51.413

看一下[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)接口。有关如何实现它的更详细说明，请参见[此处](http://msdn.microsoft.com/en-us/library/ms229614.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T16:45:32.050

我不是专家，但我会在对象上使用布尔标志属性来指示它是脏的。我被打败了，哈哈。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T17:25:47.897

请注意，“脏标志方法”（以其简单形式）适用于值类型（int、bool、...）和字符串，但不适用于引用类型。例如，如果一个属性是`List<int>`or类型`Address`，你可以让它“脏”而不调用 setter 方法（`myCust.Address.City = "..."`只调用 getter 方法）。

如果是这种情况，您可能会发现基于反射的方法很有用（将以下方法添加到您的 BO）：

```
public bool IsDirty(object other)
{
  if (other == null || this.GetType() != other.GetType())
    throw new ArgumentException("other");

  foreach (PropertyInfo pi in this.GetType().GetProperties())
  {
     if (pi.GetValue(this, null) != pi.GetValue(other, null))
       return true;
  }
  return false;
} 
```

你可以像这样使用它：

```
Customer customer = new Customer();
// ... set all properties
if (customer.IsDirty(CustomerController.GetCustomerInformation(id)))
  CustomerController.Save(customer); 
```

# asp.net - 我可以在 Web 用户控件中嵌套模板吗？

> ID：269373
> 
> 赞同：0
> 
> 时间：2008-11-06T16:41:16.067
> 
> 标签：asp.net, templates, web-user-controls

我想做这样的事情：

```
<MyTemplate>
    <span><%# Container.Title %></span>
    <MySubTemplate>
       <span><%# Container.Username %></span>
    </MySubTemplate>
</MyTemplate> 
```

假设我有一个标题列表，每个标题都有一个用户名列表。如果这是一个正确的方法，我该怎么做或者什么是更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T18:17:41.507

如果您有一个标题列表，每个标题都有自己的用户名列表，那么您似乎想要使用嵌套中继器（或其他控件）而不是模板来做一些事情......

```
 <asp:Repeater ID="rptTitle" runat="server" >
        <ItemTemplate>
            <%# Eval("Title") %>
            <asp:Repeater ID="rptUsers" runat="server" >
                <ItemTemplate>
                    <%# Eval("UserName") %>
                </ItemTemplate>
            </asp:Repeater>
        </ItemTemplate>
    </asp:Repeater> 
```

然后在rptTitle的ItemDataBound事件期间绑定rptUsers...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T17:52:12.040

你可以这样做。您还可以使用：

*   标签
*   Span runat="server" 并以编程方式添加它们
*   （贫民窟）string.replace

# c++ - 了解 wxWidgets 尺寸器

> ID：269384
> 
> 赞同：0
> 
> 时间：2008-11-06T16:43:09.340
> 
> 标签：c++, wxwidgets

我仍然习惯于 wxWidgets 中的 sizer，因此似乎无法让它们做我想做的事。

我想要一个包含其他面板/框列表的大面板，每个面板/框都包含一组文本字段

```
----------------------
| label    text box  |
| label2   text box2 |
----------------------
----------------------
| label    text box  |
| label2   text box2 |
----------------------
----------------------
| label    text box  |
| label2   text box2 |
---------------------- 
```

我还需要能够添加（最后）和删除（任何地方）这些框。如果包含面板中容纳的内容太多，则还需要垂直滚动条。

这是我到目前为止所尝试的，它适用于使用包含面板创建的第一个框，但其他添加的项目只是主面板左上角的一个小框，即使 sizer 代码是相同的所有的盒子。

```
//itemsList is a container containg a list of *Item pointers to each box/panel/whatever the right name is
Items::Items(wxWindow *parent)
:wxPanel(parent, wxID_ANY, wxDefaultPosition, wxDefaultSize, wxBORDER_SUNKEN)
{
    //one sstarting item
    OnAdd(wxCommandEvent());
}

void Items::OnAdd(wxCommandEvent &event)
{
    unsigned id = itemsList .size();
    Item *item = new Item(this,id);
    itemsList .push_back(item);

    RebuildSizer();
}
void Items::RebuildSizer()
{
    this->SetSizer(0,true);
    wxBoxSizer *sizerV = new wxBoxSizer(wxVERTICAL);

    for(std::vector<Item*>::iterator it = itemsList .begin(); it != itemsList .end(); ++it)
        sizerV->Add(*it, 1, wxEXPAND | wxLEFT | wxRIGHT, 5);

    SetSizer(sizerV);
}
void Items::OnRemove      (wxCommandEvent &event, unsigned itemId)
{
    delete itemsList [itemId];
    itemsList .erase(items.begin()+itemId);
    for(std::vector<Item*>::iterator it = itemsList .begin()+itemId; it != itemsList .end(); ++it)
        (*it)->ChangeId(itemId++);

    RebuildSizer();
} 
```

还有什么是布置每个盒子内容的最佳方式？我正在考虑使用 2 x 2 网格大小调整器，但我不确定如何使文本框尽可能扩大，同时使标签尽可能小（但也要保持 2 个文本之间的对齐盒子）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T17:18:55.197

“如果包含面板中容纳的内容太多，则还需要垂直滚动条。”

你可以看看 wxScrolledWindow。

“其他添加的项目只是主面板左上角的一个小框”

我不确定，但是，也许调用 wxSizer::Layout() 会有所帮助。

“还有什么最好的方式来布置每个盒子的内容？”

看看[这个 sizerdemo](http://neume.sourceforge.net/sizerdemo/)。如果不是强制性的，标签尽可能小，你可以给标签一个固定的宽度，只让文本框增长。如果您想在添加或删除新框时调整大小，您可以实现 OnSize() 事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:23:59.677

我可以建议您将这个问题发布到[wxWidgets 邮件列表](http://www.wxwidgets.org/support/maillst2.htm)之一吗？他们将能够非常迅速地帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:44:33.700

我也可以推荐[wxForum 吗](http://wxforum.shadonet.com/)，我发现它过去对 wxWidgets 问题非常有用。

更具体地说，对于滚动[wxScrolledWindow](http://docs.wxwidgets.org/stable/wx_wxscrolledwindow.html#wxscrolledwindow)应该有所帮助，将 wxScrolledWindow->SetSizer 与您的顶级大小调整器（包含您的控件的那个）一起使用来设置滚动区域，还可以查看 wxWidgets 中包含的名为 scroll、scrollsub 和 vscroll 的示例（在您的 wxwidgets 安装的示例目录）。

# .net - 使用自动 DialogResult 时如何验证 .NET 对话框项？

> ID：269390
> 
> 赞同：1
> 
> 时间：2008-11-06T16:44:42.520
> 
> 标签：.net, dialog

目前，我已经在 c# 中设置了一个带有下拉菜单的自定义确定取消对话框。ok 和 cancel 按钮使用 DialogResult 属性，因此它后面没有代码。我现在需要做的是验证下拉菜单以检查它在发回对话结果之前是否为空。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:47:31.017

从[这里](http://www.functionx.com/vcsharp2003/Lesson06.htm)

双击Closing字段，实现如下：

```
private void Second_Closing(object sender, 
        System.ComponentModel.CancelEventArgs e)
{
    // When the user attempts to close the form, don't close it...
    e.Cancel = (dropdown.selecteditemindex >= 0);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T16:53:18.007

禁用您的确定按钮，直到组合框更改为有效值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T16:48:34.540

如果你想检查一些东西，你总是需要设计器背后的一些代码。对于您的情况，您可以在表单中使用“关闭”事件，检查您需要什么，如果需要，设置“e.Cancel = true;” - 那么表单将不会关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T16:52:46.357

我为此所做的是不在 OK 按钮上设置 DialogResult，而是在按钮后面放置一些代码。

```
private void OkButton_Clicked(object sender, EventArgs e)
{
    this.DialogResult = ValueComboBox.SelectedIndex >= 0
        ? DialogResult.Ok
        : DialogResult.None;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T19:31:13.163

您可以继续使用对话框的 OK 和 Cancel 按钮功能，然后将此代码放入 OK 按钮的 Clicked 处理程序中：

```
private void OkButton_Clicked(object sender, EventArgs e)
{
    if (!IsValid()) {
        this.DialogResult = System.Windows.Forms.DialogResult.None;
    }
} 
```

在上面的代码中，`IsValid()`您必须实现一个方法，它验证对话框上的输入字段。

# c# - 使用 Google 跟踪电子商务

> ID：269402
> 
> 赞同：4
> 
> 时间：2008-11-06T16:48:52.603
> 
> 标签：c#, asp.net, e-commerce

我被要求将 Google 电子商务跟踪添加到我的网站中。此跟踪涉及在您的收据页面上插入一些 javascript，然后调用它的函数。在我的 asp.net 收据页面上，我需要为交易信息调用一个函数 (_addTrans)，然后为订单上的每个项目调用另一个函数 (_addItem)。他们想要的一个例子是[here](http://www.google.com/support/analytics/bin/answer.py?answer=55528)

这是针对 1.1 站点的。谁能给我一个从我的 c# 代码隐藏调用这两个函数的快速启动？我无法想象只有我一个人需要调用 Google 电子商务跟踪，所以我充满希望。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-06T17:06:42.083

可能最简单的方法是将所需的 Javascript 构建为字符串，例如

```
StringBuilder sb = new StringBuilder()
sb.AppendLine( "<script>" );
sb.AppendLine( "var pageTracker = _gat._getTracker('UA-XXXXX-1');" );
sb.AppendLine( "pageTracker._trackPageview();" );
sb.AppendFormat( "pageTracker._addTrans('{0}','{1}','{2}','{3}','{4}','{5}','{6}','{7}' );\n", orderId, affiliation, total, tax, shipping, city, state, country );
sb.AppendFormat( "pageTracker._addItem('{0}','{1}','{2}','{3}','{4}','{5}');\n", itemNumber, sku, productName, category, price, quantity );
sb.AppendLine("pageTracker._trackTrans();");
sb.AppendLine( "</script>" ); 
```

然后注册它以出现在页面中

```
Page.RegisterStartupScript("someKey", sb.ToString()); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-07T09:34:45.473

在这里，我刚刚编写了一个 Google Analytics E-Commerce 类来动态添加分析事务。

[http://www.sarin.mobi/2008/11/generate-google-analytics-e-commerce-code-from-c/](http://www.sarin.mobi/2008/11/generate-google-analytics-e-commerce-code-from-c/)

希望这个希望。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-07T14:49:06.057

响应 stevemegson（第一个答案）- pageTracker._addItem 方法的第一个参数不应该是 OrderID，而不是 itemNumber？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-12T03:33:08.497

我发布的一个项目允许与 Google Analytics 轻松集成，以通过本机 .net 代码触发页面视图和事件。

这样，您可以简单地调用一个方法，该方法将为您记录事件或页面视图。

我计划在接下来的几周内也支持事务日志记录。

它被称为 GaDotNet，可以在这里找到：[http ://www.diaryofaninja.com/projects/details/ga-dot-net](http://www.diaryofaninja.com/projects/details/ga-dot-net)

# apache - 如何编写 mod_rewrite 规则来查找特定文件夹中的图像？

> ID：269403
> 
> 赞同：1
> 
> 时间：2008-11-06T16:49:35.270
> 
> 标签：apache, mod-rewrite

我需要编写一个规则来将任何图像文件重定向到特定文件夹。即“图像”

```
RewriteCond $1 ^(.*\.jpg|.*\.gif|.*\.bmp) 
```

这将匹配所有的图像，重写部分让我感到困惑。我要那个

```
Http://domain.com/path/controller/view/image.jpg
http://domain.com/any/path/that/i/want/image.jpg 
```

加载文件

```
http://domain.com/iamges/image.jpg 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T17:34:14.027

```
RewriteEngine On
RewriteBase /

# prevent endless loops
RewriteCond %{REQUEST_URI} !images/

# capture only the filename 
RewriteRule ^.*/(.*\.jpg|.*\.gif|.*\.bmp) images/$1 [L,R] 
```

[L,R] 中的 R 选项强制进行可见的重写 - 如果您希望它看起来图像来自请求 url，那么只需使用 [L]

查看[mod_rewrite 文档](http://httpd.apache.org/docs/2.0/mod/mod_rewrite.html)以获取更多详细信息

# sql-server-2005 - SQL Server 2005 表变量更新问题

> ID：269404
> 
> 赞同：9
> 
> 时间：2008-11-06T16:49:53.163
> 
> 标签：sql-server-2005

我一直在阅读表变量和临时表之间的差异，并偶然发现了表变量的以下问题。我追的文章中没有看到这个问题。

我通过 XML 数据类型传入了一系列 PK，并成功地在两个临时表结构中创建了记录。当我尝试更新临时表中的其他字段时，表变量失败，但临时表的更新语句没有问题。需要做什么不同的？我想利用 Table Variables 承诺的速度提升……</p>

以下是 SP 片段和结果：

```
CREATE PROCEDURE ExpenseReport_AssignApprover
(
    @ExpenseReportIDs       XML
)
AS

DECLARE     @ERTableVariable        TABLE   (   ExpenseReportID             INT,
                                                ExpenseReportProjectID      INT,
                                                ApproverID                  INT)

CREATE TABLE #ERTempTable
(
    ExpenseReportID             INT,
    ExpenseReportProjectID      INT,
    ApproverID                  INT
)

INSERT INTO @ERTableVariable (ExpenseReportID)
SELECT ParamValues.ID.value('.','VARCHAR(20)')
FROM @ExpenseReportIDs.nodes('/Root/ExpenseReportID') as ParamValues(ID)

INSERT INTO #ERTempTable (ExpenseReportID)
SELECT ParamValues.ID.value('.','VARCHAR(20)')
FROM @ExpenseReportIDs.nodes('/Root/ExpenseReportID') as ParamValues(ID)

UPDATE          #ERTempTable
SET             ExpenseReportProjectID = (  SELECT TOP 1 ExpenseReportProjectID 
                                                FROM ExpenseReportItem 
                                                WHERE(ExpenseReportID = #ERTempTable.ExpenseReportID))

UPDATE          @ERTableVariable
SET             ExpenseReportProjectID = (  SELECT TOP 1 ExpenseReportProjectID 
                                                FROM ExpenseReportItem 
                                                WHERE(ExpenseReportID = @ERTableVariable.ExpenseReportID)) 
```

上次更新语句时出错：必须声明标量变量“@ERTableVariable”。

当最后一次更新被注释掉时，ExpenseReportProjectID 会在 #ERTempTable 中更新：

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-06T19:42:23.253

当我在上次更新中对表 var 引用进行文字化时，可以进行快速测试：

```
UPDATE @ERTableVariable
    SET ExpenseReportProjectID = (      
        SELECT TOP 1 ExpenseReportProjectID
        FROM ExpenseReportItem 
        WHERE ExpenseReportID = [@ERTableVariable].ExpenseReportID
    ) 
```

您还可以使用“更新自”：

```
UPDATE er SET 
    ExpenseReportProjectID = ExpenseReportItem.ExpenseReportProjectID
FROM @ERTableVariable er
INNER JOIN ExpenseReportItem ON 
    ExpenseReportItem.ExpenseReportID = er.ExpenseReportID 
```

连接可能会返回多行，但只有一个会“粘住”。有点像“TOP 1”这样的不确定性更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T16:53:10.787

试试这个：

```
CREATE PROCEDURE ExpenseReport_AssignApprover
(
        @ExpenseReportIDs               XML
)
AS BEGIN

DECLARE         @ERTableVariable                TABLE   (       ExpenseReportID                         INT,
                                                                                                ExpenseReportProjectID          INT,
                                                                                                ApproverID                                      INT)

CREATE TABLE #ERTempTable
(
        ExpenseReportID                         INT,
        ExpenseReportProjectID          INT,
        ApproverID                                      INT
)

INSERT INTO @ERTableVariable (ExpenseReportID)
SELECT ParamValues.ID.value('.','VARCHAR(20)')
FROM @ExpenseReportIDs.nodes('/Root/ExpenseReportID') as ParamValues(ID)

INSERT INTO #ERTempTable (ExpenseReportID)
SELECT ParamValues.ID.value('.','VARCHAR(20)')
FROM @ExpenseReportIDs.nodes('/Root/ExpenseReportID') as ParamValues(ID)

UPDATE                  #ERTempTable
SET                             ExpenseReportProjectID = (      SELECT TOP 1 ExpenseReportProjectID 
                                                                                                FROM ExpenseReportItem 
                                                                                                WHERE(ExpenseReportID = #ERTempTable.ExpenseReportID))

UPDATE                  @ERTableVariable
SET                             ExpenseReportProjectID = (      SELECT TOP 1 ExpenseReportProjectID 
                                                                                                FROM ExpenseReportItem 
                                                                                                WHERE(ExpenseReportID = @ERTableVariable.ExpenseReportID))

END 
```

# sharepoint - 与文档库浏览器 Web 部件通信

> ID：269406
> 
> 赞同：1
> 
> 时间：2008-11-06T16:50:08.920
> 
> 标签：sharepoint, sharepoint-2007, document-library, web-parts

## 背景

我的任务是在 SharePoint 中显示应可单击的流程图图像。想想 html 中的图像映射。某些区域会将您带到其他流程图图像，而其他区域则会弹出一个弹出窗口。

“连接”到每个流程图的是一组文档。这些文档存储在文档库中。文档库中的每个文件夹都有一个流程图。文件应显示在图像旁边。单击图像或文件夹以在层次结构中导航的人也应该能够上传、下载和删除文档。

## 问题

什么是最简单的解决方案？

## 我的想法

...到目前为止是创建一个自定义 Web 部件，我在文档库浏览器（MOSS 2007 中的默认浏览器）上方添加它。此 Web 部件读取一些 xml 文件，指出要显示的图像和可单击的区域。它从文档库中侦听某种事件，例如单击浏览器中的文件夹或读取当前 URL 以了解我们当前在文件夹层次结构中的位置，并从中显示正确的流程图图像。单击图像时，Web 部件会更新图像并通知文档库进行相应更新。

这可行吗？我在错误的轨道上吗？如何与文档库通信？

谢谢，马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-25T06:05:51.127

我的想法是您创建一个 Web 部件，该部件显示您的图像映射并将适当的标准输出（提供者）到另一个使用它并在文档库中显示文件的 Web 部件。

您可以通过创建自己的自定义 Web 部件来实现此目的，该 Web 部件显示基于 CAML 查询的文档库。每个图像向文档库 Web 部件发送不同的 CAML 查询。

我希望这有帮助。如果您已经这样做了，请提供有关如何解决此问题的信息。

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T11:48:46.913

自从我来过这里很久......实际上解决了这个问题。

我们创建了两个 Web 部件，一个用于流程导航，一个用于过滤文档库中的文档。

用于流程导航的 Web 部件实际上只是一个 Web 部件，它在 URL 中查找特定的查询参数并在其中添加“.html”。然后在文档库中查找该文档。如果找到，则此文档将显示在 iframe 中。简单的！

html 文档由 Visio 生成并导出为 html，然后上传到 SharePoint。Visio 文档中的链接通过查询驱动应用程序。

显示相应文档的 Web 部件还会在 URL 中查找特定查询，然后通过 IfilterProvider 接口将过滤器参数发送到文档库。我在 MSDN 上获取了这个示例[IFilterProvider，](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.webpartpages.communication.ifilterprovider.aspx)并使其在 URL 中查找参数，然后使控件对用户不可见。

非常简单的解决方案，尽管客户需要投入大量工作才能将他们的公司流程纳入其中。而且它有点容易出错，并且可能是对数据进行更改的傻瓜。

# windows - 32 位和 64 位进程之间的 memcpy 性能差异

> ID：269408
> 
> 赞同：9
> 
> 时间：2008-11-06T16:50:47.810
> 
> 标签：windows, memory, 64-bit, cpu, 32-bit

我们有带 XP64 的 Core2 机器（戴尔 T5400）。

我们观察到，在运行 32 位进程时，memcpy 的性能在 1.2GByte/s 量级；然而，在 64 位进程中的 memcpy 可以达到大约 2.2GByte/s（或使用 Intel 编译器 CRT 的 memcpy 可以达到 2.4GByte/s）。虽然最初的反应可能只是将其解释为由于 64 位代码中可用的寄存器更广泛，但我们观察到我们自己的类似 memcpy 的 SSE 汇编代码（应该使用 128 位宽的加载存储，而不管 32 /64 位进程）展示了它实现的复制带宽的类似上限。

我的问题是，这种差异实际上是由什么引起的？32 位进程是否必须跳过一些额外的 WOW64 箍才能获得 RAM？它与 TLB 或预取器有关还是......什么？

感谢您的任何见解。

也在[英特尔论坛上](http://software.intel.com/en-us/forums/intel-avx-and-cpu-instructions/topic/63277/)提出。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T18:28:06.117

我认为以下内容可以解释它：

要将数据从内存复制到寄存器并返回内存，您可以

```
mov eax, [address]
mov [address2], eax 
```

这会将 32 位（4 字节）从地址移动到地址 2。64 位模式下的 64 位也是如此

```
mov rax, [address]
mov [address2], rax 
```

这会将 64 位 2 字节从地址移动到地址 2。根据英特尔的规格，“mov”本身，无论是 64 位还是 32 位，都具有 0.5 的延迟和 0.5 的吞吐量。延迟是指令通过流水线所需的时钟周期数，吞吐量是 CPU 在再次接受同一指令之前必须等待的时间。正如您所看到的，它每个时钟周期可以执行两个 mov，但是，它必须在两个 mov 之间等待半个时钟周期，因此它实际上每个时钟周期只能执行一个 mov（或者我在这里错了并且误解了这些术语？有关详细信息，请参阅[此处的 PDF](http://www.intel.com/design/processor/manuals/248966.pdf)）。

当然，a`mov reg, mem`可以长于 0.5 个周期，具体取决于数据是在 1 级还是 2 级缓存中，或者根本不在缓存中，需要从内存中获取。但是，上面的延迟时间忽略了这个事实（正如我在上面链接的 PDF 状态），它假设 mov 所需的所有数据都已经存在（否则延迟将增加从任何地方获取数据所需的时间）现在 - 这可能是几个时钟周期，并且完全独立于正在执行的命令，如第 482/C-30 页上的 PDF 所述）。

有趣的是，mov 是 32 位还是 64 位都不起作用。这意味着除非内存带宽成为限制因素，否则 64 位 mov 与 32 位 mov 一样快，并且由于使用 64 位时将相同数量的数据从 A 移动到 B 只需要一半的 mov，因此吞吐量可以（理论上）是两倍高（事实并非如此，可能是因为内存不是无限快的）。

好的，现在您认为当使用更大的 SSE 寄存器时，您应该获得更快的吞吐量，对吧？AFAIK xmm 寄存器不是 256，而是 128 位宽，顺便说一句（[参考维基百科](http://en.wikipedia.org/wiki/Streaming_SIMD_Extensions)）。但是，您是否考虑过延迟和吞吐量？您要移动的数据是否 128 位对齐。根据这一点，您可以使用

```
movdqa xmm1, [address]
movdqa [address2], xmm1 
```

或者如果没有对齐

```
movdqu xmm1, [address]
movdqu [address2], xmm1 
```

好吧，movdqa/movdqu 的延迟为 1，吞吐量为 1。因此指令的执行时间是普通 mov 的两倍，指令执行后的等待时间是普通 mov 的两倍。

我们甚至没有考虑到的其他事实是 CPU 实际上将指令拆分为微操作，并且它可以并行执行这些操作。现在它开始变得非常复杂......对我来说甚至太复杂了。

无论如何，根据经验，我知道将数据加载到/从 xmm 寄存器加载比将数据加载到/从普通寄存器慢得多，所以你通过使用 xmm 寄存器来加速传输的想法从一开始就注定了。实际上，我很惊讶 SSE memmove 最终并没有比正常的慢很多。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-11T12:58:46.077

我终于明白了这一点（并且死在 Sente 的答案是正确的，谢谢）

在下面，dst 和 src 是 512 MByte std::vector。我正在使用 Intel 10.1.029 编译器和 CRT。

在 64 位上

> `memcpy(&dst[0],&src[0],dst.size())`

和

> `memcpy(&dst[0],&src[0],N)`

其中 N 是先前声明的`const size_t N=512*(1<<20);` 调用

> `__intel_fast_memcpy`

其中大部分包括：

```
 000000014004ED80  lea         rcx,[rcx+40h] 
  000000014004ED84  lea         rdx,[rdx+40h] 
  000000014004ED88  lea         r8,[r8-40h] 
  000000014004ED8C  prefetchnta [rdx+180h] 
  000000014004ED93  movdqu      xmm0,xmmword ptr [rdx-40h] 
  000000014004ED98  movdqu      xmm1,xmmword ptr [rdx-30h] 
  000000014004ED9D  cmp         r8,40h 
  000000014004EDA1  movntdq     xmmword ptr [rcx-40h],xmm0 
  000000014004EDA6  movntdq     xmmword ptr [rcx-30h],xmm1 
  000000014004EDAB  movdqu      xmm2,xmmword ptr [rdx-20h] 
  000000014004EDB0  movdqu      xmm3,xmmword ptr [rdx-10h] 
  000000014004EDB5  movntdq     xmmword ptr [rcx-20h],xmm2 
  000000014004EDBA  movntdq     xmmword ptr [rcx-10h],xmm3 
  000000014004EDBF  jge         000000014004ED80 
```

并以 ~2200 MByte/s 的速度运行。

但是在 32 位

> `memcpy(&dst[0],&src[0],dst.size())`

来电

> `__intel_fast_memcpy`

其中大部分包括

```
 004447A0  sub         ecx,80h 
  004447A6  movdqa      xmm0,xmmword ptr [esi] 
  004447AA  movdqa      xmm1,xmmword ptr [esi+10h] 
  004447AF  movdqa      xmmword ptr [edx],xmm0 
  004447B3  movdqa      xmmword ptr [edx+10h],xmm1 
  004447B8  movdqa      xmm2,xmmword ptr [esi+20h] 
  004447BD  movdqa      xmm3,xmmword ptr [esi+30h] 
  004447C2  movdqa      xmmword ptr [edx+20h],xmm2 
  004447C7  movdqa      xmmword ptr [edx+30h],xmm3 
  004447CC  movdqa      xmm4,xmmword ptr [esi+40h] 
  004447D1  movdqa      xmm5,xmmword ptr [esi+50h] 
  004447D6  movdqa      xmmword ptr [edx+40h],xmm4 
  004447DB  movdqa      xmmword ptr [edx+50h],xmm5 
  004447E0  movdqa      xmm6,xmmword ptr [esi+60h] 
  004447E5  movdqa      xmm7,xmmword ptr [esi+70h] 
  004447EA  add         esi,80h 
  004447F0  movdqa      xmmword ptr [edx+60h],xmm6 
  004447F5  movdqa      xmmword ptr [edx+70h],xmm7 
  004447FA  add         edx,80h 
  00444800  cmp         ecx,80h 
  00444806  jge         004447A0 
```

并且仅以 ~1350 MByte/s 的速度运行。

**然而**

```
memcpy(&dst[0],&src[0],N) 
```

其中 N 先前声明`const size_t N=512*(1<<20);`编译（在 32 位上）直接调用

```
__intel_VEC_memcpy 
```

其中大部分包括

```
 0043FF40  movdqa      xmm0,xmmword ptr [esi] 
  0043FF44  movdqa      xmm1,xmmword ptr [esi+10h] 
  0043FF49  movdqa      xmm2,xmmword ptr [esi+20h] 
  0043FF4E  movdqa      xmm3,xmmword ptr [esi+30h] 
  0043FF53  movntdq     xmmword ptr [edi],xmm0 
  0043FF57  movntdq     xmmword ptr [edi+10h],xmm1 
  0043FF5C  movntdq     xmmword ptr [edi+20h],xmm2 
  0043FF61  movntdq     xmmword ptr [edi+30h],xmm3 
  0043FF66  movdqa      xmm4,xmmword ptr [esi+40h] 
  0043FF6B  movdqa      xmm5,xmmword ptr [esi+50h] 
  0043FF70  movdqa      xmm6,xmmword ptr [esi+60h] 
  0043FF75  movdqa      xmm7,xmmword ptr [esi+70h] 
  0043FF7A  movntdq     xmmword ptr [edi+40h],xmm4 
  0043FF7F  movntdq     xmmword ptr [edi+50h],xmm5 
  0043FF84  movntdq     xmmword ptr [edi+60h],xmm6 
  0043FF89  movntdq     xmmword ptr [edi+70h],xmm7 
  0043FF8E  lea         esi,[esi+80h] 
  0043FF94  lea         edi,[edi+80h] 
  0043FF9A  dec         ecx  
  0043FF9B  jne         ___intel_VEC_memcpy+244h (43FF40h) 
```

并以 ~2100MByte/s 的速度运行（证明 32 位不受带宽限制）。

我撤回了我自己的类似 memcpy 的 SSE 代码在 32 位构建中遭受类似的 ~1300 MByte/限制的说法；我现在在 32 位或 64 位上获得 >2GByte/s 没有任何问题；诀窍（如上述结果提示）是使用非临时（“流式”）存储（例如`_mm_stream_ps`内在）。

`dst.size()`32 位“ ”memcpy 最终不会调用更快的“ ”版本似乎有点奇怪`movnt`（如果您进入 memcpy，则会有最令人难以置信的`CPUID`检查和启发式逻辑，例如将要复制的字节数与缓存大小等进行比较在它接近您的实际数据之前），但至少我现在了解观察到的行为（而且它与 SysWow64 或硬件无关）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-25T20:20:05.240

当然，您确实需要通过使用调试器单步执行机器代码来查看在 memcpy 最内层循环中正在执行的实际机器指令。其他一切都只是猜测。

我的问题是它可能与 32 位和 64 位本身没有任何关系；我的猜测是更快的库例程是使用 SSE 非临时存储编写的。

如果内部循环包含传统加载-存储指令的任何变体，则必须将目标内存读入机器的缓存、修改并写回。由于该读取完全没有必要——正在读取的位会立即被覆盖——您可以通过使用绕过缓存的“非临时”写入指令来节省一半的内存带宽。那样的话，目标内存只是写成单程到内存而不是往返。

我不知道英特尔编译器的 CRT 库，所以这只是一个猜测。没有什么特别的原因为什么 32 位 libCRT 不能做同样的事情，但是你引用的加速在我所期望的范围内，只需将 movdqa 指令转换为 movnt ......

由于 memcpy 不进行任何计算，因此它始终受到您读写内存的速度的限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T17:00:50.350

我的即兴猜测是 64 位进程正在使用处理器的本机 64 位内存大小，这优化了内存总线的使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-12T05:16:04.617

感谢您的积极反馈！我想我可以*部分*解释这里发生了什么。

***如果***您只是为 memcpy 调用计时，那么使用memcpy 的非临时存储绝对是禁食的。

另一方面，如果您正在对应用程序进行基准测试，则 movdqa 存储的好处是它们将目标内存保留在缓存中。或者至少是适合缓存的部分。

因此，如果您正在设计一个运行时库，并且如果您可以假设调用 memcpy 的应用程序将在 memcpy 调用后立即使用目标缓冲区，那么您将需要提供 movdqa 版本。这有效地优化了从内存返回到将遵循 movntdq 版本的 cpu 的行程，并且调用之后的所有指令将运行得更快。

但另一方面，如果目标缓冲区与处理器的缓存相比较大，则该优化不起作用，并且 movntdq 版本将为您提供更快的应用程序基准测试。

因此，memcpy 的想法将有多个版本。当目标缓冲区比处理器的缓存小时，使用 movdqa，否则，目标缓冲区比处理器的缓存大，使用 movntdq。听起来这就是 32 位库中正在发生的事情。

当然，这一切都与 32 位和 64 位的区别无关。

我的猜测是 64 位库还不够成熟。开发人员还没有开始在该版本的库中提供这两个例程。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-11T17:43:31.963

我面前没有参考资料，所以我对时间/说明并不是绝对肯定的，但我仍然可以给出理论。如果您在 32 位模式下进行内存移动，您将执行类似“rep movsd”的操作，它会在每个时钟周期移动一个 32 位值。在 64 位模式下，您可以执行“rep movsq”，它在每个时钟周期执行一次 64 位移动。该指令不适用于 32 位代码，因此您将以一半的执行速度执行 2 x rep movsd（以 1 个周期）。

非常简化，忽略了所有内存带宽/对齐问题等，但这就是一切的开始......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-17T23:40:38.687

这是一个专门针对 64 位架构的 memcpy 例程示例。

```
void uint8copy(void *dest, void *src, size_t n){
    uint64_t * ss = (uint64_t)src;
    uint64_t * dd = (uint64_t)dest;
    n = n * sizeof(uint8_t)/sizeof(uint64_t); 

    while(n--)
        *dd++ = *ss++;
}//end uint8copy() 
```

全文在这里： [http ://www.godlikemouse.com/2008/03/04/optimizing-memcpy-routines/](http://www.godlikemouse.com/2008/03/04/optimizing-memcpy-routines/)

# deployment - 如何从 .reg 文件生成 WiX XML？

> ID：269423
> 
> 赞同：13
> 
> 时间：2008-11-06T16:54:33.980
> 
> 标签：deployment, installation, wix, windows-installer

**给定 .reg 文件，是否有生成 WiX XML 的工具？**

* * *

在 2.0 中，您应该能够运行 tallow 来生成注册表 XML：

```
tallow -r my.reg 
```

对于它的价值，我拥有的动物脂版本正在生成空 XML。

在 3.0 中，tallow 已被替换为 heat，但我不知道如何让它从 .reg 文件中产生输出。

有没有办法在 3.0 中做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-06T21:49:55.820

我找不到工具，所以我做了一个。

源代码可能不优雅，但它似乎工作：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.IO;
using System.Xml;
using System.Text.RegularExpressions;

namespace Reg2Wix
{
    class Program
    {
        static void PrintUsage()
        {
            Console.WriteLine("reg2wix <input file> <output file>");
        }

        /// <summary>
        /// Parse the hive out of a registry key
        /// </summary>
        /// <param name="keyWithHive"></param>
        /// <param name="hive"></param>
        /// <param name="key"></param>
        static void ParseKey(string keyWithHive, out string hive, out string key)
        {
            if (keyWithHive == null)
            {
                throw new ArgumentNullException("keyWithHive");
            }
            if (keyWithHive.StartsWith("HKEY_LOCAL_MACHINE\\"))
            {
                hive = "HKLM";
                key = keyWithHive.Substring(19);
            }
            else if (keyWithHive.StartsWith("HKEY_CLASSES_ROOT\\"))
            {
                hive = "HKCR";
                key = keyWithHive.Substring(18);
            }
            else if (keyWithHive.StartsWith("HKEY_USERS\\"))
            {
                hive = "HKU";
                key = keyWithHive.Substring(11);
            }
            else if (keyWithHive.StartsWith("HKEY_CURRENT_USER\\"))
            {
                hive = "HKCU";
                key = keyWithHive.Substring(18);
            }
            else
            {
                throw new ArgumentException();
            }        
        }

        /// <summary>
        /// Write a WiX RegistryValue element for the specified key, name, and value
        /// </summary>
        /// <param name="writer"></param>
        /// <param name="key"></param>
        /// <param name="name"></param>
        /// <param name="value"></param>
        static void WriteRegistryValue(XmlWriter writer, string key, string name, string value)
        {
            if (writer == null)
            {
                throw new ArgumentNullException("writer");
            }
            if (key == null)
            {
                throw new ArgumentNullException("key");
            }
            if (value == null)
            {
                throw new ArgumentNullException("value");
            }

            string hive;
            string keyPart;
            ParseKey(key, out hive, out keyPart);

            writer.WriteStartElement("RegistryValue");

            writer.WriteAttributeString("Root", hive);
            writer.WriteAttributeString("Key", keyPart);
            if (!String.IsNullOrEmpty(name))
            {
                writer.WriteAttributeString("Name", name);
            }
            writer.WriteAttributeString("Value", value);
            writer.WriteAttributeString("Type", "string");
            writer.WriteAttributeString("Action", "write");

            writer.WriteEndElement();
        }

        /// <summary>
        /// Convert a .reg file into an XML document
        /// </summary>
        /// <param name="inputReader"></param>
        /// <param name="xml"></param>
        static void RegistryFileToWix(TextReader inputReader, XmlWriter xml)
        {
            Regex regexKey = new Regex("^\\[([^\\]]+)\\]$");
            Regex regexValue = new Regex("^\"([^\"]+)\"=\"([^\"]*)\"$");
            Regex regexDefaultValue = new Regex("@=\"([^\"]+)\"$");

            string currentKey = null;

            string line;
            while ((line = inputReader.ReadLine()) != null)
            {
                line = line.Trim();
                Match match = regexKey.Match(line);                
                if (match.Success)
                {
                    //key track of the current key
                    currentKey = match.Groups[1].Value;
                }
                else 
                {
                    //if we have a current key
                    if (currentKey != null)
                    {
                        //see if this is an acceptable name=value pair
                        match = regexValue.Match(line);
                        if (match.Success)
                        {
                            WriteRegistryValue(xml, currentKey, match.Groups[1].Value, match.Groups[2].Value);
                        }
                        else
                        {
                            //see if this is an acceptable default value (starts with @)
                            match = regexDefaultValue.Match(line);
                            if (match.Success)
                            {
                                WriteRegistryValue(xml, currentKey, (string)null, match.Groups[1].Value);
                            }
                        }
                    }
                }
            }
        }

        /// <summary>
        /// Convert a .reg file into a .wsx file
        /// </summary>
        /// <param name="inputPath"></param>
        /// <param name="outputPath"></param>
        static void RegistryFileToWix(string inputPath, string outputPath)
        {
            using (StreamReader reader = new StreamReader(inputPath))
            {
                using (XmlTextWriter writer = new XmlTextWriter(outputPath, Encoding.UTF8))
                {
                    writer.Formatting = Formatting.Indented;
                    writer.Indentation = 3;
                    writer.IndentChar = ' ';
                    writer.WriteStartDocument();
                    writer.WriteStartElement("Component");
                    RegistryFileToWix(reader, writer);
                    writer.WriteEndElement();
                    writer.WriteEndDocument();
                }
            }
        }

        static void Main(string[] args)
        {
            if (args.Length != 2)
            {
                PrintUsage();
                return;
            }
            RegistryFileToWix(args[0], args[1]);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-11T06:19:41.507

以下是生成 Wix 3 标记的实用程序的源代码（包括二进制、双字和多字符串注册表值）：

```
using System;
using System.Globalization;
using System.IO;
using System.Reflection;
using System.Security.Cryptography;
using System.Text;
using System.Text.RegularExpressions;
using System.Xml;

namespace AbsReg2Wix
{
    public class Program
    {
        #region Constants

        private const string NS_URI = "http://schemas.microsoft.com/wix/2006/wi";
        private const string RegEditorVersionPattern = @"Windows\sRegistry\sEditor\sVersion\s(?<RegEditorVersion>.*)";
        private const string RegKeyPattern = @"\[(?<RegistryHive>[^\\]*)\\(?<RegistryKey>.*)\]";
        private const string RegNameValuePattern = "\\\"(?<Name>.*)\\\"=(?<Value>\\\"?[^\\\\\\\"]*)(?<MultiLine>\\\\?)";
        private const RegexOptions DefaultRegexOptions = RegexOptions.Multiline |
                                                         RegexOptions.IgnorePatternWhitespace |
                                                         RegexOptions.CultureInvariant;
        #endregion

        #region Methods

        /// <summary>
        /// Main applciation entry point
        /// </summary>
        /// <param name="args">The args.</param>
        private static void Main(string[] args)
        {
            if (args.Length != 4)
            {
                PrintUsageInstructions();
                return;
            }

            if (File.Exists(args[1]))
            {
                ConvertRegistryFileToWix(args[1], args[3]);

                Console.WriteLine("Successfully completed conversion.");
                Console.WriteLine("Press any key to continue...");
                Console.ReadKey();
            }
            else
            {
                Console.WriteLine(@"Input file {0} not found.", args[1]);
            }
        }

        /// <summary>
        /// Prints the usage instructions.
        /// </summary>
        private static void PrintUsageInstructions()
        {
            Console.WriteLine("Syntax: AbsReg2Wix.exe /in <Input File (.reg)> /out <Output File>");
        }

        /// <summary>
        /// Convert a .reg file into a .wsx file
        /// </summary>
        /// <param name="inputPath">The input path.</param>
        /// <param name="outputPath">The output path.</param>
        private static void ConvertRegistryFileToWix(string inputPath, string outputPath)
        {
            try
            {
                using (var reader = new StreamReader(inputPath))
                {
                    string regEditorVersion = string.Empty;
                    bool isRegEditorVersionFound = false;

                    // Initialize Regex 
                    var regEditorVersionRegex = new Regex(RegEditorVersionPattern, DefaultRegexOptions);
                    var regKeyRegex = new Regex(RegKeyPattern, DefaultRegexOptions);
                    var regNameValueRegex = new Regex(RegNameValuePattern, DefaultRegexOptions);

                    // Create xml document for output
                    var xDoc = new XmlDocument();
                    xDoc.AppendChild(xDoc.CreateProcessingInstruction("xml", "version=\"1.0\" encoding=\"utf-8\""));
                    xDoc.AppendChild(xDoc.CreateComment(
                                         string.Format(
                                             "{0}Following code was generated by AbsReg2Wix tool.{0}Tool Version: {1}{0}Date: {2}{0}Command Line: {3}\n",
                                             "\n\t", Assembly.GetExecutingAssembly().GetName().Version,
                                             DateTime.Now.ToString("F"),
                                             Environment.CommandLine)));

                    XmlElement includeElement = xDoc.CreateElement("Include", NS_URI);
                    XmlElement componentElement = null,
                               regKeyElement = null,
                               registryValueElement = null;

                    bool multiLine = false;
                    var rawValueBuilder = new StringBuilder();

                    while (!reader.EndOfStream)
                    {
                        string regFileLine = reader.ReadLine().Trim();

                        if (!isRegEditorVersionFound)
                        {
                            var regEditorVersionMatch = regEditorVersionRegex.Match(regFileLine);

                            if (regEditorVersionMatch.Success)
                            {
                                regEditorVersion = regEditorVersionMatch.Groups["RegEditorVersion"].Value;
                                includeElement.AppendChild(
                                    xDoc.CreateComment("Registry Editor Version: " + regEditorVersion));
                                isRegEditorVersionFound = true;
                            }
                        }

                        var regKeyMatch = regKeyRegex.Match(regFileLine);

                        // Registry Key line found
                        if (regKeyMatch.Success)
                        {
                            if (componentElement != null)
                            {
                                componentElement.AppendChild(regKeyElement);
                                includeElement.AppendChild(componentElement);
                            }

                            componentElement = xDoc.CreateElement("Component", NS_URI);

                            var idAttr = xDoc.CreateAttribute("Id");
                            idAttr.Value = "Comp_" + GetMD5HashForString(regFileLine);
                            componentElement.Attributes.Append(idAttr);

                            var guidAttr = xDoc.CreateAttribute("Guid");
                            guidAttr.Value = Guid.NewGuid().ToString();
                            componentElement.Attributes.Append(guidAttr);

                            regKeyElement = xDoc.CreateElement("RegistryKey", NS_URI);

                            var hiveAttr = xDoc.CreateAttribute("Root");
                            hiveAttr.Value = GetShortHiveName(regKeyMatch.Groups["RegistryHive"].Value);
                            regKeyElement.Attributes.Append(hiveAttr);

                            var keyAttr = xDoc.CreateAttribute("Key");
                            keyAttr.Value = regKeyMatch.Groups["RegistryKey"].Value;
                            regKeyElement.Attributes.Append(keyAttr);

                            var actionAttr = xDoc.CreateAttribute("Action");
                            actionAttr.Value = "createAndRemoveOnUninstall";
                            regKeyElement.Attributes.Append(actionAttr);
                        }

                        var regNameValueMatch = regNameValueRegex.Match(regFileLine);

                        // Registry Name/Value pair line found
                        if (regNameValueMatch.Success)
                        {
                            registryValueElement = xDoc.CreateElement("RegistryValue", NS_URI);

                            var nameAttr = xDoc.CreateAttribute("Name");
                            nameAttr.Value = regNameValueMatch.Groups["Name"].Value;
                            registryValueElement.Attributes.Append(nameAttr);

                            var actionAttr = xDoc.CreateAttribute("Action");
                            actionAttr.Value = "write";
                            registryValueElement.Attributes.Append(actionAttr);

                            if (string.IsNullOrEmpty(regNameValueMatch.Groups["MultiLine"].Value))
                            {
                                string valueType, actualValue;

                                ParseRegistryValue(regNameValueMatch.Groups["Value"].Value, out valueType,
                                                   out actualValue);

                                var typeAttr = xDoc.CreateAttribute("Type");
                                typeAttr.Value = valueType;
                                registryValueElement.Attributes.Append(typeAttr);

                                var valueAttr = xDoc.CreateAttribute("Value");
                                valueAttr.Value = actualValue;
                                registryValueElement.Attributes.Append(valueAttr);
                                regKeyElement.AppendChild(registryValueElement);
                            }
                            else
                            {
                                multiLine = true;
                                rawValueBuilder.Append(regNameValueMatch.Groups["Value"].Value
                                                           .Replace("\\", string.Empty));
                            }
                        }
                        else if (multiLine)
                        {
                            if (regFileLine.IndexOf("\\") != -1)
                            {
                                rawValueBuilder.Append(regFileLine.Replace("\\", string.Empty));
                            }
                            else
                            {
                                rawValueBuilder.Append(regFileLine);

                                string valueType, actualValue;
                                ParseRegistryValue(rawValueBuilder.ToString(), out valueType, out actualValue);

                                var typeAttr = xDoc.CreateAttribute("Type");
                                typeAttr.Value = valueType;
                                registryValueElement.Attributes.Append(typeAttr);

                                var valueAttr = xDoc.CreateAttribute("Value");
                                valueAttr.Value = actualValue;
                                registryValueElement.Attributes.Append(valueAttr);
                                regKeyElement.AppendChild(registryValueElement);

                                rawValueBuilder.Remove(0, rawValueBuilder.Length);
                                multiLine = false;
                            }
                        }
                    }

                    if (componentElement != null)
                    {
                        componentElement.AppendChild(regKeyElement);
                        includeElement.AppendChild(componentElement);
                    }

                    xDoc.AppendChild(includeElement);
                    xDoc.Save(outputPath);
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine(ex.Message);
            }
        }

        /// <summary>
        /// Parses the registry value.
        /// </summary>
        /// <param name="rawValue">The raw value.</param>
        /// <param name="valueType">Type of the value.</param>
        /// <param name="actualValue">The actual value.</param>
        private static void ParseRegistryValue(string rawValue, out string valueType, out string actualValue)
        {
            if (rawValue.IndexOf("\"") != -1)
            {
                valueType = "string";
                actualValue = rawValue.Substring(1, rawValue.Length - 2);
            }
            else if (rawValue.IndexOf("dword:") != -1)
            {
                valueType = "integer";
                actualValue = rawValue.Replace("dword:", string.Empty);
            }
            else if (rawValue.IndexOf("hex:") != -1)
            {
                valueType = "binary";
                actualValue = rawValue.Replace("hex:", string.Empty)
                                      .Replace(",", string.Empty)
                                      .ToUpper();
            }
            else if (rawValue.IndexOf("hex(7):") != -1)
            {
                valueType = "multiString";

                string[] hexStrings = rawValue.Replace("hex(7):", string.Empty).Split(',');
                var bytes = new byte[hexStrings.Length];

                for (int i = 0; i < hexStrings.Length; i++)
                {
                    bytes[i] = byte.Parse(hexStrings[i], NumberStyles.HexNumber);
                }

                actualValue = Encoding.Unicode.GetString(bytes).Replace("\0", "[~]");
            }
            else
            {
                valueType = "string";
                actualValue = rawValue;
            }
        }

        /// <summary>
        /// Gets the short name of the registry hive.
        /// </summary>
        /// <param name="fullHiveName">Full name of the hive.</param>
        /// <returns></returns>
        private static string GetShortHiveName(string fullHiveName)
        {
            switch (fullHiveName)
            {
                case "HKEY_LOCAL_MACHINE":
                    return "HKLM";
                case "HKEY_CLASSES_ROOT":
                    return "HKCR";
                case "HKEY_USERS":
                    return "HKU";
                case "HKEY_CURRENT_USER":
                    return "HKCU";
                default:
                    throw new ArgumentException(string.Format("Registry Hive unsupported by Wix: {0}.",
                        fullHiveName));
            }
        }

        /// <summary>
        /// Gets the MD5 hash for string.
        /// </summary>
        /// <param name="inputString">The input string.</param>
        /// <returns></returns>
        private static string GetMD5HashForString(string inputString)
        {
            MD5 hashAlg = MD5.Create();
            byte[] originalInBytes = Encoding.ASCII.GetBytes(inputString);
            byte[] hashedOriginal = hashAlg.ComputeHash(originalInBytes);

            String outputString = Convert.ToBase64String(hashedOriginal)
                    .Replace("/", "aa")
                    .Replace("+", "bb")
                    .Replace("=", "cc");

            return outputString;
        }

        #endregion
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-10-11T16:13:15.080

现在它内置在 Wix 中：`Heat.exe`- 收获工具。

> [https://stackoverflow.com/a/11988983/483588](https://stackoverflow.com/a/11988983/483588)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-11T06:07:31.770

我已经从最新的稳定**Wix 2版本中尝试****了 tallow.exe（版本 2.0.5805）**，它对我来说效果很好。

 **```
tallow -reg my.reg 
```

这将**使用在 Wix 3 中弃用的Wix 2** **“注册表”**标签生成标记。然后，您必须将输出复制到 wix 源文件并执行**WixCop**实用程序以将 Wix 2 标记转换为 Wix 3：

 ****```
wixcop my.wxs -f 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-09T15:19:16.610

此代码运行良好，但如果您正在导入的注册表文件中有一个空字符串值，则会引发异常错误。您可能需要相应地更新 ParseRegistryValue 部分。

```
 if (rawValue.IndexOf("\"") != -1)
        {
            valueType = "string";
            if (rawValue.Length > 1)
            {
                actualValue = rawValue.Substring(1, rawValue.Length - 2);
            }
            else
            {
                actualValue = "";
            }
        } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-05-07T22:01:28.943

来自 Wix 4.0

```
C:\Program Files (x86)\WiX Toolset v4.0\bin>heat /? | find /i "reg"
   reg      harvest a .reg file
   -sreg    suppress registry harvesting 
```

要使用，其中 regfile.reg 是注册表输入文件，fragment.xml 是要生成的输出文件。

```
heat reg regfile.reg -o fragment.xml 
```

# visual-studio-2008 - VS2008/TFS 中挂起更改到剪贴板的文件列表

> ID：269425
> 
> 赞同：2
> 
> 时间：2008-11-06T16:54:57.660
> 
> 标签：visual-studio-2008, tfs

当我在 VS2008 中右键单击一个解决方案并选择 Check In... 时，我会看到一个带有复选框和注释区域的已更改文件列表。（这是针对 TFS 完成的。）

我们的签入过程要求我们将此更改文件列表输入到错误跟踪票中。这需要输入每个文件的名称：耗时且容易出错。

理想情况下，我希望能够选择该列表并将其复制到剪贴板，以便我可以将其粘贴到错误跟踪系统中。

有没有人可以轻松地将该列表放入剪贴板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T16:59:28.137

我将 SnagIt 用于此类事情，它确实是一个了不起的应用程序。他们有非免费版本和免费版本（[此处](http://www.labnol.org/software/download/free-download-snagit-with-serial-number/1841/)的说明）。老实说，我不知道没有它我是如何生活的。

它的功能之一是能够从窗口（如 Windows 资源管理器文件夹视图）中抓取文本，这可能会满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T17:12:09.360

我不知道没有标准的方法，怎么做。但是您可以创建一个工具来执行此操作。

```
 string strServer = startInfo.Server;
            string strWorkspace = startInfo.Workspace;

            Microsoft.TeamFoundation.Client.TeamFoundationServer tfsServer = null;
            if ( false == string.IsNullOrEmpty( strServer ) ) {
                tfsServer = new Microsoft.TeamFoundation.Client.TeamFoundationServer( startInfo.Server );
                tfsServer.Authenticate();
            }

            Microsoft.TeamFoundation.VersionControl.Client.VersionControlServer vcServer = null;
            if ( tfsServer != null ) {
                object obj = tfsServer.GetService( typeof( Microsoft.TeamFoundation.VersionControl.Client.VersionControlServer ) );
                vcServer = obj as Microsoft.TeamFoundation.VersionControl.Client.VersionControlServer;
            }

            Microsoft.TeamFoundation.VersionControl.Client.Workspace workspace = null;
            if ( tfsServer != null && vcServer != null && false == string.IsNullOrEmpty( strWorkspace ) ) {
                workspace = vcServer.GetWorkspace( strWorkspace, tfsServer.AuthenticatedUserName );
            }

            List<string> pendingItems = new List<string>();
            foreach ( Microsoft.TeamFoundation.VersionControl.Client.WorkingFolder folder in workspace.Folders ) {
                pendingItems.Add( folder.ServerItem );
            }

            List<string> localFilePaths = new List<string>();
            string userName = tfsServer.AuthenticatedUserIdentity.AccountName;
            Microsoft.TeamFoundation.VersionControl.Client.PendingSet[] pendingSets = workspace.QueryPendingSets( pendingItems.ToArray(), Microsoft.TeamFoundation.VersionControl.Client.RecursionType.Full, null, userName, false );
            foreach ( Microsoft.TeamFoundation.VersionControl.Client.PendingSet ps in pendingSets ) {
                foreach ( Microsoft.TeamFoundation.VersionControl.Client.PendingChange change in ps.PendingChanges ) {
                    localFilePaths.Add( change.LocalItem );
                }
            } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T18:43:55.057

显然，您的组织将拥有的一大优势是，如果他们还将错误跟踪系统移至 TFS，那么当您签入文件时，您可以将该签入与工作项（错误、任务等）相关联，并且关联将是为你照顾。它还将允许大量报告等 - 所有的好东西。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-14T22:41:02.010

如果您的公司已经为 TFS 安装了 Web Access Power Tool，那么您只需将一个 URL 粘贴到您的错误跟踪系统中，该系统将链接回签入。

它看起来像这样......

**[http://mytfs:8090/cs.aspx?cs=1234](http://mytfs:8090/cs.aspx?cs=1234)**

节省时间，出错的可能性很小。

塔。

史蒂夫·波特

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T16:58:07.843

为什么不截取签入对话框的屏幕截图（alt+Prnt Scrn）并将图像上传到错误跟踪系统？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-14T03:59:53.227

在 VS 2010 中选择所有文件，然后按`CTRL+C`将文件详细信息复制到剪贴板。

# wpf - 如何在 WPF 中对齐画布背景？

> ID：269436
> 
> 赞同：6
> 
> 时间：2008-11-06T16:58:09.183
> 
> 标签：wpf, canvas, alignment

我已将画布背景设置为公司徽标的图像。我希望这张图片与画布的右下角对齐。
是否可以这样做，或者是否需要将图像作为孩子添加到画布中？这不适用于该程序，因为画布的所有子项都以不同方式处理。

谢谢你

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-07T00:27:07.873

这行得通吗？（无论如何，它对我有用。）

```
 <Canvas>
    <Canvas.Background>
      <ImageBrush ImageSource="someimage.jpg" AlignmentX="Right" 
          AlignmentY="Bottom" Stretch="None" />
    </Canvas.Background>
  </Canvas> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:23:56.340

AFAIK WPF Canvas 需要使用绝对坐标定位子 UI 元素。为了实现右下锚定效果，我认为您需要**处理窗口调整大小事件，重新计算并应用子图像元素的上、左坐标**以始终粘在右下角。

```
<Window x:Class="HelloWPF.Window1" xmlns...
    Title="Window1" Height="300" Width="339">
    <Canvas>
        <Image Canvas.Left="195" Canvas.Top="175" Height="87" Name="image1" Stretch="Fill" Width="122" Source="dilbert2666700071126ni1.gif"/>
    </Canvas>
</Window> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T00:18:47.483

像这样在 Grid 控件中包含画布和图像怎么样？

```
<Window ...>
  <Grid>
    <Canvas/>
    <Image HorizontalAlignment="Right" VerticalAlignment="Bottom" .../>
  <Grid>
</Window> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T16:00:24.970

这是我在画布内使用边框对齐图像的解决方案。此解决方案在调整画布大小时效果很好：

```
<Canvas x:Name="MiCanvas" Height="250" Width="500" Background="Aqua">
    <Border x:Name="MiBorderImage" 
            Width="{Binding ElementName=MiCanvas, Path=ActualWidth}"
            Height="{Binding ElementName=MiCanvas, Path=ActualHeight}"
            Background="Transparent">
        <Image x:Name="MiImage" Source="/GraphicsLibrary/Logos/MiLogo.png"
               HorizontalAlignment="Right" 
               VerticalAlignment="Bottom" 
               Stretch="None" />
    </Border>
 </Canvas> 
```

# mysql - 如何修复此 MySQL 查询使其正常工作？

> ID：269440
> 
> 赞同：2
> 
> 时间：2008-11-06T16:59:00.103
> 
> 标签：mysql, sql, mysql-error-1093

我有以下查询：

```
UPDATE lessonstatus
INNER JOIN user ON lessonstatus.user_id = user.user_id
SET user_id = (SELECT user_id FROM user WHERE username = 'too_many_accounts')
WHERE last_name = 'stupid' 
AND first_name = 'user'
AND username != 'too_many_accounts'
AND lessonstatus.lesson_id NOT IN (SELECT lesson_id FROM lessonstatus WHERE user_id = 1); 
```

但是，尝试执行它时出现以下错误：

```
Error Code : 1093
You can't specify target table 'lessonstatus_rtab' for update in FROM clause 
```

我将如何修复此查询以使其正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T17:31:17.697

您不能`SELECT`从您在同一查询中更新的表（即使在子查询中）。这就是错误“无法指定目标表”的含义。

但是您可以在语句中多次加入`user`和，并创造性地使用加入条件来挑选您想要的单个行。`lessonstatus``UPDATE`

使用连接进行模拟的方法`NOT IN`是执行`LEFT OUTER JOIN`. 如果该连接的右侧不匹配，那就是`NOT IN`正确的。

```
UPDATE lessonstatus l1
  INNER JOIN user u1 ON (l1.user_id = u1.user_id)
  INNER JOIN user u2 ON (u2.username = 'too_many_accounts')
  LEFT OUTER JOIN lessonstatus l2 
    ON (l1.lesson_id = l2.lesson_id AND l2.user_id = 1)
SET l1.user_id = u2.user_id
WHERE u1.last_name = 'stupid' AND u1.first_name = 'user'
  AND u1.username != 'too_many_accounts'
  AND l2.lesson_id IS NULL; -- equivalent to "l NOT IN l2" 
```

**注意：**我已经测试了这个查询的语法，但没有使用真实数据。无论如何，它应该让你开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:06:20.167

错误较多（“user”表和“user_rtab”别名不匹配，不推荐使用非限定字段名），但UPDATE语法本身应该类似：

```
UPDATE lessonstatus
SET user_id = (SELECT TOP 1 user_id FROM user WHERE username = 'too_many_accounts')
FROM lessonstatus
    INNER JOIN user ON lessonstatus.user_id = user_rtab.user_id
WHERE last_name = 'stupid' 
    AND first_name = 'user'
    AND username != 'too_many_accounts'
    AND lessonstatus.lesson_id NOT IN (
        SELECT lesson_id FROM lessonstatus WHERE user_id = 1
    ); 
```

# windows - WinXP SP3 中的稀疏文件

> ID：269454
> 
> 赞同：0
> 
> 时间：2008-11-06T17:02:14.323
> 
> 标签：windows, windows-xp, filesystems

突然，我们发现 WinXP SP3 不允许**在用户模式应用程序中**创建 NTFS 稀疏文件。即，`DeviceIoControl`返回`FSCTL_SET_SPARSE`错误 0x57 ( `ERROR_INVALID_PARAMETER`)。相同的代码在 SP2 中运行良好。此外，如果从内核模式（在 SP3 和 SP2 中）进行相同的调用，也可以。

谷歌对此只字未提。有没有人遇到过这个问题，甚至有一些关于它的额外信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T18:24:54.860

稀疏文件在 WinXP SP3 中对我来说工作正常。调用 CreateFile 后 GetLastError 的值是多少？或者在 DeviceIoControl 之后，如果那是您正在使用的？

这个网站有一些关于稀疏文件的好信息：http: [//www.flexhex.com/docs/articles/sparse-files.phtml](http://www.flexhex.com/docs/articles/sparse-files.phtml)

MSDN 文档是给定的。

# c# - 将网站公开，但离开进行测试......“我们不开放”

> ID：269456
> 
> 赞同：4
> 
> 时间：2008-11-06T17:03:29.003
> 
> 标签：c#, asp.net, iis, web, rollout

我们明天将为使用 IIS 的客户端推出一个站点。

我将把网站向公众开放（对不起，我们正在更新消息）并允许客户在我们执行升级后的周末进行测试。

如果成功了，我就向所有人开放——如果没有，我就回滚。

向公众张贴“我们不开放”标志但其余部分对测试人员开放的最简单方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-06T17:06:50.633

通过 IIS 重定向。在 IIS 中创建一个新网站，并将“抱歉更新”消息放入 Default.aspx。然后在真实站点（将从 80 转到其他站点（6666））和“维护”站点（设置为 80）之间切换端口。

然后告诉您的测试人员访问 yoursite.com:6666。

然后在关闭“维护”站点后将真实站点切换回80。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T19:43:48.740

我认为值得一提的是 ASP.NET 2.0+ 的“应用程序离线”功能。（是的，我意识到提问者希望将应用程序留待测试，但我正在为以后可能有不同需求的读者写这篇文章）。

如果您真的想让*每个人都*离线应用程序（例如进行服务器维护），那么有一个非常简单的选项。在 ASP.NET 2.0 及更高版本中，您所要做的就是放置一个具有以下名称的文件：

```
app_offline.htm 
```

...在 ASP.NET 应用程序的根目录中。在那里放一条适当的“抱歉稍后回来”消息。就是这样。ASP.NET 运行时完成其余的工作。

[Scott Guthrie 博客](http://weblogs.asp.net/scottgu/archive/2006/04/09/442332.aspx)上的详细信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T17:07:07.450

要求测试人员登录。您甚至可以隐藏登录页面，以便您需要直接链接才能看到它。然后，对于所有未登录的人，重定向到显示您的消息的页面。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-06T17:16:19.227

在 IIS 中启动另一个“站点”，它将捕获主站点的主机头。使用具有“我们已停止维护”的自定义 307/503/404 页面，或使用某种 URL 重写将人们重定向到您的单个静态文件。

将您真实站点上的 host-header-binding 切换到其他东西，例如您的开发人员使用的 dev.domain.com 或 testing.domain.com。

或者，通过 IP 阻止，并让您的自定义“未授权”页面告诉访问者您需要维护。

你有几个选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T17:08:03.953

我以前用过的一些方法：

*   Windows 身份验证和/或单独的子域供客户端测试。
*   在 IIS 中禁用匿名网站访问，并为您的客户端提供用户名/密码组合来测试网站。
*   禁用 IIS 中的默认文档，并为您的客户端提供主索引文件的绝对 URL。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T17:39:06.777

我们倾向于在站点的所有页面（通常是数据库连接，因为它包含在所有文件中）都有一个登录页面和一个包含文件，以检查有效的登录会话。如果您尚未登录，您会收到一条消息，说明该站点已关闭以进行维护

# .net - 如何从主 MSBuild 文件中分离一些属性

> ID：269458
> 
> 赞同：1
> 
> 时间：2008-11-06T17:03:57.177
> 
> 标签：.net, msbuild, ant

很久以前，当我还是一名 Java 开发人员时，我可以制作单独的 ant 脚本，我可以从我的主 ant 脚本中调用这些脚本。我会为我的主脚本运行的每个环境设置唯一的属性。我想在 MSBuild 中做同样的事情，但我不知道如何将 MSBuild 脚本链接在一起。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T17:10:35.383

您需要[导入](http://msdn.microsoft.com/en-us/library/92x05xfs.aspx)它们。

```
 <Import Project="MyTargets" Condition="Exists('MyTargets')"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T17:18:14.230

导入肯定有用，还可以主动调用其他项目：

```
<MSBuild Projects="Other.proj" Properties="SomeProp=$(MyProperty)" /> 
```

# windows - MFC - 显示对话框后立即执行代码（.NET 等效于 Form.Shown）

> ID：269462
> 
> 赞同：4
> 
> 时间：2008-11-06T17:04:49.203
> 
> 标签：windows, mfc, dialog

我正在对 C++ MFC 项目进行一些小改动。我是 .NET 开发人员，所以 Windows 编程对我来说是新的。

我需要在 CDialog 第一次完全显示（绘制）后立即启动一些方法，但只有一次。

我怎样才能做到这一点？在 .NET 中，我将处理**Form.Shown**事件。

我需要处理一些消息吗？哪一个？我需要重写一些 CDialog 方法吗？还是没有简单的方法？我正在考虑处理 WM_ACTIVATE 然后使用一个标志来确保我只调用另一个方法一次。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T18:51:19.907

在这里找到答案：[等到对话框显示后再做某事](https://web.archive.org/web/20190119124649/https://blogs.msdn.microsoft.com/oldnewthing/20060925-02/?p=29603)

```
Short story:
INT_PTR CALLBACK
DlgProc(HWND hwnd, UINT uiMsg, WPARAM wParam, LPARAM lParam)
{
  switch (uiMsg) {

  case WM_INITDIALOG:
    return TRUE;

  case WM_WINDOWPOSCHANGED:
    if ((((WINDOWPOS*)lParam)->flags & SWP_SHOWWINDOW) &&
        !g_fShown) {
      g_fShown = TRUE;
      PostMessage(hwnd, WM_APP, 0, 0);
    }
    break;

  case WM_APP:
      MessageBox(hwnd,
                 IsWindowVisible(hwnd) ? TEXT("Visible")
                                       : TEXT("Not Visible"),
                 TEXT("Title"), MB_OK);
      break;

  case WM_CLOSE:
   EndDialog(hwnd, 0);
   break;
  }

  return FALSE;
} 
```

如果您像我一样使用 MFC，则需要映射 WM_WINDOWPOSCHANGED，然后使用 ON_MESSAGE 映射 WM_APP。有关更多详细信息，请参阅[此 CodeProject 文章](http://www.codeproject.com/KB/dialog/messagehandling2.aspx?fid=789&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=26)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-25T19:44:25.173

作为参考，您不需要重写 DlgProc 来拦截 WM_WINDOWPOSCHANGED。

```
 ON_WM_WINDOWPOSCHANGED()
   ON_MESSAGE(MyCDialog::MY_USER_MSG, OnDialogShown)

void MyCDialog::OnWindowPosChanged(WINDOWPOS *wndpos)
{
   __super::OnWindowPosChanged(wndpos);

   if (!mDialogShown && (wndpos->flags & SWP_SHOWWINDOW)) {
      PostMessage(MY_USER_MSG);
      mDialogShown = true;
   }
}

LRESULT MyCDialog::OnDialogShown(WPARAM, LPARAM)
{
   ...
} 
```

如果合适，您可以实现内联处理，而不是发布另一条消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T03:27:30.053

我多次使用并取得巨大成功的另一种方法是使用计时器。设置为 10m0s。它只会在显示对话框后触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-28T22:04:21.583

地狱将代码放在 OnPaint() 中，然后在您的班级中使用 bool m_fullyInitilized。我也喜欢计时器。虽然我通常用 100 毫秒。在这些情况下，我还将我的所有初始化代码移出 oninit。只是为了防止那里有太多的处理。

# perl - 如何使用 Perl 的 DBI 将日期值从 Oracle 转换为 Excel？

> ID：269466
> 
> 赞同：1
> 
> 时间：2008-11-06T17:05:37.470
> 
> 标签：perl, oracle, excel, dbi, warnings

我遇到了一个非常简单的 Perl 进程的问题。我基本上是在查询一个 Oracle 数据库，我想将它加载到 Excel 中。我已经能够使用 DBIx::Dump 并且它有效。但是，我需要能够使用各种 Excel 格式化工具。而且我认为[Spreadsheet::WriteExcel](http://search.cpan.org/dist/Spreadsheet::WriteExcel)是输出到 Excel 的最佳模块，它允许我进行更多格式化。

下面是代码和我得到的错误。我基本上是查询 Oracle，获取数据，加载到数组中并尝试写入 Excel。出于某种原因，它正在进行某种比较并且它不喜欢数据类型。例如，日期是“25-OCT-08”。SVP 是“S01”。似乎是在说它们不是数字。

错误：

```
Argument "01-NOV-08" isn't numeric in numeric ge <>=> at C:/Perl/site/lib/Spreadsheet/WriteExcel/Worksheet.pm line 3414.
Argument "01-NOV-08" isn't numeric in pack ge <>=> ge <>=> at C:/Perl/site/lib/Spreadsheet/WriteExcel/Worksheet.pm line 2157. 
```

代码：

```
#!/usr/bin/perl -w 

#Set the Perl Modules
use strict; 
use DBI;
use Spreadsheet::WriteExcel;

# Connect to the oracle database
my $dbh = DBI->connect( 'dbi:Oracle:xxxx',
                        'xxxx',
                        'xxxx',
                      ) || die "Database connection not made: $DBI::errstr";

#Set up Query
my $stmt = "select 
                                   week_end_date, SVP, RD,
                                    DM, store, wtd_smrr_gain,QTD_SMRR_GAIN,
                                   wtd_bor_gain,QTD_BOR_GAIN,
                                   wtd_cust_gain,QTD_CUST_GAIN,
                                   wtd_CARD_CLOSED_OCT25,QTD_AVG_CARD_CL
                    from 
                          bonus_4Q_store
                    order by
                          store"; 

#Prepare Query
my $sth = $dbh->prepare($stmt); 

#Execute Query
$sth->execute() or die $dbh->errstr; 

my( $week_end_date,$SVP,$RD,$DM,$store,
    $wtd_smrr_gain,$QTD_SMRR_GAIN,
    $wtd_bor_gain,$QTD_BOR_GAIN,
    $wtd_cust_gain,$QTD_CUST_GAIN,
    $wtd_CARD_CLOSED_OCT25,$QTD_AVG_CARD_CL);

#binds each column to a scalar reference
$sth->bind_columns(undef,\$week_end_date,\$SVP,\$RD,\$DM,\$store,
                   \$wtd_smrr_gain,\$QTD_SMRR_GAIN,
                   \$wtd_bor_gain,\$QTD_BOR_GAIN,
                   \$wtd_cust_gain,\$QTD_CUST_GAIN,
                   \$wtd_CARD_CLOSED_OCT25,\$QTD_AVG_CARD_CL,);

#create a new instance
my $Excelfile = "/Test_Report.xls"; 
my $excel = Spreadsheet::WriteExcel->new("$Excelfile"); 
my $worksheet = $excel->addworksheet("WOW_SHEET");

#Create array shell
my @data;

#Call data and Write to Excel  
while ( @data = $sth->fetchrow_array()){ 
    my $week_end_date = $data[0]; 
    my $SVP = $data[1]; 
    my $RD = $data[2]; 
    my $DM = $data[3]; 
    my $store = $data[1]; 
    my $wtd_smrr_gain = $data[2]; 
    my $QTD_SMRR_GAIN = $data[3];
    my $wtd_bor_gain = $data[4];
    my $QTD_BOR_GAIN = $data[5];
    my $wtd_cust_gain = $data[6];
    my $QTD_CUST_GAIN = $data[7];
    my $wtd_CARD_CLOSED_OCT25 = $data[8];
    my $QTD_AVG_CARD_CL = $data[9];
    my $row = 0; 
    my $col = 0; 
    foreach my $stmt (@data) 
    { 
        $worksheet->write($row++, @data); 
        last; 
    } 
} 

print "DONE \n"; 
$sth->finish(); 
$dbh->disconnect(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T22:31:42.770

问题在这里：

```
foreach my $stmt (@data) 
{ 
    $worksheet->write($row++, @data); # !!
    last; 
} 
```

的正确语法`write()`是：

```
write($row, $column, $token, $format) 
```

您缺少`$column`参数，在这种情况下可能为 0。

如果`$stmt`是数组 ref，那么您可以一次性编写如下：

```
$worksheet->write($row++, 0, $stmt); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T17:16:50.660

我猜它是以字符串形式出现的，当您尝试将其插入日期列时，它没有隐式转换。

尝试像这样选择日期，它会将其转换为可用于比较的字符。

```
to_char(date, 'YYYY/MM/DD HH24:MI:SS') 
```

然后

```
to_date(date, 'YYYY/MM/DD HH24:MI:SS') 
```

将其转换回插入日期。这通常是您需要在 SQL 中执行的操作。

我记得，perl 有一个 DBI 跟踪工具，可以更好地了解正在发生的事情。

# project-management - 项目管理资源的最佳论坛

> ID：269478
> 
> 赞同：2
> 
> 时间：2008-11-06T17:08:26.230
> 
> 标签：project-management

关于项目管理的最佳在线论坛网站是什么？它必须涵盖与 PM 相关的新闻、文章、案例研究和讨论板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T02:34:43.840

**编辑**

事情变化多快？我刚刚听说了[Cornelius Fichtner 的](http://www.thepmpodcast.com/index.php?option=com_content&task=view&id=20&Itemid=35)新项目：[项目管理意见](http://www.project-management-opinions.com/)。它有一个关于[资源](http://www.project-management-opinions.com/index.php?option=com_mtree&task=listcats&cat_id=69&Itemid=8)的部分。这个新推出的网站看起来已经是一个不错的元网站。

**以前在 Stackoverflow 上......**

我认为没有一个网站可以满足您的需求。我使用的资源是：

**播客：**

[PM Podcast](http://www.thepmpodcast.com/) - 非常好。PMI 虚拟社区的最新一集将为您提供有关 PMI 中 SIG 及其变化方式的更多资源。

[PM 经验教训](http://pmlessonslearned.blogspot.com/)- 混乱的网站，但值得订阅和收听最新剧集（关于风险和软技能的非常好的剧集）

**网站：**

[GanttHead](http://www.gantthead.com/) - 非常繁忙的网站...我从未使用过该网站的任何内容，但我认为有很多链接和论坛。

**团体：**

[PMI](http://www.pmi.org/) - 如果您是会员，这是一个很好的资源。在它的主页上也为每个人提供 PM 新闻。SIGs 中的一些工作听起来很有趣。

[您当地的 PMI 分会](http://wa.pmichapters-australia.org.au/)- 好的，这是我当地的分会。值得自己研究。我对我的参与非常少，发现它们非常平易近人和有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:11:22.637

在早期，[Joel 的网站](http://www.joelonsoftware.com)更倾向于项目管理。

[在此处](http://www.joelonsoftware.com/Archive.html)浏览存档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T17:32:11.783

**[http://www.manager-tools.com](http://www.manager-tools.com)**
曾经有人指点我到那里的播客.. 可能值得一看。从来没有在那里太久.. 有一个更程序员的心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T17:57:20.593

如果您正在寻找公认的专业项目管理，项目管理学院 (pmi.org) 可能是一个好地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-08T10:50:24.730

我会自己拉皮条——但我不会。我强烈建议您查看 Ed Yourdon 和 Caper Jones 网站： [http ://www.yourdon.com/](http://www.yourdon.com/)

[http://www.spr.com/](http://www.spr.com/)

除此之外，还有 pmi.org，但他们主要在寻找销售 pmp 认证的机会。还有敏捷联盟 [http://agilealliance.com/](http://agilealliance.com/)

总的来说……对 PM 来说没什么好处

# sql-server-2005 - 计算数据库应用程序

> ID：269481
> 
> 赞同：-3
> 
> 时间：2008-11-06T17:10:19.533
> 
> 标签：sql-server-2005

我们如何才能知道数据库中有多少个应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T17:31:13.843

不完全确定你在这里要求什么。我假设您的意思是“使用 SQL Server 2005 作为数据库编写的应用程序。”。

如果这就是您想知道的，我不知道有任何一个地方可以让您从中获取这些信息，尝试从[这里](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)开始总是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:27:42.603

你是说存储过程吗？您可以让多个应用程序使用相同的登录凭据从同一 Web 服务器访问给定的数据库，因此您不能简单地计算数据库或表来获得该数字。

# java - 如何使用 JVM 参数为 java.util.Calendar 指定 firstDayOfWeek

> ID：269486
> 
> 赞同：13
> 
> 时间：2008-11-06T17:12:21.463
> 
> 标签：java, calendar, jvm-arguments

我正在尝试将 java.util.Calendar 的默认 firstDayOfWeek 从 SUNDAY 更改为 MONDAY。是否可以通过JVM配置而不是添加这段代码来实现这一点？

```
cal.setFirstDayOfWeek(Calendar.MONDAY); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-06T17:28:25.753

一周的第一天派生自当前语言环境。如果您不设置日历的区域设置（[Calendar.getInstance(Locale)](http://java.sun.com/j2se/1.5.0/docs/api/java/util/Calendar.html#getInstance(java.util.Locale))或[new GregorianCalendar(Locale)](http://java.sun.com/j2se/1.5.0/docs/api/java/util/GregorianCalendar.html#GregorianCalendar(java.util.Locale))），它将使用系统的默认设置。系统的默认值可以被 JVM 参数覆盖：

```
public static void main(String[] args) {
    Calendar c = new GregorianCalendar();
    System.out.println(Locale.getDefault() + ": " + c.getFirstDayOfWeek());
} 
```

这应该显示具有不同 JVM 参数的语言/国家/地区的不同输出：

*   *`-Duser.language=en -Duser.country=US`*-> *（星期日）***`en_US: 1`**
**   *`-Duser.language=en -Duser.country=GB`*-> *（星期一）***`en_GB: 2`***

 **不要忘记这也可能改变其他行为（u）r。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T17:20:09.843

根据 API：

> Calendar 使用两个参数定义特定于语言环境的一周 7 天：一周的第一天和第一周的最少天数（从 1 到 7）。这些数字是在构造日历时从语言环境资源数据中获取的。它们也可以通过设置它们的值的方法明确指定。

因此，如果您确保正确配置了您的语言环境，这将被隐式设置。就个人而言，我更喜欢明确设置这个......

有关从命令行设置语言环境的方法，请参见[#64038](https://stackoverflow.com/questions/64038/setting-java-locale-settings)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T17:18:36.553

您是否尝试过使用不同的语言环境调用 JVM？但是你应该小心副作用......

# ruby-on-rails - 如何处理protect_from_forgery 让Rails 应用程序通信？

> ID：269487
> 
> 赞同：3
> 
> 时间：2008-11-06T17:13:07.733
> 
> 标签：ruby-on-rails

我有一个 Rails 应用程序，可以将一些数据发布到另一个 Rails 应用程序。由于某些原因我不想使用 ActiveResource，所以我使用了类似的东西：

```
 res = Net::HTTP.post_form(URI.parse('http://localhost:3030/support_requests/new'),
                                    {'from'=>'somebody', 'due'=>'2009-03-31'}) 
```

碰巧另一个应用程序抛出了一个**InvalidAuthenticityToken**，这是有道理的，因为我没有发送任何authentity_token。

我的问题是，我怎样才能让一个应用程序向另一个应用程序发送正确的身份验证令牌？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T17:26:43.120

您不必使用 ActiveResources。如果您以 xml 格式发送请求，那么它将绕过protect_from_forgery。

```
curl -H "Content-Type: text/xml" -d "<support-request><from>...</from></support-request>" -X POST http://localhost:3000/support_requests.xml -i 
```

它应该很简单。

# list - Sharepoint 列表 - GroupBy？

> ID：269491
> 
> 赞同：1
> 
> 时间：2008-11-06T17:14:14.223
> 
> 标签：list, apache-flex, sharepoint, caml

我正在尝试从 Sharepoint 列表中获取数据并将其放入一些 Flex 图表中。我可以使用 CAML 查询很好地调用列表数据，但我想使用 GroupBy 按团队合并行。因此，例如，团队 1 可能有 20 条记录，团队 2 可能有 8 条记录，而团队 3 可能有 25 条记录……我不想显示 53 条记录，而是显示 3……只是“团队 1，团队 2， Team 3" 以及每个条目的成本总和。

我看到 CAML 在哪里提供了 GroupBy 元素，但我似乎无法让它工作。此外，只有当我使用 OrderField 元素而不是像 90% 的书籍和网站推荐的 FieldRef 元素时，我才能让 OrderBy 元素工作。如果我确实使用 FieldRef，OrderBy 不再起作用，这对我来说毫无意义。一定有什么不对劲...

这是我的 CAML 查询。

```
---------------------------------------------------

<queryRequest xmlns="http://schemas.microsoft.com/sharepoint/dsp"> 
<dsQuery resultContent="dataOnly" resultRoot="Rows" resultRow="Row" columnMapping="attribute">
<ViewFields> 
<FieldRef Name="Team"></FieldRef> 
<FieldRef Name="Cost"></FieldRef> 
<FieldRef Name="EANo"></FieldRef> 
</ViewFields> 
<Query> 
<GroupBy collapse="true"> 
    <FieldRef Name="Team"/>
</GroupBy> 
<OrderBy>
    <OrderField Name="Cost"/>
</OrderBy>
</Query> 

</dsQuery>
</queryRequest>
--------------------------------------------------- 
```

这是 OrderBy 工作，但 GroupBy 不工​​作。帮助！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T17:45:33.143

我运行了以下查询，似乎对我来说工作正常。

```
<Query>
   <GroupBy collapse="true">
      <FieldRef Name='Date' />
   </GroupBy>
   <OrderBy>
      <FieldRef Name='Title' />
   </OrderBy>
</Query> 
```

我建议您使用 U2U CAML Query Builder 工具来构建和测试您的查询

# java - 当父进程退出时，如何使子进程退出？

> ID：269494
> 
> 赞同：48
> 
> 时间：2008-11-06T17:15:57.260
> 
> 标签：java, process

我正在使用 ProcessBuilder 启动一个子进程，如果父进程退出，则需要子进程退出。在正常情况下，我的代码正确地停止了孩子。但是，如果我导致操作系统杀死父母，孩子将继续运行。

有没有办法将子进程“绑定”到父进程，这样当父进程被杀死时它就会退出？

* * *

类似的问题：

*   [父母退出后如何使子进程死亡？](https://stackoverflow.com/questions/284325/how-to-make-child-process-die-after-parent-exits)
*   [当父进程被杀死时，使用 fork() 创建的子进程是否会自动被杀死？](https://stackoverflow.com/questions/395877/are-child-processes-created-with-fork-automatically-killed-when-the-parent-is-k)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-11-07T16:58:18.157

虽然您无法防止硬中止（例如 Unix 上的 SIGKILL），但您可以防止其他导致父进程关闭的信号（例如 SIGINT）并清理子进程。您可以通过使用关闭挂钩来完成此操作：请参阅[Runtime#addShutdownHook](http://java.sun.com/javase/6/docs/api/java/lang/Runtime.html)以及[此处](https://stackoverflow.com/questions/40376/handle-signals-in-the-java-virtual-machine)的相关 SO 问题。

您的代码可能如下所示：

```
String[] command;
final Process childProcess = new ProcessBuilder(command).start();

Thread closeChildThread = new Thread() {
    public void run() {
        childProcess.destroy();
    }
};

Runtime.getRuntime().addShutdownHook(closeChildThread); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-11-06T17:21:13.630

子进程与其父进程之间没有联系。他们可能知道彼此的进程 ID，但他们之间没有硬性联系。你在说一个[孤儿进程](http://en.wikipedia.org/wiki/Orphan_process)。这是操作系统级别的问题。这意味着任何解决方案都可能取决于平台。

关于我能想到的唯一一件事就是让孩子定期检查其父母状态，如果父母关闭则退出。我不认为这会是那么可靠。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2011-08-16T21:52:56.413

您可以简单地在子进程中启动从 System.in 读取的线程。如果您没有写信给您孩子的标准输入，那么没有其他人会这样做，并且该线程将“永远”阻塞。但是，如果父进程被杀死或以其他方式死亡，您将获得 EOF（或异常）。所以你也可以关闭孩子。（子进程以 java.lang.ProcessBuilder 开始）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-11-12T16:16:11.807

提供与@tomkri 的答案类似的黑客方式，并提供演示代码。

如果您的子进程不需要使用输入流，只需将子进程输入流重定向到其父进程的输入流。然后在子进程中添加一个线程以始终读取输入流，当该线程无法从输入流中读取任何内容时，该子进程退出。所以父进程退出->父进程的输入流不存在->子进程的输入流不存在->子进程退出。

这是Java的演示代码。

父进程：

```
package process.parent_child;

import java.io.File;
import java.io.IOException;
import java.lang.ProcessBuilder.Redirect;

public class ParentProc {

    public static void main(String[] args) {
        System.out.println("I'm parent.");

        String javaHome = System.getProperty("java.home");
        String javaBin = javaHome + File.separator + "bin" + File.separator + "java";
        ProcessBuilder builder = new ProcessBuilder(javaBin, "process.parent_child.ChildProc");

        // Redirect subprocess's input stream to this parent process's input stream.
        builder.redirectInput(Redirect.INHERIT);
        // This is just for see the output of child process much more easily.
        builder.redirectOutput(Redirect.INHERIT);
        try {
            Process process = builder.start();
            Thread.sleep(5000);
        } catch (IOException e) {
            e.printStackTrace();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("Parent exits.");
    }
} 
```

子进程：

```
package process.parent_child;

import java.io.IOException;
import java.util.Scanner;

public class ChildProc {

    private static class StdinListenerThread extends Thread {

        public void run() {
            int c;
            try {
                c = System.in.read();
                while ( c != -1 ) {
                    System.out.print(c);
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
            System.out.println("\nChild exits.");
            System.exit(0);
        }
    }

    public static void main(String[] args) throws InterruptedException {
        System.out.println("I'm child process.");
        StdinListenerThread thread = new StdinListenerThread();
        thread.start();
        Thread.sleep(10000);
    }
} 
```

通过以下命令运行此父进程后：

```
 java process.parent_child.ParentProc 
```

你会看见

```
 I'm parent.
    I'm child process.
    Parent exits.
    xmpy-mbp:bin zhaoxm$
    Child exits 
```

当父进程退出时，子进程立即退出。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-28T07:25:42.613

正如您所发现的，操作系统允许您解决此问题。相反，创建一个由两个进程共享的资源。当父母中止资源时，孩子的反应是关闭。例如：

在随机高数端口上的父级上以接受模式创建一个带有服务器端 TCP/IP 套接字的线程。当孩子启动时，将端口号作为参数传递（环境变量、数据库条目等）。让它创建一个线程并打开该套接字。让线程永远坐在套接字上。如果连接断开，让孩子退出。

或者

在父节点上创建一个线程，不断更新文件的更新日期。（多久取决于你需要多少kill和shutdown之间的粒度。）孩子有一个线程来监控同一个文件的更新时间。如果在特定时间间隔后没有更新，则自动关闭。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-28T06:17:48.663

对于单个子进程，您可以通过反转子/父关系来管理它。请参阅[我](https://stackoverflow.com/questions/284325/how-to-make-child-process-die-after-parent-exits#285134)对这个问题的后续化身的回答。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-16T09:41:14.147

对于 Windows，我想出了这个投票技巧：

```
static int getPpid(int pid) throws IOException {
    Process p = Runtime.getRuntime().exec("C:\\Windows\\System32\\wbem\\WMIC.exe process where (processid="+pid+") get parentprocessid");
    BufferedReader br = new BufferedReader(new InputStreamReader(p.getInputStream()));
    br.readLine();
    br.readLine();
    String ppid= br.readLine().replaceAll(" ","");
    return Integer.parseInt(ppid);
}
static boolean shouldExit() {
    try {
        String pid = ManagementFactory.getRuntimeMXBean().getName().split("@")[0];
        int ppid = getPpid(Integer.parseInt(pid));
        /* pppid */ getPpid(ppid);
    } catch (Exception e) {
        return true;
    } 
    return false;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T17:29:16.720

当父进程停止时，尝试从父进程向子进程发送终止信号

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-06-22T18:50:22.677

正如我测试的那样，如果父进程被杀死，那么子进程的 ppid 将变为 1。所以我们可能可以杀死任何 ppid = 1 的进程。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-12-26T00:10:17.083

一旦我们有了父进程的进程 ID (PID)，我们就可以杀死所有的子进程。我们可以使用windows taskkill命令杀死任何由相应PID启动的进程。

您可以根据您的用例从以下帖子中找到 PID：[https ://stackoverflow.com/Questions/4750470/how-to-get-pid-of-process-ive-just-started-within-java-程序](https://stackoverflow.com/Questions/4750470/how-to-get-pid-of-process-ive-just-started-within-java-program)

获得 PID 后，您需要做的就是通过发送以下命令让操作系统为您终止进程：**“taskkill /F /T /PID P_id”**。在这里将 P_id 替换为您的进程 ID。这里 /T 杀死对应 PID 的进程树中的所有进程。

您可以使用*java.lang.Runtime.exec*函数来执行上述命令。

***PS：此解决方案仅适用于 Windows 操作系统。***

# oop - 继承与聚合

> ID：269496
> 
> 赞同：153
> 
> 时间：2008-11-06T17:16:46.090
> 
> 标签：oop, inheritance, language-agnostic, aggregation

关于如何在面向对象系统中最好地扩展、增强和重用代码，有两种思想流派：

1.  继承：通过创建子类来扩展类的功能。覆盖子类中的超类成员以提供新功能。当超类想要一个特定的接口但不知道它的实现时，使方法抽象/虚拟以强制子类“填充空白”。

2.  聚合：通过获取其他类并将它们组合成一个新类来创建新功能。为这个新类附加一个通用接口，以实现与其他代码的互操作性。

每种方法的好处、成本和后果是什么？还有其他选择吗？

我看到这个辩论经常出现，但我认为 Stack Overflow 上还没有被问到（尽管有一些相关的讨论）。令人惊讶的是，它缺乏良好的谷歌搜索结果。

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2008-11-06T17:28:16.003

这不是什么是最好的问题，而是什么时候使用什么的问题。

在“正常”情况下，一个简单的问题就足以确定我们是否需要继承或聚合。

*   如果新类**或多或少**与原类相同。使用继承。新类现在是原始类的子类。
*   如果新类必须**有**原类。使用聚合。新类现在具有原始类作为成员。

然而，有一个很大的灰色地带。所以我们需要几个其他的技巧。

*   如果我们使用了继承（或者我们计划使用它）但我们只使用了部分接口，或者我们被迫重写很多功能以保持关联的逻辑性。然后我们有一种很大的难闻气味，表明我们必须使用聚合。
*   如果我们使用了聚合（或者我们计划使用它）但我们发现我们需要复制几乎所有的功能。然后我们有一种指向继承方向的气味。

把它剪短。如果部分接口未使用或必须更改以避免不合逻辑的情况，我们应该使用聚合。我们只需要使用继承，如果我们需要几乎所有的功能而没有大的变化。如有疑问，请使用聚合。

另一种可能性是，如果我们有一个类需要原始类的部分功能，则将原始类拆分为根类和子类。并让新类继承根类。但是你应该注意这一点，不要造成不合逻辑的分离。

让我们添加一个示例。我们有一个类 'Dog' 的方法：'Eat'、'Walk'、'Bark'、'Play'。

```
class Dog
  Eat;
  Walk;
  Bark;
  Play;
end; 
```

我们现在需要一个“Cat”类，它需要“Eat”、“Walk”、“Purr”和“Play”。所以首先尝试从 Dog 扩展它。

```
class Cat is Dog
  Purr; 
end; 
```

看起来，好吧，但等等。这只猫会吠（爱猫的人会因此而杀了我）。吠叫的猫违反了宇宙的原则。所以我们需要重写 Bark 方法，让它什么都不做。

```
class Cat is Dog
  Purr; 
  Bark = null;
end; 
```

好吧，这行得通，但它闻起来很臭。所以让我们尝试一个聚合：

```
class Cat
  has Dog;
  Eat = Dog.Eat;
  Walk = Dog.Walk;
  Play = Dog.Play;
  Purr;
end; 
```

好的，这很好。这只猫不再吠叫，甚至不再沉默。但它仍然有一只想要出去的内在狗。因此，让我们尝试解决方案三：

```
class Pet
  Eat;
  Walk;
  Play;
end;

class Dog is Pet
  Bark;
end;

class Cat is Pet
  Purr;
end; 
```

这干净多了。没有内犬。猫和狗处于同一水平。我们甚至可以引入其他宠物来扩展模型。除非是鱼，或者不会走路的东西。在这种情况下，我们再次需要重构。但那是另一回事了。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2008-11-06T17:28:00.573

在[GOF](https://rads.stackoverflow.com/amzn/click/com/0201633612)开始时，他们声明

> 优先考虑对象组合而不是类继承。

[这将在此处](http://www.artima.com/lejava/articles/designprinciples4.html)进一步讨论

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2008-11-06T17:25:52.840

差异通常表示为“是一个”和“有一个”之间的差异。[继承，即“是”关系，在Liskov Substitution Principle](http://en.wikipedia.org/wiki/Liskov_substitution_principle)中得到了很好的总结。聚合，“具有”关系，就是这样 - 它表明聚合对象*具有*聚合对象之一。

还存在进一步的区别 - C++ 中的私有继承表示“根据”关系实现，也可以通过（非公开）成员对象的聚合来建模。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2008-11-06T17:33:23.903

这是我最常见的论点：

在任何面向对象的系统中，任何类都有两个部分：

1.  它的*界面*：对象的“公众面孔”。这是它向世界其他地方宣布的一组功能。在许多语言中，集合被很好地定义为“类”。通常这些是对象的方法签名，尽管它因语言而异。

2.  它的*实现*：对象为满足其接口并提供功能所做的“幕后”工作。这通常是对象的代码和成员数据。

OOP 的基本原则之一是实现被*封装*（即：隐藏）在类中；外人唯一应该看到的是界面。

当子类从子类继承时，它通常*同时*继承实现和接口。反过来，这意味着你*被迫*接受这两者作为你班级的约束。

使用聚合，您可以选择实现或接口，或两者兼而有之——但您不会被迫选择其中任何一个。对象的功能由对象本身决定。它可以随心所欲地服从其他对象，但最终要对自己负责。以我的经验，这导致了一个更灵活的系统：一个更容易修改的系统。

因此，每当我开发面向对象的软件时，我几乎总是更喜欢聚合而不是继承。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-11-06T17:48:19.753

[我对“Is a”和“Has a”](https://stackoverflow.com/questions/263355/is-a-vs-has-a-which-one-is-better)给出了答案：哪个更好？.

基本上我同意其他人的观点：仅当您的派生类确实*是*您要扩展的类型时才使用继承，而不仅仅是因为它*包含*相同的数据。请记住，继承意味着子类获得方法和数据。

派生类拥有超类的所有方法是否有意义？还是你只是悄悄地向自己保证在派生类中应该忽略这些方法？或者您是否发现自己覆盖了超类中的方法，使它们成为无操作的，因此没有人无意中调用它们？或者提示您的 API 文档生成工具以省略文档中的方法？

这些都是强有力的线索，表明在这种情况下聚合是更好的选择。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-06T18:12:07.083

我看到很多关于这个和相关问题的“is-a vs. has-a；它们在概念上是不同的”回答。

根据我的经验，我发现的一件事是，试图确定一段关系是“is-a”还是“has-a”注定会失败。即使您现在可以正确地确定对象，但不断变化的需求意味着您在未来的某个时候可能会出错。

我发现的另一件事是，一旦围绕继承层次结构编写了大量代码，就*很难*从继承转换为聚合。仅仅从超类切换到接口就意味着改变系统中的几乎每个子类。

而且，正如我在本文其他地方提到的，聚合往往不如继承灵活。

因此，每当您必须选择一个或另一个时，您都会遇到反对继承的完美风暴：

1.  在某些时候，您的选择可能是错误的
2.  一旦你做出改变这个选择是很困难的。
3.  继承往往是一个更糟糕的选择，因为它更具约束性。

因此，我倾向于选择聚合——即使似乎存在很强的 is-a 关系。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-06T17:31:50.863

这个问题通常被表述为[Composition vs. Inheritance](https://stackoverflow.com/questions/49002/prefer-composition-over-inheritance)，并且之前已经在这里提出过。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-06T19:24:29.980

我想对原始问题发表评论，但有 300 个字符咬 [;<)。

我认为我们需要小心。首先，除了问题中提出的两个相当具体的例子之外，还有更多的口味。

另外，我建议不要将目标与仪器混淆。人们想确保所选择的技术或方法论支持实现主要目标，但我不认为断章取义的技术是最好的讨论是非常有用的。它确实有助于了解不同方法的陷阱以及它们明显的最佳点。

例如，您要完成什么，您可以从什么开始，以及限制是什么？

您是否正在创建一个组件框架，甚至是一个特殊用途的框架？接口是否可以与编程系统中的实现分开，还是通过使用不同类型技术的实践来完成？你能把接口的继承结构（如果有的话）和实现它们的类的继承结构分开吗？从依赖于实现提供的接口的代码中隐藏实现的类结构是否重要？是否有多个实现可以同时使用，或者由于维护和增强，随着时间的推移变化更多？在您专注于工具或方法之前，需要考虑这一点以及更多。

最后，将抽象中的区别以及您如何看待它（如 is-a 与 has-a）锁定到 OO 技术的不同特性是否很重要？也许是这样，如果它使您和其他人的概念结构保持一致且易于管理。但明智的做法是不要被它和你最终可能做出的扭曲所奴役。也许最好退后一步，不要那么死板（但要留下好的叙述，以便其他人知道发生了什么）。[我寻找使程序的特定部分可解释的原因，但有时当有更大的胜利时，我会追求优雅。并不总是最好的主意。]

我是一个接口纯粹主义者，无论是构建 Java 框架还是组织一些 COM 实现，我都对接口纯粹主义适用的各种问题和方法感兴趣。即使我发誓，这并不能使它适合所有事物，甚至不能接近所有事物。（我有几个项目似乎提供了针对界面纯粹主义的严肃反例，所以看看我如何应对会很有趣。）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-11-06T17:28:19.763

我将介绍这些可能适用的部分。在游戏场景中，这是两者的示例。假设有一个游戏有不同类型的士兵。每个士兵可以有一个背包，可以装不同的东西。

**继承在这里？** 有海军陆战队、绿色贝雷帽和狙击手。这些是士兵的类型。因此，有一个基类 Soldier，其中 Marine、Green Beret 和 Sniper 作为派生类

**聚合在这里？** 背包可以包含手榴弹、枪支（不同类型）、刀、医疗包等。士兵可以在任何给定时间点装备这些中的任何一种，此外，他还可以拥有防弹背心，在受到攻击时充当盔甲，他的伤害降低到一定比例。士兵类包含防弹背心类的对象和包含对这些项目的引用的背包类。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-06T17:31:42.033

我认为这不是非此即彼的辩论。就是这样：

1.  is-a（继承）关系的发生频率低于 has-a（组合）关系。
2.  继承更难正确，即使它适合使用它，所以必须尽职尽责，因为它会破坏封装，通过暴露实现等来鼓励紧密耦合。

两者都有自己的位置，但继承风险更大。

当然，拥有一个 Shape 'have-a' Point 类和一个 Square 类是没有意义的。继承权到此为止。

人们在尝试设计可扩展的东西时倾向于首先考虑继承，这是错误的。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-09-20T13:28:23.627

当两个候选人都符合条件时，就会出现青睐。A 和 B 是选项，你喜欢 A。原因是组合提供了比泛化更多的扩展/灵活性可能性。这种扩展/灵活性主要是指运行时/动态灵活性。

好处不是立即可见的。要查看好处，您需要等待下一个意外更改请求。所以在大多数情况下，那些坚持概括的人与那些接受组合的人相比是失败的（除了后面提到的一个明显的例子）。因此规则。从学习的角度来看，如果您可以成功实现依赖注入，那么您应该知道要支持哪个以及何时支持。该规则也可以帮助您做出决定；如果您不确定，请选择构图。

总结：组合：只需将一些较小的东西插入更大的东西，就可以减少耦合，而较大的对象只会调用较小的对象。泛化：从 API 的角度来看，定义一个方法可以被覆盖是比定义一个方法可以被调用更强有力的承诺。（泛化获胜的情况很少）。并且永远不要忘记，通过组合，您也使用继承，从接口而不是大类

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-06T17:28:38.653

两种方法都用于解决不同的问题。从一个类继承时，您并不总是需要聚合两个或多个类。

有时您确实必须聚合单个类，因为该类是密封的或具有您需要拦截的其他非虚拟成员，因此您创建了一个代理层，该代理层显然在继承方面无效，但只要您正在代理的类有一个你可以订阅的界面，这可以很好地工作。

# .net - .NET 表单身份验证 cookie 无法在其他应用程序中访问

> ID：269499
> 
> 赞同：1
> 
> 时间：2008-11-06T17:18:16.210
> 
> 标签：.net, forms-authentication

我有一个使用标准 .NET 表单身份验证 cookie 的应用程序，现在我需要从托管在同一域上的应用程序中获取此 cookie，但一个文件夹下有它自己的应用程序。

我似乎无法使用 Request.Cookies.AllKeys 找到 cookie 的任何痕迹，这一定是有原因的，因为当我检查 cookie 的详细信息时它仍然存在并且路径设置为“/ “这意味着我应该能够访问它？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T17:28:16.080

在 asp.net 中，您需要确保每个域上的机器密钥相同，并且 cookie 使用相同的名称。仅当您在同一个域中时，身份验证才有效。

# .net - 将通用列表与数组进行比较

> ID：269513
> 
> 赞同：3
> 
> 时间：2008-11-06T17:23:45.233
> 
> 标签：.net, arrays, list

为什么 generic.list 比数组慢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T17:27:05.320

通用列表比数组稍慢，但在大多数情况下您不会注意到。大多数情况下，它与稍微复杂一点的查找有关：据说 List 使用了“幕后”的数组，但不能保证以与数组相同的方式将节点保留在相邻内存中。

但是，我在 2005 年看到了一些基准测试（现在找不到链接）并且差异*非常*小。

此外，与数组相比，列表具有许多重要优势：主要是添加或删除项目很简单。当您不知道需要多少项目或该数字会发生变化时，使用列表会容易得多。在这些情况下（老实说，*大部分时间都是这样*），您可能不应该*使用*数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T22:01:28.323

在读取性能方面，有两个因素：

*   一个额外的取消引用（`List<T>`即将包含一个`T[]`字段，并且必须取消引用它）
*   它不能使用一些存在的编译器优化`T[]`- 例如消除循环期间的边界检查

但是，添加到 a 中要容易得多`List<T>`，特别是因为它保留了备用空间 - 即它不必为了添加单个元素而调整整个数组的大小/blit。

# ruby-on-rails - 如何实现版本化的 ActiveRecord 关联？

> ID：269518
> 
> 赞同：5
> 
> 时间：2008-11-06T17:24:29.677
> 
> 标签：ruby-on-rails, activerecord, associations

我想使用版本化的 ActiveRecord 关联。*例如*，我想找到另一个对象属于某个过去日期的对象，或者在此之前它属于的对象。是否已经存在一个库子类化 Rails 的 ActiveRecord 以提供版本关系？或者其他一些提供持久版本关系的 Ruby 库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-07T07:10:47.963

试试[ActsAsVersioned](http://ar-versioned.rubyforge.org/)插件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-07T14:58:36.120

如果您不处理大量数据，并且额外的时间维度不会将您的数据库推到边缘，那么历史版本化数据没有重大缺点。额外的查询复杂性可能会有点痛苦，但这并不是什么大问题。

就我而言，我编写了一个处理版本控制的 rails 插件，它为每个版本控制表添加了 5 列（并帮助处理查询/操作等）：

**valid_from** - datetime - 创建此版本的日期时间

**valid_to** - datetime - 此版本停止有效的日期时间

**root_id** - 整数 - 原始行的 id（这是后续版本）

**created_by** - 整数 - 执行创建此版本的用户的用户 ID

**reserved_by** - 整数 - 停用此版本的用户的用户 ID

对于当前活动的行，valid_to 为空。在 valid_to 上添加索引有助于保持性能快速。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T17:32:37.773

在事务性应用程序中支持历史状态是大规模扩展复杂性、降低数据库性能和让自己生活困难的好方法。如果您只需要显示或报告历史状态而不需要它，请考虑构建一个具有[Type-II 缓慢变化维度](http://en.wikipedia.org/wiki/Slowly_changing_dimension)和更新它的周期性过程的星型模式。

这将比使用通过代码库运行的系统临时历史跟踪构建应用程序复杂得多。如果这种方法可以满足您对应用程序的要求，那么您可能会做得更好。这也意味着应用程序数据库将与系统附带的普通数据库访问机制很好地配合使用。

如果您需要相当频繁的刷新，您可以在数据库上实现更改数据捕获系统，如果应用程序只需要关注当前状态，这相对简单。使用 CDC 机制，加载过程只需根据更改进行更新，并且运行速度相对较快。

# windows - Emacs 和 cygwin

> ID：269520
> 
> 赞同：1
> 
> 时间：2008-11-06T17:24:56.727
> 
> 标签：windows, shell, emacs, cygwin, cmd

如何更改我的 GNUemacs 以打开 cygwin 终端，而不是使用 shell 命令的 cmd 终端？

> **关闭**为 [如何从 Emacs 中运行 Cygwin Bash Shell？](https://stackoverflow.com/questions/235254/how-can-i-run-cygwin-bash-shell-from-within-emacs).

# wpf - 如何将 WPF TreeView HierarchicalDataTemplate 与 LINQ to Entities 一起使用？

> ID：269523
> 
> 赞同：14
> 
> 时间：2008-11-06T17:25:20.470
> 
> 标签：wpf, linq, entity-framework, data-binding, xaml

我的 .edmx ADO.NET 实体数据模型文件中有一个 Page 类，其中包含 Parent 和 Children 属性。它用于页面的层次结构。

*删除了死 ImageShack 链接 - ADO.NET 实体框架分层页面类*

这是在我的 SQL 数据库中处理的，Page 表中的 ParentId 外键绑定到同一个 Page 表的 Id 主键。

如何在 WPF TreeView 中显示此层次结构？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-07T20:25:44.773

我在[Abe Heidebrecht](https://stackoverflow.com/users/9268/abe-heidebrecht)的帮助下完成了这项工作。非常感谢他。

这是我的 XAML ......

```
<Window x:Class="Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:PageManager"
    Title="Window1" Height="300" Width="300" Name="Window1">
    <Grid>
        <TreeView Margin="12" Name="TreeViewPages" ItemsSource="{Binding}" TreeViewItem.Expanded="TreeViewPages_Expanded">
            <TreeView.Resources>
                <HierarchicalDataTemplate DataType="{x:Type local:Page}" ItemsSource="{Binding Children}">
                    <TextBlock Text="{Binding Path=ShortTitle}" />
                </HierarchicalDataTemplate>
            </TreeView.Resources>
        </TreeView>
    </Grid>
</Window> 
```

这是我的 Visual Basic 代码...

```
Class Window1

    Private Sub Window1_Loaded(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
        Dim db As New PageEntities
        Dim RootPage = From p In db.Page.Include("Children") _
                       Where (p.Parent Is Nothing) _
                       Select p
        TreeViewPages.ItemsSource = RootPage
    End Sub

    Private Sub TreeViewPages_Expanded(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs)
        Dim ExpandedTreeViewItem As TreeViewItem = DirectCast(e.OriginalSource, TreeViewItem)
        Dim PageId As Guid = DirectCast(ExpandedTreeViewItem.DataContext, Page).Id
        Dim db As New PageEntities
        Dim ChildPages = From p In db.Page.Include("Children") _
                         Where p.Parent.Id = PageId _
                         Select p
        ExpandedTreeViewItem.ItemsSource = ChildPages
    End Sub
End Class 
```

当窗口加载时，从数据库中查询根节点及其子节点并将其插入树中。

每次展开节点时，都会从数据库中查询该节点的子节点和孙节点并将其插入树中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-17T01:38:41.700

一种不同的方式：（嗯，非常相似，但略有不同）

在您的窗口加载功能中：

```
PageEntities db = new PageEntities();
TreeViewPages.ItemsSource = db.Page.Where(u=>u.Parent==null); 
```

创建一个新文件 Page.cs

```
public partial class Page {
    public ObjectQuery<Page> LoadedChildren {
        get {
            var ret = Children;
            if(ret.IsLoaded==false) ret.Load();
            return ret;
        }
    }
} 
```

在您的 XAML 中：

```
<TreeView Name="TreeViewPages">
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemSource="{Binding LoadedChildren}">
            <TextBlock Text="{Binding ShortTitle}" />
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

它没有经过测试，但你应该得到一般的想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-29T20:35:06.687

第二种解决方案最适合我。我有一个递归对象列表，所以这是我使用的 XAML：

```
<TreeView Height="Auto" HorizontalAlignment="Stretch" Name="trvVaults" VerticalAlignment="Stretch" Width="Auto" Grid.Column="0" Margin="5">
    <!--  Treeview ItemsSource is loaded programmatically  -->
    <TreeView.ItemTemplate>
        <HierarchicalDataTemplate ItemsSource="{Binding Vaults}">
            <TextBlock Text="{Binding Name}" />
        </HierarchicalDataTemplate>
    </TreeView.ItemTemplate>
</TreeView> 
```

每个“Vault”对象都有几个属性（名称、位置等）和一个“Vaults”的通用列表。

# .net - NHibernate HQL 不支持“with”关键字吗？

> ID：269541
> 
> 赞同：4
> 
> 时间：2008-11-06T17:28:53.537
> 
> 标签：.net, nhibernate, hql

我正在尝试构建一个可以从集合中留下连接值的 HQL，以便让我有机会在其上检查“为空”。

取自休眠手册中的示例：

```
来自猫为猫
    left join cat.kittens as kitten
        与 kitten.bodyWeight > 10.0

```

似乎在 NHibernate 中不起作用，因为它不识别“with”关键字。如果您不能直接在您的连接中而不是在您的 WHERE 语句中指定连接子句，您还应该如何离开连接并检查不匹配的条目？

我正在运行 NHibernate 2.0.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T18:13:35.677

不幸的是，NHibernate 不支持这一点。它[于 2005 年首次被请求，](http://jira.nhibernate.org/browse/NH-514)是迄今为止最受欢迎的请求功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T08:46:12.923

我认为您可以通过使用外部联接来解决它，然后执行以下操作：

```
from Cat c
left join c.Kittens as kitten
where kitten.bodyweight > 10 or kitten.bodyweight is null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T15:42:55.530

显然他们正在努力...... [https://nhibernate.jira.com/browse/NH-514](https://nhibernate.jira.com/browse/NH-514)

我昨天收到了来自 NHibernate JIRA 的更新报告，这个问题应该在 NHibernate v2.1.0 Alpha 3 中得到修复：)

# jquery - 显示的 jQuery 日期选择器年份

> ID：269545
> 
> 赞同：78
> 
> 时间：2008-11-06T17:31:13.937
> 
> 标签：jquery, datepicker

使用 jQuery 日期选择器，如何更改显示的年份范围？在 jQuery UI 网站上，它说默认值为“显示当前年份前后 10 年”。我想用它来选择生日，而在今天之前的 10 年并不好。这可以用 jQuery datepicker 完成还是我必须使用不同的解决方案？

日期选择器演示链接：http: [//jqueryui.com/demos/datepicker/#dropdown-month-year](http://jqueryui.com/demos/datepicker/#dropdown-month-year)

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2008-11-06T17:36:16.283

如果您稍微向下看一下演示页面，您会看到“限制日期选择器”部分。使用下拉菜单指定“ `Year dropdown shows last 20 years`”演示，然后点击查看源代码：

```
$("#restricting").datepicker({ 
    yearRange: "-20:+0", // this is the option you're looking for
    showOn: "both", 
    buttonImage: "templates/images/calendar.gif", 
    buttonImageOnly: true 
}); 
```

你会想要做同样的事情（显然改变`-20`或`-100`什么）。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2010-11-01T11:32:36.453

为什么不显示年份或月份选择框？

```
$( ".datefield" ).datepicker({
    changeMonth: true,
    changeYear: true,
    yearRange:'-90:+0'
}); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-07-31T06:19:51.823

没有人提出的是您还可以设置硬编码的日期范围：

例如：

```
yearRange: "1901:2012" 
```

虽然建议不要这样做，但它是一个完全有效的选项（如果您在目录中合法地寻找特定年份 - 例如 "1963:1984" ，则很有用）。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-04-12T00:31:19.133

完美的出生日期字段（以及我使用的）类似于 Shog9 所说的，尽管我将给出一个更具体的 DOB 示例：

```
$(".datePickerDOB").datepicker({ 
    yearRange: "-122:-18", //18 years or older up to 122yo (oldest person ever, can be sensibly set to something much smaller in most cases)
    maxDate: "-18Y", //Will only allow the selection of dates more than 18 years ago, useful if you need to restrict this
    minDate: "-122Y"
}); 
```

希望未来的谷歌人发现这很有用:)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-06T17:41:04.153

除了@Shog9 发布的内容之外，您还可以在 beforeShowDay: 回调函数中单独限制日期。

您提供一个接受日期并返回布尔数组的函数：

```
"$(".selector").datepicker({ beforeShowDay: nationalDays}) 
natDays = [[1, 26, 'au'], [2, 6, 'nz'], [3, 17, 'ie'], [4, 27, 'za'], 
[5, 25, 'ar'], [6, 6, 'se'], [7, 4, 'us'], [8, 17, 'id'], [9, 7, 
'br'], [10, 1, 'cn'], [11, 22, 'lb'], [12, 12, 'ke']]; 
function nationalDays(date) { 
    for (i = 0; i < natDays.length; i++) { 
      if (date.getMonth() == natDays[i][0] - 1 && date.getDate() == 
natDays[i][1]) { 
        return [false, natDays[i][2] + '_day']; 
      } 
    } 
  return [true, '']; 
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-02-12T11:19:57.257

```
 $("#DateOfBirth").datepicker({
        yearRange: "-100:+0",
        changeMonth: true,
        changeYear: true,
    }); 
```

yearRange: '1950:2013', // 指定硬编码的年份范围或这种方式

yearRange: "-100:+0", // 过去一百年

这将有助于显示年份和月份选择的下拉菜单。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-07T05:26:08.987

au、nz、ie 等是显示国庆日的国家/地区的国家代码（澳大利亚、新西兰、爱尔兰...）。从代码中可以看出，这些值与 '_day' 组合并传递回以作为 CSS 样式应用于当天。相应的样式如下所示，它将当天的文本移到一边，并用国旗图像替换它。

```
.au_day {
  text-indent: -9999px;
  background: #eee url(au.gif) no-repeat center;
} 
```

用新样式传回的 'false' 值表示这些天可能不会被选中。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-05-15T11:55:39.193

我认为这也可以

```
$(function () {
    $(".DatepickerInputdob").datepicker({
        dateFormat: "d M yy",
        changeMonth: true,
        changeYear: true,
        yearRange: '1900:+0',
        defaultDate: '01 JAN 1900'
    }); 
```

# crystal-reports - 奇怪的 CrystalReportsViewer 工具栏行为

> ID：269547
> 
> 赞同：0
> 
> 时间：2008-11-06T17:31:36.963
> 
> 标签：crystal-reports, windows-server-2008

我有一个`CrystalReportsViewer's`令我困惑的工具栏问题。假设我有一份包含五页的报告。

*   如果我单击下一步按钮，我会`page two`按预期到达，但如果我再次按下它，则会重新`page two`加载！

*   我可以单击`last page`按钮并进入`last page`，但如果我尝试从那里转到上一页，我会`page one`再次进入。

所以，不管我的报告有多少页，我只能到第一、第二和最后一页！

这些问题从我们迁移`Windows Server 2003`到`2008`. 我们`Crystal Reports 10`在2008年下运行哪个可能有问题？2008 年的任何新安全产品都可以对此负责吗？

有没有人见过这种行为并知道如何解决它？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-15T17:32:43.593

以前从未见过该开发工具，因此它不会出现在我们支持的平台中。

我记得类似的事情，这是由于屏幕分辨率或缩放级别。

查看页面的源代码，看看它在做什么。将其与 VS .NET ASP.NET 应用程序进行比较，看看有什么不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T22:24:06.560

我以前从未见过这种奇怪的行为，但我从几个月前参与的一个项目中知道，Win2k8 / IIS7 尚不支持 Crystal Reports。我希望我能找到一个链接，说明你，但我记得遇到了这个问题。

我不得不去设置一个虚拟服务器来托管 Win2k3，这样我才能发布一些报告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T06:00:05.050

糟糕，这似乎与编程无关（尽管有一定数量的编程来显示报告并且 CrystalReportViewer 是一个服务器控件），对此很抱歉。

感谢肯您的意见。我敢打赌，我们也在运行旧版本的 CR，这对我没有帮助。也许您使用虚拟 2003 机器的路线是最好的选择。

# visual-studio-2008 - 有没有办法在 Visual Studio 2008 中以 8.5 版格式保存或编辑 Crystal 报表？

> ID：269555
> 
> 赞同：0
> 
> 时间：2008-11-06T17:33:46.880
> 
> 标签：visual-studio-2008, crystal-reports

我有一个水晶报表文件，我需要在其中进行微小的编辑。它是在水晶报表 8.5 中/为水晶报表创建的。

我可以在 Visual Studio 2008 中打开它，但保存文件会更新文件版本，并且报告因读取它的第三方软件（Actinic）而失败。

我对水晶报表了解不多。有没有办法可以在不破坏文件的情况下编辑文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T17:48:12.157

您将需要一份 Crystal 8.5 的副本。更高版本不向后兼容。

# unix - 更改信号量的所有权/权限

> ID：269556
> 
> 赞同：0
> 
> 时间：2008-11-06T17:33:52.637
> 
> 标签：unix, permissions, semaphore

有没有办法直接从命令提示符更改 Unix 系统上信号量的所有权和权限掩码，而无需部署`semctl`使用该`IPC_SET`选项调用的特殊程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T17:43:17.393

我不知道任何标准实用程序，但[此处](ftp://ftp.mcs.anl.gov/pub/mpi/misc/semtool.c)列出的程序可以更改信号量模式。

扩展它以允许更改所有权应该是一个非常简单的练习。

# map - OCaml 有通用的 map()/reduce() 函数吗？

> ID：269560
> 
> 赞同：19
> 
> 时间：2008-11-06T17:35:36.877
> 
> 标签：map, polymorphism, ocaml, reduce

在 Python 中，map() 适用于任何遵循序列协议的数据。无论我给它一个字符串还是一个列表甚至是一个元组，它都会做正确的事情^TM。

我不能在 OCaml 中也有我的蛋糕吗？我真的别无选择，只能查看我正在使用的集合类型并找到相应的 List.map 或 Array.map 或 Buffer.map 或 String.map？其中一些甚至不存在！我的要求是不是很不寻常？我肯定错过了什么。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-06T18:51:48.767

最接近这一点的是 OCaml Batteries Included 中的模块[`Enum`](http://batteries.forge.ocamlcore.org/doc.preview/batteries-alpha1/batteries/html/api/Data.Mutable.Enum.html)（[以前](http://batteries.forge.ocamlcore.org/)属于[Extlib](http://ocaml-extlib.googlecode.com/)）。`Enum`定义地图和折叠`Enum.t`；您只需要`Enum.t`为您的数据类型使用与/从的转换。转换可以是相当轻量级的，因为`Enum.t`它是惰性的。

你真正想要的是 Haskell 风格的[类型类](http://en.wikipedia.org/wiki/Type_class)，比如`Foldable`和`Functor`（它概括了“地图”）。Haskell 库定义了列表、数组和树`Foldable`的实例。`Functor`另一种相关技术是泛型编程的[“废弃样板”方法。](http://www.cs.vu.nl/boilerplate/)由于 OCaml 不支持类型类或[更高种类的多态性](http://lambda-the-ultimate.org/node/2579)，我认为您无法在其类型系统中表达这样的模式。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-06T11:16:58.820

OCaml 中主要有两种解决方案：

1.  几年前，Jacques Garrigue 已经为许多数据结构实现了一种语法轻量但效率低下的方法。您只需将集合包装在提供`map`方法的对象中。然后，您可以`collection#map`将 map 函数用于任何类型的集合。这比您的要求更通用，因为它允许*在运行时*替换不同类型的数据结构。然而，这在实践中并不是很有用，因此该方法从未被广泛采用。

2.  一个语法上更重但高效、健壮和静态的解决方案是使用仿函数来参数化您正在使用的数据结构上的代码。这使得重用具有不同数据结构的代码变得微不足道。有关一些很好的示例，请参阅 Markus Mottl 对 Okasaki 的书“Purely Functional Data Structures”的 OCaml 翻译。

如果您不是在寻找那种强大的功能并且只是想要简洁，那么当然，您可以创建一个具有较短名称的模块别名（例如 module S = String）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T19:13:42.593

问题是每个容器都有不同的表示形式，并且需要不同的 map/reduce 代码来迭代它。这就是为什么有单独的功能。大多数语言都为容器提供了某种通用接口（例如您提到的序列协议），因此可以抽象地实现 map/reduce 之类的功能，但是对于您提到的类型却没有这样做。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2008-11-29T02:58:56.793

只要您在模块中定义类型 t 和 val 比较 (: t->t->int)，Map.Make 就会为您提供所需的地图。

# sql-server-2005 - 在夜间作业中编写 SQL 2005 数据库结构脚本

> ID：269562
> 
> 赞同：4
> 
> 时间：2008-11-06T17:36:17.967
> 
> 标签：sql-server-2005

我想要一份每晚甚至每周只运行一次的工作，它会生成我们开发数据库的脚本。它们往往会被修补，开发人员习惯于在不编写脚本或记录它们的情况下进行更改。

我想创建一个工作，该工作基本上会模仿我右键单击并执行任务 > 生成脚本时发生的情况。这意味着如果发生了一些糟糕的事情，我们能够重建结构（内容是“可生成的”），并且可以备份并运行，而无需从可能同时丢失的备份中恢复作为坏事发生。

我已经阅读了有关 sqlpubwiz 的信息，但我在开发机器上找不到它，只能在我的本地机器上找到它，我只安装了客户端工具。我走的是正确的路线吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T18:59:26.537

我会建议一种对我来说效果很好的不同方法。运行一个夜间作业，删除开发数据库，​​从已知配置中恢复它们，然后应用所有已提交到源代码控制的更改脚本。

这种方法的优点：

*   每晚都会测试您的更改脚本
*   没有无脚本的数据库更改
*   开发人员快速学会创建更改脚本并将其提交到源代码控制

当我采用这种方法时，我使用了最新的生产备份作为还原源。这引入了不确定性，因为生产中的数据更改可能会导致意外的事情发生，但如果您需要快速响应生产问题，则效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T17:44:08.420

可以从命令行运行的[数据库发布向导。](http://www.codeplex.com/sqlhost/wiki/view.aspx?title=database%20publishing%20wizard)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:21:22.717

[APEXSQL 脚本](http://www.apexsql.com/sql_tools_script.asp)- 使用命令行版本 - 只需检查版本控制或其他

# internet-explorer - 使用 Internet Explorer 无法正确显示我的博客

> ID：269564
> 
> 赞同：0
> 
> 时间：2008-11-06T17:37:17.187
> 
> 标签：internet-explorer, cross-browser

我相信这对本网站的所有读者来说都是容易的事情，但这种问题对我来说很难。

我有一个网站[http://www.areacatracha.com](http://www.areacatracha.com)在 Internet Explorer 中没有正确显示。其他浏览器正常显示。

谁能帮我？

关于如何开始修复这些跨浏览器兼容性问题的任何建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T18:03:01.223

在您提供的链接上快速浏览后，我有以下建议：

使用 html 验证器验证您的 HTML 代码。一种可能性是使用 validator.w3.org。

使用 Firefox 的 HTML Validator 插件，我在渲染页面时遇到了 500 多个错误。我相当肯定这些错误中的一个或多个是导致页面无法在 IE 中呈现的原因。

通过验证确定错误后，您可以修复它们。;-)

# javascript - JavaScript 锚 - 访问另一个 HTML 页面上的 id

> ID：269566
> 
> 赞同：0
> 
> 时间：2008-11-06T17:38:36.920
> 
> 标签：javascript, html, anchor

我有两个 html 页面，当您单击第一个 html 上的某些内容时，它将转到第二个页面。我想要做的是根据您在第一个 html 上单击的内容显示文本。不同的文本用不同的 id 包裹。我是这样写的：

```
<a href="secondpage.html#one"></a>
<a href="secondpage.html#two"></a>
<a href="secondpage.html#three"></a> 
```

我期待看到 two.html 加载 id 为“one”的文本，但它不起作用，有谁知道我做错了什么？

这是第二页上的代码：

```
<ul id="menu" class="aaa">
    <li><a id="one" href="#">one</a></li>
    <li><a id="two" href="#">two</a></li>
    <li><a id="three" href="#">three</a></li>
</ul> 
```

我有一个 JS 文件来修改每个 id：

```
$("one").observe('click', function() {
    $('Pic').writeAttribute('src',"picone.jpg");
    $('Bio').update("texthere!");
}); 
```

二三也一样。

现在，如果我单击第一页上的按钮，无论我单击哪个按钮，它都会始终显示“一个”的文本和图片。

但是如果我点击它，我想看到“两个”的图片和文字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T17:53:02.757

您要做的是在页面加载时模拟单击锚点。由于您使用的是 jQuery，因此最简单的方法（但形式最好）如下：

```
$(window).observe('domready', function () {
    $(location.hash).click();
});

```

将 ondomready-event 附加到窗口。获取 id=one 的元素（使用 jQuery，这将是 '#one'，与您的 location.hash 相同，在这种情况下非常方便），触发点击它。

您可能需要替换 $(location.hash).click(); 使用 $(location.hash).get(0).click() 因为 jQuery 倾向于返回 jQuery 对象数组。

但是在您的情况下，更好的解决方案是拥有一个可以手动触发的事件处理程序，从而避免触发事件的需要，以及放下锚点并将 onclick 直接放在您的 li 上。

此外，当您似乎只想动态显示/隐藏内容时，为什么还要加载第二页？在同一页面上执行...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T17:47:45.713

#blastuffbla 不是 ID，而是位置哈希。您可以使用以下方式访问它：

```
self.document.location.hash 
```

这将返回#hash，如果你只想使用你会使用的哈希：

```
self.document.location.hash.substring(1) 
```

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T19:21:49.377

标签没有 id 而是名称来处理 Urls 中的锚点，但您仍然需要 ID 来在 JS 中管理它们。所以你的清单应该是：

```
<ul id="menu" class="aaa">
<li><a id="one" name="one" href="#">one</a></li>
<li><a id="two" name="two" href="#">two</a></li>
<li><a id="three" name="three" href="#">three</a></li></ul> 
```

不过，您的 javascript 似乎是正确的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T17:46:08.947

当您说“不同的 ID”时，您是如何在第二页设置锚点的？第 2 页的锚点应如下所示：

```
<a name='one'></a> 
```

将其放在第二页上要标记的文本的正上方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T17:49:37.317

是否要将页面滚动到 id "one" 的位置？可能页面内容太小，无法滚动到那里。我的意思是有时浏览器无法将标有 id 的元素移动到画布的顶部，并且看起来它不会在那里滚动。尝试在元素之后包含足够的空间以使其可滚动到浏览器顶部。

希望有帮助。

# oracle - 从 ADO.NET 使用并涉及触发器时的 Oracle 事务范围？

> ID：269570
> 
> 赞同：2
> 
> 时间：2008-11-06T17:39:39.397
> 
> 标签：oracle, ado.net, transactions, triggers

有人告诉我，当从 ADO.net 调用 Oracle 时，当在循环中调用多个插入时，每个插入都会触发一个触发器，该触发器在其 PL-Sql 中包含一个 Commit 语句，因此无法停止该提交实际提交事务。

即，我希望我的 ADO.Net 代码在循环开始之前开始一个事务，并且当循环退出时，仅当且仅当循环中的每个插入都成功时才提交所有插入。我的消息来源告诉我 Oracle 的工作方式，如果这些触发器包括 COMmit 语句，那么这是不可能的..

由于这似乎是一个非常普遍的要求，而且我知道它在 SQL Server 中是可能的，所以这对我来说似乎不正确。

它是否正确？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T17:52:16.733

您的线人是错误的，如果他在谈论 Oracle 数据库触发器：

1）您**不能**将 COMMIT 放在非自治的 Oracle 触发器中：

```
SQL> create trigger this_wont_work
  2  after insert on emp
  3  begin
  4    commit;
  5  end;
  6  /

Trigger created.

SQL> insert into emp (empno) values (123)
  2  /
insert into emp (empno) values (123)
            *
ERROR at line 1:
ORA-04092: cannot COMMIT in a trigger
ORA-06512: at "TONY.THIS_WONT_WORK", line 2
ORA-04088: error during execution of trigger 'TONY.THIS_WONT_WORK' 
```

2) 如果触发器是自治的（即在其声明部分有 PRAGMA AUTONOMOUS_TRANSACTION），那么它只能提交它（触发器）所做的任何更改。

触发器提交您在该触发器之外所做的工作没有任何危险。

注意：在触发器中使用自治事务是危险的，除了某些情况，因为即使触发语句回滚，自治触发器执行的操作也会被提交。如果使用不当，这很容易导致数据损坏。

# php - 在php中翻译多种语言

> ID：269577
> 
> 赞同：0
> 
> 时间：2008-11-06T17:42:14.697
> 
> 标签：php, internationalization, translation, user-input

我正在开发一个应该接受多种语言输入的小型解析器。我将有大约 50 个字符串作为解析输入的关键字/锚。在 PHP 中，组织这些翻译后的关键字的最佳方式是什么？

我想到的一种可能的解决方案是使用关联数组。像这样：

```
$lang = array('us' => array('totalDebt' => 'Total Debt', 'color' => 'Color'),
              'gb' => array('totalDebt' => 'Total Debt', 'color' => 'Colour')) 
```

然后我可以使用以下内容访问：

```
$langCode = 'en';
$debtPos = strpos($lang[$langCode]['totalDebt']); 
```

有没有更好的、经过验证的方法来处理一堆翻译成多种语言的短字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T19:10:43.783

对于完整的翻译解决方案，您可以查看[gettext 之](http://www.php.net/manual/en/intro.gettext.php)类的解决方案。

您的解决方案对于小型词典来说已经足够好了（速度快、资源便宜）。我不明白您尝试使用 strpos() 函数做什么。

如果您要翻译的术语在该语言中不存在，请不要忘记使用某种后备，通常后备是英语。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T00:05:15.640

我已经看到您的解决方案在其他 OS 项目中使用，但是该`$lang`数组通常是在不同的文件中构建的。例如：

```
<?php // lang.us.php
$LANG['us'] = array(
                    'totalDebt' => 'Total Debt',
                    'color' => 'Color',
                   ); 
```

对于 lang.gb.php、lang.de.php 等，依此类推。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-07T00:32:32.323

正如彼得所说，您的想法是正确的，但是将您的语言分成不同的文件。这意味着 PHP 不必存储每种语言中每个单词的数组。因为您一次只会加载一种语言，所以您也可以跳过`$lang['us']`嵌套级别。

你甚至可以“扩展”语言：

```
<?php // lang.en-gb.php
$lang = array(
    'color' => "Colour",
    'totalDebt' => "Total Debt",
    ...
);
?>

<?php // lang.en-us.php
include('lang.en-gb.php');

$lang['color'] = "Color";
// don't need to redefine "totalDebt"
?> 
```

您甚至可以考虑创建一个为您处理所有这些的基本类：检测语言环境、选择正确的文件、进行“错误”处理、如果术语未以特定语言定义等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-07T01:15:25.263

您可能不希望 'totaldebt' => 'Total Debt' 因为这最终会混淆您的代码，并且比仅将 'Total Debt' 存储为哈希键要慢。gettext 的处理方式是将字符串包装在一个函数中。

所以而不是：

```
echo "Color"; 
```

你做：

```
echo t("Color"); 
```

t() 函数将查看全局定义的语言，并在可能的情况下进行替换。在某些时候，您可能想要使用 gettext 并且这样做是兼容的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T18:58:21.733

通常人们在他们的应用程序中使用 l10n（或类似的东西），因为它允许通过添加本地化文件来使用其他语言，这意味着程序员不必更改代码。但如果它是一个简单的脚本，那么[完全本地化](http://codeutopia.net/blog/2007/11/22/localize-your-site-in-3-easy-steps/)将是矫枉过正。

# c# - 在不使用 GetMethods 的情况下获取泛型方法

> ID：269578
> 
> 赞同：27
> 
> 时间：2008-11-06T17:42:20.123
> 
> 标签：c#, .net, generics, reflection

我想得到方法`System.Linq.Queryable.OrderyBy<T, TKey>(the IQueryable<T> source, Expression<Func<T,TKey>> keySelector)`方法，但我一直想出空值。

```
var type = typeof(T);
var propertyInfo = type.GetProperty(group.PropertyName);
var propertyType = propertyInfo.PropertyType;

var sorterType = typeof(Func<,>).MakeGenericType(type, propertyType);
var expressionType = typeof(Expression<>).MakeGenericType(sorterType);

var queryType = typeof(IQueryable<T>);

var orderBy = typeof(System.Linq.Queryable).GetMethod("OrderBy", new[] { queryType, expressionType }); /// is always null. 
```

有没有人有任何见解？我宁愿不遍历`GetMethods`结果。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-17T01:26:36.470

已解决（通过破解 LINQ）！

我在研究同样的问题时看到了你的问题。在没有找到好的解决方案后，我萌生了查看 LINQ 表达式树的想法。这是我想出的：

```
public static MethodInfo GetOrderByMethod<TElement, TSortKey>()
{
    Func<TElement, TSortKey> fakeKeySelector = element => default(TSortKey);

    Expression<Func<IEnumerable<TElement>, IOrderedEnumerable<TElement>>> lamda
        = list => list.OrderBy(fakeKeySelector);

    return (lamda.Body as MethodCallExpression).Method;
}

static void Main(string[] args)
{
    List<int> ints = new List<int>() { 9, 10, 3 };
    MethodInfo mi = GetOrderByMethod<int, string>();           
    Func<int,string> keySelector = i => i.ToString();
    IEnumerable<int> sortedList = mi.Invoke(null, new object[] { ints, 
                                                                 keySelector }
                                           ) as IEnumerable<int>;

    foreach (int i in sortedList)
    {
        Console.WriteLine(i);
    }
} 
```

输出：10 3 9

编辑：如果您在编译时不知道类型，以下是如何获取该方法：

```
public static MethodInfo GetOrderByMethod(Type elementType, Type sortKeyType)
{
    MethodInfo mi = typeof(Program).GetMethod("GetOrderByMethod", Type.EmptyTypes);

    var getOrderByMethod = mi.MakeGenericMethod(new Type[] { elementType,
                                                             sortKeyType });
    return getOrderByMethod.Invoke(null, new object[] { }) as MethodInfo;
} 
```

请务必将 typeof(Program) 替换为 typeof(WhateverClassYouDeclareTheseMethodsIn)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-06T19:42:15.903

您的解决方案的变体，作为扩展方法：

```
public static class TypeExtensions
{
    private static readonly Func<MethodInfo, IEnumerable<Type>> ParameterTypeProjection = 
        method => method.GetParameters()
                        .Select(p => p.ParameterType.GetGenericTypeDefinition());

    public static MethodInfo GetGenericMethod(this Type type, string name, params Type[] parameterTypes)
    {
        return (from method in type.GetMethods()
                where method.Name == name
                where parameterTypes.SequenceEqual(ParameterTypeProjection(method))
                select method).SingleOrDefault();
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T17:50:11.747

我不相信有一种简单的方法可以做到这一点 - 它基本上是反射 IIRC 中缺少的功能。你必须遍历这些方法才能找到你想要的:(

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-09-02T15:38:45.843

我认为以下扩展方法可以解决该问题：

```
public static MethodInfo GetGenericMethod(
  this Type type, string name, Type[] generic_type_args, Type[] param_types, bool complain = true)
{
  foreach (MethodInfo m in type.GetMethods())
    if (m.Name == name)
    {
      ParameterInfo[] pa = m.GetParameters();
      if (pa.Length == param_types.Length)
      {
        MethodInfo c = m.MakeGenericMethod(generic_type_args);
        if (c.GetParameters().Select(p => p.ParameterType).SequenceEqual(param_types))
          return c;
      }
    }
  if (complain)
    throw new Exception("Could not find a method matching the signature " + type + "." + name +
      "<" + String.Join(", ", generic_type_args.AsEnumerable()) + ">" +
      "(" + String.Join(", ", param_types.AsEnumerable()) + ").");
  return null;
} 
```

调用将类似于（只是更改原始代码的最后一行）：

```
var type = typeof(T);  
var propertyInfo = type.GetProperty(group.PropertyName);  
var propertyType = propertyInfo.PropertyType;  

var sorterType = typeof(Func<,>).MakeGenericType(type, propertyType);  
var expressionType = typeof(Expression<>).MakeGenericType(sorterType);  

var queryType = typeof(IQueryable<T>);  

var orderBy = typeof(Queryable).GetGenericMethod("OrderBy",
                                                 new Type[] { type, propertyType },
                                                 new[] { queryType, expressionType }); 
```

与其他解决方案的不同之处在于：生成的方法与参数类型完全匹配，而不仅仅是它们的通用基类型。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-08-03T20:47:55.257

今天有一个很好的替代方法`Type.MakeGenericMethodParameter`。以下代码段检索该`Queryable.OrderBy`方法：

```
var TSource = Type.MakeGenericMethodParameter(0);
var TKey = Type.MakeGenericMethodParameter(1);
var orderBy = typeof(Queryable).GetMethod(nameof(Queryable.OrderBy), 2, BindingFlags.Static | BindingFlags.Public, null, CallingConventions.Standard
    , new[] { typeof(IQueryable<>).MakeGenericType(TSource), typeof(Expression<>).MakeGenericType(typeof(Func<,>).MakeGenericType(TSource, TKey)) }
    , null);
Assert.NotNull(orderBy); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T19:11:57.837

```
var orderBy =
        (from methodInfo in typeof(System.Linq.Queryable).GetMethods()
         where methodInfo.Name == "OrderBy"
         let parameterInfo = methodInfo.GetParameters()
         where parameterInfo.Length == 2
         && parameterInfo[0].ParameterType.GetGenericTypeDefinition() == typeof(IQueryable<>)
         && parameterInfo[1].ParameterType.GetGenericTypeDefinition() == typeof(Expression<>)
         select
            methodInfo
        ).Single(); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-29T01:18:00.197

如果您在编译时确实知道类型，则可以使用更少的代码来执行此操作，而无需使用 Expression 类型，或者完全依赖于 Linq，如下所示：

```
public static MethodInfo GetOrderByMethod<TElement, TSortKey>() {
    IEnumerable<TElement> col = null;
    return new Func<Func<TElement, TSortKey>, IOrderedEnumerable<TElement>>(col.OrderBy).Method;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-08-10T21:39:31.933

使用 lambda 表达式，您可以轻松获得泛型方法

```
 var method = type.GetGenericMethod
            (c => c.Validate((IValidator<object>)this, o, action)); 
```

在此处阅读更多信息：

~~[http://www.nerdington.com/2010/08/calling-generic-method-without-magic.html](http://www.nerdington.com/2010/08/calling-generic-method-without-magic.html)~~

[http://web.archive.org/web/20100911074123/http://www.nerdington.com/2010/08/calling-generic-method-without-magic.html](http://web.archive.org/web/20100911074123/http://www.nerdington.com/2010/08/calling-generic-method-without-magic.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-24T21:53:29.073

我认为它可以用这样的类来制作：

```
public static class SortingUtilities<T, TProperty>
{
    public static IOrderedQueryable<T> ApplyOrderBy(IQueryable<T> query, Expression<Func<T, TProperty>> selector)
    {
        return query.OrderBy(selector);
    }

    public static IOrderedQueryable<T> ApplyOrderByDescending(IQueryable<T> query, Expression<Func<T, TProperty>> selector)
    {
        return query.OrderByDescending(selector);
    }

    public static IQueryable<T> Preload(IQueryable<T> query, Expression<Func<T, TProperty>> selector)
    {
        return query.Include(selector);
    }
} 
```

你甚至可以像这样使用它：

```
public class SortingOption<T> where T: class
{
    private MethodInfo ascendingMethod;
    private MethodInfo descendingMethod;
    private LambdaExpression lambda;
    public string Name { get; private set; }

    public SortDirection DefaultDirection { get; private set; }

    public bool ApplyByDefault { get; private set; }

    public SortingOption(PropertyInfo targetProperty, SortableAttribute options)
    {
        Name = targetProperty.Name;
        DefaultDirection = options.Direction;
        ApplyByDefault = options.IsDefault;
        var utilitiesClass = typeof(SortingUtilities<,>).MakeGenericType(typeof(T), targetProperty.PropertyType);
        ascendingMethod = utilitiesClass.GetMethod("ApplyOrderBy", BindingFlags.Static | BindingFlags.Public | BindingFlags.IgnoreCase);
        descendingMethod = utilitiesClass.GetMethod("ApplyOrderByDescending", BindingFlags.Static | BindingFlags.Public | BindingFlags.IgnoreCase);
        var param = Expression.Parameter(typeof(T));
        var getter = Expression.MakeMemberAccess(param, targetProperty);
        lambda = Expression.Lambda(typeof(Func<,>).MakeGenericType(typeof(T), targetProperty.PropertyType), getter, param);
    }

    public IQueryable<T> Apply(IQueryable<T> query, SortDirection? direction = null)
    {
        var dir = direction.HasValue ? direction.Value : DefaultDirection;
        var method = dir == SortDirection.Ascending ? ascendingMethod : descendingMethod;
        return (IQueryable<T>)method.Invoke(null, new object[] { query, lambda });
    }
} 
```

具有这样的属性：

```
public class SortableAttribute : Attribute 
{
    public SortDirection Direction { get; set; }
    public bool IsDefault { get; set; }
} 
```

这个枚举：

```
public enum SortDirection
{
    Ascending,
    Descending
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-10-21T16:01:09.883

只是另一个评论（应该是，但由于它太长，我必须将其作为答案发布）跟进@NeilWhitaker -s 答案（这里使用 Enumerable.Count），因为我们正在清除字符串： ) 为什么不在你的 bytype 方法中使用表达式树呢？就像是 ：

```
 #region Count
    /// <summary>
    /// gets the 
    /// public static int Count&lt;TSource>(this IEnumerable&lt;TSource> source);
    /// methodinfo
    /// </summary>
    /// <typeparam name="TSource">type of the elements</typeparam>
    /// <returns></returns>
    public static MethodInfo GetCountMethod<TSource>()
    {
        Expression<Func<IEnumerable<TSource>, int>> lamda = list => list.Count();
        return (lamda.Body as MethodCallExpression).Method;
    }

    /// <summary>
    /// gets the 
    /// public static int Count&lt;TSource>(this IEnumerable&lt;TSource> source);
    /// methodinfo
    /// </summary>
    /// <param name="elementType">type of the elements</param>
    /// <returns></returns>
    public static MethodInfo GetCountMethodByType(Type elementType)
    {
        // to get the method name, we use lambdas too
        Expression<Action> methodNamer = () => GetCountMethod<object>();
        var gmi = ((MethodCallExpression)methodNamer.Body).Method.GetGenericMethodDefinition();
        var mi = gmi.MakeGenericMethod(new Type[] { elementType });
        return mi.Invoke(null, new object[] { }) as MethodInfo;
    }
    #endregion Disctinct 
```

# .net - COM 互操作的通用集合的替代方案是什么？

> ID：269581
> 
> 赞同：11
> 
> 时间：2008-11-06T17:43:38.017
> 
> 标签：.net, generics, collections, asp-classic, com-interop

我试图从 .NET 程序集中返回一组部门，以供 ASP 通过 COM 互操作使用。使用 .NET 我只会返回一个泛型集合，例如`List<Department>`，但泛型似乎不适用于 COM 互操作。那么，我有哪些选择？

我想遍历列表并能够按索引访问项目。我应该继承、`List<Department>`实现一个或另一个接口，还是有更好的方法？理想情况下，我宁愿不必为我需要的每种类型的列表实现自定义集合。此外，甚至可以与 COM Interop 一起使用吗？`IList``IList<Department>``List[index]`

谢谢，迈克

## .NET 组件示例 (C#)：

```
public class Department {
    public string Code { get; private set; }
    public string Name { get; private set; }
    // ...
}

public class MyLibrary {
    public List<Department> GetDepartments() {
        // return a list of Departments from the database
    }
} 
```

## 示例 ASP 代码：

```
<%
Function PrintDepartments(departments)
    Dim department
    For Each department In departments
        Response.Write(department.Code & ": " & department.Name & "<br />")
    Next
End Function

Dim myLibrary, departments
Set myLibrary = Server.CreateObject("MyAssembly.MyLibrary")
Set departments = myLibrary.GetDepartments()
%>
<h1>Departments</h1>
<% Call PrintDepartments(departments) %>
<h1>The third department</h1>
<%= departments(2).Name %> 
```

## 相关问题：

*   [在服务组件上使用通用列表](https://stackoverflow.com/questions/161704/using-generic-lists-on-serviced-component)
*   [.NET 中的非泛型集合是否已过时？](https://stackoverflow.com/questions/56375/are-non-generic-collections-in-net-obsolete)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-06T19:53:20.453

经过更多的研究和反复试验，我想我找到了使用`System.Collections.ArrayList`. 但是，这不适用于按索引获取值。为此，我创建了一个新类`ComArrayList`，它继承`ArrayList`并添加了新方法`GetByIndex`和`SetByIndex`.

## COM 互操作兼容集合：

```
public class ComArrayList : System.Collections.ArrayList {
    public virtual object GetByIndex(int index) {
        return base[index];
    }

    public virtual void SetByIndex(int index, object value) {
        base[index] = value;
    }
} 
```

## 更新了 .NET 组件 MyLibrary.GetDepartments：

```
public ComArrayList GetDepartments() {
    // return a list of Departments from the database
} 
```

## 更新的 ASP：

```
<h1>The third department</h1>
<%= departments.GetByIndex(2).Name %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-12-07T15:07:33.007

由于您只使用 ASP 中的数据，我建议您返回`Department[]`. 这应该直接映射到 COM 中的 SAFEARRAY。它也支持枚举和索引访问。

```
public Department[] GetDepartments() {
    var departments = new List<Department>();
    // populate list from database
    return departments.ToArray();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-08T01:25:32.523

在您的 ASP 代码中，您不能这样做吗？

```
<h1>The third department</h1>
<%= departments.Item(2).Name %> 
```

我知道在 VB .NET 中，C# 索引器是通过“Item”属性支持的，所以同样的想法可能在 ASP 中起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-02-20T14:35:44.203

我一直在尝试在 vb.net 中解决同样的问题（不精通 C#）。

由于 List(Of T) 支持 IList 接口，对于我的对象的 COM 接口，我尝试指定

```
Public Class MyClass
...
   Private _MyList As List(of MyObject)
   Public ReadOnly Property MyList As IList Implements IMyClass.MyList
    Get
        Return _MyList
    End Get
   End Property 
```

然后在 COM 看到的公共接口中指定

```
ReadOnly Property MyList As IList 
```

从实例化对象、调用生成器函数然后像数组一样读取 MyList 属性的经典 ASP 客户端似乎可以正常工作。

# html - 设置制服所有浏览器的宽度

> ID：269582
> 
> 赞同：37
> 
> 时间：2008-11-06T17:43:38.437
> 
> 标签：html, css, cross-browser

需要什么 CSS 或属性组合？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-11-06T17:48:28.990

*   隐藏实际控制
*   使用您想要的控件和样式制作了一个 DIV

该按钮不是标准的 HTML 控件。

见：[http ://www.quirksmode.org/dom/inputfile.html](http://www.quirksmode.org/dom/inputfile.html)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-06T20:43:29.947

怎么了

```
<input type="file" size="50" .... /> 
```

? 我猜除了 mac 上的 safari 之外看起来都一样（在 mac 上，所有上传控件在所有浏览器上看起来都不同）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-11-06T22:58:29.877

除了 quirksmode 教程，这里还有一个很好的资源： [http ://www.shauninman.com/archive/2007/09/10/styling_file_inputs_with_css_and_the_dom](http://www.shauninman.com/archive/2007/09/10/styling_file_inputs_with_css_and_the_dom)

如果要隐藏实际控件，请记住将控件的不透明度设置为零非常重要，而不是实际使用`visibility: hidden`. 这样做实际上会隐藏元素，禁用点击操作。

此外，如果您使用图形按钮覆盖控件，请注意，在某些浏览器（我相信是 Firefox 和 IE）中，当光标位于文本上方时，您将无法将光标类型更改为手形——文件控件的输入部分（它将始终默认为输入或常规非链接指针）。是的，我尝试过使用`cursor: pointer`（和`cursor: hand`）。

就个人而言，我一直在为自定义上传框而苦苦挣扎，并且没有灵丹妙药可以让它们的外观或自定义完美。（特别是关于光标的行为，因为我认为这是一个 UI 交易破坏者）。归根结底，我认为更容易接受不同的浏览器会以不同的方式呈现控件，事实就是如此。

# javascript - JavaScript：Ci 未定义

> ID：269590
> 
> 赞同：3
> 
> 时间：2008-11-06T17:45:35.343
> 
> 标签：javascript, firefox, continuous-integration

我刚刚花了一半的时间来找出在我的 JavaScript 代码中导致错误消息“Ci 未定义”的原因。我终于找到了原因：

它应该是（jQuery）：

```
$("asd").bla(); 
```

它是：

```
("asd").bla(); 
```

（美元符号不见了）

现在，在解决了问题之后，我想了解消息本身：当 Firefox 告诉我“Ci”未定义时，它是什么意思。什么是“词”？

* * *

更新：我正在使用当前版本的 Firefox (3.0.3)。

要重现，只需使用以下 HTML 代码：

```
<html><head><title>test</title>
<script>
("asd").bla();
</script>
</head><body></body></html> 
```

说清楚：我知道是什么导致了错误消息。我只是想知道 Firefox 试图用“Ci”告诉我什么......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T17:56:19.830

我不知道您使用的是哪个版本的 FF，但无论如何，该消息可能指的`bla()`是 String 对象上没有可用的函数这一事实。由于您缺少`$`，这意味着您缺少一个函数，`("asd")`因此将评估为一个字符串，然后 JavaScript 解释器将尝试调用`bla()`该对象。因此，如果您的项目中有以下代码：

```
String.prototype.bla = function() {};

// now this next line will execute without any problems:
("asd").bla(); 
```

因此，有可能`Ci`是一些内部 Firefox 符号，它只是指一个函数的概念。这是我的猜测，我想您将需要了解 Firefox 内部结构的人才能更好地回答这个问题......

* * *

更新：我在与您*完全相同*的 FF 版本中运行您的示例代码，但它报告错误为：

> 错误：“asd”.bla 不是函数
> 源文件：file:///C:/test.html
> 行：3

也许您正在运行一个扩展/插件来处理这个问题？也许是一些 Greasemonkey 脚本之类的？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T18:47:01.913

杰森似乎是对的。许多插件（例如 Firebug、Geode）使用 Ci 作为快捷方式：

```
const Ci = Components.interfaces; 
```

所以插件似乎会导致那个奇怪的错误消息。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2008-11-06T17:56:16.663

假设是CodeIngiter，找不到js文件。

# .net - LinqToSql 在不同的机器上为相同的代码生成不同的 Sql 查询

> ID：269594
> 
> 赞同：4
> 
> 时间：2008-11-06T17:47:19.413
> 
> 标签：.net, asp.net, sql, linq-to-sql

我有一个使用 Asp.net 和 LinqToSql 构建的用于数据访问的网站。在站点的某个部分，LinqToSql 生成一个如下所示的查询（来自我的开发机器）：

```
select ...
from table1
left outer join table2 on table1 where ...
left outer join table3 on table2 where ... 
```

由于 table2 和 table1 之间的连接并不总是存在，因此左外连接在这种情况下是合适的。而且由于table3和table1之间的链接是经过table2的，所以还需要一个左外连接。此 sql 返回正确的记录集。

我只是把代码放到服务器上。在相同的场景中运行相同的代码，LinqToSql 会生成以下查询：

```
select ...
from table1
left outer join table2 on table1 where ...
join table3 on table2 where ... 
```

出于某种原因，它将 table2 和 table3 之间的连接呈现为内连接，而不是外连接。这将导致从查询返回零记录。

开发机器和服务器都使用 .Net 3.5 SP1。开发机器是 Vista64，服务器是 Windows Server 2003 SP2。我的一位使用 Windows XP PRO 的同事也在他们的开发机器上确认了相同的正确行为。

谁能想到服务器会创建不同的 sql 的原因？我怎样才能解决这个问题？这似乎与 Linq 和 .Net 在服务器上运行的方式有关。但是，我想不出任何方法来确认和解决这个问题。

* * *

Linq 代码（我只包括与 sql 更改的部分相关的部分）：

```
from Import_Table t in db.Import_Tables
select new {
   CheckedOutUser = (!t.IsCheckedOut) ? "--" : t.Import_CheckoutHistory.System_User.FirstName + " " + t.Import_CheckoutHistory.System_User.LastName,
   CheckedOutUserID = (!t.IsCheckedOut) ? 0 : t.Import_CheckoutHistory.System_UserID}; 
```

在上述描述的上下文中，table1 = Import_Table，table2 = Import_CheckoutHistory，table3 = System_User。如果我在这里注释掉以“CheckedOutUser = ...”开头的行，那么它可以在服务器上运行——所以这绝对是罪魁祸首。

返回的实际sql：

```
SELECT 
  (CASE WHEN NOT ([t0].[IsCheckedOut] = 1) THEN CONVERT(NVarChar(401),'--') ELSE ([t2].[FirstName] + ' ') + [t2].[LastName] END) AS [CheckedOutUser], 
  (CASE WHEN NOT ([t0].[IsCheckedOut] = 1) THEN 0 ELSE [t1].[system_UserID] END) AS [CheckedOutUserID]
FROM [dbo].[import_Table] AS [t0] 
LEFT OUTER JOIN [dbo].[import_CheckoutHistory] AS [t1] ON [t1].[import_CheckoutHistoryID] = [t0].[import_CheckoutHistoryID] 
LEFT OUTER/INNER JOIN [dbo].[system_User] AS [t2] ON [t2].[system_UserID] = [t1].[system_UserID] 
```

在开发机器上，最后一行以“Left outer”开头。在服务器上，最后一行以“Inner”开头

**更新：**我的解决方案[如下](https://stackoverflow.com/questions/269594/linqtosql-producing-different-sql-queries-on-different-machines-for-identical-c#275751)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T19:51:13.297

您的生产数据库是否与您的开发数据库不同，例如 SQL Server 2008 而不是 2005？我相信 LINQ to SQL 会根据它正在与之交谈的实际执行时数据库来改变它生成的 SQL。

另外，两个数据库上的模式是否完全相同？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T19:18:58.493

听起来两者之间的 LINQ to SQL 类（DBML 和/或相关代码生成）并不相同 - 特别是这两个表之间的关联是如何定义的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-09T08:35:15.267

我检查了以下内容：

1.  两者都使用相同的数据库
2.  两者都有相同的代码
3.  两者都有相同的 dbml 文件

我知道某处必须有某些东西不同步，但我找不到。

所以我实现了以下解决方法：我向我的数据库添加了一个视图，其中包含两个左外连接。这个视图现在在我的 dbml 文件中，在上面的查询中，我引用了视图而不是表。这工作正常。

# java - 在java中将文件重命名为另一个

> ID：269601
> 
> 赞同：2
> 
> 时间：2008-11-06T17:48:23.967
> 
> 标签：java, file

我有一个需要重命名为现有文件的文件。这是对现有 JAR 文件的复制、修改、替换原始操作。我已经完成了前两个步骤，我只需要更换原始位的帮助。将 JAR 的新版本重命名为旧版本的最佳方法是什么？旧的 JAR 不需要保留，我不想保留新 JAR 的副本并保留其初始名称。

我已经有 commons lang 和 io，所以如果有我错过的方法，那就太好了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T18:00:13.660

`Java.io.File.renameTo(java.io.File)`

您可能需要先调用`File.delete()`原始文件 - 有些系统不会将文件重命名为现有文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T17:59:48.950

您将需要创建两个`java.io.File`对象：一个用于新文件，一个用于旧文件。

让我们称之为`oldFile`和`newFile`。

```
oldFile.delete()
newFile.renameTo(oldFile); 
```

编辑：mmyers 打败了我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T18:04:36.273

这应该让你相当接近：

```
public boolean replaceOldJar(String originalJarPath, java.io.File newJar) {
    java.io.File originalJar = new java.io.File(originalJarPath);
    if (!originalJar.isFile()) {
        return false;
    }
    boolean deleteOldJarSucceeded = originalJar.delete();
    if (!deleteOldJarSucceeded) {
        return false;
    }
    newJar.renameTo(originalJar);
    return originalJar.exists();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T17:58:34.553

[删除](http://java.sun.com/javase/6/docs/api/java/io/File.html#delete())旧的[重命名](http://java.sun.com/javase/6/docs/api/java/io/File.html#renameTo(java.io.File))新的有问题吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T18:05:16.333

我不完全确定您是否只是在询问如何重命名文件系统中的文件，或者您是否还想重新加载这个新版本的 jar？

重命名部分听起来很简单...只需使用 File.renameTo... 不幸的是，有很多与此相关的平台特定问题。一些平台不允许您覆盖现有文件，其他平台不允许您重命名文件，以便将位置更改到另一个分区。如果你想让这个过程完全安全，你需要自己做这个过程，首先删除旧文件，然后重命名新文件（如果可以更改分区，则复制）。如果您的应用程序/机器在执行此操作时崩溃，这自然容易出现问题，因为它不再是原子操作。因此，您需要在应用程序启动过程中添加一个检查，以查找崩溃发生时处于中间的重命名操作。如果您只是以这种方式更新单个文件，那应该很容易。

However, if you actually want to reload the jar, there are a few more issues to thing about, but you would need to give a bit more detailed view of the situation to get proper advice on how to do it.

# c# - 在 C# .NET 中创建 Windows 服务的最佳指南？

> ID：269603
> 
> 赞同：19
> 
> 时间：2008-11-06T17:49:13.777
> 
> 标签：c#, .net, windows-services

我希望将小型 .NET 控制台应用程序转换为 Windows 服务。我想构建两个版本，一个使用 .NET 2.0 ，另一个使用 .NET 3.5 。

是否需要采取完全不同的方法，或者 2.0 版本是否大致等同于 3.5 版本？哪里有很好的信息来源（即基于网络的指南）可以引导我完成设置服务的步骤？

谢谢！功放

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T20:03:48.297

实际上，.NET 3.5*确实**稍微*改变了 C# 代码。例如，您可以使用 var 关键字，并且可以将隐藏的私有变量用于属性。它仍然基于 CLR 2.0。

[msdn](http://msdn.microsoft.com/en-us/library/d56de412(VS.80).aspx)上有一篇非常好的文章，它讨论了 Windows 服务并指导您构建一个。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T23:04:33.140

为了补充 Rick 的答案，我建议[MSDN 演练](http://msdn.microsoft.com/en-us/library/zt39148a(VS.80).aspx "MSDN 演练")

它非常冗长，涉及事件记录和安装程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T22:50:15.947

[我相信这](http://www.codeproject.com/KB/dotnet/simplewindowsservice.aspx)是一个不错的截图和代码示例。我想这可能是我写的第一个 Windows 服务所使用的。我认为它是在 .NET 1.1 中写回的，但仍应能帮助您完成整个过程。至于 2.0 和 3.5 之间的差异，我想说可以/将会有你想要的差异。我不相信您将需要更改任何内容，但正如其他海报所提到的并且您可以在 SO 中找到所有内容，.NET 3.5 附带了许多非常有益的新功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T17:55:29.427

要记住的是 .NET 3.5 是 .NET 2.0 之上的一组附加库，因此，除非您计划利用 .NET 3.5（或 .NET 3.0）提供的任何附加功能，如 LINQ 或 WCF代码将是相同的。

尝试查看[ServiceBase](http://msdn.microsoft.com/en-us/library/system.serviceprocess.servicebase.aspx)的文档，这是您需要继承的基类，以开始工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-16T20:50:28.057

至少有一个地方需要注意服务代码才能使其在 .net2/vs2005 与 .net35/vs2008 中工作。

如果您使用 c# 2.0 编写服务和安装程序并使用 .net35/vs2008 编译和部署，则尤其如此，下面的链接可能会为您节省一些时间：

[自定义操作已更改](http://vladsnotes.hrybok.com/PermaLink,guid,f5da1c61-cccf-458e-9b23-06960bfef242.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-25T10:29:23.450

这里是学习[指南](http://tech.pro/tutorial/895/creating-a-simple-windows-service-in-csharp)`windows service`。

# sql - 多个不相异

> ID：269605
> 
> 赞同：14
> 
> 时间：2008-11-06T17:49:41.437
> 
> 标签：sql, ms-access, distinct

我有一个 MS 访问数据库，我需要创建一个 SQL 查询，允许我选择一列中所有不不同的条目，同时仍保留所有值。

在这种情况下，一个例子比以往任何时候都更值得数千字：

桌子：

```
A B C
1 x q
2 y w
3 y e
4 z r
5 z t
6 z y 
```

*SQL魔术*

结果：

```
B C
y w
y e
z r
z t
z y 
```

基本上，它删除了 B 列的所有唯一值，但保留了多行数据。我可以“按 b 分组”，然后“计数> 1”以获得不明显的结果，但结果只会列出 B 的一行，而不是我需要的 2 或更多。

有什么帮助吗？

谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-06T18:13:25.070

```
Select B, C
From Table
Where B In
    (Select B From Table
     Group By B
     Having Count(*) > 1) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T18:05:26.990

返回您想要的结果的另一种方法是：

```
select *
from
    my_table
where 
    B in 
    (select B from my_table group by B having count(*) > 1) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T17:53:28.963

```
select 
  * 
from 
  my_table t1, 
  my_table t2
where 
  t1.B = t2.B
and
  t1.C != t2.C

-- apparently you need to use <> instead of != in Access
-- Thanks, Dave! 
```

类似的东西？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T17:54:13.237

将您使用 group by b 和 count > 1 确定的 B 的唯一值连接回原始表，以从表中检索 C 值。

# asp.net - “DataSource 和 DataSourceID 均已定义”错误使用 ASP.NET GridView

> ID：269611
> 
> 赞同：9
> 
> 时间：2008-11-06T17:51:10.870
> 
> 标签：asp.net, gridview

“DataSource 和 DataSourceID 都在 'grdCommunication' 上定义。删除一个定义。”

我今天刚收到这个错误，代码一直有效，直到今天下午我将最新版本发布到我们的服务器，它在本地和服务器上都出现了该错误。我不使用“DataSourceID”，应用程序将数据库查询读入数据表并将数据表设置为 GridViews 上的数据源。我在 Visual Studio 中进行了搜索，搜索了整个解决方案，而字符串“DataSourceID”甚至没有出现在整个解决方案的 1 行代码中。这是让我感到害怕的第一件事。

我认为它昨天一直在工作，所以我将代码恢复到昨天的构建。错误仍然存​​在。我一直在回溯构建，但问题仍然存在。我回去一个月了，我仍然遇到同样的错误。这个应用程序今天早上运行良好？确实没有代码更改，应用程序中的任何地方都没有在任何网格视图上设置 DataSourceID。有没有人见过这样的东西？

如果 DataSourceID 从未设置，我怎么能得到那个错误......并且“DataSourceID”这个词不在我的解决方案中？我只是在整个树上做了一个wingrep，对datasourceid 进行了不区分大小写的搜索......完全没有得到任何结果。这个词在整个应用程序中绝对没有。

```
 <asp:GridView ID="grdCommunication" runat="server" 
    Height="130px" Width="100%"
     AllowPaging="true" >
    ... standard grid view column setup here... 
    </asp:GridView>

// Code behind.. to set the datasource
  DataSet dsActivity = objCompany.GetActivityDetails();

  grdCommunication.DataSource = dsActivity;
  grdCommunication.DataBind(); 
```

// 更新：删除了一些令人困惑的注释。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-06T18:12:11.717

试试这个：

```
DataSet dsActivity = objCompany.GetActivityDetails();
grdCommunication.DataSource = dsActivity.Tables[0];
grdCommunication.DataBind(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T18:24:01.257

圣烟蝙蝠侠。表名已更改，导致我的数据源不好。但是在这种情况下，该错误消息没有任何意义。因此，从技术上讲，如果我按索引而不是按名称调用表，则 tsilb 的解决方案将起作用，因此我会将他的解决方案标记为正确。

阅读他的帖子后，我尝试了 dsActivity.Tables["Activities"] 而不是将数据集传递给 Datasource 并将表名传递给 Datamember，显然这不起作用，但如果我传递实际的索引，我不会'不喜欢这样做，因为该索引可能会改变，然后它现在正在工作。但搞砸的部分是那个错误。那个错误完全不符合问题所在。说我定义了两者并删除了一个，而实际上并非如此。另一个真正搞砸的事情是，表名只是改为全部大写......但是，“活动”是与“活动”不同的键。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-17T07:34:48.147

在此 grdCommunication.DataSource = dsActivity; 之前替换此代码

```
grdCommunication.DataBind();
grdCommunication.DataSourceID=""; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T18:16:00.650

tslib 是对的，不要这样做：grdCommunication.DataSourceID = null; 或 string.Empty 版本。如果您使用 SqlDataSource 或 ObjectDataSource 控件进行绑定，则仅使用 DataSourceID。

它被称为“声明式”绑定，因为您使用的是页面上的“声明式”控件。绑定到控件不需要调用 DataBind() 方法。

因为您是手动进行 DataBinding（调用 grd.DataBind()），所以您只需设置 DataSourrce，然后调用 DataBind()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-26T18:22:11.410

我遇到了同样的错误，但问题和解决方案完全不同。在我的例子中，我使用 LINQ to SQL 来填充一些下拉列表，然后缓存结果以供进一步的页面查看。使用清晰的缓存，一切都可以正常加载，然后在随后的页面查看中会出错。

```
if (Cache["countries"] != null)
{
    lbCountries.Items.Clear();
    lbCountries.DataValueField = "Code";
    lbCountries.DataTextField = "Name";
    lbCountries.DataSource = (Cache["countries"]);
    lbCountries.DataBind();}
else
{
    var lstCountries = from Countries in db_read.Countries orderby Countries.Name select Countries;
    lbCountries.Items.Clear();
    lbCountries.DataValueField = "Code";
    lbCountries.DataTextField = "Name";
    lbCountries.DataSource = lstCountries.ToList();
    lbCountries.DataBind();

    Cache.Add("countries", lstCountries, null, System.Web.Caching.Cache.NoAbsoluteExpiration, new TimeSpan(0, 240, 0), System.Web.Caching.CacheItemPriority.High, null);
} 
```

问题来自： Cache.Add("countries", **lstCountries** , null, System.Web.Caching.Cache.NoAbsoluteExpiration, new TimeSpan(0, 240, 0), System.Web.Caching.CacheItemPriority.High, null);

什么时候应该是：Cache.Add("countries", **lstCountries.ToList(),** null, System.Web.Caching.Cache.NoAbsoluteExpiration, new TimeSpan(0, 240, 0), System.Web.Caching.CacheItemPriority。高，空）；

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-16T23:59:43.823

我今天遇到了这个错误，原来它与 DataSourceID 无关，而与 DatasSource 本身有关。

我的 DatasSource 有问题，我没有收到与 DatasSource 相关的错误，而是收到了这个无意义的错误。

确保你的 DatasSource 是好的，这个错误应该会消失。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-02-04T17:30:29.927

始终将具有表索引的数据集绑定到 gridview...

前任。gridgrdCommunication.Table[0]; 正如上面提到的 Tsilb

你故意写的第二种方式..

gridgrdCommunication.DataSourceID = String.Empty；gridgrdCommunication.DataSource=ds; gridgrdCommunication.DataBind();

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-04-14T14:56:00.730

检查你的数据库结构......如果你正在访问你的数据抛出一个 dbml 文件，你的数据库中的表结构与 dbml 文件结构不同

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-08-19T14:19:57.373

如果您正在使用对象数据源并希望在后面的代码中有条件地重新加载网格，您可以成功地做到这一点：

```
Dim datatable As DataTable = dataset.Tables(0)
Dim dataSourceID As String = gvImageFiles.DataSourceID
gvImageFiles.DataSourceID = Nothing
gvImageFiles.DataSource = datatable.DefaultView
gvImageFiles.DataBind()
gvImageFiles.DataSource = Nothing
gvImageFiles.DataSourceID = dataSourceID 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-07-26T08:49:04.000

您需要选择一种方法来绑定网格 **，如果它来自后面的代码意味着使用 c# 代码，然后从网格的设计视图中从网格视图中删除 datasourceid 属性，如下所示**

//你必须让它像这样

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-08-29T17:19:26.197

请试试这个：

> gvCustomerInvoiceList.DataSourceID = ""; gvCustomerInvoiceList.DataSource = ci_data; gvCustomerInvoiceList.DataBind();

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-09-07T10:40:31.440

我今天收到了这个错误。事实证明，我的存储过程既没有返回任何记录，也没有返回结构。这是因为我有一个`try catch`没有`raiserror`.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-01-23T07:33:40.980

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Page.DataBind()
End Sub
Function GetData()
    Dim dt As New DataTable
    Try

        dt.Columns.Add("ROOM_ID", GetType(String))
        dt.Columns.Add("SCHED_ID", GetType(String))
        dt.Columns.Add("TIME_START", GetType(Date))
        dt.Columns.Add("TIME_END", GetType(Date))

        Dim dr As DataRow = dt.NewRow

        dr("ROOM_ID") = "Indocin"
        dr("SCHED_ID") = "David"
        dr("TIME_START") = "2018-01-03 09:00:00.000"
        dr("TIME_END") = "2018-01-03 12:00:00.000"
        dt.Rows.Add(dr)

    Catch ex As Exception
        MsgBox(ex.ToString)
    End Try
    Return dt
End Function 
```

并将其添加到您的项目 DataSource="<%# GetData() %>"

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-08-21T02:59:20.937

在我的情况下，到数据库的连接字符串不起作用。修复连接字符串消除了这个错误。

# c - GCC 中有固定大小的整数吗？

> ID：269614
> 
> 赞同：12
> 
> 时间：2008-11-06T17:52:02.710
> 
> 标签：c, gcc, portability, low-level

在 MSVC++ 编译器上，可以对具有特定大小的整数使用`__int8`、`__int16`和`__int32`类似类型。这对于需要使用低级数据结构（如自定义文件格式、硬件控制数据结构等）的应用程序非常有用。

我可以在 GCC 编译器上使用类似的等效项吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-11-06T17:56:31.797

ISO 标准 C，从 C99 标准开始，添加了`<stdint.h>`定义这些的标准头：

```
uint8_t  - unsigned 8 bit
int8_t   - signed 8 bit
uint16_t - unsigned 16 bit
int16_t  - signed 16 bit
uint32_t - unsigned 32 bit
int32_t  - signed 32 bit
uint64_t - unsigned 64 bit
int64_t  - signed 64 bit 
```

我一直使用这些类型。

仅当实现支持具有适当大小和特征的预定义类型（大多数都支持）时，才定义这些类型。

`<stdint.h>`还定义了具有形式名称的`(u)int_leastN_t`类型（*至少*具有指定宽度的类型）和`(u)int_fastN_t`（至少具有指定宽度的“最快”类型）；这些类型是强制性的。

如果您使用的是不支持的旧实现`<stdint.h>`，您可以自己滚动；一种实现是[Doug Gwyn 的 "q8"](http://www.lysator.liu.se/(nobg)/c/q8/index.html)。

# windows-xp - 如何强制 Windows 索引“活动”

> ID：269621
> 
> 赞同：5
> 
> 时间：2008-11-06T17:53:56.123
> 
> 标签：windows-xp, indexing-service

Windows 索引服务在检测到“用户处于活动状态”时会自行暂停。无论用户活动如何，是否有注册表项或其他内容可以使其继续索引？

**说明：**在 Windows XP 中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T22:14:39.573

Microsoft Indexing 服务索引优化由 HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\ContentIndex 中的一组注册表项控制

按照以下步骤轻松调整索引服务的性能以立即索引文档：

1.  打开计算机管理控制面板。
2.  展开“服务和应用程序”项。
3.  停止索引服务（右键单击 -> 停止）。
4.  右键单击索引服务 -> 所有任务 -> 调整性能。
5.  选择自定义单选按钮，然后单击“自定义”按钮。
6.  选择“即时”索引性能。
7.  好的好的。
8.  启动索引服务（右键单击 -> 启动）。

请注意，现在索引服务将在文件系统通知它任何更改时立即索引文档。警告：此设置适用于所有目录。由于后台索引的文档数量，该设置可能会导致系统速度变慢。

可以通过在 Tune Performance 对话框中选择其他项目来进一步调整索引设置。这些调整中的每一个都对应于写入 ContentIndex 注册表项的一组值。可以调整这些值以获得最佳性能平衡。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T17:56:21.500

右键单击系统托盘（放大镜）中的索引服务图标，然后单击“立即索引”。我知道这听起来像是一个只会发生一次的动作，但这实际上是一个切换，当打开时，它会完全按照您的要求执行。

# css - 无论视口缩小多小，如何强制网页以最小分辨率呈现？

> ID：269623
> 
> 赞同：1
> 
> 时间：2008-11-06T17:54:29.227
> 
> 标签：css, reflow

我对复杂的 CSS 相当陌生，并且有一个问题——我有一个页面，它在页面底部放置了一个浮动元素。它通过设置底部：0 和位置：绝对来实现。

当用户将浏览器调整为非常小的尺寸时，此元素会覆盖页面上的其他内容。

理想情况下，该元素将继续以正常和大尺寸浮动在浏览器底部，但如果浏览器窗口缩小得太小，浏览器将强制滚动条，而不是进一步移动浮动元素。

本质上，我想告诉浏览器——无论窗口多小，永远不要渲染小于 800x600 的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T18:06:49.530

你可以设置`html, body { min-width: 800px; min-height: 600px; }`

YMMV 在不同的浏览器中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T19:01:48.687

这实际上取决于浮动页脚是否需要始终可见，或者当浏览器窗口很小时它是否可以滚动到底部。

我认为一些 javascript 可能比 css 解决方案更容易管理。请记住，min-width 和 min-height 并非在所有浏览器中都有效。

您可以使用 jquery 使这更容易。$(window).resize( callback ) 可用于设置回调函数来处理窗口大小调整。

我也将窗口尺寸用作调整大小代码的一部分。var wh = Math.max(600,$(window).height()); var ww = Math.max(800,$(window).width());

然后我可以根据窗口大小在我的页面中设置 div 的大小。$('div#mydiv').css('width',ww); 您还可以将值设置为 auto 以取消设置您的指定值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:11:41.613

我知道这有点作弊，但您可以使用旧技巧，在浮动元素中放入具有所需最小宽度且颜色相同的图像。然后它实际上是不可见的，但可以防止元素缩小，从而防止整个页面缩小。

# jquery - 使用 jQuery 遍历 DOM

> ID：269632
> 
> 赞同：2
> 
> 时间：2008-11-06T17:55:49.723
> 
> 标签：jquery

单击 IMG 后，我想进入下一个后续 DIV，以便可以根据当前显示状态显示或隐藏 DIV 内容。

这是一个 HTML 片段：

```
<div>
  <span class="expand"><img src="images/plus.gif"></span>
  <span>Subject Heading</span>
</div>
<div class="record hidden">Display or Hide this text</div> 
```

我有一些代码（[在本网站的另一个答案中提供](https://stackoverflow.com/questions/123401/using-jquery-to-find-the-next-table-row#123518)）用于在表格中执行此操作。我会为 img 或包含跨度设置一个事件侦听器吗？不知道如何使用 parent()、next()、sibling() 函数来解决......

另外，你如何测试你的导航是否到达了正确的元素？您可以使用警报来显示 ID 或值吗？

感谢任何帮助谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T18:11:50.517

一种更简洁的方法是在折叠和展开之间切换图像的父类，然后在您的 css 中，您可以使用上下文选择器在折叠的 div 中隐藏嵌套的 div。

只是我的2美分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T18:14:27.110

这是一个工作示例：

```
<script type="text/javascript" src="../jquery-1.2.6.min.js"></script>

<div>
  <span class="expand"><img src="x.jpg"></span>
  <span>Subject Heading</span>
</div>
<div class="record hidden">Display or Hide this text</div>

<script type="text/javascript">
    $(document).ready(function(){
        $('.expand img').toggle(
        function(){
            $(this).parent().parent().next().hide();
        },
        function(){
            $(this).parent().parent().next().show();
        });
    });
</script> 
```

请注意，我使用了两次 parent，因为事件被添加到图像中，其父级是 span，其父级是 div。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T18:06:52.260

一个不错的地方是选择器下的 Visual jQuery Docs：http: [//screencasts.visualjquery.com/](http://screencasts.visualjquery.com/)

我认为您正在尝试做类似的事情

$(this).parent().next('.hidden');

在你的 onClick 函数里面？

希望有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T18:17:08.073

Alllain 是正确的，最好只对父级进行操作，然后使用 CSS 选择器来显示或隐藏子级，翻转 +/- 图像等。但是无论如何，[这里](http://rome.purepistos.net/tmp/sof-269632.html)的功能代码可以按照您的方式执行您想要的操作想知道：

```
<html>

<head>

  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.min.js"></script>
  <script type="text/javascript">
    $( document ).ready( function() {
        $( '.expand img' ).click(
            function() {
                $(this).parents( 'div' ).eq( 0 ).siblings( '.record' ).eq( 0 ).toggleClass( 'hidden' );
            }
        );
    } );
  </script>

  <style type="text/css">
    .hidden {
        display: none;
    }
  </style>

</head>

<body>

  <div>
    <span class="expand"><img src="http://stackoverflow.com/Content/Img/stackoverflow-logo-250.png"></span>
    <span>Subject Heading</span>
  </div>
  <div class="other">Don't care about this</div>
  <div class="record hidden">Display or Hide this text</div>

</body>

</html> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T18:43:10.003

这就是我目前正在使用的，谢谢亚当……但我也会探讨艾伦的建议。

```
$(function(){
$('.expand img').toggle(
    function(){
        $(this).parent().parent().next().show();
        $(this).attr('src', 'images/minus.gif') ;
    },
    function(){
        $(this).parent().parent().next().hide();
        $(this).attr('src', 'images/plus.gif') ;
    });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T18:10:03.733

你有几个选择：

```
$('.expand').click(function () {
  $(".record").toggle();
}); 
```

或者

```
$('.expand').click(function () {
  $(".record").slideToggle("slow");
}); 
```

尽管如果您要根据与单击的 img 的相关性来定位下一个 div，那么您需要使用 .parent('span').parent('div').next('record' 来定位它)

# c++ - MFC：从大型机访问视图

> ID：269633
> 
> 赞同：0
> 
> 时间：2008-11-06T17:55:54.043
> 
> 标签：c++, mfc, docview

我正在尝试从我的大型机访问拆分器内的视图。目前我有这个：

CWnd* pView = m_wndSplitter.GetPane(0, 0);

但是，这让我获得了指向 CWnd 而不是 CMyViewClass 对象的指针。

谁能向我解释我需要做什么才能访问视图对象本身，以便我可以访问 pView->ViewFunction(...); 形式的成员函数；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T18:09:39.150

只需投射它：

```
// using MFC's dynamic cast macro
CMyViewClass* pMyView = 
   DYNAMIC_DOWNCAST(CMyViewClass, m_wndSplitter.GetPane(0,0));
if ( NULL != pMyView )
   // whatever you want to do with it... 
```

或者：

```
// standard C++ 
CMyViewClass* pMyView = 
   dynamic_cast<CMyViewClass*>(m_wndSplitter.GetPane(0,0));
if ( NULL != pMyView )
   // whatever you want to do with it... 
```

如果您*知道*窗格中的视图`0,0`将始终是 type `CMyViewClass`，那么您可以使用`static_cast`... 但我建议您不要使用 - 如果您更改布局，则没有任何风险风险。

# asp.net-mvc - 使用 VB.net 时，帮助程序模块是否必须在 App_Code 中才能使 MVC 识别

> ID：269642
> 
> 赞同：0
> 
> 时间：2008-11-06T17:58:43.803
> 
> 标签：asp.net-mvc, vb.net, app-code

当我的助手位于 APS.NET MVC VB 应用程序的 App_Code 目录中时，我可以键入 <%=HTML.ImageUrl("myImage.gif")%>

如果我将它移动到另一个文件夹，我会得到错误。我假设我可以导入应用程序命名空间以使其工作，但这有必要吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T18:21:24.727

您是否将使用的名称空间放入 web.config 中？

```
<pages>
     <namespaces>
          <add namespace="Your.Name.Space" />
     </namespaces>
</pages> 
```

# c# - GUI 事件记录器和回放

> ID：269652
> 
> 赞同：3
> 
> 时间：2008-11-06T18:00:47.403
> 
> 标签：c#, user-interface, macros, qa

我们正在编写一个相对重量级的 C# GUI，其中包含一些 syncFusion（GUI 框架）组件。我想添加客户端日志记录功能，QA 稍后可以使用它来回放客户端事件，以分析客户端在生产中使用的错误或其他工作流程。

是否存在这样一个用于记录和回放所有客户端击键、鼠标事件等的现成模块？（如果 C++ 模块可以很容易地集成到 Windows C# 客户端中，它也可以工作。）

我还想使用生成的日志**来分析客户端的哪些功能使用最多**，哪些功能很少使用，以确定**哪些错误应该优先考虑，哪些功能应该删除**/增强？所以基本上我希望客户端将日志写入本地磁盘或通过网络写回服务器。

我也有点担心性能，一些命中是可以接受的，但是知道**每个事件的日志记录会降低客户端性能**吗？

**这里的重点是记录生产中的所有客户端事件**，而不是 QA 测试本身。

根据 Aydsman 的评论进行编辑：在阅读了[旧的类似讨论](https://stackoverflow.com/questions/143681/what-is-the-best-method-to-gather-data-about-the-use-of-your-application)以及[Benji 的网站](http://benjismith.net/index.php/2008/06/13/analytics-gui-mockup)后，看起来对这种类型的“仪表板”很感兴趣，但目前不存在开放或封闭的产品或解决方案。我在 Benji 的网站上发布了一个关于状态的问题，但网站看起来相当安静，自 6 月以来没有任何回复。Benji 的想法或多或少正是我所寻找的，但似乎还没有产品存在，这相当令人惊讶，我想缺乏现有产品意味着实现这样的系统一定比我最初想象的要复杂。会继续寻找，希望以后能找到一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-16T00:48:15.810

正如这里的其他海报所暗示的那样，有商业产品可以做这种事情。如果您想编写自己的，您需要创建所谓的系统挂钩 DLL。这可以在 C++ 中相当简单地完成。如果您创建一个，您可能可以使用 pinvoke 轻松集成它。事实上，我会先看看 pinvoke.net，看看那些已经做过类似事情的人。

挂钩 DLL 允许您拦截所有鼠标和键盘事件。您还可以注入鼠标和键盘事件。因此，如果将这两者放在一起：拦截 = 记录，注入 = 回放。

这是一个很好的文章列表，可以帮助您入门：[代码项目挂钩 DLL](http://www.codeproject.com/KB/DLL/index.aspx?#DLLs%20-%20Hooks)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T18:28:10.517

当您可以购买产品来执行自动化 GUI 测试时，为什么还要编写代码？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-14T20:19:54.243

你听说过 log4net 吗？我在一个项目中小规模使用过它——它可能适合您的需求。我还对面向方面和 IoC 的日志记录技术进行了一些研究。取决于特定的技术，会有一些性能影响，但它可以使记录代码的维护变得更容易。Spring Framework 的 Spring.NET 端口为通用的方法级日志记录提供了一些选项。您可以使用这些组合来生成活动的“脚本”文件，以及可以在测试环境中读取和重新执行记录的操作的“重播”模块。

# mysql - Windows下MySQL中的自动完成

> ID：269653
> 
> 赞同：11
> 
> 时间：2008-11-06T18:01:52.427
> 
> 标签：mysql, windows, mysql-management

有人知道是否有办法让自动完成在 Windows 下的 MySQL 命令行客户端中工作？对我来说，它在 Linux 下运行良好，但只是在 Windows 下移动光标。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-06T18:24:56.030

它应该这样工作：

```
C:\> mysql --auto-rehash 
```

或者配置你的 my.cnf：

```
[mysql]
auto-rehash 
```

**编辑：** 我很抱歉。我发现一些参考资料表明 mysql 客户端中的制表符完成功能仅适用于 UNIX/Linux。它不适用于 Windows。

**更新：在 MySQL**[错误 #4731](http://bugs.mysql.com/bug.php?id=4731) 中简要提到了这个原因：

> [2004 年 7 月 31 日 12:47] 谢尔盖 Golubchik
> 
> 我刚刚下载了 4.0.15 - mysql.exe 中的命令完成没有按预期工作。它从未在 mysql.exe 中工作，因为我们无法使 readline 用 VC++ 编译。
> 
> mysqlc.exe 是一个 cygwin 构建，它与 readline 链接。

说明： [GNU readline](http://en.wikipedia.org/wiki/GNU_readline)是一个用于处理用户输入的标准开源库。MySQL 团队使用 readline 库，但他们不是它的作者。从上面的评论中，我了解到他们在 Windows 上使用 Microsoft Visual C++（他们用来构建 MySQL 产品的工具）编译 readline 库是不成功的。一些开源项目尚未完全兼容 Microsoft Windows 环境。

过去，MySQL 产品提供了一个他们称为 的替代客户端，他们使用 Windows 上的[cygwin](http://www.cygwin.com/)`mysqlc.exe`工具集编译该客户端，但他们不再提供此功能。cygwin 工具集包含 readline 库，因此可以编译支持制表符补全的客户端。`mysqlc.exe`

所以理论上，如果你真的很勇敢，你可以下载包含 readline 库的 cygwin 工具集，然后下载 MySQL 源代码并使用 cygwin 构建它。然后你应该有一个可以执行tab-completion的mysql客户端程序。但即使对于熟悉从源代码构建 MySQL 的人来说，这听起来也需要做很多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T23:01:15.253

这可能不是您想要的，但企业版 SQLYog 提供了一些有限的模式自动完成功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-15T11:44:08.303

如果上述方法不起作用并且您使用 widnows 10，则可以安装 linux shell，然后安装 mysql-client 并在自动编译工作的 linux 终端中进行连接。

说明： [https ://docs.microsoft.com/en-us/windows/wsl/install-win10](https://docs.microsoft.com/en-us/windows/wsl/install-win10)

# java - 如何使用 Java 在 PC 扬声器上发出噪音

> ID：269657
> 
> 赞同：20
> 
> 时间：2008-11-06T18:02:59.037
> 
> 标签：java, audio

我想在 Swing 应用程序中使用老式 PC 扬声器哔声（不是声卡）提醒用户某些事件，因为并非每台 PC 上都有一个带有连接扬声器的声卡，或者音量可能会变为零，或者耳机可能已连接...我该怎么做？

更新： java.awt.Toolkit.getDefaultToolkit().beep() 似乎通常会在声卡上产生声音。如果没有活动的声卡，它只会使用扬声器。仅当应用程序在终端中启动时打印 ASCII 值 7 才有效，至少 Swing 应用程序通常不是这样。所以这个问题仍然悬而未决。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-06T18:04:05.057

`Toolkit.getDefaultToolkit().beep();`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-06T18:09:57.993

尝试这个：

```
java.awt.Toolkit.getDefaultToolkit().beep(); 
```

它对我有用，虽然我不确定这是 PC 扬声器的哔声还是一些操作系统生成的哔声。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-28T17:11:01.743

我在某处读到您需要使用 C/C++ dll 并将其与 JNI 连接以使其正常工作，.. 链接已脱机

好的，我找到了你要找的东西

[http://pyx4j.com/pyx4j-native/index.html](http://pyx4j.com/pyx4j-native/index.html)

> 他**的 pyx4j-native**项目是一个 java 包装器的集合，用于 windows 函数，如 time 和**beep**。现在只适用于windows。
> 
> NativeThreadDump - 向当前进程发送 CtrlBreak 事件
> 
> **Beep - 使用 PC 扬声器发出声音**
> 
> FileUtil - 访问和修改文件创建时间。在 com.pyx4j.log.RollingFileAppender 中使用
> 
> NativeTimer - Java 5 之前使用的系统高分辨率性能计数器

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-10-08T18:34:43.840

除了哔声之外，您还可以尝试 [JFugue](http://www.jfugue.org/)。

JFugue 是一个开源的 Java API，用于编程音乐，没有 MIDI 的复杂性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T18:04:35.180

ASCII 值 7 是哔哔声。所以只需打印该字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-02-08T00:34:30.473

```
 {
     If (whatever you named the file) = true
     Then
     Process.Start ("C:\Windows\Media\{whatever you named the file})
     } 
```

我在 C# 中使用它。在人们抨击这篇文章之前，对我来说已经很晚了，代码并不完全准确。放置一个写入目录来命名文件夹并将其声明为默认位置。将您选择的声音移动到此文件夹，它将播放音频。在 Java 中设置计时器以每 2 秒循环一次声音以引起人们的注意。希望这有助于我学习自我！

# c - 使用 Malloc 钩子

> ID：269659
> 
> 赞同：6
> 
> 时间：2008-11-06T18:03:02.313
> 
> 标签：c, malloc

我正在尝试使用 malloc 挂钩来创建自定义函数 my_malloc()。在我的主程序中，当我调用 malloc() 我希望它调用 my_malloc() 有人可以给我一个关于如何在 C 中执行此操作的示例

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T18:06:07.003

你看过这里吗？ [http://www.gnu.org/software/libtool/manual/libc/Hooks-for-Malloc.html](http://www.gnu.org/software/libtool/manual/libc/Hooks-for-Malloc.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T18:11:04.090

根据[http://www.gnu.org/software/libtool/manual/libc/Hooks-for-Malloc.html](http://www.gnu.org/software/libtool/manual/libc/Hooks-for-Malloc.html)，这是使用 GCC 库的方法。

```
/* Prototypes for __malloc_hook, __free_hook */
 #include <malloc.h>

 /* Prototypes for our hooks.  */
 static void my_init_hook (void);
 static void *my_malloc_hook (size_t, const void *);
 static void my_free_hook (void*, const void *);

 /* Override initializing hook from the C library. */
 void (*__malloc_initialize_hook) (void) = my_init_hook;

 static void
 my_init_hook (void)
 {
   old_malloc_hook = __malloc_hook;
   old_free_hook = __free_hook;
   __malloc_hook = my_malloc_hook;
   __free_hook = my_free_hook;
 }

 static void *
 my_malloc_hook (size_t size, const void *caller)
 {
   void *result;
   /* Restore all old hooks */
   __malloc_hook = old_malloc_hook;
   __free_hook = old_free_hook;
   /* Call recursively */
   result = malloc (size);
   /* Save underlying hooks */
   old_malloc_hook = __malloc_hook;
   old_free_hook = __free_hook;
   /* printf might call malloc, so protect it too. */
   printf ("malloc (%u) returns %p\n", (unsigned int) size, result);
   /* Restore our own hooks */
   __malloc_hook = my_malloc_hook;
   __free_hook = my_free_hook;
   return result;
 }

 static void
 my_free_hook (void *ptr, const void *caller)
 {
   /* Restore all old hooks */
   __malloc_hook = old_malloc_hook;
   __free_hook = old_free_hook;
   /* Call recursively */
   free (ptr);
   /* Save underlying hooks */
   old_malloc_hook = __malloc_hook;
   old_free_hook = __free_hook;
   /* printf might call free, so protect it too. */
   printf ("freed pointer %p\n", ptr);
   /* Restore our own hooks */
   __malloc_hook = my_malloc_hook;
   __free_hook = my_free_hook;
 }

 main ()
 {
   ...
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-13T06:34:28.940

请注意，my_malloc_hook() 解决方案在多线程程序中并不真正适用 - 请参阅[http://www.phpman.info/index.php/man/malloc_hook/3](http://www.phpman.info/index.php/man/malloc_hook/3)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T18:08:50.943

如果您的函数直接调用 sbrk，您可以简单地调用它 malloc 并确保它在库的 malloc 之前被链接。这适用于所有 Unix 类型的操作系统。对于 Windows，请参阅[是否有办法在 Windows 上的链接时重新定义 malloc？](https://stackoverflow.com/questions/120627/is-there-a-way-to-redefine-malloc-at-link-time-on-windows)

如果您的函数是库 malloc 的包装器，则 Alex 的 #define 建议将起作用。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2008-11-06T18:05:34.820

```
#undef malloc
#define malloc my_malloc 
```

只需将其放在您需要执行此操作的任何文件的顶部即可。

# vb.net - 在 VB.Net 运行时遍历未知类型的通用列表

> ID：269660
> 
> 赞同：2
> 
> 时间：2008-11-06T18:03:35.400
> 
> 标签：vb.net, generics, ienumerable

如果直到运行时才知道该列表的类型，有谁知道如何迭代通用列表？

例如，假设`obj1`作为`Object`:

```
Dim t As Type = obj1.GetType
If t.IsGenericType Then
    Dim typeParameters() As Type = t.GetGenericArguments()
    Dim typeParam As Type = typeParameters(0)
End If 
```

如果`obj`作为 a 传递，`List(Of String)`则使用上面的方法我可以确定`t`传递了一个通用列表 ( ) 并且它的类型是`String`( `typeParam`)。我知道我做了一个很大的假设，即只有一个通用参数，但这对于这个简单的示例来说很好。

我想知道的是，基于上述情况，我该如何做这样的事情：

```
For Each item As typeParam In obj1
    'do something with it here
Next 
```

甚至是像获取一样简单的东西`obj1.Count()`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T18:40:29.320

遍历您的列表的方法可以指定一个泛型类型：

```
Public Sub Foo(Of T)(list As List(Of T))
  For Each obj As T In list
     ..do something with obj..
  Next
End Sub 
```

那么你可以调用：

```
Dim list As New List(Of String)
Foo(Of String)(list) 
```

这种方法使代码看起来有点毛茸茸，至少在 VB.NET 中是这样。

如果您让列表中的对象实现特定接口，则可以完成同样的事情。这样，只要它们实现接口，您就可以使用任何对象类型填充列表，迭代方法仅适用于对象类型之间的公共值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T18:15:37.140

如果您知道 obj 是一个[Generic List](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)。那么你很幸运。

通用列表实现 IList 和 IEnumerable（两者都是非通用的）。因此，您可以强制转换为其中任何一个接口，然后通过它们进行 For Each。

*   IList 有一个计数属性。
*   IList 还有一个 Cast 方法。如果您不知道要转换的类型，请使用 object。这将为您提供一个 IEnumerable(Of object)，然后您可以开始使用 Linq。

# java - BigDecimal("0") 和 BigDecimal.ZERO 之间有区别吗？

> ID：269669
> 
> 赞同：26
> 
> 时间：2008-11-06T18:05:08.550
> 
> 标签：java, bigdecimal, zero

对于新变量的比较或初始化，您使用其中的哪一个会有所不同吗？

我知道 BigDecimal.ZERO 是 1.5 的功能，所以这是一个问题，但假设我使用的是 1.5，这有关系吗？

谢谢。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-11-06T18:08:07.170

`BigDecimal.ZERO`是一个预定义的常量，因此不必在运行时从字符串中求值`BigDecimal("0")`。它会更快，并且不需要创建新对象。

如果您的代码需要在 1.5 之前的版本上运行，那么您可以使用（备受诟病的）单例模式来创建等效于`BigDecimal.ZERO`. 第一次使用时，它会调用`BigDecimal("0")`创建一个零对象，并在后续调用中返回该对象。否则，如果您的代码在 1.5 系统上运行，您的单例对象可以直接返回`BigDecimal.ZERO`而不会受到运行时损失。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-11-06T18:09:17.917

使用 ZERO 不会创建新对象或需要任何解析。绝对是要走的路。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-13T14:14:25.993

在谈论运行时惩罚之前，请确保这段代码很重要。设置分析并测量完整的用例。

尽管如此，更喜欢`Bigdecimal.ZERO`在编译时检查它，而您可能会意外键入`new BigDecimal("9")`编译器会接受的 ，但这会导致应用程序出现错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T18:18:42.407

出于好奇，我检查了 BigDecimal 的构造函数，它对“0”字符串没有任何优化。所以肯定是的，有区别。

# python - 出于测试目的，如何在 MySQL 中导致死锁

> ID：269676
> 
> 赞同：10
> 
> 时间：2008-11-06T18:06:13.213
> 
> 标签：python, mysql, database, deadlock

我想让我的 Python 库与 MySQLdb 一起使用能够检测死锁并重试。我相信我已经编写了一个很好的解决方案，现在我想对其进行测试。

对于我可以使用 MySQLdb 运行以创建死锁条件的最简单查询的任何想法是什么？

系统信息：

*   MySQL 5.0.19
*   客户端 5.1.11
*   视窗
*   Python 2.4 / MySQLdb 1.2.1 p2

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-11-11T22:09:50.163

这是我如何在 PHP 中执行此操作的一些伪代码：

脚本 1：

```
START TRANSACTION;
INSERT INTO table <anything you want>;
SLEEP(5);
UPDATE table SET field = 'foo';
COMMIT; 
```

脚本 2：

```
START TRANSACTION;
UPDATE table SET field = 'foo';
SLEEP(5);
INSERT INTO table <anything you want>;
COMMIT; 
```

执行脚本 1，然后立即在另一个终端执行脚本 2。如果数据库表中已经有一些数据，您将遇到死锁（换句话说，它在您第二次尝试此操作后开始死锁）。

请注意，如果 mysql 不支持 SLEEP() 命令，请在应用程序本身中使用 Python 的等效命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T22:01:53.533

我不熟悉 Python，所以请原谅我的语言不正确如果我说错了......但是打开两个会话（在单独的窗口中，或从单独的 Python 进程中 - 从单独的框可以工作......）然后.. .

. 在会话 A 中：

```
 Begin Transaction 
      Insert TableA()  Values()... 
```

. 然后在会话 B 中：

```
Begin Transaction
  Insert TableB() Values()... 
  Insert TableA() Values() ... 
```

. 然后返回会话 A

```
 Insert TableB() Values () ... 
```

你会陷入僵局...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T21:51:06.720

您始终可以从另一个会话（例如 mysql CLI）运行 LOCK TABLE 表名。这可能会奏效。

在您释放它或断开会话之前，它将保持锁定状态。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T11:12:14.593

您想要以下内容。

**父.py**

```
import subprocess
c1= subprocess.Popen( ["python", "child.py", "1"], stdin=subprocess.PIPE, stdout=subprocess.PIPE )
c2= subprocess.Popen( ["python", "child.py", "2"], stdin=subprocess.PIPE, stdout=subprocess.PIPE )
out1, err1= c1.communicate( "to 1: hit it!" )
print " 1:", repr(out1)
print "*1:", repr(err1)
out2, err2= c2.communicate( "to 2: ready, set, go!" )
print " 2:", repr(out2)
print "*2:", repr(err2)
out1, err1= c1.communicate()
print " 1:", repr(out1)
print "*1:", repr(err1)
out2, err2= c2.communicate()
print " 2:", repr(out2)
print "*2:", repr(err2)
c1.wait()
c2.wait() 
```

**孩子.py**

```
import yourDBconnection as dbapi2

def child1():
    print "Child 1 start"
    conn= dbapi2.connect( ... )
    c1= conn.cursor()
    conn.begin() # turn off autocommit, start a transaction
    ra= c1.execute( "UPDATE A SET AC1='Achgd' WHERE AC1='AC1-1'" )
    print ra
    print "Child1", raw_input()
    rb= c1.execute( "UPDATE B SET BC1='Bchgd' WHERE BC1='BC1-1'" )
    print rb
    c1.close()
    print "Child 1 finished"

def child2():
    print "Child 2 start"
    conn= dbapi2.connect( ... )
    c1= conn.cursor()
    conn.begin() # turn off autocommit, start a transaction
    rb= c1.execute( "UPDATE B SET BC1='Bchgd' WHERE BC1='BC1-1'" )
    print rb
    print "Child2", raw_input()
    ra= c1.execute( "UPDATE A SET AC1='Achgd' WHERE AC1='AC1-1'" )
    print ta
    c1.close()
    print "Child 2 finish"

try:
    if sys.argv[1] == "1":
        child1()
    else:
        child2()
except Exception, e:
    print repr(e) 
```

注意对称性。每个孩子开始持有一种资源。然后他们试图获取别人持有的资源。为了好玩，您可以拥有 3 个孩子和 3 个资源，从而形成一个真正的恶性循环。

请注意，难以设计发生死锁的情况。如果您的事务很短且一致，则很难实现死锁。死锁需要（a）长时间持有锁的事务和（b）以不一致的顺序获取锁的事务。我发现通过保持交易简短和一致来防止死锁是最容易的。

还要注意非确定性。您无法预测哪个孩子会因死锁而死，哪个孩子会在另一个孩子死后继续。两者中只有一个需要死亡才能为另一个释放所需的资源。一些 RDBMS 声称有一个基于持有的资源数量的规则等等等等，但一般来说，你永远不会知道受害者是如何选择的。

由于这两个写入是按特定顺序进行的，您有点期望孩子 1 先死。但是，您不能保证。直到孩子 2 试图获得孩子 1 的资源，这并不是死锁——谁先获得的顺序可能无法决定谁死。

另请注意，这些是进程，而不是线程。由于 Python GIL 的原因，线程可能会无意中同步，并且需要大量调用才能`time.sleep( 0.001 )`让其他线程有机会赶上。流程——为此——稍微简单一些，因为它们是完全独立的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-23T21:42:49.193

不确定以上是否正确。看看这个：

[http://www.xaprb.com/blog/2006/08/08/how-to-deliberately-cause-a-deadlock-in-mysql/](http://www.xaprb.com/blog/2006/08/08/how-to-deliberately-cause-a-deadlock-in-mysql/)

# flash - Flash 和辅助功能

> ID：269686
> 
> 赞同：4
> 
> 时间：2008-11-06T18:09:11.223
> 
> 标签：flash, accessibility, screen-readers, section508

作为一名 Web 开发人员，我从事的许多项目都属于政府的保护伞，因此受 508 无障碍法律的约束，有时还受 W3C 无障碍指南的约束。在满足这些要求的同时，Flash 可以在多大程度上使用？

对于使用 javascript，口头禅是通过提供相同的内容和功能，只是在不同的页面上，或者以较少交互/动态的方式来“优雅地降级”。这允许非 JavaScript 浏览器/用户仍然使用该站点，并允许搜索引擎机器人访问所有内容。JAWS 和 Orca 等屏幕阅读软件的用户仍然可以充分使用该网站。

使用 flash，是否有类似的方法可以优雅地回退给非 flash 用户？如果不是，搜索引擎机器人对基于 Flash 的内容的访问性如何？此外，屏幕阅读器如何处理基于 Flash 的内容？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-06T18:19:56.883

我有视力障碍，我使用放大工具和 TTS 是为了方便，但不是必需品。我可以告诉你，Flash 无法与大多数辅助工具一起使用。我相信 JAWS（Windows 的市场领导者，但无论如何都不是压倒性的主导）说它支持 Flash，但大多数 Flash 开发人员似乎没有投入必要的工作来让 JAWS 了解 Flash 电影的文本内容。许多视障用户甚至没有安装闪存，因为在 95% 以上的时间里，闪存对他们来说毫无用处。

另一个考虑因素是 Mac OS X 提供的内置文本转语音功能也无法处理大多数 Flash 电影。

IMO“降级”或提供指向您内容的 HTML 版本的链接可能是确保您的网站可访问的唯一实用方法。如果您从头开始，如果可能的话，我会强烈考虑使用 JavaScript / JQuery over Flash。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-08T16:57:10.840

我是 Jaws 的完全盲用户，简短的回答是视情况而定。例如在 YouTube 上，我可以访问静音和播放/暂停按钮。然而，诸如滑块之类的东西不起作用。我认为，如果编码得当，Flash 不会像内容本身那样决定您网站的可访问性。例如，如果您需要播放视频，是否有足够的旁白让盲人可以跟随视频？如果您正在显示图表，是否有该数据的文本描述？我同意发帖者所说的尽可能使用 JavaScript / JQuery 的观点，但是对于需要 Flash 的视频之类的事情，您可以使其足够访问以执行诸如静音视频、停止视频等操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T18:52:22.340

Flash 可供视障人士使用，但需要一些时间和精力。它不会自动成为禁区。正如 Alxp 所指出的，检查不同的浏览器是否以这种方式与 flash 一起播放仍然很重要。

flash 还有一个额外的问题：它窃取了键盘快捷键。随着页面上的一闪而过，许多标准浏览器键盘控件停止运行。这些快捷方式对于有鼠标问题的人以及出于任何其他原因更喜欢键盘的人来说非常重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-16T14:36:29.437

如果您将 Flash 用于导航之类的事情，那么我会恳求您改用 HTML 和 CSS。它们更优雅地降级，不仅适用于使用网站阅读器的人，而且适用于以下人员：

*   连接速度较慢（如系留电话）
*   关闭闪光灯
*   位于未安装 Flash 且没有管理员权限的计算机上
*   他们的 Flash 版本已经过时了，而且他们不能/不会更新。

但是，如果您正在创建游戏之类的东西，其中 Flash 至关重要，我有一些针对听障人士的建议：

*   如果您在游戏中使用铃铛或声音来指示游戏事件，请添加一个选项以将其变成视觉铃铛。

这方面的一个例子是游戏植物大战僵尸。我在关闭声音的情况下播放了几个月（我通常在背景中播放音乐）。没想到有些丧尸在出现前几秒就被声音宣布了。这让我的游戏变得更难了。

*   如果您有语音说明，请同时将它们放入文本中。这也适用于视频！文本比游戏/视频旁边的文本文件更好，因为很难将视觉与音频配对。

# .net - 编写更高效的时钟函数

> ID：269692
> 
> 赞同：2
> 
> 时间：2008-11-06T18:10:14.263
> 
> 标签：.net, vb.net, performance, clock

我在 VB.NET 程序中有一个时钟功能，可以显示包括秒在内的时间。我目前有一个使用 NOW 不断轮询的计时器。我必须经常轮询系统时钟，因为我需要让第二次更新与系统时钟同步。

只有当秒数变化时，是否有更直接的访问时间？

有没有更有效的方法来编写这段代码？

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T18:23:01.243

为什么不使用计时器组件？这假设您使用的是 GUI 而不是构建服务。

您可以调用执行轮询的同步例程以使计时器非常接近秒数的变化，然后委托给计时器。您可以每分钟左右调用一次同步例程，以确保您没有得到任何操作系统漂移。

话虽如此，我确信有一种方法可以检测秒变化事件，我只是不知道该怎么做。

更新：

[此链接](http://en.csharp-online.net/Delegates_and_Events%E2%80%94Events_and_Delegates)的实现类似于我的设想。只需修改它，这样您就不会永久陷入循环，瞧！你有你的同步例程。

更新 2：

根据 Shog9 的反馈，我认为这可能是比轮询更好的方法：

```
Public Class Form1
   Private WithEvents clockTimer As New Timer
   Private currentTime As DateTime = DateTime.MinValue

   Private Sub ClockTick(ByVal sender As Object, _
      ByVal e As System.EventArgs) Handles clockTimer.Tick

      UpdateTimer()
      DisplayTimer()
   End Sub

   Private Sub UpdateTimer()
      currentTime = DateTime.Now

      clockTimer.Stop()
      clockTimer.Interval = 1000 - currentTime.Millisecond
      clockTimer.Start()
   End Sub

   Private Sub DisplayTimer()
      lblTime.Text = currentTime.ToString("T")
   End Sub

   Private Sub Form1_Load(ByVal sender As System.Object, _
      ByVal e As System.EventArgs) Handles MyBase.Load

      UpdateTimer()
      DisplayTimer()
   End Sub
End Class 
```

现在，根据我的初步测试，每个 Tick 事件都有某种漂移。在我的机器上，它在 12 到 20 毫秒之间变化。如果有人对如何可靠地纠正漂移有任何想法，我会对学习感兴趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T18:59:23.400

使用 Timer 对象，将其“间隔”设置为 0，将其“启用”设置为 true。这将大约每 15 毫秒触发一次（基于您的硬件配置）。在该方法中，设置 MyLabel.Text = DateTime.Now.ToString() （或您正在做的任何事情）。

这是完美的表现。

# .net - 如何调试 .NET 远程调用？

> ID：269703
> 
> 赞同：6
> 
> 时间：2008-11-06T18:12:43.450
> 
> 标签：.net, multithreading, remoting

我有一个具有以下基本架构的应用程序：

一种 Windows 服务 (Service)，它为远程访问 (.NET Remoting) 注册了一个 .NET 类型 (RemoteObject)。RemoteObject 创建使用 ThreadPool 进行 IO 处理的非 ThreadPool 线程。由于特定原因，必须将 ThreadPool 的大小限制在一个限制内。GUI 应用程序使用 .NET Remoting 来访问 RemoteObject。

我注意到，如果 ThreadPool 的大小太小，GUI 应用程序将在调用 RemoteObject 时挂起。

我的问题是，我怎样才能弄清楚为什么会挂起，以及为什么 RemoteObject 线程会受到 ThreadPool 的影响？

这真让我抓狂; 感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T19:06:06.553

我不确定这是否会有所帮助（我不知道这是否是您的问题），但如果您想在服务运行时对其进行调试，您可以在代码中添加它：

```
#if DEBUG
            if (!System.Diagnostics.Debugger.IsAttached)
                Debugger.Launch();
#endif 
```

你会得到一个对话框，要求你选择一个调试器。它是一种附加到正在运行的服务实例的简单方法。如果不出意外，这将让您在 UI 挂起时（通过按下调试工具栏上的暂停按钮）闯入您的服务并检查您的线程和调用堆栈。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-09-21T14:13:39.997

事实证明，.NET 远程处理基础结构使用 .NET ThreadPool（或共享底层资源），因此如果您的应用程序正在使用所有 ThreadPool 线程，则远程处理调用可能会挂起。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T18:41:44.450

这可能不是特别有用，但无论如何我都会把它扔掉。

在调试通过远程通信的服务和客户端时，我通常会运行两个调试器实例：一个用于客户端，一个用于服务。为了清楚起见，我正在运行两个视觉工作室副本。对于服务，您可以使用 attach 命令，也可以更改 main 并直接调用 start（绕过所有服务代码）。

以下是我通常通过更改 main 来启用调试的方法，您必须这样做以及对服务的 DebugService 调用，它实际上只是调用 start 的入口点。一旦我有了这个，我只需通过定义或通过添加 ' 来`SERVICE_DEBUG`更改服务调试。现在您基本上已经将您的服务转换为控制台应用程序。`#if``!'`

```
#if SERVICE_DEBUG
            ServiceHost s = new ServiceHost();
            s.DebugService();
            Thread.Sleep( 300000000 );

#else
            ServiceBase.Run( ServicesToRun );
#endif 
```

一旦您完成了设置和运行，您就可以单步调试客户端，当远程调用访问服务时，您可以单步调试服务代码，从而允许您同时调试两者。

*出于好奇*，您是否直接从 GUI 线程调用远程对象？如果是这样，GUI 线程将阻塞，直到远程调用完成。这将锁定整个 GUI 并使其无响应。这不是问题的解决方案，但如果是这种情况并且您的服务线程没有返回，它也会导致 GUI 挂起。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-07T01:42:56.287

几年前，我设计并实现了一个使用 .NET Remoting 的关键业务系统。我们有一个实现为 Windows 窗体 GUI 的客户端、一个实现为 Windows 服务的服务器和一个 SQL Server 数据库。

我为故障排除/调试/开发而设计，所以我的第一个设计标准是我可以轻松删除整个 .NET Remoting 实现并在我的桌面上运行整个系统。因此，我可以通过将单个布尔配置设置更改为“false”= off 来停用远程处理。然后，我可以在没有 .NET Remoting 的开销或干扰的情况下完全排除故障、调试和开发。

看来这对您的情况也很有价值。事实上，我无法想象这不是一个理想的特性，特别是因为它很容易实现。

因此，为了实现它，客户端和服务器代码中的每一个都使用配置设置来决定实例化哪个实现类以与另一方通信。所有通信都通过自定义 C# 接口发生，该接口在每一侧都有两个具体的实现类：一个类使用 .NET Remoting 实现通信，另一个类将通信实现为直接进程内传递（直接调用）。

只有一对类（每边一个）对 .NET Remoting 有任何了解，因此完全隔离。大多数时候，所有开发人员都在关闭远程处理的情况下工作，这样更快更简单。当他们需要时，在极少数情况下，他们会打开它（主要是我，或者当有人连接到测试/生产以进行故障排除时）。

顺便说一句，我使远程处理接口变得很简单： public Response execute(Request)

除此之外，我还使用了上面提到的调试器启动技巧，我同意您需要注意对 GUI 线程的影响。

# asp.net - 使用 Python 对 ASP.NET 角色/成员身份创建的数据库中的原始用户名、哈希、盐进行身份验证

> ID：269713
> 
> 赞同：6
> 
> 时间：2008-11-06T18:14:45.457
> 
> 标签：asp.net, python, hash, passwords

我们有一个当前应用程序，其中用户登录凭据存储在 SQL Server 数据库中。这些基本上存储为纯文本用户名、密码散列和此散列的关联盐。

这些都是由 ASP.NET 的成员/角色系统中的内置函数创建的。这是名为“joe”的用户和密码“password”的一行：

> 乔，kDP0Py2QwEdJYtUX9cJABg==，OJF6H4KdxFLgLu+oTDNFodCEfMA=

我已将这些内容转储到 CSV 文件中，并试图将其转换为 Django 的可用格式，该格式以这种格式存储其密码：

[算法]$[盐]$[哈希]

其中盐是纯字符串，散列是 SHA1 散列的十六进制摘要。

到目前为止，我已经能够确定 ASP 正在以 base64 格式存储这些哈希和盐。上面的那些值解码成二进制字符串。

我们使用反射器来收集 ASP 如何根据这些值进行身份验证：

```
internal string EncodePassword(string pass, int passwordFormat, string salt)
{
    if (passwordFormat == 0)
    {
        return pass;
    }
    byte[] bytes = Encoding.Unicode.GetBytes(pass);
    byte[] src = Convert.FromBase64String(salt);
    byte[] dst = new byte[src.Length + bytes.Length];
    byte[] inArray = null;
    Buffer.BlockCopy(src, 0, dst, 0, src.Length);
    Buffer.BlockCopy(bytes, 0, dst, src.Length, bytes.Length);
    if (passwordFormat == 1)
    {
        HashAlgorithm algorithm = HashAlgorithm.Create(Membership.HashAlgorithmType);
        if ((algorithm == null) && Membership.IsHashAlgorithmFromMembershipConfig)
        {
            RuntimeConfig.GetAppConfig().Membership.ThrowHashAlgorithmException();
        }
        inArray = algorithm.ComputeHash(dst);
    }
    else
    {
        inArray = this.EncryptPassword(dst);
    }
    return Convert.ToBase64String(inArray);
} 
```

本质上，从数据库中提取盐，然后 b64 将其解码为二进制表示。它对原始密码执行“GetBytes”，然后将它们连接起来，首先是盐。

然后它在这个新字符串上运行 SHA1 算法，base64 对其进行编码，并将其与存储在数据库中的值进行比较。

我试图编写一些代码来尝试在 Python 中重现这些哈希值，但我失败了。在我弄清楚它是如何翻译的之前，我将无法在 Django 中使用它们。这是我的测试方式：

```
import hashlib
from base64 import b64decode, b64encode

b64salt = "kDP0Py2QwEdJYtUX9cJABg=="
b64hash = "OJF6H4KdxFLgLu+oTDNFodCEfMA="
binsalt = b64decode(b64salt)
password_string = 'password'

m1 = hashlib.sha1()
# Pass in salt
m1.update(binsalt)
# Pass in password
m1.update(password_string)
# B64 encode the binary digest
if b64encode(m1.digest()) == b64hash:
    print "Logged in!"
else:
    print "Didn't match"
    print b64hash
    print b64encode(m1.digest()) 
```

我想知道是否有人可以看到我的方法中的任何缺陷或可以提出替代方法。也许您可以使用上面的算法以及上面的已知密码和盐并在您的系统上生成哈希？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T22:57:12.407

当您将 UTF16 字符串转换为二进制时，python 似乎正在插入一个字节顺序标记。.NET 字节数组不包含 BOM，所以我做了一些 ghetto python，将 UTF16 转换为十六进制，删除前 4 个字符，然后将其解码为二进制。

可能有更好的方法来删除 BOM，但这对我有用！

这是一个通过：

```
import hashlib
from base64 import b64decode, b64encode

def utf16tobin(s):
  return s.encode('hex')[4:].decode('hex')

b64salt = "kDP0Py2QwEdJYtUX9cJABg=="
b64hash = "OJF6H4KdxFLgLu+oTDNFodCEfMA="
binsalt = b64decode(b64salt)
password_string = 'password'.encode("utf16")
password_string = utf16tobin(password_string)

m1 = hashlib.sha1()
# Pass in salt
m1.update(binsalt + password_string)
# Pass in password
# B64 encode the binary digest
if b64encode(m1.digest()) == b64hash:
    print "Logged in!"
else:
    print "Didn't match"
    print b64hash
    print b64encode(m1.digest()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T19:06:58.817

关于可能出了什么问题的两个想法。

首先，来自反射的代码具有三个路径：

*   如果 passwordFormat 为 0，则按原样返回密码。
*   如果 passwordFormat 为 1，它会像您的 python 代码一样创建哈希。
*   如果 passwordFormat 不是 0 或 1 它调用 this.EncryptPassword()

你怎么知道你正在散列密码，而不是用 this.EncryptPassword() 加密密码？您可能需要反转 EncryptPassword() 成员函数并复制它。那是除非您有一些信息可以确保您对密码进行哈希处理而不是对其进行加密。

其次，如果它确实在对密码进行哈希处理，您可能希望查看 Encoding.Unicode.GetBytes() 函数为字符串“password”返回的内容，因为您可能会得到类似以下内容：

```
0x00 0x70 0x00 0x61 0x00 0x73 0x00 0x73 0x00 0x77 0x00 0x6F 0x00 0x72 0x00 0x64 
```

代替：

```
0x70 0x61 0x73 0x73 0x77 0x6F 0x72 0x64 
```

我希望这有帮助。

# java - 在后台终止 Derby DB 网络服务器

> ID：269720
> 
> 赞同：0
> 
> 时间：2008-11-06T18:17:12.143
> 
> 标签：java, derby, javadb

我正在寻找一种在网络模式下运行 Apache Derby 服务器的好方法。我正在使用 NetworkServerControl 来启动服务器，它运行良好。

我这样启动服务器：

```
/**
 * starts the network server
 * @return true if sucessfull
 */
public boolean start()
{
    try
    {
        // just to be sure that we don't start two servers
        this.stop();

        server = new NetworkServerControl();
        server.start( null );

        return true;
    }
    catch ( Exception ex )
    {
        this.logLogger.debug( ex );
        return false;
    }
} 
```

并像这样停止它：

```
/**
 * stops the server
 * 
 * @return true if there were no problems stopping the server
 */
public boolean stop()
{
    try
    {
        if ( server == null )
        {
            server = new NetworkServerControl();
        }
        server.shutdown();

        return true;
    }
    catch ( Exception ex )
    {
        this.logLogger.debug( ex );
        return false;
    }
} 
```

在 main() 我有这个，所以在服务器运行时进程不会死

```
(...)
clsDB.start();

while( clsDB.testForConnection() )
{
   Thread.sleep( 60000 );
} 
```

testForConnection() 看起来像这样：

```
/**
 * Try to test for a connection
 * 
 * @return true if the server is alive
 */
public boolean testForConnection()
{
    try
    {
        server.ping();

        return true;
    }
    catch ( Exception ex )
    {
        this.logLogger.debug( ex );
        return false;
    }
} 
```

我的问题是，当我的 JAR 的新实例被调用时，旧的实例仍然会运行（除非我真的很幸运并且在新服务器启动之前进行了测试）。

我知道我可以测试服务器是否已经在运行，然后我不会再次启动，但是如果服务器已经在那里，我希望 start 像重新启动一样工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T18:28:33.823

不久前我用 derby 做了一个项目（包括在网络模式下运行），我似乎记得有一些 SQL 可以在关闭 derby 的服务器上执行。

因此，假设是这种情况（抱歉，没有时间谷歌搜索它），您可以在启动时查找您的网络实例。如果存在，则在其上运行此 SQL。一旦您确定它最终被关闭（我想轮询它存在），您就可以再次启动它。

**编辑：**哦，这不是 SQL，它使用 'shutdown=true' 作为参数连接到数据库。见[这里](http://db.apache.org/derby/docs/dev/devguide/tdevdvlp40464.html)：

```
DriverManager.getConnection(
    "jdbc:derby:sample;shutdown=true"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T18:39:20.087

我提出的另一个解决方案不与您可能不喜欢的 JAR 交互。

另一种方法是让启动 derby 实例的 JAR 打开它在启动 derby 时监视的 TCP 端口。然后，您可以从您的新 JAR 实例向该实例发送您自己的关闭命令（显然是在打开您自己的 TCP 端口之前）。

您的 derby JAR 实例的启动将是：

*   查看是否同意的 TCP 端口已打开。
*   如果是这样，请发送关闭命令。
    *   `stop()`然后，您将命令发送到的 JAR 将使用该方法关闭 derby 。
    *   完成关闭 derby 后，它将发送`success`回任何内容并关闭连接。
*   我们监听约定的 TCP 端口。
*   我们打电话`start()`并开始德比。

这比我的其他解决方案工作更多，但理论上是一个更好的解决方案，因为作为重新启动的一部分，您的 JAR 可能还想做其他事情（清理/重新启动其他资源，记录它正在关闭的事实，诸如此类） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-07T17:38:31.417

我们最终使用了一个在服务器被终止时创建的文件，然后在服务器进程上我们定期检查该文件是否存在，如果它在那里我们终止服务器。

# java - 在 Java 中舍入负数

> ID：269721
> 
> 赞同：19
> 
> 时间：2008-11-06T18:18:32.157
> 
> 标签：java, rounding

根据[维基百科](http://en.wikipedia.org/wiki/Rounding)，当舍入一个负数时，你会舍入绝对数。因此，根据这种推理，-3.5 将四舍五入为 -4。但是当我使用 java.lang.Math.round(-3.5) 返回-3。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-06T18:21:37.970

根据[javadoc](http://java.sun.com/javase/6/docs/api/java/lang/Math.html#round(double))

> 返回最接近参数的 long。通过加 1/2、取结果的底并将结果转换为 long 类型，将结果四舍五入为整数。换句话说，结果等于表达式的值：
> 
> `(long)Math.floor(a + 0.5d)`

从概念上讲，你四舍五入**。**也就是说，到下一个整数值**大于**-3 大于-3.5，而-4 小于。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T18:23:19.527

有多种取整方法；您正在查看的那个称为对称算术舍入（如其所述）。您所指的部分指出：“这种方法通常用于数学应用中，例如会计。它是小学数学课上普遍教授的方法。” 这似乎承认这不是全球公认的规则，只是最常见的规则。

就个人而言，我不记得曾经在学校里教过这条规则。我对四舍五入的理解一直是 0.5 向上舍入，无论数字的符号如何。显然，Java 的作者也有同样的理解。这是不对称算术舍入。

不同的工具和语言可能使用不同的舍入方案。Excel 显然使用对称方法。

（总的来说，我建议如果您发现 Wikipedia 和经验之间存在冲突，请在其他地方寻找信息。Wikipedia 并不完美。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-06T19:35:05.873

对于它的价值，`[java.math.BigDecimal](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html "java.math.BigDecimal Javadoc")`如果您需要对此类事情进行更多控制，则可以选择舍入模式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-06T18:31:12.583

您引用的维基百科文章并没有说这是唯一的舍入方法，只是常见的舍入方法。在那篇文章中还提到了几种替代方法（不幸的是，这些方法都没有描述 Java 的舍入方法——即使它们在指出 JavaScript 所做的事情时将其称为“非对称算术舍入”）。

您需要决定如何*对*数字进行四舍五入，然后使用该方法。如果 Java 的实现与此匹配，那就太好了。否则你需要自己实现它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T18:24:27.653

根据Javadocs：

返回最接近`long`参数的值。通过加 1/2、取结果的底并将结果转换为 type ，将结果四舍五入为整数`long`。换句话说，结果等于表达式的值：

```
(long)Math.floor(a + 0.5d)
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T18:29:32.433

事实证明，惯例是四舍五入。我猜维基百科是错误的。然而，事实证明微软弄错了，因为他们也将其四舍五入为 -4，这不是惯例（我与拥有数学博士学位的人核实过）。

# svn - 在 Subversion 中将功能分支合并到主线的最佳方法是什么？

> ID：269722
> 
> 赞同：6
> 
> 时间：2008-11-06T18:18:33.873
> 
> 标签：svn

我们在 Subversion 中使用功能分支进行开发，这是一种非常方便的方法，可以将尚未准备好用于主线的代码保存在版本控制中。但是，每当我将功能分支修订版合并到主线中时，都会很痛苦。现在我执行以下步骤：

1.  将原始功能分支修订签出到新目录
2.  使用 Beyond Compare 之类的工具在我当前的开发和原始功能分支目录之间执行差异
3.  将当前主线版本检出到新目录
4.  将新的/更改的文件合​​并到当前的主线目录中。
5.  使用我的 IDE 执行差异以确保所有文件都正确签出/添加到 subversion
6.  编译和测试
7.  犯罪

在我看来，这个过程中有很大的错误空间，每次我走过这些步骤时都会让我感到紧张。诚然，一切都在我的功能分支上签入 Subversion，因此任何步骤的错误都是可以恢复的。

我相信 Subversion 1.5 有办法将分支合并到主线中，但我们仍在使用 Subversion 1.4。其他人使用什么来简化将 Subversion 中的功能分支合并到他们的主线开发中的步骤？你在使用不同的工具吗？您是否在使用 Subversion 1.5 中的合并功能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T18:25:58.257

我目前正在使用 Subversion 1.5 的新 --reintegrate 功能，我认为这很棒。它比手动方式更容易，更不容易出错。然而，不利的一面是，新的合并功能要求存储库和客户端都在 1.5 上，并且对 1.5 存储库的更改排除了 1.5 以外的任何客户端的使用......所以要获得合并功能，它基本上是一个全有或全无的情况。

至于您最初的问题，您只需要非常严格地跟踪您在开发期间将哪些主要分支修订合并到您的工作分支中。然而，即使使用 1.5 的 --reintegrate 特性，确保重新集成的主分支的工作副本看起来正确并在提交之前编译仍然很重要。它基本上让生活变得更轻松（特别是对于寿命更长的功能分支），因为您不必保留严格的日志来记录您所做的更改以及何时将其他分支的更改集成到您的功能分支。

subversion.tigris.org 上的发行说明文档写得非常好，我建议您简要查看一下，以了解 1.4 和 1.5 之间的所有更改以及对新合并工具的良好描述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T18:24:02.770

步骤 1、2、4 和 5 内置于 subversion 中，命令 'svn merge' 完成。在主线类型的工作副本上输入“svn merge -r startrev:lastref svn://repository/branchurl”。Startref 和 lastref 将表示修订窗口，应合并到主线中。'svn://repository/branchurl' 应该是你的分支的 URL。

Subversion 1.5 为这个特性带来了更好的支持。您不再需要指定要合并的修订，因为 subversion 现在保留有关合并的信息并简单地合并所有尚未合并的修订。

[在Subversion-book](http://svnbook.red-bean.com/nightly/en/svn-book.html#svn.branchmerge.basicmerging)中阅读有关它的更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T18:27:44.153

如果您想要合并回主线分支是您的分支（即您不是为其他开发人员执行此操作的集成商），那么您需要执行以下操作：

*   记下您上次将主线合并到分支中的修订版（以保持同步）。让我们称之为“LASTSYNC”
*   将主线分支检出到一个新目录（如 MergeFeatureBranchToTrunk），构建它
*   在那个分支中，使用`svn merge "LASTSYNC":HEAD svn://path/to/FeatureBranch .`
*   解决冲突（如果有）
*   编译
*   测试
*   使用差异工具检查您的更改，以确保一切正常
*   提交回主线

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T19:29:02.577

看看[svnmerge](http://www.orcaware.com/svn/wiki/Svnmerge.py)；它跟踪“我合并了什么？我选择不合并什么？” 为您完成部分工作，并依靠 svn 的“合并”命令来完成繁重的工作。

# msmq - 绑定文件中的 BizTalk MSMQ 用户 ID 和密码

> ID：269725
> 
> 赞同：1
> 
> 时间：2008-11-06T18:19:17.570
> 
> 标签：msmq, biztalk, binding

我正在设置一个由批处理文件驱动的部署解决方案，因此它是可重现的 - 我有一个可以工作的绑定文件，但我现在已经添加到我的 MSMQ 适配器上 - 在我的本地机器上工作，但我发现我必须添加用户 ID 和密码才能使其在实际服务器上工作 - 它在域中，我的虚拟开发机只是工作组

有没有办法将用户名和密码添加到文件中？- 似乎不太可能，因为那将有明文密码，但解决方案是什么 - 我有点认为是 SSO，但这是一个我没有靠近过的领域

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-06T21:43:12.010

您可以将用户 ID 和密码放入任何支持身份验证的 BizTalk 绑定，包括 MSMQ。为了安全起见，密码不会被导出，你只是得到一个掩码。

除非已配置绑定文件的用户名和密码部分，否则不会导出它们，因此最简单的做法是手动配置带有用户名和密码的 MSMQ 发送端口并导出绑定 - 这会强制包含用户名和掩码密码的元素生成到绑定文件中。

您在绑定文件中寻找的是 MSMQ 发送端口的 <TransportTypeData> 元素。这包含作为编码数据的所有适配器配置信息。

在该元素中有一个用户名和密码部分。密码将被星号掩盖。将环境密码放在那里并导入绑定。

带有用户名和密码的编码数据部分如下所示：

&lt;userName&gt;YourUserName&lt;/userName&gt;&lt;password&gt;******&lt;/password&gt;

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T21:25:35.697

> 出于安全原因，当您导出绑定时，BizTalk Server 会从文件中删除绑定的密码。导入绑定后，您必须重新配置发送端口和接收位置的密码，然后它们才能正常工作。您可以在 BizTalk Server 管理控制台的传输属性对话框中为发送端口或接收位置配置密码。有关说明，请参阅如何创建发送端口。另请参阅如何创建接收位置。

*来自[http://msdn.microsoft.com/en-us/library/aa558708.aspx](http://msdn.microsoft.com/en-us/library/aa558708.aspx)*

但是，如果您打开投标文件并向下滚动到带有 MSMQ 适配器属性的行，您会发现空节点。然后您所要做的就是填写这些和正确的值，它们将在您下次导入绑定文件时使用。

当然，您必须记住每次导出新绑定时都要重做...

# javascript - 寻呼替代品

> ID：269729
> 
> 赞同：1
> 
> 时间：2008-11-06T18:20:43.090
> 
> 标签：javascript, html, animation, dhtml

我正在开发一个项目，该项目返回的分页结果可能有数百页。我一直在尝试比标准的 fisrt/last/next/previous 链接和跳转到文本框更有用的方法来执行分页。我的另一种选择是有一个滚动的页面列表。我会一次显示 5 到 7 个链接，以当前页面为中心，但在任一侧的按钮上添加悬停操作以滚动编号列表。这允许用户在没有繁琐的“跳转到”文本框的情况下在页数中向前跳转。有没有人有更好的想法？

如果没有，我正在尝试决定实现上述功能的方法，但我不确定如何只显示 div 的一部分（div 是完整的链接列表）。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T18:37:10.733

您可能会发现[Endless Pageless](http://unspace.ca/discover/pageless/)是一本有趣的读物。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T18:29:08.533

根据数据，您可以以不同的方式对其进行分类并显示索引。页面是一种方式。日历是另一个，等等。

基本上是主/详细视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T18:31:35.360

另一种选择是使用在标题气泡中显示当前页面（和/或记录范围）编号的滑块控件。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-06T18:33:14.610

您可以使用包含页码的下拉列表。

# .net - 在解决方案中测试项目

> ID：269730
> 
> 赞同：15
> 
> 时间：2008-11-06T18:20:43.137
> 
> 标签：.net, visual-studio, unit-testing, solution

在 .NET 中，您应该将单元测试项目与解决方案的其余部分放在一起吗？还是应该有一个包含所有测试项目的测试解决方案？

我们的代码库解决方案包含所有测试项目……这似乎有点麻烦。

你平时做些什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T18:23:04.567

在我们当前的项目中，我们决定将所有单元测试放在单独的项目中。应用程序代码和测试在同一个解决方案中，但至少我们可以构建（和部署）一个没有单元测试代码的版本。

到目前为止，这样做的缺点是有时您的单元测试无法到达应用程序代码的某些成员（受保护的和内部的），但这通常会导致我们发现我们的设计可以改进。

[而且我想我应该在此处](https://stackoverflow.com/questions/271808/write-unit-tests-into-an-assembly-or-in-a-separate-assembly)指出一个类似的线程，并提供有关相同/相似主题的更多答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T18:22:13.227

我一直将它们作为解决方案的一部分——毕竟，它们是解决方案的一部分。您可以有多种解决方案，但可以使用不同的方法来查看您的项目，因此您可能希望在某些情况下创建无测试解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T18:25:41.270

我们的测试代码没有发布，但它们是整个解决方案的一部分。我们的构建器分离出测试组件和核心组件。从解决方案管理的角度来看，一个包含 140 多个项目的解决方案似乎是压倒性的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T18:27:03.047

我们总是在同一个解决方案中使用一个单独的项目。

这意味着我们可以确定（使用引用）单元测试代码也测试我们的显式引用（而不是隐式地获取某些东西的可见性，因为它在同一个程序集中——例如“内部”）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T19:28:15.950

通常我将单元测试放在他们自己的项目中，并将集成测试放在他们自己的应用程序解决方案中的项目中。

在我工作的地方，我们正在考虑将 Web 测试放在一个单独的解决方案中。我们计划与 QA 团队共享 Web 测试创作，我们不希望这些测试成为构建责任。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T18:23:23.647

我不使用 .NET，但是当我开发任何类型的测试用例时，我会将它们与其余代码隔离开来，这样我就可以在没有测试的情况下部署应用程序。用户不需要，甚至不需要这些东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T18:35:55.850

看看你的项目的设计。如果它靠近 MVC 布局或其替代方案之一，那么您应该有不同级别的不同程序集。为设计的每个级别制作一个测试子组件。

我们的测试项目通常代替创建 EXE 的项目运行。我们的 EXE 项目是一个薄壳，它将事件和信息传递给一个程序集，该程序集充满了控制器类，其中包含大多数人放入 EXE 项目的代码。这允许测试项目在 90% 的正常测试过程中伪装成 EXE。

我们仍在为实际测试用例制定最佳安排。现在我们有几个主要级别的框架实用程序、应用程序对象、UI 框架、命令、UI 控制器和 EXE。除了 EXE（手动测试）之外，每个级别都有一个程序集。当我们编辑一个程序集时，我们会加载该级别的测试程序集。当我们需要做一些涉及每个级别的事情时，我们必须加载所有测试程序集。

在我们的一键构建过程中，我们运行测试项目 exe。（我们为此有一个单独的实用程序）。

# frameworks - 框架/IDE 知识陷阱

> ID：269755
> 
> 赞同：4
> 
> 时间：2008-11-06T18:26:47.570
> 
> 标签：frameworks, ide

我们不会先教孩子微积分。我们首先教他们算术，然后是代数，然后是几何，解析几何，最后是微积分。

那么，为什么我们要先教我们的计算机科学家框架和 IDE。一些课程确实迫使学生学习计算机科学基础知识，但我看到的绝大多数毕业生都无法构建自己的框架来挽救生命。

那么，下一代工具制造商在哪里？

我们如何促进对创建框架和开发环境所必需的理解？

这当然是一般性的。并非所有的教育都缺乏，但它似乎是大多数，它降低了我们整个职业的质量。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T18:34:07.663

摆脱需要 X 年 Y 年经验的人力资源部门。大学只是根据人力资源部门的要求调整课程。

我雇用的毕业生可以在某事上编码（我真的不在乎什么语言）并且谁可以学习。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-06T18:38:20.450

我明白你的意思，尽管我认为数学类比不太合适。您**必须**了解基本算术才能在任何其他数学学科中完成任何事情。

当我开始编程时，框架几乎是闻所未闻的。如果你想要一棵二叉树，上帝保佑，你去写了一棵。在 C 或汇编程序中。基本上就是这样，所以要完成任何事情，你必须知道很多。

今天，框架和 IDE 以及设计人员使“菜鸟”能够在不知道如何构建框架、编译器或管理内存分配的第一件事的情况下创造出非常出色的东西。

真正的问题是，那些因为使用 Frontpage 或 Access 而认为自己很棒、很棒的程序员的 dingbats 呢？经理们很难区分那种程序员和真正**了解**软件开发作为一门学科的程序员。

那么，具体来说，为什么会这样呢？因为每个人都想要一份工作，没有人雇用知道如何构建二叉树的程序员。他们想要了解 .Net 或 J2EE 等的程序员。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T18:47:26.157

我认为可能有足够的工作可供 9 到 5 名程序员从框架级别开始并从那里开始。真正好的那些——主要是你作为职业和/或爱好的项目——将会获得他们在大学里可能随着时间的推移而错过的知识。无论您教什么课程，您都不能强迫每个人都成为出色的程序员。好奇的学生将学习基础知识，无论是在课堂上教给他们还是完全自学。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-06T21:02:43.060

我觉得这个比喻有点不对。一个更好的类比是“我们不教我们的孩子使用计算器进行加法和减法，为什么要教程序员使用 IDE 进行编程？”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T21:32:55.137

有工具制造商和工具破坏者。当然还有工具，但我们不要去那里。

如果你仔细看看汽车车间，你会看到很多在五金店货架上看不到的有趣的小工具。就像那些用于推回制动卡钳活塞的那样。或者用于压缩阀杆的夹子，这样您就可以在与您的伙伴谈论钉新秘书时用一只手取出夹头（而不是在弹簧从螺丝刀滑出时看着它们飞过房间）。

这些是由机械师设计的。它们真的很有效，通常小而便宜，而且在你看到它们之前完全无法理解。

汽车技术的大部分深刻变革是自下而上的，但也需要自上而下的。单个机械师无法做出根本性的技术改变，例如从铸铁到合金头的转变。新扫帚扫得干净，旧扫帚识角。你需要两者。

但我离题了：关键是，如果机械师缺乏基本技能和知识，他们就无法设计这些工具。当我还是个孩子的时候，我父亲用废铁给我造了一辆完整的摩托车。作为一个成年人，由于缺乏他的技能、知识和思维方式，我几乎无法维护我从本田买的自行车，更不用说像 T 先生那样疯狂地创作。

有了代码，我就像我父亲用钢铁一样。Donald Knuth 是我永远的伙伴，当我们的 GPS 记录器的无线协议需要在 .NET 中实现时，他们会来找我。小部件猴子不知道从哪里开始。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T21:45:45.437

我认为问题实际上是一般的 GUI 范式。

微软使使用计算机变得更加容易，他们普及了图形用户界面。他们也将这个界面隐喻（桌面、文件）带入了编程领域，并且使用他们的 Visual Basic 工具也非常有效。

但正如 GUI 掩盖了“幕后”发生的事情一样，IDE 也掩盖了位和字节的操作。当然，问题是风险回报率——程序员为了换取生产力而失去了多少理解？

粗略地看一下“计算机编程的艺术”可能会说明 IDE 为何有用。“当我们拥有 1 位项目时，就可以实现最终的打包密度，因为我们可以将其中的 64 个项目塞进一个 64 位的字中。例如，假设我们想要一个包含所有小于 1024 的奇质数的表格，所以我们可以很容易地确定一个小整数的素数。没问题；只需要八个 64 位数字：

p0 = 011101101101001100101101001001001100101100101001000101101101000000 p1 = . . 。”

编程真的很难，你可以看到一个 IDE 会如何帮助。:^)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T18:47:28.980

在编程方面，学习抽象比学习细节更容易。教某人手工编写汇编程序以打印“Hello World”比让他们将一个带有按钮的表单拼凑在一起，当单击该按钮时显示“Hello World”消息。

在学习驾驶之前，您不知道如何制造汽车的发动机，是吗？因为开车没有必要。同样，您无需了解链表或二叉树的工作原理即可维护名称列表并进行搜索。

总会有人想深入了解事物的“原因”，但我认为这不是完成工作所必需的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T18:47:52.113

我总是通过问一些困难的问题来筛选申请，这些问题只有在他们了解某些事情的真正运作方式时才能回答。我认为大学和大学教授人们基于框架的开发，而不是专注于核心软件原理，这真是一种耻辱。我同意，最重要的是了解编程的工作原理并有动力去学习任何东西的人。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T18:55:22.940

我知道的大多数大学都有计算机编程课程的介绍，教授基本的编程概念。不幸的是，如果不实际编写代码，就不可能教授编程。

问题是有些人更喜欢使用一些 OO 语言（如 JAVA 或 C#）来教授这门课程，因此学生必须使用 Visual Studio（或 Java 等价物）。当 IDE 强制您以某种方式工作时，很难解释基本概念。

我认为学生学习的第一语言应该是函数式语言，比如 C。这样你就可以减少它们与基本 CS 概念之间的抽象层。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-06T19:00:59.640

同意cfeduke。

我查看了与两年前相同的 CS 课程的作业，但它们的难度要大得多。5年前，**难度**更大。

CS 门槛越来越低，大概是因为越来越多的工作不需要任何复杂的 CS 科目的工作知识。人们有大量的工作只是为了削减代码。

由于传统上想成为程序员的人都参加了 CS 课程，因为编码变得更容易了，情况仍然如此。

真正需要发生的是 CS*不是*专业软件开发的要求。取而代之的是，需要另一种课程，更多地关注让人们走出家门和削减代码。

这将使 CS *成为*您下一代工具构建者的课程。

# .net - 如何使用 .NET 代码从 VB6 应用程序读取 MSMQ 消息？

> ID：269759
> 
> 赞同：1
> 
> 时间：2008-11-06T18:27:21.657
> 
> 标签：.net, vb6, msmq

我正在从 VB6 应用程序向 MSMQ 写入一个简单的 xml 字符串，但是当我尝试使用 XmlMessageFormatter 从 C# 中的队列中读取消息时，出现以下错误：

“名称不能以 '.' 开头。特点”

如何使用 .Net 代码成功阅读这些消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-13T23:00:04.813

我相信您必须使用 ActiveXMessageFormatter，而不是 XmlMessageFormatter。XmlMessageFormatter 用于在 .net 应用程序之间发送对象。您发送的不是 xml，而是字符串。而不是 .net 字符串。根据 ActiveXMessageFormatter 的文档，它用于：

> 使用与 MSMQ ActiveX 组件兼容的格式将原始数据类型和其他对象序列化或反序列化到消息队列消息的正文或从消息正文中反序列化

当您从 vb6 发送时，您使用的是 msmq com 接口。这是 ActiveX 接口的另一个名称。收到带有 ActiveXMessageFormatter 的字符串后。将其显式转换为 xml 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T21:41:46.757

首先检查您的数据以确保它确实如错误消息所暗示的那样。如果是，首先以文本或二进制格式读取数据，删除有问题的“。”，然后使用 xmlmessageformatter

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-16T15:00:10.150

我有一些坏消息。我遵循了提供的建议，但没有奏效。

我最终创建了 VC++ COM 对象，它将消息从我的 .NET 应用程序发布到队列中，这样另一端的 VC++ COM 接收器就可以理解该消息。

我怀疑您需要创建一个从 .NET 应用程序调用的 VB6 COM 对象来发送消息。

COM 对象使用的 mqao.dll 似乎使用了与 .NET 不同的格式化程序，甚至 ActiveX 也不起作用。

显然，这也意味着两个队列，一个用于遗留 COM 应用程序，一个用于 .NET 应用程序。因此，您将发送相同的消息两次，每个目标客户端发送一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-02T17:45:12.290

我刚刚花了一整天的时间来处理那些被隐藏在如此多的抽象层和配置下的格式化程序放入和读取 MSMQ 的消息，以至于我在有生之年无法找到它们。我构建了以下函数作为对似乎至少包含一点可读 ASCII 的任何 msmq 消息的暴力攻击：

```
 private static string MsmqMsgBodyWtf(Message recalcitrantMsmqMessage, bool showHex = false, bool showChars = false)
    {
        recalcitrantMsmqMessage.Formatter = new ActiveXMessageFormatter();
        byte[] bytes = (byte[])recalcitrantMsmqMessage.Formatter.Read(recalcitrantMsmqMessage);
        StringBuilder dottedHex = new StringBuilder();
        StringBuilder dottedAscii = new StringBuilder();
        StringBuilder plainAscii = new StringBuilder();

        for (int i = 0; i < bytes.Length; i++)
        {
            byte b = bytes[i];

            string hexString;
            hexString = String.Format("{0:x2}", b);
            dottedHex.Append(hexString + ".");

            string charString = byte2char(b);
            string escapedCharString = (b > 31 && b < 128) ? charString : "?";
            dottedAscii.Append(escapedCharString + " .");
            plainAscii.Append(escapedCharString);
        }

        StringBuilder composedOutput = new StringBuilder(plainAscii.ToString());
        if (showHex || showChars) composedOutput.Append(System.Environment.NewLine);
        if (showHex) composedOutput.AppendLine(dottedHex.ToString());
        if (showChars) composedOutput.AppendLine(dottedAscii.ToString());

        return composedOutput.ToString(); ;
    } 
```

现在我可以将消息转储到某个地方并使用其他工具对其进行分析。伊皮！

# html - 随着内部 div 的扩展，使 HTML 列更宽

> ID：269761
> 
> 赞同：0
> 
> 时间：2008-11-06T18:27:46.493
> 
> 标签：html, css, html-table

请考虑以下几点：

```
<td style="width: 500px;">
    <div style="width: 400px;">SomeContent</div>
</td> 
```

出于某种原因，包含 div 的列不会像样式建议的那样扩展到 500px。

你知道如何让 td 遵守我在样式中指定的宽度吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T18:31:02.100

理论上，您可以使用 min-width 和 max-width 样式。实际上，一些流行的浏览器会忽略这些样式。在这种情况下，您已明确声明宽度为 400，因此它应该始终等于 400，除非孩子正在成长或父母正在收缩。您可以运行-“服务器”并根据内容大小以编程方式确定宽度属性，或者您可以使用溢出样式，或者将其放在具有水平滚动条的面板中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T18:36:01.093

桌子上有宽度和桌子内的其他 tds 吗？另外，你有一个文档类型吗？

但是，也就是说，这是您的解决方案：

```
<td style="width: 500px">
  <div style="padding: 0 50px">SomeContent</div>
</td> 
```

适当地设置您的填充。

* * *

重读您的问题后，我觉得这可能不是您正在寻找的答案。你能详细说明一下吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:37:13.823

试试这个：

```
<td style="width:500px;">
  <div style="width:100%;">SomeContent</div>
</td> 
```

但是，如果您希望 td 是 div 的确切大小，最大为 500px，然后尝试：

```
<td style="max-width:500px;">
  <div style="width:100%;">SomeContent</div>
</td> 
```

请记住，IE6 不理解最大宽度，只会强制它为 500 像素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T17:05:04.303

您没有理由在 TD 内的 DIV 上设置固定宽度，默认情况下 DIV 是块元素，这意味着它们将填充包含元素的整个宽度。

在 TD 上设置填充或在 DIV 上设置边距以实现相同的样式。

如果没有看到更多标记或 css，我看不出 TD 不是 500px 的任何原因，如果您向元素添加两种不同的背景颜色，您确实会注意到 TD 将比 div 宽 100px。

# caching - 有人尝试过使用 ZooKeeper 吗？

> ID：269766
> 
> 赞同：6
> 
> 时间：2008-11-06T18:29:04.367
> 
> 标签：caching, memcached, apache-zookeeper

我目前正在研究 memcached 作为协调一组服务器的方式，但在此过程中遇到了[Apache 的 ZooKeeper](http://hadoop.apache.org/zookeeper/)。它看起来很有趣，雅虎使用它，所以应该不错，但我以前从未听说过它，所以我有点怀疑。有其他人尝试过吗？有什么意见或想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T18:58:32.077

ZooKeeper 和 Memcached 有不同的用途。您可以使用 memcached 进行服务器协调，但您必须自己完成大部分工作。Memcached 仅允许协调，因为它缓存了供多个客户端使用的公共数据查找。通过阅读 ZooKeeper 的文档，它的关注点比这要广泛得多。ZooKeeper 似乎提供了对服务器集群的支持，这与 memcached 提供的缓存集群不同。

看看 Brad Fitzpatrick 的关于 memcached 的 Linux Journal[文章](http://www.linuxjournal.com/article/7559)，可以更好地理解我的意思。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-07-22T13:17:34.800

要了解 Zookeper 的功能，请观看其创建者的以下演示。它有更多的功能（创建队列、在一组对等节点中选举主进程、分布式高性能运行时配置、分离进程的集合点、确定进程是否仍在运行等）。

[http://zookeeper.sourceforge.net/index.sf.shtml](http://zookeeper.sourceforge.net/index.sf.shtml)

要回答您的问题，如果您正在寻找“协调”，Zookeeper 比 memcached 更有针对性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T01:52:51.943

Zookeeper 非常适合跨服务器协调数据。它可以很好地对每笔交易进行排序并保证交易按顺序进行。但是，当第一次闯入它时，文档很烂；这是非常“高级”的，没有足够的具体示例或解释来说明如何正确处理某些事件。包含的示例之一（从 3.3.3 版开始）有它自己的错误。

您的代码还需要了解事件驱动的交互和轮询交互。使用大规模分布式架构，在对“事件”采取行动时，您可能会无意中造成环境不合需要的踩踏事件（羊群效应）。

# apache-flex - 组合框中显示项目的 Flex 自定义项目渲染器

> ID：269773
> 
> 赞同：8
> 
> 时间：2008-11-06T18:30:10.620
> 
> 标签：apache-flex, actionscript-3, combobox, mxml, itemrenderer

我在组合框中使用自定义项目渲染器来显示自定义绘图而不是默认文本标签。

这适用于下拉列表，但显示的项目（当列表关闭时）仍然是我的对象的文本表示。

有没有办法让显示的项目以与下拉列表中相同的方式呈现？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-11T13:23:46.450

默认情况下，您不能这样做。但是，如果您扩展 ComboBox，您可以轻松添加此功能。这是一个简单的示例，它是一个粗略的版本，可能需要测试/调整，但它显示了您如何完成此操作。

```
package
{
    import mx.controls.ComboBox;
    import mx.core.UIComponent;

    public class ComboBox2 extends ComboBox
    {
        public function ComboBox2()
        {
            super();
        }

        protected var textInputReplacement:UIComponent;

        override protected function createChildren():void {
            super.createChildren();

            if ( !textInputReplacement ) {
                if ( itemRenderer != null ) {
                    //remove the default textInput
                    removeChild(textInput);

                    //create a new itemRenderer to use in place of the text input
                    textInputReplacement = itemRenderer.newInstance();
                    addChild(textInputReplacement);
                }
            }
        }

        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void {
            super.updateDisplayList(unscaledWidth, unscaledHeight);

            if ( textInputReplacement ) {
                textInputReplacement.width = unscaledWidth;
                textInputReplacement.height = unscaledHeight;
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-11-23T09:42:49.020

上面的解决方法我试过了，但是发现关闭combobox的时候selectedItem没有显示出来。需要一行额外的代码将 itemRenderer 数据属性绑定到 selectedItem：

```
 if ( !textInputReplacement ) {
                    if ( itemRenderer != null ) {
                            //remove the default textInput
                            removeChild(textInput);

                            //create a new itemRenderer to use in place of the text input
                            textInputReplacement = itemRenderer.newInstance();

                            // ADD THIS BINDING:
                            // Bind the data of the textInputReplacement to the selected item
                            BindingUtils.bindProperty(textInputReplacement, "data", this, "selectedItem", true);

                            addChild(textInputReplacement);
                    }
            } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-26T16:15:59.683

我进一步扩展了 Dane 的代码。在某些情况下，单击并没有用我的渲染器打开下拉框，我注意到正常的 Flex ComboBox 皮肤没有触发。因此，在*replaceTextInput()*中，我添加了一些额外的事件侦听器，并保存了对用于显示皮肤的 ComboBox 按钮的引用。现在它的行为就像普通的 ComboBox 一样。

这是代码：

```
    包裹
    {
    导入 flash.events.Event；
    导入 flash.events.KeyboardEvent；
    导入 flash.events.MouseEvent；

    导入 mx.binding.utils.BindingUtils；
    导入 mx.controls.Button；
    导入 mx.controls.ComboBox；
    导入 mx.core.IFactory；
    导入 mx.core.UIComponent；
    导入 mx.events.DropdownEvent；

    /**
     * 标准组合框的扩展，将使用分配的“itemRenderer”
     * 用于列表项和选定项。
     *
     * 基于以下代码：
     * http://stackoverflow.com/questions/269773/flex-custom-item-renderer-for-the-displayed-item-in-the-combobox
     */
    公共类 ComboBoxFullRenderer 扩展 ComboBox
    {
    受保护的 var textInputReplacement:UIComponent;
    私人 var _increaseW:Number = 0;
    私有变量 _increaseH:Number = 0;

    /**
     * 跟踪下拉列表的当前打开/关闭状态。
     */
    受保护的 var _isOpen:Boolean = false;

    /**
     * 存储对覆盖组合框的“按钮”的引用。允许
     * 我们将事件传递给它，以便正确触发皮肤。
     */
    受保护的 var _buttonRef:Button = null;

    /**
     * 构造函数。
     */
    公共函数 ComboBoxFullRenderer() {
        极好的（）;
    }

    /**
     * 设置一个值来增加我们的 ComboBox 的宽度以调整大小。
     *
     * @param val 增加组合框宽度的像素数。
     */
    公共函数集增加W(val:Number):void {
        _increaseW = val;
    }

    /**
     * 设置一个值来增加我们的 ComboBox 的高度来调整大小。
     *
     * @param val 增加组合框高度的像素数。
     */
    公共函数集增加H(val:Number):void {
        _increaseH = 值；
    }

    /**
     * 覆盖 'itemRenderer' 设置器，这样我们也可以替换选定的
     * 项目渲染器。
     *  
     * @param value 用于显示下拉列表项的渲染器
     * 和所选项目。
     */
    覆盖公共函数集 itemRenderer(value:IFactory):void {
        super.itemRenderer = 值；
        替换文本输入（）；
    }

    /**
     * 覆盖基本的 'createChildren()' 例程来调用我们的 'replaceTextInput()'
     * 替换标准选定项渲染器的方法。
     *  
     * @see #replaceTextInput();
     */
    覆盖受保护的函数 createChildren():void {
        super.createChildren();
        替换文本输入（）；
    }

    /**
     * 用我们自己的孩子替换 ComboBox 'textInput' 孩子的例程
     * 这将呈现选定的数据元素。将创建一个实例
     * 为这个 ComboBox 设置的 'itemRenderer'。
     */
    受保护的函数replaceTextInput():void {
        如果（！textInputReplacement）{
            if ( this.itemRenderer != null && textInput != null ) {
                //删除默认的文本输入
                removeChild(textInput);

                //创建一个新的 itemRenderer 实例来代替文本输入
                textInputReplacement = this.itemRenderer.newInstance();
                // 监听点击，以便我们可以在何时打开/关闭下拉菜单
                // 渲染器组件被点击。  
                textInputReplacement.addEventListener(MouseEvent.CLICK, _onClick);
                // 在我们的渲染器上监听鼠标事件，以便我们可以将它们提供给
                // ComboBox 覆盖按钮。这将确保按钮皮肤
                // 被激活。请参阅 ComboBox::commitProperties() 代码。
                textInputReplacement.addEventListener(MouseEvent.MOUSE_DOWN, _onMouseEvent);
                textInputReplacement.addEventListener(MouseEvent.MOUSE_UP, _onMouseEvent);
                textInputReplacement.addEventListener(MouseEvent.ROLL_OVER, _onMouseEvent);
                textInputReplacement.addEventListener(MouseEvent.ROLL_OUT, _onMouseEvent);
                textInputReplacement.addEventListener(KeyboardEvent.KEY_DOWN, _onMouseEvent);

                // 将 textInputReplacement 的数据绑定到选中项
                BindingUtils.bindProperty(textInputReplacement, "data", this, "selectedItem", true);

                // 将我们的渲染器添加为子级。
                addChild(textInputReplacement);

                // 监听打开关闭，这样我们就可以保持状态。这
                // 'isShowingDropdown' 属性是 mx_internal 所以我们不
                // 可以访问它。
                this.addEventListener(DropdownEvent.OPEN, _onOpen);
                this.addEventListener(DropdownEvent.CLOSE, _onClose);

                // 保存对组合框的 mx_internal 按钮的引用。
                // 我们需要这个，所以我们可以调用它的 dispatchEvent() 方法。
                for (var i:int = 0; i < this.numChildren; i++) {
                    var temp:Object = this.getChildAt(i);
                    如果（温度是按钮）{
                        _buttonRef = temp 作为按钮；
                        休息;
                    }
                }
            }
        }
    }

    /**
     * 检测下拉列表中的打开事件以跟踪当前
     * 下拉状态，以便我们可以对点击我们选择的点击做出正确反应
     * 项目渲染器。
     *  
     * @param event 组合框的 DropdownEvent.OPEN 事件。
     */
    受保护的功能_onOpen（事件：DropdownEvent）：无效{
        _isOpen = 真；
    }

    /**
     * 检测下拉列表中的关闭事件以跟踪当前
     * 下拉状态，以便我们可以对点击我们选择的点击做出正确反应
     * 项目渲染器。
     *  
     * @param event 组合框的 DropdownEvent.CLOSE 事件。
     */
    受保护的功能_onClose（事件：DropdownEvent）：无效{
        _isOpen = 假；
    }

    /**
     * 当我们检测到点击我们的渲染器打开或关闭下拉列表
     * 基于下拉菜单当前是否打开/关闭。
     *  
     * @param event 来自我们选择的项目渲染器的 CLICK 事件。
     */
    受保护的功能_onClick（事件：MouseEvent）：无效{
        如果（_isOpen）{
            this.close(事件);
        } 别的 {
            this.open();
        }
    }

    /**
     * 对我们选定的项目渲染器上的某些鼠标/键盘事件做出反应，并
     * 将事件传递给 ComboBox 'button' 以便皮肤正确
     * 应用。
     *  
     * @param event 要发送到 ComboBox 按钮的鼠标或键盘事件。
     *
     */
    受保护的功能_onMouseEvent（事件：事件）：无效{
        if (_buttonRef != null) {
            _buttonRef.dispatchEvent(event);
        }
    }
    } // 结束类
    } // 结束包

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-15T09:26:49.110

谢谢 maclema 和 Maurits de Boer。我在这个类中添加了一些东西来满足我的需要：

*   我覆盖了 set itemRenderer，因此如果您通过 AS 而不是 mxml 设置 itemRenderer，这将起作用。我将文本输入替换代码移到了它自己的函数中以避免重复。

*   我为“increaseW”和“increaseH”添加了设置器，以便在必要时调整组合框的大小，因为我的渲染器起初对于组合框来说太大了。

*   我从 textInputReplacement 宽度中减去了 25，因此它不会与下拉按钮重叠……使用更成比例的东西来适应不同的皮肤等可能会更好。

代码：

```
package
{
 import mx.binding.utils.BindingUtils;
 import mx.controls.ComboBox;
 import mx.core.IFactory;
 import mx.core.UIComponent;

    public class ComboBox2 extends ComboBox
    {
        public function ComboBox2()
        {
                super();
        }

        protected var textInputReplacement:UIComponent;
        private var _increaseW:Number = 0;
        private var _increaseH:Number = 0;

  public function set increaseW(val:Number):void
  {
   _increaseW = val;
  }

  public function set increaseH(val:Number):void
  {
   _increaseH = val;
  }

  override public function set itemRenderer(value:IFactory):void
  {
   super.itemRenderer = value;
   replaceTextInput();
  }

        override protected function createChildren():void 
        {
                super.createChildren();
    replaceTextInput();

        }

        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void {

          unscaledWidth += _increaseW;
          unscaledHeight += _increaseH;

                super.updateDisplayList(unscaledWidth, unscaledHeight);

                if ( textInputReplacement ) {
                        textInputReplacement.width = unscaledWidth - 25;
                        textInputReplacement.height = unscaledHeight;
                }
        }

        protected function replaceTextInput():void
        {
         if ( !textInputReplacement ) {
                        if ( this.itemRenderer != null ) {
                                //remove the default textInput
                                removeChild(textInput);

                                //create a new itemRenderer to use in place of the text input
                                textInputReplacement = this.itemRenderer.newInstance();
                                addChild(textInputReplacement);

                                // ADD THIS BINDING:
                             // Bind the data of the textInputReplacement to the selected item
                             BindingUtils.bindProperty(textInputReplacement, "data", this, "selectedItem", true);

                             addChild(textInputReplacement);

                        }
                }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-12T18:13:17.027

我正在寻找一种使用 Spark ComboBox 的方法。

这个线程对我非常有用，但到目前为止，只有关于如何使用 mx:ComboBox 的答案。我认为我应该附加关于如何使用 spark ComboBox 的答案。

1.  创建 ComboBox 的新皮肤
2.  隐藏和禁用 textInput
3.  插入自己的组件

这是皮肤的样子：

```
<s:SparkSkin>

    <... Lots of other stuff/>

    <s:BorderContainer height="25">
        <WHATEVER YOU NEED HERE!/>
    </s:BorderContainer>

    <!-- Disable the textInput and hide it -->
    <s:TextInput id="textInput"
        left="0" right="18" top="0" bottom="0" 
        skinClass="spark.skins.spark.ComboBoxTextInputSkin"

        visible="false" enabled="false"/> 

</s:SparkSkin> 
```

使用 Spark ComboBox，此过程非常简单，不需要您扩展 ComboBox。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-09-10T20:53:18.840

我找到了一种更简单的方法来更改所选元素的渲染器。`TextInput`仅当您的元素从Flex 4.0 或更高版本中的类继承时，此选项才有效。

在 Flex v4.5 中，`ComboBase.createChildren`在第 1177 行，您会发现可以为 定义的类`textInput`可以使用样式键传递`textInputClass`：

```
// Mechanism to use MXFTETextInput. 
var textInputClass:Class = getStyle("textInputClass");            
if (!textInputClass || FlexVersion.compatibilityVersion < FlexVersion.VERSION_4_0)
{
    textInput = new TextInput();
}
else
{
   textInput = new textInputClass();
} 
```

只需在组合的构造函数中更改此键的值，现在您就拥有了自己的`selectedItem`.

```
public function ComboAvailableProfessor()
{
    super();

    itemRenderer = new ClassFactory( ProfessorAvailableListItemRenderer );
    setStyle( 'textInputClass', ProfessorAvailableSelectedListItemRenderer );
} 
```

最后，您必须将属性绑定`data`到`selectedItem`组合中的属性才能显示数据。

```
override protected function createChildren():void
{
    super.createChildren();

    BindingUtils.bindProperty( textInput, 'data', this, 'selectedItem', true );
} 
```

# msmq - 在批处理文件中取消登记 BizTalk MSMQ 发送端口

> ID：269774
> 
> 赞同：1
> 
> 时间：2008-11-06T18:30:25.003
> 
> 标签：msmq, biztalk, port, send

我有一个解决方案，我使用批处理文件设置/清理...... - 有一对 MSMQ 端口，发送和接收，队列末尾有另一个应用程序

我发现我无法正确停止批处理文件中的编排...错误是发送端口未登记-我正在使用 SDK 示例中的 StopOrch.vbs 脚本

但我可以进入 BizTalk 管理控制台并使用 Full Terminate Ok 手动停止编排

如果我实际上没有将任何消息推送到 MSMQ 队列中，则设置/清理工作正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-27T00:00:13.807

史蒂夫，

我会考虑使用 powershell 脚本来处理终止所有挂起的消息，并以正确的方式关闭编排。如果您搜索，我相信在 codeplex 上有一组这些脚本。还要查看复杂的 SDC MSBuilt 组件以执行此操作。

-布莱恩

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-06T20:24:24.473

您还可以查看 Microsoft.BizTalk.ExplorerOM.dll。它包含在 .NET 代码中可以很好地与之交互的业务级对象。您可以在安装目录中找到dll，我的位于：*C:\Program Files (x86)\Microsoft BizTalk Server 2009\Developer Tools*

这是关于它的 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/microsoft.biztalk.explorerom (BTS.20).aspx](http://msdn.microsoft.com/en-us/library/microsoft.biztalk.explorerom(BTS.20).aspx)

并对其使用进行了良好的高级演练：http: [//geekswithblogs.net/claeyskurt/archive/2008/10/13/125815.aspx](http://geekswithblogs.net/claeyskurt/archive/2008/10/13/125815.aspx)

# sharepoint - Sharepoint：如何部署自定义身份验证提供程序？

> ID：269775
> 
> 赞同：3
> 
> 时间：2008-11-06T18:30:53.023
> 
> 标签：sharepoint, authentication

如何在 MOSS 2007 中部署自定义身份验证提供程序？

是否有任何提供的功能可以做到这一点（如 Sharepoint 功能）？

还是我必须手动将它安装在场中每个盒子的 GAC 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T19:22:04.353

像这样安装扩展的常用方法是使用一个特性，是的。但是，您不会使用任何专门的 XML，因为这种扩展并未明确提供。那么你怎么能做到呢？通过使用包含事件接收器程序集的本质上为空的功能项目。事件接收器程序集由 sharepoint 自动调用 4 个不同的事件：安装、卸载、激活和停用。我建议您挂钩安装和卸载事件以部署您的提供程序。

[http://msdn.microsoft.com/en-us/library/bb862634.aspx](http://msdn.microsoft.com/en-us/library/bb862634.aspx)

有道理？

-Oisin

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-07T20:58:50.230

您可以使用代码访问安全性 (CAS) 在 SharePoint 2007 的最低信任下部署自定义成员资格提供程序。

尽管作者似乎不建议使用 GAC，因为某些 Sharepoint 安装在托管环境中，您可以使用 GAC。

> 在全局程序集缓存中安装成员资格提供程序 DLL 以获得完全信任通常更容易，但如果您正在使用托管的 SharePoint 网站并且无法部署到 GAC，这些说明应该会引导您正确。

详细的文章在[这里](http://robgarrett.com/cs/blogs/software/archive/2006/06/01/custom-membership-provider-under-minimal-trust-in-sharepoint-2007.aspx)。我希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-17T21:49:46.027

Sharepoint 社区工具包的[Windows Live 身份验证](http://www.codeplex.com/Release/ProjectReleases.aspx?ProjectName=CKS&ReleaseId=7746)功能提供了一个很好的示例（带有源代码），用于使用自定义身份验证提供程序创建解决方案包。解决方案包可以部署到场中的所有服务器，而无需手动接触它们

# .net - VB日期转换

> ID：269781
> 
> 赞同：2
> 
> 时间：2008-11-06T18:32:22.770
> 
> 标签：.net, vb.net, string, .net-2.0, date

有没有一种简单的方法来转换包含以下内容的字符串：

```
Date: Wed, 5 Nov 2008 13:12:12 -0500 (EST) 
```

成一个包含这个的字符串：

```
20081105_131212 
```

**更新：**
我最终使用了类似于 tryParseExact 的 date.tryparse，除了您不必指定格式字符串。我确实必须消除 () 和 EST 才能使其正常工作。日期字符串将始终为 EST，因为日期字符串来自 1 个 Web 服务器。

原始字符串：

```
Date: Wed, 5 Nov 2008 13:12:12 -0500 (EST) 
```

使用此代码：

```
buff1.Remove(0, 6).Replace("(", "").Replace(")", "").Replace("EST", "").Trim() 
```

变成这个字符串：

```
Wed, 5 Nov 2008 13:12:12 -0500 
```

然后我可以使用以下格式适当地生成我的文件名日期：

```
 If Date.TryParse(buff1, dateValue) Then
   MsgBox(Format(dateValue, "yyyyMMdd_HHmmss"))
 Else
   MsgBox("nope")
 End If 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T19:14:40.780

甚至比`Date.Parse`在这种情况下更好`Date.TryParseExact()`。这将让您告诉框架您期望的格式并返回布尔值，而不是在解析失败时抛出异常。

然后用于`.ToString("yyyyMMdd_HHmmss")`获取所需的新字符串格式。

这是格式字符串参考，以备不时之需：http:
[//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

最后，我注意到您忽略了 -500 时区偏移量。你确定你所有的字符串真的来自同一个时区吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T19:04:47.633

如果 VB 你的意思是 VB.NET 你可以使用`Date.Parse`后跟`ToString()`一个格式字符串：

```
Date.Parse(YourDateString).ToString("yyyyMMdd_HHmmss") 
```

注意：在解析字符串之前删除初始的“日期：”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T19:28:46.773

对于纯 VB 解决方案，我会去

```
Function ConvertDateString(ByVal Original As String) As String
    Dim Elements As String() = Split(Original, " ")
    Dim DateString As String = Elements(3) & " " & Elements(2) & " " & Elements(4) & " " & Elements(5)
    Return Date.Parse(DateString).ToString("yyyyMMdd_HHmmsss")
End Function 
```

您可以通过仅使用 Parase 中的连接字符串来消除 DateString。如果您的分辨率为 1024 x 768 或更大，它将适合一行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T18:48:49.100

`Format(date, "yyyyMMdd_HHmmss")`

[有关格式](http://msdn.microsoft.com/en-us/library/59bz1f0h(VS.71).aspx)功能的更多帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T19:22:36.427

就像@splattne 在 VB.NET 中的解决方案一样，但也进行了清理......

```
Dim strDateVal As String = "Date: Wed, 5 Nov 2008 13:12:12 -0500 (EST)"
strDateVal = strDateVal.Substring(strDateVal.IndexOf(", ") + 2, strDateVal.Length - strDateVal.IndexOf(", ") - 2)
strDateVal = strDateVal.Substring(0, strDateVal.LastIndexOf(" ")).TrimEnd
Dim DateVal As Date = Date.Parse(strDateVal)
Dim NewStringVal As String = Format(DateVal, "yyyyMMdd_HHmmss") 
```

注意：这会忽略时区以匹配您的预期结果（根据问题中的示例数据）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-26T11:09:31.413

```
Dim strDateVal As String = "Date: Wed, 5 Nov 2008 13:12:12 -0500 (EST)"

strDateVal = strDateVal.Substring(strDateVal.IndexOf(", ") + 2, 
strDateVal.Length - strDateVal.IndexOf(", ") - 2)

strDateVal = strDateVal.Substring(0, strDateVal.LastIndexOf(" ")).TrimEnd

Dim DateVal As Date = Date.Parse(strDateVal)
Dim NewStringVal As String = Format(DateVal, "ddMMyyyy_HHmmss") 
```

# wpf - WPF UserControl - 无法选择文本框

> ID：269782
> 
> 赞同：1
> 
> 时间：2008-11-06T18:32:34.907
> 
> 标签：wpf, xaml, user-controls

我有一个非常简单的 WPF UserControl：

```
<UserControl x:Class="dr.SitecoreCompare.WPF.ConnectionEntry"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
x:Name="connEntry" 
BorderBrush="Navy" BorderThickness="1" Margin="5,0,0,5" >
<StackPanel Margin="0,10,0,0" >
    <Label FontWeight="ExtraBold" Content="{Binding ElementName=connEntry, Path=Title}"></Label>
    <Label Margin="0,5,0,0">Server:</Label>
    <TextBox x:Name="txtServer" TabIndex="1" Text="{Binding Path=ServerName}" ></TextBox>
    <Label>Database:</Label>
    <TextBox x:Name="txtDatabase" TabIndex="2" Text="{Binding Path=DatabaseName}"></TextBox>
</StackPanel> 
```

这在同一个窗口中使用了两次。现在，我可以在我的 UserControl 的两个实例上选择第一个 TextBox，但无法选择第二个（“txtDatabase”）文本框，无论是通过 Tab 还是单击。为什么是这样 ？关于创建 WPF 用户控件，我是否遗漏了什么？

编辑： DatabaseName 不是只读的，它是一个简单的属性。放置用户控件的窗口的 XAML 如下所示：

```
<Window x:Class="dr.SitecoreCompare.WPF.ProjectDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:dr.SitecoreCompare.WPF"       
    Title="Choose project" Height="280" Width="500" 
    WindowStartupLocation="CenterOwner" WindowStyle="SingleBorderWindow" HorizontalAlignment="Center" ShowInTaskbar="False" ShowActivated="True" ResizeMode="NoResize" VerticalContentAlignment="Top" VerticalAlignment="Center">
    <StackPanel>
        <Label>Choose databases</Label>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <c:ConnectionEntry Grid.Column="0" x:Name="connMaster" Title="Master:" Padding="5" />
            <c:ConnectionEntry Grid.Column="1" x:Name="connSlave"  Title="Slave:"  Padding="5" />
        </Grid>
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0" >
            <Button x:Name="btnCancel" Click="btnCancel_Click">Cancel</Button>
            <Button x:Name="btnOK" Click="btnOK_Click">OK</Button>
        </StackPanel>
    </StackPanel>

</Window> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-11T05:24:57.243

在绑定中尝试 Mode=TwoWay。我已经看到了初始化设置值而控件无法设置值的情况。

```
<TextBox x:Name="txtDatabase" TabIndex="2" Text="{Binding Path=DatabaseName, Mode=TwoWay}"></TextBox> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T18:42:31.063

这在 XamlPad 中有效，所以我认为您发布的代码之外有一些东西会导致问题。DatabaseName 是只读的吗？

# c++ - 无法在成员初始化列表中初始化对象

> ID：269794
> 
> 赞同：1
> 
> 时间：2008-11-06T18:36:50.403
> 
> 标签：c++, mfc

我有这个代码：

```
CCalcArchive::CCalcArchive() : m_calcMap()
{
} 
```

`m_calcMap`定义为：

```
typedef CTypedPtrMap<CMapStringToPtr, CString, CCalculation*> CCalcMap;
CCalcMap& m_calcMap; 
```

在 Visual Studio 2008 中编译时，出现以下错误：

```
error C2440: 'initializing' : cannot convert from 'int' to 'CCalcArchive::CCalcMap &' 
```

我什至不明白它从哪里得到“int”错误，为什么这不起作用？感觉就像我实际上遇到了某种语法错误，但这不是应该如何使用成员初始化列表吗？此外，AFAIK，MFC 类`CTypedPtrMap`没有带参数的构造函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-06T18:42:04.310

我不确定它的`int`来源，但您**必须**初始化初始化程序列表中的所有引用。 `m_calcMap`被声明为引用，因此它必须被初始化以引用对象的某个实例`CCalcMap`——你不能让它未初始化。如果您无法将引用的对象传递给构造函数，或者您可能需要它不引用对象，则使用指针而不是引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T18:41:55.510

除非我遗漏了什么，因为它是一个参考，它需要被初始化以指向某些东西。根据定义，引用变量不能初始化为 NULL。

至于int，我不知道为什么这么说。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T20:37:38.553

这`int`是因为`CTypedPtrMap`有一个构造函数，该构造函数接受一个`int`默认为 10 的参数。

您遇到的真正问题是您的`m_calcMap`引用初始化试图默认构造一个临时`CTypedPtrMap`对象来绑定引用。但是，只有`const`引用可以绑定到临时对象。毫无疑问，错误消息的信息量不是很大。

但即使该`m_calcMap`成员是一个`const`引用，您仍然会遇到将其绑定到临时的问题。在这种情况下，MSVC 2008 编译器给出了一个非常明确的警告：

```
mfctest.cpp(72) : warning C4413: '' : reference member is initialized to a temporary 
                                       that doesn't persist after the constructor exits 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T18:47:30.117

这是 C++ 编译器的常见 MO，当他们无法弄清楚类型是什么时，吐出错误消息并假设用户的意思是“int”以便能够继续（......并生成更多错误消息;-)

不过，您确实需要在构造函数中初始化类中的所有引用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-07T08:00:44.260

啊，是的，我的想法是我打算在初始化列表中运行它的构造函数，从而始终构造对象。在特别是 Mike B 的回复之后，现在变得更加清楚，现在完全可以理解构造的对象在超出范围后会立即被破坏。这是我从来没有首先考虑的。:SI 认为引用可以，以及使用对现有对象的引用对其进行初始化。

# python - 如何找到 Python 模块源的位置？

> ID：269795
> 
> 赞同：550
> 
> 时间：2008-11-06T18:36:52.887
> 
> 标签：python, module

如何了解给定 Python 模块的源文件的安装位置？Windows 上的方法与 Linux 上的方法不同吗？

我正在尝试特别寻找`datetime`模块的来源，但我也对更一般的答案感兴趣。

* * *

## 回答 #1

> 赞同：421
> 
> 时间：2008-11-06T18:45:33.897

对于纯 python 模块，您可以通过查看`themodule.__file__`. 然而，datetime 模块是用 C 编写的，因此`datetime.__file__`指向一个 .so 文件（`datetime.__file__`在 Windows 上没有），因此您看不到源代码。

如果您下载 python 源代码并解压，模块的代码可以在**Modules**子目录中找到。

例如，如果您想查找 python 2.6 的日期时间代码，您可以查看

```
Python-2.6/Modules/datetimemodule.c 
```

您还可以在 [https://hg.python.org/cpython/file/tip/Modules/_datetimemodule.c上找到最新的 Mercurial 版本](https://hg.python.org/cpython/file/tip/Modules/_datetimemodule.c)

* * *

## 回答 #2

> 赞同：243
> 
> 时间：2008-11-06T18:40:27.107

`python -v`从命令行运行应该会告诉您正在导入什么以及从哪里导入。这适用于我在 Windows 和 Mac OS X 上。

```
C:\>python -v
# installing zipimport hook
import zipimport # builtin
# installed zipimport hook
# C:\Python24\lib\site.pyc has bad mtime
import site # from C:\Python24\lib\site.py
# wrote C:\Python24\lib\site.pyc
# C:\Python24\lib\os.pyc has bad mtime
import os # from C:\Python24\lib\os.py
# wrote C:\Python24\lib\os.pyc
import nt # builtin
# C:\Python24\lib\ntpath.pyc has bad mtime
... 
```

我不确定我安装的那些糟糕的 mtime 是什么！

* * *

## 回答 #3

> 赞同：137
> 
> 时间：2012-12-15T00:31:15.427

我意识到这个答案晚了 4 年，但现有的答案会误导人们。

做到这一点的正确方法是 never `__file__`，或者尝试遍历`sys.path`并搜索自己等（除非您需要向后兼容 2.1 之后的版本）。

它是[`inspect`](http://docs.python.org/library/inspect.html)模块——特别是，`getfile`或`getsourcefile`.

除非您想学习和实现映射`.pyc`到`.py`文件的规则（对于 CPython 2.x，这些规则已记录，但很痛苦，而对于其他实现或 3.x 则根本没有记录）；处理 .zip 档案、egg 和模块包；尝试不同的方法来获取不支持的`.so`/文件的路径；弄清楚 Jython/IronPython/PyPy 做了什么；等在这​​种情况下，去吧。`.pyd``__file__`

同时，从 2.0+ 开始的每个 Python 版本的源代码都可以在线获得`http://hg.python.org/cpython/file/X.Y/`（例如[2.7](http://hg.python.org/cpython/file/2.7/)或[3.3](http://hg.python.org/cpython/file/3.3/)）。所以，一旦你发现它`inspect.getfile(datetime)`是一个`.so`或`.pyd`类似的文件`/usr/local/lib/python2.7/lib-dynload/datetime.so`，你就可以在 Modules 目录中查找它。严格来说，没有办法确定哪个文件定义了哪个模块，但几乎所有文件都是`foo.c`or `foomodule.c`，所以不难猜到[datetimemodule.c](http://hg.python.org/cpython/file/2.7/Modules/datetimemodule.c)就是你想要的。

* * *

## 回答 #4

> 赞同：95
> 
> 时间：2015-09-25T14:27:58.437

如果您使用 pip 安装模块，则只`pip show $module`返回位置。

* * *

## 回答 #5

> 赞同：78
> 
> 时间：2008-11-06T18:39:52.880

该`sys.path`列表包含将在运行时搜索模块的目录列表：

```
python -v
>>> import sys
>>> sys.path
['', '/usr/local/lib/python25.zip', '/usr/local/lib/python2.5', ... ] 
```

* * *

## 回答 #6

> 赞同：43
> 
> 时间：2013-05-04T02:40:30.887

从标准库尝试[imp.find_module](http://docs.python.org/2/library/imp.html#imp.find_module)

```
>>> import imp
>>> imp.find_module('fontTools')
(None, 'C:\\Python27\\lib\\site-packages\\FontTools\\fontTools', ('', '', 5))
>>> imp.find_module('datetime')
(None, 'datetime', ('', '', 6)) 
```

* * *

## 回答 #7

> 赞同：40
> 
> 时间：2008-11-06T18:41:56.853

`datetime`是一个内置模块，所以没有（Python）源文件。

对于来自`.py`（或`.pyc`）文件的模块，您可以使用`mymodule.__file__`，例如

```
> import random
> random.__file__
'C:\\Python25\\lib\\random.pyc' 
```

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2013-03-04T21:35:24.243

这是获取模块文件名的单行代码，适用于 shell 别名：

```
echo 'import sys; t=__import__(sys.argv[1],fromlist=[\".\"]); print(t.__file__)'  | python - 
```

设置为别名：

```
alias getpmpath="echo 'import sys; t=__import__(sys.argv[1],fromlist=[\".\"]); print(t.__file__)'  | python - " 
```

要使用：

```
$ getpmpath twisted
/usr/lib64/python2.6/site-packages/twisted/__init__.pyc
$ getpmpath twisted.web
/usr/lib64/python2.6/site-packages/twisted/web/__init__.pyc 
```

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2011-04-21T06:39:13.180

在 python 解释器中，您可以导入特定模块，然后键入 help(module)。这提供了详细信息，例如名称、文件、模块文档、描述等。

前任：

```
import os

help(os)

Help on module os:

NAME

os - OS routines for Mac, NT, or Posix depending on what system we're on.

FILE

/usr/lib/python2.6/os.py

MODULE DOCS

http://docs.python.org/library/os

DESCRIPTION

This exports:

- all functions from posix, nt, os2, or ce, e.g. unlink, stat, etc.

- os.path is one of the modules posixpath, or ntpath

- os.name is 'posix', 'nt', 'os2', 'ce' or 'riscos' 
```

等人

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2014-06-09T10:04:36.157

在windows上可以找到python模块的位置如下图：即find rest_framework module ![在此处输入图像描述](https://i.stack.imgur.com/TsWpv.png)

* * *

## 回答 #11

> 赞同：11
> 
> 时间：2011-02-23T10:56:12.723

Python 3.2 中的新功能，您现在可以使用`code_info()`dis 模块中的示例：http: [//docs.python.org/dev/whatsnew/3.2.html#dis](http://docs.python.org/dev/whatsnew/3.2.html#dis)

* * *

## 回答 #12

> 赞同：10
> 
> 时间：2010-04-27T17:22:07.900

查看这个[漂亮的“cdp”命令](http://chris-lamb.co.uk/2010/04/22/locating-source-any-python-module/)以 cd 到包含指定 Python 模块源代码的目录：

```
cdp () {
  cd "$(python -c "import os.path as _, ${1}; \
    print _.dirname(_.realpath(${1}.__file__[:-1]))"
  )"
} 
```

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2016-06-22T14:18:30.427

在 Ubuntu 12.04 上，例如 python2 的 numpy 包，可以在以下位置找到：

```
/usr/lib/python2.7/dist-packages/numpy 
```

当然，这不是通用的答案

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-04-08T07:41:23.110

从终端检查是否安装了多个 python 版本的另一种方法。

`$ python3 -m pip show pyperclip`

位置：/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-

`$ python -m pip show pyperclip`

位置：/Users/umeshvuyyuru/Library/Python/2.7/lib/python/site-packages

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-06-01T13:50:15.847

只是更新答案以防万一现在有人需要它，我在 Python 3.9 并使用 Pip 来管理包。只需使用`pip show`，例如：

```
pip show numpy 
```

它将为您提供所有详细信息以及 pip 存储所有其他包的位置。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-06T18:43:03.917

并非所有的 python 模块都是用 python 编写的。Datetime 恰好是其中之一，并且（在 linux 上）是 datetime.so。

您必须将源代码下载到 python 标准库才能使用它。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-12-01T14:00:13.047

对于那些喜欢 GUI 解决方案的人：如果您使用诸如 Spyder（Anaconda 安装的一部分）之类的 gui，您只需右键单击模块名称（例如“import csv”中的“csv”）并选择“go定义” - 这将打开文件，而且在顶部您可以看到确切的文件位置（“C:....csv.py”）

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2020-01-27T12:11:34.990

如果您不使用解释器，则可以运行以下代码：

```
import site
print (site.getsitepackages()) 
```

输出：

```
['C:\\Users\\<your username>\\AppData\\Local\\Programs\\Python\\Python37', 'C:\\Users\\<your username>\\AppData\\Local\\Programs\\Python\\Python37\\lib\\site-packages'] 
```

Array 中的第二个元素将是您的包位置。在这种情况下：

```
C:\Users\<your username>\AppData\Local\Programs\Python\Python37\lib\site-packages 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-04-06T13:43:50.710

在像 Spyder 这样的 IDE 中，导入模块，然后单独运行模块。 [在此处输入图像描述](https://i.stack.imgur.com/3cXpx.png)

# c# - 在 Visual Studio 2005 中禁用集成 Web 服务器的自动启动

> ID：269802
> 
> 赞同：2
> 
> 时间：2008-11-06T18:39:51.040
> 
> 标签：c#, asp.net, visual-studio, webserver

有没有办法在具有多个项目（阅读：Web 应用程序）的解决方案中运行项目并避免 Visual Studio 中集成的 asp.net 网络服务器的自动启动功能？

我有一个包含 Windows 窗体项目、Windows 服务项目、Web 应用程序、Windows 库等的大型解决方案，有时我只想调试桌面应用程序，但每个 Web 应用程序项目都会启动一个网络服务器，这会减慢执行过程（启动时）当然是应用程序），我希望禁用这些网络服务器，因为我没有使用/调试这些项目，但我团队中的其他一些开发人员正在使用/调试这些项目。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T18:47:06.343

在解决方案资源管理器中选择您不想自动启动的项目，并在属性窗格中将“调试时始终启动”设置为 false

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T19:26:41.130

您可以只使用您正在处理的项目创建一个新的解决方案。

# java - 如何从 Java 异常日志条目开始进行调试？

> ID：269805
> 
> 赞同：0
> 
> 时间：2008-11-06T18:40:15.763
> 
> 标签：java, debugging, exception

我一直在尝试为我正在使用的某些代码解析出现在日志中的 Java 异常。我的问题是，您是从上到下还是自下而上解析异常跟踪？它看起来像这样：

```
ERROR [main]</b> Nov/04 11:03:19,440 [localhost].[/BookmarksPortlet].[] - Exception sending context...
org.springframework.beans.factory.BeanCreationException: Error creating bean...: Cannot Resolve reference...: Error creating bean... nested exception... nested exception is org.hibernate.HibernateException: Dialect class not found: org.hibernate.dialect.Oracle10gDialect
Caused by:
... [similar exceptions and nested exceptions]
...
    at [start of stack trace] 
```

类似的东西。显然，我不是在寻找这个特定异常的答案，但是你如何解析这样的异常跟踪呢？你是从顶层错误开始，还是从最里面的错误开始（在“caused by”子句下）？

这个问题对我来说更难，因为我没有使用我编写的代码。我正在编辑 XML 配置，所以我什至没有真正查看 Java 代码。在我自己的代码中，我会识别跟踪中的位置并知道要寻找什么样的东西。那么，一般来说，你如何处理这样的异常呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T18:43:15.010

这东西有点难以解释，但我的第一步几乎总是从顶部开始向下略读，直到我看到熟悉的`com.mycompany.myproject`.

鉴于附加的行号，您可以在自己的代码中工作，这通常是一个好的开始。

**编辑：**但是，重新阅读你的问题，你说这不是你的代码..所以这可能根本不是一个有用的答案..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T18:50:03.483

在您的特定示例中，缺少一个类。一旦您看到这样的错误，您就知道需要修复什么（更正类名或更新类路径以便可以找到该类）。

不过，总的来说，我会从我的代码中查看生成的代码，直到找到错误为止。例如，如果我得到一个 NullPointerException，我会检查它是否是由我的一个类引起的。但是，如果它是一个缺失的类，我不会发现我自己的类有任何问题，所以我将从堆栈跟踪的另一端开始寻找可识别的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T21:30:31.850

在您的示例中，您似乎需要向项目的类路径中添加一些 Oracle JDBC 驱动程序或其他内容。

但本着问题的精神，我认为这取决于。在这个例子中，Spring 本身并不是很有帮助 - 创建 bean 时出错。哎呀，谢谢你的信息。但是，它会准确地告诉您为什么创建 bean 会出错。“最里面”的例外。

我已经看到其他示例，其中最内部的异常过于具体（如 NPE），而在外部，实际抛出的异常具有最有用的错误消息。它因项目而异。

# emacs - 如何快速开始使用和学习 Emacs

> ID：269812
> 
> 赞同：48
> 
> 时间：2008-11-06T18:42:24.277
> 
> 标签：emacs

使用 Emacs 有各种各样的优势，但对于熟悉常用 Win32 应用程序的人来说，它带有类似墙壁的学习曲线。对于大多数其他编辑器，您可以开始使用它们，然后随着您的使用了解它们的其他功能和增强功能。

如何直接开始使用 Emacs，以达到您实际上更喜欢使用 Emacs 而不是其他编辑器或应用程序的目的？

编辑 - 尝试澄清问题：我已经完成了教程，阅读了一些文档等。然后不久之后，当我想快速编辑一些文本时，使用另一个我已经知道的编辑器会更容易。我需要做什么才能不只是选择另一个更简单的编辑器，而且我实际上更喜欢使用 Emacs，以及如何尽快到达这里？如果有 Emacs 的辅助轮怎么办？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-11-07T06:22:25.300

[学习如何使用Emacs](http://en.wikipedia.org/wiki/Emacs)最重要的事情是……（请鼓掌）学习如何使用 Emacs。

好的，好的，好的。这是一个愚蠢的答案，这是一个重言式，但这是真的。如果您启动 Emacs，并想一想“我怎样才能在我的源代码树中找到单词 'foobar' 的每个实例？” 你能做的最糟糕的事情就是点击`Alt`+`Tab`并访问谷歌。

严重地。

了解帮助系统及其工作原理是您能做的最好的事情。只需点击 Ch 就可以找到，然后突然获得您需要的所有信息，触手可及，真是太好了。

你可以做的下一个最好的事情是安装一个很棒的小包，叫做[Icicles](http://www.emacswiki.org/emacs/Icicles)，它有一些非常时髦的完成功能。安装后，只要知道 minibuffer 要求某种输入时，您现在就可以使用正则表达式。

这将如何应用于查找源代码树中的每个文件？好吧，你可以点击 Mx，然后输入“find”。之后，您可以点击（例如）`Shift`+`Tab`并且 Icicles 会启动，找到每个以“find”为前缀的命令。或者，你可以做 Mx 。*寻找。*它会给你任何带有 find 的命令。

建立备忘单。只需将保存的缓冲区保存在其中包含您经常使用的所有键盘快捷键的地方。删除你心里知道的那些，并拿起新的。在大多数情况下，当您执行 Mx 命令时，消息缓冲区会告诉您该命令的键盘快捷键是什么（如果有的话）。

学习。键盘。宏。

学习。Emacs。[口齿不清](http://en.wikipedia.org/wiki/Lisp_%28programming_language%29)。

Steven Huwig 使用一些杀手级应用程序的想法是一个很好的想法。当您想使用 Emacs 时，它更易于使用。对我来说，这是计划者模式。（我刚搬到[Org-mode](https://en.wikipedia.org/wiki/Org-mode)，它甚至更好。）

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-11-06T18:53:22.913

*   花 20 分钟运行教程

    ctrl-h t

这将使您达到可以提高工作效率的程度（并且您将阅读到的“元”键可能是 Escape 或 alt）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-11-06T22:38:31.430

我认为找到一个或两个在 Emacs 中效果最好的“杀手级应用程序”是最容易的。对我来说，这是 Oracle 的 SQL 编辑和交互模式。一旦您已经将 Emacs 用于这个杀手级应用程序，那么在 Emacs 中打开其他文档而不是另一个编辑器会更有吸引力。

潜在杀手级应用：

*   SQL 编辑和交互模式
*   [nxml 模式](http://www.thaiopensource.com/nxml-mode/)
*   [AUCTeX](http://www.gnu.org/software/auctex/)
*   CPerl 模式（最好的 Perl 模式）
*   [PCL-CVS](http://www.cs.utah.edu/dept/old/texinfo/cvs/pcl-cvs_toc.html)
*   [粘液](http://common-lisp.net/project/slime/)
*   [js2 模式](http://code.google.com/p/js2-mode/)(Javascript)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-11-06T19:18:56.637

学习有效地使用 Emacs 本质上是一个缓慢的过程，但这是值得的。

立即设置一个 .emacs 文件。您将需要对其进行相当多的自定义。这听起来很傻，但是对该文件进行某种源代码控制也会有所帮助。

为了更容易了解 Emacs 的内部结构，请在您的 .emacs 中添加：

```
(defalias 'ap 'apropos)

```

然后，当您想查看是否有执行“某事”的命令时，键入“[Alt-x] ap [enter] something [enter]”。Emacs 有自己的东西名称，所以有时很难找到东西（“yank”？说真的？像其他人一样称它为“cut”！）

"[Ctrl-h f] function-name [enter]" 查找该函数的帮助。

“[Ctrl-h m]”向您显示有关当前模式的详细信息，例如特定于该模式的键绑定。

学习使用 Ctrl-s 和 Ctrl-r 进行增量搜索。**所有**文本编辑器都需要具备此功能。

将键绑定添加到您的 .emacs 中，例如：

```
(define-key global-map (kbd "Mz") 'redo)
(define-key global-map (kbd "Cz") 'undo)

```

获取 redo.el 包以减少 Emacs 的重做。

iswitchb 模式是无价的。它可以让您一次打开数十个缓冲区，并在眨眼间在它们之间切换。设置 iswitchb 并添加到您的 .emacs：

```
（iswitchb 模式）
(define-key global-map (kbd "M-RET") 'iswitchb-buffer)

```

要计算 emacs-lisp 表达式，请将表达式键入缓冲区，将光标放在它后面，然后键入“[Ctrl-x Ctrl-e]”。这使您可以轻松地尝试不同的自定义设置。

请记住，在键入这样的序列时，您不必松开 ctrl。

使用“occur”函数查看字符串在缓冲区中出现的位置。以下是一些方便的功能和键绑定：

```
(defun word-at-point ()
  （事物在点'字）
  )

(defun word-at-point-or-selection ()
  （如果标记激活
    (regexp-quote (buffer-substring (mark) (point)))
    （连接“\\”）
    )
  )

(defun find-word-at-point ()
  （交互的）
  （发生（word-at-point-or-selection））
  )

(define-key global-map (kbd "Co") 'find-word-at-point)

(define-key isearch-mode-map (kbd "Co")
  （拉姆达（）
    （交互的）
    (让 ((case-fold-search isearch-case-fold-search))
      （发生（如果 isearch-regexp isearch-string
               (regexp-quote isearch-string))))))

```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-06-03T18:20:47.283

我对如何加快速度的想法：

1.  找另一个 Emacs 用户，每天看几分钟
2.  让 Emacs 用户监视您（并提供反馈）
3.  查找更多 Emacs 用户并重复步骤 1&2
4.  订阅[Planet emacsen 订阅](http://planet.emacsen.org/atom.xml)，了解其他 Emacs 人员正在学习什么
5.  关注[今日推特的emacs小贴士](http://twitter.com/ecotd)
6.  尝试回答人们关于 SO的[Emacs 问题](https://stackoverflow.com/questions/tagged/emacs)

我已经使用 Emacs 超过 15 年了，我每天都通过做上面的事情来学习新的东西。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-06T21:28:50.883

就像@Claudiu 说的，就用它。只是勉强通过，让您的需求推动您的学习曲线。

最终，您将达到“足够了解危险”的地步，而不是真正掌握环境。没关系。因为在这一点上，你可能会很有效率。您将掌握基本技能和工具。

随着时间的推移，你会遇到你每天做的事情，你只是厌倦了尝试并花时间寻找“更好的方法”。通常，您的基本技能足以应付，足以使（可能未知的）时间投入到某些替代路径上是不值得的，尤其是对于稀有事物。

但是，您可能有空闲时间，或者任务可能大到足以证明深入研究是合理的。

在这些点上，您将成为 Emacs 专家而不是熟练用户。

虽然我个人不再使用 Emacs（而是依赖 IDE），但我会说，虽然 Emacs 相当复杂，但您只需要了解一小部分即可使其有用和有趣。我还要说我从来没有“对 Emacs 大喊大叫”，而我一直对我的 IDE 大喊大叫。是的，Emacs 做的比我的 IDE 做的要少，但我认真地意识到，可能值得我花时间回到它，停止尖叫。

我只是觉得 Emacs 比我的 IDE 更具“确定性”，我的 IDE 喜欢时不时地进入 lala 的土地，或者需要重新启动，或者其他什么。

我从来没有亲自崩溃过 Emacs（有人会说这意味着我使用它不够努力......）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-06T18:55:57.073

使用 emacs 进行基本文本编辑并不比使用记事本更复杂。只需像记事本一样使用它，但在浏览菜单时，请注意键盘快捷键。慢慢地你会开始收拾东西。当您想做某事但不知道如何操作时，可以从菜单下拉菜单中获得帮助，就像其他编辑器一样。

我想我建议的唯一“技巧”是在打开文件进行编辑后，尝试 ctrl-h m 拉出在该缓冲区模式下工作的键盘绑定列表。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T18:55:17.590

我的建议是：

*   学习非常基础的知识（如何键入、保存文档、打开语法突出显示，也许是复制和粘贴）。您可以在线查找如何执行这些操作（谷歌“emacs 教程”可能）
*   开始使用它。

每当您希望自己知道如何做某事时，请查看如何做。在你得到它之前，你可能需要把同样的东西看 3-4 次，但之后你就会学会它。

继续这样做。一开始它会很烦人，但你会习惯它，然后你甚至可能会喜欢使用它！

（免责声明：我个人只是使​​用另一个编辑器）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-06T22:00:12.833

打开 icomplete-mode，你会经常看到一些看起来很有用的函数。

```
(icomplete-mode t) 
```

在您的 .emacs 文件中。

Ch f 将让您查找函数的文档字符串，而 Ch v 将为变量执行相同的操作。使用 icomplete，这非常适合探索。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-10-06T13:04:03.260

1.  当您学习键盘命令等基础知识时，请制作自己的备忘单。当然找到并掠夺现有的备忘单，但一定要自己制作并将快捷键/键绑定分类到对您有意义的组。这将帮助您学习基础知识并保留记忆。

2.  旨在将 Emacs 定制为您想要的编辑器，这是使用 Emacs 的最大优势，它将帮助您了解它的所有功能以及它是如何扩展的。

3.  很高兴，相对而言，学习 Emacs 要容易得多，这要归功于 SO 上的社区和 EmacsWiki 等其他地方。:)

4.  从现在开始工作... a) 键绑定和自定义。b) 宏和宏编辑器。c) Elisp 和您自己的自定义库。

还值得注意的是，将 Emacs 设置为像更现代的应用程序一样工作可能会很痛苦，您需要执行诸如运行 emacs 服务器和使用 emacs 客户端之类的操作。

谢天谢地 (re: 3) 网上有很多帮助，但如果你可以直接接触到经验丰富的 Emacs 用户，那你就认为自己很幸运。

# c++ - 如何在 CTreeCtrl 中显示自定义工具提示？

> ID：269837
> 
> 赞同：3
> 
> 时间：2008-11-06T18:47:40.647
> 
> 标签：c++, mfc, tooltip, mfc-feature-pack

我有一个派生自`CTreeCtrl`. 在`OnCreate()`我用自定义对象替换默认`CToolTipCtrl`对象：

```
int CMyTreeCtrl::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    if (CTreeCtrl::OnCreate(lpCreateStruct) == -1)
        return -1;

    // Replace tool tip with our own which will
    // ask us for the text to display with a TTN_NEEDTEXT message
    CTooltipManager::CreateToolTip(m_pToolTip, this, AFX_TOOLTIP_TYPE_DEFAULT);
    m_pToolTip->AddTool(this, LPSTR_TEXTCALLBACK);
    SetToolTips(m_pToolTip);

    // Update: Added these two lines, which don't help either
    m_pToolTip->Activate(TRUE);
    EnableToolTips(TRUE);

    return 0;
} 
```

我的消息处理程序如下所示：

```
ON_NOTIFY_EX(TTN_NEEDTEXT, 0, &CMyTreeCtrl::OnTtnNeedText) 
```

但是我从来没有收到过`TTN_NEEDTEXT`消息。我看了一下 Spy++，看起来这条消息永远不会被发送。

这里可能是什么问题？

## 更新

我不确定这是否相关：`CTreeCtrl`的父窗口类型为`CDockablePane`。是否需要一些额外的工作才能使其正常工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-15T09:05:15.447

最后！我（部分）解决了它：

看起来 CDockablePane 父窗口确实导致了这个问题......

首先，我从 CTreeCtrl 派生类中删除了所有工具提示特定的代码。一切都在父窗格窗口中完成。

然后我编辑了父窗口的`OnCreate()`方法：

```
int CMyPane::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
    if (CDockablePane::OnCreate(lpCreateStruct) == -1)
        return -1;

const DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS | WS_CLIPCHILDREN |
    TVS_CHECKBOXES | TVS_DISABLEDRAGDROP | TVS_HASBUTTONS | TVS_HASLINES | TVS_LINESATROOT |
    TVS_INFOTIP | TVS_NOHSCROLL | TVS_SHOWSELALWAYS;

// TREECTRL_ID is a custom member constant, set to 1
if(!m_tree.Create(dwStyle, m_treeRect, this, TREECTRL_ID ) )
{
    TRACE0("Failed to create trace tree list control.\n");
    return -1;
}

// m_pToolTip is a protected member of CDockablePane
m_pToolTip->AddTool(&m_tree, LPSTR_TEXTCALLBACK, &m_treeRect, TREECTRL_ID);
m_tree.SetToolTips(m_pToolTip);

return 0; 
```

}

不幸的是，我们不能简单地用更少的参数调用，因为如果没有设置工具 ID `AddTool()`，基类将以关于成员的形式抱怨`ASSERT`。`uFlag`而且由于我们需要设置ID，所以我们还需要设置一个矩形。我创建了一个`CRect`成员并将其设置为`(0, 0, 10000, 10000)`CTor。我还没有找到改变工具矩形大小的工作方法，所以这是我非常丑陋的解决方法。这也是我将此解决方案称为部分解决方案的原因。**更新：[我问了一个关于这个的问题。](https://stackoverflow.com/questions/867724/how-to-modify-the-tool-rect-of-a-ctooltipctrl)**

最后是获取工具提示信息的处理程序：

```
// Message map entry
ON_NOTIFY(TVN_GETINFOTIP, TREECTRL_ID, &CMobileCatalogPane::OnTvnGetInfoTip)

// Handler
void CMyPane::OnTvnGetInfoTip(NMHDR *pNMHDR, LRESULT *pResult)
{
    LPNMTVGETINFOTIP pGetInfoTip = reinterpret_cast<LPNMTVGETINFOTIP>(pNMHDR);

    // This is a CString member
    m_toolTipText.ReleaseBuffer();
    m_toolTipText.Empty();

    // Set your text here...

    pGetInfoTip->pszText = m_toolTipText.GetBuffer();

    *pResult = 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T19:01:20.137

我相信您仍然必须启用工具提示，即使您要替换内置。

```
EnableToolTips(TRUE); 
```

好吧，既然这对你不起作用，而且没有其他专家提供任何帮助，这里还有一些我的建议。虽然它们很蹩脚，但它们可能会让你再次动起来：

*   确保您的 OnCreate() rotine 实际正在执行。
*   在更换之前启用工具提示。
*   我用来执行此操作的代码如下所示。（我承认我不了解所有细节，我从一些示例代码中复制了它，它有效，所以我再也没有看过它。）

    // 启用标准工具提示

    启用工具提示（真）；

    // 禁用内置工具提示

    CToolTipCtrl* pToolTipCtrl = (CToolTipCtrl*)CWnd::FromHandle((HWND)::SendMessage(m_hWnd, LVM_GETTOOLTIPS, 0, 0L));

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-09T00:06:53.593

我没有在 CTreeCtrl 中尝试过，但我认为您应该调用 RelayEvent 以获取工具提示 ctrl 以了解何时必须显示工具提示。试试这个：

MyTreeCtrl.h：

```
virtual BOOL PreTranslateMessage(MSG* pMsg); 
```

MyTreeCtrl.cpp：

```
BOOL CMyTreeCtrl::PreTranslateMessage(MSG* pMsg) 
{
    m_pToolTip.Activate(TRUE);
    m_pToolTip.RelayEvent(pMsg);

    return CTreeCtrl::PreTranslateMessage(pMsg);
} 
```

我希望这会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T18:55:38.910

您不必重写 OnToolHitTest() 吗？

[（旧）资源 1](http://www.codeguru.com/forum/showthread.php?p=557485)

[（旧）资源 2：](http://www.microsoft.com/msj/0397/c/c0397.aspx)

> 除了返回命中代码 (nHit) 之外，您还必须填写 TOOLINFO 结构。下面是 VIRGIL 在 CMainFrame::OnToolHitTest 中的做法：

```
 int nHit = MAKELONG(pt.x, pt.y);
 pTI->hwnd = m _ hWnd;
 pTI->uId  = nHit;
 pTI->rect = CRect(CPoint(pt.x-1,pt.y-1),CSize(2,2));
 pTI->uFlags |= TTF _ NOTBUTTON;
 pTI->lpszText = LPSTR _ TEXTCALLBACK; 
```

其中大部分是显而易见的——比如设置 hwnd 和 uId——但其中一些不是那么明显。我将 rect 成员设置为以鼠标位置为中心的 2 像素宽、2 像素高的矩形。工具提示控件使用这个矩形作为“工具”的边界矩形，我希望它很小，所以将鼠标移动到任何地方都会构成在工具之外移动。我在 uFlags 中设置了 TTF _ NOTBUTTON，因为工具提示与按钮无关。这是 afxwin.h 中定义的特殊 MFC 标志；MFC 使用它为工具提示提供帮助。工具提示还有另一个 MFC 扩展标志，TTF_ALWAYSTIP。如果您希望 MFC 即使在您的窗口未处于活动状态时也显示提示，您可以使用它。您可能已经注意到，到目前为止，我还没有告诉 MFC 或工具提示或 TOOLINFO 提示的实际文本是什么。这就是 LPSTR _ TEXTCALLBACK 的用途。这个特殊值告诉工具提示控件（MFC 使用的内部线程全局控件）调用我的窗口以获取文本。它通过向我的窗口发送一条带有通知代码 TTN_NEEDTEXT 的 WM_NOTIFY 消息来做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-08T05:31:13.627

尝试专门处理所有工具提示 ID：

```
ON_NOTIFY_EX_RANGE(TTN_NEEDTEXT, 0, 0xFFFF, &CMyTreeCtrl::OnNeedTipText) 
```

如果这不起作用，您可能必须从 PreTranslateMessage() 手动调用 RelayEvent()。

# c# - C# 3.0 Func/OrderBy 类型推断

> ID：269839
> 
> 赞同：5
> 
> 时间：2008-11-06T18:48:33.953
> 
> 标签：c#, lambda, type-inference

我今天在 OrderBy 遇到的奇怪情况：

```
Func<SomeClass, int> orderByNumber = 
  currentClass => 
   currentClass.SomeNumber; 
```

然后：

```
someCollection.OrderBy(orderByNumber); 
```

这很好，但我打算创建一个方法，因为它可能在 orderBy 以外的其他地方可用。

```
private int ReturnNumber(SomeClass currentClass)
{
  return currentClass.SomeNumber;
} 
```

现在，当我尝试将其插入 OrderBy 时：

```
someCollection.OrderBy(ReturnNumber); 
```

如果我使用 Func，它就不能像它那样推断类型。在我看来，它们应该是相同的，因为方法本身就像 Func 一样是“强类型”的。

旁注：我意识到我可以做到这一点：

```
Func<SomeClass, int> orderByNumber = ReturnNumber; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-06T19:02:48.137

这也可能与[在 Method Groups 上不起作用的“返回类型推断”有关](http://blogs.msdn.com/ericlippert/archive/2007/11/05/c-3-0-return-type-inference-does-not-work-on-member-groups.aspx)。

本质上，在`Where`泛型参数仅位于输入位置的情况下（如 的谓词），方法组转换可以正常工作。但是在泛型参数是返回类型（如`Select`或`OrderBy`投影）的情况下，编译器不会推断出适当的委托转换。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-06T19:08:50.653

`ReturnNumber`不是方法 - 相反，它*表示*一个方法组，其中包含具有名称但可能具有不同的arity-and-type签名的*所有方法。*`ReturnNumber`以非常通用且每次都有效的方式确定您真正想要的方法组中的哪种方法存在一些技术问题。显然，编译器在某些时候甚至大部分时间*都可以*计算出来，但是决定将一种算法放入编译器中，它只能在一半时间内工作，这是一个坏主意。

但是，以下工作：

```
someCollection.OrderBy(new Func<SomeClass, int>(ReturnNumber)) 
```

# amazon-s3 - 是否可以在不下载整个对象的情况下更改 S3 对象上的标头？

> ID：269840
> 
> 赞同：32
> 
> 时间：2008-11-06T18:48:40.320
> 
> 标签：amazon-s3

我已将一堆图像上传到 Amazon S3，现在想向它们添加一个 Cache-Control 标头。

可以在不下载整个图像的情况下更新标题吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-06T20:05:16.827

它是 beta 功能，但您可以在[复制对象](http://docs.amazonwebservices.com/AmazonS3/2006-03-01/index.html?RESTObjectCOPY.html)时指定新的元数据。为副本指定相同的源和目标，这只会更新对象上的元数据。

```
PUT /myObject HTTP/1.1
Host: mybucket.s3.amazonaws.com  
x-amz-copy-source: /mybucket/myObject  
x-amz-metadata-directive: REPLACE  
x-amz-meta-myKey: newValue 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-01-18T21:06:58.880

这是超出测试版的，可以通过执行 put 命令并复制[此处记录](http://docs.amazonwebservices.com/AmazonS3/latest/API/RESTObjectCOPY.html)的对象来获得。它也可以在他们的 SDK 中使用。以 C# 为例：

```
var s3Client = new AmazonS3Client("publicKey", "privateKey");
var copyRequest = new CopyObjectRequest()
                  .WithDirective(S3MetadataDirective.REPLACE)
                  .WithSourceBucket("bucketName")
                  .WithSourceKey("fileName")
                  .WithDestinationBucket("bucketName")
                  .WithDestinationKey("fileName)
                  .WithMetaData(new NameValueCollection { { "x-amz-meta-yourKey", "your-value }, { "x-amz-your-otherKey", "your-value" } });
var copyResponse = s3Client.CopyObject(copyRequest); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-22T16:30:36.903

这就是您使用适用于 PHP 2 的 AWS 开发工具包的方式：

```
<?php
require 'vendor/autoload.php';

use Aws\Common\Aws;
use Aws\S3\Enum\CannedAcl;
use Aws\S3\Exception\S3Exception;

const MONTH = 2592000;

// Instantiate an S3 client
$s3 = Aws::factory('config.php')->get('s3');
// Settings
$bucketName = 'example.com';
$objectKey = 'image.jpg';
$maxAge = MONTH;
$contentType = 'image/jpeg';

try {
    $o = $s3->copyObject(array(
        'Bucket' => $bucketName,
        'Key' => $objectKey,
        'CopySource' => $bucketName . '/'. $objectKey,
        'MetadataDirective' => 'REPLACE',
        'ACL' => CannedAcl::PUBLIC_READ,
        'command.headers' => array(
            'Cache-Control' => 'public,max-age=' . $maxAge,
            'Content-Type' => $contentType
        )
    ));

    // print_r($o->ETag);
} catch (Exception $e) {
    echo $objectKey . ': ' . $e->getMessage() . PHP_EOL;
}
?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-18T12:29:22.130

使用亚马逊 aws-sdk，执行带有额外标头的 copy_object 似乎可以为现有 S3 对象设置缓存控制标头。

=====================x============================ ====================

```
<?php
    error_reporting(-1);
    require_once 'sdk.class.php';

    // UPLOAD FILES TO S3
        // Instantiate the AmazonS3 class
    $options = array("key" => "aws-key" , "secret" => "aws-secret") ;

        $s3 = new AmazonS3($options);
        $bucket = "bucket.3mik.com" ;

    $exists = $s3->if_bucket_exists($bucket);
    if(!$exists) {
        trigger_error("S3 bucket does not exists \n" , E_USER_ERROR);
    }

    $name = "cows-and-aliens.jpg" ;
    echo " change headers for $name  \n" ;
    $source = array("bucket" => $bucket, "filename" => $name);
    $dest = array("bucket" => $bucket, "filename" => $name);

    //caching headers
    $offset = 3600*24*365;
    $expiresOn = gmdate('D, d M Y H:i:s \G\M\T', time() + $offset);
    $headers = array('Expires' => $expiresOn, 'Cache-Control' => 'public, max-age=31536000');

       $meta = array('acl' => AmazonS3::ACL_PUBLIC, 'headers' => $headers);

    $response = $s3->copy_object($source,$dest,$meta);
    if($response->isOk()){
        printf("copy object done \n" );

    }else {
        printf("Error in copy object \n" );
    }

?> 
```

========================x========================== =======================

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-22T13:03:22.370

在Java中，试试这个

```
S3Object s3Object = amazonS3Client.getObject(bucketName, fileKey);
ObjectMetadata metadata = s3Object.getObjectMetadata();
Map customMetaData = new HashMap();
customMetaData.put("yourKey", "updateValue");
customMetaData.put("otherKey", "newValue");
metadata.setUserMetadata(customMetaData);

amazonS3Client.putObject(new PutObjectRequest(bucketName, fileId, s3Object.getObjectContent(), metadata)); 
```

您也可以尝试复制对象。这里元数据不会在复制对象时复制。您必须获取原始元数据并设置为复制请求。更推荐使用此方法插入或更新 Amazon S3 对象的元数据

```
ObjectMetadata metadata = amazonS3Client.getObjectMetadata(bucketName, fileKey);
ObjectMetadata metadataCopy = new ObjectMetadata();
metadataCopy.addUserMetadata("yourKey", "updateValue");
metadataCopy.addUserMetadata("otherKey", "newValue");
metadataCopy.addUserMetadata("existingKey", metadata.getUserMetaDataOf("existingValue"));

CopyObjectRequest request = new CopyObjectRequest(bucketName, fileKey, bucketName, fileKey)
      .withSourceBucketName(bucketName)
      .withSourceKey(fileKey)
      .withNewObjectMetadata(metadataCopy);

amazonS3Client.copyObject(request); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-21T12:44:33.440

这是 Python 中的帮助代码。

```
import boto

one_year  = 3600*24*365
cckey = 'cache-control'
s3_connection = S3Connection()
bucket_name = 'my_bucket'
bucket = s3_connection.get_bucket(bucket_name validate=False)

for key in bucket:
    key_name = key.key
    if  key.size == 0: # continue on directories
        continue
    # Get key object
    key = bucket.get_key(key_name)

    if key.cache_control is not None:
        print("Exists")
        continue

    cache_time = one_year
    #set metdata
    key.set_metadata(name=cckey, value = ('max-age=%d, public' % (cache_time)))
    key.set_metadata(name='content-type', value = key.content_type)
    # Copy the same key
    key2 = key.copy(key.bucket.name, key.name, key.metadata, preserve_acl=True)
    continue 
```

说明：代码将新元数据添加到现有密钥，然后复制相同的文件。

# spring.net - Spring.NET 的问题 配置中的标记

> ID：269845
> 
> 赞同：1
> 
> 时间：2008-11-06T18:49:55.527
> 
> 标签：spring.net, local, idref

根据 Spring.NET 框架附带的帮助文件，您可以通过使用“idref”标签和“本地”属性来注入在本地文件中定义的依赖关系。

我一直在尝试这样做，但没有成功，希望有人有经验来帮助我。

下面我有一个来自配置的片段，我将它作为构造函数参数传递，但我也尝试将它设置为属性。两种方法似乎都会产生相同的错误。

```
<object id="theTargetObject" type="TestClassLibrary.TargetObject, TestClassLibrary"/>

<object id="theClientObject" type="TestClassLibrary.ClientObject, TestClassLibrary">
    <constructor-arg name="myClass">
        <idref local="theTargetObject"/>
    </constructor-arg>
</object> 
```

创建上下文“spring.root”时出错：在“文件 [C:\Test\TestApp\bin\Debug\my.config.xml]”中定义名称为“theClientObject”的对象创建时出错：通过索引为 0 的构造函数参数表达的依赖关系不满足[TestClassLibrary.TargetObject] 类型：无法将构造函数参数值 [theTargetObject] 转换为所需类型 [TestClassLibrary.TargetObject]：无法将 [System.String] 类型的属性值转换为属性“”的所需类型 [TestClassLibrary.TargetObject]。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-04T15:20:03.750

我猜 gef 是正确的，但是在粘贴代码片段时不小心把它弄混了。你正在寻找[<ref> 元素](http://www.springframework.net/docs/1.2.0/reference/html/objects.html#objects-ref-element)：

```
<object id="theTargetObject" type="TestClassLibrary.TargetObject, TestClassLibrary"/>
<object id="theClientObject" type="TestClassLibrary.ClientObject, TestClassLibrary">
     <property name="myClass">
            <ref local="theTargetObject"/>
    </property> 
```

对此的简写符号是：

```
<object id="theClientObject" type="TestClassLibrary.ClientObject, TestClassLibrary">
     <property name="myClass ref="theTargetObject"/> 
```

hth，埃里希

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-14T07:24:29.610

请查看帖子[http://forum.springsource.org/showthread.php?t=14211](http://forum.springsource.org/showthread.php?t=14211)

# windows - RegEx in awk and WinGrep

> ID：269864
> 
> 赞同：4
> 
> 时间：2008-11-06T18:57:30.050
> 
> 标签：windows, regex, awk, grep

So I'm looking for a pattern like this:

> size='0x0'

In a log file, but I'm only interested in large sizes (4 digits or more). The following regex works great in EditPadPro (nice tool BTW)

```
size='0x[0-9a-fA-F]{4,} 
```

But the same RegEx does not work in awk - seems like the repetition `{4,}` is messing it up. Same with WinGrep - any idea from the RegEx gurus? Thanks!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-06T20:22:20.597

You can in fact use awk, with a caveat.

As mentioned on the following page, you need a special command-line option (--re-interval) to make it work out, since the interval expression (the {4,}) is not in the standard:

[http://kansai.anesth.or.jp/gijutu/awk/gawk/gawk_28.html](http://kansai.anesth.or.jp/gijutu/awk/gawk/gawk_28.html)

So in the end, you'll want something that looks like:

```
awk --re-interval "/size='0x[0-9a-fA-F]{4,}'/" thefile 
```

This will print out the lines that match.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-06T19:01:44.800

I don't know of any elegant alternatives to the {4,} syntax, but if it is not working in your desired environment you could resort to this ugly hack:

```
size='0x[0-9a-fA-F][0-9a-fA-F][0-9a-fA-F][0-9a-fA-F]+ 
```

Hope this helps!

Adam

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:52:31.203

Don't forget the last apostrophe.

```
' 
```

# visual-studio - vs2008 发布非托管 dll 的问题

> ID：269872
> 
> 赞同：1
> 
> 时间：2008-11-06T19:01:09.217
> 
> 标签：visual-studio, dll, unmanaged, publish

我有一个非托管 dll 集合，它们周围有一个 C# 包装器，我从 C# 项目中调用它们。我添加了一个构建事件行，如下所示：

```
mkdir ..\Release
mkdir ..\Debug
copy ..\..\Includes\*.dll ..\Release\*.dll
copy ..\..\Includes\*.dll ..\Debug\*.dll 
```

问题是，当我去发布应用程序时，这些 dll 不包括在内，而且发布比无用更糟糕，因为它创建了一个应用程序，该应用程序在您调用其中一个 dll 之前一直运行。

那么，我如何在发布项目时包含非托管 dll？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T21:44:09.077

答案是：不要发布它，而是使用 Windows 安装程序，[如此处所述。](http://msdn.microsoft.com/en-us/library/e2444w33(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-03T01:19:53.760

我目前正在调查同样的问题。关于这个主题的文献确实非常稀少！

我能看到的唯一解决方案是将非托管 DLL 作为嵌入式资源嵌入到程序集中，并在调用任何函数之前以编程方式将其提取到执行路径。

# asp.net - odbc 连接的连接字符串是什么？

> ID：269876
> 
> 赞同：4
> 
> 时间：2008-11-06T19:02:21.023
> 
> 标签：asp.net, sql, sql-server, connection, connection-string

我一直在做网络应用程序，现在我需要做一个控制台应用程序。我需要同时使用 odbc 连接和常规连接。

在过去，我会使用：

```
<add name="LinkConnectionString" connectionString="Data Source=SERENITY\SQLEXPRESS;Initial Catalog=Link;Integrated Security=True" providerName="System.Data.SqlClient"/> 
```

但是，在 web.config 中，我不确定如何使用内联代码做同样的事情。所以像 string connectionString = @".....";

我尝试了多种组合，在线查看（包括 connectionstrings.com），但没有一个有效。

谁能帮我吗？我想要 odbc 和常规的......因为它们看起来不同应该根据在线示例（不起作用）而有所不同。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2008-11-06T19:29:11.843

建立连接字符串的一个很酷的技巧是右键单击您的桌面，选择“新文本文档” - 这将创建一个临时记事本 .txt 文件。将其重命名为 .udl，然后双击它 - 您现在可以创建任何连接字符串。完成后单击确定并在记事本中打开文件以查看连接字符串。

2009 年 4 月 28 日更新（powershell 脚本）：

```
function get-oledbconnection ([switch]$Open) {
    $null | set-content ($udl = "$([io.path]::GetTempPath())\temp.udl");
    $psi = new-object Diagnostics.ProcessStartInfo
    $psi.CreateNoWindow = $true
    $psi.UseShellExecute = $true
    $psi.FileName = $udl
    $pi = [System.Diagnostics.Process]::Start($psi)
    $pi.WaitForExit()
    write-host (gc $udl) # verbose 
    if (gc $udl) {
        $conn = new-object data.oledb.oledbconnection (gc $udl)[2]
        if ($Open) { $conn.Open() }
    }
    $conn
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T19:04:02.377

你应该能够在这里找到你需要的任何东西：

[http://www.connectionstrings.com/](http://www.connectionstrings.com/)

对于我们的一个应用程序，我们使用此连接字符串：

“驱动程序={驱动程序}；服务器=服务器.数据库；UID=用户名；PWD=密码”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T19:05:14.310

我认为这取决于您要连接的数据库，因为它用于连接到数据库引擎的驱动程序。

你可能想看看：

[http://www.connectionstrings.com/](http://www.connectionstrings.com/)

他们那里有很多例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T19:23:07.777

`<add name="myName" connectionString="dsn=myDSN;UID=myUID;" providerName="System.Data.Odbc" />`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T19:22:06.367

您是否为 SQLServer 尝试过类似的操作？

```
 SqlConnection conn = new SqlConnection(@"Data Source=SERENITY\SQLEXPRESS;Initial Catalog=Link;Integrated Security=True");
  SqlCommand cmd = new SqlCommand("SELECT * FROM tableName", conn);
  conn.Open();
  //<snip> Run Command
  conn.Close(); 
```

这对于 ODBC

```
OdbcConnection conn = new OdbcConnection(@"ODBC connection string");
OdbcCommand cmd = new OdbcCommand("SELECT * FROM tableName", conn);
conn.Open();
//Run Command
conn.Close(); 
```

# c++ - C++ 常量问题

> ID：269882
> 
> 赞同：8
> 
> 时间：2008-11-06T19:04:19.007
> 
> 标签：c++, gcc, constants

如果我这样做：

```
// In header 
class Foo {
void foo(bar*);
};

// In cpp
void Foo::foo(bar* const pBar) {
//Stuff
} 
```

编译器不会抱怨 Foo::foo 的签名不匹配。但是，如果我有：

```
void foo(const bar*); //In header
void Foo::foo(bar*) {} //In cpp 
```

代码将无法编译。

到底是怎么回事？我正在使用 gcc 4.1.x

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-06T19:07:02.183

首先，您已向编译器（而非该类的其他用户）承诺您不会编辑该变量。

在您的第二个示例中，您已向该类的其他用户承诺您不会编辑他们的变量，但未能遵守该承诺。

我还应该注意，两者之间存在明显差异

```
bar* const variable 
```

和

```
const bar* variable 
```

和

```
const bar* const variable 
```

在第一种形式中，指针永远不会改变，但您可以编辑指向的对象。在第二种形式中，您可以编辑指针（将其指向另一个对象），但不能编辑它指向的变量。在最终形式中，您既不会编辑指针，也不会编辑它指向的对象。[参考](http://www.parashift.com/c++-faq-lite/const-correctness.html#faq-18.5)

要对所述问题进行更多说明，您始终可以承诺 MORE const 多于 less。给定一个类：

```
class Foo {
    void func1 (int x);
    void func2 (int *x);
} 
```

您可以编译以下实现：

```
Foo::func1(const int x) {}
Foo::func2(const int *x) {} 
```

或者：

```
Foo::func1(const int x) {}
Foo::func2(const int* const x) {} 
```

没有任何问题。您已经告诉您的用户您可能会编辑他们的变量。在你的实现中，你告诉编译器这个特定的实现不会编辑这些变量，即使你告诉用户你可以。您没有违反对用户的承诺，因此代码可以编译。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T19:08:55.037

看到[这个问题](https://stackoverflow.com/questions/117293/use-of-const-for-function-parameters)，[这个问题](https://stackoverflow.com/questions/219914/what-use-are-const-pointers-as-opposed-to-pointers-to-const-objects)，还有[这个问题](https://stackoverflow.com/questions/232472/what-is-the-difference-between-these-declarations-in-c)。

基本上， const 仅表示该函数不会修改指针的值。指针内容不是 const，与标头的签名相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T19:22:20.873

第一个示例中的*const*关键字没有意义。你是说你不打算改变指针。但是，指针是按值传递的，因此更改与否无关紧要；它不会影响调用者。同样，您也可以这样做：

```
// In header 
class Foo {
void foo( int b );
};

// In cpp
void Foo::foo( const int b ) {
//Stuff
} 
```

你甚至可以这样做：

```
// In header 
class Foo {
void foo( const int b );
};

// In cpp
void Foo::foo( int b ) {
//Stuff
} 
```

由于*int*是按值传递的，因此常量无关紧要。

在第二个示例中，您说您的函数采用指向一种类型的指针，但随后将其实现为采用指向另一种类型的指针，因此它失败了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T19:07:16.350

在前者中，`const`不影响接口，只影响实现。你是在对编译器说，“我不会`bar*`在这个函数中改变值”。您仍然可以更改指针指向的内容。在后者中，您告诉编译器（和所有调用者）您不会更改*指向*`bar`的结构。`bar*`

 ** * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T19:13:44.200

所以第二个常量在：

```
void Foo::foo(const bar* const); 
```

是***不是***方法签名的一部分？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-06T19:33:30.650

使用指针以外的变量类型更容易理解。例如，您可以有以下函数声明：

```
void foo( int i ); 
```

定义可能如下所示：

```
void foo( const int i ) { ... } 
```

变量“i”在定义端是否为 const 是一个实现细节。它对该功能的客户没有影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-06T19:38:44.210

它可能不太在意，`void Foo::foo(bar* const pBar)`因为您如何对待指针本身（是否为 const）在例程之外一点都不重要。C 规则说，对 pBar 的任何更改都不会在 foo 之外传播。

但是，如果是`(const bar* pBar)`，那会有所不同，因为这意味着编译器不允许调用者传入指向非常量对象的指针。

# c# - 在 Windows 上为我的程序存储配置文件和日志文件的最佳位置？

> ID：269893
> 
> 赞同：54
> 
> 时间：2008-11-06T19:08:30.607
> 
> 标签：c#, windows

我需要为我的应用程序存储日志文件和配置文件。存放它们的最佳地点在哪里？

现在，我只是使用当前目录，最终将它们放在我的程序所在的 Program Files 目录中。

用户可能会定期访问日志文件，因此`%APPDATA%`似乎有点难以访问。

最好是下一个目录`%USERPROFILE%\My Documents`吗？它需要适用于所有版本的 Windows，从 2000 年开始。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-11-06T20:03:41.323

如果您不使用`ConfigurationManager`来管理您的应用程序和用户设置，那么您应该这样做。.NET Framework 中的配置工具包经过深思熟虑，与之互操作的 Visual Studio 工具也是如此。

默认行为`ConfigurationManager`将不变（应用程序）和可修改（用户）设置放在正确的位置：应用程序设置放在应用程序文件夹中，用户设置放在`System.Environment.SpecialFolder.LocalApplicationData`. 它在所有支持 .NET 的 Windows 版本下都能正常工作。

至于日志文件，`System.Environment.SpecialFolder.LocalApplicationData`通常是您要放置它们的地方，因为它保证是用户可写的。

在某些情况下您肯定不会 - 例如，如果您想将文件写入网络共享，以便您可以轻松地远程访问它们。有很多方法可以实现这一点，但大多数都是从创建包含共享文件夹路径的应用程序设置开始的。所有这些都涉及管理。

我对 VS 工具有一些抱怨`ConfigurationManager`：需要有比现有更好的高级文档，以及更好的 VS 生成`Settings`类的文档。文件在目标构建目录中转换为应用程序配置文件的机制`app.config`是不透明的（以及最常见问题之一的来源：“我的连接字符串发生了什么？”）。如果有一种方法可以创建没有默认值的设置，我还没有找到。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-05-19T00:45:19.817

注意：您可以使用以下函数获取 .NET 中 LocalApplicationData 文件夹的路径：

```
string strPath=System.Environment.GetFolderPath(System.Environment.SpecialFolder.LocalApplicationData); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-06T19:32:26.283

对于应用程序设置 - 使用`System.Environment.SpecialFolder.ApplicationData`- 这是存储漫游配置文件数据的位置，因此它允许您的用户在域中的不同机器上登录和工作。

对于日志文件 -`System.Environment.SpecialFolder.LocalApplicationData`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-10-18T14:14:20.427

The accepted answer notes that for log files the following is a good spot. `System.Environment.SpecialFolder.LocalApplicationData` This equates to a path of `C:\Users\[User]\AppData\Roaming` which you can see is user specific. Like the accepted answer mentions this is a guaranteed user-writeable location and can be useful for certain situations

However in a web application environment you may be running your application under a network account and you or a coworker may need to try and track down where exactly those logs are going per application. I personally like to use the non user specific location enumeration of `System.Environment.SpecialFolder.CommonApplicationData` which equates to `C:\ProgramData`. Yes, you will need to specify access rights for any folders you create, but it's usually a one time deal and then all of your application logs can live in one happy location.

Additionally, while looking around the Internet, there is a project out there to programatically set write access to folders you create within `CommonApplicationData`, *[Allow write/modify access to CommonApplicationData](http://www.codeproject.com/Tips/61987/Allow-write-modify-access-to-CommonApplicationData)*.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-11-06T19:41:43.410

老实说 %appdata% 仍然是放置配置文件和日志文件的最佳位置，因为它用作占位符来存储应用程序数据。它应该不难访问，只需在资源管理器中写入 %appdata% ，您将被直接定向到您的 %appdata% 目录。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-06T19:19:00.943

不要将配置文件存储在应用程序文件夹中，微软表示这不是理想的位置。Windows 一直在朝着阻止写入 C:\Program Files\ 的方向发展，您会在 Vista 中发现任何尝试在此处写入的应用程序都会触发 UAC 警告。

Windows 7 将允许用户自定义他们使用的 UAC 弹出窗口（预计某些高级用户会阻止其中的大部分），如果用户从未批准此写入尝试，您的应用程序将失败/冻结。

如果您使用正确的 userprofile 和 appdata 变量，那么 Win 2000、XP、Vista 和 Win7 会将数据映射到正确的写友好文件夹，而不会弹出 UAC。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-06T19:50:39.833

您可以使用 SHGetSpecialFolderPath：

```
int MAX_PATH = 255;

CString m_strMyPath;

SHGetSpecialFolderPath(NULL, m_strMyPath.GetBuffer(MAX_PATH), CSIDL_COMMON_APPDATA, TRUE); 
```

这将指定您可以安全地将日志写入 Windows 的“特殊文件夹路径”：

对于 XP：`C:\Documents and Settings\All Users\Application Data`

对于 Vista：`C:\ProgramData`

在此处查看 MSDN 页面：http: [//msdn.microsoft.com/en-us/library/bb762204 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb762204(VS.85).aspx)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-06T19:15:40.530

最佳答案取决于日志和配置的性质。如果它们是程序范围的，并且不需要在应用程序卸载后幸存下来，那么我认为它们在它们所在的位置很好。如果日志和配置是特定于用户的，或者需要在卸载后继续存在，那么它们属于 %USERPROFILE% - %APPDATA% 下的某个位置，是此类事物的“正确”基目录。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T19:13:24.917

我使用**隔离存储**进行配置。您还可以使用**Temp**文件夹来存储临时信息，例如日志。

# apache - UTF-8 URI 爆炸 Apache & mod_rewrite

> ID：269897
> 
> 赞同：1
> 
> 时间：2008-11-06T19:09:09.717
> 
> 标签：apache, mod-rewrite, utf-8, internationalization, diacritics

我有带有 mod_rewrite 的 Apache，每当我输入一个带有重音字符的 URI 时，Apache 都会给我一个“找不到页面”错误。

URI 是：/places/tags/Café

我的页面编码是 UTF-8。我的数据库连接和表是 UTF-8。我的 Apache DefaultCharacterSet = UTF-8。是的，Apache 有语言包，但我相信它们用于页面内容，而不是 URI。

我们不希望将 url 编码成百分号和 html 实体，在我们的 1 亿行数据中，去除特殊字符目前是不切实际的。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T19:34:00.163

原来我有一个糟糕的 apache 重写规则。我一直在使用： ([a-zA-Z0-9_-] *) UTF-8 字符不是 a-zA-Z 的一部分。将规则更改为： (.* ) 这表示任何字符（ASCII、UTF-8 或其他字符）。似乎工作正常。

# asp.net - 以 Hashing 和 saltvalue 的形式将字符串与 ASP.net Membership Answer 进行比较

> ID：269905
> 
> 赞同：0
> 
> 时间：2008-11-06T19:11:30.803
> 
> 标签：asp.net

我需要将答案与 aspnet_membership 表 PasswordAnswer 值进行比较。

密码答案中的文本采用散列形式。他们使用了什么算法来实现 ASP.net Membership Provider 中的 Salt 值。

我尝试过散列（sh1）并与文本比较什么是盐值

如何散列我的答案值。

字符串答案=“一”；字符串 hashedvalue = "dfdsfsdfdsfdsfdfdf";

我需要比较这两者。

我已将答案转换为散列格式。但两者都是不同的>我认为是由于盐的价值。我该如何利用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-06T19:17:47.983

您应该使用[Membership 类的 ValidateUser 方法](http://msdn.microsoft.com/en-us/library/system.web.security.membership.validateuser.aspx)来执行此操作。

# flash - 从具有不同于默认值的另一个 swf 中打开一个 swf 文件

> ID：269906
> 
> 赞同：5
> 
> 时间：2008-11-06T19:11:34.767
> 
> 标签：flash, actionscript-2

希望这不会被视为两次问同一个问题......

所以我正在开发一个 Flash 网站（在 AS2 中），它有一个外部索引 swf，它使用`loadMovie("subfoo1.swf", placeToShowSwf)`. 这些依次加载一个 xml 文件，该文件告诉它要加载什么内容。一切正常，但我们想向索引 swf 添加一个按钮，该按钮打开一个子 swf 文件，其中一两个变量具有一或两个不同的值。

不幸的是，只需添加一个按钮，上面写着

```
loadMovie("foo1.swf", placeToShowSwf);
placeToShowSwf.openProject(x); 
```

不起作用，我假设是因为`openProject(x)`在未完全加载的文件上调用。我知道代码没有问题，因为我在其他地方做了一个按钮，只调用`placeToShowSwf.openProject(x)`并且没有任何问题。

我看到了两种解决方案，我都不确定该怎么做。

1.  在创建 swf 文件时更改所需的值，例如类的构造函数。但是 swf 文件是否有某种构造函数？只是说`loadMovie(new foo1.swf(x), placeToShowSwf)`或类似的东西真的很好。
2.  等到加载 swf（可能还有 xml）之后，然后调用`placeToShowSwf.openProject(x)`.

任何人都对这些解决方案有任何指导，或者可能是我豌豆般的大脑无法理解的其他方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-10T09:57:37.130

解决此问题的三种简单方法：

(1) - 反转命令的方向。也就是说，在父 SWF 中，您拥有：

```
projectType = "x";
loadMovie("foo1.swf", placeToShowSwf); 
```

子（加载）SWF 有这个：

```
openProject( _parent.projectType ); 
```

你明白了。如果子 SWF 是从不同的服务器加载的，这将不起作用，除非您解决跨域脚本问题。

(2) - 等待 MC 加载。不幸的是，AS2 没有内置的加载事件可供您使用，因此常用的方法是使用这样的 onEnterFrame：

```
someMovieClip.onEnterFrame = function() {
    if ( path_to.placeToShowSwf.openProject ) {
        path_to.placeToShowSwf.openProject(x);
        this.onEnterFrame = null;
    }
} 
```

如果您想在该方法可用时立即调用该方法；如果您想等到子 swf 完全加载，您需要检查子 SWF`getBytesLoaded()`和`getBytesTotal()`方法。

(3) 使用像 MovieClipLoader 这样的组件来进行加载 - 只需按照[文档](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00001993.html)操作即可。从表面上看，这与 (2) 类似，但细节隐藏在 MovieClipLoader 类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T20:58:54.657

2号是你应该做的。不幸的是，您仍然停留在 ActionScript 1 领域，而 ActionScript 3 已经推出几年了。所以我不知道确切的语法（我自己从 ActionScript 2 上的 flash 开始），但 #2（等待 SWF 完成加载，然后告诉它要做什么）是我会做的。

如果您不介意学习一点 AS2（通常可以将 AS1 和 AS2 混合使用，没有太大问题），那么您应该看看 MovieClipLoader。它提供回调来告诉您子 SWF 何时完成加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-11T14:39:03.630

fenomas 的回答相当不错，但如果您使用 AS2 使用 MovieClipLoader 类加载您的 swf，还有一种不那么“hacky”的方式。它有你可以监听的事件，你会对 onLoadInit 事件感兴趣。尽管人们可能会直觉它在加载过程初始化时被触发，并且应该使用 onLoadComplete ，但事实并非如此。

onLoadComplete 当所有字节完成下载时触发​​ onLoadInit 当所有字节完成下载并且加载的 swf 中的类被初始化时触发（因此您可以访问加载的 swf 的方法和属性）

查看 as2.0 文档中 MovieClipLoader > onLoadInit 中的代码示例

[http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/js/html/wwhelp.htm?href=Part4_ASLR2.html](http://livedocs.adobe.com/flash/8/main/wwhelp/wwhimpl/js/html/wwhelp.htm?href=Part4_ASLR2.html)

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-11T14:45:59.807

您所做的方式是正确的，只是您需要等待**onLoadInit**回调，然后再尝试访问您的子影片剪辑。

# scripting - Lua 作为通用脚本语言有前途吗？

> ID：269913
> 
> 赞同：6
> 
> 时间：2008-11-06T19:13:49.270
> 
> 标签：scripting, lua

[正如在“ Lua 作为一种通用脚本语言？](https://stackoverflow.com/questions/250151/lua-as-a-general-purpose-scripting-language) ”中已经讨论的那样，Lua 目前可能不是桌面环境的最佳脚本语言。

但是你对未来有什么看法？Lua 会变得如此受欢迎，以至于很快就会有足够多的库可以像 Python、Ruby 或类似的东西一样使用它吗？

或者它会仅仅停留在它的魔兽世界中，仅此而已？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-11-06T19:29:17.773

我认为它有一个美好的未来，很多项目都开始采用它，因为它简单实用。

**示例：** **[Awesome WM](http://awesome.naquadah.org/)**（窗口管理器）

该项目最近发布了第 3 版，其中包含一个完全用 Lua 编写的新配置系统。允许您将配置文件写成程序、循环、布尔值、数据结构。我个人喜欢这样一个系统的语法和灵活性，我认为它有很大的潜力。

如果它在未来变得更受欢迎，我不会感到惊讶。

**布莱恩·G**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-06T20:16:19.113

我想答案从“这取决于你想如何使用它......”开始。

如果您正在编写通用业务应用程序（从数据库中获取数据，在网页或窗口中显示数据，将数据保存到数据库中），Lua 已经具备您所需要的功能。

[Kepler 项目](http://www.keplerproject.org/)包含 Web 开发的好东西。查看他们的[模块](http://www.keplerproject.org/en/Modules)以查看一些可用的库 - 有网络、MVC、DBMS 访问、XML、zip、WSAPI、文档......

作为示例 Web 应用程序，请查看[Sputnik](http://sputnik.freewisdom.org/)。

对于桌面 UI，有[wxLua -](http://wxlua.sourceforge.net/) [wxWidgets](http://www.wxwidgets.org/)的Lua 钩子。

ORM 明显缺失，但这并没有阻止人们在 ORM 可用之前使用其他语言进行开发。

[如果你正在寻找专门的库——科学、多媒体、安全——在你检查LuaForge](http://luaforge.net/)之前不要把 Lua 排除在外。

归根结底，Lua 的设计中没有任何东西可以阻止通用用途。它恰巧小巧、快速且易于嵌入……人们就是这样做的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T22:39:00.383

呃？相反，我会说 WoW 是 Lua 生态系统中的一个利基市场…… Lua 的世界并不围绕 WoW，有很多应用程序，比如 Adob​​e Lightroom（非游戏），使用 Lua。

Lua 最初是一种脚本语言，在最初的意义上，即。嵌入到应用程序中以编写脚本。但它也被设计为一种可扩展的语言，因此我们将逐渐看到越来越多的各种库的绑定用于各种目的。

但是你永远不会得到一个包含电池的*官方*大型发行版，比如 Python 或 Perl，因为这不是作者的哲学。
这并不妨碍其他人制作包含许多开箱即用功能的发行版（特别是对于 Windows，在难以构建软件的情况下）。

很多人已经将它用于一般的系统级脚本、桌面应用程序等等。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-01T21:19:54.870

Lua 的库越来越多。

如果您是 Windows 用户，请查看[Lua for Windows](http://luaforwindows.luaforge.net/)。它带有“包括电池”（wxLua、LuaCURL、LuaUnit、getopt、LuaXML、LPeg...）。

很有用！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-06T19:20:30.003

我真的很喜欢它作为一种嵌入式语言。它很小，非常易于使用和嵌入，并且开箱即可满足我的大部分需求。它也与大多数语言相似，对我来说从来都不是问题。我还喜欢为语言重新定义和添加基本函数和关键字以适应我的应用程序的任何需求是多么容易。

我曾在 WoW 领域使用过它，但我也发现它作为一种通用脚本语言非常有用，可用于我从事过的许多不同应用程序，包括作为一种数据库触发器。我喜欢 Ruby 和 Python 以及其他功能更全的脚本语言，但它们在嵌入到小型应用程序中为用户提供更多自定义环境的选项时并不那么方便。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-06T20:21:51.923

我认为 Lua 的最大特点是，它很容易扩展。将 Lua 解释器添加到您自己的程序（例如用 C、C++ 或 Obj-C 编写的程序）中非常容易，并且只需几行代码，您就可以让 Lua 访问您能想到的任何系统资源. 例如 Lua 没有提供做 xxx 的功能。编写一个并使其对 Lua 可用。但反过来也有可能。用您选择的语言（可编译的语言）编写您自己的 Lua 扩展，将其编译为本机库，在 Lua 中加载库，然后您就可以使用该函数了。

也就是说，Lua 可能不是作为独立跨平台语言的最佳选择。但是 Lua 是一种很棒的语言，可以跨平台的方式为您的应用程序添加脚本支持（如果您的应用程序是跨平台的，那就更好了！）。我认为 Lua 会有一个未来，我认为你可以期待这种语言从长远来看会不断普及。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-07-09T01:13:57.927

`Torch`现在是 2017 年，距离第一次提出这个问题已有 9 年了，由于库，lua 现在在机器学习领域被大量使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-06T19:55:33.617

舒适地作为一种 shell 语言与成为一种伟大的通用语言无关。

我，一方面，不要在其他应用程序中使用它；我用 Lua 编写我的应用程序，任何“额外”的东西都是一个特殊用途的库，无论是在 Lua 中还是在 C 中。

此外，“受欢迎”并不那么重要。在 Lua 用户列表中，定期出现有人说“Lua 不会流行，除非它有 X！”，通常的答案是：“太好了！写它！”，或者“已经讨论过并被拒绝”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-06T20:22:29.567

我相信《战锤在线》和《魔兽世界》使用它作为他们的插件语言。

我觉得很热！我只是不擅长！

# java - 免费的java 3d引擎

> ID：269916
> 
> 赞同：10
> 
> 时间：2008-11-06T19:14:52.573
> 
> 标签：java, 3d

可用于 java 的最佳 3D 游戏引擎是什么？我正在寻找具有良好设置可视化开发工具的东西。我查看了维基百科上的可用列表：

[http://en.wikipedia.org/wiki/List_of_game_engines](http://en.wikipedia.org/wiki/List_of_game_engines)

但我无法弄清楚每个引擎提供的工具集以及哪个免费的 java 3d 引擎拥有最好的工具集。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-06T20:40:46.287

[jMonkeyEngine](http://www.jmonkeyengine.com/)为 3d java 开发提供了一套不错的开源工具。它们已被用于一些商业游戏（[Bang!Howdy](http://www.banghowdy.com/)和 NCSoft 正在开发的一个最近被取消的游戏浮现在脑海中）。他们拥有一批优秀的活跃开发人员，其中包含许多随基本工具集一起提供的代码示例。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-09T16:18:44.823

**[Ardor3D](http://www.ardor3d.com/)**

JMonkeyEngine 的一个分支，包括 JMonkeyEngine 团队的两名前开发人员。本质上是一个更广泛的 3d 引擎，具有清晰的（-er）API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-09T01:18:36.217

a powerfull Java 3D engine is [3DzzD](http://dzzd.net/ "3DzzD")

including both software and hardware rendering, it is perfect for Web 3D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-06T20:06:43.390

[OGRE](http://www.ogre3d.org/)是一个很好的 C++ 开源引擎。[维基](http://en.wikipedia.org/wiki/OGRE_Engine)。

[Ogre4j](http://ogre4j.sourceforge.net/)与 Java 相同。[维基](http://en.wikipedia.org/wiki/Ogre4j)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-09-25T16:58:16.097

如果您同时学习 Java，并且想编写简单的 3D 游戏，请尝试 Env3D (http://env3d.sourceforge.net)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T14:22:21.833

The [Lightweight Java Game Library](http://lwjgl.org/) is a pretty good one.

# c++ - C++ 字符串 diff（类似于 Python 的 difflib）

> ID：269918
> 
> 赞同：3
> 
> 时间：2008-11-06T19:16:12.837
> 
> 标签：c++, python, algorithm, diff

我试图区分两个字符串以确定它们是否仅在字符串结构的一个数字子集中变化；例如，

```
varies_in_single_number_field('foo7bar', 'foo123bar')
# Returns True, because 7 != 123, and there's only one varying
# number region between the two strings. 
```

在 Python 中，我可以使用`difflib`来完成此操作：

```
import difflib, doctest

def varies_in_single_number_field(str1, str2):
    """
    A typical use case is as follows:
        >>> varies_in_single_number_field('foo7bar00', 'foo123bar00')
        True

    Numerical variation in two dimensions is no good:
        >>> varies_in_single_number_field('foo7bar00', 'foo123bar01')
        False

    Varying in a nonexistent field is okay:
        >>> varies_in_single_number_field('foobar00', 'foo123bar00')
        True

    Identical strings don't *vary* in any number field:
        >>> varies_in_single_number_field('foobar00', 'foobar00')
        False
    """
    in_differing_substring = False
    passed_differing_substring = False # There should be only one.
    differ = difflib.Differ()
    for letter_diff in differ.compare(str1, str2):
        letter = letter_diff[2:]
        if letter_diff.startswith(('-', '+')):
            if passed_differing_substring: # Already saw a varying field.
                return False
            in_differing_substring = True
            if not letter.isdigit(): return False # Non-digit diff character.
        elif in_differing_substring: # Diff character not found - end of diff.
            in_differing_substring = False
            passed_differing_substring = True
    return passed_differing_substring # No variation if no diff was passed.

if __name__ == '__main__': doctest.testmod() 
```

但我不知道如何找到类似`difflib`C++ 的东西。欢迎使用替代方法。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T20:33:58.780

这可能有效，它至少通过了您的演示测试： 编辑：我进行了一些修改以处理一些字符串索引问题。我相信现在应该很好了。

```
#include <iostream>
#include <string>
#include <vector>
#include <algorithm>
#include <cctype>

bool starts_with(const std::string &s1, const std::string &s2) {
    return (s1.length() <= s2.length()) && (s2.substr(0, s1.length()) == s1);
}

bool ends_with(const std::string &s1, const std::string &s2) {
    return (s1.length() <= s2.length()) && (s2.substr(s2.length() - s1.length()) == s1);
}

bool is_numeric(const std::string &s) {
    for(std::string::const_iterator it = s.begin(); it != s.end(); ++it) {
        if(!std::isdigit(*it)) {
                return false;
        }
    }
    return true;
}

bool varies_in_single_number_field(std::string s1, std::string s2) {

    size_t index1 = 0;
    size_t index2 = s1.length() - 1;

    if(s1 == s2) {
        return false;
    }

    if((s1.empty() && is_numeric(s2)) || (s2.empty() && is_numeric(s1))) {
        return true;
    }

    if(s1.length() < s2.length()) {
        s1.swap(s2);
    }

    while(index1 < s1.length() && starts_with(s1.substr(0, index1), s2)) { index1++; }
    while(ends_with(s1.substr(index2), s2)) { index2--; }

    return is_numeric(s1.substr(index1 - 1, (index2 + 1) - (index1 - 1)));

}

int main() {
    std::cout << std::boolalpha << varies_in_single_number_field("foo7bar00", "foo123bar00") << std::endl;
    std::cout << std::boolalpha << varies_in_single_number_field("foo7bar00", "foo123bar01") << std::endl;
    std::cout << std::boolalpha << varies_in_single_number_field("foobar00", "foo123bar00") << std::endl;
    std::cout << std::boolalpha << varies_in_single_number_field("foobar00", "foobar00") << std::endl;
    std::cout << std::boolalpha << varies_in_single_number_field("7aaa", "aaa") << std::endl;
    std::cout << std::boolalpha << varies_in_single_number_field("aaa7", "aaa") << std::endl;
    std::cout << std::boolalpha << varies_in_single_number_field("aaa", "7aaa") << std::endl;
    std::cout << std::boolalpha << varies_in_single_number_field("aaa", "aaa7") << std::endl;
} 
```

基本上，它寻找一个包含 3 个部分的字符串，string2 以 part1 开头，string2 以 part3 结尾，part2 只是数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T19:46:23.323

这可能有点矫枉过正，但你可以使用 boost 来连接 python。最坏的情况是，difflib是用纯python实现的，而且不会太长。应该可以从python移植到C ...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-06T20:36:24.953

您可以采取一种特别的方法：您正在寻找匹配字符串 s 和 s'，其中 s=abc 和 s'=ab'c，并且 b 和 b' 应该是两个不同的数字（可能为空）。所以：

1.  比较左边的字符串，一个字符一个字符，直到你碰到不同的字符，然后停止。你
2.  同样，从右侧比较字符串，直到您点击不同的字符，或者点击左侧的标记。
3.  然后检查中间的余数，看看它们是否都是数字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T20:56:26.753

@Evan Teran：看起来我们是并行执行的——我的 O(n) 实现的可读性明显降低：

```
#include <cassert>
#include <cctype>
#include <string>
#include <sstream>
#include <iostream>

using namespace std;

ostringstream debug;
const bool DEBUG = true;

bool varies_in_single_number_field(const string &str1, const string &str2) {
    bool in_difference = false;
    bool passed_difference = false;
    string str1_digits, str2_digits;
    size_t str1_iter = 0, str2_iter = 0;
    while (str1_iter < str1.size() && str2_iter < str2.size()) {
        const char &str1_char = str1.at(str1_iter);
        const char &str2_char = str2.at(str2_iter);
        debug << "str1: " << str1_char << "; str2: " << str2_char << endl;
        if (str1_char == str2_char) {
            if (in_difference) {
                in_difference = false;
                passed_difference = true;
            }
            ++str1_iter, ++str2_iter;
            continue;
        }
        in_difference = true;
        if (passed_difference) { /* Already passed a difference. */
            debug << "Already passed a difference." << endl;
            return false;
        }
        bool str1_char_is_digit = isdigit(str1_char);
        bool str2_char_is_digit = isdigit(str2_char);
        if (str1_char_is_digit && !str2_char_is_digit) {
            ++str1_iter;
            str1_digits.push_back(str1_char);
        } else if (!str1_char_is_digit && str2_char_is_digit) {
            ++str2_iter;
            str2_digits.push_back(str2_char);
        } else if (str1_char_is_digit && str2_char_is_digit) {
            ++str1_iter, ++str2_iter;
            str1_digits.push_back(str1_char);
            str2_digits.push_back(str2_char);
        } else { /* Both are non-digits and they're different. */
            return false;
        }
    }
    if (in_difference) {
        in_difference = false;
        passed_difference = true;
    }
    string str1_remainder = str1.substr(str1_iter);
    string str2_remainder = str2.substr(str2_iter);
    debug << "Got to exit point; passed difference: " << passed_difference
        << "; str1 digits: " << str1_digits
        << "; str2 digits: " << str2_digits
        << "; str1 remainder: " << str1_remainder
        << "; str2 remainder: " << str2_remainder
        << endl;
    return passed_difference
        && (str1_digits != str2_digits)
        && (str1_remainder == str2_remainder);
}

int main() {
    assert(varies_in_single_number_field("foo7bar00", "foo123bar00") == true);
    assert(varies_in_single_number_field("foo7bar00", "foo123bar01") == false);
    assert(varies_in_single_number_field("foobar00", "foo123bar00") == true);
    assert(varies_in_single_number_field("foobar00", "foobar00") == false);
    assert(varies_in_single_number_field("foobar00", "foobaz00") == false);
    assert(varies_in_single_number_field("foo00bar", "foo01barz") == false);
    assert(varies_in_single_number_field("foo01barz", "foo00bar") == false);
    if (DEBUG) {
        cout << debug.str();
    }
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-06T20:58:45.220

使用 boost::regex 之类的东西怎么样？

```
// 伪代码，可能编译也可能不编译
bool match_except_numbers(const std::string& s1, const std::string& s2)
{
    static const boost::regex fooNumberBar("foo\\d+bar");
    返回 boost::match(s1, fooNumberBar) && boost::match(s2, fooNumberBar);
}

```

# php - 创建 csv 文件，不适用于右键单击另存为

> ID：269931
> 
> 赞同：0
> 
> 时间：2008-11-06T19:20:01.673
> 
> 标签：php

我有一个脚本，它生成 csv 格式的数据，连同一组标头一起发送给用户，这些标头告诉浏览器它是一个 .csv 文件。当用户（左）单击脚本的链接时，一切都很好，他们会看到一个文件名以 .csv 结尾的下载对话框，并建议使用 excel 或 calc 打开它。但是，当用户右键单击并选择另存为时，它会以 php 脚本名称保存。

这是标题代码：

```
header("Pragma: public");
header("Expires: 0"); // set expiration time

header("Content-Type: application/force-download");
header("Content-Type: application/octet-stream");
header("Content-Type: application/download");

$val = date("m_d_Y_g_i");
Header('Content-Disposition: attachment; filename="personal_information_'.$val.'.csv"'); 
```

同样，当用户左键单击时，它将文件保存为personal_information_date.csv；当他们右键单击它保存为download.php。我用的是FF3。奇怪的是，IE7 没有这个问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T19:28:17.510

使用 mod_rewrite 将文件从 file.csv 别名为 file.php，这是一个浏览器问题，而不是 PHP，因为通过保存文件它在保存它之前没有运行它。

所以总结一下：

1.  链接到`personal_information_date.csv`
2.  创建一个转发到（例如：）的`mod_rewrite`规则。`personal_information_date.csv``download.php``RewriteRule ^personal_information_date.csv$ download.php`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T21:06:30.197

HTTP 客户端可能会忽略一个以上的内容类型标头，另外两个将被忽略——它们中的哪一个？取决于浏览器的实现，因此行为不同。正确的 mime 类型是 text/csv，而不是 application/octet-stream！content-disposition 标头对于下载是正确的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:42:17.840

*   我相信设置三种不同的 mimetype 并没有帮助
*   什么是 $val ？是否提供了此已知内容或用户 - 例如它是否包含讨厌的字符（如“）甚至换行符，例如引入新的 HTTP 标头行？
*   查看到达客户端的 HTTP 标头。Firefox 内置信息或使用 LiveHttpHeaders（可在 Mozilla 网站上找到的插件 - 记录所有 HTTP-Headers） - 我确信有更多/其他 FF 插件可用。

希望这可以帮助。

# .net - 字符串到 char* 编组

> ID：269932
> 
> 赞同：3
> 
> 时间：2008-11-06T19:20:21.177
> 
> 标签：.net, c++, managed-c++

我编写了一个托管 C++ 类，它具有以下功能：

```
void EndPointsMappingWrapper::GetLastError(char* strErrorMessage)
{
    strErrorMessage = (char*) Marshal::StringToHGlobalAnsi(_managedObject->GetLastError()).ToPointer();
} 
```

如您所见，这是将最后一个错误的托管字符串复制到非托管世界（`char*`）的简单方法。

从我的非托管类中，我调用这样的方法：

```
char err[1000];
ofer->GetLastError(err); 
```

在托管 C++ 方法处设置断点表明字符串已成功转换为`char*`. 但是，一旦我返回非托管类，内容`err[1000]`就会丢失，并且再次为空。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T19:36:02.267

您正在分配传递参数 (strErrorMessage) 的值，而不是将 Marshal::StringToHGlobalAnsi 返回的缓冲区内容复制到该地址。

正确的实现应该是：

```
void EndPointsMappingWrapper::GetLastError(char* strErrorMessage, int len) 
{ char *str = (char*) Marshal::StringToHGlobalAnsi(_managedObject->GetLastError()).ToPointer(); 
 strncpy(strErrorMessage,str,len);
 strErrorMessage[len-1] = '\0';
 Marshal::FreeHGlobal(IntPtr(str));
} 
```

长度是传递的缓冲区的大小。

`strncpy()` will copy at the most **len** bytes. If there is no null byte among the first n bytes of the **str**, the destination string won't be null terminated. For that reason we force the '\0' in the last byte of the buffer.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T19:28:05.637

我们使用以下 C++ 类为我们进行转换，它工作正常。您应该能够修改您的方法来使用它。

**文件**

```
public ref class  ManagedStringConverter
{
public:
  ManagedStringConverter( System::String^ pString );
  ~ManagedStringConverter();

  property char* PrimitiveString
  {
     char* get() { return m_pString; }
  }

  /// <summary>
  /// Converts a System::String to a char * string.  You must release this with FreeString.
  /// </summary>
  static const char* StringToChar( System::String^ str );

  /// <summary>
  /// Converts a System::String to a __wchar_t * string.  You must release this with FreeString.
  /// </summary>
  static const __wchar_t * StringToWChar( System::String^ str );

  /// <summary>
  /// Frees memory allocated in StringToChar()
  /// </summary>
  static void FreeString( const char * pszStr );

private:
  char* m_pString;
}; 
```

**CPP 文件**

```
ManagedStringConverter::ManagedStringConverter( System::String^ pString )
{
  m_pString = const_cast<char*>( ManagedStringConverter::StringToChar( pString ) );
}

ManagedStringConverter::~ManagedStringConverter()
{
  ManagedStringConverter::FreeString( m_pString );
}

// static
const char * ManagedStringConverter::StringToChar( System::String^ str )
{
  IntPtr^ ip = Marshal::StringToHGlobalAnsi( str );
  if ( ip != IntPtr::Zero )
  {
     return reinterpret_cast<const char *>( ip->ToPointer() );
  }
  else
  {
     return nullptr;
  }
}

// static
const __wchar_t * ManagedStringConverter::StringToWChar( System::String^ str )
{
  IntPtr^ ip = Marshal::StringToHGlobalUni( str );
  if ( ip != IntPtr::Zero )
  {
     return reinterpret_cast<const __wchar_t *>( ip->ToPointer() );
  }
  else
  {
     return nullptr;
  }
}

// static
void ManagedStringConverter::FreeString( const char * pszStr )
{
  IntPtr ip = IntPtr( (void *)pszStr );
  Marshal::FreeHGlobal( ip );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T19:30:21.357

问题是 StringToHGlobalAnsi 创建了一个新的未管理内存，并且不会复制到您打算使用的内存中，而您分配给 strErrorMessage。
要解决此问题，您应该执行以下操作：

```
void EndPointsMappingWrapper::GetLastError(char** strErrorMessage) 
{ 
  *strErrorMessage = (char*) Marshal::StringToHGlobalAnsi(_managedObject->GetLastError()).ToPointer(); 
} 
```

用法应该如下所示：

```
char* err;
GetLastError(&err);

//and here you need to free the error string memory 
```

有关更多信息，请查看此[msdn 文章](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.stringtohglobalansi.aspx)

# sas - sas 单线

> ID：269944
> 
> 赞同：6
> 
> 时间：2008-11-06T19:23:41.027
> 
> 标签：sas, command-line-arguments

有没有办法在 sas 中运行单行，或者我必须创建一个文件？我正在寻找类似于 perl 中的 -e 标志的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-11T23:38:22.337

我最喜欢的是使用 -stdio 选项

任何一个：

```
sas -stdio 
```

然后开始打字。或者 ...

```
echo "proc options; run;" | sas -stdio 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T21:13:19.747

SAS 的 Unix 版本是几年前从 MVS 移植的，长话短说，SAS 可执行文件不会从 STDIN 导入。要在 Unix 中进行这项工作，只需将先前的建议稍微更改为以下内容：

```
echo "your SAS code" > temp;sas -sysin temp 
```

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-11T09:47:38.937

```
sas -initstmt '%put hello world ; endsas ;' 

sas -initstmt 'proc print data=sashelp.class; run ;' 
```

当然，这也可能是：

```
sas -initstmt '%inc large_program.sas; endsas;' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T21:00:44.780

从未使用过 sas，我可能会尝试类似：

```
echo <insert sas code here> | sas --execute-file - 
```

通常，应用程序会让您将“-”指定为文件，以便从 STDIN 读取它。'echo' 只是打印出它的论点，而 | 将它们连接在一起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-06T21:16:42.343

您也可以使用该`-nodms`选项。这将为您提供 Base 的命令行版本。

# ruby-on-rails - label_tag 中的字符无效

> ID：269946
> 
> 赞同：0
> 
> 时间：2008-11-06T19:24:24.460
> 
> 标签：ruby-on-rails, erb

我在 ERB 中构建了一个简单的表单，但是 text_field 标记生成的 HTML 使 label 标记中的*for*属性无效。

```
<div>
  <p><%= label_tag "email[name]", "Name" %></p>
  <%= text_field :email, :name, :class => "text_field" %>
</div> 
```

生成 HTML

```
<div>
  <p><label for="email[name]">Name</label></p>
  <input class="text_field" id="email_name" name="email[name]" size="30" type="text" />
</div> 
```

导致错误

> 属性“for”的值中不允许使用字符“[”。

如何生成没有嵌套参数名称 email[name] 的文本来更改属性的标签*标记*？是否有另一种方法可以生成有效的 HTML？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-06T19:57:36.297

将其从引号中取出，或将 div 内容生成为字符串并将其添加到 div.innerHTML

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T22:10:34.077

for 属性应该引用作为标签的元素的 ID 属性，而不是其名称。

因此，您不需要：

```
<div>
  <p><%= label_tag "email_name", "Name" %></p>
  <%= text_field :email, :name, :class => "text_field" %>
</div> 
```

...？

# sharepoint - 迁移到 Team System 的策略

> ID：269966
> 
> 赞同：6
> 
> 时间：2008-11-06T19:33:07.997
> 
> 标签：sharepoint, visual-studio-2008, version-control, visual-sourcesafe

有没有人有任何迁移到 Team System 的策略/提示/陷阱？应该一步一步完成，还是一次性完成？我们应该迁移我们的 SourceSafe 库，还是在沙子上画一条线并继续前进？是否值得将 SharePoint 纳入其中？任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-06T20:35:24.190

我从来不需要迁移到 TFS，但在过去的几年里我已经非常广泛地使用它。

关于您在 Sharepoint 上的问题，我们发现它与 TFS 结合使用非常有用。我们主要将其用于文档管理和存储与项目相关的其他“非技术”工件。一些开发团队主张将文档与源代码一起保存在源代码控制中，这没问题，但根据我的经验，我们的项目利益相关者通过 Sharepoint 门户访问相关项目文档比他们必须与源代码控制交互更容易。

我基本上能够将与我们的 TFS 团队项目相关联的共享点站点的 URL 分发给相关的非技术团队成员，并且能够避免不断地通过电子邮件发送文档，所以这对我们来说非常棒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-06T22:14:01.167

一次完成所有工作可能太多了。我觉得一次将项目分配给不同的人更容易。这样他们就可以移动它们并确保在关闭 SourceSafe 之前每个都可以正常工作。

为了以防万一，您总是需要对 SourceSafe“数据库”进行备份。

我不知道如何从 SourceSafe 迁移到 TFS 并保留评论和版本。到目前为止，仅添加项目是最简单的，但是过去以这种方式迁移，我们总是错过了找出其他人对特定文件做了什么的能力。如果您找到迁移的方法，除非它非常昂贵，否则我会这样做。

# javascript - 如何防止 jQuery 解析插入的 HTML？

> ID：269974
> 
> 赞同：4
> 
> 时间：2008-11-06T19:36:05.730
> 
> 标签：javascript, jquery, html, dom

有谁知道如何阻止 jQuery 解析您通过 before() 和 after() 插入的 html？假设我有一个元素：

```
<div id='contentdiv'>bla content bla</div> 
```

我想用以下方式包装它：

```
<div id='wrapperDiv'>
    <div id='beforeDiv'></div>
    <div id='contentDiv'>bla content bla</div>
    <div id='afterDiv'></div>
</div> 
```

我使用以下 jQuery/Javascript

```
$('#contentDiv').each( function() {
    var beforeHTML = "<div id='wrapperDiv'><div id='beforeDiv'></div>";
    var afterHTML = "<div id='afterDiv'></div></div>";  
    $(this).before(beforeHTML);
    $(this).after(afterHTML);
} 
```

然而，这不会导致正确的包装，它会创建：

```
<div id='wrapperDiv'>
    <div id='beforeDiv'></div>
</div>
    <div id='contentDiv'>bla content bla</div>
    <div id='afterDiv'></div> 
```

使用 wrap() 也不起作用，因为这会使 jQuery 在使用时更加混乱：

```
$(this).wrap("<div id='wrapperDiv'><div id='beforeDiv'></div><div id='afterDiv'></div></div>"); 
```

我应该如何解决这个问题？
提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-06T20:03:35.083

```
$('#contentDiv').each(function() {
    $(this).wrap('<div id="wrapperDiv">');
    $(this).before('<div id="beforeDiv">');
    $(this).after('<div id="afterDiv">');
}); 
```

产生：

```
<div id='wrapperDiv'>
    <div id='beforeDiv'></div>
    <div id='contentDiv'>bla content bla</div>
    <div id='afterDiv'></div>
</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T19:39:43.540

你的标记不完整......之前和之后只取完整的节点......

您要做的是**包装**您的内容，这是不同的。

你要这个：

.wrap(html);

[http://docs.jquery.com/Manipulation/wrap#html](http://docs.jquery.com/Manipulation/wrap#html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-06T20:00:09.723

我认为你接近它是错误的。想想你真正想要实现的目标......

您想用一个 div 包装所有内容。然后在之前插入 1 个 div，在之后插入 1 个 div。

首先 .wrap() 也是如此，然后相对于 content-div 附加之前和之后的 div。

如果您碰巧将实际的 HTML 作为字符串（来自 XHR 或其他内容），那么您需要按照 Douglas Mayle 的建议读出 html 并自己连接它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T19:51:58.240

对不起，但这应该是显而易见的。在您的情况下，您不能使用 wrap 因为它将原始节点粘贴到它在包装 HTML 中找到的最深节点中。你不想要那个。相反，从您的对象中读出 HTML 并将其与您拥有的内容结合起来：

```
$('#contentDiv').each( function() {
    var beforeHTML = "<div id='wrapperDiv'><div id='beforeDiv'></div>";
    var afterHTML = "<div id='afterDiv'></div></div>";

    // This line below will do it...
    $(this).html(beforeHTML + $(this).html() + afterHTML);
} 
```

# java - 如何计算打开的数据库连接？

> ID：269979
> 
> 赞同：15
> 
> 时间：2008-11-06T19:38:29.360
> 
> 标签：java, mysql, servlets, jdbc

我正在开发一个使用 Java servlet 访问 Mysql 数据库的 Web 应用程序，我如何才能获得当前打开的数据库的连接数？

编辑 ：

我尝试了“show processlist”，它显示：2695159，但这不对，我只是在开发这个新项目，我是唯一的用户，不能运行那么多进程，我想要的是数量访问**我项目数据库**的用户，而不是所有 db 用户的数量，而只是那些登录到我只有一张表的数据库的用户。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2011-09-29T04:35:27.753

根据您的 MySQL 版本，您可以在

`SELECT COUNT(*) FROM information_schema.PROCESSLIST;`

您可以`where`在用户、数据库和主机 IP 之间进行操作。

例如：

```
USE information_schema;
SELECT COUNT(*) FROM PROCESSLIST WHERE db ="mycase" AND HOST LIKE "192.168.11.174%" 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-06T19:50:56.683

您可以使用 MySQL 命令`show processlist`来获取连接数。

但是，这也会向您显示使用相同用户 ID 与数据库建立的任何连接，这些连接可能不是来自您的 servlet。

一般来说，我建议您最好使用连接池对象（请参阅[http://java-source.net/open-source/connection-pools](http://java-source.net/open-source/connection-pools)）来管理与 MySQL 服务器的连接。这可以通过使数据库连接持久化来提高性能，因此您不必总是为每个页面加载新数据库连接的开销。

如果您的 servlet 需要知道连接数，那么您的连接池应该带有一个方法，告诉您当前有多少连接处于活动状态。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-06T20:35:23.753

显示“Threads_connected”之类的状态或显示“Threads_connected”之类的全局状态

不确定这两者在用户上下文中的区别，您可能仍然会遇到这样的问题，即您会看到所有连接，而不仅仅是来自您的应用程序的连接。

您甚至可以检查 Threads_running 以仅查看正在运行的线程（例如不休眠）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-07T13:49:46.030

运行以下查询，它列出了主机名和编号。每个主机的连接数：

SELECT host,count(host) FROM information_schema.processlist GROUP BY host;

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T19:47:12.680

显示进程列表

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-07-23T00:31:42.287

您只能从属于您`Information_Schema.Processlist`的数据中进行选择。这意味着只有当您以 root 身份登录时，您才能使用它进行监控，否则您将看到来自您登录的用户的连接。

如果您想要正确监控 SQL，它将是：

```
SELECT variable_value
FROM INFORMATION_SCHEMA.GLOBAL_STATUS
WHERE variable_name='threads_connected' 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-09-23T01:58:54.243

您还可以通过显示`Threads_connected`变量名称的状态来计算打开的连接，如下所示：

```
SHOW STATUS WHERE variable_name = 'Threads_connected'; 
```

或者您也可以直接从`information_schema.PROCESSLIST`下面计算进程列表：

```
SELECT COUNT(*) FROM information_schema.PROCESSLIST; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-05T04:07:59.413

你可以用这个

显示全球状态；或显示全局状态，如“Threads_connected”；

从连接状态，您可以找出连接总数。

# vbscript - 在 VBScript 中，我需要从 VSS 8“获取最新版本”

> ID：269986
> 
> 赞同：1
> 
> 时间：2008-11-06T19:40:42.257
> 
> 标签：vbscript, visual-sourcesafe

我们的 VSS 设置是这样的：我们有一组独特的文件夹，其中包含 100 多个文件。我需要从 VBScript 中获取一组文件夹中所有文件的最新版本，并将它们放入本地目录，以便可以对它们执行其他操作。VBScript 的原因甚至对我来说也很模糊。也许 VB 或 C# .NET 也可以，但现在我只能在 VBScript 中进行。这是可行的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T13:02:02.110

是的，您可以尝试[VSS 自动化界面](http://msdn.microsoft.com/en-us/library/bb509341.aspx)，或者如果这不起作用，只需使用[VSS 命令行](http://msdn.microsoft.com/en-us/library/asxkfzy4(VS.80).aspx)。

[此链接](http://helpnet.acresso.com/robo/projects/HelpLibDevStudio9/IHelpSccCmdLine.htm)作为一些示例代码可以帮助您入门。

# c# - 如何在.NET 中调用父线程上的函数？

> ID：269988
> 
> 赞同：24
> 
> 时间：2008-11-06T19:40:47.670
> 
> 标签：c#, multithreading

我有一个 .NET 类库，其中包含一个具有执行一些冗长操作的方法的类。当客户端调用此方法时，它应该在新线程上执行冗长的操作，以避免阻塞调用者。但是一旦方法完成，它应该在主线程上执行一些代码。在 WinForms 应用程序中，我可以使用 System.Windows.Forms.Control.Invoke 方法，但这不是我的情况。那么如何在 C# 中实现这一点呢？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2010-07-29T13:41:02.787

`System.Windows.Threading.Dispatcher`您可以使用对象（来自 WindowsBase 程序集）在特定线程上调用函数。

例如：

```
public class ClassCreatedBySomeThread
{
    Dispatcher dispatcher = Dispatcher.CurrentDispatcher; 

    public void SafelyCallMeFromAnyThread(Action a)
    {
       dispatcher.Invoke(a);
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-11-07T14:36:49.487

我找到了一个简单的解决方案：

我的 COM 对象声明如下：

```
public class Runner
{
    public void Run(string executable, object processExitHandler)
    {
        ThreadPool.QueueUserWorkItem(state =>
        {
            var p = new Process()
            {
                StartInfo = new ProcessStartInfo()
                {
                    FileName = executable
                }
            };
            p.Start();
            while (!p.HasExited)
            {
                Thread.Sleep(100);
            }

            state
                .GetType()
                .InvokeMember(
                    "call", 
                    BindingFlags.InvokeMethod, 
                    null, 
                    state, 
                    new object[] { null, p.ExitCode }
                );
        }, processExitHandler);
    }
} 
```

在我的 HTML 页面中，我像这样使用它：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><title>ActiveXRunner</title>    
    <script type="text/javascript">
    function runNotepad() {
        var ax = new ActiveXObject('ActiveXRunner.Runner');
        ax.Run('c:\\windows\\notepad.exe', h);
    }

    function h(exitCode) {
        alert('exitCode = ' + exitCode);
    }
    </script>
</head>
<body>
    <a href="#" onclick="runNotepad();">Run notepad and show exit code when finished</a>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-06T19:44:52.483

如果一个线程必须能够执行由另一个线程发布给它的一些代码（通常以委托的形式），它基本上必须等待这些指令。你的主线程还在做什么？构建一个等效的事件循环并不难（基本上你会有一个生产者/消费者代表队列），但你需要知道你不能只是中断主线程并说“现在就做”。

为什么这必须在主线程上执行？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-06T23:28:40.503

没有办法显式地使代码在特定线程上运行（用于创建 UI 控件的线程除外 - 这是一个例外）但是如果您只是想在线程完成时调用代码以外的代码，您可以使用代表。
首先声明一个委托，其中包含要在新线程上运行的方法的签名......

```
public delegate bool CheckPrimeDelegate(long n); 
```

然后在您的代码中，创建一个委托实例，使用 BeginInvoke 调用它（传递它需要的任何参数）并传递一个回调函数委托（OnChkPrimeDone）

```
class MyClassApp
{
   static void Main() 
   {
      CheckPrimeDelegate ckPrimDel = new CheckPrimeDelegate(Prime.Check);

      // Initiate the operation
      ckPrimDel.BeginInvoke(4501232117, new AsyncCallback(OnChkPrimeDone), null);

      // go do something else . . . .      
   }

   static void OnChkPrimeDone( IAsyncResult iAr)
   {
        AsyncResult ar = iAr as AsynchResult;
         CheckPrimeDelegate ckPrimDel = ar.AsyncDelegate as CheckPrimeDelegate;
         bool isPrime = ckPrimDel.EndInvoke(ar);
         Console.WriteLine(" Number is " + (isPrime? "prime ": "not prime");
   }
} 
```

完成后会调用回调函数（OnChkPrimeDone）

如果您明确需要在用于创建 COM Active-X 对象的线程上运行此回调函数，请检查保存对该对象的引用的 .Net 托管代码包装器变量...如果它有一个名为 InvokeRequired 的方法()，然后，在你的回调函数中，测试这个方法的布尔返回值。
如果它有 InvokeRequired() 方法并返回 true，那么 active-X 对象也将公开一个“BeginInvoke()”方法。然后，创建另一个委托，填充相同的函数，并在 Active-X 对象上调用 BeginInvoke，将这个新委托传递给它......然后它将在用于创建 Active-X 对象的同一线程上运行

```
If (MyActiveXObject.InvokeRequired())
     MyActiveXObject.BeginInvoke(...); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-06T19:48:00.557

一个线程不能只在另一个线程上执行东西。您可以获得的最接近的方法是将委托放在队列中以供其他线程执行，但这假设其他线程正在为此进行合作。

在 WinForms 应用程序中，主循环在每次循环迭代时查找此类排队消息。

如果您只需要传达工作线程的完成情况，您可以使用例如标志变量。如果主线程应该能够等待作业终止，请使用信号量或条件变量（监视器）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-06T19:54:34.290

这是我的确切场景：我有一个作为 COM 对象公开的 .NET 类库（使用 regasm.exe）。COM 对象包含一个运行外部应用程序的方法（使用 Process.Start）。COM 对象用于 Internet Explorer。所以我的网页运行外部应用程序，我需要找到一种方法将 ExitCode 传递给网页。

起初我没有在新线程上启动外部应用程序，只是等待用户关闭应用程序，然后我的函数将 ExitCode 返回给调用者。但是，当应用程序运行时，IE 没有响应。所以我决定在一个新线程中启动应用程序，但现在我不能再返回 ExitCode。

COM 对象是使用：`new ActiveXObject`指令创建的，不幸的是，javascript 不支持事件接收，因此我无法在 C# 中编写应用程序退出时触发的事件。

# xml - XPATH 或 XSL 使用自定义比较匹配两个节点集

> ID：269989
> 
> 赞同：3
> 
> 时间：2008-11-06T19:41:21.163
> 
> 标签：xml, xslt, xpath

**编辑：**我也可以访问[ESXLT](http://www.exslt.org/)功能。

我有两个节点集的字符串标记。一组包含如下值：

```
/Geography/North America/California/San Francisco
/Geography/Asia/Japan/Tokyo/Shinjuku 
```

另一组包含如下值：

```
/Geography/North America/
/Geography/Asia/Japan/ 
```

我的目标是找到两者之间的“匹配”。当第 1 组中的任何字符串以第 2 组中的字符串开头时，就会进行匹配。例如，将在**/Geography/North America/California/San Francisco**和**/Geography/North America/**之间进行匹配，因为来自第 1 组的字符串以第 2 组中的字符串开头。

我可以通过使用第三方扩展来使用通配符比较字符串。我还可以在 Xpath 中使用正则表达式。

我的问题是如何构建 Xpath 以在两组的所有节点之间使用函数进行选择？XSL 也是一个可行的选择。

这个 XPATH：

```
count($set1[.=$set2]) 
```

将产生 set1 和 set2 之间的交集计数，但这是一对一的比较。是否可以使用其他一些方法来比较节点？

编辑：我确实得到了这个工作，但我通过使用其他一些第三方扩展来获得相同的结果来作弊。我仍然对完成这项工作的其他方法感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T19:19:59.117

这：

```
<xsl:variable name="matches" select="$set1[starts-with(., $set2)]"/> 
```

将设置`$matches`为一个节点集，其中包含`$set1`其文本值以 $set2 中节点的文本值开头的每个节点。这就是你要找的，对吧？

**编辑：**

好吧，我只是错了。这就是为什么。

`starts-with`期望它的两个参数都是字符串。如果不是，它将在评估函数之前将它们转换为字符串。

如果你给它一个节点集作为它的参数之一，它使用节点集的字符串值，它是集合中第一个节点的文本值。所以在上面，`$set2`永远不会被搜索；只有列表中的第一个节点会被检查，因此谓词只会找到`$set1`以`$set2`.

我被误导了，因为这种模式（过去几天我一直在使用）*确实*有效：

```
<xsl:variable name="hits" select="$set1[. = $set2]"/> 
```

但是该谓词使用节点集之间的比较，而不是文本值之间的比较。

做到这一点的理想方法是嵌套谓词。也就是说，“我想找到每个节点，`$set1`其中有一个节点`$set2`的值以...开头”，这就是 XPath 崩溃的地方。从什么开始？你想写的是这样的：

```
<xsl:variable name="matches" select="$set1[$set2[starts-with(?, .)]]"/> 
```

只有没有表达式可以编写`?`，它将返回当前由外部谓词测试的节点。（除非我遗漏了一些非常明显的东西。）

为了得到你想要的，你必须单独测试每个节点：

```
<xsl:variable name="matches">
  <xsl:for-each select="$set1">
    <xsl:if test="$set2[starts-with(current(), .)]">
      <xsl:copy-of select="."/>
    </xsl:if>
  </xsl:for-each>
</xsl:variable> 
```

这不是一个非常令人满意的解决方案，因为它评估的是结果树片段，而不是节点集。如果要在 XPath 表达式中使用变量，则必须使用扩展函数（如`msxsl:node-set`）将 RTF 转换为节点集。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-05T23:14:26.663

**有一个简单而纯粹的 XSLT 1.0 解决方案（不需要扩展）来查找匹配数**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text"/>

    <xsl:template match="/">
        <xsl:variable name="vStars">
            <xsl:for-each select="*/regions/*">
                <xsl:for-each select="/*/cities/*[starts-with(.,current())]">
                    <xsl:value-of select="'*'"/>
                </xsl:for-each>
            </xsl:for-each>
        </xsl:variable>

        <xsl:value-of select="string-length($vStars)"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时**：

```
<t>
    <cities>
        <city>/Geography/North America/California/San Francisco</city>
        <city>/Geography/Asia/Japan/Tokyo/Shinjuku</city>
    </cities>
    <regions>
        <region>/Geography/North America/</region>
        <region>/Geography/Asia/Japan/</region>
    </regions>
</t> 
```

**产生正确的结果**：

***2***

**请注意**，为找到的每个匹配项生成一个字符（星号），所有这些星号构成`$vStars`变量的内容。然后我们简单地输出它的`string-length()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-08T22:20:52.373

Robert 的最后一个`xsl:variable`对于获取包含匹配文本值的结果树片段很有用，但除非（如他所建议的那样）您使用 XSLT 1.0 的 EXSLT 或 MS 扩展来将 RTF 转换为节点集，否则您无法计算匹配文本节点。

这是我在之前的回复中提到的 XSLT 样式表，它重复出现在我给出的示例输入文档中，以给出集合 1 中的文本节点的计数，其中集合 2 中的节点与它的部分或全部匹配：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output indent="yes" method="text"/>

  <xsl:template match="/">
    <xsl:call-template name="count-matches">
      <xsl:with-param name="set1-node" select="sets/set[1]/text[1]"/>
      <xsl:with-param name="set2-node" select="sets/set[2]/text[1]"/>
      <xsl:with-param name="total-count" select="0"/>
    </xsl:call-template>
    <xsl:text>
</xsl:text>
  </xsl:template>

  <xsl:template name="count-matches">
    <xsl:param name="set1-node"/>
    <xsl:param name="set2-node"/>
    <xsl:param name="total-count" select="0"/>
    <xsl:variable name="this-count">
      <xsl:choose>
        <xsl:when test="contains($set1-node, $set2-node)">
          <xsl:value-of select="1"/>
        </xsl:when>
        <xsl:otherwise>
          <xsl:value-of select="0"/>
        </xsl:otherwise>
      </xsl:choose>
    </xsl:variable>
    <xsl:choose>
      <xsl:when test="$set2-node/following-sibling::text">
        <xsl:call-template name="count-matches">
          <xsl:with-param name="set1-node"
                          select="$set1-node"/>
          <xsl:with-param name="set2-node"
                          select="$set2-node/following-sibling::text[1]"/>
          <xsl:with-param name="total-count"
                          select="$total-count + $this-count"/>
        </xsl:call-template>
      </xsl:when>
      <xsl:when test="$set1-node/following-sibling::text">
        <xsl:call-template name="count-matches">
          <xsl:with-param name="set1-node"
                          select="$set1-node/following-sibling::text[1]"/>
          <xsl:with-param name="set2-node"
                          select="$set2-node/preceding-sibling::text[last()]"/>
          <xsl:with-param name="total-count"
                          select="$total-count + $this-count"/>
        </xsl:call-template>
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="$total-count + $this-count"/>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

</xsl:stylesheet> 
```

不是特别简洁，但是因为 XSLT 不允许程序员为已经定义的变量分配新值，所以递归通常是必要的。我在 XSLT 1.0 中看不到一种方法来计算 Zack 使用`xsl:for-each`.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-07T23:10:17.220

我想我无法使上面的 XPath 工作。我从以下 XML 文档开始初始化两个节点集：

```
<?xml version="1.0"?>
<sets>
  <set>
    <text>/Geography/North America/California/San Francisco</text>
    <text>/Geography/Asia/Japan/Tokyo/Shinjuku</text>
  </set>
  <set>
    <text>/Geography/North America/</text>
    <text>/Geography/Asia/Japan/</text>
  </set>
</sets> 
```

我认为这个样式表应该实现罗伯特的解决方案，但我只得到'1'的计数：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="text"/>

  <xsl:template match="/">
    <xsl:variable name="set1" select="sets/set[1]/text/text()"/>
    <xsl:variable name="set2" select="sets/set[2]/text/text()"/>
    <xsl:value-of select="count($set1[starts-with(., $set2)])"/>
    <xsl:text>
</xsl:text>
  </xsl:template>

</xsl:stylesheet> 
```

我确实编写了一个使用递归模板的样式表，并且确实使用给定的输入文档生成了正确的“2”计数，但它远没有罗伯特的答案那么优雅。要是我能让 XPath 工作就好了——我总是想学习。

# iis - 使用 WiX 将现有的 Web 服务扩展设置为“允许”

> ID：269991
> 
> 赞同：2
> 
> 时间：2008-11-06T19:42:05.983
> 
> 标签：iis, wix, asp.net-2.0

在 Web Service Extensions 下的 IIS 管理器中，ASP.NET v2.0.50727 默认设置为“禁止”。我想在安装期间将其设置为允许。

我目前使用的是 WiX 版本 2。

我试过使用：

```
<Component Id="Allow_WebServiceExtension_ASP.NET_2.0" DiskId="1" Guid="02247363-E423-41E1-AC15-BEF589B65A4D">
    <WebServiceExtension Id="WebServiceExtension_ASP.NET_2.0" Allow="yes" File="%SystemRoot%\Microsoft.NET\Framework\[DOTNETFRAMEWORKVER]\aspnet_isapi.dll" Description="ASP.NET v2.0.50727" UIDeletable="no" />
</Component> 
```

这会添加第二个 ASP.NET 2.0.50727 条目，但不会启用第一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-03T11:18:36.753

我在使用 wix3 时遇到了同样的问题。由于我还没有找到任何其他解决方案 (??) 我决定也使用自定义操作来完成它。与我使用 c# 和框架 (System.Management) 的 WMI 支持略有不同。 [使用 WMI 配置 IIS](http://msdn.microsoft.com/en-us/library/ms525309.aspx)

好的，我发现我的 Wix 1 中有两个错误。@Group 丢失 -> 我将其设置为“ASP.NET v2.0.50727” 2\. 文件路径错误。我有一个反斜杠。修复这些问题后，wix-iis:WebServiceExtension 对我来说非常完美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T21:06:31.710

使用 WIX 中的[WebApplicationExtension](http://www.wixwiki.com/index.php?title=WebApplicationExtension_Element)元素，它在 IISExtension 中，需要添加对 WIX 项目的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T17:17:51.870

我最终将以下代码放入自定义操作中：

```
Dim WebSvcObj As Object
Dim LocatorObj As Object = CreateObject("WbemScripting.SWbemLocator")
Dim ProviderObj As Object = LocatorObj.ConnectServer(".", "root/MicrosoftIISv2", "", "")
WebSvcObj = ProviderObj.get("IIsWebService='w3svc'")
WebSvcObj.EnableWebServiceExtension("ASP.NET v2.0.50727") 
```

它可能不漂亮，但它确实有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-20T10:18:18.213

我使用 vbScript 修改了代码以启用我的 .NET 4.0 Web 服务扩展：

```
 Dim LocatorObj
    Dim WebSvcObj
    Dim ProviderObj

    Set LocatorObj = CreateObject("WbemScripting.SWbemLocator")
    Set ProviderObj = LocatorObj.ConnectServer(".", "root/MicrosoftIISv2", "", "")
    Set WebSvcObj = ProviderObj.get("IIsWebService='w3svc'")
    WebSvcObj.EnableWebServiceExtension("ASP.NET v4.0.30319") 
```

# c - 需要 JPEG 或其他有损图像压缩库

> ID：269996
> 
> 赞同：3
> 
> 时间：2008-11-06T19:43:30.723
> 
> 标签：c, image, compression, jpeg, gif

我已经将[LIBPNG 和 ZLIB](http://www.libpng.org/pub/png/pngcode.html)合并到我的微控制器项目的 C 软件中，因为它们非常自由的许可证允许这样使用而无需我披露我的任何代码（它与 BSD/MIT/APACHE 非常相似，但没有归属要求）。

我想看看使用有损图像压缩来节省内存。我发现的 JPEG 代码要么是 GPL、LGPL，要么不是 C。我不能使用 LGPL，因为这仍然需要我让用户能够用更新或不同的版本替换库，这是不可能的项目。

我希望你知道一个合适的有损图像压缩库。它不必是JPEG（我控制编码和解码），但它必须是C，并且最多是BSD许可或类似的（归属很好）。

-亚当

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-06T20:03:11.323

试试 IJG（在 ijg.org）。它是高质量的 JPEG 代码，用 C 语言编写，具有 BSD 风格的许可证。我们在我工作的地方使用过它，并且对它很满意。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-06T20:33:30.560

libjpeg ILJ 是 C 源代码并获得自由许可。

[http://www.ijg.org/](http://www.ijg.org/)

“我们发布此软件用于非商业和商业用途。欢迎公司将其用作 JPEG 相关产品的基础。我们不要求版税，但我们确实要求在产品文献中得到确认......”

麦克风

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-08T09:20:44.273

+1[独立 JPEG 组](http://www.ijg.org/)库。

*   它在 C 中
*   高度便携
*   占地面积小
*   自由许可
*   高度重视
*   被广泛使用的
*   稳定（最后一次发布*是****10****多年前***）**

 **Firefox 和 IE 都为 JPEG 浏览器使用 IJG 代码。你没有比这更好的了。

# java - 如何让 log4j 在启动时清除日志？

> ID：269999
> 
> 赞同：39
> 
> 时间：2008-11-06T19:44:30.643
> 
> 标签：java, logging, log4j

只要应用程序正在运行，我希望日志滚动，但我希望日志在应用程序重新启动时重新开始。

*更新：* 根据[erickson 的](https://stackoverflow.com/questions/269999/how-do-i-make-log4j-clear-a-log-at-startup#270026)反馈，我的 appender 如下所示：

```
 <appender name="myRFA" class="org.apache.log4j.RollingFileAppender">
      <param name="File" value="my-server.log"/>
      <param name="Append" value="false" />
      <param name="MaxFileSize" value="10MB"/>
      <param name="MaxBackupIndex" value="10"/>
      <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern"
            value="%d{ISO8601} %p - %t - %c - %m%n"/>
      </layout>
   </appender> 
```

我只是添加了以下行：

```
<param name="Append" value="false" /> 
```

现在它会在启动时截断基本日志文件，但它会单独保留滚动文件。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2008-11-06T19:53:32.277

如果您将`append`参数设置为`false`，则当应用程序重新启动时，基本日志文件将“重新启动”。你的意思是你想删除任何“滚动”的日志文件吗？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T18:58:56.413

我已经编写了一些自定义代码来找到我的`RollingFileAppender`（在 log4j 中访问起来非常困难！），然后我会导致翻转。我已将下面的代码修改为一次性使用。我在应用程序启动时使用与此类似的代码来强制我的日志滚动（如果非空），所以我总是从一个新日志开始，但从不删除任何日志，但最旧的日志除外。

此代码采用给定的 Logger 并循环记录器层次结构，直到找到附加了 Appender 的 Logger。如果它从不这样做，那么它就放弃了。如果是这样，它将遍历附加到该 Logger 的所有 Appender，并且对于每个作为 RollingFileAppender 的 Appender，它会强制日志滚动。

这样的事情在 log4j 中**应该**更容易做到，但我还没有找到更简单的方法。

```
public void rollLogFile(Logger logger) {
  while (logger != null && !logger.getAllAppenders().hasMoreElements()) {
    logger = (Logger)logger.getParent();
  }

  if (logger == null) {
    return;
  }

  for (Enumeration e2 = logger.getAllAppenders(); e2.hasMoreElements();) {
    final Appender appender = (Appender)e2.nextElement();
    if (appender instanceof RollingFileAppender) {
      final RollingFileAppender rfa = (RollingFileAppender)appender;
      final File logFile = new File(rfa.getFile());
      if (logFile.length() > 0) {
        rfa.rollOver();
      }
    }
  }
} 
```***********