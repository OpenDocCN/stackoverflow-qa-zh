# StackOverflow 问答 000647000-000647999

# python - 通过 ssh 和 ftp 在 webfaction 帐户上配置 apache 的工作流程。(django/python)

> ID：647005
> 
> 赞同：0
> 
> 时间：2009-03-15T00:22:06.800
> 
> 标签：python, django, apache, mod-python

但是，在配置 mod_python/apache 或 wsgi/apache 时，我是新手。

我已经能够使用 python 调试器工具..`pdb.set_trace()`成功，特别是在使用 django 开发服务器时，即它向终端输出所有服务器活动，包括 pdb 接口。

那么，当尝试在 webfaction 等主机上部署 django 网站时，如何做这样的事情呢？

除了 ftp 进入 error_log 并阅读有关它的故障后，是否能够与系统交互，因为它正在发生？

希望我在这里足够清楚。

顺便说一句，以下是我要配置的文件。

```
import os
import sys

from os.path import abspath, dirname, join
from site import addsitedir

from django.core.handlers.modpython import ModPythonHandler

import pdb

class PinaxModPythonHandler(ModPythonHandler):
    def __call__(self, req):
        # mod_python fakes the environ, and thus doesn't process SetEnv. 
        # This fixes that. Django will call this again since there is no way
        # of overriding __call__ to just process the request.
        os.environ.update(req.subprocess_env)
        from django.conf import settings

        sys.path.insert(0, abspath(join(dirname(__file__), "../../")))

        sys.path.insert(0, os.path.join(settings.PINAX_ROOT, "apps/external_apps"))
        sys.path.insert(0, os.path.join(settings.PINAX_ROOT, "apps/local_apps"))

        sys.path.insert(0, join(settings.PINAX_ROOT, "apps"))
        sys.path.insert(0, join(settings.PROJECT_ROOT, "apps"))
        pdb.set_trace()

        return super(PinaxModPythonHandler, self).__call__(req)

def handler(req):
    # mod_python hooks into this function.
    return PinaxModPythonHandler()(req) 
```

这是通过http产生的错误页面：

```
MOD_PYTHON ERROR

ProcessId:      318
Interpreter:    'web25.webfaction.com'

ServerName:     'web25.webfaction.com'
DocumentRoot:   '/etc/httpd/htdocs'

URI:            '/'
Location:       '/'
Directory:      None
Filename:       '/etc/httpd/htdocs'
PathInfo:       '/'

Phase:          'PythonHandler'
Handler:        'bc.deploy.modpython'

Traceback (most recent call last):

  File "/home/dalidada/webapps/birthconfidence/lib/python2.5/mod_python/importer.py", line 1537, in HandlerDispatch
    default=default_handler, arg=req, silent=hlist.silent)

  File "/home/dalidada/webapps/birthconfidence/lib/python2.5/mod_python/importer.py", line 1229, in _process_target
    result = _execute_target(config, req, object, arg)

  File "/home/dalidada/webapps/birthconfidence/lib/python2.5/mod_python/importer.py", line 1128, in _execute_target
    result = object(arg)

  File "/home/dalidada/webapps/birthconfidence/bc/deploy/modpython.py", line 33, in handler
    return PinaxModPythonHandler()(req)

  File "/home/dalidada/webapps/birthconfidence/bc/deploy/modpython.py", line 29, in __call__
    return super(PinaxModPythonHandler, self).__call__(req)

  File "/home/dalidada/webapps/birthconfidence/lib/python2.5/django/core/handlers/modpython.py", line 191, in __call__
    self.load_middleware()

  File "/home/dalidada/webapps/birthconfidence/lib/python2.5/django/core/handlers/base.py", line 40, in load_middleware
    raise exceptions.ImproperlyConfigured, 'Error importing middleware %s: "%s"' % (mw_module, e)

ImproperlyConfigured: Error importing middleware django_openid.consumer: "No module named django_openid.consumer" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T01:46:27.440

mod_wsgi 站点上记录了如何将 pdb 与 mod_wsgi 一起使用。看：

[http://code.google.com/p/modwsgi/wiki/DebuggingTechniques#Python_Interactive_Debugger](http://code.google.com/p/modwsgi/wiki/DebuggingTechniques#Python_Interactive_Debugger)

其他调试技术显示在同一页面上。

# java - Java抽象类混淆：未调用覆盖的方法

> ID：647017
> 
> 赞同：3
> 
> 时间：2009-03-15T00:32:09.020
> 
> 标签：java, abstract-class

所以我有两节课。一种是抽象的：

```
public abstract class AbstractClient {
    protected boolean running = true;

    protected void run() {
        Scanner scanner = new Scanner(System.in);
        displayOptions();
        while (running) {
            String input = null;
            while (scanner.hasNext()) {
                input = scanner.next();
            }
            processInputCommand(input);
        }
    }

    abstract void displayOptions();

    abstract void processInputCommand(String input);

} 
```

一个是具体的子类：

```
public class BasicClient extends AbstractClient {
    private IBasicServer basicServer;

    public static void main(String[] args) {
        new BasicClient();
    }

    public BasicClient() {
        try {
            System.setSecurityManager(new RMISecurityManager());
            Registry registry = LocateRegistry.getRegistry();
            basicServer =  (IBasicServer) registry.lookup(IBasicServer.LOOKUPNAME);
            run();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    @Override
    void displayOptions() {
        BasicClientOptions.displayOptions();

    }

    @Override
    void processInputCommand(String input) {
        // TODO Auto-generated method stub

    }
} 
```

现在在子类中，我调用抽象类的 run() 方法，因为这应该对所有客户端都是通用的。run() 方法内部是对抽象方法 displayOptions() 的调用。

我在子类中重写了 displayOptions() 所以我假设它会调用子类方法，但它似乎没有。有没有办法做到这一点，或者我犯了一个明显的错误，或者我误解了抽象类应该如何工作？

PS 我尝试在子类 displayOptions() 中放置一个打印语句，以确保我没有用我调用的方法做一些愚蠢的事情。

非常感谢，

亚当

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T00:42:36.343

你的电话可能有问题`BasicClientOptions.displayOptions()`。我想知道你怎么知道`BasicClient.displayOptions()`没有被调用。

这是您所拥有的简化版本。尝试运行它。它以您期望的方式运行。

```
public abstract class BaseClass {
    public void run() { foo(); }
    public abstract void foo();
}

public class Subclass extends BaseClass {

    public static void main(String[] args) { new Subclass().run(); }

    @Override
    public void foo() {
        System.out.println("I'm from the subclass");
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T03:20:23.813

是不是这些类在不同的包中？如果是这样，您需要将要覆盖的方法声明为受保护。

编辑:(猜一个解释可能会有所帮助:-)

如果您声明一个公共/受保护的方法，那么它可以被包外的子级覆盖。如果您将其设为（包）/私有，则它不能。私有方法根​​本不能被覆盖，哪些（包）方法只能被同一个包中的类覆盖。

我使用 (package) 是因为它没有关键字，所以在没有公共/受保护/私有的情况下，您可以获得 (package) 访问权限。

编辑：

鉴于您的描述，上述情况可能不正确（假设该类确实是抽象的，并且您使用了 @Override 注释）。

你 100% 确定 run 方法被调用了吗？运行 System.out.println 并确保它被调用。

您是否 100% 确定您没有捕获任何其他异常并且未能打印出堆栈跟踪（或其他可以确保您看到异常已被捕获的东西）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-30T19:30:51.353

这个线程已经安静了一段时间，所以我怀疑这会对你有所帮助，但我想我会发布它以防其他人来寻找答案。

直到几分钟前，我还在接口、抽象类和具体子类方面遇到了类似的问题。基本上，接口定义了 10 个方法，抽象类实现其中的 2 个，而将另外 8 个留给具体类。抽象类中的一种方法的实现调用了一个本应由具体类实现的方法。

一切都编译得很好，NetBeans 没有抱怨任何事情，但在运行时 VM 被炸毁，指出该方法（在具体类中实现的方法）不存在。自从我上次使用 Java 以来已经有好几年了，但我很确定这不是这种情况下的预期行为（如果我错了，请有人纠正我）。

经过几个小时的使用笔记本电脑后，我发现将我正在调用的方法的抽象存根添加到抽象类可以将调用转发到具体类，而不会受到 VM 的任何抱怨。这是正常的还是我运气好？

无论如何，希望有人觉得这很有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T00:52:21.670

不确定问题出在哪里，您能否打印一些输出（使用您的打印语句）。

我复制/粘贴了您的代码，除了注释掉我没有正确来源的一两行对象。它为我调用了子类方法。

从逻辑上讲，阅读您的代码似乎没有什么不妥，但我更喜欢亲眼看到东西以确保没有其他问题，因此我尝试先运行您的代码。:)

这是我修改的内容和我的输出。

```
import java.util.Scanner;

public abstract class AbstractClient {
  protected boolean running = true;

  protected void run() {
    Scanner scanner = new Scanner( "foo\\r\\nbar\\r\\n" );
    displayOptions();
    while ( running ) {
      String input = null;
      while ( scanner.hasNext() ) {
        input = scanner.next();
      }
      processInputCommand( input );
      running = false;
    }
  }

  abstract void displayOptions();

  abstract void processInputCommand( String input );

}

import java.rmi.RMISecurityManager;
import java.rmi.registry.LocateRegistry;
import java.rmi.registry.Registry;

public class BasicClient extends AbstractClient {
  //private IBasicServer basicServer;

  public static void main( String[] args ) {
    new BasicClient();
  }

  public BasicClient() {
    try {
      System.setSecurityManager( new RMISecurityManager() );
      Registry registry = LocateRegistry.getRegistry();
      //basicServer =  (IBasicServer) registry.lookup(IBasicServer.LOOKUPNAME);
      run();
    } catch ( Exception e ) {
      e.printStackTrace();
    }
  }

  @Override
  void displayOptions() {
    //BasicClientOptions.displayOptions();
    System.out.println( "We're in subclasses displayOptions()." );
  }

  @Override
  void processInputCommand( String input ) {
    System.out.println( "We're in subclasses processInputCommand()." );
  }
} 
```

我的输出

```
We're in subclasses displayOptions().
We're in subclasses processInputCommand(). 
```

因此，实际上，您的班级似乎正在工作，只是日志可能没有达到标准。

希望这可以帮助。

# objective-c - Objective-C 中指向对象的方法

> ID：647028
> 
> 赞同：2
> 
> 时间：2009-03-15T00:45:07.913
> 
> 标签：objective-c, pointers, object, methods

我使用 spriteclass 创建了一些精灵，并将它们加载到数组中。在我的应用程序中，我循环检查特定条件（位置等）的数组。我想创建一个爆炸方法，我可以将这些对象之一传递给然后使用指针拉动屏幕上对象的位置并在那里显示爆炸。我不知道如何将数组中的指针/对象传递给要使用的方法。

这基本上是我的想法：

```
for (int i=1; i<4; i++) {

    EnemySprite *currentenemy = [enemies objectAtIndex:i-1];

    //Blow this guy up
    [self explosion:currentenemy]
}

-(void)explosion someobject {

    explosion.position = someobject.position

    someobject.setHidden=YES;

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T01:12:08.830

你会这样写一个参数

```
// definition
-(void) explosion:(EnemySprite*) someObject
{

}

// usage
[self explosion: object]; 
```

对于两个参数，事情有点多。考虑;

```
// definition
-(void) explosion:(EnemySprite*) someObject radius:(float)explosionRadius
{
  ...
  if (pos < explosionRadius)
  ...
}

// usage
[self explosion: object radius:10.0f]; 
```

: 之前的所有内容都用于外部名称，之后的所有内容都是函数内部的名称。

这就是为什么你会经常看到 Objective-C 函数的函数名称以第一种类型的名称结尾：

```
-(void) explodeSprite:(EnemySprite*) sprite radius:(float)radius; 
```

在编写函数时，精灵和半径参数似乎都被“命名”了；

```
[self explodeSprite:sprite radius:10.0f]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T13:32:00.237

为什么不让你的物体成为爆炸的接收器呢？

```
for (id currentenemy in enemies)
{
    [currentenemy explode];
} 
```

# matlab - 按字典顺序列出数字 1,...,n 的所有排列

> ID：647030
> 
> 赞同：2
> 
> 时间：2009-03-15T00:48:42.867
> 
> 标签：matlab, swap, lexicographic

我正在尝试编写一个 Matlab 以按字典顺序列出数字 1 到 n 的所有排列。到目前为止我所拥有的如下。我正在使用递归来尝试编写一个首先适用于 n=3 的程序，然后看看我是否可以深入了解为任何 n 编写程序。到目前为止，对于 n=3: ，我有 6 列中的 2 列`P=[1 2 3;1 3 2]`。我需要接下来的两列来简单地交换一个和两个。我不知道如何开始这样做。

```
function [P] = shoes(n)

if n == 1
    P = 1;
elseif n == 2
    P = [1 2; 2 1];
else 
    T = shoes(n-1) + 1;
    G = ones(factorial(n-1),1);
    P(1:2,1:3) = [G T];               
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T00:55:14.817

请参阅[文档](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/perms.html)开始。如果按字典顺序，您的意思是按英文名称的字母顺序，您可能希望用名称填充您的输入，对它们进行排序，然后对其进行置换。

如果我误解了您想要的内容，请发表评论或编辑问题，稍后我会回来查看。

提示：

*   空列表的排列很容易找到。
*   归纳是数学中的一个重要概念。你应该熟悉它。
*   您工作的环境支持递归
*   较长列表的排列可以通过递归按照您想要的顺序产生；首先弄清楚你想要第一个元素是什么，然后找出其余的。

如果您再次陷入困境，请编辑发布您到目前为止所获得的内容以及您认为自己陷入困境的位置/原因的问题。

看到你的代码后的提示。

*   您的核心函数置换一个向量，因此应该将向量作为参数，而不是整数
*   不要开始解决 n=3 的情况；尝试 n=0 的情况（它是 []），然后直接转到 n=20 的情况。
*   在编写任何代码之前，请考虑 n=20 的情况。第一列会是什么样子？在 n=20 案例的答案中是否隐藏了 n=19 案例的示例？（答案是肯定的，而且它们都是不同的）。
*   重读第一组提示

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T18:06:42.887

你似乎已经问过这个问题[两次了](https://stackoverflow.com/questions/647042/matlab-swap)。无需重新发布问题，您只需单击问题下方的“编辑”链接并进行更新。我将在此处重新发布我对您的另一个问题的回答，但您确实应该删除其中一个。

* * *

如果您有以下矩阵：

```
A = [1 2 3; 1 3 2]; 
```

并且您希望所有的都变成二，而二的变成一，以下将是最简单的方法：

```
B = A;
B(A == 1) = 2;
B(A == 2) = 1; 
```

# bash - 无法更改终端中的默认编辑器

> ID：647032
> 
> 赞同：40
> 
> 时间：2009-03-15T00:50:05.267
> 
> 标签：bash, vim

我的默认编辑器是我服务器上的[Pico](https://en.wikipedia.org/wiki/Pico_(text_editor))。我使用 Bash 和 Linux。

我试图通过以下方式将 Vim 更改为我的默认编辑器，但未成功：

```
echo vim > $EDITOR 
```

如何将 Vim 更改为我的默认编辑器？

*[以下代码在文件.bashrc](https://en.wikipedia.org/wiki/Bash_(Unix_shell)#Legacy-compatible_Bash_startup_example)*中不起作用：

```
export EDITOR='vim' 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2009-03-24T15:47:16.110

添加

```
export EDITOR=vim 
```

到你的*.bashrc*文件应该真的可以解决问题。（那里不需要引号，根据您使用的引号，它们可能是您问题的原因。）

*修改文件.bashrc*后必须打开一个新的 shell（或`source ~/.bashrc`在提示符处输入）才能使修改生效。

 *您希望从哪个程序启动 Vim？

我没有使用过 Git，但[文档](http://www.kernel.org/pub/software/scm/git/docs/git-commit.html)中写道：

> 用于编辑提交日志消息的编辑器将从 GIT_EDITOR 环境变量、core.editor 配置变量、VISUAL 环境变量或 EDITOR 环境变量（按此顺序）中选择。

所以检查是否设置了这些变量之一：

```
echo $GIT_EDITOR $VISUAL $EDITOR
git config --get-all core.editor 
```

为了我，

```
export VISUAL=vim 
```

解决了这个问题。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2011-03-24T12:38:38.387

您可以使用 Git 配置选项*core.editor*来设置您喜欢的编辑器，例如[nano](https://en.wikipedia.org/wiki/GNU_nano)：

```
git config [--global] core.editor "nano" 
```

如果您没有 shell 访问权限，您还可以通过编辑主目录（全局）或 git 存储库（如果不存在，则创建它）中的*.gitconfig文件来更改此设置：*

```
...
[user]
  name = Your Name
  email = your@email.address
[core]
  editor = nano
... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T00:51:09.350

```
vim=/usr/bin/vim # Or wherever the Vim binary is
export EDITOR=vim 
```

应该做的工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T01:01:30.247

我没有`EDITOR`环境变量。我的`.bashrc`文件确实定义了这个：

```
alias vi='vim' 
```

据推测，如果 Vim 在您的主目录中找不到名为的文件`.vimrc`，它将以“兼容模式”运行，并且您只能获得 vi 功能，直到您说 type `:nocp`。

如果它基于您的`EDITOR`环境变量，您可以在 Bash 中这样设置：

```
export EDITOR='vim' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-28T12:32:19.643

检查这个命令：

```
sudo update-alternatives --config editor 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-22T18:46:49.030

由于 Mac OS X 中的情况发生了变化，因此您必须在用户基本目录的*.profile文件中添加以下内容：*

```
export EDITOR='vim' 
```

您可以按照以下说明进行操作：

1.  打开终端

2.  类型`cd` （点击`Return`或`Enter`（这将带您到基本目录））

3.  输入`echo "export EDITOR='vim'" >> .profile`（点击`Return`或`Enter`完成）

4.  （重启终端）

==========================

*或者*只需输入：

```
echo "export EDITOR='vim'" >> ~/.profile 
```

击中`Enter`并重新启动。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-17T07:03:32.560

由于这些答案都没有帮助我：

这是 Git 文档所说的*[git-commit(1) 手册页](http://www.kernel.org/pub/software/scm/git/docs/git-commit.html)*：

> 用于编辑提交日志消息的编辑器将从 GIT_EDITOR 环境变量、core.editor 配置变量、VISUAL 环境变量或 EDITOR 环境变量（按此顺序）中选择。

这是导出的 Bash[手册页](https://en.wikipedia.org/wiki/Man_page)摘录（括号是可选的）：

```
export [-fn] [name[=word]] 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-07T02:12:51.920

如果您希望[vi](https://en.wikipedia.org/wiki/Vi)成为您的默认历史编辑器（这就是我在这里的原因）：

编辑文件*~/.bashrc*并添加

> 设置-o vi

文件中的任何位置。然后所有可爱的*vi*命令历史都可用（`Esc`+`K`等）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-11T06:36:15.797

在设置我的新 MacBook Pro 时，我遇到了同样的挑战。

**这是我解决它的方法**

要在 MacBook 上切换到您选择的编辑器（比如[nano](https://en.wikipedia.org/wiki/GNU_nano) ），如果您的默认 shell 是或默认 shell 是，您需要将以下行添加到`~/.zshrc`文件中：`zsh``~/.bash_profile``bash`

```
export EDITOR=nano
export VISUAL="$EDITOR" 
```

但是，一个更简单的方法是使用`echo`命令将它们插入到您的`~/.zshrc`文件中，如果您的默认 shell 是`zsh`：

```
echo 'export EDITOR=nano' >> ~/.zshrc
echo 'export VISUAL="$EDITOR"' >> ~/.zshrc 
```

或者`~/.bashrc`，如果您的默认外壳是`bash`：

```
echo 'export EDITOR=nano' >> ~/.bash_profile
echo 'export VISUAL="$EDITOR"' >> ~/.bash_profile 
```

运行以下命令以激活新配置：

```
source ~/.zshrc 
```

*或者*

```
source ~/.bash_profile 
```

如果您需要切换到其他选择的编辑器，您可以`nano`用您喜欢的编辑器替换：

*   维姆 -`vim`
*   Ⅵ -`vi`

就这样。

# asp.net - 如何使用我的应用程序支持匿名用户？

> ID：647038
> 
> 赞同：0
> 
> 时间：2009-03-15T00:55:31.930
> 
> 标签：asp.net, authentication, membership, anonymous

我需要实现一个支持匿名用户的用户认证系统，就像这个网站的工作方式一样。可以使用默认的 asp.net 会员提供程序来完成吗？如果没有，我需要做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T01:02:19.260

是的，这是可以做到的。一旦用户登录，甚至还有一个迁移匿名用户详细信息的特殊事件：http: [//msdn.microsoft.com/en-us/library/system.web.profile.profilemodule.migrateanonymous.aspx](http://msdn.microsoft.com/en-us/library/system.web.profile.profilemodule.migrateanonymous.aspx)

# c# - 所有域实体对象的抽象基类

> ID：647039
> 
> 赞同：5
> 
> 时间：2009-03-15T00:56:26.060
> 
> 标签：c#, domain-driven-design

我在一些域对象模型中看到，为所有域实体对象创建了一个抽象基类（实现 Equals 和 GetHashCode），以便从中继承以获得它们的身份。

我不清楚为什么需要这个基类以及何时以及为什么应该使用它。你能给我一些关于这个的见解或者给我一个关于这个的链接吗

谢谢

现在我了解了覆盖平等的优势（此链接帮助[http://en.csharp-online.net/CSharp_Canonical_Forms](http://en.csharp-online.net/CSharp_Canonical_Forms) —Identity_Equality）

回到领域驱动设计，我想稍微扩展一下我的问题；

我有一个客户实体，我使用 guid 作为身份。

如果我创建 2 个具有完全相同细节的客户实例，因为我使用 guid 作为身份，它们将是两个不同的对象。但是由于它们的所有属性都相同，它们应该是同一个对象（或者保持它们的唯一性和独立性是更好的 ddd 实践吗？？）

试图了解我是否应该通过它们的完整属性值匹配来处理两个对象的相等性。如果我朝着那个方向前进，那么我正在考虑在子类级别上覆盖基类的平等并实现这些条件，或者将实体的身份作为字符串或哈希码（？）表示所有的值这些属性并使用基类的 Equality。

我可能不会在这里，所以提前感谢您的耐心。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T13:39:21.927

术语**相等**的使用在这里被重载：

*1)身份*平等

 *如果您有同一个客户的 2 个实例，它们都应该具有相同的 GUID 值——这是确保您使用同一个实体的唯一方法。实际上，总会有相同实体的不同实例（例如，在不同机器上运行的多用户应用程序）。

*2)相同*的平等

 *这是您检查 2 个实例是否具有所有相同值的地方。例如，如果 2 名员工正在查看同一个客户，并且第一个人修改并保存它，那么两个人将看到不同的数据。他们都对同一个客户感兴趣，但数据变得陈旧。

对于 (2)，您肯定需要一种机制来进行检查。您可以比较每个属性（昂贵），或者您可以使用“版本”属性来检测更改（请参阅[NHibernate 的乐观锁定机制](https://stackoverflow.com/questions/118526/how-do-you-deal-with-concurrency-in-nhibernate)）。

我认为你的例子有点做作，可能会让你远离 DDD 更重要的方面。如果您有兴趣，[我会出售一个](http://www.evolving-software.co.uk)可以帮助您更轻松地掌握 DDD 概念的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-08T16:54:15.140

如果它们是实体，则应比较对象的 ID，如果它们是值对象，则应比较它们的属性。这意味着您不必从基本实体继承值对象，但对于实体，最好创建一个。

如何理解一个类是实体还是值对象？您应该回答一个问题：如果此类对象具有相同的属性集，它们是否相等？如果是，它们是值对象。例如，即使两个人的姓名和出生日期相同，他们也不相等——无论如何，您都应该将他们视为不同的实体。但如果你有 25 美分硬币，你可能不在乎你有什么**确切**的金属，它们都只是 25 美分硬币。

有一篇很棒的文章描述了细节：[领域对象基类](http://enterprisecraftsmanship.com/2014/11/08/domain-object-base-class/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-24T14:08:27.363

如果您正在关注 DDD，我相信您应该通过对象的 ID（身份）检查对象的相等性。这是因为域实体主要是通过其身份而不是属性来定义和跟踪的。因此，无论它们与其他对象有多么相似，它们仍然是不同的实体。

您要检查的另一个概念是值对象。它描述了对象的特性，不需要身份。例如，地址、金钱、颜色。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T01:52:13.307

您指出了使用它的两个原因。

对于 Equals，您可能不想总是检查实际引用是否相等，因为它可能不相等。您可能希望使用某种识别属性（如 public int ID）来检查 2 个实体是否相等。Equals 的基本实现只是检查两个引用是否相等。

就哈希码而言，它是一种在哈希算法等中使用给定对象/类型时唯一标识给定对象/类型的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-24T10:43:33.347

我将只检查身份，因为它允许您拥有一个包含前后情况的实体实例，这有时非常方便。要检查实例是否已更改，可以使用 Dirty 标志。

HTH，乔纳森

# python - 需要一个使用 Python 中的 Webkit 库的简单“Hello World”示例

> ID：647041
> 
> 赞同：14
> 
> 时间：2009-03-15T01:00:46.283
> 
> 标签：python, webkit

有谁知道在 Python 中使用 Webkit 库的简单“Hello World”示例？我有一个 GTK 窗口，我想在里面放 Webkit。

使用 Python/mozembed (Mozilla/Gecko)，这很简单：

```
mozembed = gtkmozembed.MozEmbed()
mozembed.load_url('http://google.com/') 
```

..我已经创建了我的浏览器，我如何使用 WebKit 做到这一点？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-15T02:11:25.833

您是否检查了[WebKit GTK+ 端口的 Python 绑定](http://code.google.com/p/pywebkitgtk/)。在其中一个目录中有关于如何使用它的演示，包括浏览器：python demos/tabbed_browser.py

您还可以查看 Alp Toker 在[WebKit GTK+](http://www.atoker.com/webkit/webkitgtk-fosdem08.pdf) (pdf) 开发混合 Web/GTK+ 富互联网应用程序上的 FOSDEM 幻灯片。

```
import gtk 
import webkit 

view = webkit.WebView() 

sw = gtk.ScrolledWindow() 
sw.add(view) 

win = gtk.Window(gtk.WINDOW_TOPLEVEL) 
win.add(sw) 
win.show_all() 

view.open("http://w3.org/") 
gtk.main() 
```

这应该会给你很好的开始提示。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-08-12T16:57:25.210

现在使用 WebKitGtk2

```
import gi
gi.require_version('Gtk', '3.0')
gi.require_version('WebKit2', '4.0')

from gi.repository import Gtk, WebKit2

window = Gtk.Window()
window.set_default_size(800, 600)
window.connect("destroy", Gtk.main_quit)

scrolled_window = Gtk.ScrolledWindow()
webview = WebKit2.WebView()
webview.load_uri("https://google.cl")
scrolled_window.add(webview)

window.add(scrolled_window)
window.show_all()
Gtk.main() 
```

# matlab - Matlab交换

> ID：647042
> 
> 赞同：4
> 
> 时间：2009-03-15T01:00:51.730
> 
> 标签：matlab, matrix, swap

我正在尝试创建一个函数，它将矩阵中的特定数字与同一矩阵中的特定数字交换。例如，如果我从 A = [1 2 3;1 3 2] 开始，我希望能够创建 B = [2 1 3; 2 3 1]，只需告诉 matlab 将 1 与 2 交换即可。任何意见，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T17:55:19.683

如果您有以下矩阵：

```
A = [1 2 3; 1 3 2]; 
```

并且您希望所有的都变成二，而二的变成一，以下将是最简单的方法：

```
B = A;
B(find(A == 1)) = 2;
B(find(A == 2)) = 1; 
```

编辑：

正如 Kenny 所建议的，这甚至可以进一步简化为：

```
B = A;
B(A == 1) = 2;
B(A == 2) = 1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-22T14:16:15.830

处理原始问题的另一种方法是创建一个**置换向量**，指示原始条目应映射到哪些数字。例如，条目 [1 2 3] 应该分别映射到 [2 1 3]，这样我们就可以写

```
A = [1 2 3; 1 3 2];
perm = [2 1 3];
B = perm(A) 
```

（这里的优点是一切都在一个步骤中完成，并且它也适用于比 swaps 更复杂的操作；缺点是 A 的所有元素必须是具有已知最大值的正整数）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-16T13:59:25.187

```
A = [1 2 3; 1 3 2]

alpha = 1;
beta = 2;

indAlpha = (A == alpha);
indBeta  = (A == beta);

A(indAlpha) = beta;
A(indBeta ) = alpha 
```

我喜欢这个解决方案，它使发生的事情更清楚。更少的幻数，可以很容易地变成一个函数。如果这很重要，则回收相同的矩阵。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T02:24:03.260

不知道为什么要执行特定的交换（行/列交换更常见）。Matlab 经常用 ':' 来表示所有的东西。以下是交换行和列的方法：

要交换行：

```
A = A([New order of rows,,...], :) 
```

交换列：

```
A = A(:, [New order of columns,,...]) 
```

要更改整个第 i 列：

```
A(:, i) = [New; values; for; i-th; column] 
```

例如，交换 A = [1 2 3;1 3 2] 的第 2 列和第 3 列

```
A = A(:, [1, 3, 2]) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T02:13:22.273

我没有安装 MatLab 的副本，但我认为你可以做这样的事情；

```
for i=1:length(A)
   if (A(i)=1), B(i) = 2, B(i)=A(i) 
end 
```

请注意，这只是将 1 转换为 2，看起来您还想将 2 转换为 1，因此您需要做更多的工作。

考虑到你可以在 Matlab 中做这种事情，可能还有一种更优雅的方法

```
>> A = 1:1:3
A = [1,2,3]
>> B = A * 2
B = [2,4,6] 
```

可能有一个可以使用的 swapif 原语，但我很长时间没有使用 Matlab，所以我不确定最好的方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T04:01:05.680

参考[tarn](https://stackoverflow.com/questions/647042/matlab-swap/647125#647125)更优雅的值交换方式，您可以使用如下*置换矩阵：*

```
>> a =[1 2 3];
>> T = [1 0 0;
        0 0 1;
        0 1 0];
>> b = a*T
ans =
    1 3 2 
```

但这将交换向量（矩阵）*a*的第 2 列和第 3 列；而问题是关于交换 1 和 2 的问题。

**更新**

要交换两个不同值的元素，请查看 find 函数

> > ind = 查找（a==1）；

返回值为 1 的所有元素的索引。然后您可以使用[Mitch 的](https://stackoverflow.com/questions/647042/matlab-swap/647143#647143)建议使用索引数组更改元素的值。记住 find 将线性索引返回到矩阵中；第一个元素的索引为 1，*nxm*矩阵的最后一个元素的线性索引为*n*m*。线性索引按列倒数。例如

```
>> b = [1 3 5;2 4 6];
>> b(3) % same as b(1,2)
ans = 3
>> b(5) % same as b(1,3)
ans = 5
>> b(6) % same as b(2,3)
ans = 6 
```

# vim - 无法计算 Vim 中的匹配数

> ID：647049
> 
> 赞同：9
> 
> 时间：2009-03-15T01:05:10.893
> 
> 标签：vim, count, match

你如何计算 Vim 中的匹配数？

例如，对于文本

```
<? 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-15T01:19:04.430

```
:%s/<?//ng 
```

见`:h count-items`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-15T01:21:32.443

[Count-items](http://vimdoc.sourceforge.net/htmldoc/tips.html#count-items)描述了你所追求的。

```
:%s/<?/whatever/ng 
```

这是替换命令，但 n 标志避免了实际替换。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T21:54:22.987

```
:help count-items 
```

在 VIM 6.3 中，你会这样做：

```
:set report=0
:%s/<?/&/g   # returns the count without substitution 
```

在 VIM 7.2 中，你会这样做：

```
:%s/<?/&/gn   # returns the count without substitution 
```

# c# - 如何获得 Expression Blend Keyspline 控件？

> ID：647050
> 
> 赞同：0
> 
> 时间：2009-03-15T01:06:10.810
> 
> 标签：c#, .net, controls

我的 C# 程序中需要一个控件，其行为与 MS Expression Blend keyspline 控件完全相同 - 有没有办法获取该控件并将其添加到我的应用程序中？

作为旁注，最好使用该应用程序中出现的其他一些控件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-15T14:03:45.747

好的，很抱歉使用了错误的术语。

我想将控件添加到 Visual Studio 2005 的工具箱（或者实际上是 Expression Blend 的资产库）中，以便我可以将它拖放到我创建的任何 C# WPF 应用程序中。

问题是我不知道 Expression Blend Keyspline 控件被称为什么以及如何访问它（即包含什么 dll 作为参考）？

我可以尝试通过 Expression Blend 的 dll 等搜索控件，但我不确定 A）这是否可行，B）它有点冗长，C）此类控件的许可是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T14:14:03.023

我认为您想要做的是添加一个故事板，然后您可以在其中选择为您的不同控件设置动画，包括 KeySplines。KeySpline 本身实际上并不是控件，它是作用于控件的动画。

要添加情节提要，请单击“对象和时间线”面板顶部的小加号图标（右侧显示“未打开情节提要”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T01:40:01.527

将其添加到您的应用程序是什么意思？如果您正在开发 C# WPF 应用程序，您已经可以使用 Blend 设计器或在 Visual Studio 中以编程方式添加它。

如果需要，您可以从所有 WPF 控件继承以创建新的以增强行为的控件。如果您只是想自定义控件的感觉，您可以使用 Expression Blend 中的样式。如果您想自定义控件的完整外观、感觉和行为，您还可以选择模板。

# c++ - 将 std::map 移植到 C？

> ID：647054
> 
> 赞同：25
> 
> 时间：2009-03-15T01:11:06.447
> 
> 标签：c++, c, porting

我正在将一些 c++ 代码移植到 c。什么是 c 中 std::map 的可行等价物？我知道c中没有等价物。

这就是我正在考虑使用的：

在 C++ 中：

```
std::map< uint, sTexture > m_Textures; 
```

在 c 中：

```
typedef struct
{
  uint* intKey;
  sTexture* textureValue;
} sTMTextureMap; 
```

这是可行的还是我过于简化地图？以防万一您没有得到纹理贴图的目的。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-15T02:18:39.873

许多 C 实现支持 tsearch(3) 或 hsearch(3)。tsearch(3) 是一棵二叉树，您可以提供一个比较器回调。我认为这与您接近 std::map 的距离差不多。

这是一些c99示例代码

```
#include <search.h>
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

typedef struct
{
      int key;
      char* value;
} intStrMap;

int compar(const void *l, const void *r)
{
    const intStrMap *lm = l;
    const intStrMap *lr = r;
    return lm->key - lr->key;
}

int main(int argc, char **argv)
{
    void *root = 0;

    intStrMap *a = malloc(sizeof(intStrMap));
    a->key = 2;
    a->value = strdup("two");
    tsearch(a, &root, compar); /* insert */

    intStrMap *find_a = malloc(sizeof(intStrMap));
    find_a->key = 2;

    void *r = tfind(find_a, &root, compar); /* read */
    printf("%s", (*(intStrMap**)r)->value);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2010-10-01T15:19:04.607

你为什么不直接包装一个 C 接口`std::map`呢？即在自己的模块中编写一些 C++ 函数：

```
typedef std::map<int, char*> Map;

extern "C" {

void* map_create() {
  return reinterpret_cast<void*> (new Map);
}

void map_put(void* map, int k, char* v) {
  Map* m = reinterpret_cast<Map*> (map);
  m->insert(std::pair<int, char*>(k, v));
}

// etc...

} // extern "C" 
```

然后链接到您的 C 应用程序。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-15T01:30:39.800

这当然是一种可能的实现方式。您可能需要考虑如何实现索引以及这将对性能产生什么影响。例如，您可以让 intKey 列表成为键的排序列表。查找一个键需要 O(log N) 时间，但插入一个新项目需要 O(N)。

您可以将它实现为一棵树（如 std::map），然后您将进行 O(log N) 插入和查找。

另一种选择是将其实现为哈希表，这将具有更好的运行时性能，假设一个好的哈希函数和一个足够稀疏的 intKey 数组。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-15T02:08:50.910

您可以根据自己的选择实施它。如果您使用链表方法，您的插入将是 O(1)，但您的检索和删除将是 O(n)。如果您使用更复杂的东西，例如红黑树，您将获得更好的平均性能。

如果你自己实现它，链表可能是最简单的，否则从互联网上获取一些适当许可的红黑树或其他类型的树将是最好的选择。不建议实现自己的红黑树......我已经这样做了，不想再这样做了。

并且回答一个你没有问过的问题：也许你应该重新检查从 C++ 移植到 C 是否真的提供了你想要的所有好处。当然，在某些情况下它可能是必要的，但并不多。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-04-12T13:41:01.567

我尝试在 C 中实现地图，它基于 void *

[https://github.com/davinash/cstl](https://github.com/davinash/cstl)

它正在进行中，但地图已完成。

[https://github.com/davinash/cstl/blob/master/src/c_map.c](https://github.com/davinash/cstl/blob/master/src/c_map.c)

它是基于红黑树编写的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T01:13:49.593

C 中没有提供类似于地图的功能的标准库。您将需要使用某种形式的容器来实现您自己的类似地图的功能，该容器支持通过键访问元素。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T01:46:49.590

人 dbopen

提供 NULL 作为文件参数，它将成为键/值数据的仅内存容器。

还有各种 Berkeley 数据库库接口具有类似的键/值功能（man dbm，从 Sleepycat 中查看 BerkeleyDB，尝试一些搜索等）。

# python - 来自字符串源的 Python xml ElementTree？

> ID：647071
> 
> 赞同：157
> 
> 时间：2009-03-15T01:24:19.380
> 
> 标签：python, xml

ElementTree.parse 从文件中读取，如果我已经在字符串中有 XML 数据，我该如何使用它？

也许我在这里遗漏了一些东西，但必须有一种方法可以使用 ElementTree 而无需将字符串写入文件并再次读取它。

[xml.etree.elementtree](http://docs.python.org/library/xml.etree.elementtree.html)

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2013-08-16T20:09:47.080

您可以将文本解析为字符串，从而创建一个元素，并使用该元素创建一个 ElementTree。

```
import xml.etree.ElementTree as ET
tree = ET.ElementTree(ET.fromstring(xmlstring)) 
```

[`parse()`](https://docs.python.org/library/xml.etree.elementtree.html#xml.etree.ElementTree.parse)我刚刚遇到了这个问题，并且文档虽然完整，但对于and[`fromstring()`](https://docs.python.org/library/xml.etree.elementtree.html#xml.etree.ElementTree.fromstring)方法之间的用法差异并不是很直接。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2009-03-15T01:36:44.590

如果您`xml.etree.ElementTree.parse`用于从文件中解析，那么您可以使用`xml.etree.ElementTree.fromstring`来获取文档的根目录`Element`。通常你实际上并不需要一个`ElementTree`.

请参见[xml.etree.ElementTree](http://docs.python.org/library/xml.etree.elementtree.html)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-15T01:37:22.467

你需要`xml.etree.ElementTree.fromstring(text)`

```
from xml.etree.ElementTree import XML, fromstring
myxml = fromstring(text) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-12-30T09:36:19.200

[io.StringIO](https://docs.python.org/library/io.html#io.StringIO)是将 XML 导入[xml.etree.ElementTree](https://docs.python.org/3/library/xml.etree.elementtree.html)的另一种选择：

```
import io
f = io.StringIO(xmlstring)
tree = ET.parse(f)
root = tree.getroot() 
```

但是，它不会影响人们假设的 XML 声明`tree`（尽管[ElementTree.write()](https://docs.python.org/3/library/xml.etree.elementtree.html#xml.etree.ElementTree.ElementTree.write)需要这样做）。请参阅[如何使用 xml.etree.ElementTree 编写 XML 声明](https://stackoverflow.com/questions/15356641/how-to-write-xml-declaration-using-xml-etree-elementtree)。

# c++ - 如何制作 Linux C++ GUI 应用程序

> ID：647074
> 
> 赞同：23
> 
> 时间：2009-03-15T01:27:29.263
> 
> 标签：c++, user-interface, ubuntu, gnome

制作 Linux C++ GUI 应用程序的最简单方法是什么？我正在使用 GNOME 和 ubuntu 8.10。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-15T11:41:10.427

最简单的方法是使用 GUI GUI builder。

[GTK](http://glade.gnome.org/)的空地。

[QT 的 QT 设计器](http://www.qtsoftware.com/products/developer-tools?currentflipperobject=937ba3e952f85ef68ddbb7cb4b20fc19)。

[wxWidgets](http://www.wxwidgets.org/)的[wxDesigner](http://www.roebling.de/)和[wxFormBuilder](http://www.wxformbuilder.org/)。

更新：我应该提到这些输出 C++ 等等？

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-15T01:30:31.113

我个人更喜欢 QT，因为我更喜欢使用信号/插槽机制，并且发现使用它可以轻松快速地开发应用程序。您的其他一些选择是 wxWidgets 和 GTK+。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-15T01:31:18.880

gtkmm 是与 gtk 的 c++ 绑定，它应该可以正常工作

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-15T11:53:19.413

只是要清楚到目前为止提到的工具包（GTK+、QT 和 wxWidgets）

GTK+ 是 GNOME 使用的工具包

QT是KDE使用的工具包

wxWidget 旨在成为那些（和其他）之上的抽象，以减少桌面环境的特定性。

另一个值得一看的工具包是[EFL](http://web.enlightenment.org/p.php?p=docs&l=en)，E17 使用的工具包，虽然这个桌面环境的冰川开发速度可能会让你望而却步，我听说它的设计很好。请注意，Enlightenment 项目中的某些组件（例如 imlib2）已被其他项目使用多年。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-15T01:42:03.410

试试 QT，它可以在 Ubuntu 上运行，并且有很多开发工具和文档支持。

例如一个[教程](http://doc.trolltech.com/4.3/tutorial.html)，或者另一个[教程](http://www.digitalfanatics.org/projects/qt_tutorial/)，或者另一个[教程](http://sector.ynet.sk/qt4-tutorial/my-first-qt-gui-application.html)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-12-30T00:16:18.687

我建议[Juce](http://www.rawmaterialsoftware.com/juce.php)。它优雅、跨平台、快速、编写良好、几乎完全没有错误，并且与它运行的每个平台上的最后一个像素相同。*已知*错误的数量几乎总是为零，因为当提交错误报告时，作者会丢弃所有内容并修复它！[The Register](http://www.theregister.co.uk/2006/12/18/juce_cross_platform/)不久前写了一篇关于它的文章，对图书馆进行了很好的概述。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-15T02:31:31.887

我个人可以保证总体上 qt 的易用性，以及 linux 特定的开发。看看这个 ：）

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-02-09T15:25:54.423

最**简单**的方法绝对是[Ultimate++](http://ultimatepp.org)。我说不出它有多棒，你只需要尝试并相信自己。以下是*完整*的应用程序：

```
#include <CtrlLib/CtrlLib.h>

using namespace Upp;

class HelloWorld : public TopWindow {
    MenuBar menu;
    StatusBar status;

    void FileMenu(Bar& bar);
    void MainMenu(Bar& bar);
    void About();

public:
    typedef HelloWorld CLASSNAME;

    HelloWorld();
};

void HelloWorld::About()
{
    PromptOK("{{1@5 [@9= This is the]::@2 [A5@0 Ultimate`+`+ Hello world sample}}");
}

void HelloWorld::FileMenu(Bar& bar)
{
    bar.Add("About..", THISBACK(About));
    bar.Separator();
    bar.Add("Exit", THISBACK(Close));
}

void HelloWorld::MainMenu(Bar& bar)
{
    menu.Add("File", THISBACK(FileMenu));
}

HelloWorld::HelloWorld()
{
    AddFrame(menu);
    AddFrame(status);
    menu.Set(THISBACK(MainMenu));
    status = "Welcome to the Ultimate++ !";
}

GUI_APP_MAIN
{
    SetLanguage(LNG_ENGLISH);
    HelloWorld().Run();
} 
```

# objective-c - 是否可以在 Objective-C 中将方法声明为私有？

> ID：647079
> 
> 赞同：22
> 
> 时间：2009-03-15T01:33:37.627
> 
> 标签：objective-c

是否可以在 Objective-C 中将方法声明为私有？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-16T17:42:39.097

如果您使用的是 Objective-C 2.0，那么创建其他人“难以”调用的方法的最佳方法是将它们放在[类扩展](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/ocCategories.html#//apple_ref/doc/uid/TP30001163-CH20-SW2)中。假设你有

```
@interface MyClass : NSObject {

}

- (id)aPublicMethod;

@end 
```

在`MyClass.h`文件中，您可以添加`MyClass.m`以下内容：

```
@interface MyClass () //note the empty category name
- (id)aPrivateMethod;
@end

@implementation MyClass
- (id)aPublicMethod {...}
- (id)aPrivateMethod {...} //extension method implemented in class implementation block
@end 
```

类扩展的优点是“扩展”方法是在原始类主体中实现的。因此，您不必担心`@implementation`方法实现在哪个块中，如果扩展方法未在类中实现，编译器会发出警告`@implementation`。

正如其他人所指出的那样，Objective-C 运行时不会强制您的方法的私有性（即使没有源代码，也不难找出这些方法正在使用类转储），但编译器会生成警告如果有人试图打电话给他们。一般来说，ObjC 社区接受“我告诉过你不要调用这个方法[通过将它放在私有类扩展或类别中，或者*只是通过记录该方法是私有的*]，你还是调用了它。无论发生什么混乱都是你的错. 别傻了。对这个问题的态度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T01:37:06.493

不，任何对象都可以向任何其他对象发送任何消息。但是，您可以将该方法放在属于该类的实现文件的类别中。这样，如果您尝试在其他任何地方调用它，您将收到“类可能无法实现此方法”的警告。这是使方法“私有”的正常方式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T01:56:27.603

没有什么可以阻止该方法被调用（因为objective-c 是基于消息的任何东西都可以发送任何消息），但是您可以在标头之外声明它们以便它们不可见，并且如果使用编译器将生成警告。

这适用于类和实例方法。

例如

```
#import "SomeClass.h"

// Interface for hidden methods
@interface SomeClass (hidden)
+(void) hiddenClassMethod;
-(void) hiddenInstanceMethod; 
@end 
```

注意：不要像这样声明变量，否则它们将成为类变量 - 例如，所有实例只会使用一个变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T20:56:15.553

您可以通过使用类别来做到这一点。[在我对这个](https://stackoverflow.com/questions/360968/category-usage-in-objective-c/361140#361140)SO 问题的回答中，我有更完整的描述。

如前所述，您无法阻止任何人向选择器发送消息，但通过使用类别可以降低这些功能的可见性。

此外，您可以有多个类别扩展一个类。因此，通过使用信息丰富的类别名称，您可以将私有函数分组到相关的块中，从而提高代码的自文档性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T17:53:24.313

正如其他人提到的，你不能拥有这样的代码

1.  一种方法，以及
2.  不可能从课外打电话。

人们已经指出，您可以放弃第 2 点，并获得一个难以调用但并非不可能调用的方法。或者，为什么不放弃第 1 点呢？

`static id myPrivateMethod(MyObject *me, int arg1, id arg2) { ... }`

现在只能从同一个文件中调用代码。您无法通过方法获得任何神奇的私有成员访问权限，因此这绝不是一个完美的解决方案。但是没有更好的方法来实现隐私。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-23T13:46:35.900

实现隐藏方法（实例和/或类）

```
 // ===========================
    // = File: SomeClass.m
    // ===========================
    #import "SomeClass.h"

    // =================================
    // = Interface for hidden methods
    // =================================
    @interface SomeClass (hidden)

    -(void) hiddenInstanceMethod; 

    @end

    // ================================
    // = Implementation for SomeClass
    // ================================
    @implementation SomeClass
     -(void) hiddenInstanceMethod
    {
      printf( "Hidden instance method\n" );
    }         

    -(void) msg
    {
      printf("Inside msg()...\n");

      [self hiddenInstanceMethod];//private method calling

    }

@end 
```

> [http://macdevelopertips.com/objective-c/private-methods.html](http://macdevelopertips.com/objective-c/private-methods.html)

参考此链接会有所帮助。

# ruby-on-rails - 为什么新的 Rails db 迁移文件以日期戳而不是序列号开头？

> ID：647090
> 
> 赞同：4
> 
> 时间：2009-03-15T01:45:39.063
> 
> 标签：ruby-on-rails, ruby

每当我使用 script/generate 为我的 Rails 数据库的更改生成一个新的脚手架时，新的迁移文件前面都有一个日期戳（例如 200903140912_create_users.rb），而不是一个序列号（例如 004_create_users.rb）。

然后我必须手动更改文件名以适应其余的迁移文件。

有谁知道如何解决这一问题？

系统：Mac OS X Leopard 10.5.6
Rails：v2.2.2
Ruby：v1.8.6

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T02:07:12.163

这是在 Rails 2.1 中引入的。根据[迁移文档](http://guides.rubyonrails.org/migrations.html#whatsinaname)`config.active_record.timestamped_migrations`，您可以通过设置为`false`in来恢复它`config/environment.rb`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-15T04:29:08.373

我不确定他们为什么做出这个决定，但我可以告诉你它是如何让我的生活更轻松的。在一个团队中，两个人大致同时创建迁移是很常见的。如果最后一次生产迁移是 007，那么两个新的迁移都是 008。第二个提交的人在试图解决它时会头疼，而时间戳使冲突的可能性大大降低。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T05:25:58.113

做出这个决定是因为当人们在同一个项目上一起工作时，他们经常会尝试使用他们的新更改来创建迁移。这将导致两个人在同一项目上进行单独更改但都生成具有相同编号的迁移的问题。Rails 核心团队决定将其更改为 UTC 时间戳，因为不太可能（但仍有可能！）两个（或更多）开发人员在同一秒内创建迁移，而不是相同的顺序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T05:42:57.527

还值得一提的是，使用 UTC 时间戳有助于在开发人员可能位于不同时区时运行迁移的顺序。

# c++ - 对象列表应该存储在堆还是栈上？

> ID：647092
> 
> 赞同：3
> 
> 时间：2009-03-15T01:46:02.277
> 
> 标签：c++, object, memory-management, stack, heap-memory

我有一个对象（A），它有一个由对象（B）组成的列表。list(B) 中的对象是指针，但列表本身应该是指针吗？我正在从 Java 迁移到 C++，但还没有完全习惯堆栈/堆。该列表不会传递到 A 类之外，只会传递列表中的元素。为了以防万一，将列表本身分配在堆上是一种好习惯吗？

另外，包含 list(A) 的类也应该在堆本身上吗？像列表一样，它不会被传递。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T02:01:08.387

请记住，

1.  仅当 Object-A 也在堆栈上时，列表才会在堆栈上
2.  即使列表本身不在堆上，它也可以从堆中分配其存储空间。这就是 std::list、std::vector 和大多数 C++ 列表的工作方式——原因是基于堆栈的元素不能增长。
3.  现在大多数堆栈都在 1mb 左右，所以在你需要担心它之前，你需要一个相当大的对象列表。即使您的堆栈只有大约 32kb，您也可以存储近 8000 个指针，以免成为问题。

不熟悉 C/C++ 中显式内存管理的 IMO 人员可能倾向于过度思考这些事情。

除非您正在编写一些您知道会有数千个相当大的对象的东西，否则只需将列表放入堆栈中。除非您在函数中使用巨大的 C 样式数组，否则由于上面的 #1 和 #2，列表使用的内存可能最终会出现在堆中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T01:51:51.840

你最好在堆上存储一个列表，如果它可以增长的话。由于您永远不知道运行时堆栈将是什么，因此溢出是一种真正的危险，其后果是致命的。

如果您绝对知道列表的上限，并且与堆栈的大小相比它很小，那么您可能可以避免堆栈分配列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T02:00:19.557

我在堆栈可能很小并且需要避免堆碎片的环境中工作，所以我会使用这些规则：

*   如果列表很小并且已知固定大小，则堆叠。

*   如果列表很小且固定大小未知，则可以同时考虑堆和 alloca()。如果您可以保证您的函数在您的分配将在那里的持续时间内不会在堆上分配任何东西，那么使用堆将是一个不错的选择。如果你不能保证这一点，你要求一个片段，而 alloca() 将是一个更好的选择。

*   如果列表很大或需要增长，请使用堆。如果你不能保证它不会碎片，我们倾向于在我们的内存管理器中内置一些资源，例如自上而下的分配和单独的堆。

大多数情况并不要求人们担心碎片，在这种情况下，他们可能不推荐使用 alloca。

对于包含列表的类，如果它在函数范围内是本地的，只要内部数据结构不是非常大，我会将它放在堆栈上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T02:07:43.020

“列表”是什么意思。如果它是 std::list （或 std::vector 或任何其他 STL 容器），那么它不会在堆栈上存储任何东西，所以不用担心。

如果您有任何疑问，请查看 sizeof(A) ，它会告诉您它在堆栈上时将使用多少内存。

但是......决定应该主要基于对象的生命周期。基于堆栈的对象一旦超出范围就会被销毁。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-15T01:51:35.740

堆栈总是最简单的。不幸的是，它有一个很大的缺点——你必须提前知道元素的数量。

# .net - 在 .NET 中创建内部 XAML 文件

> ID：647109
> 
> 赞同：50
> 
> 时间：2009-03-15T02:02:25.810
> 
> 标签：.net, wpf, silverlight, xaml

在我的 Silverlight 项目中，我想制作一个包含从程序集外部看不到的 .xaml 的程序集。但是，我没有明确的方法可以做到这一点。当我修改 .xaml.cs 文件上的访问修饰符时，编译器告诉我：

```
Partial declarations of "My xaml class here" have conflicting accessibility modifiers 
```

在 xaml 文件本身中，似乎没有放置我的访问修饰符的地方。简而言之，如何将与我的 xaml 文件关联的类设置为`internal`？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2009-03-15T09:35:56.123

`x:ClassModifier="internal"`如果将 .cs 文件中类的可见性更改为内部，则需要在 XAML 文件的 UserControl 标记中添加一个。

从 XAML 文件（例如 MyControl.g.cs）生成的文件需要与代码隐藏文件（例如 MyControl.cs）相匹配。`x:ClassModifier`允许您控制 MyControl.g.cs 文件中部件声明的可见性。

# java - newInstance() 与新的

> ID：647111
> 
> 赞同：26
> 
> 时间：2009-03-15T02:04:32.170
> 
> 标签：java, performance, reflection

调用 newInstance() 是否会受到惩罚，或者它下面的机制是否相同？newInstance() 对 new 关键字* 有多少开销？

*：不考虑 newInstance() 意味着使用反射这一事实。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-15T03:17:17.143

在现实世界的测试中，通过传入 10 个参数的“Constructor.newInstance”创建一个类的 18129 个实例——与通过“new”程序创建实例相比，在时间上没有可测量的差异。

这不是任何形式的微观基准。

这适用于 Windows 7 x86 beta 上的 JDK 1.6.0_12。

鉴于 Constructor.newInstance 将与 Class.forName.newInstance 非常相似，我会说，考虑到使用 newInstance 而不是 new 可以获得的功能，开销几乎没有。

与往常一样，您应该自己测试一下。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T02:19:21.883

小心微基准，但我发现[这篇博客文章](http://www.thoughtsabout.net/blog/archives/000036.html)有人发现它`new`的速度大约是 JDK 1.4 的两倍`newInstance`。听起来有区别，正如预期的那样，反射速度较慢。但是，听起来差异可能不会破坏交易，这取决于新对象实例的频率与正在完成的计算量。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-30T21:15:46.277

有区别- 10倍。绝对差异很小，但如果您的写入低延迟应用程序累积 CPU 时间损失可能会很大。

```
 long start, end;
    int X = 10000000;
    ArrayList l = new ArrayList(X);
    start = System.nanoTime();
    for(int i = 0; i < X; i++){
        String.class.newInstance();
    }
    end = System.nanoTime();
    log("T: ", (end - start)/X);

    l.clear();
    start = System.nanoTime();
    for(int i = 0; i < X; i++){
        new String();
    }
    end = System.nanoTime();
    log("T: ", (end - start)/X); 
```

输出：

```
T: 105
T: 11 
```

在 Xeon W3565 @ 3.2Ghz、Java 1.6 上测试

# iphone - 使用触摸屏进行游戏控制

> ID：647112
> 
> 赞同：8
> 
> 时间：2009-03-15T02:05:13.713
> 
> 标签：iphone, android, user-interface, touchscreen

我正在为 Android 平台开发我的第一个视频游戏，作为一个晚上和周末的项目。

它进展顺利，但我对控制灵敏度非常不满意。

在这个游戏中，您在屏幕上左右移动一个对象。屏幕底部是一个“触摸板”，是你的手指应该休息的地方。

```
/-------------------------\
|                         |
|                         |
|                         |
|       Game Area         |
|                         |
|                         |
|                         |
|                         |
|                         |
/-------------------------\
|                         |
|       Touch Area        |
|                         |
\-------------------------/ 
```

我目前正在使用状态变量来保存“MOVING_LEFT，MOVING_RIGHT，NOT_MOVING”，并根据该变量更新每帧播放器对象的位置。

但是，我读取触摸屏输入并设置此状态变量的代码要么过于敏感，要么过于滞后，具体取决于我如何调整它：

```
public void doTouch (MotionEvent e) {
    int action = e.getAction();

    if (action == MotionEvent.ACTION_DOWN) {
        this.mTouchX = (int)e.getX();
        this.mTouchY = (int)e.getY();           
    } 
    else if (action == MotionEvent.ACTION_MOVE) {
        if ((int)e.getX() >= this.mTouchX) {
            this.mTouchX = (int)e.getX();
            this.mTouchY = (int)e.getY();   
            if (this.TouchRect.contains(this.mTouchX, this.mTouchY)) {              
                this.mTouchDirection = MOVING_RIGHT;
            }
        } 
        else if ((int)e.getX() <= this.mTouchX) {
            this.mTouchX = (int)e.getX();
            this.mTouchY = (int)e.getY();
            if (this.TouchRect.contains(this.mTouchX, this.mTouchY)) {              
                this.mTouchDirection = MOVING_LEFT;
            }
        }
        else {
            this.mTouchDirection = NOT_MOVING;
        }               
    } 
    else if (action == MotionEvent.ACTION_UP) {
        this.mTouchDirection = NOT_MOVING;
    }       
} 
```

这个想法是，当有任何移动时，我会检查用户手指的先前位置，然后找出移动玩家的方向。

这不太好用，我想这里有一些 iPhone/Android 开发人员已经弄清楚如何通过触摸屏进行良好的控制，并可以提供一些建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T02:24:59.453

您可以在 Windows 上尝试类似于“拖动矩形”的操作。当您在某物上按住鼠标按钮时，您不会开始拖动操作，直到鼠标移出鼠标按下位置周围的一个小区域。原因是单击时很难将光标保持在同一像素上。

因此，第一次尝试可能`(int)e.getX() >= this.mTouchX + DEAD_ZONE`与另一种情况类似，其中`DEAD_ZONE`是一个小整数。

然而，这并不涉及在同一笔划中转身。您可以通过仅在右转后当前位置距最后一个位置的左侧至少`DEAD_ZONE`像素时左转来处理该问题，反之亦然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T02:39:57.217

一个明显的问题是，您没有考虑自上次触摸以来的时间。

我建议您将玩家触摸视为在 和 的模拟范围内所需运动的表达`-x/+x`，`-y/+y`然后根据时间在其他地方执行实际运动。

例如

```
objectPos += objectPos + (joyPos * timeDelta * maxSpeed); 
```

因此，如果您的对象的最大速度为 10ms-1 并且玩家的手指在控制板上的位置为 0.5，那么该对象将每秒移动 5 米。如果您的游戏以 10fps 的速度运行，那么每帧对象将移动 0.5 米。

这些数字是虚构的，但希望证明需要将控制与运动分开，然后及时考虑。

# java - 如何反编译整个Jar文件？

> ID：647116
> 
> 赞同：315
> 
> 时间：2009-03-15T02:08:43.377
> 
> 标签：java, jar, decompiler

有谁知道可以反编译整个 Jar 文件而不是单个类的免费反编译器？我对像 name$1.class name$2.class name.class 这样的子类有疑问

* * *

## 回答 #1

> 赞同：337
> 
> 时间：2009-03-15T02:21:34.233

2009：[JavaDecompiler](http://jd.benow.ca/)可以很好地使用 jar：从 0.2.5 开始，显示 JAR 文件中的所有文件。

![http://java.decompiler.free.fr/sites/default/screenshots/screenshot1.png](https://i.stack.imgur.com/SF22b.png)

另请参阅[问题“我如何“反编译”Java 类文件？”](https://stackoverflow.com/questions/272535/how-do-i-decompile-java-class-files/272595#272595) .

不过，自 2009 年底以来，JD-Eclipse 似乎没有发生任何变化（请参阅[Changes](http://java.decompiler.free.fr/?q=changes/jdeclipse)）。
因此，它与最新的 Eclipse（3.8、4.2+）的集成可能会出现问题。

JD-Core 得到积极维护。

两者都是（SO 用户）[**Emmanuel Dupuy**](https://stackoverflow.com/users/37785/emmanuel-dupuy)出色工作的结果。

* * *

2018：更现代的选择，在[David Kennedy Araujo](https://stackoverflow.com/users/1697026/david-kennedy-araujo)[的评论](https://stackoverflow.com/questions/647116/how-to-decompile-a-whole-jar-file/647140?noredirect=1#comment89196907_647140)中提到：

[**JetBrains/intellij-community/plugins/java-decompiler/engine**](https://github.com/JetBrains/intellij-community/tree/master/plugins/java-decompiler/engine)

> Fernflower 是第一个实际工作的 Java 分析反编译器，并且可能用于一般的高级编程语言。
> 
> ```
> java -jar fernflower.jar [-<option>=<value>]* [<source>]+ <destination>
> 
> java -jar fernflower.jar -hes=0 -hdc=0 c:\Temp\binary\ -e=c:\Java\rt.jar c:\Temp\source\ 
> ```

另请参阅[如何将 intellij idea 反编译为 java 文件，了解](https://stackoverflow.com/questions/28389006/how-to-decompile-to-java-files-intellij-idea)使用最新 IntelliJ IDEA 的命令。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-03-15T09:00:33.947

首先，值得记住的是，所有 Java 归档文件（`.jar`/ `.war`/etc...）**基本上都只是花哨的`.zip`文件**，并添加了一些清单和元数据。

其次，为了解决这个问题，我个人使用了几个工具来处理所有级别的这个问题：

*   [**Jad**](https://varaneckas.com/jad/) + [**Jadclipse**](http://jadclipse.sourceforge.net/wiki/index.php/Main_Page)在 IDE 中工作时用于反编译`.class`文件
*   [**WinRAR**](http://www.rarlab.com/)是我最喜欢的压缩工具，它本身就支持 Java 存档（再次参见第一段）。
*   [**Beyond Compare**](http://www.scootersoftware.com/)是我最喜欢的 diff 工具，如果配置正确，它可以在任何存档文件之间进行即时比较，包括`jar`s. 很值得一试。

上述所有内容的优点是我不需要持有任何其他使我的工作环境混乱的外部工具。我从其中一个文件中需要的所有东西都可以在我的 IDE 中处理，也可以与其他文件进行本地区分。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2009-03-15T04:40:06.290

如果您碰巧同时拥有 bash shell 和 jad：

```
JAR=(your jar file name)
unzip -d $JAR.tmp $JAR
pushd $JAR.tmp
for f in `find . -name '*.class'`; do
    jad -d $(dirname $f) -s java -lnc $f
done
popd 
```

我可能对此有点不以为然，但它应该或多或少地像宣传的那样工作。您最终应该`$JAR.tmp`包含您的反编译文件。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-03-27T11:37:51.023

[我使用名为（令人沮丧）“ JD：Java Decompiler](http://java-decompiler.github.io/) ”的工具取得了相当大的成功。

*在处理为 Java 5 和更高版本编译的类时，*我发现它比大多数反编译器更好。不幸的是，在 JAD 通常会成功的情况下，它仍然会出现一些问题。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2010-02-05T16:47:18.240

就像是：

```
jar -xf foo.jar && find . -iname "*.class" | xargs /opt/local/bin/jad -r 
```

也许？

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-04-12T09:37:54.290

将以下内容插入 decompile.jar.sh

```
# Usage: decompile.jar.sh some.jar [-d]

# clean target folders
function clean_target {
  rm -rf $unjar $src $jad_log
}

# clean all debug stuff
function clean_stuff {
  rm -rf $unjar $jad_log
}

# the main function
function work {
  jar=$1
  unjar=`basename $jar.unjar`
  src=`basename $jar.src`
  jad_log=jad.log

  clean_target

  unzip -q $jar -d $unjar
  jad -d $src -ff -r -lnc -o -s java $unjar/**/*.class > $jad_log 2>&1

  if [ ! $debug ]; then
    clean_stuff
  fi

  if [ -d $src ] 
    then
      echo "$jar has been decompiled to $src"
    else
      echo "Got some problems check output or run in debug mode"
  fi
}

function usage {
  echo "This script extract and decompile JAR file"
  echo "Usage: $0 some.jar [-d]"
  echo "    where: some.jar is the target to decompile"
  echo "    use -d for debug mode"
}

# check params
if [ -n "$1" ]
  then
    if [ "$2" == "-d" ]; then
      debug=true
      set -x
    fi
    work $1
  else
    usage
fi 
```

*   chmod +x decomplie.jar.sh //可执行
*   ln -s ./decomplie.jar.s /usr/bin/dj

准备使用，只需键入`dj your.jar`，您将获得`your.jar.src`包含源的文件夹。使用`-d`调试模式选项。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T11:31:03.147

**注意：此解决方案仅适用于 Mac 和 *nix 用户。**

我也试图找到贾德，但没有运气。我的快速解决方案是下载包含 jad的[MacJad 。](http://mac.softpedia.com/get/Development/Compilers/MacJAD.shtml)下载后，您可以在 [where-you-downloaded-macjad]/MacJAD/Contents/Resources/jad 中找到 jad。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T02:14:01.100

您提取它，然后对目录使用 jad。

# iphone - 如何检测特定区域的触摸

> ID：647122
> 
> 赞同：6
> 
> 时间：2009-03-15T02:11:33.977
> 
> 标签：iphone, objective-c, uikit

目前我看到一个触摸事件将向我显示触摸发生的 UIView。但是，如果我需要检测一些非矩形形状的触摸，比如圆形，该怎么办。我将如何去做这样的事情？

基本上我只想在用户触摸不可见的圆形区域内的某个地方时才做某事。

任何帮助/方向表示赞赏，TIA！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T02:18:41.667

你会这样做。请注意，'locationInView' 将返回相对于指定视图的触摸坐标，因此无论该视图在屏幕上的哪个位置，在视图左上角的触摸都将返回 (0,0)。

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event 
{   
  UITouch *touch = [touches anyObject];

  // gets the coordinats of the touch with respect to the specified view. 
  CGPoint touchPoint = [touch locationInView:self];

  // test the coordinates however you wish, 
  ...
} 
```

要针对球体进行测试，您将计算从触摸点到球体中心的距离，然后检查这是否小于球体半径。

# javascript - JavaScript 花絮是如何将远程小部件插入页面的？

> ID：647137
> 
> 赞同：0
> 
> 时间：2009-03-15T02:19:58.137
> 
> 标签：javascript, widget, document.write

假设我有一个 Web 服务，它允许用户将一段 JavaScript 插入到他们的页面上，当加载时，它会从我的服务器中获取一个小部件并将其插入到他们的页面中。我该怎么做，我应该使用什么技术？

document.write?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T03:02:40.517

关于 DIY 小部件的分步文章[- 如何将您的网站嵌入到另一个网站](http://drnicwilliams.com/2006/11/21/diy-widgets/)。它重现了 Google Adsense 使用的技术

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T02:37:33.323

取决于您的小部件将做什么。

最简单的方法可能是打开一个 iframe 并在其中加载小部件。谷歌之类的东西是用 AdSense 广告做的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T02:53:12.177

除了 Vasil 的回答之外，在某些情况下，（动态生成的）图像可能就足够了。在极端情况下，您甚至可以考虑使用 Flash。

# c++ - 如何使用 libcurl 下载 utf-8 编码的网页，并保留编码？

> ID：647138
> 
> 赞同：1
> 
> 时间：2009-03-15T02:20:19.900
> 
> 标签：c++, utf-8, ascii, libcurl

我试图让 libcurl 下载一个以 UTF-8 编码的网页，它工作正常，除了它将它转换为 ASCII 并搞砸了一些字符。有没有一种简单的方法可以让它保持在 UTF-8 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T12:15:12.033

libcurl 根本不翻译/转换数据，所以实际上你不需要做任何特别的事情。只要得到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T02:41:02.033

检查[CURL 选项以进行转换](http://curl.haxx.se/libcurl/c/curl_easy_setopt.html#CURLOPTCONVFROMNETWORKFUNCTION)。它们可能是在编译时定义的。

# python - 为什么我不能在没有手动编辑的情况下粘贴 Pythons REPL 的输出？

> ID：647142
> 
> 赞同：4
> 
> 时间：2009-03-15T02:23:48.003
> 
> 标签：python, user-interface, read-eval-print-loop

大量示例 Python 代码显示了 Python REPL 的输出，例如：

```
>>> class eg(object):
...     def __init__(self, name):
...             self.name = name
...     def hi(self):
...             print "Hi %s" % (self.name)
... 
>>> greeter = eg("Bob")
>>> greeter.hi()
Hi Bob
>>> 
```

现在，您要做的显而易见的事情是运行上面的代码.. 所以，我运行“python”并将上面的文本粘贴到..

```
>>> >>> class eg(object):
  File "<stdin>", line 1
    >>> class eg(object):
     ^
SyntaxError: invalid syntax
>>> ...     def __init__(self, name):
  File "<stdin>", line 1
    ...     def __init__(self, name):
    ^ 
```

密码坏了！？...

为了让它运行，我必须要么..

*   一次复制并粘贴一行，确保我正确复制所有缩进。如果你搞砸了（比如说，错过了一个领先的空间，你必须重新开始）
*   使用文本编辑器删除`>>>`and `...`，然后再次粘贴

这不是一个大问题，但是鉴于以这种格式提供了多少示例代码，您必须这样做似乎很奇怪..

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T03:36:36.270

### 如何运行/采用“Pythons REPL 的输出”

*   使用[IPython](http://ipython.scipy.org/moin/)外壳

    ```
    In [99]: %cpaste
    Pasting code; enter '--' alone on the line to stop.
    :>>> class eg(object):
    :...     def __init__(self, name):
    :...             self.name = name
    :...     def hi(self):
    :...             print "Hi %s" % (self.name)
    :...
    :>>> greeter = eg("Bob")
    :>>> greeter.hi()
    :--
    Hi Bob 
    ```

*   使用功能强大的文本编辑器（例如，在[Emacs](http://www.enigmacurry.com/2008/05/09/emacs-as-a-powerful-python-ide/)`C-x r k`中删除矩形区域）

*   使用[doctest](http://docs.python.org/library/doctest.html)模块

首先在没有 shell 提示的情况下进行复制（例如，尽管我不知道如何在 Google Chrome 上执行此操作）。

### 为什么使用 doctest 格式

将以下内容保存到`documentation.txt`：

```
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
eiusmod tempor incididunt ut labore et dolore magna aliqua。Ut enim 广告
minim veniam, quis nostrud exercitation ullamco laboris nisi ut
aliquip ex ea commodo consequat。

>>> 类例如（对象）：
... def __init__(self, name):
... self.name = 名称
...定义嗨（自我）：
... 打印 "Hi %s" % (self.name)
...
>>> 迎接者 = 例如（“鲍勃”）
>>> 迎接者.hi()
嗨鲍勃
>>>

Duis aute irure dolor in reprehenderit in voluptate velit esse cillum
dolore eu fugiat nulla pariatur。Exceptioneur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est
产房。

```

跑：

```
$ python -c "import doctest; doctest.testfile('documentation.txt')" -v 
```

输出：

```
Trying:
    class eg(object):
        def __init__(self, name):
                self.name = name
        def hi(self):
                print "Hi %s" % (self.name)
Expecting nothing
ok
Trying:
    greeter = eg("Bob")
Expecting nothing
ok
Trying:
    greeter.hi()
Expecting:
    Hi Bob
ok
1 items passed all tests:
   3 tests in doctest.txt
3 tests in 1 items.
3 passed and 0 failed.
Test passed. 
```

如果您在模块末尾添加以下代码段，它将测试其文档字符串中的所有代码：

```
if __name__=="__main__":
   import doctest; doctest.testmod() 
```

**`QED`**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T02:56:35.257

我不知道是否有一个好的解决方案。理想情况下，有一些方法可以修改解释器的行为以接受这种复制/粘贴输入。以下是一些替代建议：

使用三引号将示例保存为字符串。然后，使用 exec：

```
>>> def chomp_prompt(s): return '\n'.join(ln[4:] for ln in s.splitlines())
...
>>> dirty = """>>> class eg(object):
... ...     def __init__(self, name):
... ...             self.name = name
... ...     def hi(self):
... ...             print "Hi %s" % (self.name)
... ...
... >>> greeter = eg("Bob")
... >>> greeter.hi()
... """
>>> clean = chomp_prompt(dirty)
>>> exec clean
Hi Bob
>>> 
```

我的解决方案不仅都适合一行（因此您可以轻松地将其复制/粘贴到解释器中），它适用于上面的示例：D：

```
>>> s = r'''>>> def chomp_prompt(s): return '\n'.join(ln[4:] for ln in s.splitlines())
... ...
... >>> dirty = """>>> class eg(object):
... ... ...     def __init__(self, name):
... ... ...             self.name = name
... ... ...     def hi(self):
... ... ...             print "Hi %s" % (self.name)
... ... ...
... ... >>> greeter = eg("Bob")
... ... >>> greeter.hi()
... ... """
... >>> clean = chomp_prompt(dirty)
... >>> exec clean'''
>>> s2 = chomp_prompt(s)
>>> exec s2
Hi Bob 
```

我的第二个建议是查看 ipython 为您打开编辑器并在完成编辑后执行您在其中输入的内容的能力：

[http://ipython.scipy.org/doc/rel-0.9.1/html/interactive/tutorial.html#source-code-handling-tips](http://ipython.scipy.org/doc/rel-0.9.1/html/interactive/tutorial.html#source-code-handling-tips)

如果您将 emacs 设置为您的编辑器，我知道它能够删除一个矩形文本（您可能会猜到命令：Mx delete-rectangle），这对于摆脱那些讨厌的提示非常有用。我相信许多其他编辑也有这个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T12:10:47.937

“为什么”问题很少有有用的答案。

例如，如果我说是为了避免复杂的知识产权侵权诉讼，那是什么意思？没有。你仍然必须停止复制和粘贴，开始思考和打字。

或者，例如，如果我说[这里](http://www.python.org/doc/2.5.2/doc/showing-examples.html)给出了原因，则没有什么可操作的。问题是必须输入示例而不是剪切和粘贴。而这个问题并没有被这些信息解决。

确实，问题真的是“我想复制粘贴，没有那么多思考和打字，我该怎么做？” 答案是一样的。

您不能复制和粘贴交互式会话（doctest 评论除外）。你必须输入它。对不起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T02:30:43.247

代码以这种方式呈现，因为它是一个逐步的过程。您看到的三个字符“>>>”是 Python IDE 中的字符，但您似乎已经知道这一点。当您可以访问控制台或 shell 并键入 python 时，您将得到类似的东西。

```
% python
Python 2.5.1 (r251:54863, Jan 13 2009, 10:26:13) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

所以真的把它当作一种教育工具。:)

# javascript - 匿名函数中的静态变量

> ID：647145
> 
> 赞同：7
> 
> 时间：2009-03-15T02:25:04.600
> 
> 标签：javascript, jquery, variables, function, memoization

我试图模仿 JavaScript 函数上的静态变量，目的如下：

```
$.fn.collapsible = function() {
  triggers = $(this).children('.collapse-trigger');
  jQuery.each(triggers, function() {
    $(this).click(function() {
      collapse = $(this).parent().find('.collapse');
    })
  })
} 
```

如何保存“折叠”对象，以便不必在每次调用时都“找到”它？我知道使用命名函数我可以做一些类似“someFunction.myvar = collapse”的事情，但是像这样的匿名函数呢？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-15T03:35:35.103

您可以将变量保存在函数中，使用其中一个，`functioName.myVar = value`或者`arguments.callee.myVar = value`如果您没有当前函数名称。

`arguments.callee`是您当前所在的功能。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-15T03:38:55.203

对于匿名函数，您可以使用返回函数的函数。

例如：

```
var myAnonymousFunction = (function(){
    var myFirstStatic = $("#anElement");
    var anotherStatic = true;
    return function(param1,param2) {
        // myFirstStatic is in scope
        // anotherStatic also
    }
})(); 
```

应该像魅力一样工作，并且您可以确保静态的初始化代码只执行一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-31T01:07:05.247

[似乎在 Stack Overflow 的其他地方](https://stackoverflow.com/questions/103598/why-was-the-arguments-callee-caller-property-deprecated-in-javascript)可以找到更好的答案。

简而言之，您实际上可以在不污染命名空间的情况下为匿名函数命名，但仍然允许自引用。

```
mything.prototype.mymethod = function myKindOfFakeName() {
    myKindOfFakeName.called = true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T02:39:31.523

只要您将函数分配给这样的变量，您就应该能够以 访问它`$.fn.collapsible`，从而将变量分配为`$.fn.collapsible.myvar`.

# sql - 使用 Linq to SQL 时使用多列（复合）主键是否有益？

> ID：647146
> 
> 赞同：6
> 
> 时间：2009-03-15T02:26:04.020
> 
> 标签：sql, linq, linq-to-sql

使用 Linq to SQL 时，对多对多关系表使用多列（复合）主键是否有益？

或者我应该只添加一个标识列作为非聚集主键并适当地索引 FK 列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T02:35:54.997

不是 LINQ 问题。如果您的架构需要它们，请使用它们。如果你不这样做，不要。无论哪种方式，LINQ 都会很好地处理您的架构。

LINQ to SQL 处理不好的一个领域是多列/键映射表，用于连接多对多关系，但我不会说这完全属于您的问题所涉及的类别。您仍然可以在 LINQ 中对映射表执行 CRUD 操作，但 LINQ 无法遍历多对多映射表所呈现的关系。（LINQ 适用于一对一和一对多表。）

我不能谈论实体框架的任何问题，但如果 EF 对多列/多键表有任何问题，我会感到非常惊讶。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T02:28:05.747

如果在您的域中拥有一个多列复合键是有意义的，那么就使用一个。否则，使用通常的标识列作为代理主键。

编辑：这是一般建议，没有考虑使用 LINQtoSQL 实现的任何技术方面。这些可能是有趣的：

[如何：处理查询中的复合键 (LINQ to SQL)](http://msdn.microsoft.com/en-us/library/bb399391.aspx)

[LINQ To SQL 示例](http://msdn.microsoft.com/en-us/vbasic/bb688085.aspx)

[Linq to SQL DTO 和复合对象](https://stackoverflow.com/questions/611792/linq-to-sql-dtos-and-composite-objects)

# vim - 无法在 Vim 中用单个替换替换不同的匹配项

> ID：647162
> 
> 赞同：4
> 
> 时间：2009-03-15T02:38:31.650
> 
> 标签：vim, replace

我尝试了以下代码不成功

```
:%s/{car,beatles}/mas/g 
```

如何用一个命令在 Vim 中用 mas替换**car**和**beatles ？**

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-15T02:41:55.387

这应该有效：

```
:%s/\(car\|beatles\)/mas/g 
```

# email - 使用电子邮件地址作为用户 ID 的优缺点是什么？

> ID：647172
> 
> 赞同：71
> 
> 时间：2009-03-15T02:45:12.837
> 
> 标签：email, authentication, registration

我正在创建一个需要注册/身份验证的网络应用程序，并且我正在考虑使用电子邮件地址作为唯一的用户 ID。以下是我认为的优点和缺点（随回复更新）：

**优点**

1.  注册时需要填写的字段少了（只需电子邮件地址、密码和验证密码）。我是简约注册的忠实粉丝。

2.  电子邮件地址更容易记住。（感谢[米奇](https://stackoverflow.com/users/16076/mitch-wheat)，[杰里米](https://stackoverflow.com/users/4258/jeremy-kratz)）

3.  您不必担心您最喜欢的用户名已被占用 - 您是唯一使用您的电子邮件地址的人。（感谢[TStamper](https://stackoverflow.com/users/39809/tstamper)）

**缺点**

1.  用户每次登录时都要输入更多内容。

2.  如果用户想要多个帐户怎么办？他们需要另一个电子邮件地址。（我什至希望用户能够创建多个帐户？）

3.  潜在的攻击者很容易猜到（如果他们知道目标的电子邮件地址，他们就知道登录 ID）。（感[谢瓦西尔](https://stackoverflow.com/users/7883/vasil)）

4.  用户可能会尝试使用与他们的电子邮件帐户相同的密码，这很不安全。（感谢[托马斯](https://stackoverflow.com/users/14637/thomas)）

5.  如果您经常更改电子邮件地址，那么在长时间的中断之后可能很难记住您用于注册网站的地址。（感谢[软件猴子](https://stackoverflow.com/users/8946/software-monkey)）

6.  黑客可以向注册表发送垃圾邮件并使用“已发送电子邮件”的响应来生成有效电子邮件列表。（感谢[大卫](https://stackoverflow.com/users/56541/david)）

7.  不是每个人都有电子邮件地址。（感谢[尼古拉斯](https://stackoverflow.com/users/32187/nicholas-piasecki)）

如果我使用电子邮件作为 id，我将提供一种机制，以便在用户更改地址时允许更改它。在这种情况下，用户不会将内容发布到公共站点，因此不需要单独的用户名来保护电子邮件地址（但其他站点需要考虑）。

另一种选择是实施 OpenID（这是另一回事）。

这似乎适用于谷歌，但他们的服务是紧密集成的。我在分析中遗漏了什么？你有什么建议？有没有人有经验可以分享？

**最终编辑**

谢谢大家的回复。我决定使用电子邮件作为 id，但随后允许在注册后创建用于登录目的的用户名。这允许一点灵活性，同时保持注册尽可能短。它还可以防止用户更改电子邮件地址时出现问题（他们只需使用其用户名登录并更新它）。我还将实施一些方法来防止将电子邮件地址从注册和登录系统中暴力破解（主要是反复尝试后的冷却期）。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-15T02:49:16.383

就个人而言，我更喜欢只使用我的电子邮件地址作为用户名。要记住的事情少了一件，而且我永远不必担心我的首选名字已经被占用了。

只是我的2美分！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-15T02:48:05.700

我想你错过了一个专业人士：

用户可能会记住他们的电子邮件地址；由于电子邮件地址是独一无二的，他们永远不必担心他们的首选用户名已经被占用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-15T02:48:56.307

作为网站用户，我可以告诉你，我讨厌记住不必要的用户名。我不使用独特的句柄或任何东西，所以我永远记不起我使用的我的名字的哪个变体还没有被使用。我宁愿输入我的电子邮件地址。

另外，我喜欢 OpenID。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-15T02:49:48.520

**缺点**

3.  当电子邮件帐户使用相同的密码时，破坏一个自动意味着破坏另一个。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-15T04:20:51.967

CON：不是每个人都有电子邮件地址。考虑一下您的数据库是否曾经被内部应用程序访问过。如果你在经营一家商店，人们*会*打电话来下订单，并拒绝提供电子邮件地址。因此，虽然将电子邮件地址作为默认用户 ID 很酷，但请确保允许其他人进入系统。（当然，这取决于上下文。）

艰难地学会了这一点。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-15T03:20:13.157

我倾向于不喜欢赞成/反对清单，而是尝试考虑好处和挑战。

挑战：

一些用户会倾向于使用其 ISP 提供的电子邮件地址。对于在更改 ISP 之前忘记在他们注册的所有网站中更新电子邮件的用户来说，单独链接到电子邮件可能会很困难。

反而：

您应该考虑允许用户提供多个地址以及用户选择的 id，然后让用户决定他们想要做什么。或许还可以考虑允许用户提供一个 OpenID 帐户。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-17T17:38:42.717

您可能需要考虑的一种设置：同时拥有用户名和电子邮件。电子邮件用于登录并始终保密，用户名用于在任何公共交互中识别用户，例如发表评论。由于用户登录凭据的两半都是私密的，因此它最终会稍微安全一些，而如果您同时使用用户名进行登录和公共标识，则登录的一半是已知的。

我绝对同意您的观点，即在大多数情况下注册最少，但根据您所做的事情，您可能希望在这与为您的用户增加安全性之间取得平衡。四个字段对于注册来说并不过分（用户名、电子邮件、密码、确认密码），如果您特别喜欢冒险，可以通过删除确认密码字段将其减少到三个，或者通过电子邮件发送密码将其减少到两个他们以后可以改变。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-15T02:53:43.220

**专业版**

人们讨厌必须创建一个适合他们的 id 并且尚未用于注册站点的唯一名称。这就是为什么用户 id 作为**EMAIL ADDRESS**如此受欢迎的原因。

**ex** :TSamper1930，谁真的想在我真正想要的名字末尾记住 1930

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-15T03:13:02.957

**缺点：**如果黑客可以尝试大量注册随机电子邮件地址，他或她将能够根据哪些注册失败来确定哪些地址是有效的。这是一种可用于汇总已知有效电子邮件地址列表的策略，这些地址是垃圾邮件黑市上的热门商品。

虽然现在我想起来了，这是一个影响任何在注册过程中要求提供电子邮件地址的网站的问题，无论是否有单独的用户名。但这仍然是值得考虑的事情。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-03-15T03:15:43.557

**CON：**如果我更改我的电子邮件地址，突然我所有的帐户名称都无效。我的名字没有改变，但我的电子邮件经常改变。几年后我偶尔会重新访问一个网站，但被卡住了......两年前我的电子邮件地址是什么？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-15T03:59:31.800

坚持使用它们无处不在的电子邮件地址，实际上大多数主要网站都使用它们，它们是独一无二的，因此它们使用户免于寻找不被其他人使用的名称，用户也不会忘记他们的电子邮件地址（在大多数情况下）至少是:))，这与用户名不同，如果他们不经常访问您的网站，他们会不断忘记。

您不必担心它们太长，因为所有主要浏览器（IE、FF .. 等）都为默认启用的表单提供自动完成功能，因此您输入电子邮件中的第一个字母并获得一个下拉列表（即自动完成列表）您只需单击即可输入整个电子邮件，就个人而言，我几乎从不完整输入电子邮件地址，我总是输入第一个字母，然后从自动完成下拉列表中选择电子邮件。此外，如果您允许记住用户（使用记住我复选框和持久性 cookie），这将是另一个不用担心的理由。

我不了解您的应用程序，但通常在大多数应用程序中不希望拥有多个帐户的用户。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-15T02:50:01.310

一个缺点可能是，如果它是一个电子邮件地址，则人们可以猜到登录名并尝试进行暴力攻击。这并不是一个真正的大问题，因为在今天的大多数网站上，登录都是公开显示的。

最大的优点是登录更容易记住这种方式。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-15T03:45:48.540

一个好的设置是要求用户名和电子邮件。允许用户使用电子邮件地址或用户名登录是非常用户友好的。另一个好处是用户可以更改他们的电子邮件地址。它还允许一封电子邮件有多个帐户。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2010-01-30T14:35:49.273

解决您的电子邮件的骗局项目太长而无法每次输入。我已经实现了 StringScan Ruby 库。

```
require 'strscan'    
def signup!(user, &block)    
self.email = user[:email] unless user[:email].blank?    
str = StringScanner.new(self.email)    
str.scan_until(/@/)    
str.pre_match    
self.login = str.pre_match 
```

ETC..

然后只需更改登录方法以允许电子邮件或登录名匹配密码。

这就像 google 或 mobileme 一样。用户可以选择只输入他们的电子邮件用户名（即用户名而不是 username@gmail.com。）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-05-02T17:18:40.910

如果您不关心强迫您的用户使用 Facebook 或其他社交网络登录您的应用程序（大多数人似乎并不关心），那么您可以在引用时使用他们的社交网络电子邮件作为他们的“用户 ID”其他表/文档（MySQL、Mongo 等）。

我注意到使用社交媒体登录的好处是，所有的安全性都由所述社交网络负责，包括不允许 2 个用户在他们的数据库中拥有相同的电子邮件或用户名，从而省去了编码的麻烦所有这一切。这只是我个人的喜好。

# sql - 数据库关系

> ID：647193
> 
> 赞同：1
> 
> 时间：2009-03-15T03:05:35.283
> 
> 标签：sql, database, table-relationships

除了数据完整性之外，在数据库中建立适当的关系是否有助于其他任何事情？

它们是提高还是阻碍绩效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T03:18:07.890

只要您有与外键相对应的明显索引，就应该不会对性能产生明显的负面影响。这是您必须使用的更简单的数据库功能之一。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T03:18:46.593

它既不会以任何显着方式帮助也不会损害性能。唯一的障碍是在插入/更新/删除时检查完整性。

外键是数据库设计的重要组成部分，因为它们确保了一致性。您应该使用它们，因为它对可能破坏您的应用程序的数据错误提供了最低级别的保护。另一个好处是数据库工具（可视化/分析/代码生成）使用外键来关联数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T03:29:02.590

我不得不说，与忽略它们相比，适当的关系将有助于人们更好地理解数据（或数据的意图），尤其是在维护它们的总体成本相当低的情况下。

它们的存在不会影响性能，除非在架构方面（正如其他人指出的那样，数据完整性偶尔会导致外键违规，这可能会产生一些影响）但恕我直言，许多好处超过了（如果使用正确）。

我知道你没有问是否使用 FK，但我想我只是添加一些关于为什么使用它们的观点（并且必须处理后果）：

还有其他考虑因素，例如如果您打算使用 ORM（可能稍后），您将需要外键。它们对于 ETL/数据导入和导出以及以后的报告和数据仓库也非常有帮助。

如果其他应用程序将使用该模式，这也很有帮助——因为外键实现了基本的业务逻辑。因此，您的应用程序（和任何其他应用程序）只需要了解这些关系（并尊重它们）。它将保持数据的一致性，并且最有可能减少任何消费应用程序中的数据错误数量。

最后，它为您提供了关于在何处放置索引的相当不错的提示——因为您很可能会通过 FK 值查找表数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T03:07:53.640

> 数据库中的关系是提高还是阻碍性能？

与工具箱中的任何工具一样，您将获得的结果取决于您如何使用它。正确指定的关系和设计良好的逻辑数据库可以极大地提高性能——例如，考虑搜索规范化数据和非规范化数据之间的差异。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T04:41:10.280

根据您的数据库引擎，通过外键约束定义的关系可以提高性能。该约束允许引擎对键的父侧表中数据的存在做出某些假设。

可以在[http://www.microsoft.com/technet/abouttn/flash/tips/tips_122104.mspx](http://www.microsoft.com/technet/abouttn/flash/tips/tips_122104.mspx)找到 MS SQL Server 的简要说明。我不知道其他引擎，但这个概念在其他平台上是有意义的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T05:33:36.393

无论您声明与否，数据中的关系都存在。通过 FK 约束声明和强制执行关系将防止数据中的某些类型的错误，在发生插入/更新/删除时检查数据的成本很小。

通过关系声明级联删除有助于防止在删除数据时出现某些类型的错误。

了解关系有助于在形成查询时灵活和正确地使用数据。

设计好表格可以使关系更明显和更有用。在数据中使用关系是首先使用关系数据库的主要动力。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-12T21:10:54.453

关于对性能的影响：根据我使用 MS Access 2003 的经验，如果您有一个多用户应用程序并使用关系来强制执行大量引用完整性，那么您可能会在最终用户的响应时间方面受到很大影响。

有不同的方法来执行参照完整性。我决定在关系中去掉一些规则，在前端建立更多的执行力，并忍受一些 RI 的损失。当然，在多用户环境中，你要非常小心那一点自由。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-12T21:26:37.803

根据我构建性能敏感型数据库的经验，外键对性能的影响非常大，因为每次插入/更新引用记录或删除主记录时都必须检查它们。如果您需要证明，只需查看执行计划即可。

我仍然保留它们作为文档和工具使用，但我通常禁用它们，特别是在只能通过应用程序层访问 DB 的高性能系统中。

# java - 如何在 javadoc 内联标签中转义大括号，例如 {@code} 标签

> ID：647195
> 
> 赞同：45
> 
> 时间：2009-03-15T03:06:25.140
> 
> 标签：java, javadoc, escaping, curly-braces

```
/**
 * Gets the meatball icon for a nincompoop.
 * 
 * <p>
 * Example: {@code <custom:meatball color="<%= Meatball.RED %> nincompoop="${person}" />}
 * 
 * @author King Cong
 * 
 */ 
```

"${person}" 部分破坏了文档注释，因为它使用了花括号。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2010-08-04T08:24:14.753

与其说是一个解决方法，不如说是一个解决方法，但如果你`{@code ...}`用旧版本替换`<code>...</code>`它会按照你的期望呈现花括号。

```
<code>{person} == ${person}</code> 
```

不幸的是，这会破坏尖括号，因此对于原始问题，您需要转义这些：

```
<code>&lt;custom:meatball color="&lt;%= Meatball.RED %&gt; nincompoop="${person}" /&gt;</code> 
```

您甚至可以通过使用方便的 TextFX -> 转换 -> 编码 HTML (&<>") 让 Notepad++ 为您执行此操作来作弊。

这至少有一个好处，即在生成的 Javadoc 和 Eclipse 中的 Javadoc 视图中，一切都很好地呈现，这似乎并不理解`&#125;`和朋友。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-15T03:08:43.933

尝试使用 HTML 转义：

```
$&#123;person&#125; == ${person} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-07-28T08:45:18.357

bodunbodun 解决方案的工作原理通常是在 javadocs 中也有换行符。如果您同时需要 { 和换行符，则 HTML 转义将不起作用

```
<pre>
{@code
<foo bar="}${bar}{@code"/>
<bar foo="}${foo}{@code"/>
}
</pre> 
```

会给你

```
<foo bar="${bar}" />
<bar foo="${foo}" /> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-08T17:48:05.777

实际上我遇到了同样的问题——没有一个命题对我有用（HTML 转义不管什么原因都不起作用）。如果这有帮助 - 尝试在有问题的符号之前关闭 {@code} 并在之后重新打开它，如下所示：

{@code nincompoop=" **}${person}{@code** " />}

这似乎不是解决方案，但它有效，并且如果仔细使用不会破坏格式:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-06T10:37:44.787

至少从 Java 1.8.0_31 开始，我无法再重现该问题。您的输入按预期呈现：

```
<code>&lt;custom:meatball color="&lt;%= Meatball.RED %&gt; nincompoop="${person}" /&gt;</code> 
```

我的测试表明，`javadoc`考虑到内部的平衡花括号`@code`，并且仅在找到相应的花括号时才结束。

因此，如果代码像您的示例一样具有平衡的花括号`{}`，它现在可以按预期工作。

但我仍然不知道如何处理不平衡的花括号，例如：

```
{@code printf"}<b>outside</b>"} 
```

此外，行为取决于您使用的内联标签。`man javadoc`明确表示对于`@link`：

```
If you need to use the right brace (}) inside the label, then use the HTML entity notation &#125;. 
```

因此，在这种情况下，不可能做得更好。

不幸的是，我找不到`@code`支持我的实验的类似报价。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-08-12T04:38:37.620

为此找到了另一个不太出色的解决方法。它比其他的更好还是更差？我让你决定。取出`{@code }`零件并将其替换为`<code> </code>`。（由于尖括号，这使它全部消失。）首先`<`将其包裹起来`{@literal }`，使其看起来像这样`{@literal<}`。现在一切都会好起来的，而且在代码中并没有太可怕地被宰杀。最终结果如下所示

```
/**
 * Gets the meatball icon for a nincompoop.
 * 
 * <p>
 * Example: <code>{@literal<}custom:meatball color="<%= Meatball.RED %> nincompoop="${person}" /></code>
 * 
 * @author King Cong
 * 
 */ 
```

或者，如果您不喜欢`{@literal<}`，则可以`&lt;`改用。结果将如下所示：

```
/**
 * Gets the meatball icon for a nincompoop.
 * 
 * <p>
 * Example: <code> &lt;custom:meatball color="<%= Meatball.RED %> nincompoop="${person}" /></code>
 * 
 * @author King Cong
 * 
 */ 
```

两者都不是很好的解决方案，但它们确实有效。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-06-30T19:43:16.380

使用`{@literal}`，所以这样做`{@literal } }`。在我的测试中工作。

因此，对于您的情况，它看起来像这样：

```
/**
 * Gets the meatball icon for a nincompoop.
 * 
 * <p>
 * Example: {@code <custom:meatball color="<%= Meatball.RED %> nincompoop="${person{@literal } }" />}
 * 
 * @author King Cong
 * 
 */ 
```

# lotus-notes - 谁能提供有关我的 LotusScript 代理的反馈？

> ID：647198
> 
> 赞同：1
> 
> 时间：2009-03-15T03:07:32.110
> 
> 标签：lotus-notes, lotus-domino, lotusscript

您好，我不是开发人员，因此不了解最佳实践。我创建它是为了绕过日志数据的手动数据复制。此代理适用于单个提要，我将针对每个附加提要进行复制和调整。对于指定的提要，它会读取上次处理的日志以及今天和昨天处理的文件数。它还计算输入文件夹中的文件并读取服务器的时区。每个数据项用逗号分隔 csv 并通过电子邮件发送，稍后托管在网站上。感谢任何建设性的批评。

```
Sub Initialize
    Dim customername As String
    Dim servername As String
    Dim feedname As String
    Dim alertthresholdinhours As Integer
    Dim inputfeedpath As String

    ' Set for each feed
    customername = "gRrhio"
    servername = "gRrhioEdge2"
    feedname = "FF Thompson ADT"
    alertthresholdinhours = 6
    inputfeedpath = "\\mhinec\elycon\data\adt\*.*"

    ' Counts files in input folder
    Dim pathName As String, fileName As String
    Dim inputfeedcounter As Integer
    inputfeedcounter = 0
    pathName$ = inputfeedpath
    fileName$ = Dir$(pathName$, 0)
    Do While fileName$ <> ""
        inputfeedcounter = inputfeedcounter + 1
        fileName$ = Dir$()
    Loop

    Dim entry As NotesViewEntry   
    Dim vc As NotesViewEntryCollection
    Dim filesprocessed As Integer
    Dim session As New NotesSession
    Dim db As NotesDatabase
    Dim newDoc As NotesDocument
    Dim rtitem As NotesRichTextItem
    Set db = session.CurrentDatabase
    Dim view As NotesView
    Set view = db.GetView( "Sessions\by Feed" )
    Set newDoc = New NotesDocument( db )
    Set rtitem = New NotesRichTextItem( newDoc, "Body" )
    Dim todaysdate As New NotesDateTime("Today")
    Dim flag As Integer
    Dim counter As Integer
    Dim files As Integer
    Dim errors As Integer
    Dim lastdate As String
    Dim lastdayran As String
    Dim lasttime As String
    Dim lasttimeran As String
    Dim filesp As Integer
    Dim lastdayfiles As Integer
    Dim lastdaysfiles2 As Integer
    Dim terrors As Integer
    Dim lastdayerrors As Integer
    lastdate = ""
    lastdayran = ""
    counter = 0
    flag = 0
    filesp = 0
    lastdayfiles = 0
    lastdaysfiles2 = 0
    terrors = 0
    lastdayerrors = 0

    ' Finds date for last time processed, counts files processed and errors
    While flag = 0
        Dim dateTime As New NotesDateTime(todaysdate.DateOnly)
        Dim keyarray(1) As Variant
        keyarray(0) = feedname
        Set keyarray(1) = dateTime

        Set vc = view.GetAllEntriesByKey(keyarray, False)   
        Set entry = vc.GetFirstEntry

        If entry Is Nothing Then
            Call todaysdate.AdjustDay(-1)
        End If

        While Not entry Is Nothing
            files = 0
            Forall colval In entry.ColumnValues
                If counter = 9 Then
                    counter = 0
                Elseif counter = 8 Then
                    counter = 9
                Elseif counter = 7 Then
                    counter = 8
                Elseif counter = 6 Then
                    errors = Cint(colval)
                    counter = 7
                Elseif counter = 5 Then
                    counter = 6
                Elseif counter = 4 Then
                    files = Cint(colval)               
                    counter = 5
                Elseif counter = 3 Then
                    counter = 4
                Elseif counter = 2 Then
                    counter = 3
                    lasttime = colval
                Elseif counter = 1 Then
                    counter = 2
                    lastdate = colval
                Elseif counter = 0 Then
                    counter =  1
                End If           
            End Forall
            filesp = filesp + files
            terrors = terrors + errors
            Set entry=vc.GetNextEntry (entry)
            flag = 1
        Wend
    Wend
    lastdayfiles = filesp
    lastdayerrors = terrors
    lastdayran = lastdate
    lasttimeran = lasttime

    'Counts previous files processed
    filesp = 0
    terrors = 0
    lastdate = ""
    flag = 0
    Call todaysdate.AdjustDay(-1)   
    While flag = 0
        Dim dateTime2 As New NotesDateTime(todaysdate.DateOnly)
        Dim keyarray2(1) As Variant
        keyarray2(0) = feedname
        Set keyarray2(1) = dateTime2
        Set vc = view.GetAllEntriesByKey(keyarray2, False)   
        Set entry = vc.GetFirstEntry

        If entry Is Nothing Then
            Call todaysdate.AdjustDay(-1)
        End If

        While Not entry Is Nothing
            files = 0
            Forall colval In entry.ColumnValues
                If counter = 9 Then
                    counter = 0
                Elseif counter = 8 Then
                    counter = 9
                Elseif counter = 7 Then
                    counter = 8
                Elseif counter = 6 Then
                    counter = 7
                Elseif counter = 5 Then
                    counter = 6
                Elseif counter = 4 Then
                    files = Cint(colval)               
                    counter = 5
                Elseif counter = 3 Then
                    counter = 4
                Elseif counter = 2 Then
                    counter = 3
                Elseif counter = 1 Then
                    counter = 2
                Elseif counter = 0 Then
                    counter =  1
                End If           
            End Forall
            filesp = filesp + files
            Set entry=vc.GetNextEntry (entry)
            flag = 1
        Wend
    Wend
    lastdaysfiles2 = filesp

    ' Prints line of CSV into body of email
    Call rtitem.AppendText ( customername )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( servername )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( datetime.timezone )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( lastdayran )
    Call rtitem.AppendText ( " " )
    Call rtitem.AppendText ( lasttimeran )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( lastdayfiles )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( lastdayerrors )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( lastdaysfiles2 )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( inputfeedcounter )
    Call rtitem.AppendText ( ", " )
    Call rtitem.AppendText ( alertthresholdinhours )
    Call newDoc.Save( False, True )
    newDoc.Subject = feedname
    ' Running from server line should be
    'newDoc.SendTo = "Ecmon Feedcheck/Ecmonitor@ECMONITOR"
    newDoc.SendTo = "AX1Forward Feedcheck/ACHQ@company.com"
    newDoc.Send( False )
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T17:38:40.060

因为不是开发人员，你可以写很多代码:)

如果您正在寻找一些课程来开始成为一名优秀的开发人员，那么请采纳 Mitch 的建议（来自评论）并将其分解为子例程。第 1 课：这里肯定有一些重复的代码，将重复的代码放入方法（函数或子例程）中总是一个好主意，这样它只存在一次。计算已处理文件和已处理文件的部分看起来很相似，可能可以放入如下例程中：

```
Function GetCountFilesProcessed() As Integer

    'code here

End Function 
```

但是，如果我正确理解您的代码，您甚至可以节省对它的需求。而不是在中间做那个奇怪的循环，看起来你只是试图从一个视图条目的列中获取一个值。假设您对第 4 列的值感兴趣。您可以通过索引访问它来简单地获取所需列的值。例如，您的 files 变量可以通过此行直接设置为第 4 列的值

```
files = Cint(entry.ColumnValues(4))  'check this, it might be 3 if the array is zero based. 
```

无论如何，底线是如果此代码有效，那么您将有一个良好的开端！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T00:41:26.157

在更多的风格方面，我总是发现维护其他人的代码更容易

1.  在声明`Option 'Explicit'`部分声明
2.  声明的变量从大约高到低（例如，在 db 之前的会话之前在 doc 之前的视图）
3.  带有前缀的注释对象及其类型（docMail、dbMyDatabase、viewOutstandingInvoices）
4.  将所有声明放在前面（有助于在遇到变量时找到声明）
5.  正如其他人所提到的，在适用的情况下将其分解为函数/子项。

您关于为相同问题的其他实例复制此代理的评论也引发了一个标志。尝试找出这些代理之间的共同点并将这些功能推送到脚本库中。这种事情在维护代码时可以节省大量时间，因为您无需考虑每个代理的不同之处（例如，我的更改是否适用于该代理的所有实例，还是仅适用于其中一些？）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-30T13:12:14.050

你想要更多地分解你的代码并且......一件小事。代替

```
while not item is nothing 
```

这是双重否定和流行的脑筋急转弯..写：

```
do until item is nothing
  ...
loop 
```

这也允许您使用 exit do 跳出循环

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-07T12:18:43.130

您可以优化两个 ForAll 循环。这是第一个的样子：

```
Forall colval In entry.ColumnValues
    Select Case (counter)
        Case 1: lastdate = colval
        Case 2: lasttime = colval
        Case 4: files = Cint(colval) 
        Case 6: errors = Cint(colval)
    End Select
    counter = (counter + 1) Mod 10    
End Forall 
```

这是第二个的样子：

```
Forall colval In entry.ColumnValues
    if (counter = 4) Then files = Cint(colval)
    counter = (counter + 1) Mod 10
End Forall 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T02:57:42.820

只是关于这个位的注释

```
 While Not entry Is Nothing
        files = 0            
        Forall colval In entry.ColumnValues
            If counter = 9 Then
                counter = 0
            Elseif counter = 8 Then
                counter = 9
    .... 
```

正如 ken 所说，您可以使用 entry.ColumnValues(x) 方法获取 columnValues，因此不需要对这些值进行交互。但; 你可以这样做

```
 While Not entry Is Nothing
        files = 0            
        counter = 0
        Forall colval In entry.ColumnValues
            counter = counter + 1
            Select case counter
                case 6
                    errors = Cint(colval)
      .....
            end select 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-25T21:39:55.703

已经有一些好处了。如果您有共享公共对象的变量，则要添加到它们中，然后创建一个类。将变量添加到该类。

所以不要说：

```
Dim userFullName as String
Dim age as Integer
Dim addressLine1 as String
' ... etc. 
```

你可以有：

```
Class UserDetails 
  Dim fullName as String
  Dim age as Integer
  Dim addressLine1 as String
  ' ... etc
End Class 
```

和参考：

```
Dim u as new UserDetails
u.fullName = "full name"
u.age = 22
u.addressLine1 = "1 main street" 
```

这样做的好处是您可以添加方法来操作该数据，并且您知道代码与该对象相关，而不是在您的应用程序中搜索。

# sql - 不那么独特的列上的聚集索引插入性能？

> ID：647200
> 
> 赞同：1
> 
> 时间：2009-03-15T03:07:52.687
> 
> 标签：sql, sql-server

根据您的经验，在非典型唯一列上使用聚集索引时，插入性能大约会变得无法忍受多少？

我能想到的一个很好的例子是堆栈溢出的注释表。如果评论表的答案或问题表的外键上有聚集索引，您认为插入性能是否可以接受？我假设这将为通常查询评论的方式带来最快的读取性能。

我经常读到应该为唯一值列保留聚集索引，但是如果有问题的表最常被该索引查询怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T03:13:03.517

这取决于：

*   行的大小
*   在填充因子上（即索引中剩余的空间）
*   表上的非聚集索引数
*   索引重新组织的频率（注意：当聚集索引位于单调递增的键上时并不那么重要）

您应该针对您的特定情况进行基准测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T07:44:06.657

您应该始终尝试保持聚集索引的唯一性。对于具有大量插入的表，int 标识是一个不错的选择，因为插入的页面通常位于内存中，从而减少了磁盘访问。

如果你不让你的聚集索引唯一，SQL Server 会为你做这件事，因为它仍然需要能够以某种方式找到特定的行。维护唯一性将花费一些东西。

那么，如果您希望评论表上的聚集索引成为帖子 ID，该怎么办。这可能很有用，因为查找帖子的所有评论变得非常快，所有信息都在磁盘上的同一区域中。

没问题，通过向其添加更多列来使索引唯一：例如：

```
create unique clustered index pk_comment(post_id, comment_id) 
```

但是......拥有这个索引意味着您的索引不再单调增加，这可能会影响插入性能。它还可能影响页面拆分的数量。

因此，我的建议是保持简单，只需在comment_id 上添加一个主键，然后根据需要分析应用程序添加涵盖的索引。只有当数据在磁盘上的底层布局成为问题时，您才应该考虑将事情复杂化。

# database - 什么是“大数据库”？

> ID：647210
> 
> 赞同：84
> 
> 时间：2009-03-15T03:18:46.280
> 
> 标签：database

好的，我知道愚蠢的问题，但我看到“大型数据库”以及中小型数据库的模糊评论，我想知道这意味着什么。有人可以为我们 SQL 新手定义什么是小型、中型和大型数据库吗？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2009-03-15T03:23:51.650

小型数据库变为中型数据库或中型数据库变为大型数据库没有阈值。通常，当我听到这些术语时，我会想到存储的总记录数的特定数量级。

*   小：适合电子表格。
*   中：适合商用服务器的内存。
*   大：适合商品云产品。
*   非常大：适合特殊环境；不寻常的存储、延迟或吞吐量特性。

正如海报*dkretz 所*建议的那样，您也可以根据每种数据库的属性来考虑它。以这种方式分类，我会说：

*   小：性能不是问题。您的查询运行良好，无需进行任何特殊优化。使用索引等一线增强功能时，您只会看到微小的性能差异。

*   中：您的数据库可能有一名或多名员工被指派兼职进行维护和维护。这些人关注数据库的健康；他们的主要管理职责是防止出现不可接受的性能问题并最大限度地减少停机时间。

*   大：可能有专门的工作人员，他们的工作是处理数据库并提高性能，以及确保应用程序更改不会在数据库的生命周期内导致模式破坏。密切监视有关数据库运行状况和状态的指标。理解和执行优化需要大量专业知识。

*   非常大：数据库存储了大量必须易于访问的信息。绝对需要性能优化来从每个查询中榨取最后一盎司的速度，如果没有它，数据库的可用性将大大降低，甚至无法使用。该数据库可能正在使用复杂或创新的复制或集群技术，从而突破了当前技术的界限。

请注意，这些完全是主观的，并且某人很可能对“大”有一个完全合法的替代定义。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-03-15T03:23:47.547

一种计算方法是观察您的测试查询。

小型数据库是索引无关紧要的数据库。

如果您没有适当的索引，则中等数据库是查询时间超过一秒的数据库。

大型数据库是查询通常需要数小时才能优化的数据库，它结合了查询设计、索引修改和许多测试周期。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T04:27:06.053

大型数据库迫使您必须停止使用关系数据库。

换句话说，一个规范化的关系数据库，由于大量的 JOIN，世界上所有的索引都无法帮助您满足您的响应时间要求。

如果您曾经为了其他事情不得不放弃关系数据库，那么您要么是一个糟糕的数据库开发人员，要么没有专业的 DBA，要么拥有一个非常大的数据库。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-15T04:28:35.927

“大型数据库”确实是一个模糊的概念。在这个问题的答案中已经发布了非常不同的答案和意见。定义“小型”、“中型”和“大型”数据库的一些方法可能比其他方法更有意义，但在某些时候，我认为每个定义都是正确、真实和有效的。

有些定义比其他定义更有意义，因为它们侧重于对数据库的设计、编程、使用、维护和管理具有重要意义的不同方面，而这些不同方面对于可用的数据库来说真正重要。碰巧所有这些方面都受到“数据库大小”这个模糊概念的影响。

那么，这是否意味着您是否能够定义特定数据库是否很大并不重要？

当然不是。这意味着您将在评估数据库的不同设计/操作/管理方面时以不同的方式应用该概念。这也意味着每次这个概念都会模糊不清。

例如：数据库索引策略（数据库设计的一个方面）受每个表的记录数（“大小”的度量）、记录大小乘以记录数（“大小”的另一个度量）和查询 Vs 的影响. 创建/更新/删除操作比率（数据库使用的一个方面）。

如果索引用于具有大量记录的表，则查询响应时间会更好。根据 WHERE、ORDER BY 和记录聚合子句的性质，某些表可能需要多个索引。

随着受影响表上索引数量的增加，创建、更新和删除操作会受到负面影响。受影响表的更多索引意味着 RDBMS 必须执行更多更改，从而花费更多时间和更多资源来应用这些更改。

此外，如果您的 RDBMS 花费更多时间来应用这些更改，那么锁的维护时间也会更长，从而影响同时发送到系统的其他查询的响应时间。

那么，您如何平衡索引的数量和设计？您如何知道是否需要额外的索引，以及通过添加该索引是否不会对查询响应时间产生很大的负面影响？答：您根据负载/性能要求针对目标负载测试和分析数据库，并分析分析数据以发现是否需要进一步优化/重新设计/索引。

不同的 Query Vs 需要不同的索引策略。创建/更新/删除操作比率。如果您的数据库承受大量查询负载但很少更新，则如果您添加每个索引以提高查询响应时间，则整个应用程序的性能将会更好。另一方面，如果你的数据库是不断更新的，但没有大的查询操作，那么使用更少的索引性能会更好。

当然还有其他方面：数据库模式设计，存储策略，网络设计，备份策略，存储过程/触发器/等。编程、应用程序编程（针对数据库）等。所有这些方面都受到不同“大小”概念（记录大小、记录计数、索引大小、索引计数、模式设计、存储大小等）的不同影响。

我想有更多的时间，因为这个话题很有趣。我希望这个小小的贡献可以作为你进入这个迷人的 SQL 世界的起点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-15T18:40:08.687

您必须考虑此定义的硬件进步：

1.  小型数据库：工作集适合单个商品服务器的物理 RAM（现在大约 16GB）

2.  中型数据库：适合单台机器上的单个或多个（通过 RAID）商品硬盘驱动器（现在最多几个 TB）

3.  大型数据库：数据需要分布在多个商品服务器上才能适应（现在最多几个 PB。）

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-15T03:23:54.617

根据维基百科关于[超大数据库的文章](http://en.wikipedia.org/wiki/Very_large_database)

> 一个非常大的数据库，或 VLDB，是一个包含非常多的元组（数据库行），或者占用非常大的物理文件系统存储空间的数据库。VLDB 最常见的定义是占用超过 1 TB 或包含数十亿行的数据库，当然这个定义会随着时间而改变。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-16T18:02:44.917

如果您有一个足够大的数据库，以至于您不能仅仅“备份”它以放在开发或测试盒上，那么您可能有一个“大型数据库”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T03:27:30.143

我认为像维基百科或美国人口普查数据之类的东西是一个“大”数据库。我的个人地址列表或待办事项是一个小型数据库。中等规模的数据库介于两者之间。

您可以尝试根据需要的服务器数量来定义大小。小型数据库是您在桌面上运行的应用程序的一个组件，中型数据库将是某个地方的单个 mysql（无论如何）服务器，而大型数据库将需要多个具有某种复制/故障转移支持的服务器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-04T00:40:53.527

或者，将数据库的“大小”视为*更改用于表示信息域的模式所需的时间*。（在实际实现中，数据库可能同时包含多个模式和不同的域。）

1.  Days = "小型数据库。"
2.  Weeks = "中型数据库。"
3.  月 = “大型数据库。”
4.  年 = “巨大的数据库。”

通过这种启发式，“大小”最终成为存储信息的一个方面以及*信息可以完全转换的速率*。随着数据量/行数的增加以及技术和实现的性能增加，这种基于时间的方法也保持了一些类似的如何影响设计决策的外观。

上述的一种变体是根据管理和日常维护所需的时间量来考虑“规模”。随着数据量的增加，备份、重建和升级等任务的时间也在增加。如果没有大量投资，这可能会超过此类任务的可用时间。

无论如何，**“大小”的关键因素是时间**。

# jquery - jQuery 问题

> ID：647227
> 
> 赞同：0
> 
> 时间：2009-03-15T03:28:59.690
> 
> 标签：jquery, html

我正在使用 jquery，以便当用户单击链接时，我会获得所述链接的 id，然后使用它来选择具有相同 id 的 li 项目并为其设置动画。好吧，至少这就是我想要做的......到目前为止我有：

```
$(function(){
        $('#slider-buttons a').click(function(){
        var x = $(this).attr('id');
        var y = $('#slider-stage-list li' + x);

        if(x == "inicio")
            $(this).animate({ "left" : "0px"},700);
        else
            $(this).animate({ "left" : (increment*3) + "px"},700);
    });
}); 
```

我尝试了各种组合，但我仍然无法让 'y' 具有与 x 相同 id 的列表项的值（点击的 url）...x 确实获得了正确的 id 但 y 仍然返回“未定义“ 充其量......这是随之而来的html代码......

```
<div id="slider-buttons">
    <a href="#" id="inicio">Inicio</a> <br />
    <a href="#" id="previous">&iquest;Qui&eacute;nes Somos?</a> <br /> 
    <a href="#" id="clases">Clases</a> <br />
    <a href="#" id="equipo">Equipo</a> <br />
    <a href="#" id="album">&Aacute;lbum</a> <br />
    <a href="#" id="especiales">Eventos Especiales</a> <br />
    <a href="#" id="#">Cont&aacute;ctanos</a> <br />
</div>
<div id="stage">
    <ul id="slider-stage-list">
        <li id="inicio">Inicio</li>
        <li id="nos">&iquest;Qui&eacute;nes Somos?</li>
        <li id="clases">Clases</li>
        <li id="equipo">Equipo</li>
        <li id="album">&Aacute;lbum</li>
        <li id="especiales">Eventos Especiales</li>
        <li id="#">Cont&aacute;ctanos</li>
    </ul>
</div> 
```

任何帮助将不胜感激=）

* * *

**编辑以回答 3 个回复**

如果我做任何这些，我会在 console.log(); “[对象对象]” =/

* * *

**编辑回答 BC**

感谢您的 HTML 更正，如果我写下你给我的 jquery 代码，我仍然会进入 console.log(); “[对象对象]”

* * *

**编辑因为我没有得到最后的回复**

如果我尝试这种方法，我要么得到“[object Object]”，要么什么都没有......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T03:32:43.003

不，不

这是无效的 html，因为您的链接与您的列表项共享相同的 id。

您的代码应该看起来更像这样：

```
<div id="slider-buttons">
    <a href="#" id="inicio">Inicio</a> <br />
    <a href="#" id="previous">&iquest;Qui&eacute;nes Somos?</a> <br /> 
    <a href="#" id="clases">Clases</a> <br />
    <a href="#" id="equipo">Equipo</a> <br />
    <a href="#" id="album">&Aacute;lbum</a> <br />
    <a href="#" id="especiales">Eventos Especiales</a> <br />
    <a href="#" id="contactanos">Cont&aacute;ctanos</a> <br />
</div>
<div id="stage">
    <ul id="slider-stage-list">
        <li id="item_inicio">Inicio</li>
        <li id="item_previous">&iquest;Qui&eacute;nes Somos?</li>
        <li id="item_clases">Clases</li>
        <li id="item_equipo">Equipo</li>
        <li id="item_album">&Aacute;lbum</li>
        <li id="item_especiales">Eventos Especiales</li>
        <li id="item_contactanos">Cont&aacute;ctanos</li>
    </ul>
</div> 
```

和

```
$(function(){
        $('#slider-buttons a').click(function(){
        var x = $(this).attr('id');
        var y = $('li#item_' + x);

        if(x == "inicio")
                $(this).animate({ "left" : "0px"},700);
        else
                $(this).animate({ "left" : (increment*3) + "px"},700);
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T03:36:18.313

```
var y = $('#slider-stage-list li' + x); 
```

应该

```
var y = $('#slider-stage-list li#' + x);
// or
var y = $('#' + x);
// or
var y = $(this); 
```

提到的第三个选项可能是最好的。

但是，您有一个问题：您`id`的 ' 不是唯一的。这可能是您正在寻找的（无需修改您的 HTML）：

```
var y = $('#slider-stage-list li').filter(function() {
    return $(this).attr('id') == x;
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-15T03:32:03.677

我相信你缺少一个井号来使用 ID 选择器。试试这个：

```
 var x = $(this).attr('id');
    var y = $('#slider-stage-list li#' + x); // Note the 'li#' instead of just 'li'. 
```

# javascript - Javascript回调函数问题

> ID：647235
> 
> 赞同：0
> 
> 时间：2009-03-15T03:32:18.230
> 
> 标签：javascript, jquery, function, callback

## 背景

我正在为我的网站编写一个异步评论系统，在阅读了大量关于如何实现这一点的教程之后，我开始从头开始构建一个。使用 JSON 请求提取评论并使用 Javascript (jQuery) 显示。当用户添加新评论时，它会经过循环，最后通过 AJAX 发送到后端，然后将其添加到数据库中。在 AJAX 请求的成功部分，我让脚本清空评论，然后拉出新列表（包括新帖子）并重新显示它们。

## 问题

虽然这一切都很好，因为它使页面更短，然后更长的时间它弄乱了用户查看页面的位置。我想让它重新调整页面回到评论列表的末尾（添加评论表单所在的位置）。它还重新启用了添加按钮，该按钮在单击时被禁用，以防止不耐烦的人发送垃圾邮件。

```
$('#commentList').empty();
getComments('blog', $('input#blogId').val());
window.location = "#addComment";
$('#comAdd').removeAttr('disabled'); 
```

虽然这在理论上工作得很好而且很好，但浏览器似乎领先于自己并在 getComments 函数完成之前处理了 window.location 。所以我阅读了更多内容并在谷歌上搜索，似乎人们在说（针对类似问题）使用回调函数，所以我想出了这个：

```
$('#commentList').empty();
getComments('blog', $('input#blogId').val(), function() {
    window.location = "#addComment";
    $('#comAdd').removeAttr('disabled');
}); 
```

根据 FireFox，这不会产生任何 javascript 错误，但回调函数中没有任何工作，它没有重新启用按钮，也没有更改 window.location。

有任何想法吗？更好的解决方法？我是否有一个我看不到的明显错字？

谢谢！

## 更新

我的印象是回调函数是你可以使用的标准东西。

```
function getComments(type, id)
{

    $.getJSON("/ajax/"+type+"/comments?jsoncallback=&id="+id, function(data) {
        for (var x = 0; x < data.length; x++)
        {
            var div = $("<div>").addClass("comment").appendTo("#commentList");
            var fieldset = $("<fieldset>");
            var legend = $("<legend>").addClass("commentHeader");
            if ( data[x].url == "" )
            {
                legend.text((x+1) + ' - ' + data[x].name);
            }
            else
            {
                $("<a>").attr({href: data[x].url}).text((x+1) + ' - ' + data[x].name).appendTo(legend);
            }
            legend.appendTo(fieldset);
            $("<div>").addClass("date").text(data[x].timestamp).appendTo(fieldset);
            $("<p>").addClass("comment").text(data[x].content).appendTo(fieldset);
            fieldset.appendTo(div);
        }
    });

} 
```

这在文档就绪时调用。提取所有评论并在#commentList div 中显示它们。当用户提交他/她的评论时，它会对 PHP 脚本执行 AJAX 请求，将新评论添加到数据库中，成功后我有这个：

```
$('#commentList').empty();
getComments('blog', $('input#blogId').val());
window.location = "#addComment";
$('#comAdd').removeAttr('disabled'); 
```

从页面中删除所有评论。使用 JSON 再次请求评论（包括用户新的评论）。将页面移动到 #addComment 锚点，该锚点将显示他们的新评论。重新启用添加评论按钮。

问题是浏览器在 getComments 函数完成渲染所有评论之前执行 window.location 行，因此随着页面的增长，用户不会在他们的新评论附近寻找任何地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T03:45:14.157

我希望这里的问题是您的 getComments() 函数（需要更多详细信息）。您提供的第三个参数是回调，但该函数实际上是否使用回调？它在做什么？

某些 jQuery 函数提供回调，但这不是自动功能。如果您正在等待用户输入评论，则需要在他们单击“完成”或执行任何操作时触发相关事件。

好的，试试这个：

```
function get_comments(type, id, callback) {
  $.getJSON("/ajax/"+type+"/comments?jsoncallback=&id="+id, function(data) {
    for (var x = 0; x < data.length; x++) {
      var div = $("<div>").addClass("comment").appendTo("#commentList");
      var fieldset = $("<fieldset>");
      var legend = $("<legend>").addClass("commentHeader");
      if ( data[x].url == "" ) {
        legend.text((x+1) + ' - ' + data[x].name);
      } else {
        $("<a>").attr({href: data[x].url}).text((x+1) + ' - ' + data[x].name).appendTo(legend);
      }
      legend.appendTo(fieldset);
      $("<div>").addClass("date").text(data[x].timestamp).appendTo(fieldset);
      $("<p>").addClass("comment").text(data[x].content).appendTo(fieldset);
      fieldset.appendTo(div);
      if (typeof callback != 'undefined') {
        callback();
      }
    }
  });
} 
```

**注意：**这里的区别是第三个参数提供给 get_comments() 这是一个回调，将在你的 $.getJSON() 回调结束时被调用。这将为您提供所需的正确顺序。

我可能还建议不要像那样构建 HTML，而是将其包含在您的页面中并根据需要隐藏/取消隐藏它。它往往比动态 HTML 性能更高并且问题更少（例如，新 HTML，除非您使用 $().live() 不会有相关的事件处理程序）。

**编辑：**根据评论使回调可选。使用上面的代码，您可以在没有或没有回调的情况下调用该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T04:30:16.390

简单的。收到请求并处理信息*后*，重新启用按钮并转到锚点。像这样：

```
function getComments(type, id)
{
    // ADDED
    $('#commentList').empty();

    $.getJSON("/ajax/"+type+"/comments?jsoncallback=&id="+id, function(data) {
        for (var x = 0; x < data.length; x++)
        {
                var div = $("<div>").addClass("comment").appendTo("#commentList");
                var fieldset = $("<fieldset>");
                var legend = $("<legend>").addClass("commentHeader");
                if ( data[x].url == "" )
                {
                        legend.text((x+1) + ' - ' + data[x].name);
                }
                else
                {
                        $("<a>").attr({href: data[x].url}).text((x+1) + ' - ' + data[x].name).appendTo(legend);
                }
                legend.appendTo(fieldset);
                    $("<div>").addClass("date").text(data[x].timestamp).appendTo(fieldset);
                    $("<p>").addClass("comment").text(data[x].content).appendTo(fieldset);
                fieldset.appendTo(div);
        }

        // ADDED
        window.location = "#addComment";
        $('#comAdd').removeAttr('disabled');
    });
} 
```

个人意见：与其获取*所有*评论，不如从某个日期获取评论？加载页面时，请在响应中包含服务器时间。Javascript 使用它在幕后进行查询（自动检查新评论）。JSON 响应包含一个新的服务器时间，用于下一个响应。

您将如何处理已删除的评论？简单：在您的数据库表中有一个 deleted_on 列，查询它，然后在 JSON 响应中将其与新帖子一起吐出。

`#addcomment`建议：用时间戳代替, ID 评论。

# c# - 以编程方式移动鼠标光标

> ID：647236
> 
> 赞同：23
> 
> 时间：2009-03-15T03:32:29.837
> 
> 标签：c#, internet-explorer, pinvoke, mouse-cursor

首先，我在[http://swigartconsulting.blogs.com/tech_blender/2005/08/how_to_move_the.html](http://swigartconsulting.blogs.com/tech_blender/2005/08/how_to_move_the.html)找到了这段代码：

```
public class Win32
{
    [DllImport("User32.Dll")]
    public static extern long SetCursorPos(int x, int y);

    [DllImport("User32.Dll")]
    public static extern bool ClientToScreen(IntPtr hWnd, ref POINT point);

    [StructLayout(LayoutKind.Sequential)]
    public struct POINT
    {
        public int x;
        public int y;
    }
} 
```

将以下代码粘贴到按钮的单击事件处理程序中：

```
Win32.POINT p = new Win32.POINT();
p.x = button1.Left + (button1.Width / 2);
p.y = button1.Top + (button1.Height / 2);

Win32.ClientToScreen(this.Handle, ref p);
Win32.SetCursorPos(p.x, p.y); 
```

这会将鼠标指针移动到按钮的中心。

这段代码很好用，但我似乎不知道如何扩展它。假设我有一个 Internet Explorer（嵌入在 Windows 窗体中）打开一个网页（一些我事先不知道的随机页面），其中有一个下拉列表框。我已经修改了上面的代码，将光标移动到下拉列表框（使用下面显示的鼠标单击方法下拉列表），并上下移动列表，突出显示每个项目作为鼠标指针过去了，但对于我的生活，我无法弄清楚如何让鼠标点击当前选定的项目以保持选择。我现在这样做的方式是下拉列表框刚刚关闭并且选择没有改变。我正在使用以下代码进行鼠标单击（确实使列表下拉）：

```
private static void MouseClick(int x, int y, IntPtr handle) //handle for the browser window
{
    IntPtr lParam = (IntPtr)((y << 16) | x); // The coordinates
    IntPtr wParam = IntPtr.Zero; // Additional parameters for the click (e.g. Ctrl)

    const uint downCode = 0x201; // Left click down code
    const uint upCode = 0x202; // Left click up code

    SendMessage(handle, downCode, wParam, lParam); // Mouse button down
    SendMessage(handle, upCode, wParam, lParam); // Mouse button up
} 
```

我确定我在这里遗漏了一些简单的东西，但是对于我的生活来说，我无法弄清楚它是什么。提前谢谢大家。

鲍勃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T04:15:34.257

我相信您缺少正确`WPARAM`的`WM_LBUTTONDOWN`消息，左键是 MK_LBUTTON

```
 #define MK_LBUTTON          0x0001 
```

# jquery - 从 RSS 提要中删除一段文本

> ID：647240
> 
> 赞同：0
> 
> 时间：2009-03-15T03:35:19.080
> 
> 标签：jquery, rss, simplepie

Twitter 的 RSS 提要显示名称为：

```
<name>johnDoe (John Doe)</name> 
```

有没有办法使用 php 或 javascript（最好是 jquery）来删除从第一个括号开始的所有内容？我只想显示用户名，而不是用户名和人的真实姓名。

其他详细信息：我正在使用 SimplePie 将 RSS 提要解析为页面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T03:46:26.713

我建议像往常一样解析 RSS 提要，然后`<name>`从解析的结构中获取元素的值，找到左括号的索引，并从前一个索引（即空格）开始修剪掉所有内容。就像是

```
var nameStr = ...; // get the value of <name>
var pIndex = nameStr.indexOf(" (");
if (pIndex) { // just make sure a parenthesis was in fact found
    nameStr = nameStr.substring(0, pIndex);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T22:01:03.807

```
<?php
   preg_match('/^([^\s@\(\)])/', $string_from_author_tag, $matches);
   $matches[0];// has what you want
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T22:34:19.747

也许看看[Yahoo Pipes](http://pipes.yahoo.com/pipes/) - 它可用于将 RSS 提要修改为可以做任何事情的后处理 RSS 提要，包括 REGEX 搜索和替换。

# amazon-ec2 - EBS 用于存储数据库与网站文件

> ID：647242
> 
> 赞同：12
> 
> 时间：2009-03-15T03:35:45.710
> 
> 标签：amazon-ec2, amazon-web-services, amazon-ebs

我花了一天时间第一次尝试 AWS。我已经运行了一个 EC2 实例，并安装了一个 Elastic Block Store (EBS) 来保存 MySQL 数据库。

将我的 Web 应用程序文件也放在 EBS 上是否有意义，还是应该将它们部署到普通的 EC2 文件系统？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-27T07:56:16.077

当您说您的 Web 应用程序文件时，我不确定您指的是什么。

如果您指的是已部署的代码，那么使用 EBS 可能没有意义。您要做的是使用您的先决条件创建一个 AMI，然后使用一个脚本来创建该 AMI 的一个实例并部署您的最新代码。我强烈建议您自动化并测试此过程，因为很容易忘记您必须在某处手动更改的某些设置。

如果您正在存储由正在运行的应用程序修改的数据文件，那么 EBS 可能是有意义的。如果这类似于用户上传的图像或类似内容，您可能会发现 S3 为您提供了一个更简单的模型。

EBS 适用于：数据库、lucene 索引、基于文件的 CMS、SVN 存储库或任何类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T02:28:49.403

EBS 为您提供持久存储，因此如果您的 EC2 实例失败，文件仍然存在。显然它们提高了 IO 性能，但我会对其进行测试以确定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-29T15:16:38.477

如果您的文件要经常更改（就像数据库一样）并且您不想继续将它们同步到 S3（或其他地方），那么 EBS 是一个不错的选择。如果您不经常进行更改，并且您可以根据需要手动（或脚本化）同步文件，然后将它们存储在 S3 中。如果您需要关闭或由于某种原因丢失了您的实例，您可以在启动新实例时将它们拉下来。这也是假设您关心成本。如果成本不是问题，使用 EBS 就不那么复杂了。我不确定您是否计划为您的数据库和您的 Web 文件使用单独的 EBS，但如果您只计划拥有一个 EBS 并且您有足够的空白空间用于您的 Web 文件，那么再次，EBS 不那么复杂. 如果您担心的是性能，如上所述，最好测试您的特定应用程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-20T05:08:38.113

Our approach is to have a script pre-deployed on our AMI that fetches the latest and greatest version of the code from source control. That makes it very straightforward to launch new instances quickly, or update all running instances (we take them out of the load balancing rotation one at a time, run the script, and put them back in the rotation).

UPDATE:

Reading between the lines it looks like you're mounting a separate EBS volume to an instance-store backed instance. AWS recently introduced EBS backed instances that have a ton of benefits vs. the old instance-store ones. I still mount my MySQL data on a separate EBS partition, though, so that I can easily mount it to a different server if needed.

I strongly suggest an EBS backed instance with a separate EBS volume for the MySQL data.

# javascript - XSL 中的脚本块未呈现

> ID：647245
> 
> 赞同：1
> 
> 时间：2009-03-15T03:37:05.893
> 
> 标签：javascript, xslt, scripting

我无法`<script></script>`在我的 XSL 模板中获得要呈现的块。它只是被解析器、块本身和其中的任何东西所忽略。顺便说一句，我正在使用 DotNetNuke 报告模块。关于如何解决这个问题的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T03:45:15.203

也许是一种 xss 预防措施，如果有这样的选项，请尝试是否可以关闭自动标签转义。

# asp.net-mvc - Visual Studio 是否缺少 ASP.NET MVC RC2 的文档？

> ID：647251
> 
> 赞同：1
> 
> 时间：2009-03-15T03:41:57.363
> 
> 标签：asp.net-mvc

我正在检查 ASP.NET MVC RC2。API 文档是否完全丢失？按F1应该能找到东西吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T05:12:17.740

尽管我已经使用 ASP.NET MVC 进行了大约一年的开发，但我个人还没有看到任何*正式*的文档。您可以在截屏视频和博客中找到最好的文档。查看[Stephen Walther 的 MVC 博客、](http://stephenwalther.com/blog/default.aspx) [Rob Conery 的 MVC Storefront project/adventure](http://blog.wekeroad.com/mvc-storefront/mvc-storefront-part-1/)，当然还有[http://asp.net/mvc](http://asp.net/mvc)。还有一[本很有前途的书](http://www.wrox.com/WileyCDA/WroxTitle/Professional-ASP-NET-MVC-1-0.productCd-0470384611.html)出来了。

我认为此时您不会找到任何类型的参考书或 MSDN 文档。您可能必须等待 RTM。

# java - 在 Java 游戏中使用音效

> ID：647252
> 
> 赞同：3
> 
> 时间：2009-03-15T03:43:39.653
> 
> 标签：java, audio, effects

基本上我试图在我正在为我的任务工作的一个简单的java游戏中使用这个SoundEffect类。

```
import java.io.*;
import java.net.URL;
import javax.sound.sampled.*;

/**
 * This enum encapsulates all the sound effects of a game, so as to separate the sound playing
 * codes from the game codes.
 * 1\. Define all your sound effect names and the associated wave file.
 * 2\. To play a specific sound, simply invoke SoundEffect.SOUND_NAME.play().
 * 3\. You might optionally invoke the static method SoundEffect.init() to pre-load all the
 *    sound files, so that the play is not paused while loading the file for the first time.
 * 4\. You can use the static variable SoundEffect.volume to mute the sound.
 */
public enum SoundEffect {
   EAT("eat.wav"),   // explosion
   GONG("gong.wav"),         // gong
   SHOOT("shoot.wav");       // bullet

   // Nested class for specifying volume
   public static enum Volume {
      MUTE, LOW, MEDIUM, HIGH
   }

   public static Volume volume = Volume.LOW;

   // Each sound effect has its own clip, loaded with its own sound file.
   private Clip clip;

   // Constructor to construct each element of the enum with its own sound file.
   SoundEffect(String soundFileName) {
      try {
         // Use URL (instead of File) to read from disk and JAR.
         URL url = this.getClass().getClassLoader().getResource(soundFileName);
         // Set up an audio input stream piped from the sound file.
         AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(url);
         // Get a clip resource.
         clip = AudioSystem.getClip();
         // Open audio clip and load samples from the audio input stream.
         clip.open(audioInputStream);
      } catch (UnsupportedAudioFileException e) {
         e.printStackTrace();
      } catch (IOException e) {
         e.printStackTrace();
      } catch (LineUnavailableException e) {
         e.printStackTrace();
      }
   }

   // Play or Re-play the sound effect from the beginning, by rewinding.
   public void play() {
      if (volume != Volume.MUTE) {
         if (clip.isRunning())
            clip.stop();   // Stop the player if it is still running
         clip.setFramePosition(0); // rewind to the beginning
         clip.start();     // Start playing
      }
   }

   // Optional static method to pre-load all the sound files.
   static void init() {
      values(); // calls the constructor for all the elements
   }
} 
```

这是我的游戏奖励类中 EAT 声音的实现-

```
public void react(CollisionEvent e)
    {
        Player player = game.getPlayer();
        if (e.contact.involves(player)) {
            player.changePlayerImageEAT();
            SoundEffect.EAT.play();
            player.addPoint();
            System.out.println("Player now has: "+player.getPoints()+ " points.");
            game.getCurrentLevel().getWorld().remove(this);
        }
    } 
```

当玩家在我的游戏中接触到奖励时，这应该会播放 EAT 声音。

但是，当我的玩家与奖励发生碰撞时，我在终端中收到以下错误-

> javax.sound.sampled.LineUnavailableException：行格式为 ALAW 8000.0 Hz，8 位，立体声，2 字节/帧，不支持。在 com.sun.media.sound.DirectAudioDevice$DirectDL.implOpen(DirectAudioDevice.java:494) 在 com.sun.media.sound.DirectAudioDevice$DirectClip.implOpen(DirectAudioDevice.java:1280) 在 com.sun.media.sound .AbstractDataLine.open(AbstractDataLine.java:107) 在 com.sun.media.sound.DirectAudioDevice$DirectClip.open(DirectAudioDevice.java:1061) 在 com.sun.media.sound.DirectAudioDevice$DirectClip.open(DirectAudioDevice.java :1151) 在 SoundEffect.(SoundEffect.java:39) 在 SoundEffect.(SoundEffect.java:15) 在 Reward.react(Reward.java:41) 在 city.soi.platform.World.despatchCollisionEvents(World.java:425) ) 在 city.soi.platform.World.step(World.java:608) 在 city.soi.platform。

我不知道出了什么问题。我猜这与我的音频文件（WAV）不受支持有关。但是，无论我转换它们的方式有多少，它们仍然不起作用。

如果有人能告诉我可能出了什么问题以及如何解决这个问题，那将非常有帮助。

示例代码和您可以提供以帮助使此代码正常工作的任何修改将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T04:02:07.393

您的根本原因异常是

```
javax.sound.sampled.LineUnavailableException:
 line with format ALAW 8000.0 Hz, 8 bit, stereo, 2 bytes/frame, not supported 
```

发生这种情况是因为并非所有声音驱动程序都支持所有比特率或编码，或者因为机器没有声卡。声音可以以[A 律](http://en.wikipedia.org/wiki/A-law_algorithm)或[mu 律](http://en.wikipedia.org/wiki/%CE%9C-law_algorithm)（或其他，例如 MP3）编码，并且可以以不同的比特率和样本大小进行编码。Java 并不总是支持所有可能的声音格式，这取决于基本系统支持的内容。

您可能想要执行以下操作：

*   确保您运行该程序的计算机具有合理的声卡。大多数情况下，当我看到上述异常时，我是在没有内置声卡或非常蹩脚的声卡或没有音频路径的服务器机器上运行的。
*   如果您使用的是远程终端或类似设备，请确保声音具有配置的播放方式。
*   尝试以不同的速率重新编码您的声音样本，或者作为 WAV 文件，然后尝试播放。

# python - 使用 Satchmo 向首选客户提供折扣？

> ID：647257
> 
> 赞同：1
> 
> 时间：2009-03-15T03:46:33.517
> 
> 标签：python, django, satchmo

我是 Satchmo 的新手——之所以选择它，是因为我需要处理网站订阅和实物产品的付款处理。

我的网站将有两类用户：付费用户和免费用户。两者都可以订购实物产品。付费订阅者会自动获得所有订单的折扣。

我在管理员中没有看到此配置。（折扣似乎适用于所有用户。如果我在这里遗漏了什么，请告诉我。）

那么根据用户类别自动覆盖价格的最佳位置是什么？显示的价格应该比网站各处的订阅者少 10%，而不仅仅是在结账时。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-29T07:57:12.120

查看分层定价模块

# javascript - JavaScript 查询字符串

> ID：647259
> 
> 赞同：106
> 
> 时间：2009-03-15T03:50:41.837
> 
> 标签：javascript, query-string

是否有任何 JavaScript 库可以根据查询字符串、`ASP.NET`样式制作字典？

可以使用的东西，例如：

```
var query = window.location.querystring["query"]? 
```

*“查询字符串”*是否被称为领域之外的其他东西`.NET`？为什么不`location.search`分成*键/值集合*？

**编辑**：我已经编写了自己的函数，但是任何主要的 JavaScript 库都这样做吗？

* * *

## 回答 #1

> 赞同：232
> 
> 时间：2009-03-15T04:08:10.937

[您可以从location.search](https://developer.mozilla.org/en/DOM/window.location)属性中提取键/值对，该属性具有跟在 ? 后面的 URL 部分。符号，包括 ? 象征。

```
function getQueryString() {
  var result = {}, queryString = location.search.slice(1),
      re = /([^&=]+)=([^&]*)/g, m;

  while (m = re.exec(queryString)) {
    result[decodeURIComponent(m[1])] = decodeURIComponent(m[2]);
  }

  return result;
}

// ...
var myParam = getQueryString()["myParam"]; 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-01-16T16:23:04.103

# *tl；dr*使用 vanilla javascript 在单行（ish）代码上的解决方案

```
var queryDict = {}
location.search.substr(1).split("&").forEach(function(item) {
    queryDict[item.split("=")[0]] = item.split("=")[1]
}) 
```

对于查询字符串`?a=1&b=2&c=3&d&e`，它返回：

```
> queryDict
a: "1"
b: "2"
c: "3"
d: undefined
e: undefined 
```

## *多值键*和*编码字符*?

请参阅[如何在 JavaScript 中获取查询字符串值？](https://stackoverflow.com/a/21152762/985454)

```
"?a=1&b=2&c=3&d&e&a=5&a=t%20e%20x%20t&e=http%3A%2F%2Fw3schools.com%2Fmy%20test.asp%3Fname%3Dståle%26car%3Dsaab"
> queryDict
a: ["1", "5", "t e x t"]
b: ["2"]
c: ["3"]
d: [undefined]
e: [undefined, "http://w3schools.com/my test.asp?name=ståle&car=saab"] 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-15T05:33:54.320

也许[http://plugins.jquery.com/query-object/](http://plugins.jquery.com/query-object/)？

这是它的分支[https://github.com/sousk/jquery.parsequery#readme](https://github.com/sousk/jquery.parsequery#readme)。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2011-11-20T17:50:47.763

找到这篇文章后，当我看着自己时，我想我应该补充一点，我认为投票最多的解决方案并不是最好的。它不处理数组值（例如 ?a=foo&a=bar - 在这种情况下，我希望得到 a 返回 ['foo', 'bar']）。据我所知，它也没有考虑编码值 - 例如十六进制字符编码，其中 %20 表示空格（例如：?a=Hello%20World）或用于表示空格的加号（例如: ?a=Hello+World)。

Node.js 提供了看起来非常完整的查询字符串解析解决方案。它很容易在您自己的项目中取出和使用，因为它相当隔离并在许可许可下。

它的代码可以在这里查看：[https ://github.com/joyent/node/blob/master/lib/querystring.js](https://github.com/joyent/node/blob/master/lib/querystring.js)

可以在这里看到 Node 的测试： [https](https://github.com/joyent/node/blob/master/test/simple/test-querystring.js) ://github.com/joyent/node/blob/master/test/simple/test-querystring.js我建议用流行的答案尝试其中的一些，看看它是如何处理它们。

我还参与了一个专门添加此功能的项目。它是 Python 标准库查询字符串解析模块的一个端口。我的叉子可以在这里找到：[https ://github.com/d0ugal/jquery.qeeree](https://github.com/d0ugal/jquery.qeeree)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-08-21T12:23:29.823

或者您可以使用库[sugar.js](http://sugarjs.com)。

来自sugarjs.com：

> **Object.fromQueryString ( str** , deep = true **)**
> 
> 将 URL 的查询字符串转换为对象。如果 deep 为 false，则转换将只接受浅参数（即没有具有 [] 语法的对象或数组），因为这些参数并非普遍支持。
> 
> ```
> Object.fromQueryString('foo=bar&broken=wear') >{"foo":"bar","broken":"wear"}
> Object.fromQueryString('foo[]=1&foo[]=2') >{"foo":[1,2]} 
> ```

例子：

```
var queryString = Object.fromQueryString(location.search);
var foo = queryString.foo; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-03T18:48:21.603

如果您手头有查询字符串，请使用以下命令：

```
 /**
 * @param qry the querystring
 * @param name name of parameter
 * @returns the parameter specified by name
 * @author eduardo.medeirospereira@gmail.com
 */

function getQueryStringParameter(qry,name){
    if(typeof qry !== undefined && qry !== ""){
        var keyValueArray = qry.split("&");
        for ( var i = 0; i < keyValueArray.length; i++) {
            if(keyValueArray[i].indexOf(name)>-1){
                return keyValueArray[i].split("=")[1];
            }
        }
    }
    return "";
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-16T17:46:27.840

```
// How about this
function queryString(qs) {
    var queryStr = qs.substr(1).split("&"),obj={};
    for(var i=0; i < queryStr.length;i++)
        obj[queryStr[i].split("=")[0]] = queryStr[i].split("=")[1];
    return obj;
}

// Usage:
var result = queryString(location.search); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-02-21T17:29:40.680

### 编码

[**Eldon McGuinness 的这篇 Gist**](https://gist.github.com/EldonMcGuinness/6bccc6a0c62f85c378a6)是迄今为止我见过的最完整的 JavaScript 查询字符串解析器实现。

不幸的是，它是作为一个 jQuery 插件编写的。

我将其重写为 vanilla JS 并进行了一些改进：

```
function parseQuery(str) {
  var qso = {};
  var qs = (str || document.location.search);
  // Check for an empty querystring
  if (qs == "") {
    return qso;
  }
  // Normalize the querystring
  qs = qs.replace(/(^\?)/, '').replace(/;/g, '&');
  while (qs.indexOf("&&") != -1) {
    qs = qs.replace(/&&/g, '&');
  }
  qs = qs.replace(/([\&]+$)/, '');
  // Break the querystring into parts
  qs = qs.split("&");
  // Build the querystring object
  for (var i = 0; i < qs.length; i++) {
    var qi = qs[i].split("=");
    qi = qi.map(function(n) {
      return decodeURIComponent(n)
    });
    if (typeof qi[1] === "undefined") {
      qi[1] = null;
    }
    if (typeof qso[qi[0]] !== "undefined") {

      // If a key already exists then make this an object
      if (typeof (qso[qi[0]]) == "string") {
        var temp = qso[qi[0]];
        if (qi[1] == "") {
          qi[1] = null;
        }
        qso[qi[0]] = [];
        qso[qi[0]].push(temp);
        qso[qi[0]].push(qi[1]);

      } else if (typeof (qso[qi[0]]) == "object") {
        if (qi[1] == "") {
          qi[1] = null;
        }
        qso[qi[0]].push(qi[1]);
      }
    } else {
      // If no key exists just set it as a string
      if (qi[1] == "") {
        qi[1] = null;
      }
      qso[qi[0]] = qi[1];
    }
  }
  return qso;
} 
```

### 如何使用它

```
var results = parseQuery("?foo=bar&foo=boo&roo=bar;bee=bop;=ghost;=ghost2;&;checkbox%5B%5D=b1;checkbox%5B%5D=b2;dd=;http=http%3A%2F%2Fw3schools.com%2Fmy%20test.asp%3Fname%3Dst%C3%A5le%26car%3Dsaab&http=http%3A%2F%2Fw3schools2.com%2Fmy%20test.asp%3Fname%3Dst%C3%A5le%26car%3Dsaab"); 
```

### 输出

```
{
  "foo": ["bar", "boo" ],
  "roo": "bar",
  "bee": "bop",
  "": ["ghost", "ghost2"],
  "checkbox[]": ["b1", "b2"],
  "dd": null,
  "http": [
    "http://w3schools.com/my test.asp?name=ståle&car=saab",
    "http://w3schools2.com/my test.asp?name=ståle&car=saab"
  ]
} 
```

另请参阅[**此 Fiddle**](http://jsfiddle.net/cb57dusv/45/)。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-02-21T21:53:49.860

值得注意的是，John Slegers 提到的库确实有一个 jQuery 依赖项，但是这里有一个香草 Javascript 版本。

[https://github.com/EldonMcGuinness/querystring.js](https://github.com/EldonMcGuinness/querystring.js)

我会简单地评论他的帖子，但我缺乏这样做的声誉。：/

## **例子：**

下面的示例处理以下查询字符串，尽管是不规则的：

```
?foo=bar&foo=boo&roo=bar;bee=bop;=ghost;=ghost2;&;checkbox%5B%5D=b1;checkbox%5B%5D=b2;dd=;http=http%3A%2F%2Fw3schools.com%2Fmy%20test.asp%3Fname%3Dst%C3%A5le%26car%3Dsaab&http=http%3A%2F%2Fw3schools2.com%2Fmy%20test.asp%3Fname%3Dst%C3%A5le%26car%3Dsaab 
```

```
var qs = "?foo=bar&foo=boo&roo=bar;bee=bop;=ghost;=ghost2;&;checkbox%5B%5D=b1;checkbox%5B%5D=b2;dd=;http=http%3A%2F%2Fw3schools.com%2Fmy%20test.asp%3Fname%3Dst%C3%A5le%26car%3Dsaab&http=http%3A%2F%2Fw3schools2.com%2Fmy%20test.asp%3Fname%3Dst%C3%A5le%26car%3Dsaab";
//var qs = "?=&=";
//var qs = ""

var results = querystring(qs);

(document.getElementById("results")).innerHTML =JSON.stringify(results, null, 2);
```

```
<script 
src="https://rawgit.com/EldonMcGuinness/querystring.js/master/dist/querystring.min.js"></script>
<pre id="results">RESULTS: Waiting...</pre>
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-15T05:02:03.163

```
 function decode(s) {
    try {
        return decodeURIComponent(s).replace(/\r\n|\r|\n/g, "\r\n");
    } catch (e) {
        return "";
    }
}
function getQueryString(win) {
    var qs = win.location.search;
    var multimap = {};
    if (qs.length > 1) {
        qs = qs.substr(1);
        qs.replace(/([^=&]+)=([^&]*)/g, function(match, hfname, hfvalue) {
            var name = decode(hfname);
            var value = decode(hfvalue);
            if (name.length > 0) {
                if (!multimap.hasOwnProperty(name)) {
                    multimap[name] = [];
                }
                multimap[name].push(value);
            }
        });
    }
    return multimap;
}
var keys = getQueryString(window);
for (var i in keys) {
    if (keys.hasOwnProperty(i)) {
        for (var z = 0; z < keys[i].length; ++z) {
            alert(i + ":" + keys[i][z]);
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-06-12T08:20:41.887

**我喜欢保持简单、易读和小。**

```
function searchToObject(search) {
    var pairs = search.substring(1).split("&"),
        obj = {}, pair;

    for (var i in pairs) {
        if (pairs[i] === "") continue;
        pair = pairs[i].split("=");
        obj[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);
    }
    return obj;
}

searchToObject(location.search); 
```

**例子：**

```
searchToObject('?query=myvalue')['query']; // spits out: 'myvalue' 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2014-07-31T15:16:37.400

我为与纯javascript字符串操作类似的要求编写的函数

```
"http://www.google.lk/?Name=John&Age=20&Gender=Male"

function queryize(sampleurl){
    var tokens = url.split('?')[1].split('&');
    var result = {};

    for(var i=0; i<tokens.length; i++){
        result[tokens[i].split('=')[0]] = tokens[i].split('=')[1];
    }

    return result;
} 
```

用法：

```
queryize(window.location.href)['Name'] //returns John
queryize(window.location.href)['Age'] //returns 20
queryize(window.location.href)['Gender'] //returns Male 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-12-10T21:34:57.883

如果您使用的是 lodash + ES6，这里有一个单行解决方案： `_.object(window.location.search.replace(/(^\?)/, '').split('&').map(keyVal => keyVal.split('=')));`

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-15T04:14:52.107

好吧，既然每个人都忽略了我的实际问题，呵呵，我也会发布我的！这是我所拥有的：

```
location.querystring = (function() {

    // The return is a collection of key/value pairs

    var queryStringDictionary = {};

    // Gets the query string, starts with '?'

    var querystring = unescape(location.search);

    // document.location.search is empty if no query string

    if (!querystring) {
        return {};
    }

    // Remove the '?' via substring(1)

    querystring = querystring.substring(1);

    // '&' seperates key/value pairs

    var pairs = querystring.split("&");

    // Load the key/values of the return collection

    for (var i = 0; i < pairs.length; i++) {
        var keyValuePair = pairs[i].split("=");
        queryStringDictionary[keyValuePair[0]] = keyValuePair[1];
    }

    // Return the key/value pairs concatenated

    queryStringDictionary.toString = function() {

        if (queryStringDictionary.length == 0) {
            return "";
        }

        var toString = "?";

        for (var key in queryStringDictionary) {
            toString += key + "=" + queryStringDictionary[key];
        }

        return toString;
    };

    // Return the key/value dictionary

    return queryStringDictionary;
})(); 
```

和测试：

```
alert(window.location.querystring.toString());

for (var key in location.querystring) {
    alert(key + "=" + location.querystring[key]);
} 
```

请注意，JavaScript 不是我的母语。

无论如何，我正在寻找一个已经编写好的 JavaScript 库（例如 jQuery、Prototype）。:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-10-17T19:16:26.383

基于@CMS 的答案，我有以下内容（在可以轻松转换为 JavaScript 的 CoffeeScript 中）：

```
String::to_query = ->
  [result, re, d] = [{}, /([^&=]+)=([^&]*)/g, decodeURIComponent]
  while match = re.exec(if @.match /^\?/ then @.substring(1) else @)
    result[d(match[1])] = d match[2] 
  result 
```

您可以通过以下方式轻松获取所需内容：

```
location.search.to_query()['my_param'] 
```

这里的胜利是面向对象的接口（而不是函数式），它可以在任何字符串上完成（不仅仅是 location.search）。

如果您已经在使用 JavaScript 库，则此函数已存在。例如[这里是原型的版本](http://api.prototypejs.org/language/String/prototype/toQueryParams/)

# objective-c - 深拷贝一个 NSArray

> ID：647260
> 
> 赞同：121
> 
> 时间：2009-03-15T03:54:17.163
> 
> 标签：objective-c, cocoa-touch, cocoa, nsarray, deep-copy

是否有任何内置函数可以让我深拷贝一个`NSMutableArray`?

我环顾四周，有人说`[aMutableArray copyWithZone:nil]`作为深拷贝工作。但我试过了，它似乎是一个浅拷贝。

现在我正在使用`for`循环手动进行复制：

```
//deep copy a 9*9 mutable array to a passed-in reference array

-deepMuCopy : (NSMutableArray*) array 
    toNewArray : (NSMutableArray*) arrayNew {

    [arrayNew removeAllObjects];//ensure it's clean

    for (int y = 0; y<9; y++) {
        [arrayNew addObject:[NSMutableArray new]];
        for (int x = 0; x<9; x++) {
            [[arrayNew objectAtIndex:y] addObject:[NSMutableArray new]];

            NSMutableArray *aDomain = [[array objectAtIndex:y] objectAtIndex:x];
            for (int i = 0; i<[aDomain count]; i++) {

                //copy object by object
                NSNumber* n = [NSNumber numberWithInt:[[aDomain objectAtIndex:i] intValue]];
                [[[arrayNew objectAtIndex:y] objectAtIndex:x] addObject:n];
            }
        }
    }
} 
```

但我想要一个更干净、更简洁的解决方案。

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2009-03-15T09:18:24.247

正如[有关深拷贝的 Apple 文档](https://developer.apple.com/library/mac/documentation/cocoa/conceptual/Collections/Articles/Copying.html#//apple_ref/doc/uid/TP40010162-SW3)明确指出的那样：

> 如果只需要*一级深*拷贝：
> 
> ```
> NSMutableArray *newArray = [[NSMutableArray alloc] 
>                              initWithArray:oldArray copyItems:YES]; 
> ```

上面的代码创建了一个新数组，其成员是旧数组成员的浅表副本。

请注意，如果您需要深度复制整个嵌套数据结构（链接的 Apple 文档称为*真正的深度复制*），那么这种方法是不够的。请在此处查看其他答案。

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2009-03-15T04:04:55.373

我知道轻松做到这一点的唯一方法是存档，然后立即取消存档您的阵列。感觉有点像 hack，但实际上在[Apple Documentation on copying collections](https://developer.apple.com/library/mac/documentation/cocoa/conceptual/Collections/Articles/Copying.html#//apple_ref/doc/uid/TP40010162-SW3)中明确建议，其中指出：

> 如果你需要一个真正的深拷贝，比如当你有一个数组时，你可以归档然后解归档集合，前提是内容都符合 NSCoding 协议。清单 3 显示了这种技术的一个示例。
> 
> ### 清单 3 一个真正的深拷贝
> 
> ```
> NSArray* trueDeepCopyArray = [NSKeyedUnarchiver unarchiveObjectWithData:
>           [NSKeyedArchiver archivedDataWithRootObject:oldArray]]; 
> ```

问题是您的对象必须支持 NSCoding 接口，因为这将用于存储/加载数据。

## 斯威夫特 2 版本：

```
let trueDeepCopyArray = NSKeyedUnarchiver.unarchiveObjectWithData(
    NSKeyedArchiver.archivedDataWithRootObject(oldArray)) 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2013-02-23T12:57:53.963

## 默认情况下，复制提供浅拷贝

这是因为调用与使用默认区域进行复制`copy`相同。`copyWithZone:NULL`该`copy`调用不会导致深层复制。在大多数情况下，它会给你一个浅拷贝，但无论如何它取决于类。对于全面的讨论，我推荐Apple Developer 网站上的[Collections Programming Topics 。](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Collections/Articles/Copying.html#//apple_ref/doc/uid/TP40010162-SW1)

## initWithArray:CopyItems: 提供一级深拷贝

```
NSArray *deepCopyArray = [[NSArray alloc] initWithArray:someArray copyItems:YES]; 
```

## `NSCoding`是 Apple 推荐的提供深拷贝的方式

对于真正的深层副本（数组数组），您将需要`NSCoding`并归档/取消归档对象：

```
NSArray *trueDeepCopyArray = [NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject:oldArray]]; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-10-14T10:52:57.583

**对于字典**

`NSMutableDictionary *newCopyDict = (NSMutableDictionary *)CFPropertyListCreateDeepCopy(kCFAllocatorDefault, (CFDictionaryRef)objDict, kCFPropertyListMutableContainers);`

**对于数组**

`NSMutableArray *myMutableArray = (NSMutableArray *)CFPropertyListCreateDeepCopy(NULL, arrData, kCFPropertyListMutableContainersAndLeaves);`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-11-02T15:26:30.673

不，框架中没有为此内置任何东西。Cocoa 集合支持浅拷贝（使用`copy`or`arrayWithArray:`方法），但甚至不谈论深拷贝的概念。

这是因为“深拷贝”开始变得难以定义，因为您的集合的内容开始包含您自己的自定义对象。“深拷贝”是否意味着对象图中的*每个*对象都是相对于原始对象图中的*每个*对象的唯一引用？

如果有一些假设的`NSDeepCopying`协议，您可以设置它并在所有对象中做出决定，但不幸的是没有。如果您控制了图中的大部分对象，您可以自己创建此协议并实现它，但您需要根据需要向 Foundation 类添加一个类别。

@AndrewGrant 的回答建议使用键控归档/取消归档是为任意对象实现此目的的一种性能不佳但正确且干净的方法。[这本书甚至到目前为止建议](http://books.google.com/books?id=SfejUKakxVoC&pg=PT237&lpg=PT237&dq=nsdeepcopying&source=bl&ots=FPFRBd9-GI&sig=H8zdohIcCWDS94QcCTkkcDG_zxc&hl=en&sa=X&ei=yBh1UpLMG7DRigKl0oA4&ved=0CCwQ6AEwAA#v=onepage&q=nsdeepcopying&f=false)为所有支持深度复制的对象添加一个类别。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-07-24T08:49:54.047

如果尝试实现 JSON 兼容数据的深层复制，我有一个解决方法。

只需`NSData`使用然后重新创建 JSON 对象，这将创建一个完整的全新副本，`NSArray`其中包含它们的新内存引用。`NSJSONSerialization``NSArray/NSDictionary`

但要确保 NSArray/NSDictionary 的对象及其子对象必须是 JSON 可序列化的。

```
NSData *aDataOfSource = [NSJSONSerialization dataWithJSONObject:oldCopy options:NSJSONWritingPrettyPrinted error:nil];
NSDictionary *aDictNewCopy = [NSJSONSerialization JSONObjectWithData:aDataOfSource options:NSJSONReadingMutableLeaves error:nil]; 
```

# asp.net-mvc - ASP.NET MVC - Html.Textbox() 抛出“对象引用未设置为对象的实例”

> ID：647266
> 
> 赞同：13
> 
> 时间：2009-03-15T04:01:46.333
> 
> 标签：asp.net-mvc

我遇到了一个奇怪的问题....当我使用`UpdateModel()`or时`TryUpdateModel()`，一切正常。当我尝试绑定自己（例如`MyObject.FirstName = collection["FirstName"]`）时，我得到一个`"Object reference not set to an instance of an object"`错误。

这有点难以解释，所以我将提供代码：

```
 [HandleError]
    [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Create(FormCollection collection)
    {
        try
        {
            Model.Event evnt = new Redline.RedlineTimeAttack.Model.Event();

            //When this is uncommented everything works fine.
            //TryUpdateModel<Model.Event>(evnt);

            //this will eventually lead to problems
            evnt.Description = collection["Description"];
            evnt.EndDate = enddate;
            evnt.EventName = collection["EventName"];
            evnt.IsActive = collection["IsActive"].Contains("true");
            evnt.StartDate = startdate;
            evnt.TrackId = trackId;
            evnt.WebContent = collection["WebContent"];

            if (!evnt.IsValid)
            {
              foreach (var error in evnt.GetRuleViolations())
              {
                ModelState.AddModelError(error.PropertyName, error.ErrorMessage);
              } 
            }

            //If there are no validation issues then no problem, redirecttoaction
            //works properly
            if (ModelState.IsValid)
            {
                model.Events.InsertOnSubmit(evnt);
                model.SubmitChanges();
                ViewData["ControlMode"] = "Edit";
                return RedirectToAction("Edit");
            }
            else //returning to View so that user can correct issues causes a null reference error in the view (bombs at first Html.Textbox("ControlName"))
            {
                ViewData["Tracks"] = GetTracks();
                return View("Create", evnt);
            }
        } 
```

这是堆栈跟踪：

```
System.NullReferenceException was unhandled by user code
Message="Object reference not set to an instance of an object."
Source="System.Web.Mvc"
StackTrace:
   at System.Web.Mvc.HtmlHelper.GetModelStateValue(String key, Type destinationType)
   at System.Web.Mvc.Html.InputExtensions.InputHelper(HtmlHelper htmlHelper, InputType inputType, String name, Object value, Boolean useViewData, Boolean isChecked, Boolean setId, Boolean isExplicitValue, IDictionary`2 htmlAttributes)
   at System.Web.Mvc.Html.InputExtensions.TextBox(HtmlHelper htmlHelper, String name, Object value, IDictionary`2 htmlAttributes)
   at System.Web.Mvc.Html.InputExtensions.TextBox(HtmlHelper htmlHelper, String name)
   at ASP.views_event_create_aspx.__RenderContent2(HtmlTextWriter __w, Control parameterContainer) in d:\TFSProjects\Redline Time Attack\Main\Source\Redline.RedlineTimeAttack.Web\Views\Event\Create.aspx:line 18
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)
   at System.Web.UI.Control.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)
   at ASP.views_shared_site_master.__Render__control1(HtmlTextWriter __w, Control parameterContainer) in d:\TFSProjects\Redline Time Attack\Main\Source\Redline.RedlineTimeAttack.Web\Views\Shared\Site.Master:line 29
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)
   at System.Web.UI.Control.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderChildrenInternal(HtmlTextWriter writer, ICollection children)
   at System.Web.UI.Control.RenderChildren(HtmlTextWriter writer)
   at System.Web.UI.Page.Render(HtmlTextWriter writer)
   at System.Web.Mvc.ViewPage.Render(HtmlTextWriter writer)
   at System.Web.UI.Control.RenderControlInternal(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer, ControlAdapter adapter)
   at System.Web.UI.Control.RenderControl(HtmlTextWriter writer)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
InnerException: 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-15T05:59:42.680

我在这里找到了一些见解：[http ://forums.asp.net/p/1396019/3006051.aspx](http://forums.asp.net/p/1396019/3006051.aspx)

> 如果您不想使用内置模型绑定，那么要使用 Bultin 验证（SanjaySutar 想使用），对于您添加的每个 ModelError，您需要添加一个 ModelValue：ModelState.AddModelError("Name", "Bad Name" );
> 
> ModelState.SetModelValue("Name", ValueProvider["Name"]);

所以我像这样更新了我的代码：

```
ModelState.SetModelValue("Description", new ValueProviderResult(ValueProvider["Description"].AttemptedValue, collection["Description"], System.Globalization.CultureInfo.CurrentCulture));
ModelState.SetModelValue("EventName", new ValueProviderResult(ValueProvider["EventName"].AttemptedValue, collection["EventName"], System.Globalization.CultureInfo.CurrentCulture));
ModelState.SetModelValue("EndDate", new ValueProviderResult(ValueProvider["EndDate"].AttemptedValue, collection["EndDate"], System.Globalization.CultureInfo.CurrentCulture));
ModelState.SetModelValue("StartDate", new ValueProviderResult(ValueProvider["StartDate"].AttemptedValue, collection["StartDate"], System.Globalization.CultureInfo.CurrentCulture));
ModelState.SetModelValue("TrackId", new ValueProviderResult(ValueProvider["TrackId"].AttemptedValue, collection["TrackId"], System.Globalization.CultureInfo.CurrentCulture));
ModelState.SetModelValue("WebContent", new ValueProviderResult(ValueProvider["WebContent"].AttemptedValue, collection["WebContent"], System.Globalization.CultureInfo.CurrentCulture)); 
```

我这样做的原因是因为我想要一个。在我的业务对象中完成所有（或尽可能多的）验证，包括必填字段，以及 b. 我希望在验证摘要中有我自己的消息（例如，“FieldX 是必填字段。”而不是“需要一个值。”）。如果有更好的方法来做到这一点，请参阅我的另一个问题：[ASP.NET MVC - 值类型的自定义验证消息](https://stackoverflow.com/questions/646270/asp-net-mvc-custom-validation-message-for-value-types)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T05:24:52.267

enddate、startdate 和 trackId 来自哪里？这甚至不应该编译，但也许我只是愚蠢而没有看到他们的声明。我敢肯定它只是在看不见的地方，对吧？

确保所有这些表单值实际上也包含内容。

# c# - 如何从 C# 以编程方式（即 F5）刷新 Windows 桌面？

> ID：647270
> 
> 赞同：14
> 
> 时间：2009-03-15T04:06:12.347
> 
> 标签：c#, .net

是的，我知道这似乎是一个愚蠢的问题，它只是一个一次性的技巧，我需要完成一项有些平凡的任务，这样我才能继续做一些更有趣的事情。

编辑：也许更多信息会有所帮助：我正在尝试从桌面上删除一些快捷方式，我需要用户立即看到它被删除（所以他们不必按 F5）。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-03-15T04:16:09.717

您可以使用[SHChangeNotify](https://msdn.microsoft.com/en-us/library/windows/desktop/bb762118(v=vs.85).aspx) API。

```
[System.Runtime.InteropServices.DllImport("Shell32.dll")]
private static extern int SHChangeNotify(int eventId, int flags, IntPtr item1, IntPtr item2); 
```

然后这样称呼它

```
SHChangeNotify(0x8000000, 0x1000, IntPtr.Zero, IntPtr.Zero); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T04:11:38.620

我认为您正在寻找[IActiveDesktop::ApplyChanges](http://msdn.microsoft.com/en-us/library/bb776346(VS.85).aspx)。您将需要通过 COM 接口访问它，使用Microsoft 在 COM Interop 上提供的所有[文档](http://msdn.microsoft.com/en-us/library/aa645736(VS.71).aspx)应该相当容易。

# jquery-ui - Jquery UI 手风琴问题 - 你将如何处理这个问题？

> ID：647281
> 
> 赞同：1
> 
> 时间：2009-03-15T04:13:20.907
> 
> 标签：jquery-ui

我在我的一个应用程序 asp.net 应用程序中使用 jquery UI 手风琴控件。手风琴的数据来自一个数据库，每个数据库记录都有一个 ID、一个标题字段和一个内容字段。标题是标题，内容是打开抽奖时显示的数据...

我希望能够像这样调用我的页面：

```
http://www.mywebsite.com/mypage.aspx?ID=123 
```

并让它显示所有数据（就像现在一样），然后将手风琴的默认“抽屉”打开到对应于在 url 上传递的 ID 号的部分......大约有 50 个部分页。

关于如何解决这个问题的任何建议？我的问题是针对 jquery 手风琴功能的，其余的我都知道。那么用唯一ID“标记”抽屉的最佳位置在哪里，然后我将根据传入的ID使用“打开”该抽屉的javascript代码片段（我假设）是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T17:40:44.337

[这是您在http://jqueryui.com/download](http://jqueryui.com/download)下载自定义 JQuery UI 构建时获得的示例文件的略微修改版本，仅选择了“core”和“accordion”。

```
<!DOCTYPE html>
<html>
    <head>
        <link type="text/css" href="css/smoothness/jquery-ui-1.7.custom.css" rel="stylesheet" />    
        <script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.7.custom.min.js"></script>
        <script type="text/javascript">
            $(function(){

                // Accordion
                $("#accordion").accordion({ header: "h3" });

                // can be done somewhere later in the code, after init
                $('#accordion').accordion('activate' , "#a2");              
            });
        </script>

    </head>
    <body>
        <h2 class="demoHeaders">Accordion</h2>
        <div id="accordion">
            <div>
                <h3 id="a1"><a href="#">First</a></h3>
                <div>Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet.</div>
            </div>
            <div>
                <h3 id="a2"><a href="#">Second</a></h3>
                <div>Phasellus mattis tincidunt nibh.</div>
            </div>
            <div>
                <h3 id="a3"><a href="#">Third</a></h3>
                <div>Nam dui erat, auctor a, dignissim quis.</div>
            </div>
        </div>
    </body>
</html> 
```

selector-argument 必须与您指定为“header”的元素匹配 - 在此示例中，它是 H3-Tag，它获得了 ID。运行此代码应打开第二个窗格。另一种方法是，使用“活动”选项在 init 中指定活动窗格：

```
<script type="text/javascript">
$(function(){    
    $("#accordion").accordion({ header: "h3", active :"#a2"  });
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T04:31:59.723

我假设您有一些这样的 HTML（我将 ID 放在 A-Tag 中）：

```
<div id="accordion">
  <div>
    <a id="a1" href="#">First header</a>
    <div>First content</div>
  </div>
  <div>
    <a id="a2" href="#">Second header</a>
    <div>Second content</div>
  </div>
</div> 
```

然后你像这样激活手风琴：

```
$(function() {
    $("#accordion").accordion();
}); 
```

Accordion 提供了一种激活特定窗格的方法：

> 以编程方式激活 Accordion 的内容部分。索引可以是零索引数字以匹配要关闭的标题的位置，也可以是与元素匹配的选择器。通过 -1 关闭所有（只有可折叠：true 才可能）。

所以你可以使用：

```
$("#accordion").accordion("activate", "a#a2"); 
```

通过脚本激活它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-23T11:46:55.310

你可以使用

```
$("#accordion").accordion('activate' , 1); 
```

其中 0 是第一个抽屉，1 是第二个抽屉，依此类推。

# javascript - HTML 是否有 onSelect 事件或等效事件? 我有一个输入表单，可让我从多个选项中进行选择，并在用户更改选择时执行某些操作。例如， <select onChange="javascript:doSomething();"> <option>A</option> <option>B</option> <option>C</option> </select> 现在，doSomething()

> ID：647282
> 
> 赞同：246
> 
> 时间：2009-03-15T04:13:47.880
> 
> 标签：javascript, html, html-select, dom-events

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2011-10-22T08:28:11.713

这是最简单的方法：

```
<select name="ab" onchange="if (this.selectedIndex) doSomething();">
    <option value="-1">--</option>
    <option value="1">option 1</option> 
    <option value="2">option 2</option>
    <option value="3">option 3</option>
</select> 
```

在选择集中时，可与鼠标选择和键盘上/下键一起使用。

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2012-09-13T10:46:45.523

我需要完全相同的东西。这对我有用：

```
<select onchange="doSomething();" onfocus="this.selectedIndex = -1;">
  <option>A</option>
  <option>B</option>
  <option>C</option>
</select> 
```

支持这个：

> 当用户选择任何选项时，**可能再次选择相同的选项**

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-02-02T16:33:59.427

几个月前我在创建设计时遇到了同样的问题。我找到的解决方案是与您正在使用的元素`.live("change", function())`结合使用。`.blur()`

如果您希望在用户单击而不是更改时让它执行某些操作，只需替换`change`为`click`.

我为下拉列表分配了一个 ID `selected`，并使用了以下内容：

```
$(function () {
    $("#selected").live("change", function () {

    // do whatever you need to do

    // you want the element to lose focus immediately
    // this is key to get this working.
    $('#selected').blur();
    });
}); 
```

我看到这个没有选定的答案，所以我想我会给出我的意见。这对我来说效果很好，所以希望其他人在遇到困难时可以使用此代码。

[http://api.jquery.com/live/](http://api.jquery.com/live/)

**编辑：使用`on`选择器而不是`.live`. 参见[jQuery .on()](http://api.jquery.com/on/)**

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-03-15T04:15:24.397

只是一个想法，但是是否可以在每个`<option>`元素上单击一次？

```
<select>
  <option onclick="doSomething(this);">A</option>
  <option onclick="doSomething(this);">B</option>
  <option onclick="doSomething(this);">C</option>
</select> 
```

* * *

另一种选择可能是在选择上使用 onblur。这将在用户点击离开选择的任何时候触发。此时，您可以确定选择了哪个选项。为了在正确的时间触发此事件，选项的 onclick 可能会模糊该字段（使其他内容处于活动状态或只是 jQuery 中的 .blur()）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-11-22T14:26:45.047

onclick 方法并不完全糟糕，但如前所述，当鼠标单击未更改值时，它不会被触发。
然而，可以在 onchange 事件中触发 onclick 事件。

```
<select onchange="{doSomething(...);if(this.options[this.selectedIndex].onclick != null){this.options[this.selectedIndex].onclick(this);}}">
    <option onclick="doSomethingElse(...);" value="A">A</option>
    <option onclick="doSomethingElse(..);" value="B">B</option>
    <option onclick="doSomethingElse(..);" value="Foo">C</option>
</select> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-07-24T13:22:20.887

如果你真的需要它像这样工作，我会这样做（以确保它可以通过键盘和鼠标工作）

*   将 onfocus 事件处理程序添加到选择以设置“当前”值
*   将 onclick 事件处理程序添加到选择以处理鼠标更改
*   将 onkeypress 事件处理程序添加到 select 以处理键盘更改

不幸的是，onclick 将运行多次（例如 onpening 选择...和选择/关闭）并且 onkeypress 可能会在没有任何变化时触发...

```
<script>
  function setInitial(obj){
    obj._initValue = obj.value;
  }
  function doSomething(obj){
    //if you want to verify a change took place...
    if(obj._initValue == obj.value){
      //do nothing, no actual change occurred...
      //or in your case if you want to make a minor update
      doMinorUpdate();
    } else {
      //change happened
      getNewData(obj.value);
    }
  }
</script>

<select onfocus="setInitial(this);" onclick="doSomething();" onkeypress="doSomething();">
  ...
</select> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-06-08T22:01:39.293

将扩展 jitbit 的答案。当您单击下拉菜单然后单击下拉菜单而不选择任何内容时，我发现这很奇怪。最终得到了一些类似的东西：

```
var lastSelectedOption = null;

DDChange = function(Dd) {
  //Blur after change so that clicking again without 
  //losing focus re-triggers onfocus.
  Dd.blur();

  //The rest is whatever you want in the change.
  var tcs = $("span.on_change_times");
  tcs.html(+tcs.html() + 1);
  $("span.selected_index").html(Dd.prop("selectedIndex"));
  return false;
};

DDFocus = function(Dd) {
  lastSelectedOption = Dd.prop("selectedIndex");
  Dd.prop("selectedIndex", -1);

  $("span.selected_index").html(Dd.prop("selectedIndex"));
  return false;
};

//On blur, set it back to the value before they clicked 
//away without selecting an option.
//
//This is what is typically weird for the user since they 
//might click on the dropdown to look at other options,
//realize they didn't what to change anything, and 
//click off the dropdown.
DDBlur = function(Dd) {
  if (Dd.prop("selectedIndex") === -1)
    Dd.prop("selectedIndex", lastSelectedOption);

  $("span.selected_index").html(Dd.prop("selectedIndex"));
  return false;
}; 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<select id="Dd" onchange="DDChange($(this));" onfocus="DDFocus($(this));" onblur="DDBlur($(this));">
  <option>1</option>
  <option>2</option>
</select>
<br/>
<br/>Selected index: <span class="selected_index"></span>
<br/>Times onchange triggered: <span class="on_change_times">0</span>
```

这对用户来说更有意义，并允许 JavaScript 在他们每次选择任何选项（包括较早的选项）时运行。

这种方法的缺点是它破坏了选项卡到下拉列表并使用箭头键选择值的能力。这对我来说是可以接受的，因为所有用户一直点击所有内容，直到永恒结束。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-01-21T19:54:33.260

要在每次用户选择某些东西（即使是相同的选项）时正确触发事件，您只需要欺骗选择框。

就像其他人所说的那样，指定一个负面`selectedIndex`的焦点来强制改变事件。虽然这确实允许您欺骗选择框，但只要它仍然具有焦点，它就不会工作。简单的解决方法是强制选择框模糊，如下所示。

### 标准 JS/HTML：

```
<select onchange="myCallback();" onfocus="this.selectedIndex=-1;this.blur();">
  <option>A</option>
  <option>B</option>
  <option>C</option>
</select> 
```

### jQuery插件：

```
<select>
  <option>A</option>
  <option>B</option>
  <option>C</option>
</select>

<script type="text/javascript">
    $.fn.alwaysChange = function(callback) {
        return this.each(function(){
            var elem = this;
            var $this = $(this);

            $this.change(function(){
                if(callback) callback($this.val());
            }).focus(function(){
                elem.selectedIndex = -1;
                elem.blur();
            });
        });
    }

    $('select').alwaysChange(function(val){
        // Optional change event callback,
        //    shorthand for $('select').alwaysChange().change(function(){});
    });
</script> 
```

你可以在这里看到一个[工作演示](http://jsfiddle.net/KcFDT/28/)。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2020-11-09T00:33:20.213

我知道这个问题现在已经很老了，但是对于仍然遇到这个问题的任何人，我已经通过在我的选项标签中添加一个 onInput 事件，然后在那个被调用的函数中检索该选项输入的值，在我自己的网站上实现了这一点。

```
<select id='dropdown' onInput='myFunction()'>
  <option value='1'>1</option>
  <option value='2'>2</option>
</select>

<p>Output: </p> 
<span id='output'></span>

<script type='text/javascript'>
function myFunction() {
 var optionValue = document.getElementById("dropdown").value;
 document.getElementById("output").innerHTML = optionValue;
}
</script>
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-06-08T11:40:52.510

这可能无法直接回答您的问题，但可以通过简单的设计级别调整来解决此问题。我知道这可能并非 100% 适用于所有用例，但我强烈建议您重新考虑您的应用程序的用户流程，以及是否可以实施以下设计建议。

我决定做一些简单的`onChange()`事情，而不是使用其他并非真正用于此目的的事件（`blur`,`click`等）。

**我解决它的方式：**

只需在前面加上一个占位符选项标签，例如 select，它没有任何价值。

因此，不仅仅是使用以下结构，这需要 hack-y 替代方案：

```
<select>
  <option>A</option>
  <option>B</option>
  <option>C</option>
</select> 
```

考虑使用这个：

```
<select>
  <option selected="selected">Select...</option>
  <option>A</option>
  <option>B</option>
  <option>C</option>
</select> 
```

因此，通过这种方式，您的代码会更加简化，并且`onChange`每次用户决定选择默认值以外的其他内容时都会按预期工作。`disabled`如果您不希望他们再次选择它并强制他们从选项中选择某些内容，那么您甚至可以将该属性添加到第一个选项，从而触发`onChange()`火灾。

在给出这个答案的时候，我正在编写一个复杂的 Vue 应用程序，我发现这种设计选择大大简化了我的代码。在解决这个问题之前，我花了几个小时解决这个问题，而且我不必重新编写很多代码。但是，如果我使用 hacky 替代方案，我将需要考虑边缘情况，以防止 ajax 请求的双重触发等。这也不会破坏默认浏览器行为作为一个不错的奖励（在移动设备上测试浏览器也是如此）。

有时，您只需要退后一步，从大局考虑最简单的解决方案。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-04-08T05:31:23.200

实际上，当用户使用键盘更改选择控件中的选择时，onclick 事件不会触发。您可能必须结合使用 onChange 和 onClick 来获得您正在寻找的行为。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-11-30T05:42:43.663

Add an extra option as the first, like the header of a column, which will be the default value of the dropdown button before click it and reset at the end of `doSomething()`, so when choose A/B/C, the onchange event always trigs, when the selection is `State`, do nothing and return. `onclick`正如许多人之前提到的那样，它非常不稳定。因此，我们需要做的就是制作一个与您的真实选项不同的初始按钮标签，这样 onchange 将适用于任何选项。

```
<select id="btnState" onchange="doSomething(this)">
  <option value="State" selected="selected">State</option>  
  <option value="A">A</option>
  <option value="B">B</option>
  <option value="C">C</option>
</select>

function doSomething(obj)
{
    var btnValue = obj.options[obj.selectedIndex].value;

    if (btnValue == "State")
    {
      //do nothing
      return;
    }

    // Do your thing here

    // reset 
    obj.selectedIndex = 0;
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2017-08-15T22:17:06.803

首先，您使用 onChange 作为事件处理程序，然后使用标志变量使其执行您每次进行更改时想要的功能

```
<select 
```

```
var list = document.getElementById("list");
var flag = true ; 
list.onchange = function () {
if(flag){
document.bgColor ="red";
flag = false;

}else{
document.bgColor ="green";
flag = true;
}
}
```

```
<select id="list"> 
<option>op1</option>
<option>op2</option>
<option>op3</option>
</select>
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2014-07-02T18:12:52.850

所以我的目标是能够多次选择相同的值，这实际上会覆盖 onchange() 函数并将其变成有用的 onclick() 方法。

根据上面的建议，我想出了这个对我有用的方法。

```
<select name="ab" id="hi" onchange="if (typeof(this.selectedIndex) != undefined) {alert($('#hi').val()); this.blur();}" onfocus="this.selectedIndex = -1;">
    <option value="-1">--</option>
    <option value="1">option 1</option>
    <option value="2">option 2</option>
    <option value="3">option 3</option>
</select> 
```

[http://jsfiddle.net/dR9tH/19/](http://jsfiddle.net/dR9tH/19/)

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-08-26T16:35:25.677

选择标签（在这种情况下）的美妙之处在于它会从选项标签中获取它的值。

尝试：

```
<select onChange="javascript:doSomething(this.value);">
<option value="A">A</option>
<option value="B">B</option>
<option value="Foo">C</option>
</select> 
```

为我工作得体。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2012-04-10T10:46:07.433

What I did when faced with a similar Problem is I added an 'onFocus' to the select box which appends a new generic option ('select an option'or something similar) and default it as the selected option.

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-11-26T23:29:51.710

使用jQuery：

```
<select class="target">
  <option>A</option>
  <option>B</option>
  <option>C</option>
</select>

<script>
    $('.target').change(function() { doSomething(); });
</script> 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-10-03T11:01:56.017

这是我的解决方案，与这里的任何其他解决方案完全不同。它使用鼠标位置来确定是否单击了选项，而不是单击选择框以打开下拉列表。它利用 event.screenY 位置，因为这是唯一可靠的跨浏览器变量。必须首先附加悬停事件，以便在单击事件之前确定控件相对于屏幕的位置。

```
var select = $("select");

var screenDif = 0;
select.bind("hover", function (e) {
    screenDif = e.screenY - e.clientY;
});
select.bind("click", function (e) {
    var element = $(e.target);
    var eventHorizon = screenDif + element.offset().top + element.height() - $(window).scrollTop();
    if (e.screenY > eventHorizon)
        alert("option clicked");
}); 
```

这是我的 jsFiddle [http://jsfiddle.net/sU7EV/4/](http://jsfiddle.net/sU7EV/4/)

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2014-05-03T19:55:27.863

什么对我有用：

```
<select id='myID' onchange='doSomething();'>
    <option value='0' selected> Select Option </option>
    <option value='1' onclick='if (!document.getElementById("myID").onchange()) doSomething();' > A </option>
    <option value='2' onclick='if (!document.getElementById("myID").onchange()) doSomething();' > B </option>
</select> 
```

这样，onchange 会在选项更改时调用“doSomething()”，而当 onchange 事件为 false 时，onclick 会调用“doSomething()”，换句话说，当您选择相同的选项时

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2014-06-19T12:15:13.557

试试这个（当你选择选项时触发事件，不改变选项）：

```
$("select").mouseup(function() {
    var open = $(this).data("isopen");
    if(open) {
        alert('selected');
    }
    $(this).data("isopen", !open);
}); 
```

[http://jsbin.com/dowoloka/4](http://jsbin.com/dowoloka/4)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2012-10-27T05:12:29.820

你应该尝试使用`option:selected`

```
$("select option:selected").click(doSomething); 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2017-08-07T19:37:51.107

```
<script>
function abc(selectedguy) {
alert(selectedguy);
}
</script>

<select onchange="abc(this.selectedIndex);">
<option>option one</option>
<option>option two</option>
</select> 
```

在这里，您返回了索引，并且在 js 代码中，您可以将此返回与一个开关或任何您想要的东西一起使用。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2014-04-07T09:38:24.273

```
<select name="test[]" 
onchange="if(this.selectedIndex < 1){this.options[this.selectedIndex].selected = !1}">
<option>1</option>
<option>2</option>
<option>3</option>
</select> 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-03-31T22:54:31.720

很久以前，但在回答最初的问题时，这有帮助吗？只需放入`onClick`行`SELECT`中。然后将您希望每个`OPTION`人做的事情放在`OPTION`行中。IE：

```
<SELECT name="your name" onClick>
<option value ="Kilometres" onClick="YourFunction()">Kilometres
-------
-------
</SELECT> 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-07-24T13:12:01.913

请注意，IE 上的 OPTION 标签不支持事件处理程序，快速思考..我想出了这个解决方案，尝试一下并给我您的反馈：

```
<script>
var flag = true;
function resetIndex(selObj) {
    if(flag) selObj.selectedIndex = -1;
    flag = true;
}
function doSomething(selObj) {
    alert(selObj.value)
    flag = false;
}
</script>
<select onchange="doSomething(this)" onclick="resetIndex(this)">
<option value="A">A</option>
<option value="B">B</option>
<option value="C">C</option>
</select> 
```

我在这里所做的实际上是重置选择索引，以便始终触发 onchange 事件，确实，当您单击时我们会丢失所选项目，如果您的列表很长，可能会很烦人，但它可能会以某种方式帮助您..

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2012-07-08T10:20:03.493

尝试这个：

```
<select id="nameSelect" onfocus="javascript:document.getElementById('nameSelect').selectedIndex=-1;" onchange="doSomething(this);">
    <option value="A">A</option>
    <option value="B">B</option>
    <option value="C">C</option>
</select> 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2020-05-31T04:34:13.323

**您需要在此处执行一些操作，以确保它记住旧值并触发 onchange 事件，即使再次选择了相同的选项也是如此。**

你想要的第一件事是一个常规的 onChange 事件：

```
$("#selectbox").on("change", function(){
    console.log($(this).val());
    doSomething();
}); 
```

要在再次选择相同选项时触发 onChange 事件，您可以在下拉列表获得焦点时取消设置选定选项，方法是将其设置为无效值。但是您还希望存储先前选择的值以在用户未选择任何新选项的情况下恢复它：

```
prev_select_option = ""; //some kind of global var

$("#selectbox").on("focus", function(){
    prev_select_option = $(this).val(); //store currently selected value
    $(this).val("unknown"); //set to an invalid value
}); 
```

即使选择了相同的值，上面的代码也将允许您触发 onchange。但是，如果用户在选择框外单击，您希望恢复以前的值。我们在 onBlur 上做：

```
$("#selectbox").on("blur", function(){
    if ($(this).val() == null) { 
       //because we previously set an invalid value 
       //and user did not select any option
        $(this).val(prev_select_option);
    }
}); 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2016-12-22T19:26:18.613

我也遇到过类似的需求，最终为此编写了一个 angularjs 指令 -

[guthub 链接 - 角度选择](https://github.com/NithinBiliya/angular-select)

用于`element[0].blur();`从选择标签上移除焦点。逻辑是在第二次点击下拉菜单时触发这种模糊。

`as-select`即使用户在下拉列表中选择相同的值也会触发。

演示 -[链接](https://nithinbiliya.github.io/angular-select/)

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2017-06-13T21:22:37.917

一个真正的答案是不使用选择字段（如果您在重新选择相同的答案时需要做某事。）

使用常规 div、按钮、显示/隐藏菜单创建一个下拉菜单。链接：[https ://www.w3schools.com/howto/howto_js_dropdown.asp](https://www.w3schools.com/howto/howto_js_dropdown.asp)

*如果能够将事件侦听器添加到选项，则可以避免。如果选择元素有一个 onSelect 侦听器。如果单击选择字段并没有严重触发 mousedown、mouseup 并在 mousedown 上同时单击所有内容。*

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2011-04-16T10:56:47.893

当元素获得焦点时如何更改选择的值，例如（使用 jquery）：

```
$("#locationtype").focus(function() {
    $("#locationtype").val('');
});

$("#locationtype").change(function() {
    if($("#locationtype").val() == 1) {
        $(".bd #mapphp").addClass('show');
        $("#invoerform").addClass('hide');
    }
    if($("#locationtype").val() == 2) {
        $(".lat").val('');
        $(".lon").val('');
    }
}); 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2021-01-08T19:13:19.950

另一种解决方案是使用 onMouseUp 事件。OnMouseUp 也适用于重新选择和更改选项的相同选项。

唯一的缺点。当下拉框打开时调用代码，第二次选择时调用。对于 AJAX 请求，请记住这一点。如果这不会损害您的逻辑，您可以将其用作简单的内联黑客。

```
<select id="bla" onmouseup="console.log( document.getElementById('bla').options[document.getElementById('bla').selectedIndex].value );">
  <option value="0">A</option>
  <option value="1">B</option>
</select> 
```

* * *

## 回答 #32

> 赞同：-1
> 
> 时间：2012-02-01T16:26:16.757

我发现了这个解决方案。

最初将选择元素的 selectedIndex 设置为 0

```
//set selected Index to 0

doSomethingOnChange(){

     blah ..blah ..

     set selected Index to 0

} 
```

调用此方法 onChange 事件

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2021-10-25T08:18:17.613

唯一对我有用的解决方案是在“onFocus”事件上完全重置 SELECT。这样，SELECT 总是在“onChange”事件上“改变”：

```
$('select').on('focus', function(ev) {
    var $select = $(this);
    var options = $select.html();
    $select.empty();
    $select.append(options);
});

$('select').on('change', function(ev) {
    // Now the select element ALWAYS fires onChange
}); 
```

* * *

## 回答 #34

> 赞同：-2
> 
> 时间：2009-03-15T04:39:40.127

您可以使用 onChange：[http ://www.w3schools.com/TAGS/tag_Select.asp](http://www.w3schools.com/TAGS/tag_Select.asp)

复制自[http://www.faqs.org/docs/htmltut/forms/_SELECT_onChange.html](http://www.faqs.org/docs/htmltut/forms/_SELECT_onChange.html) onChange 指定当用户选择其中一个选项时运行的 JavaScript。这意味着当用户选择一个项目时会立即启动一个操作，而不是在按下“提交”按钮时。

# c# - C# 中是否有众所周知的异步网络代码模式？

> ID：647287
> 
> 赞同：6
> 
> 时间：2009-03-15T04:17:14.020
> 
> 标签：c#, sockets, c#-2.0

我最近在 C# 中编写了一个快速且简单的概念验证代理服务器，作为让 Java Web 应用程序与驻留在另一台服务器上的旧版 VB6 应用程序通信的努力的一部分。这非常简单：

代理服务器和客户端都使用相同的消息格式；在代码中，我使用一个`ProxyMessage`类来表示来自客户端的请求和服务器生成的响应：

```
public class ProxyMessage
{
   int Length; // message length (not including the length bytes themselves)
   string Body; // an XML string containing a request/response

   // writes this message instance in the proper network format to stream 
   // (helper for response messages)
   WriteToStream(Stream stream) { ... }
} 
```

消息尽可能简单：正文长度 + 消息正文。

我有一个单独的`ProxyClient`类，代表与客户端的连接。它处理代理和单个客户端之间的所有交互。

我想知道的是它们是用于简化与异步套接字编程相关的样板代码的设计模式还是最佳实践？例如，您需要注意管理读取缓冲区，以免意外丢失字节，并且您需要跟踪当前消息的处理进度。在我当前的代码中，我在我的回调函数中完成所有这些工作`TcpClient.BeginRead`，并在一些实例变量的帮助下管理缓冲区的状态和当前的消息处理状态。

下面是我传递给的回调函数的代码`BeginRead`，以及上下文的相关实例变量。该代码似乎“按原样”运行良好，但我想知道是否可以对其进行一些重构以使其更清晰（或者它已经是？）。

```
private enum BufferStates 
{ 
    GetMessageLength, 
    GetMessageBody 
}
// The read buffer. Initially 4 bytes because we are initially
// waiting to receive the message length (a 32-bit int) from the client 
// on first connecting. By constraining the buffer length to exactly 4 bytes,
// we make the buffer management a bit simpler, because
// we don't have to worry about cases where the buffer might contain
// the message length plus a few bytes of the message body.
// Additional bytes will simply be buffered by the OS until we request them.
byte[] _buffer = new byte[4];

// A count of how many bytes read so far in a particular BufferState.
int _totalBytesRead = 0;

// The state of the our buffer processing. Initially, we want
// to read in the message length, as it's the first thing
// a client will send
BufferStates _bufferState = BufferStates.GetMessageLength;

// ...ADDITIONAL CODE OMITTED FOR BREVITY...

// This is called every time we receive data from
// the client.

private void ReadCallback(IAsyncResult ar)
{
    try
    {
        int bytesRead = _tcpClient.GetStream().EndRead(ar);

        if (bytesRead == 0)
        {
            // No more data/socket was closed.
            this.Dispose();
            return;
        }

        // The state passed to BeginRead is used to hold a ProxyMessage
        // instance that we use to build to up the message 
        // as it arrives.
        ProxyMessage message = (ProxyMessage)ar.AsyncState;

        if(message == null)
            message = new ProxyMessage();

        switch (_bufferState)
        {
            case BufferStates.GetMessageLength:

                _totalBytesRead += bytesRead;

                // if we have the message length (a 32-bit int)
                // read it in from the buffer, grow the buffer
                // to fit the incoming message, and change
                // state so that the next read will start appending
                // bytes to the message body

                if (_totalBytesRead == 4)
                {
                    int length = BitConverter.ToInt32(_buffer, 0);
                    message.Length = length;
                    _totalBytesRead = 0;
                    _buffer = new byte[message.Length];
                    _bufferState = BufferStates.GetMessageBody;
                }

                break;

            case BufferStates.GetMessageBody:

                string bodySegment = Encoding.ASCII.GetString(_buffer, _totalBytesRead, bytesRead);
                _totalBytesRead += bytesRead;

                message.Body += bodySegment;

                if (_totalBytesRead >= message.Length)
                {
                    // Got a complete message.
                    // Notify anyone interested.

                    // Pass a response ProxyMessage object to 
                    // with the event so that receivers of OnReceiveMessage
                    // can send a response back to the client after processing
                    // the request.
                    ProxyMessage response = new ProxyMessage();
                    OnReceiveMessage(this, new ProxyMessageEventArgs(message, response));
                    // Send the response to the client
                    response.WriteToStream(_tcpClient.GetStream());

                    // Re-initialize our state so that we're
                    // ready to receive additional requests...
                    message = new ProxyMessage();
                    _totalBytesRead = 0;
                    _buffer = new byte[4]; //message length is 32-bit int (4 bytes)
                    _bufferState = BufferStates.GetMessageLength;
                }

                break;
        }

        // Wait for more data...
        _tcpClient.GetStream().BeginRead(_buffer, 0, _buffer.Length, this.ReadCallback, message);
    }
    catch
    {
        // do nothing
    }

} 
```

到目前为止，我唯一真正的想法是将与缓冲区相关的内容提取到一个单独的`MessageBuffer`类中，并简单地让我的读取回调在它们到达时将新字节附加到它。然后，它`MessageBuffer`会担心诸如当前之类的事情，`BufferState`并在收到完整消息时触发一个事件，`ProxyClient`然后可以进一步传播到主代理服务器代码，在那里可以处理请求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T07:05:46.970

我必须克服类似的问题。这是我的解决方案（已修改以适合您自己的示例）。

`Stream`我们围绕（的超类`NetworkStream`，它是的超类`TcpClient`或其他）创建一个包装器。它监视读取。当读取一些数据时，它会被缓冲。当我们收到一个长度指示符（4 个字节）时，我们检查我们是否有完整的消息（4 个字节 + 消息体长度）。当我们这样做时，我们会`MessageReceived`使用消息正文引发一个事件，并从缓冲区中删除该消息。该技术自动处理分段消息和每个数据包多个消息的情况。

```
public class MessageStream : IMessageStream, IDisposable
{
    public MessageStream(Stream stream)
    {
        if(stream == null)
            throw new ArgumentNullException("stream", "Stream must not be null");

        if(!stream.CanWrite || !stream.CanRead)
            throw new ArgumentException("Stream must be readable and writable", "stream");

        this.Stream = stream;
        this.readBuffer = new byte[512];
        messageBuffer = new List<byte>();
        stream.BeginRead(readBuffer, 0, readBuffer.Length, new AsyncCallback(ReadCallback), null);
    }

    // These belong to the ReadCallback thread only.
    private byte[] readBuffer;
    private List<byte> messageBuffer;

    private void ReadCallback(IAsyncResult result)
    {
        int bytesRead = Stream.EndRead(result);
        messageBuffer.AddRange(readBuffer.Take(bytesRead));

        if(messageBuffer.Count >= 4)
        {
            int length = BitConverter.ToInt32(messageBuffer.Take(4).ToArray(), 0);  // 4 bytes per int32

            // Keep buffering until we get a full message.

            if(messageBuffer.Count >= length + 4)
            {
                messageBuffer.Skip(4);
                OnMessageReceived(new MessageEventArgs(messageBuffer.Take(length)));
                messageBuffer.Skip(length);
            }
        }

        // FIXME below is kinda hacky (I don't know the proper way of doing things...)

        // Don't bother reading again.  We don't have stream access.
        if(disposed)
            return;

        try
        {
            Stream.BeginRead(readBuffer, 0, readBuffer.Length, new AsyncCallback(ReadCallback), null);
        }
        catch(ObjectDisposedException)
        {
            // DO NOTHING
            // Ends read loop.
        }
    }

    public Stream Stream
    {
        get;
        private set;
    }

    public event EventHandler<MessageEventArgs> MessageReceived;

    protected virtual void OnMessageReceived(MessageEventArgs e)
    {
        var messageReceived = MessageReceived;

        if(messageReceived != null)
            messageReceived(this, e);
    }

    public virtual void SendMessage(Message message)
    {
        // Have fun ...
    }

    // Dispose stuff here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T04:44:00.680

我认为你使用的设计很好，这大致就是我会做同样的事情的方式。我认为通过重构为额外的类/结构并不会获得太多收益，而且从我所看到的情况来看，这样做实际上会使解决方案变得更加复杂。

我唯一要评论的是，这两个读数是否第一个总是消息长度，第二个总是身体足够健壮。我总是对这样的方法保持警惕，好像它们由于不可预见的情况（例如另一端发送错误的长度）而以某种方式不同步，很难恢复。相反，我会使用大缓冲区进行单次读取，以便始终从网络获取所有可用数据，然后检查缓冲区以提取完整的消息。这样，如果出现问题，可以丢弃当前缓冲区以使事情恢复到干净状态，并且只会丢失当前消息，而不是停止整个服务。

实际上，如果您的消息正文很大并且到达两个单独的接收并且下一条消息在与前一个正文的后半部分同时发送它的长度时，您会遇到问题。如果发生这种情况，您的消息长度将最终附加到上一条消息的正文中，并且您处于上一段中描述的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T08:50:22.677

您可以使用`yield return`自动为异步回调生成状态机。Jeffrey Richter 通过他的[AsyncEnumerator类推广了这种技术，我在](http://msdn.microsoft.com/en-us/magazine/cc546608.aspx)[这里](http://incrediblejourneysintotheknown.blogspot.com/2008/12/more-on-jeffrey-richters.html)玩过这个想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T14:10:52.960

There's nothing wrong with the way you've done it. For me, though, I like to separate the receiving of the data from the processing of it, which is what you seem to be thinking with your proposed MessageBuffer class. I have discussed that in detail [here](https://stackoverflow.com/questions/582550/c-begin-endreceive-how-do-i-read-large-data/599448#599448).

# css - 决定如何为 H1、H2、H3 等创建 CSS 的困境

> ID：647295
> 
> 赞同：2
> 
> 时间：2009-03-15T04:21:32.403
> 
> 标签：css

我目前为我的网站提供了一些通用的 H1、H2、H3 样式，它们适用于大多数需要简单“传统”标题的“通用”标题。

```
 h1 { /* lots of style attributes */ }
 h2 { /* lots of style attributes */ }
 h3 { /* lots of style attributes */ } 
```

我还在创建一些组件，我有这样的东西，也就是说我需要一个特定于该特定类型控件的标题。

```
 <div class="titledimage"><h1>Section header</h1><img .../></div>

 .titledimage h1 { color:red; bottom-border: 1px solid blue; } 
```

我遇到的问题是`h1`under`titledimage`也是`h1`前面定义的，所以它继承了`h1`. 这通常是不希望的 - 我只想要div`red`中`1px solid blue`的标题。`.titledImage`

我正在阅读并试图回答[这个关于 H1 风格](https://stackoverflow.com/questions/503925/is-it-alright-to-use-multiple-h1-tags-on-the-same-page-but-style-them-differentl)的问题。我的结论是，如果你正在做特定的标题样式（.titledimage h1），你不能真正做通用的标题样式（h1），除非：

```
 a) you reset every style attribute in the '.titledimage h1' style
 b) you just use a class name instead of h1
 c) your `h1` style is defined with very few attributes that you'd 
    be overriding anyway 
```

我注意到他们实际使用的[YUI 菜单控件](http://developer.yahoo.com/yui/menu/)`H6`的样式，我想知道他们是否这样做是为了避免这种冲突。

我是不是该

```
a) be using <h6> like yahoo does?
b) reset every attribute defined by `h1` when I define `.titledimage h1` ?
c) just use a class name for `.titledimage header`, and leave 
   `h1`, `h2`, `h3` for 'traditional more logical headers' 
d) something else 
```

理想情况下我想说这个，但没有这样的事情（据我所知）

```
 .titledimage h1 { inherit: none; color:red; bottom-border: 1px solid blue; } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T08:16:03.320

对我来说，重置似乎很浪费。必须有一种干净的方法将 应用到您希望应用`/* lots of style attributes */`到的`h1`标签上，而不是将其应用`h1`到`.titledimage`.

假设你有：

```
<div class="top"><h1>PageName</h1></div>
<div class="leftNavigation"><h1>Cat1</h1><h1>Cat2</h1><h1>Cat3</h1></div>
<div class="rightMarginNote"><h1>Username</h1></div>
<div class="content">
 <h1>CONTENT</h1>
 <div class="titledimage">
  <h1>title</h1>
 </div>
</div> 
```

然后你会希望你的 CSS 有点像：

```
.top h1, .leftNavigation h1, .rightMarginNote h1, .content > h1 {
  /* lots of style attributes */
}
.similarly h2 { /* lots of style attributes */ }
.similarly h3 { /* lots of style attributes */ }
.titledimage h1 { color:red; bottom-border: 1px solid blue; } 
```

而不是替代品

```
h1 { /* lots of style attributes */ }
h2 { /* lots of style attributes */ }
h3 { /* lots of style attributes */ }
.titledimage h1, .otherCase h1, .anotherCase h1, yetAnotherCase h1 {
  /* lots of style backtracking */
}
.titledimage h1 { color:red; bottom-border: 1px solid blue; }
.otherCase h1 { color:blue; bottom-border: 1px solid blue; }
.anotherCase h1 { color:green; bottom-border: 1px solid blue; }
.yetAnotherCase h1 { color:mauve; bottom-border: 1px solid blue; } 
```

还要将尽可能多的 H1-H5 内容组合在一起，如果您必须使用替代方案，请定义一个专门用于重置的类，该类不应用于 h1，而是应用于任何类的包含 div。

```
<div class="titledimage hReset"><h1>title</h1></div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T04:24:16.390

那么简单的解决方案是不要嵌套一个 h1 标签，即：

```
<div class="different-header-style">Some Header</div> 
```

如果 h1 没有您想要的样式，那么为什么要使用它呢？

此外，比将它嵌套在 div 中只是为了样式更好，我会这样做：

```
<h1 class="special-header">Some Header</h1> 
```

h1 是一个块元素，无论如何您都可以像 div 一样设置样式（边框、宽度等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T04:41:04.773

> `h1`b）重置我定义时定义的每个属性 `.titledimage h1`？

这种方法的问题是您不能为其他具有特定样式的标题重用重置样式，例如

```
<div class="titledimage"><h1>Section header</h1><img .../></div>
<div class="titledimage"><h2>Section header</h2><img .../></div>
<div class="otherimage"><h1>Section header</h1><img .../></div> 
```

我认为更好的方法是在单独的类中定义您的重置

```
.hreset {
  /* Reset the header styles here */
} 
```

然后，您可以在必要时重复使用这些重置，例如

```
<div class="titledimage"><h1 class="hreset">Section header</h1><img .../></div>
<div class="titledimage"><h2 class="hreset">Section header</h2><img .../></div>
<div class="otherimage"><h1 class="hreset">Section header</h1><img .../></div> 
```

# dictionary - 在 lex/yacc 中使用字典数据结构

> ID：647298
> 
> 赞同：1
> 
> 时间：2009-03-15T04:27:14.243
> 
> 标签：dictionary, yacc, lex

我正在为使用 lex/yacc 创建的微处理器编写汇编程序。

我想在我的汇编代码中实现标签，我认为这样做的一个好方法是有一个 {name:line#} 形式的标签字典。然后我可以在插入标签时检查，如果它已经定义，它是一个错误。

那么如何在 lex/yacc 中使用字典结构呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T04:42:58.327

查看[各种哈希表实现](http://en.wikipedia.org/wiki/Hash_table#Implementations)以找到您喜欢的一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-04T14:09:23.147

对于标签？使用文件指针创建一个结构，并将其初始化为找到的标签的位置。当您遇到标签声明时，访问该指针并用 locctr 填充该空白。

# .net - 单击时如何从下拉框中生成文本

> ID：647303
> 
> 赞同：0
> 
> 时间：2009-03-15T04:30:02.523
> 
> 标签：.net, drop-down-menu

例如下拉框包含三个东西 Simon,Jaison,Rahul..如果你点击 Jaison 将生成 jaison 作为文本，或者 Simon 将生成 Simon 作为文本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T04:38:21.627

Your question is somewhat unclear, but if you're trying to get a string from the currently selected item (when the selection changes), then...

处理`SelectedIndexChanged`事件：

```
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    string selectedText = comboBox1.SelectedItem.ToString();

    // Do whatever you want to do with it, for example...
    label1.Text = selectedText;
} 
```

# iphone - HTTP 日期格式到 NSDate

> ID：647307
> 
> 赞同：0
> 
> 时间：2009-03-15T04:35:38.217
> 
> 标签：iphone, cocoa, cocoa-touch, nsdate, foundation

我有一个日期字符串（嗯，NSData，但很容易转换为字符串），我认为它是 HTTP 标准使用的格式：

```
Mon Apr 17 19:34:46 UTC 2006 
```

有没有比在 NSDateFormatter 中手动指定格式字符串更好（即不易出错）的方法来解析它？

（我的应用程序是一个 iPhone 应用程序，但我怀疑标准的 Cocoa 解决方案也可以工作，因为 NSDate 和 NSDateFormatter 是 Foundation 的一部分。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T15:41:01.177

不，我认为没有更好的方法。

如果您有一些外部输入，您必须事先知道输入的格式，并且您只能为问题做准备，即带有备用 NSDateFormatter 的故障转移解析器。

# c# - C# 到 C++/CLI 到 C DLL System.IO.FileNotFoundException

> ID：647310
> 
> 赞同：8
> 
> 时间：2009-03-15T04:39:12.343
> 
> 标签：c#, build-process, c++-cli, unmanaged

我*`System.IO.FileNotFoundException: The specified module could not be found`*在运行调用 C++/CLI 程序集的 C# 代码时得到，该程序集又调用纯 C DLL。只要实例化调用纯 C DLL 函数的对象，就会发生这种情况。

BackingStore 是纯 C。CPPDemoViewModel 是调用 BackingStore 的 C++/CLI，它具有对 BackingStore 的引用。

我尝试了最简单的情况——添加一个新的 C# 单元测试项目，它只是试图创建一个在 CPPDemoViewModel 中定义的对象。我从 C# 项目中添加了对 CPPDemoViewModel 的引用。

只需添加对 CPPDemoViewModel 的引用，C++/CLI 测试项目就可以正常工作，因此它是在语言之间进行切换。

我正在使用带有 .Net 3.5 SP1 的 Visual Studio 2008 SP1。我在 Vista x64 上构建，但一直小心确保我的平台目标设置为 x86。

这感觉就像我错过了一些愚蠢和明显的事情，但浪费时间试图私下解决它会更愚蠢，所以我在这里让自己尴尬！

这是对移植大量遗留 C 代码的项目的测试，我将这些代码保存在 DLL 中，并使用 C++/CLI 实现的 ViewModel。

**编辑** 检查目录后，我可以确认没有复制BackingStore.dll。

我有使用典型的多项目解决方案创建的标准唯一项目文件夹。

```
WPFViewModelInCPP
  后台存储
  CPPViewModel
  CPPViewModelTestInCS
    斌
      调试
  调试

```

令我惊讶的是，更高级别的 Debug 似乎是 C 和 C++/CLI 项目使用的公共文件夹。

WPFViewModelInCPP\Debug 包含 BackingStore.dll、CPPDemoViewModel.dll、CPPViewModelTest.dll 及其关联的 .ilk 和 .pdb 文件

WPFViewModelInCPP\CPPViewModelTestInCS\bin\Debug 包含 CPPDemoViewModel 和 CPPViewModelTestInCS .dll 和 .pdb 文件，但**不**包含 BackingStore。但是，手动将 BackingStore 复制到该目录**并不能修复该错误。**

CPPDemoViewModel 具有属性*Copy Local* set，我假设它负责在引用 if 时复制其 DLL。我无法将 C# 项目的引用添加到纯 C DLL - 它只是说*无法添加对备份存储的引用。*

我不确定我是否只有一两个问题。

我可以使用老式的复制构建步骤将 BackingStore.dll 复制到任何给定的 C# 项目的目录中，尽管我希望新的 .net 模型不需要这样做。

DependencyWalker 告诉我丢失的文件是 GPSVC.dll，这[表明](http://forums.guru3d.com/showthread.php?t=212244)存在安全设置问题。我怀疑这是一个红鲱鱼。

**edit2** 将BackingStore.dll 的手动副本与可执行文件相邻，GUI 现在可以正常工作。C# 测试项目仍然存在问题，我怀疑这是由于测试项目的运行时环境造成的，但我现在可以不用它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-15T04:42:55.050

C 和 C++ DLL 是否与正在执行的 C# 程序集位于同一目录中？

您可能必须更改项目输出设置，以便 C# 程序集和其他 DLL 最终都位于同一文件夹中。

在这种情况下，我经常使用[Dependency Walker](http://www.dependencywalker.com/)；这是一个健全性检查，表明实际上可以找到所有依赖项。

一旦您的应用程序运行，您可能还想在您正在运行的代码上试用[Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，以查看正在引用哪些 DLL 以及它们的位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-17T07:46:24.890

除了更改输出设置外，GUI 的答案是添加了预构建步骤

```
copy $(ProjectDir)..\Debug\BackingStore.* $(TargetDir) 
```

测试项目的答案是将缺少的 DLL 添加到 testrunco​​nfig 的部署选项卡中。您可以通过直接编辑默认的*LocalTestRun.testrunco​​nfig*（出现在解决方案项下的解决方案中）来执行此操作，或者右键单击解决方案并添加新的测试运行配置，然后该配置将出现在主测试菜单下。

感谢您对这个关于测试配置的[SO 问题的回答，以引导我找到答案。](https://stackoverflow.com/questions/198097/creating-test-run-configurations-in-vs-2008)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-19T05:33:20.110

发生这种情况的原因是因为您要么在 CRT 有机会初始化之前从托管代码加载 DLLMAIN。您可能没有任何托管代码，可以根据 DllMain 通知的效果**直接**或**间接执行。**（请参阅：Expert C++/CLI：面向 Visual C++ 程序员的 .Net，第 11 章++）。

或者您没有定义任何本地入口点，但您已链接到 MSVCRT。CLR 会使用 /clr 自动为您初始化，这个细节会引起很多混乱，必须考虑在内。混合模式 DLL 实际上通过使用热修补类中的所有托管入口点 vtable 来 *延迟加载CLR。*

许多类初始化问题围绕着这个主题，加载器锁定和延迟加载 CLR 有时有点棘手。尝试声明全局的静态并且不要使用#pragma managed/unmanaged，使用/clr per-file 隔离你的代码。

如果您无法将您的代码与托管代码隔离开来，并且遇到了问题（在采取了其中一些步骤之后），您还可以考虑自己托管 CLR，也许还可以通过创建域管理器来确保您完全“在环”运行时事件和引导。

这正是为什么它与您的搜索路径或初始化无关的原因。不幸的是，Fusion 日志查看器并没有太大帮助（这是查找 .NET CLR 程序集绑定问题而不是依赖walker 的常用位置）。

静态链接也与此无关。您**不能**静态链接混合模式的 C++/CLI 应用程序。

1.  将您的 DLLMAIN 函数单独放入一个文件中。
2.  确保此文件**未**在构建选项中设置**/CLR**（*文件*构建选项）
3.  确保您与 /MD 或 /MDd 的链接，以及您链接的所有依赖项都使用完全相同的 CRT。
4.  评估 /DEFAULTLIB 和 /INCLUDE 的链接器设置以识别任何可能的引用问题，您可以在代码中声明原型并使用 /INCLUDE 覆盖默认库链接解析。

祝你好运，还检查了那本书，它非常好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T06:10:15.713

确保目标系统具有正确的 MS Visual C 运行时，并且您不会意外地使用调试运行时构建 C dll。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T05:03:40.117

这是一个有趣的困境。在从 C# 调用本地 .DLL 之后，我从未听说过从 C++/CLI 加载本机 .DLL 的问题。我只能假设问题出在[@Daniel L](https://stackoverflow.com/questions/647310/c-to-c-cli-to-c-dll-system-io-filenotfoundexception/647319#647319)建议的范围内，并且您的 .DLL 根本不在程序集加载器可以找到的路径中。

如果 Daniel 的建议不起作用，我建议您尝试将本机 C 代码静态链接到 C++/CLI 程序，如果可以的话。这肯定会解决问题，因为 .DLL 将被完全吸收到 C++/CLI .DLL 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-14T15:47:10.823

切换到 64 位 Vista 时遇到同样的问题。我们的应用程序正在调用 Win32 DLL，这混淆了应用程序的目标构建。为了解决它，我们做了以下事情：

1.  转到项目属性；
2.  选择构建选项卡；
3.  将“平台目标：”选项更改为 x86；
4.  重建应用程序。

当我重新运行应用程序时，它起作用了。

# windows - 如何以编程方式刷新 Windows 资源管理器？

> ID：647316
> 
> 赞同：22
> 
> 时间：2009-03-15T04:40:57.253
> 
> 标签：windows, winapi, windows-vista, explorer, windows-explorer

我有一个 Windows shell 扩展，它使用[IShellIconOverlayIdentifier](http://msdn.microsoft.com/en-us/library/bb761265(VS.85).aspx)接口在文件和文件夹上显示覆盖图标。我的扩展有点像[TortoiseCVS](http://www.tortoisecvs.org/)或[TortoiseSVN](http://tortoisesvn.tigris.org/ExplorerIntegration.html#overlays)。

有时我需要让 Windows 资源管理器重绘它的所有图标。为此，我像这样调用[SHChangeNotify](http://msdn.microsoft.com/en-us/library/bb762118(VS.85).aspx)：

```
SHChangeNotify(SHCNE_ASSOCCHANGED, SHCNF_IDLIST, NULL, NULL) 
```

这会刷新任何打开的资源管理器窗口的桌面和右侧窗格。它不会刷新任何资源管理器窗口左侧的文件夹树。

所以我尝试像这样发送[WM_SETTINGCHANGE](http://msdn.microsoft.com/en-us/library/ms725497(VS.85).aspx)：

```
SendMessage(HWND_BROADCAST, WM_SETTINGCHANGE, 0, 0) 
```

在 Vista 上，这会刷新文件夹树，但不会刷新右侧窗格。

`SHChangeNotify()`后跟的组合`WM_SETTINGCHANGE`似乎在 Vista 上运行良好。但是如果显示，我仍然无法刷新XP上的文件夹树。

有谁知道如何更好地做到这一点？

XP有更好的解决方案吗？

发送`SHCNE_ASSOCCHANGED`有点像在头顶上杵 Explorer。它会导致整个桌面非常剧烈地刷新，并导致任何打开的资源管理器窗口松动那里的滚动位置。有没有比这更暴力的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T12:49:50.603

> 有谁知道如何更好地做到这一点？

个人不知道。你提到了做类似事情的 Tortoise 程序，所以一个很好的起点是看看他们在源代码中做了什么:)

这些看起来是处理此问题的相关源文件：

*   [TortoiseCVS - ShellUtils.cpp](http://tortoisecvs.cvs.sourceforge.net/viewvc/tortoisecvs/TortoiseCVS/src/Utils/ShellUtils.cpp?revision=1.70&view=markup&pathrev=MAIN)
*   [TortoiseSVN - ShellUpdater.cpp](http://tortoisesvn.tigris.org/svn/tortoisesvn/trunk/src/Utils/ShellUpdater.cpp)（用户名：“guest”，密码：“”）

`RebuildIcons`我在每个方法中都会注意到：

1.  将外壳图标大小或颜色深度设置为临时值
2.  通过广播设置更改来更新所有窗口
3.  将外壳图标大小或颜色深度重置为原始值
4.  通过广播设置更改第二次更新所有窗口

也许这是让事情在 XP 中工作的技巧的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T13:17:39.697

使用 spy++ 查看在 Windows 资源管理器中按 F5 时发送的 WM_COMMMAND 消息或查找用于查看/刷新的菜单消息

然后使用 FindWindow 获取您想要的资源管理器窗口并将之前记录的 WM_COMMAND 等消息发送给它。

这是控制各种 Windows 程序的有趣方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-30T23:10:36.733

您还可以将带有 F5 键码的 WM_KEYDOWN 消息发送到所有打开的资源管理器窗口。不过，这有点骇人听闻。

# xslt - 使用 xslt，根据第二个 xml 文档的内容转换一个 xml 文档

> ID：647324
> 
> 赞同：2
> 
> 时间：2009-03-15T04:45:38.147
> 
> 标签：xslt, filtering

我有一组文档隐式定义了第二组对象的允许字段，这些对象必须转换为第三组文档（要使用的“规则”文档取决于要转换的文件的内容），例如

```
<!-- One example rules document --> 
<document object="obj1_rules">
<field name="A"/>
<field name="B"/>
<field name="C"/>
</document>

<!-- Document to be tranformed based upon obj1_rules--> 
<document object="obj1">
<field name="A"/>
<field name="B"/>
<field name="C"/>
<field name="D"/>
<field name="E"/>
</document>

<!-- Desired result--> 
<document object="obj1">
<newfield name="A"/>
<newfield name="B"/>
<newfield name="C"/>
</document> 
```

是否可以使用 xslt 进行这种转换？

我看到[“XSLT 无法在运行时构造 XPath 表达式（例如变量引用）”。](http://dpawson.co.uk/xsl/sect2/nono.html#d1974e22) 所以我不走运，或者我只是错误地看待这个问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T15:20:13.147

**这是一个简单的解决方案**：

**这种转变**：

```
<xsl:stylesheet version="1.0" 
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output omit-xml-declaration="yes" indent="yes"/>
    <xsl:strip-space elements="*"/>
<!--                                                   -->  
    <xsl:variable name="vrtfRules">
        <document object="obj1_rules">
            <field name="A"/>
            <field name="B"/>
            <field name="C"/>
        </document>
    </xsl:variable>
<!--                                                   -->  
    <xsl:variable name="vRules" select=
     "document('')/*/xsl:variable
                   [@name = 'vrtfRules']
                     /*
     "/>
<!--                                                   -->  
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*"/>
        </xsl:copy>
    </xsl:template>
<!--                                                   -->  
    <xsl:template match="field">
      <xsl:if test="@name = $vRules/*/@name">
        <newfield>
          <xsl:apply-templates select="node()|@*"/>
        </newfield>
      </xsl:if>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于原始提供的源 XML 文档时：**

```
<document object="obj1">
    <field name="A"/>
    <field name="B"/>
    <field name="C"/>
    <field name="D"/>
    <field name="E"/>
</document> 
```

**产生所需的结果：**

```
<document object="obj1">
   <newfield name="A"/>
   <newfield name="B"/>
   <newfield name="C"/>
</document> 
```

**请注意**，“规则文档”在样式表中只是为了紧凑。单独文件时，只[**`document()`**](http://www.w3.org/TR/xslt#function-document)需要根据实际使用的功能进行调整`href`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T04:53:58.017

也许我过于简单化了，但是为什么您的“规则文档”不能简单地成为 XSLT 有什么原因吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T05:33:26.863

好吧，我明白为什么您希望在简单的 xml 文件中而不是在成熟的 xsl 样式表中包含规则，但您只是跳过了一个步骤。

您需要制作一个 xsl 样式表，它将您的 xml 规则文档转换为一个 xsl 样式表，然后您将其应用于您的源 xml。

诀窍在于命名空间，而不是被应用的 xsl 规则和生成的 xsl 规则的混合混淆。

```
    <?xml 版本="1.0" ?>
    <xsl:样式表
        xmlns="YOUR_NAMESPACE_HERE"
        xmlns:output="http://www.w3.org/1999/XSL/Transform"
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
        版本="2.0">

        <xsl:输出
            方法="xml"
            缩进=“是”
            媒体类型="文本/xsl" />

        <xsl:模板匹配="/">
            <输出：样式表版本=“2.0”>
                <xsl:应用模板 />
            </输出：样式表>
        </xsl:模板>

        <xsl:template match="文档[@object]">
            <输出：模板匹配="文档[@object='{@object}']">
                <输出：复制>
                    <xsl:应用模板 />
                </输出：复制>
            </输出：模板>
        </xsl:模板>

        <xsl:template match="字段[@name]">
            <输出：if test="field[@name='{@name}']">
                <output:copy-of select="field[@name='{@name}']" />
            </输出：如果>
        </xsl:模板>

    </xsl:样式表>

```

我假设您会在规则和文档本身中使用相同的文档对象属性（这在 imo 中要简单得多）。

因此，您通过上面的样式表运行您的规则文档。结果是一个新的 xsl 样式表，它完全按照您在 xml 规则文档中的描述进行操作。然后，您将这个生成的样式表应用到您的源文档中，您应该会得到您期望的结果。

# java - 最初的 Java 理想已经死了吗？

> ID：647330
> 
> 赞同：7
> 
> 时间：2009-03-15T05:01:45.363
> 
> 标签：java, api, java-me, sun

我觉得虽然我喜欢 J2ME 和 Java，但拥有两个用于 Java 的 API 是虚伪的。Java 在设计时考虑了“一个代码，多个平台”，现在它更像是“一个 API 用于每个操作系统，一个 API 用于所有比上网本更小的东西”。我看到很多 J2ME 仿真器等被移植到诸如 PSP 和其他自制软件控制台之类的东西上，我想知道为什么没有人用普通的 Java 来做这件事。

我很想写一个游戏在我的电脑上玩，而不是启动一个简单的模拟器并在 PSP 或 Dreamcast 上玩同样的游戏，但我不能。J2ME甚至不能在PC上运行，你需要一个模拟器，这大大减少了你的市场。另外，大多数仿真器都很笨重，而且不好。

随着像 iPhone 这样的超级手机问世，人们想要的不仅仅是小型 J2ME 游戏，所以如果 Java 不能将他们的标准 JRE 移植到它，他们可能会发现自己错过了像微软在上网本热潮中所做的那样。

感觉就像 Sun 需要努力使标准 JRE 更小、更便携，或者让 J2ME 在 PC 上更容易使用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-15T05:09:29.807

我认为这应该是一个社区 Wiki

但就这一点而言，我的观点是 J2ME 将死去，让我们使用普通的 Java。当前的上网本趋势与更强大的智能手机趋势相结合，意味着今天的普通手机比刚推出时运行 J2SE 的机器要强大得多。

因此，我们可以取消为古代诺基亚设计的 J2ME，并在智能门把手（或智能手机）上享受标准 Java。

Java 面临的唯一问题是智能手机应用程序中的最大玩家——Apple——在可预见的未来任何时候都不会允许 JVM。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T05:35:09.323

即使你的显示器里面有一个加速度计，你也可能不想将它用于 iPhone 应用程序——所以我想说毕竟便携性是有限制的。

如果“编写一次，随处运行”具有误导性，那是因为它是在手机普及之前就被构思出来的。就 API 而言，我同意一个公共子集会更好，但再一次，整个 J2ME 利基市场是全新的。JVM 仍然有用：Web 浏览器可以在 Windows、Linux 和 OS X 上运行，游戏可以在诺基亚和三星手机上运行。

**最初的 Java 理想已经死了吗？**

它仍然满足从工作站到工作站的可移植代码的原始需求，所以没有。但听起来你为未来的平台设定了更高的标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T06:04:07.240

虚拟机可能会选择抽象出许多东西。

操作系统通过向它们提供标准接口（块 i/o、字符 i/o 等）来抽象出一些通用硬件。

JVM 开始抽象出处理器*和*操作系统本身，这本身就是一个伟大的目标（当时）！然而，将外围硬件抽象化是一个难以实现的目标。

也许，当我们看到手持设备/笔记本电脑/台式机/服务器的更多融合时，抽象出硬件的需求将会减少。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T05:53:27.953

随着 Windows Mobile 和 Symbian 等较新的移动平台已经占据了市场份额，j2me 等由于没有利用硬件等问题而退居次要地位。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-01T11:05:44.310

J2ME 很棒。您可以使用简洁的[http://www.microemu.org/](http://www.microemu.org/)打包和运行 J2ME 应用程序。因为我一直在为 J2ME 编写代码，所以我是一个更好的程序员。它迫使你提高记忆力。我喜欢小巧干净的 API。将来我所有的客户端应用程序都将为 J2ME 设计，然后移植到 J2SE/Android/IPhone。困难在于构建您的内部 GUI 框架，使其足够灵活，以使应用程序能够在任何屏幕尺寸上顺利运行。这需要时间。

# iphone - iPhone上的NSDictionary泄漏和对象参考图

> ID：647337
> 
> 赞同：0
> 
> 时间：2009-03-15T05:17:24.077
> 
> 标签：iphone, cocoa-touch

我只是将一个 plist 加载到一个临时字典中以初始化我的数据模型。不幸的是，根据 Instruments，下面这行代码会导致整个应用程序生命周期中的持续泄漏。泄漏的对象是`NSCFString`Malloc 上的 GeneralBlock 和负责的库是 Foundations。

我对有经验的眼睛的两个问题：

1.  我在做一些奇怪的事情来触发这个吗？我尝试将它包围在自动释放块中，但没有效果。
2.  有没有办法打印可疑对象的对象引用列表以深入了解对象孤立过程。

泄漏线：

```
NSDictionary *tempDict = [NSDictionary dictionaryWithContentsOfFile:
                             [[NSBundle mainBundle]
                                 pathForResource:resourceName
                                 ofType:@"plist"]];

totalChapters = [[tempDict objectForKey:@"NumberOfChapters"] intValue]; 
chapterList  = [[NSMutableArray alloc] initWithCapacity: totalChapters];
[chapterList addObjectsFromArray:[tempDict objectForKey:@"Chapters"]]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T05:35:04.097

看来您可能在此行泄漏：

```
[[NSMutableArray alloc] initWithCapacity: totalChapters]; 
```

如果那个对象没有被释放，那么你添加到它的任何对象也不会被释放

* * *

**编辑**（因为评论太长了）：

Instruments 会告诉您内存分配的位置，但不会告诉您为什么仍然保留它。当 NSDictionary 加载文件的内容时，它必须为它加载的每个元素创建一个对象。如果稍后使用`objectForKey:`, `retain`it 检索对象而忘记了`release`，则会报告泄漏。该`dictionaryWithContentsOfFile`语句将为此受到指责，因为它执行了分配。

我同意 Don 的幻象调试。`chapterList`当您第二次分配给它时，很可能您还没有释放旧的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T07:08:47.103

我在这个类的 dealloc 方法中释放所有分配的东西。下面的 TROUBLED 行在每个 alloc init 中重复调用，以帮助我根据用户选择加载新章节。

NSDictionary *tempDict = [NSDictionary dictionaryWithContentsOfFile:[[NSBundle mainBundle] pathForResource:resourceName ofType:@"plist"]];

由于我在 NSDictionary 上使用便捷方法，因此我没有任何可用于 Dealloc 的内容。但是 Instrument 指出这条特定的线路是通过 Malloc 泄漏的来源。

tempDict 只是字典加载 plist 和初始化 ivars 的临时空间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-12-29T14:03:33.183

自动释放块仅影响放置在自动释放池中的对象。所以 tempDict 放在自动释放池中，但 totalChapters 不是。如果您想使用自动释放池，那么您可以：

`[[[NSMutableArray alloc] initWithCapacity: totalChapters] autorelease];`

或者不要使用自动释放池并使用：

`[[NSMutableArray alloc] initWithCapacity: totalChapters]`
接着
`[totalChapters release]`

除非必要，否则建议避免使用自动释放池。

# asp.net - 用于尝试学习 ASP.NET 的 WinForms/WPF 开发人员的资源

> ID：647340
> 
> 赞同：3
> 
> 时间：2009-03-15T05:18:40.830
> 
> 标签：asp.net, asp.net-mvc, wpf, winforms, asp.net-ajax

对于 WinForms/WPF 开发人员来说，你最好的资源是什么来加快 ASP.NET 的速度？学习如何使用 ASP.NET 是否需要完全的范式转变，还是会稍作调整？

我会将答案标志授予帖子，并提供一种资源，让我在最短的时间内加快速度。可下载的代码和代码示例将是最有帮助的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T05:22:46.857

[ASP.NET 官方网站](http://www.asp.net/)有[教程和视频](http://www.asp.net/Learn/)

[来自 Rolla 的 4 Guys](http://www.4guysfromrolla.com/)是一个很好的资源，[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/)也是如此。

W3Schools 有[教程](http://www.w3schools.com/ASPNET/default.asp)。

[对 ASP.NET MVC 有很大的转变，所以我建议你看一下]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T06:09:47.773

网络上有很多资源，但我肯定会推荐 ASP.NET 社区站点的学习部分：[http ://www.asp.net/learn/](http://www.asp.net/learn/)

我还推荐[Professional ASP.NET 3.5 SP1 Edition：In C# and VB](http://www.wrox.com/WileyCDA/WroxTitle/Professional-ASP-NET-3-5-SP1-Edition-In-C-and-VB.productCd-0470478268.html) from Wrox。

# objective-c - 可可还是Objective-C？

> ID：647360
> 
> 赞同：8
> 
> 时间：2009-03-15T05:46:20.263
> 
> 标签：objective-c, iphone, cocoa, cocoa-touch

关于 iPhone 开发，您现在如何使用 Cocoa 与纯`Objective-C`对象。例如，以下是`Objective-C`：

*   NS定时器
*   NSString
*   整数，浮点数
*   NSMutableArray

但这些是可可：

*   UIL标签
*   用户界面颜色（？）
*   界面视图

并且要清楚，确实

`Cocoa Touch`== iPhone 开发

`Cocoa`== Mac OS X 开发

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-03-15T05:55:16.297

你有点搞错了。

NSTimer、NSString、NSMutableArray 都是 Cocoa。`int`并且`float`实际上是 C，但由于 Objective-C 是 C 的严格超集，因此您可以在 Objective-C 代码中使用它们。

纯 Objective-C 只需要链接到 Objective-C 运行时库，不需要其他框架或库。Cocoa 是一个包含 NSObject 和 NSString 之类的框架。其他框架，如 AppKit，扩展了 Cocoa 框架。

`Object`用纯 Objective-C 编码通常意味着从被调用的根对象而不是 NSObject派生。`@implementation`,`@interface`等是 Objective-C 对 C 的扩展，这些在所有`@selector`Objective-C 源代码中都很常见，无论是否纯。如果你想用纯 Objective-C 编写代码，除了你自己的从`Object`.

```
#import <objc/Object.h> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-15T06:12:21.060

正如已经指出的，NS* 类实际上是 Cocoa，而不是 Objective-C。Objective-C 是一种语言，而 Cocoa 是一种框架（OpenStep 的实现）。这个框架可以被认为是 C++ 的“stdlib”等价物。UI* 类是 Cocoa Touch，这是为 iPhone 创建的另一个框架。

至于最后一个问题，是的，Cocoa Touch 仅适用于 iPhone。Cocoa 用于 Mac OS X 开发。然而，如上所述，Cocoa 是一个 OpenStep 实现。存在 Cocoa 的替代品，例如 GNUstep 和 Cocotron。这些替代框架允许在多个平台上使用相同的代码。因此，OpenStep 框架不仅适用于 Mac OS X 开发，还适用于 Linux 和 Windows。

另一件需要注意的是，其他 Objective-C 运行时是不同的。没有单一的 Objective-C 规范。[Portable Object Compiler](http://users.telenet.be/stes/compiler.html)是另一种方法。由于 Apple 是 Objective-C 的主要用户，并且它控制着 Cocoa，因此它被认为是事实上的 Objective-C 实现。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-11T12:31:40.673

确实，Cocoa Touch 是用于 iPhone 开发的，而“plain” Cocoa 是用于 Mac OS X 开发的，但它们并没有太大区别，并且共享大部分基本类。

在 iPhone 开发中，您无需关心您使用的是纯 Objective-C 还是 Cocoa。Cocoa 是 iPhone 上的一等公民，避免它不会获得任何好处。

Objective-C 和普通的旧 C 子集之间存在细微差别。对象分配和方法调用比堆栈分配结构和直接函数调用具有更高的开销，但 99% 的时间您也不需要关心这一点（不要尝试过早优化！）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T06:25:09.483

> 关于 iPhone 开发，您现在如何使用 Cocoa 与纯 Objective-C 对象。

如果您的应用程序中除了 Objective-C 之外没有使用任何东西，那么所有 Cocoa 对象都是 Objective-C 对象。

如果您使用的是 Python 或 Ruby，那么您的对象将是 Python 或 Ruby 对象。但是只要它们继承自 Cocoa 类，它们就可以被其他 Cocoa 对象访问，无论它们是否是用 Objective-C 编写的。

（有 Core Foundation，它提供了在 Cocoa 中可以正常工作但不是用 Objective-C 编写的对象。这是一个实现细节；不用担心。）

> 例如，以下是 Objective-C：
> 
> *   NS定时器
> *   NSString
> *   整数，浮点数
> *   NSMutableArray

只有 NSTimer、NSString 和 NSMutableArray 是 Objective-C 类。int 和 float 是原始类型，而不是类。而且它们都不是来自Objective-C：int和float来自C，NS*类都来自Cocoa。

正如我在写这篇文章时 sebnow 所写的，Cocoa 是一种框架，而 Objective-C 是一种语言。NS* 类都来自 Cocoa 框架，而不是 Objective-C 语言。

> 但这些是可可：
> 
> *   UIL标签
> *   用户界面颜色（？）
> *   界面视图

不，那些是 Cocoa Touch。它们在 Cocoa 应用程序中不可用。同样，Application Kit 类在 Cocoa Touch 中不可用。

（Cocoa 是 Foundation + AppKit；Cocoa Touch 是 Foundation + UIKit。）

> 并且要清楚，确实
> 
> Cocoa Touch == iPhone 开发
> 
> Cocoa == Mac OS X 开发

是的。Cocoa Touch 是 iPhone 框架；Cocoa 是 Mac 框架。

# ruby - 在 Ruby 中将空字符串转换为 nil

> ID：647370
> 
> 赞同：24
> 
> 时间：2009-03-15T05:59:52.167
> 
> 标签：ruby, boolean, string

我有一个调用的字符串`word`和一个调用的函数`infinitive`，它
`word.infinitive`会在某些情况下返回另一个字符串和一个空字符串，否则
我试图为下面的代码片段找到一个优雅的 ruby​​ 单行表达式

```
if word.infinitive == ""
      return word
else return word.infinitive 
```

如果不定式返回 nil 而不是“”，我可以做类似的事情

```
(word.infinitive or word) 
```

但是因为它没有，所以我不能利用短路或
理想情况下我想要
1）我可以轻松嵌入其他代码中的单个表达式
2）函数不定式仅被调用一次
3）不添加任何在我的代码中自定义宝石或插件

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2011-03-24T22:47:42.047

ActiveSupport[`presence`](http://guides.rubyonrails.org/active_support_core_extensions.html#presence)方法将空（或`blank?`）字符串转换为`nil`. 它专为您的确切用例而设计：

```
word.infinitive.presence || word 
```

请注意，您可以轻松地在 Rails 之外使用 ActiveSupport：

```
require 'active_support/core_ext/object/blank' 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-06-07T14:40:55.480

您可以使用[本文建议的正则表达式](http://rors.org/2008/3/19/self-or-default-if-empty-dry-way)

```
(word.infinitive[/.+/m] or word) #Fancy way to convert "" to nil 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-15T06:28:24.423

如果您不为猴子补丁和滥用语法感到羞耻，这将起作用：

```
class String
  def | x
    if empty? then x else self end
  end
end 
```

然后你可以说`word.infinitive | word`，如果你问我，它实际上是相当自然地扫描的。

但是，我认为一个更好的主意是修改不定式方法，或者添加一个返回单词不变的版本。

*编辑：*这是一个可能更优雅的解决方案：

```
[word.infinitive, word].find {|x| not x.empty?} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-15T09:10:32.550

做正确的事 - 修复不定式，使其返回 nils 而不是空白字符串，或者如果您真的无法触摸它，则使用您自己的界面包装它。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-05-25T21:27:41.063

或者，您可以在不必滥用语法的情况下将新函数修补到 String。

```
class String
  def squash
    self.empty? ? nil : self
  end
end 
```

现在你可以做

```
puts var.squash or "default text" 
```

我不是以英语为母语的人，所以我不知道*壁球*是否是最好的词。有没有一个词可以更好地传达“只有在为空时才变为 nil”的想法？

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-15T06:23:23.217

您可以将三元运算符`(boolean ? true-val : false-val)`与`String#empty?`

```
return word.infinitive.empty? ? word : word.infinitive 
```

如果您只想调用一次不定式：

```
return (inf = word.infinitive).empty? ? word : inf 
```

您可能还需要考虑在代码中添加一些[记忆。](http://en.wikipedia.org/wiki/Memoization)

# css - 在运行时为网页选择内联、文档或外部样式表

> ID：647372
> 
> 赞同：0
> 
> 时间：2009-03-15T06:06:27.547
> 
> 标签：css

**请帮帮我** **在网页运行时选择内联、文档或外部样式表之一**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T06:49:38.397

[List Apart](http://www.alistapart.com/articles/alternate/)提供了几个 Javascript 函数，允许您切换样式表。把它连接到你的`<select>`.

# c# - 使用 ASP.NET 从服务器调整大小并显示图像

> ID：647377
> 
> 赞同：4
> 
> 时间：2009-03-15T06:12:43.070
> 
> 标签：c#, asp.net, image-processing

有个问题。我的服务器上托管了图像。我已经知道上传图像以调整大小并保存时的方法，但我有另一个想法。

1.  我想知道当用户请求图像时是否有办法调整大小。不是用户上传的时候。

因此，例如，一个用户去上传一张图片，我不调整它并保存另一个调整大小的图片的副本。相反，当用户通过 ASP.NET img 控件/标记请求图像时，它将动态调整图像的大小以显示它并通过 img 标记/控件显示它。

我为什么要这样做？

为了节省磁盘空间。大多数服务器都有磁盘空间限制，但没有服务器处理限制。所以我想节省磁盘空间并改用处理空间。

**编辑：**作为一个启动网站，目前我节省磁盘比节省处理时间更好。目前我没有太多钱购买大量空间。希望网站启动时它会改变。

有任何想法吗？谢谢男孩女孩。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T06:46:59.650

我假设您可以“控制”调整大小图像的 url，因此例如可以引用全尺寸图像，因为`<img src="uploads/myphoto.jpg"/>`缩略图可能是 ASPX 或 ASHX 之类的`<img src="uploads/myphoto.jpg.ashx"/>`？

CodeProject - Dynamic Image Resize 上的这篇**[文章](http://www.codeproject.com/KB/aspnet/ImageResizeWithHttpModule.aspx)**似乎正好有您正在寻找的源代码（虽然它在 VB 中，但如果您是 C# 人员，移植应该不难）。希望有帮助。

最后，我鼓励您考虑各种形式的缓存（都使用 Http-Headers，以确保尽可能在客户端或代理处缓存图像；并使用内置的 ASP.NET 功能来避免对相同的不必要的处理图像一遍又一遍）。

尽管您将节省磁盘配额，但您实际上会减慢所有其他页面/请求的速度……只是一个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-07-17T08:43:59.927

动态图像调整大小有很多优点，其中最小的就是减少磁盘空间的使用。但是，它确实需要与某种形式的持久缓存相结合，例如 Amazon CloudFront 或磁盘缓存。

动态图像大小调整为您的网站提供了极大的灵活性，而预先生成的图像变体将您锁定，防止您最终必须进行更改。与缓存结合使用时，两者之间没有运行时性能差异。

ImageResizer库[提供磁盘缓存、CloudFront 缓存以及正确的内存和缓存管理](http://imageresizing.net)。自 2007 年以来，它一直在不断改进和维护，并且非常防弹。它还运行着一些社交网站，其中一些拥有超过一百万张图片。

这是一个经过时间测试、流量测试和单元测试的库 :) 它使用起来也非常简单 - 您只需添加`?width=x&height=y`到查询字符串中即可。可以通过 20 多个插件添加功能，因此您不会被未使用的代码和功能拖累。

CraigD 提到的文章本质上限制了它的性能，因为它使用 HttpHandler 而不是使用 HttpModule - 在调整大小的图像写入磁盘后，HttpHandler 无法将请求传递回 IIS 本机代码以执行。它也不能正确调整 jpeg 编码或与 ASP.NET 缓存或 URL 授权系统配合使用。虽然，我不得不承认 - 与我见过的大多数示例代码相比，它[违反了我编译的图像调整大小的陷阱要少得多](http://nathanaeljones.com/163/20-image-resizing-pitfalls/)。

我强烈建议[使用 ImageResizer 库](http://imageresizing.net)。这是很好的代码，我写的 :) 如果您最终使用示例代码或编写自己的代码，[请避免这些陷阱](http://nathanaeljones.com/163/20-image-resizing-pitfalls/)！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T06:32:41.603

您可以创建 IHttpHandler 的实现来响应图像请求，在该处理程序中，您可以拥有从磁盘加载图像并将其转换为所需大小的代码。您需要使用响应返回正确的 mime 类型，并使用 WriteBytes 方法（或类似的方法，我忘记了名称）。此外，您可以查看内容过期标头，以便图像可能不必每次都由同一个客户端加载，而是被缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T17:56:30.553

您声称无限处理但有限的磁盘空间。大多数情况下，即使他们不强制执行处理限制，因为您有更多的客户，点击您的站点，处理将成为比存储空间更严重的瓶颈，并且添加更多处理将花费更多。此外，

*   如果您有大图像，即使您存储显示和缩略图版本，调整大小和压缩后的版本也会占用原件的 %10 空间。
*   否则，只需提供它们并通过浏览器调整大小显示它们，它会更快。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-15T06:52:53.303

它并不是真正实际调整图像大小，而是在显示图像时调整大小，但我成功使用它很简单

```
 <img src="myimage" height="height you want to give" width="width you want
 to give" alt="" /> 
```

它每次都在工作。

# asp.net - 是否可以让不同程序集中的两个部分类代表同一个类？

> ID：647385
> 
> 赞同：137
> 
> 时间：2009-03-15T06:25:46.720
> 
> 标签：asp.net, partial-classes, asp.net-dynamic-data

我在一个名为“MyProject.Data”的项目中有一个名为“Article”的类，它充当我的 Web 应用程序的数据层。

我有一个名为“MyProject.Admin”的单独项目，它是一个基于 Web 的管理系统，用于查看/编辑数据，并使用 ASP.NET 动态数据构建。

基本上我想使用部分类来扩展 Article 类，以便我可以使用“UIHint”扩展器来扩充它的一个属性，这将允许我用 FCKEdit 控件替换普通的多行文本框。

我的部分类和扩展程序如下所示：

```
[MetadataType(typeof(ProjectMetaData))]
public partial class Project
{
}

public class ProjectMetaData
{
    [UIHint("FCKeditor")]
    public object ItemDetails { get; set; }
} 
```

现在，如果部分类与原始部分类在同一个项目中 - 即 MyProject.Data 项目，这一切都可以正常工作。

但 UI 行为不应位于数据层，而应位于管理层。所以我想把这个类移到 MyProject.Admin。

但是，如果我这样做，功能就会丢失。

我的基本问题是：我可以在不同的项目中有 2 个部分类，但都指的是同一个“类”吗？

如果没有，有没有办法在不将数据层逻辑与 UI 逻辑混合的情况下完成我想要做的事情？

* * *

## 回答 #1

> 赞同：191
> 
> 时间：2009-03-15T07:53:16.263

不，您不能在两个不同的程序集（项目）中有两个部分类引用同一个类。一旦程序集被编译，元数据就会被烘焙，你的类不再是部分的。部分类允许您将同一类的定义拆分为两个文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-15T08:46:50.440

如前所述，部分类是编译时现象，而不是运行时。根据定义，程序集中的类是完整的。

在 MVC 术语中，您希望将视图代码与模型代码分开，同时根据模型属性启用某些类型的 UI。查看[Martin Fowler 对不同风格的 MVC、MVP 等的精彩概述](https://martinfowler.com/eaaDev/uiArchs.html)：您会发现大量的设计理念。我想你也可以使用[依赖注入](https://en.wikipedia.org/wiki/Dependency_injection)来告诉 UI 什么样的控件对单个实体和属性是可行的。

你分离关注点的目标是伟大的。但是部分类旨在解决完全不同的问题（主要是代码生成和设计时建模语言）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-08-01T11:31:31.813

扩展方法和 ViewModel 是在前端扩展数据层对象的标准方法，如下所示：

数据层（类库，Person.cs）：

```
namespace MyProject.Data.BusinessObjects
{
  public class Person
  {
    public string Name {get; set;}
    public string Surname {get; set;}
    public string Details {get; set;}
  }
} 
```

显示层（Web 应用程序）PersonExtensions.cs：

```
using Data.BusinessObjects
namespace MyProject.Admin.Extensions
{
  public static class PersonExtensions
  {
    public static HtmlString GetFormattedName(this Person person)
    {
       return new HtmlString(person.Name + " <b>" + person.Surname</b>);
    }
  }
} 
```

ViewModel（用于扩展视图特定数据）：

```
using Data.BusinessObjects
namespace MyProject.Admin.ViewModels
{
  public static class PersonViewModel
  {
    public Person Data {get; set;}
    public Dictionary<string,string> MetaData {get; set;}

    [UIHint("FCKeditor")]
    public object PersonDetails { get { return Data.Details; } set {Data.Details = value;} }
  }
} 
```

控制器 PersonController.cs：

```
public ActionMethod Person(int id)
{
  var model = new PersonViewModel();
  model.Data = MyDataProvider.GetPersonById(id);
  model.MetaData = MyDataProvider.GetPersonMetaData(id);

  return View(model);
} 
```

查看，Person.cshtml：

```
@using MyProject.Admin.Extensions

<h1>@Model.Data.GetFormattedName()</h1>
<img src="~/Images/People/image_@(Model.MetaData["image"]).png" >
<ul>
  <li>@Model.MetaData["comments"]</li>
  <li>@Model.MetaData["employer_comments"]</li>
</ul>
@Html.EditorFor(m => m.PersonDetails) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-24T16:40:30.870

将基础文件作为链接文件添加到您的项目中。它仍然是部分的，但它允许您在两个项目之间共享它，使它们保持同步，同时在部分类中具有特定于版本/框架的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-06-24T11:18:28.127

我也有类似的问题。我将部分类保存在我的数据项目中，所以在你的情况下是“MyProject.Data”。MetaDataClasses 不应该进入您的 Admin 项目，否则您将创建循环引用。

我为我的 MetaDataClasses 添加了一个新的 Class Lib 项目，例如“MyProject.MetaData”，然后从我的数据项目中引用它

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-11T13:43:54.880

也许使用静态扩展类。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-03T22:36:11.003

只需在新项目中添加类文件作为链接，并在部分类中保持相同的命名空间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-23T13:58:58.777

我可能在这里弄错了，但您能不能简单地在您的 MyProject.Admin 项目中定义 ProjectMetaData 类？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-20T10:28:33.553

自 2019 年以来，您可以使用技巧在不同的程序集中拥有部分类的 2 个部分。此技巧在本文中进行了解释和演示：

[https://www.notion.so/vapolia/Secret-feature-Xamarin-Forms-control-s-auto-registration-1fd6f1b0d98d4aabb2defa0eb14961fa](https://www.notion.so/vapolia/Secret-feature-Xamarin-Forms-control-s-auto-registration-1fd6f1b0d98d4aabb2defa0eb14961fa)

它在其核心使用对 SDK 类项目的 MSBuild.Sdk.Extras 扩展，通过使用具有多个同时目标的一个项目，有效地在一次编译中创建多个程序集，从而解决了将类的所有部分部分放在同一个程序集中的限制同一个项目的。

# c# - 你应该总是用“this”来引用局部类变量吗？

> ID：647389
> 
> 赞同：5
> 
> 时间：2009-03-15T06:29:06.887
> 
> 标签：c#

在 C# 中，您可以使用“this”关键字来引用类中的值。

```
class MyClass
{
    private string foo;

    public string MyMethod()
    {
        return this.foo;
    }
} 
```

虽然我认为答案很可能是用户偏好，但在类中使用 this 关键字来获取本地值是最佳实践吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-15T06:32:21.340

本着[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)的精神，我想说这通常不是一个特别有用的做法。几乎所有的使用都`this`可以通过删除`this`.

一个例外是，如果您有一个恰好与另一个类成员同名的本地参数；在这种情况下，您必须用 区分两者`this`。但这种情况很容易避免，只需重命名参数即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T06:34:18.400

我`this`几乎只在某个成员隐藏另一个成员时使用关键字，并且当我需要将当前类实例传递给一个方法时，例如：

```
class Employee
{
    private string name;
    private string address;

    // Pass the current object instance to another class:
    public decimal Salary 
    {
        get { return SalaryInfo.CalculateSalary(this); }
    }

    public Employee(string name, string address) 
    {
        // Inside this constructor, the name and address private fields
        // are hidden by the paramters...
        this.name = name;
        this.address = address;
    } 

} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T06:36:16.370

我想说这取决于您对自己编码的个人偏好以及工作中代码的团队/公司编码标准。就个人而言，我尝试保持个人和“专业”编码标准相同——它可以减少混淆等。

我更喜欢在所有类级函数和变量上使用“this”。通过使用“this”，您可以立即判断该项目是否为班级成员。此外，我更喜欢在属于任何基类的成员上使用“base”。这不是必需的，但它有助于提高可读性，尤其是如果不熟悉您的代码的人正在阅读它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T06:31:19.580

我更喜欢这种语法。随着类变得越来越大并且函数越来越复杂，能够方便地读取变量名称并知道它是否是实例 var 而无需引用代码的另一部分。

编辑：我意识到如果一个人无法跟踪变量，那么可能是重构的时候了。这在摘要中很好。然后澄清一下：如果类及其关系*并不*简单（它们肯定存在），或者在人们没有重构或遵循良好准则以保持参数名称与实例变量不同的代码中，我会说（恕我直言！）使用'this'对于清晰的代码来说并不是一个坏主意。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T06:39:24.893

我从不使用它。大多数情况下，变量是否是成员都没有关系。保持你的方法足够小，以便记住哪些变量是局部变量是没有问题的，并且记住哪些是成员也不会那么麻烦。

我使用“_”作为成员变量的前缀，因为它很容易被忽略。但这意味着永远不会与本地或参数发生冲突，所以这个。没有必要。

我的态度可能因我使用 ReSharper 而“有色”，它的“颜色标识符”模式让我更容易看到什么是什么。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T07:02:12.873

你是对的 - 这是一个非常偏好的事情。当然，许多公司强制执行一组编码风格指南，要么要求`this`在任何实例成员之前，要么要求它不出现。（有人知道 .NET 框架的 Microsoft FxCop 规则是什么吗？）

就个人而言，我更喜欢`this`出现在属于实例的任何属性、方法或字段之前。它使我更容易区分它所属的位置：

*   类实例的成员（以 为前缀`this`）
*   一个静态类成员（我以类名作为前缀）
*   局部范围变量（无前缀）

对我来说，能够不那么含糊地阅读我的代码比保存`this.`. 例如，我立即知道我需要`dispose()`在此范围内打开的所有本地范围项目，并且我不会将它们与不应处置的实例成员混淆。哎呀，只是为了额外的懒惰点，我`this.`用作访问实例成员成员的智能感知列表的快速方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-15T08:12:52.860

在 JavaScript 中，是的！在没有必要的语言中，没有。有些人这样做是为了让阅读代码的人可以看到“成员”——但您的 IDE 应该能够通过突出显示它来解决这个问题。

当 VS 2010 发布时，我的世界和平计划是为 WPF 代码编辑器编写一个扩展，该扩展显示`this.`在对没有该前缀的成员变量的每个引用之前。然后那些需要该提醒的人将不再需要键入它，而那些不喜欢它的人可以干脆不安装我的扩展程序，并且可以自由地删除`this.`他们看到的任何不必要的前缀。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-23T22:24:58.733

我认为如果您特别提到类变量，则应该始终包含它。

这样做的原因是，如果您稍后添加同名的局部变量，您将需要重命名所有类变量，`this.`那么为什么不为您未来的自己节省一些时间和麻烦呢？

# ruby - RSpec Gem 似乎没有安装依赖项

> ID：647392
> 
> 赞同：1
> 
> 时间：2009-03-15T06:31:31.137
> 
> 标签：ruby, rubygems, rspec, jruby, cucumber

**$> jruby -v**

jruby 1.1.4（ruby 1.8.6 补丁级别 114）（2008-08-28 rev 7570）[x86-java]

**$> 宝石安装 rspec**

JRuby 有限的 openss 已加载。gem install jruby-openssl 以获得全面支持。
[http://wiki.jruby.org/wiki/JRuby_Builtin_OpenSSL](http://wiki.jruby.org/wiki/JRuby_Builtin_OpenSSL)
成功安装 rspec-1.1.12
1 个 gem 安装rspec-1.1.12
安装 ri 文档... rspec-1.1.12
安装 RDoc 文档...

**$> 规范--帮助**

.../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:578:in `report_activate_error': 找不到 RubyGem 黄瓜 (>= 0.1.13) (Gem::LoadError)

来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:134：在激活中' 来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb :157: 来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:157: 在gem' 来自 .../jruby/1.1.4/bin/spec:18`activate'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:158: in`
`each`
`activate'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:49: in`

**$> gem 安装黄瓜**

（安装了 cucumber-0.1.16 和依赖项 term-ansicolor-1.0.3、polyglot-0.2.5、treettop-1.2.4、diff-lcs-1.1.2）

**$> 规范--帮助**

.../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:578:in `report_activate_error': 找不到 RubyGem 锄头 (>= 1.8.0) (Gem::LoadError)

来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:134：在激活中' 来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb :157: 在激活中 来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:158: 在每个中 来自 .../jruby/1.1.4/lib/ruby/site_ruby /1.8/rubygems.rb:157：在激活中 来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:157：在激活中 来自 .../jruby/1.1.4 /lib/ruby/site_ruby/1.8/rubygems.rb:158: 在每个' 中来自 .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:157: 在gem' 中来自 ... /jruby/1.1.4/bin/spec:18 `activate'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:158: in`
`each'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:157: in`
`activate'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:157: in`
`activate'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:158: in`
`each'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:157: in`
`activate'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:157: in`
`activate'
from .../jruby/1.1.4/lib/ruby/site_ruby/1.8/rubygems.rb:49: in`

**$> gem 安装锄头**

（安装了 hoe-1.10.0 和依赖 ruby​​forge-1.0.3）

**$> 规范--帮助**

用法：spec (FILE|DIRECTORY|GLOB)+ [options]
(etc., etc., etc.)

*似乎“gem install rspec”没有安装依赖项。
不确定它是否是 Windows 上的 JRuby 独有的……其他操作系统未测试。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-14T17:50:21.633

你试过了吗：

宝石安装 rspec --development

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T16:53:53.997

gem install rspec --include-dependencies 有帮助吗？直到更高版本的 Rubygems 才默认设置，也许 jruby 还不能满足要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T18:32:24.093

适用于我的 JRuby 主干：

```
$ jruby -v
jruby 1.3.0 (ruby 1.8.6p287) (2009-03-15 r9415) (Java HotSpot(TM) 64-Bit Server VM 1.6.0_07) [x86_64-java]
$ jruby -S gem install rspec
**************************************************

  Thank you for installing rspec-1.2.2

  Please be sure to read History.rdoc and Upgrade.rdoc
  for useful information about this release.

**************************************************
Successfully installed rspec-1.2.2
1 gem installed
Installing ri documentation for rspec-1.2.2...
Installing RDoc documentation for rspec-1.2.2...
Could not find main page README.rdoc
Could not find main page README.rdoc
Could not find main page README.rdoc
Could not find main page README.rdoc
$ jruby -S spec --help
Usage: spec (FILE|DIRECTORY|GLOB)+ [options]
   ... 
```

# wpf - 我想学习WPF。您有任何启动项目的建议吗？

> ID：647403
> 
> 赞同：5
> 
> 时间：2009-03-15T06:43:22.700
> 
> 标签：wpf

到目前为止，我的大部分 GUI 编程都是使用 Qt 框架在 C++ 中完成的，我想扩展一点并使用 WPF 做一些 C#。最初，我想为 Windows 编写诸如 Adium 之类的东西，但这似乎有点……对于一个开始的项目来说是雄心勃勃的。我什至不确定你是否可以从 C# 调用 libpurple 的东西，但我想知道。

但是，我的想象力似乎相当缺乏，而且我很难想到一些不是完全微不足道的东西（文本编辑器！计算器！wee！）或相当困难的东西（带有 libpurple 的东西）。

那么，有什么建议吗？

我不想写一个计算器（即使它看起来是一个相当适合 GUI 框架的起始项目）！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T06:58:20.730

很久以前，我和几个同事开始了[“追求完美项目”](http://perfectprojectquest.blogspot.com/2007/01/welcome.html) ——我们的想法是我们会尽我们所能，完全测试驱动等，同时学习 WPF、WCF 等。我们认为 Battleships 将是一款非常出色的游戏。您可以相对简单地开始，但是随着时间的推移有很多方法可以扩展它。

我们实际上在项目中没有取得任何进展，主要是因为我们最终都在不同的公司工作，我开始深入编写 C#，但我仍然认为 Battleships 是一款用于学习的好游戏。

从两个玩家、单屏、仅限本地的游戏开始，然后制定网络游戏、人工智能、超过两个玩家的变化、联赛、聊天等。

（当作为一个单一屏幕运行时，它作为一个真正的游戏非常不理想 - 每个玩家在开始设置船只时都必须将视线移开，如果任何玩家想要稍后看到自己的船只以获得知道其他玩家有多近，其他玩家将不得不将目光移开。不过，这对于确保您拥有一个正常工作的游戏引擎会*非常有用。）*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T19:29:25.217

到目前为止，我最喜欢的开源 WPF 应用程序是 Family.Show，这是一个简单的家谱应用程序，似乎很好地使用了 WPF。[CodePlex](http://www.codeplex.com/familyshow)上提供了源代码。

[![替代文字](https://i.stack.imgur.com/Mx18Z.jpg)](https://i.stack.imgur.com/Mx18Z.jpg)
[（来源：[vertigo.com](https://www.vertigo.com/images/detail/familyshowdetail-2.jpg)）]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-14T12:07:10.473

尝试看看[Coding4Fun](http://blogs.msdn.com/coding4fun/pages/1994662.aspx)。那里有一些 WPF 项目可能对您有用，包括一个版本的[数独](http://blogs.msdn.com/coding4fun/archive/2006/11/06/999502.aspx)。您可以使用这些文章播下一些种子并尝试自己开发应用程序，或者只是抓取代码并将其拆开看看它是如何工作的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-14T12:17:18.297

对于这类探险，我通常的出发点是编写一个简单的会计程序；通过日程安排和图表进出资金。

当我开始使用 WPF 时，它被证明是一个非常有用的练习，因为当您开始可视化数据时，它为您提供了一些非常高级的东西的范围（如果您想花哨的话！）并且还具有 LOB 优势这意味着您更有可能获得一些商业上可行的技能。我还在我的内部使用了独立存储，它非常有用。

任何人，这是我的建议。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T08:23:42.537

编写一个电子表格程序。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T06:46:27.983

做一个游戏。或者看看[Silverlight Showcase](http://silverlight.net/world/)并找到一些有趣的东西并制作它，但更好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T07:54:17.680

另一个有趣的游戏是 Tess Ferrandez（她是微软 ASP.NET 团队的升级工程师）在她的[博客](http://blogs.msdn.com/tess/archive/2009/03/04/silverlight-2-0-walkthrough-creating-a-traffic-jam-game.aspx)上写的，它是一款名为“Traffic Jam”的游戏，类似于 iPhone 上的“停车场”。它是用 Silverlight 编写的，但您可以轻松地将其设为 Windows WPF 应用程序。

# php - 我需要一些关于支付网关的指导

> ID：647412
> 
> 赞同：17
> 
> 时间：2009-03-15T06:56:22.717
> 
> 标签：php, html, ajax, api, payment-gateway

我从来没有对支付网关做过任何事情，有人可以给我建议吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-15T07:18:00.450

支付网关因国家/地区而异，它们是可以在您的应用程序中启用支付处理的机构。

例如。在英国 BT 有它的支付网关。他们称之为[BTBuynet](http://www.epayments.bt.com/)。在印度，ICICI 是主要的支付网关提供商之一。您也可以查看[贝宝](http://www.paypal.com/)。

他们每个人都有自己的实现方式。通常每个支付网关都有两种支付处理模式。

1.  **付款页面**：这是最常用的页面之一。站点通常将用户重定向到支付网关托管的支付页面。这种类型有一些优点和缺点。

好处

我们不必担心验证或存储卡的详细信息，因为一切都由他们的支付页面处理。

缺点

由于我们将用户重定向到不同的站点，因此站点的外观和感觉会有所不同。

2.  **支付服务**：这是通常使用组件或 API 的第二种类型。ard 详细信息由商家（应用程序所有者）收集并发送以进行付款处理。

希望这能让您对支付网关有所了解。您还可以查看 RHS 中的一些相关问题。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-15T07:14:43.110

好吧，决定您要使用的支付网关。如果您只是想在线了解这一点，我建议您使用 PayPal 的支付网关。他们确实没有给出好的价格（他们从你向用户收取的费用中占了很大一部分），但他们有一个很好的“沙盒”系统，你可以打开和关闭它，并且可以免费开发。这使您可以像一切都“活”一样运行您的系统：

*   资金将从您创建的假信用卡记入您的沙盒帐户
*   交易将像实时系统一样运行：您将获得真实的确认和通知。

[因此， PayPal 的开发者网站](https://developer.paypal.com/)是一个很好的起点。

哦，不要害怕使用其他网关——我用过的所有网关都可以在系统上线之前对其进行测试。但他们中的许多人不允许在“假”模拟模式上线后切换回它。因此，在获得生产系统后添加和测试新功能会比较棘手。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-16T18:44:49.743

我认为你在下面是对的吗？如果是这样，我目前正在 Oz 的一个 PHP 电子商务网站上工作。我们正在使用支付快递[http://www.paymentexpress.com/](http://www.paymentexpress.com/)。正如其他人指出的那样，它们提供了几种集成选项：

1.  iframe/re-direct - 这很容易集成。您只需向他们发布一堆东西，他们就会发回一堆东西来说明交易是否完成
2.  webservice - 使用一个 xml webservice，它有很好的文档记录并且很容易实现。我猜这个选项比 iframe 选项复杂一点，但它允许更多地控制事务期间发生的事情。但是您需要更加警惕如何处理人们的信用卡详细信息

客户实际上选择了支付快递，而不是直接选择我们，所以我的建议是基于对接口的实际编码。他们的规格和示例代码无需注册即可在其网站上免费获得。

希望你觉得这很有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T07:14:21.573

对于南非，我们使用 Moneybookers 或 Setcom，为了接受大多数付款，我建议使用 Paypal，因为它的广泛使用还有其他支付网关。

# c++ - 使用 && 和 || 有什么区别 在 do...while 循环中？

> ID：647413
> 
> 赞同：1
> 
> 时间：2009-03-15T06:57:56.253
> 
> 标签：c++, boolean-logic

```
#include<iostream>
using namespace std;

int main()
{

    char again;
    do
    {
        cout<<"you are in the while loop";
        cout<<"do you want to continue looping?";
        cin>>again;
    } while (again != 'n' || again != 'N');

    system("pause");
    return 0;
} 
```

我知道“while”中的测试条件有问题。但我无法弄清楚。

当用户的输入既不是'n'也不是'N'时，循环应该继续打印代码“你在while循环中”。一旦按下“n”或“N”，程序将终止。

但是对于我的代码，无论我输入什么字符，程序都会继续循环代码。但是当我改变'||' '&&'，程序可以根据需要运行。任何人都可以告诉我发生了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-15T07:10:29.187

这是一个常见的布尔逻辑问题。 `||`意思是“或”，意思是“只要这一边是真的，那么这个表达式就是真的”。因此，当您将大写字母传递`'N'`给`c != 'n' || c != 'N'` 程序时会说“嗯，`'N'`不等于`'n'`，因此表达式的一侧为真，因此整个表达式为真，无需检查表达式的其余部分。” 即使按下小写`'n'`，程序也会说“嗯，`'n'`等于`'n'`，但不等于`'N'`，因此表达式的一侧为真，因此整个表达式为真。” 这就是你的 while 循环中发生的事情。

另一方面，`&&`表示“和”，表示“表达式的双方都必须为真”；当您将大写字母传递`'N'`给`c != 'n' && c != 'N'`程序时认为“`'N'`不等于`'n'`，但等于`'N'`，因此表达式只有一侧为真，因此表达式为假。”

这会让人感到困惑，因为如果您正在测试输入的字符是否等于您将使用的特定值`||`（例如，“我想知道是否输入了`'a'` **或** `'b'` **或** `'c'`”）。

基本上，当您将`||`用于特定表达式并且想要与该表达式相反时，您需要更改为`&&`（例如，我不想要`'a'`，`'b'`或`'c'`; 或者换一种说法，该值不能是`'a'` **也**不能是`'b'`,**并且**不能是`'c'`")。同样，如果您要`&&`用于特定表达式，并且想要与该表达式相反的表达式，则需要使用`||`。这是德摩根定律之一，我建议您阅读一下您可以避免自己重新发现它们中的每一个。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-15T06:59:54.003

是的：|| 是“或”，&& 是“和”。

*每个*字符*要么是*“not 'n'”，要么是“not 'N'”，因为它不可能*同时是*'n' 和 'N'。

另一种（可能更容易阅读）编写条件的方法是：

```
!(again == 'n' || again == 'N') 
```

这意味着“（再次是'n'或'N'）的反面*”*。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-15T07:16:30.407

它是被称为“[德摩根定律](http://en.wikipedia.org/wiki/De_Morgan's_laws)”的布尔代数。

```
Not (P And Q) = (Not P) Or (Not Q)
Not (P Or Q) = (Not P) And (Not Q) 
```

在您的情况下，您希望用户不要输入`'n'`or `'N'`，可以将其转换为此逻辑。

```
!(again == 'n' || again == 'N') 
```

当应用德摩根定律时，它将是

```
(again != 'n' && again != 'N') 
```

有关更多信息，您可能需要阅读[命题逻辑](http://en.wikipedia.org/wiki/Propositional_logic)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-15T07:59:21.987

虽然原来的海报现在很高兴，但我在其他答案中没有看到这一点：

```
(true  && true ) == true
(true  && false) == false
(false && true ) == false
(false && false) == false

(true  || true ) == true
(true  || false) == true
(false || true ) == true
(false || false) == false

!true  == false
!false == true 
```

这就是一切！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-03T23:41:31.447

我很理解你的问题，下面是解释：

do-while 循环是一个退出条件循环。这意味着循环的主体总是首先执行。然后，评估测试条件。如果测试条件为 TRUE，则程序再次执行循环体。如果测试条件为 FALSE，则循环终止，程序继续执行 while 后面的语句。

在您的代码中，当您按下“n”或“N”时，您的测试条件将始终为一真一假，所以当您使用 || 您将满足测试条件 (true||false=true) ，因此程序将再次执行循环体。但是当你使用 && 时，这将给出 (true && false =false)，不再统计测试条件，因此程序不会再次执行循环体。

我希望这会有所帮助.....享受编程！阿梅拉迪

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T07:00:16.827

&& 是一个逻辑与。|| 是逻辑或。

（另外，& 是按位与，| 是按位或。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T07:01:09.693

你可能想试试 while(!(again == 'n' || again == 'N'))

# c# - 如何在 ADO.NET Entity Framework 上执行“select count(*)”

> ID：647425
> 
> 赞同：3
> 
> 时间：2009-03-15T07:11:17.737
> 
> 标签：c#, entity-framework, ado.net

如何使用 ADO.NET Entity Framework执行**“选择计数 (*)” ？**

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T07:17:40.340

使用[Count()](http://msdn.microsoft.com/en-us/library/system.linq.queryable.count.aspx) LINQ 运算符。如果您使用的是 C#，则查询表达式语法中没有任何内容可以涵盖这一点，因此您必须使用点符号来调用它。

# c# - 64 位 PC 上的 int.MaxValue 是什么？

> ID：647427
> 
> 赞同：34
> 
> 时间：2009-03-15T07:14:14.030
> 
> 标签：c#, .net, int, int64, int32

```
System.Console.WriteLine(int.MaxValue); 
```

这条线给了我答案，`2,147,483,647`因为我有一台 32 位 PC。

答案在 64 位 PC 上是否相同？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-15T07:19:46.013

**是的，答案在 64 位机器上是一样的。**

在 .NET 中，an`int`是[有符号的 32 位整数](http://msdn.microsoft.com/en-us/library/5kzh1b5w.aspx)，与处理器无关。它的 .NET 框架类型是`System.Int32`.

[C# 语言规范](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)指出：

> 该`int`类型表示带符号的 32 位整数，其值介于 `–2,147,483,648`和之间`2,147,483,647`。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-15T07:20:34.967

是的。

> int.MaxValue: 2,147,483,647

来源：[https ://www.dotnetperls.com/int-maxvalue](https://www.dotnetperls.com/int-maxvalue)

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-03-15T07:21:10.503

`int`只是一个别名`Int32`- 它在 C# 规范中定义。因此`int.MaxValue`与`Int32.MaxValue`始终为 2147483647 相同。

# ajax - 使用 Prototype 和 Ajax 进行更新

> ID：647431
> 
> 赞同：0
> 
> 时间：2009-03-15T07:17:24.413
> 
> 标签：ajax, prototypejs

我正在使用[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)和[Prototype](http://en.wikipedia.org/wiki/Prototype_JavaScript_Framework)。在我的代码中，我需要更新`div`.

### 我的`div`：

```
<div id="update">
    1\. Content_1
</div> 
```

### 我的代码：

```
Element.update($("update"),"2.Content_2"); 
```

### 预期输出：

```
<div id="update">
    1.Content_1
    2.Content_2
</div> 
```

我怎样才能在 Ajax 和 Prototype 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T07:42:59.577

AJAX 通常意味着您正在服务器上执行脚本来获取此结果。

但是，在您的示例中，您似乎只想附加一些文本。

要附加文本，您可以简单地将文本添加到 innerHTML 的末尾：

```
$("update").innerHTML = $("update").innerHTML + "2.Content_2"; 
```

如果您想执行服务器脚本，我会这样做：（我有一段时间没有使用 Prototype，事情可能已经改变）

```
function getResult()
{
    var url = 'theServerScriptURL.php';
    var pars = '';
    var myAjax = new Ajax.Request(
        url, 
        {
            method: 'post', 
            parameters: {}, 
            onComplete: showResult
        });
}

function showResult(originalRequest)
{
    $("update").innerHTML = originalRequest.responseText;
} 
```

此代码将调用“theServerScriptURL.php”并在 id 为“update”的 div 中显示结果。

# php - 在脚本执行期间显示启动画面

> ID：647440
> 
> 赞同：2
> 
> 时间：2009-03-15T07:24:47.530
> 
> 标签：php, javascript, jsp, splash-screen

我想知道在脚本执行期间如何在用户屏幕上显示启动画面（如 gif 或 jpeg 文件）。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T08:51:56.980

诀窍是在启动启动显示后让渲染重新绘制，然后再继续长时间运行的 JS。为此，您可以使用 setTimeout 方法。

例如，假设您的初始显示位于显示样式为 none 的 div 中，您可以使用此函数来运行您的代码：-

```
function splash(splashDivId, fn)
{
    var splashDiv = document.getElementById(splashDivId)
    splashDiv.style.display = "block";
    setTimeout(function() {
       fn()
       splashDiv.style.display = "none";
    }, 100);

} 
```

用法：-

```
splash("mySplashDiv", longRunner)

function longRunner()
{
    //This may take a while
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T09:23:32.567

我使用 jQuery [blockUI](http://www.malsup.com/jquery/block/)插件来完成你所描述的。只需看一下示例，它是高度可定制的，占用空间很小，并且可以通过简单的小调用来执行奇迹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T07:45:08.123

我不知道现有的脚本，但我可以告诉你如何实现启动画面。

我将建议使用[JQuery](http://jquery.com/)，因为这是我选择的 JS 库，但其他的也很好。

首先，在您的 JS 方法中，您需要显示弹出窗口。您可以使用 JQuery[对话框小部件](http://jqueryui.com/demos/dialog/)来完成此操作。以同样的方法，进行 ajax 调用。Ajax 本质上是异步的，因此为调用完成和调用出错时设置一个方法。在这两种方法中，您应该做的第一件事是隐藏模式弹出窗口。

现在，还有最后一个技巧 - 您希望在意外情况下优雅地失败，例如失去连接。因此，当您显示对话时，您还需要设置[javascript 超时](http://www.htmlite.com/JS018.php)来处理任何错误情况，以便对话不会永久显示。该方法应该只检查对话是否可见，如果是，则隐藏它（并可能显示错误消息）。

我希望这些信息足以让你继续前进。即使您是 JavaScript 新手，这也是一个值得学习的好项目，因为它应该不会太难。

# python - Matplotlib 中具有独立缩放的多个重叠图

> ID：647443
> 
> 赞同：9
> 
> 时间：2009-03-15T07:28:34.107
> 
> 标签：python, matplotlib

我目前有多次调用`matplotlib.pylab.plot`以在同一屏幕上显示多组数据的代码，考虑到所有绘图，Matplotlib 将每个数据缩放到全局最小值和最大值。有没有办法让它独立地缩放每个情节，到那个特定情节的最小值和最大值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T12:14:35.697

对此没有直接支持，但这里有一些来自[邮件列表发布](http://article.gmane.org/gmane.comp.python.matplotlib.general/1987)的代码，它说明了两个独立的垂直轴：

```
x=arange(10)
y1=sin(x)
y2=10*cos(x)

rect=[0.1,0.1,0.8,0.8]
a1=axes(rect)
a1.yaxis.tick_left()
plot(x,y1)
ylabel('axis 1')
xlabel('x')

a2=axes(rect,frameon=False)
a2.yaxis.tick_right()
plot(x,y2)
a2.yaxis.set_label_position('right')
ylabel('axis 2')
a2.set_xticks([]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-20T14:46:26.943

这就是您如何创建单个图 (add_subplot(1,1,1)) 并限制 y 轴上的比例。

```
myFig = figure()
myPlot = self.figure.add_subplot(1,1,1)
myPlot.plot([1,2,3,4,5], [5,4,3,2,1], '+r')
myPlot.set_ylim(1,5) # Limit y-axes min 1, max 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-10T15:11:38.047

我需要这样的东西，但想创建一个示例，您可以将其复制并粘贴到交互式 shell 中并查看它。这是为那些需要有效解决方案的人准备的：

```
from numpy import arange
from math import sin, cos
import matplotlib.pyplot as plt

x = arange(10)
y1 = [sin(i) for i in x]
y2 = [10*cos(i) for i in x]

rect = [0.1, 0.1, 0.8, 0.8]
a1 = plt.axes(rect)  # Create subplot, rect = [left, bottom, width, height] in normalized (0, 1) units
a1.yaxis.tick_left()  # Use ticks only on left side of plot
plt.plot(x, y1)
plt.ylabel('axis 1')
plt.xlabel('x')

a2 = plt.axes(rect, frameon=False)  # frameon, if False, suppress drawing the figure frame
a2.yaxis.tick_right()
plt.plot(x, y2)
a2.yaxis.set_label_position('right')
plt.ylabel('axis 2')
a2.set_xticks([])

plt.show() 
```

在 python 2.7.6、numpy 1.8.1、matpotlib 1.3.1 中测试并工作。我将继续使用它，寻找一种巧妙的方式来处理重叠日期图。我会发回我的发现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-11T15:59:00.250

这是一个使用日期图的解决方案，我认为它是使用 twinx() 的最优化解决方案，它是添加第二个 y 轴的简写。

```
import matplotlib.pyplot as plt
import matplotlib.dates as md
import datetime
import numpy
numpy.random.seed(0)
t = md.drange(datetime.datetime(2012, 11, 1),
            datetime.datetime(2014, 4, 01),
            datetime.timedelta(hours=1))  # takes start, end, delta
x1 = numpy.cumsum(numpy.random.random(len(t)) - 0.5) * 40000
x2 = numpy.cumsum(numpy.random.random(len(t)) - 0.5) * 0.002
fig = plt.figure()
ax1 = fig.add_subplot(111)
fig.suptitle('a title', fontsize=14)
fig.autofmt_xdate()
plt.ylabel('axis 1')
plt.xlabel('dates')
ax2 = ax1.twinx()
ax1.plot_date(t, x1, 'b-', alpha=.65)
ax2.plot_date(t, x2, 'r-', alpha=.65)
plt.ylabel('axis 2')
plt.show() 
```

从文档中， matplotlib.pyplot.twinx(ax=None) 创建共享 x 轴的第二个轴。新轴将覆盖 ax（如果 ax 为 None，则覆盖当前轴）。ax2 的刻度将放置在右侧，并返回 ax2 实例。更多[在这里](http://matplotlib.org/api/pyplot_api.html)。

# ruby-on-rails - 如何使用 in_place_editing 而不是 fields_for？

> ID：647452
> 
> 赞同：1
> 
> 时间：2009-03-15T07:46:12.613
> 
> 标签：ruby-on-rails, in-place-edit

我设置了一个 User 模型，`restful_authentication`然后拥有一个属于它的 Profile 模型。我一直在使用`fields_for`将用于编辑用户的字段和该用户的个人资料组合到用户编辑视图中。

我希望能够设置一些字段以`in_place_editing`在用户显示视图上使用插件。按照给出的示例，它在用户表字段上工作正常

*users_controller.rb*

```
in_place_edit_for :user, :email 
```

*/views/users/show.html.erb*

```
<%= in_place_editor_field :user, :email %> 
```

但我无法弄清楚如何为`in_place_editor_field`我在编辑视图上访问的任何字段正确编写控制器或视图上的位：

```
<% fields_for @up do |profile_fields| %>
<%= profile_fields.text_field :status %>
<% end %> 
```

*在 users_controller 中（为了清楚起见）：*

```
def edit
  @user = User.find(params[:id])
  @up = @user.profile
end 
```

如何`:user.profile, :status`为 users_controller 和 /views/users/show.html.erb 之类的东西创建符号？

感谢所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T05:17:20.763

我使用 in_place_editor 辅助标签。将您要编辑的内容包装在一个 span/div 中，给它一个唯一的 id 并在 in_place_editor 标记中引用它。

```
# in the view 
<span id="user_email"><%= user.email -%></span>

<%= in_place_editor "user_email", :url => {:controller => :users, :action => 'set_user_email', :id => user} %>

# in the controller
User.content_columns.each do |column| 
  in_place_edit_for :user, column.name
end 
```

神奇的是 :set_user_email - 它是控制器中自动生成的方法，当您在模型及其属性的控制器中使用 in_place_edit_for 时创建。

我提供了一种允许对模型的所有字段进行编辑的方法，但您可能希望将其限制为一些模型属性。

根据您设置控制器的方式，您可能需要设置protect_from_forgery 以排除设置操作。请注意 - 这将从就地编辑字段中删除 post 方法的 csrf 验证。

**编辑**
**[此问题](https://stackoverflow.com/questions/174598/rails-inplaceedit-how-do-i-pass-an-authenticity-token)**处理如何包含真实性令牌。

# asp.net - 如何永久关闭视图状态？

> ID：647453
> 
> 赞同：15
> 
> 时间：2009-03-15T07:48:13.777
> 
> 标签：asp.net, url, viewstate, clean-urls

来自 PHP 背景，我喜欢使用干净的 URL 将数据从一个服务抓取到另一个服务。

但是，在我的一些 ASP.NET 项目中，我的 URL 中出现了可怕的 ViewState 参数。

有没有办法在全球范围内关闭它？

这会对我的 ASP.NET 应用程序产生什么影响？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-15T07:52:29.290

您可以像这样关闭整个站点的视图状态：

```
 <system.web>
<pages enableViewState="false" /> 
```

也就是说，你不应该在 url 上得到它。ViewState 是一个隐藏字段，它通过回发（通常使用 post）发送到服务器。当页面呈现给客户端时，它会保持控件的状态，并在每次回发时发送它。如果它适用于应用程序，您可以改用 post 代替（问题形式肯定使用 get），如果不是，请查看 Jon 的答案。

查看此链接以获取有关视图状态如何融入 asp.net 生命周期的更多信息：http: [//msdn.microsoft.com/en-us/library/ms972976.aspx](http://msdn.microsoft.com/en-us/library/ms972976.aspx)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-15T07:52:33.860

在编写[Reputation Tracker](http://csharpindepth.com/StackOverflow/ReputationTracker.aspx)时，我遇到了[类似的问题](https://stackoverflow.com/questions/431296/how-can-i-take-more-control-in-asp-net)。

我不知道你是如何在全球范围内做到这一点的，除了永远不要使用带有`runat="server"`集合的表单，这更多的是与纪律而不是设置有关。特别是，如果您`runat="server"`在表单上进行了设置，我相信您将始终获得 viewstate 参数，即使您已在任何地方将其关闭，因此您不会获得任何*值*。无论如何，这是我的经验。

显然这在一定程度上限制了您，但我发现对 ASP.NET 的适当部分使用 HTML 服务器控件（而不是 ASP.NET 控件）可以使生活更易于理解。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-23T21:11:38.510

`<page>`默认情况下，使用web.config 中的元素关闭 ViewState 。`EnableViewState="true"`在 web.config 中禁用 ViewState 后，在指令中使用`@Page`将不再起作用。`<location>`如果您稍后决定需要特定页面的 ViewState，则可以使用元素为该页面重新打开它。

```
<configuration>
  <system.web>
    <pages enableViewState="false" />
  </system.web>

  <location path="MyFolder/MyPage.aspx">
    <system.web>
      <pages enableViewState="true" />
    </system.web>
  </location>
  <location path="Site.master">
    <system.web>
      <pages enableViewState="true" />
    </system.web>
  </location>
</configuration> 
```

您需要对启用 ViewState 的页面使用的任何母版页执行相同的操作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-15T07:51:28.823

将此添加到 web.config 文件中：

```
<Pages enableViewState="false"/> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-15T08:03:28.233

您可以切换到 ASP.Net MVC。据我了解，它不使用 ViewState。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-15T10:40:12.820

但是请记住，如果没有 ViewState，大多数 ASP.NET Web 表单开发人员所期望的某些行为将无法工作。ViewState 的目的是提供一种错觉，即各种页面和控件属性从一个请求持续到下一个请求。ViewState 不包含所有控件属性，仅包含已更改的属性。这个想法是 ViewState 保留这些属性，就像它们在上次呈现表单时一样。

一个很好的例子是`SelectedIndexChanged`下拉事件（没有设置自动回发）。这是因为 ViewState 保留了以前的索引，而表单发布了当前索引，并且控件比较两者以知道所选索引已更改。那是它引发`SelectedIndexChanged`事件的时候。如果没有 ViewState，该事件将不会触发。事件`TextChanged`等也是如此。

如果没有 GET 情况（我从未遇到过），ViewState 的最大问题是在不需要的地方使用它。您的网格控件不需要在其所有行中保留所有控件的先前值，因此不要在其上启用 ViewState。

# c# - 组织相关项目的最佳方式？

> ID：647462
> 
> 赞同：5
> 
> 时间：2009-03-15T07:55:22.247
> 
> 标签：c#, dependencies, projects-and-solutions

我有一组依赖于其他项目的项目（你可以说实用程序），问题是每次我更改这些实用程序中的任何一个的代码时，我的同事都需要获取最新的代码并在他们的机器上构建以使用最新的组件。有没有好的标准解决方案？或者只是将 dll 集中在共享文件夹上？

PS：

我们正在使用 MS source safe 2005，我不希望我的同事每次都获取源代码并在他们的机器上构建，因为他们只需要二进制文件而不是代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T08:13:26.917

如果您使用 Subversion 作为源代码控制系统，您可以使用[SVN Externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)来执行此操作。这样，当他们对那里的文件夹进行根更新时，他们将自动提取实用程序的新版本。您还可以以只读方式为他们提供源代码控制，以便他们可以查看实用程序代码，但他们无权提交更改。

我们在工作中使用它，它工作得很好。但请注意，有时您不想在每次更新时都更新实用程序，因为使用新版本可能会破坏某些东西。这是您的公司必须有办法处理的事情。我们为实用程序的市长版本提供了 SVN 分支（或标签），因此如果我们更改市长版本，我们将创建一个新版本，然后人们将不得不手动更改他们的 SVN 外部以指向新版本（如果他们愿意）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T08:02:35.133

当您更改它们时，他们真的需要立即使用这些实用程序吗？这通常不是真的。

通常最好让同事在他们合并自己的更改时在下一个方便的时间点“提取”最新的代码。

您使用的是源代码控制系统，对吗？

如果您让每个人都使用共享服务器上的副本，则在使用二进制文件时更新二进制文件可能会遇到问题，或者您可能会导致某些用法产生不一致的结果。

如果它们确实需要在特定时刻进行更新（例如，实用程序通过使用您正在发展的架构联系某个中央数据库来工作，因此您需要在更新数据库架构的同时更新每个人的二进制文件）然后我'd 建议将实用程序转变为 Web 服务。有很多非常简单的方法可以做到这一点。然后，如果它们是交互式的，则同事可以通过网页访问它们，或者`wget`如果它们是命令行自动化的，则可以通过类似的方式访问它们。您可以[在此处获取适用于 Windows 的 wget](http://gnuwin32.sourceforge.net/packages/wget.htm)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T09:18:39.613

当我们在许多团队之间共享程序集时，我们会将它们提升到 bin 目录，这样其他开发人员可以引用/使用最新的程序集，而无需从源代码重新构建。

# c# - 如何在 SIlverlight 中实现对 WCF 服务的同步调用？

> ID：647481
> 
> 赞同：2
> 
> 时间：2009-03-15T08:30:53.660
> 
> 标签：c#, silverlight, wcf, synchronous

有时我需要在 Silverlight 中调用 WCF 服务并阻止 UI 直到它返回。当然，我可以分三步完成：

1.  设置处理程序和阻止 UI
2.  呼叫服务
3.  完成所有操作后取消阻止 UI。

但是，我想将 DoSomethingSync 方法添加到服务客户端类，并在需要时调用它。

是否可以？有没有人真正实现过这样的方法？

**更新：** 看起来答案是根本不使用同步调用。将为异步调用寻找一些易于使用的模式。查看[这篇](http://petesbloggerama.blogspot.com/2008/07/omg-silverlight-asynchronous-is-evil.html)文章（取自评论）了解更多信息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T08:47:34.743

这就是重点；您**不应该**在 Silverlight 中同步 IO。别打了！反而：

*   禁用 UI 的任何关键部分
*   使用回调启动异步 IO
*   (...)
*   在回调中，处理数据并更新/重新启用 UI

碰巧的是，我正在积极研究使异步模式更容易接近的方法（特别是考虑到 Silverlight）。[这](http://marcgravell.blogspot.com/2009/02/async-without-pain.html)是第一次刺伤，但我有更好的东西；-p

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T09:21:30.700

我不同意 Marc 的观点，在某些情况下您需要进行同步 Web 服务调用。但是，您可能应该避免的是阻塞 UI 线程，因为这会造成非常糟糕的用户体验。

同步实现服务调用的一种非常简单的方法是使用 ManualResetEvent。

```
ManualResetEvent m_svcMRE = new ManualResetEvent(false);
MyServiceClient m_svcProxy = new MyServiceClient(binding, address);
m_svcProxy.DoSomethingCompleted += (sender, args) => {  m_svcMRE.Set(); };

public void DoSomething()
{
    m_svcMRE.Reset();
    m_svcProxy.DoSomething();
    m_svcMRE.WaitOne();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-18T15:11:33.303

这是一个让您在 SL 中同步调用 WCF 服务的类：http: [//johnleitch.blogspot.com/2010/03/easy-way-to-synchronously-call-wcf.html](http://johnleitch.blogspot.com/2010/03/easy-way-to-synchronously-call-wcf.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-02-03T08:44:49.173

Using SL4 building business application itself a wrong approach. I am facing problem with async call in SL4 client. Not only this issue. Once you go for a 15mins beeak after login SL application, after break you SL app can not retain all data at all. Its happen sometimes very frequently.

# asp.net-membership - 无法加载我的自定义会员提供程序？

> ID：647483
> 
> 赞同：1
> 
> 时间：2009-03-15T08:31:18.637
> 
> 标签：asp.net-membership, web-config

我试图实现一个自定义会员提供程序，一切顺利，我可以连接，我可以更改用户详细信息，但是一旦我创建用户，我在完成创建用户后尝试获取用户时出现此错误。

错误来自我的web.config，它说它是一个ConfigurationErrorsException，它还说问题出在我的配置文件下的类型上，我确定我提供的提供程序类型是正确的，例如

```
type="MyNamespace.MyCustomMembershipProvider" 
```

请帮我

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T09:00:34.477

当您输入类型时，您需要指定它来自的程序集。

所以`MyNamespace.MyCustomMembershipProvider`在`MyNamespace.dll`, 需要这个配置：

```
type="MyNamespace.MyCustomMembershipProvider, MyNamespace" 
```

此外，如果它抱怨默认提供程序，请将您的默认提供程序命名为`SqlAspNetMembershipProvider`（在 XML 中，而不是类名）或`membership`在 web.config 中的“”元素上设置默认提供程序名称。

这是我的样子：

```
<membership defaultProvider="SqlMembershipProvider">
    <providers>
        <clear/>
        <add name="SqlMembershipProvider" 
             type="Barnwell.Web.Security.SqlMembershipProvider, Barnwell.Web.Security" 
        ... /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T10:25:47.940

在没有看到实现的情况下，您很可能在自定义成员资格提供程序的 CreateUser 方法中遇到问题。点击链接了解更多信息；

[http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.createuser.aspx](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.createuser.aspx)

# asp.net - 如何在 IIS7 中为 ASP.NET 创建虚拟目录？

> ID：647484
> 
> 赞同：4
> 
> 时间：2009-03-15T08:43:20.043
> 
> 标签：asp.net, iis, iis-7, asp.net-2.0

我有一个 ASP.NET 网站，我的机器在 Windows Vista 家庭高级版上运行 IIS7。我希望它对 LAN 上的其他计算机可见。

我需要创建一个虚拟目录吗？如何在我的机器上创建一个虚拟目录？我如何部署它以供其他人查看我的 Web 应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T08:51:02.690

这里：http: [//msdn.microsoft.com/en-us/library/ms178477.aspx#](http://msdn.microsoft.com/en-us/library/ms178477.aspx#)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T09:34:17.080

如果您想在 Windows Vista 这样的工作站上运行网站，您可以做的最简单的事情就是在 Inetpub\wwwroot 目录的子文件夹中复制（或创建）您的应用程序文件。

如果您的应用程序文件不在 wwwroot 的子文件夹中，您可以创建一个指向您的项目文件夹的虚拟目录。确保此虚拟目录具有执行权限并创建为应用程序。这是一个关于如何创建 IIS 应用程序和虚拟目录[的好教程。](http://mvolo.com/blogs/serverside/archive/2007/07/12/Creating-IIS7-sites_2C00_-applications_2C00_-and-virtual-directories.aspx)

然后您应该能够使用您的计算机名称从其他计算机访问该站点，如下所示：

```
http://YourComputersName/YourAppName/ 
```

您应该检查 Vista 的防火墙设置。允许端口 80 用于传入请求。还要检查您的工作站名称是否为其他 PC 所知（尝试 nslookup 或 ping）。如果其他计算机不知道该名称，您应该能够使用您计算机的 IP 地址查看该站点（示例）：

```
http://192.168.99.99/YourAppName/ 
```

考虑到 Windows 工作站被限制为 10 个传入连接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T09:37:56.807

1.  确保在 IIS 中添加主机头。您希望您的 IP 和您的计算机名称添加并分配端口 80。
2.  确保您的防火墙允许通过端口 80。
3.  您的朋友现在可以使用 IP 或计算机名称浏览您的网站。

# jsp - 单线程模型

> ID：647499
> 
> 赞同：3
> 
> 时间：2009-03-15T08:55:32.697
> 
> 标签：jsp, servlets

如果 servlet 实现单线程模型干扰，servlet 容器如何确保 servlet 一次只处理一个请求？即使是单线程模型接口也没有方法。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T08:59:04.247

servlet 容器创建一个 servlet 实例池，并跟踪当前“正在使用”的实例。如果当有新请求进入时所有实例都“正在使用”，则容器可以等待现有实例空闲，或者创建一个新实例来处理请求。

但是单线程模型并没有被广泛使用——最好使 servlet 本身无状态，并允许同时处理多个请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-02T04:52:30.087

这个想法不是依靠 SingleThreadModel 来处理线程问题。由于不强制 servlet 容器绑定到单线程模型契约，因此建议不要依赖容器来实例化多个 servlet 实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T09:03:37.763

它依赖于实现。它可以创建 servlet 实例池，或者它可以只拥有一个 servlet 实例并同步对它的访问。后者导致更多的争论。

[http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/SingleThreadModel.html](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/SingleThreadModel.html)

# python - 如何在不下载附件的情况下转发完整的电子邮件？

> ID：647500
> 
> 赞同：0
> 
> 时间：2009-03-15T08:55:54.007
> 
> 标签：python, smtp, gmail, imap, forward

你好（提前感谢！）

我正在使用 Python，我让 IMAP 和 SMTP 与我的 Gmail 帐户一起使用。我现在需要将选择的消息转发到另一个帐户（在阅读了他们的正文之后）。

如何在不下载附件并重新创建整个邮件的情况下执行此操作？

谢谢！

塔尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T09:00:27.100

查看 IMAP 和 SMTP Lemonade 扩展。支持在不下载的情况下转发消息。这是一个非常新的扩展，所以还没有多少 IMAP 服务器支持它；我不确定 Gmail 是否是其中之一。

[RFC 4550](ftp://ftp.rfc-editor.org/in-notes/rfc4550.txt)的第 2 节包含有关其工作原理的技术细节。

# c# - 下载期间在 Windows Media Player 上播放大文件

> ID：647501
> 
> 赞同：2
> 
> 时间：2009-03-15T08:56:30.073
> 
> 标签：c#, fileshare, media-player

我的问题是关于将视频文件写入从网络下载的硬盘驱动器并同时使用 Windows Media Player 播放它。该文件很大，需要一段时间才能下载。有必要下载它而不是直接将其流式传输到 Windows Media Player。

发生的情况是，虽然我可以从我自己的测试代码中写入视频文件并同时读取它，但使用 Windows Media Player 无法完成（至少我还没有弄清楚）。我知道这是可能的，因为 Amazon Unbox 下载做到了。Unbox 可让您在下载 WMV 时播放它们。Unbox 是用 .NET 编写的，所以......

我已经阅读了“ [C# 文件读/写文件共享似乎不起作用](https://stackoverflow.com/questions/124946/c-file-read-write-fileshare-doesnt-appear-to-work)”的问题和答案，用于打开带有 FileShare 标志的文件。但这对我不起作用。进程监视器说媒体播放器正在打开带有文件共享标志的文件，但它出错了。

在缓冲线程中，我有这段代码用于从网络读取文件并将其写入文件（没有错误处理或其他使其更具可读性的东西）：

```
// the download thread
void StartStreaming(Stream webStream, int bufferFullByteCount)
{
    int bytesRead;
    var buffer = new byte[4096];
    var fileStream = new FileStream(MediaFile.FullName, FileMode.Create, FileAccess.Write, FileShare.ReadWrite);
    var writer = new BinaryWriter(fileStream);
    var totalBytesRead = 0;
    do
    {
        bytesRead = webStream.Read(buffer, 0, 4096);
        if (bytesRead != 0)
        {
            writer.Write(buffer, 0, (int)bytesRead);
            writer.Flush();
            totalBytesRead += bytesRead;
        }
        if (totalBytesRead >= bufferFullByteCount)
        {
            // fire an event to a different thread to tell 
            // Windows Media Player to start playing
            OnBufferingComplete(this, new BufferingCompleteEventArgs(this, MediaFile));
        }
    } while (bytesRead != 0);
} 
```

这似乎工作正常。该文件写入磁盘并具有正确的权限。

但是接下来是另一个线程中的事件处理程序，用于播放视频

```
 // the playback thread

private void OnBufferingComplete(object sender, BufferingCompleteEventArgs e)
{
    axWindowsMediaPlayer1.URL = e.MediaFile.FullName;
} 
```

Windows Media Player 指示它正在打开文件，然后停止并显示无法打开文件“已在另一个进程中打开”的错误。

我已经尝试了我能想到的一切。我错过了什么？如果亚马逊的人可以做到这一点，那么我也可以，对吗？

编辑：此代码适用于 mplayer、VLC 和 Media Player Classic；只是不是 Windows Media Player 或 Windows Media Center 播放器。IOW，我唯一需要他们合作的球员。啊！

edit2：我什至使用 MiniHttp 将视频流式传输到 Windows Media Player，看看这是否会“欺骗”WMP 播放正在下载的视频。无所事事。虽然 WMP 确实打开了文件，但它一直等到 mpeg 文件被完全复制后才开始播放。它是怎么知道的？

编辑3：经过一番挖掘，我发现了问题。我正在处理 MPEG2 文件。问题不一定与 Windows Media Player 相关，而是与 Microsoft MPEG2 DirectShow Splitter 相关，WMP 使用它来打开我试图同时播放和下载的 MPEG2 文件。拆分器以非共享模式打开文件。WMV 文件并非如此。WMP 以共享模式打开它们，一切都按预期工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T13:36:04.910

我决定回答我自己的问题，以防其他人遇到这种罕见的情况。

简短的回答是：Windows Media Player（在撰写本文时）将允许同时下载和播放文件，只要该功能受渲染文件所涉及的 CODECS 支持。

引用对问题的最后编辑：

经过一番挖掘，我发现了问题。我正在处理 MPEG2 文件。问题不一定与 Windows Media Player 相关，而是与 Microsoft MPEG2 DirectShow Splitter 相关，WMP 使用它来打开我试图同时播放和下载的 MPEG2 文件。拆分器以非共享模式打开文件。WMV 文件并非如此。WMP 以共享模式打开它们，一切都按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T09:03:31.523

在@darin 发表评论后于 3 月 16 日更新：

您正在指定`FileShare.ReadWrite`何时写入文件，理论上这也允许另一个进程打开它进行写入。

尝试将您的代码更改为仅请求`FileShare.Read`：

```
var fileStream 
    = new FileStream(
        MediaFile.FullName, 
        FileMode.Create, 
        FileAccess.Write, 
        FileShare.Read); // Instead of ReadWrite 
```

引用[MSDN](http://msdn.microsoft.com/en-us/library/system.io.fileshare.aspx)：

> FileShare.Read：允许随后打开文件进行读取。
> 
> FileShare.ReadWrite：允许随后打开文件以进行读取或写入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T09:59:25.040

当您打开文件进行写入时，您不应使用 FileShare.ReadWrite。您应该改用 FileShare.Read：

```
var fileStream = new FileStream(
    MediaFile.FullName, FileMode.Create, FileAccess.Write, FileShare.Read); 
```

当 mplayer.exe 进程打开文件进行读取时，它将首先尝试使用 FileShare.Read 打开它，这将失败，但它会重新尝试使用 FileShare.ReadWrite 打开它，这将成功。

# php - 用 PHP 实现 2 路加密的最佳方法是什么？

> ID：647514
> 
> 赞同：7
> 
> 时间：2009-03-15T09:08:08.110
> 
> 标签：php, security, encryption, passwords

我想使用 PHP 中的 2 路加密来加密我网站上的密码。我遇到过 mcrypt 库，但它看起来很麻烦。任何人都知道任何其他更简单但又安全的方法？我确实可以访问 Zend 框架，因此使用它的解决方案也可以。

我实际上需要双向加密，因为我的客户想要进入数据库并更改密码或检索它。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-15T11:22:50.907

您应该存储散列（并**[正确加盐](https://stackoverflow.com/questions/1645161/salt-generation-and-open-source-software/1645190#1645190)**）的密码。

**世界上没有任何借口足以打破这条规则。**

目前，使用[crypt](http://www.php.net/crypt)和 CRYPT_BLOWFISH 是最佳实践。
PHP 中的 CRYPT_BLOWFISH 是 Bcrypt 哈希的实现。Bcrypt 基于 Blowfish 分组密码。

*   如果您的客户端尝试登录，您将输入的密码散列并将其与存储在数据库中的散列进行比较。如果它们匹配，则授予访问权限。

*   如果您的客户想要更改密码，他们将需要通过一些小脚本来完成，该脚本正确地散列新密码并将其存储到数据库中。

*   如果您的客户想要恢复密码，则应生成一个新的随机密码并将其发送给您的客户。新密码的哈希值存储在数据库中

*   如果您的客户想要查找当前密码，*那么他们就不走运了*。这正是散列密码的重点：系统不知道密码，因此它永远不会被“查找”/窃取。

[Jeff](https://stackoverflow.com/users/1/jeff-atwood)写了一篇博客：[你可能错误地存储了密码](http://www.codinghorror.com/blog/archives/000953.html)

如果您想使用标准库，可以查看：[Portable PHP password hashing framework](http://www.openwall.com/phpass/)并确保使用 CRYPT_BLOWFISH 算法。

（一般来说，直接处理数据库中的记录是自找麻烦。
很多人——包括非常有经验的数据库管理员——都发现了这一点。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-15T09:12:12.500

不要加密密码。你永远不需要解密它们，你只需要验证它们。使用 mcrypt 并不比什么都不做好多少，因为如果黑客闯入您的网站并窃取了加密密码，他们可能还能够窃取用于加密它们的密钥。

为您的 php 应用程序创建一个“密码”函数，在其中获取用户密码，将其与盐连接，并通过 sha-256 散列函数运行生成的字符串并返回结果。每当您需要验证密码时，您只需验证密码的哈希值是否与数据库中的哈希值匹配。

[http://phpsec.org/articles/2005/password-hashing.html](http://phpsec.org/articles/2005/password-hashing.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T09:37:16.247

当您以后确实需要检索密码时，您至少应该使用私钥和公钥，这样攻击者就需要私钥（不应存储在同一台机器上）来解密密码。

实现这一目标的两个功能是[`openssl_public_encrypt()`](http://de3.php.net/manual/en/function.openssl-public-encrypt.php)和[`openssl_private_decrypt()`](http://de3.php.net/manual/en/function.openssl-private-decrypt.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T22:50:05.497

要么以明文形式存储它，要么存储密码的散列（即不可逆）。

做任何其他事情——尤其是使用带有硬编码密钥的对称加密——基本上是没有意义的。

如果您按照您的建议进行操作并且您的机器遭到入侵，则攻击者不仅可以访问加密密码，还可以访问代码和解密它们的密钥，因此它们也可能以明文形式存储。

如果您想保护您的数据免受他人对机器的物理访问，请使用加密文件系统（但仍将密码明文存储在其中的数据库中）。当然，每次重新启动，您都需要在系统可用之前手动输入密钥。

# python - 如何在 Windows 上找到 Python 的安装位置？

> ID：647515
> 
> 赞同：306
> 
> 时间：2009-03-15T09:09:18.980
> 
> 标签：python, windows, path

我想找出我在 Windows 上的 Python 安装路径。例如：

```
C:\Python25 
```

如何找到 Python 的安装位置？

* * *

## 回答 #1

> 赞同：582
> 
> 时间：2009-03-15T13:17:29.773

在 Python 解释器中，键入以下命令：

```
>>> import os
>>> import sys
>>> os.path.dirname(sys.executable)
'C:\\Python25' 
```

此外，您可以使用所有这些并使用单行命令。打开cmd并输入以下命令

```
python -c "import os, sys; print(os.path.dirname(sys.executable))" 
```

* * *

## 回答 #2

> 赞同：165
> 
> 时间：2017-04-17T16:04:01.540

If you have Python in your environment variable then you can use the following command in cmd or powershell:

```
 where.exe python
```

or for Unix enviroment

```
 which python
```

command line image :

[![enter image description here](https://i.stack.imgur.com/sL31x.png)](https://i.stack.imgur.com/sL31x.png)

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2017-08-18T09:52:20.947

It would be either of

*   C:\Python36
*   C:\Users\(Your logged in User)\AppData\Local\Programs\Python\Python36

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2009-03-15T21:08:54.803

If you need to know the installed path under Windows **without** starting the python interpreter, have a look in the Windows registry.

Each installed Python version will have a registry key in either:

*   `HKLM\SOFTWARE\Python\PythonCore\versionnumber\InstallPath`
*   `HKCU\SOFTWARE\Python\PythonCore\versionnumber\InstallPath`

In 64-bit Windows, it will be under the `Wow6432Node` key:

*   `HKLM\SOFTWARE\Wow6432Node\Python\PythonCore\versionnumber\InstallPath`

* * *

## 回答 #5

> 赞同：25
> 
> 时间：2020-01-30T14:13:55.303

Simple way is

1.  open CMD
2.  type `where python` in cmd

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-03-15T10:18:52.357

在我的 Windows 安装中，我得到以下结果：

```
>>> import sys
>>> sys.executable
'C:\\Python26\\python.exe'
>>> sys.platform
'win32'
>>> 
```

（您也可以寻找`sys.path`合理的位置。）

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2019-12-09T20:48:15.143

If you have the `py` command installed, which you likely do, then just use the `--list-paths` argument to the command:

`py --list-paths`

Example output:

> Installed Pythons found by py Launcher for Windows
> -3.8-32 C:\Users\cscott\AppData\Local\Programs\Python\Python38-32\python.exe *
> -2.7-64 C:\Python27\python.exe

The * indicates the currently active version for scripts executed using the `py` command.

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2020-04-12T18:45:51.960

Its generally

'C:\Users\user-name\AppData\Local\Programs\Python\Python-version'

or try using (in cmd )

> > where python

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2009-03-15T09:41:58.543

在`sys`包中，您可以找到很多关于您的安装的有用信息：

```
import sys
print sys.executable
print sys.exec_prefix 
```

我不确定这会给您的 Windows 系统带来什么，但在我的 Mac 上`executable`指向 Python 二进制文件和`exec_prefix`安装根目录。

你也可以试试这个来检查你的`sys`模块：

```
import sys
for k,v in sys.__dict__.items():
    if not callable(v):
        print "%20s: %s" % (k,repr(v)) 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2018-10-18T07:30:05.873

If You want the Path After successful installation then first open you CMD and type python or python -i

It Will Open interactive shell for You and Then type

> import sys
> 
> sys.executable

Hit enter and you will get path where your python is installed ...

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2018-07-27T06:21:08.007

To know where Python is installed you can execute `where python` in your cmd.exe.

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2018-09-14T09:19:26.800

You can search for the "environmental variable for you account". If you have added the Python in the path, it'll show as "path" in your environmental variable account.

but almost always you will find it in "**C:\Users\%User_name%\AppData\Local\Programs\Python\Python_version**"

the '*AppData*' folder may be hidden, make it visible from the *view* section of *toolbar*.

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-04-05T11:10:06.030

If anyone needs to do this in C# I'm using the following code:

```
static string GetPythonExecutablePath(int major = 3)
{
    var software = "SOFTWARE";
    var key = Registry.CurrentUser.OpenSubKey(software);
    if (key == null)
        key = Registry.LocalMachine.OpenSubKey(software);
    if (key == null)
        return null;

    var pythonCoreKey = key.OpenSubKey(@"Python\PythonCore");
    if (pythonCoreKey == null)
        pythonCoreKey = key.OpenSubKey(@"Wow6432Node\Python\PythonCore");
    if (pythonCoreKey == null)
        return null;

    var pythonVersionRegex = new Regex("^" + major + @"\.(\d+)-(\d+)$");
    var targetVersion = pythonCoreKey.GetSubKeyNames().
                                        Select(n => pythonVersionRegex.Match(n)).
                                        Where(m => m.Success).
                                        OrderByDescending(m => int.Parse(m.Groups[1].Value)).
                                        ThenByDescending(m => int.Parse(m.Groups[2].Value)).
                                        Select(m => m.Groups[0].Value).First();

    var installPathKey = pythonCoreKey.OpenSubKey(targetVersion + @"\InstallPath");
    if (installPathKey == null)
        return null;

    return (string)installPathKey.GetValue("ExecutablePath");
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-03-01T11:34:48.327

Go to C:\Users\USER\AppData\Local\Programs\Python\Python36 if it is not there then open console by windows+^R Then type cmd and hit enter type python if installed in your local file it will show you its version from there type the following import os import sys os.path.dirname(sys.executable)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2018-07-16T06:55:08.400

This worked for me: `C:\Users\Your_user_name\AppData\Local\Programs\Python`

My currently installed `python version` is `3.7.0`

Hope this helps!

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-12-31T14:35:39.113

You can find it in the Windows GUI, but you need to select “show hidden” in the menu. Directory where python is installed on my Win10 computer:

```
C:\Users\username\AppData\Local\Programs\Python\Python310 
```

Very handy if you use python pip to install packages.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2022-01-26T15:55:18.700

You could have many versions of Python installed on your machine. So if you're in Windows at a command prompt, entering something like this...

```
py --version 
```

...should tell you what version you're using at the moment. (Maybe replace `py` with `python` or `python3` if py doesn't work). Anyway you'd see something like

Python 3.10.2

If you then create a virtual environment using something like this...

```
py -m venv venv 
```

...that environment will also use that Python version. To verify, activate the environment...

```
venv\scripts\activate.bat 
```

You'll see the name of the command prompt. Now if execute:

```
where python 
```

...it will show you which Python executable that virtual environment uses. It will be a copy of Python.exe what's actually in the Scripts subfolder of the virtual environment folder. Of course to see which version that is, again use `py --version`.

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-06-02T16:48:01.097

if you still stuck or you get this

```
C:\\\Users\\\name of your\\\AppData\\\Local\\\Programs\\\Python\\\Python36 
```

simply do this replace 2 \ with one

```
C:\Users\akshay\AppData\Local\Programs\Python\Python36 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-02-03T16:39:06.860

I installed 2 and 3 and had the same problem finding 3\. Fortunately, typing path at the windows path let me find where I had installed it. The path was an option when I installed Python which I just forgot. If you didn't select setting the path when you installed Python 3 that probably won't work - unless you manually updated the path when you installed it. In my case it was at c:\Program Files\Python37\python.exe

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-06-06T10:01:34.770

If you use `anaconda navigator` on windows, you can go too `enviornments` and scroll over the enviornments, the `root` enviorment will indicate where it is installed. It can help if you want to use this enviorment when you need to connect this to other applications, where you want to integrate some python code.

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-11-19T13:33:13.027

# Simplest Answer

There are many Pythonic Ways to Answer, this Question, but I am going to stick to the old and trusted way.

# Steps on Windows

1.  Open Search and Type Edit the System Environment Variables.
2.  Then Click on the "**Environment Variables**" Button in the Down Corner.
3.  There you can see all of the paths associated to where python, pip and other binaries are located that you call on command line.

[![enter image description here](https://i.stack.imgur.com/rJBoQ.png)](https://i.stack.imgur.com/rJBoQ.png)

# c# - & 运算符的含义是什么？

> ID：647517
> 
> 赞同：5
> 
> 时间：2009-03-15T09:10:35.593
> 
> 标签：c#, .net, linq, operators

在以下代码中：

```
Expression<Func<int, bool>> isOdd = i => (i & 1) == 1; 
```

... 是什么意思`(i & 1) == 1`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-15T09:14:05.320

[按位与](http://msdn.microsoft.com/en-us/library/z0zec0b2(VS.71).aspx)。在这种情况下，检查是否`i`设置了最后一位。如果是，则它必须是奇数，因为最后一位表示 1，所有其他位表示偶数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T09:13:38.893

'&' 是[按位和运算符](http://en.wikipedia.org/wiki/Bitwise_operation)。&'ing with 1 消除所有其他二进制数字，如果数字是偶数，则留下 0，如果是奇数，则留下 1。

这是黑客的做法。数学家当然会写 ((i % 2) == 1) 代替，使用[模 2 算术](http://en.wikipedia.org/wiki/Modular_arithmetic)！而软件工程师会编写！IsEven(i)，重用库函数并获得重用布朗尼积分...... :-)

现在，这些是否更有效取决于编译器和 CLR——在这种情况下，还取决于谁来处理 LINQ 表达式树，以及接收者准备处理什么。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T12:25:55.950

& 是位与运算符，与是二进制系统中的基本运算之一。

AND 表示“如果 A 和 B 都打开”。现实世界的例子是两个串联的开关。只有当两者都允许电流通过时，电流才会通过。

在计算机中，这些不是物理开关而是半导体，它们的功能被称为[逻辑门](http://en.wikipedia.org/wiki/Logic_gate)。它们做与开关相同的事情——对电流或无电流作出反应。

当应用于整数时，一个数字中的每一位都与另一个数字中的每一位相结合。因此，要理解位运算符 AND，您需要将数字转换为二进制，然后对每对匹配的位进行 AND 运算。

因此：

```
00011011 (odd number)
AND
00000001 (& 1)
== 
00000001 (results in 1) 
```

然而

```
00011010 (even number)
AND
00000001 (& 1)
==
00000000 (results in 0) 
```

因此，(& 1) 操作使用 AND 逻辑将最右边的位与 1 进行比较。所有其他位都被有效地忽略了，因为任何东西都不是什么。

这相当于检查数字是否为奇数（所有奇数的最右边位等于 1）。

*以上内容改编自我写给[这个问题](https://stackoverflow.com/questions/600202/understanding-phps-operator/601349#601349)的类似答案。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T09:13:23.183

那是检查最后一位是否打开（这很奇怪）。请注意，这不是专门针对 linq 的，您可以在 sql 或 c# 代码上执行此操作。

# c# - 通过c#控制另一个进程的执行

> ID：647518
> 
> 赞同：1
> 
> 时间：2009-03-15T09:10:53.987
> 
> 标签：c#, process, controls, external

我已经编写了 ac 程序，我将类似代码的脚本传递给该程序，它会执行它并为我打印结果。一些事情，比如如果我发送

```
for i in 1 to 10
print i 
```

它会创建并运行代码，该代码基本上会打印从 1 到 10 的值。但是我想集成代码的逐步运行，为此我添加了在传递给程序的脚本中添加断点作为 BP 的功能。因此，当遇到 BP 时，它会运行并等待用户键入继续命令“CNT”。

现在我开发了一个用于编写脚本并在我的程序上运行它的小 ide。但是，我在通过 IDE 提供调试支持时遇到了麻烦。我想实现类似步骤每一行代码或运行整个过程（如 F5，在断点被击中后）。

```
for i in 1 to 10
{
    print i
    BP
} 
```

所以程序会在每一行之后停止并等待用户输入 CNT。但是我希望能够在第一个断点被击中后运行整个程序。

我在 C# 中寻找某种方式，通过它我可以控制我附加的外部 exe 程序的执行。这样，我可以发送命令，例如为下 1 行或下 5 行运行程序等。无论如何，无需修改底层 exe？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-15T09:47:03.477

也许您可以尝试看一下之前的问题： [调试器是如何工作的？](https://stackoverflow.com/questions/216819/how-does-a-debugger-work)

（当前）投票最多的答案中提供的链接将使您基本了解调试器在 Windows 平台上的工作原理，以及如何实现您自己的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-24T10:24:23.483

它的答案可能很多，这取决于实施。我在我的程序中添加了一个功能，可以在到达断点时打印行号。这样我就能够控制执行。

# firefox - 如何让 TiddlySnip 在 Firefox 中工作？

> ID：647529
> 
> 赞同：3
> 
> 时间：2009-03-15T09:15:01.400
> 
> 标签：firefox, tiddlywiki

由于 Google 停止支持 Notebooks，我决定寻找替代方案，因此我尝试了 TiddlyWiki + TiddlySnip。但是，在尝试安装 TiddlySnip2.1 时，出现此错误：

*不会安装“TiddlySnip”，因为它不提供安全更新*

我按照站点中指定的程序将 tiddlysnip.com 添加到允许的站点 - 附加组件列表中，但它仍然无法正常工作。

雪上加霜的是，对扩展的支持也已停止。

我最后的解决方法是使用旧版本（1.21-beta），我能找到它，但我发现它有点不稳定。

有人在这方面取得了成功吗？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-01T03:12:08.190

尤里卡！谷歌救了我！他们的谷歌小组有一篇关于如何将它硬塞进 Firefox 3.5.x 的帖子：[http ://groups.google.com/group/tiddlysnip/browse_thread/thread/e5edef97dec18a17/ce49452f6397083a?lnk=gst&q=does+not+provide+secure +更新#ce49452f6397083a](http://groups.google.com/group/tiddlysnip/browse_thread/thread/e5edef97dec18a17/ce49452f6397083a?lnk=gst&q=does+not+provide+secure+updates#ce49452f6397083a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T02:46:03.840

对 Stumproot，但我只是觉得有必要寻找替代方案。

OT，我甚至进入 tiddlywiki 的 irc 频道一探究竟，似乎除了使用旧版本之外没有其他方法可以解决这个问题。

我认为 TW 社区仍然计划继续开发 TiddlySnip，但现在它被搁置了，所以 TW 用户只需要使用 beta 版本。

# qt - qt 4.5 有皮肤吗？

> ID：647530
> 
> 赞同：2
> 
> 时间：2009-03-15T09:16:08.903
> 
> 标签：qt, skins

我第一次使用 qt 4.5 进行开发。我正在开发一个将在 windows xp/vista 上运行的桌面应用程序。

客户想要一个可以组装软电话或类似东西的皮肤。

qt 是否带有任何皮肤引擎？是否可以使用 qt 创建皮肤？

非常感谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-15T09:26:47.893

是的，您可以编写[样式表](https://doc.qt.io/qt-5/stylesheet.html)来自定义应用程序的外观。语法类似于 CSS，并为您提供了许多可能性。如果您只想让所有按钮都变成红色，例如：

```
QPushButton {
  color: red;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T09:24:54.967

[是](http://doc.trolltech.com/4.5/paintsystem.html#styling)的。这叫做造型。

# c# - 递归泛型类型

> ID：647533
> 
> 赞同：28
> 
> 时间：2009-03-15T09:18:36.477
> 
> 标签：c#, generics

是否可以在 C# 中定义引用自身的泛型类型？

例如，我想定义一个 Dictionary<>，它的类型为 TValue（对于层次结构）。

```
Dictionary<string, Dictionary<string, Dictionary<string, [...]>>> 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-15T09:21:27.377

尝试：

```
class StringToDictionary : Dictionary<string, StringToDictionary> { } 
```

然后你可以写：

```
var stuff = new StringToDictionary
        {
            { "Fruit", new StringToDictionary
                {
                    { "Apple", null },
                    { "Banana", null },
                    { "Lemon", new StringToDictionary { { "Sharp", null } } }
                }
            },
        }; 
```

递归的一般原则：想办法给递归模式一个名字，这样它就可以通过名字来引用自己。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-08-06T17:42:44.533

另一个例子是通用树

```
public class Tree<TDerived> where TDerived : Tree<TDerived>
{
    public TDerived Parent { get; private set; }
    public List<TDerived> Children { get; private set; }
    public Tree(TDerived parent)
    {
        this.Parent = parent;
        this.Children = new List<TDerived>();
        if(parent!=null) { parent.Children.Add(this); }
    }
    public bool IsRoot { get { return Parent == null; } }
    public bool IsLeaf { get { return Children.Count==0; } }
} 
```

现在使用它

```
public class CoordSys : Tree<CoordSys>
{
    CoordSys() : base(null) { }
    CoordSys(CoordSys parent) : base(parent) { }
    public double LocalPosition { get; set; }
    public double GlobalPosition { get { return IsRoot?LocalPosition:Parent.GlobalPosition+LocalPosition; } }
    public static CoordSys NewRootCoordinate() { return new CoordSys(); }
    public CoordSys NewChildCoordinate(double localPos)
    {
        return new CoordSys(this) { LocalPosition = localPos };
    }
}

static void Main() 
{
    // Make a coordinate tree:
    //
    //                  +--[C:50] 
    // [A:0]---[B:100]--+         
    //                  +--[D:80] 
    //

    var A=CoordSys.NewRootCoordinate();
    var B=A.NewChildCoordinate(100);
    var C=B.NewChildCoordinate(50);
    var D=B.NewChildCoordinate(80);

    Debug.WriteLine(C.GlobalPosition); // 100+50 = 150
    Debug.WriteLine(D.GlobalPosition); // 100+80 = 180
} 
```

请注意，您不能直接实例化`Tree<TDerived>`. 它必须是树中节点类的基类。想想`class Node : Tree<Node> { }`。

# algorithm - B-tree 比 AVL 或 RedBlack-Tree 快？

> ID：647537
> 
> 赞同：68
> 
> 时间：2009-03-15T09:20:36.550
> 
> 标签：algorithm, data-structures, binary-tree

我知道性能永远不是黑白的，通常一种实现在 X 情况下更快，在 Y 情况下更慢，等等，但总的来说 - B-trees 是否比 AVL 或 RedBlack-Trees 更快？它们的实现比 AVL 树（甚至可能是红黑树？）要复杂得多，但是它们*更快*吗（它们的复杂性是否得到回报）？

**编辑：**我还想补充一点，如果它们比等效的 AVL/RedBlack 树（就节点/内容而言）更快 -*为什么*它们更快？

* * *

## 回答 #1

> 赞同：135
> 
> 时间：2009-03-18T09:57:47.897

肖恩的帖子（目前被接受的）包含几个不正确的声明。对不起，肖恩，我不是故意粗鲁的。我希望我能说服你，我的陈述是有根据的。

> 它们的用例完全不同，因此无法进行比较。

它们都用于维护一组具有快速查找、插入和删除功能的完全有序的项目。它们具有相同的界面和相同的意图。

> RB 树通常是用于提供对数据的快速访问（理想情况下为 O(logN)）的内存结构。[...]

*总是*O(log n)

> B 树通常是基于磁盘的结构，因此本质上比内存数据慢。

废话。在磁盘上存储搜索树时，通常使用 B 树。这是真的。当您将数据存储在磁盘上时，访问速度比访问内存中的数据要慢。但是存储在磁盘上的红黑树*也*比存储在内存中的红黑树慢。

你在这里比较苹果和橘子。真正有趣的是内存 B 树和内存红黑树的比较。

[顺便说一句：与红黑树相反，B 树在 I/O 模型中理论上是有效的。我已经通过实验测试（并验证了）用于排序的 I/O 模型；我希望它也适用于 B 树。]

> B树很少是二叉树，一个节点可以拥有的孩子的数量通常很大。

需要明确的是，B-tree 节点的大小范围是树的一个参数（在 C++ 中，您可能希望使用整数值作为模板参数）。

> 当数据发生变化时，B-tree 结构的管理会相当复杂。

我记得它们比红黑树更容易理解（和实现）。

> B-tree 尽量减少磁盘访问的次数，以便数据检索具有合理的确定性。

这是真的。

> 在非常数据库中查找一些数据所必需的 4 B 树访问这样的情况并不少见。

有数据吗？

> 在大多数情况下，我会说内存中的 RB 树更快。

有数据吗？

> 因为查找是二进制的，所以很容易找到一些东西。B-tree 每个节点可以有多个子节点，因此您必须在每个节点上扫描节点以查找合适的子节点。这是一个 O(N) 操作。

每个节点的大小是一个固定参数，所以即使你进行线性扫描，也是 O(1)。如果我们超过每个节点的大小，请注意您通常保持数组排序，因此它是 O(log n)。

> 在 RB 树上，它会是 O(logN)，因为你正在做一个比较然后分支。

你在比较苹果和橘子。O(log n) 是因为树的高度最多为 O(log n)，就像 B 树一样。

此外，除非你对红黑树玩讨厌的分配技巧，否则推测 B 树具有更好的缓存行为似乎是合理的（它访问一个数组，而不是散布在各处的指针，并且分配开销更少，增加内存地方性甚至更多），这可能有助于它在速度竞赛中。

我可以指出实验证据表明，B 树（特别是大小参数为 32 和 64）在小尺寸方面与红黑树非常有竞争力，并且在 n 值适中的情况下也优于它。见[http://idlebox.net/2007/stx-btree/stx-btree-0.8.3/doxygen-html/speedtest.html](http://idlebox.net/2007/stx-btree/stx-btree-0.8.3/doxygen-html/speedtest.html)

B树更快。为什么？我推测这是由于内存局部性、更好的缓存行为和更少的指针追逐（如果不是相同的东西，在某种程度上重叠）。

* * *

## 回答 #2

> 赞同：105
> 
> 时间：2009-07-28T16:39:45.167

实际上 Wikipedia 有一篇很棒的文章显示每个 RB-Tree 都可以很容易地表示为 B-Tree。以以下树为例：

![RB树](https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/Red-black_tree_example.svg/800px-Red-black_tree_example.svg.png)

现在只需将其转换为 B-Tree（为了使这一点更明显，节点仍为 R/B 色，这是 B-Tree 中通常没有的）：

[与 B 树相同的树](http://upload.wikimedia.org/wikipedia/commons/7/72/Red-black_tree_example_(B-tree_analogy).svg)

（由于某些奇怪的原因无法在此处添加图像）

任何其他 RB-Tree 也是如此。它取自这篇文章：

[http://en.wikipedia.org/wiki/Red-black_tree](http://en.wikipedia.org/wiki/Red-black_tree)

引用这篇文章：

> 然后，红黑树在结构上等效于 4 阶 B 树，每个簇的最小填充因子为 33% 的值，最大容量为 3 个值。

我没有发现任何数据表明两者中的一个明显优于另一个。我想如果是这样的话，两者中的一个已经死了。它们在必须在内存中存储多少数据以及从树中添加/删除节点的复杂程度方面有所不同。

## 更新：

我的个人测试表明，B-Tree 在搜索数据时更好，因为它们具有更好的数据局部性，因此 CPU 缓存可以更快地进行比较。B-Tree 的阶数越高（阶数是一个笔记可以拥有的子节点数），查找的速度就越快。另一方面，它们的添加和删除新条目的性能越差，它们的顺序越高。这是因为在节点内添加值具有线性复杂性。由于每个节点都是一个排序数组，因此在将元素添加到中间时，您必须在该数组内移动大量元素：新元素左侧的所有元素必须向左移动一个位置，或者将所有元素向右移动一个位置新元素必须向右移动一位。如果一个值在插入过程中向上移动一个节点（这在 B 树中经常发生），它会留下一个空洞，也必须通过将所有元素从左侧移动一个位置或将所有元素移动到右侧来填充该空洞。右边一个位置到左边。这些操作（在 C 中通常由 memmove 执行）实际上是 O(n)。所以B-Tree的阶数越高，查找越快但修改越慢。另一方面，如果您选择的顺序太低（例如 3），B-Tree 在实践中与其他树结构相比几乎没有优势或劣势（在这种情况下，您也可以使用其他东西）。因此，我总是会创建具有高阶的 B 树（至少 4、8 及以上就可以了）。它会留下一个空洞，也必须通过将所有元素从左侧移动一个位置或将所有元素向右移动一个位置来填充该空洞。这些操作（在 C 中通常由 memmove 执行）实际上是 O(n)。所以B-Tree的阶数越高，查找越快但修改越慢。另一方面，如果您选择的顺序太低（例如 3），B-Tree 在实践中与其他树结构相比几乎没有优势或劣势（在这种情况下，您也可以使用其他东西）。因此，我总是会创建具有高阶的 B 树（至少 4、8 及以上就可以了）。它会留下一个空洞，也必须通过将所有元素从左侧移动一个位置或将所有元素向右移动一个位置来填充该空洞。这些操作（在 C 中通常由 memmove 执行）实际上是 O(n)。所以B-Tree的阶数越高，查找越快但修改越慢。另一方面，如果您选择的顺序太低（例如 3），B-Tree 在实践中与其他树结构相比几乎没有优势或劣势（在这种情况下，您也可以使用其他东西）。因此，我总是会创建具有高阶的 B 树（至少 4、8 及以上就可以了）。另一方面，如果您选择的顺序太低（例如 3），B-Tree 在实践中与其他树结构相比几乎没有优势或劣势（在这种情况下，您也可以使用其他东西）。因此，我总是会创建具有高阶的 B 树（至少 4、8 及以上就可以了）。另一方面，如果您选择的顺序太低（例如 3），B-Tree 在实践中与其他树结构相比几乎没有优势或劣势（在这种情况下，您也可以使用其他东西）。因此，我总是会创建具有高阶的 B 树（至少 4、8 及以上就可以了）。

通常基于 B 树的文件系统使用更高的阶数（阶数 200 甚至更多） - 这是因为它们通常选择足够高的阶数，以便注释（当包含最大允许元素数时）等于硬盘驱动器上的扇区或文件系统集群的大小。这提供了最佳性能（因为 HD 一次只能写入一个完整扇区，即使只更改一个字节，整个扇区也会被重写）和最佳空间利用率（因为驱动器上的每个数据条目至少等于一个集群或集群大小的倍数，无论数据实际有多大）。由于硬件将数据视为扇区并且文件系统将扇区分组为簇，B 树可以为文件系统提供比任何其他树结构更好的性能和空间利用率；这就是为什么它们在文件系统中如此受欢迎的原因。

当您的应用程序不断更新树，向其中添加或删除值时，与高阶 B-Tree 相比，RB-Tree 或 AVL-Tree 的平均性能可能会更好。查找更糟，它们可能还需要更多内存，但因此修改通常很快。实际上，RB-Trees 的修改速度甚至比 AVL-Trees 还要快，因此 AVL-Trees 的查找速度要快一些，因为它们通常不那么深。

所以像往常一样，这在很大程度上取决于您的应用程序在做什么。我的建议是：

1.  大量查找，少量修改：B-Tree（高阶）
2.  大量查找，大量修改：AVL-Tree
3.  少量查找，大量修改：RB-Tree

所有这些树的替代品是[AA-Trees](http://en.wikipedia.org/wiki/AA_tree)。正如这篇[PDF 论文所暗示](http://www.cepis.org/upgrade/files/monograph-2004-V.pdf)的，AA-Trees（实际上是 RB-Trees 的一个子组）在性能上几乎与普通 RB-Trees 相同，但它们比 RB-Trees、AVL-Trees、或 B 树。这是一个[完整的实现](http://users.cis.fiu.edu/~weiss/dsaa_c2e/aatree.c)，看看**它有多小**（主函数不是实现的一部分，一半的实现行实际上是注释）。

正如 PDF 论文所示，[Treap](http://en.wikipedia.org/wiki/Treap)也是经典树实现的有趣替代方案。Treap 也是一棵二叉树，但它不会尝试强制平衡。为了避免在不平衡二叉树中遇到的最坏情况（导致查找变为 O(n) 而不是 O(log n)），Treap 为树添加了一些随机性。随机性不能保证树的平衡良好，但它也使得树极不可能非常不平衡。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-03-15T10:42:09.803

没有什么能阻止只在内存中工作的 B-Tree 实现。事实上，如果键比较便宜，内存 B-Tree 可以*更快*，因为它在一个节点中打包多个键将*减少*搜索期间的缓存未命中。有关性能比较，请参阅[此](http://idlebox.net/2007/stx-btree/)链接。引用：“速度测试结果很有趣，显示 B+ 树对于包含超过 16,000 个项目的树要快得多。” （B+Tree 只是 B-Tree 的一种变体）。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-02-13T01:02:22.723

这个问题很老，但我认为它仍然是相关的。Jonas Kölker 和 Mecki 给出了很好的答案，但我不认为答案涵盖了整个故事。我什至会争辩说整个讨论都没有抓住重点:-)。

当条目相对较小（整数、小字符串/单词、浮点数等）时，关于 B 树的说法是正确的。当条目很大（超过 100B）时，差异变得更小/微不足道。

让我总结一下关于 B-Trees 的要点：

*   由于内存局部性（导致更少的缓存和 TLB 未命中），它们比任何二叉搜索树 (BST) 都快。

*   如果条目相对较小或条目大小可变，则 B 树通常更节省空间。空闲空间管理更容易（您分配更大的内存块）并且每个条目的额外元数据开销更低。B-Trees 会浪费一些空间，因为节点并不总是满的，但是，它们最终仍然比二叉搜索树更紧凑。

*   两者的大 O 性能（ O(logN) ）是相同的。此外，如果您在每个 B-Tree 节点内进行二分搜索，您甚至会得到与 BST 中相同数量的比较（这是一个很好的数学练习来验证这一点）。如果 B-Tree 节点大小合理（1-4 倍缓存行大小），由于硬件预取，每个节点内部的线性搜索仍然更快。您还可以使用 SIMD 指令来比较基本数据类型（例如整数）。

*   B-Trees 更适合压缩：每个节点有更多的数据需要压缩。在某些情况下，这可能是一个巨大的好处。想想关系数据库表中用于构建索引的自动递增键。B-Tree 的前导节点包含压缩得非常非常好的连续整数。

*   当存储在辅助存储（需要进行块 IO）时，B 树显然要快得多。

在纸面上，B-Trees 有很多优点，几乎没有缺点。那么是否应该只使用 B-Trees 以获得最佳性能？

答案通常是否定的——如果树适合内存。在性能至关重要的情况下，您需要一个线程安全的树状数据结构（简单地说，多个线程可以比单个线程做更多的工作）。让 B-Tree 支持并发访问比让 BST 更成问题。使树支持并发访问的最直接方法是在遍历/修改节点时锁定节点。在 B 树中，每个节点锁定更多条目，导致更多序列化点和更多竞争锁。

所有树版本（AVL、Red/Black、B-Tree 等）都有无数的变体，它们在支持并发方面的方式不同。在大学课程中教授或从一些入门书籍中阅读的普通算法几乎从未在实践中使用过。因此，很难说哪棵树表现最好，因为对于每棵树背后的确切算法没有官方协议。我建议将提到的树更像是遵循某些树状不变量的数据结构类，而不是精确的数据结构。

以 B 树为例。vanilla B-Tree 几乎从未在实践中使用过——你不能让它很好地扩展！最常用的 B-Tree 变体是 B+-Tree（广泛用于文件系统、数据库）。B+-Tree 和 B-Tree 之间的主要区别： 1）您不将条目存储在树的内部节点中（因此当修改存储在内部节点中的条目时，您不需要在树的高处写锁） ; 2）您在同一级别的节点之间有链接（因此在进行范围搜索时您不必锁定节点的父节点）。

我希望这有帮助。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-02-14T07:53:10.963

谷歌的人最近发布了他们基于 B-trees 的 STL 容器的实现。他们声称与通过红黑树实现的标准 STL 容器相比，他们的版本更快并且消耗更少的内存。更多细节[在这里](http://google-opensource.blogspot.ru/2013/01/c-containers-that-save-memory-and-time.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-07-19T14:21:24.480

对于某些应用程序，B 树比 BST 快得多。您可以在这里找到的树木：

[http://freshmeat.net/projects/bps](http://freshmeat.net/projects/bps)

相当快。它们还比常规 BST 实现使用更少的内存，因为它们不需要每个节点 2 或 3 个指针的 BST 基础结构，以及一些额外的字段来保持平衡信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T09:29:37.030

它们在不同的情况下使用 - 当树节点需要一起保存在存储中时使用 B 树 - 通常因为存储是磁盘页面，因此重新平衡可能非常昂贵。当您没有此约束时，将使用 RB 树。因此，如果您想实现（例如）关系数据库索引，B-trees 可能会更快，而 RB 树对于（例如）内存搜索可能会更快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T11:58:35.320

它们都具有相同的渐近行为，因此性能更多地取决于实现而不是您使用的树类型。树结构的某种组合实际上可能是最快的方法，其中 B 树的每个节点都完全适合缓存行，并且某种二叉树用于在每个节点内进行搜索。自己管理节点的内存也可能使您能够实现更大的缓存局部性，但代价非常高。

就个人而言，我只是将标准库中的任何内容用于我正在使用的语言，因为它需要做很多工作才能获得非常小的性能提升（如果有的话）。

从理论上讲... RB-trees 实际上与 B-trees 非常相似，因为它们模拟 2-3-4 树的行为。AA-trees 是一种类似的结构，而是模拟 2-3 棵树。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-07-03T16:06:53.530

此外......红黑树的高度是 O(log[2] N) 而 B-tree 的高度是 O(log[q] N) ，其中天花板 [N]<= q <= N 。因此，如果我们考虑在 B 树的每个键数组中进行比较（如上所述固定），那么 B 树的时间复杂度 <= 红黑树的时间复杂度。（相同大小的单个记录的大小等于块大小）

# database - 一起使用 couchDB 和 RDBMS 的应用程序

> ID：647540
> 
> 赞同：4
> 
> 时间：2009-03-15T09:21:49.967
> 
> 标签：database, architecture, couchdb, rdbms

想知道是否存在这样一种场景，即在两全其美的场景中同时使用基于文档的数据库和关系数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T10:05:32.373

一种想法是使用关系数据库作为主要数据存储，使用基于文档的数据库作为从后端到前端的数据分发机制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T16:06:54.453

在我看来，直到我看到一个实际的（开源或其他透明的）应用程序成功地做到了这一点，我仍会怀疑这对于少于十几个开发人员的项目是否值得。

我怀疑通过选择一个数据库而不是另一个数据库并坚持使用它——无论好坏——开发人员都会降低数据模型的复杂性和代码的维护成本。此外，通过选择两个数据库，一个会面临两全其美的风险，其中的数据既难以操作和报告（CouchDB），也难以扩展（RDBMS）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T23:06:03.977

我们混合使用 RDBMS 和 CouchDB。RDBMS (IBM DB/2) 用于“精确”数据，其中事务使事情变得更容易。例子是货币和库存的簿记。CouchDB 用于归档来自 RDBMS 的“已完成”记录、数字声明（JPEG、扫描文档）和结构不良的信息，例如通过航运公司的跟踪和追踪系统获取的信息。

# c# - IDispatchEx 存在于哪里？

> ID：647549
> 
> 赞同：3
> 
> 时间：2009-03-15T09:29:21.977
> 
> 标签：c#, interop

找不到包含 IDispatchEx 接口的库。我想实现这个接口，但是找不到。有谁知道它在哪里？

谢谢，保罗。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T10:39:25.253

如果要编写实现[IDispatchEx](http://msdn.microsoft.com/en-us/library/sky96ah7(VS.85).aspx)接口的托管类，则首先需要定义此接口，因为它在 .NET 中不存在。这是其定义的[链接。](http://www.koders.com/csharp/fid620085F6ECBCC8F7C598BC99A9B97BB756514DFE.aspx?s=zoom#L1136)恕我直言，实现此接口并非易事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T09:33:33.820

你到底想做什么？这是在 C# 中使用的吗？还是来自外部（COM）？

如果您只是想要浏览器支持，那么也许可以托管`WebBrowser`并设置[`ObjectForScripting`](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.objectforscripting.aspx).

您可以使用扩展方法在 C# 3.0 中为*类型*添加方法：

```
public static void Bar(this Foo foo, int someArg) {...}
....
Foo foo = ...
foo.Bar(123); 
```

但这仍然是静态类型的。C# 4.0`dynamic`在 CLR/DLR 中引入了真正的动态对象，但您需要实现`IDynamicObject`. 这不是微不足道的。

# ruby - 如何将 TimeoutHandler 添加到 EvenmentMachine 连接

> ID：647554
> 
> 赞同：0
> 
> 时间：2009-03-15T09:34:01.870
> 
> 标签：ruby

现在我正在为一个基于事件机器的非阻塞 httpclient 进行编码，如果目标无法访问，客户端似乎会挂起 50 秒。我的问题是

1.  如何缩短超时时间？我试过 conn.set_comm_inactivity_timeout(5)，但没用
2.  如何将 TimeoutHandler 添加到连接中？

谢谢！

/杰克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T15:26:09.980

我不知道它是否是您正在寻找的 100%，但是 ruby​​ 在其标准库中有一个超时类（--> [http://www.ruby-doc.org/stdlib/libdoc/timeout/rdoc/index .html](http://www.ruby-doc.org/stdlib/libdoc/timeout/rdoc/index.html) )

```
 require 'timeout'
  status = Timeout::timeout(5) {
    # Something that should be interrupted if it takes too much time...
  } 
```

# architecture - 从 couchDB 迁移到 RDBMS

> ID：647556
> 
> 赞同：1
> 
> 时间：2009-03-15T09:34:11.153
> 
> 标签：architecture, couchdb, rdbms

想知道是否可以从基于文档的数据库（例如 couchDB）迁移到 RDBMS（例如 MySQL）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T23:01:59.197

简短的回答：是的

长答案：您使用的 Document-DB（例如 CouchDB）的功能越多，您会感到越痛苦。复杂的基于 map-reduce 的“视图”生成、复杂的嵌套文档等概念不能很好地映射到 RDBMS。

还认为使用 CouchDB（具有两个以上 Master 的多主控，负载平衡）很容易使用 RBMS 几乎不可能。

另一方面，大量使用真正的 RDBMS（通常不是 mySQL）的应用程序更难移植到 CouchDB 和朋友，因为它们错过了事务和所有其余的 ACID 属性。CouchDB 在这方面提供的保证要少得多。因此，通常*从*couchdb 移植比移植*到*couchdb 更容易。

也就是说，许多应用程序仅将 RDBMS 用作美化的（键、值）存储——这些很容易在各个方向上移植。

# svn - 两个程序员处理相同的代码

> ID：647565
> 
> 赞同：2
> 
> 时间：2009-03-15T09:43:33.283
> 
> 标签：svn, mamp, lamp

我正在与合作伙伴一起编写一些 PHP 代码，并且都在我们的机器上本地运行 LAMP（或在我的情况下 - MAMP）服务器。有什么方法可以让我们同时处理同一段代码吗？这将需要我们的 IDE（我使用 Zend Studio，他使用 PHPed）和我们的 MySQL 服务器在任何更改完成时进行更新。

PS - 是否有任何系统也允许对代码进行实时评论？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T09:49:29.837

不是同时AFAIK，但您通常也不希望那样。（如果您真的需要，请坐在同一台计算机旁。）

协作编码的公认工作流程是进行一组更改，对它们的工作感到满意，记录它们，整合来自您的伙伴的一些更改，确保它适用于您的最新更改，然后重新开始处理一些新的更改。

您应该查看一些 DVCS 系统，例如[Mercurial](http://www.selenic.com/mercurial)或[Git](http://git-scm.com/)，它们允许您来回共享记录的更改（也称为提交）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T09:48:49.540

由于您已经使用 SVN，因此可以处理相同的代码，并且在合并时提交、更新和解决可能的冲突。就每个应用程序的哪些部分进行一些交流肯定会有所帮助。

关于数据库的更改，这里是它对我的工作方式。每个开发人员都在他的本地机器上使用数据库的本地实例工作，他可以​​在其中进行试验并做任何他想做的事情。当更改是永久性的时，他会提交一个 SQL 增量脚本，该脚本与代码一起进入存储库。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T09:49:33.690

您可以使用任何 emacs，并在其他机器上打开显示（ Mx open-display ）或者您可以使用 screen 或者您可以使用 VNC

* * *

刚刚看到 Eclipse：[http ://wiki.eclipse.org/DocShare_Plugin](http://wiki.eclipse.org/DocShare_Plugin)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T11:57:17.470

如果您想同时处理相同的代码库，但代码的不同部分，[SVN](http://subversion.tigris.org/)是最佳选择。但是，如果您确实需要同时处理相同的代码，则需要协作编辑器，例如。[Mozilla 贝斯平](http://labs.mozilla.com/projects/bespin/)。

在大多数现实生活情况下，第一选择，加上一些 IM 就足够了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T10:02:09.620

如果要同步数据库，则需要使用同一台服务器。 [Eclipse](http://eclipse.org)有一个名为[Cola](http://wiki.eclipse.org/DocShare_Plugin)的插件，它允许实时协作编辑，但我认为使用 2 个不同的 IDE 是不可能的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T10:08:14.223

由于您使用 MAMP，我想您使用的是 Mac。SubEthaEdit 用于实时协作。[http://www.codingmonkeys.de/subethaedit/](http://www.codingmonkeys.de/subethaedit/)

如果您想保留不同的 IDE 并需要实时更改，我认为您必须自己编写脚本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T09:49:37.230

我和其他人处于这种情况。我们主要处理单独的文件，然后当我们有一些不会破坏网站的东西时将我们的更改检查到颠覆中。每当其他人签入某些东西时，我们都会经常签入并更新我们的代码。

我们做的另一件有用的事情是在我们的测试服务器上有一个链接（与我们在本地计算机上的 MAMP 安装分开。）它将自动从存储库中检查最新版本的 php 代码并重新加载页面。基本上使获取代码更新尽可能容易。

# c# - 存储 ObjectContext 实例的最佳位置在哪里？

> ID：647579
> 
> 赞同：2
> 
> 时间：2009-03-15T09:57:16.667
> 
> 标签：c#, asp.net-mvc, linq-to-sql, entity-framework

我使用 Object 的扩展名，因为它提供了非常短的可访问字符串。

```
public static BusinessLayer.Models.SearchEngineEntities db(this object o)
    {

        if (HttpContext.Current == null)
            return new BusinessLayer.Models.SearchEngineEntities(ConfigurationManager.ConnectionStrings["SearchEngineEntities"].ConnectionString);

        if (HttpContext.Current.Items.Contains("DataContext"))
        {
            return (BusinessLayer.Models.SearchEngineEntities)HttpContext.Current.Items["DataContext"];
        }

        BusinessLayer.Models.SearchEngineEntities context = new BusinessLayer.Models.SearchEngineEntities(ConfigurationManager.ConnectionStrings["SearchEngineEntities"].ConnectionString);
        HttpContext.Current.Items.Add("DataContext", context);
        return context;
    } 
```

所以结果我有执行字符串，如：

```
"".db().Users.Include("").... 
```

但我不是 100% 确定这是最好的解决方案。我希望你比我更清楚，DataContext 或 ObjectContext 实例在哪里以及如何存储。也许你知道更好的解决方案......

谢谢你的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T10:15:03.660

为什么需要*扩展方法*来执行此操作？你应该放弃扩展方法，只使用一个`static`方法（和一个`static class`）。我还发现了一篇我认为可能对您有帮助的文章：

[在 n 层 ASP.NET 应用程序中管理实体框架 ObjectContext 的生命周期和范围](http://dotnetslackers.com/articles/ado_net/Managing-Entity-Framework-ObjectContext-lifespan-and-scope-in-n-layered-ASP-NET-applications.aspx)

# database-design - 我应该使用 HL7 RIM 还是推出自己的数据模型？

> ID：647582
> 
> 赞同：1
> 
> 时间：2009-03-15T10:00:23.180
> 
> 标签：database-design, hl7

我的团队被指派为客户建立一个电子健康平台，在设计过程中我们遇到了这样的困境：

对于数据模型，我们有两个选项，[HL7 RIM](http://www.hl7.org/Library/data-model/)（参考信息模型）和另一个尚未设计的选项。

尽管 RIM 已被广泛记录并且看起来非常完整，但鉴于其复杂性和明显的缓慢性，我不确定它是否是最佳选择。

我想设计一个更简单的模型，它只考虑客户的要求，旨在更容易理解并且可能更快。

你怎么看？我应该遵循 HL7-RIM 吗？或者我应该为我的客户的要求想出一个更简单的模型？

在任何情况下，信息交换都需要实现 HL7 消息传递协议，因此我们必须独立于底层模型开发该部分。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T10:30:35.260

答案是使用您自己的模型，特定于客户要求，但具有始终能够与 HL7 互换的功能要求。在整个开发过程中测试该要求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T13:08:49.937

您在医疗保健数据方面需要的灵活性越高（应用程序的“存储库或数据仓库”越多），实施 HL7 RIM 的理由就越大。搜索“RIMBAA”（基于 RIM 的应用程序架构）以获取有关此方法的更多信息。

您的应用程序越倾向于支持一组特定的定义良好的工作流，就越有理由使用针对该特定工作流优化的数据模型。我同意 John Saunders 的观​​点：确保您的“优化数据模型”可以映射到 RIM。这应该有助于“面向未来”您的应用程序并使其更容易支持 HL7 接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-17T14:24:27.990

我会推荐 HL7，但是你应该对它的使用保持战略性。我假设您的组织中已经拥有一整套软件系统。如果是这种情况，在关键服务上公开“HL7 接口”可能是一个好主意，但内部对话采用特定于您的组织的规范形式。

HL7 的伟大之处在于它本质上是基于消息的，因此您可以使用 Business Proccessor Manager (BPM) 软件做各种很酷的事情，您只需让您的业务人员绘制关于 HL7 消息流如何管理的漂亮图表。

我可能建议的一件事是调查各种“适配器”，例如“iWay Intelligent Adapter for HL7”或 IBM 的 WTX。这些让您可以专注于需要编写的业务代码，而不必担心传输层的 HL7 消息传递等……

希望有帮助。

# drupal - Flickr 在 Drupal 中？

> ID：647583
> 
> 赞同：2
> 
> 时间：2009-03-15T10:02:04.173
> 
> 标签：drupal, flickr

我正在尝试让 flickr 图像在 Drupal 中工作，知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-15T10:04:04.467

[Flickr drupal 模块](http://drupal.org/project/flickr)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-24T10:35:29.257

您可以使用适用于 Drupal 6 和 Drupal 7 的[FlickrGallery](http://drupal.org/project/flickrgallery)模块从您的帐户中获取所有图像。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T21:36:47.287

如果您尝试将 Flickr 照片同步到 Drupal 内容，请查看：[http ://drupal.org/project/flickrsync](http://drupal.org/project/flickrsync)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-02T05:45:52.797

FLickr 有一个 Drupal 的帮助页面

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T20:55:45.970

我还没有测试过 media_flickr 模块，但是媒体是经过良好测试的模块，并且还有很多其他模块可以作为媒体模块的插件，所以我强烈推荐

这是 flickr：[http ://drupal.org/project/media_flickr](http://drupal.org/project/media_flickr)

# asp.net - 在 Visual Studio 2008 上插入图层

> ID：647586
> 
> 赞同：1
> 
> 时间：2009-03-15T10:02:47.387
> 
> 标签：asp.net, visual-studio, visual-studio-2008, visual-studio-2005

有没有一种简单的方法可以在 Visual Studio 2008 中插入图层（Visual Studio 2005 的一项功能）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-30T20:35:07.727

使用工具箱中 HTML 类别中的 DIV，选择这个新的 DIV，然后使用**Format** -> **Set Position** -> **Absolute**。

# sql-server - SQL Server Management Studio 中的宏

> ID：647594
> 
> 赞同：19
> 
> 时间：2009-03-15T10:10:05.513
> 
> 标签：sql-server, macros

有没有办法在 SSMS 中实现文本编辑宏？例如，我想转换代码，如下所示，但使用按键，而不是冗长的正则表达式搜索和替换。

这：

```
INSERT INTO [TABLE]
           ([fieldOne]
           ,[fieldTwo])
     VALUES
           (<fieldOne, datetime,>
           ,<fieldTwo, real(24,0)) 
```

必须变成这样：

```
INSERT INTO [TABLE]
           ([fieldOne]
           ,[fieldTwo])
     VALUES
           (@fieldOne
           ,@fieldTwo) 
```

我知道 SSMS 本身并不支持这一点，但我也知道它是可扩展的，如果没有记录的话，并且还有完全外部应用程序的空间，它将复制文本、转换并粘贴回来，而无需打开编辑器，粘贴、编辑、复制并粘贴回 SSMS。

编辑存储的模板不是一个选项，因为这些模板是动态生成的，并且使用 Ctrl+Shift+M 也不是一个选项，因为我仍然必须键入每个参数名称，但不方便在查询中复制和粘贴编辑。

没有 SSMS 解决方案！我正在寻找某种可以帮助我做到这一点的外部巫术。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-16T08:43:56.303

[AutoHotKey](http://www.autohotkey.com/)脚本呢？

根据模板的复杂性，您可以

1.  使用 AutoHotKey 播放正则表达式搜索和替换所需的击键，或
2.  将模板复制到剪贴板并直接在 AutoHotKey 中对其进行操作，然后再将其粘贴回去。

我确信第一个选项会起作用。第二个我没试过。

[这个问题](https://stackoverflow.com/questions/200587/how-can-i-mimic-visual-studios-ctrl-k-c-two-step-macro-behaviour-using-autoit)说明了如何编写 AutoHotKey 脚本来监听键盘和弦。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-15T11:30:35.333

如果您使用的是 SSMS 2005 及更高版本，它内置了对模板的支持。它不是完全成熟的宏，但它仍然非常有用。

语法与您在第一个代码片段中显示的完全相同，您只需按 Ctrl+Shift+M 即可弹出一个对话框，提示您将值放入尖括号中的位中。

如果您右键单击表并选择“将表编写为”，然后选择插入、更新或删除选项，SQL Server 会以这种格式生成脚本。

您还可以创建自己的自定义模板，或修改现有的内置模板之一（单击查看 -> 模板资源管理器以访问其他内置模板）。

MSDN 上有一篇[简短的文章](http://msdn.microsoft.com/en-us/library/ms179334.aspx)解释了如何开始使用模板。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-12T17:49:29.913

正在寻找其他东西，但发现了这个问题。如果您仍在寻找某些东西，请尝试 SSMS 工具包：[http](http://www.ssmstoolspack.com/) ://www.ssmstoolspack.com/它有宏和许多其他简洁的东西。而且它是免费的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-28T02:56:21.073

对于 SSMS 2016，您可以使用我的[Visual Commander](https://vlasovstudio.com/visual-commander/)扩展。它支持用于编辑器文本操作的宏录制/播放和自定义 C#/VB 命令。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T11:49:09.550

第一个代码是来自老式 MS Query Analyzer 的模板。填充的快捷键是**Ctrl+M**（但我不确定，可能是Ctrl+Shift+M）。

较新的 SSMS 中应该有相同的功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-29T08:49:27.127

我通常将代码复制到另一个编辑器（Notepad++ 或 Delphi /RAD Studio 编辑器），执行我的宏操作，然后将其粘贴回 SSMS。

# asp.net - ASP.NET 常用控件源代码

> ID：647596
> 
> 赞同：1
> 
> 时间：2009-03-15T10:14:48.637
> 
> 标签：asp.net, visual-studio, visual-studio-2008, asp.net-2.0

是否有现成的源代码可用于 ASP.NET 2.0 的常用控件（比如在工具箱中找到）？

我想要的详细程度是我需要了解控件的内部工作原理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T13:14:44.430

是的，微软实际上已经发布了 System.Web 程序集等的源代码。

它旨在使调试内置类成为可能，因此作为开发人员的您有更好的机会理解特定类的行为方式。当您尝试使用调试器进入某个函数时，您可以让 Visual Studio 即时下载源代码。 [http://weblogs.asp.net/scottgu/archive/2007/10/03/releasing-the-source-code-for-the-net-framework-libraries.aspx](http://weblogs.asp.net/scottgu/archive/2007/10/03/releasing-the-source-code-for-the-net-framework-libraries.aspx)

如果您想阅读/浏览源代码；您还可以[使用 CodePlex 的 NetMassDownloader 项目](http://www.codeproject.com/KB/dotnet/netmassdownloader.aspx)将其全部下载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T11:55:36.740

[ASP.NET 快速入门教程](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/whatsnew.aspx)最适合您的需求。

在这里您可以访问：[Standart Toolbox 控件教程](http://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/default.aspx)

**编辑：**您编辑了您的帖子以获取服务器组件内部工作的资源。这是我的另一个建议：**Nikhil Kothari**的[开发 Microsoft ASP.NET 服务器控件和组件](https://rads.stackoverflow.com/amzn/click/com/0735615829)是组件和内部工作的最佳资源。

[替代文字 http://ecx.images-amazon.com/images/I/41AQGWDEYAL._BO2,204,203,200_PIsitb-sticker-arrow-click,TopRight,35,-76_AA240_SH20_OU01_.jpg](http://ecx.images-amazon.com/images/I/41AQGWDEYAL._BO2,204,203,200_PIsitb-sticker-arrow-click,TopRight,35,-76_AA240_SH20_OU01_.jpg)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-16T00:31:10.217

查看控件源代码或任何其他类库的快速方法是使用反汇编程序，例如 .NET Reflector[链接文本](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T11:32:48.807

它们都记录在[MSDN](http://msdn.microsoft.com)上。从[ASP.NET 开发人员中心](http://msdn.microsoft.com/en-us/asp.net/default.aspx)和[http://asp.net](http://asp.net)开始。

# iis - 如何将 ASP.NET 2.0 注册到 Web 服务器（IIS7）？

> ID：647598
> 
> 赞同：52
> 
> 时间：2009-03-15T10:15:38.713
> 
> 标签：iis, iis-7, asp.net-2.0

我已经创建了一个网页应用程序，但是当我在 Visual Studio 2008 中打开它时，它会说：

ASP.NET 2.0 尚未在 Web 服务器上注册。您需要为 ASP.NET 2.0 手动配置 Web 服务器，以便您的站点正确运行。

我正在使用 asp.net 2.0、IIS7 并在 vista home premium 上运行。

如何将 ASP.NET 2.0 注册到我的 Web 服务器（IIS7）？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-03-15T10:26:59.793

**ASP .NET 2.0：**

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -ir 
```

**ASP .NET 4.0：**

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_regiis.exe -ir 
```

以管理员身份运行命令提示符以避免`...requested operation requires elevation`错误

* * *

`aspnet_regiis.exe`不应再与**IIS7**一起使用来安装**ASP.NET**

1.  打开控制面板
2.  程序\打开或关闭 Windows 功能
3.  互联网信息服务
4.  万维网服务
5.  应用程序开发功能
6.  **ASP.Net** <== 勾选此处

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-05T14:02:37.697

如果像我这样的人仍然无法使用 IIS 注册 ASP.NET。

您只需要在命令提示符中一一运行这三个命令

> cd c:\windows\Microsoft.Net\Framework\v2.0.50727

之后，运行

> aspnet_regiis.exe -i -enable

最后重置 IIS

> iis重置

希望它可以帮助有需要的人......干杯！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-15T10:25:15.693

如果您在 .Net 框架之后安装了 IIS，您可以通过重新安装 .Net 框架来解决问题。它的部分安装会检测 IIS 是否存在并相应地更新 IIS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-14T06:30:52.140

打开控制面板 - 程序 - 打开或关闭 Windows 功能展开 - Internet 信息服务展开 - 万维网服务展开 - 应用程序开发功能检查 - ASP.Net

建议您检查其他功能以避免将来可能不会给出直接错误消息的问题如果它解决了您的问题以供他人使用，请不要忘记将此问题标记为已回答

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-18T10:03:09.737

我正在使用的系统是带有 IIS 7 的 Windows Server 2008 Standard（我想我的经验将适用于同龄的所有 Windows 系统）。

跑步

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_regiis.exe -ir 
```

似乎工作，因为

```
C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_regiis.exe -lv 
```

展示了在 IIS 中注册的 .Net framework v4。

但是，对于 .Net v2 运行相同，即

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -ir 
```

没有导致

```
C:\Windows\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -lv 
```

显示已注册的框架。

（而且，对我来说，Kofax Capture Network Server 的安装程序仍然缺少 ASP.NET。）

解决方案是：

*   打开服务器管理器
*   转到角色/Web 服务器 (IIS)
*   推送添加角色服务
*   检查应用程序开发下的 ASP.NET（然后按安装）

之后，aspnet_regiis.exe -lv（任一版本）显示已注册的框架。（而且 Kofax 安装程序也很高兴并且工作正常。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-11T21:29:18.037

我通过在 Add/Remove program 中对 .NET framework Extended 执行 Repir 解决了这个问题；

使用win2008R2，.NET框架4.0

# c# - 为什么没有调用 IExpando.AddMethod？

> ID：647605
> 
> 赞同：2
> 
> 时间：2009-03-15T10:24:33.277
> 
> 标签：c#, internet-explorer, interop

我在 Internet Explorer 中托管我的 WinForms 控件。此外，我还实现了 IExpando 接口，以便当 javascript 代码尝试访问它们时，能够在我的 C# 代码中模拟不存在的字段和方法。例如

```
var myobj = new ActiveXObject('server.object');
myobj.Foo = "FooText";
myobj.Bar("BarText"); 
```

请注意，我的 C# 类不包含 Foo 字段和 Bar 方法。IExpando.AddField 将使用参数 name="Foo" 调用，但不会执行 IExpando.AddMethod。如果是 myobj.Bar("BarText"); 只有 IReflect.GetMethods、IReflect.GetProperties 和 IReflect.GetFields 方法将被执行。

有谁知道为什么 IExpando.AddMethod 没有被调用？

谢谢，保罗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-08-16T19:16:07.380

我认为从 js 中，永远不会调用 AddMethod。因为“方法”实际上只是以委托为值的属性。调用这样的函数实际上是获取一个属性然后调用它。

在这种情况下，您将得到一个成员丢失异常，就像使用 js 对象一样。您可以尝试先设置它：

```
var myobj = new ActiveXObject('server.object');
myobj.Foo = 'FooText';
myobj.Bar = function(b) { console.log(b); };
myobj.Bar('BarText'); 
```

那行得通！否则我认为您需要提前了解它并在 GetProperties 中返回它。

# asp.net - ASP.NET 中的 VBox（来自 Flex）

> ID：647608
> 
> 赞同：0
> 
> 时间：2009-03-15T10:26:57.967
> 
> 标签：asp.net, visual-studio, apache-flex, flash, adobe

我在 Adob​​e Flex Builder 的 IDE 中工作了很长时间。ASP.NET 中是否有与 VBox (Flex) 等效的简单方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-16T21:14:35.953

我不相信。如果你阅读[了这篇博文](http://aspnetresources.com/blog/forget_absolute_positioning_in_vs2008.aspx)，你会想要开始磨练你的 CSS 技能。定位似乎是 ASP.net 世界中的热门话题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T21:35:31.393

当您迁移到 ASP.NET 时，您将在本机浏览器环境中工作。Flex、SilverLight 和其他 RIA（富 Internet 应用程序）具有让您完全控制用户体验的优势。通过原生浏览器开发，用户可以控制大量的体验。

这也是它如此受用户欢迎的原因。该死的用户......总是想按**自己的方式做事**。

因此，为了回答您的问题，Visual Studio 中目前没有任何内容可以为您提供类似的体验。

正因为如此，**你会想要提高你的 CSS 技能**。

# eclipse - 在 Eclipse CDT 中隐藏空文件夹和其他文件

> ID：647612
> 
> 赞同：2
> 
> 时间：2009-03-15T10:32:37.690
> 
> 标签：eclipse, eclipse-cdt

在 Eclipse CDT 中，如何过滤导航器和项目视图以隐藏空文件夹和其他不需要的文件类型？

自定义选项似乎有点受限，例如隐藏非 c 内容也隐藏了对我没有帮助的 makefile。

有没有插件可以添加这个功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T10:39:11.730

在项目资源管理器面板中，单击左上角的向下箭头图标 > 自定义视图 > 标记“空文件夹”。

# asp.net - 在 Eclipse 中拖放 Web 项目

> ID：647615
> 
> 赞同：2
> 
> 时间：2009-03-15T10:38:44.757
> 
> 标签：asp.net, visual-studio, eclipse, jakarta-ee

J2EE 或 JSP 的 Eclipse（或 Java 中的任何 IDE）是否有与 Visual Studio 中 ASP.NET 的 IDE 感觉类似的等效拖放样式？ASP.NET 允许您将控件拖放到 Web 表单或网页中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-06T11:34:16.513

[Netbeans IDE](http://www.netbeans.org/)是您问题的答案。您可以像在 Visual Studio 中设计 Asp.NET 页面一样设计 JSP 页面。[这是 Netbeans 的此功能的链接](http://www.netbeans.org/features/web/web-app.html)。

[Netbeans 视觉网页设计 http://www.netbeans.org/images/v6/5/screenshots/visual-web-jsp.png](http://www.netbeans.org/images/v6/5/screenshots/visual-web-jsp.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T10:58:56.627

我不知道 Visual Studio 的功能，但 Eclipse 当然以插件的形式提供可视化编辑器。这是一个 JSP 编辑器的示例 ( [http://www.myeclipseide.com/module-htmlpages-display-pid-12.html](http://www.myeclipseide.com/module-htmlpages-display-pid-12.html) )。还有用于 Swing GUI 等的编辑器。只是谷歌的“可视化编辑器/设计器 eclipse jsp”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-15T14:44:03.007

今天早上我也有同样的问题，所以我下载了 Eclipse 并试图弄清楚（我通常使用 Visual Studio）。在这里，但它显然不如 Visual Studio Design View 强大。创建一个 HTML 文件，然后右键单击该文件并选择网页编辑器。

我是从这里了解到的，很难找到。[http://dev.eclipse.org/newslists/news.eclipse.webtools/msg13837.html](http://dev.eclipse.org/newslists/news.eclipse.webtools/msg13837.html)

我很想看看 VS Design View 和 Eclipse Web Page Editor 之间的比较；似乎为 Internet 构建 UI 仍然（多年后）一团糟。

[Eclipse 网页编辑器的屏幕截图 Eclipse 网页编辑](http://www.petegordon.com/eclipse_web_page_editor.jpg) [器 http://www.petegordon.com/eclipse_web_page_editor.jpg](http://www.petegordon.com/eclipse_web_page_editor.jpg)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-07T15:23:25.137

Visual Web Pack - [http://netbeans.org/community/magazine/html/03/visualwebdev/](http://netbeans.org/community/magazine/html/03/visualwebdev/)，它为您提供创建具有可定制设计的适当页面所需的所有资源。

您对您的 IDE 没有任何限制，所以我可以肯定地说它适用于 NetBeans（不过，仅构建 5.5）。这是一个已停产的项目，但无论已经制作什么，都会持续一段时间。强烈建议。

# javascript - Html 滚动：如何避免它“剪切”我的内部元素

> ID：647619
> 
> 赞同：1
> 
> 时间：2009-03-15T10:40:50.320
> 
> 标签：javascript, jquery, html, internet-explorer, firefox

这个问题是针对自动完成下拉列表的，当您在 html 文本框中书写时，我必须这样做。

它基本上由一个包含建议元素的 div 组成，每个元素也是一个 div。

我到了它开始正常工作的地步，但现在我向包含的 div 添加了一个垂直滚动，这样你就可以限制下拉列表的高度，我得到了以下行为：

如果你使用滚动，它会以“像素”向上或向下滚动，所以它会削减我的元素，使它看起来一点也不圆滑。

当您使用滚动时，我想覆盖上下一个整个 div 元素的行为。我什至不知道如何用谷歌搜索这个......

任何人都知道任何有用的资源，或者可以就从哪里开始提供任何提示，如果可以覆盖滚动移动事件或者我应该寻找另一个方向？

非常感谢提前

注意：我不能使用 jquery 自动完成插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T10:56:53.467

您可以实现自己的滚动条，使用鼠标事件并手动更新位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T12:59:08.430

Could you not tap into a 'scroll' event for that element (DOM 3 Events provides a scroll event for an element, not sure how supported it is), such that whenever the scroll position is changed, it calls a little routine of your own that adjusts the scroll position by rounding it to the nearest 'notch'?

Or, you could regularly poll for the scroll position and adjust it when it has moved. [This scroll position](https://developer.mozilla.org/En/DOM:element.scrollTop#Example) seems fairly cross-browser.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-11T11:02:45.757

第一的：

使用您自己的滚动条，创建一个滚动事件处理程序。在这里，您可以使用动画`delta`（在 中`evt`），您可以通过顶部或底部可见元素的`scrollTop`自己设置元素的 。`offsetHeight`此外，如果 div 高度确实切断了一个元素，只需使前一个或下一个元素“更高”一点，也就是设置它的高度以向上或向下推动被切断的元素。

第二：

您可以“修补” div，因此只有几个元素可见。滚动时隐藏顶部并在动画中显示底部，而不使用 s`crollTop`或`scrollHeight`.

注意 Firefox 中的滚动事件。它有另一个名字，但你可以像这样测试它：

```
eventName = eventName === 'mousewheel' ? ((/Firefox/i.test(navigator.userAgent)) ? "DOMMouseScroll" : eventName) : eventName; 
```

祝你好运。如果您在大约 2 天内需要任何帮助，我将实施它，因为我也需要一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-11T05:37:20.730

**这根本做不到**，没有解决办法，期间。人们必须忍受这种限制。

为什么没有解决方案？

因为即使您实现了自己的滚动条，您仍然必须依赖滚动事件，而且这些事件既不能取消也不能阻止冒泡到 body 元素。真的，它们不能，您可以对它们调用 preventDefault() 和 stopPropagation() 直到奶牛回家并且它们仍然冒泡。这是标准化主体和浏览器实现者的深思熟虑的决定。

如果滚动事件是可取消的，EхpеrtEхchangе 可能会阻止您滚动到页面底部以查看答案；）（别担心，我在“EхpеrtEхchangе”中使用了一些西里尔字母，因此它们不会得到可索引的提及）。

# proxy - 性能调优求教

> ID：647622
> 
> 赞同：0
> 
> 时间：2009-03-15T10:43:14.433
> 
> 标签：proxy, debugging, performance

我发现当我在 Internet 选项中关闭（取消选择）自动检测代理设置时，我的应用程序（涉及大量基于 Http 的网络通信）的性能会大大提高。现在我想证明性能问题实际上是由自动代理检测引起的。

来自调试器或其他方面的任何想法可以证明？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T10:51:44.163

你可以使用[wireshark](http://www.wireshark.org/)来分析你的理论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T19:08:46.700

您可以尝试[Microsoft Visual Round Trip Analyzer (VRTA)](http://www.microsoft.com/Downloads/details.aspx?FamilyID=119f3477-dced-41e3-a0e7-d8b5cae893a3&displaylang=en)。在启用自动代理检测的情况下运行一系列测试，然后在关闭它的情况下运行同一系列测试。重要的是要进行多次测试并在测试中取平均值，以考虑通常的网络随机性。

# ruby-on-rails - 安装 Rails 2.3 RC2 时出错

> ID：647641
> 
> 赞同：2
> 
> 时间：2009-03-15T11:12:49.263
> 
> 标签：ruby-on-rails, rubygems

我正在尝试使用以下命令安装 rails：

```
$ sudo gem install rails --source http://gems.rubyonrails.org 
```

但这就是我得到的：

```
WARNING:  RubyGems 1.2+ index not found for:
        http://gems.rubyonrails.org/

RubyGems will revert to legacy indexes degrading performance.
ERROR:  While executing gem ... (Gem::Package::FormatError)
    No metadata found! 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-17T22:22:40.690

你至少有 gem 版本 1.3.1 吗？Rails 2.2+ 需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T15:35:00.957

当我运行该命令时，它只是尝试重新安装 2.3.1。我昨天正在尝试升级；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-21T12:27:48.067

您当前的来源可能有问题。首先，通过执行以下操作检查源列表：

```
$ gem env | grep \"sources\" 
```

然后，删除任何非标准存储库：

```
$ sudo gem sources -r http://my_nonstandard_source.com 
```

然后尝试再次安装：

```
$ sudo gem install rails --source http://gems.rubyonrails.org 
```

希望这就足够了。

# ruby-on-rails - Ruby/Rails 线程安全

> ID：647642
> 
> 赞同：18
> 
> 时间：2009-03-15T11:13:39.760
> 
> 标签：ruby-on-rails, ruby, multithreading, thread-safety, jvm-languages

我不时地使用 Ruby 进行黑客攻击，但我没有用它做任何大的或多线程的事情。我听说 MRI 只支持绿色线程，而 JRuby 通过 JVM 支持本机线程。然而，我偶然发现博客和讨论组上的评论说“Rails 不是线程安全的”或者 Ruby 本身不是线程安全的。例如，有人评论说 require 语句有问题。这听起来有点基本。

我见过很多不能正确处理并发的 Java 应用程序，我不时对它们做噩梦 :-) 但是，如果你*真的*知道自己在做什么，至少你*可以*用 Java 编写线程安全的应用程序（它是只是不容易）。

 *这一切听起来都令人震惊，有人可以详细说明一下 - 究竟是什么问题，如果是这种情况，Rails 是如何工作的？我可以编写在没有竞争条件和死锁的情况下正常工作的多线程 Ruby 代码吗？它在 JRuby 和 MRI 之间是可移植的，还是我必须破解 JVM 特定代码才能正确利用 JVM 本机线程？

编辑：

我应该问两个问题，因为人们似乎只回答 Rails 线程的东西（这本身很好）和绿色线程与原生线程。我对关于线程*安全*的核心 Ruby 问题的担忧并没有真正得到解决。在某些情况下，require似乎至少存在一个（未解决的？）[问题。](http://www.daniel-azuma.com/blog/view/z4oi2c3bf8t16s/ruby_threads_and_kernel_require)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-16T21:23:04.170

首先，Ruby 1.9（最新的官方版本）[现在使用原生（内核）线程](http://blog.nuclearsquid.com/writings/ruby-1-9-what-s-new-what-s-changed)。早期版本的 Ruby 使用绿色线程。为了简洁地回答您的问题，在 1.9 之前，线程并没有广泛用于大大小小的 Ruby 应用程序，因为它们不是特别安全或可靠。

这并不特别令人担忧，因为在 2.2 版本之前，Rails 没有尝试线程安全，因此我们通常通过使用多进程、数据库记录锁定和[Starling](http://github.com/starling/starling/tree/master)等消息队列来处理异步处理。这通常是扩展 Web 应用程序的一种非常可靠的方法——至少与不正确的多线程 Java 应用程序一样可靠——并且具有额外的优势，即可以更容易地将应用程序横向扩展到多个处理器和服务器。

我不知道您提到的 'require' 问题是否已在 1.9 中得到解决，但我冒昧地冒昧地说，如果您在新线程中动态地需要库，那​​么您会遇到不止一个可维护性问题。

如果您想完全避免使用线程，Ruby 1.9[还支持 Fiber](http://pragdave.blogs.pragprog.com/pragdave/2007/12/pipelines-using.html)，它采用无共享的并发方法，据我所知，通常比线程更容易编写和维护。[性能数字在这里](http://oldmoe.blogspot.com/2008/08/ruby-fibers-vs-ruby-threads.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T20:10:24.837

我真的建议您观看 Jim Weirich 在 RubyConf 2008 上的演讲（非常有趣且内容丰富：）：

[https://www.youtube.com/watch?v=fK-N_VxdW7g](https://www.youtube.com/watch?v=fK-N_VxdW7g)

这个也不错：

[http://rubyconf2008.confreaks.com/summer-of-code-rails-thread-safety.html](http://rubyconf2008.confreaks.com/summer-of-code-rails-thread-safety.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-15T11:34:03.313

The normal solution for MRI is to run multiple Rails instances, each handling requests independently. Since MRI isn't multithreaded anyway, you can't run multiple Rails instances on top of it. This means you take a memory hit since Rails is loaded once per Ruby process.

Since JRuby supports native threads, you could always run several Rails instances in a single JVM. But with Rails being thread-safe, you can cut it down to one, which means lower memory usage and less JIT compilation.

Charles Nutter (JRuby) has a [nice summary](http://blog.headius.com/2008/08/qa-what-thread-safe-rails-means.html).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T04:10:32.217

我认为以前的海报很好地涵盖了 Rails 案例，所以我不会费心去讨论那种东西。

当然可以编写线程化的 Ruby 应用程序。ruby 线程存在的一些问题是它们是“绿色”的，因为它们是由虚拟机管理的。目前，默认解释器 (MRI) 只有一个真正的系统线程，需要由解释器控制的所有线程共享。

这样做的缺点是，如果您的计算机具有多个处理器或内核，则您的应用程序中的线程不能在其他内核上运行。对于运行服务器和高性能应用程序的人来说，这是一件大事。

至于您的解释器特定代码问题：我不这么认为。AFAIK 你不需要做任何特别的事情来处理 JRuby/JVM 线程。

另外：[这篇](http://www.igvita.com/2008/11/13/concurrency-is-a-myth-in-ruby/)关于 Igvita 的文章很好地了解了 Ruby 中的并发状态。

# c# - String.IsNullOrBlank 扩展方法

> ID：647643
> 
> 赞同：14
> 
> 时间：2009-03-15T11:14:22.177
> 
> 标签：c#, extension-methods

我不断检查字符串字段以检查它们是否为空或空白。

```
if(myString == null || myString.Trim().Length == 0)
{
    throw new ArgumentException("Blank strings cannot be handled.");
} 
```

为了节省自己的打字时间，是否可以为 String 类创建一个具有相同效果的扩展方法？我了解如何为类实例添加扩展方法，但是向类添加静态扩展方法呢？

```
if(String.IsNullOrBlank(myString))
{
    throw new ArgumentException("Blank strings cannot be handled.");
} 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-15T11:24:25.193

你可以这样做：

```
public static bool IsNullOrBlank(this String text)
{
  return text==null || text.Trim().Length==0;
} 
```

然后这样称呼它：

```
if(myString.IsNullOrBlank())
{
  throw new ArgumentException("Blank strings cannot be handled.");
} 
```

`null`这是因为 C# 允许您在实例上调用扩展方法。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-11-08T22:29:16.207

我知道这是一个老问题，但由于它被碰撞并且尚未被提及，从 .NET 4.0 开始，您可以简单地使用[String.IsNullOrWhiteSpace 方法](http://msdn.microsoft.com/en-us/library/system.string.isnullorwhitespace.aspx)来实现相同的结果。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-15T11:26:21.990

您可以安全地在实例上使用扩展方法：

```
public static class StringExtensions
{
    public static bool IsNullOrBlank(this string s)
    {
        return s == null || s.Trim().Length == 0;
    }
} 
```

测试用例：

```
string s = null;
Assert.IsTrue(s.IsNullOrBlank());
s = " ";
Assert.IsTrue(s.IsNullOrBlank()); 
```

虽然看起来有点奇怪，但我会弄清楚为什么你的字符串需要经常检查这种情况。如果你从源头上修复它们，你以后就不必对它们如此偏执了！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T11:15:10.363

您可以将静态方法添加到现有类吗？答案是否定的，而且值会很薄，因为您仍然需要知道首先输入哪个类名；使用扩展方法，优点是您从变量名开始，自动完成会向您显示适用于它的内容。

经常提出的另一点是，如果扩展方法的第一个参数为空，则应始终尽快抛出异常。但是，我认为如果该方法在其名称中提到它旨在检查`null`.

您遇到的真正问题是，您希望在检查空引用后整洁且可读地运行一些代码。捕捉这种模式的一种方法是[我对这个问题的回答](https://stackoverflow.com/questions/336775/pipe-forwards-in-c)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-08T13:08:35.647

现有答案的过载可能是：

```
public static bool IsNullOrBlank(this String text, Action<String> doWhat)
{
  if (text!=null && text.Trim().Length>0)
    doWhat(text);
} 
```

如果您只想运行给定有效值的代码，将会很有帮助。

不是一个超级有用的例子，但只是展示了用法：

```
Name.IsNullOrBlank(name=>Console.WriteLine(name)); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T12:27:47.147

```
public static bool IsNullOrEmptyTrimmed(string value)
{
    return (value == null || value.Length == 0) ?
        true : value.Trim().Length == 0;
} 
```

或者

```
public static bool IsNullOrEmpty(this String value, bool checkTrimmed)
{
    var b = String.IsNullOrEmpty(value);
    return checkTrimmed ? (b && value.Trim().Length > 0) : b;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-24T19:52:19.807

有点晚了。但是您也可以将代码放入扩展方法中以引发异常。我有两种方法（for`ArgumentNullException`和`NullReferenceException`）。

```
// strings
public static bool NullBlankCheck(this string s, string message = "",
    bool throwEx = true)
{
    return Check<NullReferenceException>(s.IsNullOrBlank(), throwEx, message);
}
public static bool NullBlankCheckArgument(this string s, string message = "",
    bool throwEx = true)
{
    return Check<ArgumentException>(s.IsNullOrBlank(), throwEx, message);
}

private static bool Check<T>(bool isNull, bool throwEx, string exceptionMessage)
    where T : Exception
{
    if (throwEx && isNull)
        throw Activator.CreateInstance(typeof(T), exceptionMessage) as Exception;
    return isNull;
}

public static bool IsNullOrBlank(this string s)
{
    return string.IsNullOrEmpty(s) || s.Trim().Length == 0;
} 
```

单元测试：

```
Assert.Throws<NullReferenceException>(() =>
{
    "".NullEmptyCheck();
});
Assert.Throws<ArgumentException>(() =>
{
    "".NullEmptyCheckArgument();
}); 
```

然后将其用作：

```
public void Method(string someStr)
{
    someStr.NullBlankCheckArgument();
    // do something
    var str = someMethod();
    str.NullBlankCheck();
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-21T19:12:24.133

虽然这个问题是十多年前提出的，但我看没有人提到有一个内置的字符串方法来处理这个问题。

因此，请`string.IsNullOrWhitespace()`改用。没有破解任何东西，使用语言功能就可以了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-15T23:39:15.287

使用一些技巧，您可以让它看起来像是添加到任何一个**cs**文件中的*String*类：

 **```
namespace JDanielSmith
{
    public static class String
    {
        public static bool IsNullOrBlank(string text)
        {
            return text == null || text.Trim().Length == 0;
        }
    }
} 
```

（注意，这**不是**扩展方法，请参阅我的评论）。

然后，在其他一些 CS 文件中：

```
using String = JDanielSmith.String;
namespace Foo.Bar.Baz
{
    class Program
    {
        static void test(string myString)
        {
            if (String.IsNullOrBlank(myString))
            {
                throw new ArgumentException("Blank strings cannot be handled.");
            }
        }
... 
```

*注意String.IsNullOrBlank()*的“期望”语法。我不一定建议您实际上以这种方式做事，只是指出您可以如何设置以使您的代码正常工作。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-15T12:01:36.447

```
public static bool IsNull(this object o)
{
    return string.IsNullOrEmpty(o.ToStr());
}

public static bool IsNotNull(this object o)
{
    return !string.IsNullOrEmpty(o.ToStr());
}

public static string ToStr(this object o)
{
    return o + "";
} 
```

# c++ - 将类常量存储在数据成员中还是方法中更好？

> ID：647648
> 
> 赞同：1
> 
> 时间：2009-03-15T11:18:48.593
> 
> 标签：c++, constants, members

我最近写了一个渲染 B 样条曲线的类。这些曲线由多个控制点定义。最初，我打算使用八个控制点，所以我在类中添加了一个常量，如下所示：

```
class Curve
{
   public:
      static const int CONTROL_POINT_COUNT = 8;
}; 
```

现在我想扩展这个类以允许任意数量的控制点。所以我想把它改成：

```
class Curve
{
   public:
      int getControlPointCount() {return _controlPointCount;}
}; 
```

问题是在方法中存储常量是否更好，以促进适应性。换句话说，这样开始不是更好吗：

```
class Curve
{
   public:
      int getControlPointCount() {return 8;}
}; 
```

这样做的好处是我可以只更改相关方法中的一个符号，而不是移动常量等。

这是一个好习惯还是坏习惯？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T11:30:04.853

```
int getControlPointCount() {return _controlPointCount;} 
```

这是一个访问器。正如 litb 所指出的那样，为访问器交换 const static 并不是真正的收获。你真正需要*的*可能是一对访问器和修改器。

```
int getControlPointCount() {return _controlPointCount;} // accessor 
```

我还会为访问器添加一个 design-const 并制作它：

```
int getControlPointCount() const {return _controlPointCount;} // accessor 
```

和相应的：

```
void setControlPointCount(int cpc) { _controlPointCount = cpc;} //mutator 
```

现在，与静态对象的最大区别在于控制点计数不再是类级别的属性，而是实例级别的属性。这是*设计上的改变*。你想要这样吗？

*Nit：*您的类级别静态计数是`public`并且因此不需要访问器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T11:28:14.030

为了更好地回答您的问题，还应该知道 controlPointCount 变量的设置方式。它是在您的班级之外设置的吗？在这种情况下，您还应该定义一个 setter。还是 Curve 类是唯一负责设置它的？它是仅在编译时设置还是在运行时设置。

无论如何，即使是这种形式，也要避免使用幻数：

```
int getControlPointCount() {return 8;} 
```

这个更好：

```
int getControlPointCount() {return CONTROL_POINT_COUNT;} 
```

方法的优点是您可以修改内部实现（使用常量值，从配置文件中读取，动态更改值），而不会影响类的外部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T12:04:38.000

通常，我倾向于手动维护尽可能少的联轴器。

曲线中控制点的数量就是曲线中控制点的数量。它不是一个可以随意设置的自变量。

所以我通常会公开一个 const 标准容器引用：

```
class Curve
{   
    private:
        std::vector<Point>& _controlPoints;

    public:      
        Curve ( const std::vector<Point>& controlPoints) : _controlPoints(controlPoints)
        {
        }

        const std::vector<Point>& getControlPoints ()
        {
            return _controlPoints;
        }
}; 
```

如果您想知道有多少控制点，请使用`curve.getControlPoints().size()`. 我怀疑在大多数用例中，无论如何您都需要点数和计数，并且通过公开标准容器，您可以使用标准库的迭代器习惯用法和内置算法，而不是获取计数和调用像`getControlPointWithIndex`循环一样的函数。

如果曲线类中真的没有其他东西，我什至可以做到：

```
typedef std::vector<Point> Curve; 
```

（通常曲线不会自己渲染，因为渲染器类可以包含有关渲染管道的详细信息，从而使曲线纯粹是几何工件）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T11:33:54.233

通常，您的所有数据都应该是私有的，并且可以通过 getter 和 setter 访问。否则你违反封装。也就是说，如果您公开底层数据，您将自己和您的班级锁定在该底层数据的特定表示中。

在这种特定情况下，我会做如下我认为的事情：

```
class Curve
{

   protected:

      int getControlPointCount() {return _controlPointCount;}
      int setControlPointCount(int c) { _controlPointCount = c; }

   private:

      static int _controlPointCount = 0;
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T11:34:52.173

```
class Curve
{   
    private:
        int _controlPointCount;

        void setControlPointCount(int cpc_arg)
        {
            _controlPointCount = cpc_arg;
        }

    public:      
        curve()
        {
            _controlPointCount = 8;
        }

        int getControlPointCount() const
        {
            return _controlPointCount;
        }
}; 
```

我将创建一个这样的代码，使用私有的 set 函数，这样任何主体都无法使用控制点计数，直到我们进入下一阶段的开发......我们更新开始在运行时更新控制点计数。那时，我们可以将这个 set 方法从私有范围移动到公共范围。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T12:15:04.463

在理解这个问题的同时，我对这个例子有一些概念上的问题：

*   `getControlPointCount()`当控制点的数量不受限制时， 返回值是多少？
    *   是MAXINT吗？
    *   它是曲线上当前控制点的数量（从而打破了说这是最大可能点数的逻辑吗？）
*   当您实际尝试使用 MAXINT 点创建曲线时会发生什么？你最终会耗尽内存。

界面本身对我来说似乎有问题。与其他标准集合类一样，该类应该封装其对点数的限制，并且`AddControlPoint()`如果发生大小、内存限制或任何其他违规行为，它应该返回错误。

至于具体的答案，我同意kgiannakakis：成员函数允许更大的灵活性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-15T12:41:24.137

我倾向于通过执行程序对所有“稳定”值使用配置+常量（默认值）。对于无法更改的值（360 度 -> 2 pi 弧度，60 秒 -> 1 分钟）或其更改会破坏正在运行的代码（使其不稳定的算法的最小/最大值）的普通常量。

您正在处理一些不同的设计问题。首先您必须知道控制点的数量是类还是实例级别的值。然后它是否是两个级别中的任何一个级别的常数。

如果所有曲线必须在您的应用程序中共享相同数量的控制点，则它是类级别（静态）值。如果不同的曲线可以有不同数量的控制点，那么它不是类级别的值，而是实例级别的值。

在这种情况下，如果控制点的数量在曲线的整个生命周期内保持不变，那么它就是实例级常数，如果它可以改变，那么它在这个水平上也不是常数。

```
// Assuming that different curves can have different 
// number of control points, but that the value cannot 
// change dynamically for a curve.
class Curve
{
public:
   explicit Curve( int control_points )
      : control_points_( control_points )
   {}
   // ...
private:
   const int control_points_;
};

namespace constant
{
   const int spline_control_points = 8;
}
class Config
{
public:
   Config();
   void readFile( std::string const & file );

   // returns the configured value for SplineControlPoints or
   // constant::spline_control_points if the option does not 
   // appear in config.
   int getSplineControlPoints() const;
};

int main()
{
   Config config;
   config.readFile( "~/.configuration" ); // read config

   Curve c( config.getSplineControlPoints() );
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T12:54:09.893

对于整数类型，我通常使用：

```
class Curve
{
   public:
      enum 
      {
          CONTROL_POINT_COUNT = 8
      };
}; 
```

如果除了类实现之外的任何实体都不需要常量，我在 *.cpp 文件中声明常量。

```
namespace
{
const int CONTROL_POINT_COUNT = 8;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-16T12:22:00.787

一般来说，常量不应该在方法内部定义。您选择的示例有两个独特的功能。首先，它是一个吸气剂；其次，返回的类型是 int。但是定义常量的目的是不止一次地使用它们，并且能够以方便的方式引用它们。键入“8”而不是“controlPointCount”可能会节省您的时间，并且似乎不会产生维护成本，但如果您总是在方法中定义常量，这通常不会是真的。

# python - python，正则表达式拆分和特殊字符

> ID：647655
> 
> 赞同：11
> 
> 时间：2009-03-15T11:24:44.397
> 
> 标签：python, regex, unicode, split

如何使用空格作为分隔符正确拆分包含带有特殊字符的句子的字符串？使用正则表达式拆分方法我无法获得所需的结果。

示例代码：

```
# -*- coding: utf-8 -*-
import re

s="La felicità è tutto" # "The happiness is everything" in italian
l=re.compile("(\W)").split(s)

print " s> "+s
print " wordlist> "+str(l)
for i in l:
    print " word> "+i 
```

输出是：

```
 s> La felicità è tutto
 wordlist> ['La', ' ', 'felicit', '\xc3', '', '\xa0', '', ' ', '', '\xc3', '', '\xa8', '', ' ', 'tutto']
 word> La
 word>  
 word> felicit
 word> Ã
 word> 
 word> ?
 word> 
 word>  
 word> 
 word> Ã
 word> 
 word> ?
 word> 
 word>  
 word> tutto 
```

当我正在寻找类似的输出时：

```
 s> La felicità è tutto
 wordlist> ['La', ' ', 'felicità', ' ', 'è', ' ', 'tutto']
 word> La
 word>  
 word> felicità
 word>  
 word> è
 word>  
 word> tutto 
```

需要注意的是， s 是从另一个方法返回的字符串，所以我不能像这样强制编码

```
s=u"La felicità è tutto" 
```

在 Unicode 和 reg-ex 的官方 python 文档中，我没有找到令人满意的解释。

谢谢。

亚历山德罗

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-15T11:32:00.510

你的正则表达式应该是`(\s)` 这样的`(\W)`：

```
l = re.compile("(\s)").split(s) 
```

上面的代码将为您提供您请求的确切输出。但是，以下行更有意义：

```
l = re.compile("\s").split(s) 
```

它在空白字符上拆分，并且不会为您提供所有空格作为匹配项。不过，您可能需要它们，所以我发布了两个答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T11:36:49.017

尝试为正则表达式定义编码：

```
l=re.compile("\W", re.UNICODE).split(s) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T12:59:43.000

我认为在这种情况下使用正则表达式有点过头了。如果您唯一要做的是将字符串拆分为空格字符，我建议您使用字符串上的`split`方法

```
s = 'La felicità è tutto'
words = s.split() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-13T05:17:58.203

使用 unicode 正则表达式将起作用，只要您给它一个 unicode 字符串开头（您在提供的示例中没有）。试试这个：

```
s=u"La felicità è tutto" # "The happiness is everything" in italian
l=re.compile("(\W)",re.UNICODE).split(s)

print " s> "+s
print " wordlist> "+str(l)
for i in l:
    print " word> "+i 
```

结果：

```
 s> La felicità è tutto
 wordlist> [u'La', u' ', u'felicit\xe0', u' ', u'\xe8', u' ', u'tutto']
 word> La
 word>  
 word> felicità
 word>  
 word> è
 word>  
 word> tutto 
```

您的字符串`s`是作为一种`str`类型创建的，并且可能采用 utf-8 编码，这与 unicode 不同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T14:22:00.947

好吧，在对 Andrew Hare 的回答进行了一些进一步测试之后，我发现 ()[]- 等字符不再被视为分隔符，而我想用由字母数字值集最终扩展为重音字符（即，在 unicode 中标记为字母数字的所有内容）。因此，kgiannakakis 的解决方案更正确，但它错过了将字符串 s 转换为 unicode 格式的过程。

以第一个示例的扩展为例：

```
# -*- coding: utf-8 -*-
import re
s="(La felicità è tutto)"#no explicit unicode given string (UTF8)
l=re.compile("([\W])",re.UNICODE).split(unicode(s,'utf-8'))#split on s converted to unicode from utf8

print " string> "+s
print " wordlist> "+str(l)
for i in l:
    print " word> "+i 
```

现在的输出是：

```
 string> (La felicità è tutto)
 wordlist> [u'', u'(', u'La', u' ', u'felicit\xe0', u' ', u'\xe8', u' ', u'tutto', u')', u'']
 word> 
 word> (
 word> La
 word>  
 word> felicità
 word>  
 word> è
 word>  
 word> tutto
 word> )
 word> 
```

这正是我正在寻找的。

干杯:)

亚历山德罗

# user-interface - 使用系统调用的 Common Lisp GUI 编程

> ID：647661
> 
> 赞同：3
> 
> 时间：2009-03-15T11:27:16.903
> 
> 标签：user-interface, common-lisp, system-calls, sbcl

谁能告诉我有关使用（钢铁银行）Common Lisp 通过系统调用编写 GUI 的信息？我知道那里有一些图书馆，但这是一个语言学习练习，所以我想自己做。

我正在 Kubuntu 8.10 和 SBCL 1.0.18 上开发。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-16T03:05:12.827

您可以仔细查看[sb-posix-package](http://www.sbcl.org/manual/sb_002dposix.html#sb_002dposix)。但正如页面所说“SB-UNIX 软件包中包含的功能仅供 SBCL 内部使用；其内容可能会因版本而异。”

另一种可能性 - 我会选择 - 是通过 CFFI 包含 C-syscall(2)-Instruction [，](http://www.cliki.net/CFFI)然后执行它。

要创建一个窗口 GUI，您必须使用 X11，至少要给您一个窗口来绘画。因此，您必须了解 X11-Specifications 才能创建窗口，并实现访问 Unix Domain Sockets 或启动 shm-devices 等的 Syscalls。

如果您只想在控制台上显示图形，您可以考虑使用 framebuffer-device `/dev/fb*`。您需要 ioctl(2) 和用于 read(2)ing 和 write(2)ing 的系统调用才能使用它，但我认为这比使用 X11 容易得多（尽管仍然有很多工作）。也许您应该查看 libFB 的源代码[或](http://www.brownhat.org/libFB.html)类似的东西以了解如何初始化它等。

这真的是你想做的吗？这是很多工作，你会学到很多，但更多的是关于 linux 系统基础架构，而不是关于 SBCL，我想。如果您想在 SBCL 下使用 Syscalls，也许最好尝试仅使用 Linux-Syscalls 打开 TCP-Sockets - 仅此一项可能需要数小时的挫败感。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T12:30:55.113

通过系统调用编写 GUI，您的意思是不使用任何 GUI 工具包，例如 Gtk+ 或 Qt？在这种情况下，您应该通过套接字直接与 X-server 对话，并在其上实现所有 X11 协议（或使用 CLX）和 GUI。但这不是最简单的任务，因为 X11 很复杂。

如果您决定深入研究 X11，有一些规范链接：[http://www.xfree86.org/current/specindex.html](http://www.xfree86.org/current/specindex.html) [http://www.freedesktop.org/wiki/Specifications?action=show&redirect=Standards](http://www.freedesktop.org/wiki/Specifications?action=show&redirect=Standards)

# performance - BizTalk 端口/编排过滤性能开销

> ID：647679
> 
> 赞同：1
> 
> 时间：2009-03-15T11:46:03.207
> 
> 标签：performance, routing, biztalk

请考虑 BizTalk 2006 中的以下情况：

收到的消息应根据以下约束路由到编排或发送端口

```
(Message.Type = "SomeType" AND Message.Sender = "SomeSender")
OR
(Message.Type = "SomeOtherType" AND Message.Sender = "SomeOtherSender" AND Message.IsSigned = true)
OR
(Message.Sender = "AnotherSender" AND Message.IsSigned = true)
etc... 
```

一种方法是在编排接收形状或发送端口上应用过滤器。

另一方面，我可以根据消息字段将路由数据字段提升到自定义接收管道组件中的消息上下文，然后仅对过滤器应用一个约束：

```
Message.Route = "Route A" 
```

这些替代方案中的哪一个是性能成本较低的解决方案（较低的延迟）？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T13:58:53.613

在这两个选项之间，我通常会选择编排过滤器。订阅的实现非常快，因此过滤几个片段并不是很大的开销。

拥有一个流水线组件并提升一个不能保证更快的属性，并且在开发和维护方面是开销。

在我看来，编排过滤器有一点缺点（但是 - 从你的问题看来，你不一定会让它变得更好），这就是编译规则的事实（例如，与发送端口过滤器不同)

如果您需要它更加动态，并且您可以编写您的管道组件，以便它是可配置的，这会给您带来一些好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T18:48:37.670

影响延迟的主要因素是持久点的数量（将状态保存到数据库）。

如果备选方案 2（在管道中提升“路由”）允许您完全取消编排（或者您是否需要它来做其他事情？）并让您拥有一个纯消息传递解决方案（端口到端口），那会更快当在那里有一个编排时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-22T20:56:12.647

如果您有一类发件人（正如您所看到的那样），您还可以考虑使用派对/角色链接实现，这将为您提供额外的灵活性。

# perl - 如何在 Perl 中将文本插入字符串？

> ID：647685
> 
> 赞同：5
> 
> 时间：2009-03-15T11:49:45.990
> 
> 标签：perl, insert, variables

如果我有：

```
$foo= "12."bar bar bar"|three"; 
```

我将如何在文本 12\. 之后在变量中插入文本“..”？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-15T13:40:18.597

Perl 允许您选择自己的引号分隔符。如果您发现需要在插值字符串 (ie ) 内使用双引号`""`或在非插值字符串 (ie `''`) 内使用单引号，您可以使用[引号运算符](http://perldoc.perl.org/perlop.html#Quote-and-Quote-like-Operators)指定不同的字符作为字符串的分隔符. 分隔符有两种形式：带括号的和不带括号的。括号定界符有不同的开始和结束字符：`[]`, `{}`, `()`, `[]`, 和`<>`. 所有其他字符`*`都可用作不带括号的分隔符。

所以你的例子可以写成

```
$foo = qq(12."bar bar bar"|three); 
```

在“12”之后插入文本。可以通过多种方式完成（[TIMTOWDI](http://en.wikipedia.org/wiki/There_is_more_than_one_way_to_do_it)）。一种常见的解决方案是使用[替换](http://perldoc.perl.org/perlop.html#s/PATTERN/REPLACEMENT/msixpogce)来匹配要替换的文本。

```
$foo =~ s/^(12[.])/$1../; 
```

^ 表示匹配字符串的开头，`()`表示将此文本捕获到变量`$1`中，`12`仅匹配字符串`"12"`，`[]`表示匹配括号内的任何一个字符。使用括号是因为`.`通常在正则表达式中具有特殊含义，但在字符类（`[]`）中没有。字符类的另一种选择是逃避`.`with的特殊含义`\`，但很多人发现它比字符类更丑陋。

```
$foo =~ s/^(12\.)/$1../; 
```

将文本插入字符串的另一种方法是将值分配给对[`substr`](http://perldoc.perl.org/functions/substr.html). 这突出了 Perl 相当独特的特性之一：它的许多函数都可以作为左值。也就是说，它们可以被视为变量。

```
substr($foo, 3, 0) = ".."; 
```

如果您还不知道`"12."`字符串中存在的位置，您可以使用[`index`](http://perldoc.perl.org/functions/index.html)它来查找它的开始位置，[`length`](http://perldoc.perl.org/functions/length.html)以找出“12”的长度。是，然后将该信息与`substr`.

这是一个包含上述代码的全功能 Perl 脚本。

```
#!/usr/bin/perl

use strict;
use warnings;

my $foo = my $bar = qq(12."bar bar bar"|three); 

$foo =~ s/(12[.])/$1../;

my $i = index($bar, "12.") + length "12.";
substr($bar, $i, 0) = "..";

print "foo is $foo\nbar is $bar\n"; 
```

`*`除空白字符（空格、制表符、回车符、换行符、垂直制表符和换页符）之外的所有字符

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T12:06:29.117

如果你想在 Perl 的字符串中使用双引号，你有两个主要选择：

```
$foo = "12.\"bar bar bar\"|three"; 
```

或者：

```
$foo = '12."bar bar bar"|three'; 
```

第一个选项使用反斜杠转义字符串内的引号。

第二个选项使用单引号。这意味着双引号被视为字符串的一部分。但是，在单引号中，所有内容都是文字，因此`$var`或`@array`不被视为变量。例如：

```
$myvar = 123;
$mystring = '"$myvar"';
print $mystring;
> "$myvar" 
```

但：

```
$myvar = 123;
$mystring = "\"$myvar\"";
print $mystring;
> "123" 
```

您还可以使用大量其他[类似引用的运算符](http://perldoc.perl.org/perlop.html#Quote-Like-Operators)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T12:18:15.487

```
 $foo = "12.\"bar bar bar\"|three";
$foo =~s/12\./12\.\.\./;
print $foo; # results in 12...\"bar bar bar\"|three" 
```

# c# - 如何从 C# 方法返回 JavaScript“本机”数组？

> ID：647696
> 
> 赞同：7
> 
> 时间：2009-03-15T12:01:01.283
> 
> 标签：c#, javascript, interop, com-interop

我正在尝试使用以下方法从 JavaScript 调用 C# 方法`ActiveXObject`：

```
var myobj = new ActiveXObject('myobject');
var arr = myobj.GetArray(); 
```

最终，`arr`将包含一个`SAFEARRAY`对象，但不包含`JScript`数组。有没有办法从 C# 方法返回本机 JavaScript 对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-15T12:07:49.550

您可以返回[JSON](http://www.json.org/)字符串，然后解析为 JavaScript 对象。有许多 .NET 库可用于将 .NET 对象序列化为 JSON，反之亦然

*   [JSON.NET](http://james.newtonking.com/projects/json-net.aspx)
*   [Microsoft ASP.NET AJAX 库](http://www.asp.net/ajax/)
*   [JSONSharp](http://code.google.com/p/jsonsharp/)

仅举几例。

这个[问题和答案](https://stackoverflow.com/questions/596593/when-creating-a-javascriptconverter-how-to-return-an-array)可能对你有用

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-16T09:08:15.963

我自己找到了解决方案，但是这部分没有文档。解决方法是`JScript.ArrayObject`按以下方式使用：

```
ArrayObject _lastField;
byte[] byteArray = new byte[]{2,1,2,3};
object[] array = new object[byteArray.Length];
byteArray.CopyTo(array, 0);
_lastField = Microsoft.JScript.GlobalObject.Array.ConstructArray(array); 
```

之后，您将能够`_lastField`像使用原生数组一样在 JavaScript 中使用该数组：

```
var myobj = new ActiveXObject('myobject');
var arr = myobj.LastField;
alert(arr[1]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-03T07:31:20.240

您可以在 C# 中[返回分隔的连接字符串](http://www.asptricks.net/2016/05/return-array-string-in-activex-c-solved.html)，并可以拆分为 JavaScript

```
//C#
public string getArryString()
{
string[] arrstring = new string[]{"1","2","3"};
return string.Join(",", arrstring);
}

//Javascript
var arrstring = objActiveX.getArryString().split(','); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-07T15:18:23.660

通过 VBArray 它可以像这样工作：

1.  从 C# 返回 object[]（在 dispinterface 中声明）。

2.  要在 JScript 中获取本机 JS 数组，请使用 VBArray：

    ```
    var jsArray = new VBArray(myobj.GetArray()).toArray();
    for (i = 0; i < jsArray.length; i++) 
    {
       // use jsArray[i]
    } 
    ```

背景资料：

*   JScript 仅支持 SafeArrays of Variants [http://blogs.msdn.com/b/jaiprakash/archive/2007/01/09/jscript-supports-safearrays-of-variants-only.aspx](http://blogs.msdn.com/b/jaiprakash/archive/2007/01/09/jscript-supports-safearrays-of-variants-only.aspx)

*   Eric 的可编写脚本对象模型类型签名的完整指南 [http://blogs.msdn.com/b/ericlippert/archive/2004/07/14/183241.aspx](http://blogs.msdn.com/b/ericlippert/archive/2004/07/14/183241.aspx)

# qt - qt add path for 3rd party header and libraries

> ID：647698
> 
> 赞同：0
> 
> 时间：2009-03-15T12:02:01.483
> 
> 标签：qt, path, include

I am using qt and developing a desktop app that will run under win xp/vista.

I have a 3rd party library UserAgentLib (static, and shared). But I am not sure how to link in qt creator.

I have opened the *.pro file and added my library and header path. The library is called UserAgentLib and the header file is called UserAgentLib.h

```
TARGET = Dialer
TEMPLATE = app

LIBS += D:\Projects\qtDialer\tools\lib\UserAgentLib
INCLUDEPATH += D:\Projects\qtDialer\tools\inc

SOURCES += main.cpp\
        catdialer.cpp

HEADERS  += catdialer.h

FORMS    += catdialer.ui 
```

I think it does find the header file, as I get about 100 errors for declarations in the UserAgentLib.h file. However, I don't think it is linking with the library.

Many thanks for any suggestions,

======================

I have create a very simple library in VS C++ 2008\. Here is the code for the header and source file. Header:

```
// mathslibrary.hpp
int add_numbers(const int a, const int b); 
```

Source:

```
// mathslibrary.cpp
#include "mathslibrary.hpp"
int add_numbers(const int a, const int b)
{
return a + b;
} 
```

I have compiled this into a library. And tested by linking with a WIN32 console application in VS 2008\. The library worked as expected.

Now when I try and link with qt.

```
#include <QtCore/QCoreApplication>
#include <iostream>
#include "mathslibrary.hpp"
int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);
    std::cout << "add numbers 40 + 60 = " << add_numbers(40, 60) << std::endl;
    return a.exec();
} 
```

This is my qmake file:

```
QT       -= gui
TARGET = testlibrary
CONFIG   += console
CONFIG   -= app_bundle
TEMPLATE = app
LIBS = D:\Projects\TestLibrary\mathsLibrary\Debug\mathsLibrary.lib
INCLUDEPATH = D:\Projects\TestLibrary\mathsLibrary\
SOURCES += main.cpp 
```

These are the errors I get when I try and build:

c:/Qt/mingw/bin/../lib/gcc/mingw32/3.4.5/../../../libmingw32.a(main.o):main.c::-1: error: undefined reference to `WinMain@16'

:-1: error: collect2: ld returned 1 exit status

And these are the compile issues:

Running build steps for project testlibrary...

Creating gdb macros library...

Configuration unchanged, skipping QMake step.

Starting: C:/Qt/mingw/bin/mingw32-make.exe debug -w

mingw32-make: Entering directory `D:/Projects/TestQTLibrary/testlibrary'

C:/Qt/mingw/bin/mingw32-make -f Makefile.Debug mingw32-make[1]: Entering directory `D:/Projects/TestQTLibrary/testlibrary'

g++ -enable-stdcall-fixup -Wl,-enable-auto-import -Wl,-enable-runtime-pseudo-reloc -Wl,-subsystem,console -mthreads -Wl -o debug\testlibrary.exe -L"c:\Qt\qt\lib"

D:\Projects\TestLibrary\mathsLibrary\Debug\mathsLibrary.lib -lQtCored4 mingw32-make[1]: Leaving directory `D:/Projects/TestQTLibrary/testlibrary'

mingw32-make: Leaving directory `D:/Projects/TestQTLibrary/testlibrary'

c:/Qt/mingw/bin/../lib/gcc/mingw32/3.4.5/../../../libmingw32.a(main.o):main.c:

(.text+0x104): undefined reference to `WinMain@16' collect2: ld returned 1 exit status mingw32-make[1]: *** [debug\testlibrary.exe] Error 1 mingw32-make: *** [debug] Error 2 Exited with code 2. Error while building project testlibrary When executing build step 'Make'

Many thanks for any advice,

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T23:24:56.727

不知道这是否会改变任何东西，但也许你必须像这样定义它：

```
LIBS += -LD:/Projects/qtDialer/tools/lib -lUserAgentLib 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T12:16:14.897

If you are getting compiler errors then your `UserAgentLib.h` probably didn't get included. You can test it with:

```
!exists( UserAgentLib.h ) {
 error( "No UserAgentLib.h file found" )
} 
```

*You put the above in one of the `.pro` file and not the constructor.See [this](http://doc.trolltech.com/4.2/qmake-tutorial.html).*

If the library didn't get linked (which is after your application has compiled well) -- then you need to tinker with your `LIBS += ...` line, though which appears fine on first glance.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-20T05:38:26.370

据我了解，您使用 MSVC 生成了一个 dll，现在您正尝试使用 mingw 在 Qt 中链接它。正确的？

> 使用不同编译器，甚至使用同一编译器的显着不同版本创建的目标文件和静态库通常无法链接在一起。此问题并非特定于 MinGW：许多其他编译器相互不兼容。如果可以的话，使用相同版本的相同编译器从源代码构建所有内容

检查一下：[http ://chadaustin.me/cppinterface.html](http://chadaustin.me/cppinterface.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T20:00:23.270

首先尝试使用简单的库，然后尝试使用您实际尝试使用的库。

```
 LIBS += D:\Projects\qtDialer\tools\lib\mathsLibrary.lib 
```

在您的 .hpp 文件中，在函数声明之前添加 extern "C"：

```
// mathslibrary.hpp
extern "C" int add_numbers(const int a, const int b); 
```

从 Visual Studio 重建库。

现在您应该可以使用 Qt Creater 编译您的测试应用程序了。然后将相应的 dll 复制到包含新可执行文件的目录中并运行它。

# c++ - 为什么 getcwd() 不符合 ISO C++ 标准？

> ID：647704
> 
> 赞同：17
> 
> 时间：2009-03-15T12:07:58.023
> 
> 标签：c++, iso

[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms235450.aspx)指出 getcwd() 已被弃用，应该改用与 ISO C++ 兼容的 _getcwd，这就提出了一个问题：是什么让 getcwd() 不符合 ISO 标准？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-15T13:22:03.290

有一个[很好的讨论](https://groups.google.com/group/comp.os.ms-windows.programmer.misc/msg/e668fa9f36e57c67)。[PJ Plauger](http://en.wikipedia.org/wiki/PJ_Plauger)回答了这个问题

> 我是那个在 1983 年坚持将 C 程序可用的名称空间划分为：
> 
> **a)**由实现为程序员的利益而定义的那些（例如 printf）
> **b)**为程序员保留的那些（例如 foo）
> **c)**为实现保留的那些（例如 _unlink）
> 
> 即使在那时我们也知道“实现”过于单一——通常不止一个来源提供了部分实现——但这是我们当时能做的最好的事情。标准 C++ 引入了命名空间来提供帮助，但它们只实现了其既定目标的一小部分。（当你标准化纸老虎时会发生这种情况。）
> 
> 在这种特殊情况下，Posix 提供了一个类别 (a) 名称列表（例如 unlink），当且仅当您包含某些标头时，您应该定义这些名称。由于 C 标准从 Unix（与 Posix 相同的来源）窃取了它的头文件，因此其中一些头文件在历史上是重叠的。尽管如此，编译器警告应该以某种方式考虑支持的环境是“纯”标准 C++（柏拉图式的理想）还是混合的 C/C++/Posix 环境。微软目前帮助我们这些可怜的程序员的尝试没有考虑到这一点。它坚持把unlink当作一个(b)类名，是短视的。

好吧，GCC 不会在严格的 C 模式下声明 POSIX 名称，至少（尽管它仍然在 C++ 模式下如此）：

```
#include <stdio.h>

int main() {
    &fdopen;
    return 0;
} 
```

输出使用`-std=c99`

```
test.c: In function 'main':
test.c:4: error: 'fdopen' undeclared (first use in this function) 
```

您必须通过使用功能测试宏或不通过任何特定标准明确告诉它您正在混合 C/Posix 中操作。然后，它将默认`gnu89`采用混合环境 ( `man feature_test_macros`)。显然，MSVC 没有这种可能性。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-15T12:17:23.100

标准中未指定的函数应该以下划线为前缀，以表明它们是特定于供应商的扩展或遵循非 ISO 标准。因此，这里的“合规性”是微软在这个特定函数的名称中添加下划线，因为它不是 ISO 标准的一部分。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T12:28:16.397

正如其他人已经指出的那样，getcwd 不包含在 ISO C++ 中，而是[POSIX](http://www.opengroup.org/onlinepubs/009695399/functions/getcwd.html) /IEEE Std 1003.1 的一部分。

Microsoft 已决定在其 C 标准库中包含一些最常用的 POSIX 函数（但在这些函数前加上下划线以从本质上阻止它们的使用）。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-07T19:04:23.970

作为记录，`getcwd()`ISO 并未弃用。它被微软“弃用”。Microsoft 重写了许多 C 函数——通常考虑到更好的安全性（例如，也接受`max_length`参数的字符串函数）。然后他们让他们的编译器吐出这些警告，我认为这是虚假的，因为没有标准组弃用任何声明为弃用的函数。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-15T12:13:42.110

据我所知，getcwd() 从未成为 ISO 标准 C++ 的一部分。_getcwd() 绝对不是，因为标准名称不会以下划线开头。

事实上，MSDN 文章链接到一个手册页，说明它是在**direct.h**中声明的，它不是标准 C++ 头文件。这篇文章在我看来是假的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-15T12:19:12.627

要添加到 Dan Olson 的帖子：请参阅MSDN 上的[ANSI C 合规性页面](http://msdn.microsoft.com/en-us/library/45aft37a.aspx)

> Microsoft 特定函数和全局变量的名称以下划线开头。这些名称只能在您的代码范围内本地覆盖。例如，当您包含 Microsoft 运行时头文件时，您仍然可以通过声明同名的局部变量来本地覆盖名为 _open 的 Microsoft 特定函数。但是，您不能将此名称用于您自己的全局函数或全局变量。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-01-27T23:28:06.183

MSDN 文章对于普通人从快速阅读中得出的结论有些令人困惑（如果他们没有以非常仔细的律师眼光阅读它）。

MSDN 文章说的是：getcwd() 不符合 ISO C++ 标准。为了遵守函数命名的 ISO C++ 标准（这是 getcwd 违反的），微软在函数的前面正确地放了一个 _，所以同样的函数变成了 _getcwd()。这是符合 ISO C++ 的函数命名方式，因为 getcwd() 和 _getcwd() 不是 ISO C++ 标准函数，而是 Microsoft（供应商）特定或实现特定函数。

这篇文章没有说明获取工作目录的 C++ ISO 标准调用是什么……尽管人们往往一眼就能读到。

# c++ - 作为没有CS学位的程序员，我是否必须广泛学习C++？

> ID：647705
> 
> 赞同：4
> 
> 时间：2009-03-15T12:08:00.627
> 
> 标签：c++, c

我是一名有 2 年经验的程序员，我曾在 4 个地方工作过，我真的认为自己是一个自信、流利的开发人员。

我的大多数同事都有CS学位，我真的感觉没有任何区别！然而，为了与这些人保持一致，我学习了 C（从新手到专业人士的 C 入门）、使用 C 的 DataStructures 以及使用 C++ 的 OOP。

我对指针、内存管理有一个合理的理解，并且我还参加了一项奖学金，其中 C、DataStructures 和 C++ 是其中的一部分。

我要说明的是，我对 C 和 C++ 的熟悉程度不超过阅读一些页面和执行一些演示；**我没有使用 C 或 C++ 参与过任何项目**。

最近我的一个朋友建议我广泛学习 C 和 C++，然后转向 OpenGL 并学习图形编程。他说，我通过学习这些主题可能获得的见解将真正帮助我作为一名程序员的整个生命。

PS：我是一名全职开发人员，主要使用 C# 开发 ASP.NET 应用程序。

**建议**？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T12:13:03.407

**实际进步：**

从实际意义上讲，选择一种适合您想要工作的领域的语言。

对于大多数编程空间，无需学习 C 或 C++。你可以成为一个完全称职的程序员，而无需用这些语言编写一行代码。

但是，如果您不喜欢在您现在所在的确切领域工作，您可以学习 C 或 C++，这样您就可以找到较低级别的编程工作。

**帮助您成为更好的程序员：**

不过，您可以从学习多种语言中学到很多东西。因此，以这种方式拓宽视野总是好的。

如果您想获得更多其他语言的经验，但还没有尝试过，我建议您学习一门函数式编程语言，例如 Scheme、Lisp 或 Haskell。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-15T14:23:22.267

首先，拥有学位与了解 C++ 无关。我认识几个从 CS 毕业但从未写过超过 50 行 C/C++ 的人。CS*与*编程无关（就像手术*与*刀具无关），当然也与个别语言无关。计算机科学学位要求你在去其他地方的路上用几种不同的语言戳你的鼻子。CS 教授基本概念、对编译器、操作系统、运行代码的硬件、算法和数据结构以及许多其他引人入胜的主题的理解。但它不教编程。CS 毕业生的任何编程经验几乎都是偶然的。这是他在飞行中学到的东西，或者是因为个人对编程的兴趣。

其次，让我们明确一点，在不了解 C++ 的情况下，很有可能拥有成功的编程生涯。事实上，我希望大多数程序员都属于这一类。所以你当然*不需要*学习 C++。

这留下了学习 C++ 的两个可能原因：

1.  自我提升
2.  改变职业轨迹

#2 很简单。如果你想过渡到 C++ 是主要语言的领域，学习它显然是一个好主意。你提到了图形编程作为一个例子，如果你想以此为生，学习 C++ 可能是一个好主意。（但是，我认为这对于“有助于您作为程序员的整个生活的见解”并不是一个特别好的建议。还有其他更普遍适用的领域。学习图形编程将教您图形编程，而且不多别的。）

剩下的 #1 更有趣。仅仅通过了解 C++，你会成为一个更好的程序员吗？也许，但并不像某些人想象的那么多。C++ 可能会教给你一些有用的东西，但似乎也有一些关于它的迷信：它是低级的，有指针，所以通过学习 C++，你将获得启蒙。

如果您想了解幕后发生的事情，C 或 C++ 肯定会有所帮助，但您可以省去中间人，直接学习编译器。那会给你一个更好的主意。补充一些关于 CPU 工作原理的基本信息，以及一些关于操作系统的知识，你已经比从 C++ 学到的所有底层知识都要好得多。

但是，我认为有些东西值得从 C++ 中学习，没有特别的顺序：

（其中一些可能会让你对 C# 感到绝望，尽管它采用了许多出色的特性，但仍然遗漏了一些对 C++ 程序员来说似乎非常明显的特性）

*   偏执狂：精通 C++ 意味着成为一名语言律师。该语言留下了很多未定义或未指定的东西，所以一个好的 C++ 程序员是偏执的。“我刚刚编写的代码*看起来*还不错，运行时似乎还不错 - 但它是否符合标准？明天会在他的计算机上损坏，还是在我使用更新的编译器进行编译时会损坏？我必须检查标准”。这在其他语言中不太必要，但随身携带可能仍然是一种健康的体验。有时，编译器没有最终决定权。
*   RAII：C++ 开创了一种非常聪明的方法来处理资源管理（包括可怕的内存管理）。在堆栈上创建一个对象，该对象在其构造函数中获取相关资源（数据库连接、内存块、文件、网络套接字或其他任何东西），并在其析构函数中确保释放该资源。这种简单的机制意味着您几乎从不在顶级代码中编写 new/delete，它总是隐藏在构造函数或析构函数中。并且因为析构函数保证在对象超出范围时执行，所以即使抛出异常，你的资源也保证被释放。没有内存泄漏，没有未关闭的数据库连接。C# 不直接支持这一点，但熟悉该技术有时会让您看到一种在 C# 中模拟它的方法，在有用的情况下。（显然内存管理不是问题，但确保快速释放数据库连接可能仍然是）
*   通用编程、模板、STL 和元编程：C++ 标准库（或通常称为 STL 的部分）是库设计的一个非常有趣的例子。在某些方面，它领先于 .NET 或 Java 的类库，尽管 LINQ 修补了 .NET 的一些最严重的缺点。了解它可能会让您对处理序列或数据集的巧妙方法有一些有用的见解。它还具有强烈的函数式编程风格，总是很有趣。它是根据模板实现的，这是 C++ 的另一个显着特性，模板元编程也可能对学习有益。不是因为它直接适用于许多其他语言，而是因为它可能会给你一些想法，让你也可以用其他语言编写更通用的代码。
*   直接映射到硬件：C++ 不一定是低级语言。但是它的大部分抽象已经被建模，因此它们*可以*被实现以直接映射到常见的硬件特性。这意味着它可能有助于更好地理解托管 .net 代码和另一端 CPU 之间发生的“魔法”。CLR是如何实现的，堆和栈到底是什么意思，等等。
*   p/invoke：让我们面对现实吧，有时 .NET 并不能提供您需要的功能。您必须调用一些非托管代码。然后，实际了解您可能使用的语言会很有用。（如果您只需一个 pinvoke 调用就可以绕过它，您只需要能够读取 MSDN 上的 C 函数签名，以便知道要传递哪些参数，但有时，编写自己的 C++ 包装器可能更好，并且而是打电话给那个。

我不知道你是否应该学习C++。这样做可以使您成为更好的程序员是有正当理由的，但是话又说回来，您可以花很多时间在其他事情上，这些事情也会使您成为更好的程序员。这是你的选择。:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-15T12:30:23.663

*经验是最好的老师。*

虽然您可以阅读诸如内存管理、数据结构（及其实现）、算法等内容，但在您有机会将其付诸实践之前，您不会真正了解它。虽然我不知道是否真的有必要使用 C 或 C++ 来学习这些东西，但我会付出一些努力来实际编写一些管理自己的内存并实现一些常见数据结构的代码。我想你会学到一些东西来帮助你更好地理解你的代码；可以这么说，知道引擎盖下到底发生了什么。我还建议阅读计算机组织和操作系统、计算机安全和布尔逻辑。另一方面，我从来没有真正发现需要进行任何 OpenGL 编程，尽管我曾经做过一些 X Windows 的东西。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-15T12:35:02.560

拥有学位实际上与 C/C++ 无关。现在，诸如大 O() 估计、数据结构甚至数学背景之类的东西。例如线性代数结果非常有用，即使在看似无关的上下文中（例如搜索引擎）。

例如，一个好的编码器，但没有任何理论知识，可能犯的典型错误是尝试通过精确算法而不是近似来解决[NP 完全问题。](http://en.wikipedia.org/wiki/Np_complete)

现在，为什么在大学里他们教你 C/C++？因为它让你看到它是如何“在引擎盖下”工作的。您有机会了解调用堆栈是如何工作的、内存管理是如何工作的、指针是如何工作的。当然，您不需要这些知识来使用大多数现代语言。但是你需要它来理解他们的“魔法”是如何运作的。例如。如果您不了解指针和内存分配，您将无法理解 GC 的工作原理。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-15T12:59:45.370

我经常问这个问题（对自己）。我认为更通用的版本是，“如果我不知道如何使用一种没有自动垃圾收集、指针和所有'复杂'东西'的语言，我怎么能称自己为程序员？” 除了做一些 HelloWorlds 之外，我从来没有学过 C++，所以我的答案受到了这种缺乏的限制：

我认为你需要学习 C++（或真正的汇编程序）的感觉来自于你总是在研究**别人的**抽象：编写 JVM、CLR 等等的“火箭科学家”。**因此，如果您可以使用较低级别的语言，您将真正知道您在说什么。**我认为这是非常错误的。一个总是建立在一组抽象之上：即使是 Assembler 也被翻译成二进制，这也是可以学习的。除此之外，即使你有一把钳子和一点钛，你仍然无法用木柴制造电脑。

根据我作为软件开发（主要是 Java）企业培训师的经验，最好的人**不是**那些了解 C++ 的人，而是**那些将他们正在使用的语言作为“游戏”的独立空间的人。**尽管内存管理**在**C# 和 Java 中一直出现，但除了将对象从引用中释放出来（以及其他一些陈词滥调的地方，比如使用流而不是在内存中扔出巨大的对象）之外，您永远不必考虑其他任何事情。指针和所有这些东西对你没有帮助，除非作为通行权（我敢肯定，这是一个很好的通行权）。

因此，总而言之，使用您所使用的语言工作，并尽可能多地扩展**相关**内容。这些天我发现自己沉浸在 Javascript 中，尽管 API 应该使这变得不必要，并且在我手动处理 CSS 的同时在 Fireworks 中做一些事情。**这是**除了我在 RoR、PHP 和 Actionscript 中所做的开发之外的所有内容。**所以我的观点是：专注于你需要的抽象，因为它们比作为你平台基础的低层次的东西更有可能相关。**

**编辑：**我对 jalf 的评论做了一些细微的修改，谢谢。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-15T15:23:30.487

我拥有一等软件工程学位，在一家大型游戏机制造商工作，在一个程序员团队中开发游戏引擎，所有程序员都使用从 Asm 到 C++ 到 C# 到 LUA 的各种语言进行编程，并且对硬件了如指掌。

我想说，我 5% 的学位是有用的，而且到目前为止，促进我的职业生涯最重要的特质是热情和自我发展。

事实上，与我共事过的许多同事都没有学位，而且平均而言可能是更好的人。

我会说这是因为他们不得不用他们在自己的业余时间开发的实际工作代码替换大学学位的那张纸，从他们自己的背后学习技能，而不是用勺子喂它。

我的驾驶教练曾经告诉我，我只有在通过考试后才开始学习如何驾驶，也就是说，您只能从基础知识的实际应用中真正学习。计算机科学学位为您提供基础知识，如果您从事任何一种主要语言的编程工作 6 个月，您就已经具备这些基础知识。学位只是打开了你可能没有的大门——一旦进入大门，它就没有多大帮助。

了解软件如何通过声音与硬件交互是目前对您来说最重要的领域，只有这样“神秘”或“魔法”才会真正消失，您才能对在其他地方谈论的内容充满信心。学习 C 和 C++ 无疑会在这方面有所帮助，就像了解 OpenGL 之类的 API 一样。

But I'd say the most important thing is to find something you have interest in and code that. If you have real enthusiam for it you will naturally learn more low level information and become a better programmer, if indeed that is what your definition of being a better programmer is!

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-15T12:18:16.763

我作为一名没有学位的开发人员已经工作了将近 15 年。我从 Ada 开始，然后很快转向 C/C++，但根据我的经验，总会有一些语言是你“必须学习的”。如果不是 C++，它将是 C#、C、Java 或 Lisp。我的建议是确保你掌握适用于任何语言的基础知识（作为没有学位的开发人员，我最好的朋友是 CLR 书），并且你应该能够相对轻松地在语言和框架之间移动。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-15T12:35:38.393

您不一定非要学习 C/C++，但两种语言都会教您思考您的软件如何与底层操作系统和硬件交互，这是一项基本技能。你说你已经知道指针、内存管理等等，这很好。许多没有 CS 学位的程序员缺乏这方面的重要知识。

学习 C/C++ 的另一个好理由是，有很多代码是用这些语言编写的，而了解更多编程知识的好方法是阅读其他人的代码。如果您对编写驱动程序、操作系统、文件系统等低级代码感兴趣，C/C++ 几乎是唯一的出路。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-15T12:13:27.057

你必须广泛地学习它吗？我希望不会。

但是，最好始终学习可以帮助您从不同角度看待编程的东西。学习 C 或 C++ 是值得的，因为它可以深入了解事物在较低级别是如何工作的。对于 C 和 C++ 程序员来说，同样的事情可以通过学习汇编来完成。大多数人不会在项目中使用汇编，但有时了解它的工作原理会很有帮助。

我的建议是尽可能多地学习。如果您在不久的将来不从事 C++ 项目，我不会太担心学习细节，但是能够从另一个角度看待问题总是好的，学习新语言是一种方法去做。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-15T12:25:43.300

今天对于大多数应用程序来说，C 和 C++ 可以被视为一种学术练习：“我们如何编写没有垃圾收集的程序？”

答案是：你可以，但这是一次非常痛苦的经历。C++ 中最佳实践的大部分细节都与缺乏垃圾收集有关。

鉴于现代 GC 的出色性能，以及计算能力的普遍提高，如今即使是手机也有 GC。在带有 GC 的平台中，您始终可以以限制您对 GC 施加的压力的方式进行编码。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-03-15T12:31:33.393

收听或阅读[SO podcast 44](https://stackoverflow.fogbugz.com/default.asp?W29034)，其中 Joel 播放他最喜欢的歌曲[**Write in C**](http://www.youtube.com/watch?v=XHosLhPEN3k)

> 斯波尔斯基：是的，无论如何它都没有向披头士支付版权费。我们将从展示说明中链接到该链接。很棒的一首歌，用C写的。
> 
> Atwood：没错，Joel 最喜欢的歌曲。用 C 写一切，因为 Joel 实际上用 C 写一切，不是吗，Joel？
> 
> Spolsky：我开始使用一点点 C99，它是 C 的最新版本，它可以让你在编写一些语句后声明变量。
> 
> ...

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-03-15T13:20:36.333

如果没有专业的理由（除了自我提升的良好实践）来学习 C 或 C++，那么您应该计划一个充满激情的项目，您可以用 C 或 C++ 编写。一旦副业变得艰难，你需要你的热情和好奇心来带你渡过难关（因为在副业中，你自然不会有支付的动力或对即将到来的上司失去动力你）。

此外，现在大多数 CS 学位都使用 Java 作为他们的首选语言。这只是证明了在选择语言和接触学位中其他课程所涉及的一些理论方面获得的经验是拥有 CS 学位的人的主要好处，而不是特定语言（尽管我认为抽象等级越高，从长远来看对学生来说越糟糕）。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-15T12:29:26.347

如果没有学习编程语言的实际理由，这是非常困难的。如果您能想到该语言适合的特定问题或特定任务 - 那么学习体验是由需求驱动的，而不是简单的学术。

我只是最近才从 VB 切换到 C#（1 个月前），但与从 C# 切换到 C 并没有显着不同，因为我因为一个特殊的原因而切换，我发现它更容易学习。我以前涉足过没有具体问题要解决，不用说我转回去了

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-15T12:31:11.633

如果您的学习方式与自学方式不同，那么我建议您成为一名更好的程序员，那就是研究与您的领域相关的主题。从下到上，慢慢爬上梯子。不同的程序员有相当多的，没有人会一帆风顺，所以不要从这个背景开始。

祝你好运。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-03-15T13:00:06.307

C++ 只是一种编程语言。其他学生（如果他们在课堂上专心听讲的话）所没有的是通过学习概念获得的更深入的理解。

成为一名程序员不是也不应该成为任何 CS 毕业生的最终目标。然而，就大多数人而言，没有这样的学位。

这是一个类比：工程师和建筑师都在某个时候学习使用 CAD 绘制建筑物。此外，完全没有受过培训的人可以进来并开始使用 CAD 工作并且非常有效。这是一个很好的职业，而且报酬很高，但对于工程师和建筑师来说，这并不是你 30 岁时想要成为的地方。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-15T14:59:43.413

了解 C 的一个价值在于，包括 C#、Java、C++、JavaScript、Python 和 PHP 在内的许多其他语言都起源于 C 语法。

另一个价值，可以说更重要的是，它会建立你的信心。程序员是一个自信的群体，非常乐观（你必须自信地认为你可以写出相当于 1000 页的书，没有一个拼写或语法错误）。有了一个或两个纯 C 应用程序，您对学习和有效使用任何语言的能力的信心就会大大增强。

所以用 C 写一个不平凡的程序；至少读取和写入文件、分配和释放内存以及管理数据结构（如队列或二叉树）的东西。

你的信心会感谢你。

# division - ZX81 BASIC 中的快速整除检查

> ID：647721
> 
> 赞同：3
> 
> 时间：2009-03-15T12:20:00.053
> 
> 标签：division, z80, zx81

由于许多 Project Euler 问题需要您多次进行整除性检查，因此我一直试图找出在[ZX81](http://en.wikipedia.org/wiki/ZX81) BASIC 中执行此任务的最快方法。

到目前为止，我已经比较`(N/D)`了`INT(N/D)`是否`N`可以除以`D`。
一直在想用[Z80机器码](http://en.wikipedia.org/wiki/Zilog_Z80#The_Z80_assembly_language)做测试，还没想清楚如何在机器码中使用BASIC中的变量。

如何实现？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-12-16T23:08:08.120

您可以通过重复减法在机器代码中非常快速地做到这一点。基本上你有一个像这样的程序：

```
set accumulator to N
subtract D
if carry flag is set then it is not divisible
if zero flag is set then it is divisible
otherwise repeat subtraction until one of the above occurs 
```

8 位版本将类似于：

```
DIVISIBLE_TEST:
LD B,10
LD A,100

DIVISIBLE_TEST_LOOP:
SUB B
JR C, $END_DIVISIBLE_TEST
JR Z, $END_DIVISIBLE_TEST
JR $DIVISIBLE_TEST_LOOP

END_DIVISIBLE_TEST:
LD B,A
LD C,0
RET 
```

现在，您可以使用 USR 从基本呼叫。USR 返回的是 BC 寄存器对中的任何内容，因此您可能想要执行以下操作：

```
REM poke the memory addresses with the operands to load the registers
POKE X+1, D
POKE X+3, N
LET r = USR X
IF r = 0 THEN GOTO isdivisible
IF r <> 0 THEN GOTO isnotdivisible 
```

[这是我写给 Z80 的介绍，应该可以帮助您解决这个问题。](http://www.worldofspectrum.org/Z80.html)如果您不熟悉这些标志，这将解释它们。尽管它是 Spectrum 而不是 ZX81 的重点，但主站点上有更多指向 Z80 好东西的链接。

16 位版本将非常相似，但使用寄存器对操作。如果您需要超过 16 位，它会变得更加复杂。

你如何加载它取决于你——但传统的方法是使用 DATA 语句和 POKE。不过，您可能更喜欢让汇编程序为您找出机器代码！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T12:29:15.910

您现有的解决方案可能已经足够好了。如果您发现它是分析中的瓶颈，请仅将其替换为更快的东西。

（当然是板着脸说。）

无论如何，在 ZX81 上，您只需切换到 FAST 模式即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T13:02:36.020

不知道 RANDOMIZE USR 是否在 ZX81 中可用，但我认为它可以用来调用汇编中的例程。要传递参数，您可能需要在执行 RANDOMIZE USR 之前使用 POKE 设置一些固定的内存位置。

我记得在 ROM 中找到了一个支持 ZX Basic 的例程列表。我敢肯定有几个可以执行浮动操作。

浮点的替代方法是使用定点数学。在这种没有数学协处理器的情况下，它要快得多。

您还可以在 Sinclair 用户问题中找到更多信息。他们在 ZX Spectrum 上发表了一些与编程相关的文章

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T12:29:01.980

您应该首先将这些值放在一些预先知道的内存位置。然后使用 Z80 汇编器中的相同位置。两者之间没有参数传递。

这是基于我（仍然）记得的 ZX Spectrum 48。祝你好运，但你可能会考虑升级你的硬件。;/

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T12:44:04.440

Z80 机器代码的问题在于它没有浮点运算（就此而言，也没有整数除法或乘法）。在 Z80 汇编器中实现您自己的 FP 库并非易事。当然，你可以使用内置的 BASIC 例程，但你也可以坚持使用 BASIC。

# winapi - 如何在管道上使用 WriteFile 修复乱码文本？

> ID：647723
> 
> 赞同：4
> 
> 时间：2009-03-15T12:21:35.633
> 
> 标签：winapi, named-pipes

我正在制作一个 Win32 应用程序，它通过命名管道将字符串从一个进程发送到另一个进程。但是，在管道上调用 ReadFile 的进程会获取其中包含一些乱码数据的字符串。它返回正确写入的字节数，但字符串的最后 8 个字符左右是乱码。

这是创建管道并写入管道的代码：

```
myPipe = CreateNamedPipe(L"\\\\.\\pipe\\testpipe", PIPE_ACCESS_OUTBOUND, PIPE_NOWAIT, 10, 512, 512, 10, NULL);
TCHAR title[128];
GetWindowText(foundHwnd, title, 128);
wstring windowTitle(title);
vector<wstring> splitVec;
boost::split(splitVec, windowTitle, boost::algorithm::is_any_of(wstring(L"|")));
WriteFile(myPipe, splitVec[0].c_str(), splitVec[0].size(), &wrote, NULL); 
```

这是读取它的代码：

```
if (WaitNamedPipe(L"\\\\.\\pipe\\testpipe", 5000) == 0) {
    MessageBox(NULL, L"Unable to wait for pipe", L"Error", MB_OK);
    return false;
}

myPipe = CreateFile(L"\\\\.\\pipe\\testpipe", GENERIC_READ, FILE_SHARE_READ, NULL,
    OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
if (myPipe == INVALID_HANDLE_VALUE) {
    MessageBox(NULL, L"Unable to open pipe", L"Error", MB_OK);
    return false;
}
    // Other code here...
    TCHAR buf[512];
    DWORD read;
    success = ReadFile(myPipe, buf, 512, &read, NULL);
    if (read > 0)
        MessageBox(NULL, buf, L"Got Data", MB_OK); 
```

当显示 MessageBox 时，字符串的结尾是乱码，我不知道为什么。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T13:13:20.720

我认为这里的关键是确保你的字符串是空终止的，并且你也发送终止字符。如果通信是同步的，或者您在`PIPE_READMODE_MESSAGE`. 当读取指定数量的字节或在管道的另一端完成写入操作时，ReadFile 将返回。我相信“乱码”文本在管道客户端的读取缓冲区中确实是垃圾，并且因为您没有传输字符串终止字符，所以它包含在发送到消息框的文本中。要么在发送之前清除你的读取缓冲区，要么在消息中发送字符串终止字符，我认为它可以在没有发送完整缓冲区的开销的情况下工作。

这是来自 MSDN的[示例客户端。](http://msdn.microsoft.com/en-us/library/aa365592(VS.85).aspx)请注意客户端如何准确发送消息中的字符数**+ 1**（包括终止字符）并接收到大小为 512 的固定缓冲区。如果您查看[服务器示例](http://msdn.microsoft.com/en-us/library/aa365588(VS.85).aspx)，您将看到相同的模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-15T12:26:34.937

对您发布的代码的一些观察：

*   您需要 1) 显式发送空终止字节，或 2) 将一个附加到您读取的数据。
*   由于您正在读取 512 个字节，因此您还应该发送 512 个字节。
*   您可以改为发送可变长度字符串，方法是先发送字符串的大小，然后发送那么多字节。这样，当您读取数据时，您将知道要为实际字符串读取多少字节。
*   一旦您通过管道发送 2 件东西，您所做的事情就会出现问题，并且您在第一次阅读时阅读了您真正想要的内容。
*   如果您只通过管道发送 1 个东西，您可以保留您的代码，但在写入管道时发送 size() + 1。
*   ReadFile / WriteFile 旨在发送二进制数据，不一定是字符串。因此，您可以创建一个名为 ReadString 和 WriteString 的函数，以实现我关于首先读取/写入大小然后是实际字符串的建议。

尝试这样的事情：

这是创建管道并写入管道的代码：

```
myPipe = CreateNamedPipe(L"\\\\.\\pipe\\testpipe", PIPE_ACCESS_OUTBOUND, PIPE_NOWAIT, 10, 512, 512, 10, NULL);
TCHAR title[128];
GetWindowText(foundHwnd, title, 128);
WriteFile(myPipe, title, 128*sizeof(TCHAR), &wrote, NULL);//<---In this case we are sending a null terminated string buffer. 
```

这是读取它的代码：

```
if (WaitNamedPipe(L"\\\\.\\pipe\\testpipe", 5000) == 0) {
    MessageBox(NULL, L"Unable to wait for pipe", L"Error", MB_OK);
    return false;
}

myPipe = CreateFile(L"\\\\.\\pipe\\testpipe", GENERIC_READ, FILE_SHARE_READ, NULL,
    OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
if (myPipe == INVALID_HANDLE_VALUE) {
    MessageBox(NULL, L"Unable to open pipe", L"Error", MB_OK);
    return false;
}
    // Other code here...
    TCHAR buf[128];
    DWORD read;
    success = ReadFile(myPipe, buf, 128*sizeof(TCHAR), &read, NULL);
    if (read > 0)
        MessageBox(NULL, buf, L"Got Data", MB_OK); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-01T14:38:12.217

在编写通用函数以从在命令提示符处执行的任何进程中读取标准输出时，我遇到了“管道中的垃圾”这个问题。因此，我无法更改写入管道的内容（正如通常建议的那样），我只能更改读取端。于是，我“作弊”了。

如果管道数据没有以空终止符结尾，我将最后一个字符替换为一个！它似乎对我有用。我完美地看到了这项工作，在我的数据块末尾有空值和没有空值的地方。

我担心我可能会丢失一个关键的最后一个字符（你可能会！），但就我的直接目的而言，这并没有发生。在某些情况下，您可能会考虑添加 null 而不是替换结尾...

这是代码片段：

```
const unsigned int MAX_PIPE_PEEKS = 100;
DWORD bytesInPipe = 0;
unsigned int pipePeeks=0;
while( (bytesInPipe==0) && (pipePeeks < MAX_PIPE_PEEKS) )
{
    bSuccess = PeekNamedPipe( g_hChildStd_OUT_Rd, NULL, 0, NULL, 
                              &bytesInPipe, NULL );
    if( !bSuccess ) return bSuccess;  // Bail on critical failure                
    ++pipePeeks;
}
if( bytesInPipe > 0 )
{
    // Read the data written to the pipe (and implicitly clear it)
    DWORD dwRead; 
    CHAR *pipeContents = new CHAR[ bytesInPipe ];    
    bSuccess = ReadFile( g_hChildStd_OUT_Rd, pipeContents, 
                         bytesInPipe, &dwRead, NULL );
    if( !bSuccess || dwRead == 0  )  return FALSE;  // Bail on critical failure              

    // "Cheat" - eliminate garbage at the end of the pipe
    if( pipeContents[ bytesInPipe ] != '\0' )
        pipeContents[ bytesInPipe ] = '\0';
} 
```

更新：

经过进一步测试，我发现这不太可靠（令人震惊，是吧？）。我认为对于一个相对简单的解决方案，我走在正确的轨道上。让这个快速补丁工作的任何想法？

# .net - How to solve XAML designer error: The document contains errors that must be fixed before the designer can be loaded

> ID：647726
> 
> 赞同：7
> 
> 时间：2009-03-15T12:24:28.730
> 
> 标签：.net, visual-studio-2008, xaml, assemblies

I have a XAML file that references custom controls defined into another assembly. It compiles and works perfectly at runtime, but the XAML designer is choking and does not show the design content.

```
<Window x:Class="MyProgram.AboutWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:copy="clr-namespace:MyCompany.Common.CopyProtection;assembly=Common"
    Title="About Box" Height="400" Width="400" SizeToContent="Height">
    <copy:RegistrationPanel  />
</Window> 
```

The class MyCompany.Common.CopyProtection is loacted inside the Common assembly, which is in the references for this project. The class is public, and freshly built.

I am using Visual Studio Express 2008 with .NET 3.5 SP1\. Here are the errors:

> **Problem Loading**
> 
> The document contains errors that must be fixed before the designer can be loaded. Reload the designer after you have fixed the errors.
> 
> **Error 1** The type 'copy:RegistrationPanel' was not found. Verify that you are not missing an assembly reference and that all referenced assemblies have been built.
> **Error 2** Assembly 'Common' was not found. Verify that you are not missing an assembly reference. Also, verify that your project and all referenced assemblies have been built.

Anybody knows how to solve those errors so I can start using the designer again. The designer is pratical to select XAML elements and quicly jump into XAML code.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T14:37:00.473

VS2008 附带的 WPF 设计器除了最简单的任务外，还不足以完成所有任务。我的建议是不要使用它，而是尽可能使用 Blend，或者[Kaxaml](http://www.kaxaml.com/)用于较小的 XAML 测试。

我通过将 .xaml 扩展名映射到标准 XML 编辑器来完全关闭 XAML 编辑器。这缩短了加载时间，并避免了由 XAML 设计器吐出的所有这些烦人的“错误”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T12:30:27.483

I had a problem with this where I had styles as StaticResource, after changing these into DynamicResource it worked well for me.

# version-control - 如何使用 Visual SourceSafe 管理版本？

> ID：647736
> 
> 赞同：2
> 
> 时间：2009-03-15T12:29:47.830
> 
> 标签：version-control, visual-sourcesafe

我的团队正在使用 VSS，但我们在管理版本时遇到了困难：

我们想为我们正在处理的项目拍摄“快照”，这样我们就可以继续处理它，但是当我们需要时——我们可以获取快照的文件并构建它们以用于发布。（这叫做分支吗？）

或者，按日期获取所有项目文件也很棒。（这意味着我会在指定日期之前获得项目中每个文件的最后签入版本。）

有没有关于这个的教程？我在网上搜索了一下，只找到了非常简单的howto。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T13:12:56.073

正如 Cannonade 所写，标签可能就是您想要的。但是由于您在问题中明确提到了分支，因此您应该注意标签和分支之间的区别：

使用**标签**，您只需标记源安全数据库（存储库）中所有文件的当前状态。例如，如果您创建了标签“V1.0”，您现在可以随时轻松地准确检索该状态并重建 V1.0 版本。

使用**分支**，您可以创建存储库当前状态的副本。例如，如果您创建一个名为“1.0”的副本，那么您可以继续开发，例如向 V2.0 发展。如果您需要修复 V1.0 的错误，那么您可以在“1.0”分支上执行此操作。

因此，分支应该用于并行处理项目的不同版本。然后应该使用标签来标记分支上的特殊版本（例如，用于创建发布的版本）。

最后一点：SourceSafe 没有特定的“分支”命令。相反，您“共享”您的解决方案并选择“共享后分支”选项。[您可以在MSDN](http://msdn.microsoft.com/en-us/library/ms181038%28VS.80%29.aspx)中找到有关它的更多信息。

最后一点：大约 1.5 年前，我们停止使用 SourceSafe，转而使用[subversion](http://subversion.tigris.org/)（开源且免费）。看看颠覆或其他解决方案。我无法想象回到 SourceSafe。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T12:35:08.847

您可以将标签应用于源安全的当前快照（如 BUILD1），然后在以后根据该标签获取树。

# .net - 热键控制的 .NET 等效项

> ID：647750
> 
> 赞同：4
> 
> 时间：2009-03-15T12:35:51.123
> 
> 标签：.net, windows, winforms, controls, hotkeys

[Hotkey Control](http://msdn.microsoft.com/en-us/library/bb775233(VS.85).aspx)的 .NET 等效项是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T13:22:42.570

.Net 中没有 HotKey 控件的实现，但您可以创建一个从 TextBox 派生的自定义控件。一种可用于窃取的此类实现是[here](http://www.codeproject.com/KB/buttons/hotkeycontrol.aspx)

# c# - 阻止开发人员调用 System.Windows.Forms.Application.DoEvents() 的最佳方法是什么？

> ID：647754
> 
> 赞同：3
> 
> 时间：2009-03-15T12:41:49.593
> 
> 标签：c#, .net, vb.net

我们只花了 300 工时在现场修复了一个有缺陷的应用程序。这一切都归结为调用 Application.DoEvents（重入问题）。

这在设计审查和代码审查中没有发现。该代码是在两年前与第一个版本一起插入的；该应用程序总是“不稳定”，但最近的更改在更大程度上暴露了重入问题。

此事件是我们组织中第二次 Application.DoEvents 导致故障和多工时的调试。在这种情况下，它是通过简单地注意到调用而发现的，该调用被埋在异步任务的复杂事件处理程序中。

您有什么建议可以防止此问题再次发生：

*   将签入门添加到源代码控制？
*   开发人员培训？
*   代码分析规则（为什么这还不是内置规则？）

如何执行编码实践？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-15T12:48:05.960

每次集中构建应用程序时，在每个程序集上运行它：

```
ildasm MyAssembly.exe /TEXT 
```

然后搜索输出：

```
System.Windows.Forms.Application::DoEvents 
```

如果找到，将构建标记为失败，就好像它是编译错误一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T13:00:39.813

维护开发标准并将其添加到其中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T12:47:01.390

上述所有的。您需要先教人们规则，然后才能期待任何成功的机会。您可能还想告诉人们，为什么这些规则很重要。

遵循可以防止您违反规则的工具始终是一个好主意。您的具体问题可以通过 FxCop 规则甚至签到策略来解决。

相关问题：[你们有编码标准吗？如果是这样，它们是如何执行的？](https://stackoverflow.com/questions/377218/do-you-have-coding-standards-if-so-how-is-it-being-enforced)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-15T14:58:06.567

防止这种情况的更有效方法是编写一个 FxCop 规则来标记此 API 的使用。如果在构建过程中启用了 FxCop，这将尽早消除它，构建

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T12:48:24.820

我建议对异步编程（使用 BeginInvoke）进行一些培训，并在另一个线程的后台执行耗时的任务。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-03T19:30:18.360

除了试图阻止调用被使用之外，还有一种方法可以让它更有可能遇到这样的问题（以及其他问题）：

> 在你的代码中使用大量的 ASSERT。

我在我的应用程序（[MSQuant](http://msquant.sourceforge.net/)）中遇到了类似的问题，使用 DoEvents() 和重入。但它在我自己的测试期间被 ASSERT 早早发现了，并且从未影响任何用户。

ASSERT 可以及早发现错误，我节省了很多很多很多小时的调试时间。此外，他们可能会发现一些未被注意到的错误（例如，产生不正确的结果）。

这是一种非常有效的做法（高回报率）。很多年前我就知道了它，从那以后就一直在使用它。当然，它不会取代其他实践：完善的软件工程、单元测试、代码标准、验收测试、代码检查。

请注意，触发 ASSERT 不一定会导致 ASSERT 对话框（停止正常执行或停止用户工作）或中止程序。它可以配置为将信息发送到日志系统（例如文件），通过网络等。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-15T15:58:12.227

“我们刚刚花了 300 个工时在现场修复一个有缺陷的应用程序。这一切都归结为调用 Application.DoEvents（重入问题）。”

首先让我说，我不提倡使用 Application.DoEvents 来随意使用，而是编写一个 for x as long = 0 到 long.maxvalue 循环而没有一个，看看 UI 的响应性如何。

在不知道到底发生了什么的情况下，很难说这是否真的是问题所在。

```
Private Sub foo()
    stpw.Reset() : stpw.Start()
    Do
    Loop While stpw.ElapsedMilliseconds < 1000
    stpw.Stop()
    Debug.WriteLine("foo")
End Sub
Dim stpw As New Stopwatch
Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
    Debug.WriteLine("")
    Debug.WriteLine("but click")
    Dim t As New Threading.Thread(AddressOf foo)
    t.Start()
    Do
        Threading.Thread.Sleep(10)
        'Application.DoEvents() 'uncomment to change the behavior
    Loop While stpw.IsRunning
    Debug.WriteLine("but exit")
End Sub 
```

所以可以说我最初写它时没有冒犯性的声明，但用户抱怨 UI 没有响应。因此，我随后添加了 DoEvents，但现在当用户双击该按钮时，我得到了奇怪的结果。是 DoEvents 的问题还是只是糟糕的设计。在这种情况下，我会投票支持糟糕的设计。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-15T16:45:12.707

没有 DoEvents 是否会使这个“好”代码？

```
Private Sub Button4_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button4.Click
    'simulate a long running task
    For x As Long = 1 To Long.MaxValue - 1
        'the absence of Application.DoEvents() is poor design IMHO
    Next
End Sub 
```

# vb6 - Visual Basic 6.0 中的自动类型转换

> ID：647762
> 
> 赞同：5
> 
> 时间：2009-03-15T12:51:04.440
> 
> 标签：vb6, types

当我们在 Visual Basic 6.0 中将浮点数转换为整数时，它如何舍入小数部分？我说的是自动类型转换。

如果我们分配喜欢

```
Dim i as Integer
i=5.5
msgbox i 
```

它会打印什么？5个还是6个？？

几个月前我得到了“5”。有一天它开始给我6！知道出了什么问题吗？微软是否发布了一些补丁来修复某些问题？

更新：5.5 转换为 6 但 8.5 转换为 8！

更新 2：添加 CInt 没有区别。CInt(5.5) 给出 6，Cint(8.5) 给出 8！！有点奇怪的行为。我应该尝试类似 floor(x + 0.49);

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T13:45:18.710

**更新：**经过一番谷歌搜索，我发现[了以下文章](http://www.tech-archive.net/Archive/VB/microsoft.public.vb.general.discussion/2004-02/4374.html)：

> 这不是一个“错误”，它是 VB 设计的工作方式。它使用一种称为银行家四舍五入的方法，如果数字恰好以 5 结尾并且您想四舍五入到 5 前面的位置，则如果 5 位置前面的数字是偶数，它会向下舍入数字，否则向上舍入。它应该防止使用四舍五入的数字进行重复计算，这样答案就不会总是向上倾斜。有关此问题的更多信息，您可能想知道，请参阅此链接
> 
> [http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q196652](http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q196652)

这解释了（明显的）奇怪的行为：

```
Cint(5.5) 'Should be 6'
Cint(8.5) 'Should be 8' 
```

**旧更新：** 也许您应该更明确：使用`CInt`，而不是简单地将浮点数分配给整数。例如：

```
Dim i as Integer
i = CInt(5.5)
MsgBox i 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-16T09:14:04.373

部分内容在 VB6 帮助中：主题*类型转换函数*。不幸的是，这是 MSDN 网站上的[VB6 文档](http://msdn.microsoft.com/en-us/library/aa314411%28VS.60%29.aspx)中没有的主题之一，但如果您安装了 VB6 帮助，它就会在那里。

> 当小数部分正好是 0.5 时，**CInt**和**CLng**总是将其四舍五入到最接近的偶数。例如，0.5 舍入到 0，1.5 舍入到**2。CInt**和**CLng**与**Fix**和**Int**函数不同，后者截断而不是舍入数字的小数部分。此外，**Fix**和**Int**始终返回与传入的类型相同的值。

隐式类型强制 - 又名[“邪恶类型强制 (PDF)”](http://vb.mvps.org/articles/pt199511.pdf) - 从浮点数到整数使用与**CInt**和**CLng**相同的舍入规则。手册中的任何地方似乎都没有记录此行为。

如果你想在小数部分 >= 0.5 时向上取整，否则向下取整，一个简单的方法是

```
 n = Int(x + 0.5) 
```

在我的*脑海*中，这是我对[Mike Spross 函数](https://stackoverflow.com/a/649262/1951708)的简短版本，它是 VB6 Round 函数的替代品。

```
 'Function corrected, now it works. 
Public Function RoundNumber(ByVal value As Currency, Optional PlacesAfterDecimal As Integer = 0) As Currency
  Dim nMultiplier As Long
  nMultiplier = 10 ^ PlacesAfterDecimal
  RoundNumber = Fix(0.5 * Sgn(value) + value * nMultiplier) / CDbl(nMultiplier)
End Function 
```

样本输出：

```
Debug.Print RoundNumber(1.6)       '2'
Debug.Print RoundNumber(-4.8)      '-5'
Debug.Print RoundNumber(101.7)     '102'
Debug.Print RoundNumber(12.535, 2) '12.54' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T12:58:58.617

改变的行为听起来确实令人担忧，但正确答案 surley 是 6。向下滚动到[Wikipedia 上的“四舍五入法”，四舍五入](http://en.wikipedia.org/wiki/Rounding)以获得解释。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-16T04:22:02.783

正如其他人已经指出的那样，您看到的“奇怪行为”是由于 VB6在舍入小数值时 使用了[银行家的舍入。](http://www.xbeat.net/vbspeed/i_BankersRounding.htm)

> 更新 2：添加 CInt 没有区别。CInt(5.5) 给出 6，Cint(8.5) 给出 8！！

这也是正常的。`CInt`在执行转换之前总是四舍五入（再次使用银行家的四舍五入方法）。

如果您有一个带有小数部分的数字并且只是想截断它（忽略小数点后的部分），您可以使用 the`Fix`或`Int`函数：

```
Fix(1.5) = 1
Fix(300.4) = 300
Fix(-12.394) = -12 
```

`Int`工作方式与 相同`Fix`，除了它将负数向下舍入到下一个最小的负数：

```
Int(1.5) = 1
Int(300.4) = 300
Int(-12.394) = -13 
```

如果您真的想根据大多数人熟悉的规则对数字进行*四舍五入*，则必须编写自己的函数来完成。下面是一个舍入示例，当小数部分大于或等于 0.5 时将舍入，否则舍入：

* * *

**编辑**：有关此功能的更简单（可能更快）的版本，*请参阅[MarkJ 的答案](https://stackoverflow.com/questions/647762/type-conversion-visual-basic-6-0/649716#649716)。*

* * *

```
' Rounds value to the specified number of places'
' Probably could be optimized. I just wrote it off the top of my head,'
' but it seems to work.'
Public Function RoundNumber(ByVal value As Double, Optional PlacesAfterDecimal As Integer = 0) As Double

    Dim expandedValue As Double
    Dim returnValue As Double
    Dim bRoundUp As Boolean

    expandedValue = value
    expandedValue = expandedValue * 10 ^ (PlacesAfterDecimal + 1)
    expandedValue = Fix(expandedValue)

    bRoundUp = (Abs(expandedValue) Mod 10) >= 5

    If bRoundUp Then
        expandedValue = (Fix(expandedValue / 10) + Sgn(value)) * 10
    Else
        expandedValue = Fix(expandedValue / 10) * 10
    End If

    returnValue = expandedValue / 10 ^ (PlacesAfterDecimal + 1)
    RoundNumber = returnValue

End Function 
```

**例子**

```
Debug.Print RoundNumber(1.6)       '2'
Debug.Print RoundNumber(-4.8)      '-5'
Debug.Print RoundNumber(101.7)     '102'
Debug.Print RoundNumber(12.535, 2) '12.54' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T14:54:16.017

VB6 Round() 函数使用[银行家的舍入](http://en.wikipedia.org/wiki/Rounding#Round-to-even_method)方法。MS 知识库文章 225330 ( [http://support.microsoft.com/kb/225330](http://support.microsoft.com/kb/225330) ) 通过将 Office 2000 中的 VBA 与 Excel 的本机行为进行比较来间接讨论这一点，并以这种方式描述它：

> 当带有偶数整数的数字以 .5 结尾时，Visual Basic 会将数字（向下）四舍五入到最接近的偶数整数。[...] [VBA 和 Excel 之间的] 这种差异**仅**适用于以 .5 结尾的数字，并且与其他小数相同。

如果您*需要*不同的行为，恐怕您必须自己指定。

# sql-server-2005 - Making a SETUP file

> ID：647764
> 
> 赞同：2
> 
> 时间：2009-03-15T12:52:14.560
> 
> 标签：sql-server-2005, vb6

I have a VB project that runs on SQL SERVER 2005, while making the setup file for it, how do I include the DB?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T00:25:18.997

你不

通常，您有一个数据库生成脚本，该脚本作为设置的一部分或作为应用程序首次运行的一部分运行

您还需要考虑迁移（发布应用程序的新版本时对数据库的更改）

如果您仍在使用 VB6，请考虑使用[MigratorDotNet](http://code.google.com/p/migratordotnet/)或[RikMigrations在单独的安装程序/升级程序中解决这些问题](http://www.codeplex.com/RikMigrations/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T07:54:37.093

上述答案中给出的两种方法都可以。我都试过了。但是，使用 db 生成脚本会大大减少最终部署文件的大小。我会在应用程序的第一次运行而不是在设置本身中启动脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T22:54:30.477

我会在这个上第二个插孔。

根据我使用需要实际数据库文件的安装的经验，在更新或运行脚本时首次安装时往往会出现更多问题。正如杰克所说，另一个好处是减小了文件大小。

您可以通过右键单击所需的数据库并选择脚本数据库选项来创建谁数据库脚本。但是请注意，这只会创建表和字段，不会复制任何数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T05:15:43.387

我不同意，你可以包括数据库。只需将 .MDF 文件与您的应用程序一起分发。

当然，安装应用程序会知道如何将数据库附加到现有的 SQL Server RDBMS。

# directx - How to copy the pixel data from a texture into a bitmap (direct3d)?

> ID：647766
> 
> 赞同：1
> 
> 时间：2009-03-15T12:52:54.793
> 
> 标签：directx, bitmap, direct3d, textures

I have rendered the scene into a texture, and then I want to save it into a bitmap, but after lock the texture, I found there is no pixel data in the lock area. The texture can be displayed correctly on the screen. I am not sure why? 1> the format is incorrect? A8R8G8B8 has been used. 2> have I missed some important steps before get the pixel data?

# python - 为什么 Python 的原始字符串文字不能以单个反斜杠结尾？

> ID：647769
> 
> 赞同：222
> 
> 时间：2009-03-15T12:54:53.883
> 
> 标签：python, string, literals, rawstring

从技术上讲，任何奇数个反斜杠，如[文档中所述](http://docs.python.org/reference/lexical_analysis.html##string-and-bytes-literals)。

```
>>> r'\'
  File "<stdin>", line 1
    r'\'
       ^
SyntaxError: EOL while scanning string literal
>>> r'\\'
'\\\\'
>>> r'\\\'
  File "<stdin>", line 1
    r'\\\'
         ^
SyntaxError: EOL while scanning string literal 
```

似乎解析器可以将原始字符串中的反斜杠视为常规字符（这不是原始字符串的全部内容吗？），但我可能遗漏了一些明显的东西。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2013-10-29T09:24:45.133

关于 python 的原始字符串的全部误解是，大多数人认为反斜杠（在原始字符串中）和其他所有字符一样只是一个常规字符。它不是。理解的关键是这个python的教程序列：

> 当存在 ' **r** ' 或 ' **R** ' 前缀时，反斜杠后面的字符将原样包含在字符串中，并且所有反斜杠都保留在字符串中

所以反斜杠后面的任何字符**都是**原始字符串的一部分。一旦解析器输入原始字符串（非 Unicode 字符串）并遇到反斜杠，它就知道有 2 个字符（反斜杠和后面的字符）。

这边走：

> **r'abc\d'**包括**a, b, c, \, d**
> 
> **r'abc\'d'**包括**a, b, c, \, ', d**
> 
> **r'abc\''**包括**a, b, c, \, '**

和：

> **r'abc\'**包含**a, b, c, \, '**但现在没有终止引号。

最后一个案例表明，根据文档，现在解析器找不到结束引号，因为您在上面看到的最后一个引号是字符串的一部分，即反斜杠不能在此处最后，因为它会“吞噬”字符串结束字符。

* * *

## 回答 #2

> 赞同：148
> 
> 时间：2009-03-15T13:05:31.097

原因在我以粗体突出显示的那部分的部分中进行了解释：

> **字符串引号可以用反斜杠转义，**但反斜杠保留在字符串中；例如，`r"\""`是由两个字符组成的有效字符串文字：反斜杠和双引号；`r"\"`不是有效的字符串文字（即使是原始字符串也不能以奇数个反斜杠结尾）。具体来说，原始字符串不能以单个反斜杠结尾（因为反斜杠会转义后面的引号字符）。另请注意，后跟换行符的单个反斜杠被解释为这两个字符作为字符串的一部分，而不是作为续行符。

所以原始字符串不是 100% 原始的，还有一些基本的反斜杠处理。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-03-15T13:17:10.117

它就是这样儿的！我认为它是 python 中的小缺陷之一！

我认为没有充分的理由，但绝对不是解析；用 \ 作为最后一个字符来解析原始字符串真的很容易。

问题是，如果您允许 \ 作为原始字符串中的最后一个字符，那么您将无法将 " 放在原始字符串中。似乎 python 使用了 allow " 而不是允许 \ 作为最后一个字符。

但是，这不应该造成任何麻烦。

如果您担心无法轻松编写 windows 文件夹路径，例如，`c:\mypath\`请不要担心，因为，您可以将它们表示为`r"C:\mypath"`，并且，如果您需要附加子目录名称，请不要使用字符串连接，因为无论如何，这不是正确的方法！采用`os.path.join`

```
>>> import os
>>> os.path.join(r"C:\mypath", "subfolder")
'C:\\mypath\\subfolder' 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2011-04-29T08:57:03.980

为了让你用斜杠结束原始字符串，我建议你可以使用这个技巧：

```
>>> print r"c:\test"'\\'
test\ 
```

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2011-11-02T19:54:40.517

另一个技巧是使用 chr(92) 计算结果为“\”。

我最近不得不清理一串反斜杠，以下是诀窍：

```
CleanString = DirtyString.replace(chr(92),'') 
```

我意识到这并没有解决“为什么”，但该线程吸引了许多人寻找解决直接问题的方法。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-15T16:59:09.537

由于 \" 允许在原始字符串中。那么它不能用于标识字符串文字的结尾。

为什么在遇到第一个“时不停止解析字符串文字？

如果是这种情况，那么 \" 将不允许在字符串文字中。但它是。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-15T12:59:20.520

语法不正确的原因`r'\'`是，尽管字符串表达式是原始的，但使用的引号（单引号或双引号）总是必须转义，否则它们会标记引号的结尾。因此，如果你想在单引号字符串中表达单引号，除了使用`\'`. 同样适用于双引号。

但你可以使用：

```
'\\' 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-15T14:20:01.667

另一位后来删除了他们的答案的用户（不确定他们是否希望得到认可）建议 Python 语言设计者可以通过使用相同的解析规则并将转义字符扩展为原始形式作为事后的想法来简化解析器设计（如果文字被标记为原始）。

我认为这是一个有趣的想法，并将其作为社区 wiki 供后代使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-15T17:14:37.707

从 C 开始，我很清楚单个 \ 用作转义字符，允许您将特殊字符（例如换行符、制表符和引号）放入字符串中。

这确实不允许 \ 作为最后一个字符，因为它会转义 " 并使解析器窒息。但正如前面指出的 \ 是合法的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-15T22:22:05.283

一些技巧 ：

1）如果您需要为路径操作反斜杠，那么标准 python 模块 os.path 是您的朋友。例如 ：

> os.path.normpath('c:/folder1/')

2）如果您想在其中构建带有反斜杠的字符串，但在字符串的末尾没有反斜杠，那么原始字符串是您的朋友（在您的文字字符串之前使用'r'前缀）。例如 ：

```
r'\one \two \three' 
```

3）如果您需要在变量 X 中使用反斜杠作为字符串前缀，那么您可以这样做：

```
X='dummy'
bs=r'\ ' # don't forget the space after backslash or you will get EOL error
X2=bs[0]+X  # X2 now contains \dummy 
```

4）如果您需要在末尾创建一个带有反斜杠的字符串，则将提示 2 和 3 结合起来：

```
voice_name='upper'
lilypond_display=r'\DisplayLilyMusic \ ' # don't forget the space at the end
lilypond_statement=lilypond_display[:-1]+voice_name 
```

现在 lilypond_statement 包含`"\DisplayLilyMusic \upper"`

蟒蛇万岁！:)

n3on

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-12-30T06:14:03.563

> 尽管有其作用，但即使是原始字符串也不能以单个反斜杠结尾，因为反斜杠转义了后面的引号字符 - 您仍然必须转义周围的引号字符才能将其嵌入字符串中。也就是说，r"...\" 不是一个有效的字符串字面量——原始字符串不能以奇数个反斜杠结尾。
> 如果您需要以单个反斜杠结束原始字符串，则可以使用两个并切掉第二个。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-10-10T11:23:43.437

我遇到了这个问题，并找到了一个对某些情况有好处的部分解决方案。尽管 python 不能以单个反斜杠结束字符串，但可以将其序列化并保存在末尾带有单个反斜杠的文本文件中。因此，如果您需要在计算机上保存带有单个反斜杠的文本，则可以：

```
x = 'a string\\' 
x
'a string\\' 

# Now save it in a text file and it will appear with a single backslash:

with open("my_file.txt", 'w') as h:
    h.write(x) 
```

顺便说一句，如果您使用 python 的 json 库转储它，它不适用于 json。

最后，我使用 Spyder，我注意到如果我通过在变量资源管理器中双击变量名称在蜘蛛的文本编辑器中打开变量，它会显示一个反斜杠，并且可以通过这种方式复制到剪贴板（不是对大多数需求非常有帮助，但可能对某些需求有帮助..）。

# java - 高性能序列化：Java vs Google Protocol Buffers vs ...？

> ID：647779
> 
> 赞同：54
> 
> 时间：2009-03-15T13:00:14.450
> 
> 标签：java, serialization, caching, protocol-buffers

对于我正在考虑为即将到来的项目做的一些缓存，我一直在考虑 Java 序列化。即，应该使用它吗？

现在我以前写过自定义序列化和反序列化（Externalizable），因为过去几年的各种原因。如今，互操作性已成为一个更大的问题，我可以预见到需要与.Net 应用程序交互，因此我考虑使用独立于平台的解决方案。

有没有人有过高性能使用 GPB 的经验？它在速度和效率方面与 Java 的原生序列化相比如何？或者，还有其他值得考虑的方案吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-15T13:16:52.583

我没有在速度方面将 Protocol Buffers 与 Java 的本机序列化进行比较，但对于互操作性，Java 的本机序列化是一个严重的禁忌。在大多数情况下，它在空间方面也不会像协议缓冲区那样有效。当然，它在可以存储的内容和引用等方面更加灵活。Protocol Buffers 非常擅长它的用途，当它满足您的需要时它很棒 - 但是由于互操作性存在明显的限制（和其他东西）。

我最近发布了一个用 Java 和 .NET 编写的 Protocol Buffers 基准测试框架。Java 版本在[Google 主项目](https://github.com/google/protobuf)中（在[benchmarks 目录](https://github.com/google/protobuf/tree/master/benchmarks)中），.NET 版本在[我的 C# 端口项目](http://code.google.com/p/protobuf-csharp-port/)中。如果您想将 PB 速度与 Java 序列化速度进行比较，您可以编写类似的类并对其进行基准测试。如果您对互操作感兴趣，我真的不会再考虑原生 Java 序列化（或 .NET 原生二进制序列化）。

除了 Protocol Buffers 之外，还有其他可互操作的序列化选项 - [Thrift](http://developers.facebook.com/thrift/)、[JSON](http://www.json.org/)和[YAML 浮现](http://www.yaml.org/)在脑海中，毫无疑问还有其他选项。

编辑：好的，由于互操作不是那么重要，因此值得尝试从序列化框架中列出您想要的不同品质。您应该考虑的一件事是版本控制——这是 PB 旨在处理好的另一件事，无论是向后还是向前（所以新软件可以读取旧数据，反之亦然）——当然，当你坚持建议的规则时 :)

在尝试对 Java 性能与本机序列化保持谨慎之后，我真的不会惊讶地发现 PB 无论如何都更快。如果有机会，请使用服务器虚拟机——我最近的基准测试显示服务器虚拟机在序列化和反序列化示例数据方面的速度是原来的*两倍多。*我认为 PB 代码非常适合服务器 VM 的 JIT :)

正如示例性能数据一样，序列化和反序列化两条消息（一条 228 字节，一条 84750 字节）我使用服务器 VM 在笔记本电脑上得到了这些结果：

```
使用文件 google_message1.dat 对 benchmarks.GoogleSize$SizeMessage1 进行基准测试
序列化为字节串：30.16s 2581851 次迭代；18.613789MB/s
序列化为字节数组：29.842s 内迭代 2583547 次；18.824497MB/s
序列化到内存流：2210320次迭代，30.125s；15.953759MB/s
从字节串反序列化：30.088s 内迭代 3356517 次；24.256632MB/s
从字节数组反序列化：29.958s 内迭代 3356517 次；24.361889MB/s
从内存流中反序列化：29.821s 内迭代 2618821 次；19.094952MB/s

使用文件 google_message1.dat 对 benchmarks.GoogleSpeed$SpeedMessage1 进行基准测试
序列化为字节串：29.978s 内迭代 17068518 次；123.802124MB/s
序列化为字节数组：17520066次迭代，30.043s；126.802376MB/s
序列化到内存流：7736665次迭代，30.076s；55.93307MB/秒
从字节串反序列化：16123669次迭代，30.073s；116.57947MB/s
从字节数组反序列化：16082453次迭代，30.109s；116.14243MB/s
从内存流中反序列化：30.03s 内迭代 7496968 次；54.283176MB/s

使用文件 google_message2.dat 对 benchmarks.GoogleSize$SizeMessage2 进行基准测试
序列化为字节串：30.034s 6266 次迭代；16.826494MB/s
序列化为字节数组：30.027s 内迭代 6246 次；16.776697MB/s
序列化到内存流：29.916s 内 6042 次迭代；16.288969MB/s
从字节串反序列化：29.819s 内迭代 4675 次；12.644595MB/s
从字节数组反序列化：30.093s 4694 次迭代；12.580387MB/s
从内存流中反序列化：29.579s 内迭代 4544 次；12.389998MB/s

使用文件 google_message2.dat 对 benchmarks.GoogleSpeed$SpeedMessage2 进行基准测试
序列化为字节串：30.055s 内迭代 39562 次；106.16416MB/s
序列化为字节数组：30.178s 内迭代 39715 次；106.14035MB/s
序列化到内存流：30.032s 内迭代 34161 次；91.74085MB/秒
从字节串反序列化：29.794s 内迭代 36934 次；99.98019MB/s
从字节数组反序列化：29.915s 内迭代 37191 次；100.26867MB/s
从内存流中反序列化：29.846s 内迭代 36237 次；97.92251MB/秒

```

“速度”与“大小”是生成的代码是否针对速度或代码大小进行了优化。（两种情况下的序列化数据是相同的。“大小”版本是为您定义了很多消息并且不想为代码占用大量内存的情况提供的。）

如您所见，对于较小的消息，它可以*非常快——**每毫秒*序列化或反序列化超过 500 条小消息。即使使用 87K 消息，每条消息也只需不到一毫秒的时间。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-31T18:17:53.307

另一个数据点：这个项目：

[http://code.google.com/p/thrift-protobuf-compare/](http://code.google.com/p/thrift-protobuf-compare/)

给出了小对象的预期性能的一些想法，包括 PB 上的 Java 序列化。

结果因您的平台而异，但有一些总体趋势。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-06T22:17:33.830

您还可以查看[FST](http://ruedigermoeller.github.io/fast-serialization/)，它是内置 JDK 序列化的直接替代品，应该更快且输出更小。

对我近年来所做的频繁基准测试的原始估计：

100% = 基于二进制/结构的方法（例如 SBE、fst-structs）

*   不方便
*   后处理（在接收端建立“真实”对象）可能会消耗性能优势，并且永远不会包含在基准测试中

~10%-35% protobuf 和衍生物

~10%-30% 快速串行器，例如 FST 和 KRYO

*   方便，反序列化的对象可以直接使用，无需额外的手动翻译代码。
*   可以为性能而拉皮条（注释，类注册）
*   保留对象图中的链接（没有对象序列化两次）
*   可以处理循环结构
*   通用方案，FST完全兼容JDK序列化

~2%-15% JDK 序列化

~1%-15% 快速 JSON（例如 Jackson）

*   不能处理任何对象图，只能处理 Java 数据结构的一小部分
*   没有参考恢复

0.001-1% 全图 JSON/XML（例如 JSON.io）

这些数字旨在给人一种非常粗略的数量级印象。请注意，性能很大程度上取决于被序列化/基准测试的数据结构。所以单一的简单类基准大多是无用的（但很流行：例如忽略 unicode，没有集合，..）。

也可以看看

[http://java-is-the-new-c.blogspot.de/2014/12/a-persistent-keyvalue-server-in-40.html](http://java-is-the-new-c.blogspot.de/2014/12/a-persistent-keyvalue-server-in-40.html)

[http://java-is-the-new-c.blogspot.de/2013/10/still-using-externalizable-to-get.html](http://java-is-the-new-c.blogspot.de/2013/10/still-using-externalizable-to-get.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-15T13:53:26.583

你说的高性能是什么意思？如果你想要毫秒级的序列化，我建议你使用最简单的序列化方法。如果您想要亚毫秒，您可能需要二进制格式。如果您想要远低于 10 微秒，您可能需要自定义序列化。

我还没有看到很多序列化/反序列化的基准测试，但很少有人支持少于 200 微秒的序列化/反序列化。

与平台无关的格式是有代价的（在您的努力和延迟方面），您可能必须决定是否需要性能或平台独立性。但是，没有理由不能将两者都作为配置选项，您可以根据需要在它们之间切换。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-15T17:25:05.403

如果您在速度和效率方面对 PB 和本机 java 序列化感到困惑，那就选择 PB。

*   PB 旨在实现这些因素。请参阅[http://code.google.com/apis/protocolbuffers/docs/overview.html](http://code.google.com/apis/protocolbuffers/docs/overview.html)
*   PB 数据非常小，而 java 序列化倾向于复制整个对象，包括其签名。为什么我总是得到我的类名，字段名......序列化，即使我在接收者那里完全知道它？
*   考虑跨语言发展。如果一侧使用 Java，一侧使用 C++，那就越来越难了……

一些开发人员建议使用 Thrift，但我会使用 Google PB，因为“我相信 google”:-).. 无论如何，值得一看： [http ://stuartsierra.com/2008/07/10/thrift-vs-protocol -缓冲区](http://stuartsierra.com/2008/07/10/thrift-vs-protocol-buffers)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T15:36:35.180

这是当天的建议:-)（你刚刚在我的脑海中调整了一些我现在想尝试的东西）......

如果您可以通过它寻求整个缓存解决方案，它可能会起作用：[Project Darkstar](http://www.projectdarkstar.com/)。它被设计为非常高性能的游戏服务器，特别是读取速度很快（非常适合缓存）。它有 Java 和 C API，所以我相信（我认为已经很久没有看到它了，当时我没有想到这一点）你可以用 Java 保存对象并用 C 读回它们，反之亦然。

如果没有别的，它会给你今天阅读的东西:-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-06-09T21:06:39.373

对于有线友好的序列化，请考虑使用 Externalizable 接口。巧妙地使用，您将拥有深入的知识来决定如何以最佳方式编组和解组特定字段。也就是说，您需要正确管理每个对象的版本控制 - 易于取消编组，但是当您的代码支持 V1 时重新编组 V2 对象会破坏、丢失信息或更糟地破坏您的应用程序的数据无法正确处理。如果您正在寻找最佳路径，请注意没有任何库可以在不妥协的情况下解决您的问题。通常，如果您选择了一个活跃的开源项目，库将适合大多数用例，并且会带来额外的好处，即它们会随着时间的推移而适应和增强，而无需您的输入。他们可能会增加性能问题，引入错误，

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-12T07:25:29.667

If you want to solve the problem of cross-platform and cross-language data exchange, you can consider using **FastProto** ([https://github.com/indunet/fastproto](https://github.com/indunet/fastproto)) as your serialization tool, through annotating custom protocols, which has extremely high efficiency.

# perl - 分层和可继承配置的最佳 Perl 模块是什么？

> ID：647781
> 
> 赞同：5
> 
> 时间：2009-03-15T13:01:06.413
> 
> 标签：perl, configuration, configuration-files, config

如果我有一个新建项目，使用基于 Perl 的配置模块的最佳实践是什么？

将有一个 Catalyst 应用程序和一些命令行脚本。它们应该共享相同的配置。

我想我想要的一些功能......

分层配置以干净地维护不同的开发和实时设置。

我想定义一次“全局”配置（例如，results_per_page => 20），让那些继承但可以被我的开发/实时配置覆盖。

```
Global:
  results_per_page: 20
  db_dsn: DBI:mysql;
  db_name: my_app
Dev:
  inherit_from: Global
  db_user: dev
  db_pass: dev
Dev_New_Feature_Branch:
  inherit_from: Dev
  db_name: my_app_new_feature
Live:
  inherit_from: Global
  db_user: live
  db_pass: secure 
```

当我将项目部署到新服务器或将其分支/分叉/复制到新的地方（例如，新的开发实例）时，我想（仅一次）设置要使用的配置集/文件，然后是所有未来的更新是自动的。

我设想这可以通过符号链接来实现：

```
git clone example.com:/var/git/my_project . # or any equiv vcs
cd my_project/etc
ln -s live.config to_use.config 
```

那么在未来

```
git pull # or any equiv vcs 
```

我还想要类似于 FindBin 的东西，这样我的配置可以使用绝对路径，或者相对于当前部署。给定

```
/home/me/development/project/
  bin
  lib
  etc/config 
```

其中 /home/me/development/project/etc/config 包含：

```
tmpl_dir: templates/ 
```

当我的 perl 代码查找 tmpl_dir 配置时，它会得到：

```
/home/me/development/project/templates/ 
```

但是在实时部署中：

```
/var/www/project/
  bin
  lib
  etc/config 
```

相同的代码会神奇地返回

```
/var/www/project/templates/ 
```

应该尊重配置中的绝对值，以便：

```
apache_config: /etc/apache2/httpd.conf 
```

在所有情况下都会返回“/etc/apache2/httpd.conf”。

除了 FindBin 风格的方法，替代方法可能是允许根据其他配置值定义配置值？

```
tmpl_dir: $base_dir/templates 
```

我也想要一匹小马；）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T14:16:41.300

[Catalyst::Plugin::ConfigLoader](http://search.cpan.org/dist/Catalyst-Plugin-ConfigLoader/)支持多个覆盖配置文件。如果您的 Catalyst 应用程序被调用`MyApp`，那么它具有三个级别的覆盖：1）`MyApp.pm`可以有一个`__PACKAGE__->config(...)`指令，2）它接下来`MyApp.yml`会在应用程序的主目录中查找，3）它会查找`MyApp_local.yml`. 每个级别都可以覆盖其他级别的设置。

在我构建的 Catalyst 应用程序中，我将所有不可变设置`MyApp.pm`、调试设置`MyApp.yml`和生产设置放入`MyApp_<servertype>.yml`其中，然后通过符号链接`MyApp_local.yml`指向`MyApp_<servertype>.yml`每个部署的服务器（它们都有点不同......）。

这样，我所有的配置都在 SVN 中，我只需要`ln -s`一步来手动配置服务器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T14:19:25.537

[Perl Best Practices](http://oreilly.com/catalog/9780596001735/)会针对您想要的内容发出警告。它指出配置文件应该简单并且避免你想要的那种巴洛克式的特性。它继续推荐三个模块（都不是 Core Perl）：[Config::General](http://search.cpan.org/dist/Config-General/General.pm)、[Config::Std](http://search.cpan.org/dist/Config-Std/lib/Config/Std.pm)和[Config::Tiny](http://search.cpan.org/dist/Config-Tiny/lib/Config/Tiny.pm)。

这背后的一般原因是配置文件的编辑往往由非程序员完成，并且您制作的配置文件越复杂，他们就越有可能将它们搞砸。

说了这么多，你可以看看[YAML](http://www.yaml.org/)。它提供了功能齐全、人类可读`*`的序列化格式。我相信 Perl 目前推荐的解析器是[YAML::XS](http://search.cpan.org/dist/YAML-LibYAML/lib/YAML/XS.pm)。如果您确实走这条路，我建议您编写一个配置工具供最终用户使用，而不是让他们直接编辑文件。

ETA：根据 Chris Dolan 的回答，听起来 YAML 是适合您的方式，因为 Catalyst 已经在使用它（.yml 是 YAML 文件的事实上的扩展名）。

`*`我听到有人抱怨说盲人可能有困难

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T20:43:57.237

YAML 讨厌配置——它对非程序员不友好，部分原因是 pod 中的 yaml 被定义为损坏，因为它们都以不同的方式依赖于空白。[这](http://www.catalystframework.org/calendar/2008/10)解决了 Config::General 的主要问题。过去，我用 C::G 编写了一些相当复杂的配置文件，并且在语法要求等方面确实让您不受影响。除此之外，Chris 的建议似乎很划算。

# linux - Linux 中的直接内存访问

> ID：647783
> 
> 赞同：45
> 
> 时间：2009-03-15T13:01:41.777
> 
> 标签：linux, memory, memory-management, embedded, linux-kernel

我正在尝试直接访问嵌入式 Linux 项目的物理内存，但我不确定如何最好地指定内存供我使用。

如果我定期启动我的设备并访问 /dev/mem，我可以轻松地读写几乎任何我想要的地方。但是，在这里，我正在访问可以轻松分配给任何进程的内存；我不想做

我的 /dev/mem 代码是（所有错误检查等已删除）：

```
mem_fd = open("/dev/mem", O_RDWR));
mem_p = malloc(SIZE + (PAGE_SIZE - 1));
if ((unsigned long) mem_p % PAGE_SIZE) {
    mem_p += PAGE_SIZE - ((unsigned long) mem_p % PAGE_SIZE);
}
mem_p = (unsigned char *) mmap(mem_p, SIZE, PROT_READ | PROT_WRITE, MAP_SHARED | MAP_FIXED, mem_fd, BASE_ADDRESS); 
```

这有效。但是，我想使用其他人不会触及的内存。我尝试通过使用 mem=XXXm 启动来限制内核看到的内存量，然后将 BASE_ADDRESS 设置为高于该值（但低于物理内存），但它似乎并没有始终如一地访问相同的内存。

根据我在网上看到的情况，我怀疑我可能需要一个使用 ioremap() 或 remap_pfn_range() （或两者都使用？？？）的内核模块（没关系），但我完全不知道如何；谁能帮忙？

编辑：我想要的是一种始终访问相同物理内存（例如，价值 1.5MB）的方法，并将该内存放在一边，以便内核不会将其分配给任何其他进程。

我正在尝试重现我们在其他操作系统中拥有的系统（没有内存管理），我可以通过链接器在内存中分配空间，并使用类似的东西访问它

```
*(unsigned char *)0x12345678 
```

EDIT2：我想我应该提供更多细节。此内存空间将用于 RAM 缓冲区，用于嵌入式应用程序的高性能日志记录解决方案。在我们拥有的系统中，在软重启期间没有任何东西可以清除或扰乱物理内存。因此，如果我向物理地址 X 写入位并重新启动系统，在重新启动后仍会设置相同的位。这已经在运行 VxWorks 的完全相同的硬件上进行了测试（该逻辑在不同平台上的 Nucleus RTOS 和 OS20 中也能很好地工作，FWIW）。我的想法是通过直接寻址物理内存在 Linux 中尝试同样的事情。因此，每次启动时我都必须获得相同的地址。

我可能应该澄清一下，这是针对内核 2.6.12 和更高版本的。

EDIT3：这是我的代码，首先是内核模块，然后是用户空间应用程序。

要使用它，我用 mem=95m 启动，然后是 insmod foo-module.ko，然后是 mknod mknod /dev/foo c 32 0，然后运行 ​​foo-user ，它死了。在 gdb 下运行表明它在分配时死亡，尽管在 gdb 中，我无法取消引用从 mmap 获得的地址（尽管 printf 可以）

foo-module.c

```
#include <linux/module.h>
#include <linux/config.h>
#include <linux/init.h>
#include <linux/fs.h>
#include <linux/mm.h>
#include <asm/io.h>

#define VERSION_STR "1.0.0"
#define FOO_BUFFER_SIZE (1u*1024u*1024u)
#define FOO_BUFFER_OFFSET (95u*1024u*1024u)
#define FOO_MAJOR 32
#define FOO_NAME "foo"

static const char *foo_version = "@(#) foo Support version " VERSION_STR " " __DATE__ " " __TIME__;

static void    *pt = NULL;

static int      foo_release(struct inode *inode, struct file *file);
static int      foo_open(struct inode *inode, struct file *file);
static int      foo_mmap(struct file *filp, struct vm_area_struct *vma);

struct file_operations foo_fops = {
    .owner = THIS_MODULE,
    .llseek = NULL,
    .read = NULL,
    .write = NULL,
    .readdir = NULL,
    .poll = NULL,
    .ioctl = NULL,
    .mmap = foo_mmap,
    .open = foo_open,
    .flush = NULL,
    .release = foo_release,
    .fsync = NULL,
    .fasync = NULL,
    .lock = NULL,
    .readv = NULL,
    .writev = NULL,
};

static int __init foo_init(void)
{
    int             i;
    printk(KERN_NOTICE "Loading foo support module\n");
    printk(KERN_INFO "Version %s\n", foo_version);
    printk(KERN_INFO "Preparing device /dev/foo\n");
    i = register_chrdev(FOO_MAJOR, FOO_NAME, &foo_fops);
    if (i != 0) {
        return -EIO;
        printk(KERN_ERR "Device couldn't be registered!");
    }
    printk(KERN_NOTICE "Device ready.\n");
    printk(KERN_NOTICE "Make sure to run mknod /dev/foo c %d 0\n", FOO_MAJOR);
    printk(KERN_INFO "Allocating memory\n");
    pt = ioremap(FOO_BUFFER_OFFSET, FOO_BUFFER_SIZE);
    if (pt == NULL) {
        printk(KERN_ERR "Unable to remap memory\n");
        return 1;
    }
    printk(KERN_INFO "ioremap returned %p\n", pt);
    return 0;
}
static void __exit foo_exit(void)
{
    printk(KERN_NOTICE "Unloading foo support module\n");
    unregister_chrdev(FOO_MAJOR, FOO_NAME);
    if (pt != NULL) {
        printk(KERN_INFO "Unmapping memory at %p\n", pt);
        iounmap(pt);
    } else {
        printk(KERN_WARNING "No memory to unmap!\n");
    }
    return;
}
static int foo_open(struct inode *inode, struct file *file)
{
    printk("foo_open\n");
    return 0;
}
static int foo_release(struct inode *inode, struct file *file)
{
    printk("foo_release\n");
    return 0;
}
static int foo_mmap(struct file *filp, struct vm_area_struct *vma)
{
    int             ret;
    if (pt == NULL) {
        printk(KERN_ERR "Memory not mapped!\n");
        return -EAGAIN;
    }
    if ((vma->vm_end - vma->vm_start) != FOO_BUFFER_SIZE) {
        printk(KERN_ERR "Error: sizes don't match (buffer size = %d, requested size = %lu)\n", FOO_BUFFER_SIZE, vma->vm_end - vma->vm_start);
        return -EAGAIN;
    }
    ret = remap_pfn_range(vma, vma->vm_start, (unsigned long) pt, vma->vm_end - vma->vm_start, PAGE_SHARED);
    if (ret != 0) {
        printk(KERN_ERR "Error in calling remap_pfn_range: returned %d\n", ret);
        return -EAGAIN;
    }
    return 0;
}
module_init(foo_init);
module_exit(foo_exit);
MODULE_AUTHOR("Mike Miller");
MODULE_LICENSE("NONE");
MODULE_VERSION(VERSION_STR);
MODULE_DESCRIPTION("Provides support for foo to access direct memory"); 
```

富用户.c

```
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <stdio.h>
#include <sys/mman.h>

int main(void)
{
    int             fd;
    char           *mptr;
    fd = open("/dev/foo", O_RDWR | O_SYNC);
    if (fd == -1) {
        printf("open error...\n");
        return 1;
    }
    mptr = mmap(0, 1 * 1024 * 1024, PROT_READ | PROT_WRITE, MAP_FILE | MAP_SHARED, fd, 4096);
    printf("On start, mptr points to 0x%lX.\n",(unsigned long) mptr);
    printf("mptr points to 0x%lX. *mptr = 0x%X\n", (unsigned long) mptr, *mptr);
    mptr[0] = 'a';
    mptr[1] = 'b';
    printf("mptr points to 0x%lX. *mptr = 0x%X\n", (unsigned long) mptr, *mptr);
    close(fd);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-16T09:07:33.797

我想你可以找到很多关于 kmalloc + mmap 部分的文档。但是，我不确定您是否可以以连续的方式对这么多内存进行 kmalloc，并始终将其放在同一个地方。当然，如果一切都是一样的，那么你可能会得到一个不变的地址。但是，每次更改内核代码时，都会得到不同的地址，所以我不会使用 kmalloc 解决方案。

我认为您应该在启动时保留一些内存，即保留一些物理内存，这样内核就不会触及这些内存。然后你可以ioremap这个内存，它会给你一个内核虚拟地址，然后你可以mmap它并编写一个很好的设备驱动程序。

这将我们带回到PDF 格式的[linux 设备驱动程序](http://lwn.net/Kernel/LDD3/)。看看第 15 章，它在第 443 页描述了这种技术

编辑：ioremap 和 mmap。我认为这可能更容易通过两步调试处理：首先正确获取 ioremap，然后使用字符设备操作（即读/写）对其进行测试。一旦您知道您可以安全地使用读/写访问整个 ioremapped 内存，然后您尝试 mmap 整个 ioremapped 范围。

如果你遇到麻烦可能会发布另一个关于映射的问题

编辑：remap_pfn_range ioremap 返回一个 virtual_adress，您必须将其转换为 remap_pfn_ranges 的 pfn。现在，我不明白 pfn（页框号）是什么，但我认为你可以接到一个电话

```
virt_to_phys(pt) >> PAGE_SHIFT 
```

这可能不是正确的方法（tm），但你应该尝试一下

您还应该检查 FOO_MEM_OFFSET 是您的 RAM 块的物理地址。也就是说，在 mmu 发生任何事情之前，您的内存在处理器的内存映射中为 0 可用。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-15T14:23:34.467

很抱歉回答，但没有完全回答，我注意到您已经编辑了问题。请注意，当您编辑问题时，SO 不会通知我们。我在这里给出一个通用的答案，当您更新问题时请发表评论，然后我将编辑我的答案。

是的，您将需要编写一个模块。它归结为使用`kmalloc()`（在内核空间中分配区域）或`vmalloc()`（在用户空间中分配区域）。

暴露先验很容易，使用您根据需要描述的那种界面来暴露后者可能会很麻烦。您注意到 1.5 MB 是您实际需要保留多少的粗略估计，那是铁包的吗？即，您是否愿意从内核空间中获取它？您能否充分处理来自用户空间（甚至磁盘睡眠）的 ENOMEM 或 EIO？IOW，这个地区发生了什么？

另外，并发会成为这个问题吗？如果是这样，你会使用 futex 吗？如果任何一个的答案都是“是”（尤其是后者），那么您很可能不得不硬着头皮继续前进`vmalloc()`（或冒着内核腐烂的风险）。此外，如果您甚至`ioctl()`在考虑 char 设备的接口（特别是对于一些临时锁定的想法），您真的想使用`vmalloc()`.

另外，你读过[这个](http://web.archive.org/web/20130128033921/http://www.scs.ch/~frey/linux/memorymap.html)吗？另外，我们甚至没有触及 grsec / selinux 会想到什么（如果正在使用）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T19:27:52.927

/dev/mem 对于简单的寄存器窥视和戳是可以的，但是一旦你进入中断和 DMA 领域，你真的应该编写一个内核模式驱动程序。您为以前的无内存管理操作系统所做的事情根本无法很好地移植到像 Linux 这样的通用操作系统上。

您已经考虑过 DMA 缓冲区分配问题。现在，考虑一下来自您的设备的“DMA 完成”中断。您将如何安装中断服务程序？

此外，/dev/mem 通常对非 root 用户是锁定的，因此对于一般用途来说不是很实用。当然，您可以对其进行 chmod，但随后您在系统中打开了一个很大的安全漏洞。

如果您试图保持操作系统之间的驱动程序代码库相似，则应考虑将其重构为单独的用户和内核模式层，中间使用类似 IOCTL 的接口。如果您将用户模式部分编写为 C 代码的通用库，那么它应该很容易在 Linux 和其他操作系统之间移植。特定于操作系统的部分是内核模式代码。（我们为驱动程序使用这种方法。）

似乎您已经得出结论，是时候编写内核驱动程序了，所以您走在正确的轨道上。我能补充的唯一建议是从头到尾阅读这些书。

[Linux 设备驱动程序](http://oreilly.com/catalog/9780596005900/)

[了解 Linux 内核](http://oreilly.com/catalog/9780596005658/?CMP=AFC-ak_book&ATT=Understanding+the+Linux+Kernel)

（请记住，这些书大约是 2005 年出版的，所以信息有点过时了。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T17:09:41.370

到目前为止，我还不是这些问题的专家，所以这对你来说将是一个问题，而不是一个答案。有什么理由不能只制作一个小的 ram 磁盘分区并将其仅用于您的应用程序？这不会让您保证访问相同的内存块吗？我不确定是否会有任何 I/O 性能问题或与此相关的额外开销。这还假设您可以告诉内核在内存中划分特定地址范围，但不确定是否可能。

我为 newb 的问题道歉，但我发现你的问题很有趣，并且很好奇 ram 磁盘是否可以以这种方式使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-28T17:36:48.467

你看过'memmap'内核参数吗？在 i386 和 X64_64 上，您可以使用 memmap 参数来定义内核将如何处理非常特定的内存块（请参阅[Linux 内核参数](http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=blob;f=Documentation/kernel-parameters.txt;h=9107b387e91fce095ee320dbeed53d5dfe5cb332;hb=HEAD)文档）。在您的情况下，您希望将内存标记为“保留”，以便 Linux 根本不会触及它。然后您可以编写代码以使用该绝对地址和大小（如果您超出该空间，您将有祸了）。

# c++ - 如何从链接器映射中找出源代码行号

> ID：647796
> 
> 赞同：2
> 
> 时间：2009-03-15T13:17:09.620
> 
> 标签：c++, visual-studio-2008, linker

出于某种原因，我只有正在调试的应用程序的链接器映射。有一个崩溃日志说崩溃发生在偏移“myApp.exe！+ 4CA24”。

从链接器映射中，我能够找到该方法。假设这是偏移量“myApp.exe！+ 4BD7C”。

无论如何，仅使用上述信息就可以找出源代码中的确切行吗？

我知道如果我们有一个 .cod 文件，它会很容易，但我没有（也无法创建）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T16:32:26.217

如果您只有 MAP 文件，您可以做的最好的事情是在反汇编程序中研究 EXE 文件，并与您从编译器生成代码的常见方式中识别的构造进行比较。这些你必须学习。这意味着至少需要学习一些汇编程序。这是很好的知识，将来会对您有所帮助，尤其是在您必须调试大量代码的情况下。

一种稍微简单的方法是下载有关处理器指令的免费英特尔书籍，然后简单地检查它们的大小。这样，您就可以计算出错误指令的方式。为获得最佳效果，这两种方法应相互结合使用。

通常，您要寻找的东西看起来有点像这样：

```
mov DWORD PTR [edi+40], eax 
```

（指令、寄存器、偏移量、大小和顺序可以不同，但​​间接通常是大多数代码崩溃的地方）

无论您做什么，您都应该认真考虑为将来启用 COD 文件生成，因为这样可以非常容易地找到故障线路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T15:52:41.197

这取决于地图文件中的实际信息——如果它有行号信息（现在很少见），它会很明显，你就可以做到。否则你能做的最好的就是猜测。

# python - 在 Python 中捕获 MySQL 警告

> ID：647805
> 
> 赞同：14
> 
> 时间：2009-03-15T13:25:52.220
> 
> 标签：python, mysql

我想在 Python 中捕获并记录 MySQL 警告。例如，如果您`'DROP DATABASE IF EXISTS database_of_armaments'`在不存在此类数据库时提交，MySQL 会向标准错误发出警告。我想捕捉并记录它，但即使在 try/else 语法中，警告消息仍然出现。

try/except 语法确实会捕获 MySQL 错误（例如，提交类似 的错字`'DRP DATABASE database_of_armaments'`）。

我已经尝试过`<<except.MySQLdb.Warning>>`- 没有运气。我查看了警告模块，但不明白如何将其合并到 try/else 语法中。

具体来说，我如何让以下（或类似的东西）工作。

给定：数据库“database_of_armaments”不存在。

```
try:
    cursor.execute('DROP DATABASE IF EXISTS database_of_armaments')
except: <<WHAT DO I PUT HERE?>>
    print 'There was a MySQL warning.' 
    <<AND what goes here if I want to get and manipulate information about the warning?>> 
```

更新：

感谢您的评论。我试过这些，但它们没有用——但我一直在使用我为连接编写的 DatabaseConnection 类，以及它的 runQuery() 方法来执行。当我在类外创建连接和游标时，try/except 异常捕获了“编程错误”，并且除了 MySQLdb.ProgrammingError 之外的工作如宣传的那样。

所以现在我必须弄清楚我的类编码有什么问题。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-15T13:32:39.363

跟着这些步骤。

1.  运行它`except Exception, e: print repr(e)`。

2.  看看你得到了什么异常。

3.  将 更改为`Exception`您实际得到的异常。

另外，请记住异常 e 是一个对象。您可以打印`dir(e)`,等来`e.__class__.__name__`查看它具有哪些属性。

此外，您可以`>>>`在 Python 的提示符下以交互方式执行此操作。然后，您可以直接操作该对象——无需猜测。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-15T13:39:11.093

你有没有尝试过这样的事情？

```
try:
    cursor.execute(some_statement)
except MySQLdb.IntegrityError, e: 
    # handle a specific error condition
except MySQLdb.Error, e:
    # handle a generic error condition
except MySQLdb.Warning, e:
    # handle warnings, if the cursor you're using raises them 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T13:48:53.037

我认为您要捕获的异常是 MySQLdb.ProgrammingError，要获取有关它的信息，只需添加一个变量来存储错误数据（元组），即：

```
try:
    cursor.execute('DROP DATABASE IF EXISTS database_of_armaments')
except MySQLdb.ProgrammingError, e:
    print 'There was a MySQL warning.  This is the info we have about it: %s' %(e) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-07-19T14:23:30.523

我设法像这样捕获mysql警告：

```
import _mysql_exceptions

try:
    foo.bar()
except _mysql_exceptions.Warning, e:
    pass 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-15T19:46:05.187

首先，您应该打开警告以将其视为异常，然后才能捕获它们。请参阅“错误”警告过滤器 - [https://docs.python.org/3/library/warnings.html#the-warnings-filter](https://docs.python.org/3/library/warnings.html#the-warnings-filter)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-10-08T19:07:42.607

干净利落

```
def log_warnings(curs):
    for msg in curs.messages:
        if msg[0] == MySQLdb.Warning:
            logging.warn(msg[1])

cursor.execute('DROP DATABASE IF EXISTS database_of_armaments')
log_warnings(cursor) 
```

味精 [1] 示例：-`(u'Warning', 1366L, u"Incorrect integer value: '\xa3' for column 'in_userid' at row 1")`

# sharepoint - Accessing SPLIstItem properties in SharePoint

> ID：647806
> 
> 赞同：2
> 
> 时间：2009-03-15T13:26:34.120
> 
> 标签：sharepoint

I'm trying something very simple - accessing my SharePoint list's items and their properties.

However, SPListItem.Properties count is zero for all normal lists. Everything works as expected for document and pages libraries. So, if the list items are based on document type, all is good. If they are based on item, properties are not returned.

I've tried in two environments, with new sites created from OOTB publishing templates, with new lists which are based on OOTB content types etc. Always the same thing.

Right amount of SPListItems is always returned. Title and Name are fine. It's just that the .Properties hashtable is totally empty.

In desperation, I wrote a web part that outputs the following (ugly!) diagnostics.

```
 foreach (SPList list in SPContext.Current.Web.Lists)
    {
        foreach (SPListItem item in list.Items)
        {
            Label label = new Label();
            label.Text = "Name: " + item.Name + "Property count: " + item.Properties.Count;
            this.Controls.Add(label);
        }
    } 
```

The only observation is that it works exactly as I described earlier. I just share the code to show that this is the most basic operation imaginable.

Here is sample output - I've added the line breaks for readability ;-)

```
Name: Test Property count: 0
Name: default.aspx Property count: 21 
```

Obviously item "Test" is an item based list item and default.aspx is a page.

Has anyone ever encountered anything like this? Any ideas?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T23:14:56.373

item["FieldName"] 是获取 SharePoint 列表中元数据列的值的规范方法。如果您需要获取 SharePoint 列表的可用字段列表，请检查父 SPList 对象的 Fields 属性，该属性是此列表中字段的集合。这些字段对象中的每一个都有一个名为 InternalName 的属性，当您使用 SPListItem 的实例时，您应该使用它来访问其值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T13:42:11.710

您是否正在尝试获取字段值？可悲的是，它们不是强类型：

```
string ModifiedBy = (string)item["Author"]; 
```

要获取字段的正确名称（它们必须是内部名称），请转到列表，然后转到列表设置。您将在那里找到列列表。单击任何列名称以转到编辑页面，然后查看浏览器地址栏中的 URL。最后，应该有一个参数“Field=Editor”或类似的 - 这是您的内部字段名称。

如果您想知道为什么像“测试字段”这样的字段看起来很奇怪，那是因为 Sharepoint 对某些字符进行了编码。空格将被编码为*x0020*，因此“测试字段”的内部名称是“Test_x0020_Field”。

为了获得正确的字段类型以转换为：

```
string FieldType = item["Author"].GetType().FullName; 
```

（Visual Studio 中的中间窗口对此非常有帮助！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-23T18:19:23.467

我发现 SPListItem 类的以下扩展非常有用。

```
internal static class SharePointExtensions
{
    internal static Dictionary<string, object> PropertiesToDictionary(this SPListItem item)
    {
        // NOTE: This code might be temping - but don't do it! ...itdoes not work as there are often multiple field definitions with the same Title!
        // return item.Fields.Cast<SPField>().ToDictionary(fld => fld.Title, fld => item[fld.Title]);

        Dictionary<string, object> dict = new Dictionary<string, object>();
        var fieldNames = item.Fields.Cast<SPField>().Select(fld => fld.Title).Distinct().OrderBy(sz => sz).ToArray();
        foreach (fieldName in fieldNames)
            dict.Add(sz, item[fieldName]);
        return dict;
    }
} 
```

有了它，你可以简单地做：

```
item.PropertiesToDictionary() 
```

...您将拥有一个很好的 Linq 字典对象，它可以按照您期望的方式工作。是不是有点重量级/低性能？当然。大多数人愿意做出这种权衡吗？我认同...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T13:50:37.010

设置属性后是否运行 SPListItem.Update() 或 .SystemUpdate()？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-16T08:52:23.210

如果你想从 SPListItem 的 SPField 中获取一个对象，你必须这样做：

```
SPField field = ((SPList)list).Fields.GetField("FieldName"); 
object fieldValue = field.GetFieldValue(((SPListItem)item)[field.Title].ToString()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-14T14:24:45.707

ListItem.Properties 哈希表将为空，除非您分配给它。

```
 SPListItem item = properties.ListItem;
 item.Properties["Key"] = "value";

 int total = item.Properties.Count; 
```

答案：“总数 == 1”

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-05-31T13:05:15.570

```
 SPList yourList = web.Lists["Your list name"];
 string sColumnValue = oSPListItem[yourList.Fields["yourSiteColumn display   
  name"].InternalName].ToString(); 
```

# javascript - Multiplayer game to demo Wi-fi

> ID：647808
> 
> 赞同：1
> 
> 时间：2009-03-15T13:29:08.217
> 
> 标签：javascript, multiplayer, wifi

So in Germany we have built up a huge Wi-fi system and usually you have to login to the system to surf the web. As a gimik we want to add a multiplayer game so without having to pay for usual internet they can play a webbased multiplayer game. What multiplayer games do you know. It just has to be 2 player really. I would want to program it with JavaScript since I am uncapable of doing Flash.

Any good ideas? Maybe even a finished game I could use?

I would want it to be an instant game so no browser game where you would have to check back every 5 hours or so.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-15T13:53:19.533

[像坦克](http://www.mathsisfun.com/games/tanks.html)这样的东西怎么样？或者可能类似于[BattleShip](http://www.sinkmyship.com/)的东西？

如果你不想要动作游戏，试试[扑克之](http://gpokr.com/#Dodge)类的纸牌游戏怎么样？

* * *

看看[这个](http://metalab.at/wiki/JavaScript_game_development)专门用于 JavaScript 游戏开发的页面，以及[这里](http://www.webresourcesdepot.com/25-amazing-javascript-games-some-fun-and-inspiration/)他们列出了 25 个 JavaScript 游戏

我还建议你看看[Canvas Element](https://developer.mozilla.org/En/Canvas_tutorial)来实现一个流畅的图形、JavaScript 控制的游戏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T15:25:05.177

我没有任何具体的游戏可以添加到 Dreas Grech 的建议中，但我建议您选择具有相对简单（但当然不是太简单）的玩家策略集的游戏，这样您也可以实施一个人工智能/机器人来对抗任何无法找到人类对手的用户。

# java - Plugin GMF

> ID：647809
> 
> 赞同：0
> 
> 时间：2009-03-15T13:29:46.203
> 
> 标签：java

Comment une image devient un noeud dans la palette et on peut l'inserer dans la zone de dessin

[translation:](http://translate.google.com)

How a picture becomes a node in the palette and can be inserted in the drawing area

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-28T05:22:47.470

首先，很遗憾看到您的问题被否决，不知道为什么会这样；这个问题是有效的。对不起，我只能用英文回复。查看 GMF 上的此文档（[GMF 开发人员指南](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.gmf.doc/reference/api/runtime/overview-summary.html)），密切关注图 II 和 III，以确保理解视图/节点与 editParts 与图。

这些示例真正向您展示了如何一起使用所有不同的插件扩展来创建您所期望的整个用户交互。

其次，eclipse GMF 中包含调色板示例。Eclipse -> 新示例 -> GMF。调色板需要绘图/图片插件之外的插件类型和类。我已经验证**GMF 逻辑示例**显示了如何使用调色板插件和类来完成此操作。以防万一安装示例的链接（[如果还没有安装示例。](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.gmf.doc/reference/api/runtime/overview-summary.html)）

# python - python中的套接字问题

> ID：647813
> 
> 赞同：4
> 
> 时间：2009-03-15T13:34:19.250
> 
> 标签：python, sockets

我有一个用 C 编写的服务器，我想用 python 编写一个客户端。当python客户端想要发送一个文件时，它会发送一个字符串“send some_file”，然后是文件的内容，然后是字符串“end some_file”。这是我的客户代码：

```
 file = sys.argv[1]
host = sys.argv[2]
port = int(sys.argv[3])
sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
sock.connect((host,port))
send_str = "send %s" % file
end_str = "end %s" % file
sock.send(send_str)
sock.send("\n")
sock.send(open(file).read())
sock.send("\n")
sock.send(end_str)
sock.send("\n") 
```

问题是这样的：

*   服务器从 recv 接收“send some_file”字符串

*   在第二次接收时，文件的内容和“结束文件”字符串一起发送

在服务器代码中，缓冲区的大小是 4096。我在尝试发送小于 4096k 的文件时首先注意到了这个错误。如何确保服务器独立接收字符串？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T13:36:36.187

使用socket编程，即使你做了2个独立的发送，并不意味着对方会接收它们作为2个独立的recv。

一个适用于字符串和二进制数据的简单解决方案是：首先发送消息中的字节数，然后发送消息。

无论是文件还是字符串，您都应该对每条消息执行以下操作：

**发送方：**

*   发送 4 个字节，其中包含以下发送中的字节数
*   发送实际数据

**接收方：**

*   从接收方做一个循环，阻塞读取 4 个字节
*   然后对前面 4 个字节中指定的字符数执行块读取以获取数据。

除了我上面提到的 4 字节长度的标头之外，您还可以添加一个恒定大小的命令类型标头（又是整数），它描述了以下 recv 中的内容。

你也可以考虑使用像 HTTP 这样的协议，它已经为你做了很多工作并且有很好的包装库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T14:12:31.547

我能想到两种更简单的方法来解决这个问题。两者都涉及客户端和服务器行为的一些变化。

首先是使用填充。假设您要发送一个文件。您要做的是读取文件，将其编码为更简单的格式，如 Base64，然后发送足够的空格字符来填充剩余的 4096 字节“块”。你会做的是这样的：

```
from cStringIO import StringIO
import base64
import socket
import sys

CHUNK_SIZE = 4096 # bytes

# Extract the socket data from the file arguments
filename = sys.argv[1]
host = sys.argv[2]
port = int(sys.argv[3])
# Make the socket
sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
sock.connect((host,port))
# Prepare the message to send
send_str = "send %s" % (filename,)
end_str = "end %s" % (filename,)
data = open(filename).read()
encoded_data = base64.b64encode(data)
encoded_fp = StringIO(encoded_data)
sock.send(send_str + '\n')
chunk = encoded_fp.read(CHUNK_SIZE)
while chunk:
    sock.send(chunk)
    if len(chunk) < CHUNK_SIZE:
        sock.send(' ' * (CHUNK_SIZE - len(chunk)))
    chunk = encoded_fp.read(CHUNK_SIZE)
sock.send('\n' + end_str + '\n') 
```

这个例子似乎有点复杂，但它会确保服务器可以继续读取 4096 字节块中的数据，它所要做的就是对另一端的数据进行 Base64 解码（[此处](http://libb64.sourceforge.net/)提供了一个 C 库. Base64 解码器会忽略多余的空格，并且该格式可以处理二进制文件和文本文件（例如，如果文件包含“结束文件名”行会发生什么？它会混淆服务器）。

另一种方法是在文件的发送前加上文件的长度。因此，例如，`send filename`您可能会说`send 4192 filename`指定文件的长度为 4192 字节，而不是发送。客户端必须`send_str`根据文件的长度（如`data`上面代码中的变量读入）来构建，并且不需要使用 Base64 编码，因为服务器不会尝试解释`end filename`出现在正文中的任何语法发送的文件。这就是 HTTP 中发生的情况；HTTP标`Content-length`头用于指定发送数据的长度。示例客户端可能如下所示：

```
import socket
import sys

# Extract the socket data from the file arguments
filename = sys.argv[1]
host = sys.argv[2]
port = int(sys.argv[3])
# Make the socket
sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
sock.connect((host,port))
# Prepare the message to send
data = open(filename).read()
send_str = "send %d %s" % (len(data), filename)
end_str = "end %s" % (filename,)
sock.send(send_str + '\n')
sock.send(data)
sock.send('\n' + end_str + '\n') 
```

无论哪种方式，您都必须对服务器和客户端进行更改。最后，在 C 中实现一个基本的 HTTP 服务器（或获得一个已经实现的）可能会更容易，因为这似乎就是你在这里所做的。编码/填充解决方案速度很快，但会创建大量冗余发送的数据（因为 Base64 通常会导致发送的数据量增加 33%），长度前缀解决方案从客户端也很容易，但在客户端可能更困难服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T13:50:01.660

可能使用

```
sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1) 
```

将有助于根据需要发送每个数据包，因为这会禁用[Nagle 算法](http://en.wikipedia.org/wiki/Nagle's_algorithm)，因为大多数 TCP 堆栈都使用它来将多个小型数据包连接在一起（我相信默认情况下是打开的）

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-15T13:39:25.040

TCP/IP 数据被缓冲，或多或少是随机的。

它只是一个字节的“流”。如果你愿意，你可以读它，就好像它是由'\n'字符分隔的。然而，它并没有被分成有意义的块；也不可能。它必须是连续的字节流。

你是如何用 C 语言阅读它的？你读到'\n'吗？还是您只是在读取缓冲区中的所有内容？

如果您正在读取缓冲区中的所有内容，您应该会看到或多或少随机缓冲的行。

但是，如果您读到 '\n'，您将一次看到每一行。

如果你想让它真正起作用，你应该阅读[http://www.w3.org/Protocols/rfc959/](http://www.w3.org/Protocols/rfc959/)。这显示了如何简单可靠地传输文件：使用两个套接字。一个用于命令，另一个用于数据。

# iphone - iPhone - Importing/Exporting App data?

> ID：647814
> 
> 赞同：3
> 
> 时间：2009-03-15T13:34:40.263
> 
> 标签：iphone, import, export

iPhone apps are great for managing or viewing small elements of data however doing mass and/or long data entry or typing is a pain.

For apps that need to have longer dynamic data that can be used on the iPhone but more easily created at the desktop, what sort of options exist for getting data from the desktop to the iPhone app? Are webservices about the only real option? What other simple solutions exist? Like to find a simplified way for moving data back and forth between iPhone and desktop (Windows and Mac)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T14:53:42.647

一种选择是将设备转入网络服务器，并允许桌面应用程序直接上传到设备，从而避开第三方服务器的必要性。

查看[CocoaHTTPServer](http://code.google.com/p/cocoahttpserver/)以实现 iPhone Web 服务器，它支持下载和上传文件或数据、POST 和身份验证。您可以使用设备的 IP 地址直接连接到设备，或`http://iphone.local`在某些情况下使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T13:43:40.460

我认为简短的回答是肯定的，唯一明智的选择是网络服务。没有可以使用的 iTunes 同步插件，因此您的选项都是基于网络的。

除了 web 服务，您可能还想考虑一个客户端程序，您的 iPhone 应用程序可以使用 Bonjour 找到并连接到该程序。这里明显的缺点是您必须编写客户端应用程序（最好是两个，一个用于 Windows，另一个用于 Mac）并教育您的用户如何下载和安装它们。此外，您还强迫您的用户使用 WiFi 进行同步。

希望下周发布的 iPhone 3.0 包含 iTunes 同步插件...

# c# - 如何从函数调用事件处理程序？

> ID：647815
> 
> 赞同：1
> 
> 时间：2009-03-15T13:34:41.747
> 
> 标签：c#

我有一个类，我从中调用一个`ABC(string st)`带有字符串参数的函数。

该函数在一个`Form`类中定义，`Form1`.

我有一个 listview 并想从函数中自动调用 listview mouse_click 事件 - 我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T13:44:23.733

您不能调用另一个类的事件处理程序 - 事件封装了处理程序的订阅和取消订阅的想法，而不是调用。

您对 ListView MouseClick 事件的哪个方面感兴趣？改变选定的项目就足够了，也许？

# .net - WCF 中的 Web 服务发现：Ws-Discovery 还是 UDDI？

> ID：647816
> 
> 赞同：9
> 
> 时间：2009-03-15T13:35:54.987
> 
> 标签：.net, wcf, discovery, uddi

我知道 UDDI 和 Ws-Discovery 之间的区别（很清楚搜索服务与广播的位置）。但我的问题是：在 WCF 中发现 Web 服务的最简单方法是什么？最简单的意思是什么已经在 WCF 中实现并且现在可以使用？我没有在 WCF 中看到任何用于 UDDI 或 Ws-Discovery 的内置实现。

关于 WCF 中的这两个协议，您有任何链接或经验可以分享吗？

***更新***

现在我正在考虑三种解决方案，等待 .NET 4.0 上的 WS-discovery，或者使用 WCF 提供的 Peer to Peer 绑定创建我自己的发现绑定。这样我可以广播一个请求。或者使用eed3si9n的链接提供的实现。

我想我会做一个网关接口，以便稍后轻松更改实现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-28T05:17:17.577

.NET 4.0 将具有 WS-Discovery。请参阅[.NET 4.0 中的消息传递增强：（发现部分 I）](http://developers.de/blogs/damir_dobric/archive/2008/10/19/ws-discovery-messaging-enhancements-in-net-4-0.aspx) [在 WCF 4.0 中使用 WS-Discovery](http://weblogs.asp.net/gsusx/archive/2009/02/13/using-ws-discovery-in-wcf-4-0.aspx)。与此同时，Claudio Masieri 提供了一个实现。请参阅[WCF 的 WS-Discovery](http://www.codeproject.com/KB/WCF/ws-discovery.aspx)。

还有一个以与 UDDI 类似的方式完成的自定义发现实现。请参阅[Windows 通信服务发现](http://blog.rioterdecker.net/blogs/valhalla/archive/2005/10/17/3.aspx)。

> 想象一下，您有 200 个客户使用您的时髦 Wcf 服务。他们都会在他们的 conf 文件中有一个像这样的部分：

```
<client>
   <endpoint configurationName="default"
               address="http://localhost/servicemodelsamples/service.svc"
               binding="wsHttpBinding"
               bindingConfiguration="Binding1"
              contract="IDataContractCalculator" />
 </client>
 <bindings>
   <wsHttpBinding>
      <binding configurationName="Binding1" />
   </wsHttpBinding>
</bindings> 
```

> 现在，出于安全原因，您决定使用使用 SSL 的新端点更改现有端点（服务器端）。你如何更新你的客户？您可以很快看到它会变得乏味。所以我想在这里详细介绍的想法是实现一个类似于 UDDI 所做的发现服务，并使用元数据解析器从服务中获取配置，以便动态创建一个代理，允许客户端与服务进行讨论。

此人与您有类似的担忧，并且似乎有一个可行的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-16T20:39:49.530

> UDDI 提供了一个中央注册中心来存储有关可用服务的信息。它提供了一个目录，消费者可以在其中找到满足其需求的服务。这种类似电话簿的信息目录允许消费者按名称、地址、合同、类别或其他数据查找服务。UDDI 可以被认为是 Web 服务的 DNS。
> 
> 另一方面，WS-Discovery 提供了一种协议来发现来自网络的服务。当服务加入网络时，它会通过广播 Hello 消息通知其对等方其到达；同样，当服务从网络中掉线时，它们会多播一条再见消息。WS-Discovery 不像 UDDI 那样依赖单个节点来托管有关所有可用服务的信息。相反，每个节点都以特殊方式转发有关可用服务的信息。这减少了发现服务所需的网络基础设施数量并促进了引导。

引自：[http ://travisspencer.com/blog/2007/09/post.html](http://travisspencer.com/blog/2007/09/post.html)

这是一个很好的属性列表： http://laflour.spaces.live.com/Blog/cns!7575E2FFC19135B4! [728.entry](http://laflour.spaces.live.com/Blog/cns!7575E2FFC19135B4!728.entry)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-31T01:53:58.847

jUDDI 有一个您可以使用的 .NET 客户端。它极大地简化了使用 UDDI 的许多事情。

根据经验，WS-Discovery 只有两三个功能性实现。

*   Apache CXF，但仅在容器外部运行时
*   这个：[https](https://code.google.com/p/java-ws-discovery/) ://code.google.com/p/java-ws-discovery/在 Jboss 中不起作用且未维护
*   微软 .NET 4.0ish

UDDI 您可以从任何地方访问。有许多客户端和服务器实现。（此处仅列出了版本 3 的内容）

*   IBM WS-Registry
*   Apache jUDDI
*   带有 Biztalk 的 Microsoft UDDI v3（2008 服务器免费）
*   HP SOA/Systinet 或现在的任何名称
*   WSO2有东西
*   ebXML 有某种桥接器或适配器

甚至还有一个用于 UDDI3 的 REST 端点（jUDDI 3.2 有它，XML 或 JSON 响应），这开启了更多的可能性。

此外，与您可以附加到 UDDI 的几乎无限的数据相比，与 WS-Discovery 共享的数据有些有限。

那只是我的2美分。

# javascript - 动画完成时 Dojo 调整大小和删除元素

> ID：647819
> 
> 赞同：2
> 
> 时间：2009-03-15T13:37:48.867
> 
> 标签：javascript, dojo

使用这样的 div：

```
<div id="im1" class="information_message error">Error message here 
<a href="javascript:hide('im1')">Hide</a></div> 
```

以及以下 dojo/javascript 代码：

```
function hide(id){
    id.innerHTML = '';
    dojo.animateProperty({
        node: id,
        duration: 500,
        properties: {
            height: {end: 0}
        },
        onEnd: function(){
            id.orphan();
        }
        }).play();
    } 
```

我正在尝试执行以下操作：

1.  将 div 的高度调整为 0 的动画
2.  之后从 DOM 中删除元素

但目前文本并没有消失，动画只动画到一半，动画完成后 div 也不会被删除。实现我的目标的正确 javascript 代码是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-16T10:10:07.220

SebaGR，谢谢你把我引向了正确的方向。填充/边距确实有话要说，让动画中途停止。我仍然对元素内的文本和删除onEnd有问题，但最终自己找到了答案。我还添加了一个 wrapper-div`.information_messages`以允许多个`.information_message`元素。最终结果如下：

Javascript：

```
function hide(id){
    dojo.byId(id).style.overflow = 'hidden';
    dojo.animateProperty({
        node: id,
        duration: 500,
        properties: {
            height: {start: dojo.contentBox(id).h, end: 0},
            margin: {end: 0},
            marginBottom: {end: 0},
            padding: {start: 10, end: 0},
            paddingLeft: {end: 10 },
            paddingRight: {end: 10 },
            borderWidth: {start: 1, end: 0}
        },
        onEnd: function(){
            dojo.query('#' + id).orphan();
            // when all information_message elements are deleted, delete
            // the information_messages container as well. Animate 
            // padding change to prevent sudden 'jump' on deletion.
            if(dojo.query('.information_message').length == 0){
                dojo.animateProperty({
                    node: dojo.query('#information_messages')[0],
                    duration: 500,
                    properties: {
                        padding: {start: 5, end: 0}
                    },
                    onEnd: function(){
                        dojo.query('#information_messages').orphan();
                    }
                }).play();
            }
        }
    }).play();
} 
```

HTML：

```
<div id="information_messages">
    <div class="information_message success" id="im1">
        <a href="javascript:hide('im1');" class="right">Hide</a>
        Success message 1
    </div>
    <div class="information_message error" id="im2">
        <a href="javascript:hide('im2');" class="right">Hide</a>
        Error message 1
    </div>
</div> 
```

CSS：

```
#information_messages {
    padding: 5px;
}

.information_message {
    margin-bottom:3px;  
}

.error {
    border: 1px solid #b2110a;
    background-color: #f3dddc;
    padding: 10px;
}

.success {
    border: 1px solid #177415;
    background-color: #d6f6d5;
    padding: 10px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-16T03:01:06.300

不知道为什么它没有被删除，因为我不使用 DOJO 而是使用 jQuery。

但是我遇到了动画在 jQuery 中完成一半的问题，这是因为边距/填充。将动画添加到填充和边距为 0，如下所示：

```
function hide(id){
    id.innerHTML = '';
    dojo.animateProperty({
        node: id,
        duration: 500,
        properties: {
                height: {end: 0},
                margin: {end: 0},
                padding: {end: 0}
        },
        onEnd: function(){
                id.orphan();
        }
        }).play();
    } 
```

我相信这可能有助于动画未完成。

关于元素移除，在黑暗中拍摄：

```
 onEnd: function(){
                dojo.query("#"+id.id).orphan();
        } 
```

请注意，在您的代码中，您在 DOM 对象而不是 DOJO 集上调用 orphan()。也许这可以解决它。

# certificate - 自签名证书问题

> ID：647825
> 
> 赞同：0
> 
> 时间：2009-03-15T13:43:49.617
> 
> 标签：certificate, root, self-signed, ca

我在我的测试环境中做自签名证书。这是有关我在做什么的更多详细信息。

[http://www.hanselman.com/blog/SigningPowerShellScripts.aspx](http://www.hanselman.com/blog/SigningPowerShellScripts.aspx)

我的简要步骤是（目的是基于证书在计算机C和计算机A之间建立信任连接），

1.  使用 makecert.exe 使计算机 A 成为根 CA；
2.  自签名证书 B，由计算机 A 作为根 CA 颁发；
3.  在计算机A上安装证书B作为通信时使用的证书；
4.  在计算机 C 中安装/信任根 CA（计算机 A）；
5.  然后计算机 C 将信任计算机 A 使用证书 B 进行的通信。

我的困惑是，计算机 C 在不安装证书 B 的情况下信任计算机 A？我认为根CA的证书和对方的证书都需要安装。有什么意见或想法吗？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T14:29:57.120

至少在语义上，您的第 2 步不正确。如果您正在生成由 CA 签名的证书，那么它根本不是自签名的，它是由 CA 签名的。

因此，在机器 C 上，您只需将生成的 CA 证书放在受信任的 CA 存储中。通过这样做，您表示您信任它签署的任何内容，在您的情况下是证书 B。

但是，您说您正在使用它进行通信 - 请注意，如果您使用 WCF 之类的东西来检查撤销，您将需要关闭它，因为您生成的 CA 不支持它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T14:24:28.147

计算机 C 必须信任根 CA（在计算机 A 上）。然后，由同一根 CA 颁发的另一台计算机（例如计算机 D）提供的任何证书都将被自动信任。

例如，在 Windows 中，您（默认情况下）已经拥有并信任 Verisign 的根 CA 证书。当您导航到使用 Verisign 证书的 HTTPS 站点时，您将自动信任它 - 因为您信任 Verisign，并且 Verisign 将证书颁发给 HTTPS 站点。

IOW - 您只需要信任 CA 并安装它的证书。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T14:44:14.807

计算机 A 实际上并没有成为“根 CA”。您需要创建一个根证书，然后将其安装在目标计算机上。

这并不像在目标计算机上安装根证书那么简单，因为不同的应用程序可能使用不同的证书存储。例如，您需要在 Firefox 和 Explorer 中安装根证书。

然后，您可以创建“子”证书 - 由根证书签名 - 目标系统将接受子证书为有效，因为它已由受信任的根证书签名。

证书只是验证某人公钥的一种方式。该证书既包含您的纯文本公钥，也包含由签名者的私钥加密的公钥。要验证证书中发布的公钥，您需要解密公钥的加密版本 - 使用签名者的公钥 - 并检查它是否与公钥的纯文本版本相同。

在自签名证书中，您使用您的私钥加密您的公钥。所以自签名证书也是根证书，因为链中没有更高的签名权限。

中间证书也可用于签署其他证书。通过这种方式，证书可以用来建立一个“信任链”回到一些（至少在理论上）受信任的根证书。

Bruce Schneier 在他的《应用密码学》一书中对此进行了合理的描述。Peter Gutman 在此链接中对证书进行了更丰富多彩的描述：

[http://www.cs.auckland.ac.nz/~pgut001/pubs/pkitutorial.pdf](http://www.cs.auckland.ac.nz/~pgut001/pubs/pkitutorial.pdf)

# java - 你打算在什么项目上使用 Scala 编程语言？

> ID：647827
> 
> 赞同：7
> 
> 时间：2009-03-15T13:44:33.967
> 
> 标签：java, scala, jvm

您在哪里看到将 Scala 用于您的项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T13:50:34.827

我曾想过在我的项目中使用 Scala（交易服务器软件——我特别喜欢它的 Erlang 风格的演员模型），但 Scala 仍然存在一些性能问题（我希望他们能尽快修复它）。否则，这很好（在 IntelliJ IDEA 中获得不错的 IDE 支持）。

不过，我用 Java 重新实现了 Scala 角色模型的重要部分。有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-20T18:01:54.623

最近我研究了 Scala 编程语言，我的印象与我对其他函数式编程语言的印象非常相似。Scala 在某些方面做得非常好，但这并不意味着我会选择它作为我在项目中的主要编程语言。它简洁且有利于并发性，因此我想用它来实现它适合的项目的一部分。

以推特为例。他们遇到了可伸缩性问题，因为他们在 Ruby 中的消息队列无法为他们提供所需的吞吐量——主要原因是在 Ruby 及其 GC 中实现线程的方式。一个非常好的采访是[http://www.artima.com/scalazine/articles/twitter_on_scala.html](http://www.artima.com/scalazine/articles/twitter_on_scala.html)。Twitter 开发人员谈论了他们选择 Scala 的原因以及他们面临的问题以及为什么他们认为它只适合他们整个应用程序堆栈的一部分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T14:15:34.643

不。

当我最后一次查看它时，对于某些现实世界的项目，我不需要它的支持：

*   IDEA 和 Eclipse 中良好的 IDE 支持
*   广泛的文档
*   坚实的用户基础

我认为目前对于客户和同事来说，使用 Scala 不是一个负责任的决定。如果事情变得丑陋，可以很容易地被 groovy 或 java 替换的小型库可能是个例外。

尽管我真的很喜欢 Scala 中的功能组合，但它似乎并没有得到现实世界的关注。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-28T17:12:16.180

我已经玩了一些，但没有找到适合我们的软件（内部使用业务流程的东西）。不过，我可以看到它可能非常适合科学界。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-18T19:24:42.020

@Jens Schauder Scala IDE 支持自您上次查看以来已经彻底成熟。我们最近检查了对 Eclipse 的支持，该插件非常棒——它可以顺利安装和无缝运行。

我建议您再试一次，并在此处或其他任何地方对您的体验发表评论。事实上，我们刚刚完成了一个基于 Scala 的项目——我必须承认这是一次经历，但绝对值得。

我的建议是：获取适合您选择的 IDE 的插件，并获取一些非关键项目以愤怒地尝试它。

祝你好运 ：）

# automation - 有人推荐软件产品线生成的“纯变体”吗？

> ID：647830
> 
> 赞同：0
> 
> 时间：2009-03-15T13:45:26.290
> 
> 标签：automation, software-product-lines

我正在与我的教授合作开发用于在线测试自动构建的软件产品线。他向我推荐了“Pure Variants”作为一个开源工具，可以用作 Eclips 的插件。但是，我不确定是去寻找它还是寻找其他的。所以如果你推荐这个工具，那么请告诉我你为什么这么认为，或者为我推荐另一个你发现更好的工具！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-16T08:42:56.417

事实上 pure::variants 不是开源的，但有一个供个人使用的社区版本。我认为您应该进行搜索，因为学习做到这一点可以帮助您未来的学术生涯，但您只会找到另一种专门为*[软件产品线](http://www.software-acumen.com/about-product-lines/)*开发而开发的工具。

# c# - 在另一个页面中呈现一个 aspx 页面

> ID：647833
> 
> 赞同：9
> 
> 时间：2009-03-15T13:48:47.187
> 
> 标签：c#, asp.net, rendering

在我的 Web 项目的业务对象编辑器页面中，我在对象插入或更新后向管理员发送了一封通知电子邮件。但是，我不想发送纯文本邮件，而是想发送另一个我只是为此目的准备的 aspx 页面（Notification.aspx）的 html 输出。

首先我想，我可以创建一个 Notification.aspx 的实例，然后使用它的 RenderControl 方法来获取输出。

但是，在 Editor.aspx 页面的代码隐藏中，我什至无法访问通知的引用来创建新实例。

我想知道在另一个页面中加载和呈现页面的最佳做法是什么......

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-15T14:12:45.383

您可以通过执行以下操作来呈现页面：

```
StringWriter _writer = new StringWriter();
HttpContext.Current.Server.Execute("MyPage.aspx", _writer);

string html = _writer.ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T14:07:54.893

请参阅此问题/答案：[我可以在 ASP.NET 上用 C# 设置 HTML/电子邮件模板吗？](https://stackoverflow.com/questions/620265/can-i-set-up-html-email-templates-in-c-on-asp-net/620337#620337). Mark Brackett 有你正在寻找的东西，尽管那里也有很多其他有用的建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T14:10:02.143

当发出请求时，页面类由 ASP.NET 运行时实例化。因此，您可以发出请求并获取响应：

```
using (WebClient client = new WebClient())
using (Stream stream = client.OpenRead("http://mysite.com/notification.aspx"))
using (StreamReader reader = new StreamReader(stream))
{
    var contents = reader.ReadToEnd();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T14:10:30.677

听起来很棘手。请记住，页面也需要适当的 HttpContext 才能正确呈现。

我会考虑改用 UserControl。这些可以使用该`Page.LoadControl()`方法简单地加载和呈现。使用一些 jiggery-pokery，您可以在提取它的 HTML 时阻止它在页面中呈现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T14:13:19.920

RenderControl 不起作用，因为 Page 不会经历它的生命周期。过去，出于类似目的，我使用 HttpHandler 和 Response.Filter 来捕获流。我以前在[ASP.NET 论坛上](http://forums.asp.net/p/1200166/2088266.aspx#2088266)发布过代码。

编辑：如果您需要修改页面输出，您应该将它与MartinNH[指出的](https://stackoverflow.com/questions/647833/rendering-an-aspx-page-in-another-one/647866#647866)[Server.Execute](http://msdn.microsoft.com/en-us/library/ms150027.aspx)重载结合起来。这将简化代码，删除 Response.Filter 等。如果只想直接输出页面，MartinNH的方法*很*干净。

 ** * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-25T00:05:00.090

这就是你要找的：

```
Type t = BuildManager.GetCompiledType("~/mypage.aspx");
Page p = (Page)Activator.CreateInstance(t);
p.ProcessRequest(HttpContext.Current); 
```

从这里发挥你的想象力......

# c - 用于嵌入式应用的音频 (MP3) 编解码器

> ID：647838
> 
> 赞同：2
> 
> 时间：2009-03-15T13:53:13.167
> 
> 标签：c, audio, embedded, mp3, codec

我正在寻找用于嵌入式应用程序 (C/C++) 的基于软件的编解码器库。我对商业和免费编解码器库都感兴趣。任何建议都将受到欢迎。

此外，如果您对[OpenSL ES](http://www.khronos.org/opensles/)有任何经验并知道哪些软件/硬件解决方案兼容，我将很高兴听到。

我需要支持流行的编解码器。MP3是必须的。我正在为一个嵌入式应用程序实现一个媒体播放器参考，不能只告诉用户：“嘿，把你所有的音乐库都转换成 Vorbis；它好多了。” 强制支持 MP3 编解码器，但我很高兴找到一个更高级的库来处理更多编解码器（更多音频编解码器、视频编解码器等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T15:00:50.400

看看[libvorbis](http://xiph.org/vorbis/)，一个相当不错的开源 BSD 音频编解码器。还有一个名为 Tremor 的 vorbis 参考解码器，它只使用整数算术，因此可以在没有浮点的架构上使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T14:58:35.053

Vorbis 编解码器是开源的，是 MP3 的良好替代品。

在快速浏览 OpenSL ES API 之后，似乎已经定义了一些编解码器：

```
#define SL_AUDIOCODEC_PCM         ((SLuint32) 0x00000001)
#define SL_AUDIOCODEC_MP3         ((SLuint32) 0x00000002)
#define SL_AUDIOCODEC_AMR         ((SLuint32) 0x00000003)
#define SL_AUDIOCODEC_AMRWB       ((SLuint32) 0x00000004)
#define SL_AUDIOCODEC_AMRWBPLUS   ((SLuint32) 0x00000005)
#define SL_AUDIOCODEC_AAC         ((SLuint32) 0x00000006)
#define SL_AUDIOCODEC_WMA         ((SLuint32) 0x00000007)
#define SL_AUDIOCODEC_REAL        ((SLuint32) 0x00000008) 
```

您可能应该了解您是否仅限于这些。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T09:08:48.247

免责声明、全面披露等：我目前在那里作为承包商工作。

一方面，您对解码器或完整的编解码器（解码器+编码器）感兴趣吗？

我想答案取决于你的具体情况。如果您正在为您的嵌入式平台寻找一个完整的播放器，[恩智浦软件](http://www.software.nxp.com/)可能是一个解决方案。它们还提供其他应用程序，例如录音机。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-10-14T15:55:44.040

编码还是解码？

LAME (mp3) 和 FFmpeg（几乎所有其他内容，音频和视频）应该可以解决问题，尽管我认为带有 FFmpeg 的 Vorbis 编码器质量很差，您应该尽可能使用单独的编码器。（我不知道这个建议是否仍然有效。）

免责声明：我最近读了很多关于编解码器的文章，但我还没有对它们做任何事情，所以我还不知道我在说什么。

# regex - 文本编辑器中的跨行正则表达式搜索和替换

> ID：647842
> 
> 赞同：2
> 
> 时间：2009-03-15T13:54:35.910
> 
> 标签：regex, text-editor

我正在寻找一个允许跨行正则表达式搜索和替换的开源文本编辑器。

因此，例如用 \n-----------------\n 替换 \n ，因此在行之间引入虚线。

或者我可以搜索 08\nERROR 并找到

```
INFO 9329 21 June 2008
ERROR 3832 21 June 2008 
```

UltraEdit 有这个功能，但那是一个商业产品。查了Notepad++、CrimsonEdit等，没有找到跨行查找替换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T14:37:38.693

Vim 知道如何做到这一点。

例如，如果您有：

```
if (a) {
    x++;
} else {
    x--;
} 
```

然后搜索`/;\n.*else`会发现这个：

```
 ;
} else 
```

并执行此替换：`:s/;\n\(.*else\)/;\r//----\r\1/`将执行以下操作：

```
if (a) {
    x++;
----
} else {
    x--;
} 
```

（请注意，我搜索了换行符，`\n`但必须`\r`在替换字段中使用）

当然，这也适用于您的示例：

搜索`08\nERROR`并找到：

```
 08
ERROR 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T06:47:12.030

在撰写本文时，Notepad++ 不支持此功能——但现在最新版本支持！

# java - 设备未连接异常

> ID：647846
> 
> 赞同：0
> 
> 时间：2009-03-15T13:57:34.263
> 
> 标签：java, file, ioexception

我尝试打开大量文件，但在 5000 个文件之后我得到了

```
Exception in thread "Main" java.io.IOException: The device is not connected 
```

这是预期的行为吗？有办法解决吗？我想让我的代码尽可能简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T03:46:52.743

*   您的操作系统可能会限制一个进程可以打开的文件数量。
*   通常，您要小心使用 java 中打开的文件等资源。除非您有特定的理由让所有这些文件保持打开状态，否则最好阅读每个文件，提取所需的数据，然后关闭。

你到底想达到什么目的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T14:06:46.863

打开的文件有一些资源成本，因此当许多文件已经打开时打开另一个文件失败是预期的行为。至少它是我自己的期望。

例如见：[http ://www.msfn.org/board/lofiversion/index.php/t101414.html](http://www.msfn.org/board/lofiversion/index.php/t101414.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T15:04:07.647

如果您在使用完文件后记得关闭（）文件，那么打开数千个文件应该不是问题吗？

如果不是，则强制操作系统维护打开文件的状态，这通常是有限的资源。

如果您确实需要大量同时打开的文件，则解决方案取决于具体情况。你需要做什么？请显示代码。

# css - 如何选择 CSS 框架？

> ID：647853
> 
> 赞同：18
> 
> 时间：2009-03-15T14:05:55.757
> 
> 标签：css, frameworks

我在公司网站上工作，我认为我应该开始使用 CSS 框架。周围有很多 CSS 框架，最常用的一个是什么，为什么人们会选择使用它而不是其他框架？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-15T14:22:19.570

首先，不要自动假设 CSS 框架是必要的，甚至是可取的。取决于你在做什么以及你在标记 + CSS 方面有多好，这可能不值得。维基[百科的文章](http://en.wikipedia.org/wiki/CSS_framework)几乎没有触及我在网上看到的辩论的表面，例如[对 YUI Grids 框架的批评](http://www.elliotswan.com/2006/05/10/yui-grids-css-framework-considered-harmful/)。

如果您决定 CSS 框架适合您，那么您需要决定它将为您解决什么问题。获得该列表后，您可以开始比较不同的列表，看看它们如何解决您的问题。

最后，有许多次要因素可能会改变您的特定应用程序的平衡。已经在网站上使用 YUI？然后[Reset](http://developer.yahoo.com/yui/reset/)、[Base](http://developer.yahoo.com/yui/base/)、[Fonts](http://developer.yahoo.com/yui/fonts/)和[Grids](http://developer.yahoo.com/yui/grids/)组合可能会出现凹凸等。

我最常看到的两个参考是 YUI 和[BluePrintCSS](http://www.blueprintcss.org/)（这里有一个[比较](http://foohack.com/2007/08/blueprint-css-framework-vs-yui-grids/)）。

更新：我还没有看到 CSS 框架明确解决的一件事是[将 Web 上的类型设置为基线网格](http://www.alistapart.com/articles/settingtypeontheweb)（有关详细信息，请参阅[这篇关于按垂直节奏组合的文章）。](http://24ways.org/2006/compose-to-a-vertical-rhythm)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T14:18:40.313

你最好不要。

构建自己的 CSS 比学习框架的复杂性要方便得多。YMMV，但我发现他们浪费时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T14:14:52.710

Afaik，最流行的两个是[蓝图](http://www.blueprintcss.org/)和[960 网格系统](http://960.gs/)。
两者都有自己的优势。我喜欢960gs。

还有一个 SO question 在[这里讨论这两者](https://stackoverflow.com/questions/589184/help-me-choose-a-css-framework-960-vs-blueprint-vs/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T00:19:46.903

如果您需要构建没有默认宽度限制、流动和固定列、轻量级、基线网格、可选语义、% 和基于定位的网格的复杂网格，我的建议是使用我的[CSS 框架 Emastic](http://code.google.com/p/emastic/)。

如果您需要更简单的东西，您可以使用[Malo](http://code.google.com/p/malo/)或类似于 Blueprint 或 960.gs 但重量只有 1kb[的 Golden Grid](http://code.google.com/p/the-golden-grid/)。小心并非总是 CSS 框架是好主意。我还写了一篇关于[何时使用 CSS 框架](http://www.vcarrer.com/2008/08/when-to-use-css-framework.html)？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-16T02:55:30.837

[Compass](http://acts-as-architect.blogspot.com/2008/11/introducing-compass.html)是一个看起来很有趣的 CSS 框架。它可以使用 blueprint、960.gs、YUI 和可能的其他文件作为基础运行，但只是提取项目所需的内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-11-19T19:10:12.900

忘记框架，使用[XCSS](http://xcss.antpaw.org/)。你会喜欢再次编写样式表。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-29T19:00:23.210

我用过 YUI、BlueprintCSS。

将来我会考虑使用 960gs，但很可能会使用 twitter bootstrap [https://github.com/twitter/bootstrap/](https://github.com/twitter/bootstrap/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-15T14:22:03.800

我仍然需要丰富我在 CSS 框架方面的经验，但我使用最多的是[YUI CSS 库](http://developer.yahoo.com/yui/grids/)。

这是一个四部分设置 - 包括重置、网格包、字体设置（不完全确定使用它们的优点是什么）和应用一些基本格式的基本样式表。您可以选择要使用的部分，并且可以从[Yahoo! 上的 CDN使用它们 和谷歌](http://developer.yahoo.com/yui/articles/hosting/)。

我喜欢 YUI 库，因为它提供了一个易于切换的布局（只需更改容器包装器的一个类或 id） - 例如`yui-t4`在右侧提供 180px 列，在左侧`yui-t3`提供 300px 列 - 这些模板也采用广告-块大小也是有用的。

基本标记也不错：

```
<div id="doc"><!—-overall document wrapper-->
    <div id="hd"><!--header / masthead--></div>
    <div id="bd">
        <div id="yui-main">
            <div class="yui-b"><!--primary block--></div>
        </div>
        <div class="yui-b"><!--secondary block--></div>
    </div>
    <div id="ft"><!--footer--></div>
</div> 
```

# .net - 为什么我必须编译以获取 asp.net mvc 中 HTML 帮助器对象的智能感知

> ID：647861
> 
> 赞同：1
> 
> 时间：2009-03-15T14:08:55.797
> 
> 标签：.net, asp.net-mvc, visual-studio-2008

当我添加一个新视图时，我在编译之前不会获得 HTML 帮助器对象的智能感知。我想这一定是VS的问题。但是当我编译时会发生什么变化？是什么让它发挥作用？

编辑：更多细节

我在 VS2008 pro 上运行 RC1。自从我使用预览版 2 开始使用 MVC 以来，我就遇到了这个问题。当我创建一个新视图时，在我再次编译之前，我不会获得 HTML 帮助器对象的智能感知。我已经在其他地方看到过这个问题，问题的重点是编译使智能感知工作的原因。

编辑：更新详细信息

我刚刚更新到 RC2 仍然有这个问题。我办公室的所有机器上都有它。他们都在 Vista 32 或 64 位业务上运行 VS2008 sp1 pro

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T03:46:51.790

这似乎是预期的行为。一个[ASP.NET MVC 教程](http://www.asp.net/learn/mvc/tutorial-21-cs.aspx)有这样的说法：

> 您应该在打开“添加视图”对话框之前构建您的项目（选择菜单选项“构建”、“构建解决方案”），否则“视图数据类”下拉列表中将不会出现任何类。

该教程没有解释为什么会这样，它只是提到它是。智能感知实际上可能正在查看已编译的对象，而不是源代码。

# c - 如何在 Debian 上编译 DOS 程序？

> ID：647872
> 
> 赞同：10
> 
> 时间：2009-03-15T14:15:44.890
> 
> 标签：c, assembly, debian, nasm, dos

对于我的汇编语言课，我们正在使用 DPMI 编写 DOS 程序。不幸的是，我一直无法访问 32 位 Windows 机器。我确实在我使用的每台计算机上都安装了 Debian 虚拟机。

我已经安装了 DOSBox 和 DOSEMU。有什么方法可以在 Linux 而不是 DOS 中组装和编译程序？我正在使用 nasm，所以在 DOS 格式下组装它似乎没有任何问题。但是，我无法使用我的 C 代码通过编译器运行它并获得 DOS 可执行文件（使用 gcc 或 MinGW）。

有什么方法可以做到这一点，还是我几乎必须在 DOS 下安装所有工具？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-15T14:29:31.363

我什至不确定您是否可以使用 GCC 编译 DOS 应用程序。很久以前有一个 gcc 编译器变体，称为 DJGPP（或类似的东西）。我从来没有让它工作。

如今，您可以为 DOS 交叉编译 GCC 的机会几乎为零。

我建议你试试旧的 Watcom 编译器。它是一个原生的 DOS 编译器，它的 DPMI 实现在 DosBox 下也能像魅力一样工作。与 NASM 编译的目标文件接口也不是问题（我做了几年）

今天，该编译器已开源并称为 OpenWatcom。

[http://www.openwatcom.org/index.php/Main_Page](http://www.openwatcom.org/index.php/Main_Page)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-10-02T20:04:22.453

[BCC](http://linux.die.net/man/1/bcc)在 debian 中，能够为 8080 到 80386 生成体面的代码。使用该`-Md`开关生成 MS-DOS 二进制文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-15T15:10:23.217

可能对您来说最简单的方法是使用标准的 DOS 工具来完成任务。

[DOSBOX](http://www.dosbox.com/)是一个非常好的模拟器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-13T09:25:03.477

DJGPP 非常容易安装，最少只需要三个 .ZIP：

1.  `BNU219B.ZIP`（汇编器，链接器，图书馆员）
2.  `GCC441B.ZIP`（C 编译器）
3.  `DJDEV204.ZIP`（libc，标头）

[http://www.delorie.com/djgpp/getting.html](http://www.delorie.com/djgpp/getting.html)

```
unzip *.zip -d c:\djgpp && 
set DJGPP=c:\djgpp\djgpp.env &&
path c:\djgpp\bin;%PATH%

gcc myfile.c -o myfile.exe 
```

要生成与 DOS 兼容的输出，您必须在 DOSEMU 中使用 DOS 托管的编译器（不是 DOSBox ！！太慢且有缺陷，仅适用于游戏）或使用 Linux 托管的交叉编译器（DJ 的网站上有RPM）。

但是，如果您想要 100% 的 16 位代码，您将不得不使用其他东西（例如 OpenWatcom）。OpenWatcom 也支持 Linux（测试版！！）主机和目标（虽然没有共享库，IIRC），但您可能必须自己使用 GCC 编译它。

# .net - 如何使用 VS Studio 2005/2008 进行有效的重构

> ID：647873
> 
> 赞同：1
> 
> 时间：2009-03-15T14:16:26.293
> 
> 标签：.net, visual-studio, refactoring, resharper

我正在寻找使用 VS Studio 2005/2008 改进重构技术的经验/工具。
目前我只使用标准的重构菜单选项：
重命名...
提取方法...
封装字段...
[替代文本 http://img208.imageshack.us/img208/5852/vsrefactor.gif](http://img208.imageshack.us/img208/5852/vsrefactor.gif)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T14:22:41.067

[更清晰](http://www.jetbrains.com/resharper/)。安装它后的最初几周，我每天都发现一些新的和有用的东西。最好的有时非常简单，但它们自动化了通常非常乏味的活动，以至于我不得不在没有安装 Resharper 的机器上工作。例如，“将此类移出到一个以它命名的单独文件中”意味着我主要只是键入代码，而不必手动将文件添加到项目中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T15:00:45.673

使用 Resharper 或 CodeRush&RefactorPro 之一（或免费的 CodeRush Xpress）

我个人认为 CodeRush/RefactorPro 是猫睡衣——但众所周知，理性的人更喜欢 Resharper。

这两种工具都提供了丰富的代码模板、重构工具和分析功能，让您可以更多地考虑代码的意图和逻辑，而不必考虑键入代码的机制。

这是[RefactorPro 重构的列表](http://devexpress.com/Products/Visual_Studio_Add-in/Refactoring/info.xml)

CodeRush/RefactorPro 的一个关键区别在于 UI 的质量。Resharper 看起来 UI 是由程序员开发的，而 CodeRush/RefactorPro 看起来像是由**设计师设计**的。此外，CodeRush 有助于从基本声明（类、函数、变量等）到复杂语句的所有代码的初始编写。例如，只需观看 'sw ' 模板以枚举类型进入城镇。

值得每一分钱。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T14:52:03.867

我更喜欢[CodeRush Xpress](http://msdn.microsoft.com/en-us/vcsharp/dd218053.aspx)而不是 Resharper，因为后者让我的机器爬行。有关功能列表，请参阅链接。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-16T15:25:11.003

[DevExpress](http://devexpress.com)提供了一些免费的工具。请检查一下。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T14:22:49.243

[ReSharper](http://www.jetbrains.com/resharper/)可能是一种选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T14:58:56.067

我也使用 Resharper 并且对它非常满意，但如果你只有 VS，它仍然比没有好得多。VS 中（有限的）重构选项的好处是，与 Resharper 相比，它们非常轻量级，并且确实支持一些非常有用的功能。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T14:08:54.473

对于“经验”部分，你可以看看这本书：

[C# 和 ASP.NET 中的专业重构](https://rads.stackoverflow.com/amzn/click/com/047043452X)

# python - 从服务调用发布图像时 Django 中的文件处理

> ID：647888
> 
> 赞同：7
> 
> 时间：2009-03-15T14:23:25.480
> 
> 标签：python, django, apache-flex, pyamf

我正在使用[PyAMF](http://pyamf.org/)将动态生成的大图像从 Flex 传输到 Django。在 Django 端，我收到编码的 b64 数据作为参数：

我的项目模型作为图像域。我有麻烦做的是将数据保存为文件 Django 字段。

```
def save_item(request, uname, data):
    """ Save a new item """    
    item = Item()

    img = cStringIO.StringIO()
    img.write(base64.b64decode(data))
    myFile = File(img)

   item.preview.save('fakename.jpg', myFile, save=False) 
```

那是行不通的，因为我来自 StringIO 的 File 对象错过了一些属性，例如模式、名称等。

我还认为使用 StringIO 会将图像数据完全加载到内存中，这很糟糕，所以我可能会在这种特殊情况下放弃 AMF 并使用 POST。

你怎么看 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-15T16:08:11.487

在`django.core.files.base`你可以找到类`ContentFile`。该类扩展了基本的 Django`File`类，因此您不需要 StringIO（虽然 ContentFile 在内部使用）。修改后的保存方法如下所示：

```
from django.core.files.base import ContentFile
def save_item(request, uname, data):
    item = Item()
    myFile = ContentFile(base64.b64decode(data))
    item.preview.save('fakename.jpg', myFile, save=False) 
```

# c - 如何像在 Autotools 中一样检查 CMake 中的头文件和库函数？

> ID：647892
> 
> 赞同：16
> 
> 时间：2009-03-15T14:24:45.540
> 
> 标签：c, cmake, autotools

我目前正在将一个小型 C 项目从[autotools](http://en.wikipedia.org/wiki/GNU_build_system)转换为[CMake](http://en.wikipedia.org/wiki/Cmake)。

在旧版本中`configure.in`，我使用以下几行检查了每个头文件和库函数是否存在：

```
# Checks for header files
AC_HEADER_STDC
AC_CHECK_HEADERS([stdlib.h time.h math.h sys/stat.h errno.h unistd.h fcntl.h signal.h])

# Checks for library functions
AC_FUNC_FORK
AC_CHECK_FUNCS([time localtime mktime gmtime exit fork chdir atol signal])
AC_FUNC_STRFTIME 
```

这是许多自动工具项目所做的 AFAIK。

尽管编译器已经检查了必要的头文件并且链接器检查了库函数，但我的代码仍然需要在配置阶段完成这些检查才能正确设置它的编译标志`#ifdef HAVE_FOOBAR`等。

在这种情况下，使用 CMake 检查标头/函数的最佳做法是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-17T08:43:35.343

您可以轻松地直接使用[`CHECK_FUNCTION_EXISTS`](http://www.cmake.org/cmake/help/cmake2.6docs.html#module:CheckFunctionExists)、[`CHECK_INCLUDE_FILE`](http://www.cmake.org/cmake/help/cmake2.6docs.html#module:CheckIncludeFile)、[`CHECK_TYPE_SIZE`](http://www.cmake.org/cmake/help/cmake2.6docs.html#module:CheckTypeSize)等进行移植。另请参阅[CMake_HowToDoPlatformChecks](https://gitlab.kitware.com/cmake/community/wikis/doc/tutorials/How-To-Write-Platform-Checks)以获得一些建议。

* * *

以这种方式进行配置增加了可移植性（即，您可以检查`ucontext.h`并`setjmp.h`使用现有的，用`#ifdef HAVE_UCONTEXT`or修改您的代码`#ifdef HAVE_SETJMP`）。

此外，当您分发应用程序时，您希望避免出现编译错误（对于用户而言），因此通过良好的构建系统，您可以在分发应用程序之前处理大部分架构差异。

非程序员更容易理解，如果“检查 gtk+ 标头 - 失败”，他们必须安装 gtk，而不是有一堆编译错误行说同样的事情，但对他们中的大多数人来说是不可读的 :)

# python - Python - 未引发异常时测试成功

> ID：647900
> 
> 赞同：17
> 
> 时间：2009-03-15T14:33:34.303
> 
> 标签：python, unit-testing, exception, exception-handling

我知道`unittest`Python 模块。

我知道上课`assertRaises()`的方法`TestCase`。

我想编写一个在**未**引发异常时成功的测试。

请问有什么提示吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-15T14:48:33.657

```
def runTest(self):
    try:
        doStuff()
    except:
        self.fail("Encountered an unexpected exception.") 
```

更新：正如 liw.fi 提到的，默认结果是成功的，所以上面的例子是一种反模式。如果您想在失败之前做一些特别的事情，您可能应该只使用它。您还应该捕获最具体的异常。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-15T15:03:50.797

测试运行程序将捕获您未断言的所有异常。因此：

```
doStuff()
self.assert_(True) 
```

这应该可以正常工作。您可以省略 self.assert_ 调用，因为它实际上并没有做任何事情。我喜欢把它放在那里以证明我没有忘记一个断言。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-01-17T09:39:07.793

我将这种模式用于您所要求的那种断言：

```
with self.assertRaises(Exception):
    try:
        doStuff()
    except:
        pass
    else:
        raise Exception 
```

当 doStuff() 引发异常时，它将失败。

# sql - 以下作业的算法

> ID：647901
> 
> 赞同：3
> 
> 时间：2009-03-15T14:34:44.253
> 
> 标签：sql, sql-server-2005

您需要一种算法在月初读入一个客户的账户余额、当月所有提款总额以及当月所有存款总额。当月进行的所有交易均需缴纳 1% 的联邦税费。该程序是通过（1）从月初的账户余额中减去总提款，（2）将总存款添加到新余额中，（3）计算联邦税来计算月底的账户余额（总交易的 1% - 即总提款 + 总存款），以及 (4) 从新余额中减去该联邦税。在这些计算之后，打印最终的月末余额。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T14:59:24.053

这将是一个简单的伪代码翻译。由于这是一项家庭作业，您必须自己完成跑腿工作。只需依次评估每个步骤：

```
input: accountBalanceStart, totalDeposits, totalWithdrawals
output: accountBalanceEnd 
```

让我们迈出第一步：

```
accountBalanceEnd <-- accountBalanceStart - totalWithdrawals 
```

现在是第二个：

```
accountBalanceEnd <-- accountBalanceEnd + totalDeposits 
```

接下来，计算税收并减去它：

```
accountBalanceEnd <-- accountBalanceEnd - (totalWithdrawals + totalDeposits) * 0.01 
```

最后，显示结果：

```
print accountBalanceEnd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T14:58:48.127

这恰好是 2008 年 4 月 17 日到期的 www.palinfonet.com/hw_java2008.pdf 上的作业问题，问题 #3。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T15:21:24.343

我同意其他海报的观点，这既不是问题，也不是人们要做功课的地方。但以防万一你真的完全不知道我举一个更具体的例子。

您最有可能需要阅读的内容：

[PL/SQL](http://en.wikipedia.org/wiki/PL/SQL)

[SQL 快速参考](http://www.w3schools.com/sql/sql_quickref.asp)

我可能会尝试这样的事情。我故意没有测试或评论它，而且 mssql 的语法也可能是错误的。

```
 CREATE OR REPLACE FUNCTION Calculate_Balance(account_id long, account_balance float, date datetime) RETURNS float AS
    DECLARE
    transactions_sum float;
    fed_tax float;
    new_account_balance float;              
BEGIN
    transactions_sum = SELECT SUM(amount) from transactions 
        WHERE transactions.account_id = account_id 
        AND month(transactions.date) = month(date) 
        AND year(transactions.date) = year(date);

    fed_tax = transactions_sum * 0,01;
    transactions_sum = transactions_sum - fed_tax;
    new_account_balance = transactions_sum + account_balance;

    RETURN new_account_balance;
END; 
```

# c - 与 Microsoft C 运行时库中的函数有什么关系？

> ID：647903
> 
> 赞同：2
> 
> 时间：2009-03-15T14:36:17.197
> 
> 标签：c, runtime

[MSDN 上的这个页面](http://msdn.microsoft.com/en-us/library/t0wd4t32(VS.80).aspx)似乎列出了一堆文件操作，它们的行为或多或少与[本示例](http://msdn.microsoft.com/en-us/library/aa365200(VS.85).aspx)中使用的三个函数的压缩版本完全相同。这些在 Win32 API 中编写的非标准运行时函数的目的是什么？

它们只是为了与 DOS 兼容吗？如果是这样，那么*为什么他们要更新 64 位支持之类的东西呢？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T15:00:36.717

> 如果您有从 16 位 Windows 导入的名为 _findfirst 和 _findnext 的代码，则可以继续使用它们。否则使用 API。
> 
> 如果您查看 C 运行时源代码（包含在 VC++ 中），您会看到 _findfirst 调用 FindFirstFile，依此类推。

[来源](http://www.tech-archive.net/Archive/VC/microsoft.public.vc.language/2004-07/1159.html)

请查看[此站点](http://jolinhama.tistory.com/entry/findfirst-vs-FindFirstFile)上的图表以及性能比较。Win32 API FindFirstFile 变体更有效。警告：该网站本身不是英文的，但图表是有道理的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-15T15:39:54.597

可能您使用原始 Win32 API 克服的关键问题（也许是唯一的事情）是，在调试版本中，CRT 将为您执行一些验证（查看源代码 - 那里抛出了很多验证断言）。

封装一个 OS API 有什么问题——即使只是非常轻微？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T15:41:16.917

C 运行时函数还将执行诸如 set *errno* on failure 之类的操作，这是与 Win32 不同的错误机制。

代码也存在于单独的 DLL 中，有一次人们实际上试图编写不使用 CRT 的程序，因为他们不想加载另一个 DLL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T14:46:50.230

它被称为“历史”——当你制作像 Windows 这样的东西时，你不能丢弃旧功能，因为它会破坏现有程序。

其中一组看起来像“C”函数，一组看起来像“Win32”函数。您可以使用您最喜欢的任何一个。

# python - wxPython auinotebook.GetSelection() 返回第一页的索引

> ID：647906
> 
> 赞同：1
> 
> 时间：2009-03-15T14:37:49.020
> 
> 标签：python, wxpython, wxwidgets

为什么“GetSelection()”将索引返回到第一页，而不是在“init”和“new_panel”中创建的最后一页？它确实在“点击”方法中返回正确的索引。

输出应该是 0 0 1 1 2 2，但我的是 0 0 0 0 0 0。

在 ArchLinux 中运行最新版本的 python 和 wxpython。

Ørjan Pettersen

```
#!/usr/bin/python

#12_aui_notebook1.py

import wx
import wx.lib.inspection

class MyFrame(wx.Frame):
    def __init__(self, *args, **kwds):
        wx.Frame.__init__(self, *args, **kwds)

        self.nb = wx.aui.AuiNotebook(self)

        self.new_panel('Page 1')
        print self.nb.GetSelection()
        self.new_panel('Page 2')
        print self.nb.GetSelection()
        self.new_panel('Page 3')
        print self.nb.GetSelection()

    def new_panel(self, nm):
        pnl = wx.Panel(self)
        pnl.identifierTag = nm
        self.nb.AddPage(pnl, nm)
        self.sizer = wx.BoxSizer()
        self.sizer.Add(self.nb, 1, wx.EXPAND)
        self.SetSizer(self.sizer)
        pnl.SetFocus() # Have focused the last panel.
        print self.nb.GetSelection()

        pnl.Bind(wx.EVT_LEFT_DOWN, self.click)

    def click(self, event):
        print 'Mouse click'
        print self.nb.GetSelection()
        print self.nb.GetPageText(self.nb.GetSelection())

class MyApp(wx.App):
    def OnInit(self):
        frame = MyFrame(None, -1, '12_aui_notebook1.py')
        frame.Show()
        self.SetTopWindow(frame)
        return 1

if __name__ == "__main__":
    app = MyApp(0)
#    wx.lib.inspection.InspectionTool().Show()
    app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T07:27:45.817

解决方案非常简单。问题似乎是创建新页面并没有生成页面更改事件。解决方案是：

```
self.nb.AddPage(pnl, nm, select=True) 
```

添加 'select=True' 将触发页面更改事件。所以问题解决了。

另一种解决方案是添加这一行：

```
self.nb.SetSelection(self.nb.GetPageCount()-1) 
```

他们都做同样的事情。触发页面更改事件到最后添加的页面。

```
def new_panel(self, nm):
        pnl = wx.Panel(self)
        pnl.identifierTag = nm
        self.nb.AddPage(pnl, nm, select=True) 
        self.sizer = wx.BoxSizer()
        self.sizer.Add(self.nb, 1, wx.EXPAND)
        self.SetSizer(self.sizer)
        #self.nb.SetSelection(self.nb.GetPageCount()-1)
        pnl.SetFocus() # Have focused the last panel.
        print self.nb.GetSelection() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T20:50:15.880

我运行了您的示例并得到了正确的输出：

```
0
0
1
1
2
2 
```

我正在使用 wxPython 的最新 Windows 版本

# mysql - SQL，Order By - 如何赋予其他列更多权限？

> ID：647908
> 
> 赞同：3
> 
> 时间：2009-03-15T14:43:28.397
> 
> 标签：mysql, sql, sql-order-by

我有这个 SQL 语句：

```
SELECT * FROM converts 
WHERE email='myemail@googlemail.com' AND status!='1' 
ORDER BY date ASC, priority DESC 
```

这只是按日期排序，但我想给我的专栏“优先级”更多权限。我怎样才能做到这一点？

它应该首先按日期排序，但如果两条记录之间的时间是 10 分钟，那么我希望优先接管。如何在我的 SQL 语句中执行此操作，或者这是否必须在我的应用程序逻辑中？我希望我可以在我的 SQL 语句中做到这一点。

谢谢大家的帮助

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-15T14:47:22.180

您可以将“日期”排序量化为 10 分钟的块，那么按 floor(unix_timestamp(date)/600) 排序如何，然后按优先级排序

```
SELECT * FROM converts 
WHERE email='myemail@googlemail.com' AND status!='1' 
ORDER BY floor(unix_timestamp(date)/600) ASC, priority DESC 
```

虽然两个日期的间隔仍然可以小于 10 分钟，但跨越两个不同的 10 分钟“块”。也许这就足够了，但我认为完全按照您的要求做最好由应用程序完成。

*（OP要求扩展解释......）*

取两次跨越十分钟边界的时间，例如今天的 9:09 和 9:11：

*   floor(unix_timestamp('2009-03-16 09: **09:00** ')/600) = 2061990
*   floor(unix_timestamp('2009-03-16 09: **11:00** ')/600) = 2061991

假设 09:11 的优先级高于 09:09 - 它仍然会出现*在*09:09 行之后，因为它属于下一个 10 分钟的块，即使它仅相差 2 分钟。

所以这种方法是一种近似，但并没有解决最初所说的问题。

按照您陈述问题的方式，高优先级行可能会出现在几个小时（或几天或几个月！）之前记录的行之前，只要有一系列间隔小于 10 分钟的低优先级行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T15:27:10.353

另一种变化是：

```
SELECT * FROM converts 
WHERE email='myemail@googlemail.com' AND status!='1' 
ORDER BY (unix_timestamp(date)/60) - priority 
```

仍然不完全符合您的要求，但非常接近。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T15:03:51.703

假设您的真正意思是“两条记录之间的时间是 10 分钟 [或更少]，那么我希望优先权接管？

然后只需按十分钟块排序，然后按优先级...

选择 ...
按 DateDiff(min, 0, Date) / 10, 优先级排序

您可以调整 0 值来控制每个“tem-minute-block”开始和停止的位置...如果 MySql 没有 DateDiff 函数，请使用 MySQL 中提供自某个参考时间以来的分钟数的任何表达式...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-15T15:27:58.073

如果您使用的是 SQL Server 2005 / 2008，则可以使用递归 CTE 完成此任务。请注意我在记事本中写了这段文字，还没有经过测试。一旦我有机会测试查询结果，如果有错误，我将更新 CTE 或完全删除此评论。

与日期_cte

作为

```
(SELECT *
    , 'sequential_order' = ROW_NUMBER() OVER
        (PARTITION BY email
        ORDER BY date ASC, priority DESC)
FROM converts
WHERE email = 'myemail@googlemail.com'
AND status <> '1') 
```

, recursive_date_cte

作为

```
(SELECT dc1.*
    , 'sort_level' = 1
FROM date_cte dc1
WHERE sequential_order = 1
UNION
SELECT dc1.*
    , 'sort_level' = CASE
        WHEN DATEDIFF(MINUTE, dc1.date, dc2.date) <= 10 THEN sort_level
        ELSE sort_level + 1 END
LEFT JOIN date_cte dc2
    ON dc1.sequential_order = dc2.sequential_order - 1
WHERE dc1.sequential_order > 1) 
```

选择 *

FROM recursive_date_cte

ORDER BY sort_level ASC

```
, priority DESC 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-15T14:46:04.647

只需更改订单声明中的订单或列

```
SELECT * FROM converts WHERE email='myemail@googlemail.com' AND status!='1' ORDER BY priority DESC, date ASC 
```

# apache-flex - 在运行时使用 Sprite 设置 Flex 按钮的图标

> ID：647910
> 
> 赞同：1
> 
> 时间：2009-03-15T14:44:33.403
> 
> 标签：apache-flex, actionscript-3, button, icons

我想在 flex 中设置按钮的图标。

默认语法如下。

```
myButton.setStyle("icon", iconClass); 
```

iconClass 通常是一个嵌入式对象。

但我想做的是，使用标准**Sprite 或 MovieClip**（我在运行时找到）作为图标。

这可能吗？有人做过吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T16:02:32.987

这实际上是 Flex 框架在样式方面的一个致命缺陷。当 Flex 获取图标的样式值时，它假定它是类型的`Class`，并且实例化的对象将是类型的`DisplayObject`（或派生的）。`mx:Image`测试样式的值是否属于类型`DisplayObject`，如果是，则跳过它当前执行的构造步骤，这是对代码（哪些类喜欢为其源属性所做的）的一个微不足道的更改。

如果您不想更改 Flex 框架源，Ben 的解决方案是最好的解决方案。就个人而言，我最终会对特定组件进行猴子修补以接受实例化`DisplayObjects`而不是`Classes.`某些组件比其他组件更痛苦。

[Doug McCune 解释如何对 Flex 框架进行猴子补丁。](http://dougmccune.com/blog/2008/02/21/monkey-patching-flexsprite-to-list-all-event-listeners-on-any-flex-component/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-15T16:01:35.167

找到了可能的解决方案。[http://blog.benstucki.net/?p=42](http://blog.benstucki.net/?p=42)之前会给出这个并报告。

# java - Java 应用程序架构指南

> ID：647922
> 
> 赞同：21
> 
> 时间：2009-03-15T14:51:06.087
> 
> 标签：java, architecture, jakarta-ee

是否有与之对应的 Java 应用程序架构指南：http: [//www.codeplex.com/AppArchGuide](http://www.codeplex.com/AppArchGuide)？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-15T18:53:26.643

以下内容应该对您有所帮助

1.  [核心 J2EE 模式](http://www.corej2eepatterns.com/Patterns2ndEd/index.htm)
2.  [有效的企业 Java](https://rads.stackoverflow.com/amzn/click/com/0321130006)
3.  [企业应用架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)
4.  [头部优先设计模式](http://oreilly.com/catalog/9780596007126/)
5.  [J2EE 蓝图](http://java.sun.com/reference/blueprints/)
6.  [Sun 认证企业架构师，学习指南](https://rads.stackoverflow.com/amzn/click/com/0130449164)

虽然快速浏览了来自 codeplex 的文档，但我可以告诉你，其中大概 70-80% 的内容也适用于 Java。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-15T15:01:36.357

我很抱歉没有阅读您提供的非常好的链接。

我会说架构应该是一种独立于语言的东西。一旦您了解了原理，就应该将一个平台的功能和实现细节映射到另一个平台上。

我不愿发布任何 Java EE 标准的链接，因为在进入 EJB 3.0 时所做的更改使得许多早期版本的“最佳实践”已经过时。

对象关系映射现在体现在 JPA 中；Spring 引入了依赖注入和面向方面编程等思想。

现在我想说，学习[Spring](http://www.springframework.org)将使您对 Java 企业架构的最佳实践有最好的了解。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-15T15:03:00.440

我仍在下载引用的文档，但从页面的描述中我认为

a) 其中很多应该与语言无关，因此它也应该适用于 java。
b) 企业应用架构模式可能适合。（这也与平台/语言无关。）您可以在此处阅读有关这本书的信息[http://martinfowler.com/books.html](http://martinfowler.com/books.html)

编辑：
我只是浏览了文档。看起来真的很有趣。我想我需要花更多的时间来处理它。

那里对 .NET 的引用非常稀少，主要列出了给定 ara 的 .NET 技术堆栈的适当部分。例如 Windows Mobile 用于实现移动应用程序客户端的东西。在许多情况下，这实际上只是营销。

因此，Java 的等价物就是推荐匹配的 Sun 解决方案。就像 MySQL 的数据库一样。虽然这种方法对 MS 来说是有意义的，它希望他们的开发人员被锁定在 MS 的东西上，但对于将开放性作为主要销售论点的 Sun/Java 来说却没有意义。因此，像“为此使用 MS SQL Server”这样的语句将变成使用，Oracle、db2、mysql、ms sql server、hsqldb、derby、informix、postrgres 或任何其他数据库......不是很有帮助。所以我想这不会发生。

# multithreading - Delphi - 如何在任务执行时侦听和处理 WMDeviceChange 消息？

> ID：647941
> 
> 赞同：0
> 
> 时间：2009-03-15T15:00:00.370
> 
> 标签：multithreading, delphi

我遇到了无法处理几乎同时连接的两个驱动器的问题。我实际上已经修复了获取驱动器模型的旧 scsi 方法，但我感觉我即将遇到同样的问题。

似乎如果正在执行一项任务，例如我检查驱动器是否是特定设备的任务，不幸的是，如果该设备刚刚连接，则需要一些时间。在执行时发出的进一步 WM_DEVICECHANGE 消息根本不会被接收。

即使我必须存储消息并将其排队以进行处理，我也不确定如何在另一个任务执行时使应用程序能够执行此操作。我的第一个猜测是我必须使用线程？

我有一个 WM_DEVICECHANGE 处理程序，用于侦听设备到达和设备移除。它获取并返回一个驱动器号并将其传递给将驱动器添加到组合框的代码，然后检查它是 psp 还是只是一个可移动驱动器，然后有一个消息对话框询问用户是否要选择此驱动器或不。

我也有一种感觉，消息对话框会阻止 WM_DEVICECHANGE 消息的处理，但在我编写新方法之前我无法对其进行测试。

无论如何，我想也许有人能理解我的意思并指出我正确的方向。我担心尝试使用线程会导致自己的小批量问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T19:08:38.947

我不会为此使用线程。只需获取您对其他问题的答案，并从中创建一个更通用的解决方案。

如果您使用一个 GUI 线程，您将不会错过消息 - 您只需稍微延迟即可处理它们。但是，您可能不会做的是在处理消息时忽略更多消息并调用*Application.ProcessMessages()*或涉及计时器 - 这就是您目前遇到的问题。

当模式对话框处于活动状态时，您将运行辅助消息循环，并且在您处理前一个消息时可能会收到新的*WM_DEVICECHANGE消息。*我会做些什么来处理这个：

1.  在您的应用程序中创建一个未完成的驱动器请求记录列表，该记录可以包含例如驱动器号、所有必要的附加数据以及请求到期的时间值。

2.  收到*WM_DEVICECHANGE*消息后，您将新的请求记录添加到列表中，并设置驱动器号并将超时值设置为当前时间加上三十秒。每个驱动器号在列表中应该只有一次。立即再次删除驱动器时删除请求的奖励积分。您还需要启用计时器。

3.  在计时器事件处理程序中，您首先禁用计时器，然后执行代码来处理请求。如果成功，则从列表中删除该请求。如果它不成功，但当前时间超过了超时请求，则从列表中删除该请求，提醒用户存在问题。如果距离超时还有时间，则将请求保留在列表中，以便下次重试。最后，您重新启用计时器，但前提是请求列表不为空。

使用这种方法，您将能够处理与请求列表可以容纳条目一样多的并发请求。没有*必要*为此使用线程。使用线程当然会提高应用程序的响应能力，但是您是否想用增加的复杂性来增加自己的负担是由您决定的。StackOverflow 上已经有很多与线程相关的问题，浏览它们以了解您将要处理的新问题。

# vb.net - Crystal Report 刷新已保存的报表

> ID：647947
> 
> 赞同：1
> 
> 时间：2009-03-15T15:01:44.313
> 
> 标签：vb.net, crystal-reports

我在我的项目中使用水晶报表（前端：Visual Basic 和后端：SQL）。我通过 Microsoft Outlook 将报告（即报价请求报告）以 .rpt 文件的形式发送给供应商。

但是，一旦我将保存的 .rpt 文件发送给供应商 A，报告文件在发送给供应商 B 等时不会刷新或更新。供应商 B 获得一份包含供应商 A 数据的报告副本。

如何通过 VB 代码本身刷新 .rpt 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T20:46:28.213

由于每个供应商的报告似乎都不同，因此您必须为每个供应商重新创建它。因此，您可以在发送电子邮件后和为下一个供应商重新创建报告之前删除旧的 RPT 文件。这应该确保您在每个报告中都有正确的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-11T09:01:25.027

假设您的报告对象是 rptObj 并且您想在 CrystalReportViewer1 中显示，然后在生成报告的事件上使用以下代码

```
 rptObj1.Load()
    rptObj1.Refresh()
    CrystalReportViewer1.ReportSource = rptObj1
    CrystalReportViewer1.RefreshReport() 
```

# regex - 如何检查输入字符串是否为有效的 VB 字符串？

> ID：647956
> 
> 赞同：1
> 
> 时间：2009-03-15T15:04:49.720
> 
> 标签：regex, vb.net, string

我们知道VB字符串以双引号“”开头和结尾

所以如果我们想在VB字符串中使用“”，我们必须使用“”。

我想知道是否有匹配 VB 字符串的正则表达式模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T15:12:15.333

如果输入到 VB 代码文件中，您是否尝试检测他们输入的字符串是否有效？如果是这样，下面的正则表达式应该可以解决问题

```
^"(("")|[^"])*"$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T15:13:30.337

这里的上下文是什么？您只需要转义引号，让编译器区分开始/结束引号和作为字符串数据一部分的引号。如果在运行时读取字符串，则不需要双引号。

# .net - Windows 窗体：TextBox 类的 SelectionChanged 事件

> ID：647963
> 
> 赞同：12
> 
> 时间：2009-03-15T15:12:22.010
> 
> 标签：.net, winforms, textbox

如何在 .NET 2.0 中的文本框中收到选择更改的通知？我找不到 SelectionChanged 事件或 OnSelectionChanged 方法。最好的解决方法是什么（当然不必 PInvoke）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T15:32:40.103

您可以使用 RichTextBox 并将 Multiline 设置为 false。它有一个 OnSelectionChanged。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-28T14:27:51.433

您也可以使用文本框。

编写一个函数 GetMyPosition() 并放入事件

*   文本更改（）
*   鼠标点击()
*   KeyUp() （在 KeyDown() 中位置没有改变）

当您想通知文本突出显示时，您还必须使用

*   鼠标悬停（）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-15T15:47:04.063

好吧，我想[这](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/726ed524-b657-46bc-b5c1-5b8ae1d9fffe/#)可能会有所帮助！您仍然需要使用 RichTextBox。

# .net - 在 .Net CF 应用程序中使用 Aforge.Net 库？

> ID：647966
> 
> 赞同：0
> 
> 时间：2009-03-15T15:14:23.580
> 
> 标签：.net, windows-mobile, compact-framework, mobile

可以在 .Net CF 3.5 应用程序中使用桌面 .net 库 [Aforge.net] 吗？我同意 CF 是一个子集，所有......某些功能等将不起作用......但我得到的错误令人困惑......

```
AForge.Imaging.Filters.ResizeBilinear resizeBilinear = new ResizeBilinear(240, 320);
Bitmap new1 = resizeBilinear.Apply(new System.Drawing.Bitmap(10,10)); 
```

Apply() 需要一个 System.Drawing.Bitmap 对象，这正是我要传递的……但由于某种原因，该应用程序将无法构建。我得到的错误如下：

```
The type 'System.Drawing.Bitmap' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Drawing, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.

The best overloaded method match for 'AForge.Imaging.Filters.FilterAnyToAnyNew.Apply(System.Drawing.Bitmap)' has some invalid arguments 
```

有什么我错过的吗？我显然已经引用了 System.Drawing dll 并在我的代码中使用了它。Aforge.Net 命名空间不会重新定义位图或类似的东西......

我无法理解为什么它无法识别传递的对象确实是位图对象......

请帮忙...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T03:32:47.800

不，您根本不能在 CF 下使用桌面组件。您可以采用另一种方式 - 完整的桌面程序集可以使用 CF 程序集，但是没有办法让 CF 应用程序在不重新编译的情况下使用桌面程序集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-16T03:39:03.853

听起来，您需要 CF 2.0 版或在 3.5 上为 CF 重新编译 AForge。

# c++ - 如何为自定义类型扩展 std::tr1::hash？

> ID：647967
> 
> 赞同：22
> 
> 时间：2009-03-15T15:14:24.767
> 
> 标签：c++, tr1

如何允许 STL 实现选择我的自定义类型？在 MSVC 上，有一个类`std::tr1::hash`，我可以通过使用来部分专门化它

```
namespace std 
{
    namespace tr1 
    { 
        template <> 
        struct hash<MyType> 
        { ... };
    } 
} 
```

但这是推荐的方式吗？此外，这也适用于 GCC 的实现吗？对于`boost::hash`，提供一个免费的功能就足够了`size_t hash_value (const MyType&)`，TR1的实现有没有类似的东西？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-05T14:27:55.167

我试图找出使用无序关联容器执行此操作的确切语法（也使用 GCC，正如 OP 所要求的那样）并提出了这个问题。

不幸的是，它没有达到我想要的详细程度。通过查看 gcc 标头，了解它们是如何实现标准哈希函数的，我得到了它的工作。鉴于网络上缺乏示例（至少在撰写本文时），我认为这将是一个发布我自己的示例的好地方（我可以确认它与 GCC 合作）：

```
 namespace std { namespace tr1
{
   template <>
   struct hash<MyType> : public unary_function<MyType, size_t>
   {
       size_t operator()(const MyType& v) const
       {
           return /* my hash algorithm */;
       }
   };
}} 
```

（注意这里*有*两个命名空间——这只是我折叠嵌套命名空间的约定）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-15T15:24:17.347

是的，这也适用于 GCC。我在一个更大的项目中使用它，它可以正常工作。您还可以为 TR1 容器提供您自己的自定义散列类，但指定 std::tr1::hash<> 是默认散列类。将其专门用于自定义类型似乎是扩展标准散列功能的自然方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-15T15:44:36.923

由于您没有添加到`std`库名称空间，而只是提供专业知识，所以完全可以。

如果您想提供更通用的散列方法（例如一般的元组散列），请查看 Boost Fusion。[这是一个简单的例子](http://www.nabble.com/-tuple--hash--Hashing-a-tuple-question-td18205086.html)，它适用于大多数情况（可能元组的元组除外）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-05T14:59:24.907

以下代码片段显示了如何专门`std::tr1::unordered_map`映射 `boost::const_string<char>`到`void*`类似于如何`std::string`散列。

```
#include <boost/const_string/const_string.hpp>    
typedef class boost::const_string<char> csc;

namespace std
{
namespace tr1
{
template <>
struct hash<csc> {
public:
    size_t operator()(const csc & x) const {
        return std::_Hash_impl::hash(x.data(), x.size());
    }
};
}
}

typedef std::tr1::unordered_map<csc, void*> Map;
typedef Map::value_type Dual; ///< Element Type. 
```

# php - 从浏览器检测确切的操作系统版本

> ID：647969
> 
> 赞同：18
> 
> 时间：2009-03-15T15:19:51.960
> 
> 标签：php, javascript, browser

我想知道是否有一种方法可以使用 PHP/JS/ASP 从浏览器中检测到确切的操作系统版本？

我知道我可以检测操作系统的类型（Windows XP、Windows Vista、OS X 等），但我需要检测确切的版本：Vista Business、Vista Ultimate、Windows XP Home、Windows XP Pro 等...

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-15T15:24:23.557

**简短的回答：**你不能。

**长答案：**

您所拥有的只是 HTTP User-Agent 标头中的信息，该标头通常包含操作系统名称和版本。

通常，在 Mac OS 和 Linux 上运行的浏览器会发送足够的信息来识别确切的操作系统。例如，这是我的 User-Agent 标头：

> Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.7) Gecko/2009030423 Ubuntu/8.10 (intrepid) Firefox/3.0.7

您可以看到我正在运行 Ubuntu 8.10 Intrepid Ibex。

以下是 Firefox 和 Safari 4 Beta 在我的 MacBook Pro 上的报告：

> Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.0.7) Gecko/2009021906 Firefox/3.0.7
> 
> Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_6; en-us) AppleWebKit/528.16 (KHTML, like Gecko) 版本/4.0 Safari/528.16

另一方面，Windows 浏览器通常只报告操作系统版本而不是特定软件包（Pro、Business 等）：

> Mozilla/5.0（Windows；U；Windows NT 5.1；en-US；rv:xxx） Gecko/20041107 Firefox/xx

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-26T20:03:24.613

经过一番谷歌搜索后，我发现了这段代码，它似乎工作正常，（虽然没有检测到 Unix）

```
<?php 
$OSList = array
(
// Match user agent string with operating systems
'Windows 3.11' => 'Win16',
'Windows 95' => '(Windows 95)|(Win95)|(Windows_95)',
'Windows 98' => '(Windows 98)|(Win98)',
'Windows 2000' => '(Windows NT 5.0)|(Windows 2000)',
'Windows XP' => '(Windows NT 5.1)|(Windows XP)',
'Windows Server 2003' => '(Windows NT 5.2)',
'Windows Vista' => '(Windows NT 6.0)',
'Windows 7' => '(Windows NT 7.0)',
'Windows NT 4.0' => '(Windows NT 4.0)|(WinNT4.0)|(WinNT)|(Windows NT)',
'Windows ME' => 'Windows ME',
'Open BSD' => 'OpenBSD',
'Sun OS' => 'SunOS',
'Linux' => '(Linux)|(X11)',
'Mac OS' => '(Mac_PowerPC)|(Macintosh)',
'QNX' => 'QNX',
'BeOS' => 'BeOS',
'OS/2' => 'OS/2',
'Search Bot'=>'(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves/Teoma)|(ia_archiver)'
);
// Loop through the array of user agents and matching operating systems
foreach($OSList as $CurrOS=>$Match)
{
// Find a match
if (eregi($Match, $_SERVER['HTTP_USER_AGENT']))
{
// We found the correct match
break;
}
}
// You are using ...
echo "You are using ".$CurrOS;
?> 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-07-01T03:52:36.133

// 这会帮助你

```
$uagent = $_SERVER['HTTP_USER_AGENT'] . "<br/>";

function os_info($uagent)
{
    // the order of this array is important
    global $uagent;
    $oses   = array(
        'Win311' => 'Win16',
        'Win95' => '(Windows 95)|(Win95)|(Windows_95)',
        'WinME' => '(Windows 98)|(Win 9x 4.90)|(Windows ME)',
        'Win98' => '(Windows 98)|(Win98)',
        'Win2000' => '(Windows NT 5.0)|(Windows 2000)',
        'WinXP' => '(Windows NT 5.1)|(Windows XP)',
        'WinServer2003' => '(Windows NT 5.2)',
        'WinVista' => '(Windows NT 6.0)',
        'Windows 7' => '(Windows NT 6.1)',
        'Windows 8' => '(Windows NT 6.2)',
        'Windows 8.1' => '(Windows NT 6.3)',
        'Windows 10' => '(Windows NT 10.0)',
        'WinNT' => '(Windows NT 4.0)|(WinNT4.0)|(WinNT)|(Windows NT)',
        'OpenBSD' => 'OpenBSD',
        'SunOS' => 'SunOS',
        'Ubuntu' => 'Ubuntu',
        'Android' => 'Android',
        'Linux' => '(Linux)|(X11)',
        'iPhone' => 'iPhone',
        'iPad' => 'iPad',
        'MacOS' => '(Mac_PowerPC)|(Macintosh)',
        'QNX' => 'QNX',
        'BeOS' => 'BeOS',
        'OS2' => 'OS/2',
        'SearchBot' => '(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves/Teoma)|(ia_archiver)'
    );
    $uagent = strtolower($uagent ? $uagent : $_SERVER['HTTP_USER_AGENT']);
    foreach ($oses as $os => $pattern)
        if (preg_match('/' . $pattern . '/i', $uagent))
            return $os;
    return 'Unknown';
}
echo os_info($uagent); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-15T16:27:09.990

在经典 ASP 和 ASP.NET 中使用

```
Request.ServerVariables("HTTP_USER_AGENT") 
```

这效果最好，因为它不是解释代码，它在服务器上运行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-15T15:28:28.243

我认为您无法区分不同版本的 Vista，但您应该能够从[导航](http://www.w3schools.com/htmldom/dom_obj_navigator.asp)器对象的平台属性中获取操作系统。不过，您可能必须解析它，或者根据它的内容进行区分。

```
<script type="text/javascript">
   alert( navigator.platform );
</script> 
```

请参阅[www.w3schools.com](http://www.w3schools.com)教程，了解如何获取所有导航器属性的[示例。](http://www.w3schools.com/js/tryit.asp?filename=try_dom_navigator)

**编辑**：

要获得准确的版本，您可以开发 ActiveX 控件（仅限 Windows）或 Java Applet 并使用 java.lang.System 对象查看当前系统属性。对于非 Windows 系统，您可能能够从浏览器中获取足够的信息，并仅将控件用于 Windows 系统。我还没有尝试过，所以你需要尝试看看它是否有效。我必须相信 Microsoft 的 Microsoft Update 的 ActiveX 控件能够检测到确切的系统版本并安装软件以使其正常工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-15T15:54:58.740

你真的应该尽量避免这样做，除非它对于 Web 应用程序的功能是绝对必要的。

意识到：

并非所有请求都可以来自在 Windows 上运行的客户端。

并非所有请求都可以来自支持 JavaScript 的客户端。

请求中可能不存在用户代理标头。

用户代理标头中的内容可能具有误导性。

一个设计良好的 Web 应用程序应该提供完整的内容和功能，无论请求的用户代理标头中的内容是什么，或者客户端是否支持 javascript 或任何其他客户端扩展。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-15T16:06:20.943

正如其他人已经说过的那样，不，不可靠。

这就是例如 jquery 已切换到浏览器功能*系统*（因为缺少更好的词）而不是浏览器嗅探系统的原因。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-13T07:35:37.790

我创建了一个执行此操作的 jquery 函数。这样我们就可以使用[navigator](http://www.w3schools.com/jsref/prop_nav_useragent.asp)跟踪所有操作系统。

希望有人能从中得到帮助：

```
function find_os_version() {
  var ua = navigator.userAgent.toLowerCase();
  if (ua.indexOf("windows nt 5.0") != -1) {
    return 'win2k';
  }
  if (ua.indexOf("windows nt 5.1") != -1) {
    return 'winXP';
  }
  if (ua.indexOf("windows nt 6.0") != -1) {
    return 'winVista';
  }
  if (ua.indexOf("windows nt 6.1") != -1) {
    return 'win7';
  }
  if (ua.indexOf("windows nt 6.2") != -1) {
    return 'win8';
  }
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-12-11T12:56:32.150

这可能是最简单的方法：

[从http://mobiledetect.net](http://mobiledetect.net)下载库

如果使用 CI，请将 Mobile_Detect.php 放入“库”或仅包含它。

在 PHP 中使用此代码

```
$detect = new Mobile_Detect();
// Get the version() of components.
$detect->version('iPad'); // 4.3 (float)
$detect->version('iPhone') // 3.1 (float)
$detect->version('Android'); // 2.1 (float)
$detect->version('Opera Mini'); // 5.0 (float) 
```

[在http://dwij.co.in/mobile-os-detection-in-php-codeigniter](http://dwij.co.in/mobile-os-detection-in-php-codeigniter)上查找文档

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-01-25T17:27:38.060

在 CodeIgniter 中，您可以找到名为“user_agent”的库。它会给你真正需要的一切。如果你不使用 CI，你仍然可以为你的框架“提取”代码。希望有帮助。 [http://codeigniter.com/user_guide/libraries/user_agent.html](http://codeigniter.com/user_guide/libraries/user_agent.html)

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2014-01-22T22:32:55.113

虽然这个问题很老了，但我只是在回答：

你试一试：

`$this->agent->platform()`

这会给你输出：`Linux, Windows, OS X, etc.`

欲了解更多信息，请访问：

[http://ellislab.com/codeigniter/user-guide/libraries/user_agent.html](http://ellislab.com/codeigniter/user-guide/libraries/user_agent.html)

# c# - 如何实现固定步长循环？

> ID：647974
> 
> 赞同：2
> 
> 时间：2009-03-15T15:22:20.240
> 
> 标签：c#, loops, fixed

我试图在我的程序中创建一个固定的步进循环，但由于某种原因，我似乎无法让它正常工作。基本上我需要的是一个循环：

```
while(!over) {
    Update(elapsedtime);
    Draw(elapsedtime);
} 
```

或类似的东西，带有 . 我试过使用 Thread.Sleep 但我不太确定它给了我一个真正的固定步骤循环，当我尝试在[这个](http://gafferongames.com/game-physics/fix-your-timestep/)网站上实施解决方案时我遇到了问题，因为我看不到方法保存受循环影响的对象的状态。这迫使我排除了那部分，当循环中有很多对象时，这会导致速度变慢。

我怎样才能得到一个固定的步进循环，而不必不断地保存循环中每个对象的状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-15T15:43:17.787

您是否要求一个基本上每 n 个刻度运行的循环？这听起来像一个[Timer](http://msdn.microsoft.com/en-us/library/system.threading.timer.aspx)。BCL 中有几个计时器。一个[用于服务器的计时器](http://msdn.microsoft.com/en-us/library/system.timers.aspx)或一个[用于 Window Forms](http://msdn.microsoft.com/en-us/library/system.windows.forms.timer.aspx)的计时器。

您可以按照这些思路使用它们。以下是伪代码，旨在大致说明这是如何完成的。换句话说，如果您只是复制和粘贴，它可能不会编译。

```
public class RepeatingTask
{
    public MyObjectState _objectState;

    public RepeatingTask(Timespan interval)
    {
       Timer timer=new Timer(Timer_Tick); //This assumes we pass a delegate. Each timer is different. Refer to MSDN for proper usage
       timer.Interval=interval;
       timer.Start();

    }
    private DateTime _lastFire;
    private void Timer_Tick()
    {
       DateTime curTime=DateTime.Now();
       DateTime timeSinceLastFire = curTime-lastFireTime;
       _lastFire=DateTime.Now(); //Store when we last fired...

       accumulatedtime+=timeSinceLastFire
       while(accumulatedtime>=physicsInterval)
       {
          Update(physicsInterval);
          accumulated-=physicInterval;
       }

               }

} 
```

您还可以使用闭包来包装定义计时器的方法的状态。

# 编辑

我读了这篇文章，我理解了这个问题；但是，您仍然可以使用计时器，但您需要按照他的指示设置您的函数，以便为您设置物理引擎的每个间隔调用引擎。

您是否使用 WPF，他们有一些我相信会以稳定的速度触发 doign 动画的事件。

# 编辑

我更新了我的代码示例以向您展示我的解释，但基本上您所做的是为您的物理引擎定义一个间隔，然后您在每次通过“循环/计时器”时需要做的事情是确定从那以后经过了多少实时时间最后一次迭代。然后，您将该增量存储在累加器中，您将使用该累加器进行倒计时，直到您为上次调用以来错过的所有间隔调用物理引擎。

我遇到的问题是，如果在这里使用计时器更好，那么让专用线程休眠，或者其他一些实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T16:25:03.113

如果您正在开发游戏引擎，Timer 可能无法正常工作。计时器没有足够的精度来处理固定的步进循环并保持它正常。

您需要使用高精度计时器来实现这一点。在这种情况下，您需要使用[Stopwatch 类。](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx) 这将使您有足够的精度来准确地跟踪您的 elapsedTime。

您只需要跟踪您想要更新的频率（以 Ticks 为单位），然后使用秒表来测量每次更新所需的时间。之后，您可以潜在地使用 Sleep() 调用来阻止，但要意识到在大多数系统上 sleep 的精度只有 14-15 毫秒，即使您只休眠 0 或 1 毫秒。这可能会使您的循环减慢太多，因此您可能需要实现自旋锁或类似的东西（while (waiting) { do something }）。Sleep() 很好，因为如果可以的话，它会节省 CPU，自旋锁会在你等待时消耗 CPU 周期，但会给你更高的精度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-15T15:44:19.313

Thread.Sleep 不会给你一个固定的步骤循环，它只会在让你的程序继续之前等待给定的时间。实际频率将取决于睡眠的准确程度以及程序在每一步运行相同数量的挂钟时间的一致性。但是，如果您可以适应一些漂移，这可能就足够了，而且肯定是最简单的。

要获得真正的固定步长循环，您需要一个[间隔计时器](http://msdn.microsoft.com/en-us/library/system.timers.timer.aspx#)，该计时器在计时器到期时通过回调执行您的代码。请注意，这不再是真正的循环，但是您的代码会定期执行，我认为这就是您想要的。同样，可能会有一些漂移，因此您可能需要调整每一步的间隔，以便如果您需要更高的准确性，下一个事件会在正确的时间触发。让它完全准确是不可能的——毕竟即使是基于硬件的间隔计时器也有一个精度——但希望你可以让它足够准确以达到你的目的。

# wpf - 在 WPF 中复制 9 片功能

> ID：647978
> 
> 赞同：2
> 
> 时间：2009-03-15T15:24:22.730
> 
> 标签：wpf, xaml

我真的很喜欢 Flash/Flex 中的 9 片功能。这是制作液体矢量布局的好方法。看一眼：

![图片](https://i.stack.imgur.com/oOIwc.png)

我正在使用 AI 文件中的选定对象来设置一个 9 切片网格（我没有使用 9 来缩放角！）。我只希望正确的部分保持静止，而其余部分可以扩展。现在，还要注意它必须缩放，所以它必须是矢量。我无法将要重复的部分平铺为光栅化图形。

所以 Flex 这很容易，WPF 没那么多。我对 WPF 社区的问题是如何在 WPF 中复制 9 片？我玩弄过使用 AI->XAML 导出器导出这些文件。将路径对象嵌入到网格行中的行为过于奇怪和不一致。

这是采用导出的路径并尝试将其放入网格中。我应该注意到这个 Grid 没有被用来模拟 9 片。我只是用它来布局对象。我只是希望下面的路径适合最右上角。它甚至不这样做....

```
<Page
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid ShowGridLines="True">
        <Path Fill="Red" Data="F1 M 200.0,42.5 L -200.0,42.5 L -200.0,-42.5 L 200.0,-42.5 L 200.0,42.5 Z" Grid.Row="0" Grid.Column="1"/>
    </Grid>
</Page> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-16T08:57:54.443

您的路径包含负坐标，当您在点 (-200,0) 处绘制某些东西时，它将被绘制到它应该在的左侧 200 像素处。

通过简单地将 200 添加到所有 X 坐标以使您的路径基于 (0,0) 而不是 (-200,0)，您将获得这条有效的路径：

```
 <Path Fill="Red" Data="F1 M 400.0,42.5 L 0.0,42.5 L 0.0,-42.5 L 400.0,-42.5 L 400.0,42.5 Z" Grid.Row="0" Grid.Column="1"/> 
```

或者，您可以使用转换将其推入到位，这也可以：

```
<Path Fill="Red" Data="F1 M 200.0,42.5 L -200.0,42.5 L -200.0,-42.5 L 200.0,-42.5 L 200.0,42.5 Z" Grid.Row="0" Grid.Column="1">
    <Path.RenderTransform>
        <TranslateTransform X="200"/>
    </Path.RenderTransform>
 </Path> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-15T17:22:53.117

你有一个 6 片，而不是 9 片。

从我有限的理解来看，9-slice 基本上设置了一个 3x3 的网格，其中四个角不缩放，中心顶部和底部单元格仅水平缩放，左右中心单元格仅垂直缩放，中心水平和垂直缩放。

以下是这样做的。它的行为是否与 9-slice 完全一样，我无法告诉你，因为我从未真正使用过它。

```
 <Grid.ColumnDefinitions>
    <ColumnDefinition Width="50" />
    <ColumnDefinition Width="*" />
    <ColumnDefinition Width="50" />
  </Grid.ColumnDefinitions>
  <Grid.RowDefinitions>
    <RowDefinition Height="50" />
    <RowDefinition Height="*" />
    <RowDefinition Height="50" />
  </Grid.RowDefinitions> 
```

# c++ - 为什么我不能为指针赋值？

> ID：647988
> 
> 赞同：2
> 
> 时间：2009-03-15T15:33:24.610
> 
> 标签：c++, pointers, segmentation-fault, readonly

在阅读了常见问题解答和我能找到的所有其他内容之后，我仍然感到困惑。如果我有一个以这种方式初始化的 char 指针：

`char *s = "Hello world!"`

该字符串位于只读内存中，我无法像这样更改它：

```
*s = 'W'; 
```

制作“Wello world！”。我明白这一点，但我不能，就我的一生，了解如何使它不是只读的。我必须使用数组而不是指针吗？喜欢[这里](https://stackoverflow.com/questions/164194/why-does-simple-c-code-receive-segmentation-fault)吗？

这是我的代码：

```
char *s = str;
char *e = s;
while (*e != '\0')
e++;
e--;
char *temp;
//Swop the string around
while (s <= e) {
    *temp = *s;
    *s = *e;
    *e = *temp;
    e--;
    s++;
} 
```

错误消息只是一个分段错误。如果这是一个非常愚蠢的问题，请提前道歉。

非常感谢所有的帮助。在听取了你所有的建议后，我明白了：

```
void something(char * str) {
    char *store = str;
    char *s = new char[strlen(str) + 1]; //Allocate memory. Nice one.
    strcpy(s, str);
    char *e = new char[strlen(str) + 1];
    strcpy(e, str);
    while (*e != '\0')
        e++;
    e--;
    char temp; //no longer a pointer
    while (s <= e) {
        cout << *e;
        temp = *s;
        *s = *e;
        *e = temp;
        e--;
        s++;

    }
    delete [] e;
    delete [] s;        
} 
```

但是，函数末尾的删除似乎导致了它们自己的分段错误。为什么？

为了兴趣起见：错误是由于在递增后访问 e 和 s 指针。一个更简单的解决方案随之而来：

```
void something(char * str) {
    char *s = new char[strlen(str) + 1];
    strcpy(s, str);
    char temp;
    int j = strlen(str) - 1;
    for (int i = 0; i <= strlen(str)/2; i++) {
        cout << s << endl;
        temp = s[i];
        s[i] = s[j];
        s[j] = temp;
        j--;
    }
    delete [] s;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-15T15:47:32.317

尝试：

```
char src[] = "Hello world";
src[6]     = 'W';

-- // or

char   buffer[] = "Hello world";
char*  src      = buffer;
src[6]          = 'W'; 
```

如果要将字符串复制到缓冲区中，请使用 strcpy() 或 strncpy()

```
char   buffer[20];
char const* s = "Hello World"

strcpy(s,buffer); 
```

如果您必须编写自己的字符串副本，那么它应该如下所示：

```
char   buffer[20];
char const* s = "Hello World";

// OK this is not the perfect solution but it is easy to read.
for(int loop = 0;s[loop] != '\0';++loop)
{
    buffer[loop] = s[loop];
}
buffer[loop] = '\0'; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-15T15:38:47.470

修改它的最简单方法是为您的存储创建一个数组，然后将字符串复制到其中。

例如：

```
char buf[128];
const char *src = "Hello World";
strncpy(buf, src, 127); // one less - we always 0-terminate
buf[127] = '\0';

// you can now modify buf
buf[0] = 'W'; 
```

您的代码不起作用的原因是您没有为字符串的副本分配任何内存 - 您刚刚创建了第二个指向同一只读内存的指针。（然后尝试复制它？我不太确定其余代码在做什么。）您需要在某处获取一些非只读内存，使用标准库将其复制到其中要容易得多那个新的记忆，而不是自己写循环。

如果您事先不知道字符串的长度，您也可以使用 malloc （或者，更好的是，按照 drschnz 的回答说并使用*new char[]*）：

```
const char *src = "Hello world";
char *buf = malloc(strlen(src) + 1);   // or = new char[strlen(src) + 1];
strcpy(buf, src);
// you can now modify buf
// later, you need to free it
free(buf);                             // or delete [] buf; 
```

此外，如果您使用的是 C++，则可以只使用 std::string：

```
std::string myString("Hello world");
myString[0] = "W"; 
```

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T15:48:56.447

指针不是只读的。（字符串数据本身是，但指向它的指针可以自由修改）但是，将字符分配给指针并不符合您的预期。

通常，您可以分配给点的唯一内容是地址。您不能分配值，只能分配值的地址。

字符串文字（如“hello world”）是一个例外，因为字符串是特殊的。如果将其中一个分配给指针，则会得到指向该字符串的指针。但通常，您将地址分配给指针。

另一点是 C++ 中的字符是整数数据类型。它们可以被视为整数而无需强制转换。我可以做到`int i = 'W'`，编译器不会抱怨。

那么，如果将“W”分配给指针会发生什么？它将“W”作为一个整数值，并假定这是一个地址。'W' 的 ASCII 值是 127，因此您有效地将指针设置为指向地址 127，这没有意义。

不过，我看不出这与您的代码有多大关系。那里的问题似乎`temp`并不指向有效数据。你声明一个指针，它指向一些未定义的地址。然后你说“无论它指向哪里，我都想写下`s`指向的值。以下应该会更好一些：

```
char temp; // not a pointer. We want a character to store our temporary value in
while (s <= e) {
    temp = *s; // note, no * on temp.
    *s = *e;
    *e = temp; // note, no * on temp.
    e--;
    s++;
} 
```

但是，如果`str`指向字符串文字，例如“hello world”，那么这将是不合法的，因为字符串数据本身是只读的。编译器可能不会强制执行它，但是您已经冒险进入未定义行为领域。如果要修改字符串，请将其复制到本地缓冲区中，如其他答案之一所示。

您似乎对指针的语义有些困惑。将地址（或可以转换为地址的东西，如整数）分配给指针会使指针指向该地址。它不会修改指向的数据。声明一个指针并不意味着它会指向任何有意义的东西。如果要存储 char，请声明 char 变量。指针不存储数据，它只是指向分配在别处的数据。

*编辑* 更新代码的注释和修复：

```
void something(const char * str) { // let the function take a pointer to a non-modifiable string, so add the const. Now it's clear that we're not allowed to modify the string itself, so we have to make a copy.
    char *s = new char[strlen(str) + 1]; // Since the original string is const, we have to allocate a copy if we want to modify it - in C, you'd use malloc(strlen(str)) instead
    strcpy(s, str);
    char *e = s; // make e point to the start of the copied string (don't allocate two copies, since e and s are supposed to work on the same string
    while (*e != '\0') { // add braces so it's clear where the loop starts and ends.
        e++;
    }
    e--;

    while (s <= e) { // the loop condition wouldn't work if s and e pointed to separate copies of the string
        cout << *e; // why? I thought you just wanted to reverse the string in memory. Alternatively, if you just want to print out the string reversed, you don't need to do most of the rest of the loop body. In C, you'd use printf instead of *e
        char temp = *s; // might as well declare the temp variable when you need it, and not before
        *s = *e;
        *e = temp;
        e--;
        s++;

    }
} 
```

仅供参考，并针对有关 C 与 C++ 的评论，以下是我如何编写一个函数来反转 C++ 中的字符串：

```
std::string revert_string(const std::string& str) {
  return std::string(str.rbegin(), str.rend());
} 
```

或者就地还原字符串：

```
std::string revert_string(const std::string& str) {
  std::reverse(str.begin(), str.end());
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-15T15:50:23.713

从技术上讲，你所拥有的更正确地写成这样：

```
const char *s = "Hello world!" 
```

你真正想要的是这样的：

```
char s[] = "Hello world!" 
```

以下几行可能会帮助您了解更多信息：

```
const char *p = "Hello World";
char q[] = "Hello World";
printf("%d %d", sizeof(p), sizeof(q));
// p[0] = 'W' // INVALID
q[0] = 'W'; // valid 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-15T16:22:58.627

您的删除会产生错误，因为您更改了指针。您应该保存新的原始位置，并删除[]它。您尝试删除不在分配表中的位置。如果你想改变指针值，再做一个 char *temp = t; 并使用它来迭代字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-15T16:38:39.073

有#sa 函数“strdup()”来制作字符串的副本……它确保您不会忘记 malloc 中的“+1”。

```
char* source = "Hello World";
char* dest = strdup(source); 
```

# xml - 在 XSLT 中用逗号作为小数分隔符对数字求和？

> ID：647991
> 
> 赞同：2
> 
> 时间：2009-03-15T15:35:55.667
> 
> 标签：xml, xslt, sum, decimalformat

我有一个 XML 文件，其中的数字以逗号分隔

```
<foo>
  <bar val="1,23"/>
  <bar val="4,56"/>
  <bar val="7,89"/>
</foo> 
```

我想对`/foo/bar/@val`XSLT 中的值求和，但我有点卡住了格式。有谁知道正确的语法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T16:42:27.190

我猜，`"val"`属性中指定的值是一个带有逗号而不是小数点的数字。

**几种解决方案是可能的**：

**一、XSLT 1.0**

这种转变：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:ext="http://exslt.org/common"
 >
  <xsl:output method="text"/>
<!--                                           -->  
    <xsl:template match="foo">
      <xsl:variable name="vrtfBars">
        <xsl:for-each select="bar">
          <bar val="{translate(@val, ',', '.')}"/>
        </xsl:for-each>
      </xsl:variable>
<!--                                           -->
      <xsl:value-of select=
       "sum(ext:node-set($vrtfBars)/*/@val)"/>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于最初提供的 XML 文档时**：

```
<foo>
    <bar val="1,23"/>
    <bar val="4,56"/>
    <bar val="7,89"/>
</foo> 
```

**产生想要的结果**：

```
13.68 
```

**二、XSLT 2.0**

**这种转变**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 exclude-result-prefixes="f xs"
 >
 <xsl:output method="text"/>
<!--                                           -->
 <xsl:template match="foo">
  <xsl:sequence select=
   "sum(bar/@val/number(translate(., ',', '.')))" 
   />
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于同一个 XML 文档时，会产生相同的正确结果**：

13.68

**三、[FXSL 2.x](http://fxsl.sf.net)**

**这种转变**：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 xmlns:f="http://fxsl.sf.net/"
 xmlns:my="my:fun"
 exclude-result-prefixes="my f xs"
 >
   <xsl:import href="../f/func-transform-and-sum.xsl"/>
<!--                                           -->
 <xsl:output method="text"/>
<!--                                           -->
 <xsl:template match="foo">
  <xsl:sequence select=
   "sum(
        f:transform-and-sum(my:makeNum(), bar/@val )
        )" 
   />
 </xsl:template>
<!--                                           -->
 <xsl:function name="my:makeNum" as="xs:double">
   <xsl:param name="psNum" as="xs:string"/>
<!--                                           -->
   <xsl:sequence select="number(translate($psNum, ',', '.'))"/>
 </xsl:function>
<!--                                           -->
 <xsl:function name="my:makeNum" as="element()">
   <my:makeNum/>
 </xsl:function>
<!--                                           -->
 <xsl:template match="my:makeNum" as="xs:double" mode="f:FXSL">
   <xsl:param name="arg1" as="xs:string"/>
<!--                                           -->
   <xsl:sequence select="my:makeNum($arg1)"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于同一个 XML 文档时，会产生相同的正确结果**：

13.68

**最后一种解决方案更灵活**，可以在求和之前需要对值进行更复杂的转换时成功使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-16T06:56:18.417

假设与 Dimitre 相同，您的意思是逗号用作小数分隔符，而不是用作整数列表的分隔符。

没有 EXSLT 节点集扩展的纯 XSLT 1.0：

```
<xsl:template match="foo">
  <xsl:call-template name="sum">
    <xsl:with-param name="node" select="bar[1]"/>
  </xsl:call-template>
</xsl:template>

<xsl:template name="sum">
  <xsl:param name="node"/>
  <xsl:param name="sum" select="0"/>
  <xsl:choose>
    <xsl:when test="$node">
      <xsl:call-template name="sum">
        <xsl:with-param name="node" select="$node/following-sibling::bar[1]"/>
        <xsl:with-param name="sum" select="$sum + translate($node/@val, ',', '.')"/>
      </xsl:call-template>
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="$sum"/>
    </xsl:otherwise>
  </xsl:choose>
</xsl:template> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-15T19:58:37.797

我觉得我说了很多，但它需要重复：XML 的全部意义在于它以易于解析的形式提供数据。包含无法解析为 XML 的数据的 XML 没有意义；如果可能的话，您应该修复您的 XML 或使用不同的格式。

# wcf - 如何更改 WCF 服务引用的地址？

> ID：647993
> 
> 赞同：4
> 
> 时间：2009-03-15T15:37:40.997
> 
> 标签：wcf, .net-3.5, deployment

我有一个内部使用的应用程序，它使用 WCF 在客户端和服务器部分之间进行通信，但是它很快需要部署到服务器名称不同的站点。WCF 服务使用 netTcp 绑定作为 Windows 服务托管。目前，服务的地址是使用 Visual Studio 中的“添加服务引用”命令指定的。

是否可以将 WCF 服务的基址设为用户偏好，然后在需要使用时让服务引用动态构造 URL。

例如，如果我有一个名为“CustomerService”的服务，是否可以让不同位置的两个不同用户指定地址：

```
net-tcp://myserver1/ 
```

和

```
net-tcp://anotherserver/ 
```

并让服务参考根据需要将这些转换为

```
net-tcp://myserver1/CustomerService 
```

和

```
net-tcp://anotherserver/CustomerService? 
```

谢谢，

吉姆

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-15T15:52:29.260

当您实例化客户端代理类（派生自 ClientBase 并实现您的服务合同的类）时，您可以指定一个远程地址：

```
var client = new MyServiceClient(
    "endpointConfigurationName", 
    "net-tcp://myserver1/CustomerService"); 
```

这样您就可以覆盖存储在 app/web.config 中的地址值

如果您直接使用[ChannelFactory<T>](http://msdn.microsoft.com/en-us/library/ms576132.aspx)类，则另一种选择：

```
var factory = new ChannelFactory<IMyServiceContract>(
    "endpointConfigurationName", 
    new EndpointAddress("net-tcp://myserver1/CustomerService"));
IMyServiceContract proxy = factory.CreateChannel(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-15T16:03:05.087

app.config或web.config中的配置不都是这些信息吗？只需更改端点配置中的 URL。

# javascript - IE中的SWFObject问题

> ID：647994
> 
> 赞同：0
> 
> 时间：2009-03-15T15:38:12.103
> 
> 标签：javascript, html, flash

我在 IE 中遇到 SWFObject 问题。

swf 文件显示，但 swf 以下的所有内容均不显示。

这是网址：[http ://timkjaerlange.com/wip/co2penhagen/](http://timkjaerlange.com/wip/co2penhagen/)

有什么想法可能是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-15T15:44:46.177

您缺少`</object>`标签。

# flash - 通过 Flash 获取操作系统版本

> ID：647995
> 
> 赞同：1
> 
> 时间：2009-03-15T15:38:44.147
> 
> 标签：flash

我想知道操作系统版本（Windows XP Home、Windows XP Pro、Windows Vista Ultimate、Windows Vista Business 等）是否可以通过 Flash 中的某种变量获得。

谢谢，

罗伊。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T15:43:39.830

是的，在某种程度上。[在此处查看](http://injun.ru/flash10api/flash/system/Capabilities.html#os)Capabilities 对象上的 os 属性：

> os:String [只读]
> 
> 语言版本：ActionScript 3.0
> 
> 播放器版本：Flash Player 9
> 
> **指定当前操作系统。**os 属性可以返回以下字符串：“Windows XP”、“Windows 2000”、“Windows NT”、“Windows 98/ME”、“Windows 95”、“Windows CE”（仅在 Flash Player SDK 中可用，在桌面版）、“Linux”和“MacOS”。服务器字符串是 OS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-08T21:00:04.957

> 我需要操作系统的确切版本，Windows XP 或 Windows Vista 是不够的。有子版本/版本。

这有点 hacky，但您可以从用户代理字符串中获取确切的操作系统版本。

字符串可以使用

```
ExternalInterface.call("window.navigator.userAgent.toString") 
```*******