# StackOverflow 问答 000346000-000346999

# vb.net - vb.net 中的 3d 文件

> ID：346009
> 
> 赞同：2
> 
> 时间：2008-12-06T06:23:07.203
> 
> 标签：vb.net, 3d, directx, direct3d, solidworks

我知道这将是一个难题，因此我不一定要寻找直接答案，而可能是教程或正确方向的观点。

我正在做的是对一个由远程操作员控制的机器人进行编程。我们在 SolidWorks 中有一个机器人的 3D 渲染。我要做的是将 3D 文件导入 VB（可能使用 DX9）并能够使用代码对其进行操作，以便远程操作员更好地了解机器人在做什么。操作员也将看到实时视频，但这对于这个问题并不重要。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T07:44:02.063

听起来是一个很难实施的想法。好吧，对于 VB，您只能使用[MDX](http://en.wikipedia.org/wiki/Managed_DirectX) 1.1（随附 DirectX SDK）或[SlimDX](http://slimdx.mdxinfo.com/wiki/index.php?title=Main_Page)（或其他第 3 方托管 DirectX 包装器）。最新的 XNA（MDX 1.1/2.0b 的替代品）仅适用于 C# 编码器。您可以尝试一些[解决方法](http://www.codeproject.com/KB/game/XNA_in_VB.NET.aspx)，但不建议这样做，并且您不会获得太多社区支持。这些是让您的 VB 显示一些 3d 内容所需的最少内容。

如果你想省点麻烦，你可以使用现成的游戏引擎来简化你的工作。试试[Ogre](http://www.ogre3d.org/)，它是托管包装器[MOgre](http://www.ogre3d.org/wiki/index.php/MOGRE)。它是我项目的候选人之一。但由于 Ogre 不能很好地支持视频，我最终选择了 SlimDX。但是由于视频不是您的要求，因此您可以真正考虑一下。大多数示例也将在 C# 中，因此您需要转换为 VB.Net 才能使用。不会很难。

困难的部分来了，您需要将从 SolidWorks 导出的模型导出为 DirectX 格式 (*.x)。我在 google 上进行了快速搜索，只找到了一些付费工具来做到这一点。您可能需要花一点时间或花更多时间寻找免费的转换器工具。

就是这样。如果您有更多问题，请再次发布。祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-12T01:53:12.560

我不确定真正的问题是什么，但我怀疑您正在尝试做的是能够通过某种手动输入来操纵机器人的 SW 模型。假设这是正确的问题，则需要注意两个方面：

1) Solidworks 模块：一旦机器人模型在 SW 中正常工作，就可以在 VB.Net 中编写一个程序，该程序可以操纵每个关节的位置配合。同样使用 VB，可以使用滑动条等对窗口进行编程，使操作员能够“远程”控制机器人。一旦完成，就有很好的机会设置一个可以存储顺序步骤的表。完成后，可以进一步开发 VB 程序以允许机器人“循环”通过一系列动作。如果模型中还添加了任何障碍物，这将是碰撞检测和离线训练的绝佳工具。

2) 如果问题还包括加入物理操作员，则有许多潜在的解决方案。希望机器人软件能够提供一个 VB 库，用于以编程方式对机器人进行通信和命令。如果是这种情况，则可以使用“运行”模式开发 VB 代码，其中 SW 机器人由操作员控制，而不是 VB 窗口中的控件（如上所述）。然后，这将允许操作员与虚拟机器人“离线”工作。

希望这可以帮助。

# c++ - project1st的用处是什么 在 STL 中？

> ID：346012
> 
> 赞同：4
> 
> 时间：2008-12-06T06:29:45.317
> 
> 标签：c++, stl, functional-programming

我正在浏览 SGI STL 文档并遇到[`project1st<Arg1, Arg2>`](http://www.sgi.com/tech/stl/project1st.html). 我理解它的定义，但我很难想象一个实际的用法。

您是否曾经使用过 project1st，或者您能想象一个场景吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-08T10:23:01.337

project1st 的一个变体（接受 a`std::pair`并返回`.first`）非常有用。您可以结合使用它`std::transform`来将密钥从 a 复制`std::map<K,V>`到 a `std::vector<K>`。类似地，`project2nd`可以使用 的变体将值从映射复制到`vector<V>`.

碰巧的是，没有一个标准算法真正受益于 project1st。最接近的是 partial_sum(project1st)，它将所有输出元素设置为第一个输入元素。它的存在主要是因为 STL 大量建立在数学集合论中，并且像 project1st 这样的操作是基本的构建块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T07:04:33.157

我的猜测是，如果您正在使用策略模式并且遇到需要传递身份对象的情况，这将是一个不错的选择。例如，可能存在一种算法采用多个此类对象的情况，并且您可能希望其中一个在某些情况下不执行任何操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-05T14:01:36.280

并行编程。想象一下这样一种情况，两个进程针对给定的计算得出两个有效但不同的结果，您需要强制它们相同。project1st/2nd 提供了一种非常方便的方法来在整个容器上执行此操作，使用适当的并行调用，该调用将仿函数作为参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T07:01:18.030

我假设*有人*对它有实际用途，或者它不会被写出来，但我在它可能是什么上画了一个空白。大概它的用例类似于`identity`描述中提到的函数，其中不需要处理，但语法无论如何都需要仿函数。

同一页面上的示例建议将其与 的两个容器形式一起使用`std::transform`，但如果我没记错的话，他们使用它的方式在功能上与 相同`std::copy`，所以我不明白这一点。

对我来说，它看起来像是寻找问题的解决方案。

# javascript - Javascript 闭包和“this”

> ID：346015
> 
> 赞同：40
> 
> 时间：2008-12-06T06:31:37.793
> 
> 标签：javascript, closures

我创建的一个看起来像这样的对象有问题：

```
var myObject = {

    AddChildRowEvents: function(row, p2) {
        if(document.attachEvent) {
            row.attachEvent('onclick', function(){this.DoSomething();});
        } else {
            row.addEventListener('click', function(){this.DoSomething();}, false);
        }
    },

    DoSomething: function() {
        this.SomethingElse(); //<-- Error here, object 'this' does not support this method.
    }
} 
```

问题是当我在“DoSomething”函数中时，“this”并不指“myObject”我做错了什么？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-06T07:16:34.660

当函数被调用时，“this”指的是行。如果你想拥有这个对象，你可以这样做：]

```
AddChildRowEvents: function(row, p2) {
    var theObj = this;
    if(document.attachEvent) {
         row.attachEvent('onclick', function(){theObj.DoSomething();});
    } else {
         row.addEventListener('click', function(){theObj.DoSomething();}, false);
    }
}, 
```

当函数被调用时，它可以访问定义函数时在作用域内的变量 theOBj。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-13T12:54:32.010

`this`总是指内部函数，如果你有嵌套函数，你必须创建另一个变量并将其指向`this`.

```
var myObject = {
    AddChildRowEvents: function(row, p2) {
        var that = this;
        if(document.attachEvent) {
            row.attachEvent('onclick', function(){that.DoSomething();});
        } else {
            row.addEventListener('click', function(){that.DoSomething();}, false);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-02-12T13:33:47.107

问题来自如何`this`在 JS 中进行管理，这可以很快，尤其是当您异步调用回调时（以及创建闭包时，绑定到 this）。

当调用 AddChildRowEvents 方法时，`this`引用变量`myObject`。但是这个方法的目的是为点击放置一个处理程序。因此，该事件将在将来的某个时间触发。到时候，什么对象会真正触发事件呢？事实上，它是`DOM element`用户点击的地方。所以`this`将引用这个`DOM element`而不是`myObject`变量。

对于比所提供的更现代的解决方案，可以使用`bind method`or `arrow function`。

## 1.带箭头功能的解决方案

```
let handler = {
	addEventHandler: function(row) {
	  console.log("this", this)
  	row.addEventListener("click", () => {
    	console.log("this", this)
    	this.doSomethingElse()
    })
  },

  doSomethingElse: function() {
  	console.log("something else")
  }
}
var div = document.querySelector("div")
handler.addEventHandler(div)
```

```
<div>one</div>
```

使用`arrow function`（从 开始可用`ES2015`），`this`上下文不是执行上下文，而是词汇上下文。两者的区别在于词法上下文是在构建时而不是在执行时找到的，因此词法上下文更容易跟踪。在这里，在内部`arrow function`，`this`引用与`this`外部函数（即`addEventHandler`）相同的引用`myObject`。

有关胖箭头函数与常规函数的属性的更多解释：[https ://dmitripavlutin.com/6-ways-to-declare-javascript-functions/](https://dmitripavlutin.com/6-ways-to-declare-javascript-functions/)

## 2.绑定解决方案

```
let handler = {
	addEventHandler: function(row) {
	  console.log("this", this)
  	row.addEventListener("click", function() {
    	console.log("this", this)
    	this.doSomethingElse()
    }.bind(this))
  },

  doSomethingElse: function() {
  	console.log("something else")
  }
}
var div = document.querySelector("div")
handler.addEventHandler(div)
```

```
<div>one</div>
```

这一次，当回调函数被传递给 时，已经将上下文`addEventListener`绑定到外部函数中的元素。`this``this``addEventHandler`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-13T12:38:06.650

这是闭包的常见问题。要解决它，请尝试以下操作：

```
var myObject = {    
    AddChildRowEvents: function(row, p2) { 
        var self = this;

        if(document.attachEvent) {            
             row.attachEvent('onclick', function(){this.DoSomething(self);});        
        } else {            
             row.addEventListener('click', function(){this.DoSomething(self);}, false);        
        }    
    },    

    DoSomething: function(self) {       
        self.SomethingElse(); 
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-17T07:06:39.463

The problem with your code is here, in the following line of code you have defined an anonymous function and passed it as an event handler for the onClick event, in the following lines:

```
 row.attachEvent('onclick', function(){this.DoSomething();}); 
```

and

```
 row.addEventListener('click', function(){this.DoSomething();}, false); 
```

when onclick event raised and it calls the anonymous function that you have passed, *this* context is referring to the object that has been raised the event, but not *myObject*. because at this point executing context is in the event handler context.

The solution: you can do the trick that Mike Kantor has been told, or using jQuery, use the proxy method, to define *this* context in the anonymous function.

So your code would be like this:

```
var myObject = {

    AddChildRowEvents: function(row, p2) {
        if(document.attachEvent) {
            row.attachEvent('onclick', $.proxy(function () {
                this.DoSomething();
            }, this));
        } else {
            row.addEventListener('click', $.proxy(function () {
                this.DoSomething();
            },this), false);
        }
    },

    DoSomething: function() {
        this.SomethingElse(); //<-- Error here, object 'this' does not support this method.
    }
} 
```

you have mentioned that the error is in *this.SomthingElse( )*, but your code does not show it. If you really getting error at that line of code, it may you are using the method *DoSomthing* somewhere else as an event handler.

# javascript - 如何从 JavaScript 关联数组中删除对象？

> ID：346021
> 
> 赞同：680
> 
> 时间：2008-12-06T06:44:05.723
> 
> 标签：javascript, arrays, associative-array, associative

假设我有这个代码：

```
var myArray = new Object();
myArray["firstname"] = "Bob";
myArray["lastname"] = "Smith";
myArray["age"] = 25; 
```

现在，如果我想删除“姓氏”？....是否有一些等价物 `myArray["lastname"].remove()`？

（我需要元素消失，因为元素的数量很重要，我想保持干净。）

* * *

## 回答 #1

> 赞同：1226
> 
> 时间：2008-12-06T06:46:34.767

JavaScript 中的对象可以被认为是关联数组，将键（属性）映射到值。

要从 JavaScript 中的对象中删除属性，请使用[`delete`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/delete)运算符：

```
const o = { lastName: 'foo' }
o.hasOwnProperty('lastName') // true
delete o['lastName']
o.hasOwnProperty('lastName') // false 
```

请注意，当`delete`应用于 an 的索引属性时[`Array`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)，您将创建一个[稀疏填充的数组](https://2ality.com/2012/06/dense-arrays.html)（即缺少索引的数组）。

使用 的实例时`Array`，如果您不想创建一个稀疏填充的数组（通常也不会），那么您应该使用[`Array#splice`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice)or [`Array#pop`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/pop)。

请注意，`delete`JavaScript 中的运算符不会直接释放内存。其目的是从对象中删除属性。当然，如果一个被删除的属性持有一个对象的唯一剩余引用`o`，那么`o`随后将以正常方式被垃圾收集。

使用`delete`操作符会影响 JavaScript 引擎[优化](http://www.html5rocks.com/en/tutorials/speed/v8/) [代码](http://www.smashingmagazine.com/2012/11/writing-fast-memory-efficient-javascript/)的能力。

* * *

## 回答 #2

> 赞同：87
> 
> 时间：2008-12-06T07:28:01.237

JavaScript 中的所有对象都实现为哈希表/关联数组。因此，以下是等价的：

```
alert(myObj["SomeProperty"]);
alert(myObj.SomeProperty); 
```

而且，如前所述，您可以通过关键字从对象中“删除”一个属性`delete`，您可以通过两种方式使用它：

```
delete myObj["SomeProperty"];
delete myObj.SomeProperty; 
```

希望额外的信息有帮助...

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2012-04-02T09:07:17.343

之前的答案都没有解决 JavaScript 没有以关联数组开头的事实 - 没有`array`这样的类型，请参阅[`typeof`](https://developer.mozilla.org/en/JavaScript/Reference/Operators/typeof)。

JavaScript 拥有的是具有动态属性的对象实例。当属性与 Array 对象实例的元素混淆时，Bad Things™ 必然会发生：

## 问题

```
var elements = new Array()

elements.push(document.getElementsByTagName("head")[0])
elements.push(document.getElementsByTagName("title")[0])
elements["prop"] = document.getElementsByTagName("body")[0]

console.log("number of elements: ", elements.length)   // Returns 2
delete elements[1]
console.log("number of elements: ", elements.length)   // Returns 2 (?!)

for (var i = 0; i < elements.length; i++)
{
   // Uh-oh... throws a TypeError when i == 1
   elements[i].onmouseover = function () { window.alert("Over It.")}
   console.log("success at index: ", i)
} 
```

## 解决方案

要拥有不会对您造成影响的通用删除功能，请使用：

```
Object.prototype.removeItem = function (key) {
   if (!this.hasOwnProperty(key))
      return
   if (isNaN(parseInt(key)) || !(this instanceof Array))
      delete this[key]
   else
      this.splice(key, 1)
};

//
// Code sample.
//
var elements = new Array()

elements.push(document.getElementsByTagName("head")[0])
elements.push(document.getElementsByTagName("title")[0])
elements["prop"] = document.getElementsByTagName("body")[0]

console.log(elements.length)                        // Returns 2
elements.removeItem("prop")
elements.removeItem(0)
console.log(elements.hasOwnProperty("prop"))        // Returns false as it should
console.log(elements.length)                        // returns 1 as it should 
```

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2010-09-13T03:41:24.843

这只会删除对象，但它仍然保持数组长度相同。

要从数组中删除元素，您需要执行以下操作：

```
array.splice(index, 1); 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2012-04-05T08:04:25.047

虽然接受的答案是正确的，但它缺少解释它为什么起作用的解释。

首先，您的代码应该反映这**不是**一个数组的事实：

```
var myObject = new Object();
myObject["firstname"] = "Bob";
myObject["lastname"] = "Smith";
myObject["age"] = 25; 
```

请注意，所有对象（包括`Array`s）都可以这样使用。但是，不要期望标准的 JavaScript 数组函数（pop、push 等）对对象起作用！

正如在接受的答案中所说，您可以使用`delete`从对象中删除条目：

```
delete myObject["lastname"] 
```

您应该决定您希望采用哪条路线 - 使用对象（关联数组/字典）或使用数组（映射）。切勿将两者混合。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2018-10-05T11:51:13.393

Airbnb 风格指南中有一种优雅的方式来做到这一点（ECMAScript 7）：

```
const myObject = {
  a: 1,
  b: 2,
  c: 3
};
const { a, ...noA } = myObject;
console.log(noA); // => { b: 2, c: 3 } 
```

版权所有：*[https ://codeburst.io/use-es2015-object-rest-operator-to-omit-properties-38a3ecffe90](https://codeburst.io/use-es2015-object-rest-operator-to-omit-properties-38a3ecffe90)*

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2012-06-21T15:24:44.510

正如其他答案所指出的那样，您使用的不是 JavaScript 数组，而是 JavaScript 对象，它的工作原理几乎与其他语言中的关联数组一样，只是所有键都转换为字符串。新[Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)将键存储为其原始类型。

如果你有一个数组而不是一个对象，你可以使用数组的[.filter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter)函数，返回一个没有你想要删除的项目的新数组：

```
var myArray = ['Bob', 'Smith', 25];
myArray = myArray.filter(function(item) {
    return item !== 'Smith';
}); 
```

如果你有一个旧的浏览器和 jQuery，jQuery 有一个[`$.grep`](https://api.jquery.com/jQuery.grep/)类似的方法：

```
myArray = $.grep(myArray, function(item) {
    return item !== 'Smith';
}); 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-07-23T05:06:16.183

使用方法`splice`从对象数组中完全删除一个项目：

```
Object.prototype.removeItem = function (key, value) {
    if (value == undefined)
        return;

    for (var i in this) {
        if (this[i][key] == value) {
            this.splice(i, 1);
        }
    }
};

var collection = [
    { id: "5f299a5d-7793-47be-a827-bca227dbef95", title: "one" },
    { id: "87353080-8f49-46b9-9281-162a41ddb8df", title: "two" },
    { id: "a1af832c-9028-4690-9793-d623ecc75a95", title: "three" }
];

collection.removeItem("id", "87353080-8f49-46b9-9281-162a41ddb8df"); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2011-06-01T08:57:49.090

您正在使用 Object，并且您没有关联数组开始。使用关联数组，添加和删除项目如下所示：

```
 Array.prototype.contains = function(obj)
    {
        var i = this.length;
        while (i--)
        {
            if (this[i] === obj)
            {
                return true;
            }
        }
        return false;
    }

    Array.prototype.add = function(key, value)
    {
        if(this.contains(key))
            this[key] = value;
        else
        {
            this.push(key);
            this[key] = value;
        }
    }

    Array.prototype.remove = function(key)
    {
        for(var i = 0; i < this.length; ++i)
        {
            if(this[i] == key)
            {
                this.splice(i, 1);
                return;
            }
        }
    }

    // Read a page's GET URL variables and return them as an associative array.
    function getUrlVars()
    {
        var vars = [], hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');

        for(var i = 0; i < hashes.length; i++)
        {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }

        return vars;
    }

    function ForwardAndHideVariables() {
        var dictParameters = getUrlVars();

        dictParameters.add("mno", "pqr");
        dictParameters.add("mno", "stfu");

        dictParameters.remove("mno");

        for(var i = 0; i < dictParameters.length; i++)
        {
            var key = dictParameters[i];
            var value = dictParameters[key];
            alert(key + "=" + value);
        }
        // And now forward with HTTP-POST
        aa_post_to_url("Default.aspx", dictParameters);
    }

    function aa_post_to_url(path, params, method) {
        method = method || "post";

        var form = document.createElement("form");

        // Move the submit function to another variable
        // so that it doesn't get written over if a parameter name is 'submit'
        form._submit_function_ = form.submit;

        form.setAttribute("method", method);
        form.setAttribute("action", path);

        for(var i = 0; i < params.length; i++)
        {
            var key = params[i];

            var hiddenField = document.createElement("input");
            hiddenField.setAttribute("type", "hidden");
            hiddenField.setAttribute("name", key);
            hiddenField.setAttribute("value", params[key]);

            form.appendChild(hiddenField);
        }

        document.body.appendChild(form);
        form._submit_function_(); // Call the renamed function
    } 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-01-04T17:59:11.773

您可以通过将条目显式分配给“未定义”来从地图中删除条目。与您的情况一样：

> 我的数组 [“姓氏”] = 未定义；

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-05-20T02:12:22.183

如果出于某种原因，删除键不起作用（就像它对我不起作用），您可以将其拼接出来，然后过滤未定义的值：

```
// To cut out one element via arr.splice(indexToRemove, numberToRemove);
array.splice(key, 1)
array.filter(function(n){return n}); 
```

不要尝试链接它们，因为 splice 返回已删除的元素；

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-05-29T19:23:44.677

如果您的项目中有[Underscore.js](http://underscorejs.org/#omit)依赖项，这非常简单 -

```
_.omit(myArray, "lastname") 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-08-06T05:06:44.827

通过使用**`"delete"`**关键字，它将从 JavaScript 中的数组中删除数组元素。

例如，

考虑以下陈述。

```
var arrayElementToDelete = new Object();

arrayElementToDelete["id"]           = "XERTYB00G1";
arrayElementToDelete["first_name"]   = "Employee_one";
arrayElementToDelete["status"]       = "Active";

delete arrayElementToDelete["status"]; 
```

代码的最后一行将从数组中移除键为“status”的数组元素。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-01-07T18:47:24.213

我们也可以将其用作函数。如果用作原型，Angular 会抛出一些错误。谢谢@HarpyWar。它帮助我解决了一个问题。

```
var removeItem = function (object, key, value) {
    if (value == undefined)
        return;

    for (var i in object) {
        if (object[i][key] == value) {
            object.splice(i, 1);
        }
    }
};

var collection = [
    { id: "5f299a5d-7793-47be-a827-bca227dbef95", title: "one" },
    { id: "87353080-8f49-46b9-9281-162a41ddb8df", title: "two" },
    { id: "a1af832c-9028-4690-9793-d623ecc75a95", title: "three" }
];

removeItem(collection, "id", "87353080-8f49-46b9-9281-162a41ddb8df"); 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2021-08-16T06:31:55.590

如果您想要更实用和更优雅的方法，您可以执行以下操作：

```
const o = { firstName: "foo", lastName: "bar" };
const { lastName, ...removed } = o;
lastName // bar
removed // { firstName: "foo" } 
```

请注意，`removed`如果对象中没有剩余项目，则 的值将是未定义的。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-07-14T10:24:24.290

对于“数组”：

**如果你知道索引：**

```
array.splice(index, 1); 
```

**如果你知道价值：**

```
function removeItem(array, value) {
    var index = array.indexOf(value);
    if (index > -1) {
        array.splice(index, 1);
    }
    return array;
} 
```

最受好评的答案`delete`在对象的情况下效果很好，但不适用于真正的数组。如果我使用`delete`它会从循环中删除元素，但保持元素不变，`empty`并且数组的长度不会改变。在某些情况下，这可能是一个问题。

例如，如果我在通过 删除后对 myArray 执行 myArray.toString() `delete`，它会创建一个空条目，即`,,`.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-07-20T20:39:48.113

对我来说唯一的工作方法：

```
function removeItem (array, value) {
    var i = 0;
    while (i < array.length) {
        if(array[i] === value) {
            array.splice(i, 1);
        } else {
            ++i;
        }
    }
    return array;
} 
```

用法：

```
var new = removeItem( ["apple","banana", "orange"],  "apple");
// ---> ["banana", "orange"] 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2017-06-14T07:25:38.990

```
var myArray = newmyArray = new Object();
myArray["firstname"] = "Bob";
myArray["lastname"] = "Smith";
myArray["age"] = 25;

var s = JSON.stringify(myArray);

s.replace(/"lastname[^,}]+,/g, '');
newmyArray = JSON.parse(p); 
```

如果没有循环/迭代，我们会得到相同的结果。

# c++ - 如果 CHttpConnection::OpenRequest 返回 NULL 我该如何找出原因

> ID：346024
> 
> 赞同：0
> 
> 时间：2008-12-06T06:48:00.083
> 
> 标签：c++, mfc, httpwebrequest

c++ mfc

如果 CHttpConnection::OpenRequest 返回 null 我可以使用什么来获取 Internet 错误。mfc 文章并没有说明糟糕的响应是什么样的。我只是说它返回一个 CHttpFile 的句柄。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T08:16:21.047

您看到 GetLastError() 返回的错误代码是什么了吗？获取错误代码并执行错误查找（工具->错误查找）以获取有关代码的描述。通常，您将使用它获得失败的确切原因。

# oracle - VB 和 Oracle 连接

> ID：346033
> 
> 赞同：1
> 
> 时间：2008-12-06T07:02:45.470
> 
> 标签：oracle, vb6

使用 VB6 连接到 Oracle 9i 的步骤是什么？如何在 VB6 中使用模块和存储过程，如何调用 SP？

使用 ADO 的方法是什么，有助于从前端插入、更新、搜索和删除项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T07:22:43.137

您将需要 ADO 来连接到 Oracle（添加对 microsoft activex 数据对象库的引用）。

您需要知道 Oracle 实例以及用户名和密码托管在哪里？

Oracle 的连接字符串可以从 www.connectionstrings.com 找到

ADODB.Connection 是您建立连接所需要的。
Connection 具有 Execute 方法 - 您可以将其用于任何插入/更新/删除语句。

现在，从 MSDN 阅读有关 ADO 对象库的一些文档。并且，自己编写代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-08T18:23:22.693

您可以在 Oracle OLEDB 驱动程序（我认为 YogoZuno 提到的 Oracle 客户端安装附带）或 Microsoft 的驱动程序之间进行选择（不记得它只是标准的 microsoft oledb 驱动程序还是向 oracle 点头发布的驱动程序）：无论如何，Oracle OLEDB 驱动程序要好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T22:59:47.137

您还需要在 PC 上安装 Oracle 客户端以及适当的 TNS 名称文件。另外，请注意，Oracle 9 客户端的不同版本之间存在一些细微的功能差异——我在 v9.2.0.1 下遇到了一些问题，而在 v9.2.0.7 下没有出现。

# jquery - JQuery JCrop - 如何设置固定大小的选择区域？

> ID：346045
> 
> 赞同：30
> 
> 时间：2008-12-06T07:17:22.803
> 
> 标签：jquery, crop, jcrop

我试图弄清楚如何修复 JCrop 下的选择框大小。该文档提到了如何设置初始选择区域，但没有提到如何使其固定大小。有谁知道我怎样才能修复它。提前致谢。

[http://deepliquid.com/content/Jcrop_Manual.html](http://deepliquid.com/content/Jcrop_Manual.html)

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2010-01-20T15:25:50.127

您基本上是在寻找 API 部分。我自己广泛使用了这个插件，我确切地知道你在找什么：

```
var api;
var cropWidth = 100;
var cropHeight = 100;

$(window).load(function() {

    // set default options
    var opt = {};

    // if height and width must be exact, dont allow resizing
    opt.allowResize = false;
    opt.allowSelect = false;

    // initialize jcrop
    api = $.Jcrop('#objectId', opt);

    // set the selection area [left, top, width, height]
    api.animateTo([0,0,cropWidth,cropHeight]);

    // you can also set selection area without the fancy animation
    api.setSelect([0,0,cropWidth,cropHeight]);

}); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-07-31T05:13:40.553

您可以使用 aspectRatio 选项。这将强制进行方形选择

```
$(function(){
    $('#cropbox').Jcrop({
        aspectRatio: 1
    });
}); 
```

或 aspectRatio: 16/9 将使其宽屏:-)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-02-08T21:32:27.967

您可以将 aspectRatio 设置为十进制值

```
$('#jcrop_target').Jcrop({
    setSelect: [0,0,150,100],
    aspectRatio: 150/100
}); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-06T14:08:05.627

使用[此示例](http://deepliquid.com/projects/Jcrop/demos.php?demo=handler)，您应该能够保持大小固定。

```
$(function(){
    $('#jcrop_target').Jcrop({
        onChange: function(){ $(this).setSelect([x, y, x2, y2]); }
    });
}); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-07-07T22:18:53.333

```
aspectRatio: 1,
minSize: [ 100, 100 ],
maxSize: [ 100, 100 ] 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-05-22T09:49:39.647

这非常容易...

```
allowResize: false 
```

例如

```
$(function(){
    $("#CropSource").Jcrop({
        aspectRatio: 1,
        setSelect:   [50, 0, 300,300],
        allowResize: false
    });
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-03-09T07:08:12.480

嗨，这可能会有所帮助-

```
<script>
$(window).load(function() {
    var jcrop_api;
    var i, ac;

    initJcrop();

    function initJcrop() {
            jcrop_api = $.Jcrop('#imgCrop', {
            onSelect: storeCoords,
            onChange: storeCoords
            });
            jcrop_api.setOptions({ aspectRatio: 1/ 1 });
            jcrop_api.setOptions({
            minSize: [180, 180],
            maxSize: [180, 250]
        });
        jcrop_api.setSelect([140, 180, 160, 180]);
    };
    function storeCoords(c) {
    jQuery('#X').val(c.x);
    jQuery('#Y').val(c.y);
    jQuery('#W').val(c.w);
    jQuery('#H').val(c.h);
    };        
});
</script> 
```

# iphone - 获取此异常 [CFURL 发布]：调试 iPhone 应用程序时发送到已释放实例 0x1049530 的消息

> ID：346047
> 
> 赞同：2
> 
> 时间：2008-12-06T07:22:22.853
> 
> 标签：iphone, cocoa-touch

标题说明了一切。

我已经为项目启用了 NSZombieEnabled。

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-07T04:39:25.397

你在任何地方都调用 [justURL release] 吗？你不应该，因为它是为你自动发布的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T21:18:02.077

只是在黑暗中拍摄（没有费心测试它的行为），但是您确定 -URLWithString: 正在返回一个值吗？您是否在 NSLog 之后看到日志中的 URL？

如果 -URLWithString: 不喜欢 URL（例如，如果其中有空格），那么它将返回一个 nil 值，而 -arrayWithContentsOfURL: 可能不喜欢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-30T16:00:15.603

我做了完全相同的事情，例如调用 [justURL release].. 评论了，瞧！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:01:31.477

我有同样的问题并修复了它。

首先我创建我的网址：

```
contentUrl = [NSURL URLWithString:step.Videolink]; 
```

然后我释放它

```
[contentUrl release]; 
```

它的粗略错误，因为`NSURL URLWithString:`创建`autorelease`对象。

# asp.net - 在 asp.net（访问数据库）中编写更新查询（visual basic）

> ID：346048
> 
> 赞同：1
> 
> 时间：2008-12-06T07:22:23.900
> 
> 标签：asp.net, vb.net, ms-access

我有这个代码：

```
 Dim pathString As String = HttpContext.Current.Request.MapPath("Banking.mdb")
    Dim odbconBanking As New OleDbConnection _
             ("Provider=Microsoft.Jet.OLEDB.4.0;" & _
             "Data Source=" + pathString)
    Dim sql As String
    sql = "UPDATE tblAccounts balance = " & CDbl(balance + value) & " WHERE(accountID = " & accountID & ")"
    odbconBanking.Open()
    Dim cmd As New OleDbCommand(sql, odbconBanking)
    cmd.ExecuteNonQuery() 
```

但是，当我运行它时会引发异常： UPDATE 语句中的语法错误。

我尝试在 Access 中运行类似的语句，它工作正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T07:30:33.773

我认为缺少的是 SET。

尝试： UPDATE table SET field = newvalue WHERE 条件；

只需修改：

```
sql = "UPDATE tblAccounts SET balance = " & CDbl(balance + value) & " WHERE(accountID = " & accountID & ")" 
```

[http://office.microsoft.com/en-us/access/HA100765271033.aspx](http://office.microsoft.com/en-us/access/HA100765271033.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T14:25:43.577

SQL 语句肯定缺少 SET 关键字。另外，我建议您复习[参数化查询](http://www.4guysfromrolla.com/webtech/092601-1.2.shtml)：

```
Dim sql As String = "UPDATE tblAccounts " & _
                    "SET balance = ? " & _
                    "WHERE(accountID = ?)"

Dim cmd As New OleDbCommand(sql, odbconBanking)

cmd.Parameters.Add("Balance", CDbl(balance + value))
cmd.Parameters.Add("AccountId", accountID

cmd.ExecuteNonQuery() 
```

这样，不仅 SQL 语句更清晰，而且有助于防止可能的 SQL 注入攻击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T07:25:34.313

您缺少 SET 作为 UPDATE 的一部分。

它应该是 UPDATE tablename SET fieldname = ... WHERE [criteria]。

附带说明一下，您在 asp.net 中使用了经典的 asp 样式代码。我建议阅读 ASP.net 上的一些文档以及如何以分层方式设计应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T07:36:16.993

一个好的开始：Enterprise Library's Data Access Application Block

链接：[http ://aspnet.4guysfromrolla.com/articles/030905-1.aspx](http://aspnet.4guysfromrolla.com/articles/030905-1.aspx)

# delphi - 是否可以记录 Delphi 应用程序和 MsAccess DB 之间的 SQL 查询？

> ID：346057
> 
> 赞同：2
> 
> 时间：2008-12-06T07:34:54.000
> 
> 标签：delphi, ado

我有一个使用`ADO/MSDASQL.1`提供程序的 Delphi 7 应用程序，我想知道是否可以以简单的方式“记录”发送到数据库的 SQL 查询？就像 SQL Server 中的 SQL 探查器一样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T12:24:32.993

在您的应用程序中，您可以在 TADOConnection.OnWillExecute 事件中记录命令，您只需保存 CommandText，但您还可以记录许多其他选项。

```
procedure TForm23.ADOConnection1WillExecute(Connection: TADOConnection; var
  CommandText: WideString; var CursorType: TCursorType; var LockType:
  TADOLockType; var CommandType: TCommandType; var ExecuteOptions:
  TExecuteOptions; var EventStatus: TEventStatus; const Command: _Command;
  const Recordset: _Recordset);
begin
   LogToFile( CommandText );
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T21:45:45.920

我做了类似的事情，但我所有的查询都通过一个点。此时添加日志记录是一个简单的更改。另一种选择是创建一个从 TADOQuery 派生的 TLogADOQuery 类，并覆盖**ExecuteSQL**和**Open**以记录进入数据库的 SQL。然后，您将所有对 TADOQuery 的引用替换为您的新类。

# c++ - C++ 类头文件组织

> ID：346058
> 
> 赞同：56
> 
> 时间：2008-12-06T07:35:20.207
> 
> 标签：c++, class, file, header, organization

对于必须处理分布在多个源文件和头文件中的大量相互依赖的类的人，您建议的 C++ 编码和文件组织指南是什么？

我的项目中有这种情况，解决跨多个头文件的类定义相关错误变得相当头疼。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-12-06T08:35:56.420

一些一般准则：

*   将您的接口与实现配对。如果你有`foo.cxx`，最好在里面声明所有定义的东西`foo.h`。
*   确保每个头文件#includes 所有其他必要的头文件或独立编译所需的前向声明。
*   抵制创建“一切”标题的诱惑。他们总是在路上遇到麻烦。
*   将一组相关（且相互依赖）的功能放入单个文件中。Java 和其他环境鼓励每个文件一个类。使用 C++，您通常需要每个文件一*组类。*这取决于代码的结构。
*   `#include`尽可能优先使用前向声明而不是s。这允许您打破循环头依赖关系。本质上，对于跨单独文件的循环依赖关系，您需要一个看起来像这样的文件依赖关系图：
    *   `A.cxx`要求`A.h`和`B.h`
    *   `B.cxx`要求`A.h`和`B.h`
    *   `A.h`需要`B.h`
    *   `B.h`是独立的（并且前向声明定义在 中的类`A.h`）

如果您的代码打算成为其他开发人员使用的库，则需要采取一些额外的步骤：

*   如有必要，请使用“私有标头”的概念。也就是说，多个源文件需要的头文件，但公共接口从不需要。这可能是一个具有通用内联函数、宏或内部常量的文件。
*   在文件系统级别将您的公共接口与您的私有实现分开。我倾向于在我的 C 或 C++ 项目中使用`include/`和子目录，其中有我所有的公共头文件，并且有我所有的源代码。和私有标头。`src/``include/``src/`

我建议找一本 John Lakos 的书*Large-Scale C++ Software Design*。这是一本相当厚重的书，但如果你只是浏览一下他关于物理架构的一些讨论，你会学到很多东西。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-06T11:11:25.403

查看[NASA 戈达德太空飞行中心](http://software.gsfc.nasa.gov/assetsbytype.cfm?TypeAsset=Standard)的 C 和 C++ 编码标准。我在 C 标准中特别指出并在我自己的代码中采用的一条规则是强制执行头文件的“独立”性质的规则。在头文件 xxx.h 的实现文件 xxx.cpp 中，确保 xxx.h 是包含的第一个头文件。如果头文件在任何时候都不是自包含的，那么编译将失败。这是一个非常简单而有效的规则。

唯一失败的情况是，如果您在机器之间进行移植，并且 xxx.h 标头包括，例如`<pqr.h>`，但`<pqr.h>`需要`<abc.h>`原始平台上的标头提供的设施（因此`<pqr.h>`包括`<abc.h>`），但这些设施不是由`<abc.h>`其他平台提供（它们在`def.h`，但`<pqr.h>`不包括`<def.h>`）。这不是规则的错误，如果您遵守规则，问题更容易诊断和解决。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-06T08:34:49.527

[检查Google 样式指南](https://google.github.io/styleguide/cppguide.html#Header_Files)中的头文件部分

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-06T13:50:42.557

[汤姆的回答](https://stackoverflow.com/a/346098/366904)非常好！

我唯一要添加的是在头文件中永远不要有“使用声明”。它们应该只允许在实现文件中使用，例如`foo.cpp`.

[优秀的书“Accelerated C++”（亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/020170353X)- 为脚本儿童链接纳粹清理过）很好地描述了这一点的逻辑

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-07T21:58:16.440

除了这里的其他一点之外，还有一点：

> 不要在包含文件中包含任何私有定义。例如，仅在 xxx.cpp 中使用的任何定义都应该在 xxx.cpp 中，而不是 xxx.h 中。

看起来很明显，但我经常看到它。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-06-30T07:04:52.260

我想添加一个经常被放弃的非常好的实践（在 C 和 C++ 中）：

## foo.c

```
#include "foo.h" // always the first directive 
```

任何其他需要的标题都应该跟在后面，然后是代码。关键是，无论如何，您几乎总是需要该编译单元的标头，并且将其作为第一个指令包含在内可保证标头保持自给自足（如果不是，则会出现错误）。对于公共标头尤其如此。

如果在任何时候您需要在此标头包含之前放置一些内容（当然注释除外），那么您很可能做错了什么。除非你真的知道你在做什么......这会导致另一个更重要的规则 => 评论你的黑客！

# turtle-graphics - 你觉得学习用海龟图形编程有用吗？

> ID：346061
> 
> 赞同：11
> 
> 时间：2008-12-06T07:37:27.787
> 
> 标签：turtle-graphics, logo-lang

我正准备教别人编程。当我学习课程材料时，我在前几个练习中使用了海龟图形。在阅读介绍性教科书时，我还没有找到使用该技术的教科书。其他人是否发现这种方法有帮助？如果不是，那么学习编程的更好方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T09:19:21.463

我认为这取决于目标群体的年龄。

如果他们是孩子（我会说最多 12-14 岁），做任何简单的图形都是激励他们的好方法；另一方面，不要指望他们能学到很多关于真正的编程或算法的知识。

如果他们是青少年（14-18 岁），使用一些给出漂亮结果的算法（例如 3D 或分形）也许仍然很好，但由于他们年龄较大且能够进行更抽象的思考，我不认为 2D 乌龟图形足够有趣。

如果他们年纪大了，做任何图形都会分散注意力。在那个年龄，他们应该有足够的内在动力去学习，而不用花哨的东西。

总而言之，我认为花哨的图形比学习角色（让学习真正的编程更容易）更能起到激励作用（你可以快速看到你做了什么，并且很容易向其他人展示你可以用计算机做什么）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-06T09:01:45.103

在 80 年代后期，在我使用 C 编程之前，我使用[Applesoft BASIC](http://en.wikipedia.org/wiki/Applesoft_BASIC)和[Logo](http://en.wikipedia.org/wiki/Logo_(programming_language))进行编程。小时候，我认为[乌龟](http://en.wikipedia.org/wiki/Turtle_graphics)很棒，因为它使编程变得简单。如果我决定教我的孩子 Logo，我可能会从[这里](http://www.cs.berkeley.edu/~bh/logo.html)开始获得一个积极开发的 Logo 解释器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T14:32:05.157

在教授编程方面，你可能会比使用[Scratch](http://scratch.mit.edu/ "刮")之类的工具做得更糟。它是一个拖放式编程界面，可用于教授编程的基本概念，并提供一些有趣的视觉效果（从他们网站上的图库中可以看到）。

抢

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T09:22:49.010

LOGO的关键在于用户自定义功能。它非常擅长传达这一点，只要你强调它。以交互方式展示如何绘制正方形，然后创建一个名为 square 的新单词。然后展示如何使用正方形绘制图案。然后将这些模式变成单词，依此类推。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-06T20:10:31.433

Logo 给了我一个关于递归函数如何工作的非常清晰的画面（不是双关语），而且由于我当时正在做汇编编程，所以在返回方法时需要返回到以前的状态变得非常清楚 Logo。

递归实现的东西在哪里也很容易看出效果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T10:04:58.300

在我知道编程是什么之前，我用类似 C 语言的方言为一款名为 Doom2 的游戏编写了脚本/代码，所以当我认真学习指针、继承和多态等概念时，我发现基础知识轻而易举，因为我可以构建一个心智模型不仅可以帮助我理解，而且还可以欣赏指针和数组之类的东西有多酷。

我的一个朋友是一名优秀的编程学生，但当他无法想象算法的工作时，他会感到沮丧，当我开始帮助其他学生时，我发现他们也遇到了同样的问题，如果他们看不到某些东西在工作，那就更难了作为一个初出茅庐的程序员，这位朋友雄辩地建议我“向他们展示一些疯狂的皮条客，*然后*向他们展示它是如何完成的”。他是对的，即使有人真的想学习一些东西，如果他们认为他们正在学习的东西可以让他们做一些很棒的事情，他们就能够利用更多的精神能量。

我最好的建议是：**在开始时，尽可能少地在控制台上编程**

它让你感到束缚，你的努力似乎是徒劳的，只有在你欣赏它作为前端之后，才应该将它用于学习编程。我自己不会使用 logo，因为我认为它不能像其他方法一样教授诸如上述多态性或继承之类的概念，我知道我的一个朋友正在教一个青少年如何在包装器中使用 XNA 进行编程，我认为任何可以让您将图像粘贴到屏幕上的东西都可以。这样你就可以看到为什么你想要一个名为 EnemyEntity 的抽象基类，它的行为被僵尸和狗等继承。并不是这些概念很难理解，只是一开始它们很难理解。

我可以继续，但我认为这体现了我通过教别人学到的东西。我认为在教学编程中使用图形可以让学生比其他任何方法更快地获得建立无形概念的心理模型的能力。

[XNA](http://creators.xna.com/en-US/)如果您想教授 C#，这是一个了不起的图形库，只需编写一个包装 sprite 类以在刚开始和教授概念时隐藏尽可能多的复杂性。

[SDL](http://www.libsdl.org/index.php)如果你打算从 C++ 开始，一个较低级别的库

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T11:30:51.747

在我第一年的一篇计算机科学论文中，我们使用 Java 通过海龟对象创建分形图案。

直观地看到我们是否正确实现了生成特定模式所需的算法是非常有趣的。但是，请回答主要问题，我不会说通过海龟编程很有用。我想说教某人编程的最好方法是让他们构建自己的应用程序来做他们想做的任何事情。这给了他们创造性的控制权，而且如果他们陷入困境，他们可以学习如何解决问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-28T11:34:26.513

LOGO不仅是Turtle-Graphics。其中还有其他有趣的概念来自 LISP。“Turtle”只是锦上添花，也是 Logo 的“势在必行”的一面。:)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-27T13:18:01.040

由于错误消息的质量，我强烈建议从 Logo 之类的解释语言（未编译）开始。在此过程中，阅读错误消息非常重要。此外，在简单的层面上，Logo 允许您以直接模式一一运行您的指令，并在您获得预期结果时将它们带到您的程序中。

@Alex：MicroWorlds 是 Logo 的商业版本，它确实存在英语、西班牙语、葡萄牙语、意大利语、俄语等。如果您不是以英语为母语的人，这是一个很大的优势。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-06T08:15:35.307

我通过编写简单的程序在屏幕上绘制人脸（我的意思是圆形和正方形）来学习 BASIC 编程。不知何故，整个海龟编程从来都不是我的事，尽管我的一些朋友是这样学习的。后来我转向 Pascal，然后转向 Delphi、Java 和 C++/C#。在我看来，诀窍是让你的学生“惊叹”，并用你可以通过编写自己的程序来完成的潜在事情给你留下深刻印象/赋予权力。我实际上会演示一些 GUI 编程或游戏编程。通过牢记最终目标，学习基础知识要容易得多。

最近我遇到了[SmallBasic——](http://msdn.microsoft.com/en-us/devlabs/cc950524.aspx)一个很酷的编程环境，专为教授概念而设计。我会试一试。它附带了一篇非常完整的论文，描述了如何使用它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-04T00:36:04.190

个人经验，YMMV...

我第一次接触电脑是在我十几岁时的海龟图形。我喜欢并立即被迷住了。（也许是因为第一次有人[某事]完全按照我的吩咐去做了？）

视觉和即时反馈让我想做更多的事情。我真的很想弄清楚如何复制我在使用的书中看到的图片。甚至不用我把它归类为“工作”，它慢慢地建立了我早期的编程技能和我可以自学的信心。

我相信它让我走上了今天的道路，一个快乐的软件开发人员，他不敢相信我能得到报酬来做这项工作（我知道，我知道 - 除了所有公司的窃笑，我喜欢我的工作）。

正如我所说，YMMV。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-06T09:36:21.960

当我得到我的第一台计算机 (VIC-20) 并开始编程时，很难向我的父母解释我在做什么。

我母亲参加了计算机课程，为她工作的图书馆的计算机化项目做准备。他们有几节课向他们介绍编程。学完LOGO后，她回到家说她突然明白我在做什么了。

因此，带有乌龟图形的LOGO让我们更加紧密地联系在一起！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-08T02:14:10.573

我在八十年代末开设了“儿童计算”课程，其中有一个关于使用徽标的海龟图形的广泛部分。老实说，我厌倦了流泪，几乎没有从中学到任何东西。

我认为“给海龟编程”可能更适合那些有艺术倾向的人，或者非常喜欢几何学的人，但总的来说，有更多有趣的问题需要解决，即使对孩子来说也是如此。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-06T20:07:29.163

我在学校也用过标志和乌龟，很好的介绍。

看起来我们的孩子将获得与[Microsoft Kodu](http://research.microsoft.com/en-us/projects/kodu/)的稍微更新的界面。它看起来非常令人印象深刻。它是一种基于图标的编程语言，用于创建在 X-Box Live 上运行的游戏。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-10T02:09:51.860

啊，美好的老Logo的回忆。我想我从中学到的更多的是几何课而不是编程课，例如，弄清楚在不同的点上转动多少才能产生特定的形状、设计或图案。如果您计划将几何与编程混合使用，它可能会起作用，但如果该人没有几何基础知识，例如什么是正方形，它与其他 4 面形状有何不同，什么是三角形等。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-06T21:03:45.477

我目前正在学习python并使用一点乌龟。在实验室中我们没有使用它，但我们的家庭作业却使用了它。很高兴知道它的存在，这是获取某些命令和语法的好方法。总的来说，我觉得这不是完全必要的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-11-20T12:14:39.087

我刚刚开始教我 7 岁的孩子如何使用 Logo 进行编程，他玩得很开心。对于他有限的阅读能力，这些命令很容易，他只是喜欢使用海龟图形绘制很酷的图片。我很惊讶他能很好地保留他使用它学到的东西，所以我觉得这对他的年龄来说是一个不错的选择。

对于年龄较大的孩子（或成人），其他语言作为初学者语言可能具有更多优势

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-08-26T21:16:15.970

当我年轻的时候，我觉得这很有趣。它是我学习的第一批编程语言之一，尽管我已经使用了大约两天。它开始了我对编程的兴趣。

现在，我认为语法有点不清楚，因为大多数语句都是缩写。如今，计算机的功能要强大得多，因此该语言可以从更清晰的陈述中受益。另一个因素是学习使用它的人的母语。如果英语不是您的母语，那么徽标会变得更难理解。因此，如果您要向孩子们教授 Logo，请确保他们首先熟悉英语术语。（如果您是母语为英语的人，这很容易。如果您最初是荷兰语、德语、法语、葡萄牙语，则更复杂。如果您是俄语或中国人，则更复杂，因为您必须适应不同的字符也设置了。）

# c# - C# - 无法解析 DirectX SDK 中的 XInput 命名空间（2008 年 11 月）

> ID：346069
> 
> 赞同：3
> 
> 时间：2008-12-06T07:54:02.587
> 
> 标签：c#, directx, controller, xbox, xinput

我刚刚开始使用directx，并且在互联网上阅读了一些使用XInput 与Xbox 控制器交互的文章。

当我尝试在我的 c# 应用程序中使用它时，我似乎找不到要引用的正确程序集。据我了解，它应该在`Microsoft.DirectX.dll`(namespace `Microsoft.DirectX.XInput`) 中，但是当我添加引用时，它并没有得到解决。

我错过了什么吗？我应该尝试早期版本的 sdk 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T09:06:16.467

这里似乎很奇怪。Microsoft 不再提供托管的 directx，我刚刚检查了我的参考列表，托管库没有 Microsoft.DirectX.XInput。最喜欢它仅适用于 C++ 和 XNA。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T22:33:04.920

DirectX for .Net 有一个出色的第 3 方包装器，称为 SlimDX：[http ://slimdx.mdxinfo.com/wiki/index.php?title=Main_Page](http://slimdx.mdxinfo.com/wiki/index.php?title=Main_Page)

它与托管 DX 非常相似。我已经使用它几个月了，现在有 0 个问题。

# c# - 连接列表的配置窗口

> ID：346071
> 
> 赞同：2
> 
> 时间：2008-12-06T07:56:44.737
> 
> 标签：c#, user-interface, data-binding, configuration

我正在编写一个需要用于连接列表的配置窗口的程序。我有一个 ListBox 来列出连接，每个条目有 8 个左右的设置。看来我应该以某种方式使用数据绑定将数据绑定到某些东西（可能以某种方式直接绑定到内置设置系统？），我应该如何实现呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T10:09:02.737

[如果您准备好按照 Microsoft模式和实践](http://msdn.microsoft.com/en-us/library/ms998572.aspx)指南设计您的程序，您可以使用预定义的[Design-Time Configuration](http://msdn.microsoft.com/en-us/library/dd139921.aspx)。企业库配置工具包括一个*可视化配置编辑器*：

> 设计时配置支持包括允许您使用企业库配置工具更改配置设置的类。这些类提供了不同配置设置的可视化表示（例如配置设置旁边显示的图像）、可以根据当前配置状态执行的操作以及验证配置设置的能力。

# javascript - 让用户在 webapp 中手动排序项目

> ID：346081
> 
> 赞同：1
> 
> 时间：2008-12-06T08:15:35.713
> 
> 标签：javascript, silverlight

我想制作一个简单的网络应用程序，向用户显示 20 张左右的图像，并让他们通过拖动或使用某种形式的向上/向下控件手动将图像从最喜欢到最不喜欢排序，然后提交此排序。是否有现有的工具，无论是 Javascript 还是 Silverlight，都可以让这变得简单吗？

顺便说一句，我正在考虑使用 Django 或 ASP.NET MVC。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T08:30:38.070

jQuery UI 有[sortables](http://dev.jquery.com/view/tags/ui/latest/demos/functional/#ui.sortable)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T08:21:25.747

我看到您使用 Silverlight 进行了标记，因此我假设您使用的是 ASP.NET 技术。您可以在 Ajax Control ToolKit 中使用 ReorderList 的一些变体：

[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ReorderList/ReorderList.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ReorderList/ReorderList.aspx)

我敢肯定那里还有数百个其他此类控件。

# mysql - Rails 上的 UTF8 MySQL 问题 - utf8_general_ci 的编码问题

> ID：346092
> 
> 赞同：19
> 
> 时间：2008-12-06T08:24:52.527
> 
> 标签：mysql, ruby-on-rails, unicode, encoding, utf-8

我有一个在 MySQL 5.0.32-Debian 上运行的暂存 Rails 站点。

在这个特定的站点上，我所有的表都使用`utf8 / utf8_general_ci`编码。

在该数据库中，我有一些看起来像这样的数据：

```
mysql> select * from currency_types limit 1,10;
+------+-----------------+---------+
| code | name            | symbol  |
+------+-----------------+---------+
| CAD  | Canadian Dollar | $       |
| CNY  | Chinese Yuan    | å…ƒ     |
| EUR  | Euro            | â‚¬     |
| GBP  | Pound           | Â£      |
| INR  | Indian Rupees   | â‚¨     |
| JPY  | Yen             | Â¥      |
| MXN  | Mexican Peso    | $       |
| USD  | US Dollar       | $       |
| PHP  | Philippine Peso | â‚±     |
| DKK  | Denmark Kroner  | kr      |
+------+-----------------+---------+ 
```

**这是我遇到的问题**

在登台（在 debian 盒子上运行 db 和 Rails 站点）时，从 Rails 显示时，符号的字符会正确显示。例如，人民币在我的浏览器中显示为元，而不是数据库中显示的 å...ƒ。

当我将该数据下载到本地 OS X 开发机器并在本地运行 db 和 Rails 时，我会在浏览器上看到来自 DB (å...ƒ) 内部的表示，而不是我在登台时看到的字符 元。

**调试我已经完成**

我已确保 Content-Type 的所有标头都以 utf8 形式从每个网络服务器（本地、暂存）返回。

我的本地 mysql 服务器和登台服务器都设置为使用 utf8 作为默认字符集。在我拨打任何电话之前，我正在使用“set names 'utf8'”。

我什至可以从我的 OS X Rails 主机连接到我的暂存数据库，我仍然可以看到代表人民币的字符 å...ƒ。那我猜，也许我的mysql本地客户端有问题，但我不知道是什么问题。

*也许这可能会提供线索*

更令人困惑的是，如果我将字符元粘贴到本地计算机上的数据库中，我会在网络浏览器中看到它很好。--- 然而，如果我将相同的字符粘贴到我的暂存数据库中，我会得到一个 ? 在我的暂存 Rails 站点的页面上标记它的位置。

此外，如果我在查询之前使用“set names 'latin1'”，那么在我的 OS X rails 机器上本地，所有字符都会正确返回。我之前确实将这些表设置为 latin1 - 这可能是问题吗？

有人请在这里帮助我，我要疯了，试图找出问题所在！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-06T09:01:47.507

啊哈！似乎我之前有一些用 latin1 编码的表信息，并且愚蠢地将数据库更改为 utf8 而不进行转换。

运行以下修复了 currency_types 表：

```
mysqldump -u root -p --opt --default-character-set=latin1 --skip-set-charset  DBNAME > DBNAME.sql

mysql -u root -p --default-character-set=utf8  DBNAME < DBNAME.sql 
```

现在我只需要确保在 latin1 > utf8 开关之后生成的其他内容不会因此而混乱:(

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-07T12:23:45.397

你`database.yml`在适当的部分下有这两行吗？

```
encoding: utf8
collation: utf8_general_ci 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T09:05:57.467

1.  问题可能出在您的 MySQL 客户端上，它不支持 UTF-8。
2.  您的本地 OSX ruby​​ 安装配置可能没有声明正确的配置。MySQL 数据库的“config/database.yml”中应该有“encoding:utf8”。对于 ruby​​ 环境，您应该在“config/environment.rb”中有“$KCODE = 'u'”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T09:36:22.303

另一种简单的方法是使用`SQL`Alter 语句设置编码类型。您可以使用以下 bash 脚本执行此操作。

```
for t in $(mysql --user=root --password=admin  --database=DBNAME -e "show tables";);do echo "Altering" $t;mysql --user=root --password=admin --database=DBNAME -e "ALTER TABLE $t CONVERT TO CHARACTER SET utf8 COLLATE utf8_unicode_ci;";done 
```

美化了

```
 for t in $(mysql --user=root --password=admin  --database=DBNAME -e "show tables";);
    do 
       echo "Altering" $t;
       mysql --user=root --password=admin --database=DBNAME -e "ALTER TABLE $t CONVERT TO CHARACTER SET utf8 COLLATE utf8_unicode_ci;";
    done 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-07T07:15:35.317

我的数据库已经默认设置为 utf8，但我遇到了同样的问题。

同样在添加以下常用元标记后，问题仍然存在：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

然后我创建了一个专用`connection.php`的来确保与 MySQL 的所有通信都设置为 charset utf8。注意`-`utf8中没有`mysqli_set_charset($bd, 'utf8')`！

这是我的`Connection.php`：

```
<?php
    $mysql_hostname = "localhost";
    $mysql_user = "username";
    $mysql_password = "password";
    $mysql_database = "dbname";
    $prefix = "";
    $bd = mysqli_connect($mysql_hostname, $mysql_user, $mysql_password) or die("Could not connect database");
    mysqli_select_db($bd, $mysql_database) or die("Could not select database");
    if(!mysqli_set_charset($bd, 'utf8'))  {
        exit() ;
    }
?> 
```

另一个php文件：

```
<?php
    //Include database connection details
    require_once('connection.php');

    //Enter code here...

    //Create query
    $qry = "SELECT * FROM subject";
    $result = mysqli_query($bd, $qry);
?>

//Other stuff 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-15T07:57:46.857

对于 Rails，将以下代码片段运行到 rails 控制台。它将为所有表生成一个 sql。然后登录mysql并从rails控制台执行复制的sql。它将改变所有表的编码。

```
schema = File.open('db/schema.rb', 'r').read
rows = schema.split("\n")

table_name = nil
rows.each do |row|
  if row =~ /create_table/
     table_name = row.match(/create_table "(.+)"/)[1]
     puts "ALTER TABLE `#{table_name}` CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci;"
  end
end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-27T13:58:35.430

您可以使用 Rails 方式生成迁移，以更改数据库上的排序规则类型：

```
rails generate migration ChangeDatabaseCollation 
```

然后您可以编辑生成的文件并粘贴：

```
def change
  # for each table that will store the new collation execute:
  execute "ALTER TABLE my_table CONVERT TO CHARACTER SET utf8 COLLATE utf8_general_ci"
end 
```

并运行迁移：

```
rake db:migrate 
```

您还可以对您的 database.yml 强制执行新的排序规则：

```
development:
  adapter: mysql2
  encoding: utf8
  collation: utf8_general_ci 
```

有关 Rails 迁移的更多信息：

[http://edgeguides.rubyonrails.org/active_record_migrations.html](http://edgeguides.rubyonrails.org/active_record_migrations.html)

有关排序规则类型的更多信息：

[http://collat​​ion-charts.org/](http://collation-charts.org/)

# refactoring - 如何以面向对象的方式编写消息队列处理？

> ID：346105
> 
> 赞同：0
> 
> 时间：2008-12-06T08:52:39.647
> 
> 标签：refactoring, messaging, oop

如果您必须编写从消息队列中获取消息并更新数据库中的表的代码，您将如何以一种好的方式来构建它。你会如何构建它？消息是 XML 数据，表中每行一个节点。表中的行可以被更新、删除或插入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T09:01:55.557

我不相信你提供了足够的信息来提供一个好的答案。消息是什么样的？它们的内容/类型是否不同，或者它们都只是“信息”？它们是相互交互的，还是只是数据格式的转换？OO 开发的关键之一是认识到“查找名词-n-动词”游戏（正如您所描述的那样）很少会导致最佳解决方案。它当然不会是最糟糕的，但你最终会得到数据聚合和一堆程序代码。

不过，程序代码还不错。为什么一定要OO？问题本身是否需要多态性和数据隐藏？您是否正在尝试建模任何复杂的行为？当问题很简单时，使用非 OO 解决方案并不丢人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T09:15:32.470

通常，使用消息队列的 OO 实现，您可以自己创建表示各个消息类型的类。就您期望获得的不同消息类型而言，它们是彼此派生的，这为您提供了消息的类层次结构。

使用基于配置的持久性框架，您可以直接为这些类设置存在性。

然后有一个或多个类侦听消息队列并仅保留消息，可能只有一个。它不必比这更详细。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T07:58:43.903

在进行消息传递或处理任何类型的中间件时，构建 OO 代码的最佳方式是从代码中隐藏中间件 API，只处理业务逻辑。

例如看这些例子

*   [POJO Consuming](http://activemq.apache.org/camel/pojo-consuming.html)这几乎是您描述的用例和
*   如果您需要将消息发送到消息队列，则[POJO 生产。](http://activemq.apache.org/camel/pojo-producing.html)

然后你只需要定义你的*数据传输对象*是什么样子的；你想如何以 XML / JSON / 任何方式对线路上的东西进行编码。

这种方法的好处是您的代码现在完全与中间件无关 - 您可以换出消息队列并使用[数据库或 JavaSpace 或内存中的 SEDA 或文件或任何其他通信协议或中间件 API](http://activemq.apache.org/camel/components.html)。

# batch-file - 从批处理文件创建 exe 的快捷方式

> ID：346107
> 
> 赞同：24
> 
> 时间：2008-12-06T08:59:56.170
> 
> 标签：batch-file

如何从批处理文件创建 exe 的快捷方式。

我试过

```
call link.bat "c:\program Files\App1\program1.exe" "C:\Documents and Settings\%USERNAME%\Desktop" "C:\Documents and Settings\%USERNAME%\Start Menu\Programs" "Program1 shortcut" 
```

但它没有奏效。

link.bat 可以在 [http://www.robvanderwoude.com/amb_shortcuts.html找到](http://www.robvanderwoude.com/amb_shortcuts.html)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-06T09:32:52.310

您的链接指向 Windows 95/98 版本，我猜您至少有 Windows 2000 或 XP。[你应该在这里](http://www.robvanderwoude.com/amb_shortcutsnt.html)试试 NT 版本。

或者使用可以从命令行调用的小 VBScript：

```
set objWSHShell = CreateObject("WScript.Shell")
set objFso = CreateObject("Scripting.FileSystemObject")

' command line arguments
' TODO: error checking
sShortcut = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(0))
sTargetPath = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(1))
sWorkingDirectory = objFso.GetAbsolutePathName(sShortcut)

set objSC = objWSHShell.CreateShortcut(sShortcut) 

objSC.TargetPath = sTargetPath
objSC.WorkingDirectory = sWorkingDirectory

objSC.Save 
```

将文件另存为 createLink.vbs 并像这样调用它以获得您最初尝试的内容：

```
cscript createLink.vbs "C:\Documents and Settings\%USERNAME%\Desktop\Program1 shortcut.lnk" "c:\program Files\App1\program1.exe" 
cscript createLink.vbs "C:\Documents and Settings\%USERNAME%\Start Menu\Programs\Program1 shortcut.lnk" "c:\program Files\App1\program1.exe" 
```

也就是说，我敦促您不要使用像“开始菜单”这样的硬编码路径，因为它们在本地化版本的 Windows 中是不同的。修改脚本改为使用[特殊文件夹](http://gallery.technet.microsoft.com/ScriptCenter/en-us/0b3c068c-c765-4880-bc68-effb2d0e543e)。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-12T17:43:54.820

**这是PowerShell**真正擅长的事情，因此是避开批处理文件并加入 PowerShell 潮流的一个原因。

**PowerShell 可以与 .NET 对话**。例如，您可以像这样获取桌面的位置：

```
[Environment]::GetFolderPath("Desktop") 
```

**PowerShell 可以与 COM**对象对话，包括`WScript.Shell`可以创建快捷方式的 COM 对象：

```
New-Object -ComObject WScript.Shell).CreateShortcut( ... ) 
```

所以你的脚本可能看起来像：

```
$linkPath = Join-Path ([Environment]::GetFolderPath("Desktop")) "MyShortcut.lnk"
$targetPath = Join-Path ([Environment]::GetFolderPath("ProgramFiles")) "MyCompany\MyProgram.exe"
$link = (New-Object -ComObject WScript.Shell).CreateShortcut( $linkpath )
$link.TargetPath = $targetPath
$link.Save() 
```

快捷方式有很多 WScript.Shell 无法操作的设置，例如“以管理员身份运行”选项。这些只能通过 Win32 界面访问`IShellLinkDataList`，使用起来确实很痛苦，但可以做到。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-06T09:32:08.460

使用 vbscript：

```
set WshShell = WScript.CreateObject("WScript.Shell" )
strDesktop = WshShell.SpecialFolders("AllUsersDesktop" )
set oShellLink = WshShell.CreateShortcut(strDesktop & "\shortcut name.lnk" )
oShellLink.TargetPath = "c:\application folder\application.exe"
oShellLink.WindowStyle = 1
oShellLink.IconLocation = "c:\application folder\application.ico"
oShellLink.Description = "Shortcut Script"
oShellLink.WorkingDirectory = "c:\application folder"
oShellLink.Save 
```

参考：[http ://www.tomshardware.com/forum/52871-45-creating-desktop-shortcuts-command-line](http://www.tomshardware.com/forum/52871-45-creating-desktop-shortcuts-command-line)

如果做不到这一点，快速谷歌搜索显示有许多第三方工具可以为应用程序快捷方式创建 .lnk 文件。我假设您需要坚持使用 Windows 原生可用的东西？VBscript 可能是您最好的选择，否则我建议您尝试从您的机器复制 .lnk 文件或将其用作示例以查看快捷方式文件的正确格式。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-17T11:38:42.857

在 XP 上我写了 makeshortcut.vbs

```
Set oWS = WScript.CreateObject("WScript.Shell")
If wscript.arguments.count < 4 then
  WScript.Echo "usage: makeshortcut.vbs shortcutPath targetPath arguments workingDir "
  WScript.Quit
end If
shortcutPath = wscript.arguments(0) & ".LNK"
targetPath = wscript.arguments(1)
arguments = wscript.arguments(2)
workingDir = wscript.arguments(3)

WScript.Echo "Creating shortcut " & shortcutPath & " targetPath=" & targetPath & " arguments=" & arguments & " workingDir=" & workingDir

Set oLink = oWS.CreateShortcut(shortcutPath) 
oLink.TargetPath = targetPath
oLink.Arguments = arguments
' oLink.Description = "MyProgram"
' oLink.HotKey = "ALT+CTRL+F"
' oLink.IconLocation = "C:\Program Files\MyApp\MyProgram.EXE, 2"
' oLink.WindowStyle = "1"
oLink.WorkingDirectory = workingDir
oLink.Save 
```

它恰好需要 4 个 args，因此可以通过使后面的 2 个可选来改进它。我只发布因为它回显了它的用法，这可能对某些人有用。我喜欢 WS 使用特殊文件夹和 ExpandEnvironmentStrings 的解决方案

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T09:13:17.140

替代方法，使用第三方实用程序：

[从命令行创建快捷方式（批处理文件）](http://www.xxcopy.com/xxcopy38.htm)

> XXMKLINK：
> 
> 使用 XXMKLINK，您可以编写一个由专门的安装程序完成的软件安装批处理文件。基本上，XXMKLINK 是一个从命令行收集各种信息并将其打包成快捷方式的工具。

```
xxmklink spath opath 

where 

  spath     path of the shortcut (.lnk added as needed)
  opath     path of the object represented by the shortcut 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T09:34:29.687

附加说明：您使用的 link.bat 仅适用于 Windows 95/98：

> *此批处理文件仅适用于 Windows 95/98。我将很快在 NT 新闻组中发布 NT 等价物。*

NT 版本改为发布在[http://www.robvanderwoude.com/amb_shortcutsnt.html 。](http://www.robvanderwoude.com/amb_shortcutsnt.html)如果比 vbscript 更喜欢，您可以尝试使用 .bat 方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-06-21T14:50:10.533

您可以检查[shortcutjs.bat](https://github.com/npocmaka/batch.scripts/blob/master/hybrids/jscript/shortcutJS.bat)：

```
::creates a shortcut that will start the target with minimized window and admin permissions
shortcutjs.bat -linkfile myscriptMin.lnk -target "%cd%\myscript.bat" -windowstyle 7 -adminpermissions yes

::creates a shortcut with a hot keys
shortcutjs.bat -linkfile myscriptHK.lnk -target "%cd%\myscript.bat" -hotkey "ALT+CTRL+P" 
```

有了这个，您还可以编辑现有的快捷方式或仅显示其属性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-03-16T20:55:01.467

这在 Windows XP ms-dos 上对我有用，我还没有在 Windows 7 上尝试过。这就像在 Linux 中创建符号链接一样。

```
shortcut -T source.exe destination.lnk 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-06T09:15:44.010

最后我决定编写正确的脚本，因为没有解决方案适合我你首先需要两个 fileLocal Settings\

> 创建SCUT.bat

```
@echo on
set VBS=createSCUT.vbs 
set SRC_LNK="shortcut1.lnk"
set ARG1_APPLCT="C:\Program Files\Google\Chrome\Application\chrome.exe"
set ARG2_APPARG="--profile-directory=QuteQProfile 25QuteQ"
set ARG3_WRKDRC="C:\Program Files\Google\Chrome\Application"
set ARG4_ICOLCT="%USERPROFILE%\Local Settings\Application Data\Google\Chrome\User Data\Profile 25\Google Profile.ico"
cscript %VBS% %SRC_LNK% %ARG1_APPLCT% %ARG2_APPARG% %ARG3_WRKDRC% %ARG4_ICOLCT% 
```

第二个

> 创建SCUT.vbs

```
Set objWSHShell = WScript.CreateObject("WScript.Shell")
set objWSHShell = CreateObject("WScript.Shell")
set objFso = CreateObject("Scripting.FileSystemObject")
If WScript.arguments.count = 5 then
    WScript.Echo "usage: makeshortcut.vbs shortcutPath targetPath arguments workingDir IconLocation"
    sShortcut = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(0))
    set objSC = objWSHShell.CreateShortcut(sShortcut) 
    sTargetPath = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(1))
    sArguments = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(2))
    sWorkingDirectory = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(3))
    sIconLocation = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(4))
    objSC.TargetPath = sTargetPath
    rem http://www.bigresource.com/VB-simple-replace-function-5bAN30qRDU.html#
    objSC.Arguments = Replace(sArguments, "QuteQ", Chr(34))
    rem http://msdn.microsoft.com/en-us/library/f63200h0(v=vs.90).aspx http://msdn.microsoft.com/en-us/library/267k4fw5(v=vs.90).aspx
    objSC.WorkingDirectory = sWorkingDirectory
    objSC.Description = "Love Peace Bliss"
    rem 1 restore 3 max 7 min
    objSC.WindowStyle = "3"
    rem objSC.Hotkey = "Ctrl+Alt+e";
    objSC.IconLocation = sIconLocation
    objSC.Save
    WScript.Quit
end If
If WScript.arguments.count = 4 then
    WScript.Echo "usage: makeshortcut.vbs shortcutPath targetPath arguments workingDir "

    sShortcut = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(0))
    set objSC = objWSHShell.CreateShortcut(sShortcut) 
    sTargetPath = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(1))
    sArguments = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(2))
    sWorkingDirectory = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(3))
    objSC.TargetPath = sTargetPath
    objSC.Arguments = Replace(sArguments, "QuteQ", Chr(34))
    objSC.WorkingDirectory = sWorkingDirectory
    objSC.Description = "Love Peace Bliss"
    objSC.WindowStyle = "3"
    objSC.Save
    WScript.Quit
end If
If WScript.arguments.count = 2 then
    WScript.Echo "usage: makeshortcut.vbs shortcutPath targetPath"
    sShortcut = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(0))
    set objSC = objWSHShell.CreateShortcut(sShortcut) 
    sTargetPath = objWSHShell.ExpandEnvironmentStrings(WScript.Arguments.Item(1))
    sWorkingDirectory = objFso.GetAbsolutePathName(sShortcut)
    objSC.TargetPath = sTargetPath
    objSC.WorkingDirectory = sWorkingDirectory
    objSC.Save
    WScript.Quit
end If 
```

# c# - 是否可以序列化 C# 代码块？

> ID：346111
> 
> 赞同：23
> 
> 时间：2008-12-06T09:03:10.577
> 
> 标签：c#, serialization

我将 C# 与[.NET](http://en.wikipedia.org/wiki/.NET_Framework) 3.5 一起使用。是否可以序列化一段代码，将其传输到某处，反序列化，然后执行它？

一个示例用法是：

```
Action<object> pauxPublish = delegate(object o)
{
    if (!(o is string))
    {
        return;
    }
    Console.WriteLine(o.ToString());
};
Transmitter.Send(pauxPublish); 
```

使用一些远程程序：

```
var action = Transmitter.Recieve();
action("hello world"); 
```

我的最终目标是能够在不同的进程中执行任意代码（该进程没有代码的先验知识）。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-06T13:54:24.793

**是的！！！**

我们这样做是为了一个非常真实的性能案例。由于性能原因，在运行时执行此操作或使用 DSL 不是一种选择。

我们将代码编译成程序集，并从方法中删除 IL。然后，我们获取与此方法相关的所有元数据，并通过 XML 序列化整个混乱，压缩它，并将其放入我们的数据库中。

在重新水化时，我们使用**DynamicMethod**类使用元数据重新构建 IL，并执行它。

我们这样做是因为速度。我们有成千上万的小代码块。不幸的是，编译一段代码并在运行中运行它至少需要 250 毫秒，这对我们来说太慢了。我们采用了这种方法，并且效果非常好。在运行时，重构方法并运行它需要大量的时间。

唯一需要注意的是... 签名程序集和未签名程序集不能混合序列化的方法数据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-06T10:33:15.480

您可以尝试在您的项目中使用[IronPython 。](http://en.wikipedia.org/wiki/IronPython)在 Python 中做你所要求的事情是微不足道[的。](http://www.python.org/doc/2.5.2/ref/exec.html)Python 代码可以调用您的 C# 方法。至于安全性，您可以在某种受限环境中执行代码（一个例子是[RestrictedPython](http://pypi.python.org/pypi/RestrictedPython/)）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-06T10:06:22.680

一般来说，这听起来是一个非常糟糕的主意和一个很大的安全漏洞。

您不希望另一个进程执行任何代码。了解你真正需要另一个流程来做什么，并围绕它构建一个小的 DSL。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T09:23:05.980

您也可以将其作为字符串发送，然后使用 CodeDomProvider 编译它，结果相同。我有一个示例代码，因此：

```
using System;
using System.CodeDom.Compiler;
using System.Collections.Generic;
using System.Collections.Specialized;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using Microsoft.CSharp;

namespace DynamicCodeApplication
{
    class azCodeCompiler
    {
        private List<string> assemblies;

        public azCodeCompiler()
        {
            assemblies = new List<string>();
            scanAndCacheAssemblies();
        }

        public Assembly BuildAssembly(string code)
        {

            CodeDomProvider prov = CodeDomProvider.CreateProvider("CSharp");
            string[] references = new string[] { };   // Intentionally empty, using csc.rsp
            CompilerParameters cp = new CompilerParameters(references)
                                        {
                                            GenerateExecutable = false,
                                            GenerateInMemory = true
                                        };
            string path = System.Runtime.InteropServices.RuntimeEnvironment.GetRuntimeDirectory();
            cp.CompilerOptions = "@" + path + @"\csc.rsp";
            CompilerResults cr = prov.CompileAssemblyFromSource(cp, code);

            foreach (CompilerError err in cr.Errors)
            {
                Console.WriteLine(err.ToString());
            }
            return cr.CompiledAssembly;
        }

        public object ExecuteCode(string code,
                                  string namespacename, string classname,
                                  string functionname, bool isstatic, params object[] args)
        {
            object returnval = null;
            Assembly asm = BuildAssembly(code);
            object instance = null;
            Type type = null;
            if (isstatic)
            {
                type = asm.GetType(namespacename + "." + classname);
            }
            else
            {
                instance = asm.CreateInstance(namespacename + "." + classname);
                type = instance.GetType();
            }
            MethodInfo method = type.GetMethod(functionname);
            returnval = method.Invoke(instance, args);
            return returnval;
        }

        private void scanAndCacheAssemblies()
        {

            /*
            foreach (string str in Directory.GetFiles(@"C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727"))
            {
                if (str.Contains(".dll"))
                {
                    foreach (string st in str.Split(new char[] { '\\' }))
                    {
                        if (st.Contains(".dll"))
                        {
                            assemblies.Add(st);
                        }
                    }
                }
            }
             * */

            assemblies.Add("Accessibility.dll");
            assemblies.Add("AspNetMMCExt.dll");
            assemblies.Add("cscompmgd.dll");
            assemblies.Add("CustomMarshalers.dll");
            assemblies.Add("IEExecRemote.dll");
            assemblies.Add("IEHost.dll");
            assemblies.Add("IIEHost.dll");
            assemblies.Add("Microsoft.Build.Conversion.dll");
            assemblies.Add("Microsoft.Build.Engine.dll");
            assemblies.Add("Microsoft.Build.Framework.dll");
            assemblies.Add("Microsoft.Build.Tasks.dll");
            assemblies.Add("Microsoft.Build.Utilities.dll");
            assemblies.Add("Microsoft.Build.VisualJSharp.dll");
            assemblies.Add("Microsoft.CompactFramework.Build.Tasks.dll");
            assemblies.Add("Microsoft.JScript.dll");
            assemblies.Add("Microsoft.VisualBasic.Compatibility.Data.dll");
            assemblies.Add("Microsoft.VisualBasic.Compatibility.dll");
            assemblies.Add("Microsoft.VisualBasic.dll");
            assemblies.Add("Microsoft.VisualBasic.Vsa.dll");
            assemblies.Add("Microsoft.Vsa.dll");
            assemblies.Add("Microsoft.Vsa.Vb.CodeDOMProcessor.dll");
            assemblies.Add("Microsoft_VsaVb.dll");
            assemblies.Add("mscorlib.dll");
            assemblies.Add("sysglobl.dll");
            assemblies.Add("System.configuration.dll");
            assemblies.Add("System.Configuration.Install.dll");
            assemblies.Add("System.Data.dll");
            assemblies.Add("System.Data.OracleClient.dll");
            assemblies.Add("System.Data.SqlXml.dll");
            assemblies.Add("System.Deployment.dll");
            assemblies.Add("System.Design.dll");
            assemblies.Add("System.DirectoryServices.dll");
            assemblies.Add("System.DirectoryServices.Protocols.dll");
            assemblies.Add("System.dll");
            assemblies.Add("System.Drawing.Design.dll");
            assemblies.Add("System.Drawing.dll");
            assemblies.Add("System.EnterpriseServices.dll");
            assemblies.Add("System.Management.dll");
            assemblies.Add("System.Messaging.dll");
            assemblies.Add("System.Runtime.Remoting.dll");
            assemblies.Add("System.Runtime.Serialization.Formatters.Soap.dll");
            assemblies.Add("System.Security.dll");
            assemblies.Add("System.ServiceProcess.dll");
            assemblies.Add("System.Transactions.dll");
            assemblies.Add("System.Web.dll");
            assemblies.Add("System.Web.Mobile.dll");
            assemblies.Add("System.Web.RegularExpressions.dll");
            assemblies.Add("System.Web.Services.dll");
            assemblies.Add("System.Windows.Forms.dll");
            assemblies.Add("System.XML.dll");
            assemblies.Add("vjscor.dll");
            assemblies.Add("vjsjbc.dll");
            assemblies.Add("vjslib.dll");
            assemblies.Add("vjslibcw.dll");
            assemblies.Add("vjssupuilib.dll");
            assemblies.Add("vjsvwaux.dll");
            assemblies.Add("vjswfc.dll");
            assemblies.Add("VJSWfcBrowserStubLib.dll");
            assemblies.Add("vjswfccw.dll");
            assemblies.Add("vjswfchtml.dll");
            assemblies.Add("Accessibility.dll");
            assemblies.Add("AspNetMMCExt.dll");
            assemblies.Add("cscompmgd.dll");
            assemblies.Add("CustomMarshalers.dll");
            assemblies.Add("IEExecRemote.dll");
            assemblies.Add("IEHost.dll");
            assemblies.Add("IIEHost.dll");
            assemblies.Add("Microsoft.Build.Conversion.dll");
            assemblies.Add("Microsoft.Build.Engine.dll");
            assemblies.Add("Microsoft.Build.Framework.dll");
            assemblies.Add("Microsoft.Build.Tasks.dll");
            assemblies.Add("Microsoft.Build.Utilities.dll");
            assemblies.Add("Microsoft.Build.VisualJSharp.dll");
            assemblies.Add("Microsoft.CompactFramework.Build.Tasks.dll");
            assemblies.Add("Microsoft.JScript.dll");
            assemblies.Add("Microsoft.VisualBasic.Compatibility.Data.dll");
            assemblies.Add("Microsoft.VisualBasic.Compatibility.dll");
            assemblies.Add("Microsoft.VisualBasic.dll");
            assemblies.Add("Microsoft.VisualBasic.Vsa.dll");
            assemblies.Add("Microsoft.Vsa.dll");
            assemblies.Add("Microsoft.Vsa.Vb.CodeDOMProcessor.dll");
            assemblies.Add("Microsoft_VsaVb.dll");
            assemblies.Add("mscorlib.dll");
            assemblies.Add("sysglobl.dll");
            assemblies.Add("System.configuration.dll");
            assemblies.Add("System.Configuration.Install.dll");
            assemblies.Add("System.Data.dll");
            assemblies.Add("System.Data.OracleClient.dll");
            assemblies.Add("System.Data.SqlXml.dll");
            assemblies.Add("System.Deployment.dll");
            assemblies.Add("System.Design.dll");
            assemblies.Add("System.DirectoryServices.dll");
            assemblies.Add("System.DirectoryServices.Protocols.dll");
            assemblies.Add("System.dll");
            assemblies.Add("System.Drawing.Design.dll");
            assemblies.Add("System.Drawing.dll");
            assemblies.Add("System.EnterpriseServices.dll");
            assemblies.Add("System.Management.dll");
            assemblies.Add("System.Messaging.dll");
            assemblies.Add("System.Runtime.Remoting.dll");
            assemblies.Add("System.Runtime.Serialization.Formatters.Soap.dll");
            assemblies.Add("System.Security.dll");
            assemblies.Add("System.ServiceProcess.dll");
            assemblies.Add("System.Transactions.dll");
            assemblies.Add("System.Web.dll");
            assemblies.Add("System.Web.Mobile.dll");
            assemblies.Add("System.Web.RegularExpressions.dll");
            assemblies.Add("System.Web.Services.dll");
            assemblies.Add("System.Windows.Forms.dll");
            assemblies.Add("System.XML.dll");
            assemblies.Add("vjscor.dll");
            assemblies.Add("vjsjbc.dll");
            assemblies.Add("vjslib.dll");
            assemblies.Add("vjslibcw.dll");
            assemblies.Add("vjssupuilib.dll");
            assemblies.Add("vjsvwaux.dll");
            assemblies.Add("vjswfc.dll");
            assemblies.Add("VJSWfcBrowserStubLib.dll");
            assemblies.Add("vjswfccw.dll");
            assemblies.Add("vjswfchtml.dll");

            return;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T09:19:07.860

将其编译为单独的程序集，发送程序集，让其他进程加载它。

您可能需要考虑安全隐患。

**更新：**另一个想法是生成一个表达式树并使用这个库来序列化它：

[http://www.codeplex.com/metalinq/](http://www.codeplex.com/metalinq/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T13:37:34.640

这是一个有趣的挑战，但您可能应该描述为什么要这样做，因为根据您的目标有很多不同的方法。正如hunpohl 指出的，还有一些相当严重的安全问题。

“序列化代码”可以只是源代码或已编译的程序集，具体取决于您的要求。您可能不需要使用单独的代码序列化格式。

如果您想动态生成代码并将其传递，您可以使用 CodeDOM 生成代码并编译它。但是，您很可能不需要生成完全任意的代码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-06T09:26:11.607

另一种选择是使用[DLR](http://en.wikipedia.org/wiki/Dynamic_Language_Runtime)，并约束代码执行......

# c# - 在 C# 中填充组合框的最快方法是什么？

> ID：346112
> 
> 赞同：-3
> 
> 时间：2008-12-06T09:03:27.707
> 
> 标签：c#, compact-framework, combobox, sql-server-ce

在 C# 中填充 ComboBox 的最快方法是什么？

1.  和`Add()`
2.  将 ComboBox 绑定到数据集

还是有更快的方法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T15:36:17.367

您可能会发现执行此操作的最快方法是从数据读取器读取数据库，然后在循环中调用 .Add()，但使用数据读取器的数字索引字段（而不是命名属性）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T14:48:40.707

您最快的方法可能是绑定到[DataReader](http://msdn.microsoft.com/en-us/library/haa3afyz.aspx)或迭代 DataReader 并使用`Add()`ComboBox 的方法。无论哪种方式，关键不在于您是在绑定还是在迭代（我没有对这些进行检测，因此无法告诉您哪个更快），关键是使用 DataReader。

通过使用 DataSet，您正在加载和填充相当繁重的数据对象。如果您注意到速度问题，这可能是罪魁祸首。只是切换到 DataReader（无论是使用`Add()`还是绑定）可能会让你得到提升。

当然，所有这一切都是假设您首先看到了速度问题。如果您不是，并且没有人抱怨您的应用程序的速度，并且您的应用程序没有预计会导致问题的增长，那么*请继续您当前的路径！* [“过早的优化是万恶之源。”](http://en.wikipedia.org/wiki/Donald_Knuth)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T09:47:27.070

好吧，除了一项之外，使用数据绑定的代码要少得多：

myComboBox.DataSource = myDataSet; myComboBox.DataBind();

当然，这假设您的 DataSet 已经包含数据。也许你可以改进你的问题？

# wpf - WPF - 如何将图像插入到网格元素的第二列

> ID：346116
> 
> 赞同：0
> 
> 时间：2008-12-06T09:10:12.170
> 
> 标签：wpf

正如主题所说，我想将图像插入到用 2 个列定义定义的网格的第二列中。

以编程方式是？？？

我看不到如何使用 grid.Children.insert(1, img) 来选择列。

马尔科姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T10:27:37.457

```
Image imgControl = new Image();
Grid.SetColumn(imgControl, 1);
gridContainer.Children.Add(imgControl); 
```

网格中包含的对象基于附加的依赖属性 Column Row ColumnSpan 和 RowSpan 进行定位，这些属性如上所示设置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T10:27:14.777

WPF 中元素的行/列索引是附加属性。您在 Grid 上使用静态方法设置它，如下所示：

```
Grid.SetColumn(img, 1); 
```

更多信息[在这里](http://msdn.microsoft.com/en-us/library/system.windows.controls.grid.setcolumn.aspx)，更多关于附加属性[在这里](http://msdn.microsoft.com/en-us/library/ms749011.aspx)。

# oop - 使用其对象（实例）访问类的私有成员变量

> ID：346127
> 
> 赞同：1
> 
> 时间：2008-12-06T09:24:47.850
> 
> 标签：oop, access-specifier

这是一个 VB.NET 代码片段

```
Public Class OOPDemo

    Private _strtString as String

    Public Function Func(obj as OOPDemo) as boolean
      obj._strString = "I can set value to private member using a object"

    End Function

End Class 
```

我认为我们不能使用对象访问私有成员，但也许 CLR 允许我们这样做。这意味着访问修饰符基于类型而不是该类型的实例。我还听说c ++也允许这样做..

任何猜测可能是什么原因？

编辑：

我认为 RoBorg 给出的 msdn 链接中的这一行解释了这种行为“声明私有元素的类型中的代码，包括包含类型中的代码，可以访问该元素”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T09:34:20.467

您的问题很令人困惑，但我认为我已经将其理解为：“为什么我可以访问另一个实例（我的类）的私有变量？”

你是对的 - 在我使用过的所有 OOP 语言中，你可以从其他实例访问私有变量，正是因为访问权限基于代码所在的位置，而不是它“属于”哪个对象实例。

否则可能很难实现复制构造函数或相等运算符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T09:41:07.990

这是[MSDN 中有关访问级别](http://msdn.microsoft.com/en-us/library/76453kax.aspx)的部分。

# python - Postgres - 如何返回缺失数据计数为 0 的行？

> ID：346132
> 
> 赞同：22
> 
> 时间：2008-12-06T09:32:04.137
> 
> 标签：python, database, postgresql, left-join, generate-series

几年（2003-2008）我的数据分布不均（日期）。我想查询一组给定的开始和结束日期的数据，按 PostgreSQL 8.3 中任何支持的时间间隔（日、周、月、季度、年）对数据进行分组（[http://www.postgresql.org/docs /8.3/static/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC](http://www.postgresql.org/docs/8.3/static/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC)）。

问题是一些查询在所需的时间内给出连续的结果，如下所示：

```
select to_char(date_trunc('month',date), 'YYYY-MM-DD'),count(distinct post_id) 
from some_table where category_id=1 and entity_id = 77  and entity2_id = 115 
and date <= '2008-12-06' and date >= '2007-12-01' group by 
date_trunc('month',date) order by date_trunc('month',date);
          to_char   | count 
        ------------+-------
         2007-12-01 |    64
         2008-01-01 |    31
         2008-02-01 |    14
         2008-03-01 |    21
         2008-04-01 |    28
         2008-05-01 |    44
         2008-06-01 |   100
         2008-07-01 |    72
         2008-08-01 |    91
         2008-09-01 |    92
         2008-10-01 |    79
         2008-11-01 |    65
        (12 rows) 
```

但其中一些错过了一些间隔，因为没有数据存在，就像这个：

```
select to_char(date_trunc('month',date), 'YYYY-MM-DD'),count(distinct post_id) 
from some_table where category_id=1 and entity_id = 75  and entity2_id = 115 
and date <= '2008-12-06' and date >= '2007-12-01' group by 
date_trunc('month',date) order by date_trunc('month',date);

        to_char   | count 
    ------------+-------

     2007-12-01 |     2
     2008-01-01 |     2
     2008-03-01 |     1
     2008-04-01 |     2
     2008-06-01 |     1
     2008-08-01 |     3
     2008-10-01 |     2
    (7 rows) 
```

所需的结果集是：

```
 to_char   | count 
------------+-------
 2007-12-01 |     2
 2008-01-01 |     2
 2008-02-01 |     0
 2008-03-01 |     1
 2008-04-01 |     2
 2008-05-01 |     0
 2008-06-01 |     1
 2008-07-01 |     0
 2008-08-01 |     3
 2008-09-01 |     0
 2008-10-01 |     2
 2008-11-01 |     0
(12 rows) 
```

缺少条目的计数为 0。

I have seen earlier discussions on Stack Overflow but they don't solve my problem it seems, since my grouping period is one of (day, week, month, quarter, year) and decided on runtime by the application. So an approach like left join with a calendar table or sequence table will not help I guess.

My current solution to this is to fill in these gaps in Python (in a Turbogears App) using the calendar module.

Is there a better way to do this.

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-03-31T18:44:22.283

^(This question is old. But since fellow users picked it as master for a new duplicate I am adding a proper answer.)

### Proper solution

```
SELECT *
FROM  (
   SELECT day::date
   FROM   generate_series(timestamp '2007-12-01'
                        , timestamp '2008-12-01'
                        , interval  '1 month') day
   ) d
LEFT   JOIN (
   SELECT date_trunc('month', date_col)::date AS day
        , count(*) AS some_count
   FROM   tbl
   WHERE  date_col >= date '2007-12-01'
   AND    date_col <= date '2008-12-06'
-- AND    ... more conditions
   GROUP  BY 1
   ) t USING (day)
ORDER  BY day; 
```

*   Use `LEFT JOIN`, of course.

*   [`generate_series()`](http://www.postgresql.org/docs/current/interactive/functions-srf.html) can produce a table of timestamps on the fly, and very fast.

*   It's generally faster to aggregate *before* you join. I recently provided a test case on sqlfiddle.com in this related answer:

    *   [PostgreSQL - order by an array](https://stackoverflow.com/questions/15664373/postgresql-order-by-an-array/15674585#15674585)
*   Cast the `timestamp` to `date` (`::date`) for a basic format. For more use [`to_char()`](http://www.postgresql.org/docs/current/interactive/functions-formatting.html).

*   `GROUP BY 1` is syntax shorthand to reference the first output column. Could be `GROUP BY day` as well, but that might conflict with an existing column of the same name. Or `GROUP BY date_trunc('month', date_col)::date` but that's too long for my taste.

*   Works with the available interval arguments for [`date_trunc()`](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC).

*   [`count()` never produces `NULL`](http://www.postgresql.org/docs/current/interactive/functions-aggregate.html) (`0` for no rows), but the `LEFT JOIN` does.
    To return `0` instead of `NULL` in the outer `SELECT`, use `COALESCE(some_count, 0) AS some_count`. [The manual.](https://www.postgresql.org/docs/current/static/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL)

*   For a **more generic solution or arbitrary time intervals** consider this closely related answer:

    *   [Best way to count records by arbitrary time intervals in Rails+Postgres](https://stackoverflow.com/questions/15576794/best-way-to-count-records-by-arbitrary-time-intervals-in-railspostgres/15577413#15577413)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-06T11:30:40.420

You can create the list of all first days of the last year (say) with

```
select distinct date_trunc('month', (current_date - offs)) as date 
from generate_series(0,365,28) as offs;
          date
------------------------
 2007-12-01 00:00:00+01
 2008-01-01 00:00:00+01
 2008-02-01 00:00:00+01
 2008-03-01 00:00:00+01
 2008-04-01 00:00:00+02
 2008-05-01 00:00:00+02
 2008-06-01 00:00:00+02
 2008-07-01 00:00:00+02
 2008-08-01 00:00:00+02
 2008-09-01 00:00:00+02
 2008-10-01 00:00:00+02
 2008-11-01 00:00:00+01
 2008-12-01 00:00:00+01 
```

Then you can join with that series.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T10:54:50.897

You could create a temporary table at runtime and left join on that. That seems to make the most sense.

# java - 为什么选择 Java 程序？

> ID：346137
> 
> 赞同：2
> 
> 时间：2008-12-06T09:35:00.247
> 
> 标签：java

我的经验很少。使用java，从现在开始我一直使用c++。是什么让这个更特别和更受欢迎？

此外，我想知道 System.in 类和 parseInt 类的使用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-06T12:53:33.483

Java 更容易使用，尤其是在开发大型程序时。

*   调试：Java 生成漂亮的 Stacktraces
*   稳定性：你可以捕捉到每一个异常
*   开发速度：您不需要链接器（在 C++ 中可能需要很多分钟）；使用现代 IDE（例如 eclipse），您可以在程序运行时就地编辑代码
*   垃圾收集和运行时类型安全消除了整类错误
*   非常好的免费（如啤酒）IDE

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-06T10:11:42.543

*理论上*（有时实际上）Java 程序也可以在多个平台上运行，“编写一次 - 调试，呃，到处运行”类型的东西。这使得它对各种项目非常有用。

以我个人的经验，在被引入 C++ 后不久学习 Java 时，Java 似乎更简单、更容易学习和理解，因此更高效，如前所述。虽然程序结构和语法非常相似，但无需担心指针和其他潜在危险的语言特性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T09:43:32.103

这真的非常广泛，我认为这些真的是 2 或 3 个不同的问题。我将非常简短地讨论第一个问题。Java 利用垃圾收集或自动内存管理。也就是说，可以说，它与像 C++ 这样的语言之间的最大区别。显然有一些提高生产力的潜力，因为您不必担心内存，尽管实际上您确实需要注意您的参考。也许您可以稍微完善一下您的问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T10:43:52.963

*   Java 在浏览器中工作！（例如[米尔帕）。](http://www.pulpgames.net/milpa/ "Milpa - 纸浆游戏")您也可以说 Flash，但是使用 Java，您可以利用它附带的众多类（与 C++ 相比的另一个优势，即使这两种语言在网上都有一套很好的免费库）和您对该语言的了解。
*   如前所述，从大型服务器到移动电话，许多平台都支持 Java，只需极少的调整、快速、高效的 VM。
*   OO 支持可以说设计得更好，避免了 C++ 中的错误。不知何故，C# 之于 Java 就像 Java 之于 C++ ^_^ （我不会争论，实际上我对 C# 的了解不够，这只是一个历史点）。
*   本着同样的精神，Java 更加抽象，避免了指针、手动内存管理和其他一些低级的东西。

这并不意味着一个比另一个更好，STL 可以帮助 C++ 解决上述一些问题，等等。

我不知道如何回答最后一句话，它们分别是对象和方法，而不是类。
我从来没有使用过 System.in，我想如果你用 < 或 | 提供 Java 程序它是可用的。在命令行上。parseInt 是[Integer](http://java.sun.com/javase/6/docs/api/java/lang/Integer.html "整数")类的静态方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-07T17:42:05.757

已经提到了语言特性（GC、反射等）。但还有另一个主要区别：库。我知道那里有 STL 和 Boost 以及各种各样的库，但它们并不是一个整体，它们都感觉不同。通常，您被迫使用各种 C-API（例如线程或套接字，仅提及两件事）。现在所有的 C++ 布道者都会加入并讲述某种很酷的 OO-socket 或 OO-threading 库，但它们不是 STL 的一部分。他们应该是。它几乎是 2009 年，一切都是网络化和多线程的。这应该是标准库的一部分。为什么使用这些 C-API 不好？因为很难在面向对象的程序中使用它们。尝试将 Win32 的 CreateThread() 与侦听器模式一起使用（C#-用户：阅读“委托”）。

对于性能不是什么大问题的“富客户端应用程序”，我总是使用 Java 或 C#。如果我需要原始速度（想想信号处理或嵌入式应用程序），我宁愿使用 C 而不是 C++。

顺便说一句：我已经使用了所有四种语言（C、C++、Java、C#）很长时间了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T13:19:45.770

使用 C++，您是在“在金属上”进行编程，而使用 Java，您是在向虚拟机编程。一直到 VM 的 Java 软件堆栈的构建都是为了提供高度抽象的编程体验。这在使用“只是”的数据类型（即程序员不需要了解它们如何转换为内存区域）、“正常工作”的垃圾收集（程序员不必处理分配和释放问题）以及普遍存在的错误处理和传播异常。指针不是 Java 的一部分，系统负责分配事物的位置和方式。

从这里，您可能会看到 Java 的设计理念与 C++ 非常不同：Java 试图强制程序员应该坚持某些被认为是安全的工作方式并使编程更容易。有些人讨厌 Java 的这一方面，有些人则喜欢它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-07T04:52:41.830

这真的取决于你想要做什么。

对于优化性能可能无关紧要的许多高级功能，Java 使用起来更容易、更可靠。例如，垃圾收集、数组检查等。当然，它也是沙盒的。

对我来说，Java 的另一个主要好处是使用反射和运行时类加载。我在可插拔架构中编写了很多插件，并且可以确保我可以将更多新类添加到任何平台上正在运行的程序中。上次我尝试在 C++ 中执行此操作时，我不得不处理 DLL 和 COM。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-06T09:50:51.870

如果您真的喜欢以面向对象的方式进行编程，那么您需要从 C++ 转到 Java。C++ 的问题之一是大多数程序员实际上将它用作 C 并且没有利用它的所有 OO 特性。Java在这里更严格。

# sql - 合并和连接两个不同编号的表。列和相同的列名

> ID：346138
> 
> 赞同：0
> 
> 时间：2008-12-06T09:35:09.250
> 
> 标签：sql, oracle, sqlplus, ora-00918

我试图将**fus_shift 表和根表**组合成一个新表，该表是**最终表**，但它输出类似于“**第 2 行的错误：ORA-01789：查询块的结果列数不正确**”。我也尝试加入表作为我的替代方案，但它也输出“**第 3 行的错误：ORA-00918：列不明确定义**”。有没有另一种方法来组合和连接两个具有不同列数并分别具有相同列名的表？再次感谢:-)

代码错误：
create table final as
select * from fus_shift
union
select * from root;

代码错误：
select record_num,test_num,t_date,t_time,system_type,category,comments,val
from fus_shiftrpt,root
where record_num=record_num;

我的桌子：

```
 fus_shift Table

           Record_Num       test          date      time         system   
           -----------------------------------------------------------
                1          test15      08-11-12  13:20:01    sys23 
                2          test17      08-11-03  14:24:00    sys24
                3          test13      08-11-13  17:25:04    sys45
                4          test15      08-11-14  18:24:00    sys67
                5          test16      08-11-15  19:24:06    sys45

                                 root Table

           Record_Num      category   comments    validated by
           ---------------------------------------------------
                  1        dirt        checked        admin
                  2        prog        checked        admin
                  3        dirt        checked        pe
                  4        wires       checked        ee
                  5        prog        repair         admin 
```

*强调文本*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T09:49:16.973

您当然不能将“联合”应用于您的表格。只有当两个查询都返回相同数量（并且类型相似）的列时，才能应用它。

您可以加入这两个表，但在加入时必须使用“表别名”，因为“record_num”字段在两个表中都很常见。这是适合您的查询

```
select 
        table1.record_num,
        table1.test_num,
        table1.t_date,
        table1.t_time,
        table1.system_type,
        table2.category,
        table2.comments,
        table2.val
from 
       fus_shift table1,root table2
where 
       table1.record_num = table2.record_num; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-07T13:04:11.527

我会使用以下方法：

```
SELECT * 
FROM fus_shift
INNER JOIN root ON root.record_num = fus_shift.record_num 
```

# delphi - 我不明白 TClientDataSets 的“无效字段类型”错误

> ID：346142
> 
> 赞同：2
> 
> 时间：2008-12-06T09:44:46.703
> 
> 标签：delphi, types, field, tclientdataset

我使用带有 TClientDataSets 的嵌套数据库结构。我是编程新手，所以我的术语是十对一的错误。

我的问题如下：我定义了我的数据库结构和嵌套结构的所有字段，然后我调用了主 clientDataSet 的 CreatDataSet 方法并且它起作用了。然后我想向主 ClientDataSet 添加另一个数据字段。然后我调用了主 ClientDataSet 的 ClearData 方法，然后尝试通过再次调用 CreateDataSet 来创建新结构。在这里我遇到了我的问题。我收到“无效的字段类型错误”，我真的不知道或不明白问题是什么。

那么如何在调用 createdata set 方法之后创建 exsta 字段，然后调用 cleardata 方法，然后添加一个字段，然后再次调用 createdataset 方法而不会出现“无效字段类型错误”？

有没有人有关于这个问题的任何信息。我使用德尔福 2007

善良的Rgards

里安·德维利尔斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T13:34:44.147

这是一个德尔福错误。

在调用 CreateDataSet 之前调用 YourDataset.FieldDefs.Clear ，它应该可以工作。

有关更多信息，请查看此 QC 报告：

[http://qc.codegear.com/wc/qcmain.aspx?d=38984](http://qc.codegear.com/wc/qcmain.aspx?d=38984)

**编辑：**

仔细阅读您的问题后，问题可能是其他问题，但请尝试使用 FieldDefs.Clear 并让我知道结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-31T01:26:32.153

你问这个问题已经很长时间了，但我相信这个问题与嵌套数据集字段特别有关。我以前见过这个错误，我相信它与创建特定字段的顺序有关。如果我没记错的话，如果您尝试在定义或创建嵌套数据集字段之前创建主数据集，则会收到此无效字段类型错误。

首先从方程式中删除嵌套的数据集字段，看看是否仍然遇到问题。如果没有，则将它们添加回来。尝试以不同的顺序创建主数据集及其嵌套数据集。

我知道这已经晚了，但我希望它有所帮助。

# qa - QA 工程师多钱或软件工程师少

> ID：346148
> 
> 赞同：8
> 
> 时间：2008-12-06T09:57:11.123
> 
> 标签：qa, currency

我可能有机会成为工程密集型 QA 团队（单元/场景测试自动化）的一员，以获得更多报酬。然而，目前我是一名软件工程师，这听起来对我来说更有声望。不过，更多的钱听起来也不错，但在什么时候值得呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-06T10:12:39.610

在我看来，声望无关紧要。我建议你对做你喜欢的工作而不是赚更多的钱做一个成本效益分析。

可能您并不介意质量检查，因为哪种情况需要额外的钱。如果您认为这很可怕，请不要这样做（除非有绝对的大量资金易手）。

我担任了大约 18 个月的 PM 以获得额外的报酬，并在大约 6 个月后讨厌它。

我现在回到了技术岗位，并且*非常*享受它。我现在不会做 PM 工作，除非他们把我的薪水加倍（即使那样，我也会三思而后行）。

我的建议是首先做你喜欢做的事情。人生只有一次机会，即使发了大财，100年后还是会死。我最喜欢的一句话是：“老鼠赛跑的麻烦在于，即使你赢了，你仍然是一只老鼠”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-03T07:20:55.823

你喜欢弄清楚如何破坏事物吗？你擅长这个吗？擅长 QA*和*擅长软件开发是一个很好的利基——能够像程序员一样思考让你的测试更全面，你的调试更高效，同时能够像测试员一样思考让你的代码更可靠。

关于声望：这份工作的薪水高于开发人员这一事实表明该公司重视质量保证，这是非常好的。此外，作为 QA 的程序员而不是您可能没有考虑过的直接软件开发人员，还有几个优势。一是QA工程师的*范围*往往比开发人员更广。与其把所有时间都花在一个狭窄的领域上，你可以更高一点，看看不同的组件是如何*组合在一起*的，以及小段代码是如何融入更大的图景的。另一个是 QA 工程师——在一家重视他们的公司里——有更多的*权力来解决问题*几乎比公司里的任何人都高。作为 QA 程序员，您编写代码来测试代码；这样做往往表明规格不明确。您经常会发现自己有效地定义了正确的行为应该是什么，因为正确行为的定义本质上*是通过您的测试代码的任何内容*。

因此，您有能力通过将破坏行为声明为“错误”来修复问题，您拥有广泛的范围，并且您有能力成为软件整体应该如何工作的真正专家，甚至比只深入了解其中一小部分的开发人员。它更像是一项“人”的工作——你可以与开发人员和项目经理密切合作，而不是在代码中埋头苦干……同时仍然是技术人员和生产技术产品。最后，与软件开发相比，工作压力往往较小。当可怕的错误出现时，您会发现它们，但可以通过实际*修复的工作*他们给别人。代码中的问题越多，你看起来就越好，并且感觉你正在取得进步，同时开发人员都在撕扯头发。

总之，对于 QA/Dev 角色和获得一些 QA 经验，有很多值得喜欢的地方。

如果您这样做，您可以称自己为测试软件开发人员或 QA 软件工具工程师，并认为自己在生产*测试件*——代码和文档，使代码变得更好——代替*软件*。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-08T20:55:02.037

那么，你到底想做什么？

我的妻子告诉我，当我做 QA 而不是软件开发时，她更喜欢我。我会更放松。

有优势。一个星期五的下午，我发现了一个可怕的错误，并在记录后立即回家，度过了一个非常愉快、轻松的周末。对于必须修理它的女人来说，情况并非如此。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-06T10:55:19.383

从事 QA 工作并不会阻止您成为一名软件工程师。或者，更准确地说，它不应该如此！如果它确实阻止了你成为一名软件工程师，那么就有严重的问题；编写好的单元测试需要好的软件工程技能。

不要沉迷于职称——我称之为“职称膨胀”的过程，这意味着个人提供或使用越来越浮夸的职称来从事以前名字不那么浮夸的相同工作。例如，如今“软件架构师”的工资是两便士，所以我不会在我的职称中使用这个词。此外，职位名称在不同公司之间的翻译并不可靠。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-06T11:25:38.213

我不认为做 QA 工程（编写测试或测试框架）比做开发更糟糕。当我年轻的时候，我认为 QA 更无聊。但从实践来看，并非如此。在编写真正的程序（产品）时，您通常需要更加小心编码约定、安全性、错误处理和文档。这会使非常简单的任务变得复杂而无聊。另一方面，如果您正在为 QA 编写代码，则可以忘记所有这些，然后对所有内容进行牛仔编码，因为这只是完成测试的脚手架。这可能非常令人耳目一新。

另外，如果你的工作很无聊，而且你是一名使用计算机的程序员，那么你做错了什么。把无聊的部分留给电脑，这就是重点！如果你不知道怎么做，现在就开始发明怎么做，突然间一切都会变得不那么无聊了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-06T12:06:37.977

我的 2 美分：

*   不要注意与工作相关的头衔。
*   看看它附带的工作。你想要吗？
*   问问自己：从事 QA 工作能否帮助您成为更好的软件工程师？
*   如果你喜欢你现在正在做的事情，那么在放弃它以获得更高的薪水之前要三思而后行。*是*的，钱很重要。但不如能够做你喜欢的事。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T10:35:30.640

我和 Pax 的情况一样，我的建议也一样：不要做任何你认为你不喜欢，或者更确切地说，喜欢做的事情。能够做自己喜欢做的​​事情的人是有特权的。不应轻易放弃该特权。

有时你需要做出牺牲。从长远来看，您可能需要额外的现金来为您带来更多快乐或舒适，而不是您通过接受“错误”工作而做出的牺牲，即。你得到你的豪华汽车，你的新房子的首付或梦想中的婚礼。

你需要仔细权衡利弊。通常，金钱的选择是不值得的。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-06T11:45:32.950

在决定这个机会时，您应该考虑的一些问题是：

*   你是否仅仅受到加薪的激励，加薪是否显着？
*   你能在新职位上看到任何有趣的挑战吗？
*   你会成为指导开发人员提高质量的大师，还是只是为他们进行重复测试的猴子？
*   逆转并回到原来的工作有多容易？有什么风险？
*   你害怕什么，这个决定会引导你进入还是远离它？

您还很年轻，而且您似乎在一家 C++ 商店工作。我猜您正在与比您年长和经验丰富的人一起工作。也许在 QA 工作一段时间会给你带来宝贵的经验。职业发展通常不是线性的。您会只是设置和运行测试，还是还会进行代码审查？

不要太在意声望。你还有很多生命。阿尔伯特·爱因斯坦 (Albert Einstein) 在担任专利文员时尽了他最大的努力。

此外，从长远来看，金钱并不是一个很好的动力。如果你目前的薪水不能维持生计，加薪会让生活更舒适，但无论如何你也不会成为一名雇员，变得肮脏富有。你需要对你所做的事情感到满意。

我的经验是，我们在决策过程中很早就无意识地做出了决定，然后将大部分精力花在了使选择合理化上。所以你可能已经知道你要做什么了。为什么让像我这样的老屁告诉你该怎么做？反正这是你的生活。

无论您选择什么方向，我真诚地祝您好运。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-06T10:00:53.737

我不认为你需要太担心你的指定。做你最喜欢做的事，享受工作，是的，钱有时很重要:-)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-08T20:30:48.293

我知道您现在可能已经做出了决定，但对于任何发现自己处于类似情况的人：

**考虑对你的职业生涯的长期影响**。您现在担任的职位会改变您的职业道路。

# .net - 调试器可视化器不工作？我注册错了吗？

> ID：346154
> 
> 赞同：2
> 
> 时间：2008-12-06T10:09:31.067
> 
> 标签：.net, visualizer, debuggervisualizer

我在 VS2008 中创建了一个调试器可视化工具。我在同一个 .dll 中创建了两个类：-

*   BinaryDataDebuggerVisualizer
*   ImageDebuggerVisualizer

图像一个工作正常（例如，放大镜出现在调试模式下）但不适用于 byte[] 一个（BinaryDataDV）。我的可视化工具所做的是将二进制数据显示为模式窗口中的图像（如果数据是合法图像）。我在发布模式下编译为代码，然后将 .dll 放入 C:\Users\\Documents\Visual Studio 2008\Visualizers

这是我用来“定义”视觉的代码...

使用

```
System;
using System.Diagnostics;
using System.Drawing;
using System.IO;
using System.Windows.Forms;
using Microsoft.VisualStudio.DebuggerVisualizers;
using Foo.DebuggerVisualizers;  

[assembly: DebuggerVisualizer(
    typeof (BinaryDataDebuggerVisualizer),
    typeof (VisualizerObjectSource),
    Target = typeof (byte[]),
    Description = "Binary Data to Image Visualizer")]

namespace Foo.DebuggerVisualizers
{
    public class BinaryDataDebuggerVisualizer : DialogDebuggerVisualizer
    {
        protected override void Show(IDialogVisualizerService windowService,
           IVisualizerObjectProvider objectProvider)
        {
            ... my code in here
        }
     }
} 
```

我在调试器可视化解决方案中进行了单元测试，它启动并测试代码..它正确地显示了一个合法（也是非法的）图像文件。所以我相信代码没问题。

当我在真正的解决方案中时，这就是我正在做的事情（当我在调试模式下将鼠标悬停在变量上时，我希望放大镜显示）。

```
byte[] data = File.ReadAllBytes("Chick.jpg"); 
```

`data`然后，当我在调试时暂停代码时，我将鼠标悬停在该变量上（使用断点）。

没有沙漏:(

任何人对什么是错的有任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-06T10:21:43.057

不幸的是，这是不可能的。Debugger Visualizer 框架中有一个限制，阻止它们在数组类型或对象上运行。

[http://msdn.microsoft.com/en-us/library/e2zc529c.aspx](http://msdn.microsoft.com/en-us/library/e2zc529c.aspx)

从页面引用：“您可以为除 Object 或 Array 之外的任何托管类的对象编写自定义可视化器”

# variables - 何时使用对象实例变量与将参数传递给方法

> ID：346169
> 
> 赞同：101
> 
> 时间：2008-12-06T10:30:08.123
> 
> 标签：variables, methods, parameter-passing, declaration

您如何决定将参数传递给方法还是简单地将它们声明为对所有对象方法可见的对象实例变量？

我更喜欢将实例变量保存在类末尾的列表中，但是随着程序的增长，这个列表会变得更长。我想如果一个变量被传递得足够频繁，它应该对所有需要它的方法都是可见的，但是我想知道，“如果一切都是公开的，那么根本不需要传递任何东西！”

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-12-06T10:45:27.220

由于您指的是实例变量，因此我假设您正在使用面向对象的语言。在某种程度上，何时使用实例变量、如何定义它们的范围以及何时使用局部变量是主观的，但在创建类时可以遵循一些经验法则。

*   **实例变量通常被认为是类的属性。**将这些视为将从您的类中创建的对象的形容词。如果您的实例数据可用于帮助描述对象，那么可以肯定的是，它是实例数据的不错选择。

*   **在方法范围内使用局部变量来帮助它们完成工作。**通常，一个方法应该具有获取一些数据、返回一些数据和/或处理/运行对一些数据的算法的目的。有时，将局部变量视为帮助方法从头到尾的方式会有所帮助。

*   **实例变量作用域不仅是为了安全，也是为了封装。**不要假设“目标应该是保持所有变量私有”。在继承的情况下，将变量设置为受保护通常是一个不错的选择。您无需将所有实例数据标记为公开，而是为需要访问外部世界的对象创建 getter/setter。不要让它们全部可用 - 只有你需要的那些。这将贯穿整个开发生命周期——从一开始就很难猜到。

当谈到在类中传递数据时，如果不看一些代码，就很难说你正在做的事情是好的做法。有时，直接对实例数据进行操作就可以了；其他时候，不是。在我看来，这是随着经验而来的——随着你的面向对象思维能力的提高，你会发展出一些直觉。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-12-06T10:39:51.193

这主要取决于您存储在变量中的数据的生命周期。如果数据仅在计算期间使用，则将其作为参数传递。如果数据绑定到对象的生命周期，则使用实例变量。

当您的变量列表变得太长时，考虑将类的某些部分重构为新类可能是一个好点。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-12-06T10:47:12.427

在我看来，实例变量仅在跨调用使用数据时才是必需的。

这是一个例子：

```
myCircle = myDrawing.drawCircle(center, radius); 
```

现在让成像 myDrawing 类使用 15 个辅助函数来创建 myCircle 对象，每个函数都需要中心和半径。它们仍然不应设置为 myDrawing 类的实例变量。因为他们再也不会被需要了。

另一方面，myCircle 类需要将中心和半径都存储为实例变量。

```
myCircle.move(newCenter);
myCircle.resize(newRadius); 
```

为了让 myCircle 对象在进行这些新调用时知道它的半径和中心是什么，它们需要存储为实例变量，而不仅仅是传递给需要它们的函数。

所以基本上，实例变量是一种保存对象“状态”的方法。如果变量不需要知道对象的状态，那么它不应该是实例变量。

至于公开一切。它可能会让你的生活更轻松。但它会回来困扰你。豌豆不要。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-06T10:40:35.637

恕我直言：

如果变量构成实例状态的一部分，那么它应该是一个实例变量——classinstance HAS-A instancevariable。

如果我发现自己反复将某些东西传递给实例的方法，或者我发现我有大量实例变量，我可能会尝试查看我的设计，以防我遗漏了某些东西或在某处做了糟糕的抽象。

希望能帮助到你

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-06T10:39:52.940

当然，在类中保留一个大的公共变量列表很容易。但即使凭直觉，您也可以看出这不是要走的路。

在您要使用它之前定义每个变量。如果变量支持特定方法的功能，请仅在该方法的范围内使用它。

还要考虑安全性，公共类变量容易受到来自“外部”代码的不必要更改的影响。您的主要目标应该是使所有变量保持私有，并且任何不是的变量都应该有充分的理由这样做。

关于在堆栈中一直传递参数，这会很快变得丑陋。一个经验法则是保持你的方法签名干净和优雅。如果您看到许多方法使用相同的数据，请确定它是否足够重要以成为类成员，如果不是，请重构您的代码以使其更有意义。

它归结为常识。仔细想想你在哪里以及为什么要声明每个新变量，它的功能应该是什么，并从那里决定它应该在哪个范围内。

# msbuild - 在 msbuild 中使用 32 位“程序文件”目录

> ID：346175
> 
> 赞同：42
> 
> 时间：2008-12-06T10:38:15.220
> 
> 标签：msbuild, x86, 64-bit, x86-64, program-files

在 64 位版本的 windows 中，32 位软件安装在“c:\program files (x86)”中。这意味着您不能使用 $(programfiles) 来获取（32 位）软件的路径。所以我需要一个 $(ProgramFiles32) 在我的 MSBuild 项目中克服这个问题。我不想根据正在运行的操作系统更改项目。

我有一个我会发布的解决方案，但也许有一个更简单/更好的方法。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2011-04-13T14:20:11.830

在 MSBuild 4.0+ 中，它有[一个`$(MSBuildProgramFiles32)`属性](http://msdn.microsoft.com/en-us/library/ms164309.aspx)，您可以放心地直接使用它（特别是如果您准备将 a`ToolsVersion="4.0"`放在文件顶部以保证它可用，如果不可用，则[快速失败）。](http://en.wikipedia.org/wiki/Fail-fast)

如果您不需要并且需要即使在 MSBuild 2.0 或更高版本的环境中执行（即回到 VS 2005 环境）也能做正确的事情，完整的解决方案是：

```
<PropertyGroup>
    <!--MSBuild 4.0 property-->
    <ProgramFiles32>$(MSBuildProgramFiles32)</ProgramFiles32> 
    <!--Use OS env var as a fallback:- 32 bit MSBuild 2.0/3.5 on x64 will use this-->
    <ProgramFiles32 Condition=" '' == '$(ProgramFiles32)'">$(ProgramFiles%28x86%29)</ProgramFiles32>

    <!-- Handle MSBuild 2.0/3.5 running in 64 bit mode - neither of the above env vars are available. http://stackoverflow.com/questions/336633
       NB this trick (Adding a literal " (x86)" to the 64 bit Program Files path) may or may not work on all versions/locales of Windows -->
    <ProgramFiles32 Condition ="'$(ProgramFiles32)'=='' AND 'AMD64' == '$(PROCESSOR_ARCHITECTURE)'">$(ProgramFiles) (x86)</ProgramFiles32>

    <!--Catch-all - handles .NET 2.0/3.5 non-AMD64 and .NET 2.0 on x86 -->
    <ProgramFiles32 Condition=" '' == '$(ProgramFiles32)' ">$(ProgramFiles)</ProgramFiles32>
</PropertyGroup> 
```

不幸的是， [MSBuild 保留属性](http://msdn.microsoft.com/en-us/library/ms164309.aspx)名称的[渐进增强](http://en.wikipedia.org/wiki/Progressive_enhancement)/ [polyfill](http://remysharp.com/2010/10/08/what-is-a-polyfill/)覆盖通过 a或被MSBuild 4.0+ 拒绝，因此它不能变得更整洁并且仍然支持 .NET 2.0。`MSBuildProgramFiles32``<PropertyGroup>``<CreateProperty>`

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-06T10:38:30.150

我的解决方案是查看“c:\program files (x86)”是否存在，如果存在，假设这是一个 64 位操作系统。否则使用正常的程序文件目录：

```
<PropertyGroup>
  <ProgramFiles32 Condition="Exists('$(PROGRAMFILES) (x86)')">$(PROGRAMFILES) (x86)</ProgramFiles32>
  <ProgramFiles32 Condition="$(ProgramFiles32) == ''">$(PROGRAMFILES)</ProgramFiles32>
</PropertyGroup> 
```

我可以这样使用

```
<Exec WorkingDirectory="src\app1" Command='"$(ProgramFiles32)\doxygen\bin\doxygen" Doxyfile' /> 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-12-07T19:50:51.120

在 MSBuild 4.0 中，`$(MSBuildProgramFiles32)`将为您提供 32 位的 Program Files 目录。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-06-27T06:37:36.357

尝试`"$(MSBuildExtensionsPath32)\.."`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-06T10:52:20.030

我认为更可靠的方法是获取环境变量“ProgramFiles(x86)”。在 Windows 上的 64 位进程中，这将指向 32 位程序文件目录。在 32 位版本的 Windows 上它将是空的，我**相信**在 wow64 进程上

我最近在使用一些 PowerShell 脚本时遇到了几乎相同的问题。我写了一篇关于如何解决程序文件目录问题的博客文章。显然不同的语言，但它可能会帮助你。

[http://blogs.msdn.com/jaredpar/archive/2008/10/21/program-files-i-just-want-the-32-bit-version.aspx](http://blogs.msdn.com/jaredpar/archive/2008/10/21/program-files-i-just-want-the-32-bit-version.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-25T21:08:48.960

我偶然发现了这个问题，试图在 MSbuild 中找到一种通用方法来查看它是 32 位还是 64 位操作系统。如果其他人也发现了这个，我使用了以下内容：

```
<PropertyGroup>
  <OSBits Condition="$(ProgramW6432) != ''">x64</OSBits>
  <OSBits Condition="$(OSBits) == ''">x32</OSBits>
</PropertyGroup> 
```

显然`%ProgramW6432%`只在 64 位系统上设置。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-15T16:46:16.053

如果您运行 32 位版本的 Visual Studio 工具（尤其是在 VS2012 中，您可以选择 3 种不同的命令提示符），$(ProgramFiles) 指向“Program Files (x86)”

# javascript - 根据偏好绘制用户界面

> ID：346189
> 
> 赞同：3
> 
> 时间：2008-12-06T11:03:19.070
> 
> 标签：javascript, firefox, xul, preferences, xulrunner

我想为我的 xulrunner (Firefox) 应用程序使用内置的首选项系统。但我不知道如何根据偏好轻松驱动用户界面。

用户可以指定主页列表，每个主页将显示在不同的选项卡中。因为选项卡位于表示层中，所以我想使用 xul 代码中的模板来创建它们。这可能吗？

我还没有看到使用 xul 模板执行此操作的方法。是否有替代模板系统允许我根据用户偏好更改 UI？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-15T02:33:24.813

不，XUL 中的模板功能不够强大，因此您只能编写 JavaScript 代码来读取首选项并打开所需的选项卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T08:32:26.030

```
 XML.prototype.function::domNode = function domNode() {
    function addPrefix(prefix, name) {
        if (typeof(prefix) == "undefined" || prefix == null || prefix == "") {
            return name;
        } else {
            return prefix + ":" + name;
        }
    }

    function recurse(xml) {
        var domNode = document.createElementNS(xml.namespace().uri, addPrefix(xml.namespace().prefix, xml.localName()));

        for each (let attr in xml.@*::*) {
            let attrNode = document.createAttributeNS(attr.namespace().uri, addPrefix(attr.namespace().prefix, attr.localName()));
            attrNode.nodeValue = attr;
            domNode.setAttributeNode(attrNode);
        }
        if (xml.hasComplexContent()) {
            for each (let node in xml.*) {
                domNode.appendChild(recurse(node));
            }
        } else if (xml.hasSimpleContent()) {
            domNode.appendChild(document.createTextNode(xml));
        }
        return domNode;
    }

    return recurse(this);
};

var name = "example"
var xml = {name};

document.querySelector("#example-statusbar-panel").appendChild(xml.domNode()); 
```

作为一种魅力，尽管命名空间存在一些小故障。

您总是可以使用以下命令将 dom 转换回 XML

```
var str = serializer.serializeToString( xml.domNode() ); 
```

# database - Castle ActiveRecord - 在运行时确定连接字符串

> ID：346198
> 
> 赞同：1
> 
> 时间：2008-12-06T11:34:29.133
> 
> 标签：database, database-connection, castle-activerecord

使用 Castle ActiveRecord 时，是否可以在运行时确定使用哪个连接字符串？

据我了解，ActiveRecord 在应用程序的生命周期内只需初始化一次，这意味着必须在初始化之前配置数据库连接字符串。

但是，是否仍然可以在运行时确定连接字符串 - 即，如果 Web 应用程序在用户登录之前不知道要使用哪个数据库怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-07T05:05:32.163

查看[不同的数据库范围](http://svn.castleproject.org:8080/svn/castle/ActiveRecord/trunk/src/Castle.ActiveRecord.Tests/DifferentDatabaseScopeTestCase.cs)

# open-source - 您对开源项目的贡献是什么？

> ID：346207
> 
> 赞同：3
> 
> 时间：2008-12-06T11:52:47.630
> 
> 标签：open-source

我一直想知道这个看似乌托邦的开源世界。

假设这里的绝大多数用户是需要某种收入来源的专业软件工程师，我假设我们大多数人都拥有稳定、赚钱的工作。

那么谁是开源社区的主要参与者？哪些人将宝贵的时间投入到这些项目中？他们有什么好处？大多数人只是看到错误，修复它，提交并忘记项目的人吗？或者他们是不断参与产品构建过程的人吗？

您如何发现自己为开源项目做出贡献？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-06T12:47:07.957

我以从事基于开源框架或商业产品的专业项目为生，而且通常两者兼而有之。

我多年来使用的许多商业产品最终都变得非常昂贵。假设您为 Web 应用程序购买了单点登录解决方案。当你完成你必须做的事情时，我和许多其他人都经历过你最终重新实现它的 2/3ds，有时你认为你要去的商业产品几乎什么都没有了使用。

因此，购买东西的问题在于它永远不适合，而且购买决定通常是基于比较功能的功能矩阵，而实际上并未考虑这些功能在您自己的环境中的适用性。

我想要了解的是，成熟的组织明白没有免费的午餐，即使在您为产品许可证付费之后也是如此。您为内容管理系统花费了 100 万美元这一事实并不意味着您不会再花费 200 万美元来进行与此相关的 50% 的计划和 50% 的计划外活动。

因此，我们可以、愿意并且确实为我们参与的所有 OSS 项目编写补丁。有时我们会返工子系统，而大多数时候我们会将其提交回来。有时我们决定我们只想要框架的 50%，而我们只为自己分叉其余的。但是我们仍然希望保留我们使用的 50% 的框架。尝试用商业产品来做这件事；）一般来说，我们尽量留在“开发者”邮件列表上，但我们很少为获得项目的提交权而烦恼。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-06T17:53:44.703

我对开源项目的最大贡献不是为它们贡献代码，而是通过实际*使用*它们。

从哲学上讲，这可能对项目的健康和实用性几乎同样重要，实际用户在日常对话或类似网站中提交反馈并留下建议和评论。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-06T14:02:02.627

> 大多数人只是看到错误，修复它，提交并忘记项目的人吗？或者他们是不断参与产品构建过程的人吗？

我绝对属于第一类（专注于长期项目不是我的事），但有很多人属于第二类。没有它们，我们就没有多少可行的自由软件生态系统。这些人中有很大一部分是为了编写和维护开源软件而获得报酬的，但仍然有很多爱好者只是为了好玩而这样做。事实上，我认识的大多数为开源软件工作而获得报酬的人，如果他们必须免费做这件事，他们仍然会做出贡献（我当然会）。贡献将不那么频繁。

> 您如何发现自己为开源项目做出贡献？

当我还是学生的时候，我玩过各种免费/开源软件的内部结构（包括 gdb、OpenSSH、arping、一些 IRC 客户端、Snort、各种 Perl 模块、一些 Debian 特定包的东西......）并修复了一些错误在这样做的同时实现一些功能。就 SLOC 而言没什么大不了的，其中一些贡献被拒绝了，但它仍然很有趣。

我共同创立了一个自由软件用户组，该组已经运行了 4 年多。在会议上，我有时会做关于自由软件的技术演示。我们还尝试定期参加应邀 LUG/FSUG 的外部活动。

我还经常从我喜欢的项目中购买 T 恤、毛衣和绒毛，以此来给他们一些经济上的贡献。

我现在在一家开源公司做技术支持，因此我会定期报告错误并编写修复程序。他们实际上为此付钱给我。当你可以同时做这两件事时，为什么要在为开源做贡献和拥有一份真正的工作之间做出选择？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T12:02:23.477

对自己所做的事情感到自豪很重要。当你的代码被同行接受时，也会获得信心。

在初始阶段之后，主要是能够管理代码构建和发布、提出新想法和练习技能。

开源项目中的一些人这样做是因为他们觉得他们没有从工作中获得的自由是一种解放。

我个人尝试尽可能多地做出贡献，从文档到错误修复。这并不是说我做了很多，但我喜欢它，只要我可以。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-06T13:06:34.203

我已经开始了我的项目，因为当时我找不到任何符合我想法的应用程序。我将其开源是因为[Sourceforge](http://sourceforge.net)拥有出色的基础架构，我不愿意亲自应对。

我用 Google Adsense 赚到的钱几乎不足以支付域名和托管费用，除此之外，这些年来这很有趣。并且可以完全控制自己的工作，这是一种令人耳目一新的体验，这在我的日常工作中肯定不是这样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T12:10:54.067

[我通过基于开源 Web 框架 ( Aida/Web](http://www.aidaweb.si) )的专业项目谋生，我是该框架的作者和积极贡献者。我们社区中的其他人也越来越多。他们在赚钱的同时，也为实际上使他们能够赚钱的工具做出了贡献。因此，为了所有人的利益，这个循环是封闭的。我很确定这样的模型对于开源来说是最好的，许多其他开源的人也在追随它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T13:52:38.090

我所有的操作系​​统项目都是从需要满足的真实业务需求开始的。工作完成后，我可以通过 Google 代码向公众发布小程序或其他任何内容。到目前为止，我还没有*任何人提交错误报告，我怀疑我永远不会。*我发布的大部分内容都很小，但希望有用。就我个人而言，我根本不相信使用操作系统软件的人会提交错误报告：他们只是去下载一些真正有效的东西。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-06T17:57:47.767

我两者都做。

我不是“主要参与者”，但如果我可以帮助改进我感兴趣的项目，我会尽我所能，从向文档中添加一些内容，指出一些可能的改进，修复错误，提供修补。

例如，我帮助改进了一个 PHP 框架。有时我会提供或改进法语翻译。

至少有一个项目我（仍然是，虽然现在投入的时间少得多）非常参与，[Scintilla 和 SciTE](http://www.scintilla.org/ "闪烁和 SciTE")（我在 SciTE 学分中按时间顺序排列的贡献者列表中排名靠前）。当然，我的主要兴趣是有一个适合我的需求和品味的编辑器。这就是开源的精神，得到对项目有浓厚兴趣的人的贡献。

我提供了帮助，但与此同时，我学到了很多东西，所以这对每个人来说都是一笔好买卖。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-06T14:52:29.000

我已经专门从事开源工作三年了，此外，在此之前，我将 FOSS 作为“爱好项目”。我们正在使用我们自己的[Ra-Ajax](http://ra-ajax.org)来获得咨询服务。这首先使我们有可能创建*非常*有益和有趣的 OSS！其次，它为我们自己创造了更好的工具，因为我们知道进出的工具通常可以收取更好的价格，然后如果我们正在使用“其他人制造”的一些“随机物品”......

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-06T18:42:17.960

> 您如何发现自己为开源项目做出贡献？

我认为，就像编程本身一样，它与你的热情和兴趣有很大关系。如果您正在从事一个项目，或者对某个主题感兴趣，并且发现自己需要一个执行 X 的工具或模块，请去搜索它。有可能至少还有一个人已经发布了一个开源项目。根据您的发现，您可以：

1.  使用产品并通过错误报告/修复和反馈帮助所有者使其变得更好。
2.  改进产品并将您的更改提交给所有者。
3.  制作您自己的产品并将其作为开源发布，供其他人使用以进行前两个操作。

很有可能，当您刚起步时，您不会一夜之间成为开源摇滚明星。就像互联网本身一样，那里有很多东西，你可能不会马上被注意到。然而，仅仅经历这个过程就会教会你足够的东西，让它变得值得。

这就是我所在的地方。我还没有在开源社区中为自己出名。我通过阅读博客和仅使用代码了解了少数关键参与者的名字，但这确实错过了开源的意义。我找到了一些非常棒的工具，并显着提高了我的知识和编码，这对我来说很重要。

根据我的经验，与我交谈过的许多人都以以下一种或多种方式看待开源：

1.  超级黑客的爱好。
2.  人们为慈善而做的事情。
3.  免费代码示例的来源。
4.  一项人权。
5.  寻找临时解决方案的地方。

我认为这是一个很好的学习机会，将工具添加到您的工具箱中，更多地了解您的行业和其中的其他人，同时享受乐趣。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-06T20:17:34.147

好吧，我已经在我的博客上启动了一个 OS 项目，以解决 Visual Studio XAML 进程中一些明显的缺点/进程加速问题。目前它不是 100% 开源的，因为我是该项目中唯一活跃的开发人员，但我已经让人们为该项目贡献了源代码，这对我继续开发它是一个极好的激励。

稍有不同的是，我编写了已发布在 Code Project 上的应用程序和文章，因此人们可以免费下载它们并在他们认为合适的时候使用它们。我的理论——如果我把它放到公共领域，那么你可以免费使用你认为合适的；我不想要任何钱——这不是我写这篇文章的原因。

为开源项目做贡献是磨练可能不在您的主要开发集中的技能的好方法，因此这是提高您的简历的好方法。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-06T21:19:15.210

报告的错误。书面文章。在论坛/IRC 上回答了问题。甚至启动了我自己的 OSS 项目（从那以后我把它交给了其他人）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-06T21:54:40.113

我真的很想为操作系统项目做出贡献，但是有三个孩子和一份全职工作，我发现自己没有足够的时间去做任何事情，除了使用操作系统。希望这种情况很快会改变，但我确实相信至少有不少开发人员与我在同一条船上。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-06T21:59:58.543

诚实的回答：不多。

我自己写了很多，但我并没有真正考虑到这种贡献。我给其他项目的最多的是一些错误报告。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-07T21:26:27.270

*   使用它。
*   推广它。
*   创建一个小型开源项目 ( [Natural CLI](http://naturalcli.sourceforge.net) )。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2010-03-20T18:31:01.830

我在一个名为的开源项目中非常活跃：

[JStock - 免费股市软件](http://jstock.sourceforge.net)

我可以提高我的 $ncome（通过使用 JStock 进行投资）并同时编写代码 :)

# apache-flex - mxml和as3混淆【简单】

> ID：346208
> 
> 赞同：1
> 
> 时间：2008-12-06T11:54:14.070
> 
> 标签：apache-flex, actionscript-3, mxml

我想知道我可以像这样从 mxml 代码调用脚本中定义的 as3 函数：

```
<mx:Line x="translateX(xmin);" .. >

<mx:Script>
   <![CDATA[

   // do some basic math
   private function translate ... 
```

如果不可能，我是否必须将所有内容都转换为 as3 ？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-08T05:27:12.540

您可以但是像这样的直接函数调用需要进入 MXML 中的事件属性，即“当这个事件被调度时，调用这个函数”。经典的例子是：

```
<mx:Button label="Hello" click="myFunction()"/> 
```

您可以使用上面说明的函数，前提是它位于绑定表达式中并且传递给函数的参数是可绑定的：

```
<mx:Line x="{positionLine(xmin)}"/>

// defined somewhere in a mx:Script block
[Bindable] private var xmin : Number; 
```

# c# - 将单元测试分解到另一个项目中

> ID：346211
> 
> 赞同：0
> 
> 时间：2008-12-06T12:02:09.123
> 
> 标签：c#, unit-testing

我曾经在我的主项目中有一个 Tests 文件夹，其中单元测试有这行代码：

```
Foo foo = new Foo(Environment.CurrentDirectory + @"\XML\FooData.xml" ); 
```

我在 Foo 项目中有一个 XML 目录，它有一个 FooData.xml

在我的项目的后期构建事件中，我有以下行副本 "$(ProjectDir)Foo\Currencies.xml" "$(TargetDir)\XML"

我现在已将所有单元测试分解到另一个项目中以将它们分开，现在运行这些单元测试时出现以下错误。

***找不到路径“C:\svncheckout\Foo.Tests\bin\Debug\XML\FooData.xml”的一部分***

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T12:08:45.430

除了构建后步骤之外，您是否可以不只是将其作为 Visual Studio 中的“内容”项，告诉它将其复制到目标目录？我通常要么这样做，要么将其作为嵌入式资源并使用流和 Assembly.GetManifestResourceStream。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T12:08:43.167

我相信您需要将 Foo.Tests 项目的构建后事件更新为：

"$(ProjectDir)Foo.Test\Currencies.xml" "$(TargetDir)\XML"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T12:56:04.413

您还可以将 xml 的完整路径放在测试模块 app.config 中

# java - 如何编写一个 java web 服务来进行远程登录？

> ID：346225
> 
> 赞同：5
> 
> 时间：2008-12-06T12:32:13.790
> 
> 标签：java, web-services

我有两个申请。我需要从应用程序 a 到应用程序 b 进行单点登录。

我正在考虑使用网络服务。我想知道我该如何采用这种方法。

任何人都可以建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T23:54:15.537

假设这些是 Web 应用程序 - 您必须在应用程序之间实现某种类型的共享信任模型。

在任何情况下，您都不应该自己编写。这太容易搞砸了，有很多现有的（开放的和商业的）可供选择。

以下是以下选项： 1 - 如果每个人都在运行 Windows - 您可以只使用 Windows 本机身份验证 (aka SPNEGO) 2 - 您可以实现某种类型的 SSO 系统。流行的系统有 CAS、Oracle Access Manager、CA SiteMinder、Sun SSO 和 IBM Tivoli Access Manager。虽然 CAS 是开源的，但其他的也允许您实现授权，而 CAS 只进行身份验证。

最后 - 确保您选择的任何选项 - 它与您的语言的本机身份验证和授权框架集成。在 Java 中，这将是 JAAS。在 .NET 中，它将是 .NET 安全框架。对于 PHP/Perl - 您可以利用 Apache 模块。好处是您不必成为安全专家，这将使您更容易使用外部系统进行身份验证和授权，而无需重新编码您的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-08T22:06:25.907

您可以使用公钥身份验证方案。

使用公钥和私钥创建密钥对（使用 Java 的 keytool、GNU GPG 或类似工具）。使用私钥对应用程序 A 上的一条信息（例如用户名）进行签名，并创建一个指向应用程序 B 的链接，该链接可从应用程序 A 访问并包含签名数据。然后，应用程序 B 可以在使用公钥验证请求确实来自应用程序 A（如果它能够解密字符串，则它必须拥有）之后让用户登录。

当然，您也可以创建一个相反的密钥对来导航，或者您可以只使用公钥并将其保密（有效地使其成为一个共享秘密系统）。

如果用户尝试直接访问应用程序 B，您还可以使用表明他来自应用程序 B 的参数将他重定向到应用程序 A（或执行引用者检查）。如果他已经登录到应用程序 A，则使用签名数据创建链接并重定向到它，否则向他显示登录屏幕并在登录后重定向。

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T13:19:55.537

您可以使用现有的开源产品[CAS](http://www.ja-sig.org/products/cas/)并直接实现它，而不是自己开发。这样您就可以与支持相同协议的其他应用程序集成。即使您决定实现自己的代码而不是使用他们的代码，网站上也有很多想法可供您考虑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T14:07:03.007

如果应用程序托管在同一台服务器上，那么您可以将其配置为使用单点登录。例如，在 Tomcat 中，这是通过[Valve](http://tomcat.apache.org/tomcat-5.5-doc/config/host.html#Single%20Sign%20On)实现的。

如果应用程序位于不同的环境中，那么安全的 Web 服务是一个好主意。例如，您可以创建一个公钥 - 私钥对，并让应用程序 b（服务器）在客户端证书上验证应用程序 a（客户端）。这意味着应用程序 a 将使用客户端证书签署对应用程序 b 的所有请求。完整的解决方案需要有关架构的更多详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T14:16:05.983

你在使用应用服务器吗？您的应用程序的环境是什么？

有一个使用称为 Web Service Security UsernameToken Profile 的 Web 服务传播身份的标准。这是一个快速[概述](http://blogs.msdn.com/thehoggblog/articles/504526.aspx)。您可以发送用户名/密码或各种令牌，例如 X.509 证书或 SAML 断言。一些应用服务器 Web 服务堆栈将处理 WSS UsernameToken Profile、JBoss、Websphere 和 WebLogic。否则，Web 服务代码必须处理它。根据您的环境，这种方法可能过于繁琐。

有一个单点登录标准，称为[SAML](http://en.wikipedia.org/wiki/SAML)。同样，这对于您的用例来说可能太重了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T19:28:12.093

在 Oracle 领域，我知道有可信应用程序的概念。基本上，如果您可以控制这两个应用程序，则可以像这样进行设置：

应用程序 A 发送应用程序 B，1) 应用程序 A 的用户名和密码以及 2) 当前用户的用户名。由于 B 知道并信任应用程序 A，它不需要验证用户的凭据，因为它知道应用程序 A 已经为它完成了验证。

我假设如果你有一个自定义应用程序 B，你也许可以做这样的事情。如果您的 SSO 实现支持这一点，那么您可能不需要做很多事情，除了设计您的 Web 服务。

祝你好运

# xml - 如何创建布尔值？

> ID：346226
> 
> 赞同：87
> 
> 时间：2008-12-06T12:34:41.383
> 
> 标签：xml, xslt, boolean, xslt-1.0, xslt-2.0

我对 XSLT 完全陌生，无法弄清楚以下代码哪里出错了。

```
<xsl:variable name="var" select="boolean('false')"/>

<xsl:if test="$var'">variable is true</xsl:if> 
```

当它应该为假时，它总是返回真。为什么？

* * *

## 回答 #1

> 赞同：169
> 
> 时间：2008-12-06T17:20:36.393

$var 变量的值定义在：

   `<xsl:variable name="var" select="boolean('false')"/>`

是

   **`true()`**

这是因为在 XPath 中 " `false`" 是一个普通字符串，而不是`false()`，它是`boolean`值的构造函数`false()`

**XPath 中的两个布尔值是**（注意它们是构造的！）：

   **`true()`** 和 **`false()`**

[XPath Spec](http://www.w3.org/TR/xpath#section-Boolean-Functions)中详细说明了将任何值转换为布尔值的详细信息。：

“[**布尔**](http://www.w3.org/TR/xpath#function-boolean)函数将其参数转换为布尔值，如下所示：

*   一个数为真当且仅当它既不是正零也不是负零也不是 NaN

*   一个节点集当且仅当它非空时为真

*   字符串为真当且仅当其长度非零

*   四种基本类型以外的类型的对象以依赖于该类型的方式转换为布尔值“

在您的情况下，字符串 "false" 不是数字 0 并且具有正长度，因此应用上面第三个项目符号中的规则，产生`true()`.

**因此，要在 XSLT 1.0 中定义一个值为 的变量，** [**`false()`**](http://www.w3.org/TR/xpath#function-false)需要编写如下定义：

   `<xsl:variable name="vMyVar" select="false()"/>`

或者，如果您不完全记得这一点，您可以随时写：

   `<xsl:variable name="vMyVar" select="1 = 0"/>`

（指定任何计算结果为`false()`的表达式）并且 XSLT 处理器将为您完成工作。

**在 XSLT 2.0 中，最好明确指定**变量的类型：

   `<xsl:variable name="vMyVar" as="xs:boolean" select="false()"/>`

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-06T12:38:18.490

您正在使用的 boolean() 函数确实在发挥作用。要使用明确的真假值，您应该使用以下函数：

```
<xsl:variable name="var_false" select="false()"/>
<xsl:variable name="var_true" select="true()"/> 
```

仅供参考，根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/ms256159(VS.85).aspx)，boolean() 返回以下内容：

*   如果参数是负数或正数，则将其转换为布尔值 true。
*   如果参数为零或 NaN 值，则将其转换为 false。
*   如果参数是非空节点集，则将其转换为 true。一个空的节点集被转换为假。
*   **如果参数是非空字符串，则将其转换为 true**。空字符串被转换为假。
*   如果参数是四种基本类型以外的类型的对象，则以依赖于该类型的方式将其转换为布尔值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-06-02T09:29:51.443

在这个阶段可能有点晚了，但 imo 处理布尔值是不值得的。以下是我如何处理从数据库返回的布尔值（强制）：

```
<xsl:variable name="vTrue" select="true()"/>                     
    <xsl:choose>
      <xsl:when test="string(Mandatory) = string($vTrue)">
        <xsl:text>Mandatory</xsl:text>
      </xsl:when>
      <xsl:otherwise>           
      </xsl:otherwise>
    </xsl:choose> 
```

希望这可以帮助某人

# python - 在python中将文件对象作为字符串读取

> ID：346230
> 
> 赞同：31
> 
> 时间：2008-12-06T12:41:36.813
> 
> 标签：python, file, urllib2

我`urllib2`用来在页面中阅读。我需要对源代码进行快速正则表达式并提取一些变量，但`urllib2`呈现为文件对象而不是字符串。

我是 python 新手，所以我很难了解如何使用文件对象来执行此操作。有没有一种快速的方法可以将其转换为字符串？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-12-06T12:47:18.957

您可以在交互模式下使用 Python 来搜索解决方案。

如果`f`是你的对象，你可以进入`dir(f)`查看所有的方法和属性。有一个叫`read`。Enter`help(f.read)`并告诉您这`f.read()`是从文件对象中检索字符串的方法。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-06T13:07:39.833

从文档[file.read()](http://docs.python.org/library/stdtypes.html#file.read)（我的重点）：

> 文件读取（[大小]）
> 
> 从文件中读取最多 size 个字节（如果读取在获得 size 个字节之前达到 EOF，则更少）。如果 size 参数为负数或省略，则读取所有数据，直到达到 EOF。**字节作为字符串对象返回**。立即遇到 EOF 时返回一个空字符串。（对于某些文件，如 ttys，在 EOF 被命中后继续读取是有意义的。）请注意，此方法可能会多次调用底层 C 函数 fread 以获取尽可能接近 size 的字节。另请注意，在非阻塞模式下，即使没有给出大小参数，返回的数据也可能少于请求的数据。

请注意，对大字符串对象进行正则表达式搜索可能效率不高，并考虑使用[file.next()](http://docs.python.org/library/stdtypes.html#file.next)逐行进行搜索（文件对象是它自己的迭代器）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-06T13:17:59.300

Michael Foord，又名 Voidspace 有一个关于 urllib2 的优秀教程，你可以在这里找到： [urllib2 - The Missing Manual](http://www.voidspace.org.uk/python/articles/urllib2.shtml)

您所做的应该非常简单，请注意以下示例代码：

```
import urllib2
import re
response = urllib2.urlopen("http://www.voidspace.org.uk/python/articles/urllib2.shtml")
html = response.read()
pattern = '(V.+space)'
wordPattern = re.compile(pattern, re.IGNORECASE)
results = wordPattern.search(html)
print results.groups() 
```

# c# - 将 Environment.CurrentDirectory 与返回路径连接起来

> ID：346243
> 
> 赞同：5
> 
> 时间：2008-12-06T12:52:20.990
> 
> 标签：c#, path

如果我有以下目录结构：

Project1/bin/debug
Project2/xml/file.xml

我正在尝试从 Project1/bin/debug 目录中引用 file.xml

我基本上是在尝试执行以下操作：

```
string path = Environment.CurrentDirectory + @"..\..\Project2\xml\File.xml": 
```

什么是正确的语法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-06T12:56:23.477

将路径组件作为路径组件而不是字符串来操作可能会更好：

```
string path = System.IO.Path.Combine(Environment.CurrentDirectory, 
                                     @"..\..\..\Project2\xml\File.xml"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T12:56:21.637

采用：

```
System.IO.Path.GetFullPath(@"..\..\Project2\xml\File.xml") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T12:56:57.517

```
string path = Path.Combine( Environment.CurrentDirectory,
                            @"..\..\..\Project2\xml\File.xml" ); 
```

一“..”带你去bin

下一个“..”带你到 Project1

下一个“..”将您带到 Project1 的父级

然后下到文件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T13:17:45.603

请注意，使用 Path.Combine() 可能不会给您预期的结果，例如：

```
string path = System.IO.Path.Combine(@"c:\dir1\dir2",
                                     @"..\..\Project2\xml\File.xml"); 
```

这将产生以下字符串：

```
@"c:\dir1\dir2\dir3\..\..\Project2\xml\File.xml" 
```

如果您希望路径是“c:\dir1\Project2\xml\File.xml”，那么您可以使用类似下面的方法而不是 Path.Combine()：

```
public static string CombinePaths(string rootPath, string relativePath)
{
    DirectoryInfo dir = new DirectoryInfo(rootPath);
    while (relativePath.StartsWith("..\\"))
    {
        dir = dir.Parent;
        relativePath = relativePath.Substring(3);
    }
    return Path.Combine(dir.FullName, relativePath);
} 
```

# .net - 如何拦截连接请求？

> ID：346263
> 
> 赞同：1
> 
> 时间：2008-12-06T13:21:38.607
> 
> 标签：.net, network-programming

我正在开发一个应用程序，该应用程序需要在程序尝试连接到指定的 IP 地址并将其重定向到另一个 IP 时进行拦截。

这可能吗？

我为此使用.net。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T13:37:03.567

最好的办法是使用[EasyHook 项目](http://www.codeplex.com/easyhook)来挂钩[连接功能](http://msdn.microsoft.com/en-us/library/ms737625(VS.85).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-16T11:42:57.307

它可能不符合要求，但您可以使用“主机”文件。（“hosts”文件仅在程序不是通过 IP 地址连接，而是通过主机名连接时才可用于此目的）

# python - Python正则表达式解析成二维数组

> ID：346267
> 
> 赞同：3
> 
> 时间：2008-12-06T13:31:05.543
> 
> 标签：python, regex

我有一个这样的字符串，我需要将其解析为二维数组：

```
 str = "'813702104[813702106]','813702141[813702143]','813702172[813702174]'" 
```

等效的数组将是：

```
arr[0][0] = 813702104
arr[0][1] = 813702106
arr[1][0] = 813702141
arr[1][1] = 813702143
#... etc ... 
```

我正在尝试通过 REGEX 来做到这一点。上面的字符串隐藏在 HTML 页面中，但我可以确定它是页面上该模式中唯一的字符串。我不确定这是否是最好的方法，但这就是我现在所拥有的。

```
imgRegex = re.compile(r"(?:'(?P<main>\d+)\[(?P<thumb>\d+)\]',?)+") 
```

如果我运行，`imgRegex.match(str).groups()`我只会得到一个结果（第一对联）。如何获取多个匹配项或 2d 匹配对象（如果存在这样的东西！）？

*注意：与看起来相反，这**不是**家庭作业*

# 注意*部分 deux*：真正的字符串嵌入在一个*大*的HTML 文件中，因此拆分似乎不是一种选择。

我仍然得到这个答案，所以我想我最好编辑它以显示为什么我不改变接受的答案。拆分虽然在此测试字符串上更有效，但不会从整个 HTML 文件中提取部分。我*可以*结合正则表达式和拆分，但这似乎很愚蠢。

如果您确实有更好的方法从大量 HTML 中查找部分（该模式`\d+\[\d+\]`对于源中的此字符串是唯一的），我会很乐意更改已接受的答案。其他任何东西都是学术性的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T13:38:54.937

我会尝试`findall`or`finditer`而不是`match`.

Oli 编辑：是的，`findall`工作出色，但我不得不将正则表达式简化为：

```
r"'(?P<main>\d+)\[(?P<thumb>\d+)\]',?" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T13:54:34.437

我想我不会为这项任务使用正则表达式。Python 列表推导对此非常强大

```
In [27]: s = "'813702104[813702106]','813702141[813702143]','813702172[813702174]'"

In [28]: d=[[int(each1.strip(']\'')) for each1 in each.split('[')] for each in s.split(',')]

In [29]: d[0][1]
Out[29]: 813702106

In [30]: d[1][0]
Out[30]: 813702141

In [31]: d
Out[31]: [[813702104, 813702106], [813702141, 813702143], [813702172, 813702174]] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T13:44:13.007

稍微修改一下你的正则表达式，

```
>>> str = "'813702104[813702106]','813702141[813702143]','813702172[813702174]"
>>> imgRegex = re.compile(r"'(?P<main>\d+)\[(?P<thumb>\d+)\]',?")
>>> print imgRegex.findall(str)
[('813702104', '813702106'), ('813702141', '813702143')] 
```

这是一个“二维数组” - 在 Python 中，“一个 2 元组列表”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T13:50:55.037

我有一些似乎适用于您的数据集的东西：

```
In [19]: str = "'813702104[813702106]','813702141[813702143]','813702172[813702174]'"
In [20]: ptr = re.compile( r"'(?P<one>\d+)\[(?P<two>\d+)\]'" )
In [21]: ptr.findall( str )
Out [23]:
[('813702104', '813702106'),
 ('813702141', '813702143'),
 ('813702172', '813702174')] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T17:04:40.947

或者，您可以使用 Python 的 [ *statement* for *item* in *list* ] 语法来构建列表。您应该会发现这比正则表达式要快得多，尤其是对于小型数据集。较大的数据集将显示不太明显的差异（无论大小，它只需要加载一次正则表达式引擎），但列表生成器应该总是更快。

首先用逗号分割字符串：

```
>>> str = "'813702104[813702106]','813702141[813702143]','813702172[813702174]'"
>>> arr = [pair for pair in str.split(",")]
>>> arr
["'813702104[813702106]'", "'813702141[813702143]'", "'813702172[813702174]'"] 
```

现在，它返回与 str.split(",") 相同的东西，所以不是很有用，但你应该能够看到 listmaker 是如何工作的——它遍历列表，将每个值分配给 item，执行语句，并将结果值附加到新建的列表中。

为了完成一些有用的事情，我们需要放入一个真实的语句，所以我们得到每一对的切片，删除单引号和右方括号，然后在方便放置的左方括号上进一步拆分：

```
>>> arr = [pair[1:-2].split("[") for pair in str.split(",")]
>>> arr
>>> [['813702104', '813702106'], ['813702141', '813702143'], ['813702172', '813702174']] 
```

这会像您描述的那样返回一个二维数组，但这些项目都是字符串而不是整数。如果您只是将它们用作字符串，那就足够了。如果您需要它们是实际整数，您只需使用“内部”列表生成器作为“外部”列表生成器的语句：

```
>>> arr = [[int(x) for x in pair[1:-2].split("[")] for pair in str.split(",")]
>>> arr
>>> [[813702104, 813702106], [813702141, 813702143], [813702172, 813702174]] 
```

This returns a two-dimensional array of the integers representing in a string like the one you provided, without ever needing to load the regular expressions engine.

# c# - 最佳线程队列示例/最佳实践

> ID：346268
> 
> 赞同：37
> 
> 时间：2008-12-06T13:32:43.747
> 
> 标签：c#, multithreading

我有需要在某个后台线程上执行的数据。我有来自需要调用它的所有其他线程的代码。有没有人有一个很好的教程或最佳实践，有一个同步队列来支持这个线程要求

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-06T15:01:00.463

查看Joseph Albahari 撰写[的 C#](http://www.albahari.com/threading/)中的线程，关于多线程的非常完整的参考。特别是，他涵盖了[生产者/消费者队列](http://www.albahari.com/threading/part2.aspx#_ProducerConsumerQWaitHandle)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-06T14:19:49.970

您可以：

*   实现[生产者/消费者模型](http://msdn.microsoft.com/en-us/library/yy12yx1f.aspx)（使用非线程安全的[通用队列](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)）
*   或在您的后台线程中使用[同步队列](http://msdn.microsoft.com/en-us/library/system.collections.queue.synchronized.aspx)，它确实评论通过集合枚举的过程。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-06T14:18:14.810

这是一篇关于 ThreadPools 的有趣文章：

> [http://www.codeproject.com/KB/threads/smartthreadpool.aspx](http://www.codeproject.com/KB/threads/smartthreadpool.aspx)

对于更简单的用例，您还可以使用 .Net 自己的 ThreadPool 类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T14:19:13.527

对于这个问题，我最喜欢的解决方案之一与`producer/consumer`模式类似。

`Main()`我创建了一个包含阻塞队列对象的主线程（几乎是我的程序的）。

这个主线程衍生出几个工作线程，这些工作线程简单地将事情从中央阻塞线程中弹出并处理它们。由于它是线程安全的阻塞队列，同步位很容易——`TaskQueue.Dequeue()`调用将阻塞，直到任务被生产者/主线程入队。

您可以动态管理所需的工作人员数量或根据配置变量对其进行修复——因为它们都只是从队列中弹出东西，工作人员的数量不会增加任何复杂性。

就我而言，我有一项服务可以处理几种不同类型的`tasks`. 我输入了队列来处理像`TaskQueueTask`. 然后我将其子类化并覆盖该`Execute()`方法。

* * *

我还尝试了 .NET 线程池方法，您可以在其中非常轻松地将东西放入池中。它使用起来极其简单，但也提供了很少的控制，并且不保证执行顺序、时间等。仅推荐用于轻量级任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T17:01:08.653

你可以试试这个解决方案。它向您展示了如何实现生产者-消费者模式。还有一些关于可以用它做什么的解释。就像生产者和消费者数量的不同组合。

[http://devpinoy.org/blogs/jakelite/archive/2009/01/12/threading-patterns-the-producer-consumer-pattern.aspx](http://devpinoy.org/blogs/jakelite/archive/2009/01/12/threading-patterns-the-producer-consumer-pattern.aspx)

[http://devpinoy.org/blogs/jakelite/archive/2009/02/03/threading-patterns-producer-consumer-pattern-examples.aspx](http://devpinoy.org/blogs/jakelite/archive/2009/02/03/threading-patterns-producer-consumer-pattern-examples.aspx)

# .net - .NET MVC 中控件的可重用性

> ID：346289
> 
> 赞同：2
> 
> 时间：2008-12-06T13:53:24.563
> 
> 标签：.net, asp.net-mvc, user-controls

我对 .NET MVC 了解的很少，到目前为止几乎没有使用过它，但我想知道您将如何创建可以分布在不同应用程序中的可重用控件？

我们在外部库中创建了各种控件，如果我们想使用它们，我们会引用程序集。一个示例是报告的日期范围选择器，用户可以选择两个日期，然后将其发回页面，并触发控件更改日期事件并更新报告。

你将如何在 MVC 中实现这一点？我知道你仍然可以像往常一样使用控件，但这似乎不是 MVC 应该使用的方式。我认为通常您会将表单数据发布到新视图，验证表单数据，然后执行下一步所需的操作。然而，当这一切都封装在一个控件中时，你怎么可能将它拆分到多个视图中呢？

我希望摆脱这个问题的几点是：

*   你如何解决这个问题？
*   你的控件有什么样的工作流程？
*   您的表单实际上是发布到其他页面还是回发到同一页面？

**** 更新：****

我从 Rob Conery 找到了这个博客条目，但它不处理它处理用户控件的控件。即使使用以下呈现控件的方法，您将如何使用它来呈现处理表单的控件？

[http://blog.wekeroad.com/2008/01/07/aspnet-mvc-using-usercontrols-usefully/](http://blog.wekeroad.com/2008/01/07/aspnet-mvc-using-usercontrols-usefully/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T16:16:16.177

对于视图元素的重用，HtmlHelper 的用户控件和扩展应该适合您的需要。我创建了一个项目，该项目扩展了视图页面以使用流畅的界面生成视图元素。[在这里](http://lunaverse.wordpress.com/2008/11/24/mvcfluenthtml-fluent-html-interface-for-ms-mvc/)阅读。

但是，这些都是仅查看方法。为了重用包含服务器端处理的 UI 元素，[MvcContrib](http://www.codeplex.com/MVCContrib)开发了子控制器的概念。[在这里](http://mhinze.com/subcontrollers-in-aspnet-mvc/)阅读。这是另[一篇博客文章](http://blog.codeville.net/2008/10/14/partial-requests-in-aspnet-mvc/)，描述了一种声称使用“部分请求”不太复杂的替代方法。我自己还没有涉足这个领域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T15:33:54.937

您可以使用纯 javascript 控件，然后可以通过 ajax “回发”。在服务器端，您有一个控制器 + 操作来处理日期范围的更改。

[日历示例](http://developer.yahoo.com/yui/examples/calendar/multi.html)

# c# - 在 Visual Web Developer 2008 Express 中设置默认命名空间

> ID：346297
> 
> 赞同：1
> 
> 时间：2008-12-06T14:02:35.620
> 
> 标签：c#, asp.net, visual-studio-2008, visual-web-developer

大家好，我刚刚使用 Visual Web Developer 2008 Express 开始了一个新项目，我所有的代码都没有在任何命名空间中。如何为项目设置默认命名空间？

在 VisualStudioPro 中，它曾经在项目属性中，Visual Web Developer 2008 Express 中的网站属性似乎非常……快。

谢谢，

大卫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T17:14:41.770

Visual Web Developer（2008 SP1 之前的版本）不支持 Web 应用程序项目。默认命名空间仅在 Web 应用程序项目中可用。

如果你真的想将你的类添加到命名空间，你应该通过将它们包含在命名空间语句中手动完成（用代码片段包围的命名空间可以证明非常有用）：

```
namespace MyDefaultNamespace {
   // original code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T15:51:15.807

如果您使用的是网站项目模板，则不使用命名空间。如果是这种情况，请考虑使用 Web 应用程序项目模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T14:50:10.550

执行查找和替换以找到您的命名空间并将其替换为您想要的。

# svn - $id: 文件名，创建日期/时间 Exp $

> ID：346301
> 
> 赞同：9
> 
> 时间：2008-12-06T14:07:54.907
> 
> 标签：svn, version-control, perforce, cvs, rcs

我经常在 C/C++ 源代码中遇到以下语句：

```
$Id: lzio.c,v 1.24 2003/03/20 16:00:56 roberto Exp $

$Id: file name, version, timestamp, creator Exp $ 
```

您知道哪些软件会产生这些“签名”吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T15:41:26.467

[subversion 中的关键字替换](http://svnbook.red-bean.com/en/1.4/svn.advanced.props.special.keywords.html)会产生此类信息，尤其是 Id：

> ID
> 
> 此关键字是其他关键字的压缩组合。它的替换看起来像 $Id: calc.c 148 2006-07-28 21:30:43Z sally $，并被解释为文件 calc.c 最后一次更改是在 2006 年 7 月 28 日晚上在修订版 148 中由用户sally。

你可以告诉 subversion 使用 svn:keywords 插入这些值

> 为了告诉 Subversion 是否替换特定文件上的关键字，我们再次转向与属性相关的子命令。svn:keywords 属性在版本化文件上设置时，控制将在该文件上替换哪些关键字。该值是在上表中找到的关键字名称或别名的空格分隔列表

您还可以通过编辑配置使这些替换自动进行：

> Subversion 还提供了 auto-props 功能，它允许您创建文件名模式到属性名称和值的映射。这些映射在您的运行时配置区域中进行。它们再次影响添加和导入，不仅可以覆盖 Subversion 在这些操作期间做出的任何默认 MIME 类型决策，它们还可以设置额外的 Subversion 或自定义属性。例如，您可能会创建一个映射，说明任何时候添加 JPEG 文件——匹配模式 *.jpg 的文件——Subversion 应该自动将这些文件的 svn:mime-type 属性设置为 image/jpeg。或者任何匹配 *.cpp 的文件都应该将 svn:eol-style 设置为 native，并将 svn:keywords 设置为 Id。Auto-prop 支持可能是 Subversion 工具箱中最方便的属性相关工具。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-06T14:09:21.940

CVS 等版本控制系统可以生成这样的标签。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T14:10:16.510

RCS 和 CVS 都生成看起来完全一样的字符串。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T14:19:12.343

我见过一些 vim 设置会自动填充这些值。SVN 可以在 pre 和 post 提交钩子上获取这些值，以在提交日志中填充默认信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T15:37:11.327

[Perforce](http://www.perforce.com)支持这些关键词中的一些（不确定全部）。

# c - 静态全局变量和静态易失变量有什么区别？

> ID：346306
> 
> 赞同：28
> 
> 时间：2008-12-06T14:14:09.577
> 
> 标签：c, static, global, interrupt, volatile

我在文件范围内使用了一个静态全局变量和一个静态 volatile 变量，

两者都由 ISR 和主循环更新，主循环检查变量的值。

在优化过程中，全局变量和 volatile 变量都没有被优化。因此，不是使用 volatile 变量，而是使用全局变量来解决问题。

那么使用全局变量而不是 volatile 好不好？

使用静态易失性的任何具体原因？

任何示例程序都将是可观的。

提前致谢..

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2008-12-06T15:51:55.073

首先让我提一下，静态全局变量与全局变量相同，只是您将变量限制在文件的范围内。即你不能通过`extern`关键字在其他文件中使用这个全局变量。

因此，您可以将问题简化为全局变量与易变变量。

**现在进入易失性：**

Like `const`,`volatile`是一个类型修饰符。

创建该`volatile`关键字是为了防止编译器优化可能导致代码不正确，特别是在存在异步事件时。

声明为的对象`volatile`可能不会在某些优化中使用。

系统总是在使用 volatile 对象时读取它的当前真实值，即使先前的指令要求来自同一对象的值也是如此。此外，对象的值在赋值时立即写入。这意味着没有将 volatile 变量缓存到 CPU 寄存器中。

[Dr. Jobb's 有一篇关于 volatile 的好文章](http://www.ddj.com/cpp/184403766)。

以下是 Jobb 博士文章中的一个示例：

```
class Gadget
{
public:
    void Wait()
    {
        while (!flag_)
        {
            Sleep(1000); // sleeps for 1000 milliseconds
        }
    }
    void Wakeup()
    {
        flag_ = true;
    }
    ...
private:
    bool flag_;
}; 
```

如果编译器看到这`Sleep()`是一个外部调用，它将假定`Sleep()`不可能更改变量 flag_ 的值。因此编译器可以将 的值存储`flag_`在寄存器中。在那种情况下，它永远不会改变。但是如果另一个线程调用唤醒，第一个线程仍然在读取 CPU 的寄存器。`Wait()`永远不会醒来。

那么为什么不直接将变量缓存到寄存器中并完全避免这个问题呢？事实证明，这种优化确实可以总体上为您节省大量时间。因此 C/C++ 允许您通过`volatile`关键字显式禁用它。

上述事实`flag_`是成员变量，而不是全局变量（也不是静态全局变量）并不重要。即使您正在处理全局变量（和静态全局变量），示例之后的解释也给出了正确的推理。

一个常见的误解是声明一个变量`volatile`就足以确保线程安全。对变量的操作仍然不是原子的，即使它们没有“缓存”在寄存器中

**带有指针的易失性：**

带有指针的易失性，就像带有指针的 const 一样。

类型`volatile int *`变量意味着指针指向的变量是易失的。

类型变量`int * volatile`意味着指针本身是易失的。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-06T15:35:04.030

它们是不同的东西。我不是易变语义方面的专家。但我认为这里描述的内容是有道理的。

### 全球的

全局只是意味着有问题的标识符是在文件范围内声明的。有不同的作用域，称为函数（goto-labels 定义在其中）、文件（全局变量所在的位置）、块（普通局部变量所在的位置）和函数原型（函数参数所在的位置）。这个概念只是为了构建标识符的可见性而存在。它与优化没有任何关系。

### 静止的

`static`是一个存储持续时间（我们不会在这里查看）和一种在文件范围内部链接中声明的名称的方法。这可以针对仅在一个翻译单元中需要的功能或对象来完成。一个典型的例子可能是`help`打印出接受的参数的函数，并且仅从`main`同一`.c`文件中定义的函数调用。

**C99 草案中的**6.2.2/2 ：****

 **> 如果对象或函数的文件范围标识符的声明包含存储类说明符 static，则该标识符具有内部链接。

内部链接意味着标识符在当前翻译单元之外不可见（如`help`上面的函数）。

### 易挥发的

易失性是另一回事：（**6.7.3/6**）

> 具有 volatile 限定类型的对象可能会以实现未知的方式进行修改或具有其他未知的副作用。因此，任何引用此类对象的表达式都应严格按照抽象机的规则进行评估，如 5.1.2.3 中所述。此外，在每个序列点，最后存储在对象中的值应与抽象机规定的值一致，除非由前面提到的未知因素修改。

该标准提供了一个很好的例子来说明一个`volatile`冗余的例子（**5.1.2.3/8**）：

> 一个实现可能会定义抽象语义和实际语义之间的一一对应关系：在每个序列点，实际对象的值将与抽象语义指定的值一致。那么关键字`volatile` 将是多余的。

*序列点是完成与抽象机*有关的副作用影响的点（即不包括存储单元值等外部条件）。例如，在和的左右之间`&&`，函数调用`||`之后`;`和返回是序列点。

*抽象语义*是编译器可以通过仅查看特定程序中的代码序列来推断的内容。优化的效果在这里无关紧要。*实际语义*包括通过写入对象完成的副作用的影响（例如，改变记忆单元）。将对象限定为易失性意味着总是直接从内存中获取对象的值（“由未知因素修改”）。该标准在任何地方都没有提到线程，如果您必须依赖更改的顺序或操作的原子性，您应该使用平台相关的方式来确保这一点。

对于易于理解的概述，英特尔在[这里](http://software.intel.com/en-us/blogs/2007/11/30/volatile-almost-useless-for-multi-threaded-programming/)有一篇很棒的文章。

### 我现在该怎么办？

继续将您的文件范围（全局）数据声明为易失性。全局数据本身并不意味着变量的值将等于存储在内存中的值。并且静态只会使您的对象成为当前翻译单元的本地对象（当前`.c`文件和所有其他文件#include'ed）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-06T14:21:18.047

“volatile”关键字建议编译器不要对涉及该变量的代码进行某些优化；如果你只使用一个全局变量，没有什么能阻止编译器错误地优化你的代码。

例子：

```
#define MYPORT 0xDEADB33F

volatile char *portptr = (char*)MYPORT;
*portptr = 'A';
*portptr = 'B'; 
```

没有“易失性”，第一次写入可能会被优化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-06T14:21:47.593

volatile 关键字告诉编译器确保该变量永远不会被缓存。对它的所有访问都必须以一致的方式进行，以便在所有线程之间具有一致的值。如果在循环检查更改时变量的值将由另一个线程更改，则您希望变量是易失的，因为不能保证常规变量值不会在某些时候被缓存并且循环只会假设它保持不变。

[维基百科上的易变变量](http://en.wikipedia.org/wiki/Volatile_variable)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-06T14:20:13.573

它们在您当前的环境中可能没有什么不同，但细微的变化可能会影响行为。

*   不同的硬件（更多的处理器，不同的内存架构）
*   具有更好优化的新版本编译器。
*   线程之间时间的随机变化。1000 万分之一的问题可能只会出现一次。
*   不同的编译器优化设置。

从长远来看，从一开始就使用适当的多线程结构要安全得多，即使现在没有它们似乎也可以工作。

当然，如果你的程序不是多线程的，那也没关系。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-06T15:35:56.510

我+1 friol的回答。我想添加一些精度，因为在不同的答案中似乎存在很多混淆：C 的 volatile 不是 Java 的 volatile。

因此，首先，编译器可以根据程序的数据流进行很多优化，C 中的 volatile 可以防止这种情况，它确保您每次都真正加载/存储到该位置（而不是使用寄存器来清除它） . 正如 friol 所指出的，当您有一个内存映射的 IO 端口时，它很有用。

C 中的 Volatile 与硬件缓存或多线程无关。它不插入内存栅栏，如果两个线程访问它，你对操作顺序绝对没有保证。Java 的 volatile 关键字正是这样做的：在需要的地方插入内存栅栏。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2011-07-17T15:40:29.330

volatile variable means that the value assinged to it is not constant, i.e if a function containing a volatile variable "a=10" and the function is adding 1 in each call of that function then it will always return updated value. `{ volatile int a=10; a++; }` when the above function is called again and again then the variable a will not be re-initialised to 10, it will always show the updated value till the program runs. 1st output= 10 then 11 then 12 and so on.

# wpf - 在 WPF 中恢复窗口位置和大小时出现漂移

> ID：346309
> 
> 赞同：1
> 
> 时间：2008-12-06T14:16:08.043
> 
> 标签：wpf, settings, window, location

我正在使用下面的代码在重新启动时保存和恢复窗口位置和大小。

**每次执行此代码**时，我都会观察到 28 个像素的向上漂移！

我是在读取错误的值，还是错误地恢复它们？数字 28（镀铬的大小？）来自哪里（我将如何以编程方式解释它，而不是代码中的固定数字）？

这是我的代码：

```
public partial class MainStudioWindowControl : RibbonWindow
{
    public MainStudioWindowControl()
    {
        App.MainWindowOwner = this;
        this.Loaded += new System.Windows.RoutedEventHandler(MainStudioWindowControl_Loaded);
    }

    void MainStudioWindowControl_Loaded(object sender, System.Windows.RoutedEventArgs e)
    {
        System.Windows.Window mainWindow = System.Windows.Application.Current.MainWindow;
        mainWindow.WindowStartupLocation = System.Windows.WindowStartupLocation.Manual;
        if (Studio.Properties.Settings.Default.Width > 0)
        {
            mainWindow.Left = Studio.Properties.Settings.Default.Left;
            mainWindow.Top = Studio.Properties.Settings.Default.Top;
            mainWindow.Width = Studio.Properties.Settings.Default.Width;
            mainWindow.Height = Studio.Properties.Settings.Default.Height;
        }
        Debug.WriteLine(string.Format("Loading: Top = {0}", this.Top));
    }

    protected override void OnClosing(System.ComponentModel.CancelEventArgs e)
    {
        base.OnClosing(e);
        System.Windows.Window mainWindow = System.Windows.Application.Current.MainWindow;
        Studio.Properties.Settings.Default.Left = mainWindow.Left;
        Studio.Properties.Settings.Default.Top = mainWindow.Top;
        Studio.Properties.Settings.Default.Width = mainWindow.Width;
        Studio.Properties.Settings.Default.Height = mainWindow.Height;
        Studio.Properties.Settings.Default.Save();
        Debug.WriteLine(string.Format("Saving: Settings.Top = {0}", Studio.Properties.Settings.Default.Top));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T15:56:49.540

试试这个：

1）从普通窗口派生你的类，而不是 RibbonWindow - 如果可以解决它，这是一个 RibbonWindow 问题。

2) 使用硬编码值在 Loaded 处理程序中设置测量值 - 如果可以修复它，则问题与设置有关。

通过这两个更改，它对我来说效果很好。窗口每次都出现在它应该出现的地方。

# .net - 如何使用 lambdas 和表达式树在 Linq 中进行联接？

> ID：346313
> 
> 赞同：9
> 
> 时间：2008-12-06T14:19:36.193
> 
> 标签：.net, linq-to-sql

我正在尝试使用 lambda 表达式在 Linq 中进行 JOIN ......并遇到了一些问题。

我有两个实体，Comments 和 CommentSources。CommentSources 与评论相关联。我有以下代码，它确实有效：

```
01 IQueryable<Data.Comment> query = ctx.DataContext.Comments;
02
03
04 if (criteria.IsDeleted == DeletedFilter.Deleted)
05    query = query.Where(row => row.DeletedBy != Guid.Empty);
06 else if (criteria.IsDeleted == DeletedFilter.NotDeleted)
07    query = query.Where(row => row.DeletedBy == Guid.Empty);
08
09 var data = query.Select(row => CommentInfo.FetchCommentInfo(row)); 
```

我需要加入 CommentSources on Comments on the field，如果可能的话，我想使用类似的东西：

```
01 query = query.Join(join code goes here) 
```

如何在表达式树中使用 lambdas 来做到这一点？

**还有一件事……如何在 Join 语句中添加 Where ？**

而不是问另一个问题......我将如何在该 Join 上执行 Where 子句？例如，我在 CommentSource 上有一个名为 SourceId 的字段，我想以此作为过滤依据。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-06T14:57:29.817

您需要指定五件事（至少）：

*   “外部”序列（评论）（这是隐含的第一个参数）
*   “内部”序列（CommentSource）
*   如何从 CommentSource 获取密钥
*   如何从评论中获取密钥
*   您希望 CommentSource/Comment 对的结果是什么

例如：

```
query = query.Join(ctx.DataContext.CommentSource,
                   comment => comment.CommentSourceId,
                   commentSource => commentSource.Id,
                   (comment, commentSource) 
                      => new { Comment=comment, CommentSource=commentSource }); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T15:31:02.057

这是我的最终代码：

```
 var query = ctx.DataContext.Comments.Join(ctx.DataContext.CommentSources,
                  c => c.CommentId, 
                  s => s.CommentId,
                  (c, s) => new {Comment = c, CommentSource = s});

            if (criteria.SourceId != null && criteria.SourceId != Guid.Empty)
                query = query.Where(row => row.CommentSource.SourceId == criteria.SourceId);

            if (criteria.IsDeleted == DeletedFilter.Deleted)
                query = query.Where(row => row.Comment.DeletedBy != Guid.Empty);
            else if (criteria.IsDeleted == DeletedFilter.NotDeleted)
                query = query.Where(row => row.Comment.DeletedBy == Guid.Empty);

            var data = query.Select(row => CommentInfo.FetchCommentInfo(row.Comment)); 
```

# x11 - Xorg 加载图像

> ID：346323
> 
> 赞同：2
> 
> 时间：2008-12-06T14:30:00.793
> 
> 标签：x11, xorg, window-managers

我开始编写自己的窗口管理器，想知道如何使用 xorg api 从原始图像数据（例如 libpng 给出的数据）中获取 Xorg Pixmap 或 Xorg 可绘制的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-09T00:58:36.860

自 2008 年以来，您可能在某个时候发现了这一点，但为了未来读者的利益……

XCreatePixmapFromBitmapData() 将文字位图（即 1 位，黑白）数据加载到像素图中。如果目标是从 PNG 加载，这很可能不是您想要的。

一种更新的方法是使用 Cairo 或 GdkPixbuf。老式的 Xlib API，例如 XCreatePixmapFromBitmapData() 和 XDrawWhatever() 几乎都已被弃用（并不是说它们实际上会被删除，但它们已经过时并且与现代应用程序的工作方式不同步）。

这些天人们通常建议做事的方式是：

*   更喜欢 libxcb 而不是 libX11，libxcb 只是 X 协议的一个非常薄的包装器，并且缺少执行多个 X 协议请求的调用（例如 CreatePixmapFromBitmapData 执行 CreatePixmap、CreateGC、PutImage、FreeGC）
*   比起服务器端绘图 API，更喜欢 cairo（或类似的库，Skia 就是其中之一）

如果您需要支持更多格式等，您可以使用 cairo_image_surface_create_from_png() 用于简单目的或 GdkPixbuf。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T16:14:17.290

XCreatePixmapFromBitmapData 应该这样做。请记住，您需要输入与 xserver 使用的位深度相同的数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-21T06:16:12.797

您必须使用 XCreateImage、XCreatePixmap 和 XCopyArea 进行一些操作。它有点像这样：

```
struct Image img = get_pixels_and_geometry_from_libpng("filename.png");
XImage *img = XCreateImage(/*5000 paremeters*/);
Pixmap pixmap = XCreatePixmap(dpy, img.width, img.height, 24);
XPutImage(dpy, pixmap, gc, 0, 0, img.width, img.height);
XCopyArea(dpy, pixmap, window, 0, 0, img.width, img.height, x, y); 
```

# visual-studio - 如何在 Visual Studio 2005 中添加 WCF 服务引用？

> ID：346329
> 
> 赞同：2
> 
> 时间：2008-12-06T14:40:01.863
> 
> 标签：visual-studio, wcf, visual-studio-2005

我需要什么才能让 Visual Studio 2005 将 WCF 服务引用添加到项目中？

我知道我应该只使用 Visual Studio 2008，但我正在为客户端还没有 VS2008 的“假设”情况做准备。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T20:01:42.807

如果您想要集成 Visual Studio 2005，他们必须至少安装 .net 3.0。然后客户端可以使用 svcutil.exe 生成代理。

在此处查看如何使用 orcas 扩展在 VS 2005 中使用 WCF：
[http ://www.15seconds.com/issue/061130.htm](http://www.15seconds.com/issue/061130.htm)

或者：
据我所知，MS 从未发布过用于 VS2005 的最终 WCF 插件，但最终的 CTP 仍然存在： http: [//downloads.z​​dnet.co.uk/0,1000000375,39328336s,00.htm](http://downloads.zdnet.co.uk/0,1000000375,39328336s,00.htm)

您可以使用该 WCF 插件代替 15 秒文章中提到的更通用和更多 beta orcas 扩展。我相信 CTP 会给你“添加服务参考”选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T15:41:49.680

在这种情况下，我认为您最好的选择可能是向客户端提供已经生成的代理类。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-01-02T18:53:49.403

以下是一篇文章，将引导您完成在 Visual Studio 2005 中创建 WCF 服务的所有必要步骤，包括如何添加必要的引用：

[http://tyblog.in/](http://tyblog.in/)

# unit-testing - 如何对依赖于许多其他类的类进行单元测试？

> ID：346345
> 
> 赞同：11
> 
> 时间：2008-12-06T14:57:11.063
> 
> 标签：unit-testing

我一直听说通过单元测试我们可以捕获代码中的大部分错误，我真的相信这是真的。但我的问题是在每个类都依赖于许多其他类的大型项目中，你如何对类进行单元测试？由于复杂性和编写存根所需的时间，将所有其他类都存根没有多大意义。您对此有何看法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-06T15:14:59.967

使用测试的部分优势在于它迫使您最小化依赖关系，从而创建可测试的代码。通过最小化依赖关系，您将提高代码的可维护性和可重用性，这两个都是非常理想的特性。

由于您将测试引入现有的代码库，因此您无疑会遇到许多难以测试的情况，这些情况需要重构才能正确测试。这种重构将增加代码的可测试性，同时减少依赖关系。

很难用测试来改造代码的原因是为什么许多人提倡遵循测试驱动开发。如果您先编写测试，然后编写代码以通过测试，则默认情况下您的代码将更具可测试性和解耦性。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T15:04:37.930

使用模拟框架为您的类存根。模拟框架（我在 C#/.NET 中使用 Rhino Mocks）可以很容易地去除你的依赖。与依赖注入一起使用，您的类可以很容易地与其他类分离，并且不需要太多工作就可以做到这一点。请注意，有时“伪造”某些东西确实比模仿更容易。我最终伪造了一些类，但通常这些类很容易编写——它们只包含“好”或“坏”数据并返回它。不涉及逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T15:03:27.340

我没有跟上整个单元测试的速度，但我认为每个单元都应该代表某种测试。一个测试用例应该测试一些程序。一个过程可能不限于单个类。

例如，如果您的应用程序可以分解为原子组件，那么每个组件以及组件之间的每个适用的转换链都可能存在一个测试用例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T15:05:50.393

在我们的项目中，开发人员从一开始就有责任编写和维护存根。

尽管存根需要时间和金钱，但单元测试提供了一些不可否认的优势（您也同意了）。它允许测试过程自动化，减少发现应用程序更复杂部分中包含的错误的难度，并且测试覆盖率通常会提高，因为对每个单元都给予了关注。

根据我的经验，我已经看到，在我们将单元测试置于低优先级的项目中，在后期阶段，单个更改要么会破坏事情，要么需要额外的测试。

单元测试增加了我作为软件开发人员的信心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T15:20:39.333

我更喜欢对功能进行单元测试，这些功能可能对应于个别类，也可能不对应。在我看来，这种单元测试的粒度在测试所需的工作、客户的反馈（因为功能是他们为之付出的代价）和单元测试的长期效用（体现需求）之间做出了更好的权衡，说明操作案例）

因此，很少需要模拟，但一些测试跨越多个类

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T16:58:23.503

> 但我的问题是在每个类都依赖于许多其他类的大型项目中，你如何对类进行单元测试？

首先，您明白“每个类都依赖于许多其他类”是一件坏事，对吗？而且这不是一个大型项目的功能，而是糟糕的设计？（这是 TDD 的好处之一，它倾向于阻止这种高度耦合的代码。）

> 由于复杂性和编写存根所需的时间，将所有其他类都存根没有多大意义。

更不用说它对设计问题没有帮助。更糟糕的是，对所有存根的投资实际上可能是重构的障碍，即使只是心理上的障碍。

一个更好的方法（恕我直言）是从内到外的类开始，你去改变设计。通常我会通过我所说的“内部依赖注入”来解决这个问题。这涉及保持方法签名不变，但从依赖项中提取所需的数据，然后提取保存实际逻辑的函数。一个简单的例子可能是：

```
public int foo(A a, B b) {
  C c = a.getC();
  D d = b.getD();

  Bar bar = calculateBar(c, d);

  return calculateFoo(bar, this.baz);
}

Bar calculateBar(C c, D d) {
  ...
}

int calculateFoo(Bar bar, Baz baz) {
  ...
} 
```

现在我可以为 calculateBar 和 calculateBaz 编写一个测试，但我不需要担心设置内部状态（this.baz），也不需要担心创建 A 和 B 的模拟版本。

在使用现有接口创建这样的测试之后，我寻找机会将更改推送到接口，例如将 Foo 方法更改为采用 C 和 D 而不是 A 和 B。

这有什么意义吗？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-06T17:06:40.930

你是对的，对你要测试的类所依赖的所有类进行存根是不值得的。如果您更改接口，您也必须维护您的模拟。

如果您正在测试的类使用的类已经过测试，那么可以进行跨越多个类的测试。

有时模拟一个对象更简单：当

*   对象是或使用外部资源，例如数据库或网络连接、磁盘
*   对象是一个 GUI
*   对象 [尚未] 可用
*   对象行为不是确定性的
*   对象的设置成本很高

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-04T14:41:56.917

我觉得您可能需要重构以降低复杂性。

我发现重构类（即分解它们）非常有帮助，因此每个类都有一个单一的职责（不太复杂）。然后你可以对这个职责进行单元测试。您可以使用模拟框架轻松地模拟和初始化依赖项。我发现[FakeItEasy](https://github.com/FakeItEasy/FakeItEasy)非常好且易于使用，您可以找到很好的示例

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-12-12T01:31:22.707

以下是对我们非常有用的可测试性原则，也适用于大型企业项目中的健壮设计：

1.  通过类构造函数使依赖项显式化。

2.  与其将具体类作为依赖项，不如创建定义所需功能的接口，并将这些接口作为类构造函数的依赖项。如果需要，这也允许您应用依赖注入模式。

3.  使用像 Moq 这样的现有框架之一，因此您不需要编写接口的完整测试实现，但在运行时您可以从单元测试内部创建 Moq 对象。

# c - 学生成绩练习不起作用

> ID：346349
> 
> 赞同：1
> 
> 时间：2008-12-06T15:00:41.480
> 
> 标签：c

我想创建一个程序，向用户请求 10 个等级，然后过滤它们以通过和失败，然后打印通过和失败的数量。我做了这个程序，但输出是错误的。

```
int pass,fail,grade,studentcounter;

pass=0;
fail=0;
grade=0;
studentcounter=10;

while (studentcounter!=0)
{

    printf("enter the next grade\n");
    scanf("%d",grade);
    student--;
}

switch (grade)
{
case 1:
    if (grade >= 50)
        pass++;
    break;
case 2:
    if (grade <= 49)
        fail++;
    break;
}

}
printf("the number of fail is %d",fail);
printf("the number of pass is %d",pass);

} 
```

问题是程序要求十个等级，但最后它会将失败的数量和通过的数量打印为零。为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T15:04:29.023

您正在输入一个年级编号。一个 switch 语句测试该案例的评分，我很确定评分不是 1% 或 2%。在这种情况下，if 语句将是更合乎逻辑的选择。

其次，您有一个从未使用过的代码块。首先将 studentcounter 设置为零，然后说“仅在 ​​studentcounter 不为零时执行此块”...

```
studentcounter=0;

while (studentcounter!=0) {

printf("enter the next grade\n");

scanf("%d",grade);

student--;

} 
```

第三个问题是，你拼错了grade。

你可以重写你的代码如下：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
int pass,fail,grade,studentcounter;

pass=0;
fail=0;
grade=0;
studentcounter=0;

while (studentcounter < 10) {

printf("enter the next grade:\n");

scanf("%d",&grade);

if (grade >= 50) {
    pass++;
} else {
    fail++;
}

studentcounter++;
}

printf("the number of fail is: %d \n",fail);
printf("the number of pass is: %d \n",pass);
return 0;
} 
```

对不起，如果我忽略了什么；我没有时间把它扔给我的编辑器：P

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T15:03:22.737

您需要在 while 循环中保留通过/失败的计数，等级变量将在每次输入时被覆盖。

编辑：另外，不要使用 switch 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T15:15:22.667

好的，所提供的代码是一堆废话。我将把它作为练习留给你来整理我为你修复的内容：

```
#include <stdio.h>

int main(int argc, char *argv[])
{
    int pass = 0;
    int fail = 0;
    int grade= 0;
    int studentcounter;

    for (studentcounter=1; studentcounter<=10; studentcounter++ )
    {
        printf("Enter grade for student #%-2d  :", studentcounter);
        scanf("%d",&grade);

        if(grade >=50)
            pass++;

        if(grade<=49)
            fail++;
    }
    printf("the number of fail is %d\n",fail);
    printf("the number of pass is %d\n",pass);
} 
```

PS。如果这是作业，请在上交时给予表扬。通过查看其他人的代码，您可以学到很多东西，但永远不要声称创建了您没有创建的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T16:08:23.917

C 'case' 语句不能按您期望的方式工作。

它们对“常量表达式”进行操作，这意味着为了完成您给出的任务，“确定成绩是通过还是失败”，必须编写一个复杂的 switch 语句，其形式为

```
  开关（等级）
  {
    案例 100：
    案例 99：
    案例 98：
    案例 97：
    案例 96：
    案例 95：
    案例 94：
    案例 93：
    案例 92：
    案例 91：
    案例 90：
    案例 89：
    案例 88：
    案例 87：
    案例 86：
    案例 85：
    案例 84：
    案例 83：
    案例 82：
    案例 81：
    案例80：
    案例 79：
    案例 78：
    案例 77：
    案例 76：
    案例 75：
    案例 74：
    案例 73：
    案例 72：
    案例 71：
    案例 70：
    案例 69：
    案例 68：
    案例 67：
    案例 66：
    案例 65：
    案例 64：
    案例 63：
    案例 62：
    案例 61：
    案例60：
    案例 59：
    案例 58：
    案例 57：
    案例 56：
    案例 55：
    案例 54：
    案例 53：
    案例 52：
    案例 51：
    案例50：
      通过++；    
      休息;
    默认：
      失败++；    
      休息;
  }

```

这可能会给你正确的答案，但是，你可能会因为写出这样的怪物而在作业中收到“失败”。

我会尝试考虑另一个具有“while、switch 和 if”语句的问题，或者您可以修改您当前的程序，使其不接受 10 个等级，而是提示用户是否希望输入另一个等级并只接受回答“Y”、“y”或“N”、“n”，因此“切换”该答案以继续。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T16:35:14.580

顺便说一句，有一种解决方案以合理的方式使用“开关”。我不会讨论这种方法的优点/缺陷或“C”语言的奥秘，但只是为了证明它是可能的，这里是：

```
#include <stdio.h>

诠释主要（无效）
{   
    int 通过、失败、评分、答案、学生计数器；

    通过 = 0;
    失败=0；
    等级=0；
    学生计数器 = 10;

    而（学生柜台——）
    {

        printf("进入下一年级\n");    
        scanf("%d", &grade);
        答案 = ( 等级 > 49 );
        开关（答案）
        {
            情况1：
                通过++；
                休息;
            默认：
                失败++；
                休息;
        }

    }

    printf("失败次数为 %d \n", fail);
    printf("通过次数为 %d \n", pass);
}

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-17T09:50:37.793

嗯，因为你必须使用 swicth，所以我建议如下：保留一个变量来检查等级是否超过 50，然后在 switch 中使用这个变量：

* * *

```
char pass_fail = (grade >= 50)? y : n;
switch( pass_fail )
{
case 'y': 
     // print pass
     break;
case 'n':
    // print fail
    break;
} 
```

* * *

希望这对你有帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-11T05:18:41.093

2个错误：

1：while 循环应该在 switch 语句之后结束。
2：您的变量名称是“studentcounter”，但您正在递减“student”。
检查以下代码。这应该有效。

```
void main()
{
    int pass,fail,grade,studentcounter;

    pass=0;
    fail=0;
    grade=0;
    studentcounter=10;

    while (studentcounter!=0)
    {
        printf("enter the next grade\n");
        scanf("%d",grade);
        studentcounter--;

        switch (grade)
        {
            case 1:
                if (grade >= 50)
                    pass++;
                break;
            case 2:
                if (grade <= 49)
                    fail++;
                break;
        }

    }
    printf("the number of fail is %d",fail);
    printf("the number of pass is %d",pass);

} 
```

# vb6 - VB6 (erk) - 内联函数？

> ID：346351
> 
> 赞同：1
> 
> 时间：2008-12-06T15:01:41.913
> 
> 标签：vb6, inline-functions

我将 VB6 用于应用程序。

是否可以强制编译器内联函数？

或者有没有实现相同功能的插件？

我的代码中有一个安全部分，我想让它难以破解，方法是在使用它的每个点重复代码，而不是作为函数列出一次。

希望有人能回答我的问题！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T15:33:43.690

IMO，如果这是您作为安全措施所做的事情，那么您遇到的问题比让 VB 内联您的功能更大。而且我认为VB6中没有任何规定可以做到这一点。而且我倾向于认为这种技术会使破解您的代码变得更容易，因为您会看到相同的非常重要的功能一遍又一遍地重复......对不起:-(

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-08T13:26:22.760

不支持内联函数。但是，有几件事对您有利。

由于历史上市场上缺乏反编译器，VB6 是出了名的难以反编译。结果对于试图恢复丢失的源代码或破解 VB6 的人来说没有多大用处。

但...

如果您使用的是 ActiveX DLL，那么编写兼容 DLL 的人很容易破解您的软件。我的公司发现处理此问题的最佳方法是使关键对象公开不可创建并交换打包的二进制数据。

公共不可创建可防止某人引用 DLL，创建该对象的实例，然后运行测试以查看您在做什么。二进制数据是为了掩盖您正在交换的数据。

在您查看有关 COM 的文献中，有更安全的方法来处理这些问题，但这些都是您可以做的简单的事情，使 ActiveX 应用程序更难破解。

我公司的目标不是让某人无法破解我们的软件，而是让它变得足够困难，以使我们的竞争对手与我们打交道的成本更低，而不是试图破解我们的系统（CAD/CAM 系统）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T16:01:56.643

正如戴夫所说，VB 编译器不支持该功能。

如果您真的想要这样做，为什么不在您的代码副本上运行搜索和替换并构建该副本。在命令行上执行此操作应该不会太困难。

# solaris - prstat 输出中 SIZE 和 RSS 值的含义

> ID：346352
> 
> 赞同：8
> 
> 时间：2008-12-06T15:02:03.707
> 
> 标签：solaris, virtual-memory

有人可以对我们从 Solaris 中的 prstat 获得的 SIZE 和 RSS 值的含义给出一些明确的解释吗？

我编写了一个测试 C++ 应用程序，它用 分配内存`new[]`、填充它并用`delete[]`.

据我了解，SIZE 值应该与进程“保留”多少虚拟内存有关，即内存“分配”或“新”。

除非我真的使用它（填充一些值），否则该内存不会汇总在 RSS 值中。但是，即使我释放内存，RSS 也不会下降。

我不明白我可以正确分配给这两个值的语义。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-01-07T21:03:02.413

RSS 是（AFAIK 可靠）表示一个进程正在使用多少物理内存。使用 Solaris 默认内存分配器，释放内存不会对 RSS 做任何事情，因为它只是更改一些指针和值以告知内存可以自由重用。如果您不通过再次分配来再次使用该内存，它最终将被分页并且 RSS 将下降。

如果您希望释放的内存在释放后立即返回，可以使用 Solaris mmap 分配器，如下所示：

```
export LD_PRELOAD=libumem.so
export UMEM_OPTIONS=backend=mmap 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T18:25:59.427

**Size**是进程的总虚拟内存大小，包括所有映射的文件和设备，**RSS**应该是驻留集大小，但完全不可靠，您应该尝试从**pmap**获取该信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-08T16:11:23.180

作为一般规则，一旦将内存分配给进程，它就永远不会归还给操作系统。在 Unix 系统上，sbrk() 调用用于扩展进程地址空间，并且没有类似的调用可以朝另一个方向前进。

# linux - 如何从 Linux 内核进行 UDP 广播？

> ID：346361
> 
> 赞同：3
> 
> 时间：2008-12-06T15:09:33.597
> 
> 标签：linux, networking, module, kernel

我正在开发一个实验性的**Linux 内核模块**，所以......

如何从 Linux 内核进行**UDP 广播？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T20:26:45.737

-13 是 -EACCES。你有 SO_BROADCAST 设置吗？如果未设置 SO_BROADCAST 并且您要发送到广播地址，我相信 sock_sendmsg 会返回 -EACCES 。

* * *

您正在寻找 <errno.h> 的错误代码。

* * *

你在什么内核版本下开发？我想简要浏览一下内核源代码。我没有看到如何从 sock_set 返回 -ENOPKG，但我确实看到可以返回 -ENOPROTOOPT（在内核 2.6.27 中是 errno 92）。

哦——如果你愿意的话，可以在你设置 SO_BROADCAST 的地方重新发布那段代码。我没有记下它，我想再看一遍。

* * *

尝试使用 SOL_UDP 调用它。我*想*这就是你要找的。我在任何地方都没有 2.6.18 构建环境设置来玩这个，但试一试。

不——没关系——这不会做你想做的事。我应该在源代码中进一步阅读。我会继续寻找。这有点有趣。

* * *

我想你可以自己设置广播标志！ *微笑*

```
lock_sock(sock->sk);
sock->sk->broadcast = 1;
release_sock(sock->sk); 
```

* * *

你把我难住了，我得去睡觉了。我确实发现了这段代码可能会有所帮助，尽管这些人没有进行广播。

[http://kernelnewbies.org/Simple_UDP_Server](http://kernelnewbies.org/Simple_UDP_Server)

祝你好运——我希望我能为你解决它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T20:29:59.817

@调整器..

事实上，我刚刚得到它。当我设置`SO_BROADCAST`时，我收到 92（未安装包）

那我应该安装什么包呢？

* * *

编辑：内核版本是 2.6.18，你是对的！92 是`ENOPROTOOPT`

```
//Socket creation
sock_create(AF_INET, SOCK_DGRAM, IPPROTO_UDP, &sock);

//Broadcasting
int broadcast = 1;
int err;

if( (err = sock->ops->setsockopt(sock, SOL_SOCKET, SO_BROADCAST, (char *)&broadcast, sizeof broadcast)) < 0 )
{
    printk(KERN_ALERT MODULE_NAME ": Could not configure broadcast, error %d\n", err);
    return -1;
} 
```

* * *

编辑：我从`setsockopt` [手册页](http://linux.die.net/man/2/setsockopt)得到了这个......

> **`ENOPROTOOPT`**
> 该选项在指示的级别上是未知的。

...所以，我认为这`SOL_SOCKET`不是正确的传递值。我也尝试过`IPPROTO_UDP`，而不是`SOL_SOCKET`没有运气。

* * *

编辑： http: [//docs.hp.com/en/32650-90372/ch02s10.html](http://docs.hp.com/en/32650-90372/ch02s10.html)说这`SO_BROADCAST`是`SOL_SOCKET`级别的一个选项，但我继续得到-92

* * *

编辑：我很绝望，所以我试过`SOL_UDP`了，还是-92。
是的，这很有趣:) ...良好的协同作用！最后（我希望我们能尽快到达那里）让我们组装一个干净而漂亮的明确答案！:)

* * *

编辑：即使硬设置广播标志，`sock_sendmsg`也会失败（-13，“权限被拒绝”）

```
sock->sk->sk_flags |= SO_BROADCAST; 
```

我真的需要一些帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T20:14:30.660

嗯，我希望我有更多的时间来帮助你。

为了让 UDP 多播工作，它必须被嵌入到你的内核中。您必须在配置内核时启用它。谷歌应该有更多信息；我希望这能让你走上正确的道路。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-09T21:53:31.097

查看 Linux 内核中的 IPVS（linux 虚拟服务器）代码。它已经有一个 UDP 多播的工作实现，它用于共享连接状态以进行故障转移。

已经看过这个并且知道一些人已经这样做了，我真的建议创建一个 netfilter 链接并使用用户空间守护程序通过网络广播信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-22T10:38:53.477

以下对我有用（所以最后这个线程可以关闭）。

```
int yes = 1;
sock_setsockopt(sock, SOL_SOCKET, SO_BROADCAST, &yes, sizeof(yes));

sock->ops->connect(sock, (struct sockaddr *)&addr, sizeof(struct sockaddr), 0); 
```

这里*sock*是一个初始化的*struct socket*并且 addr 应该是*struct sockaddr_in*里面有一个广播地址。

# xslt - xsl:apply-templates 如何只匹配我定义的模板？

> ID：346362
> 
> 赞同：25
> 
> 时间：2008-12-06T15:10:46.093
> 
> 标签：xslt

我有几个模板匹配 xml 文档中的各个节点。如果我只做一个
<xsl:apply-templates/> 它会以某种方式递归地输出下面所有节点的文本。我只是希望它递归地匹配我定义的任何模板。我怎么做 ？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-06T16:24:06.287

> 这是因为 XSLT 中的内置模板。XSLT 有几个内置模板，它们说：
> 
> *   当您将模板应用于元素时，处理其子元素
> *   当您将模板应用于文本节点时，请给出其值
> 
> 总之，这意味着如果您将模板应用到一个元素但没有该元素的显式模板，那么它的内容会被处理，最终您会得到该元素包含的文本。

在此处阅读完整说明：[http ://www.dpawson.co.uk/xsl/sect2/defaultrule.html](http://www.dpawson.co.uk/xsl/sect2/defaultrule.html)

您可以通过定义自己的模板来覆盖文本节点的默认模板，让它什么都不做。

```
<xsl:template match="text()" /> 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-12-06T17:53:44.623

这可能是即使是有经验的 XSLT 程序员也遇到过的最常见的问题。

观察到的行为正是符合 XSLT 的处理器应该如何表现。

考虑到：

    `<xsl:apply-templates/>`

是以下的缩写：

    `<xsl:apply-templates select="child::node()"/>`

以及**内置模板规则**的存在。根据[**XSLT 1.0 规范**](http://www.w3.org/TR/xslt#built-in-rule)：

" **5.8 内置模板规则**

有一个内置的模板规则允许递归处理在样式表中的显式模板规则没有成功模式匹配的情况下继续进行。此模板规则适用于元素节点和根节点。下面显示了内置模板规则的等效项：

```
<xsl:template match="*|/">
  <xsl:apply-templates/>
</xsl:模板>

```

每种模式还有一个内置的模板规则，它允许递归处理在样式表中的显式模板规则没有成功模式匹配的情况下以相同的模式继续。此模板规则适用于元素节点和根节点。下面显示了模式 m 的内置模板规则的等效项。

```
<xsl:template match="*|/" mode="m">
  <xsl:apply-templates mode="m"/>
</xsl:模板>
```

还有一个用于复制文本的文本和属性节点的内置模板规则：

```
<xsl:template match="text()|@*">
  <xsl:value-of select="."/>
</xsl:模板>

```

处理指令和注释的内置模板规则是什么都不做。

```
<xsl:template match="处理指令()|comment()"/>

```

命名空间节点的内置模板规则也是什么都不做。没有可以匹配命名空间节点的模式；因此，内置模板规则是唯一适用于命名空间节点的模板规则。

**内置模板规则**被视为在样式表之前隐式导入，因此**其导入优先级**低于所有其他模板规则。因此，作者可以通过包含显式模板规则**来覆盖内置模板规则“**

--- XSLT 规范引用结束 ---

**因此，如果作者想要完全控制 XSLT 处理，他们应该覆盖所有内置模板**。

例如，如果我们不想将`text()`节点复制到输出，我们可以通过以下方式覆盖内置模板来忽略它们：

    `<xsl:template match="text()" />`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T15:34:49.600

您可以设置一个模式以仅应用您自己的模板：

```
<xsl:template match="* | /" >
    <xsl:apply-templates mode="myMode" />
</xsl:template>

<xsl:template match="somenode" mode="myMode">
  <!-- do something here -->
</xsl:template> 
```

另一种选择是覆盖内置模板规则（参见例如[http://unix.com.ua/orelly/xml/xmlnut/ch08_07.htm](http://unix.com.ua/orelly/xml/xmlnut/ch08_07.htm)）

# c# - 为什么 yield return 不能出现在带有 catch 的 try 块中？

> ID：346365
> 
> 赞同：109
> 
> 时间：2008-12-06T15:14:35.897
> 
> 标签：c#, exception, yield

以下是可以的：

```
try
{
    Console.WriteLine("Before");

    yield return 1;

    Console.WriteLine("After");
}
finally
{
    Console.WriteLine("Done");
} 
```

`finally`当整个事情完成执行时，该块运行（`IEnumerator<T>`支持`IDisposable`提供一种方法来确保这一点，即使枚举在它完成之前被放弃）。

但这不行：

```
try
{
    Console.WriteLine("Before");

    yield return 1;  // error CS1626: Cannot yield a value in the body of a try block with a catch clause

    Console.WriteLine("After");
}
catch (Exception e)
{
    Console.WriteLine(e.Message);
} 
```

假设（为了论证）`WriteLine`try 块内的一个或其他调用引发了异常。继续执行`catch`块有什么问题？

当然，yield return 部分（当前）无法抛出任何东西，但是为什么这会阻止我们使用封闭的`try`/`catch`来处理在 a 之前或之后抛出的异常`yield return`呢？

**更新：这里有**[来自 Eric Lippert](https://web.archive.org/web/20080818052536/http://blogs.msdn.com/oldnewthing/archive/2008/08/14/8862242.aspx)的有趣评论- 似乎他们在正确实施 try/finally 行为时已经遇到了足够多的问题！

编辑：有关此错误的 MSDN 页面是：http: [//msdn.microsoft.com/en-us/library/cs1x15az.aspx](http://msdn.microsoft.com/en-us/library/cs1x15az.aspx)。但是，它没有解释原因。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-06T21:07:02.020

我怀疑这是一个实用性问题，而不是可行性问题。我怀疑这个限制*实际上是*一个无法解决的问题非常非常少 - 但是编译器中增加的复杂性将非常重要。

我已经遇到过一些这样的事情：

*   属性不能通用
*   X 无法从 XY 派生（X 中的嵌套类）
*   在生成的类中使用公共字段的迭代器块

在每一种情况下，都可以获得更多的自由，但代价是编译器的额外复杂性。团队做出了务实的选择，为此我为他们鼓掌——我宁愿使用一种限制性稍强的语言，编译器的准确率达到 99.9%（是的，有错误；前几天我在 SO 上遇到了一个），而不是更多无法正确编译的灵活语言。

编辑：这是一个伪证明，说明它为什么可行。

考虑一下：

*   您可以确保 yield return 部分本身不会引发异常（预先计算值，然后您只是设置一个字段并返回“true”）
*   您可以在迭代器块中不使用 yield return 的 try/catch。
*   迭代器块中的所有局部变量都是生成类型中的实例变量，因此您可以自由地将代码移动到新方法中

现在变换：

```
try
{
    Console.WriteLine("a");
    yield return 10;
    Console.WriteLine("b");
}
catch (Something e)
{
    Console.WriteLine("Catch block");
}
Console.WriteLine("Post"); 
```

进入（某种伪代码）：

```
case just_before_try_state:
    try
    {
        Console.WriteLine("a");
    }
    catch (Something e)
    {
        CatchBlock();
        goto case post;
    }
    __current = 10;
    return true;

case just_after_yield_return:
    try
    {
        Console.WriteLine("b");
    }
    catch (Something e)
    {
        CatchBlock();
    }
    goto case post;

case post;
    Console.WriteLine("Post");

void CatchBlock()
{
    Console.WriteLine("Catch block");
} 
```

唯一的重复是设置 try/catch 块 - 但这是编译器当然可以做的事情。

我很可能在这里错过了一些东西 - 如果是这样，请告诉我！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-06T16:15:59.360

迭代器定义中的所有`yield`语句都转换为状态机中的状态，该状态机有效地使用`switch`语句来推进状态。如果它*确实*`yield`为try/catch 中的语句生成代码，则必须为*每个*语句复制块中的*所有内容*，同时排除该块的所有其他语句。这并不总是可能的，特别是如果一个语句依赖于较早的语句。`try` *`yield``yield``yield`*

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-07T00:38:43.917

我已经接受了 THE INVINCIBLE SKEET 的回答，直到微软的某个人来给这个想法泼冷水。但我不同意意见问题——当然，正确的编译器比完整的编译器更重要，但 C# 编译器已经非常聪明地为我们整理出这种转换。在这种情况下，更完整一点将使语言更易于使用、教学、解释，并减少边缘情况或陷阱。所以我认为付出额外的努力是值得的。雷德蒙德的一些人会在两周内摸不着头脑，因此在接下来的十年中，数以百万计的程序员可以放松一点。

（我还怀有一种肮脏的愿望，希望有一种方法可以`yield return`通过驱动迭代的代码“从外部”填充到状态机中的异常抛出。但我想要这个的原因非常模糊。）

实际上，我对 Jon 的回答的一个疑问是与 yield return 表达式抛出有关。

显然 yield return 10 还不错。但这会很糟糕：

```
yield return File.ReadAllText("c:\\missing.txt").Length; 
```

那么在前面的 try/catch 块中评估这个不是更有意义吗：

```
case just_before_try_state:
    try
    {
        Console.WriteLine("a");
        __current = File.ReadAllText("c:\\missing.txt").Length;
    }
    catch (Something e)
    {
        CatchBlock();
        goto case post;
    }
    return true; 
```

下一个问题将是嵌套的 try/catch 块并重新抛出异常：

```
try
{
    Console.WriteLine("x");

    try
    {
        Console.WriteLine("a");
        yield return 10;
        Console.WriteLine("b");
    }
    catch (Something e)
    {
        Console.WriteLine("y");

        if ((DateTime.Now.Second % 2) == 0)
            throw;
    }
}
catch (Something e)
{
    Console.WriteLine("Catch block");
}
Console.WriteLine("Post"); 
```

但我确信这是可能的......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T15:43:20.643

我推测，由于当您从枚举器中产生返回时调用堆栈被缠绕/解开的方式，try/catch 块实际上不可能“捕获”异常。（因为 yield return 块不在堆栈上，即使他发起了迭代块）

为了了解我正在谈论的内容，使用该迭代器设置一个迭代器块和一个 foreach。检查调用堆栈在 foreach 块中的样子，然后在迭代器 try/finally 块中检查它。

# mysql - 使用 MinGw 构建 32 位 Qt Mysql 插件失败

> ID：346369
> 
> 赞同：0
> 
> 时间：2008-12-06T15:15:44.117
> 
> 标签：mysql, windows, qt, qt4, mingw

我正在为 Qt 4.4.3 开源版（[Qt 文档](http://doc.trolltech.com/4.4/sql-driver.html#building-the-plugins-manually)）构建一个 MySQL 插件，并使用命令：

```
cd %QTDIR%\src\plugins\sqldrivers\mysql
qmake "INCLUDEPATH+=C:\MySQL\include" "LIBS+=C:\MYSQL\MySQL Server <version>\lib\opt\libmysql.lib" mysql.pro
make 
```

我设法使用 64 位 MySQL 开发文件（使用 nmake）将它构建到我的 64 位 Qt 上。但是，32 位构建（使用 mingw-make）失败并出现链接问题：

```
Creating library file: c:\Coding\Qt\4.4.3\plugins\sqldrivers\libqsqlmysqld4.a
tmp/obj/debug_shared/qsql_mysql.o(.text+0x10d): In function `Z5codecP8st_mysql':
...lots of same stuff... 
```

MySQL 5.1 32 位和 64 位库安装的 dev 文件也不同：64 位包括 libmysql.dll 和六个 .lib 文件，而 32 位包括这些**加上**六个 .pdb 文件。与这个问题有关吗？

是否有人能够使用 MySQL 5.1 构建带有 Qt 4.4.3/MinGW 的 32 位插件？建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-19T10:59:57.247

使用 mysql-noinstall-5.1.14-beta-win32

# unit-testing - 伪造，嘲笑和存根之间有什么区别？

> ID：346372
> 
> 赞同：840
> 
> 时间：2008-12-06T15:17:46.203
> 
> 标签：unit-testing, mocking, language-agnostic, terminology, definition

我知道我如何使用这些术语，但我想知道是否有公认的**faking**、**mocking**和**stubbing**定义用于单元测试？你如何为你的测试定义这些？描述您可能使用每种情况的情况。

以下是我如何使用它们：

**Fake**：实现了接口但包含固定数据且没有逻辑的类。根据实现简单地返回“好”或“坏”数据。

**Mock**：一个实现接口并允许动态设置值以返回/异常以从特定方法抛出的能力并提供检查特定方法是否已调用/未调用的能力的类。

**Stub**：类似于模拟类，只是它不提供验证方法是否已被调用/未调用的能力。

模拟和存根可以手动生成或由模拟框架生成。假类是手工生成的。我主要使用模拟来验证我的类和依赖类之间的交互。一旦我验证了交互并通过我的代码测试备用路径，我就会使用存根。我主要使用假类来抽象出数据依赖关系，或者当模拟/存根太繁琐而无法每次设置时。

* * *

## 回答 #1

> 赞同：623
> 
> 时间：2008-12-06T16:17:52.617

你可以得到一些信息：

## 来自[Martin Fowler 关于 Mock 和 Stub](http://www.martinfowler.com/articles/mocksArentStubs.html)

**假**对象实际上有工作实现，但通常采取一些捷径，这使得它们不适合生产

**存根**为测试期间拨打的电话提供预设答案，通常根本不响应任何超出测试程序的内容。存根还可以记录有关呼叫的信息，例如记住它“发送”的消息的电子邮件网关存根，或者可能只记录它“发送”的消息的数量。

**模拟**就是我们在这里讨论的内容：预先编程的对象具有期望，这些期望形成了它们期望接收的调用的规范。

## 从[xunitpattern](http://xunitpatterns.com)：

**Fake**：我们获取或构建了一个非常轻量级的实现，该实现与 SUT 所依赖的组件所提供的功能相同，并指示 SUT 使用它而不是真实的。

**存根**：此实现被配置为响应来自 SUT 的调用，其值（或异常）将在 SUT 中执行未经测试的代码（请参阅第 X 页的生产错误）。使用测试存根的一个关键指标是由于无法控制 SUT 的间接输入而导致出现未经测试的代码

**模拟对象**，它实现与 SUT（被测系统）所依赖的对象相同的接口。当我们需要进行行为验证时，我们可以使用模拟对象作为观察点，以避免由于无法观察 SUT 上调用方法的副作用而导致出现未经测试的需求（请参阅第 X 页的生产错误）。

## 亲自

我尝试通过使用来简化：Mock and Stub。当它是一个返回设置为测试类的值的对象时，我使用 Mock。我使用 Stub 来模拟要测试的接口或抽象类。事实上，你怎么称呼它并不重要，它们都是在生产中不使用的类，并且用作测试的实用程序类。

* * *

## 回答 #2

> 赞同：259
> 
> 时间：2011-03-03T11:45:01.110

**存根**- 为方法调用提供预定义答案的对象。

**模拟**- 您设定期望的对象。

**Fake** - 具有有限功能的对象（用于测试目的），例如伪造的 Web 服务。

Test Double 是 stubs、mock 和 fakes 的总称。但非正式地，你会经常听到人们简单地称他们为嘲笑者。

* * *

## 回答 #3

> 赞同：113
> 
> 时间：2015-10-25T18:03:35.553

我很惊讶这个问题已经存在了这么久，而且还没有人根据[Roy Osherove 的“单元测试的艺术”](https://rads.stackoverflow.com/amzn/click/com/1617290890)提供答案。

在“3.1 介绍存根”中将存根定义为：

> 存根是系统中现有依赖项（或协作者）的可控替换。通过使用存根，您可以在不直接处理依赖关系的情况下测试您的代码。

并将存根和模拟之间的区别定义为：

> 关于模拟与存根，要记住的主要一点是，模拟就像存根一样，但是你断言模拟对象，而你不断言存根。

Fake 只是用于存根和模拟的名称。例如，当您不关心存根和模拟之间的区别时。

Osherove 区分 stub 和 mock 的方式意味着，任何用作测试的假的类都可以是 stub 或 mock。它用于特定测试完全取决于您如何在测试中编写检查。

*   当您的测试检查被测类中的值时，或者实际上是除了假货之外的任何地方，假货被用作存根。它只是提供值供被测类使用，要么直接通过调用返回的值，要么间接通过调用它的结果（在某些状态下）引起副作用。
*   当您的测试检查假货的值时，它被用作模拟。

将 FakeX 类用作存根的测试示例：

```
const pleaseReturn5 = 5;
var fake = new FakeX(pleaseReturn5);
var cut = new ClassUnderTest(fake);

cut.SquareIt;

Assert.AreEqual(25, cut.SomeProperty); 
```

该`fake`实例用作存根，因为`Assert`根本不使用`fake`。

测试类 X 用作模拟的测试示例：

```
const pleaseReturn5 = 5;
var fake = new FakeX(pleaseReturn5);
var cut = new ClassUnderTest(fake);

cut.SquareIt;

Assert.AreEqual(25, fake.SomeProperty); 
```

在这种情况下，`Assert`检查 上的值`fake`，使该假成为模拟。

当然，这些例子是高度人为的，但我认为这种区别有很大的优点。它让你知道你是如何测试你的东西的，以及你的测试的依赖关系在哪里。

我同意奥舍罗夫的观点

> 从纯粹的可维护性的角度来看，在我的测试中使用模拟比不使用它们会产生更多的麻烦。这是我的经验，但我总是在学习新的东西。

反对虚假是你真正想要避免的事情，因为它使你的测试高度依赖于一个根本不是被测试的类的实现。这意味着类的测试`ActualClassUnderTest`可能会因为实现的`ClassUsedAsMock`改变而开始中断。这给我带来了难闻的气味。测试`ActualClassUnderTest`最好只在`ActualClassUnderTest`更改时才中断。

我意识到针对虚假编写断言是一种常见的做法，尤其是当您是 TDD 订阅者的 mockist 类型时。我想我在古典主义阵营中坚定地支持 Martin Fowler（参见[Martin Fowler 的“Mocks are not Stubs”](http://martinfowler.com/articles/mocksArentStubs.html)），并且像 Osherove 一样尽可能避免交互测试（这只能通过对假货进行断言来完成）。

为了有趣地阅读为什么你应该避免这里定义的模拟，谷歌搜索“fowler mockist classicist”。你会发现很多意见。

* * *

## 回答 #4

> 赞同：69
> 
> 时间：2019-03-06T19:05:28.267

正如投票率最高的答案所提到的，Martin Fowler 在[Mocks Aren't Stubs](http://www.martinfowler.com/articles/mocksArentStubs.html)中讨论了这些区别，特别是副标题[The Difference Between Mocks and Stubs](https://www.martinfowler.com/articles/mocksArentStubs.html#TheDifferenceBetweenMocksAndStubs)，因此请务必阅读该文章。

与其关注*这些*事物的不同之处，我认为关注*为什么*这些是不同的概念会更有启发性。每一个都是为了不同的目的而存在的。

## 假货

**fake**是一种行为“自然”但不是“真实”的实现。这些都是模糊的概念，所以不同的人对什么是假的有不同的理解。

伪造的一个例子是内存数据库（例如使用带有`:memory:`存储的sqlite）。你永远不会将它用于生产（因为数据没有持久化），但它完全可以作为在测试环境中使用的数据库。它也比“真正的”数据库轻得多。

再举一个例子，也许您在生产中使用某种对象存储（例如 Amazon S3），但在测试中您可以简单地将对象保存到磁盘上的文件中；那么您的“保存到磁盘”实现将是假的。（或者你甚至可以通过使用内存文件系统来伪造“保存到磁盘”操作。）

作为第三个示例，想象一个提供缓存 API 的对象；实现正确接口但根本不执行缓存但总是返回缓存未命中的对象将是一种假的。

**伪造的目的*不是*影响被测系统的行为**，而是*简化*测试的实现（通过删除不必要的或重量级的依赖项）。

## 存根

**存根**是一种行为“不自然”的实现。它被预先配置（通常由测试设置）以响应具有特定输出的特定输入。

**存根的目的是让您的被测系统进入特定状态。**例如，如果您正在为与 REST API 交互的某些代码编写测试，您可以使用始终返回预设响应或以特定错误响应 API 请求的 API来*存根REST API。*这样你就可以编写测试来断言系统如何对这些状态做出反应；例如，测试您的用户在 API 返回 404 错误时得到的响应。

存根通常被实现为仅响应您告诉它响应的确切交互。但是，使某个东西成为存根的关键特性是它的*目的*：存根就是设置您的测试用例。

## 模拟

**模拟**类似于存根，但添加了*验证*。**模拟的目的是断言您的被测系统如何与依赖项交互**。

例如，如果您正在为将文件上传到网站的系统编写测试，您可以构建一个接受文件的*模拟*，并且您可以使用它来断言上传的文件是正确的。或者，在较小的规模上，通常使用对象的模拟来验证被测系统是否调用了模拟对象的特定方法。

模拟与*交互测试*相关，这是一种特定的测试方法。喜欢测试*系统状态*而不是*系统交互*的人会谨慎使用模拟。

## 测试双打

Fakes、stubs 和 mocks 都属于*test doubles*的范畴。测试替身是您在测试中使用的任何对象或系统，*而不是*其他东西。大多数自动化软件测试都涉及使用某种类型的测试替身。其他一些测试替身包括**虚拟值**、**间谍**和 I/O**黑洞**。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2018-07-21T12:07:16.127

您在其上声明的东西称为**模拟**对象，而其他所有有助于测试运行的东西都是**存根**。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2020-04-14T14:10:21.777

`Unit testing`- 是一种单元（类，方法）受控制的测试方法。

`Test double`- 不是主要对象（来自 OOP 世界）。它是一种**临时**创建的实现，用于测试、检查或开发过程中。并且它们是为**关闭** 测试单元（方法、类...）的依赖关系而创建的

测试双打类型：

*   `fake object`是接口（协议）的真实**实现**或使用继承或其他可用于创建依赖的方法的**扩展。****`is`**通常它是由开发人员创建的，作为替代某些依赖项的最简单解决方案

*   `stub object`是一个裸对象（0，nil 和没有逻辑的方法），具有**额外的状态**，由开发人员预定义以定义**返回值**。通常它是由框架创建的

```
class StubA: A {
    override func foo() -> String {
        return "My Stub"
    }
} 
```

*   `mock object`非常相似，`stub object`但是在程序执行期间会更改**额外的状态**以检查是否**发生了某些事情**（方法被调用、参数、何时、多久......）。

```
class MockA: A {
    var isFooCalled = false
    override func foo() -> String {
        isFooCalled = true
        return "My Mock"
    }
} 
```

*   `spy object`是一个带有“部分嘲笑”的真实对象。这意味着您使用**非双重**对象，除了模拟行为

*   `dummy object`是运行测试所必需的对象，但该对象的任何一个变量或方法都不会被调用。

**存根与模拟**

[马丁福勒 说](https://martinfowler.com/articles/mocksArentStubs.html)

> 不同之处在于 stub 使用状态验证，而 mock 使用行为验证。

[[Mockito 模拟 vs 间谍]](https://stackoverflow.com/a/62555181/4770877)

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2017-04-06T03:12:06.797

为了说明存根和模拟的用法，我还想包括一个基于 Roy Osherove 的“[单元测试艺术](https://rads.stackoverflow.com/amzn/click/1617290890)”的示例。

想象一下，我们有一个 LogAnalyzer 应用程序，它具有打印日志的唯一功能。它不仅需要与 Web 服务对话，而且如果 Web 服务抛出错误，LogAnalyzer 必须将错误记录到不同的外部依赖项，并通过电子邮件将其发送给 Web 服务管理员。

这是我们想在 LogAnalyzer 中测试的逻辑：

```
if(fileName.Length<8)
{
 try
  {
    service.LogError("Filename too short:" + fileName);
  }
 catch (Exception e)
  {
    email.SendEmail("a","subject",e.Message);
  }
} 
```

当 Web 服务抛出异常时，如何测试 LogAnalyzer 是否正确调用电子邮件服务？以下是我们面临的问题：

*   我们如何替换 Web 服务？

*   我们如何模拟来自 Web 服务的异常，以便我们可以测试对电子邮件服务的调用？

*   我们如何知道电子邮件服务被正确调用或根本没有调用？

**我们可以通过为 Web 服务使用存根来**处理前两个问题。为了解决第三个问题，我们可以**为电子邮件服务使用模拟对象**。

假货是一个通用术语，可用于描述存根或模拟。在我们的测试中，我们将有两个假货。一种是电子邮件服务模拟，我们将使用它来验证是否将正确的参数发送到电子邮件服务。另一个将是一个存根，我们将使用它来模拟从 Web 服务引发的异常。这是一个存根，因为我们不会使用伪造的 Web 服务来验证测试结果，只是为了确保测试正确运行。电子邮件服务是一个模拟，因为我们将针对它断言它被正确调用。

```
[TestFixture]
public class LogAnalyzer2Tests
{
[Test]
 public void Analyze_WebServiceThrows_SendsEmail()
 {
   StubService stubService = new StubService();
   stubService.ToThrow= new Exception("fake exception");
   MockEmailService mockEmail = new MockEmailService();

   LogAnalyzer2 log = new LogAnalyzer2();
   log.Service = stubService
   log.Email=mockEmail;
   string tooShortFileName="abc.ext";
   log.Analyze(tooShortFileName);

   Assert.AreEqual("a",mockEmail.To); //MOCKING USED
   Assert.AreEqual("fake exception",mockEmail.Body); //MOCKING USED
   Assert.AreEqual("subject",mockEmail.Subject);
 }
} 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-03-29T11:13:14.340

如果您熟悉 Arrange-Act-Assert，那么解释存根和模拟之间可能对您有用的区别的一种方法是存根属于排列部分，因为它们用于排列输入状态，而模拟属于断言部分，因为它们用于断言结果。

傻子什么都不做。它们仅用于填充参数列表，以免出现未定义或空错误。它们的存在也是为了满足静态类型语言中的类型检查器，以便您可以编译和运行。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2019-09-08T21:03:08.557

Stub、Fakes 和 Mocks 在不同的来源中具有不同的含义。我建议你介绍一下你的团队内部术语并同意它们的含义。

我认为区分两种方法很重要： - 行为验证（暗示行为替代） - 最终状态验证（暗示行为模拟）

考虑发送电子邮件以防出错。在进行行为验证时 - 您检查该方法`Send`是否`IEmailSender`已执行一次。并且您需要模拟此方法的返回结果，返回已发送消息的 Id。所以你说：*“我希望这`Send`会被调用。我只会为任何调用返回虚拟（或随机）ID”*。这是行为验证： `emailSender.Expect(es=>es.Send(anyThing)).Return((subject,body) => "dummyId")`

在进行状态验证时，您将需要创建`TestEmailSender`该 implements `IEmailSender`。并实现`Send`方法 - 通过将输入保存到某些数据结构中，这些数据结构将用于未来状态验证，例如某些对象的数组，`SentEmails`然后测试您将检查是否`SentEmails`包含预期的电子邮件。这是状态验证： `Assert.AreEqual(1, emailSender.SentEmails.Count)`

从我的阅读中，我了解到**行为验证**通常称为**Mocks**。**状态****验证**通常称为**Stubs**或Fakes 。

 *** * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-05-21T18:36:11.353

这是使测试富有表现力的问题。如果我希望测试描述两个对象之间的关系，我会对 Mock 设定期望。如果我正在设置一个支持对象以使我了解测试中的有趣行为，我会存根返回值。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2020-12-16T19:55:38.607

所有这些都称为测试替身，用于注入测试用例所需的依赖项。

[![伪造的](https://i.stack.imgur.com/TYjQc.png)](https://i.stack.imgur.com/TYjQc.png)

存根：它已经有一个预定义的行为来设置您的期望，例如，存根仅返回您的 API 响应的成功案例 [![存根](https://i.stack.imgur.com/1hlgy.png)](https://i.stack.imgur.com/1hlgy.png)

模拟是更智能的存根。您验证您的测试通过它。因此，您可以根据条件在测试用例中更改返回成功或失败成功的 amock。 [![嘲笑](https://i.stack.imgur.com/uOFYY.png)](https://i.stack.imgur.com/uOFYY.png)

[![假的](https://i.stack.imgur.com/Gir5q.png)](https://i.stack.imgur.com/Gir5q.png)

[![间谍](https://i.stack.imgur.com/3KSWJ.jpg)](https://i.stack.imgur.com/3KSWJ.jpg)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-11-12T21:46:58.980

**stub**和**fake**是对象，因为它们可以根据输入参数改变它们的响应。它们之间的主要区别在于，Fake 比存根更接近真实世界的实现。存根包含对预期请求的基本硬编码响应。让我们看一个例子：

```
public class MyUnitTest {

 @Test
 public void testConcatenate() {
  StubDependency stubDependency = new StubDependency();
  int result = stubDependency.toNumber("one", "two");
  assertEquals("onetwo", result);
 }
}

public class StubDependency() {
 public int toNumber(string param) {
  if (param == “one”) {
   return 1;
  }
  if (param == “two”) {
   return 2;
  }
 }
} 
```

**模拟**是假货和存根的一步。模拟提供与存根相同的功能，但更复杂。他们可以为他们定义规则，规定必须以什么顺序调用 API 上的方法。大多数模拟程序可以跟踪一个方法被调用了多少次，并可以根据该信息做出反应。模拟通常知道每个调用的上下文，并且可以在不同的情况下做出不同的反应。正因为如此，模拟需要一些他们正在模拟的类的知识。存根通常无法跟踪调用方法的次数或调用方法序列的顺序。一个模拟看起来像：

```
public class MockADependency {

 private int ShouldCallTwice;
 private boolean ShouldCallAtEnd;
 private boolean ShouldCallFirst;

 public int StringToInteger(String s) {
  if (s == "abc") {
   return 1;
  }
  if (s == "xyz") {
   return 2;
  }
  return 0;
 }

 public void ShouldCallFirst() {
  if ((ShouldCallTwice > 0) || ShouldCallAtEnd)
   throw new AssertionException("ShouldCallFirst not first thod called");
  ShouldCallFirst = true;
 }

 public int ShouldCallTwice(string s) {
  if (!ShouldCallFirst)
   throw new AssertionException("ShouldCallTwice called before ShouldCallFirst");
  if (ShouldCallAtEnd)
   throw new AssertionException("ShouldCallTwice called after ShouldCallAtEnd");
  if (ShouldCallTwice >= 2)
   throw new AssertionException("ShouldCallTwice called more than twice");
  ShouldCallTwice++;
  return StringToInteger(s);
 }

 public void ShouldCallAtEnd() {
  if (!ShouldCallFirst)
   throw new AssertionException("ShouldCallAtEnd called before ShouldCallFirst");
  if (ShouldCallTwice != 2) throw new AssertionException("ShouldCallTwice not called twice");
  ShouldCallAtEnd = true;
 }

} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2021-12-06T19:31:13.330

根据 Vladimir Khorikov 的《单元测试原则、实践和模式》一书：

*   **模拟：**帮助模拟和检查*结果交互*。这些交互是 SUT 对其依赖项进行的调用以更改其状态。换句话说，它有助于检查 SUT 的交互（行为）及其依赖关系。模拟可能是：
    1.  间谍：手动创建
    2.  模拟：使用框架创建
*   **存根：**有助于模拟*传入的交互*。这些交互是 SUT 对其依赖项进行的调用以获取输入数据。换句话说，它有助于测试传递给 SUT 的数据。可能是3种
    1.  Fake: 通常用于替换尚不存在的依赖项。
    2.  Dummy：是硬编码的值。
    3.  存根：您配置为针对不同场景返回不同值的成熟依赖项。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-21T07:57:39.753

在Gerard Meszaros 的[xUnit 测试模式](https://rads.stackoverflow.com/amzn/click/com/0131495054)书中有一个很好的表格，可以很好地了解差异

[![在此处输入图像描述](https://i.stack.imgur.com/B3h5G.png)](https://i.stack.imgur.com/B3h5G.png)

# ruby - 在 Ruby 中，您可以对从文件中读取的数据执行字符串插值吗？

> ID：346380
> 
> 赞同：31
> 
> 时间：2008-12-06T15:24:59.137
> 
> 标签：ruby, string, interpolation

在 Ruby 中，您可以在字符串中引用变量，并在运行时对其进行插值。

例如，如果您声明一个变量`foo`equals`"Ted"`并声明一个字符串`"Hello, #{foo}"`，它会插入到`"Hello, Ted"`.

我一直无法弄清楚如何对`"#{}"`从文件中读取的数据执行魔术插值。

在伪代码中，它可能看起来像这样：

```
interpolated_string = File.new('myfile.txt').read.interpolate 
```

但是最后`interpolate`一种方法不存在。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2011-06-29T19:35:08.453

我认为这可能是在 Ruby 1.9.x 中执行您想要的最简单和最安全的方法（sprintf 在 1.8.x 中不支持按名称引用）：使用“按名称引用”的 Kernel.sprintf 功能。例子：

```
>> mystring = "There are %{thing1}s and %{thing2}s here."
 => "There are %{thing1}s and %{thing2}s here."

>> vars = {:thing1 => "trees", :thing2 => "houses"}
 => {:thing1=>"trees", :thing2=>"houses"}

>> mystring % vars
 => "There are trees and houses here." 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-06T16:13:23.767

好吧，我第二个 stesch 在这种情况下使用 erb 的答案。但是你可以像这样使用 eval 。如果 data.txt 有内容：

```
he #{foo} he 
```

然后你可以像这样加载和插值：

```
str = File.read("data.txt")
foo = 3
result = eval("\"" + str + "\"") 
```

并且`result`将是：

```
"he 3 he" 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-12-06T15:47:34.740

您可以使用[`erb`](http://ruby-doc.org/stdlib-2.1.1/libdoc/erb/rdoc/ERB.html). [这个博客](https://web.archive.org/web/20160401113123/http://www.rrn.dk/rubys-erb-templating-system)给出了ERB使用的简单例子，

```
require 'erb'
name = "Rasmus"
template_string = "My name is <%= name %>"
template = ERB.new template_string
puts template.result # prints "My name is Rasmus" 
```

[`Kernel#eval`](http://www.ruby-doc.org/core-2.1.1/Kernel.html#method-i-eval)也可以使用。但大多数时候你想使用一个简单的模板系统，比如`erb`.

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-06-30T23:30:39.550

Ruby Facets 提供了一个[String#interpolate](http://rubyworks.github.io/rubyfaux/?doc=http://rubyworks.github.io/facets/docs/facets-2.9.3/core.json#api-class-String/api-method-String-d-interpolate)方法：

> 插。提供一种外部使用 Ruby 字符串插值机制的方法。

```
try = "hello"
str = "\#{try}!!!"
String.interpolate{ str }    #=> "hello!!!" 
```

> 注意：为了获得调用者的绑定，该块是必需的。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-03-26T14:21:56.213

您可以使用 IO.read(filename) 将文件读入字符串，然后将结果用作格式字符串 ( [http://www.ruby-doc.org/core-2.0/String.html#method-i- 25](http://www.ruby-doc.org/core-2.0/String.html#method-i-25) ):

我的文件.txt：

```
My name is %{firstname} %{lastname} and I am here to talk about %{subject} today. 
```

fill_in_name.rb：

```
sentence = IO.read('myfile.txt') % {
  :firstname => 'Joe',
  :lastname => 'Schmoe',
  :subject => 'file interpolation'
}
puts sentence 
```

在终端运行“ruby fill_in_name.rb”的结果：

```
My name is Joe Schmoe and I am here to talk about file interpolation today. 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-06T23:04:27.803

已经给出了 2 个最明显的答案，但如果他们出于某种原因不这样做，则有格式运算符：

```
>> x = 1
=> 1
>> File.read('temp') % ["#{x}", 'saddle']
=> "The number of horses is 1, where each horse has a saddle\n" 
```

你有旧的（但经过时间考验的）%s 魔法而不是 #{} 魔法......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-08-22T17:06:49.690

使用[daniel-lucraft](https://stackoverflow.com/users/11951/daniel-lucraft)的答案作为我的基础（因为他似乎是唯一一个回答这个问题的人）我决定以稳健的方式解决这个问题。您将在下面找到此解决方案的代码。

```
# encoding: utf-8

class String
  INTERPOLATE_DELIMETER_LIST = [ '"', "'", "\x02", "\x03", "\x7F", '|', '+', '-' ]
  def interpolate(data = {})
    binding = Kernel.binding

    data.each do |k, v|
      binding.local_variable_set(k, v)
    end

    delemeter = nil
    INTERPOLATE_DELIMETER_LIST.each do |k|
      next if self.include? k
      delemeter = k
      break
    end
    raise ArgumentError, "String contains all the reserved characters" unless delemeter
    e = s = delemeter
    string = "%Q#{s}" + self + "#{e}"
    binding.eval string
  end
end

output =
begin
  File.read("data.txt").interpolate(foo: 3)
rescue NameError => error
  puts error
rescue ArgumentError => error
  puts error
end

p output 
```

对于输入

```
he #{foo} he 
```

你得到输出

```
 "he 3 he" 
```

输入

```
"he #{bad} he\n" 
```

将引发 NameError 异常。和输入

```
"\"'\u0002\u0003\u007F|+-" 
```

将引发 ArgumentError 异常，抱怨输入包含所有可用的分隔符。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-10-27T05:23:52.887

不妨将我自己的解决方案加入其中。

```
irb(main):001:0> str = '#{13*3} Music'
=> "\#{13*3} Music"
irb(main):002:0> str.gsub(/\#\{(.*?)\}/) { |match| eval($1) }
=> "39 Music" 
```

缺点是您要评估的表达式中可能有进一步的 { }，因此可能应该改进正则表达式。

# html - Sandcastle -> 输出到 HTML -> 导入到 MOSS 实用程序

> ID：346384
> 
> 赞同：1
> 
> 时间：2008-12-06T15:27:58.320
> 
> 标签：html, sharepoint, moss, sandcastle

我即将编写从 Sandcastle HTML 输出到 MOSS 实用程序的导入。在我这样做之前，我只想问是否有人知道已经可以完成此任务的工具？

哦，如果问题因为与编程无关而被关闭，请发表评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-10T18:23:55.437

它实际上很容易做到，您只需编写一个将整个结构导入文档库的实用程序，我发现沙堡输出中的所有链接和路径都是相对的，今天我手动运行导入，它工作像一个魅力。

# .net - 在屏幕上绘制一个点

> ID：346385
> 
> 赞同：1
> 
> 时间：2008-12-06T15:28:34.683
> 
> 标签：.net, graphics, mouse-cursor

我需要读取屏幕上计算点的颜色并绘制到该点。

旧版本 VB 中旧 Peek 和 Poke 或 PointSet 和 PointGet 命令的 VB.NET 等效项是什么？

或者，有没有办法将标签用作光标对象，这样当我移动它时它不会擦除我的图片框内容。我不能只制作一个光标图标，因为标签中的文本必须随着我移动光标而改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T19:44:52.967

您不能将标签本身用作光标，但您可以将标签组件添加到表单中并使用消息过滤器与光标同步移动它，如下所示：

```
Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, _
        ByVal e As System.EventArgs) Handles MyBase.Load

        Application.AddMessageFilter(New LabelMoveFilter)

    End Sub

    Private Class LabelMoveFilter
        Implements IMessageFilter

        Public Function PreFilterMessage(ByRef m As Message) As Boolean _
            Implements IMessageFilter.PreFilterMessage

            'If the message is &H200 (WM_MOUSEMOVE), reposition the label to
            'where the cursor has moved to

            If m.Msg = &H200 Then
                Form1.Label1.Location = Form1.PointToClient(Cursor.Position)
            End If

            'Return false so that the message is passed on to the form

            Return False

        End Function

    End Class

End Class 
```

Label 组件（在此示例中为 Label1）不会覆盖表单上的任何内容，它只会位于顶部。只需确保标签位于表单上所有其他组件的前面，这样它就不会滑到其他任何组件后面。然后，您可以在适当的时候将标签的文本设置为您需要的任何内容。

* * *

编辑：回答你问题的另一部分......

要获取和设置屏幕上的任意像素，可以使用 Windows GDI GetPixel 和 SetPixel 函数。像这样导入它们：

```
Private Declare Function GetDC Lib "user32" Alias "GetDC" (ByVal hwnd As Integer) As Integer
Private Declare Function GetPixel Lib "gdi32" (ByVal hdc As Integer, ByVal x As Integer, ByVal y As Integer) As Integer
Private Declare Function SetPixel Lib "gdi32" (ByVal hdc As Integer, ByVal x As Integer, ByVal y As Integer, ByVal crColor As Integer) As Integer 
```

然后像这样调用这些：

```
color = ColorTranslator.FromOle(GetPixel(GetDC(0), x, y)) 
```

和

```
SetPixel(GetDC(0), x, y, ColorTranslator.ToOle(color)) 
```

其中 x 和 y 是屏幕（不是表单）坐标，颜色是要读取/设置的颜色。您可以使用 Cursor.Position.X 和 Cursor.Position.Y 获取光标的 X/Y，如果那是您想要的 X 和 Y。您可以使用 PointToScreen 和 PointToClient 方法分别从表格转换为屏幕和屏幕转换为表格坐标。

请注意，您设置的任何像素都会在重新绘制时被覆盖。请注意，这些也会在您的表单之外读/写，所以要小心。

# asp.net-mvc - 默认操作仅获得一页 404 (asp.net mvc)

> ID：346390
> 
> 赞同：3
> 
> 时间：2008-12-06T15:31:08.843
> 
> 标签：asp.net-mvc, url-routing, http-status-code-404

我只在本地卡西尼网络服务器上测试我的应用程序，我得到了奇怪的东西。

一个索引页面以默认方式正常工作，第二个显示 404，但使用完整版控制器/索引时 - 工作正常。我发现的唯一区别是，在第一个示例中最后没有斜杠，而在第二个斜杠中存在，但指向损坏的链接没有斜杠。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T15:53:16.707

感谢RouteDebug，问题是因为我通过根目录之一的名称调用了Controller，比如模型、视图等！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T15:34:18.213

你能告诉我们你的路线吗？甚至更好：尝试使用 Phil Haack 的优秀（也是必不可少的）Route Debugger。它会告诉您给定请求命中了哪些路由，或者根本没有命中任何路由。

[http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

但仅适用于 MVC Beta，如果您使用任何较旧的 MVC 预览版，则不适用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-06T15:35:45.293

如果您可以发布您的路由，我们可以为您提供更好的帮助，但现在我建议您使用[Routing Debugger](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)对其进行调试。

# asp.net - 如何在 VAB 中创建一个同时测试两个属性的自定义验证器？

> ID：346391
> 
> 赞同：0
> 
> 时间：2008-12-06T15:32:09.230
> 
> 标签：asp.net, validation, enterprise-library, wcsf, validation-application-bl

在我的数据库中，我有一个实体上的复合唯一键约束 (CustomerId, Name)。我想在向数据库提交更改之前测试是否支持唯一约束。用户可以自定义实体上的 Name 属性，因此我想制作一个自定义验证器来验证 name 属性，但是在执行此操作时，我还需要访问 CustomerId 属性。我怎么做？

我正在使用 WCSF，这意味着我被困在 Entlib 3.1 和包含的 VAB 中，但我想可以在不破坏 WCSF 的情况下切换到 EntLib 4.1 的 VAB。

问候，埃吉尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-02-19T13:41:56.133

诀窍是为您的实体创建验证器，而不是为该实体的属性之一。您可以在您的实体上编写自我验证，如下所示：

```
[HasSelfValidation]
public class MyEntity
{
    public int CustomerId { get; set; }
    public string Name { get; set; }

    [SelfValidation]
    public void ValidateRange(ValidationResults results)
    {
        bool isUnique = [query the database here]

        if (!isUnique)
        {
            results.AddResult(new ValidationResult(
                "CustomerId and Name are not unique", this, "", "", null));
        }
    }
} 
```

我必须说我不熟悉 VAB 3.1 的功能集，所以我不能 100% 确定这适用于 3.1。但它适用于 4.1。如果您不喜欢自我验证，您也可以编写自定义验证器并将其连接到配置文件中。查看[此 stackoverflow 答案](https://stackoverflow.com/questions/2258513/validation-framework-in-net-that-can-do-edits-between-fields/2259062#2259062)以获取有关如何执行此操作的更多信息。

# tomcat - 使用 Wicket 的项目布局

> ID：346411
> 
> 赞同：2
> 
> 时间：2008-12-06T15:44:46.820
> 
> 标签：tomcat, file, resources, location, wicket

我应该将 .html 文件放在检票口应用程序中的什么位置？

我目前的项目布局如下：

```
src/myproject
  --classes+ duplicated html files
web
--numerous .html files - previewed
web/img
--resource files such as css/png/js files 
```

我想避免将 html 文件放在重复的位置。放置 html 和资源文件的良好非冗余策略是什么？这显然是使用tomcat，部署时目录结构更改为

```
img
WEB-INF
WEB-INF/classes/myproject 
```

并且 .html 文件以及 .class 文件都保留在顶层 - 这很糟糕。

当然，纯html中的预览功能应该没有相对路径的问题

有没有这方面的例子？我的 wicketappllication 类中是否需要特殊代码（例如 IResourceStreamLocator）？

我正在使用检票口 1.4-rc1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T17:25:48.067

[我应该将 html 和 java 文件放在 Apache Wicket 的同一个包（文件夹）中吗？](https://stackoverflow.com/questions/273721/should-i-put-html-and-java-files-in-the-same-package-folder-in-apache-wicket)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T11:39:15.437

所以在收集了一些 wicket 的经验之后，结果证明 html 文件的默认位置很好。无需重新发明轮子。

您可以使用相对路径毫无问题地链接资源，并且仍然保留预览功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-01T20:35:51.277

我建议使用[Maven](http://maven.apache.org)来构建您的应用程序。永远不要依赖 IDE 来构建您的应用程序。IDE 可能因开发人员而异。当您想使用 CI 服务器时，如果您不使用构建系统，则需要回退到脚本。

Maven 还将[资源与来源分开](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)。

尽管 Maven 需要一些时间才能进入，但非常值得付出努力。

# sql-server - 以经济实惠的方式托管具有 10GB SQL Server 数据库的 Web 应用程序？

> ID：346423
> 
> 赞同：2
> 
> 时间：2008-12-06T15:57:14.047
> 
> 标签：sql-server, hosting

我的一个客户正在开发一个将处理大量数据的 ASP.NET 应用程序。他们的 SQL Server 数据库的初始大小将至少为 5GB，并且可能在一年左右的时间内增长到 10GB。

我们看到的大多数网络托管公司在前 1GB 或 2GB 之后每增加 50MB 的数据库收费 5 美元/月。

如果您有一个大型 SQL Server 数据库，您唯一的托管选项是为专用服务器付费吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T16:09:46.660

不，这不是您唯一的选择，您始终可以为更多磁盘空间支付额外费用或找到提供虚拟服务器的人（这是专用盒子和租用主机之间的一个步骤）。

此外，购买专用服务器（或虚拟服务器）可能比为托管支付额外费用（至少在短期内）更昂贵。

我的问题是，为什么数据库是 5GB？这似乎是很多文字。如果是二进制数据（文件、图像等），您可能需要考虑将它们存储在 FileSystem 上（大多数计划都带有大量的 HDD 空间，而不是 DB 空间）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T17:35:12.900

对于典型的共享主机帐户来说，这是一个相当大的数据库，并且会占用托管数十或数百个站点的服务器上的大量空间。在这种类型的帐户上，托管公司使额外的空间非常昂贵，这样您就可以换取更合适的服务水平。

我建议查看虚拟专用服务器 (VPS)，因为它们位于低成本共享解决方案和成熟的专用服务器之间。大多数计划都会提供足够（或几乎足够）的空间来满足您的需求。

从上面的示例中，我们假设您包含 2 GB 并且需要另外 3 GB 才能开始。您正在寻找每 GB 100 美元或每月 300 美元，对吗？

我使用[ServInt 的](http://www.servint.net/)基本 VPS 解决方案并以每月 50 美元的价格获得 15 GB 的空间，即使在计划增长的情况下也能容纳您的数据库。它是带有 MySQL DB 的 Linux 机器，但可以找到类似的 Windows/SQLServer 解决方案，价格相似。

# python - django-tagging 的安装问题

> ID：346426
> 
> 赞同：1
> 
> 时间：2008-12-06T16:06:42.767
> 
> 标签：python, django, django-tagging

我在使用[django-tagging](http://code.google.com/p/django-tagging/)时遇到问题。我尝试遵循[文档](http://code.google.com/p/django-tagging/source/browse/trunk/docs/overview.txt)，但在第二步失败

> 安装 Django Tagging 并希望在 Django 应用程序中使用它后，请执行以下操作：
> 
> 1.  放入`'tagging'`你的`INSTALLED_APPS`设置。
> 2.  运行命令`manage.py syncdb`。
> 
> 该`syncdb`命令创建必要的数据库表并为所有需要它们的已安装应用程序创建权限对象。

我得到一个带有以下错误的python Traceback：

```
ImportError: cannot import name parse_lookup 
```

以下工作，所以我认为它已正确安装：

```
>> import tagging
>> tagging.VERSION
(0, 2.1000000000000001, None) 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T16:16:15.243

[http://code.djangoproject.com/ticket/7680](http://code.djangoproject.com/ticket/7680)

parse_lookup 已被移除。不确定这将如何影响标记。可能想做一些搜索。

更新：显然它已在标签的主干版本中得到修复。下载最新的 SVN 版本的标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T16:22:13.467

我最近有同样的错误。我检查了似乎工作正常的主干版本。

```
In [1]: import tagging; tagging.VERSION
Out[1]: (0, 3, 'pre') 
```

# bash - Bash while read loop 提前中断

> ID：346445
> 
> 赞同：30
> 
> 时间：2008-12-06T16:24:26.410
> 
> 标签：bash, shell

我一直在用这个撞墙一段时间。

我想通过 SSH 连接到一组机器并检查它们是否可用（接受连接但未被使用）。我创建了一个小脚本 tssh，它就是这样做的：

```
#!/bin/bash

host=$1
timeout=${2:-1}

ssh -qo "ConnectTimeout $timeout" $host "[ \`who | cut -f1 | wc -l \` -eq 0 ] && exit 0 || exit 1" 
```

该脚本工作正常。如果存在连接问题，则返回 255，如果机器忙则返回 1，如果一切正常则返回 0。如果有人知道更好的方法来做到这一点，请告诉我。

所以接下来我尝试使用 while read 循环在我的一组机器上调用 tssh，这就是一切都出错的地方。一旦 tssh 返回 0，循环就会退出，并且永远不会完成整个集合。

```
while read nu ; do tssh "MYBOXES$nu" ; done < <(ruby -e '(0..20).each { |i| puts i }') 
```

起初我认为这是一个 subshel​​l 问题，但显然不是。任何帮助，以及对风格/内容的评论，将不胜感激！我知道当我知道为什么我会踢自己...

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-09-08T20:09:12.580

克里斯是正确的。循环中断的来源是使用标准输入的 SSH，但是 guns 在使用循环方法时是正确的。

如果您正在循环输入（例如包含主机名列表的文件）并调用 SSH，则需要传递 -n 参数，否则基于输入的循环将失败。

```
while read host; do
  ssh -n $host "remote command" >> output.txt
done << host_list_file.txt 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2011-08-10T22:29:30.093

在构造

```
something | 
while read x; do 
    ssh ...
done 
```

while 循环看到的标准输入是`something`.

的默认行为`ssh`是读取标准输入。这使您可以执行以下操作

```
cat id_rsa.pub | ssh new_box "cat - >> ~/.ssh/authorized_keys" 
```

现在，话虽如此，当读取第一个值时，第一个 ssh 命令将从`something`. 然后，当 ssh 完成时，没有输出，并`read`停止。

修复是`ssh -n ...`例如

```
cat /etc/hosts | awk '{print $2}' | while read x; do
    ssh -n $x "do_something_on_the_machine"
done 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-02-04T18:15:18.577

大多数答案都是特定于 ssh 的。其他命令也劫持标准输入并且没有 -n 选项。这应该解决任何其他命令。这也应该适用于 ssh。

```
while read x; do 
    # Make sure command does not hijack stdin
    echo "" | command $x
done < /path/to/some/file 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-04-15T20:10:39.947

我今天遇到了这个问题——rsh 和/或 ssh 可以打破一个 while 读取循环，因为它使用标准输入。我在 ssh 行中添加了一个 -n ，以阻止它尝试使用 stdin 并解决了问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-06T16:32:32.400

不知道它是否会有所帮助，但一种更清洁的写作方式将是

```
for nu in `ruby -e '(0..20).each { |i| puts i}'`; do
  tssh "MYBOXES$nu" 
done 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-06T16:55:21.777

我也不确定它为什么会失败，但我喜欢`xargs`和`seq`：

```
seq 0 20 | xargs -n1 tssh MYBOXES 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-04-15T20:24:19.727

正如 Kaii 所提到的，仅仅为了输出一系列数字而调用 ruby​​ 或 seq （在 BSD 或 OSX 机器上不起作用）真的是矫枉过正。如果您对使用 bash 感到满意，您可以：

```
for i in {0..20}; do
    # command
done 
```

我相信这应该适用于 bash 2.05b 及更高版本。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-06T18:06:44.223

我不敢相信是 0 的结果破坏了你的循环，你可以通过将循环中的 tssh 命令替换为也返回 0 的“/bin/true”来对此进行测试。

关于风格，我不明白为什么一个简单的循环 shell 脚本需要 ruby​​、perl、seq 或 jot 或任何其他不在我的 *BSD 上的二进制文件。

您也可以使用内置的 shell 循环构造，它至少在 ksh、bash 中有效：

```
for ((i=0; $i<=20; i++)); do
    tssh "MYBOXES$i"
done 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2011-08-10T17:16:21.890

谈论一个“抢劫彼得支付保罗”的问题。我已经挣扎了好几个小时才弄清楚为什么我的 ssh 正在杀死我的东西|while 读取循环。

另一种坚持使用 while 读取循环并同时保持 ssh 的方法是使用“-n”开关在 ssh /dev/null 上创建 STDIN。对我来说就像一个魅力：

```
#!/bin/bash
[...]
something|while read host
   do
      ssh -nx ${host} fiddleAround
   done 
```

（我也倾向于总是使用“-x”以避免浪费时间在隧道中协商 X。）

# mysql - MySQL 构造此查询的最佳方法是什么？

> ID：346446
> 
> 赞同：0
> 
> 时间：2008-12-06T16:26:10.183
> 
> 标签：mysql, database

我继承了一个数据库，该数据库的结构包含一个产品表、一个由一些产品属性组成的表和另一个用于构建这些属性与给定产品之间关系的表。

用户可以通过这些属性的组合过滤产品，这意味着如果选择了多个属性，则仅返回具有所有这些属性的产品。不幸的是，该规则现在有一个例外，即用户选择两个特定属性之一需要包含其中一个（或两者）的结果。

查询当前看起来像这样（不是我的代码）：

```
SELECT DISTINCT p.* FROM products AS p 
INNER JOIN attributes a ON p.product_id=a.property_id 
WHERE a.attribute_id IN (1,3,7) 
GROUP BY p.property_id 
HAVING COUNT(DISTINCT a.attribute_id) = 3 
```

我怀疑上述方法是检索所需产品的一种特别有效的方法，但我不确定如何根据新要求进行操作。

我现在创建了一些 php 代码来在选择两个“特殊”属性（3 和 7）时构造一个特殊查询：

```
SELECT DISTINCT p.* FROM products AS p 
INNER JOIN attributes a ON p.product_id=a.property_id 
WHERE a.attribute_id IN (1,3) OR a.attribute_id IN (1,7) 
GROUP BY p.property_id 
HAVING COUNT(DISTINCT a.attribute_id) = 2 
```

但是，这仍然不能按要求工作 - 结果中不会返回任何具有这两个属性的产品（这显然是由于 HAVING COUNT 子句，但我不知道如何修复它。为了清楚起见，问题是如果 10 个产品只有属性 3，而另外 5 个产品具有属性 3 和 7，则上述查询将仅返回 10 条记录。

是否可以使用某种子查询或有哪些替代方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T16:42:14.207

该查询似乎很好，除了您可能可以删除 DISTINCT 修饰符，因为您已经按 id 分组。关于新的需求，你不能在你的代码中解决它，在它到达 SQL 查询之前吗？

编辑：另一种方法是为每个必需的属性构造一个内部连接的查询，但这可能会慢得多

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T16:40:46.410

我认为这看起来已经很不错了。除了必须提到“不要选择 *”之外，我觉得还可以。

我的建议：如果它有效并且不会导致性能问题，那就离开它，把时间花在其他事情上。如果将来出现问题，请重新访问它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T17:41:40.843

这是执行原始查询的更好方法：

```
SELECT ... FROM products AS p 
INNER JOIN attributes a1 ON p.product_id=a1.property_id AND a1.attribute_id=1
INNER JOIN attributes a2 ON p.product_id=a2.property_id AND a2.attribute_id=3
INNER JOIN attributes a3 ON p.product_id=a3.property_id AND a3.attribute_id=7 
```

并且，如果您需要attribute_id 3，您希望将其与attribute_id 7 进行或，并且假设您还需要attribute_id 1，这不是这些特殊属性之一：

```
SELECT ... FROM products AS p 
INNER JOIN attributes a1 ON p.product_id=a1.property_id AND a1.attribute_id=1
LEFT OUTER JOIN attributes a2 ON p.product_id=a2.property_id AND a2.attribute_id=3
LEFT OUTER JOIN attributes a3 ON p.product_id=a3.property_id AND a3.attribute_id=7
WHERE a2.attribute_id IS NOT NULL OR a3.attribute_id IS NOT NULL 
```

我怀疑其中任何一个都将比具有 distinct/have/group by 聚合操作的原件快得多。属性表应该在 (property_id, attribute_id) 或 (attribute_id, property_id) 上有一个多列唯一索引，尽管我假设 property_id 更具选择性，因此应该是索引中最左边的列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T18:29:47.983

使用适当（且明显）的索引，这在 MySQL 中将非常有效。

选择 ...

FROM 产品 AS p

内连接属性 a1 在 p.product_id=a1.property_id 和 a1.attribute_id=1 上
左连接属性 a2 在 p.product_id=a2.property_id 和 a2.attribute_id=3 上
左连接属性 a3 在 p.product_id=a3.property_id 和 a3 .attribute_id=7

WHERE（
当 a1.product_attribute_id 为 NULL THEN 0 ELSE 1 END
+ CASE WHEN a1.product_attribute_id 为 NULL THEN 0 ELSE 1 END 时
）> 0

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-12T03:35:46.973

如何选择 p.* 并仅按 1 列分组？或者这是否适用于主键？

其中 a1.attribute_id IN (1,3) 或 a1.attribute_id IN (1,7)

是相同的

在哪里 a1.attribute_id (1,3,7)

```
SELECT p.* FROM products  
INNER JOIN (
    SELECT a1.property_id  
    FROM attributes a1 
    WHERE a1.attribute_id IN (1,3,7)
    GROUP BY a1.property_id 
    HAVING COUNT(DISTINCT a1.attribute_id) = 2
) as a ON p.product_id=a.property_id 
```

# .net - 在 .NET 中生成简单报告的模板引擎

> ID：346449
> 
> 赞同：2
> 
> 时间：2008-12-06T16:28:42.113
> 
> 标签：.net, class, templates, reporting, report

我正在寻找一个免费的模板引擎来生成简单的报告。我想要一些基本功能，例如：

*   编写循环的能力（使用任何 IEnumerable）
*   传递变量
*   传递模板文件（主模板、页脚、页眉）

我将使用它来生成 HTML 和 XML 格式的报告。我不是在寻找 ASP.NET 模板引擎。

这适用于 WinForms 应用程序。

我看过这个问题[你能推荐一个.net模板引擎吗？](https://stackoverflow.com/questions/340095/can-you-recommend-a-net-template-engine)，但是所有这些模板引擎对我来说都是多余的，并且专注于 ASP.NET。

请只推荐免费图书馆。

// 我还在寻找一个 NVelocity，但它看起来对 .NET 没有任何希望，过于复杂，当你下载它的一堆文件时，不清楚要做什么，没有教程，启动文档等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T17:33:00.640

我第二次不推荐 nVelocity。这是一个可怕的港口。

.NET 实际上通过使用 CodeDOM 内置了模板功能。

这是一个很好的演练如何做到这一点：

[http://www.codeproject.com/KB/cs/smarttemplateengine.aspx](http://www.codeproject.com/KB/cs/smarttemplateengine.aspx)

通过一些小的编码，您将能够创建具有内联 C# 的模板：

```
<html>
    <head>
         <title>My Report</title>
    </head>
    <body>
        <% foreach (ReportRow r in ReportData) { %>
             <!-- Markup and Code for Report -->
        <% } %>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T16:51:52.567

我会推荐 StringTemplate ( [http://www.stringtemplate.org](http://www.stringtemplate.org) )。我用它来生成邮件。您可以使用存储在文件系统或数据库中的模板组（需要一点工作）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T16:57:38.997

我们使用 NVelocity 作为我们基于 MonoRail 的网站的一部分。老实说，我不会推荐 NVelocity。它是从 Java 版本到 .NET 版本的直接端口（直接我的意思是 CTRL+C、CTRL+V，将一些 Java 关键字更改为 C# 关键字——这是不可维护的）。Castle 不得不对其进行分叉以添加一些面向 .NET 的功能（字典访问、花哨的 foreach 循环），因为最初的 .NET 维护人员将其置于不健康的状态。在转义自己的某些指令时遇到问题，如果您尝试将长 if 语句拆分为多行，您会感到非常恼火。我的意思不是到处乱扔它，它是一种很好的语言，它是免费的，而且它在我们的网站上使用，它每天处理数千个请求——除非我看到新的实现，否则我不会再使用它相同的语法。

对于系统中生成电子邮件的其他区域，我只是使用老式的方法来替换字符串中的 $SPECIAL_KEYWORDS$（即，将关键字映射到值、遍历并替换的字典）。效率不高，但效果很好。

期待阅读其他一些答案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-09T23:37:39.153

尽管我看到您已经接受了答案，但我还是鼓励您查看[Spark 视图引擎](http://sparkviewengine.com/ "火花视图引擎")。

来自网站的示例：

```
<viewdata products="IEnumerable[[Product]]"/>
<ul if="products.Any()">
  <li each="var p in products">${p.Name}</li>
</ul>
<else>
  <p>No products available</p>
</else> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T20:26:56.470

感谢您的帮助，CodeDOM 专门向我展示了一个不错的方法，现在我正在使用它： http: [//www.stefansarstedt.com/templatemaschine.html](http://www.stefansarstedt.com/templatemaschine.html)

这不是最好的，有点脏，但对我有用。它是适合我的 LGPL，而且很短。

我查看了其他建议，但不喜欢它们，对于我想要的东西来说太复杂了（而且非常混乱 - 大量的 DLL、依赖项等-）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-30T12:30:35.203

John Resig 有一个很棒的 Javascript 模板端，称为[micro-template](http://ejohn.org/blog/javascript-micro-templating/)。模板的语法是：

```
<script type="text/html" id="item_tmpl">
  <div id="<%=id%>" class="<%=(i % 2 == 1 ? " even" : "")%>">
    <div class="grid_1 alpha right">
      <img class="righted" src="<%=profile_image_url%>"/>
    </div>
    <div class="grid_6 omega contents">
      <p><b><a href="/<%=from_user%>"><%=from_user%></a>:</b> <%=text%></p>
    </div>
  </div>
</script> 
```

模板函数将支持 Javascript 的使用，因此您可以获得循环功能和对 DOM 的完全访问权限，因此您可以使用任何 jQuery 或其他框架。这是一种非常灵活的方法，因为它允许您以很少的努力和更改快速将新功能包含到网页中。如Dave Ward的这篇[文章](http://encosia.com/2008/06/26/use-jquery-and-aspnet-ajax-to-build-a-client-side-repeater/)所示，它也适用于 .Net 。

模板可以是一个 html 文件，您可以使用 $.get() 命令检索该文件。您为模板提供一个 JSON 对象作为数据源。最后，还有一个功能可以让您预编译模板。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-09T23:21:43.510

这是另一个模板引擎：[UltTemplate Engine](http://www.componentsoft.net/component/templateengine.net/)

这是模板代码：

```
Dear $User.FullName$,
{%set orders=User.GetOrders() /}
Thank you for your order of $orders.Length$ items, We believe you will be very satisfied with the quality of costume pieces included in each. It is this quality that makes our imaginative play apparel so unique.

We created an account for you to track your orders. Here is the login information:
Email: $User.EmailAddress$
Password: $User.Password$

Following is the details of your order (OrderId: $OrderId$):
#   Part ID    Name            Quantity     Price(per unit)       Sub Total
{%set Total=0.0 /}{%foreach orderproduct,i in orders%}{%set Total = Total + orderproduct.Price * orderproduct.Quantity/}
{%rendertemplate orderproducttemplate item=orderproduct/}{$foreach%}
                                                                                               Total: $PadLeft(Format(Total,"$$#.##"),11)$

If you have any concern, please call us at 913-555-0115.

Sincerely,

$CompanyName$

{%template orderproducttemplate%}$PadLeft(i,4)$$PadLeft(item.PartId, 7)$    $PadRight(item.ProductName, 15)$        $PadRight(item.Quantity, 5)$        $PadLeft(Format(item.Price,"$$#.##"), 7)$   $PadLeft(Format(item.Price*item.Quantity,"$$#.##"), 12)${$template%} 
```

这是输出：

```
Dear John Borders,

Thank you for your order of 3 items, We believe you will be very satisfied with the quality of costume pieces included in each. It is this quality that makes our imaginative play apparel so unique.

We created an account for you to track your orders. Here is the login information:
Email: myemail@somedomain.com
Password: 123abc

Following is the details of your order (OrderId: 1625DGHJ):
#   Part ID    Name            Quantity     Price(per unit)       Sub Total

   0   1239    Product A              3            $104.09        $312.27
   1     22    Product B              1            $134.09        $134.09
   2    167    Product C              5              $14.7          $73.5

                                               Total:     $519.86

If you have any concern, please call us at 913-555-0115.

Sincerely,

My Company Name 
```

这是 C# 代码：

```
 class OrderProduct
        {
            private int _partId;
            private string _productName;
            private int _quantity;
            private float _price;

            public int PartId
            {
                get { return _partId; }
                set { _partId = value; }
            }

            public string ProductName
            {
                get { return _productName; }
                set { _productName = value; }
            }

            public int Quantity
            {
                get { return _quantity; }
                set { _quantity = value; }
            }

            public float Price
            {
                get { return _price; }
                set { _price = value; }
            }
        }

        class User
        {
            private string _fullName;
            private string _emailAddress;
            private string _password;

            public string FullName
            {
                get { return _fullName; }
                set { _fullName = value; }
            }

            public string EmailAddress
            {
                get { return _emailAddress; }
                set { _emailAddress = value; }
            }

            public string Password
            {
                get { return _password; }
                set { _password = value; }
            }

            public OrderProduct[] GetOrders()
            {
                OrderProduct[] ops = new OrderProduct[3];

                ops[0] = new OrderProduct();
                ops[0].PartId = 1239;
                ops[0].Price = 104.09f;
                ops[0].ProductName = "Product A";
                ops[0].Quantity = 3;

                ops[1] = new OrderProduct();
                ops[1].PartId = 22;
                ops[1].Price = 134.09f;
                ops[1].ProductName = "Product B";
                ops[1].Quantity = 1;

                ops[2] = new OrderProduct();
                ops[2].PartId = 167;
                ops[2].Price = 14.7f;
                ops[2].ProductName = "Product C";
                ops[2].Quantity = 5;

                return ops;
            }
        }

        private void btnRun_Click(object sender, EventArgs e)
        {
            try
            {
                dt.LoadFromString(txtSource.Text);
                dt.SetValue("CompanyName", "My Company Name");

                User u = new User();
                u.EmailAddress = "myemail@somedomain.com";
                u.FullName = "John Borders";
                u.Password = "123abc";
                dt.SetValue("User", u);
                dt.SetValue("OrderId", "1625DGHJ");

                txtOutput.Text = dt.Run();
            }
            catch (Exception exc)
            {
                MessageBox.Show("An error occurred: " + exc.Message);
            }
        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-29T09:28:57.200

当我阅读这些答案时，我不禁注意到所有答案和库等对于较小的应用程序来说都非常复杂。因此，我想建议[T4T 文本模板](https://msdn.microsoft.com/en-us/library/ee844259.aspx)。

这是一个[写作](https://msdn.microsoft.com/en-us/library/bb126478.aspx)教程。它不需要任何不包含在 Visual Studio 中的库。如果您不需要过于复杂的模板或报告，可能值得一看。

模板代码示例：

```
 <#@ template language="C#" #>
<html><body>
<h1>Sales for Previous Month</h2>
<table>
    <# for (int i = 1; i <= 10; i++)
       { #>
         <tr><td>Test name <#= i #> </td>
             <td>Test value <#= i * i #> </td> </tr>
    <# } #>
 </table>
This report is Company Confidential.
</body></html> 
```

在您的应用程序代码中，您可以使用如下调用生成模板的内容：

```
MyWebPage page = new MyWebPage();
String pageContent = page.TransformText();
System.IO.File.WriteAllText("outputPage.html", pageContent); 
```

# python - 在 django 模板中格式化数字

> ID：346467
> 
> 赞同：185
> 
> 时间：2008-12-06T16:46:49.533
> 
> 标签：python, django

我正在尝试格式化数字。例子：

```
1     => 1
12    => 12
123   => 123
1234  => 1,234
12345 => 12,345 
```

这是一件相当普遍的事情，但我不知道我应该使用哪个过滤器。

编辑：如果你有一个通用的 Python 方法来做到这一点，我很高兴在我的模型中添加一个格式化字段。

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2008-12-07T13:10:22.293

Django 贡献的[人性化](http://docs.djangoproject.com/en/dev/ref/contrib/humanize/#ref-contrib-humanize)应用程序这样做：

```
{% load humanize %}
{{ my_num|intcomma }} 
```

请务必在文件中添加`'django.contrib.humanize'`到您的`INSTALLED_APPS`列表中`settings.py`。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2012-06-02T02:02:31.873

在其他答案的基础上，将其扩展到浮点数，您可以执行以下操作：

```
{% load humanize %}
{{ floatvalue|floatformat:2|intcomma }} 
```

文档：[`floatformat`](https://docs.djangoproject.com/en/stable/ref/templates/builtins/#floatformat), [`intcomma`](https://docs.djangoproject.com/en/stable/ref/contrib/humanize/#intcomma).

* * *

## 回答 #3

> 赞同：63
> 
> 时间：2010-02-01T21:26:44.417

关于 Ned Batchelder 的解决方案，这里有 2 个小数点和一个美元符号。这就像`my_app/templatetags/my_filters.py`

```
from django import template
from django.contrib.humanize.templatetags.humanize import intcomma

register = template.Library()

def currency(dollars):
    dollars = round(float(dollars), 2)
    return "$%s%s" % (intcomma(int(dollars)), ("%0.2f" % dollars)[-3:])

register.filter('currency', currency) 
```

那么你就可以

```
{% load my_filters %}
{{my_dollars | currency}} 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2016-06-03T06:56:37.927

尝试在 settings.py 中添加以下行：

```
USE_THOUSAND_SEPARATOR = True 
```

这应该有效。

请参阅[文档](https://docs.djangoproject.com/en/stable/ref/settings/#std:setting-THOUSAND_SEPARATOR)。

* * *

2018-04-16 更新：

还有一种python方法可以做到这一点：

```
>>> '{:,}'.format(1000000)
'1,000,000' 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-12-06T19:21:33.497

如果您不想参与语言环境，这里有一个格式化数字的函数：

```
def int_format(value, decimal_points=3, seperator=u'.'):
    value = str(value)
    if len(value) <= decimal_points:
        return value
    # say here we have value = '12345' and the default params above
    parts = []
    while value:
        parts.append(value[-decimal_points:])
        value = value[:-decimal_points]
    # now we should have parts = ['345', '12']
    parts.reverse()
    # and the return value should be u'12.345'
    return seperator.join(parts) 
```

从此函数创建[自定义模板过滤器很简单。](http://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2013-02-27T20:11:20.180

如果您的网站是英文的，则人性化解决方案很好[。](https://docs.djangoproject.com/en/dev/ref/contrib/humanize/)对于其他语言，您需要另一种解决方案：我建议使用[Babel](http://babel.edgewall.org/)。一种解决方案是创建自定义模板标签以正确显示数字。方法如下：只需在以下文件中创建以下文件`your_project/your_app/templatetags/sexify.py`：

```
# -*- coding: utf-8 -*-
from django import template
from django.utils.translation import to_locale, get_language
from babel.numbers import format_number

register = template.Library()

def sexy_number(context, number, locale = None):
    if locale is None:
        locale = to_locale(get_language())
    return format_number(number, locale = locale)

register.simple_tag(takes_context=True)(sexy_number) 
```

然后你可以在你的模板中使用这个模板标签，如下所示：

```
{% load sexy_number from sexify %}

{% sexy_number 1234.56 %} 
```

*   对于美国用户（语言环境 en_US），这显示 1,234.56。
*   对于法语用户（区域设置 fr_FR），这将显示 1 234,56。
*   ...

当然你可以使用变量来代替：

```
{% sexy_number some_variable %} 
```

**注意：**我的示例中当前未使用该`context`参数，但我将其放在那里是为了表明您可以轻松地调整此模板标签以使其使用模板上下文中的任何内容。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-01-26T08:57:42.990

[人性化应用程序](http://docs.djangoproject.com/en/dev/ref/contrib/humanize/#ref-contrib-humanize)提供了一种很好且快速的数字格式设置方法，但如果您需要使用不同于逗号的分隔符，只需重用[人性化应用程序中的代码](https://code.djangoproject.com/browser/django/trunk/django/contrib/humanize/templatetags/humanize.py)，替换分隔符，然后[创建自定义过滤器](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/#writing-custom-template-filters)即可。例如，使用*空格*作为分隔符：

```
@register.filter('intspace')
def intspace(value):
    """
    Converts an integer to a string containing spaces every three digits.
    For example, 3000 becomes '3 000' and 45000 becomes '45 000'.
    See django.contrib.humanize app
    """
    orig = force_unicode(value)
    new = re.sub("^(-?\d+)(\d{3})", '\g<1> \g<2>', orig)
    if orig == new:
        return new
    else:
        return intspace(new) 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-02-19T00:21:20.727

*稍微偏离主题：*

我在寻找一种将数字格式化为货币的方法时发现了这个问题，如下所示：

```
$100
($50)  # negative numbers without '-' and in parens 
```

我最终做了：

```
{% if   var >= 0 %} ${{ var|stringformat:"d" }}
{% elif var <  0 %} $({{ var|stringformat:"d"|cut:"-" }})
{% endif %} 
```

您也可以这样做，例如`{{ var|stringformat:"1.2f"|cut:"-" }}`显示为`$50.00`（如果这是您想要的，则显示为 2 位小数。

也许在hacky方面稍微有点，但也许其他人会发现它很有用。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-07-01T20:56:36.147

基于 muhuk 的回答，我做了这个简单的标签封装 python`string.format`方法。

*   `templatetags`在您的应用程序文件夹中创建一个。
*   在上面创建一个`format.py`文件。
*   将其添加到其中：

    ```
    from django import template

    register = template.Library()

    @register.filter(name='format')
    def format(value, fmt):
        return fmt.format(value) 
    ```

*   将其加载到您的模板中`{% load format %}`
*   用它。`{{ some_value|format:"{:0.2f}" }}`

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-06T16:56:39.497

好吧，我找不到 Django 方式，但我确实从模型内部找到了一种 python 方式：

```
def format_price(self):
    import locale
    locale.setlocale(locale.LC_ALL, '')
    return locale.format('%d', self.price, True) 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-05-16T14:36:54.357

不知道为什么还没有提到这一点：

```
{% load l10n %}

{{ value|localize }} 
```

[https://docs.djangoproject.com/en/1.11/topics/i18n/formatting/#std:templatefilter-localize](https://docs.djangoproject.com/en/1.11/topics/i18n/formatting/#std:templatefilter-localize)

您也可以通过调用在 Django 代码（外部模板）中使用它`localize(number)`。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-08T21:07:53.623

请注意，更改语言环境是进程范围的，而不是线程安全的（例如，可能会产生副作用或影响在同一进程中执行的其他代码）。

我的建议：查看[Babel](http://babel.edgewall.org/)包。一些与 Django 模板集成的方法是可用的。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-02-12T17:33:14.747

如果有人偶然发现这个，`Django 2.0.2`你可以使用这个

[千位分隔符](https://docs.djangoproject.com/en/2.0/ref/settings/#thousand-separator)。请务必阅读[格式本地化](https://docs.djangoproject.com/en/2.0/topics/i18n/formatting/)。

# sharepoint - Web 部件功能和读取 XML 文件

> ID：346495
> 
> 赞同：0
> 
> 时间：2008-12-06T17:15:24.217
> 
> 标签：sharepoint

我已将自定义 Web 部件部署为功能。我使用 STSDEV 创建功能和支持配置文件。我在尝试添加一个简单的 XML 文件以包含我需要读取的值时遇到了一些问题。我应该将 XML 文件放在 Feature 项目中的什么位置，我需要做什么才能访问该文件？经过几次尝试后，我的 Web 部件仍然呈现，但不再出现在要通过浏览器界面激活的功能列表中……有人得到这方面的任何信息吗？:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-07T16:23:28.190

如果您需要该简单的 xml 作为 webpart 的配置，则可以将其作为 *.webpart 文件中的参数之一提供。您必须对该文件进行编码，这种方法至少在我们的项目中有效。

# c - C 指针混淆

> ID：346499
> 
> 赞同：3
> 
> 时间：2008-12-06T17:17:21.907
> 
> 标签：c, struct, pointers, segmentation-fault

我想在内存中存储一​​个字符串并稍后读取：

```
$$->desc.constant->base.id =  (char*)malloc(200);
sprintf($$->desc.constant->base.id, "%f", $1);
printf("->%s\n", $$->desc.constant->base.id); //LINE A
printf("->%i\n", $$->desc.constant); //LINE B

//SOME OTHER CODE

//Then, later on in a function call:

printf("%i", expr->desc.constant); // LINE D
printf("%s", expr->desc.constant->base.id); // LINE C 
```

尽管 B 行和 D 行显示相同的地址，但 C 行中的 printf 因分段错误而失败。我错过了什么？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-06T17:22:45.403

```
printf("->%i\n", $$->desc.constant); //LINE B 
```

那是无效的。当您显示它之前的行`constant`实际上是一个指针时，您不能将其视为 type `int`。它们不一定具有相同的 sizeof 和对齐方式。使用用于`void*`. 它将正确输出内存地址：

```
printf("->%p\n", (void*)$$->desc.constant); //LINE B 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T18:47:33.767

1.  **总是**检查`malloc`的返回值。
2.  `sprintf`->`snprintf`
3.  `"%f"`->`"%.*g"`

这是一个例子：

```
/** $ gcc print_number.c -o print_number */
#include <assert.h>
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char *argv[])
{
  const char* number_format = "%.*g";
  const int ndigits = 15;
  assert(ndigits > 0);
  const int maxlen = ndigits + 8 /* -0.e+001, Infinity */ + 1 /* '\0' */;

  char *str = malloc(maxlen);
  if (str == NULL) {
    fprintf(stderr, "error: malloc\n");
    exit(1);
  }    

  double number = 12345678901234567890.123456789012345678901234567890;
  /** `number = 0/0` crashes the program */;

  printf("number: %f\t", number);

  int len_wouldbe = snprintf(str, maxlen, number_format, ndigits, number);
  assert(len_wouldbe < maxlen);

  printf("%s\n", str);
  return 0;
} 
```

输出：

```
number: 12345678901234567000.000000 1.23456789012346e+19 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T18:15:07.093

`free`也许在您从字符串开始的两段代码的时间之间？

```
$$->desc.constant->base.id =  (char*)malloc(200);
sprintf($$->desc.constant->base.id, "%f", $1);
printf("->%s\n", $$->desc.constant->base.id); //LINE A
printf("->%i\n", $$->desc.constant); //LINE B

//SOME OTHER CODE
// which happens to do
free($$->desc.constant->base.id);

printf("%i", expr->desc.constant); // LINE D
printf("%s", expr->desc.constant->base.id); // crash 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T23:04:52.827

鉴于程序正在产生分段错误，我认为问题很可能是由于分配了空间，因此指定（指向）的结构`expr->desc.constant`已被重用，或者可能根本没有真正分配过空间。

该代码表现出各种小罪，例如使用`sprintf()`代替`snprintf()`，并无偿分配 200 个字节用于浮点数的字符串表示。（您不太可能需要那么多空间；如果这样做，您很可能应该允许至少多出 100 位数字，因为浮点数的指数范围通常是 +/-308，而您这样做的唯一原因是'd 需要 200 个字符是为了允许非常大或非常小的数字。）

你已经证明了`$$->desc.constant`指向同一个地方，但是你没有说明这个空间是如何分配的。然后，您在 中分配字符串空间`$$->desc.constant->base.id`，而没有为 . 明确分配空间`base`。

# c# - 打印 WPF Web 浏览器内容的最佳方式是什么？

> ID：346506
> 
> 赞同：2
> 
> 时间：2008-12-06T17:20:56.390
> 
> 标签：c#, .net, webbrowser-control

我们使用 IE 引擎的修改版本（C# 包装器中的 COM 版本）在我们的应用程序中显示大量格式化内容。但是，问题是您无法控制此类文档的任何打印输出。例如，您不能在不访问注册表或将用户定向到 Internet Explorer 选项的情况下强制进行彩色打印输出。因此，我们一直在研究新的 WPF WebBrowser 控件，它可能更适合我们的目的。

问题是（除了微软称它与控件的 Windows 窗体版本相同，这使得 Google 搜索不如我喜欢的有用）我似乎找不到任何关于如何打印控件内容的好的指南。从对象返回的文档没有分页，因此很难与 PrintDialog 一起使用。类似地，将 Visual 发送到 PrintDialog 似乎不是一个好主意。在这种情况下正确调整控件的大小似乎是可疑的，尤其是当您考虑分页时。

在某处必须有一些很好的文档。有人可以指导我或提供有关如何执行此操作的好建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T19:04:49.350

mshtml.IHTMLDocument2 doc = webBrowser.Document as mshtml.IHTMLDocument2; doc.execCommand("Print", true, null);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T17:34:43.383

我很确定 WPF WebBrowser 控件只是为在 WPF 中使用而很好地包装的 ActiveX 控件。（该类派生自`ActiveXHost`）。

# sql - AS400多成员文件SQL查询

> ID：346512
> 
> 赞同：19
> 
> 时间：2008-12-06T17:27:43.210
> 
> 标签：sql, jdbc, db2, ibm-midrange, jt400

在 5250 会话中的交互式 SQL 中的 AS400 上，

```
select * from myfile 
```

仅当 myfile 有多个成员时才从一个成员返回行。

如何从特定成员获取行？

重要：最后我想通过 JDBC 和 jt400 来做这件事，所以我真的想要一个可以在那里工作的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-01-12T15:11:22.650

您可以使用 create alias 命令创建别名：

```
CREATE ALIAS myLibrary/myAlias FOR memberLibrary/memberFile(memberName) 
```

这将允许您像使用任何其他文件一样使用别名对该成员运行 sql：

```
SELECT * FROM myLibrary/myAlias 
```

请记住，别名会在您的会话结束后继续存在，它们不是临时的。因此，如果您在完成后不需要别名，请在 QTEMP 中创建别名或在完成后显式删除别名：

```
DROP ALIAS myLibrary/myAlias 
```

高温高压

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-07T12:45:19.973

为成员创建 SQL 别名并查询别名，请参阅[此页面](http://searchdatamanagement.techtarget.com/tip/0,289483,sid91_gci1228049,00.html#6.%20Accessing%20an%20explicit%20file%20member%20using%20SQL)以获取示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-01T00:37:45.557

SQL 别名

`OS/400 R430`后来支持`SQL`别名声明。为每个必须访问的成员创建一个别名，然后从应用程序中引用该别名。别名是一个持久对象——它只能被创建一次。中引用的成员在创建`CREATE ALIAS`时不必存在`ALIAS`。任何`SQL`工具，例如`OS/400`or`i5/OS interactive SQL (STRSQL)`或`iSeries Navigator's Run SQL Scripts`，都可以用来创建别名，例如：

```
CREATE ALIAS MYLIB.FILE1MBR1 FOR MYLIB.MYFILE(MBR1) 
CREATE ALIAS MYLIB.FILE1MBR2 FOR MYLIB.MYFILE(MBR2) 
```

[http://www-01.ibm.com/support/docview.wss?uid=nas1f1eaeecc0af19cc38625669100569213](http://www-01.ibm.com/support/docview.wss?uid=nas1f1eaeecc0af19cc38625669100569213)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-07-11T17:33:35.847

这是一个旧线程，仍然是搜索结果列表中的第一个，我想增强以前的响应：

有时您只需要创建别名作为一次性数据库分析，然后您想创建别名并在查询后立即将其删除；您还有一个包含许多表的数据库库，并且不想在每个查询中限定该库，因此您使用 SET SCHEMA；我喜欢使用 QTEMP 库来创建别名，因为 IBM i AS400 服务器上的 QTEMP 本质上是用于临时对象：

```
set schema=mylibrary;

create alias qtemp.aliasx for table1(membera);
create alias qtemp.aliasy for table2(memberb);

select  * from qtemp.aliasx;
select  * from qtemp.aliasy;

drop alias qtemp.aliasx;
drop alias qtemp.aliasy; 
```

# php - 谷歌地图 API 和链接

> ID：346516
> 
> 赞同：1
> 
> 时间：2008-12-06T17:31:54.293
> 
> 标签：php, api, google-maps

我正在尝试通过 API 将链接添加到 Google 地图中标记的弹出文本气泡中。我已成功运行以下代码：

```
echo '<marker lat="43.91892" lng="-78.89231" html="Albertus Magnus College&lt;br&gt;Link to Admissions" label="Albertus Magnus College" />'; 
```

但是，一旦我真正尝试添加链接，它就会失败。像这样：

```
echo '<marker lat="43.91892" lng="-78.89231" html="Albertus Magnus College&lt;br&gt;&lt;a href='http://www.albertus.edu/admission/index.shtml'&gt;Admissions&lt;\/a&gt;" label="Albertus Magnus College" />'; 
```

有谁知道如何成功编写此代码？我将它写入 PHP 是因为我有一些其他功能不允许我只用 XML 编写它。

更新：出于某种原因，我让它像这样工作......

```
$window2a_url = '&lt;a href=&apos;http://www.albertus.edu/admission/index.shtml&apos;&gt;Admissions';
echo '<marker lat="41.331304" lng="-72.921438" html=" Albertus Magnus College&lt;br&gt;';
echo $window2a_url;
echo '" label="Albertus Magnus College" />'; 
```

我不得不避开撇号......如果有人有更优雅的解决方案，我全神贯注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T17:47:57.523

似乎您在字符串中添加了撇号 (')。您应该在撇号附近使用转义字符（可能是“\”，我不知道 PHP 的语法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-29T20:24:50.237

这是答案：

```
$window2a_url = '&lt;a
href=&apos;http://www.albertus.edu/admission/index.shtml&apos;&gt;Admissions';
echo '<marker lat="41.331304" lng="-72.921438" html=" Albertus Magnus College&lt;br&gt;';
echo $window2a_url;
echo '" label="Albertus Magnus College" />'; 
```

我不得不逃避撇号...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T18:20:07.973

另一个小伙子说了什么。

尝试：

```
echo '<marker lat="43.91892" lng="-78.89231" html="Albertus Magnus College&lt;br&gt;&lt;a href=\'http://www.albertus.edu/admission/index.shtml\'&gt;Admissions&lt;\/a&gt;" label="Albertus Magnus College" />'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T18:25:19.320

问题是 friol 表明您在链接中使用撇号结束回声，下面的代码应该可以工作，因为我转义了撇号（' to \'）

```
echo '<marker lat="43.91892" lng="-78.89231" html="Albertus Magnus College<br><a href=\'http://www.albertus.edu/admission/index.shtml\'>Admissions</a>" label="Albertus Magnus College" />'; 
```

# c# - 如何将表达式树编译为可调用方法 C#？

> ID：346523
> 
> 赞同：12
> 
> 时间：2008-12-06T17:36:01.713
> 
> 标签：c#, reflection, expression

我有一个表达式树，我通过使用 C# 中的表达式类解析 Xml 创建。[看到这个问题](https://stackoverflow.com/questions/344741/how-do-i-create-an-expression-tree-by-parsing-xml-in-c)。

我的表达式树中只有加、减、除、乘、参数和和或。有没有办法将此 ExpressionTree 转换为可调用方法？...还是我必须手动发出 IL？

亲切的问候，

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-06T17:52:09.823

您需要创建一个 lambda - 即

```
var lambda = Expression.Lambda<Func<float,int>>(body, param);
Func<float,int> method = lambda.Compile();
int v = method(1.0); // test 
```

`ParameterExpression`其中“body”是涉及参数的表达式树（采用浮点数，返回一个 int） 。

您可能还会发现[这个](http://www.yoda.arachsys.com/csharp/genericoperators.html)和[这个](http://marcgravell.blogspot.com/2008/10/express-yourself.html)很有帮助。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-06T22:21:42.540

这是两种方法的示例。如果我遗漏了什么，或者您想了解更多信息，请告诉我。

```
static void Main()
{
    // try to do "x + (3 * x)"

    var single = BuildSingle<decimal>();
    var composite = BuildComposite<decimal>();

    Console.WriteLine("{0} vs {1}", single(13.2M), composite(13.2M));
}
// utility method to get the 3 as the correct type, since there is not always a "int x T"
static Expression ConvertConstant<TSource, TDestination>(TSource value)
{
    return Expression.Convert(Expression.Constant(value, typeof(TSource)), typeof(TDestination));
}
// option 1: a single expression tree; this is the most efficient
static Func<T,T> BuildSingle<T>()
{        
    var param = Expression.Parameter(typeof(T), "x");
    Expression body = Expression.Add(param, Expression.Multiply(
        ConvertConstant<int, T>(3), param));
    var lambda = Expression.Lambda<Func<T, T>>(body, param);
    return lambda.Compile();
}
// option 2: nested expression trees:
static Func<T, T> BuildComposite<T>()
{

    // step 1: do the multiply:
    var paramInner = Expression.Parameter(typeof(T), "inner");
    Expression bodyInner = Expression.Multiply(
        ConvertConstant<int, T>(3), paramInner);
    var lambdaInner = Expression.Lambda(bodyInner, paramInner);

    // step 2: do the add, invoking the existing tree
    var paramOuter = Expression.Parameter(typeof(T), "outer");
    Expression bodyOuter = Expression.Add(paramOuter, Expression.Invoke(lambdaInner, paramOuter));
    var lambdaOuter = Expression.Lambda<Func<T, T>>(bodyOuter, paramOuter);

    return lambdaOuter.Compile();
} 
```

就个人而言，我的目标是第一种方法；它既简单又高效。这可能涉及在整个嵌套代码堆栈中传递原始参数，但就这样吧。我在某处有一些代码采用“调用”方法（复合），并将树重写为第一种方法（单一）-但它非常复杂且冗长。但对于实体框架（不支持 Expression.Invoke）非常有用。

# mysql - MySQL 5 的 UTF8 问题

> ID：346531
> 
> 赞同：4
> 
> 时间：2008-12-06T17:49:19.190
> 
> 标签：mysql, encoding, utf-8, phpmyadmin

我正在将我的 WordPress 博客和 phpBB 论坛迁移到新的托管服务器中。我正在使用 phpMyAdmin 从上一个站点的数据库中导入 SQL 脚本。

当我用 Kate 打开 .sql 脚本时，它说它使用 UTF8 作为编码。当我在新服务器中导入 sql 时，我在 phpMyAdmin 中有选择编码的选项，其中默认选择 utf8。

不过，当我完成导入数据库时​​，我直接在 phpMyAdmin 中阅读帖子文本，并看到诸如“é”、“ñ”等字符，这些字符尚未被“解释”并被替换为奇怪的字符。

我可以看到我的 WordPress 安装也无法正常工作。显然这个编码有问题，但我认为问题出在 MySQL 数据库或 phpMyAdmin 而不是 WordPress。

MySQL 的版本实际上是相同的，即 MySQL 5，但版本不同。还有，在迁移论坛数据库的时候没有问题，所以这个就更奇怪了……

我不知道如何解决这个问题......欢迎任何想法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-06T18:08:20.180

您是否尝试过添加

```
SET NAMES 'utf8'; 
```

到你的 sql 转储？

一般来说，使用 utf8 或编码的事情是，为了成功，您必须确保：

*   文件编码为 utf8 无签名
*   mysql服务器的默认编码设置为utf8
*   连接是 utf8 （这就是为什么你把 SET NAMES 'utf8' 放到你的 sql 文件中）。
*   所有表和列都有正确的编码和字符集
*   你所有的 web 文件也必须是 utf8 编码的。而且只添加正确的标题是行不通的。您必须打开文件，检查编码是否为 utf8，如果不是，则剪切所有内容，将编码更改为 utf8，然后将所有内容粘贴回来。它不起作用，如果您只是更改编码并保存文件！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T20:16:41.433

非常感谢你的回答。我找到了解决方案，我觉得以前没有意识到它真的很愚蠢。一切都应该正常工作：

- 文件用 utf8 编码 - 表用 utf8 声明：

```
SET character_set_client = utf8;
```

-MySQL 服务器配置了 utf8 等。

一开始我没有意识到我正在使用 cPanel 备份向导中的数据库备份。意识到这一点后，我在旧服务器上使用 phpMyAdmin 导出数据库，将其导入新服务器，然后，问题修复了。

phpMyAdmin 比 cPanel 更了解 phpMyAdmin :P 显然 cPanel 会导出脚本，以便将其与 cPanel 本身一起导入。这很可能也有效，但我更信任 phpMyAdmin。

非常感谢您的回答。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-25T08:11:14.967

我刚刚遇到了同样的问题，因为我与它搏斗了大约一个小时，它破坏了我的许多网站，我想我会看看是否有其他人在努力解决它并发布解决方案：解决方案很简单是在导入时指定导入字符集。

如果您可以通过 SSH 访问您的主机，首先再次将所有表再次删除到新数据库中，然后在 SSH 会话中运行此命令（假设您的旧转储文件是**olddatabase.dump.sql**）：

$ mysql -h *host* -u *username* -p *password* --default-character-set=utf8 *database* < olddatabase.dump.sql（用适当的值替换主机、用户名、密码和数据库）

这是解决问题的最简单、最直接的方法。

# c - 结构和联合之间的区别

> ID：346536
> 
> 赞同：445
> 
> 时间：2008-12-06T17:56:45.710
> 
> 标签：c, struct, unions

有什么好的例子可以说明 a`struct`和 a之间的区别`union`吗？基本上我知道它`struct`使用了其成员的所有内存并`union`使用了最大的成员内存空间。还有其他操作系统级别的差异吗？

* * *

## 回答 #1

> 赞同：725
> 
> 时间：2008-12-06T17:59:46.127

使用联合，您应该只使用其中一个元素，因为它们都存储在同一个位置。当您想要存储可能是几种类型之一的东西时，这非常有用。另一方面，结构体的每个元素都有一个单独的内存位置，它们都可以一次使用。

举一个具体的例子来说明它们的使用，不久前我正在研究一个 Scheme 解释器，我基本上是将 Scheme 数据类型覆盖到 C 数据类型上。这涉及在结构中存储一个指示值类型的枚举和一个存储该值的联合。

```
union foo {
  int a;   // can't use both a and b at once
  char b;
} foo;

struct bar {
  int a;   // can use both a and b simultaneously
  char b;
} bar;

union foo x;
x.a = 3; // OK
x.b = 'c'; // NO! this affects the value of x.a!

struct bar y;
y.a = 3; // OK
y.b = 'c'; // OK 
```

**编辑：**如果您想知道将 xb 设置为 'c' 会将 xa 的值更改为什么，从技术上讲，它是未定义的。在大多数现代机器上，一个 char 是 1 个字节，一个 int 是 4 个字节，所以给 xb 值 'c' 也会给 xa 的第一个字节同样的值：

```
union foo x;
x.a = 3;
x.b = 'c';
printf("%i, %i\n", x.a, x.b); 
```

印刷

```
99, 99 
```

为什么这两个值相同？因为 int 3 的最后 3 个字节全为零，所以它也读作 99。如果我们为 xa 输入一个更大的数字，你会发现情况并非总是如此：

```
union foo x;
x.a = 387439;
x.b = 'c';
printf("%i, %i\n", x.a, x.b); 
```

印刷

```
387427, 99 
```

为了仔细查看实际的内存值，让我们设置并打印出十六进制的值：

```
union foo x;
x.a = 0xDEADBEEF;
x.b = 0x22;
printf("%x, %x\n", x.a, x.b); 
```

印刷

```
deadbe22, 22 
```

您可以清楚地看到 0x22 覆盖 0xEF 的位置。

**但**

**在 C 中，未定义**int 中的字节顺序。这个程序在我的 Mac 上用 0x22 覆盖了 0xEF，但是在其他平台上它会覆盖 0xDE，因为构成 int 的字节顺序被颠倒了。因此，在编写程序时，永远不要依赖覆盖联合中特定数据的行为，因为它不可移植。

有关字节顺序的更多信息，请查看[endianness](https://en.wikipedia.org/wiki/endianness)。

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2008-12-06T18:32:00.727

这是简短的答案：结构是记录结构：结构中的每个元素分配新空间。所以，像这样的结构

```
struct foobarbazquux_t {
    int foo;
    long bar;
    double baz; 
    long double quux;
} 
```

为每个实例至少分配`(sizeof(int)+sizeof(long)+sizeof(double)+sizeof(long double))`内存中的字节。（“至少”因为架构对齐约束可能会强制编译器填充结构。）

另一方面，

```
union foobarbazquux_u {
    int foo;
    long bar;
    double baz; 
    long double quux;
} 
```

分配一块内存并给它四个别名。因此`sizeof(union foobarbazquux_u) ≥ max((sizeof(int),sizeof(long),sizeof(double),sizeof(long double))`，再次有可能为对齐添加一些内容。

* * *

## 回答 #3

> 赞同：60
> 
> 时间：2008-12-08T01:54:47.197

> 有没有很好的例子来说明“结构”和“联合”之间的区别？

一个虚构的通信协议

```
struct packetheader {
   int sourceaddress;
   int destaddress;
   int messagetype;
   union request {
       char fourcc[4];
       int requestnumber;
   };
}; 
```

在这个虚构的协议中，根据“消息类型”，标头中的以下位置将是请求号或四字符代码，但不能同时是两者。简而言之，联合允许相同的存储位置表示一种以上的数据类型，从而保证您在任何时候都只想存储其中一种数据类型。

联合在很大程度上是基于 C 作为系统编程语言的传统的低级细节，其中有时以这种方式使用“重叠”存储位置。您有时可以使用联合来节省内存，其中您有一个数据结构，其中一次只保存几种类型中的一种。

一般来说，操作系统不关心或不知道结构和联合——它们都只是它的内存块。结构是存储多个数据对象的内存块，这些对象不重叠。联合是存储多个数据对象的内存块，但仅存储其中最大的一个，因此在任何时候只能存储一个数据对象。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2008-12-06T18:21:07.767

正如您在问题中已经陈述的那样，`union`和之间的主要区别`struct`在于`union`成员相互覆盖内存，以便联合的 sizeof 是 one ，而`struct`成员一个接一个地布置（中间有可选的填充）。此外，联合大到足以容纳其所有成员，并且具有适合其所有成员的对齐方式。所以假设`int`只能存储在 2 字节地址并且是 2 字节宽，而 long 只能存储在 4 字节地址并且是 4 字节长。下面的联合

```
union test {
    int a;
    long b;
}; 
```

可以有`sizeof`4 的 a 和 4 的对齐要求。联合和结构都可以在末尾有填充，但不能在开头。写入结构只会更改写入的成员的值。写给工会的成员将使所有其他成员的值无效。如果您之前没有写过它们，则无法访问它们，否则行为是未定义的。GCC 提供了一个扩展，您实际上可以从工会成员那里阅读，即使您最近没有写信给他们。对于操作系统，用户程序是写入联合还是写入结构并不重要。这实际上只是编译器的问题。

union 和 struct 的另一个重要属性是，它们允许*指向它们的指针可以指向其任何成员的类型*。所以以下是有效的：

```
struct test {
    int a;
    double b;
} * some_test_pointer; 
```

some_test_pointer 可以指向`int*`or `double*`。如果您将类型的地址`test`转换为`int*`，它将指向它的第一个成员`a`，实际上。工会也是如此。因此，因为联合总是有正确的对齐方式，你可以使用联合来使指向某些类型有效：

```
union a {
    int a;
    double b;
}; 
```

该联合实际上将能够指向一个 int 和一个 double：

```
union a * v = (union a*)some_int_pointer;
*some_int_pointer = 5;
v->a = 10;
return *some_int_pointer; 
```

实际上是有效的，如 C99 标准所述：

> 对象的存储值只能由具有以下类型之一的左值表达式访问：
> 
> *   与对象的有效类型兼容的类型
> *   ...
> *   在其成员中包含上述类型之一的聚合或联合类型

编译器不会优化 ，`v->a = 10;`因为它可能会影响`*some_int_pointer`( 并且函数将返回`10`而不是`5`) 的值。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-09-06T20:26:27.067

A`union`在几个场景中很有用。 `union`可以是非常低级操作的工具，例如为内核编写设备驱动程序。

一个例子是通过使用带有位域的 a和 a 来剖析一个`float`数字。我在 中保存了一个数字，然后我可以通过它访问特定部分。该示例显示了如何使用不同的角度来查看数据。`union``struct``float``float``float``struct``union`

```
#include <stdio.h>                                                                                                                                       

union foo {
    struct float_guts {
        unsigned int fraction : 23;
        unsigned int exponent : 8;
        unsigned int sign     : 1;
    } fg;
    float f;
};

void print_float(float f) {
    union foo ff;
    ff.f = f;
    printf("%f: %d 0x%X 0x%X\n", f, ff.fg.sign, ff.fg.exponent, ff.fg.fraction);

}

int main(){
    print_float(0.15625);
    return 0;
} 
```

看看维基百科上的[单精度](https://en.wikipedia.org/wiki/Single_precision_floating-point_format)描述。我从那里使用了示例和幻数 0.15625。

* * *

`union`也可用于实现具有多种选择的代数数据类型。我在 O'Sullivan、Stewart 和 Goerzen 的“Real World Haskell”一书中找到了一个例子。请在“[受歧视的工会](http://book.realworldhaskell.org/read/defining-types-streamlining-functions.html)”部分查看。

干杯!

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2013-01-03T02:43:29.540

是的， struct 和 union 之间的主要区别与您所说的相同。struct 使用其成员的所有内存，而 union 使用最大的成员内存空间。

但所有区别都在于内存的使用需求。在我们使用信号的unix进程中可以看到联合的最佳用法。就像一个进程一次只能作用于一个信号。所以一般声明将是：

```
union SIGSELECT
{
  SIGNAL_1 signal1;
  SIGNAL_2 signal2;
  .....
}; 
```

在这种情况下，进程只使用所有信号的最高内存。但如果在这种情况下使用 struct ，内存使用量将是所有信号的总和。有很大的不同。

总而言之，如果您知道您一次访问任何一个成员，则应该选择 Union。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2008-12-06T18:06:13.867

“ **union** ”和“ **struct** ”是C 语言的*结构*。谈论它们之间的“操作系统级别”差异是不恰当的，因为如果您使用一个或另一个关键字，*编译器*会产生不同的代码。

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2008-12-06T18:30:27.170

你有它，仅此而已。但是，基本上，工会的意义何在？

您可以在同一位置放置不同类型的内容。您必须*知道*您在联合中存储的内容的类型（通常您将其放入`struct`带有类型标签的...）。

为什么这很重要？不是真的为了空间收益。是的，您可以获得一些位或做一些填充，但这不再是重点。

这是为了类型安全，它使您能够进行某种“动态类型”：编译器知道您的内容可能具有不同的含义，而您在运行时如何解释它的确切含义取决于您。如果你有一个可以指向不同类型的指针，你必须使用联合，否则你的代码可能会因为别名问题不正确（编译器对自己说“哦，只有这个指针可以指向这个类型，所以我可以优化出那些访问......”，并且可能会发生坏事）。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2015-12-16T06:04:56.017

非技术上的意思是：

假设：椅子=内存块，人=变量

**结构**：如果有3个人，他们可以坐在相应大小的椅子上。

**工会**：如果三个人**只有一张**椅子可以坐，大家想坐的时候都需要用同一张椅子。

从技术上讲意味着：

下面提到的程序深入探讨了结构和联合。

```
struct MAIN_STRUCT
{
UINT64 bufferaddr;   
union {
    UINT32 data;
    struct INNER_STRUCT{
        UINT16 length;  
        UINT8 cso;  
        UINT8 cmd;  
           } flags;
     } data1;
}; 
```

总 MAIN_STRUCT 大小 =sizeof(UINT64) for bufferaddr + sizeof(UNIT32) for union + 32 bit for padding（取决于处理器架构）= 128 bits 。对于结构，所有成员连续获取内存块。

Union 获得一个最大大小成员的内存块（这里是它的 32 位）。在联合内部还有一个结构（INNER_STRUCT），它的成员得到一个总大小为 32 位（16+8+8）的内存块。在联合中，可以访问 INNER_STRUCT（32 位）成员**或**数据（32 位）。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-12-06T17:58:56.597

结构分配其中所有元素的总大小。

联合仅分配其最大成员所需的内存。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2018-01-04T07:26:30.213

结构和联合有什么区别？

捷径的答案是：尊重在于内存分配。说明：在结构体中，会为结构体内部的所有成员创建内存空间。在联合中，只会为需要最大内存空间的成员创建内存空间。考虑以下代码：

```
struct s_tag
{
   int a; 
   long int b;
} x;

union u_tag
{
   int a; 
   long int b;
} y; 
```

这里 struct 和 union 内部有两个成员：int 和 long int。int 的内存空间是：4 字节，long int 的内存空间是：8 在 32 位操作系统中。

所以对于 struct 4+8=12 bytes 将被创建，而 8 bytes 将为 union 创建

代码示例：

```
#include<stdio.h>
struct s_tag
{
  int a;
  long int b;
} x;
union u_tag
{
     int a;
     long int b;
} y;
int main()
{
    printf("Memory allocation for structure = %d", sizeof(x));
    printf("\nMemory allocation for union = %d", sizeof(y));
    return 0;
} 
```

参考： http: [//www.codingpractise.com/home/c-programming/structure-and-union/](http://www.codingpractise.com/home/c-programming/structure-and-union/)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-06-30T09:27:47.293

结构是不同数据类型的集合，其中可以驻留不同类型的数据，并且每个数据都有自己的内存块。

当我们确定一次只使用一个变量并且您希望充分利用当前内存时，我们通常使用联合，因为它只获得一个等于最大类型的内存块。

```
struct emp
{
    char x; //1 byte
    float y; //4 byte
} e; 
```

它获得的总内存：=> 5 个字节。

```
union emp
{
    char x; //1 byte
    float y; //4 byte
} e; 
```

它获得的总内存：4 个字节。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-07-13T10:12:07.310

当需要专门类型的对话时，经常使用联合联合。了解联合的用处。c/c 标准库没有定义专门用于将短整数写入文件的函数。使用 fwrite() 会导致简单操作的额外开销。但是，使用联合，您可以轻松创建一个函数，该函数一次将一个短整数的二进制写入文件一个字节。我假设短整数是 2 字节长

这个例子：

```
#include<stdio.h>
union pw {
short int i;
char ch[2];
};
int putw(short int num, FILE *fp);
int main (void)
{
FILE *fp;
fp fopen("test.tmp", "wb ");
putw(1000, fp); /* write the value 1000 as an integer*/
fclose(fp);
return 0;
}
int putw(short int num, FILE *fp)
{
pw word;
word.i = num;
putc(word.c[0] , fp);
return putc(word.c[1] , fp);
} 
```

虽然 putw() 我用短整数调用，但可以使用 putc() 和 fwrite()。但我想展示一个例子来说明如何使用联合

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-11-04T19:41:21.280

在编写下面给出的字节排序函数时，联合会派上用场。结构是不可能的。

```
int main(int argc, char **argv) {
    union {
        short   s;
        char    c[sizeof(short)];
    } un;

    un.s = 0x0102;

    if (sizeof(short) == 2) {
        if (un.c[0] == 1 && un.c[1] == 2)
            printf("big-endian\n");
        else if (un.c[0] == 2 && un.c[1] == 1)
            printf("little-endian\n");
        else
            printf("unknown\n");
    } else
        printf("sizeof(short) = %d\n", sizeof(short));

    exit(0);
}
// Program from Unix Network Programming Vol. 1 by Stevens. 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-10-21T11:51:10.957

Union 与结构不同，因为 Union 在其他方面重复：它重新定义相同的内存，而结构一个接一个地定义，没有重叠或重新定义。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2022-03-03T07:36:04.683

当我们需要对具有一组独立属性的事物进行建模时，建议使用结构，当实体具有多种形式并且一次只能以一种形式存在时，应使用联合。

让我们看看可以应用它们的 2 个地方

您需要存储和更新汽车的值。为此，我们需要记录汽车的所有属性，例如型号、里程、价格和燃料类型。这些值始终存在于汽车中，它们不依赖于其他值。因此，我们需要一种数据类型，它不仅可以存储我们所有的属性，还可以确保它们的正确更新。这种类型的任务可以使用结构来完成。

```
struct car{
    char model[];
    int mileage;
    int price;
    char fuel_type[];
}; 
```

组织需要从大量客户那里收集您的数据以进行付款验证。现在，为了数据完整性和客户安全，组织被指示从个人那里获取最少数量的详细信息。这些详细信息可以是您的 PAN 号码或帐号或选民 ID。现在，由于我们需要收集这些细节中的任何一个，同时还要提高内存效率，我们可以在这里使用联合。它将仅保存提供给它的单个值。

```
union verification_details{
    char account_number[10];
    char PAN[10];
    char voter_id[10];
}; 
```

我发现以下文章很好地解释了它：[结构与联合之间的区别](https://www.scaler.com/topics/difference-between-structure-and-union/)

# jquery - 使用jQuery，当名称和值已知时如何定位元素

> ID：346542
> 
> 赞同：14
> 
> 时间：2008-12-06T17:59:48.403
> 
> 标签：jquery, css-selectors

感谢您阅读本文

我以为我可以使用 find()，但无法使其工作。我知道我可以添加 ID 或类名，但想知道如何使用当前标记。

谢谢

这是HTML

```
<input name="keywordCheckbox" type="checkbox" value="S" />
<input name="keywordCheckbox" type="checkbox" value="C" />
<input name="keywordCheckbox" type="checkbox" value="A" /> 
```

和js

```
<script language="Javascript" src="javascript/jquery-1.2.6.min.js"></script>
<script type="text/JavaScript">

 $(function(){
  $('[name="keywordCheckbox"]').bind("click",
   function() {
    if($(this).attr("checked") == true) {
     switch(this.value) {
      case "A":
       var $_this = $(this) ;
       $('[name="keywordCheckbox"]').each(function() {
        if($(this).val() != $($_this).val()) { $(this).attr("checked",false); }
       });
       break ;
      default:
 DOESN'T WORK --> $('[name="keywordCheckbox"]').find('[value="A"]').attr("checked", false);}
      } // END Switch
    } // END If
  }); // End BIND
 }); // End eventlistener
 </script> 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-06T18:14:04.710

您应该能够链接属性选择器：

```
 $('input[name="keywordCheckbox"][value="A"]').attr("checked",false); 
```

对于名称为keywordCheckbox 和值为A 的输入，将checked 设置为false。

```
 $('input[name="keywordCheckbox"][value!="A"]').attr("checked",false); 
```

对于名称为keywordCheckbox 且值不是A 的输入，会将checked 设置为false。

**编辑**

我刚刚使用最新的 jQuery 在 Firefox/Macintosh 中测试了以下内容。工作正常。您使用的是什么版本的 jQuery？

```
$(document).ready( function() {
    $('input[name=keywordCheckbox]').bind( 'click', function() {
       if (this.checked) {
          if (this.value == 'A') {              
             $('input[name="keywordCheckbox"][value!="A"]')
                .attr("checked",false);
          }
          else {
             $('input[name="keywordCheckbox"][value="A"]')
                .attr("checked",false);
          }
       }
    });
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-06T18:13:32.633

或者你可以这样做：

```
$("input[name='keywordCheckbox']").filter("input[value='A']") 
```

那么就不需要 each 函数了。

# javascript - 取消慢速加载远程 JS 调用的最佳方法

> ID：346544
> 
> 赞同：1
> 
> 时间：2008-12-06T18:03:37.770
> 
> 标签：javascript, scripting, onload

我有一个必须出现在文档头部的远程 JS。如果服务器响应缓慢或无法访问，显然这会减慢或阻止页面加载。我一直在寻找一种简单的方法来设置 3 秒（可能更少）的限制，让它放弃并且根本不加载功能。

有没有人有一个简单的方法来只用 Javascript 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T18:15:44.627

页面加载完成后包含 .JS 文件：

```
<script type='text/javascript'>
window.onload = function(){
 document.write("<script type='text/javascript' src='http://domain.com/file.js'></script>");
}
</script> 
```

将其放在文档的 HEAD 中，然后在页面完成加载后文件将开始加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T03:47:43.803

如果这是一个问题，请将 .js 分开，并在 onload=""; 中使用低端 css 函数和慢速函数；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T04:02:34.740

如果调用**window.onload**事件对您来说太晚了，那么只需将您的 javascript 文件直接内联到页面中。

# c# - 在浏览器中流式传输 Pdf 时如何设置文件名？

> ID：346546
> 
> 赞同：9
> 
> 时间：2008-12-06T18:06:03.010
> 
> 标签：c#, .net, pdf, streaming, memorystream

不确定如何准确地表达这个问题......所以欢迎编辑！无论如何......这里去。

我目前正在使用 Crystal Reports 生成 Pdfs，并将输出流式传输给用户。我的代码如下所示：

```
System.IO.MemoryStream stream = new System.IO.MemoryStream();

stream = (System.IO.MemoryStream)this.Report.ExportToStream(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat);

this.Response.Clear();
this.Response.Buffer = true;
this.Response.ContentType = "application/pdf";
this.Response.BinaryWrite(stream.ToArray());
this.Response.End(); 
```

此代码运行后，它将 Pdf 流式传输到打开 Acrobat Reader 的浏览器。效果很好！

我的问题是当用户尝试保存文件时，它默认为实际文件名......在这种情况下，它默认为 CrystalReportPage.pdf。无论如何我可以设置这个吗？如果是这样，怎么做？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-06T18:07:17.000

通常，通过 content-disposition 标头 - 即

```
Content-Disposition: inline; filename=foo.pdf 
```

因此，只需使用 Headers.Add 或 AddHeader 或其他任何内容：

response.Headers.Add("Content-Disposition", "inline; filename=foo.pdf");

（内联是“在浏览器中显示”，附件是“另存为文件”）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-06T18:10:20.253

```
System.IO.MemoryStream stream = new System.IO.MemoryStream();

stream = (System.IO.MemoryStream)this.Report.ExportToStream(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat);

this.Response.Clear();
this.Response.Buffer = true;
this.Response.ContentType = "application/pdf";
this.Response.AddHeader("Content-Disposition", "attachment; filename=\""+FILENAME+"\"");
this.Response.BinaryWrite(stream.ToArray());
this.Response.End(); 
```

# regex - 如何将常规引号（即'、"）转换为 LaTeX/TeX 引号（即`'、`''）

> ID：346567
> 
> 赞同：8
> 
> 时间：2008-12-06T18:23:38.777
> 
> 标签：regex, latex, quotes

给定一个用普通引号写的文档，例如

```
Ben said "buttons, dear sir".
I replied "Did you say 'buttons'?" to him. 
```

有什么方法可以将这些东西变成 LaTeX 引号，具有适当的语义。IE

```
Ben said ``buttons, dear sir''.
I replied ``Did you say `buttons'?'' to him. 
```

所以 LaTeX 产生：

```
Ben said “buttons, dear sir”.
I replied “Did you say ‘buttons’?” 
```

我的第一个想法是转向正则表达式。但是，我没有从 Google 或“LaTeX 引用正则表达式”的正则表达式库中获得任何点击，当然“TeX 引用正则表达式”似乎返回太多。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T18:56:43.250

一般来说，这个问题比看起来要难。

最简单的情况*可以*用正则表达式处理，但对于更一般的情况，您几乎肯定需要构建一个递归解析器：正则表达式只有在没有嵌套的情况下才能工作。

最大的问题将与识别`"'"`未配对的单个 s 相关 - 就像收缩一样（`"'"`in`"don't"`不应该更改，*也不*应该配对）。

* * *

让我们看看我们是否可以编写一个可用的 EBNF 描述：

```
input:       text+
text:        uquote|squote|dquote
squote       "'" text "'"
dquote       """ text """
uquote:      [contraction|.]+
contraction: [A-Za-z]+ "'" [A-Za-z]+ 
```

这仅限于`"'"`单词中间有的缩写。所有关联的操作只会回显输入，除了`squote`和`dquote`术语会根据需要替换引号。

* * *

我使用正则表达式和人工修复来完成一个相当简单的一次性工作，但这对于正在进行的工作来说会是劳动密集型的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-26T22:52:28.783

这是我用于我的 Latex 文档的 python 正则表达式：

```
'([ \w-]+)'", " `\\1' 
```

有一个 python 脚本将正则表达式应用于乳胶文件（[here](http://david-web.appspot.com/cnt/LatexQuotes/)）。大部分时间都在工作。排版快乐！:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T18:56:48.383

以下是一些 Perl 正则表达式替换，它们可能足以满足您的需求。

```
s/"(\w)/``$1/g;
s/'(\w)/`$1/g;
s/([\w\.?!])"/$1''/g; 
```

该代码假定单引号或双引号后跟一个字母数字字符开始一个引号。此外，它假定字母数字字符或标点符号后面的双引号结束引号。这些假设在大多数情况下可能是正确的，但也可能有例外。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T19:17:05.097

感谢您的意见 - 有帮助和赞赏。

我也遇到过这个，来自 CPAN 的[Latex::Encode.pm](http://search.cpan.org/src/ANDREWF/LaTeX-Encode-0.03/lib/LaTeX/Encode.pm)：

```
 # A single or double quote before a word character, preceded
    # by start of line, whitespace or punctuation gets converted
    # to "`" or "``" respectively.

    $text =~ s{ ( ^ | [\s\p{IsPunct}] )( ['"] ) (?= \w ) }
              { $2 eq '"' ? "$1``" : "$1`" }mgxe;

    # A double quote preceded by a word or punctuation character
    # and followed by whitespace or end of line gets converted to
    # "''".  (Final single quotes are represented by themselves so
    # we don't need to worry about those.)

    $text =~ s{ (?<= [\w\p{IsPunct}] ) " (?= \s | $ ) }
              { "''" }mgxe 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T19:23:17.720

不要对这类任务使用正则表达式！

也许您可以从[SmartyPants](http://daringfireball.net/projects/smartypants/)获得一些灵感？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-18T02:48:28.067

我一直在寻找这个问题的答案，并决定今天学习一点 lisp。我把这个 lisp 函数放在我的 ~/.emacs 文件中，然后运行`M-x tex-set-quotes`：

```
(defun tex-set-quotes ()  
  (interactive)  
  (latex-mode)  
  (while (search-forward "\"" nil t)  
   (replace-match "" nil t)  
   (tex-insert-quote nil))) 
```

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2011-12-13T01:16:50.860

简单地说，使用 `` 开始报价和 '' 结束

# sql - 如何查询上个月最近的10个项目或项目，以多者为准？

> ID：346568
> 
> 赞同：2
> 
> 时间：2008-12-06T18:25:16.247
> 
> 标签：sql, mysql

在我的博客上，我想显示上个月的所有帖子。但如果少于 10 个帖子，我想显示最近的 10 个帖子（换句话说，首页上的帖子永远不应少于 10 个）。我想知道是否有办法在单个查询中执行此操作？

目前，我首先运行这个查询：

```
select count(*) from posts where timestamp > ($thirty_days_ago)
order by timestamp desc 
```

如果该计数大于或等于 10：

```
select * from posts where timestamp > ($thirty_days_ago)
order by timestamp desc 
```

除此以外：

```
select * from posts order by timestamp desc limit 10 
```

但这需要我运行两个查询。有没有更有效的方法可以通过单个查询来做到这一点？（我正在使用 MySQL。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T18:36:00.233

```
(SELECT * FROM posts
WHERE `timestamp` >= NOW() - INTERVAL 30 DAY)
UNION
(SELECT * FROM posts
ORDER BY `timestamp` DESC
LIMIT 10); 
```

**编辑：** 回复@doofledorfer的评论：我在我的测试数据库上运行了这个，它运行良好。我尝试与`timestamp`上面查询中显示的日期文字和常量表达式进行比较，但这对优化计划没有影响。当然，我使用的数据量很小，如果有数千行，优化计划可能会有所不同。

在任何情况下，OP 都在询问如何在单个查询中获得正确的结果，*而不是*如何使执行计划优化。这毕竟是一个 UNION 查询，并且必然会导致文件排序。

```
+------+--------------+------------+------+---------------+------+---------+------+------+----------------+
| id   | select_type  | table      | type | possible_keys | key  | key_len | ref  | rows | Extra          |
+------+--------------+------------+------+---------------+------+---------+------+------+----------------+
|  1   | PRIMARY      | posts      | ALL  | timestamp     | NULL | NULL    | NULL |   20 | Using where    | 
|  2   | UNION        | posts      | ALL  | NULL          | NULL | NULL    | NULL |   20 | Using filesort | 
| NULL | UNION RESULT | <union1,2> | ALL  | NULL          | NULL | NULL    | NULL | NULL |                | 
+------+--------------+------------+------+---------------+------+---------+------+------+----------------+ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T19:29:03.170

只需这样做：

```
select * from posts order by timestamp desc limit 100 
```

并在内存中进一步过滤结果。（假设 100 是人们希望在单个页面中看到的“一个月内的帖子”的实际上限）

这是一个“更高效的单一查询”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T18:36:50.043

我可以看到它只使用一个查询的唯一方法是执行“select * from posts order by timestamp”，它返回所有帖子，然后处理代码中的显示逻辑。但是，这不是一个非常有效的解决方案。

只要您的表正确编入索引，然后执行 select count(*) 后跟检索查询就不会影响性能。是否有任何特殊情况会使您特别尝试避免第二次查询？否则，我认为您上面的解决方案就足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T18:48:17.103

不，没有更有效的方法。我会按照你在问题中描述的方式来做。如果按照我上面的评论修改谓词，比尔卡尔文的答案大致相同。

到目前为止，我看到的所有其他建议的效率都低得多，即使它们以某种方式返回了正确的结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T19:26:19.943

您是否正在寻找单个表扫描（例如一个 SELECT）？还是到数据库服务器的单次往返？比尔的答案只有一次往返，但有两个 SELECT ......所以这是否构成一个或两个“查询”取决于您说“查询”时实际在寻找什么。

如果您对数据库的延迟非常高，那么像 Bill 的解决方案是最好的，因为您不需要等待太多的通信。如果数据库本身已加载并且表扫描很昂贵，那么您的原始实现可能会更好，原因有两个：

*   您可以缓存`COUNT`结果，因此它仅每 10 分钟左右执行一次。现在您已经有效地摊销了该查询的成本（如果 200 位访问者在 10 分钟内访问该页面，您只发布了 201 条`SELECT`语句）。
*   数据库引擎可以优化`COUNT`查询以命中索引而不是整个表，这比尝试将`UNION`多个数据集放在一起要快得多。我不确定 MySQL 是否足够复杂，可以做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-06T18:53:11.213

我认为您可以尝试以下方法：

```
select * from posts 
where (timestamp >= (NOW() - INTERVAL 30 DAY)) or 
(post_id in (select post_id from posts order by timestamp desc limit 10))
order by timestamp desc 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-06T18:53:55.300

**想法1**：做一个查询来获取这个月的帖子。然后做一个循环，计算获取的帖子数。当且仅当此数字小于 10 时，才进行第二次查询。

**想法 2**：为什么不*缓存*您的第一个查询（例如[Google App Engine](http://code.google.com/appengine/)有缓存 API）？本月的帖子数量不太可能经常更改，因此在大多数情况下，您无需进行第一次查询。

# assembly - ELF 格式的可重定位符号（汇编语言）

> ID：346572
> 
> 赞同：10
> 
> 时间：2008-12-06T18:26:58.723
> 
> 标签：assembly, gnu, elf

我们正在为客户端架构开发 GNU 汇编程序的一个端口。现在面临的问题是：

如果一条指令的立即操作数是一个涉及多个可重定位符号的表达式，它在输出文件中如何处理elf格式。这种情况下会产生什么搬迁信息？

例如：

```
j label1 + label2 
```

其中 label1 和 label2 定义在可重定位节中，它们可能是相同的节，也可能是不同的可重定位节。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T22:09:58.040

ELF 本身并不了解指令。它知道指令中符号偏移的特定编码。在汇编程序中，您需要输出两个重定位记录，每个记录都带有相应的 [address,type,symbol] 三元组，以正确修补指令的该部分。链接器甚至不一定知道这两条记录指向同一条指令。

ELF 重定位类型完全依赖于 CPU（或者更准确地说，依赖于 ISA），因此您可以自由定义新架构所需的任何重定位。

如果没有指令编码的细节，很难更具体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T19:33:06.203

我知道关于 ELF 的杰克，并且只知道一点关于链接的信息，但是......

我希望每个操作数的处理方式与只有一个操作数相同。

OTOH 的问题可能是格式`j`会根据标签的位置而改变？如果是这样，我*认为*你已经沉没了，因为链接器不够聪明，无法做那种事情（ADA 构建系统 IIRC 可能比大多数人更聪明，所以你可能会看看它。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T00:32:49.873

对于需要重定位的每条指令，我希望每个地址都有一个条目。

Objdump 可能能够显示可执行文件或目标文件的重定位表，但我不知道这些标志。

我的建议是尝试挖掘一个 x86（或其他 CISC）指令，该指令执行与您的客户端架构类似的操作，并查看在您组装/链接它时会生成哪些重定位。

# c# - 使用 ADO.NET 创建新数据库 (.mdb)

> ID：346581
> 
> 赞同：3
> 
> 时间：2008-12-06T18:33:03.500
> 
> 标签：c#, database, ado.net, ms-jet-ace

如何创建一个空的 .mdb 文件？我正在使用 ADO.NET 和 C#。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-06T19:08:17.547

复制预先存在的 .mdb 文件是最好的方法。

ADO.NET 可以连接到的大多数其他基于文件的数据库格式也是如此，例如 Excel 文件。由于基于文件的数据库系统使用文件系统作为它的主机和用于与外部世界通信的 API（而不是使用 TCP-IP 通信的 MSSQL），因此很自然地使用 System.IO 来执行 MS- SQL 将使用 T-SQL 或系统存储过程或以这些为目标的数据特定 API 完成（在 SQL 服务器的情况下例如 SMO）。

`COPY model.mdb newdb.mdb` 是创建数据库命令

`DEL newdb.mdb is the drop`DB命令等

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T19:24:10.403

我认为没有“.NET native”的方法可以做到这一点，但你仍然可以包装 ADOX：

```
using ADOX;  // add a COM reference to "Microsoft ADO Ext. x.x for DDL and Security" 

static void CreateMdb(string fileNameWithPath)
{
  ADOX.Catalog cat = new ADOX.Catalog();
  string connstr = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0};Jet OLEDB:Engine Type=5";
  cat.Create(String.Format(connstr, fileNameWithPath));
  cat = null;
} 
```

# c# - C# - 如何确保我的所有结构都已初始化？

> ID：346589
> 
> 赞同：6
> 
> 时间：2008-12-06T18:39:41.850
> 
> 标签：c#, struct, value-type

我正在用 C# 编写一个应用程序，它将进行大量计算。一切都围绕着基本结构——价值。它基本上是双倍的，带有一些额外的参数（精度等）。它必须是一个结构，因为会创建太多的结构来提供堆分配。现在，我需要确保它们都已正确初始化。我不能声明默认的显式构造函数，尽管我提供了默认构造函数，它用 0 初始化所有内容，这在我的域中没有意义。

如果不使用参数调用我的构造函数，就无法拒绝创建实例......？

基本上我需要的是通过这个测试：

```
[Test]
public void HowDoesThisStructureInitializeByDefault()
{
   Value v = new Value(); - if this did not compile - it would have been ok!

   Assert.AreEqual(0, v.Val); - passes
   Assert.AreEqual(-1, v.Accuracy); - fails
} 
```

如果没有显式调用构造函数并且仍然访问结构，则抛出异常是可以的，但是检查所有时间将花费太多时间。

我现在几乎失去了希望，请帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T19:03:44.187

为什么不能定义显式构造函数？这就是他们*的*目的。此外，为什么您认为您“负担不起堆分配”？托管语言中的堆分配非常便宜。你是如何测试这个假设的，即你负担不起堆分配，或者堆分配一开始就更昂贵？

（对于由“一个双参数和几个参数”组成的类型，我怀疑你的大小已经达到堆分配实际上更便宜和更有效的程度）

在任何情况下，如果用户愿意，您*都不能*阻止用户在值类型上调用默认构造函数。您所能做的就是确保存在一种更好的初始化值的方法，例如非默认构造函数，或者如果您出于某种原因无法创建一个，则可以在调用时创建并初始化您的值类型的函数。

但是，当然，您不能保证人们会真正调用它。

*编辑：* .NET 中的堆分配*基本上*只包含一个简单的堆栈推送操作。这是托管（和垃圾收集）语言的好处。运行时本质上使用一个大堆栈作为其堆，因此每次分配只是将堆栈指针增加一点（当然，在检查是否有足够的可用内存之后）。然后垃圾收集器在必要时负责压缩内存。

所以堆分配*本身*非常便宜。当然，额外的 GC 压力可能会再次减慢您的速度（尽管据我所知，GC 传递所需的时间仅取决于活动对象的数量，而不取决于要 GC 的对象，因此有无数“死”的对象可能不是什么大问题），但另一方面，堆栈分配也不是免费的。值类型是按值传递的，因此每次将类型作为参数传递给函数或返回时，都必须进行复制。我不知道你的值有多大，但一个双精度是 8 个字节，鉴于你有一些额外的参数，我假设 32 个字节。这*可能*是如此之大，以至于值类型所需的额外复制使其比使用堆分配时要慢。也许。

如您所见，值类型和引用类型都有优势。我不能说在你的情况下哪个更快，但如果我是你，我会非常小心地做出这种假设。如果可能，构建您的代码，以便您可以在引用类型和值类型实现之间切换，并查看哪个效果最好。或者，编写较小的测试来尝试预测每个测试在大规模上的表现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T19:10:42.240

您无法摆脱默认构造函数（当然，Jon Skeet 在[Why can't I define a default constructor for a .NET in .NET? 中](https://stackoverflow.com/questions/333829/why-cant-i-define-a-default-constructor-for-a-struct-in-net#333840)很好地回答了为什么），但您可以创建一个允许您的工厂类使用正确初始化的参数定义结构值。您可以将单元测试与模拟/验证一起使用，以确保当您的代码创建新值时，它们使用工厂。这将是您需要强制执行的约定，因为编译器不会为您强制执行它。

```
public static class StructFactory
{
    public static Value DefaultValue()
    {
         Value v = new Value();
         v.Value = 0.0;
         v.Accuracy = 15; /* digits */
         return v;
    }
}

...

Value v = StructFactory.DefaultValue(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T19:15:14.430

结构字段初始化为零（或 null，或通常为 default(T)）。

如果您希望 Accuracy 的初始值为 -1，则可以实现 Accuracy 属性，以便当基础字段 == 0 时，该属性返回 -1。

一种可能：

```
struct Value
{
  int _accuracyPlusOne;

  public int Accuracy
  { 
    get { return _accuracyPlusOne - 1; }
    get { _accuracyPlusOne= value + 1; }
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-06T19:01:54.503

我认为 C# 不允许您在值类型上创建默认构造函数。有几个与您的问题相关的问题：

*   [为什么我不能在 .NET 中为结构定义默认构造函数？](https://stackoverflow.com/questions/333829)
*   [如何在 C# 中的结构上强制使用工厂？](https://stackoverflow.com/questions/341957)

在 IL 中有一种方法可以做到这一点，但初始化数组仍然不会调用这些构造函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-06T19:00:44.053

您是否希望使用默认构造函数将精度初始化为 -1？我不认为你可以阻止某人使用`new Value()`，但你可以添加一个构造函数，让你使用`new Value(10)`并按照你想要的方式初始化准确性。

请参阅有关 [结构构造函数]( [http://msdn.microsoft.com/en-us/library/aa288208(VS.71).aspx)](http://msdn.microsoft.com/en-us/library/aa288208(VS.71).aspx))的 MSDN 页面。

如果您遇到 0 的准确度（如果该值永远没有意义！），您总是可以在使用您的结构的代码中抛出异常。

# wcf - 在应用程序终止时，WCF 中 IsOneWay=true 的方法会发生什么

> ID：346594
> 
> 赞同：4
> 
> 时间：2008-12-06T18:44:37.220
> 
> 标签：wcf, termination, isoneway

我有一个客户端应用程序，它会偶尔通知它的服务进度。对服务的方法调用标记为 IsOneWay=true，因为通知不需要任何返回值，我不想延迟。

客户端可能会向服务通知错误，然后它会终止。

问题是：单向方法调用发送消息后是否返回调用者代码？还是将消息排队，然后由另一个线程发送？

两个进程（客户端和服务）在同一台机器上，我注意到有时（当机器过载时）服务没有收到错误通知。我怀疑我提到的第二种选择会发生，但我不确定。

如果我是对的，我如何确保发送通知并保持方法单向？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-01-24T22:11:29.977

好问题。在客户端应用程序调用方法之前，它会打开通道。该通道用于所有数据通信。有两种发送方式：1) 可靠会话 - 当您的数据包被可靠地卸载并重新发送破解的数据包时，2) 排序 - 当服务上的请求按照它们从客户端传输的顺序计算时（而不是它们的传递方式） . 如果您有可靠的有序会话并且服务主机在关闭应用程序后遇到一些数据问题，主机将尝试询问客户端重新发送数据，并且在没有响应后拒绝您的所有请求。在其他情况（不可靠）打开通道后，您可以发送数据并破坏通信，如果没有异常，单向方法将计算您的请求。

为了测试服务问题的一些可能性（但不完全是您的客户问题很有帮助），我创建了一个解决方案：

1) 带有一个文件“IService1.cs”的库项目“WcfContracts”：

```
 [ServiceContract]
    public interface IService1
    {
        [OperationContract]
        void ThrowException();

        [OperationContract(IsOneWay=true)]
        void ThrowExceptionUseIsOneWay();
    } 
```

2) 控制台项目“WcfConsoleHoster”，它引用了两个“WcfContracts”，由三个文件组成：

a) Service1.cs，即服务实现

```
public class Service1 : WcfContracts.IService1
{    
        public void ThrowException()
        {
            throw new Exception("Basic exception");
        }

        public void ThrowExceptionUseIsOneWay()
        {
            throw new Exception("Basic exception using IsOneWay=true");
        }
} 
```

b) Program.cs，它有默认入口点，只是启动服务

```
static void Main(string[] args)
    {
        ServiceHost host = new ServiceHost(typeof(Service1));
        host.Open();
        Console.WriteLine("host 1 opened");
        Console.ReadKey();
    } 
```

c) 服务“App.config”

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <services>
      <service behaviorConfiguration="behavourHttpGet" name="WcfConsoleHoster.Service1">
        <host>
          <baseAddresses>
            <add baseAddress="http://localhost:8732/Design_Time_Addresses/WcfConsoleHoster/Service1/" />
          </baseAddresses>
        </host>
        <endpoint binding="wsHttpBinding" contract="WcfContracts.IService1" />        
        <endpoint address ="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="behavourHttpGet">
          <serviceMetadata httpGetEnabled="true" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel>
</configuration> 
```

3）控制台项目“WcfConsoleClient”，简单调用服务

a) 在“Program.cs”中

```
Console.WriteLine("Wcf client. Press any key to start");
Console.ReadKey();
ChannelFactory<IService1> factory = new ChannelFactory<IService1>("Service1_Endpoint");
IService1 channel = factory.CreateChannel();
//Call service method
channel.ThrowException();

Console.WriteLine("Operation executed");
Console.ReadKey(); 
```

b) 客户端“App.config”

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.serviceModel>
    <client>
      <endpoint name="Service1_Endpoint"
        address="http://localhost:8732/Design_Time_Addresses/WcfConsoleHoster/Service1/"
        binding="wsHttpBinding"
        contract="WcfContracts.IService1">
      </endpoint>
    </client>
  </system.serviceModel>
</configuration> 
```

* * *

**1\. 抛出异常。**首先，我们调用*两种方法*在服务器主机中引发异常。然后这个异常返回到客户端，通道在客户端引发它，应用程序被销毁。当然，您可以使用 try()catch{} 块来处理这个问题。

让我们*通过*调用`channel.ThrowExceptionUseIsOneWay();`. 服务主机出现异常，但客户端没有异常，我们得到“操作已执行”。重要的是要意识到该频道将无法用于下一次使用。

所以`IsOneWay=true`按预期工作 - 它仅以一种方式发送消息。您不能从方法返回任何对象（预期为 void），也不能使用 FaultContract，或在服务启动后获取 InvalidOperationException。

**2\. 线程.睡眠（）。**下一个测试是使用`Thread.Sleep()`. `IService1`扩展到

```
 [OperationContract]
  int ThreadSleep();

  [OperationContract(IsOneWay=true)] 
```

而Service1.cs中的实现是*等待5秒*

```
public int ThreadSleep()
{
    System.Threading.Thread.Sleep(TimeSpan.FromSeconds(5));
    return 1;
}

public void ThreadSleepUseIsOneWay()
{
    System.Threading.Thread.Sleep(TimeSpan.FromSeconds(5));
} 
```

现在对客户端进行一些修改以计算经过的调用时间

```
System.Diagnostics.Stopwatch stopwatch = new System.Diagnostics.Stopwatch();
stopwatch.Start();
//call methode
channel.ThreadSleep();
stopwatch.Stop();
Console.WriteLine(string.Format("Operation executed in {0} seconds", stopwatch.Elapsed.Seconds));
Console.ReadKey(); 
```

调用*双向方法* `ThreadSleep()`的结果是“操作在 7 秒内执行”（线程休眠 5 秒 + 通道初始化 2 秒）。

`One way method`with call`channel.ThreadSleepUseIsOneWay()`的结果是“0 秒”！无需等待服务响应！

最好使用[NetNamedPipeBinding](http://msdn.microsoft.com/en-us/library/system.servicemodel.netnamedpipebinding.aspx)，它是在同一台机器上可靠且快速的连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T23:38:50.013

Check out this post for some detailed info: [http://kennyw.com/?p=130](http://kennyw.com/?p=130)

Also, I believe that if you have reliable messaging enabled that the request would be verified as sent successfully, but as the above post notes, the service will end the connection after that point.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-31T19:43:23.407

这可能是使用 netMsmqBinding 的好地方。所有 MSMQ 消息本质上都是 OneWay，因为队列本质上是断开连接的。一旦客户端将消息与 netMsmq 客户端进行排队，它就可以安全地关闭，服务器稍后可以拾取消息并处理它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T19:50:04.123

您不能“确保发送通知”......并且“保持方法单一”。这有点违背“OneWay”的意思:)

如果要确保消息发送，可以做TwoWay。您很可能不会注意到轻微的性能影响。如果服务器和客户端与您提到的位于同一台机器上……那么您根本不会注意到性能下降。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-22T17:16:39.997

我有一个类似的问题（单向调用不做任何事情或抛出异常）。我发现负责将方法参数从 xml 转换回对象的反序列化器正在创建异常。我的服务方法永远无法到达，也没有返回异常，因为它是单向调用。在我暂时禁用“单向”之前我没有检测到它，所以我的异常被传播回客户端。

希望这可以帮助处于类似情况的其他人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-03T21:54:45.000

我同意蒂莫西的观点。我还想补充一点，WCF 服务为传入消息保留一个队列。如果服务无法像消息传入一样快地处理消息，该队列可能会变满。当传入队列变满时，WCF 将丢弃新消息。

我不确定如果单向消息被丢弃，客户端会发生什么。我假设没有抛出异常/错误，但我不确定。

# c++ - 如何退出 C++ 中的 void 函数？

> ID：346613
> 
> 赞同：173
> 
> 时间：2008-12-06T19:07:54.973
> 
> 标签：c++

如果它是一个 void 函数，你怎么能过早地退出一个函数而不返回一个值？如果某个条件为真，我有一个 void 方法不需要执行其代码。我真的不想改变方法来实际返回一个值。

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-12-06T19:10:11.943

使用退货声明！

```
return; 
```

或者

```
if (condition) return; 
```

如果您的方法返回，您不需要（也不能）指定任何值`void`。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-12-06T19:10:44.970

你的意思是这样吗？

```
void foo ( int i ) {
    if ( i < 0 ) return; // do nothing
    // do something
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-06T19:11:51.503

```
void foo() {
  /* do some stuff */
  if (!condition) {
    return;
  }
} 
```

您可以像在任何其他函数中一样使用 return 关键字。

# php - 什么是单元测试，我为什么要关心？

> ID：346620
> 
> 赞同：18
> 
> 时间：2008-12-06T19:11:21.300
> 
> 标签：php, javascript, unit-testing

好的，我用 PHP 和 JavaScript 开发 Web 应用程序，在 Stack Overflow 上很多次我都看到了*单元测试*这个词，但是在网站上我没有找到一个令人满意的答案来说明单元测试到底是什么.

那么什么是单元测试，作为 PHP 和 JavaScript 程序员，我应该关心还是只针对“真正的”编程语言？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-06T19:21:52.310

单元测试适用于您希望维护的任何代码。

简而言之，这个想法是编写许多小测试，每个小测试都可以单独运行，并测试代码库中尽可能小的部分（通常是单个类或单个函数）。如果我给这个函数它期望的输入，它会返回我期望的输出吗？如果是这样，这意味着应用程序的其余部分几乎可以假设它可以工作。如果没有，我宁愿在一个小的、简单的、独立的单元测试函数中捕获错误，也不愿尝试在整个应用程序中跟踪它。

当然，它还要求您在编写代码时相当自律，这既是因为必须能够隔离单个函数或类来测试它们，而且因为测试不会自己编写。你必须这样做。;)

鉴于我见过的大多数 PHP 代码的质量，我会说单元测试在 PHP 社区中*肯定*占有一席之地。事实上，这比几乎任何其他语言都要多。;)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-06T19:55:24.723

单元测试是自动化测试，用于测试给定的代码片段在给定的一组环境下是否按照您期望的那样做。好的单元测试测试小块的功能，通常是在单个功能的级别。

单元测试的结构通常是这样的：你设置一些状态，运行你想要测试的函数或方法，然后断言该函数的输出，或者由于该函数而改变其他状态。大多数单元测试框架都有用于支持和构建它的实用程序，例如：

*   **测试用例**：将相似的测试组合在一起的方法，通常是测试相同的文件或代码段。
*   **设置/拆卸函数**：在每次测试之前调用的函数，设置和清理状态在多个测试中是相同的。
*   **断言函数**：允许您断言特定事物为真的函数，例如一个值等于另一个预期值、一个值是真/假等。当它们失败时，它们会向您显示预期值和实际值是什么.
*   **测试运行应用程序**：一个应用程序一个接一个地为您运行所有测试，向您显示每个测试是成功还是失败，如果失败，哪些特定断言失败，以及实际值与预期值相反。

单元测试很有用，原因有很多：

*   **它们确保您的代码**在您编写时可以正常工作，而无需手动测试。在编写函数时，您可以测试关于它如何工作的假设，立即发现错误。
*   **即使您或其他人更改了代码，**它们也能保持工作代码正常工作。**一旦编写了一个函数并进行了完全单元测试（即，它应该做的所有事情都有相关的单元测试来验证它们是否确实做到了），那么如果您或其他任何人破坏了任何该功能，您将立即知道何时您运行单元测试，并且可以轻松地纠正它。**
***   **他们帮助您调试**。在尝试诊断通过手动测试应用程序观察到的错误时，不必查看大量代码，单元测试允许您专注于较小的功能，从而减少您需要考虑的复杂性。*   **他们**以随着代码更改而保持更新的方式记录您的代码。设计文档和评论很容易忘记更新。另一方面，单元测试在未更新时会中断。如果写得很清楚，它们会显示代码在特定情况下的实际作用，并且可以向您证明这一点。**

 **单元测试对任何大于几行的代码都很有用，不管是什么语言。我确实已经对 php 代码进行了单元测试，即使是对于相对较小的项目，并从中获得了立竿见影的回报。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T19:18:59.397

单元测试是对您编写的一小部分代码的测试。您将其与系统的其余部分隔离开来进行测试，以确保您的代码的那部分工作正常。

测试许多小部分代码，确保它们工作，然后测试它们一起工作，而不是测试整个系统更容易。

区分单元测试和自动化单元测试很重要。您应该始终对代码进行单元测试。但是，自动化单元测试是另一回事。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T21:19:27.907

除了已经回答的问题之外，让测试用例覆盖您的代码可以让您继续进行[重构](http://en.wikipedia.org/wiki/Code_refactoring)（改进您的代码设计而不修改其可观察的行为）。

[PHP 的单元测试框架](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#PHP)包括[PHPUnit](http://www.phpunit.de/)和[SimpleTest](http://www.simpletest.org/)，它们已[在 StackOverflow 上进行了比较](https://stackoverflow.com/questions/34312/simple-test-vs-phpunit)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-06T19:15:09.420

我见过的大多数 php 几乎不可能进行单元测试。

[如果您有兴趣，维基百科](http://en.wikipedia.org/wiki/Unit_tests)有一篇关于单元测试的文章。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-06T20:49:06.907

如果您编写任何描述的应用程序，您应该考虑单元测试。如果做得好，它们会迫使您考虑交付给用户的代码质量。我认为您在这里遇到的问题是单元测试代码和自动化单元测试之间的区别。单元测试可以像写下一组测试然后手动运行它们一样简单地完成。

另一方面，自动化单元测试依赖于您拥有某种形式的应用程序/工具来运行和重新运行测试。使用自动化单元测试，您只需按一个按钮即可重新运行测试。那么为什么重新运行测试如此重要呢？简单地说，您不会编写应用程序在它们上运行一次测试然后离开它们。编写您的测试，以便您在离散的小运行中练习您的代码，并在整个开发过程中运行它们。通过这样做，通过一组编写良好的测试，您更有可能识别出因升级而损坏的代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-04T09:17:05.927

关于**为什么**首先应该进行单元测试，我想补充一下 Barry Boehm 的论点：“在单元测试阶段发现并纠正的故障比交付给顾客。”

虽然乘数听起来有点粗糙，但我认为这个论点绝对证明了测试的合理性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-06T19:22:33.230

[谷歌搜索“php 单元测试”](http://www.google.com/search?q=php+unit+testing)会产生关于这个主题的大量信息。[PHPUnit](http://www.phpunit.de/)项目看起来很有趣。

# c++ - 对 C++ 中的类型双关有何看法？

> ID：346622
> 
> 赞同：23
> 
> 时间：2008-12-06T19:13:29.767
> 
> 标签：c++, casting, type-punning

我对 C++ 中类型双关语指针/数组的约定很好奇。这是我目前的用例：

> 通过将二进制数据块视为 32 位整数数组（我们知道它的总长度是 4 的倍数），然后对所有值求和并忽略溢出，计算一个简单的 32 位校验和。

我希望这样的函数看起来像这样：

```
uint32_t compute_checksum(const char *data, size_t size)
{
    const uint32_t *udata = /* ??? */;
    uint32_t checksum = 0;
    for (size_t i = 0; i != size / 4; ++i)
        checksum += udata[i];
    return udata;
 } 
```

现在我的问题是，您认为转换`data`为的“最佳”方式是`udata`什么？

C风格的演员？

```
udata = (const uint32_t *)data 
```

假设所有指针都是可转换的 C++ 强制转换？

```
udata = reinterpret_cast<const uint32_t *>(data) 
```

C++ 在任意指针类型之间使用中间转换`void*`？

```
udata = static_cast<const uint32_t *>(static_cast<const void *>(data)) 
```

通过工会铸造？

```
union {
    const uint32_t *udata;
    const char *cdata;
};
cdata = data;
// now use udata 
```

我完全意识到这不是一个 100% 可移植的解决方案，但我只希望在我知道它可以工作的一小部分平台上使用它（即未对齐的内存访问和编译器对指针别名的假设）。你会推荐什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-06T20:57:26.813

就 C++ 标准而言，[litb](https://stackoverflow.com/questions/346622/opinions-on-type-punning-in-c#346675)的答案是完全正确且最可移植的。转换`const char *data`为 a `const uint3_t *`，无论是通过 C 风格的转换`static_cast`，还是`reinterpret_cast`，都违反了严格的别名规则（请参阅[了解严格别名](http://cellperformance.beyond3d.com/articles/2006/06/understanding-strict-aliasing.html)）。如果您使用完全优化进行编译，那么代码很可能不会做正确的事情。

通过联合（例如 litb's `my_reint`）进行强制转换可能是最好的解决方案，尽管它在技术上确实违反了规则，即如果您通过一个成员写入联合并通过另一个成员读取它，则会导致未定义的行为。然而，几乎所有的编译器都支持这一点，它会产生预期的结果。如果您绝对希望 100% 符合标准，请使用位移方法。否则，我建议通过联合进行强制转换，这可能会给您带来更好的性能。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-07T13:41:05.477

忽略效率，为了代码的简单性，我会这样做：

```
#include <numeric>
#include <vector>
#include <cstring>

uint32_t compute_checksum(const char *data, size_t size) {
    std::vector<uint32_t> intdata(size/sizeof(uint32_t));
    std::memcpy(&intdata[0], data, size);
    return std::accumulate(intdata.begin(), intdata.end(), 0);
} 
```

我也喜欢 litb 的最后一个答案，即依次移动每个 char 的答案，除了因为 char 可能已签名，我认为它需要一个额外的掩码：

```
checksum += ((data[i] && 0xFF) << shift[i % 4]); 
```

当类型双关语是一个潜在问题时，我宁愿不键入双关语，也不愿尝试安全地这样做。如果您首先不创建任何不同类型的别名指针，那么您不必担心编译器可能会对别名做什么，也不必担心通过联合查看您的多个 static_casts 的维护程序员。

如果您不想分配这么多额外的内存，那么：

```
uint32_t compute_checksum(const char *data, size_t size) {
    uint32_t total = 0;
    for (size_t i = 0; i < size; i += sizeof(uint32_t)) {
        uint32_t thisone;
        std::memcpy(&thisone, &data[i], sizeof(uint32_t));
        total += thisone;
    }
    return total;
} 
```

足够的优化将完全摆脱 gcc 上的 memcpy 和额外的 uint32_t 变量，并且只需读取一个未对齐的整数值，无论是在您的平台上最有效的方法，直接从源数组中读取。我希望其他“严肃的”编译器也是如此。但是这个代码现在比 litb 的大，所以没有什么可说的，除了我的更容易变成一个函数模板，它可以和 uint64_t 一样工作，我的工作是原生字节序而不是选择很少-字节序。

这当然不是完全可移植的。它假设 sizeof(uint32_t) chars 的存储表示以我们想要的方式对应于 uin32_t 的存储表示。问题暗示了这一点，因为它表明可以将一个“视为”另一个。字节序，char 是否为 8 位，以及 uint32_t 是否使用其存储表示中的所有位显然可以侵入，但问题暗示它们不会。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-29T00:58:05.787

有我的五十美分 - 不同的方式来做到这一点。

```
#include <iostream>
#include <string>
#include <cstring>

    uint32_t compute_checksum_memcpy(const char *data, size_t size)
    {
        uint32_t checksum = 0;
        for (size_t i = 0; i != size / 4; ++i)
        {
            // memcpy may be slow, unneeded allocation
            uint32_t dest; 
            memcpy(&dest,data+i,4);
            checksum += dest;
        }
        return checksum;
    }

    uint32_t compute_checksum_address_recast(const char *data, size_t size)
    {
        uint32_t checksum = 0;
        for (size_t i = 0; i != size / 4; ++i)
        {
            //classic old type punning
            checksum +=  *(uint32_t*)(data+i);
        }
        return checksum;
    }

    uint32_t compute_checksum_union(const char *data, size_t size)
    {
        uint32_t checksum = 0;
        for (size_t i = 0; i != size / 4; ++i)
        {
            //Syntax hell
            checksum +=  *((union{const char* c;uint32_t* i;}){.c=data+i}).i;
        }
        return checksum;
    }

    // Wrong!
    uint32_t compute_checksum_deref(const char *data, size_t size)
    {
        uint32_t checksum = 0;
        for (size_t i = 0; i != size / 4; ++i)
        {
            checksum +=  *&data[i];
        }
        return checksum;
    }

    // Wrong!
    uint32_t compute_checksum_cast(const char *data, size_t size)
    {
        uint32_t checksum = 0;
        for (size_t i = 0; i != size / 4; ++i)
        {
            checksum +=  *(data+i);
        }
        return checksum;
    }

int main()
{
    const char* data = "ABCDEFGH";
    std::cout << compute_checksum_memcpy(data, 8) << " OK\n";
    std::cout << compute_checksum_address_recast(data, 8) << " OK\n";
    std::cout << compute_checksum_union(data, 8) << " OK\n";
    std::cout << compute_checksum_deref(data, 8) << " Fail\n";
    std::cout << compute_checksum_cast(data, 8) << " Fail\n";
} 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2011-10-12T12:48:48.407

我知道这个线程已经有一段时间不活动了，但我想我会为这种事情发布一个简单的通用转换例程：

```
// safely cast between types without breaking strict aliasing rules
template<typename ReturnType, typename OriginalType>
ReturnType Cast( OriginalType Variable )
{
    union
    {
        OriginalType    In;
        ReturnType      Out;
    };

    In = Variable;
    return Out;
}

// example usage
int i = 0x3f800000;
float f = Cast<float>( i ); 
```

希望它可以帮助某人！

# javascript - 如何使用脚本控件 (ASP.Net) 获取自动完成控件脚本端

> ID：346632
> 
> 赞同：0
> 
> 时间：2008-12-06T19:19:22.877
> 
> 标签：javascript, ajax, .net-3.5, c#-3.0, scriptcontrol

**问题** 如何使用脚本文件上的脚本控件捕获和分配 Ajax Toolkit 自动完成控件上的事件？

**解释**

我基本上创建了一个脚本控件来组合一个文本框和一个自动完成控件，这样我就可以拥有一个用于自动完成的通用控件。下一步是在搜索项目时添加诸如处理图像之类的东西。这似乎很容易。

```
protected override IEnumerable<ScriptDescriptor> GetScriptDescriptors()
{  
  ScriptControlDescriptor desc = new ScriptControlDescriptor   
     ("NDI.WebControls.Client.GenericAutoComplete", this.ClientID);
  desc.AddProperty("autoCompleteID", autoComplete.ClientID);

  return new ScriptDescriptor[] { desc };
} 
```

然后在javascript上正常：

```
initialize: function()
{
  this._autoComplete = $get(this._autoCompleteID);  
  //this._autoCompleteID does have a value

  this._autoCompleteClientPopulating = 
     Function.createDelegate(this, this.handleAutoCompleteClientPopulating);

  $addHandler(this._autoComplete, "clientPopulating", 
     this._autoCompleteClientPopulating);

  NDI.WebControls.Client.GenericAutoComplete.callBaseMethod(this, 'initialize');
}, 
```

现在这应该有效，但它没有。为什么？因为显然没有像普通控件那样呈现给页面的自动完成控件。因此，当它到达 $get 部分时，尽管 ID 属性具有文本属性，但它仍为 null。（IE控件不存在）

这是可能的还是我必须使用 OnXyz 属性服务器端来分配方法？如：

```
 autocomplete.OnClientPoplating = someScript; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-08T16:16:58.797

**回答**

Booyah 找到了。原来自动完成有一个内置的方式来访问它在javascript中的事件：

服务器端您必须设置 BehaviorID：

```
autoComplete.BehaviorID = "autoCompleteBehavior"; 
```

然后在 GetScriptDescriptors 方法中设置它：

```
protected override IEnumerable<ScriptDescriptor> GetScriptDescriptors()
{
  ScriptControlDescriptor desc = new 
   ScriptControlDescriptor("NDI.WebControls.Client.GenericAutoComplete", ClientID);
   desc.AddProperty("autoCompleteID", autoComplete.BehaviorID);

  return new ScriptDescriptor[] { desc };
} 
```

当然，您必须添加属性脚本端来捕获该值，并且一旦您这样做，您必须使用 Find 来获取它。然后你必须创建事件处理程序：

```
this._autoComplete = $find(this._autoCompleteID);
this._onAutoCompletePopulating = 
   Function.createDelegate(this, this.handleOnAutoCompletePopulating); 
```

最后使用自动完成控件（行为对象）中的内置事件设置器：

```
this._autoComplete.add_populating(this._onAutoCompletePopulating); 
```

繁荣，它已经设置好了。

# javascript - 如何在 ASP.Net MVC 中进行 JavaScript 重定向？

> ID：346644
> 
> 赞同：3
> 
> 时间：2008-12-06T19:26:41.333
> 
> 标签：javascript, asp.net-mvc

以下代码将生成指向我想要访问的页面的链接。

```
<%= Html.ActionLink(image.Title, image.Id.ToString(), "Image") %> 
```

以下代码将导致在页面上呈现正确的 url。

```
<%= Url.Action("Index", "Image", new { id = image.Id })%> 
```

但是当我尝试在 javascript 中使用它时它失败了。（有一些关于页面继承的奇怪错误）

```
<div onclick="window.location = '<%= Url.Action("Index", "Image", new { id = image.Id })%>'">
    ...
</div> 
```

上面的代码应该工作吗？生成上面尝试的javascript的正确方法是什么？

**更新**我得到的错误是

> Views\Home\Index.aspx.cs(9)：错误 ASPNET：确保此代码文件中定义的类与“继承”属性匹配，并且它扩展了正确的基类（例如 Page 或 UserControl）。

看起来它表明一个更大的问题。

**已修复**感谢您的帮助，代码包含一个带有`runat="server"`. 当我删除它时，它运行正常。这可能是因为没有表单，`runat="server"`但我预计会出现不同的错误。

**由于这个问题似乎没有意义，我应该删除它吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T19:37:18.143

这实际上应该有效。ASP.NET MVC 将替换所有 <%= ... %> 或类似标签，它无法识别它是 html 定义还是 javascript。您的视图的输出是什么？“奇怪的错误”是来自 Javascript 还是 ASP.NET？

**编辑**：关于您的更新：确保您的 Index.aspx 具有指向 Index.aspx.cs 的“Codebehind”属性（这是在第一行的 Page-tag 中）并且属性“Inherits”包含类名代码隐藏中的页面/用户控件类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T20:11:21.103

看一下[这个](http://codeguru302.blogspot.com/2008/11/aspnet-make-sure-that-class-defined-in.html)，以获得错误消息的可能解决方案。代码隐藏与代码文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T21:06:24.017

看起来你有一个带有 Image 方法的 HomeController 对吗？那么应该是

```
<%= Url.Action("Image", "Home", new { id = image.Id })%> 
```

# java - 关于使用 Terracotta 作为持久性解决方案

> ID：346647
> 
> 赞同：14
> 
> 时间：2008-12-06T19:30:30.420
> 
> 标签：java, transactions, persistence, terracotta, integrity

将 Terracotta 用作持久性解决方案（替换数据库）是个好主意吗？我特别想知道数据完整性问题和对事务系统的支持。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-07T07:07:36.347

Terracotta 是[事务性](http://terracotta.org/web/display/docs/Concept+and+Architecture+Guide#ConceptandArchitectureGuide-Transactions)的（同步块形成修改对象的事务），但不是也不希望符合 JTA。这里有相当长的关于交易的讨论和一些关于兵马俑的常见[误解](http://blog.terracottatech.com/2007/12/fud_of_the_week_terracotta_doe.html)。

我写了[一篇关于数据生命周期](http://tech.puredanger.com/2008/08/01/thinking-about-data-lifetimes/)的博客文章，以及它应该如何构建您对识别使用 Terracotta 机会的思考。简而言之，Terracotta 的最佳点是您需要持久性和可用性（您的应用程序可能会崩溃但您仍然需要数据）但数据不一定长期关键的用例。

一个典型的例子是在 Web 应用程序中的用户会话上下文中重要的数据，例如购物车信息。您希望保持该数据的持久性，以便在您的 Web 应用程序崩溃时，您可以维护购物车。但是购物车本身可能会或可能不会被购买。因此，您将其存储在 Terracotta 中直到它被购买，然后作为“记录系统”数据保存到数据库中。

从历史上看，您存储在数据库中的数据始终是对您的业务的长期成功至关重要的“记录系统”数据：客户、订单等。使用今天的“无状态”架构（实际上不是无状态的） ，我们将所有中期数据推送到数据库中。这意味着我们不必要地惩罚我们的数据库（额外的工作和存储）和我们的开发人员（他们必须处理对象关系阻抗不匹配，即使使用 ORM）。一个更好的方法是将它留在对象中，然后用 Terracotta 将其聚集在一起。许多最近的 Terracotta 用户已经使用这种技术显着减少了他们的数据库占用空间（为他们节省了数百万美元），同时提高了他们的扩展能力。

存在与数据库的集成点以及如何可靠地进行切换的问题。[我们在最近发布的Examinator](http://reference.terracotta.org)（一个 Spring / Terracotta / Tomcat / MySql 参考 Web 应用程序）中将其视为一个用例。当考试正在进行时，状态（问题的答案、随机选择顺序、标记为复习的问题）存储在 Terracotta 中。但是，当考试完成时，会计算得出的分数并长期存储在数据库中。

为了安全地做到这一点，我们使用 Hibernate 键策略，首先在 Terracotta 的对象中生成数据库行 id，然后将数据保存到 db，然后从 Terracotta 中删除。如果应用程序在保存到数据库之后但在从 Terracotta 中删除之前崩溃，则这种情况有潜在的竞争条件。在这种情况下，应用程序可以尝试将数据重新保存到数据库，可能会创建两行。但是由于预先生成的 ID，我们可以判断该行之前是否成功写入并避免该问题。

总之，我认为 Terracotta 不会很快取代您的数据库。它在操作上太新了，甚至在大多数商店中都不能被视为这样。使用模式完全不同。堆中没有查询或 SQL 功能（您的查询功能由您的对象模型定义）。我认为它可以并且正在开始取代中期数据使用，因为它是一种更便宜、更容易的选择。但是，有些人开始尝试将其用于长期存储。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-06T19:35:43.310

兵马俑仅是 Java。如果您可以被锁定在这项技术中，而不能只用其他语言编写一些脚本（没有 JVM），那么就继续使用它。

这篇文章[用 Terracotta 杀死你的数据库](http://willcode4beer.com/design.jsp?set=kill_your_db)非常好。

# php - 如何在 Php5 中重载构造函数？

> ID：346649
> 
> 赞同：0
> 
> 时间：2008-12-06T19:31:22.463
> 
> 标签：php, constructor

我有两个构造函数：

```
function clsUsagerEmailUserName($nickName, $email)
{
        $this->nickName = $nickName;
        $this->email = $email;               
}

function clsUsagerEmailUserName($email)
{
        $this->email = $email;               
} 
```

但这不起作用？怎么了，这个版本的PHP不应该是OO吗？（我刚从 PHP4 迁移过来）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T19:42:21.537

如果您有充分的理由希望按该顺序保留函数参数，请执行以下操作：

```
function __construct()
{
    switch ( func_num_args() ) {
        case 1:
            $this->email = func_get_arg(0);
        break;
        case 2:
            $this->nickName = func_get_arg(0);
            $this->email = func_get_arg(1);
        break;
        // [...]
        default:
            throw new Exception('Wrong number of values passed to constructor');
    }
} 
```

不过，我强烈推荐 Daok 对此的回答。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T19:32:26.703

PHP5 不允许重载构造函数。

或者，您可以使用函数进行设置，也可以使用此技巧（在 EE 中找到）：

```
function __construct ($var1, $var2 = null)
{
   if (isset($var2))
   {
      //Do one thing
   }
   else
   {
      //Do another
   }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T19:42:51.487

PHP 在较新的版本中支持面向对象的结构，但函数重载不是面向对象范式的一部分。

正如其他人已经说过的，PHP 不支持重载函数。在 PHP 中，您可以为函数参数定义“默认值”。您的函数可能如下所示，具有您预期的行为：

```
function clsUsagerEmailUserName($nickName, $email = NULL)
{    
    if ($email <> NULL)
    {
        $this->nickName = $nickName;
        $this->email = $eMail;
    }
    else
    {
        $this->email = $nickName;
    }
} 
```

**请注意**与上面示例中的变量名称的混淆！在 PHP 中更好地使用这个“特性”看起来像这样，但是您需要更新应用程序中的每个函数调用：

```
function clsUsagerEmailUserName($email, $nickName = NULL)
{
    $this->email = $email;
    if ($nickName <> NULL)
        $this->nickName = $nickName;
} 
```

为了清洁，我更喜欢第二个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-10T17:02:00.967

您可以使用 func_get_args 来计算传递参数的数量，然后将其与方法匹配。

```
abstract class AlmostPolymorphicObject {
  public function __construct() {
    $args = func_get_args();
    $argsCount = count($args);
    $callback = array($this, '_construct'.$argsCount);
    if (!is_callable($callback)) {
      throw new Exception('no valid constructor for param count '.$argsCount);
    }
    return call_user_func_array($callback, $args);
  }
}

class FooBar extends AlmostPolymorphicObject {
  private function _construct0() {
  }

  private function _construct1($var1) {
  }

  private function _construct2($var1, $var2) {
  }
}

$var = new FooBar(); // would run _construct0
$var = new FooBar('var'); // would run _construct1
$var = new FooBar('var','var'); // would run _construct2
$var = new FooBar('var','var', 'asdasd'); // would throw error 'no valid constructor for param count 3' 
```

# c++ - 是否有一种“好”的方法来处理来自多个来源的重新组装多播？

> ID：346650
> 
> 赞同：0
> 
> 时间：2008-12-06T19:31:31.090
> 
> 标签：c++, boost, boost-asio, multicast

我目前正在修改我们现有的专有套接字包装器代码以使用 boost asio，以便它可以为我们完成一些繁重的工作。也许我们现有代码中最复杂的部分是多播处理代码。该代码允许我们的中间层服务器（在一个系统中可以有多个）向客户端发送多播，客户端使用这些向系统用户提供更新。

代码复杂且容易出错的原因是它使用许多原始缓冲区来根据多播流的来源重新组装多播流。似乎即使使用 Boost.Asio 我也将不得不处理同样的问题，所以在我陷入困境之前，我认为值得问问其他人是如何处理这种情况的。

这似乎是一个非常常见的用例。没有我现在拥有的那种代码，有什么东西可以帮助我完成这项工作吗？或者是否有一个既定的 C++ 模板（Boost 或其他）可以做这种工作？

显然，我可以让事情变得更轻松，并使用 STL 容器来缓冲数据包而不是原始数组，但是这段代码需要非常高性能。在大型安装中，有大量的数据包飞来飞去，它需要尽可能接近实时地响应。

提前感谢您对此事的任何想法。

杰米

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T01:48:48.237

听起来您没有为详细的答案提供足够的信息，但是对于多播数据的实时处理，有一些通用的指针需要考虑。

*   如果您使用原始 UDP 多播，您可能正在用户空间中进行某种协议排序，以处理丢失或重复的数据包。无论您想做什么优化，都要*抵制*打破应用程序和协议层之间分层的诱惑。
*   `std::vector`，在大多数情况下，与原始动态分配的字符缓冲区相同。不要仅仅因为它是一个抽象层就回避使用它。但是，有两种情况你应该避免它：
    *   如果您可以摆脱静态分配的缓冲区
    *   如果您需要将缓冲区的所有权转移到下游（尽管如果您仔细设计，`swap()`可能就足够了）
*   预分配是你的朋友。如果您可以在数据进入时有一组可供使用的缓冲区，则可以从快速执行路径中删除大多数动态分配。
*   尽量减少内存副本。如果您可以在单个调用堆栈中处理数据，您就有机会避免复制。如果您必须将数据传递给不同的线程，您可能会被迫复制数据。
*   如果您的应用程序可以处理分块缓冲区（而不是将所有数据聚合到单个缓冲区中），请查看`writev`和`readv`.

我不相信任何罐头解决方案可以解决您的问题。Boost ASIO`libevent`等都将为您处理套接字抽象，但是一旦交付，您对数据的处理仍然是您的责任。

# sql - 最常见的 SQL 反模式有哪些？

> ID：346659
> 
> 赞同：243
> 
> 时间：2008-12-06T19:42:15.343
> 
> 标签：sql, anti-patterns

我们所有使用关系数据库的人都已经了解（或正在学习）SQL 是不同的。引出所需的结果并有效地完成这一过程涉及一个乏味的过程，其部分特征是学习不熟悉的范例，并发现我们最熟悉的一些编程模式在这里不起作用。您见过（或您自己承诺过）的常见反模式是什么？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2008-12-06T21:55:16.103

我一直对大多数程序员在数据访问层混合他们的 UI 逻辑的倾向感到失望：

```
SELECT
    FirstName + ' ' + LastName as "Full Name",
    case UserRole
        when 2 then "Admin"
        when 1 then "Moderator"
        else "User"
    end as "User's Role",
    case SignedIn
        when 0 then "Logged in"
        else "Logged out"
    end as "User signed in?",
    Convert(varchar(100), LastSignOn, 101) as "Last Sign On",
    DateDiff('d', LastSignOn, getDate()) as "Days since last sign on",
    AddrLine1 + ' ' + AddrLine2 + ' ' + AddrLine3 + ' ' +
        City + ', ' + State + ' ' + Zip as "Address",
    'XXX-XX-' + Substring(
        Convert(varchar(9), SSN), 6, 4) as "Social Security #"
FROM Users 
```

通常，程序员这样做是因为他们打算将他们的数据集直接绑定到网格，并且在服务器端使用 SQL Server 格式比在客户端格式化更方便。

上面显示的查询非常脆弱，因为它们将数据层与 UI 层紧密耦合。最重要的是，这种编程风格彻底阻止了存储过程的可重用。

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2008-12-06T19:54:03.570

这是我的前3名。

数字 1\. 未能指定字段列表。（编辑：为防止混淆：这是一条生产代码规则。它不适用于一次性分析脚本 - 除非我是作者。）

```
SELECT *
Insert Into blah SELECT * 
```

应该

```
SELECT fieldlist
Insert Into blah (fieldlist) SELECT fieldlist 
```

2号。使用游标和while循环，当一个带有循环变量的while循环就可以了。

```
DECLARE @LoopVar int

SET @LoopVar = (SELECT MIN(TheKey) FROM TheTable)
WHILE @LoopVar is not null
BEGIN
  -- Do Stuff with current value of @LoopVar
  ...
  --Ok, done, now get the next value
  SET @LoopVar = (SELECT MIN(TheKey) FROM TheTable
    WHERE @LoopVar < TheKey)
END 
```

数字 3\. DateLogic 通过字符串类型。

```
--Trim the time
Convert(Convert(theDate, varchar(10), 121), datetime) 
```

应该

```
--Trim the time
DateAdd(dd, DateDiff(dd, 0, theDate), 0) 
```

* * *

我最近看到了“一个查询比两个更好，对吗？”的飙升。

```
SELECT *
FROM blah
WHERE (blah.Name = @name OR @name is null)
  AND (blah.Purpose = @Purpose OR @Purpose is null) 
```

此查询需要两个或三个不同的执行计划，具体取决于参数的值。此 SQL 文本仅生成一个执行计划并将其保存在缓存中。无论参数值如何，都将使用该计划。这会导致间歇性较差的性能。编写两个查询（每个预期执行计划一个查询）要好得多。

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2008-12-06T20:11:47.590

*   **人类可读的密码字段**，egad。不言自明。

*   **对索引**列使用LIKE ，我几乎只想说 LIKE。

*   回收 SQL 生成的 PK 值。

*   令人惊讶的是还没有人提到**神桌**。没有什么比 100 列位标志、大字符串和整数更能说明“有机”的了。

*   然后**是“我想念 .ini 文件”**模式：在大文本字段中存储 CSV、管道分隔的字符串或其他解析所需的数据。

*   而对于 MS SQL 服务器来说，游标的使用*完全没有*。有更好的方法来完成任何给定的光标任务。

*因为太多所以编辑！*

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2008-12-06T19:45:49.280

不必深入挖掘：不使用准备好的语句。

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2008-12-06T19:59:54.120

使用无意义的表别名：

```
from employee t1,
department t2,
job t3,
... 
```

使阅读大型 SQL 语句比需要的困难得多

* * *

## 回答 #6

> 赞同：56
> 
> 时间：2008-12-06T23:49:50.427

```
var query = "select COUNT(*) from Users where UserName = '" 
            + tbUser.Text 
            + "' and Password = '" 
            + tbPassword.Text +"'"; 
```

1.  盲目相信用户输入
2.  不使用[参数化查询](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)
3.  [明文密码](http://www.codinghorror.com/blog/2007/09/youre-probably-storing-passwords-incorrectly.html)

* * *

## 回答 #7

> 赞同：47
> 
> 时间：2008-12-06T20:25:25.880

我的问题是由总经理最好的朋友狗美容师的 8 岁儿子整理的 450 列 Access 表，以及由于有人不知道如何正确规范化数据结构而存在的狡猾的查找表。

通常，此查找表如下所示：

```
ID INT,
名称 NVARCHAR(132),
IntValue1 整数，
IntValue2 整数，
CharValue1 NVARCHAR(255),
CharValue2 NVARCHAR(255),
日期 1 日期时间，
日期 2 日期时间

```

我已经数不清有多少客户拥有依赖于这种可憎之物的系统了。

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2008-12-06T22:34:37.663

我最不喜欢的是

1.  在创建表格、存储过程等时使用空格。我可以使用 CamelCase 或 under_scores 以及单数或复数以及大写或小写，但必须引用 [带空格] 的表格或列，特别是如果 [它的间距很奇怪]（是的，我遇到过这个）真的让我很生气。

2.  非规范化数据。表格不必完全标准化，但是当我遇到一张包含有关他们当前评估分数或主要信息的员工表格时，它告诉我我可能需要在某个时候制作一个单独的表格并且然后尝试使它们保持同步。我将首先规范化数据，然后如果我看到非规范化有帮助的地方，我会考虑它。

3.  过度使用视图或光标。视图是有目的的，但是当每个表都包含在视图中时，它就太多了。我不得不使用游标几次，但通常您可以为此使用其他机制。

4.  使用权。程序可以是反模式吗？我的工作中有 SQL Server，但由于它的可用性、“易用性”和对非技术用户的“友好性”，许多人使用 access。这里有太多内容要介绍，但是如果您曾经处于类似的环境中，您就会知道。

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2008-12-06T19:48:32.677

使用 SP 作为存储过程名称的前缀，因为它将首先在系统过程位置而不是自定义位置中搜索。

* * *

## 回答 #10

> 赞同：25
> 
> 时间：2008-12-06T20:08:09.847

过度使用临时表和游标。

* * *

## 回答 #11

> 赞同：25
> 
> 时间：2009-04-20T22:14:10.167

对于存储时间值，仅应使用 UTC 时区。不应使用当地时间。

* * *

## 回答 #12

> 赞同：23
> 
> 时间：2009-04-06T15:22:51.597

**使用 @@IDENTITY**而不是 SCOPE_IDENTITY()

[从这个答案](https://stackoverflow.com/questions/42648/best-way-to-get-identity-of-inserted-row/42655#42655)中引用：

*   [@@IDENTITY](http://msdn.microsoft.com/en-us/library/ms187342.aspx)返回为当前会话中的任何表在所有范围内生成的最后一个标识值。您需要在这里小心，因为它是跨范围的。您可以从触发器而不是当前语句中获取值。
*   [SCOPE_IDENTITY](http://msdn.microsoft.com/en-us/library/ms190315.aspx)返回为当前会话和当前范围中的任何表生成的最后一个标识值。一般你想用什么。
*   [IDENT_CURRENT](http://msdn.microsoft.com/en-us/library/ms175098.aspx)返回为任何会话和任何范围内的特定表生成的最后一个标识值。这使您可以指定要从哪个表中获取值，以防上述两个不是您所需要的（非常罕见）。如果您想获取尚未插入记录的表的当前 IDENTITY 值，则可以使用它。

* * *

## 回答 #13

> 赞同：23
> 
> 时间：2010-02-08T17:16:34.617

将“死”字段重新用于它不打算用于的事情（例如将用户数据存储在“传真”字段中） - 作为快速修复非常诱人！

* * *

## 回答 #14

> 赞同：21
> 
> 时间：2008-12-06T22:25:41.080

```
select some_column, ...
from some_table
group by some_column 
```

并假设结果将按 some_column 排序。我在 Sybase 中看到了这一点，假设成立（目前）。

* * *

## 回答 #15

> 赞同：21
> 
> 时间：2009-04-19T03:53:16.733

```
SELECT FirstName + ' ' + LastName as "Full Name", case UserRole when 2 then "Admin" when 1 then "Moderator" else "User" end as "User's Role", case SignedIn when 0 then "Logged in" else "Logged out" end as "User signed in?", Convert(varchar(100), LastSignOn, 101) as "Last Sign On", DateDiff('d', LastSignOn, getDate()) as "Days since last sign on", AddrLine1 + ' ' + AddrLine2 + ' ' + AddrLine3 + ' ' + City + ', ' + State + ' ' + Zip as "Address", 'XXX-XX-' + Substring(Convert(varchar(9), SSN), 6, 4) as "Social Security #" FROM Users 
```

或者，将所有内容塞进一行。

* * *

## 回答 #16

> 赞同：17
> 
> 时间：2008-12-06T23:03:39.710

*   JOINS的`FROM TableA, TableB WHERE`语法，而不是`FROM TableA INNER JOIN TableB ON`

*   假设查询将以某种方式返回，而无需放入 ORDER BY 子句，因为这是在查询工具中测试期间显示的方式。

* * *

## 回答 #17

> 赞同：15
> 
> 时间：2010-02-03T17:59:56.677

在他们职业生涯的前六个月学习 SQL，在接下来的 10 年中从未学习过其他任何东西。特别是没有学习或有效使用窗口/分析 SQL 功能。特别是 over() 和 partition by 的使用。

> 窗口函数与聚合函数一样，对定义的一组（一组）行执行聚合，但不是每个组返回一个值，窗口函数可以为每个组返回多个值。

请参阅[O'Reilly SQL Cookbook 附录 A](http://oreilly.com/catalog/9780596009762)以获得对窗口函数的一个很好的概述。

* * *

## 回答 #18

> 赞同：13
> 
> 时间：2008-12-07T02:57:51.407

我需要把我自己目前最喜欢的放在这里，只是为了使列表完整。我最喜欢的反模式**不是测试您的查询**。

这适用于：

1.  您的查询涉及多个表。
2.  您认为您有一个查询的最佳设计，但不必费心测试您的假设。
3.  您接受了第一个有效的查询，但不知道它是否接近优化。

并且针对非典型或不充分数据运行的任何测试都不算数。如果它是一个存储过程，请将测试语句放入注释中并与结果一起保存。否则，将其与结果一起放入代码中的注释中。

* * *

## 回答 #19

> 赞同：11
> 
> 时间：2009-04-20T22:05:53.150

临时表滥用。

特别是这种事情：

```
SELECT personid, firstname, lastname, age
INTO #tmpPeople
FROM People
WHERE lastname like 's%'

DELETE FROM #tmpPeople
WHERE firstname = 'John'

DELETE FROM #tmpPeople
WHERE firstname = 'Jon'

DELETE FROM #tmpPeople
WHERE age > 35

UPDATE People
SET firstname = 'Fred'
WHERE personid IN (SELECT personid from #tmpPeople) 
```

不要从查询中构建临时表，只删除不需要的行。

是的，我在生产数据库中看到过这种形式的代码页。

* * *

## 回答 #20

> 赞同：9
> 
> 时间：2008-12-12T17:55:35.857

逆向观点：过度痴迷于正常化。

大多数 SQL/RBDB 系统都提供了许多非常有用的特性（事务、复制），即使对于未规范化的数据也是如此。磁盘空间很便宜，有时它可以更简单（更简单的代码，更快的开发时间）操作/过滤/搜索获取的数据，而不是编写 1NF 模式，并处理其中的所有麻烦（复杂的连接，讨厌的子选择， ETC）。

我发现过度规范化的系统通常是过早的优化，尤其是在早期开发阶段。

（关于它的更多想法...... [http://writeonly.wordpress.com/2008/12/05/simple-object-db-using-json-and-python-sqlite/](http://writeonly.wordpress.com/2008/12/05/simple-object-db-using-json-and-python-sqlite/)）

* * *

## 回答 #21

> 赞同：9
> 
> 时间：2009-01-30T07:02:10.947

我只是根据 SO 上的一些 SQL 响应把这个放在一起。

认为触发器之于数据库就像事件处理程序之于 OOP 一样，这是一种严重的反模式。有这样一种看法，即任何旧逻辑都可以放入触发器中，以便在表上发生事务（事件）时触发。

不对。最大的区别之一是触发器是同步的 - 复仇，因为它们在集合操作上是同步的，而不是在行操作上。在 OOP 方面，恰恰相反——事件是实现异步事务的有效方式。

* * *

## 回答 #22

> 赞同：8
> 
> 时间：2011-10-12T12:02:41.257

没有任何注释的存储过程或函数...

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2008-12-06T20:05:19.133

1）我不知道这是一个“官方”反模式，但我不喜欢并尽量避免将字符串文字作为数据库列中的魔法值。

MediaWiki 的表格“图像”中的一个示例：

```
img_media_type ENUM("UNKNOWN", "BITMAP", "DRAWING", "AUDIO", "VIDEO", 
    "MULTIMEDIA", "OFFICE", "TEXT", "EXECUTABLE", "ARCHIVE") default NULL,
img_major_mime ENUM("unknown", "application", "audio", "image", "text", 
    "video", "message", "model", "multipart") NOT NULL default "unknown", 
```

（我只是注意到不同的外壳，另一件事要避免）

我设计了这样的案例，例如使用 int 主键对表 ImageMediaType 和 ImageMajorMime 进行 int 查找。

2) 依赖于特定 NLS 设置的日期/字符串转换

```
CONVERT(NVARCHAR, GETDATE()) 
```

没有格式标识符

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2008-12-06T20:15:13.683

查询中的相同子查询。

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2008-12-08T01:46:21.050

*   改变的视图 - 过于频繁地改变并且没有通知或理由的视图。更改要么在最不合适的时间被注意到，要么更糟的是错误的并且永远不会被注意到。也许您的应用程序会中断，因为有人为该列想了一个更好的名称。作为规则，视图应该扩展基表的有用性，同时保持与消费者的合同。修复问题但不要添加功能或更糟糕的更改行为，以便创建新视图。为缓解问题，请勿与其他项目共享视图，并在平台允许时使用[CTE 。](http://en.wikipedia.org/wiki/Common_table_expressions)如果您的商店有 DBA，您可能无法更改视图，但在这种情况下，您的所有视图都将过时或无用。

*   !Paramed - 查询可以有多个目的吗？可能但下一个阅读它的人直到深度冥想才会知道。即使您现在不需要它们，您也有可能需要它们，即使它“只是”用于调试。添加参数可以减少维护时间并保持干燥。如果你有 where 子句，你应该有参数。

*   没有案例的案例 -

    ```
    SELECT  
    CASE @problem  
      WHEN 'Need to replace column A with this medium to large collection of strings hanging out in my code.'  
        THEN 'Create a table for lookup and add to your from clause.'  
      WHEN 'Scrubbing values in the result set based on some business rules.'  
        THEN 'Fix the data in the database'  
      WHEN 'Formating dates or numbers.'   
        THEN 'Apply formating in the presentation layer.'  
      WHEN 'Createing a cross tab'  
        THEN 'Good, but in reporting you should probably be using cross tab, matrix or pivot templates'   
    ELSE 'You probably found another case for no CASE but now I have to edit my code instead of enriching the data...' END 
    ```

* * *

## 回答 #26

> 赞同：5
> 
> 时间：2008-12-07T04:48:27.923

我发现最多并且在性能方面可能会产生重大成本的两个是：

*   使用游标而不是基于集合的表达式。我想这在程序员程序化思考时经常发生。

*   当连接到派生表时，使用相关子查询可以完成这项工作。

* * *

## 回答 #27

> 赞同：5
> 
> 时间：2009-01-01T13:11:28.373

将东西放在临时表中，尤其是从 SQL Server 切换到 Oracle 的人有过度使用临时表的习惯。只需使用嵌套的选择语句。

* * *

## 回答 #28

> 赞同：5
> 
> 时间：2011-11-24T05:33:45.537

编写查询但不知道是什么让 SQL 应用程序（单个查询和多用户系统）变快或变慢的开发人员。这包括对以下方面的无知：

*   物理 I/O 最小化策略，因为大多数查询的瓶颈是 I/O 而不是 CPU
*   不同类型物理存储访问的性能影响（例如，大量顺序 I/O 将比大量小型随机 I/O 更快，尽管如果您的物理存储是 SSD 则更慢！）
*   如果 DBMS 产生糟糕的查询计划，如何手动调整查询
*   如何诊断较差的数据库性能，如何“调试”慢查询，以及如何读取查询计划（或 EXPLAIN，取决于您选择的 DBMS）
*   锁定策略以优化吞吐量并避免多用户应用程序中的死锁
*   批处理和其他技巧处理数据集的重要性
*   表和索引设计以最佳平衡空间和性能（例如覆盖索引，尽可能保持索引小，将数据类型减少到所需的最小大小等）

* * *

## 回答 #29

> 赞同：4
> 
> 时间：2010-09-15T13:01:16.897

使用主键作为记录地址的代理，使用外键作为嵌入在记录中的指针的代理。

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2008-12-06T22:29:16.783

使用 SQL 作为一个美化的 ISAM（索引顺序访问方法）包。特别是嵌套游标，而不是将 SQL 语句组合成单个（尽管更大）语句。这也算作“滥用优化器”，因为实际上优化器无能为力。这可以与未准备好的语句结合使用，以最大限度地降低效率：

```
DECLARE c1 CURSOR FOR SELECT Col1, Col2, Col3 FROM Table1

FOREACH c1 INTO a.col1, a.col2, a.col3
    DECLARE c2 CURSOR FOR
        SELECT Item1, Item2, Item3
            FROM Table2
            WHERE Table2.Item1 = a.col2
    FOREACH c2 INTO b.item1, b.item2, b.item3
        ...process data from records a and b...
    END FOREACH
END FOREACH 
```

正确的解决方案（几乎总是）是将两个 SELECT 语句合并为一个：

```
DECLARE c1 CURSOR FOR
    SELECT Col1, Col2, Col3, Item1, Item2, Item3
        FROM Table1, Table2
        WHERE Table2.Item1 = Table1.Col2
        -- ORDER BY Table1.Col1, Table2.Item1

FOREACH c1 INTO a.col1, a.col2, a.col3, b.item1, b.item2, b.item3
    ...process data from records a and b...
END FOREACH 
```

双循环版本的唯一优点是您可以轻松发现 Table1 中值之间的中断，因为内部循环结束。这可能是控制中断报告中的一个因素。

此外，在应用程序中进行排序通常是禁忌。

* * *

## 回答 #31

> 赞同：3
> 
> 时间：2011-05-05T23:42:50.503

我刚刚遇到这样的视图定义：

```
CREATE OR REPLACE FORCE VIEW PRICE (PART_NUMBER, PRICE_LIST, LIST_VERSION ...)
AS
  SELECT sp.MKT_PART_NUMBER,
    sp.PRICE_LIST,
    sp.LIST_VERSION,
    sp.MIN_PRICE,
    sp.UNIT_PRICE,
    sp.MAX_PRICE,
... 
```

视图中有大约 50 列。一些开发人员以不提供列别名来折磨他人而感到自豪，因此必须计算两个位置的列偏移量，以便能够弄清楚视图中的列对应于哪一列。

* * *

## 回答 #32

> 赞同：3
> 
> 时间：2011-08-10T07:35:47.357

我见过太多的人为了宝贵的生命`IN (...)`而坚持不懈，而完全忘记了`EXISTS`。一个很好的例子，请参阅 Symfony Propel ORM。

* * *

## 回答 #33

> 赞同：3
> 
> 时间：2011-11-17T16:02:50.783

应用程序连接不仅仅是一个 SQL 问题，而是寻找问题的描述并找到这个问题，我很惊讶它没有被列出。

正如我听说过的那样，应用程序连接是指从两个或多个表中的每一个中提取一组行，然后使用一对嵌套的 for 循环将它们连接到您的 (Java) 代码中。这使系统（您的应用程序和数据库）不得不识别整个交叉产品，检索它并将其发送到应用程序。假设应用程序可以像数据库一样快地过滤叉积（可疑），只是更快地减少结果集意味着更少的数据传输。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2009-01-14T17:17:16.433

将冗余表连接到这样的查询中：

```
select emp.empno, dept.deptno
from emp
join dept on dept.deptno = emp.deptno; 
```

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2009-05-12T20:13:47.083

有1张桌子

```
code_1
value_1
code_2
value_2
...
code_10
value_10 
```

而不是有 3 张桌子

代码、值和代码值

你永远不知道什么时候你可能需要超过 10 对情侣的代码，值。

如果您只需要一对，就不会浪费磁盘空间。

* * *

## 回答 #36

> 赞同：2
> 
> 时间：2010-08-30T10:27:21.263

回复：使用@@IDENTITY 而不是 SCOPE_IDENTITY()

你不应该使用；改用输出

参看。[https://connect.microsoft.com/SQLServer/feedback/details/328811/scope-identity-sometimes-returns-incorrect-value](https://connect.microsoft.com/SQLServer/feedback/details/328811/scope-identity-sometimes-returns-incorrect-value)

* * *

## 回答 #37

> 赞同：2
> 
> 时间：2011-04-04T18:39:28.473

我最喜欢的 SQL 反模式：

`JOIN`在非唯一列上并`SELECT DISTINCT`用于修剪结果。

创建一个连接多个表的视图，只是为了从一个表中选择几列。

```
 CREATE VIEW my_view AS 
     SELECT * FROM table1
     JOIN table2 ON (...)
     JOIN table3 ON (...);

 SELECT col1, col2 FROM my_view WHERE col3 = 123; 
```

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2009-01-01T13:05:54.813

也许不是一种反模式，但让我烦恼的是，当某些 DB 的 DBA（好吧，我在这里谈论 Oracle）使用 Oracle 样式和代码约定编写 SQL Server 代码时，当它运行得如此糟糕时会抱怨。Oracle 人用光标就够了！SQL 是基于设置的。

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2010-02-03T18:19:20.453

不使用 With 子句或正确的连接并依赖子查询。

**反模式：**

```
select 
 ...
from data
where RECORD.STATE IN (
          SELECT STATEID
            FROM STATE
           WHERE NAME IN
                    ('Published to test',
                     'Approved for public',
                     'Published to public',
                     'Archived'
                    )) 
```

**更好：**
我喜欢使用 with 子句使我的意图更具可读性。

```
with valid_states as (
          SELECT STATEID
            FROM STATE
           WHERE NAME IN
                    ('Published to test',
                     'Approved for public',
                     'Published to public',
                     'Archived'
                    )
select  ... from data, valid_states
where data.state = valid_states.state 
```

**最好的：**

```
select 
  ... 
from data join states using (state)
where 
states.state in  ('Published to test',
                     'Approved for public',
                     'Published to public',
                     'Archived'
                    ) 
```

# c# - Visual Studio 和加载项卸载

> ID：346674
> 
> 赞同：2
> 
> 时间：2008-12-06T19:50:27.790
> 
> 标签：c#, visual-studio, add-in, vsx, extensibility

当我从 Visual Studio 的加载项菜单中删除加载项时，它不会从内存中卸载。有谁知道我是否可以为我的加载项（在 C# 中）编写一些代码来强制卸载。这甚至可能吗，还是我必须重新启动VS？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T20:02:23.180

如果您的 DLL 是用托管代码编写的，则无法强制将其作为 Visual Studio 加载项卸载。CLR 不支持这种机制。

强制从进程中卸载 DLL 的唯一方法是拆除所有已加载 DLL 的 AppDomain。在 Visual Studio 加载项方案中，加载项将加载到默认 AppDomain。拆掉这个就需要拆掉整个过程:(

# linux - 编写 bash 脚本以更改文本并写入日志

> ID：346692
> 
> 赞同：2
> 
> 时间：2008-12-06T20:04:06.717
> 
> 标签：linux, bash

我编写了一个非常简单的 bash 脚本来帮助我从 dev 迁移到 staging。它的作用是删除暂存中的所有文件，将文件从开发复制到阶段。

但是，config.inc.php 文件需要将“dev”的第一个实例更改为“stage”，并且没有其他实例更改。

其次，每次我运行它（我从 dev 目录运行脚本）时，我希望它在 dev 目录中写回一个日志，它将我运行暂存 bash 脚本的日期/时间戳附加到这个日志中。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-06T20:15:14.403

这只会将“dev”的第一次出现更改为“stage”

```
sed -i '0,/dev/ s/dev/stage/' config.inc.php 
```

请注意，它将“devel”更改为“stageel”。这个版本的行为就像你想要的那样，只搜索“dev”，而不是“devel”（事实上，`s/\<dev\>/stage/`替换表达式应该可以工作，但它似乎没有按预期工作？如果有人有我会很高兴更多 sed-fu 可以解释。）

```
sed -i  "/\<dev\>/,/\<dev\>/ s/dev/stage/" config.inc.php 
```

对于日志记录：

```
date >> /path/to/dev/run.log 
```

* * *

*由乔纳森·莱弗勒添加*

*   假设其他问题已解决（见下文），如果该行包含例如“将开发代码从 /some/dev/location 移动到*/some/stage/location*`sed` ”，则第二个命令仍然可以更改。`devel``stagel`
**   此外，第二个`sed`命令将映射`dev`在包含的第一行`dev`和第二个这样的行之间找到的每个。如果有多个匹配行，这一点很重要，而原始“ `0,/dev/`”（或修改后的“ `0,/\<dev\>/`”）仅根据请求匹配第一行。*   原因`"s/\<dev\>/stage/"`不起作用不是`sed`问题，而是外壳问题。使用单引号，你就可以了。使用双引号，反斜杠小于序列看起来`sed`就像小于。*   **经验法则**：在包含正则表达式材料的 shell 脚本中的任何参数周围使用单引号。除非它被单引号饱和，否则将正则表达式中的每个单引号替换为序列引号、反斜杠、引号、引号“ `'\''`”。（第一个引号终止单引号字符串；反斜杠引号是单引号；最后一个引号重新开始单引号字符串。）*   请注意，“ `-i`”选项是对 ; 的 GNU 扩展`sed`。这是答案的合法部分，因为该问题被标记`sed`为使用 GNU 的 Linux；如果您需要迁移到 Solaris、AIX、HP-UX 等平台，请注意。*   最后，`sed`不支持标准的扩展正则表达式；`-r`您必须使用 ' ' 选项在 GNU sed 中显式启用它们。*

 *据我估计，假设需要覆盖，命令应该是：

```
sed -i -r '0,/\<dev\>/s/\<dev\>/stage/' config.inc.php 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T20:10:55.113

要更改文件中的单词：

```
cat config.inc.php | sed 's:dev::stage' > config.inc.php.new 
```

要附加到日志文件：

```
echo $timestamp >> mylogfile.log 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T20:07:18.410

第一部分（编辑文件）可以使用流编辑器实用程序完成`sed`：

```
sed -i -e s/dev/stage/ config.inc.php 
```

这会在没有备份的情况下就地 ( `-i`) 编辑文件，使用表达式`/dev/stage/`( `-e`) 将一个表达式替换为另一个表达式。

# common-lisp - OpenMCL Common Lisp 出现“No MAKE-LOAD-FORM”错误

> ID：346695
> 
> 赞同：7
> 
> 时间：2008-12-06T20:04:51.707
> 
> 标签：common-lisp, literals, ccl

我正在尝试使用 SLIME 和 OpenMCL（现在称为 CCL）在 OS X 上运行来自 Paul Graham 的*ANSI Common Lisp的光线追踪代码。*在该代码中，定义了一个常量，其值为结构，当我在任何使用该常量的函数上调用*slime-compile-and-load-file*或*slime-compile-defun时，我收到一条错误消息：*

> 没有为#S(POINT :X 0 :Y 0 :Z 200) [SIMPLE-ERROR 类型的条件] 定义 MAKE-LOAD-FORM 方法

我发现[了一篇](http://osdir.com/ml/lisp.openmcl.devel/2006-10/msg00001.html)解释复杂性的帖子和[另一篇](http://svn.clozure.com/publicsvn/openmcl/tags/snapshot_040106/ccl/lib/nfcomp.lisp)感叹它的帖子，但是需要在代码中添加什么来协商 OpenMCL 的这一方面？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-07T10:26:06.087

当 STRUCTURE-OBJECT（和一些其他类型的对象）在 COMPILE-FILE 处理的代码中显示为文字常量对象时，COMPILE-FILE 需要知道如何安排，当加载生成的二进制文件时，“等效”对象被创建。“等效”有许多可能的定义：有时，加载对象的组件与其他对象共享结构很重要，有时初始化以某种方式发生很重要，有时这些都不重要。为了确定如何重新创建常量对象，COMPILE-FILE 调用通用函数 MAKE-LOAD-FORM；此行为应在任何 CL 参考或教程中进行描述。（参考或教程还应注意实现可以'

```
(defmethod make-load-form ((p point) &optional env)
  (declare (ignore env))
  (make-load-form-saving-slots p)) 
```

请注意，该方法必须在编译时定义，以便 COMPILE-FILE 可以调用它来确定如何保存常量 POINT 对象。

这些都不是特定于 CCL 的。可能的问题是哪些事物是常量、字面对象，哪些事物不是。

在如下代码中：

```
(defconstant a-point (make-point :x 0 :y 0 :z 200))

(defun return-a-point () a-point) 
```

编译器允许（但不是必需）在函数 RETURN-A-POINT 中用 A-POINT 的值代替对它的引用。（如果编译器这样做，这意味着正在编译的代码中有一个文字/常量 POINT 对象，并且 COMPILE-FILE 需要调用 MAKE-LOAD-FORM 来确定应该如何保存和加载对象；如果编译器不做这个替换，那么在这个例子中不需要调用 MAKE-LOAD-FORM。）

实现是否进行这种替换取决于实现。该规范还没有指定 DEFCONSTANT 形式中的值形式是否在编译时、加载时或两者都计算，并指出必须小心（由用户）确保表达式始终计算为相同的值。

CCL 通常尝试在编译时评估 DEFCONSTANT 值形式，并且相当积极地用命名常量的值替换对它们的引用；在某些情况下，这意味着必须在常量值的类上定义 MAKE-LOAD-FORM 方法。其他实现可能不太愿意对某些类型的对象进行这种替换。这两种策略都是正确的，并且可移植代码不能假设正在遵循哪些策略（尽管许多据称可移植的代码确实会做出这样的假设。）

对 DEFCONSTANT 定义的事物的不同处理似乎是这类事物最可能的原因（对 MAKE-LOAD-FORM 的意外调用，没有人费心去定义）。可以通过以下方式以一种可移植的方式避免其中一些问题：

```
(defconstant a-point (make-point :x 0 :y 0 :z 200))

(defun return-a-point () (load-time-value (symbol-value 'a-point))) 
```

这将与简单地允许想要这样做的实现（如 CCL 所做的那样）进行常量替换具有类似的效果，但是使用 LOAD-TIME-VALUE 将确保仅在加载时评估常量值（并且不涉及 MAKE-LOAD-FORM 。）

# c++ - “使用”声明可以与模板一起使用吗？

> ID：346697
> 
> 赞同：8
> 
> 时间：2008-12-06T20:06:05.950
> 
> 标签：c++, templates, gcc, using

是否可以将“使用”声明与模板基类一起使用？我读过它不在[这里，](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/topic/com.ibm.xlcpp8l.doc/language/ref/using_declaration_class_members.htm#using_declaration_class_members)但这是由于技术原因还是违反 C++ 标准，它是否适用于 gcc 或其他编译器？如果不可能，为什么不呢？

示例代码（来自上面的链接）：

```
struct A {
    template<class T> void f(T);
};

struct B : A {
    using A::f<int>;
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T20:15:37.757

您链接到的是 using 指令。using 声明可以很好地与模板基类一起使用（没有在标准中查找它，只是用编译器对其进行了测试）：

```
template<typename T> struct c1 { 
    void foo() { std::cout << "empty" << std::endl; } 
}; 

template<typename T> struct c2 : c1<T> { 
    using c1<T>::foo; 
    void foo(int) { std::cout << "int" << std::endl; } 
}; 

int main() { 
    c2<void> c;
    c.foo();
    c.foo(10); 
} 
```

编译器正确地找到了无参数`foo`函数，因为我们的 using-declaration 将其重新声明到了 的范围内`c2`，并输出了预期的结果。

**编辑**：更新了问题。这是更新的答案：

这篇文章是正确的，您不能使用模板 ID（模板名称和参数）。但是你可以放一个模板名称：

```
struct c1 { 
    template<int> void foo() { std::cout << "empty" << std::endl; } 
}; 

struct c2 : c1 { 
    using c1::foo; // using c1::foo<10> is not valid
    void foo(int) { std::cout << "int" << std::endl; } 
}; 

int main() { 
    c2 c;
    c.foo<10>();
    c.foo(10); 
} 
```

# asp.net - 使用 urlrewriter 时出现图像和样式表的问题

> ID：346702
> 
> 赞同：1
> 
> 时间：2008-12-06T20:08:54.617
> 
> 标签：asp.net, friendly-url, url-rewriting

我在这里的几个问题中建议使用 urlrewriter.net。我在显示图像和样式表时遇到了困难。

我阅读了 ScottGu 的博客（再次按照此处的推荐），最后他确实提到了这个问题并声明使用 ~/ 用于服务器控件等（文章末尾的“正确处理 CSS 和图像引用”）。

我尝试了他的解决方案，但似乎不起作用。

唯一对我有用的是写完整的路径。出于某种原因，在我看来，这不是正确的解决方案。这会给开发和调试带来严重的问题。

有谁知道问题的原因是什么？我需要在 web.config 文件中更改什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T17:37:10.407

您是否尝试过 Page.ResolveUrl？

```
<link href="<%=Page.ResolveUrl("~/mycss.css")%>" type="text/css" rel="stylesheet" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-16T16:18:30.320

以我的经验**，基本标签是比它解决的问题多得多的根源**

**我强烈建议第一个选项，通过即在行动之前检查 .aspx**扩展名来限制允许 URLrewriter 影响的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T09:27:43.560

~/ 仅适用于具有 runat="server" 属性的标签，因为这告诉 asp.net 呈现控件。

例如

<link href="~/mycss.css" type="text/css" rel="stylesheet" />

不会按照您的预期呈现，因为 asp.net 没有呈现控件。相反，您应该使用。

<link runat="server" href="~/mycss.css" type="text/css" rel="stylesheet" />

或者将 css 链接放在 head 标签中，例如

<head runat="server">
  <link href="~/mycss.css" type="text/css" rel="stylesheet" />
</head>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T20:13:34.093

我认为您需要从重写引擎中排除样式表和图像目录。我不熟悉您使用的引擎，但是如果您使用的重写规则基于非常广泛的规则进行重写，它将错误地指向您的样式表和图像，以及我相信的 javascript。

您还可以尝试使用基本标签。

```
<base href="http://www.w3schools.com/images/" /> 
```

尝试将其放在您的`<head>`, 指向您的图像文件夹。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-04T08:43:37.170

你可以使用这个：

```
<a href="<% =GetBaseURL() %>/">Home</a>

public static string GetBaseURL()
{

string url =HttpContext.Current.Request.Url.Scheme + “://” + HttpContext.Current.Request.Url.Authority + HttpContext.Current.Request.ApplicationPath.TrimEnd(’/') + ‘/’;

//EPiServer’s url start with a / so remove the url if (when) it contains one
if(url.EndsWith(”/”))
return url.Remove(url.LastIndexOf(”/”));
else
return url;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-16T16:14:12.810

我第二次使用基本href。尽管您确实必须对站点从域的根目录运行时的差异（即生产与 Visual Studio 服务器相比）做一些改动。

`<base id="BasePath" runat="Server"/`>

然后在master代码后面。

protected void SetBaseHref() {
if (Request.RawUrl != Request.Url.PathAndQuery)
{
string baseUrl = "";

```
 if (Request.IsSecureConnection)
            baseUrl += "https://";
        else
            baseUrl += "http://";
        baseUrl += Request.Url.Host;

        if (Request.Url.Port != 80)
            baseUrl += ":" + Request.Url.Port.ToString();

        baseUrl += Request.RawUrl;

        BasePath.Attributes.Add("HREF", baseUrl);
    } 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-04T09:08:19.570

URL 重写的一个大问题是当你使用相对路径时它会搞砸你。

例如，如果您在应用程序的根目录中有一个名为 page.aspx 的文件，该文件用于多个导航级别的页面。例如

```
Virtual Path    =>    Physical Path
 /              =>    /page.aspx?id=1
 /food/banana   =>    /page.aspx?id=2 
```

假设您在 page.aspx 中有一个到您的 css 文件的相对路径，该文件位于 /css/main.css

```
<link rel="stylesheet" href="css/main.css"/> 
```

当 page.aspx 从 /food/banana 的上下文中执行时，浏览器将尝试查找 /food/css/main.css，它不存在。

我采取的方法是禁用图像、CSS、JS 的 URL 重写，并具有指向您的样式表（以及 img src 和 JavaScript）的绝对链接。这样你就可以保证浏览器总能找到它。然后从您的样式表中，您可以使用背景图像的相对路径。

我发现这种方法维护起来最简单，因为您不需要花费数周时间尝试反向重写您的链接。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-24T10:10:59.170

我也遇到了样式表和图像的问题。

我不想使用 Base Href 解决方案并解决了我的问题，即更新我的相对路径以以单斜杠开头。

## 我的设置

> nopCommerceStore 用于建立网上商店。
> 
> nopCommerce 使用“UrlRewritingNet.UrlRewrite”库来处理 url 重写。
> 
> nopCommerce 使用 ASP.NET 主题和皮肤来定义网上商店的外观。

在服务器端，您具有以下文件夹结构：

> 根
> 
> 根/App_Themes/darkOrange/base.css
> 
> 根/App_Themes/darkOrange/cart-checkout-order.css
> 
> 根/App_Themes/darkOrange/category.css
> 
> root/App_Themes/darkOrange/css/ie6.css（这个文件最终被删除了）
> 
> 根/App_Themes/darkOrange/img/transparent_image_example.png
> 
> 根/css/ie6.css
> 
> 根/MasterPages/Root.Master
> 
> 根/Default.aspx 根/Category.aspx

当登陆默认页面（浏览器请求 http;//yourstore/default.aspx）时，您的 html 源代码将包含以下 html 代码：

```
<link href="App_Themes/darkOrange/base.css" type="text/css" rel="stylesheet" />
<link href="App_Themes/darkOrange/cart-checkout-order.css" type="text/css" rel="stylesheet" />
<link href="App_Themes/darkOrange/category.css" type="text/css" rel="stylesheet" />
... 
```

浏览器将触发以下请求：

> http;//yourstore/App_Themes/darkOrange/base.css
> 
> http;//yourstore/App_Themes/darkOrange/cart-checkout-order.css
> 
> http;//yourstore/App_Themes/darkOrange/category.css
> 
> ...

当单击“书籍”类别时，浏览器会请求 http;//yourstore/Category/29-books.aspx) 您的 html 源代码将包含以下 html 代码：

```
<link href="../App_Themes/darkOrange/base.css" type="text/css" rel="stylesheet" />
<link href="../App_Themes/darkOrange/cart-checkout-order.css" type="text/css" rel="stylesheet" />
<link href="../App_Themes/darkOrange/category.css" type="text/css" rel="stylesheet" /> 
```

浏览器将触发以下请求：

> http;//yourstore/Category/../App_Themes/darkOrange/base.css
> 
> http;//yourstore/Category/../App_Themes/darkOrange/cart-checkout-order.css
> 
> http;//yourstore/Category/../App_Themes/darkOrange/category.css

## IE6中的透明PNG

到目前为止，一切运行良好。为了使所有浏览器的外观一致，需要加载 IE6 特定的样式表。我学到了两个重要的东西：

> 1.  不要将样式表添加到“App_Themes”文件夹中，而是将其放在单独的文件夹中。
>     
>     
> 2.  如果引用图像，请使用以单斜杠开头的相对路径。

## 样式表和“App_Themes”文件夹：

要将特定布局应用于在 IE6 中查看的页面，我创建了一个新样式表并将其放在“root/App_Themes/darkOrange/css”文件夹中。在“root/MasterPages/Root.Master”文件中，我添加了以下几行 html 代码：

```
<!--[if IE 6]>
<link rel="stylesheet" type="text/css" media="screen" href="/css/ie6.css" />
<![endif]--> 
```

当 Css 文件放置在“App_Themes”文件夹或“App_Themes”内的子文件夹中时，它将自动被引用。这会在非 IE6 浏览器中导致不良行为。IE6 布局被应用到页面并弄乱了页面的外观。

当登陆默认页面（浏览器请求 http;//yourstore/default.aspx）时，服务器将解析请求。生成的 html 源代码将包含以下 html 代码：

```
<!--[if IE 6]>
<link rel="stylesheet" type="text/css" media="screen" href="/css/ie6.css" />
<![endif]--> 
```

但 html 也包含以下行：

```
<link href="App_Themes/darkOrange/css/ie6.css" type="text/css" rel="stylesheet" /> 
```

所有浏览器都会触发以下请求：

> http;//yourstore/App_Themes/darkOrange/css/ie6.css

IE6 将触发一个额外的请求（文件将从 IE 缓存中检索）：

> http;//yourstore/App_Themes/darkOrange/css/ie6.css

这是不受欢迎的行为，因此我不得不将“ie6.css”文件替换为新文件夹。它现在放置在“root/css/ie6.css”中。

## 引用图像、Url 重写和相对路径：

为了在 IE6 中支持透明 png 图像，ie6.css 文件包含一些 css 'filter' 属性。

例如，其中一个 div 选择器将包括以下 css 代码行：

```
filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', sizingMethod='crop', src='../App_Themes/darkOrange/img/transparent_image_example.png'); 
```

当登陆默认页面时（浏览器请求 http;//yourstore/default.aspx）IE6 会请求：

> http;//yourstore/img/transparent_image_example.png

当点击“书籍”类别时，浏览器请求 http;//yourstore/Category/29-books.aspx) IE6 会请求：

> http;//yourstore/img/transparent_image_example.png

两者都导致“找不到页面”（HTTP/1.1 404 Not Found）。

更换后：

> '../App_Themes/darkOrange/img/transparent_image_example.png'

和：

> '/App_Themes/darkOrange/img/transparent_image_example.png'

一切正常。

这是因为相对路径以单斜杠开头。浏览器将通过以下方式解释 url：

> 它是否以'http;//'开头？如果是，则必须是绝对路径；如果不是，它必须是相对路径。

相对路径：

> 它是否以单斜杠开头？如果是，它必须是“绝对路径引用”；如果不是，它必须是“相对路径引用”

[注意：请参阅文档“统一资源标识符 (URI)：通用语法”( http://www.ietf.org/rfc/rfc2396.txt](http://www.ietf.org/rfc/rfc2396.txt) )中的第 5 节“相对 URI 引用” 。

在 url 重写页面的情况下：

> 使用“相对路径引用”（例如“http;//yourstore/Category/29-books.aspx”和“../App_Themes/darkOrange/img/transparent_image_example.png”）时，浏览器将失败。
> 
> 使用“绝对路径引用”（例如“http;//yourstore/Category/29-books.aspx”和“/App_Themes/darkOrange/img/transparent_image_example.png”）时，浏览器会成功。

# php - 生产代码中的 PHP debug_backtrace 以获取有关调用方法的信息？

> ID：346703
> 
> 赞同：32
> 
> 时间：2008-12-06T20:10:22.023
> 
> 标签：php

是否有令人信服的理由不将[`debug_backtrace`](http://us2.php.net/debug_backtrace)其用于确定调用方法的类、名称和参数列表的唯一目的？不用于调试目的。它的函数名称中有“调试”一词，这让我觉得以这种方式使用它有点脏，但它符合我需要做的事情（可以从许多地方调用的单个函数，并且需要从另一个系统调用调用方法）。它有效，但这仍然是一个坏主意吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-07T00:04:40.273

它确实感觉有点脏，但正如在其他地方有充分的记录、意见和殴打致死的那样，PHP 并不是一个为优雅而设计的系统。

**不**将 debug_backtrace 用于应用程序逻辑的一个非常令人费解的原因是，一些未来从事 PHP 工作的开发人员可能会决定“它只是一个调试功能，性能无关紧要”。

如果您对执行此操作的“更好”方式感兴趣，您可以使用[PHP 的魔法常量](http://us.php.net/language.constants.predefined)来传递调用方法和类名，然后使用[ReflectionMethod](http://us.php.net/Reflection)对象来提取您需要的任何其他信息。

我把更好的引号，因为，虽然这会更干净，更正确，实例化反射对象的开销*可能*比使用 debug_backtrace 函数更大。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-06T20:15:28.847

> 是否有令人信服的理由不将 debug_backtrace 用于确定调用方法的类、名称和参数列表的唯一目的？

是的。关键是，如果您的代码需要如此紧密的耦合，以至于被调用者必须拥有有关其调用者的这些信息，这通常是糟糕设计的标志。因此，如果您觉得有必要使用这些信息，您可能应该重新考虑您的设计。

坦率地说，被调用者不应该需要这些信息来执行其任务。当然，例外情况围绕调试、日志记录和更普遍的其他类型的代码自省（但即使在那里，也要当心）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-06T20:20:26.387

debug_backtrace 是 PHP 错误处理函数之一。该手册鼓励用户定义自己的错误处理规则，以及修改记录错误的方式。这使您可以更改和增强错误报告以满足您的需要。这也意味着使用这些函数对性能的影响可以忽略不计。

我认为你所做的一切都很好。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-07T00:39:21.670

你在评论中说

> 被调用者的任务是调用在不同计算机上调用它的相同方法。这是为了避免为每个可能的源使用不同的 API 函数，从而大大减少了系统中的代码量。还是坏吗

因此，您想要执行以下操作：

*   函数**foo()**调用
*   函数**reflect()**，它执行调试回溯和请求
*   [http://example.com/REST/](http://example.com/REST/) **foo**

当然，假设您使用 HTTP 请求来触发远程调用。

这是一个有点奇怪的设置。如果您是从头开始创建系统，那么我建议您尝试解决它。如果您将其硬塞到遗留系统中，那么我想我理解。

我建议你在可能的情况下总是更加明确。您使用魔术堆栈内省可能会为您节省一点编码，但对于另一个开发人员来说，您的代码将完全令人困惑。如果建议您将类和函数名称传递给之前进行反射的函数。那么对于正在发生的事情就没有歧义了。

*   函数**foo()**调用
*   函数**反射(__CLASS__, __FUNCTION__)**，它请求
*   [http://example.com/REST/](http://example.com/REST/) **foo**

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-12-03T20:26:20.593

正确答案是完全**没**问题。Alan 指出了 PHP 的非优雅，所以我不会重复他的观点。在运行时代码中（不要害怕）使用 debug_backtrace 的原因是 PHP 主要是一种上下文无关语言。如果不使用带有强制转换的魔术函数名称（例如在类中——例如 __toString()），每个函数都不知道，也无法知道调用者的“意图”。让我们考虑一下您有一个类的情况，其中（在一个方法中）您希望提供对调用（外部）类的属性的访问。通过函数 API 传递 ($this) 确实很混乱并且容易出错。（特别是当你想要 array_map 或 call_user_func_array 时。）

例如

```
<?
class a {
 public $v = 'xyz';
 function __construct($x,$y)
 {
   $b = new b();
 }
}
class b {
 function __construct()
 {
   $start = microtime();
   $x = debug_backtrace();
   $end = microtime();
   echo ($end-$start) . "\n";
   print_r($x);
   $obj = $x[1]['object'];
   print_r($obj);
 }
}
$a = new a(1,2);
?> 
```

debug_backtrace 将使您能够访问 b 的 __construct 中的类 a 的上下文。现在，您可以从当前类传递一些状态变量，而无需传递 $this 或尝试从类名中预测它或通过将其放入全局变量中来混合它。

对于那些对时间感兴趣的人，微时间是 2.7E-5 。够快。只是不要把它放在一段时间（1）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-24T13:09:58.747

我对`debug_backtrace`方法进行了另一次性能测试。为了模拟真实的堆栈，我定义了几个随机调用另一个类方法的类 - 具有指定的深度：

```
<?php

const DEPTH = 30;
const BACKTRACE = false;

class TestClass
{
    public $a;
    public $b;

    public function __construct()
    {
        $foo = new Foo();
        $bar = new Bar();
        $alice = new Alice();

        $alice->a = $foo;
        $bar->a = $foo;

        $foo->a = $bar;
        $alice->b = $bar;

        $foo->b = $alice;
        $bar->b = $alice;

        $this->a = $foo;
        $this->b = $bar;
    }

    public function method($depth)
    {
        BACKTRACE ? debug_backtrace() : null;
        $obj = mt_rand(0,1) === 1 ? $this->a : $this->b;

        if ($depth > DEPTH) {
            return;
        }
        $obj->method($depth+1);

    }
}

class Foo
{
    public $a;
    public $b;

    public function method($depth)
    {
        BACKTRACE ? debug_backtrace() : null;

        $obj = mt_rand(0,1) === 1 ? $this->a : $this->b;

        if ($depth > DEPTH) {
            return;
        }
        $obj->method($depth+1);
    }
}

class Bar
{
    public $a;
    public $b;
    public function method($depth)
    {
        BACKTRACE ? debug_backtrace() : null;
        $obj = mt_rand(0,1) === 1 ? $this->a : $this->b;

        if ($depth > DEPTH) {
            return;
        }
        $obj->method($depth+1);
    }
}

class Alice
{
    public $a;
    public $b;

    public function method($depth)
    {
        BACKTRACE ? debug_backtrace() : null;

        $obj = mt_rand(0,1) === 1 ? $this->a : $this->b;

        if ($depth > DEPTH) {
            return;
        }

        $obj->method($depth+1);
    }
}

$test = new TestClass();

$startWhole = microtime(true);
for($i = 0; $i < 10000;$i++) {
    $start = microtime(true);
    $test->method(0);
    $end = microtime(true);
}
$endWhole = microtime(true);
$total = $endWhole - $startWhole;

echo 'total time: ' . $total . "s\n"; 
```

结果：

```
Performance (10.000 iterations / stack depth 30 / PHP 7.2):

with debug_backtrace - total time: 0.86011600494385s
without:             - total time: 0.043321847915649s 
```

using`debug_backtrace`使此代码慢 20 倍。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-06-02T22:45:35.697

我正在考虑使用 debug_backtrace 来调试 mysql 语句。当您在数据库日志中的每个查询开始时都有这样的标题时，查明错误或缓慢的查询要容易得多：

```
/*Called from /var/www/micimacko.php at line 28*/ SELECT count(*) FROM rofibeka; 
```

问题仍然存在。性能/可靠性怎么样。

# algorithm - 欧拉计划 #219

> ID：346708
> 
> 赞同：4
> 
> 时间：2008-12-06T20:13:00.537
> 
> 标签：algorithm, math, bitstring

我正在尝试进行 Euler number [219](http://projecteuler.net/index.php?section=problems&id=219)项目，但未能掌握它。我正在尝试使用 Python，根据 Euler 项目，它应该能够在一分钟内完成！这让我认为他们不可能希望我计算每个单独的位串，因为这在 Python 中太慢了——必须有一个 sub O(n) 算法。

我查看了一个递归解决方案，它存储位串可能的前缀，以便它可以快速选择一个新的位串，甚至将它们分组考虑。这仅适用于 10 多一点的暴力破解值：

```
cost(1) = 1
cost(2) = 5
cost(3) = 11
cost(4) = 18
cost(5) = 26
cost(6) = 35
cost(7) = 44
cost(8) = 54
cost(9) = 64
cost(10)= 74
cost(11)= 85
cost(12)= 96 
```

过去，我正在努力理解如何减少问题。总是可以制作出如下模式：

```
1
01
001
0001
00001
00000 
```

但对于超过 7 个位串来说，它并不是最优的。谁能指导我应该考虑什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-06T20:16:36.287

蛮力不是正确的方法。这是其中一个问题，如果你知道某件事，这并不难，但如果你从未听说过那件事，那几乎是不可能的。那东西就是[哈夫曼树](http://en.wikipedia.org/wiki/Huffman_tree)。

[编辑]经过进一步审查，您似乎无法在具有特定频率的 N 个节点上完全构建 Huffman 树，因为字符串的成本函数是 4*(# of 1) + (# of 0)。如果成本函数是字符串的长度（或其倍数），那么您可以创建一个霍夫曼树。

任何无前缀代码集都可以表示为类似 Huffman 的二叉树，其中每个节点有 0 或 2 个子节点，叶节点表示代码。给定一棵有 N 个节点的树，我们可以构造一棵有 N+1 个节点的树，如下所示：

1.  选择成本最小的叶节点，其中叶节点的成本为 4*（从根到叶的路径上 1 的数量）+（路径上 0 的数量）
    *   将 2 个子节点添加到该节点

因此，如果节点的代码以前是 xxxx，那么我们从代码集中删除该代码（因为它不再是叶子），并添加两个代码 xxxx0 和 xxxx1。代码集的总成本现在增加了

`成本(xxxx0) + 成本(xxxx1) - 成本(xxxx) = 成本(0) + 成本(1) + 成本(xxxx) = 5 + 成本(xxxx)

因此，mincost(N+1) <= mincost(N) + 5 + cost（N 的最佳解决方案中最便宜的代码）。我的理论是不等式应该是等式，但我还没有能够证明它。对于你列出的所有你暴力破解的值，这个语句实际上是一个相等的。

如果它是一个平等，那么要解决这个问题你会做的是：

1.  从总成本为零的空代码集开始
    *   从 1 迭代到 10 ⁹，执行：
        1.  在您的代码集中找到最便宜的代码
    *   通过附加 0 和 1 将该代码分成两部分
    *   将该代码的成本 + 5 添加到总成本中

如果您使用[优先队列](http://en.wikipedia.org/wiki/Priority_queue)，您应该能够在 O(N log N) 时间内完成此操作。鉴于上限为 10 ⁹ ，这可能可行，也可能不可行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T22:59:15.273

亚当：感谢大量的链接 - 它看起来*很有*希望！在阅读 Wikipedia 文章后我不确定的是如何考虑 4 的系数。我正在努力将 Project Euler 问题“映射”到算法。字母表的长度必须是 10^9 项，但重量是多少？

另一件困扰我的事情是，正如我上面提到的，霍夫曼编码充其量是 O(n) 肯定太慢了......

mattiast：我不认为你的复发有效（或者我误解了它！）。我对它的解释是：

```
def cost(n):
    if n == 1: return 1

    m = None
    for k in range(1, n):
        v = cost(k)+cost(n-k)+k+4*(n-k)
        if not m or v < m: m = v

    return m

print(cost(6)) 
```

它返回的值是 41，而应该是 35。同样，如果我的值是正确的，那么我在 ATT 的整数序列百科全书中找不到差异。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T15:29:32.653

N = 10**9

t = [0]

对于 xrange(N) 中的 c ： m = min(t) t.remove(m) t.append(m+1) t.append(m+4) 打印 sum(t), t

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T20:51:08.637

我是如何解决它的，计算成本（n）高达 n=1000，然后只是猜测它是如何从那里进行的。如果你看连续值的差异，并使用[整数序列的百科全书](http://www.research.att.com/~njas/sequences/)（和一些想象），你可以猜出规则。

您可以使用一种动态编程计算小 (<=1000) 示例，使用递归`Cost(n) = min {Cost(k)+Cost(n-k)+k+4*(n-k) | 0 < k < n}`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T00:06:44.433

Adam Rosenfield 的解决方案看起来很有可能奏效。这里已经很晚了（大约午夜！）所以我会一直留到早上。我在 C 中有效地实现了优先级队列，所以明天我将尝试使用它并找到解决方案。

我将报告算法的成功，但推理对我来说似乎是合理的，并且与数据非常吻合（如上所述）。但是，正如我一直在喃喃自语，一定有一个 sub O(n) 算法！;-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-07T18:15:50.447

事实证明，O[n*log(n)] 并不算太慢，但内存复杂度大约为 O(n)。然而，上面提出的算法可以进一步降低到 O(n) 时间复杂度和低内存复杂度。为此，可以使用数组 x，其中 x[a] = 成本 a 的数值数。

所做的假设给出了 10^9 的正确结果，所以我认为它们是正确的。

# django - 在 Django 中的父保存处访问 ForeignKey 对象

> ID：346718
> 
> 赞同：1
> 
> 时间：2008-12-06T20:19:50.650
> 
> 标签：django, image, foreign-keys, save

我正在尝试使用内联编辑和 ForeignKey 制作添加到 django 中的模型的所有图像的组合图像。我有这些模型（简化）：

```
class Modell(models.Model):
    title = models.CharField('beskrivelse', max_length=200)
    slug = models.SlugField()
    is_public = models.BooleanField('publisert', default=True)

    def __unicode__(self):
        return self.title

    def save(self, **kwargs):
        super(Modell, self).save(**kwargs)

        on_modell_saved(self)   

class Image(models.Model):
    modell = models.ForeignKey(Modell, related_name="images")
    image = ThumbnailImageField('bilde', upload_to=get_upload_path_image)

    class Meta:
        verbose_name = 'bilde'
        verbose_name_plural = 'bilder'

    def __unicode__(self):
        return str(self.image) 
```

然后我使用 AdminInline 将图像添加到 Modell，所以当我保存 Modell 时，我会保存 x 个图像。

但是当我尝试在 on_modell_saved 函数中使用 Modell.images.all 做某事时，我无法掌握这些对象。我得到了在 Modell.save() 执行的这个函数

```
def on_modell_saved(instance):
    for img in instance.images.all():
        print img 
```

这只会在我第二次而不是第一次保存 Modell 时打印一些东西。所以有人知道在您使用 AdminInline 添加的所有项目保存后如何调用函数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T22:01:59.570

`Modell`并且`Image`是两个单独的模型，用`ForeignKey`. 尽管他们似乎都得救*了*，但他们没有。它们被一个一个地保存（首先是 the`Modell`或首先是`Image`s）。

现在逻辑上`Image`s 保存**在 之后** `Modell`。因为它们有一个`ForeignKey`指向`Modell`，如果您尝试先保存它们，因为没有`Modell`是，它们将指向任何内容（这可以使用`null=True`）。

所以到时候`Modell.save()`被称为`Image`s 是不存在的。

[解决方案](http://docs.djangoproject.com/en/dev/topics/signals/#topics-signals)取决于你想做什么？我想这里的目的不仅仅是打印出`Image`s。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T20:56:43.460

`Modell`添加新图像时未保存实例；只有`Image`实例被保存。

将你的函数调用移动到`Image`模型中，你会很好的。

```
def on_image_saved(instance):
    for img in Image.objects.filter(modell=instance.modell)
        print img

class Image(models.Model):
    modell = models.ForeignKey(Modell, related_name="images")
    image = ThumbnailImageField('bilde', upload_to=get_upload_path_image)

    class Meta:
        verbose_name = 'bilde'
        verbose_name_plural = 'bilder'

    def __unicode__(self):
        return str(self.image)

    def save(self, **kwargs):
        super(Image, self).save(**kwargs)

        on_image_saved(self) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T00:59:56.417

我以某种方式解决了它，但它不是最优的，我在图像保存上做了 modell_on_save 函数，这很有效，但是如果有 5 个相关图像并保存到模型中，就会有 5 次调用该函数，这很糟糕。我希望它只发生在最后一个之后......

# ruby-on-rails - 使用 edge 生成 Rails 应用程序的最佳方法是什么？

> ID：346720
> 
> 赞同：3
> 
> 时间：2008-12-06T20:23:31.297
> 
> 标签：ruby-on-rails

目前，当我想使用边缘创建 Rails 应用程序时，我首先运行...

```
rails appname 
```

然后我...

```
rake rails:freeze:edge 
```

然后我删除了所有文件夹，但包含冻结边缘的供应商文件夹除外。完成后，我运行（从站点的根目录）...

```
ruby vendor/rails/railties/bin/rails . 
```

我现在这样做是因为我想利用新的 rails 模板、新的 application_controller.rb 文件名等等（如果我只使用以前生成的应用程序和冻结的边缘，我就做不到）。

有没有更好的办法？其他人如何使用边缘？我可以将edge安装为gem吗？有没有一种方便的方法可以让计算机上只有一个边缘副本并使用它来仅使用`rails`命令生成新的应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T23:48:23.147

使用 git 获取边缘导轨（将存储库克隆到本地硬盘）。然后，只需将克隆的 rails git 存储库的 bin 目录添加到 gem 路径前面的 PATH 中，以便 repo 中的 rails 命令优先并在创建新的 rails 应用程序时执行。

`/home/foo/rails`例如，如果您将rails.git 存储库克隆`export PATH=/home/foo/rails/railties/bin:$PATH`到`~/.bashrc`. 要创建一个新的 rails 应用程序，您只需运行`rails myapp`vendor/rails 并将其符号链接到您克隆的 edge rails 存储库，这样您只需要一个副本：`ln -s /home/foo/rails .../myapp/vendor/rails`

这样，您可以轻松地在 Rails 核心本身的一个分支上工作，并且可以使用最新的 Edge Rails 开发/测试本地应用程序。

# java - LINQ for Java 工具

> ID：346721
> 
> 赞同：40
> 
> 时间：2008-12-06T20:23:58.080
> 
> 标签：java, sql, mysql, linq

java的LINQ会是一个有用的工具吗？我一直在研究一种工具，它允许 Java 对象映射到数据库中的一行。

1.  这对 Java 程序员有用吗？
2.  什么功能会有用？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-12-06T20:31:27.583

LINQ for Java 会很不错，但问题在于语言集成。

Java 没有像 lambda 表达式那样简洁的东西，它们是 LINQ 的基石之一。我想他们*可以*通过使扩展创建匿名内部类，将查询表达式支持放在没有 lambda 表达式的普通 Java 之上——但这会非常可怕。如果您想执行 LINQ to SQL 之类的操作，还需要表达式树。

检查的异常*可能*会阻碍，但我们必须看到。IQueryable 的等价物需要有某种通用的检查异常——或者它可能在元素类型和异常类型中都是通用的......

无论如何，这都是天上掉馅饼——考虑到 Java 社区在闭包方面遇到的麻烦，我认为在 2012 年左右之前期望 Java 本身出现类似 LINQ 之类的东西是愚蠢的。当然，这并不是说用“类似Java”的语言是不可能的。例如，Groovy 已经具有某些有用的方面。

对于库方面，Hibernate 已经为 LINQ to SQL 的许多特性提供了一个“非集成”版本。对于 LINQ to Objects，您应该查看[Google Java Collections API](http://code.google.com/p/google-collections/) - 它有很多相同的东西（过滤、投影等）。当然，如果没有 lambdas，使用起来会更加繁琐——但它仍然非常非常方便。（我在工作中一直使用 Google Collections 代码，我不想回到“vanilla”Java 集合。）

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-11-11T07:32:03.023

值得注意的是，[Scala 2.8 将支持 LINQ](http://permalink.gmane.org/gmane.comp.lang.scala.announce/154) ...

* * *

实际上，scala 标准集合提供的 API 在某种意义上类似于 LINQ-for-Objects。这是示例：

```
List("Paris","Berlin","London","Tokyo")
  .filter(c => c.endsWith("n"))
  .map(c => c.length) 
// result would be length of the words that ends 
// with "n" letter ("Berlin" and "London"). 
```

不要害怕换行点语法：你可以用普通的旧样式编写代码：

```
Array(1,2,3,4,5,6).map(x => x*x) 
```

并且有许多项目提供接近 LINQ-to-SQL 的语法。例如，取自 Squeryll 的片段：

```
import Library._
using(session) { 
  books.insert(new Author(1, "Michel","Folco"))            
  val a = from(authors)(a=> where(a.lastName === "Folco") select(a)) 
}
// but note that there is more code behind this example 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-01-11T18:54:55.690

有关该问题的更通用方法，请考虑使用[Querydsl](http://www.querydsl.com)。

它提供 LINQ 风格的语法，支持 JPA/Hibernate、JDO、SQL 和 Java 集合后端。

我是Querydsl的维护者，所以这个答案是有偏见的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-02-02T22:54:33.023

Java [LINQ to SQL](https://github.com/streamx-co/FluentJPA)实现。与 .NET LINQ 相比，提供完整的语言集成和更大的功能集。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-07T07:49:03.113

**Hibernate**使用 HQL。你可以做对象，但只适用于关系数据库

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-06T13:27:56.207

提供 LINQ-to-objects 功能的 Java 扩展是[SBQL4J](http://code.google.com/p/sbql4j/)。它提供：

*   编译时的类型安全
*   比 LINQ 更强大的查询引擎
*   与当前 JVM 的兼容性（它使用预处理将查询转换为纯 Java 代码）
*   性能不错（运行时不使用反射）
*   清晰、精确的语义，没有不必要的、晦涩的语法糖。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-14T19:11:11.953

宝贝步骤：

第一种方法：使用字符串而不是 lambda 来实现 Java LINQ。

`IQueryProviders`基于字符串表达式编写。

然后，追求在语言中直接添加字符串表达式。

但首先，我想要一个可以工作的 LINQ：用语言输入 linq，这是一件好事，但主要的一点是：有一种编写方法`IQueryProviders`，然后，为[POJO](http://en.wikipedia.org/wiki/Plain_Old_Java_Object)编写一个提供程序，为 Hibernate 提供一个提供程序，为 SQL 提供一个提供程序服务器或甲骨文等...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-10-28T08:18:28.590

[锡耶纳](http://www.sienaproject.com/)项目似乎不错。

# python - 使用“导入”效率更高吗 ”或“从 进口 “？

> ID：346723
> 
> 赞同：7
> 
> 时间：2008-12-06T20:25:05.567
> 
> 标签：python, import

假设我只需要使用 re 模块中的 findall() ，这样做是否更有效：

```
from re import findall 
```

或者

```
import re 
```

速度/内存使用等实际上有什么区别吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-06T20:45:37.740

导入没有区别，但访问权限略有不同。

当您访问该功能时

```
re.findall() 
```

python需要先在全局范围内找到模块，然后在modules dict中找到findall。如果您在循环中调用它数千次，可能会有所不同。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-06T23:20:18.913

如有疑问，请计时：

```
from timeit import Timer

print Timer("""re.findall(r"\d+", "fg12f 1414 21af 144")""", "import re").timeit()
print Timer("""findall(r"\d+", "fg12f 1414 21af 144")""", "from re import findall").timeit() 
```

我得到以下结果，使用至少 5 次重复 10,000,000 次调用：

```
re.findall(): 123.444600105
findall(): 122.056155205 
```

直接使用`findall()`而不是`re.findall()`.

但是，实际导入语句的速度差异很大。在我的电脑上，我得到以下结果：

```
>>> Timer("import re").timeit()
2.39156508446
>>> Timer("from re import findall").timeit()
4.41387701035 
```

所以`import re`似乎执行速度大约是原来的两倍。不过，据推测，导入代码的执行是您的瓶颈，而不是实际的导入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T20:35:50.647

没有区别，除了导入后在本地命名空间中可以看到 re 中的哪些名称。

# sharepoint - 如何从自定义 Sharepoint 工作流程中关联项目的字段中提取值？

> ID：346729
> 
> 赞同：0
> 
> 时间：2008-12-06T20:27:20.510
> 
> 标签：sharepoint, workflow

我在 Visual Studio 2008 中创建了一个自定义 WSS 工作流，并且有一个“创建任务”活动。在创建任务时，我希望能够从与工作流关联的列表项中引用一些字段值，并且在我的一生中，我似乎无法确定如何获取该字段中的值物品。我知道你可以使用：

```
workflowProperties.Item 
```

访问该项目本身，但是如果我想检索该项目上一个名为“请求的金额”的字段的值，我将如何去做呢？我见过 'GetFromattedValue(string)' 方法，但我真的不想要格式化的值，我真正想要的是原始字符串值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T20:30:46.353

workflowProperties.Item 只是一个 SPListItem，这意味着您可以使用 SPListItem["named_column"] 访问它：

SPListItem item = workflowProperties.Item; string amountRequested = item["请求金额"];

.b

# c - 如何使用指向 C 中结构指针的指针？

> ID：346730
> 
> 赞同：16
> 
> 时间：2008-12-06T20:28:51.113
> 
> 标签：c, struct, pointer-to-pointer

我想在双指针下更改结构的成员。你知不知道怎么？

示例代码

```
typedef struct {
    int member;
} Ttype;

void changeMember(Ttype **foo) {
   //I don`t know how to do it
   //maybe
   *foo->member = 1;
} 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-06T20:33:53.523

尝试

```
(*foo)->member = 1; 
```

您需要先明确使用 *。否则，这是取消引用成员的尝试。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-06T20:34:09.607

由于运算符优先级，您需要将括号括起来：

```
(*foo)->member = 1; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T20:59:41.160

您可以使用临时变量来提高可读性。例如：

```
Ttype *temp = *foo;
temp->member = 1; 
```

如果您对此有控制权并允许使用 C++，则更好的方法是使用引用。例如：

```
void changeMember(Ttype *&foo) {
   foo->member = 1;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T20:33:44.067

也许 (*foo)->member = 1 （如果它是动态分配的）

# c# - 如何在 .NET 中创建非 OwnerDraw 按钮？

> ID：346750
> 
> 赞同：4
> 
> 时间：2008-12-06T20:41:10.950
> 
> 标签：c#, .net, c++, ownerdrawn

我正在为我创建的表单皮肤创建一个插件。但是，按钮不是基于它们的皮肤，而是显示标准的灰色按钮。在软件论坛上询问指出我.NET 表单控件是所有者绘制的，因此我的按钮不会以正确的样式重绘，而不是创建非所有者绘制按钮。

system.windows.forms 命名空间中的所有控件似乎都是 ownerdraw。

那么如何在 .NET 中创建标准 C++ PUSHBUTTON 呢？

如果有帮助，目前在 C# 中编码。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T13:47:29.237

听起来您想将`FlatStyle`按钮的属性设置为`FlatStyle.System`. 默认情况下，Windows 窗体按钮确实是 WinAPI 级别的所有者绘制，并由框架绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T21:26:26.270

Windows.Forms 中的控件不是所有者绘制的，而是系统绘制的。这是 Windows 在默认情况下绘制它们的方式，无论是 Button、TextBox 还是其他。您可以通过指定控件应该是所有者绘制的（即：您负责绘制它）来覆盖绘图 - 一些控件支持这一点，其中一些甚至具有更精细的粒度（参见 ListView），或者您可以在任何 Control 后代的 OnPaint 事件中完全覆盖绘画。

您的问题相当令人困惑-据我所知，您在插件中创建的按钮没有蒙皮。显然，您需要告诉这个皮肤框架来绘制这些按钮。可能有或应该有一些组件放在插件表单或您调用的方法上，它们会将蒙皮绘制例程注入您的插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-08T16:57:05.813

您是否尝试过将 设置`FlatStyle`为另一个值，例如`Flat`or `Popup`，只是为了看看是否会阻止它被剥皮？

还设置`Flaststyle = Standard`（而不是系统）可能会解决您的问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-08T18:10:22.657

标准是默认设置，因此没有重新设计。当设置为平面时，我得到一个背景色和一个前景色，但失去了圆角末端悬停效果，表明控件没有重新设置皮肤，只应用了颜色样式。Flat 是唯一不是灰色的版本，但我失去了一些按钮功能（悬停，圆角）

# c - 拼写检查器如何工作？

> ID：346757
> 
> 赞同：24
> 
> 时间：2008-12-06T20:50:29.713
> 
> 标签：c, spell-checking

我需要在 C 中实现一个拼写检查器。基本上，我需要所有标准操作......我需要能够对一段文本进行拼写检查，提出单词建议并动态地将新单词添加到索引中。

我有点想自己写这个，虽然我真的不知道从哪里开始。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-06T21:35:10.420

阅读[树遍历](http://en.wikipedia.org/wiki/Tree_traversal)。基本概念如下：

1.  将字典文件读入内存（该文件包含给定语言可能/常见的正确拼写单词的完整列表）。您可以在线下载免费的字典文件，例如[Oracle 的示例字典](https://docs.oracle.com/javase/tutorial/collections/interfaces/examples/dictionary.txt)。
2.  将此字典文件解析为搜索树，以使实际的文本搜索尽可能高效。我不会描述这种树结构的所有脏细节，但是树将由具有（最多）26 个到子节点的链接（每个字母一个）的节点组成，加上一个标志来指示是否当前节点是否是有效单词的结尾。
3.  遍历文档中的所有单词，并根据搜索树检查每个单词。如果您到达树中的节点，其中单词中的下一个字母不是当前节点的有效子节点，则该单词不在字典中。此外，如果您到达单词的结尾，并且该节点上未设置“单词的有效结尾”标志，则该单词不在字典中。
4.  如果在字典中找不到单词，请通知用户。在这个阶段，您还可以建议替代拼写，但这会有点复杂。您将不得不遍历单词中的每个字符，替换替代字符并针对搜索树测试每个字符。寻找推荐词可能有更有效的算法，但我不知道它们是什么。

一个非常简短的例子：

字典：

> apex 苹果任命

树：（`*`表示有效的词尾） **更新：**感谢 Curt Sampson 指出这种数据结构称为[Patricia 树](http://en.wikipedia.org/wiki/Patricia_tree)

> `A -> P -> E -> X*
>       \\-> P -> L -> E*
>            \\-> O -> I -> N -> T* -> E -> D*`

文档：

> 苹果appint猿

结果：

*   “apple”将在树中找到，因此它被认为是正确的。
*   “appint”将被标记为不正确。遍历树，你会跟着`A -> P -> P`，但是第二个`P`没有`I`子节点，所以搜索失败。
*   "ape" 也会失败，因为`E`in 中的节点`A -> P -> E`没有设置 "valid end of word" 标志。

**编辑：**有关拼写建议的更多详细信息，请查看[Levenshtein Distance](http://en.wikipedia.org/wiki/Levenshtein_distance)，它测量将一个字符串转换为另一个字符串所必须进行的最少更改次数。最好的建议是与拼写错误的单词之间的 Levenshtein 距离最小的字典单词。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T20:58:34.017

鉴于您不知道从哪里开始，我建议您使用现有的解决方案。例如，请参见[aspell](http://aspell.net/) （获得 GLPL 许可）。如果您真的必须自己实现它，请告诉我们原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T02:22:11.337

应该查看前缀和后缀。

**突然 = 突然 + ly。**

通过删除 ly's 你可以摆脱只存储根词。

同样**preallocate = pre + allocate。**

而**lovely = love + ing + ly** 会变得更复杂一些，因为**ing**的英语规则被调用了。

也有可能使用某种散列函数将根词映射到特定位是一个大位图，作为确定根词是否拼写正确的恒定时间方法。

通过尝试为拼写错误的单词提供可能正确拼写的替代列表，您可能会变得更加复杂。您可能会研究 soundex 算法以获得一些想法。

我建议用一小组单词进行原型设计。做大量测试，然后扩大规模。这是一个奇妙的教育问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T02:51:35.490

将单词分成词根和后缀被称为“Porter Stemming Algorithm”，它是一种将英文词典放入极小的记忆的好方法。
它对 seach 也很有用，所以“拼写检查”也会找到“拼写检查”和“拼写检查”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-20T05:01:02.457

我在课堂上做过

您应该考虑专门用于处理此问题的python [Natural Language Toolkit NLTK 。](http://nltk.sourceforge.net/index.php/Main_Page)

它还允许创建文本解释器，例如聊天机器人

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-09T18:14:05.860

Open Office Spell checker Hunspell 是一个很好的起点。这是主页： [Sourceforge 的 Hunspell](http://hunspell.sourceforge.net/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-24T22:04:08.123

E James 为如何判断一个词是否有效给出了一个很好的答案。这可能取决于拼写检查器如何确定可能的拼写错误。

一种这样的方法，我将使用的一种方法是[Levenshteinn 字符串相似度](https://people.cs.pitt.edu/~kirk/cs1501/Pruhs/Spring2006/assignments/editdistance/Levenshtein%20Distance.htm)，它查看必须在一个单词中添加、删除或交换多少个字母才能生成另一个单词。

如果你说拼写：Country as Contry。levenshtein 字符串相似度为 1，因为您只需添加 1 个字母即可将国家/地区转换为国家/地区。

然后，您可以遍历所有可能的正确拼写单词（只有 171,000 个英文单词，其中 3000 个占文本的 95%）。确定那些具有最低 levenshtein 字符串相似度值的词，然后返回与拼写错误的词最相似的前 X 个词。

有一个很棒的 python 包，叫做[Fuzzy Wuzzy](https://pypi.org/project/fuzzywuzzy/)，它有效地实现了这一点，并根据这个公式在两个单词或句子之间生成 % 相似度。

# data-structures - 如何找到“等效”文本？

> ID：346760
> 
> 赞同：1
> 
> 时间：2008-12-06T20:53:14.637
> 
> 标签：data-structures, data-mining, web-crawler

我想找到（不生成）2 个文本字符串，这样，在删除所有非字母和 ucasing 之后，一个字符串可以通过简单的替换转换为另一个。

这样做的动机来自我知道的一个项目，该项目是测试通过概率分布攻击密码的方法。我想找到一个大而连贯的纯文本，一旦用简单的替换密码加密，就可以解密为其他同样连贯的内容。

这最终分为两部分，在语料库中找到最长的此类字符串，并获得该语料库。

* * *

在我看来，第一部分似乎对某种攻击很友好，在替换后将 B-tree 键控掉字符串，这使得第一次出现的序列是连续的。

```
HELLOWORLDTHISISIT
1233454637819a9b98 
```

基于知道基于树的每个深度的字符串的最大值和长度的一点优化，其余的只是编码。

* * *

另一部分会涉及更多；如何生成大量文本进行搜索？某种互联网蜘蛛似乎是理想的方法，因为它可以访问最多的文本，但如何将其剥离为文本？

问题是; 关于如何更好地做到这一点的任何想法？

* * *

编辑：正在使用的密码是一个非常基本的 26 个字母替换密码。

ps 这对我来说更像是一个思想实验，而不是一个可能的真实项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T01:16:15.557

有26个！不同的替换密码。可以选择超过 88 位：

```
>>> math.log(factorial(26), 2)
88.381953327016262 
```

英文文本的熵至少是每个字符 2 位。因此，在我看来，您无法合理地期望找到超过 45-50 个字符的段落在替换下意外等效。

对于大型语料库，首先是 Gutenberg Project 和 Wikipedia。您可以从他们的网站下载所有英文维基百科的 XML 文件的转储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T21:52:20.837

我认为您要生成一个“连贯”的替换要求有点高。这是加密算法的一个 AI 问题，用于确定哪些文本是连贯的。此外，您的文本越长，创建“连贯”结果就越复杂......只要您正在加密的文本，就会快速接近您需要“密钥”的点。从而完全违背了加密它的目的。

# java - 垃圾收集对象在内部 Map 中跟踪自己的实例

> ID：346762
> 
> 赞同：2
> 
> 时间：2008-12-06T20:55:49.703
> 
> 标签：java, garbage-collection, map, object

在我的类的构造函数中，我将当前对象（*this*）连同它的键（在构造函数中作为参数输入的字符串）映射到静态 LinkedHashMap 中，这样我就可以在以后可能需要的任何地方通过字符串引用对象.

这是代码（如果有帮助）：

```
public class DataEntry {
    /** Internal global list of DataEntry objects. */
    private static LinkedHashMap _INTERNAL_LIST;

    /** The data entry's name. */
    private String NAME;

    /** The value this data entry represents. */
    private Object VALUE;

    /** Defines a DataEntry object with a name and a value. */
    public DataEntry( String name, Object value )
    {
        if( _INTERNAL_LIST == null )
        {
            _INTERNAL_LIST = new LinkedHashMap();
        }

        _INTERNAL_LIST.put( name, this );

        NAME = name;
        VALUE = value;
    }
} 
```

问题？当我使用完此类的实例时，它们不会被垃圾收集。

我只是好奇是否有办法让这个类的实例在我用完它们后自行清理，而不必每次都手动调用 Remove() 方法或其他东西（当我在内部 LinkedHashMap 中删除它的引用时） '不再使用它们，我的意思是）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-06T21:09:41.640

改为使用值[WeakReferences](http://java.sun.com/javase/6/docs/api/java/lang/ref/WeakReference.html)（或[SoftReferences](http://java.sun.com/javase/6/docs/api/java/lang/ref/SoftReference.html)）。这样，这些值仍然可以被垃圾收集。当然，您仍然会在映射中包含条目 - 但您可以定期清除映射中 Weak/SoftReference 现在为空的任何条目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T22:06:21.243

在构造函数完成之前使对象对其他人可见不是线程安全的。

目前尚不清楚在这种情况下如何使用地图，但假设类中有这样的静态方法：

```
public static DataEntry getEntry(String name) {
  return _INTERNAL_LIST.get(name);
} 
```

另一个并发运行的线程可以访问`DataEntry`它正在创建的一段时间，并开始使用一个未初始化的条目`VALUE`。即使您重新排序构造函数中的代码，以便将新实例添加到映射是您做的最后一件事，JVM 也可以重新排序指令，以便首先将对象添加到列表中。或者，如果类被扩展，子类初始化可以在对象发布之后进行。

如果多个线程访问与`DataEntry`类的交互，您可能会遇到一个依赖于平台、间歇性且很难诊断的并发错误。

Brian Goetz的文章[“安全施工”提供了有关此主题的更多信息。](http://www.ibm.com/developerworks/java/library/j-jtp0618.html#2)

回到最初的问题：`WeakReference`正如其他人所提到的，使用 是一种很好的方法，但我建议不要为您的值创建一个扩展的包装器，而不是遍历地图中的每个条目`WeakReference`（它可以是您`DataEntry`自己，也可以是助手），并在 a 中对每个引用进行排队[`ReferenceQueue`](http://java.sun.com/javase/6/docs/api/java/lang/ref/ReferenceQueue.html)。这样，您可以快速轮询队列以获取任何收集的条目，并将它们从地图中删除。这可以通过在类初始化程序中启动的后台线程（阻塞 on ）来完成，或者每次添加新条目时[`remove`](http://java.sun.com/javase/6/docs/api/java/lang/ref/ReferenceQueue.html#remove())都可以清除（通过[轮询）任何过时的条目。](http://java.sun.com/javase/6/docs/api/java/lang/ref/ReferenceQueue.html#poll())

如果你的程序是多线程的，你应该放弃`LinkedHashMap`一个 map from [`java.util.concurrent`](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ConcurrentMap.html)，或者包装`LinkedHashMap`with [`Collections.synchronizedMap()`](http://java.sun.com/javase/6/docs/api/java/util/Collections.html#synchronizedMap(java.util.Map))。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T21:03:37.423

你想要使用的似乎是一个弱参考。这个概念是弱引用不足以强制对象不被 GC'ed。我对他们没有太多经验，但你可以[在这里](http://weblogs.java.net/blog/enicholas/archive/2006/05/understanding_w.html)了解更多。

# php - 在 PHP 中处理时区

> ID：346770
> 
> 赞同：20
> 
> 时间：2008-12-06T21:05:52.320
> 
> 标签：php, database, timezone

PHP 中时区的一些问题已经在我脑海中浮现了一段时间，我想知道是否有比我目前正在做的更好的方法来处理它。

所有问题都围绕重新格式化数据库存储日期：

在处理必须支持多个时区（对于用户）的站点时，为了规范存储时间戳的时区，我总是使用`CURRENT_TIMESTAMP`属性或`NOW()`函数将它与服务器时区一起存储。

这样我就不必考虑在输入时间戳时为 PHP 设置的时区（因为 PHP 时间函数是时区感知的）。对于每个用户，根据他的偏好，我使用以下命令在引导文件中的某处设置时区：

```
date_default_timezone_set($timezone); 
```

当我希望使用 php`date()`函数格式化日期时，必须进行某种形式的转换，因为 MySQL 当前以格式存储时间戳`Y-m-d H:i:s`。不考虑时区，您可以简单地运行：

```
$date = date($format,strtotime($dbTimestamp)); 
```

问题在于它们都是时区感知函数`date()`，`strtotime()`这意味着如果 PHP 时区的设置与服务器时区不同，则时区偏移量将应用两次（而不是我们想要的一次）。

为了解决这个问题，我通常使用`UNIX_TIMESTAMP()`不支持时区的函数来检索 MySQL 时间戳，允许我`date()`直接应用它——从而只应用一次时区偏移量。

我不太喜欢这种“hack”，因为我不能再像往常一样检索这些列，或者`*`用来获取所有列（有时它大大简化了查询）。此外，有时它根本不是一个使用选项`UNIX_TIMESTAMP()`（尤其是在使用没有太多抽象查询组合的开源包时）。

另一个问题是在存储时间戳时，当使用`CURRENT_TIMESTAMP`or`NOW()`不是一个选项时 - 存储 PHP 生成的时间戳会将它与我想避免的时区偏移一起存储。

我可能在这里遗漏了一些非常基本的东西，但到目前为止，我还没有想出一个通用的解决方案来处理这些问题，所以我不得不逐个处理它们。非常欢迎您的想法

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-08T16:12:08.073

几个月前，我们花了一些时间思考这个问题。我们最终得到的技术非常简单：

1.  以 GMT/UTC 存储日期（例如 0 时区偏移）。
2.  在从数据库中检索后应用当前用户时区偏移量（例如，在向用户显示之前或您想要的任何时候）。

我们使用 Unix 时间戳格式。但这没关系。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-30T02:22:28.357

从 PHP 5.2 开始，您可以使用 DateTime，这使得使用时区变得容易：

```
$datetime = new DateTime($dbTimestamp, $timezone);
echo $datetime->format('Y-m-d H:i:s');
$datetime->setTimezone(new DateTimeZone('Pacific/Nauru'));
echo $datetime->format('Y-m-d H:i:s'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T21:23:39.023

您可以尝试强制 MySQL 在任何地方使用 UTC 使用[`SET time_zone`](http://dev.mysql.com/doc/refman/5.0/en/time-zone-support.html).

不幸的是，我没有得到关于 strtotime/UNIX_TIMESTAMP 的任何答案，事实上我对 Postgres 也有同样的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-10T20:44:17.230

我没有在网上找到任何优雅的解决方案，所以我创建了一个[时区 HTML 选择生成器](https://github.com/dlucian/Timezone-Generator-PHP "GitHub 上的时区生成器-PHP")脚本，这是直接的[输出](https://gist.github.com/dlucian/5752015 "生成的 HTML 时区选择")。是这样的：

```
<select name="timezone" id="timezone">
    <optgroup label="UTC -11:00">
        <option value="Pacific/Midway">UTC -11:00 Midway</option>
        <option value="Pacific/Niue">UTC -11:00 Niue</option>
        <option value="Pacific/Pago_Pago">UTC -11:00 Pago_Pago</option>
    </optgroup>
    <optgroup label="UTC -10:00">
        <option value="America/Adak">UTC -10:00 Adak</option>
        <option value="Pacific/Honolulu">UTC -10:00 Honolulu</option>
        <option value="Pacific/Johnston">UTC -10:00 Johnston</option>
        <option value="Pacific/Rarotonga">UTC -10:00 Rarotonga</option>
        <option value="Pacific/Tahiti">UTC -10:00 Tahiti</option>
    </optgroup>
    . . . . . . . . . . . . . .
    <optgroup label="UTC +13:00">
        <option value="Pacific/Apia">UTC +13:00 Apia</option>
        <option value="Pacific/Enderbury">UTC +13:00 Enderbury</option>
        <option value="Pacific/Fakaofo">UTC +13:00 Fakaofo</option>
        <option value="Pacific/Tongatapu">UTC +13:00 Tongatapu</option>
    </optgroup>
    <optgroup label="UTC +14:00">
        <option value="Pacific/Kiritimati">UTC +14:00 Kiritimati</option>
    </optgroup>
</select> 
```

享受！

# math - 添加负和正二进制？

> ID：346774
> 
> 赞同：5
> 
> 时间：2008-12-06T21:11:38.267
> 
> 标签：math, binary

X = 01001001 和 Y = 10101010

如果我想将它们加在一起，我该怎么做？它们是“Two's Complement”......我已经尝试了很多东西，但我不太确定我得到了正确的答案，因为似乎有不同类型的规则。

只是想确保它是正确的：
1\. 按原样添加它们，不要转换负数
2\. 转换你得到的负数，这就是总和。

f.eks 01001001
+10101010 = 11110011 => 00001100 => 1101 => -13

或者？
1.转换负数
2.将它们加在一起并转换负数

f.eks 01001001
+10101010 => 01001001 + 01010110 => 10011111 => 01100001 => -97

所以基本上我想做的就是取：XY和X +Y
有人可以告诉我该怎么做吗？

一些资源网站： [学生二进制](http://www.cs.grinnell.edu/~rebelsky/Courses/CS152/97F/Readings/student-binary.html) [celtickane](http://celtickane.com/computers/cs_binary.php) [swarthmore](http://www.swarthmore.edu/NatSci/echeeve1/Ref/BinaryMath/BinaryMath.html)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-06T21:28:30.620

二进制补码的美妙之处在于，在二进制级别上，这是一个解释问题而不是算法问题 - 添加两个有符号数的硬件与无符号数的硬件相同（忽略标志位）。

您的第一个示例 - “只需添加它们” - 正是正确的答案。您的示例数字

*   01001001 = 73
*   10101010 = -86

所以，正确答案确实是-13。

减法是一样的，因为二进制补码不需要特殊处理：你“只是减去它们”。

请注意，有趣的地方是上溢/下溢位的处理。您不能将 73 - (-86) 的结果表示为 8 位二进制补码数......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T21:28:00.777

当两个参数的符号相反时，添加二进制补码不需要任何特殊处理。您只需像往常一样在二进制中添加它们，结果的符号就是您保留的符号。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T22:23:21.147

并且只是为了确保您理解二进制补码，将正数转换为负数（反之亦然）：反转每个位，然后将结果加 1。

比如你的正数 X = 01001001 变成 10110101+1=10110110 为负数；您的负数 Y = 10101010 变为 01010101+1=01010110 作为正数。

要从 X 中减去 Y，请将 Y 取反并加。即 01001001 + 01010110。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T14:40:51.487

您的困惑可能是因为所涉及数字的宽度。为了更好地了解这一点，您可以尝试从无符号整数中创建一个有符号整数。

如果您的无符号整数的 MSB 已经为 0，那么您可以将其读取为有符号并获得相同的结果。
如果 MSB 为 1，那么您可以在左侧附加一个 0 以获得有符号数。您应该对所有有符号数字进行符号扩展（即，如果 MSB 为 0，则添加 0，如果 MSB 为 1，则添加 1）以获得相同宽度的数字，以便您可以“正常”进行算术运算。

例如，使用您的号码：

X = 01001001：无符号，MSB 为 0，什么都不做。

Y = 10101010：已签名，对 X 什么也没做，仍然什么也不做。

但是如果我们将 X 的 MSB 更改为 1：

X = 11001001：无符号，MSB为1，加一个0 --> 011001001

Y = 10101010：有符号，扩展 X，所以符号扩展 Y --> 110101010

现在你有两个有符号的数字，你可以用你已经知道的方式加减。

# image - 如何使用整页背景图片留出装订空间？

> ID：346775
> 
> 赞同：1
> 
> 时间：2008-12-06T21:11:59.920
> 
> 标签：image, binding, latex, background, wallpaper

*在 Latex 中，除了*每页内侧的某个条纹外，如何使背景图像在每一页上占据整张纸？我想不通。
我有一个背景图像，我希望在打印/装订后的每一页上都能看到整个背景图像。

马蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-07T02:20:09.890

老实说，我只是在图像中添加空格:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T07:48:45.187

有一些相当[可怕的 LaTeX 黑客](http://snipplr.com/view/6057/background-image-in-latex/)，包括在每个页面下放置一个图片环境，并使用 \includegraphics 将图像放入该环境。您必须使用宽度选项调整图像的大小，如果您想要偶数页和奇数页，您必须检查页码以通过更改 \put(0, 0) 到 \put(3,0) 例如。

对于页码测试，请尝试以下顺序

```
\ifodd\count0 ...stuff for odd-numbered pages ...
\else   ... stuff for even-numbered pages ...
\fi 
```

这并不是一个完整的答案，但足以让您入门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-11T22:29:42.880

嗯，我在想这样的事情。
这真的是如此罕见的需要吗？我自己现在第一次需要这样的东西，但我不觉得它有那么大的奇怪。对我来说很奇怪，如果你想要一个背景来改变偶数页和奇数页，就像普通文本一样，你需要感到背叛了 Latex 逻辑。或者我对我的这个挑战太狂热了，我想感受整个 tex 世界的变化来满足我的愿望。:)

谢谢你的回答！

# php - 如何在php中动态检查函数的参数数量

> ID：346777
> 
> 赞同：11
> 
> 时间：2008-12-06T21:14:38.103
> 
> 标签：php

如何在运行时主页检查 PHP 中方法或函数的许多参数。

例子

```
类富 {
   功能栏（arg1，arg2）{
    ......
   }
}

```

我需要知道是否有办法运行类似的东西

```
get_func_arg_number ("foo", "bar")

```

结果是

```
2

```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-06T21:21:47.200

你需要使用[反射](http://php.net/oop5.reflection)来做到这一点。

```
$method = new ReflectionMethod('foo', 'bar');
$num = $method->getNumberOfParameters(); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-06T22:58:27.303

*反射*是你在这里所追求的

```
class foo {
   function bar ( $arg1, $arg2 ){

   }
}
$ReflectionFoo = new ReflectionClass('foo');
echo $ReflectionFoo->getMethod('bar')->getNumberOfParameters(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-06T21:19:41.353

您正在寻找 PHP5 中的反射功能 -[此处](http://php.net/oop5.reflection)的文档。

具体来说，查看 ReflectionFunction 和 ReflcetionMethod 类。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2008-12-06T21:19:45.520

我相信您正在寻找 func_num_args()

[http://us3.php.net/manual/en/function.func-num-args.php](http://us3.php.net/manual/en/function.func-num-args.php)

# distributed - 远程进程管理协议

> ID：346778
> 
> 赞同：0
> 
> 时间：2008-12-06T21:15:23.627
> 
> 标签：distributed, protocols, process-management, remote-process

**简而言之：**是否有任何已知的远程进程管理协议？

我有一个包含多个应用程序的系统，每个应用程序在本地网络中都有自己的计算机。当应用程序启动并运行时，它们可以毫无问题地进行通信。

我感兴趣的是管理远程应用程序启动、关闭和监控的协议。通过监控，我的意思是在出现问题时获取错误代码（预定义）。理想情况下，我会通过一个管理应用程序控制整个系统并了解正在发生的事情。

我曾经在一个编写内部协议的地方工作过。但是，如果有人已经弄清楚了，我希望避免再次编写它。

**编辑：**更多细节：

*   使用的平台是 x86 上的 Windows 和 Linux。
*   在 Windows 上，使用 C/C++ 和 .NET。在 Linux 上，C/C++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T21:35:53.880

为什么要使用本土解决方案而不是使用久经考验的技术？除非您只雇用拥有 30 多年经验的 MENSA 成员的程序员，否则您的解决方案将不那么健壮且维护成本更高。

你没有提到你正在使用的平台的任何细节，所以我假设一个 Unix-ish 系统。我会去（多年来一直在）

*   用于监控的 SNMP
*   daemontools 或 cron + scripting（作为遥远的第二选择）用于监督和重启
*   带有 RSA 身份验证的 ssh/scp 用于交互式干预、远程命令执行和偶尔传输

# performance - 检查 Web 应用程序性能的最佳方法

> ID：346784
> 
> 赞同：5
> 
> 时间：2008-12-06T21:19:23.180
> 
> 标签：performance

目前可用的最好的工具（开放的或商业的）是什么，它可以让我向 Web 服务器发送自定义请求并返回响应以检查性能？

我将向它发送每秒超过 20K 的负载，但我需要为每个呼叫获取号码。此外，这些数字可能以微秒或纳秒为单位。在这个小型测量单位中，我如何计算出基线和基准？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T21:28:04.443

如果您使用的是 Apache，则 Apache AB 是一个基准测试，用于测试您的服务器每秒可以处理多少个请求，以及它处理负载和并发性的能力。这是一个开源项目 - 在[这里查看](http://httpd.apache.org/docs/2.0/programs/ab.html)。

此外，维基百科有一个很好的用于测试服务器的[基准测试软件列表。](http://en.wikipedia.org/wiki/Web_server_benchmarking#Tools_for_benchmarking)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T21:28:39.887

您可以使用[Microsoft 的 Web Application Stress Tool](http://www.microsoft.com/downloads/details.aspx?FamilyID=e2c0585a-062a-439e-a67d-75a89aa36495&displaylang=en)

> Microsoft WAS Web 压力工具旨在真实地模拟多个浏览器从网站请求页面。您可以使用此工具收集有关您的 Web 应用程序的性能和稳定性信息。该工具使用相对较少的客户端计算机模拟大量请求。目标是创建一个尽可能接近生产的环境，以便您可以在部署之前发现并消除 Web 应用程序中的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T21:33:17.350

您可以找到用于性能[的开源软件列表](http://www.opensourcetesting.org/performance.php)（其中大多数是用于向网络服务器发送自定义请求的网络）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T21:42:49.747

不知道其中任何一个的粒度是否优于毫秒，但请查看[JMeter](http://jakarta.apache.org/jmeter/)（开源）和[LoadRunner](https://h10078.www1.hp.com/cda/hpms/display/main/hpms_content.jsp?zn=bto&cp=1-11-126-17%5E8_4000_100__)（商业）。LoadRunner 并不便宜，但它允许您跨多台机器生成负载并生成聚合结果。

# performance - 应用程序性能的基线和基准之间的差异

> ID：346788
> 
> 赞同：9
> 
> 时间：2008-12-06T21:21:45.873
> 
> 标签：performance, definition

什么是基线，什么是基准？这些的最佳定义是什么？您如何为一组数字设置基准并以另一组为基准？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-06T21:45:21.413

[SPR](http://www.spr.com/benchmark/benchmark.shtm)（软件生产力研究）的有趣定义

> 基线和基准是相似但不同的活动。
> 
> 形象地说，**基线是**组织的“沙线”，它衡量重要的绩效特征以供将来参考。

这不一定是“好”状态，只是一个参考。

> 基准最好通过单词本身的原始派生来理解：
> 
> 从事重复性工作的工匠，例如将木材锯成一致的长度，通常在他们的工作台上放置凹口，以指示切割前木板的放置。从字面上看，**基准成为比较的标准和过去成功的指标**。

基本上：

*   基线是关于**重要状态的识别**，这意味着您的一组数字达到了批准状态，公开认可。
*   基准是关于评估应用程序的**相对**性能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-07T00:23:30.483

嗨 Gagneet，我是 Windows 性能团队的成员：以下是我们使用这些术语的方式。

**基线**是对已知配置的测量，用作后续测量的参考。对于基线，我们描述了被测量的东西：让我们以冷启动时间为例。在这里，我们有一组具有良好特征的机器——这意味着我们知道它们是如何工作的，我们为它们提供了良好的驱动程序，并且硬件没有损坏或有缺陷。

在这个硬件上，我们有几个“基线”测量，例如 XP-RTM、XP-SP2、Vista-RTM、Vista-SP1、Vista-SP2 等。

对于这些基线中的每一个，我们都有一组特征明确且易于理解的测量值，包括启动的所有阶段、CPU 数量、磁盘和内存利用率、DLL 加载次数等。

建立基线后，我们可以进行其他测量并将它们与基线进行比较。例如，我们目前正在开发[Window-7](http://blogs.msdn.com/e7/)。对于每个构建（每天），我们都会运行一组启动时间测试。我们将每个 Win-7 版本的所有特性与基线测量值进行比较。这包括所有以前的 Win-7 版本。这让我们可以看到差异在哪里，并帮助我们深入研究问题区域。 [这里有更多细节](http://blogs.msdn.com/e7/archive/2008/08/29/boot-performance.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-08T22:04:24.710

在科学研究中，基准是一种测试，基线是一种结果。

让我们看一个基准测试的例子：我们可能会收集 5,000 个英语句子，并使用实验室的四核戴尔机器使用各种算法将它们翻译成西班牙语。因为我们保持数据和机器不变，我们可以有意义地比较不同算法完成任务所花费的时间，以及它们的相对准确性（根据黄金标准的人工翻译来衡量）。

为了找到这个基准测试的基线，我们可能会编写一个非常简单的翻译算法，它只为每个单词找到最常见的翻译，而不考虑上下文。根据我们的人工翻译测量该算法的准确性，让我们了解其他人必须击败的最低分数（基线），并让我们了解什么水平的准确性算作“好”。

在基准线的另一端，上限也是一个有用的标准。在翻译示例中，我们可以通过测量我们的人工翻译之一相对于其他翻译的准确性来找到上限。这让我们知道在你达到人类分歧的天花板之前，我们的“准确性”衡量标准有多高。我们希望我们的机器翻译算法在基线和上限之间的水平上执行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-06T21:26:35.520

如果我错了，请纠正我，但我相信“基线”是指已知的良好状态，而“基准”是指当前状态。您将进行基准测试并将其与基线进行比较。

# string - JSON到原型中的字符串

> ID：346793
> 
> 赞同：3
> 
> 时间：2008-12-06T21:23:49.443
> 
> 标签：string, json, cookies, prototypejs

这个网站上的人似乎什么都知道，所以我想我会问这个以防万一：

原型中是否有将 JSON 对象转换为可以存储在 cookie 中的字符串的方法/函数？

如果没有，..我将只使用另一个外部库。

谢谢， 安德鲁

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T21:37:10.680

当然有：[原型 JSON](http://www.prototypejs.org/learn/json)

```
var data = {name: 'Violet', occupation: 'character', age: 25 };
var myString = Object.toJSON(data);
// myString = '{"name": "Violet", "occupation": "character", "age": 25}' 
```

然后将 myString 推入你的 cookie

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T21:26:21.387

假设您说的是[Prototype JavaScript 框架](http://www.prototypejs.org/)，为什么不直接使用 JavaScript 自己的 JSON 功能呢？JSON 确实代表 JavaScript 对象表示法。

# javascript - 未检测到 Flash 10：世界上最广泛的网络视频错误？

> ID：346794
> 
> 赞同：2
> 
> 时间：2008-12-06T21:23:52.750
> 
> 标签：javascript, ajax, flash, version-detection, flash-10

问题是：确保您对站点上的 Flash 版本“x”的要求能够正确检测到更高版本的 Adob​​e Flash Player 版本“10”（或“1y”）的存在的最佳方法是什么？

现在有一个谜团：为什么这么多需要 Flash Player 版本 8 和 9 或更高版本的站点无法检测到 Flash Player 版本 10？

[这是我帖子“ WTF：Adobe Flash 版本 1x 危机](http://orcmid.com/blog/2008/12/wtf-adobe-flash-version-1x-crisis.asp)”中彩色屏幕截图的多汁背景。

**更新 2：**我已经确认我看到的问题不是关于相同或更新版本的不正确比较。似乎某些客户端检测无法确定是否安装了任何 Flash Player，更不用说它是什么版本了。我还发现，如果我以管理员身份运行，我没有问题：检测 Flash 10 工作得很好。这使得这罐蛇比我最初想象的要大。我还没有准备好更改这个问题的标题，我正在继续剖析客户端代码，看看会出现什么奇妙的逻辑。 [这些最新消息](http://orcmid.com/blog/2008/12/wtf-umm-flash-10-detection-not-so.asp)的详细信息在我的博客上。

**更新：**虽然我进行了搜索，但我错过了相关问题“[升级到 Flash 10 后为什么不播放 Flash 视频？](https://stackoverflow.com/questions/214424/why-dont-flash-videos-play-after-upgrading-to-flash-10) ”那里的猜测很有趣，但他们没有深入了解。此外，目前尚不清楚李维斯的问题是如何解决的。有趣......也许我们可以在这里找到事情的真相。

* * *

**一些背景**

我设法将新的 Adob​​e Flash Player 版本 10.0.12.36 安装为全新安装（使用 Adob​​e 提供的卸载程序删除了以前的版本）。

当我无法播放来自 CBS 电视网站的最新 NCIS 节目时，我注意到了第一个失望，不是高清的，也不是普通的旧标准。但我可以在 Hulu 上播放我最喜欢的节目的视频。我越是四处寻找，就越多地发现那些令人讨厌的你没有 Flash、你需要一个更高版本的 Flash、你的 Flash 版本的旧消息，它们提供了一个下载按钮。

每次我点击下载/更新按钮，并告诉 Adob​​e 网站进行安装（如果尝试安装应该会失败，因为我没有以管理员身份运行），我已经拥有 10.0.12.36 版本立即得到确认并且没有尝试更新.

好奇吧？

* * *

**挑战**

我想我确切地知道人们正在使用的 Flash 检测脚本中最有可能出现的错误是什么。不是虫子太多汁了。

现在，这并不意味着所有未能检测到版本 10 的站点都会遭受相同的错误。我只是认为我想到的那个很有可能。我可能应该把我的理论封在信封里的某个地方。同时，让我们看看 StackOverflow 社区提供了什么，以及我们总结的课程是什么。

我说这个bug真的很简单也很有趣。你说什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T00:57:45.017

My guess is the javascript is doing string comparison, and in string land, "10" < "9".

Also, Flash10 changed their security model somewhat (breaking a tool I use called SWFUpload) so it may be related to that (see: [http://benr75.com/articles/2008/11/25/swfupload-with-flash-10-fix](http://benr75.com/articles/2008/11/25/swfupload-with-flash-10-fix) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T21:29:04.660

我的猜测是从字符串中检测，类似于“Flash Player version XY”，方法是执行“get the character before '。” 并将其转换为数字。” 我自己也做过几次，这很愚蠢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-06T21:32:32.483

不幸的是，问题是由于**flash 附带**的版本检测不佳而引起的。没错，它实际上是由 Adob​​e Flash 创建的伪劣代码（不确定是哪个版本），这就是它如此普遍的原因。

我个人使用[swfObject](http://code.google.com/p/swfobject/)来嵌入 Flash。

# java - 列出当前 JAR 文件目录中的文件

> ID：346811
> 
> 赞同：14
> 
> 时间：2008-12-06T21:32:41.000
> 
> 标签：java, class, jar, loading

我正在用 JAVA 制作一个游戏，我想在我的 jar 中的某个目录中提供一个文件列表，这样我就可以确保有一个要在游戏中使用的类的列表。

例如说在我​​的罐子里我有一个目录

```
mtd/entity/creep/ 
```

**我想使用 jar 中另一个类的 java 代码**获取该目录中所有 .class 文件的列表。

这样做的最佳代码是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-06T21:56:04.293

旧的 java1.4 代码，但这会给你的想法：

```
private static List getClassesFromJARFile(String jar, String packageName) throws Error
{
    final List classes = new ArrayList();
    JarInputStream jarFile = null;
    try
    {
        jarFile = new JarInputStream(new FileInputStream(jar));
        JarEntry jarEntry;
        do 
        {       
            try
            {
                jarEntry = jarFile.getNextJarEntry();
            }
            catch(IOException ioe)
            {
                throw new CCException.Error("Unable to get next jar entry from jar file '"+jar+"'", ioe);
            }
            if (jarEntry != null) 
            {
                extractClassFromJar(jar, packageName, classes, jarEntry);
            }
        } while (jarEntry != null);
        closeJarFile(jarFile);
    }
    catch(IOException ioe)
    {
        throw new CCException.Error("Unable to get Jar input stream from '"+jar+"'", ioe);
    }
    finally
    {
        closeJarFile(jarFile);
    }
   return classes;
}
private static void extractClassFromJar(final String jar, final String packageName, final List classes, JarEntry jarEntry) throws Error
{
    String className = jarEntry.getName();
    if (className.endsWith(".class")) 
    {
        className = className.substring(0, className.length() - ".class".length());
        if (className.startsWith(packageName))
        {
            try
            {
                classes.add(Class.forName(className.replace('/', '.')));
            } catch (ClassNotFoundException cnfe)
            {
                throw new CCException.Error("unable to find class named " + className.replace('/', '.') + "' within jar '" + jar + "'", cnfe);
            }
        }
    }
}
private static void closeJarFile(final JarInputStream jarFile)
{
    if(jarFile != null) 
    { 
        try
        {
            jarFile.close(); 
        }
        catch(IOException ioe)
        {
            mockAction();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-26T13:03:43.307

在提出问题 10 年后，我提出了另一种完成这项工作的方法：

```
private static void listFilesFromDirectoryInsideAJar(String pathToJar,String directory,String extension) {
        try {
            JarFile jarFile = new JarFile(pathToJar);
            Enumeration<JarEntry> e = jarFile.entries();
            while (e.hasMoreElements()) {
                JarEntry candidat = e.nextElement();
                if (candidat.getName().startsWith(directory) && 
                    candidat.getName().endsWith(extension))
                    LOG.info(candidat.getName());
            }
        } catch (IOException e) {
            LOG.error(e.getMessage(),e);
        }
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T00:22:57.477

可能最好的方法是在编译时列出类。

有一种脆弱的运行时方法。带你`Class`（`MyClass.class`的`this.getClass()`）。打电话`getProtectionDomain`。打电话`getCodeSource`。打电话`getLocation`。打电话`openConnection`。（或者打开一个资源。）投射到`JarURLConnection`. 打电话`getJarFile`。打电话`entries`。遍历检查`getName`。我真的不推荐这种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T00:23:49.737

请记住，**JAR**文件只是重命名的**ZIP**文件，在 Java中读取**ZIP**文件的内容非常容易：

```
 File jarName = null;
    try
    {
        jarName = new File (Dir.class.getProtectionDomain().getCodeSource().getLocation().toURI());
    }
    catch (Exception e)
    {
        e.printStackTrace();    
    }

    try 
    {
      ZipFile zf=new ZipFile(jarName.getAbsoluteFile());
      Enumeration e=zf.entries();
      while (e.hasMoreElements()) 
      {
          ZipEntry ze=(ZipEntry)e.nextElement();
          System.out.println(ze.getName());
      }
      zf.close();
   } catch (IOException e) 
   {
      e.printStackTrace();
   } 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-06T21:59:08.093

这是不可能的，因为 Java 不提供对从中加载类的 jar 文件的直接访问。您可以尝试解析 java.class.path 系统属性以找到它，但这并非在所有情况下都有效。或者您可以限制 jar 文件必须驻留的位置，或者以不同的方式提供类列表（例如通过清单文件）。

# c++ - 如何检查 c++ api 的性能

> ID：346814
> 
> 赞同：2
> 
> 时间：2008-12-06T21:32:51.687
> 
> 标签：c++, performance, api

我的网络服务器在收到请求时有很多依赖关系来发回数据。我正在 Web 服务器中测试这些依赖项应用程序之一。应用程序与主 Web 服务器分离，只有查询以 api 公开的形式访问它。

我的问题是，如果我想在多线程环境中检查这些 api（带有 2 个四核处理器机器的 c++ 函数），那么最好的方法是什么？

我是否在单独的线程或进程中调用每个 api？如果是这样，我该如何实现这样的代码？据我所知，我将复制 Web 服务器的功能，但我找不到其他更好的方法来计算仅由该组件提供的性能改进。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T22:16:21.037

这取决于您的应用程序是否处理在并行进程中运行时共享的数据，因为这很可能会确定等待速度瓶颈的位置。

例如，如果应用程序访问数据库或磁盘文件，您可能必须模拟查询应用程序的多个线程/进程，以便查看它们如何相互相处，即它们在访问时是否必须相互等待共享资源。

但是，如果应用程序只进行一些内部计算，全部由它自己完成，那么它可以很好地扩展，只要它的所有数据都适合内存（即不是虚拟内存访问，例如磁盘访问，是必要的）。然后，您可以只测试一个实例的性能并专注于优化其速度。

说明您计划使用的操作系统也可能会有所帮助。Mac OS X 提供了 Windows 和 Linux 可能没有的性能测试和优化工具，反之亦然。

# python - 滴答功能图

> ID：346823
> 
> 赞同：2
> 
> 时间：2008-12-06T21:40:27.630
> 
> 标签：python, algorithm, math

我试图找出以下问题。我正在构建另一个数学函数绘图器，该函数是在其预定义的 x,y 范围内绘制的，这一切都很好。

现在我正在研究背景和 X、Y 轴的刻度（如果显示了任何轴）。

我制定了以下内容。我的固定宽度为 250 p 刻度间隙应在 12.5 和 50 p 之间。

刻度线应指示单位或半单位范围，我的意思如下。

x 范围 (-5, 5)：一个刻度 = 1

x 范围 (-1, 1)：一个刻度 = 0.5 或 0.1，具体取决于每个此选项将产生的差距。

x 范围 (0.1, 0.3): 0.05

给定一个 Xrange 你将如何获得完整或半单位范围之间的刻度数？

或者也许还有其他方法可以解决此类问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T05:17:48.580

做到这一点的一种方法是“标准化”最小值和最大值之间的差异，并对该值进行区分。在蟒蛇中：

```
delta = maximum - minimum
factor = 10**math.ceil(math.log(delta,10))  # smallest power of 10 greater than delta
normalised_delta = delta / factor           # 0.1 <= normalised_delta < 1
if normalised_delta/5 >= 0.1:
  step_size = 0.1
elif normalised_delta/5 >= 0.05:
  step_size = 0.05
elif normalised_delta/20 <= 0.01:
  step_size = 0.01
step_size = step_size * factor 
```

上面的代码假设您想要最大可能的差距。对于最小的情况，您将使用以下内容：

```
if normalised_delta/20 == 0.005:
  step_size = 0.005
elif normalised_delta/20 <= 0.01:
  step_size = 0.01
elif normalised_delta/5 >= 0.05:
  step_size = 0.05 
```

除了存在不止一个合适值的可能性之外，还有一些令人担忧的可能性是没有。以范围 [0,24] 为例，其中 12.5p 的间隙将给出 1.2 的步长，50p 的间隙将给出 4.8 的步长。两者之间没有“单位”或“半单位”。问题是 12.5p 和 50p 之一之间的差异是 4 倍，而 0.01 和 0.05 之间的差异是 5 倍。因此您必须稍微扩大允许间隙的范围并相应地调整代码.

澄清一些神奇的数字：除以 20 和 5 分别对应于具有最小和最大间隙大小的段数（即 250/12.5 和 250/50）。由于标准化的增量在 [0.1,1) 范围内，因此将其除以 20 和 5 分别得到 [0.005,0.05) 和 [0.02,0.2)。这些范围导致第一个范围的可能（标准化）步长为 0.005 和 0.01，第二个范围为 0.05 和 0.1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T22:08:20.070

使用 deltaX

如果 deltax 在 2 和 10 之间增加一半 如果 deltax 在 10 和 20 之间增加单位 如果小于 2 我们乘以 10 并再次测试如果大于 20 我们除然后我们使用 xmin 获得宽度上第一个单位或半增量的位置.

我仍然需要测试这个解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T07:55:15.567

您可能想看看[Jgraph](http://www.cs.utk.edu/~plank/plank/jgraph/jgraph.html)，它解决了一个补充问题：它是一个数据绘图器而不是一个函数绘图器。但是有很多共同点，例如处理主要和次要刻度线、轴标签等等。我觉得输入语言有点冗长，但 Jgraph 产生了非常好的技术图表。网站上有很多例子，可能还有一些你可以窃取的好主意。

你知道他们说什么：人才模仿，但天才偷窃 :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T13:33:36.803

这似乎符合我的预期。

导入数学

def main(): getTickGap(-1,1.5)

def next_multiple(x, y): 返回 math.ceil(x/y)*y

def getTickGap(xmin, xmax): xdelta = xmax -xmin width = 250 # 10 的最小幂大于 delta 因子 = 10**math.ceil(math.log(xdelta,10)) # 0.1 <= normalised_delta < 1 normalised_delta = xdelta / 因子打印（“normalised_delta”，normalised_delta）

```
# we want largest gap
if normalised_delta/4 >= 0.1:
  step_size = 0.1
elif normalised_delta/4 >= 0.05:
  step_size = 0.05
elif normalised_delta/20 <= 0.01:
  step_size = 0.01
step_size = step_size * factor

##    if normalised_delta/20 == 0.005:
##      step_size = 0.005
##    elif normalised_delta/20 <= 0.01:
##      step_size = 0.01
##    elif normalised_delta/4 >= 0.05:
##      step_size = 0.05
##    step_size = step_size * factor
print("step_size", step_size)
totalsteps = xdelta/step_size
print("Total steps", totalsteps)
print("Range [", xmin, ",", xmax, "]")

firstInc = next_multiple(xmin, step_size)
count = (250/xdelta)*(firstInc - xmin)
print("firstInc ", firstInc, 'tick at ', count)
print("start at ", firstInc - xmin, (width/totalsteps)*(firstInc - xmin))
inc = firstInc

while (inc <xmax):
    inc += step_size
    count += (width/totalsteps)
    print(" inc", inc, "tick at ", count) 
```

如果**名称**== “**主**”：主（）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-07T16:48:50.653

在范围 -1, 0

我明白了

```
normalised_delta 1.0
step_size 0.1
Total steps 10.0
Range [ -1 , 0 ]
firstInc  -1.0 tick at  0.0
start at  0.0 0.0
 inc -0.9 tick at  25.0
 inc -0.8 tick at  50.0
 inc -0.7 tick at  75.0
 inc -0.6 tick at  100.0
 inc -0.5 tick at  125.0
 inc -0.4 tick at  150.0
 inc -0.3 tick at  175.0
 inc -0.2 tick at  200.0
 inc -0.1 tick at  225.0
 inc -1.38777878078e-16 tick at  250.0
 inc 0.1 tick at  275.0 
```

倒数第二行怎么得到这个数字？？？

# php - 您对存储 AWS 身份验证数据有何建议？

> ID：346826
> 
> 赞同：4
> 
> 时间：2008-12-06T21:40:38.537
> 
> 标签：php, encryption, amazon-web-services, passwords

场景：用 PHP 编写的 Web 应用程序使用[Amazon Web 服务](http://aws.amazon.com/)，并且必须随身携带访问密钥 ID 和秘密访问密钥才能正常运行。是否有安全存储这些数据的最新建议和/或 API？

我的想法是根据本地服务器变量创建的密钥将其对称加密到文件中。这样一来，如果有人通过 FTP 获取文件的副本、丢失带有文件复制的笔记本电脑等，那将是 [希望] 胡言乱语。我担心的是，熟练的攻击者可以上传他们自己的脚本来解密它。

这似乎是一种[常见的情况](http://www.codinghorror.com/blog/archives/000953.html)，而且我从未获得过舒适的解决方案。显然我不能使用单向哈希，因为我需要原始数据来创建 HMAC 以发送到 AWS。非常欢迎提供相关 SO 问题的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T23:26:56.713

啊。安全问题。

我认为您应该在这里问的问题是您如何处理，例如您的 php 配置文件中的 mySQL 密码？

坦率地说，如果有人设法获得了您的文件副本，那么您的安全性无论如何都需要重新考虑。对于我自己的使用，我通常只将密码保存在一个地方，（在应该使用它们的服务器上）并确保我每次都使用随机生成的密码（将其粘贴到配置文件中，瞧！）

老实说，如果不是您自己的主机，任何敏感数据都可能受到损害。

如果它是您自己的主机，我建议在 Linux 和[PHPSuExec](http://alain.knaff.lu/howto/PhpSuexec/)中使用适当的权限，以确保只有您编写的脚本才能访问这些文件。

无论如何，要回答您最初的问题，您的 AWS 访问/密钥与 MySQL 密码相同，好吧，它有可能让某人访问您的服务，但它不会让他们访问您的个人详细信息。即使使用对称加密，如果您的脚本存在安全漏洞，也可以访问信息。

简而言之，当您将这些密钥放在除您以外的任何人都可以访问的任何地方时，您会承担风险。您对 Am​​azon 的服务器不会受到威胁的信任程度如何？

我的建议是尝试尽可能多地增加安全性，但请注意您的帐户，我通常会运行一个 cron 作业向我发送一封电子邮件，其中包含对我的 S3 帐户的更改（上传的新文件、新存储桶等等），从中我可以知道发生了什么。

没有简单的解决方案，它是保护系统每个单独层的组合。我的意思是，如果您使用对称加密，那么密码必须存储在某个地方，对吗？还是你要每次都输入？

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-17T01:15:02.063

> *我的想法是根据本地服务器变量创建的密钥将其对称加密到文件中。这样，如果有人通过 FTP 获取文件的副本，丢失带有复制文件的笔记本电脑等，这 [希望] 是胡言乱语。我担心的是，熟练的攻击者可以上传他们自己的脚本来解密它*。

这不会有什么坏处，但最终它只是通过默默无闻的安全性，因为可以读取文件的人可能也可以读取和反向工程您的代码。每次服务器启动时都没有输入密码或以其他方式提供秘密，加密将无济于事。它只是将问题转移到您将如何保护加密密钥（也需要服务器可以访问）？

您必须强化和设计您的应用程序和服务器（不要忘记操作系统，以及对操作系统的远程访问），以便未经授权的人首先无法读取系统上的文件。

如果您担心有人可以物理访问盒子，请专注于物理安全以阻止这种情况发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-24T03:25:00.157

我按照您的建议使用对称加密。当我启动我的服务器时，我需要给它一个密钥来解密包含身份验证数据的文件。

当然，黑客可以进行内存转储并以这种方式读取密码，但这比读取明文文件要困难得多。没有完美的解决方案，安全性始终是风险和易用性之间的折衷。

So server security is still the key issue, its just a question of how much security is enough. I'd suggest looking at [Bastille Linux](http://bastille-linux.sourceforge.net/) or something like that to harden your server but that's another topic altogether.

# iphone - 使用 Cocoa Touch 实现模式警报视图的最佳实践？

> ID：346834
> 
> 赞同：4
> 
> 时间：2008-12-06T21:44:52.677
> 
> 标签：iphone, cocoa-touch

是否有人对如何使用 Cocoa Touch 创建模态警报视图有任何最佳实践、提示和技巧或建议？

我喜欢认为有一种方法可以使这项艰巨的任务变得微不足道，或者至少更容易。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-07T16:47:51.713

你可以使用这样的东西：

```
void AlertWithMessage(NSString *message)
{
/* open an alert with an OK button */
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Name of the Application" 
                                message:message
                                delegate:nil 
                                cancelButtonTitle:@"OK" 
                                otherButtonTitles: nil];
[alert show];
[alert release];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T22:58:27.833

我只是使用 UIAlertView 来显示模式警报。您在寻找什么附加功能？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T14:40:24.670

查看来自 Apple 的 UICatalog 示例代码。它显示了手机上警报和表格的使用情况。

# c# - 为什么要使用 .NET 编译器的调试模式？

> ID：346837
> 
> 赞同：3
> 
> 时间：2008-12-06T21:46:04.687
> 
> 标签：c#, compiler-construction, nunit, debugging, release

我很好奇 .NET 编译器的 debug 和 release 模式之间的区别是什么，并且遇到了这些关于[debug 与 .NET](https://stackoverflow.com/questions/90871/debug-vs-release-in-net)中的 release以及[release 行为与 debug 不同的原因的](https://stackoverflow.com/questions/312312/what-are-some-reasons-a-release-build-would-run-differently-than-a-debug-build)问题。到目前为止，我还没有过多关注这些编译器模式。现在我会的。

我的问题是，假设我使用的是测试框架（NUnit）和 TDD，如果我总是在发布模式下编译会遇到任何问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-06T22:02:54.810

您正在使用 TDD。你写你的测试。测试失败。您编写代码以通过测试。代码失败。您查看您编写的代码，看不出它失败的任何明显原因。您是否要进行更多推理或在调试器中启动测试（使用 TestDriven.Net）并逐步完成测试？也许我只是不够聪明，无法总是弄清楚为什么我的代码不起作用，但当我被难住时，我通常会做后者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-07T09:23:25.620

调试模式关闭了很多优化。这意味着当您获得堆栈跟踪时，它看起来更像原始代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-07T09:37:32.973

调试和发布配置之间的一个非常显着的区别是，对标记为的方法的调用`ConditionalAttribute`只有在定义了关联的符号时才会被编译。`Debug`因此，如果您使用发布配置进行编译，则不会包含对类方法的调用。

这使您可以使用断言和将信息转储到控制台的代码来装饰您的代码，并且确信这些开销都不会出现在您的运输代码中。

此外，edit-and-continue 是一个非常有用的工具，它依赖于发布版本中省略的元信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T22:16:19.353

用于调试。

就像 tvanfosson 所说，即使您通常不使用调试器（我知道我不使用），有时您也需要。

# delphi - 可以从数据集外部进行数据集过滤吗？

> ID：346838
> 
> 赞同：-1
> 
> 时间：2008-12-06T21:47:22.827
> 
> 标签：delphi, dataset, filtering

我有两个 TDBLookupComboBox 控件，我想将它们连接到同一个数据集，但每个控件都显示不同的数据子集。如果我只需要一个框，我会在数据集上使用过滤，但我需要能够同时显示它们，而且我不知道有什么方法可以做到这一点。有谁知道它是否可以完成，如果可以，怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-06T22:29:29.687

如果您使用的是 TClientDataSet，您可以将游标 (TClientDataSet.CloneCursor) 克隆到另一个没有设置 ProviderName 属性的 TClientDataSet。两个 ClientDataSet 现在都指向内存中的相同数据，但可以有自己的过滤器。

# python - 没有模型的 Django.contrib.flatpages

> ID：346840
> 
> 赞同：6
> 
> 时间：2008-12-06T21:48:55.930
> 
> 标签：python, django, templates, django-flatpages

我有一些带有空`content`字段的平面页面及其模板内的内容（带有`template_name`字段）。

### 为什么我使用`django.contrib.flatpages`

*   它允许我以最少的 URL 配置服务（大部分）静态页面。
*   我不必为每个人编写视图。

### 为什么我不需要模型`FlatPage`

*   我将内容留空，只提供一个模板路径。因此，我可以利用文件中的源代码；
    *   我可以直接从文件系统编辑源代码，无需服务器（例如管理员）的帮助。
    *   我可以利用语法高亮和其他编辑器功能。
*   使用该模型，我必须维护平面页面的固定装置。
    *   因此，同一实体的数据位于两个不同的位置。
    *   如果我将内容移动到夹具内，则编辑将更加困难。
        *   即使夹具维护不是问题，我仍然需要在开发过程中一次又一次地转储和加载这些夹具。

### 我在找什么

基本上; `FlatPage`在保持`contrib.flatpages`功能的同时摆脱模型。我不清楚应该如何解决这个问题。如果有一种简洁的修改方式（如`add_to_class`）`FlatPages`以在数据库以外的地方获取信息，我更愿意这样做。也许可以将元数据插入到模板中，然后读取此数据的特殊管理器将替换`FlatPages`.

如果我不喜欢手动编辑而不是平面页面的管理功能，那么如何将数据库排除在外？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-06T22:08:59.773

使用[`direct_to_template`](https://docs.djangoproject.com/en/1.4/ref/generic-views/#django-views-generic-simple-direct-to-template)通用视图会简单得多。如果您不想为每个页面添加条目，则可以在一个视图中使用传入的参数来指定 urls.py 中的实际模板：

```
r'^foo/(?P<template_name>.+)/$','direct_to_template', {'template': 'foo_index.html'}), 
```

然后将模板导入您的`foo_index.html`：

```
{% include template_name %} 
```

# php - MySQL 查询需要 >15 秒才能运行；我能做些什么来缓存/改进它？

> ID：346842
> 
> 赞同：1
> 
> 时间：2008-12-06T21:49:40.250
> 
> 标签：php, mysql, caching

好吧，我有一个视频网站，其中一些表格是：

**标签**

```
id ~ int(11), auto-increment [PRIMARY KEY]
tag_name ~ varchar(255) 
```

**视频标签**

```
tag_id ~ int(11) [PRIMARY KEY]
video_id ~ int(11) [PRIMARY KEY] 
```

**视频**

```
id ~ int(11), auto-increment [PRIMARY KEY]
video_name ~ varchar(255) 
```

现在，tags 表有 >1000 行，videotags 表有 >32000 行。因此，当我运行查询以显示从最常见到最不常见的所有标签时，执行需要>15 秒。

我正在使用 PHP，我的代码（为简单起见而淡化）如下：

```
foreach ($database->query("SELECT tag_name,COUNT(tag_id) AS 'tag_count' FROM tags LEFT OUTER JOIN videotags ON tags.id=videotags.tag_id GROUP BY tags.id ORDER BY tag_count DESC") as $tags)
{
    echo $tags["tag_name"] . ', ';
} 
```

现在请记住，100% 准确对我来说并不像它那么快那么重要。因此，即使查询每天执行一次并且其结果用于当天剩余时间，我也不会在意。

我对 MySQL/PHP 缓存一无所知，所以请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T22:06:06.690

[MarkR](https://stackoverflow.com/questions/346842/mysql-query-takes-15-seconds-to-run-what-can-i-do-to-cacheimprove-it-php#346851)提到了该指数。确保你：

```
create index videotags_tag_id on videotags(tag_id); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-06T22:05:26.783

32,000 行仍然是一个小表——你的性能不可能那么差。

你能运行`EXPLAIN`你的查询吗 - 我猜你的索引在某个地方是错误的。

你在问题中说：

```
tag_id ~ int(11) [PRIMARY KEY]
video_id ~ int(11) [PRIMARY KEY] 
```

他们肯定是这个顺序吗？如果没有，那么它不会使用索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T21:55:42.700

我认为您最好的选择是创建某种汇总表，当事情发生变化时您可以维护该汇总表。

上面的查询需要扫描表中的所有行才能找到 group by 中的聚合 - 没有 WHERE CLAUSE。没有 where 子句的查询没有优化的希望，因为它必须检查每一行。

解决方法是创建一个汇总表，其中包含与该查询（或类似）结果相同的数据，当数据更改或显着更改时，您必须不时维护该表。

只有您可以根据应用程序和数据的性质来决定是否适合按计划、每次更新或某种组合来更新汇总表。

当您进行连接时，正确的索引仍然是有益的，但是您知道，对，并且已经这样做了？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-06T22:02:00.350

您使用的是 InnoDB 还是 MyISAM？在 MyISAM 中 COUNT 基本上是免费的，但在 InnoDB 中它必须对行进行物理计数。

# vb.net - VB.Net 中的队列数组

> ID：346854
> 
> 赞同：1
> 
> 时间：2008-12-06T21:56:34.230
> 
> 标签：vb.net, queue

可能是一个非常愚蠢的问题，但我想在 vb.net 中创建一个队列数组 - 所以我可以使用索引来引用每个队列：

例如

```
commandQueue(1).enqueue("itemtext")

commandQueue(2).enqueue("othertext") 
```

其中 commandQueue(1) 指的是与 commandQueue(2) 不同的队列

我一直纠结于试图定义一个对象数组并放入队列。

是的，我当然可以用老式的数组、指针等来做，手动管理，但这似乎更优雅......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T21:59:34.550

这个解决方案有什么问题？

```
Dim commandQueue As Queue(Of T)() 
```

这个解决方案没有什么“过时的”。然而，动态记忆有时可能更适合：

```
Dim commandQueue As New List(Of Queue(Of T))() 
```

在这两种情况下，您都需要在使用之前初始化每个队列！在数组的情况下，数组也必须被初始化：

```
' Either directly: '
Dim commandQueue(9) As Queue(Of T)
' or, arguably clearer because the array length is mentioned explicitly: '
Dim commandQueue As Queue(Of T)() = Nothing ' `= Nothing` prevents compiler warning '
Array.Resize(commandQueue, 10) 
```

# matlab - 提高使用 datenum 函数的循环的效率？

> ID：346855
> 
> 赞同：3
> 
> 时间：2008-12-06T21:58:21.370
> 
> 标签：matlab, octave

当 DJI 矩阵有 21000 行时，以下循环在 octave 中运行大约需要 700 秒，在 matlab 中运行大约需要 22 秒。我怎样才能提高这个效率？

```
对于 i=1：长度（DJI）
DJI2(i,1)=datenum(char(DJI(i,2)),'yyyy-mm-dd');
结尾

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-08T19:53:57.750

你记得预分配 DJI2 吗？

更重要的是，您根本不需要循环。 `datenum`对数组进行操作。试试这个：

```
DJI2=datenum(char(DJI(:,2)),'yyyy-mm-dd');

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-08T23:17:18.137

我用以下代码替换了循环，速度至少提高了一个数量级。

```
DJI2(:,1) = reshape(datenum(strvcat(DJI(:,2)(:)), length(DJI(:,2)),'yyyy-mm-dd'));

```

# c++ - 如何在 C++ 中搜索 std::string 中的子字符串？

> ID：346858
> 
> 赞同：7
> 
> 时间：2008-12-06T21:59:53.350
> 
> 标签：c++, string

我正在尝试在 C++ 中解析一个简单的字符串。我知道该字符串包含一些带有冒号的文本，后跟一个空格，然后是一个数字。我想只提取字符串的数字部分。我不能只对空格进行标记（使用 sstream 和 <<），因为冒号前面的文本中可能有也可能没有空格。

一些示例字符串可能是：

> 总磁盘空间：9852465
> 
> 可用磁盘空间：6243863
> 
> 部门：4095

我想使用标准库，但如果您有其他解决方案，您也可以发布，因为其他有相同问题的人可能希望看到不同的解决方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-06T22:05:32.633

```
std::string strInput = "Total disk space: 9852465";
std::string strNumber = "0";
size_t iIndex = strInput.rfind(": ");
if(iIndex != std::string::npos && strInput.length() >= 2)
{
  strNumber = strInput.substr(iIndex + 2, strInput.length() - iIndex - 2)
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-06T22:09:02.987

为了完整起见，这里有一个 C 语言的简单解决方案：

```
int value;
if(sscanf(mystring.c_str(), "%*[^:]:%d", &value) == 1)
    // parsing succeeded
else
    // parsing failed 
```

解释：`%*[^:]`说要读入尽可能多的不是冒号的字符，并且`*`禁止赋值。然后，在冒号和任何中间空格之后读入整数。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-06T22:09:05.530

> 我不能只对空格进行标记（使用 sstream 和 <<），因为冒号前面的文本中可能有也可能没有空格。

对，但你可以使用`std::getline`：

```
string not_number;
int number;
if (not (getline(cin, not_number, ':') and cin >> number)) {
    cerr << "No number found." << endl;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-06T23:29:50.623

类似于 Konrads 的答案，但使用`istream::ignore`：

```
int number;
std::streamsize max = std::numeric_limits<std::streamsize>::max();
if (!(std::cin.ignore(max, ':') >> number)) {
    std::cerr << "No number found." << std::endl;
} else {
    std::cout << "Number found: " << number << std::endl;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-07T02:54:21.867

我很惊讶没有人提到正则表达式。它们是作为 TR1 的一部分添加的，并且也包含在[Boost](http://www.boost.org/doc/libs/1_37_0/libs/regex/doc/html/index.html)中。这是使用正则表达式的解决方案

```
typedef std::tr1::match_results<std::string::const_iterator> Results;

std::tr1::regex re(":[[:space:]]+([[:digit:]]+)", std::tr1::regex::extended);
std::string     str("Sectors: 4095");
Results         res;

if (std::tr1::regex_search(str, res, re)) {
    std::cout << "Number found: " << res[1] << std::endl;
} else {
    std::cerr << "No number found." << std::endl;
} 
```

看起来需要做更多的工作，但恕我直言，你会从中得到更多。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-06T22:08:47.747

```
const std::string pattern(": ");
std::string s("Sectors: 4095");
size_t num_start = s.find(pattern) + pattern.size(); 
```

# asp.net - 如何调试访问 OAuth 安全 API 的 ASP.Net 应用程序？

> ID：346868
> 
> 赞同：5
> 
> 时间：2008-12-06T22:05:53.273
> 
> 标签：asp.net, debugging, authentication, oauth, callback

我知道必须有一个明显的解决方案来解决这个问题，但我很想念它，所以我非常感谢有人启发我，所以我不会转动我的轮子......

我正在编写一个 ASP.Net 应用程序，它将与服务 API（特别是 Evernote）进行交互。Evernote 需要 OAuth 以确保安全，在我实际与需要获取令牌的对象交互之前。

工作流程是这样的（像其他人一样向自己解释！）：

1.  使用我的开发 api 密钥和密钥以及其他一些 OAuth 内容构建一个 url，将其发送到 Evernote 以请求访问令牌。
2.  将 url 作为请求发送到 Evernote，并从响应中提取新的访问令牌
3.  使用访问令牌构建另一个 url 以请求用户的身份验证令牌。此 url 转到用户必须与之交互才能登录的页面（如果他们尚未登录），然后授权我的应用程序访问他们的帐户。我构建的 url 的最后一个参数是一个回调 url，它将从 Evernote 的服务器中调用。
4.  如果一切顺利，Evernote 将请求回调 url 并包含新的身份验证令牌作为参数。
5.  一旦我的服务器收到带有嵌入令牌的回调，我就可以使用它，以便我的应用程序可以与用户在后续请求中的注释进行交互。

问题是我在本地机器上编写这个应用程序，而不是公共域下的 ISP。所以我的回调是本地主机服务器。当然，localhost 是相对的，所以 Evernote 无法解析我的回调……我无法同时接收到身份验证令牌并进行调试。

必须有解决这个问题的方法，因为这种身份验证模型不是 Evernote 独有的（从长远来看……Flickr 使用它，就像许多其他服务一样）。那么有人可以告诉我如何设置，以便我可以获得身份验证令牌并仍然能够在我的本地机器上进行调试吗？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-07T12:34:09.263

OAuth 很难实现。这可能不是您要寻找的答案，但这就是我设法完成工作的方式：

1.  在我的本地开发机器上写一些代码。
2.  运行一个执行 msbuild 部署脚本并将应用程序部署到测试服务器的 bat 文件（或者挂钩 VS 中的构建后事件）。
3.  在测试服务器上运行应用程序。在获取请求令牌并请求授权后，它会重定向到 Evernote 网站。
4.  成功授权后，Evernote 网站重定向回我的测试服务器，并且授权的请求令牌被交换为访问令牌。
5.  我不是调试（我在测试服务器上没有 VS），而是检查应用程序的日志（我使用的日志记录就像写入文本文件一样简单）。
6.  冲洗并重复

出于测试目的，我注册了一个临时公共子域（例如 testing.oauth.mydomain.com），以便 Evernote 能够重定向到该 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-05T16:18:24.920

根据this（[我如何在本地针对OAuth进行开发？](https://stackoverflow.com/questions/670398/how-do-i-develop-against-oauth-locally)）回调是由浏览器发出的，所以它应该能够访问本地主机。

# asp.net - 用于保持某人登录的 ASP.Net 会话和 cookie

> ID：346883
> 
> 赞同：3
> 
> 时间：2008-12-06T22:13:27.813
> 
> 标签：asp.net, session, cookies

我有一个要接管的现有站点，现在它将当前登录用户的 id 存储在会话变量中（如果完全登录 - 否则我确定它是空字符串或null 什么的）。

客户现在希望，在某人登录后，无限期地“保持”他们在该计算机上的登录。

我相信 ASP.net 会话的最大空闲时间为 1 天。网站在Flash部分写得不是很好（整个前端都是flash），flash会处理登录，然后，只要flash没有重新加载，假设用户仍然“登录” .

我认为我的解决方案是还存储一个带有一些 GUID 值的客户端 cookie，并在数据库中保存相关的用户 ID……有点像一个永不过期的会话。因此，当页面加载时，我可以检查我的 cookie，使用它从数据库中选择用户 ID，如果我们找到一个，然后设置会话值表示用户 23 已登录。

有人认为这种观点有任何问题吗？你会推荐一些不同的东西吗？我真的不想重构一堆现有的代码，而只是把它放在上面......

PS——安全并不是真正的问题。他们让人们登录的唯一原因是我们可以跟踪一个人的订单，但没有钱通过这个网站转手。也没有用户可以查看或编辑的个人信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T22:25:33.360

我就是这样做的。我实际上有一个 cookie 保存他们的登录名和密码，这样我可以在他们没有登录时自动登录。我在几天不活动后使 cookie 过期。缺点是**每个人**都会忘记他们的密码，因为他们真正需要输入密码的唯一一次是他们从延长的休息时间回来时。

这适用于内部应用程序，具有与您相同的客户需求，并且有效……并使客户满意。

我们最终可能会做的一件事就是使用 Windows 身份验证，在这种情况下实际上可能会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T18:31:43.170

我就是这样做的，但它的问题（至少我认为这是一个问题）是当您将用户名和密码存储在 cookie 中时，添加 cookie 时没有任何加密。如果您在浏览器中查看 cookie，则用户名和密码会显示为 day。是否可以对您存储的 cookie 进行某种加密？或者你会如何处理这个？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T15:26:51.913

检查这个博客发布[http://timmaxey.net/archive/2009/03/06/asp.net-cookie-auto-log-in.aspx](http://timmaxey.net/archive/2009/03/06/asp.net-cookie-auto-log-in.aspx)基本上你需要用一个 guid 系列和一个令牌保存 cookie ，在我的情况下，令牌一直在变化，系列是基于某些东西生成的东西，比如 guid 和 id 组合或其他东西，然后 guid 总是与用户一起存储。有一个 cookie 表来存储这些信息等......非常安全，不是 100%，但非常好...... [Tim Maxey](http://www.timmaxey.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T15:34:46.060

我建议使用 Enterprise Library Crypto App Block 来存储一个加密的 cookie，它只不过是一个 GUID。获取 GUID，并使用数据库中的会话表来跟踪用户信息。

在会话开始事件中，获取用户信息并缓存它。

不建议将会话对象用于用户信息，因为它不适用于网络场，除非您使用数据库来获取会话状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-06T16:39:13.220

那时你基本上是在滚动你自己的会话状态，我对此很好。但是，我不会将用户名/密码存储在 cookie 中（即使已加密）。没有办法从服务器端过期。您始终可以删除表中的行以强制用户再次登录，但如果他们持有用户名/密码，他们就持有王国的钥匙。

# c# - .NET 中是否存在弱引用？

> ID：346885
> 
> 赞同：4
> 
> 时间：2008-12-06T22:13:49.437
> 
> 标签：c#, .net, garbage-collection, weak-references

我想在我的应用程序中保留某类对象的列表。但我仍然希望对象被垃圾收集。您可以在 .NET 中创建**弱引用吗？**

以供参考：

*   [垃圾收集对象在内部 Map 中跟踪自己的实例](https://stackoverflow.com/questions/346762)
*   [创建对对象的弱引用](https://stackoverflow.com/questions/258505)

来自 MSDN 的回答：

> 要与对象建立弱引用，请使用要跟踪的对象的实例创建 WeakReference。然后将 Target 属性设置为该对象并将该对象设置为 null。有关代码示例，请参阅类库中的 WeakReference。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-06T22:17:07.370

是的，有一个通用的弱引用类。

[MSDN > 弱参考](http://msdn.microsoft.com/en-us/library/xt0a1s34.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-06T22:17:35.420

> 您可以在 .NET 中创建弱引用吗？

是的：

```
WeakReference r = new WeakReference(obj); 
```

用途[`System.WeakReference`](http://msdn.microsoft.com/en-us/library/system.weakreference(VS.80).aspx).

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-06T22:18:20.067

是的...

这里有一个很好的例子：

[http://web.archive.org/web/20080212232542/http://www.robherbst.com/blog/2006/08/21/c-weakreference-example/](http://web.archive.org/web/20080212232542/http://www.robherbst.com/blog/2006/08/21/c-weakreference-example/)

在您的课程中，您创建了两个成员变量：

```
WeakReference _weakRef = null;

Person _strongRef = null; 
```

您创建了两个新`Person`对象（它们是我刚刚为本示例创建的简单对象，由一个`Name`属性和一些参考跟踪代码组成）。接下来，将成员变量设置为新创建的`Person`对象实例。

```
_strongRef = p;

_weakRef = new WeakReference(p1); 
```

您会注意到这里的区别`_strongRef`只是一个常规的普通引用，而`_weakRef`设置为一个`WeakReference`对象，其中 person 对象`(p1)`作为构造函数中的参数传入。

如果要进行垃圾收集，或者仅出于测试目的，您可以自己调用它：

```
GC.Collect(); 
```

那么成员变量`p1`持有的目标对象`_weakRef`应该被垃圾回收。您可以编写代码来检查：

```
if (_weakRef.IsAlive) 
```

如果`WeakReference`仍然存在，您可以`WeakReference`使用如下代码将其转换为强引用或普通引用：

```
Person p = _weakRef.Target as Person; 
```

现在该`p`引用被视为强引用，并且在不再使用之前不会被收集。如果您想在范围之后保留引用，您可以将其设置为成员变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-10T16:55:30.357

这是完整的（非线程安全的）实现示例`WeakReference`

```
ClassA objA = new ClassA();
WeakReference wr = new WeakReference(objA);
// do stuff 
GC.Collect();
ClassA objA2;
if (wr.IsAlive)
    objA2 = wr.Target as ClassA; 
else
    objA2 = new ClassA(); // create it directly if required 
```

`WeakReference`位于`System`名称空间中，因此无需为其包含任何特殊程序集。

# .net - 什么是 .Net 客户资料预览版？

> ID：346896
> 
> 赞同：2
> 
> 时间：2008-12-06T22:21:32.697
> 
> 标签：.net, .net-client-profile

我了解 .Net 客户端配置文件是什么，但“预览”是什么意思？（[http://www.microsoft.com/downloads/details.aspx?familyid=8CEA6CD1-15BC-4664-B27D-8CEBA808B28B&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=8CEA6CD1-15BC-4664-B27D-8CEBA808B28B&displaylang=en)）

这像一个测试版吗？与我的应用程序一起部署是否安全？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T22:40:04.530

我*认为*这是 MSDN 中的一个错误。它发生了。客户资料是“RTM”，所以不：这不是 AFAIK 的测试版。我会试着多看一点...

真的很有趣的问题，顺便说一句！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T23:02:38.293

看起来标题确实有误，因为它在该页面的下方显示 RTM。

然而，一个新版本的 3.5 SP1（称为 3.5 SP1 GDR）即将发布，以修复 SP1 中的回归问题。在大规模部署之前，您可能需要等待。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-06T22:40:32.207

据我了解，在 MS 用语中，BETA 和 PREVIEW 之间的区别在于，BETA 的功能集几乎是固定的，而 PREVIEW 虽然应该具有相似的质量，但仍可能会看到重大的功能变化。

# c# - 想要将 XElement 的全部内容作为字符串返回

> ID：346898
> 
> 赞同：3
> 
> 时间：2008-12-06T22:21:47.470
> 
> 标签：c#, xml, linq, xelement

我是 C# 中 LINQ 的新手，正在使用它来读取和处理 XML 文件。

我能够上下导航我的元素，但我想要的某些元素是将*整个*内容作为字符串返回。意思是，我有一个这样的元素：

```
<element1>
    <subel1> some text here </subel1>
</element1> 
```

当我获得 element1 的值时，我想将整个内容作为文本字符串取回，如下所示： `"<subel1> some text here </subel1>"`

那有意义吗？任何人都可以帮忙吗？

[（作为此处](https://stackoverflow.com/questions/3793/best-way-to-get-innerxml-of-an-xelement)的副本关闭）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-06T22:27:02.310

（编辑：回复后，我通过搜索[“XElement InnerXml”](http://www.google.com/search?q=xelement+innerxml)找到了一个完全相同的副本）

不过，`XmlDocument`这只是`.InnerXml`-不确定`XElement`。也许作弊？

```
 StringBuilder sb = new StringBuilder();
    foreach (var el in foo.Nodes()) sb.AppendLine(el.ToString());
    string s = sb.ToString(); 
```

# vb.net - ReadProcessMemory 不断返回 0

> ID：346913
> 
> 赞同：1
> 
> 时间：2008-12-06T22:35:26.617
> 
> 标签：vb.net, winapi, readprocessmemory

我目前正在开发一个小爱好项目，通过 VB.NET 在我的 G15 键盘上的游戏中显示健康信息。

当我通过 API 调用使用 ReadProcessMemory 时，它一直返回零。MSDN 文档让我使用 Marshal.GetLastWin32Error() 调用来找出问题所在，它返回 1400：INVALID WINDOW HANDLE。

我现在对函数的第一个参数是否需要窗口句柄或进程 ID 感到困惑。无论如何，我都尝试过使用 FindWindow 并在应用程序运行时对进程 ID 进行硬编码（从任务管理器中获取）。

我尝试了三种不同的游戏，Urban Terror、Grand Theft Auto: SA 和 windows 的 3D pinball，从一个名为 Cheat Engine 的应用程序中获取内存地址；他们似乎都失败了。

这是我用来执行此操作的代码：

API调用：

```
Private Declare Function ReadProcessMemory Lib "kernel32" ( _
ByVal hProcess As Integer, _
ByVal lpBaseAddress As Integer, _
ByRef lpBuffer As Single, _
ByVal nSize As Integer, _
ByRef lpNumberOfBytesWritten As Integer _
) As Integer 
```

方法：

```
Dim address As Integer
address = &HA90C62&
Dim valueinmemory As Integer

Dim proc As Process = Process.GetCurrentProcess
For Each proc In Process.GetProcesses
    If proc.MainWindowTitle = "3D Pinball for Windows - Space Cadet" Then
        If ReadProcessMemory(proc.Handle.ToInt32, address, valueinmemory, 4, 0) = 0 Then
            MsgBox("aww")
        Else
            MsgBox(CStr(valueinmemory))
        End If
    End If
Next

Dim lastError As Integer
lastError = Marshal.GetLastWin32Error()
MessageBox.Show(CStr(lastError)) 
```

有人可以向我解释为什么它不起作用吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T22:49:55.073

首先，您的方法签名是错误的， Single=Float 而原始参数是 LPBUF 类型。

使用此方法签名：

```
<DllImport("kernel32.dll", SetLastError=true)> _
Public Shared Function ReadProcessMemory( _
ByVal hProcess As IntPtr, _
ByVal lpBaseAddress As IntPtr, _
<Out()>ByVal lpBuffer() As Byte, _
ByVal dwSize as Integer, _
ByRef lpNumberOfBytesRead as Integer
) As Boolean
End Function 
```

其次，我相信 hProcess 句柄需要一个由 OpenProcess 函数打开的句柄，而不是窗口句柄。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-06T23:46:28.377

谢谢你，arul，我已经解决了我的问题。

```
Dim address As Integer
address = &HA90C62&
Dim floatvalueinmemory() As Byte

Dim proc As Process = Process.GetCurrentProcess
For Each proc In Process.GetProcesses
    If proc.MainWindowTitle = "3D Pinball for Windows - Space Cadet" Then
        Dim winhandle As IntPtr = OpenProcess(PROCESS_ACCESS.PROCESS_VM_READ, True, proc.Id)

        If ReadProcessMemory(winhandle, address, floatvalueinmemory, 4, 0) = 0 Then
            Dim lastError As Integer
            lastError = Marshal.GetLastWin32Error()
            MessageBox.Show(CStr(lastError))
            MsgBox("aww")
        Else
            MsgBox("woo")
        End If

        CloseHandle(winhandle)
    End If
Next 
```

现在它认为句柄有效并尝试读取进程内存，但我收到错误消息 299：ReadProcessMemory 或 WriteProcessMemory 请求的一部分已完成。

有没有人对我应该如何着手解决这个问题有任何想法？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-08T23:02:01.770

消息 299：只有部分 ReadProcessMemory 或 WriteProcessMemory 请求完成意味着我试图读取的内存受到保护。

感谢您的所有帮助，我将把 arul 的答案标记为答案。

# asp.net-mvc - 在 ASP.NET MVC 视图中获取完整服务器路径的首选方法是什么？

> ID：346914
> 
> 赞同：8
> 
> 时间：2008-12-06T22:35:29.143
> 
> 标签：asp.net-mvc

我是 ASP.NET MVC 的新手，我正在尝试在视图中工作时获取操作的完整 url。我需要这个作为回调提交给第三方 API。例如我需要的是

> [http://myserver.com/controller/action](http://myserver.com/controller/action)

当我使用

```
<%= Url.Action("action", "controller") %> 
```

我明白了

> /控制器/动作

我知道几种将服务器基路径添加到此的方法，但我想知道在 ASP.NET MVC 视图中执行此操作的首选方法是什么？

编辑：澄清一下，它不是当前视图/操作的 URL，而是同一控制器中另一个操作的 URL。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-07T13:21:53.393

为了捕捉协议（http / https）、不同端口和虚拟路径的变化（不能总是假设我们将在服务器根目录中），我最终得到了以下解决方案：

```
<%= Request.Url.GetLeftPart(System.UriPartial.Authority) + Url.Action("action", "controller")%> 
```

我正在努力将其移至扩展方法以使其更漂亮。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-06T22:42:23.200

编辑：对于任何视图/控制器组合，不确定你会发现比这更简单的东西。

```
http://<%=Request.Url.Host %><%=Url.Action("action", "controller")%> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-21T23:15:35.327

我写了一篇关于完整路径生成的博文，名为[How to build absolute action URLs using the UrlHelper class](http://blog.mariusschulz.com/Archive/2011/06/30/how-to-build-absolute-action-urls-using-the-urlhelper-class)。你肯定想检查一下！

* * *

这是我建议编写的扩展：

```
/// <summary>
/// Generates a fully qualified URL to an action method by using
/// the specified action name, controller name and route values.
/// </summary>
/// <param name="url">The URL helper.</param>
/// <param name="actionName">The name of the action method.</param>
/// <param name="controllerName">The name of the controller.</param>
/// <param name="routeValues">The route values.</param>
/// <returns>The absolute URL.</returns>
public static string AbsoluteAction(this UrlHelper url,
    string actionName, string controllerName, object routeValues = null)
{
    string scheme = url.RequestContext.HttpContext.Request.Url.Scheme;

    return url.Action(actionName, controllerName, routeValues, scheme);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-09T19:01:32.160

Request.Url 返回完整的 URL，包括协议 (http://)、url (www.mydomain.com/mypath) 和查询字符串 (?id=5)。

```
@Request.Url       @*Razor tags*@ 
```

对于经典的 ASP.NET MVC 标签，它将是

```
<%=Request.Url%>   <%'Classic tags%> 
```

# java - 在生产环境中运行 Apache Geronimo

> ID：346922
> 
> 赞同：11
> 
> 时间：2008-12-06T22:43:02.700
> 
> 标签：java, jakarta-ee, geronimo

如果您在生产环境中运行 Apache Geronimo，为什么选择它而不是其他应用程序服务器？您在生产环境中运行 Geronimo 的经验是什么？

您能否分享一下您决定使用的 servlet 引擎（Tomcat/Jetty）以及您做出此决定的原因？

***更新****：到目前为止，这个问题得到了两个赞成票和一个星，但没有答案。我开始怀疑，有人在使用 Apache Geronimo 吗？我的逻辑是，如果您使用 Geronimo 进行开发，那么您也会使用它进行部署。对？那么，这是否意味着根本没有人在使用 Geronimo？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-01-23T17:55:32.513

我们绝对在生产中使用 Geronimo！

我们从 1.0 开始就使用 Tomcat 版本，我记得大约是四年前。我们目前主要运行 2.1.1.4。

我们的一个应用程序每天获得大约 100 万次页面浏览量。其他的还差得很远，但它们是需要正常运行的重要应用程序。

我们的选择主要基于：

1.  价格：当我们公司开始使用 Java 时，我们不确定我们需要从应用服务器中得到什么。因此，我们决定从免费开始，并在需要时逐步提高。
2.  基本功能：我有使用 WebSphere（base/ND）和普通 Tomcat 的经验。Geronimo 拥有我们想要的 J2EE 特性，所有这些都在一个轻量级包中。
3.  开源：我们使用 Java 获取所需开源的主要客户。
4.  熟悉程度：作为基于 Apache 的服务器，我们已经熟悉 Tomcat、OpenJPA、Axis Web 服务等。此外，就错误跟踪和其他小事而言，我们对 Apache 社区感到满意。
5.  支持：我们希望大部分时间都靠自己，但知道 Apache 社区很活跃很重要。与 IBM 提供的商业支持一样，我们是 IBM 业务合作伙伴。

总的来说，我们的经验很棒。服务器非常可靠。我有时会搜索我们的日志，有时会看到与数据库连接、EJB 调用有关的奇怪错误，但这些非常罕见（很可能是我们的代码的错误）。

性能令人印象深刻。我开玩笑说我们可以从我的笔记本电脑上运行 Geronimo，而客户不会看到任何不同。给它任何像样的服务器，它会发出几个月的呼噜声。

我不确定有多少人实际运行 Geronimo。我对此感到很困惑。我看过幻灯片（几年前），上面列出了一些像 eBay 这样的大牌使用它。邮件列表处于活动状态，但有时似乎只有 Geronimo 团队相互交流。

我遇到的唯一严重错误是[这个](https://issues.apache.org/jira/browse/GERONIMO-5800)。这对我们来说意义重大，但 Geronimo 当然是免费的，我不希望他们修复对我来说很重要的错误。

我一直想检查 Apache TomEE 服务器，想知道它是否更积极或公开使用。只是看看社区和使用情况与 Geronimo 相比如何。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-21T13:34:57.010

WebSphere 社区版是 Geronimo。因此，IBM 选择了它作为首选平台。

在选择应用程序服务器时，您实际上是在选择要在应用程序中使用的 API，也许还有管理界面（但您只是偶尔使用一次）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T20:28:57.487

回答您的更新：这只是意味着 SO 用户没有使用 Geronimo 或者都在忙于投票和发表诙谐的评论。

**Geronimo 的[邮件列表](http://www.nabble.com/Apache-Geronimo---Users-f135.html)上似乎有相当多的活动，我会说在那里您会得到更好的结果。**

# javascript - Firefox 上的 JavaScript TinyMCE/jQuery 竞争条件

> ID：346926
> 
> 赞同：7
> 
> 时间：2008-12-06T22:44:24.100
> 
> 标签：javascript, jquery, firefox, tinymce

我有一个使用 TinyMCE 表单的网站；独立地，我使用 jQuery。当我从 Firefox 3（MacOS X、Linux）上的登台服务器加载表单时，TinyMCE 没有完成加载。Firefox 控制台出现错误，提示`t.getBody()`返回`null`. `t.getBody()`，据我从 TinyMCE 文档中了解到的，是一个返回文档正文元素以检查某些功能的函数。当我使用 Safari 时不会出现问题，当我使用 Firefox 和从 localhost 运行的同一站点时也不会出现问题。

原始的、失败的 JavaScript 相关代码如下所示：

```
<script type="text/javascript" src="http://static.alfa.foo.pl/json2.js"></script>
<script type="text/javascript" src="http://static.alfa.foo.pl/jquery.js"></script>
<script type="text/javascript" src="http://static.alfa.foo.pl/jquery.ui.js"></script>
<script type="text/javascript" src="http://static.alfa.foo.pl/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript">
  tinyMCE.init({ mode:"specific_textareas", editor_selector:"mce", theme:"simple", language:"pl" });
</script>
<script type="text/javascript" src="http://static.alfa.foo.pl/jquery.jeditable.js"></script>
<script type="text/javascript" src="http://static.alfa.foo.pl/jquery.tinymce.js"></script>
<script type="text/javascript" charset="utf-8" src="http://static.alfa.foo.pl/foo.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    /* jQuery initialization */ });
</script> 
```

我尝试更改脚本加载顺序，移动`tinyMCE.init() `call to the `<script/>` tag containing `$(document).ready()` call—before, after, and inside this call. No result. When `tinyMCE.init() `was called from within `$(document).ready()` handler, the browser did hang on request—looks like it was too late to call the init function.````

 ``Then, after googling a bit about using TinyMCE together with jQuery, I changed `tinyMCE.init()` call to:

```
tinyMCE.init({ mode:"none", theme:"simple", language:"pl" }); 
```

and added following jQuery call to the `$(document).ready()` handler:

```
$(".mce").each( function(i) { tinyMCE.execCommand("mceAddControl",true,this.id); }); 
````` 

``Still the same error. But, and here's where things start to look like real voodoo, when I added alert(i);` before the tinyMCE.execCommand()`调用，发出警报，并且 TinyMCE 文本区域已正确初始化。我认为这可能是由于等待用户解除警报而引入的延迟问题，因此我通过将仍在 $(document).ready() 处理程序中的调用更改为以下内容来引入一秒钟的延迟：

```
setTimeout('$(".mce").each(function(i) { tinyMCE.execCommand("mceAddControl",true,this.id); });',1000);

```

随着超时，TinyMCE textareas 正确初始化，但它是围绕真正问题的管道胶带。这个问题看起来像是一个明显的竞争条件（特别是当我考虑在同一个浏览器上，但当服务器在本地主机上时，问题不会发生）。但是 JavaScript 执行不是单线程的吗？任何人都可以告诉我这里发生了什么，实际问题在哪里，以及我能做些什么来真正解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-07T03:17:15.393

浏览器按照加载的顺序执行脚本，而不是编写。您的**即时**脚本 -`tinyMCE.init(...)`和`$(document.ready(...));`- 可以在文件完成加载之前执行。

因此，问题可能是网络延迟——尤其是使用 6 个单独的脚本（每个脚本需要浏览器和服务器之间的不同 HTTP 对话）。**因此，浏览器可能会在tiny_mce.js**完成解析并完全定义`tinyMCE.init()`之前尝试执行。**`tinyMCE`**

 **如果没有 Firebug，请[获取它](https://addons.mozilla.org/en-US/firefox/addon/1843)。;)
它有一个**Net**选项卡，可以显示加载所有脚本需要多长时间。

* * *

虽然您可能认为这`setTimeout`是管道胶带，但它实际上是一个不错的解决方案。我看到的唯一问题是它假设 1 秒将始终修复。快速连接，他们可以看到暂停。连接速度慢并且等待时间不够长 - 您仍然会收到错误消息。

或者，您也许可以使用`window.onload`——假设 jQuery 尚未使用它。（其他人可以验证吗？）

```
window.onload = function () {
    tinyMCE.init(...);

    $(document).ready(...);
}; 
```

* * *

另外，那是直接复制的吗？

```
<script type="text/javascript">
  $(document).ready(function(){
    /* jQuery initialization */ }
</script> 
```

它缺少`)`结尾`ready`：

```
<script type="text/javascript">
  $(document).ready(function(){
    /* jQuery initialization */ })
</script> 
```

缺少标点符号会造成很大的损害。解析器将继续阅读，直到找到它——弄乱中间的任何东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-19T14:41:31.460

由于这是当我问自己同样的问题时进入谷歌的第一页，这就是我发现的关于这个问题的信息。

[资源](http://wiki.moxiecode.com/index.php/TinyMCE:API/tinymce.Editor/onInit)

tinyMCE 中有一个回调函数，该函数在组件加载并准备就绪时触发。你可以像这样使用它：

```
tinyMCE.init({
   ...
   setup : function(ed) {
      ed.onInit.add(function(ed) {
          console.log('Editor is loaded: ' + ed.id);
      });
   }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-11T17:45:26.177

如果您正在使用`jquery.tinymce.js`，则不需要`tiny_mce.js`，因为 TinyMCE 将尝试使用 ajax 请求加载它。如果您发现`window.tinymce`（或简单地`tinymce`）是，`undefined`那么这意味着 ajax 尚未完成（这可能解释了为什么 using`setTimeout`对您有用）。这是典型的事件顺序：

1.  `jquery.js`使用脚本标签（或谷歌加载）加载。
2.  `jquery.tinymce.js`使用脚本标签加载 TinyMCE 的 jQuery 插件。
3.  文档就绪事件触发；这是您调用s 的`.tinymce(settings)`地方。`textarea`例如 `$('textarea').tinymce({ script_url: '/tiny_mce/tiny_mce.js' })`

4.  加载`tiny_mce.js`此步骤由 TinyMCE 的 jQuery 插件为您完成，但它可能在文档就绪事件触发后发生。

有时您可能真的需要访问`window.tinymce`，这是最安全的方法：

$(document).tinymce({ 'script_url': '/tiny_mce/tiny_mce.js' 'setup': function() { alert(tinymce); } });

TinyMCE 甚至会创建一个`tinymce.Editor`对象并执行设置回调。不会触发任何编辑器事件，并且为文档创建的编辑器对象不会添加到`tinymce.editors`.

我还发现 TinyMCE 的 ajax 调用干扰了我的`.ajaxStop`功能，所以我也使用了`setTimeout`：

$(document).tinymce({ 'script_url': '/tiny_mce/tiny_mce.js' 'setup': function() { setTimeout(function () { $(document).ajaxStart(function(e) {/* stuff */ }); $(document).ajaxStop(function(e) {/* stuff */}); }, 0); } });

# .net - F# winforms MenuStrip 问题：不确定如何获取 DropDownItems 的句柄

> ID：346928
> 
> 赞同：0
> 
> 时间：2008-12-06T22:45:47.843
> 
> 标签：.net, winforms, f#, menustrip

我最近开始学习 F#，这是我第一次使用 WinForms。这是我的代码。

```
#light
open System
open System.Windows.Forms
let form =
    let temp = new Form()
    let ms = new MenuStrip()
    let file = new ToolStripDropDownButton("File")
    ignore(ms.Items.Add(file))
    ignore(file.DropDownItems.Add("TestItem")) \\Code of importance
    let things _ _ = ignore(MessageBox.Show("Hai"))
    let handle = new EventHandler(things)
    ignore(file.Click.AddHandler(handle))
    let stuff _ _ = ignore(MessageBox.Show("Hai thar."))
    let handler = new EventHandler(stuff)
    let myButton = new Button(Text = "My button :>", Left = 8, Top = 100, Width = 80)
    myButton.Click.AddHandler(handler)
    let dc c = (c :> Control)
    temp.Controls.AddRange([| dc myButton; dc ms |]);
    temp
do Application.Run(form) 
```

问题是什么，我似乎无法弄清楚如何获得 DropDownItems 项目的句柄，以便我可以使用它。我确信这很简单，但我已经很久没有使用 F#了。谢谢你的帮助。

编辑：我还想指出，我知道那段代码中有很多难看的语法，但整个事情只是我一直在使用的一个测试表格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T23:18:07.527

我想你只需要

```
let ddi = file.DropDownItems.Add("TestItem") //Code of importance 
```

问题是您忽略了 Add() 调用的结果，该调用返回添加的项目。

另请注意，说起来更惯用

```
yadda |> ignore 
```

而不是

```
ignore(yadda) 
```

# c# - 查找我可以为 C# 中的数组分配多少内存

> ID：346929
> 
> 赞同：4
> 
> 时间：2008-12-06T22:45:51.307
> 
> 标签：c#, memory

我正在做一些需要初始化大数组的计算。数组的最大大小决定了我能解决的问题的最大大小。

有没有办法以编程方式确定有多少内存可用，比如可能的最大字节数组？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-06T22:48:35.963

好吧，依赖单个大数组有一系列相关的问题——内存碎片、连续块、最大对象大小的限制等。如果你需要大量数据，我建议创建一个模拟大数组的类使用许多较小（但仍然很大）的数组，每个数组都是固定大小的 - 即索引器除以找到合适的数组，然后使用 % 获取该数组内的偏移量。

您可能还想确保您使用的是具有大量内存的 64 位操作系统。这将为您提供最大的可用空间。

根据场景的不同，更复杂的算法（如稀疏数组、eta 向量等）可能有助于最大限度地发挥您的能力。你可能会惊讶于几年前人们在记忆有限的情况下能做的事情，只是一个磁带来回旋转......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T11:17:00.840

为了确保您有足够的可用内存，您可以使用[MemoryFailPoint](http://msdn.microsoft.com/en-us/library/system.runtime.memoryfailpoint.aspx)。如果无法分配内存，则会产生[InsufficientMemoryException](http://msdn.microsoft.com/en-us/library/system.insufficientmemoryexception.aspx)，您可以通过适当的方式捕获和处理。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-07T00:12:21.210

最简洁的答案是不”。有两个顶级资源需要查询

1.  进程可用的最大未分配虚拟地址空间块
2.  可用页面文件空间量。

正如 Marc Gravell 正确指出的那样，您将在 64 位平台上获得最大的成功。在这里，每个进程都有一个巨大的虚拟地址空间。这将有效地解决您的第一个问题。您还应该确保页面文件很大。

但是，有一种更好的方法，它只受磁盘上的可用空间限制：内存映射文件。您可以将大型映射（例如 512MB）创建到任意大的文件中，并在处理数据时移动它。请注意，请务必将其打开以进行独占访问。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-07T09:21:12.210

如果您需要非常非常大的数组，请不要使用 CLR。Mono 支持 64 位数组索引，让您可以充分利用内存资源。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-28T13:30:33.373

我想二进制搜索可能是一种方法。首先，首先分配 1 个字节，如果成功，则释放该字节（将对象设置为 null）并将其加倍为 2 个字节。继续下去，直到你不能再分配，并且你找到了一个你可以考虑为“下限”的限制。

可以分配的正确字节数（我们称之为**x**）在区间**lower** < **x** < 2 * **lower**内。使用二分搜索继续搜索此区间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-28T13:40:17.160

[在 64 位 .NET 程序中可以分配的最大数组是 2GB。](https://stackoverflow.com/questions/1214558/64-bit-vb-net-allocating-2gb-of-ram-net-bug) [（另一个参考。）](http://blogs.msdn.com/joshwil/archive/2005/08/10/450202.aspx)

您可以很容易地找出有多少可用字节：

```
 Using pc As New System.Diagnostics.PerformanceCounter("Memory", "Available Bytes")
  FreeBytes = pc.NextValue();
End Using 
```

鉴于这些信息，您应该能够做出决定。

# css - 并排的两个 HTML 表格，以页面为中心

> ID：346940
> 
> 赞同：28
> 
> 时间：2008-12-06T22:55:41.347
> 
> 标签：css, center, alignment

我在一个页面上有两个表格，我想并排显示，然后在页面中居中（实际上在另一个 div 中，但这是我能想到的最简单的方法）：

```
<style>
  #outer { text-align: center; }
  #inner { text-align: left; margin: 0 auto; }
  .t { float: left; }
  table { border: 1px solid black; }
  #clearit { clear: left; }
</style>

<div id="outer">
  <p>Two tables, side by side, centered together within the page.</p>

  <div id="inner">
    <div class="t">
      <table>
        <tr><th>a</th><th>b</th></tr>
        <tr><td>1</td><td>2</td></tr>
        <tr><td>4</td><td>9</td></tr>
        <tr><td>16</td><td>25</td></tr>
      </table>
    </div>

    <div class="t">
      <table>
        <tr><th>a</th><th>b</th><th>c</th></tr>
        <tr><td>1</td><td>2</td><td>2</td></tr>
        <tr><td>3</td><td>5</td><td>15</td></tr>
        <tr><td>8</td><td>13</td><td>104</td></tr>
      </table>
    </div>

  </div>
  <div id="clearit">all done.</div>
</div> 
```

我知道这与表格浮动的事实有关，但我不知道我缺少什么。有许多网页描述了我在这里展示的技术，但无论如何它都不起作用；桌子顽固地紧贴着左边的边缘。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-07T12:01:48.297

不幸的是，所有这些解决方案都依赖于指定固定宽度。由于表格是动态生成的（从数据库中提取的统计结果），因此无法预先知道宽度。

可以通过将两个表包装在另一个表中来实现所需的结果：

```
<table align="center"><tr><td>
//code for table on the left
</td><td>
//code for table on the right
</td></tr></table> 
```

结果是一对完美居中的表格，可以流畅地响应任意宽度和页面（重新）大小（并且可以将 align="center" 表格属性提升到具有自动边距的外部 div 中）。

我得出的结论是，有些布局只能通过表格来实现。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-12-06T23:28:17.150

如果是我 - 我会对桌子做这样的事情：

```
<style type="text/css" media="screen">
  table {
    border: 1px solid black;
    float: left;
    width: 148px;
  }

  #table_container {
    width: 300px;
    margin: 0 auto;
  }
</style>

<div id="table_container">
  <table>
    <tr>
      <th>a</th>
      <th>b</th>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <td>16</td>
      <td>25</td>
    </tr>
  </table>
  <table>
    <tr>
      <th>a</th>
      <th>b</th>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <td>16</td>
      <td>25</td>
    </tr>
  </table>
</div>
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-11-11T18:00:28.447

我意识到这是一个古老的问题，但无论如何。

以下将在兼容的浏览器和标准模式下的 IE8 中工作（即使用 doctype 集）。

```
#inner {text-align:center;}
.t {display:inline-block;} 
```

不幸的是，真的没有办法调整它以在 IE6 中工作。对于 IE7，将 zoom:1 添加到 .t div（通过条件注释）可能会有所帮助，但我目前没有可用于测试的 IE7。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-06T23:10:39.510

问题是你需要给出`#inner`一个集合`width`（除了`auto`or之外的任何东西`inherit`）。这个`margin: 0 auto;`技巧只有在内部元素比它的容器元素窄时才有效。如果没有给出`width`,`#inner`会自动扩展到 的全宽`#outer`，这会导致其内容向左对齐。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-06T23:10:02.410

给你的内部 div 一个宽度。

**例子**

更改您的 CSS：

```
<style>
#outer { text-align: center; }
#inner { text-align: left; margin: 0 auto; }
.t { float: left; }
table { border: 1px solid black; }
#clearit { clear: left; }
</style> 
```

对此：

```
<style>
#outer { text-align: center; }
#inner { text-align: left; margin: 0 auto; width:500px }
.t { float: left; }
table { border: 1px solid black; }
#clearit { clear: left; }
</style> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-06T23:02:55.670

在我的脑海中，您可能会尝试将“margin：0 auto”用于#outer 而不是#inner。

我经常向我的 DIV 添加背景颜色，以查看它们在视图上的布局。这可能是诊断这里发生的事情的好方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-06T23:35:36.837

```
<style>
#outer { text-align: center; }
#inner { width:500px; text-align: left; margin: 0 auto; }
.t { float: left; width:240px; border: 1px solid black;}
#clearit { clear: both; }
</style> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-06T23:07:08.737

问题是应该使表格居中的 DIV 没有定义宽度。默认情况下，DIV 是块元素并占据其父元素的整个宽度 - 在本例中是整个文档（通过#outer DIV 传播），因此自动边距样式无效。

要使这种技术起作用，您只需将具有 margin:auto 的 div 的宽度设置为除“auto”或“inherit”（固定像素值或百分比）之外的任何值。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-04-29T21:00:24.623

我发现我可以通过简单地将两张并排的桌子放在第三张居中的桌子内来解决这个问题。这是代码

我在两个现有表的顶部和底部添加了两行代码

```
<style>
  #outer {
    text-align: center;
  }

  #inner {
    text-align: left;
    margin: 0 auto;
  }

  .t {
    float: left;
  }

  table {
    border: 1px solid black;
  }

  #clearit {
    clear: left;
  }
</style>

<div id="outer">

  <p>Two tables, side by side, centered together within the page.</p>

  <div id="inner">
    <table style="margin-left: auto; margin-right: auto;">
      <td>
        <div class="t">
          <table>
            <tr>
              <th>a</th>
              <th>b</th>
            </tr>
            <tr>
              <td>1</td>
              <td>2</td>
            </tr>
            <tr>
              <td>4</td>
              <td>9</td>
            </tr>
            <tr>
              <td>16</td>
              <td>25</td>
            </tr>
          </table>
        </div>

        <div class="t">
          <table>
            <tr>
              <th>a</th>
              <th>b</th>
              <th>c</th>
            </tr>
            <tr>
              <td>1</td>
              <td>2</td>
              <td>2</td>
            </tr>
            <tr>
              <td>3</td>
              <td>5</td>
              <td>15</td>
            </tr>
            <tr>
              <td>8</td>
              <td>13</td>
              <td>104</td>
            </tr>
          </table>
        </div>
      </td>
    </table>
  </div>
  <div id="clearit">all done.</div>
</div>
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-04T10:09:47.837

我提供了两种解决方案。挑选最适合您的一款。

**解决方案#1：**

```
<html>
<style>
#container {
width: 50%;
margin: auto;
text-align: center;
}
#first {
width:48%;
float: left;
height: 200px;
background-color: blue;
}
#second {
width: 48%;
float: left;
height: 200px;
background-color: green;
}
#clear {
clear: both;
}
#space{
width: 4%;
float: left;
height: 200px;
}
table{
border: 1px solid black;
margin: 0 auto;
table-layout:fixed;
width:100%;
text-align:center;
}
</style>
<body>

<div id = "container" >
<div id="first">
    <table>
        <tr>
            <th>Column1</th>
            <th>Column2</th>
        </tr>
        <tr>
            <td>Value1</td>
            <td>Value2</td>
        </tr>
    </table>
</div>
<div id = "space" >
</div>
<div id = "second" >
<table>
    <tr>
        <th>Column1</th>
        <th>Column2</th>
    </tr>
    <tr>
        <td>Value1</td>
        <td>Value2</td>
    </tr>
</table>
</div>
<div id = "clear" ></div>
</div>

</body>
</html>
```

**解决方案#2：**

```
<html>
<style>
#container {
margin:0 auto;
text-align: center;
}
#first {
float: left;
}
#second {
float: left;
}
#clear {
clear: both;
}
#space{
width:20px;
height:20px;
float: left;
}
.table, .table th, .table td{
border: 1px solid black;
}
</style>
<body>

<table id = "container" >
<td>
<div id="first">
    <table class="table">
        <tr>
            <th>Column1</th>
            <th>Column2</th>
        </tr>
        <tr>
            <td>Value1</td>
            <td>Value2</td>
        </tr>
    </table>
</div>
<div id = "space" >
</div>
<div id = "second" >
<table class="table">
    <tr>
        <th>Column1</th>
        <th>Column2</th>
    </tr>
    <tr>
        <td>Value1</td>
        <td>Value2</td>
    </tr>
</table>
</div>
<div id = "clear" ></div>
</div>
</td>
</table>
</body>
</html>
```

注意：根据您在第一个解决方案中的需要更改宽度百分比。

# .net - 您如何确定您的 AD/AM 实例是否已通过 C# 启动并运行？

> ID：346954
> 
> 赞同：1
> 
> 时间：2008-12-06T23:09:37.450
> 
> 标签：.net, active-directory, adam

我看到了一个链接来了解 AD 是否正在运行，但我不太确定这是否同样适用于 AD/AM。一个警告是，假设我有权限，我应该能够检查任何 AD/AM 实例（任何域）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-08T01:59:08.420

同样的方法适用于 AD 或 AD LDS（轻量级目录服务，ADAM 的新名称）。.NET 示例位于[http://msdn.microsoft.com/en-us/library/x8wxt72e(VS.71).aspx](http://msdn.microsoft.com/en-us/library/x8wxt72e(VS.71).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:26:13.687

针对 AD/AM 和 AD 执行 LDAP 查询在功能上非常接近。您只需要在绑定字符串和端口中包含 DNS 前缀（如果它不是默认的 389）：

```
LDAP://ADAMServer:50000/DC=domain,DC=local 
```

一个主要的痛点是 AD/AM 中默认没有 RootDSE。您可以手动添加它，但默认情况下您不能使用那些使用 LDAP://Server/RootDSE 语法的便捷搜索过滤器。

ADAM 实例由端口号分隔，因此您需要根据所需的实例指定一个端口。您可以在服务器的 Windows 2008 注册表中找到它：

```
HKLM\SYSTEM\CurrentControlSet\Services\ADAM_InstanceName\Parameters 
```

或者您可以执行命令行查询：

```
c:\windows\adam\dsdbutil.exe "list instances" 
```

# c# - 无法将html格式往返剪贴板

> ID：346957
> 
> 赞同：2
> 
> 时间：2008-12-06T23:10:37.560
> 
> 标签：c#, .net, html, clipboard

我想编写 Html 格式，但我什至无法获得一个简单的 MSDN 示例来工作。

[http://msdn.microsoft.com/en-us/library/tbfb3z56.aspx](http://msdn.microsoft.com/en-us/library/tbfb3z56.aspx)

这个控制台应用程序，一个剪贴板往返程序，适用于任何人吗？

```
使用系统；
使用 System.Windows；//需要添加一个PresentationCore或者System.Windows.Forms引用

类程序{
    [STA线程]
    静态无效主要（字符串[] args）{
        Console.WriteLine("从浏览器中复制少量文本，然后回车。");
        Console.ReadLine();

        var text = Clipboard.GetText();
        Console.WriteLine();
        Console.WriteLine("--->剪贴板作为文本：");
        Console.WriteLine(文本);

        Console.WriteLine();
        Console.WriteLine("--->用相同的 CF_HTML 数据重写剪贴板。");
        //***这里是问题代码***
        var html = Clipboard.GetText(TextDataFormat.Html);
        剪贴板.清除（）；
        Clipboard.SetText(html, TextDataFormat.Html);

        var text2 = Clipboard.GetText();
        Console.WriteLine();
        Console.WriteLine("--->剪贴板作为文本：");
        Console.WriteLine(text2);

        var isSameText = ( text == text2 );
        Console.WriteLine();
        Console.WriteLine( isSameText ? "成功" : "失败" );

        Console.WriteLine();
        Console.WriteLine("按回车键退出。");
        Console.ReadLine();
    }
}

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-06T23:34:26.513

当您将数据从浏览器复制到剪贴板时，它会将相同的数据以多种格式（包括文本和 HTML）放到剪贴板上。因此，您可以以文本或 HTML 格式读取数据。但是，当您在此处调用 SetText 时，您仅传递 HTML 格式，因此当您使用常规 GetText 时，剪贴板上没有文本版本并且您返回 null。

您可以使用 IDataObject 一次将多种格式（即文本和 HTML）放入剪贴板，但在将数据放入剪贴板之前，您必须自己进行格式之间的转换。[这里](http://discuss.joelonsoftware.com/default.asp?dotnet.12.554495.4)有一个如何使用 IDataObject 的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-06T23:22:23.697

我可以重现它不起作用......每次的`var text2 = Clipboard.GetText();`回报......`""`

（编辑）快速搜索产生[this](http://blogs.msdn.com/jmstall/archive/2007/01/21/html-clipboard.aspx)，这似乎是主题。

# asp-classic - ASP 条件错误

> ID：346960
> 
> 赞同：0
> 
> 时间：2008-12-06T23:11:48.790
> 
> 标签：asp-classic

我正在尝试在这里使用 ASP 条件：

```
if (Request.Cookies("username")) and
(Request.Cookies("password")) <> ""
Then 
```

我不断收到这个错误：

> 类型不匹配：'[string: ""]'

任何想法我得到什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T23:17:04.830

尝试

```
if (Request.Cookies("username") <> "") and (Request.Cookies("password") <> "") Then 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-12-06T23:31:31.853

其实，我会做以下..

```
if (!string.IsNullOrEmpty(Request.Cookies("username")) &&
    !string.IsNullOrEmpty(Request.Cookies("password")))
{
    // Do your stuff, here :)
} 
```

养成使用`string.IsNullOrEmpty`测试变量和`string.Empty`设置值的习惯，如果你不希望字符串是`null`.

# wpf - 如何判断按钮单击事件是由WPF中的键盘还是鼠标触发的？

> ID：346973
> 
> 赞同：4
> 
> 时间：2008-12-06T23:26:09.803
> 
> 标签：wpf, events, button

除了在 Mouse/Key Up/Down 事件处理程序中设置多个标志之外，是否有一种简单的方法来判断是什么触发了 Button 的 Click 事件？我目前只对将鼠标与其他所有东西区分开来感兴趣，但如果可能的话，处理手写笔和其他输入类型会很好。我必须创建自己的按钮控件来实现这一点吗？

编辑：澄清我为什么关心：在这种特殊情况下，我试图为一种图片查看器实现“下一个”和“上一个”按钮。有问题的图片可能有不同的大小，按钮的位置会改变（所以它们总是在图片下方居中）。如果您需要滚动几张图片，用鼠标跟随这些按钮是很烦人的，所以我想保持鼠标位置相对于点击的按钮不变，但前提是它是用鼠标点击的，而不是键盘点击。

Edit2：按钮是在顶部还是在底部都没有关系，因为中心无论如何都可以改变。这里的“图片查看器”只是一个抽象，在这种特殊情况下，图片的左上角保持其位置对我来说很重要，但详细说明超出了问题的范围。在这种应用程序中缩放图片也不是那么简单，所以我确实想知道我在讨论 UI 实现时提出的问题的答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-09T15:33:31.537

```
if (InputManager.Current.MostRecentInputDevice is KeyboardDevice) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T03:21:37.163

相反，您应该专门处理 MouseXXX、StylusXXx 和 KeyboardXXX 事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T03:39:19.730

你能详细说明你为什么会关心吗？

多年来我自己编写了许多自定义控件，我不记得有一个例子是我关心点击事件是如何触发的。（除了 VB6 之前的控件生命周期故障，它以不同的顺序触发了获得焦点单击丢失焦点，具体取决于您是单击按钮、使用加速键还是按 ENTER 作为默认值）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T18:15:32.897

当人们将按钮放在 Windows 窗体和网页的底部时，我个人觉得很烦人。阅读一些关于 UI 的文献，你会发现如果大多数人在页面/表单上找不到有趣的东西，他们甚至不会走得那么远。我希望能够在我知道内容对我不感兴趣后立即单击下一步，因此请保持导航按钮在顶部突出。

我会将 prev/next 放在图片顶部，您可以在其中控制它们的位置。围绕这些按钮跳舞违背了大多数关于 UI 一致性的观点。进一步为鼠标用户和键盘用户创造不同的体验也违背了当前关于良好 UI 设计的大多数智慧。

另一种方法是选择图片可以在 UI 上获得的恒定最大尺寸，如果它超过该比例以适应，否则允许它在一帧内自由更改。如果您绝对必须将它们放在底部，这会使您的按钮保持在同一位置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-09T15:39:46.563

您可以使用不同的设备创建一个枚举，并在每次使用鼠标/键盘/等时设置一个全局属性。已启动，需要时只需参考即可。

# php - 我应该如何为 CodeIgniter 选择认证库？

> ID：346980
> 
> 赞同：397
> 
> 时间：2008-12-06T23:31:03.710
> 
> 标签：php, codeigniter, authentication

我看有[几个](http://codeigniter.com/wiki/Category:Libraries::Authentication/)。哪些维护且易于使用？他们的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：466
> 
> 时间：2009-01-24T23:49:13.303

## 更新（2010 年 5 月 14 日）：

**事实证明，俄罗斯开发人员 Ilya Konyukhov 在阅读本文后拿起了挑战，并根据以下建议和要求为基于 DX Auth 的 CI 创建了一个新的身份验证库。**

**由此产生的[Tank Auth](http://konyukhov.com/soft/tank_auth/)看起来像是 OP 问题的答案。我将在这里冒险并称 Tank Auth 为当今可用的 CodeIgniter 的最佳身份验证库。这是一个坚如磐石的库，具有您需要的所有功能，并且没有您不需要的臃肿：**

## 坦克认证

> 优点
> 
> *   全功能
> *   考虑到功能集的精益足迹（20 个文件）
> *   非常好的文档
> *   简洁优雅的数据库设计（仅 4 个 DB 表）
> *   大多数功能都是可选的并且易于配置
> *   语言文件支持
> *   支持 reCAPTCHA
> *   与 CI 的验证系统挂钩
> *   激活电子邮件
> *   使用电子邮件、用户名或两者登录（可配置）
> *   未激活帐户自动过期
> *   简单而有效的错误处理
> *   使用 phpass 进行散列（也散列数据库中的自动登录代码）
> *   不使用安全问题
> *   用户和配置文件数据的分离非常好
> *   围绕失败登录尝试的非常合理的安全模型（对机器人和 DoS 攻击的良好保护）
> 
> （次要）缺点
> 
> *   丢失的密码代码不会在 DB 中散列
> *   包括一个本地（差）验证码，这对于那些不想依赖（谷歌拥有的）reCAPTCHA 服务的人来说很好，但它确实不够安全
> *   非常稀少的在线文档（这里的小问题，因为代码记录良好且直观）

[在此处下载 Tank Auth](http://konyukhov.com/soft/tank_auth/)

* * *

原答案：

我也实现了自己的（目前大约 80% 经过几周的工作完成）。我先尝试了所有其他方法；FreakAuth Light、DX Auth、Redux、SimpleLogin、SimpleLoginSecure、pc_user、Fresh Powered 等等。它们都达不到标准，IMO，要么缺乏基本功能，要么天生不安全，要么太臃肿，不符合我的口味。

实际上，当我测试 CodeIgniter 的所有身份验证库时（就在新年之后），我对它们进行了详细的汇总。FWIW，我将与您分享：

## DX 认证

> 优点
> 
> *   功能很全
> *   中等占用空间（超过 25 个文件），但感觉很苗条
> *   优秀的文档，虽然有些是英文略显蹩脚的
> *   语言文件支持
> *   支持 reCAPTCHA
> *   与 CI 的验证系统挂钩
> *   激活电子邮件
> *   未激活帐户自动过期
> *   建议 grc.com 使用盐（对于 PRNG 来说还不错）
> *   禁止使用存储的“原因”字符串
> *   简单而有效的错误处理
> 
> 缺点
> 
> *   只允许用户“重置”丢失的密码（而不是让他们在重新激活时选择一个新密码）
> *   Homebrew 伪事件模型 - 善意，但未达标
> *   用户表中有两个密码字段，样式不好
> *   使用两个单独的用户表（一个用于“临时”用户 - 模棱两可且冗余）
> *   使用可能不安全的 md5 散列
> *   失败的登录尝试仅由 IP 存储，而不是由用户名存储 - 不安全！
> *   自动登录密钥未在数据库中散列 - 实际上与以明文形式存储密码一样不安全！
> *   角色系统一团糟：is_admin 函数带有硬编码的角色名称，is_role 一团糟，check_uri_permissions 是一团糟，整个权限表是个坏主意（URI 可以更改并使页面不受保护；权限应始终准确存储敏感逻辑在哪里）。破坏者！
> *   包括本地（差）验证码
> *   reCAPTCHA 功能界面凌乱

## FreakAuth 灯

> 优点
> 
> *   功能很全
> *   大部分是有据可查的代码
> *   用户和配置文件数据的分离是一个很好的接触
> *   与 CI 的验证系统挂钩
> *   激活电子邮件
> *   语言文件支持
> *   积极开发
> 
> 缺点
> 
> *   感觉有点臃肿（50+ 文件）
> *   然而它缺乏自动cookie登录（！）
> *   不支持同时使用用户名和电子邮件登录
> *   似乎有 UTF-8 字符的问题
> *   需要大量自动加载（阻碍性能）
> *   糟糕的微管理配置文件
> *   可怕的视图-控制器分离，视图中有大量程序逻辑，输出硬编码到控制器中。破坏者！
> *   包含的视图中的 HTML 代码不佳
> *   包括不合格的验证码
> *   评论调试回声无处不在
> *   强制使用特定的文件夹结构
> *   强制一个特定的 Ajax 库（可以切换，但首先不应该在那里）
> *   登录尝试没有最大限制 - 非常不安全！破坏者！
> *   劫持表单验证
> *   使用可能不安全的 md5 散列

## pc_user

> 优点
> 
> *   占地面积小，功能强大
> *   轻巧，不臃肿（3个文件）
> *   优雅的自动cookie登录
> *   带有可选的测试实现（很好的接触）
> 
> 缺点
> 
> *   使用旧的 CI 数据库语法（不太安全）
> *   不与 CI 的验证系统挂钩
> *   有点不直观的状态（角色）系统（索引颠倒 - 不切实际）
> *   使用可能不安全的 sha1 散列

## 新鲜动力

> 优点
> 
> *   占用空间小（6 个文件）
> 
> 缺点
> 
> *   缺少很多基本功能。破坏者！
> *   一切都是硬编码的。破坏者！

## Redux / 离子认证

根据[CodeIgniter wiki](http://codeigniter.com/wiki/Redux_Auth)，Redux 已经停产，但 Ion Auth 分支正在变得强大：[https ://github.com/benedmunds/CodeIgniter-Ion-Auth](https://github.com/benedmunds/CodeIgniter-Ion-Auth)

Ion Auth 是一个功能齐全的库，不会过于繁重或不够先进。在大多数情况下，它的功能集将不仅仅满足项目的要求。

> 优点
> 
> *   轻量级且易于与 CodeIgniter 集成
> *   支持直接从图书馆发送电子邮件
> *   有据可查的在线和良好的活跃开发/用户社区
> *   易于实施到项目中
> 
> 缺点
> 
> *   比其他一些更复杂的数据库模式
> *   文档在某些领域缺乏细节

## SimpleLoginSecure

> 优点
> 
> *   占地面积小（4 个文件）
> *   极简主义，绝对不臃肿
> *   使用 phpass 进行散列（优秀）
> 
> 缺点
> 
> *   仅登录、注销、创建和删除
> *   缺少很多基本功能。破坏者！
> *   比图书馆更多的起点

* * *

**不要误会我**的意思：我并不是要不尊重上述任何图书馆；我对他们的开发人员所取得的成就以及他们每个人所取得的成就印象深刻，而且我并没有放弃重用他们的一些代码来构建我自己的代码。我的意思是，有时在这些项目中，重点从基本的“必备”（例如硬安全实践）转移到更软的“必备”，这就是我希望解决的问题.

因此：回归基础。

## CodeIgniter 的身份验证*正确完成*

这是我的身份验证库中所需的最小功能列表。它也恰好是我自己图书馆功能列表的一个子集；）

> 1.  具有可选测试实施的小尺寸
> 2.  完整的文档
> 3.  无需自动加载。即时加载库以提高性能
> 4.  语言文件支持；没有硬编码的字符串
> 5.  支持 reCAPTCHA 但可选
> 6.  推荐的 TRUE 随机盐生成（例如使用 random.org 或 random.irb.hr）
> 7.  支持 3rd 方登录的可选附加组件（OpenID、Facebook Connect、Google 帐户等）
> 8.  使用用户名或电子邮件登录
> 9.  分离用户和个人资料数据
> 10.  用于激活和丢失密码的电子邮件
> 11.  自动cookie登录功能
> 12.  用于散列的可配置 phpass（当然要适当加盐！）
> 13.  密码散列
> 14.  自动登录代码的散列
> 15.  散列丢失的密码代码
> 16.  与 CI 的验证系统挂钩
> 17.  没有安全问题！
> 18.  强制的强密码策略服务器端，带有可选的客户端 (Javascript) 验证器
> 19.  使用针对字典和 DoS 攻击的**最佳实践对策**强制登录尝试失败的最大次数！
> 20.  所有数据库访问都是通过准备好的（绑定的）语句完成的！

注意：最后几点*并不是*您的 Web 应用程序不需要的超高安全性矫枉过正。**如果身份验证库不能 100% 满足这些安全标准，请不要使用它！**

最近备受瞩目的不负责任的程序员将他们排除在软件之外的例子：#17 是 Sarah Palin 的 AOL 电子邮件在总统竞选期间被黑客入侵的原因；最近，当布兰妮斯皮尔斯、巴拉克奥巴马、福克斯新闻和其他人的推特账户被黑客入侵时，#18 和 #19 的令人讨厌的组合是罪魁祸首；仅 #20 就是中国黑客如何在 2008 年的一次自动黑客攻击中成功地从 70,000 多个韩国网站窃取了 900 万条个人信息。

这些攻击不是脑部手术。如果你让你的后门敞开着，你不应该通过栓上前门来欺骗自己，从而产生一种虚假的安全感。此外，如果您对编码足够认真，可以选择像 CodeIgniter 这样的最佳实践框架，那么您应该至少正确完成*最基本*的安全措施。

* * *

<咆哮>

基本上，它是这样的：*我不在乎*一个 auth 库是否提供了一堆功能、高级角色管理、PHP4 兼容性、漂亮的 CAPTCHA 字体、国家表、完整的管理面板、花里胡哨——如果这个库真的让由于不遵循最佳实践，我的网站**的安全性降低。**这是一个*认证*包；它需要正确地做一件事：身份验证。如果它没有做到*这一点*，它实际上弊大于利。

</rant>

/延斯·罗兰

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2010-07-09T13:42:16.050

请注意，Jens Roland 的“综合列表”不包括用户角色。如果您有兴趣分配不同的用户角色（如 admin/user 或 admin/editor/user），这些库允许：

*   Ion_Auth（重写 Redux）
*   还原
*   后端专业版

Tank_Auth（Jens 列表中的第一名）没有用户角色。我意识到这不完全是身份验证的一部分，但因为

*   身份验证和角色管理都在页面加载时处理
*   两者都涉及安全
*   相同的表/模型可用于两者。
*   两者都可以设置为在控制器构造函数中加载（甚至自动加载）

如果您需要，拥有一个库来处理两者是很有意义的。因此，我从 Tank_Auth 切换到 Ion_Auth。

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2010-03-10T20:09:35.233

离子认证！看起来很有前途，而且占地面积小！我喜欢..

[http://github.com/benedmunds/CodeIgniter-Ion-Auth](http://github.com/benedmunds/CodeIgniter-Ion-Auth)

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2009-01-28T15:46:54.327

我是 Redux Auth 的开发人员，您提到的一些问题已在版本 2 beta 中得到修复。您也可以使用示例应用程序从官方网站下载此内容。

> *   需要自动加载（阻碍性能）
> *   使用“安全问题”的固有不安全概念。破坏者！

现在不使用安全问题，并且已经建立了一个更简单的忘记密码系统。

> *   返回类型有点像真、假、错误和成功代码的大杂烩

这在版本 2 中已修复并返回布尔值。我和你一样讨厌大杂烩。

> *   不与 CI 的验证系统挂钩

示例应用程序使用 CI 的验证系统。

> *   不允许用户重新发送“丢失的密码”代码

工作正在进行中

我还实现了一些其他功能，例如电子邮件视图，这使您可以选择在电子邮件中使用 CodeIgniter 助手。

它仍在进行中，所以如果有更多建议，请继续提出。

-爆米花

Ps：感谢推荐 Redux。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-10-30T20:08:46.907

我遇到过 Flexi Auth ( [http://haseydesign.com/flexi-auth/](http://haseydesign.com/flexi-auth/) )。它看起来很有前途，我已经开始使用它了。它具有奇妙的功能。与 CI 完全集成，并带有两个不同的库文件，其中一个非常重载所有功能，另一个仅包含验证。

最好的方法之一是新注册的会员可以在给定的时间内在网站上获得临时访问权限，直到他们点击电子邮件中的链接并激活。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-12-10T09:54:56.163

也许您会发现[Redux](http://codeigniter.com/forums/viewthread/90254/)适合您的需求。这并不过分，而且仅包含我们大多数人需要的基本功能。开发人员和贡献者对贡献的代码非常严格。

这是[官方页面](http://code.google.com/p/reduxauth/)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2010-10-27T08:25:38.357

Ion_Auth 击败 tank_auth 主要有两个原因，用户角色和文档，tank_auth 缺少这两个。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-12-10T18:08:31.020

我使用自定义版本的[DX Auth](http://codeigniter.com/forums/viewthread/98465/P0/)。我发现它使用简单，非常容易修改，并且它有一个与 Code Igniter 非常相似的[用户指南（带有很好的示例） 。](http://dexcell.shinsengumiteam.com/dx_auth/)

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-13T02:53:36.020

也看看[BackendPro](http://www.kaydoo.co.uk/projects/backendpro)

最终，您可能最终会编写一些自定义的东西，但是从 DX Auth、Freak Auth、BackendPro 等借用概念并没有错。

我对打包应用程序的体验是它们特定于某些结构，并且我在将它们集成到我自己的应用程序中而不需要破解时遇到了问题，然后如果预包有更新，我必须将它们迁移进去。

我还在我的 CI 代码中使用 Smarty 和 ADOdb，所以无论如何我最终都会对代码进行重大更改。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-11-21T04:23:33.900

Tank Auth 看起来不错，但文档只是如何安装的一页说明，以及每个 PHP 文件的快速运行。至少这就是我在大量谷歌搜索后发现的全部。当人们说 Tank Auth 有据可查时，也许上面的意思是代码有很好的注释。这是一件好事，但与文档不同。如果有一些关于如何将 Tank Auth 的功能与现有代码集成的文档，那就太好了。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2011-02-26T16:13:47.070

我正在尝试 Ion_Auth 并感谢它，顺便说一句......

**SimpleLoginSecure** 使身份验证简单而安全。

# language-agnostic - 什么会更有成效？将 VAX PASCAL 转换为 GNU PASCAL 或将其移植到 perl 或其他语言

> ID：346986
> 
> 赞同：2
> 
> 时间：2008-12-06T23:33:32.520
> 
> 标签：language-agnostic, pascal, vax, do178-b

我有这个遗留代码库**(Compaq PERL)**，大约 1500 行代码，我需要移植到 Windows。我想使用**gnu PASCAL**（我已经安装并且可以使用）。我已经将我们的汇编程序**（HP 64000 8051）**从 VAX 上移到了**Windows（KEIL 8051）**上。

软件工程总监希望所有产品都脱离 VAX。这是问题所在，我尝试使用**gpc**从 CYGWIN 上的 VAX编译**PASCAL**。似乎需要做很多事情才能从一个 PASCAL 到另一个获得（IO 和算法）等效性。

 **我非常了解 PERL、FORTRAN、C 和 C++（还有 JAVA，但我宁愿不）。我的问题归结为 1500 行代码，将 PASCAL 代码移植到另一个 PASCAL 会更有效率，还是将其移植到另一种语言会更有效率？VAX PASCAL 是我在大学时的第一语言，但我已经有 8 年没有主动使用它进行编程了。我经常和专业地使用 PERL、C、C++ 和 FORTRAN。

我会说，就我的选择而言，如果我要转换成另一种语言，那就是 PERL。

代码所做的是对 INTEL hex 和 TEX HEX 图像文件执行填充和校验和。我知道 Srec 1.4 程序可以工作，但这不是一个选择，因为我必须让我的代码符合 DO-178B 的要求（而且我的公司对使用开源代码持谨慎态度）（他们对 open 没有问题源工具；只是代码）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-06T23:48:33.427

我会尝试将其移植到[Free Pascal](http://www.freepascal.org/)，但有时间限制。如果它太难了，那么回退到最近使用的（你）的语言。

有什么方法可以测试新（移植或翻译）版本的行为是否与旧版本相同？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-07T00:57:15.940

我认为将 1500 行代码移植到任何语言/平台应该不会太难，因为您需要做的就是“执行填充”和计算校验和。就我个人而言，我更喜欢 C# - 它对我的心灵有一种舒缓的效果 :) 但鉴于您对 C/C++ 的熟练程度，我建议您使用 C++，原因很简单，因为 C++ 是世界上最好的汇编语言，并且会满足您的要求完美。我认为 pascal 是一些过时的和新项目应该避免的东西。如果我错了，请随时纠正我。

用 C 编程是一件苦差事，为程序的进一步增强留出一些空间 C++ 似乎是最好的选择。也不要忘记与 C 不同的是，C++ 有一些非常强大的库支持它（STL、Boost 等）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T00:57:35.597

我会首先考虑长期可维护性（包括您以外的其他人）。例如，如果您是唯一知道 PASCAL 的人，并且您不想成为该程序维护和支持的唯一所有者，那么 PASCAL 可能不如拥有更广泛开发人员基础的语言那样好在你的店里。

如果这不是一个决策问题（例如，多个开发人员都同样熟悉相同的语言范围），那么我会估计 gnu PASCAL 端口的时间到例如 Perl 端口的时间，并使用将花费更少的目标语言使用时间。

如果这也不是一个决策问题（即同等水平的努力），那么我会考虑运行时经济性（更高的速度，更小的内存占用）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-07T08:00:41.950

鉴于它只有 1500 行代码，而且虽然 Pascal 有许多优点，但 I/O 不是其中之一，我会将整个东西移植到 C 中，将其分解为模块并在此过程中编写一些单元测试。移植到新的 Pascal 有一个很大的“未知因素”，即不同方言的兼容性如何。如果你将它移植到 C 中，你会在第一天结束时知道这项工作需要多长时间，一旦你完成了它，你就会彻底搞定它，因为 C 会比我们所有人都长寿。我同意 Joel Neely 的观点；总是很容易找到另一个 C 程序员来维护它。

因为程序很小，而且主要是 I/O 和整数操作，所以我在这里看不到 C++ 的作用。不值得额外的复杂性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-02T12:05:50.250

我总是尽量用公司主要使用的语言编写程序。

如果公司里有 6 名程序员坐在那里做 C++，那么求助于脚本语言（因为它是一个更容易的片段）是没有意义的，这增加了下一次招聘的语言要求。

我个人讨厌 Perl，因为它的语法有点加密。此外，它不是一种“企业”语言，尤其是在这里，而且在 Unix 系统管理员角落之外，很难找到真正精通它的人 (*)

请注意，这只是从我目前的观点来看的一篇文章，主要是在一家小商店里的一个程序员，那里有大的商业客户，他们把他们的做法强加给我们。YMMV。

(*) webdevel 在这里主要做 ASP.NET。

# java - 如何检查远程图像是否符合特定规范

> ID：346995
> 
> 赞同：0
> 
> 时间：2008-12-06T23:40:39.930
> 
> 标签：java, jsp

我在 JSP/Java 中进行一些编码（没有任何框架或其他奇怪的东西），我被困在试图找到一种方法来检查远程图像（通过 URL）是否符合一些规范，比如一些定义的高度和宽度。

有没有办法在 JSP/Java 中做到这一点？在 PHP 中这很容易，但我在这里找不到方法......

谢谢你的时间。最好的祝福。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-07T00:06:45.963

最简单的方法可能是使用[ImageIO](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html)类来创建 BufferedImage，尽管它不是标准库中的唯一机制。

```
public static void main(String[] args) throws IOException {
    URL imageUrl = new URL("http://www.google.com/intl/en_ALL/images/logo.gif");
    BufferedImage image = ImageIO.read(imageUrl);
    System.out.println("Width="+image.getWidth());
    System.out.println("Height="+image.getHeight());
} 
```************