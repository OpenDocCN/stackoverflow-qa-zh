# StackOverflow 问答 10237000-10237999

# opengl - glAccum 和顶点缓冲区对象（VBO）的运动模糊等效？

> ID：10237002
> 
> 赞同：0
> 
> 时间：2012-04-19T21:23:54.190
> 
> 标签：opengl, vbo

`glAccum(GL_MULT, decayFactor)`我想知道帧缓冲区对象（FBO）的等价物是什么。是否存在等价物，还是我需要自己实现一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:32:23.997

是的，“等效”是“用着色器实现它”；）这并不难。

# file-upload - 自动将标签添加到共享点中上传的文档

> ID：10237004
> 
> 赞同：1
> 
> 时间：2012-04-19T21:24:04.420
> 
> 标签：file-upload, sharepoint-2010, tags, web-parts, document-library

我的环境是 sharepoint 2010 和 vs 2010。

我已经有一个正在使用的 OOTB 文档库，我想知道如何将标签或关键字添加到 METADATA 列。

我在所有子站点中使用相同的文档库，因此想用当前站点的名称标记上传的文档（即，如果它在子站点中使用，则该子站点的名称将是标记）。

我是否需要构建自定义文档库或某种附加到现有文档库的附加 Web 部件？

如果您可以提供一些代码示例，如果有的话，将不胜感激。

谢谢，

KS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-29T20:59:42.707

如果您从头开始，您可以基于内置内容类型 Document（Document 的子内容类型）创建自定义内容类型。将自定义字段添加到您的内容类型。有关创建内容类型的更多信息，请参见此处：http: [//msdn.microsoft.com/en-us/library/gg295290.aspx](http://msdn.microsoft.com/en-us/library/gg295290.aspx)

内容类型也可以有一个自定义事件接收器，用于 ItemAdding、ItemUpdated 等。查看下面的 xml：

```
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
  <ContentType ID="0x010100xxxxxx"
Name="MyContentType"
Group="My custom group" Version="0" Inherits="True" Overwrite="TRUE" >
    <FieldRefs>
     <FieldRef ID="{AC8A823D-EB2F-4D4D-8BF0-14CACA509539}" Name="myMetadataField" Required="FALSE" />
    </FieldRefs>
    <XmlDocuments>
      <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/events">
        <spe:Receivers xmlns:spe="http://schemas.microsoft.com/sharepoint/events">
          <Receiver>
            <SequenceNumber>1010</SequenceNumber>
            <Name>HandoverOffshore_ItemAddedReceiver</Name>
            <Type>ItemAdded</Type>
            <Assembly>MyAssembly, Version=1.0.0.0, Culture=neutral, PublicKeyToken=79315a88caec227a</Assembly>
            <Class>MyAssembly.CustomEventReceivers</Class>
          </Receiver>
        </spe:Receivers>
      </XmlDocument>
    </XmlDocuments>
  </ContentType>
</Elements> 
```

然后你必须创建事件接收器类来处理自定义事件：

```
public class HandoverOffshoreEventReceivers : SPItemEventReceiver
{
        public override void ItemAdded(SPItemEventProperties properties)
        {
// your code for updating metadata field here...
        }
} 
```

然后将其部署到您的网站集，并将此内容类型添加到您的所有库中。还将其设置为所有库中的默认内容类型。

如果您要创建许多库，则应考虑基于此内容类型创建自定义库定义。

如果您希望为现有文档触发此自定义事件，则必须将其内容类型更改为您在此处创建的新内容。

请注意，文档库内容类型是网站集内容类型的子内容类型。

# javascript - 通过字段 JQuery/JS 压缩 Json 对象

> ID：10237011
> 
> 赞同：0
> 
> 时间：2012-04-19T21:24:31.467
> 
> 标签：javascript, jquery, html, json

我有以下 JSON：

```
[{"state":"MN","value":10},{"state":"MN","value":10},{"state":"MN","value":10},{"state":"NY","value":8},{"state":"NY","value":8},{"state":"NY","value":8}] 
```

是否有 JQuery/JS 或任何其他 HTML 兼容语言中的命令允许我将上述 JSON 转换为以下内容：

```
[{"state":"MN","value":[10,10,10]},{"state":"NY","value":[8,8,8]}] 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:37:17.893

下面的循环将为您提供所需的输出，

[**演示**](http://jsfiddle.net/skram/gJp88/1/)

```
var data = [{"state":"MN","value":10},{"state":"MN","value":10},{"state":"MN","value":10},{"state":"NY","value":8},{"state":"NY","value":8},{"state":"NY","value":8}];

var tmp = {};
var t;
$.each (data, function (i, val) {
   if (tmp.hasOwnProperty(val.state)) {
      t = tmp[val.state];
      t.push(val.value);
   } else {
      tmp[val.state] = [val.value];
   }   
});

var output = [];
for (i in tmp) {
    output.push({'state': i, 'value': tmp[i]});   
} 
```

**证明：**

![在此处输入图像描述](../Images/38c86a3797d0b73b4ac541cb2ab04f15.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T21:38:50.750

您可以使用：

```
var input=[{"state":"MN","value":10},{"state":"MN","value":10},{"state":"MN","value":10},{"state":"NY","value":8},{"state":"NY","value":8},{"state":"NY","value":8}]

var tmp={}, output=[];
while(o=input.pop()) (tmp[o.state] || (tmp[o.state]=[])).push(o.value); //you could even stop here if it is enough for you
for(k in tmp) output.push({state:k,value:tmp[k]}); 
```

# forms - Chrome 扩展 - 填写表格后打开多个标签

> ID：10237018
> 
> 赞同：1
> 
> 时间：2012-04-19T21:24:45.187
> 
> 标签：forms, google-chrome, tabs, google-chrome-extension

我正在尝试创建 chrome 扩展 - 当用户单击图标时，会出现带有表单的弹出窗口。表单中的 textarea 可以包含更多涉及 URL 的参数。填写并单击 GO 按钮后，需要打开多个带有此参数的 URL 的选项卡。

例子：`popup.html`

```
<form name="myform">`
<textarea id="params" name="params" style="width: 170px;height: 270px;"></textarea>`
<input id="edit" checked="checked" type="radio" name="edit" value="1" /> option 1 <input id="edit" type="radio" name="edit" value="2" /> option 2`
<div id="clicked">GO</div>`
</form>` 
```

然后在`popup.js`我有：

```
function click(e) {
    chrome.tabs.executeScript(null, {
        code: "alert('starting');"
    });

    opener();
}

document.addEventListener('DOMContentLoaded', function () {
    var divs = document.getElementById("red");

    divs.addEventListener('click', click);

}); 
```

因此，当用户单击 GO 按钮时，需要启动 opener() 函数。

这是开启器功能 - 它仅确定 textarea 和单选按钮的值，并打开与 textarea 中的 manz 参数一样多的新选项卡。

```
function opener() {
    alert('working');
    var parameter = document.myform.getElementById("params").value;
    for (index = 0; index < document.myform.edit.length; index++) {
        if (document.myform.edit[index].checked) {
            var radioValue = document.myform.edit[index].value;
            break;
        }

        var Result = parameter.split("\n");

        if (radioValue == 1) {
            for (i = 0; i < Result.length; i++) {
                window.open('http://mypage.com?param=' + Result[i]);
            }
        }
    }
} 
```

所以 Result 是由 \n 分割的 textarea 的值，而单选值是所选单选按钮的值。

这很好用 - 单击浏览器图标后会弹出带有表单的弹出窗口，但是当我填写 textarea 并选择第一个单选按钮时，然后单击 GO，开启功能不起作用...

唯一有效的是带有工作单词的弹出警报，然后是从 click(e) 函数开始的警报。

所以开启器功能启动，写入警报，但没有别的......不会打开任何选项卡，没有任何反应......

有人能帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T13:47:46.977

我发现在扩展中使用 chrome.tabs.create 函数比 window.open 函数效果更好。

```
chrome.tabs.create({url:"https://www.facebook.com/PSChrome"}); 
```

# ruby-on-rails - 什么更好？模型或助手中的范围搜索？

> ID：10237019
> 
> 赞同：0
> 
> 时间：2012-04-19T21:24:47.727
> 
> 标签：ruby-on-rails

最终出现在视图中的范围搜索的最佳实践是什么（即 current_company_name）？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:29:17.023

我认为在助手中，因为`current_company_name`与当前应用程序状态有关，而不是与数据有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:30:48.493

没有，您应该使用装饰器或演示器。

有用的 Railscast[在这里](http://railscasts.com/episodes/286-draper)。

# c++ - 使用 shared_ptr 进行条件构造？

> ID：10237020
> 
> 赞同：0
> 
> 时间：2012-04-19T21:24:50.467
> 
> 标签：c++, constructor, shared-ptr

我有：

```
Command *command;

if(commandType == "Start")
{
  command = new StartCommand();
}
else if (commandType == "Stop")
{
  command = new StopCommand();
} 
```

现在假设我想`command`成为一个shared_ptr，我如何翻译上面的代码来使用一个shared_ptr？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T21:38:00.433

跳过显而易见的，如果你想正确地初始化你的变量，例如如果它是`const`，你可以这样做

```
std::shared_ptr<Command> factoryCommand(std::string const& commandType) {
  if(commandType == "Start")
    return std::make_shared<StartCommand>();
  if(commandType == "Stop")
    return std::make_shared<StopCommand>();
  return std::shared_ptr<Command>(nullptr);
}

std::shared_ptr<Command> const command {factoryCommand(commandType)}; 
```

* * *

如评论中所示，您还可以违反 C++ 的 RAII 指南并单独定义和初始化。不过，我仍然更喜欢使用`std::shared_ptr<Command>::operator=`over `std::shared_ptr<Command>::reset`，因为它更直观，不会诱使你`new`做一些你永远不会做的事情`delete`。

因此，`"Start"`例如，对于分支，这将如下所示：

```
std::shared_ptr<Command> command;
//...
// I would flag this in the review process as "you're doing it wrong"
command.reset(new StartCommand());
// This is what you should do if you *have* to separate definition and initialisation:
command = std::make_shared<StartCommand>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T05:11:24.280

一些非常简单的更改将完成这项工作：

```
shared_ptr<Command> command;

if(commandType == "Start")
{
  command = make_shared<StartCommand>();
}
else if (commandType == "Stop")
{
  command = make_shared<StopCommand>();
} 
```

# linux - Linux 中 mmap 物理内存的用户空间中的 memcpy 性能不佳

> ID：10237021
> 
> 赞同：9
> 
> 时间：2012-04-19T21:24:58.580
> 
> 标签：linux, memory, mmap

在我的计算机上安装的 192GB RAM 中，Linux 内核在启动时保留了 4GB 以上的 188GB RAM（硬件地址为 0x100000000）（mem=4G memmap=188G$4G）。数据采集​​内核模块使用 DMA 将数据累积到这个用作环形缓冲区的大区域中。用户空间应用程序将这个环形缓冲区映射到用户空间，然后从当前位置的环形缓冲区复制块，以便在它们准备好后进行处理。

使用 memcpy 从 mmap'ed 区域复制这些 16MB 块并没有像我预期的那样执行。似乎性能取决于启动时保留的内存大小（以及后来映射到用户空间）。 [http://www.wurmsdobler.org/files/resmem.zip](http://www.wurmsdobler.org/files/resmem.zip)包含实现 mmap 文件操作的内核模块的源代码：

```
module_param(resmem_hwaddr, ulong, S_IRUSR);
module_param(resmem_length, ulong, S_IRUSR);
//...
static int resmem_mmap(struct file *filp, struct vm_area_struct *vma) {
remap_pfn_range(vma, vma->vm_start,
    resmem_hwaddr >> PAGE_SHIFT,
    resmem_length, vma->vm_page_prot);
return 0;
} 
```

和一个测试应用程序，它本质上是（删除了检查）：

```
#define BLOCKSIZE ((size_t)16*1024*1024)
int resMemFd = ::open(RESMEM_DEV, O_RDWR | O_SYNC);
unsigned long resMemLength = 0;
::ioctl(resMemFd, RESMEM_IOC_LENGTH, &resMemLength);
void* resMemBase = ::mmap(0, resMemLength, PROT_READ | PROT_WRITE, MAP_SHARED, resMemFd, 4096);
char* source = ((char*)resMemBase) + RESMEM_HEADER_SIZE;    
char* destination = new char[BLOCKSIZE];
struct timeval start, end;
gettimeofday(&start, NULL);
memcpy(destination, source, BLOCKSIZE);
gettimeofday(&end, NULL);
float time = (end.tv_sec - start.tv_sec)*1000.0f + (end.tv_usec - start.tv_usec)/1000.0f;
    std::cout << "memcpy from mmap'ed to malloc'ed: " << time << "ms (" << BLOCKSIZE/1000.0f/time << "MB/s)" << std::endl; 
```

我已经在 SuperMicro 1026GT-TF-FM109 上的 Ubuntu 10.04.4、Linux 2.6.32 和不同大小的预留 RAM (resmem_length) 上对 16MB 数据块进行了 memcpy 测试：

```
|      |         1GB           |          4GB           |         16GB           |        64GB            |        128GB            |         188GB
|run 1 | 9.274ms (1809.06MB/s) | 11.503ms (1458.51MB/s) | 11.333ms (1480.39MB/s) |  9.326ms (1798.97MB/s) | 213.892ms (  78.43MB/s) | 206.476ms (  81.25MB/s)
|run 2 | 4.255ms (3942.94MB/s) |  4.249ms (3948.51MB/s) |  4.257ms (3941.09MB/s) |  4.298ms (3903.49MB/s) | 208.269ms (  80.55MB/s) | 200.627ms (  83.62MB/s) 
```

我的观察是：

1.  从第一次运行到第二次运行，从 mmap'ed 到 malloc'ed 的 memcpy 似乎受益于内容可能已经缓存在某处。

2.  从 >64GB 开始，性能会显着下降，这在使用 memcpy 时都可以注意到。

我想了解为什么会这样。也许 Linux 内核开发人员小组中的某个人认为：64GB 对任何人都应该足够了（这是否敲响了警钟？）

亲切的问候，彼得

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-24T14:48:17.667

根据 SuperMicro 的反馈，性能下降是由于 NUMA，非统一内存访问。SuperMicro 1026GT-TF-FM109 使用 X8DTG-DF 主板，其核心是一个 Intel 5520 Tylersburg 芯片组，连接到两个 Intel Xeon E5620 CPU，每个 CPU 都有 96GB RAM。

如果我将我的应用程序锁定到 CPU0，我可以观察到不同的 memcpy 速度，具体取决于保留的内存区域并因此映射。如果保留的内存区域不在 CPU 上，那么 mmap 会挣扎一段时间来完成它的工作，并且任何后续往返“远程”区域的 memcpy 都会消耗更多时间（数据块大小 = 16MB）：

```
resmem=64G$4G   (inside CPU0 realm):   3949MB/s  
resmem=64G$96G  (outside CPU0 realm):    82MB/s  
resmem=64G$128G (outside CPU0 realm):  3948MB/s
resmem=92G$4G   (inside CPU0 realm):   3966MB/s            
resmem=92G$100G (outside CPU0 realm):    57MB/s 
```

这几乎是有道理的。只有第三种情况，64G$128，也就是说最上面的64GB也有不错的效果。这在某种程度上与理论相矛盾。

问候，彼得

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:35:26.010

Your CPU probably doesn't have enough cache to deal with it efficiently. Either use lower memory, or get a CPU with a bigger cache.

# javascript - extjs“iframe 架构”的缺点（我应该重构为 MVC 模式吗？）

> ID：10237023
> 
> 赞同：1
> 
> 时间：2012-04-19T21:25:02.330
> 
> 标签：javascript, iframe, architecture, extjs, extjs4

我有一个使用“iframe 架构”使用 ExtJS 构建的现有 Intranet webapp（仅内部），即它在索引页面上有一个顶部菜单和一个选项卡面板，以及大约 30 个其他单独的网页，它们在主选项卡面板内作为 iframe“选项卡”打开.

使用 iframe 没有任何特别的原因，所有内容都在同一个域中，并且大多数其他单独的页面都是使用 ExtJS 库编写的，几乎完全用 javascript 编写。几乎所有的 html 都由空的 HTML、HEAD 和 BODY 标签组成。

我真的很想使用 ExtJS MVC 架构来重构它并放弃 iframe，但是因为“一切正常”，我不能证明花时间来做这件事是合理的。

我有但无法测试的一个想法是：这些单独的页面中的每一个都有它自己的`Ext.onReady`事件和视口等，这个 web 应用程序必须为它打开的每个 iframe-tab 加载完整的 ExtJS 框架，严重放大客户端资源使用。谁能确认这种类型的架构可以用 ExtJS 框架做到这一点？

是否有任何其他非常充分的理由应该重构？

或者，重构为 MVC 架构只会让我更轻松地维护代码而不会提升性能？（目前一切都按预期工作）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:48:51.327

不幸的是，我没有与您方便的项目类似的项目，因此我无法自己进行测试，但这是我的 2c ... :)

1.  我确实认为每个页面都会启动自己的 ExtJs 框架副本，但我认为它只会影响 CPU 和内存使用。网络流量应该不会有太大差异，因为核心 ExtJs 文件将被缓存。

2.  我建议在运行此应用程序时检查网络流量，因为您将看到浏览器如何准确处理所有这些。您可能希望在核心 ExtJs 函数中添加一些额外的逻辑，以确认框架是否实际上被实例化了多次。

3.  如果最终用户遇到一些性能问题 - 证明重构的合理性可能是非常好的点。不然有点难。当然，除非您有一些计划在不久的将来扩展功能并计划继续开发此应用程序。

# python - 使用 GMT 偏移量将时间转换为 UTC

> ID：10237024
> 
> 赞同：1
> 
> 时间：2012-04-19T21:25:05.810
> 
> 标签：python, time, utc

我有以下格式的日期时间和 UTC 偏移量。

> 22-01-2012 22:01:30 +0530
> 
> 12-02-2012 13:00:34 -0400

如何使用 Python 中的 pytz 模块将其转换为 UTC？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:43:10.080

我会使用来自[http://labix.org/python-dateutil#head-2f49784d6b27bae60cde1cff6a535663cf87497b](http://labix.org/python-dateutil#head-2f49784d6b27bae60cde1cff6a535663cf87497b)的 dateutil.parser 。确保为您的 python 版本使用正确的版本。

```
import datetime
import dateutil.parser
import pytz
loc_dt = dateutil.parser.parse('22-01-2012 22:01:30 +0530')
loc_dt.astimezone(pytz.utc) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T01:01:16.393

在`python3`：

```
>>> import time
>>> from datetime import datetime
>>> tm = '22-01-2012 22:01:30 +0530'
>>> fmt = '%d-%m-%Y %H:%M:%S %z'
>>> time.asctime(datetime.strptime(tm, fmt).utctimetuple())
'Sun Jan 22 16:31:30 2012' 
```

# c# - 将数据写入缓冲区并从缓冲区读取数据

> ID：10237025
> 
> 赞同：0
> 
> 时间：2012-04-19T21:25:09.203
> 
> 标签：c#, buffer

我目前正在考虑用 c# 编写一个处理管理日志文件的程序。目的是日志文件不应超过 50mb，因此我正在重命名文件并创建一个新文件，然后它应该开始写入新文件。为避免在更改文件时将数据写入日志，我想在程序的一部分中将数据添加到缓冲区，然后在程序的另一部分中读取缓冲区中的数据并将其输出到文件。如果它不能写入文件，它将把它保存在缓冲区中，直到它可以写入文件。

我将如何去做这件事我似乎在谷歌上找不到任何东西，不确定我是否在搜索正确的东西。

感谢您的任何帮助，您可以提供

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:33:32.377

这听起来像是一个经典的生产者消费者问题。这是很好的起点。

[阻止收集](http://msdn.microsoft.com/en-us/library/dd267312.aspx)

正如其他人指出的那样，使用库比重新发明轮子更好。Log4net 是一个很好的日志库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:33:37.383

我建议使用[BlockingCollection](http://msdn.microsoft.com/en-us/library/dd267312.aspx)。想要写入日志的线程只需将日志字符串排入`BlockingCollection`. 一个单独的线程监视出`BlockingCollection`队的字符串并将它们写入文件。如果文件不可用，线程可以等待并重试。

有关一些简单示例，请参阅[http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=821](http://www.informit.com/guides/content.aspx?g=dotnet&seqNum=821)。

如果不能使用`BlockingCollection`，可以使用[Queue](http://msdn.microsoft.com/en-us/library/7977ey2c%28v=vs.90%29.aspx)并用锁保护它。您记录某些内容的方法变为：

```
private Queue<string> myQueue = new Queue<string>();  // owned by the logger

void WriteLog(string s)
{
    lock (myQueue)
    {
        myQueue.Enqueue(s);
    }
} 
```

删除事物的线程可以从队列中获取它们。它会有点不理想，因为它必须定期轮询，但它不应该太糟糕：

```
while (!shutdown)  // do this until somebody shuts down the program
{
    while (myQueue.Count > 0)
    {
        lock (myQueue)
        {
            string s = myQueue.Dequeue();
            // write the string s to the log file
        }
    }
    Thread.Sleep(1000); // sleep for a second and do it again.
} 
```

有很多方法可以在没有繁忙等待的情况下做到这一点，但我不记得实现细节。有关示例，请参阅[http://msdn.microsoft.com/en-us/library/system.threading.monitor.pulse.aspx](http://msdn.microsoft.com/en-us/library/system.threading.monitor.pulse.aspx)。

# javascript - 如何从 Web 应用程序打开本机 iOS 应用程序

> ID：10237031
> 
> 赞同：30
> 
> 时间：2012-04-19T21:25:25.607
> 
> 标签：javascript, ios, mobile-safari

**总结**我有一个应用程序，其 URL 方案运行正常，我想从存储在主屏幕上的 Web 应用程序启动，但正常的 JavaScript 重定向方法似乎不起作用。

**详细信息**我正在尝试创建一个 iOS 网络应用程序，它可以从主屏幕上保存的链接以全屏模式打开。Web 应用需要打开特定的原生应用。我已经为本机应用程序注册了 url 方案，并验证了它是否正常工作 - 例如，我可以通过直接在我的 Safari 地址栏中键入方案来打开本机应用程序。我也可以使用`+openURL:`. `UIApplication`我还想使用可以添加到主屏幕的本机 Web 应用程序的某些参数打开它。

我想要做的是在本机应用程序中使用 JavaScript：

```
window.location = "myapp://myparam"; 
```

在网络应用程序中使用此代码时，我收到一条警报：

> “无法打开 myWebAppName - 无法打开 myWebAppName。错误是“无法显示此 URL”。”。

在 Safari 中执行时，同样的 javascript 可以正常工作。我使用`window.location.replace("myapp://myparam")`.

Web 应用程序的 html 是：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>untitled</title>
    <meta name="generator" content="TextMate http://macromates.com/">
    <meta name="author" content="Carl Veazey">
    <!-- Date: 2012-04-19 -->
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta names="apple-mobile-web-app-status-bar-style" content="black-translucent" />
</head>
<body>
    <script type="text/javascript" charset="utf-8">
        if (window.navigator.userAgent.indexOf('iPhone') != -1) {
            if (window.navigator.standalone == true) {
                window.location = "myapp://myparam";
            } else {
                document.write("please save this to your home screen");
        };} else {
                alert("Not iPhone!");
                document.location.href = 'please-open-from-an-iphone.html';
        };
    </script>
</body>
</html> 
```

我在这里做错了什么？我对javascript和移动网络非常缺乏经验，所以我怀疑我只是错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-19T22:12:47.133

如果您的代码在移动 Safari 中有效，但如果它来自 iOS 桌面上的书签则无效。以前从来没有这样尝试过，但这就是问题所在。如果我只是将您的 JS 设置为

```
<script type="text/javascript" charset="utf-8"> 
window.location = "myapp://myparam";
</script> 
```

它可以在浏览器中使用，但是在添加书签时会失败。由于没有 chrome，它可能必须与 url 在其书签时如何加载有关？我的猜测是苹果不希望预订标记页面访问本地应用程序。此外，我注意到，如果我为本地托管的页面添加书签，该页面适用于移动 safari，我无法通过书签加载它。实在是太奇葩了......

我给你的最好建议是成功

```
<meta name="apple-mobile-web-app-capable" /> 
```

代替

```
<meta name="apple-mobile-web-app-capable" content="yes" /> 
```

这样它就会出现在主屏幕上，但不幸的是会与 chrome 一起加载。这是我能想到的唯一解决方案。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-04T11:22:52.203

如果您需要打开已安装的 iOS 应用程序，并且还想保留页面的功能，这`location.href = 'myapp://?params=...';`将无济于事，因为如果`myapp://`未注册，重定向会将用户引导到无法访问的目的地。

最安全的选择似乎是使用`iframe`. 如果安装了 iOS 应用程序，以下代码将打开它，如果未安装，则不会导致失败（尽管如果未安装应用程序，它可能会提醒用户无法访问该页面）：

```
var frame = document.createElement('iframe');
frame.src = 'myapp://?params=...';
frame.style.display = 'none';
document.body.appendChild(frame);

// the following is optional, just to avoid an unnecessary iframe on the page
setTimeout(function() { document.body.removeChild(frame); }, 4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-03T19:08:41.457

**Try like this**: The index page

```
<html><head></head><body>
<?php
$app_url = urlencode('YourApp://profile/blabla');
$full_url = urlencode('http://yoursite.com/profile/bla');
?>   

<iframe src="receiver.php?mylink1=<?php echo $app_url;?>" width="1px" height="1px" scrolling="no" frameborder="0"></iframe>
<iframe src="receiver.php?mylink2=<?php echo $full_url;?>" width="1px" height="1px" scrolling="no" frameborder="0"></iframe>

</body>
</html> 
```

the **receiver.php** page:

```
<?php if ($first == $_GET['mylink1'])) { ?>
   <script type="text/javascript">
   self.window.location = "<?php echo $first;?>"; 
   </script>

<?php } if ($second == $_GET['mylink2'])) { ?>
   <script type="text/javascript">
   window.parent.location.href = "<?php echo $second ;?>"; 
   //window.top.location.href=theLocation;
   //window.top.location.replace(theLocation);
   </script>
<?php } ?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-12T13:32:39.247

为了提供更新，iOS14 Beta7 似乎没有通过其注册的 x-callback URL 打开任何本地应用程序。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-19T22:25:56.107

```
<?php 
// Detect device type
$iPod = stripos($_SERVER['HTTP_USER_AGENT'],"iPod");
$iPhone = stripos($_SERVER['HTTP_USER_AGENT'],"iPhone");

// Redirect if iPod/iPhone
if( $iPod || $iPhone ){
    header('Location:http://example.com');      
}
?> 
```

如果设备是 iPod 或 iPhone，以上内容会将浏览器重定向到输入的 URL (http://example.com/)。将脚本添加到 Web 应用程序的顶部，确保将其保存为`.php`文件而不是`.html`.

来源： [http ://www.schiffner.com/programming-php-classes/php-mobile-device-detection/](http://www.schiffner.com/programming-php-classes/php-mobile-device-detection/)

# javascript - 整个下拉菜单在页面加载时快速闪烁

> ID：10237037
> 
> 赞同：4
> 
> 时间：2012-04-19T21:25:50.670
> 
> 标签：javascript, jquery, html, css, drop-down-menu

`li`我有一个使用 jQuery 隐藏子元素的标准下拉菜单。但是，在加载站点时，子元素会迅速出现并随后消失（有点像快速闪烁）。我认为这与 flash-of-unstyled-content 已知问题完全无关。

该网站是希伯来语的，但这不应该影响任何事情。该站点位于[此处](http://medigo.co.il/?page_id=752)

如果您想要 HTML + CSS 示例和 Javascript 代码，我很乐意将其发布在这里。

我只是想知道是否有人以前遇到过这个问题。我在 Chrome 中看到它，我还没有真正检查它是否也发生在 IE 和 Firefox 中。

谢谢！

编辑：HTML/CSS/JS 如下所示：

HTML：

```
<ul class="menu">
  <li><a href="#">blah</a>
    <ul class="sub-menu">
      <li><a href="#">blah</a></li>
    </ul>
  </li>
</ul> 
```

CSS：

```
/* NAVIGATION -- level 1 */
ul.menu { float: right; list-style-type: none; font-size: 15px; margin-top: 50px; }
ul.menu > li{ float: right; display: inline; position: relative; margin-left: 30px; }
ul.menu li > a { display: block; color: #5c5d5f; text-decoration: none; border-bottom: solid 1px #9b9a95;  }

ul.menu li:hover > a, ul.menu li a:hover , ul.menu li.current_page_item > a { color: black; }
body.home .current_page_item > a { }
body.home .current_page_item > a:hover { }

/* NAVIGATION -- level 2 */
ul.menu li > div { display: none; width: 157px; height: 171px; margin-right: -10px; position: absolute; opacity:0; background: url(images/subNav_bg.png) no-repeat top right; }

ul.menu li > div span { height: 15px; background: transparent; display: block; } /* used to push down the menu */ 
```

JS：

```
// navigation menu //
// add hasSubMenu to each li that has one //
$('.menu > li').has('ul').addClass('hasSubMenu');

// wrap with <div> //
$('li.hasSubMenu > ul').wrap('<div />');
$('ul.menu li > div').css('display', 'none');
$('ul.menu li > div').prepend('<span></span>');
$('li.hasSubMenu > a').click(function () {
    return false;
});

// add class to <div> for extendedBg //
$('li.extendedBg').find('div').addClass('subBg2');

$('li.hasSubMenu').hover(function () {
    // hover on
    $(this).addClass('hover').find('div').stop().fadeTo("medium", 1, /* when done fading */
        function () {
            $(this).find('div').css('display', 'block');
            //$(this).find('ul').css('display','block');
        }
    );

}, function () {
    // hover off
    $(this).removeClass('hover').find('div').stop().fadeOut();
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T21:29:33.180

将下拉菜单设置为`display: none`在页面的 CSS 中或直接在元素本身中使用`style="display:none"`. 这将在页面加载时隐藏它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T11:37:27.057

我有同样的问题:(除非我使用css在加载时隐藏它，我现在遇到的问题是它永远不会显示！即使将鼠标悬停在父级上......

甚至在我发布回复之前，我就想再尝试一件事

```
#navigation ul ul{
    display:none;
} 
```

代替

```
#navigation ul ul li{
    display:none;
} 
```

现在它完美地工作了

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T21:30:00.910

我建议将样式设置为 display:none 样式表中的 li 元素，以便浏览器知道最初将它们呈现为不显示。然后，当 jQuery 加载时，jQuery 添加的内联样式将覆盖显示样式。

```
ul li {
  display:none;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-02T00:57:51.963

尝试：

```
.mobile-menu:not( .mm-menu ) {
     display: none;
} 
```

其中 '.mobile-menu' 是您为菜单的包含元素提供的任何类或 ID。

例如

```
<div class="mobile-menu">
   <ul>
       <li><a href="/about">about</a></li>
       <li><a href="/food">Food</a></li>
   </ul>
</div> 
```

# c# - 如何将属性封装在基类中？

> ID：10237043
> 
> 赞同：8
> 
> 时间：2012-04-19T21:26:23.810
> 
> 标签：c#, oop, uml, object-oriented-analysis

我的场景是关于开发数学问题。作为一个`IProblem`接口，我认为它应该包含的两个主要属性是`QuestionText`和`Response`。`QuestionText`始终是字符串，但`Response`有时可以是复杂对象（自定义`Fraction`结构）或其他数据类型，如字符串、十进制、整数等。

```
 public interface IProblem
    {
        string QuestionText { get; set; }
        object Response { get; }

        bool IsComplete();
        bool IsCorrect();
    } 
```

如您所见，`Response`是对象。我猜到了这种数据类型，因为本质上所有问题都有响应。由于它是一个对象，我只为未来的错误（铸造问题）定义了 get 。

我的想法是稍后，在一个具体的类中访问这个属性（`Response`），而不需要强制转换。看看这个？

```
 public abstract class Problem : IProblem
    {
        public string QuestionText { get; set;}
        public object Response { get; protected set; } 
        public virtual bool IsComplete()
        {
            return true;
        }
        public abstract bool IsCorrect();
    }

    public class BinaryProblem : Problem
    {
        public decimal N1 { get; set; }
        public decimal N2 { get; set; }
        public decimal Response
        {
            get { return (decimal)base.Response; }
            set { base.Response = value; }
        }

        public override bool IsCorrect()
        {
            return N1 + N2 == Response;
        }
    } 
```

在这里，我正在测试价值。

```
 static void Main(string[] args)
    {
        BinaryProblem p = new BinaryProblem();
        p.N1 = 2;
        p.N2 = 4;

        p.Response = 6;

        IProblem p2 = p;
        Console.WriteLine(p2.Response);
        Console.WriteLine(p2.IsComplete().ToString());
    } 
```

到目前为止，它有效，但我想知道我正在做的事情是正确的还是好的做法。我见过另一个人使用`new`运算符来做到这一点。其他人不使用这个词`base`。

这是一个好方法吗？它会导致未来的错误吗？请给我一个关于我的设计的反馈。

编辑：确实有必要在非通用接口中访问响应。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T00:01:53.770

也许你正在寻找这样的东西？请注意，我遗漏了一些内容，因为它们对于问题的通用解决方案部分（如 QuestionText）并不重要。我还省略了基类，因为它看起来只不过是一个传递，以及一个额外的、不必要的层。这可能不是您正在寻找的东西，但我希望它可以帮助您实现目标。

首先，这是所有东西的使用方式：
**编辑：注意它们现在如何都被视为非泛型 IProblem。**

```
private static void StackOverflowQuestion()
{
    IProblem<int> problem1 = new IntProblem(2, 4);
    problem1.Response = 6;

    IProblem<decimal> problem2 = new DecimalProblem(5, 10);
    problem2.Response = .5M;

    Console.WriteLine("Problem 1 is correct: {0}", problem1.IsCorrect());
    Console.WriteLine("Problem 2 is correct: {0}", problem2.IsCorrect());

    List<IProblem> problems = new List<IProblem>();
    problems.Add(problem1);
    problems.Add(problem2);
    problems.ForEach(problem => Debug.WriteLine(problem.GetResponse()));
} 
```

**编辑：这是非通用接口，因此可以在列表中使用许多问题并以相同的方式处理：**

```
public interface IProblem
{
    object GetResponse();
} 
```

这是接口：
**编辑：请注意，这现在实现了非通用接口。**

```
public interface IProblem<T> : IProblem
{
    T Response { get; set; }
    bool IsCorrect();
} 
```

下面是这些类：
**编辑：注意新的 GetResponse() 方法。**

```
public class IntProblem : IProblem<int>
{
    private int _number1 { get; set; }
    private int _number2 { get; set; }

    public int Response { get; set; }

    public IntProblem(int number1, int number2)
    {
        this._number1 = number1;
        this._number2 = number2;
    }

    public bool IsCorrect()
    {
        return this._number1 + this._number2 == Response;
    }

    public object GetResponse()
    {
        return this.Response;
    }
}

public class DecimalProblem : IProblem<decimal>
{
    private decimal _number1 { get; set; }
    private decimal _number2 { get; set; }

    public decimal Response { get; set; }

    public DecimalProblem(decimal number1, decimal number2)
    {
        this._number1 = number1;
        this._number2 = number2;
    }

    public bool IsCorrect()
    {
        return this._number1 / this._number2 == Response;
    }

    public object GetResponse()
    {
        return this.Response;
    }
} 
```

# wpf - WPF DataGridTextColumn 标题绑定

> ID：10237044
> 
> 赞同：1
> 
> 时间：2012-04-19T21:26:27.083
> 
> 标签：wpf, binding, datagrid, header

我有一个绑定不起作用的代码

```
<DataGridTextColumn Header="{Binding LocalizedText.Task_Toolbar_AddButton}" /> 
```

对于按钮：

```
<Button x:Name="addTaskButton" Click="addTaskButton_Click">
<TextBlock Text="{Binding LocalizedText.Task_Toolbar_AddButton, Mode=OneWay}" />
</Button> 
```

它工作正常，但对于 datagrid 标题根本不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:03:57.580

查看 Josh Smith 关于 DataContext Spy 的博客，其中 DataContextSpy 类使用 Hillberg 的 Freezable 技巧从不在逻辑树中的对象获取继承上下文的访问权限。DataContextSpy 非常简单，所以应该可以在很多场景下复用。

以下是在标题上使用它的方法（我一直在使用它，不仅在 DataGrid.Headers 上）：

```
 <DataGrid...
    <DataGrid.Resources>
        <myNamespaces:DataContextSpy x:Key="dcSpy" DataContext="{LocalizedText}"/>
         .......

    <DataGridTemplateColumn Header="{Binding Source={StaticResource dcSpy}, Path=DataContext.Task_Toolbar_AddButton}"> 
```

**编辑：** 我似乎在他的博客上找不到它，也许他存档了，所以在这里，我只是为你添加它。粘贴它，在 XAML 中引用它，如上所示，然后使用它的 DataContext 提取要绑定的数据：

```
public class DataContextSpy : Freezable
{
    public DataContextSpy ()
    {
        // This binding allows the spy to inherit a DataContext.
        BindingOperations.SetBinding (this, DataContextProperty, new Binding ());
    }

    public object DataContext
    {
        get { return GetValue (DataContextProperty); }
        set { SetValue (DataContextProperty, value); }
    }

    // Borrow the DataContext dependency property from FrameworkElement.
    public static readonly DependencyProperty DataContextProperty = FrameworkElement
        .DataContextProperty.AddOwner (typeof (DataContextSpy));

    protected override Freezable CreateInstanceCore ()
    {
        // We are required to override this abstract method.
        throw new NotImplementedException ();
    }
} 
```

# python - cassandra 创建和使用索引 [pycassa]

> ID：10237045
> 
> 赞同：1
> 
> 时间：2012-04-19T21:26:31.323
> 
> 标签：python, indexing, cassandra, pycassa

我想在标准列族的“年龄”键上创建和使用索引。

我使用pycassa做了以下事情：

```
In [10]: sys.create_index('test01', 'word_map', 'age', 'IntegerType', index_type=0, index_name='index_age')
In [11]: age_expr = create_index_expression('age', 6, GT)
In [12]: clause = create_index_clause([age_expr], count=20)
In [13]: cf.get_indexed_slices(clause)

error: 'No indexed columns present in index clause with operator EQ' 
```

根据这个不错的[页面](http://www.datastax.com/dev/blog/whats-new-cassandra-07-secondary-indexes)，我需要设置值类型。然而：

```
In [16]:  cf_words.column_validators
Out[16]: {'black_white': 'BooleanType', 'url': 'UTF8Type', 'age': 'IntegerType', 'site': 'UTF8Type', 'len': 'IntegerType', 'content': 'UTF8Type', 'colourful': 'BooleanType', 'printer_friendly': 'BooleanType'} 
```

所以年龄有一个数据类型集。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T00:48:51.127

而不是字符串“GT”，使用`pycassa.index.GT`. 这是 Thrift 用整数实现的枚举。

您可以在此处找到所有文档和示例用法：http: [//pycassa.github.com/pycassa/api/pycassa/index.html](http://pycassa.github.com/pycassa/api/pycassa/index.html)

# java - `WindowListener` 启动，永久触发

> ID：10237047
> 
> 赞同：5
> 
> 时间：2012-04-19T21:26:35.167
> 
> 标签：java, swing, jdialog, windowlistener

我有一个带有扩展的抽象类的应用程序`JDialog`。类作为`abstract void onClose()`，并且在类的构造函数中，添加了以下代码：

```
addWindowListener(new WindowAdapter() {
    @Override
    public void windowClosed(WindowEvent e) {
        onClose();
    }
} 
```

该事件在预期时被触发，但随后发生了一件奇怪的事情。当这个类的具体扩展有代码`JDialog`在`onClose()`方法中创建一个新的，并且 this`JDialog`的`defaultCloseOperation`is `JDialog.DISPOSE_ON_CLOSE`，事件被连续触发，直到我强制退出操作。

我已将代码隔离到以下 SSCCE：

```
// package removed
// imports removed
public class SSCCE extends JDialog {
    public static void main(String[] args) {
        SSCCE s = new SSCCE();
        s.pack();
        s.setVisible(true);
    }
    public SSCCE() {
        setLayout(new GridLayout(1, 0, 0, 0));
        JButton btn = new JButton("click me");
        btn.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent arg0) {
                dispose();
            }
        });
        addWindowListener(new WindowAdapter() {
            @Override
            public void windowClosed(WindowEvent e) {
                System.out
                        .println("SSCCE.SSCCE().new WindowAdapter() {...}.windowClosed()");
                onClose();
            }
        });
        add(btn);
    }

    public void onClose() {
        JDialog dialog = new JDialog();
        dialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        dialog.setVisible(true);
    }

} 
```

单击“单击我”按钮后，空白`JDialog`出现并`SSCCE.SSCCE().new WindowAdapter() {...}.windowClosed()`出现在控制台窗口中。当我关闭空白对话框时，它再次出现并且文本再次出现。

另一个非常有趣的事情是，当我将初始化行从

```
JDialog dialog = new JDialog(); 
```

到

```
JDialog dialog = new JDialog() {
        @Override
        public synchronized void addWindowListener(WindowListener l) {
            super.addWindowListener(l);
            System.out
                    .println("SSCCE.onClose().new JDialog() {...}.addWindowListener()");
        }
    }; 
```

我在控制台中得到以下输出：

点击“点击我”按钮时：

```
SSCCE.SSCCE().new WindowAdapter() {...}.windowClosed()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener() 
```

在对话框第一次关闭时：

```
SSCCE.SSCCE().new WindowAdapter() {...}.windowClosed()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener() 
```

在对话框第二次关闭时：

```
SSCCE.SSCCE().new WindowAdapter() {...}.windowClosed()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener()
SSCCE.onClose().new JDialog() {...}.addWindowListener() 
```

每次我关闭对话框时，都会*再*`addWindowListener(WindowListener l)`调用一次，即使我不是故意调用它。

 *我真的不希望在对话框上注册*任何* `WindowListener`s，但我认为简单地覆盖`addWindowListener(...)`方法而不调用`super.addWindowListener(...)`会太草率。

我在 Mac OS X 10.6.8 上运行 Java 1.6.0_31，使用 Eclipse Indigo（如果重要的话，使用 WindowBuilder）。

有没有人有任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T00:05:33.317

根据[Java Dialog 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html)，

> 每个对话框都依赖于一个 Frame 组件。当该 Frame 被销毁时，其依赖的 Dialogs 也会被销毁。

当您使用[不带任何参数的 JDialog 构造函数](http://docs.oracle.com/javase/7/docs/api/javax/swing/JDialog.html#JDialog%28%29)时，它

> 创建一个没有标题且没有指定 Frame 所有者的无模式对话框。一个共享的隐藏框架将被设置为对话框的所有者。

该共享隐藏框架是`SwingUtilities$SharedOwnerFrame`，并且在初始化时它将 a 注册`WindowListener`到所有拥有的窗口。

当您关闭对话框时，将调用`SharedOwnerFrame`'s`windowClosed`方法，该方法检查它拥有的所有窗口（此时是原始 SSCCE 对话框和新窗口），它发现没有一个是可见的，因此它自行处理。这会影响处理它拥有的所有对话框，这些对话框会向每个对话框发布一个窗口关闭事件。这会调用`windowClosed`您的侦听器，打开一个新对话框。我们又走了一遍:-)。关于您最后的评论，您每次都会获得额外的日志行，因为您`SharedOwnerFrame`拥有的每个对话都会获得一个。

如果您让 SSCCE 对话框**拥有**新对话框（通过传递`this`给它的构造函数），那么您最终不会拥有共享所有权并且它工作正常：

```
 public void onClose() {
     JDialog dialog = new JDialog(this);
     dialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
     dialog.setVisible(true);
 } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T21:42:21.357

```
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;

import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JOptionPane;

public class SSCCE extends JDialog {
    public static void main(String[] args) {
        SSCCE s = new SSCCE();
        s.pack();
        s.setVisible(true);
    }

    private WindowAdapter wa = new WindowAdapter() {
        @Override
        public void windowClosed(WindowEvent e) {
            System.out
                    .println("SSCCE.SSCCE().new WindowAdapter() {...}.windowClosed()");
            onClose();
        } 
    };

    public SSCCE() {
        setLayout(new GridLayout(1, 0, 0, 0));
        JButton btn = new JButton("click me");
        btn.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent arg0) {
                dispose();
            }
        });
        addWindowListener(
        wa);
        add(btn);
    }

    public void onClose() {
        removeWindowListener(wa);
        JDialog dialog = new JDialog();
        dialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);
        dialog.setVisible(true);

    }

} 
```*

# c# - 带有 MVCcontrib 的 MVC3 不呈现/生成 html

> ID：10237052
> 
> 赞同：0
> 
> 时间：2012-04-19T21:27:11.083
> 
> 标签：c#, asp.net-mvc-3, mvccontrib

```
@model SocialReader.BackOffice.Models.NewsAndCategories
@using MvcContrib.UI.Grid;
@using MvcContrib.UI.Pager;
@using MvcContrib.Pagination;
@using System.Linq;
@using SocialReader.BackOffice.Common;
@{
    ViewBag.Title = "News";
}

<h2>@ViewBag.Message</h2>
<p>
    @Html.ActionLink("Create News", "Create", "News")
</p>

@{Html.RenderPartial("Pager", Model.PagedViewModel.PagedList);}
@Html.Grid(Model.PagedViewModel.PagedList).Columns(column =>
{
    column.For(x => Html.ActionQueryLink(x.Title, "View", new { id = x.Id })).Named("Title").InsertAt(0);
    column.For(x => x.Category.Name).Named("Category").InsertAt(1);
    column.For(x => x.DateUpdated).Named("Date Updated").InsertAt(2);
    column.For(x => x.Published).Named("Is Published").InsertAt(3);
    column.For(x => x.ViewCount).Named("View Count").InsertAt(4);
    column.For(x => x.UserCreated).Named("Authoer").InsertAt(5);
}).Sort(Model.PagedViewModel.GridSortOptions).Attributes(@class => "grid-style") 
```

我有这段代码，我正在尝试对新闻进行分页，但是您单击下一个上一个等的分页没有呈现我所看到的，页面上的纯 HTML 而不是呈现的 HTML。

```
<div class='pagination'><span class='paginationLeft'>Showing 1 - 10 of 41 </span><span class='paginationRight'>First | Previous | <a href="/News/Index?page=2">Next</a> | <a href="/News/Index?page=5">Last</a></span></div> 
```

这是我在页面上看到的，而不是渲染的。我已经检查了它们都包含的 CSS 和 JS。

我究竟做错了什么？有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:31:25.983

`@Html.RenderPartial`不使用`@{Html.RenderPartial}`

# java - 树形结构可视化

> ID：10237053
> 
> 赞同：1
> 
> 时间：2012-04-19T21:27:12.360
> 
> 标签：java, eclipse, eclipse-rcp

我有一个需要可视化的 AST（抽象语法树）结构。这种可视化使用什么？我听说过 eclipse gmf，但是在对所有模型和代码生成进行了简短的了解之后，我认为它对于这个问题来说太复杂了。

我的任务只是显示具有一些基本交互功能的树结构：我需要显示带有一些附加信息的弹出窗口，仅此而已。

你觉得eclipse Draw2D 够用吗？此外，是否有一些开箱即用的解决方案可用于可视化树结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:00:00.647

试试[GraphViz](http://www.graphviz.org/)。它是一个开源图形可视化软件，可用于从图形结构（包括 AST）生成图像（SVG、PNG、JPEG 等）。

[您可以在Eclipse Zest](http://www.eclipse.org/gef/zest/)中找到基于 Java 的替代方案，这是 Eclipse的一组可视化组件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:29:56.167

它不是特别性感，但是如果您正在寻找低门槛，那么摇摆 JTree 很容易上手。[Swing 教程](http://docs.oracle.com/javase/tutorial/uiswing/components/tree.html)有几个例子。

# php - 使用 git 的 php 和 mysql 的本地和生产版本

> ID：10237054
> 
> 赞同：1
> 
> 时间：2012-04-19T21:27:31.777
> 
> 标签：php, mysql, database, git, dev-to-production

我有一个关于如何设置使用 PHP 和 MySQL 的 WordPress 网站的本地和生产版本的问题。

我想让这两个版本（本地和生产）使用不同的数据库，因为我们可以测试。

我将使用 git 将我的更改推送到服务器。

我在本地安装了 MySQL，并在本地设置了网络服务器，但我不知道如何将 mysql 更改推送到服务器并与 git 保持连接。

我将和其他几个人一起工作，所以它需要使用 git 作为数据库。

我该怎么做呢？

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:33:10.333

您可以将方案和/或数据转储到文件中，然后将该文件签入 git。

例如，这会将表模式和数据转储到名为 [table_name].sql 的文件中

```
mysqldump --user=[user_name] -p --opt [local_database_name] [table_name] > [table_name].sql 
```

要在生产中加载此数据，您可以执行以下操作：

```
mysql --user=[user_name] -p [server_database_name] < [table_name].sql 
```

# c - 无限循环链表

> ID：10237056
> 
> 赞同：1
> 
> 时间：2012-04-19T21:27:39.443
> 
> 标签：c, linked-list, structure, infinite-loop

似乎在我的代码中，我有一个无限循环打印出同一个名为 search 的 class_t 变量，尽管试图将变量向前移动到下一个 class_t。所有 class_t 结构要么指向 (class_t*)0（因为如果我使用 NULL 会收到编译器警告，因为我在比较 class_t* 和 void*），或者指向下一个适当的 class_t 结构。我做错了什么，或者我应该在其他地方寻找我的问题吗？

```
class_t *search = (students + i)->class_p;//students is a seperate structure where class_p is a pointer to a class_t structure
            while(search != (class_t*)0)
            {
                    fprintf(output,": %s%d %d %d\n", search->name, search->number, search->section, search->credits);
                    search = search->nextClass;
            } 
```

这是输出的示例，查看它，它是文件中 class_t 中的最后一次读取

```
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4
: CS521 1 4 
```

这是 class_t 的创建：

```
 class_t newClass;
newClass.number = classid;
newClass.section = section;
newClass.credits = credits;
newClass.nextClass = (class_t*)0; 
```

添加节点时：

```
void addNode(student_t students[], class_t addClass, int ref)
{
int found = 0;

if((students + ref)->class_p == (class_t*)0)//no classes yet
{
    (students + ref)->class_p = &addClass;
    found = 1;
}
else if((*((students + ref)->class_p)).number > addClass.number && found == 0)//checks first class
{
    class_t *temp = (students + ref)->class_p;
    (students + ref)->class_p = &addClass;
    addClass.nextClass = temp;
    found = 1;
}
else//works way through the class linked list to find where it goes
{
    class_t *beforesearch = (students + ref)->class_p;
    class_t *search = beforesearch->nextClass;
    while(search != (class_t*)0 && found == 0)
    {
        if(search->number < addClass.number)
        {
            beforesearch->nextClass = &addClass;
            addClass.nextClass = search;
            found = 1;
        }
        else
        {
            beforesearch = search;
            search = search->nextClass;
        }
    }

    if(found == 0)
    {
        beforesearch->nextClass = &addClass;
        found = 1;
    }
} 
```

}

带有 typedef 的头文件：

```
typedef struct class_t {
char name[3];
int number;
int section;
int credits;
struct class_t *nextClass;
} class_t;

typedef struct student_t {
int id;
class_t *class_p;
} student_t; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:07:07.880

这是一个非常微妙的错误：

```
void addNode(student_t students[], class_t addClass, int ref)
{
    int found = 0;

    if((students + ref)->class_p == (class_t*)0)//no classes yet
    {
        (students + ref)->class_p = &addClass; 
```

您正在`addClass`按值传递（即我假定的结构的完整副本），然后使用其地址将其链接到列表中。这是错误的，因为您使用的是属于调用堆栈**的函数参数的地址。**

如果您得到一个列表循环，则意味着您遇到了每次调用都`addNode`将结构复制到堆栈中的相同地址的情况。但这很幸运，这段代码有**很多**地方可能出错，我不会一一解释。

正确的解决方案是在堆上分配`class_t`节点（即 with `malloc()`）并将指针传递给它们。或者在链接之前分配一个副本：

```
void addNode(student_t students[], class_t addClass_param, int ref)
{
    class_t *addClass = malloc(sizeof(class_t)); /* Check for NULL return skipped */
    memcpy(addClass, &addClass_param, sizeof(class_t));
    /* ... */ 
```

# jquery - 将 jsonp 与 ashx 处理程序一起使用

> ID：10237059
> 
> 赞同：1
> 
> 时间：2012-04-19T21:27:50.690
> 
> 标签：jquery, jsonp, ashx

谁能给我一个清晰的演练如何使用 jsonp 调用 ashx 处理程序或告诉我我做错了什么？我在一个子域上有一个 javascript 函数，试图在另一个子域上调用 ashx 处理程序。当我尝试返回 200 状态时，但它仍然进入我的错误处理并报告 SyntaxError: Invalid character 的 throwedError。我在 jquery 和 jsonp 上找到了几个线程，但只有一个实际上显示了与 ashx 相关的任何代码。不幸的是，它似乎没有工作，我不知道为什么。这是来自 javascript 调用的代码，然后是 ashx 响应。

```
var sPay = getEl('chkPay').checked ? "pay=1" : "";
var sUrl = "/Calculator/GetCalcResult.ashx?jsoncallback=?" + sPay;

$.getJSON(sUrl, function (data) {
    console.log("Success:" + data);
}).error(function (xhr, ajaxOptions, thrownError) {
    console.log("Status:" + xhr.status);
    console.log("Error:" + thrownError);
}); 
```

然后是 ashx 处理程序...

```
var jsonstr = 
                 "{\"calculatorresults\":{" +
                    "\"employees\" : \"" + employeeCount + "\"" +
                    "\"pay\" : \"" + calculationResult.PayTotal + "\"" +
                    "\"total\" : \"" + calculationResult.Total + "\"" +
                "}}";

            context.Response.ContentType = "application/json";
            context.Response.Write(string.Format("{0}({1});", context.Request["jsoncallback"], jsonstr)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T14:40:02.540

我最近也在为此苦苦挣扎......这是我的解决方案的一个非常简化的版本，其中包括基本的必要代码。

在尝试将 json 传递到 ashx 页面并从该 ashx 页面检索 json 数据时，我遇到了跨域问题。在这个例子中，我向 ashx 页面发送了一个 SessionKey，它返回了一个对象的 ID。

来自客户端页面的 JQuery AJAX 调用：

```
function CallASHXPage()
{
    var strJson = '{ "Request": { "SessionKey": "ABCD-1234" } }';

    return $.ajax({
        url: "http://localhost:55724/RemoteJsonpTest.ashx?data=" + strJson,
        cache: false,
        crossDomain: true,
        dataType: "jsonp"
    }).done(function(data)
    {
        // handle the output here
        alert(data.Response.OutputID);
    });
} 
```

这是 ASHX 页面上的代码：

```
// read in data param
string JSON = context.Request.QueryString["data"];

// execute your ASHX code here

// prepare resposne data
string strResponse = "{\n";
strResponse += "\t\"Response\":\n";
strResponse += "\t{\n";
strResponse += "\t\t\"OutputID\": "12345"\n";
strResponse += "\t}\n";
strResponse += "}\n";

// output response wrapped in callback function
string output = context.Request.Params["callback"];
output += "(" + strResponse + ");";
context.Response.Write(output); 
```

# scala - 将任何参数化对象作为类构造函数的参数

> ID：10237061
> 
> 赞同：1
> 
> 时间：2012-04-19T21:27:52.440
> 
> 标签：scala, constructor, parameterized

假设我有这样的代码：

```
abstract class Animal[T <: Animal[T]] {
  def mateWith(that: T)
}

class Cow extends Animal[Cow] {
  override def mateWith(that: Cow) { println("cow") }
}

class Dog extends Animal[Dog] {
  override def mateWith(that: Dog) { println("dog") }
} 
```

我想写这样的东西：

```
class Caretaker (val pet: Animal) {
  ...
} 
```

但这是无效的，因为 Animal 需要参数化。我可以通过参数化看守来解决这个问题：

```
class Caretaker[T <: Animal[T]](val pet: Animal[T]) {
  ...
} 
```

但这对于我正在做的事情来说真的是不必要的。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:37:51.850

```
class Caretaker(val pet: Animal[_]) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:42:14.947

请注意，如果您希望看护人​​照顾两只可以相互交配的宠物，那么该参数将变得很重要

```
class Caretaker[T <: Animal[T]](val pet1: T, val pet2: Animal[T]) {
  matePets = pet2.mateWith(pet1)
} 
```

# android - 主屏幕快捷方式不起作用。应用程序未找到

> ID：10237065
> 
> 赞同：0
> 
> 时间：2012-04-19T21:28:00.770
> 
> 标签：android, launcher, shortcuts

我正在尝试在主屏幕上的应用程序内创建活动的快捷方式。我设法创建了快捷方式，但是当我单击它时，什么也没有发生，它说“找不到应用程序”，这是我的代码的样子：

```
final Intent shortcutIntent = new Intent("com.myapp.action.MyActivity");
ComponentName name = new ComponentName(getPackageName(), ".MyActivity");
shortcutIntent.setComponent(name);
shortcutIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
shortcutIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
Intent intent = new Intent();
intent.putExtra(Intent.EXTRA_SHORTCUT_INTENT,shortcutIntent);
intent.putExtra(Intent.EXTRA_SHORTCUT_NAME, "blabla..");

Parcelable iconResource =
Intent.ShortcutIconResource.fromContext(PresetsActivity.this,R.drawable.ic_application_launcher);
intent.putExtra(Intent.EXTRA_SHORTCUT_ICON_RESOURCE,iconResource);
intent.setAction("com.android.launcher.action.INSTALL_SHORTCUT");

sendBroadcast(intent); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-22T09:38:14.680

没有一个[Intent](http://developer.android.com/reference/android/content/Intent.html)构造函数将类名作为参数——您必须改为传递操作。启动活动的通常操作是 ACTION_MAIN。

如果您想查看一些使用快捷方式和意图来做各种有趣事情的示例代码，请查看[Shortcut Circus](https://github.com/ldo/ShortcutCircus_Android)。

# php - 通过 PHP 下载文件

> ID：10237066
> 
> 赞同：0
> 
> 时间：2012-04-19T21:28:18.313
> 
> 标签：php, curl, cron

我在通过 PHP 下载文件时遇到问题。

有趣的是，我无法追踪问题。该代码适用于某些网站，但不适用于其他网站。它是 PHP 中的循环，用于从网站下载备份文件（请求前有睡眠延迟）。

为什么我无法追踪问题？因为当我手动运行代码时，它可以工作（下载文件）。当它由 CRON 运行时，有时它会下载文件，有时它不下载文件（只下载 2 个空的新行）。

使用 curl 下载（我也尝试使用 fsockopen 和 fread 使用不同的代码）。

有谁知道我该如何解决这个问题？

通过设置正确的选项，使用 CURL 删除标题。

```
function fetch_url($url) {
    $c = curl_init();
    curl_setopt($c, CURLOPT_URL, $url);
    curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($c, CURLOPT_TIMEOUT, 20);

    if ($cookiejar != '')  {
        curl_setopt($c, CURLOPT_COOKIEJAR, $cookiejar);
        curl_setopt($c, CURLOPT_COOKIEFILE, $cookiejar);
    }

    curl_setopt($c, CURLOPT_HEADER , false);
    curl_setopt($c, CURLOPT_SSL_VERIFYHOST , false);
    curl_setopt($c, CURLOPT_SSL_VERIFYPEER , false);
    curl_setopt($c, CURLOPT_FOLLOWLOCATION , true);
    curl_setopt($c, CURLOPT_AUTOREFERER , true);
    curl_setopt($c, CURLOPT_USERAGENT, 'Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.2.12) Gecko/20101026 Firefox/3.6.12');
    $con = curl_exec($c);
    curl_close($c);
    return $con;
}

echo fetch_url('http://www.example.com/zip.zip'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:35:09.000

尝试使用[http://www.php.net/manual/en/function.curl-getinfo.php](http://www.php.net/manual/en/function.curl-getinfo.php)显示有关 curl 请求的信息

```
echo curl_errno($c);
print_r(curl_getinfo($c)); 
```

另外，也许它在您的代码中的其他地方，但我没有看到任何内容类型的标题来回显文件

```
$file = fetch_url('http://www.example.com/zip.zip');
header('Content-type: application/zip');
header('Content-Disposition: attachment; filename="zip.zip"');
header("Content-length: " . strlen($file));
echo $file; 
```

# watermark - 如何证明图片被盗？

> ID：10237068
> 
> 赞同：-1
> 
> 时间：2012-04-19T21:28:30.020
> 
> 标签：watermark

如何证明图片是从网站上窃取的？有什么方法可以检查另一个网站**何时**具有相同的图像？我没有任何访问服务器的权限。感谢您的**任何**想法！

更新：不，我不是忘记水印的人。我的一个老客户刚刚找到我这个问题。实际上找到了我们可以使用的谷歌缓存页面，但如果存在任何其他解决方案仍然感兴趣。像任何图像格式都包含任何日期属性吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:48:09.107

如果您使用的是基于 Unix 的操作系统，您可能可以访问 cURL。尝试运行

```
curl --remote-time --remote-name http://url-to-your-image/ 
```

并查看您是否获得与下载文件的确切时间不同的时间戳。并非所有服务器都会及时响应，但可能值得一试。

但一般来说，如果这是您的原创作品，那么您应该拥有一份分辨率更高和/或压缩率更低的图像副本，对吧？这应该足以证明哪些图像是被盗的。然而，出于几个原因，互联网上的知识产权一团糟。但是，即使您不能采取法律行动，您也可能会更好地说服管理员删除内容。

# git - 如何在不更改提交消息的情况下修改提交（重用前一个）？

> ID：10237071
> 
> 赞同：832
> 
> 时间：2012-04-19T21:28:45.240
> 
> 标签：git, commit, git-commit, git-amend

有没有办法修改提交而不`vi`（或您的`$EDITOR`）弹出修改您的提交消息的选项，而只是重用以前的消息？

* * *

## 回答 #1

> 赞同：1285
> 
> 时间：2012-04-28T16:33:42.043

从 git 1.7.9 版本开始，您也可以使用它`git commit --amend --no-edit`来获取结果。

请注意，这将不包括来自其他提交的元数据，例如对您可能重要或不重要的时间戳。

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2012-04-19T21:31:31.827

`git commit -C HEAD --amend`会做你想做的。该`-C`选项从另一个提交中获取元数据。

* * *

## 回答 #3

> 赞同：80
> 
> 时间：2016-01-11T17:25:28.913

另一种（愚蠢的）可能性是`git commit --amend <<< :wq`如果你有 vi(m) as `$EDITOR`。

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2019-05-02T03:12:14.597

要扩展已接受的答案，您还可以执行以下操作：

```
git commit --amend --no-edit -a 
```

添加当前更改的文件。

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2019-05-23T02:41:44.697

您可以保存使用[已接受答案的](https://stackoverflow.com/a/10365442/3577695)[别名](https://stackoverflow.com/questions/2553786/how-do-i-alias-commands-in-git)，以便可以像这样使用它：

`git oops`将添加所有内容，并使用相同的消息进行修改

`git oops -m "new message"`将修改替换消息

* * *

这是别名

```
 oops = "!f(){ \
    git add -A; \
    if [ \"$1\" == '' ]; then \
        git commit --amend --no-edit; \
    else \
        git commit --amend \"$@\"; \
    fi;\
}; f" 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2020-09-22T13:27:29.307

只是为了增加一些清晰度，您需要使用 进行更改`git add`，然后修改最后一次提交：

```
git add /path/to/modified/files
git commit --amend --no-edit 
```

如果您忘记在上次提交中添加一些更改，或者当您想添加更多更改而不通过重用上次提交来创建新提交时，这尤其有用。

# haskell - Haskell 中的状态单子

> ID：10237072
> 
> 赞同：1
> 
> 时间：2012-04-19T21:28:51.783
> 
> 标签：haskell, functional-programming, monads

我正在用 Haskell 编写一个函数，该函数接受一个 Java 类文件，并编写另一个相同但包含一些修改的类文件。为此，我觉得我绝对需要一个状态单子来至少保存包含类文件所有字节的 [Word8]。然而，在我对 Haskell 中的 State Monads 进行了所有研究之后，我仍然无法弄清楚如何做到这一点。谁能指出我正确的方向？我希望能够有一个 [Word8]（或者你知道，任何数据类型），它在所有函数的范围内，并且我可以从函数中修改。我知道这涉及使用类似 state<-get ... put newstate

但我真的不知道从哪里开始定义单子和诸如此类的东西。

提前非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T00:10:25.077

我不确定你*是否*想要一个`State`单子。根据您要进行的修改类型，您*可以*只将要修改的数据传递给要修改它的每个函数。`State`通常用于*除了*修改状态之外还生成值的情况，即当您编写很多看起来像`s -> (s,a)`.

首先尝试一种正常功能的方法。`State`不是魔术，它只是让某些类型的代码更容易快速、简洁和正确地编写。你可以用它做的一切你也可以不用它，只是有点乏味。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T22:58:37.140

您可能想要的是 ST monad 和可变向量，而不是 State Monad。

使用 IO monad 从类文件中读取字节。

```
bytes <- readFile myClassFile 
```

用于对给定字节`runST`运行`ST`monad 计算：

```
let result = runST $ transform bytes 
```

ST monad 使您可以访问[可变向量](http://hackage.haskell.org/packages/archive/vector/0.9.1/doc/html/Data-Vector.html#t%3aMVector)，这很像 C 或 Java 数组。它们由整数索引，并具有 O(1) 查找和修改。

```
transform :: [Char] -> ST s [Char]
transform bytes = do
   mvec <- thaw $ fromList bytes
   -- you can read a value at an index
   val <- read mvec 0
   -- and set a value at an index
   write mvec 0 (val `xor` 0xff)
   -- ...
   -- turn it back into a list of bytes
   vec <- freeze mvec
   return $ toList vec 
```

因此，只需将 传递`mvec`给您的所有函数（必须返回 ST 操作），您就可以对字节执行任何操作。

如果您不想费心将其作为参数传递，请考虑使用`ReaderT`monad 转换以使`mvec`所有代码都隐式可用。

```
transform bytes = do
   -- ...
   runReaderT other mvec
   --- ... 

other :: ReaderT (MVector s Char) (ST s) String 
other = do
   -- ...
   -- grab the mvec when you need it
   mvec <- ask
   val <- lift $ read mvec 77
   lift $ write mvec 77 (val * 363 - 28)
   -- ...
   return "Hi!" 
```

当然，这一切都假设您需要随机访问字节。如果你不......那么你可能不需要一个`MVector`.

例如，如果您需要做的只是替换`0xDEADBEEF`with的每个实例`0xCAFEBABE`，您可以只使用列表，不需要 ST monad：

```
 let newBytes = intsToBytes . map (\i -> if i == 0xDEADBEEF then 0xCAFEBABE else i) $ bytesToInts bytes 
```

# matlab - MATLAB 我是如何制作这个循环的，无限 + 还如何缩短 i = i + 1？

> ID：10237073
> 
> 赞同：1
> 
> 时间：2012-04-19T21:28:54.437
> 
> 标签：matlab, loops, while-loop, infinite

我认为这将是一个简单的迭代，但显然不是，我一直看到数字在屏幕上运行并且`b = 425.0000`......这应该结束我的 while 循环，但我已经大惊小怪了！

```
temp = 85;
b = 85;
cntr = 0;

while b < 425
  temp = temp * 0.8
  b = b + temp
  cntr = cntr + 1
end;
cntr 
```

同样在上面我有`cntr = cntr + 1`，但在其他语言中，我可以将其缩短为`cntr++`或`cntr+=1`如何在 MATLAB 中执行此操作？

干杯!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T21:48:29.607

您的条件可能应该测试 b 的当前值是否接近 425 的值，直到达到一定数量的有效数字。你可以这样做：

```
temp = 85; 
b = 85; 
cntr = 0; 

while b < (425 - 0.0001)   #<--- however many significant digits you need.
  temp = temp * 0.8; 
  b = b + temp;
  cntr = cntr + 1;
end

cntr 
```

问题是您的 while 循环正在收敛到 425，但从未完全到达那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T21:36:51.297

似乎`b`收敛到 425，但实际上并没有达到 425。`b`类似于 424.9999999999，当显示时四舍五入为 425。

据我所知，Matlab中没有`++`or运算符。`+=`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T21:40:52.557

您没有打印足够的小数位来说明问题，请尝试运行以下命令：

```
temp = 85; 
b = 85; 
cntr = 0; 

while ( b < 425 ) && ( cntr < 300 )
  temp = temp * 0.8; 
  b = b + temp;
  cntr = cntr + 1;
  fprintf( 1, '%.20f\t%.20f\t%d\n', temp, b, cntr );
end 
```

你会看到它`b`永远不会达到 425，它的值是 is的`424.99999999999983`值，所以永远不会进一步增加。`temp``0``b`

MATLAB 不实现任何递增/递减运算符。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T21:41:02.473

MATLAB 没有等效的前置和后置运算符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T21:41:19.680

您的表达式的限制似乎是 425，这意味着它实际上从未达到该值。你必须以某种方式编辑你的代码来解决这个问题。

此外，[没有这样的增量运算符](http://www.mathworks.com/matlabcentral/newsreader/view_thread/154981)。

# windows - 如何以编程方式/远程执行 EC2 Windows 实例中的程序

> ID：10237083
> 
> 赞同：18
> 
> 时间：2012-04-19T21:29:54.777
> 
> 标签：windows, upload, automation, amazon-ec2, amazon-web-services

我想启动一个 EC2 Windows 实例，上传一个 EXEecutable 并执行它（全部以**自动化方式**，这很重要）

到目前为止，我能够以编程方式启动 EC2 Windows 实例并获取其参数（密码/IP），现在我想找到一种方法来上传这个可执行文件（**从我的 Windows 机器或从我的其他 EC2 linux 实例**）并运行它.

我考虑过启动 RDP 连接并使用宏软件上传和执行文件，但根据以前的经验，这至少可以说是一种糟糕/脆弱的方法。

我也想过把这个 EXE 上传到服务器，然后在 Windows 上做这样的事情：

```
wget http://www.domain.com/my-file.exe 
```

除了Windows*没有*wget！

所以我的问题是：**有没有办法在 EC2 Windows 实例中以编程方式上传和执行可执行文件？**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T07:19:16.393

另一种方法是使用 Windows powershell 和 WinRM - 它允许远程执行，有点像 Linux 上的 ssh。

这是您可以在客户端上运行以远程执行脚本的 powershell 脚本示例（取自：[https ://github.com/CloudifySource/cloudify/blob/master/esc/src/main/resources/clouds/ec2 -win/upload/bootstrap-client.ps1](https://github.com/CloudifySource/cloudify/blob/master/esc/src/main/resources/clouds/ec2-win/upload/bootstrap-client.ps1)）：

```
param ([string]$target, [string]$username, [string]$password, [string]$command)

$ErrorActionPreference="Stop"

# Set up the password
$securePassword = ConvertTo-SecureString -AsPlainText -Force $password
$cred = New-Object System.Management.Automation.PSCredential $username, $securePassword

Write-Host "Connecting to management service of $target"
Connect-WSMan -Credential $cred $target 

set-item WSMan:\$target\Client\TrustedHosts -Value * -Force
set-item WSMan:\$target\Shell\MaxMemoryPerShellMB -Value 0 -Force

Write-Host Invoking command on Remote host $target
Invoke-Command -ComputerName $target -Credential $cred  -ScriptBlock {  
    Invoke-Expression $args[0]
} -ArgumentList $command
Write-Host "Command finished" 
```

您可以使用以下命令从您自己的脚本中运行此命令：

```
powershell.exe -inputformat none -File PATH_TO_SCRIPT -target TARGET_IP -password PASSWORD -username USERNAME -command COMMAND_TO_EXECUTE 
```

您可能应该引用您的字符串，尤其是密码和命令，因为它们通常具有 powershell 可以解释为其他内容的特殊字符。

WinRM 服务在 EC2 Amazon Windows AMI 上默认开启。您需要做的就是在您的安全组中打开端口 5985（WinRM 端口）。

最后，如果您以前从未在客户端计算机上使用过 powershell 远程处理，您应该执行几个命令来设置它（您只需执行一次）：

```
set-item WSMan:\localhost\Client\TrustedHosts -Value * -Force
set-item WSMan:\localhost\Shell\MaxMemoryPerShellMB -Value 0 -Force
Enable-PSRemoting
Set-ExecutionPolicy unrestricted 
```

确保以管理员身份运行这些。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-20T15:11:10.977

该命令`ec2-run-instances`有两个附加参数，可在运行该命令时使用。该`user-data`命令和`user-data-file`它们都执行相同的任务，只是它们从不同的输入中读取。当您使用此参数时，用户数据的内容将上传到亚马逊托管的 URI，该 URI`http://169.254.169.254/1.0/user-data`仅适用于已启动的实例。

在 linux 环境中执行此操作的正常方法是将 shell 脚本上传到实例以下载 exe，您的用户数据文件可能看起来像这样......

```
#! /bin/bash
wget http://www.domain.com/my-file.exe 
```

在 Windows 中，没有安装默认服务来在实例启动时执行用户数据文件，但是有一个开源项目[CloudInit.NET](https://github.com/bwight/CloudInit.NET)，它模拟了相同的过程，但使用了 powershell 脚本。唯一的要求是 .NET 4.0 和 CloudInit.NET。安装后，它将在实例启动时执行用户数据文件。下载文件并使用 powershell 脚本执行它非常容易。

```
!# /powershell/
$wc = New-Object System.Net.WebClient
$wc.DownloadFile("http://www.domain.com/my-file.exe", "C:\my-file.exe");
& 'C:\my-file.exe' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T22:00:29.660

您可以通过两种方式处理此问题，

*   在 Windows SFTP 程序中使用 winscp。

    要在 Windows 上使用 SFTP 访问您的 Amazon 服务器，请下载 Windows SFTP 应用程序。使用 WinSCP，您将与您的服务器建立 SFTP 会话。WinSCP 提供了一些不错的功能，可以轻松使用您的 EC2 服务器。例如，按钮栏中的命令使用您用于 SFTP 会话的相同凭据打开一个 PuTTY SSH 终端会话。（您也可以通过单击 CTRL+P 来启动 PuTTY 会话。）。

*   获取一个 S3 存储桶并安装在您的所有 Windows 和 linux EC2 实例上。您应该能够从您的工作站将文件上传和下载到 S3 存储桶，您的实例可以访问这些存储桶。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T16:52:59.617

这听起来像是 CloudFormation 的完美用例。我创建了一个演示模板。要使用，请将您的可执行文件放在 S3 存储桶中，并使用以下模板创建一个新的 CloudFormation 堆栈。它将从 S3 下载您的可执行文件并运行它。注意：该模板使用内置[CloudFormationScripts的特殊](http://aws.amazon.com/developertools/4026240853893296)[AMI](https://aws.amazon.com/amis/microsoft-windows-server-2008-r2-base-cloudformation)。

```
{
    "AWSTemplateFormatVersion" : "2010-09-09",
    "Description" : "Spot Autoscaling for installing and running Windows Services.",
    "Parameters" : {
        "InstanceType" : {
            "Description" : "WebServer EC2 instance type",
            "Type" : "String",
            "Default" : "m1.small",
            "AllowedValues" : ["t1.micro", "m1.small", "m1.medium", "m1.large", "m1.xlarge", "m2.xlarge", "m2.2xlarge", "m2.4xlarge", "c1.medium", "c1.xlarge", "cc1.4xlarge", "cc2.8xlarge", "cg1.4xlarge"],
            "ConstraintDescription" : "must be a valid EC2 instance type."
        },
        "KeyName" : {
            "Description" : "The EC2 Key Pair to get Admin password to Instance.",
            "Type" : "String"
        },
        "DeployS3Bucket" : {
            "Description" : "The S3 Bucket where deploy files are stored",
            "Type" : "String"
        },
        "DeployS3Key" : {
            "Description" : "The exe file that runs on startup",
            "Type" : "String"
        }
    },
    "Mappings" : {
        "RegionToAMIMap" : {
            "us-east-1" : {
                "AMI" : "ami-60b90609"
            },
            "us-west-1" : {
                "AMI" : "ami-5bd6f11e"
            },
            "eu-west-1" : {
                "AMI" : "ami-07151573"
            },
            "ap-southeast-1" : {
                "AMI" : "ami-6ab5f538"
            },
            "ap-northeast-1" : {
                "AMI" : "ami-424ff043"
            }
        }
    },
    "Resources" : {
        "IAMUser" : {
            "Type" : "AWS::IAM::User",
            "Properties" : {
                "Path" : "/",
                "Policies" : [{
                    "PolicyName" : "root",
                    "PolicyDocument" : {
                        "Statement" : [{
                            "Effect" : "Allow",
                            "Action" : "*",
                            "Resource" : "*"
                        }]
                    }
                }]
            }
        },
        "IAMUserAccessKey" : {
            "Type" : "AWS::IAM::AccessKey",
            "Properties" : {
                "UserName" : {
                    "Ref" : "IAMUser"
                }
            }
        },
        "SecurityGroup" : {
            "Type" : "AWS::EC2::SecurityGroup",
            "Properties" : {
                "GroupDescription" : "Enable RDP",
                "SecurityGroupIngress" : [{
                    "IpProtocol" : "tcp",
                    "FromPort" : "3389",
                    "ToPort" : "3389",
                    "CidrIp" : "0.0.0.0/0"
                }]
            }
        },
        "RunExecutable" : {
            "Type" : "AWS::EC2::Instance",
            "Metadata" : {
                "AWS::CloudFormation::Init" : {
                    "config" : {
                        "files" : {
                            "c:\\ToRun\\executable.exe" : {
                                "source" : {
                                    "Fn::Join" : ["/", ["http://s3.amazonaws.com", {
                                        "Ref" : "DeployS3Bucket"
                                    }, {
                                        "Ref" : "DeployS3Key"
                                    }]]
                                },
                                "authentication" : "S3AccessCreds"
                            }
                        },
                        "commands" : {
                            "1-run-executable" : {
                                "command" : "c:\\ToRun\\executable.exe"
                            }
                        }
                    }
                },
                "AWS::CloudFormation::Authentication" : {
                    "S3AccessCreds" : {
                        "type" : "S3",
                        "accessKeyId" : {
                            "Ref" : "IAMUserAccessKey"
                        },
                        "secretKey" : {
                            "Fn::GetAtt" : ["IAMUserAccessKey", "SecretAccessKey"]
                        },
                        "buckets" : [{
                            "Ref" : "DeployS3Bucket"
                        }]
                    }
                }
            },
            "Properties" : {
                "KeyName" : {
                    "Ref" : "KeyName"
                },
                "ImageId" : {
                    "Fn::FindInMap" : ["RegionToAMIMap", {
                        "Ref" : "AWS::Region"
                    }, "AMI"]
                },
                "SecurityGroups" : [{
                    "Ref" : "SecurityGroup"
                }],
                "InstanceType" : {
                    "Ref" : "InstanceType"
                },
                "UserData" : {
                    "Fn::Base64" : {
                        "Fn::Join" : ["", ["<script>\n", "cfn-init.exe -v -s ", {
                            "Ref" : "AWS::StackName"
                        }, " -r RunExecutable ", " --access-key ", {
                            "Ref" : "IAMUserAccessKey"
                        }, " --secret-key ", {
                            "Fn::GetAtt" : ["IAMUserAccessKey", "SecretAccessKey"]
                        }, "\n", "</script>"]]
                    }
                }
            }
        }
    },
    "Outputs" : {}
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-30T11:42:04.847

早在 2011 年，我就为 AWS 进行了类似的企业部署自动化。当时亚马逊云形成和 opsworks 仍在建设中。但是我们已经成功地使用 dotnet 为 linux 和 windows 平台完成了部署自动化。排除了 powershell 和 ftp 模型因为是企业环境，有端口限制。以下是我使用的方法。

注意：这是 asp.net 网络应用程序

## 用于 linux 部署。

我们使用了一个名为sharpshell（sharpSSH）的开源项目。这是一个模拟windows和linux之间shell通信的c#应用程序。只需要提供目标aws地址和安全密钥即可连接。我们围绕我们的要求定制了应用程序

## 对于窗户

话虽如此，云形成 API 仍然不可用，AWS 可用的文档也更少。我们使用了一种解决方法，即 Web 服务方法。创建了一个网络服务，它基本上将文件上传到服务器并部署。使用托管在 amazaon windows server.Created 基础图像的这个网络服务器和证书。最后，从此映像创建的新实例将托管 Web 服务，可以调用它来上传部署包并安装在该系统上。

虽然上面的 startergies 不是万无一失的并且控制较少。我们实现了从 windows 到 linux 的跨平台直接部署的功能，而无需使用 S3 bucket 或 powershell。

如果您需要任何澄清，请告诉我。

干杯! 查尔斯

# facebook - Facebook喜欢按钮没有列出我的朋友

> ID：10237089
> 
> 赞同：0
> 
> 时间：2012-04-19T21:30:10.257
> 
> 标签：facebook, facebook-like

我的网站上有带有面孔的“赞”按钮，它收集了 7 个赞，其中一些是我的朋友（显示的面孔），有些不是（未显示的面孔）。

在过去几个月的某个时间点（无法跟踪我所有的页面，所以我不知道确切的信息），有些东西坏了，所以按钮不再列出任何朋友。它只是显示“成为你的第一个喜欢这个的朋友”。点赞数仍然是 7，但我不知道他们是谁。

1）我绝对确定我不是所有这些人都没有成为朋友。2) 我很确定 iframe、代码等没有改变。它刚刚停止工作。3）通过 linter 运行链接没有帮助。linter 没有报告任何错误/警告。4) 增加 iframe 高度似乎没有帮助 5) 从某些页面消失的图片仍然显示在其他页面中的相同朋友（由相同的 php 生成，因此正确），这似乎证明这不是隐私问题，此外，这么多人怎么会有隐私问题？

这完全打败了我，有什么想法吗？请参阅下面的一些链接。

[http://www.great-passage.com/?photoId=59](http://www.great-passage.com/?photoId=59)

[http://www.great-passage.com/?photoId=98](http://www.great-passage.com/?photoId=98)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:57:55.343

它为我显示了 7 个赞

![在此处输入图像描述](../Images/43b922dd85a0821569e911f98534537f.png)

我认为正在发生的事情。您已注销 Facebook 或以其他用户身份登录并查看网页。尝试切换登录和关闭并刷新浏览器缓存，看看它是否改变。

验证这里发生的事情的最佳方法是查看幕后情况。

打开 Graph 调用 URL

[https://graph.facebook.com/?ids=http://www.great-passage.com/?photoId=59](https://graph.facebook.com/?ids=http://www.great-passage.com/?photoId=59)

```
{
   "http://www.great-passage.com/?photoId=59": {
      "id": "http://www.great-passage.com/?photoId=59",
      "shares": 7
   }
} 
```

[https://graph.facebook.com/?ids=http://www.great-passage.com/?photoId=98](https://graph.facebook.com/?ids=http://www.great-passage.com/?photoId=98)

```
{
   "http://www.great-passage.com/?photoId=98": {
      "id": "http://www.great-passage.com/?photoId=98",
      "shares": 23
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T08:12:52.213

当我查看您的源代码时，我看到：

```
<div id="like" class="transparent"><iframe src="http://www.facebook.com/plugins/like.php?app_id=174634935928464&amp;href=http%3A%2F%2Fwww.great-passage.com%2F%3FphotoId%3D59&amp;send=false&amp;layout=button_count&amp;width=100&amp;show_faces=false&amp;action=like&amp;colorscheme=dark&amp;font=arial&amp;height=20" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:20px;" allowTransparency="true"></iframe></div> 
```

你看到 show_faces=false 我相信应该是 =true

# iphone - 寻找有条件地在 iPad 上的 HTML 中包含“img src=”而不是 iPhone 的方法

> ID：10237092
> 
> 赞同：2
> 
> 时间：2012-04-19T21:30:26.697
> 
> 标签：iphone, html, ios, mobile-safari

尝试编写包含在 iOS 上的应用程序中的 html 帮助文件。

对于 iPad 版本，我希望帮助文件显示一个较小的图形（大约 156x204）。
对于 iPhone / iPod，我不想显示图形。

除了在文件 h_login.html 中使用类似以下的 javascript：

`if ((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) { location.replace("h_small_login.html");`

这需要每个文件的克隆，我还没有找到方法。

宁愿继续使用最少的 HTML ... vanilla，没有 CSS，在开始时使用单个“元”来指定：元名称 =“视口”内容 =“宽度=设备宽度；初始规模=1.5；最大规模=4.0；用户可扩展=1；"

谢谢！斯坦

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T21:33:51.953

到目前为止，最简单的方法是使用媒体查询。我相当肯定 i-Devices 支持 CSS 的这个特性：

```
@media screen and (max-device-width: 600px) {
   img.hide {display:none;}
} 
```

只需添加`class="hide"`相关图像，然后调整`600px`（我不知道 iPhone 和 iPad 的分辨率是多少，但只需将其更改为`600`两者之间的任何值）。

这样做比尝试让 JavaScript 做同样的事情要容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:38:42.963

jQuery 可以轻松做到这一点：

```
if ((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {
    $("img").attr("display","none");
} 
```

当用户代理是 iPhone 或 iPod 时，这将从文档中删除所有图像。如果您没有使用 jQuery，但您使用的是服务器端脚本，我们需要知道您使用的是什么语言。如果您只是直接使用 HTML，那么 JavaScript 是您修改页面的唯一方法，而 jQuery 将是您的最佳选择。

# android - 从互联网获取图像并将它们动态存储在 Android 的内部存储器中

> ID：10237094
> 
> 赞同：0
> 
> 时间：2012-04-19T21:30:39.547
> 
> 标签：android, image, dynamic, gallery, imageswitcher

我有一个 Activity 用作图片库并且效果很好。但它从具有可绘制对象引用的整数数组中加载图像。我想做的是从互联网上获取图像并将它们存储在内部存储器中，然后在我的画廊中使用它们。

下面是我的代码。任何帮助将不胜感激。

```
import okan.apps.tabbar.R;
import android.app.Activity;
import android.os.Bundle;
import android.util.Log;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;
import android.view.animation.AnimationUtils;
import android.widget.ImageSwitcher;
import android.widget.ImageView;
import android.widget.ViewSwitcher.ViewFactory;

 public class Activities extends Activity implements ViewFactory {

ImageSwitcher imageSwitcher ;

Integer[] imageList = {
        R.drawable.gallery,
        R.drawable.menu,
        R.drawable.promotion,
        R.drawable.info,
        R.drawable.activities       
};

int curIndex=0;
int downX,upX;

@Override
public void onCreate(Bundle savedInstanceState) {
     super.onCreate(savedInstanceState);  
     setContentView(R.layout.activities_main);

     imageSwitcher = (ImageSwitcher) findViewById(R.id.imageSwitcher);
     imageSwitcher.setFactory(this);
     imageSwitcher.setInAnimation(AnimationUtils.loadAnimation(this,android.R.anim.fade_in));
     imageSwitcher.setOutAnimation(AnimationUtils.loadAnimation(this,android.R.anim.fade_out));

     imageSwitcher.setImageResource(imageList[curIndex]);
     imageSwitcher.setOnTouchListener(new OnTouchListener() {
     public boolean onTouch(View v, MotionEvent event) {

         if (event.getAction() == MotionEvent.ACTION_DOWN) {
             downX = (int) event.getX(); 
             Log.i("event.getX()", " downX " + downX);
             return true;
         } 

         else if (event.getAction() == MotionEvent.ACTION_UP) {
             upX = (int) event.getX(); 
             Log.i("event.getX()", " upX " + downX);
             if (upX - downX > 100) {

                 //curIndex  current image index in array viewed by user
                 curIndex--;
                 if (curIndex < 0) {
                     curIndex = imageList.length-1;
                 }

                 imageSwitcher.setInAnimation(AnimationUtils.loadAnimation(Activities.this,R.anim.slide_in_left));
                 imageSwitcher.setOutAnimation(AnimationUtils.loadAnimation(Activities.this,R.anim.slide_out_right));

                 imageSwitcher.setImageResource(imageList[curIndex]);
                 //GalleryActivity.this.setTitle(curIndex);
             } 

             else if (downX - upX > -100) {

                 curIndex++;
                 if (curIndex > 4) {
                     curIndex = 0;
                 }

                 imageSwitcher.setInAnimation(AnimationUtils.loadAnimation(Activities.this,R.anim.slide_in_right));
                 imageSwitcher.setOutAnimation(AnimationUtils.loadAnimation(Activities.this,R.anim.slide_out_left));

                 imageSwitcher.setImageResource(imageList[curIndex]);
                 //GalleryActivity.this.setTitle(curIndex);
             }
                 return true;
             }
             return false;
         }
     });
}
public View makeView() {
    ImageView i = new ImageView(this);  
    i.setScaleType(ImageView.ScaleType.FIT_CENTER);
    return i;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:52:58.453

使用类似[https://github.com/nostra13/Android-Universal-Image-Loader](https://github.com/nostra13/Android-Universal-Image-Loader)的东西。或者您可以查看[https://github.com/cyrilmottier/GreenDroid](https://github.com/cyrilmottier/GreenDroid)中的代码。我个人喜欢第一个，因为它只专注于图像加载。

# android - 在选项卡单击上播放声音

> ID：10237097
> 
> 赞同：0
> 
> 时间：2012-04-19T21:30:48.367
> 
> 标签：android, android-widget

在 AT&T 的 Android 手机上，您可以在浏览选项卡时听到咔嗒声。如何让 Tab 小部件在单击选项卡时播放声音？

```
tabHost.setOnTabChangedListener(new OnTabChangeListener() {
    @Override
    public void onTabChanged(String tabId) {
        //PLAY SOUND HERE
        MediaPlayer tabClick = MediaPlayer.create(TabBarActivity.this, R.Raw.gling_click);
        tabClick.start();
    }
)}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:38:53.207

本教程的第 1 步是这样的：

```
for(int i=0;i<tabHost.getTabWidget().getChildCount();i++)  
{  
    tabHost.getTabWidget().getChildAt(i).setBackgroundResource(R.drawable.bg_blue_matte);  
}  
    tabHost.getTabWidget().setCurrentTab(1);  
    tabHost.getTabWidget().getChildAt(1).setBackgroundResource(R.drawable.bg_green_matte);  

    //NEW CODE HERE **
    tabHost.setOnTabChangedListener(new OnTabChangeListener() {

        @Override
        public void onTabChanged(String tabId) {
            //PLAY SOUND HERE
        }

    )}; 
```

看到这里写着新代码**？您想将 OnTabChangedListener 添加到 tabHost。这是一个“监听”用户更改选项卡的对象。当标签更改时，该`onTabChanged(String tabID)`方法将运行。

添加`onTabChangedListener`后面的教程步骤1；它在`onCreate()`方法之内。

然后，上谷歌并查找`android play a sound`并将*该*代码放入其中显示//在此处播放声音的位置。

# sql-server - 在 VS2010 和 SQL Server 2012 Express 上编译或运行应用程序时出错

> ID：10237100
> 
> 赞同：1
> 
> 时间：2012-04-19T21:30:49.963
> 
> 标签：sql-server, visual-studio-2010, sql-server-2012-express

尝试编译或运行应用程序时出现错误。

执行一个[简单的教程](http://www.tanguay.info/web/index.php?pg=tutorials&id=4&section=5)，我起初工作，但现在当我生成项目 F6 或尝试运行它时，我总是得到错误

> `Error 1 Unable to copy` `"C:\Projects\DatabaseExampleApp\DatabaseExampleApp\App_Data\northwnd.mdf" to "bin\Debug\App_Data\northwnd.mdf". The process can not access the file 'bin\Debug\App_Data\northwnd.mdf' because it is being used by another process. DatabaseExampleApp`

我第一次运行该应用程序时运行良好

我正在使用：

*   Visual Studio 2010 专业版
*   SQL Server 2012 Express 64 位

### 编辑：

后：

*   杀死`sqlservr.exe`（是文件柜）
*   自己删除文件`northwnd.* northwnd_log.*`
*   生成项目 F6
*   运行应用程序工作正常

但我有一个问题：

*   如何杀死或卸载文件`northwnd.mdf`以避免此问题？

之后应用程序编译但不运行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T04:51:37.877

您没有向我们展示您的**连接字符串**，但我假设您正在使用某种`AttachDbFileName=....`方法。

我对此的建议是：不要那样做。摆弄`.mdf`文件，直接按位置指定它们很麻烦，当 Visual Studio 想要复制该文件时，您会遇到问题 - 忘记所有这些。

我会

*   在 SQL Server Express 实例上创建数据库（`CREATE DATABASE .....`在 Mgmt Studio 中）
*   *通过其逻辑名称*与数据库对话- 而不是物理文件名

所以我会将我的数据库放到 SQL Server Express 服务器实例上，然后使用类似这样的连接字符串：

```
 Server=.\SQLEXPRESS;Database=MyShinyDatabase;Integrated Security=SSPI; 
```

没有杂乱的文件名，Visual Studio 不必在运行时复制文件或任何东西，您的数据在服务器上，可以在那里使用和管理 - 对我来说似乎是更干净、更好的方法。

# redirect - 捕获 302 错误，然后在骨干网同步方法覆盖中重定向

> ID：10237103
> 
> 赞同：5
> 
> 时间：2012-04-19T21:31:11.107
> 
> 标签：redirect, backbone.js, coffeescript, sync, http-status-code-302

我想要做的是捕获 302 错误，这意味着用户未登录，然后将该用户重定向到网站的登录页面。这是我现在的backbone.js同步覆盖：

```
parentSynchMethod = Backbone.sync
Backbone.sync = (method, model, success, error) -> 
  try
    parentSynchMethod.apply(Backbone, arguments)
  catch error
    window.location.replace("http://localhost:8080/login") 
```

302 错误肯定会发生，当我使用谷歌浏览器检查页面时，我可以在网络视图中看到它。但是，当我设置断点时，它永远不会进入 catch 内部，并且错误参数是未定义的。这是因为 302 不是真正的错误（当我查看响应的状态时它是黄色的，而不是通常的红色错误，或者我在某处弄乱了代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-19T22:51:48.360

当 AJAX 请求返回错误条件（是的，302 是错误）时，默认`Backbone.sync`不会引发异常，它将错误处理留给`$.ajax`. 默认`sync` [如下所示](https://github.com/documentcloud/backbone/blob/master/backbone.js#L1315)：

```
Backbone.sync = function(method, model, options) {
  // A bunch of bureaucratic setup and what not...

  // Make the request, allowing the user to override any Ajax options.
  return Backbone.ajax(_.extend(params, options));
}; 
```

并且`Backbone.ajax`只是`$.ajax`；注意以上是Backbone当前的master分支，当前发布的版本`$.ajax`直接使用。

你想要做的是用`Backbone.sync`总是强制错误处理程序的东西替换，如下所示：

```
error: (xhr, text_status, error_thrown) ->
    if(xhr.status == 302)
        window.location.replace('http://localhost:8080/login')
    else
        # call the supplied error handler if any 
```

这样的事情应该可以解决问题：

```
parentSynchMethod = Backbone.sync
Backbone.sync = (method, model, options) ->
    old_error = options.error
    options.error = (xhr, text_status, error_thrown) ->
        if(xhr.status == 302)
            window.location.replace('http://localhost:8080/login')
        else
            old_error?(xhr, text_status, error_thrown)
    parentSyncMethod(method, model, options) 
```

如果您正在使用 Backbone 的主分支（或`Backbone.ajax`在发布版本中阅读此内容），那么您可以替换`Backbone.ajax`为强制执行上述错误处理程序的内容，而不要`Backbone.sync`理会。

# c# - 如果不确定要匹配哪些属性，如何将 Where 表达式添加到 LINQ 查询？

> ID：10237106
> 
> 赞同：0
> 
> 时间：2012-04-19T21:31:34.960
> 
> 标签：c#, asp.net, linq

我有一种情况，我可能想按订单号或名称进行搜索。我知道我可以`Where`在我的 LINQ 查询中添加一个表达式，但我只想为我正在搜索的属性添加它！在调用该方法之前我不知道将提供哪个参数，那么如何添加适当的条件？

```
public JsonResult Search(int orderNo=0, string firstName="", string lastName="")
{
    if (orderNo >0){
        //add Condition
    }

    if (firstName.Length > 0){
        //add Condition
    }

    if (lastName.Length > 0){
        //add Condition
    }

    //get Result

    var result = Repository.Orders.Where(???).OrderByDescending(e=> e.orderNo);

    //return
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T21:37:37.710

以下假设 Repository.Orders 返回一个`IQueryable`，但想法只是动态添加您需要的表达式。查询的[执行是延迟的](http://www.hanselman.com/blog/BackToBasicsBigONotationIssuesWithOlderNETCodeAndImprovingForLoopsWithLINQDeferredExecution.aspx)，因此您可以在实际询问结果之前系统地构建它。

```
// You haven't executed the query yet, you can still build up what you need
var query = Repository.Orders;

if(orderNo >0){
    // You STILL haven't actually executed the query.
    query.Where(x => x.orderNo == orderNo);
}
if(firstName.Length > 0){
    query.Where(x => x.firstname == firstName);
}
if(lastName.Length > 0){
    query.Where(x => x.lastName == lastName);
}

// Even with this, you STILL aren't actually executing the query.
query.OrderByDescending(x => x.orderNo);

// You'll be executing and enumerating the results here, but that's OK because you've fully defined what you want.
return Json(query.ToArray(), JsonRequestBehavior.AllowGet); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T21:37:17.570

假设您的存储库返回`IQueryable`，您可以根据需要编写查询：

```
var query = Repository.Orders;
if(orderNo > 0)
{
    query = query.Where( x => x.OrderId == orderNo);
}

if(firstName.Length > 0)
{
   query = query.Where( x => x.FirstName == firstName);
}
//... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T21:37:46.043

```
var result = Repository.Orders.Where(x => 
    (firstName == null || firstName.Trim() == "" || x.FirstName.Contains(firstName)) 
    && (lastName == null || lastName.Trim() == "") || x.LastName.Contains(lastName)) 
    && (orderNo == 0 || x.OrderNo == orderNo)).OrderByDescending(x => x.OrderNo) 
```

@Amit_g 的示例也可以，并且可以说更容易阅读。我喜欢在一个查询中完成所有操作。这是一个偏好问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T21:38:47.600

如果您必须 AND 这些条件并假设您的存储库返回[IQueryable](http://msdn.microsoft.com/en-US/library/system.linq.iqueryable.aspx)（如果不更改它或添加另一个重载或其他东西）

```
var query = Repository.Orders

// Build where clause

if (orderNo >0){
    query = query.Where(o => o.OrderNo == orderNo);
}

if (firstName.Length > 0){
    query = query.Where(o => o.FirstName == firstName);
}

if (lastName.Length > 0){
    query = query.Where(o => o.LastName == lastName);
}

// Build OrderBy clause

query = query.OrderByDescending(o => o.orderNo);

// Execute Query

results = query.ToList(); 
```

# delphi - 将 C++ 指针代码转换为 delphi

> ID：10237110
> 
> 赞同：0
> 
> 时间：2012-04-19T21:31:52.583
> 
> 标签：delphi, unmanaged

这是我想从 Delphi 调用的 C++ 头文件中的一个函数：

```
 * @param hConnection Handle to the connection to FM.
 * @param pOperation See description of ABS_OPERATION.
 * @param dwTemplateCount Count of templates in the pTemplateArray.
 * @param pTemplateArray Pointer to the array of pointers to templates.
 * @param pResult Pointer to memory location, where result of the comparing 
 */
ABS_STATUS BSAPI ABSVerify(
    IN ABS_CONNECTION hConnection,
    IN ABS_OPERATION* pOperation,
    IN ABS_DWORD dwTemplateCount,
    IN ABS_BIR** pTemplateArray,
    OUT ABS_LONG* pResult,
    IN ABS_DWORD dwFlags
); 
```

-- 定义

```
/** 
 * The header of the BIR. This type is equivalent to BioAPI's structure 
 * BioAPI_BIR_HEADER. 
 */
typedef struct abs_bir_header {
  ABS_DWORD Length;     ///< Length of Header + Opaque Data
  ABS_BYTE HeaderVersion;   ///< HeaderVersion = 1
  ABS_BYTE Type;    ///< Type = 4 (BioAPI_BIR_DATA_TYPE_PROCESSED)
  ABS_WORD FormatOwner;     ///< FormatOwner = 0x12 (STMicroelectronics)
  ABS_WORD FormatID;    ///< FormatID = 0
  ABS_CHAR Quality;     ///< Quality = -2 (BioAPI_QUALITY is not supported)
  ABS_BYTE Purpose;     ///< Purpose (BioAPI_PURPOSE_xxxx, ABS_PURPOSE_xxxx).
  ABS_DWORD FactorsMask;    ///< FactorsMask = 0x08 (BioAPI_FACTOR_FINGERPRINT)
} ABS_BIR_HEADER;

/** 
 * A container for biometric data. 
 */
typedef struct abs_bir {
  ABS_BIR_HEADER Header;    ///< BIR header
  ABS_BYTE Data[ABS_VARLEN];    ///< The data composing the fingerprint template.
} ABS_BIR;

  struct abs_operation;
typedef struct abs_operation ABS_OPERATION;  /* forward declaration */

/** 
 * A type of the callback function that an application can supply to 
 * the BSAPI to enable itself to display GUI state information to user. 
 * 
 * @param pOperation Pointer to ABS_OPERATION structure used when calling the interactive operation.
 * @param dwMsgID ID of message. See description of ABS_MSG_xxxx constants.
 * @param pMsgData Pointer to data with additional information related with 
 * the message. 
 */
typedef void (BSAPI  *ABS_CALLBACK) ( const ABS_OPERATION*, ABS_DWORD, void*); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:46:34.987

大概是这样的：

```
function ABSVerify(
    hConnection: Integer;
    Operation: PABS_OPERATION;
    dwTemplateCount: DWORD;
    pTemplateArray: PPABS_BIR;
    var pResult: Integer;
    dwFlags: DWORD
): Integer; stdcall; external 'bsapi.dll'; 
```

有点朦胧的东西是`ABS_OPERATION`。因为那是一个`IN`参数，但它作为指向 的指针传递`ABS_OPERATION`，我想它是一个`struct`. 您需要为它声明一个匹配的 Delphi 记录和一个指针类型。也许是这样的：

```
type
  ABS_OPERATION = record
    field1: Integer;
    field2: Integer;
    //etc.
  end;
  PABS_OPERATION = ^ABS_OPERATION; 
```

另一个需要注意的参数是`pTemplateArray`：

> pTemplateArray 指向模板指针数组的指针。

这是一个指针数组。C 中的数组作为指向第一个元素的指针传递。这就解释了类型，`ABS_BIR**`指向第一个元素的指针，它本身就是一个指向的指针`ABS_BIR`。

```
type
  ABS_BIR = ... //whatever it is
  PABS_BIR = ^ABS_BIR;
  PPABS_BIR = ^PABS_BIR; 
```

您可以像这样调用该函数：

```
var
  TemplateArray: array of PABS_BIR;
...
  SetLength(TemplateArray, dwTemplateCount);
  // populate TemplateArray
  returnval := ABSVerify(..., dwTemplateCount, @TemplateArray[0], ...); 
```

我现在看到您已在编辑中添加了结构定义。我将把我编造的结构留在这里，因为您应该能够自己转换这些结构。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:38:49.353

您将不得不检查`BSAPI`解决的问题。我假设`stdcall`：

```
type
  PABS_OPERATION = ^ABS_OPERATION;
  PABS_BIR = ^ABS_BIR;
  PPABS_BIR = ^PABS_BIR;
  PABS_LONG = ^ABS_LONG;

function ABSVerify( 
    hConnection: ABS_CONNECTION;
    pOperation: PABS_OPERATION;
    dwTemplateCount: ABS_DWORD;
    pTemplateArray: PPABS_BIR;
    pResult: PABS_LONG;
    dwFlags: ABS_DWORD
): ABS_STATUS; stdcall; 
```

或者：

```
type
  PABS_BIR = ^ABS_BIR;

function ABSVerify( 
    hConnection: ABS_CONNECTION;
    var pOperation: ABS_OPERATION;
    dwTemplateCount: ABS_DWORD;
    var pTemplateArray: PABS_BIR;
    out pResult: ABS_LONG;
    dwFlags: ABS_DWORD
): ABS_STATUS; stdcall; 
```

# objective-c - Singleton 中的 NSAssert ：为什么此代码有效？

> ID：10237111
> 
> 赞同：2
> 
> 时间：2012-04-19T21:31:55.327
> 
> 标签：objective-c, singleton, nsassert

我不明白 NSAssert 在中的使用`+alloc`，当`+alloc`从 调用时`+sharedGameManager`，静态`_sharedGameManager`变量是`nil`（所以`NSAssert`应该在第一次`[self alloc] init]`调用时停止执行......）

```
+(GameManager*)sharedGameManager {
    @synchronized([GameManager class])                             
    {
        if(!_sharedGameManager)                                    
            [[self alloc] init]; 
        return _sharedGameManager;                                 
    }
    return nil; 
}

+(id)alloc 
{
    @synchronized ([GameManager class])                            
    {
        NSAssert(_sharedGameManager == nil,
                 @"Attempted to allocated a second instance of the Game Manager singleton");
        _sharedGameManager = [super alloc];
        return _sharedGameManager;                                 
    }
    return nil;  
} 
```

感谢您的回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T23:09:40.980

您是否以错误的方式考虑 NSAssert？

```
NSAssert( _sharedGameManager==nil, @"Attempted to …"); 
```

**如果 _sharedGameManager不**为零，将抛出异常。它断言表​​达式为 TRUE，它说“我断言一定是这种情况”，因此`_sharedGameManager`必须为 nil，否则会引发异常。仅当您尝试创建此类的 2 个实例时，才会发生这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:21:07.767

通过 Grand Central Dispatch 有更好的方法来保证您想要的行为：

```
+ (GameManager *)sharedGameManager {
    static GameManager *sharedGameManager = nil;
    static dispatch_once_t token;
    dispatch_once(&token, ^{
        sharedGameManager = [[GameManager alloc] init];
    });

    return sharedGameManager;
} 
```

`dispatch_once`保证只运行一次，所以你的游戏管理器不会被过度初始化。只要您不释放它，它就会保持活动状态，并且会在程序结束时正确释放（因为它的`static`上下文）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T21:48:53.800

这看起来像是粘在一起的几个片段；alloc 是实例方法，而不是类方法（静态）。如果要执行单例类的初始化，请使用`+(void)initialize`

Objective-C 运行时声称保证此类方法只执行一次，因此它是设置单例的有效机制。如需进一步阅读，请点击 Mike Ash关于该主题的[博客文章。](http://www.mikeash.com/pyblog/friday-qa-2009-09-18-intro-to-grand-central-dispatch-part-iv-odds-and-ends.html)

# sql - 一起使用 sqldf 和 RPostgreSQL

> ID：10237113
> 
> 赞同：15
> 
> 时间：2012-04-19T21:32:15.033
> 
> 标签：sql, r, postgresql, sqldf, rpostgresql

使用时`RPostgreSQL`我发现我不能`sqldf`以相同的方式使用。例如，如果我使用以下代码加载库并将数据读入数据框中：

```
library(RPostgreSQL)
drv <- dbDriver("PostgreSQL")
con <- dbConnect(drv, host="localhost", user="postgres", password="xxx", dbname="yyy", port="5436")
rs <- dbSendQuery(con, "select * from table");                           
df<- fetch(rs, n = -1); dbClearResult(rs) 
dbDisconnect(con) 
```

我知道数据框中有这张表的内容`df`。但是，如果我想使用`sqldf`之前运行 SQL 命令，我会执行以下操作：

```
sqldf("SELECT * FROM df WHERE X > 10") 
```

当我收到错误消息时，这不再有效：

```
Error in postgresqlNewConnection(drv, ...) : 
  RS-DBI driver: (could not connect postgres@localhost on dbname "test"
)
Error in !dbPreExists : invalid argument type 
```

我认为这是我的操作员错误，但我不知道如何提供哪些参数，`sqldf`以便它只关注数据框而不尝试连接到其他任何东西。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-19T21:57:06.810

**将 sqldf 与 RPostgreSQL 一起使用**

`sqldf``test`如果发现 RPostgreSQL 已加载，它将自动使用 PostgreSQL 中的数据库。所以你可以在 PostgreSQL 中创建一个`test`数据库，然后使用 sqldf

或者，您可以指定不同数据库的名称。

请参阅：[sqldf 常见问题解答 12](https://cran.r-project.org/web/packages/sqldf/README.html#12-how-does-one-use-sqldf-with-postgresql)

**将 sqldf 与 RSQLite 一起使用**

如果您想将 sqldf 与 RSQLite 一起使用而不是与 RPostgreSQL 一起使用，您可以使用`sqldf`'`drv`参数强制它使用非默认驱动程序。例如

```
sqldf("select foo from bar...",drv="SQLite") 
```

`"sqldf.driver"`或者，您可以使用该选项全局设置驱动程序。从 R 内部：

```
options(sqldf.driver = "SQLite") 
```

或者，如果您希望使用 RSQLite，另一种可能性是在使用`detach`sqldf 之前使用 RPostgreSQL 并在之后再次加载它。

详情请参阅`?sqldf`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-02-02T04:43:58.773

我有同样的错误，我分离了 RPostgeSQL 包，重新运行我的 sqldf 代码，它工作正常`r detach("package:RPostgreSQL", unload=TRUE)`

# javascript - 如何让我的 ASP 表格控件显示/隐藏？（不像听起来那么简单）

> ID：10237119
> 
> 赞同：0
> 
> 时间：2012-04-19T21:32:57.893
> 
> 标签：javascript, asp.net, vb.net

好吧，我对 ASP.NET 还很陌生，但我想我明白发生了什么。我的任务是在其中构建报告。到目前为止，除了这一个问题之外，我已经完成了所有工作。

我使用一个数据绑定到 DataRowCollection 的中继器，并通过它以编程方式构建一个表。我有类似的东西：

```
Private Sub SubAcctGrid_OnItemDataBound(ByVal sender As Object, ByVal e As RepeaterItemEventArgs)
    If e.Item.ItemType = ListItemType.AlternatingItem Or e.Item.ItemType = ListItemType.Item Then
        Dim currentrow = TryCast(e.Item.DataItem, DataRow)
        Dim acctSummaryTable = New Table With {.ID = "acctSummary" & e.Item.ItemIndex, .CssClass = "minisub_acct_table"}
        Dim drillDownTable = New Table With {.ID = "drillDownTable" & e.Item.ItemIndex, .CssClass = "drilldown_table"}

        ' Build both tables here

        acctSummaryTable.Rows(1).Cells(0).Attributes.Add("onclick", String.Format("displayDetailTable('{0}')", drillDownTable.ID))
        acctSummaryTable.Rows(1).Cells(1).Attributes.Add("onclick", String.Format("displayDetailTable('{0}')", drillDownTable.ID))

        e.Item.Controls.Add(acctSummaryTable)
        e.Item.Controls.Add(drillDownTable)

    End If
End Sub 
```

我有一个 Javascript 函数，它接受元素 ID 并隐藏或显示表格：

```
function displayDetailTable(tableID) {
    var table = document.getElementById(tableID)
    if (table.style.display == "none") {
        table.style.display = "table";
    }
    else {
        table.style.display = "none";
    }
} 
```

不过，我终其一生都无法传递正确的元素 ID。据我了解，为了唯一性，ASP.NET 将我分配的 ID 转换为一些巨大的长 ID。例如，我分配了一个 ID 为“drillDownTable0”的表，它在 HTML 标记中输出了“ctl00_drillDownTable0”。它第一次工作，但随后中继器被绑定到一个新行，然后我得到'ctl01_drillDownTable0'等等。

我已经尝试了 ClientID、ID 和 UniqueID，我在上面的代码中将属性添加到单元格中，但它们没有做我需要做的事情。

有什么方法可以获取该 ID 并将其传递给 Javascript 函数？或者我想一个更好的问题是：ID 是什么时候生成的，我可以在页面以 HTML 呈现之前获取它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:36:51.353

~~您可能正在寻找 [`ClientID`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientid.aspx)：~~

```
String.Format("displayDetailTable('{0}')", drillDownTable.ClientID) 
```

除此之外，我建议在 Repeater 的[`ItemCreated`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.itemcreated%28v=vs.100%29.aspx)事件中动态创建控件。您必须在每次回发时重新创建所有动态控件。`ItemDataBound`仅在数据绑定时调用，而`ItemCreated`在每次回发时调用。

**编辑**：我刚刚看到您已经尝试过 ClientID。但这可能是在 ItemdataBound 中创建表引起的问题。

# python - 在字典上测试 Q (python)

> ID：10237121
> 
> 赞同：0
> 
> 时间：2012-04-19T21:33:01.183
> 
> 标签：python, file, dictionary

```
def process_students(r):

    '''r is an open reader with no data about students: their name, cdf account, age, college and 
       home city. Each line has the following format:
       name, cdf, age, college, city.

       there are no commas other than the ones used as separators.

       Return a dictionary in which each key is a college and its value is the list of cdf accounts 
       for students at that college''' 
```

我对如何处理这个问题感到困惑。我正在做这个练习测试，这是问题之一。我从创建一个新字典开始。接下来我该怎么做？

```
 d = {}
    for line in r:
         line.strip() 
```

当我们从文本文件中取出行时，我们是否总是需要剥离它？

问题的 b 部分也令人困惑。它告诉我们编写一个程序，以上述格式打开一个名为“students.txt”的文件，调用我们的函数来构建字典，并将字典腌制到一个名为“students.pck”的文件中。我们可以假设`cpickle`已经被导入并且该函数`process_students`已经被定义。

我不知道泡菜是什么。但是我什至无法完成第一个，所以我不知道如何继续进行第二个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:43:23.130

这是学习，我认为您自己解决问题会比阅读某人的解决方案学到更多。好的起点是查看用于解析输入文件的[csv 模块](http://docs.python.org/library/csv.html#module-csv)和 python 帮助中的教程部分以了解如何操作[字典](http://docs.python.org/tutorial/datastructures.html#dictionaries)。

```
import csv

def process_students(r):
    for row in csv.reader(r, delimiter=','):
        print row  # <-- rather than print, you should build dictionary here 
```

我个人会使用 csv 模块。process_students 的另一个循环可能是：

```
 for line in r:
        row = line.strip().split(',')
        print row 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:55:51.970

> 当我们从文本文件中取出行时，我们是否总是需要剥离它？

这是摆脱[行尾](http://en.wikipedia.org/wiki/Newline)字符的简单方法。我想你不需要它们:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T21:56:09.800

显然，大多数人不愿意给你一个完整的解决方案，因为你没有从中学到很多东西，但该指南确实让事情变得相当简单。这里有一些指针...

1）你已经阅读了你的行。该行是一个字符串。使用字符串的 split 方法来划分成一个组件字符串列表。例如，`"this,is,a,test".split(",") # => ["this", "is", "a", "test"]`

2）访问列表的元素：

```
mylist = [1,2,3,4]
mylist[2] # => 3

#or map the values to variable names
a,b,c,d = mylist 
```

3）字典使用起来很有趣：

```
mydict = {}
mydict['things'] = []
mydict['things'].append("foo")
mydict['other_things'] = ["bar"]

mydict['things'] # => ["foo"]
mydict['other_things'] # => ["bar"] 
```

这些只是对有助于您的事情的一些提示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T21:39:58.667

查看用于读取数据文件的 Python CSV 模块，然后在处理每个 csv 行时，将值插入到字典中。[http://docs.python.org/library/csv.html](http://docs.python.org/library/csv.html)

特别是，看看这个：[http ://docs.python.org/library/csv.html#csv.reader](http://docs.python.org/library/csv.html#csv.reader)

这可能解释了参数所`reader`代表的`r`。

# java - Mockito - 模拟 RestOperations

> ID：10237122
> 
> 赞同：3
> 
> 时间：2012-04-19T21:33:06.343
> 
> 标签：java, spring, unit-testing, mocking, mockito

我有：

```
Map<String, String> vars = new HashMap<String, String>();
String r = restOperations.getForObject(url, String.class, vars); 
```

在我的测试中，我尝试模拟 RestOperations：

```
@Mock
RestOperations restOperations;

when(restOperations.getForObject(Matchers.anyString(), Matchers.eq(String.class), Matchers.notNull())).thenReturn("ok"); 
```

这永远不会被触发。

有男孩明白为什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T21:45:17.717

我相信问题在于方法重载。`getForObject`有两个采用三个参数的重载版本：

```
<T> T getForObject(String url, Class<T> responseType, Map<String, ?> uriVariables);

<T> T getForObject(String url, Class<T> responseType, Object... uriVariables); 
```

当你想模拟第一个时，你实际上是在模拟第二个。为了帮助静态方法解析`notNull()`明确地转换匹配项：

```
when(restOperations.getForObject(
  Matchers.anyString(), Matchers.eq(String.class), (Map)Matchers.notNull())
).thenReturn("ok"); 
```

甚至更好，使用`anyMap()`：

```
 when(restOperations.getForObject(
   Matchers.anyString(), Matchers.eq(String.class), Matchers.anyMap())
 ).thenReturn("ok"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-23T19:06:50.867

**谢谢你的回答，真的很有帮助。**

**以下是完整的源代码，认为对其他人有帮助。**

```
public class HandlerTest {

    private Handler handler;

    @Before
    public void setUp() {
        handler = new HandlerImpl();
    }

    @Test
    public void testMethodtoTest() {
        String param1 = "123456";
        String param2 = "3736272";
        String param3 = "838912";

        RestTemplate mock = Mockito.mock(RestTemplate.class);
        Mockito.when(mock.getForObject( Matchers.anyString(), Matchers.eq(String.class), Matchers.anyMapOf(String.class, String.class)) ).thenReturn("ok");
        handler.setRestTemplate(mock);

        String actualResponse = handler.MethodtoTest(param1, param2, param3);

        Assert.assertNotNull(actualResponse);
        Assert.assertEquals("ok",actualResponse);
} 
```

# c++ - 从 C++ 调用 ScaLAPACK

> ID：10237124
> 
> 赞同：1
> 
> 时间：2012-04-19T21:33:17.477
> 
> 标签：c++, gcc, openmpi, scalapack

嗨，任何人都可以为我提供一个从 C++ 调用 ScaLAPACK 的示例 Makefile，我遇到了困难。

我正确编译了最新版本，并通过了所有测试。我在 Fedora 上使用 GCC 和 OpenMPI 编译它，我还尝试使用存储库中的预构建二进制文件，但没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T17:00:33.417

我对 ScaLAPACK 过程使用了以下声明：

```
extern "C" void pdgesvd_(char *jobu, char *jobvt, int *M, int *N, double *A, int *ia, int *ja, int *desca, double *s, double *u, int *iu, int *ju,
            int *descu, double *vt, int *ivt, int *jvt, int *descvt, double *work, int *lwork, int *info);

extern "C" void pdgemv_(char *t, int *M, int *N, double *alpha, double *A, int *ia, int *ja, int *desca, double *X, int *ix, int *jx,int *descx,
            int *incx, double *beta, double *Y, int *iy, int *jy, int *descy, int *incy);

extern "C" void pdgemm_(char *transa, char *transb, int *M, int *N, int *K, double *alpha, double *A, int *ia, int *ja, int *desca, double *B,
            int *ib, int *jb, int *descb, double *beta, double *C, int *ic, int *jc, int *descc); 
```

BLACS 程序的声明方式相同：

```
extern "C" void blacs_get_(/*in*/int *icontxt, /*in*/int *what, /*out*/int *val); 
```

我将“_”字符附加到过程名称，因为 BLAS 和 ScaLAPACK 是使用 -DAdd_ 编译器选项构建的。对于您的系统，这可能会有所不同。如果是这样，请尝试`objdump -t`使用`libscalapack.a`其他静态库文件来确定实际的过程名称。

您的带有 ScaLAPACK 调用的程序可能会使用以下内容进行编译：

```
mpicxx -o your_binary_name -O2 your_source.cpp -lscalapack -lblacs -lcblacs -lblacs -llapack -lblas -lgfortran 
```

请注意，g++ 调用行 ( `-lblacs -lcblacs -lblacs -llapack -lblas -lgfortran`) 中静态库的顺序很重要！还要检查库目录中是否存在所有这些静态库文件（`libblas.a`等等`libcblacs.a`）。不要忘记 Fortran 包 (for `-lgfortran`)。

# mysql - mysql, utf-8 专栏：如何选择只区分大小写？

> ID：10237129
> 
> 赞同：2
> 
> 时间：2012-04-19T21:33:52.203
> 
> 标签：mysql, select, utf-8, case-sensitive

我使用 utf-8 字符串。它们应该存储在 MySQL 数据库表中。这就是为什么我决定为几列选择一些 utf-8 排序规则。现在我看到的选择并不像我想象的那么清楚。问题是 SELECT 语句应该区分大小写。但事实并非如此。

第一个选项是选择另一个 utf-8 排序规则（据我所知，唯一的非 ci 排序规则是 utf8_bin）。这是一个解决方案吗？第二种是在 SELECT 语句中使用 BINARY：

```
select col1, col2
from table1
where BINARY col3='CasE_sENsiTive'; 
```

这很简单，但它至少会降低 x10 倍甚至更多的性能。我的表有 1 个索引，没有 BINARY（无索引 = 慢）也能正常工作。

在我的情况下有什么解决方案？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:40:40.247

您可以通过以下方式提高区分大小写搜索的性能：

```
select col1, col2 from table1 where col3='Case_sEnsiTive' AND BINARY col3="CasE_sENsiTive"; 
```

但是，如果没有充分的理由使用不区分大小写的排序规则，我强烈建议使用`utf8_bin`as collat​​ion。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T21:40:42.463

使用您提供的示例，或者，如果您*始终*将列视为区分大小写，请为其分配区分大小写的排序规则（即以`_cs`[case-sensitive] 或`_bin`[binary] 结尾的排序规则）。请参阅MySQL 参考中的[区分大小写](http://dev.mysql.com/doc/refman/5.0/en/case-sensitivity.html)。

# java - 内容长度？长度要求，但设置？

> ID：10237131
> 
> 赞同：0
> 
> 时间：2012-04-19T21:34:10.827
> 
> 标签：java, android, http-post

我正在尝试使用帖子将数据发送到 Web 服务器，这就是我目前所拥有的：

```
private void entity(String id, String file)
                throws JSONException, UnsupportedEncodingException, FileNotFoundException {
             // Add your data
            File myFile = new File(
                    Environment.getExternalStorageDirectory(), file);
            InputStreamEntity reqEntity = new InputStreamEntity(
                    new FileInputStream(myFile), myFile.length());

            reqEntity.setContentType("text/csv");
            reqEntity.setChunked(true); // Send in multiple parts if needed

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(1);
            nameValuePairs.add(new BasicNameValuePair("project", id));

            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            httppost.setEntity(reqEntity);

            //httppost.setHeader("Content-Length", String.valueOf(myFile.length()));

        } 
```

当我发送发布请求时，它会返回所需的内容长度，但这不是在这里设置的吗？

```
InputStreamEntity reqEntity = new InputStreamEntity(
                    new FileInputStream(myFile), myFile.length()); 
```

不知道我做的对不对，请帮忙，谢谢

* * *

编辑 -

当我尝试自己设置内容长度时

```
httppost.setHeader("Content-Length", String.valueOf(myFile.length())); 
```

它回来时已经设置了标题。

因此为什么它被注释掉了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-15T09:22:04.470

在我的情况下使用

```
reqEntity.setChunked(false); 
```

解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:40:36.570

这设置了在`InputStreamEntity`将数据写入 时在本地使用的内容的长度`OutputStream`。它不会将该值设置为您的请求的参数。您需要自己设置该标题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T23:09:28.460

您可能想要使用[MultipartEntity](http://hc.apache.org/httpcomponents-client-ga/httpmime/apidocs/index.html?org/apache/http/entity/mime/MultipartEntity.html)`addPart`并使用带有`StringBody`和`InputStreamBody`（或）的方法添加部分`FileBody`

# web - 负载均衡：有没有办法从客户端告诉负载均衡器当前正在针对哪台服务器？

> ID：10237132
> 
> 赞同：0
> 
> 时间：2012-04-19T21:34:10.923
> 
> 标签：web, load-balancing

我们有一个负载平衡的网站。它连接到 6 个不同的服务器。有什么方法（ping 或其他方式）可以从客户端确定负载均衡器将负载传递到哪个服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:36:18.710

您可以设置一个包含此信息的 cookie。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-06T19:08:43.050

经过一些研究，我意识到您可以通过查看 HTTP 标头响应来获取一些信息，例如 Web 服务器 IIS 版本等。但是您无法从客户端判断此响应来自哪个服务器。长话短说，负载均衡器背后的内容对于客户端的用户来说是不透明的。

# mysql - MySQL受外键限制

> ID：10237134
> 
> 赞同：3
> 
> 时间：2012-04-19T21:34:24.633
> 
> 标签：mysql, database, join, enums, foreign-keys

我有一个复杂的对象要存储在数据库中。

我觉得对于我想限制可能值的每种情况，我应该将值存储在表中并具有外键约束。我觉得这会比拥有 ENUM 更灵活。

问题是在很多情况下我想限制值。（数据也有分支，在某些情况下我会在不同的地方加入一个表）

因此，每次获得货币价值、计量单位等时，我都必须加入 - 以指数方式增加加入的数量。

您对此有何建议？

**编辑：**

我可以使用可能有 15-20 种不同类型的连接，大约 3 级深

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:05:11.783

我看到了实现约束的三种可能方法：

可以将任何真正的[分类变量](http://en.wikipedia.org/wiki/Categorical_variable)存储在单独的表中，并在每次引用时都有一个指向该表的外键。在许多情况下，这可以帮助保持数据库更清洁和更易于维护。知道您的用户的“状态”属性是 1 到 50 之间的数字变量，而不是可能是“MA”、“ma”、“Mass.”或“Massachusetts”的字符串，肯定会让您的 DBA（和开发人员因此，最终用户）很高兴。

但是，如果您的变量不是真正的分类变量，但有一些关于它的特定标准，您可以使用[CHECK 约束（](http://www.w3schools.com/sql/sql_check.asp)[此处](http://forge.mysql.com/wiki/Triggers#Emulating_Check_Constraints)为MySQL 详细信息）强加它们。这些允许您定义一定范围内的有效值，而不必枚举每个可能的值，如果您只想检查插入时的有效性而不产生外键查找的惩罚，这可能会很有帮助。

最后，在业务逻辑中肯定有约束的地方。我发现复杂的约束（正则表达式匹配等）最好在应用程序代码中维护，而不是在 SQL 数据库中。

请注意，外键不一定会损害性能。您可以运行一些测试，但我发现将大型（500k 行）表连接到小型（20 行）分类表对性能没有明显影响。所以你可能没问题，不用担心。

如果您确实有许多想要 ENUM 的潜在值，请记住，只有在执行连接时才会发生性能损失，这并不总是必要的。通常，对于您的数据检索，您可以只使用 ID，而不是实际值。在这种情况下，外键的存在绝不会影响您的 SELECTS，并且只会对每次 INSERT/UPDATE 产生轻微的惩罚，因为系统需要检查外键是否有效。

# javascript - 替换div时的jQuery淡入淡出效果

> ID：10237136
> 
> 赞同：0
> 
> 时间：2012-04-19T21:34:28.213
> 
> 标签：javascript, jquery

我一直在努力寻找`fade`使用此脚本的效果的解决方案。我仍在学习基本的 jQuery，但似乎无法弄清楚。脚本运行良好，div 正在替换，但没有动画。我尝试过fadeToggle、fadeIn 和fadeOut。

```
function HideContent(d) {
    if(d.length < 1) {
        return;
    }
    document.getElementById(d).style.display = "none";
}

function ShowContent(d) {
    if(d.length < 1) {
        return;
    }
    document.getElementById(d).style.display = "block";
    $('#' + d).fadeToggle('slow');
} 
```

我用 onmouseclick 调用脚本。我有大约 14 个不同的 div。

```
<a  onmouseclick="ShowContent('div1'); return true; "href="javascript:ShowContent('div1')"> Link button </a> 
```

并返回：

```
<a onmouseclick="HideContent('div1'); return true;" href="javascript:HideContent('div1')"> BACK </a> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T20:11:20.963

您的代码中存在几个问题，但是会发生停止动画的问题，因为您`block`在调用 fadeToggle 之前已经将显示 CSS 样式更改为。请尝试下面的代码。

```
function HideContent(d) {
    if(d.length < 1) {
        return; 
    }

    // document.getElementById(d).style.display = "none";
    // replace the above line with:
    // $('#' + d).css('display','none');

    // or even better, fade it out:
    $('#' + d).fadeOut('slow');
}

function ShowContent(d) {
    if(d.length < 1) {
        return; 
    }
    // document.getElementById(d).style.display = "block";
    // You don't need the above, the fadeToggle does this for you.

    $('#' + d).fadeIn('slow');
} 
```

# django - 如何在 Django 中呈现单个单选按钮选项？

> ID：10237140
> 
> 赞同：25
> 
> 时间：2012-04-19T21:34:58.073
> 
> 标签：django, django-templates

如果我的模型包含带有 RadioSelect 小部件的 ChoiceField，如何在模板中单独呈现单选按钮？

假设我正在构建一个 Web 应用程序，它允许公司的新员工选择他们想要的桌面计算机类型。这是相关模型：

```
class ComputerOrder(forms.Form):
    name = forms.CharField(max_length=50)
    office_address = forms.Charfield(max_length=75)
    pc_type = forms.ChoiceField(widget=RadioSelect(), choices=[(1, 'Mac'), (2, 'PC')]) 
```

在模板上，如何*仅*渲染Mac 选择按钮？如果我这样做，它会呈现所有选择：

```
{{ form.pc_type  }} 
```

我有点天真地尝试了这个，但它没有产生任何输出：

```
{{ form.pc_type.0 }} 
```

（我在这里发现了一些类似的问题：

[在 Django 表单中，如何呈现单选按钮以便在页面上分隔选项？](https://stackoverflow.com/questions/6766994/in-a-django-form-how-do-i-render-a-radio-button-so-that-the-choices-are-separat)
[Django 表单：如何在 Django 表单中迭代一个字段的选择](https://stackoverflow.com/questions/7978107/django-forms-how-to-iterate-over-a-choices-of-a-field-in-django-form)

但我不觉得他们有很好的答案。有没有办法让老问题复活？）

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-07-09T17:18:29.740

Django 1.4+[允许您迭代](https://docs.djangoproject.com/en/stable/ref/forms/widgets/#radioselect)a 中的选择`RadioSelect`，以及

```
{% for choice in form.pc_type %}
  {{ choice.choice_label }}
  <span class="radio">{{ choice.tag }}</span>
{% endfor %} 
```

我不确定此更改是否允许您使用您描述的语法 ( `{{ form.pc_type.0 }}`) — 如果没有，您可以使用`for`上面的循环和类似`{% if forloop.counter0 == 0 %}`.

如果您绑定到 Django < 1.4，您可以`render()`按照建议覆盖该方法，或者使用稍微更详细但不太复杂的选项在模板中自己构建表单字段：

```
 {% for choice in form.pc_type.field.choices %}
   <input name='{{ form.pc_type.name }}' 
     id='{{ form.pc_type.auto_id }}_{{ forloop.counter0 }}' type='radio' value='{{ choice.0 }}'
     {% if not form.is_bound %}{% ifequal form.pc_type.field.initial choice.0 %} checked='checked' {% endifequal %}
   {% else %}{% ifequal form.pc_type.data choice.0 %} checked='checked' {% endifequal %}{% endif %}/>
   <label for='{{ form.pc_type.auto_id }}_{{ forloop.counter0 }}'>{{ choice.1 }}</label>
 {% endfor %} 
```

（`choice.0`并且是双元组`choice.1`中的第一项和第二项）`choices`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-19T21:42:22.963

单个无线电输入的呈现由`RadioSelect`小部件的`render`方法处理。如果您想要不同的渲染， subclass `RadioSelect`，相应地更改`render`方法，然后将您的子类用作字段的小部件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-12T22:19:37.343

我认为简单地查看选择字段的 for 循环中可用的内容将告诉人们他们需要知道什么。例如，我需要该值来设置围绕选项范围的类（用于颜色等）：

```
<div>
    {% for radio_input in form.role %}
        {# Skip the empty value #}
        {% if radio_input.choice_value %}
            <span class="user-level {{ radio_input.choice_value }}">{{ radio_input }}</span>
        {% endif %}
    {% endfor %}
</div> 
```

如您所见，有几个属性使您不必使用序数。

![模板内的 PyCharm 调试](../Images/ae11e059b9d61b6009e6fbdf14e01747.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-04-04T18:38:42.637

在 Django 2.0+ 中，您可以子类`forms.RadioSelect`化并“简单地”指定用于呈现单选字段的模板：

```
class SlimRadioSelect(forms.RadioSelect):
    template_name = 'includes/slim_radio.html' 
```

其中`slim_radio.html`包含由[默认 RadioSelect 小部件](https://github.com/django/django/blob/stable/3.0.x/django/forms/widgets.py#L757)`template_name`组合和`option_template_name`使用的修订版本。

请注意，默认的 RadioSelect 小部件模板是低级渲染，由多层模板组成：包含、条件和循环逻辑标签比比皆是。

当您四处挖掘`packages/django/forms/templates/django/forms/widgets/input.html`以获取您需要的东西时，您就会知道您已经到了。

覆盖默认小部件模板的另一个奇怪之处是您必须调用[TemplatesSetting](https://docs.djangoproject.com/en/3.0/ref/forms/renderers/#django.forms.renderers.TemplatesSetting)渲染器，否则您的子类[将无法](https://stackoverflow.com/a/52184422/4028977) `slim_radio.html`在项目的通常可访问的模板路径中找到。

要覆盖 RadioSelect 的仅本地模板路径查找：

1.  添加`'django.forms'`到您的`INSTALLED_APPS`;

2.  添加`FORM_RENDERER = 'django.forms.renderers.TemplatesSetting'`到您的`settings.py.`

这一切似乎都比应该的要难，但那是框架。祝你好运。

# alfresco - 如何在 Alfresco 中将一段内容与另一段内容相关联？

> ID：10237145
> 
> 赞同：1
> 
> 时间：2012-04-19T21:35:16.373
> 
> 标签：alfresco

我有两个文件夹，一个是图片，另一个是文本文件。

如何向文本文件添加允许用户从图像文件夹中选择项目的属性？（我知道如何使用方面添加数字和日期等基本属性。）

我已经尝试过这些，但 Share 将它们呈现为只读框。

```
 <property name="my:propQName">
                <title>QName Property</title>
                <type>d:qname</type>
            </property>

            <property name="my:propNodeRef">
                <title>Node Reference Property </title>
                <type>d:noderef</type>
            </property>

            <property name="my:propPath">
                <title>Path Property </title>
                <type>d:path</type>
            </property> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:40:42.623

您需要创建一个[关联](http://wiki.alfresco.com/wiki/Data_Dictionary_Guide#Peer_.28Non-Child.29_Associations)：

```
 <associations>
        <association name="my:relatedImage">
           <source>
              <mandatory>true</mandatory>
              <many>false</many>
           </source>
           <target>
              <class>my:imageType</class>
              <mandatory>true</mandatory>
              <many>false</many>
           </target>
        </association>
     </associations> 
```

这将默认呈现为选择器。您始终可以[像](http://wiki.alfresco.com/wiki/Forms#association.ftl)往常一样在`share-config-custom.xml`.

* * *

编辑：关于协会的[官方文件](http://docs.alfresco.com/4.0/index.jsp?topic=/com.alfresco.enterprise.doc/concepts/metadata-model-assoc.html)

# sql - 每组选择前 x 条记录

> ID：10237150
> 
> 赞同：3
> 
> 时间：2012-04-19T21:35:32.670
> 
> 标签：sql, sql-server, sql-server-2008

我正在使用下面的查询来搜索标题中包含术语的产品。查询返回所需的结果（通常结果太多）。

现在我只希望它能够为每家公司选择最多 3 种（随机）产品。有些公司退回了很多记录/产品，但我只需要拿3个就可以转到下一家公司

```
SELECT p.title As entryname, cname 
FROM company c, product p
WHERE p.title LIKE '%steel%' AND p.cid = c.cid 
GROUP By cname, ca.title 
```

我试图理解分区和排名，但我没有走得太远。我正在使用 ms sql

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T21:39:49.970

您可以使用 ROW_NUMBER() 来执行此操作

```
with cte as (
SELECT 
    p.title as entryname, cname,
    ROW_NUMBER() OVER (PARTITION BY c.id ORDER BY p.id) rn
FROM company c
    INNER JOIN  product p 
    ON  p.cid = c.cid 
WHERE p.title LIKE '%steel%'
GROUP By cname, ca.title    
)
SELECT 
    p.title as entryname, cname,
FROM CTE where rn <= 3 
```

如果您真的想要随机（而不是 ID 最低的 3 个），您可以将 row_number 行更改为

`ROW_NUMBER() OVER (PARTITION BY c.id order by newid()) rn`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:38:36.987

如果您的数据库是 SQL Server（在您的帖子末尾使用 ms sql），请[在 MSDN 上查找 TOP](http://msdn.microsoft.com/en-us/library/ms189463.aspx)：

```
SELECT TOP(3) p.title As entryname, cname 
FROM company c, product p
WHERE p.title LIKE '%steel%' AND p.cid = c.cid 
GROUP By cname, ca.title 
```

对于 Oracle，您可以在 WHERE 子句中使用[rownum ：](http://docs.oracle.com/cd/B19306_01/server.102/b14200/pseudocolumns009.htm)

```
SELECT p.title As entryname, cname 
FROM company c, product p
WHERE p.title LIKE '%steel%' AND p.cid = c.cid AND rownum < 4
GROUP By cname, ca.title 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T21:43:31.573

你可以简单地追加

```
limit 3,5 
```

到您的查询结束。 例如，这将从第 3 行开始依次为您提供**5行。**

**现在随机**选择这 5 行是一种复杂的模式，我猜。

# java - SWT CTabFolder 检查 CTAB 是否存在

> ID：10237153
> 
> 赞同：0
> 
> 时间：2012-04-19T21:35:41.847
> 
> 标签：java, swt, ctabitem

我正在尝试在 SWT 中为我的应用程序创建一个选项卡接口。我想设置我的菜单按钮，以便在单击它时检查是否打开了选项卡。如果它是打开的，我想切换到选项卡，如果不是，我想打开它。我已经创建了一个将创建选项卡的菜单项，但我不确定如何检查选项卡是否存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T18:04:33.097

```
public static Boolean CtabExists(CTabFolder folder, CTabItem tab) {
    if (tab != null) {
        int intIndex = -1;
        intIndex = folder.indexOf(tab);
        if (intIndex == -1) {
            return false;
        } else {
            return true;
        }
    } else {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-27T07:22:04.650

```
int tabItemIndex=tabFolderItem.getSelectionIndex();
if(tabItemIndex!=-1)
  tabFolderItem.setSelection(tabItemIndex);
else
  tabFolderItem.setSelection(value); //keep your required index in the place of value 
```

# filesystems - Lua: %UserProfile% 访问

> ID：10237162
> 
> 赞同：2
> 
> 时间：2012-04-19T21:36:40.283
> 
> 标签：filesystems, lua

我尝试搜索此信息，但没有运气。

我正在尝试做的是访问 Lua 中的变量路径，因此不必每次都将路径更改为绝对值，我可以这样做：`C:/%UserProfile%/path`代替。有没有办法做到这一点？

我看到了一个 luafilesystem 站点，但它似乎没有做我需要它做的事情。本质上，我想做的是以下几点：

```
savepath = "%UserProfile%/Saves" 
```

我必须有两个步骤还是只有一个步骤并不重要，只要它有效即可。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T21:48:22.010

```
os.getenv (varname) 
```

返回进程环境变量 varname 的值，如果未定义变量，则返回 nil。

-- [Lua 5.1 参考手册](http://www.lua.org/manual/5.1/manual.html#pdf-os.getenv)

# c - 套接字 UDP：在 Sendto() 中使用来自 Recvfrom() 的发件人信息失败

> ID：10237163
> 
> 赞同：5
> 
> 时间：2012-04-19T21:36:41.553
> 
> 标签：c, sockets, udp

我正在尝试编写一个通过 UDP 接收查询并通过 UDP 发送响应的服务器。我遇到的问题是，当我尝试发送响应时，出现“101 Network is unreachable”错误。

根据[这里](https://stackoverflow.com/questions/2782259/sendto-network-unreachable)的问题，我试图通过拔掉`hints.ai_flags = AI_PASSIVE;`线路来解决这个问题，但是服务器永远不会成功地收到消息。我查看了手册页，`addrinfo`听起来如果`AI_PASSIVE`设置了标志，则套接字只能`recvfrom()`，而如果未设置，则套接字只能`sendto()`。不过，我在网上看到了很多例子，人们从一个套接字同时做这两种操作；我错过了什么？

相关代码：

```
struct addrinfo hints;
struct addrinfo *serverinfo;
memset(&hints,0,sizeof hints);
hints.ai_family = AF_UNSPEC;
hints.ai_socktype = SOCK_DGRAM;
hints.ai_flags = AI_PASSIVE;

int status = getaddrinfo(NULL, port, &hints, &serverinfo);
int sock = socket(serverinfo->ai_family, serverinfo->ai_socktype, serverinfo->ai_protocol);
status = bind(sock, serverinfo->ai_addr, serverinfo->ai_addrlen);
freeaddrinfo(serverinfo);

// poll until there's an incoming packet

struct sockaddr sender;
socklen_t sendsize = sizeof(sender);
bzero(&sender, sizeof(sender));

recvfrom(sock, message, sizeof(message), 0, &sender, &sendsize);

// message processing

sendto(sock, response, sizeof(response), 0, (struct sockaddr *)&sender, sendsize); 
```

是的，我对所有这些调用进行了错误检查（这就是我发现问题的方式）；为了简洁起见，它被简单地忽略了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T22:31:34.500

您不应该使用 a`struct sockaddr`在`recvfrom`调用中存储源地址，它可能无法表示 IP 套接字地址。

您应该将 a`struct sockaddr_in`用于 IPv4 地址或 a`struct sockaddr_in6`用于 IPv6 地址，或者更好的是，使用 a`struct sockaddr_storage`来处理其中任何一个。

```
struct sockaddr_storage sender;
socklen_t sendsize = sizeof(sender);
bzero(&sender, sizeof(sender));

recvfrom(sock, message, sizeof(message), 0, (struct sockaddr*)&sender, &sendsize); 
```

# jquery - 带有 ASP.NET 按钮回发的用户控件上的 jQuery UI 对话框

> ID：10237168
> 
> 赞同：0
> 
> 时间：2012-04-19T21:36:59.267
> 
> 标签：jquery, asp.net, jquery-ui

我有一个 jQuery UI 对话框，它在我的 aspx.page 上效果很好

我的问题是我需要将部分页面移动到用户控件中。我将 div 和 jquery 移动到用户控件。控件弹出很好，但是服务器端控制火。

这是我弹出对话框的代码。

```
 var $partyaddress = $('#addressinformationcontent').dialog({
            autoOpen: false,
            modal: true,
            height: 450,
            width: 850,
            title: 'Party Address Information'
        });

        $('#addressopener').click(function () {
            $('#addressinformationcontent').parent().appendTo($("form:first"));
            $partyaddress.dialog('open');
            return false;
        }); 
```

我在对话框中弹出的 div 是：

```
<div id="addressinformationcontent">

<asp:UpdatePanel ID = "updatePanelAddress" runat="server">

<ContentTemplate>

//some asp controls here and a asp.net submit button

/ContentTemplate>

</asp:UpdatePanel>

</div> 
```

我想我理解这个问题。jquery 使用 DOM 将对话框移动到 Form 标签之外，我需要将它们添加回来。我在单击函数中的行将其附加回“表单”，但用户控件没有表单标记。奇怪的是，当我第一次弹出对话框时，我必须在对话框上按下一个按钮来加载工作正常并加载字段的表单字段。在对话框的第一次回发后，所有服务器端控件都停止工作。我不知道如何解决这个问题。任何帮助将非常感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T02:56:09.537

此外，应在单击事件之外设置以下代码行，以便在对话框中正确触发回发事件。

```
$('#addressinformationcontent').parent().appendTo($("form:first")) 
```

示例代码将。

```
$(function () {
      $('#addressinformationcontent').parent().appendTo($("form:first"))
      $("#addressinformationcontent").dialog(
      {
         autoOpen: false,
         ...
       });
}); 
```

如果要在服务器端回发后保持 jquery 对话框打开，则需要稍作调整。一个例子在这里。

i：在代码隐藏文件中创建一个变量。

```
protected string PostBackOption =""; 
```

ii：在页面加载或页面预渲染事件中添加 ispostback 条件。

```
if (Page.IsPostBack)
{
   PostBackOption = "$(\"#addressinformationcontent\").dialog(\"open\");";
} 
```

iii：在 js 脚本中添加变量为

```
var $partyaddress = $('#addressinformationcontent').dialog({
        autoOpen: false,
        modal: true,
        height: 450,
        width: 850,
        title: 'Party Address Information'
    });

<%=PostBackOption %> 
```

iv: 这样你的对话框在回发的情况下不会消失。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T02:38:54.867

如果您正在阅读较旧的答案……请忽略。

我想我明白你现在的问题是什么......我遇到了与 jquerydialog 相同的问题。从来没有解决它，所以我改用其他技巧。

你可以

a）在对话框中使用常规的 html 控件和带有隐藏字段的 javascript/jquery 技巧...（不会详细介绍，因为它有点麻烦，如果你错过了一些东西，它会永远调试）

b) 使用 jquerytools 中的覆盖而不是对话框，就像您现在尝试使用对话框一样。

[http://jquerytools.org/demos/overlay/index.html](http://jquerytools.org/demos/overlay/index.html)

# database-design - 具有 20 个属性的用户配置文件的数据库表结构

> ID：10237169
> 
> 赞同：2
> 
> 时间：2012-04-19T21:37:00.240
> 
> 标签：database-design, database-table

让我们以一个拥有 100.000 个用户的约会网站为例。每个用户有大约 30 个属性，如头发颜色、吸烟、年龄、城市、性别……一些属性是 bool、一些 int 和一些 var 或 text。

其中大约 20 个属性是可搜索的，一半的用户不填写数据。所有值都显示在用户个人资料页面上。

我在考虑以下选项：

1.  将数据拆分为 4 个表。表 1 用于搜索最多的数据，表 2 用于大部分未填充的属性，表 3 用于像 about me 这样的大数据，以及表 4 的其余部分。
2.  大多数属性都有单独的表，因此每个属性都有自己的表。
3.  使用 EAV 模型。

我认为第一个选项是最好的。或者有没有其他更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T15:06:42.850

假设您不需要添加新属性，您可能最好将所有内容放在一张大表中。DBMS 在存储 NULL 方面通常相当有效。索引 NULL 也应该是合理的，一些 DBMS 甚至不包括索引中的 NULL (Oracle)。

也不要害怕 BLOB - 它们会倾向于“拉伸”行（如果 BLOB 的一部分被内嵌放置在行中，这通常可以通过 DBMS 特定的方式进行控制），从而降低您的“数据集群” ，但这对于您的目的来说应该不是太重要。

无论如何，在确定最自然的解决方案性能不足之前，请先**测量具有代表性的数据量。**

# android - 在 ActionBar MenuItem 文本上设置颜色范围

> ID：10237176
> 
> 赞同：1
> 
> 时间：2012-04-19T21:37:23.207
> 
> 标签：android

我正在尝试以编程方式将 ForegroundColorSpan 设置到操作栏 MenuItem ...

```
@Override
public boolean onCreateOptionsMenu(Menu menu)
{
    MenuInflater mInflater = getSupportMenuInflater();
    mInflater.inflate(R.menu.menu_main, menu);

    MenuItem menuProfile = menu.findItem(R.id.profile);
    menuProfile.setTitle(createProfileMenuTitle(this));
}

public static SpannableStringBuilder createProfileMenuTitle(Context c)
{
    SpannableStringBuilder b = new SpannableStringBuilder();

    int s = b.length();
    b.append(c.getString(R.string.Username));
    int e = b.length();
    b.setSpan(new ForegroundColorSpan(c.getResources().getColor(R.color.someColor)), s, e, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);

    b.append(" ..some more text here");

    return b;
} 
```

它不工作。知道如何解决这个问题吗？（没有在 MenuItem 上使用 setActionView 这样做会失去默认布局样式的所有所需行为）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-13T10:07:22.610

有一个答案：

在您的主题中，默认 actionMenuTextAppearance 是**TextAppearance.Holo.Widget.ActionBar.Menu**

```
<item name="actionMenuTextAppearance">@android:style/TextAppearance.Holo.Widget.ActionBar.Menu</item> 
```

而 setSpan(ForegroundColorSpan) 在此 TextAppearance 中不起作用。

你可以简单地设置

```
 <item name="android:actionMenuTextAppearance">@android:style/TextAppearance.Holo.Widget.ActionMode.Title</item> 
```

像这样：

```
 <style name="YourTheme" parent="android:Theme.Holo.Light">
        <item name="android:actionMenuTextAppearance">@android:style/TextAppearance.Holo.Widget.ActionMode.Title</item>
 </style> 
```

那么它的工作原理！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-10T01:32:09.443

尝试：

```
markup = "your text in html with colors";
Spanned spannable = Html.fromHtml(markup); 
```

# c - 时间：2019-05-10 标签：c++bejeweldlinkedlistvsarraylist

> ID：10237180
> 
> 赞同：0
> 
> 时间：2012-04-19T21:37:36.267
> 
> 标签：c, multidimensional-array, linked-list

我将使用 Glut 和 Opengl[游戏信息（wiki）](http://en.wikipedia.org/wiki/Bejeweled)在 c 中构建我自己的宝石。

**简短的游戏信息** 游戏由一个网格组成，比如说 8x8，带有不同的宝石。当您通过交换两个相邻的宝石来创建至少 3 个相同类型的宝石的行/列时，宝石将消失。比赛场地将从顶部填充。

**两个设计概念** *链表与数组*

有几种方法可以实现这一点，但我想要最容易维护和最有效的方法。我的想法是：

（二维数组代表比赛场地/网格）。

1) 包含所有指向 gem 对象（实例）的指针的链表。还有一个 2D 数组，其中包含指向链表元素的所有指针，用于快速访问链表。链表可用于轻松打印游戏对象。每个链表对象都带有一个位置（宝石、记分板、时间 ets）

2）和上面的想法一样，但是每行**或**每列都有一个链表，其他游戏元素也有一个链表

3）只有一个带有指向对象/实例（宝石）的指针的二维数组。

**所需操作**

-交换元素（宝石），通过交换指针？

-“创建”新元素（在网格顶部）

-检查行/列中至少有 3 个彼此相邻的相同类型的宝石

我希望我把这一切都说清楚了。你认为最好的解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:45:35.157

我认为使用链表是矫枉过正的。我能想到的唯一有用的就是从顶部掉落宝石，但即使是 2D 数组也是相当微不足道的。

二维数组`int`应该没问题。它简单快捷。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:49:00.120

我会使用二维数组。它更易于使用，因为您可以直接访问元素，而不是遍历列表，直到找到所需的元素。

但是，我也可以看到链表的优点，您可以在交换后删除一个成员并连续获得 3 个；您可以在遍历每个元素并像使用数组一样移动它之后向头部/尾部添加一个新元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T17:22:37.810

我的建议是两者都实施。你听起来有点没有经验。您必须编写更多代码才能在下次偶然发现这些问题时自己回答这些问题。一个好的设计将允许您轻松替换这部分实现，因此请尝试这样做并从中学习。

# matlab - 自动将matlab代码（内部带有图像处理工具箱）转换为c，以便将c代码集成到c#dot net中

> ID：10237183
> 
> 赞同：0
> 
> 时间：2012-04-19T21:37:41.640
> 
> 标签：matlab

我的朋友在matlab中编写了很好的图像处理功能（使用图像处理工具箱），有一种方法可以自动将此matlab代码生成为c代码（源代码），我可以将它包装在.net可以加载的dll中？？？

```
using System;
using System.Runtime.InteropServices;
class PlatformInvokeTest
{
    [DllImport("imp.dll")]
    public static extern int puts(string c);
    [DllImport("imp2.dll")]
    internal static extern int _flushall();

    public static void Main() 
    {
        puts("Test");
        _flushall();
    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T06:37:59.993

MATLAB 编译器可以做到这一点。采用

```
mcc -X MyFunction.m 
```

这将生成“.dll”、C 源代码、它的头文件和 C 上的 MEX 包装器。[仔细](http://technologyinterface.nmsu.edu/5_1/5_1f/5_1f.html)阅读以了解其他选项
。

# asp.net - GridView 列过滤

> ID：10237184
> 
> 赞同：1
> 
> 时间：2012-04-19T21:37:42.493
> 
> 标签：asp.net, filter, currency, money-format

我设置了一个 GridView 控件，通过 BL 从数据库中填充，其中一个字段包含货币金额。现在它以 0000.0000 的格式显示，我需要将其转换为将 $ + dataNumber 添加到百分之一的货币格式。

我一直在寻找过滤器，但到目前为止，我还没有看到一个直接而简单的答案。可以使用正则表达式来过滤工作吗？：/

这是我第一次尝试这样做。感谢您提供任何答案，但请在尝试实施您的建议时提供站点文档供我参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:40:29.977

该`GridView.BoundColumn`类型提供了[**`DataFormatString`**](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.boundcolumn.dataformatstring.aspx)可用于指定显示格式的属性。您可以使用`C`格式以货币格式显示。

```
<Columns>
    ...
    <asp:BoundColumn DataField="MyFieldName" DataFormatString="C" />
    ...
</Columns> 
```

# c# - 矩形的交叉问题

> ID：10237187
> 
> 赞同：0
> 
> 时间：2012-04-19T21:37:47.833
> 
> 标签：c#, xna

我试图让外星人与射手相交，当相交发生时，我想退出游戏。但是，它们直接通过底部的射手，甚至没有执行代码

这是我的代码：

```
Rectangle rectlauncher = new Rectangle(launcherXPos, 720, launcherImg.Width, launcherImg.Height);
Rectangle rectinvader = new Rectangle(invaders[Count].GetXPos(), invaders[Count].GetYPos(),invaderImg.Width, invaderImg.Height);

if (rectinvader.Intersects(rectlaucher))
   {
    this.Exit();
} 
```

代码值：

```
launcherXPos = 512;

            invaderDirection = -1;
            invaderSpeed = 20;

            invader = new invader[55]; //displays the number entered of 'invaders'

            int XPos = 512;
            int YPos = 100; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:57:23.860

也许您正在使用零以外的原点绘制一些元素？

尝试解决此问题的一种方法是在碰撞处设置一个断点，该断点仅在您点击 Space 时触发。开始玩游戏，当你应该相交时，点击空格，然后检查你在矩形中设置的值。试着弄清楚为什么它们不能代表真正发生的事情。

# wordpress - 修改 save_post 后的自定义字段

> ID：10237189
> 
> 赞同：0
> 
> 时间：2012-04-19T21:37:54.263
> 
> 标签：wordpress, post, custom-fields

在我的自定义帖子类型中，一旦用户保存帖子，有没有办法检查其中一个字段的值并更新它？我将插入的值将取决于帖子的 ID，因此`save_post`需要在它是新帖子时使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:16:37.517

是的，您可以在保存或更新帖子之后`$_POST`或之后获取所有数据`global $post``using save_post hook as you mentioned in your question`

```
add_action( 'save_post', 'afterSavePost' );
function afterSavePost($pid)
{
    $postId=$pid; 
    // or
    global $post;
    $postId=$post->ID;
    $postTitle=$post->post_title; 
    // or
    $postId=$_POST['ID'];
    $postTitle=$_POST['post_title']; 
} 
```

你提到`custom field`了，在这种情况下你可以使用

```
$yourCustomField=get_post_meta($postId, 'your_custom_field',true); // get a custom field 
```

和

```
$yourCustomField="New value";
update_post_meta($postId, 'your_custom_field', $yourCustomField); // update a custom field 
```

# multiple-inheritance - Objective-C 多重继承问题，我需要用 WTAppDelegate 和 UIResponder 继承我的 AppDelegate

> ID：10237191
> 
> 赞同：0
> 
> 时间：2012-04-19T21:37:58.050
> 
> 标签：multiple-inheritance

我正在集成`WebTrends`到我的应用程序中。

我需要继承我`AppDelegate`的 with`WTAppDelegate`但它已经继承了 with `UIResponder`。

*我怎样才能继承我`AppDelegate`的 with `WTAppDelegate`and `UIResponder`？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-19T10:11:28.337

我认为 WtAppDelegate 应该继承 UIResponder，而后者又继承自 NSObject，而不是直接从 NSObject 继承。

# ruby-on-rails - Heroku rails Procfile

> ID：10237200
> 
> 赞同：30
> 
> 时间：2012-04-19T21:38:44.913
> 
> 标签：ruby-on-rails, heroku

我对 Heroku 很陌生。

我将我的 Rails 应用程序上传到 Heroku，并希望使用 Thin 而不是 Webrick 运行它。按照[Heroku 的指南](https://devcenter.heroku.com/articles/rails3)，我应该使用它`web: bundle exec rails server thin -p $PORT -e $RACK_ENV`来创建 procfile。但是我总是得到回应`web:: command not found`。

我错过了什么？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-04-20T02:29:24.857

您不应该`web: bundle exec rails server thin -p $PORT -e $RACK_ENV`作为命令运行，而是创建一个`Procfile`以该文件为内容的新文件。

创建文件并使用编辑器将其粘贴，或者只是执行以下操作：

```
echo "web: bundle exec rails server thin -p \$PORT -e \$RACK_ENV" > Procfile 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T23:35:29.743

您是否已将 Thin 捆绑到您的应用程序中？

```
gem 'thin' 
```

如果没有，您正在查看 Rails 尝试使用默认服务器。就个人而言，我会考虑在 Heroku 上使用 Unicorn，但要小心你可能需要多少工人。

[http://neilmiddleton.com/the-procfile-is-your-friend](http://neilmiddleton.com/the-procfile-is-your-friend)。缓存版本：[https ://web.archive.org/web/20130926005616/http://www.neilmiddleton.com/the-procfile-is-your-friend](https://web.archive.org/web/20130926005616/http://www.neilmiddleton.com/the-procfile-is-your-friend)

[http://neilmiddleton.com/getting-more-from-your-heroku-dynos](http://neilmiddleton.com/getting-more-from-your-heroku-dynos)

# xpath - 从具有子元素的元素中检索文本

> ID：10237205
> 
> 赞同：0
> 
> 时间：2012-04-19T21:38:54.773
> 
> 标签：xpath

我正在尝试获取文本“Weeeeee”，但是当我使用时，`//td[@class='something']/text()`我什么也没有

```
<td class="something">
    <a href='http://www.google.com'>Google</a> 
    Weeeeee
    <div>
        <a>something</a>
    </div>
</td> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:50:19.917

尝试

```
//td[@class='something']/text()[normalize-space() != ''][1] 
```

由于您的示例中有*三个*文本节点，第一个和最后一个仅包含空格。

用方括号突出显示：

```
<td class="something">[\n
----]<a href='http://www.google.com'>Google</a>[\n
----Weeeeee\n
----]<div>
      <a>something</a>
   </div>[\n
]</td> 
```

# html - 多用户 HTML5 画布的清晰画布

> ID：10237207
> 
> 赞同：1
> 
> 时间：2012-04-19T21:39:03.760
> 
> 标签：html, canvas, multi-user

我正在尝试添加一个清除按钮来擦除[联合绘制的画布](http://anonym.to/?http://www.unionplatform.com/?page_id=2762)

我认为 clearRect 应该能够做到这一点。我试过：

```
function clearCanvas() {
    clearRect(0,0,canvas.width,canvas.height);
} 
```

或者

```
function clearCanvas(x,y,w,h) {
    ctx.clearRect(x,y,w,h);
} 
```

...但它不起作用，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:04:41.513

使用 ctx.clearRect(0,0,canvas.width,canvas.height) 的问题在于，如果您修改了转换矩阵，您可能无法正确清除画布。

解决方案？在清除画布之前重置转换矩阵：

// 存储当前变换矩阵 ctx.save();

// 清除画布时使用单位矩阵 ctx.setTransform(1, 0, 0, 1, 0, 0); ctx.clearRect(0, 0, canvas.width, canvas.height);

// 恢复变换 ctx.restore();

**编辑：**

Chrome 响应良好： context.clearRect ( x , y , w , h ); 但 IE9 似乎完全忽略了这条指令。IE9 似乎响应：canvas.width = canvas.width; 但它并没有清晰的线条，只是形状、图片和其他物体。

因此，如果您有这样创建的画布和上下文：

var canvas = document.getElementById('my-canvas'); var context = canvas.getContext('2d');

您可以使用这样的方法：

函数 clearCanvas(context, canvas) { context.clearRect(0, 0, canvas.width, canvas.height); var w = canvas.width; 画布.宽度 = 1; 画布.宽度 = w; }

**编辑2：**

使用此代码检查浏览器是否支持它：

```
function checkSupported() {
canvas = document.getElementById('canvas');
if (canvas.getContext){
  ctx = canvas.getContext('2d');
  // Canvas is supported
} else {
 // Canvas is not supported
 alert("We're sorry, but your browser does not support the canvas tag. Please use any web browser other than           Internet Explorer.");
}
} 
```

为了在网页加载时执行此代码，请调整 body 标签，使其如下所示：

```
<body onload="checkSupported();"> 
```

# android - 底部边距或填充在 android 上的 xml 中的相对布局中不起作用

> ID：10237210
> 
> 赞同：11
> 
> 时间：2012-04-19T21:39:11.147
> 
> 标签：android, imageview, padding, margin

我有`RelativeLayout`一排在里面`ListView`。该行看起来像，

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/relativeLayout1" 
    android:layout_width="wrap_content"
    android:layout_height="fill_parent">

    <ImageView
        android:id="@+id/placeDetailIcon_Img"
        android:layout_height="50dp"
        android:layout_width="50dp"
        android:layout_alignParentLeft="true" 
        android:paddingBottom="20dp"
        android:paddingTop="20dp" 
        android:paddingLeft="20dp"
        android:paddingRight="20dp"/>
</RelativeLayout> 
```

我也尝试了保证金：

```
 <ImageView
    android:layout_height="50dp"
    android:layout_width="50dp"
    android:id="@+id/placeDetailIcon_Img" 
    android:layout_alignParentLeft="true" 
    android:layout_marginRight="10dp"
    android:layout_marginTop="10dp"
    android:layout_marginLeft="10dp"
    android:layout_marginBottom="10dp"> 
```

既不应用边距也不在`ImageView`. 如何创建这种类型的间距？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T22:10:31.077

你可以和我一起使用它：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/relativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">  

     <ImageView
         android:id="@+id/imageView1"
         android:layout_width="50dp"
         android:layout_height="50dp"
         android:layout_alignParentLeft="true"
         android:layout_alignParentTop="true"
         android:layout_marginLeft="15dp"
         android:layout_marginTop="15dp" />

</RelativeLayout> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-17T02:59:55.197

对于其他正在寻找解决方案的人-来自文档：

[http://developer.android.com/reference/android/widget/RelativeLayout.html](http://developer.android.com/reference/android/widget/RelativeLayout.html)

“请注意，RelativeLayout 的大小与其子项的位置之间不能存在循环依赖关系。例如，您不能将 RelativeLayout 的高度设置为 WRAP_CONTENT 并将子项设置为 ALIGN_PARENT_BOTTOM。”

如果将 relativeView 放在滚动视图中，似乎也会出现一些奇怪的行为。

就我而言，我已将 relativeLayout 设置为 wrap_content，然后尝试将 marginBottom 添加到具有 ALIGN_PARENT_BOTTOM 属性的 ImageView 中。当我明确设置高度时，它终于起作用了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T21:44:54.443

我建议您使用 LinearLayout... 或者您可以尝试删除该属性：`android:layout_alignParentLeft="true"`

如果您想在 RelativeLayout 中居中视图，您可以使用：

```
android:layout_centerHorizontal="true"
android:layout_centerVertical="true" 
```

# mysql - 获取mysql表中相同项目的总数

> ID：10237212
> 
> 赞同：-1
> 
> 时间：2012-04-19T21:39:23.433
> 
> 标签：mysql

我有一张像这样设置的桌子

```
id | upc | count
----------------
1  | 100 |  5
2  | 100 | 12
3  | 101 |  3
4  | 100 |  7 
```

我想得到个人upc的总和

预期输出：

```
upc | count
--- | -----
100 | 24
101 |  3 
```

而且我不确定该怎么做。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:41:37.490

```
SELECT upc,SUM(count) FROM table GROUP BY upc ; 
```

编辑：在这种情况下不需要使用反引号（`count`是一个有效的列名）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T21:41:33.690

使用 GROUP BY 和[SUM](http://dev.mysql.com/doc/refman/5.6/en/group-by-functions.html#function_sum)聚合函数：

```
SELECT upc, SUM(count) AS count
FROM yourtable
GROUP BY upc 
```

# powershell - 使用 PowerShell 'If' 语句比较函数（Windows 版本）

> ID：10237216
> 
> 赞同：1
> 
> 时间：2012-04-19T21:39:31.100
> 
> 标签：powershell, if-statement, active-directory, scope, comparison

我目前正在创建一个[AD](http://en.wikipedia.org/wiki/Active_Directory)脚本，它可以获取一台机器的 AD 组并将它们传输到新机器（以防系统故障）。

我已经设法让脚本通过它们的主机名找到两台机器正在运行的 Windows 版本，但是我在创建“if”语句来比较两个版本的 Windows 时遇到问题。

这个想法是，如果它们是相同的版本（因此是相同的包版本），这些组将被自动复制，但我一生都无法弄清楚如何去做。

请考虑以下代码：

```
function W_version_current
{
    $current = Get-WmiObject Win32_OperatingSystem -computer $current_hostname.text | select buildnumber
    if ($current -match '7601')
    {
        "Windows 7"
    }
    elseif($current -match '2600')
    {
        "Windows XP"
    }
    elseif($current -eq $null)
    {
        "The box is empty"
    }
    else
    {
        "Function not supported"
    }
}

function W_version_target
{
    $target = Get-WmiObject Win32_OperatingSystem -computer $target_hostname.text | select buildnumber
    if ($var -match '7601')
    {
        "Windows 7"
    }
    elseif($target -match '2600')
    {
        "Windows XP"
    }
    elseif($target -eq $null)
    {
        "The box is empty"
    }
    else
    {
        "Function not supported"
    }
}

function compare_current_target
{
    if(W_version_current -eq W_version_target)
    {
        "Matching version of Windows detected"
    }
    else
    {
        "Versions of Windows do not match"
    }
} 
```

现在真的不能在函数之外访问所有变量吗？

如果是这样，我还能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:07:48.990

您可能缺少的是使用 PowerShell 的操作顺序，您通常必须将函数调用放在括号中。

试试这个：

```
if ((W_version_current) -eq (W_version_target))
{
    "Matching version of Windows detected"
}
else
{
    "Versions of Windows do not match"
} 
```

要回答您的问题，PowerShell 中的作用域与大多数其他脚本语言非常相似，例如，函数中声明的变量不能在它们声明的函数之外使用，除非您将它们声明为全局，您可以这样做：

```
$global:x = "hi" 
```

然后，您可以在任何地方使用该变量`$x`，或者如果您愿意，`$global:x`它的值将是`"hi"`。

# php - 检查两个日期之间的日期错误，一无所知

> ID：10237220
> 
> 赞同：0
> 
> 时间：2012-04-19T21:39:54.427
> 
> 标签：php

此函数返回两个日期之间的日期数组。

现在它工作得很好，除了一些未知的原因，如果我把它放在 11 月或 3 月作为参数，我会得到一个少一天的数组。其他几个月工作完全正常。我完全一无所知。

```
function getListofDatesInRange2($fromDate, $toDate)
{
    $fromDate = str_replace("-","/", $fromDate);
    $toDate = str_replace("-","/", $toDate);

    $dateMonthYearArr = array();
    $fromDateTS = strtotime($fromDate);
    $toDateTS = strtotime($toDate);

    for ($currentDateTS = $fromDateTS; $currentDateTS <= $toDateTS; $currentDateTS += (60 * 60 * 24)) {
        $currentDateStr = date("m-d-Y",$currentDateTS);
        $dateMonthYearArr[] = $currentDateStr;
    }

return $dateMonthYearArr;
} 
```

我重新编码了它，一个while循环解决了我的问题。（虽然我不知道问题是什么）

```
function getListofDatesInRange2($fromDate, $toDate)
{
$fromDate = str_replace("-","/", $fromDate);
$toDate = str_replace("-","/", $toDate);

$dateMonthYearArr = array();
$fromDateTS = strtotime($fromDate);
$toDateTS = strtotime($toDate);

array_push($dateMonthYearArr, date('m-d-Y', $fromDateTS));
while($fromDateTS < $toDateTS) {
    $fromDateTS += 86400;
    array_push($dateMonthYearArr, date('m-d-Y', $fromDateTS));
}
return $dateMonthYearArr; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:45:51.027

几乎可以肯定，这是由许多年前的某个傻瓜造成的，他们决定将日期放在月份和年份之间，而不是某种逻辑字节序（大多数计算中的大端序，英式英语中的小端序）。

取而代之的是，在输入日期`YYYY-mm-dd`之前将其输入格式`strtotime`。这将确保您始终获得正确的日期。

要测试这确实是您的问题，请尝试：

```
$fromDateTS = strtotime($fromDate);
echo date("m-d-Y",$fromDateTS); 
```

确保显示的日期与您输入的日期相同。很可能不是。

# php - 我可以对所有依赖项使用依赖注入吗？

> ID：10237230
> 
> 赞同：0
> 
> 时间：2012-04-19T21:40:40.640
> 
> 标签：php

我所有的 PHP 都是面向对象的，我想对所有依赖项使用依赖注入（即需要其他类工作的类）。这个可以吗？

我想我发布了很多信息以供阅读......但如果你想要细节，[这里有。](https://stackoverflow.com/questions/10237028/code-library-design-dependency-injection-vs-making-maps-is-dependency-inj)

此外，如果这不会使问题过于复杂，我可以使用工厂模式进行所有依赖注入吗？- 具体信息在上面的链接中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:48:58.773

嗯，是。

依赖注入的全部意义在于**抽象**，为函数/方法/对象/类提供它需要的东西，并让它在其中工作。生成对象和变量以传递给 DI 的工厂很好。

例如：

```
public function pdo_select(PDO $pdo_connection, $table, $where_condition) 
```

在这里，我们传入我们需要的一切，连接对象、表名和`WHERE`MySQL 子句。我们可以通过做进一步抽象这个函数：

```
public function pdo_query(PDO $pdo_connection, $query) 
```

现在，我们不仅仅将我们的功能限制为选择，我们可以进行各种查询。

但是你看到你绝对可以将对象传递给不同的函数来使用。

传递对象还为您提供了**类型提示**的良好触感，如果输入了不同类型的参数，它会抛出错误，帮助您进行调试。

# ruby - 是否可以更改 Ruby 中的线程正在执行的操作？

> ID：10237235
> 
> 赞同：0
> 
> 时间：2012-04-19T21:40:52.820
> 
> 标签：ruby, multithreading, macos

假设我创建了一个这样的线程：

```
thread = Thread.new do
 loop do
  puts "tick"
  sleep(1)
 end
end 
```

如果在某个地方我希望这个线程停止这样做并执行 some_method()，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:45:51.557

让另一个线程设置一个变量，这个线程检查它的值。该方法在此答案中进行了详细说明：[sleep until condition is true in ruby](https://stackoverflow.com/questions/4975747/sleep-until-condition-is-true-in-ruby)

如果`puts "tick"`没有必要，您可以改用条件变量。

# php - 如何保持中文或其他外语的原样而不是转换成代码？

> ID：10237238
> 
> 赞同：4
> 
> 时间：2012-04-19T21:41:07.160
> 
> 标签：php, domdocument, cjk, mb-convert-encoding

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-31T13:50:28.080

> DOMDocument seems to convert Chinese characters into codes [...]. How can I keep the Chinese or other foreign language as they are instead of converting them into codes?

```
$dom = new DOMDocument();
$dom->loadHTML($html); 
```

If you're using the [`loadHTML`](http://php.net/domdocument.loadhtml) function to load a HTML chunk. By default `DOMDocument` expects that string to be in HTML's default encoding (`ISO-8859-1`) however most often the charset (sic!) is meta-information provided next to the string you're using and not inside. To make this more complicated, that meta-information be be even inside the string.

Anyway as you have not shared the string data of the HTML and you have not specified the encoding, it's hard to tell specifically what is going on.

I assume the HTML is UTF-8 encoded but this is not signalled within the HTML string. So the following work-around can help:

```
$doc = new DOMDocument();
$doc->loadHTML('<?xml encoding="UTF-8">' . $html);

// dirty fix
foreach ($doc->childNodes as $item)
    if ($item->nodeType == XML_PI_NODE)
        $doc->removeChild($item); // remove hack
$doc->encoding = 'UTF-8'; // insert proper 
```

It injects an encoding hint on the very beginning (and removes it after the HTML has been loaded). From that point on, `DOMDocument` will return UTF-8 (as always).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-14T04:21:33.163

I just stumbled upon this thread when searching for a solution of a similar problem, i after loading the html properly and doing some parsing with Xpath etc... my text ends up like this:

```
&#20320;&#30340;&#20081;&#21457; 
```

this display fine in the body of the HTML, but won't display properly in a style or script tag (e.g. setting chinese-fonts).

to fix this, do the reverse lauthiamkok did:

```
$html = mb_convert_encoding($html, "UTF-8", "HTML-ENTITIES"); 
```

if for any reason the first workaround doesn't work for you, try this conversion.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-21T12:47:52.000

# sql - 尝试在特定条件下将行合并为一行

> ID：10237239
> 
> 赞同：5
> 
> 时间：2012-04-19T21:41:10.107
> 
> 标签：sql, sql-server, tsql, sql-server-2008-r2

给定 2 行或更多行选择合并，其中之一被标识为模板行。其他行应将其数据合并到模板具有的任何空值列中。

示例数据：

```
Id  Name     Address          City          State   Active  Email             Date
1   Acme1    NULL             NULL          NULL    NULL    blah@yada.com     3/1/2011
2   Acme1    1234 Abc Rd      Springfield   OR      0       blah@gmail.com    1/12/2012
3   Acme2    NULL             NULL          NULL    1       blah@yahoo.com    4/19/2012 
```

假设用户选择了 ID 为 1 的行作为模板行，ID 为 2 和 3 的行将合并到第 1 行，然后删除。行 ID 1 中的任何空值列都应填充（如果存在）最新的（请参阅日期列）非空值，并且行 ID 1 中已经存在的非空值将保持原样。对上述数据的查询结果应该是这样的：

```
Id  Name     Address          City          State   Active  Email             Date
1   Acme1    1234 Abc Road    Springfield   OR      1       blah@yada.com     3/1/2011 
```

请注意，Active 值为 1，而不是 0，因为行 ID 3 具有最近的日期。

**PS 另外，如果不事先明确定义/知道所有列名是什么，有什么方法可以做到这一点？我正在使用的实际表有大量列，并且一直在添加新列。有没有办法查找表中的所有列名，然后使用该子查询或临时表来完成这项工作？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:36:18.657

You might do it by ordering rows first by template flag, then by date desc. Template row should always be the last one. Each row is assigned a number in that order. Using max() we are finding fist occupied cell (in descending order of numbers). Then we select columns from rows matching those maximums.

```
; with rows as (
    select test.*,
  -- Template row must be last - how do you decide which one is template row?
  -- In this case template row is the one with id = 1
    row_number() over (order by case when id = 1 then 1 else 0 end,
                       date) rn
    from test
  -- Your list of rows to merge goes here
  -- where id in ( ... )
),
-- Finding first occupied row per column
positions as (
  select
    max (case when Name is not null then rn else 0 end) NamePosition,
    max (case when Address is not null then rn else 0 end) AddressPosition,
    max (case when City is not null then rn else 0 end) CityPosition,
    max (case when State is not null then rn else 0 end) StatePosition,
    max (case when Active is not null then rn else 0 end) ActivePosition,
    max (case when Email is not null then rn else 0 end) EmailPosition,
    max (case when Date is not null then rn else 0 end) DatePosition
  from rows
)
-- Finally join this columns in one row
select 
  (select Name from rows cross join Positions where rn = NamePosition) name,
  (select Address from rows cross join Positions where rn = AddressPosition) Address,
  (select City from rows cross join Positions where rn = CityPosition) City,
  (select State from rows cross join Positions where rn = StatePosition) State,
  (select Active from rows cross join Positions where rn = ActivePosition) Active,
  (select Email from rows cross join Positions where rn = EmailPosition) Email,
  (select Date from rows cross join Positions where rn = DatePosition) Date
from test
-- Any id will suffice, or even DISTINCT
where id = 1 
```

[You might check it at Sql Fiddle](http://sqlfiddle.com/#!3/3e753/8).

EDIT:

Cross joins in last section might actually be inner joins on rows.rn = xxxPosition. It works this way, but change to inner join would be an improvement.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:40:55.770

It's not so complicated.

At first.. `DECLARE @templateID INT = 1` ..so you can remember which row is treated as template..

Now find latest `NOT NULL` values (exclude template row). The easiest way is to use `TOP 1` subqueries for each column:

```
SELECT
(SELECT TOP 1 Name FROM DataTab WHERE Name IS NOT NULL AND NOT ID = @templateID ORDER BY Date DESC) AS LatestName,
(SELECT TOP 1 Address FROM DataTab WHERE Address IS NOT NULL AND NOT ID = @templateID ORDER BY Date DESC) AS AddressName
-- add more columns here 
```

Wrap above into CTE (Common Table Expression) so you have nice input for your `UDPATE`..

```
WITH Latest_CTE (CTE_LatestName, CTE_AddressName) -- add more columns here; I like CTE prefix to distinguish source columns from target columns..
AS
-- Define the CTE query.
(
    SELECT
    (SELECT TOP 1 Name FROM DataTab WHERE Name IS NOT NULL AND NOT ID = @templateID ORDER BY Date DESC) AS LatestName,
    (SELECT TOP 1 Address FROM DataTab WHERE Address IS NOT NULL AND NOT ID = @templateID ORDER BY Date DESC) AS AddressName
    -- add more columns here
)
UPDATE
<update statement here (below)> 
```

Now, do smart `UPDATE` of your template row using `ISNULL` - it will act as conditional update - update only if target column is null

```
WITH
<common expression statement here (above)>
UPDATE DataTab
SET 
Name = ISNULL(Name, CTE_LatestName), -- if Name is null then set Name to CTE_LatestName else keep Name as Name
Address = ISNULL(Address, CTE_LatestAddress)
-- add more columns here..
WHERE ID = @templateID 
```

And the last task is delete rows other then template row..

```
DELETE FROM DataTab WHERE NOT ID = @templateID 
```

Clear?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T23:25:29.687

对于动态列，您需要使用动态 SQL 编写解决方案。

您可以查询 sys.columns 和 sys.tables 以获取所需的列列表，然后您希望为每个空列向后循环一次，找到该列的第一个非空行并更新该列的输出行。一旦你在循环中达到 0，你就有一个完整的行，然后你可以向用户显示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-01-26T01:18:24.797

I should pay attention to posting dates. In any case, here's a solution using dynamic SQL to build out an update statement. It should give you something to build from, anyway.

There's some extra code in there to validate the results along the way, but I tried to comment in a way that made that non-vital code apparent.

```
CREATE TABLE 
dbo.Dummy 
    (
    [ID] int ,
    [Name] varchar(30),
    [Address] varchar(40) null,
    [City]  varchar(30) NULL,
    [State] varchar(2) NULL,
    [Active] tinyint NULL,
    [Email] varchar(30) NULL,
    [Date] date NULL
    );
--
INSERT dbo.Dummy
VALUES
(
    1, 'Acme1', NULL, NULL, NULL, NULL, 'blah@yada.com', '3/1/2011'
)
,
(
    2, 'Acme1', '1234 Abc Rd', 'Springfield', 'OR', 0, 'blah@gmail.com', '1/12/2012'
)
,
(
    3, 'Acme2', NULL, NULL, NULL, 1, 'blah@yahoo.com', '4/19/2012'
);
DECLARE 
    @TableName nvarchar(128) = 'Dummy',
    @TemplateID int = 1,
    @SetStmtList nvarchar(max) = '',
    @LoopCounter int = 0,
    @ColumnCount int = 0,
    @SQL nvarchar(max) = ''
    ;
--
--Create a table to hold the column names
DECLARE     
    @ColumnList table 
        (
        ColumnID tinyint IDENTITY,
        ColumnName nvarchar(128)
        );
--
--Get the column names
INSERT @ColumnList
(
    ColumnName
)
    SELECT
        c.name
    FROM
        sys.columns AS c
        JOIN
        sys.tables AS t
            ON
                t.object_id = c.object_id
    WHERE
        t.name = @TableName;
--
--Create loop boundaries to build out the SQL statement
SELECT
    @ColumnCount = MAX( l.ColumnID ),
    @LoopCounter = MIN (l.ColumnID )
FROM
    @ColumnList AS l;
--
--Loop over the column names
WHILE @LoopCounter <= @ColumnCount
BEGIN
    --Dynamically construct SET statements for each column except ID (See the WHERE clause)
    SELECT 
        @SetStmtList = @SetStmtList + ',' + l.ColumnName + ' =COALESCE(' + l.ColumnName + ', (SELECT TOP 1 ' + l.ColumnName + ' FROM ' + @TableName + ' WHERE ' + l.ColumnName + ' IS NOT NULL AND ID <> ' + CAST(@TemplateID AS NVARCHAR(MAX )) + ' ORDER BY Date DESC)) '
    FROM 
        @ColumnList AS l
    WHERE 
        l.ColumnID = @LoopCounter
        AND
        l.ColumnName <> 'ID';
--
    SELECT
        @LoopCounter = @LoopCounter + 1;
--
END;

--TESTING - Validate the initial table values
SELECT * FROM dbo.Dummy ;
--
--Get rid of the leading common in the SetStmtList
SET @SetStmtList = SUBSTRING( @SetStmtList, 2, LEN( @SetStmtList ) - 1 );
--Build out the rest of the UPDATE statement
SET @SQL = 'UPDATE ' + @TableName  + ' SET ' + @SetStmtList + ' WHERE ID = ' + CAST(@TemplateID AS NVARCHAR(MAX ))
--Then execute the update
EXEC sys.sp_executesql
    @SQL;
--
--TESTING - Validate the updated table values
SELECT * FROM dbo.Dummy ;
--
--Build out the DELETE statement
SET @SQL = 'DELETE FROM ' + @TableName + ' WHERE ID <> ' + CAST(@TemplateID AS NVARCHAR(MAX ))
--Execute the DELETE
EXEC sys.sp_executesql
    @SQL;
--
--TESTING - Validate the final table values
SELECT * FROM dbo.Dummy; 
--
DROP TABLE dbo.Dummy; 
```

# asp.net - IIS 7 GZIP 压缩和内容编码错误

> ID：10237246
> 
> 赞同：1
> 
> 时间：2012-04-19T21:41:46.040
> 
> 标签：asp.net, asp.net-mvc-3, iis-7, gzip

我的 MVC 3 应用程序有一个小问题。该服务器具有 GZIP 压缩功能，效果很好。但是，有时，我们会在应用程序的根目录中放置带有静态 html 页面的文件夹：/somefolder/index.html 并且由于某种原因，当我第一次导航到此 URL（未压缩）时，它会显示页面正常，但下一次它在浏览器中出现“内容编码错误”的错误，如下所示：

[https://encrypted-tbn2.google.com/images?q=tbn:ANd9GcS-a0WLnasCsHWHPaszTvyLoHCWO_6EtlUBxZ6-aFADBtl8QoRp](https://encrypted-tbn2.google.com/images?q=tbn:ANd9GcS-a0WLnasCsHWHPaszTvyLoHCWO_6EtlUBxZ6-aFADBtl8QoRp)

有谁知道如何解决这一问题？我需要从压缩中排除 html 文件吗？这个文件夹超出了 MVC3 框架，所以也许添加一个路由到它，或者忽略这个路径会修复它？请指教，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-24T17:26:13.483

如果有人遇到这种情况：

问题是我有一个磁带项目以及服务器的 GZIP 功能。缩小库抛出错误，浏览器不知道如何处理它，所以它失败了。解决方法是将此行添加`settings.IsHtmlRewritingEnabled = false;`到磁带配置文件的`Configure()`方法中。

# java - 使用 Java API 时如何在 ElasticSearch 中使用特定的分析器

> ID：10237249
> 
> 赞同：3
> 
> 时间：2012-04-19T21:42:00.307
> 
> 标签：java, elasticsearch

我正在尝试使用 Java API 在 ElasticSearch 中运行特定搜索。它运作良好，但我需要使用雪球分析仪。

我真正想要的是使用 Java API实现这种搜索： [http://localhost:9200/myindex/myfeed/_search?q=myterm:myvalue&analyzer=myanalyzer 。](http://localhost:9200/myindex/myfeed/_search?q=myterm:myvalue&analyzer=myanalyzer)

我正在使用具有许多不同类型查询（过滤、全部匹配、文本）的 TransportClient。我正在批量运行多个搜索查询。

我在 SearchRequestBuilder 中看不到任何与分析器相关的内容。我找错地方了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T02:55:13.457

您的请求将转化为

```
 client.prepareSearch("myindex", "myfeed")
            .setQuery(
                    QueryBuilders.queryString("myterm:myvalue")
                            .analyzer("myanalyzer")
            )
            .execute()
            .actionGet(); 
```

通常，当您在将 Rest API 请求转换为 JavaAPI 请求时遇到问题时，请查看 Rest???Action 类，其中 ??? 是您的请求的名称。例如，如果您想了解有关构建搜索请求的更多信息，请查看[RestSearchAction.java](https://github.com/elasticsearch/elasticsearch/blob/04a138db5ddf3f28ffd0d7f81054b05c3c6aa02d/src/main/java/org/elasticsearch/rest/action/search/RestSearchAction.java#L154)。您还可以在 elasticsearch[集成测试](https://github.com/elasticsearch/elasticsearch/tree/master/src/test/java/org/elasticsearch/test/integration/search/basic)中找到许多 java API 示例。

# ruby-on-rails - 在 Rails 计费系统中将付款应用于发票

> ID：10237250
> 
> 赞同：1
> 
> 时间：2012-04-19T21:42:01.873
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, billing, recurring-billing

我已经为我的业务（无线 ISP）编写了一个自定义计费系统的大部分功能部分，但其中的一些内容让我自己感到困惑。

这是基本概述：它是我的客户的定期计费系统，每月自动生成并向每个客户发送发票。但是，我需要允许支票/现金支付，因为我与当地客户打交道，并且还需要允许预付款，所以我不能只使用 Stripe 的定期账单。从本质上讲，付款与发票没有直接关联，以允许这些类型的付款。

**模型/发票.rb**

```
class Invoice < ActiveRecord::Base
  belongs_to :customer
  has_many :line_items
  has_many :invoice_payments
  has_many :payments, through: :invoice_payments 
```

**模型/付款.rb**

```
class Payment < ActiveRecord::Base
  belongs_to :customer 
```

**模型/客户.rb**

```
class Customer < ActiveRecord::Base
  has_many :subscriptions, dependent: :destroy
  has_many :services, through: :subscriptions
  has_many :invoices, :order => 'id DESC'
  has_many :payments 
```

我需要一种可以自动将所有未应用的付款与所有未付发票关联的方法。现在我把它`def apply_unapplied_payments`放在客户模型上，但以后可能会将它抽象到它自己的 lib/.modules 模块中。

这是我迄今为止在**models/customer.rb中所做的**

```
def apply_unapplied_payments
  unpaid_invoices = invoices.find_by_status("unpaid")
  unapplied_payments = payments.where("invoice_id is null")
  unpaid_invoices.each do |invoice|
    # find the oldest unapplied payment
    # apply payment to this invoice
    # if payment > invoice, keep whatever amount is left and move to next invoice
    # apply leftover amount to invoice, if invoice is still unpaid, move to next unapplied payment
  end
  customer.update_balance
end 
```

关于用什么填写伪代码有什么建议吗？我对任何级别的重构持开放态度，所以如果您能想出更好的方法来处理这个问题，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T04:16:33.430

这是我要做的（可能需要付款和发票类中的一些辅助方法）：

```
def apply_unapplied_payments
  unpaid_invoices = invoices.find_by_status("unpaid")
  unapplied_payments = payments.where("invoice_id is null")
  invoice = unpaid_invoices.shift
  payment = unapplied_payments.shift
  while invoice && invoice.remaining_balance > 0 && payment && payment.remaining_credit > 0
      apply_payment_to_invoice(invoice, payment)
      invoice = unpaid_invoices.shift    if invoice.remaining_balance == 0
      payment = unapplied_payments.shift if payment.remaining_credit  == 0
  end
end 
```

# android - 为什么没有 Service.onStop 方法？

> ID：10237253
> 
> 赞同：32
> 
> 时间：2012-04-19T21:42:15.627
> 
> 标签：android, android-service

我已经阅读了很多关于 Android 服务的内容。据我了解，生命周期是：

```
void onCreate() 
    void onStart(Intent intent) 
    ...
void onDestroy() 
```

[http://www.linuxtopia.org/online_books/android/devguide/guide/topics/fundamentals.html](http://www.linuxtopia.org/online_books/android/devguide/guide/topics/fundamentals.html)

但是没有 onStop 方法。问题：

*   *为什么*没有停止方法？
*   在我的服务上发出 stopService 请求时会发生什么？（从外部，也许是 Android 本身）。我可以检测到这个事件吗？
*   我想强制（或至少验证）我的服务是进程中的单例。我该怎么做（或者 Android 在幕后强制执行此操作）？

对于上下文，我有一些我想在服务运行时分配和释放的资源（在“启动”中），以及另一组我想在服务处于“创建”状态时分配和释放的资源.

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-04-19T21:46:35.360

> 据我了解，生命周期是：

`onStart()`已被弃用几年。`onStartCommand()`是当前的生命周期方法。

> 为什么没有停止方法？

因为不需要一个。

> 在我的服务上发出 stopService 请求时会发生什么？

您将被调用`onDestroy()`。

> 我可以检测到这个事件吗？

您可以覆盖`onDestroy()`.

> 我想强制（或至少验证）我的服务是进程中的单例。我该怎么做（或者 Android 在幕后强制执行此操作）？

服务是自然的单例。在任何给定时间，您的服务都会有 0 或 1 个实例。

> 对于上下文，我有一些我想在服务运行时分配和释放的资源（在“启动”中），以及另一组我想在服务处于“创建”状态时分配和释放的资源.

“创建”状态与命令模式 ( `startService()`and `onStartCommand()`) 和绑定模式 ( `bindService()`and `onBind()`) 一起使用。因此，如果您调用`startService()`，您的服务将完全处于“已创建”状态，希望不到一毫秒。

# java - 在 Java 5 中实现 ListeningExecutorService

> ID：10237259
> 
> 赞同：2
> 
> 时间：2012-04-19T21:42:55.693
> 
> 标签：java, guava, type-erasure, type-parameter

在 Java 5 中，`ExecutorService`接口声明了方法：

```
<T> List<Future<T>> invokeAll(Collection<Callable<T>> tasks)
    throws InterruptedException; 
```

而用 Java 6 编写但据称与 Java 5 兼容的 Guava 11.0.2 将其覆盖`ListeningExecutorService`为：

```
 <T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks)
     throws InterruptedException; 
```

如果我想实现我自己的`ListeningExecutorService`，我需要实现这两种方法，但我也不能有两种方法相同的擦除，所以它有点像 Catch 22。

有没有办法解决这个问题？更具体地说，有没有办法`ListeningExecutorService`在 Java 5 中实现 a？

作为任何番石榴人的旁注——番石榴是否真的有必要重新声明这种方法，因为它已经继承自`ExecutorService`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:14:58.473

原始方法签名已报告为错误并已针对 JDK 6 进行了修复： [http ://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6267833](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6267833)

引用解决消息：

> *   是二进制兼容的。
> *   与 ExecutorService的*用户*源兼容
> *   对于已经实现 ExecutorService 而没有继承 AbstractExecutorService 中的默认实现的一小部分开发人员，需要对源代码进行少量更改。受影响的开发人员是创建复杂线程池应用程序的开发人员，将他们归入“并发火箭科学家”类别。他们通常会欣赏这种变化。在源代码中修复可能的编译器错误是微不足道的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T22:16:06.973

我能想到实现这两个接口的唯一方法，虽然很可怕，是

```
List invokeAll(Collection tasks) 
```

放弃泛型类型，记录你这样做的原因，并非常小心。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T09:10:19.277

我们完成这项工作的方式是在我们的引导类路径中覆盖 JDK 的 ExecutorService 接口。您可以在项目编译期间执行类似的操作。查看我们的设置的最简单方法可能是[在版本 12 中删除它的更改](http://code.google.com/p/guava-libraries/source/detail?r=81c09f3e5cd27a246cae58247825aa96af94b99d&name=release12)（因为该版本需要 JDK6）。

# c# - 从数据网格视图中获取 PK 值

> ID：10237264
> 
> 赞同：0
> 
> 时间：2012-04-19T21:43:24.643
> 
> 标签：c#, datagridview

我有一个从数据库加载到 dataGridView 中的数据，效果如下所示：

![患者数据网格视图示例](../Images/d220f1cf7334a7a191c02fc3260ba3c0.png)

（在最终版本中，我希望隐藏 PatientID 列）

我想要做的是，当用户单击相应行中的 ANYWHERE 时返回 PatientID 的值（即用户单击“Doe”并且返回的值是“2”）。谁能给我一个提示如何做到这一点？我不认为有 valueMember 属性...我正在尝试 Rowindex 但它返回从顶部计数的行数的值（D'uh？！）

另外，有没有办法让用户在单击单个单元格时突出显示整行？

编辑：哦，上帝​​，我在深夜花了几个小时才找到这个，早上我放弃并在这里发布......只是为了在 5 分钟后找到答案：

```
string test = dataGridView1.Rows[e.RowIndex].Cells["PatientID"].FormattedValue.ToString(); 
```

不过，这留下了我关于突出显示整行的第二个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:52:16.873

如果datagridview绑定到某个数据源（`DataView`），可以使用`DataBoundItem`属性，例如

```
DGV.CurrentRow.DataBoundItem["PatientID"] 
```

或者

```
DGV.SelectedRows[0].DataBoundItem["PatientID"] 
```

或者

```
DGVUnderlyingBindingSource.Current["PatientID"] 
```

如果 DataGridView 绑定到强类型数据源（例如`BindingList`），那么您可以像这样使用上面的内容：

```
((PatientType)DGV.CurrentRow.DataBoundItem).PatientID 
```

或者

```
((PatientType)DGV.SelectedRows[0].DataBoundItem).PatientID 
```

或者

```
((PatientType)PatientTypeBindingSource.Current).PatientID 
```

关于问题的第二部分，将 DataGridView 的`SelectionMode`属性设置为`FullRowSelect`

*编辑*

如果隐藏该列，则无法使用编辑中的解决方案。为了通过使用`.Cells[idx].FormattedValue`该值来访问该值，该值必须是可见的。但是，即使您隐藏了该列，您也可以使用这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:55:42.640

对于第二个问题，将选择模式设置为 FullRowSelect，当用户单击它时，将突出显示完整的行。您可以在设计器或代码中设置此属性：

```
DataGridView1.SelectionMode = DataGridViewSelectionMode.FullRowSelect; 
```

# image-processing - 在 WordPress 中管理图像提交

> ID：10237266
> 
> 赞同：0
> 
> 时间：2012-04-19T21:43:28.393
> 
> 标签：image-processing, wordpress, expressionengine

我有一个客户端 WordPress 网站，允许用户从前端上传自定义艺术品。

我使用 TDO Mini Forms 创建提交表单，但它似乎没有在上传时进行文件操作的选项。因此，图像通常非常大，有时是 CMYK，并且存在各种其他问题。

在某种程度上，我使用 WP 的媒体设置解决了尺寸问题，但有两个问题让我很烦恼：

1.  它没有解决 CMYK 问题（诚然，这种情况很少发生，但仍会提示客户打来电话）。
2.  WP 不会丢弃原始图像，这会创建巨大的备份文件。

是否有一个扩展可以更好地管理提交的图像？即使它涉及替换提交表单（TDO Mini Forms 运行良好，但一段时间以来一直不受支持），我正在寻找任何满足此需求的解决方案。

IMO，黄金标准将是 WP 等效于 ExpressionEngine 的[Safecracker](http://devot-ee.com/add-ons/safecracker) + DevDemon 的[ChannelImages](http://www.devdemon.com/channel_images/)。

外面有什么吗？我不能是唯一一个在寻找这个的人。

与往常一样，非常感谢任何帮助。

泰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T17:59:47.870

不知道它是否正是您需要的，但这可能会帮助您：

[http://www.verot.net/php_class_upload.htm](http://www.verot.net/php_class_upload.htm)

它集成到我几个月前用于客户的这个插件中： [http ://wordpress.org/extend/plugins/photosmash-galleries/](http://wordpress.org/extend/plugins/photosmash-galleries/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T12:56:55.380

解决方案是一个名为 Imsanity (http://wordpress.org/extend/plugins/imsanity/) 的插件。

它仍然没有解决 CMYK 问题，但它确实管理文件大小，这是更紧迫的问题。

它还具有追溯性，因此如果您的网站上已经有大图像，则可以批量调整它们的大小。

# php - 通过 __get() 实例化时找不到自动加载的类

> ID：10237270
> 
> 赞同：0
> 
> 时间：2012-04-19T21:43:44.503
> 
> 标签：php

这是我的自动加载和调用/实例化我的类的代码

```
public function __get($name)
{
    $classname = '\\System\\' . ucfirst($name);

    if (property_exists($this, '_' . $name))
        $this->{'_' . $name} = new $classname();
    else
        echo $name . ' isn\'t a valid property.';
}

private function boot()
{echo "<pre/>";
    spl_autoload_register(null, false);

        if (function_exists('__autoload'))
            spl_autoload_register('__autoload');

        spl_autoload_register(array($this, 'libraries'));
var_dump($this->helper);
        //$this->configuration();
} 
```

当我打电话时，`$this->helper`我收到此错误

```
Fatal error:  Call to a member function test() on a non-object in (...) 
```

`__get()`所以我的问题是，调用该方法时是否仍在加载类？

是的，该方法`test()`确实存在于我的`Helper`班级中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:48:31.697

它应该是`$this->_helper->test();`你的代码正在做的：`$this->{'_' . $name} = new $classname();`

您的神奇方法是在每次调用时重新实例化该类。你应该让它检查它是否是`null`第一个：

```
if (property_exists($this, '_' . $name) && $this->{'_' . $name} !== null) 
```

# c - 从 C 文件中的数组写入和打印字符串

> ID：10237272
> 
> 赞同：2
> 
> 时间：2012-04-19T21:43:58.263
> 
> 标签：c, arrays, text, text-files

我有一个数组被写入文件，但是当我调用函数时，我需要一种方法从文件中打印相同的信息。代码的第一部分在 main 函数中，第二部分是第二个函数，它打印出应该来自文件 ( `fp`) 的值。

```
fp = fopen("Grue.txt", "wb");
for(i = 0; i < 5; i++)
{
    char newLine[3] = {"\n"};
    char space[2] = {" "};
    fwrite(array[i].name, strlen(array[i].name), sizeof(char), fp);
    fwrite(space, strlen(space), sizeof(char), fp);
    fwrite(array[i].height, strlen(array[i].height), sizeof(char), fp);
    fwrite(space, strlen(space), sizeof(char), fp);
    fwrite(array[i].weight, strlen(array[i].weight), sizeof(char), fp);
    fwrite(space, strlen(space), sizeof(char), fp);
    fwrite(array[i].items, strlen(array[i].items), sizeof(char), fp);
    fwrite(newLine, strlen(newLine), sizeof(char), fp);
}
fclose(fp);
fp = fopen("Grue.txt", "rb");
PrintAGrue(fp);

void PrintAGrue(FILE *a)
{
 // create End of file character onto the array being saved,
int i;
char n;
char h;
char w;
char m;

for (i=0; i<5; i++)
{
     n = fread(a[i].name,  strlen(array[i].name, sizeof(char), a);
     h = fread(array[i].height,  strlen(array[i].height, sizeof(char), a);
     w = fread(array[i].weight,  strlen(array[i].weight, sizeof(char), a);
     m = fread(array[i].items,  strlen(array[i].items, sizeof(char), a);

     printf("This grue is called %s and is %s feet tall, and weighs %s pounds, and has eaten %s things.", n, h, w, m);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:53:14.080

在`PrintAGrue`中，看起来您正在使用`strlen()`调用来决定要读取多少数据——但是您如何在读取字符串*之前*知道它的大小？（另外，括号看起来不平衡......）

也许您的文件格式应该为每个字符串显式包含一个长度字段——然后您可以做一个`fread`来查找字符串大小，另一个来实际读取字符串。

# java - ListGrid 中的 SmartGWT 动态列（客户端）

> ID：10237274
> 
> 赞同：0
> 
> 时间：2012-04-19T21:44:02.570
> 
> 标签：java, grails, smartgwt

我想创建一个 ListGrid，用户可以在其中添加列以定义每列的一些值行，就像 Excel 表一样。垂直添加值应该和垂直添加一样简单。我是网络开发的新手，我指望更有经验的朋友。我将 SmartGWT 与 grails 框架一起使用，所以我不需要 SmartGWT 服务器，因为它要花很多钱。所以我使用的数据源类型是 RestDataSource。但存在不能动态修改的限制。

当我在网上搜索解决方案时，我看到 smartGWT EE 可以做一些事情，例如提供 xml 数据源，可以根据请求进行修改。有人知道如何在不使用 smartgwt 服务器等商业解决方案的情况下实现这种效果吗？我什至可以改变项目中的技术来完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:52:33.537

查看[Grids > Data Binding > Inline Data](http://www.smartclient.com/smartgwt/showcase/#grid_databinding_inline_data)的[源代码](http://www.smartclient.com/smartgwt/showcase/sourcegen/grid/databinding/GridDataBindingInlineDataSample.java.html#)，您可以轻松地使用服务器中的任何自定义格式。只需创建一个数组并将其设置为. 看起来很简单，所以我不确定您为什么需要 SmartGWT 服务器等商业解决方案来满足这个简单的要求。`ListGridRecord[]``listGrid.setData()`

# security - 基于 Salesforce APEX 的共享。我在正确的方向吗？

> ID：10237277
> 
> 赞同：0
> 
> 时间：2012-04-19T21:44:26.987
> 
> 标签：security, salesforce, apex-code

我们有一个 Salesforce 应用程序，其中有一些自定义对象，并希望向客户公开各种自定义对象记录。

我们需要确保客户只能看到属于其帐户的记录。由于这些记录的设置方式（由不同处理级别的各种系统用户拥有），我们不能使用基于所有者的共享......并且不能使用基于标准的共享，因为它不是动态的（我不能使用基于标准的共享来说“与与记录属于同一帐户的所有客户门户用户共享此记录”在运行时）。

所以我知道我必须使用基于 Apex 的共享。我已经阅读了共享对象和共享表。但我将如何处理这个问题。

我可以编写一个触发器，在插入时将创建一个共享对象并获取属于客户门户组且其帐户等于记录帐户的所有用户 ID，并将它们与记录的共享对象相关联。

但我觉得这是矫枉过正对吗？假设我们的一位客户有 5 个用户，假设每天创建 500 条记录...这意味着每天为 1 个客户共享 2500 个共享对象...对于 10 个客户，这可以达到 25000...并且以这种方式缩放...

我在这里吗？

另一个问题是，如果一个新人加入了该客户团队。除非另一个进程更新旧记录上的共享，否则他/她看不到旧记录。

那么有没有更好/优雅的方法来做到这一点？我想在组中添加一个共享对象...但是只有一个组“客户门户组”，我如何将该组与用户的帐户相关联？

我将不胜感激对此的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T19:49:55.890

You should take a look at high-volume customer portal users. They're much cheaper relative to standard customer portal users and should meet your needs. Unlike regular users they have a totally different sharing concept. In a nutshell if they own an object they can see, if not they can't. You can then extend this based on whether a contact or account lookup on the object matches the logged in user.

Read up on this documentation:

*   [License Types](https://login.salesforce.com/help/doc/en/users_understanding_license_types.htm) (scan to High Volume Customer Portal)
*   [Granting High-Volume Portal Users Access to Records](https://cs12.salesforce.com/help/doc/user_ed.jsp?loc=help&target=customer_portal_setting_light_users.htm#SharingSets&section=CustomerPortal) (login required)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T18:37:27.887

您可以使用群组进行共享，以避免创建过多的共享记录。您将拥有每个帐户一个组和每个帐户一个共享记录。您必须管理数百个组，而不是管理数千条共享记录。我没有在这么多组中尝试过这种方法，但我前段时间读到它应该可以工作（有人使用很多组进行分享）。如果您尝试这样做，请告诉我们它是否工作正常。

# ios - 在 Xcode 4 中移动本地化文件夹

> ID：10237285
> 
> 赞同：3
> 
> 时间：2012-04-19T21:45:11.537
> 
> 标签：ios, xcode, xcode4

我最近从 Xcode 3 升级到 Xcode 4.2，并迁移了现有的 iOS 应用程序以使用这个新版本。这个应用程序已本地化，我现在想添加另一种语言。

在 Xcode 4 下，当我添加新的本地化时，它会在项目根目录中创建国家特定文件夹。例如：

```
/fr.lproj 
```

但是，我之前的所有语言文件夹都在 Resources 子文件夹中。如：

```
/Resources/de.lproj
/Resources/en.lproj 
```

对于我的生活，我无法弄清楚如何让 Xcode 4 将新语言文件夹移动到`Resources`. 我找不到 GUI 选项。如果我使用 Finder 移动物理文件夹，Xcode 只会将引用更改为红色，但我无法修复它。

任何人都可以帮忙吗？

**更新：**

下面是几个演示问题的截图（这次使用中文）：

文件清单：

![Xcode 中的实际文件](../Images/5d9fc0c27c9b5cc51183971a50c6bc1d.png)

该文件的标识部分。请注意，我无法更改它：

![在此处输入图像描述](../Images/36a2164c8b5a7832ba728e91a831365f.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-20T13:50:51.110

找到了解决方案。它不漂亮，但它有效。

这是我所做的：

1.  `.xcodeproj`在 Finder 中查看文件夹的内容
2.  编辑`project.pbxproj`文件
3.  `.lproj`在文件中搜索
4.  更改`path =`部分以包含`Resources`路径的一部分。
5.  保存，然后重启 Xcode

这使一切顺利，并允许本地化驻留在资源子目录中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-04T07:34:10.397

这是一种无需编辑 .pbxproj 文件（Xcode 4.6.3）即可解决的方法：

1.  选择本地化父文件（Localizable.strings）
2.  实用程序窗格 > 身份和类型 > 在位置（相对于组）下选择路径图标并为本地化文件设置所需的新位置
3.  Finder > 将所有 en.lproj、fr.lproj 等子文件夹移动到所选文件夹

*UPD*：在 Xcode 8 中不起作用 :(

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-18T07:32:36.977

这种方式也适用于 Xcode 5.1（希腊语示例）：

1.  在 Finder 的文件中创建`Resources/el.lproj`文件夹`Localizable.strings`
2.  在 Xcode 中打开您的项目文件并右键单击`Resource`文件夹
3.  单击“将文件添加到...”上下文菜单项
4.  从文件夹中选择 Localizable.strings 文件`Resources/el.lproj`-> 确定。希腊语`Localizable.strings`将自动添加到`Localizable.strings`文件中。

您可以使用相同的方式为 xib 文件添加本地化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T02:45:38.420

磁盘上的文件结构在 Xcode 中几乎是无关紧要的。只需在 Finder 中移动目录，然后在 Xcode 中您可以：（a）删除 fr.lproj 目录并重新添加它，或（b）选择红色条目，打开右侧（属性）面板，然后靠近顶部你应该看到路径。将路径更改为新位置，它将变回黑色。

# python - python subprocess - 如何检查PIPE中是否没有任何新数据？

> ID：10237291
> 
> 赞同：3
> 
> 时间：2012-04-19T21:45:40.057
> 
> 标签：python, subprocess, popen, readline, eof

我有以下示例：

```
import subprocess

p = subprocess.Popen("cmd",stdin = subprocess.PIPE, stdout=subprocess.PIPE )
p.stdin.write(b'cd\\' + b'\r\n')
p.stdin.write(b'dir' + b'\r\n')
p.stdin.write(b'\r\n')

while True:
    line = p.stdout.readline()
    print(line.decode('ascii'), end='')
    if line.rstrip().decode('ascii') == 'C:\>': #I need to check at this point if there is new data in the PIPE
        print('End of File')
        break 
```

我正在听 PIPE 以获取子流程的任何输出，如果没有任何新数据通过 PIPE，我想停止阅读。我想要一个控制语句，告诉我 PIPE 是空的。如果我的流程冻结或以意外结果结束，这将帮助我避免出现问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T00:07:25.640

除非进程结束或有一个您希望停止读取的信号，否则没有好的方法可以提前知道管道中是否有数据，因为该命令只会在达到您的字节数时终止想要读取 [.read(n)]，到达换行符 [.readline()]，或到达文件末尾（直到进程结束才存在）。

但是，您不需要运行 cmd.exe 来运行您的程序，因为您的程序已经在 cmd shell 中运行。

我建议你使用 subprocess 直接调用程序，并在你的代码中处理异常/return_code。你可以做类似...

```
import subprocess
import time

p = subprocess.Popen("your_program.exe",
                     "-f", "filename",
                     stdin=subprocess.PIPE,
                     stdout=subprocess.PIPE)

# If you have to use stdin, do it here.
p.stdin.write('lawl here are my inputs\n')

run_for = 0
while p.poll() == None:
    time.sleep(1)
    if run_for > 10:
        p.kill()
        break
    run_for += 1

if p.return_code == 0:
    ...handle success...
else:
    ...handle failure... 
```

您可以在循环中执行此操作并启动一个将运行下一个文件的新进程。

如果启动程序的*成本*如此之高（如果它不是那么现在停止阅读，因为它即将变得尴尬）那么也许（这完全是一个黑客，但是）在你的进程运行一段时间之后，你可以通过一个特别p.stdin 的奇怪但无害的字符串，如`p.stdin.write("\n~%$%~\n")`.

如果你能摆脱它，那么你可以做类似的事情......

```
for line in p.stdout.readlines():
    if '~%$%~' in line:
        break 
```

但是，天哪，请不要那样做。这是一个黑客。

# java - 如何将整数文本行转换为整数数组？

> ID：10237297
> 
> 赞同：3
> 
> 时间：2012-04-19T21:45:57.050
> 
> 标签：java

我有一个文本文件，其中一半的行是名称，每隔一行是一系列用空格分隔的整数：

```
Jill

5 0 0 0

Suave

5 5 0 0

Mike

5 -5 0 0

Taj

3 3 5 0 
```

我已经成功地将名称转换为字符串数组列表，但我希望能够读取每隔一行并将其转换为整数数组列表，然后制作这些数组列表的数组列表。这就是我所拥有的。我觉得它应该可以工作，但显然我做的不对，因为我的整数数组列表中没有任何内容。

rtemp 是单行整数的数组列表。allratings 是数组列表的数组列表。

```
while (input.hasNext())
        {

            count++;

            String line = input.nextLine(); 
            //System.out.println(line);

            if (count % 2 == 1) //for every other line, reads the name
            {
                    names.add(line); //puts name into array
            }

            if (count % 2 == 0) //for every other line, reads the ratings
            {
                while (input.hasNextInt())
                {
                    int tempInt = input.nextInt();
                    rtemp.add(tempInt);
                    System.out.print(rtemp);
                }

                allratings.add(rtemp);  
            }

        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T21:49:37.313

这不起作用，因为您在检查它是 String 行还是 int 行之前读取了该行。因此，当您打电话时，`nextInt()`您已经超过了数字。

您应该做的是`String line = input.nextLine();`在第一个案例中移动，或者更好的是，直接在线上工作：

```
String[] numbers = line.split(" ");
ArrayList<Integer> inumbers = new ArrayList<Integer>();
for (String s : numbers)
  inumbers.add(Integer.parseInt(s)); 
```

# performance - MONO 的新 Relic 替代品？

> ID：10237299
> 
> 赞同：4
> 
> 时间：2012-04-19T21:45:59.477
> 
> 标签：performance, mono, monitoring, saas

我有一堆基于单声道的服务器在 heroku 上运行。我希望有像 New Relic 这样的东西，但这与 MONO 不兼容。

有没有我可以使用的替代方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-12T06:27:19.017

我知道这不是一个替代方案，但我在这篇博文中详细介绍了如何让 Web 请求代理在 Mono 下工作： [Getting NewRelic monitoring working on Mono .Net Web Apps](http://www.thomasvjames.com/2012/07/getting-newrelic-monitoring-working-on-mono-net-web-apps/)

1.  获取 x86/x64 的安装程序
2.  在 windows 框中使用 msiexec 使用管理员安装 (msiexec /a ) 提取内容
3.  将 GAC dll 复制到应用程序的 bin
4.  将 newrelic.xml 复制到应用程序中的 newrelic.config
5.  在 web.config 文件中添加对“NewRelic.Agent.Core.Tracer.Web.NewRelicHttpModule, NewRelic.Agent.Core”的 httpModule 引用。
6.  编辑 newrelic.config 文件并提供您的许可证密钥
7.  部署并观察这些统计数据

# objective-c - 我还没有理解弱引用和强引用

> ID：10237303
> 
> 赞同：3
> 
> 时间：2012-04-19T21:46:27.873
> 
> 标签：objective-c

通过书籍首先解释了关于“无效”引用的问题（使用 ARC），如下例所示：

```
NSDate* date1=[[NSDate alloc]init];
NSDate* date2=date1;
[date1 release];
NSLog(@"%@",date2); // bad access 
```

所以我理解了保留/释放机制：在这种情况下，指令将是：

```
date2=[date1 retain]; 
```

但是当它谈到强/弱引用时，这对我来说听起来很矛盾：

“默认情况下，引用是强引用。如果您将对象分配给强引用，ARC 会假定您希望该对象保留并隐式保留它”

这不是和之前说的矛盾吗？
date2 默认情况下很强大，因此它应该隐式保留 date1 并且不会出现错误的访问异常。
当然我误解了一些东西，有人可以更好地向我解释一下吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-19T22:12:07.813

Strong 是默认设置，因为它通常是您想要的，但是使用 ARC，编译器会分析对象的生命周期需要多长时间并在适当的时间释放内存。例如：

```
- (void)someMethod
{
  NSDate* date = [[NSDate alloc] init]; // date is __strong by default
  NSLog(@"The date: %@", date); // date still contains the object created above

  // Sometime before this point, the object date pointed to is released by the compiler
} 
```

弱引用只保留对象，而它有一个或多个其他强引用。一旦最后一个强引用被破坏，编译器就会释放该对象，并且`nil`运行时将弱对象引用（变量）更改为。这使得弱变量在局部范围内几乎没有用，就像上面的例子一样。例如：

```
- (void)someMethod
{
  __weak NSDate* date = [[NSDate alloc] init]; // The date created is released before it's ever assigned to date 
                                               // because date is __weak and the newly created date has no 
                                               // other __strong references
  NSLog(@"The date: %@", date); // This always prints (null) since date is __weak
} 
```

看一个弱变量和强变量在局部范围内一起工作的例子（这只会严重限制有用性，这里实际上只是为了演示弱变量引用）：

```
- (void)someMethod
{
  NSDate* date = [[NSDate alloc] init]; // date stays around because it's __strong
  __weak NSDate* weakDate = date;

  // Here, the dates will be the same, the second pointer (the object) will be the same
  // and will remain retained, and the first pointer (the object reference) will be different
  NSLog(@"Date(%p/%p): %@", &date, date, date);
  NSLog(@"Weak Date(%p/%p): %@", &weakDate, weakDate, weakDate);

  // This breaks the strong link to the created object and the compiler will now
  // free the memory. This will also make the runtime zero-out the weak variable
  date = nil;

  NSLog(@"Date: %@", date); // prints (null) as expected
  NSLog(@"Weak Date: %@", weakDate); // also prints (null) since it was weak and there were no more strong references to the original object
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T22:09:59.237

关键错误在于将手动保留释放行为与 ARC 混淆为相同。它不是。在 ARC 下，对象分配既是原子的，又是决定对象生命周期的表达式。

以你的例子并删除`retain`. 你最终得到这个：

```
NSDate* date1=[[NSDate alloc]init];
NSDate* date2=date1;
NSLog(@"%@",date2); 
```

在 ARC 下非常有意义；没有手动释放把事情搞砸了。即它会自动工作。

更好的是，因为编译器在幕后进行流控制分析，所以不需要额外的保留或释放。代码实际上是这样的：

```
NSDate* date1; // date1 initialized to nil -- or not given that it is never read before...
date1 = [[NSDate alloc]init]; // ... this assignment (of a +1 retain count obj)
NSDate* date2=date1; // retain count unchanged
NSLog(@"%@",date2); // retain count unchanged
.... compiler emits equivalent to [date1 release] ... 
```

由于编译器`release`在最后一次使用`date1` *or* `date2`之后才会发出它，所以永远不会有悬空指针。

# google-maps - 如何允许其他人嵌入我的自定义 Google 地图？

> ID：10237305
> 
> 赞同：1
> 
> 时间：2012-04-19T21:46:31.260
> 
> 标签：google-maps, google-maps-api-3

我为虚构的世界制作了带有自定义图块和标记的自定义 Google 地图。它尚未公开，但最明显的相关性是 mapwow.com。现在是否可以允许其他人将我的自定义地图嵌入到他们的站点或应用程序中？大多数搜索结果只是二级（谷歌>我的网站），理想情况下我正在寻找三级（谷歌>我的网站>他们的网站）。我的猜测是，这可以使用 a) 自定义 URL 参数将视口集中在指定的 lon/lat 和 b) 指向我网站上该 URL 的 IFRAME，但我想知道是否有更好的或“官方”的方式来做这样的事情。IFRAME 并不是论坛或 wiki 软件中普遍支持的标签。

# java - 我根本没有得到线程同步

> ID：10237310
> 
> 赞同：1
> 
> 时间：2012-04-19T21:46:46.783
> 
> 标签：java, multithreading, synchronization

所以我已经阅读了很多关于 Java 中的线程同步的内容。我目前正在尝试有界缓冲区问题。生产者将继续在缓冲区上生产产品，而消费者继续消费它。

如果缓冲区已满，生产者将等待，然后再生产另一个产品。如果缓冲区为空，消费者将等待。

但是，我的问题是生产者仅在缓冲区为空时才开始生产，直到缓冲区已满。消费者只有在缓冲区满时才开始消费，直到它为空。

示例（缓冲区大小：5）

```
Produced Product 1
Produced Product 2
Produced Product 3
Produced Product 4
Produced Product 5
Consumed Product 1
Consumed Product 2
Consumed Product 3
Consumed Product 4
Consumed Product 5
Produced Product 6
Produced Product 7
Produced Product 8
Produced Product 9
Produced Product 10
Consumed Product 6
Consumed Product 7
Consumed Product 8
Consumed Product 9
Consumed Product 10
Produced Product 11
Produced Product 12
Produced Product 13
Produced Product 14
Produced Product 15
Consumed Product 11
Consumed Product 12
Consumed Product 13
Consumed Product 14
Consumed Product 15
Produced Product 16
Produced Product 17
Produced Product 18
Produced Product 19
Produced Product 20
Consumed Product 16
Consumed Product 17
Consumed Product 18
Consumed Product 19
Consumed Product 20
Produced Product 21
Produced Product 22
Produced Product 23
Produced Product 24
Produced Product 25
Consumed Product 21
Consumed Product 22
Consumed Product 23
Consumed Product 24
Consumed Product 25
Produced Product 26
Produced Product 27
Produced Product 28
Produced Product 29
Produced Product 30
Consumed Product 26
Consumed Product 27
Consumed Product 28
Consumed Product 29
Consumed Product 30 
```

我想要它以便生产者在缓冲区未满时生产，无论缓冲区是否为空。随后，我希望它让消费者消费只要缓冲区不为空，无论缓冲区是否已满。

我的代码有什么问题？

```
import java.util.LinkedList;
import java.util.Queue;
import java.util.Random;
import javax.swing.JOptionPane;

public class ProducerConsumer{

    final static Queue<Product> buffer = new LinkedList<>();
    private static int buffer_size, no_items, itemno = 1;
    private static Random r = new Random();
    public static void main(String[] args) {
        try{
            buffer_size = Integer.parseInt(JOptionPane.showInputDialog("Input Buffer size (default: 5)"));
            if(buffer_size<0){
                buffer_size = 5;
            }
        }catch(NumberFormatException nfe){
            buffer_size = 5;
        }
        try{
            no_items = Integer.parseInt(JOptionPane.showInputDialog("Input No. of Items (default: 10)"));
            if(no_items<0){
                no_items = 10;
            }
        }catch(NumberFormatException nfe){
            no_items = 10;
        }
        Producer producer = new Producer();
        Consumer consumer = new Consumer();
        producer.start();
        consumer.start();
    }

    static class Product {
        private String name = "Product X";
        private int productno;

        public Product(int productno) {
            this.productno = productno;
            this.name = "Product "+productno;
        }
        public int number() {
            return productno;
        }
        @Override
        public String toString() {
            return name;
        }
    }
    static class Producer extends Thread{
        public Producer(){
        }
        public void produce(){
            Product p = new Product(itemno++);
            try {
                this.sleep(r.nextInt(100));
            } catch (InterruptedException ex) {
                Thread.interrupted();
            }
            buffer.add(p);
            System.out.println("Produced "+p);
        }
        @Override
        public void run(){
            synchronized(buffer){
                while(itemno<=no_items){
                    while(buffer.size()==buffer_size){
                        try{
                            buffer.wait(100);
                        }catch(InterruptedException e){
                            Thread.interrupted();
                        }
                    }
                    produce();
                    buffer.notifyAll();
                }
            }
        }
    }
    static class Consumer extends Thread{
        public Consumer(){
        }
        public boolean consume(){
            try {
                this.sleep(r.nextInt(100));
            } catch (InterruptedException ex) {
                Thread.interrupted();
            }
            Product product = buffer.remove();
            System.out.println("Consumed "+product);
            return product.number()==no_items;
        }
        @Override
        public void run(){
            synchronized(buffer){
                boolean end = false;
                while(!end){
                    while(buffer.isEmpty()){
                        try{
                            buffer.wait(100);
                        }catch(InterruptedException e){
                            Thread.interrupted();
                        }
                    }
                    end = consume();
                    buffer.notifyAll();
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T21:52:14.137

这是因为您`buffer`在 notifyAll 之前已经获取了监视器并生成了 N 次，并通过退出`synchronized`块释放了缓冲区监视器，所有这些都在 while 循环内。

尝试把块放在`while`外面`synchronized`，这样你就可以给另一个线程在并发生产/消费期间获取锁的机会。

请注意，在通知线程退出该区域`notifyAll`之前，它实际上不会影响其他线程`synchronized`

编辑：我在进行建议的更改后运行它，得到以下输出

```
Produced Product 1
Produced Product 2
Produced Product 3
Consumed Product 1
Consumed Product 2
Consumed Product 3
Produced Product 4
Produced Product 5
Consumed Product 4
Consumed Product 5
Produced Product 6
Consumed Product 6
Produced Product 7
Produced Product 8
Produced Product 9
Produced Product 10
Consumed Product 7
Consumed Product 8
Consumed Product 9
Consumed Product 10 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:11:03.963

由于两个线程都在缓冲区上同步，因此任何时候只有一个线程会运行。一个线程在调用 buffer.wait() 时向另一个发出信号以恢复运行并暂停自身。包含 buffer.wait() 调用 (buffer.size() == buffer_size) 和 (buffer.isEmpty()) 的 while 循环中的逻辑允许循环仅在其功能正常时运行（生产者或消费者）已完成，无法继续。

程序是这样执行的：生产者将产生 5 个项目，然后 while 循环条件为真，它会调用 buffer.wait() 以允许消费者运行。消费者将开始运行并消费，直到缓冲区为空，在这种情况下，while 条件为真，它将调用 buffer.wait() 并允许生产者再次运行。

要允许两个线程同时运行，这可能是您真正想要的，您应该仅在需要安全访问缓冲区时调用 synchronize(buffer)。一种方法是使用以下代码块：

```
static class Producer extends Thread {
    public Producer() {
    }

    public void produce() {
        Product p = new Product(itemno++);
        try {
            this.sleep(r.nextInt(100));
        } catch (InterruptedException ex) {
            Thread.interrupted();
        }
        synchronized(buffer) {
            buffer.add(p);
        }
        System.out.println("Produced " + p);
    }

    @Override
    public void run() {
        while (itemno <= no_items) {
            while (buffer.size() == buffer_size) {
                try {
                    sleep(100);
                } catch (InterruptedException e) {
                    Thread.interrupted();
                }
            }

            produce();
        }
    }
}

static class Consumer extends Thread {
    public Consumer() {
    }

    public boolean consume() {
        try {
            this.sleep(r.nextInt(100));
        } catch (InterruptedException ex) {
            Thread.interrupted();
        }

        Product product;
        synchronized (buffer) {
            product = buffer.remove();
        }

        System.out.println("Consumed " + product);
        return product.number() == no_items;
    }

    @Override
    public void run() {
        boolean end = false;
        while (!end) {
            while (buffer.isEmpty()) {
                try {
                    sleep(100);
                } catch (InterruptedException ex) {
                    Logger.getLogger(TrashMe.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
            end = consume();
        }
    }
} 
```

# .net - 如何在 C# 代码中获取内核进程的进程句柄和 ID？

> ID：10237314
> 
> 赞同：0
> 
> 时间：2012-04-19T21:47:06.080
> 
> 标签：.net, c#-4.0, memory

如何在 c# 代码中获取内核进程的进程句柄和 id？当我尝试遍历某些进程时，我得到 win32exception “访问被拒绝”，这是否意味着这些是内核进程？

我想做的简单查看内存中的所有内核进程并使用 MiniDumpWriteDump 转储它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:07:08.777

你只需要这样：

```
Process prc = Process.GetProcessesByName("System").FirstOrDefault(); 
```

您将获得 PID，但您将无法获得此进程句柄。

# jquery - 加载 jQuery UI 会删除我的 Google 地图？

> ID：10237317
> 
> 赞同：0
> 
> 时间：2012-04-19T21:47:30.353
> 
> 标签：jquery, wordpress, jquery-ui, google-maps-api-3

我有一个使用谷歌地图的wordpress（buddypress）“博客”。我使用创建地图的初始化函数很好地加载地图，然后在文档就绪函数中使用 jQuery .show 将地图添加到正确的 div。

当我加载 jQuery UI 库时，地图不再显示。我什至不知道从哪里开始解决问题。

相关JS：http: [//jsfiddle.net/cRkxZ/](http://jsfiddle.net/cRkxZ/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:27:44.483

[http://jsfiddle.net/toroncino/cRkxZ/6/](http://jsfiddle.net/toroncino/cRkxZ/6/)

恢复您的选项，它应该可以工作。

# ios - 选择器的问题

> ID：10237318
> 
> 赞同：0
> 
> 时间：2012-04-19T21:47:31.477
> 
> 标签：ios

我遇到了选择器的问题。我正在尝试动态命名一个数组、winnerArray1、winnerArray2、winnerArray3 等。

该变量`someVariable`处于一个增加的循环中，因此它将增加。

我将无法识别的选择器发送到实例

```
int someVariable = 1;
NSArray  *winnerArray;
NSString *tempLoopString;

while(someVariable < 4){
        tempLoopString = [NSString stringWithFormat:@"winnerArray%d", someVariable];
        SEL selector = NSSelectorFromString(tempLoopString);
        winnerArray = [self performSelector:selector];  

        if ([winnerArray do_stuff]) {

            do stuff here
        }
  someVariable++ 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:25:59.333

您不能像那样按名称引用变量。

您应该考虑使用键值编码。这样，您可以使用 valueForKey 方法查询某个对象的属性：

# c++ - 内核执行期间的 CUDA 传输内存

> ID：10237320
> 
> 赞同：3
> 
> 时间：2012-04-19T21:47:42.537
> 
> 标签：c++, cuda, nvidia, pci

我知道 CUDA 内核可以通过将它们放入单独的流中来“重叠”，但我想知道是否可以在内核执行期间传输内存。CUDA 内核毕竟是异步的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:23:41.127

您可以同时运行内核、从主机到设备的传输以及从设备到主机的传输。

[http://developer.download.nvidia.com/CUDA/training/StreamsAndConcurrencyWebinar.pdf](http://developer.download.nvidia.com/CUDA/training/StreamsAndConcurrencyWebinar.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T16:07:51.113

为澄清起见，上述内容仅在您的设备支持时才有效。您可以检查它运行设备查询并检查属性并发复制和执行

# android - 资源分组方式

> ID：10237323
> 
> 赞同：1
> 
> 时间：2012-04-19T21:48:10.340
> 
> 标签：android, android-resources

我想以某种不涉及某些疯狂方法的方式对我的可绘制对象进行分组（例如对生成的`R`类的反射）。

例如，我在游戏中有 10 种类型的某些对象。我想将它们全部加载到一个数组中而不实际复制：

```
enemy[0] = resources.getDrawable(R.drawable.enemy_image_0)
enemy[0].set....
enemy[1] = resources.getDrawable..... 
```

有没有办法将它们分组并循环加载？有什么方法可以在不了解如何`R`生成和更改其结构的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:50:17.983

> 有没有办法将它们分组并循环加载？

`getIdentifier()`在对象上使用`Resources`（您通常通过`getResources()`您的活动或其他方式获得`Context`）。

由于这在幕后使用了“疯狂的方法”（特别是“对生成的`R`类进行反射”），​​并且由于反射不是特别快，因此请尽可能缓存这些值。

# c# - 更改发生在单击 2 次鼠标后，而应该发生在单击一次后

> ID：10237328
> 
> 赞同：0
> 
> 时间：2012-04-19T21:48:32.210
> 
> 标签：c#, winforms, treeview, mouseevent, selection

我有 ac# windows 窗体应用程序，其中我在 tabControl 的 tabPage 中有一个 treeView，它是主窗体的一部分。

对于树视图，我单击要选择的树视图的项目，然后根据我选择的项目进行一些更改。

我使用 AfterSelect 事件进行项目选择，并使用 mouseUp 事件撤消选择。

只需单击一下即可立即选择和取消选择项目（没问题）。两次单击后，应根据所选项目发生的其他更改发生！单击项目节点或节点区域外的单击不会触发此更改。我必须再次单击才能看到更改。那是有线的。我没有为此或类似的事情使用鼠标双击事件，我只使用我上面描述的事件。

这怎么可能发生？以及如何解决？谢谢。

**编辑：**我正在使用我自己的多选版本的 treeView 并且我发现（使用调试）当我在第一次单击后在 AfterSelect 事件中获取树的选定节点时为零，那么它就是选定节点的数量第二次点击。每次单击 treeView 的覆盖 OnAfterSelect 事件时，将选定节点添加到当前 selectedNodes 列表时，为什么会发生这种情况？

这是树视图代码的一部分：

```
public List<TreeNode> SelectedNodes
        {
            get
            {
                return selectedNodes; 
            }

            set
            {
                removeSelectionFromNodes();
                selectedNodes = value;
                selectNodes();
            }
        }

   protected override void OnAfterSelect(TreeViewEventArgs e)
        {
            base.OnAfterSelect(e); 
            base.SelectedNode = null;
           List<MSTreeNode> nodes = new List<MSTreeNode>();
                   .
                   .
                   .
               removeSelectionFromNodes();
                selectedNodes.Clear();
                selectedNodes.AddRange(nodes);
                selectNodes();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T21:59:04.310

也许 Treeview 在两次点击之间失去了焦点（？）。您可以尝试将 Treeview HideSelection 属性设置为 False 以在控件失去焦点时保持当前选定的项目突出显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-21T06:21:51.187

我尝试使用 MouseDown 事件而不是 AfterSelect 事件。我在我自己的多选版本的 treeView 中覆盖它，并在我正在开发的 c# 应用程序中使用它，但它仍然不起作用。我不确定鼠标事件是如何工作的。如果不小心使用，您可能会看到有线行为。

好吧，我最终在我的 treeView 子类中覆盖了 MouseUp 和 MouseUp 事件，然后我创建了一个事件来监听 selectedNodes 列表中的变化。如果在任何鼠标事件中发生对 selectedNodes 的更改，则会触发此事件。然后，当节点选择发生变化时，我使用应用程序中树视图实例的 ChangedSelectedNodes 事件处理程序来执行其他更改。这次它按预期工作。

我发布了这篇文章，希望它对像我一样遇到同样问题的其他人有所帮助。

PS 有时事情并没有像你期望的那样工作，你只是努力奋斗并经历所有其他可能性，直到找到解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-25T20:38:54.043

禁用隐藏选择选项并在我的项目中使用 afterSelect 选项效果很好

# objective-c - 在 Windows 上开发 iOS 应用程序有哪些选择？

> ID：10237337
> 
> 赞同：1
> 
> 时间：2012-04-19T21:49:06.527
> 
> 标签：objective-c, ios, windows

我可以用 HTML/CSS/JavaScript 编写应用程序并使用 phoneGap 之类的东西，但是否推荐使用这种技术？用 Objective-C 编写应用程序不是更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:02:08.547

对于本机应用程序 [目标 C]，我尝试在真机和虚拟机上使用[Hackintosh](http://www.hackintosh.com/)

对苹果来说是可能的但非法的，而且有时你会碰到一些墙。这需要一些时间来解决。

最简单的选择是购买一台二手 Mac [从 400 美元起？对于台式机或更旧的笔记本电脑]，然后从那里开始，

因为您的应用程序开发涉及大量签名。根据您的经验，最好让它们为您“自动化”。

因此，即使要在 HTML+JS [phone gap 等] 上开发您的应用程序，作为包装器，您也需要处理 xcode 和 objC

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:59:11.527

如果你想做一个应用程序，而不仅仅是构建一个可以通过浏览器访问的网站，你最好的选择是使用像 Adob​​e Flash Builder 或 Delphi Prism 这样的产品，它可以让你以跨平台的方式编码，但编译成原生 ios 字节码。我认为这种方法的最大问题是对手机硬件（如 GPS 等）的本地访问和调试。因为没有一个好的模拟器可以用来测试。

[http://tv.adobe.com/watch/adc-presents/build-ios-applications-using-flex-and-flash-builder-45/](http://tv.adobe.com/watch/adc-presents/build-ios-applications-using-flex-and-flash-builder-45/)

[http://www.embarcadero.com/rad-in-action/iphone](http://www.embarcadero.com/rad-in-action/iphone)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:10:20.593

phone gap 不如 Objective-C 的原因是它没有原生的外观/感觉。如果这对您无关紧要，那么phonegap应该没问题。

如果您决定不关心本机外观/感觉，那么您可以在 Windows 机器上构建您的手机间隙应用程序，然后通过这样的网站编译[它](https://build.phonegap.com/docs/ios-builds)。当我使用 phonegap 进行 iOS 开发时，使用 Xcode 编译时会出现一些错误，而在其他情况下编译时不会出现，所以无论如何你可能必须在 Mac 上进行一些调试。

# html - 是否可以在不链接另一个页面的情况下使用 iframe

> ID：10237339
> 
> 赞同：0
> 
> 时间：2012-04-19T21:49:09.077
> 
> 标签：html, iframe

这是经典的 iframe 代码。我想要的只是当你点击不同的链接时显示不同的东西。

我想在具有不同链接的页面上的 wordpress 中显示不同的画廊。我不想为每个人编写不同的 html

```
<iframe id="myIframe" src="about:blank" height="200" width="500"></iframe>
<br />
<a href="http://www.blogger.com" target="myIframe">Blogger</a><br />
<a href="http://www.cnn.com" target="myIframe">CNN</a><br />
<a href="http://www.google.com" target="myIframe">Google</a><br /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:53:38.790

您要做的是在单击链接时显示和隐藏页面的特定部分。您不需要为此使用 iframe。我认为您最好为此使用隐藏的 div，或者甚至使用 ajax 调用来加载不同的画廊。我将向您展示隐藏的 div 方法：

```
<div id="gallery1" class="gallery">
  A whole lot of html that makes up the 1st gallery
</div>
<div id="gallery2" class="gallery" style="display:none">
  A whole lot of html that makes up the 2nd gallery
</div>
<div id="gallery3" class="gallery" style="display:none">
  A whole lot of html that makes up the 3nd gallery
</div>

<a href="JavaScript:void(0)" data-gallery="gallery1">Show gallery 1</a>
<a href="JavaScript:void(0)" data-gallery="gallery2">Show gallery 2</a>
<a href="JavaScript:void(0)" data-gallery="gallery3">Show gallery 3</a>

​
$('a').click(function() {
  $('.gallery').hide();
  $('#' + $(this).data('gallery')).show();
}); 
```

这是一个 js 小提琴：http: [//jsfiddle.net/nV5vy/](http://jsfiddle.net/nV5vy/)

# php - CakePHP：保存数据时出错

> ID：10237340
> 
> 赞同：0
> 
> 时间：2012-04-19T21:49:15.263
> 
> 标签：php, cakephp

所以我在 CakePHP 中保存数据时遇到了麻烦。

如果我上传一张图片（意思是 ['PictureForm']['file']['name'] 存在），一切正常并且数据被保存。但是，如果 ['PictureForm']['file']['name'] 为空，并且 ['PictureForm']['url'] 存在，则图像正确保存在磁盘上，但是 $this->PictureForm ->save($this->data) 失败。

有人看到我的代码有什么明显的错误吗？

```
if (isset($this->data['PictureForm'])) {
                            ///////////////////////////////////////////////////////DEV
                            if(!$this->data['PictureForm']['file']['name']) {
                                    if (!$this->data['PictureForm']['url']) {
                                            $this->Session->setFlash('Error: no image URL or file given!');
                                            $this->redirect(array('action' => '/'));
                                    } else {
                                            $fileExtension = getExtension($this->data['PictureForm']['url']);
                                            $this->request->data['PictureForm']['filename'] = randFilename() . "." . $fileExtension;
                                            file_put_contents('files/picture/' . $this->data['PictureForm']['filename'], file_get_contents($this->data['PictureForm']['url']));
                                    }
                            } else { //file was uploaded
                                    $fileExtension = getExtension($this->data['PictureForm']['file']['name']);
                                    if (!$fileExtension) {
                                            $this->Session->setFlash('Error: no file extension!');
                                            $this->redirect(array('action' => '/'));
                                    }
                                    $this->request->data['PictureForm']['filename'] = randFilename() . "." . $fileExtension;
                                    move_uploaded_file($this->data['PictureForm']['file']['tmp_name'], "files/picture/" . $this->data['PictureForm']['filename']);
                            }
                            $this->request->data = Sanitize::clean($this->request->data, array('encode' => false));
                            if ($this->PictureForm->save($this->data)) {
                                    resizeUpload($this->data['PictureForm']['filename']);
                                    $this->Session->setFlash('Picture <a href="/spootur/media/p/' . $this->data['PictureForm']['filename'] . '">saved</a>');
                                    $this->redirect(array('action' => 'p/' . $this->data['PictureForm']['filename']));
                            } else {
                                    $this->Session->setFlash('Error: could not save to db' . $this->data['PictureForm']['filename']);
                                    $this->redirect(array('action' => '/'));
                            }
                    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T02:18:23.890

如果保存失败，在 else 块中，而不是重定向尝试查看验证错误：

```
if ($this->PictureForm->save($this->data)) {
    // code
} else{
    debug($this->PictureForm->validationErrors);
} 
```

# c# - 调试和跟踪写入/WriteLine 未输出到 Visual Studio 2010 C# Express 中的输出

> ID：10237342
> 
> 赞同：6
> 
> 时间：2012-04-19T21:49:25.847
> 
> 标签：c#, visual-studio-2010

我无法让调试或跟踪在 Visual Studio 2010 C# Express 中工作。我有“将所有输出重定向到即时窗口” - 未选中。什么都不会输出窗口。

```
using System.Diagnostics;

Trace.Write("Hello World");
Trace.WriteLine("Hello World");
Debug.Write("Hello World2");
Debug.WriteLine("Hello World2"); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-19T22:04:53.147

确保选中 Build 页面上项目属性中的“Define DEBUG constant”和“Define TRACE constant”两个复选框。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-19T21:57:54.047

右键单击输出窗口并确保选中“程序输出”。

# linq - Linq 查询左连接条件

> ID：10237347
> 
> 赞同：1
> 
> 时间：2012-04-19T21:49:55.080
> 
> 标签：linq, join, conditional-statements

我正在尝试使用 Linq 语法重新创建以下 sql 查询，由于某种原因它不起作用，请让我知道我在这里做错了什么

## 我的sql查询：

```
select 
cf.VisitConfigId,
cf.VisitName,
sv.VisitDate 
from SubjectVisitConfig cf 
left join SubjectVisit sv on cf.VisitConfigId = sv.VisitConfigId 
```

## 我的 Linq 查询：

```
var q = from cf in ctms.SubjectVisitConfigs
        join sv in ctms.SubjectVisits on cf.VisitConfigId equals  
        sv.VisitConfigId into JoinedVisits
        from sv in JoinedVisits.DefaultIfEmpty()
        where sv.SubjectId == subjectId.Value && sv.SiteId == siteId.Value
        select new
        {
            sv.VisitId,
            VisitDate = sv.VisitDate != null ? sv.VisitDate : null,
            cf.VisitName
        }; 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:53:49.840

您`sv`在 select 子句中无条件地取消引用 - 但`sv`对于没有匹配的项目，逻辑上将为 null `SubjectVisit`。您希望您的`where`子句如何匹配任何`sv`为空的结果？

这是*一种*可能的重写：

```
var q = from cf in ctms.SubjectVisitConfigs
        join sv in ctms.SubjectVisits
                       .Where(x => x.SubjectId == subjectId.Value && 
                              x.SiteId == siteId.Value)
             on cf.VisitConfigId equals sv.VisitConfigId into JoinedVisits
        from sv in JoinedVisits.DefaultIfEmpty()
        select new
        {
            VisitId = sv == null ? null : sv.VisitId,
            VisitDate = sv == null ? null : sv.VisitDate,
            cf.VisitName
        }; 
```

# c# - 如何从 Page.Request.Url 获取最后一个值？

> ID：10237348
> 
> 赞同：0
> 
> 时间：2012-04-19T21:50:12.353
> 
> 标签：c#, asp.net-mvc, url, request

Request.Url 完整网址：`http://localhost:2000/virtual_dir/myrep/page.aspx?q=qvalue`

我知道如何`?q=qvalue`使用`Request.Url.Query`

但我只需要一个`qvalue`. 怎么做？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T21:54:33.607

我看到你正在使用 MVC。在这种情况下，您可以通过在操作上使用参数来接受查询字符串。像这样的东西：

```
public ActionResult MyAction(string q) {...} 
```

然后你只需像往常一样使用变量 q 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:52:38.383

只需分别使用`Request`or`Request.QueryString`

```
var q = Request["q"];
var q = Request.QueryString["q"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T21:51:53.877

```
 var foo = Request.QueryString["q"]; 
```

# postgresql - 自动完成字段的类似 UTF-8 字符串

> ID：10237366
> 
> 赞同：2
> 
> 时间：2012-04-19T21:52:34.520
> 
> 标签：postgresql, utf-8, plpgsql, string-comparison, similarity

## 背景

用户可以输入名称并且系统应该匹配文本，即使用户输入或数据库字段包含重音 (UTF-8) 字符。这是使用`pg_trgm`模块。

## 问题

代码类似于以下内容：

```
 SELECT
    t.label
  FROM
    the_table t
  WHERE
    label % 'fil'
  ORDER BY
    similarity( t.label, 'fil' ) DESC 
```

当用户键入`fil`时，查询匹配`filbert`但不匹配`filé powder`。（因为重音字符？）

### 失败的解决方案#1

我尝试实现一个[unaccent](https://stackoverflow.com/a/3051845/59087)函数并将查询重写为：

```
 SELECT
    t.label
  FROM
    the_table t
  WHERE
    unaccent( label ) % unaccent( 'fil' )
  ORDER BY
    similarity( unaccent( t.label ), unaccent( 'fil' ) ) DESC 
```

这仅返回`filbert`.

### 失败的解决方案#2

如建议：

```
CREATE EXTENSION pg_trgm;
CREATE EXTENSION unaccent;

CREATE OR REPLACE FUNCTION unaccent_text(text)
  RETURNS text AS
$BODY$
  SELECT unaccent($1); 
$BODY$
  LANGUAGE sql IMMUTABLE
  COST 1; 
```

表上的所有其他索引都已删除。然后：

```
CREATE INDEX label_unaccent_idx 
ON the_table( lower( unaccent_text( label ) ) ); 
```

这仅返回一个结果：

```
 SELECT
    t.label
  FROM
    the_table t
  WHERE
    label % 'fil'
  ORDER BY
    similarity( t.label, 'fil' ) DESC 
```

## 问题

重写查询以确保返回两个结果的最佳方法是什么？

谢谢！

## 有关的

[http://wiki.postgresql.org/wiki/What%27s_new_in_PostgreSQL_9.0#Unaccent_filtering_dictionary](http://wiki.postgresql.org/wiki/What%27s_new_in_PostgreSQL_9.0#Unaccent_filtering_dictionary)

[http://postgresql.1045698.n5.nabble.com/index-refuses-to-build-td5108810.html](http://postgresql.1045698.n5.nabble.com/index-refuses-to-build-td5108810.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T23:07:35.560

您没有使用`pg_trgm`模块提供的操作符类。我会创建一个这样的索引：

```
创建索引 label_Lower_unaccent_trgm_idx
ON test_trgm 使用 gist (lower(unaccent_text(label)) gist_trgm_ops );

```

最初，我在这里有一个 GIN 索引，但后来我了解到 GiST 可能更适合这种查询，因为它可以返回按相似度排序的值。更多细节：

*   [Postgresql：两列之间的匹配模式](https://stackoverflow.com/questions/11281103/postgresql-matching-patterns-between-two-columns/11282358#11282358)
*   [使用 PostgreSQL 快速查找相似字符串](https://stackoverflow.com/questions/11249635/finding-similar-strings-with-postgresql-quickly/11250001#11250001)

您的查询必须与索引表达式匹配才能使用它。

```
SELECT label
FROM   the_table
WHERE  lower(unaccent_text(label)) % 'fil'
ORDER  BY similarity(label, 'fil') DESC -- it's ok to use original string here 
```

但是，根据 % 运算符，“filbert”和“filé powder”实际上与“fil”不太相似。我怀疑你真正想要的是：

```
选择标签
FROM the_table
WHERE   lower(unaccent_text(label)) ~~ '%fil%'
ORDER BY Similarity(label, 'fil') DESC -- 这里可以使用原始字符串

```

这将找到包含搜索字符串的所有字符串，并首先根据`%`运算符对最佳匹配进行排序。

**有趣的是：表达式可以使用自 PostgreSQL 9.1**以来的 GIN 或 GiST 索引！我引用了[pg_trgm moule 上的手册](http://www.postgresql.org/docs/current/interactive/pgtrgm.html#PGTRGM-FUNC-TABLE)：

> 从 PostgreSQL 9.1 开始，这些索引类型还支持 LIKE 和 ILIKE 的索引搜索，例如

* * *

如果您实际上打算使用`%`运算符：

您是否尝试过**降低**相似性运算符`%`的阈值[`set_limit()`](http://www.postgresql.org/docs/current/interactive/pgtrgm.html#PGTRGM-FUNC-TABLE)：

```
SELECT set_limit(0.1); 
```

甚至更低？默认值为 0.3。只是为了看看它是否是过滤额外匹配的阈值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T23:16:34.110

PostgreSQL 9.1 的解决方案：

```
-- Install the requisite extensions.
CREATE EXTENSION pg_trgm;
CREATE EXTENSION unaccent;

-- Function fixes STABLE vs. IMMUTABLE problem of the unaccent function.
CREATE OR REPLACE FUNCTION unaccent_text(text)
  RETURNS text AS
$BODY$
  -- unaccent is STABLE, but indexes must use IMMUTABLE functions.
  SELECT unaccent($1); 
$BODY$
  LANGUAGE sql IMMUTABLE
  COST 1;

-- Create an unaccented index.
CREATE INDEX the_table_label_unaccent_idx
ON the_table USING gin (lower(unaccent_text(label)) gin_trgm_ops);

-- Define the matching threshold.
SELECT set_limit(0.175);

-- Test the query (matching against the index expression).
SELECT
  label
FROM
  the_table
WHERE
  lower(unaccent_text(label)) % 'fil'
ORDER BY
  similarity(label, 'fil') DESC 
```

返回“filbert”、“fish fillet”和“filé powder”。

如果不调用`SELECT set_limit(0.175);`，您可以使用双波浪号 ( `~~`) 运算符：

```
-- Test the query (matching against the index expression).
SELECT
  label
FROM
  the_table
WHERE
  lower(unaccent_text(label)) ~~ 'fil'
ORDER BY
  similarity(label, 'fil') DESC 
```

还返回“filbert”、“fish Fillet”和“filé powder”。

# jquery - 具有所有嵌套元素的 Jquery 克隆对象

> ID：10237378
> 
> 赞同：1
> 
> 时间：2012-04-19T21:53:20.880
> 
> 标签：jquery, jquery-mobile, clone

我想克隆一个 JQM 单选选项并将其插入到最后。问题是`clone()`没有复制所有嵌套元素（动态生成）。它只是复制第一个孩子而不是所有的后代。单选选项的生成内容包含标签元素，该元素也具有后代元素，但由于某种原因它们不会克隆。

这是小提琴[http://jsfiddle.net/aSKBW/7/](http://jsfiddle.net/aSKBW/7/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:14:56.740

`.clone()`没有截断您的选择，您是:)。当你这样做时：

```
new_option.find('label').text('Red'); 
```

您正在覆盖`label`元素的 HTML 结构，如下所示：

```
<label for="sky-color-2" data-theme="c" class="ui-btn ui-btn-icon-left ui-radio-off ui-corner-bottom ui-controlgroup-last ui-btn-up-c">
    <span class="ui-btn-inner ui-corner-bottom ui-controlgroup-last">
        <span class="ui-btn-text">Green</span>
        <span class="ui-icon ui-icon-radio-off ui-icon-shadow"></span>
    </span>
</label> 
```

在你弄乱`.text()`函数后，它看起来像这样：

```
<label for="sky-color-2" data-theme="c" class="ui-btn ui-btn-icon-left ui-radio-off ui-corner-bottom ui-controlgroup-last ui-btn-up-c">Red</label> 
```

解决方法是定位`.ui-btn-text`元素并更改其文本：

```
new_option.find('.ui-btn-text').text('Red'); 
```

这是您的 JSFiddle 的更新版本：http: [//jsfiddle.net/aSKBW/13/](http://jsfiddle.net/aSKBW/13/)

不要觉得太糟糕，在习惯 jQuery Mobile 以及它如何为 DOM 添加如此多的结构时，这是一个非常常见的错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T22:56:31.917

您可以像以前一样插入普通输入和标签：

```
$('<input type="radio" name="sky-color" value="red" id="sky-color-' + index + '" class="custom" />    <label for="sky-color-' + index + '">Red</label>'); 
```

然后你触发`create`顶部 div 上的事件

```
$('#slide21').trigger('create'); 
```

而且因为你最后追加了你必须从以前的标签中删除一些类：

```
last.find('label').removeClass('ui-corner-bottom ui-controlgroup-last'); 
```

可以在此处找到您的 Fiddle 的更新：http: [//jsfiddle.net/aSKBW/16/](http://jsfiddle.net/aSKBW/16/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T22:06:14.167

难道您不需要将“true”传递给深拷贝吗？：

```
.clone(true) 
```

> 创建匹配元素集的深层副本。
> 
> **.clone (withDataAndEvents)**版本已添加：1.0 withDataAndEvents：一个布尔值，指示是否应将事件处理程序与元素一起复制。从 jQuery 1.4 开始，元素数据也将被复制。
> 
> **.clone (withDataAndEvents deepWithDataAndEvents)**版本添加：1.5 withDataAndEvents：一个布尔值，指示是否应将事件处理程序和数据与元素一起复制。默认值为假。*对于 1.5.0，默认值不正确。这将在 1.5.1 及更高版本中更改回 false。
> 
> **deepWithDataAndEvents**：一个布尔值，指示是否应复制克隆元素的所有子元素的事件处理程序和数据。默认情况下，它的值与第一个参数的值匹配（默认为 false）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T22:07:02.717

我可以在这里克隆它，看看。您最终会得到完全相同的值和 ID，这可能是个问题，但它确实有效。 [http://jsfiddle.net/aSKBW/9/](http://jsfiddle.net/aSKBW/9/)

克隆有 2 个选项 .clone( [withDataAndEvents] [, deepWithDataAndEvents] )

```
$(document).ready(function(){
    $('.add-option').click(function(e){
        $('.ui-radio:eq(0)').clone(true, true).appendTo('.ui-controlgroup-controls');
        $('.ui-radio:eq(1)').clone(true, true).appendTo('.ui-controlgroup-controls');
    });
});​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T22:09:46.360

这种事情的一个常见解决方案是序列化您的对象，然后将其反序列化为一个新对象。

根据您使用的库或框架，您可能有内置的功能允许您执行此操作。

我使用了 knockoutjs，它允许您通过 ko.toJSON 实用函数来执行此操作，该实用函数将对象转换为 JSON 字符串。

我还没有看到任何通用解决方案可以正确处理任何对象的序列化和反序列化，无论多么复杂，如果有人有其中之一，请在此处发布它对很多人都有用。

# actionscript-3 - 有没有人有适用于移动应用程序的 stageVideo 工作班？

> ID：10237383
> 
> 赞同：0
> 
> 时间：2012-04-19T21:53:48.267
> 
> 标签：actionscript-3, apache-flex, mobile, flash-builder

有谁知道在平板电脑或教程上运行良好的带有 as3 的 stageVideo 的好助手类？我正在努力寻找一些东西来帮助我开始，这样我就不必从头开始了。比你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:59:40.527

在移动设备上使用 StageVideo 并不需要类或 SDK。这与使用普通视频 API 几乎相同

看看这个链接：

[http://www.adobe.com/devnet/flashplayer/articles/stage_video.html](http://www.adobe.com/devnet/flashplayer/articles/stage_video.html)

并确保您使用 AIR 3.2 发布

# jquery-ui - 如何使用 RequireJS 在我的模块化骨干网应用程序中包含 jQueryUI？

> ID：10237384
> 
> 赞同：13
> 
> 时间：2012-04-19T21:53:49.140
> 
> 标签：jquery-ui, backbone.js, requirejs

我想使用 RequireJS 在我的主干.js 应用程序中包含 jQueryUI。我的 index.html 中包含的 main.js 文件如下：

```
require.config({
    paths: {
            jquery: 'libs/jquery/jquery-1.7.2.min',
            jqueryui: 'libs/jquery/jquery-ui-1.8.18.custom.min',
            underscore: 'libs/underscore/underscore-min',
            backbone: 'libs/backbone/backbone-optamd3-min',
            text: 'libs/require/text',
            templates: 'templates'
       }

});

require(['app'], function(App){
    App.start();
}); 
```

对于每个模型/视图/路由器文件，我只在“定义”块的开头包含“jquery”命名空间，如下所示：

```
define([
    'jquery',
    'underscore',
    'backbone',
    'views/categoryview',
    'text!templates/category.html'
    ], function($, _, Backbone, CategoryView, categoryTemplate){
        // Here comes my code
}); 
```

但是 jQueryUI 不能在这些文件中使用。我的代码有问题吗？或者我还应该在每个“定义”块中包含“jqueryui”吗？但是如果我在“define”块中包含“jqueryui”，我应该如何在函数中命名它以避免与jquery发生名称冲突？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-24T12:33:27.903

虽然 kujakettu 的回答至少部分正确，但我还必须在我的 shim 中将 jQuery 指定为依赖项，以确保在 jQuery-UI 之前加载 jQuery。

例如

```
require.config({
    baseUrl: 'scripts/modules',
    paths:{
        jquery:'../libs/jquery',
        jqueryUI:"../libs/jquery-ui",
        underscore:'../libs/underscore',
        backbone:'../libs/backbone'
    },
    shim: {
        jqueryUI: {
            deps: ['jquery']
        },
        underscore: {
            exports: '_'
        },
        backbone: {
            deps: ["underscore", "jquery"],
            exports: "Backbone"
        },
        waitSeconds: 15
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-09T09:48:50.343

很老的帖子了。有一个[工具](https://github.com/jrburke/jqueryui-amd)可用于将 jquery ui 文件转换为 AMD 版本，由 jrburke 创建。希望它会有用！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T12:55:56.543

您可以在主文件中包含仅修补某些其他对象（如 jQuery UI）的所有文件，如下所示（您需要确保在 jQuery UI 之前加载 jQuery）：

```
require(['jquery', 'app', 'jqueryui'], function ($, App) { App.start(); }); 
```

另一种方法是在您已经提到的每个模块中包含 jQuery UI。

我个人更喜欢第一种方法，即使它隐藏了依赖项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-17T18:41:41.933

其他答案现在有点过时了。JQuery UI 带有 AMD 支持。如果您想要整个项目只需使用`bower install jquery-ui`然后将其添加到路径中。不需要垫片。

如果你想在你的应用程序中加载你需要的 jQuery UI 的子集（而不是加载额外的膨胀），那么只需使用`bower install jquery-ui`来获取整个内容，然后使用名为 r.js 的 RequireJS 构建工具来创建一个包含你所需要的文件的 AMD 包需要。

# ruby-on-rails - 如何使用 Ruby on Rails 将数据从控制器传递到模型？

> ID：10237388
> 
> 赞同：9
> 
> 时间：2012-04-19T21:54:08.337
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, model-view-controller, model

如何将数据从控制器传递到模型？

在我的`application_controller`我获取用户的位置（州和城市）并包含一个`before_filter`以使其在我的所有控制器中都可以通过

```
before_filter :community

def community
    @city = request.location.city
    @state = request.location.state
    @community = @city+@state
  end 
```

然后我尝试通过以下方式将在控制器中检索到的数据添加到模型中：

```
before_save :add_community

def add_community
      self.community = @community
    end 
```

然而，数据永远不会从控制器进入模型。如果我使用：

```
def add_community
    @city = request.location.city
    @state = request.location.state
    @community = @city+@state
    self.community = @community
  end 
```

这些方法`request.location.city`并不`request.location.state`能从模型中运行。我知道其他一切都在工作，因为如果我将`@city`and定义`@state`为字符串，在 下`def_community`，那么一切正常，除了我没有动态变量，只是放置在模型中的字符串。另外，我知道请求在控制器/视图中工作，因为我可以让它们显示正确的动态信息。问题只是将数据从控制器获取到模型。非常感谢您的时间。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-19T22:08:01.560

您正在努力解决的概念是[MVC 架构](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)，它是关于分离职责的。模型应该处理与数据库（或其他后端）的交互，而不需要了解它们正在使用的上下文（无论是 HTTP 请求还是其他），视图不需要了解后端和控制器处理两者之间的交互。

因此，对于 Rails 应用程序，视图和控制器可以访问`request`对象，而模型则不能。如果你想将当前请求中的信息传递给你的模型，这取决于你的控制器。我将您的定义`add_community`如下：

```
class User < ActiveRecord::Base

  def add_community(city, state)
    self.community = city.to_s + state.to_s  # to_s just in case you got nils
  end

end 
```

然后在你的控制器中：

```
class UsersController < ApplicationController

  def create  # I'm assuming it's create you're dealing with
    ...
    @user.add_community(request.location.city, request.location.state)
    ...
  end
end 
```

我不喜欢`request`直接传递对象，因为这确实保持了模型与当前请求的分离。该`User`模型不需要了解`request`对象或它们如何工作。它所知道的是它得到了 a`city`和 a `state`。

希望有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-20T01:06:23.970

控制器中的类实例变量（以 @ 开头的变量）与模型中的实例变量是分开的。这是 MVC 架构中的模型与控制器。模型和控制器（和视图）是分开的。

您将信息从控制器显式移动到模型。在 Rails 和其他面向对象的系统中，您有多种选择：

**使用函数参数**

```
# In the controller
user = User.new(:community => @community)

# In this example, :community is a database field/column of the 
# User model 
```

[文档](http://ar.rubyonrails.org/classes/ActiveRecord/Base.html)

**使用实例变量属性设置器**

```
# In the controller
user = User.new
user.community = @community
# same as above, :community is a database field 
```

**当数据不是数据库字段时将数据传递给模型**

```
# In the model
class User < ActiveRecord::Base
  attr_accessor :community
  # In this example, :community is NOT a database attribute of the 
  # User model. It is an instance variable that can be used
  # by the model's calculations. It is not automatically stored in the db

# In the controller -- Note, same as above -- the controller 
# doesn't know if the field is a database attribute or not. 
# (This is a good thing)
user = User.new
user.community = @community 
```

[文档](http://www.rubyist.net/~slagell/ruby/accessors.html)

# mysql - SUM(a*b) 有什么作用？

> ID：10237390
> 
> 赞同：1
> 
> 时间：2012-04-19T21:54:15.680
> 
> 标签：mysql, sql, group-by

我以前从未见过 SUM(a*b)。我希望有人能告诉我它的预期行为，以及它是 SQL 标准的一部分，还是 MySQL 恰好实现的东西。一个例子：

```
localhost test> CREATE TABLE numbers (id int not null primary key auto_increment, a int, b int);
Query OK, 0 rows affected (0.03 sec)

localhost test> INSERT INTO numbers (a,b) VALUES (1, 2), (3,4),(1,1),(5,6);
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

localhost test> select * FROM numbers GROUP BY id;
+----+------+------+
| id | a    | b    |
+----+------+------+
|  1 |    1 |    2 |
|  2 |    3 |    4 |
|  3 |    1 |    1 |
|  4 |    5 |    6 |
+----+------+------+
4 rows in set (0.00 sec)

localhost test> select SUM(a), SUM(b) FROM numbers GROUP BY id;
+--------+--------+
| SUM(a) | SUM(b) |
+--------+--------+
|      1 |      2 |
|      3 |      4 |
|      1 |      1 |
|      5 |      6 |
+--------+--------+
4 rows in set (0.00 sec)

localhost test> select SUM(a*b), SUM(a), SUM(b) FROM numbers GROUP BY id;
+----------+--------+--------+
| SUM(a*b) | SUM(a) | SUM(b) |
+----------+--------+--------+
|        2 |      1 |      2 |
|       12 |      3 |      4 |
|        1 |      1 |      1 |
|       30 |      5 |      6 |
+----------+--------+--------+
4 rows in set (0.00 sec)

localhost test> alter table numbers add col2 int not null;
Query OK, 4 rows affected (0.03 sec)
Records: 4  Duplicates: 0  Warnings: 0

localhost test> update numbers set col2 = id %2;
Query OK, 2 rows affected (0.00 sec)
Rows matched: 4  Changed: 2  Warnings: 0

localhost test> select col2, SUM(a*b), SUM(a), SUM(b) FROM numbers GROUP BY col2;
+------+----------+--------+--------+
| col2 | SUM(a*b) | SUM(a) | SUM(b) |
+------+----------+--------+--------+
|    0 |       42 |      8 |     10 |
|    1 |        3 |      2 |      3 |
+------+----------+--------+--------+
2 rows in set (0.01 sec) 
```

我预计最后一行有 80 和 30，或者如果它使用 MySQL 选择一行的非标准行为（我启用了 SQL_MODE=ONLY_FULL_GROUP_BY）会产生错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T21:56:04.460

该表达式`SUM(a*b)`是完全有效的标准 SQL。它计算`a * b`每一行，并对每个组内的结果求和（如果未指定 GROUP BY，则为整个表）。

```
+----+------+------+------+------+
| 编号 | col2 | 一个 | 乙 | a*b |
+----+------+------+------+------+
| 1 | 1 | 1 | 2 | 2 |                  
| 2 | 0 | 3 | 4 | 12 | --+
| 3 | 1 | 1 | 1 | 1 | |---> 12 + 30 = 42
| 4 | 0 | 5 | 6 | 30 | --+
+----+------+------+------+-----|

```

它*不*一样`SUM(a) * SUM(b)`。

# html - html 水平二元素列表

> ID：10237392
> 
> 赞同：1
> 
> 时间：2012-04-19T21:54:20.447
> 
> 标签：html, css, html-lists

我有一个名称列表，显示在表格的一个单元格中，每个单元格之间有一个空格。出于格式化原因，我想避免将每个都放在自己的表格单元格中。我现在想在每个名字上方放一个小头像或照片。我显然可以做一个人，`<img src="photo.gif"><br>name...` 但使用
或

显然会创建一个垂直而不是水平的列表。我显然不能再使用空格了。

是否有任何水平版本的`<br>`标签可以用来分隔人员？

或者，有没有办法用css做到这一点？我发现了一些关于使用左浮动并排放置图像的参考，但是，文本不在标签中。使用多个跨度标签似乎并不那么吸引人。这是我找到的img代码。

```
.left{
    float:left;
    margin:0;
    padding:0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:32:37.070

使用以下 CSS：

```
.horizontalList li {
    display: inline;
    margin-left: 10px;
    margin-right: 10px;
} 
```

您可以使通常显示为块的元素（即`<LI>`,`<DIV>`等）内联显示。只是添加边距以在每个元素之间留出一点空间。

例如，

```
<UL class="horizontalList">
    <LI><img src="img1.png"/>Person 1</LI>
    <LI><img src="img2.png"/>Person 2</LI>
    <LI><img src="img3.png"/>Person 3</LI>
    <LI><img src="img4.png"/>Person 4</LI>
</UL> 
```

同样，您可以更改图像的样式以显示为块而不是内联，因此您可以添加以下 CSS 来做到这一点：

```
.horizontalList img {
    display: block;
    margin-bottom: 10px;
} 
```

# java - SWT 从文件中使用复合

> ID：10237396
> 
> 赞同：0
> 
> 时间：2012-04-19T21:54:34.613
> 
> 标签：java, swt, ctabitem

我正在尝试使用我在应用程序的单独文件中创建的复合材料。我不确定如何将选项卡的控制设置为复合文件。

包：hm_forms 复合文件：Comp_HM.java 主文件：Frm_Main.java 控件：tabHM

我想它必须接近。

```
Composite Comp_HM = hm_Forms.Comp_HM;
tabHM.setControl(Comp_HM); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T21:57:24.333

```
Composite Comp_HM = hm_Forms.Comp_HM;
tabHM.setControl(new Comp_HM()); 
```

您必须创建自定义组合的实例并将其传递给`setControl`方法。

# python - python线程同步

> ID：10237398
> 
> 赞同：0
> 
> 时间：2012-04-19T21:54:42.610
> 
> 标签：python, multithreading, pyqt, qthread

我有一个这样的python应用程序：

1.  主线程是GUI
2.  甚至在 GUI 之前就启动了一个配置线程
3.  配置线程启动其他几个独立线程

=> 我怎样才能让 GUI 知道所有这些“独立线程”（3.）已经完成？我如何在我的程序中检测到它（只是给我一个大致的想法）

我知道信号量，但我想不通，因为这在逻辑上比我在处理线程时习惯的要复杂一些。

PS如果这很重要，所有这些线程都是来自PyQt的QThreads，但我对此表示怀疑。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:03:58.647

[*Queue 模块*](http://docs.python.org/library/queue.html#module-Queue)非常适合在线程之间进行通信，而无需担心锁或其他互斥锁。它具有一对方法，task_done() 和 join()，用于发出任务完成的信号并等待所有任务完成。这是文档中的一个示例：

```
def worker():
    while True:
        item = q.get()
        do_work(item)
        q.task_done()

q = Queue()
for i in range(num_worker_threads):
     t = Thread(target=worker)
     t.daemon = True
     t.start()

for item in source():
    q.put(item)

q.join()       # block until all tasks are done 
```

# semantics - 词语义相似度（距离度量）网络服务？

> ID：10237399
> 
> 赞同：1
> 
> 时间：2012-04-19T21:54:46.093
> 
> 标签：semantics, similarity, text-mining, wordnet

有没有提供单词语义相似度测量的网络服务？

我知道[Disco](http://www.linguatools.de/disco/disco_en.html)，但我更喜欢基础不断增长的服务（如果您在项目中尝试过它会很有帮助）。

我也知道基于 WordNet 的算法，但是作为项目资源的一部分安装和管理它会带来很大的负担。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-10T21:52:53.087

您可以考虑使用 google index API，这里有一个示例应用程序 - [http://www.mechanicalcinderella.com/](http://www.mechanicalcinderella.com/)使用它并链接到描述该技术的原始论文。源代码在这里 - [http://complearn.org/index.html](http://complearn.org/index.html)。

我自己没有用过它，除了好玩……但它看起来很不错。

# java - Glassfish & JMS：为什么发布的消息没有到达订阅者？

> ID：10237400
> 
> 赞同：2
> 
> 时间：2012-04-19T21:54:48.513
> 
> 标签：java, glassfish, jms, mq

我有一个在远程机器（JDK 1.6.0_30）上运行的 Glassfish 3.1.2 服务器。以下代码是在 Java SE 环境中运行的独立客户端，使用 JNDI 查找连接到 JMS。客户端同时是发布者和订阅者。

我创建了 JMS 连接池和主题，如下所示：

```
./asadmin create-jms-resource --restype javax.jms.ConnectionFactory jms/TopicConnectionFactory
./asadmin create-jms-resource --restype javax.jms.Topic jms/TopicUpdate 
```

我启动了这个客户端的两个实例。消息似乎已传递 - 没有错误 - 但消息没有到达订阅者......

我做错了什么？

任何帮助表示赞赏 - 非常感谢提前！

```
public class JMS implements MessageListener {

    private TopicConnectionFactory factory;
    private TopicConnection connection;
    private Topic topic;

    private void subscribe() {
        try {
            System.setProperty("org.omg.CORBA.ORBInitialHost", "192.168.1.6");
            System.setProperty("org.omg.CORBA.ORBInitialPort", "3700");
            InitialContext ctx = new InitialContext();
            factory = (TopicConnectionFactory)ctx.lookup("jms/TopicConnectionFactory");
            topic = (Topic)ctx.lookup("jms/TopicUpdate");
            connection = factory.createTopicConnection();
            TopicSession session = connection.createTopicSession(false, Session.AUTO_ACKNOWLEDGE);
            TopicSubscriber subscriber = session.createSubscriber(topic);
            subscriber.setMessageListener(this);
            connection.start();
            while(true) {
                Thread.sleep(5000);
                sendMessage();
            }
        } catch (InterruptedException ex) {
            Logger.getLogger(JMS.class.getName()).log(Level.SEVERE, null, ex);
        } catch (NamingException ex) {
            Logger.getLogger(JMS.class.getName()).log(Level.SEVERE, null, ex);
        } catch (JMSException ex) {
            Logger.getLogger(JMS.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void sendMessage() {
        try {
            TopicSession session = connection.createTopicSession(true, Session.AUTO_ACKNOWLEDGE);
            TopicPublisher publisher = session.createPublisher(topic);
            TextMessage message = session.createTextMessage();
            message.setText("Message from client.");
            publisher.send(message);
            session.close();
            System.out.println("Message sent.");
        } catch (JMSException ex) {
            Logger.getLogger(JMS.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    @Override
    public void onMessage(Message msg) {
        System.out.println("Message received.");
    }

    public JMS() {
        subscribe();
    }

    public static void main(String[] args) {
        new JMS();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T10:20:53.763

当您在创建会话时使用 true 作为第一个参数时，确认模式将被忽略，并假定您已进行交易。尝试将第一个参数设置为 false。

很清楚，修改这行代码：

```
TopicSession session = connection.createTopicSession(true, Session.AUTO_ACKNOWLEDGE); 
```

成为 ：

```
TopicSession session = connection.createTopicSession(false, Session.AUTO_ACKNOWLEDGE); 
```

在您的发送消息方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T07:32:16.457

让发布者和订阅者不同是个好主意。我

这是如何使用 Spring JMS 模板订阅的代码。

```
public class MsgReader implements
        SessionAwareMessageListener<Message> {

    @Override
    public void onMessage(Message message, Session session) throws JMSException {
        if (message instanceof TextMessage) {
            try {
                System.out.println(((TextMessage) message).getText());

            } catch (JMSException ex) {
                throw new RuntimeException(ex);
            }
        } else {
            throw new IllegalArgumentException(
                    "Message must be of type TextMessage");
        }
    }
} 
```

*   弹簧豆文件。

*   最后加载bean。

    公共类 SpringJMSTest {

    ```
    /**
     * @param args
     */
    public static void main(String[] args) {
        ApplicationContext context = new FileSystemXmlApplicationContext(new String[]{"/resource/consumerBean.xml"});
            }
    } 
    ```

*   现在您将开始在控制台中接收消息。

# sorting - MongoDB 索引和自然排序优化

> ID：10237401
> 
> 赞同：3
> 
> 时间：2012-04-19T21:54:56.410
> 
> 标签：sorting, mongodb, indexing

在上限集合上按反向插入顺序排序的最快方法是什么（“rf”已被稀疏索引）

```
db.log.find({ rf : 'o-5556457634'}).sort({ '$natural' : -1 }).explain();
{
"cursor" : "ReverseCappedCursor",
"nscanned" : 1654468,
"nscannedObjects" : 1654468,
"n" : 4,
"millis" : 2932,
"nYields" : 5,
"nChunkSkips" : 0,
"isMultiKey" : false,
"indexOnly" : false,
"indexBounds" : {

}
} 
```

似乎“自然”绕过了索引（“rf”）字段的使用，显着减慢了查询速度。这是预期的预期行为吗？不应该在查找/索引之后计算“自然”排序吗？

没有“自然”排序：

```
db.log.find({ rf : 'o-5556457634'}).explain();
{
"cursor" : "BtreeCursor rf_1",
"nscanned" : 4,
"nscannedObjects" : 4,
"n" : 4,
"millis" : 0,
"nYields" : 0,
"nChunkSkips" : 0,
"isMultiKey" : false,
"indexOnly" : false,
"indexBounds" : {
    "rf" : [
        [
            "o-5556457634",
            "o-5556457634"
        ]
    ]
} 
```

提示确实强制引擎使用“rf”索引，但结果绕过（反向）“自然”排序

```
db.log.find({ rf : 'o-5556457634'}).sort({ '$natural' : -1 }).hint({rf :1}).explain();
{
"cursor" : "BtreeCursor rf_1",
"nscanned" : 4,
"nscannedObjects" : 4,
"n" : 4,
"scanAndOrder" : true,
"millis" : 0,
"nYields" : 0,
"nChunkSkips" : 0,
"isMultiKey" : false,
"indexOnly" : false,
"indexBounds" : {
    "rf" : [
        [
            "o-5556457634",
            "o-5556457634"
        ]
    ]
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-20T12:14:57.550

Faced the same problem but found a solution. You can create index on the fields you're mentioning in find filter with addition of the "_id":-1 field and then use sort({"_id":-1}). Helped me.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T02:32:26.720

当您添加`sort`.

您可以尝试添加`.hint({rf :1})`到查询中以查看会发生什么吗？

# mysql - Rails 范围覆盖选择

> ID：10237402
> 
> 赞同：1
> 
> 时间：2012-04-19T21:54:57.970
> 
> 标签：mysql, ruby-on-rails, optimization, named-scope

我有一个具有 has_many 关系的模型，以及一个确定它是否有任何孩子的范围，例如：

```
 scope :with_nomination, :include => [:nomination], :conditions => "nominations.service_id IS NOT NULL" 
```

使用它，我可以做类似的事情，`Service.with_nomination`并收到一份包含提名儿童的所有服务的清单。

问题是，当我`Service.select("id, firstName, lastName").with_nomination`在 essense 中执行 ActiveRecord之类的操作时，这样做`SELECT * FROM services`非常糟糕，并且没有使用我煞费苦心设置的索引。

如何改写我的查询或修改我的范围以使用 .select() 命令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:44:34.710

结果在我使用的语法中，选择是不可能的，所以它做了一个选择 * 并且任何进一步的选择都已经被覆盖了。

我像这样重写了范围：

```
scope :no_nomination, joins("LEFT JOIN nominations ON nominations.service_id = services.id").where("nominations.service_id IS NULL")
# important distinction here, the left join allows you to find those records without children

scope :with_nomination, joins(:nomination).where("nominations.service_id IS NOT NULL") 
```

使用这种语法可以让我做类似的事情`Service.select(:id,:user,:otherfield).with_nomination`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-02T22:34:08.027

8年后...

这很难看，但您也可以将结果`ActiveRecord::Relation`转换为 sql`to_sql`并使用`ActiveRecord::Base.connection.execute`.

它可能看起来像这样：

```
query = Service.select("id, firstName, lastName").with_nomination.to_sql
records = ActiveRecord::Base.connection.execute(query)
records.first["firstName"] # => First Name 
```

这并不能消除范围检索的多余列，*并且*您必须使用字符串键访问每个字段，但是，至少您仍然可以访问它们！

# php - 无法连接到 chat.facebook.com:5222 XMPP

> ID：10237403
> 
> 赞同：1
> 
> 时间：2012-04-19T21:55:09.270
> 
> 标签：php

我正在用 xmpp 制作 facebook 聊天 api。我已经从[http://developers.facebook.com/docs/chat/下载了代码](http://developers.facebook.com/docs/chat/)

但是，我收到错误

```
Test platform connect for XMPP
access_token: <access_token_code>
server: chat.facebook.com
uid: 100002805874899
app id: 434781259869574
[INFO] Opening connection... 
Warning: fsockopen() [function.fsockopen]: unable to connect to chat.facebook.com:5222 (A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. ) in C:\domains\telecomlijn.nl\wwwroot\wordpress\fbchat.php on line 52
 A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond. (10060)
An error ocurred 
```

下面是我的代码

请帮助我修复错误并成功运行应用程序...

# android - webview.loadData() 不会加载本地图片

> ID：10237406
> 
> 赞同：1
> 
> 时间：2012-04-19T21:55:39.743
> 
> 标签：android

我有一个动态构建的 html 页面。一些图像来自 Internet url，而其他图像我想从 Assets 文件夹中加载。页面正确呈现互联网图像，但是它只是拒绝加载本地图像。我尝试了许多变体，包括以下变体，但没有一个会加载本地图像。如果一切都是从互联网 url 加载的，整个页面都会正确呈现，但我真的不想去互联网上寻找不会改变的静态内容。有任何想法吗？

String pageData="一堆html标记...";

//-- 我必须从下面的 img 标签中删除 < 才能通过此论坛上的垃圾邮件过滤器-->

//--尝试1--> pageData += "img src='file:///data/data/(我的包)/files/image1.png' alt='我的图片'>";

//--尝试2--> pageData += "img src='/data/data/(我的包)/image1.png' alt='我的图片'>";

//--尝试 3--> pageData += "img src=' src='data:image/jpeg;base64,'" + readAssetFileAsBase64("image1.png") + "' alt='我的图片'>" ;

//--尝试 4--> 炸药！

该页面使用..

webview.loadData(pageData,"text/html",null);

但我也试过

webview.loadDataWithBaseURL("file://", s, "text/html","windows-1252" ,null);

我不能使用 .loadUrl() 因为页面是动态构建的。我想我可以通过调用 .loadUrl() 将动态页面写入磁盘，但这似乎效率不高。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T00:38:37.337

您需要确保使用基本 url 加载 html，尽管该基本 url 不需要是任何相关的

```
webView.loadDataWithBaseURL("fake://not/needed", htmlString, mimeType, encoding, ""); 
```

然后你可以使用类似这样的东西来引用资产文件夹中的东西

```
file:///android_asset/image1.jpg 
```

“android_asset”路径似乎是你还没有尝试过的东西。如果您的文件不在您的资产文件夹中，那么您需要使用 ContentProvider 为它们提供服务，请参阅我网站上的本教程：[http ://responsiveandroid.com/2012/02/20/serving-android-webview-resources-with-内容提供者.html](http://responsiveandroid.com/2012/02/20/serving-android-webview-resources-with-content-providers.html)

# mysql - 迁移行以导入现有数据库，注意更改 id 等

> ID：10237408
> 
> 赞同：7
> 
> 时间：2012-04-19T21:55:49.613
> 
> 标签：mysql, mysqldump, data-migration

这样做的目的是在不覆盖现有行的情况下将一些行从一个环境复制到另一个环境。

示例数据库：

```
INSERT INTO `school` (school_id,name) VALUES (15,'Middle');
INSERT INTO `class` (class_id,school_id,name) VALUES (12,15,'Sample'); 
```

这个想法是`school_id`并且`class_id`是自动增量，并且`class`有一个外键链接回到`school`. 但我只想转储这些行并将它们插入到另一个已经有15行**的数据库中。**`school_id`

它可能看起来像：

```
INSERT INTO `school` (name) VALUES ('Middle');
INSERT INTO `class` (school_id,name) VALUES (LAST_INSERT_ID(),'Sample'); 
```

但这仅适用于这个简单的示例。想象一下，如果我有 50 个班级，每个班级 25 名学生，每个学生/班级组合有几百个成绩。`LAST_INSERT_ID()`如果不将其存储在一系列变量中，您可以看到它可能无法工作。

进行这种操作的合适工具是什么？能做`mysqldump`这么聪明的事吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T07:53:05.483

你可以这样做：

*   `school_id`在目标`school`表中找到 MAX -

    `SELECT MAX(school_id) INTO @max_school_id FROM school;`

*   更改`school_id`源表 ( `school`, ) 中的所有值 -从上一点`class`添加 MAX -`school_id`

    `UPDATE school SET school_id = school_id + @max_school_id + 1;`

向外键添加操作可能非常有用`ON UPDATE CASCADE`，它将有助于`school_id`自动更改子表，例如 -

```
ALTER TABLE class
  DROP FOREIGN KEY FK_name;
ALTER TABLE class
  ADD CONSTRAINT FK_name FOREIGN KEY (school_id)
    REFERENCES school(school_id) ON UPDATE CASCADE; 
```

*   进行转储和导入。

* * *

**解释和例子：**

***创建源表：***

```
CREATE TABLE school(
  school_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(20)
);

INSERT INTO school (school_id, name) VALUES
  (1, 'Middle1'),
  (2, 'Middle2'),
  (3, 'Middle3'),
  (15, 'Middle');

CREATE TABLE class(
  class_id INT(11) NOT NULL,
  school_id INT(11) DEFAULT NULL,
  name VARCHAR(20) DEFAULT NULL,
  PRIMARY KEY (class_id),
  CONSTRAINT FK_class_school_school_id FOREIGN KEY (school_id)
  REFERENCES school (school_id) ON DELETE RESTRICT ON UPDATE CASCADE
)
ENGINE = INNODB;

INSERT INTO class (class_id, school_id, name) VALUES (11, 1, 'Sample1');
INSERT INTO class (class_id, school_id, name) VALUES (12, 15, 'Sample'); 
```

***创建目标表：***

```
CREATE TABLE school(
  school_id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(20)
);

INSERT INTO school (school_id, name) VALUES
  (1, 'Top'),
  (2, 'Middle'),
  (3, 'Bottom'),
  (15, 'Top');

CREATE TABLE class(
  class_id INT(11) NOT NULL,
  school_id INT(11) DEFAULT NULL,
  name VARCHAR(20) DEFAULT NULL,
  PRIMARY KEY (class_id),
  CONSTRAINT FK_class_school_school_id FOREIGN KEY (school_id)
  REFERENCES school (school_id) ON DELETE RESTRICT ON UPDATE CASCADE
)
ENGINE = INNODB;

INSERT INTO class (class_id, school_id, name) VALUES (10, 2, 'Sample2');
INSERT INTO class (class_id, school_id, name) VALUES (12, 15, 'Sample'); 
```

**更新源表，增加 id 值：** 我们应该更新所有唯一值，在我们的例子中，我们必须更新表和表`class_id`中的值。`class``school_id``school`

***`class_id`查找目标`class`表的最大值***

```
SELECT MAX(class_id) + 1000 FROM class; -- This will return => 1012 
```

***增加所有 SOURCE`class_id`值`class_id + 1012`***

```
UPDATE class SET class_id = class_id + 1012; 
```

***`school_id`查找目标`school`表的最大值***

```
SELECT max(school_id) + 1000 FROM school; -- This will return =>1015 
```

***增加所有 SOURCE`school_id`值`school_id + 1015`***

```
UPDATE school SET school_id = school_id + 1015; 
```

**就这些。我们可以转储源表：**

```
INSERT INTO school VALUES
  (1016, 'Middle1'),
  (1017, 'Middle2'),
  (1018, 'Middle3'),
  (1030, 'Middle');

INSERT INTO class VALUES
  (1023, 1016, 'Sample1'),
  (1024, 1030, 'Sample'); 
```

**现在我们可以轻松地针对目标数据库运行此脚本。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-22T16:09:18.733

您需要在 SQL 中执行此操作吗？即使是最基本的 ETL 工具也会更适合。改用 pentaho 或 talend。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-29T12:02:17.050

一个非常简单的技巧就是将 id 乘以 -1。负 id 与任何 id 一样好，我假设您的 auto_increment 列无论如何都以正数开头。

从一个环境中导出：

```
select -1*school_id, name from school into outfile 'school.out';
select -1*class_id, -1*school_id, name from class into outfile 'class.out'; 
```

导入第二个：

```
load data infile 'school.out' into table school;
load data infile 'class.out' into table class; 
```

显然，这不是解决您问题的通用解决方案，但您需要多久使用一次？:)

通用解决方案是自己编写迁移逻辑，无论是在 ETL 工具中还是作为独立脚本，正如其他人所说的那样。并使该工具/脚本使用 INFORMATION_SCHEMA.TABLES 和 INFORMATION_SCHEMA.COLUMNS 动态找出需要调整的表和列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-22T17:12:08.687

如果您不需要纯 SQL 解决方案，您可以非常轻松地创建一个从旧数据库读取并写入新数据库的脚本。我在想 PHP，Python，Ruby，Perl，...

这是 PHP 中的一个简单解决方案，假设您正在使用 mysql 并在数据库之间移动数据（**未经测试，可能包含错误**）：

```
$dbh1 = new PDO("mysql:host=db1.host;dbname=db1", "user1", "pass1");
$dbh2 = new PDO("mysql:host=db2.host;dbname=db2", "user2", "pass2");

$sth1 = $dbh1->query("
    SELECT
        school.school_id as school_id,
        school.name as school_name, 
        class.name as class_name
    FROM school
    JOIN class ON (school.school_id = class.school_id)
");

$sth3 = $dbh2->prepare("INSERT INTO school (name) VALUES (:name)");
$sth4 = $dbh2->prepare("INSERT INTO class (school_id, name) VALUES (:school_id, :name)");

$schools = array();

// get schools and classes
while ($school = $sth1->fetch(PDO::FETCH_ASSOC)) {
    $school_id = $school['school_id'];
    $school_name = $school['school_name'];

    $schools[$school_id]['school_name'] = $school_name;

    $schools[$school_id]['classes'][] = array(
        'class_name' => $school['class_name']
    );
}

// insert schools and classes
foreach ($schools as $school_id => $school) {
    // insert school
    $sth3->bindParam(':name', $school['school_name'], PDO::PARAM_INT);
    $sth3->execute();

    $new_school_id = $dbh2->lastInsertId();

    // a loop for classes
    foreach ($school['classes'] as $class) {
        // insert class
        $sth4->bindParam(':school_id', $new_school_id, PDO::PARAM_INT);
        $sth4->bindParam(':name', $class['class_name'], PDO::PARAM_STR);

        $sth4->execute();
    }

    // a loop for another joined table
    /*
    foreach ($school['joined'] as $join) {
        // insert join
        $sth4->bindParam(':school_id', $new_school_id, PDO::PARAM_INT);
        $sth4->bindParam(':name', $join['join_name'], PDO::PARAM_STR);

        $sth4->execute();
    }
    */
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-29T14:09:28.977

我认为最好的方法是从传输中消除 id。**假设**学校名称是唯一的，这似乎适用于异常的模式，并且为简单起见，将两个数据库放在同一台服务器上：

将数据复制到新数据库的表中，没有 id，只有名称：

```
CREATE TEMPORARY TABLE tmp AS SELECT s.name as school_name, c.name as class_name
FROM test.school s JOIN test.class c USING(school_id); 
```

将新学校添加到学校表中：

```
INSERT INTO school (name) SELECT DISTINCT school_name FROM tmp
LEFT JOIN school ON school_name = name WHERE name IS NULL; 
```

将新班级（现有学校和新学校）添加到班级表中：

```
INSERT INTO class (name, school_id) SELECT class_name, school_id
FROM tmp t JOIN school s ON s.name = t.school_name; 
```

如果源中学校的目标数据库中没有该课程，您想要什么语义？这是一个联合，如果你想删除，你必须改变它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-28T14:41:46.013

如果你有临时表权限，你可以这样做：

```
CREATE TEMPORARY TABLE tmp_school LIKE school;
LOAD DATA LOCAL INFILE 'school.dat' INTO TABLE tmp_school;
CREATE TEMPORARY TABLE tmp_class LIKE class;
LOAD DATA LOCAL INFILE 'class.dat' INTO TABLE tmp_class;
INSERT INTO school (name) SELECT name FROM tmp_school;
INSERT INTO class (school_id,name) 
  SELECT school.school_id, class.name FROM school school JOIN tmp_school new
USING(name) JOIN tmp_class class ON new.school_id = class.school_id 
```

我认为这是正确的，但需要进行一些检查。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-29T14:10:46.900

如果您在 php 中使用此命令，那么有一个简单的函数可以为您提供插入查询的最后一个 id。即mysql_insert_id()。

代码可能是这样的：

```
<?php
    $query = mysql_query("INSERT INTO `school` (school_id,name) VALUES (15,'Middle')");
    $last_id = mysql_insert_id();
    INSERT INTO `class` (class_id,school_id,name) VALUES ('$last_id','Sample');
?> 
```

如果您使用其他语言，我不知道该怎么做。

# c - C 结构和指针程序在编译时什么也不做。不显示错误或警告

> ID：10237411
> 
> 赞同：1
> 
> 时间：2012-04-19T21:56:00.727
> 
> 标签：c, pointers, struct

我有这个代码，它没有为我运行。它不会给出任何错误或警告。所以我不知道它有什么问题。我对结构中的指针不太熟悉，我什至不知道这部分代码是否导致它无法运行。

我已经使用了 Code::Blocks 和 DevC++ 来编译它，但两者都没有任何不同。

它有点长，但只有 3 个功能。对我来说根本没有任何东西打印到屏幕上。

```
#include <stdio.h>
#include <stdlib.h>

struct foo{
        int num;
        char *word;
        struct foo *ptr;
};
void func1(struct foo);
void func2(struct foo*);
void func3(struct foo);

int main() {
        struct foo a;
        a.num = 5;
        a.word ="myword";
        func1(a);
        printf("1 %d %s\n", a.num, a.word);

        a.num = 100;
        a.word = "secondword";
        func2(&a);
        printf("2 %d %s\n", a.num, a.word);

        a.ptr = &a;
        a.num = 50;
        a.word = "mylastword";
        func3(a);
        printf("4 %d %s\n", a.num, a.word);
}

void func1(struct foo a)
{
        while(*(a.word) != '\0');
        {
            putchar(*(a.word));
            a.word++;
        }
        putchar('\n');
        if(a.num % 10 != 0)
        {
            a.num *= 2;
        }
        a.word--;
        printf("num is %d\n", a.num);
}

void func2(struct foo *a)
{
        while(*(a->word) != '\0')
            { putchar(*(a->word));
              a->word++; }

                    putchar('\n');
        if(a->num % 10 != 0)
            { a->num *= 2; }
        a->word--;
        printf("num is %d\n", (*a).num);
}

void func3(struct foo a)
{
        if(a.num > a.ptr->num)
            { a.num = 500; }
        else
            { a.num = a.ptr->num +1; }
        a.word = "myotherword";
        a.ptr->word = "yetAnotherWord";
        printf("3 %d %s\n", a.num, a.word);
} 
```

任何帮助将非常感激。

谢谢你们。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T21:57:44.230

```
void func1(struct foo a)
{
    while(*(a.word) != '\0'); 
```

while 语句后不应有分号。

修复后，它会打印：

```
[4:58pm][wlynch@watermelon /tmp] ./foo
myword
num is 10
1 5 myword
secondword
num is 100
2 100 d
3 51 myotherword
4 50 yetAnotherWord 
```

为了强化abelenky 的评论，使用调试器需要3 秒才能发现。

```
[4:59pm][wlynch@watermelon /tmp] g++ -g foo.cc -o foo
[4:59pm][wlynch@watermelon /tmp] gdb ./foo
GNU gdb 6.3.50-20050815 (Apple version gdb-1752) (Sat Jan 28 03:02:46 UTC 2012)

(gdb) run
Starting program: /private/tmp/foo 
Reading symbols for shared libraries ++......................... done
^C
Program received signal SIGINT, Interrupt.
func1 (a={num = 5, word = 0x100000e91 "myword", ptr = 0x7fff5fbffa58}) at foo.cc:34
34      while(*(a.word) != '\0');
(gdb) 
```

# php - 带有声明的类构造函数错误

> ID：10237412
> 
> 赞同：0
> 
> 时间：2012-04-19T21:56:03.577
> 
> 标签：php, class

我收到了错误，NetBeans 告诉我它在 $xml_package 声明的最后一行期待一些东西。有什么我想念的想法吗？

谢谢你。

```
class foo
{
    public function __construct()
    {
        public $rateRequest = 'RateV4Request';

        public $xml_request = '<'. $rateRequest. '><Revision></Revision></'.
                              $rateRequest. '>';

        public $xml_package = '<Package><Service></Service><ZipOrigination>
                        </ZipOrigination><ZipDestination></ZipDestination>
                        <Pounds></Pounds><Ounces></Ounces><Container>
                        </Container><Size></Size></Package>';
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:59:44.773

那是因为你在构造函数本身中声明你的属性，而不是在类中

```
class foo 
{ 
    protected $rateRequest; 

    protected $xml_request; 

    protected $xml_package; 

    public function __construct() 
    { 
        $this->rateRequest = 'RateV4Request'; 

        $this->xml_request = '<'. $this->rateRequest. '><Revision></Revision></'. 
                              $this->rateRequest. '>'; 

        $this->xml_package = '<Package><Service></Service><ZipOrigination> 
                        </ZipOrigination><ZipDestination></ZipDestination> 
                        <Pounds></Pounds><Ounces></Ounces><Container> 
                        </Container><Size></Size></Package>'; 
    } 
} 
```

# android - testdroid 记录器与 acra

> ID：10237415
> 
> 赞同：0
> 
> 时间：2012-04-19T21:56:15.030
> 
> 标签：android, acra

我最近阅读了有关 testdroid 的信息，用于跟踪我的应用程序的用户错误，并且我使用了非常酷的 ACRA，但我想从用户那里知道哪个更好，是否真的值得为 testdroid 付费？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:31:24.000

我不得不说，从 testDroid 获得的代码生成并不足以证明价格标签的合理性。它工作正常。为了避免编写按钮单击和按下的测试代码，但对于手势或拖动方面更复杂的任何事情（在我们的应用程序中发挥重要作用），它似乎并没有很好地工作。当然，这是几个月前的事了，从那时起他们可能已经有所改善。

# java - web.xml 中的欢迎文件，spring 不起作用？

> ID：10237416
> 
> 赞同：5
> 
> 时间：2012-04-19T21:56:17.147
> 
> 标签：java, spring, servlets, spring-mvc, jetty

我已经设置了我的 spring-mvc servlet 来匹配 * *.page*请求。我已将 web.xml 中的*欢迎文件列表*设置为 index.page

当我转到我的网络服务器的根目录时，这有效：

[http://me.com](http://me.com)确实被重定向到[http://me.com/index.page](http://me.com/index.page)正确。

但是，当我使用子目录时它不会重定向：

[http://me.com/dashboard](http://me.com/dashboard)没有*被*重定向到[http://me.com/dashboard/index.page](http://me.com/dashboard/index.page)

有没有办法让这个映射工作？

我的 web.xml 文件（提取）：

```
<welcome-file-list>
    <welcome-file>index.page</welcome-file>
</welcome-file-list>

<servlet-mapping>
    <servlet-name>spring-mvc</servlet-name>
    <url-pattern>*.page</url-pattern>
</servlet-mapping> 
```

我的 webdefault.xml（来自码头）：

```
 <init-param>
        <param-name>dirAllowed</param-name>
        <param-value>false</param-value>
    </init-param>
    <init-param>
        <param-name>welcomeServlets</param-name>
        <param-value>true</param-value>
    </init-param>
    <init-param>
        <param-name>redirectWelcome</param-name>
        <param-value>false</param-value>
    </init-param> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-21T03:06:12.797

应该代表任意文件夹中物理存在的`<welcome-file>`文件，当最终用户请求文件夹时您希望提供该文件夹（例如 root `/`，但它也可以是任何其他文件夹，例如`/foo/`）。您只需要了解 servletcontainer 在执行转发之前会测试其物理存在，如果不存在则返回 HTTP 404 page not found 错误。

在您的特定情况下，您的根文件夹中没有物理`index.page`文件。您的根文件夹中*实际上*有一个`index.jsp`文件。这`index.page`只是一个虚拟 URL。因此 servletcontainer 将无法找到物理`index.page`文件，因此会出现 404 错误。

您可以通过在同一文件夹中的`index.page`文件旁边放置物理上存在的文件来欺骗 servlet 容器来解决此问题。`index.jsp`该文件可以完全保持为空。servletcontainer 将找到该文件，然后转发到`index.page`该文件，然后调用控制器 servlet，该控制器 servlet 实际上将`index.jsp`作为视图提供服务。那会很好的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T21:59:01.433

它仅适用于真实的物理目录，不适用于模拟目录结构的任意 servlet 映射。

Spring MVC 允许非常复杂的 URL 映射，所以你最好用`@RequestMapping`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-04T16:36:36.030

为了避免转发欢迎文件本身，最好为其添加映射。

```
 <servlet-mapping>
     <servlet-name>spring-mvc</servlet-name>
     <url-pattern>index.html</url-pattern>
  </servlet-mapping> 
```

在 java 配置的情况下，您可以覆盖扩展 WebMvcConfigurerAdapter 的类中的两个方法

```
@Override
public void addViewControllers(ViewControllerRegistry registry) {
    registry.addViewController("/").setViewName("/index");
}

@Override
public void configureDefaultServletHandling(DefaultServletHandlerConfigurer configurer) {
    configurer.enable();
} 
```

如果您想显式提供 index.html，请将其转换为资源覆盖同一类中的方法，如下所示：

```
@Override
public void addResourceHandlers(ResourceHandlerRegistry registry) {
    registry.addResourceHandler("/index.html").addResourceLocations("/WEB-INF/views/index.html");
} 
```

当然`addResourceLocations`必须遵循选择保存您的意见的文件夹。

查看[这些示例](https://github.com/spring-projects/spring-test-mvc/blob/master/src/test/java/org/springframework/test/web/server/samples/context/WebConfig.java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-20T02:38:37.893

这是您可能需要在 Web 服务器中设置的内容，因此，可能是特定于服务器的

对于 Apache HTTP Server，您可以通过设置 DirectoryIndex 指令来实现这一点，如下所示： `DirectoryIndex index.page`

显然，有人已经问过这个问题，并且已经[在目录中的 web.xml 默认文件中接受了答案（对于码头或 tomcat）？](https://stackoverflow.com/questions/5489736/web-xml-default-file-in-directory-for-jetty-or-tomcat)- 看看它是否适合你。

# windows - 如何查找正在使用的临时端口的数量？

> ID：10237419
> 
> 赞同：3
> 
> 时间：2012-04-19T21:56:53.547
> 
> 标签：windows, networking, tcp, network-programming, tcp-port

我有一种情况，我遇到临时端口耗尽，然后导致异常。我想限制连接以避免这种情况。有没有办法检测正在使用的临时端口的数量？

谢谢，埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-29T08:55:15.570

要获取打开的连接列表，您可以使用 netstat 命令。与普遍认为（其他答案）相反，临时端口的数量是有限的（Windows 2003 为 4000，更高版本为 16000，大多数 Linux 为 16000）。另请注意，一旦端口变得未使用，释放端口需要 4 分钟，因此这确实是一个问题。

MSDN上有一篇文章处理它： http: [//msdn.microsoft.com/en-us/library/aa560610 (v=bts.20).aspx](http://msdn.microsoft.com/en-us/library/aa560610%28v=bts.20%29.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T22:17:24.883

用尽临时 TCP 端口的唯一方法是，如果您是客户端并且您已经打开了近 64k 出站连接，并且在最后两分钟内没有关闭它们。

这有时会发生在测试场景中，但它并不代表真实世界的案例，因此没有真正的意义。

这种情况的症状是连接时出现绑定错误。如果您没有收到绑定错误，则说明您没有此问题。

# objective-c - 核心数据编辑/保存实体中的属性

> ID：10237420
> 
> 赞同：1
> 
> 时间：2012-04-19T21:56:54.137
> 
> 标签：objective-c, cocoa-touch, core-data

我正在努力编辑/保存核心数据，需要一些帮助。我正在使用 NSFetchedResultsController 并在 Core Data 中有一个名为 Golfer 的实体，其属性包括 first_name、last_name、email_id 和其他属性。所以，我知道如何在数据库中添加和删除高尔夫球手。

我正在开发一个名为 ViewManager 的视图控制器（我所有类的基本视图），它里面有 2-3 个自定义 UIView。每当我需要它们时，我都会为它们设置动画。

我将高尔夫球手添加到 tableview，然后在 didSelectRow tableview 方法上，我在同一个 ViewManager 控制器中显示我的编辑视图，并尝试使用以下代码更新编辑视图中的文本字段，但它在 tableview 中的随机索引处更新，而不是为我工作。任何帮助将不胜感激。

```
- (IBAction)saveEditGolfersView:(id)sender
{
    AppDelegate * applicationDelegate = (AppDelegate *) [[UIApplication sharedApplication] delegate];
    NSManagedObjectContext * context = [applicationDelegate managedObjectContext];

    // Retrieve the entity from the local store -- much like a table in a database
    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Golfer" inManagedObjectContext:context];
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    [request setEntity:entity]; 

    // Set the sorting -- mandatory, even if you're fetching a single record/object
    NSSortDescriptor *sortDescriptor1 = [[NSSortDescriptor alloc] initWithKey:@"first_name" ascending:YES];

    NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor1,nil];
    [request setSortDescriptors:sortDescriptors];
    [sortDescriptors release]; sortDescriptors = nil;
    [sortDescriptor1 release]; sortDescriptor1 = nil;

    NSError * error;

    NSArray * objects = [context executeFetchRequest:request error:&error];

    for(int i = 0; i<[objects count]; i++)
    {
        Golfer * golfguy = [objects objectAtIndex:i];

        golfguy.first_name = mEditFirstName.text;
        golfguy.middle_name = mEditMiddleName.text;
        golfguy.last_name = mEditLastName.text;
        golfguy.email_id = mEditEmailField.text;
        golfguy.contactNumber = mEditContactNum.text;
        golfguy.picture = mEditPictureView.image;

        NSLog(@"name-%@", golfguy.first_name);
    }

    [request release]; request = nil;

     error = nil;
    [context save:&error];

    [UIView animateWithDuration:0.3 delay:0 options:UIViewAnimationOptionCurveEaseOut

                     animations:^ {

                         mEditGolfersView.frame = CGRectMake(-480, mEditGolfersView.frame.origin.y, mEditGolfersView.frame.size.width, mEditGolfersView.frame.size.height);

                     }

                     completion:^(BOOL finished) {
                         mEditGolfersView.hidden = YES;

                     }];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T00:22:35.003

如果我已正确阅读此代码，那么调用`-(IBAction)saveEditGolfersView:(id)sender`将设置所有 Golfers 的确切属性，我预计这不是您想要的。

我不太确定问题出在哪里，但我假设您需要一个`NSPredicate`和您一起`NSFetchRequest`去更换正确的高尔夫球手。

也许我错过了一些东西，但是这段代码对我说：“嘿，我将在数据库中加载所有 Golfer，按他们的名字排序，然后将它们的所有属性设置为完全相同的文本字段页”。只是听起来像个坏消息...

要仅编辑一名高尔夫球手，请务必将您正在编辑的高尔夫球手存储在某个地方的属性中。由于您将 managedObjectContext 存储在 applicationDelegate 上，因此它将保持活动状态，从而使您的核心数据对象保持活动状态。这将避免您在保存视图中进行的昂贵的获取。但是，如果您不想保留对高尔夫球手对象的引用，则每个对象`NSManagedObject`都有一个`objectId`，这是核心数据使用的标识符。您可以`objectId`像这样在 fetch 谓词中使用：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"objectId == %@", self.editingGolferObjectId];
[request setPredicate:predicate]; 
```

在您的情况下，我会选择保留对对象的引用，而不是`objectId`

# facebook - OpenGraph：如何在 FB.api 中指定过滤器？

> ID：10237421
> 
> 赞同：4
> 
> 时间：2012-04-19T21:57:00.493
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

我已经使用 OpenGraph 构建了一个 Facebook 应用程序，该应用程序允许用户在音乐会上撰写评论，因此我定义了一个`concert_id`用户可以插入评论的属性。

现在我想显示为某个特定`concert_id`但找不到方法插入的所有评论。如果我这样做（在 JS 中）

```
FB.api('/me/MY_APP:action', { limit: 0}, function(response) {
    console.log(response);
}); 
```

我得到所有物品。这个应用程序必须由移动设备使用，我认为获取所有项目然后只过滤`concert_id`我需要的东西是不好的。我需要做什么才能将`where`OpenGraph 中的条件应用于自定义操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T14:24:17.527

据我从 API 和 Facebook 开发人员页面得知，无法使用公共 Open Graph API 通过自定义操作属性过滤调用。

我能想到的两个选择：

选项1：

通过创建自定义类别对象来实现类别过滤器：

如果“review”是一个自定义操作并且

```
GET https://graph.facebook.com/me/[name_space]:review 
```

然后返回所有审核操作

```
GET https://graph.facebook.com/me/[name_space]:review/scifi_movie
GET https://graph.facebook.com/me/[name_space]:review/action_movie 
```

返回特定于电影类型的动作，其中 scifi_movie 和 action_movie 是自定义对象。您需要为每个类别创建一个对象类型。

选项 2：

为每个类别实施自定义操作，例如

```
review_scifi_movie
review_action_movie 
```

这些不是特别优雅的解决方案，但如果没有其他方法，并且您真的不想在客户端进行过滤，它们可能作为一种黑客有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T09:56:26.223

我不懂javascript或opengraph ..

但是当我需要在 JAVA 中获取任何用户的评论时，我使用了**[FQL](http://developers.facebook.com/docs/reference/fql/)**，它检索了我所有的**[评论](http://developers.facebook.com/docs/reference/fql/review/)**，FQL 也用于获取与 Facebook 相关的所有表格。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-28T10:14:45.887

Facebook API 不会为特定操作返回单独的已发布对象，但这不是您唯一的问题。从表面上看，您是在尝试将所有针对音乐会的评论都纳入其中，对吗？（也意味着其他用户的那些）。

Facebook API 调用的“/me/”部分将只返回当前登录用户所做的那些已发布操作。这对你不起作用，因为你想要所有用户的操作

我能给出的唯一建议是创建一个简单的 Web 服务，您可以在其中存储针对各种音乐会给出的所有评论。使用此服务来获取针对特定音乐会的评论。（我在自己的应用程序中使用类似的方法进行评论）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-29T07:49:36.053

我认为您无法使用 JS SDK 实现这一目标。

不过，您可以在您的服务器中执行此操作，并且由于这是一个移动应用程序（或具有移动版本），因此这是将其从客户端责任中删除的另一个很好的理由。

在服务器端，您可以在发布时向 facebook 询问已发布的操作，过滤它们，然后返回响应。您可以做的另一件事是将每个已发布的操作保存在您的数据库中（在每个操作帖子上，您应该从 facebook 获取一个 id，只需将其保留）然后您可以根据您想要的任何标准轻松过滤已发布的操作/需要（因为您不再受 facebook api 的限制）。

开放图的东西仍然很新，而且还不够成熟，例如，您不能将 FQL 与它一起使用，这对您的情况可能很方便。无论如何，我认为服务器解决方案最适合移动设备的计算。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-03T07:39:01.237

我不知道，但试试这个

如果（会话.authResponse）{

```
 FB.api('/me', {
     fields: 'name, picture' // here mention your fields
    },
    function(response) {
      if (!response.error) { 
```

//这里是响应值 });

# java - Android - sqlite 删除所有

> ID：10237426
> 
> 赞同：2
> 
> 时间：2012-04-19T21:57:15.213
> 
> 标签：java, android, eclipse, sqlite

我正在开发一个应用程序来发展我的知识到目前为止，我已经创建了一个日历应用程序，用户可以在单击日期时进行预约。然后我有一个删除按钮，可以打开在新活动中创建的所有约会，我有：一个显示所有约会的列表视图一个显示所选约会（由用户选择删除）的文本视图和一个按钮删除。删除按钮从sqlite中删除所有项目，但我只能在应用程序重新启动时看到这个工作我知道我的代码中缺少其他内容..我如何同时清除列表视图任何帮助将不胜感激

我的代码：

删除所有方法

```
public void deleteAll() {

        db.delete(TABLE_NAME, null, null);
    } 
```

按钮代码：

```
public void onClick(View v) {
    switch(v.getId()){

    case R.id.removeBtn:

        dm.deleteAll();

        break;
    } 
```

谢谢你 }

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:21:40.497

也许不是最优雅的，但我不在 onCreate() 中构建我的 UI。相反，在 onCreate() 中，我调用了另一个方法 initializeUI()，这就是我构建用户界面的地方。然后，每当我做一些应该反映在界面中的事情（更新数据库或其他）时，我只需要再次调用我的方法 initializeUI()。

编辑：还可以查看您的适配器的 notifyDataSetChanged()，如此[处所示](https://stackoverflow.com/questions/2345875/android-notifydatasetchanged)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:12:41.543

首先检查你的数据库是否可写（getWritableDatabase）

然后检查您的“TABLE_NAME”实际上是表名。

然后你可以尝试使用 execSQL("delete from " + TABLE_NAME);

如果这不起作用，您可以尝试关闭数据库。

最后尝试将其放入事务 beginTransaction(); .. 删除.. endTransaction();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T22:48:52.713

如果您实际上正在更改 ListView 中使用的 Adapter 的数据，则可以在用于填充 Adapter 的游标上使用 requery() 方法。这应该反映您的更改！

# objective-c-blocks - Objective-C：使用块作为完成处理程序

> ID：10237430
> 
> 赞同：0
> 
> 时间：2012-04-19T21:57:26.847
> 
> 标签：objective-c-blocks

我正在使用 CLGeocoder，并且正在使用块作为完成处理程序。我不确定我创建的 CLGeocoder 实例的保留/释放周期。

这是基本代码：

```
CLGeocoder* geocoder = [[CLGeocoder alloc] init];
[geocoder reverseGeocodeLocation:newLocation completionHandler:
    ^(NSArray* placemarks, NSError* error)
    {
        // process the placemarks...
        [geocoder autorelease];
    }
]; 
```

自动释放地理编码器作为块的最后一行是推荐的处理方式吗？任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:03:18.973

你可以直接释放它（不需要自动释放）自动释放是用于当你不确定何时需要释放一个对象时（例如在方法结束时返回一个对象或为了方便方法）

在这种情况下，您确定您已完成使用该对象，因此它可以被释放。当然，自动释放也可以，但在内存中停留的时间更长。

# php - 为什么我的 SWF 不能嵌入？

> ID：10237434
> 
> 赞同：0
> 
> 时间：2012-04-19T21:57:48.510
> 
> 标签：php, flash, cakephp-2.1

我正在尝试在我的一个视图中嵌入 SWF。这是嵌入代码：

```
echo    '<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 
        codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" 
        width="550" height="400" id="MyProject" align="middle">
        <param name="allowScriptAccess" value="sameDomain" />
        <param name="movie" value="'. $this->Html->webroot('/files/'.$project['Project']['id'].'/index.swf') .'" />
        <param name="quality" value="high" />
        <param name="bgcolor" value="#FFFFFF" />
        <embed src="'. $this->Html->webroot('/files/'.$project['Project']['id'].'/index.swf') .'" quality="high" bgcolor="#FFFFFF" width="550" height="400" 
        name="1" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" 
        pluginspage="http://www.macromedia.com/go/getflashplayer" /></object>'; 
```

它应该从`app/webroot/files/1/index.swf`或中获取文件`app/webroot/files/2/index.swf`，具体取决于项目的 ID。我已经尝试用 1 或 2 代替`'.$project['Project']['id'].'`，但它仍然找不到文件。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:20:00.850

将您的代码更改为完整的 url，即输出格式应为 [http://yourdomain.com/files/project_001/index.swf](http://yourdomain.com/files/project_001/index.swf)

使结果代码看起来像这样

```
echo    '<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" 
    codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0" 
    width="550" height="400" id="MyProject" align="middle">
    <param name="allowScriptAccess" value="sameDomain" />
    <param name="movie" value="http://yourdomain.com/'. $this->Html->webroot('/files/'.$project['Project']['id'].'/index.swf') .'" />
    <param name="quality" value="high" />
    <param name="bgcolor" value="#FFFFFF" />
    <embed src="http://yourdomain.com/'. $this->Html->webroot('/files/'.$project['Project']['id'].'/index.swf') .'" quality="high" bgcolor="#FFFFFF" width="550" height="400" 
    name="1" align="middle" allowScriptAccess="sameDomain" type="application/x-shockwave-flash" 
    pluginspage="http://www.macromedia.com/go/getflashplayer" /></object>'; 
```

您必须更改此示例“http://yourdomain.com/”的所有引用并添加您的。

我希望这可以帮助你，

祝你好运！

# python - 如何从模块中的函数引用基本实例 python gtk 小部件

> ID：10237441
> 
> 赞同：0
> 
> 时间：2012-04-19T21:58:28.703
> 
> 标签：python, inheritance, gtk

我正在编写一个 Python GTK 应用程序来研究某种数学数据。主脚本只有一个类，只有三个方法：`__INIT__`、 main(self) 用于启动循环和 delete_event 用于终止循环。

`__INIT__`创建 GUI，其中包括 TextBuffer 和 TextView 小部件，以便分析函数（在单独的 functions.py 模块上定义）可以将其结果输出到公共日志/消息区域。相关摘录如下：

```
include module functions(.py)

(...)

class TURING:

  def __init__(self):

    self.window = gtk.Window(gtk.WINDOW_TOPLEVEL)

    (...)

    self.logscroll = gtk.ScrolledWindow()
    self.logscroll.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)

    self.logbuffer = gtk.TextBuffer()

    self.logpage = gtk.TextView(self.logbuffer)
    self.logpage.set_editable(gtk.FALSE)
    self.logpage.set_cursor_visible(gtk.FALSE)
    self.logpage.set_wrap_mode(gtk.WRAP_CHAR)
    self.logscroll.add(self.logpage)
    self.logscroll.show()
    self.logpage.show()

    (...)

    enditer = self.logbuffer.get_end_iter()
    self.logbuffer.insert(enditer, 'Welcome!')

    (...)

  def main(self):
    gtk.main()

if __name__ == "__main__":
  turing = TURING()
  turing.main() 
```

中间两行成功地将欢迎消息打印到 self.logpage 定义的消息区域。

现在，方法函数中的一个**函数**检查数据库是否是最新的，如果不是，则要求用户加载一批新的原始数据。

这样做的一种方法是包含一个触发该功能的菜单项，如下所示：

item_dataCheck.connect("激活", functions.data_check, '')

`functions.data_check`运行良好，但是当它尝试将其输出写入 self.logbuffer 时，会引发错误，抱怨菜单项`item_dataCheck`没有属性`logbuffer`。违规代码是

```
 enditer = self.logbuffer.get_end_iter()
 self.logbuffer.insert(enditer, 'Please update the database.') 
```

显然，名称 self 代表调用该函数的小部件，即`item_dataCheck`. 我的问题是我如何才能`functions.data_check`直接引用为类实例的`logbuffer`成员。我试着写`turing``TURING`

```
 enditer = turing.logbuffer.get_end_iter()
 turing.logbuffer.insert(enditer, 'Please update the database.') 
```

但那是行不通的。我一直在努力寻找解决方案，但没有成功。

我相信这件事很简单，而且我知道我在 Python 和 OOP 方面仍然存在一些严重的概念问题，但我们将衷心感谢任何帮助。（我开始在 Burroughs 大型机上打卡 Fortran 程序，所以我可以指望一些社区的仁慈......）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T00:12:43.623

在将信号连接到函数或方法时，您可以提供额外的参数。所以你的处理程序`functions.data_check`可以接受额外的参数，除了`self`：

```
def data_check(self, logbuffer):
    # ... 
```

然后，您可以[连接参数](http://developer.gnome.org/pygobject/stable/class-gobject.html#method-gobject--connect)：

```
item_dataCheck.connect("activate", functions.data_check, logbuffer) 
```

此外，该`self`参数通常用作方法定义中的第一个参数。这是一个非常强大的约定，因此您应该使用`obj`或类似的东西。特别是因为您的信号处理程序也可能是方法；在这种情况下，你可能会用它的论点把它搞砸。

# hadoop - MPI vs GPU vs Hadoop，这三种并行性之间的主要区别是什么？

> ID：10237443
> 
> 赞同：25
> 
> 时间：2012-04-19T21:58:36.700
> 
> 标签：hadoop, mpi, gpu

我知道一些机器学习算法，比如随机森林，本质上应该并行实现。我做了一个家庭作业，发现有这三种并行编程框架，所以我很想知道这三种并行性之间的主要区别是什么？

特别是，如果有人可以指点我一些研究比较它们之间的差异，那将是完美的！

请列出每种并行的优缺点，谢谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-04-20T08:17:04.767

1.  MPI 是并行性的消息传递范式。在这里，您有一台根计算机，它在其 MPI WORLD 中的所有计算机上生成程序。系统中的所有线程都是独立的，因此它们之间的唯一通信方式是通过网络消息。网络带宽和吞吐量是 MPI 实现性能的最关键因素之一。想法：如果每台机器只有一个线程，并且上面有很多内核，则可以使用 OpenMP 共享内存范例在一台机器上解决问题的子集。

2.  CUDA 是并行的 SMT 范式。它使用最先进的 GPU 架构来提供并行性。GPU 包含（（一组核心）块）以锁步方式处理相同的指令（这类似于 SIMD 模型）。因此，如果您系统中的所有线程都做很多相同的工作，您可以使用 CUDA。但是 GPU 中共享内存和全局内存的数量是有限的，因此您不应该只使用一个 GPU 来解决一个巨大的问题。

3.  Hadoop 用于使用 Map Reduce 范式解决商品硬件上的大问题。因此，您不必担心分发数据或管理极端情况。Hadoop 还提供了一个文件系统 HDFS，用于在计算节点上存储数据。

Hadoop、MPI 和 CUDA 彼此完全正交。因此，比较它们可能不公平。

不过，您始终可以使用 (CUDA + MPI) 来解决使用 GPU 集群的问题。您仍然需要一个简单的核心来执行问题的通信部分。

# sql-server-2008 - 添加子查询 - SQL Server 2008

> ID：10237445
> 
> 赞同：0
> 
> 时间：2012-04-19T21:58:46.793
> 
> 标签：sql-server-2008, tsql

我有以下 SQL 查询，但这不是我想要的：

```
SELECT 
    TOP (20) Attribs.ImageID AS ItemID 
FROM 
    Attribs 
LEFT OUTER JOIN 
    Items ON Attribs.ImageID = Items.ImageID 
WHERE
    (attribID IN ('a','b','c','d','e')) 
    AND (deleted NOT IN (1,2)) 
    AND Attribs.attribID = 'a' AND Attribs.attribID = 'b'
GROUP BY 
    Attribs.ImageID 
ORDER BY 
    COUNT(DISTINCT attribID) DESC 
```

我需要的是查询

```
 AND Attribs.attribID = 'a' AND Attribs.attribID = 'b' 
```

首先，然后是基于上述查询结果的 WHERE 子句的其余部分。

这可以使用子查询来实现吗？

我正在使用 SQL Server 2008

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:06:31.213

您想为性能问题这样做吗？因为拆分它不会改变结果。

无论如何，你可以这样做：

```
SELECT TOP (20) rn_Attribs.ImageID AS ItemID 
FROM (SELECT * 
      FROM Attribs
      WHERE Attribs.attribID = '123' AND Attribs.attribID = '456') rn_Attribs 
LEFT OUTER JOIN Items ON rn_Attribs.ImageID = Items.ImageID 
WHERE(attribID IN ('a','b','c')) 
    AND (deleted NOT IN (1,2)) 
GROUP BY rn_Attribs.ImageID 
ORDER BY COUNT(DISTINCT attribID) DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T04:46:41.483

我不完全明白为什么你想先做这个查询*，*然后再做另一个......但你可以使用公用表表达式（CTE） - 像这样：

```
;WITH FirstQuery AS
(
    SELECT a.ImageId
    FROM dbo.Attribs a
    WHERE a.attribID = 'a' AND a.attribID = 'b'
)
SELECT 
    TOP (20) a.ImageID AS ItemID 
FROM 
    dbo.Attribs a
INNER JOIN
    FirstQuery fq ON a.ImageId = fq.ImageId  
LEFT OUTER JOIN 
    dbo.Items i ON a.ImageID = i.ImageID 
WHERE
    (attribID IN ('a','b','c','d','e')) 
    AND (deleted NOT IN (1,2)) 
GROUP BY 
    a.ImageID 
ORDER BY 
    COUNT(DISTINCT attribID) DESC 
```

有了这个，您*首先*`ImageID`从CTE 中的表中选择`dbo.Attribs`，然后将该结果集与表的结果连接并连接到`Items`表。

# php - Magento 的 Cron 是否存在根本缺陷？

> ID：10237446
> 
> 赞同：5
> 
> 时间：2012-04-19T21:58:53.280
> 
> 标签：php, magento, cron, crontab, magento-1.5

我很难将 Cron 作业设置为每天在设定的时间运行一次。这是我的模块配置中的内容：

```
<crontab>
    <jobs>
        <sorting_flushcache>
            <schedule><cron_expr>0 16 * * *</cron_expr></schedule>
            <run><model>sorting/observer::flushProductCacheCron</model></run>
        </sorting_flushcache>
    </jobs>
</crontab> 
```

根据我对 cron 作业的了解，它应该根据我当地的时区在下午 5 点运行。但是，它永远不会起作用。如果我改为将**cron_expr**设置为`* 16 * * *`它会在整个小时内每分钟安排一次作业（如您所料）。

*我跟踪了代码，我认为我发现了问题，但我对 cron 调度以及它应该*如何工作的了解不够，所以我希望有人能帮助我了解哪里出了问题以及如何让我的工作正常工作。

**Mage_Cron_Model_Schedule**是野兽的大脑。当服务器的 crontab 调度调用**cron.php**脚本时，它会调度此类捕获并执行其工作的事件。除其他外，它会引入配置并尝试安排即将到来的 cron 作业。在`public function trySchedule($time)`它内部调用`matchCronExpression`，将相关的 cron 表达式连同与该 cron 表达式对应的当前时间的值一起传递给它。例如，它将**cron_expr**的第一部分（*分钟*部分）与当前时间戳的分钟进行比较。在`matchCronExpression`函数的末尾，它返回一个布尔值，如下所示：

```
return ($num>=$from) && ($num<=$to) && ($num%$mod===0); 
```

就我而言，我的**cron_expr**是`0 16 * * *`. *由于我的分钟*部分没有任何范围或`*/5`类型的内容，因此它将我设置的确切值与当前时间戳的确切值进行比较。这意味着只有在应该安排该作业的确切时间运行 cron 脚本时，它才会返回 true。

 *同样，我不是 cron 专家，但这对我来说似乎不对。那么，如果您无法预测 cron 调度程序运行脚本的确切时间，应该如何安排作业每天运行一次呢？我真的希望我错过了什么……有人可以帮忙吗？

**-- CRON 配置信息 --**

```
generate schedules every: 5
schedule ahead for: 10
missed if not run within: 20
success history lifetime: 60
failure history lifetime: 600 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T17:51:06.153

我可能已经找到了这个问题的“解决方案”，但我不确定这可能产生的影响。希望其他人可以加入确认或提供更好的答案。

我在 Magento 中更改了我的 Cron 配置，如下所示：

```
generate schedules every: 1
schedule ahead for: 5
missed if not run within: 20
history cleanup every: 30
success history lifetime: 60
failure history lifetime: 600 
```

这似乎成功了。它现在每分钟生成一次时间表，因此它不会错过安排我每天一次的活动的窗口。

对此有什么想法吗？我担心系统每分钟都生成 cron 计划太多了。它应该能够处理它，但我必须进行测试才能确认。

其他人有类似的经历吗？你是怎么解决的？*

# objective-c - 局部变量会导致 ARC 内存泄漏吗？

> ID：10237452
> 
> 赞同：4
> 
> 时间：2012-04-19T21:59:32.403
> 
> 标签：objective-c, automatic-ref-counting

在这 3 种情况下，我会有内存泄漏吗？

*   没有**__strong**并且没有设置为 nil

    ```
    - (void)function {
          NSString *string = [[NSString alloc] initWithString: @"Hello World"];
    } 
    ```

*   没有设置为 nil 但使用**__strong**

    ```
    - (void)function {
        __strong NSString *string = [[NSString alloc] initWithString: @"Hello World"];
    } 
    ```

*   没有**__strong**但设置为零

    ```
    - (void)function {
        NSString *string = [[NSString alloc] initWithString: @"Hello World"];
        string = nil;   
    } 
    ```

使用自动引用计数 (ARC)，如果我没有设置任何关键字，我假设变量是**__strong**？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T00:48:47.120

如果您不指定所有权限定符，则它是隐含的`__strong`. 然后，在声明变量的本地范围的末尾，编译器会插入一个释放，无论您是否将变量设置为 nil。

所以，你的局部变量在所有三种情况下都被释放了——没有泄漏。

# c# - MVC 3 将 jquery $.ajax 请求 json 反序列化为对象填充空值而不是空白字符串

> ID：10237453
> 
> 赞同：1
> 
> 时间：2012-04-19T21:59:32.573
> 
> 标签：c#, javascript, jquery, asp.net-mvc-3

我正在做这个 ajax 调用：

```
 $.ajax({
        url: "/test/whatever",
        type: 'post',
        contentType: 'application/json'
        data: {"fieldone":'test',"fieldtwo":'',"fieldthree":null,"fieldfour":'test'}
    }); 
```

在控制器中我有：

```
 [HttpPost]
    public string Whatever(MyModel object)
    {
        //fieldone, fieldtwo and fieldthree are all type string  
        //at this point:
        // object.fieldone contains the string 'test'
        // object.fieldtwo is NULL, but WHY?! and how can I have it correctly deserialize to blank string
        // object.fieldthree is correctly null, which is fine
        // I have no fieldfour in my object, so it is ignored, that makes sense.
        // object.newfield is correctly null, because I didn't pass a value for it in my JS
    } 
```

那么，有谁知道为什么在这种情况下空白字符串会变成空值？我发现这篇文章讨论了可空属性的 javascriptserializer 中的一个错误：

[http://juristr.com/blog/2012/02/aspnet-mvc3-doesnt-deserialize-nullable/](http://juristr.com/blog/2012/02/aspnet-mvc3-doesnt-deserialize-nullable/)

但我的情况比这更简单，我只想反序列化和包含描述性字段的对象，其中一些可能是空白字符串。

我需要区分空白字符串和空值，以便在我得到任何空值时抛出异常（当这种情况发生时，我的客户端 js 代码通常与 c# 对象不同步，我想知道它）。

那里有任何 MVC 专家可以为我阐明这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:11:35.600

我认为问题在于 ModelBinder 的默认行为是将空字段转换为模型（MyClass）中类型的默认值，因此在这些字段中发送空字符串将转换为

```
 ... = default(string); 
```

这会给你null。

要更改此行为，我认为您需要为该类创建自己的 ModelBinder 并将这些字段设置为空字符串（如果它们出现在请求中但它们是空的）

# ios - 使用 ARC 的内存问题真的很奇怪，NSArray 中第一个对象的对象/值突然为零？

> ID：10237459
> 
> 赞同：0
> 
> 时间：2012-04-19T22:00:15.773
> 
> 标签：ios, xcode, automatic-ref-counting

所以我有这个 NSArray，里面有 NSDictionaries。

正如您在代码中看到的那样，实际上有两个非常相等的 for 循环（不要介意为什么）。

如果你看到日志，第二个循环中第一个对象中的关键 scheduleID 突然为零......

我不知道这怎么可能。对象（NSDictionary）本身不是零。我正在使用 ARC。

```
UILocalNotification *mergedNotification = [notificationsWithEqualFireDates objectAtIndex:0];

    if ([notificationsWithEqualFireDates count] > 1) {
        NSMutableArray *mergedUserInfo = [[NSMutableArray alloc] init];
        for (UILocalNotification *ln in notificationsWithEqualFireDates) {
            NSLog(@"Hmmm... %@", [ln.userInfo objectForKey:@"scheduleID"]);
            [mergedUserInfo addObject:ln.userInfo];
        }
        NSDictionary *mergedUserInfoDictionary = [[NSDictionary alloc] initWithObjectsAndKeys:mergedUserInfo,@"array", nil];
        mergedNotification.userInfo = mergedUserInfoDictionary;
    }

    for (UILocalNotification *tempNotification in notificationsWithEqualFireDates) {
        NSManagedObject *managedObject = [NSEntityDescription insertNewObjectForEntityForName:@"RegisteredNotifications" inManagedObjectContext:newMoc];
        [managedObject setValue:tempNotification.fireDate forKey:@"fireDate"];
        [managedObject setValue:[tempNotification.userInfo objectForKey:@"dateTimeOriginal"] forKey:@"dateTimeOriginal"];
        [managedObject setValue:[tempNotification.userInfo objectForKey:@"scheduleID"] forKey:@"scheduleID"];
        NSLog(@"Saving schedule: %@", [tempNotification.userInfo objectForKey:@"scheduleID"]);
    } 
```

![在此处输入图像描述](../Images/a4f1629ec622edb164cc7e2b307713f0.png)

**更新** 我能够通过使用复制方法来解决这个问题：

```
UILocalNotification *mergedNotification = [[notificationsWithEqualFireDates objectAtIndex:0] copy]; 
```

有人可以解释为什么会发生这种情况以及为什么我需要这种复制方法。我认为将 NSArray 中的对象分配给变量将是创建一个内存位置，对其进行初始化，然后将值从数组中的位置复制到变量...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T00:32:57.203

正在发布通知WithEqualFireDates。尝试使用带有强引用的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:17:24.693

猜测：

打印`tempNotification.userInfo`。

它可能与您推入的任何东西相同`mergedUserInfoDictionary`；即您正在`userInfo`完全覆盖该代码中的。

不能肯定地说，因为你没有说明`mergedNotification`从哪里来。

* * *

> 你能解释一下这是怎么发生的吗？

您正在将数组的插槽 0 中`userInfo`的`NSNotification`实例替换为不再具有您正在查找的键的字典。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:20:04.290

我唯一能想到的是，notificationsWithEqualFireDates 不知何故超出了范围，它是一个 NSDictionary，对吗？是财产吗？我遇到了一个 NSString 变为 nil 的情况，它在方法内部的另一个类中被设置为弱属性，也许类似的东西？建议您调查一下和/或发布更多关于notificationWithEqualFireDates 来源的代码。另一种尝试是设置断点并在遍历上面的每一行时观察堆栈以查看它何时变为 nil ...

# knockout.js - 如何删除从 ajax 调用返回的 JSON 生成的 Knockout 映射数组的成员？

> ID：10237460
> 
> 赞同：4
> 
> 时间：2012-04-19T22:00:26.287
> 
> 标签：knockout.js, knockout-mapping-plugin

我正在使用 knockoutjs 和映射插件从服务器调用返回的 JSON 生成视图模型。我从服务器获取一个数组，创建一个将映射数组作为属性的模型，然后将该数组数据绑定到模板以在屏幕上呈现所有数据。效果很好。

我想在每个项目旁边呈现一个按钮，以便我将其删除，就像[本视频](http://channel9.msdn.com/Events/MIX/MIX11/FRM08)中的示例一样（见 14:20 左右）。

但在视频中，他绑定到在数组元素上定义的函数。我的元素是使用映射插件从 JSON 生成的，所以我不确定如何向每个元素添加函数，或者我什至是否想这样做。或者我可以让按钮的点击绑定到视图模型上的一个函数并传入与按钮关联的元素的 id？

我的JavaScript：

```
<script type="text/javascript">
    var supplierModel;

    $(function(){        
        getAllSuppliers();       
    })

    function getAllSuppliers(){
        $.getJSON('/SWM60Assignment/allsuppliers',function(responseData){
            supplierModel = new SupplierModel(responseData);
            ko.applyBindings(supplierModel);            
        });
    }
    var SupplierModel = function (supplierList) {
        var self = this;

        self.suppliers = ko.mapping.fromJS(supplierList);
        self.remove = function(supplierId){
            // how can I get the buttons to call this method with the id 
            // of the element they are the button for?
            alert('remove called with supplier id:'+supplierId);
        }
    };
</script> 
```

这是模板：

```
<script id="supplierTemplate" type="text/html">
    <li>
        Name: <span data-bind="text:name"></span> Address: <span data-bind="text:address"></span>
        <button data-bind="click:<what can I put here to bind correctly>>">Remove supplier</button>
    </li>
</script> 
```

和完整的HTML：

```
<ul class="vertical" data-bind="template:{name:'supplierTemplate',foreach:suppliers}"></ul> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-19T22:04:36.557

怎么样：

```
<button data-bind="click: $parent.remove">Remove supplier</button> 
```

[请参阅此处的](http://knockoutjs.com/documentation/click-binding.html)注 1

如果你使用`ko.mapping`它说“数组被转换成可观察的数组”。因此，您的`suppliers`属性将具有`ko`数组方法（ like `remove`）。

您可能还希望将实际值传递`supplier`给您的`remove`函数：

```
var SupplierModel = function (supplierList) {
    var self = this;

    self.suppliers = ko.mapping.fromJS(supplierList);
    self.remove = function(supplier){
        // observable array
        self.suppliers.remove( supplier ); 
    }
}; 
```

# backup - 备份执行配置

> ID：10237465
> 
> 赞同：0
> 
> 时间：2012-04-19T22:01:01.030
> 
> 标签：backup, backup-strategies

我想使用 Backup Exec 设置我认为是简单的备份过程。这就是我希望它的工作方式：

周二：

```
Run a full back up Tuesday morning with tape "A"
Tuesday during the day, swap out tape "A" with tape "B" 
```

周三：

```
Run a full back up Wednesday morning with tape "B"
Wednesday during the day, swap out tape "B" with tape "A" 
```

周四：

```
Run a full back up Thursday morning with tape "A"
Thursday during the day, swap out tape "A" with tape "B" 
```

星期五：

```
Run a full back up Friday morning with tape "B"
Friday during the day, swap out tape "B" with tape "A" 
```

如此一周又一周。

我遇到的问题是，一旦媒体容量用尽，我只想让媒体（磁带“A”和磁带“B”）覆盖最早的备份。看来我要做的就是选择一个接近媒体“应该”被最大化的时间。然后将AP设置为无限。

这是我在这里实现目标的最接近的方式吗？

谢谢大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:09:58.877

BackupExec 适用于附加期限和保护期限，所以是的，我认为您是正确的。它不能只覆盖磁带上“最旧”的备份集。

不要忘记这是一个实际的线性磁带，因此它不像硬盘驱动器那样具有随机访问。`Job1`因此，当它在磁带的开头开始用 覆盖时`Job9`，当它用完所有已使用的空间时会发生什么`Job1`，现在它正在覆盖`Job2`。

基本上，您要么在已使用区域的末尾附加到磁带，要么您正在喷射磁带并从开头开始。

# python - 使用python将数据插入MYSQL数据库

> ID：10237466
> 
> 赞同：1
> 
> 时间：2012-04-19T22:01:08.407
> 
> 标签：python

我正在尝试使用 python 脚本将数据插入 MYSQL 数据库，当我执行我的程序时，我在下一行收到错误“格式字符串的参数不足”。

```
_cursor.execute("INSERT INTO `md_patentinfo` (patentno, filed) 
       VALUES ('%s',STR_TO_DATE('%s','%M %d,%Y'))" %(patent_number,issue_date)) 
```

**上一行的更多信息：** 在上一行中，我将插入`patent number`到`Issue date`我的表中，并且我正在使用将格式`STR_TO_DATE`的日期值转换为.`%B %d,%Y``%M,%d,%Y`

请帮帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:07:08.860

您需要转义 %M、%d 和 %Y，如下所示：

```
"INSERT INTO md_patentinfo (patentno, filed) VALUES ('%s',STR_TO_DATE('%s','%%M %%d,%%Y'))" % ('123','Apr 14,2012') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:12:16.943

您的格式字符串有五个参数（每个 '%something' 都是一个参数）。您可能想转义 %M, %d%Y 部分：

```
"INSERT INTO md_patentinfo (patentno, filed) VALUES ('%s',STR_TO_DATE('%s','%%M %%d,%%Y'))" % (patent_number,issue_date) 
```

# javascript - please explain this requestAnimationFrame idiom

> ID：10237471
> 
> 赞同：3
> 
> 时间：2012-04-19T22:01:53.313
> 
> 标签：javascript, html

there are a lot of places (e.g. [How to use requestAnimationFrame?](https://stackoverflow.com/questions/5605588/how-to-use-requestanimationframe)) that fix `window.requestAnimationFrame` as below. I do not understand why the right hand side of the assignment is wrapped in to a function call.

```
`window.requestAnimFrame = (function(){
    return window.requestAnimationFrame ||
    window.webkitRequestAnimationFrame ||
    window.mozRequestAnimationFrame ||
    window.oRequestAnimationFrame ||
    window.msRequestAnimationFrame ||
    function(callback){
        window.setTimeout(callback, 1000 / 60);
    };
})();` 
```

* * *

 `## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:06:13.230

I've wondered the same thing before. I'm pretty sure Google just really likes closures. Granted there is not one variable in there, it's a 'safe' thing to do.

As far as I can tell, this is the exact same thing, without any change of interfering with namespaces (a general reason to use a closure like that):

```
window.requestAnimFrame = 
    window.requestAnimationFrame ||
    window.webkitRequestAnimationFrame ||
    window.mozRequestAnimationFrame ||
    window.oRequestAnimationFrame ||
    window.msRequestAnimationFrame ||
    function(callback){
        window.setTimeout(callback, 1000 / 60);
    }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T10:03:10.720

In the OP example, putting the code into the closure does nothing (at least what I am aware of :-)

Look here [http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating](http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating) for a similar function doing the same thing with a local variable. In this case, the variable would end up globally if it weren't inside the closure.

So there are two things involved:

*   a function to embed variables so they don't become global
*   executing this function immediately to run the code.

Here [Immediate functions JavaScript](https://stackoverflow.com/questions/13364312/immediate-functions-javascript) is another discussion about these **immediate functions**.

All the best, nobi

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-19T22:09:26.193

`requestAnimationFrame` takes one argument: the function to run. However `setTimeout` takes the function to run as well as a delay after which to run it. So while you can just assign the individual functions directly, you have to create a closure for `setTimeout` so that you can assign the second argument.

It's basically a form of [currying](http://en.wikipedia.org/wiki/Currying).`

# json - 如何反转一个json文件？

> ID：10237472
> 
> 赞同：4
> 
> 时间：2012-04-19T22:01:56.630
> 
> 标签：json

我想反转一个 JSON 文件（使用 php、python、java 或其他解决方案 :)）

从 ：

```
{
 "name 1" : "value 1",
 "name 2" : "value 2"
} 
```

到 ：

```
{
 "value 1" : "name 1",
 "value 2" : "name 2"
} 
```

想法？:)

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:05:54.027

试试这个：

```
<?php

$str=<<<EOT
{
 "name 1" : "value 1",
 "name 2" : "value 2"
}
EOT;

echo json_encode(array_flip(json_decode($str,true)));

?> 
```

* * *

输出：`{"value 1":"name 1","value 2":"name 2"}`

# ruby - Ruby 中具有前瞻功能的正则表达式

> ID：10237474
> 
> 赞同：2
> 
> 时间：2012-04-19T22:02:04.320
> 
> 标签：ruby, regex, ruby-1.9.2, regex-lookarounds

我目前的正则表达式战斗是替换字符串中数字之前的所有逗号。然后，正则表达式必须忽略所有以下逗号。我已经在 rubular 上搞砸了大约一个小时，但似乎无法让某些东西发挥作用。

测试字符串...

```
'this is, a , sentence33 Here, is another.' 
```

所需的输出...

```
'this is comma a comma sentence33 Here, is another.' 
```

所以类似的东西......

```
testString.gsub(/\,*\d\d/,"comma") 
```

为了给你一些背景知识，我正在做一个小项目。我收集的元素主要以逗号分隔，以两位数的年龄开头。然而，有时在年龄之前的标题可能包含逗号。为了保留我稍后设置的结构，我需要替换标题中的逗号。

在尝试堆栈溢出的答案之后......

我仍然有一些问题。不要笑，但这是导致问题的屏幕抓取的实际线......

```
statsString =     "              23,  5'9\",  140lb,  29w,                        Slim,                 Brown       Hair,             Shaved Body,              White,    Looking for       Friendship,    1-on-1 Sex,    Relationship.   Out      Yes,SmokeNo,DrinkNo,DrugsNo,ZodiacCancer.      Versatile,                  7.5\"                    Cut, Safe Sex Only,     HIV      Negative, Prefer meeting at:Public Place.                   PerformerContact  xxxxxx87                                                   This user has TURNED OFF his IM                                     Send Smile      Write xxxxxx87 a message:" 
```

首先，我在所有这些片段中添加“xx，”，以便我的逗号过滤适用于所有情况，无论是否有文本。其次是实际修复。输出如下...

```
statsString = 'xx, ' + statsString

statsString = statsString.gsub(/\,(?=.*\d)/, 'comma');

 => "xxcomma               23comma  5'9\"comma  140lbcomma  29wcomma                        Slimcomma                 Brown       Haircomma             Shaved Bodycomma              Whitecomma    Looking for       Friendshipcomma    1-on-1 Sexcomma    Relationship.   Out      YescommaSmokeNocommaDrinkNocommaDrugsNocommaZodiacCancer.      Versatilecomma                  7.5\"                    Cutcomma Safe Sex Onlycomma     HIV      Negativecomma Prefer meeting at:Public Place.                   PerformerContact  xxxxx87                                                   This user has TURNED OFF his IM                                     Send Smile      Write xxxxxxx87 a message:" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:30:05.280

***代码：***

```
testString = 'this is, a , sentence33 Here, is another.';
result = testString.gsub(/\,(?=.*\d)/, 'comma');
print result; 
```

***输出：***

`this iscomma a comma sentence33 Here, is another.`

***测试：***

[http://ideone.com/9nt1b](http://ideone.com/9nt1b)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:25:08.150

不是那么短，但是，似乎可以解决您的任务：

```
str = 'this is, a , sentence33 Here, is another.'

str = str.match(/(.*)(\d+.*)/) do

    before = $1
    tail = $2

    before.gsub( /,/, 'comma' ) + tail
end

print str 
```

# ruby - Ruby：如何将多线程整合到这个网络抓取场景中？

> ID：10237477
> 
> 赞同：1
> 
> 时间：2012-04-19T22:02:33.420
> 
> 标签：ruby, multithreading, http, parsing, web-scraping

我有一个包含大量文本文件的文件夹列表。这些文件里面是链接。

使用这些链接中的每一个，我将需要获取一个网页，对其进行解析，并根据其中的内容 - 将 JPG 文件保存到与包含提供链接的文本文件的文件夹名称相对应的文件夹中。

现在要注意的是，其中有很多文本文件，甚至还有更多链接。我在想多线程连接和解析网页的过程可能不是一个坏主意。

所以我会有这样的事情：

```
directories.each do |directory|

 ... 

 all_files_in_directory.each do |file|

  ...

  all_urls_in_file do |url|

   # check if there's any threads that aren't busy
   # make a thread go out to the url and parse it

  end

 end

end 
```

如果可能的话，我有点不确定如何做到这一点 - 我似乎无法找到一种方法让线程只是挂出，直到我告诉他们 some_method() 执行。就好像一个线程所做的事情是在创建时分配给它的，并且无法更改。

所以基本上我希望脚本能够连接和解析，比如说，5个批次而不是1个批次。

这可行吗？如果可行，你将如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:25:25.313

通常，此类活动是通过将“任务”对象排队到正在等待生产者-消费者“池队列”的线程池来执行的。每个线程永远循环，将任务从队列中拉出并调用任务的虚拟“运行”方法。通常，如果他们愿意，任务可以创建更多任务并将它们提交到池队列。

不同的“任务”类后代可以有一个 run() 方法来做不同的事情，因此，即使线程确实“在做创建时分配给它的事情”——这意味着挂在队列上，然后，当任务可用，在不同的任务中调用不同的覆盖方法。

流量控制，对。制作一个可以保存“批量大小”url的batchURL'任务类。在开始时，创建.. 说.. 100 个并将它们推送到“objectQueue”（一个生产者-消费者队列类，如池队列）。在您的 readline 循环中，弹出一个 batchURL，使用 url 加载它并将其提交到池队列。当池线程处理完一个 batchURL 后，将其推回 objectQueue 以供重用。这对未完成的批处理 URL 设置了上限 - 如果 readLine 尝试将太多的批处理 URL 排队，它会发现 objectQueue 为空，因此会阻塞，直到池回收一些批处理 URL。

如果您使用合理数量的 batchSIze、batchURL 和线程，batchURL 应该会愉快地在 objectQueue/workThead/poolQ​​ueue 循环中循环，以高效且有效的方式将数据从 readLine 传送到工作线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T01:42:01.867

对于并发 http 请求，您应该考虑 eventmachine 和[em-http-request 。](https://github.com/igrigorik/em-http-request)

# arrays - 在 Free Pascal 中处理对象数组

> ID：10237480
> 
> 赞同：3
> 
> 时间：2012-04-19T22:02:42.470
> 
> 标签：arrays, multidimensional-array, dispose, freepascal

我想创建一个二维`TMyClass`对象数组，考虑到这些对象中的每一个都包含一个引用数组`TMyClass`，即

```
type
    TMyClass = class
        MyArray: array[0..10] of TMyClass;
        constructor Create;
        destructor Destroy;
    end;

    TMyMatrix = array of array of TMyClass;

var
    matrix: TMyMatrix;

begin
    SetLength(matrix, 10, 10);
    (...) { matrix[i, j].Create; ? } 
```

1) 引用数组 ( `MyArray`) 会在处理对象时自动处理（不影响实际对象）`TMyClass`，还是应该手动处理？

2) 如何处理对象的动态数组 ( `matrix`)？Free Pascal wiki 说分配`nil`给动态数组会释放指针指向的内存，但我认为它不会调用任何析构函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T06:07:39.603

1) 是的，如果您释放 TMyClass 实例，则 MyArray 将被释放，因为它的引用计数将降至零。一个例外情况是，如果您在代码的其他地方全局引用此数组，那么良好的代码设计不应该出现这种情况。数组中的实际对象不会被自动释放（继续阅读）。

2) 不，将数组大小调整为零、将其设置为 null 或使其引用计数为零**不会**自动释放您在其元素中引用的任何类。您需要自己完成，通过遍历 2D 数组并正确释放每个对象。

从文档中，“将 nil 分配给动态数组变量会自动释放指针指向的内存。”。这就是它所做的一切，所以它实际上不会触及你的类，只会释放分配给存储它们的引用（它们是指针）的内存。

参考。[http://wiki.freepascal.org/DYNAMIC_ARRAY](http://wiki.freepascal.org/DYNAMIC_ARRAY)

# c++ - 显示 QT 上下文菜单时没有 keyReleaseEvent

> ID：10237482
> 
> 赞同：1
> 
> 时间：2012-04-19T22:03:12.233
> 
> 标签：c++, qt, user-interface

我正在使用 QT4，并创建了一个 QGLWidget，我想在其中实现右键单击上下文菜单。我希望上下文菜单仅在单击鼠标右键并按下 CTRL 键时出现。

我尝试通过在按下 CTRL 键时设置一个控制标志来实现这一点，然后在释放 CTRL 键时清除它（通过 a `keyReleaseEvent`）。问题是当上下文菜单启动时我没有收到a `keyReleaseEvent`（不仅仅是CTRL，根本没有按键释放）。

例如：我按住CTRL，单击鼠标右键，然后出现上下文菜单（仍然按住CTRL）。在没有选择菜单中的任何内容的情况下，我释放了 CTRL 键，但我的程序没有收到`keyPressEvent`. 因此我的标志永远不会被清除，并且下次用户右键单击（即使没有控制）时，上下文菜单也会出现。

`keyPressEvent`当上下文菜单存在时，为什么我没有收到？

我正在使用 QT 4.8 (C++) 并在 Windows 和 Linux 上进行了测试，结果相同。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T23:25:42.193

我认为处理这种情况的最佳方法是检查打开上下文菜单时是否按住了 CTRL。这样您就可以避免这些问题，并且不必跟踪该标志。试试这个：

```
void DerivedClass::mousePressEvent(QMouseEvent *event)
{
    if (event->button() == Qt::RightButton && event->modifiers().testFlag(Qt::ControlModifier))
    {
        // Open the context menu.
    }
    else
    {
        BaseClass::mousePressEvent(event);
    }
} 
```

编辑：那是 Qt::ControlModifier，而不是 Qt::CtrlModifier。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T23:49:08.700

对于为什么部分，Qt 将键事件发送到具有键盘焦点或显式抓取键盘（使用`QWidget::grabKeyBoard()`）的小部件，因为上下文菜单是您释放键时的小部件，它会接收键释放事件。

# php - 将一个表的值附加到另一个表的列键中

> ID：10237485
> 
> 赞同：1
> 
> 时间：2012-04-19T22:03:46.083
> 
> 标签：php, mysql, codeigniter

我有 1 个表，其中有用户，如下所示：

```
id  name    email       status
---------------------------------
1   Jane    j@ne.do     active
2   Jack    j@ck.do     active
3   Jane    j@ne.do     inactive
4   Jack    j@ck.do     inactive 
```

我也有这样的数据表：

```
id  user_id key         value
------------------------------
1   1       firts_name  Jane
2   1       last_name   Do
3   2       city        Amsterdam
4   2       first_name  Jack 
```

现在我想在一个查询中让它们像这样：

```
id  name    email       status      firts_name  last_name   city
-------------------------------------------------------------------------
1   Jane    j@ne.do     active      Jane        Do          NULL
2   Jack    j@ck.do     active      Jack        NULL        Amsterdam
3   Jane    j@ne.do     inactive    NULL        NULL        NULL
4   Jack    j@ck.do     inactive    NULL        NULL        NULL 
```

这甚至可能在一个查询中吗？

Normaly 我做 2 个查询，然后在 php 中组合 2 个，但我很好奇这是否可能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:13:22.753

这可以通过加入表和使用`CASE`语句很容易地完成：

```
select
    u.id,
    u.name,
    u.email,
    u.status,
    max(case when a.`key`='first_name' then a.value end) as first_name,
    max(case when a.`key`='last_name' then a.value end) as last_name,
    max(case when a.`key`='city' then a.value end) as city
from
    users u
left join
    attr a on a.user_id = u.id
group by
    u.id 
```

演示：[http ://www.sqlfiddle.com/#!2/66086/4](http://www.sqlfiddle.com/#!2/66086/4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:06:15.883

您需要使用准备好的语句：

[http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-prepared-statements.html](http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-prepared-statements.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:11:48.913

虽然不理想，但相关的子查询会起作用。就像是：

```
SELECT
    `id`,
    `name`,
    `status`,
    (SELECT `value` FROM `table2` WHERE `user_id`=`table1`.`id` AND `key`='first_name') AS first_name,
    (SELECT `value` FROM `table2` WHERE `user_id`=`table1`.`id` AND `key`='last_name') AS last_name
FROM `table1` 
```

但是，我觉得有一种更好的方法来做你正在寻找的事情。

# c# - CodeDomSerializer 输出排序

> ID：10237489
> 
> 赞同：4
> 
> 时间：2012-04-19T22:04:04.573
> 
> 标签：c#, custom-controls, designer

我创建了一个组件来为我们的项目做一些本地化工作。我遇到的问题是我输出的注入 InitializeComponent 的代码发生得太晚了。

例子

```
this.components = new System.ComponentModel.Container();
System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(ucHome));
this.localizationResourceManager1 = new Compass0.Localization.LocalizationResourceManager(this.components);
//Other designer code to create controls (this is all in the first block of code in InitializeComponent 
Compass0.Localization.XMLResourceManager.Create(typeof(ucViewHome), ref resources);  //created by my code serializier
//
// btnLogin
// 
```

等等等等

但是设计师正在发生的事情是

```
this.components = new System.ComponentModel.Container();
System.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(ucHome));
this.btnLogin = new ComponentFactory.Krypton.Toolkit.KryptonButton();
this.localizationResourceManager1 = new Compass0.Localization.LocalizationResourceManager(this.components);
//Other designer code to create controls (this is all in the first block of code in InitializeComponent 
//
// btnLogin
//
this. btnLogin.Name = "btnLogin"; 
this. btnLogin.Text = resources.GetString("btnLogin.Text");
Compass0.Localization.XMLResourceManager.Create(typeof(ucViewHome), ref resources);  //created by my code serializier 
```

我基本上需要在资源初始化后强制设计人员将我的代码放在第 3 行。有没有办法让我以直接的方式做到这一点？我的代码生成类如下。

```
public override object Deserialize( IDesignerSerializationManager manager, object codeDomObject )
    {
        CodeDomSerializer baseSerializer = ( CodeDomSerializer )manager.GetSerializer( typeof( LocalizationResourceManager ).BaseType, typeof( CodeDomSerializer ) );

        return baseSerializer.Deserialize( manager, codeDomObject );
    }

    public override object Serialize( IDesignerSerializationManager manager, object value )
    {
        CodeDomSerializer baseSerializer = ( CodeDomSerializer )manager.GetSerializer( typeof( LocalizationResourceManager ).
            BaseType, typeof( CodeDomSerializer ) );

        object codeObject = baseSerializer.Serialize( manager, value );

        if ( codeObject is CodeStatementCollection )
        {
            CodeStatementCollection statements = ( CodeStatementCollection )codeObject;

            CodeTypeDeclaration classTypeDeclaration = ( CodeTypeDeclaration )manager.GetService(typeof( CodeTypeDeclaration ) );

            CodeExpression typeofExpression = new CodeTypeOfExpression( classTypeDeclaration.Name );

            CodeDirectionExpression resourceRef = new CodeDirectionExpression( FieldDirection.Ref, new CodeVariableReferenceExpression( "resources" ) );

            CodeExpression ResourceManagerAssignment = new CodeMethodInvokeExpression(
                new CodeTypeReferenceExpression( typeof(XMLResourceManager).ToString() ),
                "Create", new CodeExpression[] { typeofExpression, resourceRef } );

            statements.Insert( 0, new CodeExpressionStatement( ResourceManagerAssignment ) );               
        }

        return codeObject;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-11T20:58:04.027

我知道这真的很晚了，但对于任何偶然发现这个问题的人......

我正在做完全相同的事情，为了解决这个问题，我只是确保首先创建/序列化我的本地化控件，方法是创建一个从 ComponentDesigner 继承的类，该类具有获取控件列表、删除自身并重新添加自身的 Initialize 方法在列表的顶部。然后，我将 Designer 属性添加到我的自定义组件中。

它在 VB 中，如果有人需要将其翻译成 C#，请告诉我...

```
<Designer(GetType(LocalizerDesigner))>
<DesignerSerializer(GetType(LocalizerSerializer), GetType(CodeDomSerializer))>
Public Class Localizer
    Inherits Component

    Public Sub GetResourceManager(type As Type, ByRef manager As ComponentResourceManager)
        ' Replace resource manager w/ new one.
    End Sub

End Class

Public Class LocalizerSerializer
    Inherits CodeDomSerializer

    Public Overrides Function Deserialize(manager As IDesignerSerializationManager, codeObject As Object) As Object
        Dim baseSerializer As CodeDomSerializer = DirectCast(manager.GetSerializer(GetType(Component), GetType(CodeDomSerializer)), CodeDomSerializer)
        Return baseSerializer.Deserialize(manager, codeObject)
    End Function

    Public Overrides Function Serialize(manager As IDesignerSerializationManager, value As Object) As Object
        Dim baseSerializer As CodeDomSerializer = DirectCast(manager.GetSerializer(GetType(Component), GetType(CodeDomSerializer)), CodeDomSerializer)

        Dim codeObject As Object = baseSerializer.Serialize(manager, value)

        Dim statementCollection As CodeStatementCollection = TryCast(codeObject, CodeStatementCollection)

        If statementCollection IsNot Nothing Then
            Dim formClassTypeDeclaration As CodeTypeDeclaration = DirectCast(manager.GetService(GetType(CodeTypeDeclaration)), CodeTypeDeclaration)
            Dim typeofFormExpression As New CodeTypeOfExpression(formClassTypeDeclaration.Name)

            Dim outResourcesExpression As New CodeDirectionExpression(FieldDirection.Out, New CodeVariableReferenceExpression("resources"))
            Dim getResourceManagerExpression As New CodeMethodInvokeExpression(MyBase.SerializeToExpression(manager, value), "GetResourceManager",
                                                                     {typeofFormExpression, outResourcesExpression})

            statementCollection.Add(New CodeExpressionStatement(getResourceManagerExpression))
        End If
        Return codeObject
    End Function
End Class

Public Class LocalizerDesigner
    Inherits ComponentDesigner

    Public Overrides Sub Initialize(component As IComponent)
        MyBase.Initialize(component)
        Dim designerHost As IDesignerHost = TryCast(GetService(GetType(IDesignerHost)), IDesignerHost)
        If designerHost Is Nothing Then
            Return
        End If

        Dim innerListProperty As Reflection.PropertyInfo = designerHost.Container.Components.GetType().GetProperty("InnerList", System.Reflection.BindingFlags.Instance Or System.Reflection.BindingFlags.NonPublic Or System.Reflection.BindingFlags.FlattenHierarchy)
        Dim innerList As ArrayList = TryCast(innerListProperty.GetValue(designerHost.Container.Components, Nothing), ArrayList)

        If innerList Is Nothing OrElse innerList.IndexOf(component) <= 1 Then
            Return
        End If

        innerList.Remove(component)
        innerList.Insert(0, component)
    End Sub
End Class 
```

# forms - 使用 form/form-grid.js 下的 EXTJS4 示例 - 如何在提交表单后重新加载网格

> ID：10237496
> 
> 赞同：2
> 
> 时间：2012-04-19T22:05:08.780
> 
> 标签：forms, grid, extjs4, store

我正在使用 EXTJS 4.0.7 gpl。我正在使用 form/form-grid.js 下的示例。在编辑表单中显示的条目后，我想在示例中重新加载网格。

我正在使用 PHP Web 服务将数据加载到表单网格中。我设置了一个处理程序来处理表单条目，在进行编辑时，并更新网格中的值。它工作正常并更新数据库。成功后，我使用以下函数调用为商店调用重新加载，并看到 JSON 在重新加载时返回（在 FireBug 中），但数据未加载到网格中。如何获取从存储加载返回的数据以填充到网格并更新。

我最终想使用 MVC，但现在我希望能够在 form.submit 成功时重新加载 form-grid 中的网格。

我的商店中有一个“tvdStore”的“storeId”，我使用以下方法重新加载了商店：

```
{
    xtype: 'button',
    text: 'Save',
    style: 'margin: 0 5px 0 5px',
        handler: function (button) {

        // when this button is clicked, sumbit this form
        var form = this.up('form').getForm();

        var rating = form.findField("rating").getValue();
        var formTargetId = form.findField("ID").getValue();
        var formFamilyName = form.findField("FAMILYNAME").getValue();
        var formTargetName = form.findField("TARGETNAME").getValue();
        var formTableName = form.findField("TABLENAME").getValue();

        // convert the int value back to a string
        var stringVal = "";
        if (rating === true) {
            stringVal = 'Yes';
        } else if (rating === false) {
            stringVal = 'No';
        }

        form.submit({
            waitMsg: 'Saving...',       // Wait Message
            method: 'POST',
            params: { 'targetValue' : stringVal , 'targetId' : formTargetId , 'tableName' : targetName },
            url: 'app/model/target/GG/add-update_svc.php',
            success: function (form, action) { // When saving data success
                Ext.Msg.alert('Success', action.result.message);    

                // clear the form
                form.reset();

                // reload store
                Ext.data.StoreManager.lookup('tvdStore').load(
                    {
                        params: {
                            tableName: formTableName,
                            targetName: targetName,
                            familyName: formFamilyName
                        }
                    }
                );

            },
            failure: function (form, action) {      // when saving data failed
                Ext.MessageBox.alert ('Message','Saving data failed');
            }
        });
    }
} 
```

我看到 JSON 在 FireBug 中返回，应该加载到网格中，所以商店正在重新加载，但我没有看到 loadMask，并且网格本身永远不会更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:38:41.300

实际上，您绝对没有也不应该在任何更新/删除/插入过程之后重新加载整个商店。Store 类有一个逻辑，它在从服务器接收到结果消息后更新记录的本地副本。因此，您可能希望确保您的服务器返回正确的消息并更新本地副本。

网格也应该自动重绘更新的记录。

# php - 你可以使用 HipHop PHP 来构建一个 php 扩展吗？

> ID：10237505
> 
> 赞同：5
> 
> 时间：2012-04-19T22:06:01.810
> 
> 标签：php, compilation, hiphop

> **可能重复：**
> [使用 Hiphop 进行 PHP 扩展开发](https://stackoverflow.com/questions/7646276/using-hiphop-for-php-extension-development)

本题类似如下：[Using Hiphop for PHP extension development](https://stackoverflow.com/questions/7646276/using-hiphop-for-php-extension-development)

我认为这个问题没有得到正确回答，如果有的话。

我相信您可以使用 HipHop PHP 将 php 文件转换为 C++，而无需添加 facebooks 网络服务器。因此，您只需将 php 文件转换为 C++ 源代码即可。然后您可以将该代码编译为 php 扩展吗？我有一些与安全相关的功能，我想编译为扩展，但我不知道 C/C++。请不要回答“你和 facebook 一样大吗？你不需要 hiphop”或“使用 Ioncube/Zend Guard”。我知道这些产品存在。它们也很贵。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:29:38.043

我在去年的一次会议上向 Scott MacVicar 询问了这个主题（我想构建一些我自己的库作为扩展），并得到回应说 HipHop 不能用于构建可以针对“标准”Zend PHP 构建的扩展.

这就是为什么我一直在寻找替代方案，例如[phc](http://www.phpcompiler.org/)，它可以将 PHP 脚本转换为 PHP 的 C 语言扩展（以及从 PHP 源构建可执行文件）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:07:48.250

它被编译为 C++，如果你使用大头钉`./hphp/hphp text.php --keep-tempdir=1`，你可以保留 C++ 代码以及编译后的代码

您可以潜在地使用 HipHop PHP 将您的 PHP 文件转换为 C++，并且可以构建扩展。

来自 HipHop 网站的报价

> 导致 HipHop 的明确设计目标之一是能够继续直接在 PHP 中编写复杂的逻辑。拥有大型 PHP 代码库的公司通常会将其复杂的功能直接重写为C 或 C++ 中的**PHP 扩展。**这样做最终会减少能够处理公司整个代码库的人数。通过将这种逻辑保留在 PHP 中，Facebook 能够快速行动并维持大量能够跨整个代码库工作的工程师。

# android - 创建不同的颜色穿透

> ID：10237509
> 
> 赞同：2
> 
> 时间：2012-04-19T22:06:29.910
> 
> 标签：android, colors, styles, textview, strikethrough

我正在尝试创建文本视图，文本颜色为黑色，删除线为红色，我尝试使用 html 但似乎不起作用

```
String styledText = "<span style='color:red;text-decoration:line-through'><span style='color:black'>TEXT</span></span>";    
myText.setText(Html.fromHtml(styledText)); 
```

我也尝试了以下方法，但不知道如何为删除线定义不同的颜色

```
myText.setPaintFlags(myText.getPaintFlags() | Paint.STRIKE_THRU_TEXT_FLAG); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:11:33.767

如果您想删除中的所有文本，`TextView`您可以简单地创建一个子类，`TextView`在其中使用您选择的颜色绘制删除线。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-12T11:12:16.580

```
@Override
protected void onDraw(Canvas canvas) {

    super.onDraw(canvas);
    drawStrikeThroughPaint(canvas);
}

public void drawStrikeThroughPaint(Canvas canvas) {
    canvas.drawLine(0, getMeasuredHeight() / 2, getMeasuredWidth(), getMeasuredHeight() / 2, strikethroughPaint);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-19T09:23:44.513

迟到了，但使用图层列表并将其放在 textview 背景的顶部。完美运行。让我演示给你看。

在drawables文件夹中创建一个名为strikethru.xml的文件：

```
 <?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <shape android:shape="rectangle">
            <solid android:color="#FFFFFF"/>
        </shape>
    </item>
    <item>
        <shape android:shape="line">
            <stroke android:width="1dp"
                android:color="#8d8d8d"/> <!-- adjust color you want here -->
        </shape>
    </item>
</layer-list> 
```

然后在你的文本视图中这样做：

```
 <TextView
                                android:id="@+id/tv_toolbar_prod_price"
                                android:layout_width="wrap_content"
                                android:layout_height="wrap_content"

                                android:paddingRight="3dp"
                                android:text="1,290 B"      

android:background="@drawable/strikethru_line"
                                android:textColor="#070707"
                                android:textSize="13sp" /> 
```

3dp 的填充权使删除线更多地从文本中出来，以提供真实世界的效果。

# flume - Flume 使用 tail 从同一个地方继续

> ID：10237511
> 
> 赞同：1
> 
> 时间：2012-04-19T22:06:33.513
> 
> 标签：flume

最近我们多次尝试使用flume。主要是将数据从我们的前端服务器流式传输到后端服务器以进行处理。它是通过编写本地“日志”文件并使用水槽尾巴来完成的。问题是重新启动水槽节点后，目录中的所有文件都被重新发送。有没有办法有效地管理这个？水槽可以给出一些它完成处理文件的事件吗？它有内置的检查点吗？

如果不是，那么做这样的事情的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T15:01:23.587

每次重新启动水槽节点时，tailsource 将从它拖尾的文件的开头开始。Flume 还没有开箱即用地解决这个问题。您将不得不自己实施一种状态管理。

只是给你一个快速的想法，你可以运行另一个线程，基本上听字节 tailsource 一直在跟踪文件并将 bytes_read 保存在某个地方。如果水槽代理崩溃或重新启动，您只需从保存它的位置读取 bytes_read（例如 tmp 文件夹中的文件）。但是您需要以某种方式包装 tailsource 构造函数。当您等待水槽本身的修复时，它以令人讨厌的方式解决了问题:(

# android - 提供需要从其他地方购买的激活码的免费应用程序

> ID：10237512
> 
> 赞同：1
> 
> 时间：2012-04-19T22:06:37.613
> 
> 标签：android, ios

我有一个关于我们正在尝试设计的构建的问题。

我们有一个我们想提供的应用程序，它可以从我们合作伙伴网站上的用户帐户中提取用户内容。

用户选择他们想在应用程序中使用的图像并从合作伙伴的网站购买。

我们创建应用程序，然后等待用户输入访问代码以确保安全，因为该应用程序是根据个人信息/图像创建的。

然后，客户将前往应用商店并下载免费应用。当应用程序要求他们输入在我们的合作伙伴网站上购买的激活码时，我们会将内容推送给他们。

这可以通过苹果商店工作吗？内容是我们的合作伙伴，应用程序是免费的，他们的内容通过访问代码访问并推送到应用程序。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:21:48.803

苹果会拒绝你。您必须使用应用内购买来购买激活码。在这种情况下，您不妨将其设为付费应用。（事实上​​，他们可能会拒绝需要应用内购买才能执行任何操作的免费应用。）

# php - 如何防止用户向其他用户发表评论

> ID：10237518
> 
> 赞同：0
> 
> 时间：2012-04-19T22:07:17.787
> 
> 标签：php, sql, restriction

假设我有一个用户可以互相发表评论的网站。

我们有用户 A、用户 B 和用户 C。另外，支持用户 B 已阻止用户 C。

用户A给用户B留言，代码如下：

```
$query = "insert into comments (author_id, profile_id, comment, date_posted) values(?, ?, ?, now())"; 
```

那就是完成这项工作的查询。现在用户C去用户B的页面发表评论，但是用户B已经阻止他发表评论。

用户 C 不能只为另一个用户发表评论，然后制作请求，以便他将 profile_id 更改为阻止他的用户吗？

我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:15:02.280

我认为您需要对该结果进行另一个查询和条件。创建查询以获取用户 B 的黑名单`$blacklist`，然后检查`if (!in_array('user C', $blacklist)) { execute insert query }`

# xslt - XSLT 列表转换

> ID：10237520
> 
> 赞同：1
> 
> 时间：2012-04-19T22:07:24.290
> 
> 标签：xslt, xslt-2.0

我目前正在研究将以下 xml 转换为有序列表的 XSL 脚本。请参考下面的输入和输出示例。顺便说一句，我正在使用 XSLT 2.0。

```
**Input:**
<xml>
    <numberedList>1\. Number List 1</numberedList>
    <unnumberedList>Child List 1</unnumberedList>
    <unnumberedList>Child List 2</unnumberedList>
    <unnumberedList>Child List 3</unnumberedList>
    <numberedList>2\. Number List 2</numberedList>
    <unnumberedList>Child List 1</unnumberedList>
    <numberedList>3\. Number List 3</numberedList>
</xml>

**Output:**
<html>
<ol>
    <li>1\. Number List 1</li>
    <li>
        <ul>
            <li>Child List 1</li>
            <li>Child List 2</li>
            <li>Child List 3</li>
        </ul>
    </li>
    <li>2\. Number List 2</li>
    <li>
        <ul>
            <li>Child List 1</li>
        </ul>
    </li>
    <li>3\. Number List 3</li>
</ol>
</html> 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T07:54:42.963

尝试改进 Dimitre 的 XSLT 2.0 解决方案：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <html>
   <ol>
     <xsl:for-each-group select="*" group-adjacent="name()">
       <xsl:choose>
         <xsl:when test="self::numberedList">
           <xsl:apply-templates select="current-group()"/>
         </xsl:when>
         <xsl:otherwise>
           <li><ul><xsl:apply-templates select="current-group()"/></ul></li>
         </xsl:otherwise>
       </xsl:choose>
     </xsl:for-each-group>
   </ol>
  </html>
 </xsl:template>

 <xsl:template match="numberedList|unnumberedList">
  <li><xsl:apply-templates/></li>
 </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T03:31:11.140

**I. 稍短的 XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:key name="kUlist" match="unnumberedList"
   use="generate-id(preceding-sibling::*
                        [not(self::unnumberedList)][1]
                   )"/>

 <xsl:template match="/*">
  <html>
   <xsl:apply-templates select="numberedList[1]" mode="first"/>
  </html>
 </xsl:template>

 <xsl:template match="numberedList" mode="first">
   <ol>
     <xsl:apply-templates select=". | following-sibling::*"/>
   </ol>
 </xsl:template>

 <xsl:template match="*">
  <li><xsl:apply-templates /></li>
 </xsl:template>

 <xsl:template match=
 "unnumberedList
      [not(preceding-sibling::*[1][self::unnumberedList])]">
   <li>
     <ul>
       <xsl:apply-templates mode="inUList" select=
           "key('kUlist', generate-id(preceding-sibling::*[1]))"/>
     </ul>
   </li>
 </xsl:template>

 <xsl:template match="*" mode="inUList">
   <li><xsl:value-of select="."/></li>
 </xsl:template>
 <xsl:template match="unnumberedList"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<xml>
    <numberedList>1\. Number List 1</numberedList>
    <unnumberedList>Child List 1</unnumberedList>
    <unnumberedList>Child List 2</unnumberedList>
    <unnumberedList>Child List 3</unnumberedList>
    <numberedList>2\. Number List 2</numberedList>
    <unnumberedList>Child List 1</unnumberedList>
    <numberedList>3\. Number List 3</numberedList>
</xml> 
```

**产生了想要的正确结果：**

```
<html>
   <ol>
      <li>1\. Number List 1</li>
      <li>
         <ul>
            <li>Child List 1</li>
            <li>Child List 2</li>
            <li>Child List 3</li>
         </ul>
      </li>
      <li>2\. Number List 2</li>
      <li>
         <ul>
            <li>Child List 1</li>
         </ul>
      </li>
      <li>3\. Number List 3</li>
   </ol>
</html> 
```

* * *

**二、XSLT 2.0 解决方案——比 I 短 30%。**

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/*">
  <html>
   <ol>
     <xsl:for-each-group select="*" group-adjacent="name()">
       <xsl:apply-templates select="current-group()"/>
     </xsl:for-each-group>
   </ol>
  </html>
 </xsl:template>

 <xsl:template match="*" mode="#default inUList">
  <li><xsl:apply-templates/></li>
 </xsl:template>

 <xsl:template match=
  "unnumberedList[preceding-sibling::*[1][not(self::unnumberedList)]]">
  <li>
   <ul>
    <xsl:apply-templates mode="inUList" select="current-group()"/>
   </ul>
  </li>
 </xsl:template>
 <xsl:template match="unnumberedList"/>
</xsl:stylesheet> 
```

**当此 XSLT 2.0 转换应用于同一个 XML 文档（上图）时，会产生相同的正确结果**：

```
<html>
   <ol>
      <li>1\. Number List 1</li>
      <li>
         <ul>
            <li>Child List 1</li>
            <li>Child List 2</li>
            <li>Child List 3</li>
         </ul>
      </li>
      <li>2\. Number List 2</li>
      <li>
         <ul>
            <li>Child List 1</li>
         </ul>
      </li>
      <li>3\. Number List 3</li>
   </ol>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T23:30:48.887

毫无疑问，这可以更轻松地完成，但请尝试以下操作。
说明：这是不言自明的 :-)
请注意，这也适用于 XSLT 1.0。

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>
    <xsl:template match="xml">
        <html>
            <ol>
                <xsl:apply-templates select="numberedList[1]"/>
            </ol>
        </html>
    </xsl:template>
    <xsl:template match="numberedList">
        <li>
            <xsl:value-of select="."/>
        </li>
        <xsl:apply-templates select="following-sibling::*[1]"/>
    </xsl:template>
    <xsl:template match="unnumberedList [local-name(preceding-sibling::*[1]) = 'numberedList']">
        <li>
            <ul>
                <li>
                    <xsl:value-of select="."/>
                </li>
                <xsl:apply-templates select="following-sibling::*[1] [local-name() = 'unnumberedList']"/>
            </ul>
        </li>
        <xsl:apply-templates select="following-sibling::numberedList[1]"/>
    </xsl:template>
    <xsl:template match="unnumberedList [local-name(preceding-sibling::*[1]) = 'unnumberedList']">
        <li>
            <xsl:value-of select="."/>
        </li>
        <xsl:apply-templates select="following-sibling::*[1] [local-name() = 'unnumberedList']"/>
    </xsl:template>
</xsl:stylesheet> 
```

这给出了以下结果：

```
<?xml version="1.0" encoding="UTF-8"?>
<html>
    <ol>
        <li>1\. Number List 1</li>
        <li>
            <ul>
                <li>Child List 1</li>
                <li>Child List 2</li>
                <li>Child List 3</li>
            </ul>
        </li>
        <li>2\. Number List 2</li>
        <li>
            <ul>
                <li>Child List 1</li>
            </ul>
        </li>
        <li>3\. Number List 3</li>
    </ol>
</html> 
```

# javascript - 动态添加方法到对象

> ID：10237521
> 
> 赞同：0
> 
> 时间：2012-04-19T22:07:25.603
> 
> 标签：javascript

我希望这可以在 Javascript 中完成。

> 我有这样的事情：

有这样的东西：

```
var MYOBJECT = {
method1: function(){//some cool},
addMethodToObject: function (a_new_method){
//whats need to be here to add the
 method passed in "a_new_method" to MYOBJECT ?
}

} 
```

这个想法是调用：

```
MYOBJECT.addMethodToObject(function otherMethod(needThis){return needThis;}); 
```

现在 MYOBJECT 将方法作为新方法传递，我可以这样做：

```
MYOBJECT.otherMethod('say Hi'); 
```

将输出

> “打招呼”

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T23:56:25.640

我没有测试上面的答案，但他们都需要从内部更改对象。我需要一些东西而不从内部改变对象，所以我想出了这个解决方案：

首先创建对象的实例，然后：

```
yourObject.yourMethodName = function(methodParam1, methodParam2) {
    doWhatYouNeed;
}; 
```

然后执行为：

```
yourObject.yourMethodName(methodParam1, methodParam2); 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T22:22:41.627

就像其他人所说的那样，只需将匿名函数作为参数传递给您的 addMethodToObject 函数。

```
var MYOBJECT = {
    method1: function(){ ; },
    addMethodToObject: function (methodName, method) {
        this[methodName] = method;
    }
};

MYOBJECT.addMethodToObject("newMethod", function () {
    console.log("testing 123");
});

MYOBJECT.newMethod(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T22:15:57.667

您可以定义一个函数来执行此操作。但是，您不需要`MYOBJECT`直接分配给：

```
MYOBJECT.otherMethod = otherMethod;
function otherMethod(needThis){
    return needThis;
} 
```

函数是 JavaScript 中的一等对象，您可以像传递任何其他对象一样传递对它们的引用。您可以随时在 JavaScript 对象上创建新属性，只需为属性赋值即可。

如果你想为它定义一个函数，该函数必须同时接受函数*和*你希望它在对象上具有的名称，如下所示，如下所示：

```
var MYOBJECT = {
    // ...
    addMethodToObject: function(name, func) {
        this[name] = func;
    }
}; 
```

这是因为属性和函数没有理由必须具有相同的名称，并且没有*标准*的方法可以从函数实例中获取函数的名称。（有几种*非标准*方式，但标准没有定义。）

我在那里使用的语法可能不熟悉。在 JavaScript 中，有*两种*访问属性的方法：带有文字名称的点表示法和带有字符串的括号表示法。示例是演示它的最清晰方法：

```
var obj = {};
obj.foo = 42;    // Dotted notation with a literal name `foo`
obj["foo"] = 42; // Exactly the same thing, using bracketed notation and a string
var s = "foo";
obj[s] = 42;     // Again the same, because the string doesn't have to be a literal 
```

...这就是为什么`this[name] = func;`有效；`name`是要添加的属性的字符串名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T22:16:52.747

试试这个：

```
function test() {

  myObj = {
    addMethod: function( method, name ) {
      this[name] = method;
    }
  }

  myObj.addMethod( function() { alert( "foo" ) }, "fooMethod" );
  myObj.fooMethod();

} 
```

拜拜 ;）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T22:17:56.213

简单你可以像你添加一个新属性一样添加一个新方法

```
obj["MethodName"] = function(){//ur Javascript statements} 
```

# visual-studio-2010 - 我认为 WiX 库项目不适合共享组件定义（并且没有办法对 Guid 进行参数化）是对的吗？

> ID：10237522
> 
> 赞同：2
> 
> 时间：2012-04-19T22:07:30.657
> 
> 标签：visual-studio-2010, wix

WiX 组件通常都应该有一个**Guid**属性，所以如果我想将组件的**定义**（例如 iis:WebAppPool 和 iis:WebVirtualDir 的组件）（或另一个示例 - 包含具有权限的日志文件夹的组件）移动到**WiX 库项目**中我将无法使用不同的 guid 重用这些定义......对我来说这是一个问题，我想共享定义以定义不同的组件（具有不同的 guid）！

而且没有办法做点什么。

我试图通过像这样的属性来设置 guid

```
<Component Name="cmpKuku" Guid="[cmpGUID]" /> 
```

但这不起作用 => 组件的 GUID 不接受参数。可能还有其他方法可以参数化组件的 guid 吗？当然，在 Wix 库项目的情况下，通过预处理器变量进行参数化也不起作用。

Guid="*" 是可计算的，但据我了解，它仅取决于组件的内容，而不取决于父母、产品、功能？如果在不同的功能/产品中引用，wix 为 * 计算不同的 guid，这对我有好处。

*x) 我们是否有其他方式来共享 iis:WebVirtualPage 和 iis:WebAppPool 定义，而无需框架组件？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T17:56:54.943

我读过完全相同的帖子。Rob Mensching 这么说的原因是您不能将 wixlibs 与其他工具一起使用，因为它们是特定于 wix 的。但是，wixlibs 和合并模块都非常相似（尽管 wixlibs 是更好/更快和更新的选择）。因此，要回答您的问题，是的，您可以使用 wixlibs 来包含组件，因为正如我上面提到的，它们类似于合并模块。本质上，单个共享组件在其整个生命周期内必须具有相同的 GUID，并且 Windows 安装程序知道如何跟踪它们。

因此，例如，假设您有一个包含某些组件的 a.wixlib。然后创建两个单独的安装程序 b.msi 和 c.msi，引用相同的 wixlib 并安装它们。Windows 安装程序将组件的引用计数设置为 2。稍后您决定卸载 b.msi。Windows 安装程序将组件的引用计数减少到 1，但尚未卸载它。原因是wixlibs，就像合并模块一样用于共享组件（[http://msdn.microsoft.com/en-us/library/windows/desktop/aa369820(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369820(v=vs.85).aspx)）。因此，在您卸载 c.msi 后，只会删除该组件。

还有一件事。您可以通过放置 guid="*" 属性在链接期间生成 GUID。我通常反对它，但它是有效的。

编辑：为了避免误导人们对星号，使用它们并不是一个坏习惯，因为这可能是构建准备升级的产品的最简单方法，因为对于升级，无论如何您都需要生成一个新的 GUID。因此，如果构建中没有额外的复杂性，使用星号可能就可以了。

# java - java.lang.ClassNotFoundException: com.microsoft.sqlserver.jdbc.SQLServerDriver 在 Maven 项目中

> ID：10237523
> 
> 赞同：1
> 
> 时间：2012-04-19T22:07:40.173
> 
> 标签：java, maven, jdbc, classnotfoundexception

我正在尝试使用 JDBC 连接到 SQLServer DB。我正在使用 jre 1.6，并且已将“sqljdbc/jar”添加到操作系统上的类路径中。我还将那个 jar 添加到我的构建路径中。当我的代码到达这一行时 `Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");` ，它会爆炸。我可以导航到包资源管理器中的类，我还可以输入名称空间，eclipse intellisense 也可以将其选中，但是当它加载时，我会得到 `java.lang.ClassNotFoundException: com.microsoft.sqlserver.jdbc.SQLServerDriver`. 我正在使用带有 Spring STS 插件的 Eclipse Indigo Release 2，谁能告诉我发生了什么？顺便说一句：我可以使用 Eclipse 中的 DB Explorer 连接到我的数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T08:44:42.610

谢谢大家的建议，我是这样解决的：

1.  我将有问题的 jar 添加到我的`.m2`存储库文件夹中

2.  打开`Pom.xml`=> 单击`Dependencies`选项卡 => 单击`Add`

3.  对文件夹结构进行建模以匹配我输入的属性的结构。例如`jdbc\sqljdbc4\4\sqljdbc4-0.jar`（我添加`-0`，因为它需要有一个版本#）*

4.  重建、部署和 BAM！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:12:31.063

尝试查看在同一位置是否有另一个 jar 文件 sqljdbc2.jar。使用那个。此外，您可能想尝试 SQL Server 的 jTDS 驱动程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:14:52.230

可能是您有多个库引用`com.microsoft.sqlserver.jdbc.SQLServerDriver`，请检查您的驱动程序，或者尝试下载其他版本。

有时进行清理和构建会有所帮助（项目->清理），然后再次构建可能会有所帮助。

祝你好运

铅

# ios5 - IOS5.1 在 3G 连接上 SSL 连接失败

> ID：10237530
> 
> 赞同：-1
> 
> 时间：2012-04-19T22:08:11.343
> 
> 标签：ios5, ssl, 3g, afnetworking

刚刚完成了我的新 iOS 应用程序的开发，我偶然发现了一个奇怪的问题。

我的 API 端点在具有 Comodo SSL 认证的 SSL (nginx/openssl) 上运行。当我使用 wi-fi 时，我可以通过 AFNetworking 和 iPhone 上的 Safari 从我的应用程序连接到它。当我切换到 3G 时出现问题。我无法从其中任何一个连接到 API URL。通过 https 连接到 Gmail 工作正常，所以我不能责怪我的 GSM 运营商。

我在我的其他应用程序之一中使用的 API 端点也因相同的设置而失败，并且它与 iOS4.2 一起正常工作。

我唯一的猜测是：

*   iOS5 切换到 TLS1.2 并且 nginx/openssl 组合不支持它。但在那种情况下，当我使用 Wi-Fi 时，我将无法连接。

在过去的几个小时里，我几乎要把头发拔掉，这真的很令人沮丧。提前感谢您的任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-23T15:19:54.187

对不起，伙计们，我想我应该多睡觉，少工作。这一切都与一个自定义防火墙规则有关，该规则阻止我的 VPN 中任何 IP 的端口 443。这个问题的唯一结果是：

*   首先检查您的环境！

# wpf - WPF/XAML - 验证错误出现两次

> ID：10237531
> 
> 赞同：0
> 
> 时间：2012-04-19T22:08:19.330
> 
> 标签：wpf, validation, xaml

我有一个带有 GroupBox 的表单，其中有许多控件（复选框、文本框和组合框）。

表单绑定到一个在其属性上实现了 IDataErrorInfo 的视图模型，当用户在控件中输入无效值时，IDataInfo 返回无效结果，并且该控件被通常的红色框包围，并显示错误消息在表格的底部。

问题是，GroupBox 旨在指示一组强制值。用户需要选中组中的至少一个复选框。不这样做不是个体控制的错误，而是群体的错误。因此，我在 GroupBox 中添加了一个 BindingGroup，并添加了一个 ValidationRule，如果未选择任何内容，该规则将返回错误。这很好用。如果未选择任何内容，则 GroupBox 将被通常的红色框包围，并且错误消息将显示在表单底部。

我的问题是，如果 GroupBox 中的一个控件验证失败，我会得到两个红色框 - 一个围绕控件，一个围绕 GroupBox。我在表单底部的列表中收到两条错误消息。

如何防止 BindingGroup 报告组中包含的所有内容的错误？

编辑：

一个简单的示例 - 这不显示 Validation.Errors，但您可以看到 StackPanel 突出显示为验证失败，而包含的 TextBox 显示。

XAML：

```
<Window
        x:Class="BugHunt5.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:BugHunt5"
        Title="MainWindow"
        Height="350"
        Width="525"
        >
    <GroupBox 
            Margin="20"
            Header="This is my group"
            x:Name="MyGroupBox"
            >
        <StackPanel>
            <StackPanel.BindingGroup>
                <BindingGroup NotifyOnValidationError="True">
                </BindingGroup>
            </StackPanel.BindingGroup>
            <TextBox 
                    Height="30"
                    Width="100"
                    >
                <TextBox.Text>
                    <Binding
                            NotifyOnValidationError="True"
                            ValidatesOnDataErrors="True"
                            Path="MyString"
                            UpdateSourceTrigger="PropertyChanged"
                            >
                        <Binding.ValidationRules>
                            <local:NoDecimalsValidationRule ValidatesOnTargetUpdated="True"/>
                        </Binding.ValidationRules>
                    </Binding>
                </TextBox.Text>
            </TextBox>
        </StackPanel>
    </GroupBox>
</Window> 
```

C#：

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        this.DataContext = new ViewModel("This should be an integer");
    }
}
public class ViewModel
{
    public string MyString
    { get; set; }
    public ViewModel(string mystring)
    { this.MyString = mystring; }
}
public class NoDecimalsValidationRule : ValidationRule
{
    public override ValidationResult Validate(object value,
        System.Globalization.CultureInfo cultureInfo)
    {
        string myString = value as string;
        int result;
        if (!Int32.TryParse(myString, out result))
            return new ValidationResult(false, "Must enter integer");
        return new ValidationResult(true, null);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T22:21:48.187

**视图模型.cs**

```
public class ViewModel : INotifyPropertyChanged, IDataErrorInfo
{
    public event PropertyChangedEventHandler PropertyChanged;

    private bool checked1, checked2;
    private string myString;

    public bool Checked1
    {
        get { return this.checked1; }
        set { this.SetValue(ref this.checked1, value, "Checked1"); }
    }

    public bool Checked2
    {
        get { return this.checked2; }
        set { this.SetValue(ref this.checked2, value, "Checked2"); }
    }

    public string MyString
    {
        get { return this.myString; }
        set { this.SetValue(ref this.myString, value, "MyString"); }
    }

    protected virtual void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        var handler = this.PropertyChanged;
        if (handler != null)
            handler(this, e);
    }

    private void SetValue<T>(ref T field, T value, string propertyName)
    {
        if (!EqualityComparer<T>.Default.Equals(field, value))
        {
            field = value;
            this.OnPropertyChanged(new PropertyChangedEventArgs(propertyName));
        }
    }

    public string Error
    {
        get
        {
            return this.checked1 == false && this.checked2 == false ? "Must check one value." : string.Empty;
        }
    }

    string IDataErrorInfo.this[string propertyName]
    {
        get
        {
            switch (propertyName)
            {
                case "MyString":
                    int result;
                    return int.TryParse(this.myString, out result) ? string.Empty : "Must enter integer.";
                default:
                    return string.Empty;
            }
        }
    }
} 
```

**主窗口.xaml**

```
<Window x:Class="WpfApplication.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication"
        Title="MainWindow" Height="350" Width="525">
    <GroupBox Header="This is my group">
        <GroupBox.DataContext>
            <local:ViewModel MyString="This should be an integer"/>
        </GroupBox.DataContext>
        <StackPanel>
            <StackPanel.BindingGroup>
                <BindingGroup x:Name="checkedBindingGroup">
                    <BindingGroup.ValidationRules>
                        <DataErrorValidationRule ValidationStep="ConvertedProposedValue"/>
                    </BindingGroup.ValidationRules>
                </BindingGroup>
            </StackPanel.BindingGroup>
            <CheckBox IsChecked="{Binding Checked1, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}" Binding.SourceUpdated="OnCheckedSourceUpdated" Content="Checked1"/>
            <CheckBox IsChecked="{Binding Checked2, UpdateSourceTrigger=PropertyChanged, NotifyOnSourceUpdated=True}" Binding.SourceUpdated="OnCheckedSourceUpdated" Content="Checked2"/>
            <TextBox Text="{Binding MyString, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, BindingGroupName=Dummy}"/>
        </StackPanel>
    </GroupBox>
</Window> 
```

**主窗口.xaml.cs**

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void OnCheckedSourceUpdated(object sender, DataTransferEventArgs e)
    {
        this.checkedBindingGroup.ValidateWithoutUpdate();
    }
} 
```

关键事项：

*   将 'MyString' Binding 上的 BindingGroupName 设置为某个虚拟值，因此它不包含在父 BindingGroup 中。
*   “Checked1”和“Checked2”绑定必须将 NotifyOnSourceUpdated 设置为 true，并将事件处理程序添加到 Binding.SourceUpdated 事件，其中必须显式调用 BindingGroup 验证。
*   BindingGroup 中 DataErrorValidationRule 的 ValidationStep 必须是 ConvertedProposedValue 或 RawProposedValue ，这样 BindingGroup.ValidateWithoutUpdate() 才能执行验证逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T12:12:01.700

我曾经遇到过类似的问题，但似乎没有合乎逻辑的出路（因为它会导致类似悖论的事情）。

但是，您可以做的是修改`Validation.ErrorTemplate`复选框或与组关联的面板的附加属性以删除红色轮廓。

# binary - 二进制文件中的问题

> ID：10237532
> 
> 赞同：-1
> 
> 时间：2012-04-19T22:08:30.067
> 
> 标签：binary

1.  我将可变大小的记录存储在二进制文件中。因此，我想划分每条记录。二进制文件中记录的良好分界符号是什么？
2.  您将如何对二进制文件进行二进制搜索？
3.  二进制文件有搜索算法吗？

在我的例子中，二进制文件主要是指数值，遵循二进制规范。以 3 位存储的值，后跟以 25 位存储的值，依此类推...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:20:27.347

1.  更好的解决方案是存储记录的长度。如果你不能这样做，只需选择一个你知道不能出现在正常数据中的分隔符。
2.  使用二进制文件中的记录进行二进制搜索就像使用任何数据一样。请记住，必须对记录进行排序。
3.  二进制数据的良好搜索算法 - 搜索什么？如果您尝试匹配模式，通用文本搜索算法就可以正常工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T22:11:27.130

1）没有一个。2）我只是..看，你不能。3) 顺序比较。

# php - 上传文件时遇到问题

> ID：10237535
> 
> 赞同：0
> 
> 时间：2012-04-19T22:08:42.373
> 
> 标签：php, codeigniter, file-upload

我有一个表单，人们在其中选择文件，在文本框中键入文件名，然后单击保存，它应该将文件保存在服务器上。

我希望它工作的方式是：

1）在数据库中插入一行。2）保存文件，文件名是db的row_id。(ex.38.pdf) 3) 使用文件扩展名更新 db。

我不知道如何安排我的代码以便发生这种情况。我可以插入行，但为了设置 file_name（保存文件的名称），我需要扩展名。获取扩展的唯一方法是加载库。为了加载库，我需要设置 $config 数组（其中之一是 file_name）。

很迷茫。可能很明显，但也许我已经盯着它很久了。感谢您的帮助，祝您好运。顺便说一句，我正在使用 codeigniter 框架。

（截至目前，此代码已损坏。我已经搞砸了大约一个半小时。这正是我最近尝试过的）

表单指向的上传函数 ---------

```
 public function do_upload () {
    $fileName = $this->input->post('name');
    $scopeId = $this->session->userdata('scopeId');
    $user = 'user';

    $date = date('n/d/Y', time());
    $query = $this->db->query('
        INSERT 
        INTO scope_uploads 
        VALUES(
            NULL, 
            '. $scopeId .', 
            "'. $fileName .'", 
            "'. $user .'", 
            "'. $date .'",
            "N/A"
        )
    ');

    $lastId = $this->db->insert_id();

    $this->load->library('upload');

    $fileData = $this->upload->data();
    $fileExt = $fileData['file_ext'];

    $config['upload_path'] = './uploads/';      
    $config['allowed_types'] = 'gif|jpg|pdf';       
    $config['file_name'] = ''. $lastId .'.'. $fileExt .'';
    $config['max_size'] = '1000';
    $config['max_width'] = '1024';
    $config['max_height'] = '768';

    $this->load->library('upload', $config);

    $query2 = $this->db->query('
        UPDATE scope_uploads
        SET extension = "'. $fileExt .'"
        WHERE id = '. $lastId .'
    ');

    $error = '';

    if (!$this->upload->do_upload('userfile')) {
        $error = array('error' => $this->upload->display_errors());
        echo 'error';
    } else {
        $data = array('upload_data' => $this->upload->data());          
    }

    if ($error == '') {
        redirect(site_url('headquarters/scopeSummary'));
    } else if ($error !== '') {
        $deleteLastRow = $this->db->query('
            DELETE 
            FROM scope_uploads
            WHERE id = '. $query->insert_id() .'
        ');
    }

    print_r($error);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T03:13:24.413

我不会解释任何代码，因为您只需要对代码进行一些更改。

1.  获取文件名的表单输入（例如：name =“filename”）
2.  表单上传
3.  如果点击提交按钮，您必须先上传文件
4.  检查文件上传是否成功
5.  如果成功使用“文件名”+上传操作中的 mimetype 重命名它
6.  将“文件名”保存到数据库
7.  如果上传失败，转到错误消息，“文件名”将不会插入数据库

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T03:24:44.357

你不想要文件扩展名，你想要 mime 类型。任何人都可以上传一个以结尾的文件，`.jpg`但这并不意味着它不是一些包含谁知道什么的文本文件。

要获得 mime 类型，您应该使用`FINFO`可能需要安装的库。

```
$finfo = finfo_open(FILEINFO_MIME_TYPE);
$mime_type =  finfo_file($finfo, $_FILES['userfile']['tmp_name']);
finfo_close($finfo); 
```

现在看起来您已经完成了一些工作来抽象上传文件，因此您需要使用上述内容并将全局变量替换为上传文件的适当完整路径名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T07:44:36.773

在 codeigniter 中有一个用于 mime 类型的 form_validation 库插件：http: [//codeigniter.com/forums/viewthread/123816/](http://codeigniter.com/forums/viewthread/123816/)

我在我的项目中使用它并且工作得很好。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-20T21:18:57.840

谢谢您的帮助。阅读 codeigniter 文档时，我认为在重命名上传的文件时必须包含扩展名。事实证明我没有。都修好了

# assembly - 重写 EBP 堆栈返回值

> ID：10237537
> 
> 赞同：0
> 
> 时间：2012-04-19T22:08:52.327
> 
> 标签：assembly, linux-kernel, stack, stack-overflow, buffer-overflow

嗨，我正在尝试为我构建的一个简单程序编写溢出漏洞利用程序。Bellow 是我编写的 C 程序。

```
#include <unistd.h>
#include <string.h>
#include <stdio.h>

char *string_in = "Did not work";

int test(char *this){
char sum_buf[6];
strncpy(sum_buf,this,24);
return 0;
}

void hello(){
printf("hello man");
string_in = "If this triggered, it means our shell code is working\n";
return;
}

int main(int argc, void **argv){

test("01234567890123456789\x00\x40\x06\x02");
printf("My string is %s",string_in);
return 0;

} 
```

基本上发生的情况是，假设该字符串在覆盖 EBP 中读取，值为 0x00400602，这是我的函数 hello() 的返回地址。我知道这是我的函数 hello 的地址值，因为 objdump -d test_stack.o。从对象转储中，我可以看出 rsp 已提前 20 个字节，如下所示

```
00000000004005b4 <test>:
  4005b4:   55                      push   %rbp
  4005b5:   48 89 e5                mov    %rsp,%rbp
  4005b8:   48 83 ec 20             sub    $0x20,%rsp
  4005bc:   48 89 7d e8             mov    %rdi,-0x18(%rbp)
  4005c0:   64 48 8b 04 25 28 00    mov    %fs:0x28,%rax
  4005c7:   00 00 
  4005c9:   48 89 45 f8             mov    %rax,-0x8(%rbp)
  4005cd:   31 c0                   xor    %eax,%eax
  4005cf:   48 8b 4d e8             mov    -0x18(%rbp),%rcx
  4005d3:   48 8d 45 f0             lea    -0x10(%rbp),%rax
  4005d7:   ba 18 00 00 00          mov    $0x18,%edx
  4005dc:   48 89 ce                mov    %rcx,%rsi
  4005df:   48 89 c7                mov    %rax,%rdi
  4005e2:   e8 a9 fe ff ff          callq  400490 <strncpy@plt>
  4005e7:   b8 00 00 00 00          mov    $0x0,%eax
  4005ec:   48 8b 55 f8             mov    -0x8(%rbp),%rdx
  4005f0:   64 48 33 14 25 28 00    xor    %fs:0x28,%rdx
  4005f7:   00 00 
  4005f9:   74 05                   je     400600 <test+0x4c>
  4005fb:   e8 a0 fe ff ff          callq  4004a0 <__stack_chk_fail@plt>
  400600:   c9                      leaveq 
  400601:   c3                      retq   

0000000000400602 <hello>:
  400602:   55                      push   %rbp
  400603:   48 89 e5                mov    %rsp,%rbp
  400606:   b8 6d 07 40 00          mov    $0x40076d,%eax
  40060b:   48 89 c7                mov    %rax,%rdi
  40060e:   b8 00 00 00 00          mov    $0x0,%eax
  400613:   e8 98 fe ff ff          callq  4004b0 <printf@plt>
  400618:   48 c7 05 0d 0a 20 00    movq   $0x400778,0x200a0d(%rip)        # 
```

由于低于 20 美元，%rsp 我知道我需要写至少 20 个字节......但我不确定我需要写多少才能到达我的 rbp。可能从我的 calq 中，我需要写 8 个或我的字节，因为有 2 个 x 调用。虽然我真的不确定我需要写多少。

我像这样编译我的程序......

```
gcc -g stack.c -o test_stack.o
execstack -s test_stack.o 
```

因为我使用的是 ubuntu 11，所以我的内核版本是 3.0.17，所以我知道我的 aslr 默认是打开的。我可能需要关闭它，但我不知道该怎么做。我也在运行 i386:x86_64。我可以告诉我在运行期间我的堆栈实际上是什么样的吗？我怎样才能让它工作，我怎样才能找到我需要写多少？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T06:13:41.147

那么第一个问题是我必须关闭堆栈保护并打开 -fno-stack-protector 标志。一旦我这样做了，覆盖我的缓冲区就变得容易多了。第二个问题是即使字符串是用小端序读取和存储的，操作码和操作数似乎也是用大端序解释的。我不明白为什么会这样。最后，我有兴趣覆盖的不是 EBP 堆栈帧……而是我的函数的返回地址。这意味着我需要有效地覆盖多达 32 个字节，而不是写入 24 个字节。我终于让程序工作了！

# php - 将数据从 Backbone 交给 CodeIgniter

> ID：10237539
> 
> 赞同：3
> 
> 时间：2012-04-19T22:09:22.883
> 
> 标签：php, codeigniter, rest, backbone.js

我在将数据从 Backbone 处理到 CodeIgniter 应用程序时遇到问题......在调用 Backbone 的`save()`或`sync()`方法并检查 Chrome 工具中的请求标头后，Backbone 似乎使用请求有效负载而不是标准的表单数据方法将数据发送到服务器jQuery 和标准 HTML 表单提交。

如果启用`Backbone.emulateJSON()`，则帖子将通过表单数据发送，并且我可以`$this->input->post('model')`按预期检索数据。然后我可以调用`json_decode()`该数据并继续前进——但是，这将破坏我对 CodeIgniter 的验证库的实现。我将验证规则存储在单独的文件中，并在他们希望数据驻留的幕后`$this->input->post()`，而不是`$this->input->post('model')`；

我已经研究过使用 Phil Sturgeon 的 Restserver 库。看来它将允许我`Backbone.emulateHTTP()`通过处理`PUT`和`DELETE`请求来删除。但是，我仍然需要调用`$this->post('model')`，验证仍然会被破坏，事实上，这个库的`PUT`and`DELETE`请求甚至不支持验证！

我开始认为 CodeIgniter 有饼干，不会支持我急需的前端需求。我一直坚持使用 CodeIgniter，因为此时我已经习惯了它的架构，而且 Datamapper ORM 非常棒。

关于如何进行的建议？如果您的建议附带一个优雅的 RESTful 实现，该实现默认与 Backbone 一起使用，具有强大的 ORM 和广泛的验证/XSS 库，我对整个后端框架交换持开放态度。或者，如果你能解决我的 CodeIgniter 困境，那也可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-03T15:59:11.157

检查 Phil Sturgeon codeigniter restfull 控制器实现。

[https://github.com/philsturgeon/codeigniter-restserver](https://github.com/philsturgeon/codeigniter-restserver)

如果您使用此休息控制器，则无需迁移到 Slim 或其他框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T13:00:43.150

我会引导您访问[http://www.slimframework.com](http://www.slimframework.com)。使用新的 PHP 闭包很好地实现了 REST 服务器。让我知道你是怎么办的！

# javascript - 从左侧居中列表

> ID：10237541
> 
> 赞同：0
> 
> 时间：2012-04-19T22:09:35.553
> 
> 标签：javascript, jquery, css, list, centering

我有一个无序列表，里面有相当大的图像。现在我想看看是否有任何 css 代码可以用来将该列表居中到第一张图片恰好出现在页面中间的位置？

看看这张照片，我的意思是：

[http://i.stack.imgur.com/Nk7cZ.jpg](http://i.stack.imgur.com/Nk7cZ.jpg)

反正有没有用css做这个？甚至是javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:22:09.483

看这里[http://jsfiddle.net/ru79c/](http://jsfiddle.net/ru79c/)

我只是通过计算身体宽度差异之间有多少边距来做到这一点 - 左边距图像宽度除以 2

编辑你可以在窗口调整大小时重新计算，所以它总是保持居中。 [http://api.jquery.com/resize/](http://api.jquery.com/resize/)

```
var leftmargin = ($('body').width() - $('ul li').width()) / 2;
$('ul li:eq(0)').css({'margin-left':leftmargin + 'px'});
​ 
```

# c# - 根据结构图中的参数解析具体类型

> ID：10237542
> 
> 赞同：0
> 
> 时间：2012-04-19T22:09:42.090
> 
> 标签：c#, dependency-injection, structuremap

我正在尝试解决依赖于我正在调用的操作中的参数值的依赖关系。

我有这个 WCF 服务

```
public class InformationService : IInformationService
{
    private readonly IValueProvider _valueProvider;

    public InformationService(IValueProvider valueProvider)
    {
        _valueProvider= valueProvider;
    }

    public CompanyReportResponse CompanyReport(string option)
    {
        _valueProvider.Execute(option);
    }
} 
```

我还在容器中为我的 ValueProvider 注册了两种具体类型。

```
Registry.For<IValueProvider>().Add<ValueProvider1>().Named("No1");
Registry.For<IValueProvider>().Add<ValueProvider2>().Named("No2"); 
```

是否可以根据选项的价值使用不同的价值提供者？

Ie, when option is `"value1"`then `_valueProvider`will use the concrete type `ValueProvider1`and when option is `"value2`" then `_valueProvider`will use the concrete type `ValueProvider2`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T09:18:53.503

+1 @filpen 的回答。我喜欢添加第三个选项。您可以引入代理来委托正确的实现，而不是注入工厂或进行基于上下文的注入：

```
public SwitchingValueProviderProxy: IValueProvider
{
    private readonly ValueProvider1 provider1;
    private readonly ValueProvider2 provider2;

    public SwitchingValueProviderProxy(
        ValueProvider1 provider1,
        ValueProvider2 provider2)
    {
        this.provider1 = provider1;
        this.provider2 = provider2;
    }

    void IValueProvider.Execute(option option)
    {
        this.GetProvider(option).Execute(option);
    }

    private IValueProvider GetProvider(string option)
    {
        // custom instance logic here
        if (option.EndsWith("1"))
            return this.provider1;

        if (option.EndsWith("2"))
            return this.provider2;

        throw InvalidOperationException();
    }
} 
```

这有几个明显的优点。首先，这完全隐藏了工厂和确定从客户端执行哪个提供程序的逻辑。客户端现在只依赖于`IValueProvider`接口。接下来，配置现在变得非常干净：

```
Registry.For<IValueProvider>()
    .Add<SwitchingValueProviderProxy>(); 
```

就是这样。如果你这样做，你仍然可以将选择逻辑提取到 an`IValueProviderFactory`中并将其注入到 中`SwitchingValueProviderProxy`，这使这个类保持简单和集中，并且仍然保持应用程序的其余部分对工厂一无所知。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T06:56:31.920

我看到至少 2 个不同的选项。

如果`ValueProvider`仅在该方法中使用，则可以考虑方法注入。由于在传递`option`参数时您已经知道要使用哪个参数，因此您可以提供 IValueProvider 的实现以用作附加参数。

```
public CompanyReportResponse CompanyReport(string option, IValueProvider provider)
{
    _provider.Execute(option);
} 
```

第二个选项是定义一个工厂来构建你的 ValueProvider，并通过构造函数注入来注入这个工厂。工厂将有一个根据`option`参数实例化正确 ValueProvider 的方法。

```
public interface IValueProviderFactory
{
    IValueProvider CreateProvider(string option);
}

public class ValueProviderFactory : IValueProviderFactory
{
    public IValueProvider CreateProvider(string option)
    {
         // Insert custom instantiation logic here:
         // if option == "value1" return ValueProvider1 and so on
    }
}

public class InformationService : IInformationService
{
    private readonly IValueProviderFactory _valueProviderFactory;

    public InformationService(IValueProviderFactory valueProviderFactory)
    {
        _valueProviderFactory = valueProviderFactory;
    }

    public CompanyReportResponse CompanyReport(string option)
    {
        var valueProvider = _valueProviderFactory.CreateProvider(option);
        valueProvider.Execute(option);
    }
} 
```

# c++ - C++ 试图创建一个“中间”函子

> ID：10237544
> 
> 赞同：1
> 
> 时间：2012-04-19T22:09:47.227
> 
> 标签：c++, callback, functor, variadic-templates

我所说的“中间”函子的意思是：一个普通函子，其中一个参数可以在调用时指定。问题是我有一个动画时间线（本质上是特定帧的标量值），并且它的输出需要通过管道传输到要设置动画的对象中的 getter/setter 方法。这是我尝试的一个简化示例：

```
template < class ObjType, class Getter, class Setter, typename Scalar >
class Sy_propertyBridge : public Sy_abstractPropertyBridge
{
public:
                        Sy_propertyBridge( ObjType* object, Getter getter,
                                           Setter setter )
                            : obj_( object ), get_( getter ),
                              set_( setter ) {}
    virtual            ~Sy_propertyBridge() {}

    inline virtual float get() const
                        {
                            //  Cannot handle default arguments.
                            Scalar tmp = ( obj_->*get_ )();
                            return static_cast< float >( tmp );
                        }
    inline virtual void set( float value )
                        {
                            Scalar tmp = static_cast< Scalar >( value );
                            ( obj_->*set_ )( tmp );
                        }
private:
    ObjType*            obj_;
    Getter              get_;
    Setter              set_;
}; 
```

时间线仅包含浮点数，因此无论对象用于其 getter/setter 方法的任何标量类型都必须进行转换（我对浮点数进行了部分专业化，从而消除了转换）。 `ObjType`是动画对象类型，`Getter`并且`Setter`是指向方法的指针，并且`Scalar`是 Getter 和 Setter 类型并期望处理。

我认为这会很好，但是编译失败了，因为一些 getter/setter 有其他默认初始化的参数。我不认为这会是一个问题，因为它们是默认的！但是当编译器期望方法指针的参数比我提供的更多时，它失败了。

然后我尝试使用可变参数模板 args，以便可以手动输入默认值，但由于我无法将参数包存储为成员，以便作为 args 重复应用于指向方法的指针，因此我遇到了第一个障碍。我也一直在研究 std::function 和 std::bind，我希望能够将 std::function 存储为具有 getter/setter 方法的默认 args 预设的成员 - 并从就在调用之前的时间线。只是我找不到办法做到这一点......

有没有人有任何建议来实现我的目标？还是我的设计存在根本缺陷并且有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:38:06.407

`std::function`将是要走的路。将只`std::function<Scalar(const ObjType*)>`用作您的 getter，`std::function<void(ObjType*, Scalar)>`用作您的 setter（如果`Scalar`s 可以隐式转换为/从`float`s，我什至会使用`std::function<float(ObjType const*)>`and `std::function<void(ObjType*, float)>`，resp。）。您可以初始化这些，例如。使用 lambda 函数：

```
Sy_propertyBridge(my_obj, 
  [](const MyObjType* o) -> float { return o->opacity; }, 
  [](const MyObjType* o, float f) { o->opacity=f; }) 
```

请注意，可能有更优雅的方法来执行此操作（例如，可能只有一个函数可以同时用作 getter 和 setter）。

更进一步，你可以

*   摆脱`obj_`成员变量
*   去掉`o`函数的参数

然后 lambda 必须记住他们将操作的对象。所以上面的构造函数调用会变成

```
Sy_propertyBridge(
  []() -> float { return my_obj->opacity; }, 
  [](float f) { my_obj->opacity=f; }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:36:40.797

据我了解，您正在尝试使用您在这里传入的每个类都不同的“get”和“set”方法？如果是这样，我认为您应该尝试在“ObjType”对象上使用纯虚拟基类，然后在您传入的类中实现它。在 C#/Java 术语中，一个接口。

基本上是这样的：

```
class IGetSetter
{
    virtual float get() const = 0;
    virtual void set(float) = 0;    
}

class ObjType1 : public IGetSetter
{
    virtual float get() const
    {
        // Implementation
    }

    virtual void set(float a)
    {
        // Implementation
    }
}

class ObjType2 : public IGetSetter
{
    virtual float get() const
    {
        // Implementation
    }

    virtual void set(float a)
    {
        // Implementation
    }
} 
```

然后你的班级变成：

```
template < typename Scalar >
class Sy_propertyBridge : public Sy_abstractPropertyBridge
{
public:
    Sy_propertyBridge( IGetSetter* object)
        : obj_( object ) {}
    virtual ~Sy_propertyBridge() {}

    inline virtual float get() const
    {
        Scalar tmp = obj_->get();  // Uses polymorphism to find the right method
        return static_cast< float >( tmp );
    }
                        }
    inline virtual void set( float value )
    {
        Scalar tmp = static_cast< Scalar >( value );
        obj_->set( tmp );  // Uses polymorphism to find the right method
    }
private:
    ObjType* obj_;
}; 
```

但实际上，可能有一种直接的方法可以完全取消 Sy_propertyBridge 类。只需存储一个指针数组，`IGetSetter`然后在它们执行您想要的操作时直接调用它们。

# android - android图标错误 - 没有看到文件夹？

> ID：10237550
> 
> 赞同：1
> 
> 时间：2012-04-19T22:10:23.643
> 
> 标签：android, android-layout, android-icons

我创建了文件夹：

```
app_name/res/drawable-hdpi
app_name/res/drawable-mdpi
app_name/res/drawable-ldpi 
```

我将图标 72x72 放入 hdpi，48x48 放入 mdpi，36x36 放入 ldpi。我将 png 图标命名为：icon.png

我编译并运行它，图标没有改变。然后我去`AndroidManifest.xml`更改了图标参数：

```
<application
        android:icon="@drawable-ldpi/icon"
... 
```

但是我收到此错误：

> 错误：未找到与给定名称匹配的资源（在“图标”处，值为“@drawable-ldpi/icon”）。AndroidManifest.xml

有小费吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T22:16:52.173

将 dpi 添加到可绘制对象是无效的。您应该能够在清单中像这样设置它：

```
<Application
  ...
  android:icon="@drawable/ic_launcher" > 
  <!-- change ic_launcher to whatever your png is named --> 
```

典型的文件夹结构如下：

```
/
  AndroidManifest.xml
  /res
    /drawable-ldpi
      ic_launcher.png       # 36x36
    /drawable-mdpi
      ic_launcher.png       # 48x48
    /drawable-hdpi
      ic_launcher.png       # 72x72 
```

完成此操作后，您可能需要进行一次清理（eclipse -> 项目 -> 清理），但如果`/gen/R.java`文件中出现这样的行，您就会知道它是成功的：

```
public static final int ic_launcher = 0x...; 
```

如果不是，您可以删除 R.java 文件，ADT 将立即恐慌并从头开始重建它，并合并您的新可绘制对象。

作为最后一点，有时模拟器似乎坚持旧图标 - 清洁应该让它改变，但如果没有，进入设置并卸载应用程序，然后从 eclipse 再次运行，一切都应该**是**干净的（这同样适用于实际设备）

**注意**答案现在包括以下评论

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:17:01.390

确保您已刷新您的 Android 项目。您可以尝试将图标文件的名称更改为“ic_launcher.png”，这是现在使用的名称。

# svn - 有没有办法在允许提交实际发生在颠覆中之前强制批准代码更改

> ID：10237558
> 
> 赞同：2
> 
> 时间：2012-04-19T22:11:28.723
> 
> 标签：svn

在我们允许提交代码之前，我们有一些架构代码需要评估与其他代码的潜在冲突。至少我希望收到某个文件已被修改的通知，以便我自己去查看该文件。有没有办法让颠覆做到这一点？

现在我们唯一的模型是程序员对这些文件具有只读访问权限，他们可以在本地进行更改但不能提交。然后他们需要将文件通过电子邮件发送给我，我查看文件确定更改是否合适，然后自己执行提交。这是一个非常艰巨的过程，必须有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:16:23.023

你可以两者都做：有一个名为 的包`svnmailer`，可用于发送有关某些事件的电子邮件。另一方面，您可以限制主干上的写操作，并强制每个人对*特性分支*进行更改。只有审阅者有权将功能分支重新集成到主干中。请注意，重新集成非常简单，不会自行产生冲突。

# ssh - 设置 SSH 连接超时

> ID：10237563
> 
> 赞同：54
> 
> 时间：2012-04-19T22:11:43.353
> 
> 标签：ssh, timeout

我正在尝试减少 ssh 尝试打开与主机的连接的时间。如果我举个例子`ssh www.google.com`，提示返回需要很长时间。

我读到了关于使用的信息`ssh -o ConnectTimeout=10 www.google.com`，但即使这样也需要很长时间。是否有一些我可以修改以减少阻塞时间的尝试？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-04-19T22:18:41.377

问题可能是 ssh 正在尝试连接到解析到的**所有**不同 IP 。`www.google.com`例如在我的机器上：

```
# ssh -v -o ConnectTimeout=1 -o ConnectionAttempts=1 www.google.com
OpenSSH_5.9p1, OpenSSL 0.9.8t 18 Jan 2012
debug1: Connecting to www.google.com [173.194.43.20] port 22.
debug1: connect to address 173.194.43.20 port 22: Connection timed out
debug1: Connecting to www.google.com [173.194.43.19] port 22.
debug1: connect to address 173.194.43.19 port 22: Connection timed out
debug1: Connecting to www.google.com [173.194.43.18] port 22.
debug1: connect to address 173.194.43.18 port 22: Connection timed out
debug1: Connecting to www.google.com [173.194.43.17] port 22.
debug1: connect to address 173.194.43.17 port 22: Connection timed out
debug1: Connecting to www.google.com [173.194.43.16] port 22.
debug1: connect to address 173.194.43.16 port 22: Connection timed out
ssh: connect to host www.google.com port 22: Connection timed out 
```

如果我使用特定 IP 运行它，它会返回得更快。

**编辑**：我已经计时（用`time`），结果是：

*   www.google.com - 5.086 秒
*   173.94.43.16 - 1.054 秒

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-02-11T23:36:22.757

ConnectTimeout 选项允许您告诉您的 ssh 客户端在返回错误之前您愿意等待连接多长时间。通过将 ConnectTimeout 设置为 1，您实际上是在说“最多尝试 1 秒，如果尚未连接则失败”。

问题是当您按名称连接时，DNS 查找可能需要几秒钟。通过 IP 地址连接要快得多，实际上可能在一秒钟或更短的时间内工作。sinelaw 正在经历的是，每一次通过 DNS 名称连接的尝试都不会在一秒钟内发生。ConnectTimeout 的默认设置遵循 linux 内核连接超时，通常很长。

# java - 在war文件中部署SQLite db文件并使用正确的url访问

> ID：10237569
> 
> 赞同：3
> 
> 时间：2012-04-19T22:12:15.150
> 
> 标签：java, spring, hibernate, sqlite, maven

使用以下 Maven 配置在构建时创建一个 sqlite 数据库。

```
 <execution>
                <id>create-db</id>
                <phase>compile</phase>
                <goals>
                    <goal>execute</goal>
                </goals>
                <configuration>
                    <url>jdbc:sqlite:src/main/webapp/WEB-INF/sqlitedb.db</url>
                    <driver>org.sqlite.JDBC</driver>
                    <enableAnonymousPassword>true</enableAnonymousPassword>
                    <autocommit>true</autocommit>
                    <srcFiles>
                        <srcFile>src/main/sql/build.sql</srcFile>
                    </srcFiles>
                </configuration>
            </execution> 
```

这被打包到war文件中。然后从 peristence.xml 中引用它。

```
 <property name="hibernate.connection.url" value="jdbc:sqlite:????/sqlitedb.db"/> 
```

和弹簧配置。

```
 <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close" lazy-init="true">
        <property name="driverClassName" value="org.sqlite.JDBC"/>
        <property name="url" value="jdbc:sqlite:????/sqlitedb.db"/>
        <property name="minIdle" value="2"/>
        <property name="maxActive" value="20"/>
        <property name="maxIdle" value="5"/>
        <!--<property name="poolPreparedStatements" value="true" />-->
    </bean> 
```

我想不通的是如何让 Spring 配置和 Hibernate 配置查看 sqlitedb.db 的 war 文件。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-04-29T00:35:04.927

在这篇文章发表 2 年后回答它:) ; 可能会帮助很多人：

使用这个网址：“jdbc:sqlite:${catalina.base}/webapps/package_name/WEB-INF/classes/sqlitedb.db”

考虑到您已将 sqlitedb.db 文件放在项目资源中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-27T13:56:01.537

如果您想连接到 Payara 或 Glassfish。您将使用类似于 JDBC URL 的内容，如下所示：

```
jdbc:sqlite:${com.sun.aas.instanceRoot}/applications/APPLICATION_NAME/WEB-INF/sqlite.db 
```

`APPLICATION_NAME`您的部署名称在哪里。

# python - 在 Tkinter 中单击按钮时如何调用操作

> ID：10237572
> 
> 赞同：0
> 
> 时间：2012-04-19T22:12:36.577
> 
> 标签：python, user-interface, tkinter

我第一次尝试使用 Tkinter，并尝试在单击按钮时调用一个函数。这是我的代码的一部分。mt 指的是我通过将其附加到标签而使其动态化的标签，以便我可以更改标签的内容。我希望用户能够在输入框中输入内容，点击按钮，然后它将标签更改为输入的内容。

```
 def new(self):
        mt.set("New")
        e1 = Entry(master)
        e1.pack()
    def new_ok(self):
        mt.set("OK")
        #the next part is what I need help with
        if (checks if button has been clicked) button has been clicked:
            mt.set("#what it says in the entry box#") 
```

我该怎么做？我查看了教程并阅读了它们，但没有一个明确承认如何检查按钮是否被按下并做出响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:17:38.683

我不是 Tkinter 奇才，但我在 Tkinter 的模块文档中看到的第一件事是[A Simple Hello World Program](http://docs.python.org/library/tkinter.html#a-simple-hello-world-program)，其中包含您问题的答案。（与大多数 GUI 工具包一样，答案是回调或事件处理函数。）成员函数`say_hi`是`Hello`按钮的回调。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T06:39:16.573

如果问题是：“如何更新标签小部件？”
那么答案就是小部件的`configure`方法。

```
# Tkinter in Python 2.7 & tkinter in 3.2
import Tkinter as tk

class GUI(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)

        bF = tk.Frame(self, bd=8, relief='sunken')
        bF.pack(expand='true', fill='x')
        changeButton = tk.Button(bF, text='Change', bd=4, fg='white',
                                relief='groove', activebackground='green',
                                command=self.change_label)
        changeButton.pack()

        self.entryLabel = tk.Label(self, text='Hello')
        self.entryLabel.pack()

        self.mEntry = tk.Entry(self, bd=4, relief='sunken')
        self.mEntry.pack()

    def change_label(self):
        data = self.mEntry.get()
        self.entryLabel.configure(text=data)

gui = GUI()
gui.mainloop() 
```

你会想让你的 GUI 像这个例子中的类；
这样你就可以使用自我。前缀来引用以另一种方法制作的小部件。

在您的示例中，您可能会说 'mt' is a [control variable](http://infohost.nmt.edu/tcc/help/pubs/tkinter/control-variables.html)。
答案仍然是创建一个类，以便您可以使用 self. 字首。

除非您希望
在更改 Entry 小部件的内容时更新标签，否则控制变量可能不是必需的：

```
import Tkinter as tk

class GUI(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)

        bF = tk.Frame(self, bd=8, relief='sunken')
        bF.pack(expand='true', fill='x')

        var = tk.StringVar()
        var.set('Hello')
        entryLabel = tk.Label(self, textvariable=var)
        entryLabel.pack()

        mEntry = tk.Entry(self, bd=4, relief='sunken', textvariable=var)
        mEntry.pack()

gui = GUI()
gui.mainloop() 
```

# c# - 这是什么意思？“无法将属性‘XXX’中的值转换为‘（无类型）’类型的对象”

> ID：10237573
> 
> 赞同：0
> 
> 时间：2012-04-19T22:12:37.550
> 
> 标签：c#, wpf

我正在尝试绑定一个属性，但我收到了最莫名其妙的错误消息。

```
Cannot convert the value in attribute 'To' to object of type '' 
```

是的，目标类型是一个空字符串。

这是由这条线带来的：

```
<DoubleAnimation Storyboard.TargetProperty="Height"
    To="{TemplateBinding MinHeight}" Duration="0:0:0.6"
    FillBehavior="HoldEnd" AutoReverse="False"/> 
```

我完全困惑了。目标类型如何...未指定？如果它无法确定目标类型，它怎么能尝试转换呢？ **它怎么会不知道目的地类型呢？**

如果我将其更改为数字，例如`To="90"`，则它可以正常工作。我想它知道它应该在那里是什么类型。

任何人有任何见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T17:39:06.547

我想我在[这个问题](https://stackoverflow.com/questions/3002421/binding-to-to-in-storyboard)中找到了部分答案。

DoubleAnimation 不是 FrameworkElement，因此不支持绑定。（我已经看到绑定到 StaticResource 会起作用，因为它是静态的，但非静态绑定会失败。）

所以我认为这可能只是一个不稳定的错误信息。

我将此标记为答案，但如果有人有更好的答案，请继续。如果它比这个更好，我很乐意将您的答案标记为正确。

# javascript - 有没有办法在 Struts 2 中强制使用 JavaScript？

> ID：10237574
> 
> 赞同：2
> 
> 时间：2012-04-19T22:12:39.903
> 
> 标签：javascript, struts2

我在想的是，我想尽可能使用 Struts 2 JSON 结果类型为我的页面加载所有数据。从理论上讲，这将消除或至少大大减少对 JSTL、Struts 2 标记、OGNL、Struts 2 页面映射、Scriptlet 等的使用。如果不是完全纯 HTML 和 JavaScript/JQuery，我的页面将几乎是纯 HTML 和 JavaScript/JQuery。

因此，我想知道 Struts 2 中是否有方法或其他方法要求启用 JavaScript？一个拦截器，也许？有人知道这样的技巧吗？也许如果我使用 HTML 5？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:15:41.677

不，您不能要求从 Struts 框架本身启用 Javascript。但是您可以在您的页面上进行检查，以警告用户需要 Javascript 才能访问该应用程序。

# php - 自定义 PHP 错误处理程序

> ID：10237578
> 
> 赞同：0
> 
> 时间：2012-04-19T22:12:54.873
> 
> 标签：php, class

我试图找到更好的 PHP 错误处理程序，一种在 html 中更容易阅读的错误处理程序，但我在 google 上没有看到任何错误处理程序。

我试着自己做，但弄清楚命令的任务超出了我的时间，我遇到了很多错误。

这是 php 现在产生的垃圾（文件、类和函数名已更改）：

```
Fatal error: Cannot redeclare bbb() (previously declared in /home/user/path/1.php:5) in /home/user/path/1.php on line 26 Call Stack: 0.0309 662280 1\. {main}() /home/user/path/1.php:0 0.0610 5610272 2\. su::aaa() /home/user/path/1.php:21 0.0610 5610752 3\. su::__callStatic() /home/user/path/class.su.php:0 0.0610 5611456 4\. call_user_func_array() /home/user/path/class.su.php:27 0.0610 5611912 5\. user->aaa() /home/user/path/class.su.php:0 0.0628 5670816 6\. user->aaa() /home/user/path/class.user.php:3342 0.0628 5671640 7\. user->aaa() /home/user/path/class.user.php:3407 0.0628 5672464 8\. user->sss() /home/user/path/class.user.php:3449 0.0628 5679576 9\. DA->ccc() /home/user/path/class.user.php:3475 
```

这是一条线，我无法在脑海中很好地解析它以了解实际发生的情况。我希望将这个调用堆栈打印为漂亮的 html。

谢谢，以利亚

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:16:15.000

使用**[`set_error_handler()`](http://il.php.net/manual/en/function.set-error-handler.php)**它是专门为此设计的。定义一个接受以下参数的函数：

```
handler_function ( int $errno , string $errstr [, string $errfile [, int $errline [, array $errcontext ]]] ) 
```

并且必须`set_error_handler()`使用它而不是默认的 PHP 处理程序。请务必先阅读整个[手册条目](http://il.php.net/manual/en/function.set-error-handler.php)！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:23:58.403

你想要的东西有一个干净的实现 [http://il.php.net/manual/en/function.set-error-handler.php](http://il.php.net/manual/en/function.set-error-handler.php)并且可以很容易地定制

编码

```
function myErrorHandler($errno, $errstr, $errfile, $errline) {
    if (! (error_reporting () & $errno)) {
        // This error code is not included in error_reporting
        return;
    }

    switch ($errno) {
        case E_USER_ERROR :
            echo "<b>My ERROR</b> [$errno] $errstr<br />\n";
            echo "  Fatal error on line $errline in file $errfile";
            echo ", PHP " . PHP_VERSION . " (" . PHP_OS . ")<br />\n";
            echo "Aborting...<br />\n";
            exit ( 1 );
            break;

        case E_USER_WARNING :
            echo "<b>My WARNING</b> [$errno] $errstr<br />\n";
            break;

        case E_USER_NOTICE :
            echo "<b>My NOTICE</b> [$errno] $errstr<br />\n";
            break;

        default :
            echo "Unknown error type: [$errno] $errstr<br />\n";
            break;
    }

    /* Don't execute PHP internal error handler */
    return true;
} 
```

如果这不是您想要的，请更好地解释

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T13:25:35.623

我正在寻找的功能是 debug_backtrace。通过在错误处理程序中实现这一点，我能够打印调用堆栈。

# mysql - MySql：查找按列分组的 SUM 的 MAX 值

> ID：10237580
> 
> 赞同：2
> 
> 时间：2012-04-19T22:13:19.393
> 
> 标签：mysql

我有一个表，其中包括名称、项目、类型和每个项目的计数。我需要找到一种方法来确定每种类型中具有 MAX 计数的名称。

示例表：

```
---------------------------------------
| name | item     | type      | count |
| ------------------------------------|
| Dave | carrot   | vegetable | 2     |
| Dave | broccoli | vegetable | 3     |
| Tom  | spinach  | vegetable | 2     |
| Jon  | swiss    | cheese    | 3     |
| Mark | cheddar  | cheese    | 5     |
| Jon  | cheddar  | cheese    | 6     |
| Tony | onion    | vegetable | 3     | 
```

我想找到每种类型中 SUM(count) 最高的每个人的名字。这是我的预期结果：

```
----------------------------
| name | type      | count |
| -------------------------|
| Dave | vegetable | 5     |
| Jon  | cheese    | 9     | 
```

我正在尝试查看是否有一种优雅的方式来执行此操作，而不是查询每个名称然后手动计算 MAX。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T06:48:47.533

这可能不是最佳的，但它非常简单：

```
SELECT name, type, MAX(count) as count FROM (
   SELECT name, type, SUM(count) as count
    FROM mytable
    GROUP BY type, name
) as rank
GROUP BY type; 
```

内部查询返回每个名称和该名称的类型总和，例如：

```
NAME    TYPE    COUNT
Jon     cheese      9
Dave    vegetable   5
Mark    cheese      5
Tony    vegetable   3
Tom     vegetable   2 
```

然后外部查询按类型分组，因此每种类型只返回一个名称，并且 max() 返回该类型的顶部名称。

这不会返回相同的名称，但会为不同类型返回相同的名称，因此如果突然给 Dave 10 in swiss，他会出现在蔬菜和奶酪的顶部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-20T06:27:45.267

首先计算每个名称/类别组合的总数。在子查询或视图中执行此操作。我将选择一个视图来减少代码膨胀，因为它需要不止一次。

```
CREATE VIEW totals AS
SELECT name, type, SUM(count) AS count
FROM yourtable
GROUP BY name, type 
```

```
----------------------------
| 姓名 | 类型 | 计数 |
| --------------------------|
| 戴夫 | 蔬菜| 高分辨率照片| CLIPARTO 5 |
| 托尼 | 蔬菜| 高分辨率照片| CLIPARTO 3 |
| 汤姆 | 蔬菜| 高分辨率照片| CLIPARTO 2 |
| 乔恩 | 奶酪 | 9 |
| 马克 | 奶酪 | 5 |
----------------------------

```

现在您需要找到每种类型的最大计数。

```
SELECT type, MAX(count) AS max_count
FROM totals
GROUP BY type 
```

```
-------------------------
| 类型 | 最大计数 |
| ----------------------
| 蔬菜| 高分辨率照片| CLIPARTO 5 |
| 奶酪 | 9 |
-------------------------

```

现在您只需要在视图中查询`totals`(type, count) 等于第二个结果集中的任何对的所有行。我已经为你完成了大部分工作。我会让你完成它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:17:10.437

没有数据库在我面前，试一试：

```
SELECT * FROM Table T 
  LEFT JOIN (SELECT type, MAX(count) AS max FROM Table GROUP BY type) AS maxType 
  ON T.type = maxType.type 
    AND t.count = max.count 
```

# java - 进行错误处理的最佳方法

> ID：10237583
> 
> 赞同：0
> 
> 时间：2012-04-19T22:13:29.167
> 
> 标签：java, design-patterns, exception-handling, interface, runtimeexception

我正在考虑通过异常实现更好的错误处理方法。当我深入研究代码并想要返回错误时，我有两个选择：

1.  抛出一个扩展运行时异常的异常。
2.  将错误消息对象与我的响应一起传递。这允许每个级别在需要时通过查看错误消息来处理错误。

我喜欢1。但是，假设我创建了一个界面：

```
public interface Interface {
  method1();
  method2();
} 
```

现在，在这种类型的合同中，我还没有看到将方法声明为的接口：

```
method1() throws ExtendedRuntimeException;
method2() throws ExtendedRuntimeException; 
```

指定实现需要处理扩展运行时异常的更简洁的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:20:34.007

您需要一种综合方法。在您的应用程序中设计异常处理机制时，您将需要设计强制实现处理异常的接口。这些是检查异常。

此外，您必须事先决定处理所有异常的层或决定如何处理异常。所有较低层都向上传递异常，即向上冒泡异常。您可以通过创建异常子类或简单地按原样抛出异常来做到这一点。最好是创建一个异常子类，其中包含更多详细信息，如错误代码/消息等。

是的，许多设计都有接口，这些接口确实将 throws 附加到方法定义上。

HTH ~阿尤斯曼

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:43:24.550

Sudoer，恕我直言，您无法控制接口的实现者处理运行时（也称为未经检查）异常。

就像@Ayusman 提到的那样，您可以声明并要求实现者处理检查的异常，但对于运行时异常，它总是有义务他们不需要声明它。此外，对于作为实现者的未经检查的异常，我可以抛出我自己的运行时异常，作为接口设计者，你还没有声明。

这是真的，因为您只声明了一个合同，但您没有足够的上下文来了解可能的运行时异常类型。希望我能在这里传达这个想法。

我发现这些很有用：

*   [http://www.coderanch.com/t/376312/java/java/Interface-Exception-Handling](http://www.coderanch.com/t/376312/java/java/Interface-Exception-Handling)
*   [http://www.coderanch.com/t/143652/Mock-Exam-Errata/certification/who-correct](http://www.coderanch.com/t/143652/Mock-Exam-Errata/certification/who-correct)
*   [http://www.javapractices.com/topic/TopicAction.do?Id=129](http://www.javapractices.com/topic/TopicAction.do?Id=129)

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:55:24.057

关于异常错误处理有很多思想流派。可以在这里找到一篇长但内容丰富的文章：http: [//articles.vconst.com/2009/08/error-handling-and-exceptions-in-java.html](http://articles.vconst.com/2009/08/error-handling-and-exceptions-in-java.html)

他实际上建议为运行时异常放置一个 throws 声明。

# android - Android SQLITE 备忘表

> ID：10237584
> 
> 赞同：0
> 
> 时间：2012-04-19T22:13:31.533
> 
> 标签：android, sqlite

当应用程序未`INSER`在`SQLITE`. 答案就[在这里](https://stackoverflow.com/questions/8909351/unable-to-insert-data-in-sqlite-database-android)。

**问题是：** *备忘录表是什么？*

```
db.execSQL(Create table Memo (ID INTEGER PRIMARY KEY AUTOINCREMENT, sym TEXT, cmp TEXT, cng TEXT); 
```

*有人知道吗？*

# html - css裁剪图像然后按百分比缩放

> ID：10237586
> 
> 赞同：0
> 
> 时间：2012-04-19T22:13:41.657
> 
> 标签：html, css

我正在尝试裁剪（非背景）图像，然后将裁剪后的图像按身体的百分比进行缩放。我的想法是将我网站上的所有徽标和基本图形组合成一个图像，以便浏览器可以缓存图像（第一次下载后更快）。然后，我想相对于正文宽度进行缩放，这样无论用户的显示器尺寸如何，我的网站都会看起来与页面宽度的比例相同。

如果我给出 html & css 然后在之后解释它，这可能会更容易：

```
<html>
<head>
    <style>
    body
    {
        padding: 0px;
        margin: 0px;
        width: 100%
    }
    #crop1
    {
        float: left;
        overflow: hidden;
        border: 1px solid red;
        clear: both;
    }
    #crop1 img
    {
        vertical-align: middle;
        margin: -28px 0px -88px -189px; /*top right bottom left*/
    }
    #scale1
    {
        width: 10%;
        border: 1px solid blue;
    }
    #scale1 img
    {
        vertical-align: middle;
        width: 100%;
    }
    #crop2
    {
        float: left;
        overflow: hidden;
        border: 1px solid green;
        width: 100%;
    }
    #crop2 img
    {
        vertical-align: middle;
        margin: -28px 0px -88px -189px; /*top right bottom left*/
    }
    #scale2
    {
        width: 10%;
        border: 1px solid orange;
        clear: both;
    }
    </style>
</head>
<body>
    <img src="http://www.mathleague.com/help/geometry/IMG00088.gif">
    <div id="scale1"><img src="http://www.mathleague.com/help/geometry/IMG00088.gif"></div>
    <div id="crop1"><img src="http://www.mathleague.com/help/geometry/IMG00088.gif"></div>
    <div id="scale2"><div id="crop2"><img src="http://www.mathleague.com/help/geometry/IMG00088.gif"></div></div>
</body>
</html> 
```

我`http://www.mathleague.com/help/geometry/IMG00088.gif`在这个例子中使用了图像。我不会在我的网站上使用这张图片，但原理是一样的。

所以首先我只是把原始图像，不变的，在调试时给出大小参考：

```
<img src="http://www.mathleague.com/help/geometry/IMG00088.gif"> 
```

将单独的图像缩小到页面宽度的 10% 可以正常工作：

```
<div id="scale1">
    <img src="http://www.mathleague.com/help/geometry/IMG00088.gif">
</div> 
```

并且裁剪图像以仅显示椭圆形也可以正常工作：

```
<div id="crop1">
    <img src="http://www.mathleague.com/help/geometry/IMG00088.gif">
</div> 
```

但我不能只将椭圆缩小到页面宽度的 10%：

```
<div id="scale2">
    <div id="crop2">
        <img src="http://www.mathleague.com/help/geometry/IMG00088.gif">
    </div>
</div> 
```

（这会将椭圆缩小到 10% 的宽度，而不是缩放它）。也许我在最后一行缺少一些简单的 css 属性，或者我需要添加更多`div`的 s. 我被困住了。

这是示例图像：
![示例图片](../Images/6e45f2afee9e2fc4b7b3215ea68712a5.png)

**注意：解决方案必须是跨浏览器兼容的**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:59:43.503

**更新了工作示例（边距需要是百分比）**

以你的方式去做会比你意识到的要复杂一些。对于您的最终尺寸，您需要`img`根据整体所占百分比的倒数重新调整尺寸。然后你必须把它和缩放相乘，然后乘以你的边距的偏移量。

**编辑**下面的代码要准确得多，因为我能够检查和纠正我的数学，并根据[您更简单的图像](http://i.imgur.com/oKtZa.png)进行计算（知道大小和偏移量至关重要）。[新示例](http://jsfiddle.net/vnm9A/57/)更接近于正确的尺寸计算。我在下面进行了调整以显示数学。来发现，计算比我想象的“更容易”，但我部分未能解释的是，即使是顶部和底部的偏移量也应该偏离图像的原始*宽度*，因为宽度是缩放整体的图片。

```
#scale1
{
    width: 10%;
    padding: 0;
    margin: 0;
}

#crop1
{
    overflow: hidden;
    border: 1px solid green;
    width: 100%;
    padding: 0;
    margin: 0;
}

/*Image: 300 W x 209 H
  Offsets: oT = 8, oR = 56, oB = 75, oL = 204
  Icon: 40 w x 126 h */

#crop1 img
{
    width: 750% /* 1 / (40 / 300) [inverse of icon width / image width] */;
    vertical-align: middle;
    /*using the offsets, each has a percentage calculated based solely off 
      the image width, then adjusted based off the width % of the img as 
      calculated above */
    margin: -20%    /* (8 / 300) x 7.5 [the 750%] = 100 x 8 / 40*/
            0       /* right margin seems unnecessary, but if found otherwise, the
                 calculation would be (56 /300) x 7.5 = 100 x 56 / 40*/
            -187.5% /* (75 /300) x 7.5  = 100 x 75 / 40*/
            -510%;  /* (204 / 300)  x 7.5  = 100 x 204 / 40*/
    padding: 0;
    border: 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T23:47:25.413

目前图像没有继承父级的宽度，您可以通过声明'width：inherit;'来明确并强制这样做 图片上：

```
#crop2 img
{
    vertical-align: middle;
    margin: -28px 0px -88px -189px; /*top right bottom left*/
    width: inherit;
} 
```

忘了提一下，您需要重新调整边距以适应新大小的图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T23:23:46.157

改为使用`background-position`和`background-size`属性。

给你的例子：

```
<!DOCTYPE html>

<style type="text/css">
.pentagon, .pentagon_large {
    background: url(IMG00088.GIF);
}
.pentagon {
    width: 110px;
    height: 110px;
    background-position: 0px 0px;
    background-repeat: no-repeat;
}
.pentagon_large {
    width: 220px;
    height: 220px;
    background-position: 0px 0px;
    background-repeat: no-repeat;
    background-size: 300%;
}
</style>

<body>

<div class="pentagon">&nbsp;</div>
<div class="pentagon_large">&nbsp;</div> 
```

# 输出：

![使用此代码输出](../Images/db3bbf66678b99353573f614c8bb9daf.png)

注意：使用 IE9 中的 F12 开发人员工具，您可以编辑值（见图）以快速找到合适的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T15:32:52.140

最后我选择了以下方法：

```
<!DOCTYPE html>
<html>
<head>
    <style>
    body
    {
        padding: 0px;
        margin: 0px;
        width: 100%
    }
    #d2
    {
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        position: absolute;
        overflow: hidden;
    }
    #d1
    {
        bottom: 0;
        right: 0;
        width: 251.59%; /*B*/
        height: 152.31%; /*C*/
        position: absolute;
    }
    #d0
    {
        top: 0;
        left: 0;
        width: 100%; /*A*/
        position: absolute;
    }
    #d0 img
    {
        width: 100%;
        float: left;
    }
    #container
    {
        top: 100px; /*final position of the copped section from the page top (in px)*/
        left: 40%; /*final left position of the copped section relative to page width*/
        display: inline-block;
        position: relative;
        width: 30%; /*final width of the copped selection relative to the page width*/
    }
    #dummy
    {
        margin-top: 51.587%; /*R*/
    }
    </style>
</head>
<body>
    <div id="container"><div id="dummy"></div>
        <div id="d2"><div id="d1"><div id="d0"><img src="http://i.stack.imgur.com/MLWNd.gif"></div></div></div>
    </div>
</body>
</html> 
```

所需的输入是：selection_width、selection_height、selection_top、selection_left 和 image_width，如下所示：

![要裁剪和缩放的图像](../Images/3a1659245bda9309b50a33cf13339846.png)

（image_width 是此处显示的整个图像的宽度）。所以：

```
selection_top:    34 (just inside the boundary so that we do not show the border)
selection_left:   191 (also just inside the boundary so that we do not show the border)
selection_width:  126 (=317-191 where 317 is also just inside the right-side boundary)
selection_height: 65 (=99-34 where 99 is also just inside the bottom boundary)
image_width:      318 
```

并且所需的输出是 A、B、C、R（来自上面代码中的注释）。计算数字给出：

```
A: 100.32%
B: 251.59%
C: 152.31%
R: 51.587% 
```

现在浏览器窗口可以取消最大化和调整大小，椭圆将保持其原始形状，同时始终是页面宽度的百分比，并且从左侧定位页面宽度的百分比。换句话说，浏览器在任何屏幕上看起来总是相同的宽度。请注意，由于渲染不准确，椭圆周围的边框确实显得微弱，即使 selection_* 指定最终图像将刚好在显示的选择边框内。出于这个原因，最好在最终的单个图像中的裁剪选择之间留下几个像素。

现在您可以将整个网站的所有主题图像放在一个图像上，并使用此技术提取各种组件并根据需要定位和缩放它们。这解决了有限并行下载的问题（存在于大多数浏览器中）。我已经做了一个来自这个单一图像的所有形状的例子，对齐以适合页面的宽度：http: [//jsfiddle.net/KsNku/](http://jsfiddle.net/KsNku/)（如果有人遇到不呈现此代码的浏览器，如下所示：[http://i.stack.imgur.com/O50vX.png](https://i.stack.imgur.com/O50vX.png)请让我知道，我将编辑 css 以解决问题）。尝试调整 jsfiddle 浏览器窗口的大小，看看一切看起来如何保持静止，没有任何 javascript！

当然，完全由这种布局组成的网站需要精心设计——用户无法放大任何东西，除非他们可以进一步最大化屏幕。这意味着移动设备将显示页面非常小。如果这是一个问题，那么该技术可以在有限的区域中使用（例如，用于弹出窗口中的图像）。如果您知道您的所有用户都不会使用移动设备访问此站点（可能是因为您有一个单独的移动电话用户子域），那么这种技术应该没问题。

# c# - 如何确定鼠标相对于父元素的悬停位置

> ID：10237587
> 
> 赞同：0
> 
> 时间：2012-04-19T22:13:52.233
> 
> 标签：c#, wpf

我正在为支持拖放的树视图实现拖放。

树中有文件夹和文件。当我拖过文件夹底部的 25% 时，我希望它重新排序。当我拖动树视图项的顶部 75% 时，我希望它把内容*放到*文件夹中。

如何确定我在元素中的位置？这是我的尝试不起作用：

```
 private bool ShouldReorder(TreeViewItem targetItem)
    {
        var relativePosition = PointToScreen(Mouse.GetPosition(targetItem));
        return relativePosition.Y/targetItem.ActualHeight < 0.25;
    } 
```

此代码的相对位置为负。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:28:34.407

将其转换为屏幕坐标后，您可以将其转换回父控件的客户端坐标

```
Parent.PointToClient(screenpt) ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T23:22:59.403

我使用以下代码来消费全局鼠标事件（此代码也可以获取全局 x/y 位置数据，而不管窗口焦点如何）：

[http://www.codeproject.com/Articles/7294/Processing-Global-Mouse-and-Keyboard-Hooks-in-C](http://www.codeproject.com/Articles/7294/Processing-Global-Mouse-and-Keyboard-Hooks-in-C)

对于我的程序：

[http://www.codeproject.com/Articles/347795/Inactivity-Logoff](http://www.codeproject.com/Articles/347795/Inactivity-Logoff)

# iphone - stringByAddingPercentEscapesUsingEncoding: 的反面是什么？什么函数取出 % 转义？

> ID：10237588
> 
> 赞同：2
> 
> 时间：2012-04-19T22:14:30.913
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

与此相反的是什么：

```
modifiedTitle = [modifiedTitle stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

以便它使 %20 显示为空格，而 %26 显示为 &。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T22:17:47.620

伙计……如果文档中仅将两种相关方法并排列出……

# [等一下。](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/uid/20000154-SW39)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-19T22:17:17.347

您正在寻找的 API 是[`stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding`](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:17:18.593

所有网络 URL 都以某种方式编码。其中最常见的是 UTF-8。您可以仔细阅读[Encoding Standards](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm)，但要知道 %20 是一个空格，而 %26 是 UTF-8 中的 & 符号，因此请使用`[myString stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];`它来摆脱它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-25T10:39:14.587

这是替代方案：

```
NSString *url = [modalData.imageURL stringByAddingPercentEncodingWithAllowedCharacters:[NSCharacterSet URLFragmentAllowedCharacterSet]]; 
```

文档中还有其他字符集。

# google-maps - 谷歌地图折线和标记在一起

> ID：10237589
> 
> 赞同：3
> 
> 时间：2012-04-19T22:14:42.203
> 
> 标签：google-maps

我有这个用于折线的代码，它工作得很好。如何为每个位置点添加标记？

```
var userCoor = [
<?php
for($i=0; $i<sizeOf($lat); $i++)
echo "new google.maps.LatLng({$lat[$i]}, {$long[$i]}),";
?>
];

var userCoordinate = new google.maps.Polyline({
path: userCoor,
strokeColor: "#FF0000",
strokeOpacity: 1,
strokeWeight: 2
});

userCoordinate.setMap(map); 
```

我试过了

```
var infowindow = new google.maps.InfoWindow();

var marker, i;

for (i = 0; i < userCoor.length; i++) {  
  marker = new google.maps.Marker({
    position: new google.maps.LatLng(userCoor[i][1], userCoor[i][2]),
    map: map
  });

  google.maps.event.addListener(marker, 'click', (function(marker, i) {
    return function() {
      infowindow.setContent(userCoor[i][0]);
      infowindow.open(map, marker);
    }
  })(marker, i));
}
} 
```

标记似乎不见了？知道怎么做吗？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T22:44:23.973

我在这里用一些虚假数据进行了测试，似乎没有问题。不同之处在于我`userCoorPath`用于折线并`userCoor`设置标记。我正在重复这些信息，但它们的使用方式不同。一个是 LatLngs 数组，另一个是字符串数组和两个浮点数。

[http://jsfiddle.net/nSf9N/](http://jsfiddle.net/nSf9N/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:16:52.837

您没有设置标记`icon`属性。

此外，您正在覆盖标记变量。也许这与它有关。尝试在循环内移动您的标记变量定义。

# php - 可以根据 YML 文件生成实体类吗？

> ID：10237592
> 
> 赞同：0
> 
> 时间：2012-04-19T22:14:52.717
> 
> 标签：php, symfony, doctrine-orm

我想根据存储在 YML 文件中的元数据创建一个实体类。这（很容易）可能吗？

我一直在挖掘 Doctrine 库，发现`Doctrine\ORM\Tools\EntityGenerator`and `Doctrine\ORM\Mapping\ClassMetadataInfo`，但我还没有完全弄清楚如何正确使用它们，或者即使它们是我*应该*使用的类。

需要考虑的一些事项：

*   我的 YML 文件不在捆绑目录中
*   我无法使用 CLI - 我需要能够在常规 PHP 类中执行此操作（可能是 Symfony2 服务）
*   我想将生成的实体存储在自定义目录中（即：不在捆绑目录中）

在我重新发明太多轮子之前，我想我会在这里征求意见 :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T20:32:02.200

看看 EntityGenerator 文档，那里也有一个例子：

[http://www.doctrine-project.org/api/orm/2.2/class-Doctrine.ORM.Tools.EntityGenerator.html](http://www.doctrine-project.org/api/orm/2.2/class-Doctrine.ORM.Tools.EntityGenerator.html)

# google-plus - 在新标签或新窗口中打开 Google Plus 代码段

> ID：10237599
> 
> 赞同：1
> 
> 时间：2012-04-19T22:15:16.517
> 
> 标签：google-plus, google-plus-one

当用户点击 +1 按钮时，会打开一个片段，让用户有机会在 Google Plus 上发布关于她/他的 +1 的信息。

有没有办法让片段作为新标签或新窗口打开，而不是作为 +1 按钮所在的初始页面中的片段打开？

这一定是可能的，因为 Sharethis ( [http://sharethis.com/publishers/get-sharing-tools](http://sharethis.com/publishers/get-sharing-tools) ) 就是这样做的：当您点击 Google Plus 按钮时，它会记录 +1 并在新的页。

任何人都知道如何做类似的事情？

提前谢谢大家！最好的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T23:31:52.257

看起来 ShareThis 正在使用在新窗口中打开共享对话框的共享 URL。它会按照您的描述工作，但与 +1 按钮不太一样。

要使用共享链接，请向您的网站添加一个符合[Google+ 按钮政策](http://www.google.com/webmasters/+1/button/policy.html)的链接元素。将 href 属性设置为`[https://plus.google.com/share?url=](https://plus.google.com/share?url=){url encoded share target}`

例如，链接到[https://plus.google.com/share?url=http%3A%2F%2Fexample.com](https://plus.google.com/share?url=http%3A%2F%2Fexample.com)将允许您[在 Google+ 上分享 example.com：（![Google+ 分享按钮](../Images/a2a601fd1565cba9e2f00c81c89b08bd.png)](https://plus.google.com/share?url=http%3A%2F%2Fexample.com)是的，这是一个有效的演示）。

查看[官方文档](https://developers.google.com/+/plugins/share/#sharelink)了解更多信息。

如果您使用这种方法，请注意它不能直接替代 +1 按钮。该链接在 Google+ 上共享目标 URL，但实际上并未 +1 目标页面。只有 +1 按钮可以为页面 +1。

# java - 找不到在其他包中声明的活动

> ID：10237606
> 
> 赞同：2
> 
> 时间：2012-04-19T22:16:00.873
> 
> 标签：java, android, package

在我的应用程序中单击一个按钮时，我想从另一个包启动一个活动。

这是我的意图：

```
 final Intent myIntent = new Intent(getApplicationContext(), com.facebook.android.Places.class) 
```

这是我的清单：

```
<activity android:name=".com.facebook.android.Places"
            > </activity> 
```

但我得到了`unable to find explicit activity com.mypackage\com.facebook.android.Places`。

从另一个包开始活动是不可能的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:23:58.263

不要从另一个库项目启动 Activity：

创建你自己的子类：

```
public class MyPlaces extends com.facebook.android.Places {

@Override
   public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      ...
   }
} 
```

现在在您的清单中声明您的新活动：

```
<activity android:name=".MyPlaces"> </activity> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T22:38:12.027

```
<activity android:name=".com.facebook.android.Places"> </activity> 
```

com.facebook.android 包中的 Places 活动是否存在？还是在 com.mypackage.com.facebook.android 中？

如果 Places 类在 com.facebook.android 中，请将清单条目更改为

```
<activity android:name="com.facebook.android.Places"> </activity> 
```

您不必以“。”开头的名称。

# python - Python MYSQLDB 插入语法错误

> ID：10237608
> 
> 赞同：1
> 
> 时间：2012-04-19T22:16:03.337
> 
> 标签：python, mysql

我正在尝试将数据插入到我的数据库中，但使用以下代码出现 MYSQL 语法错误：

```
import MySQLdb
db=MySQLdb.connect(host="localhost",user="root",passwd="",db="database")
cursor = db.cursor()
sql = "INSERT INTO table1('col1','col2') values ('val1','val2');"
cursor.execute(sql)
db.commit() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:19:02.743

列名周围没有引号。

```
INSERT INTO table1(col1, col2) VALUES ('val1', 'val2'); 
```

您可以在列名周围使用反引号，但不能使用单引号。

# vim - 如何在 CSV 表上运行 Vim 中的 ':sort u' 命令，但只使用特定列中的值作为排序键？

> ID：10237612
> 
> 赞同：10
> 
> 时间：2012-04-19T22:16:22.013
> 
> 标签：vim

我正在寻找一个更具体的`:sort u`命令版本，它允许从文件中删除所有重复的行。我正在使用 CSV 文件，并希望删除在其第二列条目中具有重复项的所有行。换句话说，如果两行在第二列中具有相同的值，则它们被声明为重复。

例如，对于以下文件：

```
a,1,b
g,1,f
c,1,x
i,2,l
m,1,k
o,2,p
u,1,z 
```

有问题的命令应该产生：

```
a,1,b
i,2,l 
```

选择要保留的特定行并不重要，只要第二列条目都是唯一的。

什么 Vim 命令会产生上面的输出？

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-20T02:48:28.310

由于不可能在一次`:sort`命令运行中实现所讨论的转换，因此让我们将其视为一个两步过程。

**1.**第一步是按第二列的值对行进行排序（用逗号与第一列分隔）。为此，我们可以使用该`:sort`命令，传递与第一列和以下逗号匹配的正则表达式：

```
:sort/^[^,]*,/ 
```

比较在`:sort`每行指定模式匹配之后开始的文本，它为我们提供了所需的排序行为。要按数字而不是按字典顺序比较值，请使用以下`n` 标志：

```
:sort n/^[^,]*,/ 
```

**2.**第二步涉及遍历已排序的行，并在第二列中具有相同值的每个连续行块中删除除一个之外的所有行。在命令上构建我们的实现很方便`:global`，该命令在匹配特定模式的每一行上执行给定的 Ex 命令。出于我们的目的，如果该行在第二列中包含与以下行相同的值，则可以删除该行。这种形式化——伴随着逗号不能出现在列值中的初始假设——为我们提供了以下模式：

```
^[^,]*,\([^,]*\),.*\n[^,]*,\1,.* 
```

如果我们在`:delete`满足此模式的每一行上运行命令，从上到下按排序顺序排列，我们将只有一行用于第二列中的每个不同值：

```
:g/^[^,]*,\([^,]*\),.*\n[^,]*,\1,.*/d_ 
```

**3.**最后，这两个步骤可以组合在一个 Ex 命令中：

```
:sort/^[^,]*,/|g/^[^,]*,\([^,]*\),.*\n[^,]*,\1,.*/d_ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T10:54:09.523

```
:sort /\([^,]*,\)\{1}/
:g/\%(\%([^,]*,\)\{1}\1.*\n\)\@<=\%([^,]*,\)\{1}\([^,]*\)/d 
```

首先按索引为 1 的列排序。第二个匹配列索引 1 与下一行列索引 1 匹配的任何行并将其删除。

列索引是 1 中的`{1}`。它重复了3次。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-27T13:14:31.760

使用第二列

```
(visual + !sort) 
```

使用第三列

```
sort -k 3 
```

或者

```
:sort /.*\%3v/ 
```

或者

```
select the lines you wish to sort using the Capital V command. Then enter
!sort -k 3n 
```

或跳过每行中的前两个单词并按以下内容排序：

```
:%sort /^\S\+\s\+\S\+\s\+/ 
```

或者

按最后一列排序

```
:%sort /\<\S\+\>$/ r 
```

或使用其他程序，如 MS OFFICE 或 OPENOFFICE

# javascript - 在 PhoneGap 上使用 jQuery 进行屏幕抓取

> ID：10237614
> 
> 赞同：0
> 
> 时间：2012-04-19T22:16:24.887
> 
> 标签：javascript, jquery, cordova

我正在尝试在 PhoneGap 应用程序中使用 jquery 进行屏幕抓取。问题是当我将目标 HTML 加载到当前 dom 以便我可以使用选择器时，它会尝试执行 javascript：

```
 $(function() {
            $.get('http://www.bloomberg.com/quote/csfb:ind', function(data) {
                var elements = $("<div>").html(data)[0].getElementsByClassName("price")[0];
            });
        }); 
```

get 工作正常并拉入 html，但一旦开始加载，它就会尝试执行 javascript。

反正有没有去掉所有的javascript标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:23:50.447

这似乎是最可靠的方法，因为您自己提出的任何解析可能并非在所有情况下都有效。

[使用 JS 正则表达式从 html 中删除所有脚本标签](https://stackoverflow.com/questions/6659351/removing-all-script-tags-from-html-with-js-regular-expression)

如果我从该答案中复制 stripScripts 函数：

```
function stripScripts(s) {
    var div = document.createElement('div');
    div.innerHTML = s;
    var scripts = div.getElementsByTagName('script');
    var i = scripts.length;
    while (i--) {
        scripts[i].parentNode.removeChild(scripts[i]);
    }
    return div.innerHTML;
}
$(function () {
    $.get('http://www.bloomberg.com/quote/csfb:ind', function (data) {
        var elements = $("<div>").html(stripScripts(data))[0].getElementsByClassName("price")[0];
    });
}); 
```

# javascript - 获取数组中维度的大小

> ID：10237615
> 
> 赞同：22
> 
> 时间：2012-04-19T22:16:28.183
> 
> 标签：javascript, multidimensional-array

如何获得给定多维数组的维度？
编辑：它可以是 1、2 或 3 维，但每个子数组具有相同的长度。

即对于

```
var a = [[1,1,1], [1,1,1]] 
```

将是 [2,3]

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-19T22:20:22.770

```
const dimensions = [ arr.length, arr[0].length ]; 
```

如果您知道`length`内部数组永远不会改变，这很有效。

* * *

如果内部数组的维度不是静态的（[锯齿状数组](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/arrays/jagged-arrays)），您可以组合[`Array.reduce`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce)并[`Math.max`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/max)计算最大维度：

```
const dimensions = [
    arr.length,
    arr.reduce((x, y) => Math.max(x, y.length), 0)
]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-19T22:26:39.917

考虑到子列表可以有不同的大小，获取最小大小或根据需要使其最大

```
function size(ar){
    var row_count = ar.length;
    var row_sizes = []
    for(var i=0;i<row_count;i++){
        row_sizes.push(ar[i].length)
    }
    return [row_count, Math.min.apply(null, row_sizes)]
}
size([[1, 1, 1], [1, 1, 1]]) 
```

输出：

```
[2, 3] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-20T21:38:28.460

这适用于任何维度（假设每个子数组具有相同的长度）：

```
function getDim(a) {
    var dim = [];
    for (;;) {
        dim.push(a.length);

        if (Array.isArray(a[0])) {
            a = a[0];
        } else {
            break;
        }
    }
    return dim;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-19T22:19:43.540

```
var dim = [
    a.length,
    a[0].length
]; 
```

这应该可行，因为每个子数组的长度相同，但是，如果不是这种情况，您可能想要执行以下操作：

```
function findDim(a){
    var mainLen = 0;
    var subLen = 0;

    mainLen = a.length;

    for(var i=0; i < mainLen; i++){
        var len = a[i].length;
        subLen = (len > subLen ? len : subLen);
    }

    return [mainLen, subLen];
}; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-05-18T00:30:10.290

获取多维数组的元素个数就这么简单...

```
var Size = a.join(',').split(',').length; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-10-25T22:27:50.247

在您的情况下，您可以简单地使用`arr.length`并`arr[0].length`找到宽度和深度。

通常，数组将具有可变的深度，这使得有必要使用递归遍历整个数组。

我创建了一个`prototype method`来`Object`确定数组的深度。要使用它，只需调用`myArray.dimensionsDeep()`. 它适用于`Objects`和`Arrays`。

```
Object.prototype.isMultidimensional = function()
{
    return this.constructor.name !== "String" && Object.keys(this).some((i) => { return this[i].length > 0; });
}

Object.prototype.dimensionsDeep = function()
{
    if (typeof Object.dimensions === 'undefined')
    {
        if (!this.length)
            return 0;
        Object.dimensions = 0;
        Object.currentLevel = 0;
    }
    Object.keys(this).forEach((i) =>
    {
        if (this[i].isMultidimensional())
        {
            Object.currentLevel++;
            if (Object.currentLevel > Object.dimensions)
                Object.dimensions = Object.currentLevel;
            this[i].dimensionsDeep();
        }
    });
    Object.currentLevel--;
    if (Object.currentLevel < 0)
    {
        delete(Object.currentLevel);
        var temp = Object.dimensions;
        delete(Object.dimensions);
        return temp + 1;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-08-06T02:07:16.290

此函数将检查数组是否有效（不是标量也不是字符串）以及该数组的元素是否有效（它们具有相同的长度），然后在满足所有条件时给出维度，否则抛出错误。

```
 function getDim(x){
    dim=[]
    try {
        // throw error if the passed variable is a string or a scalar
        if((isFinite(x) && !x.length) || typeof(x)=='string') throw  'This is a scalar or a string  not an array!';
        // loop over the array to extract length of each element.
        // if we get an element that is not an array, return the found dimensions 
        while (x){

            dim.push(x.length)
            currentLevel=x
            x=Array.isArray(x[0])?x[0]:false;
            // check if all elements of the array are of equal dimention. If not, throw an error
            ans=currentLevel.every((value,index,arr)=>{ return value.length==x.length}) ;
            if(!ans) throw 'elements of the array are not of equal dimension !'

        }
        return dim
    } catch (error) {
        return error 
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-19T22:20:56.517

```
var a = [[1,1,1], [1,1,1]];
var size=[];
while(s=a.pop) size.push(s.length); 
```

或者如果你想有里面的长度`a`：

```
var a = [[1,1,1], [1,1,1]];
for(i in a) a[i]=a[i].length; 
```

编辑：对不起，我不在主题中。以下代码计算二维数组的最大行和列。

```
var innerSize = 0, i=0, l=a.length, l2;
for(;i<l;i++) if(innerSize<(l2=a[i].length)) innerSize = l2
[l, innerSize] 
```

如果您想要最小尺寸，您可以更改为`<`。`>`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-08-05T13:52:09.263

假设所有维度都相同，您还可以执行递归函数来计算数组的形状：

```
arrayShapeRecursive = arr => {
  return arr.length ? [...[arr.length], ...arrayShapeRecursive(arr[0])] : [];
} 
```

# php - 正则表达式：解析锚点中不包含 img 的链接

> ID：10237617
> 
> 赞同：0
> 
> 时间：2012-04-19T22:16:36.977
> 
> 标签：php, regex, parsing, preg-match, regular-language

我正在尝试解析一个普通链接，但有时除了该链接之外，还有一个类似的链接，而不是文本包含图像。

我一直在使用这种模式：`"#_blank\">(.*?)</a>#is`，但这也与锚中包含图像的链接相匹配。

**我怎么能只解析那些不包含图像的？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:37:02.567

`<a href=".*?">(?!<img.*?>).*?</a>`

[http://regexr.com?30n1q](http://regexr.com?30n1q)

How about this?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:24:32.303

如果您不希望在 a 标签内匹配任何标签，请尝试从页面上的所有 a 标签中获取内部 html：

```
#<a [^>]+>([^<]+)</a>#si 
```

根据您的评论...

为了避免怪物正则表达式，我可能会做的是使用上面的然后这样做：

```
$output = strip_tags( $match[1], '<b><i><u>' ); 
```

添加其他允许的标签来品尝。这种方法还确保最终字符串中没有讨厌的标签。

# ios - EAGLView.h 未出现在 ios 5.0 中

> ID：10237619
> 
> 赞同：3
> 
> 时间：2012-04-19T22:16:39.783
> 
> 标签：ios, opengl-es

我正在尝试在 xcode 4 中导入“EAGLView.h”，并按照书中[http://www.amazon.com/Learning-iOS-Game-Programming-Hands-On/dp/0321699424中教程给出的说明进行操作/ref=sr_1_1?ie=UTF8&qid=1334873430&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0321699424)。这本书是为以前版本的 xcode 编写的，所以我想知道 EAGLView.h 类是否已被淘汰，或者我需要做一些特殊的事情来导入它？

当我创建新项目时，我选择了 OpenGL 游戏，如果它有什么不同的话。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-20T15:02:43.403

正如我在[这个答案](https://stackoverflow.com/a/8438138/19679)中解释的那样，EAGLView 不是内置的 Cocoa Touch 类。Apple 开始为他们在初始示例应用程序中使用的自定义 UIView 使用该名称，因此许多人复制并粘贴了该代码，以至于许多开发人员开始认为它已内置到系统中。

一般来说，这些自定义 UIView 的共同点是它们`+layerClass`以这种方式覆盖了方法：

```
+ (Class)layerClass 
{
    return [CAEAGLLayer class];
} 
```

这表明不是使用标准的 CALayer 来支持这个 UIView 子类，而是这个特定的 UIView 将由一个 CAEAGLLayer 支持。CAEAGLLayers 是 OpenGL ES 渲染内容的宿主，因此您的 OpenGL ES 应用程序需要这样的东西。

# python - python中类定义中的复制函数

> ID：10237620
> 
> 赞同：0
> 
> 时间：2012-04-19T22:16:42.180
> 
> 标签：python

我正在为多项式做一个类，我有一个复制函数的问题。它假设创建 Poly 对象的副本并返回对新 Poly 对象的引用。我真的坚持这个复制想法。谢谢你的帮助

```
class Poly:

    def __init__ (self, p):
        self.a = p
        self.deg= len(p) -1
        if len(p) == 1 and p[0] == 0:
            self.deg = -1

    def evalPoly(self,x0):
        ''' evaluates the polynomial at value x'''
        b=0
        for coefficients in reversed(self.a):
            b=b*x0+int(coefficients)
        return b

    def polyPrime(self):
        '''replaces the coeffiecients of self with the coefficients           
        of the derivative polynomial '''
        if self.deg == 0:
            return np.zeroes(1,float), 0
        else:
            newdeg=self.deg-1
            p=[i*self.a[i] for i in range(1,self.deg+1)]
            p=str(p)[1: -1]
            p=eval(p)
        return p

    def copy(self):
        return Poly(self.a) 
```

我被困在如何创建 Poly 对象的副本并返回对新 Poly 对象的引用

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T22:27:16.513

我认为您遇到的问题是，作为`self.a`一个列表，您在新的 Poly 对象的实例化中传递了对该列表的引用。

您应该复制列表并提供该副本以实例化对象：

```
import copy

class Poly:
    ...
    def copy(self):
        return Poly(copy.copy(self.a)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T22:26:14.797

问题实际上隐藏在`__init__()`.

```
 self.a = p[:] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T22:28:34.017

Python 中的赋值语句不复制对象，它们在目标和对象之间创建绑定。对于可变或包含可变项的集合，有时需要一个副本，以便可以更改一个副本而不更改另一个副本。

查看复制模块：

[http://docs.python.org/library/copy.html](http://docs.python.org/library/copy.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T22:32:11.350

你能详细说明为什么它不起作用吗？这对我来说非常有效：

```
class Poly(object):

    def __init__ (self, p):
        self.a = p
        self.deg= len(p) -1
        if len(p) == 1 and p[0] == 0:
            self.deg = -1

    def evalPoly(self,x0):
        ''' evaluates the polynomial at value x'''
        b=0
        for coefficients in reversed(self.a):
            b=b*x0+int(coefficients)
        return b

    def polyPrime(self):
        '''replaces the coeffiecients of self with the coefficients           
        of the derivative polynomial '''
        if self.deg == 0:
            return np.zeroes(1,float), 0
        else:
            newdeg=self.deg-1
            p=[i*self.a[i] for i in range(1,self.deg+1)]
            p=str(p)[1: -1]
            p=eval(p)
        return p

    def __str__(self):
        return "%s %s" % (self.a, self.deg)

    def copy(self):
        return Poly(self.a)

if __name__ == "__main__":
    p = Poly((1,3))
    print p
    x = p.copy()
    print x 
```

编辑：好的，我现在看到他传递了一个可变的列表，这是普遍的共识。

# php - PHP中带有CURL的随机408 http代码

> ID：10237626
> 
> 赞同：2
> 
> 时间：2012-04-19T22:16:55.043
> 
> 标签：php, curl, random

我在 php 中发出的 CURL 请求有问题。问题是它在随机时间返回超时。我注意到的是，在我添加自定义错误页面后，404 自定义页面可以工作，但使用 curl 完成后 408 页面什么也不返回。

404 页面示例：[http ://emailingrestauraweb.com/qweqwe](http://emailingrestauraweb.com/qweqwe)

下面是我的php代码：

```
$strCookie = 'PHPSESSID=' . $this->SessionID;
$curl_log = fopen("curl.txt", 'w');
//Setup connection
$curl = curl_init();
curl_setopt_array($curl,array(
        CURLOPT_URL => $URL,
        CURLOPT_USERAGENT=>$this->UserAgent,
        CURLOPT_POST =>true,
        CURLOPT_POSTFIELDS => http_build_query($arrParams, null, '&'),
        CURLOPT_COOKIE => $strCookie,
        CURLOPT_COOKIESESSION=>1,
        CURLOPT_HEADER => 1,
        CURLOPT_VERBOSE         => 0,           // Logs verbose output to STDERR
        CURLOPT_SSL_VERIFYPEER  => 0,           // Do not verify certificate
        CURLOPT_TIMEOUT => 300,
        CURLOPT_CONNECTTIMEOUT=>260,
        CURLOPT_NOSIGNAL => 1,
        CURLOPT_RETURNTRANSFER=>1
    ));

    //Send request
    $result_json = curl_exec($curl);
    $error_code =curl_getinfo($curl, CURLINFO_HTTP_CODE);
    curl_close($curl); 
```

我尝试了所有我不知道为什么会发生这种情况的方法，而且它也是随机的。

# 更新 1

我在 2 个 slicehost 切片上运行脚本。我从一个切片到另一个切片向 api 发出请求。api 是一个用于发送电子邮件的 OEMPRO 软件。我知道 408 表示超时，但这似乎是随机的，而且大多数时候它像块一样重复，我想知道这是否可能是该软件可能使用的东西。

这个问题是在我运行 OEMPRO 的域过期 3 天之后发生的，然后它又回来了，现在我遇到了这个问题......

感谢所有的答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T11:43:54.613

您说您的域已过期 3 天。这很可能是 DNS 解析问题。给它 24-48 小时，让我们知道是否有任何变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:19:01.933

408 通常不返回（包含）响应正文。服务器只想关闭与您的连接，不想再为您的缓慢请求而烦恼。

当然，该标准允许传递一个主体，如果您保守地阅读它，它甚至应该返回该实体以进行解释，但是，不要依赖它。反正没有消息。而是重试请求。

# list - 将规则转换为列表

> ID：10237644
> 
> 赞同：0
> 
> 时间：2012-04-19T22:18:06.360
> 
> 标签：list, prolog

我想从规则中获取数据到一个列表中以便进一步处理，例如我有：

course_meetings（comm401，教程，t07，mohamed_esameldin，'t07 教程'）。course_meetings（comm401，教程，t08，sally_mahmoud，'t08 教程'）。course_meetings（comm401，教程，t09，mohamed_esameldin，'t09 教程'）。course_meetings（comm401，教程，t10，sally_mahmoud，'t10 教程'）。course_meetings（comm401，讲座，all_group_4，dr_amr_talaat，'讲座 1'）。

我想将此规则转换为如下列表： [[comm401,tutorial,t07,mohamed_esameldin,'tutorial for t07'], [comm401,tutorial,t08,sally_mahmoud,'tutorial for t08'], [comm401,tutorial, t09,mohamed_esameldin,'t09 教程']]

在此先感谢您的帮助，我是序言的新手，希望我的问题不是模糊的，如果有更好的方法来处理这些数据，请指导我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:21:42.340

尝试`?- findall([A,B,C,D,E], course_meetings(A,B,C,D,E), L).`

# php - PHP：为什么 URL 缺少一个部分？

> ID：10237646
> 
> 赞同：0
> 
> 时间：2012-04-19T22:18:16.010
> 
> 标签：php, wordpress, url

我正在尝试使用 TimThumb 在我的博客上显示图像

```
<?php the_title(); ?>'><img src="<?php bloginfo('template_directory'); ?>/timthumb.php?src=<?php echo catch_that_image() ?>&w=290&h=160 
```

以上是我使用的代码

问题是图像不显示，因为 URL 是这样的。

```
http://myurl.com/wp-content/themes/ThemeName/timthumb.php?src=&w=290&h=160 
```

例如，其中假设是这样的

```
http://myurl.com/wp-content/themes/ThemeName/timthumb.php?src=http://myurl.com/wp-content/uploads/i0n1c.png&w=290&h=160 
```

如您所见，上面缺少部分`src=`，缺少的部分是这段`<?php echo catch_that_image() ?>`代码

有什么我必须添加才能使其工作的吗？

更新：

这是我用来抓取图像的功能

```
function catch_that_image() {
  global $post, $posts;
  $first_img = '';
  ob_start();
  ob_end_clean();
  $output = preg_match_all('/<img.+src=[\'"]([^\'"]+)[\'"].*>/i', $post->post_content, $matches);
  $first_img = $matches [1] [0];

  if(empty($first_img)){ //Defines a default image
    $first_img = "/images/default.jpg";
  }
  return $first_img;
} 
```

这是调用图像 URL 路径的代码。

```
<?php echo catch_that_image() ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:20:27.953

> 我已经单独测试了这段代码，它工作得很好

该代码应该输出变量，因此您在另一个上下文中执行此操作，该值已正确设置。

更新：

你检查过*生成的源代码*吗？你在这里有额外的反引号：

```
?src='<?php echo $image[0]; ?>'&w=
     _                        _ 
```

# performance - SQL Server 中的“或”是否短路？

> ID：10237647
> 
> 赞同：3
> 
> 时间：2012-04-19T22:18:16.407
> 
> 标签：performance, sql-server-2005, boolean-logic, short-circuiting

是否像 vb 一样进行“或”比较工作。我的意思是如果他检查每一个或者如果第一个是假的

喜欢

```
DECLARE @var1 bit;
SET @var1=1
DECLARE @var2 bit;
SET @var2=1

(@var1=1 or @var2=1)
AND ... 
```

所以，@var 等于 1，我们不需要检查 var2，但是 sql server 会做检查吗？

它关于查询的优化（和服务器的内存）

保护你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T05:33:42.967

在大多数情况下，是的，SQL Server 确实对 AND 和 OR 语句使用短路，但有时操作不会按照您期望的顺序发生。这很容易通过以下方式进行测试：

```
SELECT '"Divide By Zero" error' AS [test] WHERE (1 / 0 = 1)

SELECT 'NO "Divide By Zero" error' AS [test] WHERE (1 = 1) OR (1 / 0 = 1) 
```

您可以在这里找到更深入的分析，作者 Gianluca Sartori：[http ://www.sqlservercentral.com/articles/T-SQL/71950/](http://www.sqlservercentral.com/articles/T-SQL/71950/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T03:21:12.627

从[微软连接](https://connect.microsoft.com/SQLServer/feedback/details/724305/add-support-for-and-then-and-or-else-logical-operators-in-tsql)：

感谢您的反馈意见。我们今天在 SQL Server 中支持的逻辑运算符是 ANSI SQL 标准中指定的，并且几乎每个数据库系统都支持这些逻辑运算符。我们不打算扩展它来支持更多非常规的逻辑运算符。如果要有条件地评估表达式，请在 SQL Server 中使用 CASE 表达式，例如：

where case when then (select 1 where ) when then (select 2 where ) ... end = 1

CASE 表达式保证按顺序计算 WHEN/THEN 子句。

# wpf - 如何在 Windows 7 中将 Chevron 再现为 CheckBox 控件？

> ID：10237648
> 
> 赞同：1
> 
> 时间：2012-04-19T22:18:24.107
> 
> 标签：wpf, wpf-controls, expression-blend

我一直在努力尝试重新创建在*Windows 7中**Windows Explorer的**Computer*部分中使用的部分标题。

 ***（这可以通过打开一个新的资源管理器窗口并选择计算机来找到。视图应该是瓷砖，分组方式应该是类型。这将给出一个“硬盘驱动器”部分。我正在尝试重新创建该 V 形和标题*

我创建了以下资源字典：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:Framework.Commons.Controls">

    <Style x:Key="ChevronBase" TargetType="{x:Type Path}">
        <Setter Property="StrokeThickness" Value=".75" />
        <Setter Property="Stretch" Value="Fill" />
        <Setter Property="RenderTransformOrigin" Value="0,0" />
        <Setter Property="Width" Value="6" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="HorizontalAlignment" Value="Left" />
        <Setter Property="Data" Value="M 0 3 L 6 3 L 3 6 Z" />
    </Style>

    <Style x:Key="ChevronOpen"
           BasedOn="{StaticResource ResourceKey=ChevronBase}"
           TargetType="{x:Type Path}">
        <Setter Property="Fill" Value="Black" />
        <Setter Property="LayoutTransform">
            <Setter.Value>
                <TransformGroup>
                    <ScaleTransform />
                    <SkewTransform />
                    <RotateTransform Angle="-45" />
                    <TranslateTransform />
                </TransformGroup>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ChevronClosed"
           BasedOn="{StaticResource ResourceKey=ChevronBase}"
           TargetType="{x:Type Path}">
        <Setter Property="Stroke" Value="#FF808080" />
        <Setter Property="Fill" Value="Transparent" />
        <Setter Property="LayoutTransform">
            <Setter.Value>
                <TransformGroup>
                    <ScaleTransform />
                    <SkewTransform />
                    <RotateTransform Angle="-90" />
                    <TranslateTransform />
                </TransformGroup>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ChevronCheckBox" TargetType="{x:Type CheckBox}">
        <Setter Property="SnapsToDevicePixels" Value="true" />
        <Setter Property="OverridesDefaultStyle" Value="true" />
        <Setter Property="IsChecked" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type CheckBox}">
                    <Grid Background="Transparent">
                        <Path x:Name="ChevronOpen"
                              Style="{StaticResource ResourceKey=ChevronOpen}"
                              Visibility="Collapsed" />

                        <Path x:Name="ChevronClosed"
                              Style="{StaticResource ResourceKey=ChevronClosed}"
                              Visibility="Collapsed" />

                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CheckStates">
                                <VisualState x:Name="Checked">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ChevronOpen" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Unchecked">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="ChevronClosed" Storyboard.TargetProperty="(UIElement.Visibility)">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}" />
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                                <VisualState x:Name="Indeterminate" />
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</ResourceDictionary> 
```

我已将样式添加到复选框中，如下所示：

```
<Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="25" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <CheckBox x:Name="Xpander" Style="{DynamicResource ResourceKey=ChevronCheckBox}" />

            <ContentPresenter Grid.Column="1"
                              VerticalAlignment="Center"
                              Content="{TemplateBinding Header}"
                              ContentTemplate="{TemplateBinding HeaderTemplate}" />

            <Separator Grid.Column="2"
                       Height="12pt"
                       Margin="7,0,0,0"
                       VerticalAlignment="Center"
                       Visibility="{TemplateBinding LineBreakVisibility}" />

            <ContentPresenter Grid.Row="1"
                              Grid.ColumnSpan="3"
                              Margin="8,5,5,5"
                              Visibility="{Binding ElementName=Xpander,
                                                   Path=IsChecked,
                                                   Converter={StaticResource ResourceKey=BooleanToVisibilityConverter}}" />
        </Grid> 
```

我遇到的问题是雪佛龙总是超级时髦（而不是很好的时髦）。

这是我使用 Path 对象的少数几次之一。是否有什么我做错了，当它与我的其他标题项目一起放置在网格中时，使人字形倾斜变得奇怪？

目前看起来它要么倾斜得太宽，要么布局旋转不正确。我已经尝试在 Expression Blend 4 的空白页面中提出正确的路径，但我只是不了解如何提出正确的路径。我可以使用两个不同的路径数据集，但我认为只需旋转三角形即可。

顺便说一句，我知道我没有当前 Explorer 行为的所有样式。现在我正在尝试模仿折叠和未折叠状态。如果有比使用 CheckBox 并覆盖它的模板更好的方法，我愿意接受建议。

**编辑** Windows 7 示例：

![Windows 7 示例](../Images/44d137b809dd9c0483bed3742d19c1d2.png)

*左侧显示标题的展开状态，右侧显示折叠状态。顶部是人字形悬停时的部分。*

我目前的“超级时髦”雪佛龙（没有荣耀）：

![当前标题样式](../Images/ed02dc59d3ee9f7bde5c8e42b4a6b37d.png)

*顶部展开，底部折叠。*

快速详细说明我的想法试图实现的目标。我想要有路径并根据复选框的视觉状态（以及后来的鼠标悬停样式的路径）更改其布局旋转、填充和描边。

另一个快速说明，因为这覆盖了复选框 ControlTemplate，所以我将可视状态管理器用于选中和未选中状态。当“复选框”被选中时，它会被展开。当它不是标题时出现折叠。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T03:51:11.287

丢弃 Path 对象。使用点设置为三的 RegularPolygon。您将需要 Expression Blend SDK 来获取 RegularPolygon 类。**

# jquery - ie8动态更新Knockoutjs模板时出现异常

> ID：10237649
> 
> 赞同：0
> 
> 时间：2012-04-19T22:18:24.813
> 
> 标签：jquery, internet-explorer-8, knockout.js

我使用 ajax 检索部分 HTML 文档以用作 Knockout 模板。

HTML：

```
<script type="text/html" id="LoadingTemplate">Loading...</script>
<script type="text/html" data-bind="attr: {'id': DynamicTemplateID}, html: ContentHTML></script>

<div class="main-page" data-bind="template: TemplateID"></div> 
```

脚本（部分）：

```
self.TemplateID = ko.observable("LoadingTemplate");
self.DynamicTemplateID = ko.observable(GenerateUUID());

self.ContentHTML = ko.observable();    
ko.computed(function () {
    var url = self.ContentURL();
    self.GetContent(url, function (html) {
        self.ContentHTML(html);
        self.TemplateID(self.DynamicTemplateID());
    });
}); 
```

1.  最初`<div>`将显示：“正在加载”
2.  动态模板的`id`属性设置为生成的ID
3.  `GetContent()`执行 ajax 调用以检索内容
4.  当 ajax 调用完成时，回调函数被调用
5.  observable`ContentHTML`用 html 更新
6.  observable`TemplateID`设置为生成的 ID
7.  由`<div>`ko 更新

在 Firefox 中，这就像一个魅力，但 IE8 抛出一个异常：同时使用加载的模板`Error: Unexpected call to method or property access.`更新虚拟标签。`<script>`

错误由`jQuery.html()`. 首先`elem.innerHTML = value;`失败，被捕获然后`this.empty().append( value )`失败，这给出了异常。

部分“堆栈跟踪”：

```
this.appendChild( elem );    => callback function in jquery.append (v1.7.2 line 5847)
jquery.domManip
jquery.append
jquery.html
ko.utils.setHtml
ko.bindingHandlers.html.update
ko.applyBindingsToNodeInternal
ko.dependentObservable.evaluateImmediate 
```

可能是什么问题呢？更新`<script>`标签是否存在（已知的）IE8 问题？
是否有另一种方法可以在 html 页面中“存储”模板供 ko 使用（我更喜欢使用 ko 原生模板！）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T09:27:33.167

我已经使用knockmeout.net 上的[这篇文章解决了这个问题：](http://www.knockmeout.net/2011/03/using-external-jquery-template-files.html)

更新的 HTML（删除了动态`<script>`标签）：

```
<script type="text/html" id="LoadingTemplate">Loading...</script>
<div class="main-page" data-bind="template: TemplateID"></div> 
```

更新的脚本（下载模板后附加脚本标签）：

```
self.TemplateID = ko.observable("LoadingTemplate");
self.dynamicTemplateID = GenerateUUID();

ko.computed(function () {
    var url = self.ContentURL();
    self.GetContent(url, function (html) {
        $("body").append('<script type="text/html" id="' + self.dynamicTemplateID + '">' + html + '</script>');

        self.TemplateID(self.dynamicTemplateID);
    });
}); 
```

这有点少一些，但适用于*所有*浏览器。

# c++ - 无法编译使用 libxml++ 的简单程序，因为未找到 glibmmconfig.h

> ID：10237651
> 
> 赞同：0
> 
> 时间：2012-04-19T22:18:34.440
> 
> 标签：c++, libxml2

剥离所有不必要的代码后，这是拒绝编译的准系统版本：

```
#include <iostream>
#include <libxml++/libxml++.h>

using namespace std;

int main (int argc, char *argv[]) {
    cout << "Hello, World!" << endl;
    return 0;
} 
```

我使用的是最新版本的 Fedora 16。最初，编译器甚至找不到 libml++/libxml++.h，因为 Fedora 的 yum 将这些文件放在 /usr/include/libxml++-2.6/libxml++ 中。所以我通过创建符号链接 /usr/include/libxml++ 到 /usr/include/libxml++-2.6/libxml++ 来解决这个问题。这阻止了编译器抱怨找不到 libxml++.h，但是，在 libxml++.h 中有一行

```
#include <ustring.h> 
```

编译器又找不到了。所以我再次创建了一个从 /usr/include/glibmm 到 /usr/include/glibmm-2.4/glibmm 的符号链接，这是 ustring.h 实际所在的位置。

现在编译器已经停止抱怨 ustring.h，但 ustring.h 中的第一（实际）行是

```
#include <glibmmconfig.h> 
```

编译器找不到。

glibmmconfig.h 的实际位置是 /usr/lib64/glibmm-2.4/include。但我不希望改变 ustring.h。

有没有办法解决我的问题而不必经常创建符号链接等？

在此先感谢您的帮助。

**编辑**

我能够使用以下编译器选项解决我的问题：

```
`pkg-config --cflags --libs glibmm-2.4 libxml++-2.6` 
```

感谢 jpalecek 指路，但我不得不再寻找一些东西，直到我能够解决我的问题。

但是，虽然这些编译器选项编译了上面的简单程序，但它们无法编译[libxml++ 教程页面](http://developer.gnome.org/libxml++-tutorial/stable/chapter-parsers.html)上的教程：

```
#include <iostream>
#include <libxml++/libxml++.h>
#include <string.h>

using namespace std;

int main (int argc, char *argv[]) {
    string FilePath = "SampleXMLDocument.xml";
    try {
        xmlpp::DomParser Parser;
        Parser.set_substitute_entities ();
        Parser.parse_file (FilePath);
        cout << "Successfully parsed XML file" << endl;
    } catch (const exception& excp) {
        cout << "Exception caught:  " << excp.what () << endl;
    }
    return 0;
} // End main () 
```

这次我得到了一堆错误，如下所示：

```
undefined reference to `xmlpp::DomParser::DomParser()`
undefined reference to `xmlpp::Parser::set_substitute_entities(bool)` 
```

等等。

我想我的搜索还在继续。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:26:45.467

您必须将正确的选项传递给编译器，尤其是正确的包含路径。包装商通过一个为您提供选项的程序使这成为可能：`xml++-config --cflags`将给您`-Ipath_to_headers`，`xml++-config --libs`将给您`-lto_link`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T01:51:59.597

好吧，我不熟悉 Fedora 16，但我认为您遇到了一些链接错误，因为找不到 libxml++。1\. 检查 /usr/lib/ 和 libxml++.so（可能是这个名称...）可能找到的其他可能的目录。确保 /etc/ld.so.conf 包含此路径，以便链接可以找到它。如果没有，请尝试添加 libxml++ 的位置并运行“ldconfig”进行更新。2.用g++检查-l选项的使用是否正确...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-25T15:20:17.523

根据 libxml++-XX 编译库的最简单方法是使用 pkg-config：

```
c++ -std=c++11 -Wall $(pkg-config --cflags --libs libxml++-2.6) -o test main.cc 
```

仅指定 libxml++-2.6 也将解决 glibmm-2.4 依赖项。

# java - JAI 中的查找表

> ID：10237652
> 
> 赞同：1
> 
> 时间：2012-04-19T22:18:40.153
> 
> 标签：java, jai

我在这里查看现有的 Java **CT 图像**显示程序。我试图了解**查找表**在**JAI**中是如何工作的。

从[JAI 指南，第 7.6 节](http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-java-client-419417.html#7284-JAI-1.0.1-guide-doc-oth-JPR)，我读到：

*输入像素值充当查找表输入的地址。查找表中的每个位置都存储该特定地址的所需输出值。*

我们只需要灰度显示，所以我们有一个大小为 256 的查找表。但是作为我们原始图像像素的输入**像素***值*有时可能是**负数。**那么我怎样才能将它们用作索引/地址呢？

 ****我可以移动数据以确保所有值都是正数，但我会丢失原始数据值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:45:33.323

如果 JAI 真的会尝试直接使用负像素值作为索引，我会感到惊讶。我希望它在`pixel&255`索引时至少使用无符号转换（即）。

如果 JAI 没有做正确的事情，我认为您可以创建带有负偏移量的查找表，例如 -128，以便在表的前半部分查找负像素，在后半部分查找正像素。****

# ios - iOS4+ 中的 AES128 编码

> ID：10237654
> 
> 赞同：4
> 
> 时间：2012-04-19T22:18:52.307
> 
> 标签：ios, xcode, encryption, openssl, aes

我是在 iOS 中加密的新手，我被 AES128 加密困住了。是否有一些我可以轻松使用的预建库（也许是 OpenSSL）？

如果是这样，我该如何实现和使用它？有教程吗？

我找到了几个如何构建 OpenSSL 并将其导入 Xcode 的“简单”教程，但没有一个对我有用。此外，它需要与 iOS4 兼容，因此通过 CommonCrypto 的解决方案似乎不是一个解决方案（因为几个基本方法仅与 iOS 5+ 兼容）。

感谢您的任何帮助，我正在为此拉头发:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:23:49.450

[这](https://github.com/tharindu/AES128Encryption-ObjC/)是用 Obj-C 编写的，允许对 和 进行 AES128`NSString`加密`NSData`。

我把它收回。它使用`CommonCrypt`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T11:58:37.333

如果有人仍然对这个问题感兴趣，我在[http://dotmac.rationalmind.net/2009/02/aes-interoperability-between-net-and-iphone/](http://dotmac.rationalmind.net/2009/02/aes-interoperability-between-net-and-iphone/)上找到了解决方案。在此页面上，您可以下载非常简单的 obj-c 类，它们与 iOS4 兼容并且不需要任何 3rd 方库。

# mysql - 如果左连接返回行，则条件 Where 子句？

> ID：10237661
> 
> 赞同：1
> 
> 时间：2012-04-19T22:19:35.350
> 
> 标签：mysql, left-join, where-clause, conditional-statements

我觉得有一种方法可以使用条件 Cases 或 Ifs 来做到这一点，但我就是想不通。

下面的查询将三个表连接在一起，如果所有三个表都返回行，则效果很好。但是，在某些情况下，campaign_groups 和 new_advertisers 中存在记录，但 payment_transactions 中没有记录。

由于 WHERE 子句确保 payment_transactions.transaction_date >=campaign_groups.date_created，零交易的行被排除在外。

有没有办法仅在 LEFT JOIN 返回行时应用 WHERE 子句？

```
SELECT sum(payment_transactions.transaction_amount) as payment, 
            new_advertisers.account_id, 
            new_advertisers.advertiser_id,
            max(payment_transactions.transaction_date) as last_payment,
            campaign_groups.id,
            campaign_groups.date_created,
            TIMESTAMPDIFF(DAY, max(payment_transactions.transaction_date), NOW()) as days_passed
        FROM campaign_groups
        INNER JOIN new_advertisers ON campaign_groups.advertiser_id = new_advertisers.advertiser_id
        LEFT JOIN payment_transactions ON payment_transactions.account_id = new_advertisers.account_id
        WHERE payment_transactions.transaction_date >= campaign_groups.date_created
            AND campaign_groups.weekly_budget_cents > 0
        ORDER BY days_passed DESC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:23:01.317

将条件移动到您的 ON 子句中：

```
LEFT JOIN payment_transactions
    ON payment_transactions.account_id = new_advertisers.account_id
    AND payment_transactions.transaction_date >= campaign_groups.date_created
WHERE campaign_groups.weekly_budget_cents > 0 
```

# objective-c - Objective-c 自定义指标锁共享实例

> ID：10237671
> 
> 赞同：0
> 
> 时间：2012-04-19T22:20:21.210
> 
> 标签：objective-c, multithreading, singleton, block, objective-c-blocks

我制作了一个自定义指示器，在其中我可以通过一个块运行代码并在代码运行时显示一个指示器。

代码完成后，我调用第二个成功块并隐藏/删除指示器。

因为我不想在我想使用它们的类中实例化每个指标，所以指标对象是一个单例。

**工作流程：**

1.  创建指标
2.  显示指标
3.  运行代码块
4.  运行成功块
5.  隐藏指示器
6.  从超级视图中删除
7.  取消共享实例

当我使用两个指标时出现问题（**例如：**登录后，刷新数据）。

当显示第二个指标时，在第一个实例上调用 hide 方法。在第二个指标期间，指标视图从超级视图中移除。

我没有管理自己的线程锁的经验，但我想通过使用解决问题，`@synchronized(self)`但似乎没有效果？

```
+ (Indicator *)create
{
    if (!sharedIndicator)
    {
        sharedIndicator = [[Indicator alloc] initWithNibName:@"Indicator" bundle:nil];
    }

    return sharedIndicator;
}

+ (Indicator *)createWithDelegate:(id <IndicatorDelegate>)delegate 
                             message:(NSString *)message 
                              inView:(UIView *)parentView
{
    Indicator *indicator = [Indicator create];
    [indicator setDelegate:delegate];
    [indicator setMessage:message];
    [indicator setParentView:parentView];

    return indicator;
}

+ (void)showInView:(UIView *)view 
       withMessage:(NSString *)message 
           execute:(BOOL (^)(void))executeBlock 
          complete:(void (^)(BOOL success))completed
{
    Indicator *indicator = [Indicator createWithDelegate:nil message:message inView:view];

    [indicator show];

    __block BOOL success = NO;

    dispatch_async(dispatch_get_global_queue( DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^
    {    
        success = executeBlock();

        dispatch_async(dispatch_get_main_queue(), ^
        {
            completed(success);

            [indicator hide];
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T21:14:23.487

每次显示指标时，您都会获得相同的视图，因为它与 sharedInstance 链接。

# gdb - GDB：操作字符串方便变量

> ID：10237679
> 
> 赞同：2
> 
> 时间：2012-04-19T22:20:57.233
> 
> 标签：gdb

我想知道这是否可行 - 我定义了 2 个方便的变量，并喜欢基于这两个变量构建第三个变量，我只是尝试了以下方法：

```
(gdb) set $a=12
(gdb) set $b=34
(gdb) set $c=$a$b
(gdb) p $c
 $1 = void
(gdb) show convenience 
$a$b = void
$c = void
$b = 34
$a = 12
$_siginfo = void 
```

我的目标是创建值为“1234”的变量 c，这可以在 GDB 中完成吗？

一个相关的问题，我可以根据当前目录动态定义源文件搜索路径吗？从某种意义上说，“动态”我可以定义一个调用“dir”命令的 GDB 用户命令，并根据当前目录为其参数提供一些目录。根据我目前的调查，我不能使用内置的 gdb 机制，我编写了一个 shell 脚本并调用 gdb shell 命令来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-21T04:41:57.433

> 我的目标是创建值为“1234”的变量 c，这可以在 GDB 中完成吗？

```
(gdb) set $c = 1234
(gdb) set $d = 100*$a + $b 
```

大概你想连接`$a`and `$b`，但这些是*整数*变量，连接它们（几乎）没有意义。

# java-ee-6 - 尝试使用 @CacheConfig 停用有状态会话 bean 的钝化

> ID：10237680
> 
> 赞同：2
> 
> 时间：2012-04-19T22:21:07.503
> 
> 标签：java-ee-6, jboss6.x, jboss-weld

我尝试使用禁用有状态会话 bean 的钝化

> @CacheConfig(maxSize = 0, idleTimeoutSeconds = 0)

[http://docs.jboss.org/ejb3/docs/reference/1.0.7/html/SessionBean_and_MDB_configuration.html](http://docs.jboss.org/ejb3/docs/reference/1.0.7/html/SessionBean_and_MDB_configuration.html)

我向我的有状态会话 bean 和它注入的托管 bean 添加了几个打印语句，以便更好地了解正在发生的事情。看起来有状态 bean 确实被注入到托管 bean 中（因为它不是 null），但是调用它的方法没有效果（如果您查看下面托管 bean 的 loadData() 方法，它会调用 test() 例程有状态会话 bean，但输出“test”从未出现）。

> 15:06:07,861 INFO [STDOUT] loadData programSlug = some-program-name
> 
> 15:06:07,876 INFO [STDOUT] programServiceBean = 端点 [ jboss.j2ee:jar=TEI.war,name=ProgramServiceBean,service=EJB3 ] 和会话 43h1h2v-j35uon-h18czgvf-1-h18d0nzj-df 的无接口视图
> 
> 15:06:07,908 错误 [org.apache.catalina.core.ContainerBase.[jboss.web].[localhost].[/TEI].[Faces Servlet]] Servlet.service() for servlet Faces Servlet 抛出异常：java .lang.IllegalStateException：无法在 org.hibernate.ejb.metamodel.AbstractAttribute.readObject(AbstractAttribute.java:122) [:3.6.6.Final] 处找到成员 [com.ray.TEI.model.Program#urlSlug] sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [:1.6.0_30] 在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [:1.6.0_30]

这是我的有状态会话 bean...

```
package com.ray.TEI.ejb;

import com.ray.TEI.model.Program;

import javax.ejb.Stateful;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.PersistenceContextType;

import org.jboss.ejb3.annotation.CacheConfig;

@Stateful
@CacheConfig(maxSize = 0, idleTimeoutSeconds = 0)
public class ProgramServiceBean {
  @PersistenceContext(unitName="TEI", type=PersistenceContextType.EXTENDED)
  protected EntityManager em;

  public void test() {
    System.out.println("test");
  }

  public Program findBySlug(String urlSlug) {
    System.out.println("findBySlug " + urlSlug);
    return em.createNamedQuery("Program.findBySlug", Program.class)
        .setParameter("urlSlug", urlSlug)
        .getSingleResult();
  }
} 
```

这是托管bean...

```
package com.ray.TEI.controller;

import javax.enterprise.context.RequestScoped;
import javax.inject.Inject;
import javax.inject.Named;

import com.ocpsoft.pretty.faces.annotation.URLAction;
import com.ocpsoft.pretty.faces.annotation.URLMapping;
import com.ocpsoft.pretty.faces.annotation.URLQueryParameter;
import com.ray.TEI.ejb.ProgramServiceBean;
import com.ray.TEI.model.Program;

@Named
@RequestScoped
@URLMapping(
  id="uuts",
  pattern="/#{programSlug:uutsController.programSlug}/uuts",
  viewId="/uuts.xhtml"
)
public class UutsController {
  @Inject private ProgramServiceBean programServiceBean;
  private String programSlug;
  private Program program;

  @URLQueryParameter("new")
  private Boolean displayAddForm = false;

  @URLAction
  public String loadData() {
    System.out.println("loadData programSlug = " + programSlug);
    if (programSlug != null) {
      System.out.println("programServiceBean = " + programServiceBean);
      programServiceBean.test();
      program = programServiceBean.findBySlug(programSlug);
      System.out.println("loadData program = " + program.getName());
    }
    if (program == null) {
      return "pretty:error";
    }
    return null;
  }

  public String getProgramSlug() {
    return programSlug;
  }
  public void setProgramSlug(String programSlug) {
    this.programSlug = programSlug;
  }

  //other getters/setters
} 
```

知道问题是什么吗？

谢谢，杰森

（顺便说一下，我使用的是 JBoss 6.1 Final）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-21T15:02:24.737

通过将 bean 删除超时设置为小于此处所述的空闲超时来解决我的问题[https://community.jboss.org/wiki/Ejb3DisableSfsbPassivation](https://community.jboss.org/wiki/Ejb3DisableSfsbPassivation)（选项 2，方法 2）

```
import org.jboss.ejb3.annotation.CacheConfig;

@Stateful
@CacheConfig (maxSize=100000, idleTimeoutSeconds=600, removalTimeoutSeconds=300)
public class ProgramServiceBean {
  //...
} 
```

# multithreading - 记录到 Node.js 中的文件：集群安全吗？

> ID：10237684
> 
> 赞同：4
> 
> 时间：2012-04-19T22:21:47.733
> 
> 标签：multithreading, node.js, logging, conflict

如果我在一个运行此代码的机器上有 4、8 或更多线程和集群，是否会存在日志文件/文件编写器的资源争用？如果是这样，你能发布一个说明的例子吗？到目前为止，我所做的所有测试似乎都表明写入数据不会交织在一起，也不会被丢弃，但我并不是 100% 相信

谢谢！

```
var errLog = fs.createWriteStream(... + '/error.log');
GLOBAL.dbLog = fs.createWriteStream(... + '/db.log'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-24T19:39:20.647

没有线程或集群进程的协调，所以问题归结为操作系统是否允许多个打开的写入流到一个文件。CreateWriteStream 的默认 C 标志是`O_WRONLY || O_CREAT || O_TRUNC`. 这表明第一个问题 - 所有进程都将创建一个新的截断文件（当您可能想要追加时）。

因此，假设您`w+`在创建流时指定为标志...

对于 Linux，[这个相关问题](https://stackoverflow.com/questions/1154446/is-file-append-atomic-in-unix)表明只要字节数小于 PIPE_BUF 字节（Linux 上为 4096，其他一些 Unix 上为 512），您就可以了。

我不确定 Windows 上的答案是什么。

# android - Android - 改进数据报套接字垃圾收集

> ID：10237692
> 
> 赞同：1
> 
> 时间：2012-04-19T22:22:30.943
> 
> 标签：android, sockets, garbage-collection, udp

我希望通过改善接收数据包时垃圾收集引起的小滞后来提高性能。我有一个简单`DatagramSocket`的接收数据的方法：

```
DatagramSocket sock;
try {
    sock = new DatagramSocket(port);
    sock.setReuseAddress(true);
} catch (SocketException e) { }

DatagramPacket pack = null;
byte[] buff = new byte[SIZE];

while(!sock.isClosed()){
    try{
        pack = new DatagramPacket(buff, buff.length());
        sock.receive(pack);
    } catch (IOException e) { }
} 
```

上面的代码运行良好，只是最终会调用大量收集垃圾（如我的 LogCat 查看器中所示）。我知道为了避免垃圾收集，你想尽量不分配内存，但是有没有人看到用上面的代码做到这一点的好方法并且仍然达到相同的结果？

我查看了[这个线程](https://stackoverflow.com/questions/6882292/avoid-garbage-collection-when-using-sockets)和[这个线程](https://stackoverflow.com/questions/2484079/how-can-i-avoid-garbage-collection-delays-in-java-games-best-practices)，但不确定它们将如何映射到我的特定情况。我也看到了调用 GC 的[建议](https://stackoverflow.com/questions/2881529/how-do-i-stop-the-android-garbage-collector-is-it-possible)，但在这种情况下，GC 已经在此期间执行了很多次。

任何建议将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:28:24.650

那这个呢 ？

```
DatagramSocket sock;
try {
    sock = new DatagramSocket(port);
    sock.setReuseAddress(true);
} catch (SocketException e) { }

DatagramPacket pack = null;
byte[] buff = new byte[SIZE];
pack = new DatagramPacket(buff, buff.length());

while(!sock.isClosed()){
    try{
        pack.setData(buff, 0, buff.length()); // Maybe you can comment this line out. If the buffer doesn't change its irrelevant
        sock.receive(pack);
    } catch (IOException e) { }
} 
```

您是否需要继续构造新的 DatagramPacket 对象？缓冲区的大小不会改变，所以你可以保持不变。

# java - 访问 Environment.getExternalStorageAppFilesDirectory

> ID：10237695
> 
> 赞同：0
> 
> 时间：2012-04-19T22:22:40.457
> 
> 标签：java, android

按照[这个代码](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/os/Environment.java) `getExternalStorageAppFilesDirectory`应该是`public`。

但是，当我查看 时`Android 4.0.3 jar`，缺少该方法以及其他应该公开可用的方法。

*Android是否有另一种隐藏方法的机制？如何在不重新实现的情况下访问它？*

# ios - 如何使来自 UIWebView 的音频静音

> ID：10237697
> 
> 赞同：6
> 
> 时间：2012-04-19T22:22:49.770
> 
> 标签：ios, audio, uiwebview

我的应用程序包含一个带有第 3 方内容的 UIWebView。内容有时包括 html5 视频。当用户通过我的应用程序的设置或通过响铃/静音开关使音频静音时，我想要一种使 html5 音频静音的方法。

我试过使用所有这些都无济于事：

```
[[AVAudioSession sharedInstance] setCategory: AVAudioSessionCategorySoloAmbient error:nil]];
[[MPMusicPlayerController applicationMusicPlayer] setVolume:0.0];
[[MPMusicPlayerController iPodMusicPlayer] setVolume:0.0]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T18:50:13.180

我想知道同样的事情。我有一个播放 HTML5 音频的 UIWebView。我认为解决方案将分为两部分：

我必须明确允许在 webview 中播放音频：

```
// Allow audio playback in the UIWebView:
self.webView.allowsInlineMediaPlayback = YES;
self.webView.mediaPlaybackRequiresUserAction = NO; 
```

因此，如果有一种方法可以在静音开关关闭时有条件地将它们设置为相反，那就可以了。

问题是，在 iOS 5.0 及更高版本中似乎没有办法做到这一点。

# sql - T-SQL：将数据从一个表插入到另一个表，而不需要光标

> ID：10237701
> 
> 赞同：1
> 
> 时间：2012-04-19T22:23:03.647
> 
> 标签：sql, database

这是我拥有的数据类型：

```
ENT*2*2J*EI*A25530181
NM1*IL*1*DOBIAS*ROSE*M
RMR*AZ*10100314**362.45
DTM*582****RD8*20120301-20120331
ENT*3*2J*EI*A54700554
NM1*IL*1*LOMBARDO*LUIS*J
RMR*AZ*10100314**362.45
DTM*582****RD8*20120301-20120331 
```

情况是我需要从每一行中提取信息并用它填充另一个表。所以就像从 ENT 开始的行一样，我需要代码 A25530181 并将其放入另一个表中。我已经掌握了提取信息的所有逻辑。只需要弄清楚如何将它放入另一个没有游标的表中。此表中前 4 行的信息将成为新行中的一行。所以

```
ENT*2*2J*EI*A25530181
NM1*IL*1*DOBIAS*ROSE*M
RMR*AZ*10100314**362.45
DTM*582****RD8*20120301-20120331 
```

将用于使用上面给出的数据中的客户代码、日期和金额填充新表的一行。Row is DTM 提供日期，row with RMR 提供费率。我有逻辑来提取信息。只需要帮助将其放入没有光标的新表中。

这是示例逻辑：

```
SELECT @Asterisk1Pos = CHARINDEX(@Delimeter, REVERSE(DATA)) - 1
from @TEMP_TABLE
WHERE LEFT(DATA,3) = 'ENT'

SELECT TOP 1 RIGHT(DATA, @Asterisk1Pos) 
from @TEMP_TABLE 
WHERE LEFT(DATA,3) = 'ENT' 
```

这样我只有一行的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T01:10:32.180

你说你有从记录中解析数据的提取逻辑，所以我不会详述。您的问题似乎是您必须根据其内容处理每条记录，不能使用 DTS 或 SSIS，可以使用 T-SQL，但不能使用游标。

如果您可以使用 DTS 或 SSIS，或者可以使用 PC 编程语言来处理您的记录并执行插入语句，请这样做。如果这是一个临时的事情，并且您可以在 Excel 中预处理您的记录，我什至会在尝试在 T-SQL 中实现这一点之前这样做。但是，如果这些都不适用并且 T-SQL 是您拥有的唯一工具，那么如果我处于您的位置，下面是对我将采取的步骤的描述：

1.  创建一个临时表，其中包含记录，但还有一个表示行号的附加列。您可以使用 ROW_NUMBER() 函数来获取此信息。（查一下：语法与大多数 T-SQL 函数有点不同。）

2.  假设您的临时表被调用`@Temp`并且您的字段被调用`RecordNumber`and `Data`，创建另一个临时表，它将四个（它总是四个，对吗？）记录连接在一起，形成一个记录，如下所示：

    选择 T1.RecordNumber，T1.data 作为 Data1，T2.data 作为 Data2，T3.data 作为 Data3，T4.data 作为 Data4 从@Temp T1 JOIN @Temp T2 ON T1.RecordNumber = T2.RecordNumber - 1 JOIN @Temp T3 ON T1.RecordNumber = T3.RecordNumber - 2 加入 @Temp T4 ON T1.RecoreNumber = T4.RecordNumber - 3

    我们将调用您的第二个临时表`@Temp2`。

3.  编写一个表值函数，将@Temp2 中的所有5 个字段作为参数，并返回一个表值函数，输出表格式为目标表格式。这是您放置所有解析逻辑的地方。假设您的函数被调用`dbo.udf_Function1`。

4.  插入目标表（我们称之为 Target），如下所示：

    插入@Target SELECT F1.* FROM @Temp2 T2 交叉应用 dbo.udf_Function1(T2.RecordNumber, T2.Data1, T2.Data2, T2.Data3, T2.Data4) F1

这是因为（我认为）SQL 2005 中引入了 CROSS APPLY 功能。它将具有将每次调用返回的单个记录聚合`udf_Function1`到一组记录中的效果，您可以在插入时从中选择。

# css - 将 Twitter Bootstrap 导航栏与 XenForo 集成

> ID：10237702
> 
> 赞同：2
> 
> 时间：2012-04-19T22:23:03.693
> 
> 标签：css, twitter-bootstrap

我正在将 Bootstrap 用于使用 XenForo 作为其论坛的站点。即使在 XenForo 上，我也想保留 Bootstrap 的导航栏，但它的代码散布在 bootstrap.css 文件中，我似乎无法仅保留这些部分。自然，移动整个 bootstrap.css 文件会搞砸 XenForo。无论如何这可以做到吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:28:15.500

使用此工具仅包含导航栏的 css：

[http://twitter.github.com/bootstrap/download.html](http://twitter.github.com/bootstrap/download.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-19T16:38:49.933

即使您使用 Bootstrap 生成器生成仅导航栏的代码，它仍然会与 XenForo 的样式混淆。

如果你真的想接手这个项目，你至少必须重命名单个 CSS 元素来解决所有冲突。

这是一项相当多的工作，其数量还取决于您使用的 XenForo 样式。

# sharepoint-2010 - Sharepoint中TEXT的公式

> ID：10237713
> 
> 赞同：1
> 
> 时间：2012-04-19T22:24:19.457
> 
> 标签：sharepoint-2010

我需要在 sharepoint 2010 上创建一个计算字段我有一个列表，其中包含一个名为日期时间类型的开始日期的字段，我需要从该字段计算年份和月份，我正在使用这个公式`=TEXT(YEAR([Start Date]),"0000")&"-"&TEXT(MONTH(start Date]),"00")`，但我收到了这个错误：

> 该公式包含语法错误或不受支持。

我能做些什么？怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T04:52:29.343

您可以使用以下公式从日期字段计算字段月份和年份

一年

```
 =TEXT([DateFieldName],"yy") 
```

一个月

```
 =TEXT([DateFieldName],"mm") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-09T11:14:50.067

我有同样的问题，解决方案`;`是`,`

```
=[IMIE]&"-"&TEXT([Data];"dd-mm-yyyy") 
```

# eclipse - 如何将 Eclipse for Java7 和 Java6 互换使用？

> ID：10237715
> 
> 赞同：2
> 
> 时间：2012-04-19T22:24:39.617
> 
> 标签：eclipse, java-7

因为，Java 7 中的“Java7 Solr/Lucene”错误似乎在 update3 中得到解决，我现在想在 Java7 中进行开发，但由于世界其他大部分地区都使用 Java6，我需要在 Java7 和 Java6 之间切换以用于不同的项目。如何单独配置项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:38:35.470

简短的回答是它是项目属性的一部分。

谷歌“eclipse build path”和前几个点击之一应该带你到 eclipse 帮助站点，你会得到你需要的所有细节。

或尝试： [http ://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/ref-properties-build-path.htm](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.jdt.doc.user/reference/ref-properties-build-path.htm)

# python - Python - 将不同类的对象传递给函数

> ID：10237717
> 
> 赞同：2
> 
> 时间：2012-04-19T22:24:45.920
> 
> 标签：python, class, object, dictionary

我在使用类和对象的 python 中遇到了一些麻烦。我有两个类，我分别实例化了一个对象。当用户键入某个字符串时，我想将这些对象传递给一个函数。然后该函数将调用它所采用的对象的类方法。（每个类的方法具有相同的名称）。我在下面做了一个示例文件：

```
 class Test1(object):

       def method1(self):
          print("test1")

    class Test2(object):

       def method1(self):
          print("test2")

    def Call(something):
       return something.method1

    def Call2(something):
       y = input("> ")
       return something.method1

    array = [Test1(), Test2()]
    my_dict = {'call': Call(array[0]), 'call2': Call2(array[1])}

    x = input("> ")

    if x in my_dict:
       my_dict[x]() 
```

我认为发生的是 Call2() 在运行时被调用并要求输入。然后第二个 input() 被调用。有人可以解释为什么即使 if 语句没有机会评估字符串， Call2() 也会运行？可能有很多我误解的事情。任何帮助表示赞赏。

编辑：好的，我知道在声明字典期间调用了这些函数。在将对象传递给它的同时，您将如何将函数链接到 dict？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:28:32.393

> 问：有人可以解释为什么`Call2()`即使 if 语句没有机会评估字符串也会运行吗？

你在这里调用这两个函数：

```
my_dict = {'call': Call(array[0]), 'call2': Call2(array[1])} 
```

> 问：您将如何在将对象传递给它的同时将函数链接到字典？

通常所做的是提供功能和参数彼此分离。这是一个例子：

```
>>> def the_caller(f, args=()):
...     return f(*args)
... 
>>> def present_me(name):
...     return 'My name is ' + name
... 
>>> the_caller(present_me, args=('Rik',))
'My name is Rik' 
```

您的示例代码设计得太糟糕，无法构建有意义的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:28:12.610

您的代码在定义字典时调用该函数。

```
my_dict = {'call': (lambda: Call(array[0])), 'call2': (lambda: Call2(array[1]))} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T22:33:25.670

当你运行它时，它将到达这一行：

```
my_dict = {'call': Call(array[0]), 'call2': Call2(array[1])} 
```

这将调用`Call`和`Call2`- 这是第一个`input`被调用的位置（如果您将`input`提示更改为每个不同的提示，您可以看到这一点，这样您就可以知道正在调用哪个（即而不是`"> "`）。

这是否澄清了事情，还是你不理解的不同？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T22:44:43.850

使用您的原始代码和许多额外的东西，这应该做您想做的事情：

```
class Test1(object):

   def method1(self):
      print("test1")

class Test2(object):

   def method1(self):
      print("test2")

my_dict = {'call': Test1(), 'call2': Test2()}

x = input("> ")

if x in my_dict:
   my_dict[x].method1() 
```

# firefox-addon - 影响 Firefox 扩展中页面加载处理程序的顺序

> ID：10237721
> 
> 赞同：1
> 
> 时间：2012-04-19T22:25:21.117
> 
> 标签：firefox-addon, pageload

对于某些 Firefox 扩展，尽可能早地获得页面内容以进行修改是有意义的，而对于其他扩展则尽可能晚（例如，当其他扩展可能完成修改时）。很明显，总会有想要成为“第一个”或“最后一个”的扩展，但我很难在网上找到涵盖此内容的材料。对于 addEventListener("load", ...) 我只能发现调用事件处理程序的顺序是未定义的。如果 addEventListener 没有办法，那么我在 Firefox 扩展中有哪些其他选项可以影响处理内容的早期/延迟？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T12:00:14.013

触发事件侦听器的顺序确实是未定义的，您不能依赖任何特定的顺序。就扩展而言，您最好的选择是以您不关心其他扩展是否已经完成的方式编写代码。除此之外，您可以选择要附加的事件：

*   [`chrome-document-global-created`/`content-document-global-created`通知](https://developer.mozilla.org/en/Observer_Notifications#Documents)在刚创建窗口的最早时间点运行 - 但窗口的内容尚不可用。如果您的代码是由窗口的覆盖加载的，那么这个选项显然不是您可以使用的，加载覆盖会在以后发生。
*   `DOMContentLoaded`一旦可以访问窗口的 DOM，事件就会发生。
*   `load`事件在稍后发生，一旦所有依赖元素加载。
*   如果您想更晚运行，可以选择`setTimeout(..., 0)`在`load`事件处理程序中调用 - 保证在所有事件处理程序之后执行超时`load`。

# jquery - 使用 jquery 更新文本节点

> ID：10237729
> 
> 赞同：0
> 
> 时间：2012-04-19T22:25:58.027
> 
> 标签：jquery

我有这个html：

```
<span class="msg-container">
  <span class="msg"></span>
  A message here
</span> 
```

我想使用 jQuery 查找所有 msg-container 元素，获取“A message here”文本并设置标题属性并删除“A message here”文本节点。

所以，执行后，我的 DOM 应该是这样的：

```
<span class="msg-container" title="A message here">
  <span class="msg"></span>
</span> 
```

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:32:14.293

我认为您需要使用 for-each 功能

```
 $(".msg-container").each(function(){
       var child =  $(this).children(".msg").html();
       var text=$(this).html("");
        $(this)attr("title" , text) 
        $(this).append(child);
      }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:34:57.197

尝试

```
$(function()  {
    $(".msg-container").each(function() {
        var txt = $(this).text();
        var children = $(this).children();
        $(this).attr("title",txt.trim())
            .text("").append(children);
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T22:36:26.007

```
 $('.msg-container').each(function(){
      var that = $(this);
      that.attr('title', that.text());
      var children = that.find('.msg').clone();
      that.html('').append(children);
 }); 
```

# jquery - jQuery .css() 中的 CSS3 过渡

> ID：10237731
> 
> 赞同：27
> 
> 时间：2012-04-19T22:26:13.567
> 
> 标签：jquery, css-transitions

当我将过渡线添加到我的代码中时，它会破坏 jQuery。我该如何解决？

```
a(this).next().css({
    left: c,
    transition: 'opacity 1s ease-in-out'
}); 
```

我正在尝试在滑块内设置从一个 div 到下一个 div 的淡入淡出

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-04-19T22:27:03.537

**步骤 1）**删除分号，这是您正在创建的对象...

```
a(this).next().css({
    left       : c,
    transition : 'opacity 1s ease-in-out';
}); 
```

到

```
a(this).next().css({
    left       : c,
    transition : 'opacity 1s ease-in-out'
}); 
```

**第 2 步）**供应商前缀...没有浏览器使用`transition`，因为它是标准，即使在最新的浏览器中，这也是一个实验性功能：

```
a(this).next().css({
    left             : c,
    WebkitTransition : 'opacity 1s ease-in-out',
    MozTransition    : 'opacity 1s ease-in-out',
    MsTransition     : 'opacity 1s ease-in-out',
    OTransition      : 'opacity 1s ease-in-out',
    transition       : 'opacity 1s ease-in-out'
}); 
```

这是一个演示：http: [//jsfiddle.net/83FsJ/](http://jsfiddle.net/83FsJ/)

**第 3 步）**更好的供应商前缀......您可以使用 jQuery 来决定要使用的供应商前缀，而不是向元素添加大量不必要的 CSS（只会被浏览器忽略）：

```
$('a').on('click', function () {
    var myTransition = ($.browser.webkit)  ? '-webkit-transition' :
                       ($.browser.mozilla) ? '-moz-transition' : 
                       ($.browser.msie)    ? '-ms-transition' :
                       ($.browser.opera)   ? '-o-transition' : 'transition',
        myCSSObj     = { opacity : 1 };

    myCSSObj[myTransition] = 'opacity 1s ease-in-out';
    $(this).next().css(myCSSObj);
});​ 
```

这是一个演示：http: [//jsfiddle.net/83FsJ/1/](http://jsfiddle.net/83FsJ/1/)

另请注意，如果您在`transition`声明中指定要设置动画的属性是`opacity`，则设置`left`属性将不会被设置动画。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-11T18:45:29.450

处理 CSS3 过渡时，您的代码会很快变得混乱。我会推荐使用一个插件，比如处理 CSS3 动画/过渡的复杂性的[jQuery Transit](http://ricostacruz.com/jquery.transit/)。

此外，该插件使用 webkit-transform 而不是 webkit-transition，它允许移动设备使用硬件加速，以便在动画发生时为您的 Web 应用程序提供原生的外观和感觉。

[**JS Fiddle 现场演示**](http://jsfiddle.net/NnCVv/2/)

**Javascript：**

```
$("#startTransition").on("click", function()
{

    if( $(".boxOne").is(":visible")) 
    {
        $(".boxOne").transition({ x: '-100%', opacity: 0.1 }, function () { $(".boxOne").hide(); });
        $(".boxTwo").css({ x: '100%' });
        $(".boxTwo").show().transition({ x: '0%', opacity: 1.0 });
        return;        
    }

    $(".boxTwo").transition({ x: '-100%', opacity: 0.1 }, function () { $(".boxTwo").hide(); });
    $(".boxOne").css({ x: '100%' });
    $(".boxOne").show().transition({ x: '0%', opacity: 1.0 });

}); 
```

获得跨浏览器兼容性的大部分艰苦工作也是为您完成的，它在移动设备上就像一个魅力。

# asp.net-mvc-4 - （不是这样）MVC 4 Beta 中的模糊调用

> ID：10237737
> 
> 赞同：2
> 
> 时间：2012-04-19T22:26:44.907
> 
> 标签：asp.net-mvc-4

使用 MVC 4 Beta 及其移动功能，以下行`Login.Mobile.cshtml`

@Html.Partial("_ViewSwitcher")

导致此编译器错误：

> 以下方法或属性之间的调用不明确：'System.Web.Mvc.Html.PartialExtensions.Partial(System.Web.Mvc.HtmlHelper, string)' 和 'System.Web.Mvc.Html.PartialExtensions.Partial(System .Web.Mvc.HtmlHelper，字符串）'

[根据 MSDN](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.partialextensions.aspx)，这是在 System.Web.Mvc（在 System.Web.Mvc.dll 中）中定义的，我似乎只有一个引用。

尽管存在编译器错误，应用程序仍可正常运行。

视图中没有任何`using`语句，但以下命名空间是通过 合并的`web.config`：

```
 <add namespace="System.Web.Mvc" />
    <add namespace="System.Web.Mvc.Ajax" />
    <add namespace="System.Web.Mvc.Html" />
    <add namespace="System.Web.Routing" /> 
```

发生了什么事，我怎样才能摆脱误导性的编译器错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:31:05.513

该方法在两个地方定义是通常的原因，它可以来自先前构建的引用程序集，编译器将选择最有可能的并使用它，因此不会停止处理。

# java - 锁定类的静态成员

> ID：10237743
> 
> 赞同：6
> 
> 时间：2012-04-19T22:27:13.753
> 
> 标签：java, multithreading, concurrency, locking, deadlock

根据我的理解，下面这段代码应该会导致死锁。原因是，当线程 t1 锁定静态对象 firstData 时，他已经获得了对该类的锁定。所以，当他试图锁定另一个静态对象 secondData 时，请求应该被阻塞。

但是，程序运行良好并打印`*** Successfully acquired both the locks`

锁定我在这里丢失的静态对象是什么？

```
public class Deadlock {
    public static void main(String[] args) {

        Thread t1 = new Thread(new DeadlockRunnable());
        t1.start();
    }
} 

 class DeadlockRunnable implements Runnable {
    static  Object firstData = new Object();
    static  Object secondData = new Object();

    public void run() {
        synchronized(firstData) {
            synchronized(secondData) {
                System.out.println("*** Successfully acquired both the locks");
            }
        }
    }

} 
```

对于所有回答锁在对象而不是类上的人，请看看[这个](https://stackoverflow.com/questions/437620/java-synchronized-methods-lock-on-object-or-class)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-19T22:30:35.530

首先，你这里有一个错误：

> 原因是，当线程 t1 锁定静态对象 firstData 时，他已经获得了对该类的锁定。

锁定静态对象仅锁定该对象，而不锁定类。您正在锁定两个单独的对象。

[您提到](https://stackoverflow.com/questions/437620/java-synchronized-methods-lock-on-object-or-class)的问题是关于[同步方法](http://docs.oracle.com/javase/tutorial/essential/concurrency/syncmeth.html)而不是[同步语句](http://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)。这两个相关结构的工作方式略有不同。

* * *

其次，即使您锁定同一个对象，您的代码仍然不会死锁（[ideone](http://ideone.com/wjMyD)）。内在锁是*可重入*的。这意味着如果线程尝试两次获取相同的锁，它不会自己死锁。

> **可重入同步**
> 
> 回想一下，一个线程不能获得另一个线程拥有的锁。但是线程可以获取它已经拥有的锁。允许一个线程多次获取同一个锁可以实现重入同步。这描述了一种情况，同步代码直接或间接调用一个也包含同步代码的方法，并且两组代码都使用相同的锁。如果没有可重入同步，同步代码将不得不采取许多额外的预防措施来避免线程导致自身阻塞。

[来源](http://docs.oracle.com/javase/tutorial/essential/concurrency/locksync.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:31:22.877

“当线程 t1 锁定静态对象 firstData 时，他获得了对类的锁定”
不知道你为什么这么认为。t1 获取 firstData 上的锁，而不是包含类的锁。您的代码中没有可能的死锁。

**编辑**
根据您的评论，链接是关于这两个声明之间的区别：

```
public synchronized method() // lock on the instance (this)
public static synchronized method() // lock on the class (Myclass.class) 
```

但是与死锁没有联系。

# visual-studio-2010 - “转到定义”/“转到声明”在 VS2010 中不能可靠地工作？

> ID：10237744
> 
> 赞同：5
> 
> 时间：2012-04-19T22:27:15.650
> 
> 标签：visual-studio-2010

我最近想开始为一个开源 C++ 项目做贡献。由于对 C++ 的经验很少，我选择了 Visual Studio 作为 IDE，并使用 SP1 进行了更新。我得到了相对容易构建的解决方案，并且想稍微浏览一下代码以获得概览。

这是我注意到有时“转到定义”/“转到声明”不起作用的时候。当我右键单击源代码中的符号时，这两个选项都可用，但是当我在头文件中时，“转到定义”只会让我再次进入相关函数的声明。当我在 .cc 文件中时，我总是被带到同一个文件中的定义。

关于与此相关的功能，我注意到的其他一些事情是：

1）对于某些功能，我可以从头文件导航到定义，但是另一个方向被破坏了

2) 如果将声明更改为完全匹配定义，则可以修复某些函数的导航，例如

```
header declaration:
    void buche(sint64 betrag, player_cost type);
source definition:
    void karte_t::buche(sint64 const betrag, player_cost const type) 
```

改成

```
header declaration:
    void buche(sint64 const betrag, player_cost const type); 
```

-> 导航双向工作

3）当点击源文件中相关函数的代码块时，顶部的范围菜单变为“（全局范围）”而不是显示右侧的小箭头（这是前向声明的符号 I认为？）和类名（但这些函数绝对是类成员）

我搜索了很多，这似乎是一个相对知名的问题。网站上有一个线程：[如何让 IntelliSense 在 Visual Studio 2008 中可靠地工作](https://stackoverflow.com/questions/39474/how-to-get-intellisense-to-reliably-work-in-visual-studio-2008)

我还在微软论坛上找到了几个线程（我无法链接，因为我只能发布两个超链接），但没有官方确认错误或其他内容。

我发现的答复的精髓是应该删除 .ncb 文件（据我了解，该文件已被 VS2010 中的 .sdf 数据库取代），或者使用选项在加载解决方案时重建数据库。我都做了很多次，没有用。Stackoverflow 上该线程上评分最高的回复似乎暗示这只是一个错误（Intellisense 的 - 我是否理解正确，它是这个自动完成组件也负责代码导航？）必须接受，建议使用[视觉辅助](http://www.wholetomato.com/)取而代之的是，当时的问题是关于 VS2008 的，一个回复指出 VS2010 在这方面有所改进。另一个回复归咎于递归引用，但我认为这在这个项目中不是问题，因为所有文件（当然是我检查过并遇到问题的少数文件）都包含保护。该项目的一位编码员也向我证实，他也有同样的问题。但我并不是那么热衷于在 Visual Assist 上花钱，它只是为了一个小爱好......

拥有丰富的 Eclipse/Java 经验，对我来说，这样一个相对重要的 IDE 特性不能可靠地工作对我来说似乎很奇怪。当然我可以理解，静态代码分析对于 C++ 来说比对于 Java 来说要困难得多。但话又说回来，Visual Studio 是一个商业产品，它有很多开发周期。

所以总结这篇文章，这是一个不可避免的错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-18T12:38:55.187

我猜这取决于你认为不可避免的事情。

根据我的经验，Intellisense 问题似乎主要是由模板、宏或两者引起的。

Intellisense 使用的解析器/预处理器似乎与编译器的工作方式不同，在某些情况下，它可能会丢失信息并做出错误的假设。

如果您正在编码并且突然发现 Intellisense 已损坏，并且您刚刚添加了一个相当复杂的模板类（一个使用其他模板类的模板类，或者您使用另一个模板类实例化，或者任何奇怪的东西），或者一个宏 (再次，尤其是复杂的），您通常可以假设这是导致它的原因。通常，通过重新排列代码、稍微简化代码或只是随机更改它，您将能够恢复 Intellisense（通常仅在您删除 .sdf 文件之后）。

这相当不方便，但如果是图书馆破坏了它，那就更糟了。尤其是一些 Boost 库，往往会经常破坏它。在这些情况下，很难避免。

无论如何，Intellisense 正在稳步改进。VS2010 比 VS2008 准确和稳定得多，而且 VS2012 似乎也比 VS2010 好（虽然我还没有使用太多）。

事实上，如果您对 VS2010 没有任何特殊依赖，您可能只想更新到 VS2012。

# php - 如何配置 nginx 进行长轮询（和 php）

> ID：10237748
> 
> 赞同：4
> 
> 时间：2012-04-19T22:27:34.640
> 
> 标签：php, ubuntu, nginx

我正在创建一个简单的聊天应用程序。已经在 Ubuntu 11.10 上安装了 nginx，通过 fast-cgi 使用 PHP。为了感受性能，我制作了一个简单的 PHP 文件，它会休眠 10 秒，然后报告时间。用几个浏览器实例（不同的浏览器，不同的机器）调用它，在大约 10 个实例后响应变得迟缓，比预期的要少得多（希望在数百个实例之前不会看到任何恶化，尽管使用手动浏览器测试这不切实际） .

我是网络开发人员，而不是系统管理员，也许超出了我的理解范围？没有寻找最佳解决方案（搜索显示 nginx 应该能够处理每个核心 10k），但几百个就很好了。

还有 Nginx 推送流模块，但我不知道如何安装它，这似乎是另一种需要掌握的技术。开箱即用的基本 nginx 是否应该能够满足我的期望，即使用 PHP 的 100 多个长期连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:36:48.813

您需要配置订阅和发布的端点。将以下内容添加到您的 nginx.conf 文件中：

```
# internal publish endpoint (keep it private / protected)
location /publish {
  set $push_channel_id $arg_id;      #/?id=239aff3 or somesuch
  push_publisher;

  push_store_messages on;            # enable message queueing
  push_message_timeout 2h;           # messages expire after 2 hours, set to 0 to never expire
  push_message_buffer_length 10;     # store 10 messages
}

# public long-polling endpoint
location /subscribe {
  push_subscriber;

  # how multiple listener requests to the same channel id are handled
  # - last: only the most recent listener request is kept, 409 for others.
  # - first: only the oldest listener request is kept, 409 for others.
  # - broadcast: any number of listener requests may be long-polling.
  push_subscriber_concurrency broadcast;
  set $push_channel_id $arg_id;
  default_type  text/plain;
} 
```

查看文档

[http://www.brentsowers.com/2011/06/http-long-polling-aka-comet-with-nginx.html](http://www.brentsowers.com/2011/06/http-long-polling-aka-comet-with-nginx.html)

[http://www.igvita.com/2009/10/21/nginx-comet-low-latency-server-push/](http://www.igvita.com/2009/10/21/nginx-comet-low-latency-server-push/)

如果您想将其转换为完整的`COMET`服务器，您可以使用

[https://github.com/slact/nginx_http_push_module](https://github.com/slact/nginx_http_push_module)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:37:43.177

推送流模块在技术上会做你想做的事——设置一个 url，你可以在其中推送更新，而客户端代码中的 pubsub 可以轮询该更新。

为了安装推流模块，您需要获取 nginx 的最新源，获取该模块的源，编译它，然后**使用新模块源的路径作为标志之一**重新编译您的 nginx 。看看我是怎么做到的，在这里：

[使用 apt-get install nginx 后重新编译 nginx](https://stackoverflow.com/questions/9537426/recompiling-nginx-after-using-apt-get-install-nginx)

如果您的 nginx 服务器的重新启动没有在当前实例的列出标志中列出该模块，那么您在重新编译期间没有正确覆盖 nginx 文件。确保包含`--sbin-path`标志以确保覆盖到正确的目录。

一旦您确认它实际上已在 nginx 中安装并运行，然后按照@baba 提供的步骤操作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:43:05.113

你能介绍一下到目前为止你是如何配置 Nginx 的吗？你对你的配置有什么看法？在我自己看来，对你来说最关键的配置应该是工作进程、工作连接、open_file_cache 和 keep alives。这是一篇很好的文章，涵盖了所有这些：

[http://blog.martinfjordvald.com/2011/04/optimizing-nginx-for-high-traffic-loads/](http://blog.martinfjordvald.com/2011/04/optimizing-nginx-for-high-traffic-loads/)

您也可能想进一步了解指令：

[http://wiki.nginx.org/HttpCoreModule](http://wiki.nginx.org/HttpCoreModule)

我之前用 2 和 10240 配置了工作进程和工作连接，keepalives > 20。希望对你有帮助。

** 哦，我也忘了提——也许 Opcode 缓存可以为你工作？尝试安装 PHP-APC。

# c++ - 防止数组元素的默认构造

> ID：10237749
> 
> 赞同：1
> 
> 时间：2012-04-19T22:27:38.010
> 
> 标签：c++, arrays

```
element* elements = new element[size.x]; 
```

这将使用默认构造函数构建 X 元素。在我的程序中，我想用不同的构造函数参数构造每个元素，如下所示：

```
for(int i=0; i < size.x; ++i) 
    elements[i]  = element(i); 
```

有什么方法可以防止和不必要的默认实例化（我不想实现）和不必要的调用`Operator=`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:43:04.633

如果它不损害您的设计，您可以使用双指针来实现这一点

```
element ** elements = new element * [size.x];

for(int i=0; i < size.x; ++i) 
    elements[i]  = new element(i); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:31:21.973

好吧，如果这对您来说确实是个问题，请不要使用数组。将 a`std::vector`与默认构造函数一起使用。

> 显式向量（ const Allocator& = Allocator() ）；默认构造函数：构造一个空向量，没有内容，大小为零。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:33:18.180

您可以使用大括号初始化器*复制*-initialize 自动数组，这些数组通常会被优化为直接就地构造：

```
elements e[] = { elements(1,2,3), elements(), elements('a', true) }; 
```

但是，这不适用于动态数组。在 C++11 中，您可以指定一个初始化列表，但这也是复制初始化，而不是直接初始化：

```
elements * e = new elements[2] { elements(1,2,3), elements('a', true) }; 
```

# c++ - 我可以在初始化列表中用 10 个相同的整数初始化 STL 向量吗？

> ID：10237751
> 
> 赞同：53
> 
> 时间：2012-04-19T22:27:47.600
> 
> 标签：c++, stl, constructor, initializer-list

我可以在初始化列表中用 10 个相同的整数初始化 STL 向量吗？到目前为止，我的尝试都失败了。

* * *

## 回答 #1

> 赞同：150
> 
> 时间：2012-04-19T22:34:33.177

使用适当的构造函数，它接受一个大小和一个默认值。

```
int number_of_elements = 10;
int default_value = 1;
std::vector<int> vec(number_of_elements, default_value); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-04-20T00:51:11.940

我想你的意思是：

```
struct test {
   std::vector<int> v;
   test(int value) : v( 100, value ) {}
}; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-19T22:33:23.190

如果你使用 C++11 和 GCC，你可以这样做：

```
vector<int> myVec () {[0 ... 99] = 1}; 
```

它被称为远程初始化，是一个仅限 GCC 的扩展。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-04-20T00:54:06.693

C++0x 支持向量的初始化列表。如果你用 C++98 编译

```
int number_of_elements = 10;
int default_value = 1;
std::vector<int> vec(number_of_elements, default_value); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-19T22:34:31.657

您可以使用`std::vector`构造函数来做到这一点：

```
vector(size_type count, 
                 const T& value,
                 const Allocator& alloc = Allocator()); 
```

这需要`count`并被`value`重复。

如果你想使用初始化列表，你可以写：

```
const int x = 5;
std::vector<int> vec {x, x, x, x, x, x, x, x, x, x}; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T22:32:21.647

你能发布你在做什么吗

```
 int i = 100;
vector<int> vInts2 (10, i);

vector<int>::iterator iter;
for(iter = vInts2.begin(); iter != vInts2.end(); ++iter)
{
    cout << " i " << (*iter) << endl;
} 
```

# iphone - 具有两个不同 iPhone 应用程序的单个二进制文件（非越狱）

> ID：10237753
> 
> 赞同：0
> 
> 时间：2012-04-19T22:27:55.280
> 
> 标签：iphone, ios5, binaries

我已经阅读了如何创建将 iPad 和 iPhone 组合成单个（通用）二进制文件的单个 iOS 二进制文件。但是，我无法从这个过程中弄清楚将同一个 iPhone 应用程序的两个不同版本组合成一个二进制文件是否可行（甚至是可取的）。

我想这样做的原因是我已经对我的应用程序进行了全面重构以利用 iOS 5 功能等。当我第一次开始这样做时，我认为成品会发布并且我会停止支持 iOS 4.我在此期间意识到仍然有一些人使用早期的iOS版本。我不想阻止他们将来下载该应用程序。理想情况下，我会分发一个二进制文件，该二进制文件（在运行时）确定正在运行的 iOS 版本，然后加载应用程序的适当捆绑版本。

我已经看到了一些越狱技巧（启动 shell 脚本）来完成这类事情，但没有非越狱示例。任何见解将不胜感激。

谢谢，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T01:14:02.260

应用商店不允许您将多个二进制文件放入一个应用中。

有一些方法可以支持新的操作系统功能，同时又支持旧版本——搜索弱链接以获取更多信息。

另一方面，有人指出，目前超过 80% 的 iOS 用户都在使用 5.x，而且这个数字还在不断增加。花费大量精力支持 4.x 可能不值得。

# android - 对保存到文件感到困惑

> ID：10237757
> 
> 赞同：0
> 
> 时间：2012-04-19T22:28:15.827
> 
> 标签：android, save

我的项目直到永远不需要保存数据，所以这是我第一次保存数据。我想做的是从基于类的数​​组列表中保存数据。我见过几个人用几个不同的答案问这个问题，但我似乎遗漏了一些东西。在我所有尝试之后，这就是代码被剥离的内容。我希望有人可以帮助我保存和加载这些信息。差点忘了这是应用程序的配置文件保存，因此如果用户选择，可以有多个文件。

```
//in manifest
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

//in java file
private ArrayList<otherclass> otherClass=new ArrayList<otherclass>();
class saveData
{
        static private final int version=101002;
        private String title;
        private int[] Int1=new int[3];
        private int[] Int2=new int[3];
        private int[] Int3=new int[3];
        private int Int;
}
class otherclass
{
  //all the data goes here to similar named variables
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:44:20.353

一种方法是让您添加到 ArrayList 的类实现可序列化。如果您的类仅由也实现可序列化的对象组成，那么您就完成了（很可能是这种情况），只需像这样添加实现可序列化：

```
 public class myClass implements Serializable { 
```

否则，您将需要将以下两个方法添加到您的课程中

```
 private void writeObject(java.io.ObjectOutputStream out) throws IOException 
 private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException 
```

添加实现 Serialible 让 ObjectOutStream 知道它可以序列化您的数据以进行存储：

然后，您可以实现以下方法来保存和打开您的数据，请参阅每个步骤的注释...

```
void saveArray(String filename, ArrayList<myClass> arrayToSave) {
    FileOutputStream fos; //creates a file output stream to save your data
    ObjectOutputStream oos; //creates an object output stream to serialize your data
    try {
        fos = openFileOutput(filename, Context.MODE_PRIVATE); //creates and opens file with the specified filename, Context.MODE_PRIVATE limits its visibility to your app, other modes are available
        oos = new ObjectOutputStream(fos); //connects object output to file output
        oos.writeObject(arrayToSave); //writes the object to the file
    }
     catch (FileNotFoundException e) {
                        //handle file not found
    }
               catch (IOException e) {
    }
                        //handle I/O execption
               oos.close(); //close object output stream
               fos.close(); //close file output stream
}

ArrayList<myClass> openArray (String filename) {
    ArrayList<myClass> array = null; //create ArrayList
    FileInputStream fis; //create fileinput stream
    ObjectInputStream ois; //create objet input stream
    try {
        fis = openFileInput(filename); //open file stream
        ois = new ObjectInputStream(fis); //open object stream
        array = (ArrayList<myClass>)ois.readObject(); //create object from stream
    }
    catch (Exception e) {
        System.out.println(e.toString());
    }
              ois.close();  //close objectinput stream
              fis.close(); //close fileinput stream
    return array;
} 
```

最后，两个文件输入/输出流都可以包装在缓冲输入流/缓冲输出流中，但我发现对于小文件，它不会对性能产生太大影响。这可以通过

```
 BufferedInputStream bufIn = new BufferedInputStream(new FileInputStream("file.java"));
  BufferedOutputStream bufOut = new BufferedOutputStream(new FileInputStream("file.java")); 
```

好的，下面是一个完整的活动文件来演示这一点，并且已经用 2.1 版进行了测试...您唯一需要更改的是包名称以匹配您的项目...请注意，这会将 saveData 中的变量更改为 package from私有的，如果你想让它们保持私有，你可能应该这样做，你需要实现 setter/getter，但是下面的代码应该可以帮助你理解保存/加载对象......

```
 package youpackage.name.myapp;

 import java.io.FileInputStream;
 import java.io.FileOutputStream;
 import java.io.ObjectInputStream;
 import java.io.ObjectOutputStream;
 import java.io.Serializable;
 import java.util.ArrayList;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;

class saveData implements Serializable {
    private static final long serialVersionUID = 1L;
    private final int version = 101002;
    String title;
    int[] Int1 = new int[3];
    int[] Int2 = new int[3];
    int[] Int3 = new int[3];
    int Int;
}

public class MyAppActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        System.out.println("This next line creates instance of class to save");
        saveData mySaveData = new saveData();
        System.out.println("This next line sets the title...");
        mySaveData.title = "accept my answer...";
        ArrayList<saveData> myArrayList = new ArrayList<saveData>();
        System.out.println("This next line adds the object to the ArrayList");

        myArrayList.add(mySaveData);
        System.out.println("This next line saves the arraylist");
    saveArray("myFilename", myArrayList);
    System.out.println("This next line loads the arraylist back...");

    ArrayList<saveData> retrieveArrayList = openArray("myFilename");
    if (retrieveArrayList.size() > 0) {
    saveData retrievedSaveData = retrieveArrayList.get(0);
    System.out.println("if successful, the title set above will appear...");

    System.out.println("if save/retrieve works, then " + retrievedSaveData.title);
    }
    else {
        System.out.println("it did not work");
    }
}

void saveArray(String filename, ArrayList<saveData> arrayToSave) {
    FileOutputStream fos;
    ObjectOutputStream oos;
    try {
        fos = openFileOutput(filename, Context.MODE_PRIVATE); 
        oos = new ObjectOutputStream(fos);
        oos.writeObject(arrayToSave); 
        oos.close();
        fos.close();
    } catch (Exception e) {
        System.out.println(e.toString());
    }

}

ArrayList<saveData> openArray (String filename) {
    ArrayList<saveData> array = null;   
FileInputStream fis;     
ObjectInputStream ois;   
try {         
    fis = openFileInput(filename);       
ois = new ObjectInputStream(fis);         
array = (ArrayList<saveData>)ois.readObject(); 
ois.close();               
fis.close();     
}     catch (Exception e) {         
    System.out.println(e.toString());    
    }               
return array; 
} 
 } 
```

正如我在上一篇文章中提到的，以下更新的加载和保存方法提高了性能......

```
void saveArray2(String filename, ArrayList<saveData> arrayToSave) {
    try {   
        BufferedOutputStream bos = new BufferedOutputStream(openFileOutput(filename, Context.MODE_PRIVATE),8000);
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(arrayToSave); 
        oos.close();
        } catch (Exception e) {
        System.out.println(e.toString());
    }

}

ArrayList<saveData> openArray2 (String filename) {
    ArrayList<saveData> array = null;   

try {  
      BufferedInputStream bufIn = new BufferedInputStream(openFileInput(filename),8000);
ObjectInputStream ois = new ObjectInputStream(bufIn);         
array = (ArrayList<saveData>)ois.readObject(); 
ois.close();               
}     catch (Exception e) {         
    System.out.println(e.toString()); 
}

return array; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:42:17.347

我刚刚将您的私人成员更改为公共成员。你不希望你需要获取器和设置器来获取值。我也不知道你想要什么最终的静态版本成员......但这是一个好方法：

**包含数据的类**

```
class otherClass {

    static private final int version=101002;
    public String title;
    public int[] Int1=new int[3];
    public int[] Int2=new int[3];
    public int[] Int3=new int[3];
    public int Int;
} 
```

**读/写数据的类**

```
class saveData {

    public boolean write(ArrayList<otherClass> list, String fileName) {

        try {

            FileutputStream fos = new FileOutputStream(fileName);
            DataOutputStream dos = new DataOutputStream(fos);

            final int length = list.size();
            for (int i = 0; i < length; i++) {

                otherClass item = list.get(i);
                dos.writeUTF(item.title);
                dos.writeInt(item.Int1[0]);
                dos.writeInt(item.Int1[1]);
                dos.writeInt(item.Int1[2]);
                dos.writeInt(item.Int2[0]);
                dos.writeInt(item.Int2[1]);
                dos.writeInt(item.Int2[2]);
                dos.writeInt(item.Int3[0]);
                dos.writeInt(item.Int3[1]);
                dos.writeInt(item.Int3[2]);
                dos.writeInt(item.Int);
            }

            dos.close();
            fos.close();

            return true;

        } catch (IOException e) {

            return false;
        }
    }

    public ArrayList<otherClass> read(String fileName) {

        try {

            FileInputStream fos = new FileInputStream(fileName):
            DataInputStream dis = new DataInputStream(fis);
            ArrayList<otherClass> list = new ArrayList<otherClass>();
            while (dis.available() > 0) {

                otherClass item = new otherClass();
                item.title = dis.readUTF();
                item.Int1[0] = dis.readInt();
                item.Int1[1] = dis.readInt();
                item.Int1[2] = dis.readInt();
                item.Int2[0] = dis.readInt();
                item.Int2[1] = dis.readInt();
                item.Int2[2] = dis.readInt();
                item.Int3[0] = dis.readInt();
                item.Int3[1] = dis.readInt();
                item.Int3[2] = dis.readInt();
                item.Int = dis.readInt();

                list.add(item);
            }

            return list;

        } catch (IOException e) {

            return null;
        }
    }
} 
```

**示例用法**

```
saveData.write(list, "someFile");
list = saveData.read("someFile"); 
```

# jquery - 在 FireFox 11 中调用 fadeTo 时背景颜色变为白色的表格单元格

> ID：10237759
> 
> 赞同：1
> 
> 时间：2012-04-19T22:28:30.303
> 
> 标签：jquery, html-table

我有一张大桌子，每个 td 都有背景颜色。我也有以下代码：

```
 $('.table-cell').live('mouseover', function () {
        $(this).stop().fadeTo('slow', 0.7);
    });

    $('.table-cell').live('mouseout', function () {
        $(this).stop().fadeTo('fast', 1.0);
    }); 
```

鼠标悬停工作正常。颜色会很好地更改为较低的不透明度，但是当您的鼠标离开单元格时，单元格会变为白色（除了继续具有彩色背景的文本）。褪色完成后，颜色会正常恢复，但在变化时看起来真的很糟糕。

我们在 FireFox 11 和 IE8 中遇到了这个问题（7 和 9 工作正常）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T23:50:19.793

问题是`border-collapse: collapse;`这将解决问题

```
table
{
    border-collapse:separate;
} 
```

[**例子**](http://jsfiddle.net/cKWcv/5/)

在评论中，我注意到[**这个小提琴**](http://jsfiddle.net/cKWcv/)不像`Chrome`in那样工作，`FF`因为`Normalized CSS`被检查过，这个[**小提琴**](http://jsfiddle.net/cKWcv/6/)在. 检查[**此答案**](https://stackoverflow.com/questions/6887336/what-is-the-different-between-normalize-css-and-reset-css)以了解使用.`Chrome``FF``Normalized CSS`[](https://stackoverflow.com/questions/6887336/what-is-the-different-between-normalize-css-and-reset-css)**`Normalized CSS``border-collapse: collapse;`**

 **[**Nnormalize.css 链接**](https://raw.github.com/necolas/normalize.css/master/normalize.css)**

# ruby-on-rails - RSpec：为什么不让工作但 before(:each) 工作？

> ID：10237763
> 
> 赞同：2
> 
> 时间：2012-04-19T22:28:40.007
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, rspec2

我有当前的规格：

```
describe "DELETE 'destroy'" do
  let(:client) { create(:client) }

  #before(:each) do
    #@client = create(:client)
  #end

  it "should delete a client" do
    expect {
      delete :destroy, :id => client
    }.to change(Client, :count).by(-1)
  end

  # ...

end 
```

该示例在我使用时失败，`let`但在我使用`before(:each)`.

下面是实现代码：

```
def destroy
  client = Client.find(params[:id])
  if client.destroy
    flash[:success] = "Client deleted successfully"
    redirect_to kong_clients_url
  else
    flash[:error] = "Client not deleted for some reason"
    redirect_to kong_clients_url
  end
end 
```

那么为什么当我使用 let 时示例会失败？！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-19T22:40:48.793

`let` is lazy-evaluated, the record isn't created until you access the `client` property inside the expect/lambda (+1), but then it's immediately deleted (-1), so overall inside the expectation the count doesn't change.

You can use `let!` to force it to evaluate straight away:

```
let!(:client) { create(:client) } 
```

# objective-c - 转换字符串中的 HTML 特殊字符

> ID：10237765
> 
> 赞同：1
> 
> 时间：2012-04-19T22:29:20.563
> 
> 标签：objective-c, encoding, html-parsing

通过 Google 的 JSON 解析器，我得到一个字符串。但它包含所有 html 格式的特殊字符，例如`&#39;`代替`'`.

你知道是否有特殊的编码，或者某种方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T00:12:11.197

查看[适用于 Mac 的 Google 工具箱](http://code.google.com/p/google-toolbox-for-mac/)，特别是[GTMNSString+HTML](http://code.google.com/p/google-toolbox-for-mac/source/browse/trunk/Foundation/GTMNSString%2BHTML.h)类别。`- (NSString *)gtm_stringByUnescapingFromHTML;`是你需要的。

# soundcloud - SoundCloud：最热门的曲目 - API 与网页

> ID：10237771
> 
> 赞同：0
> 
> 时间：2012-04-19T22:29:50.400
> 
> 标签：soundcloud

我注意到 SoundCloud API 返回的最热门曲目与 SoundCloud 网页上显示的最热门曲目明显不同。此外，API 返回的最热门曲目的变化相当缓慢，许多曲目在该列表中停留了很长时间。这样做有故意的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T23:36:04.437

这两个页面使用略有不同的方法和缓存策略来收集热门曲目列表。所以不幸的是，目前我们不能保证这两个列表是匹配的。对不起

# python - 为什么 scipy 暴露 Lapack pbsv（b 表示带状，例如 linalg.solveh_banded）而不暴露 ptsv（t 表示三对角线）？

> ID：10237777
> 
> 赞同：0
> 
> 时间：2012-04-19T22:30:32.677
> 
> 标签：python, scipy, lapack, enthought, intel-mkl

查看 scipy.linalg.solveh_banded 的源代码，它只是包装了 Lapack pbsv。我正在为我认为应该由 Lapack ptsv 函数提供的三对角（厄米特，或在我的情况下为实对称）系统寻找更有效的求解器。此外，如果我沿着主对角线的（所有正）值的动态范围太大，即使这不应该是一个实际问题，solveh_banded 也会崩溃（我猜四舍五入会使最小值看起来实际上是负数，所以它是被视为具有负特征值）并且有一些机会特定于三对角线的例程不会遇到这个问题。

根据我对 Lapack 的阅读，似乎 ptsv 应该包含在任何具有 pbsv 的发行版中（文档总是将它们一起列出）。我不确定哪个会更有效（pbsv 假定对称但具有任意带宽，而 ptsv 假定三对角线但不一定是对称的）但似乎值得尝试 ptsv。

不幸的是，ptsv 似乎没有在 scipy 中公开，我相信这在实践中意味着它不包含在 scipy.linalg.flapack 中，因此不能通过 scipy.linalg.get_lapack_funcs(('ptsv',)) 获得。

我意识到与 scipy 的 Fortran/Lapack 链接很复杂，但有人知道为什么 pbsv 和 ptsv 会被区别对待吗？有什么我可以手动编辑的东西来尝试像 pbsv 一样包装 ptsv（不幸的是，flapack 似乎只是作为“.so”提供，所以我遇到了死胡同）？

FWIW 我将 Enthought EPD 与英特尔 MKL 一起使用。但是，鉴于 scipy.linalg （独立于分布）始终包含solveh_banded，但没有三对角求解器，我认为它必须比EPD / MKL问题更深。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T14:56:48.007

并非所有的 Lapack 都暴露在 scipy 中。

如果一个函数没有公开，那么很可能是因为没有人需要它，或者因为没有人需要它，所以编写了包装器。

例如，这里有一些公开附加功能的拉取请求

[https://github.com/scipy/scipy/pull/124](https://github.com/scipy/scipy/pull/124)

[https://github.com/scipy/scipy/pull/76](https://github.com/scipy/scipy/pull/76)

[https://github.com/scipy/scipy/pull/185](https://github.com/scipy/scipy/pull/185)

我不知道如何在 github 上找到 solveh_banded 的初始提交。

# c# - System.Data.OleDb.OleDbException：INSERT INTO 语句中的语法错误

> ID：10237780
> 
> 赞同：2
> 
> 时间：2012-04-19T22:30:49.133
> 
> 标签：c#, asp.net, sql, oledb

```
 public void RegisterUser(string passw,string uname ,string fname ,string lname, string email)
{
    string strSql = @"INSERT INTO User (passw,uname,fname,lname,email) values ('" + passw + "','" + uname + "','" + fname + "','" + lname + "','" + email + "')";                                                           
    cn.Open();
    OleDbCommand cmd = new OleDbCommand(strSql,cn);
    int yy= cmd.ExecuteNonQuery();
    cn.Close();
    cn.Dispose();

} 
```

**无论我做什么，我都会遇到同样的错误** ，有人在这里看到有问题吗？或者有另一种创造性的方法来解决这个问题谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T00:07:47.297

您的代码可以根据用户输入动态更改。这就是导致错误的原因。

让我解释一下您的任何输入字段是否包含撇号 [ ' ] sql 会中断并且现在有一个未闭合的引号。

不仅如此，它还会将您的代码暴露给**SQL-Injection Attacks**。

所以我建议你使用**参数**来传递值，因为参数被区别对待并且是安全的以及防止 SQL 注入。

```
 public void RegisterUser(string passw,string uname ,string fname ,string lname, string email)
{
    string strSql = @"INSERT INTO User (passw,uname,fname,lname,email) values     (@passw,@uname,@fname,@lname,@email)";                                                           
    cn.Open();
    OleDbCommand cmd = new OleDbCommand(strSql,cn);
    cmd.Parameters.AddWithValue("@passw",passw);
    cmd.Parameters.AddWithValue("@uname",uname);
    cmd.Parameters.AddWithValue("@fname",fname);
    cmd.Parameters.AddWithValue("@lname",lname);
    cmd.Parameters.AddWithValue("@email",email);
    int yy= cmd.ExecuteNonQuery();
    cn.Close();
    cn.Dispose();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T01:19:04.050

在 Oracle 中，`user`是保留字并`INSERT INTO User ...`生成`ORA-00903: invalid table name`.

# c# - 从富文本框控件获取当前滚动位置？

> ID：10237781
> 
> 赞同：9
> 
> 时间：2012-04-19T22:30:56.827
> 
> 标签：c#, winforms, .net-4.0, scrollbar, richtextbox

我已经在互联网上广泛搜索并看到了很多这样的问题，但我还没有看到真正的答案。

我有一个包含大量文本的富文本框控件。它在此控件中有一些法律信息。默认情况下，“接受”按钮被禁用。如果 v-scroll bar 的位置在底部，我想检测滚动事件。如果它位于底部，请启用该按钮。

我将如何检测当前的垂直滚动条位置？

谢谢你！

**编辑** 我正在使用 WinForms (.Net 4.0)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-20T00:32:23.813

这应该让你接近你正在寻找的东西。这个类继承自 RichTextBox 并使用一些 pinvoking 来确定滚动位置。它添加了一个事件`ScrolledToBottom`，如果用户使用滚动条滚动或使用键盘，则会触发该事件。

```
public class RTFScrolledBottom : RichTextBox {
  public event EventHandler ScrolledToBottom;

  private const int WM_VSCROLL = 0x115;
  private const int WM_MOUSEWHEEL = 0x20A;
  private const int WM_USER = 0x400;
  private const int SB_VERT = 1;
  private const int EM_SETSCROLLPOS = WM_USER + 222;
  private const int EM_GETSCROLLPOS = WM_USER + 221;

  [DllImport("user32.dll")]
  private static extern bool GetScrollRange(IntPtr hWnd, int nBar, out int lpMinPos, out int lpMaxPos);

  [DllImport("user32.dll")]
  private static extern IntPtr SendMessage(IntPtr hWnd, Int32 wMsg, Int32 wParam, ref Point lParam);

  public bool IsAtMaxScroll() {
    int minScroll;
    int maxScroll;
    GetScrollRange(this.Handle, SB_VERT, out minScroll, out maxScroll);
    Point rtfPoint = Point.Empty;
    SendMessage(this.Handle, EM_GETSCROLLPOS, 0, ref rtfPoint);

    return (rtfPoint.Y + this.ClientSize.Height >= maxScroll);
  }

  protected virtual void OnScrolledToBottom(EventArgs e) {
    if (ScrolledToBottom != null)
      ScrolledToBottom(this, e);
  }

  protected override void OnKeyUp(KeyEventArgs e) {
    if (IsAtMaxScroll())
      OnScrolledToBottom(EventArgs.Empty);

    base.OnKeyUp(e);
  }

  protected override void WndProc(ref Message m) {
    if (m.Msg == WM_VSCROLL || m.Msg == WM_MOUSEWHEEL) {
      if (IsAtMaxScroll())
        OnScrolledToBottom(EventArgs.Empty);
    }

    base.WndProc(ref m);
  }

} 
```

这就是它的使用方法：

```
public Form1() {
  InitializeComponent();
  rtfScrolledBottom1.ScrolledToBottom += rtfScrolledBottom1_ScrolledToBottom;
}

private void rtfScrolledBottom1_ScrolledToBottom(object sender, EventArgs e) {
  acceptButton.Enabled = true;
} 
```

根据需要进行调整。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-07-15T11:05:52.267

以下在我的一个解决方案中效果很好：

```
Point P = new Point(rtbDocument.Width, rtbDocument.Height);
int CharIndex = rtbDocument.GetCharIndexFromPosition(P);

if (rtbDocument.TextLength - 1 == CharIndex)
{
   btnAccept.Enabled = true;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-19T23:41:51.987

问题[如何获取 RichTextBox 的滚动位置？](https://stackoverflow.com/questions/9490182/how-to-get-scroll-position-for-richtextbox) 可能会有所帮助，请查看此功能

```
 richTextBox1.GetPositionFromCharIndex(0); 
```

# ios - xCode 4.3.3 - 配置文件管理

> ID：10237785
> 
> 赞同：0
> 
> 时间：2012-04-19T22:31:16.997
> 
> 标签：ios, xcode, macos, osx-lion

Apple 发布 iOS 5.1 后，为了在设备上调试我的软件，我被迫升级到 xCode 4.3，由于某种原因，这也需要我的整个 OSX 升级到 Lion。

更糟糕的是，新的 xcode 的管理器似乎完全被破坏了。

1.  由于 SSL 错误，无法刷新配置文件。重新启动mac没有帮助。使用 Safari，我可以毫无问题地访问 developer.apple.com 和 iTunes Connect。
2.  无法查看配置文件的设备（以前的 xCode 有一个面板，上面写着“const iPhone 4、const iPhone 3G 和 43 个其他设备”）。有没有办法在 xCode 4.3.3 中查看相同的信息？
3.  在“Provisioning Profiles”选项卡上，“Creation”和“Expiration”列无法调整大小，并且日期被省略号截断。

有解决方法吗？我可以在 OSX Lion 上安装 xCode 4.2 和 4.3 并使用它来管理我的配置文件吗？因为新的 IMO 严重损坏。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-27T08:16:11.793

我最终基本上把我所有的旧证书都扔掉了，然后又把它们全部拿走了。

他们煞费苦心地通知您，这不会影响您当前在商店中拥有的应用程序。

# c# - 使文本框可写入外部对象

> ID：10237786
> 
> 赞同：0
> 
> 时间：2012-04-19T22:31:20.460
> 
> 标签：c#, textbox, set

我仍然掌握 c# 中的 get set 方法的窍门，并且我正在尝试使私有文本框可从表单类的外部写入。

所以我有以下代码。

```
private System.Windows.Forms.ToolStripMenuItem aboutToolStripMenuItem;
private System.Windows.Forms.FlowLayoutPanel flowLayoutPanel2;
private System.Windows.Forms.TextBox textBox2;

        public textBox2
        {
          set
           {
        texbox2.text = value;
            }
        } 
```

而我想要做到这一点，这样我就可以从主程序线程更新文本框 2 中的文本，而不会使整个 textbox2 公开？但不知道该怎么做？

我知道上面的代码完全不正确，但我希望它显示了我正在尝试做的事情。

谢谢

亚伦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:35:11.177

您只需要像这样声明您的财产：

```
public string textBox2Text
{
    get
    {
        return textbox2.Text;
    }
    set
    {
        texbox2.Text = value;
    }
} 
```

您没有为您的属性声明类型，而是复制了文本框的 ID。`get`如果您不需要或不想要它，请忽略该块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:35:38.917

我会这样做

```
 public string TextBoxText
    {
        get { return textbox1.Text; }
        set { textbox1.Text = value == null ? "" : value; }
    } 
```

# wordpress - WordPress 不会使用绝对 URI 在帖子中呈现链接

> ID：10237794
> 
> 赞同：0
> 
> 时间：2012-04-19T22:31:48.367
> 
> 标签：wordpress, permissions, hyperlink

我继承了一个有很多问题的网站，其中一个让我很困惑（注意：我不是 WordPress 专家，所以这可能是一个愚蠢的问题）。

当我的用户创建博客文章并使用链接构建器时，他们正在使用“来自现有内容”选项创建链接，该选项只是嵌入了一个完整的（永久链接）url。它节省了，他们继续。但是，当将帖子呈现给公众时，不会呈现链接。仔细检查管理员，链接仍然在帖子中，所以它没有被剥离，但我可以想象什么（或为什么）会禁用链接被呈现。这并不是说文本没有超链接。文本根本不显示。查看源代码显示它不存在。

这是别人见过的吗？

**更多信息**

如果我将 href 中的 url 修改为相对路径，我可以显示链接。绝对路径失败了……奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T00:12:11.580

禁用所有插件，看看问题是否消失。如果是这样，请一次重新启用它们，直到找到罪魁祸首。

如果这不起作用，那可能是您的主题。您可以通过切换到默认主题来验证这一点，看看是否可以修复它。然后，您需要在主题文件（尤其是 functions.php）中搜索任何`add_filter`函数调用。罪魁祸首很可能`add_filter('the_content', 'some function thats stripping the links')`

如果这对你不起作用，请告诉我。

# wix - 使用 WIX 的小升级和补丁

> ID：10237803
> 
> 赞同：1
> 
> 时间：2012-04-19T22:32:24.017
> 
> 标签：wix, windows-installer

我们的应用程序有一个安装程序 (msi)。它引用了耦合在一起的第三方组件、系统和应用程序 dll（在相同的功能中）。现在我们想为应用程序更改（添加和删除功能/组件）创建一个 msi。主要升级不是一个选项，因为我们不想卸载第三方和系统 dll。如何使用小升级来实现这一点？我是 WIX 新手，无法找到更好的解决方案。非常感谢任何帮助。提前致谢 ！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T14:05:32.863

我想，您应该从了解存在哪些类型的升级以及每个升级在 Windows Installer 方面的含义开始。[这个 MSDN 部分](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370579.aspx)是一个好的开始。当您理解它以便您可以有意识地选择您需要的升级类型时，请学习如何通过 WiX 进行升级。[本教程章节](http://wix.tramontana.co.hu/tutorial/upgrades-and-modularization)将为您提供帮助。WiX.chm（与 WiX 工具集一起安装）还包含几个有关升级的主题。

# asp.net - 托管代码库被卸载

> ID：10237805
> 
> 赞同：1
> 
> 时间：2012-04-19T22:32:34.043
> 
> 标签：asp.net, unmanaged, libraries, managed

我有一个相当奇怪的情况，我真的不知道如何正确地表达它......

**情况是这样的：**

我有一个 ASP.NET Web 应用程序 (WA)。它引用调用非托管动态库 (DLL) 的程序集 (CL1)。此 DLL 引用来自另一个库 (LIB) 的方法，该库又调用托管代码类库 (CL2)。

所以链条是这样的：`WA -> CL1 -> DLL -> LIB -> CL2`

我在调试模式下启动我的 Web 应用程序。一切正常。我在浏览器中看到一个页面，显示从最后一个类库 CL2 获得的结果（假设是某个非空字符串）。现在我在 TFS 中的 Web 应用程序中签出一个文件。Visual Studio 不会停止调试过程，但是，正如我所假设的，它会卸载应用程序、终止会话等。

我转到浏览器并刷新页面 - 应用程序重新启动，页面正在呈现，但结果从 LIB 到 CL2 的调用不再起作用。而不是字符串，我得到一个错误的指针。

当我停止调试并重新启动它（硬重启？） - 一切都开始按预期工作。

我假设在我的应用程序结束然后再次启动（软重启？）后，由于某种原因它无法重新加载我的 CL2。

**我的问题：** *有什么办法可以防止这种情况发生吗？*

# c# - Windows Phone - 找不到 XmlDocument

> ID：10237809
> 
> 赞同：6
> 
> 时间：2012-04-19T22:32:55.823
> 
> 标签：c#, windows-phone-7, xmldocument

在我的 Windows 手机应用程序中，我需要使用 XmlDocument 类。但我仍然收到错误

`Error 1 The type or namespace name 'XmlDocument' could not be found (are you missing a using directive or an assembly reference?)`

我添加了参考和 `using System.Xml`

但它没有帮助。

这是我的 SOAP 示例代码，我需要修改它以使用 XDocument **Edit - 添加了 SOAP 示例代码**

```
public static void CallWebService()
    {
        var _url = "http://xxxxxxxxx/Service1.asmx";
        var _action = "http://xxxxxxxx/Service1.asmx?op=HelloWorld";

        XmlDocument soapEnvelopeXml = CreateSoapEnvelope()
        HttpWebRequest webRequest = CreateWebRequest(_url, _action);
        InsertSoapEnvelopeIntoWebRequest(soapEnvelopeXml, webRequest);

        // begin async call to web request.
        IAsyncResult asyncResult = webRequest.BeginGetResponse(null, null);

        // suspend this thread until call is complete. You might want to
        // do something usefull here like update your UI.
        asyncResult.AsyncWaitHandle.WaitOne();

        // get the response from the completed web request.
        string soapResult;
        using (WebResponse webResponse = webRequest.EndGetResponse(asyncResult))
        using (StreamReader rd = new StreamReader(webResponse.GetResponseStream()))
        {
            soapResult = rd.ReadToEnd();
        }
        Console.Write(soapResult);
}

    private static HttpWebRequest CreateWebRequest(string url, string action)
    {
        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(url);
        webRequest.Headers.Add("SOAPAction", action);
        webRequest.ContentType = "text/xml;charset=\"utf-8\"";
        webRequest.Accept = "text/xml";
        webRequest.Method = "POST";
        return webRequest;
    }

    private static XmlDocument CreateSoapEnvelope()
    {
        XmlDocument soapEnvelop = new XmlDocument();
        soapEnvelop.LoadXml(@"<SOAP-ENV:Envelope xmlns:SOAP-ENV=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:xsi=""http://www.w3.org/1999/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/1999/XMLSchema""><SOAP-ENV:Body><HelloWorld xmlns=""http://tempuri.org/"" SOAP-ENV:encodingStyle=""http://schemas.xmlsoap.org/soap/encoding/""><int1 xsi:type=""xsd:integer"">12</int1><int2 xsi:type=""xsd:integer"">32</int2></HelloWorld></SOAP-ENV:Body></SOAP-ENV:Envelope>");
        return soapEnvelop;
    }

    private static void InsertSoapEnvelopeIntoWebRequest(XmlDocument soapEnvelopeXml, HttpWebRequest webRequest)
    {
        using (Stream stream = webRequest.GetRequestStream())
        {
            soapEnvelopeXml.Save(stream);
        }
    }` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:42:53.310

它[在 WP7 中支持](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)

![在此处输入图像描述](../Images/229dd5fb3590260da6b02a39837d545a.png)

Linq 的示例在这里： http: [//www.windowsphonegeek.com/tips/wp7-working-with-xml-reading-filtering-and-databinding](http://www.windowsphonegeek.com/tips/wp7-working-with-xml-reading-filtering-and-databinding)

源代码示例： [http ://www.c-sharpcorner.com/UploadFile/74f20d/read-local-xml-file-from-windows-phone-7/](http://www.c-sharpcorner.com/UploadFile/74f20d/read-local-xml-file-from-windows-phone-7/)

# c# - ASP.NET mvc3 网页不会将文件上传到服务器

> ID：10237810
> 
> 赞同：3
> 
> 时间：2012-04-19T22:32:58.690
> 
> 标签：c#, asp.net-mvc-3, file-upload

我试图在我的数据库中存储一个类别对象并上传一个我可以参考这个类别的图像，

该类别已完美存储，但由于某种原因未上传图像。当我调试时，我可以看到我的应用程序永远不会进入将文件存储在服务器上的方法，因为我的文件是“Null”。

模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Data.Entity;

namespace SkyLearn.Areas.Categories.Models
{
    public class Category
    {
        public int ID { get; set; }
        public string Title { get; set; }
        public string Icon { get; set; }
        public string Description { get; set; }
    }

    public class CategoryDBContext : DbContext
    {
        public DbSet<Category> categories { get; set; }
    }
} 
```

控制器：

```
//
// POST: /Categories/Category/Create
[Authorize(Roles = "administrator")]
[HttpPost]
public ActionResult Create(Category category, HttpPostedFileBase Icon)
{
    if (Icon != null && Icon.ContentLength > 0)
    {
        // extract only the filename
        var fileName = Path.GetFileName(Icon.FileName);
        // store the file inside ~/App_Data/uploads folder
        var path = Path.Combine(Server.MapPath("../Content/icons/"), fileName);
        Icon.SaveAs(path);
        category.Icon = fileName;
    }

    if (ModelState.IsValid)
    {
        db.categories.Add(category);
        db.SaveChanges();
        return RedirectToAction("Index");  
    }

    return View(category);
} 
```

看法：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.master" Inherits="System.Web.Mvc.ViewPage<SkyLearn.Areas.Categories.Models.Category>" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
    Create
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">

<h2>Create</h2>

<script src="<%: Url.Content("~/Scripts/jquery.validate.min.js") %>" type="text/javascript"></script>
<script src="<%: Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js") %>" type="text/javascript"></script>

<% using (Html.BeginForm()) { %>
<form action="" method="post" enctype="multipart/form-data">
    <%: Html.ValidationSummary(true) %>
    <fieldset>
        <legend>Category</legend>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.Title) %>
        </div>
        <div class="editor-field">
            <%: Html.EditorFor(model => model.Title) %>
            <%: Html.ValidationMessageFor(model => model.Title) %>
        </div>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.Icon) %>
        </div>
        <div class="editor-field">
            <input type="file" name="icon" id="icon"/>
        </div>

        <div class="editor-label">
            <%: Html.LabelFor(model => model.Description) %>
        </div>
        <div class="editor-field">
            <%: Html.EditorFor(model => model.Description) %>
            <%: Html.ValidationMessageFor(model => model.Description) %>
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
</form>
<% } %>

<div>
    <%: Html.ActionLink("Back to List", "Index") %>
</div>

</asp:Content> 
```

谁能告诉我为什么它不会进入保存文件ID的方法，不胜感激。

我尝试在stackoverflow上查看其他答案，即使其中一些与我有同样的问题，但他们的解决方案并没有解决我的问题。

我还尝试在我的 config.web 中更改上传大小等。

请帮我 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:51:36.883

我不知道浏览器会如何处理嵌套表单，但是使用`Html.BeginForm()`然后手动写出表单标签是没有意义的。`Html.BeginForm()`具有输出 Html 属性的重载：

```
Html.BeginForm(action, controller, 
    FormMethod.Post, new { enctype="multipart/form-data" }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:46:16.287

ModelBinder 可能正在爆炸。当您的表单按原样设置时，您不能为您的操作方法命名`Icon`，也不能在您的`Category`类上命名一个属性`Icon`（所有表单值都将与`Category`属性匹配）。

此外，您的表单字段名称是小写“图标”，而不是您在 C# 中的匹配大写“图标”

您可能可以创建一个自定义类，该操作方法将从表单帖子中接收到：

```
public class CategoryWithFile : Category
{
    public HttpPostedFileBase IconFile { get; set; }
} 
```

然后在您的操作方法上设置该参数

```
public ActionResult Create(CategoryWithFile category) 
```

并将您的表格更改为：

```
 <div class="editor-label">
     <label for="IconFile">Icon: </label>
 </div>
 <div class="editor-field">
     <input type="file" name="IconFile" id="IconFile"/>
 </div> 
```

# django - 为什么在我的模板中未使用“user.is_authenticated”检测到登录用户？

> ID：10237815
> 
> 赞同：0
> 
> 时间：2012-04-19T22:33:15.340
> 
> 标签：django, django-templates, django-authentication

在我的模板中，我有

```
{% if user.is_authenticated %}
<li><a href="http://127.0.0.1:8000/logout/">Logout</a></li>
{% endif %} 
```

如果用户已登录，它将向导航栏添加一个按钮。该代码适用于所有具有 @login_required 或 @permission_required 的视图，但如果用户浏览允许但已登录用户和匿名的页面，则它无法识别用户用户。知道为什么会这样和/或如何解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:50:10.367

你需要有：

```
django.contrib.auth.context_processors.auth 
```

你的上下文处理器`settings.py`，你需要通过

```
RequestContext 
```

到视图，以便`user`在您的上下文中具有。

# cocoa - 使用 openUntitledDocumentOfType 创建文档时出错

> ID：10237820
> 
> 赞同：1
> 
> 时间：2012-04-19T22:33:48.207
> 
> 标签：cocoa, webkit

我正在尝试使用以下语句来创建文档：

```
id myDocument = [[NSDocumentController sharedDocumentController] openUntitledDocumentOfType:@"MyClass" display:YES]; 
```

尽管事实上它是项目`myDocument`中的一个真实类并且继承自.`nil``MyClass``NSDocument`

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:01:15.017

`type`方法中的是应用程序文件`openUntitledDocumentOfType:display:`中指定的文档类型名称，而不是文档类的名称。`CFBundleDocumentTypes``Info.plist`

具体来说，您需要输入与`CFBundleTypeName`您要打开的文档类型相对应的键值。这个值在 Xcode 的属性列表编辑器中默认标记为`Document Type Name`：

![Xcode 属性列表检查器](../Images/3d5ea6a8de8d66822ef5bdd56e731e86.png)

它也可以在`Document Types`项目设置的 Info 选项卡的编辑器中进行编辑：

![在此处输入图像描述](../Images/168c42a1def05c60060c1adc120a9bbe.png)

# java - 我会通过使用朋友操作来检索friendMemberList，但我总是列表的最后一个成员？

> ID：10237823
> 
> 赞同：1
> 
> 时间：2012-04-19T22:34:05.117
> 
> 标签：java, spring, jsp, facebook-graph-api, spring-social

```
@RequestMapping(value="/facebook/friendlist", method=RequestMethod.GET)
public String showFeed(Model model) {
    List<Reference> friendLists = facebook.friendOperations().getFriendLists();
    model.addAttribute("friendLists", friendLists);

    //retourner les membres d'amis de la liste 
    for (int i =0; i< friendLists.size() ;i++) {
        System.out.println(friendLists.size());
    List<Reference> friendListMembers= facebook.friendOperations().getFriendListMembers(friendLists.get(i).getId());
    model.addAttribute("friendListMembers", friendListMembers);
    System.out.println(friendLists.get(i).getId());
    System.out.println(friendListMembers);  
    } 
```

我认为问题出在jsp页面中，如何解决。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T00:14:21.540

您正在覆盖`friendListMembers`模型中的值，因此只有`friendLists`数组中的最后一个条目才能使其成员在 JSP 代码中可用。

您需要模型中的二维数组，键是好友列表 ID，值是好友列表的成员数组

简单示例：

在您的 java 代码中：

```
ArrayList<String,List> allFriends = new ArrayList();

for (int i =0; i< friendLists.size() ;i++) {
    String friendListId = friendLists.get(i).getId();
    List<Reference> friendListMembers= facebook.friendOperations().getFriendListMembers(friendListId);
    allFriends.add(friendListId, friendListMembers);
    }
    model.addAttribute("allFriends", allFriends); 
```

在您的 JSP 代码中：

```
<c:forEach items="${allFriends}" var="list">
        <c:forEach items="${list}" var="friend">
            <c:out value="${friend.id}"/>:<c:out value="${friend.name}"/><br/>
        </c:forEach>
        <hr/>
</c:forEach> 
```

请注意，我没有对此进行测试，如果它在复制/粘贴时有效，我会感到惊讶，这只是一个让你走上正轨的想法

# wpf - 在 Revit 中打开 wpf 窗口作为加载项

> ID：10237824
> 
> 赞同：0
> 
> 时间：2012-04-19T22:34:11.377
> 
> 标签：wpf, add-in, revit

我使用 WPF 制作了一个项目，我想在 Revit 中打开它的窗口我尝试 Windows 窗体它工作但 wpf 没有打开！

我用这个

```
public virtual Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
    {
        IDesign.MainWindow testsd = new IDesign.MainWindow();
        testsd.InitializeComponent();
        //MessageBox.Show("notworking");
        return Result.Succeeded;
    } 
```

但它没有任何解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:49:46.637

```
public virtual Result Execute(ExternalCommandData commandData, ref string message, ElementSet elements)
    {
        IDesign.MainWindow testsd = new IDesign.MainWindow();
        //testsd.InitializeComponent();
        //MessageBox.Show("notworking");
        return Result.Succeeded;
    }

 public MainWindow()
        {
            InitializeComponent();
            this.ShowDialog();
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-10T07:42:04.380

您可能想要创建一个 WPF 用户控件并将其指定为 Revit 外部命令中的 WPF 窗口的内容，例如：

```
UserControl1 userControl = new UserControl1();
Window win = new Window();
win.Content = userControl;
win.Show(); 
```

# blackberry - Cordova Sencha Touch Blackberry App java.lang.illegalArgumentException

> ID：10237829
> 
> 赞同：0
> 
> 时间：2012-04-19T22:34:38.887
> 
> 标签：blackberry, cordova, sencha-touch

我开发了一个 sencha touch 应用程序，当从网站打开时，它可以在所有支持的手机上正常运行。

当我使用 cordova 1.5 和 1.6 将应用程序构建为本机 phonegap 应用程序时，该应用程序再次在 android 手机（尚未尝试过 iphone）和波纹模拟器中运行。但是，当我在 Blackberry Webworks 模拟器或黑莓手机上加载应用程序时，我得到一个 java.lang.illegalArgumentException。

我什至将应用程序剥离为一个 hello world 示例，但我仍然遇到同样的错误。

我已经设法让示例科尔多瓦应用程序在黑莓上运行，所以我知道手机不是问题。

对这个问题的任何帮助将是一个很大的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T22:17:29.123

经过大量的反复试验，结果发现错误是由我用于启动画面的 png 文件引起的。貌似启动画面图像必须小于 16 kb

# java - 无法使用输出流发送命令

> ID：10237830
> 
> 赞同：2
> 
> 时间：2012-04-19T22:34:40.257
> 
> 标签：java, process, cmd, bukkit

我正在尝试编写一个小型 Java 应用程序，它可以让我使用 Java Process/ProcessBuilder API 在屏幕外运行 Bukkit 服务器。

我能够很好地从服务器获取输出，但服务器不响应由`Process.getOutputStream()`（链接到进程输入流）返回的输出流写入的命令。

我尝试用我自己的测试代码来做这件事，它奏效了。`System.in`从接收到写入输出流的文本的单独进程读取。

Bukkit 是不听`System.in`还是怎么的？如果不是，那怎么可能？有任何想法吗？

```
try {
    ProcessBuilder pb = new ProcessBuilder();
    File dir = new File("C:/Users/Brian/Desktop/MC-Server/Bukkit-Testing");
    pb.directory(dir);
    pb.command(new String[] {"java", "-Xincgc", "-Xmx1G", "-jar", "craftbukkit-1.0.1-R1.jar"});
    pb.redirectErrorStream(true);
    final Process p = pb.start();
    InputStream out = p.getInputStream();
    BufferedReader r1 = new BufferedReader(new InputStreamReader(out));
    String s = null;
    new Thread(new Runnable() {

        @Override
        public void run() {
            BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(p.getOutputStream()));
            Scanner scan = new Scanner(System.in);
            String input = null;
            while((input=scan.nextLine()) != null) {
                if(input.equals("exit")) {
                    p.destroy();
                    break;
                }
                try {
                    bw.write(input);
                    bw.flush();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }

    }).start();
    while((s=r1.readLine()) !=null)
        System.out.println(s);
} catch (IOException e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-04T14:52:22.230

我不认为 Bukkit 使用它`System.in`，所以我们必须做一个解决方法。

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.logging.Logger;

import org.bukkit.Bukkit;
import org.bukkit.plugin.java.JavaPlugin;

public class ConsolePlugin extends JavaPlugin {

    public Logger log;

    public void onEnable(){
        log = this.getLogger();
        log.info("BufferedReader has been enabled!");
        new Thread(new Runnable(){
            public void run(){
                BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
                String line = null;
                while (true){
                    try {
                        line=br.readLine();
                    } catch (Exception e) {e.printStackTrace();}
                    if (line!=null){
                        Bukkit.dispatchCommand(Bukkit.getConsoleSender(), line);
                        System.out.println(line);
                    }
                }
            }
        }).start();
    }

    public void onDisable(){
        log.info("BufferedReader has been disabled.");
    }
} 
```

发送命令：

```
bw.write(input);
bw.nextLine();
bw.flush(); 
```

# iphone - NSURLConnection 不调用委托连接：willSendRequest:redirectResponse：

> ID：10237834
> 
> 赞同：1
> 
> 时间：2012-04-19T22:35:25.593
> 
> 标签：iphone, objective-c, nsurlconnection

我正在尝试检测 302 的 http 响应代码。这是我的请求行：

```
urlConnection = [[NSURLConnection connectionWithRequest:request delegate:response] retain]; 
```

该`response`变量是我创建的一个类的实例，它实现：

```
- (NSURLRequest *)connection:(NSURLConnection *)inConnection: 
             willSendRequest:(NSURLRequest *)inRequest 
            redirectResponse:(NSURLResponse *)inRedirectResponse 
{
    NSLog(@"redirect");
    return inRequest;
} 
```

但由于某种原因，这没有受到打击。我 100% 确定服务调用正在被击中并返回 302。为了让这个委托被调用，我还有没有写在文档中的其他东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:42:05.377

你有一个额外的冒号：

```
 ...(NSURLConnection *)inConnection***:*** willSend...
```

删除它，你应该很高兴。

（请记住，冒号是方法名称的一部分；您必须完全正确地使用它们！）

# c++ - To use Active object or not?

> ID：10237837
> 
> 赞同：8
> 
> 时间：2012-04-19T22:36:02.750
> 
> 标签：c++, design-patterns, boost-asio, reactor, active-objects

The active object design pattern as I understand is tying up a (private/dedicated) thread life time with an object and making it work on independent data. From some of the documentation I read , the evolution of this kind of paradigm was because of two reasons , first , managing raw threads would be pain and second more threads contending for the shared resource doesn't scale well using mutex and locks. while I agree with the first reason , I do not fully comprehend the second . Making an object active just makes the object independent but the problems like contention for lock/mutex is still there (as we still have shared queue/buffer), the object just delegated the sharing responsibility onto the message queue. The only advantage of this design pattern as i see is the case where I had to perform long asynch task on the shared object (now that i am just passing message to a shared queue , the threads no longer have to block for long on mutex/locks but they still will blocka and contend for publishing messages/task). Other than this case could someone tell more scenarios where this kind of design pattern will have other advantages.

The second question I have is (I just started digging around design patterns) , what is the conceptual difference between , active object , reactor and proactor design pattern . How do you decide in which design pattern is more efficient and suits your requirements more. It would be really nice if someone can demonstrate certain examples showing how the three design patterns will behave and which one has comparative advantage/disadvantage in different scenarios.

I am kind of confused as I have used active object (which used shared thread-safe buffer) and boost::asio(Proactor) both to do similar kind of async stuff , I would like to know if any one has more insights on applicability of different patterns when approaching a problem.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-27T13:09:38.323

[ACE 网站上有一些关于](http://www.cs.wustl.edu/~schmidt/patterns-ace.html)[Active Object](http://www.cs.wustl.edu/~schmidt/PDF/Act-Obj.pdf)、[Proactor](http://www.cs.wustl.edu/~schmidt/PDF/proactor.pdf)和[Reactor](http://www.cs.wustl.edu/~schmidt/PDF/reactor-siemens.pdf)设计模式的非常好的论文。他们意图的简短摘要：

**主动对象**设计模式将方法执行与方法调用分离，以增强并发性并简化对驻留在其自己的控制线程中的对象的同步访问。也称为：并发对象、Actor。

**Proactor**模式支持多个事件处理程序的多路分解和分派，这些事件处理程序由异步事件的完成触发。这种模式在 Boost.Asio 中被大量使用。

**Reactor**设计模式处理由一个或多个客户端同时交付给应用程序的服务请求。应用程序中的每个服务可能包含多个方法，并由一个单独的事件处理程序表示，该事件处理程序负责调度特定于服务的请求。也称为：调度程序、通知程序。

# amazon-cloudfront - 向 Amazon Cloudfront 上的文件添加 URL 参数 (?p=234) 不会强制刷新文件

> ID：10237838
> 
> 赞同：6
> 
> 时间：2012-04-19T22:36:04.857
> 
> 标签：amazon-cloudfront

我有通过 Amazon Cloudfront 提供的 JS 和 CSS 文件。到目前为止，我一直在使用我自己的服务器运行 Varnish，当我更新任何 JS 或 CSS 文件或使用新版本时，我必须在请求该文件的 URL 参数上增加一个计数器。

因此，被包含文件的 URL 将从 .../file.css?r=1 变为 .../file.css?r=2 并且 Varnish 会将其视为一个新文件，请求并缓存它并从那时起从缓存中提供它。

使用 Cloudfront，我意识到它不是那样工作的，它仍然提供旧的缓存文件（并且我在 HTTP 响应中不断收到“来自 Cloudfront 的命中”）。

知道我是否可以为此改变 Cloudfront 的行为吗？

我能做的任何其他事情并不意味着每次更新文件时实际上都会更改文件的名称？我也不想通过 Cloudfront 的 API 使用缓存失效。我认为这对于我在这里尝试做的事情来说太多了，而且我每个月可以提出的（免费）请求数量有限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-10T21:52:29.770

看起来您提前了一个月左右……2012 年 5 月中旬，亚马逊宣布您可以开始使用查询字符串来识别云前端缓存中的对象。

这是他们博客上公告的链接：http: [//aws.typepad.com/aws/2012/05/amazon-cloudfront-support-for-dynamic-content.html](http://aws.typepad.com/aws/2012/05/amazon-cloudfront-support-for-dynamic-content.html)

不幸的是，我在我的快速谷歌搜索中没有看到任何描述你如何做到这一点的链接，但我确信它隐藏在他们的文档或控制面板的某个地方。

希望这能让你朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:49:05.177

不幸的是，如果您想避免重命名文件，通过 CloudFront 的 API 失效似乎是目前唯一可用的选项。但是，通过自动化部署过程可以最大程度地减少重命名文件的痛苦。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-19T23:21:03.703

简短的回答，不。CDN 应该用于不经常更改的静态资产。

从他们的[文档中](http://docs.amazonwebservices.com/AmazonCloudFront/latest/DeveloperGuide/LinkFormat.html?r=1095)：

> 当 CloudFront 从源服务器请求对象时，它会删除所有查询字符串参数。

确保您的服务器设置为正确传递`Expires`标头和/或`Cache-Control: max-age`标头。我们目前使用 max-age=1800

# iphone - 为什么 stringByReplacingPercentEscapesUsingEncoding: 不将 L%C3%A9on 转换回 Léon？

> ID：10237842
> 
> 赞同：2
> 
> 时间：2012-04-19T22:36:30.420
> 
> 标签：iphone, objective-c, ios, xcode, cocoa-touch

我有以下内容：

```
modifiedTitle = @"Léon";
modifiedTitle = [modifiedTitle stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSLog(@"%@", modifiedTitle); 
```

转换后，它现在显示为`L%C3%A9on`.

当我运行以下命令时，它不会将其转换回来：

```
NSMutableString *searchText = [NSMutableString stringWithString:modifiedTitle];
[searchText stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSLog(@"%@", searchText); 
```

它仍然显示为`L%C3%A9on`。

有谁知道为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:41:34.287

因为`stringByReplacingPercentEscapesUsingEncoding:`返回一个新字符串。试试这个：

```
NSMutableString *searchText = [NSMutableString stringWithString:modifiedTitle];
NSString *newText = [searchText stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSLog(@"%@", newText); 
```

# c++ - 函数指针类型如何不安全

> ID：10237847
> 
> 赞同：10
> 
> 时间：2012-04-19T22:36:54.590
> 
> 标签：c++

首先，类型安全意味着编译器如果执行不正确可以立即捕获的任何内容。

现在，我听说函数指针不是类型安全的，但是每当我尝试错误地使用它们时，编译器都会为我报告错误。那么，它的类型如何不安全？

例如，这是一个函数原型，它接受一个函数指针

```
void SortElements(void* MyArray, unsigned int iNumofElems,size_t size, int(*compare_funct)(void* First,void* SecondElem)) 
```

我已经定义了几个函数来传递给它：

```
int MySortAsc(void* First, void* Second);
void MyFunct2();
void MyFunct3(void* First); 
```

该代码仅编译用于：

```
SortElements(MyArray, 10, sizeof(DataType), &MySortAsc); //Compiles
SortElements(MyArray, 10, sizeof(DataType), &MyFunct2);  //Fails 
```

知道如何在这里误用函数指针吗？

是不是因为这个：

```
void (*functionPointer)();
...
int integer = 0xFFFFFFFF;     
functionPointer = (void(*)())integer;      
functionPointer(); 
```

答：我看到的是 C++ 中的函数指针是类型安全的。当然，它们可以通过不正确地转换来以不安全的方式使用，但这并不使它们成为被称为不安全类型的理由。.NET 委托也是强类型的，在我看来两者都是类型安全的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-20T00:38:08.310

> 那么，它的类型如何不安全？

```
void SortElements(void* MyArray,              // what type is pointed here?
                  unsigned int N,             // Are there really N elements?
                  size_t size,                // Is the size correct?
                  int(*cmp)(void*,void*));    // Is this the correct function? 
```

您提供的代码是类型不安全的，不是因为函数指针，而是因为在签名和函数指针的签名`void*`中都使用了。`SortElements`

这是不安全的原因是因为调用者有传递正确参数的全部责任，并且编译器不能确保指针`MyArray`指向一个连续的内存区域，该内存区域包含接口中提供的`iNumofElems`每个内存区域`size`。如果程序员犯了错误，编译器将无法提供帮助，如果维护者修改了存储在数组中的类型（大小更改）或元素数量，编译器将无法检测到并告诉您您需要将调用更新为`SortElements`. 最后，由于传递的函数指针也使用`void*`，所以比较苹果和梨的比较器的签名完全相同，如果传递了错误的函数指针，编译器将无法提供帮助。

```
struct Apple {
   int weight;
};
struct Pear {
   double weight;
};
int compare_pears( void * pear1, void * pear2 ) {
   return static_cast<Pear*>(pear1)->weight - static_cast<Pear*>(pear2)->weight;
}
int main() {
   Apple apples[10];
   SortElements( apples, 20, sizeof(Pear), compare_pears );
} 
```

虽然编译器能够验证函数指针的签名是否与函数所需的签名匹配，但函数指针本身是不安全的，并且允许您为基本上任何事情传递比较器。

将其与其他替代方案进行比较：

```
template <typename T, std::size_t N>
void SortElements( T (&array)[N], int (*cmp)( T const &, T const & ) ); 
```

在这里，编译器将从调用中推断元素的类型`T`和数组的大小。正如编译器所知，`N`不需要传递 的大小。`T`传递给这个版本的比较器函数`SortElements`是强类型的：它采用两个常量引用存储在数组中的元素的类型，并返回一个`int`. 如果我们在之前的程序中尝试过：

```
int compare_pears( Pear const & lhs, Pear const & rhs );
int compare_apples( Apple const & l, Apple const & r );
Apple array[10];
//SortElements( array, compare_pears );   // Error!!!!
SortElements( array, compare_apples );    // Good! 
```

你不能弄错数组的大小或元素的大小，如果有人改变了类型`Apple`，编译器会选择它，如果数组的大小改变了，编译器会选择它。您不能误认为传递给函数的比较器，因为编译器也会拾取它。现在程序是类型安全的，即使它使用函数指针（这可能会影响性能，因为它们禁止内联，这就是为什么`std::sort`通常比 快`qsort`）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-19T22:41:58.830

函数指针是类型安全的。然而，许多环境迫使程序员需要重铸它们。不正确的铸造可能会导致严重的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-19T22:40:33.867

函数指针实际上是经过类型检查的并且是类型安全的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T22:49:35.287

在 nesC（TinyOs 中使用的 C 方言）中强烈建议不要使用函数指针，因为它们会阻碍优化。在这里，静态代码分析（或者更确切地说是缺乏其适用性）是比类型安全更大的问题，但我不确定这些问题是否会被混淆。

另一个问题可能是使用函数指针作为事件处理程序。使用通用事件调度程序时，您可能希望从正确的类型中抽象出来，这意味着您可以考虑存储函数指针，`void*`以实现模块化。这将是函数指针的类型不安全使用而不是类型安全的动态绑定使用的一个突出示例。

# jquery - WymEditor 静态内容多次加载

> ID：10237849
> 
> 赞同：0
> 
> 时间：2012-04-19T22:37:08.543
> 
> 标签：jquery, django, static-content, wysiwym

我正在使用 django 表单，并在页面中加载所见即所得编辑器。问题是每个表单都有 4 个所见即所得编辑器的实例，而页面平均可以有 10-30 个这样的表单。

```
 {% for form in forms %}
            <ul data-role='listview' data-inset='true' class='find_details'
                id="find_details_{{ form.instance.id }}" style='display:none;' >
                {{ form.as_ul }}
            </ul>
        {% endfor %} 
```

我加载所见即所得的方式如下：对于所有类 wym 的输入，添加 wymeditor。

```
$('#page').live( 'pageinit', function(event) {
  $('.wym').each( function () { $(this).wymeditor(); });
}); 
```

这种方法会导致在同一页面上重新加载与所见即所得编辑器相关的所有静态内容 40-100 次，从而导致疯狂的加载时间。

什么可能是实现这一点的好方法，而无需多次加载 css、图像和 iframe？在文档加载后我绝对可以做同样的事情，但我主要是在寻找一个最佳实践解决方案，如果可能的话，将负载合并到一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T04:01:31.847

仅当用户单击 textarea 时，您才能按需初始化 WYM。所以未使用的文本区域不会减慢加载速度。

甚至可能隐藏该文本区域并显示具有实际渲染内容的 DIV 并捕获对它们的点击。看起来不错，一种所见即所得。

# android - 如何在 Android Web 浏览器和我的自定义应用程序之间进行通信

> ID：10237850
> 
> 赞同：1
> 
> 时间：2012-04-19T22:37:09.463
> 
> 标签：android

我想从 Web 浏览器启动我的自定义应用程序。我在这里找到了这个问题的答案：[在 Android 浏览器中创建一个链接来启动我的应用程序？](https://stackoverflow.com/questions/3469908/make-a-link-in-the-android-browser-start-up-my-app/3472228)

现在我想将一些数据从我的自定义应用程序返回到打开它的网页，然后将其发布到服务器。

任何想法如何做到这一点？

马特拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:43:44.787

这是不可能的，对不起。

欢迎您让您的自定义应用程序使用`ACTION_VIEW` `Intent`. 或者，您可以集成`WebView`到您的应用程序中并拥有更大的控制权。

# android - SetVisibility doesn't work?

> ID：10237851
> 
> 赞同：4
> 
> 时间：2012-04-19T22:37:21.860
> 
> 标签：android, layout, visibility

I'm new to developing with android. I have a grid contained in a `LinearLayout` and each item which makes up the grid is a button. I want this `LinearLayout` to be invisible when the user pushes any of these buttons.

This is my 'home' layout shell:

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android">
  <TextView/>
  <LinearLayout>   //<-- this is the layout I want to hide
     <TextView/>
     <GridView/>
  </LinearLayout>
</LinearLayout> 
```

And this is the onClick method which I've set up in MyArrayAdapter (used to inflate buttons)

```
@Override
public void onClick(View v) {
   View convertView = activity.getLayoutInflater().inflate(R.layout.layout_home, null);  
   LinearLayout ll_options = (LinearLayout) convertView.findViewById(R.id.ll_options);
   ll_options.setVisibility(View.INVISIBLE);
} 
```

I think it should work but when I test it, nothing happens.

I found a similar question but it doesn't solve my problem.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T22:44:34.103

你为什么在这里夸大布局？：

```
View convertView = activity.getLayoutInflater().inflate(R.layout.layout_home, null); 
```

做就是了：

```
View v = activity.findViewById(R.id.ll_options);
v.setVisibility(View.INVISIBLE); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T22:45:11.880

您创建一个不在可见视图层次结构中的新视图，直到将其添加到那里，然后将其隐藏。所以你隐藏了一些看不见的东西。

相反，请尝试：

```
@Override
public void onClick(View v) {
   findViewById(R.id.ll_options).setVisibility(View.INVISIBLE);
} 
```

IMO应该工作。它在您的活动的可见（全局）视图层次结构中搜索`ll_options`视图并将其隐藏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:42:19.113

**编辑：**

你的按钮在哪里？它在同一个布局文件中吗？您膨胀了一个**新布局**并在那里隐藏了 LinearLayout，但从未使用过这个新布局。确保您可以访问侦听器中的 contentView。

# xslt-2.0 - xslt transform that selects element based upon negative value in multiple descendants

> ID：10237853
> 
> 赞同：0
> 
> 时间：2012-04-19T22:37:46.443
> 
> 标签：xslt-2.0

I have the following basic xml which I to parse to give the NAME only if none of the DB values = DB1.

```
<rnas>
  <rna ID="1">
    <NAME>Segment 6</NAME>
    <XREF>
      <ID>AF389120</ID>
      <DB>DB1</DB>
    </XREF>
    <XREF>
      <ID>ABCDE</ID>
      <DB>DB2</DB>
    </XREF>
  </rna>
  <rna ID="10">
    <NAME>Segment 3</NAME>
    <XREF>
      <ID>12345</ID>
      <DB>DB2</DB>
    </XREF>
    <XREF>
      <ID>66789</ID>
      <DB>DB3</DB>
    </XREF>
  </rna>
</rnas> 
```

The expected output would be:

```
<rnas>
  <rna ID="10">
    <NAME>Segment 3</NAME>
  </rna>
<rnas> 
```

I am still a relative newbie and have tried a variety of approaches using XSLT 2.0 but so far have not been able to get anything to work properly. Any help would be much appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:07:50.287

这会做你想做的

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:output method="xml" indent="yes"/>

  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="rna[.//DB/text()='DB1']"/>
  <xsl:template match="XREF"/>

</xsl:stylesheet> 
```

这是一个身份转换以及两个空模板。第一个匹配任何`rna`包含 a`DB`和文本 value 的内容`DB1`，并禁止它。第二个匹配`XREF`您不想输出的所有元素。

# c++ - Asking for suggestion on a custom iterator my self-defined container in c++

> ID：10237858
> 
> 赞同：1
> 
> 时间：2012-04-19T22:38:22.980
> 
> 标签：c++, reference, iterator

I am using a std::map as data holder for my algorithm but for some reason, I need to control the access of map element in some way. We know that one can access the element of the map by calling operator[key] directly. However, if the key doesn't not exist and whenever you call operator[key] it will create that key with the value initialized as 'ZERO' automatically. But in my algorithm, I will control the access by limiting that one can only modify the element when the exist key and when the value is non-zero. For example, if the map has the following elements (3, 2), (1, 0), (4, 0), (2, 7), one can only modify (3,2) and (2,7). I know that I can add some code with map::find(key) or map::count(key) anywhere before I modify the element, but it is too many so I would like to write my own container as follows

```
class MyContainer;

template <typename T> class myiterator :public iterator<forward_iterator_tag, T>
{
  friend class MyContainer;
  private:
    T *pointer;
    myiterator(T *pointer):pointer(pointer) {}

  public:
    T& operator*() {return (*pointer);}

    const myiterator<T>& operator++()
    {
      pointer->current_iterator++;
  return *this;
    }

    bool operator!=(const myiterator<T>& other) const
    {
      return pointer->current_iterator != other.pointer->current_iterator;
    }

    bool isEnd(void) const
    {
      return pointer->current_iterator == pointer->end_iterator;
    }
  };

  class MyContainer
  {
    friend class myiterator<MyContainer>;
    public:
      typedef myiterator<MyContainer> iterator;

    private:
      map<int, int> data;
      map<int, int>::iterator current_iterator, end_iterator;

    public:
      MyContainer() {current_iterator = data.begin(); }

      void addDataPair(int key, int value) {data[key] = value;}

      int first() {return (*current_iterator).first;}
      int second() {return (*current_iterator).second;}

      // initialize the current_iterator to the begin of the data (map) and set the end iterator too
      iterator begin() 
      {
        current_iterator = data.begin();
        end_iterator = data.end();
        return myiterator<MyContainer>(this);
      }

      // return the container w/ current_iterator point to where the key is
      MyContainer &operator[](int key)
      {
        current_iterator = data.find(key);
        return (*this);
      }

      // only increase the value by one when the key does exist and with initial value non-zero
      void operator++(void)
      {
        if ( (current_iterator != data.end()) && 
           ((*current_iterator).second>0) ) 
        {
          ((*current_iterator).second)++;
        }
      }
   }; 
```

As you can see, instead of using map::iterator, I inherit one from std::iterator such that, the iterator refer to the MyContainer itself instead of the value type of the map. I can visit all element by

```
MyContainer h;

h.addDataPair(1, 3);
h.addDataPair(2, 4);
h.addDataPair(3, 0);
h.addDataPair(7, 9);
h.addDataPair(11, 2);

for (MyContainer::iterator it=h.begin(); !it.isEnd(); ++it)
{
  cout << (*it).first() << " " << (*it).second() << endl;
} 
```

With this idea, whenever the iterator was looped, it will return a referent the the container so I can add some code (like operator[], operator++) to control the behavior of updating the map element. For example, in this code,

```
void operator++(void) 
```

will ignore any operation on non-exist key or on the element with value initialized as zero. However, there are still some doubts in the code which I am looking for your suggestions

1) if you read the code carefully, you will see that I use current_iterator to store the current map::iterator and use end_iterator to store the end iterator for the map. Those iterators will be set when MyContainer.begin() was called. The reason I need end_iterator is that if instead I set the current_iterator as map.end() then, it will change the current_iterator during the loop. For example, the following code won't work

```
iterator begin() 
{
  current_iterator = data.begin();
  return myiterator<MyContainer>(this);
}

iterator end() 
{
  current_iterator = data.end();   // here we set current_iterator as data.end(), but this will change the current iterator of data too
  return myiterator<MyContainer>(this);
} 
```

so when you loop the container with the following code, it won't run correctly

```
for (MyContainer::iterator it=h.begin(); it!=h.end(); ++it)
{
  cout << (*it).first() << " " << (*it).second() << endl;
} 
```

that's why I write a isEnd() function in the iterator instead. But this doesn't look elegant, any better idea to get around this?

2) for the 'limited' ++ operation, if we modify the map element from the container as follows, it goes without any problem

```
// assuming the map initially contains (2, 4), (3, 0), (7, 9), (11, 2)

h[4]++; // modify the element with key==4, won't do anything, no such key
h[3]++; // modify the element with key==3, won't do anything, value=0
h[11]++; // modify the element with key==11, then we have (11, 3)
(*(h.begin()))++; // modify the first element, works, we have (2,5) 
```

But if you modify that while iterating all elements, the loop will never end, why's that

```
for (MyContainer::iterator it=h.begin(); !it.isEnd(); ++it)
{
  (*it)++;    // it works
  (*it)[3]++; // it will cause the loop run and never stop
  cout << (*it).first() << " " << (*it).second() << endl;
} 
```

Any idea?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T23:03:14.797

> 但是如果你在迭代所有元素时修改它，循环将永远不会结束，那是什么

然后不要，而是构建要删除的对象列表，然后在循环后将其删除。

# c++ - Pointer to overloaded method of template class

> ID：10237862
> 
> 赞同：1
> 
> 时间：2012-04-19T22:39:13.557
> 
> 标签：c++

I have template with overloaded method. I'm trying to create pointer to the overloaded method.

```
template<typename T>
class Future {
public:
    const T& get() const;
    bool get(T*, int timeoutMs) const;
};

...

const void*&(Future<void*>::*x)()const = &Future<void*>::get; 
```

Compilation fails with this error:

```
no matches converting function 'get' to type 'const void*& (class Future<void*>::*)()const'
candidates are: const T& Future<T>::get() const [with T = void*]
                bool Future<T>::get(T*, int) const [with T = void*] 
```

I have tried to typedef `Future<void*>` without any luck.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:43:55.367

如果 T 是 void* 则 const 应该在指针上而不是在指向的内存上：

```
void* const & (Future<void*>::*x)() const = &Future<void*>::get; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:46:01.653

模板本身没有指针。模板就是**模板**，它告诉 c++ 如何创建一个类。所以

```
template<class T>
class Container {
 public:
  T* element() { return element_; }
  void SetElement(Element *element) { element_ = element; }
  typedef void (*SetElementFunctionPointer)(Element *element);
 private:
  T *element_;
};

typedef Container<int> IntContainer; 
```

上面的代码向您展示了一个 Container 模板，以及如何`IntContainer`使用 Container 模板创建一个整数容器 ( )。在那里，我为 a 声明了一个 typedef `SetElementFunctionPointer`。

# playframework-1.x - Reference model in template beyond request / page scope, in Play! 1.2.4

> ID：10237864
> 
> 赞同：0
> 
> 时间：2012-04-19T22:39:53.630
> 
> 标签：playframework-1.x

I came across at [this thread](https://stackoverflow.com/questions/8316827/play-2-0-framework-external-model-in-template/8693533#8693533), does anybody know how to do this in Play! 1.2.4? Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-21T14:08:32.810

更好的是，创建一个扩展 Controller 的超级控制器。之后，让你所有的控制器扩展你的 SuperController。

```
class SuperController extends Controller {

    @Before
    public static function before() {
        // Set global variables using renderArgs
    }
}

class MyController extends SuperController {

     public function myMethod() {
         // Do whatever your method does.
     }
} 
```

查看文档：[http ://www.playframework.org/documentation/1.2.4/controllers#result](http://www.playframework.org/documentation/1.2.4/controllers#result)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-20T06:42:59.820

我认为，同样的效果不太可能。例如，您当然可以通过使用完全限定名 ( `models.YourModel`) 来访问枚举来引用模型包中的类。

您在控制器范围内添加的任何内容都将在`renderArgs`模板中可用，此外还有一些始终在使用的隐式对象（请参阅[Play 框架文档](http://www.playframework.org/documentation/1.2.4/templates#implicits)以获取完整列表）。例如，`play.Play`对象包含各种有用的东西。

使用`@Before`和`@With`注释，您可以设置多个其他控制器使用的控制器，以使对象“全局”可用 - 请参阅[拦截](http://www.playframework.org/documentation/1.2.4/controllers#interceptions)。

# jquery - Multiple instances of image rotate plugin, jQuery

> ID：10237865
> 
> 赞同：0
> 
> 时间：2012-04-19T22:40:03.477
> 
> 标签：jquery, jquery-animate, rotation

I would like to have multiple images rotate, or gyrate, or spin, whatever the term best describes the 2D image rotate, from the same document.

The jquery plugin that does this for one image is: [http://code.google.com/p/jqueryrotate/wiki/Examples](http://code.google.com/p/jqueryrotate/wiki/Examples)

Although the example page shows many instances of rotating images, these are loaded from iframes. Meaning, each rotating image is the portion of another document shown through iframe.

I am trying to rotate different images, at different speeds, and in different angles and it is not working.

For example, for two images I used code

```
var angle = 0;

    setInterval(function(){
      angle+=3;
     jQuery(".process-1").rotate(angle);
},50);
setInterval(function(){
      angle-=3;
     jQuery(".process-2").rotate(angle);
},30); 
```

Thank you

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:53:26.750

它似乎在多个图像上工作正常。你没有解释你想要什么，但这里是旋转三个图像的代码......

[http://jsfiddle.net/RwEme/603/](http://jsfiddle.net/RwEme/603/)

```
var rotation = function (){
   $("#image, #image2, #image3").rotate({
      angle:0, 
      animateTo:360, 
      callback: rotation,
      easing: function (x,t,b,c,d){        // t: current time, b: begInnIng value, c: change In value, d: duration
          return c*(t/d)+b;
      }
   });
}
rotation(); 
```

HTML：

```
<img src="https://www.google.com/images/srpr/logo3w.png" id="image"/>
<img src="https://www.google.com/images/srpr/logo3w.png" id="image2"/>
<img src="https://www.google.com/images/srpr/logo3w.png" id="image3"/>​ 
```

* * *

**编辑：**

这是另一个基于对 OP 的编辑的工作演示。

[http://jsfiddle.net/RwEme/604/](http://jsfiddle.net/RwEme/604/)

它不起作用，因为您试图将相同的变量 ( `angle`) 用于两个不同的事物。

```
var angle = 0,
    angle2 = 0;

setInterval(function() {
      angle += 3;
     $("#image").rotate(angle);
},80);
setInterval(function() {
      angle2 -= 3;
     $("#image2").rotate(angle2);
},20);​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:52:09.143

他们确实使用旋转动画。您必须确保将每个旋转包装在不同的函数中，以便`angle`变量的范围仅限于该函数。否则，两个动画共享相同的变量，这将不起作用。这是其中两个的工作jsfiddle：

[http://jsfiddle.net/YKj5D/215/](http://jsfiddle.net/YKj5D/215/)

我使用此代码启动动画

```
(function() {
  var angle = 0;
  setInterval(function(){
      angle+=3;
     $("#image3").rotate(angle);
  },50);
}​)();

(function() {
  var angle = 0;
  setInterval(function(){
      angle+=10;
     $("#image4").rotate(angle);
  },50);
})();
​
​ 
```

# input - 期望重定向标准输入

> ID：10237872
> 
> 赞同：2
> 
> 时间：2012-04-19T22:41:13.467
> 
> 标签：input, ssh, pipe, expect

我正在远程服务器上运行脚本，例如使用以下命令：

```
ssh root@host 'bash -s' < script.sh 
```

现在我正在尝试使用 expect 来处理密码提示。这是脚本：

```
#!/usr/bin/expect
set cmd [lindex $argv 0]

spawn -noecho ssh root@host $cmd

expect {
  "password:" {
     send "password\r"
   }
} 
```

如果我运行脚本，它没有输出：

```
./ssh.exp 'bash -s' < script.sh 
```

我知道这不是在没有密码的情况下使用 ssh 的方法，但这不是这里的问题。

* * *

**更新**我用一个简单的脚本尝试了格伦杰克曼的想法，但它不起作用。这是我正在使用的脚本：

```
#!/usr/bin/expect
spawn ssh xxx@xxx

expect "*?assword:*"
send "pwd\r"

send "echo hello world" 
```

这是我得到的输出：

```
[xxx@xxx bin]$ expect -d my.exp
expect version 5.43.0
argv[0] = expect  argv[1] = -d  argv[2] = my.exp
set argc 0
set argv0 "my.exp"
set argv ""
executing commands from command file my.exp
spawn ssh xxx@xxx
parent: waiting for sync byte
parent: telling child to go ahead
parent: now unsynchronized from child
spawn: returns {7599}

expect: does "" (spawn_id exp6) match glob pattern "*?assword:*"? no
xxx@xxx's password:
expect: does "xxx@xxx's password: " (spawn_id exp6) match glob pattern "*?assword:*"? yes
expect: set expect_out(0,string) "xxx@xxx's password: "
expect: set expect_out(spawn_id) "exp6"
expect: set expect_out(buffer) "xxx@xxx's password: "
send: sending "pwd" to { exp6 }
send: sending "echo hello world" to { exp6 }
write() failed to write anything - will sleep(1) and retry... 
```

* * *

**更新**我设法让它运行我的脚本。这是有效的结果：

```
#!/usr/bin/expect

set user [lindex $argv 0]
set host [lindex $argv 1]
set pwd  [lindex $argv 2]

spawn ssh $user@$host bash -s

expect {
  "?asswor?: " {
    send "$pwd\n"
  }
}

while {[gets stdin line] != -1} {
    send "$line\n"
}
send \004

expect {
  "END_TOKEN_OF_SCRIPT" {
    exit 0
  }
  default {
    exit 1
  }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-20T00:51:21.563

您需要将您在标准输入上读取的脚本发送到远程主机：

```
while {[gets stdin line] != -1} {
    send "$line\r"
}

# then you may have to send ctrl-D to signal end of stdin
send \004 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T19:23:31.987

使用 expect_user，如手册页所示：

以下脚本读取密码，然后每小时运行一个程序，每次运行时都要求输入密码。该脚本提供密码，因此您只需键入一次。（请参阅演示如何关闭密码回显的 stty 命令。）

```
send_user "password?\ "
expect_user -re "(.*)\n"
for {} 1 {} {
    if {[fork]!=0} {sleep 3600;continue}
    disconnect
    spawn priv_prog
    expect Password:
    send "$expect_out(1,string)\r"
    . . .
    exit
} 
```

这是我目前拥有的，但仍在改进：

```
#!/usr/local/bin/expect

# For debugging make the following to be line 1:
#!/usr/local/bin/expect -D 1

set timeout 20

send_user "Username?\ "
expect_user -re "(.*)\n"
set user $expect_out(1,string)

send_user "password?\ "
stty -echo
expect_user -re "(.*)\n"
stty echo
set password $expect_out(1,string)

spawn su

expect {

    "Password"  {send "$password\r"}

    "#"         {interact + return}

} 
```

# maps - How to change fusion table maps markers' size?

> ID：10237874
> 
> 赞同：1
> 
> 时间：2012-04-19T22:41:40.823
> 
> 标签：maps, google-fusion-tables

I have a table with a location column and "count" column (with values from 1 to 100). I'd like to map the records with markers that change in size, i.e. the bigger the count value is, the bigger the marker is.

Is that possible in Google Fusion? How would you suggest to do that?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T17:13:12.433

目前只有 2 种尺寸的图标可用：*small*和*large*，我用一个[小例子向您展示如何将它们](http://jsfiddle.net/odi86/7xhYG/)与[FusionTablesLayer](https://developers.google.com/maps/documentation/javascript/layers#FusionTables)一起使用，FusionTablesLayer是 Google Maps 的一个特殊层，可用于查询您的 Google Fusion Tables。

FusionTablesLayer 允许您将样式应用于数据（标记、线条或多边形），归结为：

```
layer = new google.maps.FusionTablesLayer({
    query: {
        select: 'Location',
        from: '3609183'
    },
    styles: [
       { where: "Number > 1000",
         markerOptions: {
            iconName: 'large_green'
         }
       },
       { where: "Number <= 1000",
         markerOptions: {
            iconName: 'large_red'
         }
       },
       { where: "Number <= 100",
         markerOptions: {
            iconName: 'small_purple'
         }
       }
]}); 
```

如果两种尺寸还不够，那么也许您可以使用不同的颜色/图标（有一个[支持图标的列表](https://www.google.com/fusiontables/DataSource?docid=1BDnT5U1Spyaes0Nj3DXciJKa_tuu7CzNRXWdVA)）。否则，您必须检索数据并使用不同大小的图像[创建自定义标记。](https://developers.google.com/fusiontables/docs/samples/custom_markers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T15:48:23.593

Javram 指出了一种方法，但可用标记图标列表在 Fusion Tables 中受到限制，并且 AFAIK 无法改变图标大小。另一种方法可能是使用 Fusion Tables 提供的 JSONP 支持来检索您的数据并创建您自己的制造商。这篇[博客文章](http://www.reddmetrics.com/2011/08/10/fusion-tables-javascript-query-maps.html)解释了如何做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-20T14:42:39.470

答案就在这里， [http://support.google.com/fusiontables/bin/answer.py](http://support.google.com/fusiontables/bin/answer.py?hl=en&answer=185991) ?hl=en&answer=185991 基本上，您需要在表格中添加一列，即您想要的标记类型的名称用于该位置。

# powershell - 访问具有无效变量名的管道变量属性

> ID：10237875
> 
> 赞同：1
> 
> 时间：2012-04-19T22:41:45.550
> 
> 标签：powershell, scripting, pipeline

我正在编写一个 powershell 高级函数，它将从管道中获取输入。更具体地说，我将从 import-csv 导入。问题是我正在使用的 csv 文件的列标题使用对 ps 无效的语法。这是我的代码的样子

```
function my-function{
    [CmdletBinding()]
    params
    (
        [Parameter(Mandatory=$false,ValueFromPipeline=$true,          
                    ValueFromPipelineByPropertyName=$true)]
        [string]$Id = $_.ID,

        [(Parameter(Mandatory=$false,ValueFromPipeline=$true,
                      ValueFromPipelineByPropertyName=$true)]
        [string]$IdRaw =  $_."ID(RAW)",
    )

    BEGIN{
         #Sets up a db connection
    }
    PROCESS{
         #Builds an insert query with csv members
    }
    END{
         #closes db connection
    }
}

ID,ID(RAW),Date Time,Date Time(RAW),Type,Type(RAW)
29874,29874,4/18/2012 23:58,41018.20753, Servername, ServernameRaw 
```

当我使用 csv 输入执行此操作时，$Id 的值变为 2905，而 $IdRaw 变量采用整个 $_ 哈希表的字符串表示形式。只是为了详细说明任何具有有效名称 {URL, ID, Status} 的参数都可以。任何包含空格或 (RAW) 的都会收到整个 $_ 变量。

-帕特里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T01:42:43.177

```
#Edit to include updated code
$x=import-csv c:\temp\testinput.csv

function my-function{
 [CmdletBinding()]
    param
    (
        [Parameter(Mandatory=$false,ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)][string]$Id,
        [Parameter(Mandatory=$false,ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true)]
        [alias("ID(RAW)")][string]$IdRaw 
    )

    begin{
         #Sets up a db connection
         Write-Debug "Starting"
    }
    process {
         #Builds an insert query with csv members
         write-debug "IDRaw=$IDRaw"
    }
    end {
         #closes db connection
                 Write-Debug "Ending"

    }
}

$x | my-function 
```

示例文件内容

ID,ID(RAW),日期时间,日期时间(RAW),类型,类型(RAW) 29874,29877,4/18/2012 23:58,41018.20753, Servername1, ServernameRaw1 29875,29878,4/19/2012 23 :58,41018.20753, Servername2, ServernameRaw2 29876,29879,4/20/2012 23:58,41018.20753, Servername3, ServernameRaw3

# clojure - loop-recur 怎么可能抛出 StackOverflowError？

> ID：10237880
> 
> 赞同：4
> 
> 时间：2012-04-19T22:42:06.377
> 
> 标签：clojure, tail-recursion

我一直在尝试实现chainl1的尾递归版本，但即使使用循环递归，它也会抛出StackOverflowError。这怎么可能，我能做些什么来改变它？

```
(defn atest [state]
  (when-not (and (= "" state) (not (= (first state) \a))) 
      (list (first state) (. state (substring 1)))))
(defn op [state]
  (when-not (and (= "" state) (not (= (first state) \a)))
    (list #(list :| %1 %2) (. state (substring 1)))))
(defn chainl1-helper [x p op]
  (fn [state]
    (loop [x x
           state state]
      (if-let [xs (op state)]
        (when-let [xs2 (p (second xs))]
          (recur ((first xs) x (first xs2)) (second xs2)))
        (list x state)))))

(defn chainl1 [p op]
  (fn [state]
    (when-let [[v s] (p state)]
      ((chainl1-helper v p op) s))))
(def test-parse (chainl1 atest op))
(defn stress-test [n] (test-parse (apply str (take n (interleave (repeat "a") (repeat "+"))))))
(stress-test 99999) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T22:54:01.207

它打印最终结果会破坏堆栈，因此它是 REPL 而不是您的代码。

将最后一行替换为

```
(count (stress-test 99999)) 
```

它完成了

堆栈跟踪有这种模式重复多次：

```
 13:    core_print.clj:58 clojure.core/print-sequential
 14:    core_print.clj:140 clojure.core/fn
 15:      MultiFn.java:167 clojure.lang.MultiFn.invoke 
```

编辑：LDomagala 指出*打印级别*是针对此类崩溃的安全措施

```
user>  (set! *print-level* 20)
20
user> (stress-test 9999)
((:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f (:f # \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) \a) "")
user> 
```

# django - django tsstypie。order_by 查询集

> ID：10237882
> 
> 赞同：2
> 
> 时间：2012-04-19T22:42:11.220
> 
> 标签：django, api, sorting, sql-order-by, tastypie

这是我的models.py

```
class Picture(models.Model):
    image = models.ImageField(upload_to='uploads/')
    caption = models.CharField(max_length=140, null=True, blank=True)
    uploaded = models.DateField()
    comments = models.ManyToManyField(Comment, null=True, blank=True) 
```

还有我的tastepie的API资源，api.py：

```
class PictureResource(ModelResource):

    class Meta:
        queryset = Picture.objects.all.order_by('-uploaded')
        resource_name = "photo"
        authorization = Authorization()
        API_LIMIT_PER_PAGE = 24 
```

如您所见，我希望我的 API 页面按上传的最新图像排序。

我的错误代码是：

> 函数对象没有属性“order_by”

通常我不知道该怎么办...

（顺便问一下，`API_LIMIT_PER_PAGE = 24`这是在正确的地方吗？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T22:51:07.173

将您更改`queryset`为：

```
class PictureResource(ModelResource):

    class Meta:
        queryset = Picture.objects.all().order_by('-uploaded')
        resource_name = "photo"
        authorization = Authorization()
        API_LIMIT_PER_PAGE = 24 
```

`all`它本身只是一种方法，但如果你像使用它一样使用它，`all()`它会返回一个 QuerySet。`order_by`是一个 QuerySet 方法。

```
>> type(Picture.objects.all)
<type 'instancemethod'>

>> type(Picture.objects.all())
<class 'django.db.models.query.QuerySet'> 
```

# sql - 使用增量值更新 Oracle 中的分组记录

> ID：10237884
> 
> 赞同：1
> 
> 时间：2012-04-19T22:42:13.570
> 
> 标签：sql, oracle, sql-update

所以进退两难，我有一个名为 T_GROUP 的 Oracle 表。表中的记录具有唯一的 ID (ID)，它们是 Study 的一部分，由 STUDY_ID 标识，因此多个组可以在同一个 Study 中。

```
CREATE TABLE T_GROUP
(
    "ID" NUMBER(10,0),
    "GROUP_NAME" VARCHAR2(255 CHAR),
    "STUDY_ID" NUMBER(10,0)
) 
```

现有表有数百条记录，我现在添加一个名为 GROUP_INDEX 的新列：

```
ALTER TABLE T_GROUP ADD (
 GROUP_INDEX NUMBER(10,0) DEFAULT(0)
); 
```

添加列后，我需要运行一个脚本来更新 GROUP_INDEX 字段：它应该从 1 开始，并为**study**中的每个组递增 1 ，从最低 ID 开始。

所以现在我有如下数据：

```
ID  GROUP_NAME      STUDY_ID    GROUP_INDEX
-------------------------------------------
1   Group 1         3           0
2   Group 2         3           0
3   My Group        5           0
4   Big Group       5           0
5   Group X         5           0
6   Group Z         6           0
7   Best Group      6           0 
```

更新后的 group_index 字段应如下所示：

```
ID  GROUP_NAME      STUDY_ID    GROUP_INDEX
-------------------------------------------
1   Group 1         3           1
2   Group 2         3           2
3   My Group        5           1
4   Big Group       5           2
5   Group X         5           3
6   Group Z         6           1
7   Best Group      6           2 
```

更新将通过批处理文件从 sqlplus 运行。我玩过 group by 和 sub 查询，但运气不佳，而且从未使用过 sqlplus，我不确定是否可以使用变量、游标等。非常感谢所有提示！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T23:08:32.533

您应该能够为此使用分析`row_number`功能

```
UPDATE t_group t1
   SET group_index = (SELECT rnk
                        FROM (SELECT id,
                                     row_number() over (partition by study_id
                                                            order by id) rnk
                                FROM t_group) t2
                       WHERE t2.id = t1.id) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-20T17:04:52.213

这是使用 MERGE 语句的版本。可能比子选择更快（但不必如此）。

```
merge into t_group
using 
( 
   select id, 
          row_number() over (partition by study_id order by id) rnk
   from t_group
) t on t.id = t_group.id 
when matched then update 
   set group_index = t.rnk; 
```

这假设 id 是主键（或至少是唯一的）

我现在无法对其进行测试，因此其中可能存在一些语法错误。

# c# - 反序列化 .NET 中已更改的类的策略

> ID：10237887
> 
> 赞同：6
> 
> 时间：2012-04-19T22:42:23.957
> 
> 标签：c#, .net, serialization

我有这门课

```
[Serializable]
public class myClass() : ISerializable
{
    public int a;
    public int b;
    public int c;

    public void GetObjectData(SerializationInfo info, 
                              StreamingContext context)
        {
        // Some code
        }

    public myClass(SerializationInfo info, 
                   StreamingContext context)
        {
        // Some code
        }
} 
```

我的数据库中有数百个这样的对象。我现在准备发布我的应用程序的新版本，该类已演变为

```
[Serializable]
public class myClass() : ISerializable
{
    public int a;
    public string b;
    public int c;
    public bool d;

    public void GetObjectData(SerializationInfo info, 
                              StreamingContext context)
        {
        // Some code
        }

    public myClass(SerializationInfo info, 
                   StreamingContext context)
        {
        // Some code
        }
} 
```

如何使用第二个版本的反序列化构造函数反序列化基于第一个版本序列化的对象。

是否还有未来版本校对我的第二个版本的策略？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T23:00:28.310

如果您没有准备，您可能需要求助于 hack：当您的`public myClass`反序列化构造函数获取 的值时`bool d`，将代码包含在`try`/中，并在捕获异常时`catch`设置为其默认值。`d`

将来，添加一个`int`值`"__ver"`（或任何其他不与您传递给的参数冲突的名称`info.AddValue`），并将其设置为您在类中维护的常量，以指示序列化中的兼容和不兼容更改：

```
public class myClass : ISerializable {
    private const int __ver = 4;
    public int a;
    public string b;
    public int c;
    public bool d;

    public void GetObjectData(SerializationInfo info, 
                          StreamingContext context) {
        info.AddValue("__ver", ver);
        info.AddValue("a", a);
        // and so on
    }

    public myClass(SerializationInfo info, 
               StreamingContext context) {
        switch(info.GetInt32("__ver")) {
            case 3: 
                // Deserialize prior version
            break;
            case 4: 
                // Deserialize current version
            break;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T23:23:59.527

可序列化的类非常适合通过相同版本的软件传递它们，但是当使用它进行持久性时，您很快就会遇到这个问题。如果您要将对象存储为[BLOB](http://en.wikipedia.org/wiki/Binary_large_object)，则可以使用[protobuf-net 之](http://code.google.com/p/protobuf-net/ "protobuf-net")类的东西，它通过允许可选字段来允许序列化版本控制。

鉴于您当前的困境，您可以做的就是立即尝试使用新字段，如果它们不存在则默认它们：

```
protected myClass(SerializationInfo info, StreamingContext context)
{
    c = info.GetInt32("Value_C"); 
    try
    {
        b = info.GetBoolean("Value_B");
    }
    catch (SerializationException)
    {
        b = true;
    }
} 
```

# asp.net - 正则表达式：拆分 X 长度的单词

> ID：10237889
> 
> 赞同：0
> 
> 时间：2012-04-19T22:42:35.020
> 
> 标签：asp.net, regex, vb.net

我是常规表达式的新手。我有一个巨大的文本。在应用程序中，我需要 4 个字符的单词并删除其余单词。文本是西班牙语。到目前为止，我可以选择 4 个字符长度的单词，但我仍然需要删除其余的。

这是我的正则表达式

```
\s(\w{3,3}[a-zA-ZáéíóúäëïöüñÑ])\s 
```

我怎样才能在asp.net vb中获得所有带有4个字母的单词？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:58:34.570

`/(?:\A|(?<=\P{L}))(\p{L}{4})(?:(?=\P{L})|\z)/g`

**解释：**

开关`/g`用于重复搜索

`\A`是字符串的开头（不是行首）

`\p{L}`*匹配类别字母*中的单个代码点

 *`\P{L}`匹配不在类别*字母中的单个代码点*

`{n}`指定特定的重复次数 [ *n*是数字]

`\z`是字符串的结尾（不是行尾）

`|`是逻辑*或*运算符

`(?<=)`向后看

`(?=)`是超前的

`(?:)`是非反向引用分组

`()`是反向引用分组

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T23:28:13.580

在另一个答案中使用上面提供的字符类（不幸的是，\w 不匹配西班牙语单词字符）。

您可以将其用于匹配（它匹配反向，基本上匹配所有*不是*4 个字符的单词，因此您可以用“”替换，只留下 4 个字符的单词）：

```
/(^|(?<=(?<=\W)[a-zA-ZáéíóúäëïöüñÑ]{4,4}(?=\W)))(.*?)((?=(?<=\W)[a-zA-ZáéíóúäëïöüñÑ]{4,4}(?=\W))|$)/gis 
```

VB中的近似代码（未测试）：

```
 Dim input As String = "This is your text"
  Dim pattern As String = "/(^|(?<=(?<=\W)[a-zA-ZáéíóúäëïöüñÑ]{4,4}(?=\W)))(.*?)((?=(?<=\W)[a-zA-ZáéíóúäëïöüñÑ]{4,4}(?=\W))|$)/gis"
  Dim replacement As String = " "
  Dim rgx As New Regex(pattern)
  Dim result As String = rgx.Replace(input, replacement)

  Console.WriteLine("Original String: {0}", input)
  Console.WriteLine("Replacement String: {0}", result) 
```

您可以在此处查看正则表达式的运行结果：

[http://regexr.com?30n29](http://regexr.com?30n29)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-04-19T22:46:02.803

```
\[^a-zA-ZáéíóúäëïöüñÑ][a-zA-ZáéíóúäëïöüñÑ]{4}[^a-zA-ZáéíóúäëïöüñÑ]\g 
```

已翻译：一个非字母，后接 4 个字母，后接一个非字母。指示的“g”将在全球范围内匹配......不止一次。

查看此链接以了解有关循环匹配比赛的更多信息：http: [//osherove.com/blog/2003/5/12/practical-parsing-using-groups-in-regular-expressions.html](http://osherove.com/blog/2003/5/12/practical-parsing-using-groups-in-regular-expressions.html)*

# iphone - BackButtonItem 的问题

> ID：10237892
> 
> 赞同：0
> 
> 时间：2012-04-19T22:42:55.057
> 
> 标签：iphone, objective-c, background-image, navigationcontroller

好吧，我有一个不同颜色的 NavigationController，我希望后退按钮也有一个背景图像、一个突出显示的背景图像和一个自定义文本颜色。我怎样才能做到这一点？我已经尝试了很多东西，但我无法更改这个后退按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:52:42.163

我想你必须创建自己的自定义按钮。

*   创建一个适合您要求的自定义 UIBarButtonItem。
*   将此自定义 UIBarButtonItem 分配给 NavigationItem 的 leftBarButtonItem。

您只能指向 leftBarButtonItem，因为 backBarButtonItem 是只读的。

```
self.navigationItem.leftBarButtonItem = aCustomBarButtonItem;
self.navigationItem.hidesBackButton = YES; 
```

希望这可以帮助...

**编辑**

可以提供帮助的代码：

```
UIButton *aCustomButton = [UIButton buttonWithType:UIButtonTypeCustom];
[aCustomButton setBackgroundImage:[UIImage imageNamed:@"back1.png"] forState:UIControlStateNormal];
[aCustomButton setBackgroundImage:[UIImage imageNamed:@"back2.png"] forState:UIControlStateHighlighted];
[aCustomButton addTarget:self action:@selector(onClickOfBack) forControlEvents:UIControlEventTouchUpInside];
[aCustomButton setFrame:CGRectMake(0, 0, 50, 40)];

UIBarButtonItem *aCustomBarButton = [[UIBarButtonItem alloc] initWithCustomView:aCustomButton];
self.navigationItem.leftBarButtonItem = aCustomBarButton;
[aCustomBarButton release]; 
```

# jquery - jquery find在div中选择选定的选项

> ID：10237897
> 
> 赞同：3
> 
> 时间：2012-04-19T22:43:24.113
> 
> 标签：jquery, jquery-selectors

试图弄清楚如何在没有 id 或 class 用作选择器但包含在特定 div 中的情况下获取 selects selected 选项（页面上有多个选择，我只想要这个）。

不确定我是否应该对 find、parent、sibling、other 做一些事情……我正在使用的示例。

```
<div id="mydiv">

<select name="myselect">
<option selected="selected" value="1">Hi</option>
</select>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:45:32.150

您可以使用该`>`符号来选择直接子代。`:selected`返回选定的选项。

```
jQuery('#mydiv > select[name=myselect] > option:selected') 
```

如果您想要所有选定的选项，请使用：

```
jQuery('option:selected') 
```

要获取`select`这些选定选项的元素：

```
jQuery('option:selected').parent(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T22:45:43.887

您可以按名称选择：

```
var val = $('select[name="myselect"]').val(); 
```

以下是使用 jQuery 进行选择的方法列表（它非常长）：[http ://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

因为它是一个子元素，你也可以这样做：

```
var val = $('#mydiv').children('select[name="myselect"]').val(); 
```

这从具有 ID 的 DIV 开始，然后获取该元素的子元素，这些子元素是`name`属性设置为的选择元素`myselect`。

如果您的`select`元素不是直接后代，那么您可以`.find()`改用：

```
var val = $('#mydiv').find('select[name="myselect"]').val() 
```

给你的文档：

*   `.children()`：[http ://api.jquery.com/children](http://api.jquery.com/children)
*   `.find()`：[http ://api.jquery.com/find](http://api.jquery.com/find)
*   `.val()`：[http ://api.jquery.com/val](http://api.jquery.com/val)

请注意，调用`.val()`元素`select`将返回`value`selected 的`option`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:45:54.007

您可以按名称选择它：

```
var sel = $('select[name=myselect]'); 
```

干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T22:49:27.767

尝试做`$('div#mydiv > select > option[selected="selected"]')`

# oracle - 带聚合的 null 计数

> ID：10237899
> 
> 赞同：0
> 
> 时间：2012-04-19T22:43:30.120
> 
> 标签：oracle

在 Oracle 中，我有一个查询表并将 2 个字段写入变量的存储过程。问题是当没有返回任何东西时，Oracle 会抛出一个错误。这是我的代码

```
 SELECT COUNT (empno),Name
    INTO empcount,empname
    FROM lv_request_header
   WHERE empno = emp 
     AND request_id = rqid
   GROUP BY empname 
```

使用带有计数的 NVL 仍然会引发错误

第 1 行出现错误：ORA-20000：未找到 lv_request_header ORA-06512：第 13 行

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:00:39.743

您发布的错误表明问题在于该表`lv_request_header`不存在或该过程的所有者无权访问它。如果过程所有者以外的用户拥有此表，您可能需要使用模式名称限定表名或创建对象的同义词。

通常，如果您要处理`SELECT ... INTO`返回 0 行的语句，则需要指定在这种情况下您希望两个局部变量具有什么值。如果你想`empcount`成为 0 并`empname`成为 NULL，你可以做这样的事情

```
BEGIN
  SELECT COUNT (empno),Name
    INTO empcount,empname
    FROM lv_request_header
   WHERE empno = emp 
     AND request_id = rqid
   GROUP BY empname
EXCEPTION
  WHEN no_data_found
  THEN
    empcount := 0;
    empname  := NULL;
END; 
```

# android - 膨胀视图时出现 ClassNotFoundException android.view.scrollview

> ID：10237900
> 
> 赞同：0
> 
> 时间：2012-04-19T22:43:33.943
> 
> 标签：android, xml, listview, popup, scrollview

我正在尝试对包含滚动视图的视图进行充气，并且在以下行中对视图进行充气时得到 ClassNotFoundException android.view.scrollview：

查看布局 = inflater.inflate(R.layout.news_article, null, true);

我自己找不到任何问题，谷歌搜索这个问题对我没有帮助（不幸的是）。

另一方面，这实际上也是我不知道该怎么做的解决方法。

情况：我有一个带有 3 个选项卡的选项卡布局。在每个选项卡中，我都有一个包含新闻项目的列表视图。当我点击新闻项目时，我希望 listview 布局与我现在用于弹出窗口的 xml 布局进行切换（这有点作弊，但我不知道如何正确地做到这一点）。因此，如果有人有办法做到这一点而不是使用弹出窗口，那对我来说将是最好的答案。

**我膨胀布局的方法：**

```
@Override
public void onClick(View v) 
{
   //setContentView(R.layout.news_article);
   final PopupWindow popUp;
   LayoutInflater inflater = (LayoutInflater)NewsActivity.this.getSystemService(Context.LAYOUT_INFLATER_SERVICE); 
   View layout = inflater.inflate(R.layout.news_article, null, false);
   Display display  =GetWindowManager().getDefaultDisplay();
   int popUpWidth = display.getWidth();
   int popUpHeight = display.getHeight();

   popUp = new PopupWindow(layout,  popUpWidth, popUpHeight, true); 
   popUp.setOutsideTouchable(true);                     

   popUp.setTouchInterceptor(new OnTouchListener()
   {
      @Override
      public boolean onTouch(View v, MotionEvent event) 
      {
        System.out.println("Touch Intercepted");
        if(event.getAction() == MotionEvent.ACTION_OUTSIDE)
        { 
             popUp.dismiss();
        }
            return false;
      }
   });

   popUp.showAtLocation(getListView(), Gravity.TOP, 0, 75);
} 
```

**布局的 XML 代码：**

```
<?xml version="1.0" encoding="utf-8"?>
<Scrollview
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/news_article_scroll"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <RelativeLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ffffffff">

    <ImageView
        android:id="@+id/news_article_icon"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_alignParentLeft="true"
        android:src = "@drawable/ic_launcher"/>

    <TextView
        android:id="@+id/news_article_header"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="20dp"
        android:textColor="#000000"
        android:layout_toRightOf="@+id/news_article_icon"
        android:layout_marginTop="10dp"
        android:text="Header" />

    <TextView
        android:id="@+id/news_article_text"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/news_article_icon"
        android:layout_marginTop="10dp"
        android:textColor="#000000"
        android:text="Text" />

</RelativeLayout>
</Scrollview> 
```

****** *** *******编辑****** ** *** ****** 好的，弹出窗口现在显示，但我没有收到任何事件**

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T22:53:03.643

我在我的代码中尝试了它，当我在 xml 文件中将 Scrollview 更改为 ScrollView 时它可以工作：

```
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical" 
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

</ScrollView> 
```

如果您使用小“v”编写 xml，则该 xml 是正确的，但充气机无法识别它并且需要大写“V”。

当您在它周围放置一个 try catch 块并检查异常时，您可以很容易地看到这一点，因为它在那里说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:49:46.177

当你膨胀你的布局时，你没有设置 parentView，但你设置了标志`true`

```
View layout = inflater.inflate(R.layout.news_article, null, true); 
```

将标志设置为 false 并将视图添加到您需要的位置。

```
View layout = inflater.inflate(R.layout.news_article, null, false); 
myParentViewGroup.add(layout); 
```**

# python - Python：双括号有什么作用？

> ID：10237902
> 
> 赞同：6
> 
> 时间：2012-04-19T22:43:45.553
> 
> 标签：python, syntax, parentheses

谁能告诉我为什么括号在这里加倍？

```
self.__items.append((module, item)) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-19T22:45:00.353

内括号创建一个[元组](http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences)。

```
>>> type(('a', 'b'))
<type 'tuple'> 
```

从技术上讲，可以在没有括号的情况下创建元组：

```
>>> 'a', 'b'
('a', 'b') 
```

但有时他们需要括号：

```
>>> 'a', 'b' + 'c', 'd'
('a', 'bc', 'd')
>>> ('a', 'b') + ('c', 'd')
('a', 'b', 'c', 'd') 
```

在您的情况下，它们需要括号来区分元组和函数的逗号分隔参数。例如：

```
>>> def takes_one_arg(x):
...     return x
... 
>>> takes_one_arg('a', 'b')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: takes_one_arg() takes exactly 1 argument (2 given)
>>> takes_one_arg(('a', 'b'))
('a', 'b') 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-19T22:45:29.590

它将元组`(module, item)`作为单个参数传递给函数。`module`如果没有额外的括号，它将`item`作为单独的参数传递。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T22:46:29.313

这和说的完全一样：

```
parameter = (module, item)
self.__items.append(parameter) 
```

即内部括号首先创建一个元组，然后将元组用作`append()`.

# java - 如何以编程方式从源代码创建可运行的 jar 文件？

> ID：10237903
> 
> 赞同：8
> 
> 时间：2012-04-19T22:43:52.680
> 
> 标签：java, jar, compilation, .class-file

我需要`.jar`从字符串以编程方式创建可运行文件。我的决定是`.class`从字符串创建一个文件并将其添加到`.jar`使用 JarOutputStream。

1.  我必须使用什么 API 来创建`.class`文件？
2.  是否有任何其他解决方案可以`.jar`从源代码创建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T00:52:00.267

为此，您可以使用[Java Compiler API](http://docs.oracle.com/javase/6/docs/api/javax/tools/JavaCompiler.html)。

有[这个优秀的教程](http://www.javabeat.net/2007/04/the-java-6-0-compiler-api/)可以引导你完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T00:57:31.090

要编译代码，您需要一个编译器。您可以使用~~太阳~~Oracle 编译器或 Eclipse 编译器。调用编译器 API（两者都有记录的 API）将在临时位置生成一个 .class 文件。然后你可以做一个罐子。

例如，从[Maven 编译器插件](http://svn.apache.org/viewvc/maven/plugins/tags/maven-compiler-plugin-2.5.1)开始，这是一个使用编译器 API 的 Java 模块。您必须找到进入 Plexus 编译器模块的方法。

# android - TextView 未移除 ChangeWatchers 导致内存泄漏

> ID：10237908
> 
> 赞同：5
> 
> 时间：2012-04-19T22:44:22.163
> 
> 标签：android

我们有活动和片段泄漏，并将原因追溯到 TextViews 上似乎未删除的 ChangeWatchers。

场景：活动 A 启动活动 B。B 在其布局中有一个 textPassword EditText 字段。活动 B 结束。

HPROF 转储显示仍然存在 Activity B 的一个实例。它的 gcroot 路径如下：

```
test.maa.LoginActivity
'- mContext android.widget.EditText 
   '- this$0 android.widget.TextView$ChangeWatcher 
      '- [1] java.lang.Object[13] 
         '- mSpans android.text.SpannableStringBuilder 
            '- mSource android.text.method.PasswordTransformationMethod$PasswordCharSequence 
               '- mText android.text.MeasuredText 
                  '- mMeasured android.text.StaticLayout 
                     '- sStaticLayout class android.text.DynamicLayout 
```

如果您将 Linkify.addLinks 链接到 TextView，也会发生这种情况。

有什么办法可以清理活动 B 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-07T21:41:05.737

据我所知，这似乎是 Android 中与 TextView ChangeWatcher 和 Linkify 或 Html.fromHtml 可跨字符串相关的错误。`setText(null)`我可以通过调用我的活动的 onDestroy()来解决这个问题。可能还有其他可行的解决方法，但我无法找到有关泄漏的任何进一步信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-18T12:59:13.887

对我们来说，问题是由`PasswordTransformationMethod`. `EditText`特别是对我们来说，它被包裹在 a 中`TextInputLayout`，所以我们必须像这样切换它（这段代码在 a 中`Fragment#onDestroyView()`）：

```
 TextInputLayout passwordTextInputLayout = root.findViewById(R.id.textInputLayout);
        if (passwordTextInputLayout.isPasswordVisibilityToggleEnabled())
            passwordTextInputLayout.setPasswordVisibilityToggleEnabled(false); 
```

发生在 androidx.appcompat:appcompat:1.0.0

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-10-17T13:45:36.713

尝试在 onCreateView() 中为这个特定的 View 使用 Application Context 而不是 Activity Context（其中包含任何 android:textIsSelectable="true" 组件）。

```
// Singleton
class MyApplication extends Application {
    private static MyApplication mApp;

    @Override
    public void onCreate() {
        mApp = this;
    }

    public static MyApplication getApp() {
        return mApp;
    }
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    // Suggested inflater use Activity Context
    // So we must tu use Application Context
    Context context = MyApplication.getApp().getApplicationContext();
    LayoutInflater myLayoutInflater = LayoutInflater.from(context);

    View view = myLayoutInflater.inflate(R.layout.my_view, container, false);
    return view;
} 
```

# mongodb - MongoDB - 将 CSV 导入嵌套文档

> ID：10237912
> 
> 赞同：7
> 
> 时间：2012-04-19T22:44:46.960
> 
> 标签：mongodb

我有一个架构，其文档结构如下所示：

```
{ "_id" : ObjectId( "4f8dcb06ee21783d7400003c" ),
  "venue" : ObjectId( "4f8dcb06ee21783d7400003b" ),
  "name" : "Some event",
  "webite: "www.whatever.com",
  "attendees" : [
                    { "_id" : ObjectId( "4f8dfb06ee21783d7134503a" ), "firstName" : "Joe", "lastName" : "Blogs", "emailAddress" : "some@thing1.com" },
                    { "_id" : ObjectId( "4f8dfb06ee21783d7134503b" ), "firstName" : "John", "lastName" : "West", "emailAddress" : "some@thing2.com" }
                    { "_id" : ObjectId( "4f8dfb06ee21783d7134503c" ), "firstName" : "Simon", "lastName" : "Green", "emailAddress" : "some@thing3.com" }
                    { "_id" : ObjectId( "4f8dfb06ee21783d7134503d" ), "firstName" : "Harry", "lastName" : "Smith", "emailAddress" : "some@thing4.com" }
                ],
  "eventType" : "Party"
} 
```

我有一个 CSV 文件，我想将其导入到与会者集合中...

使用[mongoimport 可以吗？](http://www.mongodb.org/display/DOCS/Import+Export+Tools) 我读到这个：[Using mongoimport to read CSV into nested structure?](https://stackoverflow.com/questions/7809986/using-mongoimport-to-read-csv-into-nested-structure) 似乎答案可能是否定的……

由于这是一次性操作，我不介意是否必须将其导入“参加者”集合，然后运行另一个命令插入到我的文档中的参加者集合中？（目前只有一个事件文档....）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T16:12:10.677

你是对的，不幸的是答案是否定的。

Mongoimport 是一个非常简单的程序。（您可以在这里亲自查看：[https](https://github.com/mongodb/mongo/blob/master/src/mongo/tools/import.cpp) ://github.com/mongodb/mongo/blob/master/src/mongo/tools/import.cpp ）对于想要导入比 2- 更复杂的数据的用户字符串和数字的维度表，官方建议是编写一个自定义脚本，该脚本将读取您的输入文件并以您想要的格式创建文档。希望 import.cpp 文件能给你一些关于如何开始的想法。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2018-12-26T10:47:32.660

这可能很晚，但对运行**mongoDB > 4.x的未来用户很有用**

您可以通过在名称上使用点运算符来使用 csv 文件导入子文档。

例如。**如果您想要一个包含名为extra**的子文档的文档，其中包含**税收、状态和 created_at**，那么您可以将您的字段命名为`extra.taxes.auto(), extra.state.auto(), and extra.created_at.date(2006-01-02)`.

我被这个问题困住了，无法在线找到帮助，所以在这里发布。希望这可以帮助某人。

# python - 将字符串转换为位列表，反之亦然

> ID：10237926
> 
> 赞同：23
> 
> 时间：2012-04-19T22:45:49.683
> 
> 标签：python, python-3.x

我需要将 ASCII 字符串转换为位列表，反之亦然：

```
str = "Hi" -> [0,1,0,0,1,0,0,0,0,1,1,0,1,0,0,1]

[0,1,0,0,1,0,0,0,0,1,1,0,1,0,0,1] -> "Hi" 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-19T23:06:19.663

使用库函数有很多方法可以做到这一点。但我偏爱第三方[`bitarray`](http://pypi.python.org/pypi/bitarray)模块。

```
>>> import bitarray
>>> ba = bitarray.bitarray() 
```

从字符串转换需要一些仪式。曾几何时，您可以只使用`fromstring`，但该方法现在已弃用，因为它必须将字符串隐式编码为字节。为避免不可避免的编码错误，最好将`bytes`对象传递给`frombytes`. 从字符串开始时，这意味着您必须明确指定编码 - 无论如何这是一个好习惯。

```
>>> ba.frombytes('Hi'.encode('utf-8'))
>>> ba
bitarray('0100100001101001') 
```

转换为列表很容易。（此外，位串对象已经有很多类似列表的函数。）

```
>>> l = ba.tolist()
>>> l
[False, True, False, False, True, False, False, False, 
 False, True, True, False, True, False, False, True] 
```

`bitstring`s 可以从任何可迭代对象中创建：

```
>>> bitarray.bitarray(l)
bitarray('0100100001101001') 
```

转换回字节或字符串也相对容易：

```
>>> bitarray.bitarray(l).tobytes().decode('utf-8')
'Hi' 
```

为了纯粹的娱乐：

```
>>> def s_to_bitlist(s):
...     ords = (ord(c) for c in s)
...     shifts = (7, 6, 5, 4, 3, 2, 1, 0)
...     return [(o >> shift) & 1 for o in ords for shift in shifts]
... 
>>> def bitlist_to_chars(bl):
...     bi = iter(bl)
...     bytes = zip(*(bi,) * 8)
...     shifts = (7, 6, 5, 4, 3, 2, 1, 0)
...     for byte in bytes:
...         yield chr(sum(bit << s for bit, s in zip(byte, shifts)))
... 
>>> def bitlist_to_s(bl):
...     return ''.join(bitlist_to_chars(bl))
... 
>>> s_to_bitlist('Hi')
[0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1]
>>> bitlist_to_s(s_to_bitlist('Hi'))
'Hi' 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-04-19T23:10:55.023

可能有更快的方法来做到这一点，但不使用额外的模块：

```
def tobits(s):
    result = []
    for c in s:
        bits = bin(ord(c))[2:]
        bits = '00000000'[len(bits):] + bits
        result.extend([int(b) for b in bits])
    return result

def frombits(bits):
    chars = []
    for b in range(len(bits) / 8):
        byte = bits[b*8:(b+1)*8]
        chars.append(chr(int(''.join([str(bit) for bit in byte]), 2)))
    return ''.join(chars) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-04-19T23:16:00.343

不知道为什么，但这里有两个只使用内置函数的丑陋单行：

```
s = "Hi"
l = map(int, ''.join([bin(ord(i)).lstrip('0b').rjust(8,'0') for i in s]))
s = "".join(chr(int("".join(map(str,l[i:i+8])),2)) for i in range(0,len(l),8)) 
```

产量：

```
>>> l
[0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1]
>>> s
'Hi' 
```

在现实世界的代码中，使用`struct`or`bitarray`模块。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-04-19T22:56:18.797

您可以使用内置的[`bytearray`](http://docs.python.org/py3k/library/functions.html#bytearray)：

```
>>> for i in bytearray('Hi', 'ascii'):
...     print(i)
... 
72
105

>>> bytearray([72, 105]).decode('ascii')
'Hi' 
```

并[`bin()`](http://docs.python.org/py3k/library/functions.html#bin)转换为二进制。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-01-27T09:34:30.020

```
def text_to_bits(text):
    """
    >>> text_to_bits("Hi")
    [0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1]
    """
    bits = bin(int.from_bytes(text.encode(), 'big'))[2:]
    return list(map(int, bits.zfill(8 * ((len(bits) + 7) // 8))))

def text_from_bits(bits):
    """
    >>> text_from_bits([0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1])
    'Hi'
    """
    n = int(''.join(map(str, bits)), 2)
    return n.to_bytes((n.bit_length() + 7) // 8, 'big').decode() 
```

另请参阅[将二进制转换为 ASCII 反之亦然 (Python)](https://stackoverflow.com/q/7396849/4279)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-01-27T11:19:02.913

```
def to_bin(string):
    res = ''
    for char in string:
        tmp = bin(ord(char))[2:]
        tmp = '%08d' %int(tmp)
        res += tmp
    return res

def to_str(string):
    res = ''
    for idx in range(len(string)/8):
        tmp = chr(int(string[idx*8:(idx+1)*8], 2))
        res += tmp
    return res 
```

这些功能真的很简单。
它不使用第三方模块。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-16T03:55:18.720

一些速度比较。这些中的每一个都是使用

```
python -m timeit "code" 
```

或者

```
cat <<-EOF | python -m timeit
    code
EOF 
```

如果是多行。

# 位到字节

**A**：100000000 次循环，3 次中的最佳：每个循环 0.00838 微秒

```
res = 0
for idx,x in enumerate([0,0,1,0,1,0,0,1]):
    res |= (x << idx) 
```

**B**：100000000 个循环，3 个中最好的：每个循环 0.00838 微秒

```
int(''.join(map(str, [0,0,1,0,1,0,0,1])), 2) 
```

# 字节到位

**A** : 100000000 个循环，3 个中最好的：每个循环 0.00836 微秒

```
[(41 >> x) & 1 for x in range(7, -1, -1)] 
```

**B**：100000 个循环，最好的 3 个：每个循环 2.07 微秒

```
map(int, bin(41)[2:]) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-08-17T14:01:20.977

```
import math

class BitList:
    def __init__(self, value):
        if isinstance(value, str):
            value = sum([bytearray(value, "utf-8")[-i - 1] << (8*i) for i in range(len(bytearray(value, "utf-8")))])
        try:
            self.value = sum([value[-i - 1] << i for i in range(len(value))])
        except Exception:
            self.value = value

    def __getitem__(self, index):
        if isinstance(index, slice):
            if index.step != None and index.step != 1:
                return list(self)[index]
            else:
                start = index.start if index.start else 0
                stop = index.stop if index.stop != None else len(self)

                return BitList(math.floor((self.value % (2 ** (len(self) - start))) >> (len(self) - stop)))
        else:
            return bool(self[index:index + 1].value)

    def __len__(self):
        return math.ceil(math.log2(self.value + 1))

    def __str__(self):
        return self.value

    def __repr__(self):
        return "BitList(" + str(self.value) + ")"

    def __iter__(self):
        yield from [self[i] for i in range(len(self))] 
```

`BitList`然后您可以使用数字或列表（数字或布尔值）进行初始化，然后您可以获取其值、获取位置项、获取切片并将其转换为列表。注意：目前无法设置项目，但当我添加时，我会编辑这篇文章。

我自己做了这个，然后去寻找如何将*字符串*（或文件）转换为位列表，然后从另一个答案中弄清楚。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-27T16:15:24.787

这可能有效，但如果您询问 PEP 8（长线，复杂），它就不起作用

```
tobits = lambda x: "".join(map(lambda y:'00000000'[len(bin(ord(y))[2:]):]+bin(ord(y))[2:],x))
frombits = lambda x: ''.join([chr(int(str(y), 2)) for y in [x[y:y+8] for y in range(0,len(x),8)]]) 
```

这些像普通函数一样使用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-09-05T21:03:37.433

因为我喜欢生成器，所以我会在这里发布我的版本：

```
def bits(s):
    for c in s:
        yield from (int(bit) for bit in bin(ord(c))[2:].zfill(8))

def from_bits(b):
    for i in range(0, len(b), 8): 
        yield chr(int(''.join(str(bit) for bit in b[i:i + 8]), 2)) 

print(list(bits('Hi')))
[0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1]
print(''.join(from_bits([0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1])))
Hi 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-03-02T15:19:55.703

如果 a 中有位，`list`则只需将其转换为`str`然后再转换为数字。数字将表现得像一个位串，然后可以应用按位运算。例如 ：

```
int(str([1,0,0,1]) | int(str([1,0,1,1]) 
```

# c++ - 从指针向量中删除东西

> ID：10237927
> 
> 赞同：0
> 
> 时间：2012-04-19T22:45:53.303
> 
> 标签：c++, pointers, vector

我有一个这样的指针向量：

```
vector<Item*> items; 
```

我想清除它。我试过了：

```
for (unsigned int i = 0; i < items.size(); i++)
    delete items.at(i);
items.clear(); 
```

,

```
while (!items.empty())
{
    delete items.back();
    items.pop_back();
} 
```

,

```
while (!items.empty())
{
    delete items.at(0);
    items.erase(items.begin());
} 
```

， 和

```
while (!items.empty())
    delete items.at(0); 
```

这些中的每一个都因某种原因而爆炸，包括删除已删除的对象和超出范围的向量迭代器。

我该怎么办？我希望能够重用相同的向量，并在以后向其中添加更多的 Item 指针。只是使用`delete`而不清除仍然会在那里留下垃圾指针，对吗？

编辑：好的，我已经切换到 shared_ptrs。我现在有

```
vector<shared_ptr<Item> > items; 
```

然而，当我这样做时`items.clear();`，我收到错误“向量迭代器不兼容”。我还在做错什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T23:13:06.070

我用你所有的删除方法进行了测试，其中一种根本不起作用。有关它们的评论，请参见下面的代码。

要回答您的问题“我该怎么做”，这是我在删除时发生段错误时所做的事情：
1）确保内存是我的（我知道相应的新内存在哪里）？
2）确保我没有删除内存（如果我删除了，即使它是我的，现在也不是）。

3）如果你很确定你的段错误是由你的代码的一个部分引起的，把它分解成另一个项目中的一个小测试用例（就像你在你的问题中所做的那样）。然后玩它。如果您在一个小项目中运行代码示例，您会在最后一个项目中看到 seg-fault，并且您会注意到删除在其他所有情况下都有效。像这样分解代码会让你知道你需要跟踪你是如何将这些存储在你的向量中的，以查看你在哪里失去了它们的所有权（通过删除，或者将它们传递给删除它们的东西，等等...... ）。

附注：正如其他人所说，如果您可以使用智能指针，他们会为您处理内存管理。但是，请继续在这里学习并了解如何使用愚蠢的指针。有时您无法导入 boost，或者让 QT 为您进行内存管理。此外，有时您必须将指针存储在容器中，因此也不要害怕这样做（即：QT 开发人员强烈建议使用指针来存储小部件而不是引用或任何类似的东西）。

```
#include <vector>

using namespace std;
class Item
{
public:
    int a;
};

int main()
{
    vector<Item *> data;

    for(int x = 0; x < 100; x++)
    {
        data.push_back(new Item());
    }

    //worked for me, and makes sense
    for(int x = 0; x < 100; x++)
    {
        delete data.at(x);
    }
    data.clear();

    for(int x = 0; x < 100; x++)
    {
        data.push_back(new Item());
    }
    //worked for me, and makes sense
    while (!data.empty())
    {
        delete data.back();
        data.pop_back();
    }
    data.clear();

    for(int x = 0; x < 100; x++)
    {
        data.push_back(new Item());
    }

    //  //worked for me, and makes sense
    while (!data.empty())
    {
        delete data.at(0);
        data.erase(data.begin());
    }

    for(int x = 0; x < 100; x++)
    {
        data.push_back(new Item());
    }

//  //This one fails, you are always trying to delete the 0th position in
//  //data while never removing an element (you are trying to delete deleted memory)
//  while (!data.empty())
//  {
//      delete data.at(0);
//  }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:49:47.030

要么使用这样的智能指针向量：

```
vector<shared_ptr<Item> > myVect; 
```

或者使用 boost 中的[指针容器](http://www.boost.org/doc/libs/1_49_0/libs/ptr_container/doc/ptr_container.html)库。

可能有一种方法可以做到这一点并重用东西，但它似乎容易出错并且需要做更多的工作，特别是考虑到 boost 中的指针容器是一个仅头文件的库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T22:50:01.370

使用`boost::shared_ptr<Item>`，当向量被清除或元素被删除时，它们将被删除。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T22:50:18.983

> 我该怎么办？

不要维护指针向量。确实，这几乎总是一个错误，并且您正在与为您处理内存管理的向量 (RAII) 的设计作斗争。您现在必须调用`delete`每个指针。

你真的需要一个指针向量吗？如果你*真的*这样做（不仅仅是认为你这样做，但实际上是出于某种原因的要求），然后使用智能指针。

向量将为您动态分配内存，只需按预期使用即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T23:15:17.767

听起来好像您的向量中重复了相同的指针。为了确保您只删除它们一次，只需将它们转移到 a`std::set`并在那里删除它们。例如，

```
std::set<Item*> s( items.begin(), items.end() );
items.clear();

while ( !s.empty() )
{
    delete *s.begin();
    s.erase( s.begin() );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-24T20:27:00.083

嗯，我做到了。用了很多时间，吃了很多阿司匹林，掉了很多头发，我终于弄清楚了问题所在。原来我之前调用了一个特定的析构函数，它包含包含这个指针向量的类。我不知道仅*调用*析构函数会导致它擦除所有静态数据成员。我有时讨厌 c++。

# java - 在线程之间共享只读引用

> ID：10237932
> 
> 赞同：3
> 
> 时间：2012-04-19T22:46:10.687
> 
> 标签：java, multithreading, reference

假设我们有 2 个线程，线程 A 和线程 B。

线程 A 是 main 方法，包含大型数据结构。

是否可以创建第二个线程并将数据结构（线程 A 本地）的地址（指针）传递给线程 B，以便两个线程都可以从数据结构中读取？

这样做的目的是避免需要在线程 B 上复制整个数据结构或花费大量时间从数据结构中提取相关信息以供线程 B 使用

请记住，两个线程都没有修改数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T22:48:52.597

1.  在 Java 中，不使用术语指针，而是引用。
2.  可以将它作为任何其他对象传递给另一个线程。作为 Java 中的任何（非最终）类，您可以扩展它、添加成员、添加构造函数等。
3.  （如果您需要修改数据）您需要确保没有并发问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T22:48:59.123

它在 java 中被称为引用，因为您无法直接访问传统意义上的指针。（在大多数情况下，将其视为“安全”，因为每个引用都是一个始终按值传递的指针，唯一合法的操作是取消引用它。它与 C *++*的“引用”不同。）

您当然可以在线程之间共享引用。任何可以获得对它的引用的线程都可以看到和使用堆上的任何内容。您可以将其放在静态位置，也可以将引用的值设置`Runnable`为指向数据。

```
public class SharedDataTest {

  private static class SomeWork implements Runnable {
    private Map<String, String> dataTable;

    public SomeWork(Map<String, String> dataTable) {
      this.dataTable = dataTable;
    }

    @Override
    public void run() {
      //do some stuff with dataTable
    }
  }

  public static void main(String[] args) {

    Map<String, String> dataTable = new ConcurrentHashMap<String, String>();

    Runnable work1 = new SomeWork(dataTable);
    Runnable work2 = new SomeWork(dataTable);

    new Thread(work1).start();
    new Thread(work2).start();

  }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T22:49:38.330

是的，这是可能的，而且是通常的做法，但您需要确保使用正确的同步来确保两个线程都能看到最新版本的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T23:20:55.517

共享对不可变对象的引用是安全的。粗略地说，不可变对象是构造**后**状态不变的对象。语义上不可变对象应仅包含最终字段，而这些字段又引用不可变对象。

如果要共享对可变对象的引用，则需要使用适当的同步，例如使用 synchronized 或 volatile 关键字。

安全共享数据的简单方法是使用 java.util.concurrent 包中的实用程序，例如**AtomicReference**或 ConcurrentHashMap，但是如果您共享的对象是可变的，您仍然必须非常小心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-20T11:31:22.200

如果您没有对共享数据进行任何修改，您可以拥有一个共享引用，并且不会产生重大开销。

但是，当您开始同时修改共享对象时要小心，在这种情况下，您可以使用 java 中提供的数据结构（参见示例工厂方法`Collections`），或使用自定义同步方案，例如 with `java.util.concurrent.locks.ReentrantLock`。

# windows - 寻找 Forms.Screen.DeviceName 到 Monitor EDID 信息的可靠映射

> ID：10237937
> 
> 赞同：6
> 
> 时间：2012-04-19T22:46:38.030
> 
> 标签：windows, winforms, winapi, monitor, edid

我正在开发一个应用程序，它将在相应监视器的对话框上显示从 EDID 块（监视器型号、ID、S/N 等）派生的信息。

[此代码](http://wmimonitor.svn.sourceforge.net/viewvc/wmimonitor/DisplayInfoWMIProvider/WMIProvider/WMIProvider.cs?view=markup)用于查找显示器的 EDID 信息。**它通过枚举HKLM\SYSTEM\CurrentControlSet\Enum\DISPLAY\[Monitor]\[PnPID]\Device Parameters\EDID**下的 DISPLAY 键来提取 EDID 信息。

***更新：**上面的代码依赖于 PnP 使用注册表的“副作用”。我现在使用[SetupAPI](http://www.pinvoke.net/default.aspx/setupapi.setupdienumdeviceinterfaces)来枚举监视器，它可以正确处理附加/删除的监视器（与上面链接中的代码不同。）*

我正在尝试将 Windows.Forms.Screen.AllScreens[]（\\.\DISPLAY1、\\.\DISPLAY2 等）中的每个屏幕与上述注册表检查返回的条目相关联。

*注意：在下面的代码块中，DisplayDetails.GetMonitorDetails() 现在已被替换为使用 SetupAPI 的更强大的注册表枚举代码，但返回的数据是相同的。*

例如

```
private void Form1_Load(object sender, EventArgs e)
{
    Console.WriteLine("Polling displays on {0}:", System.Environment.MachineName);
    int i = 0;
    foreach ( DisplayDetails dd in DisplayDetails.GetMonitorDetails())
    {
        Console.WriteLine( "Info: Model: {0}, MonitorID: {1}, PnPID: {2}, Serial#:{3}", dd.Model, dd.MonitorID, dd.PnPID, dd.SerialNumber );
        Console.WriteLine( "Does this correlate to Screen: {0}?", Screen.AllScreens[i++].DeviceName );
    }
} 
```

## 输出：

信息：型号：DELL P2411H，显示器 ID：DELA06E，PnPID：5&2e2fefea&0&UID1078018，序列号：F8NDP0C...PU

这是否与屏幕相关：\\.\DISPLAY1？

信息：型号：DELL P2411H，显示器 ID：DELA06E，PnPID：5&2e2fefea&0&UID1078019，序列号：F8NDP0C...AU

这是否与屏幕相关：\\.\DISPLAY2？

* * *

**答案：没有**

在测试中，我发现这些并不可靠相关（我有一个系统，其中枚举的第一个显示是 \\.\DISPLAY2）。

我的问题： ***有没有办法可靠地获取给定 Forms.Screen 的 EDID 信息？*** 我可以获得 EDID 块，但没有找到将其与 UI 顶级表单相关联的路径。提示用户是不可取的，因为在我的用例中，两个（或更多）显示器可能是相同的型号和分辨率，并且仅在 S/N 中相差几个数字。

我已经在 Forms.Screen API、Win32 EnumDisplay、其他注册表 GUID（即插即用和驱动程序相关）之后寻找路径，但没有找到任何有希望的路径。

我还调查了 WMI Win32_DesktopMonitor API (Windows 7)，但它似乎没有更多信息可以帮助我将其与 Windows.Forms.Screen.AllScreens[] 条目相关联。

我怀疑是否有办法做到这一点，它是通过 SetupAPI，但我还没有找到它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-24T18:11:30.780

[EnumDisplayDevices](https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-enumdisplaydevicesa) API中提供了一种将 GDI 解析为 SetupAPI 的方法。如果你在 dwFlags 中传入**EDD_GET_DEVICE_INTERFACE_NAME**，监听器枚举会返回如下形式的 DeviceID 信息：

```
Monitor 0 info:
DeviceName: \\.\DISPLAY1
MonitorInfo: Dell P2411H(Digital)
DeviceID: \\?\DISPLAY#DELA06E#5&2e2fefea&0&UID1078018#{e6f07b5f-ee97-4a90-b076-3
3f57bf4eaa7}
Monitor 1 info:
DeviceName: \\.\DISPLAY2
MonitorInfo: Dell P2411H(Digital)
DeviceID: \\?\DISPLAY#DELA06E#5&2e2fefea&0&UID1078019#{e6f07b5f-ee97-4a90-b076-3
3f57bf4eaa7} 
```

DeviceID 字段现在与**didd.DevicePath**的结果匹配，如下面的 C# 片段中检索到的：

```
 Guid MonitorGUID = new Guid(Win32.GUID_DEVINTERFACE_MONITOR);

    // We start at the "root" of the device tree and look for all
    // devices that match the interface GUID of a monitor
    IntPtr h = Win32.SetupDiGetClassDevs(ref MonitorGUID, IntPtr.Zero, IntPtr.Zero, (uint)(Win32.DIGCF_PRESENT | Win32.DIGCF_DEVICEINTERFACE));
    if (h.ToInt64() != Win32.INVALID_HANDLE_VALUE)
    {
        bool Success = true;
        uint i = 0;
        while (Success)
        {
            // create a Device Interface Data structure
            Win32.SP_DEVICE_INTERFACE_DATA dia = new Win32.SP_DEVICE_INTERFACE_DATA();
            dia.cbSize = (uint)Marshal.SizeOf(dia);

            // start the enumeration 
            Success = Win32.SetupDiEnumDeviceInterfaces(h, IntPtr.Zero, ref MonitorGUID, i, ref dia);
            if (Success)
            {
                // build a DevInfo Data structure
                Win32.SP_DEVINFO_DATA da = new Win32.SP_DEVINFO_DATA();
                da.cbSize = (uint)Marshal.SizeOf(da);

                // build a Device Interface Detail Data structure
                Win32.SP_DEVICE_INTERFACE_DETAIL_DATA didd = new Win32.SP_DEVICE_INTERFACE_DETAIL_DATA();
                didd.cbSize = (uint)(4 + Marshal.SystemDefaultCharSize); // trust me :)

                // now we can get some more detailed information
                uint nRequiredSize = 0;
                uint nBytes = Win32.BUFFER_SIZE;
                if (Win32.SetupDiGetDeviceInterfaceDetail(h, ref dia, ref didd, nBytes, out nRequiredSize, ref da))
                {
                    // Now we get the InstanceID
                    IntPtr ptrInstanceBuf = Marshal.AllocHGlobal((int)nBytes);
                    Win32.CM_Get_Device_ID(da.DevInst, ptrInstanceBuf, (int)nBytes, 0);
                    string InstanceID = Marshal.PtrToStringAuto(ptrInstanceBuf);
                    Console.WriteLine("InstanceID: {0}", InstanceID );
                    Marshal.FreeHGlobal(ptrInstanceBuf);

                    Console.WriteLine("DevicePath: {0}", didd.DevicePath );
                }
                i++;
            }
        }
    }
    Win32.SetupDiDestroyDeviceInfoList(h);
} 
```

样本输出：

```
InstanceID: DISPLAY\DELA06E\5&2E2FEFEA&0&UID1078018
DevicePath: \\?\display#dela06e#5&2e2fefea&0&uid1078018#{e6f07b5f-ee97-4a90-b076-33f57bf4eaa7} 
```

原始 EnumDisplayDevices 中的 DeviceName 与 Forms.Screen.DeviceName 属性匹配。

有了这两条信息，现在可以在**SetupDIEnumDeviceInterface**遍历期间使用如下片段读取 EDID 块：

```
private static byte[] GetMonitorEDID(IntPtr pDevInfoSet, SP_DEVINFO_DATA deviceInfoData)
{
    IntPtr hDeviceRegistryKey = SetupDiOpenDevRegKey(pDevInfoSet, ref deviceInfoData,
        DICS_FLAG_GLOBAL, 0, DIREG_DEV, KEY_QUERY_VALUE);
    if (hDeviceRegistryKey == IntPtr.Zero)
    {
        throw new Exception("Failed to open a registry key for device-specific configuration information");
    }

    IntPtr ptrBuff = Marshal.AllocHGlobal((int)256);
    try
    {
        RegistryValueKind lpRegKeyType = RegistryValueKind.Binary;
        int length = 256;
        uint result = RegQueryValueEx(hDeviceRegistryKey, "EDID", 0, ref lpRegKeyType, ptrBuff, ref length);
        if (result != 0)
        {
            throw new Exception("Can not read registry value EDID for device " + deviceInfoData.ClassGuid);
        }
    }
    finally
    {
        RegCloseKey(hDeviceRegistryKey);
    }
    byte[] edidBlock = new byte[256];
    Marshal.Copy(ptrBuff, edidBlock, 0, 256);
    Marshal.FreeHGlobal(ptrBuff);
    return edidBlock;
} 
```

最后，可以解析 VESA 描述符块，[如此代码中的 DisplayDetails.GetMonitorDetails() 方法所示。](https://sourceforge.net/p/wmimonitor/code/HEAD/tree/DisplayInfoWMIProvider/WMIProvider/WMIProvider.cs)

# jquery - 如果所需宽度小于初始大小，则无法减小 flexigrid 的宽度

> ID：10237943
> 
> 赞同：0
> 
> 时间：2012-04-19T22:48:18.720
> 
> 标签：jquery, flexigrid

[在这里](http://groups.google.com/group/flexigrid/browse_thread/thread/0ed687e4cbb002e5/c36fbcb6ed6b4b0c)找到以下问题：

> 您好，我在我的应用程序中使用 flexigrid。水平调整大小存在一个问题，我无法将宽度减小到小于在制作网格时给它的初始宽度。
> 
> 您还可以在 [http://flexigrid.info/](http://flexigrid.info/)上的“示例 3”中看到此问题。尝试减小网格的宽度。

我在使用 flexigrid 1.1 时遇到了同样的问题，我找到了一个解决方案，所以我想我会发布它。

如果有人有更好的解决方案，不需要编辑插件，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:51:40.107

在第 180 行`flexigrid.js`更改：

```
if (newW > p.defwidth) {
    this.gDiv.style.width = newW + 'px';
    p.width = newW;
} 
```

对此：

```
//if (newW > p.defwidth) {
    this.gDiv.style.width = newW + 'px';
    p.width = newW;
//} 
```

注释掉这个 if 语句似乎起到了作用，而且我没有看到任何不利的副作用。

# c++ - 中间函数

> ID：10237944
> 
> 赞同：1
> 
> 时间：2012-04-19T22:48:33.163
> 
> 标签：c++, string

我需要一个函数 middle 接受一个字符串，如果有奇数个字符，则返回中间字符，如果 C++ 中的字符串中有偶数个字符，则返回两个中间字符，不幸的是我找不到为 C++ 中的示例预先制作的任何内容

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T22:52:14.710

```
std::string middleCharacters(const std::string &str)
{
    if (str.length() <= 0) return ""; // For an empty string, return an empty string (customize this as desired)
    return str.substr((str.length() - 1) / 2, 2 - str.length() % 2);
} 
```

为了证明这有效：http: [//ideone.com/vId2l](http://ideone.com/vId2l)

# android - Android：调用远程信使服务的同步方法

> ID：10237945
> 
> 赞同：0
> 
> 时间：2012-04-19T22:48:36.073
> 
> 标签：android, handler, synchronous, messenger

我想编写一个连接到远程服务的模块。

开发人员可以在他们的应用程序中使用该模块连接到特定的（蓝牙）硬件。然后它应该连接到一个可以在市场上单独更新的远程服务。

因为远程服务只允许同时使用它的所有应用程序有一个线程（只有一个蓝牙连接），所以我选择了信使方法而不是 AIDL。

我现在的问题是我想在我的公共 API 中提供一个同步方法，但服务在处理程序中返回 - 据我所知，处理程序将一直等待当前任务完成......所以有没有在不同的线程中获得答案的方法？

我希望它是同步方法的代码：

```
responseDataSync = new Sync<ResponseData>();

    // Send message
    Message msg = Message.obtain(null, Constants.DATA, 1, 0);

    send(msg);

    try {
        ResponseData responseData = responseDataSync.get();

        // with responseDataSync using a countdown latch to synchronize...
// but it never fires thanks to the handler.
//etc... 
```

提前致谢。我希望我的问题有点可以理解...... ;)

/编辑：我想要一些从服务器返回数据的方法。喜欢

```
 public ResponseData returnResponse(Data dataToSend) 
```

但我等不及服务的返回，因为我被困在阻止处理程序返回的线程中......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-20T09:46:30.393

A`Handler`与单个消息队列相关联。如果您`Message`从任何线程发送一个，它将在那里排队。

接收所有消息的线程将从队列中取出适当的消息并一一处理。

对您而言，这意味着如果您有一个处理程序并且您通过处理程序运行所有消息，则您不需要同步，因为所有内容都在单个线程中处理。

编辑：创建一个处理后台线程中消息的处理程序：

```
HandlerThread ht = new HandlerThread("threadName");
ht.start();
Looper looper = ht.getLooper();
Handler.Callback callback = new Handler.Callback() {

    @Override
    public boolean handleMessage(Message msg) {
        // handled messages are handled in background thread 
        return true;
    }
};
Handler handler = new Handler(looper, callback);

handler.sendEmptyMessage(1337); 
```

Edit2：等待消息可能会像这样工作

```
// available for all threads somehow
final Object waitOnMe = new Object();

HandlerThread ht = new HandlerThread("threadName");
ht.start();
Looper looper = ht.getLooper();
Handler.Callback callback = new Handler.Callback() {

    @Override
    public boolean handleMessage(Message msg) {
        // handled messages are handled in background thread
        // then notify about finished message.
        synchronized (waitOnMe) {
            waitOnMe.notifyAll();
        }
        return true;
    }
};
Handler handler = new Handler(looper, callback);

// in a different Thread:
synchronized (waitOnMe) {
    handler.sendEmptyMessage(1337);
    try {
        waitOnMe.wait();
    } catch (InterruptedException e) {
        // we should have gotten our answer now.
    }
} 
```

# javascript - 通过 javascript 克隆图像 base64 失败

> ID：10237953
> 
> 赞同：0
> 
> 时间：2012-04-19T22:49:28.080
> 
> 标签：javascript, jquery, image, base64, clone

我需要克隆一个里面有一些imgs的html块，就像这样：

```
<span class="slides_container" id="rotator1">
    <div class="slide">
      <div class="photoInfo">imagenes 1</div>
       <img src="data:image/jpg;base64,/9j...FHFf/Z" width="600" height="400" alt="pic1">           
      </div>
   </div>
   <div class="slide">
      <div class="photoInfo">imagenes 1</div>
       <img src="data:image/jpg;base64,/9j...FHFf/Z" width="600" height="400" alt="pic2">           
      </div>
   </div>
</span> 
```

然后我使用这个 jquery 代码来克隆这个块：

```
$('#mediaViewerSlides').append(content.clone()); 
```

结果，只有在其 src attr 上克隆的第一个图像在 base64 字符串的末尾有类似 GET 参数的东西，如下所示： src="...FHFf/Z?133487557212" 我不知道这个值是如何出现的或者为什么，显然 base64 字符串上的这些额外数据会使图像无效，并且会破坏其他所有内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:05:04.687

我不确定你为什么**要**克隆这个 div。为什么不保留对图像源的引用并将其添加到容器的克隆版本中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T22:57:02.943

我不确定为什么要添加时间戳，但不是克隆整个对象，也许您可​​以创建一个新对象并将其`src`属性设置为相同的值：

```
$('#mediaViewerSlides').append('<img src="' + content.attr('src') + '" width="600" height="400" />'); 
```

这假定这`content`是对具有 base64 源的图像之一的引用。

如果时间戳被添加到预克隆元素中，那么您可以`src`在创建新元素时将其剥离：

```
var source = content.attr('src');

//if the source includes a question-mark, then get everything before the character
if (source.indexOf('?') > -1) {
    source = source.split('?')[0];
}
$('#mediaViewerSlides').append('<img src="' + source + '" width="600" height="400" />'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T23:40:07.393

我认为您的代码或 Base64 字符串有问题。

刚刚在网上随便找了一张图片，在[这里转成base64 ，在](http://base64img.com)[这个fiddle](http://jsfiddle.net/adeneo/yzjmC/)中克隆了，没有出现这样的问题，所以可能不是jQuery添加了查询字符串。

# string - 如何在Scala中以一种功能性的方式检查字符串与符号白名单的关系？

> ID：10237954
> 
> 赞同：4
> 
> 时间：2012-04-19T22:49:28.217
> 
> 标签：string, scala

我需要保证一个字符串只包含允许的符号。现在我这样做：

```
def isCorrect(s: String, allowedChars: String): Boolean = {
  s.distinct.foreach(c => {
    if (!allowedChars.contains(c))
      return false
  })

  true
} 
```

不用说，这看起来不太漂亮。有没有更好、更实用的方法来做到这一点？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-19T23:41:27.250

作为记录，您可以通过不将自己限制为字符串来使其更通用，并且通过切换参数的顺序和使用两个参数列表来使其更实用（在我看来）。我是这样写的：

```
def isCorrect[A](allowed: Set[A])(s: Seq[A]) = s forall allowed 
```

现在您可以将此方法视为一个函数并“部分应用”它以创建更专业的函数：

```
val isDigits = isCorrect("0123456789".toSet) _
val isAs = isCorrect(Set('A')) _ 
```

它允许您执行以下操作：

```
scala> isDigits("218903")
res1: Boolean = true

scala> isAs("218903")
res2: Boolean = false

scala> isDigits("AAAAAAA")
res3: Boolean = false

scala> isAs("AAAAAAA")
res4: Boolean = true 
```

或者你仍然可以使用类似`isCorrect("abcdr".toSet)("abracadabra")`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T22:57:08.560

```
def isCorrect(s:String, allowedChars:String):Boolean = { 
        s.forall{allowedChars.contains(_)}
    } 
```

或者，更简洁地说，遵循@ziggystar 的建议：

```
def isCorrect(s: String, allowedChars: Seq[Char]) = s forall allowedChars.contains 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-20T09:25:36.657

这不是更实用，而是使用正则表达式：

```
def isCorrect(s: String, allowedChars: String): Boolean =
  s.matches ("^["+ allowedChars +"]*$") 
```

由于正则表达式经常被优化，我会在性能关键代码中考虑这种方法——如果没有测试、测量，也许还有预编译的模式——如果适合手头的问题的话。

由于更具功能性，我看到了 Travis 代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-19T22:59:51.643

我不知道这是否是最实用的方法，但你可以这样做：

```
def isCorrect(s: String, allowedChars: String): Boolean = {
    return s.distinct.forall(c => allowedChars.contains(c))
} 
```

**不同**的并不是真正必要的。

# android - Android Robotium 找不到测试用例

> ID：10237960
> 
> 赞同：0
> 
> 时间：2012-04-19T22:49:57.917
> 
> 标签：android, robotium, testcase

我有一个想要自动化的 Android 项目。

我为它创建了一个 Robotium 项目，这里有一个 TestCase：

```
package com.nu.art.software.cyborg.automation.test;

import android.app.Instrumentation;
import android.content.Context;
import android.test.ActivityInstrumentationTestCase2;
import android.test.suitebuilder.annotation.Smoke;

import com.nu.art.software.cyborg.automation.core.AutomationManager;
import com.nu.art.software.cyborg.core.ApplicationLauncher;
import com.nu.art.software.cyborg.log.Log;
import com.nu.art.software.cyborg.log.Logger;
import com.nu.art.software.cyborg.modules.automation.AutomationScenario;
import com.nu.art.software.rexml.core.ReXML;

public class TestCase
        extends ActivityInstrumentationTestCase2<ApplicationLauncher>
        implements Logger {

    private AutomationScenario automationScenario;

    private Context context;

    private Context targetContext;

    protected AutomationManager manager;

    protected final String TAG = getClass().getSimpleName();

    public TestCase() {
        super(ApplicationLauncher.class);
    }

    @Override
    public final void setUp()
            throws Exception {
        Instrumentation instrumentation = getInstrumentation();
        context = instrumentation.getContext();
        targetContext = instrumentation.getTargetContext();
        automationScenario = ReXML.getSystemReXML().deserialize(AutomationScenario.class, context.getAssets().open("user_scenario.xml"));
        manager = new AutomationManager();
        manager.setInstrumentation(instrumentation);
        manager.init();
    }

    @Smoke
//  @SmallTest
    public void runScenario()
            throws Exception {
        try {
            manager.executeScenario(automationScenario);
        } catch (Exception e) {
            logError(e);
            throw e;
        }
    }

/**  Some log methods  **/
} 
```

清单中定义的项目包与**TastCase**所在的包匹配：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.nu.art.software.cyborg.automation.test"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="7" />

    <application
        android:icon="@drawable/icon"
        android:label="@string/app_name" >
        <uses-library android:name="android.test.runner" />
    </application>

    <instrumentation
        android:name="android.test.InstrumentationTestRunner"
        android:targetPackage="com.nu.art.software.android.services" />

</manifest> 
```

我确定它无法识别测试，因为：

![在此处输入图像描述](../Images/536a6f143441632f3f2e28cbea23bb56.png)

有什么我想念的吗？

提前致谢，

亚当。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-20T05:35:03.723

您的测试用例需要从测试开始。示例是 testRunScenario()。

# wpf - 如何在 XAML 中将 DataContext 设置为静态属性？

> ID：10237969
> 
> 赞同：1
> 
> 时间：2012-04-19T22:50:57.980
> 
> 标签：wpf, xaml

这对我不起作用

```
<UserControl x:Class="BenchmarkPlus.PMT.UI.Views.Circle"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" d:DesignHeight="300" d:DesignWidth="300" x:Name="root"
             DataContext="{Binding Source={x:Static Brushes.Blue}}">
    <UserControl.Resources>
        <Style TargetType="Ellipse">
            <Setter Property="Fill" Value="{Binding DataContext}" />
        </Style>
    </UserControl.Resources>
    <Grid>
        <Ellipse Stroke="Black"></Ellipse>
    </Grid>
</UserControl> 
```

![在此处输入图像描述](../Images/db764bf67ed140a3113ba627519d6b2f.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T23:09:02.687

使其简单`DataContext="{x:Static Brushes.Blue}"`并更改`Value="{Binding DataContext}"`为`Value="{Binding}"`.

当您在绑定表达式中指定路径时，它始终与您的 DataContext 相关，因此当您使用 时`{Binding DataContext}`，您实际上是绑定到`DataContext.DataContext`，这不是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T23:19:31.743

我想你想要

```
<UserControl x:Class="BenchmarkPlus.PMT.UI.Views.Circle" 
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"  
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"  
             mc:Ignorable="d" d:DesignHeight="300" d:DesignWidth="300" x:Name="root" 
             DataContext="{x:Static Brushes.Blue}"> 
    <UserControl.Resources> 
        <Style TargetType="Ellipse"> 
            <Setter Property="Fill" Value="{Binding}" /> 
        </Style> 
    </UserControl.Resources> 
    <Grid> 
        <Ellipse Stroke="Black"></Ellipse> 
    </Grid> 
</UserControl> 
```

# c++ - 右值引用和 std::move

> ID：10237971
> 
> 赞同：3
> 
> 时间：2012-04-19T22:51:02.990
> 
> 标签：c++, c++11, rvalue-reference

有人可以解释为什么 B 不能编译，但 C 可以吗？我不明白为什么需要 std::move ，因为变量已经是右值引用。

```
struct A {
  int x;
  A(int x=0) : x(x) {}
  A(A&& a) : x(a.x) { a.x = 0; }
};

struct B : public A {
  B() {}
  B(B&& b) : A(b) {}  // compile error with g++-4.7
};

struct C : public A {
  C() {}
  C(C&& c) : A(std::move(c)) {}  // ok, but why?
}; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-19T23:24:22.080

在声明中：

```
B(B&& b) 
```

该**参数** `b`使用类型声明： rvalue reference to `B`。

在声明中：

```
A(b) 
```

**表达式** `b`是类型的左值`B`。

并且左值表达式不能绑定到右值引用：特别是语句中的右值引用：

```
A(A&& a) 
```

这个逻辑完全遵循语言的其他部分。考虑这个函数：

```
void
f(B& b1, B b2, B&& b3)
{
   g(b1);
   g(b2);
   g(b3);
} 
```

尽管 的参数`f`都声明为不同的类型，但表达式`b1`和都是 type 的左值表达式，因此无论如何重载，都将调用相同的函数`b2`。`b3``B``g``g`

在 C++11 中，区分变量的声明和使用该变量产生的表达式比以往任何时候都更加重要。并且表达式永远没有引用类型。相反，它们的*值类别*恰好是以下之一：左值、xvalue、prvalue。

该声明：

```
A(std::move(c)) 
```

没关系，因为`std::move`返回一个右值引用。返回右值引用的函数调用产生的表达式具有值类别：xvalue。与纯右值一起，xvalues 被认为是右值。和类型的右值表达式`C`：

```
std::move(c) 
```

将绑定到 rvalue 引用参数：`A(A&& a)`。

我发现下图（最初由 Bjarne Stroustrup 发明）非常有用：

```
 expression
          /  \
    glvalue  rvalue
     /  \    /  \
lvalue  xvalue  prvalue 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-04-19T22:53:14.427

因为命名变量不是右值，即使声明了 &&。如果它有名称，则它不是临时的，因此您需要使用`std::move`.

# jquery - 如何在周视图和日视图中调整 jQuery Full Calendar 中事件的宽度和位置

> ID：10237974
> 
> 赞同：5
> 
> 时间：2012-04-19T22:51:35.713
> 
> 标签：jquery, json, fullcalendar

我在我的一个 Rails 项目中使用[fullcalendar](http://arshaw.com/fullcalendar/)在日历上呈现事件。

jsfiddle[显示](http://jsfiddle.net/naren/bQfSd/7)了场景。

我可以调整宽度，但它不会修改同一行中相邻事件的位置。是否有回调或方法可以在修改宽度时调整事件的位置

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-20T04:05:03.640

看看这个小提琴：http: [//jsfiddle.net/100thGear/jRFYE/](http://jsfiddle.net/100thGear/jRFYE/)

我使用 eventRender 回调来更改下一个事件的偏移量。希望这对您有所帮助并让您了解如何进行。

* * *

为什么不使用事件对象的 className 属性来设置呢？您可以在传递给此属性的 CSS 类中设置宽度。

# php - 从 url 隐藏所有控制器

> ID：10237979
> 
> 赞同：4
> 
> 时间：2012-04-19T22:51:44.203
> 
> 标签：php, url-rewriting, yii

我使用 Yii 的 urlManager 将我的 url 从 mypage.com/controller/view 重写为 mypage.com/view。但我有不止一个控制器，并希望将其应用于所有控制器。这可以做到吗？

我当前的 urlManager：

```
'urlManager'=>array(
      'urlFormat'=>'path',
      'showScriptName'=>false,
      'rules'=>array(
      '<action:\w+>' => 'site/<action>',
      ),
 ), 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T06:36:32.437

第一种方式：

```
'<action:(login|logout|about)>' => 'site/<action>',
'<action:(view|edit)>' => 'product/<action>', 
```

实现此功能的第二种方法是使用[使用自定义 URL 规则类](http://www.yiiframework.com/doc/guide/1.1/en/topics.url#using-custom-url-rule-classes)

# iphone - 在 iPhone 模拟器中模拟电话中断

> ID：10237981
> 
> 赞同：38
> 
> 时间：2012-04-19T22:51:51.550
> 
> 标签：iphone, testing, ios-simulator, interrupt

如果我的应用程序被电话或短信打断，我想看看它会发生什么。有没有办法可以在 iPhone 模拟器上进行测试？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-03-25T16:31:52.963

它可能对您的情况没有帮助（因为它在模拟器中不起作用），但激活 Siri 的工作方式类似于打电话，将您的应用程序发送到后台并中断音频，因此测试比制作更容易称呼。Siri 适用于 iPhone 4S 及更高版本、iPod touch 第 5 代和 iPad 3 及更高版本。如果您启用了 Siri，只需按住主页按钮即可。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-16T18:10:21.237

为了扩展 Lewis Gordon 的答案，它也适用于没有 Siri 的设备。如果您启用了语音控制，则按住主页按钮将中断音频并退出活动。

* * *

## 回答 #3

> 赞同：-11
> 
> 时间：2012-04-19T23:02:59.503

Hardware -> Toggle In-Call Status 将让您测试通话中的 UI。

我不知道在模拟器中测试中断的方法，但正如 Lewis Gordon 指出的那样，你可以在设备上调出 Siri——即使没有电话。

# c# - 从 c sharp 客户端应用程序上传到 PHP 服务器

> ID：10237983
> 
> 赞同：17
> 
> 时间：2012-04-19T22:51:59.653
> 
> 标签：c#, php, file-upload, file-transfer

目前我有交流应用程序（客户端应用程序）。和一个用 php 编写的 web 应用程序。每当在客户端执行特定操作时，我想传输一些文件。这是将文件上传到php服务器的客户端代码..

```
private void button1_Click(object sender, EventArgs e)
{
    System.Net.WebClient Client = new System.Net.WebClient();

    Client.Headers.Add("Content-Type", "binary/octet-stream");

    byte[] result = Client.UploadFile("http://localhost/project1/upload.php", "POST",
                                      @"C:\test\a.jpg");

    string s = System.Text.Encoding.UTF8.GetString(result, 0, result.Length); 
} 
```

这是用于移动文件的upload.php文件..

```
$uploads_dir = './files/'; //Directory to save the file that comes from client application.
foreach ($_FILES["pictures"]["error"] as $key => $error) {
  if ($error == UPLOAD_ERR_OK) {
     $tmp_name = $_FILES["pictures"]["tmp_name"][$key];
     $name = $_FILES["pictures"]["name"][$key];
     move_uploaded_file($tmp_name, "$uploads_dir/$name");
 } 
```

我没有从上面的代码中得到任何错误。但它似乎没有工作。为什么？我错过了什么吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-19T23:55:03.833

您当前的 PHP 代码用于处理**多个**文件上传，但您的 C# 代码仅上传**一个**文件。

您需要稍微修改您的 PHP 代码，删除`foreach`循环：

```
<?php
$uploads_dir = './files'; //Directory to save the file that comes from client application.
if ($_FILES["file"]["error"] == UPLOAD_ERR_OK) {
    $tmp_name = $_FILES["file"]["tmp_name"];
    $name = $_FILES["file"]["name"];
    move_uploaded_file($tmp_name, "$uploads_dir/$name");
}
?> 
```

您还需要确保该`./files`目录存在。

我已经用你的 C# 代码测试了上面的 PHP 代码，它运行良好。

*   有关处理文件上传的更多信息，[请参阅 PHP 文档](http://php.net/manual/en/features.file-upload.php)。

*   有关使用 C# 和 PHP 上传***多个***文件的更多信息，以下是一些有用的链接：

    [使用 HTTPWebrequest (multipart/form-data) 上传文件](https://stackoverflow.com/a/2996904/1166205)

    [在 HTML 表单变量中使用数组](http://www.thefutureoftheweb.com/blog/use-arrays-with-html-form-inputs)

    [PHP：上传多个文件](http://php.net/manual/en/features.file-upload.multiple.php)

    如果您想要简单地上传多个文件，您只需一次上传一个文件到`upload.php`C# 循环中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T23:21:05.130

您的 php 代码似乎是正确的，但是您尝试使用 $_FILES 全局的“图片”键访问该文件。您的 csharp 代码中似乎没有指定它。我不知道该怎么做。您可以尝试通过对 $_FILE 全局执行 print_r 或 vardump 或使用 array_keys 函数来查看它在 php 中的命名方式

问候

编辑：我发现此链接可以帮助您为上传的文件添加“名称”： [http ://www.bratched.com/en/home/dotnet/69-uploading-multiple-files-with-c.html](http://www.bratched.com/en/home/dotnet/69-uploading-multiple-files-with-c.html)

# sql-server - SQL 查询中的 IF 条件

> ID：10237984
> 
> 赞同：10
> 
> 时间：2012-04-19T22:52:02.953
> 
> 标签：sql-server, if-statement

我是 SQL Server 的新手。请帮我在查询中编写以下逻辑。

```
If getnow() > today 4 PM
Then
    SELECT *
    FROM table
    WHERE MailDate is Tomorrow
Else
    SELECT *
    FROM table
    WHERE MailDate is Today 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T23:02:22.970

```
select *
from table
where DATEDIFF(day, GETDATE(), maildate) = case when
    DATEPART(hour, GETDATE()) >= 16 then 1 else 0
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T23:01:53.270

```
IF datepart(hh, getdate()) >= 16
    BEGIN
        SELECT *
        FROM table
        WHERE DateDiff(day, getdate(), MailDate) = 1
    END
ELSE
    BEGIN
        SELECT *
        FROM table
        WHERE DateDiff(day, getdate(), MailDate) = 0
    END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-20T08:55:55.093

这里的想法是使用隐含重写规则：

```
IF ( x ) THEN ( y )   is equivalent to  ( NOT ( x ) OR y ) 
```

在你的情况下

```
IF ( DATEPART(HOUR, CURRENT_TIMESTAMP) >= 16 ) 
   THEN ( DATEDIFF(DAY, CURRENT_TIMESTAMP, MailDate) = 1 ) 
```

相当于

```
( NOT ( DATEPART(HOUR, CURRENT_TIMESTAMP) >= 16 ) 
   OR ( DATEDIFF(DAY, CURRENT_TIMESTAMP, MailDate) = 1 ) ) 
```

并且本身等价于

```
( ( DATEPART(HOUR, CURRENT_TIMESTAMP) < 16 ) 
   OR ( DATEDIFF(DAY, CURRENT_TIMESTAMP, MailDate) = 1 ) ) 
```

`ELSE`将原始条款重写为`IF..THEN`独立的语句：

```
IF ( DATEPART(HOUR, CURRENT_TIMESTAMP) < 16 ) 
   THEN ( DATEDIFF(DAY, CURRENT_TIMESTAMP, MailDate) = 0 ) 
```

相当于（这次省略了中间步骤）

```
( ( DATEPART(HOUR, CURRENT_TIMESTAMP) >= 16 )
   OR ( DATEDIFF(DAY, CURRENT_TIMESTAMP, MailDate) = 0 ) ) 
```

然后这两个表达式可以写成合取范式（“a series of `AND`s） ”

```
SELECT *
  FROM the_table
 WHERE ( ( DATEPART(HOUR, CURRENT_TIMESTAMP) < 16 ) 
          OR ( DATEDIFF(DAY, CURRENT_TIMESTAMP, MailDate) = 1 ) ) 
       AND 
       ( ( (DATEPART(HOUR, CURRENT_TIMESTAMP) >= 16
          OR ( DATEDIFF(DAY, CURRENT_TIMESTAMP, MailDate) = 0 ) )  ; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-22T06:06:23.900

select a.name, if(a.is_active='t','Active','Inactive') from mytable a

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T23:49:42.887

我不知道确切的 MS 语法方言，但我会尝试证明您不需要 IF 或 CASE 构造。我以@mellamokb 的回复为例。

```
SELECT *
  FROM the_table
 WHERE ( DATEPART(hour, GETDATE()) >= 16
           AND DATEDIFF(day, GETDATE(), MailDate) = 1)
    OR (DATEPART(hour, GETDATE()) < 16
           AND DATEDIFF(day, GETDATE(), MailDate) = 0)
     ; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-19T23:00:47.163

```
IF ( DATEDIFF(h, GETDATE(), DATEADD(h,4,GETDATE()))>0 )

SELECT *
FROM table
WHERE MailDate is Tomorrow

ELSE

SELECT *
FROM table
WHERE MailDate is Today 
```

这是 MS SQL。如果您想做更多，那么如果您执行 BEGIN .... END，则只需在其中执行一个命令/选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-19T23:05:16.137

```
IF DATEPART(HOUR, GETDATE()) > 16
BEGIN
    -- SELECT statement
END
ELSE 
BEGIN
    -- SELECT statement
END 
```

它不必在存储过程中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-19T22:58:44.050

您需要一个存储过程在 SQL 中执行此操作。看看这里的文档[http://msdn.microsoft.com/en-us/library/aa174792(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa174792(v=sql.80).aspx)

# unix - 是否可以将 xorg 配置为忽略某些窗口上的鼠标事件

> ID：10237991
> 
> 赞同：3
> 
> 时间：2012-04-19T22:52:36.083
> 
> 标签：unix, x11, xlib, xorg

是否可以将 xorg 配置为忽略某些窗口上的鼠标事件？

我的意思是使某些窗口对用户可见，但对鼠标事件透明，例如，如果某些窗口总是在顶部，我可以以某种方式单击它。

也许 xorg 服务器或本机选项或窗口管理器有一些扩展可以“隐藏”某些窗口（按`wm_class`或标题）？

# mercurial - 有没有办法在 hg unshelve -i 输出中手动应用差异？

> ID：10237994
> 
> 赞同：3
> 
> 时间：2012-04-19T22:53:04.340
> 
> 标签：mercurial, shelve, unshelve

`hg shelve`又做了一次——即使应用了[hg unshelve not working](https://stackoverflow.com/questions/2784199/hg-unshelve-not-working)中描述的补丁（它愉快地工作了大约一个月），搁置只是再次“丢失”了我所有的更改。

我在运行时看到了我的搁置名称`hg shelve -l`，但是当我看到时，`hg unshelve -n <name>`我得到了可怕的“ `nothing to unshelve`”消息。

我可以看到所有的变化`hg unshelve -i -n <name>`。由于 unshelve 命令拒绝承认它们在那里，即使它很乐意向我展示它们，将它们放回我的本地存储库的最简单方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-20T06:08:57.260

你可以试试这个`patch`命令。`hg help patch`寻求帮助。

我不熟悉搁置扩展，但我认为您可以执行以下操作：

```
$ hg unshelve -i -n <name> > modifications.patch 
$ hg patch modifications.patch 
```

# validation - 为什么我的 KML 提要不再适用于 Google 地图？

> ID：10237997
> 
> 赞同：1
> 
> 时间：2012-04-19T22:53:24.993
> 
> 标签：validation, google-maps, kml, scraperwiki

我真的很困惑。

我在[https://views.scraperwiki.com/run/hackney_council_planning_kml_output/](https://views.scraperwiki.com/run/hackney_council_planning_kml_output/)有一个 KML 提要？

...直到几周前，它在谷歌地图上运行得非常好：

[http://maps.google.com/maps?q=https://views.scraperwiki.com/run/hackney_council_planning_kml_output/](http://maps.google.com/maps?q=https://views.scraperwiki.com/run/hackney_council_planning_kml_output/)？

现在它给了我一个“找不到文件”错误。提要验证良好：

[http://feedvalidator.org/check.cgi?url=http%3A%2F%2Fviews.scraperwiki.com%2Frun%2Fhackney_council_planning_kml_output%2F](http://feedvalidator.org/check.cgi?url=http%3A%2F%2Fviews.scraperwiki.com%2Frun%2Fhackney_council_planning_kml_output%2F)

...任何想法可能导致这不起作用？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T00:45:40.827

不幸的是，Google 的地图机器人每秒开始读取我们的一些动态 KML URL 数十次。我不知道为什么。ScraperWiki 的动态视图部分目前无法扩展，因此它正在损害其他服务。

同时，我们已禁用它，以便 Google 的机器人无法再查询这些 URL。

您的 KML 提要有多动态？即，如果我们有办法让您创建一个静态文件，那是否足够好？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T18:34:35.887

您对 KML 供稿使用什么 mime 类型？KML mime 类型是

> 应用程序/vnd.google-earth.kml+xml

对于 KMZ：

> 应用程序/vnd.google-earth.kmz

您可以在此处找到更多信息： [https ://developers.google.com/kml/documentation/kml_tut#kml_server](https://developers.google.com/kml/documentation/kml_tut#kml_server)