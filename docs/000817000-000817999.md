# StackOverflow 问答 000817000-000817999

# ruby-on-rails - Ruby/Rails 1&2：收集问题

> ID：817001
> 
> 赞同：1
> 
> 时间：2009-05-03T12:56:08.950
> 
> 标签：ruby-on-rails, collections, partials, hash

嘿，我刚开始学习 ruby​​/rails。目前，我尝试做一个德国书“Praxiswissen Ruby on Rails”的例子，这本书很古老，是为 Ruby on Rails 1 编写的。无论如何，我试着用 Rails 2 做例子。现在我遇到了问题一个多星期。

根据这本书（Rails 1），我必须在我的控制器中写：

> page.replace_html('broadcast_search_result', :partial => 'broadcast_search_result', :collection => @videos['items']);

我发现 Rails 2 中的这个写法类似于：

> @items = 尝试（@videos[:items]）
> 
> page.replace_html('broadcast_search_results', :partial => @items )

但是服务器会抛出以下消息：

> ActionView::MissingTemplate（视图路径 app/views 中缺少模板哈希/_hash.erb）：
> 
> 应用程序/控制器/stations_controller.rb:46:in `__instance_exec0'
> 
> app/controllers/stations_controller.rb:30:in `search_broadcasts'

我应该创建一个模板 hashes/_hash.erb 而不是stations/_item.erb。有人可以帮我吗？

非常感谢你！

* * *

好的，我将添加控制器代码：stations_controller.rb：

```
class StationsController < ApplicationController
  # GET /stations
  # GET /stations.xml
  def index
    @stations = Station.all

    respond_to do |format|
      format.html # index.html.erb
      format.xml  { render :xml => @stations }
    end
  end

  #GET /stations/search_broadcasts
  def search_broadcasts
    @search = params[:broadcast_search][:search]
    @channel = params[:broadcast_search][:channel]
    if params[:broadcast_search][:current_page]
      @current_page = params[:broadcast_search][:current_page].to_i
    else
      @current_page = 1
    end

    @videos = Broadcast.get_videos(
      @search,
      @channel,
      2,
      @current_page
    )

    render(:update) { |page|
      if @videos[:http_code] == 200
        page.replace_html(
          'broadcast_search_results_count',
          :inline => "<p>Es wurden <b><%= @videos[:count] %></b> Sendung<%= 'en' unless @videos[:count] == 1 %> gefunden</p>"
        )
      else
        page.replace_html(
          'broadcast_search_results_count',
          :inline => "<p>Es trat ein Fehler bei der Daten&uuml;bertragung auf.</p>"
        )
      end

      if @videos[:count] > 0
        logger.debug "The object is #{@videos[:items]}"
        @items = @videos[:items]
        page.replace_html(
          'broadcast_search_results',
          :partial => @items
        )
        page.replace_html(
          'broadcast_search_results_navigation',
          :partial => 'broadcast_search_results_navigation',
          :locals => {
            :videos => @videos,
            :search => @search,
            :channel => @channel,
            :current_page => @current_page
          }
        )
        page.show('broadcast_search_results')
        page.show('broadcast_search_results_navigation')
        #page.visual_effect(
        #  :highlight,
        #  'bradcast_search_results'
        #)
      else
        #page.hide('broadcast_search_results')
        #page.hide('broadcast_search_results_navigation')
      end
    }
  end

  # GET /stations/1
  # GET /stations/1.xml
  def show
    @station = Station.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.xml  { render :xml => @station }
    end
  end

  # GET /stations/new
  # GET /stations/new.xml
  def new
    @station = Station.new

    respond_to do |format|
      format.html # new.html.erb
      format.xml  { render :xml => @station }
    end
  end

  # GET /stations/1/edit
  def edit
    @station = Station.find(params[:id])
  end

  # POST /stations
  # POST /stations.xml
  def create
    @station = Station.new(params[:station])

    respond_to do |format|
      if @station.save
        flash[:notice] = 'Station was successfully created.'
        format.html { redirect_to(@station) }
        format.xml  { render :xml => @station, :status => :created, :location => @station }
      else
        format.html { render :action => "new" }
        format.xml  { render :xml => @station.errors, :status => :unprocessable_entity }
      end
    end
  end

  # PUT /stations/1
  # PUT /stations/1.xml
  def update
    @station = Station.find(params[:id])

    respond_to do |format|
      if @station.update_attributes(params[:station])
        flash[:notice] = 'Station was successfully updated.'
        format.html { redirect_to(@station) }
        format.xml  { head :ok }
      else
        format.html { render :action => "edit" }
        format.xml  { render :xml => @station.errors, :status => :unprocessable_entity }
      end
    end
  end

  # DELETE /stations/1
  # DELETE /stations/1.xml
  def destroy
    @station = Station.find(params[:id])
    @station.destroy

    respond_to do |format|
      format.html { redirect_to(stations_url) }
      format.xml  { head :ok }
    end
  end
end 
```

模型broadcast.rb（用于Broadcast.get_videos）：

```
require('net/http')
require('uri')
require('xmlsimple')

class Broadcast < ActiveRecord::Base
  belongs_to :station

  AOL_API_URL = 'http://xml.truveo.com/apiv3'
  AOL_DEVELOPER_ID = '12345667myid'

  def self.channels
    return[
      '[Alle Quellen]',
      'YouTube',
      'MYSPACE',
      'Dailymotion',
      'Google Video',
      'IFILM',
      'Veoh'
    ]
  end

  def self.get_videos(search, channel, per_page, page)

    channels = '' if channel == '[Alle Quellen]'

    url = AOL_API_URL +
      "?method=truveo.videos.getVideos" +
      "&query=" + URI.escape("#{search} type:free format:flash channel:\"#{channel}\"") +
      "&results=#{per_page.to_i}" +
      "&start=#{(page.to_i) * per_page.to_i}" +
      "&appid=#{AOL_DEVELOPER_ID}"
    data = Broadcast.get_xml(url)

    if data[:http_code] == 200
      data[:page_count] = data[:count] / per_page
      data[:page_count] += 1 if data[:count] % per_page > 0
    end

    return data
  end

  def self.get_video(video_id)
    url = AOL_API_URL +
    "?method=truveo.videos.getVideos" +
    "&query=" + URI.escape('id:' + video_id.to_s) +
    "&appid=#{AOL_DEVELOPER_ID}"
    data = Broadcast.get_xml(url)

    video = data[:items][0]
    video[:http_code] = data[:http_code]
    return video
  end

  def self.get_xml(url)

    # Data-Objekt initialisieren
    data = Hash.new
    data[:count] = 0
    data[:items] = Array.new
    data[:url] = url

    # XML-Daten holen
    xml = Net::HTTP.get_response(URI.parse(url))

    # HTTP-Response-Code ŸberprŸfen
    data[:http_code] = xml.code.to_i
    return data unless data[:http_code] == 200

    # XML Parsen
    xml_obj = XmlSimple.xml_in(xml.body.to_s)
    data[:count] = xml_obj['VideoSet'][0]['totalResultsAvailable'][0].to_i
    return data if data[:count] == 0

    # Informationen auslesen
    xml_obj['VideoSet'][0]['Video'].each { |xml_video|
      new_video = Hash.new
      new_video[:video_id] = xml_video['id'][0].to_s
      new_video[:title] = xml_video['title'][0].to_s
      new_video[:source_url] = xml_video['videoUrl'][0].to_s
      new_video[:thumbnail_url] = xml_video['thumbnailUrl'][0].to_s
      new_video[:description] = (xml_video['description'][0].to_s) if xml_video['description']
      new_video[:video_html] = (xml_video['videoPlayerEmbedTag'][0].to_s) if xml_video['videoPlayerEmbedTag']
      data[:items] << new_video
    }

    return data

 end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T06:09:49.893

您看到的问题似乎是，当 Rails 尝试为对象呈现部分时，它会默认使用该对象的类名作为部分的名称。data[:items] 中的每个单独的项目都是一个哈希，所以在某些时候你试图渲染其中一个项目，Rails 正在寻找一个 _hash.html.erb 模板。我认为您想更改以下代码：

```
page.replace_html(
  'broadcast_search_results',
  :partial => @items
) 
```

到：

```
page.replace_html(
  'broadcast_search_results',
  :partial => 'item',
  :collection => @items
) 
```

这应该为@items 中的每个项目呈现_item.html.erb 部分。

# wcf - wcf架构设计。回复：返回值

> ID：817016
> 
> 赞同：0
> 
> 时间：2009-05-03T13:03:54.627
> 
> 标签：wcf, web-services, architecture

您好，感谢您的意见。

我正在创建一个网络服务。该网络服务将接受客户和客户帐户以及其他一些相关对象和属性等。

当网络服务收到请求时，我会尝试处理它。
如果没有错误，我只是返回。如果有错误，我会抛出它。

我想知道这是否是最好的方法，或者我是否应该修改我的设计，以便我返回一个 bool 作为响应，甚至创建一个响应对象，它可能包含原始请求对象加上一个状态，如果错误，一个错误列表（即：缺失字段、无效字段、分机）。

你会在你的设计中加入哪种返回方法？
1）如果没有错误则返回，如果错误则抛出错误 2）bool 成功 3）响应对象（包含原始请求对象？和详细结果）？

感谢您的任何建议。史蒂文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T14:23:53.233

作为一般经验法则：如果情况不允许您成功完成请求，则抛出异常。如果您想回传其他信息，例如订单号等，请使用返回值。通过布尔返回值来发回完全失败的信号通常不是一个好主意——调用者可能会忽略/不检查它。

现在，由于它是一个被外部资源使用的 WCF 服务，因此您不应该只抛出一个异常——这是 .NET 特定的东西——而是抛出一个 SOAP 错误。您应该通过向您的操作添加一个或多个 FaultContract 属性，将这些故障声明为您的服务提供的每个操作的服务合同的一部分：

```
[FaultContract(typeof(MyFault1))]
[FaultContract(typeof(MyFault2))]
[OperationContract]
void MyOperation() 
```

您可以在 .NET WCF 中通过抛出 FaultException 或更具体的 FaultException（您可以在其中指定 exakt 故障类型的通用变体）轻松地做到这一点。

马克

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T13:24:57.493

我认为这取决于谁将使用这项服务，

如果您是唯一使用此服务的人，我建议您不返回任何内容（或原始请求），如果出现问题则抛出异常。

如果该服务是供公众使用的，您应该返回一些包含错误的响应对象，以及一些其他相关数据。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T13:25:08.787

我会说这取决于“错误”是什么。如果错误与验证相关但在正常事件过程中是预期的，例如将无效的用户凭据传递给提供用户身份验证的服务，则返回指示请求结果（成功、失败等）的枚举值可能是可以的。但是，如果错误是由于正常事件过程中不应发生的输入引起的，那么我建议您从服务操作中抛出错误。抛出错误表明客户端应用程序出错并且提供了服务不知道如何处理的输入。您可以使用 WCF 服务操作注册特定的故障协定，以便客户端应用程序知道该操作可能会在特定情况下引发多个故障之一。

作为一个基本的经验法则，我会说在特殊情况下抛出错误，例如客户端提供了服务操作不希望接收的输入。如果客户端提供了不正确的信息但服务操作被编程处理，则在响应消息中返回状态代码或信息。

# image - 通过文档文字 SOAP 以 base64 格式发送图像的替代方法

> ID：817021
> 
> 赞同：3
> 
> 时间：2009-05-03T13:06:54.010
> 
> 标签：image, soap, base64, attachment

我目前正在为一个业务应用程序修改一个文档文字 SOAP 服务，该应用程序来回传输有关客户的数据。

刚刚确定了传输扫描文档图像的新要求。我遇到的问题是我使用的专有语言不支持 SOAP 附件。

正在传输的图像最大为 32KB。

我能想到的唯一解决方案是对图像进行 base64 编码，并将其作为 XML 文档的元素传递。

这感觉像是一个非常糟糕的主意，但我想不出更好的办法。

有任何想法吗？

编辑：我忘了提到图像不是远程保存在文件系统中，而是存储在 Oracle 数据库中，我无法直接连接到该数据库，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T13:11:47.697

如果您使用 XML 作为数据传输机制，则必须以某种方式对图像进行编码。原因是 XML 是一种文本格式，并且 XML 处理器将尝试将二进制数据解码为文本（更具体地说，就好像它是 UTF-8 一样，除非您指定不同的编码）。此外，XML 明确禁止多个字符（XML 1.0 的大多数 ASCII 不可打印字符，XML 1.1 的 \u0000），因此如果您只是将图像数据转储到（例如）CDATA 部分，则会损坏数据。

编辑：XML Schema 定义了[“base64Binary”](http://www.w3.org/TR/xmlschema-2/#base64Binary)类型，因此您应该能够适当地定义您的 WSDL（假设您使用的是自动编组器）。至少，您应该在包含编码内容的元素上使用[“xsi:type”属性。](http://www.w3.org/TR/xmlschema-1/#xsi_type)

# c - Compile Build and c file on Windows

> ID：817037
> 
> 赞同：0
> 
> 时间：2009-05-03T13:17:18.400
> 
> 标签：c, windows, build

I have a directory that has the following files

1.  Build
2.  asc2uni.c
3.  asc2uni.1

I have to compile it, but the problem is I don't know how what is the compiler to use for this format and how to do it. Any ideas?

**Edit: I am trying to compile this on Windows XP.**

Edit 2: The Build file content:

```
cc -I../Modules -O -o asc2uni asc2uni.c ../Modules/Lib.a 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T13:29:36.653

If they're graphical applications, your most likely going to need Visual C++ from Microsoft.

If, as I suspect, they're simple command-line applications (for ASCII/Unicode conversion), get a hold of one of the free command-line compilers. [MinGW](http://www.mingw.org/) (Minimalist GNU for Windows) is one option but I always steer people towards [CygWin](http://www.cygwin.com/) since, other than a build environment, it offers a slew of other things which come in really handy.

The `Build` file may well be the script which is supposed to build the code for you in which case its contents would be a great help (to you and us) in figuring out which tools you actually need.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T13:45:20.720

I would also suggest to use a MinGW variant.

I used [DCC+](http://dcplusplus.sourceforge.net/) in the past a lot. But you may try Code::Blocks (and make sure to use version which includes the MinGW Compiler).

Another thing you could do is to install [CygWin](http://www.cygwin.com/) and learn how to use all those cool developer tools in a linux environment. Which would also help you to get to read this name.1 file (which is a unix-man file)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T13:23:14.377

The asc2uni file name sounds like it is part of [Unitex](http://igm.univ-mlv.fr/~unitex/index.html), and if so notice that the newest version have combined asc2uni and uni2asc into one program called `convert`. So you might want to investigate if you want to switch to a newer version before investing too much energy into trying to compile something old. Also I see there are a windows installer binary available as well, maybe you even do not have to compile anything?

Anyhow, to compile the file with the gcc compiler run

```
gcc -o asc2uni asc2uni.c 
```

The file `asc2uni.1` sound like a manual file and does not need to be compiled, just installed. If you want to create a plain text version of it you can run

```
nroff -man asc2uni.1 | col -b > asc2uni.txt 
```

For windows you can install [cygwin](http://www.cygwin.com/) where you can select to install gcc. There are also other ports of gcc (like [mingw](http://www.mingw.org/)), but probably any C compiler will do. Nroff and col are probably available in cygwin, but I am not 100% sure.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T13:24:16.120

Windows doesn't come with a C compiler, so unless you install one you are out of luck. You can download a free C compiler from [http://www.mingw.org/](http://www.mingw.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T13:42:59.570

[Visual Studio Express](http://www.microsoft.com/exPress/download/#webInstall) is free, but is probably overkill for this little program. It does download and install pretty quickly, and is a good start for C/C++ programming.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T13:54:19.293

If you don't currently have a C compiler, there are a number of options (the simplest is probably [mingw](http://http:www.mingw.org) as previously mentioned, or perhaps the free [Microsoft Visual Studio Express Edition](http://www.microsoft.com/express/vc/). A larger list can be found [here](http://www.thefreecountry.com/compilers/cpp.shtml).

Or perhaps you already have Visual Studio and you want to know how to compile from the command line? If so, [this](http://msdn.microsoft.com/en-us/library/ms235639(VS.80).aspx) might help.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T17:26:11.920

If it's either console programs or windows program, try using codeblocks. To create the gui part of your program use ResEd [http://www.oby.ro/rad_asm/resed/index.html](http://www.oby.ro/rad_asm/resed/index.html) seems to have been discontinued but it's still a good editor

# ajax - ASP.NET MVC 中 MicrosoftAjax.js 的脚本全球化怎么样？

> ID：817046
> 
> 赞同：2
> 
> 时间：2009-05-03T13:21:45.427
> 
> 标签：ajax, asp.net-mvc, scripting, globalization

创建一个 MVC 项目，它的“Scripts”文件夹将包含 MicrosoftAjax.js（发布和调试版本）。

至少在 Visual Web Developer 2008 Express Edition 中，Scripts 文件夹不包含任何全球化脚本，即为该文化定义和设置“__cultureInfo”的 205 个文件（例如“af-ZA.js”）。

MVC 项目模板 Zip 文件中也缺少它们。

我想你可以单独下载它们，但是......

什么是 MVC 进行脚本全球化的方式，MsAjax 的 __cultureInfo 被定制为浏览器的首选语言？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-05T17:11:05.233

好吧……好吧……原来你必须自己做。

以下代码告诉您如何获取全球化脚本并安装它们。此外，它还为您提供了一种方便的扩展方法，允许您在视图或母版页上注入对 MS AJAX 的引用，无论是否启用脚本全球化。

特征：-

*   以最小的努力将 MS AJAX 注入 View
*   根据程序集是在 Debug 还是 Release 模式下编译选择的 Debug 或 Release 版本
*   可选择启用脚本全球化
*   可选地注入对 Sys.Application.initialize() 函数的调用
*   可选地**内联**代码以启用脚本全球化，就像 ScriptManager 一样（需要条件编译符号）；默认情况下，会注入对全球化脚本文件的**引用。**

享受！

```
//
// Include Microsoft Ajax In Your ASP.NET MVC Projects, Optionally With Script Globalization Enabled
// -------------------------------------------------------------------------------------------------
//
// Written by Andrew Webb, 4th May 2009.
//
// Feel free to use in your ASP.NET MVC projects.
// Written for ASP.NET MVC 1.0 and .NET Framework 3.5 SP1.
//
// With thanks to Bertrand LeRoy and Steven Sanderson.
// http://weblogs.asp.net/bleroy/
// http://blog.codeville.net/
//
// Example usage of 'IncludeMicrosoftAjax':-
//    <%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage" Culture="auto" UICulture="auto" %>
//    <%@ Import Namespace="AspNetMvcHelper" %>
//    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
//    <html xmlns="http://www.w3.org/1999/xhtml" >
//    <head runat="server">
//      <!-- Include Ms Ajax, with script globalization enabled -->
//      <%= Html.IncludeMicrosoftAjax (true, false) %>
//      <!-- other script references here, e.g. jQuery -->
//    </head>
//    etc.
//
// Note: for script globalization, the method in this file gets the current thread's current culture.
// The Culture="auto" setting in the Page directive (above) causes this to be set to the browser's
// preferred language.  Alternatively you can set the current thread's current culture manually.
//
// NOTA BENE: for script globalization, the 205 globalization scripts from the MS AJAX Library must be
// obtained from Microsoft and added to your ASP.NET MVC project, as follows:
// 1) Download the Microsoft AJAX Library 3.5 from:
//    http://www.asp.net/ajax/downloads/
//
// 2) Extract all files from the Zip, and locate the "Globalization" folder.  It should have 205 script files
// in it, from "af-ZA.js" to "zu-ZA.js".  Copy this folder inside your website/project, under the "Scripts"
// folder.  Rename the folder to "MsAjaxGlobalization".  The resulting structure should be:
//   <project>\
//     Scripts\
//       MsAjaxGlobalization\
//         <205 files>
//       <jQuery, Ms Ajax and Ms Mvc Ajax files>
//
// Be sure to include the "MsAjaxGlobalization" folder in your web project.  The easiest way is to click
// "Show All Files" button in the Solution Explorer's toolbar so that all files are shown, then right-click
// on "MsAjaxGlobalization" folder and select 'Include In Project' menu item.  You can now unshow all files
// again.
//

using System;
using System.Web;
using System.Web.Mvc;
using System.Web.UI;
using System.Text;
using System.IO;
using System.Threading;
using System.Globalization;
using System.Diagnostics.CodeAnalysis;

namespace AspNetMvcHelper
{
  public static class ViewHelpers
  {
    /// <summary>
    /// Includes Microsoft Ajax in a View, optionally with script globalization enabled.
    /// </summary>
    /// <param name="helper">
    /// Unused.  Included because this method is an extension method of System.Web.Mvc.HtmlHelper.
    /// </param>
    /// <param name="enableScriptGlobalization">
    /// true to enable script globalization, else false.  If true, be sure to include the 205 globalization
    /// scripts in your project, in a subfolder called "MsAjaxGlobalization".  This must be a direct sub-
    /// folder of the "Scripts" folder, which in turn must live under the project root (which is the default
    /// for MVC projects).
    /// </param>
    /// <param name="initializeSysApplication">
    /// true to insert a call to 'Sys.Application.initialize', else false.  (Note sure if this should be
    /// done or not for MVC, so it's an option.)
    /// </param>
    /// <returns>
    /// Include-text that contains "script" tags that a) set up variable '_cultureInfo' (optional), b)
    /// cause the browser to load the Microsoft Ajax library (debug or release), and c) call function
    /// 'Sys.Application.initialize' (optional).
    /// </returns>
    [SuppressMessage("Microsoft.Usage", "CA1801:ReviewUnusedParameters", MessageId="helper")]
    public static String IncludeMicrosoftAjax (this HtmlHelper helper, Boolean enableScriptGlobalization,
                                               Boolean initializeSysApplication)
    {
      // Define INLINE_SETCULTUREINFO if you want to include the statement to set __cultureInfo in the HTML,
      // like the ScriptManager does.  Leave it undefined to have a script file reference instead (preferred).

#if INLINE_SETCULTUREINFO
      String setCultureInfoText = null;
#endif
      String globalizationScriptFileName = null;

      // Text length without the inline statement to set __cultureInfo.
      Int32 includeTextLength = 400;

      // If script globalization is enabled, get the statement that sets __cultureInfo, and add the
      // length of this statement to the overal length of the include-text.
      if (enableScriptGlobalization)
      {
        // Get the current thread's current culture.  Note: we could have a param that says whether to
        // use this or the UICulture.
        CultureInfo culture = Thread.CurrentThread.CurrentCulture;

        // Form the name of the globalization script file, "en-US.js".
        globalizationScriptFileName = culture.Name + ".js";

#if INLINE_SETCULTUREINFO
        // Read in the contents of this file.  Note that if this fails, the browser will be left with
        // __cultureInfo set to "en-US" (see file "MicrosoftAjax.debug.js", lines 6432 and 6433).
        try
        {
          setCultureInfoText = String.Empty;
          String path = HttpContext.Current.Server.MapPath ("~/Scripts/MsAjaxGlobalization/" +
                                                            globalizationScriptFileName);
          setCultureInfoText = File.ReadAllText (path);

          includeTextLength += setCultureInfoText.Length;
        }
        catch (System.ArgumentNullException)
        {
        }
        catch (System.ArgumentException)
        {
        }
        catch (System.IO.PathTooLongException)
        {
        }
        catch (System.IO.DirectoryNotFoundException)
        {
        }
        catch (System.IO.FileNotFoundException)
        {
        }
        catch (System.IO.IOException)
        {
        }
        catch (System.UnauthorizedAccessException)
        {
        }
        catch (System.NotSupportedException)
        {
        }
        catch (System.Security.SecurityException)
        {
        }
        catch (System.Web.HttpException)
        {
        }
#endif
      }

      // Create and initialize the StringBuilder in which we'll build up the include-text.
      StringBuilder sb = new StringBuilder (includeTextLength);
      sb.AppendLine ();

      // Get the application absolute path of the MS AJAX file (release or debug).  As you can see,
      // the folder and file names and locations are hardcoded.  Convention... but er, no configuration!
#if DEBUG
      String msAjaxScriptPath = VirtualPathUtility.ToAbsolute ("~/Scripts/MicrosoftAjax.debug.js");
#else
      String msAjaxScriptPath = VirtualPathUtility.ToAbsolute ("~/Scripts/MicrosoftAjax.js");
#endif

      // Add the globalization statement.
      if (enableScriptGlobalization)
      {
#if INLINE_SETCULTUREINFO
        sb.AppendLine ("<script type=\"text/javascript\">");
        sb.AppendLine ("//<![CDATA[");
        sb.AppendLine (setCultureInfoText);
        sb.AppendLine ("//]]>");
        sb.AppendLine ("</script>");
#else
        String path = VirtualPathUtility.ToAbsolute ("~/Scripts/MsAjaxGlobalization/" + globalizationScriptFileName);
        sb.AppendLine ("<script src=\"" + path + "\" type=\"text/javascript\"></script>");
#endif
      }

      // Add the MS AJAX library reference.      
      sb.AppendLine ("<script src=\"" + msAjaxScriptPath + "\" type=\"text/javascript\"></script>");

      // Add the call to initialize Sys.Application.
      if (initializeSysApplication)
      {
        sb.AppendLine ("<script type=\"text/javascript\">");
        sb.AppendLine ("//<![CDATA[");
        sb.AppendLine ("if (typeof (Sys) === 'undefined') throw new Error('ASP.NET Ajax client-side framework failed to load.');");
        sb.AppendLine ("Sys.Application.initialize();");
        sb.AppendLine ("//]]>");
        sb.AppendLine ("</script>");
      }

      // Return the resulting include-text.      
      return (sb.ToString ());
    } 
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-10T20:06:59.627

我们已经在 CDN 上发布了更新的全球化脚本。[这篇博文将引导您了解如何通过ASP.NET MVC 客户端验证](http://haacked.com/archive/2010/05/10/globalizing-mvc-validation.aspx)来利用全球化。

# linux - 什么是抢占/什么是可抢占内核？到底有什么好处呢？

> ID：817059
> 
> 赞同：65
> 
> 时间：2009-05-03T13:27:30.060
> 
> 标签：linux, operating-system, kernel, preemption

用你自己的话解释一下，什么是抢占，它对（linux）内核意味着什么？

拥有可抢占内核的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-05-03T13:47:08.920

抢占式多任务 - 在单个处理器上运行多个进程/线程，创建它们同时运行的错觉，而实际上每个都分配了小的多路复用时间片来运行。当一个进程被安排停止执行并等待下次切片运行。

抢占式内核是可以在执行代码的过程中被中断的内核——例如响应系统调用——来做其他事情并运行其他线程，可能是那些不在内核中的线程。

抢占式内核的主要优点是系统调用不会阻塞整个系统。如果一个系统调用需要很长时间才能完成，那么这并不意味着内核在这段时间内不能做任何其他事情。主要缺点是这给内核代码带来了更多的复杂性，必须处理更多的最终情况，执行更细粒度的锁定或使用无锁结构和算法。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-03T13:43:53.250

你真的应该使用“抢占式”这个词。有不同种类的抢占。本质上，它非常简单，您可能会用另一个名字来理解它。抢占式操作系统可以在用户模式线程之间切换上下文，而无需在抢占式应用程序中进行任何特殊编程。这允许多任务处理。操作系统可以切换回一个进程，这种切换本质上是透明的。还有诸如抢占式内核之类的东西，它允许抢占内核模式线程（大多数操作系统不允许这样做，但某些应用程序（例如实时系统）需要这样做）。请注意，这是一个非常简化的解释。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-05-03T21:54:04.413

其他人已经充分解释了可抢占内核是什么。

到底有什么好处呢？

主要有以下好处：

*   在非 SMP 系统上降低延迟 - 通常用于实时系统或延迟很重要的其他事物（可能是音频、视频应用程序）
*   教没有 SMP 系统的内核开发人员如何为 SMP 编写正确的代码

使用不可抢占的内核，在单处理器系统上，内核开发人员可能会很懒惰，并且大部分时间没有任何锁定就可以逃脱 - 当然，这在 SMP 上是一个很大的失败。可抢占内核允许他们在没有更多内核的情况下获得这种痛苦。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-11-27T10:07:10.887

我认为这篇[文章](http://kernelnewbies.org/FAQ/Preemption)解释了你的问题：

> 什么是抢占？

操作系统抢占或停止当前计划任务以支持更高优先级任务的能力。调度可以是但不限于进程或I/O调度等之一。

> 什么是抢占内核？

在 Linux 下，用户空间程序一直是可抢占的：内核使用常规时钟滴答中断用户空间程序以切换到其他线程。因此，内核不会等待用户空间程序显式释放处理器（协作多任务就是这种情况）。这意味着用户空间程序中的无限循环不会阻塞系统。

然而，直到 2.6 内核，内核本身是不可抢占的：一旦一个线程进入内核，它就不能被抢占来执行另一个线程。当系统调用终止时，或者当当前线程明确要求调度程序使用 schedule() 函数运行另一个线程时，处理器可用于执行另一个线程。这意味着内核代码中的无限循环阻塞了整个系统，但这并不是真正的问题：内核代码被设计为没有无限循环。

2.6 内核中引入了内核抢占，可以使用 CONFIG_PREEMPT 选项启用或禁用它。如果启用了 CONFIG_PREEMPT，那么内核代码可以在任何地方被抢占，除非代码禁用了本地中断。代码中的无限循环不再阻塞整个系统。如果禁用 CONFIG_PREEMPT，则恢复 2.4 的行为。

> 优点和缺点？

优点：抢占内核可以改善延迟和可扩展性，它可以使高优先级任务运行并及时响应。

缺点：在抢占内核中编写代码很困难，特别是在 SMP 中，您必须考虑许多因素。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-03T13:47:29.483

抢占意味着操作系统支持多个任务（单独的、独立的代码段），并将按计划在任务之间切换。当一个任务被中断时，它被称为“抢占”。现代操作系统支持这一点 - 但例如，简单的嵌入式系统不需要它。支持任务切换的开销并不总是值得的。

# linux - 在 Linux 中创建可执行文件

> ID：817060
> 
> 赞同：42
> 
> 时间：2009-05-03T13:28:07.250
> 
> 标签：linux, executable, file-permissions, chmod, gedit

我计划做的一件事是编写（非常简单的）Perl 脚本，我希望能够在不从终端显式调用 Perl 的情况下运行它们。我很感激，为此，我需要授予他们执行权限。使用 chmod 执行此操作很容易，但它似乎也是一个稍微费力的额外步骤。我想要的是两件事之一：

首先，有没有办法在保存文件时设置执行标志？目前我正在尝试使用 gedit 和 geany，但如果它具有此功能，我愿意切换到具有类似（或更好）功能的编辑器。

如果做不到这一点，有没有办法声明在特定目录中创建的所有文件都应该具有执行权限？

我的 umask 设置为 022，据我了解，这应该没问题，但似乎文件是作为文本文件（具有 666 个默认权限）而不是可执行文件（具有 777 个默认权限）创建的。

也许我只是懒惰，但我认为必须有一种比 chmodding 一个创建的每个脚本更方便的方法。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-05-03T13:48:29.027

使文件可执行：

> chmod +x 文件

查找 perl 的位置：

> 哪个perl

这应该返回类似

> /bin/perl 有时 /usr/local/bin

然后在脚本的第一行添加：

> #!"path"/perl 上面的路径，例如
> 
> #!/bin/perl

然后就可以执行文件了

> 。/文件

PATH 可能存在一些问题，因此您可能也想更改它...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T05:40:07.507

无需破解您的编辑器或切换编辑器。

相反，我们可以想出一个脚本来监视您的开发目录和 chmod 文件，因为它们被创建。这就是我在附加的 bash 脚本中所做的。您可能想通读评论并根据需要编辑“配置”部分，然后我建议将其放在您的 $HOME/bin/ 目录中，并将其执行添加到您的 $HOME/.login 或类似文件中。或者你可以从终端运行它。

这个脚本确实需要 inotifywait，它在 Ubuntu 的 inotify-tools 包中，

```
sudo apt-get install inotify-tools 
```

欢迎提出建议/编辑/改进。

```
#!/usr/bin/env bash

# --- usage --- #
# Depends: 'inotifywait' available in inotify-tools on Ubuntu
# 
# Edit the 'config' section below to reflect your working directory, WORK_DIR,
# and your watched directories, WATCH_DIR. Each directory in WATCH_DIR will
# be logged by inotify and this script will 'chmod +x' any new files created
# therein. If SUBDIRS is 'TRUE' this script will watch WATCH_DIRS recursively.
# I recommend adding this script to your $HOME/.login or similar to have it
# run whenever you log into a shell, eg 'echo "watchdirs.sh &" >> ~/.login'.
# This script will only allow one instance of itself to run at a time.

# --- config --- #

WORK_DIR="$HOME/path/to/devel" # top working directory (for cleanliness?)
WATCH_DIRS=" \
    $WORK_DIR/dirA \
    $WORK_DIR/dirC \
    "                          # list of directories to watch
SUBDIRS="TRUE"                 # watch subdirectories too
NOTIFY_ARGS="-e create -q"     # watch for create events, non-verbose

# --- script starts here --- #
# probably don't need to edit beyond this point

# kill all previous instances of myself
SCRIPT="bash.*`basename $0`"
MATCHES=`ps ax | egrep $SCRIPT | grep -v grep | awk '{print $1}' | grep -v $$`
kill $MATCHES >& /dev/null

# set recursive notifications (for subdirectories)
if [ "$SUBDIRS" = "TRUE" ] ; then
    RECURSE="-r"
else
    RECURSE=""
fi

while true ; do
    # grab an event
    EVENT=`inotifywait $RECURSE $NOTIFY_ARGS $WATCH_DIRS`

    # parse the event into DIR, TAGS, FILE
    OLDIFS=$IFS ; IFS=" " ; set -- $EVENT
    E_DIR=$1
    E_TAGS=$2
    E_FILE=$3
    IFS=$OLDIFS

    # skip if it's not a file event or already executable (unlikely)
    if [ ! -f "$E_DIR$E_FILE" ] || [ -x "$E_DIR$E_FILE" ] ; then
        continue
    fi

    # set file executable
    chmod +x $E_DIR$E_FILE
done 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T17:13:22.203

您所描述的是处理此问题的正确方法。

你说你想留在 GUI 中。您通常可以通过文件属性菜单设置执行位。如果您愿意，您还可以学习如何为上下文菜单创建自定义操作来为您执行此操作。这当然取决于您的桌面环境。

如果您使用更高级的编辑器，您可以编写保存文件时要执行的操作的脚本。例如（我只对 vim 非常熟悉），您可以将其添加到您的 .vimrc 中，以使任何以 " `#!/*/bin/*`" 开头的新文件可执行。

```
au BufWritePost * if getline(1) =~ "^#!" | if getline(1) =~ "/bin/" | silent !chmod +x <afile> | endif | endif 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T13:34:21.247

这真的没什么大不了的。您可以使用单个命令制作一个脚本：

```
chmod a+x *.pl 
```

并在创建 perl 文件后运行脚本。或者，您可以使用如下命令打开文件：

```
touch filename.pl && chmod a+x filename.pl && vi filename.pl # choose your favorite editor 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T17:43:57.527

我认为您遇到的问题是，即使您可以在系统中设置自己的 umask 值，这也不允许您通过 gedit（或您使用的任何编辑器）显式控制在新文件上设置的默认权限.

我相信这个细节是硬编码到 gedit 和大多数其他编辑器中的。您更改它的选项是（a）破解您自己的 gedit 模块或（b）找到一个文本编辑器，允许您设置新文件的默认权限首选项。（对不起，我不知道。）

鉴于此，必须对文件进行 chmod 真的不是那么糟糕，对吧？

# monitoring - j2se 应用程序的监控和警报

> ID：817065
> 
> 赞同：0
> 
> 时间：2009-05-03T13:32:24.230
> 
> 标签：monitoring, jmx, alerts, java

我正在设计一个 J2SE 应用程序，并且正在寻找一种用于监视和警报的解决方案。要求是：

1.  对象可以报告其状态并在遇到问题时发出警报。
2.  在特定对象上调用一些预定义的方法（例如转储它们的状态）。
3.  监控 JVM 运行状况，尤其是内存使用情况。
4.  最好从远程计算机访问以上所有内容。

什么是最好的解决方案？任何涉及 JMX 的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T14:45:00.297

如果您使用 Java 6u10 或更高版本，另请参阅 VisualVM（JDK 中的 jvisualvm.exe），它可以做各种有趣的事情，包括（使用插件）jconsole 可以做的事情。

真的很适合检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T13:38:53.607

是的，您描述的几乎都是 JMX 和 MBean。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T13:42:53.300

您可以使用[smartinspect](http://www.gurock.com/products/smartinspect/)在应用程序中记录您想要的任何内容：对象、图片等。您还可以从远程计算机访问它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T13:49:27.747

请参阅[JConsole](http://java.sun.com/developer/technicalArticles/J2SE/jconsole.html)，它与 Java 安装一起打包。这允许您检查 JMX 可用的统计信息，无论是在本地还是远程机器上。您需要使用适当的选项（在链接的文章中详细说明）启动受监控的 VM，然后只需启动 JConsole 并指向所需的 VM（如果需要，您可以通过身份验证保护）。

JConsole 可以检查所有标准 JMX bean，以及您创建/注册的任何内容。GUI 将允许您调用公开的方法和图表统计信息等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T15:44:36.527

如果您也想在混合中加入警报，请查看 Jopr ( [http://www.jboss.org/jopr/](http://www.jboss.org/jopr/) )

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T22:41:00.800

如果您想检查 JMX 数据，请尝试使用 JRockit Mission Control 附带的管理控制台。它是类固醇上的 JConsole/VisualVM。检查数组、地图、集合、compositeData 等非常容易，并将监控的属性添加到图形或刻度盘中。也可以创建触发警报。

你可以[在这里](http://www.oracle.com/technology/products/jrockit/missioncontrol/index.html)免费下载。

[替代文字 http://www.oracle.com/technology/products/jrockit/missioncontrol/new_and_noteworthy/3.1.0/images/console/mbean_drilling.png](http://www.oracle.com/technology/products/jrockit/missioncontrol/new_and_noteworthy/3.1.0/images/console/mbean_drilling.png)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-03T21:51:41.063

如果您需要持续监控解决方案，请考虑[Evident ClearStone for Java](http://www.evidentsoftware.com/products/clearstone-for-java/)。有了这个，您可以监控任何自定义 mbean，并将其设置为在超出阈值时向您发送警报。

# high-load - 具有 5 GB/天传输量的 Web 应用程序的设计注意事项？

> ID：817072
> 
> 赞同：2
> 
> 时间：2009-05-03T13:35:59.853
> 
> 标签：high-load, high-traffic

我必须构建一个类似于“分支/商店定位器”的 Web 应用程序。用户输入他的地址，Web 应用程序将在地图上绘制附近的商店。

要求之一是：

“Web 应用程序必须支持 100 个并发用户和高达 5GB/天的传输量。”

大部分传输的数据将是文本和 GUI 图像。

所以我的问题是：

1.  这是否被视为高流量应用程序？
2.  我可以寻找哪些 Web 应用程序/站点来获得可比较的流量？
3.  我是否需要实现诸如 memcached、模板缓存、负载服务器平衡等之类的东西......？

我以前做过高流量应用程序，但我从来都不是架构师。因此，尽管我知道一些（不是全部）管理高流量场景的策略，但我并不熟悉它们的实际实施。

有人可以给我建议、反馈或建议的研究吗？我有没有忽略什么？

**另外，我正在使用带有 Smarty 的 LAMP 构建它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T13:53:34.507

在深入研究核心服务器端的东西（负载平衡和 memcached）之前，请确保您了解并实施 YSlow 的所有（或大部分）规则：http: [//developer.yahoo.com/yslow/help/](http://developer.yahoo.com/yslow/help/)

[然后，如果 MySQL 是一个瓶颈，请获取高性能 MySQL](https://rads.stackoverflow.com/amzn/click/com/0596003064)的副本，或者在[www.mysqlperformanceblog.com](http://www.mysqlperformanceblog.com/)上阅读如何调整查询/设计。

每天 5GB 也不算多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T14:00:11.387

在 100Mbps 链路上，您最多可以传输

```
100 * 60 * 60 * 24 / 1024 / 8 = 1054 GB per day 
```

5GB/天大约占其中的 0.5%，所以我认为您不必关心这种规模的流量，因为在此之前有很多事情可能成为您的瓶颈（JavaScript、数据库访问等...） . 此外，一旦你知道你有*足够的*可用带宽，你不应该在编写（和基准测试）你的应用程序之前关心这些事情，因为这可能会导致过早的优化。

我发现 Django 书中的[缩放](http://djangobook.com/en/2.0/chapter12/#s-scaling)部分作为该领域的一般知识很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T14:03:04.860

这只是每秒 60kb（假设运行时间超过 24 小时），但您可能会在高峰时段遇到突发事件，因此您需要能够处理它。即使对于较旧的基于 Apache 的服务器来说，100 个并发用户也不算什么。

我不确定 memcached 是否真的能帮到你很多，但它值得添加，就像你的 PHP cahcing 的[APC](http://uk3.php.net/apc/)一样，我至少会构建它以实现负载平衡 - 查看[ultramonkey](http://www.ultramonkey.org/)以获得一些好的文档如何透明地进行，您需要确保进入的任何用户会话不会以每个主机的方式存储其会话数据；您需要考虑会发生什么情况，即用户在一次调用中点击了铅平衡服务器 A，然后在另一次调用中点击了服务器 B。（即在数据库中存储用户 ID 和数据，而不是在文件系统中）。

# mysql - MySQL全文搜索表意（亚洲）字符

> ID：817080
> 
> 赞同：4
> 
> 时间：2009-05-03T13:41:36.877
> 
> 标签：mysql, full-text-search, sql-like

我有一个充满亚洲字符填充记录（中文、日语和韩文）的数据库，以及那些带有拉丁字符填充记录（英语、法语，你能想到的）的数据库，我想对它们执行全文搜索。

MySQL 说：

> 汉语和日语等表意语言没有单词分隔符。因此，FULLTEXT 解析器无法确定这些语言和其他此类语言中单词的开始和结束位置。第 11.8 节“全文搜索功能”中描述了此问题的含义和一些解决方法。

11.8 节实际上没有提供变通方法，甚至没有提到这个问题。

那么，**如何对混合字符数据库中单个汉字的搜索进行排序**呢？`%LIKE%`会起作用，但它没有漂亮的相关性评级。我应该只计算一个角色出现在记录中的次数，然后按此排名吗？我很感激你的任何建议。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T15:53:49.617

这取决于数据集的大小。如果我们谈论数十万行，我可能会看看可用的优秀独立全文搜索解决方案之一。我实际上从来没有处理过mysqlf这个问题，所以我不确定哪些解决方案包括对亚洲语言的支持。

然而，我确实知道[lucene](http://lucene.apache.org/)支持中文、日文和韩文的分析器，所以我的猜测是它对你正在做的事情有某种支持。当我需要集成 lucene 和 php 时，我通常会做的是将 lucene 实现为套接字服务器，并从 php 连接到它。

如果数据集足够小，则可以选择推出自己的 ad-hoc 方法。这个问题有两个部分：检索要排名的文档，以及实际排名。有几种方法可以进行检索。如果您的数据集足够小，一种可能是使用 LIKE。另一个可能是推出您自己的基于磁盘的索引方案，尽管这会相当复杂和耗时。您也可以使用 MySQL 作为中间路径，如下所述。

为了使用 MySQL 实现索引方案，您必须创建一些具有以下结构的表：

```
document
  document_id
  document_text
  document_tokencount

document_token
  document_id
  token_id
  token_docfrequency
  index (token_id, document_id)

token
  token_id
  token_unicode
  token_globalfrequency
  index (token_unicode) 
```

然后我会处理每个文档，并为文档中的每个字符（令牌）在 document_token 表中插入一行。token_unicode 字段将包含用于引用此字符的整数 unicode 序列。token_docfrequency 字段包含一个整数，对应于文档包含令牌的次数，而 token_globalfrequency 字段包含在所有文档中使用该术语的总次数。

这将允许您快速搜索令牌：

```
SELECT * FROM document_token WHERE token_id = 1
UNION
SELECT * FROM document_token WHERE token_id = 2
UNION
SELECT * FROM document_token WHERE token_id = 3 
```

（联合方法是一种 hack，它允许 mysql 为所有选择利用索引，并且很可能比使用单个 select 和多个 or 语句的相应查询更快）

**这给我们留下了相关性排名作为剩下的问题，这是您真正要求的。:)**这可以通过利用[向量空间模型 (VSM)](http://en.wikipedia.org/wiki/Vector_space_model)来完成，效果非常好。

进行搜索后，您要做的第一件事是计算此令牌的[tf-idf](http://en.wikipedia.org/wiki/Tf-idf)分数。这是使用以下公式完成的：

```
tf-idf = tf(t,d) / tf(d) * log(D / d(t))

where:
tf(t,d) = token frequency in current document
tf(d) = total number of tokens in current document
D = total number of documents
d(t) = number of document that contains the token 
```

首先为搜索查询中的每个词计算这个分数，并将结果存储在 hashmap 或类似的东西中。这是您的第一个向量，称为 v_1。然后继续第一个文档。计算文档中每个术语的 tf-idf 分数，并将其存储为 v_2。[现在您可以使用cosine similiarity](http://en.wikipedia.org/wiki/Cosine_similarity)计算此文档的分数：

```
score = arccos(v_1 * v_2 / (|v_1| * |v_2|)) 
```

结果是一个可用于对文档进行排名的值。继续并为每个文档执行此操作。按降序对它们进行排序。列表中的第一个文档将是最相关的文档。

**这听起来可能有点复杂，但如果你对线性代数有一些基本的了解，你可能会在几个小时内得出一个可行的解决方案。尽管如此，如果可能的话，请使用现有的解决方案，例如 lucene。**

# windows - 关闭硬盘

> ID：817086
> 
> 赞同：3
> 
> 时间：2009-05-03T13:43:29.850
> 
> 标签：windows

如何关闭硬盘？我想这样做是为了能够安全地移除我的 sata 驱动器，即使它是热插拔的。WMI 似乎没有这个方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T13:54:30.107

使用 WMI，您可以使用以下命令弹出“弹出驱动器”对话框：

```
Shell "Rundll32.exe Shell32.dll Control_RunDLLA hotplug.dll", vbNormalFocus 
```

或者，如果您想以编程方式弹出设备，则需要[这篇 MSDN 文章](http://support.microsoft.com/kb/165721)。这应该适用于 sata 驱动器，如果您可以手动弹出它们，那么您将能够以编程方式“弹出”它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T14:06:53.290

**没有任何弹出对话框的解决方案：**

只需使用

```
sync 
```

来自[cygwin](http://cygwin.org)（同步是来自[coreutils](http://www.gnu.org/software/coreutils/)的实用程序）

# python - 在python中调用带有参数列表的函数

> ID：817087
> 
> 赞同：160
> 
> 时间：2009-05-03T13:43:33.843
> 
> 标签：python, function

我试图在 python 的另一个函数中调用一个函数，但找不到正确的语法。我想做的是这样的：

```
def wrapper(func, args):
    func(args)

def func1(x):
    print(x)

def func2(x, y, z):
    return x+y+z

wrapper(func1, [x])
wrapper(func2, [x, y, z]) 
```

在这种情况下，第一次调用会起作用，第二次不会。我要修改的是包装函数而不是调用函数。

* * *

## 回答 #1

> 赞同：282
> 
> 时间：2009-05-03T15:17:44.867

要扩展其他答案：

在行中：

```
def wrapper(func, *args): 
```

旁边的 *`args`表示“获取给定的其余参数并将它们放入名为`args`”的列表中。

在行中：

```
 func(*args) 
```

这里旁边的 *`args`表示“获取这个名为 args 的列表并将其‘解包’到其余参数中。

因此，您可以执行以下操作：

```
def wrapper1(func, *args): # with star
    func(*args)

def wrapper2(func, args): # without star
    func(*args)

def func2(x, y, z):
    print x+y+z

wrapper1(func2, 1, 2, 3)
wrapper2(func2, [1, 2, 3]) 
```

在`wrapper2`中，列表是显式传递的，但在两个包装器中都`args`包含列表`[1,2,3]`。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-03T20:50:24.973

包装函数的最简单方法

```
 func(*args, **kwargs) 
```

...是手动编写一个在其内部调用*func()的包装器：*

```
 def wrapper(*args, **kwargs):
        # do something before
        try:
            return func(*a, **kwargs)
        finally:
            # do something after 
```

在 Python 中，函数是一个对象，因此您可以将它的名称作为另一个函数的参数传递并返回它。您还可以为任何函数*anyFunc()*编写包装器生成器：

```
 def wrapperGenerator(anyFunc, *args, **kwargs):
        def wrapper(*args, **kwargs):
            try:
                # do something before
                return anyFunc(*args, **kwargs)
            finally:
                #do something after
        return wrapper 
```

另请注意，在 Python 中，当您不知道或不想命名函数的所有参数时，可以引用参数元组，用它的名称表示，在后面的括号中加上一个星号函数名称：

```
 *args 
```

例如，您可以定义一个接受任意数量参数的函数：

```
 def testFunc(*args):
        print args    # prints the tuple of arguments 
```

Python 提供了对函数参数的进一步操作。您可以允许函数采用关键字参数。在函数体内，关键字参数保存在字典中。在函数名称后面的括号中，该字典由两个星号表示，后跟字典名称：

```
 **kwargs 
```

打印关键字参数字典的类似示例：

```
 def testFunc(**kwargs):
        print kwargs    # prints the dictionary of keyword arguments 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-05-03T19:48:20.800

对您的问题的字面回答（完全按照您的要求进行操作，仅更改包装器，而不是函数或函数调用）只是更改该行

```
func(args) 
```

读书

```
func(*args) 
```

这告诉 Python 获取给定的列表（在本例中为`args`）并将其内容作为位置参数传递给函数。

这个技巧适用于函数调用的两个“方面”，所以一个函数定义如下：

```
def func2(*args):
    return sum(args) 
```

将能够接受尽可能多的位置参数，并将它们全部放入名为`args`.

我希望这有助于澄清一些事情。请注意，使用 dicts/keyword 参数也可以做到这一点，使用`**`而不是`*`.

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-03T13:47:05.787

您可以对可变长度参数使用 *args 和 **kwargs 语法。

[*args 和 **kwargs 是什么意思？](https://stackoverflow.com/questions/287085/what-does-args-and-kwargs-mean)

并且来自官方的python教程

[http://docs.python.org/dev/tutorial/controlflow.html#more-on-defining-functions](http://docs.python.org/dev/tutorial/controlflow.html#more-on-defining-functions)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-03T13:53:57.860

您需要使用参数解包..

```
def wrapper(func, *args):
    func(*args)

def func1(x):
    print(x)

def func2(x, y, z):
    print x+y+z

wrapper(func1, 1)
wrapper(func2, 1, 2, 3) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-21T14:38:06.507

对先前答案的一个小补充，因为我找不到问题的解决方案，这不值得打开一个新问题，但把我带到了这里。

这是一个小代码片段，它结合了`lists`和`zip()`，`*args`以提供一个包装器，可以处理具有未知数量参数的未知数量的函数。

```
def f1(var1, var2, var3):
    print(var1+var2+var3)

def f2(var1, var2):
    print(var1*var2)

def f3():
    print('f3, empty')

def wrapper(a,b, func_list, arg_list):
    print(a)
    for f,var in zip(func_list,arg_list):
        f(*var)
    print(b)

f_list = [f1, f2, f3]
a_list = [[1,2,3], [4,5], []]

wrapper('begin', 'end', f_list, a_list) 
```

请记住，这`zip()`不提供对不等长度列表的安全检查，请参阅[zip 迭代器在 python 中断言相等长度](https://stackoverflow.com/questions/32954486/zip-iterators-asserting-for-equal-length-in-python)。

# ruby-on-rails - 这堂课有什么问题？

> ID：817090
> 
> 赞同：0
> 
> 时间：2009-05-03T13:44:26.090
> 
> 标签：ruby-on-rails

出于某种原因，我的一个 Ruby on Rails 类在我每次尝试调用它的任何方法时都会产生这种错误：

```
undefined method `create' for Thread:Class 
```

我像任何其他类一样创建了这个类，使用`./script/generate model Thread`然后迁移它。那么为什么它表现得如此奇怪呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T13:50:54.793

ruby 中已经有一个 Thread 类，可能是名称冲突

# php - 是否使用 PHP 框架？

> ID：817096
> 
> 赞同：34
> 
> 时间：2009-05-03T13:47:28.000
> 
> 标签：php, cakephp, codeigniter

我已经开始用 PHP 编写一些应用程序，并且我越来越熟悉这种语言。有人告诉我关于 CakePHP 和 CodeIgniter。我想更好地了解这些对我有什么帮助，以及花时间学习一个框架是否值得？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-05-03T13:56:39.727

使用 MVC PHP 框架有什么好处？

那么使用 PHP 框架有很多好处，让我们看看使用它们的一些主要好处。

1.  这些 PHP 框架遵循一些设计模式，因此当您使用框架时，您必须遵循它们的编码约定，这使您的代码干净且可扩展以备将来使用。
2.  CakePHP、CodeIgniter、Zend Framework、Symfony 等流行的 PHP 框架遵循模型视图控制器 (MVC) 设计模式，该模式将业务逻辑与用户界面分离，同时使代码更清晰和可扩展。
3.  每个人都可以猜到，这些框架包含许多库，可以让您的工作更轻松。例如：要验证一个表单，您不必像在正常编码场景中（不使用框架）那样编写尽可能多的代码，只需几行调用库的代码通常就足够了。
4.  在团队中处理大型项目时，MVC PHP 框架将是一个很好的开发工具，因为您可以指定开发人员为开发人员开发模块的一部分，并且在最终级别集成这些开发模块将非常容易.
5.  这些 MVC 框架确实可以帮助您快速开发项目，如果您熟悉一个框架，那么您将永远不会担心项目的截止日期。
6.  这些 MVC 框架中的大多数都使用清晰的 url 方法，使您的 Web 项目 SEO 友好。

检查[文章](http://roshanbh.com.np/2008/11/php-framworks-why-when-and-which.html)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-03T13:55:37.357

我的理念是，你应该只在解决你当前的需求时才使用它。

有一个真正的趋势，特别是在这个领域，简单地使用一个框架来使用一个框架，或者因为你觉得你应该使用一些东西。我不鼓励这种做法。我认为，当您以艰难的方式完成工作时，框架最有价值，因此您可以很好地了解您遇到的问题以及框架如何**在这种情况下**为您提供帮助。框架选择确实取决于情况。

话虽如此，带有 Web 应用程序的 MVC 模式很有用，因此至少学习一个肯定不会对您造成伤害。不过，我会坚持一个相当简约的框架。CodeIgniter 在这里浮现。

最后，框架的另一个危险是它们可能非常具有侵入性，以至于您不再使用 PHP，而是使用 CakePHP、Symfony 或其他任何东西。这不一定是一个问题，但它如此具有侵入性的危险在于你没有在 PHP 中获得良好的基础，如果你想改变它只会太难以至于你永远无法做到。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-03T14:02:21.770

PHP 框架的一大优点是它们可以最大限度地减少在大量常见 Web 应用程序需求中重新发明轮子。安全问题、优雅的异常处理、RESTful URL 和跨站点代码的可重用性是相当普遍的考虑因素。

熟悉框架的工具可能会更容易，然后看看您是否想采用它支持的完整 MVC 系统。为此，我建议您熟悉 Zend 框架。ZF 作为一个类库工作，可以针对特定用途单独实现——从安全性到 Lucene 搜索——但包含的类在一起使用时，可以实现完全充实的 MVC 范例。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-04T12:20:56.623

我只是想谈谈我自己的编程经验，虽然我还是新手

1.  首先通过使用框架，您将习惯他们的编码风格/规则，这很好，因为大多数框架都深入思考了他们如何编写代码。简而言之，我得到了更好的风格和更简洁的代码
2.  通常框架带有许多武器库（插件和/或库），您可以在互联网上找到它们，这将减少您的编码时间，减少浪费的时间。简而言之，您可以利用自己宝贵的时间思考业务流程
3.  使用开源框架，有其他程序员已经知道并可能掌握了该框架，那么您可以轻松地与他人协作。
4.  事实上，我不是一个组织良好的程序员，但那是在我使用一些开源框架之前。也许像我一样，你会变得更有条理

暂时只能和大家分享这些了，我不擅长英文写作，抱歉。但重点是我建议你使用框架

快乐的编码朋友。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-03T14:06:01.577

我认为花时间学习 PHP 框架无疑是一项很好的投资。一方面，它将教你有人如何解决构建框架的问题，如何组织你的 PHP 代码，以及如何处理诸如会话和数据库访问之类的事情......等等......

在大多数情况下，如果您认真开发 Web 应用程序，您将需要使用某种框架，而不是从头开始编写自己的框架。

为什么不应该编写自己的框架的一些原因：

1.  当它已经完成了很多次时，你正在重新发明轮子。
2.  您不太可能比开源框架做得更好，许多开发人员已经对其进行了测试和迭代。
3.  您将花费所有时间编写和调试自己的框架，而不是实际创建应用程序。

所以，是的，学习几个框架并找到最适合您的框架！

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-03T14:08:53.753

免责声明：我不是 php 程序员，也从未编写过 php 应用程序。另一方面，我已经为我的网站和购物车安装、定制和使用了很多 php cmss。

在我看来，php 存在严重的问题。最大的一个问题是，对于几乎所有大型甚至成功的项目来说，“框架”似乎都是一个外来词。php代码往往很快就变成了意大利面条沙拉：意大利面条html混合了意大利面条代码和意大利面条sql。

osCommerce 是有史以来最成功的购物车之一，几乎无法维护。这也适用于绝大多数 php 项目。

无论您是否应该为您的项目使用框架，我说是的！确实！无论您的项目有多大，使用 Web 框架都可以帮助您整理代码并编写可维护的代码。

即使您不使用框架，它也会影响您的编程风格。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-03T14:30:53.793

使用 MVC 框架将使您的开发更容易。尤其是与数据库相关的应用程序。它为您提供了清晰的文件夹结构和大量的代码库。我建议你从 CodeIgniter 开始。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-07-27T02:08:08.480

当你有一个开发团队在同一个项目上工作时，框架是很棒的。MVC 控制器将设计器 + 程序员完美地集成在一起。但是，创建“类似框架”的元素并“重新发明”轮子并不是一个坏主意。如果您正在处理一个庞大的项目，最好对您的代码进行处理并自定义所有内容以满足您的需求。它将成为一个更强大的产品，因为它将完全为该项目开发。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-07-16T14:23:42.803

以下帖子是对一个线程的回应，该线程在我写我对 RenderIn 帖子的答案时立即关闭：[https ://stackoverflow.com/questions/3265509/what-are-the-benefits-of-using-a-编程框架](https://stackoverflow.com/questions/3265509/what-are-the-benefits-of-using-a-programming-framework)。该线程已关闭，并且在评论中放置了一个链接，将他指向此处，因此我将尝试在这里回答他的问题。下面的引号是我要提交的内容：

“请允许我向您和您的组织推荐 Joomla！。在我的上一个雇主，我不得不学习 PHP（之前没有使用它的经验），并且经过大约一个半月的手动手动编码PHP，我的任务是编写一个 Joomla! 组件，为用户提供视频。我还必须创建一个后端，允许非技术管理员对视频进行分类、编辑、删除等，并提供他们的缩略图等。

现在为了得到一个工作原型，花了大约两个月（当时我是一名实习生，每周只工作 20-24 小时，所以如果你有相当多的 PHP 经验以及 MVC 开发方法的经验，你可能比我更快地得到一个工作原型）。”

现在回应这个线程的 OP：花时间学习框架绝对值得（直到我的帖子我才在这里看到它，所以我再说一遍：对于 PHP 框架，我会推荐Joomla！）。

学习框架的一些好处（像 Joomla 一样的开源框架！）：

*   一个庞大的社区，可以帮助回答您的问题（除了 stackoverflow；哈哈）
*   访问所有源代码，因此您可以根据需要对其进行自定义。
*   许多免费（和付费）第三方插件来增强功能。
*   很多教程。
*   框架负责自动执行许多平凡的任务。

参考第四条：Joomla！为您处理诸如数据库连接管理之类的事情，这样您就不必费心创建所有自己的自定义函数来连接到您的 MySQL 数据库或返回不同类型的数据库结果（例如，一条记录，第一个结果的第一个结果）记录，记录列表等），您只需拨打他们的电话。Joomla! 的 API 在他们的网站上公开可用：http: [//api.joomla.org/](http://api.joomla.org/)

无论如何，希望这有助于 RenderIn 和其他想了解框架的人（尤其是与 PHP 相关的框架）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-07-16T14:34:14.447

**对我来说，框架是一个很好的工具，可以加快你的速度并节省你的时间，只是为了你不想花时间重做它，而不是因为你想节省时间，你不知道它是多少. 如果您这样做，您将为此付出代价。**

对我来说，如果你已经是一名经验丰富的程序员，并且你有接触或感觉你知道框架在下面大致如何工作（只是大致不完全准确）并且如果我愿意的话有信心说你我可以重新创建，那么框架对我来说很好有点像这个框架的简化。那么框架对你来说就是一辆快车，如果你想做一些框架没有准备好的事情，或者一些不寻常的事情或其他奇怪的事情，它不会给你带来痛苦。

如果你不这样做，你最好尝试使用普通的旧 PHP 来解决你的问题，并经历在你手指上玩语言的痛苦，并首先学习良好的编程实践和范式和模式。否则，您将成为加入大型团队的应届毕业生中的一员，他们的第一个项目正在开发一个具有非常强大框架的项目，该框架需要很少的编码，而需要更多的配置和修补。你永远不会成为一个好的程序员，也不能从头开始构建一个好的 PHP 应用程序。

**如果您在一个使用复杂框架的组织中怎么办？**

花一些你自己的时间在这种情况下用普通的 PHP 解决问题，直到你接触到我上面提到的内容。否则，您将永远不会对编程充满信心并不断告诉自己，“我只知道这些步骤就是实现它的方法”。那不是编程（有点极端:)）。

**复杂与简单框架**

一些框架虽然被许多人使用，但只是压倒性的。有太多层您会忘记。这些框架通常用于一些刻板印象，大量配置文件，如果你想做一些不寻常的事情，你最好成为框架编写者（这里有点夸张:)）。我不想在这里提任何名字，但是当你遇到一个时你就会知道。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-01T18:45:58.877

CodeIgniter 是 EllisLab 团队的产品，他们的主要产品是使用 CodeIgniter 开发的 Expression Engine。

使用 CI 一段时间后，我发现使用 Yii 框架更方便。它有很多扩展。使用好的文档并不难理解。

CakePHP，我认为，接近 CodeIgniter。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-03-01T09:46:11.147

我强烈建议您使用一个框架，而不是一个简单的脚本。有时它可能看起来有点矫枉过正，但我​​认为事实并非如此。有几次我认为我不需要它（简单的应用程序，3 db 表中的基本 CRUD）。

不久之后，我发现自己在做手动 mysql_escape_string、XSS 过滤等等。从那时起，当我认为设置需要比工作代码更多时，我只会编写非框架代码。这种情况很少发生。

如果我必须推荐一个 PHP 框架，我必须使用 CodeIgniter 或 Yii 框架，这取决于你的项目有多复杂。

# php - 如何将变量附加到已经有变量的 url？

> ID：817101
> 
> 赞同：2
> 
> 时间：2009-05-03T13:49:51.100
> 
> 标签：php, regex, url

所以，我目前所处的情况有点复杂（对我来说就是这样），但我会试一试。

我想运行一段 HTML 并提取所有引用我自己域的链接。接下来，我想在这些 URL 中附加一个预定义的 GET 变量字符串。例如，我想将 '?var1=2&var2=4' 附加到 ' [http://www.domain.com/page/](http://www.domain.com/page/) ' 从而创建 ' [http://www.domain.com/page/?var1=2&var2= 4](http://www.domain.com/page/?var1=2&var2=4) '。

我目前正在应用的方法是一个简单的 preg_replace 函数 (PHP)，但这是它变得有趣的时候。当它们末尾已经有一些 GET 变量时，我如何创建有效的附加 url？例如，它可以创建这样的 url：' [http](http://www.domain.com/page/?already=here&another=one?var1=2&var2=4) ://www.domain.com/page/?already=here&another=one?var1=2&var2= 4'，从而破坏 GET 数据。

所以总而言之，我正在寻找的是一个可以应对这些场景的 reg exp，创建我的扩展 url 并将其写回 HTML 片段。

这是我到目前为止所拥有的：

```
$sHTML = preg_replace("'href=\"($domainURL.*?[\/$])\"'", 'href="\1' . $appendedTags . '"', $sHTML); 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T15:50:52.680

除了[Elazar Leibovich](https://stackoverflow.com/questions/817101/how-to-append-variables-to-a-url-which-already-has-variables/817172#817172)的建议之外，我还使用 解析查询字符串[`parse_str()`](http://de3.php.net/parse_str)，根据需要修改结果数组，然后使用它[`http_build_query()`](http://de3.php.net/manual/en/function.http-build-query.php)来重建查询字符串。这样，您的查询字符串中就不会有任何重复项，并且您不必为查询部分的 url 编码而烦恼。

完整的示例将如下所示（增加[Elazar Leibovich](https://stackoverflow.com/questions/817101/how-to-append-variables-to-a-url-which-already-has-variables/817172#817172)代码）：

```
$broken = parse_url($url);
$query = parse_str($broken['query']);
$query['var1'] = 1;
$query['var2'] = 2;
$broken['query'] = http_build_query($query);
return $broken['scheme'] . '://' . $broken['host'] . $broken['path'] .
  '?' . $broken['query'] . '#' . $broken['fragment']; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T14:16:39.863

[正如有人所说](http://www.codinghorror.com/blog/archives/001016.html "在正则表达式上编码恐怖")，正则表达式不是解决方案：

> 有些人在遇到问题时会想“我知道，我会使用正则表达式”。现在他们有两个问题。

但没关系，我会使用[parse_url](http://www.php.net/manual/en/function.parse-url.php)，然后将 my 附加`var1=1&var2=2`到结果查询字符串中。类似于以下内容：

```
$broken = parse_url($url);
$broken['query'] .= '&var1=1&var2=2';
if (strpos($broken,'&')==0) $broken['query'] = substr($broken['query'],1);
return $broken['scheme'].'://'.$broken['host'].$broken['path'].
  '?'.$broken['query'].'#'.$broken['fragment']; 
```

如果您不希望变量出现两次，也可以使用[parse_str](http://php.net/parse_str "php 手册页")来拆分查询字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T14:42:55.787

此外， parse_str 不会返回任何值，如答案所示，而是将数组作为参数：

```
$array = array();    
parse_str($url,$array);
// $array will contain the ["scheme"] ["host"] etc 
```

只是一个旁注;）

- G

# javascript - 制作像表格网格一样的真正桌面（如何显示足够的空行来填充表格网格的高度）

> ID：817102
> 
> 赞同：0
> 
> 时间：2009-05-03T13:50:14.233
> 
> 标签：javascript, jquery, css, jqgrid

我真的很关心我的网络应用程序的美学方面，这就是我问这种愚蠢问题的原因。如果您认为这没什么大不了的，请提前原谅我。

我正在构建一个类似 web 应用程序的桌面，并使用 jqGrid 很棒的插件来显示一些表格数据。在 iTunes 等桌面应用程序中，表格有足够的空行来填充其维度。我的意思是，如果您将表格网格的高度设置为 500 像素并且它只有一行，那么表格（斑马）将继续到页面的末尾。这是我想要但现在无法使用 javascript 或 css 完成的东西。

我的第一个想法是制作假空行的表格的背景图像，但这种方法有两个问题。首先，如果用户缩放并使文本变大，它将不起作用，其次，我在列之间显示了一些可实现的边界，这使得无法在背景图像中复制它们。

有没有人尝试过制作这种表格网格？知道怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T14:18:11.843

我要做的只是创建一个具有特定高度的 Table 容器；给它一个垂直平铺的背景；设置`overflow`为`scroll`/ `auto`; 然后将动态大小的表格放入其中。

编辑：对不起，我没有仔细阅读你的问题。鉴于您的其他要求，我会简单地使用 JavaScript。尽管我不熟悉 jqgrid，但为表设置最小行数应该不难。

另一种选择是只使用 2 个表 - 顶部的一个用于实际数据，底部的一个用于空行。每次将一行添加到顶部表格时，就会从底部表格中删除一行，反之亦然。您还必须捕获顶部表格的列调整大小事件，并调整底部表格的列大小。但这很笨拙。

# cocoa - 如何更改复选框的外观？

> ID：817109
> 
> 赞同：3
> 
> 时间：2009-05-03T13:53:32.870
> 
> 标签：cocoa

我想创建一个自定义复选框，其功能就像普通复选框但看起来不同，目前我正在使用普通复选框，有没有办法做到这一点。

PS这是我说的可可。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T14:03:07.777

您需要覆盖 NSButtonCell。您将使用`drawInteriorWithFrame:inView:`或类似的方法来进行自定义绘图。如果您以前从未使用过自定义单元格，那么这可能是一种学习体验，但是那里有很多很好的建议，比如从[这个页面](http://www.cocoadev.com/index.pl?NSButtonCell)开始。

[您还可以查看像BGHUDAppKit](https://github.com/binarygod/BGHUDAppKit)这样的开源框架作为示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T13:51:10.490

作为旁注，如果您唯一需要做的就是将“检查”图像从 Apple 提供的默认图像更改，然后转到 XCode/Interface Builder 中 NSButton 的属性并选择一个图像和一个备用图像。单选按钮也是如此。

# python - 在 Python 中删除数字（正则表达式）

> ID：817122
> 
> 赞同：32
> 
> 时间：2009-05-03T13:59:17.690
> 
> 标签：python, regex, digits

我正在尝试从字符串中删除所有数字。但是，下一个代码也会删除任何单词中包含的数字。显然，我不想那样。我一直在尝试许多正则表达式，但没有成功。

谢谢！

* * *

```
s = "This must not be deleted, but the number at the end yes 134411"
s = re.sub("\d+", "", s)
print s 
```

结果：

> 这个一定不能b删，但是最后的数字yes

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-05-03T14:04:05.463

在 \d+ 之前添加一个空格。

```
>>> s = "This must not b3 delet3d, but the number at the end yes 134411"
>>> s = re.sub(" \d+", " ", s)
>>> s
'This must not b3 delet3d, but the number at the end yes ' 
```

编辑：查看评论后，我决定形成一个更完整的答案。我认为这说明了所有情况。

```
s = re.sub("^\d+\s|\s\d+\s|\s\d+$", " ", s) 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-03T14:12:44.600

试试这个：

```
"\b\d+\b" 
```

这将只匹配那些不属于另一个单词的数字。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-03T15:05:28.203

使用`\s`不是很好，因为它不处理标签等。更好的解决方案的第一步是：

```
re.sub(r"\b\d+\b", "", s) 
```

请注意，该模式是一个原始字符串，因为`\b`通常是字符串的退格转义，我们想要特殊的单词边界正则表达式转义。一个稍微花哨的版本是：

```
re.sub(r"$\d+\W+|\b\d+\b|\W+\d+$", "", s) 
```

当字符串的开头/结尾有数字时，它会尝试删除前导/尾随空格。我说“尝试”是因为如果最后有多个数字，那么你仍然有一些空格。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-03T14:23:58.863

还要处理行首的数字字符串：

```
s = re.sub(r"(^|\W)\d+", "", s) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-12-15T07:45:02.433

你可以试试这个

```
s = "This must not b3 delet3d, but the number at the end yes 134411"
re.sub("(\s\d+)","",s) 
```

结果：

```
'This must not b3 delet3d, but the number at the end yes' 
```

同样的规则也适用于

```
s = "This must not b3 delet3d, 4566 but the number at the end yes 134411" 
re.sub("(\s\d+)","",s) 
```

结果：

```
'This must not b3 delet3d, but the number at the end yes' 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-03-15T02:38:35.863

要仅匹配字符串中的纯整数：

```
\b(?<![0-9-])(\d+)(?![0-9-])\b 
```

它对此做了正确的事情，仅匹配百万之后的所有内容：

```
max-3 cvd-19 agent-007 8-zoo 2ab c3d ef4 55g h66i jk77 
8m9n o0p2     million     0 22 333  4444 
```

此页面上的所有其他 8 个正则表达式答案都因该输入而以各种方式失败。

第一个 0-9 ... [0-9-] ... 末尾的破折号保留 -007，第二组中的破折号保留 8-。

*或 \d 代替 0-9 如果您愿意*

[*在正则表达式101*](https://regex101.com/r/BiIIHr/1) [![在此处输入图像描述](https://i.stack.imgur.com/jzwhQ.jpg)](https://i.stack.imgur.com/jzwhQ.jpg)

*可以简化吗？*

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-03T14:06:05.053

如果您的号码始终位于字符串的末尾，请尝试：re.sub("\d+$", "", s)

否则，您可以尝试 re.sub("(\s)\d+(\s)", "\1\2", s)

您可以调整反向引用以仅保留一两个空格（\s 匹配任何白色分隔符）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-03T15:37:32.290

我不知道你的真实情况是什么样的，但大多数答案看起来他们不会处理负数或小数，

`re.sub(r"(\b|\s+\-?|^\-?)(\d+|\d*\.\d+)\b","")`

以上还应该处理类似的事情，

“这一定不是b3 delet3d，而是末尾的数字是-134.411”

但这仍然不完整——您可能需要更完整地定义您可以在需要解析的文件中找到的内容。

编辑：还值得注意的是 '\b' 会根据您使用的语言环境/字符集而变化，因此您需要小心一点。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-03T15:21:27.103

非正则表达式解决方案：

```
>>> s = "This must not b3 delet3d, but the number at the end yes 134411"
>>> " ".join([x for x in s.split(" ") if not x.isdigit()])
'This must not b3 delet3d, but the number at the end yes' 
```

按 拆分`" "`，并通过执行检查块是否为数字[`str().isdigit()`](http://docs.python.org/library/stdtypes.html#str.isdigit)，然后将它们重新连接在一起。更详细（不使用列表理解）：

```
words = s.split(" ")
non_digits = []
for word in words:
    if not word.isdigit():
        non_digits.append(word)

" ".join(non_digits) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-28T16:49:57.197

我有一个灯泡时刻，我尝试过并且它有效：

```
sol = re.sub(r'[~^0-9]', '', 'aas30dsa20') 
```

输出：

```
aasdsa 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-11-20T12:54:20.547

```
>>>s = "This must not b3 delet3d, but the number at the end yes 134411"
>>>s = re.sub(r"\d*$", "", s)
>>>s 
```

“这一定不是b3 delete3d，而是末尾的数字yes”

这将删除字符串末尾的数字。

# javascript - 带有 ID 的 HTML 类

> ID：817126
> 
> 赞同：4
> 
> 时间：2009-05-03T13:59:55.427
> 
> 标签：javascript, html, css, ajax

我对 HTML 类和 ID 有点困惑，因为我想同时使用它们来描述 HTML 元素。这对大多数浏览器有效并支持吗？

我使用两者的动机是这样的：

1.  我有一个我想应用于多个元素的 CSS 样式。
2.  我有一些 AJAX 和 Javascript 可以操作这些相同的元素，所以我需要一种方法来使用 ID 来识别哪个元素是哪个元素。
3.  所以我想使用一个 id 来识别每个元素以进行 JS 操作，同时我想指定一个类，以便从同一个 css 应用相同的样式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-03T14:04:34.840

ID 将仅对一个项目是唯一的，其中一个类可用于将许多项目组合在一起。您可以按照您的说明将它们一起使用，ID 作为 Javascript 的唯一标识符和使用 CSS 标记的类。

搜索[html class vs id](http://www.google.com/search?q=html+classes+vs+id)以获取有关此主题的许多文章。

例子：

```
<ul>
    <li class="odd" id="item1">First Item in the List</li>
    <li class="even" id="item2">Second Item in the List</li>
    <li class="odd" id="item3">Third Item in the List</li>
</ul> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-03T14:09:59.913

是的，在一个元素中同时使用 ID 和 Class 属性是完全有效的。例子：

```
<div class="infoBox" id="myUniqueStyle"> *content* </div> 
```

不过，请记住，ID 只能使用一次（因此得名），而您可以在整个文档中多次使用类。您仍然可以同时使用 ID 和类来应用样式，而只有 ID 是通过 javascript 访问元素的简单方法。

一个很好的方法是将 ID 应用于您知道是唯一的所有元素（标题、导航、主容器等），并将类应用于其他所有元素。

“是*”*适用于使用 ID 的元素：“这*是*导航栏”、“这*是*标题”

“Is *a* ” 或“is *an* ” 适用于使用类的元素：“This *is a* blogPost”、“this *is an* infoBox”等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T14:11:17.257

如果需要，您绝对可以同时使用两者。

ID 通常用于标识站点的结构部分 - 您应该只有**一个**具有特定 ID 的元素，并且任何元素只能有一个 ID。

一个类用于设置可能在 HTML 文件中多个位置使用的样式 - 任何元素都可以设置多个类。

同时使用 ID 和类的典型 HTML 文档可能类似于

```
<html>
...
<body>
<div id="header"></div>
<ul id="nav" class="full-width dark">...</ul>
<div id="content">
<div id="important-container" class="class-set-by-javascript another-class-set-by-javascript"></div>
</div>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T14:05:34.650

是的，任何普通浏览器都应该允许设置 CSS 类，而不考虑元素 ID。但是，在特定元素上设置样式（例如，使用 id）可能会覆盖通过 CSS 类设置的样式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-04T04:24:32.433

只是关于在 CSS 声明中组合 class 和 id 的一个非常模糊的注释，如果你有 IE6 有一个错误：

*   两个或多个具有相同元素的页面`id`

*   那些元素有不同的 `class`es

*   您正在使用 `#idname.classname`规则为它们设置样式

那么只有样式表中的第一条规则才会生效。

有关详细信息，请参阅[此页面](http://sonspring.com/index.php?id=102)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-05-03T14:06:13.930

是的，它在所有浏览器中都有效。ID 仅通过其他方式表达您的 html 控件的唯一标识，并且类对其应用了一些样式。当每页仅出现一次时使用 ID。当每页出现一次或多次时使用类。

# asp.net - 如何向 ListViewItem 添加标签？

> ID：817128
> 
> 赞同：0
> 
> 时间：2009-05-03T14:00:33.367
> 
> 标签：asp.net, data-binding, listview

我想使用嵌套的 ListView 控件实现[本文提到的外观。](http://mattberseth.com/blog/2008/01/building_a_grouping_grid_with.html)但是，在我的场景中，我无法使用 EntityDataSource 控件，因此我手动绑定数据。

我的桌子：

```
Categories
  PK: UniqueId, Guid
  Name, string
  ParentId, Guid

<asp:ListView ID="CategoryList" runat="server" 
        onitemdatabound="CategoryList_ItemDataBound">
        <LayoutTemplate>
            <table>
                <asp:PlaceHolder ID="itemPlaceHolder" runat="server"></asp:PlaceHolder>
            </table>
        </LayoutTemplate>

        <ItemTemplate>
            <tr>
                <td colspan="2"><%# Eval("Name") %></td>
            </tr>
        </ItemTemplate>
    </asp:ListView>

protected void Page_Load(object sender, EventArgs e)
{
    using (PractiseEntities context = new PractiseEntities()) {
        var result = from categories in context.Categories
                     select categories;
        CategoryList.DataSource = result;
        CategoryList.DataBind();
    }
} 
```

`<td>`我希望子类别通过向“ParentId”不为空的项目添加标签来缩进。我的问题是如何在 ItemDataBound 事件中编辑生成的 html 标签？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T15:31:22.133

你可以有这样的东西：

```
<ItemTemplate>
    <tr>
        <td colspan="2"><%# GetParentContent(Eval("ParentID")) %></td>
    </tr>
</ItemTemplate> 
```

在代码隐藏中：

```
protected string GetParentContent(object ParentID)
{
    if(ParentID!=null)
        ... return parent HTML ...
    else
        return "";
} 
```

# java - 对 JUnit 测试进行分组

> ID：817135
> 
> 赞同：47
> 
> 时间：2009-05-03T14:02:36.013
> 
> 标签：java, unit-testing, junit

有没有办法在 JUnit 中对测试进行分组，以便我只能运行一些组？

或者是否可以注释一些测试然后全局禁用它们？

我正在使用**JUnit 4**，我不能使用 TestNG。

**编辑：** @RunWith 和 @SuiteClasses 效果很好。但是有可能像这样只注释测试类中的一些测试吗？还是我必须注释整个测试类？

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2011-08-29T23:59:40.653

JUnit 4.8 支持分组：

```
public interface SlowTests {}
public interface IntegrationTests extends SlowTests {}
public interface PerformanceTests extends SlowTests {} 
```

进而...

```
public class AccountTest {

    @Test
    @Category(IntegrationTests.class)
    public void thisTestWillTakeSomeTime() {
        ...
    }

    @Test
    @Category(IntegrationTests.class)
    public void thisTestWillTakeEvenLonger() {
        ...
    }

    @Test
    public void thisOneIsRealFast() {
        ...
    }
} 
```

最后，

```
@RunWith(Categories.class)
@ExcludeCategory(SlowTests.class)
@SuiteClasses( { AccountTest.class, ClientTest.class })
public class UnitTestSuite {} 
```

取自这里：[https ://community.oracle.com/blogs/johnsmart/2010/04/25/grouping-tests-using-junit-categories-0](https://community.oracle.com/blogs/johnsmart/2010/04/25/grouping-tests-using-junit-categories-0)

此外，Arquillian 本身支持分组： [https ://github.com/weld/core/blob/master/tests-arquillian/src/test/java/org/jboss/weld/tests/Categories.java](https://github.com/weld/core/blob/master/tests-arquillian/src/test/java/org/jboss/weld/tests/Categories.java)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-03T14:27:01.243

您想在测试类中对测试进行分组还是对测试类进行分组？我将假设后者。

这取决于您如何运行测试。如果您通过 Maven 运行它们，则可以准确指定要包含的测试。请参阅[Maven surefire 文档](http://maven.apache.org/plugins/maven-surefire-plugin/examples/inclusion-exclusion.html)。

不过，更一般地说，我所做的是我有一个测试套件树。JUnit 4 中的测试套件如下所示：

```
 @RunWith(Suite.class)
 @SuiteClasses({SomeUnitTest1.class, SomeUnitTest2.class})
 public class UnitTestsSuite {
 } 
```

所以，也许我有一个 FunctionTestsSuite 和一个 UnitTestsSuite，然后是一个包含其他两个的 AllTestsSuite。如果您在 Eclipse 中运行它们，您将获得一个非常漂亮的分层视图。

这种方法的问题在于，如果您想以不止一种不同的方式对测试进行切片，这有点乏味。但这仍然是可能的（例如，您可以拥有一组基于模块切片的套件，然后再根据测试类型进行切片）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-03T15:09:13.607

为了处理全局禁用它们，JUnit（4.5+）有两种方法一种是使用新方法assumeThat。如果将其放在测试类的@BeforeClass（或@Before）中，并且如果条件失败，它将忽略测试。在这种情况下，您可以放置​​一个系统属性或其他可以全局设置或关闭的东西。

另一种选择是创建一个自定义运行器，它了解全局属性并委托给适当的运行器。这种方法要脆弱得多（因为 JUnit4 内部运行器是不稳定的，并且可以从发布版本更改为发布版本），但它具有能够沿类层次结构继承并在子类中被覆盖的优点。如果您必须支持旧版 JUnit38 类，这也是唯一可行的方法。

这是一些执行自定义 Runner 的代码。关于 getAppropriateRunnerForClass 可能会做什么，我实现它的方式是有一个单独的注释来告诉自定义运行器运行什么。唯一的选择是来自 JUnit 代码的一些非常脆弱的复制粘贴。

```
private class CustomRunner implements Runner
 private Runner runner;

    public CustomRunner(Class<?> klass, RunnerBuilder builder) throws Throwable {
        if (!isRunCustomTests()) {
            runner = new IgnoredClassRunner(klass);
        } else {
            runner = getAppropriateRunnerForClass(klass, builder);
    }

    public Description getDescription() {
        return runner.getDescription();
    }

    public void run(RunNotifier notifier) {
        runner.run(notifier);
    }
} 
```

编辑：@RunWith 标签仅适用于整个班级。解决该限制的一种方法是将测试方法移动到静态内部类并对其进行注释。这样，您就可以利用类组织的注释。但是，这样做对任何 @Before 或 @BeforeClass 标记都没有帮助，您必须在内部类中重新创建它们。它可以调用外部类的方法，但它必须有自己的方法作为钩子。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-08-12T15:13:26.900

在 JUnit 5 中，您可以`@Tag`在类或方法级别声明过滤测试；类似于 TestNG 中的测试组或 JUnit 4 中的类别

从[javadoc](https://junit.org/junit5/docs/5.0.2/api/org/junit/jupiter/api/Tag.html)：

> 标签用于过滤针对给定测试计划执行的测试。例如，开发团队可以用诸如“fast”、“slow”、“ci-server”等值标记测试，然后提供用于当前测试计划的标签列表，这可能取决于当前的测试计划。环境。

例如，您可以声明一个测试类，该类`"slow"` `@Tag`将被所有方法继承，并在需要时为某些方法覆盖它：

```
import org.junit.jupiter.api.Tag;
import org.junit.jupiter.api.Test;

@Tag("slow") 
public class FooTest{

   // 
   @Test
   void loadManyThings(){ 
        ...
   }

   @Test
   void loadManyManyThings(){ 
        ...
   }

   @Test
   @Tag("fast")
   void loadFewThings(){ 
        ...
   }

} 
```

您可以对其他测试类应用相同的逻辑。
这样，测试类（和方法）也属于一个特定的标签。

作为一种很好的做法，您可以创建自定义组合注释，而不是在整个测试类中进行复制`@Tag("fast")`和粘贴。 例如 ： `@Tag("slow")`

```
import java.lang.annotation.ElementType;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;
import java.lang.annotation.Target;

import org.junit.jupiter.api.Tag;

@Target({ ElementType.TYPE, ElementType.METHOD })
@Retention(RetentionPolicy.RUNTIME)
@Tag("slow")
public @interface Slow {
} 
```

并将其用作：

```
@Test
@Slow
void slowProcessing(){ 
    ...
} 
```

要在文本执行期间启用或禁用标有特定标签的测试，您可以依赖[maven-surefire-plugin 文档](https://maven.apache.org/surefire/maven-surefire-plugin/examples/junit-platform.html) ：

> 要包含标签或标签表达式，请使用`groups`.
> 
> 要排除标签或标签表达式，请使用`excludedGroups`.

只需根据您的要求在您的 pom.xml 中配置插件（文档示例）：

```
 <build>
     <plugins>
         ...
         <plugin>
             <groupId>org.apache.maven.plugins</groupId>
             <artifactId>maven-surefire-plugin</artifactId>
             <version>2.22.0</version>
             <configuration>
                 <groups>acceptance | !feature-a</groups>
                 <excludedGroups>integration, regression</excludedGroups>
             </configuration>
         </plugin>
     </plugins> 
</build> 
```

有关信息，[测试目标文档](https://maven.apache.org/surefire/maven-surefire-plugin/test-mojo.html)未更新。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-24T02:23:57.150

试试[JUnit 测试组](https://github.com/ferstl/junit-testgroups)。从文档：

```
@TestGroup("integration")
public class MyIntegrationTest {
   @ClassRule
   public static TestGroupRule rule = new TestGroupRule();

   ...
} 
```

*   执行一个简单的测试组：-Dtestgroup=integration
*   执行多个测试组：-Dtestgroup=group1,group2
*   执行所有测试组：-Dtestgroup=all

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-03T14:25:05.977

您可以创建包含测试组的测试[套件对象。](http://junit.sourceforge.net/javadoc_40/org/junit/runners/Suite.html)或者，您的 IDE（如 Eclipse）可能支持运行给定包中包含的所有测试。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-14T05:24:04.180

您可以使用测试套件（[http://qaautomated.blogspot.in/2016/09/junit-test-suits-and-test-execution.html](http://qaautomated.blogspot.in/2016/09/junit-test-suits-and-test-execution.html)）或者您可以使用 Junit 类别（[http://qaautomated.blogspot.in/ 2016/09/junit-categories.html](http://qaautomated.blogspot.in/2016/09/junit-categories.html) ) 用于有效地对测试用例进行分组。

# c# - 将引用 C++/CLI 包装器到非托管 dll 的 UserControl 添加到表单时出现问题

> ID：817139
> 
> 赞同：2
> 
> 时间：2009-05-03T14:03:30.847
> 
> 标签：c#, .net, c++-cli, user-controls

我的 UserControl 将 C++/CLI 包装器引用到非托管 C++ dll。当我尝试将 UserControl 添加到表单时，出现 Visual Studio 错误，显示“无法创建组件 'userControl'”，原因是 System.IO.FileNotFoundException。

据我所知，问题源于 Visual Studio 没有复制 C++/CLI 包装程序集的非托管依赖项。如果我将非托管依赖项放在系统 PATH 上，一切正常。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T14:16:42.360

最简单的做法是将实际的 .dll 包含在您的项目中，将其构建操作标记为“内容”，然后将“复制到输出目录”设置为“始终”。这应该将 .dll 放到您的输出目录中，以便您的应用程序可以运行，并且仅将文件包含在项目中应该将其放在项目目录中，以便设计人员可以找到它。

确保您的设置项目也包含该项目的内容文件的项目输出。

**编辑**

如果这些不起作用，您还可以编辑项目本身的引用路径（在项目属性中），尽管我不确定这会影响设计器。如果不是这样，那么您唯一真正的选择是将 .dll 放在系统路径目录之一中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T16:29:05.720

旧线程，但提交我的解决方案，因为我刚刚遇到问题并在此过程中发现了这个问题。

基本上，我只是将本地 DLL 延迟加载到我的包装 C++/CLI 库中。由于包装器的 C++/CLI 部分包含 Visual Studio 和框架使用的接口规范，因此永远不需要或加载本机 DLL。我也在这个问题中回答了更多细节： [https ://stackoverflow.com/a/15481687/34440](https://stackoverflow.com/a/15481687/34440)

# windows-vista - 为什么要在 MS Vista 中的 ProgramData 文件夹上进行虚拟化？

> ID：817142
> 
> 赞同：7
> 
> 时间：2009-05-03T14:04:19.147
> 
> 标签：windows-vista, virtualization, uac

我修改了一个应用程序以考虑 VISTA 中的 UAC。所以，现在，.mdb（JET 或 Access 文件）位于`ProgramData\MyApp\`

我意识到，当我的应用程序第一次读取数据库时，它是从该位置执行的……但是当我的应用程序写入数据库时​​……文件被虚拟化并转到`Users\MyUser\AppData\Local\VirtualStore\ProgramData\MyApp`. 从这一刻起，我的应用程序总是转到磁盘中的虚拟化位置。

我的应用程序正在运行，但如果我继续这样，数据库将基于每个用户，我们确实需要与 PC 中的所有用户共享数据库。

我认为在 ProgramData 文件夹下写入不会触发虚拟化机制。

**我错过了什么？**

**我需要在 ProgramData 下设置 MyApp 文件夹的权限？？**

**我怎样才能在安装时做到这一点？**

谢谢人...

**更多信息：** 使用 VS 安装项目使用 VS2003 VB.NET 开发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T01:43:48.450

您很可能需要在安装期间为所有用户设置写入权限。

要进行测试，请删除虚拟化文件夹，手动设置 ProgramData\MyApp 文件夹和文件的权限，看看是否有效。

至于如何在安装过程中务实地做到这一点，这实际上取决于您使用的是什么技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T22:25:55.977

我在这里也遇到了麻烦，似乎vista曾经决定虚拟化文件，阻止它的唯一方法是删除虚拟文件。下次使用它时，它将使用 ProgramData 文件夹。

# javascript - 如何向元素添加悬停类？

> ID：817155
> 
> 赞同：1
> 
> 时间：2009-05-03T14:09:04.063
> 
> 标签：javascript, ajax, mootools

在我的 CSS 中，我有：

```
li.sort:hover {color: #F00;} 
```

当 DOM 准备好时，我在类下的所有`LI`元素`sort`都可以正常工作。

如果我创建一个**新** `LI`元素（使用 mootools `el.addClass(classname)`），我可以设置基类，但不知道如何向`hover`它添加一个类。

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T14:15:00.400

悬停伪类可以根据您指定的类名提前在样式表中定义。如：

```
li.classname:hover {color:#F000;} 
```

所以它的定义方式相同，通过样式表。您只需提前计划，知道您将在具有特定类的 JS 生成的 LI 标记上定义类名，并为其设置样式，尽管列表项在您使用 JavaScript 创建之前不存在。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T14:18:00.783

添加非悬停类时会自动添加悬停类。例如，如果你有

```
.MyClass
{
...
}

.MyClass:hover
{
...
} 
```

只需添加`MyClass`,即可`MyClass:hover`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T14:19:47.330

`:hover`不是一个类，而是一个伪选择器，它将选择鼠标当前悬停的任何元素。如果您创建一个`li`元素并向`sort`其添加类，那么每当您将鼠标移到该元素上时`li.sort:hover`，如果浏览器工作正常，则应该激活该规则。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T14:28:46.123

并非所有浏览器都会接受所有元素上的悬停伪类。您应该考虑使用 javascript 来实现此效果。例如，jQuery 使这变得非常容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T14:34:25.767

> 并非所有浏览器都会接受所有元素上的悬停伪类。您应该考虑使用 javascript 来实现此效果。例如，jQuery 使这变得非常容易。

更具体地说，IE6 仅在锚 (a) 元素上选择 :hover 样式。

# .net - 从数据库自动生成 Get 和 Set

> ID：817163
> 
> 赞同：1
> 
> 时间：2009-05-03T14:12:39.453
> 
> 标签：.net, vb.net, code-generation, data-access

我来自 VB6，我开始将现有的 VB6 代码转换为 VB.Net。我可以使用哪些工具来自动执行此任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T14:17:25.073

我可能会考虑使用 OR/M，如 nHibernate、LINQ to SQL、Entity Framework、Subsonic 等。它会给你更多，但它可能比自动生成 CRUD 操作更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T14:18:30.360

如果您正在为您的数据访问层和实体寻找一个完整的代码生成器，[LLBLGen](http://www.llblgen.com/defaultgeneric.aspx)是一个很好的工具。如果你只寻找一个简单生成实体类的工具，[Wilson OR Mapper](http://www.ormapper.net/)是我的最爱。

[CodeSmith](http://www.codesmithtools.com/)和[.net 层模板](http://nettiers.com/)也非常强大。

# language-agnostic - 通知非 Web 应用程序有关网页更改的最佳方式是什么？

> ID：817167
> 
> 赞同：4
> 
> 时间：2009-05-03T14:13:28.250
> 
> 标签：language-agnostic, ipc, notifications, inter-process-communicat

假设我有两个应用程序必须在一定程度上协同工作。

1.  一个 Web 应用程序（PHP、Ruby on Rails，...）
2.  桌面应用程序（Java、C++、...）

必须从 Web 应用程序通知桌面应用程序，并且发送和接收通知之间的延迟必须很短。（< 10 秒）

有什么可能的方法来做到这一点？我可以考虑以 10 秒的间隔进行轮询，但如果必须通知许多桌面应用程序，那将产生大量流量。在 LAN 上，我会使用 UDP 广播，但不幸的是，这在这里是不可能的......

我很感激你能给我的任何想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T15:02:01.317

我可以看到两种方式：

*   您的桌面应用程序轮询 Web 应用程序
*   您的 Web 应用程序通知桌面应用程序

您的 Web 应用程序可以发布 RSS 提要，但您的桌面应用程序仍需要每 10 秒轮询一次提要。

流量不需要很大：如果你使用 HTTP [HEAD](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4)请求，你会得到一个带有最后修改日期的小数据包（方便地命名为*Last-Modified*）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T20:19:14.267

我认为这里的“最佳实践”将取决于您希望服务的桌面客户端的数量。如果只有一个桌面需要通知，那么轮询可能是一种很好的方法——是的，轮询比基于事件的通知开销更大，但它肯定是最容易实现的解决方案。

如果轮询的开销确实不可接受，那么我看到了两个基本的选择：

1.  保持桌面和网络服务器之间的持久连接打开（可能是“彗星”风格的网络请求，或原始套接字连接）
2.  从桌面应用程序中公开服务，并将服务的地址注册到 Web 服务器。这样，网络服务器可以根据需要调用桌面。

不过请注意——这两种选择都充满了陷阱。几个亮点：

*   保持连接打开可能很棘手，因为您希望您的网络服务器可热插拔
*   从 Web 服务器调用外部服务（例如，您的桌面）是危险的，因为此请求可能会挂起。您希望将此通知移到单独的线程上，以避免占用网络服务器。

为了减轻一些担忧，您可以通过引入中间通知服务器来将不可靠的桌面与网络服务器分离——网络服务器可以在某处发布更新，桌面可以在那里轮询/连接/注册以得到通知。为了避免在这里重新发明轮子，这可能涉及某种 MessageQueue 系统……当然，这增加了需要维护新中介的复杂性。

同样，所有这些方法可能都相当复杂，所以我想说轮询可能是最好的选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T14:43:28.787

我不确切知道如何完成您的任务，但我可以建议在桌面应用程序 PC 上创建一个 Windows 服务。

此服务每隔一段时间检查 Web 应用程序是否有新更改，如果发生更改，它可以运行桌面应用程序并通知 Web 应用程序发生更改，并且当 Web 应用程序发生任何更改时，您可以通过确认进行响应

我希望这可能有用我没有完全尝试过，但我建议使用这样的想法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T08:57:07.417

一层联合将有助于扩展系统。

桌面应用程序可以向“发布者”服务注册自己（在多台/多台机器中的一台上运行）此发布者服务从您的 Web 应用程序接收“通知”，表明某些内容发生了变化，并立即开始通知其所有注册订阅者。

您需要的发布者数量会随着用户数量的增加而增加。

编辑：忘了提到桌面应用程序需要在套接字上侦听。

# ruby-on-rails - 我应该在 Rails 中创建博客还是使用已经存在的东西？

> ID：817170
> 
> 赞同：7
> 
> 时间：2009-05-03T14:15:31.910
> 
> 标签：ruby-on-rails, blogs

在我的下一个 Rails 项目中，我将需要博客功能。我想知道是否有人有任何好的建议，还是我应该自己提出？（可能不会在 15 分钟内）

我认为最重要的功能是优雅地显示代码示例。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T14:27:54.113

你的空闲时间怎么样？

> 五年，就是这个小小的想法花了多长时间。再加上 2 年的花里胡哨。伙计们，这就是我放弃并使用博客主机的原因。因为我有很多想法，很多话要说和探索，但最多只剩下几十年。我不能去追逐每一个浮现在脑海中的 5 年想法。在适当考虑了那里的垃圾网络框架和垃圾博客包之后，我决定我不想在接下来的 5 年里实现我对一个体面的自我发布系统的愿景。别人可以做到。

[http://steve-yegge.blogspot.com/2006/03/blog-or-get-off-pot.html](http://steve-yegge.blogspot.com/2006/03/blog-or-get-off-pot.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T16:08:03.857

这是一个经典的构建与购买（或者，在这种情况下，免费下载）的决定，不是吗？

*   写下您正在寻找的功能集。
*   调查那里的产品，看看你有多合适。
*   对于最适合的一两种产品，评估编写您自己的解决方案或定制产品是否能满足您的需求是否会更省力。
*   如果您只需要一个博客站点，那么这很容易。使用 WordPress 就是这样。
*   如果此应用程序还有其他功能并且博客只是其中之一，那么请考虑围绕 WordPress 编写应用程序。毕竟它只是一个使用 MySql 的 PHP 应用程序。
*   如果 WordPress 具有您不想要的功能或做的事情，那么也许您确实需要自己动手。
*   如果该站点最重要的功能是它是用 RoR 编写的，那么请自行开发或查找基于 RoR 的博客应用程序，因为 WordPress 不是用 RoR 编写的。我还没有真正完成这方面的功课，但我想让 PHP 和 RoR 共享会话状态将是一个耗时的 hack。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T14:29:09.507

滚动你自己的博客是一个很棒的项目（也很有趣！），但对于实际使用，使用预先制作的东西会更安全，有更酷的功能等等。除非你非常专注，否则你' 可能最终会偷工减料并最终得到一些不是你想要的东西。

尽管我自己是 Rails 人，但我是[Wordpress](http://wordpress.org/)的忠实粉丝。如果您正在寻找基于 Rails 的博客引擎，我对[Mephisto](http://mephistoblog.com/)很幸运，尽管文档还有一些不足之处。[Radiant CMS](http://radiantcms.org/)是另一个值得一看的 CMS/博客系统。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T23:39:38.670

许多 Ruby/Rails 开发人员实际上已经走上了使用静态网站/博客生成器的路线。这有几个优点。首先，页面是不依赖于数据库的静态 HTML。这意味着您的前端 Web 服务器（Apache、Nginx 等）可以比通过 Mongrel、Thin 或 Phusion Passenger 更快地为它们提供服务。其次，页面将更容易被搜索引擎索引。最后，可能也是最重要的一点，您可以使用 Git（或您最喜欢的 SCM）轻松地对帖子进行版本控制

[在Mephisto](http://mephistoblog.com/)上的开发似乎停滞后，我将我的博客切换到了静态模型。我正在使用 Tom Preston-Werner 的[Jekyll](http://github.com/mojombo/jekyll/tree/master)和[Disqus](http://disqus.com/)来发表评论。效果很好。试试看！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T00:09:58.050

如果您只是在寻找一个项目，那么构建自己的博客引擎是一个好的开始。

就个人而言，尽管过去 3 年我一直是一名全职 Rails 开发人员，但我仍然为自己和他人使用并推荐 Wordpress。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T14:35:07.620

如果项目是写博客，不要自己动手。当您担心抽出精彩内容时，有很多解决方案可以为您解决这个问题。

你最终会花很多时间在无关紧要的小事情上。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T14:36:15.310

可能有很多这样的。

例如，[Rastafari](http://www.restafari.org/)或[Enkiblog](http://www.enkiblog.com/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-03T14:43:50.377

> 在我的下一个 Rails 项目中，我将需要博客功能。我想知道是否有人有任何好的建议，还是我应该扮演自己的角色？（可能不会在 15 分钟内）

我不建议滚动您自己的博客系统。您应该考虑将 Radiant CMS 与博客扩展一起使用。

> 我认为最重要的功能是优雅地显示代码示例。

为此，我建议您查看[SyntaxHighlighter](http://alexgorbatchev.com/wiki/SyntaxHighlighter)。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-03T15:50:17.690

一切都取决于您的目标：

如果它是出于学习目的并且是为了好玩，请从头开始编写代码。此外，尝试添加在当前博客平台中找不到的新功能。例如，以一种便于开发人员发布博客教程或截屏视频的方式制作。

如果是为客户或只是写博客，请使用 wordpress。您可以在 ruby​​ 中创建您的网站，然后链接到 wordpress。想一想，wordpress 背后有多少人工时间，所以要匹配，你需要全职工作 8 年。

Wordpress 将开箱即用，然后您可以定期对其进行调整，具体取决于未来的需要。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-03T23:22:53.250

我同意，为了乐趣和学习，从头开始编写代码。但是考虑编写人们真正需要但还没有的东西。创新。

那里有很多优秀的博客平台，其中一些（如 Wordpress）拥有活跃的开发人员社区，编写了数百个有用且功能强大的插件。这包括对代码示例的一些出色支持。

无需重新发明轮子。

# c++ - 开机自检

> ID：817174
> 
> 赞同：2
> 
> 时间：2009-05-03T14:17:16.447
> 
> 标签：c++, c, operating-system, hardware, bios

任何了解 POST 以及如何设计和编写代码的好地方？我是一名 C++ 程序员，对这个词感到很困惑。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T14:33:32.507

您可能想查看[coreboot](http://www.coreboot.org/Welcome_to_coreboot)的代码，这是一个在许多不同类型的硬件上运行的免费软件（开源）BIOS 项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T14:29:33.827

您可以签出[OpenBIOS](http://www.openfirmware.info/Welcome_to_OpenBIOS)项目。

他们有关于大量开源 BIOS/固件实现的信息。作为开源，您可以从 svn 获取代码或在线阅读所有代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T08:24:42.963

BIOS？这在嵌入式世界中并不常见，人们仍然在这个地方写 POST。通常，它们发生在操作系统本身启动之前，或者在操作系统启动时发生。

目标是确定设备是否可以运行、在降级模式下运行，或者是否应该发出故障信号。一个典型的顺序是测试 CPU 和 XIP 闪存，然后是内存，固定硬件，然后是可选硬件。您定义了一系列测试。测试具有启动功能和检查功能。启动功能启动测试；检查轮询以查看结果是否已经可用。测试具有依赖关系，并且测试控制器启动那些依赖关系已通过的测试（CPU 和 RAM 是特殊情况，如果它们被破坏，那么拥有一个好的测试控制器是不可行的）。

正如您可以从 CPU 和 RAM 测试中推断的那样，您没有 C++ 的奢侈。你甚至不能假设你可以使用所有的 C。在 POST 的第一部分，你甚至可能没有堆栈（！）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-04T22:19:43.277

开源 EFI BIOS，带有文档和规范（学习的好方法）：

[https://www.tianocore.org/](https://www.tianocore.org/)

> 背景 2004 年 6 月，英特尔宣布将在当年晚些时候根据开源许可证发布其下一代固件技术的“基础代码”——PC BIOS 的继任者。由英特尔开发的作为名为 Tiano 的项目代码的一部分的基础代码是英特尔对可扩展固件接口 (EFI) 规范的“首选实施”。即将发布的代码包括基础代码的核心以及驱动开发工具包。为了实现将代码作为开源发布的意图，英特尔与提供工具和服务以支持开源计划的行业领导者 Collabnet 合作，为这项工作创建了一个社区。这种合作的结果就是这个开源网站。
> 
> 由于有更多基于 EFI 的项目与基础代码并行工作，因此决定向开源社区发布 EFI Shell 应用程序和 EFI 自我认证测试 (SCT) 项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T14:29:49.973

POST（开机自检）是 Bios 的一部分，编写 POST，而不是 BIOS 的其他部分，似乎确实是一项奇怪的任务。处理器制造商网站的文档部分将是 BIOS 编程的良好开端。我记得很久以前写过 80186 BIOS 和 POST，我专门使用英特尔规格。

顺便说一句，您将在汇编程序中执行此操作，而不是 C++。

# c# - C#：运行 shell 命令时出现问题

> ID：817176
> 
> 赞同：3
> 
> 时间：2009-05-03T14:17:26.307
> 
> 标签：c#, php, shell

我试图让 PHP 解析器运行一个页面，然后将结果返回到我的服务器，但是当我通过我的代码运行命令时，它什么也不返回。我知道该命令是正确的，因为如果我使用相同的路径手动运行它，它就可以正常工作。这是我的代码：

```
var p = new Process
{
      StartInfo = new ProcessStartInfo("C:\\xampp\\php\\php.exe", path)
      {
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            UseShellExecute = false,
            CreateNoWindow = true
      }
};
var output = new StringWriter();
var error = new StringWriter();
p.OutputDataReceived += (sender, args) => output.WriteLine(args.Data);
p.ErrorDataReceived += (sender, args) => error.WriteLine(args.Data);
p.Start();
p.BeginOutputReadLine();
p.BeginErrorReadLine();
p.WaitForExit();
if (p.ExitCode != 0)
{
      throw new Exception(string.Format(
          "PHP failed with the following output:{0}{1}",
      /* {0} */ Environment.NewLine,
      /* {1} */ error.GetStringBuilder().ToString()));
}
var res = output.GetStringBuilder().ToString();
Console.WriteLine(res); 
```

编辑：使用此当前代码，它会在没有输出的代码中引发异常。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T14:25:17.253

问题是您在程序完成之前正在读取输出。您需要等待程序退出来处理输出。否则，您将在解析完成之前处理输出。加入以下行。

```
p.Start();
p.WaitForExit();  // New line 
```

**EDIT** OP 说他们仍然有问题。

尝试删除命令的 CMD 部分。直接运行 PHP 命令即可。允许创建一个用于调试目的的窗口也可能是有益的，这样您就可以看到运行命令可能出现的任何错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-06T19:49:37.153

设置工作目录路径

```
var p = new Process
            {
                StartInfo = new ProcessStartInfo("php", path)
                {
                    RedirectStandardOutput = true,
                    RedirectStandardError = true,
                    UseShellExecute = false,
                    CreateNoWindow = true,
                    WorkingDirectory = workingDir
                }
            }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-04T09:39:58.477

调用流程并捕获其输出或错误的最可靠方法是尝试以下方式：

```
var p = new Process {
    StartInfo = new ProcessStartInfo("php", path) {
        RedirectStandardOutput = true,
        RedirectStandardError = true,
        UseShellExecute = false,
        CreateNoWindow = true
    }
};
var output = new StringWriter();
var error = new StringWriter();
p.OutputDataReceived += (sender, args) => output.WriteLine(args.Data);
p.ErrorDataReceived += (sender, args) => error.WriteLine(args.Data);
p.Start();
p.BeginOutputReadLine();
p.BeginErrorReadLine();
p.WaitForExit();
if (p.ExitCode != 0) {
    throw new Exception(string.Format(
        "PHP failed with the following output:{0}{1}",
        /* {0} */ Environment.NewLine,
        /* {1} */ error.GetStringBuilder().ToString()));
}
var res = output.GetStringBuilder().ToString();
Console.WriteLine(res); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T14:26:05.660

`ReadToEnd()`只是读取流的全部内容，就像它们在那个时间点一样。鉴于您在 之后立即调用它`Start()`，流可能是空的。你有几个选择

*   改为调用`ReadLine()`，但这只会读取一行
*   `p.WaitForExit()`然后调用`ReadToEnd()`，但我不确定这是否会保持流打开。如果是这样，那么这是您的最佳选择。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T14:26:34.863

您需要添加 p.WaitForExit(); 在 p.Start() 之后；否则，当您尝试读取它时，输出还没有准备好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T14:34:20.947

你通过cmd运行php有什么原因吗？不能直接执行吗？

根据我的经验，通过 .NET 执行进程是执行另一个进程的最糟糕的方式。unix 下的 fork() 好很多。我遇到了很多问题，我的建议是您**强烈**考虑查看[Process.BeginOutputReadLine()](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.beginoutputreadline.aspx)并在您的阅读中走异步路线。ReadToEnd 和 ReadToLine 可以无限期挂起，尤其是当您要捕获冗长的输出时。

我会粘贴一个示例，但它相当冗长。

# c# - LinqToSQL 和审计更改的字段

> ID：817180
> 
> 赞同：2
> 
> 时间：2009-05-03T14:18:16.367
> 
> 标签：c#, .net, linq, linq-to-sql, or-designer

这是 LinqToSQL 问题中的另一个问题，我确信我一定是错过了某个地方，因为 O/R 设计器的行为让我非常困惑……

我的 LinqToSQL 表有一个基类，我称之为`LinqedTable`. 我已经成功地使用反射来获取后代类的所有属性并执行其他标准操作。

现在我想对我的表进行一些自动审计，以便每当`LinqedTable`插入或删除记录或字段值更改时，我都会将记录插入到审计表中，详细说明更改类型、字段名称及其值保存前和保存后。

我想我可以使用`PropertyChanging`事件来做到这一点，在保存之前跟踪所有更改的属性，然后在每次`SubmitChanges()`调用后清除更改的集合。但是 - 出于某种奇怪的原因，从 O/R 设计器生成的代码没有在`PropertyChanging`事件中为您提供属性名称 - 它发送一个空字符串！（**为什么？！**）它**确实会**在事件中发送属性名称`PropertyChanged`，但这对我来说已经太迟了，无法获得原始值。

我想使用部分方法来获取所有属性的所有原始值`OnLoaded()`- 但根据定义这是私有的，我需要在基类中访问该方法。即使我使用反射来获取该方法，这也意味着我必须为我的每个表实现另一半部分方法，这有点违背了继承的目的！

我也无法在 DataContext 中找到任何合适的方法来使用或覆盖。

那么，您会建议什么来使此审核功能正常工作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T14:22:32.160

您可以在 DataContext 上使用 GetChangeSet 来检索在上下文中的所有表上发生的更新、插入和删除的列表。您可以使用 ITable.GetOriginalEntityState 来检索已更改实体的原始值。但是，当您检索已删除或更新记录的原始值时，关联将不可用，因此如果您需要处理相关实体，您将不得不仅依赖该区域中的外键值。您可以使用 ITable.GetModifiedMembers 帮助仅检索已更改的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T15:02:13.797

请原谅我的回答可能很愚蠢，但是如何直接在 SQL Server 中使用触发器（如果您使用的是 SQL Server 2005 或 2008 标准）或使用 SQL Server 2008 Enterprise 中的更改跟踪工具进行审计？

# powershell - 如何获取当前的 PowerShell 执行文件？

> ID：817198
> 
> 赞同：114
> 
> 时间：2009-05-03T14:27:09.933
> 
> 标签：powershell

注意：PowerShell 1.0
我想获取当前正在执行的 PowerShell 文件名。也就是说，如果我这样开始我的会话：

```
powershell.exe .\myfile.ps1 
```

我想得到字符串**“.\myfile.ps1”**（或类似的东西）。**编辑**：**“myfile.ps1”**更可取。
有任何想法吗？

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2017-04-26T19:50:58.147

我试图在这里总结各种答案，针对 PowerShell 5 进行了更新：

*   如果您只使用 PowerShell 3 或更高版本，请使用`$PSCommandPath`

*   如果想要与旧版本兼容，请插入垫片：

    `if ($PSCommandPath -eq $null) { function GetPSCommandPath() { return $MyInvocation.PSCommandPath; } $PSCommandPath = GetPSCommandPath; }`

    `$PSCommandPath`如果它尚不存在，则会添加。

    shim 代码可以在任何地方（顶级或函数内部）执行，尽管`$PSCommandPath`变量受制于正常的范围规则（例如，如果将 shim 放在函数中，则变量的范围仅限于该函数）。

# 细节

各种答案中使用了 4 种不同的方法，所以我编写了这个脚本来演示每种方法（加号`$PSCommandPath`）：

```
function PSCommandPath() { return $PSCommandPath; }
function ScriptName() { return $MyInvocation.ScriptName; }
function MyCommandName() { return $MyInvocation.MyCommand.Name; }
function MyCommandDefinition() {
    # Begin of MyCommandDefinition()
    # Note: ouput of this script shows the contents of this function, not the execution result
    return $MyInvocation.MyCommand.Definition;
    # End of MyCommandDefinition()
}
function MyInvocationPSCommandPath() { return $MyInvocation.PSCommandPath; }

Write-Host "";
Write-Host "PSVersion: $($PSVersionTable.PSVersion)";
Write-Host "";
Write-Host "`$PSCommandPath:";
Write-Host " *   Direct: $PSCommandPath";
Write-Host " * Function: $(PSCommandPath)";
Write-Host "";
Write-Host "`$MyInvocation.ScriptName:";
Write-Host " *   Direct: $($MyInvocation.ScriptName)";
Write-Host " * Function: $(ScriptName)";
Write-Host "";
Write-Host "`$MyInvocation.MyCommand.Name:";
Write-Host " *   Direct: $($MyInvocation.MyCommand.Name)";
Write-Host " * Function: $(MyCommandName)";
Write-Host "";
Write-Host "`$MyInvocation.MyCommand.Definition:";
Write-Host " *   Direct: $($MyInvocation.MyCommand.Definition)";
Write-Host " * Function: $(MyCommandDefinition)";
Write-Host "";
Write-Host "`$MyInvocation.PSCommandPath:";
Write-Host " *   Direct: $($MyInvocation.PSCommandPath)";
Write-Host " * Function: $(MyInvocationPSCommandPath)";
Write-Host ""; 
```

输出：

```
PS C:\> .\Test\test.ps1

PSVersion: 5.1.19035.1

$PSCommandPath:
 *   Direct: C:\Test\test.ps1
 * Function: C:\Test\test.ps1

$MyInvocation.ScriptName:
 *   Direct:
 * Function: C:\Test\test.ps1

$MyInvocation.MyCommand.Name:
 *   Direct: test.ps1
 * Function: MyCommandName

$MyInvocation.MyCommand.Definition:
 *   Direct: C:\Test\test.ps1
 * Function:
    # Begin of MyCommandDefinition()
    # Note this is the contents of the MyCommandDefinition() function, not the execution results
    return $MyInvocation.MyCommand.Definition;
    # End of MyCommandDefinition()

$MyInvocation.PSCommandPath:
 *   Direct:
 * Function: C:\Test\test.ps1 
```

## 笔记：

*   从 执行`C:\`，但实际脚本是`C:\Test\test.ps1`.
*   没有方法告诉你*传递*的调用路径 ( `.\Test\test.ps1`)
*   `$PSCommandPath`是唯一可靠的方法，但在 PowerShell 3 中引入
*   对于 3 之前的版本，没有一种方法在函数内部和外部都有效

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2014-10-16T11:04:21.010

虽然当前答案在大多数情况下是正确的，但在某些情况下它不会给您正确的答案。如果您在脚本函数中使用，则：

```
$MyInvocation.MyCommand.Name 
```

返回函数名而不是脚本名。

```
function test {
    $MyInvocation.MyCommand.Name
} 
```

无论您的脚本如何命名，都会给您“*测试”。*获取脚本名称的正确命令始终是

```
$MyInvocation.ScriptName 
```

这将返回您正在执行的脚本的完整路径。如果您只需要脚本文件名，那么此代码应该可以帮助您：

```
split-path $MyInvocation.PSCommandPath -Leaf 
```

* * *

## 回答 #3

> 赞同：74
> 
> 时间：2009-05-03T21:39:12.563

如果您只想要文件名（而不是完整路径），请使用：

```
$ScriptName = $MyInvocation.MyCommand.Name 
```

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2009-05-03T14:29:33.110

尝试以下

```
$path =  $MyInvocation.MyCommand.Definition 
```

这可能不会为您提供输入的实际路径，但会为您提供文件的有效路径。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-11-09T22:02:09.650

如果您正在寻找正在执行脚本的当前目录，您可以试试这个：

```
$fullPathIncFileName = $MyInvocation.MyCommand.Definition
$currentScriptName = $MyInvocation.MyCommand.Name
$currentExecutingPath = $fullPathIncFileName.Replace($currentScriptName, "")

Write-Host $currentExecutingPath 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-11-27T01:30:04.973

注意：与`$PSScriptRoot`和`$PSCommandPath`自动变量不同，自动变量的 `PSScriptRoot`和`PSCommandPath`属性`$MyInvocation`包含有关调用者或调用脚本的信息，而不是当前脚本。

例如

```
PS C:\Users\S_ms\OneDrive\Documents> C:\Users\SP_ms\OneDrive\Documents\DPM ...
=!C:\Users\S_ms\OneDrive\Documents\DPM.ps1 
```

...其中`DPM.ps1`包含

```
Write-Host ("="+($MyInvocation.PSCommandPath)+"!"+$PSCommandPath) 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2017-10-28T06:04:08.587

如之前的回复中所述，使用“$MyInvocation”会受到范围问题的影响，并且不一定提供一致的数据（返回值与直接访问值）。我发现无论范围如何（在主函数或后续/嵌套函数调用中），获取脚本信息（如脚本路径、名称、参数、命令行等）的“最干净”（最一致）的方法是使用“Get- “MyInvocation”上的“变量”...

```
# Get the MyInvocation variable at script level
# Can be done anywhere within a script
$ScriptInvocation = (Get-Variable MyInvocation -Scope Script).Value

# Get the full path to the script
$ScriptPath = $ScriptInvocation.MyCommand.Path

# Get the directory of the script
$ScriptDirectory = Split-Path $ScriptPath

# Get the script name
# Yes, could get via Split-Path, but this is "simpler" since this is the default return value
$ScriptName = $ScriptInvocation.MyCommand.Name

# Get the invocation path (relative to $PWD)
# @GregMac, this addresses your second point
$InvocationPath = ScriptInvocation.InvocationName 
```

因此，您可以获得与 $PSCommandPath 相同的信息，但在交易中可以获得更多信息。不确定，但看起来“Get-Variable”直到 PS3 才可用，因此对于真正旧（未更新）的系统没有太多帮助。

使用“-Scope”时还有一些有趣的方面，因为您可以回溯以获取调用函数的名称等。0=当前，1=父级，等等。

希望这有点帮助。

参考，[https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-variable](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-variable)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-09-24T21:44:30.743

我认为有更好的方法，通过设置变量 $MyInvocation.MyCommand.Path 的范围：

ex> $**脚本**：MyInvocation.MyCommand.Name

此方法适用于所有调用情况：

例如：Somescript.ps1

```
function printme () {
    "In function:"
    ( "MyInvocation.ScriptName: " + [string]($MyInvocation.ScriptName) )
    ( "script:MyInvocation.MyCommand.Name: " + [string]($script:MyInvocation.MyCommand.Name) )
    ( "MyInvocation.MyCommand.Name: " + [string]($MyInvocation.MyCommand.Name) )
}
"Main:"
( "MyInvocation.ScriptName: " + [string]($MyInvocation.ScriptName) )
( "script:MyInvocation.MyCommand.Name: " + [string]($script:MyInvocation.MyCommand.Name) )
( "MyInvocation.MyCommand.Name: " + [string]($MyInvocation.MyCommand.Name) )
" "
printme
exit 
```

输出：

```
PS> powershell C:\temp\test.ps1
Main:
MyInvocation.ScriptName:
script:MyInvocation.MyCommand.Name: test.ps1
MyInvocation.MyCommand.Name: test.ps1

In function:
MyInvocation.ScriptName: C:\temp\test.ps1
script:MyInvocation.MyCommand.Name: test.ps1
MyInvocation.MyCommand.Name: printme 
```

请注意，当从 Main 调用时，上述接受的答案如何不返回值。另外，请注意，当问题仅请求脚本名称时，上述接受的答案会返回完整路径。作用域变量适用于所有地方。

此外，如果您确实想要完整路径，那么您只需调用：

```
$script:MyInvocation.MyCommand.Path 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2021-01-22T13:56:23.917

@gregmac 的（优秀而详细的）答案的简短演示，它基本上建议`$PSCommandPath`作为唯一可靠的命令来返回使用 Powershell 3.0 及更高版本的当前正在运行的脚本。

在这里，我显示返回完整路径或仅返回文件名。

测试.ps1：

```
'Direct:'
$PSCommandPath  # Full Path 
Split-Path -Path $PSCommandPath -Leaf  # File Name only

function main () {
  ''
  'Within a function:'
  $PSCommandPath
  Split-Path -Path $PSCommandPath -Leaf
}

main 
```

输出：

```
PS> .\Test.ps1
Direct:
C:\Users\John\Documents\Sda\Code\Windows\PowerShell\Apps\xBankStatementRename\Test.ps1
Test.ps1

Within a function:
C:\Users\John\Documents\Sda\Code\Windows\PowerShell\Apps\xBankStatementRename\Test.ps1
Test.ps1 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-02-20T21:50:06.193

在 PS 2 和 PS 4 上使用以下脚本进行了一些测试，结果相同。我希望这对人们有所帮助。

```
$PSVersionTable.PSVersion
function PSscript {
  $PSscript = Get-Item $MyInvocation.ScriptName
  Return $PSscript
}
""
$PSscript = PSscript
$PSscript.FullName
$PSscript.Name
$PSscript.BaseName
$PSscript.Extension
$PSscript.DirectoryName

""
$PSscript = Get-Item $MyInvocation.InvocationName
$PSscript.FullName
$PSscript.Name
$PSscript.BaseName
$PSscript.Extension
$PSscript.DirectoryName 
```

结果 -

```
Major  Minor  Build  Revision
-----  -----  -----  --------
4      0      -1     -1      

C:\PSscripts\Untitled1.ps1
Untitled1.ps1
Untitled1
.ps1
C:\PSscripts

C:\PSscripts\Untitled1.ps1
Untitled1.ps1
Untitled1
.ps1
C:\PSscripts 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-17T23:11:01.840

这适用于大多数 powershell 版本：

```
(& { $MyInvocation.ScriptName; }) 
```

这适用于计划作业

```
Get-ScheduledJob |? Name -Match 'JOBNAMETAG' |% Command 
```

# macos - 如何在 mac osx 上使用 yafaray 进行渲染

> ID：817207
> 
> 赞同：1
> 
> 时间：2009-05-03T14:29:59.707
> 
> 标签：macos, 3d, terminal, rendering

我已经在 mac osx 上安装了wings 3d，我很喜欢它。问题是我不能做任何花哨的渲染。我已经下载并安装了[YafaRay-0.1.0.305-OSXintel10.5](http://www.yafaray.org/download/yafaray)，但我似乎无法让它工作。

wings3d 手册指出，在 mac os 上，您从wings 3d 导出xml 文件，但是您从终端进行渲染，并使用生成的xml 的路径作为参数调用yafaray。

我希望使用 locate 找到 yafray 或 yafaray，但我找不到。我在 /usr/local/bin 中找到了 yafaray-xml

只是为了测试，我在一个名为 box.xml 的文件中导出了一个多维数据集

最初我收到了大量与场景标签相关的错误：

```
warning: expected </scene> tag!
Bus error 
```

然后我从xml中删除标签并再次尝试，我得到了

```
?m?setting up scene...specify a camera!! 
```

任何人都知道如何在 macosx 上从终端使用 yafaray 进行渲染？或者如何在 mac osx 上为wings 3d 设置光线追踪器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T08:42:36.680

现在开始工作了！

yafaray 是 yafray 的重写版本，xml 结构不同，所以wings3d 输出了错误的xml。

[我找到了一个在这里](http://tutorials.manojky.net/yafaray/YafrayXMLProgramming.pdf)工作的 xml 结构。我刚刚将网格节点调整为我自己的一个网格，并从终端获得了渲染。

此外，如果有人对[这里](http://www.yafaray.org/development/documentation)的官方规格感兴趣，他们也是。方便的用户指南可以在[这里](http://www.yafaray.org/documentation/userguide)找到。

我尝试使用搅拌机，当我从渲染菜单中选择 yafaray xml 脚本时，搅拌机 248.1 不断崩溃。另一方面，blender 245.15 首先崩溃了几次，但现在我可以渲染而不会崩溃。唯一的小故障是每次渲染后 ui freezez，所以我需要 CMD+Tab 到另一个应用程序并返回来解决这个问题。

希望这可以帮助其他有类似问题的人。

# java - 扩展 JPA 实体映射

> ID：817210
> 
> 赞同：0
> 
> 时间：2009-05-03T14:31:04.760
> 
> 标签：java, hibernate, jpa, jakarta-ee, ejb-3.0

我正在寻找一种简单的方法来扩展现有的 JPA 映射。思路如下：

我有一个带有 EJB3+JPA 模块的 EAR 项目，它有 ClassA 注释并映射到表 class_a。但我希望其他一些模块（另一个 EJB 模块）具有 ClassB，它为 ClassA 添加更多属性（扩展？）。

我想到的一种方法是将这些附加字段添加到 class_a 表并运行非 HQL 查询来检索该数据。这不好，因为我必须手动做很多事情：类型映射，列映射等。

我做了简单的检查，但似乎我无法在第二个模块中扩展 ClassA（通过 ClassB），因为它们使用不同的 EntityManagerFactories 并且第二个模块看不到第一个模块中的某些类，反之亦然。

我已经在persistence.xml 中看到了<jar-file> 标记。我需要类似的东西，但是使用它需要在第一个模块中列出该文件并且它必须存在（如果找不到它不会跳过）。有没有类似的东西可以放在扩展模块（第二个）而不是可扩展模块（第一个）上？

如果有一种方法可以在运行时扩展 JPA 映射，那就太好了。有没有这样的方法？我的问题还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T07:13:37.290

实现的解决方案如下。我有一个 jar 和两个 EJB 模块：

1.  罐子是基础罐子。它包含扩展的基本实体和本地接口：

    ```
    @Entity
    public class BaseEntity {
        public long id;
        @Id @GeneratedValue
        public long getId() {...
        ... other variables, getters, setters ...
    }

    @Local
    public interface EntitiyManagerWithExtendedEntitiesInterface {
        public EntityManager getEntityManager;
    } 
    ```

2.  第一个 EJB 模块将扩展基本实体并添加 EJB 以获得它的实体管理器。该模块还包括`persistence.xml`与`<jar-file>../path_to_first_jar_file.jar</jar-file>`线。

    ```
    @Entity
    ... discriminator annotations
    public class ExtEntity extends BaseEntity {
        ... additional fields here
    }

    @Stateless
    public class EntitiyManagerWithExtendedEntitiesBean implements EntitiyManagerWithExtendedEntitiesInterface {
        @PersitenceContext
        EntityManager em;
        public EntityManager getEntityManager() {
            return em;
        }
    } 
    ```

3.  第二个 EJB 模块将具有只需要 jar 编译但需要第一个 EJB 运行的 EJB（需要一个将实现`EntitiyManagerWithExtendedEntitiesInterface`接口的 EJB）。

    ```
    @Stateless
    public class getSomeEntity {
        @EJB
        EntitiyManagerWithExtendedEntitiesInterface ext;
        EntityManager em;
        @PostConstruct
        public void injectEntityManager() {
            em = ext.getEntityManager();
        }
        public void ejbInterfaceMethod() {
            ... method that uses em variable (EntityManager)
        }
    } 
    ```

这样，应用程序服务器将不得不管理模块之间的依赖关系，并且我可以轻松地交换第一个 EJB 模块以包含另一组扩展实体。

# flash - Flash：手动做所有事情有什么好的理由吗？

> ID：817211
> 
> 赞同：1
> 
> 时间：2009-05-03T14:32:01.373
> 
> 标签：flash

前几天我收到了一份 Flash 作业，但没有一个是通过编程完成的。所有的过渡、翻转等，都是通过内置的按钮状态、图层和所有我几乎不使用的东西完成的，除了通过代码（因为你可以通过编写自定义 MC 来完成这一切）。所有补间实际上似乎都是手工完成的（右键单击“制作补间”或其他）。最有问题的是，一个六项高的菜单实际上是通过在几个地方做 6 层来制作的，所以改变它涉及到所有这些地方并改变。

我不需要该应用程序的帮助，因为它需要简单的模组（基本上都可以工作 ×20）。但是，我的问题是：开发人员是否有可能使用某些工具来实际制作所有这些菜单等等？还是他真的逐个像素地制作它们，而不是以编程方式进行（一次编写，永远重复使用）？

他/她这样做的方式对我来说似乎很愚蠢，但我在这里要求确保我不是错过这条船的人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T14:46:40.277

作者可能是一名设计师……阅读有关 Flash 的文档与学习编程相比更容易……有时，对于某些人来说，蛮力比花一点时间来获得可重用和可定制的东西更容易……

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T15:31:45.253

你没有错过船:)

Flash 是一个很棒的工具，但它继承了其悠久历史的怪癖。一开始它主要是一个设计工具，后来代码方面起飞了。直到今天，flash 既是一个编码平台，也是一个设计工具。这可能是一件好事/有创意的事情，但也可能导致构建非常混乱的项目。

# java - Java 上的 DirectX 可能吗？

> ID：817216
> 
> 赞同：13
> 
> 时间：2009-05-03T14:33:46.593
> 
> 标签：java, com, video, directx

有没有一种在 Java 中使用 DirectX 的简单方法？特别是 DirectX 的视频 API。

我知道 C# 可能是一个更自然的选择，但我想要做一些如此反常的事情有我不正当的理由。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-08T14:51:35.330

我不知道容易，但你总是可以使用 JNI 来加载 DirectX 库并调用方法。

使用[Swig](http://www.swig.org/)之类的东西，您可以自动生成大量代码。

不过，不确定这样的事情有多可行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T14:37:51.983

似乎有一个关于在 Java 中处理 3D的[标准 API 。](https://java3d.dev.java.net/)

它可能使用某种加速技术，甚至可能是 DirectX。

但我不确定这个框架中的直接视频支持。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-06-14T16:48:01.853

我使用包装 DirectX 类的 BridJ ( [https://bridj.googlecode.com ) 创建了一个库，因此您可以使用与 C++ 示例几乎相同的代码。](https://bridj.googlecode.com)

[您可以在https://bitbucket.org/fourthskyinteractive/directx-for-java](https://bitbucket.org/fourthskyinteractive/directx-for-java)中找到该库。

请让我知道您开发的项目。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T14:48:53.203

[在http://java-direct3d.sourceforge.net/](http://java-direct3d.sourceforge.net/)上有一组用于 Java 的 Direct3D 绑定，但似乎在 2006 年 DirectX 9 停止了开发。

否则，有用于 java 的 OpenGL 绑定，称为[JOGL](https://jogl.dev.java.net/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-08T16:04:28.027

您要研究的包是 Java Media Framework (JMF)。它的核心是纯 Java，每个平台的“性能包”通过本机库提供加速。[它目前支持多种](http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/formats.html)数据类型的 A/V 捕获和播放，以及通过 RTP 和 RTSP 进行的流式传输。

Sun 的[JMF 主页](http://java.sun.com/javase/technologies/desktop/media/jmf/index.jsp)

JMF[软件/硬件要求](http://java.sun.com/javase/technologies/desktop/media/jmf/2.1.1/requirements.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-01-18T16:36:56.663

Minecraft 是使用 LWJGL 用 Ja​​va 编写的，但 Messiah Andrew 的 Renderer Wrapper 使用 LWJGL 库的修改版本将 OpenGL 转换为 DirectX。使用这些库，您应该能够在 LWJGL 中编写代码并让游戏运行 DirectX。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-07-12T14:09:29.473

似乎大多数人都忘记了 JavaFX 和 Java3D 支持 DirectX 和 OpenGL，使用您所在机器的最佳上下文......实际上，如果您在 Windows 上，它会尝试加载 DirectX，如果它比您的 OpenGL 版本更新。

我没有告诉任何人使用 Java3D 或 JavaFX，但如果您查看源代码，您会看到它是如何完成的。

[GrepCode](http://grepcode.com/) “非常适合查找事物是如何实现的”

[打开 JavaFX](http://openjdk.java.net/projects/openjfx/) “打开 JavaFX 项目主页”[源](http://hg.openjdk.java.net/openjfx/9-dev/rt/file/a1cfa82b3dfa)

> 我应该注意到你想看一下`com.sun.prism`包裹。

[Java3D](https://java3d.java.net/) “Java3D 项目主页”[源](https://java.net/projects/java3d/sources)

20 年来，我一直在**学习**发展，**哈哈。**专业上大约 8 种可能从来都不是问题，但要花多长时间，和/或值得……这些都是问题。

祝你好运，我的朋友！

> 如果您需要任何帮助，我将有兴趣为 java 创建一个 DirectX 包装器，所以
> 
> **给我一声呐喊！**

# javascript - 如何将整个文档 HTML 作为字符串获取？

> ID：817218
> 
> 赞同：287
> 
> 时间：2009-05-03T14:34:05.923
> 
> 标签：javascript, html, document, tostring

JS中有没有办法在*html*标签中获取整个HTML，作为一个字符串？

```
document.documentElement.?? 
```

* * *

## 回答 #1

> 赞同：375
> 
> 时间：2009-05-03T14:37:53.433

MS前段时间添加了`outerHTML`and属性。`innerHTML`

据[MDN](https://developer.mozilla.org/en-US/docs/DOM/element.outerHTML)称，`outerHTML`Firefox 11、Chrome 0.2、Internet Explorer 4.0、Opera 7、Safari 1.3、Android、Firefox Mobile 11、IE Mobile、Opera Mobile 和 Safari Mobile 都支持。`outerHTML`在[DOM 解析和序列化](http://domparsing.spec.whatwg.org/#outerhtml)规范中。

有关适合您的浏览器兼容性，请参阅[quirksmode 。](http://quirksmode.org/dom/w3c_html.html)都支持`innerHTML`。

```
var markup = document.documentElement.innerHTML;
alert(markup); 
```

* * *

## 回答 #2

> 赞同：109
> 
> 时间：2016-03-10T13:01:38.660

你可以做

```
new XMLSerializer().serializeToString(document) 
```

在比 IE 9 更新的浏览器中

请参阅[https://caniuse.com/#feat=xml-serializer](https://caniuse.com/#feat=xml-serializer)

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-05-03T14:36:20.207

我相信`document.documentElement.outerHTML`应该还给你。

据[MDN](https://developer.mozilla.org/en-US/docs/DOM/element.outerHTML)称，`outerHTML`Firefox 11、Chrome 0.2、Internet Explorer 4.0、Opera 7、Safari 1.3、Android、Firefox Mobile 11、IE Mobile、Opera Mobile 和 Safari Mobile 都支持。`outerHTML`在[DOM 解析和序列化](http://domparsing.spec.whatwg.org/#outerhtml)规范中。

该[`outerHTML`属性](http://msdn.microsoft.com/en-us/library/ms534310(VS.85).aspx)上的 MSDN 页面指出它在 IE 5+ 中受支持。Colin 的回答链接到 W3C quirksmode 页面，该页面提供了一个很好的跨浏览器兼容性比较（也适用于其他 DOM 功能）。

* * *

## 回答 #4

> 赞同：48
> 
> 时间：2014-11-13T09:58:30.300

我尝试了各种答案以查看返回的内容。我正在使用最新版本的 Chrome。

建议`document.documentElement.innerHTML;`返回`<head> ... </body>`

盖比的建议`document.getElementsByTagName('html')[0].innerHTML;`得到了同样的回报。

`document.documentElement.outerHTML;`返回的建议`<html><head> ... </body></html>` 是除“doctype”之外的所有内容。

您可以使用返回一个对象而不是字符串来检索 doctype 对象`document.doctype;` ，因此如果您需要将详细信息提取为所有 doctype 的字符串（包括 HTML5 在内），请参见此处：[Get DocType of an HTML as string with Javascript](https://stackoverflow.com/questions/6088972/get-doctype-of-an-html-as-string-with-javascript)

我只想要 HTML5，所以以下内容足以让我创建整个文档：

`alert('<!DOCTYPE HTML>' + '\n' + document.documentElement.outerHTML);`

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-06-16T14:04:01.697

你也可以这样做：

```
document.getElementsByTagName('html')[0].innerHTML 
```

你不会得到 Doctype 或 html 标签，但其他一切......

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-03T14:36:27.023

```
document.documentElement.outerHTML 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-03-13T03:55:53.840

可能只有 IE：

```
>     webBrowser1.DocumentText 
```

对于 FF 从 1.0 开始：

```
//serialize current DOM-Tree incl. changes/edits to ss-variable
var ns = new XMLSerializer();
var ss= ns.serializeToString(document);
alert(ss.substr(0,300)); 
```

可以在FF工作。（显示源文本最开头的 VERY FIRST 300 个字符，主要是 doctype-defs。）

但请注意，FF 的正常“另存为”对话框可能不会保存页面的当前状态，而是最初加载的 X/h/tml-source-text ！（将 ss 发布到某个临时文件并重定向到该文件可能会提供可保存的源文本，其中包含之前对其进行的更改/编辑。）

尽管 FF 对“返回”的良好恢复以及在“保存（作为）...”**中包含类似输入的**字段、文本区域等的状态/值的 NICE 的包含感到惊讶，而不是在 contenteditable/designMode 中的元素...

如果不是 xhtml-resp。xml 文件（mime 类型，不仅仅是文件扩展名！），可以使用 document.open/write/close 来设置 appr。内容到源层，将从FF的文件/保存菜单保存在用户的保存对话框中。请参阅： [http](http://www.w3.org/MarkUp/2004/xhtml-faq#docwrite) ://www.w3.org/MarkUp/2004/xhtml-faq#docwrite resp。

[https://developer.mozilla.org/en-US/docs/Web/API/document.write](https://developer.mozilla.org/en-US/docs/Web/API/document.write)

对 X(ht)ML 的问题中立，尝试使用“view-source:http://...”作为（脚本制作的！？） iframe 的 src-attrib 的值，-访问 iframe- FF中的文件：

`<iframe-elementnode>.contentDocument`，请参阅谷歌“mdn contentDocument”以获取 appr。成员，例如“textContent”。'几年前就有了，不喜欢爬。如果仍然有迫切需要，请提及这一点，我必须潜入...

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-03T14:37:47.897

```
document.documentElement.innerHTML 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-07-13T09:28:13.030

`<html>...</html>`要在最重要的声明之外获取内容`<!DOCTYPE ...>`，您可以遍历 document.childNodes，将每个节点转换为字符串：

```
const html = [...document.childNodes]
    .map(node => nodeToString(node))
    .join('\n') // could use '' instead, but whitespace should not matter.

function nodeToString(node) {
    switch (node.nodeType) {
        case node.ELEMENT_NODE:
            return node.outerHTML
        case node.TEXT_NODE:
            // Text nodes should probably never be encountered, but handling them anyway.
            return node.textContent
        case node.COMMENT_NODE:
            return `<!--${node.textContent}-->`
        case node.DOCUMENT_TYPE_NODE:
            return doctypeToString(node)
        default:
            throw new TypeError(`Unexpected node type: ${node.nodeType}`)
    }
} 
```

我在 npm 上将此代码发布为[document-outerhtml](https://www.npmjs.com/package/document-outerhtml)。

* * *

*编辑*注意上面的代码依赖于一个函数`doctypeToString`；它的实现可能如下（下面的代码在 npm 上发布为[doctype-to-string](https://www.npmjs.com/package/doctype-to-string)）：

```
function doctypeToString(doctype) {
    if (doctype === null) {
        return ''
    }
    // Checking with instanceof DocumentType might be neater, but how to get a
    // reference to DocumentType without assuming it to be available globally?
    // To play nice with custom DOM implementations, we resort to duck-typing.
    if (!doctype
        || doctype.nodeType !== doctype.DOCUMENT_TYPE_NODE
        || typeof doctype.name !== 'string'
        || typeof doctype.publicId !== 'string'
        || typeof doctype.systemId !== 'string'
    ) {
        throw new TypeError('Expected a DocumentType')
    }
    const doctypeString = `<!DOCTYPE ${doctype.name}`
        + (doctype.publicId ? ` PUBLIC "${doctype.publicId}"` : '')
        + (doctype.systemId
            ? (doctype.publicId ? `` : ` SYSTEM`) + ` "${doctype.systemId}"`
            : ``)
        + `>`
    return doctypeString
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-03-31T23:43:19.193

我总是用

```
document.getElementsByTagName('html')[0].innerHTML 
```

可能不是正确的方法，但当我看到它时我能理解它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-05-06T07:10:30.283

使用`document.documentElement`.

同样的问题在这里回答： [https ://stackoverflow.com/a/7289396/2164160](https://stackoverflow.com/a/7289396/2164160)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-01-09T11:06:43.967

我只需要 doctype html 并且应该可以在 IE11、Edge 和 Chrome 中正常工作。我使用下面的代码它工作正常。

```
function downloadPage(element, event) {
    var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);

    if ((navigator.userAgent.indexOf("MSIE") != -1) || (!!document.documentMode == true)) {
        document.execCommand('SaveAs', '1', 'page.html');
        event.preventDefault();
    } else {
        if(isChrome) {
            element.setAttribute('href','data:text/html;charset=UTF-8,'+encodeURIComponent('<!doctype html>' + document.documentElement.outerHTML));
        }
        element.setAttribute('download', 'page.html');
    }
} 
```

并在您的锚标记中像这样使用。

```
<a href="#" onclick="downloadPage(this,event);" download>Download entire page.</a> 
```

**例子**

```
 function downloadPage(element, event) {
    	var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);

    	if ((navigator.userAgent.indexOf("MSIE") != -1) || (!!document.documentMode == true)) {
    		document.execCommand('SaveAs', '1', 'page.html');
    		event.preventDefault();
    	} else {
    		if(isChrome) {
                element.setAttribute('href','data:text/html;charset=UTF-8,'+encodeURIComponent('<!doctype html>' + document.documentElement.outerHTML));
    		}
    		element.setAttribute('download', 'page.html');
    	}
    }
```

```
I just need doctype html and should work fine in IE11, Edge and Chrome. 

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

<p>
<a href="#" onclick="downloadPage(this,event);"  download><h2>Download entire page.</h2></a></p>

<p>Some image here</p>

<p><img src="https://placeimg.com/250/150/animals"/></p>
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-06-09T12:24:15.183

我正在使用`outerHTML`元素（主`<html>`容器），以及`XMLSerializer`其他任何东西，包括容器`<!DOCTYPE>`外的随机注释`<html>`或任何其他可能存在的东西。似乎没有在`<html>`元素之外保留空格，所以我默认使用`sep="\n"`.

```
function get_document_html(sep="\n") {
    let html = "";
    let xml = new XMLSerializer();
    for (let n of document.childNodes) {
        if (n.nodeType == Node.ELEMENT_NODE)
            html += n.outerHTML + sep;
        else
            html += xml.serializeToString(n) + sep;
    }
    return html;
}

console.log(get_document_html().slice(0, 200));
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-05-26T11:18:22.257

如果您想获取 DOCTYPE 之外的所有内容，这将起作用：

```
document.getElementsByTagName('html')[0].outerHTML; 
```

或者如果你也想要 doctype 的话：

```
new XMLSerializer().serializeToString(document.doctype) + document.getElementsByTagName('html')[0].outerHTML; 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2019-02-05T21:58:46.903

您必须遍历文档 childNodes 并获取 outerHTML 内容。

在 VBA 中它看起来像这样

```
For Each e In document.ChildNodes
    Put ff, , e.outerHTML & vbCrLf
Next e 
```

使用它，允许您获取网页的所有元素，包括 < !DOCTYPE > 节点（如果存在）

* * *

## 回答 #16

> 赞同：-9
> 
> 时间：2010-10-29T15:05:31.660

正确的做法其实是：

webBrowser1.DocumentText

# language-agnostic - 你希望用你最喜欢的编程语言自动实现什么？

> ID：817232
> 
> 赞同：6
> 
> 时间：2009-05-03T14:40:33.630
> 
> 标签：language-agnostic, programming-languages, language-features, theory

作为一名程序员，我经常查看我当前使用的语言的一些特性，并自言自语“这对程序员来说很难做到，并且可以由机器自动处理”。

这种特性的一个例子是内存管理，它在各种语言中已经自动化了一段时间。虽然在大多数情况下手动进行内存管理并不难，但是在不泄漏内存的情况下在整个应用程序中完美地进行管理是非常困难的。自动化再次使它变得容易，因此我们程序员可以专注于更关键的问题。

您认为编程语言是否应该自动化任何功能，因为奖励/难度比率太低（例如并发）？

这个问题旨在就编程的未来会是什么样子进行头脑风暴，以及语言可以为我们做些什么让我们专注于更重要的任务，所以即使你认为自动化不实用，也请发表你的愿望/可行的。好的答案将指出在许多语言中真正难以做到的事情，而不是单一语言的烦恼。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-03T14:49:08.447

无论语言可以自动为我做什么，我都会想要一种为自己做的方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-03T15:08:27.820

[（半）自动化的并发编程](http://en.wikipedia.org/wiki/Concurrent_programming)/[并行性](http://en.wikipedia.org/wiki/Parallelism_(computing))，而不是必须搞乱线程、回调和同步。能够并行化 for 循环，例如：

```
Parallel.ForEach(fooList, item =>
{
    item.PerformLongTask();
} 
```

只是赢了。

然而，某些语言已经在一定程度上支持这种功能。值得注意的是，F# 具有异步工作流。随着 .NET 4.0 的发布，[并行](http://blogs.msdn.com/pfxteam/archive/2008/06/02/8567802.aspx) [扩展](http://en.wikipedia.org/wiki/Task_Parallel_Library)库将使 C# 和 VB.NET 中的并发性*变得*更加容易。我相信 Python 也有某种并发库，虽然我个人没有使用过它。

[*还很酷的是纯函数*](http://en.wikipedia.org/wiki/Purely_functional)式语言中的全自动并行性，即无需稍微更改代码并自动使其在多个内核上以接近最佳的方式运行。请注意，这只能使用*纯*函数式语言（例如 Haskell，但不能使用 CAML/F#）来完成。尽管如此，像上面给出的例子这样的结构对于自动化面向对象和其他语言的并行性来说是非常方便的。

我可以想象，随着台式计算机开始从 2 核到 4 核再到 8 核，面向简单和高级并行支持的库、设计模式甚至整个编程语言将变得越来越普遍。自动化并发的优势变得更加明显。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-03T14:49:46.510

```
exec("Build a system to keep the customer happy, based on requirements.txt"); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-03T14:53:10.947

在 Java 中，我想要一个使整个类不可变的关键字。

例如

```
public immutable class Xyz {
} 
```

如果任何不变性条件被破坏，编译器会警告我。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-03T16:28:18.580

在 Java 中，创建 bean 时不那么冗长。

例如：

```
bean Student
{
    String name;
    int id;
    type1 property1;
    type2 property2;
} 
```

这将创建一个 bean 私有字段、默认访问器、toString、hashCode、equals 等。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-03T15:12:10.963

并发。这是我问这个问题时的主要想法。随着时间的推移，这将变得越来越重要，因为当前的 CPU 已经拥有多达 8 个逻辑核心（4 个核心 + 超线程），而 12 个逻辑核心将在几个月内出现。将来，我们将拥有大量的内核供我们使用，但大多数编程语言只让我们一次使用一个内核变得容易。

大多数编程语言所公开的线程+同步模型是非常底层的，并且非常接近于 CPU 所做的。对我来说，当前的并发语言支持水平大致相当于 C 中的内存管理支持：没有集成，但有些事情可以委托给操作系统（malloc，free）。

我希望某种语言能提出一个合适的抽象，使线程+同步模型更容易，或者完全为我们隐藏它（就像自动内存管理使 Java 中好的旧 malloc/free 过时一样）。

一些函数式语言（例如 Erlang）以具有良好的多线程支持而闻名，但是进行函数式编程所需的大脑转换并没有真正让整个考验变得更容易。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-03T15:38:42.930

。网：

**使用诸如`Replace`不将值（新字符串）返回给变量之**类的方法操作字符串时的警告，因为如果您不知道字符串是不可变的，这个问题会让您感到沮丧。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-03T14:54:54.983

在C++中，变量声明的类型推断，这样我就不用写了

```
for (vector<some_longwinded_type>::const_iterator i = v.begin(); i != v.end(); ++i) {
    ...
} 
```

幸运的是，它以 C++1x 的形式出现`auto`：

```
for (auto i = v.begin(); i != v.end(); ++i) {
    ...
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-25T06:18:24.827

咖啡。我的意思是这种语言叫做Java——所以它应该可以煮咖啡！我讨厌从编程中起床，走到咖啡壶前，然后发现营销部门的人已经喝了最后一杯，而没有再煮一壶。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-25T06:25:35.690

持久性，在我看来，我们编写了太多代码来处理持久性，而这确实应该是一个配置问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-03T15:19:44.533

在 C++ 中，枚举到字符串。

在 Ada 中，该语言将枚举类型的 'image 属性定义为一个函数，该函数返回与枚举值的文本表示相对应的字符串。

C++ 没有提供这样干净的工具。需要几行非常神秘的预处理器宏黑魔法才能获得粗略的等价物。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-03T15:00:14.033

对于提供运算符重载的语言，当只定义一个运算时，为对称运算提供自动生成的重载。例如，如果程序员提供了一个等式运算符但没有提供一个不等式运算符，那么该语言可以很容易地生成一个。在 C++ 中，复制构造函数和赋值运算符也可以这样做。

我认为自动生成对称操作的一侧会很好。当然，我肯定希望能够在需要时明确表示**不要这样做**。我想提供双方的实现，其中一个是私有的和空的可以完成这项工作。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-03T15:28:31.627

LINQ 所做的一切。C# 宠坏了我，我现在发现很难用任何其他语言处理集合。在 Python 中，我经常使用列表推导，但它们不如 LINQ 强大。我还没有找到任何其他语言可以让使用集合像在 C# 中一样简单。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-03T15:34:26.480

在 Visual Studio 环境中，我希望“删除未使用的使用”在项目中的所有文件中运行。我发现必须手动打开每个单独的文件并以文件为基础调用此操作会浪费大量时间。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-05-03T16:42:06.193

从动态语言的角度来看，我希望看到更好的工具支持。Steve Yegge 在这方面有一篇[很棒的文章](http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html)。例如，在很多情况下，工具可以查看各种代码路径并确定方法或函数是否存在，并提供编译器冒烟测试的等价物。显然，如果您使用大量真正的动态代码，这将不起作用，但事实是，您可能不会，因此如果 Python 会告诉您 .ToLowerCase () 在编译时不是一个有效的函数，而不是等到你点击 else 子句。

```
s = "a Mixed Case String"
if True:
   s = s.lower()
else:
   s = s.ToLowerCase() 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-05-03T17:02:32.057

简单：像 C# 一样在 C/C++ 中初始化变量。它可以让我在其他人的代码中进行多次调试。

当然，当您特别不想初始化 var 时，会有一个关键字。

```
noinit float myVal; // undefined
float my2ndVal;     // 0.0f 
```

# java - 可以在 Java Web 应用程序中使用 Haml 吗？

> ID：817233
> 
> 赞同：21
> 
> 时间：2009-05-03T14:40:52.443
> 
> 标签：java, haml

我听说 Haml 主要是在 Ruby 世界中作为模板引擎。它也可以在Java项目中使用吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-07-07T18:45:02.280

提出这个问题 2 年后 (:P) 有：

*   骗局 - [http://scalate.fusesource.org/documentation/scaml-reference.html](http://scalate.fusesource.org/documentation/scaml-reference.html)
*   玉 - [http://scalate.fusesource.org/documentation/jade.html](http://scalate.fusesource.org/documentation/jade.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-05-14T11:09:34.913

似乎有人为 Java 启动了一个[项目](http://github.com/raymyers/JHaml)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-03T19:01:51.053

[维基百科页面上](http://en.wikipedia.org/wiki/Haml#Implementations)有一个 Haml 实现列表。目前，还没有针对 Java 的。

# 更新

Java 实现已经有几年了：[https ://github.com/raymyers/JHaml](https://github.com/raymyers/JHaml)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-03-11T22:51:55.007

Scalate 可以与[Spring集成](http://scalate.fusesource.org/documentation/spring-mvc.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T18:29:34.687

也许通过[JRuby](http://jruby.codehaus.org/)？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-09-22T20:36:30.253

计划在[JPublish](http://code.google.com/p/jpublish/)中添加 HAML 支持。它将使用 JRuby。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-15T11:21:16.473

使用 JRuby！
如何在[这个](https://stackoverflow.com/questions/1751479/sass-implementation-for-java/4448937#4448937)答案中。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-05-03T14:43:16.463

HAML 依赖于 Ruby。我知道有一个 HAML 的 Python 克隆，不确定 Java。

虽然，SASS/Compass 与语言无关。

# sql-server-2005 - SQL Server 2005 多边形中的点

> ID：817252
> 
> 赞同：1
> 
> 时间：2009-05-03T14:51:41.123
> 
> 标签：sql-server-2005, tsql, polygons

我在 sql2005 db 中有一个多边形结构，如下所述。

```
CREATE TABLE [dbo].[Polygons](
    [PolygonID] [int] IDENTITY(1,1) NOT NULL,
    [PolygonName] [varchar](255) NOT NULL,
    [PolygonColor] [varchar](7) NOT NULL,
    [PolygonRuleID] [int] NOT NULL)

CREATE TABLE [dbo].[Polylines](
    [LineID] [int] IDENTITY(1,1) NOT NULL,
    [LineX1] [float] NOT NULL,
    [LineY1] [float] NOT NULL,
    [LineX2] [float] NOT NULL,
    [LineY2] [float] NOT NULL,
    [PolygonID] [int] NOT NULL
) 
```

现在我将整行检索到应用程序并全部用于命中测试功能。

```
public static bool PointInPolygon(float pointX, float pointY, PolylineCollection polygon)
        {
            int nvert = polygon.Count();
            int i, j = 0;
            bool c = false;
            for (i = 0, j = nvert - 1; i < nvert; j = i++)
            {
                if (((polygon[i].LineY1 > pointY) != (polygon[j].LineY1 > pointY)) &&
                 (pointX < (polygon[j].LineX1 - polygon[i].LineX1) * (pointY - polygon[i].LineY1) / (polygon[j].LineY1 - polygon[i].LineY1) + polygon[i].LineX1))
                    c = !c;
            }
            return c;
        } 
```

但我需要将此功能移动到 sql server。但是 Sql 2005 没有本机空间功能，我不想使用任何额外的空间功能库。如何将此函数移植到 T-SQL？:) 或者任何人对 PointInPolygon 检查有不同的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-07-29T16:15:54.553

你可以看看这个页面，它提供了 SQL 代码：

[多边形中的 SQL 代码点](http://www.sql-statements.com/point-in-polygon.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T14:57:21.437

您不排除使用具有内置[地理空间类型](http://technet.microsoft.com/en-us/magazine/2008.04.datatypes.aspx)的 sql 2008 。我没有使用它，所以我不能提供除此之外的任何东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T14:56:31.157

您可以将 PointInPolygon 重写为带有游标的存储过程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T14:56:35.290

SQL Server 2005 允许您为可以在服务器端执行的 CLR 编写本机函数。您可以阅读 MSDN 介绍[Using CLR Integration in SQL Server 2005](http://msdn.microsoft.com/en-us/library/ms345136.aspx)。这应该允许您将您的功能实现为 sql server 的补充并以本机速度运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T15:14:20.570

我不得不承认我没有完全得到你的算法来测试点命中。无论如何，多边形的数据结构是奇数的，因为一条线的 X1/Y1 必须等于前一条线的 X2/Y2 才能形成多边形。因此，我只存储单点是为了保证数据结构的一致性，并且最后一个点和第一个点再次相互连接。

至于查找点是否在（2D）多边形内的算法，我首先过滤候选线并创建“切割”（水平或垂直），以便获得线交点列表并订购它们。然后，使用等级函数，如果等级是奇数，它在多边形内部，如果它甚至我们在多边形之外（或在“洞”中）。

# asp.net - 级联下拉绑定

> ID：817255
> 
> 赞同：0
> 
> 时间：2009-05-03T14:54:25.763
> 
> 标签：asp.net, asp.net-ajax

这是一个：

无论如何要查看我页面中的 DropDownList 控件是否在运行时（代码）上绑定到 Ajax CascadingDropDown？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T15:43:52.260

您必须遍历页面上的所有控件并检查是否：

```
ctrl is AjaxControlToolkit.CascadingDropDown 
```

然后查看是否`ctrl.TargetControlID`匹配 DropDownList 的 ID

# iphone - 您可以从 UITableViewDataSource 函数中访问应用程序委托吗？

> ID：817259
> 
> 赞同：32
> 
> 时间：2009-05-03T14:55:55.060
> 
> 标签：iphone, objective-c, cocoa-touch

我正在尝试找出 iPhone 的 SQLite 功能，并且在从被覆盖的 UITableViewDataSource 函数中读取我的数据库文件时遇到了一些问题。我将数据库文件位置存储在我的应用程序委托中的 ivar（作为 NSString）中，但是当我尝试从重写的 UITableViewDataSource 函数访问该字符串时，它返回一些其他对象。如果我从任何类自己的实例方法访问字符串，它工作正常。

有没有办法从重写的 UITableViewDataSource 函数中访问应用程序委托？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-05-03T16:21:34.883

Application 是一个单例，它维护对应用程序委托的引用。您始终可以使用以下方式访问您的应用委托：

```
[UIApplication sharedApplication].delegate 
```

您可能需要将返回值强制转换为您自己的应用程序委托类以消除警告。更好的是，编写一个访问器来返回您的 upcast 应用程序委托：

```
#pragma mark access to app delegate etc.
+ (MyAppDelegateClass*) sharedAppDelegate; {
    return (MyAppDelegateClass*)[[UIApplication sharedApplication] delegate];
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-03T21:42:13.193

Roger 是正确的，但我个人觉得在同一个语句中混合点语法和括号语法非常令人困惑。

如果这也让您感到困惑，那么仅使用括号表示法的等效语法是：

```
[[UIApplication sharedApplication] delegate]; 
```

是的，您可能需要将结果转换为*您的*应用程序委托类，而不是通用的 UIApplicationDelegate 类，否则您很可能会收到许多编译器警告。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-10-11T01:26:50.293

虽然我不喜欢*过多*地使用我的 AppDelegate，但我经常需要访问它才能访问我的应用程序中的其他单例，这使得方法调用 + 转换有点麻烦。所以在我的大多数应用程序中，我会在我的全局头文件中定义一个快速宏。

示例如下：

```
 #define MY_DELEGATE (AppDelegate*)[[UIApplication sharedApplication] delegate] 
```

参考起来要容易得多`MY_DELEGATE`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T21:34:04.180

问题变得非常简单。我使用 stringByAppendingPathComponent: 创建了 NSString 来保存我的数据库文件的路径。我没有意识到这将是自动发布的，所以我没有费心去明确地保留它。它返回不同类型对象的原因是，一旦字符串被自动释放，该内存就被重用了。

显式保留保存数据库文件路径的字符串解决了这个问题。

# c++ - 是否可以创建指针向量？

> ID：817263
> 
> 赞同：8
> 
> 时间：2009-05-03T14:59:28.873
> 
> 标签：c++, stl, pointers, vector, pure-virtual

只是想知道，由于我遇到的一个问题，是否可以创建一个指针向量？如果是这样，怎么办？特别是关于使用迭代器和 .begin() ，即：我如何将此向量转换为指针向量：

```
class c
{
     void virtual func();
};

class sc:public c
{
     void func(){cout<<"using func";}
};

sc cobj;

vector<c>cvect
cvect.push_back(cobj);
vector<c>::iterator citer

for(citer=cvect.begin();citer<cvect.end();citer++)
{
     citer->func();
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-03T15:08:48.413

当然。

```
vector<c*> cvect;
cvect.push_back(new sc);
vector<c*>::iterator citer;
for(citer=cvect.begin(); citer != cvect.end(); citer++) {
  (*citer)->func();
} 
```

要记住的事情：

如果您像我在示例中所做的那样使用动态分配的内存，则需要在您自己之后进行清理

例如：

```
 for(...) { delete *i; } 
```

这可以通过使用`shared_ptr`s 的向量（如`boost::shared_ptr`）来简化。不要尝试使用`std::auto_ptr`它，它不会工作（甚至不会编译）。

要记住的另一件事是，您应该尽可能避免`<`在循环中使用比较迭代器，它仅适用于对随机访问迭代器建模的迭代器，这意味着您不能更改代码以使用例如 a `std::list`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-03T15:01:15.560

`vector <c> cvect`不是指针向量。它是类型 c 的对象的向量。你想要`vector <c*> cvect`。你可能想要：

```
cvect.push_back( new c ); 
```

然后，给定一个迭代器，你想要这样的东西：

```
(*it)->func(); 
```

当然，很可能你一开始就不想要一个指针向量......

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T15:10:15.820

是的，这是可能的，事实上，如果您希望向量包含来自整个类层次结构而不是单一类型的对象，则有*必要使用指针。*（不使用指针将导致可怕的[对象切片](http://en.wikipedia.org/wiki/Object_slicing)问题——所有对象都默默地转换为基类类型。编译器不会诊断出这种情况，而且几乎可以肯定这不是你想要的。）

```
class c
{
     void virtual func();
};

class sc:public c
{
     void func(){cout<<"using func";}
};

sc cobj;

vector<c*> cvect;             // Note the type is "c*"
cvect.push_back(&cobj);       // Note the "&"
vector<c*>::iterator citer;

for(citer=cvect.begin();citer != cvect.end();citer++)   // Use "!=" not "<"
{
     (*citer)->func();
} 
```

请注意，使用指针向量，**您需要进行自己的内存管理**，所以要非常小心——如果您将使用本地对象（如上所述），它们不能在容器之前超出范围。如果您使用指向用 创建的对象的指针，则`new`需要`delete`在容器被销毁之前手动使用它们。在这种情况下，您绝对应该考虑使用智能指针，例如`smart_ptr`.[`Boost`](http://www.boost.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T15:03:00.707

您已经创建`vector<c*>`了一个指针向量。然后用于`new`为 c 对象分配内存并将它们推送到向量中。另外，不要忘记你必须`delete`自己和 vector.clear() 不会释放分配给 c 对象的内存。您必须在此处将 c 存储为指针向量，否则对虚函数的调用将不起作用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-03T15:07:52.627

是的，当然。

```
// TestCPP.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <iostream>
#include <vector>

using namespace std;

class c
{
public:
    void virtual func() = 0;
};

class sc:public c
{
public:
    void func(){cout<<"using func";}
};

int _tmain(int argc, _TCHAR* argv[])
{
    sc cobj;

    vector<c*> cvect;
    cvect.push_back(&cobj);
    vector<c*>::iterator citer;

    for(citer=cvect.begin();citer<cvect.end();citer++)
    {
        (*citer)->func();
    }

    return 0;
} 
```

请注意 的声明`vector<c*> cvect`和使用`cvect.push_back(&cobj)`。

从提供的代码中，您以错误的方式使用迭代器。要访问迭代器指向的成员，您必须使用`*citer`而不是`citer`单独使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T22:10:31.027

试试[Boost 指针容器库](http://www.boost.org/doc/libs/1_35_0/libs/ptr_container/doc/examples.html)。与常规的指针向量相比，它有几个优点，例如：

```
my_container.push_back( 0 );            // throws bad_ptr 
ptr_vector<X> pvec; 
std::vector<X*> vec;
( *vec.begin() )->foo(); // call X::foo(), a bit clumsy
pvec.begin()->foo();     // no indirection needed 
```

# css - 撞上底部元素

> ID：817270
> 
> 赞同：0
> 
> 时间：2009-05-03T15:04:29.093
> 
> 标签：css, xhtml

在这个网站上：http: [//www.catonthecouchproductions.com/new/](http://www.catonthecouchproductions.com/new/) - 我一直在尝试删除两个红色边框之间的空间，因为我可以保留我最新的项目框而无需滚动。现在它有一个轻微的滚动，然后如果您单击“最新项目”顶部的蓝色框，它会拉出一个客户列表。

我说的是垂直滚动。我设置了边框，你可以看到什么元素是什么，占据什么空间。

我的目标是让它向上推动其他内容，但首先要从滚动开始。

主要内容框和底框之间的巨大差距。

关于我能做些什么来解决这个问题的任何想法？

我的 CSS 在这里： http: [//www.catonthecouchproductions.com/new/style.css](http://www.catonthecouchproductions.com/new/style.css)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T15:13:01.727

首先，您的网站看起来很棒！

至于导致水平滚动条的红色边框，解决该问题的唯一方法是一起删除边框。底部的蓝色框似乎延伸到页面宽度的 100%。不幸的是，当您添加一个 1 像素的边框时，它会在 100% div 的宽度上增加两个像素，因此它最终占据了超过 100% 的窗口。据我所知，他们无法用 CSS 解决这个问题，所以你必须一起摆脱边框。

# haml - HAML、SASS/Compass 和 ERB 之间的主要区别是什么？

> ID：817272
> 
> 赞同：10
> 
> 时间：2009-05-03T15:05:38.327
> 
> 标签：haml, sass, erb, compass-sass, templating-engine

我正在寻找一个模板引擎。在 HAML、SASS/Compass 和 ERB 中进行选择时需要考虑哪些重要因素？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-03T15:18:05.007

总结一下：

*   Haml 是一种标记语言
*   Sass 是一组可以编译成标准 CSS 的 CSS 扩展
*   Compass 是 Sass 围绕 Blueprint 之类的东西的包装器
*   Erb 只是带有嵌入式 Ruby 代码的 HTML。

通常，您会关注 Haml 或 Erb（尽管您可以根据需要混合和匹配它们），以及 CSS 或 Sass。Compass 只是 Sass 的一个附加组件。

我建议从 Haml 和 Sass 开始，因为 Haml 采用了 HTML 中大部分烦人的、容易出错的方面并抛弃了它们。一旦你习惯了用 Haml 写作，使用 Erb 就会感觉很罗嗦。

至于 CSS，选择一个框架（例如[Blueprint](http://www.blueprintcss.org/)），并按原样使用它来开始。如果您觉得需要，您可以随时添加 Compass。

# windows - 关于 Windows 操作系统中的硬盘驱动器、“查找”和“读取”的问题

> ID：817279
> 
> 赞同：-1
> 
> 时间：2009-05-03T15:09:38.897
> 
> 标签：windows, winapi, file-io, filesystems, hard-drive

有谁知道在调用 'seek' 和 'read' 时，硬盘驱动器的物理影响如何？

如果我更具体一点，我知道硬盘驱动器有某种磁针，用于从磁板上读取数据。所以我的问题是，针实际上是什么时候移动到阅读位置的？

它是在我们调用“seek”windowsApi 方法时移动（不管是否执行了实际读取），还是“seek”只记住了一个虚拟指针，并且只有在“read”方法时才执行针的物理移动叫做？

**编辑**：假设从硬盘驱动器请求的数据不存在于任何缓存中（硬盘驱动器缓存、Os Cache、Ram 以及其他任何可能的缓存）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T15:17:59.797

想从您的帖子中提出这个问题

> 指针何时实际移动到读取位置？

我认为简单的答案是“只要请求的数据尚未出现在任何数量的缓存中”。预测硬盘驱动器移动的问题是您必须考虑缓存从硬盘驱动器读取的数据的所有不同位置。如果数据存在于这些缓存中并且可以在请求数据的上下文中访问，则将使用缓存而不是实际读取硬盘驱动器。这里只是一些可以缓存硬盘数据的地方

*   硬盘驱动器的内部缓存
*   操作系统级缓存
*   程序级缓存
*   API 级缓存

在不存在任何数据的情况下，它可能会在`read`通话期间从硬盘驱动器中读取。调用不太可能导致硬盘驱动器`seek`移动，因为您更改的不是物理硬盘驱动器指针，而是指向程序中文件的虚拟指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T15:54:31.347

硬盘驱动器磁头（针）开始移动，磁盘开始旋转（除非已经旋转）`read`。操作中没有头部移动或旋转`seek`。

请注意，即使您`read`按顺序读取文件，磁头也可能在磁盘上方不按顺序移动，即`read`第 2、3 等 512 字节块可能导致磁头移动很远，即使没有干预`seek`s. 这部分是因为文件在文件系统上被碎片化，或者因为固件具有扇区号重新映射（即逻辑扇区 5 不在逻辑扇区 4 和 6 之间）以补偿坏块错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T19:37:47.567

问题“假设从硬盘驱动器请求的数据不存在于任何缓存（硬盘驱动器缓存、Os Cache、Ram 和其他任何可能的）”问题中的假设很难假设并且相对罕见. 即使在这种情况下，用户模式文件 I/O 操作和物理存储设备操作之间也只有松散的关联。

各种 Windows 库中有许多用户模式文件 I/O 函数。一些最古老的是[C 库低级 I/O 函数](http://msdn.microsoft.com/en-us/library/aa246460(VS.60).aspx)。还有[C 库流 I/O 函数](http://msdn.microsoft.com/en-us/library/aa272973(VS.60).aspx)、[C++ iostreams 类](http://msdn.microsoft.com/en-us/library/aa247506(VS.60).aspx)和[管理 I/O 类](http://msdn.microsoft.com/en-us/library/system.io.aspx)。还有其他 I/O 接口是其他包的一部分。

通常，所有用户模式 ​​I/O 库都构建在[Win32 文件 I/O 函数](http://msdn.microsoft.com/en-us/library/aa364232(VS.85).aspx)之上，包括[CreateFile()](http://msdn.microsoft.com/en-us/library/system.io.aspx)、[SetFilePointer()](http://msdn.microsoft.com/en-us/library/aa365541(VS.85).aspx)、[ReadFile()](http://msdn.microsoft.com/en-us/library/aa365467(VS.85).aspx)和[WriteFile()](http://msdn.microsoft.com/en-us/library/aa365747(VS.85).aspx)。

除非文件以非缓冲模式打开，否则操作系统可以缓存文件内容。这是在系统范围内完成的，而不是在每个文件的基础上完成的。因此，即使您的程序没有读取或写入文件，文件的 I/O 也可能会被缓存，并且不会导致任何物理存储设备 I/O。

有许多因素决定了文件 I/O 如何映射到物理设备上的实际 I/O 操作。这包括库级缓冲、操作系统缓存、设备驱动程序缓存、硬件级缓存、设备块大小、文件大小、硬件块/扇区重新映射和其他因素。

这里的简短故事是，您不能假设单个文件级别的读取或查找操作对应于物理设备操作，例如磁盘磁头查找。

当考虑写入时，这变得更加棘手。写入通常伴随着刷新 - 应用程序开发人员认为这会将数据一直推送到物理介质。开发人员通常假设，当刷新调用返回成功时，可以保证数据在存储设备上保持持久性。这远非如此，因为设备和驱动程序经常忽略刷新调用。

固态驱动器的复杂性更高，它不是机械的，因此没有“寻道”操作。在这里，其他物理特性表现出来，例如在写入块之前必须擦除块。

# batch-file - “FOR”如何在 cmd 批处理文件中工作？

> ID：817280
> 
> 赞同：23
> 
> 时间：2009-05-03T15:09:51.767
> 
> 标签：batch-file, iteration, cmd

我已经用几十种语言编程了 20 年，但无论我多么努力，我都无法理解“FOR”在 windows cmd shell 批处理文件中是如何工作的。我读

[http://www.amazon.com/Windows-Administration-Command-Line-Vista/dp/0470046163/ref=sr_1_1?ie=UTF8&s=books&qid=1241362727&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0470046163)

[http://www.ss64.com/nt/for.html](http://www.ss64.com/nt/for.html)

以及互联网上的其他几篇文章，但仍然感到困惑并且无法完成任何事情。

谁能给我一个关于“FOR”一般如何工作的简明解释？

对于更具体的问题，如何遍历 %PATH% 变量中的每个路径？我试过了

```
rem showpathenv.bat
for /f "delims=;" %%g in ("%PATH%") do echo %%g 
```

那只会显示第一条路径，而不是全部。为什么 ？我做错了什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-04T02:22:07.810

没有一个答案真的有效。我自己设法找到了解决方案。这有点骇人听闻，但它为我解决了问题：

```
echo off
setlocal enableextensions
setlocal enabledelayedexpansion
set MAX_TRIES=100
set P=%PATH%
for /L %%a in (1, 1, %MAX_TRIES%) do (
  for /F "delims=;" %%g in ("!P!") do (
    echo %%g
    set P=!P:%%g;=!
    if "!P!" == "%%g" goto :eof
  )
) 
```

哦 ！我讨厌批处理文件编程！

**更新**

Mark 的解决方案更简单，但不适用于包含空格的路径。这是马克解决方案的一个小修改版本

```
echo off
setlocal enabledelayedexpansion
set NonBlankPath=%PATH: =#%
set TabbedPath=%NonBlankPath:;= %
for %%g in (%TabbedPath%) do (
  set GG=%%g
  echo !GG:#= !
) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-18T12:58:36.230

马克的想法很好，但可能忘记了一些路径中有空格。替换';' 使用 '" "' 代替会将所有路径切割成带引号的字符串。

```
set _path="%PATH:;=" "%"
for %%p in (%_path%) do if not "%%~p"=="" echo %%~p 
```

所以在这里，你有你的路径显示。

cmd 中的 FOR 命令有一条乏味的学习曲线，特别是因为变量在 () 的语句中如何反应……你可以分配任何变量，但你不能在 () 中读回，除非你使用 " setlocal ENABLEDELAYEDEXPANSION" 语句，因此也使用带有 !!'s 的变量而不是 %%'s (!_var!)

我目前专门用 cmd 编写脚本，为了工作，必须学习所有这些:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-03T15:28:57.460

您有正确的想法，但`for /f`设计用于处理多行文件或命令，而不是单个字符串。

在其最简单的形式中，`for`就像 Perl 的`for`或其他所有语言的`foreach`. 你向它传递一个令牌列表，它会遍历它们，每次都调用相同的命令。

```
for %a in (hello world) do @echo %a 
```

扩展仅提供构建令牌列表的自动方式。您当前的代码一无所获的原因是 ' `;`' 是默认的行尾（注释）符号。但即使你改变它，你也必须使用`%%g, %%h, %%i, ...`来访问单个令牌，这将严重限制你的批处理文件。

最接近您要求的是：

```
set TabbedPath=%PATH:;= %
for %%g in (%TabbedPath%) do echo %%g 
```

但是对于包含分号的引用路径，这将失败。

根据我的经验，`for /l`对于`for /r`扩展现有命令很有用，但在其他`for`方面非常有限。您可以通过延迟变量扩展 ( ) 使其功能更强大（并且令人困惑）`cmd /v:on`，但它实际上只适用于文件名列表。

如果您需要执行字符串操作，我建议您使用 WSH 或 PowerShell。如果您尝试`whereis`为 Windows 编写代码，请尝试`where /?`.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-24T17:48:34.403

忍不住把它扔在那里，因为这个线程很旧......通常当需要遍历 PATH 中的每个文件时，你真正想要做的就是找到一个特定的文件......如果是这样的话，这个单线将吐出它找到你的文件的第一个目录：

（例如：寻找 java.exe）

```
for %%x in (java.exe) do echo %%~dp$PATH:x 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-01T16:13:35.780

我知道这是超级老...但只是为了好玩我决定试一试：

```
@Echo OFF
setlocal
set testpath=%path: =#%
FOR /F "tokens=* delims=;" %%P in ("%testpath%") do call :loop %%P
:loop
if '%1'=='' goto endloop
set testpath=%1
set testpath=%testpath:#= %
echo %testpath%
SHIFT
goto :loop
:endloop
pause
endlocal
exit 
```

这不需要计数，并且会一直持续到完成。我对空格也有同样的问题，但它通过了整个变量。关键是循环标签和`SHIFT`函数。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-03T15:23:11.560

`for /f`每行输入迭代，所以在你的程序中只会输出第一个路径。

您的程序将 %PATH% 视为单行输入，并用 分隔`;`，将第一个结果放入 %%g，然后输出 %%g（第一个分隔路径）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-03T15:31:20.450

`FOR`本质上是迭代数据集中的“线”。在这种情况下，只有一行包含路径。这`"delims=;"`只是告诉它用分号分隔。如果将正文更改为，`echo %%g,%%h,%%i,%%j,%%k`您会看到它将输入视为单行并将其分解为多个标记。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-09-15T19:34:04.957

这对我有用：

```
@ECHO OFF
SETLOCAL ENABLEDELAYEDEXPANSION ENABLEEXTENSIONS
@REM insure path is terminated with a ;
set tpath=%path%;
echo.
:again
@REM This FOR statement grabs the first element in the path
FOR /F "delims=;" %%I IN ("%TPATH%") DO (
  echo    %%I 
  @REM remove the current element of the path
  set TPATH=!TPATH:%%I;=!
)
@REM loop back if there is more to do. 
IF DEFINED TPATH GOTO :again

ENDLOCAL 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-07T22:09:05.420

您必须另外使用循环允许的`tokens=1,2,...`部分选项。`for`这将做你可能想要的：

```
for /f "tokens=1,2,3,4,5,6,7,8,9,10,11,12 delims=;" %a in ("%PATH%") ^
do ( ^
     echo. %b ^
   & echo. %a ^
   & echo. %c ^
   & echo. %d ^
   & echo. %e ^
   & echo. %f ^
   & echo. %g ^
   & echo. %h ^
   & echo. %i ^
   & echo. %j ^
   & echo. %k ^
   & echo. ^
   & echo.   ...and now for some more... ^
   & echo. ^
   & echo. %a ^| %b ___ %c ... %d ^
   & dir "%e" ^
   & cd "%f" ^
   & dir /tw "%g" ^
   & echo. "%h  %i  %j  %k" ^
   & cacls "%f") 
```

此示例仅处理前 12 个标记（=来自 %path% 的目录）。它使用每个使用的标记的显式枚举。请注意，令牌名称区分大小写：%a 与 %A 不同。

为了保存带有空格的路径，请将***所有***%x 用引号括起来，例如“%i”。我没有在这里做，我只是在呼应令牌。

你也可以做某事。像这样：

```
for /f "tokens=1,3,5,7-26* delims=;" %a in ("%PATH%") ^
do ( ^
     echo. %c ^
   & echo. %b ^
   & echo. %a ^
   & echo. %d ^
   & echo. %e ^
   & echo. %f ^
   & echo. %g ^
   & echo. %h ^
   & echo. %i ^
   & echo. %j ^
   & echo. %k ) 
```

这个跳过标记 2,4,6 并使用一个小快捷方式 (" `7-26`") 来命名其余的标记。请注意，与第一个示例相比，这次 %c、%b、%a 是如何以相反的顺序处理的，以及它们现在如何“表示”不同的标记。

所以这肯定不是你要求的简明解释。但也许这些例子现在有助于澄清一点......

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-03T15:39:56.170

这是一个很好的指南：

[FOR /F - 循环命令：针对一组文件。](http://www.ss64.com/nt/for_f.html)

[FOR /F - 循环命令：针对另一个命令的结果。](http://www.ss64.com/nt/for_cmd.html)

[FOR - 循环命令：所有选项文件、目录、列表。](http://www.ss64.com/nt/for.html)

[整个指南（Windows XP 命令）：

[http://www.ss64.com/nt/index.html](http://www.ss64.com/nt/index.html)

**编辑：**抱歉，没有看到该链接已经在 OP 中，因为它在我看来是亚马逊链接的一部分。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-09-11T14:16:44.653

它对我有用，试试吧。

```
for /f "delims=;" %g in ('echo %PATH%') do echo %g% 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2017-04-06T16:40:55.587

它对我有用，试试吧。

for /f "tokens=* delims=;" %g in ('echo %PATH%') 回显 %g%

# objective-c - 使用 NSURLConnection 进行单元测试

> ID：817282
> 
> 赞同：3
> 
> 时间：2009-05-03T15:10:21.700
> 
> 标签：objective-c, unit-testing, networking, mocking

我想测试一段使用网络的代码（`NSURLConnection`具体来说是类）。代码（我们称之为`NetworkManager`）看起来有点像这样：

```
- (id) buildConnection
{
    // some more code and then:
    return [NSURLConnection …];
}

- (void) startNetworkSync
{
    id connection = [self buildConnection];
    //…
} 
```

在单元测试中，我想摆脱网络，即。用模拟替换`NSURLConnection`对象。我该怎么做呢？

我尝试创建一个部分模拟`NetworkManager`，它将用`buildConnection`存根替换该方法。问题是[OCMock](http://www.mulle-kybernetik.com/software/OCMock/)所做的部分模拟仅来自外部世界的存根消息——`buildConnection`从`startNetworkSync`调用发送原始方法，而不是存根。

我还尝试`NetworkManager`通过一个类别对课程进行猴子修补。这行得通，我可以很容易地用其他代码覆盖该方法并用存根`buildConnection`替换真实的方法。`NSURLConnection`问题是我发现没有简单的方法可以在测试中获取存根连接——该连接是`NetworkManager`.

然后我可以子类化`NetworkManager`，覆盖该`buildConnection`方法并为创建的连接添加一个实例变量和一个访问器。不过，这似乎是很多代码。

你会如何解决这个问题？我正在寻找一种解决方案，它可以保持`NetworkManager`类设计干净，并且在测试中不需要太多魔法或太多代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T15:35:49.737

这就是依赖注入旨在解决的问题；如果您`startNetworkSyncWithConnection:(NSURLConnection*)`改用，您可以使用模拟连接轻松测试该方法。如果您不想为您的客户端更改 API，您甚至可以将其保留为一个包装器，除了调用该新方法作为参数`startNetworkSync`之外什么都不做。`[self buildConnection]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-15T14:35:53.730

我修改了 OCMock 以支持真正的部分模拟，请参阅[GitHub 上的 repo](http://github.com/mmangino/OCMock)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-08T07:33:33.730

我最近使用的另一个解决方案是完全抽象网络接口。如果该类需要来自网络的一些数据，它可能会与一些可以显式建模为协议的服务器服务交互：

```
@protocol SomeNetworkService
- (NSArray*) allAvailableFoos;
- (void) insertNewFoo: (Foo*) foo;
@end 
```

然后您将拥有一个真正的 HTTP 实现和一个测试实现。这意味着更多的工作，但也意味着更好的可测试性。测试不那么脆弱，也更方便，因为测试网络层可以做​​任何你需要的事情。

# tsql - 如何编写 SQL 选择语句以包含来自另一个表的查找？

> ID：817283
> 
> 赞同：0
> 
> 时间：2009-05-03T15:10:30.377
> 
> 标签：tsql, select, lookup

我正在将数据从一个数据库复制到另一个数据库，并在处理数据时对数据进行按摩。这两个数据库都有名为 Clients 和 Jobs 的表。

但是，在数据库“Alpha”中，Jobs 表与 Clients 表没有关系，而数据库“Epsilon”则有。Alpha 的 Jobs 表仅在 nvarchar 列中包含 Clients 名称。

当我将它插入到 Epsilon 的 Jobs 表中时，我需要一个 select 语句来按名称在 Client 表中查找 Client 的 ID。

我未完成的 SQL 语句如下所示：

```
insert into Epsilon.dbo.Jobs (ClientId, Name, Location, DateCreated)
    select ????, Name, Location, DateCreated from Alpha.dbo.Jobs 
```

我怎样才能修改它，以便???? 包含 Epsilon 中的 Clients 表中的 ClientId？我知道我需要使用 Jobs 中的 Name 列来查找数据，但我不知道它的语法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T15:21:20.363

你需要的是一个加入。与几乎每个人在开始时的想法相反，联接不需要在数据库模式中定义关系。他们只要求您要比较的两列具有相同的类型（*编辑*见评论）。

问题是你想要哪个加入。因为没有定义关系，所以可能存在有工作的客户和没有工作的客户，以及有客户的工作和没有的工作。

我假设您想要所有存在的 JOBS，并且在 ClientId 与 CLIENTS 表匹配的地方引入 ClientId，并且在不存在该关系的地方将 ClientId 保留为空。我们可以使用 LEFT JOIN 来做到这一点。Jobs LEFT JOIN 客户将在 LEFT 中引入所有记录，即使与右侧的客户定义的关系不存在。我们可以颠倒这两个并做一个 RIGHT JOIN，但这不是人们通常做的。我将留给您阅读其他类型的联接及其工作原理。

所以你的选择语句看起来像：

```
select ClientId, Name, Location, DateCreated 
from Alpha.dbo.Jobs as J LEFT JOIN 
    Alpha.dbo.Clients as C ON j.ClientName = c.ClientName 
```

如果 Jobs.ClientName 与 c.ClientName 的数据类型不同，则可以在运行查询之前编辑架构以使它们彼此一致。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T15:15:06.853

```
insert into Epsilon.dbo.Jobs (ClientId, Name, Location, DateCreated)
    select c.ClientID, a.Name, a.Location, a.DateCreated from Alpha.dbo.Jobs a
    join Epsilon.dbo.Client c on c.Name = a.ClientName 
```

这是一个非常乐观的联接，但即使需要对其进行修改，这也应该可以为您提供大致的思路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T15:13:52.863

> 插入 Epsilon.dbo.Jobs (ClientId, Name, Location, DateCreated) select c.ClientId, Name, Location, DateCreated from Alpha.dbo.Jobs as j inner join Epsilon.dbo.Clients as c On (j.ClientId = c .ClientId)

# python - 覆盖 Django ModelForm 中的保存方法

> ID：817284
> 
> 赞同：74
> 
> 时间：2009-05-03T15:12:00.997
> 
> 标签：python, django, django-forms, django-admin

我无法覆盖`ModelForm`保存方法。这是我收到的错误：

```
Exception Type:     TypeError  
Exception Value:    save() got an unexpected keyword argument 'commit' 
```

我的意图是让一个表单为 3 个字段提交许多值，然后为这些字段的每个组合创建一个对象，并保存每个对象。朝正确方向助推将是王牌。

### 文件`models.py`

```
class CallResultType(models.Model):
    id = models.AutoField(db_column='icontact_result_code_type_id', primary_key=True)
    callResult = models.ForeignKey('CallResult', db_column='icontact_result_code_id')
    campaign = models.ForeignKey('Campaign', db_column='icampaign_id')
    callType = models.ForeignKey('CallType', db_column='icall_type_id')
    agent = models.BooleanField(db_column='bagent', default=True)
    teamLeader = models.BooleanField(db_column='bTeamLeader', default=True)
    active = models.BooleanField(db_column='bactive', default=True) 
```

### 文件`forms.py`

```
from django.forms import ModelForm, ModelMultipleChoiceField
from callresults.models import *

class CallResultTypeForm(ModelForm):
    callResult = ModelMultipleChoiceField(queryset=CallResult.objects.all())
    campaign = ModelMultipleChoiceField(queryset=Campaign.objects.all())
    callType = ModelMultipleChoiceField(queryset=CallType.objects.all())

    def save(self, force_insert=False, force_update=False):
        for cr in self.callResult:
            for c in self.campain:
                for ct in self.callType:
                    m = CallResultType(self) # this line is probably wrong
                    m.callResult = cr
                    m.campaign = c
                    m.calltype = ct
                    m.save()

    class Meta:
        model = CallResultType 
```

### 文件`admin.py`

```
class CallResultTypeAdmin(admin.ModelAdmin):
    form = CallResultTypeForm 
```

* * *

## 回答 #1

> 赞同：163
> 
> 时间：2009-05-03T15:54:10.037

在你的`save`你必须有论据`commit`。如果有任何东西覆盖了您的表单，或者想要修改它正在保存的内容，它将执行`save(commit=False)`，修改输出，然后自行保存。

此外，您的 ModelForm 应该返回它正在保存的模型。通常，ModelForm`save`看起来像：

```
def save(self, commit=True):
    m = super(CallResultTypeForm, self).save(commit=False)
    # do custom stuff
    if commit:
        m.save()
    return m 
```

阅读[方法](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-save-method)。[_`save`](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-save-method)

最后，由于您访问事物的方式，很多这种 ModelForm 将无法正常工作。而不是`self.callResult`，您需要使用`self.fields['callResult']`.

*更新*：回应您的回答：

*旁白：*为什么不在`ManyToManyField`Model 中使用 s 这样你就不必这样做了？似乎您正在存储冗余数据并为自己（和我`:P`）做更多的工作。

```
from django.db.models import AutoField  
def copy_model_instance(obj):  
    """
    Create a copy of a model instance. 
    M2M relationships are currently not handled, i.e. they are not copied. (Fortunately, you don't have any in this case)
    See also Django #4027\. From http://blog.elsdoerfer.name/2008/09/09/making-a-copy-of-a-model-instance/
    """  
    initial = dict([(f.name, getattr(obj, f.name)) for f in obj._meta.fields if not isinstance(f, AutoField) and not f in obj._meta.parents.values()])  
    return obj.__class__(**initial)  

class CallResultTypeForm(ModelForm):
    callResult = ModelMultipleChoiceField(queryset=CallResult.objects.all())
    campaign = ModelMultipleChoiceField(queryset=Campaign.objects.all())
    callType = ModelMultipleChoiceField(queryset=CallType.objects.all())

    def save(self, commit=True, *args, **kwargs):
        m = super(CallResultTypeForm, self).save(commit=False, *args, **kwargs)
        results = []
        for cr in self.callResult:
            for c in self.campain:
                for ct in self.callType:
                    m_new = copy_model_instance(m)
                    m_new.callResult = cr
                    m_new.campaign = c
                    m_new.calltype = ct
                    if commit:
                        m_new.save()
                    results.append(m_new)
         return results 
```

这允许继承`CallResultTypeForm`，以防万一。

# ruby-on-rails - AR.to_json 在控制台中工作，在浏览器中失败

> ID：817287
> 
> 赞同：0
> 
> 时间：2009-05-03T15:13:21.320
> 
> 标签：ruby-on-rails, ruby, json, activerecord

我有这段代码：

```
users = Array.new
users << User.find(:all, :conditions => ["email like ?", "%foo%"])
users << User.find(:all, :conditions => ["name like ?", "%bar%"])
users.flatten!
users.uniq!
puts users.to_json :include => [:licenses] 
```

当我使用脚本/控制台运行它时，它会准确返回您认为它应该返回的内容，即我找到的、扁平化和唯一化的用户数组的 JSON 表示。但是将同一行代码作为`search_for_users`方法的一部分运行，我得到了这个错误

> ControllerName#search_for_users 中的 TypeError
> 错误的参数类型哈希（预期数据）

并且引用的行是带有 .to_json 调用的行。

这让我感到困惑，因为代码一字不差。唯一的区别是，当我在控制台中运行它时，我手动输入条件，但在我的方法中，我从`params[:query]`. 但是，我只是尝试对查询进行硬编码并得到相同的结果，所以我认为这不是问题所在。如果我删除`:include`，我看不到错误，但我也没有得到我想要的数据。

任何人都知道问题可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T17:02:44.647

如果包含在您的控制器中，有一些插件和 gem 可能会导致 .to_json 失败。我相信 Twitter gem 就是其中之一（不久前遇到了问题）。

你在这个控制器中有“包括[任何]”或“需要[任何]”吗？

如果没有，我建议暂时删除您用于故障排除等的任何插件。

最后，如果您将整个控制器操作替换为以下内容会发生什么： %w(1 2 3 4 5).to_json

这应该可以帮助您确定失败的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T18:55:45.437

每当测试或控制台中的代码与生产环境的行为不同（这是一个猜测......您可能正在开发模式下运行您的站点），这需要加载顺序问题。在生产环境中，所有模型和控制器都是预加载的，在其他环境中，它们会在需要时延迟加载。启动您的控制台，`RAILS_ENV=production ./script/console`看看您是否可以通过这种方式重现错误。正如 cscotta 所提到的，有几个 gems 和 library 可能会干扰 .to_json，首先要提到当你需要“json”时获得的功能。我个人遇到了几个问题。

希望这可以帮助

塞布

# c# - C#：如何确保在执行操作之前在 ListView 中选择了行或项目？

> ID：817294
> 
> 赞同：10
> 
> 时间：2009-05-03T15:16:08.507
> 
> 标签：c#, .net, winforms

检查列表视图中是否至少有一个选定项目的最佳方法是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-03T15:19:05.033

我不完全确定你在问什么。是否要确保在运行操作之前至少选择了一项？如果是这样，以下应该工作

```
if ( listView.SelectedItems.Count > 0 ) { 
  // Do something
} 
```

或者您是否好奇是否选择了特定项目？如果是这样，请尝试以下

```
if ( listView.SelectedItems.Contains(someItem)) { 
  // Do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T15:22:52.500

```
if( listView.SelectedItems.Count > 0 ){
 // do stuff here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T20:39:52.077

您还可以检查所选项目的值，或者在需要时将其绑定到字符串：

```
 //Below is with string
        String member = (String)ListView1.SelectedValue;

        //Below is with any class
        AnyClass member = (AnyClass)ListView1.SelectedValue;
        String StaffID = member.StaffID; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-17T14:43:53.713

int taskId = Convert.ToInt32(itemRow.SubItems[0].Text);

字符串 taskDate = itemRow.SubItems [1](https://i.stack.imgur.com/DqiTm.png) .ToString();

字符串 taskDescription = itemRow.SubItems[2].ToString(); [在此处输入图像描述](https://i.stack.imgur.com/DqiTm.png)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-07-04T13:29:03.260

```
//Here a simple loop that go through all the items in the list  

for (int i = 0; i < listView1.Items.Count; i++)
{
    //checks if the item in the list has the value true to the properties checked 

    if (listView1.Items[x].Checked == true)
    {//your  code
        //e.g. 
        listView1.Items[x].Checked = false;
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-01-12T09:40:40.117

您还可以使用 listview 的 getCheckedItemCount() 方法检查所选项目列表的计数。例如，

if(listview.getCheckedItemCount() > 0) {

```
 // do stuff here 
```

}

# eclipse - 如何在运行时获取自定义 Eclipse 功能的版本号？

> ID：817299
> 
> 赞同：3
> 
> 时间：2009-05-03T15:18:23.837
> 
> 标签：eclipse, eclipse-plugin, version, eclipse-pde

我想在其透视图的标题栏中显示我正在开发的自定义 Eclipse 功能的版本号。有没有办法从运行时插件和/或工作台获取版本号？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T17:54:59.700

就像是：

```
Platform.getBundle("my.feature.id").getHeaders().get("Bundle-Version"); 
```

应该做的伎俩。

注意（[来自这个线程](http://dev.eclipse.org/newslists/news.eclipse.platform/msg29801.html)）它不能*在*插件本身的任何地方使用：在插件上调用
`this.getBundle()`AFTER 之前无效。 因此，如果您在构造函数中或在调用之前使用，那么它将返回 null。`super.start(BundleContext)`
`this.getBundle()``start(BundleContext)``super.start()`

* * *

如果失败了，你在这里有一个[更完整的“版本”](http://dev.eclipse.org/newslists/news.eclipse.platform/msg48220.html)：

```
public static String getPlatformVersion() {
  String version = null;

  try {
    Dictionary dictionary = 
      org.eclipse.ui.internal.WorkbenchPlugin.getDefault().getBundle().getHeaders();
    version = (String) dictionary.get("Bundle-Version"); //$NON-NLS-1$
  } catch (NoClassDefFoundError e) {
    version = getProductVersion();
  }

  return version;
}

public static String getProductVersion() {
  String version = null;

  try {
    // this approach fails in "Rational Application Developer 6.0.1"
    IProduct product = Platform.getProduct();
    String aboutText = product.getProperty("aboutText"); //$NON-NLS-1$

    String pattern = "Version: (.*)\n"; //$NON-NLS-1$
    Pattern p = Pattern.compile(pattern);
    Matcher m = p.matcher(aboutText);
    boolean found = m.find();

    if (found) {
      version = m.group(1);
    }
  } catch (Exception e) {

  }

  return version;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-02T16:13:07.480

我使用第一个选项：

```
protected void fillStatusLine(IStatusLineManager statusLine) {
    statusItem = new StatusLineContributionItem("LastModificationDate"); //$NON-NLS-1$
    statusItem.setText("Ultima Actualizaci\u00f3n: "); //$NON-NLS-1$
    statusLine.add(statusItem);
    Dictionary<String, String> directory = Platform.getBundle("ar.com.cse.balanza.core").getHeaders();
    String version = directory.get("Bundle-Version");

    statusItem = new StatusLineContributionItem("CopyRight"); //$NON-NLS-1$
    statusItem.setText(Messages.AppActionBar_18);
    statusLine.add(statusItem);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T20:14:03.600

正如@zvikico 上面所说，接受的答案不适用于功能，仅适用于插件（OSGi 捆绑包，功能不是）。获取有关已安装功能的信息的方法是通过[这里描述](http://vladdu.blogspot.com/2010/06/retrieving-features-version-number-in.html)`org.eclipse.core.runtime.Platform.getBundleGroupProviders()`的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T20:29:23.050

VonC 提供的用于检索主要 Eclipse 版本号的版本，但不引用内部类（您应该避免这样做）：

```
Platform.getBundle(PlatformUI.PLUGIN_ID).getHeaders().get("Bundle-Version"); 
```

# c# - C#：有没有办法在运行时设置列表视图中项目的选定索引？

> ID：817309
> 
> 赞同：1
> 
> 时间：2009-05-03T15:26:21.803
> 
> 标签：c#, .net, winforms

C#：有没有办法在运行时设置列表视图中项目的选定索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T15:29:02.950

在集合中找到[您要](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.items.aspx)选择的项目并[设置其公共属性 Selected = true。](http://msdn.microsoft.com/en-us/library/system.windows.forms.listviewitem.selected.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T15:29:07.430

试试这个

```
listView.SelectedIndices.Clear();
listView.SelectedIndices.Add(someIndex); 
```

# .htaccess - 重定向/重写我的域

> ID：817319
> 
> 赞同：0
> 
> 时间：2009-05-03T15:33:32.770
> 
> 标签：.htaccess, mod-rewrite, redirect, coldfusion, domain-mask

首先，我已经花了过去几个小时试图为此找到解决方案，但除了无效的解决方案之外什么都没有:(

这很简单——我将一个新域的 DNS 指向我当前的主机，但是当我访问新域时，我只是在查看我的原始站点（我通过主机获得的那个）。

假设我的原始站点是“www.originalsite.com” - 我的新域的内容位于“www.originalsite.com/newsite.com/”（包括点）。

现在我只需要让“www.newsite.com”重新定向到它自己的目录并重新编写自己以隐藏目录名称。

所以是的，“www.newsite.com”需要使用“www.originalsite.com/newsite.com/”中的内容，但在网址栏中仍显示为“www.newsite.com”。

为任何输入欢呼 - 非常感谢:)

PS：我正在使用 ColdFusion，之前做了一个有用的重定向，但结果通常是“www.netsite.com/newsite.com/”——这不是我想要的 :)

哦...是的，我希望有一个 .htaccess 修复 :) 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T15:39:09.637

如果您可以完全控制服务器，那么 httpd.conf 中的 VirtualHost 可能是更好的解决方案。例如：

```
<VirtualHost newdomain.com:80>
    ServerName newdomain.com
    ServerAlias www.newdomain.com

    DocumentRoot /path/to/webroot/newsite.com

</VirtualHost> 
```

如果您没有能力直接执行此操作，任何好的主机都会提供“Park Domain”功能，它允许您实现相同的效果 - 指定您的新域并确定您希望它指向的目录 - 通过网页控制面板。

但是，如果您没有能力这样做，这里有一个 .htaccess 的 mod_rewrite 应该可以工作：

```
RewriteEngine On
RewriteCond %{REMOTE_HOST} (www\.)?newdomain\.com
RewriteRule ^(.*)$ /newdomain.com/$1 [L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T18:21:38.933

CrystalTech 最近刚刚安装了一个提供 htaccess 的 mod ...

虽然到目前为止他们只完成了一台服务器:) 所以我被转移到那台服务器上。

我猜问题解决了 - 嘿！

PS谢谢你们的帮助：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T16:54:16.913

您可以使用“隐藏”框架页面进行重定向。这样浏览器地址栏中的 URL 保持不变（没有额外的路径），并且使用子目录仍然很简单。

以下链接针对经典 ASP 进行了描述 - 但转换为任何服务器端脚本语言/平台应该很简单： [http ://www.simpledns.com/kb.aspx?kbid=1151](http://www.simpledns.com/kb.aspx?kbid=1151)

# css - 与常规 CSS 相比，Sass 提供了哪些优势？

> ID：817320
> 
> 赞同：5
> 
> 时间：2009-05-03T15:33:55.000
> 
> 标签：css, syntax, language-features, sass

我正在尝试决定表示层的技术。我听过 Sass 热情地谈论过，但在不知道为什么它比替代方案更好的情况下拒绝学习新东西——在这种情况下是纯 CSS。欢迎任何关于 Sass 的反馈。

编辑：这也是一个很好的讨论：

[SASS：更好、更强大的 CSS](http://www.intridea.com/2009/2/4/sass-the-better-more-powerful-css?blog=company)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T20:37:15.970

我有一个[截屏视频](http://vimeo.com/4335944)，展示了 Sass 和 Compass（基于 Sass 的样式表框架）的运行情况。它长达一个小时，但它展示了 Sass 和 Compass 的工作原理，以及它们如何通过在不影响内容/呈现边界的情况下实现共享实现来实现网站设计的新方法。

# asp.net-mvc - ASP.Net MVC 路由传统 URL 将查询字符串 Id 传递给控制器 操作

> ID：817325
> 
> 赞同：4
> 
> 时间：2009-05-03T15:34:58.007
> 
> 标签：asp.net-mvc, iis-7, asp.net-mvc-routing

我们目前在 IIS6 上运行，但希望尽快迁移到 IIS 7。

我们正在将现有的 Web 表单站点迁移到 ASP.Net MVC。我们有很多遗留页面需要重定向到新的控制器。我遇到了这篇看起来很有趣的文章： [http ://blog.eworldui.net/post/2008/04/ASPNET-MVC---Legacy-Url-Routing.aspx](http://blog.eworldui.net/post/2008/04/ASPNET-MVC---Legacy-Url-Routing.aspx)

所以我想我可以编写自己的路由处理程序，或者在控制器中进行重定向。后者有轻微气味。

但是，我不太确定如何处理来自遗留 url 的查询字符串值，理想情况下我需要将其传递给控制器​​的 Show() 方法。例如：

**旧网址：**

> /Artists/ViewArtist.aspx?Id=4589

**我希望它映射到：**

> ArtistsController 显示动作

实际上，我的 Show 操作采用艺术家姓名，因此我确实希望将用户从 Legacy URL 重定向到 /artists/Madonna

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T23:55:26.510

根据您提到的文章，这些是完成此操作的步骤：

1-您的 LegacyHandler 必须从查询字符串中提取路线值（在这种情况下，它是艺术家的 id）这是执行此操作的代码：

```
 public class LegacyHandler:MvcHandler
    {
        private RequestContext requestContext;
        public LegacyHandler(RequestContext requestContext) : base(requestContext)
        {
            this.requestContext = requestContext;
        }

        protected override void ProcessRequest(HttpContextBase httpContext)
        {
            string redirectActionName = ((LegacyRoute) RequestContext.RouteData.Route).RedirectActionName;

            var queryString = requestContext.HttpContext.Request.QueryString;
            foreach (var key in queryString.AllKeys)
            {
                requestContext.RouteData.Values.Add(key, queryString[key]);
            }

            VirtualPathData path = RouteTable.Routes.GetVirtualPath(requestContext, redirectActionName,
                                                                    requestContext.RouteData.Values);
            httpContext.Response.Status = "301 Moved Permanently";
            httpContext.Response.AppendHeader("Location", path.VirtualPath);

        }
    } 
```

2-您必须将这两个路由添加到 RouteTable 中，您有一个带有 ViewArtist 操作的 ArtistController 接受 int 类型的 id 参数

```
 routes.Add("Legacy", new LegacyRoute("Artists/ViewArtist.aspx", "Artist", new LegacyRouteHandler()));

    routes.MapRoute("Artist", "Artist/ViewArtist/{id}", new
        {
         controller = "Artist",
         action = "ViewArtist",
        }); 
```

现在您可以导航到如下网址：/Artists/ViewArtist.aspx?id=123

您将被重定向到：/Artist/ViewArtist/123

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T20:33:32.533

我一直在努力解决这个问题，直到我明白了这一点。在像 Perhentian 这样的控制器中直接在路由配置中执行此操作要容易得多，至少在我的情况下，因为我们的新 URL 中没有`id`。原因是在控制器中我可以访问我所有的存储库和域对象。为了帮助别人，这就是我所做的：

```
routes.MapRoute(null,
    "product_list.aspx", // Matches legacy product_list.aspx
     new { controller = "Products", action = "Legacy" }
);

public ActionResult Legacy(int catid)
{
    MenuItem menuItem = menu.GetMenuItem(catid);
    return RedirectPermanent(menuItem.Path);
} 
```

`menu`是一个对象，我在其中存储了与菜单条目相关的信息，例如作为菜单条目 URL 的路径。

例如，这重定向自

`/product_list.aspx?catid=50`

到

`/pc-tillbehor/kylning-flaktar/flaktar/170-mm`

请注意，这`RedirectPermanent`是 MVC3+。如果您使用的是旧版本，则需要手动创建 301。

# wpf - WPF：组合框项目背景

> ID：817333
> 
> 赞同：0
> 
> 时间：2009-05-03T15:39:27.840
> 
> 标签：wpf, combobox

我有一个基于 XML 文件数据的 ComboBox：

```
<Root>
<Node Background="Yellow" Foreground="Cyan" Image="1.ico" Property="aaaa" Value="28" />
<Node Background="SlateBlue" Foreground="Black" Image="2.ico" Property="bbbb" Value="2.5" />
<Node Background="Teal" Foreground="Green" Image="3.ico" Property="cccc" Value="4.0" />
<Node Background="Yellow" Foreground="Red" Image="4.ico" Property="dddd" Value="0" /></Root> 
```

因此，在这种情况下，我需要在每个项目都有合适的背景时创建一个复合 ComboBoxItem。

我试图做这样的事情：

```
 <UserControl.Resources>
    <DataTemplate DataType="Node">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" MinWidth="20"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto" MinWidth="20"/>
            </Grid.ColumnDefinitions>
            <Border Background="{Binding XPath=@Background}" Grid.Column="0">
                <Image Source="{Binding XPath=@Image}" 
                       Width="16" 
                       Height="16" 
                       Margin="3" />
            </Border>
            <Border Background="{Binding XPath=@Background}" Grid.Column="1">
                <TextBlock Foreground="{Binding XPath=@Foreground}" 
                           Margin="3"
                           Text="{Binding XPath=@Property}" />
            </Border>
            <Border Background="{Binding XPath=@Background}" Grid.Column="2">
                <TextBlock Foreground="{Binding XPath=@Foreground}" 
                           Margin="3" 
                           FontWeight="Bold"
                           Text="{Binding XPath=@Value}" />
            </Border>
        </Grid>
    </DataTemplate>

    <XmlDataProvider x:Key="xmlNodeList" 
                     Source="/data/Combo.xml" 
                     XPath="/Root/Node"/>
</UserControl.Resources>

<ComboBox Name="myComboBox" 
          ItemsSource="{Binding Source={StaticResource xmlNodeList}}" 
          SelectedIndex="0" /> 
```

但它看起来不太好:-(

你推荐什么解决方案？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T14:37:57.810

一件事是您忘记指出要使用的模板：

```
<DataTemplate x:Key="Node">
      <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" MinWidth="20"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto" MinWidth="20"/>
        </Grid.ColumnDefinitions>
        <Border Background="{Binding XPath=@Background}" Grid.Column="0">
            <Image Source="{Binding XPath=@Image}" 
                   Width="16" 
                   Height="16" 
                   Margin="3" />
        </Border>
        <Border Background="{Binding XPath=@Background}" Grid.Column="1">
            <TextBlock Foreground="{Binding XPath=@Foreground}" 
                       Margin="3"
                       Text="{Binding XPath=@Property}" />
        </Border>
        <Border Background="{Binding XPath=@Background}" Grid.Column="2">
            <TextBlock Foreground="{Binding XPath=@Foreground}" 
                       Margin="3" 
                       FontWeight="Bold"
                       Text="{Binding XPath=@Value}" />
        </Border>
    </Grid>
</DataTemplate> 
```

然后你的组合框：

```
<ComboBox Name="myComboBox" 
          ItemsSource="{Binding Source={StaticResource xmlNodeList}}" 
          ItemTemplate="{StaticResource Node}"
          SelectedIndex="0" /> 
```

“dataType”系统适用于类型化对象，我不确定您是否可以使其适用于 XML 数据。这将起作用。

更新：在您询问之前，您还应该为项目定义一个样式，以便它们覆盖列表的宽度，否则您的列将不均匀：

```
 <ComboBox Name="myComboBox"
                      ItemsSource="{Binding Source={StaticResource xmlNodeList}}"
                      ItemTemplate="{StaticResource Node}"
                      SelectedIndex="0">
                <ComboBox.ItemContainerStyle>
                    <Style TargetType="{x:Type ComboBoxItem}">
                        <Setter Property="HorizontalContentAlignment"
                                Value="Stretch" />
                    </Style>
                </ComboBox.ItemContainerStyle>
            </ComboBox> 
```

这将拉伸各个项目以覆盖列表的整个宽度。

# c++ - 我注意到整数和长整数的大小相同。为什么？

> ID：817337
> 
> 赞同：7
> 
> 时间：2009-05-03T15:42:44.243
> 
> 标签：c++

刚刚在 OSX 上注意到了这一点，我发现它很好奇，因为我预计 long 会比 int 大。有什么充分的理由让它们尺寸相同吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-03T15:47:17.603

这是 C 和 C++ 语言规范中大小定义松散的结果。我相信 C 有特定的最小尺寸，但 C++ 中的唯一规则是：

```
1 == sizeof(char) <= sizeof(short) <= sizeof(int) <= sizeof(long) 
```

此外，`sizeof(int)`并且`sizeof(long)`在所有平台上的大小都不相同。我使用过的每个 64 位平台都`long`符合自然字长，因此 32 位在 32 位架构上，64 位在 64 位架构上。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-03T15:47:47.307

*   `int`本质上*是最方便高效的整数类型*
*   `long`是/曾经是*最大的整数类型*
*   `short`是*最小的整数类型*

如果最长的整数类型也是最有效的，`int`则 与 相同`long`。不久前（想想 32 位之前的版本），`sizeof(int) == sizeof(short)`在许多平台上，因为 16 位是最宽的*自然*整数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-03T15:46:15.860

int 应该是架构的自然字长。在过去，在像最初的 IBM PC 这样的 16 位机器上，int 是 16 位，long 是 32 位。在像 68000 系列这样的 32 位机器上，int 仍然是“自然字长”，现在是 32 位，而 long 仍然是 32 位。随着时间的推移，longs 增长到 64 位，然后我们开始使用英特尔酷睿 2 等 64 位架构，因此我预计 int 迟早会增长到 64 位。

有趣的事实：在我的笔记本电脑上，使用 Core 2 Duo 和 Mac OS X 10.5，int 和 long 都是 32 位。在我的 Linux 机器上，同样带有 Core 2 Duo 和 Ubuntu，int 是 32 位，long 是 64 位。

几年前，我在一次工作面试中被问到，在你将 3 添加到 int 指针之后它会在哪里。我回答“过去现在的 3 倍 sizeof(int)”。面试官向我施压，我说这取决于架构，因为（当时）Windows 使用 16 位整数，但由于我在做 Unix 编程，所以我更习惯于 32 位整数。我没有得到这份工作——我怀疑面试官不喜欢我知道的比他多的事实。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-03T16:42:58.873

正如汤姆正确指出的那样，C++ 中唯一的标准大小是 char，其大小为 1(*)。从那时起，类型之间只有“不小于”关系。大多数人会声称它取决于架构，但这更多是编译器/操作系统的决定。运行 MacOSX、Windows（32/64 位）或 Linux（32/64）的相同硬件对于相同的数据类型将具有不同的大小。同一架构*和*操作系统中的不同编译器可以具有不同的大小。即使是同一硬件上同一操作系统上的完全相同的编译器也可能具有不同的大小，具体取决于编译标志：

```
$ cat test.cpp
#include <iostream>
int main()
{
   std::cout << "sizeof(int): " << sizeof(int) << std::endl;
   std::cout << "sizeof(long): " << sizeof(long) << std::endl;
}
$ g++ -o test32 test.cpp; ./test32
sizeof(int): 4
sizeof(long): 4
$ g++ -o test64 test.cpp -m64; ./test64
sizeof(int): 4
sizeof(long): 8 
```

这是在 MacOSX Leopard 上使用 gcc 编译器的结果。正如您所看到的，硬件和软件是相同的，但在由相同代码生成的两个可执行文件上，大小确实不同。

如果您的代码取决于大小，那么最好不要使用默认类型，而是为编译器使用明确大小的特定类型。或者使用一些提供这种支持的可移植库，例如 ACE：ACE_UINT64 将是 64 位的无符号整数类型，无论编译器/操作系统/架构如何。该库将检测编译器和环境，并在每个平台上使用适当的数据类型。

(*) 我重新检查了 C++ 标准 3.9.1：字符大小应“大到足以存储实现的基本字符集的任何成员”。稍后：5.3.3：*sizeof(char)、sizeof(signed char) 和 sizeof(unsigned char) 是 1*，所以是的，char 的大小是 1 个字节。

在阅读了其他答案后，我发现一个声明 bool 是最小的整数类型。同样，该标准的要求很宽松，仅说明它可以代表*真假*，*但*不能代表它的大小。该标准在该程度上是明确的：5.3.3，脚注：“sizeof(bool) 不需要为 1”。

请注意，出于其他原因，某些 C++ 实现已决定使用大于 1 字节的布尔值。在带有 gcc 的 Apple MacOSX PPC 系统中，`sizeof(bool)==4`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T15:48:19.363

`int`并且`long`并不总是相同的大小，所以不要假设它们在代码中。历史上有 8 位和 16 位，以及更熟悉的 32 位和 64 位架构。对于嵌入式系统，较小的字长仍然很常见。在网上搜索 ILP32 和 LP64 以获得太多信息。

# c# - 手动引发按钮（或任何控件）单击事件。C＃

> ID：817343
> 
> 赞同：11
> 
> 时间：2009-05-03T15:45:33.067
> 
> 标签：c#, .net, winforms, events, click

谁能告诉我如何引发按钮控件的点击事件（或任何事件）。

平台：.net 2.0/3.0/3.5 语言：c# 域：Windows Application、WinForms 等。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-03T15:50:22.057

您可以使用[Button.PerformClick](http://msdn.microsoft.com/en-us/library/system.windows.forms.button.performclick(VS.80).aspx)方法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-03T16:17:16.457

也许解决方案要简单得多：

也许你真的不希望你的代码“点击按钮”。
您是否只想从表单中的另一个位置运行按钮后面的代码？

如果是，请将代码放入单独的方法中（例如“DoActionXXX”），然后从按钮和其他任何需要它的地方调用该方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T16:03:05.180

您还可以查看 Windows 辅助功能或某些 UI 自动化框架，这些框架允许您以编程方式使 UI 控件响应用户手势。如果一个控件没有像 PerformClick 那样以编程方式触发其事件，您可以从该控件派生并公开一个像 PerformnXXX 这样的公共方法，在内部调用该方法时会调用订阅特定事件的事件处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-22T10:35:00.800

按钮单击并新建我的手动窗口 ex.. dital.cs 打开五月窗口

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-22T20:28:32.187

从设计的角度来看，我不认为发送点击事件是最好的方法，只是让你的事件处理程序调用另一个函数。这样，您始终可以访问该功能。

所以 ..

无效 myEventHandler（ObjectwhoSentTheMessage O，事件 e）{

我的其他函数（）；

//如果你愿意，在之后消费事件等

}

# sql - 为语义网络节点推荐 SQL 数据模型？

> ID：817353
> 
> 赞同：0
> 
> 时间：2009-05-03T15:48:58.333
> 
> 标签：sql

我们正在为联邦语义网络（RDF、Protege 等）构建一个基于 RDBMS 的网站。这基本上是一个大型节点集合，每个节点都具有与（和来自）其他节点的大量且不确定的命名关系集。

我的第一个想法是所有节点（名称、描述等）的单个表，每个命名关系加上一个表。那里有更好的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T22:02:27.967

You could optimize the performance by creating 2 rows per relation.

Let's say you have a table Items and a table Relations and that Person A has a relation with Person B. The Relations table has a left and right column, both referring to Items. Now, if you only have one row for this relation, and you want all relations for a certain Item, you would have a query looking like this:

```
SELECT * FROM Relations WHERE LeftItemId = @ItemId OR RightItemId = @ItemId 
```

The OR in this query will ruin your performance! If you would duplicate the row and switch the relation (left becomes right and vice versa) the query looks like this:

```
SELECT * FROM Relations WHERE LeftItemId = @ItemId 
```

With the right index this one will go blazingly fast.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T16:11:11.510

进一步思考，总共可能有两个表，一个用于节点（id、name、description），另一个用于关系（id、name、description、from、to），其中 from 和两个是节点表中的 id（整数） . 还在正确的轨道上吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T15:57:33.320

不，那应该没问题。注意主键和索引，这样性能好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T16:02:35.180

如果您没有用于节点的单个表，则必须定义很多关系表。每个新节点类型都需要一个新的关系表与*每个*旧节点类型。这可能很快就会失控。

所以单张桌子听起来最好。如果您需要某些节点类型的附加字段，您始终可以使用 1:1 关系来扩展它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T21:08:11.687

如果您使用的是 sql server 2008，您可能需要考虑使用新的[HierarchyID 数据类型](http://technet.microsoft.com/en-us/library/bb677290.aspx)来存储您的层次结构。它针对存储进行了优化。

# c# - C#：使用 ListView.SelectedItems[0] 后选择不同项目的问题

> ID：817354
> 
> 赞同：1
> 
> 时间：2009-05-03T15:49:17.660
> 
> 标签：c#, .net, winforms

我有一个问题，我正在使用 listview ListView.SelectedItems[0] 中的方法将当前选定的 ListViewItem 返回到函数中的参数中，该函数在选择时将项目的文本显示到文本框中。此方法设置为 Listview_SelectedIndexChanged 事件。问题是，当我在之前已经选择了一个项目之后现在选择了一个不同的项目时，会出现一个错误，内容为，

ArgumentOutOfRangeException 未处理 InvalidArgument=“0”的值对“索引”无效 参数名称：索引

当我想从列表视图中返回下一个当前选定的项目时，为什么会导致该错误？它仅在先前选择一个项目后选择另一个项目后发生。

这是事件：

```
 private void lvMyItems_SelectedIndexChanged(object sender, EventArgs e)
    {
        // Return currently selected item.
        ShowItem(lvMyItems.SelectedItems[0]); // The error occurs here.
    } 
```

这是它正在调用的方法：

```
 private void ShowItem(ListViewItem MyItem)
    {
        // This method inputs the text and subitem text of my listview item into two textboxes.
        txtItemName.Text = MyItem.Text;
        txtItemNickName.Text = MyItem.SubItems[1].Text;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T15:54:35.933

“无选择”也是一种可能的状态。确保`SelectedItems.Count >= 1`在访问索引 0 处的项目之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-03T11:59:23.893

当我第二次单击某个项目时，我看到此问题发生。

第一次单击工作正常，但第二次单击导致异常。我认为这是因为当我们单击另一个项目时，程序会清除第一个项目的“选择状态”，并将第二个项目标记为“已选中”。在将第二项标记为“已选择”之前，程序将处于 ListView 中没有选择项的情况下，这（很可能）是程序随后生成异常的原因。

所以我们需要检查`SelectedItems.Count >= 1`

# c# - 当“脚本”为假时，NHibernate SchemaExport 不会创建表

> ID：817359
> 
> 赞同：8
> 
> 时间：2009-05-03T15:51:09.340
> 
> 标签：c#, .net, nhibernate

在使用 NHibernate 迈出第一步时，我试图让它从 hbm 文件中自动创建我的表。数据库后端是 SQL Server 2008 Developer Edition。

这是我在 NHibernate 教程中看到的常见示例代码：

```
var cfg = new Configuration();
cfg.Configure();
cfg.AddAssembly(typeof(Posting).Assembly);
new SchemaExport(cfg).Execute(false,true,false,false); 
```

可悲的是，这不起作用。我已将 show_sql 设置为 true，它不会打印出任何语句。查看 SQL 探查器，我看到我的应用程序连接到数据库，但什么也没做。

我可以通过将第一个参数（“脚本”）更改为 true 来解决这个问题：

```
new SchemaExport(cfg).Execute(true,true,false,true); 
```

我不明白为什么。遗憾的是，SchemaExport 的参数没有得到真正的解释（也不是 .Create 和 .Execute 之间的区别），我想知道这个参数的作用，以及为什么不需要它，即在使用 SQL Compact Edition 时（也适用于脚本是假的）

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-03T19:03:27.833

SchemaExport 是 Hbm2Ddl 实用程序的一部分，它真正独立于 NHibernate 功能。它不使用仅在 NHibernate 运行时使用的“show_sql”。

要获取您创建的架构的副本，请使用 .SetOutputFile(filename)

这是我希望创建新数据库时使用的方法。我在 MyDDL.sql 文件中获得了一个格式化的架构，并且数据库是根据架构构建的：

```
 private void BuildSchema(Configuration config)
 {

        new SchemaExport(config)
            .SetOutputFile(_fileName + "MyDDL.sql")
            .Execute(true /*script*/, true /*export to db*/,
                     false /*just drop*/, true /*format schema*/);
 } 
```

SchemaExport.Create 只是 Schema.Execute 的快捷方式，只需要 drop false 和 format true。

```
public void Create(bool script, bool export)
    {
        Execute(script, export, false, true);
    } 
```

# exchange-server-2007 - 是否有将邮件从 Outlook/Outlook Express 上传到 Exchange 2007 的自动程序？

> ID：817368
> 
> 赞同：0
> 
> 时间：2009-05-03T15:55:06.557
> 
> 标签：exchange-server-2007

我正在将一个组织从 pop3 帐户转移到 Microsoft Exchange 2007，我必须将所有用户邮件（主要在 Outlook Express 和一些 Outlook 中）上传到他们的 Exchange 帐户。有人知道从 Outlook Express 和 .pst 文件上传所有邮件和通讯簿的自动或半自动过程，而无需在 Outlook 中配置帐户吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T16:02:50.017

上传本身不是问题，这可以使用 Exchange Web 访问上的 WebDav 协议轻松实现。

但是，从 PST 和 PBX（我认为该文件用于 OE）中获取邮件可能会更加困难，虽然我知道存在一些文件格式描述，但这可能仍然是最困难的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-28T14:35:58.923

您可以通过一些额外的脚本来解决这些问题（地址簿和电子邮件），而且两者都是免费的。

1.  使用[Outlook Express API Standard](http://www.nektra.com/products/oeapi-windows-mail-outlook-express-plugin/download)，您可以快速开发脚本以将电子邮件上传到 Microsoft Exchange。
2.  使用 NKTWAB (LGPL)，您可以检索 WAB 联系人并将其存储在 Exchange 上。
3.  On Outlook 非常简单，因为它有一个 API。

# java - java中的向上转型

> ID：817373
> 
> 赞同：3
> 
> 时间：2009-05-03T15:58:27.810
> 
> 标签：java, casting

在Java中，假设我有3个类，C从B扩展，从A扩展。

```
class X {
   interface A {}
   interface B extends A {}
   interface C extends B {}
   void f(A a) {}

   void test() {
      C c = new C()
      B b = (B) c;

      f(b);
   }
} 
```

如果我做这样的事情，如上所示`test()`：

```
C c = new C()
B b = (B) c;

f(b); 
```

`f()`接受`b`作为类型`C`since`C`并且`B`都从`A`. 我想`f()`接收`b`type`B`而不是 type `C`。

反正有没有强制这种向上转换？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-03T16:04:15.177

`f()`将*始终*收到键入为 A 的内容（尽管在幕后它实际上是 B 或 C，并且可以适当地向下转换）。

您可以定义一个额外的 f() 因此

```
f(B b); 
```

如有必要

```
f(C c); 
```

并且将根据参数的类别调用正确的。即编译器根据参数的类型确定调用哪个函数。这与运行时发生的动态调度（或多态性）不同。

请注意，您在问题中的演员是多余的。你可以写：

```
C c = new C()
B b = c;

f(b); 
```

因为 C 从 B 延伸，所以 C*是*B。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T16:08:42.373

您似乎对编译时类型和运行时类型之间的区别感到困惑。

您正在创建 C 类型的对象（由引用 c 和 b 指向），它将*保持*为 C，因为无法更改对象的运行时类型和行为；通过强制转换，您只能更改其编译时类型，这会影响编译器处理它的方式。

您能否提供更多有关您要解决的具体问题的信息？很可能有一种方法可以通过更改设计来实现您的目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T16:05:20.120

> 我希望 f 接收 b 作为 B 类型而不是 C 类型。

一个`C`是一个`B`是一个`A`。

在 中`f`，`f`只看到`A`其参数的一部分`a`如果`f`调用了在 中覆盖的公共函数`A`，则调用覆盖。`C``C`

这就是虚函数的工作原理。这个想法是，所指的对象实际上是 a `C`，所以它应该表现出`C`行为。如果您想要`B`行为，请传递一个`B`实例，而不是一个`C`实例。

如果“C”和“B”应该具有相同的行为，请不要在`C`.

你为什么要这样做？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T16:06:55.747

你的问题没有意义。“f 接受 b 作为 C 类型”是什么意思？

f 接受 b 作为类型 A，因为方法签名说“A”。如果您在 b 上调用方法，如果 C 覆盖它们，它们将在 C 上调用。但这是 Java 中的标准行为（所有方法都类似于 C++ 中的虚拟方法），没有办法改变它。

也许您可以描述您的实际问题，那么我们也许可以提供帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-04T03:03:47.383

您的问题可以通过了解 REFERENCE 类型和 INSTANCE 类型之间的区别来解决。当您将 C 对象转换为 B 时，您只需更改引用类型 - 对象的实际实例仍然是 C 对象 - 如果您在调试模式下查看对象，这应该非常明显。更改引用类型只会影响编译器处理/感知代码的方式——运行时行为不应该受到影响。对 C 对象的任何方法调用都将始终调用 C 的方法（无论该对象是否已被强制转换为其他对象）。如果您从 B 中重载一个方法并想要调用 B 的方法版本，那么您将需要创建一个 B 实例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T16:10:13.023

您可以将 A 的任何子类作为 f(A a) 的参数传递这一事实是 Java 中的 OO 所固有的，您无法绕过这一点。如果 C 扩展了 A，您*总是*可以在预期 A 的地方使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T18:23:24.077

您可以使用反射来检查参数是否属于 A 类：

```
public void f(A a) {
  if (a.getClass() == A.class) {
    // ok, go on
  }
  else {
    System.err.println("The parameter is not of class A!");
  }
} 
```

不知道这是否是您想要的，但这可能会有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-04T03:35:41.363

您的代码引用 A 的事实并不意味着被指向的对象也是 A。如果它是 aa C，它仍然是 C。源代码中的引用仅限制源代码中的可用方法。强制转换只是必要的，因为有时需要一种不同类型的方法，我们需要欺骗编译器，所以让我们开始使用种姓的方法来输入。如果我们的尝试无效，演员自然会在运行时失败。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-02-20T10:32:50.537

```
In upcasting and downcasting the  object first upcast then downcastenter
class A
{
}
class B extends A
{
}
Class M
{
  psvm(String ar[])
{

   A a1= new B();
   B b2=(B)a1;
} 
```

# pdf - 表单提交后的确认对话框（警报）

> ID：817374
> 
> 赞同：3
> 
> 时间：2009-05-03T15:59:49.260
> 
> 标签：pdf, acrobat

我想知道是否有任何方法可以通知 adobe reader 中的用户已将 pdf 表单提交到服务器？我正在向 php 脚本提交一个普通的 http/html 表单，这没什么大不了的，直截了当，但在提交表单时，文档、论坛等似乎存在一个很大的“黑洞”。

提交表单后没有办法触发javascript警报吗？我不想返回另一个说“谢谢”的 pdf，这有点俗气。我对pdf表单很陌生，所以我猜必须有一种方法可以将FDF返回到其中包含一些执行的javascript的原始文档，例如警报（'谢谢您的反馈！'）..

这应该是直截了当的，我认为 Adob​​e 大肆宣传的 PDF 技术对开发人员来说更加友好和易于访问..

有任何想法吗？？（哦，请不要问我为什么使用 pdf 表单而不是网络，这是来自“The Top”，所以作为开发人员我只需要这样做..）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-01T17:29:07.637

您发布到的服务器脚本必须在 HTTP 标头中回复此内容类型：

'内容类型：应用程序/vnd.fdf'

例如。如果您使用的是 PHP：

```
header('Content-Type: application/vnd.fdf') 
```

然后是相关的bastardized-pdf-javascript-mutant-half-bread，它将触发alert() 对话框。

```
%FDF-1.2
1 0 obj
<<
/FDF
    <<
    /JavaScript 
        << 
        /Doc 2 0 R
        /After (confirmSend();)
        >>
    >>
>>
endobj
2 0 obj
[ 
(confirmSend) 3 0 R
]
endobj
3 0 obj
<<
>>
stream
function confirmSend()
{
app.alert({
    cTitle : 'title of the window',
    cMsg : 'message',
    nIcon : 3 
});
}
endstream
endobj
trailer
<<
/Root 1 0 R
>>
%%EOF 
```

我希望你能收到这条消息，因为我浪费了将近 2 周的时间来寻找解决方案......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-12T06:56:31.623

Thanks for this! I too have been searching for a solution to this for hours! It was extremely frustrating. It seems like overkill to install the FDF Toolkit just to get a simple confirmation dialog box after the PDF has been submitted.

I eventually came up with the following through trial and error (it seems there is absolutely no documentation about this on the net):

```
%FDF-1.2
%âãÏÓ
1 0 obj
<<
/FDF
    <<
    /Status(Thank you. Your details have been submitted and someone will get in touch with regarding your application.)
    >>
>>
endobj
trailer
<</Root 1 0 R>>
%%EOF 
```

The above will present (or should present) a dialog box in Adobe Reader without showing the "Warning: JavaScript Window" warning.

Hope this ends up being useful to someone.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-28T03:27:40.673

I wrangled with this for days, trying to figure out why when I sent the FDF using response.write, it just wouldn't display in Reader. I tried sending both hand-crafted FDF and installing the FDF toolkit to create the FDF response. I was able to create valid FDF, as I was able to open locally in Reader and have the pop-up display correctly but I couldn't get it to work for the life of me sending FDF from my ASP.NET page.

Then inspiration struck. In one of my attempts to send the FDF, I stored the FDF in a file and tried to use a streamreader to pump it into the response. After many unsuccessful attempts to use response.write, on a whim I tried response.redirect to the saved fdf file and it worked. I had previously added fdf as a registered MIME extension for my web site, with application/vnd.fdf as the MIME type. Now the user receives the pop-up after successful submission. The simple solution, in C#, looks like this:

```
Page.Response.Redirect("success.fdf"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T06:00:19.270

经过 3 天的搜索，我设法在答案中发生，在 php 脚本中添加 fdf 文件的标头，在 acrobat 中将“#FDF”添加到 url 的末尾似乎是解决方案；

%FDF-1.2 1 0 obj << /FDF << /JavaScript << /Doc 2 0 R /After (confirmSend();)

> > > > endobj 2 0 obj [ (confirmSend) 3 0 R ] endobj 3 0 obj << > stream function confirmSend() { app.alert("表单提交成功\n感谢您的反馈！", 3) ; } endstream endobj 拖车 << /Root 1 0 R > %%EOF

# javascript - 确保 javascript 徽章/小部件 html 未更改

> ID：817375
> 
> 赞同：1
> 
> 时间：2009-05-03T16:00:06.933
> 
> 标签：javascript, html, widget

我的一个客户想要分发一个 javascript 小部件，人们可以将它放在他们的网站上。然而，他希望确保反向链接完好无损（出于 SEO 目的和使用小部件的部分价格）。所以他要分发的 javascript 可能如下所示：

```
<script id="my-script" src="http://example.com/widget-script.js"></script>
<div style='font-size:10px'><a href='http://www.example.com/backlinkpage.html'>
  Visit Exaxmple.com</a></div> 
```

widget-script.js 会在页面上显示一些 html。但是我们想要确保的是，某些 wiley 网站管理员不会删除反向链接。如果他们这样做，我们可能会显示一条消息，例如“小部件安装不正确”或其他内容。任何想法/想法。

取自[这个问题](https://stackoverflow.com/questions/248351/how-can-i-create-a-javascript-badge-or-widget)的一些代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T16:25:15.843

恐怕没有 100% 的方法可以防止这种情况发生。

您*可以*使用 Javascript 自己插入链接，但就 PageRank 而言，这将是徒劳的。您*可以*为他们提供带有 ID 的链接的 HTML，`mycompanybacklink`并使用 Javascript 检查该元素是否存在。如果没有，请不要显示徽章或其他任何东西。如果是这样，您可以验证链接的 href 是您的网站，并且其文本是您想要的。您必须编辑作为示例发布的 HTML，以便链接位于脚本之前，而不是之后。但是，该元素可能仍然存在，但被其他元素阻止或简单地用 CSS 隐藏。然后你也可以做一些类似于 jQuery 现在用它的[:hidden做的事情](http://docs.jquery.com/Selectors/hidden)选择器：与其单独查看 CSS 属性（这是网站管理员最可能尝试的），您只需查看元素本身或其父元素是否占用了文档中的任何空间。我认为这是通过 offsetWidth 和 offsetHeight 完成的，但我不确定。值得研究，虽然....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T16:19:00.647

如果您想确保小部件的链接始终存在，您可以通过 JavaScript 打印它。但是，我认为搜索引擎不会将其作为反向链接。

我认为您只需要相信您的用户会善意行事并向您展示不修改/删除链接的礼貌。您还需要接受，无论您做什么，坚定的网站管理员都可以在不显示链接的情况下使用您的小部件，有些不可避免地不会，但它们可能是少数（除非您的反向链接*真的*侵入性或令人讨厌的分心）。

网站管理员可以简单地编辑掉任何 JavaScript/HTML 解决方案。如果你真的想防止篡改，你必须在 flash 中制作你的小部件。

# code-snippets - 寻找可以让我将文本片段（代码片段）存储并插入到 Visual Studio 中的工具

> ID：817376
> 
> 赞同：2
> 
> 时间：2009-05-03T16:00:58.227
> 
> 标签：code-snippets

我有一个演示即将推出，我不想在观众面前打字。我想我可以把代码片段放在某个地方，然后在我去的时候把它们放进去。现在我知道我可以为此目的使用记事本（或几乎任何其他文本编辑器），但我觉得那里有更好的东西。有人对我有什么想法吗？

理想情况下，我正在寻找类似于 Visual Studio 工具箱的东西，我可以将文本拖入其中进行设置，然后在需要时将其拖回 IDE。

我尝试将文本拖到工具箱中。它似乎可以工作，但随后我关闭了 Visual Studio，将我的笔记本电脑置于待机状态并重新启动它，一切都消失了！也许它是一个 VS 错误（或 Win 7 错误），或者这可能是它应该如何工作。无论哪种方式，我都在寻找更强大的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T16:06:15.077

您是否尝试过将文本拖到工具箱中？我相信这正是你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T16:15:54.603

以下是有关在 Visual Studio 中定义自己的代码片段的一些信息。

[http://blogs.microsoft.co.il/blogs/gilf/archive/2009/01/17/how-to-write-your-own-code-snippets.aspx](http://blogs.microsoft.co.il/blogs/gilf/archive/2009/01/17/how-to-write-your-own-code-snippets.aspx)

插入代码片段，键入它们的关键字，然后按两次 Tab。如果您不熟悉它们的工作方式，请先尝试使用一些默认设置。键入“prop”，然后按两次 Tab，VS 将为您生成一个 Property stub，或“mbox”生成一个 MessageBox.Show() stub。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T16:15:56.927

使用内置代码片段，用自己的别名创建自己的代码片段怎么样？修改现有的代码片段，并给它一个别名（例如）#demo1

进入你的代码，输入#demo1，按tab键，嘿嘿。

您有自己的文件夹，其中安装了代码片段，并且在 Visual Studio 的每个实例中都会提取其中的任何内容。

看看[这个](http://blogs.microsoft.co.il/blogs/gilf/archive/2009/01/17/how-to-write-your-own-code-snippets.aspx)，还有[这个](http://blogs.msdn.com/tommer/archive/2008/04/25/using-code-snippets-in-visual-studio-2008-video.aspx)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T16:30:01.137

我正在为您的场景使用[http://www.codeplex.com/SnippetDesigner 。](http://www.codeplex.com/SnippetDesigner)它真的很容易使用。玩得开心！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T21:48:42.570

也许这就是你要找的。

[http://www.cshaper.net/blog/new_version_of_clipboard_manager__1_0_0_6_.aspx](http://www.csharper.net/blog/new_version_of_clipboard_manager__1_0_0_6_.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T16:16:21.137

你可以写一个视觉工作室宏来做到这一点。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T16:31:10.900

或者剪辑管理器，例如 MacOSX 上的 jumpcut。必须与windoze类似。[http://jumpcut.sourceforge.net/](http://jumpcut.sourceforge.net/)

# ms-access-2007 - 如何在 SQL 输出中隐藏别名列？

> ID：817377
> 
> 赞同：2
> 
> 时间：2009-05-03T16:01:37.693
> 
> 标签：ms-access-2007

例如，我有以下 SQL 查询（使用 Access 2007）

```
SELECT ID, FirstMaturityDate, PayMentDate,
       iif(PayMentDate>FirstMaturityDate, PayMentDate, FirstMaturityDate)
           as Maxdate
  from Table 1 
```

实际上，我需要别名 Maxdate 进行进一步处理，但我不想将 Maxdate 视为输出中的列。这有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T16:15:13.247

创建一个视图，其中包含除要隐藏的列之外的所有列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T16:25:49.633

您没有指定如何输出数据 - 如果您在表单或列表框中显示它（例如），只是不要显示 Maxdate 列。
（例如，只是不在表单上为其放置一个文本框）

# ajax - 在 RIA 领域有哪些值得关注的好博客？

> ID：817383
> 
> 赞同：2
> 
> 时间：2009-05-03T16:03:40.373
> 
> 标签：ajax, flash, silverlight, user-interface, ria

到目前为止，我找到了 Anthony Franco、Raju Bitter……但我想知道其他人遵循什么：

我想要一些非常好的博客来跟踪 RIA、UI 设计、Ajax、Silverlight、Flash、Flex..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T16:07:17.557

这是您可能想查看的一个：[http ://www.silverlightcream.com](http://www.silverlightcream.com)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T16:11:13.957

您可以查看 ajaxian.com

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T20:15:11.923

很多关于 Flex、Silverlight、WPF、Surface 和 UX 设计的好东西：

[http://www.cynergysystems.com/blogs/](http://www.cynergysystems.com/blogs/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-11T03:30:27.787

也关注项目本身。这是[Appcelerator Titanium 的新闻提要](http://www.appcelerator.com/company/news-press/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T16:08:12.407

对于设计[http://www.smashingmagazine.com/](http://www.smashingmagazine.com/)，有很多教程和信息客户端部分的 web 应用程序（CSS、javascript、HTML 等）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T16:11:45.610

[Feed Squirrel](http://www.feed-squirrel.com/)聚合了各种 RIA 博客。

# arrays - 帮助需要 FORTRAN 中的可分配数组

> ID：817394
> 
> 赞同：1
> 
> 时间：2009-05-03T16:08:34.387
> 
> 标签：arrays, types, fortran, multidimensional-array

我真的在使用 Allocatable 数组时遇到了麻烦。

我必须将文件中的所有信息复制到可分配数组中。文件是这样的：

```
3 
3 5 
2 1 
4 0 
```

3 是点的数量，其他六个数字以 (x, y) 形式显示图形上的点。所以 (3,5), (2, 1), (4,0) 是点。但我有问题将这些数字作为一对。

我尝试编码，这是我的编码：

```
PROGRAM practice

IMPLICIT NONE

INTEGER :: astat, ioStatus
INTEGER :: x, y
INTEGER :: num, code1, code2, code3, code4, code5, code6
! num shows number of location. in this case 3
! code 1 to 6 shows x and y variable. and code1 and 2 have to be paired. 
! as well as this, code 3 and 4, code 5 and 6 have to be paired

! Declare TYPE
! set 1 to 3 show pair of (x, y)
TYPE Location
  INTEGER :: set1, set2, set3
  INTEGER :: num_locations
END TYPE

! Array ()
! for number of locations to visit
TYPE(Location), DIMENSION(:) :: numLocationArray(1000)

! allocatable array
! For locations
TYPE(Location), DIMENSION(:, :) :: LocationArray
ALLOCATABLE :: LocationArray

! allocate LocationArray
ALLOCATE(LocationArray(x, y), STAT = astat)
  IF (astat < 0) STOP "allocate failed"

! open input file to copy info into array
OPEN (UNIT = 10, File ="input.txt", STATUS = "OLD", ACTION = "READ", &
IOSTAT = ioStatus)
IF (ioStatus < 0) STOP "open failed"
! format of the file  
100 FORMAT (I1, /, 2I2, /, 2I2, / 2I2)

! Do loop to set table
DO x = 0, size(LocationArray), 1
   READ (UNIT = 10, FMT = 100, IOSTAT = ioStatus) num, code1, code2, &
   code3, code4, code5, code6
   ! check whether program read file correctly  (option) 
        PRINT *, num, code1, code2, code3, code4, code5, code6

   IF (x == code1) THEN
       DO y = 0, size(LocationArray), 1
          IF (y == code2) THEN
             LocationArray%set1 = LocationArray(x, y)
              ! check whether copied correctly
            PRINT *, LocationArray(x, y)
        PRINT *, LocationArray%set1
      END IF
   END DO
   END IF
 END DO

! ==============
! execution part
! ==============

! instructions:
! use pointer to do excecution

! read allocatable array above
! do excecution (distance) ** do not forget to go back to the original place (0,0)
!                          ** do not forget to try every single possible way
! when get total distance, do distance times 2 and figure out cost
! print all info (cost, distance, and steps)
! (example of output)
!  The minimum cost is    36
!  The distance travelled is    18
!  Step  1: Start at (  0,   0)
!  Step  2: Goes to (  2,   1)
!  Step  3: Goes to (  3,   5)
!  Step  4: Goes to (  4,   0)
!  Step  5: Ends at (  0,   0)

END PROGRAM 
```

该程序不起作用...我有一个错误：

```
LocationArray%set1 = LocationArray(x, y)
Error: Can't convert TYPE(location) to INTEGER(4) at (1) 
```

我很想弄清楚这个错误，但我不知道有没有人对我的编码有任何建议或建议？

原谅我的英语，我是日本人。

如果有人对我的问题有疑问（我的意思是需要更多解释），请告诉我。

谢谢你。乌卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T16:31:49.150

在 type 的定义中`Location`，您已经说过 set1、set2 和 set3 是整数变量，然后您尝试为其分配一个数组。我认为你想要的，因为这些是对的，所以 set1、set2 和 set3 是一个大小为 2 的整数数组。

如果您将`Location`类型更改为：

```
TYPE Location
  INTEGER, DIMENSION(2) :: set1, set2, set3
  INTEGER :: num_locations
END TYPE 
```

此外，读取数据的循环对我来说毫无意义。我想我会把它写成（注意 Fortran 中的数组默认是从 1 开始的，而不是像 C 中那样从零开始）：

```
DO x = 1, size(numLocationArray), 1
   READ (UNIT = 10, FMT = 100, IOSTAT = ioStatus) num, code1, code2, &
   code3, code4, code5, code6
   ! check whether program read file correctly  (option) 
        PRINT *, num, code1, code2, code3, code4, code5, code6

   numLocationArray(x)%num_locations = num
   numLocationArray(x)%set1(0) = code1
   numLocationArray(x)%set1(1) = code2
   numLocationArray(x)%set2(0) = code3
   numLocationArray(x)%set2(1) = code4
   numLocationArray(x)%set3(0) = code5
   numLocationArray(x)%set3(1) = code6
END DO 
```

您显然还需要做一些事情来检测和处理文件结束条件。

如果位置的数量确实是可变的，那么您需要执行以下操作：

```
TYPE Coordinate
   INTEGER :: x
   INTEGER :: y
END TYPE

TYPE Locations
   TYPE(Coordinate), DIMENSION(:), ALLOCATABLE :: location
   INTEGER :: num_locations
END TYPE

TYPE(Location), DIMENSION(:) :: numLocationArray(1000)

! open input file to copy info into array
OPEN (UNIT = 10, File ="input.txt", STATUS = "OLD", ACTION = "READ", &
IOSTAT = ioStatus)
IF (ioStatus < 0) STOP "open failed"
! format of the file  
100 FORMAT (I1 )
200 FORMAT (2I2)

DO n = 1, size(numLocationArray), 1
   READ (UNIT = 10, FMT = 100, IOSTAT = iostatus) num

   numLocationArray(n)%num_locations = num

   ALLOCATE (numLocationArray(n)%locations(num), STAT = astat)
   if (astat < 0) STOP 'allocate failed'

   DO l = 1, num, 1
      READ (UNIT = 10, FMT = 200, IOSTAT = iostatus) x, y
      numLocationArray(n)%locations(l)%x = x
      numLocationArray(n)%locations(l)%y = y
   END DO
END DO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T16:23:15.037

看起来你正试图给一个整数两个整数的值。这就像你尝试做的事情 =（或 var = 5,5）。

# mysql - MySQL 时间戳仅在创建时

> ID：817396
> 
> 赞同：39
> 
> 时间：2009-05-03T16:09:04.243
> 
> 标签：mysql, timestamp

我在 MySQL 5.x（使用 PHP）上使用时间戳来记住事件时间。在开发过程中，我必须使用一个查询来更新表，该查询会更改所有列中的某些内容。然后将时间戳重置为当前时间。

如何仅在插入时而不是在更新或替换时更改时间戳？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-03T16:12:54.593

[这就是你需要知道的一切](https://dev.mysql.com/doc/refman/5.5/en/timestamp-initialization.html)。简而言之，我认为应该这样做：

```
ALTER TABLE `mytable`
CHANGE `mydatefield` `mydatefield`
TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T16:13:03.347

```
ts TIMESTAMP DEFAULT CURRENT_TIMESTAMP 
```

这里有很好[的时间戳](http://dev.mysql.com/doc/refman/5.0/en/timestamp.html)文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T16:11:56.577

您可以为该字段使用[默认值，而不是将其包含在插入或更新查询中。](http://dev.mysql.com/doc/refman/5.0/en/data-type-defaults.html)

# python - Python 的 NetBeans 调试 (GAE)

> ID：817407
> 
> 赞同：2
> 
> 时间：2009-05-03T16:13:11.537
> 
> 标签：python, debugging, google-app-engine, netbeans

dev_appserver 运行时工作正常。但是如果我尝试调试，我发现一个错误是由

```
 __file__ 
```

在 jpydaemon.py 上进行了更改。有没有人成功调试过 NetBeans 上的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-29T20:33:21.457

不，但我有兴趣设置它。您必须以某种方式将 netbeans 调试器附加到端口。这可能会对您有所帮助：这是我正在阅读的关于 java 的示例：http: [//blogs.oracle.com/leonfan/entry/netbeans_development_series_for_google](http://blogs.oracle.com/leonfan/entry/netbeans_development_series_for_google)

引用了我发现与您的问题 dynback “如何调试 Google App Engine 的应用程序”相关的内容

由于我们已经将“测试”操作映射到“调试”，我们应该右键单击项目并选择“测试”进行调试。当系统正在运行并在 Java 远程调试端口 5005 上进行侦听时，在“调试”菜单下附加调试器："

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-11T16:52:31.110

您需要确保调试设置中的端口未在使用中。

我假设您为 Netbeans 安装了 python 插件。

转到您的设置并选择 python，然后选择 Debugger 选项卡。调试器端口设置在那里。

检查您正在使用的端口（在 Windows 中打开命令提示符并运行 NetStat 命令）

如果调试器选项卡中配置的端口正在使用中，则选择一个未使用的端口并重试。

默认端口似乎是 29100，但是当我第一次安装 python 插件时，这不是我在那里看到的设置。当我将它改回未使用的默认值时，它起作用了。我希望这会有所帮助。

# cocoa - 需要帮助解决开窗问题

> ID：817414
> 
> 赞同：-1
> 
> 时间：2009-05-03T16:15:58.113
> 
> 标签：cocoa, preferences

我按照 Cocoa Programming For Mac OS X 教程创建了一个首选项窗口，但返回了 2 个警告，阻止它工作/打开。这是两个警告： [alt text http://snapplr.com/snap/varq](http://snapplr.com/snap/varq)

[替代文字 http://snapplr.com/snap/qmxc](http://snapplr.com/snap/qmxc)

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T16:52:33.530

警告意味着有问题的对象（就编译器所知）没有实现这两种方法。这意味着您的窗口控制器没有从正确的超类继承，或者指向窗口控制器的指针类型错误。这可能是也可能不是您的窗户没有打开的原因，仅从警告中无法判断。

编辑：从您的完整代码看来，您将控制器声明为继承自 NSObject，而不是 NSWindowController。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T16:51:50.740

正如它所说，showWindow 没有在 PreferenceController 类上定义。在 C++ 中，这将是一个错误，因为它是静态类型的并且会说“方法未定义”，但由于 Objective-C 更灵活，这只是一个警告。没有看到代码，很难说出你的错误是什么。

# java - 如何在 java 6 中创建一个临时文件夹？

> ID：817420
> 
> 赞同：9
> 
> 时间：2009-05-03T16:19:24.297
> 
> 标签：java, temporary-directory

> **可能重复：**
> [在 Java 中创建一个临时目录](https://stackoverflow.com/questions/617414/create-a-temporary-directory-in-java)

重复：[stackoverflow.com/questions/375910](https://stackoverflow.com/questions/375910)

有没有办法在java中创建一个临时文件夹？我知道 File 的静态方法 createTempFile，但这只会给我一个临时文件。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-03T16:22:13.307

我从来没有见过一个好的解决方案，但这就是我所做的。

```
File temp = File.createTempFile("folder-name","");
temp.delete();
temp.mkdir(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-03T16:32:48.743

您不能使用 java.io.tmpdir 属性定义的目录有什么原因吗？

IE

```
String dirName = System.getProperty("java.io.tmpdir"); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-03T17:05:13.563

我会在 SO 中查看[这个过去的问题以](https://stackoverflow.com/questions/617414/create-a-temporary-directory-in-java)获得解决方案。还是[这个](https://stackoverflow.com/questions/375910/creating-a-temp-dir-in-java)！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-03T16:29:21.247

我编写自己的实用程序类来创建临时目录并在不再需要它们时处理它们。例如[像这样](http://code.google.com/p/darkstar-contrib/source/browse/trunk/darkstar-integration-test/src/main/java/net/orfjackal/darkstar/integration/util/TempDirectory.java)。

# c++ - 为什么我的矢量代码断言？到底什么是断言？

> ID：817429
> 
> 赞同：3
> 
> 时间：2009-05-03T16:24:39.073
> 
> 标签：c++, vector, assertions

究竟什么是“断言”，或者更具体地说，我如何摆脱错误。当我创建一个指向具有数据成员 int x 的类的指针向量时，然后执行以下操作：

```
for(I=antiviral_data.begin();I<antiviral_data.end();I++)
{
    if((*I)->x>maxx)
    {
        antiviral_data.erase(I);
    }
} 
```

并运行程序，直到 x 大于 maxx 并且我使用 .erase() 之前我没有收到任何错误，此时我收到此错误：

> 调试断言失败！
> 
> 程序：...My Documents\O.exe 文件：...include\vector 行：116
> 
> 表达式：("this->_Has_container()",0)
> 
> 有关您的程序如何导致断言失败的信息，请参阅有关断言的 Visual C++ 文档。
> 
> （按重试调试应用程序）
> 
> [中止][重试][忽略]

另外，如果我尝试使用 cout：

```
cout<<(*antiviral_data.begin())->x<<endl; 
```

我收到此错误：

> 调试断言失败！
> 
> 程序：...My Documents\O.exe 文件：...include\vector 行：98
> 
> 表达式：向量迭代器不可延迟
> 
> 有关您的程序如何导致断言失败的信息，请参阅有关断言的 Visual C++ 文档。
> 
> （按重试调试应用程序）
> 
> [中止][重试][忽略]

有人可以告诉我为什么我不能使用向量中的任何数据，以及如何解决它？

还：antiviral_data 是一个指针向量，只有一个元素：

```
antiviral_data.push_back(new aX1(player.x,player.y,'>')); 
```

如果这有帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-03T16:33:02.143

你得到断言的最可能的原因是你在擦除后增加了 I 。试试这个：

```
for(I=antiviral_data.begin();I!=antiviral_data.end();)
{
    if((*I)->x>maxx) I=antiviral_data.erase(I); else ++I;
} 
```

另请参阅[http://www.cppreference.com/wiki/stl/vector/erase](http://www.cppreference.com/wiki/stl/vector/erase)，在该页面上搜索*无效迭代器*。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-03T16:29:18.283

断言通常是开发人员出于调试和错误控制目的输入的表达式 - 您在代码中放置了不同的“健全性检查”，如果未达到检查，则让程序崩溃。

例如，假设您有一段代码要在某处将两个数字相除。即使您总是期望除以非零，您也可以在除法之前加上 assert，以防参数计算错误。如果断言失败，则意味着在路上的某个地方发生了故障。

断言通常仅出现在代码中的调试版本中（如果您使用 Visual C++，则可以编译以进行调试和发布）。虽然在发布模式下编译会消除结果，但这是一个非常糟糕的主意，因为您仍然会遇到错误并且可能会产生非常糟糕的结果。

在 Vector 实现的某个地方（它是标准的），特别是在第 98 行，有一个断言。如果您有权访问向量代码，请查看断言是什么或调试到该点。这可能表示向量实现或调用向量的代码中存在错误。

您发布的内容为我们提供了一些关于正在发生的事情的提示，但如果您可以粘贴更多程序，包括定义向量的位置，将会很有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T16:38:38.323

问题在于擦除呼叫。您正在遍历容器并同时从中删除元素。执行擦除后，您的迭代器变得无效。如果要从向量中删除特定值的元素，请使用带有 remove_if 算法的擦除。这被称为擦除删除习语，并在 Scott Meyer 的 Effective STL 书中得到了很好的解释。您还可以参考这个问题[从向量中擦除元素以](https://stackoverflow.com/questions/347441/erasing-elements-from-a-vector)获取更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T18:05:21.890

关于什么是断言以及为什么在代码中触发它，您已经有了几个很好的答案。现在，您可能需要考虑使用 STL 算法进行两次擦除。

```
namespace {
   struct exceeds : public std::unary_function< TheUnknownType*, bool >
   {
      exceeds_max( int max ) : maxx( max ) {}
      bool operator()( TheUnknownType* data ) {
         return data->x < max;
      } 
   private:
      int maxx;
   };
}
void your_function()
{
   std::vector< TheUnknownType* >::iterator new_end;
   new_end = std::remove_if( antiviral_data.begin(), antiviral_data.end(), exceeds(maxx) );
   antiviral_data.remove( new_end, antiviral_data.end() );
} 
```

主要优点是擦除向量中的元素是一项昂贵的操作。对于擦除的每个元素，从该位置到向量末尾的所有元素都必须向开头移动一个位置。您擦除的第二个元素将强制从那里开始所有元素的第二次移动...... STL *remove_if*算法只执行一次移动到它们的最终位置，返回一个迭代器*，超过*最后一个未删除元素的元素。然后，您可以执行一个不需要重新定位元素的 std::vector<>::remove 。

# python - 使用 Python 更新 Facebook 状态

> ID：817431
> 
> 赞同：3
> 
> 时间：2009-05-03T16:25:43.877
> 
> 标签：python, facebook

有没有一种简单的方法可以使用 Python 代码更新我的 Facebook 状态（“你在想什么？”框）？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-03T16:31:21.350

查看[PyFacebook](http://github.com/sciyoshi/pyfacebook/tree/master)，它有一个[教程](http://wiki.developers.facebook.com/index.php/PyFacebook_Tutorial)，来自... Facebook！

公然从该页面上的文档中撕下并且未经测试，您可能会做这样的事情：

```
import facebook
fb = facebook.Facebook('YOUR_API_KEY', 'YOUR_SECRET_KEY')
fb.auth.createToken()
fb.login()
fb.auth.getSession()
fb.set_status('Checking out StackOverFlow.com') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T16:29:45.863

Python 的 Facebook 开发者网站是一个很好的起点。您应该能够通过 REST 调用来完成此操作。

[http://wiki.developers.facebook.com/index.php/Python](http://wiki.developers.facebook.com/index.php/Python)

# c# - 在 NHibernate 中使用哪种算法与多对多关系

> ID：817439
> 
> 赞同：2
> 
> 时间：2009-05-03T16:30:22.773
> 
> 标签：c#, nhibernate, many-to-many, design-patterns

我在照片和标签之间有一个多对多的关系：一张照片可以有多个标签，而几张照片可以共享相同的标签。

我有一个循环扫描目录中的照片，然后将它们添加到 NHibernate。在此过程中，一些标签会添加到照片中，例如，当照片拍摄于 2009 年时，会添加 2009 年标签。

Tag 类实现 Equals 和 GetHashCode 并使用 Name 属性作为唯一的签名属性。Photo 和 Tag 都有代理键并且是版本化的。

我有一些类似于以下的代码：

```
public void Import() {
    ...
    foreach (var fileName in fileNames) {
        var photo = new Photo { FileName = fileName };
        AddDefaultTags(_session, photo, fileName);
        _session.Save(photo);
    }
    ...
}

private void AddDefaultTags(…) {
    ...
    var tag =_session.CreateCriteria(typeof(Tag))
                    .Add(Restriction.Eq(“Name”, year.ToString()))
                    .UniqueResult<Tag>();

    if (tag != null) {
        photo.AddTag(tag);
    } else {
        var tag = new Tag { Name = year.ToString()) };
        _session.Save(tag);
        photo.AddTag(tag);
    }
} 
```

我的问题是标签不存在时，例如新年的第一张照片。AddDefaultTags 方法检查标签是否存在于数据库中，然后创建它并将其添加到 NHibernate。添加单张照片时效果很好，但是在新的一年和同一工作单元中导入多张照片时它会失败，因为它仍然不存在于数据库中并再次添加。当完成工作单元时，它会失败，因为它试图在标签表中添加两个同名的条目......

我的问题是如何确保 NHibernate 在上述情况下只尝试在数据库中创建单个标签。我是否需要自己维护一个新添加标签的列表，或者我可以设置映射以使其工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T19:32:49.980

`_session.Flush()`如果您的条件不应返回陈旧数据，则需要运行。或者您应该能够通过将 设置`_session.FlushMode`为 Auto 来正确执行此操作。

使用 FlushMode.Auto，会话将在条件执行之前自动刷新。

编辑：很重要！阅读您显示的代码时，您看起来不像是在为您的工作单元使用事务。我建议将您的工作单元包装在事务中 - 如果您使用的是 NH2.0+，则 FlushMode.Auto 需要这样做！

在此处进一步阅读：[NHibernate ISession Flush：何时何地使用它，为什么？](https://stackoverflow.com/questions/43320/nhibernate-isession-flush-where-and-when-to-use-it-and-why)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T19:25:14.507

如果您希望新标签在每次检查时都在数据库中，您需要在保存后提交事务以将其放在那里。

另一种方法是在处理照片之前将标签读入集合。然后就像您说的那样，您将在本地搜索并根据需要添加新标签。完成文件夹后，您可以提交会话。

您应该发布您的映射，因为我可能没有正确解释您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T08:49:04.013

这是典型的“锁定不存在的东西”问题。我已经多次面对它，但仍然没有一个简单的解决方案。

这是我到目前为止所知道的选项：

*   乐观：对名称有一个唯一的约束，并让其中一个会话在提交时抛出。然后你再试一次。您必须确保在发生另一个错误时不会以无限循环结束。
*   悲观：当你添加一个新的 Tag 时，你会使用 TSQL 锁定整个 Tag 表。
*   .NET 锁定：您使用 .NET 锁同步线程。这仅在您并行事务处于同一进程中时才有效。
*   使用自己的会话创建标签（见下文）

例子：

```
public static Tag CreateTag(string name)
{
  try
  {
    using (ISession session = factors.CreateSession())
    {
      session.BeginTransaction();
      Tag existingTag = session.CreateCriteria(typeof(Tag)) /* .... */
      if (existingtag != null) return existingTag;
      {
        session.Save(new Tag(name));
      }
      session.Transaction.Commit();
    }
  }
  // catch the unique constraint exception you get
  catch (WhatEverException ex)
  {
    // try again
    return CreateTag(name);
  }
} 
```

这看起来很简单，但有一些问题。你总是得到一个标签，要么是现有的，要么是创建的（并立即提交）。但是您获得的标签来自另一个会话，因此它与您的主会话分离。您需要使用级联（您可能不希望这样做）或更新将其附加到您的会话中。

创建标签不再与您的主事务耦合，这是目标，但也意味着回滚您的事务会将所有创建的标签留在数据库中。换句话说：创建标签不再是您交易的一部分。

# silverlight - iPhone 喜欢在 Silverlight ListBox 上滚动

> ID：817441
> 
> 赞同：4
> 
> 时间：2009-05-03T16:31:00.337
> 
> 标签：silverlight, animation, listbox

我需要一个具有类似 iPhone 功能的 Silverlight 列表框。即动画滚动，点击拖动滚动。根据拖动的“速度”，在鼠标向上事件之后，滚动将继续一点。我搜索并发现没有提供此功能的控制供应商。所以问题是我应该如何构建它？我需要一些提示才能开始。

这个问题有两个部分：

第 1 部分，如何获得列表框的动画滚动。

第 2 部分，如何构建“可拖动”滚动，我想我应该在上面放一个画布并跟踪鼠标事件，并模拟一些物理。这里的一些提示会很棒。

谢谢拉尔西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T16:09:49.553

不久前，我做了一个类似这样的控件。我所做的只是在画布内放置一个堆栈面板。只需在鼠标移动（按下鼠标时）上调整整个堆栈面板的 canvas.top。要在 mouseup 后为滚动设置动画，您实际上只需要跟踪移动量并将动画应用于 canvas.top 属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-07T05:30:24.330

这是 WPF 的一个非常好的完整示例，它同时进行拖动滚动和自动轻弹/惯性滚动。我不确定是否需要更改任何内容才能使其在 Silverlight 中工作。

[http://sachabarbs.wordpress.com/2009/12/24/friction-scrolling-now-an-wpf-attached-behaviour-too/](http://sachabarbs.wordpress.com/2009/12/24/friction-scrolling-now-an-wpf-attached-behaviour-too/)

请注意，如果单击捕获鼠标输入的子项（例如按钮），则不能按原样单击并拖动视图。实际上，我最终修改了这个示例，以便在单击子项时仍然可以拖动滚动，同时在不拖动滚动时仍然允许子项接受鼠标输入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T01:12:23.017

这在 Silverlight 3 中比 Silverlight 2 更容易，但在 2 中并非不可能。

这个来自 MIX 09 的视频，[构建 Microsoft Silverlight 控件](http://videos.visitmix.com/MIX09/T16F)，应该对您有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-13T20:40:46.817

Sacha Barber 网站上的另一篇文章：

[http://sachabarber.net/?p=481](http://sachabarber.net/?p=481)

Jeremiah Morrill 分享了在自定义 ContentControl（使用包含的 ScrollViewer 模板化）中实现动画滚动的代码

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-05T22:50:26.430

```
<ScrollViewer x:Name="sv1" Width="500" Height="285">
   <StackPanel x:Name="sp1" Width="450" Height="285">
   </StackPanel>
</ScrollViewer> 
```

通过设置 pos。和否定。滚动查看器内的堆栈面板的边距，您可以创建滚动效果。

```
onScroll_Up()
{
  //Change this based on your scrollviewer dimension
  if (this.sv1.ScrollableHeight < 300)
  {
    Thickness thickness = this.sp1.Margin;
    thickness.Top += 50;
    this.sv1.SetValue(StackPanel.MarginProperty, thickness);
  }   
}

onScroll_Down()
{
  if (this.sv1.ScrollableHeight > 1)
  {
    Thickness thickness = this.sp1.Margin;
    thickness.Top += -50;
    this.sv1.SetValue(StackPanel.MarginProperty, thickness);
  }
} 
```

# javascript - 估计可用浏览器区域的好方法

> ID：817446
> 
> 赞同：1
> 
> 时间：2009-05-03T16:32:05.890
> 
> 标签：javascript, html, css

我试图找出估计浏览器可视区域最大尺寸的最佳方法。即屏幕尺寸减去工具栏、书签等。显然，当窗口未最大化并且由于人们确实使用不同的浏览器这一事实时，它不会是完美的 - 我只是在这里寻找一个好的估计。

目的是然后找出图像的最大尺寸。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T17:02:34.443

你也可以在任何东西上使用[jQuery 的](http://docs.jquery.com/CSS/width) `width()`函数：`$(window).width()`. 请记住，如果调整窗口大小，这将改变并且可能会通过它最初基于的任何布局。您可以[监视该事件](http://docs.jquery.com/Events/resize)，但如果您正在做复杂的事情，这可能会损害性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T16:56:44.927

在 Firefox 中，您可以使用此代码

```
<html>

<body>
<script type="text/javascript">
document.write("<p>Width: " + window.innerWidth + "</p>")
document.write("<p>Height: " + window.innerHeight + "</p>")
</script>
</body>

</html> 
```

对于 IE，您可以尝试 document.body.offsetWidth 和 document.body.offsetHeight 属性。

屏幕对象将获得屏幕属性（它可能会有所帮助），请在此处检查其属性：[链接文本](http://www.w3schools.com/htmldom/dom_obj_screen.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T20:02:08.257

用于确定视口的跨浏览器功能。返回一个包含浏览器屏幕宽度、高度、左侧和顶部位置的数组。

```
function getViewport () {
         var iWidth,iHeight,iTop,iLeft,
             w = window, d = document;
          iWidth  = w.innerWidth || d.documentElement.clientWidth 
                    || d.body.clientWidth || 0;
          iHeight = w.innerHeight || d.documentElement.clientHeight 
                    || d.body.clientHeight || 0;
          iTop    = w.pageYOffset || d.body.scrollTop 
                    || d.documentElement.scrollTop || 0;
          iLeft   = w.pageXOffset || d.body.scrollLeft 
                    || d.documentElement.scrollLeft || 0;
          return [iWidth,iHeight,iLeft,iTop];
} 
```

# haskell - Haskell 如何知道您指的是哪个类型类实例？

> ID：817466
> 
> 赞同：4
> 
> 时间：2009-05-03T16:47:15.103
> 
> 标签：haskell, type-inference, typeclass

这个问题是在阅读优秀的 Learn You a Haskell 中关于应用函子的新章节时出现的。

作为 Maybe 实例定义的一部分，Applicative 类型类具有：

```
pure = Just 
```

如果我只是去 GHCi 并导入 Control.Applicative，然后执行以下操作：

```
pure (3+) 
```

我什么都不懂（有道理）。但是如果我在表达式的一部分中使用它：

```
pure (3+) <*> Just 4 
```

我只得到 7。我想这也不足为奇，但我认为类型类如何工作的一些不可或缺的东西，我认为`pure`这里的调用没有歧义。

如果我的困惑是有道理的，谁能详细解释发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T18:07:22.290

这只是类型推断。`(<*>)`运算符要求两个参数使用相同的实例`Applicative`。右边是 a `Maybe`，所以左边也必须是 a `Maybe`。这就是它如何确定这里使用了哪个实例。您可以通过键入来查看解释器中任何表达式的类型`:t expression`，也许如果您只检查每个子表达式并查看推断的类型，您会更好地了解正在发生的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T23:27:20.197

值得看看编译器推断的类型`pure (3+)`：

```
Prelude Control.Applicative> :t pure (3+)
pure (3+) :: (Num a, Applicative f) => f (a -> a) 
```

该术语的类型被重载，关于数值类和应用类的决定延迟到以后。但是您可以使用注释强制特定类型，例如：

```
*Showfun Control.Applicative> pure (3+) :: Maybe (Double -> Double)
Just <function> 
```

（这是有效的，因为`Showfun`有一个将函数值打印为的实例声明`<function>`。）

这只是编译器何时积累了足够的信息来做出决定的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T18:36:15.590

为了扩展 newacct 的答案，如果没有足够的信息来推断实际类型，编译器可能（在某些情况下）尝试选择默认类型，仅限于那些满足相关类型约束的类型。在这种情况下，对于一些难以确定的 Num => n 实例，推断的类型是 IO (n -> n)。GHCi 然后评估它并丢弃返回值，没有明显的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T23:34:20.570

[这是关于类型推断](https://stackoverflow.com/questions/415532/implementing-type-inference)的一个有趣的SO 线程。不是特定于 Haskell 的，但是有很多关于函数式语言类型推断的好链接和资料可供阅读。

# objective-c - 如何在 Objective-C 中创建和使用队列？

> ID：817469
> 
> 赞同：107
> 
> 时间：2009-05-03T16:50:20.603
> 
> 标签：objective-c, cocoa, data-structures, queue

我想在我的 Objective-C 程序中使用队列数据结构。在 C++ 中，我会使用 STL 队列。Objective-C 中的等效数据结构是什么？如何推送/弹出项目？

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2009-06-01T20:03:30.247

Ben 的版本是堆栈而不是队列，所以我对其进行了一些调整：

**NSMutableArray+QueueAdditions.h**

```
@interface NSMutableArray (QueueAdditions)
- (id) dequeue;
- (void) enqueue:(id)obj;
@end 
```

**NSMutableArray+QueueAdditions.m**

```
@implementation NSMutableArray (QueueAdditions)
// Queues are first-in-first-out, so we remove objects from the head
- (id) dequeue {
    // if ([self count] == 0) return nil; // to avoid raising exception (Quinn)
    id headObject = [self objectAtIndex:0];
    if (headObject != nil) {
        [[headObject retain] autorelease]; // so it isn't dealloc'ed on remove
        [self removeObjectAtIndex:0];
    }
    return headObject;
}

// Add to the tail of the queue (no one likes it when people cut in line!)
- (void) enqueue:(id)anObject {
    [self addObject:anObject];
    //this method automatically adds to the end of the array
}
@end 
```

只需将 .h 文件导入您想使用新方法的任何位置，然后像调用任何其他 NSMutableArray 方法一样调用它们。

祝你好运，继续编码！

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-06-10T05:06:20.337

我不会说使用 NSMutableArray 一定是**最好**的解决方案，特别是如果您要添加带有类别的方法，因为如果方法名称发生冲突，它们可能会导致脆弱性。对于 quick-n-dirty 队列，我将使用在可变数组末尾添加和删除的方法。但是，如果您打算重用队列，或者如果您希望您的代码更具可读性和不言而喻，那么您可能想要一个专用的队列类。

Cocoa 没有内置的，但还有其他选项，您也不必从头开始编写。对于仅从末端添加和删除的真正队列，循环缓冲区数组是一种非常快速的实现。查看[CHDataStructures.framework](http://cocoaheads.byu.edu/code/CHDataStructures)，这是我一直在研究的 Objective-C 库/框架。它有多种队列实现，以及堆栈、双端队列、排序集等。对于您的目的，[CHCircularBufferQueue](http://dysart.cs.byu.edu/CHDataStructures/interface_c_h_circular_buffer_queue.html)比使用 NSMutableArray 更快（即可以通过基准测试证明）和更具可读性（诚然是主观的）。

使用原生 Objective-C 类而不是 C++ STL 类的一大优势是它与 Cocoa 代码无缝集成，并且在编码/解码（序列化）方面工作得更好。它还可以完美地与垃圾收集和快速枚举配合使用（两者都存在于 10.5+ 中，但只有后者在 iPhone 上）并且您不必担心什么是 Objective-C 对象以及什么是 C++ 对象。

最后，虽然 NSMutableArray 在从任一端添加和删除时优于标准 C 数组，但它也不是队列的最快解决方案。对于大多数应用程序来说它是令人满意的，但是如果您需要速度，循环缓冲区（或在某些情况下为保持高速缓存行热而优化的链表）可以轻松击败 NSMutableArray。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-05-03T17:07:08.177

据我所知，Objective-C 不提供 Queue 数据结构。您最好的选择是创建一个`NSMutableArray`, 然后使用`[array lastObject]`,`[array removeLastObject]`来获取项目，然后`[array insertObject:o atIndex:0]`...

如果您经常这样做，您可能希望创建一个 Objective-C 类别来扩展`NSMutableArray`该类的功能。类别允许您动态地将函数添加到现有类（即使是那些您没有源代码的类） - 您可以像这样创建一个队列：

**（注意：此代码实际上是针对堆栈，而不是队列。请参阅下面的注释）**

```
@interface NSMutableArray (QueueAdditions)

- (id)pop;
- (void)push:(id)obj;

@end

@implementation NSMutableArray (QueueAdditions)

- (id)pop
{
    // nil if [self count] == 0
    id lastObject = [[[self lastObject] retain] autorelease];
    if (lastObject)
        [self removeLastObject];
    return lastObject;
}

- (void)push:(id)obj
{
     [self addObject: obj];
}

@end 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-05-03T17:03:04.893

没有真正的队列集合类，但 NSMutableArray 可以有效地用于同样的事情。如果需要，您可以定义一个[类别](http://macdevelopertips.com/objective-c/objective-c-categories.html)以添加弹出/推送方法以方便使用。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-05-06T06:48:50.353

是的，使用 NSMutableArray。NSMutableArray 实际上[实现](http://www.opensource.apple.com/darwinsource/10.5.6/CF-476.17/CFStorage.c)为 2-3 树；您通常不需要关心在任意索引处从 NSMutableArray 添加或删除对象的性能特征。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-11-10T00:49:22.130

re:Wolfcow -- 这是 Wolfcow 的 dequeue 方法的更正实现

```
- (id)dequeue {
    if ([self count] == 0) {
        return nil;
    }
    id queueObject = [[[self objectAtIndex:0] retain] autorelease];
    [self removeObjectAtIndex:0];
    return queueObject;
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-07-07T23:59:15.130

使用类别的解决方案`NSMutableArray`不是真正的队列，因为`NSMutableArray`公开了作为队列超集的操作。例如，您不应该被允许从队列中间删除一个项目（因为这些类别解决方案仍然允许您这样做）。最好封装功能，这是面向对象设计的主要原则。

标准队列.h

```
#import <Foundation/Foundation.h>

@interface StdQueue : NSObject

@property(nonatomic, readonly) BOOL empty;
@property(nonatomic, readonly) NSUInteger size;
@property(nonatomic, readonly) id front;
@property(nonatomic, readonly) id back;

- (void)enqueue:(id)object;
- (id)dequeue;

@end 
```

标准队列.m

```
#import "StdQueue.h"

@interface StdQueue ()

@property(nonatomic, strong) NSMutableArray* storage;

@end

@implementation StdQueue

#pragma mark NSObject

- (id)init
{
    if (self = [super init]) {
        _storage = [NSMutableArray array];
    }
    return self;
}

#pragma mark StdQueue

- (BOOL)empty
{
    return self.storage.count == 0;
}

- (NSUInteger)size
{
    return self.storage.count;
}

- (id)front
{
    return self.storage.firstObject;
}

- (id)back
{
    return self.storage.lastObject;
}

- (void)enqueue:(id)object
{
    [self.storage addObject:object];
}

- (id)dequeue
{
    id firstObject = nil;
    if (!self.empty) {
        firstObject  = self.storage.firstObject;
        [self.storage removeObjectAtIndex:0];
    }
    return firstObject;
}

@end 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-08-30T21:22:18.537

这是我的实现，希望对您有所帮助。

有点简约，因此您必须通过在弹出时保存新磁头并丢弃旧磁头来跟踪磁头

```
@interface Queue : NSObject {
    id _data;
    Queue *tail;
}

-(id) initWithData:(id) data;
-(id) getData;

-(Queue*) pop;
-(void) push:(id) data;

@end

#import "Queue.h"

@implementation Queue

-(id) initWithData:(id) data {
    if (self=[super init]) {
        _data = data;
        [_data retain];
    }
    return self;
}
-(id) getData {
    return _data;
}

-(Queue*) pop {
    return tail;
}
-(void) push:(id) data{
    if (tail) {
        [tail push:data];
    } else {
        tail = [[Queue alloc]initWithData:data];
    }
}

-(void) dealloc {
    if (_data) {
        [_data release];
    }
    [super release];
}

@end 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-02T09:28:57.350

有什么特殊原因不能只使用 STL 队列吗？Objective C++ 是 C++ 的超集（只需使用 .mm 作为扩展名而不是 .m 以使用 Objective C++ 而不是 Objective C）。然后您可以使用 STL 或任何其他 C++ 代码。

将 STL 队列/向量/列表等与 Objective C 对象一起使用的一个问题是它们通常不支持保留/释放/自动释放内存管理。这可以通过 C++ 智能指针容器类轻松解决，该容器类在构造时保留其 Objective C 对象，并在销毁时释放它。根据您在 STL 队列中放入的内容，这通常不是必需的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-03T17:04:30.820

使用 NSMutableArray。

# oracle - oracle 存储过程（带游标）如何工作？

> ID：817472
> 
> 赞同：1
> 
> 时间：2009-05-03T16:51:25.953
> 
> 标签：oracle, stored-procedures, cursors, fetch

我有以下 oracle 存储过程

```
 CREATE OR REPLACE
PROCEDURE getRejectedReasons
  (
    p_cursor IN OUT SYS_REFCURSOR)
AS
BEGIN
  OPEN p_cursor FOR SELECT * FROM reasons_for_rejection;
END; 
```

但是，当我在 sql-developer 中运行这个存储过程时，我什么也看不到。我只是看到这样的事情：

```
Connecting to the database oracleLocal.
Process exited.
Disconnecting from the database oracleLocal. 
```

我来自 MS sql 服务器，并且习惯于在运行这样的存储过程时看到实际结果。这个存储过程是否因为我使用游标而没有返回结果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T20:46:39.537

存储过程正在返回一些东西，只是你没有对结果做任何事情。

您只需在 SQLDeveloper 中运行以下脚本即可完成此操作：

```
 VARIABLE csr REFCURSOR;
EXEC getRejectedReasons(:csr); -- the colon identifies the parameter as a variable
PRINT csr; 
```

另一种方法是获取每一行并进行某种处理：

```
 DECLARE
  -- sys_refcursor is weakly typed
  refcsr  SYS_REFCURSOR;
  -- define a record so we can reference the fields
  rej_rec Reasons_for_Rejection%ROWTYPE;
BEGIN

  getRejectedReasons(refcsr);

   -- loop through the results  
   LOOP
      -- gets one row at a time
      FETCH refcsr INTO rej_rec;
      -- if the fetch doesn't find any more rows exit the loop
      EXIT WHEN refcsr%NOTFOUND;
      -- Do something here.  
      -- For example : DBMS_OUTPUT.PUT_LINE(rej_rec.reason_desc);
    END LOOP;

END; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T16:54:04.777

你打开了光标。您没有从中选择任何内容、更新或推进它。

All open 确实有效地将匹配的行选择到临时内存中，因此您可以逐行推进游标。你没有这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T17:32:33.217

Oracle 和 SQL Server 之间的区别之一是后者自然地返回结果集。顺便说一句，我会使用一个函数。

在 Oracle 中，函数通常返回单个元素。光标稍后出现。

有一些在线文档可以帮助您了解 refcursor 绑定变量的使用。这是 SQL*Plus 的一个例子：

[http://download.oracle.com/docs/cd/B19306_01/server.102/b14357/ch5.htm#sthref1122](http://download.oracle.com/docs/cd/B19306_01/server.102/b14357/ch5.htm#sthref1122)

我认为在 SQL Developer 中，您可以在开启自动打印的情况下做同样的事情，尽管我还没有测试过。

发现一个博客也讨论了类似的事情：

[http://vadimtropashko.wordpress.com/cursors/](http://vadimtropashko.wordpress.com/cursors/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-03T17:34:26.520

埃塔：好的。忽略我写的。听听别人的。显然这是错误的，因为我投了反对票。

tpdi 说的是对的。声明光标后，您必须对其进行处理。

这是在嵌套循环中使用两个游标的示例

```
 PROCEDURE update_insert_tree (exid_in IN NUMBER, outvar_out OUT VARCHAR2)
   IS
      nxtid         NUMBER;
      phaseid       NUMBER;
      rowcounter1   NUMBER;
   BEGIN
      rowcounter1 := 0;
      outvar_out := 0;

      FOR acur IN (SELECT dept_exercise_id, phase
                     FROM ep_dept_exercise
                    WHERE exercise_id = exid_in)
      LOOP

         <<dept_loop>>
         FOR thecur IN (SELECT document_name, thelevel, sortnum, type_flag,
                               ex_save_id
                          FROM ep_exercise_save
                         WHERE exercise_id = exid_in)
         LOOP
            phaseid := acur.phase;

            IF phaseid = 0
            THEN
               phaseid := 10;

               UPDATE ep_dept_exercise
                  SET phase = 10
                WHERE dept_exercise_id = acur.dept_exercise_id;
            END IF;

            <<doc_loop>> 
```

# expression-blend - 为什么我不能在 Expression Blend 3 中添加 XML 数据源？

> ID：817473
> 
> 赞同：1
> 
> 时间：2009-05-03T16:51:36.107
> 
> 标签：expression-blend, expression-blend-3

*   我正在使用 Expression Blend 3
*   我点击“添加实时数据源”，“添加新的 xml 数据源”
*   复制一个 URL
*   但确定按钮保持空白

添加本地 XML 数据源文件可以正常工作

**如何在表达式混合 3 中添加 URL 数据源？**

这对其他人有用吗？

**问题出在我在任何计算机上安装的每台 Expression Blend 3 上，似乎在测试版中很容易被关闭。**

[替代文字 http://tanguay.info/web/external/blenddataokbutton.png](http://tanguay.info/web/external/blenddataokbutton.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T17:19:30.690

我刚刚尝试使用混合 1.0。此版本还有其他选项，例如“推断 xml 架构”。

我的猜测是在更高版本中添加了一些检查以确保指向的文件具有扩展名。

我的建议是直接编辑 xaml。请注意，这是 blend 1.0 中的旧 XAML：

```
<Window.Resources>
    <XmlDataProvider x:Key="rssDS" d:IsDataSource="True" Source="http://www.tanguay.info/web/rss/"/>
</Window.Resources> 
```

希望有帮助，让我知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-09-15T01:00:39.420

当我尝试从 XML 文件重新导入示例数据时遇到了同样的问题。数据源已经存在，或者至少 Blend 认为它仍然存在。如果您将鼠标悬停在“数据源名称”文本框上，您应该会看到一条警告。

从“数据”选项卡中删除数据源。
删除项目视图中的文件夹。
重建项目。
如果这不能清除它，请重新启动 Blend。

这就是我必须做的。我有 Expression 4.0 Ultimate。

# objective-c - 如何在 Objective-C 中对集合进行排序？

> ID：817480
> 
> 赞同：1
> 
> 时间：2009-05-03T16:53:35.463
> 
> 标签：objective-c, algorithm, sorting

我的 Objective-C 程序中有一个整数数组。我想对其进行排序（升序或降序，没关系）。在 C++ 中，我会使用 STL 算法库中的排序算法。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T16:59:15.857

“Cocoa”方式是创建 NSNumber 对象，将它们添加到 NSArray，然后使用该`sortUsingSelector:@selector(compare:)`方法（或其他 NSArray 排序方法之一）。

如果要创建原始 NSInteger (int) 值的 C 数组，可以使用 C 的内置[`qsort(…)`](http://www.cppreference.com/wiki/c/other/qsort)函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T17:13:22.310

尽管已经回答了这个问题，但我想补充一点，您还可以在 Objective-C++ 和 iPhone 编程中使用 STL 集合。[这](https://stackoverflow.com/questions/766581/iphone-development-what-kind-of-data-structures-are-available/)是之前关于该主题的讨论的链接。

# linux - 编译包括非内核头文件的 linux 内核（2.6）模块

> ID：817487
> 
> 赞同：7
> 
> 时间：2009-05-03T16:56:36.750
> 
> 标签：linux, makefile, linux-kernel, static-libraries, kernel-module

是否可以编译包含非内核定义的功能的 linux 内核（2.6）模块？

例如：

* * *

内核模块.h

```
#include <linux/init.h>
#include <linux/module.h>
#include <linux/kernel.h>   // printk()
// ...
#include <openssl/sha.h>
// ... 
```

* * *

生成文件

```
obj-m := kernelmodule.o
all:
    $(MAKE) -C /lib/modules/`uname -r`/build M=`pwd` modules

clean:
    $(MAKE) -C /lib/modules/`uname -r`/build M=`pwd` clean
    $(RM) Module.markers modules.order 
```

我编写并尝试编译的内核模块包含许多 openssl 包含文件中的功能。

上面介绍的标准 makefile 不允许包含在 linux 头文件之外。是否可以包含此功能，如果可以，请您指出正确的方向。

谢谢，迈克

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-03T21:46:44.323

内核不能使用用户空间代码并且必须独立（即完全自包含，没有库），因此它不选择标准头文件。

目前尚不清楚尝试获取用户空间标头有什么好处。如果其中有一些可以使用的东西（常量，一些宏可能提供它们不调用任何用户空间函数），那么最好复制它们并仅包含您需要的内核兼容部分。

无法将内核与为用户空间使用而设计的库链接——即使它们不进行任何操作系统调用——因为内核中的链接环境无法获取它们。

相反，重新编译要在内核中使用的任何函数（假设它们不进行任何操作系统或库调用 - 例如 malloc - 在这种情况下无论如何都需要修改它们）。将它们合并到您自己的库中以在您的内核模块中使用。

* * *

无论如何，最新版本的 linux 都包含加密功能，包括各种 SHA 哈希 - 也许您可以使用其中之一。

* * *

另一个想法是停止尝试在内核空间中进行加密并将代码移动到用户空间。用户空间代码更容易编写/调试/维护等。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-04T07:49:15.497

我已经编写了一些用户空间代码并将其转换为在内核空间中工作（即使用 kmalloc() 等），这并不难。但是，您仅限于内核对 C 的理解，而不是用户空间，这略有不同.. 尤其是对于各种标准 int 类型。

仅仅链接到用户空间 DSO 是不可能的——Linux 内核是单片的，完全自包含的。正如其他人所指出的，它不使用用户空间 libc、库或其他位。

9/10 次，你会在内核的*某个地方*找到你需要的东西。很可能其他人遇到了与您相同的需求并在某些模块中编写了一些静态函数来执行您想要的操作..只需抓住这些并重新使用它们。

正如其他人所说，在加密的情况下，只需使用内核中的内容。需要注意的一件事是，您需要在 kconfig 中启用它们，这可能会发生也可能不会发生，具体取决于用户在构建它时选择的内容。因此，请注意依赖关系并明确表示，您可能必须破解 kconfig 中的一些条目，这些条目还会在选择模块时选择您想要的加密 API。当用树构建时，这样做可能会有点痛苦。

所以一方面我们“在增加整体膨胀的同时复制和重命名东西”，另一方面你“告诉人们他们必须拥有完整的内核源代码”。这是单片内核带来的怪癖之一。

使用微内核，几乎所有东西都在用户空间中运行，不用担心链接到某个驱动程序的 DSO ......这不是问题。请不要将该声明作为在评论中重新启动内核设计理念的提示，这不在此问题的范围内。

# c++ - C++ Exp 与 Log：哪个更快？

> ID：817491
> 
> 赞同：11
> 
> 时间：2009-05-03T16:59:10.787
> 
> 标签：c++, math, performance

我有一个 C++ 应用程序，我需要在其中比较两个值并决定哪个更大。唯一的复杂之处是一个数字在日志空间中表示，另一个则不是。例如：

```
double log_num_1 = log(1.23);
double num_2 = 1.24; 
```

如果我想比较`num_1`and `num_2`，我必须使用`log()`or `exp()`，我想知道一个是否比另一个更容易计算（即通常运行时间更短）。您可以假设我正在使用标准`cmath`库。

换句话说，以下在语义上是等价的，所以哪个更快：

```
if(exp(log_num_1) > num_2)) cout << "num_1 is greater"; 
```

或者

```
if(log_num_1 > log(num_2)) cout << "num_1 is greater"; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-03T17:45:50.783

AFAIK算法，复杂性是相同的，差异应该只是一个（希望可以忽略不计）常数。因此，我会使用`exp(a) > b`, 仅仅是因为它不会因无效输入而中断。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-03T17:09:39.810

你*真的*需要知道吗？这会占用你运行时间的很大一部分吗？你怎么知道的？

更糟糕的是，它可能依赖于平台。然后呢？

所以当然，如果你在乎的话，可以测试一下，但是花很多时间在微优化上苦恼通常是个坏主意。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-03T17:19:26.273

**编辑：修改代码以避免 exp() 溢出。这导致两个函数之间的差距大大缩小。谢谢，弗雷德里克。**

代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int main(int argc, char **argv)
{
    if (argc != 3) {
        return 0;
    }

    int type = atoi(argv[1]);
    int count = atoi(argv[2]);

    double (*func)(double) = type == 1 ? exp : log;

    int i;
    for (i = 0; i < count; i++) {
        func(i%100);
    }

    return 0;
} 
```

（编译使用：）

```
emil@lanfear /home/emil/dev $ gcc -o test_log test_log.c -lm 
```

结果似乎相当确凿：

```
emil@lanfear /home/emil/dev $ time ./test_log 0 10000000

real    0m2.307s
user    0m2.040s
sys     0m0.000s

emil@lanfear /home/emil/dev $ time ./test_log 1 10000000

real    0m2.639s
user    0m2.632s
sys     0m0.004s 
```

有点令人惊讶的日志似乎是更快的日志。

**纯猜测：**

也许底层的数学[泰勒级数](http://en.wikipedia.org/wiki/Taylor_series)对 log 或其他东西收敛得更快？实际上，在我看来，[自然对数](http://en.wikipedia.org/wiki/Natural_logarithm#Derivative.2C_Taylor_series)比[指数函数](http://en.wikipedia.org/wiki/Exponential_function#Formal_definition)更容易计算：

```
ln(1+x) = x - x^2/2 + x^3/3 ...
e^x = 1 + x + x^2/2! + x^3/3! + x^4/4! ... 
```

但是，不确定 c 库函数是否会这样做。但这似乎并非完全不可能。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-04T20:01:08.093

由于您正在使用值 << 1，请注意 x-1 > log(x) for x<1，这意味着 x-1 < log(y) 意味着 log(x) < log(y)，这已经无需使用 log 或 exp 即可处理 1/e ~ 37% 的情况。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-03T17:05:24.670

python中的一些快速测试（使用c进行数学）：

```
$ time python -c "from math import log, exp;[exp(100) for i in xrange(1000000)]"

real    0m0.590s
user    0m0.520s
sys     0m0.042s

$ time python -c "from math import log, exp;[log(100) for i in xrange(1000000)]"

real    0m0.685s
user    0m0.558s
sys     0m0.044s 
```

表示日志稍慢

***编辑：编译器似乎正在优化 C 函数，所以循环是占用时间的***

有趣的是，在 C 语言中，它们似乎具有相同的速度（可能是由于 Mark 在评论中提到的原因）

```
#include <math.h>

void runExp(int n) {
    int i;
    for (i=0; i<n; i++) {
        exp(100);
    }
}

void runLog(int n) {
    int i;
    for (i=0; i<n; i++) {
        log(100);
    }
}

int main(int argc, char **argv) {
    if (argc <= 1) {
        return 0;
    }
    if (argv[1][0] == 'e') {
        runExp(1000000000);
    } else if (argv[1][0] == 'l') {
        runLog(1000000000);
    }
    return 0;
} 
```

给予时间：

```
$ time ./exp l

real     0m2.987s
user     0m2.940s
sys      0m0.015s

$ time ./exp e 

real     0m2.988s
user     0m2.942s
sys      0m0.012s 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-03T17:10:33.473

它可能取决于您的 libm、平台和处理器。你最好写一些调用`exp`/`log`很多次的代码，然后用`time`它来调用它几次，看看是否有明显的区别。

两者在我的计算机（Windows）上花费的时间基本相同，所以我会使用`exp`，因为它是为所有值定义的（假设您检查`ERANGE`）。但如果它更自然地使用`log`，你应该使用它而不是没有充分理由尝试优化。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-05T04:51:18.973

log 更快是有道理的... Exp 必须执行多次乘法才能得出答案，而 log 只需要将尾数和指数从 base-2 转换为 base-e。

如果您使用的是 log，请务必进行边界检查（正如许多其他人所说）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-03T21:53:48.550

如果你确定这是热点——编译器内在是你的朋友。虽然它依赖于平台（如果你在这样的地方追求性能——你不能与平台无关）所以。真正的问题是——哪一个是目标架构上的 asm 指令——以及延迟+周期。没有这个，纯属猜测。

# runtime-error - 为什么这个程序中的 x 值会发生变化？

> ID：817510
> 
> 赞同：0
> 
> 时间：2009-05-03T17:06:54.683
> 
> 标签：runtime-error

我已经创建了这段代码，当我运行它时，直到箭头离开屏幕（即：（*I）->x>maxx）之前不会出现任何错误，之后O将随机传送（嗯，我'我猜它不是随机的，但我正在尝试找到它的模式）。

编辑：如果我向上移动，似乎不会发生随机传送，如果我向下移动，O 会直接传送到底部。此外，在 O 变为“>”的地方发生了故障。（我试图弄清楚这是怎么发生的）

编辑：如果 O 位于屏幕的右下角 (player.x=9;player.y=9) 并且输入了序列“wqs”，则会发生转换为-'>' 的故障。

编辑：我已经删除了类声明，因为我相当确定错误在 _move()s 和 check() 中。

编辑：输入“wq”时出现转换故障，然后输入任何其他字符（即“跳过”下一步）

编辑：当 player.x=9; 时发生转换故障；玩家.y=8; 然后按下'q'，玩家的下一个动作变成'>'

这是代码：

```
#include<vector>
#include<iostream>
#include<string>
using namespace std;
const int maxx = 10, maxy = 10; //two constants that show the size of the sector
char sector[maxx][maxy]; //array of characters used to display the sector
prgm player(0, 0, 'O'); //player definition at x0,y0,and displayed with 'O'
const int vsize = 1; //size of the enemy array (ie: how many enemies there will be
X1 a(9, 5, 'X', 10); //enemy "a", has a move function that moves it back and forth
virus * viral_data[vsize] = {&a}; //array of enemies used to set the sector
vector<antivirus*> antiviral_data; //vector of pointers to "antivirus" the weapon used
vector<antivirus*>::iterator I; //iterator for previous vector

void display() //function to display the sector
{
    for(int i = 0; i < maxy; i++) 
    {
        for(int j = 0; j < maxx; j++)
        {
            cout<<sector[j][i];
        }
        cout<<endl;
    }
    return;
}

void p_move() //function to get players input, then move the player or create "antivirus"
{
    char dir;
    cin>>dir;
    switch(dir)
    {
    case 'w':
        player.y--;
        break;
    case 'a':
        player.x--;
        break;
    case 's':
        player.y++;
        break;
    case 'd':
        player.x++;
        break;
    case 'q':
        antiviral_data.push_back(new aX1(player.x, player.y, '>')); //creates a new aX1 at the players position
        break;
    }
    return;
}

void v_move() //uses the enemies move
{
    for(int i = 0; i < vsize; i++)
    {
        viral_data[i]->move();
    }
    return;
}

void a_move() //uses the weapon (ie: moves the weapon forward)
{
    for(I = antiviral_data.begin(); I < antiviral_data.end(); I++)
    {
        (*I)->move();
    }
    return;
}

void set() //sets the sector array (char)
{
    for(int i = 0; i < maxy; i++)
    {
        for(int j = 0; j < maxx; j++)
        {
            sector[j][i] = ' '; makes the entire sector blank
        }
    }
    sector[player.x][player.y]=player.sym; //sets the sector at the player's position to 'O'
    for(int i = 0; i < vsize; i++)
    {
        sector[viral_data[i]->x][viral_data[i]->y] = viral_data[i]->sym; //sets the sector at each enemy's position to be 'X'
    }
    for(I = antiviral_data.begin(); I < antiviral_data.end(); I++)
    {
        sector[(*I)->x][(*I)->y] = (*I)->sym; //sets the sector at each weapon's position to be '>'
    }
    return;
}

void check() //prevents the player from moving off the screen, erases bullet if it moves of the screen (to prevent access to non-allocated memory)
{
    if(player.x < 0)
    {
        player.x = 0;
    }
    if(player.y < 0)
    {
        player.y = 0;
    }
    if(player.x > (maxx-1))
    {
        player.x = (maxx-1);
    }
    if(player.y > (maxy-1))
    {
        player.y = (maxy-1);
    }
     //PROBLEM APPEARS TO OCCUR HERE
    for(I = antiviral_data.begin(); I! = antiviral_data.end();)
    {
        if((*I)->x > maxx)
        {
            I = antiviral_data.erase(I);
        }
        else
        {
            I++;
        }
    }
     //*-*-*-*-*-*-*-*-*-*-*-*-*-*-*

    return;
}
int main()
{
    while(true)
    {
        set(); //set sector
        display(); //display sector
        p_move(); //player's move
        v_move(); //enemy's move
        a_move(); //bullet's move
        check();//check moves
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T18:03:00.570

在 check() 中，测试

```
((*I)->x > maxx) 
```

应该

```
((*I)->x >= maxx) 
```

. 这是一个不相上下的错误，它让 > 离开屏幕一格。当显示例程试图显示它时，它会破坏 X 的显示符号。

# php - php，图片下载

> ID：817521
> 
> 赞同：0
> 
> 时间：2009-05-03T17:13:17.787
> 
> 标签：php

当用户上传图像时，我将其保存到 htdocs 目录中的图像文件夹中。所以任何没有登录网站的用户都可以输入 url/images/"name" 来获取它。防止这种情况的最佳方法是什么。因为浏览会像用户直接在地址栏中输入图像的位置一样请求。检查会话详细信息后，我正在考虑使用脚本从目录下载每个图像文件。如果你能建议我一个脚本，你认为这将是一个好方法吗？我不想使用数据库。我认为它会很慢。或者，如果这是更好的方法，请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-03T17:24:23.673

您可以将其放在 htdocs/ 目录之外，然后将 images/ 目录 mod_rewrite 到 image.php 或其他内容。所以 url/images/test.jpg 将转换为 image.php?path=test.jpg

image.php 可能看起来像这样：

```
<?php
if($loggedin) {
    header("Content-Type: image/jpeg");
    echo file_get_contents("../images/".$_GET["path"]);
}
?> 
```

不要忘记清理输入！您不希望用户访问任意文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T22:43:41.923

`echo file_get_contents(...)`我建议不要使用fpassthru[来](http://php.net/fpassthru)避免大文件可能发生的“内存不足”错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T17:17:10.650

是的，你可以有一个 image.php 文件，它只在最后添加用户 ID 并显示图像。它实际上没有那么多代码。

[readfile()](http://is.php.net/manual/en/function.readfile.php)文档中有一个示例。但是下载图像，您可以跳过附件标题并使用内容类型标题。

您可以将图像位置保存在数据库中，这样不会很慢..因为我不建议将纯图像数据存储在数据库中

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T19:07:13.940

如果您没有使用身份验证库，我将使用 $_SESSION 来跟踪用户是否已登录，但也会创建一个指纹，以使劫持会话更加困难：

$`_SESSION['loggedIn'] = 1;`

这是一个不好的方法，因为我可以通过 ?PHPSESSID=933883&loggedIn=1 并基本上欺骗应用程序。

```
$_SESSION['userid'] = 100;
$_SESSION['fingerprint'] = jskdskjdjdk48924829dkshjdkshdjkhsdjsd; 
```

'fingerprint' 是一些带有盐的 MD5 加密字符串，例如。用户名+密码+“任何你想要的字符串”，只有你知道。您在登录时创建指纹，并有一个函数验证存储在关键代码会话中的指纹。这是一个基本的示例，当您更熟悉 PHP 时，您可以使用许多 PHP 框架（如 CakePHP）中存在的更好的身份验证模块。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T19:17:28.410

当他们登录时，设置一个cookie

然后在 readimg.php 检查 cookie

然后是 readimg.php?i=img.png 的输入

让 readimg.php 只检查图像的特定文件夹

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T19:29:52.653

这就是我在这里所做的：

[http://numetrocontent.co.za/basic_movie_info.php?movieid=0412](http://numetrocontent.co.za/basic_movie_info.php?movieid=0412)

您看到的图像是存储在服务器上的文件的低分辨率版本，您看不到。如果您已登录，您可以点击图片下载原始文件。如果你不是，你不能。但是，您可以为渲染设置任意分辨率，但这是由您选择的。

# java - 我可以使用什么库来对 Java Applet 中的视频进行编码？

> ID：817524
> 
> 赞同：0
> 
> 时间：2009-05-03T17:13:59.453
> 
> 标签：java, video, applet, video-encoding

我想将用户在我的 Java Applet 中的交互记录为视频以发送（可能是流）到我的服务器，以上传到 Youtube（或类似的）。不需要高帧率（每秒几帧就足够了）。

尽量减少使用的带宽是首选，因此将 jpeg 快照发送到服务器并在服务器端编码是我最后的手段。

是否有任何不需要本机代码的轻量级 Java 视频编码库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T20:15:58.393

I'm new to java so don't take this to seriously :)

I guess a good start with video encoding in java is [Java Media Framework](http://java.sun.com/javase/technologies/desktop/media/jmf/). I haven't tried it, so I don't know what's they're support on flv encoding.

Since Flash Media Server is commercial, couldn't you use [Red5](http://osflash.org/red5) ? You would have a swf, not an applet, but you will get a broader percentage of viewers since Flash Player is pretty wide spreaded.

And Alex has a good point, since you need to upload the video to youtube, why not use they're API ?

hth

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-18T14:22:37.353

[Xuggler](http://www.xuggle.com/xuggler)可用于编码几乎任何来自 Java 的格式，但它需要安装本机组件。易于使用的下载中没有可用的小程序版本，但一些用户已经构建了他们在可下载应用程序中使用的自定义版本的 FFmpeg 和 Xuggler。尝试询问 xuggler-users 用户组，看看其他人是否会提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-13T20:17:16.243

您可以通过这种方式将图像编码为 H.264/MP4，这将立即适用于网络流媒体。要在录制的同时上传它，您可以将您的序列分成小块，假设每个 25-100 张图像，然后将每个块作为单独的电影上传。

您可以在没有任何本机代码的纯 Java 中执行此操作，只需使用 JCodec ( [http://jcodec.org](http://jcodec.org) )。这是一个方便的类，您可以使用：

```
public class SequenceEncoder {
    private SeekableByteChannel ch;
    private Picture toEncode;
    private RgbToYuv420 transform;
    private H264Encoder encoder;
    private ArrayList<ByteBuffer> spsList;
    private ArrayList<ByteBuffer> ppsList;
    private CompressedTrack outTrack;
    private ByteBuffer _out;
    private int frameNo;
    private MP4Muxer muxer;

    public SequenceEncoder(File out) throws IOException {
        this.ch = NIOUtils.writableFileChannel(out);

        // Transform to convert between RGB and YUV
        transform = new RgbToYuv420(0, 0);

        // Muxer that will store the encoded frames
        muxer = new MP4Muxer(ch, Brand.MP4);

        // Add video track to muxer
        outTrack = muxer.addTrackForCompressed(TrackType.VIDEO, 25);

        // Allocate a buffer big enough to hold output frames
        _out = ByteBuffer.allocate(1920 * 1080 * 6);

        // Create an instance of encoder
        encoder = new H264Encoder();

        // Encoder extra data ( SPS, PPS ) to be stored in a special place of
        // MP4
        spsList = new ArrayList<ByteBuffer>();
        ppsList = new ArrayList<ByteBuffer>();

    }

    public void encodeImage(BufferedImage bi) throws IOException {
        if (toEncode == null) {
            toEncode = Picture.create(bi.getWidth(), bi.getHeight(), ColorSpace.YUV420);
        }

        // Perform conversion
        transform.transform(AWTUtil.fromBufferedImage(bi), toEncode);

        // Encode image into H.264 frame, the result is stored in '_out' buffer
        _out.clear();
        ByteBuffer result = encoder.encodeFrame(_out, toEncode);

        // Based on the frame above form correct MP4 packet
        spsList.clear();
        ppsList.clear();
        H264Utils.encodeMOVPacket(result, spsList, ppsList);

        // Add packet to video track
        outTrack.addFrame(new MP4Packet(result, frameNo, 25, 1, frameNo, true, null, frameNo, 0));

        frameNo++;
    }

    public void finish() throws IOException {
        // Push saved SPS/PPS to a special storage in MP4
        outTrack.addSampleEntry(H264Utils.createMOVSampleEntry(spsList, ppsList));

        // Write MP4 header and finalize recording
        muxer.writeHeader();
        NIOUtils.closeQuietly(ch);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T20:05:46.547

Why do you need to send the images or video form directly? Sounds like a big bandwidth expense. Just serialize and send the stream of UI events with timestamps, and reconstruct what the user should be seeing on your server later (some visual details may depend on the user's machine/setup, but your applet ain't gonna be able to get to them decently anyway).

# flash - 闪光补间

> ID：817526
> 
> 赞同：0
> 
> 时间：2009-05-03T17:16:14.830
> 
> 标签：flash

我需要在 Flash CS4 中进行补间动画，留下痕迹。喷药之类的。我创建了一个代表喷雾点的圆圈，我试图用补间动画移动那个点，但我需要它留下痕迹（彩色喷雾）。

那可能吗？

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T17:19:58.973

[这是](http://www.flashperfection.com/tutorials/Flash-Spray-Effect-98693.html)一个闪光教程如何做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T17:30:04.847

是的，在[Olafur 的示例](http://www.flashperfection.com/tutorials/Flash-Spray-Effect-98693.html)中，技巧不在补间动画中，您需要做的是在每一帧或每次用户移动鼠标时复制影片剪辑的实例。

如果你想让轨迹淡化，你可以在剪辑中添加一个 onEnterFrame() 函数，并在此函数内部减小 _alpha （较低的下降会导致较长的轨迹），如果值下降到 0 则删除剪辑，这样可以避免性能问题（感谢 Johan Öbrink 的说明）。

抱歉没有发布示例，但我不再使用 Flash，因此无法在此处进行测试。无论如何，我希望这可以帮助你。

# java - 我如何将 EntityManager 传递给@PostUpdate

> ID：817528
> 
> 赞同：0
> 
> 时间：2009-05-03T17:18:54.967
> 
> 标签：java, hibernate, jpa, pass-by-reference, entitymanager

我想保存更改的历史记录，所以在@PostUpdate 我想创建另一个实体的新实例并保存它，我如何将 EntityManager 传递给该方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T17:24:02.347

您可以通过从上下文中检索它来获取 EntityManager 的实例，就像在任何其他实例上一样：

1）通过在您的课程中注入：

```
@PersistenceContext EntityManager em; // injected in your class 
```

2）使用EntityManagerFactory：

```
EntityManager em = EntityManagerFactory.getEntityManager(); 
```

# c - Duff's Device 是否支持其他语言？

> ID：817540
> 
> 赞同：8
> 
> 时间：2009-05-03T17:23:46.997
> 
> 标签：c

许多年前，在处理一个紧凑的图形 I/O 问题时，Tom Duff 展开了一个循环并创建了他的[Duff 设备](http://en.wikipedia.org/wiki/Duff's_device)，如下所示：

```
dsend(to, from, count)
char *to, *from;
int count;
{
    int n = (count + 7) / 8;
    switch (count % 8) {
    case 0: do { *to = *from++;
    case 7:      *to = *from++;
    case 6:      *to = *from++;
    case 5:      *to = *from++;
    case 4:      *to = *from++;
    case 3:      *to = *from++;
    case 2:      *to = *from++;
    case 1:      *to = *from++;
           } while (--n > 0);
    }
} 
```

（请注意，这使用旧式函数参数 - 这不是错误。）

这种编码直接来自于汇编程序的思考和 C 的编码，并且依赖于 C 的 case 语句。这种交错控制结构中的创造力可以在任何其他语言中使用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T17:35:20.980

您可以使用任何支持计算 GOTO 语句的语言（Fortran、一些 BASIC 等）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-03T17:31:56.400

它在 C++ 中工作。

请注意，生成的代码取决于您的编译器。特别是，当我使用针对 ARM 架构的 GCC 编译 Duff 的设备时，生成的 ARM 汇编程序在任何优化级别都不是最佳的（我认为 GCC 将它变成了一个跳转表）。

我最终只是交给了汇编程序的编码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-03T17:35:27.610

Duff 的设备本质上是一个`goto`可以用许多其他语言完成的计算设备 - 汇编（当然）和 FORTRAN 是直接支持它们的一对。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-03T17:35:36.407

我在 JavaScript 中非常成功地使用它来加速大型数组处理。我希望我可以在 C# 中使用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-05T19:34:26.357

即使不能以这种方式使用，您仍然可能有两个循环：

```
dsend(to, from, count)
char *to, *from;
int count;
{
    int n;
    for(n=0; n!=count/8; n+=8){
        *to = *from++;
        *to = *from++;
        *to = *from++;
        *to = *from++;
        *to = *from++;
        *to = *from++;
        *to = *from++;
        *to = *from++;
    }
    for(; n!=count; n++)
    {
        *to = *from++;
    }
} 
```

当然，使用更小会稍微慢一些，`count`但它更具可读性，跨语言的可移植性更高，并且与 large 产生非常相似的好处`count`。

# .net - 如何让自定义 msbuild 任务正常工作？

> ID：817545
> 
> 赞同：1
> 
> 时间：2009-05-03T17:29:34.457
> 
> 标签：.net, asp.net-mvc, visual-studio-2008, msbuild

我有一个带有 2 个项目的 VS 2008 解决方案。项目 A 构建到项目 B（MVC 项目）使用的程序集中。我在项目 A 中创建了一个自定义任务，我在构建项目 B 时调用了该任务。

我遇到了2个问题：

1.  如果我的 AssemblyFile 属性指向项目 A 的 bin 目录，则一切正常。但是当我想清理项目B时，它总是给出无法访问项目A的程序集的错误，因为它正在被另一个进程使用（原来是devenv.exe）并且删除失败。
2.  如果我的 AssemblyFile 属性指向项目 B 的 bin 目录，则构建失败，说它无法加载或找到项目 A 的程序集。我已经三重检查了路径、文件名、大写/小写、拼写，还检查了构建失败时项目 A 的程序集是否确实存在。

那么场景 1 和 2 有什么问题。或者我应该将 AssemblyFile 指向哪里？失败了这一切，有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T17:50:35.053

有几种方法可以在项目中定义引用。

1.  **项目参考** - 这是一种更集成的方法，因为 VS 将为您确定构建顺序。因此，当您构建项目 B 时，VS 确定项目 B 依赖于项目 A，并将首先构建项目 A 并从其输出位置使用 A 的输出 dll。使用项目引用的缺点是，当您想将项目 B 包含在不同的解决方案中时，您还必须包含项目 A。

2.  **程序集引用**- 您还可以直接定义对程序集的引用。听起来这就是您正在使用的方法。在这种情况下，当您将项目 B 的文件引用设置为项目 A 的 /bin 中的 ProjA.dll 时，Visual Studio 不知道它必须首先构建项目 A 才能创建 ProjA.dll。您可以通过设置正确的“项目依赖关系”来指示 Visual Studio 首先构建项目 A。

为此，请在解决方案中同时加载 ProjA 和 ProjB。假设您已经拥有在场景 2 中定义的程序集引用，请右键单击项目 B 并选择“项目依赖项...”。在这里，您只需在列表中的项目 A 旁边打勾。现在，当您清理和构建解决方案时，VS 知道构建项目的顺序。

同样重要的是要注意“构建顺序”和“项目依赖关系”是在解决方案级别定义的。因此，如果您使用定义为文件引用的依赖项目创建不同的解决方案，则必须为该新解决方案设置构建顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T14:14:40.547

如果您想独立构建这两个项目，那么您不能从构建它的 VS 输出目录中引用“A”程序集...

我将如何处理这种情况：

在主干中我的项目文件夹的顶层创建一个依赖项文件夹.. 即：

*   ~/主干/依赖项
*   〜/主干/项目
*   ~/trunk/projects/projectA
*   〜/主干/项目/项目B

然后，在 projectA 的构建任务中，在构建完成后将程序集复制到 ~/trunk/dependencies 文件夹。

在 projectB 中，在 ~/dependencies 文件夹中引用该程序集（以便生成一个 .refresh 文件）

这将允许您随意清理项目B，并且“A”组件将在您喜欢的时候被关闭。

* * *

对于 CI，我们使用[JetBrains TeamCity](http://www.jetbrains.com/teamcity/index.html)并为我们的构建创建工件，然后构建任务根据需要引用这些工件。

# c# - C# webclient 和代理服务器

> ID：817548
> 
> 赞同：38
> 
> 时间：2009-05-03T17:30:30.430
> 
> 标签：c#, proxy, webclient

我在源代码中使用 Web 客户端类来使用 http 下载字符串。

这工作正常。但是，公司中的客户端现在都连接到代理服务器。而问题就是从这里开始的。

当我测试我的应用程序时，我认为它不能通过代理服务器，因为不断抛出的异常是“没有来自代理服务器 IP 地址的 xxx.xxx.xxx.xxx 的响应。

但是，我仍然可以导航到网站 URL，当通过代理服务器连接时，它会在浏览器中正确显示字符串，但在我使用 Web 客户端时却不能。

我必须配置 Web 客户端中的某些内容以允许我从代理服务器后面访问 url？

```
using (WebClient wc = new WebClient())
{
    string strURL = "http://xxxxxxxxxxxxxxxxxxxxxxxx";

    //Download only when the webclient is not busy.
    if (!wc.IsBusy)
    {
        string rtn_msg = string.Empty;
        try
        {
            rtn_msg = wc.DownloadString(new Uri(strURL));
            return rtn_msg;
        }
        catch (WebException ex)
        {
            Console.Write(ex.Message);
            return false;
        }
        catch (Exception ex)
        {
            Console.Write(ex.Message);
            return false;
        }
    }
    else
    {
        System.Windows.Forms.MessageBox.Show("Busy please try again");
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-05-28T04:01:13.190

我的解决方案：

```
WebClient client = new WebClient();
WebProxy wp = new WebProxy(" proxy server url here");
client.Proxy = wp;
string str = client.DownloadString("http://www.google.com"); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-08-15T17:47:40.337

如果需要对代理进行身份验证，则需要设置`UseDefaultCredentials`为`false`，并设置代理`Credentials`。

```
WebProxy proxy = new WebProxy();
proxy.Address = new Uri("mywebproxyserver.com");
proxy.Credentials = new NetworkCredential("usernameHere", "pa****rdHere");  //These can be replaced by user input
proxy.UseDefaultCredentials = false;
proxy.BypassProxyOnLocal = false;  //still use the proxy for local addresses

WebClient client = new WebClient();
client.Proxy = proxy;

string doc = client.DownloadString("http://www.google.com/"); 
```

如果你只需要一个简单的代理，你可以跳过上面的大部分行。所有你需要的是：

```
WebProxy proxy = new WebProxy("mywebproxyserver.com"); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-08-11T06:46:47.670

Jonathan 提出的答案是正确的，但要求您在代码中指定代理凭据和 url。通常，默认情况下最好允许在系统中使用凭据作为设置（用户通常会配置 LAN 设置，以防他们使用代理）...

Davide 在较早的答案中提供了以下答案，但这需要修改 app.config 文件。这个解决方案可能更有用，因为它在代码中做同样的事情。

为了让应用程序使用用户系统中使用的默认代理设置，可以使用以下代码：

```
IWebProxy wp = WebRequest.DefaultWebProxy;
wp.Credentials = CredentialCache.DefaultCredentials; 
wc.Proxy = wp; 
```

这将允许应用程序代码使用代理（使用登录凭据和默认代理 url 设置）......不用头疼！:)

希望这可以帮助该页面的未来查看者解决他们的问题！

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-01-17T10:24:48.563

我遇到了同样的问题，但是使用 webclient 从 Internet 下载文件和 Winform 应用程序，解决方案在 app.config 中添加：

```
<system.net>
    <defaultProxy useDefaultCredentials="true" />
</system.net> 
```

相同的解决方案适用于在 web.config 中插入相同行的 asp.net 应用程序。

希望它会有所帮助。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-03T17:33:18.910

您需要在 WebClient 对象中配置代理。

请参阅 WebClient.Proxy 属性：

[http://msdn.microsoft.com/en-us/library/system.net.webclient.proxy(VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient.proxy(VS.80).aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-12-30T20:22:04.933

```
byte[] data;
using (WebClient client = new WebClient())
{
    ICredentials cred;
    cred = new NetworkCredential("xmen@test.com", "mybestpassword");
    client.Proxy = new WebProxy("192.168.0.1",8000);
    client.Credentials = cred;
    string myurl="http://mytestsite.com/source.jpg";
    data = client.DownloadData(myUrl);
}

File.WriteAllBytes(@"c:\images\target.jpg", data); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-22T13:45:30.607

所有以前的答案都有一些优点，但实际答案只需要一行：

```
wc.Proxy = new WebProxy("127.0.0.1", 8888); 
```

其中 wc 是 WebClient 对象，8888 是位于同一台机器上的代理服务器的端口号。

# html - HTML表格宽度适合浏览器窗口

> ID：817549
> 
> 赞同：3
> 
> 时间：2009-05-03T17:31:05.170
> 
> 标签：html

给定一个 HTML 表格，其中的一些数据可能比浏览器窗口更窄或更宽，

在前一种情况下，我知道如何使其扩展以填充整个宽度。

在后一种情况下，如何使其压缩（通过截断某些列，而不是通过自动换行）以适应可用宽度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T17:37:45.933

如果“截断某些列”是指截断它们的内容，则始终可以使所有 TD`overflow: hidden`具有固定的高度。

另一方面，如果您想完全摆脱列，那么您将需要一个 JavaScript 解决方案来检测哪些列落在视图之外并将它们扫除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T17:38:16.963

嗯，你的问题很难回答。我认为最简单的方法是使用[Yahoo User Interface Library](http://developer.yahoo.com/yui/)，它有一个名为 DataTable 的组件（以及许多其他组件），您可以在其中以编程方式添加或删除列。这是一个可以帮助你的[例子。](http://developer.yahoo.com/yui/examples/datatable/dt_colshowhide.html)

PS：检查其他组件，YUI 仅使用 javascript，其中一些非常酷。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T17:38:24.530

要将表格扩展到完整的浏览器宽度，只需执行以下操作：

```
 <table width="100%"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T17:44:51.707

*...您如何使其压缩（通过截断某些列，而不是通过自动换行）以适应可用宽度？*

我建议将表格宽度设置为 n%，并以百分比为单位设置 td 的宽度，这些百分比相加将给出表格的宽度。

但是，这将导致单词包含在 td 中。

# iphone - UILabel内存泄漏？

> ID：817550
> 
> 赞同：0
> 
> 时间：2009-05-03T17:31:24.390
> 
> 标签：iphone, objective-c, uilabel, nstimer

我有一个每秒触发一次的 NSTimer，在那一秒我通过设置 text 属性来更新 UILabel，如下所示：

```
remainglbl.text = [NSString stringWithFormat:@"%i:%02i", var1, var2]; 
```

它工作正常，但是当我在 xcode 中使用 Start With Performance Tool -> Leaks 运行它时，似乎内存只是不断地攀爬和攀爬。

据我了解，应该自动释放字符串（尽管我从未看到内存减少或停止增加）。

这是内存泄漏吗？有没有更好的方法可以控制我的内存使用情况？

谢谢！

更新：创建计时器的代码如下：

```
timeTimer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(changeTime:) userInfo:nil repeats:YES]; 
```

定时器完成时清理的代码如下：

```
[timeTimer invalidate];
[timeTimer release];
timeTimer = nil; 
```

这有什么问题吗？我认为一旦计时器完成，内存可能会被释放，但事实并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-10T16:38:04.097

我相信问题在于我不了解性能工具。使用活动监视器运行不会显示内存使用量增加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T17:40:28.360

只是出于好奇，如果您使用 [remainingLbl setText: ] 而不是设置属性，问题是否仍然存在？您的代码看起来不错...应该清理内存，因为 stringWithFormat 会自动释放字符串。

另一件要尝试的事情：当您在 Objective-C 中创建线程时，您必须将所有代码包装在 NSAutoreleasePool 中，以便清理您在线程执行期间创建的内容。这不应该在这里有所作为，因为应该已经存在 - 但值得一试。

# language-agnostic - 使用消息传递进行性能评估

> ID：817553
> 
> 赞同：2
> 
> 时间：2009-05-03T17:32:57.117
> 
> 标签：language-agnostic, mpi, distributed-computing, message-passing

我必须使用 MPI 构建分布式应用程序。我必须做出的决定之一是如何将类的实例映射到进程中（然后映射到机器中），以便从分布式环境中获得最大的优势。

我的问题是：有一个模型可以让我选择更好的映射吗？我的意思是，有些安排肯定是错误的（例如，将两个对象放入两台不同的机器中，这两个对象应该以顺序方式一起处理相当大量的数据，没有要处理的令牌流），但是有一种系统的方法确定这样的错误安排，由执行流程、消息复杂性、算法组件完成的计算所花费的时间决定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T23:37:37.490

嗯，有[数据流图](http://en.wikipedia.org/wiki/Data_flow_diagram)。这些可以帮助识别并行性的机会和陷阱。维基百科页面上的参考资料可能会给你一些更多的理论基础。

当我在洛克希德马丁公司工作时，我接触了[CSIM](http://www.atl.lmco.com/projects/csim/)，这是他们开发的一种工具，用于对算法映射到处理块进行建模。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-08T13:02:39.337

您可能会尝试的另一件事是[Join Calculus](http://en.wikipedia.org/wiki/Join-calculus)。我发现使用它进行编程的示例非常直观，而且我认为它在理论上有很好的基础。我不知道为什么它没有更多地流行起来。

另一种方法是[Pi Calculus](http://en.wikipedia.org/wiki/Pi-calculus)，我认为这可能更受欢迎，尽管它似乎更难理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-01T19:14:16.377

一个实际的解决方案是使用不同的分布式内存并行编程模型，直接解决您的问题。我在[Charm++](http://charm.cs.illinois.edu)编程系统上工作，它的模型是单个对象从一个对象发送消息到另一个对象的模型。运行时系统有助于将这些对象自动映射到可用处理器，以解决负载平衡和通信局部性问题。

# ado.net - 使用ado将excel转换为xml

> ID：817563
> 
> 赞同：1
> 
> 时间：2009-05-03T17:37:27.183
> 
> 标签：ado.net

如何使用 ado.net 将 excel 数据转换为 xml 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T17:46:53.573

您可以使用 Microsoft Jet OLEDB 4.0 数据提供程序来读取 Excel 文件。可以在[此处](http://www.connectionstrings.com/excel)找到有关如何建立与 Excel 文件的连接的信息。

本文[介绍](http://support.microsoft.com/kb/316934)如何使用提供程序读取 Excel 文件。读取数据后，您可以使用 LINQ to XML 或 System.Xml 类编写 XML 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T17:46:20.437

我没有使用过 ado.net，但我已经非常成功地使用了 xquery。使用 excel 导出创建 XML 文件，然后编写 xquery/xpath 命令进行转换。Excel XML 导出格式非常粗糙，但它确实可以完成这项工作。使用 Oxygen 30 天评估许可证来减轻 xquery 调试工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T17:47:46.627

在 Excel 中，您可以使用“文件”菜单将保存的文件类型更改为 XML 电子表格，将文件保存为 XML。

如果您想使用 ADO.Net 读取 Excel XML 文件，请尝试使用 XmlReader。

或者查看 Microsoft 的这个[分步示例](http://support.microsoft.com/kb/306572)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T17:54:54.847

使用此代码：

```
 public static DataSet exceldata(string filelocation)

{

DataSet ds = new DataSet();

OleDbCommand excelCommand = new OleDbCommand();OleDbDataAdapter excelDataAdapter = new OleDbDataAdapter();

string excelConnStr = "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" + filelocation + "; Extended Properties =Excel 8.0;";
OleDbConnection excelConn = new OleDbConnection(excelConnStr);

excelConn.Open();
DataTable dtPatterns = new DataTable();excelCommand = new OleDbCommand("SELECT UUID, `PATTERN` as PATTERN, `PLAN` as PLAN FROM [PATTERNS$]", excelConn);

excelDataAdapter.SelectCommand = excelCommand;

excelDataAdapter.Fill(dtPatterns);
dtPatterns.TableName = "Patterns";

ds.Tables.Add(dtPatterns);
return ds;

} 
```

然后将返回的数据表转换为xml`DataTable.WriteXml()`

# javascript - 如何提高 Jquery 自动完成的性能

> ID：817576
> 
> 赞同：48
> 
> 时间：2009-05-03T17:44:14.657
> 
> 标签：javascript, jquery, autocomplete

我打算对一个站点使用 jquery 自动完成功能并实现了一个测试版本。我现在使用 ajax 调用来检索每个字符输入的新字符串列表。问题是它变得相当慢，在填充新列表之前 1.5 秒。快速自动完成的最佳方法是什么？我正在使用 cakephp，只是做了一个查找，并且限制为 10 个项目。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-05-04T11:51:34.120

[这篇](http://code.flickr.com/blog/2009/03/18/building-fast-client-side-searches/)关于[flickr](http://www.flickr.com/)如何自动完成的文章非常好读。我有一些“哇”的阅读体验。

> “这个小部件以 JavaScript 格式在 200 毫秒内下载您所有联系人的列表（即使对于拥有 10,000 多个联系人的成员也是如此）。为了获得这种水平的性能，我们必须完全重新考虑我们如何从服务器到客户端。”

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-02-07T22:46:04.307

尝试预加载您的列表对象，而不是动态进行查询。

此外，自动完成默认有 300 毫秒的延迟。
也许消除延迟

```
$( ".selector" ).autocomplete({ delay: 0 }); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-03T18:07:12.963

1.5 秒的间隔对于提供自动完成服务来说是非常大的间隔。

1.  首先优化您的查询和数据库连接。尝试使用内存缓存保持数据库连接处于活动状态。
2.  如果您的服务高度使用忽略重新获取，请使用结果缓存方法。
3.  使用客户端缓存（JS 列表）将旧请求保留在客户端上。如果用户键入并擦除，它将很有用。结果将来自前端缓存而不是后端点。
4.  客户端的正则表达式过滤不会很昂贵，你可以给它一个机会。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-03T18:51:11.233

在进行一些优化之前，您应该首先分析瓶颈在哪里。尝试找出每个步骤（输入→请求→数据库查询→响应→显示）需要多长时间。也许 CakePHP 实现有一个延迟，不会为每个输入的字符发送请求。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-05-13T04:25:59.083

PHP/SQL 上的服务器端很慢。

不要使用 PHP/SQL。我的自动完成是用 C++ 编写的，并使用哈希表进行查找。[在这里](http://olegh.ftp.sh/autocomplete.html)查看性能。

这是 Celeron-300 计算机、FreeBSD、Apache/FastCGI。

而且，你看，在庞大的字典上运行很快。10,000,000 条记录不是问题。

此外，还支持优先级、动态翻译和其他功能。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-03T18:00:25.507

在这种情况下，我认为真正的速度问题是在数据库上运行查询所需的时间。如果没有办法提高您的查询速度，那么可能会扩展您的搜索以包含更多具有一些高排名结果的项目，您可以每隔一个字符执行一次搜索，并在客户端过滤 20-30 个结果。

这可能会提高性能的外观，但在 1.5 秒时，我会先尝试提高查询速度。

除此之外，如果您能给我们提供更多信息，我也许可以给您更具体的答案。

祝你好运！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-13T18:36:25.323

自动完成本身并不慢，尽管您的实现当然可以。我要检查的第一件事是延迟选项的值（请参阅 jQuery 文档）。接下来，我将检查您的查询：您可能只带回 10 条记录，但您是否正在执行巨大的表扫描以获取这 10 条记录？您是否将数据库中的大量记录带回一个集合，然后从集合中取出 10 个项目，而不是在数据库上进行服务器端分页？一个简单的索引可能会有所帮助，但您必须进行一些测试才能确定。

# asp.net - 如何在 asp.net regularExpressionValidator 中验证 dd-mon-yyyy 格式的日期输入？

> ID：817578
> 
> 赞同：1
> 
> 时间：2009-05-03T17:45:22.313
> 
> 标签：asp.net, nhibernate, validation

我真的需要 dd-mon-yy 格式，因为我的 oracle 数据库接受这种格式的日期。

我可以像这样在 RegularExpressionValidator 中进行验证吗？

而且，在使用 nhibernate 时，我是否必须将文本框值转换为 oracle 数据时间格式？

非常感谢您的帮助；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T17:48:54.830

尝试

`Regx.ValidationExpression=@"^(([1-9])|(0[1-9])|(1[0-2]))\-((0[1-9]) |([1-31]))\-((\d{2})|(\d{4}))$";`

或者

你可以试试这个自定义验证器

受保护的无效CustomValidator1_ServerValidate（对象源，ServerValidateEventArgs args）{

日期时间结果；

if (!DateTime.TryParse(args.Value, out result))

{

args.IsValid = 假；

返回;

} 否则 args.IsValid = true;

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T17:57:29.663

是否需要强制用户以Oracle数据库禁止的格式输入数据？只要用户输入有效日期，您就可以将输入解析为 DateTime 对象，然后调用 ToString("dd-MMMM-yy") 以生成数据库所需格式的日期表示。这使您可以自由地提供更多用户友好的方式来收集用户输入，例如日期/时间选择器类型控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T17:50:52.970

对于年份的两位数，请尝试：

```
^([012]?\d|3[01])-([Jj][Aa][Nn]|[Ff][Ee][Bb]|[Mm][Aa][Rr]|[Aa][Pp][Rr]|[Mm][Aa][Yy]|[Jj][Uu][Nn]|[Jj][Uu][Ll]|[Aa][Uu][Gg]|[Ss][Ee][Pp]|[Oo][Cc][Tt]|[Nn][Oo][Vv]|[Dd][Ee][Cc])-\d\d$ 
```

年份有四位数：

```
^([012]?\d|3[01])-([Jj][Aa][Nn]|[Ff][Ee][Bb]|[Mm][Aa][Rr]|[Aa][Pp][Rr]|[Mm][Aa][Yy]|[Jj][Uu][Nn]|[Jj][Uu][Ll]|[Aa][Uu][Gg]|[Ss][Ee][Pp]|[Oo][Cc][Tt]|[Nn][Oo][Vv]|[Dd][Ee][Cc])-(19|20)\d\d$ 
```

这些表达的意思是：

*   0 或 1 或 2 后跟一个数字，或 3 加 0 或 1
*   下一个破折号
*   对于这个月，它会在所有十二个月中“尝试”所有 JAN、JAn、Jan、jan 等的组合
*   下一个破折号
*   最后，“yyyy”版本需要两位数，或者 19 或 20，“yy”版本需要两位数

# c# - 避免 C# 中的重复事件订阅

> ID：817592
> 
> 赞同：19
> 
> 时间：2009-05-03T17:51:01.347
> 
> 标签：c#, events, event-handling, delegates

您如何建议避免重复事件订阅的最佳方法？如果这行代码在两个地方执行，则事件将运行两次。我试图避免订阅两次的第 3 方事件。

```
theOBject.TheEvent += RunMyCode; 
```

在我的委托设置器中，我可以有效地运行这个......

```
theOBject.TheEvent -= RunMyCode;
theOBject.TheEvent += RunMyCode; 
```

但这是最好的方法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-03T18:01:36.267

我认为，最有效的方法是使您的事件成为一个属性并为其添加并发锁，如本**[例](http://codinglight.blogspot.com/2009/02/preventing-duplicate-subscriptions-to.html)**所示：

```
private EventHandler _theEvent;
private object _eventLock = new object();
public event EventHandler TheEvent
{
    add
    {
        lock (_eventLock) 
        { 
            _theEvent -= value; 
            _theEvent += value; 
        }
    }
    remove
    {
        lock (_eventLock) 
        { 
           _theEvent -= value; 
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-03T18:31:27.053

我以前做过这个......它假设最后一个订阅者是被调用的对象是可以接受的。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            MyObject my = new MyObject();
            my.Changed += new EventHandler(my_Changed);
            my.Changed += new EventHandler(my_Changed1);

            my.Update();
            Console.ReadLine();
        }

        static void my_Changed(object sender, EventArgs e)
        {
            Console.WriteLine("Hello");
        }
        static void my_Changed1(object sender, EventArgs e)
        {
            Console.WriteLine("Hello1");
        }
    }
    public class MyObject
    {
        public MyObject()
        {
        }
        private EventHandler ChangedEventHandler;
        public event EventHandler Changed
        {
            add
            {
                ChangedEventHandler = value;
            }
            remove
            {
                ChangedEventHandler -= value;
            }
        }
        public void Update()
        {
            OnChanged();
        }

        private void OnChanged()
        {
            if (ChangedEventHandler != null)
            {
                ChangedEventHandler(this, null);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T18:09:10.553

你的代码是多线程的吗？只有当它的多线程时才需要并发锁。如果不是开销。

因此，您取消订阅和订阅的方法是正确的。

谢谢

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T17:59:14.323

如果您拥有 theObject 类的源，那么您可以访问 TheEvent 的 InvocationList。您可以为事件实现自己的添加访问器并在添加之前进行检查。

但是，我认为您的方法也很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T18:15:27.390

我使用你的方法，除了一个细节。我认为，当您创建订阅者或对象的新实例时，应该订阅事件，这使代码更直接。因此，您所需要的只是仔细观察正确处理对象后（dispose patten 是一种方便的解决方案）。

您提到您使用 3rd 方事件，这意味着您无法为添加/删除方法提供自己的实现，正如您所建议的那样。但是在您自己的带有自己事件的类中，您应该为事件定义自己的添加/删除方法的实现，以解决您的问题。

# cocoa - 如何在finder中做一个底部边框？

> ID：817595
> 
> 赞同：4
> 
> 时间：2009-05-03T17:52:20.267
> 
> 标签：cocoa, interface-builder

我正在尝试在带有侧边栏的纹理窗口底部添加一个边框。我想看起来和 finder 完全一样：

[替代文字 http://jeenaparadies.net/t/s/finder-border.png](http://jeenaparadies.net/t/s/finder-border.png)

现在看起来像这样：

[替代文字 http://jeenaparadies.net/t/s/twittia-border.png](http://jeenaparadies.net/t/s/twittia-border.png)

而且我在 Interface Builder 中找不到如何添加此边框的任何内容。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-03T17:55:04.927

您使用 NSWindow 的 setContentBorderThickness:forEdge: 添加它，将 NSMinYEdge 传递给边缘。请注意，这仅在窗口*没有*纹理时才有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-01-24T14:52:18.330

查看[BWToolkit](http://www.brandonwalkin.com/bwtoolkit/)中的**底部栏**。

# iphone - 重叠和接触的 CoreGraphics 矩形有 0.5px 的边框

> ID：817597
> 
> 赞同：1
> 
> 时间：2009-05-03T17:54:51.277
> 
> 标签：iphone, cocoa-touch, graphics, core-graphics, antialiasing

当靠近、接触或重叠时，我的核心图形填充表现得很奇怪。此问题在 iPhone Simulator 和 iPhone OS 2.2 上。

这里我们有两个标签和一个带有两个 CGContextFillRect() 的自定义视图：

[重叠问题](http://www.freeimagehosting.net/uploads/7b114860f3.png)

当蓝色和红色结合在一起时，它们会形成这条令人讨厌的 0.5px 合并线。我似乎无法摆脱它，甚至无法改变它的颜色。

这个版本的矩形之间有 1px 的间隙，当然它是用黑色背景填充的：

[像素间隙](http://www.freeimagehosting.net/uploads/d160c5795a.png)

我试过禁用抗锯齿，但这并不能解决问题。

```
- (void)drawRect:(CGRect)rect {
CGContextRef context = UIGraphicsGetCurrentContext();

CGContextSetAllowsAntialiasing(context, false);

CGContextSetRGBFillColor(context, 0.0, 0.0, 1.0, 1.0);
CGContextFillRect(context, CGRectMake(20.0, 35.0 + 40 + 20 , 100, 40));

CGContextSetRGBFillColor(context, 1.0, 0.0, 0.0, 1.0);
CGContextFillRect(context, CGRectMake(20.0 + 100 , 35.0 + 40 + 20 , 100, 40));

CGContextSetAllowsAntialiasing(context, true); 
```

}

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T18:14:54.113

没有缺陷。这是一种视错觉。您的眼睛正在将 R&B 值紧密集成在一起并推断出白色重叠。

使用 pixie（Xcode 的一部分）或[xscope](http://iconfactory.com/software/xscope)（从 iconfactory 付费升级）查看图形。

http://www.freeimagehosting.net/uploads/th.e015daef50.png>

# html - getHTTP 与（Excel）VBA？

> ID：817602
> 
> 赞同：11
> 
> 时间：2009-05-03T17:55:49.760
> 
> 标签：html, excel, vba, httpwebrequest, excel-web-query

我正在搜索 Excel VBA 宏的查询，以获取网页的 HTML 源代码作为字符串。

我找到了一些来源，`getHTTPrequest`但我无法注册 .net 框架`system.dll`或链接它。

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-03T18:01:17.983

足够接近：[如何使用 VBA 从 Excel 向服务器发送 HTTP POST 请求？](https://stackoverflow.com/questions/158633/how-can-i-send-an-http-post-request-to-a-server-from-excel-using-vba)— 它甚至适用于 Excel ;-)

只需使用 GET 请求：

```
objHTTP.Open "GET", URL, False 
```

MSDN：[使用 WinHttpRequest COM 对象 - 使用 Visual Basic 检索数据](http://msdn.microsoft.com/en-us/library/aa384072(VS.85).aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-10-20T07:34:51.657

这是一个紧凑的函数，它返回几乎任何指定 URL 的响应文本，例如网页的 HTTP 源代码，或来自[JSON API 的](https://any-api.com/)响应文本。

* * *

## *后期绑定：（* [^(*无需参考）*)]

```
Public Function getHTTP(ByVal url As String) As String
  With CreateObject("MSXML2.ServerXMLHTTP.6.0") 
    .Open "GET", url, False: .Send
    getHTTP = StrConv(.responseBody, vbUnicode)
  End With
End Function 
```

* * *

## *早期绑定：*

如果您需要重复调​​用该函数（例如在循环中），最好将其用作早期绑定函数：

1.  **添加**对 XML 库的引用：

    `Tools`→ `References`→ 选择 `Microsoft XML, v6.0` *（或您列出的最高版本）*

2.  声明一个**模块级变量**：（将此行放在模块的顶部）
    ^(（创建新 VBA 模块的快捷方式：`Alt`+ `F11`→ ``I``→ `M`）)

    `Dim msXML As XMLHTTP60`

3.  在函数中，仅当变量尚未设置时才**创建 XML 对象：**

    ```
     Public Function getHTTP(ByVal url As String) As String
       If msXML Is Nothing Then Set msXML = New XMLHTTP60
       With msXML
         .Open "GET", url, False: .Send
         getHTTP = StrConv(.responseBody, vbUnicode)
       End With
     End Function 
    ```

* * *

## *示例用法：（* [^(对于任何一种方法）)]

要获取此页面的 HTML 源代码：

```
Debug.Print getHTTP("https://stackoverflow.com/q/817602") 
```

* * *

> ️**注意！**
> 
> 如果您尝试使用此类方法或其他方法（即 Excel 的方法）连接到不安全的 url，许多应用程序（包括**MS Office**`WEBSERVICE` ）现在将返回错误。
> 
> 为避免此问题，**请尽可能****使用`HTTPS://`代替。`HTTP://`**

# c++ - 浮点数组的更快 abs-max

> ID：817604
> 
> 赞同：9
> 
> 时间：2009-05-03T17:57:11.113
> 
> 标签：c++, performance, optimization, signal-processing

我需要实时绘制音频峰值表。每秒最少 44100 个样本乘以最少 40 个流。每个缓冲区介于 64 到 1024 个样本之间。我需要从每个缓冲区中获取最大绝对值。（然后将它们通过一种低通滤波器馈入并以大约 20 毫秒的间隔绘制。）

```
for(int i = 0; i < numSamples; i++)
{ 
      absMaxOfBuffer = MAX( fabs( buffer[i] ), absMaxOfBuffer);
} 
```

我现在就是这样做的。我想做得更快。缓冲区的浮点数在 -1 到 1 范围内，因此是 fabs。

问题，是否有一些棘手的 comp-sci quicksort-esque 方法可以更快地做到这一点？

如果做不到这一点，浮点数的无分支 ABS 和 MAX 函数，它们存在吗？

编辑：主要平台是 Linux/gcc，但计划了一个 windows 端口（可能与 mingw）。

编辑，第二个：
我接受了一个人，因为关于实际算法结构的一点是问题的核心。
我将尝试将循环展开到四个，将符号位归零，然后使用 SSE（maxps 指令）获得最大值，看看是否不会剥皮。感谢您的建议，我投票赞成你们中的一些人，作为亚军。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T18:30:59.300

对于 IEEE 浮点数，fabs 和比较都非常快（例如，原则上单整数运算快）。

如果编译器没有内联这两个操作，那么要么戳它直到它完成，或者找到你的架构的实现并自己内联它。

您可能会从*正*IEEE 浮点数与具有相同位模式的整数的顺序相同的事实中得到一些信息。那是，

```
f > g   iff   *(int*)&f > *(int*)&g 
```

因此，一旦您完成了制造，我认为 int 的无分支最大值也适用于 float（当然假设它们的大小相同）。有一个解释为什么在这里工作：[http](http://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm) ://www.cygnus-software.com/papers/comparingfloats/comparingfloats.htm 。但是你的编译器已经知道这一切，你的 CPU 也知道，所以它可能没有任何区别。

没有比复杂性更快的方法。您的算法已经是 O(n)，您无法击败它并仍然查看每个样本。

我猜您的处理器的 SIMD（即 Intel 上的 SSE2）中可能有一些东西可以通过每个时钟周期处理比您的代码更多的数据来提供帮助。但我不知道是什么。如果有，那么它很可能会快几倍。

您可能可以在多核 CPU 上进行并行化，尤其是因为您要处理 40 个独立的流。这将是最好的几个因素更快。“只需”启动适当数量的额外线程，将它们之间的工作分开，并使用最轻的原语来指示它们何时全部完成（可能是线程屏障）。我不太清楚您是在绘制所有 40 个流的最大值，还是分别绘制每个流的最大值，所以除了确保将结果传递到下一阶段之外，您实际上可能不需要同步工作线程没有数据损坏。

可能值得看一下反汇编，看看编译器展开了多少循环。尝试再展开它，看看是否有什么不同。

另一件要考虑的事情是你得到了多少缓存未命中，以及是否可以通过给缓存一些线索来减少这个数字，以便它可以提前加载正确的页面。但是我没有这方面的经验，我不会抱太大希望。__builtin_prefetch 是 gcc 上的魔法咒语，我猜第一个实验类似于“在进入该块的循环之前预取下一个块的开头”。

您目前处于所需速度的百分之几？还是“尽可能快”的情况？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T18:34:13.537

要尝试的事情：

*   fabs() 可能不是内联函数。
*   特殊的组装说明可能会有所帮助。在 Intel 上，SSE 有一条指令可以一次计算最多四个浮点数。
*   如果做不到这一点，IEEE 754 规范是这样的，如果 a 和 b*是非负*浮点数，则 a < b 等效于 *(int *)&a < *(int *)&b。此外，对于任何 a，您都可以通过翻转 MSB 从 a 计算 -a。总之，这些属性可能会启用一些小技巧。
*   你真的需要每个样本的最大值吗？也许最大值可能不止一次出现，从而打开了不检查每个输入的可能性。
*   你能以流方式计算最大值吗？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T18:35:43.767

[http://www.scribd.com/doc/2348628/The-Aggregate-Magic-Algorithms](http://www.scribd.com/doc/2348628/The-Aggregate-Magic-Algorithms)上记录了一个无分支晶圆厂

另请注意，最新版本的 GCC 将`fabs`使用 MMX 指令为您内联无分支。还有`fmin`and `fmax`，但 GCC 不会内联那些（你会得到一个`call fmin`）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T03:54:23.627

你可能想看看[Eigen](http://eigen.tuxfamily.org)。

它是一个 C++ 模板库，它使用*SSE（2 和更高版本）和 AltiVec 指令集，并优雅地回退到非矢量化代码*。

> 快速地。（见基准）。
> 表达式模板允许在适当的时候智能地删除临时变量并启用惰性求值——Eigen 会自动处理这一点并在大多数情况下也处理别名。
> 对 SSE（2 和更高版本）和 AltiVec 指令集执行显式矢量化，并优雅地回退到非矢量化代码。表达式模板允许对整个表达式全局执行这些优化。
> 使用固定大小的对象，可以避免动态内存分配，并且在有意义时展开循环。
> 对于大型矩阵，需要特别注意缓存友好性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T18:47:16.297

Easy optimizations I see:

*   translate the loop to a pointer arithmetic version (assuming that your compiler don't see this)
*   the IEEE 754 standard defines its representation as sign-magnitude. So, setting the most-significant bit to 0 will be the same as calling fabs(). Maybe this function already uses this trick.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T06:29:27.157

出于您的目的，您可以将其平方而不是取绝对值；正如数学上的 |a| < |b| 如果 a^2 < b^2 反之亦然。在某些机器上乘法可能比 fabs() 更快（？），我不知道。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T18:30:31.923

用另一个问题回答一个问题并不完全是回答，但是嘿......我也不是 C++ 开发人员。

既然你是在 C++ 中开发这个并且你正在做 dsp，你不能连接到 matlab 或 octave（它是开源的）到你的数学并得到结果吗？

在这些软件中已经实现了一些功能（如 conv、fft、ifft、fir 和绘图实用程序功能，如 freqz、stem、graph、plot、mesh 等）。我在 Photoshop 中查看了一个名为 MATLAB 的大文件夹……其中包含一些从应用程序获取调用的 .m 文件，将其发送到动态 matlab，然后将结果返回给应用程序。

希望能帮助到你。

# batch-file - 启动 windows 控制台应用程序参数

> ID：817606
> 
> 赞同：0
> 
> 时间：2009-05-03T17:57:35.763
> 
> 标签：batch-file, console-application

我应该使用哪些参数来启动最小化或隐藏的控制台应用程序？

这可能不使用第 3 方程序吗？

带有批处理文件

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T22:07:27.923

```
start /min c:\windows\cmd.exe 
```

Then you can pass whatever parameters to cmd.exe you need, for example:

To process a command then close:

```
start /min c:\windows\cmd.exe /c dir 
```

To process a command but stay open:

```
start /min c:\windows\cmd.exe /k dir 
```

# java - 如何在java应用程序中显示html？

> ID：817609
> 
> 赞同：2
> 
> 时间：2009-05-03T17:58:59.347
> 
> 标签：java, html, browser, jframe

现在我正在努力用 Java 实现一个浏览器。我需要在 JFrame 窗口中显示网站的内容（提供 url 地址）。有没有一种简单的方法可以做到这一点？

我试过 JEditorPane，但它只支持 HTML 3.2，所以网站的内容看起来很奇怪。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T18:11:33.140

我有很好的经验： [http ://djproject.sourceforge.net/ns/](http://djproject.sourceforge.net/ns/)

允许您在 Swing 应用程序中干净地嵌入浏览器窗口，允许您操作 DOM 并允许从浏览器本身调用主机应用程序。

BR，奥伦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T18:31:11.423

Lobo 的目标是实现 html 4 合规性。

[http://lobobrowser.org/java-browser.jsp](http://lobobrowser.org/java-browser.jsp)

有人可能会争辩说，浏览器的渲染方面是开发浏览器中最具挑战性的方面之一，如果不是的话。（网络、线程管理、安全沙箱等在 JVM 上几乎都是开箱即用的......）

因此，如果您无法编写自己的组件来处理基于 xhtml、css 和 javascript 的正确呈现文档（更不用说各种常见的插件，例如 flash），那么为什么不考虑为开源项目做出贡献呢？作为路宝？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T18:35:36.840

你应该看看[这个问题](https://stackoverflow.com/questions/145863/best-java-swing-browser-component)。

我们使用[JDIC](https://stackoverflow.com/questions/145863/best-java-swing-browser-component)，它在许多平台上运行良好。最新版本已重命名并删除了许多功能（平台兼容性）。但我认为 0.9.5 版可以正常工作。

还有计划将基于 Web-kit 的组件集成到 swing 中。不记得项目名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T18:05:16.413

我已经看到 IntelliJ IDEA 使用 Mozilla/Firefox 的嵌入式版本在 IDE 中显示网页，因此这是在 Java Swing 应用程序中显示网页的一种方式。我不知道它是否简单，但至少页面正确呈现。谷歌知道[在](https://developer.mozilla.org/En/JavaXPCOM/Embedding_Mozilla_in_a_Java_Application_using_JavaXPCOM)java中*嵌入 mozilla*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T18:07:42.447

如果您可以使用 SWT，您可以尝试使用 SWT 浏览器小部件： http: [//www.eclipse.org/articles/Article-SWT-browser-widget/browser.html](http://www.eclipse.org/articles/Article-SWT-browser-widget/browser.html)。

如果您必须坚持使用 Swing，则有 WebWindow，它有点过时 AFAIK。

# wpf - WPF 和初始焦点

> ID：817610
> 
> 赞同：205
> 
> 时间：2009-05-03T17:59:08.847
> 
> 标签：wpf, focus

似乎当 WPF 应用程序启动时，没有任何焦点。

这真的很奇怪。我使用过的所有其他框架都符合您的预期：将初始焦点放在 Tab 键顺序中的第一个控件上。但我已经确认它是 WPF，而不仅仅是我的应用程序 - 如果我创建一个新窗口，并在其中放入一个 TextBox，然后运行该应用程序，则 TextBox 在我单击它或按 Tab 之前没有焦点. 呸。

我的实际应用程序比文本框更复杂。我在 UserControls 中有几层 UserControls。其中一个 UserControls 具有 Focusable="True" 和 KeyDown/KeyUp 处理程序，我希望它在我的窗口打开后立即获得焦点。不过，我仍然有点 WPF 新手，而且我没有太多运气弄清楚如何做到这一点。

如果我启动我的应用程序并按 Tab 键，然后焦点转到我的可聚焦控件，它开始按我想要的方式工作。但我不希望我的用户必须先点击 Tab 才能开始使用该窗口。

我玩过 FocusManager.FocusedElement，但我不确定将其设置在哪个控件上（顶级窗口？包含可聚焦控件的父级？可聚焦控件本身？）或将其设置为什么。

我需要做什么才能让我的深层嵌套控件在窗口打开后立即获得初始焦点？或者更好的是，将第一个可聚焦控件聚焦在 Tab 键顺序中？

* * *

## 回答 #1

> 赞同：183
> 
> 时间：2009-08-27T21:58:49.687

这也有效：

```
<Window FocusManager.FocusedElement="{Binding ElementName=SomeElement}">

   <DataGrid x:Name="SomeElement">
     ...
   </DataGrid>
</Window> 
```

* * *

## 回答 #2

> 赞同：167
> 
> 时间：2009-05-04T01:46:22.610

我有一个绝妙的主意，那就是挖掘 Reflector 以查看 Focusable 属性的使用位置，并找到了实现此解决方案的方法。我只需要将以下代码添加到我的 Window 的构造函数中：

```
Loaded += (sender, e) =>
    MoveFocus(new TraversalRequest(FocusNavigationDirection.First)); 
```

这将自动选择选项卡顺序中的第一个控件，因此它是一个通用的解决方案，应该能够被拖放到任何窗口中并且只是工作。

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2012-01-23T15:51:59.083

基于作为附加行为实现的公认[答案：](https://stackoverflow.com/a/818536/56763)

```
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;

namespace UI.Behaviors
{
    public static class FocusBehavior
    {
        public static readonly DependencyProperty FocusFirstProperty =
            DependencyProperty.RegisterAttached(
                "FocusFirst",
                typeof(bool),
                typeof(FocusBehavior),
                new PropertyMetadata(false, OnFocusFirstPropertyChanged));

        public static bool GetFocusFirst(Control control)
        {
            return (bool)control.GetValue(FocusFirstProperty);
        }

        public static void SetFocusFirst (Control control, bool value)
        {
            control.SetValue(FocusFirstProperty, value);
        }

        static void OnFocusFirstPropertyChanged(
            DependencyObject obj, DependencyPropertyChangedEventArgs args)
        {
            Control control = obj as Control;
            if (control == null || !(args.NewValue is bool))
            {
                return;
            }

            if ((bool)args.NewValue)
            {
                control.Loaded += (sender, e) =>
                    control.MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
            }
        }
    }
} 
```

像这样使用它：

```
<Window xmlns:Behaviors="clr-namespace:UI.Behaviors"
        Behaviors:FocusBehavior.FocusFirst="true"> 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-05-10T05:08:31.627

我找到了另一种可能的解决方案。Mark Smith 发布了一个用于 FocusManager.FocusedElement的[FirstFocusedElement 标记扩展。](https://markjulmar.github.io/wpf/2008/09/12/part-3-shifting-focus-to-the-first-available-element-in-wpf.html)

```
<UserControl x:Class="FocusTest.Page2"
    xmlns:FocusTest="clr-namespace:FocusTest"
    FocusManager.FocusedElement="{FocusTest:FirstFocusedElement}"> 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-01-24T17:35:30.310

在经历了“WPF Initial Focus Nightmare”并基于堆栈上的一些答案之后，以下证明对我来说是最好的解决方案。

首先，添加您的 App.xaml OnStartup() 以下内容：

```
EventManager.RegisterClassHandler(typeof(Window), Window.LoadedEvent,
          new RoutedEventHandler(WindowLoaded)); 
```

然后在 App.xaml 中添加 'WindowLoaded' 事件：

```
void WindowLoaded(object sender, RoutedEventArgs e)
    {
        var window = e.Source as Window;
        System.Threading.Thread.Sleep(100);
        window.Dispatcher.Invoke(
        new Action(() =>
        {
            window.MoveFocus(new TraversalRequest(FocusNavigationDirection.First));

        }));
    } 
```

必须使用线程问题，因为 WPF 初始焦点主要由于某些框架竞争条件而失败。

我发现以下解决方案最好，因为它在全球范围内用于整个应用程序。

希望能帮助到你...

奥兰

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-02-15T14:44:48.480

同样的问题通过简单的解决方案解决了：在主窗口中：

```
 <Window ....
        FocusManager.FocusedElement="{Binding ElementName=usercontrolelementname}"
         ... /> 
```

在用户控件中：

```
private void UserControl_GotFocus_1(object sender, RoutedEventArgs e)
        {
            targetcontrol.Focus();
            this.GotFocus -= UserControl_GotFocus_1;  // to set focus only once
        } 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-02-27T22:50:54.523

您可以轻松地将控件设置为 XAML 中的焦点元素。

```
<Window>
   <DataGrid FocusManager.FocusedElement="{Binding RelativeSource={RelativeSource Self}}">
     ...
   </DataGrid>
</Window> 
```

我从来没有尝试在用户控件中设置它并查看它是否有效，但它可能。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-02-02T17:16:21.180

[Mizipzor](https://stackoverflow.com/a/8974420/24874)对 C# 6+的回答的最小版本。

```
public static class FocusBehavior
{
    public static readonly DependencyProperty GiveInitialFocusProperty =
        DependencyProperty.RegisterAttached(
            "GiveInitialFocus",
            typeof(bool),
            typeof(FocusBehavior),
            new PropertyMetadata(false, OnFocusFirstPropertyChanged));

    public static bool GetGiveInitialFocus(Control control) => (bool)control.GetValue(GiveInitialFocusProperty);
    public static void SetGiveInitialFocus(Control control, bool value) => control.SetValue(GiveInitialFocusProperty, value);

    private static void OnFocusFirstPropertyChanged(DependencyObject obj, DependencyPropertyChangedEventArgs args)
    {
        var control = obj as Control;

        if (control == null || !(args.NewValue is bool))
            return;

        if ((bool)args.NewValue)
            control.Loaded += OnControlLoaded;
        else
            control.Loaded -= OnControlLoaded;
    }

    private static void OnControlLoaded(object sender, RoutedEventArgs e) => ((Control)sender).MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
} 
```

在您的 XAML 中使用：

```
<Window local:FocusBehavior.GiveInitialFocus="True" /> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-02-02T08:03:40.943

如果您像我一样，并且您正在使用一些框架，不知何故弄乱了基本的焦点行为，并使上述所有解决方案变得无关紧要，您仍然可以这样做：

1 - 注意获得焦点的元素（不管它是什么！）

2 - 在 xxx.xaml.cs 后面的代码中添加它

```
private bool _firstLoad; 
```

3 - 将此添加到获得第一个焦点的元素上：

```
GotFocus="Element_GotFocus" 
```

4 - 在后面的代码中添加 Element_GotFocus 方法，并指定需要第一个焦点的 WPF 命名元素：

```
private void Element_GotFocus(object sender, RoutedEventArgs e)
{
    if(_firstLoad)
    {
        this.MyElementWithFistFocus.Focus();
        _firstLoad = false;
    }
} 
```

5 - 管理 Loaded 事件

在 XAML 中

```
Loaded="MyWindow_Loaded" 
```

在 xaml.cs 中

```
private void MyWindow_Loaded(object sender, RoutedEventArgs e)
{
        _firstLoad = true;
        this.Element_GotFocus(null, null);
} 
```

希望这将有助于作为最后的解决方案

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-04-26T14:11:26.140

我也面临同样的问题。我在画布容器内有三个文本框，并希望在用户控件打开时将第一个文本框聚焦。WPF 代码遵循 MVVM 模式。我创建了一个单独的行为类来聚焦元素并将它绑定到我的视图，就像这样。

画布行为代码

```
public  class CanvasLoadedBehavior : Behavior<Canvas>
{
    private Canvas _canvas;
    protected override void OnAttached()
    {
        base.OnAttached();
        _canvas = AssociatedObject as Canvas;
        if (_canvas.Name == "ReturnRefundCanvas")
        {

            _canvas.Loaded += _canvas_Loaded;
        }

    }

    void _canvas_Loaded(object sender, RoutedEventArgs e)
    {
        FocusNavigationDirection focusDirection = FocusNavigationDirection.Next;

        // MoveFocus takes a TraveralReqest as its argument.
        TraversalRequest request = new TraversalRequest(focusDirection);
        UIElement elementWithFocus = Keyboard.FocusedElement as UIElement;
        if (elementWithFocus != null)
        {
            elementWithFocus.MoveFocus(request);
        }

    }

} 
```

查看代码

```
<Canvas  Name="ReturnRefundCanvas" Height="200" Width="1466" DataContext="{Binding RefundSearchViewModel}">
                <i:Interaction.Behaviors>
                    <b:CanvasLoadedBehavior />
                </i:Interaction.Behaviors>
                <uc:Keyboard Canvas.Left="973" Canvas.Top="111" ToolTip="Keyboard" RenderTransformOrigin="-2.795,9.787"></uc:Keyboard>
                <Label  Style="{StaticResource Devlbl}" Canvas.Left="28" Content="Return and Refund Search" Canvas.Top="10" />
                <Image Height="30" Width="28" Canvas.Top="6" Canvas.Left="5" Source="pack://application:,,,/HomaKiosk;component/images/searchF.png">
                    <Image.OpacityMask>
                        <ImageBrush ImageSource="pack://application:,,,/HomaKiosk;component/images/searchF.png"/>
                    </Image.OpacityMask>
                </Image>

                <Separator Height="4" Canvas.Left="6" Margin="0" Canvas.Top="35" Width="1007"/>

                <ContentControl Canvas.Top="45" Canvas.Left="21"
                    ContentTemplate="{StaticResource ErrorMsg}"
                    Visibility="{Binding Error, Converter={c:StringNullOrEmptyToVisibilityConverter}}" 
                    Content="{Binding Error}" Width="992"></ContentControl>

                <Label  Style="{StaticResource Devlbl}" Canvas.Left="29" Name="FirstName" Content="First Name" Canvas.Top="90" />
                <wpf:AutoCompleteTextBox  Style="{StaticResource AutoComp}" Height="32" Canvas.Left="33" ToolTip="First Name"  Canvas.Top="120" Width="205"                     Padding="10,5" TabIndex="1001"
                    VerticalAlignment="Top"

                    Watermark=""
                    IconPlacement="Left"
                    IconVisibility="Visible"
                    Delay="100"

                    Text="{Binding FirstName, Mode=TwoWay, TargetNullValue=''}" 
                    Provider="{Binding FirstNameSuggestions}">
                    <wpf:AutoCompleteTextBox.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="5">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="{Binding}"
                   FontWeight="Bold" />
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </wpf:AutoCompleteTextBox.ItemTemplate>
                </wpf:AutoCompleteTextBox>

                <Label Style="{StaticResource Devlbl}" Canvas.Left="250" Content="Last Name" Canvas.Top="90" />
                <wpf:AutoCompleteTextBox  Style="{StaticResource AutoComp}" Height="32" ToolTip="Last Name" Canvas.Left="250"  Canvas.Top="120" Width="205" Padding="10,5"  TabIndex="1002"
                    VerticalAlignment="Top"
                    Watermark=""
                    IconPlacement="Left"
                    IconVisibility="Visible"
                    Delay="100"
                   Text="{Binding LastName, Mode=TwoWay, TargetNullValue=''}" 
                    Provider="{Binding LastNameSuggestions}">
                    <wpf:AutoCompleteTextBox.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="5">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="{Binding}"
                   FontWeight="Bold" />
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </wpf:AutoCompleteTextBox.ItemTemplate>
                </wpf:AutoCompleteTextBox>

                <Label Style="{StaticResource Devlbl}" Canvas.Left="480" Content="Receipt No" Canvas.Top="90" />
                             <wpf:AutoCompleteTextBox  Style="{StaticResource AutoComp}" Height="32" ToolTip="Receipt No" Canvas.Left="480"  Canvas.Top="120" Width="205" Padding="10,5"  TabIndex="1002"
                    VerticalAlignment="Top"
                    Watermark=""
                    IconPlacement="Left"
                    IconVisibility="Visible"
                    Delay="100"
                    Text="{Binding ReceiptNo, Mode=TwoWay, TargetNullValue=''}" 
                    Provider="{Binding ReceiptIdSuggestions}">
                    <wpf:AutoCompleteTextBox.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="5">
                                <StackPanel Orientation="Vertical" >
                                    <TextBlock Text="{Binding}"
                   FontWeight="Bold">

                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </wpf:AutoCompleteTextBox.ItemTemplate>
                    <i:Interaction.Behaviors>
                        <b:AllowableCharactersTextBoxBehavior RegularExpression="^[0-9]+$" MaxLength="15" />
                    </i:Interaction.Behaviors>
                </wpf:AutoCompleteTextBox>
                <!--<Label Style="{StaticResource Devlbl}" Canvas.Left="710" Content="Duration" Canvas.Top="79" />-->
                <!--<ComboBox AllowDrop="True" Canvas.Left="710" ToolTip="Duration" Canvas.Top="107" Width="205" TabIndex="1004"
                    Style="{StaticResource CommonComboBox}"      
                    ItemsSource="{Binding Durations}" DisplayMemberPath="Description" SelectedValuePath="Id" SelectedValue="{Binding SelectedDate, Mode=TwoWay}">

                </ComboBox>-->

                <Button Content="Search" Style="{StaticResource MyButton}" ToolTip="Search" 
                    Canvas.Top="116" Canvas.Left="710" Cursor="Hand" 
                    Command="{Binding SearchCommand}" TabIndex="2001">
                </Button>
                <Button Content="Clear" Style="{StaticResource MyButton}"  ToolTip="Clear"
                    Canvas.Top="116" Canvas.Left="840" Cursor="Hand" 
                    Command="{Binding ClearCommand}" TabIndex="2002">
                </Button>
                <Image Height="25" Width="25" Canvas.Top="175" Canvas.Left="25" Source="pack://application:,,,/HomaKiosk;component/images/chkpending.png"/>
                <Label  Style="{StaticResource LegendLbl}" Canvas.Left="50" Content="Check Returned and Payment Pending" Canvas.Top="178" />
                <Image Height="25" Width="25" Canvas.Top="175" Canvas.Left="300" Source="pack://application:,,,/HomaKiosk;component/images/chkrepaid.png"/>
                <Label  Style="{StaticResource LegendLbl}" Canvas.Left="325" Content="Repaid" Canvas.Top="178" />
                <Image Height="25" Width="25" Canvas.Top="175" Canvas.Left="395" Source="pack://application:,,,/HomaKiosk;component/images/refund.png"/>
                <Label  Style="{StaticResource LegendLbl}" Canvas.Left="415" Content="Refunded" Canvas.Top="178" />
                 </Canvas> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-11T21:01:35.717

上面的解决方案对我来说没有按预期工作，我稍微改变了 Mizipzor 提出的行为如下：

从这部分

```
if ((bool)args.NewValue)
        {
            control.Loaded += (sender, e) =>
                   control.MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
        } 
```

对此

```
if ((bool)args.NewValue)
        {
            control.Loaded += (sender, e) => control.Focus();
        } 
```

而且我没有将此行为附加到 Window 或 UserControl，而是为了控制我想最初关注的焦点，例如：

```
<TextBox ui:FocusBehavior.InitialFocus="True" /> 
```

哦，对不起，我使用 InitialFocus 名称作为附加属性的不同命名。

这对我有用，也许它可以帮助别人。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-06-23T19:08:30.293

```
<Window FocusManager.FocusedElement="{Binding ElementName=yourControlName}"> 
```

# c# - ADO.Net Entity 框架对象导航？

> ID：817616
> 
> 赞同：1
> 
> 时间：2009-05-03T18:01:36.517
> 
> 标签：c#, entity-framework

我正在使用 ADO.Net Entity Framework 和 C# 来检索目标的语言：

```
var list =
   from dd in guiaContext.DestinationDetail
   where dd.id_destination == destinationID
   select dd; 
```

但是当我在 foreach 中访问语言时：

```
foreach (DestinationDetail detail in list)
   languagesList.Add(detail.Language.ds_language); 
```

detail.Language 为空。为什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T18:46:24.710

是否有 2 个表：目的地和语言？目的地和语言表之间是否存在外键关系？

这将有助于评论上述语言为空的问题。

默认情况下，EF 不检索引用的表（延迟加载）。

尝试这个 ：

var list = from dd in guiaContext.DestinationDetail Include("Language") where dd.id_destination == destinationID select dd;

查看以下有关在实体框架中预加载的链接：http: [//msdn.microsoft.com/en-us/library/bb896272.aspx](http://msdn.microsoft.com/en-us/library/bb896272.aspx)

# model-view-controller - 什么是 SOFEA？

> ID：817617
> 
> 赞同：27
> 
> 时间：2009-05-03T18:01:45.363
> 
> 标签：model-view-controller, web-applications, sofea

我遇到了这个新的首字母缩写词 SOFEA，它显然是一种新的 Web 应用程序编程范式。

仍然无法理解它 - 如果有人自愿让我更清楚，我将非常感激。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-03T18:07:48.547

SOFEA 是面向服务的前端应用程序/架构的缩写，它指的是一种 Web 应用程序架构，其中所有 UI 功能都由 JavaScript 或基于 Flash 的逻辑提供。它本身不与 Web 服务器交互以提供对数据的应用程序级访问，而是通过 AJAX 与 Web 服务交互。本质上，您在一个（或几个）网页中提供所有 UI 逻辑。这些页面与 Web 服务一起使用以访问和更新数据。

InfoQ 的[参考资料](http://www.infoq.com/news/2008/03/tsa-working-group-site)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-29T11:29:15.793

顺便说一句，AKA SOUI...（面向服务的 UI）参考：[这里](http://www.infoq.com/news/2007/11/soui-death-of-mvc2)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-08T13:16:52.667

作为对上述响应的集成，作为两个解耦层表示和业务逻辑之间通信的替代方案，您可以使用不同的技术和技术，如 XML 或 Json，使用 REST 和 RESTFUL 范式甚至 SOAP，最后但绝对不是最不重要的 websocket。

# c++ - 全新的C（如何编译？）

> ID：817627
> 
> 赞同：3
> 
> 时间：2009-05-03T18:06:47.423
> 
> 标签：c++, c

我想知道我应该用什么来编译 C。我对一般的编程是全新的，非常感谢对这个过程的全面解释。我在 Windows Vista 上。

我听说过一种名为“djgpp”的东西，它对 Windows 来说是免费且有效的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T18:10:41.317

取决于哪个平台，但在 Linux、Mac OS X 和类似平台（包括 Cygwin）上，[gcc](http://gcc.gnu.org/)是最常见的。

假设我有一个名为`myapp.c`：

```
#import <stdio.h>

int main(){
        printf("Hi!\n");
        return 0;
} 
```

使用 gcc 从命令行编译它非常简单，只需运行：

```
gcc myapp.c 
```

..将二进制文件输出为“a.out”（默认文件名）。要运行已编译的应用程序，只需执行..

```
./a.out
#which outputs: Hi! 
```

或者把它放在你的 $PATH 中的某个地方（例如，`/usr/bin`或`~/bin/`）并运行`a.out`

`-o`您可以使用以下标志指定输出文件名：

```
gcc myapp.c -o myapp
./myapp
# output: Hi! 
```

至于更完整的指南，[“Learn C for Cocoa”](http://cocoadevcentral.com/articles/000081.php)是一本很好的 C 语言快速指南，涵盖了编译。如果您对学习 ObjC 感兴趣，[该指南的下一部分](http://cocoadevcentral.com/d/learn_objectivec/)也很棒。

在 Windows 上，我建议查看 Visual Studio，特别是[Express 版本](http://www.microsoft.com/Express/)（免费）。

没有“Visual C”，但 Visual C++ 版本将编译 C 代码（因为 C++ 是 C 的扩展）。在构建选项中的某处还有一个“编译为 C 代码”选项。

最后，[《C 编程语言](https://rads.stackoverflow.com/amzn/click/com/0131103628)》一书涵盖了一切。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-03T18:11:47.227

对于这个问题的答案以及您在开始时可能会遇到的许多其他问题，请尝试 [此网站][1]，其中包含初学者教程。[这是关于编译器和设置的页面][2]。您可以使用哪些编译器的摘录：

**视窗/DOS**

*   代码::块和 MINGW
*   博兰
*   DJGPP
*   Dev-C++ 和数字火星

**仅限 Windows**

*   微软视觉 C++
*   尼克斯
*   g++ 是大多数 *nix 发行版附带的 C++ 编译器。
*   gcc 是大多数 *nix 发行版附带的 C 编译器。

**Macintosh** - XCode

```
 Personally, I'd also recommend you strongly to read [The C Programming Language by Kernighan and Ritchie.][3] It will really help you understand both core principles of programming as well as C-specific details.

  [1]: http://www.cprogramming.com/tutorial/c/lesson1.html
  [2]: http://www.cprogramming.com/compilers.html
  [3]: http://www.amazon.com/C-Programming-Language-2nd-Ed/dp/0131103709/ref=ed_oe_h 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-03T18:20:02.307

[Visual Studio Express](http://www.microsoft.com/Express/)是微软领先的 Windows IDE 的免费版本，它包括一个 C 开发环境（编辑器、编译器、调试器）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-03T18:24:57.943

如果您打算长时间使用 C 语言，我建议您使用 gcc 并熟悉命令行。*nixes 可能已经内置了它，在 Windows 上你可以安装[MingW GCC](http://www.mingw.org/wiki/HOWTO_Install_the_MinGW_GCC_Compiler_Suite)并以相同的方式使用它。

我觉得这很有帮助，因为我觉得 C 是与 Unix 携手设计的，所以最好坚持使用命令行而不是直接使用 IDE。大多数教程可能会假设您使用的是 gcc。此外，如果您只是使用 gcc 学习 C，您只需键入`gcc -o outputfile sourcefile.c`，而如果您从 IDE 开始，则必须弄清楚 IDE 是如何工作的。

在学习方面，一定要选择 Kernighan 和 Ritchie 的“The C Programming Language”，因为它是 C 的权威书籍。体积小巧，易于阅读。

请注意，gcc 的另一个有用的编译器标志是 -g，如`gcc -o output -g -Wall sourcefile.c`. -g 启用调试符号，这在您以后想用 gdb 开始调试时会很有用。这是您应该从 gcc 而不是 IDE 开始的另一个原因，它使继续使用 gdb 更容易。

你总是可以使用 MS Visual C++，但我认为它对于初学者来说太复杂了。我个人推荐使用[Notepad++](http://notepad-plus.sourceforge.net)进行编辑，因为它不会为您做太多事情，但它可以很好地格式化代码。当然，一旦您变得更有经验，您可能希望继续使用具有项目管理等功能的成熟 IDE（或者更好的是，[emacs](http://www.gnu.org/software/emacs/) ;)），但是当您刚开始时，更简单可能会更好。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-03T18:14:15.287

如果您使用的是 Unix（即 Linux、Mac OS X、FreeBSD、Cygwin 下的 Windows 等），我推荐[使用 GNU Compiler Collection](http://gcc.gnu.org/) (gcc)。要编译文件`hello.c`，请在命令提示符下运行：

```
gcc hello.c 
```

这将编译`hello.c`为可执行文件`a.out`。如果你想要一个更好命名的可执行文件，试试这个：

```
gcc -o hello hello.c 
```

这将编译`hello.c`为可执行文件`hello`。一些更有用的标志：

```
gcc -Wall -Wextra -o hello hello.c 
```

这会打开许多​​有用的警告，这些警告可能会帮助您发现代码中的错误。

在 Windows 上，很多人使用 Microsoft Visual C++，但我对 Windows 没有真正的经验。正如我上面提到的，您可以安装 Cygwin，然后使用上述步骤，但许多人更喜欢纯 Windows 编译。此外，[MinGW](http://www.mingw.org/)是 gcc 的原生 Windows 端口。不过，这都是偏好问题。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-03T18:18:52.653

欢迎编程！

您可能希望从正确的轨道开始，并在您的盒子中安装 Linux 的副本。试试 Ubuntu，因为它易于安装和学习

接下来学习使用控制台！在接下来的几年里，它将对你有很大帮助。

安装 ubuntu 后，您需要安装 C 编译器和基本库，只需在控制台中输入

```
sudo apt-get install gcc build-essential 
```

然后只需创建一个 C 文件并运行

```
gcc myprogram.c -o myprogram 
```

这将生成一个名为 yourprogram 的 exec 文件，使用

```
./myprogram 
```

以下是一些有用的链接：

*   [Ubuntu 主页](http://www.ubuntu.com)
*   [在 Ubuntu 论坛中编译/运行 C](http://ubuntuforums.org/showthread.php?t=29698)
*   [Linux 教程 - 阅读本文！](http://www.linux-tutorial.info/modules.php?name=MContent&pageid=224)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-03T19:12:54.037

我建议下载 Microsoft Visual C++ Express Edition。[http://www.microsoft.com/express/vc/](http://www.microsoft.com/express/vc/) DJGPP 将作为编译器工作，但不提供编辑器或编码环境。编译代码涉及到命令行。有些人建议使用 gcc 或 MinGW，但这两个程序的行为与 DJGPP 相似。使用单独的编辑器并从命令行编译代码并不是通常在 Windows 环境中编写软件的方式。Visual C++ 将允许您编写和编译 C 或 C++ 代码。

Microsoft Visual C++ 是一个免费的开发环境，包括一个编辑器和一个编译器。只需下载安装程序可执行文件并运行它即可安装。安装程序将从 Internet 下载必要的软件并将其安装到您的计算机上。安装程序将下载大约 200MB 的软件，因此根据您的连接速度，下载可能需要一个小时。

安装 Visual C++ 后，开始一个新项目并编写代码。然后，您可以直接从 Visual C++ 内部编译和构建它并查看输出。从编写一个简单的命令行程序开始，然后开发出更有趣的程序。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-03T18:20:41.743

好的 Josiah，首先，确保在您的系统上安装了 C 编译器。在 Linux、Mac 上，有一个开箱即用的编译器，称为 GCC 编译器。在 Windows 上，您需要安装一个，我建议您安装一个 IDE（如 devshed），其中包括编辑器、编译器、调试器……开发 C/C++ 应用程序所需的一切。

为了在 Linux/Mac 上编译，首先您需要一个源文件（包含代码的文本文件）并将其保存为 .c 或 .cpp 扩展名。然后打开你的终端并输入：

```
gcc <fileName.c> 
```

您应该替换`<fileName.c>`为您的文件名（完整路径，或者首先转到文件位置并输入文件名）。

这将在源文件的同一路径中创建一个 .o 文件（和目标文件），这是您计算机的可执行文件！

在 Windows 上，如果您已经安装了 IDE，则更容易，您只需单击编译按钮即可！

我希望这对你有帮助

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-03T18:21:39.183

现在对于 Windows，您可以使用上面提到的 gcc，也可以使用 MSC。[您可以使用Visual Studio Express](http://www.microsoft.com/Express/)捆绑包免费获得编译器，用于[Visual C++ Express](http://go.microsoft.com/?linkid=7729279)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-03T18:35:32.067

从命令行调用编译器对于小型应用程序来说很好，因为您已经习惯了 C 语法，但是随着您继续前进，您会发现输入无数选项变得乏味，您将需要使用构建工具。 [make](http://www.gnu.org/software/make/manual/make.html#Introduction)是一种轻松编译项目的基本但强大的方法。手动编辑 makefile 可能很乏味，并且会妨碍你的学习，所以我建议直接跳过它并使用[autotools](http://www.lrde.epita.fr/~adl/autotools.html)工具链。

# c# - 使用带有动态添加控件的锚属性

> ID：817631
> 
> 赞同：5
> 
> 时间：2009-05-03T18:07:39.373
> 
> 标签：c#, winforms

我在运行时动态地将一些文本框添加到表单中。一切正常，即文本框对齐、锚定并自动调整大小**，直到表单最大化。**在最大化表单时，文本框被添加到相同的位置，而表单**没有**最大化。这会导致文本框错位。

在窗口状态正常和最大化时，如何确保所有文本框都位于相同的位置和相同的大小？

编辑：

顺便说一句，我正在使用 C#

编辑：

流布局面板在这里有用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-05-04T10:42:42.460

这是一个很老的问题，但也许我能够回答。

在阅读了您的所有评论后，我想我可以将您的问题总结为：

*   您有一个特定大小的表单，并在运行时在特定位置添加一些控件，并将锚点设置为`Top | Right`.
*   如果您只是显示表单并让控件出现，一切正常
*   如果您最大化您的表单（或更改它的大小），您的控件将不会再出现在您想要的正确位置。

要摆脱这个问题，您可以尝试一些不同的方法：

1.  使用[FlowLayoutPanel](http://msdn.microsoft.com/en-us/library/zah8ywcc.aspx)，注意[FlowDirection](http://msdn.microsoft.com/en-us/library/system.windows.forms.flowdirection.aspx)，也许只是事先创建所有需要的控件，然后切换可见状态。
2.  为新创建的控件的位置使用正确的值。

第二点是你的错误（我认为）。如果您的表单具有原始大小，您会找到某种方法来计算控件的位置。如果表单的大小发生变化（例如最大化），要获得正确的位置，您必须考虑几个因素。

*   从默认大小到当前大小的增量值。
*   您希望在控件上设置的锚点。

在您的情况下，您想放置一个被锚定的控件`Top | Right`，但位置由`Top | Left`. 在这种情况下，您必须计算 control.location.x 和 form.width 的默认大小之间的差异。然后你把这个差值从表格当前宽度中减去。现在您可以将控件放在此位置（因为 Top 永远不会通过调整大小而改变）。如果你有一个锚点，`Bottom | Right`你必须用 control.location.y 和 form.height 计算相同的值。

如果没有锚点、for`Top | Bottom`或被`Left | Right`设置，则行为和计算留给读者作为练习。;-)

最后但并非最不重要的还有另一种 hacky 方法可以让您在正确的位置进行控制：

*   如果您想在某处放置一个新控件，请将其更改`Form.Visible`为`false`
*   保存表单状态、大小和位置
*   将它们更改为您的默认值
*   添加所需的控件
*   恢复以前保存的值
*   使表单再次可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T04:28:13.937

Anchor 属性指定控件应确保它们与哪些边框始终保持相同的距离。它可能会变得非常混乱，这就是为什么当锚定到右边界时你会看到事情发生变化的原因。

如果您只是想确保文本框显示相对于自身保持一致，我建议放下一个面板，锚定在面板上，然后将文本框添加到面板。文本框上的 X 和 Y 坐标是相对于 Panel 的，因此布局更容易，尤其是当 Panel 的位置突然改变时。

# upnp - MiniUPnP 和 UPnP 设备

> ID：817633
> 
> 赞同：0
> 
> 时间：2009-05-03T18:07:42.540
> 
> 标签：upnp

我正在尝试使用 MiniUPnP。在测试 testupnpigd.py 我有一个错误：

> 发现... 延迟 = 200 毫秒 0 个设备检测到异常：未发现 UPnP 设备

我应该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-03T03:53:31.103

使用其他工具验证您的 SSDP 广播是否实际获得回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-30T17:26:03.410

MiniUPnP 可能还不支持您的路由器？尝试联系作者。

# c# - XP 在尝试连接到我的 Web 服务时出现错误 1825

> ID：817639
> 
> 赞同：-1
> 
> 时间：2009-05-03T18:08:41.383
> 
> 标签：c#, web-services

我一直在使用 W2k8+IIS7/SQLExpress 2008/Web Service/Windows 客户端使用 C# 创建一个应用程序。我会非常坦率地说明我正在学习如何设置 SQL 和 IIS 以及它们的安全性。我不需要严格的 SSL 安全性或任何其他安全性，因为这是我公司内部的一个 Intranet 页面。我知道我设置 SQL 和 IIS 以使用 NTAUTH_SERVICE 并且 SQL 处于混合模式。

一切都在 Vista 和 Win7 上运行，除了 Windows XPSP3 x86 不会与服务对话。Windows 客户端的目的是通过 WMI 收集机器规格，然后将其发送到 Web 服务。即使我在机器上安装 VS 2008 SP1 进行远程调试（附加到我的服务器上的进程），我也会收到以下错误代码 1825：

***Windows 错误消息 1825：“RPC_S_SEC_PKG_ERROR”发生了特定于安全包的错误。***

有没有人对如何解决这个问题有想法？或者是什么原因造成的？非常感谢 =)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T03:18:29.893

这可能只是一个变通办法或小问题......或修复本身 - 在网站的 IIS 设置中将“连接超时”从默认的 2 分钟更改为 8 分钟修复了整个问题。

# c# - 我有一个文件并且需要随机序列化多个对象。我怎么能在c#中？

> ID：817641
> 
> 赞同：6
> 
> 时间：2009-05-03T18:10:26.293
> 
> 标签：c#, serialization, object

我有一个文件，并且需要在创建新对象时序列化同一类的多个对象。我不能将它们存储在数组中，因为我需要在创建对象的实例时对它们进行序列化。请帮我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T18:59:03.213

What serialization mechanism are you using? `XmlSerializer` might be a problem because of the root node and things like namespace declarations, which are a bit tricky to get shot of - plus it isn't great at partial deserializations. `BinaryFormatter` is very brittle to begin with - I don't recommend it in most cases.

One option might be [protobuf-net](http://code.google.com/p/protobuf-net/); this is a binary serializer (using Google's "protocol buffers" format - efficient, portable, and version-tolerant). You can serialize multiple objects to a stream with `Serializer.SerializeWithLengthPrefix`. To deserialize the same items, `Serializer.DeserializeItems` returns an `IEnumerable<T>` of the deserialized items - or you could easily make `TryDeserializeWithLengthPrefix` public (it is currently private, but the source is available).

Just write each object to file after you have created it - job done.

If you want an example, please say - although the unit tests [here](http://code.google.com/p/protobuf-net/source/browse/trunk/Examples/ItemsWithLengthPrefix.cs) give an overview.

It would basically be something like (untested):

```
using(Stream s = File.Create(path))
{
    Serializer.SerializeWithLengthPrefix(s, command1, PrefixStyle.Base128, 0);
    ... your code etc
    Serializer.SerializeWithLengthPrefix(s, commandN, PrefixStyle.Base128, 0);
}
...
using(Stream s = File.OpenRead(path)) {
    foreach(Command command in
           Serializer.DeserializeItems<Command>(s, PrefixStyle.Base128, 0))
    {
       ... do something with command
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T18:16:00.320

[在这里](https://stackoverflow.com/questions/803600/how-to-serialize-on-to-existing-file/803637#803637)查看答案。

简而言之，只需将所有内容序列化到同一个文件流，然后反序列化。dotNet 会知道每个对象的大小

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T20:57:19.573

对于每个到达的对象，我们会将其转换为 Base64Encoded 字符串，并将其作为一行存储在文本文件中。因此，在这个文件中，每一行每行都有一个序列化对象。在读取时，我们将一次读取一行文件并将这个 Base64 编码的字符串反序列化到我们的对象中。容易..所以让我们试试代码。

[http://www.codeproject.com/KB/cs/serializedeserialize.aspx?display=Print](http://www.codeproject.com/KB/cs/serializedeserialize.aspx?display=Print)

# asp.net-mvc - 序列化 MVC ViewDataDictionary

> ID：817650
> 
> 赞同：0
> 
> 时间：2009-05-03T18:12:58.737
> 
> 标签：asp.net-mvc

我将 SQL 状态服务器用于会话变量。我还将 ViewData 存储在 TempData 中，以便可以通过重定向访问 ModelState。问题是 ViewDataDictionary 不可序列化。当存储 Session 变量时，有没有办法挂钩到会话存储逻辑以序列化 ViewDataDictionary？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T18:17:08.257

我认为您正在打破 MVC 模式的基本思想。

你不应该需要 session 变量。您将模型传递给视图，然后将模型传递回控制器。它是否是重定向并不重要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T21:15:07.740

我没有将整个 ViewData 字典存储在 TempData 中，而是存储了我需要的值。有点hacky，但它现在可以工作。

# php - PHP/MySQL 更新代码

> ID：817653
> 
> 赞同：1
> 
> 时间：2009-05-03T18:15:14.393
> 
> 标签：php, mysql, database

我正在尝试将行更新从 php 调用到 mysql 数据库。它失败了，但是当我尝试调用格式相同的插入新行时，它可以工作。

```
$result = mysql_query("INSERT INTO auth (username, password, studycode, description, server) VALUES ('$username', '$password', '$studycode', '$description', '$server')"); 
```

但是这段代码失败了

```
$result = mysql_query("UPDATE auth SET username='$username', password='$password', studycode='$studycode', description='$description', server='$server' WHERE index='$id' LIMIT 1;"); 
```

index 是第一列，它是表的键/ID。

编辑：好的，所以我刚刚进入 mysql admin 并尝试了我的代码将发送的确切命令来跟踪错误。

```
UPDATE auth SET username='username', password='password', studycode='ab9102y', description='test change', server='server2' WHERE index='5' LIMIT 1; 
```

给我错误

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'index='5' LIMIT 1' at line 1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-03T18:28:24.660

可能是索引的保留关键字问题。尝试：

```
$result = mysql_query("UPDATE auth SET username='$username', password='$password', studycode='$studycode', description='$description', server='$server' WHERE `index` ='$id'"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T18:32:27.533

我相信这是因为这个词`index`是 MySQL 中的保留词。在那里，您需要将 where 子句更改为：

```
WHERE `index` = '$id' 
```

注意索引周围的刻度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T18:53:28.793

为了避免这类问题，我通常这样命名我的表：（例如，用户表）

```
> CREATE TABLE usr_user (
>          usr_id INT,
>          usr_name VARCHAR(100),
>          usr_email VARCHAR(100) ); 
```

附注：了解准备好的陈述；我会非常害怕使用您那里的 SQL 代码。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-03T18:18:38.660

你有“UPDATE atuh”而不是“UPDATE auth”。此处或您的代码中的拼写错误？

编辑：尝试删除 index = '$id' 周围的引号，并且您还想从[PHP](http://us.php.net/function.mysql-query)中的查询中删除分号。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-03T18:25:27.287

试试这个

$result = mysql_query("UPDATE auth SET username='$username', password='$password', studycode='$studycode', description='$description', server='$server' WHERE index='$id' ");

# asp.net - 如何让我的 ASP.NET 应用程序始终“活着”，如果这是一个坏主意，我为什么不这样做呢？

> ID：817655
> 
> 赞同：8
> 
> 时间：2009-05-03T18:15:40.337
> 
> 标签：asp.net, performance, iis-7

我最近在我闪亮的新 VPS 上部署了一个 ASP.NET 应用程序，虽然我对 VPS 可以提供共享托管解决方案的总体性能提升感到满意，但我对我的应用程序的启动时间不满意。

当我的客户第一次点击它时，我的 Web 应用程序需要相当长的时间才能启动。我没有在调试模式下运行它（在我的 web.config 中禁用它），它在启动时没有任何实际工作要做 - 我的应用程序启动事件处理程序中没有代码，我没有启动任何多余的线程，什么都没有。我的客户第一次点击我的应用程序需要 15-20 秒才能做出响应。后续调用需要 1-2 秒，除非我等待几分钟让我的应用程序关闭。然后又回到 15-20 秒的启动时间。

（我知道我的计时基准非常不科学，这些数字应该只是让我对我的应用程序启动时的性能有所了解）。

我对 ASP.NET 的理解是 IIS（在本例中为 7.0），它会在第一次运行 Web 应用程序时对其进行编译，然后缓存这些二进制文件，直到 Web 应用程序发生更改。我的理解不正确吗？

所以，在那本书大小的序言之后，这是我的问题：

*   我对 ASP.NET 编译的理解不正确吗？它实际上是如何工作的？
*   有没有办法强制 IIS 缓存我的二进制文件，或者让我的应用程序无限期地保持活动状态？
*   如果在我之前的问题中做任何一件事情都是一个坏主意，为什么这是一个坏主意，我能做些什么来提高启动性能？

谢谢！

**编辑：**看来我的问题与[这个问题](https://stackoverflow.com/questions/781357/how-do-i-set-up-my-iis-to-keep-my-application-alive)略有重复（我认为我在这里搜索答案的工作做得更好，哈哈）。但是，我认为我的问题更全面，如果它没有作为副本关闭，我将不胜感激，除非这里有更好的、已经提出的问题来解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T18:46:43.100

IIS 还会在给定时间段后关闭您的 Web 应用程序，具体取决于其配置。我不太熟悉 IIS7 以及在哪里配置它，所以您可能想对如何配置它做一些研究（[起点？](http://www.iis.net/ConfigReference/system.applicationHost/applicationPools/add/recycling/periodicRestart)）。

不好吗？取决于你的代码有多好。如果您没有泄漏内存或资源，则可能不会。

另一种解决方案是[预编译您的网站](http://msdn.microsoft.com/en-us/library/399f057w.aspx)。这可能是您更好的选择。但是，您必须检查并查看它，因为它可能会带来不利影响，具体取决于您与网站的交互方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T18:32:37.190

> 我对 ASP.NET 的理解是 IIS（在本例中为 7.0），它会在第一次运行 Web 应用程序时对其进行编译，然后缓存这些二进制文件，直到 Web 应用程序发生更改。我的理解不正确吗？

那是对的。具体来说，程序集被构建为卷影副本（不要与卷快照服务/卷影副本功能混淆）。这使您可以在不影响现有运行会话的情况下即时替换文件夹中的代码。ASP.NET 将检测到更改，并将新版本编译到目标目录（通常是`Temporary ASP.NET Files`. 有关该过程的更多信息：[了解 ASP.NET 动态编译](http://msdn.microsoft.com/en-us/library/ms366723.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T19:02:19.117

如果纯粹是编译时间，那么通常最有效的方法是在回收后自己访问网站。定期拨打电话以确保收到 15 秒延迟的是您而不是您的客户。

但是，如果这是所有编译时间（取决于硬件），我会感到惊讶-您是否有很多静态类实例？他们在创业方面做了大量工作吗？

通过跟踪或分析，您可能很快就可以确定启动时间花费在哪里。

As to why keeping a process around is a bad idea, I believe its due to clear-up. No matter how well we look after our data or how well behaved the GC is, there is a good clear-up performed by restarting the process. Things like fragmentation can go away and any other resource issues that build up over time are cleared down. Therefore it is quite a bad idea to keep a server process running indefinitely.

# delphi - Delphi - 如何重新启用调试器异常通知？

> ID：817658
> 
> 赞同：23
> 
> 时间：2009-05-03T18:17:16.293
> 
> 标签：delphi, exception, configuration, debugging, settings

我在 D2009 中打开了一个项目（在 D2007/08 中创建），它会编译但在执行时会抛出大量异常。奇怪的事情，但我知道这个项目一团糟，所以我想继续修复它。好吧，不是真的解决所有问题，只要让它工作就足够了。

当我运行它时，我收到了一些调试器异常通知（带有中断、继续、帮助按钮的小消息对话），我想继续看看是否在跳过异常时可能会起作用。我检查了左下角的小“忽略此异常类型”复选框，然后单击继续。现在我不再收到异常通知，但应用程序仍然没有运行。我只是得到几个模糊的错误框，对发生了什么一无所知。

我想重新启用我之前选择忽略的异常类型。但我在任何地方都找不到选项。我应该在哪里寻找这个？任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-03T18:49:13.890

我在

`(Main menu) Tools >> Options >> Debugger Options >> CodeGear Debuggers >> Language Exceptions >>`并且有被忽略的异常类型列表。

它比 D2005 更隐蔽，但与 Stuart Dunkeld 引用的文章中所说的非常接近。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-05-03T18:33:41.993

以下内容摘自[Rob Kennedy 的 Delphi Q&A 页面](http://pages.cs.wisc.edu/~rkennedy/exception-messages)：（CC 许可）虽然它与 Delphi 2005 相关，但它可能会有所帮助。

# 为什么我编写了异常处理程序后仍会收到错误消息？

在其默认设置中，每当您的程序中发生异常时，Delphi IDE 都会通知您，如图 1 所示。重要的是要意识到，此时您的程序的异常处理代码还没有运行。都是德尔福本身；它作为调试器的特殊地位允许它在您的程序中获得任何异常的第一通知，甚至在您的程序知道它之前。

[![在此处输入图像描述](https://i.stack.imgur.com/BGLKY.png)](https://i.stack.imgur.com/BGLKY.png)

### 避免通知

如果您不想在发生异常时收到通知，您有几个选择。

*   您可以使用 Delphi 的“高级断点”来禁用围绕代码区域的异常处理。首先，在您希望 IDE 忽略异常的代码行上设置断点。右键单击装订线中的断点点并打开断点属性对话框。在高级部分是一些复选框。（参见图 2。）清除“中断”框以防止调试器在该行中断您的程序，并设置“忽略后续异常”框。

    然后，在您希望调试器继续处理异常的位置设置另一个断点。更改其属性以处理后续异常。

[![在此处输入图像描述](https://i.stack.imgur.com/nZ2p6.png)](https://i.stack.imgur.com/nZ2p6.png)

*   您可以告诉调试器忽略某些类型的异常。图 3 显示了 Delphi 的语言异常选项。将异常类添加到列表中，该类型和任何后代类型的所有异常都将传递给您的程序，而不会受到 Delphi 的干扰。

[![在此处输入图像描述](https://i.stack.imgur.com/QZzsb.png)](https://i.stack.imgur.com/QZzsb.png)

*   在与前一个选项相关的选项中，您可以告诉调试器不要中断任何异常。为此，请清除“通知语言异常”复选框。

*   最后，您可以完全关闭集成调试。Delphi 不会通知您异常，也不会在断点处停止或允许使用“暂停”按钮。在调试器选项中关闭集成调试，如 Delphi 2005 的图 5 所示。

[![在此处输入图像描述](https://i.stack.imgur.com/Bnx0q.png)](https://i.stack.imgur.com/Bnx0q.png)

# sql-server - 如何让我的旧 Dbase 2 progs 在 SQL 下运行？

> ID：817672
> 
> 赞同：0
> 
> 时间：2009-05-03T18:24:17.540
> 
> 标签：sql-server, dbase

如何让我的旧 Dbase 2 progs 在 SQL 下运行？

我想做两件事。

1.  让我的旧 Dbase progs 在我的个人计算机上有大量数据集的 Windows 下运行（所以它不需要互联网）

和 2\. 让我的旧 dbase progs 从 Internet 上的 sql 服务器运行，我可以从 Internet 登录并运行程序和数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T18:41:22.070

试试[http://www.harbour-project.org/](http://www.harbour-project.org/)，也许它可以不加修改地运行你的应用程序。

# architecture - 设计控制台应用程序时的架构考虑？

> ID：817673
> 
> 赞同：12
> 
> 时间：2009-05-03T18:24:52.203
> 
> 标签：architecture, oop, console

我最近编写了一个控制台应用程序，我在设计它的许多方面都经历了很多痛苦，特别是在 C# 中，因为它具有纯 OO 范式。我面临的问题包括从如何传递选项到如何将问题返回到入口点类等等。

我的问题是：你们中的任何人都知道 OO 范式中控制台应用程序的良好设计，以便我可以从中学习吗？**特别**欢迎良好实现的代码。

**编辑：**我不是在命令行 API 之后，而是在良好的设计原则之后，特别是我可以从中学习的好的实现。

**编辑 2：**应用程序中有简单的用户交互，但它不是成熟的 CLI/REPL 排序。或多或少将其视为 TeX 命令。有趣的是，即使有很好的理论（与 X 没有什么不同，使用模式 Y，你应该知道 OO 原理......[你的计算机科学教授会很自豪！]），没有真正的代码我可以拿看看这些概念在行动。同样，在纯 OO 范例中，我应该在哪里寻找（代码！）一个好的命令行应用程序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-03T19:40:18.370

听起来好像您正在构建一个接口，该接口在每次调用时执行几个不同的操作之一。我不确定您指的是“命令行”应用程序（执行一项操作，然后退出）还是 CLI 应用程序（显示提示并重复响应用户输入）。一般来说，前者的构建会比后者简单得多；我认为只有在您的应用程序需要一些通过多个命令演变的持久状态时才有意义使用 CLI。如果您正在处理这样的事情，那么 alphazero 是正确的——您可能应该了解 REPL 并复制一个好的。

无论如何，执行的操作将取决于命令行上传递的参数，所以我将就这部分进行头脑风暴......

将应用程序视为一组不同的“命令”对象是明智的，每种类型的操作都有一个。因此，应用程序的入口点应该是某种 CommandLineDispatcher 对象，它将请求分派到适当的 Command 对象。

为了模块化，调度程序应该配置一个抽象的映射（例如，一个哈希表），以将每个命令标记（通常是命令行字符串的第一个单词）与处理它的命令对象相关联。调度程序还可以处理常见的选项解析，可能使用一些现成的“getopts”库来完成繁重的工作。

简单来说，每个 Command 对象都可以实现一个一致的接口来完成它的工作；也许是这样的：

```
public void execute(List<String> args) 
```

这样，入口点调度程序只找到正在请求的命令，并且`executes`它。

关于错误处理：该`execute()`方法可能只是抛出一个异常来传达错误......异常可以被调度程序捕获和处理，或者简单地记录到屏幕上。或者，失败的命令可以调用一些共享`usage`函数来将错误消息与一般指令结合起来。我认为不必像您建议的那样使“入口点”意识到问题；如果您需要强大的错误处理（例如，用于日志记录或警报功能），这似乎属于可以提供给 Command 对象的单独组件。

一般来说，命令行应用程序与响应用户输入的任何其他应用程序没有什么不同——您需要一个调度程序来解析和路由输入，以及处理程序（又名“控制器”）来执行支持的操作。如果您需要其他服务（日志记录、警报、数据库连接等），您最好创建单独的组件来隔离此逻辑并使用干净的接口公开它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-03T18:28:45.813

当涉及到关键的横切关注点（如日志记录、错误和异常处理、安全性等）时，控制台应用程序与常规 win 表单或 Web 应用程序没有什么不同，

话虽如此，您能否详细说明我们的问题，即他们关注的关键领域在哪里？

您可以从 Microsoft的[App Architecture Guide](http://www.codeplex.com/AppArchGuide/Release/ProjectReleases.aspx?ReleaseId=20586)中借鉴许多模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T18:35:59.040

在 Java 中，我经常使用[Apache CLI](http://commons.apache.org/cli/)，我搜索过“CLI for .NET”，但它似乎还没有实现。也许对您阅读接收控制台参数的 Java 方法很有用。

对于您的应用程序架构，它应该与您在 Web 应用程序中使用的架构没有太大区别，不同之处在于控制台是您的表示层的界面。也许您可以定义一些“控制台控制器”来接收从业务层到控制台的模型，反之亦然。将每个用户输入视为请求；）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T18:39:59.403

在最（极端）一般意义上，控制台应用程序是一种 REPL：

[http://en.wikipedia.org/wiki/REPL](http://en.wikipedia.org/wiki/REPL)

显然，特定领域（控制台）应用程序不支持图灵完备语言，但许多问题重叠，一个好的 REPL 需要是一个非常健壮的命令行应用程序。我相信你可以通过研究典型 REPL 的设计和实现学到很多东西。（大多数 REPL 都是开源的。（尝试 ruby​​ 或 python 用于 OO REPL））

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T20:17:07.940

要使程序具有良好的架构设计，尤其是在 C# 中，您应该熟悉 OO 设计概念以充分利用 OO 范例

# c# - 以二进制、打包格式序列化结构

> ID：817676
> 
> 赞同：2
> 
> 时间：2009-05-03T18:26:46.800
> 
> 标签：c#, .net, serialization

C# 中是否有办法将结构序列化为二进制流（MemoryStream），使得二进制表示等同于结构的视觉布局方式（即无填充）？

在 C/C++ 中，您使用 #pragma 命令告诉编译器打包结构，以便字段之间没有填充。如果您有两个应用程序通过套接字来回传递消息，这将很有帮助。禁用打包后，您可以简单地通过套接字“发送”结构的内容，而不必担心将每个字段单独打包到二进制缓冲区中（如果需要，还必须进行字节顺序交换）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T18:31:47.817

除非您使用不安全的代码，否则不会。使用 Protocol Buffers 或 Thrift 或类似的东西；根据我的经验，我不会推荐 .NET 内置二进制序列化。您还可以使用`BinaryWriter/BinaryReader`（使用反射或预生成序列化代码）进行序列化/反序列化。至于打包，可以通过`[StructLayout]`属性来控制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T19:54:40.457

您可以使用`[StructLayout]`和`[FieldOffset]`属性来控制结构字段的打包方式（谷歌“编组”以获取更多信息），然后使用以下内容生成可以通过网络流发送的结构的二进制表示：

```
public static byte[] GetBytes<TStruct>(TStruct data) where TStruct : struct
{
    int structSize = Marshal.SizeOf(typeof(TStruct));
    byte[] buffer = new byte[structSize];
    GCHandle handle = GCHandle.Alloc(buffer, GCHandleType.Pinned);
    Marshal.StructureToPtr(data, handle.AddrOfPinnedObject(), false);
    handle.Free();
    return buffer;
} 
```

缺点：

*   它不是惯用的.NET
*   您需要非托管代码权限
*   缓冲区固定可能会影响性能
*   您的结构不能有引用（字符串和数组有特殊情况）

# winapi - 如何仅使用 gdi 调用在 win32 中绘制选定的文本？

> ID：817679
> 
> 赞同：0
> 
> 时间：2009-05-03T18:29:01.817
> 
> 标签：winapi, gdi

我尝试使用两个 TextOut 调用和 TA_UPDATECP 标志来绘制选定的文本，但是当我移动选定的区域时，字符会移动一点。

有人知道正确的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T14:17:20.377

我相信抗锯齿和 ClearType 可以在小数像素位置绘制文本。如果您绘制一串文本，然后尝试重新绘制中间的一部分，则可能无法从与中间字符完全相同的位置开始绘制文本。诀窍似乎是重绘整个字符串，但为选定的文本添加了一个剪辑区域。

这篇[关于编写 Win32 文本编辑器的教程](http://www.catch22.net/tuts/neatpad/4)详细介绍了如何绘制选定的文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-06T04:20:05.123

根据 MSDN 文档，当您使用[SetTextAlign()](http://msdn.microsoft.com/en-us/library/dd145091(VS.85).aspx)设置 TA_UPDATECP 标志时，[TextOut()](http://msdn.microsoft.com/en-us/library/dd145133(VS.85).aspx)会忽略其位置参数，以支持设备上下文的当前位置。在没有看到您的代码的情况下，我怀疑您的绘图算法调用 TextOut() 的当前位置会根据选择而略有不同。

作为一种调试策略，您可以在调用 TextOut() 之前调用[GetCurrentPositionEx(](http://msdn.microsoft.com/en-us/library/dd144870(VS.85).aspx) ) 以获取当前位置，并确保它符合您对文本绘制位置的预期。

# java - JTable 或其他具有高级单元格选择的 Java 表类？

> ID：817690
> 
> 赞同：1
> 
> 时间：2009-05-03T18:34:03.473
> 
> 标签：java, jtable, selection

现在我正在使用 JTable 来做我正在做的事情。在查看了 Java API 和各种 Web 资源之后，我认为 JTable 不会再削减它了。我正在寻找的是一张我可以指定非常严格的选择程序的表格。我希望不仅可以选择行和列，还可以选择对角方向的单元格。不仅如此，我还需要能够指定在另一个单元格中时可以选择哪些单元格的整体能力。

例如，如果我有一个 10x10 的表格并且我在单元格 (4, 3) [(row, column)] 中，我想说，好吧，您可以从这里选择以下间隔：

*   (4, 3) 至 (4, 10)
*   (4, 3) 至 (4, 1)
*   (4, 3) 至 (10, 4)
*   (4, 3) 至 (1, 4)
*   (4, 3) 到 (10, 10) [对角线]
*   (4, 3) 到 (1, 1) [对角线]
*   (4, 3) 到 (1, 6) [对角线]
*   (4, 3) 到 (6, 1) [对角线]

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T19:13:57.560

听起来您并不是真的在为“桌子”建模。（JTable 假定表语义并使用列表选择模型。）但是，如果您愿意破解 JTable 代码，我认为它与矩阵相距不远。

另一种选择是您自己的（是的）组件：包含矩阵单元的 JPanel。所有键盘/鼠标事件处理都需要委托给父 JPanel。我当然会建议从 JTable 克隆相关子集和设计（数据模型、选择模型等）。

因此，基本上，您将需要 3 个类：

JMatrix、JMatrixModel、JMatrixSelectionModel。

JMatrix 是扩展的 JPanel 及其子组件。JMatrixSelectionModel 是实现选择规则的类。JMatrix 应该在选择事件上调用选择模型（在矩阵单元上注册，委托给父 JMatrix 上的处理程序）。数据模型相当简单——您甚至可以使用现有的 JTableModel。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-29T06:40:54.587

我也有类似的情况。我的解决方案（抱歉，不想编写一个庞大的类）是为所有列添加一个 Cell Renderer，它是表的鼠标侦听器。由于渲染器知道选择了哪些按钮，它可以以不同的方式渲染它们。

```
public class MultipleSelectionRenderer extends DefaultTableCellRenderer implements MouseListener {
    private JTable table;
    private Map<String, Boolean> selectedMap = new LinkedHashMap<String, Boolean>();
    TableUpdateIfc updater;
public MultipleSelectionRenderer(TableUpdateIfc updater, JTable table, Map<String, Boolean> selectedMap) {
    this.table = table;
    this.selectedMap = selectedMap;
    this.updater = updater;
}

@Override
public void mouseReleased(MouseEvent e) {
    if(e.getSource() == table){
        try {
            if(!e.isControlDown())
                selectedMap.clear();
            selectedMap.put(table.getSelectedRow()+":"+table.getSelectedColumn(), true);
        } catch (Exception ex) {
            selectedMap.clear();
        }
    }
    updater.updateMultipleSelectionTable(table);
}
public void mouseEntered(MouseEvent e) {}
public void mouseExited(MouseEvent e) { }
public void mouseClicked(MouseEvent e) {}
public void mousePressed(MouseEvent e) {}

/**
 *
 * @param table
 * @param value
 * @param isSelected
 * @param hasFocus
 * @param row
 * @param column
 * @return
 */
@Override
public Component getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column) {
    Component result =super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
    if(selectedMap.get(row+":"+column) != null && selectedMap.get(row+":"+column) == true) {
        setText(getHTMLString(value));
    }
    return result;
}

private String getHTMLString(Object value){
    String html = "<html><body><table cellpadding=0><tr>";
    html = html + "<td bgcolor=#bf65a5>";
    html = html + value.toString();
    html = html + "</td><td>&nbsp;" + value+"</td>";
    html = html + "</tr></table></body></html>";
    return html;
} 
```

}

# java - 跨线程的对象可见性

> ID：817703
> 
> 赞同：2
> 
> 时间：2009-05-03T18:41:20.587
> 
> 标签：java, concurrency

我对跨线程发布数据和数据更改有一个普遍的疑问。例如考虑下面的类。

```
public class DataRace {
  static int a = 0;

  public static void main() {
    new MyThread().start();
    a = 1;
  }

  public static class MyThread extends Thread {
    public void run() { 
      // Access a, b.
    }
  }
} 
```

让我们专注于 main()。

清楚地

```
new MyThread().start();
a = 1; 
```

我们在 MyThread 启动后更改共享变量 a ，因此可能不是线程安全的发布。

```
a = 1;
new MyThread().start(); 
```

然而，这一次 a 中的更改会在新线程中安全发布，因为 Java 语言规范 (JLS) 保证在线程 A 启动线程 B 时对线程 A 可见的所有变量对线程 B 都是可见的，这实际上就像拥有Thread.start() 中的隐式同步。

```
new MyThread().start();
int b = 1; 
```

在这种情况下，当两个线程都生成后分配一个新变量时，是否可以保证新变量将安全地发布到所有线程。即如果 var b 被另一个线程访问，是否保证将其值视为 1。请注意，我不是在谈论此后对 b 的任何后续修改（当然需要同步），而是第一次分配完成由jvm。

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T18:50:32.500

I wasn't not entirely sure about this one:

```
a = 1;
new MyThread().start(); 
```

... in that I wasn't sure there was any guarantee that the value of `a` would be "flushed" to shared memory before the new thread started. However, the spec explicitly talks about this. In [section 17.4.4](http://java.sun.com/docs/books/jls/third_edition/html/memory.html#64058) it states:

> An action that starts a thread synchronizes-with the first action in the thread it starts.

(The discussion after that basically shows that it'll be okay.)

I'm not sure what your last example (with `b`) is meant to be about.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T18:58:15.633

I'm not sure what you're asking here. I *think* you're talking about thread-safe access to the "a" variable.

The issue is not the order of invocation but the fact that

-access to a is not threadsafe. So in an example with multiple threads updating and reading a, you won't ever be able to guarantee that the "a" you're reading is the same value as what you updated from (some other thread may have changed the value).

-in a multithreaded environment the jvm does not guarantee that the updated values for a are kept in sync. E.g.

```
Thread 1: a=1

Thread 2: a=2

Thread 1: print a <- may return 1 
```

You can avoid this by declaring a "volatile".

As written there are no guarantees at all about the value of a.

BTW, Josh Bloch's [Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601) is a *great* book on this subject ( and I say that not having gotten all the way through it yet ;) - it really helped me to understand just how involved threading issues can get.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T18:50:23.967

```
a = 1;
new MyThread().start(); 
```

The assignment to 'a' will happen before start is called on the new thread, so the new thread will always print the value '1'

```
new MyThread().start();
a = 1; 
```

In this case, MyThread can print 1 or 0 as the value of 'a'.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T18:51:23.807

MyThread().start() starts a new thread that runs seperately. The declaration of int b = 1 has nothing to do with the thread that you started. It continues in the main thread.

Thread safety is an issue if two threads read or mutate the same Object at the same time, or if two threads obtain locks on resources in reverse order, so that each one is waiting for the other one (this is called a deadlock).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T19:00:38.013

I have my doubts about this question :)

Issues regarding access to shared resources between concurrent threads of execution is a fairly well understood and investigated topic.

In general, if you have a source that is accessed with read/write semantics by a multiplicity of threads, you will need to regulate access to that resource. (Here the resource is the static int variable DataRace.a)

(I also +1 Steve B.'s note here that the issue here is not the order of invocations.)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-16T20:57:51.417

如果 b 是在 DataRace.main() 中创建的局部变量，如代码片段所示，MyThread 一开始就无法访问它，所以这个问题没有实际意义。

如果 b 是主线程和 MyThread 线程之间的共享变量，那么在没有适当的内存屏障的情况下它不具有正确的可见性，因此 MyThread 可能无法立即看到正确的值。

# python - Python的随机：如果我不使用seed(someValue)会发生什么？

> ID：817705
> 
> 赞同：18
> 
> 时间：2009-05-03T18:44:19.067
> 
> 标签：python, random, seed

a）在这种情况下，随机数生成器是否在每次运行时使用系统时钟（改变种子）？

b) 种子是否用于生成 expovariate(lambda) 的伪随机值？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-03T19:04:15.867

“使用源头，卢克！”...;-)。学习[https://svn.python.org/projects/python/trunk/Lib/random.py](https://svn.python.org/projects/python/trunk/Lib/random.py)会很快让你放心；-)。

未设置种子时会发生什么（即“i is None”的情况）：

```
if a is None:
    try:
        a = long(_hexlify(_urandom(16)), 16)
    except NotImplementedError:
        import time
        a = long(time.time() * 256) # use fractional seconds 
```

和expovariate：

```
random = self.random
u = random()
while u <= 1e-7:
    u = random()
return -_log(u)/lambd 
```

显然使用与其他所有方法相同的底层随机生成器，因此同样受到播种或缺乏播种的影响（真的，它会怎么做？-）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-03T18:51:43.870

a) 它通常使用系统时钟，某些系统上的时钟可能只有 ms 精度，因此种子两次非常快可能会产生相同的值。

> seed(self, a=None) 从可散列对象初始化内部状态。
> 
> ```
> None or no argument seeds from current time or from an operating
> system specific randomness source if available. 
> ```
> 
> [http://pydoc.org/2.5.1/random.html#Random-seed](http://pydoc.org/2.5.1/random.html#Random-seed)

b）我想 expovariate 可以，但我找不到任何证据。如果没有，那就太傻了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T18:52:06.833

> 使用当前系统时间；当前系统时间也用于在模块首次导入时初始化生成器。如果操作系统提供随机源，则使用它们而不是系统时间（有关可用性的详细信息，请参见 os.urandom() 函数）。

[随机文件](http://docs.python.org/library/random.html)

# opengl - OpenGL 碰撞检测

> ID：817719
> 
> 赞同：2
> 
> 时间：2009-05-03T18:52:53.303
> 
> 标签：opengl, graphics, jogl

我目前正在使用 JOGL 设计我的第一个 FPS 游戏。（OpenGL 的 Java 绑定）。

到目前为止，我已经能够生成“世界”（一系列立方体）和玩家模型。我的播放器和立方体之间的碰撞检测效果很好。

现在我正在尝试添加枪支。我正确绘制了枪模型并加载到玩家模型上。我尝试使用的第一把枪是激光枪，它可以向您瞄准的任何目标发射瞬时视距激光。在我着手实现敌人模型之前，我想让激光和墙壁之间的碰撞检测工作。

目前，我的激光是由一系列小立方体一个接一个地绘制的。第一个立方体在玩家枪的末端绘制，然后从那里连续绘制。这个想法是继续绘制激光的立方体，直到检测到与某物发生碰撞，即世界上的立方体。

我知道立方体在世界上的位置。问题是我必须调用 glMatrixPush 来绘制我的角色模型。然后在此模型视图中绘制激光。这意味着我失去了旧的坐标系 - 所以我在一个系统中绘制世界，然后在另一个系统中绘制激光。在这个播放器矩阵中，我多次调用 glRotate 和 glTranslate，以便将所有内容与相机旋转的方式同步。然后通过沿这个新系统的 z 轴平移来构建激光器。

我的问题是，通过所有这些转换，我不再知道我的激光在地图坐标系中的位置，主要是由于涉及相机的旋转。

有谁知道一种方法 - 或有任何想法，如何解决这个问题？我相信我需要一种方法将激光的新坐标转换为地图的旧坐标，但我不确定如何撤消已对其进行的所有转换。OpenGL 可能还提供了一些功能来处理我不知道的这类问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T19:12:17.830

您不应该将激光视为发射它的角色的空间孩子。一旦发射，激光就是它自己的一个实体，所以你应该渲染如下：

```
glPushMatrix(viewMatrix);
glPushMatrix(playerMatrix);
DrawPlayer();
glPopMatrix();
glPushMatrix(laserMatrix);
DrawLaser();
glPopMatrix();
glPopMatrix(); 
```

此外，请确保不要将渲染转换逻辑与游戏逻辑混为一谈。无论您当前的 OpenGL 矩阵堆栈如何，您都应该始终存储对象的世界空间位置，以便能够测试交叉点。

记住要小心空间父/子关系。在实践中，它们并不那么频繁。更多信息，谷歌关于场景图的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T22:02:23.357

在第一个答案中提出的观点是，您不应该首先依赖矩阵来定位对象。在考虑绘制激光之前，您应该跟踪激光的位置和旋转。然后，您使用 translate 和 rotate 命令将其放置在您知道应该放置的位置。

您正在尝试向后做事，是的，这确实意味着您必须进行矩阵数学运算，而 OpenGL 不会跟踪它，因为 ModelView 矩阵是 OpenGL 唯一会跟踪的东西到对象位置。OpenGL 没有“世界空间”或“相机空间”的概念。只有所有输入乘以的矩阵。它非常简单……但在某些情况下，我更喜欢 DirectX 具有单独的视图矩阵和模型矩阵的方式。

因此，如果您不知道没有矩阵数学的对象位于何处，那么我会认为这是一个基本的设计问题。如果你*不需要*知道对象的位置，那么矩阵变换到你的心内容，但如果你确实需要它的位置，*从*位置开始。

（几乎是第一个答案所说的，只是以不同的方式......）

# iphone - Texture2D iPhone SDK openGL

> ID：817722
> 
> 赞同：3
> 
> 时间：2009-05-03T18:54:39.573
> 
> 标签：iphone, opengl-es, texture2d

我在使用 OpenGL ES 的 iPhone 游戏中使用 Texture2D 类。

他们有什么好的教程来理解 Texture2D 类吗？

具体来说，我正在查看用于打印文本的 initWithString 方法。作为它的实现方式，当你使用它时你会得到白色的文本。我想修改方法，以便可以指定文本的 RGB 颜色。任何帮助/指示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T14:07:57.787

因为该类使用仅 alpha 纹理（阅读代码！），它将以 glColor 设置的任何颜色显示。请参阅中的这一行`initWithData`（由 调用`initWithString`）：

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_ALPHA, 
             width, height, 0, GL_ALPHA,
             GL_UNSIGNED_BYTE, data); 
```

对于红色文本，只需`glColor4ub(255, 0, 0, 255)`在绘制纹理之前调用。

确保在绘图之前`GL_BLEND`启用。`GL_COLOR_MATERIAL`

班级很小。我建议你只是阅读它。

# javascript - 当我将我的应用程序上传到 Web 服务器时，Firefox 中的缓存问题

> ID：817724
> 
> 赞同：0
> 
> 时间：2009-05-03T18:56:15.030
> 
> 标签：javascript, html, firefox, caching

任何人都可以帮忙吗？我一直在使用 Javascript 设计一个网站，但其余的 html 内容是静态的，即。图片等

当我在 Firefox 中加载我的页面时，我必须清除缓存..

我记得很久以前有一些东西可以添加到 html 中以强制重新加载。

我的问题是，这是一件好事吗？我认为它缓存是有原因的，即cahce图像等。但这会导致我的页面不刷新

怎么做？

非常感谢任何反馈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T19:03:42.437

如果您只想每次都重新加载 js，而让其他所有内容从缓存中加载，您可以在 js 包含行中添加一个版本号，如下所示：

```
<script src="scripts.js?v=5643" type="text/javascript"></script> 
```

每次更改 js 文件时更改版本号 (?v=num) 部分。这会强制浏览器从服务器获取 js 文件。

注意：您的实际文件名将相同 -`scripts.js`

要禁用所有文件的缓存，如果您使用的是 apache，请将其放入您的 httpd.conf

```
<Directory "/home/website/cgi-bin/">
    Header Set Cache-Control "max-age=0, no-store"
</Directory> 
```

您还可以像这样在 html 上放置一个元标记：

```
<meta http-equiv="pragma" content="no-cache" />
<meta http-equiv="cache-control" content="no-cache" /> 
```

更多信息在[这里](http://websiteoptimization.com/speed/tweak/cache/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T19:26:45.797

对于网页，您可以在 HTTP 标头中缓存页面的方式。您应该根据请求页面的时间查看`Expires`是否有特定的缓存到期日期或`Cache-Control`动态到期日期。这是一个很好的[教程](http://www.mnot.net/cache_docs/#META)，涵盖了缓存的工作原理以及在主要 Web 服务器上的设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T20:46:38.327

尝试在 FireFox 中加载页面时按 Control + F5 - 这应该会清除浏览器的页面缓存并为您重新加载干净。

# c# - How to deserialize multiple objects present in a single serialized file in c#?

> ID：817725
> 
> 赞同：0
> 
> 时间：2009-05-03T18:57:01.983
> 
> 标签：c#, serialization

I have multiple "command objects" serialized on a single file. I need to get those objects back by deserializing so that I could replay those commands. Please, help me do this.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T19:19:28.110

I never use the stock serializer for persistent store. I find it works for remoting just fine, but I don't want my file formats bound to .NET framework.

# string - Overcoming the Bitap algorithm's search pattern length

> ID：817726
> 
> 赞同：3
> 
> 时间：2009-05-03T18:57:14.823
> 
> 标签：string, fuzzy-search

I am new to the field of approximate string matching.

I am exploring uses for the [Bitap algorithm](http://en.wikipedia.org/wiki/Bitap_algorithm), but so far its limited pattern length has me troubled. I am working with Flash, and I dispose of 32 bit unsigned integers and a IEEE-754 double-precision floating-point Number type, which can devote up to 53 bits for integers. Still, I would rather have a fuzzy matching algorithm which can handle longer patterns than 50 chars.

The [Wikipedia page](http://en.wikipedia.org/wiki/Bitap_algorithm) of the Bitap algorithm mentions libbitap, which supposedly demonstrates an unlimited pattern length implementation of the algorithm, but I have trouble getting the idea from its sources.

Have you got any suggestions about how to generalise Bitap for patterns of unlimited length, or about another algorithm that can perform fuzzy string matching of a needle near a suggested location in the haystack?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-27T10:59:52.320

[在google code](http://code.google.com/p/google-diff-match-patch/)上有一个非常清晰的算法实现。试试看。虽然我不明白如何获得模糊匹配的确切位置（文本中的起点和终点）。如果您有任何想法如何获得起点和终点，请分享。

# imagemagick - 在 Linux 上转换 JPEG 颜色空间（Adobe RGB 到 sRGB）

> ID：817727
> 
> 赞同：15
> 
> 时间：2009-05-03T18:57:20.797
> 
> 标签：imagemagick, jpeg

我正在从大照片中生成缩略图和中等大小的图像。这些较小的照片用于在在线画廊中展示。许多摄影师使用[Adob​​e RGB](http://en.wikipedia.org/wiki/Adobe_RGB_color_space)提交 JPEG 图像。我被问到缩略图和中等大小的图像是否可以使用[sRGB](http://en.wikipedia.org/wiki/SRGB)作为在某些浏览器中显示为“平面”的图像。

我目前正在使用 ImageMagick 创建较小的版本。它有一个`-colorspace`选项，但这似乎并没有达到我想要的效果。

有没有其他方法可以做到这一点？另外，你觉得这样划算吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-03T19:38:42.133

您可以使用 ImageMagic`-profile`选项：

```
convert image.jpg -profile <adobe.icc> -profile <sRGB.icc> new_image.jpg 
```

有关详细信息，请参见此处： [http](http://www.imagemagick.org/Usage/formats/#color_profile) ://www.imagemagick.org/Usage/formats/#color_profile 。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-29T20:54:43.730

你试过使用[Little CMS](http://www.littlecms.com/)吗？此命令会将具有特殊颜色配置文件（即 Adob​​e RGB 1998）的图像转换为没有颜色配置文件但有效颜色相同的图像：

```
jpgicc -q100 input.jpg output.jpg 
```

我在这里将 JPEG 质量设置为 100。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-02-02T16:14:31.527

ImageMagick 论坛中的以下线程详细讨论了这一点：[http ://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=16464](http://www.imagemagick.org/discourse-server/viewtopic.php?f=1&t=16464)

我现在使用这个 bash 脚本将任何图片（包括 CMYK）转换为 sRGB： [http ://alma.ch/scripts/any2srgb](http://alma.ch/scripts/any2srgb)

对于没有嵌入配置文件的图像，它需要 icc 配置文件。这些可以在网上很容易地找到。例如在 Adob​​e 的网站上：http: [//www.adobe.com/cfusion/search/index.cfm?term= icc+profile&siteSection=support%3Adownloads](http://www.adobe.com/cfusion/search/index.cfm?term=icc+profile&siteSection=support%3Adownloads)

这是完整脚本功能的摘要（未经测试）（没有调整大小和其他选项）。它需要配置文件和 ImageMagick。在基于 Debian 的系统上：`apt-get install icc-profiles imagemagick`.

```
#!/bin/bash

srgb=sRGB.icm
cmyk=ISOwebcoated.icc

# extract possible color profile
profile="${f/%.*/.icc}"
convert "$f" "icc:$profile" 2>/dev/null

if cmp -s "$profile" "$srgb" ; then
    # embedded profile is already srgb. Nothing to do
    exit
fi

if [ -s "$profile" ]; then
    # we have an embedded profile, so ImageMagick will use that anyway
    convert "$f" -profile "$srgb" +profile '*' "$outfile"
else
    # no embedded profile in source
    if identify -format "%r" "$f" | grep -q CMYK; then
        # CMYK file without embedded profile
        convert "$f" -profile "$cmyk" -profile "$srgb" "$outfile"
    fi
fi 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-10T03:47:09.760

[使用Krita](https://docs.krita.org/en/index.html)重新导出图像对我来说似乎效果很好：

```
 krita my_img.jpg --export --export-filename my_img_in_srgb.jpg 
```

Krita 是一个开源的 Photoshop/Paint，带有一个（非常有限的）命令行界面。安装它

```
sudo apt install krita 
```

# asp.net-mvc - 在没有 ORM 的情况下使用 ASP.NET MVC

> ID：817733
> 
> 赞同：10
> 
> 时间：2009-05-03T19:00:37.310
> 
> 标签：asp.net-mvc, data-binding, datatable, datareader

在我的 ASP MVC 应用程序中，我使用标准 SQL（而不是 Linq to SQL 或其他 ORM）来查询我的数据库。

我想将数据库结果传递给我的视图并在我的视图中迭代结果。但我不知道该怎么做。我见过的每个示例都传递了一些字符串或使用 L2S。我想传递嵌套哈希表之类的东西，但我唯一能想到的是将 SqlDataReader 对象传递给视图，但这听起来是个非常糟糕的主意。

我将如何将来自标准 SQL 查询的数据库结果显示到我的视图中？我真的很想使用 Linq 或其他 ORM，但要求我们不要（不要问我为什么，我不明白）。我在VB中这样做。我会尽力转换提供的任何 C# 示例。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-03T19:19:56.190

您可以为要传输的数据创建简单的类，然后从数据读取器手动填充控制器中的对象列表，然后将其传递给您的视图 - 例如（C#，但这应该很容易转换）

```
// open your connection / datareader etc.

List<Customer> customers = new List<Customer>();

while(dataReader.Read())
{
 Customer c = new Customer();
 c.Id = dataReader.GetInt32(0);
 c.Name = dataReader.GetString(1);
 // etc (you might want to use string indexers instead of ints for the get methods)

 customers.Add(c);
}

// close and dispose your datareader / connection etc as usual

return View("List", customers); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-03T19:19:08.437

MVC 是关于关注点分离的。将 SqlDataReaders、DataTables 或驻留在 System.Data 命名空间中的任何类传递给视图不是一个好主意。您需要定义一个可能与数据库对话的模型，以及一个将这个模型传递给视图的控制器。如果您的公司政策规定不要使用 ORM，那么经典的 WebForms 可能比 MVC 模式更适合您的场景。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-03T19:19:18.670

我同意拉沙克的观点。这篇文章对其进行了一些详细的解释。[链接文本](http://davidhayden.com/blog/dave/archive/2005/12/14/2623.aspx)

简而言之，以下是使用 DataTable 和 DataReader 的方法：

```
private DataTable GetData()
{
    DataTable dt = new DataTable();

    using (SqlConnection connection
             = new SqlConnection("ConnectionString"))
    using (SqlCommand command = new SqlCommand())
    {
        command.Connection = connection;
        command.CommandText = "SELECT * FROM Customers";

        connection.Open();
        using (SqlDataReader reader =
            command.ExecuteReader
                (CommandBehavior.CloseConnection))
        {
            dt.Load(reader);
        }
    }

    return dt;
} 
```

然后，您可以将该 DataTable 读入您传递的实体对象中。

我想你会发现这可以产生比使用 ​​Linq 或 ORM 更好的性能。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-03T19:10:02.437

尝试使用 DataTables - DataTable 可以从 IDataReader 加载数据...（我认为该方法称为 Load）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-05-03T19:18:36.677

您可以创建自己的[数据传输对象](http://en.wikipedia.org/wiki/Data_Transfer_Object)类并使用 ADO.Net 代码填充它们的实例。这些 DTO 类将是简单的[POCO](http://en.wikipedia.org/wiki/Plain_Old_CLR_Object)风格的类，只包含属性获取/设置访问器，没有方法。使用 POCO 对象可以说比 DataSets/DataTables 更可取，因为它们是轻量级的（没有多余的状态）并且从面向对象的角度来看更直观。

# windows-vista - Localhost not working on XAMPP - both service apache & mysql are fine

> ID：817745
> 
> 赞同：2
> 
> 时间：2009-05-03T19:06:44.083
> 
> 标签：windows-vista, localhost, xampp

My xampp installation 1.7.1 does not seem to work. [http://localhost](http://localhost) returns not found error.

Xampp Control panel shows both mysql & apache service running fine.

I'am on windows vista. Frustrated since past 2 weeks to find a solution to this. Any pointers and support will be appreciated!

Thanks a ton folks.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-20T19:28:39.477

几天来我一直在努力弄清楚为什么我在使用 xampp 时会出现空白屏幕。罪魁祸首是Skype。当您想使用本地主机时，请始终打开Skype。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T19:41:29.850

在您的“xampp”菜单组中，其中一项是“端口检查”。如果我运行它，我会得到：

```
***************************************************************
*                  XAMPP PortCheck v1.2                       *
*                                                             *
*     (c) 2005 Carsten Wiedmann <info@wiedmann-online.de>     *
*                                                             *
* This script uses openport.exe:                              *
* (c) 2003 DiamondCS <http://www.diamondcs.com.au/openports/> *
***************************************************************

Please wait a moment...

RESULT
------

Service              Port   Status
==============================================================================
Apache (HTTP)          80   C:\bin\xampp\apache\bin\apache.exe
Apache (WebDAV)        81   free
Apache (HTTPS)        443   C:\bin\xampp\apache\bin\apache.exe

MySQL                3306   free

FileZilla (FTP)        21   free
FileZilla (Admin)   14147   free

Mercury (SMTP)         25   free
Mercury (POP3)        110   free
Mercury (IMAP)        143   free

Press <Return> to continue. 
```

你能运行这个，你会得到什么？

* * *

您还可以尝试以下方法（尤其是如果您在我的结果中获得 Apache (HTTP) 端口 80）：

首先查看 apache 是否为您的端口 80 提供服务。我只是使用 telnet 进行设置。

```
telnet localhost 80 
```

你应该得到一个空白屏幕。您可以输入，但没有回声。如果你不明白这一点，Apache 没有作为你的 localhost Web 服务器运行，所以我们需要找出原因。

如果是，请选择一个您知道存在于您的 Web 服务器根目录中的文件（以“index.html”为例，输入（您可能看不到您键入的内容）：

```
GET /index.html 
```

Apache 应该只显示文件内容（以原始形式）。看看你能不能走到这一步。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T19:11:45.693

1.  try your machines IP (eg 192.168.x.y)
2.  try tcp/IP-Loopback: 127.0.0.1
3.  try your computername (use `ipconfig /all` to retrieve your computername)
4.  `ping localhost` and compare the ip

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-19T11:16:06.077

您最近在 Windows 上升级到 PHP 5.3 了吗？

如果是这样，请将“localhost”更改为“127.0.0.1”。见：[http ://bugs.php.net/45150](http://bugs.php.net/45150)

以下是一些可用于使安装可移植的代码：

```
 # Convert localhost to 127.0.0.1 on PHP 5.3.x on Windows (Vista); see http://bugs.php.net/45150
    if ($hostname == 'localhost') {
        if (substr (PHP_OS, 0, 3) == 'WIN') {
            if (version_compare (PHP_VERSION, '5.3.0', '>=')) {
                $hostname = '127.0.0.1';
            }
        }
    } 
```

# cocoa - 首选项窗口问题（一旦打开和关闭，将不会再次打开）

> ID：817748
> 
> 赞同：4
> 
> 时间：2009-05-03T19:07:24.987
> 
> 标签：cocoa, preferences

我遇到的问题是，当首选项窗口打开然后关闭时，它不会再次打开。为什么会发生这种情况，如何解决？

编辑：我也注意到主窗口也有同样的问题。

该窗口正在通过菜单栏打开，并且位于单独的 NIB 文件中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-28T19:15:44.840

听起来您忘记将窗口控制器的“窗口”出口（在 Nib 中，文件的所有者）设置为指向您的窗口。一旦你连接了它的“窗口”插座，窗口控制器的 showWindow: 方法就会起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T19:10:02.437

很难说没有看到代码，但一种可能性是您在 Interface Builder 中检查了窗口的“关闭时释放”，并且您加载它一次，缓存它，然后期望能够关闭并重新打开它无需再次从笔尖加载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-17T00:22:17.607

对于像我这样的其他菜鸟，有这个问题:)

不要忘记将文件的所有者类设置为与控制器类相同，然后您可以将“窗口”插座连接到面板。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-31T17:54:17.847

我在 Aaron Hillegass 的 Cocoa Programming for Mac OS X 书中的第 12 章（Nib 文件和 NSWindowController）练习中遇到了同样的问题。Doug 上面的回答是解决方案——我没有将 Preferences.xib 文件所有者的窗口出口链接到窗口本身（在本例中为 Panel (Preferences) 窗口）。

我右键单击 Preferences.xib 文件中的“文件所有者”，然后将鼠标左键从窗口出口拖到面板（首选项）。完成并重建后，应用程序按预期工作。我可以关闭并重新打开自定义首选项面板，并且我以前的设置仍然存在（因为首选项窗口没有卸载只是隐藏）。

# video - 云 巨大的数据存储选项？

> ID：817749
> 
> 赞同：0
> 
> 时间：2009-05-03T19:08:22.940
> 
> 标签：video, video-streaming, large-files, data-storage

有没有人对如何进行视频录制有好的建议？

我们有一个摄像头，可以录制然后将实时视频流式传输到服务器。所以这意味着我们可以有 1000 台摄像机 24X7 发送数据进行记录。我们将根据包裹存储数据超过 7 / 14 / 30 天。

*   如果摄像机每天向服务器发送数据，那么它将存储 1.5GB。
*   所以这意味着有 1.5GB / 天 / 摄像机的流量
*   每月总计 45GB / 月 / 摄像头（数据 + 一个摄像头的带宽）

请让我知道存储这些数据的最具成本效益的方法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T19:14:28.447

我已经成功地将 GlusterFS 用于（有点不同类型的）存储：

> GlusterFS 是一个集群文件系统，能够扩展到数 PB。它通过 Infiniband RDMA 或 TCP/IP 互连将各种存储砖聚合到一个大型并行网络文件系统中。

见这里：[http ://www.gluster.org/docs/index.php/GlusterFS](http://www.gluster.org/docs/index.php/GlusterFS)

它可以扩展。祝你好运（我认为你在这个项目中需要它）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T19:16:20.487

Sun 有一款针对这类事情进行了[优化的可爱产品，在大存储和世界其他地方之间有一个大的闪存或 RAM 缓存。](http://www.sun.com/servers/networking/streamingsystem/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T19:33:25.640

您在问题主题行中提到了“云”，并且基于“包”详细信息，听起来您并不仅仅面临“存储”问题。您还需要向用户提供存储的提要。

存储的视频是否需要（点播）回传给多个用户或只是源用户？如果是后者，您正在查看某种分布式前向缓存层，而不管存储后端如何。

# .net - Document Management System in .NET

> ID：817751
> 
> 赞同：4
> 
> 时间：2009-05-03T19:08:59.147
> 
> 标签：.net, document-management, dms

does anyone know about a document management system (or modules) that can be integrated with .NET?

Thanks.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-18T04:53:34.137

以下是当今企业中一些最常见的 DMS 列表。（它们都可以集成到.net）

1.  电磁兼容
2.  蜂鸟
3.  打开文本
4.  微软视窗 SharePoint 服务
5.  施乐 DocuShare
6.  甲骨文的 UCM
7.  IBM 的 FileNet
8.  交织工地

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T01:19:42.103

老经典是[Dot Net Nuke](http://www.dotnetnuke.com/ "点网核弹")。模块周围有一个很大的社区，当然您可以编写自己的。最重要的是它是开源的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-05T01:27:11.290

看看[SiteFinity](http://www.telerik.com/products/sitefinity.aspx)或[Graffiti](http://graffiticms.com/)。我目前正在评估这两个作为我们网站的潜在解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-05T01:28:41.037

如果成本没有问题，并且您可以使用开箱即用的标准 DMS（例如，仅进行少量自定义开发），[Microsoft Office Sharepoint Server](http://www.microsoft.com/Sharepoint/default.mspx)非常适合文档管理和基于文档的团队协作。创建工作区，与 Office 产品集成（例如，您可以将 Word 和 Excel 工作直接保存到 Sharepoint 服务器上的协作空间中）。对于已经精通 Office 套件的最终用户来说，这是一个非常令人愉快的 UX。

话虽如此，有两个警告 - 它非常昂贵，而且深入的核心定制不仅仅是有点痛苦。不过，表面的小部件类型定制是轻而易举的事。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T19:21:35.060

我不完全确定您要进行哪种集成。如果您正在寻找具有可从 .Net 语言使用的 API 接口的独立解决方案，我不禁提到[M-Files](http://www.m-files.com/eng/home.asp)。虽然我需要提到这个建议可能非常有偏见。

该系统是商业的，但有一个免费版本可用，但有一些限制，如用户数量等。我相信。

该 API 是一个非常可靠的 COM api，它通过 COM 互操作非常顺利地工作。它是强类型等，因此从 .Net 使用它不会像其他一些 COM api 那样带来麻烦。( *Cough..Office..Cough* ) 在内部，API 用于提供 Web 界面作为原生 Windows 集成的替代方案，因此它保持最新并因此可用。

# c++ - 如何在 Visual Studio C++ 中的控制台中记录内容

> ID：817769
> 
> 赞同：12
> 
> 时间：2009-05-03T19:18:18.907
> 
> 标签：c++, visual-studio-2008, debugging

我正在 Visual Studio 2008 中开发一个小 C++ 游戏。我想在几秒钟后或按下一些按钮后查看矢量的内容。在这种情况下，断点是无用的，因为它们会在每次调用游戏循环时阻止我（每秒约 60 次）。在这种情况下如何调试？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-03T19:32:09.483

使用 Windows API 中的函数 OutputDebugString。您可以随时调用它，例如代码中的每 100 个循环。

功能信息在[这里](http://msdn.microsoft.com/en-us/library/aa363362(VS.85).aspx)

请阅读此页面上的所有评论 - 有些人声称在您的 IDE (VS2008) 中，此功能的输出显示在“立即窗口”而不是“输出”中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T19:22:33.920

您可以设置**条件**断点，即仅当给定表达式为真时才在某个位置命中的断点。例如，您可以设置一个断点，该断点仅在循环中每 n 次命中一次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T19:24:17.147

您可以使用简单的输出到控制台。

假设你想显示一个整数，你可以简单地使用[printf](http://www.cplusplus.com/reference/clibrary/cstdio/printf/)例如：

```
printf("the number is %d \n", vectorArray.at(place) ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T19:25:55.567

设置一个经过的计时器和一些非常基本的东西。

如果 elapsedTime > 3 seconds: 达到你的断点，检查你的向量

或者，如果您想停在一个非常具体的点，只需标记一个计数器以跟踪您完成了多少帧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T19:37:56.473

除了条件断点，您还可以让断点将向量值写入控制台而不是停止。

右键单击断点并选择“当命中”单击“打印消息”，然后将您的值添加到花括号中的消息中。使用“命中计数”让断点在这么多周期后执行。“条件”选项对于根据变量中的某个值设置断点也很有用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-03T19:41:21.690

您还可以在一段条件代码中设置断点，例如：

```
if(keyPressed('S'))
{
  int a = 42; // <-- set breakpoint here
} 
```

*pro* vs 条件断点是条件可能更复杂一点，缺点*是*每次需要更改条件时，都需要编译和链接您的应用程序。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-03T20:35:41.297

我发现如果你包含并使用 fprintf(stdout,"")

当您的程序仍在运行时，它会在屏幕上返回命令提示符

# nhibernate - NHibernate，一对一映射，级联插入

> ID：817776
> 
> 赞同：5
> 
> 时间：2009-05-03T19:21:25.483
> 
> 标签：nhibernate, insert, mapping, cascade, one-to-one

我在 Company 类和 CompanySettings 类之间存在一对一的关系。当我创建一个新的 Company 对象时（在 Company 的构造函数中为其 Settings 属性创建一个 CompanySettings 对象），然后

```
SaveOrUpdate(session, companyObject) 
```

我希望 INSERT 从 Company 级联到 CompanySettings。但是，除非我在 CompanySettings 对象上显式调用 SaveOrUpdate，否则不会发生这种情况。

映射文件如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"`>
  <class name="AST.Domain.Company, AST.Domain" table="Companies">
    <id name="EntityID" column="CompanyId">
      <generator class="guid.comb" />
    </id>
    <property name="CompanyName" />
    . . .
    <one-to-one name="Settings" class="AST.Domain.CompanySettings, AST.Domain"
                constrained="true" lazy="false" />
  </class>
</hibernate-mapping> 
```

我的公司设置类的映射文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">
  <class name="AST.Domain.CompanySettings, AST.Domain" table="CompanySettings">
    <id name="EntityID" column="CompanyId">
      <generator class="foreign">
        <param name="property">Company</param>
      </generator>
    </id>
    <property name="MaxUsers" />
    <one-to-one name="Company" class="AST.Domain.Company, AST.Domain" />
  </class>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T19:26:50.680

您是否尝试过指定[一对一](https://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#mapping-declaration-onetoone)`cascade="all"`映射？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T19:29:47.943

在公司映射中设置一对一的级联属性。

但是，另一方面：您是否想过将 CompanySettings 映射为 Company 的“组件”而不是单独的实体？

是不是'CompanySettings' 是一个'值对象'，并且应该更好地映射为一个组件？

通过这样做，您可以将 CompanySettings 值与“Company”放在同一个表中，但它将被视为单独的类。

由于这是一对一的映射，我认为它也是您的数据模型的更好选择。

然后，您的映射将如下所示：

```
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"`>
  <class name="AST.Domain.Company, AST.Domain" table="Companies">
    <id name="EntityID" column="CompanyId">
      <generator class="guid.comb" />
    </id>
    <property name="CompanyName" />
    . . .
    <component name="Settings" class="AST.Domain.CompanySettings, AST.Domain">
        <property name="MaxUsers" />
    </component>
  </class>
</hibernate-mapping> 
```

您将确实有 2 个单独的对象（Company & CompanySettings，并且 Company 将有一个“Companysettings”对象，但设置将保存在 Company 表中）。

或者，您将 CompanySettings 放在单独的表中是否有任何特殊原因？我的意思是，这是一对一的关系，所以这完全没有必要（恕我直言，甚至是一种不好的做法:)）。

# c# - Asp.net 主题不适用于派生页面

> ID：817779
> 
> 赞同：1
> 
> 时间：2009-05-03T19:21:55.887
> 
> 标签：c#, asp.net

我们有一个 ASP.net 2.0 Web 应用程序，它使用使用 web.config 在应用程序级别设置的主题。主题会正确应用于从 Page 继承的任何网页。问题是主题没有应用到我们的基页，它也继承自 Page。

假设我们的基本页面名为 MyBasePage : Page。

page1.aspx 继承自 Page: Theme Applied。

从 MyBasePage 继承的 page2.aspx：未应用主题。

更令人困惑的是，当我们尝试在 Page_Load 调试 page2.aspx 以检查 this.Theme 的值时，它实际上设置为我们的主题，但没有应用样式。

对于如何解决这个问题，有任何的建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T21:15:37.597

确保您使用*base*关键字从派生类中调用适当的重写基类成员。

```
public class MyBasePage : System.Web.UI.Page
{
    protected override void OnInit(EventArgs e)
    {
        // Call the base class's OnInit method
        base.OnInit(e);
    }

    protected override void OnLoad(EventArgs e)
    {
       // Call the base class's OnLoad method
       base.OnLoad(e);
    }       
} 
```

# c++ - Skype Raw API (NOT COM API) 发送消息问题

> ID：817781
> 
> 赞同：2
> 
> 时间：2009-05-03T19:23:23.497
> 
> 标签：c++, winapi, skype

在将此 CONSOLE 示例转换为完整的 Windows 对话框实现时，我遇到了一个非常“简单的问题”。SendMessage()（第 283 行）返回零，GetLastError 显示 0x578 - 无效的窗口句柄。

[http://read.pudn.com/downloads51/sourcecode/windows/multimedia/175678/msgapitest.cpp__.htm](http://read.pudn.com/downloads51/sourcecode/windows/multimedia/175678/msgapitest.cpp__.htm) ( [https://developer.skype.com/Download/Sample...example_win.zip](https://developer.skype.com/Download/Sample...example_win.zip) )

C++ 2005 Studio 速成版说明 [http://forum.skype.com/index.php?showtopic=54549](http://forum.skype.com/index.php?showtopic=54549)

之前使用 HWND_BROADCAST 的调用正常工作，Skype 回复正常，所以我知道 Skype 已安装并正常工作。

我使用的句柄是来自 Skype 回复消息的 wParam 值，如代码中所示。这不是零，但我不确定除了使用 SendMessage 之外是否还有其他方法可以测试它。

从这个 C++ 代码示例（参见 zip 下载）编译的应用程序确实可以工作，所以我很难过。我确实使用 UTF8 对消息进行编码，并在我的应用程序中创建了一个 COPYDATASTRUCT 实例，填充它然后使用 lparam 中的 COPYDATASTRUCT 指针调用 SendMessage()。Skype 不响应也不服从。我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-12T21:05:48.860

请看这个： http: [//forum.skype.com/index.php?showtopic=790491](http://forum.skype.com/index.php?showtopic=790491)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-04T23:59:13.860

这是已知的错误，解决方案是每当您收到 WM_COPYDATA 时，您必须始终从您的 Windows 过程中返回 1。

# php - 按字母表列出 wordpress 类别

> ID：817782
> 
> 赞同：0
> 
> 时间：2009-05-03T19:23:26.163
> 
> 标签：php, wordpress

在类别存档页面上，我想列出所有类别，使其看起来像这样：

> “一种”
> 
> *   - -苹果
> *   - -回答
> 
> “乙”
> 
> *   - -球
> *   - -大的
> 
> 等等。

这是我正在谈论的wordpress。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-04T14:40:53.073

您可以使用该`get_categories()`功能检索您的类别列表。您可以将一组参数传递给函数，该函数将允许您指定要使用的排序顺序等。

它应该看起来像这样：

```
$defaults = array('type' => 'post',
    'child_of' => 0,
    'orderby' => 'name',
    'order' => 'ASC',
    'hide_empty' => true,
    'include_last_update_time' => false,
    'hierarchical' => 1, 
    'exclude' => ,
    'include' => ,
    'number' => ,
    'pad_counts' => false
);

$categories = get_categories($defaults); 
```

有关参数值和使用返回类别的更多信息，请查看Wordpress codex 中的[此页面](http://codex.wordpress.org/Function_Reference/get_categories)。

# php - 逐行读取文本文件php - 未检测到换行符

> ID：817783
> 
> 赞同：32
> 
> 时间：2009-05-03T19:23:46.273
> 
> 标签：php, newline, text-editor

我有一个我编写的 php 函数，它将获取一个文本文件并将每一行列为表中自己的行。

问题是经典的“在我的机器上运行良好”，但当然，当我要求其他人生成我正在寻找的 .txt 文件时，它会继续以 1 行的形式读取整个文件。当我在我的文本编辑器中打开它时，它看起来就像我期望的那样，每行都有一个新名称，但它是换行符或其他东西。

到目前为止，我得出的结论可能与他们在 Mac 系统上使用的任何文本编辑器有关。

这有意义吗？是否有任何简单的方法来检测文本编辑器识别为新行的这个字符并将其替换为 php 可以识别的标准字符？

更新：添加以下行解决了这个问题。

```
ini_set('auto_detect_line_endings',true); 
```

功能：

```
function displayTXTList($fileName) {
    if(file_exists($fileName)) {
        $file = fopen($fileName,'r');
        while(!feof($file)) { 
            $name = fgets($file);
            echo('<tr><td align="center">'.$name.'</td></tr>');
        }
        fclose($file);
    } else {
        echo('<tr><td align="center">placeholder</td></tr>');
    }       
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-03T19:38:42.773

这对你不起作用？

[http://us2.php.net/manual/en/filesystem.configuration.php#ini.auto-detect-line-endings](http://us2.php.net/manual/en/filesystem.configuration.php#ini.auto-detect-line-endings)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-03T19:47:35.187

What's wrong with [`file()`](http://php.net/manual/en/function.file.php)?

```
foreach (file($fileName) as $name) {
    echo('<tr><td align="center">'.$name.'</td></tr>');
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-03T19:42:45.243

从[fgets](http://php.net/fgets)的手册页：

> 注意：如果在读取 Macintosh 计算机上或由 Macintosh 计算机创建的文件时 PHP 不能正确识别行尾，启用[auto_detect_line_endings](http://php.net/manual/en/filesystem.configuration.php#ini.auto-detect-line-endings)运行时配置选项可能有助于解决问题。

另外，你试过[文件](http://php.net/manual/en/function.file.php)功能吗？它返回一个数组；数组中的每个元素对应于文件中的一行。

Edit: if you don't have access to the php.ini, what web server are you using? In Apache, you can change PHP settings using [a .htaccess file](http://php.net/configuration.changes). There is also the [ini_set](http://php.net/manual/en/function.ini-set.php) function which allows changing settings at runtime.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-03T19:46:12.710

This is a classic case of the newline problem.

ASCII defines several different "newline" characters. The two specific ones we care about are ASCII 10 (line feed, LF) and 13 (carriage return, CR).

All Unix-based systems, including OS X, Linux, etc. will use LF as a newline. Mac OS Classic used CR just to be different, and Windows uses CR LF (that's right, two characters for a newline - see why no one likes Windows? Just kidding) as a newline.

Hence, text files from someone on a Mac (assuming it's a modern OS) would all have LF as their line ending. If you're trying to read them on Windows, and Windows expects CR LF, it won't find it. Now, [it has already been mentioned](https://stackoverflow.com/questions/817783/read-in-text-file-line-by-line-php-newline-not-being-detected/817818#817818) that PHP has the ability to sort this mess out for you, but if you prefer, here's a memory-hogging solution:

```
$file = file_get_contents("filename");
$array = split("/\012\015?/", $file); # won't work for Mac Classic 
```

Of course, you can do the same thing with `file()` ([as has already been mentioned](https://stackoverflow.com/questions/817783/read-in-text-file-line-by-line-php-newline-not-being-detected/817825#817825)).

# c - 如何安装 DJGPP

> ID：817784
> 
> 赞同：3
> 
> 时间：2009-05-03T19:24:07.630
> 
> 标签：c, djgpp

我是 C 和编程的新手。此时我想使用 DJGPP 作为我的编译器。我该如何安装它？据我了解，它是多个文件。我似乎无法找到一个实际上包含具有工作链接的文件的站点。谢谢！

我在 Windows Vista 上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T19:29:43.530

当我下载它时，他的官方网站对我有用：

[http://www.delorie.com/djgpp/zip-picker.html](http://www.delorie.com/djgpp/zip-picker.html)

选择您想要的并按照说明进行操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T19:37:23.883

现在在 Vista 上安装 DJGPP 对您来说可能有点挑战。我建议您使用本机 Windows C 编译器，例如[Cygwin](http://www.cygwin.com)或[MinGW](http://www.mingw.org)。

如果您坚持尝试 DJGPP，请转到[DJGPP zip picker](http://www.delorie.com/djgpp/zip-picker.html)并根据需要选择选项。为操作系统选择 Windows 2000 或 XP。

使用原生 Windows 编译器比使用基于 DOS 的编译器（如 DJGPP）更好的原因是 2000/XP/Vista 中的 DOS 支持相当多且有限。DJGPP 开发人员为支持这些操作系统付出了巨大的努力，但不幸的是，一些限制是不可避免的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T19:33:34.503

我使用 DJGPP 有一段时间了，我很快切换到[MinGW](http://www.mingw.org/)。IIRC DJGPP 是一个旧的 16 位编译器，我遇到了重音或其他问题。MinGW 似乎是适用于 Windows 的最新 GCC 端口。

# cocoa - 绘制到 NSImage 时设置颜色

> ID：817792
> 
> 赞同：0
> 
> 时间：2009-05-03T19:27:16.077
> 
> 标签：cocoa, png

我正在尝试用 Cocoa 中的日期标记图片文件，并尝试在一个小型命令行工具中执行此操作。它工作正常......*但是*，我似乎无法设置颜色。难道我做错了什么？

```
#import <Cocoa/Cocoa.h>

int main (int argc, const char * argv[]) {
    [NSApplication sharedApplication];
    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    NSImage *image = [[NSImage alloc] initWithContentsOfFile:
                [NSString stringWithFormat:@"%s", "/some/file.png"]];

    if (image) {
        [image lockFocus];
        NSColor *color = [NSColor whiteColor];
        // THESE DOESN'T SEEM TO WORK...
        [color set];
        [color setStroke];
        [color setFill];
        NSString *string = [NSString stringWithFormat:@"%@", [NSDate date]];
        [string drawAtPoint:NSMakePoint(10, 10) withAttributes:nil];
        [image unlockFocus];

        NSBitmapImageRep *bits = [NSBitmapImageRep imageRepWithData:
                                    [image TIFFRepresentation]];

        NSData *data = [bits representationUsingType:NSPNGFileType 
                                          properties:nil];

        [data writeToFile:@"/some/file.png"
               atomically:NO];
    }
    [pool drain];
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T19:46:30.167

我相信您需要使用 drawAtPoint:withAttributes: 调用中的 NSForegroundColorAttributeName 属性来设置文本的颜色，而不是 setStroke/setFill。

# powershell - 找出文件是否是 PowerShell 中的符号链接

> ID：817794
> 
> 赞同：40
> 
> 时间：2009-05-03T19:27:28.980
> 
> 标签：powershell, symlink, hardlink

我有一个正在遍历目录树的 PowerShell 脚本，有时我在那里有硬链接的辅助文件，这些文件不应该被处理。是否有一种简单的方法可以确定文件（即`System.IO.FileInfo`）是否为硬链接？

如果没有，使用符号链接（符号链接）会更容易吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-03T21:32:14.357

尝试这个：

```
function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea SilentlyContinue
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
} 
```

这是一个非常简单的实现，但它应该可以解决问题。请注意，这不区分硬链接和符号链接。在下面，它们都只是利用[NTFS 重解析](http://en.wikipedia.org/wiki/NTFS_reparse_point)点[IIRC](http://en.wiktionary.org/wiki/IIRC)。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-02-08T15:39:04.697

如果您有 Powershell 5+，则以下单行递归列出所有文件硬链接、目录连接和符号链接及其从以下开始的目标`d:\Temp\`：

```
dir 'd:\Temp' -recurse -force | ?{$_.LinkType} | select FullName,LinkType,Target 
```

输出：

```
FullName                                LinkType     Target
--------                                --------     ------
D:\Temp\MyJunctionDir                   Junction     {D:\exp\junction_target_dir}
D:\Temp\MySymLinkDir                    SymbolicLink {D:\exp\symlink_target_dir}
D:\Temp\MyHardLinkFile.txt              HardLink     {D:\temp\MyHardLinkFile2.txt, D:\exp\hlink_target.xml}
D:\Temp\MyHardLinkFile2.txt             HardLink     {D:\temp\MyHardLinkFile.txt, D:\exp\hlink_target.xml}
D:\Temp\MySymLinkFile.txt               SymbolicLink {D:\exp\symlink_target.xml}
D:\Temp\MySymLinkDir\MySymLinkFile2.txt SymbolicLink {D:\temp\normal file.txt} 
```

如果您关心硬链接的多个目标，请使用此变体，其中列出了以制表符分隔的目标：

```
dir 'd:\Temp' -recurse -force | ?{$_.LinkType} | select FullName,LinkType,@{ Name = "Targets"; Expression={$_.Target -join "`t"} } 
```

您可能需要管理员权限才能在 say 上运行此脚本`C:\`。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2015-12-30T16:59:04.373

利用`Where-Object`搜索 ReparsePoint 文件属性。

```
Get-ChildItem | Where-Object { $_.Attributes -match "ReparsePoint" } 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-09-13T17:59:31.183

对于那些想要检查资源是硬链接还是符号链接的人：

```
(Get-Item ".\some_resource").LinkType -eq "HardLink"

(Get-Item ".\some_resource").LinkType -eq "SymbolicLink" 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-02-12T22:26:40.413

我在 Vista 上的结果，使用 Keith Hill 的 powershell 脚本来测试符号链接和硬链接：

```
c:\markus\other>mklink symlink.doc \temp\2006rsltns.doc
symbolic link created for symlink.doc <<===>> \temp\2006rsltns.doc

c:\markus\other>fsutil hardlink create HARDLINK.doc  \temp\2006rsltns.doc
Hardlink created for c:\markus\other\HARDLINK.doc <<===>> c:\temp\2006rsltns.doc

c:\markus\other>dir
 Volume in drive C has no label.
 Volume Serial Number is C8BC-2EBD

 Directory of c:\markus\other

02/12/2010  05:21 PM    <DIR>          .
02/12/2010  05:21 PM    <DIR>          ..
01/10/2006  06:12 PM            25,088 HARDLINK.doc
02/12/2010  05:21 PM    <SYMLINK>      symlink.doc [\temp\2006rsltns.doc]
               2 File(s)         25,088 bytes
               2 Dir(s)   6,805,803,008 bytes free

c:\markus\other>powershell \script\IsSymLink.ps1 HARDLINK.doc
False

c:\\markus\other>powershell \script\IsSymLink.ps1 symlink.doc
True 
```

它表明符号链接是重解析点，并且设置了 ReparsePoint FileAttribute 位，而硬链接则没有。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-06-13T01:47:36.940

以下 PowerShell 脚本将使用 -recurse 开关列出一个或多个目录中的所有文件。它将列出文件的名称，无论是常规文件还是硬链接文件，以及大小，以冒号分隔。

它必须从 PowerShell 命令行运行。您从哪个目录运行它并不重要，因为它是在脚本中设置的。

它使用 Windows 附带的 fslink 实用程序，并使用硬链接和列表开关对每个文件运行该实用程序，并计算输出的行数。如果两个或更多，它是一个硬链接文件。

您当然可以通过更改`c:\windows\system`命令中的 来更改搜索开始的目录。此外，脚本只是将结果写入文件，`c:\hardlinks.txt`. 您可以更改名称或简单地删除 > 字符上的所有内容，它将输出到屏幕。

```
Get-ChildItem -path C:\Windows\system -file -recurse -force | 
    foreach-object {
        if ((fsutil hardlink list $_.fullname).count -ge 2) {
            $_.PSChildname + ":Hardlinked:" + $_.Length
        } else {
            $_.PSChildname + ":RegularFile:" + $_.Length
        }
    } > c:\hardlinks.txt 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-01-30T20:55:53.453

这是一个单行程序，它检查一个文件`$FilePath`并返回它是否是符号链接，适用于文件和目录

```
if((Get-ItemProperty $FilePath).LinkType){"symboliclink"}else{"normal path"} 
```

# wcf - .wsdl 给客户什么文件

> ID：817796
> 
> 赞同：0
> 
> 时间：2009-05-03T19:28:59.850
> 
> 标签：wcf, wsdl

感谢您的帮助。

我正在为外部客户端创建 wcf Web 服务。客户端正在请求 wsdl 的副本。我目前正在等待能够为客户提供对服务的访问权限。

当我转到运行服务的本地网络服务器（[http://localhost/Services.svc?wsdl](http://localhost/Services.svc?wsdl)）时，我看到了 wsdl，提供的数据包含方法签名（来自后面的 .svc 代码），但不包含包括模型对象（客户、订单、分机）。

要获取这些对象，我可以在显示的数据中找到引用并转到 url

为了让我向客户提供所有需要的信息，以便他们拥有整个 wsdl，我应该提供主模式以及每个导入的模式吗？

或者是否有任何其他方式来实现这一点（除了客户端点击服务器）

即：有没有办法将它们全部打包在一个文件中？
（似乎可以提取每个文件？）

如果我要为每个文件提供一个 .zip 文件，这就足够了吗？

谢谢，史蒂文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T19:57:26.550

如果您手动下载每个引用的子 WSDL 和 XSD，那么是的，它会起作用；但至少可以这么说，这很麻烦。

一个值得研究的选项是使用 Christian Weyer 的[WCF 扩展](http://blogs.thinktecture.com/cweyer/archive/2007/05/10/414840.aspx)来扁平化您的 WSDL，以便 WCF 在单个文件中生成所有内容，然后将其提供给您的客户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T20:02:26.727

正如您已经注意到的，WCF 将其 WSDL 和 XSD（用于描述正在发送的数据的 XML 模式）打包成不同的部分。这些是从您的主 WSDL 中引用的，带有附加的 href。

甚至更好：您可以在命令行上针对包含您的服务实现的 DLL 或 EXE 运行“svcutil -metadata”命令 - 这将在您运行的目录中创建所有需要的文件（通常是几个 WSDl 和几个 XSD） svcutil 命令。这通常是一种比从 ?wsdl URL 拼凑 WSDL 和 XSD 文件更可靠的方法（您通常最终会丢失一两个文件）。

马克

# java - 自 JVM 启动以来的时间

> ID：817801
> 
> 赞同：65
> 
> 时间：2009-05-03T19:32:07.267
> 
> 标签：java, time, jvm

有没有办法找出自 JVM 启动以来的时间？

当然，除了在接近开始的某个地方启动计时器之外`main`，因为在我的场景中，我正在编写库代码，并且在启动后立即调用某些东西的要求太繁琐了。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-05-03T19:50:36.613

使用这个片段：

```
long jvmUpTime = ManagementFactory.getRuntimeMXBean().getUptime(); 
```

或者：

```
long jvmStartTime = ManagementFactory.getRuntimeMXBean().getStartTime(); 
```

这是检索 JVM 正常运行时间的**正确**方法。

有关更多信息，请参阅[RuntimeMXBean](https://docs.oracle.com/en/java/javase/15/docs/api/java.management/java/lang/management/RuntimeMXBean.html)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-03T19:54:24.623

您可以在以下代码中获取 JVM 的启动时间：

```
import java.lang.management.ManagementFactory;
  import java.lang.management.RuntimeMXBean;
  ...
  RuntimeMXBean runtimeMXBean = ManagementFactory.getRuntimeMXBean();
  long uptimeInMillis = runtimeMXBean.getUptime(); 
```

查看更多是[https://docs.oracle.com/javase/6/docs/api/java/lang/management/RuntimeMXBean.html](https://docs.oracle.com/javase/6/docs/api/java/lang/management/RuntimeMXBean.html)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-11T03:04:30.813

如果你的jvm程序运行在linux下，可以用**ps查看startTime**

```
ps -p <pid> -o stime,etime 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T19:55:52.327

从 Java 5 开始，您可以使用 JMX 来发现这一点。检查“[使用平台 MBeanserver](http://java.sun.com/j2se/1.5.0/docs/guide/management/mxbeans.html) ”以了解更多详细信息。您要查找的 bean 是名为“java.lang:type=Runtime”的 bean。属性 StartTime 为您提供 JVM 的启动时间，而 Uptime 属性告诉您 JVM 的正常运行时间。

您可以通过执行以下代码来获得对 Runtime bean 的引用： `ManagementFactory.getRuntimeMXBean();`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-15T15:11:50.943

或许值得一提的是，如果您不想编写任何代码，请从 java bin 目录运行 jconsole 并单击 VM Summary 并查看 Uptime 和 Process CPU time 值。

# c# - C#：如何使用反射从通用对象中删除所有空属性？

> ID：817807
> 
> 赞同：2
> 
> 时间：2009-05-03T19:35:31.377
> 
> 标签：c#, reflection

我想删除通用对象中的所有空属性。它不必是递归的，一层深也可以。

我需要的原因是用于 JSON 序列化的自定义 JavascriptConvertor 实现，它给了我： {"Name":"Aleem", "Age":null, "Type":"Employee"}

我想跳过空对象。

此任务的函数接受 objct 并返回 Dictionary：

```
IDictionary<string, object> Serialize(object obj, JavaScriptSerializer serializer) 
```

所以我想从 obj 中删除所有 null 属性。所有属性都有 getter，但如果未设置属性，则 getter 返回`null`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T20:47:41.063

您可以实现自己的[JavaScriptConverter](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptconverter.aspx)来处理类型的序列化。然后，您可以完全控制属性的序列化方式。

@Richards 答案提供了 Serialize 方法的一个很好的实现。

Deserialize 方法将非常相似，但我将把实现留给你。现在 JavaScriptConverter 的唯一缺点是它必须从某个地方获取支持的类型。要么像这样对其进行硬编码：

```
public override IEnumerable<Type> SupportedTypes
{ 
    get
    {
        var list = new List<Type>{ typeof(Foo), typeof(Bar)...};
        return list.AsReadOnly();
    }
} 
```

...或使其可配置，例如通过类构造函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T22:43:57.400

以下内容可能会奏效：

```
public IDictionary<string, object> GetNonNullProertyValues(object obj)
{
    var dictionary = new Dictionary<string, object>();

    foreach (var property in obj.GetType().GetProperties())
    {
        var propertyValue = property.GetValue(obj, null);
        if (propertyValue != null)
        {
            dictionary.Add(property.Name, propertyValue);
        }
    }

    return dictionary;
} 
```

注意：此方法不处理索引属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T22:46:54.117

```
 using System.IO;
 using System.Runtime.Serialization.Json;

    public static class JsonExtensions
    {
        public static string ToJson<T>(this T instance) 
        {
            var serializer = new DataContractJsonSerializer(typeof(T));
            using (MemoryStream memoryStream = new MemoryStream())
            {
                serializer.WriteObject(memoryStream, instance);

                memoryStream.Flush();
                memoryStream.Position = 0;

                using (var reader = new StreamReader(memoryStream))
                {
                    return reader.ReadToEnd();
                }
            }
        }

        public static T FromJson<T>(this string serialized) 
        {
            var serializer = new DataContractJsonSerializer(typeof(T));
            using (MemoryStream memoryStream = new MemoryStream())
            {
                using (StreamWriter writer = new StreamWriter(memoryStream))
                {
                    writer.Write(serialized);
                    writer.Flush();

                    memoryStream.Position = 0;

                    return (T)serializer.ReadObject(memoryStream);
                }
            }
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T19:52:29.323

您可能希望创建某种包装对象，如果它们不为空，则仅公开其包装的成员。

您可能还想查看 C# 版本 4。从[鸭子打字的维基百科条目](http://en.wikipedia.org/wiki/Duck_typing#Duck_typing_in_statically_typed_languages)：

> C# 版本 4 具有额外的类型注释，指示编译器安排在运行时而不是编译时进行类的类型检查，并在编译输出中包含运行时类型检查代码。这样的添加允许语言享受鸭子类型的大部分好处，唯一的缺点是需要在编译时识别和指定这样的动态类。

# vb6 - ADO 错误：自动化错误 - 找不到指定的模块

> ID：817808
> 
> 赞同：0
> 
> 时间：2009-05-03T19:35:42.577
> 
> 标签：vb6, ado

我在多台机器上成功运行的 VB6 应用程序仅在 1 台用户机器上产生上述错误。机器具有 Vista SP1，这意味着 MDAC 安装程序将无法工作，因为已包含 MDAC 2.8。

导致错误的代码：

```
'Temp file to users temp directory:
FileName = C:\DOCUME~1\nmiller\LOCALS~1\Temp\TmpPrint.mdb 

Dim catADO As New ADOX.Catalog
catADO.Create "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & FileName 
```

.Create 行发生错误。

任何帮助让该用户继续工作将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T19:42:11.877

文件是否存在权限问题？也许在 Vista 上，您需要授予该文件的权限。我们知道 Vista 具有更严格的安全性，包括文件和文件夹访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T13:11:56.097

MDAC 2.6 之后不包括 Jet/Desktop ODBC 驱动程序。请参阅[http://support.microsoft.com/kb/271908](http://support.microsoft.com/kb/271908)以获取 Jet 驱动程序。

# google-app-engine - 如何将 Google App Engine 与我自己的裸域（不是子域）一起使用？

> ID：817809
> 
> 赞同：240
> 
> 时间：2009-05-03T19:36:06.977
> 
> 标签：google-app-engine, dns, google-cloud-platform

经过数小时阅读和试验 DNS 记录后，我可以通过以下 URL 访问我的 Google App Engine 应用：

*   myappid.appspot.com
*   www.myappid.myowndomain.com

什么不起作用：

*   myowndomain.com
*   www.myowndomain.com

我希望能够直接从我的域而不是子域中提供我的应用程序。我见过这样做的应用程序。有没有办法在没有 URL 重定向的情况下做到这一点？

* * *

## 回答 #1

> 赞同：260
> 
> 时间：2009-05-03T20:28:44.807

[2016 年 4 月更新] 此答案现已过时，支持自定义裸域映射，请参阅[Lawrence Mok 的答案](https://stackoverflow.com/questions/817809/how-to-use-google-app-engine-with-my-own-domain-not-subdomain/23006209#23006209)。

我已经想通了！

首先：不可能将类似的东西`mydomain.com`与您的 apppot 应用程序联系起来。这被认为是一个裸域，Google App Engine（不再支持）。严格来说，我的问题的答案必须是“不可能的”。继续阅读...

您所能做的就是添加指向您的应用程序的子域，例如`myappid.mydomain.com`. 将您的顶级域链接到您的应用程序的关键是要意识到这`www`是一个与任何其他域一样的子域！

`myappid.mydomain.com`被视为完全一样`www.mydomain.com`！

以下是步骤：

1.  转到 appengine.google.com，打开您的应用
2.  管理 > 版本 > 添加域...（您的域必须链接到您的 Google Apps 帐户，请按照包括域验证在内的步骤进行操作。）
3.  访问 www.google.com/a/yourdomain.com
4.  仪表板 > 您的应用程序应在此处列出。点击它。
5.  myappid 设置页面 > 网址 > 添加新 URL
6.  只需输入`www`并单击添加
7.  使用您的域托管服务提供商的 Web 界面，为您的域添加一个 CNAME`www`并指向`ghs.googlehosted.com`

现在您已`www.mydomain.com`链接到您的应用程序。

我希望这在文档中会更明显......祝你好运！

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2014-04-11T07:29:16.390

[2015-09-28 更新] 现在，Google 允许您添加自定义域（包括裸域）并设置 SSL，而无需 Google Apps。有关详细信息，请参阅此处：[https ://cloud.google.com/appengine/docs/using-custom-domains-and-ssl?hl=en](https://cloud.google.com/appengine/docs/using-custom-domains-and-ssl?hl=en)

~~我今天刚刚发现（截至 2014 年 4 月 11 日）Google Developers Console 提供了一个新的自定义域设置页面：~~

~~1\. 转到[https://console.developers.google.com/project](https://console.developers.google.com/project) 2\. 点击您的项目 3\. 在左侧点击“App Engine” 4\. 点击“设置”~~

给你！您可以配置自定义域而无需 Google App 帐户！

* * *

## 回答 #3

> 赞同：43
> 
> 时间：2009-05-03T19:55:48.490

[2016 年 4 月更新] 此答案现已过时，支持自定义裸域映射，请参阅[Lawrence Mok 的答案](https://stackoverflow.com/questions/817809/how-to-use-google-app-engine-with-my-own-domain-not-subdomain/23006209#23006209)。

有关详细信息，请参阅[http://www.google.com/support/a/bin/answer.py?hl=en&answer=91077](http://www.google.com/support/a/bin/answer.py?hl=en&answer=91077)。为您的域注册 Google Apps 后：

```
# Sign in to the Google App Engine admin console.
# Go to Administration > Versions
# Click the 'Add Domain...' button under Domain Setup.
# Enter your domain name in the 'Domain Name:' field
# Click 'Add Domain'. You will be directed to the Google Apps administrator console to complete the process.
# Log in to the Google Apps control panel with your administrator account.
# Accept the terms and specify the access URL you'd like to provide for your application.
# Click 'Accept 
```

但是，您不能使用**裸**域，例如whatever.com（但 www.whatever.com*确实*有效），因为：

> 由于最近的更改，Google App Engine 不再支持将您的应用映射到裸域。如果您的域名注册商支持 URL 重定向，您可以从[http://yourdomain.com](http://yourdomain.com)重定向到您的应用，该应用可以从[http://www.yourdomain.com](http://www.yourdomain.com)或 [http://appid.yourdomain.com](http://appid.yourdomain.com)等域提供。

在[http://www.google.com/support/a/bin/answer.py?answer=91080中指定](http://www.google.com/support/a/bin/answer.py?answer=91080)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2010-03-22T17:18:54.443

如果您像我一样在尝试将“www”添加为子域以使您自己的域正常工作时看到此消息：

> '已使用，请先删除之前的映射。'

如果您将 Google Apps 用于您的域，则其他答案中提到的上述过程会略有变化。

您现在也必须这样做：

Google Apps -> 服务设置 -> 站点。单击“Web 地址映射”并删除默认添加到站点的“www”映射。

然后您可以为您的 App 引擎应用添加“www”子域

看到这个链接：

[http://groups.google.com/group/google-appengine/web/deleting-existing-www-mapping-from-google-apps](http://groups.google.com/group/google-appengine/web/deleting-existing-www-mapping-from-google-apps)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-10-05T20:59:28.857

Google 提供的另一个解决方案是 URL 转发：[http ://www.google.com/support/a/bin/answer.py?hl=en-in&answer=61057](http://www.google.com/support/a/bin/answer.py?hl=en-in&answer=61057)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2012-09-11T18:37:17.830

Google 确实提供裸域重定向。

*   登录到您的 Google Apps 帐户并选择“管理此域”
*   导航到域设置
*   在域设置中，导航到域名
*   有一个链接说“更改A记录”。单击该按钮将为您提供需要创建的 A 记录的目标 IP。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-07-18T14:18:26.243

Google 不提供 IP 供我们设置 A 记录。如果可以，我们可以使用裸域。

还有另一种选择，通过将 A 记录设置为外部 Web 服务器的 IP，该服务器可以将 http 重定向从例如 domain.com 到 www.domain.com（查看[GiDNS](http://gidns.net)）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-04-07T20:27:20.917

我知道所有这些步骤，实际上以下是简短而奇妙的方法。

> 1 - 转到 appengine.google.com，打开您的应用
> 
> 2 - 管理 > 版本 > 添加域...（您的域必须链接到您的 Google Apps 帐户，请按照包括域验证在内的步骤进行操作。）
> 
> 3 - 访问 www.google.com/a/yourdomain.com
> 
> 4 - 仪表板 > 您的应用程序应在此处列出。点击它。
> 
> 5 - myappid 设置页面 > 网址 > 添加新 URL
> 
> 6 - 只需输入 www 并单击添加
> 
> 7 - 使用您的域名托管服务提供商的网络界面，为您的域名添加 www 的 CNAME 并指向 ghs.googlehosted.com
> 
> 8 - 现在您已将 www.mydomain.com 链接到您的应用程序。
> 
> *   如果您想要裸域，即 mydomain.com，请使用您的 DNS 管理员（不在 Google Apps 中）重定向并将其指向 www.mydomain.com。

现在我已经完成了这一切，我可以使用我的自定义域成功访问我的 appengine 应用程序。例如[http://cic.mx](http://cic.mx)和[http://www.cic.mx](http://www.cic.mx)都将我带到我的应用程序。但是 URL 更改为 -myappid-.appspot.com，我不希望它发生！

有没有人解决过这个问题？

我在 appengine 上使用一个 php 应用程序，带有一个 wordpress 实例。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-01-25T16:34:29.173

对于 2019 年的 App Engine，谷歌让设置自定义域变得更加容易。

1.  Google App Engine -> 设置 -> 自定义域

2.  [验证您的域](https://i.stack.imgur.com/lezNh.png)

3.  [选择您的域名注册](https://i.stack.imgur.com/rHs1k.png)

**提醒**：在没有现有 CNAME 记录的情况下，将 TXT 记录与 Google 提供的值一起使用，否则 TXT 记录将被覆盖

4.  按照页面上的步骤操作，其中包括您的子域、CNAME 记录、A 记录、AAAA 记录的配置，一切顺利。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-10T01:37:49.050

几个小时后终于设法解决了这个问题。www 子域指向站点，但前端没有向我显示。

在尝试将 CNAME 设置为 gwh.google.com 并启用/禁用站点几次之后（请参阅 Rodrigo Moraes 在[http://groups.google.com/group/google-appengine/web/上的评论delete-existing-www-mapping-from-google-apps](http://groups.google.com/group/google-appengine/web/deleting-existing-www-mapping-from-google-apps)）我能够设置站点地址以使用 www 子域。

然后我可以将其更改为不再使用 www 子域，此时 appengine 应用程序允许我指定 www 子域。

这是一个肮脏的修复 - 基本上打开和关闭站点，直到它工作！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-08-18T18:04:45.390

当您转到“应用程序设置->添加域”时，它会要求选择登录帐户，可能您已经在 gmail 帐户上，因此它也会显示 gmail 帐户，**但您应该使用已映射自定义域的 Google Apps 帐户**.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-11-10T20:25:42.043

您可以在 godaddy 中重定向或屏蔽您的域名，但我不知道其他托管站点。看看这个[链接](http://support.godaddy.com/help/article/422/forwarding-or-masking-your-domain-name)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-09-30T15:53:48.570

这是来自 Google 的关于在自定义域上映射您的应用程序的教程：[https ://cloud.google.com/appengine/docs/domain?hl=FR](https://cloud.google.com/appengine/docs/domain?hl=FR)

应该是最新的更新。但请注意以下两点：

1-您可能在新的开发者控制台中找不到您的应用程序，那么唯一的解决方法是下载您的源代码，从新的开发者控制台创建一个新应用程序并部署它。

2-您在开发者控制台上找到了您的应用程序，但在计算菜单下您可能找不到教程中提到的 App Engine 设置，然后您必须按照我在第一点中解释的方式进行操作（创建另一个应用程序）

我希望这有帮助 ！

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2021-05-20T13:47:38.120

您可以为您的 App Engine 创建一个自定义域（包括裸域），也可以在那里设置自我管理的 SSL 证书。

要使用自定义域，请将域映射到您的应用，然后更新您的 DNS 记录。您可以映射裸域，例如 example.com 或子域，例如 subdomain.example.com。您还可以使用通配符来映射子域。

将自定义域映射到您的应用程序的步骤如下 -

1.  在 Console 中，进入 App Engine 设置页面的应用程序设置选项卡 --> 如果您需要启用 G Suite 身份验证，则单击编辑以修改 Google Accounts API Referrer--> 在 Google 身份验证下拉菜单中，选择 G套件域，然后在空白字段中添加您的域，例如 example.com。

2.  转到 App Engine 设置页面的自定义域选项卡->单击添加自定义域->如果您的域已经过验证，则从下拉菜单中选择它->单击继续。

如果您尚未验证您的域，请按照以下步骤操作：

```
 a) Select Verify a new domain from the drop-down menu.

 b) Enter your naked domain name (such as "example.com") and click Verify.   

 c)  Enter information in the Webmaster Central window that appears. 

 d) After you complete the steps in Webmaster Central, return to the Add a new    
 custom domain page in the Google Cloud Console. 
```

3.  在 Point your domain to (project-ID) 部分中，指定要映射的域和子域。我们建议映射裸域和 www 子域-->单击保存映射。

4.  登录您的域名注册商网站并更新您的 DNS 记录。

有关所需步骤的详细说明，请参阅以下链接 -

[https://cloud.google.com/appengine/docs/standard/python/mapping-custom-domains](https://cloud.google.com/appengine/docs/standard/python/mapping-custom-domains)

* * *

## 回答 #15

> 赞同：-3
> 
> 时间：2011-07-27T14:45:16.910

You must try like this, `Application Settings > Add Domain`...

# sql-server - 什么 .sdf 文件。它与 .mdf 文件有何不同。它适用于 linq to Sql 吗？

> ID：817820
> 
> 赞同：12
> 
> 时间：2009-05-03T19:41:20.567
> 
> 标签：sql-server, wpf

我正在玩 wpf，当我创建数据库时，它是使用 .sdf 文件创建的。我想知道 .sdf 文件的详细信息。它与标准 .mdf 文件有何不同，它们是否支持 linq to sql？因为我无法将它与 linq 文件一起使用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-03T19:47:16.090

SDF 文件是 Sql Server Mobile 文件。它也称为 Sql Server 紧凑型。它主要用于移动开发，但最近也越来越多地用于单用户桌面开发。

Visual Studio 2008 不支持用于 Sql Server Mobile 的 Linq to Sql，但框架支持。[您可以在此处](http://pietschsoft.com/post/2009/01/Using-LINQ-to-SQL-with-SQL-Server-Compact-Edition.aspx)了解有关实施此功能的更多信息

[您可以在此处](http://www.microsoft.com/sql/editions/sqlmobile/sqlmobileresources.mspx)找到有关 Sql Server Mobile的更多信息。该链接还将帮助解释这与 Sql Server 使用的 Mdf 之间的区别。

[这里](http://erikej.blogspot.com/2009/01/binding-sql-compact-data-to-wpf-in-less.html)还有一篇关于使用 Sql Mobile/Compact 为 Wpf 构建 Linq to Sql 模型的文章

Sdf 和 Mdf 之间的主要区别之一是，直到最近，Mdf 无法像普通文件一样打开和处理，而 Sdf 被作为文件访问。然而，在 Visual Studio 中，通过允许将 Mdf 动态附加到 Sql Server Express 会话的 Sql Server 数据文件来重现此概念。

# html - 如何重新加载我的Java 数据库中的元素 我已经从 html 表单提交了一些数据库中的数据。然后我必须在另一种形式的 <select> 中加载该数据的一列。我已经这样做了，但是随着记录数量的增加，我将如何增加选项的数量？代码如下： <%@ page import="java.util.*"%> <%@ page import="java.lang.*"%> <%! 数组列表 al; 对象o[]; 字符串 s[] = 新字符串 [10]; %>

> ID：817827
> 
> 赞同：0
> 
> 时间：2009-05-03T19:44:21.543
> 
> 标签：html, database, jsp, html-select

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-13T11:46:05.117

首先，不要**在**JSP 中使用 scriptlet。十年来，它们被 taglibs 和 EL 所取代。一个常用的标记库是[JSTL](http://java.sun.com/products/jsp/jstl/1.1/docs/tlddocs/)，它提供了`<c:forEach>`完全用于此目的的标记。使用[EL](http://java.sun.com/j2ee/1.4/docs/tutorial/doc/JSPIntro7.html)，您可以无缝访问 JSP 页面中的后端数据。

Here's an examplelpe 如何最好地替换您的代码。

员工：

```
public class Employee {
    private Long code;
    private String name;
    // +getters +setters
} 
```

员工服务小程序：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    List<Employee> employees = employeeDAO.list();
    request.setAttribute("employees", employees);
    request.getRequestDispatcher("employees.jsp").forward(request, response);
} 
```

员工.jsp：

```
<select name="employee">
    <c:forEach items="${employees}" var="employee">
        <option value="${employee.code}">${employee.name}</option>
    </c:forEach>
</select> 
```

将 EmployeeServlet 映射到`url-pattern`of`/employees/*`并通过 调用它`http://example.com/contextroot/employees`。祝你好运，让你的 JSP scriptletfree :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T22:03:47.963

I am a c# coder, but I believe you want something like this:

```
 <%@ page import="java.util."%>
    <%@ page import="java.lang."%> 
    <%! ArrayList al = c.loadExistingEmpCode(); 

       for(int i=0; i < ai.Count; i++)
       {

    %>

     <option><%= ai[0].toString() %></option>

   <% } %> 
```

# c++ - 调用带有编译错误的方法 C++

> ID：817833
> 
> 赞同：0
> 
> 时间：2009-05-03T19:47:52.190
> 
> 标签：c++, compilation

使用以下程序，当我尝试编译它时，我得到了大量的编译错误。我认为他们与方法调用有关。我不熟悉c++，也不知道是什么原因造成的。任何人都可以帮忙吗？这是源代码：

```
#include <iostream>
using namespace std;
//getting the greatest common divisor to help reduce fractions
int GDC(int x, int y)
{
    int t;
     while (y!=0)
    {
        t=y;
        y=x%y;
        x=t;
    }
    return x;
}

//constructing a RationalNumber wit a numerator and a denominator as seperate elements.
//it also reduces the fraction as well as show them.
//prevents 0 in the denominator as well as avoid negative denominators
class RationalNumber
{
    public:
        RationalNumber(int num=0, int denom=0)
        {
            numerator=num;
            denominator=denom;
        }
        void show()
        {
            {
                cout << "(" << numerator <<"/";
                cout << denominator << ")";
            }
        }
        void reduce()
        {
            int reduction;
            reduction= GCD(numerator, denominator);
            numerator=numerator/reduction;
            denominator=denominator/reduction;

            if(denominator == 0)
            {
                cout << "Cannot compute with 0 denominator ";
            }
            if(denominator < 0)
            {
                cout << "Cannot compute negative demoninators ";
            }
            else
            {
                //simplifies fraction to a whole number when denominator is 1
                if(denominator == 1)
                {
                    cout << "(" << numerator <<")";
                }
                else
                {
                    cout << "(" << numerator <<"/";
                    cout << denominator << ")";
                }
            }
        }
        RationalNumber operator+(RationalNumber op2);
        RationalNumber operator-(RationalNumber op2);
        RationalNumber operator*(RationalNumber op2);
        RationalNumber operator/(RationalNumber op2);
        RationalNumber operator++();

    private:
        double numerator, denominator;
};

void Accept(int n)
{
    if(n<0)
    {
       cout << "Cannot have negatice denominators: ";
    }
    else if (n == 0)
        cout << "Cannot have zero in the denominator: ";
}

//Division
RationalNumber RationalNumer::operator/(RationalNumber op2)
{
    RationalNumber temp;
    int reduction;
    temp.numerator=(numerator*op2.denominator);
    temp.denominator=denominator*op2.numerator;
    cout << "Division:       ";
    return temp;
}

//Subtraction
RationalNumber RationalNumer::operator-(RationalNumber op2)
{
    RationalNumber temp;
    int reduction;
    temp.numerator=(numerator*op2.denominator)-(op2.numerator*denominator);
    temp.denominator=op2.denominator* denominator;
    cout << "Subtraction:       ";
    return temp;
}

//Multiplication
RationalNumber RationalNumer::operator*(RationalNumber op2)
{
    RationalNumber temp;
    temp.numerator=(op2.numerator*numerator);
    temp.denominator=op2.denominator* denominator;
    cout << "Multiplication:       ";
    return temp;
}

//Addition
RationalNumber RationalNumer::operator+(RationalNumber op2)
{
    RationalNumber temp;
    temp.numerator=(op2.numerator*denominator) + ((numerator)*(op2.denominator));
    temp.denominator=op2.denominator* denominator;
    cout << "Addition:       ";
    return temp;
}

RationalNumber RationalNumer::operator++()
{
    numerator++;
    denominator++;
    return *this;
}

void getFraction(int &x, int &y, int &z, int &t)
{
    cout << "First Fraction: ";
    cout << "\n";
    cout << "numerator: ";
    cin >> x;

    do
    {
        cout << "denominator: ";
        cin >> y;
        Accept(y);
        cout << "\n";
        cout << endl;
    }
    while(y <=0);

    cout << "Second Fraction: ";
    cout << "\n";
    cout << "numerator: ";
    cin >> z;
    do
    {
        cout << "denominator: ";
        cin >> t;
        Accept(t);
        cout << "\n";
        cout << endl;
    }
    while(t <=0);
}

void aftermath(int &x, int &y, int &z, int &t)
{
    RationalNumber obA, obS, obM, obD, ob2(x,y), ob3(z,t);
    char Math;
    cout << "Enter sign (+,-,*,/):  ";
    cin >> Math;
    if(Math == '+')
    {
        obA=ob2+ob3;
        obA.reduce();
        cout << "\n";
    }
    else if(Math == '-')
    {
        obS=ob2-ob3;
        obS.reduce();
        cout << "\n\n";
    }
    else if(Math == '*')
    {
        obM=ob2*ob3;
        obM.reduce();
        cout << "\n\n";
    }
    else if(Math == '/')
    {
        obD=ob2/ob3;
        obD.reduce();
        cout << "\n\n";
    }
    else
        cout << "Invalid sign";
}

int main()
{
    char answer;
    do
    {
        int x,y,z,t = 0;
        getFraction(x,y,z,t);
        RationalNumber obA, obS, obM, obD, ob2(x,y), ob3(z,t);

        ob2.show();
        cout <<" ";
        ob3.show();
        cout << "\n\n";
        aftermath(x,y,z,t);
        cout << "\n\n";
        cout << "Create another fraction? - y or n? ";
        cin >> answer;
        cout << "\n";
    }
    while((answer == 'y'));

    if((answer != 'y'))
    {
        cout << "GOOD-BYE ";
    }
    return 0;
} 
```

这是编译错误：

```
g++ -o Math math.cpp
math.cpp: In member function 'void RationalNumber::reduce()':
math.cpp:37: error: 'GCD' was not declared in this scope
math.cpp: In function 'void getFraction(int&, int&, int&, int&)':
math.cpp:136: error: invalid operands of types '<unresolved overloaded function type>' and 'const char [2]' to binary 'operator<<'
math.cpp:151: error: invalid operands of types '<unresolved overloaded function type>' and 'const char [2]' to binary 'operator<<' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-03T19:50:36.893

*（注意：自从我发布答案以来，Kyle 已经更新了输出，因此其中一些缺少正确的上下文。）*

第一个错误：您正在调用“GCD”，但您的函数称为“GDC”。

第二个错误：“RationalNumer”不是“RationalNumber”。

当您在所有出现的地方修复第二个错误时，大多数或所有其他错误都会消失（其中有五个 - 搜索“RationalNumer”）。

更新输出中的新错误 - 另一个错字：`count << "\n";`应该是`cout << "\n";`.

两条一般建议：

*   **阅读**错误消息。8-) 通常它们看起来是难以理解的行话，或者只是在撒谎，但答案通常就在那里。

*   只担心第一个错误。通常情况下，修复它会使其他一些或全部消失。

# .net - ASP.NET MVC、ActionFilters、静态类和传递数据

> ID：817838
> 
> 赞同：6
> 
> 时间：2009-05-03T19:52:12.740
> 
> 标签：.net, asp.net-mvc, architecture, action-filter, static-classes

我想听听您的意见，也许对以下情况有更好的建议：

我已经定义了一个自定义的 ActionFilter 来完成一些工作并产生一些价值。我想在控制器操作和模型中使用该值。

现在，我可以使用 TempData 将该值从 ActionFilter 传递给任何控制器操作方法，然后将该值分配给传递给返回视图的所有模型。

我确信它会起作用，但是这个 TempData 将在会话中出现，在没有人真正需要它的地方和时间。该值应该在单个请求期间仅在代码中使用，之后它有效地无效。

我提出了两个选择：

1.  在 ActionFilter 中，我在 OnActioExecuting() 的 TempData 中设置了该值，并在 OnActionExecuted() 中将其删除。我是否正确理解，在调用 OnActionExecuted 时，控制器操作已完成，响应已生成，并且此 TempData 内容尚未进入会话？

2.  在我的任何自定义静态类（逻辑）中，我只为这个值定义一个公共属性，并在需要时使用它。这个静态字段在 OnActionExecuting() 和实际执行控制器方法之间不会丢失吗？在服务器上的请求处理期间是否有可能丢失此值的任何其他问题？

我还没有考虑过其他/更好的选择吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-03T19:59:23.987

我发现 using`ActionParameters`使您的代码非常容易测试。你可以这样做：

```
// inside your actionfilter
public override void OnActionExecuting(ActionExecutinContext context)
{
    var someData = // ... load some data

    context.ActionParameters["someData"] = someData;
}

// and then in your action method
[ProvideSomeData]
public ViewResult Index(SomeData someData)
{
    // someData will be populated in here
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T20:19:15.330

回复：#2

只是想指出静态字段的问题是多个请求都将使用相同的静态字段。如果您有两个请求同时执行，则请求 B 总是有可能覆盖请求 A 的值，并且当请求 A 的操作执行时，您将使用错误的值。

我会避免使用静态成员来保存请求的特定信息。

# c# - 如何将 url 参数添加到 asp.net mvc 中的 routelink？

> ID：817846
> 
> 赞同：1
> 
> 时间：2009-05-03T19:54:41.957
> 
> 标签：c#, .net, asp.net, asp.net-mvc

所有，我的情况是我有基本路线，加上其他一些简单的路线：

```
routes.MapRoute(
                "Default",                                              
                "{controller}/{action}/{id}",                           
                new { controller = "Home", action = "Index", id = 1}
            ); 
```

所以以下网址有效：**[http ://somesite.com/tags/index/1](http://somesite.com/tags/index/1)**

但是，我的一些索引页面采用以下方式获取 url 参数：

**[http://somesite.com/tags/index/1?when=lastmonth](http://somesite.com/tags/index/1?when=lastmonth)**

**如何使用 Html.RouteLink 链接到这个？**

您**不能**添加“？” 像这样在全局 asax 文件中路由：

```
routes.MapRoute("TagsWhen", "Tags/index/{id}?when={when}",
      new {controller = "Tags", action = "Index", id = "", when = ""}); 
```

如果这条路线有效，我可以使用以下方法链接到它：

```
Html.RouteLink(string.Format("{0} ", link.Rating), "LinksWhen", 
               new {id=link.ReferenceId, when=Model.When}) 
```

但事实并非如此！所以我不确定如何使用 Html.RouteLink 生成[http://somesite.com/tags/index/1?when=lastmonth](http://somesite.com/tags/index/1?when=lastmonth)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T20:14:09.303

刚刚自己找到了解决方案。你可以做一个常规的 Html.RouteLink 和任何你没有映射到 global.asax 中它作为 url 参数添加的 url 的对象属性。

所以使用这条路线：

```
 routes.MapRoute(
        "Links",                                              
        "Links/details/{id}",                           
        new { controller = "Links", action = "Details", id = ""} defaults
    ); 
```

和这条路线链接：

```
Html.RouteLink("Link Text", "Links", 
        new {id=link.ReferenceId, when=Model.When }) 
```

生成正确的网址：

[http://localhost:2535/Links/details/1?when=onemonth](http://localhost:2535/Links/details/1?when=onemonth)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T05:42:17.923

Matthew 的方法可能不起作用，因为他最后需要另一个`null`参数，否则它将路由值作为 html 属性传递。:)

```
<%= Html.ActionLink("Link text", "Index", "Home", new { id = 1, when = "lastmonth" }, null) %> 
```

`MapRoute()`你想出的最后一个应该可以很好地对付它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-03T19:58:20.310

我没有一台能够测试这个的电脑，但我想不到

```
<%= Html.ActionLink("Link text", "Index", "Home", new { id = 1, when = "lastmonth" } %> 
```

您无需在 global.asax.cs 文件中的路由中指定可选参数。默认情况下，任何不匹配的内容都会被放入查询字符串中。

# java - What is the difference between Serializable and Externalizable in Java?

> ID：817853
> 
> 赞同：294
> 
> 时间：2009-05-03T19:58:19.217
> 
> 标签：java, serialization, serializable, externalizable

What is the difference between [`Serializable`](http://java.sun.com/javase/6/docs/api/java/io/Serializable.html) and [`Externalizable`](http://java.sun.com/javase/6/docs/api/java/io/Externalizable.html) in Java?

* * *

## 回答 #1

> 赞同：282
> 
> 时间：2009-05-03T21:51:00.037

要添加到其他答案，通过实现`java.io.Serializable`，您可以获得类对象的“自动”序列化功能。无需实现任何其他逻辑，它会正常工作。Java 运行时将使用反射来确定如何编组和解组您的对象。

在 Java 的早期版本中，反射非常慢，因此序列化大型对象图（例如在客户端-服务器 RMI 应用程序中）有点性能问题。为了处理这种情况，`java.io.Externalizable`提供了接口，它类似于`java.io.Serializable`但具有自定义编写的机制来执行编组和解组功能（您需要在类上实现`readExternal`和`writeExternal`方法）。这为您提供了绕过反射性能瓶颈的方法。

在 Java 的最新版本（当然是 1.3 以后的版本）中，反射的性能比以前要好得多，因此这不是什么问题。我怀疑您很难从`Externalizable`现代 JVM 中获得有意义的好处。

此外，内置的 Java 序列化机制不是唯一的，您可以获得第三方替代品，例如 JBoss Serialization，它要快得多，并且是默认的替代品。

一个很大的缺点`Externalizable`是你必须自己维护这个逻辑——如果你在你的类中添加、删除或更改一个字段，你必须改变你的`writeExternal`/`readExternal`方法来解释它。

综上所述，`Externalizable`是Java 1.1时代的遗物。真的已经没有必要了。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2013-03-20T08:02:48.927

序列化提供了存储和稍后重新创建对象的默认功能。它使用详细格式来定义要存储的对象的整个图，例如假设您有一个linkedList，并且您的代码如下所示，那么默认序列化将发现所有链接的对象并将进行序列化。在默认序列化中，对象完全由其存储的位构造，没有构造函数调用。

```
 ObjectOutputStream oos = new ObjectOutputStream(
      new FileOutputStream("/Users/Desktop/files/temp.txt"));
  oos.writeObject(linkedListHead); //writing head of linked list
  oos.close(); 
```

但是，如果您想要限制序列化或不希望您的对象的某些部分被序列化，那么请使用 Externalizable。Externalizable 接口扩展了 Serializable 接口，增加了两个方法，writeExternal() 和 readExternal()。这些在序列化或反序列化时自动调用。在使用 Externalizable 时，我们应该记住默认构造函数应该是公共的，否则代码将抛出异常。请遵循以下代码：

```
public class MyExternalizable implements Externalizable
{

private String userName;
private String passWord;
private Integer roll;

public MyExternalizable()
{
}

public MyExternalizable(String userName, String passWord, Integer roll)
{
    this.userName = userName;
    this.passWord = passWord;
    this.roll = roll;
}

@Override
public void writeExternal(ObjectOutput oo) throws IOException 
{
    oo.writeObject(userName);
    oo.writeObject(roll);
}

@Override
public void readExternal(ObjectInput oi) throws IOException, ClassNotFoundException 
{
    userName = (String)oi.readObject();
    roll = (Integer)oi.readObject();
}

public String toString()
{
    StringBuilder b = new StringBuilder();
    b.append("userName: ");
    b.append(userName);
    b.append("  passWord: ");
    b.append(passWord);
    b.append("  roll: ");
    b.append(roll);

    return b.toString();
}
public static void main(String[] args)
{
    try
    {
        MyExternalizable m  = new MyExternalizable("nikki", "student001", 20);
        System.out.println(m.toString());
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("/Users/Desktop/files/temp1.txt"));
        oos.writeObject(m);
        oos.close();

        System.out.println("***********************************************************************");
        ObjectInputStream ois = new ObjectInputStream(new FileInputStream("/Users/Desktop/files/temp1.txt"));
        MyExternalizable mm = (MyExternalizable)ois.readObject();
        mm.toString();
        System.out.println(mm.toString());
    } 
    catch (ClassNotFoundException ex) 
    {
        Logger.getLogger(MyExternalizable.class.getName()).log(Level.SEVERE, null, ex);
    }
    catch(IOException ex)
    {
        Logger.getLogger(MyExternalizable.class.getName()).log(Level.SEVERE, null, ex);
    }
}
} 
```

在这里，如果您注释默认构造函数，则代码将引发以下异常：

```
 java.io.InvalidClassException: javaserialization.MyExternalizable;     
 javaserialization.MyExternalizable; no valid constructor. 
```

我们可以观察到，由于密码是敏感信息，所以我没有在 writeExternal(ObjectOutput oo) 方法中对其进行序列化，也没有在 readExternal(ObjectInput oi) 中设置相同的值。这就是 Externalizable 提供的灵活性。

上述代码的输出如下：

```
userName: nikki  passWord: student001  roll: 20
***********************************************************************
userName: nikki  passWord: null  roll: 20 
```

我们可以观察到，因为我们没有设置 passWord 的值，所以它为空。

也可以通过将密码字段声明为瞬态来实现。

```
private transient String passWord; 
```

希望能帮助到你。如果我犯了任何错误，我深表歉意。谢谢。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2016-04-07T18:57:26.923

`Serializable`和之间的主要区别`Externalizable`

1.  **标记接口**：`Serializable`是没有任何方法的标记接口。`Externalizable`接口包含两个方法：`writeExternal()`和`readExternal()`。
2.  **序列化过程**：默认序列化过程将被用于实现`Serializable`接口的类。程序员定义的序列化过程将被用于实现`Externalizable`接口的类。
3.  **维护**：[不兼容的更改](https://docs.oracle.com/javase/8/docs/platform/serialization/spec/version.html)可能会破坏序列化。
4.  **向后兼容性和控制**：如果您必须支持多个版本，您可以完全控制`Externalizable`界面。您可以支持不同版本的对象。如果您实现，则序列化类`Externalizable`是您的责任`super`
5.  **公共无参数构造函数**： `Serializable`使用反射构造对象，不需要无参数构造函数。但`Externalizable`需要公共无参数构造函数。

有关详细信息，请参阅[博客](http://www.codingeek.com/java/io/differences-serializable-externalizable-interface-java-tutorial/)`Hitesh Garg`。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-05-03T20:12:54.937

Serialization uses certain default behaviors to store and later recreate the object. You may specify in what order or how to handle references and complex data structures, but eventually it comes down to using the default behavior for each primitive data field.

Externalization is used in the rare cases that you really want to store and rebuild your object in a completely different way and without using the default serialization mechanisms for data fields. For example, imagine that you had your own unique encoding and compression scheme.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-01-17T12:35:00.963

**对象序列化使用 Serializable 和 Externalizable 接口。** Java 对象只能序列化。如果一个类或其任何超类实现了 java.io.Serializable 接口或其子接口 java.io.Externalizable。*大多数 java 类都是可序列化的*。

*   [`NotSerializableException`](https://docs.oracle.com/javase/8/docs/api/java/io/NotSerializableException.html): *`packageName.ClassName`*« 要参与序列化过程中的类对象，该类必须实现 Serializable 或 Externalizable 接口。

[![在此处输入图像描述](https://i.stack.imgur.com/wxIkL.png)](https://i.stack.imgur.com/wxIkL.png)

* * *

**[可序列化接口](https://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html)**

对象序列化生成一个流，其中包含有关正在保存的对象的 Java 类的信息。对于可序列化的对象，即使存在不同（但兼容）的类实现版本，也会保留足够的信息来恢复这些对象。Serializable 接口被定义为识别实现可序列化协议的类：

```
package java.io;

public interface Serializable {}; 
```

*   序列化接口没有方法或字段，仅用于识别可序列化的语义。对于类的序列化/反序列化，我们可以使用默认的 writeObject 和 readObject 方法（或者）我们可以覆盖类中的 writeObject 和 readObject 方法。
*   JVM 将完全控制对象的序列化。使用*[瞬态关键字](https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.5-200-A.1)*来防止数据成员被序列化。
*   这里可序列化的对象是直接从流中重构而不执行
*   [**`InvalidClassException`**](https://docs.oracle.com/javase/7/docs/api/java/io/InvalidClassException.html)« 在反序列化过程中，如果本地类*[serialVersionUID](https://docs.oracle.com/javase/6/docs/platform/serialization/spec/class.html#5023)*值与对应的sender类不同。然后导致冲突 `java.io.InvalidClassException: com.github.objects.User; local class incompatible: stream classdesc serialVersionUID = 5081877, local class serialVersionUID = 50818771`
*   类的非瞬态和非静态字段的值被序列化。

**[可外部化接口](https://docs.oracle.com/javase/8/docs/api/java/io/Externalizable.html)**

对于 Externalizable 对象，容器只保存对象的类的标识；该类必须保存和恢复内容。Externalizable 接口定义如下：

```
package java.io;

public interface Externalizable extends Serializable
{
    public void writeExternal(ObjectOutput out)
        throws IOException;

    public void readExternal(ObjectInput in)
        throws IOException, java.lang.ClassNotFoundException;
} 
```

*   Externalizable 接口有两个方法，一个可外部化的对象必须实现 writeExternal 和 readExternal 方法来保存/恢复对象的状态。
*   程序员必须处理要序列化的对象。作为程序员照顾序列化所以，这里的瞬态关键字不会限制序列化过程中的任何对象。
*   重构 Externalizable 对象时，会使用公共无参数构造函数创建实例，然后调用 readExternal 方法。可序列化对象是通过从 ObjectInputStream 中读取来恢复的。
*   [**`OptionalDataException`**](https://docs.oracle.com/javase/7/docs/api/java/io/OptionalDataException.html)« 字段*的顺序和类型必须*与我们写出的相同。如果流中的任何类型不匹配，则会抛出 OptionalDataException。

    ```
    @Override public void writeExternal(ObjectOutput out) throws IOException {
        out.writeInt( id );
        out.writeUTF( role );
        out.writeObject(address);
    }
    @Override public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
        this.id = in.readInt();
        this.address = (Address) in.readObject();
        this.role = in.readUTF();
    } 
    ```

*   *写入（公开）*以`ObjectOutput`进行序列化的类的实例字段。

* * *

示例**«**实现可序列化

```
class Role {
    String role;
}
class User extends Role implements Serializable {

    private static final long serialVersionUID = 5081877L;
    Integer id;
    Address address;

    public User() {
        System.out.println("Default Constructor get executed.");
    }
    public User( String role ) {
        this.role = role;
        System.out.println("Parametarised Constructor.");
    }
}

class Address implements Serializable {

    private static final long serialVersionUID = 5081877L;
    String country;
} 
```

示例*«*实现 Externalizable

```
class User extends Role implements Externalizable {

    Integer id;
    Address address;
    // mandatory public no-arg constructor
    public User() {
        System.out.println("Default Constructor get executed.");
    }
    public User( String role ) {
        this.role = role;
        System.out.println("Parametarised Constructor.");
    }

    @Override
    public void writeExternal(ObjectOutput out) throws IOException {
        out.writeInt( id );
        out.writeUTF( role );
        out.writeObject(address);
    }
    @Override
    public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
        this.id = in.readInt();
        this.address = (Address) in.readObject();
        this.role = in.readUTF();
    }
} 
```

例子

```
public class CustomClass_Serialization {
    static String serFilename = "D:/serializable_CustomClass.ser";

    public static void main(String[] args) throws IOException {
        Address add = new Address();
        add.country = "IND";

        User obj = new User("SE");
        obj.id = 7;
        obj.address = add;

        // Serialization
        objects_serialize(obj, serFilename);
        objects_deserialize(obj, serFilename);

        // Externalization
        objects_WriteRead_External(obj, serFilename);
    }

    public static void objects_serialize( User obj, String serFilename ) throws IOException{
        FileOutputStream fos = new FileOutputStream( new File( serFilename ) );
        ObjectOutputStream objectOut = new ObjectOutputStream( fos );

        // java.io.NotSerializableException: com.github.objects.Address
        objectOut.writeObject( obj );
        objectOut.flush();
        objectOut.close();
        fos.close();

        System.out.println("Data Stored in to a file");
    }
    public static void objects_deserialize( User obj, String serFilename ) throws IOException{
        try {
            FileInputStream fis = new FileInputStream( new File( serFilename ) );
            ObjectInputStream ois = new ObjectInputStream( fis );
            Object readObject;
            readObject = ois.readObject();
            String calssName = readObject.getClass().getName();
            System.out.println("Restoring Class Name : "+ calssName); // InvalidClassException

            User user = (User) readObject;
            System.out.format("Obj[Id:%d, Role:%s] \n", user.id, user.role);

            Address add = (Address) user.address;
            System.out.println("Inner Obj : "+ add.country );
            ois.close();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }

    public static void objects_WriteRead_External( User obj, String serFilename ) throws IOException {
        FileOutputStream fos = new FileOutputStream(new File( serFilename ));
        ObjectOutputStream objectOut = new ObjectOutputStream( fos );

        obj.writeExternal( objectOut );
        objectOut.flush();

        fos.close();

        System.out.println("Data Stored in to a file");

        try {
            // create a new instance and read the assign the contents from stream.
            User user = new User();

            FileInputStream fis = new FileInputStream(new File( serFilename ));
            ObjectInputStream ois = new ObjectInputStream( fis );

            user.readExternal(ois);

            System.out.format("Obj[Id:%d, Role:%s] \n", user.id, user.role);

            Address add = (Address) user.address;
            System.out.println("Inner Obj : "+ add.country );
            ois.close();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

@看

*   [什么是对象序列化](https://stackoverflow.com/a/31651945/5081877)
*   [对象序列化：常见问题](http://www.oracle.com/technetwork/java/javase/tech/serializationfaq-jsp-136699.html)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-03T21:41:29.827

[https://docs.oracle.com/javase/8/docs/platform/serialization/spec/serialTOC.html](https://docs.oracle.com/javase/8/docs/platform/serialization/spec/serialTOC.html)

默认序列化有点冗长，并假定序列化对象的最广泛使用场景，因此默认格式 (Serializable) 使用有关序列化对象类的信息来注释结果流。

外部化使对象流的生产者能够完全控制精确的类元数据（如果有的话），超出了对类的最低要求标识（例如，它的名称）。这在某些情况下显然是可取的，例如在封闭环境中，对象流的生产者和它的消费者（从流中具体化对象）是匹配的，并且关于类的附加元数据没有任何用途并且会降低性能。

此外（正如 Uri 指出的那样），外部化还提供了对与 Java 类型相对应的流中数据的编码的完全控制。对于（一个人为的）示例，您可能希望将布尔值 true 记录为“Y”，将 false 记录为“N”。外化允许你这样做。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-08-27T08:37:01.643

实际上并没有提供 Externalizable 接口来优化序列化过程的性能！但要提供实现您自己的自定义处理的方法，并提供对对象及其超类型流的格式和内容的完全控制！

这方面的示例是实现 AMF（ActionScript 消息格式）远程处理以通过网络传输本机操作脚本对象。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2011-10-28T13:47:42.703

在考虑提高性能的选项时，不要忘记自定义序列化。您可以免费让 Java 做它做得好的事情，或者至少做得足够好*，*并为它做得不好的事情提供自定义支持。这通常比完整的 Externalizable 支持少很多代码。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-10-11T10:27:41.097

Serializable 和 Externalizable 之间存在很多差异，但是当我们比较自定义 Serializable(overrided writeObject() & readObject()) 和 Externalizable 之间的差异时，我们发现自定义实现与 ObjectOutputStream 类紧密绑定，在 Externalizable 案例中，我们自己提供 ObjectOutput 的实现，它可以是 ObjectOutputStream 类，也可以是其他的，例如 org.apache.mina.filter.codec.serialization.ObjectSerializationOutputStream

**如果是 Externalizable 接口**

```
@Override
public void writeExternal(ObjectOutput out) throws IOException {
    out.writeUTF(key);
    out.writeUTF(value);
    out.writeObject(emp);
}

@Override
public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
    this.key = in.readUTF();
    this.value = in.readUTF();
    this.emp = (Employee) in.readObject();
}

**In case of Serializable interface**

        /* 
             We can comment below two method and use default serialization process as well
             Sequence of class attributes in read and write methods MUST BE same.
        // below will not work it will not work . 
        // Exception = java.io.StreamCorruptedException: invalid type code: 00\
              private void writeObject(java.io.ObjectOutput stream) 
              */
            private void writeObject(java.io.ObjectOutputStream Outstream)
                    throws IOException {

                System.out.println("from writeObject()");
                /*     We can define custom validation or business rules inside read/write methods.
 This way our validation methods will be automatically 
    called by JVM, immediately after default serialization 
    and deserialization process 
    happens.
                 checkTestInfo();
                */

                stream.writeUTF(name);
                stream.writeInt(age);
                stream.writeObject(salary);
                stream.writeObject(address);
            }

            private void readObject(java.io.ObjectInputStream Instream)
                    throws IOException, ClassNotFoundException {
                System.out.println("from readObject()");
                name = (String) stream.readUTF();
                age = stream.readInt();
                salary = (BigDecimal) stream.readObject();
                address = (Address) stream.readObject();
                // validateTestInfo();
            } 
```

我添加了示例代码以更好地解释。请签入/签出 Externalizable 的对象案例。这些不直接绑定到任何实现。
Outstream/Instream 与类紧密绑定。我们可以扩展 ObjectOutputStream/ObjectInputStream 但它会有点难用。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-10-11T02:57:22.523

基本上，`Serializable`是一个标记接口，它意味着一个类对于序列化是安全的，并且 JVM 确定它是如何序列化的。`Externalizable`包含 2 个方法，`readExternal`和`writeExternal`. `Externalizable`允许实现者决定如何序列化对象，其中`Serializable`序列化对象是默认方式。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-12-23T17:28:42.803

一些区别：

1.  对于序列化，不需要该类的默认构造函数，因为 Object 因为 JVM 在反射 API 的帮助下构造相同。在不需要 arg 的外部化构造器的情况下，因为控制权在程序手中，然后通过设置器将反序列化的数据分配给对象。

2.  在序列化中，如果用户想要跳过某些要序列化的属性，则必须将该属性标记为瞬态，反之亦然，外部化不需要。

3.  当任何类都需要向后兼容支持时，建议使用 Externalizable。序列化支持 defaultObject 持久化，如果对象结构被破坏，那么在反序列化时会导致问题。

# ruby-on-rails - 在 Rails 上管理定价/折扣业务规则的最佳实践

> ID：817855
> 
> 赞同：-1
> 
> 时间：2009-05-03T19:58:49.013
> 
> 标签：ruby-on-rails

我对 Rails 还很陌生，而且我从未开发过大型应用程序。我和我的一个朋友正在开发两个独立的应用程序，我们发现我们都需要一种通用管理定价/折扣规则的方法。

场景：假设您有一个会议注册应用程序，根据使用该应用程序的用户，他们可能会选择提供不同的定价计划。50 美元 1 位与会者 40 美元 >5 位与会者 参展商获得 3 位免费与会者，每增加 30 美元

与其烘焙这些规则的细节，不如以某种方式抽象它，这样规则可以随着时间和会议而改变。

处理此问题的最佳做法是什么？有 Rails 插件吗？我们都搜索过，但还没有找到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-06T22:33:45.807

我也不知道现有的插件，但既然你至少有两个需要这个的应用程序，为什么不尝试把它变成一个[Rails 引擎](http://railscasts.com/episodes/149-rails-engines)呢？

这样一来，您和您的朋友就可以将您的工作减半，并拥有一些您可以开源并通过社区反馈进行展示和改进的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T21:10:23.380

我认为你应该看看[RuleBy](http://ruleby.org/ "RuleBy 规则引擎")。我自己没有使用过，但我仍然想找时间尝试一下。它应该准确地解决这些问题。

# java - 我应该何时以及如何使用 ThreadLocal 变量？

> ID：817856
> 
> 赞同：946
> 
> 时间：2009-05-03T19:59:20.760
> 
> 标签：java, multithreading, concurrency, thread-local, thread-confinement

什么时候应该使用[`ThreadLocal`](https://docs.oracle.com/javase/8/docs/api/java/lang/ThreadLocal.html)变量？

它是如何使用的？

* * *

## 回答 #1

> 赞同：899
> 
> 时间：2009-05-03T20:26:17.993

一种可能的（也是常见的）用途是当您有一些不是线程安全的对象，但您想避免[同步](https://docs.oracle.com/javase/tutorial/essential/concurrency/sync.html)访问该对象时（我正在看着您，[SimpleDateFormat](https://docs.oracle.com/javase/8/docs/api/java/text/SimpleDateFormat.html)）。相反，给每个线程它自己的对象实例。

例如：

```
public class Foo
{
    // SimpleDateFormat is not thread-safe, so give one to each thread
    private static final ThreadLocal<SimpleDateFormat> formatter = new ThreadLocal<SimpleDateFormat>(){
        @Override
        protected SimpleDateFormat initialValue()
        {
            return new SimpleDateFormat("yyyyMMdd HHmm");
        }
    };

    public String formatIt(Date date)
    {
        return formatter.get().format(date);
    }
} 
```

[文档](https://docs.oracle.com/javase/8/docs/api/java/lang/ThreadLocal.html)。

* * *

## 回答 #2

> 赞同：446
> 
> 时间：2009-05-03T22:02:09.963

由于 a`ThreadLocal`是对给定 中数据的引用，因此在使用线程池的应用程序服务器中`Thread`使用 s 时，最终可能会导致类加载泄漏。`ThreadLocal`您需要非常小心地清理任何`ThreadLocal`s`get()`或`set()`使用`ThreadLocal`'`remove()`方法。

如果您在完成后不清理，则它对作为已部署 web 应用程序的一部分加载的类的任何引用都将保留在[永久堆中](https://web.archive.org/web/20070104122432/http://www.brokenbuild.com/blog/2006/08/04/java-jvm-gc-permgen-and-memory-options/)，并且永远不会被垃圾收集。重新部署/取消部署 webapp 不会清除每个`Thread`对您的 webapp 类的引用，因为`Thread`它不是您的 webapp 拥有的东西。每个连续的部署都会创建一个永远不会被垃圾收集的类的新实例。

`java.lang.OutOfMemoryError: PermGen space`由于一些谷歌搜索可能只会增加`-XX:MaxPermSize`而不是修复错误，因此您最终会出现内存不足异常。

如果您最终遇到了这些问题，您可以通过使用[Eclipse 的内存分析器](http://www.eclipse.org/mat/)和/或遵循[Frank Kieviet 的指南](http://frankkieviet.blogspot.com/2006/10/classloader-leaks-dreaded-permgen-space.html)和[跟](http://frankkieviet.blogspot.com/2006/10/how-to-fix-dreaded-permgen-space.html)进来确定哪个线程和类保留了这些引用。

更新：重新发现了[Alex Vasseur 的博客条目](http://avasseur.blogspot.com/2003/11/threadlocal-and-memory-leaks.html)，它帮助我找到了`ThreadLocal`我遇到的一些问题。

* * *

## 回答 #3

> 赞同：187
> 
> 时间：2009-05-04T13:36:12.137

许多框架使用 ThreadLocals 来维护一些与当前线程相关的上下文。例如，当当前事务存储在 ThreadLocal 中时，您不需要通过每个方法调用将其作为参数传递，以防堆栈中的某人需要访问它。Web 应用程序可能会将有关当前请求和会话的信息存储在 ThreadLocal 中，以便应用程序可以轻松访问它们。使用 Guice，您可以在为注入对象实现[自定义范围](https://github.com/google/guice/wiki/CustomScopes)时使用 ThreadLocals （Guice 的默认[servlet 范围](https://github.com/google/guice/wiki/Scopes)很可能也使用它们）。

ThreadLocals 是一种全局变量（尽管由于它们被限制在一个线程中而稍微不那么邪恶），因此在使用它们时应该小心以避免不必要的副作用和内存泄漏。设计您的 API，以便 ThreadLocal 值在不再需要时始终自动清除，并且不会错误地使用 API（例如[像这样](https://github.com/orfjackal/dimdwarf/blob/453f7aee9efc364ebad80531c05081e255323c07/dimdwarf-core/src/main/java/net/orfjackal/dimdwarf/context/ThreadContext.java#L48-55)）。ThreadLocals 可用于使代码更清晰，并且在极少数情况下，它们是使某些工作正常工作的唯一方法（我当前的项目有两个这样的情况；它们在[此处](https://github.com/orfjackal/dimdwarf/wiki/Design-Guidelines)记录在“静态字段和全局变量”下）。

* * *

## 回答 #4

> 赞同：55
> 
> 时间：2009-05-03T20:20:39.023

在 Java 中，如果您有一个可以在每个线程中变化的数据，您的选择是将该数据传递给每个需要（或可能需要）它的方法，或者将该数据与线程相关联。如果您的所有方法都需要传递一个通用的“上下文”变量，那么到处传递数据可能是可行的。

如果不是这种情况，您可能不希望使用附加参数来混淆您的方法签名。在非线程世界中，您可以使用 Java 等效的全局变量来解决问题。在线程词中，全局变量的等价物是线程局部变量。

* * *

## 回答 #5

> 赞同：31
> 
> 时间：2015-10-04T09:28:35.137

**Java Concurrency in Practice**一书中有很好的例子。作者 ( [Joshua Bloch](https://en.wikipedia.org/wiki/Joshua_Bloch) ) 解释了线程限制是如何实现线程安全的最简单方法之一，而**ThreadLocal**是维护线程限制的更正式的方法。最后他还解释了人们如何通过将它用作全局变量来滥用它。

我已经从提到的书中复制了文本，但是缺少代码 3.10，因为了解应该在哪里使用 ThreadLocal 并不重要。

> 线程局部变量通常用于防止在基于可变单例或全局变量的设计中共享。例如，单线程应用程序可能会维护一个在启动时初始化的全局数据库连接，以避免必须将 Connection 传递给每个方法。由于 JDBC 连接可能不是线程安全的，因此在没有额外协调的情况下使用全局连接的多线程应用程序也不是线程安全的。通过使用 ThreadLocal 来存储 JDBC 连接，如清单 3.10 中的 ConnectionHolder，每个线程都有自己的连接。
> 
> ThreadLocal 广泛用于实现应用程序框架。例如，J2EE 容器在 EJB 调用期间将事务上下文与执行线程相关联。这很容易使用持有事务上下文的静态 Thread-Local 实现：当框架代码需要确定当前正在运行的事务时，它会从该 ThreadLocal 中获取事务上下文。这很方便，因为它减少了将执行上下文信息传递给每个方法的需要，但将使用此机制的任何代码耦合到框架。
> 
> 通过将其线程限制属性视为使用全局变量的许可或作为创建“隐藏”方法参数的一种手段，很容易滥用 ThreadLocal。与全局变量一样，线程局部变量会降低可重用性并在类之间引入隐藏的耦合，因此应谨慎使用。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2009-05-03T23:50:05.463

本质上，当您需要一个**变量的值依赖于当前线程**并且**不方便以其他方式将值附加到线程时**（例如，子类化线程）。

一个典型的例子是**其他一些框架已经创建了**你的代码正在运行的线程，例如一个 servlet 容器，或者使用 ThreadLocal 更有意义，因为你的变量然后“在它的逻辑位置”（而不是一个变量挂在 Thread 子类或其他一些哈希映射中）。

在我的网站上，我有一些[关于何时使用 ThreadLocal 的进一步讨论和示例，](https://www.javamex.com/tutorials/synchronization_concurrency_thread_local3.shtml)这可能也很有趣。

有些人提倡使用 ThreadLocal 作为一种在某些需要线程号的并发算法中将“线程 ID”附加到每个线程的方法（参见例如 Herlihy 和 Shavit）。在这种情况下，请检查您是否真的得到了好处！

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2013-07-01T06:10:23.777

1.  Java 中的 ThreadLocal 已在 JDK 1.2 中引入，但后来在 JDK 1.5 中进行了泛化，以在 ThreadLocal 变量上引入类型安全。

2.  ThreadLocal 可以与 Thread 作用域相关联，Thread 执行的所有代码都可以访问 ThreadLocal 变量，但两个线程不能看到彼此的 ThreadLocal 变量。

3.  每个线程都拥有一个 ThreadLocal 变量的独占副本，该副本在线程完成或死亡后（通常或由于任何异常）有资格进行垃圾收集，因为这些 ThreadLocal 变量没有任何其他实时引用。

4.  Java 中的 ThreadLocal 变量通常是 Classes 中的私有静态字段，并在 Thread 内部维护其状态。

阅读更多：[Java 中的 ThreadLocal - 示例程序和教程](https://javarevisited.blogspot.com/2012/05/how-to-use-threadlocal-in-java-benefits.html#ixzz2XltgbHTK)

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2009-05-03T20:05:21.697

[该文档](http://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html)说得很好：“访问[线程局部变量]（通过其get或set方法）的每个线程都有自己的，独立初始化的变量副本”。

当每个线程都必须有自己的某些东西的副本时，您使用一个。默认情况下，数据在线程之间共享。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2013-04-28T15:22:29.383

Webapp服务器可能会保留一个线程池，并且`ThreadLocal`在响应客户端之前应该删除一个var，这样当前线程可能会被下一个请求重用。

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-08-20T15:58:15.827

可以使用线程局部变量的两个用例 -
1- 当我们需要将状态与线程关联时（例如，用户 ID 或事务 ID）。这通常发生在 Web 应用程序中，每个发送到 servlet 的请求都有一个与之关联的唯一 transactionID。

```
// This class will provide a thread local variable which
// will provide a unique ID for each thread
class ThreadId {
    // Atomic integer containing the next thread ID to be assigned
    private static final AtomicInteger nextId = new AtomicInteger(0);

    // Thread local variable containing each thread's ID
    private static final ThreadLocal<Integer> threadId =
        ThreadLocal.<Integer>withInitial(()-> {return nextId.getAndIncrement();});

    // Returns the current thread's unique ID, assigning it if necessary
    public static int get() {
        return threadId.get();
    }
} 
```

请注意，这里的 withInitial 方法是使用 lambda 表达式实现的。
2-另一个用例是当我们想要一个线程安全的实例并且我们不想使用同步，因为同步的性能成本更高。一种这样的情况是使用 SimpleDateFormat 时。由于 SimpleDateFormat 不是线程安全的，因此我们必须提供使其线程安全的机制。

```
public class ThreadLocalDemo1 implements Runnable {
    // threadlocal variable is created
    private static final ThreadLocal<SimpleDateFormat> dateFormat = new ThreadLocal<SimpleDateFormat>(){
        @Override
        protected SimpleDateFormat initialValue(){
            System.out.println("Initializing SimpleDateFormat for - " + Thread.currentThread().getName() );
            return new SimpleDateFormat("dd/MM/yyyy");
        }
    };

    public static void main(String[] args) {
        ThreadLocalDemo1 td = new ThreadLocalDemo1();
        // Two threads are created
        Thread t1 = new Thread(td, "Thread-1");
        Thread t2 = new Thread(td, "Thread-2");
        t1.start();
        t2.start();
    }

    @Override
    public void run() {
        System.out.println("Thread run execution started for " + Thread.currentThread().getName());
        System.out.println("Date formatter pattern is  " + dateFormat.get().toPattern());
        System.out.println("Formatted date is " + dateFormat.get().format(new Date()));
    } 

} 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2018-03-27T09:24:05.200

自 Java 8 发布以来，有更多的声明方式来初始化`ThreadLocal`：

```
ThreadLocal<Cipher> local = ThreadLocal.withInitial(() -> "init value"); 
```

在 Java 8 发布之前，您必须执行以下操作：

```
ThreadLocal<String> local = new ThreadLocal<String>(){
    @Override
    protected String initialValue() {
        return "init value";
    }
}; 
```

此外，如果用于的类的实例化方法（构造函数、工厂方法）`ThreadLocal`不带任何参数，则可以简单地使用方法引用（Java 8 中引入）：

```
class NotThreadSafe {
    // no parameters
    public NotThreadSafe(){}
}

ThreadLocal<NotThreadSafe> container = ThreadLocal.withInitial(NotThreadSafe::new); 
```

**注意：** 评估是惰性的，因为您传递的`java.util.function.Supplier`lambda 仅在被调用时才被评估，`ThreadLocal#get`但之前未评估值。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-10-23T18:50:09.197

您必须非常小心 ThreadLocal 模式。像 Phil 提到的一些主要缺点，但没有提到的是确保设置 ThreadLocal 上下文的代码不是“可重入的”。

当设置信息的代码第二次或第三次运行时，可能会发生不好的事情，因为线程上的信息可能会在您未预料到的情况下开始变异。所以在再次设置之前请注意确保没有设置 ThreadLocal 信息。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2015-12-02T12:07:44.933

> ThreadLocal 会保证非同步方法中的多个线程访问可变对象是同步的，即使可变对象在方法内不可变。
> 
> 这是通过为每个尝试访问它的线程提供可变对象的新实例来实现的。所以它是每个线程的本地副本。这是在方法中制作实例变量以像局部变量一样访问的一些技巧。如您所知，方法局部变量仅对线程可用，一个区别是；一旦方法执行结束，方法局部变量将无法用于线程，因为与 threadlocal 共享的可变对象将在多个方法中可用，直到我们清理它。

**按定义：**

> Java 中的 ThreadLocal 类使您能够创建只能由同一线程读取和写入的变量。因此，即使两个线程正在执行相同的代码，并且代码引用了一个 ThreadLocal 变量，那么这两个线程也无法看到彼此的 ThreadLocal 变量。

`Thread`java中的每个都包含`ThreadLocalMap`在其中。
在哪里

```
Key = One ThreadLocal object shared across threads.
value = Mutable object which has to be used synchronously, this will be instantiated for each thread. 
```

**实现 ThreadLocal：**

现在为 ThreadLocal 创建一个包装类，它将保存如下所示的可变对象（带或不带`initialValue()`）。
现在这个包装器的 getter 和 setter 将在 threadlocal 实例而不是可变对象上工作。

`Thread`如果 threadlocal 的 getter() 在;的 threadlocalmap 中没有找到任何值 然后它将调用 initialValue() 以获取其与线程相关的私有副本。

```
class SimpleDateFormatInstancePerThread {

    private static final ThreadLocal<SimpleDateFormat> dateFormatHolder = new ThreadLocal<SimpleDateFormat>() {

        @Override
        protected SimpleDateFormat initialValue() {
            SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd") {
                UUID id = UUID.randomUUID();
                @Override
                public String toString() {
                    return id.toString();
                };
            };
            System.out.println("Creating SimpleDateFormat instance " + dateFormat +" for Thread : " + Thread.currentThread().getName());
            return dateFormat;
        }
    };

    /*
     * Every time there is a call for DateFormat, ThreadLocal will return calling
     * Thread's copy of SimpleDateFormat
     */
    public static DateFormat getDateFormatter() {
        return dateFormatHolder.get();
    }

    public static void cleanup() {
        dateFormatHolder.remove();
    }
} 
```

现在`wrapper.getDateFormatter()`将调用`threadlocal.get()`并检查`currentThread.threadLocalMap`包含**此**（线程本地）实例。
如果是，则返回相应线程本地实例的值 (SimpleDateFormat)，
否则添加带有此线程本地实例的映射，initialValue()。

从而在这个可变类上实现了线程安全；每个线程都使用自己的可变实例但使用相同的 ThreadLocal 实例。意味着所有线程将共享相同的 ThreadLocal 实例作为键，但不同的 SimpleDateFormat 实例作为值。

[https://github.com/skanagavelu/yt.tech/blob/master/src/ThreadLocalTest.java](https://github.com/skanagavelu/yt.tech/blob/master/src/ThreadLocalTest.java)

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2016-04-27T03:10:49.330

什么时候？

当一个对象不是线程安全的，而不是妨碍可伸缩性的同步，给每个线程一个对象并保持它的线程范围，即 ThreadLocal。最常用但不是线程安全的对象之一是数据库 Connection 和 JMSConnection。

如何 ？

一个例子是 Spring 框架通过将这些连接对象保存在 ThreadLocal 变量中，大量使用 ThreadLocal 来管理幕后事务。在高层次上，当事务启动时，它会获得连接（并禁用自动提交）并将其保存在 ThreadLocal 中。在进一步的数据库调用中，它使用相同的连接与数据库通信。最后，它从 ThreadLocal 获取连接并提交（或回滚）事务并释放连接。

我认为 log4j 也使用 ThreadLocal 来维护 MDC。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2017-09-16T11:28:11.223

`ThreadLocal`当你想要一些不应该在不同线程之间共享的状态时很有用，但它应该在每个线程的整个生命周期内都可以访问。

例如，想象一个 Web 应用程序，其中每个请求都由不同的线程提供服务。想象一下，对于每个请求，您需要多次获取一条数据，这计算起来非常昂贵。但是，对于每个传入请求，该数据可能已更改，这意味着您不能使用普通缓存。这个问题的一个简单、快速的解决方案是让一个`ThreadLocal`变量持有对这些数据的访问权限，这样您只需为每个请求计算一次。当然，这个问题也可以不使用 来解决`ThreadLocal`，但我设计它是为了说明的目的。

也就是说，请记住`ThreadLocal`s 本质上是一种全局状态。因此，它具有许多其他含义，只有在考虑了所有其他可能的解决方案后才能使用。

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2018-10-07T07:00:37.710

**在多线程代码中使用像 SimpleDateFormat 这样的类助手**有 3 种情况，最好的一种是使用**ThreadLocal**

场景

**1-通过****锁定或同步**机制使用like **share object**，这使应用程序**变慢**

 ******线程池场景**

**2-**在方法中用作**本地对象**

在线程池中，在这种情况下，如果我们有**4 个线程**，每个线程有**1000 个任务**时间，那么我们创建了
**4000 个**SimpleDateFormat**对象**并等待 GC 擦除它们

**3-**使用***ThreadLocal***

在线程池中，如果我们有 4 个线程，我们给**每个线程一个 SimpleDateFormat 实例**
，所以我们有**4 个线程**，**4**个 SimpleDateFormat 对象。

不需要锁机制和对象的创建和销毁。（良好的时间复杂度和空间复杂度）

[https://www.youtube.com/watch?v=sjMe9aecW_A](https://www.youtube.com/watch?v=sjMe9aecW_A)

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2009-05-04T13:10:24.867

正如@unknown（google）所提到的，它的用途是定义一个全局变量，其中引用的值在每个线程中都是唯一的。它的用法通常需要存储某种与当前执行线程相关联的上下文信息。

我们在 Java EE 环境中使用它来将用户身份传递给不支持 Java EE 的类（无权访问 HttpSession 或 EJB SessionContext）。这样，将身份用于基于安全性的操作的代码可以从任何地方访问身份，而无需在每个方法调用中显式传递它。

大多数 Java EE 调用中的请求/响应操作循环使得这种类型的使用变得容易，因为它提供了明确定义的入口和出口点来设置和取消设置 ThreadLocal。

* * *

## 回答 #18

> 赞同：4
> 
> 时间：2013-01-31T01:37:35.887

这里没有什么新东西，但我今天发现`ThreadLocal`在 Web 应用程序中使用 Bean Validation 时非常有用。验证消息已本地化，但默认使用`Locale.getDefault()`. 您可以`Validator`使用不同`MessageInterpolator`的 配置 ，但无法指定`Locale`调用 的时间`validate`。因此，您可以创建一个静态`ThreadLocal<Locale>`（或者更好的是，一个包含您可能需要的其他东西的通用容器，`ThreadLocal`然后让您的自定义从中`MessageInterpolator`选择`Locale`。下一步是编写一个`ServletFilter`使用会话值或`request.getLocale()`选择语言环境并存储它在你的`ThreadLocal`参考。

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2017-11-29T21:49:51.167

线程局部变量通常用于防止在基于可变单例或全局变量的设计中共享。

它可以用于在不使用连接池时为每个线程建立单独的 JDBC 连接等场景。

```
private static ThreadLocal<Connection> connectionHolder
           = new ThreadLocal<Connection>() {
      public Connection initialValue() {
           return DriverManager.getConnection(DB_URL);
          }
     };

public static Connection getConnection() {
      return connectionHolder.get();
} 
```

当您调用 getConnection 时，它将返回与该线程关联的连接。您不想在线程之间共享的其他属性（如日期格式、事务上下文）也可以这样做。

您也可以使用局部变量，但这些资源通常会在创建过程中占用时间，因此您不想在使用它们执行某些业务逻辑时一次又一次地创建它们。但是，ThreadLocal 值存储在线程对象本身中，一旦线程被垃圾回收，这些值也会消失。

这个[链接](https://howtodoinjava.com/core-java/multi-threading/when-and-how-to-use-thread-local-variables/)很好地解释了 ThreadLocal 的使用。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2015-06-15T17:19:01.393

缓存，有时您必须多次计算相同的值，因此通过将最后一组输入存储到方法和结果中，您可以加快代码速度。通过使用线程本地存储，您不必考虑锁定。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2017-05-30T10:24:26.727

ThreadLocal 是 JVM 专门提供的功能，仅为线程提供隔离的存储空间。就像实例范围变量的值一样，只绑定到类的给定实例。每个对象都有其唯一的值，它们无法看到彼此的值。ThreadLocal 变量的概念也是如此，就对象实例而言，它们对于线程来说是本地的，除了创建它的线程之外，其他线程看不到它。[看这里](https://itexpertsconsultant.wordpress.com/2017/05/29/threadlocal-example-with-java-8/)

```
import java.util.concurrent.atomic.AtomicInteger;
import java.util.stream.IntStream;

public class ThreadId {
private static final AtomicInteger nextId = new AtomicInteger(1000);

// Thread local variable containing each thread's ID
private static final ThreadLocal<Integer> threadId = ThreadLocal.withInitial(() -> nextId.getAndIncrement());

// Returns the current thread's unique ID, assigning it if necessary
public static int get() {
    return threadId.get();
}

public static void main(String[] args) {

    new Thread(() -> IntStream.range(1, 3).forEach(i -> {
        System.out.println(Thread.currentThread().getName() + " >> " + new ThreadId().get());
    })).start();

    new Thread(() -> IntStream.range(1, 3).forEach(i -> {
        System.out.println(Thread.currentThread().getName() + " >> " + new ThreadId().get());
    })).start();

    new Thread(() -> IntStream.range(1, 3).forEach(i -> {
        System.out.println(Thread.currentThread().getName() + " >> " + new ThreadId().get());
    })).start();

}
} 
```

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2018-06-04T13:18:08.630

Java 中的**ThreadLocal**类使您能够创建只能由同一线程读取和写入的变量。因此，即使两个线程正在执行相同的代码，并且代码引用了一个 ThreadLocal 变量，那么这两个线程也无法看到彼此的 ThreadLocal 变量。

[阅读更多](http://tutorials.jenkov.com/java-concurrency/threadlocal.html)

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2018-11-05T14:31:01.240

[供参考]ThreadLocal不能解决共享对象的更新问题。建议使用一个 staticThreadLocal 对象，该对象由同一线程中的所有操作共享。【强制】remove() 方法必须由 ThreadLocal 变量实现，特别是在使用线程池时，线程经常被重用。否则可能会影响后续业务逻辑，导致内存泄漏等意外问题。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2017-12-12T03:00:41.830

Threadlocal 提供了一种非常简单的方法来以零成本实现对象的可重用性。

我有一个情况，多个线程在每个更新通知上创建一个可变缓存的图像。

我在每个线程上使用了 Threadlocal，然后每个线程只需要重置旧图像，然后在每次更新通知时从缓存中再次更新它。

来自对象池的通常可重用对象具有与之相关的线程安全成本，而这种方法没有。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2020-02-15T21:13:27.180

**试试这个小例子，感受一下 ThreadLocal 变量：**

```
public class Book implements Runnable {
    private static final ThreadLocal<List<String>> WORDS = ThreadLocal.withInitial(ArrayList::new);

    private final String bookName; // It is also the thread's name
    private final List<String> words;

    public Book(String bookName, List<String> words) {
        this.bookName = bookName;
        this.words = Collections.unmodifiableList(words);
    }

    public void run() {
        WORDS.get().addAll(words);
        System.out.printf("Result %s: '%s'.%n", bookName, String.join(", ", WORDS.get()));
    }

    public static void main(String[] args) {
        Thread t1 = new Thread(new Book("BookA", Arrays.asList("wordA1", "wordA2", "wordA3")));
        Thread t2 = new Thread(new Book("BookB", Arrays.asList("wordB1", "wordB2")));
        t1.start();
        t2.start();
    }
} 
```

**控制台输出，如果线程 BookA 先完成：**
结果 BookA：'wordA1，wordA2，wordA3'。
结果 BookB：'wordB1，wordB2'。

**控制台输出，如果线程 BookB 先完成：**
结果 BookB：'wordB1，wordB2'。
结果BookA：'wordA1，wordA2，wordA3'。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-07-28T05:00:54.713

**第一个用例**- 提供线程安全和性能的每个线程上下文 SpringFramework 类中的实时示例 -

*   LocaleContextHolder
*   事务上下文持有者
*   请求上下文持有者
*   日期时间上下文持有者

**第二个用例**- 当我们不想在线程之间共享某些东西并且同时由于性能成本而不想使用同步/锁定时 - SimpleDateFormat 为日期创建自定义格式

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

/**
 * @author - GreenLearner(https://www.youtube.com/c/greenlearner)
 */
public class ThreadLocalDemo1 {
    SimpleDateFormat sdf = new SimpleDateFormat("dd-mm-yyyy");//not thread safe
    ThreadLocal<SimpleDateFormat> tdl1 = ThreadLocal.withInitial(() -> new SimpleDateFormat("yyyy-dd-mm"));

    public static void main(String[] args) {
        ThreadLocalDemo1 d1 = new ThreadLocalDemo1();

        ExecutorService es = Executors.newFixedThreadPool(10);

        for(int i=0; i<100; i++) {
            es.submit(() -> System.out.println(d1.getDate(new Date())));
        }
        es.shutdown();
    }

    String getDate(Date date){

//        String s = tsdf.get().format(date);
        String s1 = tdl1.get().format(date);
        return s1;
    }
} 
```

**使用技巧**

*   尽可能使用局部变量。这样我们就可以避免使用 ThreadLocal
*   尽可能将功能委托给框架
*   **如果使用 ThreadLocal 并将状态设置为它，请确保在使用后对其进行清理，否则它可能成为OutOfMemoryError**的主要原因

 **# java - Why do we need constructors and private members in the abstract class?

> ID：817858
> 
> 赞同：2
> 
> 时间：2009-05-03T20:00:21.647
> 
> 标签：java, abstract-class

Why do we need constructors and private members in the abstract class? It is not like we are ever going to create an instance of that class.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-03T20:05:17.967

You *will* create instances, just instances of a derived class. Those derived classes will still need to call constructors, and can still call members of the abstract class - which may in turn use private members.

Here's an example (not a terribly useful one, but just to show the basic idea...)

```
public abstract class NamedObject
{
    private final String name = name;

    protected NamedObject(String name)
    {
        this.name = name;
    }

    public String getName()
    {
        return name;
    }
}

public class Computer extends NamedObject
{
    private final int processorSpeed;

    public Computer(String name, int processorSpeed)
    {
        super(name); // See, the constructor is useful
        this.processorSpeed = processorSpeed;
    }

    public String toString()
    {
        return getName() + " (" + processorSpeed + ")";
    }
} 
```

I can't say I write abstract classes *that* often, generally preferring composition to inheritance, but when I *do* create them I certainly use constructors and private members.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T20:07:32.440

Abstract classes provide a partial implementation of some interface. It's perfectly reasonable to consider that you might want to provide part of that implementation and disallow client code (concrete subclasses) from accessing the specifics - i.e. an extension of the principle of encapsulation.

Marking some members as private forces the inheriting class to call protected methods to access that partial implementation; providing a constructor allows for subclasses to initialise the parent's encapsulated state during their own construction.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T20:08:13.077

Unlike an interface, an abstract class that defines data fields is in fact instantiated in the sense that these data fields are allocated. It is just that they are never instantiated on their own, they are instantiated as part of something bigger - the subclass. So when the subclass is built, the supertype is built as well, which is why you would need a constructor.

Depending on your hierarchy, your abstract class may have a meaning and state. For example, if your application is a school you may have the notion of a person (that has a name and an SSN), but you would have different subtypes for students and for faculty. Because both types of people share certain state structure (name and SSN) you would have both classes extend the Person class. But you would never simply instantiate a person directly.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T05:56:01.103

假设您正在做临时代码或原型设计，您会不时实例化抽象类（甚至可能是接口）。它们被称为匿名内部类（[一](http://www.javaworld.com/javaworld/javaqa/2000-03/02-qa-innerclass.html)、[二](http://www.exciton.cs.rice.edu/javaresources/Java/innerclasses.htm)），如下所示：

```
// you have this...
public abstract class SomeClass {
    public abstract String returnAString();
}

// ...and this...
public class OtherClass {
    public void operate(SomeClass c) {
        System.out.println(c.returnAString());
    }
}

// ...so you do this:    
OtherClass oc = new OtherClass();
// this is one of the reasons why you need to specify a constructor
oc.operate(new SomeClass() {
    @Override
    public String returnAString() {
        return "I'm an anonymous inner class!";
    }
}); 
```

这个例子当然是多余的，但应该暴露这一点。一些现有的框架甚至依赖于这种行为的大量使用，至少是[Apache Wicket 。](http://wicket.apache.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T20:29:25.490

除了乔恩的回答，我想提一下，如果您保持子类树的浅层，抽象类仍然可以很好地组合。即它非常适合为一些密切相关的对象提供公共基类，但不适用于创建巨大的子类树。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T21:07:42.577

为什么需要私教？我认为您将抽象类与接口混淆了。与接口不同，抽象类可以保存功能。例如：

```
public class AbstractBase{
    private int num;

    public AbstractBase(int number){
       this->num = number;
    }

    public int method(){
       return ( this->num * this->templateMethod());
    }

    public abstract int templateMethod();
 } 
```

公共类 ConcreteDerived 扩展 AbstractBase{

```
public ConcreteDerived(){
  super(4);
}

public int templateMethod(){
   return number; //number is the result of some calculation
} 
```

}

在此示例中，您永远不会显式实例化 AbstractBase，但通过声明成员和构造函数，您可以自定义类的功能（这称为模板方法）。

# amazon-s3 - S3: Duplicate buckets

> ID：817859
> 
> 赞同：7
> 
> 时间：2009-05-03T20:00:50.303
> 
> 标签：amazon-s3, amazon

What is the easiest way to duplicate an entire Amazon S3 bucket to a bucket in a different account? Ideally, we'd like to duplicate the bucket nightly to a different account in Amazon's European data center for backup purposes.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T20:57:17.810

要考虑的一件事是，您可能希望在 Amazon EC2 虚拟机中运行任何执行此操作的程序。如果您的备份在 Amazon 的云之外运行，那么您需要为双向数据传输付费。如果您在 EC2 虚拟机中运行，则无需支付带宽费用（尽管我不确定在北美和欧洲商店之间移动时这是否属实） - 仅适用于 EC2 实例运行的时间（以及任何它存储 EC2 虚拟机的成本，我认为应该是最低的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T20:11:38.530

I suspect there is no "automatic" way to do this. You'll just have to write a simple app that moves the files over. Depending on how you track the files in S3 you could move just the "changes" as well.

On a related note, I'm pretty sure Amazon does a darn good job backup up the data so I don't think you necessarily need to worry about data loss, unless your back up for archival purposes, or you want to safeguard against accidentally deleting files.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-21T10:14:44.227

您可以创建一个应用程序或服务，负责为`AmazonS3Client`源创建两个实例，另一个为目标创建另一个实例，然后源`AmazonS3Client`开始在源存储桶中循环并流式传输对象，而目标`AmazonS3Client`将它们流式传输到目标存储桶。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-06T00:27:37.307

酷，我可能会考虑编写一个脚本来托管在 Ec2 上。备份的主要目的是防止我们这边的人为错误——如果用户不小心删除了存储桶或类似的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-19T14:59:46.893

如果您担心删除，您可能应该查看 S3 的新[版本控制](http://docs.amazonwebservices.com/AmazonS3/latest/dev/index.html?Versioning.html)功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-09-08T19:40:57.583

*注意：这不适用于跨帐户同步，但适用于同一帐户的跨区域。*

为了简单地将所有内容从一个存储桶复制到另一个存储桶，您可以使用 AWS CLI ( [https://aws.amazon.com/premiumsupport/knowledge-center/move-objects-s3-bucket/](https://aws.amazon.com/premiumsupport/knowledge-center/move-objects-s3-bucket/) )：`aws s3 sync s3://SOURCE_BUCKET_NAME s3://NEW_BUCKET_NAME`

在您的情况下，您需要以下`--source-region`标志：[https ://docs.aws.amazon.com/cli/latest/reference/s3/sync.html](https://docs.aws.amazon.com/cli/latest/reference/s3/sync.html)

如果您要移动大量数据，您可以通过寻找将传输分成不同组的方法来优化传输速度：[https ://aws.amazon.com/premiumsupport/knowledge-center/s3-large-transfer-桶间/](https://aws.amazon.com/premiumsupport/knowledge-center/s3-large-transfer-between-buckets/)

有多种方法可以每晚运行。一个例子是 AWS 实例调度（个人未经验证）[https://docs.aws.amazon.com/solutions/latest/instance-scheduler/appendix-a.html](https://docs.aws.amazon.com/solutions/latest/instance-scheduler/appendix-a.html)

# jquery - 仅在 Y 轴上更改 CSS 背景位置

> ID：817866
> 
> 赞同：13
> 
> 时间：2009-05-03T20:06:32.050
> 
> 标签：jquery, css, background

好的......所以这就是问题所在。

我有一个 CSS sprite 图像，由十（10）个 25px x 25px 图标组成，水平放置 - 因此产生了一个 250px 宽度的 sprite 图像。

我使用这些 25x25 图像作为缩略图。我希望在初始视图中这些图像的不透明度为 30%，当用户将鼠标悬停在它们上方时，不透明度需要为 100% (1)。

所以我所做的是创建第二行不透明度为 30% 的图像 - 所以现在我有一个 250 像素 x 50 像素的精灵图像。顶部 25px 为 100%，底部 25px 为 30%。

我设置 HTML 如下：

```
<a href="largeimage1.jpg" class="thumb1"></a>
<a href="largeimage2.jpg" class="thumb1"></a>
<a href="largeimage2.jpg" class="thumb1"></a>
etc... 
```

和CSS：

```
a { display: block; float: left; width: 25px; height: 25px; background: url("250_x_50_spriteimage.jpg") 0 -25px no-repeat; }
.thumb1 { background-position: 0 0; }
.thumb2 { background-position: -25px 0; }
.thumb3 { background-position: -50px 0; }
a:hover { **background-position-y**: -25px; } 
```

但是，不幸的是，这似乎不起作用，因为 Firefox 不支持 background-position-y （或者不是标准，而是特定于 IE）。

这个想法是我们（仅）想要将精灵图像向上移动（沿 y 轴）并保持 x 轴不变（或在之前的类中设置）。

如果没有简单的 CSS 解决方案 - 这种不透明效果可以用 JQUERY 完成吗？所以拇指会以 30% 的不透明度加载，当用户悬停时会过渡到 100% 的不透明度？

非常感谢，

M。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-20T11:16:28.020

您不需要第二个图标集，也不需要使用 JavaScript 来达到预期的效果。

正如 Lou 指出的那样，使用`opacity`30% 或完全可见的图标。没必要再纠缠`background-position`了。

继续并根据以下内容定义您的样式：

```
a {
    opacity:0.3;  /* for standard browsers */
    filter: alpha(opacity = 30);  /* for IE */

    display: block;
    float: left;
    width: 25px;
    height: 25px;
    background: url("250_x_50_spriteimage.jpg") 0 -25px no-repeat;
}

a:hover {
    opacity:1.0
    filter: alpha(opacity = 100);
}

.thumb1 { background-position: 0 0; }
.thumb2 { background-position: -25px 0; }
.thumb3 { background-position: -50px 0; } 
```

如果您担心 CSS 代码的验证，请获取特定于 IE 的部分（不会验证）并通过[条件注释](http://www.quirksmode.org/css/condcom.html)将它们放入特定目标的 CSS 文件中。

希望有帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-04T01:36:26.080

我相信 Lou 的答案可以满足您的要求——您只需为每个状态定义一个类并设置 x 和 y 坐标。

如果你想要渐变的效果，那么[jQuery 为你提供了一种方法来实现它](http://docs.jquery.com/Effects/fadeTo#speedopacitycallback)。如果是这种情况，这可能会让你得到你想要的：

```
$(".thumb").css("opacity", 0.33);
$(".thumb").hover(
    function() {
        $(this).fadeTo(300, 1.0);
    },
    function() {
        $(this).fadeTo(1, 0.33);
    }
); 
```

**编辑**：根据反馈更新。现在设置了初始不透明度。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-12-03T11:32:12.697

简单的方法

```
{background-position:100% 4px;} 
```

您可以使用带有像素的父级来替换 background-position-y 属性

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T20:58:48.603

[注意：为了在 Mozilla 中工作，必须将 background-attachment 属性设置为“fixed”。](http://www.w3schools.com/css/pr_background-position.asp)

这有关系吗？

--

您只有 10 张图片，只需为每张图片定义一个 CSS 类。这样您就可以指定相对 x 坐标。

附言。我希望您没有使用确切的 css，将该样式应用于 a:hover 将应用于页面上的所有链接。您应该仅将其应用于图像样式。

```
a { display: block;
    float: left;
    width: 25px;
    height: 25px; 
    background: url("test.jpg") 0 -25px no-repeat;
  }
.thumb1 { background-position: 0 0; }
.thumb2 { background-position: -25px 0; }
.thumb3 { background-position: -50px 0; }
.thumb1:hover { background-position: 0 -25px; }
.thumb2:hover { background-position: -25px -25px; }
.thumb3:hover { background-position: -50px -25px; } 
```

还有[不透明..](http://www.mandarindesign.com/opacity.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-19T18:45:05.023

前面例子中的一些小疏漏、错别字和不必要的代码。猜猜你的代码可能看起来像这样：

```
<style>
a { float: left; width: 25px; height: 25px; background-image: url("250_x_50_spriteimage.jpg"); }
a.thumb1 { background-position: 0 0; }
a.thumb2 { background-position: -25px 0; }
a.thumb3 { background-position: -50px 0; }
a { filter: alpha(opacity=30); -moz-opacity:.3; opacity:.3; }
a:hover { filter: alpha(opacity=100); -moz-opacity:1.0; opacity:1.0; }
</style>

<a href="largeimage1.jpg" class="thumb1"></a>
<a href="largeimage2.jpg" class="thumb2"></a>
<a href="largeimage2.jpg" class="thumb3"></a> 
```

# doxygen - Lingo Filter for Doxygen?

> ID：817869
> 
> 赞同：0
> 
> 时间：2009-05-03T20:06:49.943
> 
> 标签：doxygen, lingo

Does anyone know of or have a Lingo filter for Doxygen?

I have played with DocMaker, but it introduces dependencies on director and is not a flexible or full featured as Doxygen.

-Marty

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T20:30:44.007

根据[http://www.doxygen.nl](http://www.doxygen.nl/ "doxygen 官方网站")，doxygen 可用于：

*   C++
*   C
*   爪哇
*   Objective-C
*   Python
*   IDL (科尔巴)
*   IDL（微软）
*   Fortran
*   高密度脂蛋白
*   PHP
*   C＃
*   D（部分支持）

抱歉，Lingo 似乎不受支持。

# azure - 天蓝色存储帐户

> ID：817871
> 
> 赞同：1
> 
> 时间：2009-05-03T20:07:32.033
> 
> 标签：azure, azure-storage-account

我正在尝试在 Azure 上部署应用程序，但遇到了一些问题。

在我的开发箱上，一切正常，但是当我在部署应用程序后尝试使用它时遇到问题。

在开发箱上，我有一个手动执行的操作，即在我的本地 sql server express 中创建测试表。

但我不知道如何在服务器上创建表？所以当我运行我的网站应用程序时，它会显示 TableNotFound。

sy 能指导我完成这最后一步吗？我需要额外增加 sg 吗？

提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T20:09:08.050

表存储客户端提供了在云存储中创建模式的方法；我忘记了名字（稍后会查找）；当您初始化用作数据服务层的任何内容时调用它。

**编辑：**以下片段是我使用的：

```
StorageAccountInfo = StorageAccountInfo.GetDefaultTableStorageAccountFromConfiguration();
TableStorage.CreateTablesFromModel( typeof( <Context> ), info ); 
```

`<Context>`您的数据上下文对象在哪里。

# c# - C#：使用字节数组创建位图

> ID：817874
> 
> 赞同：2
> 
> 时间：2009-05-03T20:08:14.777
> 
> 标签：c#, .net, image

我正在尝试使用以下代码使用字节数组动态创建位图图像

```
Bitmap GetImage()
{
    IntPtr  ip = Marshal.AllocCoTaskMem(imagesize);

    //some code to fill ip

    Image img =  new Bitmap(
                    w,
                    h,
                    -stride,
                    PixelFormat.Format24bppRgb,
                    (IntPtr)(ip.ToInt32() + imagesize - stride)
                    );

    Marshal.FreeCoTaskMem( ip); // Comment this line to work

    return img;
}

void SaveImage()
{
    Image img =  GetImage();
    img.save("test.bmp"); // This call fails
    img.Dispose();
} 
```

现在我的问题是我想返回一个位图，但同时我不想保留 ip 指针，因为分配的内存泄漏。它永远不会被释放。如何返回使用字节数组创建的图像，而无需打扰函数 GetImage() 的调用者以释放内存。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T20:16:17.847

最简单的方法可能是创建位图（尽管在[类似的代码](http://www.yoda.arachsys.com/csharp/blogfiles/Mandelbrot.cs)中，我使用了一个普通的`byte[]`然后一个`fixed`块，而不是直接使用`AllocCoTaskMem`），然后创建一个相同大小的*第二个。* `Bitmap`调用`Graphics.FromImage`第二个位图，然后`Graphics.DrawImage`使用第*一个*位图有效地将第一个位图的内容复制到第二个。然后，您可以调用`Dispose`第一个位图，释放内存，并使用基本上是副本的第二个位图。

如果您更精通图像内容，可能会有一种更有效的方法，但如果您只是在寻找一种使其工作的方法，那么这是一个起点:)

编辑： zachrrs 的评论确实使用[Bitmap(Image)](http://msdn.microsoft.com/en-us/library/ts25csc8.aspx)构造函数使事情变得更容易：

```
using (Bitmap original = new Bitmap(...))
{
    Bitmap copy = new Bitmap(originalImage);
    // Then return "copy" from your method, and you can free the
    // memory
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T20:51:16.610

如果事先知道尺寸，为什么不创建位图并使用[Bitmap.LockBits](http://msdn.microsoft.com/en-us/library/039882h3.aspx)方法获取输入缓冲区地址？

# asp.net - sending email into sql server 2008

> ID：817877
> 
> 赞同：1
> 
> 时间：2009-05-03T20:09:24.713
> 
> 标签：asp.net, sql-server-2008, email

What are some strategies for programatically setting up an email interface between a pop3 mailbox and an sql server database ?

I'd like to be able to setup an account, say "sqldb@mydomain.com", and any email sent to that email address I'd like to senders email address, the subject and the body of the message inserted into a table (for simplicity let say the table is called 'email' and has just those three columns).

What are some of the available options to accomplish this?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T21:58:09.163

我建议编写一个定期轮询电子邮件箱的 Windows 服务。我找到了这个阅读 POP3 电子邮件的例子：

[http://anuraj.wordpress.com/2009/03/02/reading-pop3-mailbox-using-vbnet/](http://anuraj.wordpress.com/2009/03/02/reading-pop3-mailbox-using-vbnet/)

还有这个：

[http://www.developerfusion.com/article/4071/how-to-pop3-in-c/2/](http://www.developerfusion.com/article/4071/how-to-pop3-in-c/2/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T20:17:33.133

You could use a .NET component like:

[http://www.rebex.net/mail.net/](http://www.rebex.net/mail.net/)

Then have a scheduled task kick off a process that checks the inbox every X minutes, reads the new e-mails, then writes them to the DB.

# python - python中的唯一会话ID

> ID：817882
> 
> 赞同：46
> 
> 时间：2009-05-03T20:11:02.947
> 
> 标签：python, session

如何在 Python 中生成唯一的会话 ID？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2011-05-23T03:07:22.843

**更新：2016-12-21**

在过去的 5 年里发生了很多事情。 `/dev/urandom`已经更新，现在被认为是现代 Linux 内核和发行版上的高熵随机源。在过去的 6mo 中，我们看到了使用 Ubuntu 的 Linux 3.19 内核上的熵饥饿，所以我认为这个问题还没有“解决”，但是当要求任何数量的随机性时，最终得到低熵随机性已经足够困难了从操作系统。

* * *

我不想这么说，但这里发布的其他解决方案都不是正确的“安全会话 ID”。

```
# pip install M2Crypto
import base64, M2Crypto
def generate_session_id(num_bytes = 16):
    return base64.b64encode(M2Crypto.m2.rand_bytes(num_bytes)) 
```

既不是`uuid()`也不`os.urandom()`是生成会话 ID 的好选择。两者都可能产生**随机**结果，但随机并不意味着它是**安全的，因为****熵**很差。请参阅 Haldir 的“ [How to Crack a Linear Congruential Generator](http://www.reteam.org/papers/e59.pdf) ”或[NIST 关于随机数生成的资源](http://csrc.nist.gov/groups/ST/toolkit/rng/index.html)。如果您仍想使用 UUID，请使用使用良好初始随机数生成的 UUID：

```
import uuid, M2Crypto
uuid.UUID(bytes = M2Crypto.m2.rand_bytes(num_bytes)))
# UUID('5e85edc4-7078-d214-e773-f8caae16fe6c') 
```

或者：

```
# pip install pyOpenSSL
import uuid, OpenSSL
uuid.UUID(bytes = OpenSSL.rand.bytes(16))
# UUID('c9bf635f-b0cc-d278-a2c5-01eaae654461') 
```

M2Crypto 是 Python atm 中最好的 OpenSSL API，因为维护 pyOpenSSL 似乎只是为了支持遗留应用程序。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-03T20:14:37.507

您可以像这样使用[uuid 库](http://docs.python.org/library/uuid.html)：

```
导入 uuid
my_id = uuid.uuid1() # 或 uuid.uuid4()

```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2019-04-13T02:11:50.563

Python 3.6 使这里的大多数其他答案都有些过时了。包括 3.6 及更高版本在内的版本包括`secrets`专门为此目的而设计的模块。

如果您需要为 Web 上的任何目的生成加密安全字符串，请参阅该模块。

[https://docs.python.org/3/library/secrets.html](https://docs.python.org/3/library/secrets.html)

例子：

```
import secrets

def make_token():
    """
    Creates a cryptographically-secure, URL-safe string
    """
    return secrets.token_urlsafe(16) 
```

正在使用：

```
>>> make_token()
'B31YOaQpb8Hxnxv1DXG6nA' 
```

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2009-05-03T21:19:46.243

```
import os, base64
def generate_session():
    return base64.b64encode(os.urandom(16)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T20:32:03.970

它可以像创建一个随机数一样简单。当然，您必须将会话 ID 存储在数据库或其他东西中，并检查您生成的每个 ID 以确保它不是重复的，但如果数字足够大，很有可能永远不会。

# python - 使用预定义的键创建字典

> ID：817884
> 
> 赞同：4
> 
> 时间：2009-05-03T20:12:18.467
> 
> 标签：python, dictionary

在python中，有没有办法创建一个像字典一样对待但在创建新实例时预定义键的类？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-03T22:00:11.077

您还可以让 dict 子类通过覆盖将键限制为预定义列表`__setitem__()`

```
>>> class LimitedDict(dict):
    _keys = "a b c".split()
    def __init__(self, valtype=int):
        for key in LimitedDict._keys:
            self[key] = valtype()
    def __setitem__(self, key, val):
        if key not in LimitedDict._keys:
            raise KeyError
        dict.__setitem__(self, key, val)

>>> limited = LimitedDict()
>>> limited['a']
0
>>> limited['a'] = 3
>>> limited['a']
3
>>> limited['z'] = 0

Traceback (most recent call last):
  File "<pyshell#61>", line 1, in <module>
    limited['z'] = 0
  File "<pyshell#56>", line 8, in __setitem__
    raise KeyError
KeyError
>>> len(limited)
3 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-03T20:14:56.290

您可以轻松扩展任何内置类型。这就是你用 dict 做的方式：

```
>>> class MyClass(dict):
...     def __init__(self, *args, **kwargs):
...             self['mykey'] = 'myvalue'
...             self['mykey2'] = 'myvalue2'
...
>>> x = MyClass()
>>> x['mykey']
'myvalue'
>>> x
{'mykey2': 'myvalue2', 'mykey': 'myvalue'} 
```

我无法找到有关此问题的 Python 文档，但非常流行的书[Dive Into Python](http://diveintopython.net/index.html)（可在线免费获得）[提供了一些](http://diveintopython.net/object_oriented_framework/userdict.html)有关此操作的示例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-03T21:13:03.047

是的，在 Python`dict`中是一个类，所以你可以对它进行子类化：

```
 class SubDict(dict):
        def __init__(self):
            dict.__init__(self)
            self.update({
                'foo': 'bar',
                'baz': 'spam',}) 
```

在这里，您覆盖 dict 的`__init__()`方法（创建类的实例时调用的方法）。在里面`__init__`你首先调用 supercalss 的`__init__()`方法，当你想扩展基类的功能时，这是一种常见的做法。`SubDictionary`然后你用你的初始数据更新新的实例。

```
 subDict = SubDict()
    print subDict    # prints {'foo': 'bar', 'baz': 'spam'} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-04T06:44:26.993

我不确定这是否是您要找的，但是当我阅读您的帖子时，我立即认为您正在寻找动态生成用于计数练习的键。

与 perl 不同，默认情况下它会为您执行此操作，

```
 grep{$_{$_}++} qw/ a a b c c c /;
print map{$_."\t".$_{$_}."\n"} sort {$_{$b}$_{$a}} keys %_;

c   3
a   2
b   1 
```

Python不会免费给你这个：

```
 l = ["a","a","b","c","c","c"]
d = {}
for item in l:
    d[item] += 1

Traceback (most recent call last):
  File "./y.py", line 6, in 
    d[item] += 1
KeyError: 'a' 
```

但是，defaultdict 会为您执行此操作，

```
 from collections import defaultdict
from operator import itemgetter

l = ["a","a","b","c","c","c"]
d = defaultdict(int)
for item in l:
    d[item] += 1

dl = sorted(d.items(),key=itemgetter(1), reverse=True)
for item in dl:
    print item

('c', 3)
('a', 2)
('b', 1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T20:17:28.563

只需创建 dict 的子类并在**init**方法中添加键。

```
类 MyClass(dict)

def __init__(self):
    """使用默认值创建一个新的字典""""

    自我['key1'] = 'value1'

```

但请记住，在 python 中，任何“像 dict 一样”的类通常都被视为一个类，所以你不必太担心它是一个子类，你可以实现 dict 方法，尽管上面的方法是可能对你更有用:)。

# javascript - Div not properly hiding in IE

> ID：817887
> 
> 赞同：0
> 
> 时间：2009-05-03T20:13:16.200
> 
> 标签：javascript, jquery, internet-explorer, html, hide

I've got few divs on my website - on the load I want some of them to be hidden, some shown. I am hiding the ones I don't want like this:

```
$(".divToHide").hide(); 
```

It works well in Chrome, Firefox, IE8 an Opera... It doesn't in IE6 (I haven't tested on previous version yet...) - when I load the page all the divs are hidden properly. When I click a link that makes one of them visible it appears correctly. The problems shows when I click on a different link that's supposed to hide the first div and show another. The text of the first div is hidden, but the image stays and obstructs the newly shown div. I'm pretty sure it's a bug - when I zoom in or out of the page the divs that were supposed to be hidden disappear suddenly - they're only visible when I load the page.

Is there a way around it?

**EDIT:** I'm using jQuery v1.3.2

**EDIT:** Unfortunately the solution of using `addClass` to add css class that states `display: none` doesn't really work - it seemed like it did at first, but the problem is still there.

**UPDATE:** The js file I wrote can be found [here](http://ankepohl.com/js/clickHandlers.js), while the html [here](http://ankepohl.com/index_trial.html). The problem I have is that when you go from one portfolio to the other, the image of the first one stays there obstructing the next, even though it should be hidden (text underneath changes correctly). Wrong disappears when you try to zoom in/out of the page.
I used to hide all portfolios using `$("#divId").hide()`, but as was pointed out below, I now use `$(".classToHide").hide()`.

**UPDATE:** The problem is solved on IE8 - I forgot to include the standards mode declaration... However, on IE6 it's still the problem.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-03T20:31:38.917

您正在使用 ID 选择器隐藏多个 div？

尝试给这些 div 类“divToHide”，然后使用：

```
$(".divToHide").hide(); 
```

也许 IE8 以不同于其他浏览器的方式处理重复的 id。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-03T20:14:24.810

Just a thought: you're not using an old (pre-IE8) version of jQuery, are you?

**Edit:** No, grycz is using the current version.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T20:26:18.993

**编辑：简化为使用 toggleClass()**

您可以尝试手动执行此操作，例如切换一个名为“隐藏”的 CSS 类。它可能看起来像这样：

```
function myToggle(element_id)
{
    mydiv = $('#' + element_id);
    mydiv.toggleClass("hidden");;
} 
```

您的 css 文件将具有：

```
.hidden
{
    display:none;
} 
```

我还没有对此进行测试，但这是我想你想要考虑的一种解决方法，如果这确实是 jQuery/IE8 中的一个错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T09:49:30.903

尝试

$("#divToHide").css('display:none');

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T20:21:28.803

Are you sure that hide() function call is even getting called on the page load? Try putting an `alert('hi')` right before that function call, and see if that happens in IE8\.

# security - How to resist MITM and replay attacks when sending encrypted data?

> ID：817905
> 
> 赞同：2
> 
> 时间：2009-05-03T20:18:08.670
> 
> 标签：security, encryption, cryptography, packet

Assuming I've securely exchanged keys with another computer (using Diffie-Hellman perhaps), here's my tentative solution:

> packet number + encrypted data + message authentication code (MAC)

The packet number is an incrementally-increased number starting at 0\. After that is the encrypted data itself, followed by a MAC of them both. If someone attempts a MITM attack, the MAC should fail to compute. If they attempt a replay attack, the recipient will notice it has already received that packet number.

Is there any flaw in my reasoning here?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T22:16:43.737

> Assuming I've securely exchanged keys with another computer (using Diffie-Hellman perhaps)

This is where you face the biggest danger - if the man-in-the-middle manages to control the key exchange (for example, by establishing one key with the client and itself, and establishing another key with server and itself), then the MITM can decrypt (and re-encrypt) everything. Once you've established the secure key exchange, you should be invulnerable to the MITM attack. But the hard part is ensuring that the key exchange is truly secure.

Consult [Practical Cryptography](http://www.schneier.com/book-practical.html) (or at [Amazon](https://rads.stackoverflow.com/amzn/click/com/0471223573)) by Ferguson and Schneier for information about this.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-11T02:42:56.643

一旦密钥被交换，数据就不能被第三方拦截或欺骗。（除非您的数据包＃计数器循环。假设来自旧窗口的数据包可能会被重播为来自新窗口。）这个问题的解决方案是时间戳（正如其他人提到的那样。）同样，如果攻击者能够以某种方式破坏系统时间。（如果他们是中间人，他们可以假设模仿一个 NTP 服务器并以此方式修改客户端的系统时间。）

然而，窃听者可以做的是将自己插入两方之间并破坏频道。这可能会导致发生可以观察到的新密钥交换。为了使密钥交换真正安全，您必须使用只有两个通信者知道的第 3 方验证或预共享密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-03T20:28:29.190

你不是在描述一个中间攻击的人，而是一个重放攻击。

通过 MITM 攻击，密钥交换被拦截，并且您说您已经安全地交换了密钥 - 所以这不是问题。

重放攻击很容易缓解，您包含一个唯一的消息 ID，然后在接收方检查它的唯一性。通常，每条消息都有一个到期日期和时间，因此您无需保留不断增长的消息 ID 列表来进行验证。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T20:43:20.950

您保护免受重放攻击的方法对我来说似乎是合理的。您本质上是在描述一种称为[timestamping](http://en.wikipedia.org/wiki/Replay_attack#Countermeasures)的方法。您的数据包编号是一个“虚拟时间”，收件人使用它来验证之前没有发送过消息。

# php - 实施“软”保存或修改工作流程的最佳方式是什么？

> ID：817906
> 
> 赞同：3
> 
> 时间：2009-05-03T20:18:11.477
> 
> 标签：php, mysql, database, database-design, design-patterns

我正在 LAMP 上开发一个基于 MVC 的 Web 应用程序，该应用程序需要一些记录才能在“高级”用户的批准下进行修改。（普通用户可以提交更改，但只有在此批准后才能应用）

只有一张表必须发生这种情况，比如“事件”：

事件 - id - 名称 VARCHAR - start_date DATETIME - 来宾 INTEGER

每次事件的属性之一被“普通”用户修改时，这些更改不会正式生效，直到该“超级”用户进行修订（和可能的批准）。

起初我认为以下选项：

*   复制除 id 之外的每一列，例如 name_temp 表示“名称”，以保存待批准的修改。
*   创建一个具有重复结构的单独表，并在其中保存所有待批准的修改。

你以前实施过这个吗？你认为最好的/你的方法是什么？还有：**这种问题有什么模式吗？**

谢谢！！！

PD：我需要将“旧”记录保留在原处，直到新记录获得批准。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T20:21:33.420

为什么不再添加 1 个名为 IsApproved 的列？bool 还是 tinyint(1) 类型？刚刚显示批准的事件？

**编辑**：哦，这是每个属性的批准。然后第二个表将是我选择的名为 PendingEventChanges 的具有相同结构或仅 id+可更改属性的表，并且在批准后，“超级”用户将更新原始数据并从待处理中删除 etries。

首选非常反对数据库规范化，因此将来添加更多属性会带来麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T20:29:16.863

如果它只是关于添加新事件的权限，我会使用一个额外的布尔列，即 is_approved 或类似的。

但是，可以进行编辑，因此，在我看来，复制同一个表中的每一列以存储临时值是一个很大的禁忌。想象一下当两个用户将他们的更改发布到同一个事件时会发生什么。

选项二，即单独的表，是一个更好的选择。您可以将每次尝试存储在那里，并相应地更新您的主表。

使用这种方法，甚至可以进行某种形式的回滚更改。只需确保为每个都存储一个时间戳，并且永远不要删除您批准的编辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T01:55:39.483

让我添加我对“第二个表”方法的投票 - 正如其他两位受访者所说，它比试图将“提议的更改”硬塞到主表中（这会使它的架构、每个查询等复杂化）更胜一筹， ETC）。

将所有预期的更改写入辅助表并稍后“分批”处理它们（如果它们满足某些条件，则将它们应用于主表）确实是一种常见模式，当您需要主表仅在特定时间更改时通常很有用，而提议的更改可以在任何时候出现，也可以在其他情况下进行，例如，当写入主表的成本非常高（锁争用或其他）但写入 N 个更改并不比写入一个更昂贵，或者验证提议的更改非常耗时- 消耗（您可以将您的用例归类为后一类的极端情况，因为在您的情况下，验证需要人工查看提议的更改——按照计算机标准来说确实非常慢；-)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T02:31:47.587

如果历史或版本控制很重要，再加上批准，我会选择一张桌子。您将添加一个修订号，它可以与您现有的主键一起使用，并且可以在每个修订版上递增。然后，您可以添加一个状态字段来显示当前版本、过期版本和需要批准的版本。状态和关键字段上的一个很好的索引将为您提供快速的结果。如果这只是众多字段中的一个、两个或三个字段，那么按照上面的建议，处理这些未经批准的编辑的特定表可能会更好。

# iphone - 将导航项添加到视图控制器

> ID：817918
> 
> 赞同：-1
> 
> 时间：2009-05-03T20:22:06.710
> 
> 标签：iphone, cocoa-touch

我有一个基于导航控制器的应用程序，并决定使用标签栏。在某些视图中，我不需要将导航控制器分配给视图控制器，但我仍然希望在视图的右上角有一个“添加”按钮。

实现此目的最简单的视图是什么？我试图在我的视图中添加一个导航项，但它似乎不可见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T21:19:33.810

我要做的是使视图 a`UINavigationViewController`以便您可以访问`navigationItem`，即使您没有将视图推送到堆栈上。

我不确定只有一个`UINavigationBar`并分配按钮的方法。

或者你可以试着弄乱 a`UIToolbar`看看你能不能把它调整到你满意的程度

# html - 为什么我的 HTML 包含不起作用？

> ID：817922
> 
> 赞同：2
> 
> 时间：2009-05-03T20:24:26.643
> 
> 标签：html, include

我现在正在制作一个网站，我想在每个页面中包含侧边栏。我到处看了，每个人都说要使用以下代码：

```
<!--#include virtual="insertthisfile.html" --> 
```

我已经这样做了，但无济于事。我使用dreamweaver 来更轻松地上传和管理我的文件，它显示在dreamweaver 中。我只会使用 PHP，但我不希望我的所有页面都是 PHP，只需要一个可以在 HTML 中工作的代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-03T20:26:02.690

这不是“HTML”功能。它是[服务器端包含](http://httpd.apache.org/docs/1.3/howto/ssi.html)。您需要确保您的服务器上的 SSI 处于活动状态，并且它已设置为应用于文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-03T20:25:42.740

*   确保（包括）文件具有`.shtml`扩展名
*   确保在 Web 服务器中启用了服务器端包含

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T20:30:49.153

[这个页面](http://www.boutell.com/newfaq/creating/include.html)有很多关于服务器和客户端的信息。它还显示了#include 的几个替代方案。

首先尝试将*.html*文件重命名为*.shtml*。此外，请确保在您的服务器上启用了服务器端包含。

# javascript - 从 HTML 区域获取关联的 img

> ID：817925
> 
> 赞同：0
> 
> 时间：2009-05-03T20:26:14.157
> 
> 标签：javascript, image, dom-events, area

有两个**img**元素在一个区域使用同**一张地图**。现在，我们将例如单击事件处理程序绑定到**区域**元素。是否可以从事件处理程序中确定单击了哪个图像实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-03T20:37:53.270

一个可能的解决方案是使用它的**offsetParent**属性。这样，我得到了父母，这是我最初需要的。**只要图像包含在不同的div**中，查找图像本身也不应该太难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T20:52:24.157

是的，您可以通过以下任一方式确定点击了哪个图像：

1.  在父元素上附加单个事件处理程序并检查 event.target 属性
2.  在每个图像元素上附加单独的事件处理程序。

例如，如果您的 HTML 如下所示：

```
<div id="container">
    <img id="myimage1" usemap="theMap" />
    <img id="myimage2" usemap="theMap" />
    <map name="theMap">
    ...
    </map>
</div> 
```

那么可能的解决方案是：

1)

```
document.getElementById('container').onclick = function(evt) {
    var target = evt.target || window.event.srcElement;

    switch(target.id) {

        case 'myimage1':
            alert('you clicked on myimage1');
            break;

        case 'myimage2':
            alert('you clicked on myimage2');
            break;

        default:
            // click handler got some other evet
    }
} 
```

2)

```
document.getElementById('myimage1').onclick = function() {
    alert('you clicked on myimage1');
}
document.getElementById('myimage2').onclick = function() {
    alert('you clicked on myimage2');
} 
```

根据您在捕获事件后要执行的操作，您必须返回“true”以允许 URL 继续执行，或返回“false”以采取替代操作。

# graph - 图分类法

> ID：817931
> 
> 赞同：1
> 
> 时间：2009-05-03T20:29:22.900
> 
> 标签：graph, naming, convention

知道一条边是由**初始**顶点和**最终**顶点定义的，你如何调用**来自**和**到**顶点的边？现在，我将它们命名为**传入**和**传出**。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-03T20:30:43.570

内边和外边。

# c - C中锁定的文件或目录

> ID：817945
> 
> 赞同：0
> 
> 时间：2009-05-03T20:36:14.883
> 
> 标签：c, linux

我有一个守护进程，它监视某个文件的更改，然后处理对文件所做的更改。

但现在我注意到，当我尝试读取文件（使用 fgets）时，我没有得到任何数据。这只发生在对文件进行更改之后，但如果我尝试在其他任何时间读取文件，我可以很好地读取它。

我认为当我尝试读取文件时，另一个进程将文件锁定。如何确定文件是否被锁定？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-03T20:41:33.810

当 fgets() 为 EOF 返回 NULL 时，它设置了一个条件，您需要使用 clearerr() 清除，尽管存在其他数据。（Linux 上唯一常见的文件锁定类型是建议性的，所以这很可能不是您的问题。inotify 可能是检测文件更改的更好解决方案。http: [//en.wikipedia.org/wiki/Inotify](http://en.wikipedia.org/wiki/Inotify)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T21:38:53.483

尝试用 ferror() 检查错误，是的——正如 Dave 指出的，你应该在 fgets 之前调用 clearerr() 来检查它

# design-patterns - OCaml 中的访问者设计模式

> ID：817949
> 
> 赞同：4
> 
> 时间：2009-05-03T20:40:24.140
> 
> 标签：design-patterns, ocaml, visitor-pattern

我正在尝试使用 OCaml 的 OO 构造和类型系统来实现访问者设计模式，并且在实例化元素时遇到了问题。

```
class virtual ['hrRep] employee = object 
 method virtual receiveEvaluation : 'hrRep -> unit
 method virtual getName : string
end;;

class ['hrRep] accountant myName = object (self : 'a)
 inherit ['hrRep]employee
 val name = myName
 method receiveEvaluation rep = rep#visitAccountant self
 method getName = name
end;;

class ['hrRep] salesman myName = object (self : 'a)
 inherit ['hrRep]employee
 val name = myName
 method receiveEvaluation rep = rep#visitSalesman self
 method getName = name
end;;

class virtual ['accountant, 'salesman] hrRep = object (self)
 method virtual visitSalesman : 'salesman -> unit
 method virtual visitAccountant : 'accountant -> unit
end;;

class ['employee, 'salesman] lowerLevelHRRep = 
      object (self) inherit ['employee, 'salesman]hrRep
 method visitSalesman s = print_endline ("Visiting salesman "^s#getName)
 method visitAccountant a = 
       print_endline ("Visiting accountant "^a#getName)
end;;

let s1 : (<visitSalesman : 'a -> unit>) salesman = new salesman "Bob";;
let a1 : (<visitAccountant : 'a -> unit>) accountant = new accountant "Mary";;
let s2 : (<visitSalesman : 'a -> unit>) salesman = new salesman "Sue";;
let h1 : (<getName : string>, <getName : string>) lowerLevelHRRep = new lowerLevelHRRep;;

s1#receiveEvaluation h1;; 
```

我在编译时遇到的错误是：

```
The type of this expression, <visitSalesman : 'a -> unit; _.. > salesman as 'a, 
contains type variables that cannot be generalized. 
```

但是，代码编译减去实例化`salesman`.

如何`salesman`在保持类功能的同时实例化？

**通过调用 receiveEvaluation 收到**编辑错误：****

 **```
This expression has type (<getName:string>, < getName:string>) lowerLevelHRRep 
but is here used with type <visitSalesman : 'a salesman -> unit > as 'a. 
```

第二种对象类型没有方法`visitAccountant`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T21:11:52.970

编辑 - 将答案分为 3 个要点：初始编译错误的解决方案、递归解决方案和参数化解决方案

**编译错误的解决**

请注意，您的代码在顶层运行良好：

```
# let s = new salesman ();;
val s : < visitSalesman : 'a -> unit; _.. > salesman as 'a = <obj> 
```

这种编译错误一般通过添加类型注释来帮助编译器计算类型来解决。正如顶层友好地告诉我们它是什么，我们可以修改实例化：

```
let s : (< visitSalesman : 'a -> unit>) salesman = new salesman ();; 
```

这编译！

**递归解决方案**

可以通过使用递归类来降低复杂性。这完全消除了对参数化类的需求，但意味着所有对象都需要在同一个源文件中定义。

```
class virtual employee =
object
  method virtual receiveEvaluation:(hrrep -> unit)
end

and accountant = 
object(self)
  inherit employee
  method receiveEvaluation:(hrrep -> unit) = fun rep -> rep#visitAccountant (self :> accountant)
end

and salesman = 
object (self)
  inherit employee
  method receiveEvaluation:(hrrep -> unit) = fun rep -> rep#visitSalesman (self :> salesman)
end

and hrrep = 
object
  method visitSalesman:(salesman -> unit) = fun s -> print_endline ("Visiting salesman")
  method visitAccountant:(accountant -> unit) = fun s -> print_endline ("Visiting accountant")
end

let s = new salesman;;
let e = (s :> employee);;
let v = new hrrep;;

e#receiveEvaluation v;; 
```

这将打印“Visiting salesman”。对员工的强制只是为了让这更接近现实世界的场景。

**参数化解决方案**

再看问题，我认为没有必要有一个参数化的hrRep，因为此时，所有其他类型都是已知的。通过将员工类参数化，我得到了这个：

```
class virtual ['a] employee = 
object
  method virtual receiveEvaluation : 'a -> unit
  method virtual getName : string
end

class ['a] accountant name =
object(self)
  inherit ['a] employee
  val name = name
  method receiveEvaluation rep = rep#visitAccountant self
  method getName = "A " ^ name
end

class ['a] salesman name =
object(self)
  inherit ['a] employee
  val name = name
  method receiveEvaluation rep = rep#visitSalesman self
  method getName = "S " ^ name
end

class virtual hrRep = 
object
  method virtual visitAccountant : hrRep accountant -> unit
  method virtual visitSalesman : hrRep salesman -> unit
end

class lowerLevelHRRep =
object
  inherit hrRep
  method visitAccountant a = print_endline ("Visiting accountant " ^ a#getName)
  method visitSalesman s = print_endline ("Visiting salesman " ^ s#getName)
end;;

let bob = new salesman "Bob";;
let mary = new accountant "Mary";;
let sue = new salesman "Sue";;
let h = new lowerLevelHRRep;;
bob#receiveEvaluation h;;
mary#receiveEvaluation h;;
sue#receiveEvaluation h;; 
```

这将返回：

拜访推销员 S Bob

访问会计师 A Mary

到访推销员 S Sue

这种解决方案的优点是员工不需要了解访问者，因此可以在他们自己的编译单元中定义，从而在添加新类型的员工时代码更简洁，并且需要进行的重新编译更少。

# database-design - 为数据库设计审查创建 ERD 的简单方法

> ID：817950
> 
> 赞同：-2
> 
> 时间：2009-05-03T20:41:12.623
> 
> 标签：database-design, schema, fluent-nhibernate, diagram

我正在开发一个使用 jet (MS Access) 数据库的新应用程序。我已经使用我的 C# 对象中的 FluentNHibernate 的 AutoMapping 功能构建了数据库。

我需要在星期二展示这个数据库以进行在线 WebEx 设计审查，并且正在寻找一种工具来为我的数据库创建 ERD，我可以将其分组到幻灯片上。

MS Access 中的图表几乎无法使用。

我有：VS2008 Pro、MS Access 2007、Visio 2007、Visio for Enterprise Architects 等...我的 C# 代码架构使用 NHibernate Hbm2Ddl hbm.xml 导出的映射文件由包含数据库的 FluentNHibernate .accdb 文件创建

我需要：快速、免费和简单的方法来创建清晰的图表。

由于我拥有 Fluent NH 和 NHibernate 的一切，我可以使用它们的驱动程序/方言为任何支持的数据库创建一个模式，以用于生成图表。

有什么建议可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-24T14:55:55.220

由于您拥有 Visio 2007，您可以从 SQL Server、Access 或其他与驱动程序兼容的数据源“逆向工程”数据库。

1.  创建一个新的数据库文档（又名：数据库模型图）
2.  从新的“数据库”菜单中选择反向工程

从那时起，您将连接到所需的数据源。最后一步询问您是否要将表格添加为新形状。选择“是”，您将拥有漂亮的 Visio 样式 ERD。我相信您也可以在更改后刷新您的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-03T21:14:10.097

如果您的 MS Access 数据库具有真实数据库的所有属性，例如约束等......那么 Visio 应该导入数据库。如果它不适合您...将数据库导入 SQL Server。SQL Server 有一些用于绘制基本 ERD 的基本工具......以及从 SLQ Server 导入的 Visio。

ERD 的“正确性”和“复杂性”最终将取决于您以及如何扩展捕获的数据。

祝你好运

# jquery - 重定向/刷新到片段标识符

> ID：817957
> 
> 赞同：2
> 
> 时间：2009-05-03T20:44:05.910
> 
> 标签：jquery, fragment-identifier, iui

我使用 iUI 框架来创建网站。如果您对此不熟悉，则您有一个由 div 组成的页面，并且您使用片段标识符在用户之间导航。

这样做的问题是，如果您的用户添加内容，则在刷新之前它是不可见的。在我的情况下，他们通过 jquery 帖子将数据添加到列表中，但就像我说他们在刷新之前什么都看不到，一旦你进行刷新，它就会进入父 div，因为 #fragment 已经丢失。

因此，在使用 window.location = mywebsite.com/#_fragment 更新后，我设法让页面转到 mywebsite.com/#_fragment ，但它实际上并没有重新加载页面。

任何人都知道如何将页面刷新为片段？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-03T21:15:56.720

URI 片段标识符仅用于客户端，不会发送到服务器，即，如果您检查 HTTP 请求标头，您将看不到 #_fragment。此外，对仅修改片段的 URI 进行更改不会触发任何 DOM 事件。

虽然有一些解决方法，例如使用 setInterval() 调用来主动监控 document.location.hash 属性，但最简单的方法是简单地更改查询字符串 arg。例如，而不是：

```
window.location = mywebsite.com/#_fragment 
```

包括一个查询字符串组件，例如：

```
window.location = mywebsite.com/?refresh=1#_fragment 
```

“?refresh=1”（或任何其他键/值对）的存在将导致浏览器向服务器发出请求，同时保留#hash 标识符。

有关 JS 位置对象的更多信息，请参见此处：http: [//docs.sun.com/source/816-6408-10/location.htm](http://docs.sun.com/source/816-6408-10/location.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T17:21:16.357

我相信你会使用 iUI 来构建 iPhone 友好的网络应用程序。我不确定您是否已经评估[过 iWebkit](http://iwebkit.net/)。我查看了 iUI 和 iWebkit，发现 iWebkit 功能更强大、更稳定且易于实现。

# memory - 何时从堆中释放可变状态值？

> ID：817958
> 
> 赞同：0
> 
> 时间：2009-05-03T20:44:18.093
> 
> 标签：memory, f#, heap-memory, mutable, object-lifetime

在[封装可变状态](http://en.wikibooks.org/wiki/F_Sharp_Programming/Mutable_Data)部分的 F# WikiBook 上，有以下代码片段。

```
> let incr =
    let counter = ref 0
    fun () ->
        counter := !counter + 1
        !counter;;

val incr : (unit -> int)

> incr();;
val it : int = 1

> incr();;
val it : int = 2

> incr();;
val it : int = 3 
```

起初，似乎很容易接受这样一个事实，即每次调用可变`counter`值都会递增。`incr`

但是想了一会儿，我无法理解的是什么时候`counter`从堆中释放出来，以及`counter`在递增之前如何仍然引用先前的值。它是如何通过多个函数调用`counter`在函数范围内生存的？`incr`

所以主要问题是：

*   什么时候`counter`从堆中释放出来？
*   不是`counter`内存泄漏吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-03T21:09:21.510

“词法范围”（名称在程序文本中具有意义）和“生命周期”（对象创建和销毁之间的运行时间）之间的区别有时会令人困惑，因为这两者通常高度相关。然而，这个例子演示的技术在函数式语言中很常见：你给一个实现细节一个小的词法范围（对调用者隐藏实现细节），但是通过在闭包中捕获它来延长它的生命周期（这样它的生命周期就变成了生命周期）封闭对象的 - 在这种情况下是“incr”函数）。这是在函数式编程中进行封装的常用方法（与面向对象编程中类中公共/私有的常用封装技术形成对比）。

现在，在这个特定的例子中，'incr' 看起来是一个顶级函数，这意味着它的值在程序的生命周期内持续存在（如果键入 fsi.exe，则为交互式会话）。您可以将其称为“泄漏”，但这取决于意图。如果您在整个程序的整个生命周期中都需要一些唯一的 id 计数器，那么您将不得不将该计数器变量存储在*某个地方*它持续整个程序。因此，这取决于“incr”的使用方式（您是否需要在整个程序的其余部分中使用该功能？），这是“泄漏”还是“设计特性”。无论如何，这里的关键点是'incr' 持有内存资源，所以如果你不会永远需要这些资源，你应该安排'incr' 引用的闭包在不再需要时变得不可访问。通常这可能是通过使其成为其他功能的本地化，例如

```
let MyComplicatedFuncThatNeedsALocalCounter args =
    let incr = 
        // as before
    // other code that uses incr
    // return some result that does not capture incr 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-03T21:14:35.447

在这种情况下，`incr`是一个顶级函数（如果我没记错的话，作为静态字段实现。）它包含一个闭包，而闭包又引用了名为`counter`. 只要这个闭包存在，这个`ref`单元就会被保存在内存中。

现在这个顶级绑定确实永远不会被垃圾收集，因为它是一个静态只读字段。（用 C# 术语）。但是，如果您有类似生命周期*有限*的闭包（在本地或对象中绑定），那么`ref`当闭包被垃圾收集时，单元格将被释放。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T20:50:40.370

当 incr 不再可访问时，计数器从堆中释放。由于垃圾收集，这不是内存泄漏。

# javascript - jQuery Accordion 打开折叠

> ID：817959
> 
> 赞同：26
> 
> 时间：2009-05-03T20:44:48.637
> 
> 标签：javascript, jquery, jquery-ui, accordion

使用 jquery v1.3.2 和 jQuery UI 1.7.1

我有 1 个选项卡控件，其中有 3 个选项卡。每个选项卡包含 1 个手风琴控件。

```
$(document).ready(function() {
$('#acc1').accordion({ collapsible: true, autoHeight: false });     

$('#acc1').accordion({ collapsible: true, autoHeight: false });     

$('#acc1').accordion({ collapsible: true, autoHeight: false });

$('#tabControl').tabs();

}); 
```

tabControl 在页面加载时不可见。有打开它的按钮。

```
$("#btnShow").bind("click", function() {
$('#tabControl').slideToggle("slow");
}); 
```

我找不到让所有手风琴控件折叠的方法。每次我显示 tabControl 时，其中的手风琴总是展开第一项。

我试过这个：

```
$('#acc1First').css('display', 'none');
$('#acc2First').css('display', 'none');
$('#acc3First').css('display', 'none');

$('#acc1First').slideUp();
$('#acc2First').slideUp();
$('#acc3First').slideUp(); 
```

但它有时会出错，第一个项目必须点击 2 次才能正常工作等。

有没有办法在所有项目折叠的情况下初始化手风琴控件？

谢谢

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-05-03T20:53:32.220

试试这个

```
$('#acc1').accordion({ 
    collapsible: true, 
    autoHeight: false, 
    active: false 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-03-31T19:04:16.740

我创建了这个：

[http://sarfraznawaz.wordpress.com/2010/03/09/creating-stylish-sliding-menu-with-jquery/](http://sarfraznawaz.wordpress.com/2010/03/09/creating-stylish-sliding-menu-with-jquery/)

# jruby - 没有数据库的 JRuby on Rails

> ID：817971
> 
> 赞同：1
> 
> 时间：2009-05-03T20:50:43.350
> 
> 标签：jruby, jrubyonrails

我正在使用使用 Rails (2.3.2) 的 JRuby (v1.2.0) 在 NetBeans 中启动一个新的 Rails 项目。我不需要数据库，我所有的数据都来自云端。

我在我的环境中取消了这条线的注释

config.frameworks -= [：active_record，：active_resource，：action_mailer]

但是，我仍然会在尝试调用操作时收到以下错误。在 GlassFish 上托管。

java.net.SocketException：java.net.ConnectException：连接被拒绝：在 com.mysql.jdbc.MysqlIO.(MysqlIO.java:276) 在 com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:156) 处连接com.mysql.jdbc.Connection.createNewIO(Connection.java:2666) 在 com.mysql.jdbc.Connection.(Connection.java:1531)

任何想法我可能需要更改以不使用数据库？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-04T05:49:48.030

第一步，确保您在 config/environments/[your env].rb 中没有任何特定于环境的覆盖

我刚刚做了一个测试：

1.  创建一个新的 Rails 应用程序
2.  编辑 config/environment.rb 以取消注释 config.frameworks -= [ :active_record, :active_resource, :action_mailer] 行
3.  jruby 脚本/生成控制器你好索引
4.  jruby 脚本/服务器
5.  将浏览器指向 localhost:3000/hello

一切似乎都很好 - 没有 ActiveRecord 错误。你呢？

# c++ - 如何摆脱 rand() 的警告？(C++)

> ID：817975
> 
> 赞同：2
> 
> 时间：2009-05-03T20:53:00.863
> 
> 标签：c++, time, random, standard-library, seed

每当我在 C++ 中使用 rand 函数时：

```
#include<iostream>
#include<time.h>
#include<stdlib.h>
using namespace std;
int main(){
srand(time(0));
int n=(rand()%6)+1;
cout<<"The dice roll is "<<n<<"."<<endl;
} 
```

我在第 5 行收到关于从 time_t 转换为 int 的警告：

```
srand(time(0)); 
```

有没有办法摆脱这个警告？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-03T21:00:58.177

实际上，您应该使用[带有 srand()的](http://linux.die.net/man/3/srand)[**无符号**](http://linux.die.net/man/3/srand)整数：

```
srand((unsigned) time(0)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-03T21:03:15.847

另一方面，这段代码：

```
rand()%6 
```

通常被认为是一种不好的做法。rand() 的低位比高位的随机性要小得多。如果你这样做，你会得到更好的随机性：

```
(rand() >> 8)%6 
```

例如。

编辑：

有关这方面的更多详细信息，请参阅[此说明](http://members.cox.net/srice1/random/crandom.html)以及[Dobbs 博士](http://www.ddj.com/cpp/184403169)杂志的这篇文章，其中至少暗示了原因：

> 注意：请勿使用
> 
> ```
>  y = rand()  %  M; 
> ```
> 
> 因为这侧重于 rand() 的低位。对于 rand() 通常是线性同余随机数生成器，低字节的随机性远低于高字节。事实上，最低位在 0 和 1 之间循环。因此 rand() 可能在偶数和奇数之间循环（试试看）。注意 rand() 不必是线性同余随机数生成器。完全允许它是没有这个问题的更好的东西。

东道主：

> 最重要的一点是，通常（线性同余）随机数生成器输出的低位是最不“随机”的。也就是说，低位中的模式是常见的。因此，您讨论中例行滚动的输出并不令人惊讶。此外，依靠高位来确定返回的整数是可以避免的。

例如，如果您想选择一个随机的“真”或“假”值，并且您使用了以下代码：

```
rand() % 2 
```

然后你可能最终会看到结果的模式：

1,0,1,0,1,0,1,0,1,0（等）

这显然不是那么随机，但它是可能正在使用的线性同余生成器的一个属性。一个更好的方案（对于 C++）可能是使用[Boost.Random](http://www.boost.org/doc/libs/1_39_0/libs/random/index.html)库，它支持所有类型的可插拔随机生成器（包括没有这个缺陷的 Mersenne Twister）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T20:54:12.390

使用显式强制转换来消除警告：

```
srand((int)time(0)); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-03T23:01:24.487

要摆脱警告，您应该使用静态强制转换为无符号整数。

```
srand(static_cast<unsigned int>(time(0))); 
```

在相关说明中，rand 的结果应向右移动以消除低位中的任何偏差。

```
int n = ((rand() >> 8) % 6) + 1; 
```

最后，在 C++ 中，C 时间库和标准库应包含为：

```
#include <ctime>
#include <cstdlib> 
```

这会将函数放置在适当的命名空间“std”中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-03T21:05:28.570

两个旁注：

*   在 C++ 中包含 C 头文件的标准方法是这样的：`#include <cstdio>`.
*   传递给的参数`time()`是一个指针，很多人认为它`NULL`是一个比`0`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T21:30:50.103

还，

```
 rand() % 6 
```

将引入一个小的偏差。由于 RAND_MAX % 6 为 1，因此零和一的出现频率将略高于二到六。在这种情况下，每 5461 次返回较高的数字，它们就会返回 5462 次，因此您可能不会注意到它。但是，如果您想要的数字范围很大，则偏差可能很大。例如，如果你这样做了`rand() % 32000`，那么 0 - 767 范围内的数字出现的频率将是 768 - 32000 的两倍。

# windows - 有人在使用 Visual Studio 2008 时遇到缓慢的问题吗？

> ID：817986
> 
> 赞同：2
> 
> 时间：2009-05-03T20:59:11.393
> 
> 标签：windows, visual-studio-2008, performance

是否有人在使用 Visual Studio 2008 时遇到极度缓慢的情况？我有一台相当强大的机器，所以我认为硬件不是问题，我在 2005 年没有这些问题。基本上我所做的一切都很慢，从打开一个新项目到打开代码，再到保存文件。我所有的 Windows 更新都已启动，我安装了 VS2008 SP1，我什至尝试禁用病毒防护。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T21:08:58.283

尝试以安全模式加载 Visual Studio，以使用 [/safemode](http://msdn.microsoft.com/en-us/library/xee0c8y7(VS.80).aspx)开关加载默认环境。

您可能还想在这里尝试一些答案：

[Visual Studio 2008 非常慢！！](http://social.msdn.microsoft.com/forums/en-US/vssetup/thread/bc778e26-9156-4924-a9ca-a57ef8ff6bcc/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-03T21:07:31.577

**是的，它很慢。**

我有一台速度非常快的 Intel E8500 机器（2x3.16ghz），有 4gigs 的 RAM，Visual Studio 2008 很慢。

打开对话框很慢，创建新项目很慢，您必须在对话框后等待几秒钟。

但并非每次都如此，因为一旦将这些对话框加载到内存中，第二次它们会更快。

但它仍然太慢，太慢了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-03T21:18:37.183

磁盘速度可能会导致此问题，并且还有诸如 resharper 之类的加载项

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-03T21:13:08.693

不是每个人都有你看到的问题。尝试按照建议禁用加载项，然后监视您的计算机以了解正在发生的事情。是否有额外的磁盘 I/O？很多页面错误？什么？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T21:20:47.460

清空您的回收站。在输出窗口中关闭“换行”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-04T21:35:43.997

这似乎解决了我的直接问题（从 Gulzar 提供的链接复制并粘贴）：

作为更新，我找到了一个更好的修复程序，因此您不必失去 VS 2008 中的任何功能。这也大大提高了我在 SQL Server Management Studio 中的性能（响应时间）。

在 Internet Explorer 7 中...

工具->Internet 选项->高级->安全节点->取消选中“检查发布者的证书吊销*”

一旦我这样做了，就像魔术一样，即使选中了“启用 Visual Studio 托管进程”并且 SQL Server Management Studio 的响应时间几乎是即时的，VS 2008 也能很好地工作。

这是美好的一天！

我的理论是我所在的公司网络阻塞了某些端口（我无法控制），因此某些“幕后”请求超时，导致延迟。

*   罗比

# svn - SVN导入后如何提交更改？

> ID：817987
> 
> 赞同：8
> 
> 时间：2009-05-03T20:59:34.013
> 
> 标签：svn

我创建了一个项目，并使用了`svn import`. 现在我想对文件进行更改，该怎么做？

我有空`~/.workspace/project/.svn/entries`。

如果我尝试 svn commit 我得到这个：

```
$ svn commit src/dat/Win.java
svn: '/home/st/.workspace/dat/src/dat' is not a working copy
svn: Can't open file '/home/st/.workspace/dat/src/dat/.svn/entries': No such file or 
```

目录

……或者只是`svn commit`：

```
$ svn commit
svn: Can't read file '/home/st/.workspace/dat/.svn/entries': End of file found 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-03T21:09:40.370

svn import 将未版本控制的文件提交到存储库（大概在远程主机上）。完成此操作后，您需要将存储库签出到您自己的机器作为工作副本，使用

```
svn checkout http://some.repository.net/trunk/ /my/local/path/to/workingcopy 
```

这将检查从 repo 到您的机器到文件夹 /my/local/path/to/workingcopy 的中继。做出改变，然后做。

```
svn commit -m "A comment telling what you did the which file" 
```

或者，如果您在工作副本中添加了一些文件，请执行以下操作：

```
svn add /path/to/file /path/to/otherfile 
```

或者

```
svn add /path/to/dir --force 
```

这会将目录中的所有内容及其所有子目录添加到工作副本中，最后

```
svn commit -m "who did what why" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-03T21:06:03.983

在提交之前，您需要检出刚刚导入文件的新副本。删除（或重命名）您是项目目录，然后执行`svn checkout [REPOSPATH]`. 然后你有一个工作副本。更改工作副本中的文件后，您可以使用`svn commit`.

请参阅SVN Book 中的将[数据导入您的存储库](http://svnbook.red-bean.com/en/1.4/svn.tour.importing.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-03T21:05:13.860

如果不先签出存储库的本地副本，就无法提交更改。

1.  使用以下命令将存储库签出到本地目录：

    ```
    svn checkout file:///path/to/repo 
    ```

2.  做出改变。
3.  运行以下命令以提交您的更改：

    ```
    svn commit 
    ```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-03T21:05:07.543

您可以使用 'svn diff' 来查看您有哪些未完成的更改，并使用 'svn commit' 提交它们（提交所有更改），或使用 'svn commit path/to/file1 path/to/file2' 仅提交更改到那些文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T21:01:22.217

```
svn commit 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T21:01:51.483

```
svn 提交 [PATHTOFILE]

```

通过 svn commit --help

# .net - 隐藏错误报告窗口

> ID：817990
> 
> 赞同：2
> 
> 时间：2009-05-03T21:01:19.347
> 
> 标签：.net, winapi, error-handling

我有以下问题：
我的 ASP.Net 应用程序接收一个简单控制台程序的 C++ 源代码，用 cl.exe（命令行 VC++ 编译器）编译它并使用 System.Diagnostics.Process 运行它。

ASP.Net 应用程序运行在 PC 上，可用于其他工作（它不是服务器，只是工作机器）。我正在向用户隐藏正在运行的程序窗口（使用 Process.CreateNoWindow 和 Process.WindowStyle = ProcessWindowStyle.Hidden 属性），但有时收到的源可能包含一些崩溃指令（如访问无效内存地址或其他内容）并且程序崩溃。在这种情况下，Windows 会显示错误报告窗口（如果是 Vista - 带有消息“Windows 正在检查问题的解决方案...”的窗口），这会分散用户的注意力并使他感到困惑。

也许有一些方法可以防止显示此消息或自动关闭它？我在谷歌上有很多关于 WinAPI 的信息，但找不到解决方案。如果单个进程不可能 - 也许我可以在整个系统上临时禁用此窗口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-05T01:27:24.517

从 Windows Vista 开始，您可以使用 WinAPI 功能`WerAddExcludedApplication`来禁用特定应用程序的“Windows 错误报告”。

请参阅：http: [//msdn.microsoft.com/en-us/library/bb513617 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb513617(VS.85).aspx)

在 Vista 之前的 Windows 版本`AddERExcludedApplication`中，必须使用该功能。

请参阅：http: [//msdn.microsoft.com/en-us/library/bb513614 (VS.85).aspx](http://msdn.microsoft.com/en-us/library/bb513614(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-05T04:00:24.917

以下是一些其他选项：

[如何禁用 Windows Vista 上的“调试/关闭应用程序”对话框？](https://stackoverflow.com/questions/396369/how-do-i-disable-the-debug-close-application-dialog-on-windows-vista)

# java - 如何使用加权函数对多个字段的搜索结果进行排序？

> ID：817998
> 
> 赞同：8
> 
> 时间：2009-05-03T21:05:52.020
> 
> 标签：java, sorting, lucene

我有一个 Lucene 索引，其中每个文档都有几个包含数值的字段。现在我想根据这个字段的加权和对搜索结果进行排序。例如：

```
field1=100
field2=002
field3=014 
```

权重函数如下所示：

```
f(d) = field1 * 0.5 + field2 * 1.4 + field3 * 1.8 
```

结果应按代表文档的`f(d)`位置排序。`d`排序功能应该是非静态的，并且可能因搜索而异，因为常量因素会受到执行搜索的用户的影响。

有没有人知道如何解决这个问题，或者可能知道如何以另一种方式实现这个目标？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-05T16:07:17.460

您可以尝试实现自定义[ScoreDocComparator](http://lucene.apache.org/java/2_4_1/api/core/org/apache/lucene/search/ScoreDocComparator.html)。例如：

```
public class ScaledScoreDocComparator implements ScoreDocComparator {

    private int[][] values;
    private float[] scalars;

    public ScaledScoreDocComparator(IndexReader reader, String[] fields, float[] scalars) throws IOException {
        this.scalars = scalars;
        this.values = new int[fields.length][];
        for (int i = 0; i < values.length; i++) {
            this.values[i] = FieldCache.DEFAULT.getInts(reader, fields[i]);
        }
    }

    protected float score(ScoreDoc scoreDoc) {
        int doc = scoreDoc.doc;

        float score = 0;
        for (int i = 0; i < values.length; i++) {
            int value = values[i][doc];
            float scalar = scalars[i];
            score += (value * scalar);
        }
        return score;
    }

    @Override
    public int compare(ScoreDoc i, ScoreDoc j) {
        float iScore = score(i);
        float jScore = score(j);
        return Float.compare(iScore, jScore);
    }

    @Override
    public int sortType() {
        return SortField.CUSTOM;
    }

    @Override
    public Comparable<?> sortValue(ScoreDoc i) {
        float score = score(i);
        return Float.valueOf(score);
    }

} 
```

这是一个`ScaledScoreDocComparator`在行动的例子。我相信它在我的测试中有效，但我鼓励您根据您的数据来证明它。

```
final String[] fields = new String[]{ "field1", "field2", "field3" };
final float[] scalars = new float[]{ 0.5f, 1.4f, 1.8f };

Sort sort = new Sort(
    new SortField(
        "",
        new SortComparatorSource() {
            public ScoreDocComparator newComparator(IndexReader reader, String fieldName) throws IOException {
                return new ScaledScoreDocComparator(reader, fields, scalars);
            }
        }
    )
);

IndexSearcher indexSearcher = ...;
Query query = ...;
Filter filter = ...; // can be null
int nDocs = 100;

TopFieldDocs topFieldDocs = indexSearcher.search(query, filter, nDocs, sort);
ScoreDoc[] scoreDocs = topFieldDocs.scoreDocs; 
```

## 奖金！

似乎 Lucene 开发人员正在弃用该`ScoreDocComparator`接口（它目前在 Subversion 存储库中已弃用）。下面是一个`ScaledScoreDocComparator`修改为坚持`ScoreDocComparator`的继任者的示例`FieldComparator`：

```
public class ScaledComparator extends FieldComparator {

    private String[] fields;
    private float[] scalars;
    private int[][] slotValues;
    private int[][] currentReaderValues;
    private int bottomSlot;

    public ScaledComparator(int numHits, String[] fields, float[] scalars) {
        this.fields = fields;
        this.scalars = scalars;

        this.slotValues = new int[this.fields.length][];
        for (int fieldIndex = 0; fieldIndex < this.fields.length; fieldIndex++) {
            this.slotValues[fieldIndex] = new int[numHits];
        }

        this.currentReaderValues = new int[this.fields.length][];
    }

    protected float score(int[][] values, int secondaryIndex) {
        float score = 0;

        for (int fieldIndex = 0; fieldIndex < fields.length; fieldIndex++) {
            int value = values[fieldIndex][secondaryIndex];
            float scalar = scalars[fieldIndex];
            score += (value * scalar);
        }

        return score;
    }

    protected float scoreSlot(int slot) {
        return score(slotValues, slot);
    }

    protected float scoreDoc(int doc) {
        return score(currentReaderValues, doc);
    }

    @Override
    public int compare(int slot1, int slot2) {
        float score1 = scoreSlot(slot1);
        float score2 = scoreSlot(slot2);
        return Float.compare(score1, score2);
    }

    @Override
    public int compareBottom(int doc) throws IOException {
        float bottomScore = scoreSlot(bottomSlot);
        float docScore = scoreDoc(doc);
        return Float.compare(bottomScore, docScore);
    }

    @Override
    public void copy(int slot, int doc) throws IOException {
        for (int fieldIndex = 0; fieldIndex < fields.length; fieldIndex++) {
            slotValues[fieldIndex][slot] = currentReaderValues[fieldIndex][doc];
        }
    }

    @Override
    public void setBottom(int slot) {
        bottomSlot = slot;
    }

    @Override
    public void setNextReader(IndexReader reader, int docBase, int numSlotsFull) throws IOException {
        for (int fieldIndex = 0; fieldIndex < fields.length; fieldIndex++) {
            String field = fields[fieldIndex];
            currentReaderValues[fieldIndex] = FieldCache.DEFAULT.getInts(reader, field);
        }
    }

    @Override
    public int sortType() {
        return SortField.CUSTOM;
    }

    @Override
    public Comparable<?> value(int slot) {
        float score = scoreSlot(slot);
        return Float.valueOf(score);
    }

} 
```

使用这个新类与原来的非常相似，只是`sort`对象的定义有点不同：

```
final String[] fields = new String[]{ "field1", "field2", "field3" };
final float[] scalars = new float[]{ 0.5f, 1.4f, 1.8f };

Sort sort = new Sort(
    new SortField(
        "",
        new FieldComparatorSource() {
            public FieldComparator newComparator(String fieldname, int numHits, int sortPos, boolean reversed) throws IOException {
                return new ScaledComparator(numHits, fields, scalars);
            }
        }
    )
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T00:35:36.977

我在想一种方法是接受这些作为排序函数的参数：

字段数，文档数组，权重因子列表（基于字段数）

计算每个文档的权重函数，将结果以与文档数组相同的顺序存储在单独的数组中。然后，执行您希望的任何排序（快速排序可能是最好的），确保您不仅对 f(d) 数组进行排序，而且对文档数组也进行排序。返回排序后的文档数组，你就完成了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-04T11:35:57.293

实现您自己的相似性类并覆盖[idf(Term, Searcher)](http://lucene.apache.org/java/2_4_0/api/org/apache/lucene/search/Similarity.html#idf(org.apache.lucene.index.Term,%20org.apache.lucene.search.Searcher))方法。在此方法中，您可以按如下方式返回分数。if (term.field.equals("field1") {

```
 if (term.field.equals("field1") {
        score = 0.5 * Integer.parseInt(term.text());
    } else if (term.field.equals("field2") {
        score = 1.4 * Integer.parseInt(term.text());
    } // and so on
    return score; 
```

执行查询时，请确保它在所有字段上。那就是查询应该看起来像

> 字段 1：术语字段 2：术语字段 3：术语

最终得分还会根据查询规范化添加一些权重。但是，根据您给出的公式，这不会影响文档的相对排名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T12:10:04.247

创建一个包含评级且具有可比性的包装器。就像是：

```
public void sort(Datum[] data) {
   Rating[] ratings = new Rating[data.length];
   for(int i=0;i<data.length;i++)
     rating[i] = new Rating(data[i]);
   Arrays.sort(rating);
   for(int i=0;i<data.length;i++)
     data[i] = rating[i].datum;
}

class Rating implements Comparable<Datum> {
   final double rating;
   final Datum datum;

   public Rating(Datum datum) {
      this.datum = datum;
      rating = datum.field1 * 0.5 + datum.field2 * 1.4 + datum.field3 * 1.8
   }

   public int compareTo(Datum d) {
      return Double.compare(rating, d.rating);
   }
} 
```********