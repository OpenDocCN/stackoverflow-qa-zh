# StackOverflow 问答 000399000-000399999

# c++ - sizeof(some pointer) 是否总是等于四？

> ID：399003
> 
> 赞同：243
> 
> 时间：2008-12-29T23:03:23.063
> 
> 标签：c++, c, pointers, memory, sizeof

例如： `sizeof(char*)`返回 4。正如 , 一样`int*`，`long long*`我尝试过的所有内容。有没有例外？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2008-12-29T23:11:15.810

你得到的保证是`sizeof(char) == 1`。没有其他保证，包括不保证`sizeof(int *) == sizeof(double *)`.

在实践中，指针在 16 位系统上的大小为 2（如果你能找到的话），在 32 位系统上为 4，在 64 位系统上为 8，但是依赖给定的指针并没有什么好处尺寸。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-01-13T22:53:17.490

即使在普通的 x86 32 位平台上，您也可以获得各种指针大小，试试这个例子：

```
struct A {};

struct B : virtual public A {};

struct C {};

struct D : public A, public C {};

int main()
{
    cout << "A:" << sizeof(void (A::*)()) << endl;
    cout << "B:" << sizeof(void (B::*)()) << endl;
    cout << "D:" << sizeof(void (D::*)()) << endl;
} 
```

在 Visual C++ 2008 下，成员函数指针的大小分别为 4、12 和 8。

[Raymond Chen在这里](http://blogs.msdn.com/oldnewthing/archive/2004/02/09/70002.aspx)谈到了这一点。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2008-12-30T10:58:24.870

只是已发布列表的另一个例外。在 32 位平台上，指针可以占用 6 个字节，**而不是 4**个字节：

```
#include <stdio.h>
#include <stdlib.h>

int main() {
    char far* ptr; // note that this is a far pointer
    printf( "%d\n", sizeof( ptr));
    return EXIT_SUCCESS;
} 
```

如果你用 Open Watcom 编译这个程序并运行它，你会得到 6，因为它支持的远指针由 32 位偏移量和 16 位段值组成

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2008-12-29T23:04:24.420

如果你正在为 64 位机器编译，那么它可能是 8。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-12-31T04:19:54.580

从技术上讲，C 标准只保证 sizeof(char) == 1，其余的取决于实现。但在现代 x86 架构（例如 Intel/AMD 芯片）上，这是相当可预测的。

您可能听说过将处理器描述为 16 位、32 位、64 位等。这通常意味着处理器使用 N 位来表示整数。由于指针存储内存地址，而内存地址是整数，因此这有效地告诉您指针将使用多少位。sizeof 通常以字节为单位，因此为 32 位处理器编译的代码将报告指针的大小为 4（32 位/每字节 8 位），而为 64 位处理器编译的代码将报告指针的大小为 8 （每字节 64 位 / 8 位）。这就是 32 位处理器的 4GB RAM 限制的来源——如果每个内存地址对应一个字节，那么要寻址更多内存，您需要大于 32 位的整数。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2015-06-05T03:00:48.567

指针的大小基本上取决于实现它的系统的体系结构。例如，32 位指针的大小在 64 位机器中为 4 字节（32 位）和 8 字节（64 位）。机器中的位类型只不过是它可以拥有的内存地址。32 位机器可以有`2^32`地址空间，64 位机器可以有最多`2^64`地址空间。因此，指针（指向内存位置的变量）应该能够指向`2^32 for 32 bit and 2^64 for 64 bit`机器拥有的任何内存地址（ ）。

由于这个原因，我们看到指针的大小在 32 位机器中为 4 字节，在 64 位机器中为 8 字节。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-12-29T23:50:05.857

除了 16/32/64 位差异之外，还可能发生更奇怪的事情。

有些机器 sizeof(int *) 将是一个值，可能是 4，但 sizeof(char *) 更大。自然寻址字而不是字节的机器必须“增加”字符指针以指定您真正想要的字的哪个部分，以便正确实现 C/C++ 标准。

现在这是非常不寻常的，因为硬件设计人员已经了解了字节寻址能力的价值。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-07-16T20:23:54.320

大多数薄型微控制器都使用 8 位和 16 位指针。这意味着每台洗衣机、微型电脑、冰箱、旧电视，甚至汽车。

你可以说这些与现实世界的编程无关。但这是一个真实世界的例子：带有 1-2-4k ram（取决于芯片）和 2 字节指针的 Arduino。

它是最近的，便宜的，每个人都可以使用并且值得编码。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-31T01:39:40.720

除了人们所说的 64 位（或其他）系统之外，还有其他类型的指针，而不是指向对象的指针。

指向成员的指针几乎可以是任何大小，具体取决于编译器如何实现它们：它们甚至不一定都是相同的大小。尝试使用指向 POD 类的成员的指针，然后使用从具有多个基类的类的基类之一继承的指向成员的指针。多么有趣。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-29T23:04:52.873

据我回忆，它基于内存地址的大小。因此，在具有 32 位地址方案的系统上，sizeof 将返回 4，因为那是 4 个字节。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-29T23:06:07.130

一般来说，当你在不同的平台上编译时，sizeof（几乎任何东西）都会改变。在 32 位平台上，指针的大小始终相同。在其他平台上（64 位是明显的例子），这可能会改变。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-12-29T23:17:23.333

不，指针的大小可能因架构而异。有很多例外。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2014-07-14T19:04:19.980

在 Windows 32 位机器上的 Turbo C 编译器中，指针和 int 的大小为 2 个字节。

所以指针的大小是编译器特定的。但通常大多数编译器都实现为支持 32 位机器中的 4 字节指针变量和 64 位机器中的 8 字节指针变量）。

所以指针的大小在所有机器上都不相同。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2018-06-08T01:10:29.713

在**Win64 (Cygwin GCC 5.4)**中，让我们看看下面的例子：

首先，测试以下结构：

```
struct list_node{
    int a;
    list_node* prev;
    list_node* next;
};

struct test_struc{
    char a, b;
}; 
```

测试代码如下：

```
std::cout<<"sizeof(int):            "<<sizeof(int)<<std::endl;
std::cout<<"sizeof(int*):           "<<sizeof(int*)<<std::endl;
std::cout<<std::endl;

std::cout<<"sizeof(double):         "<<sizeof(double)<<std::endl;
std::cout<<"sizeof(double*):        "<<sizeof(double*)<<std::endl;
std::cout<<std::endl;

std::cout<<"sizeof(list_node):      "<<sizeof(list_node)<<std::endl;
std::cout<<"sizeof(list_node*):     "<<sizeof(list_node*)<<std::endl;
std::cout<<std::endl;

std::cout<<"sizeof(test_struc):     "<<sizeof(test_struc)<<std::endl;
std::cout<<"sizeof(test_struc*):    "<<sizeof(test_struc*)<<std::endl; 
```

输出如下：

```
sizeof(int):            4
sizeof(int*):           8

sizeof(double):         8
sizeof(double*):        8

sizeof(list_node):      24
sizeof(list_node*):     8

sizeof(test_struc):     2
sizeof(test_struc*):    8 
```

您可以看到，在 64 位中，`sizeof(pointer)`是`8`.

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-12-29T23:05:18.053

指针大小为 4 字节的原因是因为您正在为 32 位架构进行编译。正如 FryGuy 指出的那样，在 64 位架构上，您会看到 8。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-29T23:08:39.730

指针只是地址的容器。在 32 位机器上，您的地址范围是 32 位，因此指针始终为 4 个字节。在 64 位机器上，如果您的地址范围为 64 位，则指针将是 8 个字节。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2016-08-20T15:38:13.320

只是为了完整性和历史兴趣，在 64 位世界中，对于 long 和 long long 类型的大小有不同的平台约定，分别命名为 LLP64 和 LP64，主要在 Unix 类型系统和 Windows 之间。一个名为 ILP64 的旧标准也使 int = 64 位宽。

Microsoft 维护 LLP64，其中 longlong = 64 位宽，但 long 保持在 32，以便于移植。

```
Type           ILP64   LP64   LLP64
char              8      8       8
short            16     16      16
int              64     32      32
long             64     64      32
long long        64     64      64
pointer          64     64      64 
```

来源：[https ://stackoverflow.com/a/384672/48026](https://stackoverflow.com/a/384672/48026)

# c# - 自定义 HTML 帮助程序类是否违反 ASP.NET MVC 模型？

> ID：399017
> 
> 赞同：6
> 
> 时间：2008-12-29T23:06:46.957
> 
> 标签：c#, asp.net-mvc, model-view-controller, theory, html-helper

在一篇相关文章中，我提到我发现自定义 HTML 助手在开发时非常有用。例如，当我需要为“网格”分页时，我有一个可以调用的自定义助手`Html.Pager()`。

有些人指出 HTML 助手违反了 MVC 模型。就个人而言，我认为它与现有的助手没有任何不同，例如`Html.Textbox()`or `Html.ActionLink()`。

我仍在尝试了解有关 MVC 的更多信息，因此所有观点都值得赞赏。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-29T23:19:43.547

请注意，现有的助手都被编写为 HtmlHelper 类的扩展方法。我们明确采用了这种方法，以便其他人可以编写自己的辅助方法作为 HtmlHelper 的扩展方法。

所以总的来说，这并不违反MVC模型。我想这真的取决于你在你的助手中做了什么。助手应该根据传入的参数简单地呈现 html。他们不应该进行任何数据访问等......

它们仅封装用于呈现常见标记的代码。如果您这样做，那么您并没有违反 ASP.NET MVC 模型。

# speech-recognition - 口语编程语言/系统

> ID：399021
> 
> 赞同：2
> 
> 时间：2008-12-29T23:07:46.113
> 
> 标签：speech-recognition

我最近遇到了一种叫做[Rpoku](http://sourceforge.net/projects/rpoku/)的东西，它是一种口语计算机语言。我还发现了一些名为[Voice Code](http://sourceforge.net/projects/voicecode/)的研究，它采用了不同的方法。这里有一个[演示视频](http://www.youtube.com/watch?v=A7f9Iik3q58)..

这看起来很有希望，还是只是一个玩具？有朝一日是否有可能在不使用键盘输入的情况下创建应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T23:21:01.687

我，一方面，认为这是一个可怕的想法。为了使口语有意义并且更容易，它实际上必须是某种形式的自由。最后，它会导致试图找出“编译器”在语法上可接受的内容以实际执行我想要的操作，并且它将与今天的语言一样“技术性”，除了更多披着羊皮的狼。

如果我想逼自己自杀，也许我会试一试：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T23:16:49.013

我一直在思考这个问题。而且我认为需要进行范式转变（更不用说《星际迷航》规模的人工智能进步了），才能让程序员在口头上和写作时一样高效。

例如，在这个简单的代码示例中，我实际上说的比我输入的要多得多：

```
List<Employee> ListOfEmployees = new List<Employee>();

foreach (Employee emp in ListOfEmployees) {
Console.WriteLine(emp.Name);
} 
```

在那个代码块中，我说的是以下内容：

> 创建员工对象的通用列表，将员工对象初始化为其默认值。之后，我想一次遍历一个员工对象，并将每个人的名字写到控制台。

（为了简单起见，我故意省略了将名称分配给员工的代码）。

对我来说，输入代码比说出我想做的事情要快得多，即使不是，也必须为计算机定义术语才能将我的话翻译成实际代码。更不用说这是一种非常高级的语言——想象一下 Perl（或 C）如果说出来会是什么样子？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T00:02:32.273

可能不是。或者至少现在还没有。下一步将是文学编程和 DSL。

可能是，但也可能不是。我们不想写更多只是为了让利益相关者真正了解软件意图。我们是吗？

无论如何，这是一个关于这一切的有趣视频。

[http://www.infoq.com/presentations/domain-specific-languages](http://www.infoq.com/presentations/domain-specific-languages)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T00:08:43.527

调试充其量是烦人的。

我认为您可能会更多地考虑使用口语来驱动程序。如果您有一组高级函数和数据，您可以轻松地说（举个例子）“打印员工姓名列表”，只要已经定义了 Print、List 和 Employee Names。

# python - 为什么我不能继承 datetime.date？

> ID：399022
> 
> 赞同：22
> 
> 时间：2008-12-29T23:08:18.513
> 
> 标签：python, oop, datetime, subclass

为什么以下不起作用（Python 2.5.2）？

```
>>> import datetime
>>> class D(datetime.date):
        def __init__(self, year):
            datetime.date.__init__(self, year, 1, 1)
>>> D(2008)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: function takes exactly 3 arguments (1 given) 
```

我想创建一个类似的类`datetime.date`，但具有不同的`__init__`功能。显然我的函数永远不会被调用。相反，原件`datetime.date.__init__`被调用并失败，因为它需要 3 个参数，而我传入一个。

这里发生了什么？这是一个线索吗？

```
>>> datetime.date.__init__
<slot wrapper '__init__' of 'object' objects> 
```

谢谢！

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-30T15:36:32.373

关于其他几个答案，这与 C 本身中实现的日期没有任何关系。该`__init__`方法什么也不做，因为它们是*不可变*的对象，因此构造函数 ( `__new__`) 应该完成所有工作。你会看到相同的行为子类化 int、str 等。

```
>>> import datetime
>>> class D(datetime.date):
        def __new__(cls, year):
            return datetime.date.__new__(cls, year, 1, 1)

>>> D(2008)
D(2008, 1, 1) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-31T01:19:50.620

请阅读有关[*数据模型*](https://docs.python.org/3/reference/datamodel.html)的 Python 参考资料，尤其是有关`__new__` [特殊方法](https://docs.python.org/3/reference/datamodel.html#object.__new__)的信息。

该页面的摘录（我的斜体）：

> `__new__()`主要是为了允许*不可变*类型（如 int、str 或 tuple）的子类*自定义实例创建*。它也通常在自定义元类中被覆盖，以自定义类创建。

`datetime.datetime`也是不可变类型。

PS如果你认为：

*   在 C 中实现的对象不能被子类化，或者
*   `__init__`不会为 C 实现的对象调用，仅`__new__`

那么请尝试一下：

```
>>> import array
>>> array
<module 'array' (built-in)>
>>> class A(array.array):
    def __init__(self, *args):
        super(array.array, self).__init__(*args)
        print "init is fine for objects implemented in C"

>>> a=A('c')
init is fine for objects implemented in C
>>> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-29T23:12:44.887

这是答案和可能的解决方案（使用函数或 strptime 而不是子类化）

[http://www.mail-archive.com/python-list@python.org/msg192783.html](http://www.mail-archive.com/python-list@python.org/msg192783.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T02:50:29.800

你的功能没有被绕过；Python 永远不会达到它会调用它的地步。由于 datetime 是在 C 中实现的，因此它在`datetime.__new__`not中进行初始化`datetime.__init__`。这是因为 datetime 是不可变的。您大概可以通过覆盖`__new__`而不是`__init__`. 但正如其他人所建议的那样，最好的方法可能根本不是子类化日期时间。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T23:22:00.983

您可能应该使用工厂函数而不是创建子类：

```
def first_day_of_the_year(year):
  return datetime.date(year, 1, 1) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T07:21:29.907

您可以**包装**它并向包装器添加扩展功能。

这是一个例子：

```
class D2(object):
    def __init__(self, *args, **kwargs):
        self.date_object = datetime.date(*args, **kwargs)

    def __getattr__(self, name):
        return getattr(self.date_object, name) 
```

以下是它的工作原理：

```
>>> d = D2(2005, 10, 20)
>>> d.weekday()
3
>>> dir(d)
['__class__', '__delattr__', '__dict__', '__doc__', '__getattr__',
 '__getattribute__', '__hash__', '__init__', '__module__', '__new__',
 '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__str__',
 '__weakref__', 'date_object']
>>> d.strftime('%d.%m.%Y')
'20.10.2005'
>>> 
```

请注意，`dir()`它没有列出`datetime.date`s 属性。

# python - 将“for循环”分配给python程序中的变量

> ID：399032
> 
> 赞同：-1
> 
> 时间：2008-12-29T23:11:51.957
> 
> 标签：python, mysql, database, input

我正在编写一个与 MySQL 数据库交互的程序，但我遇到了问题。如您所见，我编写了一个查询，它将在产品表中查找与用户输入的条形码相对应的产品。

如果在产品表中找到用户输入的条形码，我想在股票表中将“金额”字段增加 1，其中与输入的条形码对应的产品与股票中的产品相同桌子。

如您所见，我尝试将变量分配给 for 循环以尝试使其以这种方式工作，但它不起作用。有人知道怎么做吗？

```
import MySQLdb

def look_up_product():
    db = MySQLdb.connect(host='localhost', user = 'root', passwd='$$', db='fillmyfridge')
    cursor = db.cursor (MySQLdb.cursors.DictCursor)
    user_input=raw_input('please enter the product barcode that you wish to checkin to the fridge: \n')
    if cursor.execute("""select * from products where product = %s""", (user_input)):
        db.commit()
        result_set = cursor.fetchall ()
        #i want here to assign a variable to this for loop and the line below = for product in result_set: 
            print "%s" % (row["product"])
        cursor.execute('update stocks set amount = amount + 1 where product = %s', (#here i want the result of the for loop))
        db.commit()
    else:
        print 'no not in products table' 
```

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T01:54:59.753

答案取决于您所说的“将变量分配给 for 循环”是什么意思。这个措辞令人困惑，因为 for 循环是一种控制执行流程的工具——它通常不被认为具有值。但我想我知道你的意思。每次循环运行时，它都会执行`print "%s" % (row["product"])`. 我猜你想存储循环运行时生成的所有字符串。我也猜你的意思是`row[product]`而不是`row["product"]`，因为后者对于整个循环都是一样的。然后你可以这样做：

```
mylist = []
for product in result_set: 
    mylist.append("%s" % (row[product],)) 
```

请注意，即使您不再打印字符串，% 操作仍然有效——这对于来自 C 的人来说是一个惊喜。您还可以使用 python 列表推导来使此事件更简洁：

```
mylist = ["%s" % (row[product],) for product in result_set] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T15:37:15.990

There there. I also fixed a comma you were missing on the first `cursor.execute` line.

```
import MySQLdb

def look_up_product():
    db = MySQLdb.connect(host='localhost', user = 'root',
                         passwd='$$', db='fillmyfridge')
    cursor = db.cursor (MySQLdb.cursors.DictCursor)
    user_input=raw_input('please enter the product barcode '
                         'that you wish to checkin to the fridge: \n')
    cursor.execute("""select * from products where product = %s""",
                   (user_input,))
    for row in iter(cursor.fetchone, None):
        print row["product"]
        cursor.execute('update stocks set amount = amount + 1' 
                       ' where product = %s', (row["product"],))
    db.commit() 
```

Of course, you could always use [sqlalchemy](http://www.sqlalchemy.org/) instead:

```
import sqlalchemy as sa
import sqlalchemy.orm

# Prepare high-level objects:
class Product(object): pass
engine = sa.create_engine('mysql://root:$$@localhost/fillmyfridge')
session = sa.orm.create_session(bind=engine)
product_table = sa.Table('products', sa.MetaData(), autoload=True)
sqlalchemy.orm.mapper(Product, product_table)

def look_up_product():
    user_input=raw_input('please enter the product barcode '
                         'that you wish to checkin to the fridge: \n')
    for prod in session.query(Product).filter(Product.product == user_input):
        print prod.product
        # Here's the nicety: to update just change the object directly:
        prod.ammount = prod.ammount + 1
    session.flush()
    session.commit() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-29T23:19:56.870

您是否期望结果为单行？如果是这样，试试这个：

```
row = cursor.fetchone()
print row["product"]
cursor.execute('update stocks set amount = amount + 1 where product = %s', row["product"]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-29T23:20:06.633

我不确定您如何从*产品*表中获取的值中获取行 ID。我建议明确指定所需的列，而不是使用`select * from`成语。

我引入了用于 id 检索的辅助函数，以使代码更具可读性：

```
def getAnIdFromValue(someValueTuple):
    '''This function retrieves some table row identifier from a row tuple'''
    returns someValueTuple[0] 
```

如果需要多行，我会尝试以下函数体：

```
db = MySQLdb.connect(...)
cursor = db.cursor()
ids = []
cursor.execute("""select * from products where product = %s""", (user_input))
for value in cursor.fetchall():
    #value is a tuple. len(value) == number of columns in products table
    ids.append(getAnIdFromValue(value))
if len(ids):
    cursor.executemany("update stocks set amount = amount + 1 where product =%s", tuple(ids))
    db.commit()
else:
    print 'no not in products table' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-29T23:22:49.157

我认为您需要缩进“更新股票...”行，使其位于 for 循环内。

# .net - 如何为 EntLib 缓存刷新进程中的所有缓存

> ID：399040
> 
> 赞同：2
> 
> 时间：2008-12-29T23:14:20.140
> 
> 标签：.net, caching, enterprise-library, caching-application-block

我想知道是否有办法告诉企业库缓存对象刷新所有已配置的缓存以使该进程刷新。

即使枚举该进程的所有已配置缓存，并手动刷新每个缓存，也可以，但是是否有来自 EntLib.Caching 的 API 方法可以为我提供这些值？

还是我需要自己枚举配置文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-24T09:42:16.100

这个怎么样：

```
CacheManagerSettings conf = (CacheManagerSettings)ConfigurationSourceFactory.Create()
    .GetSection(CacheManagerSettings.SectionName);

conf.CacheManagers.ForEach(delegate(CacheManagerDataBase cache) { 
        CacheFactory.GetCacheManager(cache.Name).Flush();
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-25T21:16:23.487

我认为没有办法刷新所有缓存。回收应用程序池可以做到这一点，但这也会导致您的代码需要 JIT 编译。

我们通常将缓存的名称存储在常量中，以避免名称在代码中的多个位置被硬编码，如果您将名称存储在可枚举的数据类型中，您可以一次通过它并刷新它们。

# netflix - netfix 奖什么时候获得？

> ID：399044
> 
> 赞同：0
> 
> 时间：2008-12-29T23:16:14.817
> 
> 标签：netflix, prediction

有人有每日最佳[Netflix 奖项](http://www.netflixprize.com/)提交的图表吗？我想根据对现有进展的推断来预测何时解决它。

或者，你认为什么时候会赢，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T07:55:37.903

您可以解析[排行榜](http://www.netflixprize.com//leaderboard)，然后按日期对其进行排序，然后计算每日最大值等。就我个人而言，我不认为这样的推断应该给出太多，因为您打算预测具有许多未知数的复杂过程的结果。[这是纽约时报对比赛的精彩回顾](http://www.nytimes.com/2008/11/23/magazine/23Netflix-t.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T02:45:28.903

比赛从 2006 年 10 月 2 日开始，至少持续到 2011 年 10 月 2 日。请参阅[规则](http://www.netflixprize.com/rules)

# c# - ASP.NET 缓存

> ID：399045
> 
> 赞同：3
> 
> 时间：2008-12-29T23:16:17.967
> 
> 标签：c#, asp.net, caching

我似乎无法让它“工作”。也许我什至没有正确测试它。我的 aspx 页面中有一个 <%= DateTime.Now.ToString() %> 行。我试过像这样声明性地设置缓存

```
<%@ OutputCache VaryByParam="SchoolId" Duration="180" Location="Server" NoStore="false" %> 
```

我还尝试通过 Response.Cache 对象以编程方式设置它。时间戳总是变化的。

web.config 最初没有 outputCache 部分。我添加了一个看起来像

```
<outputCache enableOutputCache="true" enableFragmentCache="true" sendCacheControlHeader="true" omitVaryStar="false"/> 
```

时间戳总是变化的。我接下来要尝试什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T23:45:36.863

啊。问题是用户控件的 Page_Load 中的 Response.Cache.SetCacheability(HttpCacheability.NoCache) 隐藏在页面深处 3 个级别。不过，我感谢您的帮助。

-al

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T23:31:39.030

它应该很容易启用。我过去通过在我的 aspx 中设置 OutputCache 指令来完成它。我不认为 web.config 更改是必要的，因为默认情况下通常启用缓存。

您是使用 IIS 还是开发 Web 服务器进行测试？您是否在做任何会导致 Web 服务器在测试之间重置（即进行构建）的事情？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T23:21:08.160

我认为这不会起作用，因为 DateTime.Now 是一个始终更新的属性。您必须将其保存在不同的变量中，否则从缓存中获取它。

唔。我今天的脑子有点糊。我不确定这是否准确，因为它是输出缓存，但我现在没有时间模拟示例。

# c++ - 帮助 C++ 中的 ifstream 函数

> ID：399053
> 
> 赞同：3
> 
> 时间：2008-12-29T23:19:09.570
> 
> 标签：c++

我已经阅读了很多教程，但在这个主题上找不到任何全面的东西。

我编写了以下代码来执行一项功能：

```
#include <fstream>
#include <string>
#include <iostream>

using namespace std;

ifstream ReadFile( ifstream& openInputFile, string& sLine, int& chgLine );

int main()
{
    int chgLine;
    string MyFile, sLine, 
    sFile = "test.txt";

    cout << "Enter a file: ";
    cin >> MyFile ;

    ifstream openInputFile;

    if ( MyFile != sFile )    // file must be 'hello.cpp' to proceed
    {
       cout << "Error";
       exit(0);
    }
                         // if correct file is entered print the contents of it

        ReadFile( openInputFile, sLine, chgLine );

    system("pause");
    return 0;
}

ifstream ReadFile( ifstream& openInputFile, string& sLine, int& chgLine )
{ 

       while ( getline ( openInputFile, sLine ) )
       {
            if ( sLine.length() == 0 ) continue;  // to proceed

             for ( chgLine = 0; chgLine < sLine.length(); chgLine++ )
             {
                if ( sLine[chgLine] >= 97 && sLine[chgLine] <= 122 || sLine[chgLine] >= 65 && sLine[chgLine] <= 90  )
                {
                     cout << sLine[chgLine];
                }

             }
        }
} 
```

但现在我决定将所有这些分解为三个函数，分别执行我想要的操作，然后从`main()`函数中调用它们。

第一个函数打开文件：

```
#include <iostream>
#include <fstream>
using namespace std;

ifstream openInputFile()

{
       // use a pointer..return a pointer
       // ifstream definition is the challenge
  ifstream *fp;
  //fp = new ifstream openInputFile;
  return openInputFile;

}

int main()

{
    cout << "Hello, world!" << endl;

    system("pause");
    return 0;
} 
```

我被困在试图返回一个指针。我不明白我做错了什么。我怎样才能让最后一点代码工作？`ifstream`如果它具有函数的类型，如何返回一个指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-29T23:50:17.510

执行此操作的 C++ 方法是创建一个包含所有打开、读取和写入的类。请注意，这也将处理自动关闭文件，这是[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)的一个很好的例子。

```
// FancyFile.h:

class FancyFile
{
    private:
        std::ifstream stream;

    public:
        void DoMagic();

        InputFile(const std::string FilePath)
            { stream.open(FilePath.c_str()); }
        ~InputFile(void)
            { stream.close(); }
}; 
```

```
// FancyFile.cpp:

#include <fstream>
#include <string>

#include "FancyFile.h"

void FancyFile::DoMagic()
{
    //.. your custom file handling code goes here
} 
```

```
// main:

#include "FancyFile.h"

int main()
{    
    FancyFile myFancyFile("test.txt");

    myFancyFile.DoMagic();

    system("pause");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-29T23:40:21.803

在上述情况下，您似乎不需要通过指针返回。

如果您确实需要返回修改后的结果，您可能需要查看返回值优化 (RVO)。使用 RVO，您可以通过引用传递输出参数来保存自己的临时副本（以及在您的情况下为动态分配）。

例如

```
void openInputFile(ifstream& file)
{
    file.open(...);
}

int main()
{
    ifstream file;
    openInputFile(file);

    // Work with file, since file is
    // on the stack you don't have to worry about cleanup/etc
} 
```

这消除了处理动态分配的许多问题，并且可以避免您遇到的问题。您似乎对此有点兴趣，所以我对返回 ifstream 的需要感到困惑。

如果您*确实需要*通过指针返回，那么在这种情况下，您所缺少的似乎都是一个星号。例如这个函数：

```
 ifstream* Blah(); 
```

应该管用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T00:02:00.497

该示例实际上并未显示您使用指定的文件名打开 ifstream 吗？
该示例要求用户输入文件名，然后说它只能是一个值？

正如 Doug T. 所说，从示例代码中使用范围来管理 ifstream 可能会更好。
无论如何，这是一个返回指针的示例

```
ifstream * openInputFile( ) {
  string MyFil;
  string sFile = "test.txt";

  cout << "Enter a file: ";
  cin >> MyFile ;

  if ( MyFile == sFile )   
  {
    ifstream * inputFile = new ifstream( MyFile.c_str() );
    // do some other stuff here?
    return inputFile;
  } else {
    return null;
  }
} 
```

然后主要可以

```
int main()
{
  int chgLine;
  string sLine;
  ifstream *inputFile = openInputFile();
  if( NULL == inputFile )
  {
    cout << "Error";
    exit(0);
  }
... 
```

# php - 查找字符串中只出现一次的字符

> ID：399066
> 
> 赞同：3
> 
> 时间：2008-12-29T23:25:44.283
> 
> 标签：php, algorithm, sudoku

我正在用 PHP 编写算法来解决给定的数独难题。我已经建立了一个有点面向对象的实现，它有两个类：一个`Square`类用于 9x9 板上的每个单独的瓷砖，一个`Sudoku`类，它有一个`Square`s 矩阵来表示板。

我正在使用的算法的实现是一种三层方法。第一步，将只解决最基本的难题（但最有效），是根据棋盘的初始设置填充任何只能取单个值的方格，并相应地调整其余部分的约束未解的正方形。

通常，这种“不断传播”的过程并不能完全解决棋盘问题，但它确实解决了相当大的问题。然后第二层将启动。这会解析每个单元（或 9 个必须都具有唯一编号分配的方格，例如行或列）以获取每个未解决方格的“可能”值。此可能值列表在类中表示为字符串`Square`：

```
class Square {

private $name;                // 00, 01, 02, ... , 86, 87, 88
private $peers;               // All squares in same row, col, and box
private $number;              // Assigned value (0 if not assigned)
private $possibles;           // String of possible numbers (1-9)

public function __construct($name, $p = 0) {
  $this->name = $name;
  $this->setNumber($p);
  if ($p == 0) {
    $this->possibles = "123456789";
  }
}

// ... other functions 
```

给定一个单元中的整个未解正方形数组（如上面第二层所述），第二层会将所有“可能”字符串连接成一个字符串。然后它将在该单个字符串中搜索任何唯一字符值 - 不会重复的值。这将表明，在方格单位内，只有一个方格可以采用该特定值。

我的问题是：为了实现第二层，我如何解析一个单元中所有可能值的字符串并轻松检测唯一值？我知道我可以创建一个数组，其中每个索引由数字 1-9 表示，并且我可以为我找到的该数字的每个可能值将相应索引处的值增加 1，然后再次扫描数组以查找任何值 1，但这似乎效率极低，需要对每个单元的数组进行两次线性扫描，而在数独游戏中有 27 个单元。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T00:36:38.213

这有点像您已经排除的“效率极低”，但是使用内置函数，它可能非常有效：

```
$all_possibilities = "1234567891234";
$unique = array();
foreach (count_chars($all_possibilities, 1) as $c => $occurrences) {
  if ($occurrences == 1)
    $unique[] = chr($c);
}
print join("", $unique) . "\n"; 
```

打印：“56789”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T00:56:20.450

考虑使用二进制数来表示您的“可能”，因为像 AND、OR、XOR 这样的二进制运算往往比字符串运算快得多。

例如，如果一个正方形可能有“2”和“3”，则使用二进制数 000000110 来表示该正方形的可能性。

以下是您如何找到独特的：

```
$seenonce = 0;
$seenmore = 0;
foreach(all_possibles_for_this_unit as $possibles) {
    $seenmore |= ($possibles & $seenonce);
    $seenonce |= $possibles;
}
$seenonce ^= $seenmore;
if ($seenonce) {
    //something was seen once - now it must be located
} 
```

我不确定这种方法是否真的会更快，但值得研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T00:41:24.270

```
 function singletonsInString($instring) {

    $results = array();

    for($i = 1; $i < 10; $i++) {

        $first_pos = strpos($instring, str($i));
        $last_pos = strrpos($instring, str($i));

        if ( $first_pos !== FALSE and $first_pos == $last_pos ) 
            $results[] = $i;

    }

    return $results;

 } 
```

这会给你每个单身人士。获取该数组中数字的第一个和最后一个位置，如果它们匹配并且都不都是 FALSE（严格比较，以防一开始就有一个单例），那么该数组中只有一个这样的数字。

如果您非常担心这里的速度，您可以将那个循环的内部替换为

```
 $istr = str($i);
 if ( ($first = strpos($instring, $istr)) !== FALSE 
       and $first == $strrpos($instring, $istr) ) $results[] = $i; 
```

最少的计算次数。好吧，假设 PHP 的原生 strpos 是处理这些事情的最佳方式，据我所知，这并非不合理。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T01:13:16.563

上次我用数独解决问题时，我有第三节课，叫做“跑”。为每一行、col 和 3x3 正方形创建一个 Run 实例。每个方格都有与之关联的三个运行。Run 类包含尚未放置在运行中的一组数字。解板然后涉及迭代地在每个正方形处相交集合。这可以处理 80% 的大多数中板和 60% 的大多数硬板。一旦你完成了整个电路板而没有任何变化，你就可以进入更高级别的逻辑。每次您的高级逻辑填充一个正方形时，您都会再次遍历您的正方形。

这种设置的好处是您可以轻松地向求解器添加变体。假设您使用两个对角线也是唯一的变体。您只需在这 18 个方格中添加第 4 次运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T08:02:40.060

我会做的实际上是使用二进制位来存储实际值作为另一个答案建议。这样可以进行有效的检查，并且通常可以使数独本身具有更数学（=有效且更短）的解决方案（只是我的印象，我还没有研究过）。

基本上，您不是用数字表示数字，而是用 2 的幂

```
"1" = 2^0 = 1 =  000000001
"2" = 2^1 = 2 =  000000010
"3" = 2^2 = 4 =  000000100
"4" = 2^3 = 8 =  000001000
... etc up to 
"9" = 2^8 = 256= 100000000 
```

这样，您可以简单地添加单个方块的内容，以找出 3x3 或一行或任何其他数独子集中缺少的数字，如下所示：

```
// shows the possibles for 3x3 square number 1 (00-22)
$sum=0;
for ($i=0; $i< 3; $i++)
  for ($j=0; $j < 3; $j++)
         $sum += $square["${i}${j}"]->number

$possibles = $sum ^ 511  // ^ stands for bitwise XOR and 511 is binary 11111111 
```

现在 $possibles 在这个正方形中可能的数字的位位置包含“1”，您可以对其他正方形的结果进行按位运算以将它们匹配在一起，如下所示：

例如。比方说：

```
$possibles1 = 146 // is binary 100100101, 
                 //indicating that this row or 3x3 square has place for "9", "6", "3" and "1"
$possibles2 = 7 //   is binary 000000111, indicating it has place for "3", "2" and "1".

// so:
$possibles1 & $possibles2 
// bitwise AND, will show binary 101 saying that "3" and "1" is unfilled in both bloces
$possibles1 | $possibles2 
// bitwise OR will give that in total it is possible to use "9", "6", "3", "2" and "1" in those two squares together 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-31T08:53:35.523

这是一种仅使用 PHP 内置函数的方法，应该非常快。

```
function getUniques($sNumbers)
{
    return join(array_keys(array_count_values(str_split($sNumbers)),1));
}

echo getUniques("1234567891234"); // return 56789; 
```

# python - 以负步幅进入序列开头的扩展切片

> ID：399067
> 
> 赞同：16
> 
> 时间：2008-12-29T23:26:41.177
> 
> 标签：python, list, slice

在我解释我的问题时请耐心等待。如果您已经了解扩展切片列表索引，请跳至粗体标题。

在 python 中，您可以使用切片表示法对列表进行索引。这是一个例子：

```
>>> A = list(range(10))
>>> A[0:5]
[0, 1, 2, 3, 4] 
```

您还可以包含一个步幅，其作用类似于“步”：

```
>>> A[0:5:2]
[0, 2, 4] 
```

步幅也允许为负数，这意味着以相反的顺序检索元素：

```
>>> A[5:0:-1]
[5, 4, 3, 2, 1] 
```

可是等等！我想看看`[4, 3, 2, 1, 0]`。哦，我明白了，我需要减少开始和结束索引：

```
>>> A[4:-1:-1]
[] 
```

发生了什么？它将 -1 解释为位于数组的末尾，而不是开头。我知道您可以按如下方式实现：

```
>>> A[4::-1]
[4, 3, 2, 1, 0] 
```

但是你不能在所有情况下都使用它。例如，在已传递索引的方法中。

## 我的问题是：

是否有任何好的 Pythonic 方式来使用具有负步幅的扩展切片以及包含序列第一个元素的*显式开始和结束索引？*

这是我迄今为止提出的，但似乎并不令人满意。

```
>>> A[0:5][::-1]
[4, 3, 2, 1, 0] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T12:06:23.797

`start`更改和的语义很容易出错`stop`。使用`None`or`-(len(a) + 1)`代替`0`or `-1`。语义不是任意的。请参阅 Edsger W. Dijkstra 的文章[“为什么编号应该从零开始”](http://www.cs.utexas.edu/users/EWD/transcriptions/EWD08xx/EWD831.html)。

```
>>> a = range(10)
>>> start, stop, step = 4, None, -1 
```

或者

```
>>> start, stop, step = 4, -(len(a) + 1), -1
>>> a[start:stop:step]
[4, 3, 2, 1, 0] 
```

或者

```
>>> s = slice(start, stop, step)
>>> a[s]
[4, 3, 2, 1, 0] 
```

[什么时候`s`是一个序列，其中的负索引`s[i:j:k]`被特殊处理](https://docs.python.org/3/library/stdtypes.html#common-sequence-operations)：

> 如果`i`or`j`为负数，则索引相对于字符串的结尾： `len(s) + i`or`len(s) + j`被替换。但请注意，`-0`仍然是`0`.

这就是为什么，`len(range(10)[4:-1:-1]) == 0`因为它相当于`range(10)[4:9:-1]`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T23:44:35.417

好的，我想这可能和我能得到的一样好。感谢 Abgan 激发了这个想法。这依赖于切片中的 None 被视为缺少参数的事实。有人有更好的吗？

```
def getReversedList(aList, end, start, step):
    return aList[end:start if start!=-1 else None:step] 
```

*编辑：检查`start==-1`，不是`0`*

这仍然不理想，因为您破坏了 -1 的通常行为。似乎这里的问题是应该发生的事情的两个重叠定义。无论谁获胜，都会取消寻找其他意图的其他有效调用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T00:10:05.550

```
[ A[b] for b in range(end,start,stride) ] 
```

较慢，但是您可以使用负索引，因此应该可以：

```
[ A[b] for b in range(9, -1, -1) ] 
```

我意识到这不是使用切片，但我认为如果专门使用切片来获取结果不是优先事项，我还是会提供解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-29T23:38:30.310

我相信以下内容不能满足您：

```
def getReversedList(aList, end, start, step):
    if step < 0 and start == 0:
         return aList[end::step]
    return aList[end:start:step] 
```

或者是吗？:-)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T11:41:43.067

> [但是](https://stackoverflow.com/questions/399067/extended-slice-that-goes-to-beginning-of-sequence-with-negative-stride#399082)，例如，如果您将索引存储在变量中，则不能使用它。

这令人满意吗？

```
>>> a = range(10)
>>> start = 0
>>> end = 4
>>> a[4:start-1 if start > 0 else None:-1]
[4, 3, 2, 1, 0] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T15:01:08.077

正如你所说，很少有人完全理解扩展切片所能做的一切，所以除非你真的需要额外的性能，否则我会以“明显”的方式来做：

`rev_subset = reversed(data[start:stop])`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-29T23:33:18.417

```
a[4::-1] 
```

例子：

```
Python 2.6 (r26:66714, Dec  4 2008, 11:34:15) 
[GCC 4.0.1 (Apple Inc. build 5488)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> a = list(range(10))
>>> a
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
>>> a[4:0:-1]
[4, 3, 2, 1]
>>> a[4::-1]
[4, 3, 2, 1, 0]
>>> 
```

原因是第二项被解释为“while not index ==”。忽略它是“在范围内的索引”。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-04T23:17:45.280

我知道这是一个老问题，但如果像我这样的人正在寻找答案：

```
>>> A[5-1::-1]
[4, 3, 2, 1, 0]

>>> A[4:1:-1]
[4, 3, 2] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-01-04T23:52:24.850

你可以使用一个`slice(start, stop, step)`对象，它是这样的

```
s=slice(start, stop, step)
print a[s] 
```

是相同的

```
print a[start : stop : step] 
```

此外，您可以将任何参数设置为`None`在冒号之间不表示任何内容。因此，在您提供的情况下，您可以使用`slice(4, None, -1)`.

# wcf - 通过 IoC 容器进行 WCF 服务实例化

> ID：399072
> 
> 赞同：12
> 
> 时间：2008-12-29T23:28:15.213
> 
> 标签：wcf, inversion-of-control

是否可以使 WCF 运行时通过 IoC 容器而不是通过其通常的过程来实例化服务？（另外，考虑到容器的类型的生活方式配置和服务的 InstanceContextBehavior 之间的潜在冲突，这种方法会是一个糟糕的主意吗？）

我知道我可能完全问错了问题。我的目标是通过容器提供的方法拦截工具实现 AOP 方法（例如，方法进入/退出日志记录、性能计数和调用限制，所有这些都涉及我不想插入到我的服务实现中的逻辑和依赖项）。我想 WCF 提供了其他方法来解决这个问题，所以我也很想听听其他推荐的方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T08:52:29.163

简短的回答 - 是的，它可能。

请查看 Castle WCF 集成。它让您将 Castle Windsor 用于 WCF，它为您提供了比仅注入依赖项更强大的功能。最好使用[此处找到](http://builds.castleproject.org/project.html?projectId=project32&tab=projectOverview)的主干版本。关于它的文档不多，但请看一下测试。它们很容易理解，对您来说将是一个很好的示例代码。WCF 设施让您完全按照您的要求进行思考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T05:25:30.283

是的，继承人使用 ObjectBuilder 和 Spring.NET 的实现（如果您点击链接，还有更多！）：

[http://www.infoq.com/news/2008/01/wcf-di](http://www.infoq.com/news/2008/01/wcf-di)

虽然不能评论生活方式和实例上下文行为交互。

至于更多特定于 WCF 的方法，利用 WCF 行为概念（如上面的示例）也可能有用。有几种不同的类型，这是一个起点：

[http://mehranikoo.net/CS/archive/2007/02/22/WCFBehaviours.aspx](http://mehranikoo.net/CS/archive/2007/02/22/WCFBehaviours.aspx)

干杯，
马特

# regex - 正则表达式中必须转义哪些特殊字符？

> ID：399078
> 
> 赞同：440
> 
> 时间：2008-12-29T23:32:04.567
> 
> 标签：regex

我厌倦了总是试图猜测，`()[]{}|`在使用正则表达式的许多实现时是否应该转义特殊字符，如 ' ' 等。

它与 Python、sed、grep、awk、Perl、rename、Apache、find 等不同。是否有任何规则集告诉我什么时候应该，什么时候不应该转义特殊字符？它是否取决于正则表达式类型，如 PCRE、POSIX 或扩展正则表达式？

* * *

## 回答 #1

> 赞同：405
> 
> 时间：2008-12-30T14:01:58.757

哪些字符必须转义，哪些字符不能转义，实际上取决于您使用的正则表达式风格。

对于 PCRE 和大多数其他所谓的 Perl 兼容风格，请转义这些外部字符类：

```
.^$*+?()[{\| 
```

以及这些内部字符类：

```
^-]\ 
```

对于 POSIX 扩展正则表达式 (ERE)，转义这些外部字符类（与 PCRE 相同）：

```
.^$*+?()[{\| 
```

使用 POSIX ERE 转义任何其他字符是错误的。

在字符类中，反斜杠是 POSIX 正则表达式中的文字字符。你不能用它来逃避任何事情。如果要将字符类元字符包含为文字，则必须使用“巧妙的放置”。将 ^ 放在除开头之外的任何位置，将 ] 放在开头，将 - 放在字符类的开头或结尾以匹配这些字面意思，例如：

```
[]^-] 
```

在 POSIX 基本正则表达式 (BRE) 中，这些是您需要转义以抑制其含义的元字符：

```
.^$*[\ 
```

BRE 中的转义括号和大括号赋予了它们在 ERE 中未转义版本的特殊含义。一些实现（例如 GNU）在转义时也会赋予其他字符特殊的含义，例如 \? 和+。转义 .^$*(){} 以外的字符通常是 BRE 的错误。

在字符类中，BRE 遵循与 ERE 相同的规则。

如果这一切让您头晕目眩，请获取[RegexBuddy](http://www.regexbuddy.com)的副本。在“创建”选项卡上，单击“插入令牌”，然后单击“文字”。RegexBuddy 将根据需要添加转义。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2015-08-25T19:12:56.253

## 现代正则表达式 (PCRE)

^(包括 C、C++、Delphi、EditPad、Java、JavaScript、Perl、PHP (preg)、PostgreSQL、PowerGREP、PowerShell、Python、REALbasic、Real Studio、Ruby、TCL、VB.Net、VBScript、wxWidgets、XML Schema、Xojo、正则表达式。
PCRE 兼容性可能会有所不同)

    任何地方：`. ^ $ * + - ? ( ) [ ] { } \ |`

* * *

## 旧版正则表达式 (BRE/ERE)

^(包括 awk、ed、egrep、emacs、GNUlib、grep、PHP (ereg)、MySQL、Oracle、R、sed。
PCRE 支持可能会在以后的版本中启用或通过使用扩展来启用)

**ERE/awk/egrep/emacs**

    字符类外部：字符类`. ^ $ * + ? ( ) [ { } \ |`
    内部：`^ - [ ]`

**BRE/ed/grep/sed**

    字符类外部：字符类`. ^ $ * [ \`
    内部：`^ - [ ]`
    对于文字，不要转义：`+ ? ( ) { } |`
    对于标准正则表达式行为，请转义：`\+ \? \( \) \{ \} \|`

* * *

## 笔记

*   如果不确定特定字符，可以像`\xFF`
*   字母数字字符不能用反斜杠转义
*   任意符号可以在 PCRE 中用反斜杠转义，但 BRE/ERE 不能（它们只能在需要时转义）。对于 PCRE`] -`只需要在字符类中转义，但为了简单起见，我将它们保存在一个列表中
*   带引号的表达式字符串还必须对周围的引号字符进行转义，并且通常带有加倍的反斜杠（就像JavaScript 中的`"(\")(/)(\\.)"`vs一样）`/(")(\/)(\.)/`
*   除了转义，不同的正则表达式实现可能支持不同的修饰符、字符类、锚点、量词和其他特性。有关更多详细信息，请查看[regular-expressions.info](https://regex101.com/)，或使用[regex101.com](http://www.regular-expressions.info)实时测试您的表达式

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-12-29T23:42:45.043

不幸的是，实际上并没有一组转义码，因为它会根据您使用的语言而有所不同。

但是，保留一个像[正则表达式工具页面](http://www.regular-expressions.info/tools.html)或这个[正则表达式备忘](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)单这样的页面可以帮助您快速过滤掉一些东西。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-30T00:05:08.883

POSIX 识别正则表达式的多种变体 - 基本正则表达式 (BRE) 和扩展正则表达式 (ERE)。即便如此，由于 POSIX 标准化的实用程序的历史实现存在一些怪癖。

对于何时使用哪种表示法，甚至给定命令使用哪种表示法，没有一个简单的规则。

查看 Jeff Friedl 的[Mastering Regular Expressions](http://regex.info/)一书。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-29T23:44:33.370

不幸的是，像 ( 和 \( 之类的东西的含义在 Emacs 风格的正则表达式和大多数其他风格之间互换。所以如果你试图逃避这些，你可能会做与你想要的相反的事情。

所以你真的必须知道你想引用什么风格。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-29T23:37:02.967

真的，没有。大约有五亿种不同的正则表达式语法；它们似乎归结为 Perl、EMACS/GNU 和 AT&T，但我也总是感到惊讶。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-30T00:09:19.563

有时，您列出的字符无法进行简单的转义。例如，使用反斜杠转义括号在 sed 中的替换字符串的左侧不起作用，即

```
sed -e 's/foo\(bar/something_else/' 
```

我倾向于只使用一个简单的字符类定义，所以上面的表达式变成了

```
sed -e 's/foo[(]bar/something_else/' 
```

我发现它适用于大多数正则表达式实现。

顺便说一句，字符类是非常普通的正则表达式组件，因此它们倾向于在大多数需要在正则表达式中转义字符的情况下工作。

**编辑：**在下面的评论之后，只是想我会提到一个事实，即在查看正则表达式评估的行为时，您还必须考虑有限状态自动机和非有限状态自动机之间的区别。

您可能想看一下“闪亮的球书”，又名 Effective Perl（[净化亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0201419750)），特别是关于正则表达式的章节，以了解正则表达式引擎评估类型的差异。

并非所有世界都是PCRE！

[无论如何，与SNOBOL](http://en.wikipedia.org/wiki/SNOBOL)相比，正则表达式是如此笨拙！这**是**一门有趣的编程课程！连同[Simula](http://en.wikipedia.org/wiki/Simula_67)上的那个。

啊，在 70 年代后期在新南威尔士大学学习的乐趣！（-：

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-04-19T11:03:59.190

[https://perldoc.perl.org/perlre.html#Quoting-metacharacters](https://perldoc.perl.org/perlre.html#Quoting-metacharacters)和[https://perldoc.perl.org/functions/quotemeta.html](https://perldoc.perl.org/functions/quotemeta.html)

在官方文档中，这样的字符被称为元字符。引用示例：

```
my $regex = quotemeta($string)
s/$regex/something/ 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-10-01T11:22:23.150

对于 PHP，“在非字母数字前面加上“\”来指定它代表自己总是安全的。” - [http://php.net/manual/en/regexp.reference.escape.php](http://php.net/manual/en/regexp.reference.escape.php)。

除非它是“或”。：/

要在 PHP 中转义正则表达式模式变量（或部分变量），请使用 preg_quote()

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-05-05T14:45:45.643

要知道何时以及不尝试逃避什么，有必要准确理解字符串所经过的上下文链。您将指定从最远端到其最终目的地的字符串，即由正则表达式解析代码处理的内存。

请注意内存中的字符串是如何处理的： if 可以是代码中的纯字符串，也可以是输入到命令行的字符串，但 a 可以是交互式命令行或 shell 脚本文件中声明的命令行，或者在代码提到的内存中的变量内，或通过进一步评估的（字符串）参数，或包含通过任何封装动态生成的代码的字符串......

每个上下文都分配了一些具有特殊功能的字符。

当您想在不使用其特殊功能（上下文本地）的情况下按字面意思传递字符时，您必须为下一个上下文转义它......这可能需要一些其他转义字符，这些转义字符可能还需要在前面的上下文中转义。此外，可能还有字符编码之类的东西（最阴险的是 utf-8，因为它看起来像普通字符的 ASCII，但甚至可能由终端根据其设置进行可选解释，因此它的行为可能不同，然后是 HTML 的 encoding 属性/XML，有必要准确地理解这个过程。

例如，命令行中以 , 开头的正则表达式`perl -npe`需要转移到一组*exec*系统调用，该系统调用以管道形式连接文件句柄，每个 exec 系统调用都只有一个由（非转义）空格分隔的参数列表，可能还有管道（|）和重定向（> N> N>&M）、括号、和的交互式扩展`*`，`?``$(())`...（所有这些都是 *sh 使用的特殊字符，可能会在下一个上下文中干扰正则表达式的字符，但它们的计算顺序是：在命令行之前。命令行由程序为 bash/sh/csh/tcsh/zsh，本质上在双引号或单引号内，转义更简单，但不必在命令行中引用字符串，因为大多数空格必须以反斜杠作为前缀，而引号是没有必要保留字符 * 和 ? 的扩展功能，但是这会解析为与引号内不同的上下文。然后，当评估命令行时，在内存中获得的正则表达式（不是在命令行中写入的）接受与它相同的处理将在源文件中。对于正则表达式，方括号 [] 内有字符集上下文，perl 正则表达式可以被一大组非 alfa 数字字符引用（例如 m// 或 m:/better/for/path: ...）。

您在其他答案中有更多关于字符的详细信息，这些详细信息非常特定于最终的正则表达式上下文。正如我注意到你提到你发现正则表达式转义与尝试，这可能是因为不同的上下文有不同的字符集，混淆了你对尝试的记忆（通常反斜杠是在那些不同的上下文中用来转义文字字符而不是它的功能的字符）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-09-12T19:32:40.813

对于 Ionic (Typescript)，您必须使用双斜杠来转义字符。例如（这是为了匹配一些特殊字符）：

```
"^(?=.*[\\]\\[!¡\'=ªº\\-\\_ç@#$%^&*(),;\\.?\":{}|<>\+\\/])" 
```

注意这个`] [ - _ . /`字符。它们必须是双斜线。如果你不这样做，你的代码中就会出现类型错误。

# mysql - 从 C 程序调用 mysql SOURCE 命令

> ID：399085
> 
> 赞同：2
> 
> 时间：2008-12-29T23:34:40.630
> 
> 标签：mysql, c

我想使用 mysql.h 库从我的 C 程序执行一些存储在文本文件中的 mysql 语句。

我的倾向是执行以下操作，但这不起作用：

```
mysql_query(conn, "source test.mysql"); 
```

这是因为 SOURCE 命令本身不是 mysql 语句。

有没有办法以编程方式而不是从命令行调用 SOURCE 命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T23:46:08.343

该`source`命令是客户端程序中的内置命令`mysql`，它不是 SQL 命令。您最好的选择是`mysql`使用 C`system`函数（或等效函数）调用客户端程序，或者一次读取文件文本文件并将它们传递给您的查询函数。

# wpf - WPF HierarchicalDataTemplate 不会在属性更改时更新 ItemsSource

> ID：399101
> 
> 赞同：4
> 
> 时间：2008-12-29T23:43:10.410
> 
> 标签：wpf, data-binding, treeview

这是一些 XAML

```
<HierarchicalDataTemplate DataType="{x:Type data:FolderEntity}" 
  ItemsSource="{Binding Path=FolderEntities,UpdateSourceTrigger=PropertyChanged}">
  <Label Content="{Binding FolderName}"/>
</HierarchicalDataTemplate>
<TreeView/> 
```

data:FolderEntity 是一个 LINQ to SQL 数据类，它实现了 INotifyPropertyChanging 和 INotifyPropertyChanged 接口。

我的问题是，当我更改 FolderEntities 属性时，绑定不会更新。如果我更改 FolderName 属性，则与该项目对应的树节点将更改，但 FolderEntities 的集合不会。

我在想 WPF 检查集合引用是否已更改，或者 ItemsSource 对象是否必须是 ObservableCollection`1 才能工作？

非常感谢您对此事的任何意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T23:51:20.050

是的，底层集合 (FolderEntities) 需要作为`ObservableCollection<T>`HierarchicalDataTemplate 的一个，才能收到更改通知。或者是实现[INotifyCollectionChanged](http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.aspx)的​​集合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T10:42:53.870

这就是我让它工作的方式，谢谢马特！

```
public abstract class ObservableHierarchy<T>
{
    public T Current { get; set; }

    public ObservableCollection<ObservableHierarchy<T>> Children { get; set; }

    public ObservableHierarchy( T current, Func<T, IEnumerable<T>> expand )
    {
        this.Current = current;
        this.Children = new ObservableCollection<ObservableHierarchy<T>>();
        foreach ( var item in expand( current ) )
        {
            Children.Add( Create( item ) );
        }
    }

    protected abstract ObservableHierarchy<T> Create( T item );
} 
```

然后我将该基类专门用于我当前使用的任何数据类。

```
public class ObservableFolderHierarchy:
    ObservableHierarchy<FolderEntity>
{
    public ObservableFolderHierarchy( FolderEntity root )
        : base( root, x => x.FolderEntities )
    {
    }

    protected override ObservableHierarchy<FolderEntity> Create( FolderEntity item )
    {
        return new ObservableFolderHierarchy( item );
    }
} 
```

稍微修改了 XAML，效果很好！对 Current 的集合或属性的更改会相应地更新 TreeView。

```
<HierarchicalDataTemplate DataType="{x:Type ui:ObservableFolderHierarchy}"
 ItemsSource="{Binding Children}">
 <StackPanel Orientation="Horizontal">
  <Image Source="/UI/Resources/folder.png" Width="16" Height="16"/>
  <TextBlock Text="{Binding Current.FolderName}"/>
 </StackPanel>
</HierarchicalDataTemplate> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T01:16:50.550

马特是正确的。**要让数据绑定引擎收到集合内**的更改通知，它需要绑定到 ObservableCollection。

您绑定的是属性，并且仅在设置属性时才调用 PropertyChanged（来自 INotifyPropertyChanged），例如`FolderEntities = aNewValue;`，绑定引擎不知道集合中发生的任何更改。

# c++ - 为什么 c/c++ 浮点类型的命名如此奇怪？

> ID：399114
> 
> 赞同：16
> 
> 时间：2008-12-29T23:47:26.080
> 
> 标签：c++, c, floating-point, history, ieee-754

C++ 提供了三种浮点类型：float、double 和 long double。我很少在我的代码中使用浮点数，但是当我这样做时，我总是被无害的行上的警告所吸引，比如

```
float PiForSquares = 4.0; 
```

问题是文字 4.0 是双精度数，而不是浮点数——这很烦人。

对于整数类型，我们有 short int、int 和 long int，这非常简单。为什么 C 没有短浮点数、浮点数和长浮点数？“双”到底是从哪里来的？

编辑：浮动类型之间的关系似乎类似于整数。double 必须至少与 float 一样大，long double 至少与 double 一样大。没有其他精度/范围保证。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-30T02:45:02.383

术语“单精度”和“双精度”**起源于 FORTRAN**，并且在 C 发明时已经广泛使用。在 1970 年代早期的机器上，**单精度显着提高了效率**，并且与今天一样，使用的内存是双精度的一半。因此，它是浮点数**的合理默认值。**

`long double`当 IEEE 标准允许 Intel 80287 浮点芯片使用 80 位浮点数而不是经典的 64 位双精度时，才**添加了它。**

提问者对保证的看法不正确；今天几乎所有语言都保证以单精度（32 位）和双精度（64 位）**实现 IEEE 754 二进制浮点数。**有些还提供**扩展精度**（80 位），在 C 中显示为`long double`. 由 William Kahan 带头的 IEEE 浮点标准是良好工程对权宜之计的胜利：在当时的机器上，它看起来非常昂贵，但在今天的机器上，它非常便宜，而且 IEEE 浮点的可移植性和可预测性点数每年必须节省数以亿计的美元。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-29T23:49:36.840

您可能知道这一点，但您**可以**制作文字浮点数/长双精度数

```
 float f = 4.0f;
 long double f = 4.0l; 
```

Double 是默认设置，因为这是大多数人使用的。长双精度数可能是矫枉过正，或者浮点数的精度非常差。Double 适用于几乎所有应用程序。

为什么取名？有一天，我们只有 32 位浮点数（实际上我们只有定点数，但我离题了）。无论如何，当浮点成为现代架构中流行的特性时，C 可能是当时的主要语言，并给出了“浮点”这个名称。似乎有道理。

当时可能已经想到了double，但是在当时的cpu's/fp cpus中并没有真正实现，都是16位或者32位。一旦 double 被用于更多架构中，C 可能就会开始添加它。C 需要一个两倍于浮点数的东西的名称，因此我们得到了一个双精度数。然后有人需要更精确，我们认为他疯了。无论如何，我们添加了它。四元组（？）这个名字有点矫枉过正。长双已经足够好，没有人发出很大的噪音。

部分困惑是good-ole“int”似乎随着时间而改变。过去，“int”表示 16 位整数。但是，浮点数作为 32 位 IEEE 浮点数绑定到[IEEE 标准。](http://en.wikipedia.org/wiki/IEEE_754)出于这个原因，C 将 float 定义为 32 位，并使用 double 和 long double 来引用更长的标准。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-30T13:39:43.733

## 字面量

> 问题是文字 4.0 是双精度数，而不是浮点数——这很烦人。

对于常量，整数和浮点数之间存在一个重要区别。虽然决定使用哪种整数类型相对容易（您选择足够小的值来保存值，但有符号/无符号会增加一些复杂性），但使用浮点数并不是那么容易。许多值（包括像 0.1 这样的简单值）不能用浮点数精确表示，因此类型的选择不仅会影响性能，还会影响结果值。在这种情况下，C 语言设计者似乎更喜欢稳健性而不是性能，因此他们决定默认表示应该是更准确的表示。

## 历史

> 为什么 C 没有短浮点数、浮点数和长浮点数？“双”到底是从哪里来的？

术语“单精度”和“双精度”起源于 FORTRAN，并且在 C 发明时已经广泛使用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-29T23:50:17.510

首先，这些名称并非特定于 C++，但对于任何实现 IEEE 754 的浮点数据类型来说都是非常常见的做法。

“double”这个名称是指“双精度”，而 float 通常被称为“单精度”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-29T23:51:31.393

两种最常见的浮点格式使用 32 位和 64 位，较长的一种是第一种的“双倍”大小，因此被称为“双倍”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-01T21:49:21.437

它们被称为单精度和双精度，因为它们与处理器的自然大小（不确定术语）有关。因此，32 位处理器的单精度将是 32 位长，而它的双精度将是 64 位长的两倍。他们只是决定在 C 中将单精度类型称为“float”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-30T00:04:37.467

double 之所以这样命名，是因为它是 float 的“精度”的两倍。真的，这意味着它使用了两倍的浮点值空间——如果你的浮点数是 32 位的，那么你的双精度数将是 64 位的。

双精度这个名称有点用词不当，因为双精度浮点数的尾数精度为 52 位，而单精度浮点数的尾数精度为 23 位（双精度为 56）。更多关于浮点的信息：[Floating Point - Wikipedia](http://en.wikipedia.org/wiki/Floating_point)，包括底部的单精度和双精度浮点数文章链接。

long double 的名称可能与整数类型的长整数与短整数的传统相同，但在这种情况下，他们将其颠倒过来，因为 'int' 等同于 'long int'。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-30T02:17:04.890

在定点表示中，小数点后面有固定数量的数字（十进制表示中小数点的概括）。与浮点表示形成对比，其中小数点可以在所表示的数字的数字内移动或浮动。因此得名“浮点表示”。这被缩写为“浮动”。

在 K&R C 中，`float`指的是具有 32 位二进制表示`double`的浮点表示，并指的是具有 64 位二进制表示的浮点表示，或者是名称的两倍大小和来源。但是，最初的 K&R 规范要求所有浮点计算都以双精度完成。

在最初的 IEEE 754 标准 (IEEE 754-1985)（浮点表示和算术的黄金标准）中，为单精度和双精度浮点数的二进制表示提供了定义。双精度数的名称恰如其分，因为它们的位数是单精度数的两倍。

有关浮点表示的详细信息，请阅读 David Goldberg 的文章[What](http://docs.sun.com/source/806-3568/ncg_goldberg.html) *Every Computer Scientist Should Know About Floating-Point Arithmetic*。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-01T23:03:48.727

hence the %f for a float type, and a %lf for a long float which is the same as double.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-29T23:52:23.230

double 是“双精度”的缩写。我猜，long double 来自于不想在处理器上开始出现精度更高的浮点类型时添加另一个关键字。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-30T00:04:23.893

好的，从历史上看，它曾经是这样的：

用于 C 的原始机器将 16 位字分成 2 个字节，而一个 char 是一个字节。地址是 16 位，`sizeof(foo*)`2`sizeof(char)`也是，1。int 是 16 位，`sizeof(int)`2 也是。然后出现了 VAX（扩展寻址）机器，地址是 32 位。一个 char 仍然是 1 个字节，但`sizeof(foo*)`现在是 4 个。

有一些混乱，在伯克利编译器中解决了，所以一个 short 现在是 2 个字节，一个 int 是 4 个字节，因为它们非常适合高效的代码。long 变成了 8 个字节，因为 8 字节块有一种有效的寻址方法——称为*双字*。4 字节块是*字*，当然，2 字节块是*半字*。

浮点数的实现使得它们适合单字或双字。为了保持一致，双字浮点数被称为“双”。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-30T01:40:34.293

应该注意的是，`double`不必能够保持比`float`;更大的值。它只需要更*精确*。

# .net - Windows 机器上的产品安装和配置

> ID：399118
> 
> 赞同：0
> 
> 时间：2008-12-29T23:49:12.287
> 
> 标签：.net, windows, installation, wix

我正在开发一个由 Web 应用程序和 Windows 服务组成的 .NET 3.5 项目。两者都需要部署在服务器机器上。

我使用 Wix 3 创建了一个 msi 包，它安装应用程序文件、创建快捷方式并注册服务。

我的下一个任务是实现以下内容：

*   允许通过向导式 GUI 配置 Windows 服务的安装后步骤
*   允许从文件加载安装设置的预安装步骤
*   允许将配置备份到文件的预**卸载步骤**

我看到了两个选项：

*   通过自定义操作调整 msi 以执行我想要的操作
*   为 msi (Setup.exe) 创建一个包装器，它将处理所有自定义任务并使用 msiexec 在后台静默运行 msi 包

理想情况下。我想选择选项 2。你的想法是什么？

任何建议将不胜感激。

谢谢，

阿尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-08T22:35:58.563

如果通过添加/删除程序或 msiexec 使用产品 ID 删除，围绕 msi 的包装器将无法处理任务 #3。我会使用自定义操作，或者可以由 msi 生成的辅助实用程序。

这取决于服务需要的配置量。对于我们一些只需要在连接字符串中更新服务器名称的小型配置文件，我们使用 util:XmlFile 元素在安装期间更新文件。

我们还有一个更复杂的配置实用程序，我们有条件地在安装结束时使用

要从文件加载设置，您可以使用自定义操作来执行此操作，然后使用这些设置更新配置文件在安装时使用 XmlFile 或自定义操作。或者将“从文件加载设置”作为向导 gui 的选项并启动该安装后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-11T10:52:12.033

最后我决定使用安装后配置实用程序创建一个 MSI。

不像我想要的那么优雅，但会确保安装和卸载清理以事务方式正确完成。

# python - 使用 Python 示例发送电子邮件失败

> ID：399129
> 
> 赞同：22
> 
> 时间：2008-12-29T23:51:33.247
> 
> 标签：python, email, smtplib

我一直在尝试（并且失败）弄清楚如何通过 Python 发送电子邮件。

从这里尝试示例：http: [//docs.python.org/library/smtplib.html#smtplib.SMTP](http://docs.python.org/library/smtplib.html#smtplib.SMTP)

但`server = smtplib.SMTP_SSL('smtp.gmail.com', 465)`在我收到关于没有 SSL 连接的反弹后添加了这条线。

现在我得到了这个：

```
Traceback (most recent call last):
  File "C:/Python26/08_emailconnects/12_29_EmailSendExample_NotWorkingYet.py", line 37, in <module>
    server = smtplib.SMTP('smtp.gmail.com', 65)
  File "C:\Python26\lib\smtplib.py", line 239, in __init__
    (code, msg) = self.connect(host, port)
  File "C:\Python26\lib\smtplib.py", line 295, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File "C:\Python26\lib\smtplib.py", line 273, in _get_socket
    return socket.create_connection((port, host), timeout)
  File "C:\Python26\lib\socket.py", line 512, in create_connection
    raise error, msg
error: [Errno 10060] A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond
>>> 
```

想法？

* * *

server = smtplib.SMTP("smtp.google.com", 495) 给我一个超时错误。只是 smtplib.smtp("smtp.google.com", 495) 给了我“SSLError: [Errno 1] _ssl.c:480: error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol”（见下文）。

我正在尝试不同的端口，现在我遇到了一个全新的错误。我只会发布整个代码，我可能会犯一些新手错误。

"

```
import smtplib

mailuser = 'MYEMAIL@gmail.com'

mailpasswd = 'MYPASSWORD'

fromaddr = 'MYEMAIL@gmail.com'

toaddrs = 'MYEMAIL2@gmail.com'

msg = 'Hooooorah!'

print msg

server = smtplib.SMTP_SSL('smtp.google.com')

server = smtplib.SMTP_SSL_PORT=587

server.user(mailuser)

server.pass_(mailpasswd)

server.set_debuglevel(1)

server.sendmail(fromaddr, toaddrs, msg)

server.quit() 
```

"

然后我收到此错误消息：“

```
Traceback (most recent call last):
  File "C:/Python26/08_emailconnects/12_29_eMAILSendtryin_stripped.py", line 16, in <module>
    server = smtplib.SMTP_SSL('smtp.google.com')
  File "C:\Python26\lib\smtplib.py", line 749, in __init__
    SMTP.__init__(self, host, port, local_hostname, timeout)
  File "C:\Python26\lib\smtplib.py", line 239, in __init__
    (code, msg) = self.connect(host, port)
  File "C:\Python26\lib\smtplib.py", line 295, in connect
    self.sock = self._get_socket(host, port, self.timeout)
  File "C:\Python26\lib\smtplib.py", line 755, in _get_socket
    self.sock = ssl.wrap_socket(self.sock, self.keyfile, self.certfile)
  File "C:\Python26\lib\ssl.py", line 350, in wrap_socket
    suppress_ragged_eofs=suppress_ragged_eofs)
  File "C:\Python26\lib\ssl.py", line 118, in __init__
    self.do_handshake()
  File "C:\Python26\lib\ssl.py", line 293, in do_handshake
    self._sslobj.do_handshake()
SSLError: [Errno 1] _ssl.c:480: error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol 
```

"

请注意，实际上看起来像“server = smtplib.SMTPSSLPORT=587”的实际上是“server = smtplib.SMTP *underscore* SSL *underscore* PORT=587”，这里有一些格式化的事情。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-30T00:48:19.343

以下代码适用于我：

```
import smtplib

FROMADDR = "my.real.address@gmail.com"
LOGIN    = FROMADDR
PASSWORD = "my.real.password"
TOADDRS  = ["my.real.address@gmail.com"]
SUBJECT  = "Test"

msg = ("From: %s\r\nTo: %s\r\nSubject: %s\r\n\r\n"
       % (FROMADDR, ", ".join(TOADDRS), SUBJECT) )
msg += "some text\r\n"

server = smtplib.SMTP('smtp.gmail.com', 587)
server.set_debuglevel(1)
server.ehlo()
server.starttls()
server.login(LOGIN, PASSWORD)
server.sendmail(FROMADDR, TOADDRS, msg)
server.quit() 
```

我正在使用 Python 2.5.2。

**编辑**：按照 ΤZΩΤZΙΟΥ 的建议将端口从 25 更改为 587，并删除了第二个 ehlo()。现在我很想知道为什么 25 端口可以在我的机器上*完美*运行（而 465 端口*不能*）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-31T01:41:13.730

使用 SSL 连接到 GMail 的正确方法是：

```
server = smtplib.SMTP('smtp.gmail.com', 587) 
```

端口 465 似乎会导致延迟。这两个端口都在[GMail FAQ](http://mail.google.com/support/bin/answer.py?hl=en&answer=78799)中指定。

请注意，对于基于 SSL 的 SMTP，使用端口 587 更为常见，虽然这只是一些琐碎的信息，但没有其他实际用途。

*此答案作为社区 wiki 提供，以便被选为“the”答案。请根据需要改进。*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-30T05:35:03.350

Here's a simple throw away solution. Meant to paste this earlier, but fell asleep at my chair.

```
 import smtplib
import email
import os

username = "user@gmail.com"
passwd = "password"

def mail(to, subject, text, attach):
   msg = MIMEMultipart()

   msg['From'] = username
   msg['To'] = to
   msg['Subject'] = subject

   msg.attach(MIMEText(text)) 

   part = MIMEBase('application', 'octet-stream')
   part.set_payload(open(attach, 'rb').read())
   Encoders.encode_base64(part)
   part.add_header('Content-Disposition',
           'attachment; filename="%s"' % os.path.basename(attach))
   msg.attach(part)

   server = smtplib.SMTP("smtp.gmail.com", 495)
   server.ehlo()
   server.starttls()
   server.ehlo()
   server.login(username, passwd)
   server.sendmail(username, to, msg.as_string())
   server.close()

mail("you", "hi", "hi", "webcam.jpg") 
```

It's my assumption that most people on this thread that have had successful attempts with their code aren't on win32\. ;)

*edit: See [http://docs.python.org/library/email-examples.html](http://docs.python.org/library/email-examples.html) for some good "official" examples.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-05T11:01:06.077

问题是由于[Python 中的错误](http://bugs.python.org/issue4066)造成的。尝试使用 SMTP_SSL 创建连接将失败，并显示“SMTPServerDisconnected：请先运行 connect()”。

已提交修复，因此您可以修补本地副本。请参阅名为“smtplib_72551.diff”的附件。

（注意：SMTP_SSL 是 Python 2.6/3.0 及更高版本中添加的新类。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-30T17:30:53.437

好的，发现这行代码可以解决问题！

服务器 = smtplib.SMTP('smtp.gmail.com', 587 )

结果是 GMAIL 不支持端口 25 上的 SSL（并且端口 465 由于某种原因导致挂起）。

多谢你们！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-29T23:59:19.457

可能端口不正确？我将**587**用于**smtp.gmail.com**，它可以工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-29T23:59:31.343

你应该检查你的端口，我不确定谷歌的 SMTP 端口是 65，这可以解释超时。

修改您的来源，如下所示：

smtplib.SMTP_SSL('smtp.google.com', 465)

但是，如果您确定它应该可以工作，但它不能工作，那么 smtplib.SMTP_SSL 似乎存在一些问题，这里有一个可用的[补丁](http://bugs.python.org/issue4470 "第 4470 期")。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-06-02T12:04:50.657

```
from smtplib import SMTP_SSL as SMTP
from email.mime.text import MIMEText

HOST = 'smtp.gmail.com'
PORT = 465

USERNAME = 'oltjano13@gmail.com'
PASSWORD = ''

SENDER = 'oltjano13@gmail.com'
RECIPIENT = 'oltjano13@gmail.com'

text_subtype = 'plain'

with open('textfile', 'rb') as f:
    msg = MIMEText(f.read(), text_subtype)

msg['Subject'] = 'Python Script'
msg['From'] = SENDER
msg['To'] = RECIPIENT

try:
    connection = SMTP(HOST, PORT)
    connection.login(USERNAME, PASSWORD)
    connection.sendmail(SENDER, RECIPIENT, msg.as_string())
except Exception, e:
    print(e) 
```

上面的代码对我来说很好。如您所见，`PORT = 465`由于我使用的是`SSL`. 如果您打算使用该端口`587`，则`TLS`需要。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-02-05T22:08:59.667

```
import smtplib

content = 'example email stuff here'

mail = smtplib.SMTP('smtp.gmail.com', 587)

mail.ehlo()

mail.starttls()

mail.login('email@gmail.com','password')

mail.sendmail('email@gmail.com', 'email@yahoo.com', content)

mail.close() 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-19T09:00:48.757

然后我尝试通过 smtp.gmail.com 发送电子邮件，我遇到了同样的错误。在我的情况下，Internet 提供商关闭了端口 25（以及 587 和其他端口）用于从 IP 地址（从我的网络）到外部网络的传出连接，只为其邮件服务器打开第 25 个端口。所以，首先尝试：

`telnet smtp.gmail.com 587`

（587 你的端口）

通过这样做，您可以了解您的端口是否被 Internet 提供商关闭。您可以联系您的提供商并要求他们为您打开一个端口。我的解决方案是连接到其他网络（使用开放端口）这是我使用的代码：

```
gmailaddress = "youremailadress@gmail.com"
gmailpassword = "7777777"
mailto = "youremailadress@gmail.com"
msg = input("What is your message? \n ")
mailServer = smtplib.SMTP('smtp.gmail.com' , 587)
mailServer.starttls()
mailServer.login(gmailaddress , gmailpassword)
mailServer.sendmail(gmailaddress, mailto , msg)
print(" \n Sent!")
mailServer.quit()``` 
```

# naming-conventions - 我应该重命名我的按钮事件处理程序名称吗？

> ID：399135
> 
> 赞同：1
> 
> 时间：2008-12-29T23:55:30.010
> 
> 标签：naming-conventions

当使用 Visual Studio（虽然理想情况下这可以应用于一般情况）并双击我创建的按钮时，自动生成的事件处理程序代码使用以下签名：

```
Protected Sub btnSubmitRequest_Click(ByVal sender As Object, ByVal e As EventArgs) Handles btnSubmitRequest.Click

End Sub 
```

最好保留此方法的名称，还是应该将其重命名为更具描述性的名称，例如 SubmitNewEmployeeRequest？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-29T23:59:54.510

创建另一个名为`SubmitNewEmployeeRequest`. 在`btnSubmitRequest_Click`，呼叫`SubmitNewEmployeeRequest`。这是最合乎逻辑的职责分离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T00:10:25.300

此外，如果您在创建处理程序之前更改 IDE 中按钮的名称，处理程序将获得更好的默认名称。您的按钮名称当前为 btnSubmitRequest，您可以将其更改为更具体的 btnSubmitNewEmployeeRequest，然后生成处理程序。

您应该命名您的控件，并保持控件和处理程序之间的命名一致。
我通常会在使用的上下文中命名它们，也就是说，如果你在

*   Employee Request 表单，那么按钮只需命名为 SubmitRequest。
*   Do Stuff to Directory components form，然后按钮应该像 SubmitNewEmployeeRequest 那样更具描述性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T00:00:54.243

好吧，我个人将其保留，以便我可以快速看到它是一个事件处理程序，特别是一个单击事件处理程序。但是，我倾向于只使用一行代码来调用（在本例中为您的）SubmitNewEmployeeRequest，因为它也可以从某些上下文菜单中调用，或者响应其他事件而触发。

# php - 在 PHP/HTML 中交替行颜色的最简单方法？

> ID：399137
> 
> 赞同：26
> 
> 时间：2008-12-29T23:56:38.277
> 
> 标签：php, html, css, colors

这是我的一个 PHP 示例。谁能找到更短/更简单的方法来做到这一点？

```
<? foreach($posts as $post){?>
    <div class="<?=($c++%2==1)?‘odd’:NULL?>">
        <?=$post?>
    </div>
<? }?>

<style>
    .odd{background-color:red;}
</style> 
```

其他语言的例子也会很有趣。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-12-30T00:03:31.213

从根本上说 - 不。这很容易。您可能会将它改写得更短/更清晰，但想法是一样的。我会这样写：

```
$c = true; // Let's not forget to initialize our variables, shall we?
foreach($posts as $post)
    echo '<div'.(($c = !$c)?' class="odd"':'').">$post</div>"; 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-30T00:23:07.333

如果您想要更少的内联 PHP，一个很好的方法是通过 JavaScript。

使用 jQuery，它很简单：

```
<script type="text/javascript">
$('div:odd').css('background-color', 'red');
</script> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-30T00:14:01.113

使用 CSS3，您可以执行以下操作：

```
div:nth-child(odd)
{
  background-color: red
} 
```

但如果您真的希望您的用户看到颜色，最好不要使用几年...

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-30T00:06:34.187

Smarty 内置：

```
{section name=rows loop=$data}
<tr class="{cycle values="odd,even"}">
   <td>{$data[rows]}</td>
</tr>
{/section} 
```

Django 也是如此：

```
{% for o in some_list %}
    <tr class="{% cycle 'row1' 'row2' %}">
        ...
    </tr>
{% endfor %} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-31T01:53:43.453

我总是将我的斑马行命名为“row0”和“row1”——这使代码更简单一些。

```
<?php  // you should always use the full opening tag for compatibility
$i = 0;
foreach ($rows as $row) {
    echo '<tr class="row' . ($i++ % 2) . '">...</tr>';
} 
?> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-30T00:03:38.217

也许是一个带有静态变量的函数？

```
<?php

function alternate_row_color($css_class) {
    static $show = true;

    $show = !$show;

    if ($show) {
        return $css_class;
    } else {
        return NULL;
    }
}

?> 
```

然后使用它（使用您的示例）：

```
<?php foreach($posts as $post) { ?>
    <div class="<?=alternate_row_color('odd')?>">
        <?=$post?>
    </div>
<?php } ?> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-30T00:06:12.377

```
<?php $alt = true; foreach ($posts as $post): $alt = !$alt; ?>
<div<?php echo $alt ? ' class="odd"' : ''; ?>>
    <!-- Content --> 
</div>  
<?php endforeach ?> 
```

将是最简单和最清晰的方法。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-30T00:40:12.247

只是为了好玩

假设您可以使用 CSS3 选择器，您可以执行类似的操作

```
<div class="posts">
<? foreach($posts as $post){?>
    <div>
        <?=$post?>
    </div>
<? }?>
</div>

<style>
    div.posts div:odd{background-color:red;}
</style> 
```

即使有 CSS2 支持和 mootools（javascript 库），您也可以用这个 javascript 替换样式

```
<script type="text/javascript">
    // obviously this script line should go in a js file in a onload (or onDomReady) function
    $$('div.posts div:odd').setStyle('background-color','red');
</script> 
```

如果您除了 php a 它什么都没有，您可以使用数组简化代码

```
<? $isodd=array('','odd');
   $c=0;
   foreach($posts as $post){?>
    <div class="<?=$isodd[$c++%2]?>">
        <?=$post?>
    </div>
<? }?> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-30T06:40:43.140

您可以将逻辑封装如下：

```
<?php

class ListCycler {
    private $cols, $offs, $len;

    // expects two or more string parameters
    public function __construct() {
        $this->offs = -1;
        $this->len = func_num_args();
        $this->cols = func_get_args();

        foreach($this->cols as &$c)
            $c = trim(strval($c));
    }

    // the object auto-increments every time it is read
    public function __toString() {
        $this->offs = ($this->offs+1) % $this->len;
        return $this->cols[ $this->offs ];
    }
}
?>
<html>
<head>
  <style>
    ul#posts li.odd { background-color:red; }
    ul#posts li.even { background-color:white; }
  </style>
</head>
<body>
  <div>
    <h3>Posts:</h3>
    <ul id="posts"><?php
        $rc = new ListCycler('odd','even');
        foreach($posts as $p)
            echo "<li class='$rc'>$p</li>";
    ?></ul>
  </div>
</body>
</html> 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-30T00:03:50.353

它已经足够短了，但我可能会将它包装成一些具有明确名称的辅助函数。这样一来，发生的事情就更明显了，您不必在需要它的所有模板中重复该逻辑。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-30T00:14:41.127

如果您想在显示端执行此操作并且熟悉或已经在使用 javascript，像 jQuery 这样的库通常会有[:odd](http://docs.jquery.com/Selectors/odd "：奇怪的")和[:even](http://docs.jquery.com/Selectors/even "：甚至")选择器，然后您可以连接到添加特定[样式属性](http://docs.jquery.com/CSS/css#namevalue "样式属性")或更一般地连接到 CSS通过[添加类](http://docs.jquery.com/Attributes/addClass#class "添加类")。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-30T10:03:04.137

另一方面，要在两个值*a*和*b*之间交替，在循环中执行此操作的好方法是：

```
x = a;
while ( true ) {
    x = a + b - x;
} 
```

您也可以在不加减法的情况下执行此操作：

```
x = a ^ b ^ x; 
```

其中*^*是 XOR 运算。

如果你只想在 0 和 1 之间交替，你可以这样做：

```
x = 0;
while ( true ) {
    x = !x;
} 
```

您当然可以使用*x*作为颜色、CSS 样式类等的索引。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-06-27T18:29:20.043

```
function row_color($cnt,$even,$odd) { 
echo ($cnt%2) ? "<tr bgcolor=\"$odd\">" : "<tr bgcolor=\"$even\">"; 
} 
```

如何使用：

```
$cnt=0;
while ($row = mysql_fetch_array ($result)) {
row_color($cnt++,"e0e0e0","FFFFFF");
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-08-25T21:10:39.480

您可以滥用 $GLOBAL 范围来存储当前选定的类状态，请参见下面的 table_row_toggle() 函数。是的，我知道滥用 $GLOBAL 范围很脏，但是，嘿，我们是来解决问题的，不是吗？:)

在 HTML 中调用表格行切换功能：

```
<tr <? table_row_toggle(); ?>> 
```

PHP中的函数：

```
/* function to toggle row colors in tables */
function table_row_toggle() {
    /* check if $trclass is defined in caller */
    if(array_key_exists('trclass', $GLOBALS)) {
        $trclass = $GLOBALS['trclass'];
    }   

    /* toggle between row1 and row2 */
    if(!isset($trclass) || $trclass == 'row2') {
        $trclass = 'row1';
    } else {
        $trclass = 'row2';
    }   

    /* set $trclass in caller */
    $GLOBALS['trclass'] = $trclass;

    /* write the desired class to the caller */
    echo ' class="' . $trclass . '"';
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-01-17T23:05:05.373

```
 <?php   ($i%2==1) ? $bgc='#999999' : $bgc='#FFFFFF'; ?>
    '<div bgcolor=" bgcolor='.$bgc.'">'; 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-05-29T12:08:13.260

在 Vilx 上找到，但总是尽量减少速度（页面重量）

```
<tr class="'.(($c = !$c)?'odd':'even').'"> 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-12-31T01:44:19.730

一直在使用这样的东西：

```
<?php
function cycle(&$arr) {
    $arr[] = array_shift($arr);
    return end($arr); 
}

$oddEven = array('odd', 'even');
echo cycle($oddEven)."\n";
echo cycle($oddEven)."\n";
echo cycle($oddEven)."\n"; 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2011-04-27T17:13:14.047

一个简单的小功能，对我很有效。

```
 <?php 
class alternating_rows()
{
    private $cycler = true;
//------------------------------------------------------------------------------
    function rowclass($row0,$row1)
    {
        $this->cycler = !$this->cycler;//toggle the cycler
        $class=($this->cycler)?$row0:$row1;
        return $class;
    }// end function rowclass
//------------------------------------------------------------------------------    

}//end class alternating rows
?>
<?php $tablerows= new alternating_rows();?>
<table>
  <tr>
    <th scope="col">Heading 1</th>
    <th scope="col">Heading 2</th>
  </tr>
  <?php foreach ($dataset as $row){?>
  <tr class="<?php echo $tablerows->rowclass("oddrow","evenrow"); ?>">
    <td>some data</td>
    <td>some more data</td>
  </tr>
  <?php } //end foreach?>
</table> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-11-08T18:15:28.807

在 PHP 中，我使用以下代码：

```
function alternate($sEven = "even", $sOdd = "odd")
{
    static $iCount;
    return ($iCount++ & 1) ? $sOdd :$sEven;
}

for($i = 0; $i< 5; $i++)
echo alternate();

/*output:

even
odd
even
odd
even

*/ 
```

资料来源：[http ://sklueh.de/2013/11/einfache-alternierung-mit-php/](http://sklueh.de/2013/11/einfache-alternierung-mit-php/)

# silverlight - 如何从 Expression Design 导出到 Silverlight XAML 并保留向量相关性？

> ID：399151
> 
> 赞同：0
> 
> 时间：2008-12-30T00:01:36.147
> 
> 标签：silverlight, xaml, export, blend

我正在尝试将一些准备好的资产从 Expression Design 2 导出到 .XAML，最终目的地是 Blend 2 进行布局，但是我找不到可靠的方法来保持在这些资产到达 Blend 时调整它们大小的能力。查看导出的最终产品，生成的 XAML 包装在 Canvas 中（无论我是否在导出中选择该选项），并带有硬编码的 Left/Top 附加属性和 Width/Height。这意味着我导出资源的任何尺寸都将变为其固定尺寸，并且我不再能够在 Blend 中控制其尺寸。

如何导出我的资产并保持其动态可调整性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T00:15:40.627

在 Blend 中对 Canvas 应用缩放变换。

# c# - HTTP 状态 403：使用证书对 ASP.NET Web 服务进行身份验证的禁止异常

> ID：399155
> 
> 赞同：2
> 
> 时间：2008-12-30T00:02:59.747
> 
> 标签：c#, asp.net, web-services, authentication, certificate

我几天前发布了关于 Web 服务的[访问控制（Web 服务的访问控制](https://stackoverflow.com/questions/390853/access-control-to-web-service)）。简而言之，我在**//service/webservice**上部署了一个 ASP.NET Web 服务，我希望**//web1**上的 ASP.NET Web 应用程序 (app1)能够通过证书身份验证访问 Web 服务。我不断收到*System.Net.WebException: The request failed with HTTP status 403: Forbidden* exception。以下是我的设置：

关于证书出口；

*   我从 LocalMachine 商店导出了颁发给**//service**的服务器证书并将其保存为 service.cer。
*   我还从 LocalMachine 商店导出了颁发给**//web1**的客户端证书并将其保存为 web1.cer

在**//service/webservice**上设置：

*   在目录安全上，未选中匿名访问和所有身份验证访问（集成 Windows 访问、摘要式身份验证和基本身份验证）。
*   在安全通信上，选中所需的安全通道 (SSL)、需要 128 位加密、需要客户端证书和启用客户端证书映射。然后，我将 web1.cer 映射到一个 AD 帐户**MyDomain/user**，该帐户有权访问**//service/webservice**
*   对于**//service/webservice/WebService.asmx**，`<authentication mode="Windows" />`在 web.config 上设置

**//web1/app1**上的设置

 ***   在 web.config 上设置`<authentication mode="Windows" />`和`<identity impersonate="true" />`
*   在 VS2008 中，我将 web 引用添加到**//service/webservice/WebService.asmx**并将其命名为 WService
*   在**//web1/app1/default.aspx.cs**，我有这个：

```
using System.Security.Cryptography.X509Certificates;
    using System.Net;
        WService.WebService ws = new WService.WebService();
        ServicePointManager.ServerCertificateValidationCallback = delegate(Object sender1, X509Certificate cert, X509Chain chain, System.Net.Security.SslPolicyErrors errors) { return true; };
//I was a bit confused here on which certificate I should use so I have tried both service.cer and web1.cer but still got the same error
        X509Certificate x509 = X509Certificate.CreateFromCertFile(@"C:\Certificates\service.cer"); 
        ws.ClientCertificates.Add(x509);
        ws.DoSomething(); 
```

*   我运行 WinHttpCertCfg.exe 以授予对 LocalMachine for ASPNET 帐户中两个证书的访问权限

我去了**[https://service/webservice/WebService.asmx](https://service/webservice/WebService.asmx)**并被提示提供客户端证书，然后我就通过了。但是，如果我访问**[https://web1/app1/default.aspx](https://web1/app1/default.aspx)**（它将调用 Web 服务），我会得到 HTTP 状态 403 异常。

我错过了什么？我认为问题是因为**//web1/app1/default.aspx.cs**未能传输证书。如果这是问题所在，我该怎么做？我在 VS 2008 和 ASP.NET 3.5 上构建了 asmx 和 aspx。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-23T18:54:03.450

确保您的客户端证书被请求为“客户端身份验证”的“计算机”模板证书，否则它将不起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-04T00:54:21.673

听起来 SSL 证书无法对 Web 服务客户端进行身份验证。一个很好的检查是，如果您从客户端计算机访问服务并在浏览器中收到有关 SSL 证书的警报，您的服务将不会使用证书进行身份验证（证书不受信任）。不是证书不起作用，只是不可信。

如果服务是跨机器的，您可能必须设置证书颁发机构（这可能有助于[http://www.petri.co.il/install_windows_server_2003_ca.htm](http://www.petri.co.il/install_windows_server_2003_ca.htm)）并将其添加为客户端计算机上的受信任发布者。这也可能有助于[http://support.microsoft.com/kb/901183](http://support.microsoft.com/kb/901183)。

另一种选择是简单地不验证 SSL，请参阅： http: [//geekswithblogs.net/jwhitehorn/archive/2006/09/20/91657.aspx](http://geekswithblogs.net/jwhitehorn/archive/2006/09/20/91657.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-25T13:17:03.063

当我遇到这个问题时，原来我使用的客户端证书/密钥对是由当前用户存储而不是本地机器存储中的中间 CA 签名的。如果您在登录时检查了证书，但 IIS 工作进程看不到中间 CA，这一切看起来都很好。因此，Web 服务调用未随请求提供证书。您可以通过检查服务器 Web 日志的`403 7 5`响应来验证这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-09-18T23:03:18.543

确保模拟的用户有权访问正在使用的证书存储。

# exchange-server - 从电子邮件（或数千封电子邮件）中提取数据 [基于 Exchange]

> ID：399165
> 
> 赞同：5
> 
> 时间：2008-12-30T00:05:27.057
> 
> 标签：exchange-server, text-extraction

祝福他们，我的营销部门决定在人们通过网页进入的地方进行抽奖。这很好，但信息不会存储到任何类型的数据库中，而是作为电子邮件发送到交换邮箱。伟大的。

我的挑战是从这些电子邮件中提取条目（和营销信息）并将它们存储在更有用的地方，比如平面文件或 CSV。唯一的优点是电子邮件具有高度一致的格式。

我确信我可以花时间将所有电子邮件保存到文件中，然后编写一个应用程序来处理它们，但我希望有一个更优雅的解决方案。我可以以编程方式访问交换邮箱，阅读所有电子邮件，然后保存这些数据吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-31T20:37:16.523

这是我使用的代码....

```
Private Sub btnGo_Click()
  If ComboBox1.SelText <> "" Then
    Dim objOutlook As New Outlook.Application
    Dim objNameSpace As Outlook.NameSpace
    Dim objInbox As MAPIFolder
    Dim objMail As mailItem

    //Get the MAPI reference
    Set objNameSpace = objOutlook.GetNamespace("MAPI")

    //Pick up the Inbox
    Set objInbox = objNameSpace.GetDefaultFolder(olFolderInbox)
    For Each objFolder In objInbox.Folders
       If (objFolder.Name = ComboBox1.SelText) Then
          Set objInbox = objFolder
       End If
    Next objFolder

    //Loop through the items in the Inbox
    Dim count As Integer
    count = 1

    For Each objMail In objInbox.Items
       lblStatus.Caption = "Count: " + CStr(count)
       If (CheckBox1.Value = False Or objMail.UnRead = True) Then
          ProcessMailItem (objMail.Body)
          count = count + 1
          objMail.UnRead = False
       End If
    Next objMail
  End If
End Sub

Private Sub ProcessMailItem(strBody As String)
   Open "C:\file.txt" For Append As 1

   Dim strTmp As String
   strTmp = Replace(strBody, vbNewLine, " ")
   strTmp = Replace(strTmp, vbCrLf, " ")
   strTmp = Replace(strTmp, Chr(13) & Chr(10), " ")
   strTmp = Replace(strTmp, ",", "_")

   //Extra Processing went here (Deleted for brevity)
   Print #1, strTmp
   Close #1

End Sub

Private Function Strip(strStart As String, strEnd As String, strBody As String) As String
   Dim iStart As Integer
   Dim iEnd As Integer

   iStart = InStr(strBody, strStart) + Len(strStart)
   If (strEnd = "xxx") Then
      iEnd = Len(strBody)
   Else
      iEnd = InStr(strBody, strEnd) - 1
   End If

   Strip = LTrim(RTrim(Mid(strBody, iStart, iEnd - iStart)))
End Function

Private Sub UserForm_Initialize()
  Dim objOutlook As New Outlook.Application
  Dim objNameSpace As Outlook.NameSpace
  Dim objInbox As MAPIFolder
  Dim objFolder As MAPIFolder

  //Get the MAPI reference
  Set objNameSpace = objOutlook.GetNamespace("MAPI")

  //Pick up the Inbox
  Set objInbox = objNameSpace.GetDefaultFolder(olFolderInbox)

  //Loop through the folders under the Inbox
  For Each objFolder In objInbox.Folders
    ComboBox1.AddItem objFolder.Name
  Next objFolder
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T00:17:19.360

有很多不同的方法可以获取 Exchange 邮箱中的消息，但由于这似乎是你只想运行一次以提取数据的东西，我建议编写一个 VBA 宏以在 Outlook 本身内部运行（在 Outlook 中打开了有问题的 Exchange 邮箱）。遍历特定邮箱中的邮件项目并从中读取正文非常容易。然后，您可以编写一个仅包含您想要的内容的文本文件。

# php - 如何从 PHP 代码中获取 Flash 视频文件的尺寸？

> ID：399180
> 
> 赞同：3
> 
> 时间：2008-12-30T00:13:20.630
> 
> 标签：php, flash

我有一个应用程序，用户可以上传任何大小的视频文件，我希望能够从 PHP 脚本确定 Flash 视频文件（flv 或 f4v）的高度/宽度，以便我可以调整播放器的大小适当地。我喜欢纯 PHP 解决方案，但我愿意使用命令行工具并解析输出（如果存在这样的工具）。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T00:17:00.920

[ffmpeg](http://www.ffmpeg.org/)可能是你最好的选择，它甚至还有一个[php 模块](http://ffmpeg-php.sourceforge.net/)。

ffmpeg -i "文件名"

或者，您可以通过打开文件并读取元信息直接从 flv 文件中读取信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T03:27:59.317

如果您因为无法控制服务器而无法使用 ffmpeg，或者如果您想要 PHP 解决方案，请查看[getID3](http://www.getid3.org/)，有一个[FLV 模块](http://www.getid3.org/source/module.audio-video.flv.phps)应该返回一个分辨率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-03T11:12:15.983

还有[flv4php](http://code.google.com/p/flv4php/)。

如果文件的标题包含视频的尺寸（可能并非总是如此），您还可以使用以下代码：

```
function flvdim($name) {
    $file = @fopen($name, 'rb');
    if($file === false)
        return false;

    $header = fread($file, 2048);
    fclose($file);
    if($header === false)
        return false;

    return array(
        'width' => flvdim_get($header, 'width'),
        'height' => flvdim_get($header, 'height')
    );
}

function flvdim_get($header, $field) {
    $pos = strpos($header, $field);
    if($pos === false)
        return false;

    $pos += strlen($field) + 2;
    return flvdim_decode(ord($header[$pos]), ord($header[$pos + 1]));
}

function flvdim_decode($byte1, $byte2) {
    $high1 = $byte1 >> 4;
    $high2 = $byte2 >> 4;
    $low1 = $byte1 & 0x0f;

    $mantissa = ($low1 << 4) | $high2;

    // (1 + m·2^(-8))·2^(h1 + 1) = (2^8 + m)·2^(h1 - 7)
    return ((256 + $mantissa) << $high1) >> 7;
} 
```

请注意，代码是从二进制文件逆向工程的，但它似乎工作得相当好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T03:41:02.473

或者，[Tommy Lacroix](http://www.tommylacroix.com/2008/07/04/a-php-tool-to-modify-an-flv-meta-and-cuepoints-on-the-fly/)似乎也有一个有趣的解决方案，可以从 FLV 文件中读取元数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-03T11:14:58.847

我听说你可以使用常规的 getimagesize() 但我还没有测试过。试试看。

# asp.net-mvc - MVC 中的 HTMl 助手：如何使用 ActionLink 等助手渲染 html 标签？

> ID：399190
> 
> 赞同：1
> 
> 时间：2008-12-30T00:16:57.253
> 
> 标签：asp.net-mvc, escaping, html-helper

使用 ActionLink 从具有 HTML 标签的数据库中呈现数据时

```
(ie <p>) 
```

并入其中，ActionLink 会转义标签。处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T00:28:26.963

我不知道您可以在辅助方法中关闭 XSS 保护，但您始终可以构建自己的辅助方法。只需制作一个挂起 Html 类的扩展方法。

如果您只想从数据库中呈现一些 HTML，则可以使用 <%= ViewData["MyContent"] %> 如果您是控制器将数据加载到 MyContent 视图数据中。只知道你必须自己清理这个 HTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T03:02:19.853

在有效的 (X)HTML 中，锚标记内不允许使用段落标记，因此我不希望框架允许它。

# algorithm - 计算词之间的语义距离

> ID：399200
> 
> 赞同：8
> 
> 时间：2008-12-30T00:21:47.227
> 
> 标签：algorithm

有谁知道计算两个词之间“语义距离”的好方法？

立即想到一个算法来计算同义词库中单词之间的步数。

* * *

好的，似乎已经回答了一个类似的问题：[是否有一种算法可以判断两个短语的语义相似性](https://stackoverflow.com/questions/62328/)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-24T13:30:54.313

在文本挖掘中有一个重要的格言：“你会知道它所拥有的公司的一个词”。这意味着可以根据经常出现在其附近的术语来学习单词的含义。

在不输入大量细节的情况下，让我给出两个简单的选项来估计术语之间的语义距离：

1.  使用类似于[WordNet](http://wordnet.princeton.edu/)（大型英语词汇数据库）的资源。WordNet 表面上类似于同义词库，因为它根据单词的含义将单词组合在一起。单词之间的语义距离可以估计为连接两个单词的顶点数。

2.  使用大型语料库（例如 Wikipedia），计算出现在您分析的单词附近的术语。创建两个向量并计算距离（例如余弦）。

您可以查看此材料以获取有关该主题的图片：

1.  [http://www.saifmohammad.com/WebDocs/Mohammad_Saif_Thesis-slides.pdf](http://www.saifmohammad.com/WebDocs/Mohammad_Saif_Thesis-slides.pdf)

2.  [http://www.umiacs.umd.edu/~saif/WebDocs/distributionalmeasures.pdf](http://www.umiacs.umd.edu/~saif/WebDocs/distributionalmeasures.pdf)

3.  [http://www.umiacs.umd.edu/~saif/WebDocs/Measuring-Semantic-Distance.pdf](http://www.umiacs.umd.edu/~saif/WebDocs/Measuring-Semantic-Distance.pdf)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T01:05:56.343

词库的想法有一些优点。一种想法是基于同义词库创建一个图，其中节点是单词，边表示它们在同义词库中被列为同义词。然后，您可以使用最短路径算法为您提供节点之间的距离，以衡量它们的相似性。

这里的一个困难是某些词在不同的上下文中具有不同的含义。您的算法可能需要考虑到这一点，并使用有向链接，其传出链接的权重取决于所遵循的传入链接（或基于传入链接忽略一些传出链接）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T00:51:00.210

可能的黑客攻击：将这两个词发送到 Google 搜索，并返回找到的页面数。

# c# - 如何在没有自己的构造函数的基本类型的函数中调用泛型类型的构造函数？

> ID：399202
> 
> 赞同：3
> 
> 时间：2008-12-30T00:23:09.580
> 
> 标签：c#, generics, hash

我认为测试我对泛型函数的理解的一个好方法是创建一个函数，该函数将使用从 HashAlgorithm 继承的类之一吐出哈希的十六进制表示。由于所有 HashAlgorithm 类都提供 ComputeHash，我认为这很简单。当我构造这样的功能时。但是，我收到一个错误，因为 HashAlgorithm 本身不提供构造函数。我也找不到提供构造函数的任何类型的 HashAlgorithm 接口或子类。如果不是所有 HashAlgorithm 类都需要支持构造函数，是否可以对泛型类型施加一些额外的约束以确保类型提供空构造函数，或者我是否将被迫为我知道提供的每个 HashAlgorithm 类创建重载一个空的构造函数。

这是我到目前为止所拥有的（处于非编译状态）：

```
public static string GetHexHash<HashAlgorithmToUse>(Stream dataStreamToHash) where HashAlgorithmToUse : HashAlgorithm
{
    StringBuilder Result = new StringBuilder();
    byte[] ByteHash = (new HashAlgorithmToUse()).ComputeHash(dataStreamToHash);
    foreach (byte HashByte in ByteHash)
    {
        Result.Append(HashByte.ToString("X2"));
    }
    return Result.ToString();
} 
```

**编辑**马特汉密尔顿的答案马上就确定了，只是使通用约束更复杂：`where HashAlgorithmToUse : HashAlgorith, new()`. 我什至没有意识到我可以有多个约束。在我完全理解泛型所能做的一切之前，我肯定还有一段路要走。我想如果你对约束太过分了，你可以制作一个非常非泛型的泛型函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T00:33:03.837

尝试将`new()`子句添加到通用约束的末尾：

```
public static string GetHexHash<HashAlgorithmToUse>(Stream dataStreamToHash)
    where HashAlgorithmToUse : HashAlgorithm, new() 
```

这告诉类型“HashAlgorithmToUse”有一个无参数（默认）构造函数。应该做的伎俩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T00:34:50.633

至少在 Visual Studio 2008 中，将`new()`约束添加到函数可以为我编译：

```
public static string GetHexHash<HashAlgorithmToUse>(Stream dataStreamToHash) where HashAlgorithmToUse : HashAlgorithm, new()
{
    // ...
} 
```

# xml - 不同的元素和分组

> ID：399204
> 
> 赞同：8
> 
> 时间：2008-12-30T00:23:57.613
> 
> 标签：xml, xslt, xpath

给定以下 xml 片段：

```
<Problems>
  <Problem>
    <File>file1</File>
    <Description>desc1</Description>
  </Problem>
  <Problem>
    <File>file1</File>
    <Description>desc2</Description>
  </Problem>
  <Problem>
    <File>file2</File>
    <Description>desc1</Description>
  </Problem>
</Problems> 
```

我需要制作类似的东西

```
<html>
  <body>
    <h1>file1</h1>
    <p>des1</p>
    <p>desc2</p>
    <h1>file2</h1>
    <p>des1</p>
  </body>
</html> 
```

我尝试使用密钥，例如

```
<xsl:key name="files" match="Problem" use="File"/> 
```

但我真的不明白如何将其带到下一步，或者这是否是正确的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-30T06:45:01.540

**这个解决方案比 Richard 提出的**解决方案更简单、更高效，同时更通用：****

 ****这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<!--                                            -->
 <xsl:key name="kFileByVal" match="File"
       use="." />
<!--                                            -->
 <xsl:key name="kDescByFile" match="Description"
       use="../File"/>
<!--                                            -->
    <xsl:template match="/*">
     <html>
      <body>
      <xsl:for-each select=
         "*/File[generate-id()
                =
                 generate-id(key('kFileByVal',.)[1])]">
        <h1><xsl:value-of select="."/></h1>
        <xsl:for-each select="key('kDescByFile', .)">
          <p><xsl:value-of select="."/></p>
        </xsl:for-each>
      </xsl:for-each>
      </body>
     </html>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于提供的 XML 文档时**：

```
<Problems>
    <Problem>
        <File>file1</File>
        <Description>desc1</Description>
    </Problem>
    <Problem>
        <File>file1</File>
        <Description>desc2</Description>
    </Problem>
    <Problem>
        <File>file2</File>
        <Description>desc1</Description>
    </Problem>
</Problems> 
```

**产生想要的结果**：

```
<html>
   <body>
      <h1>file1</h1>
      <p>desc1</p>
      <p>desc2</p>
      <h1>file2</h1>
      <p>desc1</p>
   </body>
</html> 
```

**请注意**第一个的简单匹配模式，[**`<xsl:key>`**](http://www.w3.org/TR/xslt#key)以及如何使用第二个`<xsl:key>`，我们定位所有“ `Description`”元素，这些`File`元素是具有给定值的“”元素的兄弟姐妹。

我们本可以使用更多模板而不是[**`<xsl:for-each>`**](http://www.w3.org/TR/xslt#for-each)拉取处理，但是这是一个非常简单的案例，并且该解决方案确实受益于更短、更紧凑和更易读的代码。

**另请注意，在[XSLT 2.0](http://www.w3.org/TR/xslt20/)中，通常会使用[`<xsl:for-each-group>`](http://www.w3.org/TR/xslt20/#xsl-for-each-group)指令**而不是[**Muenchian 方法**](http://dpawson.co.uk/xsl/sect2/N4486.html#d6060e85)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T01:12:05.113

这就是我的做法，使用 Muenchean 方法。谷歌“xslt muenchean”从更聪明的人那里获得更多信息。可能有一个聪明的方法，但我会把它留给其他人。

请注意，我避免在 xml 元素名称的开头使用大写字母，例如“文件”，但这取决于您。

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="html"/>
    <xsl:key name="files" match="/Problems/Problem/File" use="./text()"/>
    <xsl:template match="/">
        <html>
            <body>
                <xsl:apply-templates select="Problems"/>
            </body>
        </html>
    </xsl:template>
    <xsl:template match="Problems">
        <xsl:for-each select="Problem/File[generate-id(.) = generate-id(key('files', .))]">
            <xsl:sort select="."/>
            <h1>
                <xsl:value-of select="."/>
            </h1>
            <xsl:apply-templates select="../../Problem[File=current()/text()]"/>
        </xsl:for-each>
    </xsl:template>
    <xsl:template match="Problem">
        <p>
            <xsl:value-of select="Description/text()"/>
        </p>
    </xsl:template>
</xsl:stylesheet> 
```

这个想法是，使用它的文本值来键入每个 File 元素。然后仅显示与键控元素相同的文件值。要检查它们是否相同，请使用 generate-id。有一种类似的方法可以比较匹配的第一个元素。我不能告诉你哪个更有效。

我已经使用 Marrowsoft Xselerator 测试了这里的代码，这是我最喜欢的 xslt 工具，虽然不再可用，afaik。我得到的结果是：

```
<html>
<body>
<h1>file1</h1>
<p>desc1</p>
<p>desc2</p>
<h1>file2</h1>
<p>desc1</p>
</body>
</html> 
```

这是使用 msxml4。

我已经按文件对输出进行了排序。我不确定你是否想要那个。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-19T04:41:40.947

这个**XSLT 1.0**解决方案也可以解决问题。比其他解决方案更简洁！

```
 <xsl:template match="/">           
    <html><body>
      <xsl:for-each select="//File[not(.=preceding::*)]">
        <h1><xsl:value-of select="." /></h1>
        <xsl:for-each select="//Problem[File=current()]/Description">
          <p><xsl:value-of select="." /></p>
        </xsl:for-each>
      </xsl:for-each>
    </body></html>
  </xsl:template> 
```

结果：

```
<html xmlns="http://www.w3.org/1999/xhtml">
  <body>
    <h1>file1</h1>
    <p>desc1</p>
    <p>desc2</p>
    <h1>file2</h1>
    <p>desc1</p>
  </body>
</html> 
```

# bash - 在 bash 中按行尾/行中自动完成

> ID：399209
> 
> 赞同：8
> 
> 时间：2008-12-30T00:27:23.083
> 
> 标签：bash

在 bash 中有一种快速的方法可以根据单词的中间进行制表符自动完成。

例如，如果我在目录中有这些文件：

```
001_apple.txt 002_pear.txt 003_dog.txt 
```

我想输入序列：`*d<TAB>`自动完成 003_dog.txt。

这可以在bash中完成吗？在其他shell中更容易吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T00:51:06.013

尝试 ESC-g 进行全局扩展。

而且您应该始终安装 bash-completion 包（默认情况下经常包含，但您需要在 bash 配置文件脚本中获取它）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T01:14:00.540

看起来[zsh 做了这个](http://zsh.dotsrc.org/FAQ/zshfaq04.html)加上更多。请参阅：expand-or-complete-prefix 和 COMPLETE_IN_WORD 选项。

[Fish](http://fishshell.org/)开箱即用也很好地做到了这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T01:24:23.997

```
ls *d*<TAB> 
```

在 bash 中工作。不确定Ben是否是这个意思。`ls`当然可以是任何其他命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T16:06:13.140

我认为这是 readline 的一个功能（甚至可能不是默认的键绑定）：

type `ls \*middle\*`，然后 type`ctrl-x, *`将替换`\*middle\*`为匹配模式的文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T00:34:30.277

您可以替换 ``ls *d*`` 以达到相同的效果，但是不如制表符完成方便

# javascript - 带有参数的 VS JavaScript 智能感知

> ID：399214
> 
> 赞同：0
> 
> 时间：2008-12-30T00:30:42.687
> 
> 标签：javascript, visual-studio-2008, intellisense

这是一些示例 javascript：

```
SomeObjectType = function() {
}

SomeObjectType.prototype = {
    field1: null,
    field2: null
}

SomeOtherObject = function() {
}

SomeOtherObject.prototype =
{
    doSomething: function(val) {
        /// <param name="val" type="SomeObjectType"></param>
        var val2 = new SomeObjectType();
        //val2\. shows intellisense correctly
        //val. does NOT

    }
} 
```

当我做“val”时，视觉工作室不应该给我智慧吗？在“doSomething”函数中？我希望它能给我 field1 和 field2 作为选项，但事实并非如此。如果我输入“val2”，我会得到 field1 和 field2。所以当我创建一个与我在参数注释中指定的相同类型的新对象时，智能就会起作用。

任何想法我做错了什么或者这只是不支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-05T21:31:08.853

这在 VS 2008 中不受支持。它将在下一个版本中支持。

在 VS 2008 中，XML 注释仅用于生成工具提示信息。而且我认为工具提示可能仅在引用文件中受支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-16T21:29:21.470

这在 VS2010 上受支持。但是为什么只针对原型方法呢？:(

# .net - 我仍然没有得到代表

> ID：399222
> 
> 赞同：3
> 
> 时间：2008-12-30T00:34:30.480
> 
> 标签：.net, vb.net, delegates

使用委托不是帮助处理一些异步情况吗？我尝试了以下操作，但我的 UI 仍然挂起。你到底什么时候使用代表？

```
 Public Class Form1
    Private Delegate Sub testDelegate()

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As _
 System.EventArgs) Handles Button1.Click

        Dim d As testDelegate = New testDelegate(AddressOf Add)
        d.Invoke()

    End Sub

    Private Sub Add()
        For i As Integer = 0 To 10000
            TextBox1.Text = i + 1
        Next
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-30T00:46:15.027

正如 Joel 所提到的 - BeginInvoke() 将异步执行委托 - 如果目标返回数据（使用 EndInvoke），您将需要设置一个异步回调来检索返回值。

以下链接是一篇关于使用委托进行异步编程的好文章：http: [//msdn.microsoft.com/en-us/library/2e08f6yc.aspx](http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx)

此外（这是在 C# 中 - 抱歉）您可以使用 lambda 表达式处理回调：

```
Action myAction = () => Console.WriteLine("This is an async call!");
myAction.BeginInvoke(asyncResult => Console.WriteLine("Async Done!"), null); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T05:02:18.143

这有点讽刺，但每个人最喜欢的答案（使用 BeginInvoke）实际上并不正确。委托目标方法将在线程池线程上执行。除了创建它们的线程之外，您不得触摸其他线程上的控件，几乎总是程序的主线程。

如果您在调试器中使用 .NET 框架 2.0 及更高版本进行尝试，循环将立即以 IllegalOperationException 终止。要纠正这个问题，您必须使用 Control.BeginInvoke()。顺便说一句，与委托的 BeginInvoke() 方法完全不同的动物。

讽刺的是，您的循环现在将向 UI 线程发送 10,000 个委托调用请求。它将花费几秒钟来执行它们，而不是去做任何真正的工作。就像调度 TextBox 的 Paint 事件一样。或响应任何用户输入。你实际上比以前更糟了。

我怀疑这有助于解释代表。也许您可以选择一个更好的示例，即不尝试更新控件的示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T00:39:08.190

这是我发送给同事的内容：

基本上委托可用于回调、事件和异步处理。

这是一些示例代码，将每个示例复制并粘贴到新的命令行项目中。

```
//Callbacks    
//-------------------------------------------------------------------------------------------------------     
delegate double DiscountRule(); // Declaration
delegate string MessageFormat(); // Declaration

class Message    
{
    public string Instance() { return "You save {0:C}"; }
    public static string Class() { return "You are buying for {0:C}"; }

    public void Out(MessageFormat format, double d)
    {
        System.Console.WriteLine(format(), d);

    }
}

class Discount
{
    public static double Apply(DiscountRule rule, double amount)
    {
        return rule() * amount; // Callback
    }

    public static double Maximum() { return 0.50; }
    public static double Average() { return 0.20; }
    public static double Minimum() { return 0.10; }
    public static double None() { return 0.00; }
}

class TestDelegate1
{
    public static void Main()    
    {   
        DiscountRule[] rules = { // Instantiations  
             Discount.None,
             Discount.Minimum,    
             Discount.Average,    
             Discount.Maximum,    
             };

        // Instantiation with a static method    
        MessageFormat format = Message.Class;

        double buy = 100.00;    
        Message msg = new Message();             
        msg.Out(format, buy); // Invocation     

        // Instantiation with an instance method    
        format = msg.Instance;

        foreach (DiscountRule r in rules)    
        {    
            double saving = Discount.Apply(r, buy); // Invocation    
            msg.Out(format, saving); // Invocation    
        }    
    }    
}

//--------------------------------------------------------------------------------------------------------    
//Events:     

//the delegate creates a new type    
delegate void UpdateEventHandler();

class Subject    
{    
    private int data;

    public int GetData() { return data; }   
    public void SetData(int value) { data = value; Changed(); }    
    public event UpdateEventHandler Changed;    
}

class Observer    
{    
    public Observer(Subject s) { subject = s; }    
    public Subject GetSubject() { return subject; }   
    private Subject subject;   
}

class HexObserver : Observer
{    
    public HexObserver(Subject s)    
        : base(s)   
    {    
        s.Changed += Update;   
    }

    public void Update()    
    {   
        System.Console.Write("0x{0:X} ", GetSubject().GetData());    
    }    
}

class DecObserver : Observer    
{
     public DecObserver(Subject s)    
        : base(s)    
    {    
        s.Changed += Update;   
    }

    public void Update()    
    {    
        System.Console.Write("{0} ", GetSubject().GetData());    
    }    
}

class TestEvent    
{    
    public static void Main()    
    {   
        Subject s = new Subject();

        //assigns a Hex observer to object s (the constructor does the += assignment)    
        HexObserver ho = new HexObserver(s);

        //assigns a Decimal observer to object s    
        DecObserver co = new DecObserver(s);     

        for (int c; ; )    
        {    
            System.Console.Write("\nEnter a character" +    
            "(followed by a return, ctrl-C to exit): ");

            c = System.Console.Read();    
            s.SetData(c);    
            System.Console.Read(); // Two reads to get rid of the \r\n on PC.    
            System.Console.Read();   
        }    
    }    
} 
```

.

```
//--------------------------------------------------------------------------------------------------------  
//Asynchronous processing (from http://msdn.microsoft.com/en-us/library/h80ttd5f(VS.71).aspx)         
using System;    
using System.Runtime.Remoting.Messaging;

// Create an asynchronous delegate.    
public delegate bool FactorizingAsyncDelegate (    
         int factorizableNum,     
         ref int primefactor1,    
         ref int primefactor2);

// Create a class that factorizers the number.    
public class PrimeFactorizer    
{    
   public bool Factorize(
                int factorizableNum,      
                ref int primefactor1,    
                ref int primefactor2)   
   {    
      primefactor1 = 1;    
      primefactor2 = factorizableNum;

      // Factorize using a low-tech approach.    
      for (int i=2;i<factorizableNum;i++)   
      {
         if (0 == (factorizableNum % i))    
         {
            primefactor1 = i;    
            primefactor2 = factorizableNum / i;    
            break;    
         }    
      }

      if (1 == primefactor1 )    
         return false;    
      else    
         return true   ;    
   }    
}

// Class that receives a callback when the results are available.    
public class ProcessFactorizedNumber    
{    
   private int _ulNumber;

   public ProcessFactorizedNumber(int number)   
   {    
      _ulNumber = number;   
   }

   // Note that the qualifier is one-way.    
   [OneWayAttribute()]    
   public void FactorizedResults(IAsyncResult ar)    
   {
      int factor1=0, factor2=0; 

      // Extract the delegate from the AsyncResult.      
      FactorizingAsyncDelegate fd = (FactorizingAsyncDelegate)((AsyncResult)ar).AsyncDelegate;

      // Obtain the result.    
      fd.EndInvoke(ref factor1, ref factor2, ar);

      // Output the results.    
      Console.WriteLine("On CallBack: Factors of {0} : {1} {2}",     
                   _ulNumber, factor1, factor2);    
   }    
}

// Class that shows variations of using Asynchronous    
public class Simple    
{    
   // The following demonstrates the Asynchronous Pattern using a callback.    
   public void FactorizeNumber1()    
   {
      // The following is the client code.    
      PrimeFactorizer pf = new PrimeFactorizer();    
      FactorizingAsyncDelegate fd = new FactorizingAsyncDelegate (pf.Factorize);

      int factorizableNum = 1000589023, temp=0; 

      // Create an instance of the class that is going   
      // to be called when the call completes.   
      ProcessFactorizedNumber fc = new ProcessFactorizedNumber(factorizableNum);

      // Define the AsyncCallback delegate.    
      AsyncCallback cb = new AsyncCallback(fc.FactorizedResults);

      // You can use any object as the state object.    
      Object state = new Object();

      // Asynchronously invoke the Factorize method on pf.   
      IAsyncResult ar = fd.BeginInvoke(
                           factorizableNum,     
                           ref temp, 
                           ref temp,     
                           cb,     
                           state);          
      //    
      // Do some other useful work.    
      //. . .    
   }    

   // The following demonstrates the Asynchronous Pattern using a BeginInvoke, followed by waiting with a time-out.    
   public void FactorizeNumber2()    
   {    
      // The following is the client code.    
      PrimeFactorizer pf = new PrimeFactorizer();    
      FactorizingAsyncDelegate fd = new FactorizingAsyncDelegate (pf.Factorize);

      int factorizableNum = 1000589023, temp=0; 

      // Create an instance of the class that is going     
      // to be called when the call completes.
      ProcessFactorizedNumber fc = new ProcessFactorizedNumber(factorizableNum);

      // Define the AsyncCallback delegate.    
      AsyncCallback cb =     
           new AsyncCallback(fc.FactorizedResults);

      // You can use any object as the state object.    
      Object state = new Object();

      // Asynchronously invoke the Factorize method on pf.   
      IAsyncResult ar = fd.BeginInvoke(   
                        factorizableNum,     
                        ref temp,     
                        ref temp,     
                        null,    
                        null); 

      ar.AsyncWaitHandle.WaitOne(10000, false);

      if (ar.IsCompleted)  
      {   
         int factor1=0, factor2=0;          

         // Obtain the result.    
         fd.EndInvoke(ref factor1, ref factor2, ar);    

         // Output the results.    
         Console.WriteLine("Sequential : Factors of {0} : {1} {2}", 
                       factorizableNum, factor1, factor2);   
      }    
   }

   public static void Main(String[] args)    
   {    
      Simple simple = new Simple();    
      simple.FactorizeNumber1();    
      simple.FactorizeNumber2();   
   } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T00:41:36.080

调用`.BeginInvoke()`而不是`.Invoke()`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-30T01:03:05.630

我找到的最好的类比来解释代表这是一份遗嘱或你的最后遗嘱。

当然，这是你在死前写下的一套指令，然后你把它放在一个安全的地方。然后在您死后，您的律师将*执行*这些指示...

当想要执行动作的代码不知道该动作应该是什么的足够详细信息时，主要使用委托，您可以将其视为在适当时间执行的一系列动作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T00:48:28.813

在这种情况下，我可能不会使用委托，因为您需要重新委托回 UI 线程来更新按钮。您可以在循环内使用 Application.DoEvents 来使您的 UI 在更新时响应。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-30T01:20:51.977

正如 Joel 和 Matthew 所提到的，BeginInvoke 将异步执行委托。正如 Matthew 所说，[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx)很好地涵盖了这一点。

但是，如果您尝试在 WinForms 应用程序中做一些后台工作，我建议您查看[后台工作控件](http://msdn.microsoft.com/en-us/library/8xs8549b.aspx)。习惯于 WinForms 事件驱动模型的开发人员会更熟悉它。

# ruby-on-rails - 如何对测试有积极的心理态度？

> ID：399224
> 
> 赞同：10
> 
> 时间：2008-12-30T00:34:51.913
> 
> 标签：ruby-on-rails, ruby, testing

我想为我的应用程序编写测试，但每次查看 rspec.info 时，我真的看不到“正确做事”并首先进行测试的明确路径。我不止一次在 rspec 上观看了 peepcode 视频，但没用。我想对我的工作感到更加自豪，我认为测试会有所帮助。怎样才能突破这个心理障碍？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T02:52:25.363

**寻找可以奖励您进行测试的工具**。例如，**让运行所有测试变得非常容易**并获得类似的消息

```
73 tests passed. 
```

尝试[**随机测试**](http://www.cs.chalmers.se/~rjmh/QuickCheck/)，因为您可以快速轻松地针对大量值进行测试。

看看您的语言是否提供了一个**测试覆盖分析**工具，可以为您提供语句覆盖百分比或块覆盖百分比。**将代码覆盖率从 60% 提高到 90%**是非常有益的——如果幸运的话，你会发现错误。

我的主要建议是**量化您**在测试中的进度，以便您可以看到数字在上升。这会让它更有动力。（哎呀，我想知道在这个网站上还能找到哪些其他数字......）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-30T00:38:35.477

在我开始创建一些测试宏之前，我一直很讨厌它。比如登录或访问主页。我发现开始探讨我的测试框架真正可以做什么很有趣。这也有助于让其他人通过写一些来帮助我开始。我立刻发现了明显的改进，这让我想进入那里并开始改进。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-30T12:33:50.153

“测试你不想破坏的东西。”

首先确定优先级可能会有所帮助。我知道在黄瓜验收测试之上输入完整的三层模型、视图和控制器规范可能是一件苦差事。所以一个想法是只测试应用程序中最关键的东西，并在遇到不想再看到的错误时添加测试。

“总是从失败的测试开始。”

Cucumber 具有纯文本“故事”，对于启动和运行一些真正具体的测试来说非常棒。也许那将是您可以开始的地方。不过，Cucumber 并不能真正与基于 AJAX 的应用程序一起使用，因为您必须使用 Selenium 或 Watir。您可以在编写一行代码之前从一个失败的故事开始，然后迅速从那里着手使该故事通过。

“不测试，指定。”

与其考虑测试，不如尝试进行心理转换：您不是在测试，而是在指定应用程序的行为方式。这是设计工作，不像测试那么无聊。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T07:06:08.113

可以这样想：如果你不测试，你的代码就会被破坏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T00:45:50.970

您需要看到测试在重构和扩展代码方面带来的价值。一旦您拥有一组定义类行为的测试，您就可以开始进行更改以改进代码。您的测试将使您确信您所做的事情不会破坏系统。当您向代码添加新功能时，运行现有测试将使您确信您添加的新代码不会破坏其他任何东西。

关键是要有长远的眼光。测试是一种投资。它需要一点点远离你可能正在编写的代码，但最终它会开始带来回报。您存储的资金将使添加新功能时更容易更快地前进。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T01:18:50.937

假设您已经有一个要修复的错误列表，我总是喜欢回顾并尽可能创建一个演示错误的自动化测试。然后修复错误并观察测试通过。由于无论如何您都必须测试该错误，并且该错误应该已经为您提供了足够的信息来重新创建它，因此您可以立即看到测试的回报。

最终，您将开始对将测试放在一起以及如何编写它们有一种感觉，并且您不需要现有错误的“蓝图”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-07T15:13:28.317

几天前，我写了一篇关于这个案例的动机帖子。这是摘要：

> 只要有机会就开始编写测试（即，每当您编写一些代码时）。选择任何对您有意义的工具并编写任何您认为至少可以覆盖应用程序的一些微小行为的测试（从一开始就不要关心覆盖率或任何其他可怕的术语）。不要害怕原始测试和琐碎的断言——随着测试覆盖率的增长，你会变得更加自信，并且你会变得越来越快乐，因为你会注意到你不再需要经常按 F5 . 从其他积极的角度考虑测试 - 你越擅长它，你需要花在你不喜欢的活动上的时间就越少（观看浏览器中的旋转刷新图标，调试）以及更多你喜欢的事情。

如果您有兴趣，这就是[全部内容。](http://coi.tumblr.com/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-08T07:37:12.217

如前所述，进入测试的最简单方法是使用回归测试。

我也会避免做控制器规格——它们是 PITA。做*大量*的模型测试，因为那是逻辑应该放在首位的地方。

在进入 Rails 项目之前，尝试规范/测试一个普通的 ruby​​ 项目。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-07T14:59:40.950

好吧，我会告诉你怎么做！

在尝试自动化之前，首先在不同的应用程序上手动执行以下 10 次

负面情况，结果将是负面的。它可能是输入错误的数据并为您提供正确的输出。

例如登录屏幕：当正确的用户错误的密码，错误的用户正确的密码时，可能会有很多情况......最重要的是 **你不要放弃，除非** 打破它。这是你的口头禅。

嗯，现在您像测试人员一样思考现在**转向我们的**系统，只需编写负面测试及其结果，然后由正面测试设计它。现在制定框架

# ruby-on-rails - 您如何看待基于 AWS 的架构

> ID：399244
> 
> 赞同：0
> 
> 时间：2008-12-30T00:50:47.670
> 
> 标签：ruby-on-rails, architecture, amazon-ec2

我正在阅读这篇文章：

[http://aws.typepad.com/aws/2008/12/running-everything-on-aws-soocialcom.html](http://aws.typepad.com/aws/2008/12/running-everything-on-aws-soocialcom.html)

我想知道这是好是坏。我自己是 AWS 的粉丝，但我想听听人群的想法……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T03:10:10.180

除了可靠性之外，弹性世界中的一切都是完美的。显然，服务的可靠性和质量取决于服务提供商，如果服务提供商出现故障，您就没有任何可依靠的东西了。我是 AWS 的忠实拥护者，但由于最近两次中断，我现在正在设计本地数据中心服务器上的后备方案，以防出现中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-10T10:19:21.977

在 AWS 中设计解决方案时的主要设计决策之一是预期服务失败并实施恢复机制，如果您需要 HA，则实施冗余。不要假设所有服务都是可靠的（除非另有说明它们在内部实现了冗余）。如果您使用 Lambda、API Gateway、S3、Dynamodb 等托管服务，则大多数问题都可以解决，但如果您使用 EC2 等服务，则必须针对 HA 进行设计，例如使用自动缩放和负载的 EC2平衡。

如果您有兴趣了解更多信息，请参阅[AWS Well-Architecture Framework](https://d0.awsstatic.com/whitepapers/architecture/AWS_Well-Architected_Framework.pdf)白皮书。

# xml - 在音频和视频文件中嵌入任意元数据

> ID：399245
> 
> 赞同：2
> 
> 时间：2008-12-30T00:50:59.680
> 
> 标签：xml, metadata

我在一个组织工作，我们从学术机构获取原始的 MPEG-2 讲座视频文件，并以各种格式在我们的网站上提供它们。目前，将 MPEG-2 转换为音频 (MP3) 和视频 (MP4)、上传到 iTunes U、YouTube 等的工作流程非常繁琐。我想自动化这个过程，但阻止我这样做的主要因素是与工作流程中的每个步骤相关的所有标记。

基本上，我想这样做，以便我可以只标记一次原始文件（标记原始 MPEG-2 文件并通过转码将元数据粘贴在它上面可能要求太多，所以我们假设我会标记每对 MP3/MP4 文件），以及上传视频的每个地方所需的所有元数据 - 因此元数据必须包含适用于 YouTube、iTunes U、我们的网站以及我们上传内容的所有其他地方的正确数据到。由于元数据的广泛性，普通的 ID3 标签是不够的。我想要某种完全可定制的元数据（可能基于 XML，但不一定）解决方案，用于以编程方式标记和读取 MP3 和 MP4 文件中的元数据字段。这样的事情存在吗？我可以为此编写自己的自定义客户端程序，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T01:48:04.433

由于还没有人回答，我将回答我最初的想法。我找到了一些 MP3 标记库，但没有一个可以同时用于 MP3 和 MP4 文件的库。将 XML 文件与每个媒体文件关联起来会不会太“笨拙”？因此，如果我的音频文件夹中有 SomeSpeaker.mp3，我的元数据文件夹中也会有 SomeSpeaker.mp3.xml。这可能是最简单的解决方案，唯一的问题是我需要确保 XML 文件与媒体文件一起上传，但这不应该成为问题，因为我的客户端程序会进行上传。对此有什么想法吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-01-25T16:01:59.600

我知道 Adob​​e XMP 元数据经常以“sidecar”文件的形式存在，即原始文件旁边的 XML 文件。

我需要完全相同的能力并且正在研究。我正在研究现有的 DAM 解决方案，看看它们创建和使用元数据的效果如何。

Adobe Bridge、Extensis Portfolio 和 CatDV 都在我的列表中以供查看。

我在 Photoshop/Lightroom 中使用了 XMP 元数据，它运行良好。

——卡梅隆

# php - 去 PHP parse_url() 不去的地方 - 只解析域

> ID：399250
> 
> 赞同：12
> 
> 时间：2008-12-30T00:51:48.040
> 
> 标签：php, dns

PHP 的 parse_url() 有一个主机字段，其中包括完整的主机。我正在寻找仅返回域和 TLD 的最可靠（且成本最低）的方法。

给定示例：

*   [http://www.google.com/foo](http://www.google.com/foo)， parse_url() 为主机返回 www.google.com
*   [http://www.google.co.uk/foo](http://www.google.co.uk/foo)， parse_url() 为主机返回 www.google.co.uk

我只寻找**google.com**或**google.co.uk**。我已经考虑了一个有效的顶级域名/后缀表，并且只允许这些和一个单词。你会用其他方法吗？有谁知道这种事情的预装有效正则表达式？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-30T01:51:39.963

那样的事情怎么样？

```
function getDomain($url) {
  $pieces = parse_url($url);
  $domain = isset($pieces['host']) ? $pieces['host'] : '';
  if (preg_match('/(?P<domain>[a-z0-9][a-z0-9\-]{1,63}\.[a-z\.]{2,6})$/i', $domain, $regs)) {
    return $regs['domain'];
  }
  return false;
} 
```

将使用经典提取域名`parse_url`，然后查找没有任何子域的有效域（www 是子域）。不适用于“localhost”之类的东西。如果它不匹配任何东西，将返回 false。

**// 编辑：**

试试看：

```
echo getDomain('http://www.google.com/test.html') . '<br/>';
echo getDomain('https://news.google.co.uk/?id=12345') . '<br/>';
echo getDomain('http://my.subdomain.google.com/directory1/page.php?id=abc') . '<br/>';
echo getDomain('https://testing.multiple.subdomain.google.co.uk/') . '<br/>';
echo getDomain('http://nothingelsethan.com') . '<br/>'; 
```

它应该返回：

```
google.com
google.co.uk
google.com
google.co.uk
nothingelsethan.com 
```

当然，如果它不通过它不会返回任何内容[`parse_url`](http://php.net/parse_url)，因此请确保它是一个格式正确的 URL。

**// 附录：**

阿尔尼塔克是对的。上面介绍的解决方案在**大多数**情况下都有效，但不一定适用于所有情况，并且需要进行维护以确保它们不是具有 .morethan6characters 等的新 TLD。提取域的唯一可靠方法是使用维护列表，例如[http://publicsuffix.org/](http://publicsuffix.org/)。一开始会更痛苦，但从长远来看会更容易、更健壮。您需要确保了解每种方法的优缺点以及它如何适合您的项目。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-30T20:47:14.697

目前，唯一“正确”的方法是使用一个列表，例如在[http://publicsuffix.org/上维护的列表](http://publicsuffix.org/)

顺便说一句，这个问题也几乎是重复的：

*   [我可以改进对有效域名的正则表达式检查吗？](https://stackoverflow.com/questions/399932/can-this-domain-name-regular-expression-be-refactored-further)
*   [从 URL 获取子域](https://stackoverflow.com/questions/288810/get-the-subdomain-from-a-url)

IETF 的标准化工作着眼于声明 DNS 树中的特定节点是否用于“公共”注册的 DNS 方法，但它们仍处于开发的早期阶段。所有流行的非 IE 浏览器都使用 publicsuffix.org 列表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-02T12:57:12.950

Python 的 tldextract 模块还有一个非常好的端口[http://w-shadow.com/blog/2012/08/28/tldextract](http://w-shadow.com/blog/2012/08/28/tldextract) - 这超出了 parse_url 并允许您在没有子域的情况下实际获取域/tld .

从模块网站：

```
$components = tldextract('http://www.bbc.co.uk');
echo $components->subdomain; // www
echo $components->domain;    // bbc
echo $components->tld;       // co.uk 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T01:03:35.943

从相关帖子中挖掘出来，以保持表格的想法： [http ://mxr.mozilla.org/mozilla-central/source/netwerk/dns/src/effective_tld_names.dat?raw=1](http://mxr.mozilla.org/mozilla-central/source/netwerk/dns/src/effective_tld_names.dat?raw=1)

我宁愿不那样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-07-01T14:46:08.677

您需要使用[Public Suffix List](https://publicsuffix.org/)的软件包，只有这样您才能正确提取具有二级、三级 TLD（co.uk、a.bg、b.bg 等）和多级子域的域。正则表达式、parse_url() 或字符串函数永远不会产生绝对正确的结果。

我建议使用[TLD Extract](https://github.com/layershifter/TLDExtract)。这里的代码示例：

```
$extract = new LayerShifter\TLDExtract\Extract();

$result = $extract->parse('http://www.google.co.uk/foo');
$result->getSubdomain(); // will return (string) 'www'
$result->getHostname(); // will return (string) 'google'
$result->getSuffix(); // will return (string) 'co.uk'
$result->getRegistrableDomain(); // will return (string) 'google.co.uk' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T01:06:49.557

当然，这取决于您的具体用例，但一般来说，我不会对 TLD 使用表查找。新的 TLD 出现了，您通常不想在任何地方维护它们。问问我的 firstname@lastname.name 多久因为短视而被拒绝。

如果我知道你为什么不想要 www，我想我可以提供更好的帮助？电子邮件需要它吗？在这种情况下，您可以查询 MX 记录以验证它（最终）是否接受邮件。

您还可以找到有关处理 DNS 记录的 PHP 函数的帮助，以了解有关它们的更多信息，例如，请参阅[http://php.net/dns_get_record 。](http://php.net/dns_get_record)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-30T01:39:40.910

只是一个证明，假设允许的 tld 被存储到哈希中。代码可以缩短很多。

```
<?php
    $urlCompoments=parse_url($theUrl);
    $chunk=explode('.',$urlComponents['host']);

    $tldIndex = count($chunk-1); // assume last chunk is tld
    $maxTldLen = 2; // assuming a tld can be in the form .com or .co.uk
    $cursor=1;
    $found=false;
    while(($cursor<=$maxTldLen) or $found) {
      $tls = implode('.',array_slice($chunk, -$cursor));
      $found=isset($tldSuffixesAllowed[$tld]);
      $cursor++;
    }
    if ($found){
       $tld=implode('.',array_slice($chunk, -$cursor));
    } else {
       // domain not recognized, do wathever you want
    }
?> 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-01-01T01:29:12.347

有一个非常简单的解决方案：

```
function get_domain($url) {
  $pieces = parse_url($url);
  return array_pop(explode('.', $pieces['host'], 2));
} 
```

这肯定会奏效吗？

# macos - OS X：向本地主机发送邮件

> ID：399252
> 
> 赞同：5
> 
> 时间：2008-12-30T00:52:39.943
> 
> 标签：macos, email

出于测试目的，我想将邮件发送到我的本地主机用户帐户而不是我的网络服务器。我不确定如何使用 mail.app 执行此操作。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-10-29T15:27:42.410

@重言式

OSX 确实有一个内置的 MTA（SMTP 服务器），要打开它，您可以键入：

```
sudo launchctl start org.postfix.master 
```

然后您可以根据需要将邮件发送到本地主机

* * *

显示从我的机器运行 10.6.1 运行的 SMTP 服务器的示例

```
>telnet 127.0.0.1 25
Trying 127.0.0.1...
telnet: connect to address 127.0.0.1: Connection refused
telnet: Unable to connect to remote host

>sudo launchctl start org.postfix.master

>telnet 127.0.0.1 25
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 machinename.example.com ESMTP Postfix 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-30T01:31:15.857

如果您不是特别想使用 Mail.app，您可以使用该`mail`命令发送邮件。打开终端并：

```
mail -s "Testing" `whoami`@`hostname`
<type something>
Ctrl-D to finish and send 
```

这些是反引号，而不是单引号。`whoami`返回当前用户的用户名并`hostname`返回本地机器的主机名。它也可以是明确的：

```
mail -s "Testing" john@mymac.local 
```

编辑：只需阅读您的说明。Mail.app 将其数据存储在 ~/Mail 中，主要存储在 SQLite 数据库（“信封索引”文件）中。感兴趣的表是`mailboxes`和`messages`。电子邮件的文本存储在各个邮箱/文件夹目录中的单独文件中。如果您想访问 Mail.app（实时）获取的电子邮件，这可能是要走的路。

另一种选择是使用 mbox 格式从 Mail.app 导出您的邮件，并使用 dbr 描述的技术访问它。根据是否需要实时访问，您可以编写脚本来自动导出。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-30T03:26:06.153

> 我正在寻找登录到我的（本地）邮件服务器，访问邮箱并进行一些解析。所以，我假设有一个邮件服务器在本地运行，但不知道如何访问它

本地邮件不存储在 POP3/IMAP 服务器中，而是使用 UNIX'y [mbox](http://en.wikipedia.org/wiki/Mbox)。存储`/var/mail/`的文件（文件名是用户登录名）

例如..

```
$ mail dbr
Subject: hi
test
^d # ctrl+d (EOF)
$ cat /var/mail/dbr 
From dbr@parabola.local  Tue Dec 30 13:43:57 2008
Return-Path: <dbr@parabola.local>
X-Original-To: dbr
Delivered-To: dbr@parabola.local
Received: by parabola.local (Postfix, from userid 501)
        id 4FEA1158E36; Tue, 30 Dec 2008 13:43:57 +1030 (CST)
To: dbr@parabola.local
Subject: hi
Message-Id: <20081230031357.4FEA1158E36@parabola.local>
Date: Tue, 30 Dec 2008 13:43:57 +1030 (CST)
From: dbr@parabola.local (dbr)

test 
```

不确定 Ruby（我四处搜索，但找不到任何东西，尽管毫无疑问有一个模块），但我知道 Python 有一个[`maildir.mbox`module](http://www.python.org/doc/2.5.2/lib/mailbox-mbox.html)，它将以下列方式使用：

```
>>> msgs = mailbox.mbox("/var/mail/dbr")
>>> for msg in msgs:
...     print "Subject:", msg['subject']
... 
Subject: hi 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T02:33:21.487

除非您正在运行 OSX Server，否则本地不会运行 SMTP/IMAP/POP3 服务器。您可以使用[Post Fix Enabler](http://www.cutedgesystems.com/software/PostfixEnabler/)轻松启动并运行它，或者，如果您不介意命令行，请使用[MacPorts](http://www.macports.org/)安装 postfix：

```
sudo port install postfix 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-20T07:42:48.860

从本地主机发送邮件 LocalhostMail 是一个简单而快速的 Mac OS X 解决方案，它允许您通过 Mac OS X 附带的 Mail.app 从您的 PHP 应用程序（或位于本地主机上的任何其他应用程序）发送电子邮件消息。如果您使用 PHP，只需将新消息添加到 MySQL 数据库，我们的应用程序就会通过 Mail 应用程序发送它们。LocalhostMail 使用您在 Mail.app 中的邮件帐户来发送这些消息，因此您的 localhost 不需要单独的 SMTP 服务器。[localhostmail.com](http://www.localhostmail.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T01:57:09.890

代码逻辑，谢谢，我确实知道从终端发送邮件。我认为我的问题没有经过深思熟虑。我正在寻找登录到我的（本地）邮件服务器，访问邮箱并进行一些解析。所以，我假设有一个邮件服务器在本地运行，但不知道如何访问它。我正在使用红宝石：

```
pop = Net::POP3.new 'macbook.local'
pop.start 'me', 'mypass' 
```

但得到一个`Timeout::Error: execution expired`

# javascript - 从 Firefox 扩展中查找当前登录的用户

> ID：399263
> 
> 赞同：6
> 
> 时间：2008-12-30T01:13:05.533
> 
> 标签：javascript, firefox, xul

我正在编写一个 Firefox 扩展，它需要知道当前登录用户在 Windows、Mac 或 Linux 中的用户名是什么。因此，如果我以“brh”身份登录我的机器，它将返回“brh”。知道如何从扩展 JavaScript 中做到这一点吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-30T09:48:16.443

Firefox 扩展按照与页面中运行的普通 JavaScript 不同的规则运行：找到当前用户是绝对可能的。

打开错误控制台（在工具中）并输入：

```
Components.classes["@mozilla.org/process/environment;1"].getService(Components.interfaces.nsIEnvironment).get('USER') 
```

Firefox 启动时使用的环境变量可通过[NsIEnvironment XPCOM 组件](https://developer.mozilla.org/en/NsIEnvironment)获得。

您可能必须针对每个平台进行自定义。如果一切都失败了，您也许可以在其中创建一个NsIFile[然后](https://developer.mozilla.org/en/NsIFile)`~`查看它的`.path`; 不过，我不确定那里是否尊重 shell 表达式...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-16T20:07:01.787

标记的正确答案工作正常。我在 Firefox 38 上的扩展程序中使用了它。我还使用事件，以便页面可以与扩展程序通信并从扩展程序中检索 windows 属性。

getWindowsProperty: function(prop){ return Components.classes["@mozilla.org/process/environment;1"].getService(Components.interfaces.nsIEnvironment).get(prop); },

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T02:01:51.207

不要认为这是可能的，如果是的话，这似乎是一个安全漏洞。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-30T02:27:42.933

是的，不可能... Javascript 在安全的环境中运行，并且所有 FF 扩展都是 javascript，因此您将无法与操作系统进行太多交互...但是我会留下来看看是否有人知道一种方法（它会很酷...）

# c# - 为什么字典不像 Hashtable 那样访问不存在的键？

> ID：399270
> 
> 赞同：5
> 
> 时间：2008-12-30T01:19:19.873
> 
> 标签：c#, .net, dictionary, hashtable

如果我使用 a `Hashtable`，我可以编写如下代码：

```
object item = hashtable[key] ?? default_value; 
```

无论是否`key`出现在`Hashtable`.

我不能用`Dictionary<TKey. TValue>`. 如果字典中不存在该键，则会抛出一个`KeyNotFoundException`. 所以我必须写这样的代码：

```
MyClass item;
if (!(dict.TryGetValue(key, out item))
{
   item = default_value;
} 
```

我想知道这是为什么。 `Dictionary<TKey, TValue>`只是一个包装`Hashtable`。为什么要加上这个限制？

**编辑：**

从另一个角度来看 PopCatalin 的答案（见下文），如果字典的值是值类型，我上面编写的代码将不起作用。如果我使用的是`Dictionary<int, int>`，那么我想使用的代码*如下*所示：

```
int i = dict[key] ?? default_value; 
```

这不会编译，因为`dict[key]`它不是可为空的或引用类型。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T03:13:01.640

`Dictionary<T>`a和 a之间的区别在于`Hashtable`a`Dictionary<T>`是一种泛型类型，可以专门用于沿引用类型存储值类型。

哈希表只能存储引用类型（`Object`通过引用传递）和被装箱的值类型（也通过引用传递）。

当字典专门用于值类型时，它必须“按值”而不是通过引用返回这些值。因此，a`Dictionary<T>`不能返回 null，因为 null**不是**值类型的有效值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-30T01:28:07.967

你的帖子有一个误解。字典不是 Hashtable 的包装器。这是一个完全不同的实现。

做出这种改变的原因主要是由一个断言来证明的：Null 是哈希表的有效值。如果没有此更改，则无法使用 [] 访问方法区分不存在的键和具有空值的值键。字典清除了这一点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T01:28:13.130

Dictionary.ContainsKey 可能比 TryGetValue 更适合您。

但至于为什么，不知道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T02:41:07.180

我为此写了一个扩展。

```
public static class DictionaryExtension
{
    public static TValue GetValueOrDefault<TKey, TValue>(this Dictionary<TKey, TValue> items, string key)
    {
        if (items != null && items.ContainsKey(key))
        {
            return items[key];
        }

        return default(TValue);
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T01:27:19.310

如果您使用 Reflector 查看代码，您会看到 Dictionary 尝试找到键，如果找不到键，则会*显式*引发异常。

```
public TValue get_Item(TKey key)
{
    int index = this.FindEntry(key);
    if (index >= 0)
    {
        return this.entries[index].value;
    }
    ThrowHelper.ThrowKeyNotFoundException();
    return default(TValue);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T01:25:51.607

我很确定这个限制是首先创建包装器的功能原因之一。

# java - Java WAR 文件中的 favicon.ico

> ID：399286
> 
> 赞同：21
> 
> 时间：2008-12-30T01:33:32.263
> 
> 标签：java, jakarta-ee, war, favicon

任何人都可以提供一些关于如何设置战争文件以在浏览器地址栏中显示 favicon.ico 的说明吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-30T08:21:12.300

您还可以在 HTML 中使用以下 HTML 标记：

```
<link rel="icon" type="image/gif" href="/img/image.gif"> 
```

大多数较新的浏览器应该支持它，我认为这通常是一种更干净的方式，因为您可以使用任何您想要的图像类型/名称/位置。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-30T02:02:31.737

这在不同的应用程序服务器中可能会有所不同。对于 tomcat，favicon 来自您的根上下文映射到的目录。因此，如果您的应用程序映射到根上下文 [/]，只需将 favicon.ico 文件放在您的 war 文件的顶级文件夹中。

# ruby-on-rails - 是否可以在rails中获取原始参数字符串？

> ID：399290
> 
> 赞同：9
> 
> 时间：2008-12-30T01:36:47.467
> 
> 标签：ruby-on-rails, ruby, url

给定以下网址：

```
http://foo.com?bar=1&wee=2 
```

从动作中获取 url 的原始参数部分的最快方法是什么？

IE

```
?bar=1&wee=2 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-30T01:43:31.650

当然，只需在控制器中使用 request.query_string

# amazon-ec2 - EC2 的平均正常运行时间？

> ID：399291
> 
> 赞同：14
> 
> 时间：2008-12-30T01:38:54.110
> 
> 标签：amazon-ec2, amazon-web-services

好奇 99.95% 的正常运行时间真的意味着；每个月真的会减少7分钟吗？请在 EC2 上发布最长/平均正常运行时间，谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-30T06:57:33.717

通常正常运行时间是按年计算的。因此，如果您有 99.95% 的服务水平协议，这意味着：

```
365 * 0.0005 = 0.1825 days or 4.38 hours 
```

如果在一年的服务期间出现中断并且您的系统停机时间超过此时间，那么您需要承担赔偿责任。

至于你的问题，我有一台服务器在 EC2 中不间断地运行了大约 3 个月。我会说他们的正常运行时间很好，但是如果您有一个关键任务应用程序，您肯定需要一个故障转移解决方案。良好的正常运行时间仅意味着他们将能够快速响应中断。如果您没有为停机做好准备，即使是 99.9999% 的正常运行时间也无法挽救您。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-04T16:25:52.507

仔细阅读 SLA ( [http://aws.amazon.com/ec2-sla/](http://aws.amazon.com/ec2-sla/) ) 他们只将“区域不可用”计为停机时间，更重要的是，如果该区域连续 5 分钟停机，他们只会将其计为停机时间。

> ““年度正常运行时间百分比”是通过从 100% 中减去 Amazon EC2 处于“区域不可用”状态的服务年度中的 5 分钟周期的百分比来计算的。

根据我的计算，这意味着任何少于 4 分钟的停机时间都是不可数的。此外，如果他们确实违反了 SLA，他们只会在您有最大停机费用的那个月的 %10 内出现。因此，如果他们在整个 1 月份都处于亏损状态，而您的账单为 100 美元，他们将向您的帐户提供 10 美元的信用额度。

我很难说服我的老板这是一个具有类似 SLA 的严肃产品。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-10-25T00:08:47.467

SLA 是没用的。他们只衡量公司愿意承担多少风险，与实际正常运行时间无关。我看到当公司知道无法满足 SLA 以进行销售时，会提供 SLA 并处以重罚。

我有一个客户的 EC2 正常运行时间超过 400 天，而另一个客户通过网络脉冲测量的时间超过 300 天，这是迄今为止我使用过的最可靠的服务。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-26T14:00:28.550

对于我在美国东部可用区运行的单个实例，9 个月，0 停机时间。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-15T22:58:39.427

自从亚马逊转而提供 SLA 以来，我从来没有遇到过任何实例对我造成影响。过去当我有实例出现故障时，Amazon 总是会发送一条消息，通知我该实例在实际消失之前已降级，因此我有时间启动一个新实例。

不过，前面的答案说得很好；EC2 的服务模型要求您编写应用程序来处理故障转移到新服务器，如果您没有准备好延长停机时间。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-20T09:43:17.553

```
conrad@papa ~ $ uptime
 04:42:36 up 495 days,  8:51,  8 users,  load average: 0.02, 0.02, 0.00 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-18T11:48:19.867

查看[AWS 服务运行状况仪表板](http://status.aws.amazon.com/)将使您对任何当前或过去的问题有一个很好的了解。我的经验是，AWS 的正常运行时间比大多数“传统”托管选项（甚至是成熟的冗余 RackSpace 设置...）都要好。

然而，简单地使用 AWS 来延长正常运行时间就像为钥匙链买一辆汽车（好吧，几乎......；））。借助使用 AWS 的架构，最大的好处是可扩展（无需前期成本）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-03-02T05:56:10.680

SLA...保证正常运行时间...

这些都是非常好的标语。但是，当服务器在一个小时内（2012 年 3 月 1 日，在欧盟地区）不可用并且客户端开始呼叫时，它们仍然有 300 天的正常运行时间对您没有帮助。

当闪电击中他们在欧盟的 3 个数据中心中的 1 个时，我们都发现他们没有异地冗余，而且他们拥有 3 个数据中心这一事实并不意味着什么。

人们一定喜欢“性能下降”这个词，它实际上意味着：“祈祷你的数据在灾难过去后仍然可用”。

我仍在尝试寻找有关其所有数据中心可用性百分比的任何官方/非官方统计数据。

到目前为止没有运气...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-11-27T23:55:10.777

我从来没有在 EC2 上遇到过停机时间，但是，我会保留本地备份并制作我的机器的每日映像，并将它们移植到另一个可用区，以防万一。如果通过电话呼叫我的所有设备无法访问机器，我会使用 twilio 来提醒我。然后我可以登录到 EC2 并在另一个可用区启动一台机器；最坏的情况下我会倒下几分钟。

就我而言，这可能很糟糕，因为我的机器正在进行 24/7 的外汇交易。

我的规则：了解停机时间的潜在成本，并愿意在冗余方面投入大量资金，假设它会发生——因为它会发生。

也就是说，EC2 从未让我失望。可能有助于我的服务器不在自然灾害常见的国家地区。如果您在地震带、龙卷风小巷或潜在的飓风路径中，停机确实是不可避免的。

# c# - 从 .Net 应用程序打开 VB6 表单时，内存无法“读取”错误

> ID：399295
> 
> 赞同：0
> 
> 时间：2008-12-30T01:40:22.250
> 
> 标签：c#, vb6, interop, windows-server-2000

我有一个用 C#.Net 编写的应用程序（如果重要，框架 2.0）。它调用一个 VB6 exe，该 exe 使用一种方法公开一个 COM 类 - 显示一个表单。

当 VB 窗体关闭时，我收到系统错误（Windows 消息）：无法读取内存位置。然后，Windows 询问我是关闭应用程序还是调试它。我选择什么并不重要，因为测试机器上没有安装调试器，当我选择调试时，它会给我一条消息，它必须关闭。

该错误仅在两种情况下发生（两者都必须适用）：

*   当它在 Windows 2000 下运行时。
*   此外，只有当我首先单击“显示报告”按钮时才会发生这种情况，该按钮调用另一个 COM DLL - Crystal 报告 - 来生成报告。

基本上，流程是这样的：

```
    C#.Net 应用程序
     |-- MDI表格
          | 单击窗体上的按钮时，调用 VB6 方法
          +-- 显示表格。调用 setParent(VBForm.Handle, DotNetForm.Handle)
          | 并显示表格。被调用的方法返回（没有返回值）
          | |
          | +-- 点击“显示报表”时，使用水晶报表生成报表并展示给用户
          | |
          | \-- 单击退出按钮时，表单关闭 -这是发生错误的地方
          |
          \-- .Net 形式在内部形式关闭后仍然存在很长时间

```

有谁知道什么可能导致这样的错误？VB`On Error Goto`在整个 Main 方法周围有一条线，它应该捕获 VB 中的任何错误 - 但它没有。但是，错误确实来自 VB 生成的 EXE 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T02:03:59.220

您可以通过附加一个非托管调试器并查看堆栈跟踪是什么来确认 VB exe 中的哪个模块正在崩溃。

Crystal Reports 听起来可能是罪魁祸首，但也有可能是其他原因引发了问题。假设您可以访问 VB 代码，我将检查所有 Crystal Report COM 对象是否正确释放。如果遗留了一些东西，那么它可能会与应用程序关闭进行不良交互。

如果您想要一个非常老套的解决方案，您可以考虑在 OnClose 事件中调用 Win32 TerminateProcess 函数。这将在不通知任何附加的 DLL 的情况下终止进程……不漂亮，并可能导致与数据库的连接悬空，等需要自行清理（可能在超时时）。

# c# - WPF 默认凭据

> ID：399300
> 
> 赞同：1
> 
> 时间：2008-12-30T01:41:12.030
> 
> 标签：c#, wpf

我正在尝试从 WPF 访问 .net 2.0 Web 服务。我使用 Visual Studio 生成了代理，还生成了默认凭据的代理凭据。

我在访问 Web 服务时收到 401 Unauthorized。当我从默认凭据输出用户名时，它是空的，我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T02:00:02.927

找到了我的问题的解决方案，

{代理}.UseDefaultCredentials = true; 将此标志设置为true后有效

# ruby-on-rails - 何时使用 Helpers 而不是 Partials

> ID：399302
> 
> 赞同：45
> 
> 时间：2008-12-30T01:42:21.277
> 
> 标签：ruby-on-rails, helper, partials

在 Rails 应用程序中，在什么情况下会使用 partial 以及何时使用 helper？我发现两者非常相似，因为它们代表标记片段。

有没有围绕这个的约定？使用它们的“导轨方式”是什么？

谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-30T01:53:18.777

我想我的经验法则是使用一个助手来构建一个单一的“单元”显示——比如一个包含链接的跨度——并使用一个部分来构建一个由多个“单元”组成的更复杂的显示单元”的显示——像一个网格或一个菜单。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-12-30T02:55:10.553

部分是视图片段，在多个地方都有用的视图片段并被拉出以消除重复。然而，底线是视图 - 独立的或部分的 - 用于呈现。

如您所知，控制器用于处理逻辑。然而，在呈现视图时不可避免地需要一些逻辑处理。因此，例如，如果您有一些仅对管理员可用的演示文稿，您可能会将该逻辑提取到帮助程序并保持视图“纯”和仅演示文稿。助手将不可避免地包含演示代码 - html 标记等 - 但这是它们使用的副产品，而不是它们的主要功能。

您还可以将两者结合起来 - 一个用于管理演示，另一个用于用户演示，以及一个具有逻辑的助手，以确定在特定情况下呈现哪个。

只是我的 0.02 美元。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-03-03T07:28:43.917

其他答案代表了关于使用助手与部分的概念共识。考虑以下内容以供进一步阅读：

Basecamp 开发人员提出了在帮助程序中最小化 HTML 的案例 [http://37signals.com/svn/posts/1108-what-belongs-in-a-helper-method](http://37signals.com/svn/posts/1108-what-belongs-in-a-helper-method)

Viget 开发人员对每个基准进行了基准测试，发现助手比部分更快 [http://www.viget.com/extend/helpers-vs-partials-a-performance-question/](http://www.viget.com/extend/helpers-vs-partials-a-performance-question/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T02:38:04.643

当代码很可能在其他项目中再次使用时，我使用帮助程序，以及特定于项目的代码的部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-30T02:45:01.090

我使用部分作为子模板（即，带有大量标记的东西，如博客文章简介）和帮助处理显示更多逻辑的东西（例如，只有管理员可见的 div）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-03T07:36:30.460

部分是视图的一部分，它可以有一堆 HTML 代码和 ruby​​ 代码。您还可以在渲染方法中使用控制器中的部分。

在助手的情况下，您可以使用短 html 代码的方法。您可以在视图文件中使用一些与计算相关的方法。

# c++ - 存储巨大的 std::map，主要在磁盘上

> ID：399304
> 
> 赞同：11
> 
> 时间：2008-12-30T01:42:37.737
> 
> 标签：c++, data-structures

我有一个 C++ 程序，它可能会生成大量数据——数十亿条不同大小的二进制记录，最有可能小于 256 字节，但有一些延伸到几 K。大多数记录很少被查看创建后的程序，但有些会定期访问和修改。没有办法知道它们是什么时候创建的。

考虑到数据量，我无法将其全部存储在内存中。但由于数据只需要按其编号（一个 64 位整数）进行索引和访问，我*不*想要一个成熟的数据库程序的开销。理想情况下，我想把它当作一个`std::map`数据存储在磁盘上，直到被请求。

是否有一个已经编写好的库可以满足我的需求，还是我需要自己编写？

编辑：经过一番思考，我意识到 Rob Walker 的回答有一个正确的观点：我很难从我从真实数据库中获得的自制课程中获得接近相同类型的数据完整性.

尽管 BerkeleyDB（如 RHM 所建议的那样）看起来完全符合我们的要求，但双重许可是我们不想处理的一个令人头疼的问题。当我们完成代码并且可以证明它会从 BerkeleyDB 中显着受益（它可能会）时，我们将重新检查这个问题。

我确实看过 Ferruccio 对 stxxl 的建议，但我不知道它将如何处理被中断和重新启动的程序（可能会发生变化）。有了这么多数据，如果可以保存一些数据，我不想每次都放弃已经完成的工作并重新开始。

所以我们决定使用 SQLite 数据库，至少在最初的开发中是这样。感谢所有回答或投票的人。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T01:59:14.583

看看[STXXL](http://stxxl.sourceforge.net/)。

`stxxl::map<>`看起来它完全符合您的需要。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T01:55:50.160

我怀疑您会找到一个完全满足您要求的库，因此您必须决定哪些“功能”对您真正重要，然后决定现有的数据库解决方案是否足够接近。

数十亿条记录无论如何都是一个庞大的数据集。以什么速率生成记录？他们能坚持多久？访问模式是否会随着时间而改变？

更新总是与原始数据量相同吗？

我建议在开始推出自己的解决方案之前明确证明数据库解决方案无法正常工作，特别是如果数据的完整性至关重要（通常是......）可靠地维护磁盘上的数据量绝对可以一个挑战。更改数据时是否需要任何类型的事务语义？客户端是多线程的吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-30T01:47:16.447

BerkleyDB 可能对你有好处。它基于字符串而不是数字进行索引，但您可以将数字格式化为十六进制。应该与基于磁盘的键/值查找一样快。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-16T02:16:00.560

我用过 Gigabase [http://www.garret.ru/gigabase.html](http://www.garret.ru/gigabase.html)，在几个项目中，它有一个简洁的 C++ 接口，我处理过数百万条记录没有问题，它支持回滚。它具有类似 MIT 的许可证，而且作者回答问题和修复错误的速度非常快。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-01-16T02:31:38.123

您可以使用 SQLLite，它是一个向公共领域发布的开源数据库。

[http://www.sqlite.org/](http://www.sqlite.org/)

我会引用他们的页面：

> SQLite 是一个实现自包含、无服务器、零配置、事务性 SQL 数据库引擎的软件库。SQLite 是世界上部署最广泛的 SQL 数据库引擎。SQLite 的源代码在公共领域。

和

> SQLite 的持续开发和维护部分由 SQLite 联盟成员赞助，包括：Adobe、Symbian、Bloomberg、Mozilla

如果您需要一个轻量级数据库，这可能就是它

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T02:08:31.130

你可能不得不自己动手。我可能会将它放在几个 mysql 表中并延迟加载固定大小的地图（lru）。如果您真的不想避免使用数据库，请将 < 256 或任何长度的记录放在固定记录随机访问文件中，并将较大的记录存储为单独的文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-31T16:57:36.297

根据您需要的性能特征，答案会有所不同。但仅考虑问题描述中的信息，我认为数据库是矫枉过正的，实际上可能会适得其反。

在每个条目生成后立即将其保存为名称为其键的文件（即键“1”对应于磁盘上的文件“1.dat”）是一种避免多个问题的简单解决方案。假设您可以控制软件将在哪个文件系统上运行，如果您选择具有良好完整性的文件系统，那么您的数据应该具有良好的完整性。您可以编写大量代码将条目分组到一个文件中，然后不必担心调整大小，或者您可以让文件系统为您处理（它旨在处理文件大小的变化）。您可能会担心以线程安全的方式将它们写入该文件，或者您可以让文件系统为您处理（文件系统旨在让不同的进程同时写入不同的文件）。您可能会担心文件被部分保存到磁盘并编写代码来检查它，或者您可以让文件系统为您处理（日志和原子写入）。您可能会担心将更改的写入安排在一起以提高速度，或者您可以让文件系统为您处理这个问题（写入缓存）。

基本上，一个好的文件系统和操作系统应该为您处理所有这些，并且在其之上添加一个试图复制所有这些功能的数据库只会增加更多的复杂性和更多的错误可能性。如果您需要按不同的字段索引数据，那么数据库可能是有意义的，但是在您的描述中，您说您只需要每次都按相同的整数键索引数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-02-06T02:43:27.280

我同意其他人的观点，即 BerkeleyDB、sqlite 或 gigabase 应该是很好的解决方案。

但是**编写自己的解决方案**也不应该太难。

我有一个简单的解决方案，但有三个先决条件：

1.  您至少可以在内存中保留一个`std::vector<int64>`with`numkey`元素。
2.  您的键是或可以是连续的。
3.  文件写入后，每条数据记录的大小是固定的`maxsize`，即不能增加大小。

如果满足这些先决条件，直接的解决方案是将每个键 (int64) 的文件位置 (int64) 存储在内存中的向量中。对于查找，只需从向量中检索文件位置`seek`到该位置，您可以在该位置找到记录大小作为其第一个条目，然后读取`size`字节。

# java - ArrayList 和添加项目的问题

> ID：399311
> 
> 赞同：1
> 
> 时间：2008-12-30T01:49:11.077
> 
> 标签：java, collections, arraylist

我请你帮忙。

我为我的英语道歉，它还在学习中。我在 Java 的 GUI 中做了一个应用程序。我有一个问题。

在这个应用程序中，我有一个 ArrayList，我想与数据会面。

用户单击按钮，来自 JTextfield 的数据应放置在 Arraylist 中。

当他们这样做时，它只插入第一行。Arraylist 中的其他条目不是。

请问我该怎么做。

这是我的应用程序的代码：

```
public void save_to_array(String jmeno_zad,
                          String prijmeni_zad,
                          String rodne_cislo_zad,
                          String mesto_zad,
                          String spz_zad,
                          String barva_zad, 
                          String vin_zad, 
                          String znacka_zad){

            String arraytext=prijmeni_zad+ ","+
            jmeno_zad+ ","+ 
            rodne_cislo_zad+ ","+
            mesto_zad+","+
            spz_zad+","+
            barva_zad+","+
            vin_zad+","+
            znacka_zad; 

            int posl=arlist.size(); 
            if(arlist.isEmpty()||posl==1){ 
                arlist.add(0,arraytext);
            } 

            if(!arlist.isEmpty()&& posl>1){ 
                arlist.add(posl-1, cele_jmeno); 
            }
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T02:07:10.197

只需使用 ArrayList.add(arraytext)，而不是 ArrayList.add(0, arraytext)。你真的不在乎它最终处于什么位置，是吗？

代替

```
 int posl=arlist.size(); 
 if(arlist.isEmpty()||posl==1){ 
            arlist.add(0,arraytext);
  }
  if(!arlist.isEmpty()&& posl>1){ 
            arlist.add(posl-1, cele_jmeno); 
  } 
```

和

```
arlist.add(arraytext); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-30T02:35:20.500

到目前为止，您收到的所有答案都是正确的。确切地说，如果您想将其添加到数组列表中并且您并不真正关心该位置，只需使用

```
arrayList.add(arrayText) 
```

否则，使用 TreeSet 会有所帮助。

我尝试这个问题的原因是，您的方法参数正在产生恶意代码气味。我对适当的建议没有几个问题。

*   你真的需要 8 个参数吗？为什么不定义 POJO（Plain Old Java Object）
*   如果您认为需要再传递一件事作为论据，会发生什么？你会把它增加到9吗？POJO 是有道理的，而且绝对是一种更清洁的方式
*   为什么要将所有值连接成一个用逗号分隔的字符串作为分隔符？为什么没有 POJO 列表？它不会达到你的目的吗？实际上，这种方式我不知道您需要操作该字符串多少次，这将导致每次您需要单个特定元素时都进行不必要的工作，并且显然会影响性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T02:08:35.047

好的，让我看看我是否理解正确。

你有一个 JTextField。

至于您的代码，我了解，如果 arraylist 为空，您应该将文本放在第一个位置。

如果不是空的应该去下面的位置？

那将是这样的：

```
public void saveToArray(  String jmeno_zad,
                          String prijmeni_zad,
                          String rodne_cislo_zad,
                          String mesto_zad,
                          String spz_zad,
                          String barva_zad, 
                          String vin_zad, 
                          String znacka_zad) {

            String arrayText=prijmeni_zad+ ","+
                             jmeno_zad+ ","+ 
                             rodne_cislo_zad+ ","+
                             mesto_zad+","+
                             spz_zad+","+
                             barva_zad+","+
                             vin_zad+","+
                             znacka_zad; 

            arrayList.add( arrayText );

 } 
```

默认情况下，如果 arraylist 为空，则文本将位于第一个位置。下一个添加将在第 2、第 3 等中。

我希望这有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T02:12:34.883

如果您关心它的位置，请尝试将其添加到 SortedSet（可能是 TreeSet）

# functional-programming - 什么是欣德利-米尔纳？

> ID：399312
> 
> 赞同：137
> 
> 时间：2008-12-30T01:49:43.183
> 
> 标签：functional-programming, types, inference, hindley-milner

我遇到了这个术语*Hindley-Milner*，我不确定是否理解它的含义。

我已阅读以下帖子：

*   Steve Yegge -[动态语言反击](http://steve-yegge.blogspot.com/2008/05/dynamic-languages-strike-back.html)
*   Steve Yegge - 匹诺[曹问题](http://steve-yegge.blogspot.com/2007/01/pinocchio-problem.html)
*   Daniel Spiewak -[什么是 Hindley-Milner？（为什么它很酷？）](https://web.archive.org/web/20181118000004/http://www.codecommit.com/blog/scala/what-is-hindley-milner-and-why-is-it-cool)

但是在维基百科中没有这个术语的单一条目，通常会为我提供简明的解释。
^(**注意**-[现在已添加一个](http://en.wikipedia.org/wiki/Hindley%E2%80%93Milner))

它是什么？
什么语言和工具实现或使用它？
你能提供一个简洁的答案吗？

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2008-12-30T02:34:42.780

Hindley-Milner 是由 Roger Hindley（研究逻辑）和后来的 Robin Milner（研究编程语言）独立发现的**类型系统。**Hindley-Milner 的优点是

*   支持**多态**函数；例如，一个函数可以为您提供与元素类型无关的列表长度，或者一个函数执行二叉树查找，而与存储在树中的键的类型无关。

*   有时一个函数或值可以有**多个类型**，例如长度函数的例子：它可以是“整数到整数的列表”、“字符串到整数的列表”、“对整数的列表”等等在。在这种情况下，Hindley-Milner 系统的一个信号优势是**每个类型良好的术语都有一个唯一的“最佳”类型**，称为*主要类型*。list-length 函数的主要类型是“for any `a`, function from list of `a`to integer”。这`a`是一个所谓的“类型参数”，它**在 lambda 演算中是显式的，**但**在大多数编程语言中是隐式的**。***参数*多态性**。（如果您在 ML 中编写长度函数的定义，您可以看到类型参数：

    ```
     fun 'a length []      = 0
       | 'a length (x::xs) = 1 + length xs 
    ```

*   *如果*一个术语具有 Hindley-Milner 类型，则**可以推断出主体类型，而无需**程序员进行任何类型声明或其他注释。（这是喜忧参半，因为任何人都可以证明谁曾经处理过大量没有注释的 ML 代码。）

Hindley-Milner 是几乎所有静态类型函数式语言的类型系统的基础。此类常用语言包括

*   ML 系列（[标准 ML](http://en.wikipedia.org/wiki/Standard_ML)和[Objective Caml](http://caml.inria.fr/)）
*   [哈斯克尔](http://www.haskell.org)
*   [干净的](http://clean.cs.ru.nl/)

所有这些语言都扩展了 Hindley-Milner；Haskell、Clean 和 Objective Caml 以雄心勃勃和不同寻常的方式做到了这一点。（处理可变变量需要扩展，因为基本的 Hindley-Milner 可以被颠覆，例如，使用包含未指定类型值列表的可变单元格。此类问题由称为[*值限制*](http://users.cs.fiu.edu/~smithg/cop4555/valrestr.html)的扩展处理。）

许多其他基于类型函数式语言的次要语言和工具使用 Hindley-Milner。

Hindley-Milner 是[System F](http://en.wikipedia.org/wiki/System_F)的一个限制，它允许更多类型但**需要程序员注释**。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-30T02:12:26.223

您可以使用 Google Scholar 或 CiteSeer 或您当地的大学图书馆找到原始论文。第一个太老了，你可能得找杂志的装订本，我在网上找不到。我为另一个找到的链接已损坏，但可能还有其他链接。你肯定能找到引用这些的论文。

Hindley, Roger J，*组合逻辑中对象的主要类型方案，*美国数学会汇刊，1969 年。

Milner, Robin，*类型多态性理论*，计算机与系统科学杂志，1978 年。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-04T04:53:12.373

C# 中的简单 Hindley-Milner 类型推断实现：

[Hindley-Milner 对（Lisp-ish）S 表达式的类型推断，使用不到 650 行 C#](https://repl.it/CmiB/7)

请注意，该实现仅在 270 行左右的 C# 行范围内（无论如何，对于算法 W 本身和支持它的少数数据结构）。

用法摘录：

```
 // ...

    var syntax =
        new SExpressionSyntax().
        Include
        (
            // Not-quite-Lisp-indeed; just tolen from our host, C#, as-is
            SExpressionSyntax.Token("\\/\\/.*", SExpressionSyntax.Commenting),
            SExpressionSyntax.Token("false", (token, match) => false),
            SExpressionSyntax.Token("true", (token, match) => true),
            SExpressionSyntax.Token("null", (token, match) => null),

            // Integers (unsigned)
            SExpressionSyntax.Token("[0-9]+", (token, match) => int.Parse(match)),

            // String literals
            SExpressionSyntax.Token("\\\"(\\\\\\n|\\\\t|\\\\n|\\\\r|\\\\\\\"|[^\\\"])*\\\"", (token, match) => match.Substring(1, match.Length - 2)),

            // For identifiers...
            SExpressionSyntax.Token("[\\$_A-Za-z][\\$_0-9A-Za-z\\-]*", SExpressionSyntax.NewSymbol),

            // ... and such
            SExpressionSyntax.Token("[\\!\\&\\|\\<\\=\\>\\+\\-\\*\\/\\%\\:]+", SExpressionSyntax.NewSymbol)
        );

    var system = TypeSystem.Default;
    var env = new Dictionary<string, IType>();

    // Classic
    var @bool = system.NewType(typeof(bool).Name);
    var @int = system.NewType(typeof(int).Name);
    var @string = system.NewType(typeof(string).Name);

    // Generic list of some `item' type : List<item>
    var ItemType = system.NewGeneric();
    var ListType = system.NewType("List", new[] { ItemType });

    // Populate the top level typing environment (aka, the language's "builtins")
    env[@bool.Id] = @bool;
    env[@int.Id] = @int;
    env[@string.Id] = @string;
    env[ListType.Id] = env["nil"] = ListType;

    //...

    Action<object> analyze =
        (ast) =>
        {
            var nodes = (Node[])visitSExpr(ast);
            foreach (var node in nodes)
            {
                try
                {
                    Console.WriteLine();
                    Console.WriteLine("{0} : {1}", node.Id, system.Infer(env, node));
                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.Message);
                }
            }
            Console.WriteLine();
            Console.WriteLine("... Done.");
        };

    // Parse some S-expr (in string representation)
    var source =
        syntax.
        Parse
        (@"
            (
                let
                (
                    // Type inference ""playground""

                    // Classic..                        
                    ( id ( ( x ) => x ) ) // identity

                    ( o ( ( f g ) => ( ( x ) => ( f ( g x ) ) ) ) ) // composition

                    ( factorial ( ( n ) => ( if ( > n 0 ) ( * n ( factorial ( - n 1 ) ) ) 1 ) ) )

                    // More interesting..
                    ( fmap (
                        ( f l ) =>
                        ( if ( empty l )
                            ( : ( f ( head l ) ) ( fmap f ( tail l ) ) )
                            nil
                        )
                    ) )

                    // your own...
                )
                ( )
            )
        ");

    // Visit the parsed S-expr, turn it into a more friendly AST for H-M
    // (see Node, et al, above) and infer some types from the latter
    analyze(source);

    // ... 
```

...产生：

```
id : Function<`u, `u>

o : Function<Function<`z, `aa>, Function<`y, `z>, Function<`y, `aa>>

factorial : Function<Int32, Int32>

fmap : Function<Function<`au, `ax>, List<`au>, List<`ax>>

... Done. 
```

另请参阅[Brian McKenna 在 bitbucket 上的 JavaScript 实现](https://bitbucket.org/puffnfresh/js-type-inference/src)，这也有助于入门（对我有用）。

'HTH，

# javascript - 检测是否使用 Javascript 正确加载了 Flash 应用程序？

> ID：399314
> 
> 赞同：8
> 
> 时间：2008-12-30T01:51:00.340
> 
> 标签：javascript, flash

我的产品打开一个 Web 浏览器并将其指向一个包含本地 Flash 应用程序的 HTML 文件。如何以编程方式检测此文件是否成功加载，如果没有则抛出什么异常？有没有办法使用 Javascript 来做到这一点？

从外部检查文件是否存在于磁盘上是不够的，因为我已经看到发生了其他故障（可能涉及竞争条件）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-30T02:24:28.963

回答我自己的问题：[https ://sourceforge.net/forum/message.php?msg_id=5929756](https://sourceforge.net/forum/message.php?msg_id=5929756)

1.  定义加载 Flash 时应调用的 Javascript 函数。
2.  从 Flash 文件的顶部调用此方法。
3.  使用计时器来检测回调是否从未被调用。
4.  更喜欢从 Flash 调用 Javascript 函数而不是从 Javascript 调用 Flash 函数。无论哪种方式，您都无法调用尚未加载的函数。在从 Flash 调用它之前保证浏览器已经完成加载你的 Javascript 函数比在从 Javascript 调用它之前保证 Flash 完成加载你的 Flash 函数要容易得多。

这是一个例子：

*   我正在使用[swfobject](http://code.google.com/p/swfobject/)嵌入 Flash。
*   我使用 FlashVars 来告诉 Flash 要调用哪个 Javascript 函数。如果页面上有多个 Flash 对象，这很有用。

**闪光**

```
var params:Object = LoaderInfo(this.root.loaderInfo).parameters;
if (ExternalInterface.available)
{
    var onLoaded:String = params["onLoaded"];
    if (onLoaded != null)
        ExternalInterface.call(onLoaded, true);
} 
```

**Javascript**

```
var flashLoaded = false;
var flashTimer;

function onFlashLoaded()
{
    flashLoaded = true;
    clearTimeout(flashTimer);
}

function onFlashTimeout()
{
    if (!isFlashLoaded)
    {
        // Remove the Flash object in case it is partially loaded
        $("#videoFeed").empty();
        $("#videoFeed").append('<div id="flashObject"></div>');
        alert("Failed to load video player");
    }
    clearTimeout(flashTimer);
}

function connectToVideo()
{
    var flashvars = {};
    flashvars.onLoaded = "onFlashLoaded";

    var params = {};
    params.menu = false;

    var attributes = {};

    isFlashLoaded = false;
    flashTimer = setTimeout("onFlashTimeout()", 5000);

    swfobject.embedSWF("flash/VideoFeed.swf", "flashObject", "800", "600", "11", "expressInstall.swf", flashvars, params, attributes);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-06-28T00:08:52.277

在您无法修改 swf 并且无法添加 ExternalInterface 的情况下，您仍然可以使用 Javascript 来获取 swf 的状态。例如，您可以从 Javascript 中调用 document.getElementById(swf_id).PercentLoaded()，并等待它为 100。

这不会告诉您如果 swf 加载失败会引发什么异常，但至少您会确定它是否已加载。在这里可以找到其他有用的调用：http: [//www.adobe.com/support/flash/publishexport/scriptingwithflash/scriptingwithflash_03.html](http://www.adobe.com/support/flash/publishexport/scriptingwithflash/scriptingwithflash_03.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-03T21:37:59.697

实际上，当 HTML 页面加载完成时，Flash 内容可能还没有完全加载。如果 SWF 没有完成加载，那么它将看起来失败。

我通常推荐的方法是，当调用文档类构造函数时，让 SWF 立即通过 ExternalInterface 调用 JavaScript 函数。基本上，假设 SWF 加载失败，除非调用该 JS 函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T10:24:06.713

根据 adobe ExternalInterface 文档： http: [//livedocs.adobe.com/flex/3/langref/flash/external/ExternalInterface.html](http://livedocs.adobe.com/flex/3/langref/flash/external/ExternalInterface.html) 一些网络浏览器限制通过文档类构造函数中的 ExternalInterface 调用 Javascript 函数，如果弹出阻止程序是启用。

是否有其他解决方案可以检测 swf 电影何时已成功加载？

# silverlight - 对 C#/Silverlight 工作流程感到困惑

> ID：399324
> 
> 赞同：0
> 
> 时间：2008-12-30T01:56:46.287
> 
> 标签：silverlight

我正在为我的 ASP.NET Web 应用程序开发一些图表控件。

我知道 visifire 和 MS 现在提供的 Silverlight 图表。我的要求是在我知道这些及其版本之前提出的，我打算编写与 Dundas 或 ChartFX 一样好的图表（或者它是 SoftwareFX？）。

无论如何，由于逻辑是逻辑最密集的部分，我在一个类中编写了一些方法。诸如“为 int[] 中的每个 int 绘制点，将其绘制在特定坐标的图表上（例如，值 10 向上 10 个像素等）”。

了解了逻辑，Silverlight 又是从哪里来的呢？

我可以在 XAML 中设计图表元素（我正在使用 KaXAML），然后我将如何引用 C# 方法来绘制点？

简而言之，我如何从 XAML 引用 C#，反之亦然？我可以构建一个没有 C# 逻辑的 Silverlight 控件，然后在我的解决方案中实现它吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T02:02:57.930

我建议使用提供图表功能的开箱即用控件，例如[Silverlight Control Toolkit](http://www.codeplex.com/Silverlight/Wiki/View.aspx?title=Silverlight%20Toolkit%20Overview%20Part%202&referringTitle=Home)。除非您需要它不提供的特定功能。在这种情况下，您仍然可以将源用作要创建的控件的起点。

# python - Tix 和 Python 3.0

> ID：399326
> 
> 赞同：0
> 
> 时间：2008-12-30T01:57:34.303
> 
> 标签：python, python-3.x, tix

有没有人在 python 3.0 下看到 Tix 中的任何东西？我已经尝试过这些示例，但是在创建任何内容时，它都声明 cnf 是不可订阅的。

我还注意到 Dir Select 的东西（DirList DirTree）在 2.6.1 下都不起作用。

为什么 Python 既不转储 Tix 也不支持它？它有很多好东西可以制作简单的程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T02:41:54.357

可能发生的事情是没有人注意到这个错误。（自动测试 Tix 和 Tkinter 之类的 GUI 库非常困难。）您应该在发现错误时向[http://bugs.python.org](http://bugs.python.org)报告错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T11:31:40.153

一般来说，如果你使用第三方模块，你最好暂时避免使用 Python 3.0。如果您自己正在开发第三方模块，那么移植到 Python 3.0 是一个好主意，但目前在它的一般开发中只是一个痛苦的秘诀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-26T09:02:40.587

看到这个：[http ://docs.python.org/3.1/library/tkinter.tix.html?highlight=tix#module-tkinter.tix](http://docs.python.org/3.1/library/tkinter.tix.html?highlight=tix#module-tkinter.tix)

# php - 最快的找回方法 in PHP</h1> <div id="body"><p>I'm doing a bookmarking system and looking for the fastest (easiest) way to retrieve a page's title with PHP. </p> <p>It would be nice to have something like <code>$title =

> ID：399332
> 
> 赞同：29
> 
> 时间：2008-12-30T02:01:08.463
> 
> 标签：php, html, parsing

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-30T02:15:34.737

```
<?php
    function page_title($url) {
        $fp = file_get_contents($url);
        if (!$fp) 
            return null;

        $res = preg_match("/<title>(.*)<\/title>/siU", $fp, $title_matches);
        if (!$res) 
            return null; 

        // Clean up title: remove EOL's and excessive whitespace.
        $title = preg_replace('/\s+/', ' ', $title_matches[1]);
        $title = trim($title);
        return $title;
    }
?> 
```

试一试以下输入：

```
print page_title("http://www.google.com/"); 
```

输出：谷歌

希望足够通用以供您使用。如果您需要更强大的东西，花一点时间研究 HTML 解析器可能不会有什么坏处。

编辑：添加了一些错误检查。第一个版本有点匆忙，对不起。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-05-29T07:25:26.207

您可以在没有 reg 表达式的情况下获得它：

```
$title = '';
$dom = new DOMDocument();

if($dom->loadHTMLFile($urlpage)) {
    $list = $dom->getElementsByTagName("title");
    if ($list->length > 0) {
        $title = $list->item(0)->textContent;
    }
} 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-30T02:23:51.553

或者使这个简单的功能更加防弹：

```
function page_title($url) {

    $page = file_get_contents($url);

    if (!$page) return null;

    $matches = array();

    if (preg_match('/<title>(.*?)<\/title>/', $page, $matches)) {
        return $matches[1];
    } else {
        return null;
    }
}

echo page_title('http://google.com'); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-02-08T15:14:43.373

我也在做一个书签系统，发现从 PHP 5 开始，你可以使用`stream_get_line`加载远程页面，直到结束标题标签（而不是加载整个文件），然后去掉开始标题标签之前的内容`explode`（而不是一个[正则表达式](http://us3.php.net/manual/en/function.preg-split.php#refsect1-function.preg-split-notes)）。

```
function page_title($url) {
  $title = false;
  if ($handle = fopen($url, "r"))  {
    $string = stream_get_line($handle, 0, "</title>");
    fclose($handle);
    $string = (explode("<title", $string))[1];
    if (!empty($string)) {
      $title = trim((explode(">", $string))[1]);
    }
  }
  return $title;
} 
```

*最后`explode`感谢 PlugTrade 的[回答](https://stackoverflow.com/a/49470414/2199369)，他提醒我标题标签可以有属性。*

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-30T02:07:04.363

正则表达式？

使用[cURL](http://au2.php.net/curl)获取 $htmlSource 变量的内容。

```
preg_match('/<title>(.*)<\/title>/iU', $htmlSource, $titleMatches);

print_r($titleMatches); 
```

看看你在那个数组中有什么。

大多数人说 HTML 遍历虽然你应该使用解析器，因为正则表达式可能不可靠。

其他答案提供了更多细节:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-31T08:09:28.563

我喜欢将 SimpleXml 与正则表达式一起使用，这是我用来从我创建的 OpenID 库中的页面中获取多个链接标题的解决方案。我已经对其进行了调整以与标题一起使用（即使*通常*只有一个）。

```
function getTitle($sFile)
{
    $sData = file_get_contents($sFile);

    if(preg_match('/<head.[^>]*>.*<\/head>/is', $sData, $aHead))
    {   
        $sDataHtml = preg_replace('/<(.[^>]*)>/i', strtolower('<$1>'), $aHead[0]);
        $xTitle = simplexml_import_dom(DomDocument::LoadHtml($sDataHtml));

        return (string)$xTitle->head->title;
    }
    return null;
}

echo getTitle('http://stackoverflow.com/questions/399332/fastest-way-to-retrieve-a-title-in-php'); 
```

具有讽刺意味的是，这个页面在标题标签中有一个“标题标签”，这有时会导致纯正则表达式解决方案出现问题。

这个解决方案并不完美，因为如果格式/大小写很重要（例如 XML），它可能会导致嵌套标签出现问题的小写标签，但是有一些方法可以解决这个问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-03-24T22:05:14.623

处理添加了属性的标题标签的函数

```
function get_title($html)
{
    preg_match("/<title(.+)<\/title>/siU", $html, $matches);
    if( !empty( $matches[1] ) ) 
    {
        $title = $matches[1];

        if( strstr($title, '>') )
        {
            $title = explode( '>', $title, 2 );
            $title = $title[1];

            return trim($title);
        }   
    }
}

$html = '<tiTle class="aunt">jemima</tiTLE>';
$title = get_title($html);
echo $title; 
```

# rtf - 跨平台开源 Doc 到 RTF 转换器

> ID：399339
> 
> 赞同：1
> 
> 时间：2008-12-30T02:05:31.933
> 
> 标签：rtf, converter, doc

我需要一个文档到 rtf 转换器，它将从命令行和 Perl 脚本中运行（我知道我需要使用 system() 来运行转换器）。任何建议。可以静态链接编译以便它可以作为独立二进制文件在工作站上运行的东西会更加有用。

我想保留标题、有序和项目符号列表和表格等内容。其他一切都不重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T02:28:07.487

我没有将它用于 .DOC 到 .RTF，但[Apache POI](http://poi.apache.org/)可能是一个不错的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T03:06:31.173

如果您可以从 doc 转到 docx，那么您可以使用 docx4j 使用 iText 或 FOP 生成 RTF（我还没有测试过 iText 或 FOP 的 RTF 输出，所以我不确定他们将如何处理表格）。

至于从 doc 到 docx，docx4j 有一个基本的概念证明，使用 poi 的 hwpf。

# html - 关于复选框：是否有更多网站不使用它的原因？

> ID：399340
> 
> 赞同：11
> 
> 时间：2008-12-30T02:06:50.543
> 
> 标签：html, usability, label

我总是尝试做以下事情：

```
<label><input type="checkbox" /> Some text</label> 
```

或者

```
<label for="idOfField"><input type="checkbox" id="idOfField" /> Some text</label> 
```

我的问题与标签标签有关，特别是在复选框上。

大多数网站（我会说 >40%）不使用该`<label>`标签。

是否有一个原因？是浏览器有问题还是其他问题？

**注意：**如果人们不知道这个`<label>`标签，它有很多优点：

*   复选框和收音机：您可以单击文本以及复选框以选中复选框（以及我相信的焦点）：Blah blah blah
*   其他输入：如果您单击文本，它将聚焦输入（文本区域、文本、文件）（此功能不如复选框和收音机有用）

**注 2：**有人提到示例 #2 比 #1 （上面）更正确，但根据[此处](http://www.w3.org/TR/html401/interact/forms.html#h-17.9.1)的文档，两者都是正确的

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-30T02:11:00.363

我认为这可能是人们不了解 <label> 标签的一个因素。我没有，直到这篇文章。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-30T02:17:56.540

我同意标签通常是未知标签。我用它的形式

```
<label for="chk1">Some text</label><input id="chk1" type="checkbox"/> 
```

for 属性让用户还可以单击标签以选择具有相应 id（不是名称）的复选框并且不被 annidate 我可以更好地使用 CSS 控制布局。

不过，我会尝试您的解决方案

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-30T05:38:21.160

`<label>`使用我所知道的没有缺点。在过去的几年里，我使用了很多。

实际上，您可以通过 3 种方式设置标签，前两种方式与您在问题中给出的方式相对应：

```
<label for="xa">XA: <input type="text" id="xa" /></label><br />
<label for="xb">XB:</label> <input type="text" id="xb" /><br />
<label>XC: <input type="text" id="xc" /></label> 
```

上述所有 3 个都适用于 FF3 和 IE7。我记得由于某种原因，我在心里将最后两个标记为“应避免，仅部分有效”。因此，我敢打赌，只有第一个在 IE6 中有效。

澄清一下：“最好”的方法是我的例子#1，你的例子#2。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-30T02:23:56.013

一些较旧的浏览器不解释**for**属性，而是要求将表单元素嵌套在**label**标记中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-30T02:11:39.830

在该网站上工作的开发人员不知道该`<label>`标签的存在。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-30T02:18:20.910

大多数网站都是由那些只做让网站按照他们认为应该的那样工作的人制作的。工艺流程为：

1.  试一试。
2.  在浏览器中加载它，看看有什么问题。
3.  谷歌搜索修复。
4.  重复。

由于这些人中的大多数人从不尝试在不使用鼠标的情况下集中任何输入，因此问题从未变得明显。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-30T05:19:23.383

优点是显而易见的，但我认为大多数人并不了解它，因为标签似乎没有传达任何具体内容。您显然可以看到使用强标签的优势，因为它使文本看起来很粗，但标签标签？你不会注意到有什么不同。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-30T04:02:44.863

因为它是一个低调的标签，应该得到更多的关注。当您使用它时（提高可访问性），不要忘记 tabindex 属性。

# .net - Web 服务的 MTU

> ID：399347
> 
> 赞同：1
> 
> 时间：2008-12-30T02:10:07.290
> 
> 标签：.net, web-services, networking, mtu

我们有一个 ERP 应用程序，它让所有客户端都使用 WebService 进行连接。我的网络工程师告诉我 web 服务的 MTU 太小，我们想增加它以提高性能。据我所知，没有用于 dotnet Web 服务的 MTU 配置部分。关于我们可以在哪里配置的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T02:23:01.117

Web 服务没有 MTU - 它由服务器操作系统控制，在本例中为 Windows。

调整 MTU 和其他 TCP 设置的最佳工具之一是[SG TCP 优化器](http://www.speedguide.net/downloads.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-01T03:55:33.567

感谢您的回复。我下载了该工具并运行它，它给了我与手动运行 ping 相同的结果....但是 GUI 工具很漂亮，可以让我轻松测试。

我将来会使用它。

# joomla - Joomla 问题：“$mainframe->getCfg('lang')”从何而来？

> ID：399348
> 
> 赞同：1
> 
> 时间：2008-12-30T02:10:32.297
> 
> 标签：joomla, config

在 Joomla 中：

```
$mainframe->getCfg('lang'); 
```

将返回“english”（我认为这是一个默认值），任何人都可以告诉我在哪里定义它？

我可以改变它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T01:36:25.423

jlleblanc，感谢您的帮助。我想我找到了问题：它的语言文件的问题，只需更改`backwardLang`in `metadata`，这里是代码：

```
<metadata>
<name>Simplified Chinese</name>
<tag>zh-CN</tag>
<rtl>0</rtl>
<locale>zh_CN.utf8, zh, zho, zhi, zh_CN, zho_CN, zhi_CN, simplified_chinese</locale>
<winCodePage>cp936</winCodePage>
<backwardLang>simplified_chinese</backwardLang>
</metadata> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T12:15:52.043

这是您在语言管理器中配置的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T18:11:49.503

在 Joomla！1.5，转到扩展>语言管理器。这将列出系统上当前安装的所有语言，包括默认语言（您可以设置）。

但是，用户也可以选择他们想要使用的语言。代码 $mainframe->getCfg('lang'); 将返回用户选择的语言而不是默认语言。

此外，您应该避免使用 $mainframe 对象，而是使用 JFactory 检索当前语言：

```
$lang =& JFactory::getLanguage();
echo $lang->getName(); 
```

# iphone - 更改 iPhone 应用程序状态栏属性

> ID：399352
> 
> 赞同：11
> 
> 时间：2008-12-30T02:11:45.213
> 
> 标签：iphone, ios, cocoa-touch, statusbar

我的应用程序将全屏显示，但我无法找到解释如何更改状态栏属性的文档。

如何更改状态栏属性？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-30T02:21:02.073

`[[UIApplication sharedApplication] setStatusBarHidden:YES animated:NO]`应该隐藏状态栏。那是你要的吗？

编辑：您还可以将以下内容添加到`Info.plist`：

```
<key>UIStatusBarHidden</key>
<true /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T02:32:46.263

状态栏 API 是 UIApplication 类的一部分。从那里开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-26T20:15:04.753

使用 Snow Leopard 和 XCode 3.2，您只需编辑 Apps Info.plist。

添加 2 行：

右键单击打开的 plist 并添加一行，然后从下拉列表中选择“状态栏最初是隐藏的”。选中它在右侧列中提供的复选框。

添加另一行并从下拉列表中选择“状态栏样式”。在右侧的列中输入 UIStatusBarHidden

这对我行得通。不过，我还没有尝试过在运行时更改状态栏视图状态，例如，如果电池电量不足。

如果您添加第二行的值，我不完全确定是否需要这两个值。

// :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T14:20:49.400

由于旧方式已被弃用：

```
// Old, Deprecated
[[UIApplication sharedApplication] setStatusBarHidden:YES animated:YES]; 
```

iOS 3.2+ 的方式是

```
[[UIApplication sharedApplication] setStatusBarHidden:YES
                                        withAnimation:UIStatusBarAnimationFade]; 
```

动画选项有：

```
UIStatusBarAnimationNone  // No animation is applied
UIStatusBarAnimationFade  // The status bar fades in and out
UIStatusBarAnimationSlide // The status bar slides in or out 
```

你仍然可以用 iOS 2.0+ 的方式来做，没有动画：

```
[[UIApplication sharedApplication] setStatusBarHidden:YES]; 
```

# c# - 从线程生成模式对话框的最短代码

> ID：399353
> 
> 赞同：1
> 
> 时间：2008-12-30T02:12:22.887
> 
> 标签：c#, winforms

假设我有一个线程一直在后台运行，以确定 URL 是否可访问。如果 URL 不可访问，应用程序需要显示一个模式对话框。如果 URL 关闭，事情将无法继续。如果我只是从线程内部执行 MessageBox.show，则该消息框将不是模态的。ShowDialog 也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T02:17:25.043

您可能想要使用 Control.Invoke（或 this.Invoke）

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e) {
      this.Invoke(new MessageBoxDelegate(ShowMessage), "Title", "MEssage", MessageBoxButtons.OK, MessageBoxIcon.Information);    } 
```

这将使它成为 UI 线程的模态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T02:20:25.943

您可以尝试创建一个从后台线程触发的事件。让主窗体监听事件，在这种情况下，它将以模式形式触发消息框。虽然我更喜欢 ocdecio 建议的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T03:08:14.630

感谢大家。我这样解决了这个问题：

线程：

```
private Thread tCheckURL;

// ...

tCheckURL = new Thread(delegate()
{
    while (true)
    {
        if (CheckUrl("http://www.yahoo.com") == false)
        {
            form1.Invoke(form1.myDelegate);
        }
    }
});
tCheckURL.Start(); 
```

Form1内部：

```
public delegate void AddListItem();
public AddListItem myDelegate;

Form1()
{
    //...
    myDelegate = new AddListItem(ShowURLError);
}
public void ShowURLError()
{
    MessageBox.Show("The site is down");
} 
```

不确定这是否是最短的方法..但它可以完成工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T02:58:41.310

```
public class FooForm : Form {

    public static void Main() {
        Application.Run(new FooForm());
    }

    public FooForm() {
        new Thread(new Action(delegate {
            Invoke(new Action(delegate {
                MessageBox.Show("FooMessage");
            }));
        })).Start();
    }

} 
```

该程序创建一个表单窗口，并立即创建另一个非 gui 线程，该线程希望在表单的 gui 线程上弹出一个模态对话框窗口。表单的`Invoke`方法接受一个委托并在表单的 gui 线程上调用该委托。

# c - 在 AT&T IA-32 Linux Assembler (gas) 上拆分字符串

> ID：399356
> 
> 赞同：4
> 
> 时间：2008-12-30T02:13:19.280
> 
> 标签：c, linux, assembly, x86, gnu-assembler

```
.section .data

astring: .asciz "11010101"
format: .asciz "%d\n"

.section .text
.globl _start

_start:

xorl %ecx, %ecx

movb astring(%ecx,1), %al
movzbl %al, %eax

pushl %eax
pushl $format
call printf
addl $8, %esp

movl $1, %eax
movl $0, %ebx
int $0x80 
```

假设我想打破 .asciz 字符串 1101011 并得到它的第一个。我该怎么做？上面的代码不起作用，它打印 49 或其他东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T02:17:33.827

更改[`printf`](http://linux.die.net/man/3/printf)from `%d`to的转换说明符`%c`以打印字符而不是其 ascii 值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-20T07:30:24.323

4年后。我正在学习用 GNU Assembler 在 asm 中编程。我这样做是为了练习：

```
.section .rodata
.LC0:
.string "This is the number: %d \n"
.data
.type str, @object
str:
.long .LC0

.section .text
.globl main
.type main, @function
.extern printf
main:
push %ebp
movl %esp, %ebp
andl $-16, %esp
subl $12, %esp
movl $2600, 4(%esp)
movl str, %edx
# Simple printf
movl %edx, %eax
movl %eax, (%esp)
call printf

# putchar
# for loop
movl $0, -4(%ebp)
jmp .check_for
.for_loop:
movl -4(%ebp), %eax
movl str, %edx
leal (%edx, %eax), %eax
movzbl (%eax), %eax
movsbl %al, %eax
movl %eax, (%esp)
call putchar
addl $1, -4(%ebp)
.check_for:
cmp $0x00, (%esp)
jnz .for_loop
leave
ret 
```

# jquery - jQuery document ready() 函数可能需要很长时间才能执行

> ID：399359
> 
> 赞同：3
> 
> 时间：2008-12-30T02:16:37.027
> 
> 标签：jquery, google-analytics, onload

我的问题是，有时一段 JavaScript（通常是 Google Analytics）可能需要很长时间才能加载，尽管 HTML 准备好“遍历和操作”并不重要。如果我要使用以下代码：

```
$(document).ready(function () {
    $("p").text("The DOM is now loaded and can be manipulated.");
}); 
```

这是否意味着在`<p>`加载 Google Analytics 之类的内容之前不会填充？

大多数网站通常不需要像谷歌分析这样的东西，我经常发现我正在等待它加载。（我不想使用 onload 因为[它不可靠](http://docs.jquery.com/Events/ready#fn)。）

有没有更好的方法或方式说“不要等待 [...]”？

注意：我通常不能将代码放在`<script>`标记之前的`</body>`标记中，因为该站点基于模板。我通常只能编辑页面的“内容”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-30T02:52:37.080

您是否尝试过从 ready 函数中加载 Google 分析？这是一个讨论动态脚本加载的[链接。](http://unixpapa.com/js/dyna.html)大概在您准备好的脚本的其他部分已经执行之后，您会在最后执行此操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-12T06:51:16.173

谷歌实际上已经发布了他们所谓的[异步跟踪](http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html)：

```
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXX-X']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
  })();

</script> 
```

这解决了这个问题，因为它只会在解析 DOM 后加载，因此您已经可以使用页面上的所有内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-04T15:02:56.840

在大多数现代浏览器中，您现在可以编写：

```
<script>var _gaq = _gaq || [["_setAccount","UA-XXXXX-X"],["_trackPageview"]]; </script>
<script src="//www.google-analytics.com/ga.js" async></script> 
```

该脚本将在大多数浏览器上异步加载，并自动处理不同的方案..

您可能希望使用更长 - 对旧浏览器更安全的版本：

```
<script>var _gaq = _gaq || [["_setAccount","UA-XXXXX-X"],["_trackPageview"]]; </script>
<script type="text/javascript" src="//www.google-analytics.com/ga.js" async="true" defer="true"></script> 
```

一些注意事项：

*   IE6 中存在一个错误，由于缺少协议（请参阅[http://www.paulirish.com/2010/the-protocol-relative-url/](http://www.paulirish.com/2010/the-protocol-relative-url/)），该错误将阻止 JS 加载，但您可以添加您正在使用的协议.
*   较旧的浏览器无法理解“异步”属性，因此如果延迟（页面加载后）或仅在找到它时加载（因此不是异步），则会加载它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-30T03:01:12.100

这只是一个猜测，但您是否考虑过 setTimeOut()？

```
$(document).ready(function()
{
   setTimeOut(function()
   {
      // Your code comes here
   }, 0); // We don't really need any delay
}); 
```

setTimeOut() 具有转义调用堆栈的好功能，因此它可能会解决您的问题。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-03-27T05:01:32.380

我遇到过同样的问题。只需将这一行放在第一次加载 javascript 时，它就可以在 IE 上正常工作：

```
jQuery.noConflict(); 
```

# php - 与 Apache/PHP/Javascript 的长期连接（异步服务器推送）？

> ID：399366
> 
> 赞同：6
> 
> 时间：2008-12-30T02:18:50.237
> 
> 标签：php, javascript, jquery, ajax, apache

我来自更多的 Java 背景。在过去的一两年里，在 Comet 中使用[长寿命 HTTP 连接通过 HTTP 进行](http://blogs.oracle.com/andi/entry/comet_basics)[服务器推送](http://en.wikipedia.org/wiki/Push_technology)变得有些流行。这是一种非常有用的技术。

所以我很好奇 Apache + PHP + Javascript 的等价物是什么？我看到的一个选项是直接使用 AJAX 调用（例如使用 jQuery），但我真的不知道 Apache 如何处理它们或如何使用 PHP 在服务器端实现这样的事情。有任何想法吗？这种事情有什么好的资源吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-30T02:51:48.440

您可以在 PHP 中使用 Comet 编程技术。[我认为这篇文章](http://www.zeitoun.net/articles/comet_and_php/start)是一个很好的起点，描述了如何在 PHP 中实现 Comet。

# flash - 如何使嵌入的视频不自动播放

> ID：399370
> 
> 赞同：17
> 
> 时间：2008-12-30T02:20:40.920
> 
> 标签：flash, autoplay

我将 Flash 视频嵌入到 HTML 中，并希望用户必须单击它才能开始播放。根据[Adob​​e `<object>`/ `<embed>`element 文档](http://kb.adobe.com/selfservice/viewContent.do?externalId=tn_12701)，有多种方法可以做到这一点：

`<object>`1）在标签内添加Flash参数：

```
<param name="play" value="false"> 
```

2）在标签`play`内添加属性：`<embed>`

```
<embed ... play="false"> 
```

3）在标签`flashvars`内添加属性：`<embed>`

```
<embed ... flashvars="play=false"> 
```

这太棒了。只有......它们都不适合我：

[http://johnboxall.github.com/test/flash/flash.htm](http://johnboxall.github.com/test/flash/flash.htm)

我的代码现在看起来像这样：

```
<object width="590" height="475">
    <param name="movie" value="untitled_skin.swf">
    <param name="play" value="false">
    <embed src="untitled_skin.swf" width="590" height="475" type="application/x-shockwave-flash" play="false" flashvars="autoplay=false&play=false" menu="false"></embed>
</object> 
```

有人有想法么？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-30T18:41:41.517

这里有几根电线交叉。`autoplay`您正在使用的各种设置只会影响 SWF 的根时间线是否开始暂停。因此，如果您的 SWF 有时间轴动画，或者如果它在根时间轴上有嵌入视频，那么这些设置将满足您的需求。

但是，您使用的 SWF 几乎可以肯定其时间轴上只有一帧，因此这些设置根本不会影响播放。这一帧包含某种类型的视频播放组件，其中包含控制视频行为方式的 ActionScript。要让播放器组件开始暂停，您必须更改组件本身的设置。

在不知道内容来自哪里的情况下很难说更多，但是当从 Flash 发布时，视频播放器组件通常包含一个是否自动播放的参数。如果您的 SWF 是由 Flash 以外的应用程序发布的（我想是 Captivate，但我不同意），那么最好的办法是检查该应用程序的设置。无论如何，这不是您可以从 HTML 页面级别控制的东西。（除非您是从 JavaScript 与 SWF 对话，并且要使其工作，视频组件必须设计为允许它。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-11-07T12:14:10.507

我遇到了同样的问题，并遇到了这篇文章。没有任何效果。随机播放后，我发现它`<embed ........ play="false">`停止了自动播放。我现在有一个问题，我不能让控制器出现，所以不能开始电影！:S

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-14T10:20:04.190

尝试将您的电影参数行替换为

`<param name="movie" value="untitled_skin.swf&autoStart=false">`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-06T03:35:25.447

尝试添加这些之后`<Playlist>`

```
<AutoLoad>false</AutoLoad>
<AutoPlay>false</AutoPlay> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-13T13:49:15.670

fenomas 的回答非常好……它让我不再查看 HTML 代码。我知道 jb 正在寻找可以在 Captivate 中使用的东西，但是这个问题足够广泛，包括使用 Flash 工作的人（我使用的是 CS5），所以我想我会在这里针对我的情况给出具体的答案。

如果您在 Flash 中使用库存的 Adob​​e FLVPlayback 组件（如果您使用了文件 > 导入 > 导入视频...），则在“属性”面板中的“组件参数”下有一个选项。寻找“自动播放”并取消选中它。这将在页面加载时停止自动播放！

# .net - 更新而不首先在 LINQ 2 SQL 中选择数据？

> ID：399379
> 
> 赞同：2
> 
> 时间：2008-12-30T02:27:03.387
> 
> 标签：.net, linq-to-sql, .net-3.5

您如何在不必先在 LINQ 中选择数据的情况下更新记录？

由于您必须首先执行 linq select（显然调用 SQL SELECT，这很昂贵），因此更改所需的属性，然后执行 SubmitChanges()。我希望避免这种情况，只执行 SQL UPDATE，我已经知道 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T02:46:08.247

您需要使用[Attach](http://msdn.microsoft.com/en-us/library/bb548978.aspx)方法将断开连接的实体“附加”到您的表。MSDN 上的这篇文章概述了如何使用它：

[N 层应用程序中的数据检索和 CUD 操作](http://msdn.microsoft.com/en-us/library/bb546187.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T02:51:33.820

我还没有尝试过，但看起来你可以使用 Attach 来做到这一点：

[Table(TEntity).Attach 方法（TEntity，布尔值）](http://msdn.microsoft.com/en-us/library/bb548778.aspx)

您将对象设置为更新状态并将其传入，将布尔参数设置为 true。当然，那么你必须设置*所有*字段，而不仅仅是你想要更改的字段。

如果您只想更改一两个字段，您可以使用 DataContext 对象上的[ExecuteCommand](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executecommand.aspx)和[ExecuteQuery方法直接调用 SQL。](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.executequery.aspx)您必须将 SQL 作为字符串传递，并为 SQL 中的每个参数传递一个参数。请特别注意如何构造 SQL 字符串：

> 该命令的语法与用于创建 ADO.NET DataCommand 的语法几乎相同。唯一的区别在于如何指定参数。具体来说，您可以通过将参数括在大括号 ({…}) 中来指定参数并从 1 开始枚举它们。参数与参数数组中相同编号的对象相关联。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-04T22:05:16.937

PLINQO 实现实体分离，并允许您从一个上下文中分离一个实体，然后将其重新附加到另一个上下文。它还能够直接执行更新和删除，而无需先检索实体。更多信息可以查看网站[http://www.plinqo.com/](http://www.plinqo.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T03:32:58.357

除非您将对象设置为使用乐观并发（我认为所有列都为 nocheck），否则这将很难做到。使用任何类型的并发，您都需要旧值和新值，至少对于检查的列是这样。或者，您可以为更新创建和映射 SQL 函数/存储过程，或者使用 ExecuteCommand 直接执行 SQL，正如@Kyralessa 所说。我认为分离/附加在配对时效果最好，即获取对象，分离它，使用它，然后在完成后重新附加并保存它。

# database - 开发策略：凤凰开发周期

> ID：399380
> 
> 赞同：4
> 
> 时间：2008-12-30T02:27:29.377
> 
> 标签：database, project-management

我想知道当你自己的老板时，你们是如何实际开发大型应用程序的。就我自己而言，我一直在努力学习耐心和希望的必要性。我一直致力于实现一个应用程序（以一系列链接到数据库的脚本的形式），它使用 Wikilinks 知识和文章文本/内容的组合对 Wikipedia 文章进行聚类。我已经做了两年了；还没有结果。

由于算法的本质（伪伪代码，理论算法）或形式（脚本，线程，数据库表，实用算法）发生变化，我似乎无法得到任何结果，因为我正在不断地重新设计我的脚本和数据库. 基本上，我发现自己不断从实施过程中发现的错误中学习；魔鬼在细节中，答案似乎也是如此。

无论如何，每次我重新设计脚本或表格或其他东西时，我都需要废弃我所有的文档和脚本。我现在可以毫无畏惧地做到这一点，但这让我讨厌编程（我讨厌细节）。

我觉得重新设计是要走的路，因为我是长期思考并且我希望快速学习，但我想知道你们是否有类似的编程经验，或者你是否真的需要或选择有一个更好的脚本出来最后一个（像凤凰一样）的死亡。

对我来说最困难的部分是刮掉我的文档，因为我花更多的时间来记录而不是编码；我使用文档作为讨论问题和考虑解决方案的一种手段；我用它来制定可实施的解决方案。如果是我的话，我不介意刮掉它，但我总是把它写成下周出版，因为在开发剧本的同时，我也在寻求发展自己；我也尝试与参与本网站的人一样，与他人分享我的知识或智慧。

无论如何，这两个月来我一直在全速开发，重新设计了无数的文章、脚本、表格等；我的耐心正在耗尽，因为我寻求结果。

您想分享任何策略，任何帮助，任何经验或轶事吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-30T02:53:49.357

编程中一个好的座右铭是“愿意并乐于把所有东西扔掉至少一次”，通常是更多。我目前正在为一个新的操作系统从头开始编写一个完整的 shell，并且我即将完全废弃部分设计，我不喜欢我如何处理内置命令与可加载的模块化命令。

听起来你一头扎进去，头朝下……很高兴能写出一些代码。据我所知，您确实花了一些时间使用伪代码（我什至使用了一块大的干擦板）来确定您的代码的结构..但代码无法在对所述结构的根本变化中幸存下来。

您完全孤立地工作可能有一些很好的理由。如果可能的话，正如其他人所建议的那样，请让其他人了解您希望完成的最终结果并敲定新设计。请记住，您的应用程序已被证明是非常不稳定的，新设计不应该因为一些事情发生变化而让您抛弃所有东西。

我认为您也成为所谓的过早优化的受害者。试着把一些东西放在一起，即使它非常低效和笨拙，然后真的花一些时间来看看如何改进事情。这一步几乎是新设计的先驱，可以在未来发生根本性变化。如果你不能把其他人带进来，你当前错误的*工作*模型几乎和另一个合作者一样好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T02:49:56.227

保留开发日志；在这里可以与自己讨论细节、在纸上解决问题、草拟文档、记录当前和未来的问题、提醒自己您已经尝试过什么以及还有什么需要尝试等等。始终注意“下一步要做的事情”也是一个好主意，这样当你有时间工作时，你就不会浪费时间记住/回顾。每个条目的日期。

我已经在一些长期运行的、有时令人沮丧的、持续时间从几个月到几年不等的单人项目中使用了这种方法，它有助于让我保持专注，也有助于让我避免多次尝试。

它还消除了记录所有内容的内部压力，这可能对您大有裨益。

可以这样想：给自己做的笔记对你有用，但是为第三方准备的被废弃代码的详细文档是*浪费你的时间*。

也许这会帮助你的强迫症记录神经元闭嘴，这样你就可以完全解决问题，*然后*记录工作解决方案——而不是不断地重新记录最新的*原型*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T02:42:53.073

由于您是独自工作，因此请尝试从足够了解您正在尝试做什么的其他人那里获得反馈。你会对别人能想出的东西感到惊讶。

当有偿工作时，它会更容易一些，因为你必须得到客户的接受，它不像你目前的情况那样开放。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T02:50:58.330

我认为软件工程（而不是编程本身）最难的部分是在实用主义之间找到正确的平衡，即立即完成和正确完成。

（优秀的）程序员有一种趋势，就是总是想把东西拆开，然后把它们重新组合在一起，这是一种更整洁/更酷/更清洁/……的方式。这是一件好事……除非这意味着一切都以碎片告终，并且工作（而且非常整洁）系统的难以捉摸的目标越来越远。

对我自己来说，我必须强迫自己接受某些事情并不完美，并满足于在短时间内取得*一些成果。*我发现最好的方法是设定一系列短期里程碑，以实现最终目标。即使项目的其他部分在一段时间内看起来更诱人，也要坚持实现里程碑。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T03:18:24.720

> 我想知道当你自己的老板时，你们是如何实际开发大型应用程序的。

我从编写功能规范的页面和页面开始......以各种详细程度（包括 UI）描述我希望软件做什么。

我还尝试通过编写一些原型、概念验证软件组件来降低风险，这些组件是风险最大或最不被理解的部分。

> 无论如何，每次我重新设计脚本或表格或其他东西时，我都需要废弃所有......

我当然会重构我所写的内容（自 2005 年以来我一直在努力），但只是为了添加新功能。请注意，“重构”是一个技术术语（查找：有关于它的书籍）：请注意，“重构”与“废弃”我已经编写的内容完全不同（相反，我正在修改-it-and-adding-to-it）。

> 我已经做了两年了；还没有结果。...无论如何，在过去的两个月里，我一直在全速发展...

我不知道你作为程序员有多少经验。除非您非常有经验，否则一些选择是：

*   承担一个较小的项目（不要指望自己完成太大的项目）......完成一个项目的努力和技能与项目规模并不成线性关系（例如，一个两倍大的项目可能是五倍更难完成）

*   开始，但不要期望完成（这是一个学习机会，你会从中学习）

*   与他人合作

*   更加缓慢和有条不紊地工作（如果你只跑 100 码，你可以开始跑步，但如果你要跑 100 英里，那么你需要准备一张地图等）。

> 对我来说最困难的部分是刮掉我的文档，因为我花更多的时间记录而不是编码......

有人（不一定是我）应该回复你的这一段，或者你可以多说一些。

我对这个话题很感兴趣（实际上我正在开发的产品是用于记录软件开发的），但我不知道如何回复您的这一段。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T03:47:32.040

[尽早发布，经常发布。](http://blog.red-bean.com/sussman/?p=96)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-30T03:13:09.270

设计冻结！

在具有最小耦合的微小模块中构建冻结设计 - 模块只做一件事。当它起作用时，您将更聪明地解决如何解决任何缺点。最小的耦合和最大的连贯性使得切割有缺陷的零件变得容易。不要废弃任何有效的东西。

问候，比尔·德里塞尔

# svn - 您最喜欢 Subversion (SVN) 存储库的 Web 视图是什么？

> ID：399387
> 
> 赞同：11
> 
> 时间：2008-12-30T02:31:08.357
> 
> 标签：svn, version-control

我刚刚建立了我的第一个 SVN 服务器，以及用于 Apache 的 mod_dav_svn 模块，以便我对存储库有一个基本的 Web 视图。

与您在 Launchpad 或 Sourceforge 看到的内容类似，似乎有许多替代/附加包可以使 Web 视图功能更全面。

你最喜欢的 SVN 网页视图是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-30T03:09:42.177

一些选项：

*   [Trac](http://trac.edgewall.org/wiki/TracSubversion)它是免费/开源的，并且被广泛使用。Trac 的 SVN 浏览部分在[这里](http://trac.edgewall.org/browser)
*   [bsSvnBrowser](https://bssvnbrowser.bountysource.com/) - 一个 AJAX'y 颠覆浏览器（[演示](https://bssvnbrowser.bountysource.com/svn/!tree/30)）
*   [WebSVN](http://www.websvn.info/features/) - 用 PHP 编写，看起来不错（[演示](http://demo.websvn.info/)）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-30T02:34:49.330

我们在内部使用[ViewVC](https://github.com/viewvc/viewvc/)，它非常适合我们的需求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-30T02:35:22.700

不仅仅是 svn 的 Web 界面：[Trac——](http://trac.edgewall.org/)开源，包括问题跟踪和 wiki。不过，这不是最容易设置的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T02:33:09.117

昂贵但恕我直言是最好的

Atlassian 鱼眼

[http://www.atlassian.com/software/fisheye/](http://www.atlassian.com/software/fisheye/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T03:40:16.627

[仓库](http://www.warehouseapp.com/)。也刚刚[开源](http://github.com/entp/warehouse/tree/master)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T03:46:11.807

[BeanStalk](http://beanstalkapp.com/)的人员提供了 SVN 服务器本身和允许您使用存储库的接口。如果你已经有一个 SVN 服务器，这并不适用，如果你刚刚开始，你应该检查它们。注意：我是该服务的用户，但与他们无关。

# ruby-on-rails - 你能在 Rails 中获取数据库用户名、密码、数据库名称吗？

> ID：399396
> 
> 赞同：157
> 
> 时间：2008-12-30T02:37:32.680
> 
> 标签：ruby-on-rails, ruby, database, activerecord, environment

我正在编写一个在 Rails/ActiveRecord 之外执行一些数据库工作的 rake 任务。

有没有办法获取当前环境中定义的数据库连接信息（主机、用户名、密码、数据库名称）`database.yml`？

我想得到它，这样我就可以用它来像这样连接......

```
con = Mysql.real_connect("host", "user", "pw", "current_db") 
```

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2008-12-30T02:47:40.973

在 rails 中，您可以创建一个配置对象并从中获取必要的信息：

```
config   = Rails.configuration.database_configuration
host     = config[Rails.env]["host"]
database = config[Rails.env]["database"]
username = config[Rails.env]["username"]
password = config[Rails.env]["password"] 
```

有关详细信息，请参阅 Rails::Configuration 的[文档](http://api.rubyonrails.org/classes/Rails/Configuration.html)。

这只是使用[YAML::load](http://www.ruby-doc.org/core/classes/YAML.html)从数据库配置文件 ( `database.yml`) 加载配置，您可以使用它自己从 rails 环境外部获取信息：

```
require 'YAML'
info = YAML::load(IO.read("database.yml"))
print info["production"]["host"]
print info["production"]["database"]
... 
```

* * *

## 回答 #2

> 赞同：161
> 
> 时间：2010-11-16T17:54:14.173

布莱恩在上述评论中的回答值得更多曝光：

```
>> Rails.configuration.database_configuration[Rails.env]
=> {"encoding"=>"unicode", "username"=>"postgres", "adapter"=>"postgresql", "port"=>5432, "host"=>"localhost", "password"=>"postgres", "database"=>"mydb", "pool"=>5} 
```

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2015-10-28T14:42:48.717

```
ActiveRecord::Base.connection_config 
```

以散列形式返回连接配置：

```
=> {:adapter=>ADAPTER_NAME, :host=>HOST, :port=>PORT, 
    :database=>DB, :pool=>POOL, :username=>USERNAME, 
    :password=>PASSWORD} 
```

* * *

正如`tpett`他们在评论中所说：这个解决方案考虑了`database.yml`从环境变量合并配置`DATABASE_URL`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-03-18T14:41:42.537

我认为这是最简单的解决方案。经过一些测试（至少在 Rails 5.2 中）这将正确解析 DATABASE_URL。

```
 ActiveRecord::Base.configurations[Rails.env] 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-02-02T17:26:31.903

从 Rails 6.1 开始，`ActiveRecord::Base.connection_config`已弃用。较新的访问器是`ActiveRecord::Base.connection_db_config`

```
[1] pry(main)> ActiveRecord::Base.connection_db_config
=> #<ActiveRecord::DatabaseConfigurations::HashConfig:0x00007fe04ae72e58
 @configuration_hash=
  {:adapter=>"postgresql",
   :encoding=>"utf8",
   :min_messages=>"WARNING",
   :host=>"localhost",
   :username=>"postgres",
   :password=>"P@ssw0rd",
   :port=>5432,
   :database=>"myapp_development"},
 @env_name="development",
 @name="primary"> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-05T00:08:48.493

老问题，但这是我查找如何做到这一点的第一站，所以我认为这可能对其他人有所帮助。我通常在主目录中有 .my.cnf 文件。因此，在我的 database.yml 配置文件中使用 'parseconfig' gem 和一些 ERB 语法意味着我有动态文件，我可以很好地检查源代码控制并简化部署（在我的情况下）。另请注意常用套接字列表，这使我的应用程序更容易移动到可能具有不同 Unix 套接字路径的不同操作系统。

```
<% 
    require 'parseconfig'
    c=ParseConfig.new('../../.my.cnf') %>

mysqlevn: &mysql
  adapter: mysql 
  username: <%= c.params['client']['user'] %>
  password: <%= c.params['client']['password'] %>
  host: localhost 
  socket: <%= [ 
  '/var/run/mysqld/mysqld.sock',
  '/var/lib/mysql/mysql.sock',
  '/tmp/mysqld.sock',
  '/tmp/mysql.sock'].detect { |socket| File.exist?(socket) } %>

production:
  database: app_production
  <<: *mysql

development:
  database: app_development 
  <<: *mysql

# Do not set this db to the same as development or production.
test:
  database: app_test
  <<: *mysql 
```

参考：[http ://effectif.com/articles/database-yml-should-be-checked-in](http://effectif.com/articles/database-yml-should-be-checked-in)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-08-24T17:47:58.943

在 Rails 6.1+ 中，您可以使用：

```
ActiveRecord::Base.connection_db_config.configuration_hash 
```

这将返回一个包含当前环境连接信息的哈希：

```
{
  :adapter=>"postgresql",
  :encoding=>"utf8",
  :min_messages=>"WARNING",
  :host=>"localhost",
  :username=>"postgres",
  :password=>"P@ssw0rd",
  :port=>5432,
  :database=>"my_app_development"
} 
```

# java - 休眠和货币精度

> ID：399401
> 
> 赞同：6
> 
> 时间：2008-12-30T02:42:03.030
> 
> 标签：java, hibernate, types

我有一个休眠映射如下：

```
<hibernate-mapping>
    <class name="kochman.elie.data.types.InvoiceTVO" table="INVOICE">
        <id name="id" column="ID">
            <generator class="increment"/>
        </id>
        <property name="date" column="INVOICE_DATE"/>
        <property name="customerId" column="CUSTOMER_ID"/>
        <property name="schoolId" column="SCHOOL_ID"/>
        <property name="bookFee" column="BOOK_FEE"/>
        <property name="adminFee" column="ADMIN_FEE"/>
        <property name="totalFee" column="TOTAL_FEE"/>
    </class>
</hibernate-mapping> 
```

其中 InvoiceTVO 的变量定义为：

```
private int id;
private Date date;
private int customerId;
private int schoolId;
private float bookFee;
private float adminFee;
private float totalFee; 
```

当我在此表上进行插入时，我收到以下错误：

```
Hibernate: insert into INVOICE (INVOICE_DATE, CUSTOMER_ID, SCHOOL_ID, BOOK_FEE, ADMIN_FEE, TOTAL_FEE, ID) values (?, ?, ?, ?, ?, ?, ?)
50156 [AWT-EventQueue-0] WARN org.hibernate.util.JDBCExceptionReporter - SQL Error: 0, SQLState: 22001
50156 [AWT-EventQueue-0] ERROR org.hibernate.util.JDBCExceptionReporter - Data truncation: Data truncated for column 'ADMIN_FEE' at row 1
50156 [AWT-EventQueue-0] ERROR org.hibernate.event.def.AbstractFlushingEventListener - Could not synchronize database state with session 
```

我尝试将 adminFee 的类型更改为 double，但这也不起作用。问题是，Hibernate 实际上确实正确地执行了插入，并且未来的选择语句可以返回当前的一组值，但是这个错误阻止了我对这张发票进行进一步的处理。

bookFee、adminFee 和 totalFee 字段都应该是货币。它们在 MySQL 数据库中定义为十进制 (5,2)。

任何有关如何解决此问题的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-30T03:05:00.877

使用 float 或 double 来赚钱是绝对不能接受的，甚至可能是非法的（例如，违反法律或至少违反法规）。这需要修复，然后错误就会消失。float 的精度有限，根本无法准确表示大多数小数。

[为了钱，总是，总是使用 BigDecimal。](http://blogs.oracle.com/CoreJavaTechTips/entry/the_need_for_bigdecimal)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T03:09:22.710

我会使用整数类型（int，long）。只要您可以避免溢出，就永远不会出现任何有趣的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T02:51:00.313

您是否尝试过分配类型？

```
<property name="adminFee" column="ADMIN_FEE" type="float"/> 
```

问题似乎在于数据的精度。有时当您有 1.26666666666... 时，该值会被截断。

您也可以在尝试插入之前尝试对其进行四舍五入。

见：[http ://bugs.mysql.com/bug.php?id=7829](http://bugs.mysql.com/bug.php?id=7829)

另外，看看这是否有帮助： [http ://www.ibm.com/developerworks/java/library/j-jtp0114/](http://www.ibm.com/developerworks/java/library/j-jtp0114/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T05:11:14.787

我最终没有使用 float、BigDecimal 或 double。我回到客户那里，他们同意放弃便士，因为无论如何向客户收取四舍五入的费用，所以没有必要存放便士。但是，我仍然需要弄清楚如何正确存储货币，因为这可能会再次出现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T13:55:50.720

自定义 Hibernate 映射和类定义将是一个不错的方法。

# ms-access - Microsoft Access 有全文搜索吗？

> ID：399406
> 
> 赞同：13
> 
> 时间：2008-12-30T02:45:13.710
> 
> 标签：ms-access, full-text-search

Microsoft Access 有全文搜索吗？

我知道 MySQL 和 SQL Server 有全文搜索，但我对 Access 不太确定。

如果 Access 没有全文，实现全文搜索相同目标的最佳选择是什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T02:51:14.010

我不是 100% 确定，但微软的[这个网站](http://technet.microsoft.com/en-us/library/cc723263.aspx)没有提到 Access 的事实告诉我答案是“不”。

我的直觉反应也是“不”。Access 并非旨在成为关系数据库技术中的*佼佼者*。如果是这样，SQL Server 就没有理由了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-31T23:19:57.983

全文搜索的第一步是创建一个包含数据库中所有单词的单词列表。全文搜索还具有其他功能，例如词干提取，它将派生词与基本词（快速，更快，最快）相关联，并且它具有被忽略的停用词，因为它们非常常见（和，the）。一个小的 VBA 代码可以生成一个可以直观地扫描的单词列表。再做一些工作，就可以在搜索数据库之前先使用代码检查单词列表，这可能会使搜索速度更快。下面是我为此目的创建的一些代码。它的实际应用是在数据库中查找人名，以便我可以删除或更改它们以保护隐私，作为生物学家，我想在报告中用斜体显示科学名称。如果我可以创建一个学名列表，

该代码运行良好，但我没有对它进行广泛的测试，也没有针对大型备忘录字段/富文本字段进行测试。它是用 Access 2010 编写的。

```
'This code requires a table called tblWordList with fields called Word (str 255), WordCount (long), FirstCopyID (long)

Option Compare Database
Option Explicit

'Click on this procedure and press F5 to run the code
Private Sub ScopeWordList()

    'A list of tables and fields that need to be processed
    Call CreateWordList("Issues", "IssueSummary", "IssueID")

End Sub

'The main routine that finds new words
Public Sub CreateWordList(TableName As String, FieldName As String, ForeignKey As String)

    Dim dbs As Database
    Dim rst As Recordset
    Dim SQL_Statement As String

    Dim r As Recordset

    Dim RowText As String
    Dim OriginalWord As String
    Dim SearchWord As String
    Dim SearchTerm As String
    Dim Quote As String: Quote = Chr$(34)
    Dim i As Long
    Dim RecNum As Long

    SQL_Statement = "SELECT " & FieldName & ", " & ForeignKey & " AS FirstCopyID FROM " & TableName & " WHERE " & FieldName & " IS NOT NULL;"
    Set dbs = CurrentDb()
    Set rst = dbs.OpenRecordset(SQL_Statement, dbOpenSnapshot)

    Set r = dbs.OpenRecordset("tblWordCounts", dbOpenTable)
    r.Index = "Word"

    With rst
    If .RecordCount = 0 Then GoTo ExitCreateWordList

    Do Until .EOF
        Dim RowWords As Variant 'holds an array which needs to be created
        RowText = .Fields(0)
        'strip out quotes, slashes and other characters
        RowText = CleanLine(RowText)
        'split data into words
        RowWords = Split(RowText, Space(1))

        For i = LBound(RowWords) To UBound(RowWords)
            OriginalWord = RowWords(i)
            SearchWord = Left(Trim(OriginalWord), 254)
            If Len(SearchWord) > 0 Then
                    r.Seek "=", SearchWord
                    If r.NoMatch Then
                        r.AddNew
                        r!Word = SearchWord
                        r!wordcount = 1
                        'records ID field of first occurrence, so you can debug unexpected results
                        r!FirstCopyID = !FirstCopyID
                        r.Update
                    Else
                        r.Edit
                        r!wordcount = r!wordcount + 1
                        r.Update
                    End If
                End If
'            End If
        Next i
        RecNum = RecNum + 1
        If RecNum Mod 20 = 0 Then Debug.Print "Record " & RecNum
        .MoveNext
    Loop

ExitCreateWordList:
    End With
    Debug.Print "Done"
    Set rst = Nothing
    Set dbs = Nothing

End Sub

'Need to clean out unwanted characters and replace then with normal spaces
Private Function CleanLine(RowText As String) As String

        Dim X As Long
        Dim Y As String
        Dim Z As Long
        Dim W As String

        For X = 1 To Len(RowText)
            Y = Mid(RowText, X, 1)
            Z = Asc(Y)
            Select Case Z
                Case 65 To 90      'capital letters
                    W = W & Y
                Case 97 To 122     'lowercase letters
                    W = W & Y
                Case Else
                    W = W & Space(1)
            End Select
        Next
        CleanLine = W

End Function

'Delete all records in Word List table
Public Sub ClearWordList()

    Dim SQL_Statement As String

    'Delete all records from tblWordCounts
    SQL_Statement = "DELETE FROM tblWordCounts"
    DoCmd.SetWarnings False
    DoCmd.RunSQL SQL_Statement
    DoCmd.SetWarnings True

End Sub 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T03:37:48.003

[如果您正在寻找客户端可部署的数据库， MSDE（现在称为 Sql Server Express）](http://www.microsoft.com/Sqlserver/2005/en/us/express.aspx)具有全文索引

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-10T06:38:47.610

**@duffymo**提供的示例代码运行良好。我将它与 Microsoft Access 2003 一起使用。但需要进行一些修复。

1.  该表需要定义为：'此代码需要一个名为 tblWordList 的表，其中包含名为**Word (text 255)**、**WordCount (number)**、**FirstCopyID (number)的字段**

2.  另一个修复是**tblWordCounts**需要替换为**tblWordList**，当然**Call CreateWordList**需要更改为需要发送到**tblWordList**的表和字段。

在 5000 条记录表上，它运行得如此之快，我认为当我单击**Sub ScopeWordList()**并按 F5 时它不起作用，但是该模块创建了一个包含 700 多个不同记录的单词列表（对于我的数据表）。感谢**@duffymo**提供了一些简洁的示例代码。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2011-02-17T18:20:38.780

[http://www.dummies.com/how-to/content/finding-records-in-your-access-2003-tables.html](http://www.dummies.com/how-to/content/finding-records-in-your-access-2003-tables.html)

这是关于使用查找工具的。我还没有尝试过，我不确定它是否适用于备忘录字段。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2010-07-28T19:18:15.827

Access 不是数据库。但它确实附带了一个默认的数据库引擎 Jet/ACE。我会假设这就是你的意思，但是当你问这样的问题时，你应该更清楚你的意思。

Jet/ACE 没有任何全文搜索功能。

对 Jet/ACE 数据文件进行全文搜索的最佳方法是通过您对计算机上文件的全文搜索功能。这不会很快，也不会通过 SQL 使用。

你没有说这是什么上下文，但我通常从未见过需要全文搜索，除非在网站上（这是一种预期的能力）。如果您使用 Jet/ACE 作为 HTTP 应用程序的数据存储，那么您选择了错误的数据存储。虽然 Jet/ACE 可以很好地用于小容量只读网站，但这不是一个可取的用法（因为 Jet/ACE 数据库引擎的限制）。

如果您需要全文搜索，那么您需要一个不同的数据库引擎。

# makefile - 用于 linux 的免费安全分布式 make 系统

> ID：399409
> 
> 赞同：7
> 
> 时间：2008-12-30T02:47:00.773
> 
> 标签：makefile, distributed, data-processing

是否有任何安全且免费的与语言无关的 Linux 分布式 make 系统？

**背景资料：**

我运行的科学实验（计算机科学实验）有时会有很大的依赖树，有时会有数千或数万个树节点。此依赖关系树位于数据文件、数据处理可执行文件和结果文件之上。

多年来，我尝试了各种技术，包括：

1.  使用数据库滚动我自己的依赖跟踪器并在每台工作机器上运行脚本。这可能会有点麻烦，尤其是在尝试使用非脚本语言时。
2.  将所有处理命令放在单个 makefile 中，伪目标可以在不同的工作机器上手动“构建”。这不需要特殊工具，但是手动将工作分解为大小均匀的伪目标块并在每个工作盒上正确调用“make”可能会很痛苦。
3.  *[distmake](http://distmake.sourceforge.net/pmwiki/pmwiki.php)*：自动分发来自单个 makefile 的命令的执行...

我基本上在寻找类似 distmake 的东西，但更安全。据我所知，distmake 本质上为每个工作节点留下了一个敞开的后门。

如果替代品比 distmake 更强大，那也很好。如果您中断主 distmake 调用，它可以关闭后门服务器，但它不会正确终止工作节点上的执行进程。

* * *

**说明：**

我正在使用 makefile 处理数据，而不是使用 gcc 编译和链接。从我在文档中看到的内容来看，distcc 是一个专门用于分发 gcc 的工具。我将在共享文件系统上托管的非常大的数据文件上运行我自己的可执行文件，而不是在源文件上运行 gcc，因此 distcc 没有帮助。

工作节点是外部可见的机器，所以我希望任何工作守护进程至少与 ssh 一样安全。尽我所能在不阅读源代码的情况下判断，distmake worker 守护进程会打开一个端口，并将接受来自任何附加到它的人的命令。他们将以启动守护程序的用户身份执行命令。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-25T08:39:31.797

依赖关系很难管理，而且我不知道有任何完美的系统可以在没有大量工作的情况下完成您想要的操作。

我使用的最接近的设置是以下设置： - 用于管理集群中机器的 Condor 队列 - 用于提交相互依赖的作业的 Condor DAGMAN 元调度程序。DAGMAN 是 Directed Acyclic Graph MANager 的首字母缩写，其中使用有向无环图来表示你的作业之间的依赖关系。

我们已经非常成功地在我们的实验室中为迭代科学协议做到了这一点，并且效果很好，尽管对于一个非常有才华的博士后来说，让最初的实现运行起来是一次学习经历。它确实需要您设置并运行一个非常重要的 Condor 集群，但我假设您拥有 Condor 或类似的东西来管理您的所有机器。可能是 Sun GridEngine 有一些我不知道的类似的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T03:25:13.130

还有[distcc](http://distcc.org)，它声称能够通过 SSH 运行（尽管除非 distmake 非常奇怪，否则您应该能够限制对 localhost 的访问并构建 SSH 隧道来运行构建）和[icecream](http://en.opensuse.org/Icecream)。

*更新：*因为目标不是分布式编译，而是恰好用作引导程序的分布式计算，所以使用像[BOINC](http://boinc.berkeley.edu/trac/wiki/ProjectMain)`make`这样为分布式计算设计的工具更有意义。下面的评论表明[Condor](http://www.cs.wisc.edu/condor/)是选择的平台。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-02T11:02:35.573

尽管透明地与“make”集成可能会很复杂，但 GNU 并行似乎提供了一个方便的选项来跨服务器分发命令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T03:33:37.573

如果您对依赖关系很认真（即 make -jxx 在本地工作得很好）， distcc 可能就是您想要的。它非常易于使用，并且可以与几个流行的 CC 缓存一起愉快地工作。同样，正确的依赖关系是关键，尤其是在使用缓存来帮助加快重建过程时。

如果您使用 GCC 生成超出 makefile 本身模块依赖范围的依赖项，您可能会喜欢 distcc。我一直在一个小型构建农场上使用它并取得了巨大的成功.. 但我的设置/树远没有你描述的那么精细。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T04:03:57.530

您可以将[AT&T`nmake`](http://www.research.att.com/~gsf/)与该`coshell`程序结合使用。我不知道如何评估安全性，但 Glenn Fowler 的团队中到处都是伟大的工程师，他们做了很多非常好的事情。我会用我的源代码信任他们 :-) 他们最著名的工具可能是[graphviz](http://www.graphviz.org/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-03-04T12:22:35.373

Makeflow 似乎也是一个很好的解决方案：[http ://www.cse.nd.edu/~ccl/software/makeflow/](http://www.cse.nd.edu/~ccl/software/makeflow/)

# mysql - MySQL 集群与 MySQL innoDB 持久存储

> ID：399415
> 
> 赞同：3
> 
> 时间：2008-12-30T02:48:58.100
> 
> 标签：mysql, cluster-computing, in-memory

我们正在为具有高性能和数据一致性需求的高可用性 (5 9s) 应用程序开发数据库解决方案。我们计划使用 MySQL Cluster 作为主要的内存数据存储，由辅助 innoDB MySQL 数据存储备份以进行持久存储。

建议的方法是在线应用程序将只与内存数据库（MySQL 集群）交互，而 MySQL 集群将通过异步复制/消息传递将数据传播到 innoDB 实例以进行持久存储。

MySQL 集群或 MySQL 本身可以支持这个要求吗？

**更新：**

关于迄今为止提供的答案：

通过使用主数据存储的 MEMORY 引擎和辅助数据存储的 innoDB 引擎，仅使用 MySQL 5.1 是否可行？

MySQL 是否可以使用基于事件的延迟插入方法将插入主数据存储的数据异步复制到辅助数据存储？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T03:07:39.857

您可以使用 MySQL 跨不同的存储引擎复制表。您可以将内存存储引擎中一台服务器上的表复制到其他地方的 innodb 表，或存储引擎的任何其他组合。MySQL 的二进制日志格式兼容所有存储引擎类型。

（有趣的事实：这只是黑洞存储引擎的唯一用途。它将所有写入发送到 /dev/null 但仍将其更改记录到二进制日志中，这意味着它可以异步复制到其他地方的真实表中。 )

在此处查看 Arjen Lentz 的文章：http: [//dev.mysql.com/tech-resources/articles/storage-engine/part_1.html](http://dev.mysql.com/tech-resources/articles/storage-engine/part_1.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T04:03:30.870

是的，可以根据需要复制集群。

请注意，MySQL 集群当前不支持外键。所以你需要创建自己的关键依赖跟踪解决方案（一个常用的方法是触发器）

# c# - 我发现 SwfDotNet 可以帮助我使用 C# 创建 swf flash 文件，但是

> ID：399423
> 
> 赞同：0
> 
> 时间：2008-12-30T02:51:34.337
> 
> 标签：c#, flash

我发现 SwfDotNet 可以帮助我使用 C# 创建 swf flash 文件，但我需要一些文档或一些示例来了解如何更好地使用它。

[http://sourceforge.net/projects/swfdotnet/](http://sourceforge.net/projects/swfdotnet/)

我希望能够拍摄多张图像并创建幻灯片，并在它们之间进行一些过渡。没什么特别的，但我可以找到有关如何执行此操作的详细信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-31T15:51:14.230

不知道我是怎么错过的，但我再次检查并在单独的 CHM 帮助文件下载中有一些非常好的文档。

[http://sourceforge.net/project/showfiles.php?group_id=154817&package_id=215074&release_id=471242](http://sourceforge.net/project/showfiles.php?group_id=154817&package_id=215074&release_id=471242)

# ruby-on-rails - 如何实现单例模型

> ID：399447
> 
> 赞同：33
> 
> 时间：2008-12-30T03:15:19.827
> 
> 标签：ruby-on-rails, singleton

我在 Rails 中有一个站点，并希望有站点范围的设置。如果发生特定事件，我的应用程序的一部分可以通过 SMS 通知管理员。这是我希望通过站点范围的设置进行配置的功能示例。

所以我想我应该有一个设置模型或其他东西。它需要是一个模型，因为我希望能够 has_many :contacts 用于 SMS 通知。

问题是设置模型的数据库中只能有一篇文章。所以我正在考虑使用单例模型，但这只会阻止创建新对象吗？

我是否仍然需要为每个属性创建 getter 和 setter 方法，如下所示：

```
def self.attribute=(param)
  Model.first.attribute = param
end

def self.attribute
  Model.first.attribute
end 
```

直接使用 Model.attribute 但总是创建它的一个实例并使用它可能不是最佳实践吗？

我应该在这里做什么？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-09-17T16:13:03.137

（我同意@user43685 不同意@Derek P - 有很多充分的理由将站点范围的数据保存在数据库中而不是 yaml 文件中。例如：您的设置将在所有 Web 服务器上可用（如果您有多个 Web 服务器）；对设置的更改将是 ACID；您不必花时间实现 YAML 包装器等）

在 Rails 中，这很容易实现，您只需要记住您的模型应该是数据库术语中的“单例”，而不是 ruby​​ 对象术语。

实现这一点的最简单方法是：

1.  添加一个新模型，为您需要的每个属性添加一列
2.  添加一个名为“singleton_guard”的特殊列，并验证它始终等于“0”，并将其标记为唯一（这将强制该表在数据库中只有一行）
3.  向模型类添加静态辅助方法以加载单例行

所以迁移应该是这样的：

```
create_table :app_settings do |t|
  t.integer  :singleton_guard
  t.datetime :config_property1
  t.datetime :config_property2
  ...

  t.timestamps
end
add_index(:app_settings, :singleton_guard, :unique => true) 
```

模型类应该是这样的：

```
class AppSettings < ActiveRecord::Base
  # The "singleton_guard" column is a unique column which must always be set to '0'
  # This ensures that only one AppSettings row is created
  validates_inclusion_of :singleton_guard, :in => [0]

  def self.instance
    # there will be only one row, and its ID must be '1'
    begin
      find(1)
    rescue ActiveRecord::RecordNotFound
      # slight race condition here, but it will only happen once
      row = AppSettings.new
      row.singleton_guard = 0
      row.save!
      row
    end
  end
end 
```

在 Rails >= 3.2.1 中，您应该能够通过调用“ [first_or_create！](https://apidock.com/rails/v4.2.7/ActiveRecord/Relation/first_or_create%21) ”来替换“实例”getter 的主体，如下所示：

```
def self.instance
  first_or_create!(singleton_guard: 0)
end 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-01-13T21:40:38.197

我不同意普遍的看法——从数据库中读取属性并没有错。如果您愿意，您可以读取数据库值并冻结，但是可以有更灵活的替代简单冻结。

YAML 与数据库有何不同？.. 相同的练习 - 应用程序代码持久设置的外部。

数据库方法的好处是它可以以或多或少的安全方式动态更改（不直接打开和覆盖文件）。另一个好处是它可以在集群节点之间通过网络共享（如果实施得当）。

然而，问题仍然是使用 ActiveRecord 实现这种设置的正确方法是什么。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-06-28T20:57:55.220

您还可以强制执行最多一条记录，如下所示：

```
class AppConfig < ActiveRecord::Base

  before_create :confirm_singularity

  private

  def confirm_singularity
    raise Exception.new("There can be only one.") if AppConfig.count > 0
  end

end 
```

这会覆盖该`ActiveRecord`方法，因此如果您尝试创建一个已经存在的类的新实例，它就会崩溃。

然后，您可以继续定义仅作用于一条记录的类方法：

```
class AppConfig < ActiveRecord::Base

  attr_accessible :some_boolean
  before_create :confirm_singularity

  def self.some_boolean?
    settings.some_boolean
  end

  private

  def confirm_singularity
    raise Exception.new("There can be only one.") if AppConfig.count > 0
  end

  def self.settings
    first
  end

end 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-30T05:36:02.070

我不确定我是否会为了这种基本需求而浪费数据库/ActiveRecord/Model 开销。这些数据是相对静态的（我假设）并且不需要动态计算（包括数据库查找）。

话虽如此，我建议您使用站点范围的设置定义一个 YAML 文件，并定义一个将设置加载到常量中的初始化文件。您不会有几乎那么多不必要的移动部件。

没有理由数据不能只存在于内存中并为您节省大量复杂性。常量无处不在，不需要初始化或实例化。如果将类用作单例绝对至关重要，我建议您做以下两件事：

1.  取消定义初始化/新方法
2.  只定义 self.* 方法，这样你就不可能维持一个状态

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-02-26T17:43:19.963

我知道这是一个旧线程，但我只需要同样的东西，发现有一个宝石可以解决这个问题：[acts_as_singleton](https://github.com/stephencelis/acts_as_singleton)。

安装说明适用于 Rails 2，但它也适用于 Rails 3。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-30T04:58:18.403

赔率很好，您不需要单身人士。不幸的是，从模式热潮中走出来的最糟糕的设计习惯之一也是最普遍采用的设计习惯之一。我责怪简单的不幸外观，但我离题了。如果他们将其称为“静态全局”模式，我相信人们会更加羞于使用它。

我建议使用包装类和您要用于单例的类的私有静态实例。您不会像在单例中那样在整个代码中引入紧密的一对。

有些人称之为单态模式。我倾向于认为它只是策略/代理概念的另一个转折，因为您可以通过实现不同的接口来公开/隐藏功能来提供更大的灵活性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-05-11T14:11:15.137

简单的：

```
class AppSettings < ActiveRecord::Base 
  before_create do
    self.errors.add(:base, "already one setting object existing") and return false if AppSettings.exists?      
  end

  def self.instance
    AppSettings.first_or_create!(...) 
  end 
end 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-12-10T13:24:50.743

我将对之前的答案发表一些评论：

*   uniq 索引不需要单独的字段，我们可以将约束放在`id`字段上。因为`id`无论如何我们都应该在 Rails 应用程序中有字段，所以这是一个很好的权衡
*   不需要对模型进行特殊验证和显式 ID 分配，将默认值放在列上就足够了

如果我们应用这些修改，解决方案就变得非常简单：

```
# migration
create_table :settings, id: false do |t|
  t.integer :id, null: false, primary_key: true, default: 1, index: {unique: true}
  t.integer :setting1
  t.integer :setting2
  ...
end

# model
class Settings < ApplicationRecord
  def self.instance
    first_or_create!(...)
  end  
end 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-30T06:32:14.173

使用`has_many :contacts`并不意味着您需要模型。 `has_many`做了一些魔术，但最后它只是添加了一些具有指定合同的方法。您没有理由不能实现这些方法（或您需要的某些子集）以使您的模型表现得像它，`has_many :contacts`但实际上没有为 Contact 使用 ActiveRecord 模型（或根本模型）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-02T01:46:32.890

您还可以查看 Configatron：

[http://configatron.mackframework.com/](http://configatron.mackframework.com/)

Configatron 使配置您的应用程序和脚本变得异常简单。不再需要使用常量或全局变量。现在，您可以使用简单无痛的系统来配置您的生活。而且，因为它都是 Ruby，所以你可以做任何你想做的疯狂的事情！

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-11-22T14:43:24.763

```
class Constant < ActiveRecord::Base
  after_initialize :readonly!

  def self.const_missing(name)
    first[name.to_s.downcase]
  end
end 
```

常量::FIELD_NAME

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-02-13T16:20:00.810

你可以这样做：

```
 class Config < ApplicationRecord
  def self.instance
    Config.first || Config.create!
  end
 end 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-02-14T09:46:56.720

`type`我假设使用具有 uniq 约束的继承列。

```
# miragtion
class CreateSingletonRecords < ActiveRecord::Migration[5.2]
  create_table :balance_holders do |t|
    t.string :type
    t.index :type, unique: true

    t.timestamps
  end
end 
```

父类中的几种方法：

```
class SingletonRecord < ApplicationRecord
  class << self
    def instance
      @singleton__instance__
    end

    def load_record(params = {})
      @singleton__instance__ = find_or_create_by!(params)
    end
  end

  load_record

  validates :type, uniqueness: true
end 
```

在它之后，您可以永远将单个记录用于单例模型类。您的实例将在加载模型类期间加载或创建一次。

# c++ - 前向声明方法指针

> ID：399452
> 
> 赞同：3
> 
> 时间：2008-12-30T03:19:28.570
> 
> 标签：c++, templates

我正在使用 pimpl 习惯用法，并希望引用前向声明类的方法之一。下面不是我正在做的，而是使用相同的概念。

```
template< typename Class, void (Class::*Method)(void) >
struct Call
{
   Call( Class* c )
    : m_c(c)
   { }

   void operator()( void )
   {
      (m_c->*Method)();
   }

   Class* m_c;
};

class A
{
public:
   void foo( void )
   {
      std::cout << "A::foo\n";
   }
};

// this works
void do_foo( A* a )
{
   Call<A,&A::foo> c(a);
   c();
}

class B;
// this doesn't compile
extern void B::bar( void );

// this is what i'd ultimately like to do
void do_bar( B* b )
{
   Call<B,&B::bar> c(b);
   c();
} 
```

两个问题：

*   这可以做到吗？
*   为什么做不到？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-30T06:57:07.570

您不能转发声明成员函数。我认为原因是，当您在指向 B 的指针上调用函数时，编译器必须将 this 指针传递给该方法。但它还不知道 B 的精确类层次结构。因此，此时无法对该指针进行可能的调整（例如，由于方法是虚拟的）。编译器也不知道该方法具有什么可见性。毕竟，它可能是私人的，你不能从外面调用它。声明该成员函数的唯一方法是定义类，然后在该定义中声明该函数。解决您的问题的另一种方法是声明您的自由函数：

```
class B;
void do_bar( B* b ); 
```

然后在一个文件中定义 do_bar，您可以在其中安全地包含 B 类的定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T04:17:20.637

它无法编译 B::bar() 因为类 B 未定义。但我认为你离开的问题太多了。在此刻：

```
void do_bar( B* b )
{
   Call<B,&B::bar> c(b);
   c();
} 
```

你为什么不能说？

```
void do_Bar(B* b) {
    b->bar();
} 
```

也许如果您包含该解释，则回答您的问题会更容易。

其次，当您想通过 do_bar() 调用它时（如上所示），为什么需要它？为什么不将 do_bar 设为外部？

```
extern void B::bar( void ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T06:01:34.780

我不知道，pimpl 类通常与其封装类紧密绑定。我认为以其他方式拥有它有点气味。这就是为什么我通常把它作为一个内部类：

```
class A
{
public:
    ...
private:

    ...

    class A_impl;
    boost::scoped_ptr<A_impl> impl;
}; 
```

# visual-studio - 如何提高慢速硬盘上的 Visual Studio 性能？

> ID：399458
> 
> 赞同：1
> 
> 时间：2008-12-30T03:23:37.673
> 
> 标签：visual-studio, performance

我目前有一台带 5400 转驱动器的笔记本电脑。它安装了视觉工作室，虽然它可以工作，但我已经阅读了很多地方，你可以通过提高驱动器速度从 VS 获得相当不错的性能提升。

我没有那么奢侈，但我想知道是否可以通过将我的 Visual Studio 项目存储在外部 USB 或 FireWire 驱动器上并从那里加载它们而不是从内部磁盘加载它们，从而获得一些性能优势？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T03:43:29.613

如果您使用的是 Windows Vista，您可以尝试将[ReadyBoost](http://en.wikipedia.org/wiki/ReadyBoost)与 USB 闪存驱动器一起使用，看看它是否可以提高您的 VisualStudio 性能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T04:38:23.327

USB 磁盘协议的**性能很差**。我有一个 3.5 英寸的 SATA 磁盘，通过我的机箱安装时可以提供 80MB/s 的读取速度。当在外部 USB 机箱中时，同一个磁盘给我大约 30MB/s 的速度。**限制因素是协议**，它只能提供您预期的 480Mb/s 的一半左右。（我从一个以编写 USB 堆栈为生的人那里得到这个。）我建议你**借一个驱动器并测量**一下，看看你是否得到了明显的改进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T05:14:31.740

更换笔记本电脑硬盘既便宜又快捷，使用 Windows Home Server，您可以将备份恢复到新硬盘。

即使这是为了工作，我仍然认为如果我的雇主不付钱的话，花我自己的钱来提高我的生产力是值得的。（或者找一个愿意的雇主！）

最大化你的内存。这将减轻硬盘驱动器上的一些负载。

一旦您拥有大量 RAM，请尝试禁用虚拟内存（又名交换空间/又名页面文件）。对于某些使用模式，这可以更快。对于其他人，它可能会更慢。对于其他人，它会崩溃。因此，进行实验（并经常保存）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T03:39:57.983

根据一些快速数据，我发现使用 USB 2.0 驱动器似乎不会比内部 5400 rpm 硬盘驱动器更好。

[内部硬盘性能](http://forum.tabletpcreview.com/showthread.php?t=427)

[USB 2.0 性能](http://www.tomshardware.com/reviews/amd-crossfire-xpress-3200-chipset-core-2-rolls,1541-11.html)

但是，我认为更快的火线驱动器之一可能会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T03:43:50.690

没有机会使用 1394 磁盘，但我知道 USB 外部磁盘比内部磁盘慢。

对于大文件复制，USB 磁盘的性能通常在 20MB/s 左右，处理小文件的性能应该更差（vs.net 项目中的大多数文件都很小）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-30T04:17:41.590

从我的外部 7200rpm usb 2 驱动器通过内部 5400rpm 驱动器将文件刻录到 DVD 时，我肯定会获得更好的性能

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-30T04:45:18.880

USB 驱动器对您没有帮助，因为它比内部驱动器慢。如果您的笔记本电脑有 E-Sata 端口，则此驱动器可能很有用。[http://www.ocztechnology.com/products/flash_drives/ocz_throttle_esata_flash_drive](http://www.ocztechnology.com/products/flash_drives/ocz_throttle_esata_flash_drive)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-30T04:52:23.203

使用内部驱动器可能会更好。如果您有足够的计算机内存，则硬盘驱动器访问可能会缓存在物理内存中，而不是硬盘空间中。

如果文件更改，可能会阻止 windows 频繁地写回磁盘，但这在笔记本电脑上可能不安全。

如果您具有并行构建能力，将并行进程数设置为 1 + cpu 核心数将允许在加载另一个文件时使用（编译）cpu。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-30T05:16:53.187

您最近真的检查过 7200RPM 笔记本电脑驱动器的价格吗？160GB，7200RPM，60 美元@NewEgg.com

# nhibernate - NHibernate Mapping 中介表

> ID：399459
> 
> 赞同：0
> 
> 时间：2008-12-30T03:23:45.363
> 
> 标签：nhibernate, hibernate

嗨，我正在寻求将下表映射到休眠映射文件的帮助： [模式图像 http://barry-jones.com/temp/sch2.jpg](http://barry-jones.com/temp/sch2.jpg)

在加载我的 userVO 时，我试图用相关的 localCalendarGroups 填充 localCalandarGroups 列表。我正在使用中间表（user_localCalendarGroup）来保留用户和 localCalendarGroup id

```
 public class UserVO
{
    public virtual int id { get; set; }
    public virtual string name { get; set; }
    public virtual string pass { get; set; }
    public virtual string email { get; set; }
    public virtual string level { get; set; }
    public virtual List<LocalCalendarGroupVO> localCalendarGroups { get; set; }
}
public class LocalCalendarGroupVO
{

    public virtual int id { get; set; }
    public virtual string name { get; set; }

} 
```

到目前为止，这是我的映射文件。如何让 NHibernate 知道中间表？

```
 <class name="UserVO" table="tb_users" lazy="false">

<id name="id" column="id">

  <generator class="native" />

</id>

<property name="name" />
<property name="pass" />
<property name="level" />
<property name="email" />
<property name="localCalendarGroups"/> 
```

任何帮助，指针非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T08:44:28.460

我建议您的第一件事是使用 IList 而不是 List 来映射域类中的 localCalendarGroups 关联。这将启用延迟加载集合。这是 UserVO 类的映射文件：

```
<class name="UserVO" table="tb_users">
    <id name="id" column="id">
        <generator class="native" />
    </id>
    <property name="name" />
    <property name="pass" />
    <property name="level" />
    <property name="email" />

    <bag name="localCalendarGroups" table="user_localCalendarGroup">
        <key column="userID" />
        <many-to-many class="LocalCalendarGroupVO" column="calID" />
    </bag>
</class> 
```

以及对应的类定义：

```
public class UserVO
{
    public virtual int id { get; set; }
    public virtual string name { get; set; }
    public virtual string pass { get; set; }
    public virtual string email { get; set; }
    public virtual string level { get; set; }
    public virtual IList<LocalCalendarGroupVO> localCalendarGroups { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T11:44:26.960

这个页面有一个相当好的解释。

[http://codebetter.com/blogs/peter.van.ooijen/archive/2008/05/29/nhibernate-many-to-many-collections-or-mapping-is-not-one-table-one-class。 aspx](http://codebetter.com/blogs/peter.van.ooijen/archive/2008/05/29/nhibernate-many-to-many-collections-or-mapping-is-not-one-table-one-class.aspx)

# firefox - 谷歌地图覆盖图标在特定缩放级别消失

> ID：399460
> 
> 赞同：2
> 
> 时间：2008-12-30T03:24:14.817
> 
> 标签：firefox, google-maps, overlay-icon-disappear

我注意到 Firefox 3 演示了这个问题。我放下了一个覆盖图标并玩弄地图缩放。在某些缩放级别，我发现图标由于某种未知原因而消失。

缩小会重新显示图标。或者在消失期间，我点击谷歌地图，它会以某种方式触发恢复图标。

我怀疑它与事件触发有关。Internet Explorer 并没有表现出同样的问题。

有什么建议吗？比如如何在 Firefox 上触发更新事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T11:45:03.510

`optimized: false`创建标记时尝试使用。

# content-management - 提供内容管理解决方案

> ID：399469
> 
> 赞同：3
> 
> 时间：2008-12-30T03:33:13.800
> 
> 标签：content-management

我正在为慈善机构开发一个小型网站（非营利性）。慈善主席想在网站完成后添加内容，主要是文字。然而，他们不想直接输入 XHTML。

关于这个问题有哪些可能的选择？

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T03:38:39.687

如果他们想要输入/编辑的数据是简单的非格式化文本，那么最好的办法是为他们提供一个简单的界面来自己编辑页面。如果做不到这一点，一些流行的选择是：

[Drupal](http://www.drupal.org/)
[Joomla](http://www.joomla.org/)

或者对于电子商务，[Magento](http://www.magentocommerce.com/)。

对于其他 CMS 或在线尝试演示，请查看[OpenSourceCMS.com](http://www.opensourcecms.com/)。我绝不隶属于任何这些网站。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T03:36:03.700

设置数十个免费的开源内容管理系统之一。你没有指定你熟悉的语言，所以我作为一个 PHP 人会推荐 Drupal 或 WordPress。两者都能够进行所见即所得的编辑，而无需了解 (X)HTML。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T03:59:04.980

如果您更喜欢 Python 和 PHP，那么完全用 Python 完成的一个非常好的系统是[Plone 。](http://plone.org/)

我想您希望通过适合组织的设计快速启动并运行，因此使用 Drupal 或 Wordpress 确实很有意义，因为两者都有很多免费的主题和设计。

我为几个非营利组织做了很多工作，许多用户发现 Joomla 在后端有点吓人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T03:36:17.507

任何带有所见即所得编辑器的 CMS 都可以。如果你有一个预先存在的布局，那么就得到一些可嵌入的东西。我只对 Drupal 和 Joomla 这样的“大”系统非常熟悉，但我知道有一些简单的产品可以完全满足您的工作需求。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T03:52:04.043

我建议使用 Wordpress。您可以使用它构建中小型站点。安装非常简单，并且比 Drupal 或 Joomla 更容易对最终用户进行管理。

# mfc - 我可以更改指定窗口标题栏的高度吗？

> ID：399482
> 
> 赞同：2
> 
> 时间：2008-12-30T03:41:04.533
> 
> 标签：mfc, caption

我想自己绘制应用程序窗口的标题栏，所以我决定重写 OnNcPaint() 方法。但我不知道如何设置标题栏的不同高度。每次我使用 GetSystemMetrics(SM_CYCAPTION) 时，它都会返回相同的值。

谁能告诉我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T06:54:03.300

您无法更改普通 Windows 绘制的标题栏的大小。这是由用户设置和主题决定的。如果您自己绘制东西，那么您还可以自己定义标题尺寸。您可以随心所欲地绘制任何您想要的东西，因此您可以在通常被认为是客户区域的地方绘制标题栏。要使该额外区域表现得好像它真的是标题栏，请处理[`wm_NCHitTest`](http://msdn.microsoft.com/en-us/library/ms645618.aspx)消息并返回`htCaption`。

请注意，`GetSystemMetrics`不接受窗口句柄作为其参数之一。这意味着它不能返回特定于窗口的指标。顾名思义，它为您提供系统范围的指标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-29T02:54:53.580

与其弄乱标题，不如根本不要使用它。相反，“发明”你自己的标题。将 TPanel 设置为与窗口顶部对齐并将其用作该窗口的标题。

# javascript - 使用 jQuery/Javascript 打开保存图像对话框？

> ID：399486
> 
> 赞同：11
> 
> 时间：2008-12-30T03:44:39.317
> 
> 标签：javascript, jquery

当用户单击网页上的图像时，我想触发浏览器的保存图像对话框并让用户将图像保存在他们的硬盘上。是否有跨浏览器的方式来使用 jQuery/Javascript 做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-30T04:10:35.270

不准确，但您可以通过超链接到 img 文件并在服务器响应中设置 content-type 和 content-disposition 标头来实现。尝试例如 application/x-download[以及此处指定的其他标头](http://www.onjava.com/pub/a/onjava/excerpt/jebp_3/index3.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T04:17:24.820

我唯一想到的是Internet Explorer的document.execCommand（“SaveAs”），您可以打开一个窗口或使用带有图像url的隐藏iframe，然后调用它......

检查（当然用 IE）[这个](http://dl.getdropbox.com/u/35146/ieSaveAs.html)我已经完成的例子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-11T12:19:34.053

当您单击图像时，您可以创建一个隐藏的文件输入字段并触发（）这个：

```
$('.yourImageClass').click(function(){
 $('.hiddenInputClass').trigger('click');
}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T03:52:40.033

我不这么认为——许多基本的浏览器功能（例如：打印预览）对 Javascript 不可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-10T04:24:27.793

[谷歌网上商店](https://chrome.google.com/webstore/detail/bhkplggmgfmnekjcipahhjjlejhafoad/)
[Github](https://github.com/DrJKL/dragToSaveImages)

如果这里有人仍然感兴趣，我做了一个类似这样的扩展。它使用 XMLHTTPRequest 来获取对象，在这种情况下假定该对象是图像，然后为它创建一个 ObjectURL，一个指向该 ObjectUrl 的链接，然后单击虚构的链接。

在您的情况下，您可以将 ondragend 更改为 onclick 并有选择地将其添加到图像中。

# vba - 运行保存宏后如何停止重命名excelsheets

> ID：399488
> 
> 赞同：1
> 
> 时间：2008-12-30T03:46:02.043
> 
> 标签：vba, excel

下面是一个宏，用于将多张工作表保存到不同的 csv 文件，但它不断重命名和保存原始工作簿，如何阻止它。

```
Private Sub CommandButton1_Click()

Dim WS As Excel.Worksheet
Dim SaveToDirectory As String

Dim CurrentWorkbook As String
Dim CurrentFormat As Long
Dim myName As String
myName = myName & Application.Cells(2, 2) 'cell B2 '

CurrentWorkbook = ThisWorkbook.FullName

CurrentFormat = ThisWorkbook.FileFormat

' Store current details for the workbook '

SaveToDirectory = "C:\temp\" 
```

' 此行用于纠正 Stackoverflow 代码格式中的斜线问题

```
For Each WS In ThisWorkbook.Worksheets
  WS.SaveAs SaveToDirectory & myName & WS.Name, xlCSV
Next

Application.DisplayAlerts = False
ActiveWorkbook.SaveAs Filename:=CurrentWorkbook, FileFormat:=CurrentFormat
Application.DisplayAlerts = False
' Temporarily turn alerts off to prevent the user being prompted '
'  about overwriting the original file. '

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T04:37:10.973

`ActiveWorkbook.SaveAs Filename:=CurrentWorkbook, FileFormat:=CurrentFormat Application.DisplayAlerts = False`

If you are not writing anything on the workbook, why are you trying to save it?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T04:44:38.553

Try this:

```
Private Sub CommandButton1_Click()

    Dim WS As Excel.Worksheet
    Dim SaveToDirectory As String
    Dim myName As String
    Dim CurrentWorkbook As String

    ' Get the path to the curent workbook so we can open it later.
    CurrentWorkbook = ThisWorkbook.FullName

    SaveToDirectory = "C:\temp\"

    ' Turn off Excel alerts so we're not prompted if the file already exists.
    Application.DisplayAlerts = False

    For Each WS In ThisWorkbook.Worksheets
        WS.Activate                      ' Make this the current worksheet.
        myName = Application.Cells(2, 2) ' Get the contents of cell B2 for our file name.
        WS.SaveAs SaveToDirectory & myName & WS.Name, xlCSV
    Next

    ' Open the original workbook.
    Application.Workbooks.Open CurrentWorkbook

    ' Close workbook associated with the last saved worksheet.
    ThisWorkbook.Close xlDoNotSaveChanges

End Sub 
```

It looks like the Excel SaveAs method makes the saved worksheet the active workbook, so I just close this without saving.

# ruby-on-rails - rails模型属性在db中没有对应的列

> ID：399490
> 
> 赞同：5
> 
> 时间：2008-12-30T03:46:19.453
> 
> 标签：ruby-on-rails, ruby, activerecord, models

我有一些不需要任何持久性的 rails 模型，但是我希望 rails 认为该模型实际上具有属性 x、y、z，因此当在控制器中调用诸如 to_json 之类的方法时，我将它们免费包含在内。

例如，

```
class ModelWithoutTableColumns << ActiveRecord::Base

def x
   return "Custom stuff here"
end 
```

表“ModelWithoutTable”的数据库中没有 x 列（对不起，名称有点混乱！）

有人知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T03:52:59.720

只是不要从 ActiveRecord::Base 继承

编辑：您是否尝试过将选项传递给 to_json，例如 :methods？看[这里](http://api.rubyonrails.org/classes/ActiveRecord/Serialization.html#M001637)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-07T20:31:20.113

听起来你想要 ActiveModel。查看[http://yehudakatz.com/2010/01/10/activemodel-make-any-ruby-object-feel-like-activerecord/](http://yehudakatz.com/2010/01/10/activemodel-make-any-ruby-object-feel-like-activerecord/)了解 Yehuda Katz 的精彩演练。特别是根据您的要求称为“序列化”的部分`to_json`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T04:18:02.650

那行不通——ActiveRecord::Base 定义了 to_json，但需要一个表。

您应该查看 ActiveRecord::BaseWithoutTable 插件。[这是如何使用它](http://agilewebdevelopment.com/plugins/activerecord_base_without_table)，这里是[Rails 2 的更新版本](http://gitorious.org/projects/activerecord-basewithouttable-for-rails-2)。

我没有尝试过其中任何一个，所以不能保证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T04:46:59.877

您可能还想查看acts_without_database，有关它的当前详细信息在[这里](http://www.pathf.com/blogs/2008/12/acts_without_database-using-activerecord-for-non-database-backed-objects/)，但该站点目前已关闭。[这是 RubyFlow 上的帖子](http://www.rubyflow.com/items/1442)，从今天开始。

# sql-server-2005 - 在不使用 SSIS 的情况下将平面文件导入 SQL Server 2005 的最优雅方式

> ID：399498
> 
> 赞同：2
> 
> 时间：2008-12-30T03:58:05.543
> 
> 标签：sql-server-2005, csv, import, flat-file

由于某些原因，SSIS 不可用。

我阅读了有关 OPENROWSET 的信息，但在格式文件和文件路径上我还会遇到其他问题。

我怎样才能以优雅的方式做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T04:21:41.893

不知道你的整个情况，这就是我表面上推荐的。

如果您没有 SSIS，并且不想处理 BULK INSERT/bcp 格式的文件，我敢说导入文件的最优雅的方法是编写自己的基于 .NET 的小型文件控制台应用程序来做到这一点。

请注意，如果可以将数据加载到 DataTable 中，则可以使用 .NET 中的[SqlBulkCopy](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlbulkcopy.aspx)类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T04:32:24.273

如果文件像 csv 一样分隔，您可以使用CodeProject 上的[Fast CSV Reader 。](http://www.codeproject.com/KB/database/CsvReader.aspx)如果它不是标准化格式，那么我同意 Dennis 的观点，自定义控制台应用程序可能是要走的路。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T04:46:24.527

您始终可以使用[bcp 实用程序](http://msdn.microsoft.com/en-us/library/aa337544.aspx)

它从最早的版本就已经存在并且非常易于使用。

# javascript - DHTML：获取更新的元素大小

> ID：399508
> 
> 赞同：3
> 
> 时间：2008-12-30T04:06:31.313
> 
> 标签：javascript, dhtml

我正在更新javascript 中标签的`src`属性。`<img>`完成此操作后，我需要获取其父级的新高度，`<div>`以便我可以更新页面上其他元素的大小。但是，如果我在更新图像后直接检索父级的`offsetHeight`属性，我会*在进行*更改之前`src`获得高度。有没有办法强制浏览器呈现更新的页面，以便我可以获得新的高度？

 *复制：

```
<html>
<head>
<script type="text/javascript">
    function changeImage(){
        document.getElementById("image").src = "b.jpg";
        // here I need to re-render the page
        alert(document.getElementById("parent").offsetHeight);
        // ^ alerts the height of a.jpg, not b.jpg (unless this is the second click)
    }
</script>
</head>

<body onclick="changeImage()">

<div id="parent">
    <img id="image" src="a.jpg" />
</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T04:17:28.920

如果您不立即需要新高度，请使用 Marc 的解决方案。但是，如果您需要用户点击时的正确高度，则需要预加载 b.jpg。然后，我不知道在同一个函数中高度是否正确，但我想 setTimeout('alert(document.getElementById("parent").offsetHeight);',1); 会在一毫秒内提醒高度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T04:12:52.847

在高度可用之前，您可能需要等待图像完成加载。在您的示例代码中，设置“src”属性将异步加载图像（b.jpg），因此您可能希望在该元素上附加一个“onload”处理程序，以便在完成加载和渲染时得到通知。

# sql-server - sql server 2000 和 postgresql 8.3 的同步

> ID：399509
> 
> 赞同：2
> 
> 时间：2008-12-30T04:07:45.760
> 
> 标签：sql-server, postgresql, synchronization, migration

场景：

两个数据库（每个都有一个名为的数据库，例如 testdb）：

*   微软 SQL 服务器 2000
*   PostgreSQL 8.3

我需要同步这两个testdb，其实方向是从SqlServer到Postgresql。

SqlServer 上的 testdb 的结构偶尔会发生变化。我只需要同步的 testdb 的表和数据，排除索引、视图或其他 foo。

我已经阅读了这篇文章：[Ian Harding 的 Microsoft SQL Server 到 PostgreSQL 迁移](http://wiki.postgresql.org/wiki/Microsoft_SQL_Server_to_PostgreSQL_Migration_by_Ian_Harding)，但这似乎是一次性解决方案。我发现了这个程序：[自动为 SQL Server 对象生成脚本](http://www.databasejournal.com/features/mssql/article.php/2205291/Generate-Scripts-for-SQL-Server-Objects.htm)，但我认为自动完成文章中的步骤仍然很难。

是否可以通过其他方式自动进行同步？（通过批处理/脚本或非商业工具）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T04:21:10.787

您可能已经考虑过这一点，但是……您可以创建一个 DTS 包来从 SQL Server 导出数据并将其移动到某个中间位置。然后一个 cron 作业将执行一个脚本来将数据导入 Postgres。

# netbeans - 使JavaFX编译成Java 1.6级别的源代码

> ID：399510
> 
> 赞同：1
> 
> 时间：2008-12-30T04:08:48.503
> 
> 标签：netbeans, javafx

如何使用 netbeans 制作 JavaFX 将我的代码编译为 1.6 级合规性。

目前它似乎被硬编码为 1.5 级 - 阻止我使用 java.awt.Desktop （等）中的有用工具

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T21:58:58.060

Remember - because JavaFX must run on the Apple Java run-time which currently is Java 1.5 - JavaFX can't compile to Java 1.6.

Thus it likely will change in the future so that it can compile to Java 1.6.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-10T22:36:35.277

这是 Stephen Chin 的一个很好的解释：http: [//steveonjava.com/2009/01/02/hacking-javafx-10-to-use-java-16-features/](http://steveonjava.com/2009/01/02/hacking-javafx-10-to-use-java-16-features/)

此外，如果您正在学习新语言，Steve 关于 JavaFX 的博客也很棒。

# cups - 渲染对象的类型（CUPS）

> ID：399526
> 
> 赞同：1
> 
> 时间：2008-12-30T04:24:20.797
> 
> 标签：cups

我正在为 CUPS（pstoraster）制作我的 RIP 副本。我想知道使用 ghostscript 渲染的对象的类型。

有没有人有这个想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T18:27:09.550

这是 pstoraster 输出的文档，它只是一个调用 ghostscript 的脚本：

[http://www.cups.org/documentation.php/doc-1.4/spec-raster.html](http://www.cups.org/documentation.php/doc-1.4/spec-raster.html)

# cocoa - 通过 Cocoa 的 NSDate 解析不支持的日期格式

> ID：399527
> 
> 赞同：13
> 
> 时间：2008-12-30T04:24:50.700
> 
> 标签：cocoa, parsing, date

使用 Cocoa 框架，我如何将 @"2008-12-29T00:27:42-08:00" 解析为 NSDate 对象？标准`-dateWithString:`不喜欢它。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-30T09:55:09.973

您可以使用[NSDateFormatter](http://developer.apple.com/documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW5)来解析日期：

```
 NSDateFormatter* dateFormatter = [[[NSDateFormatter alloc] init] autorelease];
    [dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ssZ"];
    date = [dateFormatter dateFromString:dateStr]; 
```

[unicode 日期格式模式](http://unicode.org/reports/tr35/tr35-4.html#Date_Format_Patterns)定义了您可以与该`setDateFormat:`方法一起使用的格式字符串。

请注意，如果您的目标是 10.4，那么您需要调用：`[dateFormatter setFormatterBehavior:NSDateFormatterBehavior10_4];`。iphone 或 leopard 不需要，因为这种模式是那里的默认模式。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-30T04:42:45.220

如果您只需要处理 ISO 8601 格式（该字符串就是一个例子），您可以试试[我的 ISO 8601 parser 和 unparser](http://boredzo.org/iso8601parser/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-05-31T02:45:25.753

实际上，您需要设置时区、日历和语言环境。如果您未设置区域设置，则用户启用了 AM/PM 时间，格式化程序将添加 AM/PM 标记！如果您不设置时区，它将使用当前时区，但会将其标记为“Z”（“Zulu”或 GMT）。如果您不设置日历，使用日本皇历的用户将使用当前天皇登基后的年数，而不是耶稣基督出生后的年数。请务必在我提到的所有场景中进行测试！

```
 NSDateFormatter * f = [[NSDateFormatter alloc] init];
    [f setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss'Z'"];
    f.timeZone = [NSTimeZone timeZoneForSecondsFromGMT:0];
    f.calendar = [[[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar] autorelease];
    f.locale = [[[NSLocale alloc] initWithLocaleIdentifier:@"en_US"] autorelease];
    NSString * str = [f stringFromDate:someDate];
    NSDate * date = [f dateFromString:dateStr]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T10:20:06.380

时区的设置方式从 ios 5 更改为 ios 6。iOS 6 使用 ZZZZZ 支持 +01:00 格式，但 ios 5 不支持。我用这个解决方案解决了这个问题，它可以帮助我在 ios 5 和 6 中解析具有以下格式的日期。

2013-05-07T00:00:00+01:00

```
NSMutableString *newDate = [date mutableCopy];
NSRange range;
range.location = 22;
range.length = 1;
[newDate replaceCharactersInRange:range withString:@""];
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ssZZ"];    
NSDate *dateFromString = [[NSDate alloc] init];
dateFromString = [dateFormatter dateFromString:newDate]; 
```

# iphone - iPhone 开发 - 使用多个视图/xib/nib 的复杂应用程序

> ID：399530
> 
> 赞同：7
> 
> 时间：2008-12-30T04:29:00.847
> 
> 标签：iphone, multiple-views

我是 iPhone 开发的新手，多个视图（xib 或 nib）真的让我很困惑。这就是我想要达到的目标......

1.  使用标签栏查看（标签 1、标签 2、标签 3）
2.  Tab 2 View (Navigation Controller) 2.1 选择Table Row会显示一个带有单元格详细信息的View 2.2 导航栏上的Add按钮会显示一系列的视图界面来获取不同类型的信息（例如位置信息，个人信息等） - 需要这是顺序的，不能为此使用控制段。成功收集信息后，在选项卡 2 视图表中创建一个新单元格，将相关信息保存到自定义结构，并显示带有 2 个选项的完成页面（添加另一个，查看添加的项目 - 只读视图）

我对如何处理这些多个视图（将它们链接在一起，以及来回交流信息）感到困惑。所有这些都将由我的应用程序委托类处理，还是我可以/应该使用多个委托类？无论哪种方式，您都可以为我指明正确的方向 - 可能是一些示例应用程序或教程，解释如何处理这种或更复杂的情况。

在这方面的任何帮助将不胜感激。

* * *

我看过 TheElements 和 SeismicXML 的例子。

TheElements 示例代码给出了如何使用`UITabBarController`和的基本概念`UINavigationController`，但该示例没有讨论从子控制器向父控制器传递信息。

就我而言，我有一个，其中一个选项卡在右上角或导航栏上`UITabBarController`显示一个带有 (+) 的选项卡。`UINavigationController`现在 (+) 将为用户输入打开一个界面，该输入将用于存储数据（例如在 sql 中），并在`UITableView`嵌入的`UINavigationController`. 现在，将使用 (+) 打开的界面将按照一系列步骤（如 Main > Step 1 > Step 2> Complete）接受用户输入。每个步骤都将显示一个单独的视图。我很难尝试设计这个模型。或者，也许我不习惯在 Cocoa/iPhone 中编程，而且我的眼光不正。我还有什么其他选择 - 当涉及到涉及 20-30 个字段（文本、列表、日期、图像等）的用户输入时。您能否就此提供一些意见。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T07:25:40.353

对于 iPhone，您需要处理大多数视图并在各自的视图控制器之间切换。对于您的情况，这些将是 UITabBarController 和 UINavigationController。为了在用户自己的操作之外控制它们并根据需要存储数据，您可能需要考虑创建自己的这些控制器的子类。一些好的起点是 TheElements（包括标签栏和表格视图）和 SeismicXML（表格视图和导航控制器）。

大多数实际链接都可以在 Interface Builder 中处理，您可以在其中创建和布局所有各种选项卡的内容，但您需要使用您的子类来提供数据（尤其是在表格视图的情况下，您可以在其中需要为每个单元格设置数据）。

希望这有帮助，
杰夫

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-15T17:46:45.440

也许[这个 Google Books 链接](http://books.google.co.in/books?id=WV9glgdrrrUC&pg=PT141&lpg=PT141&dq=how+to+create+multi+view+application+in+Iphone&source=web&ots=uMbRfTnd3I&sig=v8t4ucJoMLtMWXdjVuTy0Af1ZhM&hl=en&sa=X&oi=book_result&resnum=2&ct=result#PPT145,M1)可以帮助您创建多视图应用程序。

# c# - 如何在 .NET 中获取双键击

> ID：399532
> 
> 赞同：2
> 
> 时间：2008-12-30T04:29:51.907
> 
> 标签：c#, .net, key

如何使用 C# 在 .NET 中获取 ^MM (CTRL + M + M) 之类的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T04:42:58.543

这只是一个猜测，您可以在每次击键时存储键和键修饰符，然后下次通过检查最后按下的键是否匹配序列。

您可以在 ProcessCmdKey 或 OnKeyPress 中实现此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T05:13:30.133

正如另一张海报所链接的那样，ModiferKeys 是确定是否按下 Shift 或 Control 的方法。或者，如果您覆盖 ProcessCmdKeys 这是一种方法：

```
 private static bool lastKeyWasControlM = false;

    protected override bool ProcessCmdKey(ref Message msg, Keys keyData)
    {
        if (keyData == (Keys.Control | Keys.M))
        {
            lastKeyWasControlM = true;

            // might want to return true here if Ctrl-M maps to nothing else...
            // Ideally should start a timer and if the 'M' key press happens
            // within a short duration (say 1 second) its a combined key event
            // else its the start of another key event...
        }
        else
        {
            if ((keyData & Keys.M) == Keys.M &&
                 (keyData & Keys.Control) != Keys.Control)
            {
                // M pressed with no modifier
                if (lastKeyWasControlM == true)
                {
                    // Handle Ctrl-M + M combined key press...

                    return true;
                }
            }

            lastKeyWasControlM = false;
        }

        return base.ProcessCmdKey(ref msg, keyData);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T05:13:30.807

这是一种方法：

```
bool mSeenCtrlM;

protected override bool ProcessCmdKey(ref Message msg, Keys keyData) {
  if (keyData == (Keys.Control | Keys.M)) {
    mSeenCtrlM = !mSeenCtrlM;
    if (!mSeenCtrlM) {
      MessageBox.Show("yada");
    }
    return true;
  }
  mSeenCtrlM = false;
  return base.ProcessCmdKey(ref msg, keyData);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T15:04:29.740

我会建议一个更通用的解决方案。执行以下操作：

```
List<Keys> currentKeyStack = new List<Keys>();
DateTime lastUpdate = DateTime.Now;
TimeSpan lengthOfTimeForChordStroke = new TimeSpan(0,0,5);  //Whatever you want here.
protected override bool ProcessCmdKey(Message msg, Keys keyData)
{
     if (DateTime.Now - LastUpdate > lengthOfTimeForChordStroke)
     {
          currentKeyStack.Clear();
     }
 currentKeyStack.Add(keyData);

//You now have a list of the the last group of keystrokes that you can process for each key command, for example:

     if (currentKeyStack.Count == 2) && (currentKeyStack[0] == (Keys.Control | Keys.M)) && (currentKeyStack[1] == (Keys.M))
     {
          MessageBox.Show("W00T!");
     }
} 
```

代码可能在语法上不正确，但这是一个实现细节。这种事情将更可扩展以处理您*所有*的关键和弦组合，而不仅仅是一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-15T22:03:06.607

是的，我意识到这有点晚了，但是这个线程帮助了我，所以我想我会把它传回去。

我已经稍微扩展了 GWLlosa 代码......我还尝试慷慨地发表评论。这使您可以在代码中构建您的键序列。对于 Narven，顺序是。

```
 private static List<List<Keys>> command = new List<List<Keys>>{
        new List<Keys>{Keys.Control | Keys.M},
        new List<Keys>{Keys.M}
    }; 
```

或者

```
 private static List<List<Keys>> command = new List<List<Keys>>{
        new List<Keys>{Keys.Control | Keys.M},
        new List<Keys>{Keys.Control | Keys.M}
    }; 
```

取决于他想要做什么。

完整代码如下。

```
 // This defines the command sequence. In this case, "ctrl-m, ctrl-m, 1 or 2 or 3 or 4, A"
    private static List<List<Keys>> command = new List<List<Keys>>{
        new List<Keys>{Keys.Control | Keys.M},
        new List<Keys>{Keys.Control | Keys.M},
        new List<Keys>{Keys.D1, Keys.D2, Keys.D3, Keys.D4 },
        new List<Keys>{Keys.A}
    };

    private static List<Keys> currentKeyStack = new List<Keys>();
    private static DateTime lastUpdate = DateTime.Now;

    // See if key pressed within 750ms (0.75 sec)
    private static TimeSpan lengthOfTimeForChordStroke = new TimeSpan(0, 0, 0, 0, 750);

    protected static void ProcessCmdKey(Keys keyData)
    {
        // Merge Modifiers (Ctrl, Alt, etc.) and key (A, B, 1, 2, etc.)
        Keys keySequence = (Control.ModifierKeys | keyData);

        if ((TimeSpan)(DateTime.Now - lastUpdate) > lengthOfTimeForChordStroke)
        {
            Console.WriteLine("Clear");
            currentKeyStack.Clear();
        }

        int index = currentKeyStack.Count();
        Console.WriteLine("Index: " + index);

        Console.Write("Command: ");
        foreach (List<Keys> key in command)
        {
            foreach (Keys k in key)
            {
                Console.Write(" | " + k.ToString() + " (" + (int)k + ")");
            }
        }
        Console.WriteLine();

        Console.Write("Stack: ");
        foreach (Keys key in currentKeyStack)
        {
            Console.Write(" | " + key.ToString() + " (" + (int)key + ")");
        }
        Console.WriteLine();

        Console.WriteLine("Diff: " + (TimeSpan)(DateTime.Now - lastUpdate) + " length: " + lengthOfTimeForChordStroke);
        Console.WriteLine("#: " + index + "KeySeq: " + keySequence + " Int: " + (int)keySequence + " Key: " + keyData + " KeyInt: " + (int)keyData);

        // .Contains allows variable input, e.g Ctrl-M, Ctrl-M, 1 or 2 or 3 or 4
        if (command[index].Contains(keySequence))
        {
            Console.WriteLine("Added to Stack!");
            currentKeyStack.Add(keySequence);
        }
        else
        {
            // Clear stack since input didn't match
            Console.WriteLine("Clear");
            currentKeyStack.Clear();
        }

        // When command sequence has been met
        if (currentKeyStack.Count == command.Count())
        {
            // Do your thing here...
            Console.WriteLine("CAPTURED: " + currentKeyStack[2]);
        }

        // Reset LastUpdate
        Console.WriteLine("Reset LastUpdate");
        lastUpdate = DateTime.Now;

        Console.WriteLine("\n");
    } 
```

# sql-server - 在 SQL Management Studio 2005 中附加数据库时缺少驱动器

> ID：399536
> 
> 赞同：0
> 
> 时间：2008-12-30T04:31:40.173
> 
> 标签：sql-server, sql-server-2005, ssms

我正在尝试从 SQL Management Studio 2005 中将外部 mdf 文件附加到我的 SQLEXPRESS 实例。但是，我无法在“查找数据库文件”提示中的目录浏览器下看到数据库文件所在的驱动器.

是否有任何东西阻止 Management Studio 或 SQL 实例识别我的驱动器？驱动器本身是安装在我的计算机中的本地磁盘。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T04:36:03.190

检查驱动器根目录的权限。文件夹浏览器在 SQL 引擎标识下运行，该标识可能无权访问该驱动器。

# c++ - 如何将 PDCurses 链接到 Windows 上的 C++ 应用程序？

> ID：399538
> 
> 赞同：0
> 
> 时间：2008-12-30T04:33:09.560
> 
> 标签：c++, windows, linker, ncurses, pdcurses

我正在构建一个 C++ 应用程序，需要在 Windows 上使用 PDCurses。我正在使用 MS VS 2005 中的 VC++ 进行编译，但出现链接错误。

> ```
>  error LNK2019: unresolved external
>  symbol __imp__GetKeyState@4 referenced
>  in function __get_key_count 
> ```

有 11 个错误都具有相同的错误代码和不同的符号。缺少的符号是 __imp__MapVirtualKeyA@8、__imp__FindWindowA@8、__imp__wsprintfA、__imp__SendMessageA@16、__imp__GetWindowThreadProcessId@8、__imp__MessageBeep@4。几乎就像 VC++ 找不到这些函数的适当 ASCII 实现一样。我还应该注意，PDCurses 附带的演示程序编译得很好，尽管它们是 C 程序。

在 C++ 程序中，我使用

```
extern "C" 
{ 
    #include <curses.h> 
} 
```

我确定我忘记链接一些 C 标准库，但我不确定是哪个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T06:42:30.890

GetKeyState() 是“user32.dll”中的 Windows 函数，因此您需要确保链接到“user32.lib”。您可能还需要确保它也位于链接器库列表中的 PDCurses 库之后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T06:43:56.333

您是否使用 MS VC++ 在您的机器上构建了 PDCurses？如果是这样，我不确定发生了什么。如果不是，那么您使用的东西很有可能与 MS VC++ 不兼容。混合来自不同 C++ 编译器的代码是令人担忧的。这也取决于您所说的“其他几个错误”是什么意思。如果这是对“数百个错误”的荒谬轻描淡写，那么这可能就是问题所在。如果您只有几个（比如另外六个或更少）类似的错误，那么问题就不太可能出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T00:03:05.533

好的，我想通了；）我正在使用 scons 构建，我在 user32.lib 中包含了一个变量`USER32_LIB`，该变量默认为空字符串，但在将其定义为 user32.lib 的窗口除外。在 windows 部分，我有一个错字，我有`USER32_LIb`而不是`USER32_LIB`.

# java - Java中的综合类

> ID：399546
> 
> 赞同：147
> 
> 时间：2008-12-30T04:39:43.230
> 
> 标签：java, class, synthetic

什么是 Java 中的合成类？为什么要使用它？我该如何使用它？

* * *

## 回答 #1

> 赞同：111
> 
> 时间：2008-12-30T10:58:23.760

Java 具有在运行时创建类的能力。这些类称为合成类或动态代理。

有关详细信息，请参阅[http://java.sun.com/j2se/1.5.0/docs/guide/reflection/proxy.html](http://java.sun.com/j2se/1.5.0/docs/guide/reflection/proxy.html)。

其他开源库，例如[CGLIB](http://cglib.sourceforge.net/)和[ASM](http://asm.objectweb.org/)也允许您生成合成类，并且比 JRE 提供的库更强大。

合成类被 Spring AOP 和 AspectJ 等 AOP（面向方面​​编程）库以及 Hibernate 等 ORM 库使用。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2008-12-30T04:49:10.887

好吧，我在谷歌上找到了第一个问题的答案：

> 如果一个类是由编译器生成的，那么它可能会被标记为合成类，也就是说，它不会出现在源代码中。

这只是一个基本定义，但我在论坛帖子中找到了它并且没有解释。还在寻找更好的...

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2008-12-31T04:52:10.537

例如，当您有一个 switch 语句时，java 会创建一个以 $ 开头的变量。如果您想查看一个示例，请查看其中包含 switch 语句的类的 java 反射。当您在类中的任何位置至少有一个 switch 语句时，您将看到这些变量。

要回答您的问题，我认为您无法访问（反射除外）合成类。

如果您正在分析一个您对（通过反射）一无所知的类并且需要了解关于该类的非常具体和低级的事情，那么您最终可能会使用与合成类有关的 Java 反射方法。这里唯一的“用途”是获取有关该类的更多信息，以便在您的代码中适当地使用它。

（如果您这样做，您可能正在构建其他开发人员可以使用的某种框架。）

否则，如果您不使用反射，那么我所知道的合成类没有实际用途。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-08-11T13:52:00.340

合成类/方法/字段：

这些东西对虚拟机很重要。看看下面的代码片段：

```
class MyOuter {

  private MyInner inner;

  void createInner() {
    // The Compiler has to create a synthetic method
    // to construct a new MyInner because the constructor
    // is private.
    // --> synthetic "constructor" method
    inner = new MyInner();

    // The Compiler has to create a synthetic method
    // to doSomething on MyInner object because this
    // method is private.
    // --> synthetic "doSomething" method
    inner.doSomething();
  }

  private class MyInner {
    // the inner class holds a syntetic ref_pointer to
    // the outer "parent" class
    // --> synthetic field
    private MyInner() {
    }
    private void doSomething() {
    }
  }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-30T13:22:31.893

根据[这个讨论](http://saloon.javaranch.com/cgi-bin/ubb/ultimatebb.cgi?ubb=get_topic&f=34&t=007385)，尽管语言规范描述了类的“isSynthetic”属性，但实现几乎忽略了这一点，并且不用于动态代理或匿名类。合成字段和构造函数用于实现嵌套类（在字节码中没有嵌套类的概念，只有在源代码中）。

我认为综合类的概念被简单地证明是没有用的，即没有人关心一个类是否是综合的。对于字段和方法，它可能只用在一个地方：确定在 IDE 类结构视图中显示什么 - 您希望正常方法和字段显示在那里，而不是用于模拟嵌套类的合成方法和字段。OTOH，您确实希望匿名课程出现在那里。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-08-07T07:05:34.400

它们由 JVM 在运行时调用内部类的私有成员以进行调试时创建

JVM 在运行时为其执行目的创建的方法、字段、类称为 Synthetic

[http://www.javaworld.com/article/2073578/java-s-synthetic-methods.html](http://www.javaworld.com/article/2073578/java-s-synthetic-methods.html)

[http://javapapers.com/core-java/java-synthetic-class-method-field/](http://javapapers.com/core-java/java-synthetic-class-method-field/)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-11-22T10:53:38.260

正如各种答案已经指出的那样，允许编译器生成不直接对应于源代码中的某些内容的各种构造（包括类）。这些必须标记为合成：

[13.1\. 二进制的形式](https://docs.oracle.com/javase/specs/jls/se11/html/jls-13.html)

> 类或接口的二进制表示还必须包含以下所有内容：
> [...]
> 11\. 如果 Java 编译器发出的构造与源代码中显式或隐式声明的构造不对应，则必须将其标记为合成，除非发出的构造是类初始化方法（JVMS §2.9）。
> [...]

[正如@Holger](https://stackoverflow.com/users/2711488/holger)在对另一个问题的评论中指出的那样，此类构造的相关示例是表示方法引用和 lambda 的 Class 对象：

```
System.out.println(((Runnable) System.out::println).getClass().isSynthetic());
System.out.println(((Runnable) () -> {}).getClass().isSynthetic()); 
```

输出：

```
true
true 
```

虽然没有明确提及，但它来自 [15.27.4。Lambda 表达式的运行时评估](https://docs.oracle.com/javase/specs/jls/se11/html/jls-15.html#jls-15.27.4)：

> lambda 表达式的值是对具有以下属性的类实例的引用：[...]

以及方法参考的几乎相同的措辞（[15.13.3\. 方法参考的运行时评估](https://docs.oracle.com/javase/specs/jls/se11/html/jls-15.html#jls-15.13.3)）。

由于该类在源代码的任何地方都没有明确提及，因此它必须是合成的。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-10-23T06:26:29.843

> 什么是 Java 中的合成类？

类`synthetic`是由[Java 编译器](https://en.wikipedia.org/wiki/Java_compiler)`.class`生成的文件，它在源代码中不存在。

类的示例用法`synthetic`：**匿名内部类**

*   [java.text.DigitList$1](https://openjdk.binarydoc.org/net.java/openjdk/13.0/classfile?classfilelocation=java.text.digitlist%241)是一个类，它是[java.text.DigitList](https://openjdk.binarydoc.org/net.java/openjdk/13.0/classfile?classfilelocation=java.text.digitlist)`synthetic`内部的一个匿名内部类
*   并且没有名为 like 的源代码文件，`DigitList$1.java`但它是一个内部文件`DigitList.java`

> 为什么要使用它？

它是 Java 编译器逻辑内部生成`.class`文件的一种机制

> 我该如何使用它？

不，开发人员不**直接**使用它。

Java编译器使用`synthetic`生成`.class`文件，然后JVM读取`.class`文件执行程序逻辑。

## 更多细节

*   这篇[文章](https://binarydoc.blogspot.com/2019/10/what-is-java-synthetic-class.html)详细解释`synthetic`类
*   此[链接](https://openjdk.binarydoc.org/net.java/openjdk/13.0/classfiles?acc_synthetic)列出了[JDK](https://en.wikipedia.org/wiki/Java_Development_Kit)`synthetic`中的所有类出口

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-30T13:04:57.797

EasyMock 还使用合成类或动态代理在运行时创建接口或抽象类的实现。

[http://www.easymock.org/](http://www.easymock.org/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2014-06-17T19:35:27.770

当 Java 编译器编译某些结构（例如内部类）时，它会创建***合成结构***；这些是在源代码中没有相应构造的类、方法、字段和其他构造。
**用途：** 综合构造使 Java 编译器能够实现新的 Java 语言功能，而无需更改 JVM。但是，合成结构在不同的 Java 编译器实现之间可能会有所不同，这意味着 .class 文件也可以在不同的实现之间有所不同。
参考：[docs.oracle.com](http://docs.oracle.com/javase/tutorial/java/javaOO/nested.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-06-23T10:50:00.687

如果我猜对了，合成类是动态生成的，无需给它一个明确的名称。例如：

```
//...
Thread myThread = new Thread() {
         public void run() {
           // do something ...
         }
       };
myThread.start();
//... 
```

这将创建 Thread 的合成子类并覆盖其 run() 方法，然后实例化并启动它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-04-04T03:46:40.257

合成类不会出现在您的代码中：它是由编译器组成的。例如，Java 中的编译器组成的桥接方法通常是合成的。

```
public class Pair<T> {
    private T first;
    private T second;
    public void setSecond(T newValue) {
        second = newValue;
    }
}

public class DateInterval extends Pair<String> {
    public void setSecond(String second) {
        System.out.println("OK sub");
    }

    public static void main(String[] args) throws NoSuchFieldException, SecurityException {
        DateInterval interval = new DateInterval();
        Pair pair = interval;
        pair.setSecond("string1");
    }
} 
```

使用命令`javap -verbose DateInterval`，可以看到桥接方法：

```
public void setSecond(java.lang.Object);
flags: ACC_PUBLIC, ACC_BRIDGE, ACC_SYNTHETIC 
```

这是由编译器组成的；它不会出现在您的代码中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-02-02T16:16:54.427

综合构造是在源代码中没有相应构造的类、方法、字段等。综合构造使 Java 编译器能够在不更改 JVM 的情况下实现新的 Java 语言特性。但是，合成结构在不同的 Java 编译器实现之间可能会有所不同，这意味着 .class 文件也可以在不同的实现之间有所不同。

# java - 避免 javax.servlet.ServletException

> ID：399551
> 
> 赞同：3
> 
> 时间：2008-12-30T04:46:01.547
> 
> 标签：java, jsp, jsf

我在执行以下代码时收到 javax.servlet.servletException ......

"<%@ taglib uri="http://java.sun.com/jsf/core" 前缀="f"%>

"<%@ taglib uri="http://java.sun.com/jsf/html" 前缀="h"%>

"<%@ taglib uri="http://jakarta.apache.org/tiles" 前缀="tiles"%>

瓦片：importAttribute scope="request" />

h:panelGrid 列="2" >

```
<f:facet name="header">
    <f:subview id="header">
        <tiles:insert attribute="header" flush="false" />
    </f:subview>
</f:facet>

<f:subview id="menu">
    <tiles:insert attribute="menu" flush="false" />
</f:subview>

<f:subview id="content">
    <tiles:insert attribute="content" flush="false" />
</f:subview> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-02T21:00:38.167

您的问题似乎不是格式良好的 XML。有标签结尾，但没有开头。您确定提交问题时文本没有损坏吗？

# database - PostgreSQL 性能问题

> ID：399559
> 
> 赞同：4
> 
> 时间：2008-12-30T04:58:10.010
> 
> 标签：database, performance, postgresql

我可以在 postgresql 日志中看到某些简单的查询（没有连接并且只使用使用索引的匹配条件）需要 1 到 3 秒的时间来执行。我记录执行时间超过一秒的查询，因此有类似的查询在一秒钟内执行，但不会被报告。

当我使用 EXPLAIN ANALYZE 尝试相同的查询时，它需要几毫秒。

该表包含大约 800 万条记录，并被广泛写入和查询。我启用了自动真空，甚至最近（几个小时前）在那张桌子上运行了 VACUUM ANALYZE。

查询日志条目示例：12 月 30 日 10:14:57 db01 postgres[7400]: [20-1] LOG: duration: 3857.322 ms statement: SELECT * FROM "responses" WHERE ("responses".contest_id = 17469) AND (user_id不是 12 月 30 日 10:14:57 db01 postgres[7400]: [20-2] null) ORDER BY updated_on desc LIMIT 5

match_id 和 user_id 已编入索引。updated_on 未编入索引。如果我对它进行索引，查询计划程序将忽略竞赛 ID 索引并使用 updated_on 代替，这会进一步减慢查询速度。没有 LIMIT 的上述查询的最大条目不会超过 1000。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T05:24:58.613

更多细节在这里可能会有所帮助，具体取决于您是否可以提供它们。最有用的是 EXPLAIN ANALYZE 的实际输出，这样我们就可以看到它在完成查询时做了什么。被查询的表的定义以及索引可能也很有帮助。信息越多越好。我现在只能推测发生了什么，这里有一些盲目的刺伤：

*   许多其他 SELECT 同时在这个数据库上发生，并且数据和/或结果会定期从某处的某个缓存中过期。
*   还有其他东西会定期锁定此表 3-4 秒以上，然后再次释放它，在此期间此查询被卡住
*   该表被写入**如此**广泛，以至于表统计信息最终几乎无法反映现实，因此查询分析器在决定是否使用索引来执行查询时搞砸了。

其他人可能有其他想法，但是是的。有关正在发生的事情的更多信息可能会很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T12:00:30.220

这似乎是由于交换而发生的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-03T16:21:12.573

pgsql-performance 是一个很好的邮件列表来询问这些问题。

看来您在这里有两个问题：

1）您希望能够索引 updated_on，但如果这样做，PostgreSQL 会选择错误的计划。

我的第一个疯狂猜测是 PostgreSQL 高估了匹配谓词“ `(responses.contest_id = 17469) AND (user_id is not null)`”的元组的数量。如果 postgres 首先使用该谓词，它必须稍后对值进行排序以实现 ORDER BY。你说它匹配 1000 个元组；如果 postgresql 认为它匹配 100000，也许它认为使用 updated_on 索引按顺序扫描会更便宜。另一个因素可能是你的配置：如果`work_mem`设置得低，它可能会认为排序比它更昂贵。

您确实需要显示慢查询的 EXPLAIN ANALYZE 输出，以便我们了解为什么它可能会选择对`updated_on`.

2）即使它没有被索引，有时也需要一段时间才能执行，但你不知道为什么，因为如果你手动运行它就可以正常工作。

使用`auto_explain`8.4 新增的 contrib 模块。它允许您记录`EXPLAIN ANALYZE`耗时过长的查询的输出。只需记录查询，您就会遇到您现在遇到的问题：每次运行查询时都会很快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-03T16:37:17.610

如果完全相同的查询在解释分析中需要几毫秒，而在日志中需要 3 秒（即我假设它恰好需要 3 秒，而不是每次调用它都需要那么长时间） - 这绝对意味着它是锁定问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-30T16:19:48.527

*   锁定
*   交换
*   cron作业中的CLUSTER / VACUUM FULL
*   饱和网络
*   饱和IO

检查 iostat、vmstat、iptraf...

# sql - 如何比较一行中的重叠值？

> ID：399567
> 
> 赞同：3
> 
> 时间：2008-12-30T05:08:00.537
> 
> 标签：sql, mysql, overlap

我似乎对这个 SQL 查询有疑问：

```
SELECT * FROM appts 
WHERE timeStart >='$timeStart' 
AND timeEnd <='$timeEnd' 
AND dayappt='$boatdate' 
```

时间格式为军用时间。物流是，可以在上午 7 点至下午 1 点或上午 9 点至下午 1 点或上午 9 点至下午 5 点预订船只租赁。如果在该范围内有一个 appt，它应该返回 appts 但它已被证明是不一致的。如果我选择上午 9 点到下午 1 点，它将忽略以上午 7 点开始的应用程序，即使它与上午 9 点到下午 1 点重叠。如果我选择 9 到 5，即使它应该在上午 7 点到下午 1 点，它也不会返回任何内容。如何制作包含从 timeStart 到 timeEnd 的整个范围的 SQL 语句，包括那些重叠的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T08:40:09.750

Shahkalpesh 回答了这个问题：

> 我认为你需要一个 OR。
> 
> ```
> SELECT * FROM appts 
> WHERE (timeStart >='$timeStart' 
> OR timeEnd <='$timeEnd')
> AND dayappt='$boatdate' 
> ```

我发表了一条我认为这是错误的评论，并给出了一对反例：

> 这是完全错误的——@ShaneD 是正确的。例如，这将选择 05:00 到 06:00 之间的预订，因为实际结束时间小于您询问的任何结束时间。出于同样的原因，它还将从 18:00 开始收取租金。

在回应我的评论时，Shahkalpesh 要求：

> 您能否发布带有预期输出的数据和输入参数的单独回复？

很公平 - 是的。略微编辑，问题说：

> 逻辑是可以预订租船

*   从早上 7 点到下午 1 点，或
*   从上午 9 点到下午 1 点，或
*   从上午 9 点到下午 5 点。

> 如果在该范围内有约会，它应该返回约会，但事实证明它是不一致的。如果我选择早上 9 点到下午 1 点，...

* * *

足够的背景。我们可以忽略约会的日期，只考虑时间。我假设有一种简单的方法可以将记录的时间限制为 hh:mm 格式；并非所有 DBMS 实际上都提供了这一点，但处理 hh:mm:ss 的扩展是微不足道的。

```
Appointments

Row     timeStart   timeEnd   Note
  1     07:00       13:00     First valid range
  2     09:00       13:00     Second valid range
  3     09:00       17:00     Third valid range
  4     14:00       17:00     First plausibly valid range
  5     05:00       06:00     First probably invalid range
  6     18:00       22:30     Second probably invalid range 
```

给定搜索重叠范围 09:00 - 13:00 的约会，Shahkalpesh 的（简化）查询变为：

```
SELECT * FROM Appointments
    WHERE (timeStart >= '09:00' OR timeEnd <= '13:00') 
```

这将返回所有六行数据。但是，只有第 1、2、3 行与 09:00 - 13:00 时间段重叠。如果第 1、2 和 3 行是唯一有效的代表任命值，那么 Shahkalpesh 的查询会产生正确的答案。但是，如果允许第 4 行（我认为这似乎是有效的），则不应返回它。同样，不应返回第 5 行和第 6 行（如果存在）。[*实际上，假设* `timeStart <= timeEnd` *对于表中的所有行（并且没有 NULL 值会搞砸），我们可以看到 Shahkalpesh 的查询将返回 09:00-13:00 查询的任何数据行，因为无论是开始时间行的时间大于 09:00 或结束时间小于 13:00 或两者兼有。这相当于* `1 = 1` *WHERE 子句中的写作或任何其他重言式。*]

如果我们考虑 ShaneD 的查询（简化）：

```
SELECT * FROM Appointments
    WHERE timeStart <= '13:00' AND timeEnd >= '09:00' 
```

我们看到它也选择了第 1、2 和 3 行，但它拒绝了第 4 行（因为 timeStart > '13:00'）、第 5 行（因为 timeEnd < '09:00'）和第 6 行（因为 timeStart > '13: 00'）。这个表达式是一个典型示例，说明如何选择“重叠”的行，将“满足”和“满足”（例如，参见“[艾伦的区间代数](http://www.ics.uci.edu/%7Ealspaugh/foundations/allen.html)”）计算为重叠。更改 '>=' 和 '<=' 会更改计为重叠的间隔集。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-30T05:18:28.360

正确的检查如下所示：

```
SELECT * FROM appts 
WHERE timeStart <='$timeEnd' 
AND timeEnd >='$timeStart' 
AND dayappt='$boatdate' 
```

已经给出了其他很好的解释，但我会继续用另一种解释来更新它，说明我自己是如何形象化的。大多数人正在寻找每个可能的重叠，考虑两个时间段，他们试图考虑可以使约会重叠的开始和结束的每种组合。我认为这两个时间段何时不重叠，这对我来说更容易。

假设我正在检查的时间段是今天，我想找到今天不重叠的任何时间段。实际上只有两种情况，时间段从今天之后开始（PeriodStart > EndOfToday）或时间段在今天之前结束（PeriodEnd < StartOfToday）。

假设我们有一个不重叠的简单测试：
(PeriodStart > EndOfToday) OR (PeriodEnd < StartOfToday)

快速翻转，您可以对重叠进行简单测试：
(PeriodStart <= EndOfToday) AND (PeriodEnd >= StartOfToday)

-谢恩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T18:14:42.617

感谢 Shane、Shahkalpesh 和乔纳森。

实际上，我忽略了 Shane “交换”变量的事实（当它应该是 timeStart <= $timeEnd 时，我仍在使用 timeStart<=$timeStart）。我按照 Jonathan/Shane 的建议运行了修改后的语句，并且它有效。正如乔纳森指出的那样，我显然错过了一些我应该测试的时间范围。

现在有了乔纳森的解释，我现在可以更好地了解我的错误，这很有帮助。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2008-12-30T05:19:20.170

我认为你需要一个 OR。

```
 SELECT * FROM appts 
WHERE (timeStart >='$timeStart' 
OR timeEnd <='$timeEnd')
AND dayappt='$boatdate' 

```

假设每条记录只关心特定的一天。即租用的船不超过 1 天。

# linq-to-sql - linq2sql 缺少事件模型？

> ID：399569
> 
> 赞同：3
> 
> 时间：2008-12-30T05:09:32.170
> 
> 标签：linq-to-sql

为什么在 Dbml 中生成的“表”类不包含有用的事件，例如

OnBeforeInsert OnBeforeUpdate

OnAfterInsert 等

我错过了什么吗？

**这个问题与尝试设置时间戳列的挫败感有关。**

**更新**

我创建了以下巧妙地做到这一点的方法，大家怎么看？

```
public class Model
{
    internal virtual void OnBeforeInsert()
    {
    }
    internal virtual void OnBeforeUpdate()
    {
    }
}

public partial class DbDataContext
{
    public override void SubmitChanges(System.Data.Linq.ConflictMode failureMode)
    {
        foreach (var insert in this.GetChangeSet().Inserts)
        {
            if (insert is Model)
            {
                ((Model)insert).OnBeforeInsert();
            }
        }

        foreach (var update in this.GetChangeSet().Updates)
        {
            if (update is Model)
            {
                ((Model)update).OnBeforeUpdate();
            }
        }

        base.SubmitChanges(failureMode);
    }
}

public partial class Address : Model
{
    internal override void OnBeforeInsert()
    {
        var created = DateTime.Now;
        this._Modified = created;
        this._Created = created;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T16:33:41.820

我最近有一个类似的问题。

为“OnValidate”生成的类中有一个部分方法。简单地在您的部分中声明该方法将强制调用它（vb.net 不支持像 c# 这样的部分方法）或在 c# 中简单地声明一个部分方法。

该方法被传递一个 System.Data.Linq.ChangeAction 枚举，它是：Delete、Insert、Update 或 None。

以下是您使用内置部分方法所做的示例。

```
public partial class Address
{

    private partial void OnValidate(System.Data.Linq.ChangeAction action)
    {
       if (action == System.Data.Linq.ChangeAction.Insert)
       {
           var created = DateTime.Now;
           this._Modified = created;
           this._Created = created;
       } else if (action == System.Data.Linq.ChangeAction.Update) {
           this._Modified = DateTime.Now;
       }
    }

} 
```

# javascript - 如何在 Silverlight 中附加到 ScriptObject 上的事件？

> ID：399572
> 
> 赞同：3
> 
> 时间：2008-12-30T05:11:51.417
> 
> 标签：javascript, silverlight, xaml, scripting

HtmlObject 提供了为脚本和 DOM 事件注册托管事件处理程序的所有必要功能，但是如果您需要侦听的类不作为 DOM 元素存在，而是作为脚本变量（通过 ScriptObject 引用）存在怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T12:40:12.837

javascript 对象不支持附加事件的概念。然而，它可能支持持有对函数的引用的属性的概念，如果分配将在某个点调用该函数。

我想你有这样的对象吗？

如果是这样，您使用 ScriptObject SetProperty 方法，该方法使用属性名称，该属性应包含对函数的引用，并且托管方法的委托与 Javascript 对象将调用的签名匹配。

*警告*以下内容目前未经测试，但应该让您走上正确的道路。

```
//Javascript in web page.
var myObj = new Thing();

function Thing()
{
     this.doStuff = function()
     {
         if (this.onstuff) this.onstuff("Hello World");
     }
}

// C# code in a Silverlight app.

class SomeClass
{
    private ScriptObject myObject;
    public SomeClass(ScriptObject theObject)
    {
         myObject = theObject;
         myObject.SetProperty("onstuff", (Action<string>)onstuff);
    } 

    function void onstuff(string message)
    {
         //Do something with message
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-15T16:04:50.513

正如 AnthonyWJones 所说，Silverlight 不能附加到 JavaScript 事件。在这种情况下，正确的做法是执行以下操作：

在 Silverlight 中启用脚本访问：

1.  用 ScriptableType 属性标记类，或者用 ScriptableMember 标记具体方法
2.  在构造函数中调用 HtmlPage.RegisterScriptableObject。

在 Silverlight 代码中设置好所有内容后，您可以在 JavaScript 中执行以下操作：

1.  获取对 JavaScript 对象的引用并注册事件处理程序
2.  使用 document.getElementById 获取 Silverlight 控件
3.  在 JavaScript 事件处理程序中调用 .Content..。例如，silverlight.Content.Page.UpdateText(text)。

所以基本上，所有事件处理都是在 JavaScript 中执行的，但 JavaScript 事件处理程序可用于调用 Silverlight 中的函数。

# jsp - Grails renders JSP as blank page

> ID：399582
> 
> 赞同：1
> 
> 时间：2008-12-30T05:21:56.437
> 
> 标签：jsp, grails

I have a Grails application with a JSP page (I'm porting a legacy JSP application). For some reason, the page renders completely blank. Looking at the HTTP headers I see it's 200 with a content length of 0.

```
HTTP/1.1 200 OK
Content-Language: en-US
Content-Type: text/html; charset=iso-8859-1
Expires: Thu, 01 Jan 1970 00:00:00 GMT
Set-Cookie: JSESSIONID=1sh9r73vqvukj;Path=/myGrailsApp
Content-Length: 0
Server: Jetty(6.1.12) 
```

The page is a combination of HTML, tags (`${property}`), JSP includes (`<jsp:include>`), and short code snippets (`<% code %>`, yes I know this is a bad idea). There is nothing in the log file or console that indicates an error. Is Grails somehow silently hiding an exception or error?

Edit: The problem is related to the JSP `<jsp:include/>` include tag. If I remove all JSP includes then Grails will render. Is Grails compatible with JSP? Since JSP functionality is provided by the web application (Jetty, Tomcat) I would think yes.

Edit: This occurs with Grails 1.0.4 and 1.1 beta 2 (1.1 claims to have added JSP support)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T14:14:25.003

是的，Grails 与 JSP 兼容。

完全空白？因此，如果您“显示来源”，您将一无所获？

如果您是 IntelliJ 用户，您可以安装 Grails 插件、设置断点并单步执行代码以查看发生了什么。

我要检查的其他内容是版本和 JSTL 标准。这些变化取决于您使用的 servlet/JSP 引擎的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-09T12:23:14.880

显然，此时您已经解决了您的问题，但此解决方案适用于其他人。

今天我遇到了同样的问题：

这是来自`main.gsp`(LAYOUT)的代码部分

```
<head>
    <g:layoutTitle default="Grails" />
    <g:layoutHead />
    <g:javascript src="jquery-1.6.1.min.js" />
</head> 
```

这是我的`index.gsp`

```
<head>
    <title>${title}</title>
    <meta name="layout" content="main" />
</head> 
```

我正在做的是通过动态构造`title`和`index.gsp`使用 layout传递`main`。`title`是 html`head`标签的必需属性。所以错误地，我将标题作为`null`价值传递。它没有显示预期的页面。

所以解决方案是：

*   如果您需要静态标题，请不要`title`在 gsp 文件中使用标签。在上述情况下，它将`Grails`默认用作标题。
*   如果您需要动态标题，请确保它不是`null`价值。

您可能有不同的问题，但这也可能导致空白页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T15:31:37.297

听起来您没有正确部署标签库。我们需要知道您正在使用的应用服务器才能进一步为您提供帮助。

编辑：另一个想法 - 也许包含标签正在工作，但包含的内容存在编译错误。您是否尝试过仅返回包含的内容？

# c# - 使用指令进行组织

> ID：399594
> 
> 赞同：6
> 
> 时间：2008-12-30T05:44:53.190
> 
> 标签：c#, coding-style, using-directives

在过去的几个月里，我一直在使用 ReSharper，除了广告，没有它我就无法看到自己的编码。由于我喜欢生活在流血的“到底出了什么问题”的边缘，我决定用最新的 ReSharper 4.5 nightly builds 试试我的运气。这一切都很好。

但是，我注意到 using 指令分组格式发生了变化，我想知道哪个更接近一般标准：

[老的]

```
#region Using directives
using System.X;
using System.Y;
using System.Z;
using System.A;
#region
namespace X { ... } 
```

[新的]

```
namespace X {
#region Using directives
using System.X;
using System.Y;
using System.Z;
using System.A;
#region
...
} 
```

除了延迟加载引用之外，它还有什么特殊用途吗？（一直在阅读 Scott Hanselman 对此的看法@http [://www.hanselman.com/blog/BackToBasicsDoNamespaceUsingDirectivesAffectAssemblyLoading.aspx](http://www.hanselman.com/blog/BackToBasicsDoNamespaceUsingDirectivesAffectAssemblyLoading.aspx)）

谢谢;

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-30T06:01:11.020

正如 Scott 在他的帖子中继续发现的那样，这两种情况之间**没有运行时差异。**因此，它**不能**达到延迟加载引用的目的。

如果你把Scott博客的评论一直读到最后，你还会看到把这个谣言传给Scott（Mike Brown）的开发者说他只是听说过这个，没有亲自测试过。

也就是说，如果您在命名空间中为类型设置别名，并且您在命名空间中定义了另一个具有相同名称的类型，那么您放置 using 指令的位置可能会产生差异，从而导致*编译*器错误*。*但这当然不是运行时差异。

最后，我相信 MS 编码指南说要像 ReSharper 4.5 那样做。但是盲目地遵循这条规则是愚蠢的，“因为 MS 这么说”，因为

1.  事实证明，它没有任何好处。
2.  您的团队（或您的）通常的编码风格很可能会有所不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T06:11:40.610

好吧，通常是主观的。:) 但对我来说，通常是“旧”的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T06:05:02.853

哦，我的坏。当我搜索它时，我没有看到这个问题。我知道这样做很愚蠢，因为 MS 这么说，但总的来说，“通常”的方法是什么？

众所周知，我经常使用 ReSharper 的代码清理，所以老实说，我只是想知道。

# apache-flex - Flex：有什么方法可以查明 ComboBox 何时打开？

> ID：399595
> 
> 赞同：4
> 
> 时间：2008-12-30T05:45:23.207
> 
> 标签：apache-flex, actionscript-3

我可能在这里遗漏了一些东西，因为我认为这可能真的很容易，但是......

使用 Flex，如何判断 ComboBox 何时打开？我确实发现这个组件调度的打开和关闭事件可能是不稳定的，所以我正在寻找更可靠的东西——它可能正盯着我看。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T15:13:39.737

如何检查下拉组件的存在或可见性？

dropDown 是 ListBase 类型的组件，可以通过`dropDown`属性访问。所以也许是这样的（我没有时间自己测试）：

```
if (myComboBox.dropDown != null && myComboBox.dropDown.visible) {
    // myComboBox is open
} 
```

这是一项安全检查，因此您在尝试访问空对象`myComboBox.dropDown != null`的属性时不会遇到运行时错误。`visible`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T09:22:54.437

设计师们可能认为打开和关闭事件就足够了。

编辑：我会澄清这一点。寻找可以显示组合框打开/关闭状态的属性，但我找不到它。根据我的经验，事件系统没有任何问题。

# hardware - 开发机器的硬件要求

> ID：399605
> 
> 赞同：7
> 
> 时间：2008-12-30T05:57:56.737
> 
> 标签：hardware, development-environment, cpu

鉴于：

*   SSD现在是[高端]主流
*   两个+核心不难遇到
*   24+英寸显示器很丰富
*   双视频输出是常态。
*   64 位操作系统的补充非常便宜的内存

我可以向热衷于硬件的开发人员（而不是游戏玩家）问两个问题吗？

1.  没有什么你不能开发的高端硬件产品——[你的硬件拐杖是什么]？

2.  基线 [简洁] 开发机器应该是什么样的？它应该具备哪些基本规格才能确保任何开发人员仍然可以高效工作？

*注意：可能值得一提的是您的基准线适用于什么平台和开发环境？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T06:13:54.943

最重要的硬件更新（也是最被低估的）是显示器。

如果您每天编码 8 小时以上，请不要犹豫成本，并至少获得一个不错的高端 24 英寸，甚至是一对。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T06:09:42.407

绝对必须有一个很好的显示器，它很舒服，毕竟你整天盯着它看。我用的是 24 英寸三星（忘记型号）。我以前用两台显示器，但现在更喜欢一个宽屏幕。你需要能够在同一个屏幕上获取文档和代码。

其次是一把好的椅子和桌子（抱歉不是很技术）。

最后是大量 RAM（最低 2Gb）。一旦你克服了因分页而导致的任何颠簸，你就没事了。任何具有双核的东西都有足够的处理能力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-01T04:48:48.013

这完全取决于您的开发目的。获取您的目标系统要求，并将它们加倍并将其用作开发机器的最低规格。这可能看起来很奇怪，但这是我发现至少在开发各种项目时需要的一点。

正如其他人提到的那样，获得好的显示器、键盘和椅子的重要性被低估了。如果您要在这台 PC 上花费大量时间，那么这些非常重要。

RAM 很便宜，而且您可能永远不会有足够的内存。如果您运行的是 32 位 Windows，则将其最大化为 4GB 的 RAM。如果您使用的其他操作系统支持超过 4GB 的内存（例如 Linux 或 64 位 Windows），则从最低 8GB 开始，如果您正在处理多媒体项目，请准备好从那里升级。

现在，CPU 的最佳性价比似乎是四核，所以我想说至少四核（2.4Ghz 左右）应该是最低要求。直到双四核之前，您可能看不到太多差异，这是一个很大的价格跳跃。

找一两个可靠的硬盘。可靠性和速度将比尺寸更重要。就个人而言，我目前在我制造的所有机器中都选择一对 640GB 的西方数字驱动器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-30T06:04:07.037

1.  24 英寸或更大的显示器
2.  基准开发机器是 15 英寸 MacBook Pro，配备 4GB 内存。（用于网络开发）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T08:16:24.460

一对最快的硬盘可用。我从来没有意识到单独和快速的系统和数据驱动器可以带来多大的不同。

（请注意，现在您通常在不到 2000 美元的笔记本电脑中获得的那些慢速 SSD 都没有——如果您真的想跳上 SSD 火车，请买一个合适的，否则您也可以使用 32 GB SDHC 卡）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T11:04:07.993

犹他大学 [华尔街期刊文章](http://blogs.wsj.com/biztech/2008/03/10/bigger-computer-monitors-more-productivity/)对电脑显示器的最佳尺寸进行了研究。毫不奇怪，更大的显示器将提高工作速度。令人惊讶的是，似乎最佳尺寸为 26"。但没有解释为什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-30T08:09:34.897

我不是开发人员，但确实整天坐在电脑前。
对我来说，必须有一张高度合适或易于调整的桌子，我更喜欢双显示器、一个 26 英寸和第二个宽屏幕，可以横向转动以查看完整长度的文档，而无需大量滚动，一台电脑双核（首选 4）和东 4gb 内存（我倾向于做很多虚拟机工作），如上所述，一把好椅子有腰部支撑，当我阅读或思考时可以让我向后靠一种情况。最后一个对我来说是特定的，因为我戴眼镜并且倾向于听到高频，我更喜欢光谱略暖的白炽灯。我可以听到有人在播放扬声器上方的荧光镇流器。我也发现我得到了更少的眩光，我可以用白炽灯长时间聚焦我的眼睛。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-30T09:47:15.667

公羊，很多很多的公羊。Ram 弥补了许多性能瓶颈。

但是请确保您密切关注您正在构建的任何内容的内存使用情况。当您在运行时加载 2 gig 开发人员工具的系统上构建一个 60 MB 占用空间的应用程序时，很容易在噪音中丢失该占用空间，即使它加倍。

不要费心购买高端cpu。cpu 是现代系统中功能最强大的组件。一个标准的廉价双核应该绰绰有余。编译往往是受磁盘限制的，而不是受 CPU 限制的，因此最好将钱投资于更快的驱动器。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-30T10:02:57.117

戴尔奥特莱斯以大约 800.00 美元的价格出售 30 英寸 LCD 显示器。这是一个很好的起点。除此之外，花时间调整您的操作系统以满足您的需求并尽可能地实现自动化。

就像我一直在告诉人们，“当它设法帮助我运行更多终端窗口和文本编辑器时，我会升级到最新的 Mac。” 在那之前，你最好把钱存起来买一台新机器，然后把它投资到一个像样的显示器和键盘上。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-30T10:20:58.610

这取决于项目。

对于像医学成像应用程序这样的大型成像应用程序，您可能需要：**大型显示器**（我们必须正确详细地查看图像）、**强大的图形、大量 RAM 和良好的处理器**（成像应用程序通常需要大量功率）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-30T10:58:43.683

我将在大显示器部分回应大多数人，你总是可以很好地使用一对。

其次是一个好的键盘。这意味着什么取决于您订阅的键盘设计学校。我参加了人体工学训练营。

接下来是 2Gb+ 的 RAM，以及最近的桌面 CPU（实际上是在过去 2-3 年内发布的任何东西）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-30T11:09:32.257

如前所述，大型显示器是必不可少的。如今，将 2 个连接到一台机器上并没有那么昂贵。在工作中，我很幸运能够将 3 台 PC 连接到一台 PC，这对我的工作方式产生了巨大的影响。

一个像样的键盘和鼠标是必不可少的。在过去 10 年左右的时间里，我一直使用自己的鼠标和键盘来工作，因为您通常最终会使用来自 PC 制造商的任何东西。我使用的是 Microsoft 人体工学键盘，在工作场所很难找到这些键盘，或者让你的雇主为一个键盘挺身而出，但我从来没有在雇主对你自己有问题的任何地方工作过。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-01-01T00:21:53.700

**我离不开**的高端硬件：

*   [Kinesis countoured 人体工学键盘](http://www.kinesis-ergo.com/contoured.htm)（300 美元）

    2.  快速双 SATA 驱动器，条带化以提高速度（150 美元）

我可以不用的负担得起的奢侈品：

*   戴尔 30 英寸宽屏显示器（900 美元）

    4.  Twin Velociraptor 硬盘（600 美元）

# mercurial - Mercurial：检测到合并冲突时不显示编辑器

> ID：399606
> 
> 赞同：3
> 
> 时间：2008-12-30T05:58:14.180
> 
> 标签：mercurial

我想知道这里是否有人对在 Ubuntu 上运行 mercurial 有任何经验？我整个早上都在玩它，并且喜欢到目前为止我所看到的一切。

我遇到的一个问题是，当我进行合并并检测到冲突时，它不会自动在命令行编辑器中打开文件以允许我解决冲突。它只是告诉我有冲突，然后由我来打开编辑器并解决它。

但这很奇怪，因为文档显示当发生合并冲突时编辑器会自动启动。我知道编辑器（nano）一般来说不是问题，因为它在我进行提交并且必须添加评论时起作用。

有任何想法吗？

克里斯

ps 我已经尝试过 mercurial IRC 频道，但是没有声音....

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T06:28:22.900

您可能需要在 ~/.hgrc 中定义合并工具：

```
[ui]
merge = vimdiff 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T06:23:14.127

你正在使用什么命令，你的 ~/.hgrc 是什么样的？如果您使用 fetch 扩展，它应该在检测到冲突时打开配置的合并工具。

[不久前，我在一篇博客文章](http://naleid.com/blog/2008/11/25/my-mercurial-setup-plus-some-useful-shims-and-jigs/)中详细介绍了我的完整 mercurial 配置，其中我使用 kdiff3 作为我的合并工具。

当执行“hg fetch”或“hg merge”（检测到冲突后）时，它会按照您的预期启动 kdiff3 并让我解决合并问题。

# cocoa - 如何在 Mac OS X 下捕获/发布系统范围的键盘/鼠标事件？

> ID：399616
> 
> 赞同：5
> 
> 时间：2008-12-30T06:04:54.790
> 
> 标签：cocoa, macos

对于脚本实用程序，我需要能够记录应用程序获得焦点时发生的一系列键盘和鼠标事件。第二部分是能够稍后将这些事件发送到活动窗口。

我不需要担心菜单或跟踪哪个窗口接收输入的标识符。

我知道如何在 Windows 下执行此操作，但不知道 Mac OS X。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-30T19:38:40.293

我要告诉您的第一件事是，如果用户在可访问性控制面板中启用对辅助设备的支持，您将无法执行此操作*。*这是 OSX 内置的某种安全性。

这是我在我的一个应用程序中使用的代码片段：

```
//this method calls a carbon method to attach a global event handler
- (void)attachEventHandlers
{
    //create our event type spec for the keyup
    EventTypeSpec eventType;
    eventType.eventClass = kEventClassKeyboard;
    eventType.eventKind = kEventRawKeyUp;

    //create a callback for our event to fire in
    EventHandlerUPP handlerFunction = NewEventHandlerUPP(globalKeyPress);

    //install the event handler
    OSStatus err = InstallEventHandler(GetEventMonitorTarget(), handlerFunction, 1, &eventType, self, NULL);

    //error checking
    if( err )
    {
        //TODO: need an alert sheet here
        NSLog(@"Error registering keyboard handler...%d", err);
    }

    //create our event type spec for the mouse events
    EventTypeSpec eventTypeM;
    eventTypeM.eventClass = kEventClassMouse;
    eventTypeM.eventKind = kEventMouseUp;

    //create a callback for our event to fire in
    EventHandlerUPP handlerFunctionM = NewEventHandlerUPP(globalMousePress);

    //install the event handler
    OSStatus errM = InstallEventHandler(GetEventMonitorTarget(), handlerFunctionM, 1, &eventTypeM, self, NULL);

    //error checking
    if( errM )
    {
        //TODO: need an alert sheet here
        NSLog(@"Error registering mouse handler...%d", err);
    }
} 
```

这是我正在使用的回调方法的示例：

```
OSStatus globalKeyPress(EventHandlerCallRef nextHandler, EventRef theEvent, void *userData) 
{
    NSEvent *anEvent = [NSEvent eventWithEventRef:theEvent];
    NSEventType type = [anEvent type];
    WarStrokerApplication *application = (WarStrokerApplication*)userData;

    //is it a key up event?
    if( type == NSKeyUp)
    {
        //which key is it?
        switch( [anEvent keyCode] )
        {
            case NUMERIC_KEYPAD_PLUS: 
                //this is the character we are using for our toggle
                //call the handler function
                [application toggleKeyPressed];
                break;

                //Comment this line back in to figure out the keykode for a particular character                
            default:
                NSLog(@"Keypressed: %d, **%@**", [anEvent keyCode], [anEvent characters]);
                break;
        }
    }

    return CallNextEventHandler(nextHandler, theEvent);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T06:25:35.497

对于后一部分，发布事件，使用 ApplicationServices/ApplicationServices.h 中提供的 CGEvent 方法

这是一个将鼠标移动到指定绝对位置的示例函数：

```
#include <ApplicationServices/ApplicationServices.h>

int to(int x, int y)
{
    CGPoint newloc;
    CGEventRef eventRef;
    newloc.x = x;
    newloc.y = y;

    eventRef = CGEventCreateMouseEvent(NULL, kCGEventMouseMoved, newloc,
                                        kCGMouseButtonCenter);
    //Apparently, a bug in xcode requires this next line
    CGEventSetType(eventRef, kCGEventMouseMoved);
    CGEventPost(kCGSessionEventTap, eventRef);
    CFRelease(eventRef);

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T06:18:00.223

关于点击鼠标事件，请参见[http://osxbook.com/book/bonus/chapter2/altermouse/](http://osxbook.com/book/bonus/chapter2/altermouse/)

我没有在 10.5 Leopard 下检查过这个，但在 10.4 上它可以工作。

# artificial-intelligence - 什么是模糊逻辑？

> ID：399618
> 
> 赞同：43
> 
> 时间：2008-12-30T06:05:18.250
> 
> 标签：artificial-intelligence, logic, theory, definition, fuzzy-logic

我在学校使用了几种人工智能算法，我发现人们使用模糊逻辑这个词来解释他们可以通过几个案例解决的任何情况。当我回到书上时，我刚刚读到关于如何而不是从开到关的状态，它是一条对角线，并且某些东西可以同时处于两种状态但处于不同的“级别”。

我已经阅读了维基百科条目和一些教程，甚至是“使用模糊逻辑”的编程内容（边缘检测器和单轮自控机器人），但我仍然觉得从理论到代码非常混乱。 . 对你来说，在不太复杂的定义中，什么是模糊逻辑？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2008-12-30T06:21:56.517

模糊逻辑是一种逻辑，其中状态成员本质上是一个范围为 0..1 而不是 int 0 或 1 的浮点数。您从中获得的里程是诸如您在控制系统中所做的更改之类的东西比你用幼稚的二进制逻辑得到的更自然地微调。

一个示例可能是基于活动 TCP 连接限制系统活动的逻辑。假设您将计算机上“有点太多”的 TCP 连接定义为 1000，将“太多”定义为 2000。在任何给定时间，您的系统从 0 (<= 1000) 开始处于“太多 TCP 连接”状态到 1 (>= 2000)，您可以将其用作应用任何可用节流机制的系数。与只知道如何确定“太多”、完全节流或“不太多”、根本不节流的幼稚二进制逻辑相比，这更加宽容和响应系统行为。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-12-30T08:29:15.667

我想补充一下答案（已修改），可视化模糊逻辑的好方法如下：

传统上，使用二元逻辑，您将拥有一个隶属函数为真或假的图，而在模糊逻辑系统中，隶属函数不是。

```
1|
 | /\
 | / \
 | / \
0|/\
 ------------
   A B C D

```

假设函数是“喜欢花生”

```
一种。有点喜欢花生
湾。真的很喜欢花生
C。有点喜欢花生
d。不喜欢花生

```

函数本身不必是三角形的，通常也不是（使用 ascii 艺术更容易）。

一个模糊*系统*可能会有很多这样的，有些甚至重叠（甚至相反），如下所示：

```
1| AB
 | /\ /\ A = 喜欢花生
 | / \/ \ B = 不喜欢花生
 | / /\ \
0|/ / \ \
 ------------
  A B C D

```

所以现在 c 是“有点喜欢花生，有点不喜欢花生”，而 d 是“真的不喜欢花生”

您可以根据该信息进行相应的编程。

希望这对那里的视觉学习者有所帮助。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-10-25T20:31:21.990

模糊逻辑的最佳定义由其发明者*Lotfi Zadeh*给出：

> “模糊逻辑以类似于人类解决问题的方式向计算机表示问题的方式，而模糊逻辑的本质是一切都是程度问题。”</p>

用一个篮球比赛中的简单例子可以很容易地解释用计算机解决问题类似于人类解决问题的意义；如果一个球员想要防守另一个球员，首先他应该考虑他的身高和他的比赛技巧。简单来说，如果他想要防守的球员个子很高，并且相对于他来说打得非常慢，那么他会用他的直觉来决定是否应该防守那个球员，因为对他来说存在不确定性。在这个例子中，重要的一点是属性是相对于玩家的，并且对于对手玩家的身高和演奏技巧有一定程度的影响。模糊逻辑为这种不确定的情况提供了一种确定性的方法。

有一些步骤可以处理模糊逻辑（图 1）。这些步骤是；首先是模糊化，其中清晰的输入被转换为模糊输入，其次这些输入通过模糊规则处理以创建模糊输出，最后是去模糊化，其结果是结果的程度，因为在模糊逻辑中，可能有多个不同程度的结果。

![image004](https://i.stack.imgur.com/ZbdwO.gif)

*图 1 – 模糊过程步骤 (David M. Bourg P.192)*

为了举例说明模糊处理步骤，可以使用之前的篮球比赛情况。正如示例中提到的，对手球员身高 1.87 米，相对于我们的球员来说相当高，并且可以以 3 m/s 的速度运球，相对于我们的球员来说是慢的。除了这些数据之外，还需要考虑一些称为模糊规则的规则，例如：

```
if player is short but not fast then guard,
if player is fast but not short then don’t guard
If player is tall then don’t guard
If player is average tall and average fast guard 
```

![image005](https://i.stack.imgur.com/qrXee.png)

*图 2 – 多高*

![image007](https://i.stack.imgur.com/pyjhr.png)

*图 3 - 多快*

根据规则和输入数据，将通过模糊系统创建输出，例如：守卫的度数是 0.7，有时守卫的度数是 0.4，从不守卫的度数是 0.2。

![image009](https://i.stack.imgur.com/TovPD.png)

*图4-输出模糊集*

最后一步，去*模糊*化，用于创建一个清晰的输出，这个数字可以决定我们在游戏中应该用来保护玩家的能量。质心是创建输出的常用方法。在这个阶段，计算平均点的权重完全取决于实现。在这个应用程序中，它被认为给后卫或不后卫赋予高权重，但有时对后卫给予低权重。 *（大卫·M·博格，2004 年）*

![image012](https://i.stack.imgur.com/ZPVAP.gif)

*图 5- 模糊输出 (David M. Bourg P.204)*

```
 Output = [0.7 * (-10) + 0.4 * 1 + 0.2 * 10] / (0.7 + 0.4 + 0.2) ≈ -3.5 
```

因此，模糊逻辑是在不确定性下使用来做出决策并找出决策的程度。模糊逻辑的问题是随着输入数量的增加规则的数量呈指数增长。

有关更多信息及其在游戏中的可能应用，我写了一篇小文章[，请查看](http://www.hevi.info/tag/fuzzy-logic/)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-30T06:54:12.397

为了建立混乱的答案，形式逻辑只不过是一个归纳定义的集合，将句子映射到估值。至少，模型理论家是这样看待逻辑的。在句子布尔逻辑的情况下：

```
 (basis clause) For all A, v(A) in {0,1}
 (iterative) For the following connectives,
   v(!A) = 1 - v(A)
   v(A & B) = min{v(A), v(B)}
   v(A | B) = max{v(A), v(B)}
 (closure) All sentences in a boolean sentential logic are evaluated per above. 
```

可以归纳定义模糊逻辑变化：

```
 (basis clause) For all A, v(A) between [0,1]
 (iterative) For the following connectives,
   v(!A) = 1 - v(A)
   v(A & B) = min{v(A), v(B)}
   v(A | B) = max{v(A), v(B)}
 (closure) All sentences in a fuzzy sentential logic are evaluated per above. 
```

请注意，底层逻辑的唯一区别是允许将句子评估为具有 0.5 的“真值”。模糊逻辑模型的一个重要问题是衡量真实满意度的阈值。这是要问：对于估值 v(A)，对于什么值 D，如果 v(A) > D 表示满足 A。

如果您真的想了解更多关于模糊逻辑等非经典逻辑的信息，我会推荐[*非经典逻辑简介：从如果到是*](https://rads.stackoverflow.com/amzn/click/com/0521854334)或[*可能性与悖论*](https://rads.stackoverflow.com/amzn/click/com/0199259879)

戴上我的编码器帽子，我会小心在现实世界的编程中使用模糊逻辑，因为模糊逻辑倾向于不可判定。也许它太复杂而收效甚微。例如，超值逻辑可以很好地帮助程序模型模糊。或者也许概率就足够了。简而言之，我需要确信域模型与模糊逻辑相吻合。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-30T06:23:56.793

也许一个例子可以说明好处是什么：

假设您想制作一个恒温器，并且您希望它是 24 度。

* * *

这是您使用布尔逻辑实现它的方式：

*   规则 1：当温度低于 21 度时，以全功率加热。
*   规则 2：当温度高于 27 度时，以全功率冷却。

这样的系统只会偶尔出现 24 度，而且效率非常低。

* * *

现在，使用模糊逻辑，它会像这样：

*   规则 1：每低于 24 度，将加热器调高一个档位（0 到 24 度）。
*   规则 2：每高于 24 度，将较冷的温度调高一个档位（0 到 24 度）。

该系统将始终在 24 度左右，并且只会进行一次并且只会偶尔进行微小的调整。它也将更加节能。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-30T06:20:32.497

好吧，您可以阅读“开国元勋”之一的巴特·科斯科（ [Bart Kosko ）的作品。](http://sipi.usc.edu/~kosko/)1994 年的“[模糊思维：模糊逻辑的新科学](https://rads.stackoverflow.com/amzn/click/com/078688021X)”是可读的（并且可以通过亚马逊以相当便宜的价格二手获得）。显然，他有一本 2006 年的新书《[噪音](https://rads.stackoverflow.com/amzn/click/com/0670034959)》，也很平易近人。

基本上，虽然（在我的解释中——已经好几年没有读过这些书的第一本了），模糊逻辑是关于如何处理可能有 10% 凉爽、50% 温暖和 10% 热的世界，其中不同的地方可以根据不同状态的真实程度做出决定（不，这些百分比加起来不等于 100% 并非完全偶然——尽管如果需要我会接受更正）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-30T07:25:53.317

一个很好的解释，在[Fuzzy Logic Washing Machines](http://mathematica.ludibunda.ch/fuzzy-logic6.html)的帮助下。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-30T06:44:43.820

我知道你的意思是从概念到代码很难。我正在编写一个评分系统，它查看 Linux 系统上 sysinfo 和 /proc 的值，并得出一个介于 0 和 10 之间的数字，10 绝对是最差的。一个简单的例子：

您有 3 个平均负载（1、5、15 分钟），具有（至少）三种可能的状态，好、变坏、坏。扩展它，您平均可以有六个可能的状态，在我刚刚提到的三个状态中添加“即将到”。然而，所有 18 种可能性的结果只能从分数中减去 1。重复使用交换消耗、实际 VM 分配（提交）内存和其他东西......你有一大碗条件意大利面:)

它既是一门艺术，也是一种定义，你如何实现决策过程总是比范式本身更有趣......而在布尔世界中，它相当简单。

如果 load1 < 2 减去 1 对我来说很容易说，但根本不是很准确。

如果您可以教程序在评估某些情况时执行您会执行的操作并保持代码可读性，那么您已经实现了一个很好的模糊逻辑示例。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-07-04T20:27:40.417

模糊逻辑是一种解决问题的方法，适用于从简单、小型、嵌入式微控制器到大型、联网、多通道 PC 或基于工作站的数据采集和控制系统的系统。它可以用硬件、软件或两者的组合来实现。模糊逻辑提供了一种基于模糊、模棱两可、不精确、嘈杂或缺失的输入信息得出明确结论的简单方法。控制问题的模糊逻辑方法模仿了一个人如何做出决定，只是速度要快得多。

模糊逻辑已被证明在专家系统和其他人工智能应用中特别有用。它还用于一些拼写检查器，以建议一个可能的单词列表来替换拼写错误的单词。

要了解更多信息，请查看：[http](http://en.wikipedia.org/wiki/Fuzzy_logic) ://en.wikipedia.org/wiki/Fuzzy_logic 。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-30T06:21:43.150

以下是一种经验性的答案。

一个简单的（可能是简单的答案）是“模糊逻辑”是任何返回除真/假或 1 / 0 以外的值的逻辑。对此有很多变体，它们往往是高度特定于域的。

例如，在我以前的生活中，我做过使用“内容相似性搜索”而不是当时常见的“布尔搜索”的搜索引擎。我们的相似性系统使用了表示查询和文档的加权属性向量的余弦系数，并产生了 0..1 范围内的值。用户将提供“相关反馈”，用于将查询向量向所需文档的方向移动。这与在某些 AI 系统中进行的训练有些相关，在这些系统中，逻辑会因试运行的结果而得到“奖励”或“惩罚”。

目前，Netflix 正在举办一场比赛，为他们的公司寻找更好的建议算法。请参阅[http://www.netflixprize.com/](http://www.netflixprize.com/)。实际上，所有算法都可以被描述为“模糊逻辑”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-01-28T11:52:39.323

模糊逻辑是基于人类思维方式的计算算法。当有大量输入变量时，它特别有用。给出了一个用于两个变量输入的在线模糊逻辑计算器：

[http://www.cirvirlab.com/simulation/fuzzy_logic_calculator.php](http://www.cirvirlab.com/simulation/fuzzy_logic_calculator.php)

# c# - 对于 C#/.NET，是否有相当于 Perl 的 URI.pm？

> ID：399633
> 
> 赞同：2
> 
> 时间：2008-12-30T06:21:39.623
> 
> 标签：c#, .net, perl, uri

.NET 有[Uri 类](http://msdn.microsoft.com/en-us/library/system.uri_members.aspx)。

Perl 有它的[URI 模块](http://search.cpan.org/dist/URI)。

主要区别在于 URI.pm 允许您**将查询字符串组件作为散列检索**，并**在 URI 中设置散列以构造带有查询参数的好 URI**。我在.NET 方面看不到类似的东西。是否有一些我不知道的隐藏课程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T07:02:15.110

另一个用于解析查询字符串的实用程序：[System.Web.HttpUtility.ParseQueryString()](http://msdn.microsoft.com/en-us/library/system.web.httputility.parsequerystring.aspx) - 将查询字符串解析为 NameValueCollection。

[来自HttpUtility 文档](http://msdn.microsoft.com/en-us/library/system.web.httputility.aspx)的示例：

```
String querystring;
...
// Parse the query string variables into a NameValueCollection.
NameValueCollection qscoll = HttpUtility.ParseQueryString(querystring);

// Iterate through the collection.
StringBuilder sb = new StringBuilder();
foreach (String s in qscoll.AllKeys)
{
    sb.Append(s + " - " + qscoll[s] + "<br />");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-08T05:10:09.360

答案显然是“不”。.NET 框架中没有内置类可以获取名称和值的集合并生成查询字符串，或者允许您直接修改 URI 的查询字符串组件，就好像它是一个集合一样。

# javascript - AJAX页面下载进度

> ID：399641
> 
> 赞同：27
> 
> 时间：2008-12-30T06:26:09.520
> 
> 标签：javascript, ajax, jquery

我想获得我的 AJAX 请求的进度 - 到目前为止已经下载了多少文件。例如，我正在使用 AJAX 下载一张大图片，因此我可以将内容放在 DATA url 中（这可能不是最好的方法，这只是一个示例。）

因此，我向某个我无法控制的主机（flickr）发出 AJAX 请求，并将进度报告给用户。如果没有服务器端脚本或类似的东西，我找不到这样做的方法。该解决方案最好使用 JQuery，因为这是我用于我的网站的。谢谢！艾萨克

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-30T07:04:18.163

据我所知， $.ajax() 函数不支持“加载的字节数”。它只有开始和完成事件，没有进度事件。

我发现[这个线程](http://markmail.org/message/kmrpk7w3h56tidxs#query:jquery%20ajax%20download%20progress+page:1+mid:kmrpk7w3h56tidxs+state:results)详细说明了一次尝试，但显然该代码适用于多个浏览器，但不适用于 IE。他们提出的建议是在其他浏览器中显示进度，并为 IE 显示一个简单的“正在加载...”消息。

请注意，在同一个站点上有几个类似的讨论，因此请浏览左侧面板以了解其他方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-29T08:09:19.827

一些浏览器提供对下载状态事件的支持，您可以在其中跟踪您的进度（我知道 ff 3.5+ 可以）。

这是由 ajax XHR 完成的。

你可以[在这里](https://developer.mozilla.org/en/using_xmlhttprequest)和[这里阅读更多](http://hacks.mozilla.org/2009/06/xhr-progress-and-richer-file-uploading-feedback/)

此外，可以将文件拆分为数组（假设我们将其分成 10 块），

现在发送 1peace，然后返回成功，进度 = 10% 等...

# c# - 防止多次分配相同的事件处理程序

> ID：399648
> 
> 赞同：47
> 
> 时间：2008-12-30T06:31:21.163
> 
> 标签：c#, events

如果我在运行时分配一个事件处理程序并且它位于可以多次调用的位置，那么建议的做法是防止将同一处理程序多次分配给同一事件。

```
object.Event += MyFunction 
```

将其添加到将被多次调用的位置将执行处理程序“n”次（当然）。

在尝试通过添加之前，我已诉诸删除任何以前的处理程序

```
object.Event -= MyFunction; 

object.Event += MyFunction; 
```

这有效，但似乎以某种方式关闭。关于正确处理的任何建议；）这种情况。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-12-30T08:20:47.900

Baget 关于使用显式实现的事件是正确的（尽管其中混合了显式接口实现和完整的事件语法）。你可能可以摆脱这个：

```
private EventHandler foo;

public event EventHandler Foo
{
    add
    {
        // First try to remove the handler, then re-add it
        foo -= value;
        foo += value;
    }
    remove
    {
        foo -= value;
    }
} 
```

如果您添加或删除多播委托，这可能会出现一些奇怪的边缘情况，但这不太可能。它还需要仔细的文档，因为它不是事件通常工作的方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-30T06:40:26.247

我倾向于在执行一次的路径中添加事件处理程序，例如在构造函数中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T11:00:58.467

您可以实现自己的委托存储，并在将它们添加到事件时检查唯一性。有关示例，请参见下面的 EventOwner2 类。我不知道这在性能方面的表现如何，但再说一次，这并不总是一个问题。

```
using System;
using System.Collections.Generic;

namespace EventExperiment
{
    class Program
    {
        static void Main(string[] args)
        {
            IEventOwner e=new EventOwner2();
            Subscriber s=new Subscriber(e);
            e.RaiseSome();
            Console.ReadKey();
        }
    }

    /// <summary>
    /// A consumer class, subscribing twice to the event in it's constructor.
    /// </summary>
    public class Subscriber
    {
        public Subscriber(IEventOwner eventOwner)
        {
            eventOwner.SomeEvent += eventOwner_SomeEvent;
            eventOwner.SomeEvent += eventOwner_SomeEvent;
        }

        void eventOwner_SomeEvent(object sender, EventArgs e)
        {
            Console.WriteLine(DateTimeOffset.Now);
        }

    }

    /// <summary>
    /// This interface is not essensial to this point. it is just added for conveniance.
    /// </summary>
    public interface IEventOwner
    {
        event EventHandler<EventArgs> SomeEvent;
        void RaiseSome();
    }

    /// <summary>
    /// A traditional event. This is raised for each subscription.
    /// </summary>
    public class EventOwner1 : IEventOwner
    {
        public event EventHandler<EventArgs> SomeEvent = delegate { };
        public void RaiseSome()
        {
            SomeEvent(this,new EventArgs());
        }
    }
    /// <summary>
    /// A custom event. This is raised only once for each subscriber.
    /// </summary>
    public class EventOwner2 : IEventOwner
    {
        private readonly List<EventHandler<EventArgs>> handlers=new List<EventHandler<EventArgs>>();
        public event EventHandler<EventArgs> SomeEvent
        {
            add
            {
                lock (handlers)
                    if (handlers!=null&&!handlers.Contains(value))
                    {
                        handlers.Add(value);
                    }
            }
            remove
            {
                handlers.Remove(value);
            }
        }
        public void RaiseSome()
        {
            EventArgs args=new EventArgs();
            lock(handlers)
            foreach (EventHandler<EventArgs> handler in handlers)
            {
                handler(this,args);
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T16:23:54.307

'object' 的访问修饰符是什么？

如果它是私有的，您只需要担心设置事件处理程序的包含对象。如果它是内部的，您只需要担心包含程序集设置事件处理程序。如果它是公开的，那么它是完全开放的。

如果可以在包含类上将“对象”设为私有，则可以通过控制本地类中的事件处理程序分配来提高检查效率。

如果需要“内部”或“公共”和唯一性，请使用隐藏“对象”的包装类，而是公开一个分配事件处理程序的方法，并在其后进行检查以确保唯一性。

# oop - OOP 有什么规则吗？

> ID：399656
> 
> 赞同：20
> 
> 时间：2008-12-30T06:37:43.553
> 
> 标签：oop, rules, solid-principles, package-design

最近听说OOP(Java)有9条规则。我只知道抽象、多态、继承和封装四个。OOP 还有更多规则吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-12-30T07:49:15.267

似乎您正在寻找的是[面向对象设计的原则](http://www.butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)。

总结自[敏捷软件开发原则、模式和实践](https://rads.stackoverflow.com/amzn/click/com/0135974445)。这些原则是数十年软件工程经验来之不易的产物。它们不是单一思想的产物，而是代表了大量软件开发人员和研究人员的整合和著作。尽管它们在这里作为面向对象设计的原则提出，但它们确实是长期存在的软件工程原则的特例。

**SRP 单一职责原则**一个类应该只有一个改变的理由。

**OCP 开闭原则**软件实体（类、包、方法等）应该对扩展开放，对修改关闭。

**LSP Liskov 替换原则**子类型必须可以替换它们的基本类型。

**DIP 依赖​​倒置原则**抽象不应该依赖于细节。细节应该取决于抽象。

**ISP 接口隔离原则** 客户不应被迫依赖他们不使用的方法。接口属于客户端，而不属于层次结构。

**REP 发布-重用等效原则** 重用的粒度就是发布的粒度。

**CCP 通用关闭原则** 包中的类应该一起关闭以防止相同类型的更改。影响已关闭包的更改会影响该包中的所有类，而不会影响其他包。

**CRP 通用重用原则** 包中的类被一起重用。如果您重用包中的某个类，那么您就可以重用它们。

**ADP 无环依赖原则** 依赖图中不允许有循环。

**SDP 稳定依赖原则** 依赖于稳定的方向。

**SAP 稳定抽象原则** 一个包应该是抽象的，因为它是稳定的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-30T06:54:25.017

不确定任何规则。所有这些提到的东西对我来说更像是面向对象的范式。我们遵循的建议很少，例如，

*   关注点分离
*   每个班级的单一职责
*   更喜欢组合而不是继承
*   接口编程
*   加上 Billybob 提到的所有内容，已经

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-30T07:50:08.617

这些 OO 原则直接来自[Head First Design Patterns](https://rads.stackoverflow.com/amzn/click/com/0596007124)：

*   封装变化
*   编程到接口，而不是实现
*   偏好组合胜于继承
*   一个类应该只有一个改变的理由（**单一责任原则**）
*   子类型必须可以替换它们的基础（**里氏替换原则**）
*   类应该对扩展开放，对修改关闭（**开闭原则**）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-30T06:52:01.730

这些是概念，而不是规则。真的没有规则，只是要做出决定，有些设计比其他设计好，有些比其他设计好得多:-)

虽然有很多指导方针 :-) 有些是特定于语言的（C++ 中充斥着它们），有些是特定于 OO 的。太多了，但无法列出:-)

在我的脑海中，重要的是：

*   松耦合，高内聚
*   编写可测试的类，您可以对其进行测试
*   谨慎使用继承，仅在有意义的地方使用（更喜欢组合）
*   尝试坚持开/关原则。
*   （最重要的）亲吻

有很多可以扩展和添加:-)

编辑：我应该补充一下，您列出的规则不是 OO 独有的

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-30T07:56:52.287

根据实用程序员 - 规则是：

*   保持干燥（不要重复自己）
*   保持 SHY（确保您的类具有高内聚和低耦合）
*   并告诉其他人（关注点分离）

[http://media.pragprog.com/articles/may_04_oo1.pdf](http://media.pragprog.com/articles/may_04_oo1.pdf)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-30T08:40:42.277

OOP 没有“规则”。

有 4 个语言属性可以使语言面向对象或不面向对象（这些是您在问题中列出的内容）。

其余的材料都有指导方针。我读过的最好/最有用的指南是[GRASP](http://en.wikipedia.org/wiki/GRASP_%28Object_Oriented_Design%29)

许多建议对于外行（非 CS 专业的学生）来说并不容易理解。我认为 GRASP 是务实且平易近人的。

我认为 GRASP 很好，因为它在其名称中暗示了 OO 中最关键的部分——责任分配（针对对象而不是程序员）。

其他一切都源自的两个最关键的 GRASP 概念是耦合和内聚。这两个概念/原则推动了所有其他模式和方法。

顺便说一句 - 我刚刚采访过你吗？你把问题抄错了……

# iphone - iPhone 开发 - 创建一个类似 UIImagePickerController 的类，将数据返回给父级

> ID：399661
> 
> 赞同：0
> 
> 时间：2008-12-30T06:39:35.873
> 
> 标签：iphone, objective-c, class-design

我有一种情况，我必须使用多个视图（如个人信息 -> 专业信息 -> 流程完成）从用户那里获取输入。

我想知道，如何构建一个像 UIImagePickerController 这样的类，它接受用户的输入并将数据返回给父类？请注意，视图也由此类处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T23:46:19.170

这是委托模式的完美示例。

您创建对象，分配委托。该对象允许用户交互。当用户关闭对象视图时，对象告诉委托“这里是选择的值”。

这是 Cocoa 和 Objective-C 中的标准模式，您应该学习使用它，因为您经常遇到它（例如，UITableView 或 UIImagePickerView 都使用委托模式）。

# svn - 在 Subversion 中将主干合并到分支

> ID：399669
> 
> 赞同：77
> 
> 时间：2008-12-30T06:43:01.530
> 
> 标签：svn, merge

我使用的是 Subversion 1.4.6，现在无法升级到 1.5 版。

情况：

1.  主干有很多结构变化（即主要是移动文件）。

2.  我有一个最近从主干合并的分支，但在重大更改之前。

将主干合并到分支的最佳方法是什么？

我的想法是：

1.  首先小心地将分支合并到主干，只将分支中的修改文件合并到主干。

2.  将主干复制到分支。在不丢失分支历史的情况下执行此操作的最佳方法是什么？我应该弃用分支并创建一个新分支吗？

* * *

好吧，看来我没有给予 SVN 足够的信任。毕竟它足够聪明。我只是被“D”和“A”的输出推迟了，但在后台它做了一个动作。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2008-12-30T07:15:15.070

自上次合并以来，是否有什么阻止您合并主干上的所有修订？

```
svn merge -rLastRevisionMergedFromTrunkToBranch:HEAD url/of/trunk path/to/branch/wc 
```

应该可以正常工作。至少如果您想将主干上的所有更改合并到您的分支。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2010-01-31T06:11:53.047

可以通过在工作副本目录中运行以下命令来找到从主干合并到分支的最新修订：

```
svn log -v --stop-on-copy 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-05-27T13:17:12.560

这是指定要合并的修订范围的“老式”方式。使用 1.5+，您可以使用：

```
svn merge HEAD url/of/trunk path/to/branch/wc 
```

# wcf - 如何从基于 REST 的 WCF 服务中读取授权标头？

> ID：399674
> 
> 赞同：8
> 
> 时间：2008-12-30T06:49:46.680
> 
> 标签：wcf, restful-authentication

如何从基于 REST 的 WCF 服务中读取授权标头信息？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-06-23T16:58:40.470

实际上，既然您要求基于 REST 的 WCF 服务，我认为您应该使用

```
WebOperationContext.Current.IncomingRequest.Headers 
```

为了获取请求中的 HTTP 标头。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T08:06:01.080

您正在尝试读取 http 标头。

```
OperationContext.Current.OutgoingMessageProperties
or
OperationContext.Current.IncomingMessageProperties 
```

# php - 网页 - 用户自定义样式

> ID：399689
> 
> 赞同：0
> 
> 时间：2008-12-30T07:02:22.177
> 
> 标签：php, javascript, css, ajax

我怎样才能给用户改变网页样式的能力，当然我必须制作几个 CSS 文件，但是我怎样才能制作允许用户选择改变的代码

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T07:18:21.037

我们都不太可能给出像[A List Apart](http://www.alistapart.com/articles/alternate/)那样彻底的答案。

他们甚至[为您提供了一些可自由使用的代码](http://www.alistapart.com/d/alternate/styleswitcher.js)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T08:14:57.240

您基本上将拥有页面所有主要组件的 css 类，例如页眉、内容、页脚、nav_menu 项、标题等。您希望用户能够自定义的所有内容都将为它创建一个 css 类/ID .

然后，您将向用户显示所有这些类，让他手动输入 CSS 代码，或者向他显示具有所有可能颜色的下拉框，例如，或其他设置。

当用户更改选项时，您可以使用 javascript 更改他选择的 css ID/类的该属性。例如，如果他将标题的背景颜色从黑色更改为蓝色，您可以这样做：

```
document.getElementById("header").style.background-color="#ABCDEF"; 
```

（Jquery 可能有更简单的方法）

在页面的末尾，您可以有一个提交按钮，它将所有 css 设置发布到一个 php 脚本，该脚本会将这些设置写入数据库。然后你会做一个像这样的查询：

```
SELECT css_id,css_class,css_code FROM css_styles WHERE user_id='$user_id'; 
```

这将返回所有 css 代码，然后将其放在 <head> 命令而不是外部 css 文件中。

# c# - WPF：使用绑定机制为单个对象设置标志枚举值的想法

> ID：399691
> 
> 赞同：0
> 
> 时间：2008-12-30T07:04:18.943
> 
> 标签：c#, wpf, binding, enums

例如，我有一个枚举...

```
 public enum TypeIdentifier {
            NotSet = 0,
            Type1= 1,
            Type2= 2,
            Type3= 3,
            Type4= 4,
            Type5= 5
        }

public class CommonObject
{

TypeIdentifier myTypeIdentifier {get; set;}
} 
```

我有一个具有通用对象绑定的 WPF 用户控件。我有一个使用了 3 次的通用对象，掩蔽为 5 个不同的用户控件（成员使用不同）。

我需要在 UserControl One 中包含隐藏的值说 TypeIdentifier.Type1。我该怎么做t 在我的用户控件项目中直接引用上面的枚举..:-( 有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T07:08:56.890

如果您不能引用枚举，那么您将不得不使用`int`s 和[`Enum.Parse()`](http://msdn.microsoft.com/en-us/library/aa328348.aspx)，可能隐藏在[`ValueConverter`](http://msdn.microsoft.com/en-us/library/ms771571.aspx).

# jquery - 简单的模式在 Firefox 3 和 Internet Explorer 7 中不起作用

> ID：399692
> 
> 赞同：0
> 
> 时间：2008-12-30T07:05:06.650
> 
> 标签：jquery, ajax, simplemodal

我正在使用简单的 modal 和[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)。当我尝试从 Ajax 读取内容时，它在 Chrome 中运行良好。Internet Explorer 7 和 Firefox 3 存在问题。

我究竟做错了什么？

### 我的代码：

```
print("code sample");

$(document).ready(function () {
    $('#confirma, #confirmDialog a.confirm').click(function (e) {
        e.preventDefault();

        // Example of calling the confirm function.
        // You must use a callback function to perform the "yes" action
        alert("OK");
        confirm("Hello");
    });
});

function confirm(message) {
    $('#confirm').modal({
        close: false,
        position: ["8%",],
        overlayId: 'confirmModalOverlay',
        containerId: 'confirmModalContainer',
        onShow: function (dialog) {
            dialog.data.find('.message').append(message);
            // If the user clicks "yes"
            dialog.data.find('.yes').click(function () {
                // Close the dialog
                $.modal.close();
                $.get("My.php", function (data) {
                    $('#resp').modal({
                        close: false,
                        position: ["8%",],
                        overlayId: 'confirmRespOverlay',
                        containerId: 'confirmRespContainer',
                        onShow: function (second) {
                            var test = "hello";
                            second.data.find('.info').append(data);
                            second.data.find('.yes').click(function () {
                                alert("Double OK");
                            });
                        }//onShow
                    }); //Resp
                });
            });//Click
        }// Onshow
    });//Modal
} //Confirm 
```

我能够读取文件中的数据`my.php`，但是当它在 Internet Explorer 7 和 Firefox 3 中显示模式时，所有内容都被隐藏了。Chrome 正确显示了 Ajax 数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-01T04:44:08.680

如果你改变它可能会起作用

```
second.data.find('.info').append(data); 
```

到

```
second.data.find('.info').append(data).show(); 
```

# jsp - GSP 中的窗格组件

> ID：399702
> 
> 赞同：2
> 
> 时间：2008-12-30T07:15:16.487
> 
> 标签：jsp, web-applications, grails, layout, gsp

所以看起来 Grails 的 GSP 没有包含标签（如果我错了，请纠正我）。最接近“包含”的是使用[渲染标签](http://docs.codehaus.org/display/GRAILS/Tag+-+render)。还有[包含插件](http://grails.org/Include+Plugin)。

就我而言，我有一个经典的左上中右下窗格页面。顶部标题或左侧将包括导航。中间是内容。右侧可能包括广告。在我的应用程序的 JSP 版本中，除了中间的每个窗格都将位于它们自己的 JSP 中。然后，我会将`<jsp:include/>`各种面板包含（使用）到我的页面中。这是普惠制中的正确方法吗？

在 GSP 中实现这一目标的首选模式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T16:59:29.210

您可能希望使用 grails 提供的布局功能（使用 SiteMesh），而不是按视图导入或渲染窗格。如果您想对所有页面应用相同的布局（即菜单/内容/广告），您只需修改`grails-app/views/layouts/main.gsp`以拥有您需要的页面元素，然后该`<g:layoutBody/>`标签将由您的控制器呈现的常规视图填充。`main.gsp`布局是默认提供的，是所有（脚手架和生成的）视图的默认布局。

如果您需要一些页面有广告而另一些页面没有广告，您需要在`grails-app/views/layouts`(例如`main-ads.gsp`) 中创建一个新布局。然后，在您希望有广告的视图中，在 中`<head></head>`，您将使用 设置布局`<meta name="layout" content="main-ads.gsp"/>`。

[http://docs.codehaus.org/display/GRAILS/Views+and+Layouts](http://docs.codehaus.org/display/GRAILS/Views+and+Layouts)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-20T19:01:23.387

从 Grails 1.1 开始，现在有一个`<g:include> tag`几乎完全可以满足您的需求。

研究上述选项重新布局/模板仍然是有意义的，因为它们在大多数情况下会更有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T13:59:42.787

你是正确的，渲染标签可以完成你想做的事情。尝试使用模板，关键是使用初始下划线命名它们。这篇[博文](http://moongrails.blogspot.com/2008/12/grails-templates.html)应该会有所帮助。

# c - C 语言的 XML 解析器

> ID：399704
> 
> 赞同：49
> 
> 时间：2008-12-30T07:15:27.097
> 
> 标签：c, xml, parsing

你能推荐一些最好的 C 语言解析器吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-01-02T18:29:00.313

[expat](http://expat.sourceforge.net)和[libxml2](http://xmlsoft.org/)的两个示例。第二个是，恕我直言，更容易使用，因为它在内存中创建了一个树，一种易于使用的数据结构。另一方面，expat 不构建任何东西（您必须自己做），它只允许您在解析期间调用特定事件的处理程序。但是外籍人士可能更快（我没有测量）。

使用 expat，读取 XML 文件并显示缩进的元素：

```
/* 
   A simple test program to parse XML documents with expat
   <http://expat.sourceforge.net/>. It just displays the element
   names.

   On Debian, compile with:

   gcc -Wall -o expat-test -lexpat expat-test.c  

   Inspired from <http://www.xml.com/pub/a/1999/09/expat/index.html> 
*/

#include <expat.h>
#include <stdio.h>
#include <string.h>

/* Keep track of the current level in the XML tree */
int             Depth;

#define MAXCHARS 1000000

void
start(void *data, const char *el, const char **attr)
{
    int             i;

    for (i = 0; i < Depth; i++)
        printf("  ");

    printf("%s", el);

    for (i = 0; attr[i]; i += 2) {
        printf(" %s='%s'", attr[i], attr[i + 1]);
    }

    printf("\n");
    Depth++;
}               /* End of start handler */

void
end(void *data, const char *el)
{
    Depth--;
}               /* End of end handler */

int
main(int argc, char **argv)
{

    char           *filename;
    FILE           *f;
    size_t          size;
    char           *xmltext;
    XML_Parser      parser;

    if (argc != 2) {
        fprintf(stderr, "Usage: %s filename\n", argv[0]);
        return (1);
    }
    filename = argv[1];
    parser = XML_ParserCreate(NULL);
    if (parser == NULL) {
        fprintf(stderr, "Parser not created\n");
        return (1);
    }
    /* Tell expat to use functions start() and end() each times it encounters
     * the start or end of an element. */
    XML_SetElementHandler(parser, start, end);
    f = fopen(filename, "r");
    xmltext = malloc(MAXCHARS);
    /* Slurp the XML file in the buffer xmltext */
    size = fread(xmltext, sizeof(char), MAXCHARS, f);
    if (XML_Parse(parser, xmltext, strlen(xmltext), XML_TRUE) ==
        XML_STATUS_ERROR) {
        fprintf(stderr,
            "Cannot parse %s, file may be too large or not well-formed XML\n",
            filename);
        return (1);
    }
    fclose(f);
    XML_ParserFree(parser);
    fprintf(stdout, "Successfully parsed %i characters in file %s\n", size,
        filename);
    return (0);
} 
```

使用 libxml2，一个显示根元素名称及其子元素名称的程序：

```
/*
   Simple test with libxml2 <http://xmlsoft.org>. It displays the name
   of the root element and the names of all its children (not
   descendents, just children).

   On Debian, compiles with:
   gcc -Wall -o read-xml2 $(xml2-config --cflags) $(xml2-config --libs) \
                    read-xml2.c    

*/

#include <stdio.h>
#include <string.h>
#include <libxml/parser.h>

int
main(int argc, char **argv)
{
    xmlDoc         *document;
    xmlNode        *root, *first_child, *node;
    char           *filename;

    if (argc < 2) {
        fprintf(stderr, "Usage: %s filename.xml\n", argv[0]);
        return 1;
    }
    filename = argv[1];

    document = xmlReadFile(filename, NULL, 0);
    root = xmlDocGetRootElement(document);
    fprintf(stdout, "Root is <%s> (%i)\n", root->name, root->type);
    first_child = root->children;
    for (node = first_child; node; node = node->next) {
        fprintf(stdout, "\t Child is <%s> (%i)\n", node->name, node->type);
    }
    fprintf(stdout, "...\n");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-12-30T07:27:44.043

[用纯汇编程序](http://mkerbiquet.free.fr/asm-xml/)编写的怎么样:-) 不要忘记检查[基准](http://mkerbiquet.free.fr/asm-xml/benchmark.html)。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2008-12-30T07:17:46.030

两个最广泛使用的解析器是[Expat](http://www.jclark.com/xml/expat.html)和[libxml](http://www.xmlsoft.org/)。

如果您可以使用 C++，那么还有[Xerces-C++](http://xerces.apache.org/xerces-c/)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-30T07:22:13.137

你可以试试[ezxml——](http://ezxml.sourceforge.net/)它是一个完全用 C 编写的轻量级解析器。

对于 C++，您可以查看[TinyXML++](http://www.grinninglizard.com/tinyxml/)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-27T18:09:19.677

[http://www.minixml.org](http://www.minixml.org)也不错。小而只是 ANSI C。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-09-06T05:57:58.120

我个人的偏好是[libxml2](http://xmlsoft.org/)。它非常易于使用，但我从不费心对其进行基准测试，因为我只将它用于配置文件解析。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-30T07:19:28.617

[外籍人士](http://expat.sourceforge.net)相当不错。但是，如果没有更多信息，很难给出好的建议。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-30T07:33:24.580

您能否说明您正在为哪些平台编写代码？这应该严重影响什么是“最好的”。您可能会发现一个超级“xml-foo”库默认情况下在大多数系统上并不常见......虽然它很棒，但缺少该库可能会阻止（或至少）惹恼用户。

大多数情况下，我使用 libxml2 .. 因为它是标准的或易于安装在我的目标平台上。

如您所见，“最佳”还取决于目标平台上可用的库。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-09-13T06:26:15.777

对于 C++，我建议使用[CMarkup](http://www.firstobject.com)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-30T10:31:40.960

在 Windows 上，它是原生的 Win32 api...

# wpf - WPF - 为什么列表框项目不填充uniformgrid

> ID：399713
> 
> 赞同：4
> 
> 时间：2008-12-30T07:21:58.893
> 
> 标签：wpf, listbox, itemspaneltemplate

我有一个列表框，其中 ItemsPanelTemplate 设置为 UniformGrid，rows= 6 和 cols= 7。

我希望列表框项目填满它们的空间。

我正在使用字典中定义的数据模板。

我的模板的外部控件是一个 Border 与 Horizo​​ntalAlignment=Stretch 和 VerticalAlignent=Strectch 但模板不填充列表框项目空间？

有任何想法吗？马尔科姆

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-03T12:01:39.737

将 Horizo​​ntalContentAligment 和 VerticalContentAlignment 设置为在 LISTBOX 而不是数据模板上拉伸的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T08:11:31.523

已编辑：添加了其他信息，并回答了问题。

`ListBoxItems`与其他项目统一的一个有趣的方法是`Grid`在你的共享范围功能`DataTemplate`

例子：

```
<ItemsControl Grid.IsSharedSizeScope="True" ItemsSource="{Binding Path=Items}">
  <ItemsControl.ItemTemplate>
    <DataTemplate>
      <StackPanel Orientation="Horizontal">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition SharedSizeGroup="Content"/>
          </Grid.ColumnDefinitions>
          <TextBlock Grid.Column="1" Text="{Binding Path=Name}">
        </Grid>
      </StackPanel>
    </DataTemplate>
  </ItemsControl.ItemTemplate>
</ItemsControl> 
```

现在所有的`TextBlocks`在你的布局中都将是相同的大小。如果未设置特定的宽度/高度，则子项应填满所有可用空间。

或者，您可以将控件的宽度和高度设置为拉伸，但是我认为使用 Grid.SharedScopeSize 是实现相同效果的更优雅的方式。

# sql - Hacky Sql Compact 解决方法

> ID：399719
> 
> 赞同：2
> 
> 时间：2008-12-30T07:27:57.680
> 
> 标签：sql, sql-server, database

因此，我正在尝试使用 ADO.NET 流式传输存储在 SQL Compact 数据库的图像列中的文件数据。

为此，我编写了一个 DataReaderStream 类，该类接受一个数据读取器，为顺序访问打开，并将其表示为一个流，将流上对 Read(...) 的调用重定向到 IDataReader.GetBytes(...)。

与 Stream 类相比，IDataReader.GetBytes(...) 的一个“奇怪”方面是 GetBytes 要求客户端在每次调用时增加一个偏移量并传递该偏移量。即使访问是顺序的，它也会这样做，并且不可能在数据读取器流中“向后”读取。

IDataReader 的 SqlCeDataReader 实现通过增加一个内部计数器来强制执行此操作，该计数器标识它返回的字节总数。如果您传入的数字小于或大于该数字，该方法将抛出 InvalidOperationException。

但是，这样做的问题是 SqlCeDataReader 实现中存在一个错误，导致它将内部计数器设置为错误的值。这会导致随后对我的流上的 Read 的调用在不应该出现异常时抛出异常。

[我在这个 MSDN 线程](http://social.msdn.microsoft.com/forums/en-US/sqlce/thread/3cce86b2-9866-4f91-b8c8-57b7e7af0b98/)上找到了一些关于该错误的信息。

我能够想出一个令人作呕的、非常骇人听闻的解决方法，它基本上使用反射将类中的字段更新为正确的值。

代码如下所示：

```
 public override int Read(byte[] buffer, int offset, int count)
    {
        m_length  = m_length ?? m_dr.GetBytes(0, 0, null, offset, count);

        if (m_fieldOffSet < m_length)
        {
            var bytesRead = m_dr.GetBytes(0, m_fieldOffSet, buffer, offset, count);
            m_fieldOffSet += bytesRead;

            if (m_dr is SqlCeDataReader)
            {
                //BEGIN HACK
                //This is a horrible HACK.
                    m_field = m_field ?? typeof (SqlCeDataReader).GetField("sequentialUnitsRead", BindingFlags.NonPublic | BindingFlags.Instance);
                    var length = (long)(m_field.GetValue(m_dr));
                    if (length != m_fieldOffSet)
                    {   
                        m_field.SetValue(m_dr, m_fieldOffSet);
                    }
                //END HACK
            }

            return (int) bytesRead;
        }
        else
        {
            return 0;
        }
    } 
```

出于显而易见的原因，我宁愿不使用它。

但是，我也不想在内存中缓冲 blob 的全部内容。

有谁知道我可以从 SQL Compact 数据库中获取流数据而不必求助于如此糟糕的代码的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T21:41:53.323

我联系了微软（通过 SQL Compact 博客），他们确认了这个错误，并建议我使用 OLEDB 作为解决方法。所以，我会尝试一下，看看它是否适合我。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-30T23:42:22.220

实际上，我决定一开始就不在数据库中存储 blob 来解决这个问题。

这消除了问题（我可以从文件中流式传输数据），还解决了我可能遇到的一些问题，因为 Sql Compact 的 4 GB 大小限制。

# .net - .NET 中的 WinHttp.WinHttpRequest

> ID：399722
> 
> 赞同：3
> 
> 时间：2008-12-30T07:30:08.703
> 
> 标签：.net, winhttp, winhttprequest

是否有一个内置的 .NET 类可以替代或像 WinHttp.WinHttpRequest 一样工作？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-30T07:43:53.717

有**System.Net.HttpRequest**类：

[HttpWebRequest 类](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx)

提供 WebRequest 类的特定于 HTTP 的实现。

*   命名空间：System.Net
*   程序集：系统（在 System.dll 中）

您也可以使用**System.Net.WebClient**类：

[WebClient 类](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)

提供用于向由 URI 标识的资源发送数据和从其接收数据的常用方法。

*   命名空间：System.Net
*   程序集：系统（在 System.dll 中）

这个类简化了一些常见的任务，比如下载文件（方法`DownloadFile`）

> WebClient 类提供了用于向任何由 URI 标识的本地、Intranet 或 Internet 资源发送数据或从其接收数据的常用方法。
> 
> WebClient 类使用 WebRequest 类来提供对资源的访问。WebClient 实例可以使用通过 WebRequest.RegisterPrefix 方法注册的任何 WebRequest 后代访问数据。

# shell - 来自 shell 脚本的输入

> ID：399734
> 
> 赞同：12
> 
> 时间：2008-12-30T07:45:17.630
> 
> 标签：shell

我有一个脚本调用需要用户输入的应用程序，例如运行需要用户输入“Y”或“N”的应用程序。
如何让 shell 脚本不向用户询问输入，而是使用脚本中预定义变量的值？

就我而言，将有两个问题需要输入。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-30T07:48:12.427

您可以在标准输入上输入您想要的任何文本，这与让用户自己键入一样。例如模拟键入“Y”只需使用：

```
echo "Y" | myapp 
```

或使用 shell 变量：

```
echo $ANSWER | myapp 
```

还有一个名为“yes”的unix命令，它为那些提出很多你只想肯定回答的问题的应用程序输出一个连续的“y”流。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-05-26T07:21:47.150

如果应用程序从 stdin 读取（而不是从 /dev/tty 读取，例如`passwd`程序所做的那样），那么多行输入是 here-document 的完美候选者。

```
#!/bin/sh

the_app [app options here] <<EOF
Yes
No
Maybe
Do it with $SHELL
Quit
EOF 
```

如您所见，here-documents 甚至允许参数替换。如果您不想要这个，请使用`<<'EOF'`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-30T08:00:40.390

对于更复杂的情况，expect 命令，你的系统应该有它。我自己没有使用太多，但我怀疑它是你正在寻找的。

```
$ man expect 
```

[http://oreilly.com/catalog/expect/chapter/ch03.html](http://oreilly.com/catalog/expect/chapter/ch03.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-29T03:29:08.243

我更喜欢这种方式：如果您想要多个输入...您可以这样输入多个 echo 语句：

```
 { echo Y; Y; } | sh install.sh >> install.out 
```

在上面的示例中...我将两个输入输入到 install.sh 脚本中。然后......最后，我将脚本输出通过管道传输到一个日志文件，以便稍后存档和查看。

# c++ - 抽象基类的设计问题？

> ID：399740
> 
> 赞同：0
> 
> 时间：2008-12-30T07:50:53.640
> 
> 标签：c++

有接口

```
class abc {

public:
virtual int foo() = 0;  
...

}

class concrete1: public abc { 

public:
int foo() { 

..
}

class concrete2 : public abc {

public:
int foo() {

..
}

} 
```

现在在我的主程序中，我需要根据变量的值构造类

```
abc *a;
if (var == 1)
   a = new concrete1();
else
   a = new concrete2(); 
```

显然我不希望程序中到处都有这两行（请注意我在这里已经简化了，以便清楚）。如果有的话，我应该使用什么设计模式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-30T07:55:12.477

您正在寻找[http://en.wikipedia.org/wiki/Factory_method_pattern](http://en.wikipedia.org/wiki/Factory_method_pattern)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T07:59:25.027

首先，您应该使用 litb 提到的工厂或工厂方法。

但除此之外，我建议您使用枚举，或者至少使用符号常量来确定要实例化哪个类。这更容易阅读，它允许您为意外值构建保护措施。

# .net - 是否有任何高级跨平台 UI 控件？

> ID：399741
> 
> 赞同：1
> 
> 时间：2008-12-30T07:55:12.257
> 
> 标签：.net, user-interface

.net 世界中的业务应用程序使用第三方控件集（如 devxpress、componentOne 等）是很常见的。它们提供了应用皮肤、使用具有丰富功能的控件等的可能性。

当我们想要将此类应用程序移植到其他平台时，就会出现问题 - 是否有任何控件具有它们的例如。linux 对应物（具有类似的 API、功能等）？

我找不到任何东西，所以在较低级别我正在考虑：

*   原始 Mono 2.0 winforms - 未经证实，可能有一些怪癖，没有丰富的控件，没有蒙皮

*   QT - GPL（并非所有客户都愿意发布源代码），有点学习曲线

*   GTK - 没有丰富的控件，没有皮肤，没有原生窗口的外观和感觉

*   Silverlight - 没有文件系统访问权限

*   SWT - 不知道它如何与 .NET 一起使用，我想“没有丰富的控件和皮肤”也适用于这里

感谢您的任何建议

[编辑] 丰富的控件我的意思是例如。分层网格（具有树状可折叠行）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T08:15:25.993

请注意，QT 可通过商业许可证获得。

还有Java Swing。Tk 也是跨平台的。

GTK 对您来说缺少什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T08:30:39.177

wxWidgets/wxWindows 可能是 GTK/Qt 的一个很好的替代品；我不知道他们是否具有您正在寻找的特定控件，但我在多个平台上都获得了运气。

我想现在有几个可用的 .NET 绑定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T08:02:04.663

我不知道有任何真正的跨平台 UI 控件可用于高效构建功能丰富的企业应用程序。

到目前为止，我一直采用的方法是**使表示层尽可能薄，**并将**其托管在单独的表示模块**/组件中（与接口、控制器和其他组件分开）。然后，您可以使用可用的最佳技术开发其他演示模块以针对特定平台。

WCF 稍后可能会简化一些事情，但它仍然可以与这种方法互操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T09:36:27.593

wx.NET ( [http://wxnet.sourceforge.net/](http://wxnet.sourceforge.net/) ) 可能可用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T09:51:41.353

我也会推荐 wxWidgets。如果您使用 Python 进行开发，请使用 wxPython。它最好的部分是能够以您正在使用的任何语言编写自定义 wx 控件，并让它们在所有平台上正确显示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-13T20:10:43.313

有[Eto.Forms （在 github 上），它是](https://github.com/picoe/Eto)**WPF**、**WinForms**、**GTK**和**MonoMac/Cocoa**之上的一个抽象层——因此您可以在所有平台上获得本机 UI，而无需为每个平台重新实现。您不必为最小公分母而受苦，因为您可以为每个平台实现细节（如果需要，但不是必需的）。

关于*丰富的控件*，它确实有 TreeGridView，它是一个树状分层网格。此控件（以及所有其他控件）在所有平台上都可以正常运行。

在*皮肤*方面，您可以为每个平台的控件皮肤。例如，WPF 具有非常广泛的皮肤功能，您可以利用等。另一种方法是使用其广泛的图形/绘图功能来实现控件。

它的优点是它是纯 .NET 并且仅依赖于操作系统提供的依赖项，而不是使用 GTK、QT 或 WxWidgets，您必须为各种平台捆绑本机二进制文件。

# debugging - 带有调试工具的 USB 驱动器

> ID：399751
> 
> 赞同：2
> 
> 时间：2008-12-30T08:02:36.253
> 
> 标签：debugging, usb-drive

我正在组装一个 USB 驱动器，该驱动器应该包含用于解决用户遇到的各种软件问题的工具。

你会推荐我包括哪些工具？

主要环境：Windows和.NET

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T09:43:26.937

我可以推荐以下内容：{其中一些已经被提及}

## 日志分析：

文本板

记事本++

VIM {用于打开非常大的 txt 文件}

## 系统监控：

Process Explorer {允许检查加载的线程和 dll}

## 代码/错误分析：

反射器

调试视图

数据库

自动转储+

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T08:23:50.703

*   [客户使用的所有不同密码的KeePass](http://keepass.info/)。
*   您构建的任何特定于应用程序的脚本（SQL、批处理文件、PowerShell 等）。
*   [愤怒的 IP 扫描仪](http://www.angryziber.com/w/Home)
*   来自 Sysinternals 的[PSTools](http://technet.microsoft.com/en-us/sysinternals/bb896649.aspx)
*   如果你是 .NET，你应该得到[Reflector](http://www.red-gate.com/products/reflector/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-23T19:08:27.943

**SysInternals Suite**，尤其是 AutoRuns、Process Explorer 和 Process Monitor

[http://www.sysinternals.com](http://www.sysinternals.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T08:11:13.753

“DebugView 是一个应用程序，可让您监视本地系统上的调试输出，或者您可以通过 TCP/IP 访问的网络上的任何计算机。它能够显示内核模式和 Win32 调试输出，因此您不需要需要一个调试器来捕获您的应用程序或设备驱动程序生成的调试输出，您也不需要修改您的应用程序或驱动程序以使用非标准调试输出 API。”

[http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)

# java - 使用 Java 在 MS Word 文件中创建表

> ID：399754
> 
> 赞同：5
> 
> 时间：2008-12-30T08:05:04.657
> 
> 标签：java, ms-word

我想使用 Java 在 Microsoft Office Word 文件中创建一个表。谁能告诉我如何用一个例子来做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-30T08:31:14.383

Have a look at [Apache POI](http://poi.apache.org/)

> The POI project is the master project for developing pure Java ports of file formats based on Microsoft's OLE 2 Compound Document Format. OLE 2 Compound Document Format is used by Microsoft Office Documents, as well as by programs using MFC property sets to serialize their document objects.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T08:26:00.713

我从未见过它完成，我经常在 Word 中工作。如果您真的想以编程方式在 Word 文档中执行某些操作，那么我建议您使用专门为此目的设计的 Microsoft 脚本语言 VBA。事实上，我现在正在从事这项工作。

如果你在 Open Office 下工作，那么他们有一套非常相似的宏驱动工具来做同样的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T09:21:33.347

Office 2003 has an xml format, and the default document format for office 2007 is xml (zipped). So you could just generate xml from java. If you open an existing document it's not too hard too see the xml required.

Alternatively, you could use openoffice's api to generate a document, and save it as a ms-word document.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-10T10:23:47.593

此代码段可用于在 MS Word 文档中动态创建表格。

```
WPFDocument document = new XWPFDocument();
XWPFTable tableTwo = document.createTable();
XWPFTableRow tableTwoRowOne = tableTwo.getRow(0);
tableTwoRowOne.getCell(0).setText(Knode1);
tableTwoRowOne.createCell().setText(tags.get("node1").toString());
for (int i = 1; i < nodeList.length; i++) {
    String node = "node";
    String nodeVal = "";
    XWPFTableRow tr = null;
    node = node + (i + 1);
    nodeVal = tags.get(node).toString();
    if (tr == null) {
        tr = tableTwo.createRow();
        tr.getCell(0).setText(nodeList[i]);
        tr.getCell(1).setText(tags.get(node).toString());
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T09:44:31.490

我们的功能集是在我们的网络应用程序中点击一个按钮，然后将您正在查看的页面作为 Word 文档返回。我们使用 docx 模式来描述文档，并在服务器端有一堆 Java 代码，用于创建文档并返回给我们的 Web 客户端。格式化本身是使用 Java 中的一些已编译的 xsl-t 完成的，以从我们自己的 XML 持久层进行转换。

docx 模式很难理解。我们取得最大进展的方式是在 Word 中创建模板 docx，其格式与我们需要的格式完全相同，但内容是虚假的。然后我们和他们胡闹，直到我们确切地了解发生了什么。docx 中有大量内容，您并不需要真正担心。在阅读/翻译 docx 时，Word 对部分完整的格式架构非常宽容。事实上，我们选择去掉几乎所有的格式，因为这也意味着用户的默认格式优先，这是他们似乎更喜欢的。它还使 xsl 进程更快，生成的文档更小。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-27T02:59:02.690

**我管理 docx4j 项目**

docx4j 包含一个类[TblFactory](https://github.com/plutext/docx4j/blob/master/src/main/java/org/docx4j/model/table/TblFactory.java)，它使用 Word 2007 将创建的默认设置以及用户指定的尺寸创建常规表（即没有行或列跨度）。

如果您想要更复杂的表，最简单的方法是在 Word 中创建它，然后将生成的 XML 复制到 IDE 中的 String 中，您可以在其中使用 docx4j 的 XmlUtils.unmarshalString 从中创建 Tbl 对象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-10T13:05:54.437

使用我的小 zip 实用程序，如果您知道自己在做什么，就可以轻松创建 docx。Word 的 DOCX 文件格式只是 zip（带有 xml 文件的文件夹）。通过使用 java zip 实用程序，您可以修改现有的 docx，只是内容部分。

为了使下面的示例工作，只需打开 Word，输入几行，保存文档。然后使用 zip 程序，从 zip 中删除文件 word/document.xml（这是 Word 文档的主要内容所在的文件）。现在您已准备好模板。保存修改后的 zip。

这是创建新 Word 文件的样子：

```
/* docx file head  */
    final String DOCUMENT_XML_HEAD =
            "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\" ?>" +
            "<w:document xmlns:wpc=\"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:wp14=\"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:w14=\"http://schemas.microsoft.com/office/word/2010/wordml\" xmlns:w15=\"http://schemas.microsoft.com/office/word/2012/wordml\" xmlns:wpg=\"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup\" xmlns:wpi=\"http://schemas.microsoft.com/office/word/2010/wordprocessingInk\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\" xmlns:wps=\"http://schemas.microsoft.com/office/word/2010/wordprocessingShape\" mc:Ignorable=\"w14 w15 wp14\">" +
            "<w:body>";

    /* docx file foot  */
    final String DOCUMENT_XML_FOOT =
             "</w:body>" +
             "</w:document>";

    final ZipOutputStream zos =  new ZipOutputStream(new FileOutputStream("c:\\TEMP\\test.docx"));

    final String fullDocumentXmlContent = DOCUMENT_XML_HEAD + "<w:p><w:r><w:t>Hey MS Word, hello from java.</w:t></w:r></w:p>" + DOCUMENT_XML_FOOT;

    final si.gustinmi.DocxZipCreator creator = new si.gustinmi.DocxZipCreator();

    // create new docx file
    creator.createDocxFromExistingDocx(zos, "c:\\TEMP\\existingDocx.docx", fullDocumentXmlContent); 
```

这些是 zip 实用程序：

```
package si.gustinmi;

import java.io.*;
import java.nio.charset.StandardCharsets;
import java.util.logging.Logger;
import java.util.zip.CRC32;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;
import java.util.zip.ZipOutputStream;

/**
 * Creates new docx from existing one.
 * @author gustinmi [at] gmail [dot] com
 */
public class DocxZipCreator {

    public static final Logger log = Logger.getLogger(DocxZipCreator.class.getCanonicalName());

    private static final int BUFFER_SIZE = 4096;

    /** OnTheFly zip creator. Traverses through existing docx zip and creates new one simultaneousl.
     * On the end, custom document.xml is inserted inside
     * @param zipFilePath location of existing docx template (without word/document.xml)
     * @param documentXmlContent content of the word/document.xml
     * @throws IOException
     */
    public void createDocxFromExistingDocx(ZipOutputStream zos, String zipFilePath, String documentXmlContent) throws IOException {

        final FileInputStream fis = new FileInputStream(zipFilePath);
        final ZipInputStream zipIn = new ZipInputStream(fis);

        try{
            log.info("Starting to create new docx zip");
            ZipEntry entry = zipIn.getNextEntry();
            while (entry != null) { // iterates over entries in the zip file
                copyEntryfromZipToZip(zipIn, zos, entry.getName());
                zipIn.closeEntry();
                entry = zipIn.getNextEntry();
            }

            // add document.xml to existing zip
            addZipEntry(documentXmlContent, zos, "word/document.xml");

        }finally{
            zipIn.close();
            zos.close();
            log.info("End of docx creation");
        }

    }

    /** Copies sin gle entry from zip to zip  */
    public void copyEntryfromZipToZip(ZipInputStream is, ZipOutputStream zos, String entryName)
    {
        final byte [] data = new byte[BUFFER_SIZE]; 
        int len; 
        int lenTotal = 0;
        try {

            final ZipEntry entry = new ZipEntry(entryName); 
            zos.putNextEntry(entry); 

            final CRC32 crc32 = new CRC32(); 
            while ((len = is.read(data)) > -1){ 
                zos.write(data, 0, len); 
                crc32.update(data, 0, len);
                lenTotal += len;
            } 

            entry.setSize(lenTotal); 
            entry.setTime(System.currentTimeMillis()); 
            entry.setCrc(crc32.getValue());

        }
        catch (IOException ioe){
            ioe.printStackTrace();
        }
        finally{
            try { zos.closeEntry();} catch (IOException e) {}
        }
    }

    /**  Create new zip entry with content
     * @param content content of a new zip entry
     * @param zos 
     * @param entryName name (npr: word/document.xml)
     */
    public void addZipEntry(String content, ZipOutputStream zos, String entryName)
    {
        final byte [] data = new byte[BUFFER_SIZE]; 
        int len; 
        int lenTotal = 0;
        try {

            final InputStream is = new ByteArrayInputStream(content.getBytes(StandardCharsets.UTF_8));

            final ZipEntry entry = new ZipEntry(entryName); 
            zos.putNextEntry(entry); 

            final CRC32 crc32 = new CRC32(); 
            while ((len = is.read(data)) > -1){ 
                zos.write(data, 0, len); 
                crc32.update(data, 0, len);
                lenTotal += len;
            } 

            entry.setSize(lenTotal); 
            entry.setTime(System.currentTimeMillis()); 
            entry.setCrc(crc32.getValue());

        }
        catch (IOException ioe){
            ioe.printStackTrace();
        }
        finally{
            try { zos.closeEntry();} catch (IOException e) {}
        }
    }

} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-26T10:25:36.540

单击此处获取[带有源代码的工作示例](http://dinoch.dyndns.org:7070/WordML/AboutWordML.jsp)。此示例基于模板概念从 Java 生成 MS-Word 文档。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-30T09:16:29.880

[Office Writer](http://officewriter.softartisans.com/officewriter-240.aspx) would be a better tool to use than POI for your requirement.

If all you want is a simple table without too much of formatting, I would use this simple trick. Use Java to generate the table as HTML using plain old table,tr,td tags and copy the rendered HTML table into the word document ;)

# java - 如何在 Eclipse 中强制执行包级构建顺序

> ID：399760
> 
> 赞同：1
> 
> 时间：2008-12-30T08:10:43.630
> 
> 标签：java, eclipse, ide

说明：假设总是先构建包 A，然后再构建包 B。我需要配置我的 Eclipse 工作区，使其模仿构建环境并在包 A 中的源引用包 B 时显示编译错误。这可能吗？如果是，如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-30T08:14:45.667

您需要将它们构建为单独的项目，项目 B 指的是项目 A，但不是相反。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-31T21:21:52.910

如果您想要更严格的执行，您可以让您的项目成为 OSGi 捆绑包/Eclipse 插件。这允许您指定从包中导出哪些包，甚至可以指定只有特定包可以访问某些包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T11:14:59.220

看看：[Arquitecture Rules](http://architecturerules.googlecode.com/svn/docs/downloads.html)或[Macker](http://innig.net/macker/)

这些工具能够在违反某些规则时向您发出警告。它们都支持“某些包不应调用其他包”的规则。

我不知道是否有任何一个 Eclipse 插件，对不起。

# visual-studio - Visual Studio：将视图代码设为默认值

> ID：399768
> 
> 赞同：149
> 
> 时间：2008-12-30T08:18:25.987
> 
> 标签：visual-studio

有没有办法让 Visual Studio 默认显示控件/表单的代码而不是设计器？我往往不是设计师的粉丝，因为他们会增加臃肿感。

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2008-12-30T08:22:10.097

右键单击文件并选择“打开方式...”

选择“CSharp 编辑器”，然后单击“设置为默认值”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-02-14T23:35:45.043

用 [System.ComponentModel.DesignerCategory("")] 装饰你的班级，例如：

```
[System.ComponentModel.DesignerCategory("")]
public class MySpecialButton : System.Windows.Forms.Button
{
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-04-07T18:03:23.253

我喜欢在设计视图中打开我的表单，但我制作了一个只有代码的部分类文件，而 Visual Studio 一直想在设计视图中打开它。为防止 Visual Studio 意识到 Designer 可以加载特定的源文件，请查看 csproj 文件中相应源文件的 Compile Include 标记并删除其下方的 SubType 标记。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-01-24T18:28:10.193

我最近自己遇到了这个问题，上述解决方案并没有解决我的问题。我需要进入`Tools | Options`并更改`HTML Designer`to`Enable HTML designer`和 select的设置`Start pages in: Source View`。

![设置截图](https://i.stack.imgur.com/ZTd83.png)

# windows - 开发人员是否应该担心对其工作站软件/开发堆栈的更新？

> ID：399770
> 
> 赞同：8
> 
> 时间：2008-12-30T08:18:55.003
> 
> 标签：windows, linux, macos, maintenance

正如我发现的那样，许多开发人员避免进行任何更新（自动或手动），因为他们担心这可能会对他们不了解的机器进行更改，并且他们正在开发的软件可能会在某些时候由于他们不知道的原因而失败.

策略 A.) 尽可能长时间地保持系统不变。

我个人喜欢让我的系统尽可能“最新”（操作系统和应用程序），因为通常我觉得以这种方式工作的麻烦更少。

策略 B.) 始终保持最新

你是什​​么类型的开发者？为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T08:36:26.653

B. 绝对。

如果您正在开发一个更新谱系不确定的平台（例如 The Real World），那么虚拟机是一个重要的武器，但在发布时尽可能保持最新是值得的。

告诉您的用户“只需运行更新”要比尝试猜测他们可能拥有哪些补丁历史记录导致问题（或至少能够排除它）要容易得多。

如果您正在为纯粹的内部受众开发，那么您实际上只有一个问题：

*   公司有更新时间表吗？
    *   是的：那么您需要确保您的软件在生产环境和即将出现的任何东西上都运行
    *   不：可能最好解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T08:23:06.693

不。

这就是上帝发明虚拟机的原因。

不过，如果你是一名 OS X 程序员，那就有点遗憾了，因为操作系统中基于硬件的复制保护（你必须在 Apple 支持的硬件上运行）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-30T08:30:06.617

尽可能使操作系统保持最新，最好在将补丁发布给公司其他部门之前进行系统管理员测试。

相当快地应用开发环境服务包，但首先检查虚拟机，以便您可以查看构建是否仍然有效，然后在升级开发机器之前将该​​构建提供给 QA 进行冒烟测试。

当您看到真正的好处时，更改开发环境（和/或平台，例如从 Java 5 升级到 Java 6），但允许将其作为具有预算时间的明确任务。理想情况下，预算项目时间以使开发人员也加快速度，以便他们能够充分利用它。不要在发布附近的任何时候这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T09:15:16.497

您正在编写的软件的目标机器与您的开发机器几乎不会发生相同的情况。因此，不更新并使机器保持静止没有多大意义。

现在，目标机器..这是一个不同的故事。只要不是绝对必要，我不希望进行任何更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T08:24:14.913

一朝被蛇咬十年怕井绳。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T08:29:56.493

前几天在我的工作中发生了一个很好的例子。IT 团队对我们的开发服务器进行了更新，起初这似乎是无害的。该机器有一个无人值守的登录，必须保持 24/7 登录。Windows 的更新（我必须提取 KB）实际上会自动注销该类型的用户。我们在服务器上运行的应用程序需要有人参与的登录才能运行（是的，我知道这很傻，但那是另一回事了）。突然间，我们的系统开始出现问题，抱怨说一些正在使用的软件系统无法正常工作。

我们追踪了问题并重新登录了管理员用户，但直到大约 3 次由 Windows 引起的注销后，我们才真正意识到发生了什么。幸运的是没有造成太大的损失，但这确实意味着有些人不得不加班。

在推出更新之前，应该检查它们可能对您的操作系统产生什么样的环境影响，即使这样，也应该对其进行测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-30T11:06:21.250

B、出于安全原因。

但是，您应该在多大程度上关心应用程序中的破坏，这在很大程度上取决于您正在进行的开发类型。通常的情况几乎就像针对不同目标的交叉编译，因为几乎没有任何用户机器像开发机器那样配置。

如果它是一个 Web 应用程序，那么您的“平台”就是浏览器以及您使用的任何服务器端。对我来说，就是 ruby​​、rails 和插件以及 apache/mysql 等。客户端，我无法控制。服务器端，我想至少应用安全补丁*（除了：请求服务器端开发人员，请在不同的周期发布安全补丁以进行功能更改！）。*. 但是操作系统更新通常对我正在使用的开发服务器堆栈几乎没有影响，而且无论如何我的部署环境使用不同的操作系统（我在 OSX 和 Ubuntu 上开发并在 Debian 和 Solaris 上部署）。

如果它是桌面应用程序，那么它取决于您与平台的集成程度以及您是否可以在目标环境中控制它。由于我通常使用 Java，我认为它是平台而不是操作系统，尽管它确实需要在不同的操作系统风格和 Java 版本上进行测试。如果操作系统的某些补丁破坏了 Java，那么这是一个单独的问题。

如果您与操作系统的耦合非常紧密，那么更新依赖项很难测试，并且如果不大量使用虚拟机和快照等几乎是不可能的。此外，如果您在操作系统更改方面非常脆弱，您的应用程序可能会如果您的目标机器具有不同的软件负载或不同的配置，则失败 - 再次很难测试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-30T08:20:37.247

操作系统：最新（尽管我对此并不狂热）。

小型应用程序：没有那么多。我对更新持谨慎态度，除非对我有一些附加价值，否则我不会升级。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-30T08:24:19.063

进行更新，但不要在开发周期的关键时期进行。使用已知尽可能稳定的操作系统发行版，并且在发布更新的频率上保持保守。

强制您的开发人员在他们即将进行签入时测试他们的代码。确保在他们进行升级之前所有测试都通过。这样可以确保他们对正在破坏的内容有所了解。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-30T14:08:07.497

有很多东西要看（我是根据 linux/unix 经验写的，但也应该适用于其他操作系统）：

*   请注意损坏的更新。损坏的更新发生了，让其他人遭受损坏是明智的。特别注意核心组件，例如 c 库（包括通常包含的 OS 接口）、链接器、编译器等。
*   应该谨慎地为您的产品更新组件库（或首先在测试系统/虚拟机上）。诸如 C 库之类的高度使用的库通常是可以的，但较少使用的库可能包含 API 中断或 API 中的语义更改。
*   编写您的软件以适应其环境：
    *   最好使用各种不同配置的系统来编写
    *   在不假设环境属性的情况下编写
    *   在需要时更新系统，如果出现问题，可以找到根本原因并消除它。
    *   除了刚性成本之外，还要特别警惕依赖于复杂系统的构建系统（它们比简单（或自动化）的构建系统需要更多的维护）。

我知道类似unix的系统比windows系统更具有独立的传统。这不会改变操作系统假设独立性的工程可靠性。所以我的建议是在新的更新可用后（通常不是第一天）尽快更新，但要确保如果事情真的发生故障，它可以很容易地回滚。如果项目中断，大多数开发人员会回滚，一个小团队致力于修复它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-31T12:03:08.217

有句老话。“永远不要改变正在运行的系统”。我猜关于悲惨更新的恐怖故事很多。我只能根据我的经验来判断。如果你的软件基于“挂得很好”的组件，那么破坏它们的可能性要比快速变化的情况小得多。举个例子：我们的 IDE 基于 Win API，自 Windows 3.1（开发它的地方）以来几乎没有变化，多年来我们添加了一些不错的功能，所以我敢打赌，该软件包至少需要 Windows 2000 才能运行。但我可以向您保证，它可以从 XP 到 Windwos NT、Windows 2000、Windows 2003、Windows XP、Windows 2003-64 和“非常闪亮”的 Vista 进行许多操作系统更新。

另一方面，我无法在 Linux 上了解它基于 gtk 的端口。API 的变化是极端的。所以这是我最讨厌开源支持者的地方，你被迫一遍又一遍地重做你的工作只是为了保持实际。

另一个例子让我至少花了一周的时间将一个非常小的 Rails 应用程序从 1.1.6 版更新到 2.2 版。（而且在短短两年内）。我担心这会是最糟糕的，但有点积极地感到惊讶。

问候

# javascript - Browsing with IE causes 'Error 80004004' in SignIn widget

> ID：399787
> 
> 赞同：0
> 
> 时间：2008-12-30T08:32:34.053
> 
> 标签：javascript, internet-explorer, movabletype

I am using Movable Type 4.23 and have been testing my site on a PC and discovered that Internet Explorer is unable to view my site due to a conflict in the javascript of the signin widget (initially I thought it was in the mt.js file).

I receive this error: `Error 80004004` as well as in the Javascript itself:

> "Element is not an object"
> 
> (or object is not an element?)

```
function mtUpdateSignInWidget(u) {
    var el = document.getElementById('signin-widget-content'); 
```

If I put in `id` where `sign-widget-content` goes, it will say it is not an object.

All other browsers work perfectly (Firefox, safari and opera on my mac and Firefox on PC). Any ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-14T07:59:33.833

此错误有两种可能性。

1) 没有您输入的 ID 元素。检查以确保 ID 完全正确，包括正确的大小写字母。

2) 元素确实存在，但 JavaScript 在它呈现在您的文档中之前正在运行。对元素的调用应该总是在它们出现在页面上之后发生。

# php - PHP calling multiple videos to convert at once via mencoder.How can I limit it?

> ID：399791
> 
> 赞同：1
> 
> 时间：2008-12-30T08:37:22.873
> 
> 标签：php, concurrency, queue, semaphore

I recently installed my video script to a new server but I am seeing that it will start to convert 1 video (via mencoder) then before finishing it, it will try and convery another, and another, so it will be trying to convert 4+ videos at the same time causing the server to shut down. The script developer said:

"It converts each video in a PHP background process. There might be a way to limit the number of PHP background processes on your server and queue them."

So how is this done please?

Regards

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T08:54:46.397

# Use [PHP Semaphores](http://in.php.net/sem)

You can use a shared counting Semaphore in PHP, and implement a queue with a cap on the no. of parallel executions. Semaphores are always the most recommended method for any form of concurrency control.

Using this you can easily configure and control the parallel executions of *mencoder*, and limit them as well.

* * *

## Pseudocode

```
Begin
    init sem=MAX;

    wait(sem) //sem--, waits if sem=0, till atleast one process comes out of the critical section
    /*
        Critical Section
        where you execute mencoder
    */
    signal(sem) //sem++
End 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T08:43:16.077

Use some sort of lock. For example, use file locking on a directory so only one process at a time can use the resource.

This would require a wrapper script for the encoder which will wait for the lock to be released by the currently running encoder.

It should also be smart enough to detect when a lock wasn't freed if the encoder crashes, and release the lock.

Edit: My understanding of the problem was there were multiple invocations of the script, each calling mencoder. However, from the other response, it seems that it might be one invocation running all the processes in the background. Then I think the solution using Semaphores is better.

Edit: Looks like someone asked this question before:

[best-way-to-obtain-a-lock-in-php](https://stackoverflow.com/questions/325806/best-way-to-obtain-a-lock-in-php)

# c++ - 无意中使用 = 而不是 ==

> ID：399792
> 
> 赞同：11
> 
> 时间：2008-12-30T08:39:52.073
> 
> 标签：c++, c, compiler-construction, programming-languages

看起来

```
if (x=y) { .... } 
```

代替

```
if (x==y) { ... } 
```

是万恶之源。

为什么不是*所有*的编译器都*将其标记为错误*而不是可配置的警告？

我有兴趣找出构造`if (x=y)`有用的情况。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-30T08:45:53.763

例如，一种有用的结构是：

```
char *pBuffer;
if (pBuffer = malloc(100))
{
    //continue to work here
} 
```

编辑：
如前所述，现在被多次否决，我可能会补充说这不是特别好的风格，但经常看到它可以说它很有用。我也见过这种情况`new`，但它使我的胸部更加疼痛。

另一个争议较小的例子可能是：

```
while (pointer = getNextElement(context))
{
    //go for it, use the pointer to the new segment of data
} 
```

这意味着函数在没有下一个元素时`getNextElement()`返回，从而退出循环。`NULL`

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-30T08:57:43.503

大多数时候，编译器都非常努力地保持向后兼容。

改变他们在这件事上的行为以抛出错误将破坏现有的合法代码，甚至开始抛出有关它的警告也会导致自动系统出现问题，这些系统通过自动编译并检查错误和警告来跟踪代码。

这是一个我们几乎被 atm 困住的邪恶，但有一些方法可以规避和减少它的危险。

例子：

```
 void *ptr = calloc(1, sizeof(array));
   if (NULL = ptr) {
       // some error
   } 
```

这会导致编译错误。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-12-30T09:16:01.173

简单回答：赋值操作，比如x=y，有一个值，和x中新赋值的值是一样的。您可以直接在比较中使用它，所以而不是

> `x = y; if (x) ...`

你可以写

> `if (x = y) ...`

编写（和阅读）的代码更少，这有时是一件好事，但现在大多数人都同意应该以其他方式编写它以提高可读性。例如像这样：

> `if ((x = y) != 0) ...`

这是一个现实的例子。假设你想用 malloc 分配一些内存，看看它是否有效。可以这样一步一步写：

> `p = malloc(4711); if (p != NULL) printf("Ok!");`

与 NULL 的比较是多余的，因此您可以像这样重写它：

> `p = malloc(4711); if (p) printf("Ok!");`

但是由于赋值操作有一个可以使用的值，你可以把整个赋值放在 if 条件中：

> `if (p = malloc(4711)) printf("Ok!");`

这做同样的事情，但更简洁。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-30T08:46:08.240

因为它不是非法的（无论如何在 C 或 C++ 中）并且有时很有用......

```
if ( (x = read(blah)) > 0)
{
    // now you know how many bits/bytes/whatever were read
    // and can use that info. Esp. if you know, say 30 bytes
    // are coming but only got 10
} 
```

如果您无论如何都不在赋值周围加上括号，大多数编译器都会发出真正的恶臭，我喜欢这一点。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-30T15:58:26.807

## 关于 if(i = 0) 的有效用途

问题是你把问题颠倒了。“if”表示法不是像在其他一些语言中那样比较两个值。

C/C++“if”指令等待任何将评估为布尔值或空/非空值的表达式。该表达式可以包括两个值的比较，和/或可以更复杂。

例如，您可以拥有：

```
if(i >> 3)
{
   std::cout << "i is less than 8" << std::endl
} 
```

这证明，在 C/C++ 中，if 表达式不限于 == 和 =。任何事情都可以，只要它可以被评估为真或假 (C++)，或零非零 (C/C++)。

另一个 C++ 有效用途：

```
if(MyObject * pObject = dynamic_cast<MyInterface *>(pInterface))
{
   pObject->doSomething() ;
} 
```

这些是 if 表达式的简单用法（请注意，这也可以在 for 循环声明行中使用）。确实存在更复杂的用途。

## [关于 C++ 中 if(i = 0) 的高级用法 [引自我自己]](https://stackoverflow.com/questions/3122284/in-which-case-ifab-is-a-good-idea/3122462#3122462)

在发现此问题的重复项后[在哪种情况下 if(a=b) 是个好主意？](https://stackoverflow.com/questions/3122284/)，我决定用一个额外的好处来完成这个答案，即变量注入一个范围，这在 C++ 中是可能的，因为`if`它将评估它的表达式，包括一个变量声明，而不是像在其他语言：

所以，[引用我自己的话](https://stackoverflow.com/questions/3122284/in-which-case-ifab-is-a-good-idea/3122462#3122462)：

另一种用途是使用所谓的 C++ 变量注入。在 Java 中，有一个很酷的关键字：

```
synchronized(p)
{
   // Now, the Java code is synchronized using p as a mutex
} 
```

在 C++ 中，您也可以这样做。我没有记住确切的代码（也没有我发现它的确切 DDJ 文章），但是这个简单的定义应该足以用于演示目的：

```
#define synchronized(lock) \
   if (auto_lock lock_##__LINE__(lock))

synchronized(p)
{
   // Now, the C++ code is synchronized using p as a mutex
} 
```

这是相同的方式，将注入与 if 和 for 声明混合，您可以声明一个原始的 foreach 宏（如果您想要一个工业强度的 foreach，请使用 boost's）。

请参阅以下文章，了解更简单、更完整和更健壮的实现：

*   [http://www.drdobbs.com/184401723?pgno=6](http://www.drdobbs.com/184401723?pgno=6)
*   [http://www.drdobbs.com/184401728](http://www.drdobbs.com/184401728)
*   [http://www.drdobbs.com/184401752](http://www.drdobbs.com/184401752)

## 真正发生了多少此类错误？

很少。事实上，我还没有记住一个，我是专业的 8 年。我猜它确实发生了，但是在 8 年内，我确实产生了大量的错误。只是这种错误的发生还不足以让我沮丧地记住它们。

在 C 中，由于缓冲区溢出，您将遇到更多错误，例如：

```
void doSomething(char * p)
{
   strcpy(p, "Hello World, how are you \?\n") ;
}

void doSomethingElse()
{
   char buffer[16] ;
   doSomething(buffer) ;
} 
```

事实上，微软被烧死了，因为他们在 Visual C++ 2008 中添加了一个警告，弃用 strcpy !!!

## 如何避免大多数错误？

针对这个错误的第一个“保护”是“扭转”这个表达式：因为你不能给一个常量赋值，所以这个：

```
if(0 = p) // ERROR : It should have been if(0 == p). WON'T COMPILE ! 
```

不会编译。

但我发现这是一个非常糟糕的解决方案，因为它试图隐藏应该是一般编程实践的风格，即：任何不应该改变的变量都应该是常量。

例如，而不是：

```
void doSomething(char * p)
{
   if(p == NULL) // POSSIBLE TYPO ERROR
      return ;

   size_t length = strlen(p) ;

   if(length == 0) // POSSIBLE TYPO ERROR
      printf("\"%s\" length is %i\n", p, length) ;
   else
      printf("the string is empty\n") ;
} 
```

尝试“const”尽可能多的变量将使您避免大多数拼写错误，包括那些不在“if”表达式中的错误：

```
void doSomething(const char * const p) // CONST ADDED HERE
{
   if(p == NULL) // NO TYPO POSSIBLE
      return ;

   const size_t length = strlen(p) ; // CONST ADDED HERE

   if(length == 0) // NO TYPO POSSIBLE
      printf("\"%s\" length is %i\n", p, length) ;
   else
      printf("the string is empty\n") ;
} 
```

当然，这并不总是可能的（因为某些变量确实需要更改），但我发现我使用的大多数变量都是常量（我一直初始化它们一次，然后只读取它们）。

## 结论

通常，我看到代码使用 if(0 == p) 表示法，但没有 const 表示法。

对我来说，这就像有一个垃圾桶用于可回收物，另一个用于不可回收物，然后将它们一起扔到同一个容器中。

所以，不要模仿简单的风格习惯，希望它能让你的代码变得更好。它不会。尽可能多地使用语言结构，这意味着，在这种情况下，在可用时同时使用 if(0 == p) 表示法，并尽可能多地使用 const 关键字。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-12-30T09:23:54.247

'if(0 = x)' 习语几乎没用，因为当双方都是变量（'if(x = y)'）并且大多数（全部？）你应该使用常量变量时​​它没有帮助而不是幻数。

我从不使用这个成语的另外两个原因，恕我直言，它使代码的可读性降低，老实说，我发现单个 '=' 是很少邪恶的根源。如果您彻底测试您的代码（显然我们都这样做），这种语法错误会很快出现。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-12-30T09:23:33.687

用于迭代的标准 C 习惯用法：

```
list_elem* curr;
while ( (curr = next_item(list)) != null ) {
  /* ... */
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-12-30T08:48:02.697

许多编译器会检测到这一点并向您发出警告，但前提是您将警告级别设置得足够高。

例如：

```
~> gcc -c -Wall foo.c
foo.c：在函数“foo”中：
foo.c:5：警告：建议在赋值周围使用括号作为真值

```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-12-30T09:04:20.950

这真的是一个常见的错误吗？我是在自己学习 C 时了解到的，作为一名老师，我偶尔会警告我的学生并告诉他们这是一个常见的错误，但我很少在实际代码中看到它，即使是初学者也是如此。当然不会比其他运算符错误更频繁，例如写“&&”而不是“||”。

因此，编译器不将其标记为错误（除了它是完全有效的代码）的原因可能是它*不是*很多罪恶的根源。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-30T08:58:54.640

这取决于语言。Java 将其标记为错误，因为在 if 括号内只能使用布尔表达式（除非两个变量是布尔值，在这种情况下，赋值也是布尔值）。

在 C 中，测试 malloc 返回的指针或者在 fork 之后我们处于父进程或子进程中时，这是一个非常常见的习惯用法：

```
if ( x = (X*) malloc( sizeof(X) ) {
   // malloc worked, pointer != 0

if ( pid = fork() ) {
   // parent process as pid != 0 
```

如果您要求，C/C++ 编译器将以足够高的警告级别发出警告，但由于语言允许，因此不能将其视为错误。除非再次要求编译器将警告视为错误。

每当与常量比较时，一些作者建议使用测试*常量*==*变量*，以便编译器检测用户是否忘记了第二个等号。

```
if ( 0 == variable ) {
   // the compiler will complaint if you mistakenly 
   // write =, as you cannot assign to a constant 
```

无论如何，您应该尝试使用尽可能高的警告设置进行编译。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-30T14:49:52.327

*我认为 C 和 C++ 语言设计者注意到禁止*它并没有真正的用处，因为

*   编译器可以根据需要发出警告
*   禁止它会在语言中添加特殊情况，并会删除可能的功能。

允许它不涉及复杂性。C++ 只是说需要一个可隐式转换为的表达式`bool`。在 C 中，其他答案详细说明了有用的案例。在 C++ 中，他们更进了一步，还允许这样做：

```
if(type * t = get_pointer()) {
    // ....
} 
```

这实际上将 t 的范围限制为 if 及其主体。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-12-30T10:44:09.047

尝试查看

```
if( life_is_good() )
    enjoy_yourself(); 
```

作为

```
if( tmp = life_is_good() )
    enjoy_yourself(); 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-12-30T15:31:52.447

部分原因与个人风格和习惯有关。我不知道是否阅读 if (kConst == x) 或 if (x == kConst)。我不使用左侧的常量，因为从历史上看，我不会犯那个错误，我会按照我所说的或想阅读的方式编写代码。我认为这是一个个人决定，是作为一个有自我意识、不断改进的工程师的个人责任的一部分。例如，我开始分析我正在创建的错误类型，并开始重新设计我的习惯以避免它们 - 类似于左侧的常量，只是与其他事情。

也就是说，从历史上看，编译器警告非常糟糕，尽管这个问题已经众所周知多年，但直到 80 年代后期我才在生产编译器中看到它。我还发现从事可移植项目有助于清理我的 C 语言，因为不同的编译器和不同的品味（即警告）和不同的细微语义差异。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-12-30T15:32:46.453

在条件语句中赋值运算符有很多很好的用途，而且总是看到关于每个运算符的警告会让人头疼。如果你的 IDE 中有一个函数可以让你突出显示所有使用赋值而不是相等性检查的地方 - 或者 - 在你写了这样的东西之后，那就更好了：

```
if (x = y) { 
```

然后那条线会闪烁​​几次。足以让你知道你做了一些不*完全*标准的事情，但也没有那么烦人。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-12-30T15:45:58.050

我个人认为这是最有用的例子。

假设您有一个`read()`返回读取字节数的函数，您需要在循环中使用它。使用起来简单多了

```
while((count = read(foo)) > 0) {
    //Do stuff
} 
```

而不是尝试将分配从循环头中取出，这将导致类似的事情

```
while(1) {
    count = read(foo);
    if(!(count > 0))
        break;
    //...
} 
```

或者

```
count = read(foo);
while(count > 0) {
    //...
    count = read(foo);
} 
```

第一个结构感觉很尴尬，第二个结构以一种不愉快的方式重复代码。

当然，除非我为此错过了一些绝妙的成语……

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-12-30T16:03:27.903

条件赋值是合法的 C 和 C++，任何不允许它的编译器都不是真正的 C 或 C++ 编译器。我希望任何不是设计为与 C 明确兼容的现代语言（就像 C++ 一样）都会认为这是一个错误。

在某些情况下，这允许简洁的表达式，例如`while (*dest++ = *src++);`在 C 中复制字符串的惯用语，但总的来说它不是很有用，我认为这是语言设计中的错误。根据我的经验，很容易犯这个错误，而且当编译器不发出警告时很难发现。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-07-09T18:44:39.673

```
 if ((k==1) || (k==2)) is a conditional
 if ((k=1)  || (k=2) ) is BOTH a conditional AND an assignment statement 
```

*   这是解释*

像大多数语言一样，C 按照运算符优先级从最内到最外工作。

首先它尝试将 k 设置为 1，并成功。

```
Result: k = 1 and Boolean = 'true' 
```

下一步：它将 k 设置为 2，并成功。

```
Result: k = 2 and Boolean = 'true' 
```

下一步：它评估 (true || true)

```
Result: k still = 2, and Boolean = true 
```

最后，它然后解决条件：如果（真）

```
 Result: k = 2 and the program takes the first branch. 
```

在近 30 年的编程生涯中，我没有看到使用这种结构的正当理由，尽管如果存在这种结构，它可能与故意混淆代码的需要有关。

当我们的一个新人遇到问题时，这就是我要寻找的东西之一，就在不将终止符粘贴在字符串上，将调试语句从一个地方复制到另一个地方并且不将 '%i 更改为' %s' 以匹配他们正在转储的新字段。

这在我们的商店中相当普遍，因为我们经常在 C 和 Oracle PL/SQL 之间切换；if( k = 1) 是 PL/SQL 中的正确语法。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-12-30T09:16:47.850

你问它为什么有用，但不断质疑人们提供的例子。它很有用，因为它简洁。

是的，所有使用它的示例都可以重写——作为更长的代码。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-12-30T09:17:34.587

有几种策略可以帮助发现这一点.. 一种很丑陋，另一种通常是宏。这实际上取决于您如何阅读口语（从左到右，从右到左）。

例如：

```
if ((fp = fopen("foo.txt", "r") == NULL)) 
```

对比：

```
if (NULL == (fp = fopen(...))) 
```

有时，读/写（首先）你的测试内容会更容易，这使得更容易发现作业与测试。然后引入大多数对这种风格充满热情的 comp.lang.c 人。

所以，我们引入[assert](http://en.wikipedia.org/wiki/Assertion_(computing)) ()：

```
#include <assert.h>

...
fp = fopen("foo.txt", "r");
assert(fp != NULL);
... 
```

当您处于一组复杂的条件句的中间或结尾时，assert() 是您的朋友。在这种情况下，如果 FP == NULL，则会引发 abort() 并传达违规代码的行/文件。

所以，如果你哎呀：

```
if (i = foo) 
```

安装的

```
if (i == foo) 
```

其次是

```
assert (i > foo + 1) 
```

...您会很快发现此类错误。

希望这可以帮助 ：）

简而言之，在调试时，颠倒参数有时会有所帮助.. assert() 是您的长期朋友，并且可以在生产版本的编译器标志中关闭。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-12-30T09:32:49.690

这在 C/C++ 中的“低级”循环结构中很常见，例如副本：

```
void my_strcpy(char *dst, const char *src)
{
    while((*dst++ = *src++) != '\0') { // Note the use of extra parentheses, and the explicit compare.
        /* DO NOTHING */
    }
} 
```

当然，赋值在 for 循环中很常见：

```
int i;
for(i = 0; i < 42; ++i) {
    printf("%d\n", i);
} 
```

我确实相信当它们在语句*之外*时更容易阅读作业`if`：

```
char *newstring = malloc(strlen(src) * sizeof(char));
if(newstring == NULL) {
    fprintf(stderr, "Out of memory, d00d!  Bailing!\n");
    exit(2);
}

// Versus:

if((newstring = malloc(strlen(src) * sizeof(char))) == NULL) // ew... 
```

确保分配是显而易见的，虽然（与前两个示例一样）。不要隐藏它。

至于意外使用......这在我身上并没有发生太多。一个常见的保护措施是将变量（左值）放在比较的右侧，但这不适用于以下情况：

```
if(*src == *dst) 
```

因为两个操作数都是左值`==`！

至于编译器……谁能责怪他们？编写编译器很困难，无论如何你都应该为编译器编写完美的程序（还记得 GIGO 吗？）。一些编译器（肯定是最著名的）提供内置的`lint`-style 检查，但这当然不是必需的。一些浏览器不会验证它抛出的 HTML 和 Javascript 的每个字节，那么编译器为什么要验证呢？

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2008-12-30T15:06:05.493

在我 15 年的开发中，我只遇到过一次这个错字。我不会说它在我需要注意的事项清单的首位。无论如何，我也避免使用这种结构。

另请注意，某些编译器（我使用的编译器）会对该代码发出警告。对于任何有价值的编译器，警告都可以被视为错误。它们也可以被忽略。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2008-12-30T15:13:41.483

将常数放在比较的左侧是防御性编程。当然，您永远不会犯忘记那个额外的“=”的愚蠢错误，但谁知道另一个人。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-12-30T15:18:58.603

D 编程语言确实将此标记为错误。为了避免以后想要使用该值的问题，它允许声明有点像 C++ 允许的`for`循环。

```
if(int i = some_fn())
{
   another_fn(i);
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2008-12-30T16:14:55.290

编译器不会将其标记为错误，因为它是有效的 C/C++。但是您可以做的（至少使用 Visual C++）是提高警告级别，以便将其标记为警告，然后告诉编译器将警告视为错误。无论如何，这是一个很好的做法，这样开发人员就不会忽略警告。

如果您实际上是指 = 而不是 == 那么您需要更明确地说明它。例如

```
if ((x = y) != 0) 
```

从理论上讲，您应该能够做到这一点：

```
if ((x = y)) 
```

覆盖警告，但这似乎并不总是有效。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-12-30T10:55:36.747

在实践中我不这样做，但一个好的提示是：

```
if ( true == $x ) 
```

如果你遗漏了一个等号，分配`$x`给`true`显然会返回一个错误。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-12-30T15:24:32.850

正如在其他答案中所指出的那样，在某些情况下，在条件中使用赋值会提供一段简短但可读的代码，可以满足您的需求。此外，如果许多最新的编译器在期望条件的位置看到分配，它们会警告您。（如果你是零警告开发方法的粉丝，你会看到这些。）

我养成的一个让我不会被这个问题困扰的习惯（至少在 C-ish 语言中）是，如果我要比较的两个值之一是常量（或者不是合法的左值），我把它在比较器的左侧：`if (5 == x) { whatever(); }` 然后，如果我不小心键入`if (5 = x)`，代码将无法编译。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2010-06-26T10:49:49.177

正则表达式示例

```
正则表达式 r;

if(((r = new RegEx("\w*)).IsMatch()) {
   // ... 在这里做点什么
}
否则 if((r = new RegEx("\d*")).IsMatch()) {
   // ... 在这里做点什么
}

```

分配价值测试

```
诠释 i = 0;
如果（（我 = 1）== 1）{
   // 1 等于分配给 int 值 1 的 i
}
别的 {
   // ?
}

```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2008-12-30T09:00:14.437

这就是为什么最好写：

0 == 当前项

代替：

当前项目 == 0

这样编译器会在您键入 = 而不是 == 时发出警告。

# c# - String.Replace .NET Framework 的内存效率和性能

> ID：399798
> 
> 赞同：41
> 
> 时间：2008-12-30T08:43:59.740
> 
> 标签：c#, .net, string

```
 string str1 = "12345ABC...\\...ABC100000"; 
 // Hypothetically huge string of 100000 + Unicode Chars
 str1 = str1.Replace("1", string.Empty);
 str1 = str1.Replace("22", string.Empty);
 str1 = str1.Replace("656", string.Empty);
 str1 = str1.Replace("77ABC", string.Empty);

 // ...  this replace anti-pattern might happen with upto 50 consecutive lines of code.

 str1 = str1.Replace("ABCDEFGHIJD", string.Empty); 
```

我继承了一些与上面的代码片段相同的代码。它需要一个巨大的字符串并从大字符串中替换（删除）恒定的较小字符串。

我相信这是一个非常占用内存的过程，因为每次替换都会在内存中分配新的大型不可变字符串，等待通过 GC 死亡。

**1\. 忽略内存问题，替换这些值的最快方法是什么？**

**2\. 达到相同结果的最节省内存的方法是什么？**

我希望这些是相同的答案！

适合介于这些目标之间的实用解决方案也值得赞赏。

假设：

*   所有的替换都是不变的并且是预先知道的
*   底层字符确实包含一些 unicode [non-ascii] 字符

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-30T08:52:32.673

*.NET 字符串中的所有*字符都是“unicode chars”。你的意思是他们不是ASCII？这不应该有任何可能性 - 除非您遇到构图问题，例如，当您尝试替换“e 锐音”时，“e + 锐音”没有被替换。

您可以尝试使用带有[`Regex.Replace`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.replace.aspx), 或的正则表达式[`StringBuilder.Replace`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.replace.aspx)。这是对两者执行相同操作的示例代码：

```
using System;
using System.Text;
using System.Text.RegularExpressions;

class Test
{
    static void Main(string[] args)
    {
        string original = "abcdefghijkl";

        Regex regex = new Regex("a|c|e|g|i|k", RegexOptions.Compiled);

        string removedByRegex = regex.Replace(original, "");
        string removedByStringBuilder = new StringBuilder(original)
            .Replace("a", "")
            .Replace("c", "")
            .Replace("e", "")
            .Replace("g", "")
            .Replace("i", "")
            .Replace("k", "")
            .ToString();

        Console.WriteLine(removedByRegex);
        Console.WriteLine(removedByStringBuilder);
    }
} 
```

我不想猜测哪个更有效 - 您必须使用您的特定应用程序进行基准测试。正则表达式方法可能能够一次性完成所有操作，但与 StringBuilder 中的许多替换中的每一个相比，该通道将是相对 CPU 密集型的。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-12-30T11:30:23.463

如果你想变得非常快，我的意思是非常快，你将不得不超越 StringBuilder 并编写优化好的代码。

您的计算机不喜欢做的一件事是分支，如果您可以编写一个在固定数组 (char *) 上操作并且不分支的替换方法，那么您的性能就会很好。

您将要做的是替换操作将搜索一系列字符，如果找到任何这样的子字符串，它将替换它。实际上，您将复制字符串，并在这样做时执行查找和替换。

您将依靠这些函数来选择要读/写的某个缓冲区的索引。目标是执行替换方法，以便在无需更改任何内容时编写垃圾而不是分支。

您应该能够在没有单个 if 语句的情况下完成此操作，并记住使用不安全的代码。否则，您将为每个元素访问的索引检查付费。

```
unsafe
{
    fixed( char * p = myStringBuffer )
    {
        // Do fancy string manipulation here
    }
} 
```

我用 C# 编写这样的代码是为了好玩，并且看到了显着的性能改进，查找和替换的速度几乎提高了 300%。虽然 .NET BCL（基类库）执行得非常好，但它充满了分支结构和异常处理，如果您使用内置的东西，这会减慢您的代码速度。此外，这些优化虽然完美，但并非由 JIT 编译器执行，您必须在没有附加任何调试器的情况下将代码作为发布版本运行，才能观察到巨大的性能提升。

我可以为您提供更完整的代码，但这是大量的工作。但是，我可以向您保证，它会比迄今为止建议的任何其他方法更快。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-30T08:48:03.710

字符串生成器：http : [//msdn.microsoft.com/en-us/library/2839d5h5.aspx](http://msdn.microsoft.com/en-us/library/2839d5h5.aspx)

Replace 操作本身的性能应该与 string.Replace 大致相同，并且根据 Microsoft 的说法，应该不会产生垃圾。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-05-18T23:05:48.833

这是一个快速基准...

```
 Stopwatch s = new Stopwatch();
        s.Start();
        string replace = source;
        replace = replace.Replace("$TS$", tsValue);
        replace = replace.Replace("$DOC$", docValue);
        s.Stop();

        Console.WriteLine("String.Replace:\t\t" + s.ElapsedMilliseconds);

        s.Reset();

        s.Start();
        StringBuilder sb = new StringBuilder(source);
        sb = sb.Replace("$TS$", tsValue);
        sb = sb.Replace("$DOC$", docValue);
        string output = sb.ToString();
        s.Stop();

        Console.WriteLine("StringBuilder.Replace:\t\t" + s.ElapsedMilliseconds); 
```

我在我的机器上没有看到太大的差异（string.replace 是 85 毫秒，而 stringbuilder.replace 是 80），这与“源”中大约 8MB 的文本相对...

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-31T16:25:11.047

**1\. 忽略内存问题，替换这些值的最快方法是什么？**

最快的方法是构建特定于您的用例的自定义组件。从 .NET 4.6 开始，BCL 中没有为多个字符串替换而设计的类。

如果您需要从 BCL 中快速获得一些东西，StringBuilder 是用于简单字符串替换的最快 BCL 组件。源代码可以在[这里](http://referencesource.microsoft.com/#mscorlib/system/text/stringbuilder.cs "这里")找到：替换单个字符串非常有效。仅当您确实需要正则表达式的模式匹配功能时才使用 Regex。即使在编译时，它也更慢且更麻烦。

**2\. 达到相同结果的最节省内存的方法是什么？**

最节省内存的方法是执行从源到目标的过滤流复制（如下所述）。内存消耗将仅限于您的缓冲区，但这将更加占用 CPU；根据经验，您将以 CPU 性能换取内存消耗。

**技术细节**

字符串替换很棘手。即使在可变内存空间中执行字符串替换（例如使用[StringBuilder](https://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx "字符串生成器")），它也很昂贵。如果替换字符串的长度与原始字符串不同，您将重新定位替换字符串后面的每个字符以保持整个字符串连续。这会导致大量内存写入，即使在[StringBuilder](https://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx "字符串生成器")的情况下，也会导致您在每次调用 Replace 时重写内存中的大部分字符串。

那么进行字符串替换的最快方法是什么？使用单遍编写新字符串：不要让您的代码返回并重新编写任何内容。写入比读取更昂贵。您将不得不自己编写代码以获得最佳结果。

**高内存解决方案**

我编写的类基于模板生成字符串。我将标记 ($ReplaceMe$) 放置在模板中，该模板标记了我稍后要插入字符串的位置。我在 XmlWriter 对主要是静态和重复的 XML 来说过于繁重的情况下使用它，并且我需要生成大型 XML（或 JSON）数据流。

该类通过将模板分成多个部分并将每个部分放入一个编号的字典中来工作。还列举了参数。将部件和参数插入新字符串的顺序放入一个整数数组中。生成新字符串时，将从字典中挑选部分和参数并用于创建新字符串。

它既不是完全优化的，也不是防弹的，但它非常适合从模板生成非常大的数据流。

**低内存解决方案**

您需要将源字符串中的小块读取到缓冲区中，使用优化的搜索算法搜索缓冲区，然后将新字符串写入目标流/字符串。这里有很多潜在的警告，但它会提高内存效率，并且对于动态且无法缓存的源数据（例如整页翻译或太大而无法合理缓存的源数据）是一种更好的解决方案。我没有这个方便的示例解决方案。

**示例代码**

*期望的结果*

```
<DataTable source='Users'>
  <Rows>
    <Row id='25' name='Administrator' />
    <Row id='29' name='Robert' />
    <Row id='55' name='Amanda' />
  </Rows>
</DataTable> 
```

*模板*

```
<DataTable source='$TableName$'>
  <Rows>
    <Row id='$0$' name='$1$'/>
  </Rows>
</DataTable> 
```

*测试用例*

```
class Program
{
  static string[,] _users =
  {
    { "25", "Administrator" },
    { "29", "Robert" },
    { "55", "Amanda" },
  };

  static StringTemplate _documentTemplate = new StringTemplate(@"<DataTable source='$TableName$'><Rows>$Rows$</Rows></DataTable>");
  static StringTemplate _rowTemplate = new StringTemplate(@"<Row id='$0$' name='$1$' />");
  static void Main(string[] args)
  {
    _documentTemplate.SetParameter("TableName", "Users");
    _documentTemplate.SetParameter("Rows", GenerateRows);

    Console.WriteLine(_documentTemplate.GenerateString(4096));
    Console.ReadLine();
  }

  private static void GenerateRows(StreamWriter writer)
  {
    for (int i = 0; i <= _users.GetUpperBound(0); i++)
      _rowTemplate.GenerateString(writer, _users[i, 0], _users[i, 1]);
  }
} 
```

*字符串模板源*

```
public class StringTemplate
{
  private string _template;
  private string[] _parts;
  private int[] _tokens;
  private string[] _parameters;
  private Dictionary<string, int> _parameterIndices;
  private string[] _replaceGraph;
  private Action<StreamWriter>[] _callbackGraph;
  private bool[] _graphTypeIsReplace;

  public string[] Parameters
  {
    get { return _parameters; }
  }

  public StringTemplate(string template)
  {
    _template = template;
    Prepare();
  }

  public void SetParameter(string name, string replacement)
  {
    int index = _parameterIndices[name] + _parts.Length;
    _replaceGraph[index] = replacement;
    _graphTypeIsReplace[index] = true;
  }

  public void SetParameter(string name, Action<StreamWriter> callback)
  {
    int index = _parameterIndices[name] + _parts.Length;
    _callbackGraph[index] = callback;
    _graphTypeIsReplace[index] = false;
  }

  private static Regex _parser = new Regex(@"\$(\w{1,64})\$", RegexOptions.Compiled);
  private void Prepare()
  {
    _parameterIndices = new Dictionary<string, int>(64);
    List<string> parts = new List<string>(64);
    List<object> tokens = new List<object>(64);
    int param_index = 0;
    int part_start = 0;

    foreach (Match match in _parser.Matches(_template))
    {
      if (match.Index > part_start)
      {
        //Add Part
        tokens.Add(parts.Count);
        parts.Add(_template.Substring(part_start, match.Index - part_start));
      }

      //Add Parameter
      var param = _template.Substring(match.Index + 1, match.Length - 2);
      if (!_parameterIndices.TryGetValue(param, out param_index))
        _parameterIndices[param] = param_index = _parameterIndices.Count;
      tokens.Add(param);

      part_start = match.Index + match.Length;
    }

    //Add last part, if it exists.
    if (part_start < _template.Length)
    {
      tokens.Add(parts.Count);
      parts.Add(_template.Substring(part_start, _template.Length - part_start));
    }

    //Set State
    _parts = parts.ToArray();
    _tokens = new int[tokens.Count];

    int index = 0;
    foreach (var token in tokens)
    {
      var parameter = token as string;
      if (parameter == null)
        _tokens[index++] = (int)token;
      else
        _tokens[index++] = _parameterIndices[parameter] + _parts.Length;
    }

    _parameters = _parameterIndices.Keys.ToArray();
    int graphlen = _parts.Length + _parameters.Length;
    _callbackGraph = new Action<StreamWriter>[graphlen];
    _replaceGraph = new string[graphlen];
    _graphTypeIsReplace = new bool[graphlen];

    for (int i = 0; i < _parts.Length; i++)
    {
      _graphTypeIsReplace[i] = true;
      _replaceGraph[i] = _parts[i];
    }
  }

  public void GenerateString(Stream output)
  {
    var writer = new StreamWriter(output);
    GenerateString(writer);
    writer.Flush();
  }

  public void GenerateString(StreamWriter writer)
  {
    //Resolve graph
    foreach(var token in _tokens)
    {
      if (_graphTypeIsReplace[token])
        writer.Write(_replaceGraph[token]);
      else
        _callbackGraph[token](writer);
    }
  }

  public void SetReplacements(params string[] parameters)
  {
    int index;
    for (int i = 0; i < _parameters.Length; i++)
    {
      if (!Int32.TryParse(_parameters[i], out index))
        continue;
      else
        SetParameter(index.ToString(), parameters[i]);
    }
  }

  public string GenerateString(int bufferSize = 1024)
  {
    using (var ms = new MemoryStream(bufferSize))
    {
      GenerateString(ms);
      ms.Position = 0;
      using (var reader = new StreamReader(ms))
        return reader.ReadToEnd();
    }
  }

  public string GenerateString(params string[] parameters)
  {
    SetReplacements(parameters);
    return GenerateString();
  }

  public void GenerateString(StreamWriter writer, params string[] parameters)
  {
    SetReplacements(parameters);
    GenerateString(writer);
  }
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-30T08:54:20.283

```
StringBuilder sb = new StringBuilder("Hello string");
sb.Replace("string", String.Empty);
Console.WriteLine(sb); 
```

[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)，一个可变字符串。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-08-01T10:28:19.927

这是我的[基准](https://dotnetfiddle.net/fOMb2r)：

```
using System;
using System.Diagnostics;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;

internal static class MeasureTime
{
    internal static TimeSpan Run(Action func, uint count = 1)
    {
        if (count <= 0)
        {
            throw new ArgumentOutOfRangeException("count", "Must be greater than zero");
        }

        long[] arr_time = new long[count];
        Stopwatch sw = new Stopwatch();
        for (uint i = 0; i < count; i++)
        {
            sw.Start();
            func();
            sw.Stop();
            arr_time[i] = sw.ElapsedTicks;
            sw.Reset();
        }

        return new TimeSpan(count == 1 ? arr_time.Sum() : Convert.ToInt64(Math.Round(arr_time.Sum() / (double)count)));
    }
}

public class Program
{
    public static string RandomString(int length)
    {
        Random random = new Random();
        const string chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
        return new String(Enumerable.Range(1, length).Select(_ => chars[random.Next(chars.Length)]).ToArray());
    }

    public static void Main()
    {
        string rnd_str = RandomString(500000);
        Regex regex = new Regex("a|c|e|g|i|k", RegexOptions.Compiled);
        TimeSpan ts1 = MeasureTime.Run(() => regex.Replace(rnd_str, "!!!"), 10);
        Console.WriteLine("Regex time: {0:hh\\:mm\\:ss\\:fff}", ts1);

        StringBuilder sb_str = new StringBuilder(rnd_str);
        TimeSpan ts2 = MeasureTime.Run(() => sb_str.Replace("a", "").Replace("c", "").Replace("e", "").Replace("g", "").Replace("i", "").Replace("k", ""), 10);
        Console.WriteLine("StringBuilder time: {0:hh\\:mm\\:ss\\:fff}", ts2);

        TimeSpan ts3 = MeasureTime.Run(() => rnd_str.Replace("a", "").Replace("c", "").Replace("e", "").Replace("g", "").Replace("i", "").Replace("k", ""), 10);
        Console.WriteLine("String time: {0:hh\\:mm\\:ss\\:fff}", ts3);

        char[] ch_arr = {'a', 'c', 'e', 'g', 'i', 'k'};
        TimeSpan ts4 = MeasureTime.Run(() => new String((from c in rnd_str where !ch_arr.Contains(c) select c).ToArray()), 10);
        Console.WriteLine("LINQ time: {0:hh\\:mm\\:ss\\:fff}", ts4);
    }

} 
```

> 正则表达式时间：00:00:00:008
> 
> StringBuilder 时间：00:00:00:015
> 
> 字符串时间：00:00:00:005

LINQ 无法处理 rnd_str（致命错误：超出内存使用限制）

**String.Replace 最快**

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-07-15T16:54:06.880

我现在已经在这个线程中结束了几次，并且在阅读以前的答案后我并没有完全相信，因为一些基准测试是使用 StopWatch 完成的，这可能会给出某种指示，但感觉并不好。

我的用例是我有一个可能很大的字符串，即来自网站的 HTML 输出。我需要用值替换这个字符串中的一些占位符（大约 10 个，最多 20 个）。

我创建了一个 Benchmark.NET 测试来获得一些可靠的数据，这就是我发现的：

TLDR：

*   **如果性能/内存是一个问题，请**不要使用 String.Replace 。****
***   **Regex.Replace 是最快的**，但使用的内存比 StringBuilder.Replace 稍多。如果您打算重用相同的模式，编译正则表达式最快，因为使用次数少，非编译正则表达式实例的创建成本更低。*   如果您只关心内存消耗并且执行速度较慢，请使用 StringBuilder.Replace**

 **## 测试结果：

```
|                Method | ItemsToReplace |       Mean |     Error |    StdDev |   Gen 0 |  Gen 1 | Gen 2 | Allocated |
|---------------------- |--------------- |-----------:|----------:|----------:|--------:|-------:|------:|----------:|
|         StringReplace |              3 |  21.493 us | 0.1182 us | 0.1105 us |  3.6926 | 0.0305 |     - |  18.96 KB |
|  StringBuilderReplace |              3 |  35.383 us | 0.1341 us | 0.1119 us |  2.5024 |      - |     - |  13.03 KB |
|          RegExReplace |              3 |  19.620 us | 0.1252 us | 0.1045 us |  3.4485 | 0.0305 |     - |  17.75 KB |
| RegExReplace_Compiled |              3 |   4.573 us | 0.0318 us | 0.0282 us |  2.7084 | 0.0610 |     - |  13.91 KB |
|         StringReplace |             10 |  74.273 us | 0.7900 us | 0.7390 us | 12.2070 | 0.1221 |     - |  62.75 KB |
|  StringBuilderReplace |             10 | 115.322 us | 0.5820 us | 0.5444 us |  2.6855 |      - |     - |  13.84 KB |
|          RegExReplace |             10 |  24.121 us | 0.1130 us | 0.1002 us |  4.4250 | 0.0916 |     - |  22.75 KB |
| RegExReplace_Compiled |             10 |   8.601 us | 0.0298 us | 0.0279 us |  3.6774 | 0.1221 |     - |  18.92 KB |
|         StringReplace |             20 | 150.193 us | 1.4508 us | 1.3571 us | 24.6582 | 0.2441 |     - | 126.89 KB |
|  StringBuilderReplace |             20 | 233.984 us | 1.1707 us | 1.0951 us |  2.9297 |      - |     - |   15.3 KB |
|          RegExReplace |             20 |  28.699 us | 0.1179 us | 0.1045 us |  4.8218 | 0.0916 |     - |  24.79 KB |
| RegExReplace_Compiled |             20 |  12.672 us | 0.0599 us | 0.0560 us |  4.0894 | 0.1221 |     - |  20.95 KB | 
```

所以我的结论是：

*   **Regex.Replace 是**实现快速执行和合理内存使用的方法。使用已编译的共享实例来加快速度。
*   StringBuilder 具有最低的内存占用，但比 Regex.Replace 慢很多。如果内存是唯一重要的事情，我只会使用它。

基准测试的代码如下所示：

```
[MemoryDiagnoser]
[HtmlExporter]
[PlainExporter]
[RPlotExporter]
public class String_Replace
{
    private Dictionary<string, string> _valuesToReplace = new Dictionary<string, string>()
    {
        {"foo","fooRep" },
        {"bar","barRep" },
        {"lorem","loremRep" },
        {"ipsum","ipsumRep" },
        {"x","xRep" },
        {"y","yRep" },
        {"z","zRep" },
        {"yada","yadaRep" },
        {"old","oldRep" },
        {"new","newRep" },

        {"enim","enimRep" },
        {"amet","ametRep" },
        {"sit","sitRep" },
        {"convallis","convallisRep" },
        {"vehicula","vehiculaRep" },
        {"suspendisse","suspendisseRep" },
        {"accumsan","accumsanRep" },
        {"suscipit","suscipitRep" },
        {"ligula","ligulaRep" },
        {"posuere","posuereRep" }
    };

    private Regex _regexCompiled;

    private string GetText_With_3_Tags()
    {
        return @"<html>
        <body>
        Lorem ipsum dolor sit [foo], consectetur [bar] elit. Proin nulla quam, faucibus a ligula quis, posuere commodo elit. Nunc at tincidunt elit. Sed ipsum ex, accumsan sed viverra sit amet, tincidunt id nibh. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Nam interdum ex eget blandit lacinia. Nullam a tortor id sapien fringilla pellentesque vel ac purus. Fusce placerat dapibus tortor id luctus. Aenean in lacinia neque. Fusce quis ultrices odio. Nam id leo neque.

Etiam erat lorem, tincidunt volutpat odio at, finibus pharetra felis. Sed magna enim, accumsan at convallis a, aliquet eu quam. Vestibulum faucibus tincidunt ipsum et lacinia. Sed cursus ut arcu a commodo. Integer euismod eros at efficitur sollicitudin. In quis magna non orci sollicitudin condimentum. Fusce sed lacinia lorem, nec varius erat. In quis odio viverra, pharetra ex ac, hendrerit ante. Mauris congue enim et tellus sollicitudin pulvinar non sit amet tortor. Suspendisse at ex pharetra, semper diam ut, molestie velit. Cras lacinia urna neque, sit amet laoreet ex venenatis nec. Mauris at leo massa.

Aliquam mollis ultrices mi, sit amet venenatis enim rhoncus nec. Integer sit amet lectus tempor, finibus nisl quis, sodales ante. Curabitur suscipit dolor a dignissim consequat. Nulla eget vestibulum massa. Nam fermentum congue velit a placerat. Vivamus bibendum ex velit, id auctor ipsum bibendum eu. Praesent id gravida dui. Curabitur sollicitudin lobortis purus ac tempor. Sed felis enim, ornare et est egestas, blandit tincidunt lacus. Ut commodo dignissim augue, eget bibendum augue facilisis non.

Ut tortor neque, dignissim sit amet [lorem] ut, facilisis sit amet quam. Nullam et leo ut est congue vehicula et accumsan dolor. Aliquam erat dolor, eleifend a ipsum et, maximus suscipit ipsum. Nunc nec diam ex. Praesent suscipit aliquet condimentum. Nulla sodales lobortis fermentum. Maecenas ut laoreet sem. Ut id pulvinar urna, vel gravida lacus. Integer nunc urna, euismod eget vulputate sit amet, pharetra nec velit. Donec vel elit ac dolor varius faucibus tempus sed tortor. Donec metus diam, condimentum sit amet odio at, cursus cursus risus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Nullam maximus tellus id quam consequat vestibulum. Curabitur rutrum eros tellus, eget commodo mauris sollicitudin a. In dignissim non est at pretium. Nunc bibendum pharetra dui ac ullamcorper.

Sed rutrum vehicula pretium. Morbi eu felis ante. Aliquam vel mauris at felis tempus dictum ac a justo. Suspendisse ultricies nisi turpis, non sagittis magna porttitor venenatis. Aliquam ac risus quis leo semper viverra non ac nunc. Phasellus lacinia augue sed libero elementum, at interdum nunc posuere. Duis lacinia rhoncus urna eget scelerisque. Morbi ullamcorper tempus bibendum. Proin at est eget nibh dignissim bibendum. Fusce imperdiet ut urna nec mattis. Aliquam massa mauris, consequat tristique magna non, sodales tempus massa. Ut lobortis risus rhoncus, molestie mi vitae, accumsan enim. Quisque dapibus libero elementum lectus dignissim, non finibus lacus lacinia.
        </p><p>
        </body>
        </html>";
    }

    private string GetText_With_10_Tags()
    {
          return @"<html>
        <body>
        Lorem ipsum dolor sit [foo], consectetur [bar] elit. Proin nulla quam, faucibus a ligula quis, posuere commodo elit. Nunc at tincidunt elit. Sed ipsum ex, accumsan sed viverra sit amet, tincidunt id nibh. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Nam interdum ex eget blandit lacinia. Nullam a tortor id sapien fringilla pellentesque vel ac purus. Fusce placerat dapibus tortor id luctus. Aenean in lacinia neque. Fusce quis ultrices odio. Nam id leo neque.

Etiam erat lorem, tincidunt volutpat odio at, finibus pharetra felis. Sed magna enim, [z] at convallis a, aliquet eu quam. Vestibulum faucibus tincidunt ipsum et lacinia. Sed cursus ut arcu a commodo. Integer euismod eros at efficitur sollicitudin. In quis magna non orci sollicitudin condimentum. Fusce sed lacinia lorem, nec varius erat. In quis odio viverra, pharetra ex ac, hendrerit ante. Mauris congue enim et tellus sollicitudin pulvinar non sit amet tortor. Suspendisse at ex pharetra, semper diam ut, molestie velit. Cras lacinia urna neque, sit amet laoreet ex venenatis nec. Mauris at leo massa.

Aliquam mollis ultrices mi, sit amet venenatis enim rhoncus nec. Integer sit amet [y] tempor, finibus nisl quis, sodales ante. Curabitur suscipit dolor a dignissim consequat. Nulla eget vestibulum massa. Nam fermentum congue velit a placerat. Vivamus bibendum ex velit, id auctor ipsum bibendum eu. Praesent id gravida dui. Curabitur sollicitudin lobortis purus ac tempor. Sed felis enim, ornare et est egestas, blandit tincidunt lacus. Ut commodo dignissim augue, eget bibendum augue facilisis non.

Ut tortor neque, dignissim sit amet [lorem] ut, [ipsum] sit amet quam. [x] et leo ut est congue [new] et accumsan dolor. Aliquam erat dolor, eleifend a ipsum et, maximus suscipit ipsum. Nunc nec diam ex. Praesent suscipit aliquet condimentum. Nulla sodales lobortis fermentum. Maecenas ut laoreet sem. Ut id pulvinar urna, vel gravida lacus. Integer nunc urna, euismod eget vulputate sit amet, pharetra nec velit. Donec vel elit ac dolor varius faucibus tempus sed tortor. Donec metus diam, condimentum sit amet odio at, cursus cursus risus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Nullam maximus tellus id quam consequat vestibulum. Curabitur rutrum eros tellus, eget commodo mauris sollicitudin a. In dignissim non est at pretium. Nunc bibendum pharetra dui ac ullamcorper.

Sed rutrum vehicula pretium. Morbi eu felis ante. Aliquam vel [old] at felis [yada] dictum ac a justo. Suspendisse ultricies nisi turpis, non sagittis magna porttitor venenatis. Aliquam ac risus quis leo semper viverra non ac nunc. Phasellus lacinia augue sed libero elementum, at interdum nunc posuere. Duis lacinia rhoncus urna eget scelerisque. Morbi ullamcorper tempus bibendum. Proin at est eget nibh dignissim bibendum. Fusce imperdiet ut urna nec mattis. Aliquam massa mauris, consequat tristique magna non, sodales tempus massa. Ut lobortis risus rhoncus, molestie mi vitae, accumsan enim. Quisque dapibus libero elementum lectus dignissim, non finibus lacus lacinia.
        </p><p>
        </body>
        </html>";
    }

    private string GetText_With_20_Tags()
    {
           return @"<html>
        <body>
        Lorem ipsum dolor sit [foo], consectetur [bar] elit. Proin nulla [convallis], faucibus a [vehicula] quis, posuere commodo elit. Nunc at tincidunt elit. Sed ipsum ex, accumsan sed viverra sit amet, tincidunt id nibh. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Nam interdum ex eget blandit lacinia. Nullam a tortor id sapien fringilla pellentesque vel ac purus. Fusce placerat dapibus tortor id luctus. Aenean in lacinia neque. Fusce quis ultrices odio. Nam id leo neque.

Etiam erat lorem, tincidunt [posuere] odio at, finibus pharetra felis. Sed magna enim, [z] at convallis a, [enim] eu quam. Vestibulum faucibus tincidunt ipsum et lacinia. Sed cursus ut arcu a commodo. Integer euismod eros at efficitur sollicitudin. In quis magna non orci sollicitudin condimentum. Fusce sed lacinia lorem, nec varius erat. In quis odio viverra, pharetra ex ac, hendrerit ante. Mauris congue enim et tellus sollicitudin pulvinar non sit amet tortor. Suspendisse at ex pharetra, semper diam ut, molestie velit. Cras lacinia urna neque, sit amet laoreet ex venenatis nec. Mauris at leo massa.

[suspendisse] mollis [amet] mi, sit amet venenatis enim rhoncus nec. Integer sit amet [y] tempor, finibus nisl quis, sodales ante. Curabitur suscipit dolor a dignissim consequat. Nulla eget vestibulum massa. Nam fermentum congue velit a placerat. Vivamus bibendum ex velit, id auctor ipsum bibendum eu. Praesent id gravida dui. Curabitur sollicitudin lobortis purus ac tempor. Sed felis enim, ornare et est egestas, blandit tincidunt lacus. Ut commodo dignissim augue, eget bibendum augue facilisis non.

Ut tortor neque, dignissim sit amet [lorem] ut, [ipsum] sit amet quam. [x] et leo ut est congue [new] et accumsan [ligula]. Aliquam erat dolor, eleifend a ipsum et, maximus suscipit ipsum. Nunc nec diam ex. Praesent suscipit aliquet condimentum. Nulla sodales lobortis fermentum. Maecenas ut laoreet sem. Ut id pulvinar urna, vel gravida lacus. Integer nunc urna, euismod eget vulputate sit amet, pharetra nec velit. Donec vel elit ac dolor varius faucibus tempus sed tortor. Donec metus diam, condimentum sit amet odio at, cursus cursus risus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Nullam maximus tellus id quam consequat vestibulum. Curabitur rutrum eros tellus, eget commodo mauris sollicitudin a. In dignissim non est at pretium. Nunc bibendum pharetra dui ac ullamcorper.

Sed rutrum vehicula [accumsan]. Morbi eu [suscipit] [sit]. Aliquam vel [old] at felis [yada] dictum ac a justo. Suspendisse ultricies nisi turpis, non sagittis magna porttitor venenatis. Aliquam ac risus quis leo semper viverra non ac nunc. Phasellus lacinia augue sed libero elementum, at interdum nunc posuere. Duis lacinia rhoncus urna eget scelerisque. Morbi ullamcorper tempus bibendum. Proin at est eget nibh dignissim bibendum. Fusce imperdiet ut urna nec mattis. Aliquam massa mauris, consequat tristique magna non, sodales tempus massa. Ut lobortis risus rhoncus, molestie mi vitae, accumsan enim. Quisque dapibus libero elementum lectus dignissim, non finibus lacus lacinia.
        </p><p>
        </body>
        </html>";
    }

    private string GetText(int numberOfReplace)
    {
        if (numberOfReplace == 3)
            return GetText_With_3_Tags();
        if (numberOfReplace == 10)
            return GetText_With_10_Tags();
        if (numberOfReplace == 20)
            return GetText_With_20_Tags();

        return "";
    }

    public String_Replace()
    {
        _regexCompiled = new Regex(@"\[([^]]*)\]",RegexOptions.Compiled);
    }

    [Params(3,10,20)]
    public int ItemsToReplace { get; set; }

    [Benchmark]
    public void StringReplace()
    {
        var str = GetText(ItemsToReplace);
        foreach (var rep  in _valuesToReplace.Take(ItemsToReplace))
        {
            str = str.Replace("[" + rep.Key + "]", rep.Value);
        }
    }

    [Benchmark]
    public void StringBuilderReplace()
    {
        var sb = new StringBuilder(GetText(ItemsToReplace));
        foreach (var rep  in _valuesToReplace.Take(ItemsToReplace))
        {
            sb.Replace("[" + rep.Key + "]", rep.Value);
        }
        var res = sb.ToString();
    }

    [Benchmark]
    public void RegExReplace()
    {
        var str = GetText(ItemsToReplace);
        Regex regex = new Regex(@"\[([^]]*)\]");

        str = regex.Replace(str, Replace);
        var res = str;
    }

    [Benchmark]
    public void RegExReplace_Compiled()
    {
        var str = GetText(ItemsToReplace);

        str = _regexCompiled.Replace(str, Replace);
        var res = str;
    }

    private string Replace(Match match)
    {
        if(match.Groups.Count > 0)
        { 
            string collectionKey = match.Groups[1].Value;

            return _valuesToReplace[collectionKey];
        }
        return string.Empty;
    }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-30T10:02:14.997

如果您想要 dotnet 中的内置类，我认为 StringBuilder 是最好的。要使其手动操作，您可以使用带有 char* 的不安全代码并遍历您的字符串并根据您的标准进行替换

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-30T11:27:09.630

由于您在一个字符串上有多个替换，因此我建议您使用 RegEx 而不是 StringBuilder。

# java - Eclipse RCP and JFace: Problems with Images in Context menu and TreeViewer

> ID：399815
> 
> 赞同：1
> 
> 时间：2008-12-30T08:54:35.867
> 
> 标签：java, image, eclipse-rcp, contextmenu

I'm working on an Eclipse RCP application. Today I experienced some troubles when displaying images in the context menu. What I wanted to do is to add a column to my table containing images of stars for representing a user rating. On Windows, this causes some problems, since the star images are squeezed up on the left corner of the table cell instead of expanding on the whole cell, but I'll solve that somehow. In addition I have a context menu on the table, with an entry called "rate" where again the different stars from 1 to 5 (representing the rating level) are shown, such that the user can click on it for choosing different ratings. That works fine on Windows. Now I switched to Linux (Ubuntu) to see how it works out there, and strangely, the stars in the table cell are layed out perfectly, while the stars on the context menu don't even show up. [Rating inside the table cell works http://img187.imageshack.us/img187/4427/starsratingho4.png](http://img187.imageshack.us/img187/4427/starsratingho4.png)

## [star images don't show up http://img514.imageshack.us/img514/8673/contextmenuproblemgt1.png](http://img514.imageshack.us/img514/8673/contextmenuproblemgt1.png)

On the context menu I'm using an action class where I'm setting the image descriptor for the star images:

```
public class RateAction extends Action {

private final int fRating;

private IStructuredSelection fSelection;

public RateAction(int rating, IStructuredSelection selection) {

    super("", AS_CHECK_BOX);

    fRating = rating;

    fSelection = selection;

    setImageDescriptor(createImageDescriptor());

}

/**
 * Creates the correct ImageDescriptor depending on the given rating
 * @return
 */
private ImageDescriptor createImageDescriptor() {
    ImageDescriptor imgDescriptor = null;
    switch (fRating) {
    case 0:
        return OwlUI.NEWS_STARON_0;
    case 1:
        return OwlUI.NEWS_STARON_1;
    case 2:
        return OwlUI.NEWS_STARON_2;
    case 3:
        return OwlUI.NEWS_STARON_3;
    case 4:
        return OwlUI.NEWS_STARON_4;
    case 5:
        return OwlUI.NEWS_STARON_5;

    default:
        break;
    }

    return imgDescriptor;
}

/*
 * @see org.eclipse.jface.action.Action#getText()
 */
@Override
public String getText() {
    //return no text, since the images of the stars will be displayed
    return "";
}

   ... 
```

}

Does somebody know why this strange behaviour appears?

Thanks a lot.

(For some strange reason, the images don't appear. Here are the direct URLs: [http://img187.imageshack.us/img187/4427/starsratingho4.png](http://img187.imageshack.us/img187/4427/starsratingho4.png) [http://img514.imageshack.us/img514/8673/contextmenuproblemgt1.png](http://img514.imageshack.us/img514/8673/contextmenuproblemgt1.png))

//Edit: I did some tries and it seems as if the images just don't appear when using a Checkbox style for the context menu (see constructor of the RateAction). When I switched to a PushButton style, the images appeared, although not correctly scaled, but at least they were shown.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T09:18:50.107

当我没有显示 SWT 图像时，是因为：

*   我在图像文件名中使用了大写字母，但在源代码中没有。适用于 Windows，而不是 Linux。
*   在支持之前，我尝试过运行 x64 版本的 SWT。
*   我用过VNC。不知道为什么它不起作用，颜色深度问题？
*   我用过 Ubuntu。图像在 Red Hat 上显示得很好。

不确定这是否会对您有所帮助，但它可能会提示您在哪里查看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-29T09:52:32.930

您可以在 Gnome 配置的菜单中启用图标：

*   打开终端
*   运行*gnome-appearance-properties*
*   选择*接口*选项卡
*   启用*在菜单中显示图标*复选框

现在您可以在 RCP 菜单中看到图标。

有关详细信息，请参阅此 Eclipse 错误： [错误 293720 - [GTK2.18] 缺少菜单图标](https://bugs.eclipse.org/bugs/show_bug.cgi?id=293720)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T09:58:04.443

也许这只是一个错误，在这种情况下，您的问题将没有真正的答案。

看看是否有人以前在[Eclipse Bugzilla中遇到过类似的问题](https://bugs.eclipse.org/bugs/query.cgi)

否则，请尝试使测试用例尽可能小，在 Windows 中有效，但在 Linux 中无效（或相反）并提交新错误。

# c# - Completely overwriting a file with Velocity / NVelocity

> ID：399822
> 
> 赞同：1
> 
> 时间：2008-12-30T09:00:00.067
> 
> 标签：c#, filestream, velocity, nvelocity

I am trying to use NVelocity templates in a .Net application: using a template to output results to a file. It all seems to work fine except for the fact that the output is never fully overwritten. If my file is 100 characters long and the template only renders 20 characters, the last 80 characters are never altered!

Code sample:

```
 FileStream fileStream = new FileStream(outputPath, FileMode.OpenOrCreate, FileAccess.Write);

        using (StreamWriter streamWriter = new StreamWriter(fileStream))
        {
            velocityEngine.MergeTemplate(templateName, Encoding.Default.WebName, velocityContext, streamWriter);
        } 
```

So if my template outputs AAAA and the file already contains BBBBBBBB then at the end, the file contains AAAABBBB at the end of the op.

Any clue how I can get it to fully overwrite the file? - e.g. in the above example the final output should be AAAA. Not too sure whether this is just pure stream-related stuff - but I haven't had this problem before with filestreams.

Happy to write a reset method, or just output to a memorystream and overwrite the file, but I would like to get it working like this if possible! **EDIT:'' got it working by calling

```
 fileStream.SetLength(0); 
```

when I open the file. But would appreciate knowing if there was a better way!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T12:56:51.627

`FileMode.OpenOrCreate`我认为解决方案是简单地`FileMode.Create`在第一行更改为

[来自关于System.IO.FileMode](http://msdn.microsoft.com/en-us/library/system.io.filemode.aspx "MSDN System.IO.FileMode")的 MSDN 文章..

> **FileMode.Create** 指定操作系统应该创建一个新文件。如果文件已经存在，它将被覆盖。
> 
> **FileMode.OpenOrCreate** 指定操作系统应该打开一个文件（如果存在）；否则，应创建一个新文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T08:08:49.460

如果您在打开时不知道您可能正在截断文件，则可以使用 Stream 上的 SetLength 方法来截断它。
[http://msdn.microsoft.com/en-us/library/system.io.stream.setlength.aspx](http://msdn.microsoft.com/en-us/library/system.io.stream.setlength.aspx)

为此，Stream 必须是可写且可查找的。

# asp.net - 如何在 asp.net 中使用 Enter 键提交表单

> ID：399826
> 
> 赞同：0
> 
> 时间：2008-12-30T09:01:38.130
> 
> 标签：asp.net, .net-2.0, asp.net-2.0

我在一个表单中有 3 个按钮。其中之一是提交按钮。当我按下回车键时，如何将其设为默认按钮。有这个属性吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-30T09:13:33.003

表单有一个属性：defaultbutton。

```
<form runat="server" defaultbutton="myButton">
...
</form> 
```

这是第一次在 ASP.NET 2.0 中实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T09:54:33.577

另一个有用的提示是您也可以在 asp:panel 上设置默认按钮。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-30T09:52:44.533

或者您可以在代码中执行此操作 - Page_load：

```
Page.Form.DefaultButton = btnSearch.UniqueID; 
```

每当您按 enter 时，btnSearch 控件将被用作默认值。

# dotnetnuke - Multi-instance of FCK in dotnetnuke

> ID：399835
> 
> 赞同：0
> 
> 时间：2008-12-30T09:08:11.080
> 
> 标签：dotnetnuke, fckeditor

I got a problem when I put 2 instances of FckEditor to a page in dotnetnuke. sometimes, I got empty text when I call the text property.

Anyone helps?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T16:46:00.813

空`Text`属性通常是由于编辑器位于更新面板中（显式地或通过打开该控件定义的部分呈现）引起的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T18:41:57.187

> 对于那些在他们的 dotnetnuke 网站上使用 FCKEditor 的人，我建议更新到最新版本，它修复了许多问题，包括同一页面上的多个实例。（最新新闻文章需要的东西）。 [源](http://www.ventrian.com/Resources/Blog/tabid/243/articleType/ArticleView/articleId/286/FCKEditor-Update.aspx)
> 
> [下载](http://dnnfckeditor.codeplex.com/)最新版本的 FCKeditor 提供程序。

# javascript - Google Maps API：创建后访问标记

> ID：399837
> 
> 赞同：1
> 
> 时间：2008-12-30T09:10:02.077
> 
> 标签：javascript, google-maps

我想知道是否有办法访问创建后使用 JavaScript 添加到地图的标记。

我的意思是，是否可以在页面上的某处制作一个按钮，在每次点击时，将地图集中在之前添加的另一个标记上？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T10:11:09.333

这是一种方法。

创建一个标记位置数组，并在将标记添加到地图时将它们添加到数组中。将数组索引与您的按钮相关联，当单击按钮时，您可以从数组中获取您的位置并以此为中心。

这是一个（非常简单的）示例。Javascript 看起来像这样：

```
var googleMarkerPoints = [];
var googleMap;

function CreateMap() {
     googleMap = new GMap2(yourMapDiv);
     AddMarker(0, 1.2, 1.3);
     AddMarker(1, -1.2, -1.3);
}

function AddMarker(index, latitude, longitude) {
    googleMarkerPoints[index] = new GLatLng(latitude, longitude);
    var marker = new GMarker(googleMarkerPoints[index]);
    googleMap.addOverlay(marker);
}

function SelectMarker(index) {
    googleMap.panTo(googleMarkerPoints[index]);
} 
```

你的 HTML 看起来像这样：

```
<input type="button" value="Marker0" onclick="SelectMarker(0)" />
<input type="button" value="Marker1" onclick="SelectMarker(1)" /> 
```

# .net - .NET 内存分析工具

> ID：399847
> 
> 赞同：52
> 
> 时间：2008-12-30T09:20:00.213
> 
> 标签：.net, memory-profiling, profiling

> **可能重复：**
> [有哪些好的 .NET Profiler？](https://stackoverflow.com/questions/3927/what-are-some-good-net-profilers)

我正在寻找好的 .NET CLR 内存分析工具。

我的关键要求是它能很好地与 IIS 和独立的 CLR 应用程序配合使用。理想情况下，我会看到分配了哪些对象，分配了哪些对象以及它们的大小？

是否有人对您乐于推荐的特定工具有任何好的经验？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-09-25T02:55:16.490

我目前正在评估[Scitech .NET Memory Profiler 3.1](http://memprofiler.com/)和[ANTS Memory Profiler 5.1](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/)。我在一两年前尝试了 JetBrains，但它不如 ANTS，所以这次我没有打扰。**从阅读网站来看，它在内存**分析方面似乎不如其他两个好。

ANTS 和 Scitech 内存分析器都具有另一个没有的功能，因此哪个最好取决于您的偏好。一般来说，Scitech 提供更详细的信息，而 ANTS 则在识别泄漏对象方面确实令人难以置信。总的来说，我更喜欢 ANTS，因为它可以快速识别可能的泄漏。

根据我的经验，以下是每种方法的主要优点和缺点：

**ANTS 和 Scitech .NET Memory Profiler 的共同特点**

*   实时分析功能
*   他们网站上的优秀操作视频
*   便于使用
*   合理的性能（显然比没有附加分析器要慢，但不会让你感到沮丧）
*   显示泄漏对象的实例
*   基本上他们都做得很好

**蚂蚁**

*   **一键式过滤器可查找常见泄漏，**包括：仅通过事件处理程序保持活动状态的对象、已释放但仍处于活动状态的对象以及仅通过来自已释放对象的引用保持活动状态的对象。这可能是 ANTS 的杀手级功能——因此发现泄漏的速度非常快。以我的经验，大多数泄漏是由于事件处理程序没有被解开而引起的，而 ANTS 只是将您直接带到这些对象。惊人的。
*   对象保留图。虽然在 Scitech 中提供了相同的信息，但在 ANTS 中更容易解释。
*   除了对象本身的大小之外，还显示带有子项的大小（但仅在不幸选择了一个实例时，而不是在整个类列表中）。
*   更好地与 Visual Studio 集成（右键单击图形以跳转到文件）

**Scitech .NET 内存分析器**

*   分配对象时显示堆栈跟踪。这对于分配在许多不同位置的对象**非常有用。**使用 ANTS 很难确定泄漏对象的确切创建位置。
*   显示未处理的一次性对象的计数。虽然不表示存在泄漏，但它确实确定了解决此问题并通过更快的垃圾收集提高应用程序性能的机会。
*   更详细的过滤选项（可以独立过滤几列）。
*   显示创建的对象总数（包括那些垃圾收集）的信息。ANTS 仅显示“实时”对象统计信息。这使得分析和调整整体应用程序性能变得更加容易（例如，确定在哪里创建了大量不必要的对象，而这些对象不一定会泄漏）。

总而言之，我认为 ANTS 可以帮助您更快地找到泄漏的内容，而 Scitech 一旦您知道要查看什么（例如创建时的堆栈跟踪），就会提供有关您的整体应用程序内存性能和各个对象的更多详细信息。如果将堆栈跟踪和未处理的一次性对象的跟踪添加到 ANTS 中，我不会看到需要使用其他任何东西。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2011-06-16T12:50:41.827

奇怪的是这里还没有提到[CLR Profiler 。](http://msdn.microsoft.com/en-us/library/ff650691.aspx)它是免费的并且运行良好。

请注意 Microsoft 自己的网站上提供的多个旧版本。截至 2011 年 11 月，最新版本似乎是这个：[最新版本](http://www.microsoft.com/download/en/confirmation.aspx?id=16273) [（备用链接）](http://www.microsoft.com/en-us/download/details.aspx?id=16273)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-09-25T02:59:56.713

如果您感到非常绝望，可以将[WinDbg与 .Net 框架附带](http://www.microsoft.com/whdc/DevTools/Debugging/default.mspx) [的 Son-of-Strike 库](http://www.codeproject.com/KB/cpp/MemoryLeak.aspx)(SOS.DLL) 一起使用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-30T09:26:49.140

我本人是[JetBrains Profiler](http://www.jetbrains.com/profiler/index.html)的忠实粉丝

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-30T09:23:37.617

[.Net Memory Profiler](http://memprofiler.com/)在我之前的项目中帮助了我很多。它不是免费的，但非常好。

> .NET Memory Profiler 是一个强大的工具，用于查找内存泄漏并优化用 C#、VB.NET 或任何其他 .NET 语言编写的程序中的内存使用。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-12-30T11:25:15.813

我第二个[ANTS profiler](http://www.red-gate.com/products/ANTS_Profiler/index.htm)。

除了显示您需要的所有内容之外，它还会绘制简单的图表，您可以在其中查看执行时间最长的内容以及占用内存的内容。当您单击 graphp 时，它将向您显示代码中的对应行。

而且我喜欢在执行时间过长的代码行上淹没小的进度条。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-30T09:47:07.087

我目前正在使用[ANTS Profiler](http://www.red-gate.com/products/ANTS_Profiler/index.htm)。这是一个非常好的工具，具有许多分析详细信息选项，并且可以很好地与独立应用程序、开发服务器和 IIS 配合使用。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-10-23T09:12:25.117

由于每个人都列出了可用的工具，我想我会指出你的 .NET 分析器的完整列表：http: [//sharptoolbox.com/categories/profilers-debuggers](http://sharptoolbox.com/categories/profilers-debuggers)

您会在此处找到此处建议的工具和所有其他工具，每个工具都有其建议的简短描述。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-03T12:03:45.503

多年来，我使用[Aqtime](http://www.automatedqa.com/products/aqtime/)取得了巨大成功。我尝试了 ANTS 和其他人，但又回到了 Aqtime，因为我也在非托管代码中进行了大量开发。

# c++ - Best compiler warning level for C/C++ compilers?

> ID：399850
> 
> 赞同：47
> 
> 时间：2008-12-30T09:22:23.970
> 
> 标签：c++, c, warnings, compiler-construction

What compiler warning level do you recommend for different C/C++ compilers?

gcc and g++ will let you get away with a lot on the default level. I find the best warning level for me is '-Wall'. And I always try to remove fix the code for the warnings it generates. (Even the silly ones about using parenthesis for logical precedence rules or to say I really mean 'if (x = y)')

What are your favorite levels for the different compilers, such as Sun CC, aCC (HPUX ?), Visual Studio, intel?

Edit:

I just wanted to point out that I don't use "-Werror" (but I do understand it's utility) on gcc/g++ because, I use:

```
#warning "this is a note to myself"

```

in a few places in my code. Do all the compilers understand the #warning macro?

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-12-30T19:47:49.107

这是我用于 C++ 代码的一组额外的偏执标志：

```
 -g -O -Wall -Weffc++ -pedantic  \
    -pedantic-errors -Wextra -Waggregate-return -Wcast-align \
    -Wcast-qual  -Wchar-subscripts  -Wcomment -Wconversion \
    -Wdisabled-optimization \
    -Werror -Wfloat-equal  -Wformat  -Wformat=2 \
    -Wformat-nonliteral -Wformat-security  \
    -Wformat-y2k \
    -Wimplicit  -Wimport  -Winit-self  -Winline \
    -Winvalid-pch   \
    -Wunsafe-loop-optimizations  -Wlong-long -Wmissing-braces \
    -Wmissing-field-initializers -Wmissing-format-attribute   \
    -Wmissing-include-dirs -Wmissing-noreturn \
    -Wpacked  -Wpadded -Wparentheses  -Wpointer-arith \
    -Wredundant-decls -Wreturn-type \
    -Wsequence-point  -Wshadow -Wsign-compare  -Wstack-protector \
    -Wstrict-aliasing -Wstrict-aliasing=2 -Wswitch  -Wswitch-default \
    -Wswitch-enum -Wtrigraphs  -Wuninitialized \
    -Wunknown-pragmas  -Wunreachable-code -Wunused \
    -Wunused-function  -Wunused-label  -Wunused-parameter \
    -Wunused-value  -Wunused-variable  -Wvariadic-macros \
    -Wvolatile-register-var  -Wwrite-strings 
```

这应该给你一些开始的东西。根据项目的不同，您可能需要将其调低，以免看到来自第三方库的警告（这些库通常对无警告非常粗心。）例如，Boost 向量/矩阵代码会使 g++ 发出很多的噪音。

处理这种情况的一种更好的方法是围绕 g++ 编写一个包装器，该包装器仍然使用调整到最大的警告，但允许人们禁止在特定文件/行号中看到它们。很久以前就写过这样的工具，等有时间清理一下再发布。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-12-30T09:32:20.127

On Visual C++, I use `/W4` and `/WX` (treat warnings as errors).

VC also has `/Wall`, but it's incompatible with the standard headers.

I choose to treat warnings as errors, because that forces me to fix them. I fix all warnings, even if that means adding `#pragma` to ignore the warning - that way, I'm stating explicitly, that I'm aware of the warning (so other developers won't e-mail me about it).

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-30T09:59:42.117

相信VC也支持

```
#pragma message ("note to self") 
```

但是随着系统不断发展壮大，每晚构建 30 名开发人员同时工作，阅读所有笔记给自己需要几天时间，即使在这个数量上，自己只会阅读笔记并最终去在压力下无法跟上，不得不辞职……

不，如果你允许，警告的数量会迅速增加，而且你将无法发现真正重要的警告（未初始化的变量、构造函数中使用的 this 指针……）。

这就是我尝试将警告视为错误的原因：大多数情况下，编译器警告我是正确的，如果他不是，我将其记录在代码中并预先添加

```
#pragma warning ( push )
#pragma warning ( 4191 : disable )
// violent code, properly documented
#pragma warning ( pop ) 
```

我[刚读到](http://msdn.microsoft.com/en-us/library/2c8f766e(VS.80).aspx)他们也有`warning ( N : suppress )`编译指示。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-12-30T09:24:43.123

I tend to use `-Wall` (because everyone does make bugs, nobody is perfect) , but i don't use `-Werror` (treat warnings as errors) because now and then gcc warns about things which are right anyway (false positives).

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-30T09:34:19.623

I agree with litb to always use -Wall. In addition, if you want to ensure your code is compliant you can also use -pedantic. Another warning that can be helpful if you're handling unions and structs at the byte level is -Wpadded.

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-30T11:04:38.273

我在打开错误时使用警告进行所有开发。

因为我仍然在 VC6 中开发，所以我的代码中有很多#pragma（主要是 4786）。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-31T01:30:35.217

在 GCC 上，出于偏好，我使用`-Wall -Wextra -Wwrite-strings -Werror`，并使用`std=`. 哪个标准取决于项目：主要取决于它需要的可移植性。

我使用的原因`-Werror`是警告（对我来说）是不可接受的，即使它们并不代表真正的错误。我宁愿解决任何导致警告的问题，也不愿在我余生中每次编译时都忽略警告。一旦您在编译中允许警告，就很容易错过上次没有的警告。

当然，在处理第三方代码时，有时您无法摆脱警告。然后我会根据具体情况决定是否放宽`-W`选项，删除`-Werror`并编写脚本以检查是否只发生预期警告，或者修改第三方代码（“修复”警告或如果可能的话，用编译指示禁用它）。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-03-25T21:58:04.203

no one has mentioned the Intel compiler yet:

[https://software.intel.com/sites/products/documentation/doclib/iss/2013/compiler/cpp-lin/GUID-D060680A-1A18-4574-8291-5C74E6E31335.htm](https://software.intel.com/sites/products/documentation/doclib/iss/2013/compiler/cpp-lin/GUID-D060680A-1A18-4574-8291-5C74E6E31335.htm)

-w3 is pretty chatty, so I would suggest -w2

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-12-30T11:11:18.400

我喜欢 -Wall 和严格的原型以及隐式函数定义。这些错误可能非常有用。还有 -Wextra 会收集*各种各样*的东西，比如你打算成为条件但不小心写成语句的东西：

```
if (something);
   classic_way_to_leak_memory(); 
```

在类 Unix 系统上，您必须遵守用户的 ENV 偏好 .. 所以他们看到和报告的内容可能与您需要的完全不同 :)

我也是一个类型双关语的恶魔，所以我也倾向于设置 -Fno-strict-aliasing ，除非用户想要它。否则，经典 C 中的安全内存管理很难实现。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-12-30T11:17:55.767

这里有一个很好的 GCC 选项列表：[http://mces.blogspot.com/2008/12/year-end-cleaning-ie-on-warning-options.htm](http://mces.blogspot.com/2008/12/year-end-cleaning-ie-on-warning-options.htm)。-Wall 不会启用所有可能的警告，有些警告必须明确启用。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-30T09:50:20.373

在 Visual CI 中使用 /w3。我发现 w4 在每次构建时都会产生太多噪音（很多来自 MS 库）。额外的警告非常轻微，到目前为止还不是导致错误的原因。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-10-21T10:15:03.617

我也喜欢检查在我的项目中给编译器的所有可能的警告。*不幸的是，关于英特尔 C++*编译器的回答对我来说不是很丰富（链接已失效）。我做了自己的研究。

因为我使用*Qt 5*和*qmake*我有预定义的警告级别**-w1**。对此无能为力。但这还不是全部，ICC 有更多的键：

```
-Wcomment 
-Weffc++ 
-Wextra-tokens 
-Wformat 
-Winline // don't use, show only for example
-Wmain 
-Wmissing-declarations 
-Wmissing-prototypes 
-Wnon-virtual-dtor 
-Wp64 
-Wpointer-arith 
-Wremarks 
-Wreturn-type 
-Wsign-compare 
-Wstrict-aliasing 
-Wstrict-prototypes 
-Wtrigraphs 
-Wuninitialized 
-Wunknown-pragmas 
-Wunused-variable 
```

更多关于所有[键](http://geco.mines.edu/guide/icc.html)的信息。

我还想补充一点，与 GCC 不同，ICC 会为一个键生成多个警告，例如 key **-Weffc++**。如果您只想看到所有列表中的几个警告，请使用 key **-wd**。

我禁用：**-wd1418,2012,2015,2017,2022,2013**。并且警告**-wd1572,873,2259,2261**默认在 qmake 中被禁用。

我使用 PCH 并且发现在 Qt Creator 消息中看到关于使用 PCH 文件的错误非常烦人。要禁用，请使用**-Wno-pch-messages**。

为了在代码中禁用警告，我使用：

```
#if defined(Q_CC_INTEL)
    #pragma warning( push )
    #pragma warning( disable: 2021 )
#endif

// some code

#if defined(Q_CC_INTEL)
    #pragma warning( pop )
#endif 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-30T17:34:37.673

感谢大家的回答。自从我使用除 gcc/g++ 之外的任何东西以来已经有一段时间了。我很久以前必须使用的是

```
-fmessage-length = 0（因为 g++ 有断行消息的丑陋习惯）

-Wno-deprecated（因为我在一个预先存在 std 命名空间的代码库上工作）

```

我确实记得（至少 5 年前）Sun Workshop CC 编译器默认警告级别之上的任何东西都太多了。我也认为这对于英特尔编译器来说可能是正确的。我已经有一段时间没有了解非 gnu 编译器了。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-30T21:09:05.540

The GCC compilers become stricter with every new version. Use the flag `-ansi` to produce warnings for violations of the strictest interpretation of the ANSI language standards. That's usually stuff that just happens to work in your current compiler, but may produce errors in the next version or in other compilers. That flag will help you avoid having to port your code every time you switch compilers/versions.

# c# - WM 5 SDK 符号

> ID：399863
> 
> 赞同：2
> 
> 时间：2008-12-30T09:31:11.050
> 
> 标签：c#, sdk, windows-mobile, motorola-emdk

我们有大量的 Window Mobile 设备（Symbol MC35 和 MC70）。我想编写一个小应用程序来获取设备序列号和 SIM 卡序列号（不是电话号码）。我已经尝试使用 Symbol SDK，我可以获得 MC70s 的设备序列号，因为它们有一个电子序列号模块。但不确定如何获得模拟市民详细信息。如果我无法从 MC35s 获取设备序列号，我可以获取 IMEI 号吗？

这样做的目的是让我可以随时更新手持设备中的 sim 卡的最新记录。我要将数据写入一个注册文件，SOTI Mobile Control 会将其链接到该手持设备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T15:57:16.013

您在[lineGetGeneralInfo](http://msdn.microsoft.com/en-us/library/ms862517.aspx) TAPI 调用之后。您想查看订户号码，该号码使用调用返回的[LINEGENERALINFO](http://msdn.microsoft.com/en-us/library/ms862476.aspx)结构的 dwSubscriberNumberSize 和 dwSubscriberNumberOffset 成员定位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T10:27:34.603

有关 SIM 管理功能的信息，请参见[此处](http://msdn.microsoft.com/en-us/library/aa454263.aspx)。如果存在这样的事情，我找不到任何用于检索 SIM ID 的东西。我想您可以通过电话号码识别 SIM 卡。两个不同的 SIM 卡可以有相同的电话号码吗？要获取电话号码，请使用 Windows Mobile SDK 中的 GetPhoneNumber 示例。

至于识别手机，正确的方法是读取Device ID。SDK 中还有 GetDeviceID 示例（两者都在 Common\CPP\Win32 中）。从样本中复制阅读我：

> GetDeviceUniqueID 保护设备的隐私。多个应用程序需要使用设备的唯一标识符与服务器进行通信。为了保护设备的隐私，多个服务器不应该能够关联来自同一设备的数据。GetDeviceUniqueID 不使用应用程序提供的数据以外的任何附加信息，因此任何传入相同应用程序数据缓冲区的应用程序都将获得相同的哈希值。无论应用程序的信任级别如何，该 API 都可以被任何应用程序调用。

如果您想检索 IMEI，请参见[此处](http://xman892.blogspot.com/2007/07/how-to-series-retrieving-imsi-and-imei.html)的示例。

# .net - 如何在单声道项目中使用应用程序设置？

> ID：399866
> 
> 赞同：1
> 
> 时间：2008-12-30T09:32:29.237
> 
> 标签：.net, visual-studio, mono, application-settings

我正在尝试将应用程序移植到 Mono，但是 Mono 不支持“应用程序设置”。我不会也不会使用 Mono Develop，开发是使用 Visual Studio 完成的。

有什么快速的方法可以解决这个问题吗？或者我应该实现自己的设置替换类？

如果重要的话，这是一个 VB.NET 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T10:09:44.110

提出此类问题的最佳地点是[http://lists.ximian.com/mailman/listinfo/mono-list上的 Mono dev 邮件列表](http://lists.ximian.com/mailman/listinfo/mono-list)

我确信有一种解决方法，没有理由手动实施它

可能，您的问题的主要原因是 VB.BET，因为与 C# 相比，它在 Mono 上的实现非常落后

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T15:23:54.037

您能详细说明“应用程序设置”吗？您是否尝试使用 app.config 文件？或者可能是项目文件的设置选项卡？

Mono 应该支持这两者。

也许您还可以详细说明“不支持”。您收到错误消息吗？如果是这样，消息是什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-06T20:44:12.190

Mono 本身不支持此功能。你们许多人通过为monodevelop、Linux 的VS 风格IDE 和C# 和其他语言的mono 开发实现此功能，为代码库做出了巨大贡献。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T15:32:01.617

@jpobst

从我的应用程序中查看以下代码：

```
Dim Threshold As Integer = My.Settings.Threshold 
```

和

```
My.Settings.Threshold = 15 
```

这些应与应用程序/用户设置同步。是的，我正在使用 Visual Studio 的设置功能和带有“用户”和“应用程序”范围的 app.config。

单声道不支持它。它没有实现，*AFAIK 总是什么都不返回*。MoMA 说它是[Monotodo](http://www.mono-project.com/MoMA_-_Issue_Descriptions)。

# jquery - jQuery中的自定义事件？

> ID：399867
> 
> 赞同：186
> 
> 时间：2008-12-30T09:32:35.307
> 
> 标签：jquery, events

我正在寻找有关如何以最佳方式在 jquery 中实现自定义事件处理的一些输入。我知道如何从 dom 元素（如“click”等）中连接事件，但我正在构建一个小型 javascript 库/插件来处理一些预览功能。

我有一个脚本正在运行，以根据我得到的一组规则和数据/用户输入更新 dom 元素中的一些文本，但现在我需要在其他元素中显示的相同文本，而该脚本不可能知道。我需要的是一个很好的模式来以某种方式观察这个脚本产生所需的文本。

那么我该怎么做呢？我是否忽略了 jquery 中的一些内置功能来引发/处理用户事件，还是需要一些 jquery 插件来做到这一点？您认为处理此问题的最佳方法/插件是什么？

* * *

## 回答 #1

> 赞同：133
> 
> 时间：2013-02-12T19:44:21.123

接受的答案中提供的链接显示了使用 jQuery 实现**pub/sub 系统**的好方法，但我发现代码有点难以阅读，所以这是我的代码简化版本：

[http://jsfiddle.net/tFw89/5/](http://jsfiddle.net/tFw89/5/)

```
$(document).on('testEvent', function(e, eventInfo) { 
  subscribers = $('.subscribers-testEvent');
  subscribers.trigger('testEventHandler', [eventInfo]);
});

$('#myButton').on('click', function() {
  $(document).trigger('testEvent', [1011]);
});

$('#notifier1').on('testEventHandler', function(e, eventInfo) { 
  alert('(notifier1)The value of eventInfo is: ' + eventInfo);
});

$('#notifier2').on('testEventHandler', function(e, eventInfo) { 
  alert('(notifier2)The value of eventInfo is: ' + eventInfo);
}); 
```

* * *

## 回答 #2

> 赞同：106
> 
> 时间：2008-12-30T11:37:56.410

看看这个：

[（转载自过期博客页面[http://jamiethompson.co.uk/web/2008/06/17/publish-subscribe-with-jquery/](http://jamiethompson.co.uk/web/2008/06/17/publish-subscribe-with-jquery/)基于[http://web.archive.org/web上的存档版本/20130120010146/http://jamiethompson.co.uk/web/2008/06/17/publish-subscribe-with-jquery/](http://web.archive.org/web/20130120010146/http://jamiethompson.co.uk/web/2008/06/17/publish-subscribe-with-jquery/) )]

* * *

# 使用 jQuery 发布/订阅

**2008 年 6 月 17 日**

为了编写一个与 Google Gears 的离线功能集成的 jQuery UI，我一直在玩弄一些代码来使用 jQuery 轮询网络连接状态。

## 网络检测对象

基本前提非常简单。我们创建了一个网络检测对象的实例，它将定期轮询 URL。如果这些 HTTP 请求失败，我们可以假设网络连接已经丢失，或者服务器在当前时间根本无法访问。

```
$.networkDetection = function(url,interval){
    var url = url;
    var interval = interval;
    online = false;
    this.StartPolling = function(){
        this.StopPolling();
        this.timer = setInterval(poll, interval);
    };
    this.StopPolling = function(){
        clearInterval(this.timer);
    };
    this.setPollInterval= function(i) {
        interval = i;
    };
    this.getOnlineStatus = function(){
        return online;
    };
    function poll() {
        $.ajax({
            type: "POST",
            url: url,
            dataType: "text",
            error: function(){
                online = false;
                $(document).trigger('status.networkDetection',[false]);
            },
            success: function(){
                online = true;
                $(document).trigger('status.networkDetection',[true]);
            }
        });
    };
}; 
```

您可以在此处查看演示。将您的浏览器设置为离线工作，看看会发生什么...... 不，这不是很令人兴奋。

## 触发和绑定

令人兴奋的是（或者至少是让我兴奋的）是通过应用程序传递状态的方法。我偶然发现了一种使用 jQuery 的 trigger 和 bind 方法来实现 pub/sub 系统的很大程度上没有被讨论过的方法。

演示代码比它需要的更钝。网络检测对象将“状态”事件发布到主动监听它们的文档，然后将“通知”事件发布给所有订阅者（稍后会详细介绍）。这背后的原因是，在现实世界的应用程序中，可能会有更多的逻辑来控制何时以及如何发布“通知”事件。

```
$(document).bind("status.networkDetection", function(e, status){
    // subscribers can be namespaced with multiple classes
    subscribers = $('.subscriber.networkDetection');
    // publish notify.networkDetection even to subscribers
    subscribers.trigger("notify.networkDetection", [status])
    /*
    other logic based on network connectivity could go here
    use google gears offline storage etc
    maybe trigger some other events
    */
}); 
```

由于 jQuery 以 DOM 为中心的方法，事件被发布到（触发）DOM 元素。这可以是用于一般事件的窗口或文档对象，或者您可以使用选择器生成 jQuery 对象。我在演示中采用的方法是创建一个几乎命名空间的方法来定义订阅者。

将成为订阅者的 DOM 元素简单地归类为“订阅者”和“网络检测”。然后，我们可以通过触发通知事件仅将事件发布到这些元素（演示中只有一个）**`$(“.subscriber.networkDetection”)`**

**`#notifier`**作为订阅者组一部分的 div然后`.subscriber.networkDetection`绑定了一个匿名函数，有效地充当了侦听器。

```
$('#notifier').bind("notify.networkDetection",function(e, online){
    // the following simply demonstrates
    notifier = $(this);
    if(online){
        if (!notifier.hasClass("online")){
            $(this)
                .addClass("online")
                .removeClass("offline")
                .text("ONLINE");
        }
    }else{
        if (!notifier.hasClass("offline")){
            $(this)
                .addClass("offline")
                .removeClass("online")
                .text("OFFLINE");
        }
    };
}); 
```

所以，你去吧。这一切都非常冗长，我的例子一点也不令人兴奋。它也没有展示你可以用这些方法做的任何有趣的事情，但如果有人有兴趣挖掘源代码，请随意。所有代码都内联在演示页面的头部

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-12-30T09:41:53.213

我想是的..可以“绑定”自定义事件，例如（来自：[http](http://docs.jquery.com/Events/bind#typedatafn) ://docs.jquery.com/Events/bind#typedatafn ）：

```
 $("p").bind("myCustomEvent", function(e, myName, myValue){
      $(this).text(myName + ", hi there!");
      $("span").stop().css("opacity", 1)
               .text("myName = " + myName)
               .fadeIn(30).fadeOut(1000);
    });
    $("button").click(function () {
      $("p").trigger("myCustomEvent", [ "John" ]);
    }); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2011-04-16T19:49:43.533

我有一个类似的问题，但实际上是在寻找不同的答案；我正在寻找创建自定义事件。例如，不要总是这样说：

```
$('#myInput').keydown(function(ev) {
    if (ev.which == 13) {
        ev.preventDefault();
        // Do some stuff that handles the enter key
    }
}); 
```

我想将其缩写为：

```
$('#myInput').enterKey(function() {
    // Do some stuff that handles the enter key
}); 
```

trigger 和 bind 不能说明全部 - 这是一个 JQuery 插件。 [http://docs.jquery.com/Plugins/Authoring](http://docs.jquery.com/Plugins/Authoring)

“enterKey”函数作为属性附加到 jQuery.fn - 这是所需的代码：

```
(function($){
    $('body').on('keydown', 'input', function(ev) {
        if (ev.which == 13) {
            var enterEv = $.extend({}, ev, { type: 'enterKey' });
            return $(ev.target).trigger(enterEv);
        }
    });

    $.fn.enterKey = function(selector, data, fn) {
        return this.on('enterKey', selector, data, fn);
    };
})(jQuery); 
```

[http://jsfiddle.net/b9chris/CkvuJ/4/](http://jsfiddle.net/b9chris/CkvuJ/4/)

上面的一个优点是您可以在链接侦听器上优雅地处理键盘输入，例如：

```
$('a.button').on('click enterKey', function(ev) {
    ev.preventDefault();
    ...
}); 
```

编辑：更新以正确地将正确的`this`上下文传递给处理程序，并将任何返回值从处理程序返回给 jQuery（例如，如果您希望取消事件并冒泡）。更新为将正确的 jQuery 事件对象传递给处理程序，包括关键代码和取消事件的能力。

老jsfiddle：http: [//jsfiddle.net/b9chris/VwEb9/24/](http://jsfiddle.net/b9chris/VwEb9/24/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-05-02T01:14:22.743

这是一个旧帖子，但我会尝试用新信息更新它。

要使用自定义事件，您需要将其绑定到某个 DOM 元素并触发它。所以你需要使用

> .on() 方法将事件类型和事件处理函数作为参数。可选地，它还可以接收与事件相关的数据作为其第二个参数，将事件处理函数推送到第三个参数。传递的任何数据都可用于事件对象的 data 属性中的事件处理函数。事件处理函数总是接收事件对象作为它的第一个参数。

和

> .trigger() 方法将事件类型作为其参数。可选地，它还可以采用一组值。这些值将作为事件对象之后的参数传递给事件处理函数。

代码如下所示：

```
$(document).on("getMsg", {
    msg: "Hello to everyone",
    time: new Date()
}, function(e, param) {
    console.log( e.data.msg );
    console.log( e.data.time );
    console.log( param );
});

$( document ).trigger("getMsg", [ "Hello guys"] ); 
```

可以在[这里](https://learn.jquery.com/events/introduction-to-custom-events/)和[这里](http://api.jquery.com/trigger/)找到很好的解释。为什么这会很有用？[我在twitter 工程师](http://www.youtube.com/watch?v=hrZl_EQUbRQ#t=1334)的这个出色的解释中找到了如何使用它。

**PS**在纯 javascript 中，您可以使用[new CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent)执行此操作，但要注意 IE 和 Safari 问题。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-05-24T14:34:24.753

**以下是我编写自定义事件的方式：**

```
var event = jQuery.Event('customEventName');
$(element).trigger(event); 
```

当然，你可以简单地做

```
$(element).trigger('eventname'); 
```

但是我写的方式允许你通过做来检测用户是否阻止了默认

```
var prevented = event.isDefaultPrevented(); 
```

这使您可以听取最终用户停止处理特定事件的请求，例如，如果您单击表单中的按钮元素但不希望表单在出现错误时发布。

* * *

**然后我通常会听这样的事件**

```
$(element).off('eventname.namespace').on('eventname.namespace', function () {
    ...
}); 
```

再一次，你可以做

```
$(element).on('eventname', function () {
    ...
}); 
```

但我一直觉得这有点不安全，特别是如果你在一个团队中工作。

以下内容没有错：

```
$(element).on('eventname', function () {}); 
```

但是，假设我出于某种原因需要取消绑定此事件（想象一个禁用的按钮）。然后我必须做

```
$(element).off('eventname', function () {}); 
```

这将从 中删除所有`eventname`事件`$(element)`。您无法知道将来是否有人还会将事件绑定到该元素，并且您也会无意中取消绑定该事件

避免这种情况的安全方法是通过执行命名您的事件

```
$(element).on('eventname.namespace', function () {}); 
```

最后，您可能已经注意到第一行是

```
$(element).off('eventname.namespace').on('eventname.namespace', ...) 
```

我*个人*总是在绑定之前取消绑定事件，以确保不会多次调用同一个事件处理程序（想象这是支付表单上的提交按钮，并且该事件已被绑定 5 次）

# git - 现有的 Emacs 模块中缺少哪些与 git 配合使用的功能？

> ID：399889
> 
> 赞同：11
> 
> 时间：2008-12-30T09:51:41.430
> 
> 标签：git, emacs

你怎么看 - 应该实现哪些功能以使 Emacs 中的 Git 工作更舒适？magit/git.el/egg/git-emacs/...中缺少哪些功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-30T15:58:45.247

这几天我一直在玩 git-emacs。在阅读了我的选择（[在您的博客文章上](http://alexott.net/en/writings/emacs-vcs/EmacsGit.html)）并尝试了其中一些后，我选择了那个。我的想法：

1.  git.el - 你的评论中有两件事很突出

    *   它像 PCL-CVS 一样工作——我熟悉那个包（已经使用了很多年，很多年前）但我对学习如何以 git 方式做事更感兴趣，我认为熟悉的范式会阻碍那个学习。
    *   git 命令在状态缓冲区之外不起作用——我喜欢在更深的层次上集成，否则我可以从 shell 运行我所有的 git 命令并完成它。
2.  magit - 在以 git 方式做事方面似乎要好得多，但同样，有两件事很突出：

    *   改变语义——你提到了几个根据上下文表现不同的命令。通常我是 -dwim 命令的忠实拥护者，但在取消暂存文件和删除文件之间的区别时则不然！
    *   它看起来不如其他一些（例如 egg 或 git-emacs）；从好的方面来说，我确实喜欢图形分支表示
3.  鸡蛋 - 我真的试过这个

    *   magit 有更好的界面，虽然它看起来比 magit 好得多，但我担心它跟不上 magit 的发展
    *   几乎没有任何文件；我遇到了一些问题（我不记得是什么）并且找不到解决方案，所以我放弃了它并继续前进......
4.  git-emacs -- 看起来不错并且有很好的文档

    *   我喜欢的东西：文档、易用性、外观和感觉、内置许多有用的命令、通过 ` **git-cmd** ' 直接访问任何 git 命令、支持 git-blame
    *   我不喜欢的东西：*ido*（不能配置它对我来说是一个主要的关闭，并暗示作者的“我最了解”的态度），缺乏一些基本命令，如*stash*，缺乏任何自定义（再次暗示“我最了解”的态度）

由于我在学习 git 本身方面仍处于起步阶段，因此很难说这些软件包还缺少什么。我计划询问 git-emacs 的作者是否对补丁感兴趣，因为我可能会介绍自定义（关于 ido、面孔和其他正常事物）。无论如何，希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T22:26:46.087

除了核心功能之外，对我来说必不可少的东西是：

*   ediff，即视觉差异，因此您可以正确查看更改的上下文
*   责备/注释，就像常规的 vc 模式一样。通过导航到早期版本、颜色编码等。

# php - 使用 php cli 创建测试环境

> ID：399893
> 
> 赞同：1
> 
> 时间：2008-12-30T09:53:01.023
> 
> 标签：php, shell, environment, command-line-interface

我想在控制台模式下使用 php 并创建一个环境来测试我的功能。

我不想每次想测试一个功能时都被迫使用网络浏览器并创建一个新文件。

我想在控制台中访问该函数，然后返回结果。

我该怎么做呢？

**更新：**

也许我解释得不好。我只想看看函数返回什么结果。

也许我必须学习单元测试，但目前我只想要一个交互式控制台，它可以让我一个一个地测试所有功能。

在我的情况下，我必须加载 wordpress 函数（我知道如何使用常规`.php`文件，然后使用浏览器解析文件），但如果可以从命令行使用 php，我不会这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T11:08:38.827

我想你必须更具体地说明到底是什么功能。Wordpress 不提供开箱即用的功能，大多数 PHP 应用程序不会。

我还认为，如果没有为此类环境开发此类应用程序，那么您就是在找麻烦。

这是一个尝试从functions.php调用“current_time（）”的示例，我必须做的尝试只是为了意识到它不会那样工作：

```
 php -r 'require "functions.php"; var_dump(current_time("mysql"));' 
```

给

```
 Fatal error: Call to undefined function apply_filters() in functions.php on line 346 
```

试

```
 php -r 'require "functions.php"; require "plugin.php"; var_dump(current_time("mysql"));' 
```

给

```
 Fatal error: Call to undefined function wp_cache_get() in functions.php on line 351 
```

试

```
 php -r 'require "functions.php"; require "plugin.php"; require "cache.php"; var_dump(current_time("mysql"));' 
```

给

```
 Fatal error: Call to a member function get() on a non-object in cache.php on line 93 
```

查看我看到的源代码中的最后一个错误

```
 function wp_cache_get($id, $flag = '') {
     global $wp_object_cache;

     return $wp_object_cache->get($id, $flag);
 } 
```

如果不是不可能的话，使用全局变量可以使在其他环境中进行测试成为 PITA。

如果这不是您想要做的，那么您的问题必须更加具体/详细。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T11:47:44.410

我过去使用[过 phpsh](http://www.phpsh.org/)，发现它非常有用。一旦你开始它，你将需要`chdir()`你的文件在哪里，然后显然`require()`任何包含你需要测试的功能的文件。然后，您可以通过在 shell 中键入它们来测试您的函数调用，例如`var_dump(some_function(1, 2));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T09:56:59.580

您将要阅读一般意义上的“单元测试”，然后尝试将它们应用于 PHP。

您正在使用的框架（如果有的话）、代码风格和您要运行的测试将确定您需要使用的确切方法。只有首先了解单元测试的概念并将它们实施到您的编码最佳实践中，您才能在这方面取得进展。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T11:08:37.140

怎么样：

```
php -a 
```

如果你用 readline 支持编译 php，它会更花哨。

# mercurial - Mercurial：冲突合并后编辑器不显示冲突文件

> ID：399897
> 
> 赞同：2
> 
> 时间：2008-12-30T09:55:55.150
> 
> 标签：mercurial

解决了在发生合并冲突时启动编辑器的问题后 - [Mercurial: 检测到合并冲突时不显示编辑器](https://stackoverflow.com/questions/399606/mercurial-no-editor-appears-when-merge-conflicts-are-detected)

我现在有另一个问题，编辑器现在启动，但按以下顺序打开文件：

hello.c hello.c~base.???? 你好.c~其他.????

但我真正想看到的是突出冲突的文件，我希望它应该是第一个 hello.c，但 hello.c 只是显示了提示。

有什么建议吗？

问候，

克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T15:29:16.880

我不确定您使用什么工具进行合并，但听起来它正在执行[3-way merge](http://en.wikipedia.org/wiki/Merge_(revision_control)#Three-way_merge)。左窗格通常是共同祖先，中间窗格是您要合并的文件，右窗格是您对文件的更改。

我真的很喜欢用于合并的 kdiff3（免费和开源），如果您使用的工具不适合您，我会推荐它。它在 mercurial 文档中作为他们在许多地方使用的示例合并。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T20:15:31.763

第一个文件最终是完成的合并，因此您需要确保手动复制其他两个文件的所有更改。Vimdiff 很好地解决了这个问题，因为它突出了三个文件之间的所有差异。我不确定这三个文件是如何生成的，但这个过程似乎对我有用。

# c++ - 指针类帮助

> ID：399907
> 
> 赞同：1
> 
> 时间：2008-12-30T10:02:24.950
> 
> 标签：c++, pointers, sparse-matrix

我正在用 C++ 编写一个稀疏矩阵类，其中每一行和每一列都是来自我创建的类（恰当地命名为：LinkedList）的链表数组。

我想编写一个类，它是指向该矩阵中一个单元格的“智能”指针。

在那个类中，比如说`LIPointer`，我将实现一个`++`运算符函数，用于在矩阵的链表中移动。

每次创建`linkedlistPointer`.

我不能使用`stl::array`等，因为我必须自己构建它们。

以下是声明：

* * *

```
class LinkedItem 
{ 
private:
    int Column, Row;
    double Value;
    LinkedItem* Right;
    LinkedItem* Down;
public:
...
}; 
```

* * *

```
class SparseLinkedMatrix
{
private: //members
    int ColSize;
    int RowSize;
    LinkedItem ** Columns;
    LinkedItem ** Rows;
public: //functions
    SparseLinkedMatrix();
...

}; 
```

* * *

```
class LIPointer;
private:
    LinkedItem * CellPointer;
public:
    LIPointer();
        void operator++();//???
...
}; 
```

任何建议或方向将不胜感激。

**更新**：它需要在整个矩阵上运行。这就是为什么我认为我需要移动（通过引用）数组和矩阵的大小。预期的效果是，这将从第一行的链表中的最后一个单元格到第二行中的第一个单元格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T10:09:39.617

对于压缩行矩阵，我使用类似：

```
    std::vector<std::map<size_t, double> > 矩阵；

```

然后我可以使用以下命令添加一个条目：

```
    矩阵[行][列] += val;

```

对于每一行，我可以按升序遍历列条目并读出值。

编辑：提出问题的人确实指出他们不能使用 STL。也许他们可以使用某种地图而不是链表。否则，我建议使用链表向量并继续在每个列表的末尾添加条目。然后在添加条目完成后对每个链表进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T12:01:08.283

您能否详细说明您希望 operator++() 做什么？

例如，要让 LIPointer 的 operator++() 转到下一个右侧元素：

```
void operator++()
{
    if ( CellPointer != NULL )
        CellPointer = CellPointer->Right;
} 
```

但是，当它到达终点时它会停止。

# ruby-on-rails - 在填充 auto_complete 字段后填充 Rails 表单字段

> ID：399910
> 
> 赞同：3
> 
> 时间：2008-12-30T10:06:59.153
> 
> 标签：ruby-on-rails, ruby

我正在尝试在 Rails 2.2.2 中创建一个表单，该表单根据用户在“auto_complete”字段中所做的选择填充字段。看起来好像observe_field 功能是我需要使用的，但我被困在如何更新现有文本字段的值上。

我试图建模的事件顺序如下：

1) 使用将一些字符输入到 auto_complete 字段中，给出选项列表并选择相关选项。

2) 该选项对应于 ActiveRecord 模型，我想使用来自所选 ActiveRecord 的信息以相同的形式填充另一个字段（即设置默认值）。

感谢您的任何指导

大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T17:21:05.907

有一个 Railscasts 插曲： [http ://railscasts.com/episodes/88](http://railscasts.com/episodes/88)

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-01T20:26:08.730

我最初开始只使用observe_field 功能来观察auto_complete_text_field 值，然后根据用户选择更新另一个值，如下所示，但我无法按照observed_field 的要求引用文本字段的innerHtml

'blur', :frequency => 0.50, :url => {:action => 'update_defaults'}, :with => "'reference_number=' + element.value", :update => 'form_text_field' %>

为了解决这个问题，我最终从 observe_field 中删除了 update 参数，并使用 RJS 从 action 方法中更新到表单字段。

RJS的方法如下：

```
 render :update do |page|
    page['form_text_field'].value = @activity.units
  end 
```

# asp.net-mvc - ASP.NET MVC - 使用相同的表单来创建和编辑

> ID：399914
> 
> 赞同：46
> 
> 时间：2008-12-30T10:09:14.780
> 
> 标签：asp.net-mvc, forms

创建用于创建新模型和编辑现有模型的表单的最佳实践方法是什么？

有没有人们可以指出我方向的教程？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2011-02-02T12:03:32.910

**[NerdDinner](http://nerddinner.codeplex.com/)将*真正*指明方向。**

## 创建.aspx

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<NerdDinner.Models.Dinner>" MasterPageFile="~/Views/Shared/Site.Master"  %>
<asp:Content ID="Title" ContentPlaceHolderID="TitleContent" runat="server">
    Host a Nerd Dinner
</asp:Content>
<asp:Content ID="Create" ContentPlaceHolderID="MainContent" runat="server">
    <h2>Host a Dinner</h2>
    <% Html.RenderPartial("DinnerForm"); %>
</asp:Content> 
```

## 编辑.aspx

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage<NerdDinner.Models.Dinner>"
    MasterPageFile="~/Views/Shared/Site.Master" %>
<asp:Content ID="Title" ContentPlaceHolderID="TitleContent" runat="server">
    Edit: <%:Model.Title %>
</asp:Content>
<asp:Content ID="Edit" ContentPlaceHolderID="MainContent" runat="server">
    <h2>Edit Dinner</h2>
    <% Html.RenderPartial("DinnerForm"); %>
</asp:Content> 
```

## 晚餐表格.ascx

```
<%@ Language="C#" Inherits="System.Web.Mvc.ViewUserControl<NerdDinner.Models.Dinner>" %>
<script src="/Scripts/MicrosoftAjax.js" type="text/javascript"></script>
<script src="/Scripts/MicrosoftMvcAjax.js" type="text/javascript"></script>
<script src="/Scripts/MicrosoftMvcValidation.js" type="text/javascript"></script>
<% Html.EnableClientValidation(); %>
<%: Html.ValidationSummary("Please correct the errors and try again.") %>
   <% using (Html.BeginForm())
      { %>
   <fieldset>
       <div id="dinnerDiv">
           <%:Html.EditorForModel() %>
           <p>
               <input type="submit" value="Save" />
           </p>
       </div>
       <div id="mapDiv">
           <%: Html.EditorFor(m => m.Location) %>
       </div>
   </fieldset>
   <% } %> 
```

考虑到这个表格使用的是`Html.EditorForModel()`，这是一种一次生成所有字段的创新方法，在使用它之前你必须研究它的缺点。但是您可以轻松地使用示例的其余部分将您的常用表单与创建和编辑视图分开。

最后，如果您有兴趣，可以在[此处查看控制器代码。](https://nerddinner.svn.codeplex.com/svn/Trunk/NerdDinner/Controllers/DinnersController.cs)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-30T10:14:31.900

[Scott Gu 将带路](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-30T13:50:01.073

不要使用相同的控制器**动作。**新 = HTTP POST；编辑 = HTTP PUT，所以这是两件不同的事情。不过，这两个动作可以而且应该在同一个控制器上。

我喜欢将用户控件用于通用功能（例如，编辑器），并将其包装在特定于操作的视图中，以便只出现在 new 或 edit 上，但不能同时出现。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-03-27T15:31:51.047

**假设**

1.  这有利于用户在浏览器中看到不同操作的不同 URL。例如“/pages/create”和“/pages/edit/1”。

2.  这对于开发人员来说只有一个动作+视图对来创建和编辑页面是有好处的，因为它们通常非常相似。（此外，每个实体有一个控制器也很好。）

**解决方案**

默认路由注册是 '{controller}/{action}/{id}' 我们可以在此**之前**添加另外两条规则：

{controller}/create（应该指向“CreateOrEdit”动作）

{controller}/edit/{id}（也应该指向“CreateOrEdit”操作）

我们现在可以有这样的东西：

```
public static void RegisterRoutes(RouteCollection routes)
{
  routes.MapRoute(
    name: "Create",
    url: "{controller}/create",
    defaults: new { controller = "Default", action = "CreateOrEdit" }
  );

  routes.MapRoute(
    name: "Edit",
    url: "{controller}/edit/{id}",
    defaults: new { controller = "Default", action = "CreateOrEdit" }
  );

  routes.MapRoute(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new { controller = "Default", action = "Index", id = UrlParameter.Optional }
  );
} 
```

所以现在创建和编辑请求都将由“CreateOrEdit”操作处理。其他人将采用默认方式。

接下来我们应该在控制器中为 HttpGet 和 HttpPost 添加“CreateOrEdit”操作：

```
[HttpGet]
public ActionResult CreateOrEdit(int? id)
{
  return this.View(new CreateOrEditViewModelBuilder(this).Build(id));
}

[HttpPost]
public ActionResult CreateOrEdit(CreateOrEditViewModel сreateOrEditViewModel)
{
  if (this.ModelState.IsValid)
  {
    Page page = new CreateOrEditViewModelMapper(this).Map(сreateOrEditViewModel);

    if (сreateOrEditViewModel.Id == null)
      this.UnitOfWork.GetRepository<IPageRepository>().Create(page);

    else this.UnitOfWork.GetRepository<IPageRepository>().Edit(page);

    this.UnitOfWork.Save();
    return this.RedirectToAction("Index");
  }

  return this.View(сreateOrEditViewModel);
} 
```

最后我们必须添加名为“CreateOrEdit”的视图。我们可以在那里使用“this.Model.Id == null”来了解我们是创建还是编辑。

**结果**

现在我们没有重复的代码，并且可以有这样的明显 url：

/pages（查看所有页面）

/pages/create（创建新页面）

/pages/edit/1（编辑现有页面）

/pages/delete/1（删除现有页面）

我希望它会帮助别人！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T17:24:21.657

它可能是（应该是 IMO）一个控制器，但控制器动作不同。还要确保您有与适当操作相关联的适当 HTTP 动词。按照 E Rolnicki 发布的教程进行操作，您将上路！

编码快乐！！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-24T09:56:40.307

这并不总是最佳实践，因为它取决于具体情况，这就是我的做法

**1/**我结合了控制器动作来创建和编辑

```
public PartialViewResult Creedit(string id = null)
{
    if (id == null)
    {
        // Create new record (this is the view in Create mode)
        return PartialView();
    }
    else
    {
        // Edit record (view in Edit mode)
        Client x = db.ClientSet.Find(id);
        if (x == null) { return PartialView("_error"); }
        // ...
        return PartialView(x);
    }
}

[HttpPost]
[ValidateAntiForgeryToken]
public ActionResult Creedit(Client x)
{
    if (x.id == null)
    {
        // insert new record
    }
    else
    {
        // update record
    }
} 
```

**2/**我将编辑和创建视图合并到一个视图中，我称之为 Creedit

```
// if you need to display something unique to a create view
// just check if the Model is null
@if(Model==null){
} 
```

所以我有 1 个视图和 2 个操作（1 个帖子和 1 个获取）而不是 2 个视图和 4 个操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-30T14:32:32.253

我将表单本身放在用户控件中——比如 Views/Shared/WidgetForm.ascx。我将所有表单字段放在此用户控件中，但不是表单标签本身。

视图，比如 Views/Widgets/New.aspx 和 Views/Widgets/Edit.aspx，其中包含表单标签和所有“环境”——填写表单、页面标题等的说明。然后它们包括表单标签内的用户控件。

用户控件只需要一个 Widget 对象，并根据结果显示一个表单。因此，在新的小部件选项中设置合理的默认值变得很重要，但无论如何你都在这样做，对吧？;)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-30T22:18:10.923

我有一个我认为运行良好的系统。在我的共享视图中，我有 2 个通用表单，Edit.aspx 和 New.aspx

然后在我的特定视图文件夹中，我有一个名为 EditItems.ascx 的控件

在我的编辑表单中，我有用于编辑的表单标签和特定按钮，在新表单中，我有用于新建的表单标签和特定按钮。在每个我都有 Html.RenderPartial("EditItems.ascx")

通过这种方式，您的用户控件可以是强类型的，但您正在重用编辑页面和新页面的外观。

现在，在某些情况下，您的新页面可能具有与编辑页面不同的布局。在这种情况下，只需将“Edit.aspx”添加到您的特定视图文件夹。

我发现这给了我重用的最佳组合，同时在我需要时仍然允许完全定制。至于控制器动作，是的，它们应该是单独的动作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-08T16:13:45.587

如果实体具有某种内部私钥（例如，始终 > 0 的“id”成员），您可以使用 /Edit/0 而不是 /Create

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-15T18:04:37.700

我使用类似的东西

```
[HttpGet]
public ActionResult EntityEdit(Guid id)
{
    return View();
} 
```

和

```
[HttpGet]
public ActionResult EntityCreate()
{
   return View("EntityEdit");
} 
```

这似乎工作正常。

# asp.net - jquery UI 对话框和 Asp.net UpdatePanel

> ID：399919
> 
> 赞同：9
> 
> 时间：2008-12-30T10:11:56.647
> 
> 标签：asp.net, jquery, ajax

我正在为 asp.net 寻找 JavaScript 模式对话框解决方案，jquery UI 对话框看起来不错，但它将对话框容器移动到正文标记的底部。我将对话框代码更改为将对话框保留为 asp.net 形式，但它仍然不在更新面板中。

是否有任何解决方案或更兼容的对话框不会破坏 asp.net 表单的生命周期？

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-07-16T21:52:21.150

当 jquery 创建一个对话框时，它会将对话框 div 附加到 body 标记。这有效地将其移到表单标签之外，因此没有回发。解决方案很简单，这个博客[http://blog.roonga.com.au/2009/07/using-jquery-ui-dialog-with-aspnet-and.html](http://blog.roonga.com.au/2009/07/using-jquery-ui-dialog-with-aspnet-and.html)举例说明。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-30T20:45:36.710

为什么不将 UpdatePanel 放在对话框容器中？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-01T03:28:06.570

虽然我不确定我是否确切地知道你在问什么，但 Dave Ward 有几篇很好的文章：[http ://encosia.com/2008/10/11/using-jquery-to-display-a- modal-updatepanel-confirmation/](http://encosia.com/2008/10/11/using-jquery-to-display-a-modal-updatepanel-confirmation/)和[http://encosia.com/2008/10/04/using-jquery-to-enhance-aspnet-ajax-progress-indication/](http://encosia.com/2008/10/04/using-jquery-to-enhance-aspnet-ajax-progress-indication/)。两篇文章都使用了 jQuery BlockUI 插件。

# java - EJB 计时器是否应该是持久/可靠的？

> ID：399924
> 
> 赞同：6
> 
> 时间：2008-12-30T10:15:46.797
> 
> 标签：java, jakarta-ee, ejb-3.0, timer, ejb

例如，如果我将计时器设置为每天午夜到期，如果一个“失火”（例如，由于服务器关闭而不会触发回调）会发生什么？我在文档中找不到。

有没有办法让这个计时器在服务器重启后立即触发回调？

PS：我知道 Quartz，我正在评估 EJB 计时器作为替代方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T10:44:24.630

您可以使用[TimerHandle](http://java.sun.com/products/ejb/javadoc-2_1-fr/javax/ejb/TimerHandle.html)使计时器持久化。EJB 时代旨在抵御容器崩溃。

有关EJB 时间与其他调度程序系统（如 Quartz）之间的比较，请参阅[本文。](http://www.onjava.com/pub/a/onjava/2004/10/13/j2ee-timers.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-01T07:10:40.583

根据经验，我可以告诉你，在 Glassfish 中，一旦服务器备份，错过的计时器就会触发。如果您的服务器因两次或多次错过的超时而关闭，它只会触发一次，而不是每次错过的超时一次。然后它会回到您定期安排的计划。

# java - 如何让我的 netbeans 拖放小部件知道它是在 netbeans 设计视图窗口还是正在运行的应用程序中呈现？

> ID：399929
> 
> 赞同：0
> 
> 时间：2008-12-30T10:20:47.707
> 
> 标签：java, swing, netbeans, javabeans, designview

如何让我的 netbeans 拖放小部件知道它是在 netbeans 设计视图窗口还是正在运行的应用程序中呈现？

我正在尝试做一些自定义渲染。我认为这与根容器有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-30T13:03:41.933

试试[java.beans.Beans.isDesignTime()](http://java.sun.com/javase/6/docs/api/java/beans/Beans.html#isDesignTime())。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-31T05:34:43.727

这是另一种方法：

```
Component c = javax.swing.SwingUtilities.getRoot(this);
String className = c.getClass().getCanonicalName();
if (!"org.netbeans.core.windows.view.ui.MainWindow"
    .equalsIgnoreCase(className)) { 
```

虽然我认为

```
 Beans.isDesignTime() 
```

方法更好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-31T05:36:42.257

测试

```
Beans.isDesignTime() 
```

用下面的例子

```
package test;

import java.awt.Graphics;
import java.beans.Beans;

import javax.swing.JLabel;

public class TestLabel extends JLabel {
private static final long serialVersionUID = -2438507032083091628L;

public TestLabel() {
    super();
}

public void paint(Graphics g) {
    super.paint(g);

    if (Beans.isDesignTime()) 
        this.setText("Design Time");
    else
        this.setText("Production runtime");
}
} 
```

它有效——这太不可思议了。

# regex - 我可以改进对有效域名的正则表达式检查吗？

> ID：399932
> 
> 赞同：7
> 
> 时间：2008-12-30T10:22:13.163
> 
> 标签：regex, dns, whois

所以，我一直在研究这个域名正则表达式。到目前为止，它似乎选择了带有 SLD 和 TLD（带有可选的 ccTLD）的域名，但是 TLD 列表存在重复。这可以进一步重构吗？

```
params[:domain_name].downcase.strip.match(/^[a-z0-9\-]{2,63}
\.((a[cdefgilmnoqrstuwxz]|aero|arpa)|(b[abdefghijmnorstvwyz]|biz)|
(c[acdfghiklmnorsuvxyz]|cat|com|coop)|d[ejkmoz]|(e[ceghrstu]|edu)|f[ijkmor]|
(g[abdefghilmnpqrstuwy]|gov)|h[kmnrtu]|(i[delmnoqrst]|info|int)|
(j[emop]|jobs)|k[eghimnprwyz]|l[abcikrstuvy]|
(m[acdghklmnopqrstuvwxyz]|me|mil|mobi|museum)|(n[acefgilopruz]|name|net)|(om|org)|
(p[aefghklmnrstwy]|pro)|qa|r[eouw]|s[abcdeghijklmnortvyz]|
(t[cdfghjklmnoprtvwz]|travel)|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw])
(\.((a[cdefgilmnoqrstuwxz]|aero|arpa)|(b[abdefghijmnorstvwyz]|biz)|
(c[acdfghiklmnorsuvxyz]|cat|com|coop)|d[ejkmoz]|(e[ceghrstu]|edu)|f[ijkmor]|
(g[abdefghilmnpqrstuwy]|gov)|h[kmnrtu]|(i[delmnoqrst]|info|int)|
(j[emop]|jobs)|k[eghimnprwyz]|l[abcikrstuvy]|
m[acdghklmnopqrstuvwxyz]|mil|mobi|museum)|
(n[acefgilopruz]|name|net)|(om|org)|
(p[aefghklmnrstwy]|pro)|qa|r[eouw]|s[abcdeghijklmnortvyz]|
(t[cdfghjklmnoprtvwz]|travel)|u[agkmsyz]|v[aceginu]|w[fs]|y[etu]|z[amw]))?$/) 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-12-30T19:08:53.100

请，请，请*不要*使用像这样固定且极其复杂的正则表达式来匹配已知域名。

TLD 列表*不是*一成不变的，尤其是 ICANN 正在考虑简化新 gTLD 的流程。甚至 ccTLD 列表有时也会发生变化！

[查看http://publicsuffix.org/](http://publicsuffix.org/)提供的列表并编写一些能够下载和解析该列表的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-30T21:02:27.380

下载：http: [//data.iana.org/TLD/tlds-alpha-by-domain.txt](http://data.iana.org/TLD/tlds-alpha-by-domain.txt)

示例用法（在 Python 中）：

```
import re
def validate(domain):
    valid_domains = [ line.upper().replace('.', '\.').strip() 
                      for line in open('domains.txt') 
                      if line[0] != '#' ]
    r = re.compile(r'^[A-Z0-9\-]{2,63}\.(%s)$' % ('|'.join(valid_domains),))
    return True if r.match(domain.upper()) else False

print validate('stackoverflow.com')
print validate('omnom.nom') 
```

您可以将域列表构建排除在验证功能之外以提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T10:34:45.417

我可能对域名了解不够。但是为什么像“foo.info.com”这样的域匹配呢？在这种特殊情况下，域名似乎是“info.com”。

您可能需要确保名称以 [az\d] 开头。我认为您不能注册以破折号开头的域？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-30T10:36:42.587

正如你所写的那样，TLD 部分是等价的，但比它长，`(\.<tldpart>){1,2}`但我相信它可以修复重复......

编辑：是的，不，有可能但本质上是一个非常缓慢的蛮力列表来处理我认为的重复。将可能的 TLD 和 SLD+国家/地区对放入一个大哈希图中并检查子字符串更加简单和快捷。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-30T10:38:54.360

您可以将正则表达式构建为字符串，然后执行 Regexp.new(string)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-30T19:55:15.940

我建议从[RFC 1035](http://www.faqs.org/rfcs/rfc1035.html)中列出的规则开始，然后向后工作——但前提是你真的真的需要从头开始这样做。域正则表达式模式必须是（可以说仅次于电子邮件地址正则表达式模式）最常见的东西。我会查看网站[regexlib.com](http://regexlib.com/)并浏览其他人所做的事情。

# algorithm - 检查链表循环

> ID：399937
> 
> 赞同：3
> 
> 时间：2008-12-30T10:28:17.393
> 
> 标签：algorithm

我需要一个将链表作为参数的方法，如果它是循环的，则返回 true 或 false。

ex:circular linkedlist 表示存在指向任何先前节点的节点。我忘了告诉一些限制，我不能使用任何数据结构或动态内存分配。我只能使用局部变量，并且算法可以按照有人对我说的 n 步完成（我现在想使用两个指针？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-30T10:47:52.020

我相信您正在寻找[弗洛伊德的循环查找算法](http://en.wikipedia.org/wiki/Cycle_detection#Tortoise_and_hare)。这里有比我能给出的更好的[解释](http://ostermiller.org/find_loop_singly_linked_list.html)。

在 C 和 Scheme 中也有一些实现，文档在[此处](http://en.literateprograms.org/Category:Floyd%27s_cycle_finding_algorithm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T10:43:44.977

标准哈希计数适用：

```
函数有循环（列表）：
    foreach 列表中的节点：
        地址 = address_of(node.next);
        元素 = hashtable.get(地址);
        如果（元素 == NULL）：
            hashtable.put(地址)
        别的：
            返回真
    返回假

```

*编辑：根据接受的答案的第二个链接，这可行但效率低下，这意味着有很多更有效的解决方案。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T10:44:02.247

这是微不足道的。

```
previousnodes ← set()
previousnodes.add(firstnode)
currentnode ← firstnode.next
while (currentnode in previousnodes) || (currentnode != null):
  previousnodes.add(currentnode)
  currentnode ← currentnode.next
when (currentnode = 0) return false
return true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-12T10:28:53.407

我自己遇到了这个问题的经典解决方案，忍不住把它贴在这里（尽管我猜原来的海报很可能现在已经毕业了）。从起始节点开始，只需开始反转列表。如果列表不是循环的，则该过程将以 Null 结束，如果列表确实是循环的，则该过程将在起始节点处结束。就是这样，一个具有恒定额外空间的线性时间算法。只需再次反转列表即可返回原始列表。

# asp.net-mvc - 我应该使用相同的控制器和视图在 ASP.NET MVC 中编辑和创建模型吗？

> ID：399940
> 
> 赞同：1
> 
> 时间：2008-12-30T10:29:17.610
> 
> 标签：asp.net-mvc

我应该使用相同的控制器和视图在 ASP.NET MVC 中编辑和创建模型，还是应该创建一个视图和控制器动作来创建，一个视图和控制器动作来编辑？

编辑视图肯定会有所不同 - 编辑对象的用户界面与创建视图相同并不总是有意义的，

通过分离视图，我将避免使用大量“if 语句”来确定我是在编辑还是创建......

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-30T10:36:57.453

我看到的建议表明视图与控件中包含的公共元素是分开的，以保持 DRY。

对控制器采用相同的方法似乎是合乎逻辑的——在适当的情况下重用公共部分。

此视图反映在这里[如何干净地重用 Asp.NET MVC](https://stackoverflow.com/questions/304451/how-to-cleanly-reuse-edit-new-views-in-aspnet-mvc)中的编辑/新视图，因为问题非常相似。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T10:40:44.873

AFAIK 这是推荐的：（示例中使用的人）

使用一个控制器来处理这两种情况

在该控制器中，有四个操作：

*   新的（）
*   编辑（int personId）
*   创建（人 p）
*   更新（人p）

两个视图，Person/New.aspx 和 person/Edit.aspx

这两个视图每个都包含发布到各自操作的表单：

*   新建 -> 创建
*   编辑 -> 更新

现在您有两个选择，要么实现表单内容两次（在每个视图中），要么在 PersonForm.ascx 中实现实际表单并使用部分呈现来呈现表单内容。

您选择哪种方式进行最后一种方式取决于表单是否或多或少相同（使用通用控件）或它们是否不同（实现两个不同的）

如果只是新/编辑表单中的不同布局问题，您可能只想引用不同的 css 文件并让 css 处理差异

# asp.net - 可以使用 .NET MembershipProvider 在一个 Web 应用程序上拥有多个虚拟“应用程序”吗？

> ID：399941
> 
> 赞同：1
> 
> 时间：2008-12-30T10:30:23.897
> 
> 标签：asp.net, membership-provider, portal-system

我想从头开始构建类似门户的 asp.net Web 应用程序，并将 asp.net MembershipProvider 视为用户管理的标准方式。我创建了从 SqlMembershipProvider 继承的提供程序并覆盖了 ValidateUser 方法：

```
 public override bool ValidateUser(string username, string password)
        {
            string temp = ApplicationName;
            List<MtscApp> allApps = GetAllApplications();
            foreach (MtscApp app in allApps)
            {
                ApplicationName = app.Name;
                Roles.ApplicationName = app.Name;
                if (base.ValidateUser(username, password))
                {
                    return true;
                }
            }
            ApplicationName = temp;
            Roles.ApplicationName = temp;
            return false;
        } 
```

我正在尝试针对所有应用程序验证输入的凭据，而 GetAllApplicationsMethod() 从 aspnet_Applications 表中获取所有应用程序（我也有在同一个表中插入应用程序的部分）。

如果验证成功，则应用程序名称保留在成员资格和角色提供程序上，否则将保留默认名称，即为匿名用户预定义的应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T20:44:27.790

是的，我曾多次做过类似的事情。唯一的区别是我根据用户进入的 URL 在数据库表中查找应用程序名称，并且只验证那个应用程序。该表有两个字段，URL 和 ApplicationName。ApplicationName 与 aspnet_Applications.ApplicationName 字段的 ApplicationName 相同。

# c++ - 具有相同名称的 C++ 变量，上下文：全局和私有，

> ID：399942
> 
> 赞同：3
> 
> 时间：2008-12-30T10:30:53.800
> 
> 标签：c++, private, global

在下面的代码中，g++ 给出了这个错误： 1.cpp: In member function `void W::test()': 1.cpp:6: error:`int F::glob' is private 1.cpp:19: error: within this context

但是，这里不应该使用全局声明的变量“glob”，而不是“私有”“glob”吗？

```
 #include <iostream.h>

    int glob;
    class F
    {
        int glob;
        public:
        void readIt()
        {
            cin >> glob;
        }
    };

    class W : public F
    {
        public:
            void test()
            {
                glob--;
            }
    };

    int main()
    {
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-30T10:41:35.387

使用范围规则而不是可见性规则访问变量和函数。因为`F::glob`是`glob`在 的范围内`W::test()`，所以使用。但是，`W::test()`无法访问`F::glob`，并导致错误。编译器*不*检查，`::glob`因为在“优先级”范围内有其他东西在它之前（不确定确切的术语）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-30T10:37:34.940

私有 glob 会影响全局 glob，因此错误是正确的，如果您打算使用全局变量，请使用 ::glob 访问全局变量

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-30T10:36:16.537

您可以尝试`::glob--;`改用。这样你告诉编译器使用全局命名空间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-30T10:36:22.150

此处将使用类成员，访问全局变量使用 :: 运算符。

# c++ - C++ 网络凭据

> ID：399944
> 
> 赞同：0
> 
> 时间：2008-12-30T10:31:52.240
> 
> 标签：c++, mfc, credentials

我的 MFC 应用程序中有 Web 服务，我想编写如下内容：

WebService * ws = new WebService(); ws->Credentials = new NetworkCredentials(user, pass);

我在 MFC 中找不到 Credentials 类。MFC中有这样的类吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-30T20:18:59.307

MFC 没有 NetworkCredential 类，但如果您使用 .Net (CLR)，则可以在 System.Net 命名空间中找到[NetworkCredential](http://msdn.microsoft.com/en-us/library/system.net.networkcredential.aspx)（链接是相关的 MSDN 文章）。

# c++ - 您多久检查一次 C++ 新指令中的异常？

> ID：399946
> 
> 赞同：9
> 
> 时间：2008-12-30T10:35:13.090
> 
> 标签：c++, exception

我今天刚开始阅读 Effective C++，到了作者谈论操作符 new 的地步。

这本书很好地解释了如何（以不同程度的优雅）捕获 std::bad_alloc 异常，如果内存不足，操作员 new 可能会引发该异常。

我的问题是：如果没有足够的内存来实例化一个对象，你多久检查一次？为什么？值得麻烦吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-30T16:35:54.033

当我可以回答这个问题时，我会发现异常：

> 一旦你发现了异常，你将如何处理它？

大多数时候，我的回答是，“我不知道。也许我的来电者知道。” 所以我没有发现异常。让它冒泡给更了解的人。

当你捕获一个异常并让你的函数继续运行时，你已经对你的程序说，“没关系。这里一切都很好。” 当你这么说的时候，天哪，一切都还好。所以，如果你的内存已经用完了，那么在你处理完之后`std::bad_alloc`，你就不应该再出现内存不足了。您不应该只从函数中返回错误代码，因为调用者必须明确检查该错误代码，而您仍然内存不足。您对该异常的处理应该释放一些内存。清空一些缓存，将一些东西提交到磁盘等。但是你的程序中有多少功能你真的想负责减少程序的内存使用？

如果您无法解决触发异常的问题，则不要处理异常。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-30T10:56:22.860

问题是当你用完内存时，除了写入故障转储并退出程序之外，你通常无能为力。因此，检查程序中的每个新内容是没有用的。

一个例外是当您为例如加载文件分配内存时，在这种情况下您只需要通知用户没有足够的内存可用于请求的操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-30T10:52:59.997

我认为最重要的是始终意识到您可能会耗尽内存。然后决定你是否关心。考虑尝试并捕获每个分配 - 这很麻烦。在提高生产力和更简单的代码与可以优雅地处理无内存情况的应用程序之间进行选择。我认为这两种收益在正确的情况下都非常有价值，因此请谨慎选择。

是的，你可以通过定义一个模板基类来让你的生活更轻松，它提供了一个自定义的 operator new 和 operator delete 并设置了一个新的 new-handler。然后，您可以使用[Curiously Recurring Template](http://en.wikipedia.org/wiki/Curiously_Recurring_Template_Pattern)模式从这个基类派生。然后，您的派生类将优雅地处理错误分配，但您仍然需要记住在您创建的每个新类上都从该基类派生。通常，您最终可能会得到多重继承，这可能会带来其自身的复杂性。无论您如何处理错误分配，您的代码都不会像您不打扰那样简单。

这个问题从来没有一个答案。这是您必须做出的选择，与往常一样取决于上下文。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-30T11:08:12.260

绝不。我一直认为默认行为（有一个 std::bad_alloc 异常，它没有被处理，因此程序以错误消息终止）对于我工作过的应用程序来说是好的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-30T11:18:23.300

不处理异常将使您的程序崩溃，您获得的支持请求将介于“不起作用”、“随机崩溃”和“我失去了那天的所有工作”之间。如果您认为这没问题，那么确实不值得麻烦。

您至少可以告诉用户他确实内存不足，至少给他（或支持）一个线索，为什么应用程序随机崩溃。

此外，您可以尝试保留结果，例如将它们保存到恢复文件中。不过，在遇到问题之前，这可能更容易做到。

如果您可以提供诸如“您无法插入此图像，因为内存不足”之类的错误消息，那将是非常棒的。你会继续工作，就好像什么都没发生一样。但是，这意味着用户命令背后的所有代码都必须是事务性的，并提供[强大的异常安全保证](http://en.wikipedia.org/wiki/Exception_handling#Exception_safety)。

* * *

因此，确定随机耗尽内存的成本。在此基础上，评估您需要为用户提供的“保护级别”。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-30T11:04:12.407

在使用虚拟内存的系统中，`malloc()`不会返回`NULL`，new 不会返回`std::bad_alloc`；他们将返回一个虚拟地址。当你写入这个地址指向的内存区域时，系统会尝试将虚拟地址映射到物理地址。如果没有更多可用内存，则会出现页面错误。

所以`std::bad_alloc`当你在一个没有 MMU 的嵌入式系统上时，你会发现，并希望你能做一些事情来释放一些内存。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-30T11:37:46.350

我认为这在很大程度上取决于您编写的应用程序的类型。如果我要写一些不影响系统全局稳定性的东西，比如游戏或电影播放器​​，我不会检查那个异常。我的应用程序会调用`std::terminate`并且我可以将它记录在某个地方，或者我的内核会首先杀死我的程序以为其他程序腾出空间。

如果我编写一个程序，其稳定性直接与其运行的系统相对应，比如说视频驱动程序或初始化系统，我会一直检查内存异常（可能将分配包装在一个函数中），并得到一些在分配失败的情况下，从预先分配的池中获取内存。

我认为这一切都取决于比例。如果由于您的激进检查而开始放慢播放电影的速度，您可以从一个非常稳定的电影播放器​​中获得什么？

顺便说一句，当某些系统的内存不足时，有人回答 malloc 不会返回 0。没错，但是正如 malloc 的联机帮助页指出的那样（特定于 Linux）

> 如果在不希望突然丢失一些随机选择的进程的情况下使用 Linux，并且内核版本足够新，则可以使用以下命令关闭这种过度使用行为： `$ echo 2 > /proc/sys/vm/overcommit_memory`
> 
> 另请参阅内核文档目录、文件 vm/overcommit-accounting 和 sysctl/vm.txt。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-30T10:41:50.563

如果您必须为例如路径缓冲区分配内存，而您知道它将只有几个字节，那么这可能不值得麻烦。

但是当您必须为更大的对象（如图像或文件）分配内存时，您绝对应该进行检查。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-31T16:05:56.323

除非您使用诸如 RAII（资源获取即初始化）模式之类的东西，否则这通常是不值得的。在这种情况下，您可能会在构造函数中分配远程资源，其中可能包括使用 new 创建一个大缓冲区。

在这种情况下，最好在构造函数中捕获异常。此外，由于这是在 RAII 中，很可能只是资源需要太多内存，这允许您为用户提供更多描述性错误消息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-02T14:58:16.977

过去，您的程序在分配最后一个可能的字节之前因交换死亡方式而死亡，硬盘访问的页面文件与您的地址空间大小相同。但是对于拥有 4GB+ 内存但运行 32 位进程的现代系统，这种行为就不太常见了。即使是最大的进程也可能获得它们可以处理的所有物理 RAM。在这些情况下，它们可能会在硬盘死机之前耗尽内存。

但是，没有通用的处理策略。任何实现了缓存的进程都应该刷新这些缓存——但是当操作系统发出内存不足的信号时，一个好的缓存已经被刷新了。响应用户请求的进程可以在用户请求粒度上处理 bad_alloc。如果用户操作的内存不足，则保持分配的内存通常没有什么好处。相反，恢复到用户操作之前的状态。另一方面，非交互式进程可能会从 O(N) 切换到较慢的 O(N log N) 算法。

# visual-studio-2008 - 如何在 Visual Studio (2008) 中创建空解决方案？

> ID：399955
> 
> 赞同：27
> 
> 时间：2008-12-30T10:39:46.340
> 
> 标签：visual-studio-2008

我无法在 Visual Studio 中创建空解决方案。msdn 文档说这是可能的，但没有提到如何。（无论如何，我看过的地方..）

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-12-30T10:46:07.810

文件 --> 新项目

在项目类型下，选择“其他项目类型”-> Visual Studio 解决方案

你应该在右边看到它！

![看看这里](https://i.stack.imgur.com/4chzl.gif)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-30T10:41:39.583

新项目 > 其他 > Visual Studio 解决方案 > 空解决方案

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-23T02:31:22.203

对我很好

创建一个新项目...然后创建另一个项目并将其添加到第一个项目（不要创建第二个）只有在这样做之后我才能看到解决方案图标和文本“解决方案'xxxxxx'（2个项目)'...

# python - 如何在 Eclipse 中集成 pep8.py？

> ID：399956
> 
> 赞同：90
> 
> 时间：2008-12-30T10:39:53.813
> 
> 标签：python, eclipse, pydev, pep8

一点背景：

*   [PEP 8](http://www.python.org/dev/peps/pep-0008/)是*Python 代码的样式指南*。它包含所有 python 程序员应该遵循的约定。
*   [根据 PEP 8， pep8.py](http://pypi.python.org/pypi/pep8)是一个（非常有用的）脚本，用于检查给定 python 脚本的代码格式。
*   [Eclipse](http://www.eclipse.org/)是一个很棒的 IDE。使用[Pydev](http://pydev.sourceforge.net/)扩展，可用于开发 Python

我在编写脚本时手动运行 pep8.py，但对于较大的项目，我更喜欢使用 Eclipse。在 Eclipse/Pydev 中集成 pep8.py 非常有用，因此它可以在项目中的所有文件中自动运行，并指向包含警告的行。也许有一个明显的方法可以做到这一点，但我还没有找到它。

问题是：**如何在 Eclipse 中集成 pep8.py？**

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2011-12-16T09:32:19.627

从 PyDev 2.3.0 开始，`pep8`默认情况下集成在 PyDev 中，甚至附带它的默认版本。

打开窗口 > 首选项

它必须在 PyDev > Editor > Code Analysis > pep8.py 中启用

错误/警告应显示为标记（与常规代码分析中的其他内容一样）。

如果未分析文件，请参阅[https://stackoverflow.com/a/31001619/832230](https://stackoverflow.com/a/31001619/832230)。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2010-02-19T12:36:16.743

我不知道如何将它集成到整个项目中，但我已将它用作分析单个文件的外部工具。

请注意，该[`pycodestyle`](https://pypi.python.org/pypi/pycodestyle/)软件包是该软件包的官方替换版本，并且是该[`pep8`](https://pypi.python.org/pypi/pep8/)软件包的较新版本。要安装它，请运行：

```
$ sudo pip install --upgrade pycodestyle 
```

接下来，在 Eclipse 中：

1.  选择**运行-外部工具-外部工具配置...**
2.  选择**程序**根节点。
3.  按**新的启动配置**按钮。
4.  输入启动配置的**名称**。我用`pycodestyle`.
5.  填写以下字段：

    **地点**——`${system_path:pycodestyle}`

    **工作目录**——`${container_loc}`

    **参数**—— `"${resource_name}"`（这使用当前活动的文件。）

转到**Common**选项卡并确认**Allocate Console**复选框已选中。

这种方法的一个好处是您可以使用非常最新版本的包，而不仅限于 PyDev 中包含的旧版本。`pylint`如果您对以类似方式进行设置感到好奇，请参阅[此答案](https://stackoverflow.com/a/39863131/832230)。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-01-12T04:55:42.220

1.  打开你的 Eclipse
2.  转到帮助并选择安装新软件
3.  单击添加按钮，将出现“添加存储库”对话框
4.  您可以使用任何您喜欢的名称。（我使用了 PyDev）
5.  对于位置，输入“http://pydev.org/updates”
6.  单击确定。
7.  您现在正在安装过程中。只是等待它完成。
8.  安装完成后，关闭 Eclipse 并再次打开。
9.  现在 PyDev 已安装在您的 Eclipse 中，转到 Window->Preferences
10.  选择 PyDev->Editor->代码分析
11.  转到 pep8.py 选项卡
12.  选择警告单选按钮，然后单击确定。

就是这样。您的 Eclipse IDE 现在已与 PEP8 集成。要自动运行 pep8.py，请右键单击您的项目编辑器。选择 PyDev 并点击“代码分析”。在工作区的问题选项卡中，您将看到指向您在 PEP8 中违规的行的警告（如果您已违规）。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-11-27T07:19:03.230

**代码分析：**

在 Eclipse ( **PyDev** ) 中，如果您想使用 pep8 样式进行**代码分析，那么**

转到：Windows -> 首选项 -> PyDev -> 编辑器 -> 代码分析 -> **pep8.py**选项卡并选择**警告**单击应用和确定按钮。

在你的 python 代码中，如果你验证 pep8 编码风格，它会给你警告

**自动代码格式化：**

在 Eclipse ( **PyDev** ) 中，如果您想使用 pep8 样式**自动格式化python 代码，那么**

转到：Windows -> 首选项 -> PyDev -> 编辑器 -> 代码样式 -> 代码格式化程序 -> 单击复选框（**使用 autopep8.py 进行控制台格式化？**）单击应用和确定按钮。

如果要在下面增加行长（pep8 默认为 79）使用 autopep8.py，**`--max-line-length=150`**如果将最大长度设置为 150，则可以设置参数类型

如果按自动格式化快捷键（**Ctrl + Shift + f**），它将自动格式化您的 python 代码，如 pep8 样式

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-12-31T15:47:42.180

这似乎还没有完全集成到 Pydev 中。

正如[这篇文章](http://osdir.com/ml/ide.eclipse.plugins.pydev.user/2007-01/msg00011.html)所建议的，

> [它] 需要更改 pydev 中的代码——一个灵活的选项是添加首选项，让用户选择他想要匹配的模式以创建超链接（并说明匹配中的哪个组是行，哪个是文件）...
> 
> 或者，您可以尝试使用硬编码玩：[org.python.pydev.debug.ui.PythonConsoleLineTracker](https://garage.maemo.org/pipermail/pluthon-commits/2007-October/000256.html)（应该很容易掌握）。

[确实存在](https://garage.maemo.org/tracker/index.php?func=detail&aid=935&group_id=247&atid=989)一个请求，但它似乎在创建一年后仍然开放......

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-10-30T19:53:36.490

你没有:) 相反，你利用与 PyLint 的非常好的集成并配置 PyLint 来检查 PEP8 检查的所有内容。请参阅[如何配置 PyLint 以检查 PEP8 检查的所有内容？](https://stackoverflow.com/questions/6879640/)

# python - 在 python 中选择简单数据库中的项目时需要帮助

> ID：399957
> 
> 赞同：2
> 
> 时间：2008-12-30T10:40:07.387
> 
> 标签：python, sql, circuit, eda

我正在尝试用 Python 编写电路原理图绘图工具。我正在基于包含所有组件及其属性的字典创建一个简单的数据库。我还在尝试创建一种简单的查询语言，您可以在其中选择，例如，所有电阻值>100ohms 或footprint='0402'

到目前为止，我可以使用一些原始谓词搜索来选择事物，然后对更复杂的事物进行联合和交集。

但是，我无法定义纯否定搜索的语义应该是什么。例如，像

足迹！='0402'

应该选择所有足迹不等于 0402 的项目。但是只用交叉点执行此操作会给我一个空白结果。为此，我需要选择*所有*组件，然后与“not 0402”相交以删除我不想要的组件。

但这似乎是一种蛮力，似乎是一个可疑的解决方案。我对使用“真正的”数据库和查询语言不感兴趣，所以请不要这样做。我在这里寻找适当的工程原理，不一定是解决问题的方法。

这个问题在 SICP 书中有所涉及，但我很困惑，因为我认为他们也在使用延续和东西，我还没有得到。

有人可以解释一下消极选择东西的“正确”用法应该是什么。我在商业 cad 工具中尝试过，它按预期工作，但后来我看到了一些 SQL 查询示例（我认为），它们*首先*选择了一些东西，然后删除了不需要的东西。

谢谢
迈克尔

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-30T11:26:39.477

有了合适的数据库，您会更开心。

你的 Python 发行版中有 SQLite。只需定义表而不是字典并使用 SQL。

如果您需要更多的功能和复杂性，您可以添加[SQLAlchemy](http://www.sqlalchemy.org/)（或[SQLObject](http://www.sqlobject.org/)），您将不会遇到这些问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T10:58:05.367

这真的取决于你是如何实现这个“基于字典的简单数据库”的，为什么直接否定不起作用——你必须给我们更多的线索。

没有理由为什么直接的否定匹配*不应该*在 Python 中工作，例如：

```
components = [
    { 'name': 'resistor', 'footprint': '0402', },
    { 'name': 'LED', 'footprint': '0100', },
    { 'name': 'speaker', 'footprint': '2000', },
]

[comp for comp in components if comp['footprint'] != '0402']
# [{'footprint': '0100', 'name': 'LED'}, {'footprint': '2000', 'name': 'speaker'}] 
```

总的来说，这是一个基于字典的简单数据库——具体功能实际上取决于您的实际实现。

我拒绝建议使用真正的数据库和查询语言，因为我认为这是一个学习练习。这是一个学习练习，对吧？:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-30T12:18:40.573

我同意 S.Lott 的观点，你会更喜欢真正的数据库。SQLite 真的很轻快，使用起来几乎没有缺点。

如果您确实需要向用户公开更简单但完整的查询语言，请检查[JSONPath](http://goessner.net/articles/JsonPath/)或[JSONQuery](http://www.sitepen.com/blog/2008/07/16/jsonquery-data-querying-beyond-jsonpath/)（第二个是第一个的超集）。确切的语法（显然）是为 JavaScript 考虑的；但它应该给你一些想法。

此外，尝试检查与 XPath 和 XQuery 的异同。它有助于了解什么是有用的，什么是特定于文化的。

# iphone - 我如何检查代表是否有效？

> ID：399959
> 
> 赞同：1
> 
> 时间：2008-12-30T10:40:52.003
> 
> 标签：iphone, delegates, protocols

我正在做这样的事情：

```
@protocol CallbackDelegate
-(void) performCallback;
@end

@interface MyObject : NSObject {
   id<CallbackDelegate> delegate;
}

-(void)AsyncFuncCall;

@end

@property (nonatomic, assign) id<CallbackDelegate> *delegate; 
```

拥有的代码`MyObject`设置一个委托来接收回调函数：

```
MyObject *myobject = [[MyOject alloc] init];
myobject.delegate = x; 
```

然后在 中`MyObject`，作为异步函数调用的结果，我将向委托发回信号：

```
-(void)AsyncFuncCall {
   [delegate performCallback];
} 
```

除了我的代表由于有效的内存清理而被释放的情况外，大多数情况下似乎一切都运行良好。在这种情况下，我只想不执行回调

有谁知道检查代表是否有效的最佳方法？

我尝试了各种各样的事情，例如：

```
if (delegate != nil) {
   ...
} 
```

没有运气。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-30T13:36:48.480

您的委托应在其 dealloc 中取消 myObject 的委托属性以避免这种情况：

```
- (void) dealloc {
  if (myObject.delegate == self) myObject.delegate = nil;
  [super dealloc];
} 
```

或者，但不推荐，您可以保留委托。但是，这可能会导致[保留周期](http://www.stepwise.com/Articles/Technical/HoldMe.html)。

# asp.net-mvc - 如何在基于 ASP.NET MVC 的 FCKeditor 中设置配置或服务器上传图片？

> ID：399965
> 
> 赞同：2
> 
> 时间：2008-12-30T10:43:28.207
> 
> 标签：asp.net-mvc, fckeditor

我在我的 asp.net mvc beta 应用程序中使用 FCKeditor 作为 Web 编辑器。

我在 Create.aspx 页面中插入了 FCKeditor 并且 FCKeditors 的每个功能都运行良好，除了从我的本地 pc 上传图像文件:(

我将一些配置更改为[FCKeditor 的文档](http://docs.fckeditor.net/FCKeditor_2.x/Developers_Guide/Configuration/Built_in_File_Browser)

这下我变了

fckconfig.js

```
var _FileBrowserLanguage    = 'aspx' ;  // asp | aspx | cfm | lasso | perl | php | py
var _QuickUploadLanguage    = 'aspx' ;  // asp | aspx | cfm | lasso | perl | php | py 
```

配置文件

```
Enabled = true; 
```

我创建了名为“userfiles”的文件夹，其访问角色是 ASPNET 用户的所有内容。

'userfiles' 文件夹位于`MyAppRoot/userfiles and MyAppRoot/Views/userfiles`.

然后，我尝试在图像文件浏览器中上传图像文件，但没有任何反应。

我需要一些东西来配置更多吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-31T05:47:29.020

糟糕，我忘了参考 .Net [FredCK.FCKeditorV2](http://sourceforge.net/project/showfiles.php?group_id=75348&package_id=137125)的文件:)

它工作正常。

# powershell - 在 PowerShell 中共享文件夹和设置权限

> ID：399971
> 
> 赞同：17
> 
> 时间：2008-12-30T10:45:30.323
> 
> 标签：powershell, permissions, directory, share

我需要一个在 Vista Ultimate 上运行的脚本来共享一个外部驱动器并将完全控制权分配给每个人。我有一个批处理文件来使用创建共享`net share`，但似乎没有办法更改权限。我认为这在 PowerShell 中一定是可能的，但我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-10-07T00:30:08.760

如果您正在寻找这个问题的答案，但您运行的是 Windows 7（而不是 Vista），就像我一样，您可能有兴趣知道现在可以直接在 NET SHARE 命令中设置权限.

例如，

NET SHARE 电影=M:\Movies /GRANT:Everyone`，阅读

将创建一个共享并授予每个人对其的只读权限。

除了 READ，您也可以使用 CHANGE 或 FULL。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-12-15T15:47:27.247

从 WMF 4 开始：

```
New-SmbShare –Name ShareName –Path C:\LocalFolder –FullAccess Username 
```

[http://technet.microsoft.com/en-us/library/jj635722.aspx](http://technet.microsoft.com/en-us/library/jj635722.aspx)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-30T14:56:54.123

两个答案。

在 PowerShell 中，Get-ACL cmdlet 将检索现有权限。然后使用 .NET 命令修改这些命令，并运行 Set-ACL 将其应用回文件夹 - 这两个 cmdlet 的帮助包含示例，您可以从 www.sapienpress.com 下载书籍示例，以获取“Windows PowerShell: TFM " = 本书还包含明确的示例。

但是，这不值得您花时间。实际上，文件 ACL 处理起来非常痛苦，而且非常复杂。微软已经编写了很好的工具来做到这一点，比如 Cacls，而且使用这些工具要容易得多。

现在这就是所有 FILE 权限 - 您可能还对更改 SHARE 本身的权限感兴趣。该工具是 SUBINACL，您可以从 Microsoft 下载它。另请参阅[http://cwashington.netreach.net/depo/view.asp?Index=1127&ScriptType=vbscript](http://cwashington.netreach.net/depo/view.asp?Index=1127&ScriptType=vbscript)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-08-28T20:15:35.863

[Carbon](http://get-carbon.org) PowerShell 模块有两个函数可以为您执行此操作： Install [-SmbShare](http://get-carbon.org/help/Install-SmbShare.html)和[Grant-Permission](http://get-carbon.org/help/Grant-Permission.html)。我会[下载它](https://bitbucket.org/splatteredbits/carbon/downloads)并试一试。

```
Install-SmbShare -Name MyShare -Path X:\ -FullAccess 'Everybody' `
                 -Description 'My super-awesome file share!' 
Grant-Permission -Identity Everyone -Permission FullControl -Path X:\ 
```

免责声明：我是 Carbon 的作者和创造者。我建议使用这个模块，因为在安装共享和授予权限时需要注意很多警告和坑洞。这两个功能会为您解决这个问题。

# .net - NUnit“无法加载文件或程序集'MyTestProject'

> ID：399972
> 
> 赞同：30
> 
> 时间：2008-12-30T10:45:32.290
> 
> 标签：.net, 64-bit, nunit, continuous-integration

我正在设置一个新的 64 位机器作为构建服务器运行。当我尝试将我的 NUnit 测试程序集加载到 NUnit GUI 中时，出现以下错误。

没有什么明显的缺失，所有的依赖似乎都存在。所有的 DLL 都是为 x86 平台编译的。

使用 NUnit 2.4.7。我尝试升级到 2.4.8，但出现同样的错误。

> System.IO.FileNotFoundException：无法加载文件或程序集“MyTestProject”或其依赖项之一。该系统找不到指定的文件。

System.IO.FileNotFoundException...

```
Server stack trace: 
   at System.Reflection.Assembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection)
   at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
   at System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection)
   at System.Reflection.Assembly.Load(String assemblyString)
   at NUnit.Core.Builders.TestAssemblyBuilder.Load(String path)
   at NUnit.Core.Builders.TestAssemblyBuilder.Build(String assemblyName, Boolean autoSuites)
   at NUnit.Core.Builders.TestAssemblyBuilder.Build(String assemblyName, String testName, Boolean autoSuites)
   at NUnit.Core.TestSuiteBuilder.BuildSingleAssembly(TestPackage package)
   at NUnit.Core.TestSuiteBuilder.Build(TestPackage package)
   at NUnit.Core.SimpleTestRunner.Load(TestPackage package)
   at NUnit.Core.ProxyTestRunner.Load(TestPackage package)
   at NUnit.Core.ProxyTestRunner.Load(TestPackage package)
   at NUnit.Core.RemoteTestRunner.Load(TestPackage package)
   at System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]& outArgs)
   at System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg, Int32 methodPtr, Boolean fExecuteInContext)

Exception rethrown at [0]: 
   at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
   at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
   at NUnit.Core.TestRunner.Load(TestPackage package)
   at NUnit.Util.TestDomain.Load(TestPackage package)
   at NUnit.Util.TestLoader.LoadTest(String testName) 
```

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-30T13:19:08.000

解决方案是为“AnyCPU”而不是 32 位构建测试项目。我可以解决使我们使用 32 位的限制。

感谢 David 和 Joe90 的建议。我当然学到了一些新东西。fuslogvw.exe 很棒，我以前不知道它存在。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-07-05T19:37:24.540

如果确实需要为 x86 构建测试项目，可以使用 nunit-x86。

[请参阅http://www.nunit.org/index.php?p=nunit-gui&r=2.4.2](http://www.nunit.org/index.php?p=nunit-gui&r=2.4.2)上的“64 位平台上的 NUnit” 。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-30T10:49:28.193

使用（从 Visual Studio 命令提示符以管理员身份运行）激活 Fusion 日志，[`fuslogvw.exe`](http://msdn.microsoft.com/en-us/library/e74a18c4.aspx)以查看程序集加载器尝试加载的内容以及所有发生的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-08T15:03:44.480

在这篇文章之后找到了解决方案：[“无法加载文件或程序集'X.dll'或其依赖项之一。找不到指定的模块。” - 在主机服务器上](https://stackoverflow.com/questions/7472421/could-not-load-file-or-assembly-x-dll-or-one-of-its-dependencies-the-specifi)，更具体地说，使用[http://dependencywalker.com/](http://dependencywalker.com/)

# javascript - 缩小版的 jQuery 或 Prototype - JS 框架选择

> ID：399973
> 
> 赞同：8
> 
> 时间：2008-12-30T10:46:07.060
> 
> 标签：javascript, jquery, ajax, prototypejs, javascript-framework

在为我的下一个项目考虑 JS 框架时，我可以清楚地看到规模向 jQuery 倾斜，然而，Prototype 也得到了很好的评价。

我正在考虑的问题是如何**缩小这些以仅具有我真正需要的功能。**例如，最新的 jQuery 似乎是 55k 压缩的，我显然只需要最需要的基本功能或跨浏览器兼容性。

手动编写我需要的代码的替代方案听起来很痛苦。

有没有人遇到过一些“ **jQuery downscaler** ”或“Prototype downscaler”？像 Dlite 这样的东西并没有完全解决它，因为我需要带有超时的跨浏览器 AJAX，以及跨浏览器 cookie 处理，但也许还有其他一些轻量级的解决方案？

因为我正在做一个基于 PHP 的解决方案，所以与 ASP 相关的捆绑包将无济于事。

对此的任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-30T10:52:29.607

检查这些框架：

*   [Midori](http://www.midorijs.com/) ( *45KB 未压缩*)
*   [SimpleJS](http://simplejs.bleebot.com/)（*核心文件：4KB）*
*   [DOMAssistant](http://www.domassistant.com/)（*压缩后的 7KB）*

如果您想要一个完整但轻量级的解决方案，我建议您使用*Midori*或*DOMAssistant*。

最后，这里是一个链接，将向您展示框架之间的差异：[http ://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)

**[编辑]**

[这篇文章](https://stackoverflow.com/questions/74048/what-is-the-best-lightweight-javascript-framework)也可以帮助您进行研究。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-31T04:06:30.410

使用 YUI 压缩器压缩和缩小 jQuery 大约 10k：

[http://www.julienlecomte.net/blog/2007/08/13/](http://www.julienlecomte.net/blog/2007/08/13/)

这对于您在 jQuery 中获得的功能数量来说*非常*小。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-30T15:19:54.060

只需缩小&gzip。你只会得到 15kb 左右。不是很大，不是吗？:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-01T22:04:53.040

你有没有考虑过[mootools](http://mootools.net/)？它允许您[构建](http://mootools.net/core)自己的文件，使您能够选择所需的任何内容并下载它，而不会获得将来可能不会使用的任何内容。

另外，它是一个非常强大的库，并且经常更新。

我会认真考虑的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-30T14:06:09.280

我使用[打包版本的 Prototype + Scriptaculous](http://groups.google.com/group/prototype-core/files)，重量为 146k。您可以自行获得大约 76K 的 Prototype 打包版本。

由于 Prototype 是非常自我引用的（Prototype 使用自己的快捷方式来构建自己），因此没有真正简单的方法可以去除其中的一些部分并制作“更轻”的版本。

自从 Prototype 发布以来，我一直在使用它，并且必须说我对它非常满意。但是在文件大小方面，其他框架有更小的替代方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-30T16:34:00.713

文件大小真的是个大问题吗？最大的收获来自简单地 gzip 压缩你的 javascript 文件；除此之外，根据我的经验，缩小文件大小只会减少几个百分点。而且由于这些库是开源的，因此可读性不是风险。请记住，您只需加载一次 javascript 库。用户的缓存会为您准备好。

就个人而言，我使用 Prototype 和 script.aculo.us。对我来说，它们非常直观。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-11T13:12:48.987

[reglib](http://code.google.com/p/reglib/downloads/list)有 40 kb。

尼可

# vba - 创建一个搜索标题并复制粘贴列的 Excel 宏

> ID：399975
> 
> 赞同：0
> 
> 时间：2008-12-30T10:47:16.293
> 
> 标签：vba, excel

我是 Excel 宏的新手。我有一些列的标题分散在许多工作表中。我想在某个具有光标的列中键入一个标题，并将具有该标题的列复制粘贴到具有光标的列。

是否可以通过录制宏来做到这一点？如何？如果没有，我该如何以编程方式进行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T00:58:05.610

以下是有关复制找到的列的代码的一些注释。

```
Dim ws As Worksheet
Dim r As Range
Dim CopyTo As String

'You must run the code from a suitable active cell '
strFind = ActiveCell.Value
'Assumes the column data will be written into the next row down '
CopyTo = ActiveCell.Offset(1, 0).Address

'Look at each worksheet'
For Each ws In ActiveWorkbook.Worksheets
    'Skip the active worksheet '
    If ws.Name <> ActiveSheet.Name Then
        'Get the last cell and row'
        lc = ws.Cells.SpecialCells(xlCellTypeLastCell).Column
        lr = ws.Cells.SpecialCells(xlCellTypeLastCell).Row

        'Use the first row for search range '
        Set r = ws.Range(ws.Cells(1, 1), ws.Cells(1, lc))

        'Find the first whole cell to match the active cell '
        Set f = r.Find(strFind, , , xlWhole)
        'If it is found ... '
        If Not f Is Nothing Then
           'Copy the whole column to the copy position '
           ws.Range(ws.Cells(2, f.Column), _
           ws.Cells(lr, f.Column)).Copy (ActiveSheet.Range(CopyTo))
        End If
    End If
Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-30T12:19:57.637

标题是否在不同的工作表中多次出现？如果没有，那么我建议使用简单的 if 语句

if ('columnheading' = '要检查的列','line1ref', 'line1refin 其他工作表')

您必须检查每一列才能执行此操作。

是否有很多工作表，列是否总是在同一位置？

# sql - 如何从命令行测试 SQL 的有效性？

> ID：399978
> 
> 赞同：7
> 
> 时间：2008-12-30T10:48:15.700
> 
> 标签：sql, validation, command-line, ansi-sql

是否有一个很好的工具可以确保 SQL 查询是有效的 ANSI SQL，以及哪些 DBMS 将无法解释它？我找到了[http://developer.mimer.com/validator](http://developer.mimer.com/validator)但我想知道是否有命令行工具，最好是开源的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-01-08T09:42:29.650

这是一个[SQL 库](http://sqlparser.com/features/sql-formatter.php)，可以帮助您通过命令行进行[供应商特定的离线 SQL 语法检查](http://www.dpriver.com/blog/list-of-demos-illustrate-how-to-use-general-sql-parser/vendor-specific-offline-sql-syntax-check/)，Java 和 .NET 演示都可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T14:07:09.480

也许像 ANTLR 或 JavaCC 这样的解析器/生成器已经构建了 ANSI SQL 92 语法。如果是这样，您可以运行解析器/生成器，构建出来的类，并且 Bob 是您的叔叔。

我看到 ANTLR[有一个](http://www.antlr.org/grammar/list)基于 Oracle PL/SQL 的。也许这可以帮助你。ANTLR 是一个了不起的工具，非常值得了解。

# python - 忽略 Python 中的 XML 错误

> ID：399980
> 
> 赞同：6
> 
> 时间：2008-12-30T10:48:33.093
> 
> 标签：python, xml, minidom

我在 Python 中使用 XML minidom (xml.dom.minidom)，但是 XML 中的任何错误都会杀死解析器。是否可以忽略它们，例如浏览器？我正在尝试用 Python 编写浏览器，但如果标签不完全兼容，它只会引发异常。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-30T10:57:54.883

有一个名为[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)的库，我认为这就是您要寻找的。当您尝试解析无效的 XML 时，普通的 XML 解析器将无法工作。BeautifulSoup 更容​​错，它仍然可以从无效的 XML 中提取信息。

> Beautiful Soup 是一个 Python HTML/XML 解析器，专为屏幕抓取等快速周转项目而设计。三个功能使其功能强大：
> 
> 1.  如果你给它错误的标记，Beautiful Soup 不会窒息。它会生成一个解析树，其意义与您的原始文档大致相同。这通常足以收集您需要的数据并逃跑。
> 2.  Beautiful Soup 提供了一些用于导航、搜索和修改解析树的简单方法和 Pythonic 习惯用法：用于剖析文档和提取所需内容的工具包。您不必为每个应用程序创建自定义解析器。
> 3.  Beautiful Soup 自动将传入文档转换为 Unicode，将传出文档自动转换为 UTF-8。您不必考虑编码，除非文档未指定编码并且 Beautiful Soup 无法自动检测编码。然后你只需要指定原始编码。
> 
> Beautiful Soup 解析你给它的任何东西，并为你做树遍历的东西。您可以告诉它“查找所有链接”，或“查找类 externalLink 的所有链接”，或“查找所有 url 匹配“foo.com”的链接，或“查找带有粗体文本的表格标题，然后给出我那条短信。”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-30T16:05:16.170

应该注意的是，虽然 HTML 看起来像 XML，但它不是 XML。XHTML 是一种 XML 形式的 HTML。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T10:58:44.057

例如，请参阅[extracting-text-from-html-file-using-python](https://stackoverflow.com/questions/328356/extracting-text-from-html-file-using-python)以获取有关在 Python 中解析 HTML 的方法的建议。

# http - 为什么 cookie 路径区分大小写？

> ID：399982
> 
> 赞同：19
> 
> 时间：2008-12-30T10:49:38.613
> 
> 标签：http, browser, cookies

几周前我第一次意识到，在设置 http cookie 时，虽然域名不区分大小写，但路径是。

所以有一段时间存储了一个cookie

`http://SomeWebSite.com`

可以使用

`http://somewebsite.com`

存储的 cookie

`http://somewebsite.com/SomePath`

*无法*读取使用

`http://somewebsite.com/somepath`

根本就找不到。

正如 RFC 中明确指出的那样（请参阅[此处](http://www.ietf.org/rfc/rfc2965.txt)的第 3.3.3 点），我怀疑这是一个疏忽，但作为一个用户，我没有接受过将 url 视为区分大小写的文本和 Web 服务器的培训，据我所知，不要似乎不介意任何一种方式，并且可以很好地提供页面；所以我想知道 - 这个决定背后的理由是什么？

任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-30T11:06:33.400

大多数 Web 服务器都提供了防白痴机制。我知道的两个常见的方法是在目录名称 ( `http://example.com/x`=> `http://example.com/x/`) 的末尾添加斜杠，以及更正或忽略大小写：(与 )`http://stackoverflow.com/ABOUT`相同`http://stackoverflow.com/about`。但是，这**不是**Web 服务器的要求，浏览器知道这一点。 `http://stackoverflow.com/ABOUT`可以提供与 . 完全不同的页面`http://stackoverflow.com/about`。使用 ?x=y 语法的 GET 变量很流行，并且这些值有时对服务器脚本区分大小写。这些可能的差异必须由浏览器正确处理（不要将它们缓存为同一个文档，使用不同的 cookie 域，不要对 Javascript 进行修改等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T10:57:41.250

路径是否区分大小写取决于 Web 服务器。传统上类似 unix 的操作系统：s 区分大小写，而 MS 则不区分大小写，这可能反映在在指定操作系统上开发的网络服务器中。

包含可能感兴趣的[不同文件系统信息](http://en.wikipedia.org/wiki/Filename#Comparison_of_file_name_limitations)的链接。

*更新*

URL 指向什么资源取决于网络服务器。[http://some.domain.name/myFavouriteThings.txt](http://some.domain.name/myFavouriteThings.txt)可能是存储在我的服务器硬盘上的文本文件，但它也可以存储在数据库中，指向执行并返回一些随机行的脚本。它甚至不必是文本文件，它可以是图片、视频或其他任何可以以数字方式传输的文件。

但在这种情况下，它作为文件存储在服务器上。由于服务器是类 Unix 系统，服务器文件系统区分大小写。因此，只有当请求的情况与存储在磁盘上的文件匹配时，它才会找到该文件。如果服务器存储在文件系统不区分大小写的 MS 服务器上，则请求的大小写可能无关紧要。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-30T11:38:02.120

始终将所有内容都视为区分大小写。

# cocoa-touch - 如何将键值对附加到 iPhone 上的 UIView？

> ID：399987
> 
> 赞同：8
> 
> 时间：2008-12-30T10:53:11.667
> 
> 标签：cocoa-touch, dictionary, key-value-coding

当我开始 iPhone 开发时，我在某处读到可以将键值对附加到 UIView。我知道所有 UIView 都可以用作字典来存储您可能想要附加到它们的任何数据，以防止不必要的子类化。但是，我到处搜索以找到参考，并试图徒劳地实现自己的行为。

我已经尝试过诸如：

```
UIView *myView = [[UIView alloc] init];
[myView setValue:@"hello" forKey:@"world"]; 
```

但这似乎不起作用。我认为上面的代码所做的是尝试将值 @"hello" 分配给属性 @"world" - 这不是我想要的。

我想要实现的目标是可能的吗？

在这里的任何帮助将不胜感激。

谢谢！

缺口。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-30T13:33:01.687

UIViews 在通用键上不符合键值。如果是，那么您的代码示例确实会为键 @"world" 设置值 @"hello"。然而，*层*是键值兼容的，所以下面的方法可以工作：

```
UIView *myView = [[UIView alloc] init];
[myView.layer setValue: @"hello" forKey: @"world"]; 
```

# python - 你如何让 Python 写下它在内存中的函数代码？

> ID：399991
> 
> 赞同：5
> 
> 时间：2008-12-30T10:55:43.657
> 
> 标签：python, artificial-intelligence

当我传递程序中的选项（计算生物学实验）时，我通常通过 .py 文件传递​​它们。
所以我有这个 .py 文件，内容如下：

```
starting_length=9
starting_cell_size=1000
LengthofExperiments=5000000 
```

然后我执行文件并获取数据。由于该程序都在我的机器上，没有其他人可以访问它，因此它以一种微不足道的方式是安全的。
我也可以很容易地写一个类似的文件：

```
def writeoptions(directory):
    options=""
    options+="starting_length=%s%s"%(starting_length,os.linesep)
    options+="starting_cell_size=%s%s"%(starting_cell_size,os.linesep)
    options+="LengthofExperiments=%s%s"%(LengthofExperiments,os.linesep)
...
    open("%s%soptions.py"%(directory,os.sep),'w').write(options) 
```

我想将函数作为参数之一传递：

```
starting_length=9
starting_cell_size=1000
LengthofExperiments=5000000

def pippo(a,b):
    return a+b
functionoperator=pippo 
```

当然，在实际实验中，函数 pippo 会复杂得多。并且因实验而异。

但我无法做的是自动编写函数。简而言之，如果其中一个选项是函数，我不知道如何概括 writeoptions 函数以继续编写选项。我当然可以复制原始文件，但这不优雅、效率低下（因为它包含许多未使用的额外选项），并且通常无法解决问题。

你如何让python写下一个函数的代码，因为它写下一个变量的值？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-30T11:18:39.257

```
vinko@mithril$ 更多 a.py

定义 foo(a):
  打印一个

vinko@mithril$ 更多 b.py

导入一个
进口检验

a.foo(89)
打印检查.getsource(a.foo)

vinko@mithril$ python b.py
89
定义 foo(a):
  打印一个

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T14:12:54.320

您还可以考虑其他一些数据持久性的方法。在我自己的（天文学）研究中，我一直在试验两种不同的存储脚本以实现可重复性的方法。第一种是将它们专门放在 subversion 存储库中，然后让作业提交脚本自动提交它们。例如，如果您只想在 bash 中执行此操作：

```
alias run_py='svn ci -m "Commit before running"; python2.5 $*' 
```

[在脚本内部，输出以该文件的当前颠覆修订号](http://svnbook.red-bean.com/en/1.5/svn.advanced.props.special.keywords.html)为前缀，您将记录每个运行的脚本以及输入是什么。您可以根据需要将其从颠覆中撤出。

另一种功能少得多的跟踪函数输入的方法可能是通过[LodgeIt 之](http://paste.pocoo.org/)类的东西，它是一个接受 XML-RPC 输入并带有 Python 绑定的 pastebin。（它可以在本地安装，并且支持回复和更新现有的粘贴。）

但是，如果您正在寻找包含的代码量相对较少，Vinko 使用检查的解决方案应该可以很好地工作。Doug Hellman在他的[Python Module of the Week](http://www.doughellmann.com/PyMOTW/)系列中[介绍了该`inspect`模块。](http://www.doughellmann.com/PyMOTW/inspect/index.html)您可以创建一个装饰器来检查每个选项和参数，然后根据需要将其打印出来（我将使用它来获取参数的名称。）`inspect.getargspec`

```
import inspect
from functools import wraps

def option_printer(func):
    @wraps(func)
    def run_func(*args, **kwargs):
        for name, arg in zip(inspect.getargspec(func)[0], args) \
                       + sorted(kwargs.items()):
            if isinstance(arg, types.FunctionType): 
                print "Function argument '%s' named '%s':\n" % (name, func.func_name)
                print inspect.getsource(func)
            else:
                print "%s: %s" % (name, arg)
        return func(*args, **kwargs)
    return run_func 
```

这可能会更优雅一点，但在我的测试中，它适用于简单的参数和变量集。此外，它可能对 lambdas 有一些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-30T11:21:05.697

你是在问这个吗？

```
def writeoptions(directory):
    options=""
    options+="starting_length=%s%s"%(starting_length,os.linesep)
    options+="starting_cell_size=%s%s"%(starting_cell_size,os.linesep)
    options+="LengthofExperiments=%s%s"%(LengthofExperiments,os.linesep)
    options+="def pippo(a,b):%s" % ( os.linesep, )
    options+="    '''Some version of pippo'''%s" % ( os.linesep, )
    options+="    return 2*a+b%s" % ( os.linesep, )
    open("%s%soptions.py"%(directory,os.sep),'w').write(options) 
```

或者是其他东西？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T11:24:44.237

虽然可以按照您的要求去做（如 Vinko 所示），但我想说*共享代码*更干净。将`pippo`和他的伙伴放在两个程序都可以访问的子模块中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-30T11:25:27.793

与其深入研究[反汇编](http://docs.python.org/library/dis.html)程序和字节码（例如[inspect](http://docs.python.org/library/inspect.html)），不如将生成的 Python 源代码保存在模块（*file.py*）中，然后再导入它？

我建议研究一种更标准的方式来处理您所谓的*options*。例如，您可以使用[JSON](http://docs.python.org/library/json.html)模块并保存或恢复您的数据。或者查看[marshal](http://docs.python.org/library/marshal.html#module-marshal)和[pickle](http://docs.python.org/library/pickle.html#module-pickle)模块。*******