# StackOverflow 问答 000152000-000152999

# linux - 服务器端病毒扫描

> ID：152003
> 
> 赞同：9
> 
> 时间：2008-09-30T06:51:37.010
> 
> 标签：linux, server-side, antivirus

我需要在 Linux 服务器上扫描上传的文件中的病毒，但我不知道该怎么做。

如果有的话，我有什么选择？我还对多个用户同时发送多个文件时扫描仪的性能感兴趣。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-03T06:28:55.370

这是我针对已知病毒进行测试时对 ClamAV 的结果（问题是， ***这些都不应该通过***）：

```
+-----------+------------------------------+
|  Results  |             File             |
+-----------+------------------------------+
| infected  | AdvancedXPFixerInstaller.exe |
| pass      | auto.exe                     |
| pass      | cartao.exe                   |
| infected  | cartoes_natal.exe            |
| pass      | codec.exe                    |
| pass      | e421.exe                     |
| pass      | fixtool.exe                  |
| infected  | flash_install.exe            |
| infected  | issj.exe                     |
| infected  | iwmdo.exe                    |
| infected  | jobxxc.exe                   |
| infected  | kbmt.exe                     |
| pass      | killer_cdj.exe               |
| pass      | killer_javqhc.exe            |
| infected  | killer_rodog.exe             |
| infected  | kl.exe                       |
| infected  | MacromediaFlash.exe          |
| infected  | MacromediaFlashPlayer.exe    |
| infected  | paraense.exe                 |
| infected  | pibzero.exe                  |
| pass      | scan.exe                     |
| pass      | uaqxtg.exe                   |
| pass      | vejkcfu.exe                  |
| infected  | VIDeoSS.exe                  |
| infected  | wujowpq.exe                  |
| pass      | X-IrCBOT.exe                 |
+-----------+------------------------------+ 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-09-30T06:56:28.930

我会看看[Clam AntiVirus](http://www.clamav.net/)。它提供了一个`clamscan`可以扫描给定文件并返回通过/失败指示的程序。它是免费的，并且会定期自动更新其数据库。

至于将此类产品集成到您的文件上传过程中，这将特定于您实际使用的任何文件上传过程。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-30T12:24:42.013

如果您担心性能，请考虑使用 clamd/clamdscan 作为您的实现。clamd 作为守护进程运行，因此所有初始化成本只执行一次。然后，当您使用 clamdscan 扫描文件时，它只会将文件提供给分叉的 clamd 以进行实际扫描。如果你有大量的流量，它会更有效率。

如果您还有其他性能问题，则应考虑使用商业产品。如今，大多数大玩家都有 Linux/Unix 版本。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-19T06:54:55.737

您应该查看[opswat 的 MetaScan](http://www.opswat.com/metascan.shtml)。该工具管理文件的更新和多引擎扫描。它与 AVG、CA eTrust™ 捆绑在一起。ClamWin、ESET NOD32 防病毒引擎、MicroWorld eScan 引擎、Norman Virus Control 和 VirusBuster EDK。此外，它将调用诺顿等。优点是您可以针对该文件运行多个引擎。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T12:33:35.237

您应该尝试找到一个为其扫描程序提供公共 API 的防病毒供应商。这样您就可以以编程方式扫描文件。从长远来看，这比试图通过上传脚本干扰其他进程更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-06T02:50:47.793

您是否通过商业扫描仪运行过它们？我曾经是通过 4 个商业扫描仪并行运行文件的产品的管理员。我有一个数百个测试病毒语料库，没有一个商业扫描仪可以找到它们……

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-18T10:21:48.617

Clamscan 将在文件存储后对其进行扫描，并且不会阻止上传或下载受感染的文件

我有一个 squid(https+cache) <-> **HAVP** (with **clamAV** ) <-> Tomcat 反向代理设置。HAVP ( [http://www.server-side.de/](http://www.server-side.de/) ) 是一种通过 ClamAV 或任何其他商业防病毒软件**扫描 http 流量的方法。**它将阻止用户下载受感染的文件。

尽管如此，它在上传时不起作用，因此它不会阻止文件存储在服务器上，但会阻止文件被下载并因此传播。因此，将其与常规文件扫描一起使用（例如 clamscan）

# c++ - 如何在 C++ 中进行柯里化？

> ID：152005
> 
> 赞同：55
> 
> 时间：2008-09-30T06:51:54.217
> 
> 标签：c++, stl, functional-programming, currying, binders

什么是咖喱？

如何在 C++ 中进行柯里化？

请解释 STL 容器中的活页夹？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2014-11-05T22:29:58.153

# 1.什么是咖喱？

柯里化只是意味着将多个参数的函数转换为单个参数的函数。使用示例最容易说明这一点：

取一个`f`接受三个参数的函数：

```
int
f(int a,std::string b,float c)
{
    // do something with a, b, and c
    return 0;
} 
```

如果我们想调用`f`，我们必须提供它的所有参数`f(1,"some string",19.7f)`。

然后是 的柯里化版本`f`，让我们称之为`curried_f=curry(f)`它只需要一个参数，它对应于 的第一个参数`f`，即参数`a`。此外，`f(1,"some string",19.7f)`也可以使用 curried 版本编写为`curried_f(1)("some string")(19.7f)`. `curried_f(1)`另一方面，的返回值只是另一个函数，它处理 的下一个参数`f`。最后，我们得到一个`curried_f`满足以下等式的函数或可调用对象：

```
curried_f(first_arg)(second_arg)...(last_arg) == f(first_arg,second_arg,...,last_arg). 
```

# 2\. C++中如何实现柯里化？

以下有点复杂，但对我来说效果很好（使用c ++ 11）......它还允许像这样的任意程度的柯里化：`auto curried=curry(f)(arg1)(arg2)(arg3)`和更高版本`auto result=curried(arg4)(arg5)`的 . 它是这样的：

```
#include <functional>

namespace _dtl {

    template <typename FUNCTION> struct
    _curry;

    // specialization for functions with a single argument
    template <typename R,typename T> struct
    _curry<std::function<R(T)>> {
        using
        type = std::function<R(T)>;

        const type
        result;

        _curry(type fun) : result(fun) {}

    };

    // recursive specialization for functions with more arguments
    template <typename R,typename T,typename...Ts> struct
    _curry<std::function<R(T,Ts...)>> {
        using
        remaining_type = typename _curry<std::function<R(Ts...)> >::type;

        using
        type = std::function<remaining_type(T)>;

        const type
        result;

        _curry(std::function<R(T,Ts...)> fun)
        : result (
            [=](const T& t) {
                return _curry<std::function<R(Ts...)>>(
                    [=](const Ts&...ts){ 
                        return fun(t, ts...); 
                    }
                ).result;
            }
        ) {}
    };
}

template <typename R,typename...Ts> auto
curry(const std::function<R(Ts...)> fun)
-> typename _dtl::_curry<std::function<R(Ts...)>>::type
{
    return _dtl::_curry<std::function<R(Ts...)>>(fun).result;
}

template <typename R,typename...Ts> auto
curry(R(* const fun)(Ts...))
-> typename _dtl::_curry<std::function<R(Ts...)>>::type
{
    return _dtl::_curry<std::function<R(Ts...)>>(fun).result;
}

#include <iostream>

void 
f(std::string a,std::string b,std::string c)
{
    std::cout << a << b << c;
}

int 
main() {
    curry(f)("Hello ")("functional ")("world!");
    return 0;
} 
```

[查看输出](http://ideone.com/CQ8ELv)

好的，正如 Samer 评论的那样，我应该添加一些关于它是如何工作的解释。实际实现是在 中完成的`_dtl::_curry`，而模板函数`curry`只是方便的包装器。`std::function`该实现对模板参数的参数是递归的`FUNCTION`。

对于只有一个参数的函数，结果与原始函数相同。

```
 _curry(std::function<R(T,Ts...)> fun)
        : result (
            [=](const T& t) {
                return _curry<std::function<R(Ts...)>>(
                    [=](const Ts&...ts){ 
                        return fun(t, ts...); 
                    }
                ).result;
            }
        ) {} 
```

这里有一个棘手的问题：对于具有更多参数的函数，我们返回一个 lambda，其参数绑定到调用的第一个参数`fun`。最后，剩余`N-1`参数的剩余柯里化被委托给`_curry<Ts...>`少一个模板参数的实现。

# c++14 / 17 的更新：

我刚刚想到了一个解决柯里化问题的新想法......随着`if constexpr`c ++ 17的引入（并在`void_t`确定函数是否完全柯里化的帮助下），事情似乎变得容易多了：

```
template< class, class = std::void_t<> > struct 
needs_unapply : std::true_type { };

template< class T > struct 
needs_unapply<T, std::void_t<decltype(std::declval<T>()())>> : std::false_type { };

template <typename F> auto
curry(F&& f) {
  /// Check if f() is a valid function call. If not we need 
  /// to curry at least one argument:
  if constexpr (needs_unapply<decltype(f)>::value) {
       return [=](auto&& x) {
            return curry(
                [=](auto&&...xs) -> decltype(f(x,xs...)) {
                    return f(x,xs...);
                }
            );
        };    
  }
  else {  
    /// If 'f()' is a valid call, just call it, we are done.
    return f();
  }
}

int 
main()
{
  auto f = [](auto a, auto b, auto c, auto d) {
    return a  * b * c * d;
  };

  return curry(f)(1)(2)(3)(4);
} 
```

请参阅[此处](https://godbolt.org/g/wrli32)的实际代码。使用类似的方法，[这里](https://godbolt.org/g/mp8OD1)是如何使用任意数量的参数柯里化函数。

`constexpr if`如果我们根据测试与模板选择交换 ，则在 C++14 中似乎也可以实现相同的想法`needs_unapply<decltype(f)>::value`：

```
template <typename F> auto
curry(F&& f);

template <bool> struct
curry_on;

template <> struct
curry_on<false> {
    template <typename F> static auto
    apply(F&& f) {
        return f();
    }
};

template <> struct
curry_on<true> {
    template <typename F> static auto 
    apply(F&& f) {
        return [=](auto&& x) {
            return curry(
                [=](auto&&...xs) -> decltype(f(x,xs...)) {
                    return f(x,xs...);
                }
            );
        };
    }
};

template <typename F> auto
curry(F&& f) {
    return curry_on<needs_unapply<decltype(f)>::value>::template apply(f);
} 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-30T06:59:57.223

简而言之，currying 接受一个函数`f(x, y)`并给定一个 fixed `Y`，给出一个新函数`g(x)`，其中

```
g(x) == f(x, Y) 
```

这个新函数可以在只提供一个参数的情况下被调用，并将调用传递给`f`具有固定`Y`参数的原始函数。

STL 中的绑定器允许您为 C++ 函数执行此操作。例如：

```
#include <functional>
#include <iostream>
#include <vector>

using namespace std;

// declare a binary function object
class adder: public binary_function<int, int, int> {
public:
    int operator()(int x, int y) const
    {
        return x + y;
    }
};

int main()
{
    // initialise some sample data
    vector<int> a, b;
    a.push_back(1);
    a.push_back(2);
    a.push_back(3);

    // here we declare a function object f and try it out
    adder f;
    cout << "f(2, 3) = " << f(2, 3) << endl;

    // transform() expects a function with one argument, so we use
    // bind2nd to make a new function based on f, that takes one
    // argument and adds 5 to it
    transform(a.begin(), a.end(), back_inserter(b), bind2nd(f, 5));

    // output b to see what we got
    cout << "b = [" << endl;
    for (vector<int>::iterator i = b.begin(); i != b.end(); ++i) {
        cout << "  " << *i << endl;
    }
    cout << "]" << endl;

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-01T23:53:56.450

使用 tr1 简化 Gregg 的示例：

```
#include <functional> 
using namespace std;
using namespace std::tr1;
using namespace std::tr1::placeholders;

int f(int, int);
..
int main(){
    function<int(int)> g     = bind(f, _1, 5); // g(x) == f(x, 5)
    function<int(int)> h     = bind(f, 2, _1); // h(x) == f(2, x)
    function<int(int,int)> j = bind(g, _2);    // j(x,y) == g(y)
} 
```

Tr1 函数式组件允许您使用 C++ 编写丰富的函数式代码。同样，C++0x 也将允许内联 lambda 函数执行此操作：

```
int f(int, int);
..
int main(){
    auto g = [](int x){ return f(x,5); };      // g(x) == f(x, 5)
    auto h = [](int x){ return f(2,x); };      // h(x) == f(2, x)
    auto j = [](int x, int y){ return g(y); }; // j(x,y) == g(y)
} 
```

虽然 C++ 没有提供某些面向函数的编程语言执行的丰富的副作用分析，但 const 分析和 C++0x lambda 语法可以提供帮助：

```
struct foo{
    int x;
    int operator()(int y) const {
        x = 42; // error!  const function can't modify members
    }
};
..
int main(){
    int x;
    auto f = [](int y){ x = 42; }; // error! lambdas don't capture by default.
} 
```

希望有帮助。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-30T08:44:25.770

看看[Boost.Bind](http://www.boost.org/doc/libs/1_36_0/libs/bind/bind.html)，它使 Greg 展示的过程更加通用：

```
transform(a.begin(), a.end(), back_inserter(b), bind(f, _1, 5)); 
```

这绑定`5`到`f`的第二个参数。

值得注意的是，这*不是*柯里化（而是部分应用）。然而，在 C++ 中以一般方式使用柯里化是很困难的（事实上，它直到最近才成为可能）并且经常使用部分应用程序来代替。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2011-05-26T11:49:30.657

其他答案很好地解释了活页夹，所以我不会在这里重复这部分。我将仅演示如何在 C++0x 中使用 lambda 来完成柯里化和部分应用程序。

**代码示例：（**注释中的解释）

```
#include <iostream>
#include <functional>

using namespace std;

const function<int(int, int)> & simple_add = 
  [](int a, int b) -> int {
    return a + b;
  };

const function<function<int(int)>(int)> & curried_add = 
  [](int a) -> function<int(int)> {
    return [a](int b) -> int {
      return a + b;
    };
  };

int main() {
  // Demonstrating simple_add
  cout << simple_add(4, 5) << endl; // prints 9

  // Demonstrating curried_add
  cout << curried_add(4)(5) << endl; // prints 9

  // Create a partially applied function from curried_add
  const auto & add_4 = curried_add(4);
  cout << add_4(5) << endl; // prints 9
} 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-10-06T10:06:40.287

如果您使用的是 C++14，则非常简单：

```
template<typename Function, typename... Arguments>
auto curry(Function function, Arguments... args) {
    return [=](auto... rest) {
        return function(args..., rest...);
    }; // don't forget semicolumn
} 
```

然后你可以像这样使用它：

```
auto add = [](auto x, auto y) { return x + y; }

// curry 4 into add
auto add4 = curry(add, 4);

add4(6); // 10 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2017-03-31T02:09:22.707

这里有一些很好的答案。我想我会添加自己的，因为玩这个概念很有趣。

**部分函数应用**：仅将函数的部分参数“绑定”到函数的过程，将其余部分推迟到以后填写。结果是另一个参数更少的函数。

**Currying**：是一种特殊形式的偏函数应用程序，一次只能“绑定”一个参数。结果是另一个函数正好少了 1 个参数。

我将要介绍的代码是**部分函数应用程序**，可以进行柯里化，但不是唯一的可能性。与上述柯里化实现相比，它提供了一些好处（主要是因为它是部分函数应用程序而不是柯里化，呵呵）。

*   应用于空函数：

    ```
    auto sum0 = [](){return 0;};
    std::cout << partial_apply(sum0)() << std::endl; 
    ```

*   一次应用多个参数：

    ```
    auto sum10 = [](int a, int b, int c, int d, int e, int f, int g, int h, int i, int j){return a+b+c+d+e+f+g+h+i+j;};
    std::cout << partial_apply(sum10)(1)(1,1)(1,1,1)(1,1,1,1) << std::endl; // 10 
    ```

*   `constexpr`允许编译时的支持`static_assert`：

    ```
    static_assert(partial_apply(sum0)() == 0); 
    ```

*   如果您在提供参数时不小心走得太远，则会出现有用的错误消息：

    ```
    auto sum1 = [](int x){ return x;};
    partial_apply(sum1)(1)(1); 
    ```

    > 错误：static_assert 失败“尝试应用太多参数！”

上面的其他答案返回绑定参数然后返回更多 lambdas 的 lambdas。这种方法将基本功能包装到一个可调用对象中。`operator()`允许调用内部 lambda 的定义。可变参数模板允许我们检查是否有人走得太远，并且到函数调用结果类型的隐式转换函数允许我们打印结果或将对象与原语进行比较。

代码：

```
namespace detail{
template<class F>
using is_zero_callable = decltype(std::declval<F>()());

template<class F>
constexpr bool is_zero_callable_v = std::experimental::is_detected_v<is_zero_callable, F>;
}

template<class F>
struct partial_apply_t
{
    template<class... Args>
    constexpr auto operator()(Args... args)
    {
        static_assert(sizeof...(args) == 0 || !is_zero_callable, "Attempting to apply too many arguments!");
        auto bind_some = [=](auto... rest) -> decltype(myFun(args..., rest...))
        {
           return myFun(args..., rest...);
        };
        using bind_t = decltype(bind_some);

        return partial_apply_t<bind_t>{bind_some};
    }
    explicit constexpr partial_apply_t(F fun) : myFun(fun){}

    constexpr operator auto()
    {
        if constexpr (is_zero_callable)
            return myFun();
        else
            return *this; // a callable
    }
    static constexpr bool is_zero_callable = detail::is_zero_callable_v<F>;
    F myFun;
}; 
```

## [现场演示](https://wandbox.org/permlink/74D7CxNUggiJjCjG)

还有一些注意事项：

*   我选择使用[is_detected](http://en.cppreference.com/w/cpp/experimental/is_detected)主要是为了享受和练习；它的作用与此处的普通类型特征相同。
*   出于性能原因，肯定需要做更多的工作来支持完美转发
*   代码是 C++17，因为它需要[C++17](http://en.cppreference.com/w/cpp/language/lambda)`constexpr`中的lambda 支持
    *   而且似乎 GCC 7.0.1 还没有，所以我使用了 Clang 5.0.0

一些测试：

```
auto sum0 = [](){return 0;};
auto sum1 = [](int x){ return x;};
auto sum2 = [](int x, int y){ return x + y;};
auto sum3 = [](int x, int y, int z){ return x + y + z; };
auto sum10 = [](int a, int b, int c, int d, int e, int f, int g, int h, int i, int j){return a+b+c+d+e+f+g+h+i+j;};

std::cout << partial_apply(sum0)() << std::endl; //0
static_assert(partial_apply(sum0)() == 0, "sum0 should return 0");
std::cout << partial_apply(sum1)(1) << std::endl; // 1
std::cout << partial_apply(sum2)(1)(1) << std::endl; // 2
std::cout << partial_apply(sum3)(1)(1)(1) << std::endl; // 3
static_assert(partial_apply(sum3)(1)(1)(1) == 3, "sum3 should return 3");
std::cout << partial_apply(sum10)(1)(1,1)(1,1,1)(1,1,1,1) << std::endl; // 10
//partial_apply(sum1)(1)(1); // fails static assert
auto partiallyApplied = partial_apply(sum3)(1)(1);
std::function<int(int)> finish_applying = partiallyApplied;
std::cout << std::boolalpha << (finish_applying(1) == 3) << std::endl; // true

auto plus2 = partial_apply(sum3)(1)(1);
std::cout << std::boolalpha << (plus2(1) == 3) << std::endl; // true
std::cout << std::boolalpha << (plus2(3) == 5) << std::endl; // true 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-09-30T07:00:10.513

Currying 是一种将接受多个参数的函数简化为一系列嵌套函数的方法，每个函数都有一个参数：

```
full = (lambda a, b, c: (a + b + c))
print full (1, 2, 3) # print 6

# Curried style
curried = (lambda a: (lambda b: (lambda c: (a + b + c))))
print curried (1)(2)(3) # print 6 
```

Currying 很好，因为您可以定义简单地包装具有预定义值的其他函数的函数，然后传递简化的函数。C++ STL binders 在 C++ 中提供了一个实现。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-01-02T01:24:27.907

我也使用可变参数模板实现了柯里化（参见 Julian 的回答）。但是，我没有使用递归或`std::function`. 注意：它使用了许多**C++14**特性。

提供的示例（`main`函数）实际上在编译时运行，证明柯里化方法不会胜过编译器的基本优化。

代码可以在这里找到：[https ://gist.github.com/Garciat/c7e4bef299ee5c607948](https://gist.github.com/Garciat/c7e4bef299ee5c607948)

使用此帮助文件：[https ://gist.github.com/Garciat/cafe27d04cfdff0e891e](https://gist.github.com/Garciat/cafe27d04cfdff0e891e)

代码仍然需要（很多）工作，我可能很快也可能不会很快完成。无论哪种方式，我都会在此处发布此内容以供将来参考。

在链接失效的情况下发布代码（尽管它们不应该）：

```
#include <type_traits>
#include <tuple>
#include <functional>
#include <iostream>

// ---

template <typename FType>
struct function_traits;

template <typename RType, typename... ArgTypes>
struct function_traits<RType(ArgTypes...)> {
    using arity = std::integral_constant<size_t, sizeof...(ArgTypes)>;

    using result_type = RType;

    template <size_t Index>
    using arg_type = typename std::tuple_element<Index, std::tuple<ArgTypes...>>::type;
};

// ---

namespace details {
    template <typename T>
    struct function_type_impl
      : function_type_impl<decltype(&T::operator())>
    { };

    template <typename RType, typename... ArgTypes>
    struct function_type_impl<RType(ArgTypes...)> {
        using type = RType(ArgTypes...);
    };

    template <typename RType, typename... ArgTypes>
    struct function_type_impl<RType(*)(ArgTypes...)> {
        using type = RType(ArgTypes...);
    };

    template <typename RType, typename... ArgTypes>
    struct function_type_impl<std::function<RType(ArgTypes...)>> {
        using type = RType(ArgTypes...);
    };

    template <typename T, typename RType, typename... ArgTypes>
    struct function_type_impl<RType(T::*)(ArgTypes...)> {
        using type = RType(ArgTypes...);
    };

    template <typename T, typename RType, typename... ArgTypes>
    struct function_type_impl<RType(T::*)(ArgTypes...) const> {
        using type = RType(ArgTypes...);
    };
}

template <typename T>
struct function_type
  : details::function_type_impl<typename std::remove_cv<typename std::remove_reference<T>::type>::type>
{ };

// ---

template <typename Args, typename Params>
struct apply_args;

template <typename HeadArgs, typename... Args, typename HeadParams, typename... Params>
struct apply_args<std::tuple<HeadArgs, Args...>, std::tuple<HeadParams, Params...>>
  : std::enable_if<
        std::is_constructible<HeadParams, HeadArgs>::value,
        apply_args<std::tuple<Args...>, std::tuple<Params...>>
    >::type
{ };

template <typename... Params>
struct apply_args<std::tuple<>, std::tuple<Params...>> {
    using type = std::tuple<Params...>;
};

// ---

template <typename TupleType>
struct is_empty_tuple : std::false_type { };

template <>
struct is_empty_tuple<std::tuple<>> : std::true_type { };

// ----

template <typename FType, typename GivenArgs, typename RestArgs>
struct currying;

template <typename FType, typename... GivenArgs, typename... RestArgs>
struct currying<FType, std::tuple<GivenArgs...>, std::tuple<RestArgs...>> {
    std::tuple<GivenArgs...> given_args;

    FType func;

    template <typename Func, typename... GivenArgsReal>
    constexpr
    currying(Func&& func, GivenArgsReal&&... args) :
      given_args(std::forward<GivenArgsReal>(args)...),
      func(std::move(func))
    { }

    template <typename... Args>
    constexpr
    auto operator() (Args&&... args) const& {
        using ParamsTuple = std::tuple<RestArgs...>;
        using ArgsTuple = std::tuple<Args...>;

        using RestArgsPrime = typename apply_args<ArgsTuple, ParamsTuple>::type;

        using CanExecute = is_empty_tuple<RestArgsPrime>;

        return apply(CanExecute{}, std::make_index_sequence<sizeof...(GivenArgs)>{}, std::forward<Args>(args)...);
    }

    template <typename... Args>
    constexpr
    auto operator() (Args&&... args) && {
        using ParamsTuple = std::tuple<RestArgs...>;
        using ArgsTuple = std::tuple<Args...>;

        using RestArgsPrime = typename apply_args<ArgsTuple, ParamsTuple>::type;

        using CanExecute = is_empty_tuple<RestArgsPrime>;

        return std::move(*this).apply(CanExecute{}, std::make_index_sequence<sizeof...(GivenArgs)>{}, std::forward<Args>(args)...);
    }

private:
    template <typename... Args, size_t... Indices>
    constexpr
    auto apply(std::false_type, std::index_sequence<Indices...>, Args&&... args) const& {
        using ParamsTuple = std::tuple<RestArgs...>;
        using ArgsTuple = std::tuple<Args...>;

        using RestArgsPrime = typename apply_args<ArgsTuple, ParamsTuple>::type;

        using CurryType = currying<FType, std::tuple<GivenArgs..., Args...>, RestArgsPrime>;

        return CurryType{ func, std::get<Indices>(given_args)..., std::forward<Args>(args)... };
    }

    template <typename... Args, size_t... Indices>
    constexpr
    auto apply(std::false_type, std::index_sequence<Indices...>, Args&&... args) && {
        using ParamsTuple = std::tuple<RestArgs...>;
        using ArgsTuple = std::tuple<Args...>;

        using RestArgsPrime = typename apply_args<ArgsTuple, ParamsTuple>::type;

        using CurryType = currying<FType, std::tuple<GivenArgs..., Args...>, RestArgsPrime>;

        return CurryType{ std::move(func), std::get<Indices>(std::move(given_args))..., std::forward<Args>(args)... };
    }

    template <typename... Args, size_t... Indices>
    constexpr
    auto apply(std::true_type, std::index_sequence<Indices...>, Args&&... args) const& {
        return func(std::get<Indices>(given_args)..., std::forward<Args>(args)...);
    }

    template <typename... Args, size_t... Indices>
    constexpr
    auto apply(std::true_type, std::index_sequence<Indices...>, Args&&... args) && {
        return func(std::get<Indices>(std::move(given_args))..., std::forward<Args>(args)...);
    }
};

// ---

template <typename FType, size_t... Indices>
constexpr
auto curry(FType&& func, std::index_sequence<Indices...>) {
    using RealFType = typename function_type<FType>::type;
    using FTypeTraits = function_traits<RealFType>;

    using CurryType = currying<FType, std::tuple<>, std::tuple<typename FTypeTraits::template arg_type<Indices>...>>;

    return CurryType{ std::move(func) };
}

template <typename FType>
constexpr
auto curry(FType&& func) {
    using RealFType = typename function_type<FType>::type;
    using FTypeArity = typename function_traits<RealFType>::arity;

    return curry(std::move(func), std::make_index_sequence<FTypeArity::value>{});
}

// ---

int main() {
    auto add = curry([](int a, int b) { return a + b; });

    std::cout << add(5)(10) << std::endl;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-10-29T18:19:51.390

这些链接是相关的：

Wikipedia 上的 Lambda Calculus 页面有一个明确的柯里化示例
[http://en.wikipedia.org/wiki/Lambda_calculus#Motivation](http://en.wikipedia.org/wiki/Lambda_calculus#Motivation)

本文处理 C/C++ 中的柯里化
[http://asg.unige.ch/site/papers/Dami91a.pdf](http://asg.unige.ch/site/papers/Dami91a.pdf)

# php - 在 php 中更改输出的 mime 类型

> ID：152006
> 
> 赞同：59
> 
> 时间：2008-09-30T06:52:11.360
> 
> 标签：php, xml, mime-types

我有一个 php 脚本。大多数情况下，脚本返回 html，这工作正常，但有一次（参数 ?Format=XML）脚本返回 XML 而不是 HTML。

有什么方法可以将返回的 php 输出的 mime 类型从 text/html 更改为 text/xml 或 application/xml？

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2008-09-30T06:53:45.380

```
header('Content-type: application/xml'); 
```

更多信息可在 PHP 文档中获得[`header()`](http://php.net/manual/en/function.header.php)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-30T06:54:13.103

设置`Content-Type`标题：

```
header('Content-Type: text/xml'); 
```

尽管您可能应该改用“application/xml”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-30T06:55:00.417

您应该在发送任何输出**之前**`Content-Type`发送标头。

 **```
header('Content-Type: text/xml'); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-30T09:00:04.890

我会回答更新，因为以前的答案很好。
我读过 Internet Explorer 以忽略 Mime 类型标头（大部分时间？）而闻名，以依赖文件的内容（在某些情况下可能会导致问题）。

嗯，我做了一个简单的测试：

```
<?php
header('Content-Type: text/xml');
echo '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<root><foo a="b">Tada</foo></root>';
?> 
```

Internet Explorer 6 将其正确显示为 XML。即使我删除了 xml 声明。
您应该指出哪个版本有问题。

实际上，正如我在上面所写的，对于 IE（至少 6 个），您甚至不需要内容类型，它可以识别 XML 数据并将其显示为树。您的 XML 是否正确？

[更新] IE7 也试过了，也添加了 ?format=xml，仍然正确显示 XML。如果我发送格式错误的 XML，IE 会显示错误。在 WinXP Pro SP2+ 上测试

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-02-11T18:21:47.683

```
header('Content-Type: application/xml; charset=utf-8'); 
```

您也可以在同一行中添加编码。我添加了 utf-8，这是最常见的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-07-12T01:30:41.357

我刚刚使用了以下内容：
注意：我正在使用“i”来进行 sql 改进扩展。

```
Start XML file, echo parent node
header("Content-type: text/xml");
echo "<?xml version='1.0' encoding='UTF-8'?>";
echo "<marker>"; 
```

遍历行，为每个行打印 XML 节点

```
while ($row = @mysqli_fetch_assoc($results)){
  // Add to XML document node
  echo '<marker ';
  echo 'id="' . $ind . '" ';
  echo 'name="' . parseToXML($row['name']) . '" ';
  echo 'address="' . parseToXML($row['address']) . '" ';
  echo 'lat="' . $row['lat'] . '" ';
  echo 'lng="' . $row['lng'] . '" ';
  echo 'type="' . $row['type'] . '" ';
  echo '/>';
}

// End XML file
echo "</marker>"; 
```

# arm - ARM Cortex-M3 内核上的 .NET 微框架

> ID：152015
> 
> 赞同：3
> 
> 时间：2008-09-30T06:57:44.233
> 
> 标签：arm, .net-micro-framework, cortex-m3

我有一个来自[Luminary Micro的](http://www.luminarymicro.com/)[RDK-IDM](http://www.luminarymicro.com/products/rdk-idm.html)。该板具有 32 位 ARM® [Cortex™-M3 内核](http://www.arm.com/products/CPUs/ARM_Cortex-M3.html)。有没有人尝试在这样的设备上运行 .NET Micro Framework 应用程序？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-11-17T23:48:47.963

我没有任何动手经验，但基于[http://www.microsoft.com/netmf/about/gettingstarted.mspx](http://www.microsoft.com/netmf/about/gettingstarted.mspx)支持的最小占用空间是 64kb RAM、256kb 闪存和不需要 MMU。因此，您的应用需求将是决定性因素。

仅供参考：2009 年 11 月 16 日，.NET Micro Framework 在 Apache 2.0 许可下作为开源发布

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-02T09:55:07.037

LM3S6918（RDK-IDM 上的芯片）似乎只有 256KB Flash 和 64Kb SRAM，但 .NET Micro Framework 需要 256KB RAM 和 512K Flash/ROM！

[在这里](http://www.luminarymicro.com/component/option,com_joomlaboard/Itemid,92/func,view/id,2781/catid,5/)阅读更多

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-03T22:59:00.200

我们已将 .NET Micro Framework 移植到 TI Stellaris MCU、ARM Cortex-M3 内核，目前我们有一个用于 EK-LM3S8962 板的端口，并且正在运行。

.NET Micro Framework 最小的内存占用：

*   闪存：155KB
*   内存：32KB

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-02T20:51:50.140

cortex M3 是一个非常精简的内核，例如，它缺少 MMU，旨在运行非常简单的操作系统。具体来说，不是 Symbian/Windows Mobile/Linux/etc。而是 OSEck、OSEK、iTRON 或类似的。我认为这实际上是完全不可行的。

# c++ - 检测 CPU 架构编译时

> ID：152016
> 
> 赞同：91
> 
> 时间：2008-09-30T06:57:53.063
> 
> 标签：c++, c, detection, cpu-architecture, compile-time

编译 C 或 C++ 代码时找出 CPU 架构最可靠的方法是什么？据我所知，不同的编译器有自己的一组非标准预处理器定义（`_M_X86`在 MSVS 中`__i386__`，`__arm__`在 GCC 中等）。

有没有一种*标准*的方法来检测我正在构建的架构？如果没有，是否有各种编译器的此类定义的完整列表的来源，例如带有所有样板`#ifdef`的标头？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-30T07:03:40.770

没有编译器间标准，但每个编译器都趋于一致。您可以为自己构建一个标题，如下所示：

```
#if MSVC
#ifdef _M_X86
#define ARCH_X86
#endif
#endif

#if GCC
#ifdef __i386__
#define ARCH_X86
#endif
#endif 
```

一个完整的列表没有多大意义，因为有成千上万的编译器，但只有 3-4 个被广泛使用（Microsoft C++、GCC、Intel CC，也许是 TenDRA？）。只需决定您的应用程序将支持哪些编译器，列出它们的#defines，并根据需要更新您的标头。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-05-04T04:07:32.447

如果您想转储特定平台上的所有可用功能，您可以运行 GCC，如下所示：

```
gcc -march=native -dM -E - </dev/null 
```

它会转储宏，如`#define __SSE3__ 1`，`#define __AES__ 1`等。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2021-02-17T21:04:33.050

享受，我是这个的原作者。

```
extern "C" {
    const char *getBuild() { //Get current architecture, detectx nearly every architecture. Coded by Freak
        #if defined(__x86_64__) || defined(_M_X64)
        return "x86_64";
        #elif defined(i386) || defined(__i386__) || defined(__i386) || defined(_M_IX86)
        return "x86_32";
        #elif defined(__ARM_ARCH_2__)
        return "ARM2";
        #elif defined(__ARM_ARCH_3__) || defined(__ARM_ARCH_3M__)
        return "ARM3";
        #elif defined(__ARM_ARCH_4T__) || defined(__TARGET_ARM_4T)
        return "ARM4T";
        #elif defined(__ARM_ARCH_5_) || defined(__ARM_ARCH_5E_)
        return "ARM5"
        #elif defined(__ARM_ARCH_6T2_) || defined(__ARM_ARCH_6T2_)
        return "ARM6T2";
        #elif defined(__ARM_ARCH_6__) || defined(__ARM_ARCH_6J__) || defined(__ARM_ARCH_6K__) || defined(__ARM_ARCH_6Z__) || defined(__ARM_ARCH_6ZK__)
        return "ARM6";
        #elif defined(__ARM_ARCH_7__) || defined(__ARM_ARCH_7A__) || defined(__ARM_ARCH_7R__) || defined(__ARM_ARCH_7M__) || defined(__ARM_ARCH_7S__)
        return "ARM7";
        #elif defined(__ARM_ARCH_7A__) || defined(__ARM_ARCH_7R__) || defined(__ARM_ARCH_7M__) || defined(__ARM_ARCH_7S__)
        return "ARM7A";
        #elif defined(__ARM_ARCH_7R__) || defined(__ARM_ARCH_7M__) || defined(__ARM_ARCH_7S__)
        return "ARM7R";
        #elif defined(__ARM_ARCH_7M__)
        return "ARM7M";
        #elif defined(__ARM_ARCH_7S__)
        return "ARM7S";
        #elif defined(__aarch64__) || defined(_M_ARM64)
        return "ARM64";
        #elif defined(mips) || defined(__mips__) || defined(__mips)
        return "MIPS";
        #elif defined(__sh__)
        return "SUPERH";
        #elif defined(__powerpc) || defined(__powerpc__) || defined(__powerpc64__) || defined(__POWERPC__) || defined(__ppc__) || defined(__PPC__) || defined(_ARCH_PPC)
        return "POWERPC";
        #elif defined(__PPC64__) || defined(__ppc64__) || defined(_ARCH_PPC64)
        return "POWERPC64";
        #elif defined(__sparc__) || defined(__sparc)
        return "SPARC";
        #elif defined(__m68k__)
        return "M68K";
        #else
        return "UNKNOWN";
        #endif
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-10-18T05:38:27.887

如果您想要一个交叉编译器解决方案，那么只需使用[`Boost.Predef`](https://www.boost.org/doc/libs/1_68_0/doc/html/predef.html)包含

*   `BOOST_ARCH_`对于正在编译的系统/CPU架构。
*   `BOOST_COMP_`对于正在使用的编译器。
*   `BOOST_LANG_`对于一个正在编译的语言标准。
*   `BOOST_LIB_C_`和 BOOST_LIB_STD_ 用于使用的 C 和 C++ 标准库。
*   `BOOST_OS_`对于我们正在编译的操作系统。
*   `BOOST_PLAT_`适用于操作系统或编译器之上的平台。
*   `BOOST_ENDIAN_`用于操作系统和架构组合的字节顺序。
*   `BOOST_HW_`对于硬件特定的功能。
*   `BOOST_HW_SIMD`用于 SIMD（单指令多数据）检测。

例如

```
#if defined(BOOST_ARCH_X86)
    #if BOOST_ARCH_X86_64
        std::cout << "x86_64 " << BOOST_ARCH_X86_64 << " \n";
    #elif BOOST_ARCH_X86_32
        std::cout << "x86 " << BOOST_ARCH_X86_32 << " \n";
    #endif
#elif defined(BOOST_ARCH_ARM)
    #if _M_ARM
        std::cout << "ARM " << _M_ARM << " \n";
    #elif _M_ARM64
        std::cout << "ARM64 " << _M_ARM64 << " \n";
    #endif
#endif 
```

[您可以在此处](https://www.boost.org/doc/libs/1_68_0/doc/html/predef/using_the_predefs.html)了解有关如何使用它的更多信息

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-30T07:03:39.693

没有什么标准。Brian Hook 在他的“Portable Open Source Harness”中记录了其中的一堆，甚至试图将它们变成连贯且可用的东西（ymmv 关于这一点）。请参阅此站点上的 posh.h 标头：

*   [http://hookatooka.com/poshlib/](http://hookatooka.com/poshlib/)

请注意，由于前一段时间的 DOS 攻击，上面的链接可能要求您输入一些虚假的用户名/密码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-05T16:36:15.090

[这里](https://sourceforge.net/p/predef/wiki/Architectures/)`#define`有一个s的列表。之前有一个高度投票的答案包含此链接，但可能是由于 SO 的“答案必须有代码”规则而被 mod 删除。所以这里是一个随机样本。点击链接查看完整列表。

# AMD64

| 类型 | 宏 | 描述 |
| --- | --- | --- |
| 鉴别 | `__amd64__` `__amd64` `__x86_64__` `__x86_64` | 由 GNU C 和 Sun Studio 定义 |
| 鉴别 | `_M_X64` `_M_AMD64` | 由 Visual Studio 定义 |

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2008-09-30T14:41:30.170

如果您需要对 CPU 功能进行细粒度检测，最好的方法是同时发布一个 CPUID 程序，该程序将 CPU 支持的一组功能输出到 stdout 或某些“cpu_config.h”文件。然后将该程序与您的构建过程集成。

# c# - .NET 的未来版本会支持 C# 中的元组吗？

> ID：152019
> 
> 赞同：69
> 
> 时间：2008-09-30T06:59:50.077
> 
> 标签：c#, .net, tuples, language-features

.Net 3.5 不支持元组。太糟糕了，但不确定.net 的未来版本是否支持元组？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-06-26T08:24:10.943

我刚刚阅读了 MSDN 杂志上的这篇文章：[Building Tuple](http://msdn.microsoft.com/en-us/magazine/dd942829.aspx)

以下是节选：

> 即将发布的 Microsoft .NET Framework 4.0 版引入了一种称为 System.Tuple 的新类型。System.Tuple 是一个固定大小的异构类型数据集合。

> 像数组一样，元组具有固定的大小，一旦创建就无法更改。与数组不同，元组中的每个元素可能是不同的类型，并且元组能够保证每个元素的强类型。

> 在 System.Collections.Generic 命名空间中已经有一个在 Microsoft .NET Framework 中浮动的元组示例：KeyValuePair。虽然 KeyValuePair 可以被认为与 Tuple 相同，因为它们都是包含两个东西的类型，但 KeyValuePair 感觉与 Tuple 不同，因为它唤起了它存储的两个值之间的关系（并且有充分的理由，因为它支持 Dictionary 类）。
> 
> 此外，元组可以任意大小，而 KeyValuePair 只包含两个东西：一个键和一个值。

* * *

虽然 F# 等某些语言对元组有特殊语法，但您可以使用任何语言的新通用元组类型。回顾第一个例子，我们可以看到虽然有用，但元组在没有元组语法的语言中可能过于冗长：

```
class Program {
    static void Main(string[] args) {
        Tuple<string, int> t = new Tuple<string, int>("Hello", 4);
        PrintStringAndInt(t.Item1, t.Item2);
    }
    static void PrintStringAndInt(string s, int i) {
        Console.WriteLine("{0} {1}", s, i);
    }
} 
```

使用 C# 3.0 中的 var 关键字，我们可以删除元组变量上的类型签名，从而使代码更具可读性。

```
var t = new Tuple<string, int>("Hello", 4); 
```

我们还向静态 Tuple 类添加了一些工厂方法，这使得使用支持类型推断的语言（如 C#）更容易构建元组。

```
var t = Tuple.Create("Hello", 4); 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-09-30T07:02:43.020

```
#region tuples

    public class Tuple<T>
    {
        public Tuple(T first)
        {
            First = first;
        }

        public T First { get; set; }
    }

    public class Tuple<T, T2> : Tuple<T>
    {
        public Tuple(T first, T2 second)
            : base(first)
        {
            Second = second;
        }

        public T2 Second { get; set; }
    }

    public class Tuple<T, T2, T3> : Tuple<T, T2>
    {
        public Tuple(T first, T2 second, T3 third)
            : base(first, second)
        {
            Third = third;
        }

        public T3 Third { get; set; }
    }

    public class Tuple<T, T2, T3, T4> : Tuple<T, T2, T3>
    {
        public Tuple(T first, T2 second, T3 third, T4 fourth)
            : base(first, second, third)
        {
            Fourth = fourth;
        }

        public T4 Fourth { get; set; }
    }

    #endregion 
```

并使声明更漂亮：

```
public static class Tuple
{
    //Allows Tuple.New(1, "2") instead of new Tuple<int, string>(1, "2")
    public static Tuple<T1, T2> New<T1, T2>(T1 t1, T2 t2)
    {
        return new Tuple<T1, T2>(t1, t2);
    }
    //etc...
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-01-09T16:11:59.330

[Lokad 共享库](http://rabdullin.com/journal/2008/9/30/using-tuples-in-c-functions-and-dictionaries.html)（当然是开源的）中有一个**适当的**（不快速的）**C# Tuple**实现，其中包括以下必需的特性：

*   2-5 不可变元组实现
*   正确的 DebuggerDisplayAttribute
*   正确的散列和相等检查
*   用于从提供的参数生成元组的助手（泛型由编译器推断）和基于集合的操作的扩展。
*   生产测试。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2008-09-30T12:21:36.387

在 C# 中实现元组类或重用 F# 类只是故事的一半——这些使您能够相对轻松地创建元组，但并不是真正的语法糖，使它们在 F# 等语言中使用起来非常好。

例如，在 F# 中，您可以使用模式匹配在 let 语句中提取元组的两个部分，例如

```
let (a, b) = someTupleFunc 
```

不幸的是，使用 C# 中的 F# 类做同样的事情会不太优雅：

```
Tuple<int,int> x = someTupleFunc();
int a = x.get_Item1();
int b = x.get_Item2(); 
```

元组代表了一种强大的方法，可以从函数调用中返回多个值，而无需在代码中乱扔垃圾类，或者使用丑陋的 ref 或 out 参数。然而，在我看来，如果没有一些语法糖来使它们的创建和访问更加优雅，它们的用途是有限的。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-09-30T07:13:30.233

在我看来，匿名类型特性不是一个元组，而是一个非常相似的构造。一些 LINQ 查询的输出是匿名类型的集合，其行为类似于元组。

这是一个语句，它动态创建一个类型化的元组:-)：

```
var p1 = new {a = "A", b = 3}; 
```

见： http: [//www.developer.com/net/csharp/article.php/3589916](http://www.developer.com/net/csharp/article.php/3589916)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2017-03-07T10:53:15.407

C# 7 原生支持元组：

```
var unnamedTuple = ("Peter", 29);
var namedTuple = (Name: "Peter", Age: 29);
(string Name, double Age) typedTuple = ("Peter", 29); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-30T07:28:17.000

C# 很容易通过泛型支持简单的元组（根据较早的答案），并且通过“mumble typing”（许多可能的 C# 语言增强之一）来改进类型推断，它们可能非常非常强大。

就其价值而言，F# 本身就支持元组，并且在使用它之后，我不确定（匿名）元组会增加多少......你在简洁中获得的东西在代码清晰度方面会很快*失去。*

对于单个方法中的代码，有匿名类型；对于方法之外的代码，我想我会坚持使用简单的命名类型。当然，如果未来的 C# 可以更容易地使这些不可变（同时仍然易于使用），我会很高兴。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-12-01T04:32:09.207

我的开源 .NET [Sasa 库](http://sf.net/projects/sasa)多年来一直拥有元组（以及许多其他功能，例如完整的 MIME 解析）。几年来，我一直在生产代码中使用它。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-06T17:33:18.660

这是我的一组元组，它们是由 Python 脚本自动生成的，所以我可能有点过火了：

[链接到 Subversion 存储库](http://code.google.com/p/lvknet/source/browse/#svn/trunk/LVK/GenericTypes)

你需要一个用户名/密码，他们都是**客人**

它们基于继承，但`Tuple<Int32,String>`不会比较等于，`Tuple<Int32,String,Boolean>`即使它们碰巧对前两个成员具有相同的值。

他们还实现了 GetHashCode 和 ToString 等，以及许多小的辅助方法。

使用示例：

```
Tuple<Int32, String> t1 = new Tuple<Int32, String>(10, "a");
Tuple<Int32, String, Boolean> t2 = new Tuple<Int32, String, Boolean>(10, "a", true);
if (t1.Equals(t2))
    Console.Out.WriteLine(t1 + " == " + t2);
else
    Console.Out.WriteLine(t1 + " != " + t2); 
```

将输出：

```
10, a != 10, a, True 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-30T07:03:13.877

如果我没记错我的计算机科学课，元组只是数据。

如果您想要分组数据 - 创建包含属性的类。如果您需要类似[KeyValuePair](http://msdn.microsoft.com/en-us/library/5tbh8a42.aspx)的东西，那么它就在那里。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-30T07:07:59.077

我会感到惊讶 - C# 是一种强类型语言，而元组适用于更动态类型的语言。随着时间的推移，C# 变得更加动态，但这是语法糖，而不是底层数据类型的真正转变。

如果您想在一个实例中使用两个值，则 KeyValuePair<> 是一个不错的替代品，尽管很笨拙。您还可以创建一个结构或类来做同样的事情，并且是可扩展的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-06T17:23:37.963

为了使这些在哈希表或字典中有用，您可能希望为 GetHashCode 和 Equals 提供重载。

# deployment - 将 Websphere 门户部署到 6.1 服务器上

> ID：152022
> 
> 赞同：0
> 
> 时间：2008-09-30T07:00:49.840
> 
> 标签：deployment, rad, websphere-6.1, websphere-portal

每当我尝试在 Websphere Portal 6.1 服务器上发布我的 Portal 项目时，都会收到以下错误消息：

```
Portal project publishing is not supported on WebSphere Portal v6.1 Server 
```

这是真的还是我做错了什么？

我正在尝试部署一个门户项目，其基本目标是发布一个新主题。

不幸的是，每当我尝试部署时，我都会从 IDE 中收到上面列出的错误消息，并且控制台中没有错误。

RAD 版本是 7.0.0.7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-02T03:03:01.783

不确定这会有所帮助，但是：

> 限制：虽然 WebSphere Portal 安装程序包含安装空门户的高级选项，但 Portal Designer 依赖于管理 portlet 来设置访问控制；因此，不支持将门户项目发布到空门户。

您是在尝试部署一个 portlet 还是整个门户项目？您使用的是哪个版本的 RAD？错误日志中还有其他信息吗？（在 RAD 和 WP 服务器上）是否逐字发布错误消息？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-11T20:32:41.107

可以将这样的项目部署到 WebSphere Portal。我每天都使用 v6.2 并部署 Portlet，它们是大型 Portal 项目的一部分。我只是这类东西的初学者，但我可以说 WebSphere 确实有问题。您知道，“在本地、在工作区中”或“在服务器上”运行已部署的应用程序是一个很大的区别。我建议您使用服务器选项 - 管理控制台。

# web-services - WSDL 验证器？

> ID：152023
> 
> 赞同：85
> 
> 时间：2008-09-30T07:01:08.420
> 
> 标签：web-services, wsdl

是否有任何在线服务可用于验证 Web 服务 WSDL 文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-09-30T23:31:33.927

如果您使用的是 Eclipse，只需将 WSDL 放在 .wsdl 文件中，eclipse 就会自动验证它。

从[文档](http://wiki.eclipse.org/WSDL_Validator)

> WSDL 验证器根据上面定义的 4 步过程处理验证。步骤 1 和 2 都委托给 Apache Xerces（和 XML 解析器）。第 3 步由 WSDL 验证器和任何扩展命名空间验证器处理（更多关于下面的扩展）。第 4 步由任何已声明的自定义验证器处理（下面也会详细介绍）。必须通过每个步骤才能运行下一步。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T09:03:37.130

您可以尝试使用他们的工具之一：[http ://www.ws-i.org/deliverables/workinggroup.aspx?wg=testingtools](http://www.ws-i.org/deliverables/workinggroup.aspx?wg=testingtools)

这些将检查 WSDL 有效性和[Basic Profile 1.1](http://www.ws-i.org/Profiles/BasicProfile-1.1-2004-08-24.html)合规性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-11-16T00:45:42.590

如果您想以编程方式验证 WSDL，那么您可以在 Eclipse 之外使用 WSDL Validator。[http://wiki.eclipse.org/Using_the_WSDL_Validator_Outside_of_Eclipse](http://wiki.eclipse.org/Using_the_WSDL_Validator_Outside_of_Eclipse)应该帮助或尝试这个工具图形 WSDL 1.1/2.0 编辑器。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-30T07:34:13.367

你可能想看看[xsv的在线版本](http://www.w3.org/2001/03/webdata/xsv)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-10T13:38:49.947

你可以试试 wsdl 验证器[http://docs.wso2.org/wiki/display/ESB451/WSDL+Validator](http://docs.wso2.org/wiki/display/ESB451/WSDL+Validator)

# sql - 如何选择提交超过 10 次的所有用户

> ID：152024
> 
> 赞同：3
> 
> 时间：2008-09-30T07:01:27.610
> 
> 标签：sql

我有一个非常简单的提交表：userId、submissionGuid

我想选择表中提交数超过 10 的所有用户的用户名（简单的内连接来获取）。

我会使用嵌入式查询和 group by 来计算提交...但是有没有更好的方法（没有嵌入式查询）？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T07:04:58.350

这是最简单的方法，我相信：

```
select userId
from submission   
group by userId
having count(submissionGuid) > 10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T07:03:26.653

```
select userId, count(*)
from   submissions
having count(*) > 10
group by userId 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T07:09:05.470

```
SELECT 
    username 
FROM 
    usertable 
    JOIN submissions 
        ON usertable.userid = submissions.userid 
GROUP BY 
    usertable.username 
HAVING 
    Count(*) > 1 
```

*假设您的“用户”表称为用户表，并且它有一个名为“用户名”的列

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T07:15:39.917

我认为正确的查询是这样的（SQL Server）：

```
SELECT s.userId, u.userName
FROM submission s INNER JOIN users u on u.userId = s.userId   
GROUP BY s.userId, u.username
HAVING COUNT(submissionGuid) > 10 
```

如果您没有 HAVING 子句：

```
SELECT u.userId, u.userName
FROM users u INNER JOIN (
    SELECT userId, COUNT(submissionGuid) AS cnt
    FROM submission
    GROUP BY userId ) sc ON sc.userId = u.userId
WHERE sc.cnt > 10 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T10:54:15.053

选择 userid，count(submissionGUID) 作为 submitCount

从提交

按用户 ID 分组，提交计数

submitCount > 10

# c# - .NET 有什么好的图像识别库吗？

> ID：152028
> 
> 赞同：59
> 
> 时间：2008-09-30T07:02:49.837
> 
> 标签：c#, .net, vb.net, image, image-recognition

我希望能够将从网络摄像头拍摄的图像与存储在我计算机上的图像进行比较。

该库不需要百分百准确，因为它不会用于任何关键任务（例如警察调查），我只想要可以使用的东西。

[我已经尝试了CodeProject](http://www.codeproject.com/KB/cs/BackPropagationNeuralNet.aspx)的图像识别演示项目，它仅适用于小图像/当我比较完全相同的 120x90 像素图像时根本不起作用（这未被归类为 OK :P）。

图像识别之前有没有成功过？

如果是这样，您能否提供指向我可以在 C# 或 VB.NET 中使用的库的链接？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-09-30T07:16:33.983

你可以试试这个：[http ://code.google.com/p/aforge/](http://code.google.com/p/aforge/)

它包括一个比较分析，会给你一个分数。还包括所有类型的许多其他出色的成像功能。

```
// The class also can be used to get similarity level between two image of the same size, which can be useful to get information about how different/similar are images:
// Create template matching algorithm's instance

// Use zero similarity to make sure algorithm will provide anything
ExhaustiveTemplateMatching tm = new ExhaustiveTemplateMatching(0);

// Compare two images
TemplateMatch[] matchings = tm.ProcessImage( image1, image2 );

// Check similarity level
if (matchings[0].Similarity > 0.95)
{
    // Do something with quite similar images
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-10-26T15:58:37.617

您可以完全将[EmguCV](http://www.emgu.com/wiki/index.php/Main_Page)用于 .NET。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-14T09:32:17.160

我做的很简单。[只需在此处](http://similarimagesfinder.codeplex.com/)下载 EyeOpen 库。然后在您的 C# 类中使用它并编写以下代码：

```
 use eyeopen.imaging.processing 
```

写

```
ComparableImage cc;

ComparableImage pc;

int sim;

void compare(object sender, EventArgs e){

    pc = new ComparableImage(new FileInfo(files));

    cc = new ComparableImage(new FileInfo(file));

    pc.CalculateSimilarity(cc);

    sim = pc.CalculateSimilarity(cc);

    int sim2 = sim*100

    Messagebox.show(sim2 + "% similar");
} 
```

# visual-studio - 在 C# 中构建大型 Winforms 应用程序的项目和依赖项

> ID：152053
> 
> 赞同：24
> 
> 时间：2008-09-30T07:13:13.087
> 
> 标签：visual-studio, winforms, architecture, projects-and-solutions

**更新：**
这是我访问量最大的问题之一，但我仍然没有真正为我的项目找到令人满意的解决方案。我在另一个问题的答案中读到的一个想法是创建一个工具，该工具可以为您从列表中选择的项目“即时”构建解决方案。不过，我还没有尝试过。

* * *

如何构建一个非常大的应用程序？

*   一个大型解决方案中的多个小型项目/组件？
*   几个大项目？
*   每个项目一个解决方案？

以及在没有一种解决方案的情况下如何管理依赖项。注意：我正在寻找基于经验的建议，而不是您在 Google 上找到的答案（我可以自己做）。

我目前正在开发一个应用程序，它有超过 80 个 dll，每个都有自己的解决方案。管理依赖项几乎是一项全职工作。有一个自定义的内部“源代码控制”，添加了用于在各处复制依赖 dll 的功能。对我来说似乎是一个次优的解决方案，但有更好的方法吗？我担心，在实践中处理一个包含 80 个项目的解决方案会非常困难。

（上下文：winforms，而不是 web）

编辑：（*如果您认为这是一个不同的问题，请给我留言）*

在我看来，以下之间存在相互依赖关系：

*   应用程序的项目/解决方案结构
*   文件夹/文件结构
*   源代码控制的分支结构（如果使用分支）

但是，如果可能的话，我很难将它们分开来单独考虑。

*我在[这里](https://stackoverflow.com/questions/177338/what-do-you-do-about-references-when-unloading-a-project-in-visual-studio)问了另一个相关的问题。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T08:07:45.250

**源代码控制**

我们有 20 或 30 个项目被构建到 4 或 5 个离散解决方案中。我们正在为 SCM 使用 Subversion。

1) 我们在 SVN 中有一棵树，其中包含按名称空间和项目名称逻辑组织的所有项目。根目录中有一个 .sln 可以构建它们，但这不是必需的。

2) 对于每个实际解决方案，我们在 SVN 中都有一个新的 trunks 文件夹，其中包含 SVN：对所有必需项目的外部引用，以便它们从主树下的位置更新。

3) 在每个解决方案中是 .sln 文件加上一些其他必需的文件，以及该解决方案独有且不跨解决方案共享的任何代码。

拥有许多较小的项目有时会有点痛苦（例如，TortoiseSVN 更新消息会被所有这些外部链接弄乱）但确实具有不允许循环依赖的巨大优势，因此我们的 UI 项目依赖于 BO项目，但 BO 项目不能引用 UI（也不应该！）。

**架构** 我们已经完全切换到使用[MS SCSF 和 CAB 企业](http://msdn.microsoft.com/en-us/library/bb266334.aspx)模式来管理我们的各种项目在 Win Forms 界面中组合和交互的方式。我不确定你是否有同样的问题（多个模块需要在一个通用表单环境中共享空间），但如果你这样做了，那么这很可能会给你如何构建和组装你的解决方案带来一些理智和惯例。

我提到这是因为 SCSF 倾向于将 BO 和 UI 类型的函数合并到同一个模块中，而之前我们保持严格的 3 级策略：

FW - 框架代码。功能与软件相关的代码。BO - 业务对象。其功能与问题域关注点相关的代码。UI - 与 UI 相关的代码。

在那种情况下，依赖关系严格是 UI -> BO -> FW

我们发现即使在使用 SCSF 生成的模块时我们也可以保持这种结构，所以世界上一切都很好:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-27T18:12:25.987

To manage dependencies, whatever the number of assemblies/namespaces/projects you have, you can have a glance at the tool [NDepend](http://www.ndepend.com/Features.aspx#DependenciesView).

Personnaly, I foster few large projects, within one or several solutions if needed. I wrote about my motivations to do so here: [Benefit from the C# and VB.NET compilers perf](http://codebetter.com/blogs/patricksmacchia/archive/2007/06/20/benefit-from-the-c-and-vb-net-compilers-perf.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T07:26:04.197

我认为拥有一个包含所有 80 个项目的解决方案非常重要，即使大多数开发人员大部分时间都使用其他解决方案。根据我的经验，我倾向于使用一个大型解决方案，但为了避免每次按 F5 时都重新构建所有项目的痛苦，我转到解决方案资源管理器，右键单击我现在不感兴趣的项目，并执行“卸载项目”。这样，该项目将保留在解决方案中，但不会花费我任何费用。

话虽如此，80是一个很大的数字。根据这 80 个分解成离散子系统的程度，我还可能创建其他解决方案文件，每个文件都包含一个有意义的子集。这将为我节省大量右键单击/卸载操作的工作量。尽管如此，您将拥有一个大解决方案这一事实意味着始终对它们的相互依赖关系有明确的看法。

*在我使用过的所有源代码管理系统中，他们的 VS 集成选择将 .sln 文件置于源代码管理中，除非*.sln 文件在源代码管理中，否则许多系统无法正常工作。我觉得这很有趣，因为 .sln 文件曾经被认为是个人的东西，而不是项目范围的东西。我认为唯一一种绝对值得源代码控制的 .sln 文件是包含所有项目的“一个大解决方案”。例如，您可以将其用于自动构建。正如我所说，个人可能会为了方便而创建自己的解决方案，我并不反对那些进入源代码控制的人，但它们对个人比对项目更有意义。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T07:48:26.530

我认为最好的解决方案是将其分解为更小的解决方案。在我现在工作的公司，我们也有同样的问题；80 个项目++ 在解决方案中。我们所做的是将项目分成几个较小的解决方案。来自其他项目的依赖 dll 被构建并链接到项目中，并与项目一起签入源代码控制系统。它使用更多的磁盘空间，但磁盘很便宜。这样做，我们可以保留项目的版本 1，直到绝对需要升级到版本 1.5。不过，在决定升级到其他版本的 dll 时，您仍然需要添加 dll。谷歌代码上有一个名为[TreeFrog的项目](http://code.google.com/p/treefrog/)这显示了如何构建解决方案和开发树。它还不包含 mush 文档，但我想您可以通过查看结构来了解如何做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T08:04:48.330

我见过的一种很好的方法是拥有一个包含所有项目的大型解决方案，以允许测试项目范围的构建（尽管它太大了，但没有人真正使用它来构建。），然后拥有供开发人员使用的较小项目，其中将各种相关项目组合在一起。

这些确实依赖于其他项目，但除非接口发生变化，或者他们需要更新他们正在使用的 dll 的版本，否则他们可以继续使用较小的项目而不必担心其他一切。因此，他们可以在处理项目时签入项目，然后在其他用户应该开始使用它们时固定它们（在更改版本号之后）。

最后一周一次或两次甚至更频繁地仅使用固定代码重建整个解决方案，从而检查集成是否正常工作，并为测试人员提供一个良好的构建来进行测试。

我们经常发现大段代码不会经常更改，所以一直加载它是没有意义的。（当您从事较小的项目时。）

使用这种方法的另一个优点是在某些情况下，我们有一些功能需要几个月才能完成，通过使用上述方法意味着这可以继续进行而不会中断其他工作流。

我想对此的一个关键标准是在您的解决方案中没有很多交叉依赖关系，如果这样做，这种方法可能不合适，但是如果依赖关系更加有限，那么这可能是要走的路。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-09-29T05:56:18.637

对于我参与过的几个系统，我们为不同的组件提供了不同的解决方案。每个解决方案都有一个通用的输出文件夹（带有调试和发布子文件夹）

我们在解决方案中使用项目引用并在它们之间使用文件引用。每个项目都使用参考路径来定位来自其他解决方案的程序集。我们必须手动编辑 .csproj.user 文件以将 $(Configuration) msbuild 变量添加到引用路径，因为 VS 坚持验证路径。

对于 VS 之外的构建，我编写了 msbuild 脚本，这些脚本递归地识别项目依赖项，从 subversion 中获取它们并构建它们。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-13T15:26:27.077

我放弃了项目参考（虽然你的宏听起来很棒），原因如下：

*   在有时存在依赖项目而有时不存在的不同解决方案之间切换并不容易。
*   需要能够自行打开项目并构建它，并独立于其他项目进行部署。如果使用项目引用构建，这有时会导致部署问题，因为项目引用导致它寻找特定版本或更高版本，或类似的东西。它限制了交换不同版本依赖项的混合和匹配能力。
*   此外，我有一些项目指向不同的 .NET Framework 版本，因此真正的项目引用并不总是发生。

（仅供参考，我所做的一切都是针对 VB.NET，所以不确定 C# 的行为是否有任何细微差别）

所以我：

*   我从全局文件夹（如 C:\GlobalAssemblies）针对解决方案中打开的任何项目以及未打开的项目进行构建
*   我的持续集成服务器在网络共享上保持最新状态，并且我有一个批处理文件可以将任何新内容同步到我的本地文件夹。
*   我有另一个本地文件夹，例如 C:\GlobalAssembliesDebug，其中每个项目都有一个后期构建步骤，仅在 DEBUG 模式下将其 bin 文件夹的内容复制到此调试文件夹。
*   每个项目都将这两个全局文件夹添加到它们的参考路径中。（首先是 C:\GlobalAssembliesDebug，然后是 C:\GlobalAssemblies）。我必须手动将此引用路径添加到 .vbproj 文件，因为 Visual Studio 的 UI 会将它们添加到 .vbprojuser 文件中。
*   我有一个预构建步骤，如果处于 RELEASE 模式，则从 C:\GlobalAssembliesDebug 中删除内容。
*   在作为宿主项目的任何项目中，如果有我需要复制的非 dll（输出到我需要的其他项目的 bin 文件夹的文本文件），那么我在该项目上放置一个预构建步骤以将它们复制到宿主项目中。
*   我必须在解决方案属性中手动指定项目依赖项，才能让它们以正确的顺序构建。

所以，它的作用是：

*   允许我在任何解决方案中使用项目，而不会弄乱项目引用。
*   Visual Studio 仍然允许我进入解决方案中打开的依赖项项目。
*   在 DEBUG 模式下，它针对打开的加载项目进行构建。因此，首先它查看 C:\GlobalAssembliesDebug，然后如果不存在，则查看 C:\GlobalAssemblies
*   在 RELEASE 模式下，由于它会删除 C:\GlobalAssembliesDebug 中的所有内容，因此它只查找 C:\GlobalAssemblies。我想要这样做的原因是，发布的构建不会针对我的解决方案中临时更改的任何内容构建。
*   无需太多努力即可轻松加载和卸载项目。

当然，它并不完美。调试体验不如项目参考。（不能做诸如“去定义”之类的事情并让它正常工作），以及其他一些古怪的小事情。

无论如何，这就是我试图让事情对我们最有利的地方。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-18T11:14:02.863

好的，消化了这些信息，并回答了[这个](https://stackoverflow.com/questions/177338/what-do-you-do-about-references-when-unloading-a-project-in-visual-studio)关于项目参考的问题，我目前正在使用这个配置，这似乎“为我工作”：

*   一个大解决方案，包含应用程序项目和所有依赖组装项目
*   我保留了所有项目引用，并对一些动态实例化的程序集进行了一些额外的手动依赖项调整（右键单击项目）。
*   我有三个解决方案文件夹（_Working、Synchronized 和 Xternal）——考虑到我的源代码控制未与 VS（*sob*）集成，这使我可以在 _Working 和 Synchronized 之间快速拖放项目，这样我就不会迷失方向的变化。XTernal 文件夹用于“属于”同事的程序集。
*   我为自己创建了一个“WorkingSetOnly”配置（Debug/Release 下拉菜单中的最后一个选项），它允许我限制在 F5/F6 上重建的项目。
*   就磁盘而言，我将所有项目文件夹都放在几个文件夹之一中（因此只有项目上方的一级分类）
*   所有项目都构建（dll、pdb 和[xml](https://stackoverflow.com/questions/277459/framework-goto-definition-shows-comments-are-these-generated-from-xml-comments)）到相同的输出文件夹，并具有相同的文件夹作为参考路径。（并且所有引用都设置为不复制） - 这让我可以选择从我的解决方案中删除一个项目并轻松切换到文件引用（我有一个宏）。
*   在与我的“项目”文件夹相同的级别上，我有一个“解决方案”文件夹，我在其中维护一些程序集的单独解决方案 - 以及特定于程序集的测试代码（例如）和文档/设计等。

目前，这种配置对我来说似乎还可以，但最大的考验是尝试将它卖给我的同事，看看它是否能作为一个团队设置飞行。

**目前未解决的缺点：**

*   我仍然对单独的组装解决方案有疑问，因为我并不总是想包含所有依赖项目。这会与“主”解决方案产生冲突。我已经（再次）使用一个宏来解决这个问题，该宏将损坏的项目引用转换为文件引用，如果项目被添加回来，则将文件引用恢复为项目引用。
*   不幸的是，没有办法（到目前为止我发现）将构建配置链接到解决方案文件夹 - 能够说“在这个文件夹中构建所有东西”会很有用 - 就目前而言，我必须手动更新它（痛苦，容易忘记）。（您可以右键单击解决方案文件夹进行构建，但这不能处理 F5 场景）
*   解决方案文件夹实现中有一个（小）错误，这意味着当您重新打开解决方案时，项目按添加顺序显示，而不是按字母顺序显示。（我已经[用 MS 打开了一个错误](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=380287)，显然现在已更正，但我猜是 VS2010）
*   我不得不卸载[CodeRushXPress](http://msdn.microsoft.com/en-us/vcsharp/dd218053.aspx)加载项，因为它会阻塞所有代码，但这是在修改构建配置之前，所以我要再试一次。

**总结 - 在问这个问题之前我不知道的事情已经证明是有用的：**

1.  使用[解决方案文件夹](http://msdn.microsoft.com/en-us/library/haytww03(VS.80).aspx)来组织解决方案而不会弄乱磁盘
2.  创建构建配置以排除某些项目
3.  能够手动定义项目之间的依赖关系，即使它们使用文件引用

这是我最受欢迎的问题，所以我希望这个答案对读者有所帮助。我仍然对其他用户的进一步反馈非常感兴趣。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T08:43:42.637

我们在主分支上的源代码控制上有一个巨大的解决方案。

但是，在项目的较小部分工作的每个开发人员/团队都有自己的分支，其中包含一个解决方案，只需要很少的项目。这样，该解决方案足够小，易于维护，并且不会影响较大解决方案中的其他项目/dll。

但是，这样做有一个条件：解决方案中不应有太多相互关联的项目。

# c++ - 如何测量 C++ (MFC) 应用程序的性能？

> ID：152064
> 
> 赞同：5
> 
> 时间：2008-09-30T07:20:17.860
> 
> 标签：c++, performance, optimization, mfc

你知道哪些好的分析器？

测量和调整 C++ MFC 应用程序性能的好方法是什么？

算法分析真的有必要吗？[http://en.wikipedia.org/wiki/Algorithm_analysis](http://en.wikipedia.org/wiki/Algorithm_analysis)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T09:11:34.007

如果您使用 Windows 平台，我强烈推荐[AQTime 。](http://www.automatedqa.com)它带有大量分析器，包括静态代码分析，并且可以与最重要的 Windows 编译器和系统一起使用，包括 Visual C++、.NET、Delphi、Borland C++、Intel C++ 甚至 gcc。它集成到 Visual Studio 中，但也可以独立使用。我喜欢它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T09:48:10.220

如果您（仍在）使用 Visual C++ 6.0，我建议使用内置分析器。对于更新的版本，您可以尝试[Compuware DevPartner 性能分析社区版](http://www.compuware.com/media.asp?cid=701000000004ej0)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T09:58:19.540

对于 Windows，请查看随 Windows SDK 免费提供的[Xperf 。](http://blogs.msdn.com/pigscanfly/archive/2008/02/09/xperf-a-new-tool-in-the-windows-sdk.aspx)它使用采样配置文件，具有一些有用的 UI，并且不需要检测。对于跟踪性能问题非常有用。您可以回答以下问题：

谁使用的 CPU 最多？使用调用堆栈深入到函数名称。谁分配的内存最多？谁做的注册表查询最多？磁盘写入？等等。当您发现瓶颈时，您会感到非常惊讶，因为它们可能不是您预期的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T07:34:04.520

自从我分析非托管代码已经有一段时间了，但是当我这样做时，我在 Intel 的 vtune 上取得了不错的成绩。我相信其他人会告诉我们这是否已被超越。

算法分析有可能比使用分析器发现的任何东西都更深刻地提高您的性能，但仅适用于某些类别的应用程序。如果您对相当大的数据集进行操作，算法分析可能会找到在 CPU/内存/两者方面更有效的方法，但如果您的应用程序主要是使用关系数据库进行存储的表单填充，它可能不会为您提供太多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T08:06:04.490

Intel Thread Checker via Vtune 性能分析器——查看这张图片，查看我最常使用的视图，它告诉我哪个函数占用了我最多的时间。

![替代文字](https://computinglife.files.wordpress.com/2008/09/without-fault.jpg)

我可以进一步深入研究并分解其中的哪些函数会占用更多时间等。根据您正在观看的内容（总时间 = fn + children 中的时间），self time（仅花费在代码中运行的时间）有不同的视图功能等）。

这个工具不仅仅是分析，但我还没有全部探索过。我肯定会推荐它。该工具还可以作为可运行 30 天的全功能试用版下载。如果您有成本限制，我会说这个窗口是您确定问题所需的全部。

在此处下载试用版 - [https://registrationcenter.intel.com/RegCenter/AutoGen.aspx?ProductID=907&AccountID=&ProgramID=&RequestDt=&rm=EVAL&lang=](https://registrationcenter.intel.com/RegCenter/AutoGen.aspx?ProductID=907&AccountID=&ProgramID=&RequestDt=&rm=EVAL&lang=)

ps：我也玩过 Rational Rational，但出于某种原因，我并没有太多兴趣。我怀疑 Rational 也可能比 Intel 更贵。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T13:43:22.137

可以让您查看源代码行命中计数的工具（例如来自 DevPartner 的真实时间）让您可以快速找到具有糟糕“Big O”复杂性的算法。您仍然必须分析算法以确定如何降低复杂性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-02T12:02:02.613

在大多数情况下，我第二个 AQTime，同时拥有 AQTime 和 Compuwares DevPartner。原因是 AQTime 将分析任何具有有效 PDB 文件的可执行文件，而 TrueTime 要求您进行检测构建。这大大加快并简化了临时分析。如果这是一个问题，DevPartner 的成本也会更高。DevPartner 的优势在于 BoundsChecker，我仍然认为它是比 AQTimes 执行分析器更好的捕获泄漏和覆盖的工具。TrueTime 可能比 AQTime 更准确，但我从未发现这是一个问题。

如果您需要在本地应用程序上提高性能，那么分析是否值得，IMO 是的。我认为您还学到了很多关于您的程序和算法如何真正工作的知识，以及使用某些类型的对象类来存储和迭代数据的成本影响。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T07:33:30.013

[Glowcode](http://www.glowcode.com/)是一个非常好的分析器（当它工作时）。它可以附加到正在运行的程序并且只需要符号文件 - 您不需要重新构建。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T08:29:55.447

某些版本的 pf visual studio 2005（可能还有 2008）实际上带有一个相当不错的性能分析器。
如果您有它，它应该在工具菜单下可用，
或者您可以搜索打开“性能资源管理器”窗口以开始新的性能会话的方法。
[MSDN 的链接](http://msdn.microsoft.com/en-gb/library/ms182371(VS.80).aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-30T16:47:03.550

仅供参考，某些版本的 Visual Studio 仅附带非优化编译器。对于我的一个 MFC 应用程序，如果我使用带有 -o3 的 MINGW/MSYS（gcc 编译器）编译它，那么它的运行速度大约是我使用 Visual Studio 编译的版本的 5-10 倍。

例如，我有一个 openstreetmap xml 编译器，处理一个 2.7GB 的 xml 文件大约需要 3 分钟（gcc 编译版本）。我的 Visual Studio 编译相同代码大约需要 18 分钟才能运行。

# python - 检查以下划线开头的属性是否可以？

> ID：152068
> 
> 赞同：4
> 
> 时间：2008-09-30T07:24:25.743
> 
> 标签：python, sqlalchemy, pylons

我一直在为塔架开发一个非常简单的 crud 生成器。我想出了一些检查的东西

```
SomeClass._sa_class_manager.mapper.c 
```

可以检查这个（或调用以下划线开头的方法）吗？我总是认为这是合法的，尽管不赞成，因为它严重依赖于类/对象的内部结构。但是，嘿，既然 python 并没有真正意义上的 Java 接口，也许没关系。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-30T07:29:36.543

故意（在 Python 中）没有“私有”范围。这是一个约定，任何以下划线开头的东西都不应该被理想地使用，因此如果它的行为或定义在下一个版本中发生变化，你可能不会抱怨。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-30T07:40:11.167

一般来说，这通常表明该方法实际上是内部的，而不是文档化接口的一部分，不应依赖。该库的未来版本可以自由重命名或删除此类方法，因此如果您关心未来的兼容性而不必重写，请避免这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T07:29:18.463

如果有效，为什么不呢？但是，当 _sa_class_manager 进行重组、将自己绑定到此特定版本的 SQLAlchemy 或创建更多工作以跟踪更改时，您可能会遇到问题。由于 SQLAlchemy 是一个快速移动的目标，因此您可能已经在一年内到达那里。

最好的方法是将您想要的 API 集成到 SQLAlchemy 本身中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T13:10:17.583

由于已经提到的原因，这通常不是一个好主意。但是，Python 故意允许这种行为，以防没有其他方法可以做某事。

例如，如果您有一个封闭源代码编译的 Python 库，而作者认为您不需要直接访问某个对象的内部状态（但您确实需要），您仍然可以获得所需的信息。在跟上不同的版本时，您遇到了之前提到的相同问题（如果您足够幸运，它仍然得到维护），但至少您实际上可以做您想做的事情。

# .net - 如果更改 RightToLeft、ShowInTaskbar 属性，Form.ShowDialog() 会意外结束

> ID：152069
> 
> 赞同：1
> 
> 时间：2008-09-30T07:25:01.030
> 
> 标签：.net, winforms, localization

对话框以取消结果关闭，没有例外，就像您按下了关闭按钮一样。
设置 RightToLeft 属性的唯一安全位置是在表单构造函数中。

我突然想到，这些信息可能会节省其他人的时间。
如果您能够详细说明问题：如果有官方错误确认，还有什么可能导致 ShowDialog 意外结束，请做。

[回复：靠近托盘 - MSDN 论坛](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=651441&SiteID=1)

[在运行时更改 Form RightToLeft 属性](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=651441&SiteID=1)

* * *

引用第二个链接：

> 我在不到两天的时间内发现了第二个错误。这个新错误非常关键。
> 
> 我将 Normal Form 的 RightToLeft 属性设置为默认值 ( RightToLeft=False) 。让我们用 Show Function ( Form1.Show(me) ) 来展示这个表单
> 
> 在此表单中，有一个按钮将表单 RightToLeft 更改为 Yes 而不是 No：
> 
> Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) 处理 Button1.Click
> Me.RightToLeft = Windows.Forms.RightToLeft.Yes
> End Sub
> 
> 表单将成功地将其标题更改为右侧。
> 
> 到此为止没有问题。
> 
> 问题出现如下
> 
> 如果我们使用 ShowDialog(Me) 函数向用户显示此表单，而不是使用 Show(Me) 显示它。然后点击 Button 将 Form RightToLeft 更改为 Yes 而不是 No，Form 会无缘无故地突然关闭，甚至不会抛出任何异常。
> 这是新问题，它也存在于 .NET 3.0 (Orcase) 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T07:48:05.140

好的...我有一个快速解决方案给你。这很**讨厌**，这是一个**黑客**，但它*有点*工作。

从我对[原始问题](https://stackoverflow.com/questions/147657/how-to-make-righttoleftlayout-work-for-controls-inside-groupboxes-and-panels#148108)的回答：

```
private bool _rightToLeft;
private void SetRTL(bool setRTL)
{
    _rightToLeft = true;
    ApplyRTL(setRTL, this);
}

private void ApplyRTL(bool yes, Control startControl)
{
    if ((startControl is Panel) || (startControl is GroupBox))
    {
        foreach (Control control in startControl.Controls)
        {
            control.Location = CalculateRTL(control.Location, startControl.Size, control.Size);
        }
    }
    foreach (Control control in startControl.Controls)
        ApplyRTL(yes, control);
}

private Point CalculateRTL(Point currentPoint, Size parentSize, Size currentSize)
{
    return new Point(parentSize.Width - currentSize.Width - currentPoint.X, currentPoint.Y);
}

private void Form2_FormClosing(object sender, FormClosingEventArgs e)
{
    if (_rightToLeft)
    {
        _rightToLeft = false;
        e.Cancel = true;
    }
} 
```

如果您刚刚进行了从右到左的交换（_rightToLeft） ，它会附加到*表单关闭事件*然后告诉它不要关闭。告诉它不要关闭后，您删除从右到左的标志并让生活继续。

***错误：**关闭使用 .Show(this) 打开的表单时会出现错误，但我相信您可以修复它！

# sql-server - 在 Visual Studio 报表设计器中显示布尔字段

> ID：152071
> 
> 赞同：1
> 
> 时间：2008-09-30T07:25:55.133
> 
> 标签：sql-server, reporting-services

我试图在 Visual Studio 2008 的报表设计器中显示一个布尔字段。当我尝试运行它时，发生了错误：

```
 "An error has occurred during report processing.
      String was not recognized as a valid Boolean." 
```

我尝试使用 CBool​​() 对其进行转换，但没有成功。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-04T03:39:04.500

```
=iif(Fields!YourBool.Value, "True", "False") 
```

我错过了什么吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-01T16:42:02.433

I may be mistaken here, but CBool is to convert to boolean. What you probably want is to convert to string so that it can be displayed. However, I'm not sure what the default behaviour would be (i.e. 0/1, true/false, -1/0, Yes/No, etc.) so you could add a function to the code section in the report to display a boolean the exact way you want.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T08:59:28.590

我使用的是 SQL Server 2005。数据类型是位。

# database-design - SQL 模式用于保存员工来/去/升职等时的员工行为历史记录

> ID：152074
> 
> 赞同：0
> 
> 时间：2008-09-30T07:26:19.343
> 
> 标签：database-design

我正在编写一个包含以下表格的应用程序：（1）employee_type，（2）employee 和（3）employee_action。

Employee_action 对员工来说是外键的，它包含对发生的事情和事件日期的描述，正如您所期望的那样。

但是，员工可以随着时间的推移改变他们的类型（晋升、降职、调动等）。如果我的模式就这么简单，那么您可能会生成一份历史报告，说明 John 在 10 年前外出送披萨时是公司的 CEO。

对我来说，最好的方法是保存员工在执行某项操作时具有某些特征的事实，而这些特征不一定是他们目前的特征？

我在这里简单地陈述我的问题。我的桌子比 3 多得多，而且员工职位并不是我担心的唯一特征。我不能只对所有内容进行非规范化并制作一个包含每个可能的员工字段的历史表。

谢谢，我希望这很清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T07:36:53.950

在 SQL 中表示时间数据很棘手。关于这个主题有一本非常好的书，作者甚至可以在线免费获得它：[http](http://www.cs.arizona.edu/people/rts/tdbbook.pdf) ://www.cs.arizona.edu/people/rts/tdbbook.pdf 。

亚马逊页面位于[http://www.amazon.com/Developing-Time-Oriented-Database-Applications-Management/dp/1558604367](https://rads.stackoverflow.com/amzn/click/com/1558604367)，但已绝版。

如果您认真对待 SQL 中随时间推移的变化建模，那么这本书是必读的。我从中学到了很多，我只理解了其中的 25%，只读过一次 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T07:29:32.673

您是否考虑过引入一个连接employee_type 和employee 的转换（多对多）表，然后将employee 操作链接到这个转换表？转换表可以有一个附加的时间戳列，这样您就可以按时间顺序跟踪事物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T07:41:02.053

为了回答你的问题，我认为你唯一的选择（如果你不能对架构进行任何重新设计）是添加一个表来存储特定条件成立的时间跨度，例如员工的表就业历史，一个职位（“CEO”、“送货员”或这些职位的 ID，如果您将它们规范化为表格）和一个字段用于员工担任该职位的开始日期和结束日期。这样你就可以加入employment_history 表来获得人们目前的职位。当然，如果您需要存储更多的“属性”而不仅仅是将成为指数增长的 PITA 的位置。阅读上面的书以获得更多讨论:)

# java - 针对接口进行编程：您是否为所有域类编写接口？

> ID：152077
> 
> 赞同：23
> 
> 时间：2008-09-30T07:27:44.847
> 
> 标签：java, model, dns, interface

我同意，针对接口进行编程是一种很好的做法。在大多数情况下，Java 中的“接口”在这个意义上是指语言构造接口，因此您编写一个接口和一个实现类，并且大多数时候您使用接口而不是实现类。

我想知道这是否也是编写域模型的好习惯。因此，例如，如果您有一个域类 Customer，并且每个客户可能有一个 Orders 列表，那么您*通常*还会编写接口 ICustomer 和 IOrder。并且客户也会有一个 IOrders 列表而不是 Orders 吗？或者你会在域模型中使用接口，只有当它真的由域驱动时，例如你有至少两种不同类型的订单？换句话说，您会因为领域模型中的技术需求而使用接口，还是仅在它真正适合实际领域时才使用接口？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-09-30T07:35:25.517

“仅仅因为”编写界面让我觉得浪费时间和精力，更不用说违反了 KISS 原则。

当它们实际上用于表示相关类的常见行为时，我会编写它们，而不仅仅是作为一个花哨的头文件。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-30T07:36:15.933

不要过度设计你的系统。如果您发现您有几种类型的 Orders 并认为为 Orders 声明一个接口而不是在需要时重构它是合适的。对于领域模型，特定接口在开发生命周期中发生很大变化的可能性很高，因此尽早编写接口几乎没有用处。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-30T07:45:11.687

接口是隔离组件以进行单元测试和一般依赖管理的绝佳方式。话虽如此，我经常更喜欢抽象类，因此至少有一些常见的行为在那里被卸载，而不是强制接口带来的一些重复。现代 IDE 可以快速轻松地生成接口，因此它们的工作量并不*大*:-)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-30T14:01:27.193

不，我只在域对象上使用接口来保持它们松散耦合。对我来说，使用接口开发自己的代码的主要钩子是我可以在进行单元测试时轻松创建模拟。我没有看到模拟域对象的意义，因为它们没有服务层或 DAO 层类所具有的相同依赖项。

这当然并不意味着偏离在域对象中使用接口。在适当的地方使用。例如，最近我一直在开发一个 web 应用程序，其中不同类型的域对象对应于用户可以在其中发表评论的永久链接页面。因此，这些域对象中的每一个现在都实现了“Commentable”接口。然后，所有基于注释的代码都被编程到 Commentable 接口而不是域对象。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-30T07:45:40.467

我建议保持精益和敏捷——在你需要做之前不要做任何事情，然后让你的 IDE 在你需要的时候为你做重构。

当您决定需要一个具体类时，它在 IDEA/eclipse 中非常简单。

如果您有许多接口实现注入到您正在使用“新”的代码中的位置，则使用[Spring](http://www.springframework.org/)或[Guice的依赖注入](http://code.google.com/p/google-guice/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-29T00:40:19.240

实际上，这个问题是关于“针对接口编程”的常见误解的一个例子。

你看，这*是*一个很好的原则，但并不*像*很多人认为的那样！

“编程到接口，而不是实现”（来自 GoF 书中）的意思就是，您不应该竭尽全力为所有内容*创建*单独的接口。如果您有一个`ArrayList`对象，则将变量/字段/参数/返回类型声明为 type `List`。客户端代码将只处理接口类型。

在 Joshua Bloch 的“Effective Java”一书中，在“第 52 条：通过接口引用对象”中更清楚地表达了该原理。它甚至用粗体字说：

> 如果不存在适当的接口，则通过类而不是接口来引用对象是完全合适的。

对于单元测试，情况完全取决于所使用的模拟工具的功能。使用我自己的工具[JMockit](http://code.google.com/p/jmockit)，我可以为使用接口和依赖注入的代码编写单元测试，就像为使用从被测代码内部实例化的最终类的代码编写单元测试一样容易。

所以，对我来说，答案是：始终使用已经存在的接口，但如果没有充分的理由，请避免创建新的接口（并且*testability*本身不应该是一个）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-30T11:37:11.550

在需要之前编写接口（用于测试或架构）是一种矫枉过正的做法。

此外，手动编写界面是浪费时间。您可以使用 Resharper 的重构“拉成员”让它在几秒钟内从特定类中创建新接口。与 IDE 集成的其他重构工具也应该具有类似的功能。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-30T07:37:30.657

我通常只使用对较小项目有意义的接口。但是，我最近的工作有一个大型项目，其中几乎每个域对象都有一个接口。这可能有点矫枉过正，而且确实很烦人，但是我们测试和使用 Spring 进行依赖注入的方式需要它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-30T07:40:38.560

我们主要使用 Wicket、Spring 和 Hibernate 编写 Web 应用程序，并且我们使用 Spring Bean 的接口，例如服务和 DAO。对于这些类，接口是完全有意义的。但是我们也为每个域类使用接口，我认为这只是矫枉过正。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-30T07:42:25.903

即使您很确定模型对象只会有一种具体类型，使用接口也可以使模拟和测试更加容易（但是现在有框架可以帮助您自动生成模拟类，即使对于具体的 Java 类也是如此 - Mockito、JTestR、Spring、Groovy...）

但我更经常将接口用于服务，因为在测试期间模拟它们更为重要，而针对接口进行编程可以帮助您考虑诸如封装之类的事情。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-30T08:07:11.990

如果您将域类用于单元测试，则为域类编写接口是有意义的。我们在单元测试中使用 Mock 对象。所以，如果你有一个域对象的接口并且你的域对象本身还没有准备好，但是你的客户端可以通过模拟对象的帮助来测试它对接口的使用。

接口还为你的域模型测试你的接口的多个实现。所以，我不认为它总是矫枉过正。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-30T08:17:29.360

我认为针对接口进行编程的主要原因是可测试性。因此，对于域对象 - 只需坚持 POJO 或 POC#Os :) 等，即，只需让您的类不添加任何特定框架，以防止它们具有不同的构建和运行时依赖关系，仅此而已。不过，为 DAO 创建接口是个好主意。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-30T15:54:09.233

我们从所有东西中提取接口只是因为它有助于测试（模拟）和 AOP 之类的东西。Eclipse 可以自动执行此操作：Refactor->Extract Interface。

如果以后需要修改类，可以使用 Refactor->Pull Up... 将需要的方法拉到接口上。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-18T16:47:21.370

*我这样做是因为我需要它来创建我的域对象的代理。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-30T14:45:13.907

这是我遇到的另一件事要记住，尤其是生成的域和 DAO 对象。很多接口都太具体了。说很多领域对象都有一个ID和一个状态字段，为什么他们不共享一个通用的接口呢？这让我感到沮丧，这是一个不必要的扁平化（继承方面）域模型。

# c++ - C++ 中的定点组合器

> ID：152084
> 
> 赞同：11
> 
> 时间：2008-09-30T07:29:39.197
> 
> 标签：c++, bind, y-combinator

我对使用定点组合器的实际示例感兴趣（例如 C++ 中的[y 组合](https://stackoverflow.com/questions/93526/what-is-a-y-combinator)器。您是否曾经在真实的实时代码中使用带有[egg](http://p-stade.sourceforge.net/boost/libs/egg/doc/html/boost_egg/function_adaptors.html#boost_egg.function_adaptors.fix)或[绑定](http://www.boost.org/doc/libs/1_36_0/libs/bind/bind.html)的定点组合器？

我发现鸡蛋中的这个例子有点密集：

```
void egg_example()
{
    using bll::_1;
    using bll::_2;

    int r =
        fix2(
            bll::ret<int>(
                // \(f,a) -> a == 0 ? 1 : a * f(a-1)
                bll::if_then_else_return( _2 == 0,
                    1,
                    _2 * lazy(_1)(_2 - 1)
                )
            )
        ) (5);

    BOOST_CHECK(r == 5*4*3*2*1);
} 
```

你能解释一下这一切是如何运作的吗？

是否有一个很好的简单示例，可能使用绑定可能比这个更少的依赖项？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-30T18:13:20.927

这里是将相同的代码转换为`boost::bind`通知 y-combinator 及其在 main 函数中的应用程序站点。我希望这有帮助。

```
#include <boost/function.hpp>
#include <boost/bind.hpp>
#include <iostream>

// Y-combinator compatible factorial
int fact(boost::function<int(int)> f,int v)
{
  if(v == 0)
    return 1;
  else
    return v * f(v -1);
}

// Y-combinator for the int type
boost::function<int(int)>
    y(boost::function<int(boost::function<int(int)>,int)> f)
{
  return boost::bind(f,boost::bind(&y,f),_1);
}

int main(int argc,char** argv)
{
  boost::function<int(int)> factorial = y(fact);
  std::cout << factorial(5) << std::endl;
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-08-15T11:48:53.000

```
#include <functional>
#include <iostream>

template <typename Lamba, typename Type>
auto y (std::function<Type(Lamba, Type)> f) -> std::function<Type(Type)>
{
    return std::bind(f, std::bind(&y<Lamba, Type>, f), std::placeholders::_1);
}

int main(int argc,char** argv)
{
    std::cout << y < std::function<int(int)>, int> ([](std::function<int(int)> f, int x) {
        return x == 0 ? 1 : x * f(x - 1);
    }) (5) << std::endl;
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-30T19:15:31.027

> 你能解释一下这一切是如何运作的吗？

fix2 是一个 y 组合子（具体来说，它是具有两个参数的函数的组合子；第一个参数是函数（用于递归），第二个参数是“适当的”函数参数）。它创建递归函数。

bll::ret(...) 似乎创建了某种形式的函数对象，其主体是

```
if(second arg == 0)
{
    return 1;
}
else
{
    return second arg * first arg(second arg - 1);
} 
```

“惰性”可能是为了阻止第一个（函数）参数的无限扩展（阅读惰性和严格 y 组合器之间的区别以了解原因）。

代码非常可怕。匿名函数很不错，但是解决 C++ 缺乏语法支持的黑客行为使它们不值得付出努力。

# asp.net - ASP.NET 单一登录 - 分发会话是答案

> ID：152093
> 
> 赞同：1
> 
> 时间：2008-09-30T07:34:20.307
> 
> 标签：asp.net, security, session, distributed

我们有 5 个平衡的 Web 服务器，其中包含各种网站。我想要实现的是确保一次登录。即同一用户帐户在任何给定时间都不能多次登录同一网站。

我正在考虑解决此问题的方法是在服务器之间共享会话，以便我可以控制将哪个会话分配给哪个帐户。然后我可以控制我的登录。如果用户登录并且已经为其用户帐户分配了一个会话，我可以使第一个会话到期或拒绝登录。

我不想失去平衡服务器的好处，因此不能选择使用单个 Sql Server 作为我的会话状态服务器，或者使用单个服务器来处理登录。

分布式会话（类似于[Scaleout Software](http://www.scaleoutsoftware.com/)）是实现这一目标的正确方法吗？

还是有另一种机制来处理我完全不知道的单一登录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T07:55:00.880

这里有两组问题：
1）在网络场场景中只允许一个连接的用户
2）检测用户注销

要解决第一个问题，唯一的解决方案是中央存储某种用户状态，使用中央服务器存储ASP.Net 会话或某种其他类型的集中式用户状态。这个中央存储可以是使用会话状态本机管理的 SQL Server（顺便说一句，Oracle 11 中的 Oracle 也可以支持会话存储）、AspState 服务或外部解决方案，如 ScaleOut（如你所说）或其开源替代 memcached （见[https://sourceforge.net/projects/memcacheddotnet/](https://sourceforge.net/projects/memcacheddotnet/)）。或者，您可以设计一个简单的集中式 Web 服务，根据 SQL Server 数据库检查活动登录，这样您还可以快速创建有关登录用户等的报告工具。

在我看来，真正的问题在于第二部分，您需要维护网络世界中可用的不同“错误注销”场景（例如由于崩溃而关闭浏览器或在未注销的情况下关闭应用程序），为您的应用程序提供某种方式来优雅地与启用了旧会话的用户一起工作（正如您所说，只需使第一个会话到期即可）。

还要记住，使用像 SQL 服务器这样的状态服务器不会让你失去平衡的服务器，如果是拥有网络农场环境和共享会话的工作方式，唯一的问题在于性能（如果会话状态变大）和如果您还没有适当的许可证，则使用 SQL Server 所涉及的成本。

# c++ - 记录/监控来自应用程序的所有函数调用

> ID：152097
> 
> 赞同：6
> 
> 时间：2008-09-30T07:36:25.513
> 
> 标签：c++, debugging

我们正在开发的应用程序有问题。应用程序在启动时崩溃的情况很少见，例如千分之一。当崩溃发生时，它会关闭整个系统，计算机开始发出哔哔声并完全冻结，唯一的恢复方法是关闭电源（我们使用的是 Windows XP）。崩溃的罕见性加上我们无法闯入调试器甚至在它发生时生成堆栈转储的事实使得调试变得极其困难。

我正在寻找将所有函数调用记录到文件的东西。这样的工具存在吗？实现起来应该不是不可能的，像 VTune 这样的分析器做的事情非常相似。

我们正在使用 Visual Studio 2008 (C++)。

谢谢

AB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T08:24:27.893

记录功能入口/出口是解决问题的低级方法。我建议使用自动调试器检测（使用带有 regedit 的图像文件执行选项下的调试器键或使用我在下面提供链接的包中的 gflags）并尝试重现问题，直到它崩溃。此外，您可以使用脚本记录可疑模块的调试器函数调用历史记录或收集任何其他信息。
但是不知道您的应用程序的详细信息，很难提出解决方案。它是用户应用程序、服务还是驱动程序？“启动时崩溃”是什么意思 - 在 Windows 启动或应用程序启动时？
使用此[调试器包](http://www.microsoft.com/whdc/devtools/debugging/installx86.Mspx)进行故障排除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T07:48:49.697

对于 Visual C++ [，_penter() 和 _pexit()](http://msdn.microsoft.com/en-us/library/c63a9b7h.aspx)可用于检测您的代码。

另请参见[C++ 中的方法调用拦截](http://www.codeguru.com/cpp/misc/misc/logandtracefiles/article.php/c11065/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T08:03:14.137

日志记录思想的唯一问题是，当系统崩溃时，最新的日志条目可能仍在缓存中，没有机会写入磁盘......

如果是我，我会尝试在另一台 PC 上运行该程序 - 可能是片状硬件或驱动程序导致了问题。应用程序“不应该”能够关闭系统。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T08:21:51.410

一些想法-
很有可能在您崩溃之前，应用程序中存在某种异常。如果您使用 SetUnhandledExceptionFilter() 为所有未处理的异常设置处理程序并将堆栈跟踪写入日志文件，则您可能有机会捕捉到正在运行的崩溃。
请记住在每次写入后刷新文件。

另一种选择是使用诸如[strace](http://www.intellectualheaven.com/default.asp?BH=projects&H=Strace.htm)之类的工具，它将所有系统调用记录到内核中（有多种风格和实现，所以选择你最喜欢的）。如果您在崩溃前查看日志，您可能会找到罪魁祸首

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-30T14:20:59.207

您是否考虑过使用第二台机器作为远程调试器（通过网络）？当应用程序（和系统）崩溃时，第二台机器应该仍然显示一些有用的信息，如果不是问题的实际点的话。我相信 VC++ 至少在某些版本中具有这种能力。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T07:57:30.127

GCC（包括[用于 Windows 开发的版本 MingGW ）有一个名为](http://www.mingw.org/)[-finstrument-functions](http://gcc.gnu.org/onlinedocs/gcc/Code-Gen-Options.html#index-finstrument_002dfunctions-1914)的代码生成开关，它告诉编译器在每个函数调用周围发出对名为 __cyg_profile_func_enter 和 __cyg_profile_func_exit 的函数的特殊调用。对于 Visual C++，有类似的选项称为[/GH](http://msdn.microsoft.com/en-us/library/xc11y76y(VS.71).aspx)和[/Gh](http://msdn.microsoft.com/en-us/library/c63a9b7h(VS.71).aspx)。这些导致编译器围绕函数调用发出对 __penter 和 __pexit 的调用。

这些检测模式可用于实现日志系统，您可以实现编译器生成的调用以输出到本地文件系统或网络上的另一台计算机。

如果可能的话，我也会尝试使用[valgrind](http://valgrind.org/)或类似的检查工具来运行您的系统。这可能会在您的问题失控之前发现它。

# asp.net-2.0 - I want to prevent ASP.NET GridView from reacting to the enter button

> ID：152099
> 
> 赞同：4
> 
> 时间：2008-09-30T07:36:54.187
> 
> 标签：asp.net-2.0

I have an ASP.NET page with a gridview control on it with a CommandButton column with delete and select commands active.

Pressing the enter key causes the first command button in the gridview to fire, which deletes a row. I don't want this to happen. Can I change the gridview control in a way that it does not react anymore to pressing the enter key?

There is a textbox and button on the screen as well. They don't need to be responsive to hitting enter, but you must be able to fill in the textbox. Currently we popup a confirmation dialog to prevent accidental deletes, but we need something better than this.

This is the markup for the gridview, as you can see it's inside an asp.net updatepanel (i forgot to mention that, sorry): (I left out most columns and the formatting)

```
<asp:UpdatePanel ID="upContent" runat="server" UpdateMode="Conditional">
        <Triggers>
            <asp:AsyncPostBackTrigger ControlID="btnFilter" />
            <asp:AsyncPostBackTrigger ControlID="btnEdit" EventName="Click" />
        </Triggers>
        <ContentTemplate>
            <div id="CodeGrid" class="Grid">
                <asp:GridView   ID="dgCode" runat="server">
                    <Columns>
                        <asp:CommandField SelectImageUrl="~/Images/Select.GIF"
                                            ShowSelectButton="True"
                                            ButtonType="Image"
                                            CancelText=""
                                            EditText=""
                                            InsertText=""
                                            NewText=""
                                            UpdateText=""
                                            DeleteImageUrl="~/Images/Delete.GIF"
                                            ShowDeleteButton="True" />
                        <asp:BoundField DataField="Id"  HeaderText="ID" Visible="False" />
                    </Columns>
                </asp:GridView>
            </div>
        </ContentTemplate>
    </asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-24T10:29:34.867

Every once in a while I get goofy issues like this too... but usually I just implement a quick hack, and move on :)

```
myGridView.Attributes.Add("onkeydown", "if(event.keyCode==13)return false;"); 
```

Something like that should work.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T11:17:08.863

This solution is blocking the enter key on the entire page

[Disable Enter Key](http://www.bloggingdeveloper.com/post/Disable-Form-Submit-on-Enter-Key-Press.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-29T19:20:13.453

In the PreRender event you can toggle

```
Private Sub gvSerials_PreRender(ByVal sender As Object, ByVal e As System.EventArgs) Handles gvSerials.PreRender
    If gvSerials.EditIndex < 0 'READ ONLY MODE
        'Enables the form submit during Read mode on my 'search' submit button
        Me.bnSearch.UseSubmitBehavior = True
    Else 'EDIT MODE
        'disables the form submit during edit mode, this allows the APPLY/Update button to be activated after Enter Key is pressed (which really is creating a form submit)
        Me.bnSearch.UseSubmitBehavior = False
    End If 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-23T20:04:01.777

In Page_Load, set the focus on the textbox.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-24T18:43:41.877

Here is a good [jQuery](http://jquery.com/) way of doing it. This function will automagically add the keydown event handler to all TextBoxes on the page. By using different selectors, you can control it to more or less granular levels:

```
//jQuery document ready function – fires when document structure loads
$(document).ready(function() {

   //Find all input controls of type text and bind the given
   //function to them
   $(":text").keydown(function(e) {
      if (e.keyCode == 13) {
          return false;
       }
   });

}); 
```

This will make all textboxes ignore the Enter key and has the advantage of being automatically applied to any new HTML or ASP.Net controls that you might add to the page (or that may be generated by ASP.Net).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-27T13:21:33.773

For anyone else having the same problem where this code is not preventing the event from firing, this worked for me:

```
if (window.event.keyCode == 13) {    
    event.returnValue=false;     
    event.cancel = true;
} 
```

# php - 不依赖框架的 MVC 教程？

> ID：152101
> 
> 赞同：62
> 
> 时间：2008-09-30T07:37:20.080
> 
> 标签：php, model-view-controller, sample, no-framework

我想学习 MVC“架构模式”，但我还不想跳入像 Rails 或 Django 这样的框架。我想先了解一下这个概念，然后在我目前熟悉的环境中写一些简单的代码，这个环境恰好是 PHP/HTML/CSS/MySQL。我不一定需要基于 PHP 的教程，因为我确实了解很多不同的语言。而且我不想安装任何框架、API 或库。我只想学习如何在 MVC 中思考并将其应用到我的项目中。有什么建议么？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-30T07:40:09.513

几乎每个框架都以不同的方式执行 MVC，因此您最终可能会变得更加困惑。MVC 的一般原则非常简单：“模型即状态；视图对模型作出反应；控制器对视图作出反应；控制器改变模型”。模型、视图和控制器是概念——它们是你认为的任何东西。类、类群、带有 XML 配置文件的类的实例，应有尽有。

我实际上认为这涵盖了基本原则。没有框架，你就不会走得更远。重要的是特定框架如何定义模型、视图和控制器及其交互。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-01T04:40:17.703

MVC 基本上只是将您的代码拆分为一个处理数据的模型、一个显示数据的视图和一个将数据从模型传递到视图的控制器。

这不是您需要 API 或框架的任何东西，它只是一种拆分代码的方式。许多框架使用它的原因是因为它是一个非常简单的概念，它适用于许多事情（它非常适合网页），并且相当灵活（例如，使用 Rails，您*可以*在视图中做所有事情，或者模型/控制器，如果你愿意的话..)

Python 中的一个快速示例，一个示例 MVC 结构化 Python 脚本。不一定是“最佳实践”，但它有效，而且相当简单：

```
class Model:
    def get_post(self, id):
        # Would query database, perhaps
        return {"title": "A test", "body": "An example.."}

class Controller:
    def __init__(self):
        self.model = Model()
        self.view = View()

    def main(self):
        post = self.model.get_post(1)
        self.view.display(post)

class View:
    def display(self, item):
        print "<h1>%(title)s</h1>\n%(body)s" % item

c = Controller()
c.main() 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-30T10:38:25.153

除了 Sander 的回复，我想说大多数框架都混淆了*前端控制器*和*MVC*。它们实际上是两个完全独立的概念，但它们通常都存在于框架中。所以要注意这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-01T00:08:02.400

MVC 的主要优点是关注点分离。当您编写代码时，如果您不小心，它可能会变得一团糟。因此，从长远来看，知道如何将模型、视图和控制器放在不同的“孤岛”中可以节省您的时间。任何策略都是好的。

所以这是我的：

*   模型是在项目树的 /lib 下找到的文件
*   视图是项目树中以 .html 结尾的文件
*   控制器是 <form> 动作属性中的 url

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-06T14:30:03.833

知道已经很晚了，但我相信人们稍后会提出同样的问题。

我认为上面非常好的代码示例最好这样写，但是 YMMV：

```
#!/usr/bin/python
class Model:
  def get_post(self):
    return {"title":"A test","body":"An example.."}

class View:
  def display(self,items):
    print 'Title:',items['title'],'\n'+'Body:',items['body']

class Controller:
  def __init__(self):
    self.model=Model()
    self.view=View()

  def main(self):
    post=self.model.get_post()
    self.view.display(post)

mvc=Controller()
mvc.main() 
```

这是另一个使用继承的示例，它在 python/php 中非常有用.....

```
#!/usr/bin/python3
class Control:
  def find(self,user):
    return self._look(user)

  def _look(self,user):
    if user in self.users:
      return self.users[user]
    else:
      return 'The data class ({}) has no {}'.format(self.userName(),user)

  def userName(self):
    return self.__class__.__name__.lower()

class Model(Control):
  users=dict(one='Bob',two='Michael',three='Dave')

class View():
  def user(self,users):
    print(users.find('two'))

def main():
  users=Model()
  find=View()
  print('--> The user two\'s "real name" is:\n')
  find.user(users)

if __name__=="__main__":
  main() 
```

如果这是有道理的，现在就去 django 你准备好了。如果这有意义，请阅读[免费书籍，您将快速阅读它。](http://www.djangobook.com/)您的权利，尽管您必须能够在使用 django 之前了解 OOP 和 MVC 范例，因为它是通过这些范例构建和使用的。

如您所见，它并不复杂，它只是保持代码有序的众多方法之一。

[这解释了 django 中的 MVC](http://www.djangobook.com/en/2.0/chapter03/)

# javascript - 使用 jeditable 和 autogrow 的问题

> ID：152104
> 
> 赞同：2
> 
> 时间：2008-09-30T07:38:10.063
> 
> 标签：javascript, jquery, ajax, jeditable, autogrow

我在一个使用[jQuery](http://jquery.com/)和 CakePHP 的 Web 项目上工作。我使用[jeditable](http://www.appelsiini.net/projects/jeditable)作为就地编辑插件。对于 textareas，我使用[autogrow 插件](http://www.appelsiini.net/2008/4/autogrow-textarea-for-jeditable)对其进行了扩展。

好吧，我有两个问题：

*   首先，自动增长仅适用于 Firefox，不适用于 IE、Safari、Opera 和 Chrome。
*   其次，我需要一个 jeditable 的回调事件，当它完成显示编辑组件时，重新计算[滚动条](http://kelvinluck.com/assets/jquery/jScrollPane/jScrollPane.html)

我对 Javascript 不太熟悉，所以我不能自己扩展/纠正这两个库。有没有人使用另一个 js-library 进行自动增长文本区域的就地编辑（没有像 TinyMCE 这样的完整编辑器，我需要纯文本的解决方案）？

我还找到[了 Growfield](http://plugins.jquery.com/project/Growfield)，它适用于其他浏览器，但没有可编辑的集成......

*（对不起我的英语不好）*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T18:38:19.807

我没有看到在任何浏览器中使用带有 jeditable 的 Autogrow 有任何问题，但这里是带有 jeditable 的 Growfield 的实现。它的工作方式与 jeditable 的 Autogrow 插件的工作方式非常相似。您为 jeditable 创建一个特殊的输入类型，然后将 .growfield() 应用于它。必要的javascript如下，可以[在这里找到](http://alexcpendletonapps.appspot.com/editauto/growfield.html "在这里找到")一个演示。

```
<script type="text/javascript">
/*  This is the growfield integration into jeditable
    You can use almost any field plugin you'd like if you create an input type for it.
    It just needs the "element" function (to create the editable field) and the "plugin"
    function which applies the effect to the field.  This is very close to the code in the
    jquery.jeditable.autogrow.js input type that comes with jeditable.
 */
$.editable.addInputType('growfield', {
    element : function(settings, original) {
        var textarea = $('<textarea>');
        if (settings.rows) {
            textarea.attr('rows', settings.rows);
        } else {
            textarea.height(settings.height);
        }
        if (settings.cols) {
            textarea.attr('cols', settings.cols);
        } else {
            textarea.width(settings.width);
        }
        // will execute when textarea is rendered
        textarea.ready(function() {
            // implement your scroll pane code here
        });
        $(this).append(textarea);
        return(textarea);
    },
    plugin : function(settings, original) {
        // applies the growfield effect to the in-place edit field
        $('textarea', this).growfield(settings.growfield);
    }
});

/* jeditable initialization */
$(function() {
    $('.editable_textarea').editable('postto.html', {
        type: "growfield", // tells jeditable to use your growfield input type from above
        submit: 'OK', // this and below are optional
        tooltip: "Click to edit...",
        onblur: "ignore",
        growfield: { } // use this to pass options to the growfield that gets created
    });
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T08:56:22.667

**knight_killer**：你是什么意思 Autogrow 只适用于 FireFox？我刚刚用 FF3、FF2、Safari、IE7 和 Chrome 进行了测试。与所有这些都很好。我没有 Opera。

**亚历克斯**：您的 Growfield Jeditable 自定义输入是否有下载链接？我想从我的博客链接它。真的很棒！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-03T13:46:54.977

**Mika Tuupola**：如果你对我修改过的 jeditable（添加了两个回调事件）感兴趣，可以[在这里获取](http://knightkiller.ch/jquery.jeditable.js)。如果您能在您的 jeditable 官方版本中提供这些事件，那就太好了！

这是我的（简化的）集成代码。我使用这些事件不仅仅是为了悬停效果。这只是一个用例。

```
$('.edit_memo').editable('/cakephp/efforts/updateValue', {
  id            : 'data[Effort][id]',
  name          : 'data[Effort][value]',
  type          : 'growfield',
  cancel        : 'Abort',
  submit        : 'Save',
  tooltip       : 'click to edit',
  indicator     : "<span class='save'>saving...</span>",
  onblur        : 'ignore',
  placeholder   : '<span class="hint">&lt;click to edit&gt;</span>',
  loadurl       : '/cakephp/efforts/getValue',
  loadtype      : 'POST',
  loadtext      : 'loading...',
  width         : 447,
  onreadytoedit : function(value){
    $(this).removeClass('edit_memo_hover'); //remove css hover effect
  },
  onfinishededit : function(value){
    $(this).addClass('edit_memo_hover'); //add css hover effect
  }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T10:33:55.827

**谢谢亚历克斯！**您的 growfield-Plugin 有效。与此同时，我设法解决了另一个问题。我拿了另一个[Scroll-Library](http://flesler.blogspot.com/2007/10/jqueryscrollto.html)并将一个回调事件侵入到 jeditable-plugin 中。并没有我想的那么难……

# php - PHP 在 24 小时内的高斯分布

> ID：152115
> 
> 赞同：3
> 
> 时间：2008-09-30T07:41:15.080
> 
> 标签：php, math, gaussian

如何在高斯分布分布的 24 小时周期内设置点？例如在 10 点有高峰？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-30T13:27:11.003

以下代码生成以给定时间为中心并具有给定标准偏差的高斯分布随机时间（以小时为单位，加上一小时的几分之一）。随机时间可能会“环绕”时钟，特别是如果标准偏差是几个小时：这是正确处理的。如果您的标准偏差非常大（很多天），则不同的“包装”算法可能会更有效，但无论如何，在这种情况下分布几乎是均匀的。

```
$peak=10; // Peak at 10-o-clock
$stdev=2; // Standard deviation of two hours
$hoursOnClock=24; // 24-hour clock

do // Generate gaussian variable using Box-Muller
{
    $u=2.0*mt_rand()/mt_getrandmax()-1.0;
    $v=2.0*mt_rand()/mt_getrandmax()-1.0;
    $s = $u*$u+$v*$v;
} while ($s > 1);
$gauss=$u*sqrt(-2.0*log($s)/$s);

$gauss = $gauss*$stdev + $peak; // Transform to correct peak and standard deviation

while ($gauss < 0) $gauss+=$hoursOnClock; // Wrap around hours to keep the random time 
$result = fmod($gauss,$hoursOnClock);     // on the clock

echo $result; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T08:26:03.053

如果您在生成高斯分布随机点时遇到问题，请查看[http://en.wikipedia.org/wiki/Box-Muller_transform](http://en.wikipedia.org/wiki/Box-Muller_transform)

否则请澄清你的问题。

# c# - 有没有使用 DDD（领域驱动设计）的开源项目？

> ID：152120
> 
> 赞同：28
> 
> 时间：2008-09-30T07:42:12.723
> 
> 标签：c#, architecture, open-source, domain-driven-design

我试图理解 DDD 背后的概念，但我发现仅通过阅读书籍很难理解，因为它们倾向于以相当抽象的方式讨论该主题。我想在代码中看到一些好的 DDD 实现，最好是在 C# 中。

有没有在开源世界中实践 DDD 的项目的好例子？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-16T17:53:54.007

Eric Evans 和一家瑞典咨询公司发布了一个示例应用程序，该示例应用程序基于 Eric 在本书中使用的运输示例。它在 Java 中，但概念在项目页面上有很好的记录。

[http://dddsample.sourceforge.net/](http://dddsample.sourceforge.net/)

但是，请注意，DDD 更多的是关于旅程而不是目的地。了解您正在查看的示例代码在成为您现在所看到的之前采用了多种形式。您没有看到最初使用的笨拙模型，并且您错过了根据沿途获得的洞察力重构模型所采取的步骤。虽然构建块在 DDD 中很重要，但 Eric 认为它们被过分强调了，所以对所有样本持保留态度。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-05T19:55:18.017

我不确定它有多完整，但我在 Google Code 上找到了[NDDD 示例。](http://code.google.com/p/ndddsample/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-09-15T07:54:59.900

我很惊讶没有人提到[Macto](https://github.com/ayende/Macto)，Ayende 的 DDD 示例。Macto 最重要的一点是，在实际编码之前的漏洞思考过程在[一系列帖子](http://ayende.com/blog/tags/macto)中呈现。DDD 不是关于实现模型，而是关于对业务域进行建模。诸如“某个概念是聚合根/实体/值对象”之类的决定远比 AR 的持久性重要得多。

另外，我会推荐 Udi Dahan 的有关 SOA 和 CQRS 的视频，这可能会为应用 DDD 提供更好的背景。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-30T10:20:15.150

这不是一个开源项目，但它仍然是代码中的一个示例：http: [//www.codeplex.com/dddpds](http://www.codeplex.com/dddpds)

该示例在*.NET Domain-Driven Design with C#: Problem-Design-Solution一书中使用*

* * *

一个看起来很有希望但可能已经死亡的虚构示例：http: [//www.codeplex.com/domaindrivendesign](http://www.codeplex.com/domaindrivendesign)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-07T18:15:11.063

恐怕[http://www.codeplex.com/domaindrivendesign](http://www.codeplex.com/domaindrivendesign)确实已经死了，但如果有人有兴趣贡献，请随时与我联系。

总的来说，我建议不要过度依赖 DDD 的示例，最好的示例可以显示域建模的结果和/或实现模式的一种方法。[因此，我建议阅读这本书，然后在论坛上](http://tech.groups.yahoo.com/group/domaindrivendesign)提问。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-06-30T18:04:31.703

[http://kigg.codeplex.com/](http://kigg.codeplex.com/)对我来说是一个很好的例子。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-30T08:10:31.623

一个很好的阅读是 Jimmi Nilssons 的书（和博客） [应用领域驱动设计](https://rads.stackoverflow.com/amzn/click/com/0321268202)

它是 Evans 和 Fowlers 书籍（[领域驱动设计](https://rads.stackoverflow.com/amzn/click/com/0321125215) - Evans）和（[企业应用程序架构模式](https://rads.stackoverflow.com/amzn/click/com/0321127420)- Fowler）的混合体

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-12T00:43:42.937

我知道它不是 C#，但这是一个遵循域驱动方法的 java 元框架：我对此了解不多，但我愿意在不久的将来研究它：[Roma Framework](http://www.romaframework.org/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-13T09:18:30.690

[http://sellandbuy.codeplex.com/](http://sellandbuy.codeplex.com/)

另一个项目 DDD

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-30T07:54:32.507

我自己没有使用过任何工具，但是 DDD Wikipedia 页面上提到了一些工具。不过，它们中的大多数似乎都是用 Java 实现的。

[http://en.wikipedia.org/wiki/Domain-driven_design#Software_tools_to_support_domain-driven_design](http://en.wikipedia.org/wiki/Domain-driven_design#Software_tools_to_support_domain-driven_design)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-06T21:22:18.083

好的，我找到了这个，但它是 Java 而不是 C#：
[http ://timeandmoney.domainlanguage.com/](http://timeandmoney.domainlanguage.com/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-11-06T03:30:28.200

[Code Camp Server](http://code.google.com/p/codecampserver/)，[Jeffrey Palermo 的](http://jeffreypalermo.com/)[ASP.NET MVC in Action](https://rads.stackoverflow.com/amzn/click/com/1933988622)一书的示例代码是开源的并使用 DDD。

（与我在[Good Domain Driven Design samples](https://stackoverflow.com/questions/540130/)中的回答相同）

# c++ - C++ 中的动画

> ID：152123
> 
> 赞同：2
> 
> 时间：2008-09-30T07:45:33.930
> 
> 标签：c++, animation

在 C++ 中绘制动画的方法有哪些？GDI+？OpenGL？您会特别推荐一种类模式来完成绘图和重绘吗？

您是否知道任何制作动画的开源项目，以便我可以查看代码？

如果你想编写几何动画，你会从哪里开始？你知道有什么好的图书馆吗？发布指向教程和任何其他有趣信息的链接...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T08:11:46.893

QT QGraphicsScene

它专门设计用于轻松轻松地编写 2D 游戏，并提供对动画的强大支持。
QT 是一个非常成熟的跨平台工具包，也有开源的味道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T21:59:46.640

我是 openframeworks (openframeworks.cc / openframeworks.cc/download) 的开发人员，而且，我在纽约教授一门关于 c++ 动画的课程，现在有一些代码示例（未来几个月还会有更多示例）：

[http://makingthingsmove.org/blog](http://makingthingsmove.org/blog)

OF 这里也有一些示例代码：

[http://wiki.openframeworks.cc/index.php?title=OfAmsterdam](http://wiki.openframeworks.cc/index.php?title=OfAmsterdam)

以及这里的一些处理动画代码：

[http://thesystemis.com/makingthingsmove](http://thesystemis.com/makingthingsmove)

这可能是一个有用的起点。

玩得开心 ！扎克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T07:58:11.233

你的问题有点太开放了。有大量的图形库，其中很多都支持动画。
你甚至没有给出你的问题的范围。既然你提到了 GDI+，我想你想要它用于 Windows，但是有很好的便携解决方案，比如 SDL、Allegro、Cairo 等。
很多游戏框架也可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T10:12:56.823

有很好的不同库列表：

[http://www.twilightsembrace.com/personal/gamelibs.php](http://www.twilightsembrace.com/personal/gamelibs.php) [http://www.thefreecountry.com/sourcecode/graphics.shtml](http://www.thefreecountry.com/sourcecode/graphics.shtml)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T12:18:49.500

正如其他人所说，这是一个非常广泛的问题。我会建议去查看一些计算机图形和游戏开发书籍。他们通常在该区域提供“易于理解”的材料。如果你想看代码，有几个开源游戏引擎，比如 Ogre3d、Nebuladevice 和 Irrlicht。但是至少我不建议在不知道您在寻找什么的情况下偷看该代码。图形引擎通常是庞大而复杂的代码库。

尝试在google中寻找游戏开发教程，你会发现很多非常简单的例子。它们通常不反映完全成熟的引擎中使用的完全相同的技术，但首先理解这些技术将使后面的理解成为可能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T07:46:48.950

我知道这一点：[http ://www.openframeworks.cc/](http://www.openframeworks.cc/)

这个： http: [//www.contextfreeart.org/](http://www.contextfreeart.org/)

# java - 使用 Lucene 统计分类结果

> ID：152127
> 
> 赞同：18
> 
> 时间：2008-09-30T07:46:46.563
> 
> 标签：java, search, lucene, filtering, catalog

我正在尝试使用 Lucene Java 2.3.2 来实现对产品目录的搜索。除了产品的常规字段外，还有一个名为“类别”的字段。一个产品可以属于多个类别。目前，我使用 FilteredQuery 为每个类别搜索相同的搜索词，以获取每个类别的结果数。

这会导致每个查询进行 20-30 次内部搜索调用以显示结果。这大大减慢了搜索速度。有没有更快的方法使用 Lucene 实现相同的结果？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-27T08:30:42.867

这就是我所做的，虽然它对记忆有点沉重：

你需要的是预先创建一堆[`BitSet`](http://java.sun.com/javase/6/docs/api/java/util/BitSet.html)s，每个类别一个，包含一个类别中所有文档的doc id。现在，在搜索时，您使用[HitCollector](http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc//org/apache/lucene/search/HitCollector.html)并根据 BitSet 检查文档 ID。

这是创建位集的代码：

```
public BitSet[] getBitSets(IndexSearcher indexSearcher, 
                           Category[] categories) {
    BitSet[] bitSets = new BitSet[categories.length];
    for(int i=0; i<categories.length; i++)
    {
        Query query = categories[i].getQuery();
        final BitSet bitset = new BitSet()
        indexSearcher.search(query, new HitCollector() {
            public void collect(int doc, float score) {
                bitSet.set(doc);
            }
        });
        bitSets[i] = bitSet;
    }
    return bitSets;
} 
```

这只是执行此操作的一种方法。如果您的类别足够简单，您可能可以使用[TermDocs](http://hudson.zones.apache.org/hudson/job/Lucene-trunk/javadoc/org/apache/lucene/index/TermDocs.html)而不是运行完整搜索，但这应该只在您加载索引时运行一次。

现在，当需要计算搜索结果的类别时，您可以这样做：

```
public int[] getCategroryCount(IndexSearcher indexSearcher, 
                               Query query, 
                               final BitSet[] bitSets) {
    final int[] count = new int[bitSets.length];
    indexSearcher.search(query, new HitCollector() {
        public void collect(int doc, float score) {
            for(int i=0; i<bitSets.length; i++) {
                if(bitSets[i].get(doc)) count[i]++;
            }
        }
    });
    return count;
} 
```

您最终得到的是一个数组，其中包含搜索结果中每个类别的计数。如果您还需要搜索结果，则应将 TopDocCollector 添加到您的命中收集器（yo dawg ...）。或者，您可以再次运行搜索。2 次搜索优于 30 次。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-01T18:11:52.327

我没有足够的声誉来评论（！），但在马特奎尔的回答中，我很确定你可以替换这个：

```
int numDocs = 0;
td.seek(terms);
while (td.next()) {
    numDocs++;
} 
```

有了这个：

```
int numDocs = terms.docFreq() 
```

然后完全摆脱 td 变量。这应该使它更快。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T12:09:27.137

您可能需要考虑使用[TermDocs 迭代器](http://lucene.apache.org/java/2_3_2/api/core/org/apache/lucene/index/TermDocs.html)查看与类别匹配的所有文档。

此示例代码遍历每个“类别”术语，然后计算与该术语匹配的文档数。

```
public static void countDocumentsInCategories(IndexReader reader) throws IOException {
    TermEnum terms = null;
    TermDocs td = null;

    try {
        terms = reader.terms(new Term("Category", ""));
        td = reader.termDocs();
        do {
            Term currentTerm = terms.term();

            if (!currentTerm.field().equals("Category")) {
                break;
            }

            int numDocs = 0;
            td.seek(terms);
            while (td.next()) {
                numDocs++;
            }

            System.out.println(currentTerm.field() + " : " + currentTerm.text() + " --> " + numDocs);
        } while (terms.next());
    } finally {
        if (td != null) td.close();
        if (terms != null) terms.close();
    }
} 
```

即使对于大型索引，此代码也应该运行得相当快。

下面是一些测试该方法的代码：

```
public static void main(String[] args) throws Exception {
    RAMDirectory store = new RAMDirectory();

    IndexWriter w = new IndexWriter(store, new StandardAnalyzer());
    addDocument(w, 1, "Apple", "fruit", "computer");
    addDocument(w, 2, "Orange", "fruit", "colour");
    addDocument(w, 3, "Dell", "computer");
    addDocument(w, 4, "Cumquat", "fruit");
    w.close();

    IndexReader r = IndexReader.open(store);
    countDocumentsInCategories(r);
    r.close();
}

private static void addDocument(IndexWriter w, int id, String name, String... categories) throws IOException {
    Document d = new Document();
    d.add(new Field("ID", String.valueOf(id), Field.Store.YES, Field.Index.UN_TOKENIZED));
    d.add(new Field("Name", name, Field.Store.NO, Field.Index.UN_TOKENIZED));

    for (String category : categories) {
        d.add(new Field("Category", category, Field.Store.NO, Field.Index.UN_TOKENIZED));
    }

    w.addDocument(d);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-12T10:12:01.547

Sachin，我相信你想要[多面搜索](http://en.wikipedia.org/wiki/Faceted_browser)。它不是开箱即用的 Lucene。我建议您尝试使用[SOLR](http://lucene.apache.org/solr/)，它具有[刻面](http://www.lucidimagination.com/Community/Hear-from-the-Experts/Articles/Faceted-Search-Solr)作为主要且方便的功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-24T19:32:50.653

所以让我看看我是否正确理解了这个问题：给定用户的查询，您想显示每个类别中的查询有多少匹配项。正确的？

可以这样想：您的查询实际上是`originalQuery AND (category1 OR category2 or ...)`除了您想要为每个类别获得一个数字的总体得分。不幸的是，在 Lucene 中收集命中的界面非常狭窄，只能为您提供查询的总分。但是您可以实现自定义记分器/收集器。

查看 org.apache.lucene.search.DisjunctionSumScorer 的源代码。您可以复制其中的一些内容来编写一个自定义记分器，该记分器在您的主要搜索进行时迭代类别匹配。您可以保留 a`Map<String,Long>`以跟踪每个类别中的匹配项。

# apache-flex - Flex 3 中的 GIF 动画

> ID：152129
> 
> 赞同：3
> 
> 时间：2008-09-30T07:46:50.510
> 
> 标签：apache-flex, flex3, gif, animated-gif

信不信由你，我需要一种在 Flex 3 中显示动画 gif 的方法。这家伙有一个组件出售，但它只是 Flex 2：http: [//dougmccune.com/blog/2007/01/19/how-to-load -animated-gifs-using-adobe-flex-20/](http://dougmccune.com/blog/2007/01/19/how-to-load-animated-gifs-using-adobe-flex-20/)。

我已经实现了这个例子：[http](http://www.bytearray.org/?p=95) ://www.bytearray.org/?p= 95，但是对于较大的 gif，它非常占用 CPU 并导致 UI 挂起。

有谁知道任何替代解决方案？如果做不到这一点，我可能不得不考虑重构第二个示例以使用伪线程。呃。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T21:22:37.437

我购买并使用了 mccune 产品，但现在已更改为 flex 3。我通过搜索与您相同的答案找到了您的问题，并且刚刚遇到了这个问题

[http://flexology.wordpress.com/2008/09/30/loadinganimated_gif_in_flex/](http://flexology.wordpress.com/2008/09/30/loadinganimated_gif_in_flex/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T09:15:31.373

感谢您的回复。该链接 ( [http://code.google.com/p/as3gif/](http://code.google.com/p/as3gif/) ) 中的谷歌代码项目与我实施的 bytearray ( [http://www.bytearray.org/?p=95](http://www.bytearray.org/?p=95) )上的项目相同.

我使用这段代码敲了一个快速的伪线程示例，它太慢了。

看起来我需要即时对 GIF 进行 SWF...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T08:21:40.600

[这](http://code.google.com/p/as3gif/)有帮助吗？

编辑：我不知道该建议在更大的 GIF 上效果如何，但如果您仍然遇到问题，可能值得将 GIF 导入 Flash 并将其转换为自己的 SWF。

Flex 应该能够毫无问题地发挥它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T13:05:46.267

查看 swfmill 以了解如何创建 swf。我相信他们支持动画 gif

[http://swfmill.org/](http://swfmill.org/)

# asp.net-mvc - ASP.NET MVC 预览版 5 中的 ActionUrl

> ID：152137
> 
> 赞同：6
> 
> 时间：2008-09-30T07:50:16.603
> 
> 标签：asp.net-mvc, model-view-controller

我不需要链接，而只需要 ActionLink 的 href= 部分。

但是，如果我调用 Html.ActionLink(...) 我会得到回报。有没有办法只返回动作的 URL 而没有得到？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-30T12:50:01.763

MVC 还提供了一个 UrlHelper 类，它可以做同样的事情：

```
<%=Url.Action(actionName)%>
<%=Url.Action(actionName, htmlValues)%>
<%=Url.Action(actionName, controllerName, htmlValues)%> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T08:02:17.807

编辑：响应评论，现在包括参数：

```
<% =Html.BuildUrlFromExpression<YourController>(c => c.YourAction(parameter)) %> 
```

# java - Java 1.4 同步：只允许一个方法实例运行（非阻塞）？

> ID：152138
> 
> 赞同：3
> 
> 时间：2008-09-30T07:50:24.247
> 
> 标签：java, concurrency, synchronization

我有一堂课建议翻译实用程序。翻译本身应每 30 分钟重新加载一次。我为此使用 Spring Timer 支持。基本上，我的课看起来像：

```
public interface Translator {
    public void loadTranslations();
    public String getTranslation(String key);
} 
```

loadTranslations() 运行时间可能很长，因此在运行时旧的翻译仍然可用。这是通过在本地地图中加载翻译并在加载所有翻译时更改参考来完成的。

我的问题是：我如何确保当一个线程已经加载翻译时，第二个线程也尝试运行，它检测到并立即返回，而不开始第二次更新。

同步方法只会将负载排队...我仍在使用 Java 1.4，所以没有 java.util.concurrent。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T11:06:16.383

使用某种形式的锁定机制仅在任务尚未进行时才执行该任务。获取锁定令牌必须是一个一步的过程。看：

```
/**
 * @author McDowell
 */
public abstract class NonconcurrentTask implements Runnable {

    private boolean token = true;

    private synchronized boolean acquire() {
        boolean ret = token;
        token = false;
        return ret;
    }

    private synchronized void release() {
        token = true;
    }

    public final void run() {
        if (acquire()) {
            try {
                doTask();
            } finally {
                release();
            }
        }
    }

    protected abstract void doTask();

} 
```

如果任务同时运行将引发异常的测试代码：

```
public class Test {

    public static void main(String[] args) {
        final NonconcurrentTask shared = new NonconcurrentTask() {
            private boolean working = false;

            protected void doTask() {
                System.out.println("Working: "
                        + Thread.currentThread().getName());
                if (working) {
                    throw new IllegalStateException();
                }
                working = true;
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    throw new RuntimeException(e);
                }
                if (!working) {
                    throw new IllegalStateException();
                }
                working = false;
            }
        };

        Runnable taskWrapper = new Runnable() {
            public void run() {
                while (true) {
                    try {
                        Thread.sleep(100);
                    } catch (InterruptedException e) {
                        throw new RuntimeException(e);
                    }
                    shared.run();
                }
            }
        };
        for (int i = 0; i < 100; i++) {
            new Thread(taskWrapper).start();
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T07:57:16.633

我来自 .net 背景（根本没有 Java 经验），但是您可以尝试使用某种简单的静态标志，在方法开始时检查它是否已经运行。然后，您需要做的就是确保对该标志的任何读/写都是同步的。因此，在开始时检查标志，如果未设置，则设置它，如果已设置，则返回。如果未设置，则运行该方法的其余部分，并在完成后取消设置。只需确保将代码放在 try/finally 中，并将标志 iunsetting 放在 finally 中，这样在出现错误时它总是会被取消设置。非常简化，但可能就是您所需要的。

编辑：这实际上可能比同步方法更好。因为您真的需要在翻译完成之前*立即进行新的翻译吗？*如果必须等待一段时间，您可能不想将线程锁定太久。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T07:55:50.287

在加载线程上保留一个句柄以查看它是否正在运行？

或者您不能只使用同步标志来指示加载是否正在进行？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T08:17:29.673

这实际上与以经典方式完成时管理单例构造（喘气！）所需的代码相同：

```
if (instance == null) {
  synchronized {
    if (instance == null) {
       instance = new SomeClass();
    }
  }
} 
```

内测与外测相同。外层测试是为了让我们不要例行进入同步块，内层测试是确认自从我们上次进行测试后情况没有改变（线程可能在进入同步块之前就被抢占了）。

在你的情况下：

```
if (translationsNeedLoading()) {
  synchronized {
    if (translationsNeedLoading()) {
       loadTranslations();
    }
  }
} 
```

更新：这种构造单例的方式在您的 JDK1.4 下无法可靠地工作。有关说明[，请参见此处](http://www.cs.umd.edu/~pugh/java/memoryModel/DoubleCheckedLocking.html)。但是，我认为您在这种情况下会没事的。

# c++ - 在 MS Windows 上的 Netbeans 6.1 C++ 中设置 wxWidget？

> ID：152140
> 
> 赞同：0
> 
> 时间：2008-09-30T07:53:42.227
> 
> 标签：c++, configuration, netbeans, wxwidgets

我使用 C++ 插件和 cygwin（gcc 编译器）运行 Netbeans 6.1 我如何设置 wxWidget 以使用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T12:23:52.093

[http://www.daltonfilho.com/2008/02/23/wxwidgets-on-windows-using-netbeans-60-with-mingw-msys/](http://www.daltonfilho.com/2008/02/23/wxwidgets-on-windows-using-netbeans-60-with-mingw-msys/)接缝工作。

# java - 在大型 Java 项目中使用 noweb

> ID：152160
> 
> 赞同：5
> 
> 时间：2008-09-30T07:59:27.063
> 
> 标签：java, literate-programming, noweb

有没有人在大型 Java 项目中使用过[noweb](http://www.cs.tufts.edu/~nr/noweb/) literate 编程工具，其中必须在不同的子目录中生成多个源代码文件？你是如何用 noweb 管理这个的？是否有任何资源和/或最佳实践？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-21T23:10:58.883

Noweb 将转储相对于当前工作目录或您指定的绝对路径的文件。只是不要在文件名的末尾使用 * （以避免插入 # 预处理器指令）。我建议使用 %def 和 @ 来显示您定义和使用名称的位置。

```
<</path/to/file.java>>=
  reallyImportantVariable += 1;
@ %def reallyImportantVariable 
```

noweb 让您重新排序和（真正的胜利）重用代码片段，我认为 javac 不会理解。

我同意，因为大多数人都希望您会使用 javadoc，所以您可能正在逆流而上使用 noweb。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-11T18:04:02.380

Literate Programming works its best if the generated intermediate code can point back to the original source file to allow debugging, and analyzing compiler errors. This usually means pre processor support, which Java doesn't support.

Additionally Literate Programming is really not necessary for Java, as the original need for a strict sequential order - which was what prompted Knuth to write a tool to put snippets together in the appropriate sequence - is not present. The final benefit of literate programming, namely being able to write prose about the code, is also available as Javadoc which allow you to put everything in as comments.

To me, there is no benefit in literate programming for Java, and only troubles (just imagine getting IDE support).

Any particular reason you are considering it?

# .net - 为跨平台 WCF 服务选择什么身份验证？

> ID：152187
> 
> 赞同：1
> 
> 时间：2008-09-30T08:12:06.363
> 
> 标签：.net, wcf, rest, cross-platform, xml-rpc

您会为以下服务建议哪种类型的身份验证：

*   实现为 WCF 并通过各种端点（包括 XML-RPC）公开
*   必须被各种跨平台客户端轻松消费

为什么？

我知道的选项是：

*   IIS 托管 WCF 的基于表单的身份验证（易于实现，但具有可怕的跨平台支持，而且它不是 REST）
*   每次通话都发送纯文本用户名/密码（易于在任何平台上使用，但完全不安全）
*   使用基于票证的身份验证，当用户名和密码用于创建一个票证时，该票证在一段时间内有效并随每个请求传递（任何客户端都可以轻松使用，但 API 模型绑定到这种类型的安全性）

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-06T23:02:01.267

由于您提到 REST，我假设通过 HTTP，您可以查看 HTTP Digest Authentication。

但是，请记住 XML-RPC*不是*RESTful。如果您要走 WS/RPC 的道路，您可能想看看 WS-Security。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T04:02:07.280

最后，我选择了最简单的方法：Web 服务被实现为简单的无状态 SOAP 服务，其中用户名和密码随每个请求一起传递。

[产品页面](http://www.lokad.com/programmers-guide-timeseries-api-v2.ashx)

# .net - 我可以为 ClickOnce 应用程序创建桌面图标吗？

> ID：152188
> 
> 赞同：26
> 
> 时间：2008-09-30T08:12:25.957
> 
> 标签：.net, clickonce, smartclient

我在一些 ClickOnce 帖子中读到 ClickOnce 不允许您为应用程序创建桌面图标。有没有办法解决？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-30T08:18:16.300

似乎有一种方法可以在 ClickOnce 的桌面上放置一个图标。

1.  升级到 Visual Studio 2008 SP 1，在项目属性窗口的发布部分的选项页面中，将有一个放置在桌面上的图标复选框。
2.  第二个选项是向应用程序添加代码，在应用程序第一次运行时将快捷方式复制到桌面。请参阅博客文章*[如何将桌面快捷方式添加到 ClickOnce 部署应用程序](http://geekswithblogs.net/murraybgordon/archive/2006/10/04/93203.aspx)*。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-30T08:19:36.813

在 Visual Studio 2005 中，[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)无法创建桌面图标，但现在可以在 Visual Studio 2008 SP1 中使用。在 Visual Studio 2005 中，您可以使用以下代码在应用程序启动时为您创建一个桌面图标。

几个月来，我已经在几个项目中使用了这段代码，没有任何问题。我必须说，我所有的应用程序都部署在受控环境中的 Intranet 上。此外，卸载应用程序时不会删除该图标。此代码创建 ClickOnce 创建的开始菜单上的快捷方式的快捷方式。

```
private void CreateDesktopIcon()
{
    ApplicationDeployment ad = ApplicationDeployment.CurrentDeployment;

        if (ad.IsFirstRun)
        {
            Assembly assembly = Assembly.GetEntryAssembly();
            string company = string.Empty;
            string description = string.Empty;

            if (Attribute.IsDefined(assembly, typeof(AssemblyCompanyAttribute)))
            {
                AssemblyCompanyAttribute ascompany =
                  (AssemblyCompanyAttribute)Attribute.GetCustomAttribute(
                    assembly, typeof(AssemblyCompanyAttribute));

                company = ascompany.Company;
            }
            if (Attribute.IsDefined(assembly, typeof(AssemblyDescriptionAttribute)))
            {
                AssemblyDescriptionAttribute asdescription =
                  (AssemblyDescriptionAttribute)Attribute.GetCustomAttribute(
                    assembly, typeof(AssemblyDescriptionAttribute));

                description = asdescription.Description;
            }
            if (!string.IsNullOrEmpty(company))
            {
                string desktopPath = string.Empty;
                desktopPath = string.Concat(
                                Environment.GetFolderPath(Environment.SpecialFolder.Desktop),
                                "\\",
                                description,
                                ".appref-ms");

                string shortcutName = string.Empty;
                shortcutName = string.Concat(
                                 Environment.GetFolderPath(Environment.SpecialFolder.Programs),
                                 "\\",
                                 company,
                                 "\\",
                                 description,
                                 ".appref-ms");

                System.IO.File.Copy(shortcutName, desktopPath, true);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-11T11:06:53.437

在 Visual Studio 2017 和 2019 中，您可以执行以下操作：

转到项目属性 -> 发布 -> 清单并选择选项**创建桌面快捷方式**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T08:15:00.117

桌面图标可以是`.application`文件的快捷方式。将其安装为您的应用程序首先要做的事情之一。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-26T11:43:20.827

如果您想使用 powershell，您可以创建 .bat 文件的快捷方式：

```
@ECHO OFF
PowerShell -ExecutionPolicy Unrestricted .\script.ps1 >> "%TEMP%\StartupLog.txt" 2>&1
EXIT /B %errorlevel% 
```

静默运行 script.ps1：

```
$app = "http://your.site/YourApp/YourApp.application";
[Diagnostics.Process]::Start("rundll32.exe", "dfshim.dll,ShOpenVerbApplication " + $app); 
```

打开您的 ClickOnce 应用程序。

# java - Java：字符串缓冲区和连接

> ID：152190
> 
> 赞同：8
> 
> 时间：2008-09-30T08:13:06.393
> 
> 标签：java, concatenation, stringbuffer

我在 Java 中使用 StringBuffer 将字符串连接在一起，如下所示：

```
StringBuffer str = new StringBuffer();

str.append("string value"); 
```

我想知道是否有一种方法（虽然我没有从快速浏览文档中找到任何东西）或其他添加“填充”的方法。

让我解释; 每次我在字符串中附加一些东西时，我都想在最后添加一个空格，如下所示：

```
String foo = "string value";
str.append(foo + " "); 
```

而且我有几个电话要追加..每次，我都想添加一个空格。有没有办法设置对象，以便在每次追加后自动添加一个空格？

编辑 -

```
String input
StringBuffer query = new StringBuffer();
Scanner scanner = new Scanner(System.in);
scanner.UseDelimiter("\n");

do {
   System.out.println("sql> ");

   input = scanner.next();

   if (!empty(input)) query.append(input);

   if (query.toString().trim().endsWith(";")) {
         //run query
   }
}
while (!input.equalsIgnoreCase("exit"); 
```

我将按照 grom 的建议使用 StringBuilder，但这就是代码现在的样子

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-30T11:43:40.347

我认为使用辅助方法（未经测试的代码）可以更轻松地处理此问题：

```
public String myMethod() {
    StringBuilder sb = new StringBuilder();
    addToBuffer(sb, "Hello").addToBuffer("there,");
    addToBuffer(sb, "it").addToBuffer(sb, "works");
}

private StringBuilder addToBuffer(StringBuilder sb, String what) {
    return sb.append(what).append(' ');  // char is even faster here! ;)
} 
```

甚至使用具有流畅界面的 Builder 模式（也是未经测试的代码）：

```
public String myMethod() {
    SBBuilder builder = new SBBuilder()
        .add("Hello").add("there")
        .add("it", "works", "just", "fine!");

    for (int i = 0; i < 10; i++) {
        builder.add("adding").add(String.valueOf(i));
    }

    System.out.println(builder.build());
}

public static class SBBuilder {
    private StringBuilder sb = new StringBuilder();

    public SBBuilder add(String... parts) {
        for (String p : parts) {
            sb.append(p).append(' '); // char is even faster here! ;)
        }
        return this;
    }

    public String build() {
        return sb.toString();
    }
} 
```

这是[一篇](http://java.dzone.com/news/factories-builders-and-fluent-)关于这个主题的文章。

希望能帮助到你！:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T08:34:08.433

您应该使用[StringBuilder](http://java.sun.com/javase/6/docs/api/java/lang/StringBuilder.html)。

> 在可能的情况下，建议优先使用此类而不是 StringBuffer，因为它在大多数实现下会更快。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-30T08:22:33.203

StringBuffer 是最终的。你不能从中得到。最好的解决方案实际上是为自己添加填充。为它编写一个方法并使用 PADDING-Constant 以便您可以轻松更改它，或者更好地将其放入参数中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-30T08:20:43.253

你不能创建一个新的类来包装`StringBuffer`并添加一个`appendWithTrailingSpace()`方法吗？

```
CustomStringBuffer str = new CustomStringBuffer();
str.appendWithTrailingSpace("string value"); 
```

（尽管您可能希望将您的方法称为更短的名称。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-30T08:15:45.667

只需自己添加空间，根据您自己的示例，这很容易。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T08:44:42.040

另一种可能性是 StringBuilder 对象在您调用 append 时返回自己，这意味着您可以这样做：

```
str.append("string value").append(" "); 
```

不是那么光滑，但它可能是比 + " " 方法更简单的解决方案。

另一种可能性是构建一个包装类，如 PaddedStringBuilder，它提供相同的方法但应用你想要的填充，因为你不能继承。

# architecture - 面向复合的编程 (COP)、.NET 4.0、MEF 和 Oslo 存储库

> ID：152196
> 
> 赞同：7
> 
> 时间：2008-09-30T08:16:02.937
> 
> 标签：architecture, mef, oslo, cop

过去一年，.NET 社区 (ala [Qi4j](http://www.qi4j.org/) ) 似乎对 COP 产生了一些兴趣。一些人已经推出了自己的 COP 框架（*请参阅下面的链接*），看起来 .NET 4.0 的 Dynamic Dispatch 和 MEF 可能在任何 .NET COP 框架中都有潜在的作用。

一方面，其中很多似乎可以追溯到 System/38 天的想法（*是的，我是个老家伙*），但另一方面，它似乎也很适合奥斯陆（*建模和存储库*）。谁能评论微软是否在 COP 上做任何工作？

最近的一些 .NET COP 框架工作：

亨德利·卢克 -[滚动你自己的 COP](http://hendryluk.wordpress.com/2008/05/28/roll_your_own_cop_part_i_mixins/)

Yves GoEleven.com -[警察 - 概念证明](http://www.goeleven.com/blog/entryDetail.aspx?entry=147)

安德斯·诺罗斯 -[把戏还是特质？使用 C# 进行面向复合的编程](http://andersnoras.com/blogs/anoras/archive/2008/08/21/trick-or-trait-composite-oriented-programming-with-c.aspx)

Magnus Mårtensson - [Unity 应用程序块上的面向复合的编程峰值](http://blog.noop.se/archive/2008/08/27/composite-oriented-programming-spike-on-unity-application-block.aspx)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T16:25:54.367

Aku - CAB / Composite WPF 指南和 COP 之间存在相当大的差异，COP 是通过基于 [域] 上下文的“片段”组装来表达对象行为的一种根本不同的方法。.NET 4.0 中 Mixins、Concerns、Constraints 和 SideEffects 的出现不同地可能指向这个方向，但我想我更特别好奇微软是否偶然或以任何方式正式“做 COP”，特别是在奥斯陆存储库之上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T13:47:50.830

> 谁能评论微软是否在 COP 上做任何工作？

微软发布了[Composite Application Block](http://msdn.microsoft.com/en-us/library/aa480450.aspx)和[Composite WPF](http://msdn.microsoft.com/en-us/library/cc707819.aspx)，它们有 DI FW (Unity)。现在他们正在研究 MEF。

我们应该在这里评论什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-27T21:15:19.743

检查 MEF [http://mef.codeplex.com](http://mef.codeplex.com)，目前在 .NET 4 中提供，更多在 PDC 会话中[http://microsoftpdc.com/Sessions/FT24](http://microsoftpdc.com/Sessions/FT24)

# java - 如何处理库中的函数弃用？

> ID：152205
> 
> 赞同：6
> 
> 时间：2008-09-30T08:18:45.083
> 
> 标签：java, api

我正在开发一个 Java 库，并希望从中删除一些函数。我这样做的原因是公共 API 和设计清理。一些对象有设置器，但应该是不可变的，一些功能在不同的方法中实现得更好/更干净，等等。

我已将这些方法标记为“已弃用”，并希望最终将其删除。目前我正在考虑在几个冲刺（两周的开发周期）之后删除这些。

是否有任何关于删除冗余公共代码的“最佳实践”？

/亚努斯西姆

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-30T08:29:22.483

设置一个日期并在@deprecated 标记中公开它。删除的时间取决于您的代码拥有的用户数量、您与他们的联系程度以及更改的原因。

如果您有成千上万的用户并且您几乎不与他们交谈，那么时间范围可能应该在几十年的范围内:-)

如果您的用户是您的 10 位同事并且您每天都看到他们，那么时间范围很容易在几周范围内。

```
/**
 * @deprecated
 * This method will be removed after Halloween!
 * @see #newLocationForFunctionality
 */ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T08:28:56.853

以这种方式考虑，客户 A 下载您的库文件或框架的最新版本。他在这台机器上点击编译，突然他看到成千上万的错误，因为成员文件或函数不再存在。从此时起，您就给了客户一个不升级到新版本并继续使用旧版本的理由。

Raymond Chen 在他关于 win32 API 的博客中回答了这个问题，

不过，我们在软件公司的经验是，一旦编写了 API，我们就必须将 API 带到产品生命周期的末尾。为了帮助用户升级到新版本，我们在新框架中提供了与旧命令的向后兼容性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T08:26:52.707

这取决于代码重建的频率。例如，如果有 4 个应用程序使用该库，并且它们每天都在重建，那么一个月的时间足以修复已弃用的调用。

此外，如果您使用 deprecated 标记，请提供一些关于哪些代码替换 deprecated 调用的注释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T08:21:41.193

使用[@deprecated](http://java.sun.com/j2se/1.4.2/docs/guide/misc/deprecation/deprecated.html)标签。阅读[API 弃用](http://java.sun.com/j2se/1.4.2/docs/guide/misc/deprecation/index.html)文档了解更多信息。

在使用该代码的每个人都告诉您他们已经清理完毕后，开始删除已弃用的代码并等待，看看是否有人抱怨 - 然后告诉他们修复自己的代码......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T08:31:34.367

鉴于这是一个库，请考虑使用已弃用的功能归档一个版本。以源代码和编译形式提供此版本，作为尚未将代码现代化到新 API 的人的备用解决方案。（需要二进制形式，因为即使你可能在几年后编译旧版本也有困难。）明确表示不会支持和增强此版本。在版本控制系统中用符号标记此版本。然后继续前进。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T08:52:04.880

这当然取决于您使用 API 的规模以及您预先向客户承诺的内容。

正如 Vinko Vrsalovic 所描述的，您应该输入他们必须预期放弃该功能的日期。

在生产中，如果它“只是”为了获得更清晰的代码，我倾向于在不推荐使用的日期之后将东西留在原处，只要它不会破坏任何东西。

另一方面，在开发过程中，我会立即进行，以便快速解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T21:40:29.337

您可能对其他项目中弃用如何工作的示例感兴趣。例如，这里遵循[Django 项目中函数弃用的策略](http://docs.djangoproject.com/en/dev/internals/release-process/)是：

> 次要版本可能会弃用以前版本中的某些功能。如果 AB 版本中的某个功能被弃用，它将继续在 A.B+1 版本中工作。在 A.B+2 版本中，使用该功能将引发 PendingDeprecationWarning 但将继续工作。A.B+3 版将完全删除该功能。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-09-30T08:44:08.207

太糟糕了你没有使用.Net :(

内置的[Obsolete](http://msdn.microsoft.com/en-us/library/22kk2b44(VS.80).aspx)属性会生成编译器警告。

# linux - PowerPC Linux 上的 D（和 Tango）

> ID：152209
> 
> 赞同：3
> 
> 时间：2008-09-30T08:19:56.237
> 
> 标签：linux, d, powerpc, tango

使用 Google 很难搜索 D，所以我无法找到一个好的答案：

我有一台旧的 iBook G3，我想在上面安装 Linux 并用它来编译（和测试）使用 Tango 编写的 D 程序。这可能吗？还是没有人尝试过？仍然 GDC+Tango 的 Mac 端口也部分损坏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T09:01:44.310

这曾经可以工作，但它是与少数用户的组合，所以我不确定它最近是否经过测试。不过，Tango 不应该有大问题——编译器可能是一个更可能的问题。为此，您可能应该尝试从最近的 SVN 结帐（GDC）中编译自己的。

# java - 在 Axiom 安全请求中使用数据库资源

> ID：152215
> 
> 赞同：0
> 
> 时间：2008-09-30T08:22:16.650
> 
> 标签：java, axiom

我想知道如何在 Safe 函数中使用 Axiom 数据库资源。

现在我只是手动处理连接，但我知道使用已经定义的资源会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-07T13:25:33.560

我找到了。

如果需要这样做，您可以这样做：

在 safe.t_resources 中定义 db 资源，然后在安全函数 java 代码中：

`String DB_RESOURCE="DATABASE"; this.dbResource = getResource(this.DB_RESOURCE); Oracle oracle = new Oracle(this.dbResource); Connection conn = oracle.getConnection();`

对，就是这么简单

# c++ - Boost Range Library：依次遍历两个范围

> ID：152216
> 
> 赞同：5
> 
> 时间：2008-09-30T08:22:25.277
> 
> 标签：c++

Boost range 库 ( [http://www.boost.org/doc/libs/1_35_0/libs/range/index.html](http://www.boost.org/doc/libs/1_35_0/libs/range/index.html) ) 允许我们将一对迭代器抽象为一个范围。现在我想将两个范围合二为一，即：

给定两个范围 r1 和 r2，定义遍历 [r1.begin(), r1.end()[ 然后是 [r2.begin(), r2.end()[ 的 r。有没有办法使用 r1 和 r2 将 r 定义为一个范围？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-07-22T11:11:19.527

我再次需要这个，所以我再看一遍。有一种方法可以使用 boost/range/join.hpp 连接两个范围。不幸的是，接口中不包含输出范围类型：

```
#include "boost/range/join.hpp"
#include "boost/foreach.hpp"
#include <iostream>

int main() {
        int a[] = {1, 2, 3, 4};
        int b[] = {7, 2, 3, 4};

        boost::iterator_range<int*> ai(&a[0], &a[4]);
        boost::iterator_range<int*> bi(&b[0], &b[4]);
        boost::iterator_range<
           boost::range_detail::
           join_iterator<int*, int*, int, int&, 
           boost::random_access_traversal_tag> > ci = boost::join(ai, bi); 

        BOOST_FOREACH(int& i, ci) {
                std::cout << i; //prints 12347234
        }
} 
```

我使用编译器消息找到了输出类型。C++0x`auto`在那里也很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T08:30:46.413

*   您不能两次调用该函数，一次用于两个范围吗？或者这种方法有问题吗？
*   将两个范围复制到一个容器中并传递它。
*   编写您自己的范围类，因此它首先遍历 r1，然后再遍历 r2。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T08:26:30.323

我认为您必须制作一个自定义迭代器，当达到 r1.end() 时，它将“翻转” r1.end() 到 r2.begin() 。然后将该迭代器的 Begin() 和 end() 组合到您的范围 r 中。AFAIK 没有标准的增强功能会给你这种行为。

# python - 寻找包含字母数字+“&”和“;”的正则表达式

> ID：152218
> 
> 赞同：1
> 
> 时间：2008-09-30T08:23:05.417
> 
> 标签：python, regex, encoding

这是问题所在：

```
split=re.compile('\\W*') 
```

这个正则表达式在处理正则词时工作得很好，但是在某些情况下我需要表达式来包含像`k&amp;auml;ytt&amp;auml;j&aml;auml;`.

我应该在正则表达式中添加什么以包含`&`and`;`字符？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-30T08:34:52.487

我会将实体视为一个单元（因为它们也可以包含数字字符代码），从而产生以下正则表达式：

```
(\w|&(#(x[0-9a-fA-F]+|[0-9]+)|[a-z]+);)+ 
```

这匹配

*   一个单词字符（包括“<code>_”），或者
*   一个 HTML 实体，由
    *   字符“<code>&”,
        *   字符“<code>#”,
            *   字符“<code>x”后跟至少一个十六进制数字，或
            *   至少一位十进制数字，或
        *   至少一个字母（= 命名实体），
    *   分号
*   至少一次。

/编辑：感谢 ΤZΩΤZΙΟΥ 指出错误。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-30T08:26:18.873

你可能想把问题反过来，即找到所有没有空格的字符：

```
[^ \t\n]* 
```

或者您想添加额外的字符：

```
[a-zA-Z0-9&;]* 
```

如果您想匹配 HTML 实体，您应该尝试以下操作：

```
(\w+|&\w+;)* 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T08:33:37.420

您应该创建一个包含额外字符的字符类。例如：

```
split=re.compile('[\w&;]+') 
```

这应该可以解决问题。供你参考

*   `\w`（小写'w'）匹配单词字符（字母数字）
*   `\W`（大写 W）是一个否定字符类（意味着它匹配任何非字母数字字符）
*   `*`匹配 0 次或多次并`+`匹配 1 次或多次，因此`*`将匹配任何内容（即使那里没有字符）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-30T09:00:19.447

看起来这个 RegEx 成功了：

```
split=re.compile('(\\\W+&\\\W+;)*') 
```

感谢您的建议。他们中的大多数人在 Reggy 上工作得很好，但我不太明白为什么他们在`re.compile`.

# .net - 如何通过 Internet 分发 WCF 对等应用程序？

> ID：152238
> 
> 赞同：3
> 
> 时间：2008-09-30T08:30:33.557
> 
> 标签：.net, wcf, p2p

有人可以指出我正确的方向吗？我希望通过 Internet 分发 WCF 点对点云。到目前为止，我已经看到了它如何在同一子网上工作的示例。我想把它推得更远一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T08:56:48.517

我相信您需要考虑使用[IPV6 Teredo Tunneling](http://www.microsoft.com/technet/network/ipv6/teredo.mspx)来穿越 NAT 和防火墙，所以也许可以在MSDN的[WCF 传输](http://msdn.microsoft.com/en-us/library/ms731948.aspx)中查看此内容。

另外，看看今年 Kevn Hoffman 所做的[PRNP 系列。](http://dotnetaddict.dotnetdevelopersjournal.com/tags/?/peerseries)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-02T03:09:53.000

根据您的应用程序，您可能需要查看[Groove Virtual Office](http://office.microsoft.com/en-us/groove/FX100487641033.aspx?ofcresset=1)，它最近被 Microsoft 收购并随 Office 2007 一起提供。我不相信它使用 WCF，但它肯定使用 .NET 并且有一个可用的[SDK](http://www.microsoft.com/downloads/details.aspx?FamilyId=BAA487E9-E1B9-4A10-BEEA-1FD906B77F92&displaylang=en)应该允许您轻松创建 P2P 应用程序。

如果您正在为企业开发，请准备好处理可伸缩性问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-05T14:50:04.693

我将研究 Live Mesh，它可能是我的问题的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-06T13:38:43.813

所以即使是一年后...

一键部署方式你没试过吗？或者只下载 MSI 安装包怎么样？是您尝试解决的部署或通信。听起来像是分布问题。

解决 pat NAT 问题的方法称为“Nat Traversal”。

# ruby-on-rails - Ruby on rails（基于 Mephisto） - 无法联系服务器

> ID：152240
> 
> 赞同：0
> 
> 时间：2008-09-30T08:30:58.207
> 
> 标签：ruby-on-rails

我对 ruby​​ 完全陌生，我继承了一个用于产品目录的 ruby​​ 系统。我的大多数用户都可以查看所有内容，但海外用户（特别是墨西哥）一旦登录就无法联系服务器。他们是活跃用户。对不起，我不能更具体，而且系统是私有的，所以我不能授予访问权限。以前有没有人遇到过类似的问题？是用户端问题还是系统错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T10:06:51.063

作为一个*经常*站在用户一边的人，这种症状的头号罪魁祸首是“无知的管理员”。有很多很多网站通常会阻止大块 IP 空间或地理定位和开拓世界的大部分地区。

例如，数量惊人的美国博客为了避免 DDOS 攻击（实际上可能起源于俄罗斯或中国，但是，嘿，这种管理员不太擅长微调）而阻止亚洲国家（包括日本）解决方案）。我必须跳到我的美国代理服务器才能访问这些网站。

因此，我要诊断您的问题的第一件事是查看您的墨西哥用户是否正在访问服务器，或者他们是否在更早的地方被阻止（路由器？防火墙？等）。然后，为了确定问题是出在您的一方还是他们的一方，我会尝试通过您通过墨西哥代理代理您的连接并重复他们为导致问题而采取的措施来复制问题。

他们在登录后被阻止的事实可能表明您有 https 问题，例如安装了 HTTPS 加速器 [1]，或者可能是您的前端服务器正在正确地提供静态内容但正在检查动态请求只要。

[1] 我们已经看到了一些由 HTTPS 加速器故障引起的**非常奇怪的错误。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T09:55:28.033

如果它适用于其他所有人，那么问题似乎不在于 Ruby 或 Rails 工作，因为它们是......

我的第一个想法是检查网络问题：墨西哥用户是否都在同一个代理服务器和/或防火墙后面？

登录是在 Rails 应用程序中还是通过其他资源处理的？你能看到墨西哥用户的请求到达你的网络服务器的任何证据吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T11:43:43.750

登录由 rails 应用程序处理。我目前正在尝试寻找日志，因为我又是这个系统的新手，所以需要一些时间。干杯伙计们

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T11:59:10.013

也许 INS 正在打击网络移民。

# version-control - 什么是写用户手册（帮助文件）的好工具，集成了版本控制

> ID：152241
> 
> 赞同：15
> 
> 时间：2008-09-30T08:31:06.847
> 
> 标签：version-control, documentation, editor, chm

编写用户手册的人不一定是程序员，他们需要一个可视化编辑器。一个主要问题是创作工具的内部格式；它应该是可读的文本/html，因此很容易比较签入版本控制的各个页面的版本。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-30T08:34:00.773

## 文档书

[![替代文字](https://i.stack.imgur.com/945K6.png)](http://www.docbook.org/)
[（来源：[docbook.org](http://www.docbook.org/graphics/banner.png)）]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T08:38:18.500

Microsoft HTML Help Workshop 可用于创建高质量的专业 CHM 帮助文件。您所需要的只是一堆 HTML 文件。该工具将所有这些“编译”并捆绑到一个帮助文件中。可以使用 Microsoft Word/Frontpage 甚至 Dreamweaver 生成 HTML 文件。您可能需要考虑对这些 HTML 文件进行源代码控制。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-30T08:49:52.280

[乳胶](http://www.latex-project.org/)。[Lyx](http://www.lyx.org/)提供 WYSIWYM 用于编写 Latex 文件。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-30T09:21:34.700

在我以前的工作中，他们使用了 madcap 软件的一个工具，叫做[flare](http://www.madcapsoftware.com/products/)。

它似乎工作得很好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-30T09:00:54.203

还有其他允许编写帮助文件的专业产品，它们支持“上下文 ID”，这使得上下文敏感的帮助成为可能。[Doc To Help](http://www.doctohelp.com/)和[RoboHelp](http://www.adobe.com/ap/products/robohelp/?sdid=DSXEG)就是这些类型的产品。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-12-02T03:50:54.690

一个值得考虑的好组合是 Subversion、DocBook 和 Publican。

*   版本控制 =[颠覆](http://subversion.apache.org/)
*   内容创作 = [DocBook](http://www.docbook.org/)
*   出版 = [Publican](https://fedorahosted.org/publican/)
*   可选的所见即所得 = [Serna](http://www.syntext.com/products/serna-free/)

目前，这是全球最大的开源解决方案供应商使用的工具链之一，也是全球企业市场上大量使用基于 Linux 的操作系统的名称。大多数（几乎所有）Red Hat 的官方文档都是以这种方式创建的。Fedora 也是如此。

这里的主要“优点”是这些是免费提供的工具，在技术作家市场上有很强的重叠。所有这些都能够（但可能不想）用 XML 编写，并且拿起 DocBook 就像在 90 年代拿起 HTML。Subversion 是一个非常常见的版本控制工具，它和 DocBook 一样是比较容易实现和使用的。Publican 是一个很棒的发布工具，可以获取 DocBook XML，并将其发布为 PDF、HTML、HTML-single 等。显然，您的作者可以使用像 Serna 这样的 WYSIWYG，但我在 Geany（在 Fedora 上）或 TextMate（在OS X）个人。

主要的“缺点”是对技术性的看法。您的作者可能想要 WYSIWYG（并且可以拥有它），并且根据您的文档需求，这可能是您最终使用的。如您所知，专门修复 Microsoft Word 样式（和标记）的“技术作家”有一个市场，因此将“创作”与“发布”区分开来的论点基于经过验证但不同的组织用例要求文档保持与工程/编程/源生产的相同标准。

您将获得的一些极端建议来自那些已经接触过 XML 文档价值的人和公司，尤其是那些在 DITA 领域的人，在这些领域中，某些跨国公司因受格式和影响的收购而享有盛誉。产品知识的可用性。还有人认为将文档锁定为“粘性”或封闭格式无助于未来的维护需求。这就是开源选项在企业层面获得支持的地方。另外，显然，它是免费的。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-30T09:24:14.333

您可以使用 Subversion 和 MGTEK Help Producer。Help Producer 从 Word 文档制作帮助文件。TortoiseSVN 带有脚本来比较 Word 文档的不同版本，在 Word 本身（Word 有一个版本比较工具）。

您的用户会想要一个与他们正在编辑的工具相似的视觉差异工具。如果他们只是稍微没有技术含量，DocBook 或 Latex 将无法工作（我已经尝试为我的用户提供这两种工具，我什至尝试将 Epic Editor 作为 DocBook 编辑器，它非常昂贵，但毕竟效果不佳）。坚持他们知道的东西（Word）可以避免很多麻烦。

一开始我也非常不愿意走这条路，因为我想要一个“技术上更完美”的解决方案，但随着时间的推移，我意识到拥有快乐和高效的用户更为重要。只是说我知道您来自哪里，但请尝试 Word 路线 - 它在实践中比所有“纯”基于文本的解决方案效果更好。普通用户不喜欢基于标记的编辑。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-30T08:43:37.643

我创建了一个名为[Mandown](http://wittman.org/mandow/)的文档系统（**Markdown/Html/Javascript/基于文件的相对链接文档**以实现可移植性），它可以很容易地受到版本控制。您必须单独弄清楚可视化编辑器部分 - 我有时使用至少具有预览功能的[HTML-Kit 。](http://wittman.org/projects/mandown/Utility.Editor.HtmlKit.html)

请参阅[存储软件文档的最佳方式是什么？](https://stackoverflow.com/questions/99419/what-is-the-best-way-to-store-software-documentation#99600)

* * *

这是另一个检查工具：[Xilize](http://xilize.sourceforge.net)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-30T08:53:43.580

如果您使用的是 Visual Studio，请查看 SandCastle - [http://www.codeplex.com/Sandcastle](http://www.codeplex.com/Sandcastle)。

还有一些工具可以帮助您构建沙堡文件，尝试在 codeplex 上搜索“sandcastle”。其中之一是 SandCastle Help File Builder ( [http://www.codeplex.com/SHFB](http://www.codeplex.com/SHFB) )，但我从未使用过它，所以我不知道非技术用户是否会对此感到满意。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-19T09:27:38.240

Mapcap Flare 是最好的商业工具。由 Robodoc 的前开发人员撰写

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-30T08:37:58.640

我们正在使用[APT](http://maven.apache.org/doxia/references/apt-format.html)。它与 CI（标准构建工件）很好地集成，并且比 word 文档更活跃。还可以在需要时生成 PDF 和其他格式。

# sql - 多进程写入的事务封装

> ID：152243
> 
> 赞同：2
> 
> 时间：2008-09-30T08:33:02.693
> 
> 标签：sql, transactions, acid

我有一个数据库场景（我正在使用 Oracle），其中几个进程将插入到一个表中，并且一个进程从中选择。该表主要用作中间存储，多个进程（以下称为 Writers）向其写入日志事件，而单个进程（以下称为 Reader）则从中读取事件以进行进一步处理。Reader 必须读取插入到表中的所有事件。

目前，这是通过为每个插入的记录分配一个升序的 id 来完成的。读取器周期性地从表中选择一个条目块，其中 id 大于先前读取块的最大 id。例如：

```
SELECT
  *
FROM
  TRANSACTION_LOG
WHERE
  id > (
    SELECT
      last_id
    FROM
      READER_STATUS
   ); 
```

这种方法的问题在于，由于写入器是并发操作的，因此行并不总是根据其分配的 id 按顺序插入，即使这些是按顺序升序分配的。也就是说，有时会在 id=110 的记录之后写入 id=100 的行，因为写入 id=110 的行的过程在写入记录 id=100 的进程之后开始，但首先提交。如果读取器已经读取了 id=110 的行，这可能会导致读取器丢失 id=100 的行。

强制写入者对表进行排他锁将解决问题，因为这将强制它们按顺序插入，并且还会让读取器等待任何未完成的提交。然而，这可能不会很快。

我的想法是，读者在阅读之前等待任何未完成的 Writer 提交就足够了。也就是说，只要 Reader 确实读取，Writers 就可以继续并发操作，直到所有 writers 完成。

我的问题是：
如何指示我的读者进程等待我的作家进程的任何未完成的提交？也欢迎对上述问题提出任何替代建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T09:31:41.820

有趣的问题。听起来您正在构建一个不错的解决方案。
我希望我能帮上忙。

几个建议...

## 作家状态

您可以创建一个表 WRITER_STATUS，它有一个 last_id 字段：每个写入者在使用要写入日志的 ID 写入之前更新此表，但前提是其 ID 大于 last_id 的当前值。

读者还检查了这个表，现在知道是否有任何作家还没有写过。

## 读者日志

这可能更有效。
阅读器进行阅读后，它会检查检索到的记录中是否存在任何漏洞。
然后它将所有丢失的 ID 记录到 MISSING_IDS 表中，并在下一次读取时执行类似的操作

```
SELECT *
FROM   TRANSACTION_LOG
WHERE  id > (SELECT last_id
             FROM   READER_STATUS)
OR     id IN ( SELECT id from MISSING_IDS ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T09:45:57.900

您可能希望在读取器进程中对表设置排他锁。这将等到所有写入程序完成并释放他们的行锁，因此您可以确定没有未完成的写入程序事务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T17:16:22.233

我不会做任何锁定，这会干扰并发性和吞吐量。

如果您逐行跟踪已处理的日志行，则您也不需要 Reader_Status 表。

这就是我要做的：在您的日志表中添加一个新列。例如，将其称为“已处理”。使其成为布尔值，默认为 false（或小整数，默认为 0 或其他）。写入器在插入时使用默认值。

当 Reader 查询下一个要处理的记录块时，他会查询已处理为 false 且 id 值较低的行。

```
SELECT * FROM Transaction_Log
WHERE processed = 0
ORDER BY id
LIMIT 10; 
```

在处理它们时，Reader 使用 UPDATE 将处理的从 false 更改为 true。所以下次 Reader 查询一个记录块时，他确信他不会得到他已经处理过的行。

```
UPDATE Transaction_Log
SET processed = 1
WHERE id = ?;  -- do this for each row processed 
```

此 UPDATE 不应与 Writer 执行的 INSERT 操作冲突。

如果任何行被其他 Writer 不按顺序提交，Reader 将在下次查询时看到它们，如果他总是按照 id 列从最低值到最高值的顺序处理它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T03:46:52.263

我同意 AJ 的解决方案（[链接](https://stackoverflow.com/questions/152243/transaction-encapsulation-of-multi-process-writes#152375)）。此外，以下建议可能有助于减少孔的数量。

1）`Oracle Sequence`用于创建id并使用`auto-increment`如下

```
INSERT INTO transaction_table VALUES(id__seq.nextval, <other columns>); 
```

2）使用`autoCommit(true)`以便插入将立即提交。

这两个步骤将大大减少孔的数量。仍然有可能一些插入首先开始但后来提交，并且在两者之间发生了读取操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T18:46:29.600

由于您知道`last_id`由 Reader 处理，您可以通过以下方式请求下一个工作项：

```
select * from Transaction_log where id = (
  select last_id + 1 /* or whatever increment your sequencer has */
    from Reader_status) 
```

# django - 我可以在 Django 中使用 HTTP 基本身份验证吗？

> ID：152248
> 
> 赞同：43
> 
> 时间：2008-09-30T08:34:35.403
> 
> 标签：django, http-authentication

我们有一个在 Apache 上运行的网站，访问该网站有许多通过 HTTP 基本身份验证保护的静态页面。

我使用 Django 对用户管理的内置支持，使用 Django 编写了网站的新部分。

我遇到的问题是用户必须通过 HTTP Basic 身份验证登录一次，然后再次使用 Django 登录表单。这对用户来说既笨拙又非常混乱。

我想知道是否有人找到了一种方法让 Django 使用 HTTP 基本身份验证信息登录用户。

我不希望将密码传递给 Django，但如果用户`dave`已通过 Apache 的身份验证，那么他们也应该自动登录到 Django `dave`。

（一种选择是让 Apache 和 Django 共享一个用户存储以确保共同的用户名和密码，但这仍然会涉及两个登录提示，这是我试图避免的。）

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-07-06T15:48:56.157

对于仅支持某些请求的基本身份验证（而不是与 Web 服务器混为一谈——这是某人可能会解释您的问题标题的方式），您将需要查看此处：

[http://www.djangosnippets.org/snippets/243/](http://www.djangosnippets.org/snippets/243/)

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2011-05-04T00:42:10.803

这已添加到 Django 1.3 版本中。在此处查看更多当前文档：http: [//docs.djangoproject.com/en/dev/howto/auth-remote-user/](http://docs.djangoproject.com/en/dev/howto/auth-remote-user/)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-01T07:36:27.347

请查看 Oli 的链接。通过查看 request.META['REMOTE_USER']，您基本上可以看到在 Django 中由 Basic HTTP Authentication 验证的经过身份验证的用户名。

**更新：**测试了票证[#689](http://code.djangoproject.com/ticket/689)的提议补丁，该补丁可在 Telenieko 的 git 存储库中获得最新[版本](http://www.marcfargas.com/gitweb/?p=django.git;a=commitdiff_plain;h=trac/689-remote-user;hp=master)。它至少适用于 Django 的修订版[9084](http://code.djangoproject.com/browser/django/trunk?rev=9084)。

通过以下方式激活远程用户身份验证后端

*   添加`RemoteUserAuthMiddleware`之后`AuthenticationMiddleware`
*   添加设置`AUTHENTICATION_BACKENDS = ('django.contrib.auth.backends.RemoteUserAuthBackend',)`

如果您像我一样使用 lighttpd 和 FastCGI，请激活 mod_auth，为测试用户创建凭据（我调用它`testuser`并设置`123`为密码）并将 Django 站点配置为需要基本身份验证。

以下`urls.py`可用于测试设置：

```
from django.conf.urls.defaults import *
from django.http import HttpResponse
from django.contrib.auth.models import User
urlpatterns = patterns('',
    url(regex='^$',
        view=lambda request: HttpResponse(repr(request), 'text/plain')),

    url(regex='^user/$',
        view=lambda request: HttpResponse(repr(request.user), 'text/plain')),

    url(regex='^users/$',
        view=lambda request: HttpResponse(
            ','.join(u.username for u in User.objects.all()),
            'text/plain')),
) 
```

在重新加载 lighty 和 Django FCGI 服务器之后，加载站点的根目录现在要求身份验证并接受`testuser`凭据，然后输出请求对象的转储。在 request.META 中应该存在这些新属性：

```
'AUTH_TYPE': 'Basic'
'HTTP_AUTHORIZATION': 'Basic dGVzdHVzZXI6MTIz'
'REMOTE_USER': 'testuser' 
```

该`/user/`URL 可用于检查您是否确实以以下身份登录`testuser`：

```
<User: testuser> 
```

现在`/users/`URL 列出了自动添加的内容`testuser`（这里还显示了`admin`我创建时创建的用户`syncdb`）：

```
admin,testuser 
```

如果您不想修补 Django，将`RemoteUserAuthBackend`和`RemoteUserAuthMiddleware`类分离到一个单独的模块中并在 Django 设置中引用它是微不足道的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-30T08:39:35.440

有[httpauth.py](http://code.djangoproject.com/attachment/ticket/689/httpauth.py)。我仍然是 Django 的新手，所以我不知道它是如何完全适应的，但它应该可以满足您的需求。

编辑：这里[有一个关于这个主题的更长的错误线程](http://code.djangoproject.com/ticket/689)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-26T18:10:58.833

是的，您可以将基本的自动化与 django 类似：

```
def post(self, request):
    auth_header = request.META.get('HTTP_AUTHORIZATION', '')
    token_type, _, credentials = auth_header.partition(' ')
    import base64
    expected = base64.b64encode(b'<username>:<password>').decode()
    if token_type != 'Basic' or credentials != expected:
        return HttpResponse(status=401)
    authorization success flow code ... 
```

request.META 包含您的 Autorization 所在的关键 HTTP_AUTHORIZATION。

如果您将 apache 与 modWSGI 一起使用，则密钥 HTTP_AUTHORIZATION 可能不存在。您需要在 WSGI 配置中添加以下行

**WSGIPassAuthorization 开启**

参考这个详细的答案： [Passing apache2 digest authentication information to a wsgi script run by mod_wsgi](https://stackoverflow.com/questions/123499/passing-apache2-digest-authentication-information-to-a-wsgi-script-run-by-mod-ws)

希望它对想知道为什么 HTTP_AUTHORIZATION 密钥不存在的人有用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T20:55:26.327

因为 django 可以以多种方式运行，并且只有 modpython 可以让您与 Apache 紧密集成，所以我不相信 django 有办法让您在 Apache 的基本身份验证上登录 basic。身份验证实际上应该在应用程序级别完成，因为它会给您更多的控制权并且会更简单。您真的不希望在 Python 和 Apache 之间共享用户数据的麻烦。

如果您不介意使用 Django 的补丁版本，那么在[http://www.djangosnippets.org/snippets/56/](http://www.djangosnippets.org/snippets/56/)上有一个补丁，它将为您提供一些支持基本身份验证的中间件。

基本身份验证非常简单 - 如果用户未登录，则返回 401 身份验证所需的状态代码。这会提示浏览器显示一个登录框。然后浏览器将提供用户名和密码作为 bas64 编码字符串。维基百科条目[http://en.wikipedia.org/wiki/Basic_access_authentication](http://en.wikipedia.org/wiki/Basic_access_authentication)非常好。

如果补丁不能满足您的要求，那么您可以很快自己实现基本身份验证。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T09:14:56.437

这似乎是一项自定义任务`AuthenticationBackend`- 请参阅[有关此主题的 Django 文档](http://docs.djangoproject.com/en/dev//topics/auth/#other-authentication-sources)，djangosnippets.org 有一些此类代码的真实示例（请参阅[1](http://www.djangosnippets.org/tags/auth-backend/)或[2](http://www.djangosnippets.org/tags/authentication/)）（这并不是一件难事）。

`AuthenticationBackend`子类必须只定义 2 个方法，并且它们的代码非常简单：一个必须为用户 ID 返回 User 对象，第二个必须执行凭据检查并在凭据有效时返回 User 对象。

# .net - 获取类属性名称

> ID：152250
> 
> 赞同：11
> 
> 时间：2008-09-30T08:34:56.230
> 
> 标签：.net, reflection

我的 winform 应用程序使用数据绑定收集数据。一切看起来都很好，除了我必须使用字符串将**属性**与**textedit链接：**

> Me.TextEdit4.DataBindings.Add（新 System.Windows.Forms.Binding（“EditValue”，Me.MyClassBindingSource，“MyClassProperty”，True））

这很好，但如果我更改类的属性名称，编译器显然不会警告我。

我希望能够通过反射获取属性名称但我不知道如何指定我想要的属性名称（我只知道如何在类的所有属性之间进行迭代）

任何的想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-30T08:55:00.270

如果您使用的是 C# 3.0，则有一种方法可以动态获取属性名称，而无需对其进行硬编码。

```
private string GetPropertyName<TValue>(Expression<Func<BindingSourceType, TValue>> propertySelector)
{
    var memberExpression = propertySelector.Body as MemberExpression;
    return memberExpression != null 
           ? memberExpression.Member.Name 
           : string.empty;
} 
```

`BindingSourceType`数据源对象实例的类名在哪里。

然后，您可以使用 lambda 表达式以强类型方式选择要绑定的属性：

```
this.textBox.DataBindings.Add(GetPropertyName(o => o.MyClassProperty),
                              this.myDataSourceObject,
                              "Text"); 
```

它将允许您安全地重构您的代码，而不会破坏您所有的数据绑定内容。但就性能而言，使用表达式树与使用反射相同。

**前面的代码非常丑陋且未经检查，但您明白了。**

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T08:48:22.313

这是我正在谈论的一个例子：

```
[AttributeUsage(AttributeTargets.Property)]
class TextProperyAttribute: Attribute
{}

class MyTextBox
{
    [TextPropery]
    public string Text { get; set;}
    public int Foo { get; set;}
    public double Bar { get; set;}
}

static string GetTextProperty(Type type)
{
    foreach (PropertyInfo info in type.GetProperties())
    {
        if (info.GetCustomAttributes(typeof(TextProperyAttribute), true).Length > 0)
        {
            return info.Name;
        }
    }

    return null;
}

...

Type type = typeof (MyTextBox);

string name = GetTextProperty(type);

Console.WriteLine(name); // Prints "Text" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-30T08:39:25.847

具有讽刺意味的是，反射希望您提供属性名称来获取它的信息:)

您可以创建自定义属性，将其应用于所需的属性。然后，您将能够简单地获取具有此属性的属性的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T08:40:17.777

使用反射也会遇到同样的问题，因为为了在所有类型的属性中找到正确的属性，您必须知道它的名称，对吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T08:40:35.360

您可以反映类型，但不能反映其成员，除非按名称。

如果这是唯一的属性，或者您确定可以通过索引找到它的顺序，但一般来说字符串是最安全的方法。

我相信更改名称会导致运行时异常，但不是 100% 确定，在任何一种情况下，这可能是最好的可能性。

假设没有自动发生异常，您可以添加一个 Debug.Assert 来检查该名称的属性是否存在，但这只是运行时。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T08:42:25.587

1）指定您想要的确切属性名称并保持这种方式

2) 编写一个涉及该属性名称的测试。

# php - 用 PHP 搜索 MySQL 数据库的最佳方法是什么？

> ID：152259
> 
> 赞同：14
> 
> 时间：2008-09-30T08:41:54.967
> 
> 标签：php, mysql, search

假设我在 MySQL 数据库中有一个书籍表，并且我想在“标题”字段中搜索关键字（由用户在搜索字段中输入）；在 PHP 中执行此操作的最佳方法是什么？MySQL`LIKE`命令是最有效的搜索方式吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-30T08:51:56.923

是的，最有效的方法通常是在数据库中搜索。为此，您有三种选择：

*   [LIKE, ILIKE](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html)匹配精确的子串
*   [RLIKE](http://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html)匹配 POSIX 正则表达式
*   [FULLTEXT](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)索引以匹配针对自然语言处理的另外三种不同类型的搜索

因此，这取决于您将实际搜索什么来决定什么是最好的。对于书名，我会提供 LIKE 搜索来精确匹配子字符串，这在人们知道他们正在寻找的书时很有用，并且还提供 FULLTEXT 搜索来帮助查找与单词或短语相似的标题。当然，我会在界面上给它们起不同的名称，可能类似于子字符串搜索的确切名称和全文搜索的类似名称。

关于全文的示例：[http ://www.onlamp.com/pub/a/onlamp/2003/06/26/fulltext.html](http://www.onlamp.com/pub/a/onlamp/2003/06/26/fulltext.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-30T09:06:13.817

这是一种简单的方法，您可以分解一些关键字以构建一些子句，以过滤这些关键字上的列，无论是 ANDed 还是 ORed 一起。

```
$terms=explode(',', $_GET['keywords']);
$clauses=array();
foreach($terms as $term)
{
    //remove any chars you don't want to be searching - adjust to suit
    //your requirements
    $clean=trim(preg_replace('/[^a-z0-9]/i', '', $term));   
    if (!empty($clean))
    {
         //note use of mysql_escape_string - while not strictly required
         //in this example due to the preg_replace earlier, it's good
         //practice to sanitize your DB inputs in case you modify that
         //filter...
         $clauses[]="title like '%".mysql_escape_string($clean)."%'";
    }
}

if (!empty($clauses))
{   
    //concatenate the clauses together with AND or OR, depending on
    //your requirements
    $filter='('.implode(' AND ', $clauses).')';

    //build and execute the required SQL
    $sql="select * from foo where $filter";
}
else
{
    //no search term, do something else, find everything?
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-02T04:45:24.643

考虑使用[sphinx](http://www.sphinxsearch.com/)。它是一个开源的全文引擎，可以直接使用你的 mysql 数据库。它比手动编码 LIKE 语句更具可扩展性和灵活性（并且更不容易受到 SQL 注入的影响）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T09:32:42.473

您还可以在 mysql 手册[http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_soundex](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_soundex)中检查 soundex 函数（soundex，听起来像） 如果例如严格，则返回这些匹配项的功能检查（通过 LIKE 或 =）没有返回任何结果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-02T04:41:47.723

Paul Dixon 的代码示例很好地理解了基于 LIKE 的方法的主要思想。

我将添加这个可用性想法：在界面中设置一个 (AND | OR) 单选按钮，默认为 AND，然后如果用户的查询结果为零 (0) 匹配并且包含至少两个单词，则使用选项进行响应大意是：

> “抱歉，**没有**找到与您的搜索词组匹配的内容。扩展搜索以匹配您词组中的任何单词？

也许有更好的表达方式，但基本思想是引导人们进行另一个查询（*这可能是成功*的），而用户不必考虑 AND 和 OR 的布尔逻辑。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-12T20:10:24.640

我认为如果是一个词，Like 是最有效的方式。如前所述，可以使用explode功能拆分多个单词。然后它可以循环并用于在数据库中单独搜索。如果两次返回相同的结果，可以通过将值读入数组来检查。如果它已经存在于数组中，则忽略它。然后使用计数功能，您将知道在循环打印时在哪里停止。可以使用similar_text 函数进行排序。百分比用于对数组进行排序。那是最好的。

# c# - tStringList 将 C# 传递给 Delphi DLL

> ID：152261
> 
> 赞同：2
> 
> 时间：2008-09-30T08:42:37.070
> 
> 标签：c#, delphi, dll, tstringlist

我有一个 Delphi DLL，其函数定义为：

函数 SubmitJobStringList(joblist: tStringList; var jobno: Integer): Integer;

我从 C# 调用它。如何将第一个参数声明为 C# 中不存在的 tStringList。我目前的声明为：

```
[DllImport("opt7bja.dll", CharSet = CharSet.Ansi, CallingConvention = CallingConvention.StdCall)]
public static extern int SubmitJobStringList(string[] tStringList, ref int jobno); 
```

但是当我调用它时，我得到一个内存访问冲突异常。

任何人都知道如何从 C# 正确传递给 tStringList 吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-30T09:07:14.110

你很可能不会有任何运气。TStringList 不仅仅是一个数组，它还是一个成熟的类，而且确切的实现细节可能与 .NET 可能的不同。查看 Delphi VCL 源代码（即，如果你有的话）并尝试找出是否可以在 C# 中重建类，并在你最好的朋友 Interop Marshaller 的帮助下传递它。请注意，即使 Delphi 字符串类型与 .NET 字符串类型不同，并且在不告诉编组器应该做什么的情况下传递它，他很可能会将其作为字符数组传递。

除此之外，我建议更改 Delphi DLL。在非 Delphi 客户端使用的 DLL 中公开任何特定于 Delphi 的东西从来都不是一件好事。将参数设为 PChar 数组，你应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T10:03:36.547

如果这是您的 DLL，我会重写该函数以接受字符串数组。避免将类作为 DLL 参数传递。

或者，如果您出于某种原因*真的*想使用 TStringList，则可以从任何 .Net 语言使用 Delphi 的 VCL.Net。

使用 TINiFile 的旧示例：http: [//cc.codegear.com/Item/22691](http://cc.codegear.com/Item/22691)

该示例在 Delphi 2005 中使用 .Net 1.1。Delphi 2006 和 2007 支持 .Net 2.0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T10:12:40.100

如果您不控制 DLL 并且他们不能或不会更改它，您总是可以在单独的 DLL 中编写自己的 Delphi 包装器，并使用更跨语言友好的参数。

将类作为 DLL 函数的参数确实是一种不好的形式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T09:12:25.780

我不太清楚你使用 delphi 和 C# 的方式。看来您已经创建了一个要从 C# 调用的 Win32 DLL。当然，您必须为此使用 PInvoke。

我建议您使用您的源代码创建一个 .NET DLL，因为可以完全移植 VCL。如果您愿意，我可以进一步详细说明......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T09:29:24.367

从理论上讲，您*可以*通过使用指针（将它们转换为 C# IntPtr 类型）而不是强类型对象引用（或者可能将它们包装成其他类型以避免必须声明不安全块）来执行此类操作，但基本的问题是this：Delphi 运行时必须是为对象分配和释放内存的机制。为此，您必须在 Delphi 编译的 DLL 中声明调用 TStringList 类的构造函数和析构函数的函数，您必须确保 Delphi DLL 使用 ShareMem 单元，并且您必须负责增加和减少引用计数为您的 Delphi AnsiStrings 在离开 DLL 之前和进入之后，最好也作为从您的 Delphi DLL 导出的函数。

简而言之，这是**很多**工作，因为您必须在同一个进程中处理两个内存管理器（.NET CLR 和 Delphi 的分配器），并且您必须手动管理内存*并*“欺骗”Delphi 内存管理器和运行时。您是否有特殊原因必须使用此设置？你能描述一下你试图在更高层次上解决的问题吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T09:48:34.493

正如 Hemant Jangid 所说，您应该可以通过将代码编译为 .NET dll 然后在您的 c# 项目中引用该程序集来轻松地做到这一点。

当然，只有当您拥有的 Delphi 版本具有 Delphi.NET 时，您才能执行此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-01T03:45:25.637

我对 c# 了解不多，但我用于跨上下文传输字符串列表的一种技术是使用 .text 属性来获取表示列表的字符串，然后在“另一端”分配该属性。

通常更容易将一根绳子穿过墙壁，因为它是一个完整的物体。

# javascript - 中间点击（新标签）和 javascript 链接

> ID：152262
> 
> 赞同：17
> 
> 时间：2008-09-30T08:42:37.507
> 
> 标签：javascript, html, ajax

我在工作中负责一个网站，最近我添加了 ajaxy 请求以使其更快、响应更快。但它提出了一个问题。

在我的页面上，左侧有一个索引表，就像一个菜单。单击它后，它会发出一个填充页面其余部分的请求。您可以随时单击索引的另一个项目来加载不同的页面。

在添加 javascript 之前，可以对索引的每个项目进行中键单击（打开新选项卡），这样可以在我处理其中一个页面时加载其他页面。但由于我已将所有链接更改为 ajax 请求，它们现在执行一些 javascript 而不是真正的链接。因此，当我中键单击它们时，它们只会打开空选项卡。

有没有办法将这两种功能结合起来：单击左键时触发 javascript 的链接或单击中键时触发新标签的链接？是否必须是一些丑陋的 javascript 来捕捉每一次点击并相应地处理它们？

谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-30T08:46:37.293

是的。代替：

```
<a href="javascript:code">...</a> 
```

做这个：

```
<a href="/non/ajax/display/page" id="thisLink">...</a> 
```

然后在您的 JS 中，通过它的 ID 挂钩链接以进行 AJAX 调用。请记住，您需要阻止点击事件冒泡。大多数框架都有一个内置的事件杀手，您可以调用它（只需查看它的 Event 类）。

这是 jquery 中的事件处理和事件杀手：

```
$("#thisLink").click(function(ev, ob) {
    alert("thisLink was clicked");
    ev.stopPropagation();
}); 
```

当然，你可以更聪明，同时处理这样的事情，但我认为强调这种方法比使用属性更干净是*很重要的。*`onclick`

# 让你的 JS 在 JS 中！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T08:58:48.293

是的，您需要查找渐进式增强和不显眼的 Javascript，并在未启用 Javascript 的情况下对您的网站进行编码，然后在基本网站正常工作后添加 Javascripts 功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-30T19:58:14.467

我喜欢 Oli 的方法，但它无法区分左键和中键。检查 eventArgs 上的“which”字段会让你知道。

```
$(".detailLink").click(function (ev, ob) {
    //ev.which == 1 == left
    //ev.which == 2 == middle
    if (ev.which == 1) {
        //do ajaxy stuff

        return false; //tells browser to stop processing the event
    }
    //else just let it go on its merry way and open the new tab.
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T08:46:32.787

这需要一些测试，但我相信大多数浏览器在单击它们时不会执行单击处理程序，这意味着只使用了链接。

但是，您的处理程序函数需要返回 false 以确保在正常单击时不使用这些链接。

**编辑：** 觉得这可以使用一个例子：

```
<a href="/Whatever/Wherever.htm" onclick="handler(); return false;" /> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T14:25:37.260

```
<a href="/original/url" onclick="return !doSomething();">link text</a> 
```

有关更多信息和详细说明，请查看[我在另一篇文章中的回答](https://stackoverflow.com/questions/134845/href-for-javascript-links-or-javascriptvoid0#143410)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T08:45:21.260

可能，我每次可以提供两个链接，一个触发 javascript，另一个是允许中间点击的真实链接。我想，其中一个必须是图像以避免索引过载。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T08:47:35.247

onclick 事件不会为该类型的点击触发，因此您需要添加一个`href`实际起作用的属性。一种可能的方法是`#bookmark`在 URL 中添加一个以指示目标页面所需的状态是什么。

# javascript - Microsoft JScript 运行时错误：“this._postBackSettings.async”为空或不是对象

> ID：152276
> 
> 赞同：3
> 
> 时间：2008-09-30T08:47:18.073
> 
> 标签：javascript, asp.net, asp.net-ajax

我的 asp 页面上有报告，每次更改过滤器并单击查看报告时，都会收到此错误：

Microsoft JScript 运行时错误：“this._postBackSettings.async”为空或不是对象

我尝试将 EnablePartialRendering="true" 更改为 EnablePartialRendering="false" 但随后人们无法登录该网站

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-30T11:21:49.247

我发现了这个问题的另一种解决方案。

我使用 Telerik RadScriptManager 和 RadAjaxManager（它们建立在各自的 ASP.NET 框架对象之上）。当我实现 JQuery UI 动画来隐藏按钮时，我发现了一些问题——我执行了按钮的“OnClientClick”的动画。

为了解决这个问题，我处理了 OnRequestStart 和 OnResponseEnd 客户端事件，并分别从 OnRequestStart 和 OnResponseEnd 执行了适用的隐藏和显示动画。

我知道不是每个人都使用 Telerik，但这个概念可能是关键，并且可能适用于其他 AJAX 框架：当对 ajaxified 元素执行客户端更改（尤其是在 AJAX 请求处理期间发生的动画等更改）时，在框架的RequestStart/ResponseEnd 客户端事件处理程序，而不是 ajaxified 元素的客户端事件处理程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-02-24T13:10:49.740

我遇到了同样的问题，直到我最终找到了完全符合我要求的[https://siderite.dev/blog/thispostbacksettingsasync-is-null-or.html之前，我还没有真正找到任何令人满意的解决方案。](https://siderite.dev/blog/thispostbacksettingsasync-is-null-or.html)

只是为了避免将来可能出现死链接的问题，这里是代码：

```
var script = @"
if (Sys &&
    Sys.WebForms && Sys.WebForms.PageRequestManager &&
    Sys.WebForms.PageRequestManager.getInstance) 
{
    var prm = Sys.WebForms.PageRequestManager.getInstance();
    if (prm &&
       !prm._postBackSettings)
    {
        prm._postBackSettings = prm._createPostBackSettings(false, null, null);
    }";

ScriptManager.RegisterOnSubmitStatement(
    Page, 
    Page.GetType(), 
    "FixPopupFormSubmit", 
    script); 
```

如果在没有设置 _postBackSettings 的情况下提交，它会创建它们，导致空引用异常消失，因为 _postBackSettings.async 然后可用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-27T10:07:12.523

这个问题是通过设置`EnablePartialRendering`为 false 来解决的`ScriptManager`。

```
ScriptManager1.EnablePartialRendering  = false; 
```

在使用`OnInit`页面的情况下`rsweb:ReportViewer`。如果要为其他页面启用，请在母版页的`OnInit`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-23T12:55:10.720

将按钮放在面板内（不是更新面板），然后将此行添加到面板 DefaultButton="Button1"

这将避免错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-17T18:36:37.120

我也遇到了这个问题，尽管在我的情况下没有涉及到报告：它只是一个带有图像按钮的普通 asp.net 页面。问题是在客户端单击时，我使用以下代码取消了下一个 javascript 事件：

```
event.cancelBubble = true;
if (event.stopPropagation)
    event.stopPropagation(); 
```

我删除了代码，问题也消失了。我的猜测是 asp.net ajax 需要对客户端单击进行一些处理，也许您的报告控件正在做一些我正在做的事情。希望它可以帮助您找到您的问题，并为我的英语感到抱歉:) 问候，MMM

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-20T13:49:26.790

我刚刚遇到这个问题，偶然找到了解决方案。

在我将 ScriptManager 移动到母版页后，问题开始出现 - 只有当我使用没有更新面板的页面时。

通过将 ScriptManager 标记移动到母版页内容区域的前面来解决此问题。

JavaScript 排序问题？

# mysql - 将 UTF-8 编码的转储加载到 MySQL

> ID：152288
> 
> 赞同：10
> 
> 时间：2008-09-30T08:53:10.617
> 
> 标签：mysql, encoding, utf-8

昨天几个小时我一直在关注这个问题：

我在 MySQL 4.1.22 服务器上有一个数据库，其编码设置为“UTF-8 Unicode (utf8)”（由 phpMyAdmin 报告）。此数据库中的表的默认字符集设置为**latin2**。**但是，使用它的 Web 应用程序（用 PHP 编写的 CMS Made Simple）以utf8 格式**显示页面......

不管这可能是多么糟糕，它确实有效。Web 应用程序正确显示字符（主要使用捷克语和波兰语）。

我运行：“mysqldump -u xxx -p -h yyy dbname > dump.sql”。这给了我一个 SQL 脚本：

*   **以UTF-8**显示时，在任何编辑器（如 Notepad+）中看起来都很完美- 所有字符都正确显示
*   脚本中的所有表都将默认字符集设置为**latin2**
*   它有“/*！40101 SET NAMES latin2 */;” 开头的行（以及其他设置）

现在，我想将此数据库导出到在 MySQL 5.0.67 上运行的另一台服务器，服务器编码也设置为“UTF-8 Unicode (utf8)”。我复制了整个 CMS Made Simple 安装，复制了 dump.sql 脚本并运行“mysql -h ddd -u zzz -p dbname < dump.sql”。之后，在显示 CMSMS 网页时，所有字符都被打乱。

我尝试设置：
SET character_set_client = utf8;
SET character_set_connection = latin2;

所有组合（只是为了安全，即使它对我没有任何意义）：latin2/utf8、latin2/latin2、utf8/utf8 等 - 无济于事。所有字符仍然打乱，但有时以不同的方式:)。

我还尝试在脚本中用 utf8 替换所有 latin2 设置（为表设置名称和默认字符集）。没有。

这里有没有 MySQL 专家可以用几句话来解释（我相信这毕竟很简单）整个编码的东西是如何工作的？我读了[9.1.4。连接字符集和排序规则](http://dev.mysql.com/doc/refman/5.0/en/charset-connection.html)，但在那里没有发现任何帮助。

谢谢，马特

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-30T12:02:57.430

您是否尝试添加 --default-character-set=name 选项，如下所示：

```
mysql --default-character-set=utf8 -h ddd -u zzz -p dbname < dump.sql 
```

我之前遇到过这个问题，并且在使用该选项后它起作用了。

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T12:00:16.113

呃……好吧，看来我找到了解决办法。

MySQL 不是这里的罪魁祸首。我现在做了一个简单的转储和加载，没有更改 dump.sql 脚本——这意味着我保留了“设置名称 latin2”和表格字符集。然后我将原来的 CMSMS 安装切换到新数据库，然后……它工作正常。所以实际上在数据库中编码是可以的，或者至少它适用于我在旧托管服务提供商处安装的 CMSMS （CMSMS 显然[对字符编码做了一些有趣的事情](http://forum.cmsmadesimple.org/index.php/topic,21346.0.html)）。

为了让它在我的新托管服务提供商上运行，我实际上必须在 CMSMS 安装中将此行添加到 lib/adodb/drivers/adodb-mysql.inc.php 中：

```
mysql_query('设置名称 latin2',$this->_connectionID);
```

[这是来自这篇文章](http://gallery.menalto.com/node/36886)的稍微修改的解决方案。您也可以在那里找到确切的行。所以它看起来像mysql客户端配置问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-16T09:08:31.283

我的解决方案：

在您的 php 文件中设置此选项，在**mysql_connect**之后（或在**mysql_select_db**之后）..

```
mysql_query("SET NAMES 'utf8'"); 
```

# svn - svn + 存储库位置

> ID：152299
> 
> 赞同：0
> 
> 时间：2008-09-30T08:57:59.653
> 
> 标签：svn

我即将设置一个通过 svn+ssh 访问的颠覆服务器。我想知道*默认*存储库位置在哪里（在 unix 盒子上）。

你把它放进去吗

```
/opt/svn 
```

或者

```
/home/svn 
```

或者

```
/usr/subversion 
```

甚至

```
/svn 
```

或者别的地方？

我正在寻找这个地方，大多数人都会这样说。有约定吗？

编辑：

绝对有可能对用户“隐藏”实际的存储库位置。例如（在我的情况下）通过以如下`svnserve`方式包装可执行文件：

```
svnserve -r /var/svn/repos 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-30T09:41:55.570

我通常将存储库放在下面的某个地方`/var`，通常在`/var/lib/svn`- 我正在尝试遵循[文件系统层次结构标准](http://www.pathname.com/fhs/)，该标准说明了[/var 的目的](http://www.pathname.com/fhs/pub/fhs-2.3.html#PURPOSE31)：

`/var`在这里指定是为了能够以`/usr`只读方式挂载。在系统运行期间（与安装和软件维护相反）写入的所有内容都`/usr`必须在`/var`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T09:52:50.693

`/home/svn`在这里，主要是因为我认为在某些时候我可能需要一个`svn`用户......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T11:51:17.523

基于新的 FHS，您应该将“此系统提供的服务的数据”放入 /srv 目录。FHS 中没有任何其他指导，除了将所有服务数据放在该目录中，例如 http 等。我建议 /srv/svn/。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T16:15:10.977

就存储库的路径而言，我喜欢在其上分区并挂载一个名为存储库的目录；）

> /存储库

这样我可以使用“df”轻松检查大小

> 是否可以对用户隐藏绝对路径？

要回答这个问题，是的，但前提是他们没有完全访问该框的权限。您为他们设置了一个帐户，并让他们生成一个公钥/私钥来登录，但您从不给他们密码。

然后你将他们的密钥放入 /home/<_user>/.ssh/authorized_keys 并编辑设置，以便使用所述密钥登录启动 svn-serve。

```
command="/usr/local/bin/svnserve -t -r /repository/" 
```

现在在存储库中创建一个项目：

```
svnadmin create /repository/proj1 
```

使用 SVN，您必须授予用户对项目目录的读/写权限。然后他们可以查看如下代码：

```
svn co svn+ssh://host/proj1 
```

用户永远不会看到或知道存储库的绝对路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T09:53:55.540

它绝对应该在 /var 中。我把我的放在 /var/lib/svn 中。/opt 对于保留您可能不一定想要作为系统一部分的应用程序很有用，例如：Firefox 或 MySql。存储库不是应用程序，因此将其保存在 /opt 中没有意义。

和上面的评论一样，您可以参考[FHS](http://www.pathname.com/fhs/pub/fhs-2.3.html)

# tdd - NUnit怎么了？

> ID：152302
> 
> 赞同：0
> 
> 时间：2008-09-30T08:58:56.080
> 
> 标签：tdd, nunit

为什么这个项目不再维护了？我喜欢这个应用程序，但不更新它似乎是对所有 .Net 开发人员的犯罪。考虑到未来发布的机会，我很想添加几个项目。

有人可以分享我不知道的东西吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-30T09:04:09.453

NUnit 2.5 Alpha 4 Release 于 2008 年 9 月 14 日发布。

你认为16天没有维护吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T09:02:12.263

[http://nunit.org](http://nunit.org)显示最新版本是 2.4.8，于 2008 年 7 月 21 日发布。看起来它对我来说仍然是一个活跃的项目。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-09-30T09:05:45.190

你说的对。NUnit 是一个很棒的应用程序（或者更确切地说是一个系统）。

但由于它是一个开放的项目，每个人都有责任维护它。最初开始这项伟大工作的人可能有一些个人限制，阻止他们积极参与开发......

# asp.net - Google 404 和 .NET 自定义错误页面

> ID：152307
> 
> 赞同：9
> 
> 时间：2008-09-30T09:01:08.617
> 
> 标签：asp.net, http-status-code-404, google-widget

我有一个带有自定义 404 页面的 ASP.NET 2.0 网站。当未找到内容时，该站点将提供带有 aspxerrorpath=/mauro.aspx 的查询字符串添加的自定义 404 页面。404 页面本身的[HTTP](http://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)状态为 200。为了解决这个问题，我添加了

```
 protected void Page_Load(object sender, EventArgs e)
    {
        Response.StatusCode = 404;
    } 
```

我添加了 Google 小部件，但有两个问题。在[Internet Explorer 7](http://en.wikipedia.org/wiki/Internet_Explorer_7)中，它不显示它应该显示的位置。如果我将它添加到内容中，我会在 char 79 第 226 行或其附近收到“未知错误”；如果我将它添加到标题部分，搜索框会出现在内容上方。在 Firefox 中它运行良好。

所以我的问题是：

1.  如何使小部件内联显示？
2.  如何使用请求的文件的原始名称和路径使错误页面呈现为 404，以便在请求 mauro.aspx 时获得 404 页面的内容，但使用 mauro.aspx 的 URL？（我假设我必须在 begin_request global.asax 文件中进行一些[URL 重写](http://en.wikipedia.org/wiki/Rewrite_engine)，但希望在我做任何愚蠢的事情之前确认这一点。）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-30T09:31:23.130

ASP.NET 3.5 SP1 中有一个新的重定向模式，您现在可以使用它，因此它不会重定向。它显示错误页面，但保持 URL 相同：

“也适用于 URL 重定向。如果您在 web.config 中将 redirectMode 设置为“responseRewrite”，则可以避免重定向到自定义错误页面，并且保持浏览器中的 URL 不变。”

*   *[CustomErrorsSection.RedirectMode 属性](http://msdn.microsoft.com/en-us/library/system.web.configuration.customerrorssection.redirectmode.aspx)*(MSDN)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T09:25:18.997

我已经通过在 global.asax 文件中执行此操作来处理 404

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    string url = Request.RawUrl;
    if ((url.Contains(".aspx")) && (!System.IO.File.Exists(Server.MapPath(url))))
    {
        Server.Transfer("/Error/FileNotFound.aspx");
    }
} 
```

现在，如果有人可以帮助我使用 google 小部件，那就太好了！

# xml - XML 属性与元素

> ID：152313
> 
> 赞同：70
> 
> 时间：2008-09-30T09:03:10.220
> 
> 标签：xml, schema, modeling

什么时候应该使用 XML 属性，什么时候应该使用 XML 元素？

例如

```
<customData>
  <records>
    <record name="foo" description="bar" />
  </records>
</customData> 
```

或者

```
<customData>
  <records>
    <record>
      <name>foo</name>
      <description>bar</description>
    </record>
  </records>
</customData> 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-05T21:46:30.263

IBM 的网站上有一篇题为“ [XML 设计原则：何时使用元素与属性”的文章。](http://www.ibm.com/developerworks/xml/library/x-eleatt.html)

尽管似乎没有很多硬性规定，但帖子中提到了一些很好的指导方针。例如，当您的数据不能针对空白进行规范化时，建议之一是使用元素，因为 XML 处理器可以规范化属性内的数据，从而修改原始文本。

在开发各种 XML 结构时，我发现自己时常参考这篇文章。希望这对其他人也有帮助。

编辑 - 从网站：

**核心内容原则**

如果您认为所讨论的信息是在 XML 中表达或交流的基本材料的一部分，请将其放在一个元素中。对于人类可读的文档，这通常意味着正在传达给读者的核心内容。对于面向机器的记录格式，这通常意味着直接来自问题域的数据。如果您认为信息是主要通信的外围信息或附带信息，或者纯粹是为了帮助应用程序处理主要通信，请使用属性。这避免了核心内容与辅助材料的混乱。对于面向机器的记录格式，这通常意味着对来自问题域的主要数据的应用程序特定的符号。

例如，我见过许多 XML 格式，通常是企业内部开发的，其中文档标题放置在属性中。我认为标题是文档交流的基本组成部分，它应该始终包含在元素内容中。另一方面，我经常看到将内部产品标识符作为元素放入产品描述性记录中的情况。在其中一些情况下，属性更合适，因为特定的内部产品代码对于文档的大多数读者或处理者来说不是主要兴趣，尤其是当 ID 的格式非常长或难以理解时。

您可能听说过元素中的主要数据，属性中的元数据。上面两段确实表达了相同的原则，但语言更刻意，更少模糊。

**结构化信息原理**

如果信息以结构化的形式表达，特别是如果该结构是可扩展的，则使用元素。另一方面：如果信息表示为原子标记，则使用属性。元素是在 XML 中表达结构的可扩展引擎。几乎所有 XML 处理工具都是围绕这一事实设计的，如果您将结构化信息正确地分解为元素，您会发现您的处理工具补充了您的设计，从而提高了生产力和可维护性。属性旨在表达元素中表示的信息的简单属性。如果您通过将结构化信息硬塞到属性中来反对 XML 的基本体系结构，您可能会获得一些似是而非的简洁性和便利性，但您可能会付出维护成本。

日期就是一个很好的例子：日期具有固定的结构并且通常充当单个标记，因此它作为一个属性是有意义的（最好用 ISO-8601 表示）。另一方面，代表个人姓名是我看到这个原则让设计师感到惊讶的一个案例。我经常在属性中看到名称，但我一直认为个人名称应该出现在元素内容中。人名具有令人惊讶的可变结构（在某些文化中，您可能会通过省略敬语或假设名称部分的顺序而引起混淆或冒犯）。个人名字也很少是原子标记。例如，有时您可能希望按名字搜索或排序，有时按姓氏搜索或排序。我应该指出，将全名硬塞到单个元素的内容中与将其放入属性中一样有问题。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-30T09:06:54.873

我个人喜欢将属性用于简单的单值属性。元素（显然）更适合复杂类型或重复值。

对于单值属性，属性导致在大多数 API 中更紧凑的 XML 和更简单的寻址。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-05T21:26:35.173

更深思熟虑的元素与属性参数之一来自[英国 GovTalk 指南](https://web.archive.org/web/20090903101841/http://www.govtalk.gov.uk/documents/schema-guidelines-3_1(1).pdf)。这定义了用于与政府相关的 XML 交换的建模技术，但它有其自身的优点，值得考虑。

> 必须设计模式以使元素成为 XML 实例中信息内容的主要持有者。属性更适合保存辅助元数据——提供有关元素内容的更多信息的简单项目。属性不得用于限定可能导致歧义的其他属性。
> 
> 与元素不同，属性不能保存结构化数据。出于这个原因，元素被首选作为信息内容的主要持有者。但是，允许使用属性来保存有关元素内容的元数据（例如，日期的格式、度量单位或值集的标识）可以使实例文档更简单、更容易理解。
> 
> 出生日期可能在消息中表示为：

```
 <DateOfBirth>1975-06-03</DateOfBirth> 
```

> 但是，可能需要更多信息，例如如何验证该出生日期。这可以定义为一个属性，使消息中的元素看起来像：

```
<DateOfBirth VerifiedBy="View of Birth Certificate">1975-06-03</DateOfBirth> 
```

> 以下是不合适的：

```
<DateOfBirth VerifiedBy="View of Birth Certificate" ValueSet="ISO 8601" Code="2">1975-06-03</DateOfBirth> 
```

> 这里不清楚代码是限定 VerifiedBy 还是 ValueSet 属性。更合适的翻译是：

```
 <DateOfBirth>    
   <VerifiedBy Code="2">View of Birth Certificate</VerifiedBy>     
   <Value ValueSet="ISO 8601">1975-06-03</Value>
 </DateOfBirth> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-30T09:18:29.247

这在很大程度上是一个偏好问题。我尽可能使用元素进行分组和数据属性，因为我认为这比替代方案更紧凑。

比如我更喜欢......

```
<?xml version="1.0" encoding="utf-8"?>
<data>
    <people>
        <person name="Rory" surname="Becker" age="30" />
        <person name="Travis" surname="Illig" age="32" />
        <person name="Scott" surname="Hanselman" age="34" />
    </people>
</data> 
```

...代替....

```
<?xml version="1.0" encoding="utf-8"?>
<data>
    <people>
        <person>
            <name>Rory</name>
            <surname>Becker</surname>
            <age>30</age>
        </person>
        <person>
            <name>Travis</name>
            <surname>Illig</surname>
            <age>32</age>
        </person>
        <person>
            <name>Scott</name>
            <surname>Hanselman</surname>
            <age>34</age>
        </person>
    </people>
</data> 
```

但是，如果我的数据在 20-30 个字符内不容易表示或包含许多引号或其他需要转义的字符，那么我会说是时候分解元素了……可能使用 CData 块。

```
<?xml version="1.0" encoding="utf-8"?>
<data>
    <people>
        <person name="Rory" surname="Becker" age="30" >
            <comment>A programmer whose interested in all sorts of misc stuff. His Blog can be found at http://rorybecker.blogspot.com and he's on twitter as @RoryBecker</comment>
        </person>
        <person name="Travis" surname="Illig" age="32" >
            <comment>A cool guy for who has helped me out with all sorts of SVn information</comment>
        </person>
        <person name="Scott" surname="Hanselman" age="34" >
            <comment>Scott works for MS and has a great podcast available at http://www.hanselminutes.com </comment>
        </person>
    </people>
</data> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2011-08-04T11:53:11.977

作为一般规则，我完全避免使用属性。是的，属性更紧凑，但元素更灵活，而灵活性是使用 XML 等数据格式的最重要优势之一。今天是一个单一的价值，明天可以成为一个价值列表。

此外，如果一切都是元素，那么您永远不必记住您是如何对任何特定信息进行建模的。不使用属性意味着您需要考虑的事情更少。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-28T05:59:10.240

查看Ned Batchelder 的[元素与属性](http://nedbatchelder.com/blog/200412/elements_vs_attributes.html)。

很好的解释和元素和属性的优点和缺点的一个很好的列表。

他将其归结为：

> 建议：将元素用于将由业务应用程序生成或使用的数据，并将属性用于元数据。

重要提示：请参阅下面的@maryisdead 评论以获得进一步说明。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-01T00:28:58.980

属性的限制告诉您在哪里可以使用和不能使用它们：属性名称必须是唯一的，它们的顺序不能很重要，名称和值都只能包含文本。相比之下，元素可以有不唯一的名称，有重要的顺序，并且可以有混合的内容。

属性可用于映射到遵循这些规则的数据结构的域中：对象属性的名称和值、表行中的列、字典中的条目。（但如果属性不是所有值类型，或者字典中的条目不是字符串，则不是。）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-01-05T23:51:10.277

我个人的经验法则：如果一个元素只能包含其中一个，并且它是一个原子数据（id、名称、年龄、类型等），那么它应该是一个属性，否则就是一个元素。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-11T23:02:55.173

当它是人类读者需要知道的数据和仅用于处理时的属性（例如ID）时，我倾向于使用元素。这意味着我很少使用属性，因为大部分数据与正在建模的域相关。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-04-29T00:16:17.453

这是另一个有助于区分元素和属性的策略：考虑对象并牢记 MVC。

对象可以具有成员（对象变量）和属性（具有 setter 和 getter 的成员）。属性对于 MVC 设计非常有用，允许更改通知机制。

如果这是采用的方向，则属性将用于用户无法更改的内部应用程序数据；经典示例将是 ID 或 DATE_MODIFIED。因此，元素将用于用户可以修改的数据。

因此，考虑到图书馆员首先添加图书项目（或杂志），然后可以编辑其名称作者 ISBN 等，以下内容是有意义的：

```
<?xml version="1.0" encoding="utf-8"?>
<item id="69" type="book">
    <authors count="1">
        <author>
            <name>John Smith</name>
        <author>
    </authors>
    <ISBN>123456790</ISBN>
</item> 
```

# excel - 如何从宏的菜单栏中捕获“打印”按钮

> ID：152314
> 
> 赞同：3
> 
> 时间：2008-09-30T09:03:35.693
> 
> 标签：excel, printing, vba

我有一张纸，上面有一个自定义按钮，我可以从中控制打印过程。

现在用户点击菜单栏的打印图标，这会产生一个“未定义”的输出。

如何拦截此菜单栏按钮？

*   谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T09:33:24.250

处理 Workbook_BeforePrint 事件。

```
private sub Workbook_BeforePrint (cancel as boolean)
  '//g_MyFlag is set when the user clicks you toolbar button.
  '//It must get cleared in the end of your procedure.
  if not g_MyFlag then cancel = true: exit sub

end sub 
```

在 MS Word 中，也可以重新定义系统宏本身。您必须创建一个名为 的宏`FilePrint()`，Word 会将其称为自己的。可惜你不能在 Excel 中做到这一点。

# c++ - 学习 C++ 模板

> ID：152318
> 
> 赞同：17
> 
> 时间：2008-09-30T09:05:50.727
> 
> 标签：c++, templates

任何人都可以推荐任何学习 C++ 模板的好资源吗？

非常感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-30T09:10:28.203

我建议您获得[C++ 模板 - 完整指南](http://www.josuttis.com/tmplbook/)，它是一个极好的资源和参考。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-30T09:17:10.793

我发现[cplusplus.com](http://www.cplusplus.com/)在很多场合都很有帮助。看起来他们对[模板有很好的介绍。](http://www.cplusplus.com/doc/tutorial/templates.html)

如果您正在寻找一本真正的书，[Effective C++](https://rads.stackoverflow.com/amzn/click/com/0321334876)是一本经典之作，其中有很多关于模板的部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-30T09:10:38.237

这是一本更高级但非常有用的关于模板和模板使用的书。

[现代 C++ 设计](https://rads.stackoverflow.com/amzn/click/com/0201704315)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-30T09:20:03.453

Bruce Eckel 的[Thinking in C++](http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html)是我学习模板的方式。第一卷有一个介绍性章节，第二卷有一个关​​于模板的深入章节。

Bjarne Stroustrop 的[The C++ Programming Language](https://rads.stackoverflow.com/amzn/click/com/0201889544)对它们有很好的一章。还有[C++ 标准库：](https://rads.stackoverflow.com/amzn/click/com/0201379260)关于标准库的教程和参考，但肯定会帮助您更好地了解如何在现实世界中使用模板。.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-30T09:12:32.537

一定要区分泛型编程和模板元编程（这更像是另一种范式）

泛型编程可以从[C++ 圣经](http://www.research.att.com/~bs/3rd.html)中学习，但你也可以看看 java 泛型等...

一篇关于元编程的文章：Josuttis 的书[C++ Templates: The Complete Guide](http://www.josuttis.com/tmplbook/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-30T09:20:31.223

两卷“Thinking in C++”介绍了模板的基础知识。它们可以在印刷版中购买，也可以在[此处](http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html)免费（合法）下载使用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T09:35:32.887

Bjarne Stroustrop 的“C++ 编程语言”

# arrays - VBA数组排序功能？

> ID：152319
> 
> 赞同：94
> 
> 时间：2008-09-30T09:06:04.907
> 
> 标签：arrays, sorting, vba, vb6, ms-project

我正在为 VBA 中的数组寻找一个不错的排序实现。首选快速排序。或者除了冒泡或合并之外的任何其他[排序算法](http://web.archive.org/web/20180224071555/http://www.cs.ubc.ca:80/~harrison/Java/sorting-demo.html)就足够了。

请注意，这适用于 MS Project 2003，因此应避免使用任何 Excel 本地函数和任何与 .net 相关的内容。

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2008-09-30T09:10:21.027

~~看看[这里](http://en.allexperts.com/q/Visual-Basic-1048/string-manipulation.htm)：~~
**编辑：** 引用的来源（allexperts.com）已经关闭，但这里是相关[作者](https://web.archive.org/web/20090629091145/http://www.allexperts.com:80/ep/1048-18393/Visual-Basic/Robert-Nunemaker.htm)的评论：

> 网络上有许多算法可用于排序。最通用且通常最快的是快速[**排序算法**](https://en.wikipedia.org/wiki/Quicksort)。下面是它的一个函数。
> 
> **只需通过数组下边界**（通常是`0`）和**数组上边界**（即`UBound(myArray)`.）传递一个值数组（字符串或数字；没关系）来调用它
> 
> ***示例***：`Call QuickSort(myArray, 0, UBound(myArray))`
> 
> 完成后，`myArray`将对其进行排序，您可以使用它做任何您想做的事情。
> [（来源：[archive.org](https://web.archive.org/web/20090621095100/http://en.allexperts.com:80/q/Visual-Basic-1048/string-manipulation.htm)）]

```
Public Sub QuickSort(vArray As Variant, inLow As Long, inHi As Long)
  Dim pivot   As Variant
  Dim tmpSwap As Variant
  Dim tmpLow  As Long
  Dim tmpHi   As Long

  tmpLow = inLow
  tmpHi = inHi

  pivot = vArray((inLow + inHi) \ 2)

  While (tmpLow <= tmpHi)
     While (vArray(tmpLow) < pivot And tmpLow < inHi)
        tmpLow = tmpLow + 1
     Wend

     While (pivot < vArray(tmpHi) And tmpHi > inLow)
        tmpHi = tmpHi - 1
     Wend

     If (tmpLow <= tmpHi) Then
        tmpSwap = vArray(tmpLow)
        vArray(tmpLow) = vArray(tmpHi)
        vArray(tmpHi) = tmpSwap
        tmpLow = tmpLow + 1
        tmpHi = tmpHi - 1
     End If
  Wend

  If (inLow < tmpHi) Then QuickSort vArray, inLow, tmpHi
  If (tmpLow < inHi) Then QuickSort vArray, tmpLow, inHi
End Sub 
```

请注意，这只适用于**一维**（又名“正常”？）数组。（这里有一个有效的多维数组 QuickSort [。](https://stackoverflow.com/a/5104206/8112776)）

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-12-03T16:37:58.760

如果其他人想要的话，我将“快速快速排序”算法转换为 VBA。

我对其进行了优化以在 Int/Longs 数组上运行，但将其转换为适用于任意可比较元素的应该很简单。

```
Private Sub QuickSort(ByRef a() As Long, ByVal l As Long, ByVal r As Long)
    Dim M As Long, i As Long, j As Long, v As Long
    M = 4

    If ((r - l) > M) Then
        i = (r + l) / 2
        If (a(l) > a(i)) Then swap a, l, i '// Tri-Median Methode!'
        If (a(l) > a(r)) Then swap a, l, r
        If (a(i) > a(r)) Then swap a, i, r

        j = r - 1
        swap a, i, j
        i = l
        v = a(j)
        Do
            Do: i = i + 1: Loop While (a(i) < v)
            Do: j = j - 1: Loop While (a(j) > v)
            If (j < i) Then Exit Do
            swap a, i, j
        Loop
        swap a, i, r - 1
        QuickSort a, l, j
        QuickSort a, i + 1, r
    End If
End Sub

Private Sub swap(ByRef a() As Long, ByVal i As Long, ByVal j As Long)
    Dim T As Long
    T = a(i)
    a(i) = a(j)
    a(j) = T
End Sub

Private Sub InsertionSort(ByRef a(), ByVal lo0 As Long, ByVal hi0 As Long)
    Dim i As Long, j As Long, v As Long

    For i = lo0 + 1 To hi0
        v = a(i)
        j = i
        Do While j > lo0
            If Not a(j - 1) > v Then Exit Do
            a(j) = a(j - 1)
            j = j - 1
        Loop
        a(j) = v
    Next i
End Sub

Public Sub sort(ByRef a() As Long)
    QuickSort a, LBound(a), UBound(a)
    InsertionSort a, LBound(a), UBound(a)
End Sub 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-07-28T17:42:23.340

```
Dim arr As Object
Dim InputArray

'Creating a array list
Set arr = CreateObject("System.Collections.ArrayList")

'String
InputArray = Array("d", "c", "b", "a", "f", "e", "g")

'number
'InputArray = Array(6, 5, 3, 4, 2, 1)

' adding the elements in the array to array_list
For Each element In InputArray
    arr.Add element
Next

'sorting happens
arr.Sort

'Converting ArrayList to an array
'so now a sorted array of elements is stored in the array sorted_array.

sorted_array = arr.toarray 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-09-30T09:12:24.517

[用德语解释](http://www.activevb.de/tipps/vb6tipps/tipp0188.html)，但代码是经过充分测试的就地实现：

```
Private Sub QuickSort(ByRef Field() As String, ByVal LB As Long, ByVal UB As Long)
    Dim P1 As Long, P2 As Long, Ref As String, TEMP As String

    P1 = LB
    P2 = UB
    Ref = Field((P1 + P2) / 2)

    Do
        Do While (Field(P1) < Ref)
            P1 = P1 + 1
        Loop

        Do While (Field(P2) > Ref)
            P2 = P2 - 1
        Loop

        If P1 <= P2 Then
            TEMP = Field(P1)
            Field(P1) = Field(P2)
            Field(P2) = TEMP

            P1 = P1 + 1
            P2 = P2 - 1
        End If
    Loop Until (P1 > P2)

    If LB < P2 Then Call QuickSort(Field, LB, P2)
    If P1 < UB Then Call QuickSort(Field, P1, UB)
End Sub 
```

像这样调用：

```
Call QuickSort(MyArray, LBound(MyArray), UBound(MyArray)) 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-10-16T22:47:29.497

**自然数（字符串）快速排序**

只是为了进入主题。通常，如果您使用数字对字符串进行排序，您会得到如下结果：

```
 Text1
    Text10
    Text100
    Text11
    Text2
    Text20 
```

但是您真的希望它能够识别数值并进行排序

```
 Text1
    Text2
    Text10
    Text11
    Text20
    Text100 
```

这是如何做到的......

笔记：

*   我很久以前从互联网上偷了快速排序，现在不知道在哪里......
*   我也从网上翻译了最初用 C 语言编写的 CompareNaturalNum 函数。
*   与其他 Q-Sort 的区别：如果 BottomTemp = TopTemp，我不会交换值

**自然数快速排序**

```
Public Sub QuickSortNaturalNum(strArray() As String, intBottom As Integer, intTop As Integer)
Dim strPivot As String, strTemp As String
Dim intBottomTemp As Integer, intTopTemp As Integer

    intBottomTemp = intBottom
    intTopTemp = intTop

    strPivot = strArray((intBottom + intTop) \ 2)

    Do While (intBottomTemp <= intTopTemp)
        ' < comparison of the values is a descending sort
        Do While (CompareNaturalNum(strArray(intBottomTemp), strPivot) < 0 And intBottomTemp < intTop)
            intBottomTemp = intBottomTemp + 1
        Loop
        Do While (CompareNaturalNum(strPivot, strArray(intTopTemp)) < 0 And intTopTemp > intBottom) '
            intTopTemp = intTopTemp - 1
        Loop
        If intBottomTemp < intTopTemp Then
            strTemp = strArray(intBottomTemp)
            strArray(intBottomTemp) = strArray(intTopTemp)
            strArray(intTopTemp) = strTemp
        End If
        If intBottomTemp <= intTopTemp Then
            intBottomTemp = intBottomTemp + 1
            intTopTemp = intTopTemp - 1
        End If
    Loop

    'the function calls itself until everything is in good order
    If (intBottom < intTopTemp) Then QuickSortNaturalNum strArray, intBottom, intTopTemp
    If (intBottomTemp < intTop) Then QuickSortNaturalNum strArray, intBottomTemp, intTop
End Sub 
```

**自然数比较（用于快速排序）**

```
Function CompareNaturalNum(string1 As Variant, string2 As Variant) As Integer
'string1 is less than string2 -1
'string1 is equal to string2 0
'string1 is greater than string2 1
Dim n1 As Long, n2 As Long
Dim iPosOrig1 As Integer, iPosOrig2 As Integer
Dim iPos1 As Integer, iPos2 As Integer
Dim nOffset1 As Integer, nOffset2 As Integer

    If Not (IsNull(string1) Or IsNull(string2)) Then
        iPos1 = 1
        iPos2 = 1
        Do While iPos1 <= Len(string1)
            If iPos2 > Len(string2) Then
                CompareNaturalNum = 1
                Exit Function
            End If
            If isDigit(string1, iPos1) Then
                If Not isDigit(string2, iPos2) Then
                    CompareNaturalNum = -1
                    Exit Function
                End If
                iPosOrig1 = iPos1
                iPosOrig2 = iPos2
                Do While isDigit(string1, iPos1)
                    iPos1 = iPos1 + 1
                Loop

                Do While isDigit(string2, iPos2)
                    iPos2 = iPos2 + 1
                Loop

                nOffset1 = (iPos1 - iPosOrig1)
                nOffset2 = (iPos2 - iPosOrig2)

                n1 = Val(Mid(string1, iPosOrig1, nOffset1))
                n2 = Val(Mid(string2, iPosOrig2, nOffset2))

                If (n1 < n2) Then
                    CompareNaturalNum = -1
                    Exit Function
                ElseIf (n1 > n2) Then
                    CompareNaturalNum = 1
                    Exit Function
                End If

                ' front padded zeros (put 01 before 1)
                If (n1 = n2) Then
                    If (nOffset1 > nOffset2) Then
                        CompareNaturalNum = -1
                        Exit Function
                    ElseIf (nOffset1 < nOffset2) Then
                        CompareNaturalNum = 1
                        Exit Function
                    End If
                End If
            ElseIf isDigit(string2, iPos2) Then
                CompareNaturalNum = 1
                Exit Function
            Else
                If (Mid(string1, iPos1, 1) < Mid(string2, iPos2, 1)) Then
                    CompareNaturalNum = -1
                    Exit Function
                ElseIf (Mid(string1, iPos1, 1) > Mid(string2, iPos2, 1)) Then
                    CompareNaturalNum = 1
                    Exit Function
                End If

                iPos1 = iPos1 + 1
                iPos2 = iPos2 + 1
            End If
        Loop
        ' Everything was the same so far, check if Len(string2) > Len(String1)
        ' If so, then string1 < string2
        If Len(string2) > Len(string1) Then
            CompareNaturalNum = -1
            Exit Function
        End If
    Else
        If IsNull(string1) And Not IsNull(string2) Then
            CompareNaturalNum = -1
            Exit Function
        ElseIf IsNull(string1) And IsNull(string2) Then
            CompareNaturalNum = 0
            Exit Function
        ElseIf Not IsNull(string1) And IsNull(string2) Then
            CompareNaturalNum = 1
            Exit Function
        End If
    End If
End Function 
```

**isDigit（用于 CompareNaturalNum）**

```
Function isDigit(ByVal str As String, pos As Integer) As Boolean
Dim iCode As Integer
    If pos <= Len(str) Then
        iCode = Asc(Mid(str, pos, 1))
        If iCode >= 48 And iCode <= 57 Then isDigit = True
    End If
End Function 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2011-02-24T12:23:30.290

我发布了一些代码来回答 StackOverflow 上的相关问题：

[在 VBA 中对多维数组进行排序](https://stackoverflow.com/questions/4873182/sorting-a-multidimensional-array-in-vba/5104206#5104206)

该线程中的代码示例包括：

1.  一个向量数组快速排序；
2.  一个多列数组 QuickSort；
3.  冒泡排序。

Alain 优化的快速排序非常闪亮：我刚刚做了一个基本的拆分和递归，但上面的代码示例有一个“门控”功能，可以减少重复值的冗余比较。另一方面，我为 Excel 编写代码，并且还有更多防御性编码方式 - 请注意，如果您的数组包含有害的“Empty()”变体，您将需要它，这会破坏您的 While.. . 使用比较运算符并将您的代码陷入无限循环。

请注意，快速排序算法 - 以及任何递归算法 - 可能会填满堆栈并导致 Excel 崩溃。如果您的数组的成员少于 1024 个，我会使用基本的 BubbleSort。

```
Public Sub QuickSortArray(ByRef SortArray As Variant, _
                                可选 lngMin As Long = -1, _
                                可选 lngMax As Long = -1, _
                                可选 lngColumn As Long = 0)
On Error Resume Next 

'对二维数组进行排序

' 示例用法：按第 3 列的内容对 arrData 进行排序
'
' 快速排序数组 arrData, , , 3

'
'由 Jim Rech 发表于 10/20/98 Excel.Programming 

'修改，Nigel Heffernan：

' ' 转义失败与空变体的比较
' ' 防御性编码：检查输入

暗淡我只要
暗淡 j 只要
将 varMid 调暗为变体
将 arrRowTemp 调暗为变体
将 lngColTemp 调暗

 If IsEmpty(SortArray) 那么
     退出子
 万一

 If InStr(TypeName(SortArray), "()") < 1 Then 'IsArray() 有点坏：在类型名称中查找括号
     退出子
 万一

 如果 lngMin = -1 那么
     lngMin = LBound(SortArray, 1)
 万一

 如果 lngMax = -1 那么
     lngMax = UBound(SortArray, 1)
 万一

 If lngMin >= lngMax Then ' 不需要排序
     退出子
 万一

 i = lngMin
 j = lngMax

 varMid = 空
 varMid = SortArray((lngMin + lngMax) \ 2, lngColumn)

 ' 我们将“空”和无效数据项发送到列表末尾：
 If IsObject(varMid) Then ' 请注意，我们不检查 isObject(SortArray(n)) - varMid*可能会*选择一个有效的默认成员或属性
     i = lngMax
     j = lngMin
 ElseIf IsEmpty(varMid) Then
     i = lngMax
     j = lngMin
 ElseIf IsNull(varMid) Then
     i = lngMax
     j = lngMin
 ElseIf varMid = "" 那么
     i = lngMax
     j = lngMin
 ElseIf varType(varMid) = vbError Then
     i = lngMax
     j = lngMin
 ElseIf varType(varMid) > 17 那么
     i = lngMax
     j = lngMin
 如果

 当 i <= j 时结束

     虽然 SortArray(i, lngColumn) < varMid And i < lngMax
         我 = 我 + 1
     文德

     而 varMid < SortArray(j, lngColumn) 和 j > lngMin
         j = j - 1
     如果

     i <= j 则

         ' 交换行
         ReDim arrRowTemp(LBound(SortArray, 2) 到 UBound(SortArray, 2))
         对于 lngColTemp = LBound(SortArray, 2) 到 UBound(SortArray, 2)
             arrRowTemp(lngColTemp) = SortArray(i, lngColTemp)
             SortArray(i, lngColTemp) = SortArray(j, lngColTemp)
             SortArray(j, lngColTemp) = arrRowTemp(lngColTemp)
         下一个 lngColTemp
         擦除 arrRowTemp

         我 = 我 + 1
         j = j - 1 

     End If 

 Wend

 If (lngMin < j) Then 调用 QuickSortArray(SortArray, lngMin, j, lngColumn)
 If (i < lngMax) Then Call QuickSortArray(SortArray, i, lngMax, lngColumn) 

End Sub

```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-25T11:12:53.773

您不想要基于 Excel 的解决方案，但由于我今天遇到了同样的问题并想使用其他 Office 应用程序功能进行测试，所以我编写了下面的功能。

限制：

*   二维数组；
*   最多 3 列作为排序键；
*   取决于 Excel；

测试从 Visio 2010 调用 Excel 2010

* * *

```
Option Base 1

Private Function sort_array_2D_excel(array_2D, array_sortkeys, Optional array_sortorders, Optional tag_header As String = "Guess", Optional tag_matchcase As String = "False")

'   Dependencies: Excel; Tools > References > Microsoft Excel [Version] Object Library

    Dim excel_application As Excel.Application
    Dim excel_workbook As Excel.Workbook
    Dim excel_worksheet As Excel.Worksheet

    Set excel_application = CreateObject("Excel.Application")

    excel_application.Visible = True
    excel_application.ScreenUpdating = False
    excel_application.WindowState = xlNormal

    Set excel_workbook = excel_application.Workbooks.Add
    excel_workbook.Activate

    Set excel_worksheet = excel_workbook.Worksheets.Add
    excel_worksheet.Activate
    excel_worksheet.Visible = xlSheetVisible

    Dim excel_range As Excel.Range
    Set excel_range = excel_worksheet.Range("A1").Resize(UBound(array_2D, 1) - LBound(array_2D, 1) + 1, UBound(array_2D, 2) - LBound(array_2D, 2) + 1)
    excel_range = array_2D

    For i_sortkey = LBound(array_sortkeys) To UBound(array_sortkeys)

        If IsNumeric(array_sortkeys(i_sortkey)) Then
            sortkey_range = Chr(array_sortkeys(i_sortkey) + 65 - 1) & "1"
            Set array_sortkeys(i_sortkey) = excel_worksheet.Range(sortkey_range)

        Else
            MsgBox "Error in sortkey parameter:" & vbLf & "array_sortkeys(" & i_sortkey & ") = " & array_sortkeys(i_sortkey) & vbLf & "Terminating..."
            End

        End If

    Next i_sortkey

    For i_sortorder = LBound(array_sortorders) To UBound(array_sortorders)
        Select Case LCase(array_sortorders(i_sortorder))
            Case "asc"
                array_sortorders(i_sortorder) = XlSortOrder.xlAscending
            Case "desc"
                array_sortorders(i_sortorder) = XlSortOrder.xlDescending
            Case Else
                array_sortorders(i_sortorder) = XlSortOrder.xlAscending
        End Select
    Next i_sortorder

    Select Case LCase(tag_header)
        Case "yes"
            tag_header = Excel.xlYes
        Case "no"
            tag_header = Excel.xlNo
        Case "guess"
            tag_header = Excel.xlGuess
        Case Else
            tag_header = Excel.xlGuess
    End Select

    Select Case LCase(tag_matchcase)
        Case "true"
            tag_matchcase = True
        Case "false"
            tag_matchcase = False
        Case Else
            tag_matchcase = False
    End Select

    Select Case (UBound(array_sortkeys) - LBound(array_sortkeys) + 1)
        Case 1
            Call excel_range.Sort(Key1:=array_sortkeys(1), Order1:=array_sortorders(1), Header:=tag_header, MatchCase:=tag_matchcase)
        Case 2
            Call excel_range.Sort(Key1:=array_sortkeys(1), Order1:=array_sortorders(1), Key2:=array_sortkeys(2), Order2:=array_sortorders(2), Header:=tag_header, MatchCase:=tag_matchcase)
        Case 3
            Call excel_range.Sort(Key1:=array_sortkeys(1), Order1:=array_sortorders(1), Key2:=array_sortkeys(2), Order2:=array_sortorders(2), Key3:=array_sortkeys(3), Order3:=array_sortorders(3), Header:=tag_header, MatchCase:=tag_matchcase)
        Case Else
            MsgBox "Error in sortkey parameter:" & vbLf & "Maximum number of sort columns is 3!" & vbLf & "Currently passed: " & (UBound(array_sortkeys) - LBound(array_sortkeys) + 1)
            End
    End Select

    For i_row = 1 To excel_range.Rows.Count

        For i_column = 1 To excel_range.Columns.Count

            array_2D(i_row, i_column) = excel_range(i_row, i_column)

        Next i_column

    Next i_row

    excel_workbook.Close False
    excel_application.Quit

    Set excel_worksheet = Nothing
    Set excel_workbook = Nothing
    Set excel_application = Nothing

    sort_array_2D_excel = array_2D

End Function 
```

* * *

## 这是一个关于如何测试函数的示例：

```
Private Sub test_sort()

    array_unsorted = dim_sort_array()

    Call msgbox_array(array_unsorted)

    array_sorted = sort_array_2D_excel(array_unsorted, Array(2, 1, 3), Array("desc", "", "asdas"), "yes", "False")

    Call msgbox_array(array_sorted)

End Sub

Private Function dim_sort_array()

    Dim array_unsorted(1 To 5, 1 To 3) As String

    i_row = 0

    i_row = i_row + 1
    array_unsorted(i_row, 1) = "Column1": array_unsorted(i_row, 2) = "Column2": array_unsorted(i_row, 3) = "Column3"

    i_row = i_row + 1
    array_unsorted(i_row, 1) = "OR": array_unsorted(i_row, 2) = "A": array_unsorted(i_row, 3) = array_unsorted(i_row, 1) & "_" & array_unsorted(i_row, 2)

    i_row = i_row + 1
    array_unsorted(i_row, 1) = "XOR": array_unsorted(i_row, 2) = "A": array_unsorted(i_row, 3) = array_unsorted(i_row, 1) & "_" & array_unsorted(i_row, 2)

    i_row = i_row + 1
    array_unsorted(i_row, 1) = "NOT": array_unsorted(i_row, 2) = "B": array_unsorted(i_row, 3) = array_unsorted(i_row, 1) & "_" & array_unsorted(i_row, 2)

    i_row = i_row + 1
    array_unsorted(i_row, 1) = "AND": array_unsorted(i_row, 2) = "A": array_unsorted(i_row, 3) = array_unsorted(i_row, 1) & "_" & array_unsorted(i_row, 2)

    dim_sort_array = array_unsorted

End Function

Sub msgbox_array(array_2D, Optional string_info As String = "2D array content:")

    msgbox_string = string_info & vbLf

    For i_row = LBound(array_2D, 1) To UBound(array_2D, 1)

        msgbox_string = msgbox_string & vbLf & i_row & vbTab

        For i_column = LBound(array_2D, 2) To UBound(array_2D, 2)

            msgbox_string = msgbox_string & array_2D(i_row, i_column) & vbTab

        Next i_column

    Next i_row

    MsgBox msgbox_string

End Sub 
```

* * *

如果有人使用其他版本的 office 对此进行测试，如果有任何问题，请在此处发布。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-11-17T11:22:25.917

我想知道你对这个数组排序代码有什么看法。它的实施速度很快，并且可以完成工作……尚未针对大型阵列进行测试。它适用于一维数组，对于多维附加值，需要构建重新定位矩阵（比初始数组少一维）。

```
 For AR1 = LBound(eArray, 1) To UBound(eArray, 1)
            eValue = eArray(AR1)
            For AR2 = LBound(eArray, 1) To UBound(eArray, 1)
                If eArray(AR2) < eValue Then
                    eArray(AR1) = eArray(AR2)
                    eArray(AR2) = eValue
                    eValue = eArray(AR1)
                End If
            Next AR2
        Next AR1 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-09-18T15:30:26.317

@Prasand Kumar，这是一个基于 Prasand 概念的完整排序例程：

```
Public Sub ArrayListSort(ByRef SortArray As Variant)
    '
    'Uses the sort capabilities of a System.Collections.ArrayList object to sort an array of values of any simple
    'data-type.
    '
    'AUTHOR: Peter Straton
    '
    'CREDIT: Derived from Prasand Kumar's post at: https://stackoverflow.com/questions/152319/vba-array-sort-function
    '
    '*************************************************************************************************************

    Static ArrayListObj As Object
    Dim i As Long
    Dim LBnd As Long
    Dim UBnd As Long

    LBnd = LBound(SortArray)
    UBnd = UBound(SortArray)

    'If necessary, create the ArrayList object, to be used to sort the specified array's values

    If ArrayListObj Is Nothing Then
        Set ArrayListObj = CreateObject("System.Collections.ArrayList")
    Else
        ArrayListObj.Clear  'Already allocated so just clear any old contents
    End If

    'Add the ArrayList elements from the array of values to be sorted. (There appears to be no way to do this
    'using a single assignment statement.)

    For i = LBnd To UBnd
        ArrayListObj.Add SortArray(i)
    Next i

    ArrayListObj.Sort   'Do the sort

    'Transfer the sorted ArrayList values back to the original array, which can be done with a single assignment
    'statement.  But the result is always zero-based so then, if necessary, adjust the resulting array to match
    'its original index base.

    SortArray = ArrayListObj.ToArray
    If LBnd <> 0 Then ReDim Preserve SortArray(LBnd To UBnd)
End Sub 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-12T22:22:50.947

这就是我用来在内存中排序的东西——它可以很容易地扩展来对数组进行排序。

```
Sub sortlist()

    Dim xarr As Variant
    Dim yarr As Variant
    Dim zarr As Variant

    xarr = Sheets("sheet").Range("sing col range")
    ReDim yarr(1 To UBound(xarr), 1 To 1)
    ReDim zarr(1 To UBound(xarr), 1 To 1)

    For n = 1 To UBound(xarr)
        zarr(n, 1) = 1
    Next n

    For n = 1 To UBound(xarr) - 1
        y = zarr(n, 1)
        For a = n + 1 To UBound(xarr)
            If xarr(n, 1) > xarr(a, 1) Then
                y = y + 1
            Else
                zarr(a, 1) = zarr(a, 1) + 1
            End If
        Next a
        yarr(y, 1) = xarr(n, 1)
    Next n

    y = zarr(UBound(xarr), 1)
    yarr(y, 1) = xarr(UBound(xarr), 1)

    yrng = "A1:A" & UBound(yarr)
    Sheets("sheet").Range(yrng) = yarr

End Sub 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-27T04:26:20.687

我认为我的代码（经过测试）更“受过教育”，假设*越简单越好*。

```
Option Base 1

'Function to sort an array decscending
Function SORT(Rango As Range) As Variant
    Dim check As Boolean
    check = True
    If IsNull(Rango) Then
        check = False
    End If
    If check Then
        Application.Volatile
        Dim x() As Variant, n As Double, m As Double, i As Double, j As Double, k As Double
        n = Rango.Rows.Count: m = Rango.Columns.Count: k = n * m
        ReDim x(n, m)
        For i = 1 To n Step 1
            For j = 1 To m Step 1
                x(i, j) = Application.Large(Rango, k)
                k = k - 1
            Next j
        Next i
        SORT = x
    Else
        Exit Function
    End If
End Function 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-20T15:26:47.203

[堆排序](https://en.wikipedia.org/wiki/Heapsort)实现。一个 O(n log(n))（平均和最坏情况），就地[不稳定](https://en.wikipedia.org/wiki/Sorting_algorithm#Stability)的排序算法。

与: 一起使用`Call HeapSort(A)`，其中`A`是变体的一维数组，与`Option Base 1`.

```
Sub SiftUp(A() As Variant, I As Long)
    Dim K As Long, P As Long, S As Variant
    K = I
    While K > 1
        P = K \ 2
        If A(K) > A(P) Then
            S = A(P): A(P) = A(K): A(K) = S
            K = P
        Else
            Exit Sub
        End If
    Wend
End Sub

Sub SiftDown(A() As Variant, I As Long)
    Dim K As Long, L As Long, S As Variant
    K = 1
    Do
        L = K + K
        If L > I Then Exit Sub
        If L + 1 <= I Then
            If A(L + 1) > A(L) Then L = L + 1
        End If
        If A(K) < A(L) Then
            S = A(K): A(K) = A(L): A(L) = S
            K = L
        Else
            Exit Sub
        End If
    Loop
End Sub

Sub HeapSort(A() As Variant)
    Dim N As Long, I As Long, S As Variant
    N = UBound(A)
    For I = 2 To N
        Call SiftUp(A, I)
    Next I
    For I = N To 2 Step -1
        S = A(I): A(I) = A(1): A(1) = S
        Call SiftDown(A, I - 1)
    Next
End Sub 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-02-09T22:34:58.677

有点相关，但我也在寻找本机 excel VBA 解决方案，因为高级数据结构（字典等）在我的环境中不起作用。下面通过 VBA 中的二叉树实现排序：

*   假设数组被一一填充
*   **删除重复项**
*   `"0|2|3|4|9"`返回一个可拆分的分隔字符串 ( )。

我用它来返回为任意选择的范围选择的行的原始排序枚举

```
Private Enum LeafType: tEMPTY: tTree: tValue: End Enum
Private Left As Variant, Right As Variant, Center As Variant
Private LeftType As LeafType, RightType As LeafType, CenterType As LeafType
Public Sub Add(x As Variant)
    If CenterType = tEMPTY Then
        Center = x
        CenterType = tValue
    ElseIf x > Center Then
        If RightType = tEMPTY Then
            Right = x
            RightType = tValue
        ElseIf RightType = tTree Then
            Right.Add x
        ElseIf x <> Right Then
            curLeaf = Right
            Set Right = New TreeList
            Right.Add curLeaf
            Right.Add x
            RightType = tTree
        End If
    ElseIf x < Center Then
        If LeftType = tEMPTY Then
            Left = x
            LeftType = tValue
        ElseIf LeftType = tTree Then
            Left.Add x
        ElseIf x <> Left Then
            curLeaf = Left
            Set Left = New TreeList
            Left.Add curLeaf
            Left.Add x
            LeftType = tTree
        End If
    End If
End Sub
Public Function GetList$()
    Const sep$ = "|"
    If LeftType = tValue Then
        LeftList$ = Left & sep
    ElseIf LeftType = tTree Then
        LeftList = Left.GetList & sep
    End If
    If RightType = tValue Then
        RightList$ = sep & Right
    ElseIf RightType = tTree Then
        RightList = sep & Right.GetList
    End If
    GetList = LeftList & Center & RightList
End Function

'Sample code
Dim Tree As new TreeList
Tree.Add("0")
Tree.Add("2")
Tree.Add("2")
Tree.Add("-1")
Debug.Print Tree.GetList() 'prints "-1|0|2"
sortedList = Split(Tree.GetList(),"|") 
```

# windows - 从 Windows 脚本发送邮件

> ID：152323
> 
> 赞同：11
> 
> 时间：2008-09-30T09:08:05.497
> 
> 标签：windows, email, scripting, smtp, wsh

我想从 Windows Server 2003 标准版上的脚本发送邮件。我认为服务器设置几乎是开箱即用的。

邮件服务器是一台 Exchange，当您在内部网络上时，您可以使用普通的旧 SMTP。我已经在我的机器上使用 Perl 完成了它，但不幸的是 Perl 在服务器上不可用。

有没有一种简单的方法可以从 .bat 文件或任何其他不需要安装一些额外软件的方式来做到这一点？

`Edit:`
感谢您的快速回复。“blat” thingie 可能会正常工作，但使用 wscript 我不必使用单独的二进制文件。

第一次编辑并选择答案时，我没有看到 PhiLho 的帖子。我不需要在这里复制代码。

只需将脚本保存到一个文件中，比如 sendmail.vbs，然后从命令提示符处调用它，如下所示：
`wscript sendmail.vbs`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-30T09:45:17.310

使用 CDO 可以使用 Wscript：

```
Dim objMail

Set objMail = CreateObject("CDO.Message")

objMail.From = "Me <Me@Server.com>"
objMail.To = "You <You@AnotherServer.com>"
objMail.Subject = "That's a mail"
objMail.Textbody = "Hello World"
objMail.AddAttachment "C:\someFile.ext"

---8<----- You don't need this part if you have an active Outlook [Express] account -----
' Use an SMTP server
objMail.Configuration.Fields.Item _
    ("http://schemas.microsoft.com/cdo/configuration/sendusing") = 2

' Name or IP of Remote SMTP Server
objMail.Configuration.Fields.Item _
    ("http://schemas.microsoft.com/cdo/configuration/smtpserver") = _
    "smtp.server.com"

' Server port (typically 25)
objMail.Configuration.Fields.Item _
    ("http://schemas.microsoft.com/cdo/configuration/smtpserverport") = 25

objMail.Configuration.Fields.Update
----- End of SMTP usage ----->8---

objMail.Send

Set objMail=Nothing
Wscript.Quit 
```

更新：在此处找到更多信息：[使用 CDO 发送电子邮件的 VBScript](http://www.paulsadowski.com/WSH/cdo.htm "VBScript 使用 CDO 发送电子邮件") 默认情况下，它似乎使用 Outlook [Express]，因此它在我的计算机上不起作用，但您可以使用给定的 SMTP 服务器，这对我来说效果很好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T09:32:08.357

我不知道将二进制文件放在 .bat 文件旁边是否算作安装软件，但如果不是，您可以使用[blat](http://www.blat.net/)来执行此操作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-26T21:59:19.440

如果服务器发生（我意识到这个问题有多老）安装了 Powershell v2，则 CmdLet Send-MailMessage 将在一行中完成此操作。

```
Send-MailMessage [-To] <string[]> [-Subject] <string> -From <string> [[-Body] <string>] [[-SmtpServer] <string>] [-Attachments <string[]>] [-Bcc <string[]>] [-BodyAsHtml] [-Cc <string[]>] [-Credential <PSCredential>] [-DeliveryNotficationOption {None | OnSuccess | OnFailure | Delay | Never}] [-Encoding <Encoding>] [-Priority {Normal | Low | High}] [-UseSsl] [<CommonParameters>] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T09:37:09.857

如果您安装了 Outlook/exchange，您应该能够使用 CDONT，只需创建一个 mail.vbs 文件并像这样在批处理文件中调用它（有趣的是它们在同一个目录中）

```
wscript mail.vbs 
```

对于 VBScript 代码检查

[http://support.microsoft.com/kb/197920](http://support.microsoft.com/kb/197920)

[http://www.w3schools.com/asp/asp_send_email.asp](http://www.w3schools.com/asp/asp_send_email.asp)

忘记他们两个链接谈论 ASP 的事实，它应该可以作为没有 iis 的独立脚本正常工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T09:20:49.163

我认为您必须安装一些可以从 WScript 调用的 ActiveX 或其他组件，例如： [http](http://www.activexperts.com/ActivEmail/) ://www.activexperts.com/ActivEmail/ 和： [http ://www.emailarchitect.net/webapp/ SMTPCOM/developers/scripting.asp](http://www.emailarchitect.net/webapp/SMTPCOM/developers/scripting.asp)

否则，您必须自己在 WScript 中编写整个 SMTP 逻辑（如果可能，不确定）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T09:44:17.607

将 CDONTS 与 Windows 脚本宿主 (WScript) 一起使用

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-03-09T18:42:14.423

有没有一种方法可以在不引用外部架构 url 的情况下发送。 [http://schemas.microsoft.com/cdo/configuration/](http://schemas.microsoft.com/cdo/configuration/)

这是非常无用的，因为不能假设所有盒子都可以通过外部 Internet 访问以在本地交换机内部发送邮件。有没有办法将这些网址中的信息保存在本地？

# svn - 您如何构建您的 SVN 存储库？

> ID：152328
> 
> 赞同：13
> 
> 时间：2008-09-30T09:10:46.190
> 
> 标签：svn, project-management, repository

什么是更好的？

**A：**

```
server:1080/repo/projectA/trunk/...
                          branches/branch1
                          branches/branch2
                          branches/branch3
                          tags/tag1/...
                          tags/tag2/...
server:1080/repo/projectB/trunk/...
                          branches/branch1
                          branches/branch2
                          branches/branch3
                          tags/tag1/...
                          tags/tag2/... 
```

**乙：**

```
server:1080/repo/trunk/projectA/...
                 branches/projectA/branch1
                 branches/projectA/branch2
                 branches/projectA/branch3
                 tags/projectA/tag1/...
                 tags/projectA/tag2/...
server:1080/repo/trunk/projectB/trunk/...
                 branches/projectB/branch1
                 branches/projectB/branch2
                 branches/projectB/branch3
                 tags/projectB/tag1/...
                 tags/projectB/tag2/... 
```

您使用什么存储库结构，为什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-30T09:16:04.167

我们使用 A，因为另一个对我们没有意义。请注意，关于 SVN 的“项目”不一定是单个项目，而可能是属于一起的多个项目（即您将放入 Visual Studio 中的解决方案中的项目）。这样，您就可以将任何相关的内容组合在一起。特定项目的所有分支、标签和主干。对我来说很有意义。

相反，按分支/标签分组对我来说没有意义，因为不同项目的分支没有任何共同点，只是它们都是分支。

但最终，人们使用两种方式。做你喜欢的事，但是当你决定时，试着坚持下去:)

另外：我们对每个客户都有单独的存储库，即客户的所有项目都在同一个存储库中。通过这种方式，您可以例如立即备份单个客户，或者将客户拥有的任何东西的源代码提供给他，而无需与 SVN 冲突。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-30T09:20:38.210

[SVN 书](http://svnbook.red-bean.com/en/1.5/index.html)的[存储库管理](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.html)章节包括[规划存储库组织](http://svnbook.red-bean.com/en/1.5/svn.reposadmin.planning.html#svn.reposadmin.projects.chooselayout)的部分，概述了不同的策略及其含义，特别[是存储库布局对分支和合并的影响](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.maint.html#svn.branchmerge.maint.layout)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-30T09:17:39.217

我会建议一个选项C：

```
server:1080/projectA/trunk/...
                     branches/branch1
                     branches/branch2
                     branches/branch3
                     tags/tag1/...
                     tags/tag2/...
server:1080/projectB/trunk/...
                     branches/branch1
                     branches/branch2
                     branches/branch3
                     tags/tag1/...
                     tags/tag2/... 
```

我更喜欢将单独的项目保存在单独的存储库中。使用[svn:externals](http://svnbook.red-bean.com/en/1.0/ch07s03.html)可以轻松管理在两个或多个应用程序项目之间共享的代码库项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T09:20:03.843

我们使用设置 B。因为一次签出/标记多个项目更容易。在 svn 1.5 中，可以通过稀疏结帐，但不是一键式操作。如果某些项目在beetween 中有隐藏的依赖项，您想使用设置 B。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T10:03:36.937

我们用

```
/repos/projectA/component1/trunk - branches - tags
/repos/projectA/component2/trunk - branches - tags
/repos/projectB/component3/trunk - branches - tags
/repos/projectB/component4/trunk - branches - tags 
```

我开始后悔了。它应该更平坦。这会更好。

```
/repos/projectA/trunk - branches - tags
/repos/projectB/trunk - branches - tags
/repos/component1/trunk - branches - tags
/repos/component2/trunk - branches - tags
/repos/component3/trunk - branches - tags
/repos/component4/trunk - branches - tags 
```

为什么？产品（组件、成品软件）永远存在。项目来来去去。去年只有一个项目团队在创建产品 QUUX。明年，那个团队分散，一两个人维护 QUUX。明年，将有两个大的 QUUX 扩建项目。

鉴于该时间表，QUUX 是否应该出现在三个项目存储库中？不，QUUX 独立于任何特定项目。确实，项目确实有工作产品（文档、待办事项等），它们是完成工作的一部分，但不是工作的实际目标。因此，该材料的“projectX”存储库——项目完成后没人会关心的东西。

我开发了一个包含三个团队的产品。工作协调的大问题，因为每个项目都独立管理它的存储库。有团队间发布和团队间协调。在一天结束时，它应该是一个软件。但是，正如您可以猜到的那样，这是三个具有奇怪重叠和冗余的软件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-12-31T14:50:40.933

我个人使用以下存储库结构：

```
/project
    /trunk
    /tags
        /builds
            /PA
            /A
            /B
        /releases
            /AR
            /BR
            /RC
            /ST
    /branches
        /experimental
        /maintenance
            /versions
            /platforms
        /releases 
```

还有一个[图表](http://scm.altern.kiev.ua/images/branches_naming_A3.en.jpg)说明了如何使用这些目录。还有我使用的特定版本编号方法。它在存储库结构中起着重要作用。最近我开发了专门针对软件配置管理的培训，其中我描述了版本编号方法以及为什么这个存储库结构是最好的。这是[演示幻灯片](http://www.slideshare.net/altern/tag/training)。

关于“多个 SVN 存储库与单个公司存储库”的[问题](https://stackoverflow.com/questions/1761513/multiple-svn-repositories-or-single-company-repository/)，我也有[回答。](https://stackoverflow.com/questions/1761513/multiple-svn-repositories-or-single-company-repository/1762051#1762051)只要您在问题中解决存储库结构的这一方面，它可能会有所帮助。

# windows - GetProcessesByName() 和 Windows Server 2003 计划任务

> ID：152337
> 
> 赞同：1
> 
> 时间：2008-09-30T09:15:02.890
> 
> 标签：windows, permissions, scheduled-tasks, .net-1.1

有谁知道以下代码需要哪些用户权限才能在 Windows Server 2003 上作为计划任务成功执行：

```
System.Diagnostics.Process.GetProcessesByName(Process.GetCurrentProcess().ProcessName) 
```

当未按计划任务运行时，即在登录用户下，只要用户是“性能监视器用户”的成员，此代码就不会抛出异常。

在同一用户帐户下作为计划任务运行时，它会失败。

我可以让它工作的唯一方法是作为本地管理员组的成员运行它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-01T08:26:25.477

我最谦虚的道歉。我使用的用户不是“性能监视器用户”组的成员。

这是 System.Diagnostics 的 .NET Framework 1.1 实现所必需的。

我已将用户添加到该组，一切都很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T10:49:43.847

您为作为计划任务运行的帐户分配了哪些用户权限？您需要在本地安全设置中提供有问题的帐户“作为批处理作业登录”。

**更新：**您的应用程序是否写入任何文件，如果是，计划任务用户是否有足够的权限？

我刚刚打开了一个测试应用程序，该应用程序将 Process.GetProcessesByName(Process.GetCurrentProcess().ProcessName) 返回的 Process[] 数组中的进程名称写入文件，它作为计划任务工作得很好......即使在仅是用户组成员的用户的身份（甚至不是“性能监视器用户”的成员。

它写入的文件夹分配给 SYSTEM、管理员和计划任务用户的修改权限。

是否有机会粘贴您的代码或至少一个足够小的片段来证明 exe 作为计划任务失败，以便我们帮助诊断问题？

干杯
凯夫

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T10:04:20.307

我在读取进程名称时看到的一个问题是对性能计数器的访问可能会被禁用。

破解打开你的注册表，看看这个键是否存在：[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\PerfProc\Performance] "Disable Performance Counters"=dword:00000001

您可以将其设置为零或将其删除。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-30T09:36:50.357

取自[MSDN](http://msdn.microsoft.com/en-us/library/z3w4xdc9.aspx)：

> **权限** LinkDemand - 对直接调用者的完全信任。该成员不能由部分信任的代码使用。

# wcf - WCF 单元测试

> ID：152338
> 
> 赞同：38
> 
> 时间：2008-09-30T09:15:11.983
> 
> 标签：wcf, unit-testing

如何对 WCF 服务进行单元测试？有可用的第 3 方工具吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-30T09:52:22.067

正如 aku 所说，如果您正在测试服务方法（即代码行为），那么您可以直接对其进行单元测试并绕过 WCF 基础架构。当然，如果您的代码依赖于 WCF 上下文类（如 OperationContext），那么我建议引入包装器，就像 ASP.NET MVC 为 HttpContext 所做的那样。

对于测试连接性，它将取决于您配置的端点类型。在某些情况下，您可以在单元测试中自行托管您的 WCF 服务（就像使用 WCF Windows 服务一样）并对其进行测试。

但是，如果您想测试特定于那些托管环境的 WCF 行为（即 SSL、身份验证方法），您可能需要启动 ASP.NET 开发 Web 服务器甚至 IIS。这会变得棘手，并且会开始对每个人的开发机器和构建服务器的配置提出要求，但这是可行的。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2011-02-17T12:43:28.657

我认为最好的方法是分别测试所有关注点；测试连接性、客户端库（代理）和服务方法调用。模拟和依赖注入是独立测试连接性和服务行为的好方法，但我怀疑它能否绕过依赖于中间件的端点测试。

您可以在测试中创建服务主机（自托管）并加载您的服务。设置端点后，您可以使用客户端代理连接到它。这应该适用于简单的 HTTP 和 WSHTTP。在您的单元测试中，您需要为您的服务创建一个服务引用。然后您可以创建一个主机并将您的客户端与测试主机连接在一起。我会尽量避免使用“WCF 服务主机”又名 WcfSvcHost 进行任何测试。（我提到这一点只是因为有些人提到了 Visual Studio utils；只有当你只从你的 IDE 运行测试时它才会起作用。）

如果您需要检查使用特殊中间件的特殊身份验证场景或端点，您将需要使用中间件创建测试。对于简单的完整性检查等，使用自托管就足够了。如果您使用的是构建服务器，依赖于中间件的测试可能会导致测试部署问题。

中间件相关端点是指使用例如 MOM（MSMQ、RabbitMQ 等）或真正奇特的协议等的端点。也许使用自托管模拟测试客户端代理并分别测试奇特的端点是要走的路。

如果你想使用依赖注入，有一些非常复杂的框架提供“服务抽象”功能，允许你注入模拟服务等。我使用 Spring.NET 和 WCF 几次。温莎城堡也有 WCF 设施。

自托管测试示例：

```
 ServiceHost serviceHost = null;

    try
    {
        var baseAddress = new Uri("http://localhost:8000/TestService");
        serviceHost = new ServiceHost(typeof (ServiceClass), baseAddress);
        Binding binding = new WSHttpBinding();
        var address = new EndpointAddress("http://localhost:8000/TestService/MyService");
        var endpoint = serviceHost
            .AddServiceEndpoint(typeof (IServiceContract), binding, address.Uri);

        var smb = new ServiceMetadataBehavior {HttpGetEnabled = true};
        serviceHost.Description.Behaviors.Add(smb);

        using (var client = new ProxyClient(endpoint.Name, endpoint.Address))
        {
            endpoint.Name = client.Endpoint.Name;

            serviceHost.Open();

            // ... magic happens 
        }

        serviceHost.Close();
    }
    catch (Exception ex)
    {
        // ... tests
    }
    finally
    {
        if (serviceHost != null)
        {
            ((IDisposable) serviceHost).Dispose();
        }
    } 
```

我想指出，功能测试工具与单元测试工具不同。单元测试应该是把你的测试分解成一堆独立的测试，而功能测试主要是关于端到端的测试工作流。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-30T09:19:41.117

你到底想测试什么？连接还是服务方式？

WCF 很酷的一点是，您可以只定义接口（错误、契约）并将它们作为常规代码进行测试。然后您可以假设它们将通过 WCF 支持的任何连接类型工作。

可以通过直接在 UT 或开发 Web 服务器上托管您的服务来测试连接性。

至于工具，有大量的单元测试框架：NUnit、Visual Studio 中的内置测试、xUnit 等。

如果我没记错的话，您可以下载“ [Visual Studio 2008 and .NET Framework 3.5 Training Kit](http://www.microsoft.com/DownLoads/details.aspx?familyid=8BDAA836-0BBA-4393-94DB-6C3C4A0C98A1&displaylang=en) ”和“ [.NET Framework 3.5 Enhancements Training Kit ”有用于 WCF 单元测试的示例](http://www.microsoft.com/downloadS/details.aspx?FamilyID=355c80e9-fde0-4812-98b5-8a03f5874e96&displaylang=en)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-30T09:47:17.600

如果真的想测试 WCF 服务，最好使用集成测试来实际执行其中的客户端-服务器连接部分。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-30T20:23:28.477

如果您想测试实际运行的服务，那么[SoapUI](http://www.soapui.org/features.html#Web_Service_Functional_Testing)是免费的，并且具有一些出色的功能。唯一需要注意的是，我只尝试了基本 HTTP 绑定。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-30T16:03:50.677

你可以使用 Typemock Isolator 来做到这一点。这里有几篇关于测试[客户端](http://blog.typemock.com/2008/09/testing-wcf-with-isolator-client.html)和[服务器端](http://blog.typemock.com/2008/09/testing-wcf-with-isolator-server.html)的帖子。您可以在没有任何依赖关系的情况下执行此操作，包括配置文件。

Gil Zilberfeld Typemock

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-12T15:02:48.743

Typemock Isolator 是一个用于对[wcf 服务](http://www.typemock.com/wcfpage.php)进行单元测试的工具，等等……

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-02T02:59:53.507

我已经看到[SOA 测试](http://www.parasoft.com/jsp/solutions/soa_solution.jsp?itemId=319)用于评估 WCF 服务的性能和可伸缩性测试，如果这是您所寻求的。我没有关于费用或许可的信息。

在我们的案例中，我们从 UI 中捕获消息以执行自动化测试。

# java - 在Java中，如果我的集合是只读的，我是否需要声明我的集合是同步的？

> ID：152342
> 
> 赞同：23
> 
> 时间：2008-09-30T09:16:48.737
> 
> 标签：java, multithreading, synchronization, web-applications

当我的 J2EE webapp 启动时，我会一次性填充一个集合。然后，几个线程可以同时访问它，但只是为了读取它。

我知道并行写入必须使用同步集合，但并行读取仍然需要它吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-30T09:18:59.603

通常不会，因为在这种情况下您不会更改集合的内部状态。当您对集合进行迭代时，会创建一个新的迭代器实例，并且迭代的状态是每个迭代器实例。

* * *

**旁注：**请记住，通过保留只读集合，您只会阻止对集合本身的修改。每个集合元素仍然是可变的。

```
class Test {
    public Test(final int a, final int b) {
        this.a = a;
        this.b = b;
    }

    public int a;
    public int b;
}

public class Main {

    public static void main(String[] args) throws Exception {
        List<Test> values = new ArrayList<Test>(2);
        values.add(new Test(1, 2));
        values.add(new Test(3, 4));

        List<Test> readOnly = Collections.unmodifiableList(values);
        for (Test t : readOnly) {
            t.a = 5;
        }

        for (Test t : values) {
            System.out.println(t.a);
        }
    }

} 
```

这输出：

```
5
5 
```

* * *

@WMR answser 的重要注意事项。

> 这取决于正在读取您的集合的线程是在您填充它之前还是之后启动的。如果它们在填充之前启动，则无法保证（没有同步）这些线程将永远看到更新的值。
> 
> 原因是 Java 内存模型，如果您想了解更多信息，请阅读此链接上的“可见性”部分：http: [//gee.cs.oswego.edu/dl/cpj/jmm.html](http://gee.cs.oswego.edu/dl/cpj/jmm.html)
> 
> 即使在填充集合后启动线程，您也可能需要同步，因为即使在读取操作时，集合实现也可能更改其内部状态（感谢[Michael Bar-Sinai](https://stackoverflow.com/questions/152342/in-java-do-i-need-to-declare-my-collection-synchronized-if-its-read-only#152425)，我不知道存在这样的集合）。
> 
> [关于并发主题的另一本非常有趣的读物是 Brian Goetz 的书Java Concurrency in Practice](http://www.briangoetz.com/pubs.html)，它更详细地涵盖了对象发布、可见性等主题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-30T09:36:52.197

这取决于正在读取您的集合的线程是在您填充它之前还是之后启动的。如果它们在填充之前启动，则无法保证（没有同步）这些线程将永远看到更新的值。

原因是 Java 内存模型，如果您想了解更多信息，请阅读此链接上的“可见性”部分：http: [//gee.cs.oswego.edu/dl/cpj/jmm.html](http://gee.cs.oswego.edu/dl/cpj/jmm.html)

即使在填充集合后启动线程，您也可能需要同步，因为即使在读取操作时，集合实现也可能更改其内部状态（感谢[Michael Bar-Sinai](https://stackoverflow.com/questions/152342/in-java-do-i-need-to-declare-my-collection-synchronized-if-its-read-only#152425)，我不知道标准 JDK 中存在此类集合）。

[关于并发主题的另一本非常有趣的读物是 Brian Goetz 的书Java Concurrency in Practice](http://www.briangoetz.com/pubs.html)，它更详细地涵盖了对象发布、可见性等主题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-30T09:51:04.567

在一般情况下，你应该。这是因为某些集合在读取期间会更改其内部结构。使用访问顺序的 LinkedHashMap 就是一个很好的例子。但不要只相信我的话：

> 在访问排序的链接哈希映射中，仅使用 get 查询映射是一种结构修改 [链接哈希映射的 javadoc](http://java.sun.com/j2se/1.4.2/docs/api/java/util/LinkedHashMap.html)

如果您绝对确定没有缓存、没有收集统计​​信息、没有优化、根本没有有趣的东西 - 您不需要同步。在那种情况下，我会对集合进行类型约束：不要将集合声明为 Map（这将允许 LinkedHashMap），而是声明为 HashMap（对于纯粹主义者来说，是 HashMap 的最终子类，但这可能也是远的...）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-30T09:28:24.527

如其他答案所述，您不必这样做。如果你想确保你的收藏是只读的，你可以使用：

```
yourCollection = Collections.unmodifableCollection(yourCollection); 
```

（List、Set、Map等集合类型也有类似的方法）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T09:21:19.193

集合本身不是，但请记住，如果它所拥有的也不是不可变的，那么这些单独的类需要它们自己的同步。

# python - 从 statusItem menuItem 启动的 NSWindow 不显示为活动窗口

> ID：152344
> 
> 赞同：0
> 
> 时间：2008-09-30T09:17:36.737
> 
> 标签：python, cocoa, pyobjc

我有一个用 PyObjC 编写的 statusItem 应用程序。statusItem 有一个 menuItem，它应该在单击时启动一个新窗口：

```
# Create statusItem
statusItem = NSStatusBar.systemStatusBar().statusItemWithLength_(NSVariableStatusItemLength)
statusItem.setHighlightMode_(TRUE)
statusItem.setEnabled_(TRUE)
statusItem.retain()

# Create menuItem
menu = NSMenu.alloc().init()
menuitem = NSMenuItem.alloc().initWithTitle_action_keyEquivalent_('Preferences', 'launchPreferences:', '')
menu.addItem_(menuitem)
statusItem.setMenu_(menu) 
```

launchPreferences: 方法是：

```
def launchPreferences_(self, notification):
    preferences = Preferences.alloc().initWithWindowNibName_('Preferences')
    preferences.showWindow_(self) 
```

Preferences 是一个 NSWindowController 类：

```
class Preferences(NSWindowController): 
```

当我在 XCode (Build & Go) 中运行应用程序时，它工作正常。但是，当我从 XCode 外部运行构建的 .app 文件时，statusItem 和 menuItem 会按预期显示，但是当我单击 Preferences menuItem 时，窗口不会出现。我已经通过检查控制台输出验证了 launchPreferences 代码正在运行。

此外，如果我再次双击 .app 文件，则会出现该窗口，但如果我通过单击（例如）Finder 窗口来更改活动窗口，则首选项窗口会消失。在我看来，这与活动窗口有关。

**更新 1** 我已经尝试了[这](https://stackoverflow.com/questions/152344/nswindow-launched-from-statusitem-menuitem-does-not-appear-as-active-window#152399) [两个](https://stackoverflow.com/questions/152344/nswindow-launched-from-statusitem-menuitem-does-not-appear-as-active-window#152409)答案，但都不起作用。如果我添加到 launchPreferences 方法：

```
preferences.makeKeyAndOrderFront_() 
```

或者

```
preferences.setLevel_(NSNormalWindowLevel) 
```

然后我得到一个错误：

> “首选项”对象没有属性

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T09:39:54.810

您需要向应用程序发送一条 activateIgnoringOtherApps: 消息，然后发送窗口 makeKeyAndOrderFront:。

在 Objective-C 中，这将是：

```
[NSApp activateIgnoringOtherApps:YES];
[[self window] makeKeyAndOrderFront:self]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T09:45:10.227

我不知道 PyObjC，从未使用过，但如果这是 Objective-C 代码，我会说你应该在窗口对象上调用[makeKeyAndOrderFront](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindow/makeKeyAndOrderFront:)：如果你想让它成为第一个前窗口。一个新创建的窗口既不能是键，也不能是前面，除非你在这种情况下做它或者像这种情况，两者兼而有之。

另一个让我担心的问题是，当它不再处于活动状态时，您说窗口会消失（变得不可见）。这听起来像你的窗口不是真正的窗口。您是否不小心将其设置为 Interface Builder 中的“实用程序窗口”？你可以尝试手动设置窗口级别，使用 setLevel: 到 NSNormalWindowLevel 在窗口第一次显示在屏幕上之前它是否在变为非活动状态时仍然消失？

# silverlight - 动态设置 Silverlight 控件的背景颜色（列表框）

> ID：152376
> 
> 赞同：2
> 
> 时间：2008-09-30T09:31:54.237
> 
> 标签：silverlight

如何动态设置列表框中项目的背景颜色？即我的业务对象上也有一些属性，我也正在绑定，所以基于一些业务规则，我希望背景颜色不同？

```
 <ListBox Background="Red">
      <ListBox.ItemContainerStyle>
          <Style TargetType="ListBoxItem">
              <Setter Property="Background" Value="Red"/>
          </Style>
      </ListBox.ItemContainerStyle>
 <ListBox.ItemTemplate>
      <DataTemplate>
                    <StackPanel Orientation="Horizontal"
                                Margin="5">
                        <TextBlock VerticalAlignment="Bottom"
                                   FontFamily="Comic Sans MS"
                                   FontSize="12"
                                   Width="70"
                                   Text="{Binding Name}" />
                        <TextBlock VerticalAlignment="Bottom"
                                   FontFamily="Comic Sans MS"
                                   FontSize="12"
                                   Width="70"
                                   Text="{Binding Age}" />
                     </StackPanel>
                </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox> 
```

编辑：[这里说](http://msdn.microsoft.com/en-us/library/cc189093(VS.95).aspx)

> 在 Silverlight 中，您必须将 x:Key 属性添加到您的自定义样式并将它们作为静态资源引用。Silverlight 不支持使用 TargetType 属性值应用的隐式样式。

这会影响我的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T10:02:25.287

Ok - if you need custom logic to determine the background then I would look into building a simple IValueConverter class. You just need to implement the IValueConverter interface and, in its Convert method, change the supplied value into a Brush.

Here's a quick post from Sahil Malik that describes IValueConverters - it might help:

[http://blah.winsmarts.com/2007-3-WPF__DataBinding_to_Calculated_Values--The_IValueConverter_interface.aspx](http://blah.winsmarts.com/2007-3-WPF__DataBinding_to_Calculated_Values--The_IValueConverter_interface.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T10:18:52.627

To bind your background to more than one property, you can use IMultiValueConverter. It's just like IValueConverter except that it works with MultiBinding to pass more than one value into a class and get back a single value.

Here's a post I found with a run-through on IMultiValueConverter and MultiBinding:

[http://blog.paranoidferret.com/index.php/2008/07/21/wpf-tutorial-using-multibindings/](http://blog.paranoidferret.com/index.php/2008/07/21/wpf-tutorial-using-multibindings/)

Edit: If IMultiValueConverter isn't available (it looks like Silverlight only has IValueConverter) then you can always pass your entire bound object (eg your Person object) to an IValueConverter and use various properties from that to return your Brush.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T09:55:19.627

@Matt 感谢您的回复。我会调查触发器。

我唯一的问题是，确定一行是否应该着色的逻辑稍微复杂一些，所以我不能只检查一个属性，所以我实际上需要运行一些逻辑来确定颜色。有任何想法吗？

我想我可以用我需要的所有相关字段制作一个 UI 对象，但我有点不想采用这种方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-14T01:37:56.630

您可以尝试将控件模板中的某些内容（即边框或​​其他内容）绑定到 TemplateBackground。然后在您的列表框上设置背景以确定它的颜色。

```
<Border Margin="-2,-2,-2,0" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1,1,1,0" CornerRadius="11,11,0,0"> 
```

# svn - 通过 HTTP 在 SVN 1.5.2 上的凭据缓存失败

> ID：152382
> 
> 赞同：2
> 
> 时间：2008-09-30T09:34:25.307
> 
> 标签：svn

我们最近在我们的一些服务器/虚拟机上安装了 SVN 1.5.2（使用 VisualSVN/Apache），现在当我发送带有用户名/密码的命令行命令时，它们不再被缓存。之前，我们在 svn:// 上运行随 CollabNet 安装的 SVN 1.5.0，并且在第一个命令之后缓存了凭据。

到目前为止，我在解决此问题时遇到了困难。我的情况是：

*   SERVER_SVN (SVN 1.5.2 通过 svn://)
*   SERVER_HTTP (SVN 1.5.2 通过 http://)

从命令行到 SERVER_SVN 的命令：凭据缓存良好

对 SERVER_HTTP 的相同命令：凭据未缓存

所以，这似乎是一个 http/apache 服务器问题......但是，从 Tortoise 凭证被缓存到两个服务器，所以它似乎也是一个客户端调用问题。我的想法不多了...

我使用的示例命令序列：

```
 svn ls c:\mylocalfolderSVN --username foo --password bar
svn ls c:\mylocalfolderSVN // this works
svn ls c:\mylocalfolderHTTP --username foo --password bar
svn ls c:\mylocalfolderHTTP  // this fails 
```

最后一个命令停止并要求进行身份验证。

svn:// 和 http:// 之间的凭据缓存是否不同，还是我们错过了服务器配置中的某些内容？

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-01T18:28:37.807

AFAIK 凭证缓存是客户的责任。服务器所做的只是在必要时要求提供这些凭据。我会检查本地客户端配置文件，也许看看不同版本的客户端会发生什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-01T18:38:37.720

您是否完全限定了 SVN 服务器的域名？如果 HTTP 的缓存是基于 cookie 的，并且服务器正在使用 FQDN 写入 cookie，但您的请求不使用 FQDN（您使用的是 svnserver 并且 FQDN 是 svnserver.company），那么 cookie 可能无效并且每个请求将需要身份验证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-02T08:52:45.610

正如 wds 所指出的，SVN 凭据缓存是由 svn.exe 在客户端完成的，在收到来自服务器的响应后，例如“好的，我实际上使用了您发送的凭据，它们很好”。

这就是为什么我无法弄清楚发生了什么：我从头开始安装了 2 台服务器，我向两者发送相同的命令行，一组凭据被缓存，另一组没有……但是 TortoiseSVN，它使用相同的svn.exe 下面，缓存两者（也许它作弊，缓存凭据然后 svn.exe 无法这样做）。

我现在最好的猜测是 http:// 服务器没有向 svn.exe 发送“适当”的响应，但我真的不想嗅探所有的 http 请求以查看发生了什么，称我为懒惰，但我有更有趣的事情要做:-)

所以我改变了我的设计，现在我将把 SVN 密码保存在内存中（WinForm 客户端应用程序，全部用于我们的内部网络），并在每个命令中传递它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-01T22:36:13.013

为了缓存凭证，除了适当的配置，您需要像这样执行 SVN：

`svn ls REPOSITORY_URL`

代替

`svn ls WORKING_COPY_PATH`

这对我有用，不确定这是否是这种情况下的解决方案。

# linq-to-sql - 用 LinqToSQL 定义一对一的关系

> ID：152384
> 
> 赞同：3
> 
> 时间：2008-09-30T09:35:11.233
> 
> 标签：linq-to-sql, multilingual

我正在使用现有的多语言数据库使用 LinqToSQL，但在映射一个相当重要的一对一关系时遇到了问题，所以我怀疑我在数据库设计中错误地使用了该功能。

假设有两个表，Category 和 CategoryDe​​tail。Category 包含 CategoryId (PK)、ParentId 和 TemplateId。CategoryDe​​tail 包含 CategoryId (FK)、LanguageId、Title 和 Description（使用适当的语言），以及 CategoryId 和 LanguageId 的组合 PK。

如果我将这些表拖放到 LinqToSQL 设计器中，则生成的对象模型将具有 Category 和 CategoryDe​​tail 对象的集合，这绝不应该是这种情况。我希望能够在 DataContext 级别对 LanguageId 进行过滤，这意味着整个类别都封装在 Category.CategoryDe​​tail 中，而不是所有语言版本都封装在 Category.CategoryDe​​tails 中。

这个数据库在我的旧对象库（一个老式的自定义 BOL 和 DAL）上运行良好，但我担心 LinqToSQL 需要更改它才能给我所需的结果。

使这种关系（和语言过滤）尽可能无缝的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T09:41:35.853

我不得不假设不能是真正的 1 对 1。听起来你在 Cat Details 表上有一个 CatID 和 Lang ID 的 PK。这可以解释为什么它要收藏。我可能是错的，因为你没有提到 CatDetails 表的 PK

编辑： CatID 和 Lang ID 的组合 Pk 构成 1:m 关系，而 Linq to SQL 实际上正在做正确的事情。它可能是真正的 1:1 的唯一方法是，如果您在 cat 表上也有一个 lang ID，并且这是 FK 的一部分。我觉得你可能不得不重新考虑你想做什么，或者你想如何实现它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T09:45:15.907

您可以查看关联的属性。（右键单击代表关联的行并显示属性。）属性将告诉您它是一对一还是一对多关系。这通过具有单个实体关联（一对一）或实体集关联（一对多）反映在代码中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T09:40:10.147

我认为 LINQ to SQL 直接对数据库结构进行建模。您有两个表，因此它创建了 2 个对象。

您是否看过 LINQ to Entities，这允许您在数据库结构之上创建另一层，以创建更具可读性的类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T09:59:23.063

由于您没有 1:1 的关系，因此仅映射将无法提供所需的功能。然而，很容易在父自动生成的类中提供一个方法来完成这项工作：

```
public partial class Category 
{
  public IEnumerable<CategoryDetail> GetDetailsByLanguage(string langID)
  {
    return this.CategoryDetails.Where(c => c.LangID == langID);
  }
} 
```

# c++ - C++程序员需要了解哪些技术？

> ID：152387
> 
> 赞同：40
> 
> 时间：2008-09-30T09:36:14.740
> 
> 标签：c++

C++ 是我真正接触的第一种编程语言，但我在这方面的大部分工作都是学术或游戏编程。我居住的大多数编程工作都需要 Java 或 .NET 程序员，而且我非常清楚他们除了基本语言之外还需要哪些技术。例如，Java 程序员可能需要了解 EJB、Servlet、Hibernate、Spring 和其他技术、库和框架。

但是，我不确定 C++。在现实生活中，对于一般的商业编程，除了语言特性之外，C++ 程序员还需要了解什么？诸如 Win32 API、某些库、框架、技术、工具等的东西。

* * *

编辑：当我说基本语言时，我也在考虑标准库，如果有错误或不清楚，请见谅。我想知道是否有任何更具体的领域要求，类似于 Java 或 .NET 程序员可能需要学习的所有技术，而不是 C++ 程序员通常需要了解的内容。我确实同意标准库和 Boost 是必不可少的，但除此之外还有什么，或者每个公司/项目/域都有什么不同？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-09-30T10:08:43.617

至于每一种语言，我相信有三个相互关联的知识层次：

1.  掌握你的语言。每个程序员都应该（尽其所能）掌握语法。实现这一目标的良好参考是：
    *   [Bjarne Stroustrup的 C++ 编程语言](http://www.research.att.com/~bs/3rd.html)。
    *   [Scott Meyers 的有效 C++ 系列](http://www.aristeia.com/books.html)。
2.  广泛了解您的图书馆。
    *   [STL](http://en.wikipedia.org/wiki/Standard_Template_Library)绝对是必须的，因为它已包含在[C++ 标准库](http://en.wikipedia.org/wiki/C%2B%2B_standard_library)中，因此知道它非常接近第 1 点：您必须掌握它。
    *   作为一个多平台和通用的库，了解[boost](http://www.boost.org/)可能非常有趣。
    *   了解你应该使用的库，无论是[Win32 API](http://en.wikipedia.org/wiki/Win32)、[OCCI](http://www.oracle.com/technology/tech/oci/occi/index.html)、[XPCOM](http://www.mozilla.org/projects/xpcom/)还是[UNO](http://udk.openoffice.org/)（这里只是几个例子）。如果您开发纯图形组件，则无需了解数据库...
3.  发展你的模式知识。无法避免[设计模式：可重用的面向对象软件的元素在](http://en.wikipedia.org/wiki/Design_Patterns)这里...

* * *

因此，我对您更新后的问题的回答是：了解您的语言，了解您的平台，了解您的领域。我认为这里有足够的工作，尤其是在 C++ 中。这是一项永远不会被忽视的工作。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-09-30T09:39:20.257

C++ 开发人员必须了解[std](http://en.wikipedia.org/wiki/C%2B%2B_standard_library)和[boost](http://www.boost.org)库。

其他技术列表很大程度上取决于项目类型。您肯定会与 SO 进行一些交互，因此您需要了解您的环境的 API。

至于数据访问和其他东西，有很多不同的解决方案。从这个意义上说，C++ 比一些托管语言要丰富得多。99% 的旧流行系统都有 C/C++ 接口。

在您对我的答案的评论中稍微澄清了您的问题后，我可以推荐：

*   良好的代码浏览器（例如 SourceInsight 或理解 For C++）
*   静态分析工具（Link、KlockWork Inforce 等）
*   MySQL\SQLite（我在大量 C++ 项目中遇到过这些数据库）
*   UI 技术（OpenGL\GLUT、DirectX、GDI、Qt 等）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-30T10:00:10.283

作为 C++ 程序员，您应该了解的技术（因此在技术上比较少的程序员知识渊博；））：

性能问题 - 是什么让事情变得缓慢，如何找到和解决这些问题。我还指上下文切换、缓存行、优化搜索、内存使用和约束，以及普通 VB/C# 开发人员不关心的类似内容。

线程问题 - 如何从多线程应用程序中获得最大收益，如何检测和修复相同的滥用。

低级通信——尤其是能够连接到其他人没有为（尤其是无线电通信）、延迟和带宽管理编写工具包的晦涩系统。

否则，对于特定工具 - 这取决于您的目标，Windows dev 将不同于 Linux，不同于嵌入式。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-30T09:40:26.837

这在很大程度上取决于使用的平台和其他限制。作为一般规则，优秀的（C++）程序员能够（或应该）能够在很短的时间内学习特定于平台的 API。对于 C++，了解不同的工具链（例如，Windows 程序员也应该知道 GCC 工具链）和编译器的差异更为重要。程序员还应该了解语言的局限性和平台相关行为。

至于库，C++ 程序员绝对需要了解 STL 和 Boost。没有讨论。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-30T09:38:57.200

标准模板库

[http://en.wikipedia.org/wiki/Standard_Template_Library](http://en.wikipedia.org/wiki/Standard_Template_Library)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-30T12:08:45.593

除了每个人列出的东西之外，请记住，C++ 程序员在嵌入式系统市场上占有一席之地（比大多数其他高级语言要多得多）。所以熟悉嵌入式系统和开发可能会打开很多你不会打开的大门和工作机会例如，与 Java 开发竞争如此激烈。因此，学习编写紧凑代码（编译后紧凑）和低内存使用技术是一个不错的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-30T09:48:58.690

如果你使用 gcc，你肯定知道 gdb。实际上，无论您使用哪种编译器，您都应该精通本地调试器。除此之外，使用的库范围如此之广，以至于能够快速获取 API 比任何特定的库都更有用。不过，我建议学习 doxygen。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-30T12:25:31.357

如果您使用的是 linux，那么[Valgrind](http://valgrind.org/)是一个非常有用的工具，可以检查您的程序如何处理内存访问。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T09:44:06.500

没有特定的顺序

*   COM/ATL
*   DirectX
*   MFC & Win32
*   STL
*   GDI
*   促进

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-09T10:27:33.893

在移动领域使用 C++ 的流行方法是学习 Symbian OS 开发。

[http://developer.symbian.com](http://developer.symbian.com)

# delphi - 如何合并使用单独图像列表的 TMainMenu 并按每个菜单项保留正确的图像？

> ID：152405
> 
> 赞同：2
> 
> 时间：2008-09-30T09:43:42.010
> 
> 标签：delphi, c++builder, vcl

我有一个包含两个 TForm 类的程序，并为每个类添加了一个 TMainMenu。然后我试图在运行时动态合并它们。

我的问题是，当他们合并 TMainMenu 中合并的菜单项时，现在以合并到的形式显示存储在 imagelist 中的图像，而不是存储在原始表单的 imagelist 中的图像。

难道我做错了什么？是否有解决方法以使菜单项继续以它们起源的形式使用图像列表？

我在许多项目中使用合并形式，否则单个共享图像列表将有意义。

如果我需要澄清什么，请说。

谢谢

彼得

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-30T13:41:44.557

我处理这个问题的方法是在数据模块上有一个图像列表，然后将其包含在每个表单中，以便他们可以共享那一组图标。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T16:16:50.020

不久前我遇到了完全相同的问题，但我也遇到了其他菜单合并问题，因为我的应用程序是 MDI，所以我决定以完全不同的方式做事。

但是，您可以尝试将一个表单的图像动态添加到另一个表单的 ImageList，并“重定向” `ImageIndex`es。可能有点棘手，但应该可以。

我最终得到的结果是，我的所有菜单和工具栏都使用了[Toolbar2000](http://jrsoftware.org/tb2k.php)包。然后，您可以下载一段非常棒的代码，称为[TB2Merge](http://flocke.vssd.de/prog/code/pascal/tb2merge/)，它完全符合您的要求。它还利用 Toolbar2000 的一些基础结构将菜单项的图像链接到不同的`TImageList`基础结构 --- VCL 的 TMainMenu 中不存在的基础结构。请务必彻底阅读 TB2Merge 的文档！

# language-agnostic - 你如何写一个（简单的）变量“切换”？

> ID：152416
> 
> 赞同：1
> 
> 时间：2008-09-30T09:47:08.333
> 
> 标签：language-agnostic, coding-style, idioms

鉴于以下成语：

1)

```
variable = value1
if condition
  variable = value2
```

2)

```
variable = value2
if not condition
  variable = value1
```

3)

```
if condition
  variable = value2
else
  variable = value1
```

4)

```
if not condition
  variable = value1
else
  variable = value2
```

你更喜欢哪个？为什么？

我们假设最常见的执行路径`condition`是错误的。

我倾向于学习使用 1)，尽管我不确定为什么我更喜欢它。

*注意：以下示例可能更简单——因此可能更具可读性——但并非所有语言都提供这种语法，并且它们不适合将变量赋值扩展为将来包含多个语句。*

```
variable = condition ? value2 : value1
...
variable = value2 if condition else value1
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-30T09:49:19.220

理论上，我更喜欢#3，因为它避免了两次为变量赋值。在现实世界中，尽管我使用上述四种中的任何一种，它们都会更具可读性或更清楚地表达我的意图。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-30T09:54:45.977

我更喜欢方法 3，因为它更简洁和逻辑单元。它只设置一次值，它可以作为一个块移动，而且不容易出错（尤其是在方法 1 中，如果设置为值 1 和检查和可选地设置为值 2由其他语句分隔）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-30T11:15:30.120

3）是你想要发生的事情的最清晰的表达。我认为所有其他人都需要一些额外的思考来确定哪个值最终会出现在变量中。

在实践中，如果我使用支持它的语言，我会使用三元运算符 (?:)。我更喜欢尽可能以函数式或声明式风格编写，而不是命令式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T09:54:30.580

我自己经常使用#1。`if condition`阅读起来比 更容易`if !condition`，尤其是如果您非常想念“！”，至少在我看来。

我所做的大多数编码都是用 C# 编写的，但我仍然倾向于避开三元运算符，除非我正在使用（大部分）局部变量。如果您在某个结构中调用三层，那么在三元运算符中，行往往会很快变长，这会很快再次降低可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T11:11:07.667

> 注意：以下示例可能更简单——因此可能更具可读性——但并非所有语言都提供这样的语法

这不是在提供这种语法的语言中不使用它们的论据。顺便说一句，这包括我上次统计后的所有当前主流语言。

> 并且它们不适合将变量赋值扩展为将来包含多个语句。

这是真的。但是，通常可以肯定的是，这种扩展绝对不会发生，因为它`condition`总是会产生两种可能的情况之一。

在这种情况下，我总是更喜欢表达式变体而不是语句变体，因为它减少了语法混乱并提高了表达能力。在其他情况下，我倾向于使用`switch`前面提到的语句——如果语言允许这种用法。如果没有，请回退到 generic `if`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T09:49:38.110

`switch`声明也有效。如果它很简单并且超过 2 或 3 个选项，那就是我使用的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T09:59:58.927

在这种情况可能不会发生的情况下。我会选择 1 或 2。否则它只是基于我想要代码执行的操作。（即。我同意克鲁泽）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T10:02:13.650

如果不是...返回，我倾向于使用。

但那是如果你想返回一个变量。首先排除不合格项往往会使其更具可读性。这实际上取决于语句的上下文以及语言。case 语句在大多数情况下可能工作得更好并且可读，但是在 VB 下性能会受到影响，因此一系列 if/else 语句在特定情况下更有意义。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T10:04:26.343

对我来说方法1或方法3。方法 1 可以避免额外的范围进入/退出，但方法 3 避免了额外的分配。我倾向于避免使用方法 2，因为我试图使条件逻辑尽可能简单（在这种情况下， ! 是无关紧要的，因为它可以在没有它的情况下被重写为方法 1），同样的原因也适用于方法 4。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-30T10:55:32.210

这取决于我正在测试的条件。

如果这是一个错误标志条件，那么我将使用 1) 设置错误标志来捕获错误，然后如果条件成功则清除错误标志。这样就没有机会错过错误条件。

对于我会使用的其他一切 3)

NOT 逻辑只会在阅读代码时增加混乱 - 在我的脑海中，不能代表其他人 :-)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-30T11:01:52.447

如果变量有一个自然的默认值，我会选择#1。如果任何一个值都同样（不）适合默认值，那么我会选择#2。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-30T11:19:13.230

这取决于。我喜欢三元运算符，但有时使用“if”语句会更清楚。您选择的四种替代方案中的哪一种取决于上下文，但我倾向于选择使代码功能更清晰的那种，并且因情况而异。

# c# - 如何签署自定义肥皂标题？

> ID：152419
> 
> 赞同：2
> 
> 时间：2008-09-30T09:48:13.060
> 
> 标签：c#, web-services, wse3.0, x509securitytokenmanager

我已经在元素中添加了一个自定义的soap header`<MyApp:FOO>`元素，`<soap:Header>`并且要求我必须签署这个元素，如何做到这一点？ `<MyApp:FOO>`包含许多在更高级别上识别用户的东西（用户名、偏好等）。我已经成功地使用了一个策略文件，现在使用了一个带有 CertificateAssertions 和 SoapFilters 的 policyClass 来签署 wsu:Timestamp、wsu:action、wsu:MessageId 等。但是现在该`<MyApp:FOO>`元素也需要签名。

到目前为止我所理解的是，需要签名的元素必须使用 wsu:Id 属性进行标识，然后使用 xml-exc-c14n 进行转换。

那么，我如何指定也应该对soap标头进行签名？这是我用于签署消息的当前类。

```
internal class FOOClientOutFilter: SendSecurityFilter
{
X509SecurityToken clientToken;

public FOOClientOutFilter(SSEKCertificateAssertion parentAssertion)
: base(parentAssertion.ServiceActor, true)
{
// Get the client security token.
clientToken = X509TokenProvider.CreateToken(StoreLocation.CurrentUser, StoreName.My, "CN=TestClientCert");

// Get the server security token.
serverToken = X509TokenProvider.CreateToken(StoreLocation.LocalMachine, StoreName.My, "CN=TestServerCert");
}

public override void SecureMessage(SoapEnvelope envelope, Security security)
{
// Sign the SOAP message with the client's security token.
security.Tokens.Add(clientToken);

security.Elements.Add(new MessageSignature(clientToken));
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T10:29:55.783

My current version of SecureMessage seems to do the trick..

```
 public override void SecureMessage(SoapEnvelope envelope, Security security)
    {
        //EncryptedData data = new EncryptedData(userToken);
        SignatureReference ssekSignature = new SignatureReference();
        MessageSignature signature = new MessageSignature(clientToken);
        // encrypt custom headers

        for (int index = 0; index < envelope.Header.ChildNodes.Count; index++)
        {
            XmlElement child =
              envelope.Header.ChildNodes[index] as XmlElement;

            // find all FOO headers
            if (child != null && child.Name == "FOO")
            {
                string id = Guid.NewGuid().ToString();
                child.SetAttribute("Id", "http://docs.oasis-" +
                      "open.org/wss/2004/01/oasis-200401-" +
                      "wss-wssecurity-utility-1.0.xsd", id);
                signature.AddReference(new SignatureReference("#" + id));
            }
        }

        // Sign the SOAP message with the client's security token.
        security.Tokens.Add(clientToken);

        security.Elements.Add(signature);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-12T13:11:22.733

包括来自 MSDN 的补充文章

[**如何：将 Id 属性添加到 SOAP 标头**](http://msdn.microsoft.com/en-us/library/aa529237.aspx)

[**如何：对自定义 SOAP 标头进行数字签名**](http://msdn.microsoft.com/en-us/library/aa528813.aspx)

# c# - 缓存会话工厂

> ID：152432
> 
> 赞同：3
> 
> 时间：2008-09-30T09:54:32.000
> 
> 标签：c#, asp.net, nhibernate, caching

据我收集（阅读：测量），到目前为止，构建配置和 sessionfactory 在使用 nhibernate 执行查询时花费的时间最多。有什么反对使 sessionfactory 静态的，所以每个 appDomain 只会配置一次？

我知道在使用这种方法时会出现锁定和竞速问题，但就我个人而言，在 sessionfactory 上使用这种方法时，我看不出这会破坏我的应用程序。

我问这个的原因是因为它真的很难测试可能的线程问题，因为它不会一直发生。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T09:57:38.810

会话工厂确实应该在应用程序启动时启动。您可以在[此处查看最佳实践](http://www.hibernate.org/363.html#A4)。

# oracle - PL/SQL 的代码覆盖率

> ID：152435
> 
> 赞同：12
> 
> 时间：2008-09-30T09:55:14.073
> 
> 标签：oracle, plsql

有没有人有 PL/SQL 代码覆盖的工具或经验。我相信使用 DBMS_PROFILER 可以做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-05T13:22:38.543

[http://www.toadworld.com/BLOGS/tabid/67/EntryID/267/Default.aspx](http://www.toadworld.com/BLOGS/tabid/67/EntryID/267/Default.aspx)包含有关使用 PL/SQL 分析器检查代码覆盖率的信息。

有关在 9i 或 10g 上进行分析的一些有用信息包含在 Metalink 文章 243755.1“实施和使用 PL/SQL Profiler”中，以获取有关分析代码的信息。从文章底部获取 prof.zip，它有一个 profiler.sql，它可以在分析运行后很好地格式化您的结果。

更多 10g 文档可在此处获得，无需 MetaLinka 帐户：http: [//download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_profil.htm](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_profil.htm)

如果您正在运行 11g，则此处记录了一个新的 Hierarchical Profiler：http: [//download.oracle.com/docs/cd/B28359_01/appdev.111/b28424/adfns_profiler.htm](http://download.oracle.com/docs/cd/B28359_01/appdev.111/b28424/adfns_profiler.htm)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-09T11:24:49.127

请参阅[SD 测试覆盖工具](http://www.semanticdesigns.com/Products/TestCoverage)。我们即将发布一个 PLSQL 测试覆盖率工具，它与我们的其他工具具有相同的功能，包括一个在源代码之上显示结果的 GUI，以及一个生成的覆盖率报告，该报告收集各个函数的详细信息以及汇总包。

编辑 2/15/2011：PLSQL 测试覆盖生产工具可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T11:35:44.283

不确定这是否是您所追求的，但在 10g 及以后的版本中，有一个工具可以进行静态 PL/SQL 代码分析。

信息在这里... [http://www.psoug.org/reference/plsql_warnings.html](http://www.psoug.org/reference/plsql_warnings.html)

请注意，它可以在会话或数据库级别启用。

以我的经验，到目前为止，它引发了很多误报。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T22:13:26.027

[我在http://www.databasejournal.com/features/oracle/article.php/10893_2197231_3](http://www.databasejournal.com/features/oracle/article.php/10893_2197231_3)页面上发现了一些有用的东西。

```
select exec.cnt/total.cnt * 100 "Code% coverage"
from  (select count(1) cnt
      from plsql_profiler_data d, plsql_profiler_units u
      where d.runid = &&runid
      and u.runid = d.runid
      and u.unit_number = d.unit_number
      and u.unit_name = upper('&&name')
      and u.unit_owner = upper('&&owner')
      ) total,
     (select count(1) cnt
      from plsql_profiler_data d, plsql_profiler_units u
      where d.runid = &&runid
      and u.runid = d.runid
      and u.unit_number = d.unit_number
      and u.unit_name = upper('&&name')
      and u.unit_owner = upper('&&owner')
      and d.total_occur > 0) exec; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-03T00:46:45.997

您可以安装一个名为[DBMS_profiler](http://download.oracle.com/docs/cd/B10500_01/appdev.920/a96612/d_profil.htm)的软件包。这样，您可以启动配置文件，Oracle 会将数据存储在特殊表中。然后停止配置文件并从这些表中报告。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-26T07:11:26.177

现在有了 Oracle 12.2c，您可以使用**DBMS_PLSQL_CODE_COVERAGE**包。事实上，这提供了基本块级别的覆盖。

基本块是最小的可执行代码。

这些是用于查找更多信息的少数参考资料。

[甲骨文文档](https://docs.oracle.com/en/database/oracle/oracle-database/12.2/adfns/basic-block-coverage.html#GUID-35842E6A-630A-418F-8314-6A30F1FBDF83)

[教程](https://oracle-base.com/articles/12c/dbms_plsql_code_coverage-12cr2)

[Youtube 视频](https://youtu.be/CIKQy8su5DQ?t=2704)

# c# - 你推荐 Native C++ 到 C++\CLI 的转变吗？

> ID：152436
> 
> 赞同：12
> 
> 时间：2008-09-30T09:55:15.617
> 
> 标签：c#, c++, c++-cli

在过去的几年里，我一直是一名本地 C++ 程序员。现在我们从头开始一个新项目。那么您对以丢失平台无关代码为代价转向 C++\CLI 的想法是什么？转移到 C++\CLI 是否有任何特殊优势？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-09-30T10:05:18.183

根据我对 C++、C# 和 .NET 的经验，我会推荐以下内容：

*   如果您想采用 .NET 方式，请使用 C#。
*   如果您不想要 .NET，请使用传统的 C++。
*   如果您必须将传统 C++ 与 .NET 代码连接起来，请使用 C++/CLI。与调用 C++ 类的 .NET 和调用 .NET 类的 C++ 一起工作。

如果您不需要它，我认为只使用 C++/CLI 是没有意义的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T10:11:48.603

切换前需要考虑的一些问题：

[1] 坚持使用 Windows 可以吗？有其他操作系统的 .NET 克隆，但您的应用程序不会只是透明地运行。您可能不需要的复杂性。

[2] 您是否正在考虑仅为垃圾收集支持而切换？如果是这样，您可以只使用一些 C++ 垃圾收集器库。如果你弄清楚如何利用 std::shared_ptr，你可能不会觉得需要垃圾收集器。您可能不需要的开销。

[3] 您是否考虑使用 C++/CLI，因为垃圾收集和所有有用的 .NET 类都可以利用？如果是这样，为什么不直接切换到 C#。C++/CLI 是一种过渡性技术，最好不要在这类事情上投入资源。c# 变得非常成熟和可用。

就个人而言，我会坚持使用 C++ ;)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-30T09:58:25.093

对你有什么好处吗？您可能会失去切换到另一个操作系统的能力。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T10:08:16.567

除非您正在与 .NET 应用程序集成，否则请不要打扰。当然不要使用 STL/CLR，因为它的性能真的很糟糕。

将开关切换为使用 .NET 类库很诱人，但还有其他选择。如果您这样做，您将无法如此轻松地移植您的代码。

似乎 OSS 的兴起正在增加，所以现在可能是研究使用跨平台库和工具的时候了。您可以比 Windows 更轻松地部署 linux 应用程序（通过发布完全配置的操作系统！），如果您部署 linux 客户端（因为它们是免费的），您将获得更好的投资回报率。

如果我是一名商人，我希望至少能够在 linux 或 mac 上进行部署，而不仅仅是 windows。从战略上讲，我不想打赌世界会在 5 年内留在微软。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-30T10:55:19.013

迁移到 C++/CLI 的主要优势是可以访问 .NET 库和框架本身（垃圾收集等）。然而，据我所知，存在 C++/CLI 的主要原因是为了简化现有 C++ 代码的移植以在 .NET 框架中运行。鼓励新项目使用 C#。

如果您需要使用与 .NET 框架混合的现有 C++ 代码，那么使用 C++/CLI 是有意义的，但通常您应该从 C# 开始。

如果新项目需要广泛使用 .NET 中的某些内容（可能是更简单的 GUI 设计或其他内容），则使用 C#。如果没有，那么坚持使用原生 C++。我不认为你会因为这样做而失去任何东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T20:50:09.193

我非常不喜欢 C++/CLI，所以我建议使用清晰的方法，正如我[在此处](http://loyc-etc.blogspot.com/2007/07/ccli-is-disgusting.html)描述的那样。一些人建议使用 C++/CLI 作为标准 C++ 和 C# 之间的桥梁，但是由于 C++/CLI 的设计方式，使用这种方式非常繁琐（您必须手动创建可以调用的普通 C++ 代码的包装器C＃）。因此，我会推荐[SWIG](http://www.swig.org/)来代替标准 C++ 与 C# 的接口（尽管不可否认，SWIG 有相当长的学习曲线）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T11:11:55.710

看看这两篇文章：

[C++/CLI 的重要概述，第一部分](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=274)

[C++/CLI 的重要概述，第二部分](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=275)

> 我相信现在你和我一样相信 C++/CLI 既不是“C++ 的扩展集”（在许多方面它实际上是 C++ 的一个子集），它与 C++ 的关系也比任何其他带有分号的语言都多和花括号。此外，C++/CLI 绝对是一种面向 Windows 的编程语言；它绝对不是 Solaris 10 服务器或诺基亚手机乐于运行的语言。它与 C++ 有什么关系？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-13T15:52:46.577

使用 C++/CLR 的一个主要缺点是，如果代码没有被充分模糊，可能会丢失您的 IP（知识产权）。总的来说，我同意这里其他成员的发言。如果您想要独立于 MS .net vm 的可移植代码，那么本机 C/C++ 是您的最佳选择。

# ldap - LDAP 整个子树副本

> ID：152439
> 
> 赞同：2
> 
> 时间：2008-09-30T09:56:12.447
> 
> 标签：ldap, copy, subtree

我实际上是这个论坛的新手，我一直在尝试几天来找到一种将整个 LDAP 子树复制到另一棵树的简单方法。由于我找不到任何有用的东西，我也想在这里提出一个问题。有人知道如何以编程方式执行此操作吗？

对于添加、删除、搜索等正常操作，我一直在使用 Spring LDAP。

非常感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T10:35:32.710

我实际上不知道 Spring LDAP，但是如果您的 LDAP 接口没有提供任何高级抽象来移动/重命名或复制整个子树，则您必须递归地移动/重命名或复制所有子树节点。LDAP API 不直接提供这样的选项。

以下是伪代码：

```
function copySubtree(oldDn, newDn)
{
    copyNode(oldDn, newDn); // the new node will be created here
    if (nodeHasChildren(oldDn) { 
        foreach (nodeGetChildren(oldDn) as childDn) {
            childRdn=getRdn(childDn); // we have to get the 'local' part, the so called RDN 
            newChildDn=childRdn + ',' + newDn; // the new DN will be the old RDN concatenated with the new parent's DN
            copySubtree(childDn, newChildDn); // call this function recursively
        }  
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-02T21:40:27.837

将其转储为 LDIF，通过搜索和替换（或通过脚本）编辑 DN，然后导入新的 LDIF。

Spring 可能不是执行此操作的工具。是否有必要使用 Spring 操作目录？我认为 OpenLDAP 的 ldapsearch 和 ldapadd 应该适用于任何服务器，并且它们将转储/加载 LDIF。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T19:10:20.513

请注意，密码很难复制。您可能无法通过 LDAP API 读取它们。这将取决于您使用它的 LDAP 实现。

因此，复制到新位置可能无法获得您想要或需要的一切。

# oracle - Unit testing for PL/SQL

> ID：152441
> 
> 赞同：23
> 
> 时间：2008-09-30T09:57:21.337
> 
> 标签：oracle, unit-testing, plsql

Anyone have any experience or tools for unit testing PL/SQL. The best looking tool I've seen for this seems to be Quests Code Tester, but i'm not sure how well that would integration with continuous integration tools or command line testing?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-01T22:29:25.013

I use utPLSQL as the framework and OUnit as the client. utPLSQL isn't really meant to be used by itself, a good graphical client is required. OUnit is the predecessor to Qute. Qute is also a good tool but more complex than my requirements - it allows you to construct tests using a GUI and does good stuff like test code generation.

Edit: My understanding is that utPLSQL stores all results in database tables, including all historical results which would make a good data source for gathering statistics for continuous integration. You can also define test groups so a single call to utPLSQL can call multiple test packages.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-30T10:16:30.167

Check [utPLSQL](http://utplsql.sourceforge.net/) out. I found it somewhat difficult to start with, but i think it does the job reasonably well.

As for continuous integration tools, I used to create usual tests (NUnit, C#) that just called the stored procedures created with utPLSQL and checked their result out.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-11-27T14:20:41.683

I have created and using [PL/SQL unit testing framework using Ruby library ruby-plsql](http://blog.rayapps.com/2009/11/27/oracle-plsql-unit-testing-with-ruby).

It provides much shorter and more readable tests than utPLSQL and gives more flexibility compared to GUI tools (like Quest Code Tester or SQLDeveloper 2.1).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-30T10:23:59.510

There are a few listed on the wikipedia : [http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#PL.2FSQL](http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#PL.2FSQL)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-02-24T00:08:53.150

The last version of [SQL Developer](http://www.oracle.com/technology/products/database/sql_developer/index.html) includes an Unit Test suite very interesting.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-20T08:18:11.250

I found [this interesting post](http://www.theserverlabs.com/blog/2009/05/18/continuous-integration-with-oracle-plsql-utplsql-and-hudson/) about the continuous integration for PL/SQL projects.

It meanly deals with the unit testing of PL/SQL code, using the previously listed utPLSQL framework...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-11-06T16:47:51.980

I'm using python `py.test` with `cx_oracle` to build test scripts for pl/sql packages. Works nice so far.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-09-16T04:55:45.653

I've recently used successfully unit testing framework of [PL/SQL Commons](http://code.google.com/p/plsql-commons/) toolkit (see also [author's slides](http://www.slideshare.net/areuser/plsql-commons-v10-6623604)). The toolkit is not yet publicly available (at the time of the writing) but if you drop an email to the authors you'll get a working package (or at least I got).

# sql-server - SQL-Server：是否有可用于确定 SQL Server 备份或恢复过程进度的 SQL 脚本？

> ID：152447
> 
> 赞同：106
> 
> 时间：2008-09-30T09:59:34.780
> 
> 标签：sql-server, backup, restore

当我使用 MS SQL Server Management Studio 备份或恢复数据库时，我可以直观地看到该过程已经进行了多长时间，因此我还需要等待多长时间才能完成。如果我使用脚本启动备份或恢复，有没有办法监控进度，或者我只是坐下来等待它完成（希望没有出错？）

**已编辑：**我特别需要能够完全独立于启动备份或恢复的会话来监控备份或恢复进度。

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2008-09-30T10:08:50.780

[我在这里](http://sql-articles.com/scripts/estimated-time-for-backup-restore/)找到了这个示例脚本，它似乎运行良好：

```
SELECT r.session_id,r.command,CONVERT(NUMERIC(6,2),r.percent_complete)
AS [Percent Complete],CONVERT(VARCHAR(20),DATEADD(ms,r.estimated_completion_time,GetDate()),20) AS [ETA Completion Time],
CONVERT(NUMERIC(10,2),r.total_elapsed_time/1000.0/60.0) AS [Elapsed Min],
CONVERT(NUMERIC(10,2),r.estimated_completion_time/1000.0/60.0) AS [ETA Min],
CONVERT(NUMERIC(10,2),r.estimated_completion_time/1000.0/60.0/60.0) AS [ETA Hours],
CONVERT(VARCHAR(1000),(SELECT SUBSTRING(text,r.statement_start_offset/2,
CASE WHEN r.statement_end_offset = -1 THEN 1000 ELSE (r.statement_end_offset-r.statement_start_offset)/2 END)
FROM sys.dm_exec_sql_text(sql_handle))) AS [SQL]
FROM sys.dm_exec_requests r WHERE command IN ('RESTORE DATABASE','BACKUP DATABASE') 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-06-30T00:31:58.133

如果您知道 sessionID，那么您可以使用以下内容：

```
SELECT * FROM sys.dm_exec_requests WHERE session_id = 62 
```

或者，如果您想缩小范围：

```
SELECT command, percent_complete, start_time FROM sys.dm_exec_requests WHERE session_id = 62 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-10-19T13:23:24.410

这是一个简单的脚本，通常对我有用：

```
SELECT command, percent_complete,total_elapsed_time, estimated_completion_time, start_time
  FROM sys.dm_exec_requests
  WHERE command IN ('RESTORE DATABASE','BACKUP DATABASE') 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-01T03:22:35.117

是的。如果您已将[sp_who2k5](http://blogs.msdn.com/chadboyd/archive/2007/08/15/sp-who-for-sql-2005-sp-who2k5.aspx)安装到您的 master 数据库中，您可以简单地运行：

```
sp_who2k5 1,1 
```

结果集将包括所有活动事务。当前运行的备份将在**requestCommand**字段中包含字符串“BACKUP”。恰当命名的**percentComplete**字段将为您提供备份进度。

注意： sp_who2k5 应该是每个人工具包的一部分，它的作用远不止于此。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-03-12T20:29:51.287

> **[用于检查 SQL Server 中的备份和还原进度的脚本](https://alwayssql.wordpress.com/2018/03/10/query-to-check-the-backup-and-restore-progress-in-sql-server/)：**

很多时候，您的备份（或还原）活动已由另一个数据库管理员或作业启动，您无法使用 GUI 其他任何东西来检查该备份/还原的进度。

通过组合多个命令，我生成了下面的脚本，它可以为我们提供服务器上正在发生的当前备份和恢复的摘要。

```
select 
r.session_id, 
r.blocking_session_id, 
db_name(database_id) as [DatabaseName],
r.command, 
[SQL_QUERY_TEXT] = Substring(Query.TEXT, (r.statement_start_offset / 2) + 1, (
            (
                CASE r.statement_end_offset
                    WHEN - 1
                        THEN Datalength(Query.TEXT)
                    ELSE r.statement_end_offset
                    END - r.statement_start_offset
                ) / 2
            ) + 1),
                [SP_Name] =Coalesce(Quotename(Db_name(Query.dbid)) + N'.' + Quotename(Object_schema_name(Query.objectid, Query.dbid)) + N'.' + 
     Quotename(Object_name(Query.objectid, Query.dbid)), ''),
r.percent_complete,
start_time,
CONVERT(VARCHAR(20), DATEADD(ms, [estimated_completion_time],
GETDATE()), 20) AS [ETA_COMPLETION_TIME],
CONVERT(NUMERIC(6, 2), r.[total_elapsed_time] / 1000.0 / 60.0) AS [Elapsed_MIN],
CONVERT(NUMERIC(6, 2), r.[estimated_completion_time] / 1000.0 / 60.0) AS [Remaning_ETA_MIN],
CONVERT(NUMERIC(6, 2), r.[estimated_completion_time] / 1000.0 / 60.0/ 60.0) AS [ETA_Hours],
wait_type,
wait_time/1000 as Wait_Time_Sec, 
wait_resource
from sys.dm_exec_requests r 
cross apply sys.fn_get_sql(r.sql_handle) as Query where r.session_id>50 and command IN ('RESTORE DATABASE','BACKUP DATABASE', 'RESTORE LOG', 'BACKUP LOG') 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-12-15T10:54:42.673

```
SELECT session_id as SPID, command, a.text AS Query, start_time, percent_complete, dateadd(second,estimated_completion_time/1000, getdate()) as estimated_completion_time 
FROM sys.dm_exec_requests r CROSS APPLY sys.dm_exec_sql_text(r.sql_handle) a 
WHERE r.command in ('BACKUP DATABASE','RESTORE DATABASE') 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-01-28T11:17:15.020

试试看：

```
SELECT * FROM sys.dm_exec_requests where command like '%BACKUP%'

SELECT command, percent_complete, start_time FROM sys.dm_exec_requests where command like '%BACKUP%'

SELECT command, percent_complete,total_elapsed_time, estimated_completion_time, start_time
  FROM sys.dm_exec_requests
  WHERE command IN ('RESTORE DATABASE','BACKUP DATABASE') 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-30T10:14:06.100

如果它只是一个脚本，请在 BACKUP 命令中使用 STATS。

内部代码有点复杂。例如，在 ODBC 中，您设置 SQL_ATTR_ASYNC_ENABLE，然后查找 SQL_STILL_EXECUTING 返回码，并重复调用 SQLExecDirect，直到获得 SQL_SUCCESS（或 eqiv）。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-30T10:06:28.960

使用 STATS 选项：http: [//msdn.microsoft.com/en-us/library/ms186865.aspx](http://msdn.microsoft.com/en-us/library/ms186865.aspx)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-04-11T18:13:22.203

我认为了解还原或备份进度的最佳方法是通过以下查询：

```
USE[master]
GO
SELECT session_id AS SPID, command, a.text AS Query, start_time, percent_complete, dateadd(second,estimated_completion_time/1000, getdate()) as estimated_completion_time 
    FROM sys.dm_exec_requests r CROSS APPLY sys.dm_exec_sql_text(r.sql_handle) a 
        WHERE r.command in ('BACKUP DATABASE','RESTORE DATABASE')
GO 
```

上面的查询，每次按 F5 或 SSMS 上的执行按钮时，都会自行识别会话并执行百分比进度！

查询是由写这篇[文章的人执行的](https://www.mssqltips.com/sqlservertip/2343/how-to-monitor-backup-and-restore-progress-in-sql-server/)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-01-28T11:20:18.910

在备份命令中添加`STATS=10`或。`STATS=1`

```
BACKUP DATABASE [xxxxxx] TO  DISK = N'E:\\Bachup_DB.bak' WITH NOFORMAT, NOINIT,  
NAME = N'xxxx-Complète Base de données Sauvegarde', SKIP, NOREWIND, NOUNLOAD, COMPRESSION,  STATS = 10
GO. 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-06-15T10:42:58.130

SELECT session_id as SPID, command, start_time, percent_complete, dateadd(second,estimated_completion_time/1000, getdate()) as estimate_completion_time, a.text AS Query FROM sys.dm_exec_requests r CROSS APPLY sys.dm_exec_sql_text(r.sql_handle) a WHERE r. （'备份数据库'，'备份日志'，'恢复数据库'，'恢复日志'）中的命令

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-07-23T19:52:21.800

对于在 RDS (AWS) 上运行 SQL Server 的任何人，数据库中有一个可调用的[内置过程](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/SQLServer.Procedural.Importing.html#SQLServer.Procedural.Importing.Native.Using.Poll)`msdb`，它为所有备份和恢复任务提供全面的信息：

```
exec msdb.dbo.rds_task_status; 
```

这将提供每个任务的完整概要、其配置、有关执行的详细信息（例如完成百分比和总持续时间），以及`task_info`在尝试找出备份或还原问题时非常有用的列。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-08-26T22:38:00.563

在 MS SQL Server 2012 上进行数据库还原操作时，我遇到了类似的问题。

但是，对于我自己的场景，我只需要在脚本窗口中查看**DATABASE RESTORE操作的进度**

我所要做的就是在脚本中添加 STATS 选项：

```
USE master;
GO

ALTER DATABASE mydb SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
GO

RESTORE DATABASE mydb
    FROM DISK = 'C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Backup\my_db_21-08-2020.bak'
    WITH REPLACE,
         STATS = 10,
         RESTART,
    MOVE 'my_db' TO 'C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\DATA\my_db.mdf',
    MOVE 'my_db_log' TO 'C:\Program Files\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\DATA\mydb_log.ldf'
GO

ALTER DATABASE mydb SET MULTI_USER;
GO 
```

然后我切换到Script 窗口的**Messages选项卡，查看****DATABASE RESTORE**操作的进度：

[![在此处输入图像描述](https://i.stack.imgur.com/sD4Tv.png)](https://i.stack.imgur.com/sD4Tv.png)

如果您想在 DATABASE RESTORE 操作**后**获取更多信息，可以使用[eythort](https://stackoverflow.com/users/1934989/eythort)建议的以下命令：

```
SELECT command, percent_complete, start_time FROM sys.dm_exec_requests where command = 'RESTORE DATABASE' 
```

就这样。

**我希望这有帮助**

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-04-07T01:19:22.420

完全独立于启动备份或恢复的会话来监控备份或恢复进度。无需第三方工具。在 Microsoft SQL Server 2012 上测试。

```
SELECT percent_complete, *
FROM sys.dm_exec_requests
WHERE command In ( 'RESTORE DATABASE', 'BACKUP DATABASE' ) 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-25T15:36:20.380

我正在使用 sp_whoisactive，它提供了非常丰富的信息，是一个基本的行业标准。它也返回完成百分比。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2017-07-05T03:46:53.213

只需在主数据库上运行 bkp_status 即可获得备份状态

# networking - What is the difference between a port and a socket?

> ID：152457
> 
> 赞同：1061
> 
> 时间：2008-09-30T10:04:01.180
> 
> 标签：networking, sockets, port

This was a question raised by one of the software engineers in my organisation. I'm interested in the broadest definition.

* * *

## 回答 #1

> 赞同：1096
> 
> 时间：2008-09-30T12:40:19.480

## 概括

**TCP 套接字是***在特定 TCP 连接或侦听状态的上下文中由 IP 地址和端口定义的端点***实例。****

 ***端口是**定义服务端点的虚拟化标识符（不同于服务*实例*端点，即会话标识符）。

**TCP 套接字*不是*连接**，它是特定连接的端点。

**可以有到服务端点的并发连接，因为连接***由其本地和远程*端点标识，从而允许将流量路由到特定的服务实例。

**对于给定的地址/端口组合，只能有一个侦听器套接字**。

## 博览会

这是一个有趣的问题，它迫使我重新审视一些我认为我完全了解的事情。您可能会认为“socket”之类的名称是不言自明的：显然选择它是为了唤起您插入网络电缆的端点的图像，具有强大的功能相似性。然而，用网络术语来说，“socket”这个词承载了太多的包袱，以至于需要仔细重新检查。

在最广泛的意义上，端口是入口或出口点。尽管没有在网络环境中使用，但法语单词*porte*的字面意思是*门或网关*，进一步强调了无论您运送数据还是大型钢制集装箱，端口都是运输端点的事实。

出于讨论的目的，我将把考虑限制在 TCP-IP 网络的上下文中。OSI 模型非常好，但从未完全实施，更不用说在高流量高压力条件下广泛部署。

IP 地址和端口的组合严格称为端点，有时也称为套接字。这种用法源于 RFC793，即原始 TCP 规范。

TCP*连接*由两个端点（即*套接字*）定义。

端点（套接字）由网络地址和*端口*标识符的组合定义。请注意，地址/端口并*不能*完全识别套接字（稍后会详细介绍）。

端口的目的是区分给定网络地址上的多个端点。您可以说端口是虚拟化端点。这种虚拟化使单个网络接口上的多个并发连接成为可能。

> 它是套接字对（由客户端 IP 地址、客户端端口号、服务器 IP 地址和服务器端口号组成的 4 元组）指定唯一标识 Internet 中每个 TCP 连接的两个端点。（*TCP-IP 图解第 1 卷*，W. Richard Stevens）

在大多数 C 派生语言中，TCP 连接是使用 Socket 类实例上的方法建立和操作的。尽管在更高的抽象级别上操作很常见，通常是 NetworkStream 类的实例，但这通常会公开对套接字对象的引用。对于编码人员来说，这个套接字对象似乎代表了连接，因为连接是使用套接字对象的方法创建和操作的。

在 C# 中，要建立 TCP 连接（到现有侦听器），首先要创建一个*TcpClient*。如果您没有为*TcpClient*构造函数指定端点，则它使用默认值 - 一种或另一种定义本地端点的方式。然后在您创建的实例上调用*Connect* 方法。此方法需要一个描述另一个端点的参数。

所有这一切都有点令人困惑，并让您相信套接字是一个连接，这是胡说八道。在理查德·多尔曼问这个问题之前，我一直在这种误解下苦苦挣扎。

*经过大量阅读和思考，我现在确信拥有一个带有构造函数的类TcpConnection*会更有意义，该构造函数带有两个参数，*LocalEndpoint*和*RemoteEndpoint*。当本地端点可以接受默认值时，您可能支持单个参数*RemoteEndpoint 。*这在多宿主计算机上是不明确的，但可以使用路由表通过选择到远程端点的最短路径的接口来解决不明确性。

清晰度也会在其他方面得到提高。套接字*不是*通过 IP 地址和端口的组合来识别的：

> [...]TCP 使用包含本地和外部地址的所有四个值对传入的段进行多路分解：目标 IP 地址、目标端口号、源 IP 地址和源端口号。TCP 无法仅通过查看目标端口来确定哪个进程获取传入段。此外，在 [给定端口号] 的 [各种] 端点中唯一将接收传入连接请求的端点是处于侦听状态的端点。（p255，*TCP-IP 图解第 1 卷*，W. Richard Stevens）

如您所见，网络服务不仅有可能而且很有可能拥有多个具有相同地址/端口的套接字，但在特定地址/端口组合上只有一个侦听器套接字。典型的库实现提供了一个套接字类，它的一个实例用于创建和管理连接。这是非常不幸的，因为它会引起混淆并导致这两个概念的广泛混为一谈。

Hagrawal 不相信我（见评论）所以这是一个真实的样本。我将网络浏览器连接到[http://dilbert.com](http://dilbert.com)，然后运行`netstat -an -p tcp`​​. 输出的最后六行包含地址和端口不足以唯一标识套接字这一事实的两个示例。192.168.1.3（我的工作站）和 54.252.94.236:80（远程 HTTP 服务器）之间有两个不同的连接

```
 TCP    192.168.1.3:63240      54.252.94.236:80       SYN_SENT
  TCP    192.168.1.3:63241      54.252.94.236:80       SYN_SENT
  TCP    192.168.1.3:63242      207.38.110.62:80       SYN_SENT
  TCP    192.168.1.3:63243      207.38.110.62:80       SYN_SENT
  TCP    192.168.1.3:64161      65.54.225.168:443      ESTABLISHED 
```

由于套接字是连接的端点，因此有两个具有地址/端口组合的套接字`207.38.110.62:80`和另外两个具有地址/端口组合的套接字`54.252.94.236:80`。

我认为 Hagrawal 的误解源于我非常谨慎地使用了“识别”这个词。我的意思是“完全、明确和唯一地标识”。在上面的示例中，有两个端点具有地址/端口组合`54.252.94.236:80`。如果您只有地址和端口，那么您就没有足够的信息来区分这些套接字。*识别*套接字的信息不足。

## 附录

RFC793 第 2.7 节的第二段说

> 连接完全由两端的套接字对指定。本地套接字可能参与到不同外部套接字的许多连接。

从编程的角度来看，套接字的这种定义没有帮助，因为它与套接字*对象*不同，后者是特定连接的端点。对于程序员来说，这个问题的大多数听众都是程序员，这是一个至关重要的功能差异。

@plugwash 做了一个突出的观察。

> 根本问题是 TCP RFC 对 socket 的定义与所有主要操作系统和库使用的 socket 定义相冲突。

根据定义，RFC 是正确的。当图书馆滥用术语时，这不会取代 RFC。相反，它给该图书馆的用户施加了理解两种解释并小心措辞和上下文的责任负担。如果 RFC 不同意，则最新且最直接适用的 RFC 优先。

## 参考

1.  *TCP-IP 图解第 1 卷协议*，W. Richard Stevens，1994 年 Addison Wesley

2.  *[RFC793](https://www.rfc-editor.org/rfc/rfc793)*，DARPA 南加州大学信息科学研究所

3.  *[RFC147](https://www.rfc-editor.org/rfc/rfc147)*，套接字的定义，Joel M. Winett，林肯实验室

* * *

## 回答 #2

> 赞同：200
> 
> 时间：2012-08-02T17:10:13.293

一个套接字由三部分组成：

1.  IP 地址
2.  传输协议
3.  一个端口号

端口是介于 1 和 65535 之间的数字，表示设备中的逻辑门。客户端和服务器之间的每个连接都需要一个唯一的套接字。

例如：

*   1030是一个端口。
*   (10.1.1.2 , TCP , 端口 1030) 是一个套接字。

* * *

## 回答 #3

> 赞同：121
> 
> 时间：2008-09-30T10:07:47.630

**A socket** represents a single connection between two network applications. These two applications nominally run on different computers, but sockets can also be used for interprocess communication on a single computer. Applications can create multiple sockets for communicating with each other. Sockets are bidirectional, meaning that either side of the connection is capable of both sending and receiving data. Therefore a socket can be created theoretically at any level of the OSI model from 2 upwards. Programmers often use sockets in network programming, albeit indirectly. Programming libraries like Winsock hide many of the low-level details of socket programming. Sockets have been in widespread use since the early 1980s.

**A port** represents an endpoint or "channel" for network communications. Port numbers allow different applications on the same computer to utilize network resources without interfering with each other. Port numbers most commonly appear in network programming, particularly socket programming. Sometimes, though, port numbers are made visible to the casual user. For example, some Web sites a person visits on the Internet use a URL like the following:

[http://www.mairie-metz.fr:8080/](http://www.mairie-metz.fr:8080/) In this example, the number 8080 refers to the port number used by the Web browser to connect to the Web server. Normally, a Web site uses port number 80 and this number need not be included with the URL (although it can be).

In IP networking, port numbers can theoretically range from 0 to 65535\. Most popular network applications, though, use port numbers at the low end of the range (such as 80 for HTTP).

Note: The term port also refers to several other aspects of network technology. A port can refer to a physical connection point for peripheral devices such as serial, parallel, and USB ports. The term port also refers to certain Ethernet connection points, such as those on a hub, switch, or router.

ref [http://compnetworking.about.com/od/basicnetworkingconcepts/l/bldef_port.htm](http://compnetworking.about.com/od/basicnetworkingconcepts/l/bldef_port.htm)

ref [http://compnetworking.about.com/od/itinformationtechnology/l/bldef_socket.htm](http://compnetworking.about.com/od/itinformationtechnology/l/bldef_socket.htm)

* * *

## 回答 #4

> 赞同：106
> 
> 时间：2016-06-20T09:57:32.480

**打个比方**

虽然上面已经为**套接字**提供了很多技术性的东西......我想补充一下我的答案，以防万一，**如果有人仍然感觉不到 ip、端口和套接字之间的区别**

**考虑一个服务器 S**，

并说**人 X、Y、Z**需要来自该**服务器 S的服务（比如聊天服务）**

然后

**IP 地址告诉**-->***谁？****是 X,Y,Z 想要联系的聊天服务器“S”吗*

*好的，你得到了“谁是服务器”*

但是假设服务器'S'也向其他人提供一些其他服务，比如*'S'为人A、B、C提供存储服务*

*然后*

**端口告诉**--->**哪个？**您*（X，Y，Z）*需要的服务，即聊天服务而不是存储服务

*好吧..，你让服务器知道“聊天服务”是你想要的，而不是存储*

但

你是三岁，*服务器可能想以不同的方式识别这三个*

**插座**来了

 **现在**socket告诉**->***哪一个？****特定连接*

也就是说，说，

*用于人员 X 的插座 1*

*Y 人插座 2*

*和用于人 Z 的插座 3*

我希望它可以帮助仍然困惑的人:)

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2012-04-07T20:17:03.470

首先，我认为我们应该首先了解从 A 到 B 获取数据包的构成。

网络的一个常见定义是使用[OSI 模型](http://en.wikipedia.org/wiki/OSI_model)，该模型根据目的将网络分成多个层。有一些重要的，我们将在这里介绍：

*   *数据链路*层。该层负责将数据包从一个网络设备传输到另一个网络设备，并且位于实际进行传输的层之上。它谈论 MAC 地址并知道如何根据 MA​​C（硬件）地址查找主机，但仅此而已。
*   *网络层*是允许您跨机器和物理边界（例如物理设备）传输数据的层。网络层必须本质上支持一种额外的基于地址的机制，该机制以某种方式与物理地址相关；输入 Internet 协议 (IPv4)。IP 地址可以通过 Internet 将您的数据包从 A 传送到 B，但对如何遍历各个跃点一无所知。这是由上层根据路由信息处理的。
*   *传输*层。该层负责定义信息从 A 到 B 的获取方式以及对该行为的任何限制、检查或错误。例如，TCP 将附加信息添加到数据包中，以便可以推断数据包是否丢失。

除其他外，TCP 还包含[端口](http://en.wikipedia.org/wiki/Transmission_Control_Protocol#TCP_ports)的概念。这些实际上是 Internet Socket ( `AF_INET`) 可以绑定到的同一 IP 地址上的不同数据端点。

碰巧，[UDP](http://en.wikipedia.org/wiki/TCP_and_UDP_port)和其他传输层协议也是如此。它们在技术上*不需要*具有端口，但这些端口确实为上层中的多个应用程序提供了一种使用同一台计算机接收（并确实建立）传出连接的方法。

这将我们带到 TCP 或 UDP 连接的剖析。每个都有一个源端口和地址，以及一个目标端口和地址。这样一来，在任何给定的会话中，目标应用程序都可以从源端进行响应和接收。

因此，端口本质上是一种规范授权的方式，允许多个并发连接共享同一地址。

现在，我们需要看看您如何从应用程序的角度与外界进行通信。为此，您需要询问您的操作系统，并且由于大多数操作系统都支持 Berkeley Sockets 做事方式，我们看到我们可以创建涉及来自应用程序的端口的套接字，如下所示：

```
int fd = socket(AF_INET, SOCK_STREAM, 0); // tcp socket
int fd = socket(AF_INET, SOCK_DGRAM, 0); // udp socket
// later we bind... 
```

伟大的！所以在`sockaddr`结构中，我们将指定我们的端口和 bam！任务完成！好吧，几乎，除了：

```
int fd = socket(AF_UNIX, SOCK_STREAM, 0); 
```

也是可能的。呃，这是在工作中扔了一个扳手！

好吧，实际上它没有。我们需要做的就是提出一些适当的定义：

*   互联网套接字是 IP 地址、协议及其相关端口号的组合，服务可以在该端口号上提供数据。所以 tcp 端口 80，stackoverflow.com 是一个互联网套接字。
*   unix 套接字是文件系统中表示的 IPC 端点，例如`/var/run/database.sock`.
*   套接字 API 是一种请求应用程序能够读取和写入数据到套接字的方法。

瞧！那收拾东西了。所以在我们的计划中，

*   端口是一个数字标识符，作为传输层协议的一部分，它标识应该响应给定请求的服务号。

所以实际上，端口是形成互联网套接字的要求的一个子集。不幸的是，碰巧socket这个词的含义已经被应用于几种不同的想法。所以我衷心建议你命名你的下一个项目套接字，只是为了增加混乱;）

* * *

## 回答 #6

> 赞同：43
> 
> 时间：2008-09-30T10:05:47.213

A socket = IP Address + a port (numeric address)
Together they identify an end-point for a network connection on a machine. (Did I just flunk network 101?)

* * *

## 回答 #7

> 赞同：42
> 
> 时间：2013-12-13T10:09:45.317

通常，您会获得很多理论知识，但区分这两个概念的最简单方法之一如下：

为了获得服务，您需要一个服务号码。此服务号称为端口。就那么简单。

例如，作为服务的 HTTP 在端口 80 上运行。

现在，许多人可以请求该服务，并且建立了来自客户端-服务器的连接。会有很多联系。每个连接代表一个客户端。为了维护每个连接，服务器为每个连接创建一个套接字以维护其客户端。

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2019-02-19T07:17:59.970

这些是基本的网络概念，因此我将以简单而全面的方式对其进行解释，以便详细了解。

*   **套接字**就像电话（即用于通信的端到端设备）
*   **IP**就像您的电话号码（即您的套接字的地址）
*   **端口**就像您想与之交谈的人（即您想从该地址订购的服务）
*   套接字可以是客户端或服务器套接字（即在公司中，客户支持的电话是服务器，但您家中的电话主要是客户端）

因此网络中的套接字是绑定到一对（ip，端口）=（地址，服务）的虚拟通信设备。

**笔记：**

*   一台机器、一台计算机、一台主机、一部手机或一台 PC 可以有多个地址、多个开放端口，因此也可以有多个套接字。就像在办公室里一样，您可以拥有多个电话号码和多个可以交谈的电话。
*   开放/活动端口的存在需要您必须绑定一个套接字，因为它是使端口可访问的套接字。但是，您可能暂时有未使用的端口。
*   另请注意，在服务器套接字中，您可以将其绑定到（端口，机器的特定地址）或（端口，机器的所有地址），因为在电话中您可以连接许多电话线（电话号码）到一部电话或一条特定的电话线到电话，您仍然可以通过所有这些电话线或通过特定的电话线联系到一个人。
*   您不能像电话中那样将一个套接字与两个端口关联（绑定）通常您不能总是让两个人同时使用同一部电话。
*   高级：在同一台机器上，您不能有两个具有相同类型（客户端或服务器）以及相同端口和 ip 的套接字。但是，如果您是客户端，则可以使用两个套接字打开到服务器的两个连接，因为每个客户端套接字中的本地端口都不同）

希望能解开你的疑惑

* * *

## 回答 #9

> 赞同：31
> 
> 时间：2008-09-30T13:26:46.700

似乎有很多答案将套接字等同于两台 PC 之间的连接。我认为这是绝对不正确的。套接字一直是 1 台 PC 上的*端点*，它可能已连接也可能未连接 - 当然，我们都曾在某些时候使用过侦听器或 UDP 套接字*。重要的部分是它是可寻址的和活跃的。向 1.1.1.1:1234 发送消息不太可能工作，因为没有为该端点定义套接字。

[套接字是特定于协议的——因此TCP](http://www.networksorcery.com/enp/protocol/tcp.htm) / [IP](http://www.networksorcery.com/enp/protocol/ip.htm)和[UDP](http://www.networksorcery.com/enp/protocol/udp.htm) / [IP](http://www.networksorcery.com/enp/protocol/ip.htm)使用的唯一性的实现*（ipaddress:port）与例如[IPX](http://docsrv.sco.com/SDK_netware/IPX_Addressing.html)（网络、节点和...啊哼、套接字）不同——但不同套接字而不是一般“套接字”术语的含义。IPX 套接字号等同于 IP 端口）。但是，它们都提供了一个独特的可寻址端点。

由于 IP 已成为主导协议，端口（在网络术语中）已成为 UDP 或 TCP 端口号的同义词——它是套接字地址的一部分。

*   UDP 是无连接的——这意味着两个端点之间没有创建任何虚拟电路。但是，我们仍然将[UDP 套接字](http://www.softlab.ntua.gr/facilities/documentation/unix/unix-socket-faq/unix-socket-faq-5.html)称为端点。API 函数清楚地表明两者只是不同类型的套接字 -`SOCK_DGRAM`是 UDP（只是发送消息）和`SOCK_STREAM`TCP（创建虚拟电路）。

*   从技术上讲，IP 标头保存 IP 地址，IP 之上的协议（UDP 或 TCP）保存端口号。这使得有其他协议成为可能（例如，没有端口号但有 IP 地址信息的[ICMP ）。](http://www.networksorcery.com/enp/protocol/icmp.htm)

* * *

## 回答 #10

> 赞同：29
> 
> 时间：2014-03-19T01:31:51.733

简短的回答。

端口可以​​描述为主机内标识程序或进程的**内部**地址**。**

**套接字**可以被描述为一种编程**接口**，允许程序与互联网上或本地的其他程序或进程进行通信。

* * *

## 回答 #11

> 赞同：22
> 
> 时间：2008-09-30T10:08:29.703

They are terms from two different domains: 'port' is a concept from TCP/IP networking, 'socket' is an API (programming) thing. A 'socket' is made (in code) by taking a port and a hostname or network adapter and combining them into a data structure that you can use to send or receive data.

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2013-03-14T19:57:29.000

在阅读了优秀的投票答案后，我发现以下几点需要强调一下，我是网络编程的新手：

TCP-IP 连接是将一个地址：端口组合与另一个地址：端口组合连接起来的双向路径。因此，每当您打开从本地计算机到远程服务器上的端口（例如 www.google.com:80）的连接时，您也会将计算机上的新端口号与连接相关联，以允许服务器发送事情还给你，（例如 127.0.0.1:65234）。使用 netstat 查看机器的连接会很有帮助：

```
> netstat -nWp tcp (on OS X)
Active Internet connections
Proto Recv-Q Send-Q  Local Address          Foreign Address        (state)    
tcp4       0      0  192.168.0.6.49871      17.172.232.57.5223     ESTABLISHED
... 
```

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2008-09-30T10:24:16.920

A socket is a communication endpoint. A socket is not directly related to the TCP/IP protocol family, it can be used with any protocol your system supports. The C socket API expects you to first get a blank socket object from the system that you can then either bind to a local socket address (to directly retrieve incoming traffic for connection-less protocols or to accept incoming connection requests for connection-oriented protocols) or that you can connect to a remote socket address (for either kind of protocol). You can even do both if you want to control both, the local socket address a socket is bound to and the remote socket address a socket is connected to. For connection-less protocols connecting a socket is even optional but if you don't do that, you'll have to also pass the destination address with every packet you want to send over the socket as how else would the socket know where to send this data to? Advantage is that you can use a single socket to send packets to different socket addresses. Once you have your socket configured and maybe even connected, consider it to be a bi-directional communication pipe. You can use it to pass data to some destination and some destination can use it to pass data back to you. What you write to a socket is send out and what has been received is available for reading.

Ports on the other hand are something that only certain protocols of the TCP/IP protocol stack have. TCP and UDP packets have ports. A port is just a simple number. The combination of source port and destination port identify a communication channel between two hosts. E.g. you may have a server that shall be both, a simple HTTP server and a simple FTP server. If now a packet arrives for the address of that server, how would it know if that is a packet for the HTTP or the FTP server? Well, it will know so as the HTTP server will run on port 80 and the FTP server on port 21, so if the packet arrives with a destination port 80, it is for the HTTP server and not for the FTP server. Also the packet has a source port since without such a source port, a server could only have one connection to one IP address at a time. The source port makes it possible for a server to distinguish otherwise identical connections: they all have the same destination port, e.g. port 80, the same destination IP (the IP of the server), and the same source IP, as they all come from the same client, but as they have different source ports, the server can distinguish them from each other. And when the server sends back replies, it will do so to the port the request came from, that way the client can also distinguish different replies it receives from the same server.

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2014-06-09T12:18:36.993

套接字是一种特殊类型的文件句柄，进程使用它向操作系统请求网络服务。套接字地址是三元组：{protocol, local-address, local-process}，其中本地进程由端口号标识。

在 TCP/IP 套件中，例如：

{tcp, 193.44.234.3, 12345}

对话是两个进程之间的通信链接，因此描绘了两个进程之间的关联。关联是完全指定组成连接的两个进程的 5 元组：{protocol, local-address, local-process, foreign-address, foreign-process}

在 TCP/IP 套件中，例如：

{tcp, 193.44.234.3, 1500, 193.44.234.5, 21}

可能是一个有效的关联。

半关联是：{protocol, local-address, local-process}

或者

{协议，外国地址，外国进程}

指定连接的每一半。

半关联也称为套接字或传输地址。也就是说，套接字是可以在网络中命名和寻址的通信端点。套接字接口是通信协议的几个应用程序编程接口 (API) 之一。设计为通用通信编程接口，它首先由 4.2BSD UNIX 系统引入。虽然还没有标准化，但已经成为事实上的行业标准。

* * *

## 回答 #15

> 赞同：13
> 
> 时间：2017-01-24T17:04:15.653

# 套接字地址是 IP 地址和端口号

```
123.132.213.231         # IP address
               :1234    # port number
123.132.213.231:1234    # socket address 
```

当 2 个套接字绑定在一起时，就会发生连接。

* * *

## 回答 #16

> 赞同：9
> 
> 时间：2016-10-04T08:14:26.107

一个应用程序由一对通过网络进行通信的进程组成（客户端-服务器对）。**这些进程通过称为socket**的软件接口向网络发送和接收消息。考虑到“计算机网络：自上而下的方法”一书中提出的类比。有一个房子想和其他房子交流。在这里，house 类似于一个进程，而门类似于一个套接字。发送过程假设门的另​​一侧有一个基础设施，可以将数据传输到目的地。一旦消息到达另一端，它就会通过接收者的门（套接字）进入房屋（进程）。来自同一本书的插图可以帮助您：
[![在此处输入图像描述](https://i.stack.imgur.com/4APkp.png)](https://i.stack.imgur.com/4APkp.png)
套接字是传输层的一部分，它为应用程序提供逻辑通信。这意味着从应用程序的角度来看，两台主机直接相互连接，即使它们之间有许多路由器和/或交换机。因此，套接字本身不是连接，它是连接的终点。传输层协议仅在主机上实现，而不在中间路由器上实现。
**端口**为机器提供内部寻址方式。它的主要目的是允许多个进程通过网络发送和接收数据，而不会干扰其他进程（它们的数据）。所有套接字都提供了一个端口号。当一个段到达主机时，传输层检查该段的目标端口号。然后它将段转发到相应的套接字。将传输层段中的数据传送到正确套接字的这项工作称为**多路分解**。然后段的数据被转发到附加到套接字的进程。

* * *

## 回答 #17

> 赞同：9
> 
> 时间：2015-10-11T22:57:28.883

端口是最简单的部分，它只是套接字的唯一标识符。套接字是进程可以用来建立连接和相互通信的东西。Tall Jeff 有一个很好的电话类比，但并不完美，所以我决定修复它：

*   ip和端口~电话号码
*   插座〜电话设备
*   连接~电话
*   建立连接~呼叫号码
*   进程，远程应用程序〜人
*   消息~讲话

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2008-09-30T10:09:33.180

A socket is a structure in your software. It's more-or-less a file; it has operations like read and write. It isn't a physical thing; it's a way for your software to refer to physical things.

A port is a device-like thing. Each host has one or more networks (those are physical); a host has an address on each network. Each address can have thousands of ports.

One socket only may be using a port at an address. The socket allocates the port approximately like allocating a device for file system I/O. Once the port is allocated, no other socket can connect to that port. The port will be freed when the socket is closed.

Take a look at [TCP/IP Terminology](http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.commadmn/doc/commadmndita/tcpip_terms.htm).

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2014-04-12T14:03:11.117

来自[Oracle Java 教程](http://docs.oracle.com/javase/tutorial/networking/sockets/definition.html)：

> 套接字是网络上运行的两个程序之间双向通信链路的一个端点。套接字绑定到端口号，以便 TCP 层可以识别数据要发送到的应用程序。

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2017-04-11T12:21:55.780

> > 端口和套接字可以比作银行分行。

“银行”的楼号类似于IP地址。银行有不同的部分，例如：

1.  储蓄账户部
2.  个人贷款部
3.  房屋贷款部
4.  申诉部门

所以1（储蓄账户部门）、2（个人贷款部门）、3（房贷部门）和4（申诉部门）是端口。

现在让我们说你去开一个储蓄账户，你去银行（IP地址），然后你去“储蓄账户部门”（端口号1），然后你会遇到一个在“储蓄账户部门”工作的员工”。让我们称他为 SAVINACCOUNT_EMPLOYEE1 来开户。

SAVINGACCOUNT_EMPLOYEE1 是您的套接字描述符，因此可能有 SAVINGACCOUNT_EMPLOYEE1 到 SAVINGACCOUNT_EMPLOYEEN。这些都是套接字描述符。

同样，其他部门将有员工在他们手下工作，它们类似于套接字。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2008-09-30T10:23:50.773

Port:

A port can refer to a physical connection point for peripheral devices such as serial, parallel, and USB ports. The term port also refers to certain Ethernet connection points, s uch as those on a hub, switch, or router.

Socket:

A socket represents a single connection between two network applications. These two applications nominally run on different computers, but sockets can also be used for interprocess communication on a single computer. Applications can create multiple sockets for communicating with each other. Sockets are bidirectional, meaning that either side of the connection is capable of both sending and receiving data.

* * *

## 回答 #22

> 赞同：5
> 
> 时间：2008-09-30T12:12:06.240

我认为这个问题暗示了相对 TCP/IP 术语。通俗地说：

PORT 就像特定邮政编码中特定房屋的电话号码。镇的邮政编码可以被认为是该镇和该镇所有房屋的 IP 地址。

另一方面，SOCKET 更像是在一对房子的电话之间建立的电话通话。可以在同一城镇的房屋之间或不同城镇的两所房屋之间建立这些呼叫。SOCKET 就是这对电话之间相互通话的临时建立的通路。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2008-09-30T10:08:55.303

A socket is a data I/O mechanism. A port is a *contractual* concept of a *communication protocol*. A socket can exist without a port. A port can exist witout a specific socket (e.g. if several sockets are active on the same port, which may be allowed for some protocols).

A port is used to determine which socket the receiver should route the packet to, with many protocols, but it is not always required and the receiving socket selection can be done by other means - a port is entirely a tool used by the protocol handler in the network subsystem. e.g. if a protocol does not use a port, packets can go to all listening sockets or any socket.

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2008-12-31T07:47:21.167

从广义上讲，Socket - 就是一个插座，就像你的电气、电缆或电话插座一样。“必要的东西”（电源、信号、信息）可以进出的点。它隐藏了很多详细的东西，这对于使用“必要的东西”来说是不需要的。用软件术语来说，它提供了一种定义两个实体之间通信机制的通用方法（这些实体可以是任何东西——两个应用程序、两个物理上独立的设备、操作系统中的用户和内核空间等）

端口是端点鉴别器。它将一个端点与另一个端点区分开来。在网络级别，它将一个应用程序与另一个应用程序区分开来，以便网络堆栈可以将信息传递给适当的应用程序。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2008-09-30T10:08:53.290

A socket is basically an endpoint for network communication, consisting of at least an IP-address and a port. In Java/C# a socket is a higher level implementation of one side of a two-way connection.

Also, a definition in the [Java documentation](http://java.sun.com/docs/books/tutorial/networking/sockets/definition.html).

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-09-30T10:28:36.253

A port denotes a communication endpoint in the TCP and UDP transports for the IP network protocol. A socket is a software abstraction for a communication endpoint commonly used in implementations of these protocols (socket API). An alternative implementation is the XTI/TLI API.

See also:

Stevens, W. R. 1998, UNIX Network Programming: Networking APIs: Sockets and XTI; Volume 1, Prentice Hall.
Stevens, W. R., 1994, TCP/IP Illustrated, Volume 1: The Protocols, Addison-Wesley.

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2013-10-16T10:08:44.013

Socket 是内核为用户应用程序提供的用于数据 I/O 的抽象。套接字类型由它所处理的协议、IPC 通信等定义。因此，如果有人创建了 TCP 套接字，他可以通过简单的方法和较低级别的协议处理（如 TCP 转换和将数据包转发到较低级别的网络协议是由内核中的特定套接字实现完成的。优点是用户不必担心处理协议特定的细节，而应该像普通缓冲区一样读取和写入数据到套接字。在 IPC 的情况下也是如此，用户只是读取和写入数据到套接字，内核根据创建的套接字类型处理所有较低级别的细节。

端口与 IP 一起就像为套接字提供一个地址，虽然它不是必需的，但它有助于网络通信。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2013-06-26T12:57:17.100

已经对这个问题给出了理论上的答案。我想对这个问题举一个实际的例子，这将清楚你对 Socket 和 Port 的理解。

我在[这里找到了](http://www.dummies.com/how-to/content/network-basics-tcpudp-socket-and-port-overview.html)

> 此示例将引导您完成连接到网站（例如 Wiley）的过程。您将打开您的网络浏览器（如 Mozilla Firefox）并在地址栏中输入 www.wiley.com。您的网络浏览器使用域名系统 (DNS) 服务器来查找名称 www.wiley.com 以识别其 IP 地址。对于此示例，地址为 192.0.2.100。
> 
> Firefox 与 192.0.2.100 地址和应用层 Web 服务器运行的端口建立连接。Firefox 知道预期的端口，因为它是众所周知的端口。Web 服务器的著名端口是 TCP 端口 80。
> 
> Firefox 尝试连接的目标套接字写为 socket:port，或在本例中为 192.0.2.100:80。这是连接的服务器端，但服务器需要知道将要在 Mozilla Firefox 中查看的网页发送到哪里，因此您也有一个用于连接客户端的套接字。
> 
> 客户端连接由您的 IP 地址（例如 192.168.1.25）和随机选择的动态端口号组成。与 Firefox 关联的套接字看起来像 192.168.1.25:49175。因为 Web 服务器在 TCP 端口 80 上运行，所以这两个套接字都是 TCP 套接字，而如果您连接到在 UDP 端口上运行的服务器，则服务器和客户端套接字都是 UDP 套接字。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2018-10-22T14:59:51.290

Socket 是网络端点的 SW 抽象，用作应用程序的接口。在 Java 中，C# 由对象表示，在 Linux 中，Unix 是文件。

如果要建立通信，端口只是您指定的套接字的属性。要从套接字接收数据包，您必须将其绑定到特定的本地端口和 NIC（具有本地 IP 地址）或所有 NIC（在绑定调用中指定 INADDR_ANY）。要发送数据包，您必须指定远程套接字的端口和 IP。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2015-08-31T03:43:01.800

单个端口可以有一个或多个与不同外部 IP 连接的插座，例如多个电源插座。

```
 TCP    192.168.100.2:9001     155.94.246.179:39255   ESTABLISHED     1312
  TCP    192.168.100.2:9001     171.25.193.9:61832     ESTABLISHED     1312
  TCP    192.168.100.2:9001     178.62.199.226:37912   ESTABLISHED     1312
  TCP    192.168.100.2:9001     188.193.64.150:40900   ESTABLISHED     1312
  TCP    192.168.100.2:9001     198.23.194.149:43970   ESTABLISHED     1312
  TCP    192.168.100.2:9001     198.49.73.11:38842     ESTABLISHED     1312 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2016-08-21T17:33:17.823

我知道有很多解释。但是，还有一种更简单的方法可以通过实际示例来理解。我们都可以连接到 HTTP 端口 80，但这是否意味着一次只有一个用户可以连接到该端口？答案显然是“不”。用于多种目的的多个用户可以访问 HTTP 端口 80，但他们仍然可以从服务器获得他们正在等待的正确响应，不是吗？现在想一想，如何？是的，你是对的，它的**IP 地址**唯一标识出于不同目的联系的不同用户。如果您在到达这里之前已经阅读了以前的答案，您就会知道 IP 地址是套接字包含的信息的一部分。想一想，是否有可能在没有套接字的情况下进行通信？答案是“是”，但您不能在一个端口中运行多个应用程序，但我们知道我们不是仅在硬件上运行的“转储”开关。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-06-17T09:13:59.357

Uff .. 太多人将套接字概念与两个端点通信联系起来，主要是在 TCP/IP 协议上。但：

*   **NO** - 套接字与两个端点通信无关。它是本地端点，可以或不能在另一端连接（考虑一个服务器套接字侦听传入连接）
*   **NO** - 套接字它与 TCP/IP 没有严格的关系。它是用一个协议定义的，它可以是 TCP/IP，但也可以是其他任何东西。例如，您可以拥有通过文件进行通信的套接字。您还可以自己实现一个新协议，通过 USB 灯进行通信，该灯通过闪烁发送数据：从应用程序的角度来看，这仍然是一个套接字。

关于端口概念，您在其他答案中阅读的内容是正确的。端口主要是 TCP 或 UDP 数据包中的数值（2 个字节，0-65535）。让我强调一下，TCP 或 UPD 不一定在 IP 之上使用。所以：

*   **否**- 说端口是 TCP/IP 或 UDP/IP 的一部分是不正确的。它是 TCP 或 UDP 或定义和使用它的任何其他协议的一部分。IP不知道端口是什么。

* * *

## 回答 #33

> 赞同：-1
> 
> 时间：2013-03-18T14:56:27.880

端口是网络协议用来访问连接主机的实体。端口可以​​是特定于应用程序的或与某种通信介质相关的。不同的协议使用不同的端口访问主机，例如 HTTP 使用端口 80 或 FTP 使用端口 23。您可以在应用程序中分配用户定义的端口号，但它们应该在 1023 以上。

端口打开与所需主机的连接，而套接字是网络间或进程间通信中的端点。套接字由系统通过 API（应用程序编程接口）分配。

一个更微妙的区别可以说是，当系统重新启动时，端口将存在，而套接字将被破坏。

* * *

## 回答 #34

> 赞同：-1
> 
> 时间：2015-08-19T18:30:35.247

尽可能简单，插座和端口之间没有*物理*区别，就像 PATA 和 SATA 之间的方式一样。它们只是读取和写入 NIC 的一些软件。

端口本质上是一个*公共*套接字，其中一些是众所周知的/被广泛接受的，通常的例子是 80，专用于 HTTP。任何想要使用某种协议（在本例中为 HTTP）交换流量的人都典型地转到端口 80。当然，80 在*物理*上并不专用于 HTTP（它在物理上不是任何东西，它只是一个数字，一个逻辑值），并且可以可以在某些特定机器上随意使用其他协议，只要那些尝试连接的人知道要使用哪个协议（可能是非常私有的）。

套接字本质上是一个*私有*端口，它是为连接方已知但其他人不一定知道的特定目的而建立的。底层*传输层*通常是 TCP 或 UDP，但并非必须如此。基本特征是两端都知道发生了什么，无论发生什么。

这里的关键是，当在某个端口上接收到连接请求时，应答握手包含有关为服务特定请求者而创建的套接字的信息。随后的通信通过该（私有）套接字连接进行，而不是服务继续侦听连接请求的公共端口连接。

* * *

## 回答 #35

> 赞同：-2
> 
> 时间：2010-01-28T08:37:08.993

为本地地址 + 本地端口 + 对等地址 + 对等端口呈现连接套接字 (fd)。通过套接字抽象处理接收/发送数据。为本地地址+本地侦听端口提供侦听套接字（fd）。进程可以通过套接字接受新连接。

* * *

## 回答 #36

> 赞同：-4
> 
> 时间：2015-03-05T08:57:55.320

套接字允许在单台机器或两台机器中的两个应用程序之间进行通信。实际上它就像门一样。如果门打开，则门内和门外的进程或应用程序之间可能存在联系。

有 4 种类型的套接字：

*   流套接字
*   数据报套接字
*   原始套接字
*   顺序数据包套接字。

套接字主要用于客户端-服务器应用程序。端口标识网络地址上的不同端点。它包含一个数值。总的来说，套接字是端口和网络地址的组合。

# java - Running a J6SE app on an NT box

> ID：152462
> 
> 赞同：4
> 
> 时间：2008-09-30T10:05:32.660
> 
> 标签：java, nt, windows-nt

I need to run a Java application, which we are trying to port to Java 6, on an NT box.

I manage to run java 5 on it (although not officially supported), but when I try to run java 6 I get the following error:

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: C:\Program Files\Java\jre1.6.0_05\bin\awt.dll: The specified procedure could not be found
at java.lang.ClassLoader$NativeLibrary.load(Native Method)
    at java.lang.ClassLoader.loadLibrary0(Unknown Source)
    at java.lang.ClassLoader.loadLibrary(Unknown Source)
    at java.lang.Runtime.loadLibrary0(Unknown Source)
    at java.lang.System.loadLibrary(Unknown Source)
    at sun.security.action.LoadLibraryAction.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at sun.awt.NativeLibLoader.loadLibraries(Unknown Source)
    at sun.awt.DebugHelper.<clinit>(Unknown Source)
    at java.awt.EventQueue.<clinit>(Unknown Source)
    at javax.swing.SwingUtilities.invokeLater(Unknown Source)
    at ui.sequencer.test.WindowTest.main(WindowTest.java:136) 
```

Anybody has any idea how to solve this?

This persists even when I move the java executables to another directory with no spaces in its name.

p.s. I know, I should upgrade, but it's not up to me or my company - this is a very very bug huge gigantic company we work with, and they intend to keep NT for another 5 years.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-03T09:16:10.367

好的，感谢所有观众以及@Roel Spiker 和@Partyzant 的回答。

**这是不可能的。**除非你在 NT 机器上安装 windows2000。这是因为 awt.dll fr J6SE 在 User32.dll 中使用了新方法，它是 windows 操作系统的一部分（链接到 kernel.dll 等）。使用 dll 依赖walker 自己看看。另一种可能的解决方案是稍微改变 OpenJDK 以使用 Windows NT 中可用的其他方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T10:14:00.640

Java SE 6 [requires](http://java.sun.com/javase/6/webnotes/install/system-configurations.html) at least Windows 2000.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T11:12:26.663

如果您没有使用 GUI，例如 AWT、Swing 或 SWT，您可以尝试以无头模式启动应用程序。有关详细信息，请参阅[http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/](http://java.sun.com/developer/technicalArticles/J2SE/Desktop/headless/)。要以无头模式启动 java，请使用`java -Djava.awt.headless=true`

它将处理 UnsatisfiedLinkError。我不知道这是否是唯一的障碍。

# unix - 在 Unix 中远程更改用户密码的最佳方法是什么？

> ID：152468
> 
> 赞同：3
> 
> 时间：2008-09-30T10:07:18.880
> 
> 标签：unix, change-password

在 Unix 中远程更改用户密码的最佳方法是什么？这必须由用户在 Web 应用程序或 Windows 应用程序中执行，而不使用 SSH 或用户与服务器之间的任何直接连接（不允许直接命令行）。

谢谢

* * *

Webmin 似乎是一个很好的应用程序，但我发现很难正确配置它。我的 Unix 用户无法登录到 Webmin 或 Usermin。

你知道 Webmin 和 Usermin 的其他替代品吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T10:10:20.010

使用[Webmin](http://www.webmin.com/)（更具体地说是[UserMin](http://www.webmin.com/usermin.html)模块）。

Webmin 提供了一个迷你网络服务器，因此您只需要稍微安装和配置它。您将获得的不仅仅是更改密码，还可以删除您不希望用户拥有的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T10:32:54.667

@Rich Bradshaw

只要确保不引入**安全问题**。该解决方案应使用 https 加密（密码不应以明文形式发送）。应该保护它免受外壳注入攻击（从输入中删除任何换行符，正确转义等）。更多细节取决于选择的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T11:02:02.427

我过去曾这样做过，通过使用用 Expect 编写的脚本一次更改多台服务器上的密码。它非常适合这项工作，但您需要服务器通过 SSH 进行监听。

编写完成后，脚本将在您的本地工作站上执行，并连接到远程主机，进行您编写的交互，然后您就应该是金牌了。一直以来，如果您正在运行 SSH，则使用您已经信任的加密。只是不要将密码保存在脚本中：您应该能够提示自己输入密码（即使通过命令行参数获取密码通常也被认为是不好的做法。）

Expect 也是一门很棒的语言：很有趣！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T10:11:35.187

您可以编写一个运行 passwd 的服务器端脚本，您可以使用任何允许运行 shell 命令的语言来执行此操作。

# asp.net - ASP.NET 用户登录最佳实践

> ID：152469
> 
> 赞同：9
> 
> 时间：2008-09-30T10:07:40.267
> 
> 标签：asp.net, asp.net-mvc

我想使用 ASP.NET (MVC) 创建一个登录系统。

在互联网上，我发现了一些在 Click 事件中涉及 SQL 的不良示例。其他信息指向 ASP.NET 内置成员资格提供程序。

但是，我想自己动手。我不想使用内置的成员资格提供程序，因为它似乎只适用于 MS SQL，而且我不喜欢在我的数据库中有一些外部表的想法。

我可能会想到一些东西，但我需要一些正确方向的指示。它不必是高安全性，而只是常规的常识性安全性。

我有几个直接的问题：

1.  许多系统似乎将会话 ID 存储在用户表中。我想这是为了将会话绑定到用户以防止劫持。每次用户进入页面时都要检查一下吗？如果会话到期我该怎么办？

2.  散列，加盐，它有什么作用？我知道 MD5 散列，并且我以前使用过它。但不加盐。

3.  Cookie 的最佳做法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T10:30:44.890

我不知道最佳实践，但我可以告诉你我在做什么。它不是高科技安全性，但它可以完成这项工作。

我使用表单身份验证。我通过登录页面上的文本框收到使用 ssl 保护的密码。我拿那个密码并散列它。（散列就像单向加密，你可以获得无法反转回密码的散列码）。我将那个哈希值与数据库中的用户哈希值进行比较。如果哈希匹配，我使用 asp.nets 内置的身份验证处理，它为我处理 cookie。

FormsAuthentication 类具有可用于执行此操作的方法，例如 SetAuthCookie 和 RedirectFromLogin。他们将设置 cookie 并将其标记为已通过身份验证。asp.net 使用的 cookie 是加密的。虽然我不能说它的安全级别，但它的使用相当普遍。

在我的课堂上，我进行密码检查并使用 formsauth 来处理其余部分：

```
if(SecurityHelper.LoginUser(txtUsername.Text, txtPassword.Text))
{    
    FormsAuthentication.RedirectFromLoginPage(txtUsername.Text, true);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T10:34:17.050

您可以使用 ASP.NET 基础结构实现您自己的成员资格提供程序，请参阅[MemberShipProvider 类的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T11:05:10.783

内置提供程序运行良好。它确实适用于 MySQL，尽管我发现它不像 MS SQL 版本那么简单。如果您可以使用 then do，它将为您节省数小时的工作时间。

如果您需要使用另一个数据存储，那么我同意 axel_c，如果我要自己推出，那么我会根据 MS 规范编写会员提供程序。对于跟随您的任何开发人员，它将使代码更易于维护。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T11:44:54.260

加盐是在被散列的任何内容中添加一个独特的字符串的做法。假设`mySalt = abc123`我的密码是`passwd`. 在 PHP 中，我会使用`hashResult = md5(mySalt + password)`.

假设字符串被截获。您尝试匹配字符串，但最终匹配乱码，因为密码在加密之前已加盐。请记住，用于盐的任何物质在整个应用程序中都必须是连续的。如果在存储之前对密码加盐，则必须将散列的加盐密码与数据库进行比较。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T13:00:11.100

您可以使用内置的 SQL 成员资格提供程序 - 如果您不希望数据库中的 .Net 成员资格表，您可以设置一个专用的“用户访问”数据库 - 只需在连接字符串中指定。

提供者模型的优势在于应用程序级别，代码与您使用的特定身份验证存储无关。

asp.net 网站上有一系列很好的教程：

[链接文本](http://www.asp.net/learn/security/ "安全教程")

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-09-30T10:24:49.210

我会避免整个问题并使用openid。有一个可用的库，您可以直接使用。 [这是关于将其放置到位的博客文章的链接](http://blog.wekeroad.com/blog/my-mvc-starter-template/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-30T11:23:10.583

microsoft 的 Membership Provider 的一个缺点是您不能在域驱动的方法中使用它。如果您愿意，您可以使用自己的密码哈希创建自己的用户对象，并且仍然使用 Microsoft 提供的身份验证 cookie。使用这些身份验证 cookie 意味着您不必自己管理会话 ID。

```
public void SignIn(User user)
        {
            FormsAuthentication.SignOut();
           var ticket = new FormsAuthenticationTicket(1, user.UserName, DateTime.Now.AddMinutes(30), expires, alse, null);
            var encryptedTicket = FormsAuthentication.Encrypt(ticket);
            var authCookie = new HttpCookie(FormsAuthentication.FormsCookieName, encryptedTicket)
            {
                Expires = ticket.Expiration
            };

            httpContextProvider.GetCurrentHttpContext().Response.Cookies.Add(authCookie);
        }

    public void SignOut()
    {
        FormsAuthentication.SignOut();
    } 
```

我使用自己的用户对象和表。我将散列的密码存储在用户表中，每个用户都有一个唯一的盐。这是安全的，易于实施，并且适合您的设计。您的数据库表不会被 Microsoft 的会员提供商废话污染。

# javascript - 有没有办法打印对象的所有方法？

> ID：152483
> 
> 赞同：73
> 
> 时间：2008-09-30T10:09:58.920
> 
> 标签：javascript

有没有办法在 JavaScript 中打印对象的所有方法？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2008-09-30T10:55:23.693

当然：

```
function getMethods(obj) {
  var result = [];
  for (var id in obj) {
    try {
      if (typeof(obj[id]) == "function") {
        result.push(id + ": " + obj[id].toString());
      }
    } catch (err) {
      result.push(id + ": inaccessible");
    }
  }
  return result;
} 
```

使用它：

```
alert(getMethods(document).join("\n")); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2017-10-06T16:43:40.457

如果您只想查看对象内部的内容，则可以打印所有对象的键。其中一些可以是变量，一些可以是方法。

该方法不是很准确，但是确实很快：

```
console.log(Object.keys(obj)); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-08-09T10:46:09.440

这是一个`ES6`示例。

```
// Get the Object's methods names:
function getMethodsNames(obj = this) {
    return Object.keys(obj)
        .filter((key) => typeof obj[key] === 'function');
}

// Get the Object's methods (functions):
function getMethods(obj = this) {
    return Object.keys(obj)
        .filter((key) => typeof obj[key] === 'function')
        .map((key) => obj[key]);
} 
```

`obj = this`是一个 ES6 默认参数，你可以传入一个 Object 或者它会默认为`this`.

`Object.keys``Object`返回的 自己的可枚举属性的 Array 。在`window`Object 上它会返回`[..., 'localStorage', ...'location']`。

`(param) => ...`是一个 ES6 箭头函数，它是

```
function(param) {
    return ...
} 
```

隐式返回。

`Array.filter`创建一个包含所有通过测试 ( `typeof obj[key] === 'function'`) 的元素的新数组。

`Array.map`创建一个新数组，其结果是对该数组中的每个元素调用提供的函数（返回`obj[key]`）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-30T10:46:20.377

看看这段代码：-

```
function writeLn(s)
{
    //your code to write a line to stdout
    WScript.Echo(s)
}

function Base() {}
Base.prototype.methodA = function() {}
Base.prototype.attribA = "hello"

var derived = new Base()
derived.methodB = function() {}
derived.attribB = "world";

function getMethods(obj)
{
    var retVal = {}

    for (var candidate in obj)
    {
        if (typeof(obj[candidate]) == "function")
            retVal[candidate] = {func: obj[candidate], inherited: !obj.hasOwnProperty(candidate)}
    }
    return retVal
}

var result = getMethods(derived)
for (var name in result)
{
    writeLn(name + " is " + (result[name].inherited ? "" : "not") + " inherited")
} 
```

getMethod 函数返回一组方法以及该方法是否是从原型继承的方法。

请注意，如果您打算在从上下文提供的对象（例如浏览器/DOM 对象）上使用它，那么它在 IE 中不起作用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T10:15:09.000

从[这里](http://www.javascriptkit.com/jsref/looping.shtml)：

示例 1：此示例写出“导航器”对象的所有属性，以及它们的值：

```
for (var myprop in navigator){
 document.write(myprop+": "+navigator[myprop]+"<br>")
} 
```

只需将“导航器”替换为您感兴趣的任何对象，您就可以开始使用了。

正如 Anthony 在评论部分中提到的 - 这将返回所有属性，而不仅仅是问题所要求的方法。

哎呀！这将教会我尝试用我不懂的语言回答问题。不过，我认为代码很有用——只是不是所需的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T10:51:23.237

由于 JavaScript 中的方法只是作为函数的属性，因此 for..in 循环将枚举它们并出现异常——它不会枚举内置方法。据我所知，没有办法枚举内置方法。而且您不能在无法以这种方式枚举的对象上声明自己的方法或属性。

# msbuild - MSBuild：如何获取引发的警告数量？

> ID：152487
> 
> 赞同：6
> 
> 时间：2008-09-30T10:10:43.973
> 
> 标签：msbuild, cruisecontrol.net

有一个 MSBuild 脚本，其中包括 Delphi 和 C# 项目、单元测试等的编号。

问题是：如果出现警告，如何标记构建失败（出于测试目的，而不是发布构建）？在自定义任务中使用 LogError 而不是 LogWarning 似乎不是一个好的选择，因为构建应该尽可能多地测试（直到真正的错误）一次报告尽可能多的警告（构建项目在 CruiseControl.NET 中使用）。

可能是，解决方案是创建我自己的记录器，在里面存储警告标志，但我找不到在构建结束时是否有办法读取这个标志？

PS 收到警告后立即构建失败没有问题（Delphi 编译器输出由自定义任务处理，/warnaserror 可用于 C#），但期望的行为是“构建所有内容；收集所有警告；构建失败" 报告所有警告，而不仅仅是第一个警告。

**PPS 至于我真的不需要警告的数量，而只是他们存在的标志，我决定简化信号机制，并使用微不足道的互斥体而不是共享内存。代码如下：**

```
using System;
using Microsoft.Build.Framework;
using Microsoft.Build.Utilities;
using System.Threading;

namespace Intrahealth.Build.WarningLogger
{
    public sealed class WarningLoggerCheck : Task
    {
        public override bool Execute()
        {
            Log.LogMessage("WarningLoggerCheck:" + mutexName + "...");
            result = false;
            Mutex m = null;
            try
            {
                m = Mutex.OpenExisting(mutexName);
            }
            catch (WaitHandleCannotBeOpenedException)
            {
                result = true;
            }
            catch (Exception)
            {
            }

            if (result)
                Log.LogMessage("WarningLoggerCheck PASSED");
            else
                Log.LogError("Build log contains warnings. Build is FAILED");

            return result;
        }

        private bool result = true;
        [Output]
        public bool Result
        {
            get { return result; }
        }

        private string mutexName = "WarningLoggerMutex";
        public string MutexName
        {
            get { return mutexName; }
            set { mutexName = value ?? "WarningLoggerMutex"; }
        }
    }

    public class WarningLogger : Logger
    {
        internal static int warningsCount = 0;
        private string mutexName = String.Empty;
        private Mutex mutex = null;

        public override void Initialize(IEventSource eventSource)
        {
            eventSource.WarningRaised += new BuildWarningEventHandler(eventSource_WarningRaised);
        }

        private void SetMutex()
        {
            if (mutexName == String.Empty)
            {
                mutexName = "WarningLoggerMutex";
                if (this.Parameters != null && this.Parameters != String.Empty)
                {
                    mutexName = this.Parameters;
                }
            }

            mutex = new Mutex(false, mutexName);
        }

        void eventSource_WarningRaised(object sender, BuildWarningEventArgs e)
        {
            if (e.Message != null && e.Message.Contains("MSB3146"))
                return;
            if (e.Code != null && e.Code.Equals("MSB3146"))
                return;

            if (warningsCount == 0)
                SetMutex();
            warningsCount++;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-30T11:46:49.513

AFAIK MSBuild 没有内置支持来检索构建脚本给定点的警告计数。但是，您可以按照以下步骤来实现此目标：

1.  创建一个自定义记录器，用于监听警告事件并计算警告次数
2.  创建一个公开 [Output] WarningCount 属性的自定义任务
3.  自定义任务以某种方式从自定义记录器获取警告计数的值

最困难的步骤是第 3 步。为此有几个选项，您可以在 IPC - Inter Process Comunication 下自由搜索它们。遵循如何实现这一目标的工作示例。每个项目都是一个不同的*类库*。

**共享内存**

[http://weblogs.asp.net/rosherove/archive/2003/05/01/6295.aspx](http://weblogs.asp.net/rosherove/archive/2003/05/01/6295.aspx)

> 我为作为一个更大项目的一部分的命名共享内存创建了一个包装器。它基本上允许在共享内存中存储和检索序列化类型和对象图（包括您期望的跨进程）。更大的项目是否完成是另一回事;-)。

**采样记录器**

实现跟踪警告计数的自定义记录器。

```
namespace SampleLogger
{
    using System;
    using Microsoft.Build.Utilities;
    using Microsoft.Build.Framework;
    using DM.SharedMemory;

    public class MySimpleLogger : Logger
    {
        private Segment s;
        private int warningCount;

        public override void Initialize(IEventSource eventSource)
        {
            eventSource.WarningRaised += new BuildWarningEventHandler(eventSource_WarningRaised);

            this.s = new Segment("MSBuildMetadata", SharedMemoryCreationFlag.Create, 65535);
            this.s.SetData(this.warningCount.ToString());
        }

        void eventSource_WarningRaised(object sender, BuildWarningEventArgs e)
        {
            this.warningCount++;
            this.s.SetData(this.warningCount.ToString());
        }

        public override void Shutdown()
        {
            this.s.Dispose();
            base.Shutdown();
        }
    }
} 
```

**示例任务**

实现读取 MSbuild 项目中引发的警告数量的自定义任务。自定义任务从类库*SampleLogger*中实现的自定义记录器写入的共享内存中读取。

```
namespace SampleTasks
{
    using System;
    using Microsoft.Build.Utilities;
    using Microsoft.Build.Framework;
    using DM.SharedMemory;

    public class BuildMetadata : Task
    {
        public int warningCount;

        [Output]
        public int WarningCount
        {
            get
            {
                Segment s = new Segment("MSBuildMetadata", SharedMemoryCreationFlag.Attach, 0);
                int warningCount = Int32.Parse(s.GetData() as string);
                return warningCount;
            }
        }

        public override bool Execute()
        {
            return true;
        }
    }
} 
```

去兜风。

```
<?xml version="1.0" encoding="UTF-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003" DefaultTargets="Main">
    <UsingTask TaskName="BuildMetadata" AssemblyFile="F:\temp\SampleLogger\bin\debug\SampleTasks.dll" />

    <Target Name="Main">
        <Warning Text="Sample warning #1" />
        <Warning Text="Sample warning #2" />

        <BuildMetadata>
            <Output
                TaskParameter="WarningCount"
                PropertyName="WarningCount" />
        </BuildMetadata>

        <Error Text="A total of $(WarningCount) warning(s) were raised." Condition="$(WarningCount) > 0" />
    </Target>
</Project> 
```

如果您运行以下命令：

```
c:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\MSBuild test.xml /logger:SampleLogger.dll 
```

这将是输出：

```
Microsoft (R) Build Engine Version 2.0.50727.3053
[Microsoft .NET Framework, Version 2.0.50727.3053]
Copyright (C) Microsoft Corporation 2005\. All rights reserved.

Build started 30-09-2008 13:04:39.
__________________________________________________
Project "F:\temp\SampleLogger\bin\debug\test.xml" (default targets):

Target Main:
    F:\temp\SampleLogger\bin\debug\test.xml : warning : Sample warning #1
    F:\temp\SampleLogger\bin\debug\test.xml : warning : Sample warning #2
    F:\temp\SampleLogger\bin\debug\test.xml(15,3): error : A total of 2 warning(s) were raised.
Done building target "Main" in project "test.xml" -- FAILED.

Done building project "test.xml" -- FAILED.

Build FAILED.
F:\temp\SampleLogger\bin\debug\test.xml : warning : Sample warning #1
F:\temp\SampleLogger\bin\debug\test.xml : warning : Sample warning #2
F:\temp\SampleLogger\bin\debug\test.xml(15,3): error : A total of 2 warning(s) were raised.
    2 Warning(s)
    1 Error(s)

Time Elapsed 00:00:00.01 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T10:31:24.220

C# 编译器 (csc.exe) 有一个 /warnaserror 开关，会将警告视为错误并导致构建失败。这也可用作 .csproj 文件中的设置。我认为德尔福有类似的能力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T10:39:24.357

```
msbuild.exe %~nx1 /t:Rebuild /p:Configuration=Release >> %MrB-BUILDLOG%
findstr /r /c:"[1-9][0-9]* Error(s)" >> %MrB-BUILDLOG%
if not errorlevel 1 (
   echo ERROR: sending notification email for build errors in '%~nx1'. >> %MrB-BUILDLOG%
) else (
   findstr /r /c:"[1-9][0-9]* Warning(s)" >> %MrB-BUILDLOG%
   if not errorlevel 1 (
       echo ERROR: sending notification email for build warnings in '%~nx1'. >> 
```

%MrB-BUILDLOG% ) else ( echo 成功构建 '%~nx1'。>> %MrB-BUILDLOG% ) )

# .net - 这是做什么的？任务列表 /m "mscor*"

> ID：152506
> 
> 赞同：12
> 
> 时间：2008-09-30T10:22:47.187
> 
> 标签：.net

在这里看到了这个问题：[What Great .NET Developers Ought To Know（更多 .NET 面试问题）](http://www.hanselman.com/blog/WhatGreatNETDevelopersOughtToKnowMoreNETInterviewQuestions.aspx)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-09-30T20:13:45.303

它将显示已加载托管 .NET 运行时的模块（通常是 .DLL 文件）的进程。相同的技术可用于搜索已加载的其他 DLL。

在相关说明中，[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)是 Microsoft 任务管理器的替代品，它将突出显示 .NET 进程。我不能推荐它。[与Sysinternals Suite](http://technet.microsoft.com/en-us/sysinternals/0e18b180-9b7a-4c49-8120-c47c5a693683.aspx)的其余部分一起研究非常值得。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T10:31:59.710

这是 Windows 中一个非常有用的命令行工具，它向您显示所有正在运行的进程的列表。传入 /m "mscor*" 的命令行参数会列出在您的机器上运行的所有进程，这些进程正在使用以名称“mscor”开头的程序集。“*”是通配符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T10:27:02.920

它似乎列出了使用 mscoree.dll、mscorwks.dll 等模块的所有进程。这将是 .NET 进程，也可能是托管 .NET 插件的进程。

# linux - 如何在 Linux 上将所有文件夹和文件重命名为小写？

> ID：152514
> 
> 赞同：216
> 
> 时间：2008-09-30T10:25:17.930
> 
> 标签：linux, rename, lowercase

我必须递归地重命名一个完整的文件夹树，这样任何地方都不会出现大写字母（它是 C++ 源代码，但这不重要）。

忽略 CVS 和 Subversion 版本控制文件/文件夹的奖励积分。首选方式是 shell 脚本，因为任何 Linux 机器上都应该有 shell。

关于文件重命名的细节有一些有效的论据。

1.  我认为应该覆盖具有相同小写名称的文件；这是用户的问题。当在忽略大小写的文件系统上签出时，它也会用后者覆盖第一个。

2.  我会考虑 AZ 字符并将它们转换为 az，其他一切都只是在要求问题（至少在源代码中）。

3.  在 Linux 系统上运行构建需要该脚本，所以我认为应该省略对 CVS 或 Subversion 版本控制文件的更改。毕竟，这只是一个临时结账。也许“出口”更合适。

* * *

## 回答 #1

> 赞同：294
> 
> 时间：2011-11-17T12:30:58.723

更小我很喜欢：

```
rename 'y/A-Z/a-z/' * 
```

[在 OS X 的HFS+](https://en.wikipedia.org/wiki/HFS_Plus)等不区分大小写的文件系统上，您需要添加`-f`标志：

```
rename -f 'y/A-Z/a-z/' * 
```

* * *

## 回答 #2

> 赞同：194
> 
> 时间：2008-09-30T12:03:32.720

使用`"rename"`命令的简洁版本：

```
find my_root_dir -depth -exec rename 's/(.*)\/([^\/]*)/$1\/\L$2/' {} \; 
```

这避免了目录在文件之前被重命名并试图将文件移动到不存在的目录（例如`"A/A"`进入`"a/a"`）的问题。

或者，不使用`"rename"`.

```
for SRC in `find my_root_dir -depth`
do
    DST=`dirname "${SRC}"`/`basename "${SRC}" | tr '[A-Z]' '[a-z]'`
    if [ "${SRC}" != "${DST}" ]
    then
        [ ! -e "${DST}" ] && mv -T "${SRC}" "${DST}" || echo "${SRC} was not renamed"
    fi
done 
```

### 附言

后者允许使用移动命令（例如，`"svn mv"`）具有更大的灵活性。

* * *

## 回答 #3

> 赞同：107
> 
> 时间：2008-09-30T10:36:08.637

```
for f in `find`; do mv -v "$f" "`echo $f | tr '[A-Z]' '[a-z]'`"; done 
```

* * *

## 回答 #4

> 赞同：95
> 
> 时间：2014-08-31T08:38:36.433

如果您不需要关心效率，只需尝试以下操作。

```
zip -r foo.zip foo/*
unzip -LL foo.zip 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2017-02-18T10:54:18.193

可以简单地使用以下不太复杂的方法：

```
rename 'y/A-Z/a-z/' * 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-11-09T21:08:42.557

如果您已经拥有或设置了**重命名**命令（例如通过Mac 中的[brew install ），则此方法有效：](https://en.wikipedia.org/wiki/Homebrew_%28package_management_software%29)

```
rename --lower-case --force somedir/* 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2016-04-01T15:16:06.830

这适用于[CentOS](http://en.wikipedia.org/wiki/CentOS) / [Red Hat Linux](http://en.wikipedia.org/wiki/Red_Hat_Linux)或其他没有`rename`Perl 脚本的发行版：

```
for i in $( ls | grep [A-Z] ); do mv -i "$i" "`echo $i | tr 'A-Z' 'a-z'`"; done 
```

来源：*[将所有文件名从大写字母重命名为小写字母](https://linuxconfig.org/rename-all-files-from-uppercase-to-lowercase-characters)*

（在某些发行版中，默认`rename`命令来自 util-linux，这是一个不同的、不兼容的工具。）

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2008-09-30T12:34:13.580

上面的大多数答案都是危险的，因为它们不处理包含奇数字符的名称。对于这种事情，您最安全的选择是使用`find`'`-print0`选项，它将以 ASCII NUL 而不是 \n 来终止文件名。

这是一个脚本，它只改变文件而不是目录名，以免混淆`find`：

```
find .  -type f -print0 | xargs -0n 1 bash -c \
's=$(dirname "$0")/$(basename "$0");
d=$(dirname "$0")/$(basename "$0"|tr "[A-Z]" "[a-z]"); mv -f "$s" "$d"' 
```

我对其进行了测试，它适用于包含空格、各种引号等的文件名。这很重要，因为如果您以 root 身份运行包含由

```
touch \;\ echo\ hacker::0:0:hacker:\$\'\057\'root:\$\'\057\'bin\$\'\057\'bash 
```

...好吧猜猜是什么...

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2019-05-09T16:32:00.557

我在 Mac OS X 上找到的最简单的方法是使用来自[http://plasmasturm.org/code/rename/](http://plasmasturm.org/code/rename/)的重命名包：

```
brew install rename
rename --force --lower-case --nows * 
```

> --force 即使具有目标名称的文件已经存在，也要重命名。
> 
> --lower-case 将文件名全部转换为小写。
> 
> --nows 用单个下划线字符替换文件名中的所有空格序列。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2008-09-30T10:27:20.437

这是我使用 Bash shell 脚本的次优解决方案：

```
#!/bin/bash
# First, rename all folders
for f in `find . -depth ! -name CVS -type d`; do
   g=`dirname "$f"`/`basename "$f" | tr '[A-Z]' '[a-z]'`
   if [ "xxx$f" != "xxx$g" ]; then
      echo "Renaming folder $f"
      mv -f "$f" "$g"
   fi
done

# Now, rename all files
for f in `find . ! -type d`; do
   g=`dirname "$f"`/`basename "$f" | tr '[A-Z]' '[a-z]'`
   if [ "xxx$f" != "xxx$g" ]; then
      echo "Renaming file $f"
      mv -f "$f" "$g"
   fi
done 
```

文件夹都被正确重命名，并且`mv`在权限不匹配时不会询问问题，并且 CVS 文件夹没有被重命名（不幸的是，该文件夹内的 CVS 控制文件仍然被重命名）。

由于“find -depth”和“find | sort -r”都以可用的重命名顺序返回文件夹列表，因此我更喜欢使用“-depth”来搜索文件夹。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2020-11-18T18:26:31.933

单线：

```
for F in K*; do NEWNAME=$(echo "$F" | tr '[:upper:]' '[:lower:]'); mv "$F" "$NEWNAME"; done 
```

甚至：

```
for F in K*; do mv "$F" "${F,,}"; done 
```

请注意，这只会转换以字母 K 开头的文件/目录，因此请进行相应调整。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-09-30T10:50:14.500

使用 Larry Wall 的文件名修复程序：

```
$op = shift or die $help;
chomp(@ARGV = <STDIN>) unless @ARGV;
for (@ARGV) {
    $was = $_;
    eval $op;
    die $@ if $@;
    rename($was,$_) unless $was eq $_;
} 
```

这很简单

```
find | fix 'tr/A-Z/a-z/' 
```

（`fix`当然上面的脚本在哪里）

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-09-30T11:08:29.373

最初的问题要求忽略 SVN 和 CVS 目录，这可以通过在 find 命令中添加 -prune 来完成。例如忽略 CVS：

```
find . -name CVS -prune -o -exec mv '{}' `echo {} | tr '[A-Z]' '[a-z]'` \; -print 
```

[编辑] 我试过了，在 find 中嵌入小写翻译不起作用，原因我实际上并不理解。因此，将其修改为：

```
$> cat > tolower
#!/bin/bash
mv $1 `echo $1 | tr '[:upper:]' '[:lower:]'`
^D
$> chmod u+x tolower 
$> find . -name CVS -prune -o -exec tolower '{}'  \; 
```

伊恩

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-07-18T17:16:45.627

不可移植，仅限 Zsh，但非常简洁。

首先，确保`zmv`已加载。

```
autoload -U zmv 
```

另外，请确保`extendedglob`已打开：

```
setopt extendedglob 
```

然后使用：

```
zmv '(**/)(*)~CVS~**/CVS' '${1}${(L)2}' 
```

递归小写名称不是*CVS*的文件和目录。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2008-09-30T10:54:48.767

这是一个小的 shell 脚本，可以满足您的要求：

```
root_directory="${1?-please specify parent directory}"
do_it () {
    awk '{ lc= tolower($0); if (lc != $0) print "mv \""  $0 "\" \"" lc "\"" }' | sh
}
# first the folders
find "$root_directory" -depth -type d | do_it
find "$root_directory" ! -type d | do_it 
```

请注意第一个查找中的 -depth 操作。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-02-22T18:42:51.307

```
for f in `find -depth`; do mv ${f} ${f,,} ; done 
```

`find -depth`打印每个文件和目录，并在目录本身之前打印目录的内容。`${f,,}`小写文件名。

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2017-09-29T16:09:58.943

使用[排版](https://helpmanual.io/builtin/typeset/)：

```
typeset -l new        # Always lowercase
find $topPoint |      # Not using xargs to make this more readable
  while read old
  do new="$old"       # $new is a lowercase version of $old
     mv "$old" "$new" # Quotes for those annoying embedded spaces
  done 
```

在 Windows 上，像[Git Bash](https://superuser.com/questions/1053633)这样的仿真可能会失败，因为 Windows 在后台不区分大小写。对于那些，`mv`首先将文件的步骤添加到另一个名称，例如“$old.tmp”，然后添加到`$new`.

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2015-03-25T06:25:39.747

在 OS X 中，`mv -f`显示“相同文件”错误，所以我重命名了两次：

```
for i in `find . -name "*" -type f |grep -e "[A-Z]"`; do j=`echo $i | tr '[A-Z]' '[a-z]' | sed s/\-1$//`; mv $i $i-1; mv $i-1 $j; done 
```

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2018-04-07T09:32:17.737

使用 MacOS，

安装`rename`包，

```
brew install rename 
```

采用，

```
find . -iname "*.py" -type f | xargs -I% rename -c -f  "%" 
```

此命令查找所有带有`*.py`扩展名的文件并将文件名转换为小写。

```
`f` - forces a rename 
```

例如，

```
$ find . -iname "*.py" -type f
./sample/Sample_File.py
./sample_file.py
$ find . -iname "*.py" -type f | xargs -I% rename -c -f  "%"
$ find . -iname "*.py" -type f
./sample/sample_file.py
./sample_file.py 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2018-09-24T12:12:21.570

**冗长但*“没有惊喜也没有安装”***

该脚本**处理带有空格、引号、其他*不常见*字符和 Unicode 的文件名，适用于不区分大小写的文件系统和大多数**安装了 bash 和 awk 的 Unix-y 环境（即几乎所有）。如果有任何冲突，它还会报告冲突（将文件名保留为大写），当然还会重命名文件和目录并递归工作。最后，它具有很强的适应性：您可以调整 find 命令以定位您想要的文件/目录，您可以调整 awk 来执行其他名称操作。请注意，“处理 Unicode”是指它确实会转换它们的大小写（而不是像使用 的答案那样忽略它们`tr`）。

```
# adapt the following command _IF_ you want to deal with specific files/dirs
find . -depth -mindepth 1 -exec bash -c '
  for file do
    # adapt the awk command if you wish to rename to something other than lowercase
    newname=$(dirname "$file")/$(basename "$file" | awk "{print tolower(\$0)}")
    if [ "$file" != "$newname" ] ; then
        # the extra step with the temp filename is for case-insensitive filesystems
        if [ ! -e "$newname" ] && [ ! -e "$newname.lcrnm.tmp" ] ; then
           mv -T "$file" "$newname.lcrnm.tmp" && mv -T "$newname.lcrnm.tmp" "$newname" 
        else
           echo "ERROR: Name already exists: $newname"
        fi
    fi    
  done
' sh {} + 
```

* * *

**参考**

我的脚本基于这些出色的答案：

[https://unix.stackexchange.com/questions/9496/looping-through-files-with-spaces-in-the-names](https://unix.stackexchange.com/questions/9496/looping-through-files-with-spaces-in-the-names)

[如何在 Bash 中将字符串转换为小写？](https://stackoverflow.com/questions/2264428/how-to-convert-a-string-to-lower-case-in-bash)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2018-12-25T01:19:10.453

这在 macOS 上也很有效：

```
ruby -e "Dir['*'].each { |p| File.rename(p, p.downcase) }" 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-01-15T17:43:03.470

我需要在 Windows 7 上的 Cygwin 设置上执行此操作，并发现我在上面尝试过的建议中遇到了语法错误（尽管我可能错过了一个工作选项）。然而，这个直接来自[Ubuntu 论坛](http://ubuntuforums.org/showthread.php?t=1336909)的解决方案是可行的:-)

```
ls | while read upName; do loName=`echo "${upName}" | tr '[:upper:]' '[:lower:]'`; mv "$upName" "$loName"; done 
```

（注意：我之前使用下划线替换了空格：

```
for f in *\ *; do mv "$f" "${f// /_}"; done 
```

)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2015-02-28T02:32:26.350

### Slugify 重命名（正则表达式）

这不是 OP 所要求的，而是我希望在此页面上找到的内容：

用于重命名文件的“slugify”版本，因此它们类似于 URL（即仅包括字母数字、点和破折号）：

```
rename "s/[^a-zA-Z0-9\.]+/-/g" filename 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2016-01-31T18:07:20.520

在这种情况下，我会使用 Python，以避免乐观地假设没有空格或斜杠的路径。我还发现它`python2`往往安装在比`rename`.

```
#!/usr/bin/env python2
import sys, os

def rename_dir(directory):
  print('DEBUG: rename('+directory+')')

  # Rename current directory if needed
  os.rename(directory, directory.lower())
  directory = directory.lower()

  # Rename children
  for fn in os.listdir(directory):
    path = os.path.join(directory, fn)
    os.rename(path, path.lower())
    path = path.lower()

    # Rename children within, if this child is a directory
    if os.path.isdir(path):
        rename_dir(path)

# Run program, using the first argument passed to this Python script as the name of the folder
rename_dir(sys.argv[1]) 
```

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2017-06-22T21:35:24.627

如果你使用[Arch Linux](https://www.archlinux.org/)，你可以安装[`rename`](https://fossies.org/linux/privat/old/rename-1.3.tar.gz/)) 包，[`AUR`](https://aur.archlinux.org/packages/rename)它提供了可执行的`renamexm`命令和[一个手册页](https://fossies.org/linux/rename/rename.1)。`/usr/bin/renamexm`

它是一个非常强大的工具，可以快速重命名文件和目录。

### 转换为小写

```
rename -l Developers.mp3 # or --lowcase 
```

### 转换为大写

```
rename -u developers.mp3 # or --upcase, long option 
```

### 其他选项

```
-R --recursive # directory and its children

-t --test # Dry run, output but don't rename

-o --owner # Change file owner as well to user specified

-v --verbose # Output what file is renamed and its new name

-s/str/str2 # Substitute string on pattern

--yes # Confirm all actions 
```

[如果需要，您可以从此处](http://www.youtube-mp3.org/)获取示例*Developers.mp3*文件；）

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-09-30T11:26:32.853

```
( find YOURDIR -type d | sort -r;
  find yourdir -type f ) |
grep -v /CVS | grep -v /SVN |
while read f; do mv -v $f `echo $f | tr '[A-Z]' '[a-z]'`; done 
```

首先重命名目录自下而上*排序 -r*（其中 -depth 不可用），然后是文件。然后*grep -v /CVS*而不是*find ...-prune*因为它更简单。对于大型目录，*for f in ...*可能会溢出一些 shell 缓冲区。使用*查找... | 在阅读*时避免这种情况。

是的，这将破坏仅在情况下有所不同的文件......

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-02-14T16:29:26.280

```
find . -depth -name '*[A-Z]*'|sed -n 's/\(.*\/\)\(.*\)/mv -n -v -T \1\2 \1\L\2/p'|sh 
```

我没有尝试过这里提到的更复杂的脚本，但没有一个命令行版本适用于我的 Synology NAS。`rename`不可用，并且`find`失败的许多变体，因为它似乎坚持已重命名路径的旧名称（例如，如果发现`./FOO`后跟，即使该路径不再有效`./FOO/BAR`，重命名`./FOO`为`./foo`仍将继续列出） `./FOO/BAR`. 上面的命令对我有用，没有任何问题。

以下是对该命令各部分的解释：

* * *

```
find . -depth -name '*[A-Z]*' 
```

这将使用深度优先搜索（例如，它将在 之前列出）从当前目录中查找任何文件（更改`.`为您要处理的任何目录），但仅适用于包含大写字符的文件。过滤器仅适用于基本文件名，而不适用于完整路径。所以这将列出但不是。这没关系，因为我们不想重命名. 虽然我们想重命名，但稍后会列出这个名称（这就是重要的原因）。`./foo/bar``./foo``-name``./FOO/BAR``./FOO/bar``./FOO/bar``./FOO``-depth`

该命令本身对于首先查找要重命名的文件特别有用。在完整的重命名命令之后使用它来搜索由于文件名冲突或错误而仍未被替换的文件。

* * *

```
sed -n 's/\(.*\/\)\(.*\)/mv -n -v -T \1\2 \1\L\2/p' 
```

这部分读取输出的文件，并使用正则表达式将`find`它们格式化为命令。`mv`该`-n`选项停止`sed`打印输入，并且`p`搜索和替换正则表达式中的命令输出替换的文本。

正则表达式本身由两个捕获组成：直到最后一个 / 的部分（这是文件的目录），以及文件名本身。目录保持不变，但文件名被转换为小写。因此，如果`find`输出`./FOO/BAR`，它将变为`mv -n -v -T ./FOO/BAR ./FOO/bar`。`-n`选项`mv`确保不覆盖现有的小写文件。该`-v`选项会`mv`输出它所做的每一次更改（或不进行 - 如果`./FOO/bar`已经存在，它会输出类似 的内容`./FOO/BAR -> ./FOO/BAR`，并注意没有进行任何更改）。这里`-T`非常重要 - 它将目标文件视为目录。如果该目录恰好存在，这将确保`./FOO/BAR`不会将其移入。`./FOO/bar`

与它一起使用`find`来生成将要执行的命令列表（便于验证将要执行的操作而无需实际执行）

* * *

```
sh 
```

这很不言自明。`mv`它将所有生成的命令路由到 shell 解释器。`bash`您可以用您喜欢的任何外壳替换它。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-09-16T10:00:05.077

这里没有一个解决方案对我有用，因为我在一个无法访问 perl 重命名脚本的系统上，而且一些文件包含空格。但是，我发现了一个有效的变体：

```
find . -depth -exec sh -c '
    t=${0%/*}/$(printf %s "${0##*/}" | tr "[:upper:]" "[:lower:]");
    [ "$t" = "$0" ] || mv -i "$0" "$t"
' {} \; 
```

归功于“Gilles 'SO-stop be evil'”，请参阅[Unix 和 Linux StackExchange 上类似问题“将整个目录树更改为小写名称”的答案](https://unix.stackexchange.com/a/20232/266760)。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2022-02-10T10:06:20.070

我相信单行可以简化：

`for f in **/*; do mv "$f" "${f:l}"; done`

# unicode - Are there guidelines for updating C++Builder applications for C++Builder 2009?

> ID：152528
> 
> 赞同：6
> 
> 时间：2008-09-30T10:34:21.530
> 
> 标签：unicode, c++builder, vcl

I have a range of Win32 VCL applications developed with C++Builder from BCB5 onwards, and want to port them to ECB2009 or whatever it's now called.

Some of my applications use the old TNT/TMS unicode components, so I have a good mix of AnsiStrings and WideStrings throughout the code. The new version introduces UnicodeString, and a bunch of #defines that change the way functions like c_str behave.

I want to modify my code in a way that is as backwards-compatible as possible, so that the same code base can still be compiled and run (in a non-unicode fashion) on BCB2007 if necessary.

Particular areas of concern are:

*   Passing strings to/from Win32 API functions
*   Interop with TXMLDocument
*   'Raw' strings used for RS232 comms, etc.

Rather than knife-and-fork the changes, I'm looking for guidelines that I can apply to ease the migration, while keeping backwards compatibility wherever possible.

If no such guidelines already exist, maybe we can formulate some here?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T13:25:26.873

最大的问题是对 C++Builder 2009 和以前版本的兼容性，Unicode 差异是一些，但项目配置文件也发生了变化。根据我在[CodeGear 论坛](https://forums.codegear.com/category.jspa?categoryID=8)上的讨论，在这件事上没有太多选择。

如果您还没有这样做，我认为首先要开始的地方是[C++Builder 2009 发行说明](http://dn.codegear.com/article/38475)。

看到的最大的事情是 TCHAR 映射（到 wchar 或 char）；使用 STL 字符串变体可能会有所帮助，因为它们在两个版本之间应该没有太大差异。该映射也存在于 C++Builder 2007 中（带有 tchar 标头）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-04T01:08:51.157

对于不需要显式 Ansi 或显式 Unicode 的任何代码，您应该考虑尽可能使用 System::String、System::Char 和 System::PChar 类型定义。这将有助于减轻大量迁移，并且它们可以在以前的版本中使用。

将 System::String 传递给 API 函数时，您必须考虑项目选项中新的“TCHAR 映射到”设置。如果您尝试在“TCHAR 映射到”设置为“wchar_t”时传递 AnsiString::c_str()，或者当“TCHAR 映射到”设置为“char”时传递 UnicodeString::c_str()，则必须执行适当的操作类型转换。如果您将“TCHAR 映射到”设置为“wchar_t”。从技术上讲，UnicodeString::t_str() 与 API 中的 TCHAR 所做的事情相同，但是如果您滥用 t_str() 可能会非常危险（当“TCHAR 映射到”设置为“char”时，t_str() 会转换UnicodeString 的内部数据到 Ansi)。

对于“原始”字符串，您可以使用新的 RawByteString 类型（尽管我不推荐它），或者使用 TBytes 代替（这是一个字节数组 - 推荐）。您不应该将 Ansi/Wide/UnicodeString 用于非字符数据。在过去的版本中，大多数人使用 AnsiString 作为临时数据缓冲区。不要再这样做了。这一点尤其重要，因为 AnsiString 现在可以识别代码页，因此您的数据可能会在您最不期望的时候转换为其他代码页。

# sql - 根据字符范围选择字符串字段的最佳方法是什么？

> ID：152537
> 
> 赞同：6
> 
> 时间：2008-09-30T10:39:12.827
> 
> 标签：sql, sql-server, oracle, localization, collation

我需要为我的软件用户添加按字符范围选择记录的功能。
例如，如何编写一个查询来返回名称在 Ba-Bi 范围内的表中的所有小部件？

目前我正在使用大于和小于运算符，因此上面的示例将变为：

```
select * from widget
where name >= 'ba' and name < 'bj' 
```

请注意我是如何将上限的最后一个字符从 i 增加到 j 的，这样就不会遗漏“bike”。

是否有一种通用方法可以根据字段的排序规则在给定字符之后查找下一个字符，或者创建第二个条件是否更安全？

```
select * from widget
where name >= 'ba'
and (name < 'bi' or name like 'bi%') 
```

我的应用程序需要支持本地化。这种查询对不同的字符集有多敏感？

我还需要同时支持 MSSQL 和 Oracle。无论数据中出现什么语言，我有哪些选择可以确保忽略字符大小写？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T13:50:20.497

让我们直接跳到本地化。你会说 "aa" >= "ba" 吗？可能不会，但这就是瑞典的情况。此外，您根本不能假设您可以忽略任何语言的大小写。大小写明显取决于语言，最常见的例子是土耳其语：大写 i 是 İ。小写 I 是 ı。

现在，您的 SQL DB 通过“整理顺序”定义 <、== 等的结果。这绝对是特定于语言的。因此，您应该为每个查询显式控制它。土耳其语整理顺序会将这些 i 放在它们所属的位置（土耳其语）。您不能依赖默认排序规则。

至于“增量部分”，不用费心了。坚持 >= 和 <=。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T11:12:58.627

对于 MSSQL，请参阅此线程：[http](http://bytes.com/forum/thread483570.html) ://bytes.com/forum/thread483570.html 。

对于 Oracle，这取决于您的 Oracle 版本，因为 Oracle 10 现在支持类似 regex(p) 的查询：[http](http://www.psoug.org/reference/regexp.html) : //www.psoug.org/reference/regexp.html（搜索 regexp_like）并查看这篇文章：[http:// /www.oracle.com/technology/oramag/webcolumns/2003/techarticles/rischert_regexp_pt1.html](http://www.oracle.com/technology/oramag/webcolumns/2003/techarticles/rischert_regexp_pt1.html)

高温高压

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T11:59:42.527

令人沮丧的是，Oracle 子字符串函数是 SUBSTR()，而 SQL-Server 是 SUBSTRING()。

您可以围绕其中一个或两个编写一个简单的包装器，以便它们共享相同的函数名+原型。

然后你可以使用

```
MY_SUBSTRING(name, 2) >= 'ba' AND MY_SUBSTRING(name, 2) <= 'bi' 
```

或类似的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T12:21:45.390

你可以用这个...

```
select * from widget
where name Like 'b[a-i]%' 
```

这将匹配名称以 b 开头的任何行，第二个字符在 a 到 i 的范围内，然后是任何其他字符。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T12:44:39.483

我认为我会采用一些简单的方法，例如将高排序字符串附加到上限的末尾。就像是：

```
select * from widgetwhere name >= 'ba' and name <= 'bi'||'~' 
```

我不确定这是否会在 EBCDIC 转换中幸存下来

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T14:12:29.477

你也可以这样做：

```
select * from widget
where left(name, 2) between 'ba' and 'bi' 
```

如果您的标准长度发生变化（正如您在留下的评论中所指出的那样），则查询也需要将长度作为输入：

```
declare @CriteriaLength int
set @CriteriaLength = 4
select * from widget
where left(name, @CriteriaLength) between 'baaa' and 'bike' 
```

# sql - 存储过程位参数激活附加 where 子句以检查 null

> ID：152541
> 
> 赞同：4
> 
> 时间：2008-09-30T10:40:47.583
> 
> 标签：sql, stored-procedures

我有一个看起来像这样的存储过程：

```
CREATE PROCEDURE dbo.usp_TestFilter
  @AdditionalFilter BIT = 1
AS
  SELECT *
  FROM dbo.SomeTable T
  WHERE
    T.Column1 IS NOT NULL
    AND CASE WHEN @AdditionalFilter = 1 THEN
      T.Column2 IS NOT NULL 
```

不用说，这是行不通的。如何激活检查 @AdditionalFilter 参数的附加 where 子句？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-30T10:44:57.073

```
CREATE PROCEDURE dbo.usp_TestFilter
  @AdditionalFilter BIT = 1
AS
  SELECT *
  FROM dbo.SomeTable T
  WHERE
    T.Column1 IS NOT NULL
    AND (@AdditionalFilter = 0 OR
      T.Column2 IS NOT NULL) 
```

如果@AdditionalFilter 为0，则不会评估该列，因为它不会影响括号内部分的结果。如果它不是 0，则将评估列条件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T12:06:04.227

这种做法往往会混淆查询优化器。我已经看到 SQL Server 2000 以完全相反的方式构建执行计划，并在设置标志时在 Column1 上使用索引，反之亦然。SQL Server 2005 似乎至少在第一次编译时就获得了正确的执行计划，但是你遇到了一个新问题。系统缓存已编译的执行计划并尝试重用它们。如果您首先以一种方式使用查询，即使额外的参数发生更改，它仍然会以这种方式执行查询，并且不同的索引会更合适。

`WITH RECOMPILE`您可以通过在`EXEC`语句中使用或每次通过`WITH RECOMPILE`在语句中指定来强制重新编译存储过程`CREATE PROCEDURE`。SQL Server 每次都会重新解析和优化查询，因此会受到惩罚。

一般来说，如果您的查询形式要改变，请使用**带参数**的动态 SQL 生成。SQL Server 还将缓存参数化查询和自动参数化查询（它试图推断哪些参数是参数）甚至常规查询的执行计划，但它最重视存储过程执行计划，然后是参数化、自动参数化和按该顺序进行常规查询。权重越高，如果服务器需要内存来做其他事情，它在计划被丢弃之前在 RAM 中的停留时间就越长。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T10:44:32.627

```
CREATE PROCEDURE dbo.usp_TestFilter
  @AdditionalFilter BIT = 1
AS
  SELECT *
  FROM dbo.SomeTable T
  WHERE
    T.Column1 IS NOT NULL
    AND (NOT @AdditionalFilter OR T.Column2 IS NOT NULL) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T10:44:54.217

```
select *
from SomeTable t
where t.Column1 is null
and (@AdditionalFilter = 0 or t.Column2 is not null) 
```

# c++ - *.h 或 *.hpp 用于您的类定义

> ID：152555
> 
> 赞同：670
> 
> 时间：2008-09-30T10:47:16.163
> 
> 标签：c++, header

我一直使用一个`*.h`文件来定义我的类，但是在阅读了一些 boost 库代码之后，我意识到它们都使用`*.hpp`. 我一直讨厌那个文件扩展名，我想主要是因为我不习惯它。

`*.hpp`使用over有什么优点和缺点`*.h`？

* * *

## 回答 #1

> 赞同：648
> 
> 时间：2008-09-30T11:41:07.437

以下是对 C 和 C++ 头文件进行不同命名的几个原因：

*   自动代码格式化，对于格式化 C 和 C++ 代码，您可能有不同的准则。如果标题由扩展名分隔，您可以将编辑器设置为自动应用适当的格式
*   命名，我一直在项目中使用 C 编写库，然后用 C++ 实现包装器。由于标头通常具有相似的名称，即 Feature.h 与 Feature.hpp，因此它们很容易区分。
*   包含，也许您的项目有更合适的可用 C++ 编写的版本，但您使用的是 C 版本（见上文）。如果标头以实现它们的语言命名，您可以轻松发现所有 C 标头并检查 C++ 版本。

请记住，C**不是**C++，除非您知道自己在做什么，否则混合搭配可能非常危险。适当地命名您的来源可以帮助您区分语言。

* * *

## 回答 #2

> 赞同：292
> 
> 时间：2008-09-30T18:57:25.110

我使用 .hpp 是因为我希望用户区分哪些标头是 C++ 标头，哪些标头是 C 标头。

当您的项目同时使用 C 和 C++ 模块时，这可能很重要：就像我之前解释的其他人一样，您应该非常小心地执行此操作，并且它从您通过扩展提供的“合同”开始

# .hpp：C++ 头文件

*（或.hxx，或.hh，或其他）*

此标头仅适用于 C++。

如果您在 C 模块中，甚至不要尝试包含它。你不会喜欢它，因为没有做任何努力使它对 C 友好（会丢失太多，比如函数重载、命名空间等）。

# .h : C/C++ 兼容或纯 C 头文件

C 源代码和 C++ 源代码都可以直接或间接地包含此标头。

它可以直接包含，受`__cplusplus`宏保护：

*   这意味着，从 C++ 的角度来看，与 C 兼容的代码将被定义为`extern "C"`.
*   从 C 的角度来看，所有 C 代码都将清晰可见，但 C++ 代码将被隐藏（因为它不会在 C 编译器中编译）。

例如：

```
#ifndef MY_HEADER_H
#define MY_HEADER_H

   #ifdef __cplusplus
      extern "C"
      {
   #endif

   void myCFunction() ;

   #ifdef __cplusplus
      } // extern "C"
   #endif

#endif // MY_HEADER_H 
```

或者它可以被包含在`extern "C"`声明中的相应 .hpp 标头间接包含在内。

例如：

```
#ifndef MY_HEADER_HPP
#define MY_HEADER_HPP

extern "C"
{
#include "my_header.h"
}

#endif // MY_HEADER_HPP 
```

和：

```
#ifndef MY_HEADER_H
#define MY_HEADER_H

void myCFunction() ;

#endif // MY_HEADER_H 
```

* * *

## 回答 #3

> 赞同：59
> 
> 时间：2008-09-30T14:28:14.073

我一直认为`.hpp`标头是文件的一种组合`.h`...`.cpp`一个包含实现细节的标头。

通常，当我看到（并使用）`.hpp`作为扩展名时，没有相应的`.cpp`文件。正如其他人所说，这不是一个硬性规定，只是我倾向于使用`.hpp`文件的方式。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2008-09-30T10:48:26.580

您使用哪个扩展并不重要。任何一个都可以。

我`*.h`用于 C 和`*.hpp`C++。

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2013-12-03T12:08:15.700

**编辑**[添加来自 Dan Nissenbaum 的建议]：

按照一种约定，当原型在标头本身中定义时使用 .hpp 文件。头文件中的此类定义在模板的情况下很有用，因为编译器仅在模板实例化时为每种类型生成代码。因此，如果它们没有在头文件中定义，它们的定义将不会在链接时从其他编译单元解析。如果您的项目是一个大量使用模板的纯 C++ 项目，则此约定将很有用。

某些遵循此约定的模板库提供带有 .hpp 扩展名的标头，以表明它们没有相应的 .cpp 文件。

另一个约定是使用 .h 表示 C 头文件，使用 .hpp 表示 C++；一个很好的例子是 boost 库。

> 引用自 Boost FAQ，
> 
> 文件扩展名将文件的“类型”传达给人类和计算机程序。'.h' 扩展名用于 C 头文件，因此传达了有关 C++ 头文件的错误信息。不使用扩展名不会传达任何信息并强制检查文件内容以确定类型。使用 '.hpp' 明确地将其标识为 C++ 头文件，并且在实际实践中运行良好。（雷纳·戴克）

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2016-03-08T13:14:45.330

我正在回答这个作为提醒，以指出我对“user1949346”对同一OP的回答的评论。

* * *

正如许多人已经回答的那样：任何一种方式都可以。其次是强调自己的印象。

介绍性的，正如前面提到的评论所述，我的意见是，如果实际上没有理由反对，`C++`建议使用标题扩展。`.h`

由于 ISO/IEC 文档使用这种头文件表示法，因此`.hpp`在他们的语言文档中甚至没有字符串匹配出现关于`C++`.

但我现在的目标是有一个可以接受的理由，为什么任何一种方式都可以，尤其是为什么它不是它自己的语言的主题。

所以我们开始吧。

`C++`文档（我实际上是从 N3690 版本中引用的）定义标头必须符合以下语法：

> 2.9 标题名称
> 
> ```
> header-name:
>     < h-char-sequence >
>     " q-char-sequence "
> h-char-sequence:
>     h-char
>     h-char-sequence h-char
> h-char:
>     any member of the source character set except new-line and >
> q-char-sequence:
>     q-char
>     q-char-sequence q-char
> q-char:
>     any member of the source character set except new-line and " 
> ```

因此，正如我们可以从这部分中提取的那样，头文件名也可以是源代码中有效的任何内容。除了包含`'\n'`字符并且取决于它是否被包含在内，`<>`它不允许包含`>`. 或者，如果它被`""`-include 包含，则不允许包含`"`.

换句话说：如果您有一个支持文件名的环境，如`prettyStupidIdea.>`，则包含如下：

```
#include "prettyStupidIdea.>" 
```

将是有效的，但是：

```
#include <prettyStupidIdea.>> 
```

将是无效的。反之亦然。

乃至

```
#include <<.<> 
```

将是一个有效的可包含头文件名。

即使这符合`C++`，这将是一个非常愚蠢的想法。

这`.hpp`也是有效的原因。

但这不是委员会为语言设计决策的结果！

因此，讨论即将使用的方法与使用`.hpp`的方法相同`.cc`，`.mm`或者我在有关该主题的其他帖子中读到的其他内容。

我不得不承认我不知道¹`.hpp`是从哪里来的，但我敢打赌，某个解析工具、IDE 或其他与此相关的东西的发明者会想到这个想法来优化一些内部流程或只是为了发明一些（甚至可能对他们来说是必要的） ) 新的命名约定。^(`C++`)

但它不是语言的一部分。

每当人们决定以这种方式使用它时。可能是因为他最喜欢它，或者因为工作流的某些应用程序需要它，它从来都不^是语言的要求。因此，无论谁说“pp 是因为它与 C++ 一起使用”，在语言定义方面都是错误的。

C++ 允许任何尊重上一段的内容。如果委员会建议使用任何东西，那么它正在使用，`.h`因为这是在 ISO 文档的所有示例中被起诉的扩展名。

**结论：**

只要您看不到/觉得不需要`.h`过度使用`.hpp`或反之亦然，您就不应该打扰。因为两者都将形成相对于标准具有相同质量的有效标题名称。因此，任何*需要*您使用的东西，`.h`或者`.hpp`是对标准的附加限制，甚至可能与其他相互不符合的附加限制相矛盾。但由于 OP 没有提到任何额外的语言限制，这是对该问题的唯一正确和可认可的答案

“*您的类定义的 *.h 或 *.hpp* ”是：

只要不存在外部限制，两者都同样正确和适用。

* * *

¹[据我所知，显然是 boost 框架提出了该`.hpp`扩展。]

²[当然我不能说一些未来的版本会带来什么！]

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-09-30T11:28:46.390

我最近开始使用`*.hpp`c++ 标头。

原因是我使用 emacs 作为我的主要编辑器，当你加载文件时它会自动进入 c 模式，当你加载`*.h`文件时它会自动进入 c++ 模式`*.hpp`。

除了这个事实，我认为没有充分的理由选择`*.h`，`*.hpp`反之亦然。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-09-30T10:51:38.803

你可以随意调用你的includes。

只需要在`#include`.

我建议如果您使用 C 来使用`.h`，以及何时使用 C++ 来使用`.hpp`.

这最终只是一个约定。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2008-09-30T14:15:28.737

我更喜欢 C++ 的 .hpp，以便让编辑和其他程序员都清楚它是 C++ 头文件而不是 C 头文件。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-30T15:18:51.923

C++（“C Plus Plus”）作为 .cpp 是有意义的

具有 .hpp 扩展名的头文件没有相同的逻辑流程。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-09-30T10:53:02.497

Codegear C++Builder 将 .hpp 用于从 Delphi 源文件自动生成的头文件，并将 .h 文件用于“自己的”头文件。

因此，当我编写 C++ 头文件时，我总是使用 .h。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2017-08-13T08:32:01.057

Bjarne Stroustrup 和 Herb Sutter 在他们的 C++ 核心指南中对这个问题发表了声明：[https](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#S-source) ://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#S-source这也指的是最新的变化在标准扩展中（C++11、C++14 等）

> SF.1：如果您的 Y 项目尚未遵循其他约定，请对代码文件使用 .cpp 后缀，对接口文件使用 .h 后缀
> 
> 这是一个由来已久的约定。但是一致性更重要，所以如果您的项目使用其他东西，请遵循它。笔记
> 
> 此约定反映了一种常见的使用模式：标头通常与 C 共享以编译为 C++ 和 C，通常使用 .h，并且将所有标头命名为 .h 更容易，而不是仅针对那些预期的标头使用不同的扩展名与 C 共享。另一方面，实现文件很少与 C 共享，因此通常应与 .c 文件区分开来，因此通常最好将所有 C++ 实现文件命名为其他名称（例如 .cpp）。
> 
> 特定名称 .h 和 .cpp 不是必需的（仅推荐作为默认名称），其他名称已广泛使用。例如 .hh、.C 和 .cxx。等效地使用这些名称。在本文档中，我们将 .h 和 .cpp > 称为头文件和实现文件的简写，即使实际扩展名可能不同。
> 
> 您的 IDE（如果您使用一个）可能对足够的意见有强烈的看法。

我不是这个约定的忠实拥护者，因为如果您使用像 boost 这样的流行库，那么您的一致性已经被打破，您应该更好地使用 .hpp。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-30T11:15:49.167

在 90 年代初我的一项工作中，我们分别使用 .cc 和 .hh 作为源文件和头文件。我仍然更喜欢它而不是所有替代品，可能是因为它最容易打字。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2017-09-05T11:51:14.640

幸运的是，这很简单。

如果您使用 C++，您应该使用 .hpp 扩展名，并且您应该将 .h 用于 C 或混合使用 C 和 C++。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2017-08-18T23:42:42.287

正如这里的许多人已经提到的，我也更喜欢将 .hpp 用于使用模板类/函数的仅标头库。我更喜欢将 .h 用于带有 .cpp 源文件或共享或静态库的头文件。

我开发的大多数库都是基于模板的，因此只需要作为头文件，但是在编写应用程序时，我倾向于将声明与实现分开，最终得到 .h 和 .cpp 文件

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2016-01-30T01:20:33.563

工具和人类很容易区分**某些东西**。就是这样。

在常规使用中（通过 boost 等），`.hpp`特别是 C++ 头文件。另一方面，`.h`适用于非 C++-only 头文件（主要是 C）。精确检测内容的语言通常很困难，因为有很多不平凡的案例，因此这种差异通常使现成的工具易于编写。对人类来说，一旦得到约定，它也很容易记住和使用。

但是，我要指出，约定本身并不总是如预期的那样有效。

*   **它不受语言规范的强制**，无论是 C 还是 C++。存在许多不遵循惯例的项目。一旦你需要合并（混合）它们，就会很麻烦。
*   `.hpp`本身并不是唯一的选择。为什么不呢`.hh`？`.hxx`（尽管如此，您通常至少需要一个关于文件名和路径的常规规则。）

我个人在我的 C++ 项目中`.h`都使用它们。`.hpp`我不遵循上述约定，因为：

*   项目的每个部分使用的语言都有明确的记录。没有机会在同一个模块（目录）中混合 C 和 C++。每个 3rdparty 库都必须遵守此规则。
*   项目使用的符合语言规范和允许的语言方言也被记录在案。（事实上​​，我什至记录[了正在使用的标准功能和错误修复（在语言标准上）的来源](https://bitbucket.org/FrankHB/yslib/wiki/StandardUsing.en-US.md)。）这比区分使用的语言更重要，因为它太容易出错并且测试成本很高（例如编译器兼容性）可能很重要（复杂且耗时），尤其是在已经使用*几乎纯*C++ 的项目中。文件名太弱而无法处理。
*   即使对于相同的 C++ 方言，也可能有更重要的属性适合差异。例如，请参阅下面的约定。
*   文件名本质上是脆弱的元数据。违反惯例并不那么容易被发现。为了稳定地处理内容，工具最终不应仅依赖于名称。扩展之间的区别只是一个提示。也不应该期望使用它的工具始终表现相同，例如`.h`github.com 上文件的语言检测。[（在shebang](https://en.wikipedia.org/wiki/Shebang_(Unix))之类的评论中可能有一些东西让这些源文件成为更好的元数据，但它甚至不像文件名那样传统，因此通常也不可靠。）

我通常`.hpp`在 C++ 头文件上使用，并且头文件应该以*仅头文件的*方式使用（维护），例如作为模板库。对于 中的其他头文件`.h`，要么有相应的`.cpp`文件作为实现，要么是非 C++ 头文件。后者通过人类（或通过具有显式嵌入元数据的工具，如果需要）来区分标题的内容是微不足道的。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-30T14:26:16.930

我使用 .h 是因为这是 Microsoft 使用的，也是他们的代码生成器创建的。没有必要违背粮食。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2013-05-29T16:25:41.343

在“The C++ Programming Language, Third Edition by Bjarne Stroustrup”，第一本 C++ 必读书籍，他使用 *.h。所以我认为最好的做法是使用 *.h。

但是，*.hpp 也可以！

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2016-06-15T03:50:46.663

任何特定扩展都没有任何优势，除了对您、编译器和/或您的工具可能有不同的含义。 `header.h`是一个有效的标头。 `header.hpp`是一个有效的标头。 `header.hh`是一个有效的标头。 `header.hx`是一个有效的标头。 `h.header`是一个有效的标头。 `this.is.not.a.valid.header`是拒绝的有效标头。 `ihjkflajfajfklaf`是一个有效的标头。只要名称可以被编译器正确解析，并且文件系统支持它，它就是一个有效的标头，其扩展的唯一优势就是人们读入它的内容。

话虽如此，能够根据扩展名准确地做出假设是*非常*有用的，因此为您的头文件使用一组易于理解的规则是明智的。就个人而言，我更喜欢这样做：

1.  如果已经有任何既定的指导方针，请遵循它们以防止混淆。
2.  如果项目中的所有源文件都使用相同的语言，请使用`.h`. 没有歧义。
3.  如果某些标头与多种语言兼容，而其他标头仅与一种语言兼容，则扩展基于标头兼容的最严格的语言。与 C 或与 C 和 C++`.h`兼容的标头获取 ，而与 C++ 兼容但不与 C 兼容的标头获取`.hpp`或`.hh`类似的东西。

当然，这只是处理扩展的*众多*方法之一，即使事情看起来很简单，您也不一定相信您的第一印象。例如，我看到提到使用`.h`普通头文件，以及`.tpp`只包含模板类成员函数定义的头`.h`文件，定义模板类的`.tpp`文件包括定义其成员函数的文件（而不是`.h`直接包含两个函数声明和定义）。再举一个例子，很多人总是在其扩展中反映标题的语言，即使没有歧义的可能性。对他们来说，`.h`总是一个 C 头文件和`.hpp`（或`.hh`，或`.hxx`等）始终是 C++ 标头。再一次，有些人使用`.h`“与源文件关联的标头”和`.hpp`“具有内联定义的所有函数的标头”。

考虑到这一点，主要优势在于始终以相同的样式命名您的标题，并使该样式对任何检查您的代码的人都很明显。这样，任何熟悉您通常的编码风格的人都可以通过粗略的一瞥来确定您对任何给定扩展的含义。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-09-30T11:34:42.273

源文件的扩展名可能对您的构建系统有意义，例如，您的 makefile 中可能有一个规则用于`.cpp`或`.c`文件，或者您的编译器（例如 Microsoft `cl.exe`）可能会根据扩展名将文件编译为 C 或 C++。

因为您必须为`#include`指令提供整个文件名，所以头文件扩展名是无关紧要的。`.c`如果您愿意，您可以在另一个源文件中包含一个文件，因为它只是一个文本包含。您的编译器可能有一个选项来转储预处理的输出，这将使这一点变得清晰（微软：`/P`预处理到文件，`/E`预处理到`stdout`，`/EP`省略`#line`指令，`/C`保留注释）

您可能会选择`.hpp`用于仅与 C++ 环境相关的文件，即它们使用不会在 C 中编译的功能。

# tdd - 在持续集成中如何处理 TDD？

> ID：152579
> 
> 赞同：3
> 
> 时间：2008-09-30T10:59:40.267
> 
> 标签：tdd, continuous-integration, development-process

想象一下，您正在实现包含各种新功能并增加代码库复杂性的用户故事。现有代码已经很好地覆盖了，您刚刚决定了接口。您开始实现从测试开始的功能。

现在，您有基于需求的相当复杂的测试用例，但是当您能够提交 SCM 完全工作的代码并且许多测试失败（应该如此）时，实现还远远不够。

假设在持续集成中，如果可能，所有构建都应该是绿色的，因此您不应该提交，因为您会破坏构建。但是你也不应该[“变暗”](http://www.codinghorror.com/blog/archives/001134.html)并为自己保留这么多的代码......

在这种情况下建议的程序是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T11:11:26.667

不要事先决定*所有接口。*以典型的 TDD 节奏逐步开发：编写测试；使测试通过；重构。这应该使一切保持良好状态，栏将始终为绿色，您可以签入代码而不必担心会破坏构建。

它需要不同的代码编写风格，但你最终会习惯这种节奏的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T11:28:45.050

跳过那些您知道由于功能当前缺失而无法通过的测试怎么办？

很明显你也在跳过测试！正如他们在 Oz 中所说，真的让它“像被困的猪一样”尖叫！（-：

添加功能时，启用相关的测试并保持“您的栏绿色！”

这是 The Pragmatic Programmers 上的[另一篇很棒的文章](http://www.pragmaticprogrammer.com/the-pragmatic-programmer/extracts/software-entropy)，其中涵盖了让破碎的窗户对其他人来说显而易见。

高温高压

干杯，

抢

# python - 在 Python 中检查类型的规范方法是什么？

> ID：152580
> 
> 赞同：1582
> 
> 时间：2008-09-30T11:00:10.140
> 
> 标签：python, types

检查给定对象是否属于给定类型的最佳方法是什么？如何检查对象是否继承自给定类型？

假设我有一个对象`o`。我如何检查它是否是一个`str`？

* * *

## 回答 #1

> 赞同：1868
> 
> 时间：2008-09-30T11:07:45.597

要检查是否`o`是 的实例`str`或任何子类`str`，请使用[isinstance](https://docs.python.org/library/functions.html#isinstance)（这将是“规范”方式）：

```
if isinstance(o, str): 
```

检查类型`o`是否准确`str`（排除子类）：

```
if type(o) is str: 
```

以下方法也有效，并且在某些情况下可能有用：

```
if issubclass(type(o), str): 
```

有关相关信息，请参阅Python 库参考中的[内置函数](http://docs.python.org/library/functions.html)。

还有一点需要注意：在这种情况下，如果您使用的是 Python 2，您可能实际上想要使用：

```
if isinstance(o, basestring): 
```

因为这也会捕获 Unicode 字符串（[`unicode`](https://docs.python.org/2/library/functions.html#unicode)不是 的子类`str`；两者都是`str`的`unicode`子类[`basestring`](https://docs.python.org/2/library/functions.html#basestring)）。请注意，`basestring`在 Python 3 中不再存在字符串 ( ) 和二进制数据 ( )[的严格分隔](https://docs.python.org/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit)。[`str`](https://docs.python.org/3/library/functions.html#func-str)[`bytes`](https://docs.python.org/3/library/functions.html#func-bytes)

或者，`isinstance`接受一个类的元组。`True`如果`o`是以下任何一个子类的实例，这将返回`(str, unicode)`：

```
if isinstance(o, (str, unicode)): 
```

* * *

## 回答 #2

> 赞同：247
> 
> 时间：2008-09-30T17:40:18.743

检查对象类型的**最**Pythonic 方法是……不检查它。

由于 Python 鼓励[Duck Typing](http://wikipedia.org/wiki/Duck_typing)，因此您应该`try...except`按照您想要的方式使用对象的方法。因此，如果您的函数正在寻找可写文件对象，*请不要*检查它是否是 的子类`file`，只需尝试使用它的`.write()`方法！

当然，有时这些漂亮的抽象会崩溃，而`isinstance(obj, cls)`这正是您所需要的。但要谨慎使用。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2008-09-30T11:05:51.750

`isinstance(o, str)``True`如果`o`是`str`或是继承自 的类型，将返回`str`。

`type(o) is str``True`当且仅当`o`是一个 str时才会返回。`False`如果`o`是继承自的类型，它将返回`str`。

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2016-05-06T16:12:33.897

在提出并回答问题后，[类型提示被添加到 Python](https://www.python.org/dev/peps/pep-0484/)中。Python 中的类型提示允许检查类型，但方式与静态类型语言非常不同。Python 中的类型提示将预期的参数类型与函数相关联，作为与函数关联的运行时可访问数据，这*允许*检查类型。类型提示语法示例：

```
def foo(i: int):
    return i

foo(5)
foo('oops') 
```

在这种情况下，我们希望触发一个错误，`foo('oops')`因为参数的注释类型是`int`. 添加的类型提示不会*导致*脚本正常运行时出现错误。但是，它向函数添加了属性，描述了其他程序可以查询并用于检查类型错误的预期类型。

可用于查找类型错误的其他程序之一是`mypy`：

```
mypy script.py
script.py:12: error: Argument 1 to "foo" has incompatible type "str"; expected "int" 
```

（你可能需要`mypy`从你的包管理器安装。我不认为它随 CPython 一起提供，但似乎有一定程度的“官方性”。）

这种类型检查与静态类型编译语言中的类型检查不同。因为类型在 Python 中是动态的，所以类型检查必须在运行时进行，如果我们坚持每一次机会都会发生这种情况，即使是正确的程序也会产生成本。显式类型检查也可能比需要的限制更严格，并导致不必要的错误（例如，参数是否真的需要完全是`list`类型，或者任何可迭代的东西就足够了？）。

显式类型检查的好处是它可以更早地捕获错误并提供比鸭式类型更清晰的错误消息。鸭子类型的确切要求只能通过外部文档来表达（希望它是彻底和准确的），并且来自不兼容类型的错误可能发生在远离它们起源的地方。

Python 的类型提示旨在提供一种折衷方案，可以指定和检查类型，但在通常的代码执行期间没有额外的成本。

该`typing`包提供类型变量，可以在类型提示中使用来表达所需的行为，而无需特定类型。例如，它包括变量，例如`Iterable`和`Callable`提示，以指定具有这些行为的任何类型的需求。

虽然类型提示是检查类型的最 Pythonic 方式，但通常更 Pythonic 的是根本不检查类型并依赖鸭子类型。类型提示相对较新，当它们是最 Pythonic 的解决方案时，陪审团仍然没有定论。一个相对没有争议但非常笼统的比较：类型提示提供了一种可以强制执行的文档形式，允许代码生成更早且更易于理解的错误，可以捕获鸭子类型无法捕获的错误，并且可以静态检查（在不寻常的情况下）感觉，但它仍然在运行时之外）。另一方面，duck 类型长期以来一直是 Pythonic 方式，不会强加静态类型的认知开销，不那么冗长，并且会接受所有可行的类型，然后是一些。

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2021-06-20T05:01:08.070

在[Python 3.10](https://www.python.org/dev/peps/pep-0604/)`|`中，您可以使用`isinstance`：

```
>>> isinstance('1223', int | str) 
True

>>> isinstance('abcd', int | str) 
True 
```

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2013-01-25T23:54:51.213

这是一个示例，为什么鸭子打字是邪恶的，却不知道何时是危险的。

例如：这是 Python 代码（可能省略了适当的缩进），注意这种情况可以通过处理 isinstance 和 issubclassof 函数来避免，以确保当你真的需要一个鸭子时，你不会得到炸弹。

```
class Bomb:
    def talk(self):
        self.explode()

    def explode(self):
        print("BOOM!, The bomb explodes.")

class Duck:
    def talk(self):
        print("I am a duck, I will not blow up if you ask me to talk.")

class Kid:
    kids_duck = None

    def __init__(self):
        print("Kid comes around a corner and asks you for money so he could buy a duck.")

    def take_duck(self, duck):
        self.kids_duck = duck
        print("The kid accepts the duck, and happily skips along.")

    def do_your_thing(self):
        print("The kid tries to get the duck to talk.")
        self.kids_duck.talk()

my_kid = Kid()
my_kid.take_duck(Bomb())
my_kid.do_your_thing() 
```

注意：这个例子陈旧、幼稚，危险被大大夸大了。除了更新到 Python 3 之外，它作为概念证明留下，没有进行重大编辑。我不记得最初是什么迫使我写这个。

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2019-07-18T17:23:39.813

您可以使用类型的 __name__ 检查变量的类型。

前任：

```
>>> a = [1,2,3,4]  
>>> b = 1  
>>> type(a).__name__
'list'
>>> type(a).__name__ == 'list'
True
>>> type(b).__name__ == 'list'
False
>>> type(b).__name__
'int' 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2008-09-30T11:01:28.063

```
isinstance(o, str) 
```

[链接到文档](https://docs.python.org/2/library/functions.html#isinstance)

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2019-02-16T07:06:16.173

对于更复杂的类型验证，我喜欢[typeguard](https://github.com/agronholm/typeguard)基于 python 类型提示注释的验证方法：

```
from typeguard import check_type
from typing import List

try:
    check_type('mylist', [1, 2], List[int])
except TypeError as e:
    print(e) 
```

您可以以非常清晰易读的方式执行非常复杂的验证。

```
check_type('foo', [1, 3.14], List[Union[int, float]])
# vs
isinstance(foo, list) and all(isinstance(a, (int, float)) for a in foo) 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-30T13:33:06.233

我认为使用像 Python 这样的动态语言很酷的一点是你真的不应该检查类似的东西。

我只会在您的对象上调用所需的方法并捕获一个`AttributeError`. 稍后这将允许您使用其他（看似不相关的）对象调用您的方法来完成不同的任务，例如模拟一个对象进行测试。

在从 Web 上获取数据时，我经常使用`urllib2.urlopen()`它来返回*类似*对象的文件。这可以反过来传递给几乎任何从文件读取的方法，因为它实现了与`read()`真实文件相同的方法。

但我确定有使用的时间和地点`isinstance()`，否则它可能不会在那里:)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2021-05-09T21:18:47.613

接受的答案回答了问题，因为它提供了所提问题的答案。

> 问：检查给定对象是否属于给定类型的最佳方法是什么？如何检查对象是否继承自给定类型？

> A：用于`isinstance, issubclass, type`根据类型进行检查。

然而，正如其他答案和评论很快指出的那样，“类型检查”的概念比 python 中的概念要多得多。自从添加 Python 3 和[类型提示](https://www.python.org/dev/peps/pep-0484/)以来，也发生了很大变化。下面，我将讨论类型检查、鸭子类型和异常处理的一些困难。对于那些认为不需要类型检查的人（通常不需要，但我们在这里），我还指出了如何使用类型提示来代替。

### 类型检查

在 python 中，类型检查并不总是一件合适的事情。考虑以下示例：

```
def sum(nums):
    """Expect an iterable of integers and return the sum."""
    result = 0
    for n in nums:
        result += n
    return result 
```

为了检查输入是否是整数的可迭代，我们遇到了一个主要问题。检查每个元素是否为整数的唯一方法是循环检查每个元素。但是如果我们循环遍历整个迭代器，那么预期的代码将一无所有。在这种情况下，我们有两种选择。

1.  在我们循环时检查。

2.  事先检查，但在我们检查时存储所有内容。

选项 1 的缺点是使我们的代码复杂化，尤其是当我们需要在许多地方执行类似的检查时。它迫使我们将类型检查从函数的顶部移到我们在代码中使用可迭代的*任何地方。*

选项 2 的明显缺点是它破坏了迭代器的全部目的。重点是不要存储数据，因为我们不需要。

有人可能还认为检查是否检查所有元素太多，那么也许我们可以检查输入本身是否为可迭代类型，但实际上没有任何可迭代的基类。任何类型的实现`__iter__`都是可迭代的。

### 异常处理和鸭子类型

另一种方法是完全放弃类型检查，而是专注于异常处理和鸭子类型。也就是说，将您的代码包装在一个 try-except 块中并捕获发生的任何错误。或者，不要做任何事情，让异常从您的代码中自然产生。

这是捕获异常的一种方法。

```
def sum(nums):
    """Try to catch exceptions?"""
    try:
        result = 0
        for n in nums:
            result += n
        return result
    except TypeError as e:
        print(e) 
```

与之前的选项相比，这肯定更好。我们在运行代码时进行检查。如果有`TypeError`任何地方，我们会知道的。我们不必在循环输入的任何地方进行检查。而且我们不必在迭代时存储输入。

此外，这种方法可以实现鸭子类型。我们不再检查 for `specific types`，而是检查`specific behaviors`并查找输入何时未能按预期运行（在这种情况下，循环`nums`并能够添加`n`）。

然而，使异常处理变得很好的确切原因也可能是它们的失败。

1.  A`float`不是 a `int`，但它满足工作的*行为*要求。

2.  用 try-except 块包装整个代码也是不好的做法。

起初，这些似乎不是问题，但这里有一些可能会改变你想法的原因。

1.  用户不能再期望我们的函数`int`按预期返回。这可能会破坏其他地方的代码。

2.  由于异常可能来自多种来源，因此在整个代码块上使用 try-except 可能最终会捕获您不打算捕获的异常。我们只想检查是否`nums`是可迭代的并且是否有整数元素。

3.  理想情况下，我们希望在我们的代码生成器中捕获异常，并在它们的位置引发更多信息异常。当从别人的代码中引发异常而没有任何解释只是你没有写的一行并且`TypeError`发生了一些时，这并不有趣。

为了解决上述问题的异常处理，我们的代码将变成这样……可憎的。

```
def sum(nums):
    """
    Try to catch all of our exceptions only.
    Re-raise them with more specific details.
    """
    result = 0

    try:
        iter(nums)
    except TypeError as e:
        raise TypeError("nums must be iterable")

    for n in nums:
        try:
            result += int(n)
        except TypeError as e:
            raise TypeError("stopped mid iteration since a non-integer was found")

    return result 
```

你可以看到这是怎么回事。我们尝试“正确”检查的次数越多，我们的代码看起来就越糟糕。与原始代码相比，这根本不可读。

我们可以争辩说这可能有点极端。但另一方面，这只是一个非常简单的例子。实际上，您的代码可能比这复杂得多。

### 类型提示

我们已经看到当我们尝试修改我们的小示例以“启用类型检查”时会发生什么。类型提示不是专注于尝试强制特定类型，而是允许一种使用户清楚类型的方法。

```
from typing import Iterable

def sum(nums: Iterable[int]) -> int:
    result = 0
    for n in nums:
        result += n
    return result 
```

以下是使用类型提示的一些优点。

*   现在的代码实际上看起来不错！

*   如果您使用类型提示，您的编辑器可能会执行静态类型分析！

*   它们存储在函数/类中，使它们可以动态使用，例如[`typeguard`](https://github.com/agronholm/typeguard)和[`dataclasses`](https://docs.python.org/3/library/dataclasses.html).

*   它们在使用`help(...)`.

*   无需根据描述检查您的输入类型是否正确或更糟糕的是缺少描述。

*   您可以根据[结构](https://www.python.org/dev/peps/pep-0544/)“键入”提示，例如“它有这个属性吗？” 无需用户进行子类化。

类型提示的缺点？

*   类型提示本身就是语法和特殊文本。*它与类型检查不同*。

换句话说，它实际上并没有回答问题，因为它不提供类型检查。但是，无论如何，如果您在这里进行类型检查，那么您也*应该*进行类型提示。当然，如果您得出的结论是类型检查实际上不是必需的，但您想要一些类似的类型，那么类型提示适合您。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-08-01T16:07:35.297

给雨果：

您可能的意思是`list`而不是`array`，但这指向了类型检查的整个问题-您不想知道所讨论的对象是否是列表，您想知道它是某种序列还是单个对象。所以试着像序列一样使用它。

假设您要将对象添加到现有序列中，或者如果它是对象序列，则将它们全部添加

```
try:
   my_sequence.extend(o)
except TypeError:
  my_sequence.append(o) 
```

一个技巧是，如果您正在使用字符串和/或字符串序列 - 这很棘手，因为字符串通常被认为是单个对象，但它也是一个字符序列。比这更糟糕的是，它实际上是一系列单长字符串。

我通常选择将我的 API 设计为只接受一个值或一个序列——它使事情变得更容易。`[ ]`如果需要，当您传入单个值时，将它放在您的单个值周围并不难。

（虽然这可能会导致字符串错误，因为它们看起来确实像（是）序列。）

* * *

## 回答 #13

> 赞同：-4
> 
> 时间：2020-05-31T20:42:07.260

检查类型的一种简单方法是将其与您知道的类型进行比较。

```
>>> a  = 1
>>> type(a) == type(1)
True
>>> b = 'abc'
>>> type(b) == type('')
True 
```

* * *

## 回答 #14

> 赞同：-10
> 
> 时间：2019-12-24T09:21:42.397

我认为最好的方法是输入好你的变量。您可以通过使用“打字”库来做到这一点。

例子：

```
from typing import NewType
UserId = NewType ('UserId', int)
some_id = UserId (524313`) 
```

请参阅[https://docs.python.org/3/library/typing.html](https://docs.python.org/3/library/typing.html)。

# definition - 这是一个合理的“应用程序入口点”吗？

> ID：152582
> 
> 赞同：1
> 
> 时间：2008-09-30T11:01:22.930
> 
> 标签：definition

我最近遇到了一种情况，代码动态加载一些库，将它们连接起来，然后调用所谓的“应用程序入口点”（其中一个库必须实现 IApplication.Run()）。

这是一个有效的“应用程序入口点”吗？

我总是认为应用程序入口点在加载库之前，并发现在大量工作之后调用 IApplication.Run() 有点误导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T11:17:15.280

术语应用程序和系统是使用如此广泛和多样化的术语，您需要与您的对话伙伴预先同意它们的含义。例如，有时应用程序是带有 UI 的东西，而系统是“无 UI”的。一般来说，你说土豆，我说土豆。

至于您使用的示例：这正是运行时（例如 .NET 或 java）所做的：加载一组库并调用应用程序入口点，即“main”方法。

因此，在您的情况下，加载库的代码执行相同的操作，并且可能在接口上调用方法，然后您可以将加载代码视为该应用程序的运行时。这只是一个观点问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T11:12:04.217

术语“应用程序”可以表示您想要的任何含义。“应用程序”仅指协同工作以帮助您解决问题的资源（库、代码、图像等）的集合。

因此，要回答您的问题，是的，这是对“应用程序”一词的有效使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T11:14:59.060

应用程序本身实际上没有任何意义。人们经常用它来谈论为用户提供一些*价值*的计算机程序。更正确的术语是应用软件，其定义如下：

> 应用软件是计算机软件的一个子类，它直接和彻底地将计算机的功能用于用户希望执行的任务。这应该与系统软件形成对比，系统软件涉及集成计算机的各种功能，但通常不会直接将它们应用于执行有利于用户的任务。在此上下文中，术语应用程序指的是应用程序软件及其实现。

由于应用程序实际上意味着应用程序软件，而软件是在计算机上执行任何类型任务的任何代码，我想说库也可以是应用程序。

无论如何，大多数术语都是人造的。插件不是应用程序吗？你浏览器的flash插件没有应用吗？人们说不，它只是一个插件。为什么？因为它不能自己运行，所以需要加载到一个真实的进程中。但是没有定义说只有“可以自己运行”的东西才是应用程序。图书馆也是如此。核心应用程序可能只是一个空容器，所有逻辑和功能，甚至与用户的交互，都可以由插件或库执行，在这种情况下，它更像是一个应用程序，而不是只为应用程序提供一些上下文的空容器。要运行的应用程序。将此与 Java 进行比较。一个 Java**应用程序**不能单独运行，它必须在 Java 虚拟机 (JVM) 中运行，这是否意味着 JVM 是应用程序，而 Java 代码只是……嗯什么？Java 代码不是**真正的**应用程序，而 JVM 不是一个空的运行时环境，如果没有加载的 Java 代码，它不会向最终用户提供任何东西吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T11:18:47.117

我认为您所指的可能是 C/C++ 代码中的 main() 函数或 Windows 应用程序中的 WinMain。也就是说，它是通常在应用程序中开始执行的点。你的问题非常广泛和模糊——例如，你在哪个操作系统上运行它——但这[可能](http://msdn.microsoft.com/en-us/library/bb189522.aspx)就是你要找的。 [这](http://www.toymaker.info/Games/html/winmain.html)也可能解决这个问题。

请记住，当您提出问题时，细节是您的朋友。当您向他们提供详细信息时，人们可以为您提供更好、更明智的答案。

编辑：在更广泛的背景下，从操作系统的角度考虑必须发生的事情。当用户指定他们想要运行一个应用程序时，操作系统必须从硬盘驱动器加载应用程序，然后当应用程序加载到内存中时，它必须将控制权传递给新加载占用的内存中的某个点应用程序继续执行。那将是“应用程序入口点”。当使用动态链接代码构建应用程序时，操作系统必须加载所有动态链接代码，以便将正确的应用程序映像放入内存。加载这些共享的代码并不会改变这样一个事实，即当应用程序加载到内存中时，操作系统必须有一个点可以传递控制权。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T11:34:43.707

我认为在这种情况下，“应用程序入口点”是指“应用程序（您的代码）进入库的点”。

# ruby-on-rails - 识别 Ruby on Rails 中的 GET 和 POST 参数

> ID：152585
> 
> 赞同：32
> 
> 时间：2008-09-30T11:02:32.227
> 
> 标签：ruby-on-rails

在 Ruby on Rails 中，从控制器中识别和分离 GET 和 POST 参数的最简单方法是什么，这相当于 PHP 中的 $_GET 和 $_POST 变量？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-09-30T11:10:00.913

您可以使用`request.get?`和`request.post?`方法来区分 HTTP Gets 和 Posts。

*   见[http://api.rubyonrails.org/classes/ActionDispatch/Request.html](http://api.rubyonrails.org/classes/ActionDispatch/Request.html)

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-09-30T11:34:33.007

我不知道 Rails 中有什么方便的方法，但是您可以直接访问查询字符串来解析在那里设置的参数。类似于以下内容：

```
request.query_string.split(/&/).inject({}) do |hash, setting|
  key, val = setting.split(/=/)
  hash[key.to_sym] = val
  hash
end 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2011-12-03T01:50:22.397

您可以使用：

`request.POST`

和

`request.GET`

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2012-03-06T15:16:55.637

为此，请求对象上有三个非常简单的哈希访问器：

*   `request.query_parameters`- 作为查询字符串的一部分发送，即在 ?
*   `request.path_parameters`- 通过路由从 URL 解码，即控制器、动作、id
*   `request.request_parameters`- 所有参数，包括以上以及作为 POST 正文的一部分发送的任何参数

您可以`Hash#reject`根据需要使用 POST-only 参数。

来源： http: [//guides.rubyonrails.org/v2.3.8/action_controller_overview.html](http://guides.rubyonrails.org/v2.3.8/action_controller_overview.html)第 9.1.1 节

我查看了一个旧的 Rails 1.2.6 应用程序，这些访问器当时也存在。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2011-03-31T20:08:59.073

GET 和 POST 参数之间存在差异。POST HTTP 请求仍然可以有 GET 参数。

GET 参数是 URL 查询参数。

POST 参数是 HTTP 请求正文中的参数。

您可以从 request.GET 和 request.POST 哈希中单独访问这些。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-09-12T11:06:27.970

`request.get?`如果是 GET 方法，将返回布尔值 true，

`request.post?`如果是 POST 方法，将返回布尔值 true，

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-30T12:42:53.013

如果您想检查请求的类型以防止在使用错误方法时执行任何操作，请注意您也可以在您的 routes.rb 文件中指定它：

```
map.connect '/posts/:post_id', :controller => 'posts', :action => 'update', :conditions => {:method => :post} 
```

或者

```
map.resources :posts, :conditions => {:method => :post} 
```

您的 PostsController 的更新方法现在只会在您有效地发布帖子时被调用。查看文档以获取[资源](http://www.railsbrain.com/api/rails-2.1.0/doc/index.html?a=M000354&name=resources)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-30T11:13:07.067

如果你明白我的意思，我认为你想做的不是很“Rails”。您的 GET 请求应该是**幂等**的 - 您应该能够多次发出相同的 GET 请求并且每次都获得相同的结果。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-30T12:59:33.863

您不需要知道控制器中的详细程度。您的路线和表单将导致将适当的项目添加到参数哈希中。然后在控制器中，您只需访问 say`params[:foo]`以获取 foo 参数并使用它做任何您需要的事情。

GET 和 POST（以及 PUT 和 DELETE）与控制器操作之间的映射是`config/routes.rb`在大多数现代 Rails 代码中设置的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-11-14T23:21:55.497

我认为 Jesse Reiss 所说的是一种情况，在你的`routes.rb`文件中你有

```
post 'ctrllr/:a/:b' => 'ctrllr#an_action' 
```

并且您 POST 到**"/ctrllr/foo/bar?a=not_foo"** POST values **{'a' => 'still_not_foo'}**，您将拥有三个不同的 'a' 值：'foo'、'not_foo' 和 ' still_not_foo'

控制器中的“params”将“a”设置为“foo”。要找到设置为 'not_foo' 和 'still_not_foo' 的 'a'，您需要检查`request.GET`和`request.POST`

[我在https://github.com/pdxrod/routesfordummies](https://github.com/pdxrod/routesfordummies)写了一个 gem 来区分这些不同的 key=>value 对。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-04-20T18:52:46.190

```
if request.query_parameters().to_a.empty? 
```

# asp.net - 如何在 NUnit 中初始化 ConnectionStrings 集合

> ID：152586
> 
> 赞同：5
> 
> 时间：2008-09-30T11:02:59.027
> 
> 标签：asp.net, nunit, web-config, automated-tests

我想使用 NUnit 测试 ASP.NET 应用程序，但是从 NUnit GUI 运行时 WebConfigurationManager.ConnectionStrings 集合似乎是空的。

你能告诉我如何初始化这个集合（可能在 [TestFixture] 的 [SetUp] 函数中）吗？我应该在那里复制 Web.config 吗？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-05T18:20:59.533

## NUnit .config 文件位置取决于您如何创建 NUnit 项目文件

NUnit 测试的 .config 文件所在的位置比此处建议的其他帖子要复杂一些。在 NUnit GUI Project/Edit 对话框中有这方面的设置。默认值都取决于您创建 NUnit 项目文件的方式。

当您打开 NUnit GUI 并选择 File/Open，然后选择一个 .dll 文件时，一个新项目会设置为在同一目录中查找与 dll 同名的配置文件。因此，如果您加载`\bin\debug\MyTests.dll`了 NUnit ，则`\bin\Debug\MyTests.dll.config`默认情况下会查找。唯一的问题是，当您创建发布版本时，您需要创建一个单独的 NUnit 项目。

如果您通过选择 File/NewProject 创建了 NUnit 项目，则默认设置是查找与 NUnit 项目同名的配置文件。因此，如果您创建了`\MyNUnitProject.nunit`NUnit ，则`\MyNUnitProject.config`默认查找。

您可能已经使用 Visual Studio 创建了一个`\App.config`文件并将其粘贴在您的测试 dll 的源文件夹中。当您构建您的测试项目时，它会被复制到`\bin\Debug\MyTests.dll.config`或`\bin\Release\MyTests.dll.config`取决于您选择的配置。如果您直接在 NUnit 中打开了 MyTest.dll，这将正常工作，但是如果您创建了一个新的 NUnit 项目，您就会遇到麻烦，因为默认情况下它不会查找这些文件。

要解决这个问题，您需要在 NUnit GUI 中打开 Project/Edit 对话框，并检查您是否有两个 Configurations Debug & Release 来匹配您的 .Net 项目。完成此操作后，您可以选择调试配置并将 ApplicationBase`bin\Debug\`设置为并将配置文件名称设置为`MyTests.dll.config`. 对发布配置执行相同的操作，然后离开。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-30T11:22:05.737

如果您有名为 Company.Component.Tests.dll 的单元测试程序集，则只需确保 Company.Component.Tests.dll.config 具有正确的连接字符串即可。

此外，将连接提供程序类与配置分离可能是一个好主意，这样您就可以在持久性方面具有灵活性（即：从 *.config 切换到其他内容）并更容易测试。

另请查看“ [NUnit 如何查找配置文件](http://nunit.com/blogs/?p=9)”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T11:07:16.147

您可以将 app.config 用于库（我假设您的测试在其中）并将它们放在那里。

# f# - F# 风格 - 首选 () 或 <|

> ID：152602
> 
> 赞同：3
> 
> 时间：2008-09-30T11:11:16.197
> 
> 标签：f#, coding-style

您发现自己最常使用这两种替代方法中的哪一种，哪种更“惯用”？

1.  f arg (obj.DoStuff())
2.  f arg <| obj.DoStuff()

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T13:01:02.097

总的来说，我不知道其中一个更惯用。

就个人而言，我唯一一次使用 <| 与“提高”：

```
raise <| new FooException("blah") 
```

除此之外，我总是使用括号。请注意，由于大多数 F# 代码使用柯里化函数，这通常并不意味着任何“额外”的括号：

```
f arg (g x y) 
```

当您进入非柯里化函数和构造函数以及诸如此类的东西时，它开始变得不那么漂亮了：

```
f arg (g(x,y)) 
```

我们可能至少会*考虑*更改 F# 语言规则，以使高优先级应用程序绑定得更紧密；现在

```
f g() 
```

解析像

```
f g () 
```

但很多人希望它解析为

```
f (g()) 
```

（原始问题中的动机案例）。如果您对此有强烈意见，请对此回复发表评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-18T22:57:33.583

因为类型推断是从左到右进行的，所以 using 的一个好处`|>`是它允许 F# 推断函数参数的类型。

作为一个人为的例子，

```
[1; 2; 3] |> (fun x -> x.Length*2) 
```

工作得很好，但是

```
(fun x -> x.Length*2) [1; 2; 3] 
```

抱怨“查找不确定类型的对象”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T11:26:49.827

我更频繁地使用 ()，但这只是偏好，我很确定 <| 更惯用，但我习惯使用 () 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T12:39:23.367

只要有可能，我更喜欢 |> 因为它从左到右读取。

# c# - C#：获取列表中所有项目的任意属性的最大值和最小值

> ID：152613
> 
> 赞同：18
> 
> 时间：2008-09-30T11:15:26.063
> 
> 标签：c#, .net, reflection, .net-2.0

我有一个专门的列表，其中包含以下类型的项目`IThing`：

```
public class ThingList : IList<IThing>
{...}

public interface IThing
{
    Decimal Weight { get; set; }
    Decimal Velocity { get; set; }
    Decimal Distance { get; set; }
    Decimal Age { get; set; }
    Decimal AnotherValue { get; set; }

    [...even more properties and methods...]
} 
```

有时我需要知道列表中所有事物的某个属性的最大值或最小值。因为“告诉不问”，我们让列表弄清楚：

```
public class ThingList : IList<IThing>
{
    public Decimal GetMaximumWeight()
    {
        Decimal result = 0;
        foreach (IThing thing in this) {
            result = Math.Max(result, thing.Weight);
        }
        return result;
    }
} 
```

这是非常好的。但有时我需要最小重量，有时需要最大速度等等。我不希望`GetMaximum*()/GetMinimum*()`每个属性都有一对。

一种解决方案是反思。像（捏住鼻子，强烈的代码气味！）：

```
Decimal GetMaximum(String propertyName);
Decimal GetMinimum(String propertyName); 
```

有没有更好、更不臭的方法来做到这一点？

谢谢，埃里克

编辑：@Matt：.Net 2.0

~~结论：.Net 2.0（使用 Visual Studio 2005）没有更好的方法。也许我们应该很快迁移到 .Net 3.5 和 Visual Studio 2008。多谢你们。~~

结论：有很多不同的方法比反射要好得多。取决于运行时和 C# 版本。看看 Jon Skeets 对差异的回答。所有答案都非常有帮助。

我会寻求 Sklivvz 的建议（匿名方法）。有几个来自其他人（Konrad Rudolph、Matt Hamilton 和 Coincoin）的代码片段实现了 Sklivvz 的想法。不幸的是，我只能“接受”一个答案。

非常感谢你。你们都可以感到“被接受”，尽管只有 Sklivvz 获得了学分；-)

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-09-30T11:21:11.680

（编辑以反映 .NET 2.0 答案和 VS2005 中的 LINQBridge ......）

这里有三种情况 - 虽然 OP 只有 .NET 2.0，但面临同样问题的其他人可能不会......

1) 使用 .NET 3.5 和 C# 3.0：使用 LINQ to Objects，如下所示：

```
decimal maxWeight = list.Max(thing => thing.Weight);
decimal minWeight = list.Min(thing => thing.Weight); 
```

2) 使用 .NET 2.0 和 C# 3.0：使用[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)和相同的代码

3) 使用 .NET 2.0 和 C# 2.0：使用[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)和匿名方法：

```
decimal maxWeight = Enumerable.Max(list, delegate(IThing thing) 
    { return thing.Weight; }
);
decimal minWeight = Enumerable.Min(list, delegate(IThing thing)
    { return thing.Weight; }
); 
```

（我没有 C# 2.0 编译器来测试上述内容 - 如果它抱怨转换不明确，请将委托强制转换为 Func<IThing,decimal>。）

LINQBridge 将与 VS2005 一起使用，但您不会获得扩展方法、lambda 表达式、查询表达式等。显然迁移到 C# 3 是一个更好的选择，但我更喜欢使用 LINQBridge 来自己实现相同的功能。

如果您需要同时获得最大值和最小值，所有这些建议都涉及两次遍历列表。如果您遇到从磁盘延迟加载或类似情况的情况，并且您想一次性计算多个聚合，您可能需要查看我在[MiscUtil中的](http://pobox.com/~skeet/csharp/miscutil)[“Push LINQ”](http://msmvps.com/blogs/jon_skeet/archive/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation.aspx)代码。（这也适用于 .NET 2.0。）

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-09-30T11:18:47.053

如果您使用的是 .NET 3.5 和 LINQ：

```
Decimal result = myThingList.Max(i => i.Weight); 
```

这将使 Min 和 Max 的计算变得相当简单。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-09-30T11:21:23.413

是的，您应该使用委托和匿名方法。

有关示例，请参见[此处](http://encodo.com/en/blogs.php?entry_id=76)。

基本上你需要实现类似于[Lists 的 Find 方法的](http://msdn.microsoft.com/en-us/library/x0b5b5bc(VS.80).aspx)东西。

这是一个示例实现

```
public class Thing
{
    public int theInt;
    public char theChar;
    public DateTime theDateTime;

    public Thing(int theInt, char theChar, DateTime theDateTime)
    {
        this.theInt = theInt;
        this.theChar = theChar;
        this.theDateTime = theDateTime;
    }

    public string Dump()
    {
        return string.Format("I: {0}, S: {1}, D: {2}", 
            theInt, theChar, theDateTime);
    }
}

public class ThingCollection: List<Thing>
{
    public delegate Thing AggregateFunction(Thing Best, 
                        Thing Candidate);

    public Thing Aggregate(Thing Seed, AggregateFunction Func)
    {
        Thing res = Seed;
        foreach (Thing t in this) 
        {
            res = Func(res, t);
        }
        return res;
    }
}

class MainClass
{
    public static void Main(string[] args)
    {
        Thing a = new Thing(1,'z',DateTime.Now);
        Thing b = new Thing(2,'y',DateTime.Now.AddDays(1));
        Thing c = new Thing(3,'x',DateTime.Now.AddDays(-1));
        Thing d = new Thing(4,'w',DateTime.Now.AddDays(2));
        Thing e = new Thing(5,'v',DateTime.Now.AddDays(-2));

        ThingCollection tc = new ThingCollection();

        tc.AddRange(new Thing[]{a,b,c,d,e});

        Thing result;

        //Max by date
        result = tc.Aggregate(tc[0], 
            delegate (Thing Best, Thing Candidate) 
            { 
                return (Candidate.theDateTime.CompareTo(
                    Best.theDateTime) > 0) ? 
                    Candidate : 
                    Best;  
            }
        );
        Console.WriteLine("Max by date: {0}", result.Dump());

        //Min by char
        result = tc.Aggregate(tc[0], 
            delegate (Thing Best, Thing Candidate) 
            { 
                return (Candidate.theChar < Best.theChar) ? 
                    Candidate : 
                    Best; 
            }
        );
        Console.WriteLine("Min by char: {0}", result.Dump());               
    }
} 
```

结果：

`Max by date: I: 4, S: w, D: 10/3/2008 12:44:07 AM`
`Min by char: I: 5, S: v, D: 9/29/2008 12:44:07 AM`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-30T11:20:36.223

如果使用 .NET 3.5，为什么不使用 lambdas？

```
public Decimal GetMaximum(Func<IThing, Decimal> prop) {
    Decimal result = Decimal.MinValue;
    foreach (IThing thing in this)
        result = Math.Max(result, prop(thing));

    return result;
} 
```

用法：

```
Decimal result = list.GetMaximum(x => x.Weight); 
```

这是强类型和高效的。还有一些扩展方法已经做到了这一点。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-30T12:09:13.437

对于 C# 2.0 和 .Net 2.0，您可以对 Max 执行以下操作：

```
public delegate Decimal GetProperty<TElement>(TElement element);

public static Decimal Max<TElement>(IEnumerable<TElement> enumeration, 
                                    GetProperty<TElement> getProperty)
{
    Decimal max = Decimal.MinValue;

    foreach (TElement element in enumeration)
    {
        Decimal propertyValue = getProperty(element);
        max = Math.Max(max, propertyValue);
    }

    return max;
} 
```

以下是您将如何使用它：

```
string[] array = new string[] {"s","sss","ddsddd","333","44432333"};

Max(array, delegate(string e) { return e.Length;}); 
```

以下是在没有上述功能的情况下使用 C# 3.0、.Net 3.5 和 Linq 的方法：

```
string[] array = new string[] {"s","sss","ddsddd","333","44432333"};
array.Max( e => e.Length); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-30T12:17:54.477

这是根据 Skilwz 的想法使用 C# 2.0 进行的尝试。

```
public delegate T GetPropertyValueDelegate<T>(IThing t);

public T GetMaximum<T>(GetPropertyValueDelegate<T> getter)
    where T : IComparable
{
    if (this.Count == 0) return default(T);

    T max = getter(this[0]);
    for (int i = 1; i < this.Count; i++)
    {
        T ti = getter(this[i]);
        if (max.CompareTo(ti) < 0) max = ti;
    }
    return max;
} 
```

你会这样使用它：

```
ThingList list;
Decimal maxWeight = list.GetMaximum(delegate(IThing t) { return t.Weight; }); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-30T12:07:49.540

> ~~结论：.Net 2.0（使用 Visual Studio 2005）没有更好的方法。~~

~~您似乎误解了答案（尤其是乔恩的）。您可以使用他的回答中的选项 3。~~如果您不想使用 LinqBridge，您仍然可以使用委托并`Max`自己实现该方法，类似于我发布的方法：

```
delegate Decimal PropertyValue(IThing thing);

public class ThingList : IList<IThing> {
    public Decimal Max(PropertyValue prop) {
        Decimal result = Decimal.MinValue;
        foreach (IThing thing in this) {
            result = Math.Max(result, prop(thing));
        }
        return result;
    }
} 
```

用法：

```
ThingList lst;
lst.Max(delegate(IThing thing) { return thing.Age; }); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-30T13:17:37.003

通用的 .Net 2 解决方案怎么样？

```
public delegate A AggregateAction<A, B>( A prevResult, B currentElement );

public static Tagg Aggregate<Tcoll, Tagg>( 
    IEnumerable<Tcoll> source, Tagg seed, AggregateAction<Tagg, Tcoll> func )
{
    Tagg result = seed;

    foreach ( Tcoll element in source ) 
        result = func( result, element );

    return result;
}

//this makes max easy
public static int Max( IEnumerable<int> source )
{
    return Aggregate<int,int>( source, 0, 
        delegate( int prev, int curr ) { return curr > prev ? curr : prev; } );
}

//but you could also do sum
public static int Sum( IEnumerable<int> source )
{
    return Aggregate<int,int>( source, 0, 
        delegate( int prev, int curr ) { return curr + prev; } );
} 
```

# silverlight - 当 HTTP 处理程序完成处理时，我如何在客户端知道？

> ID：152618
> 
> 赞同：1
> 
> 时间：2008-09-30T11:18:28.707
> 
> 标签：silverlight, webclient, ashx

对于一个简单的解决方案来说可能是一个很长的问题，但这里有......

我有一个定制的 silverlight 控件，用于选择多个文件并将它们发送到服务器。它使用 WebCLient 控件的 OpenWriteAsync 方法将文件发送到通用处理程序 (FileReciever.ashx)。

基本上，silverlight 代码对每个文件执行以下操作：

```
WebClient client = new WebClient();
client.OpenWriteCompleted += (sender, e) =>
  {
    PushData(data, e.Result);
    e.Result.Close();
    data.Close();
  };
client.OpenWriteAsync(handlerUri); 
```

服务器端处理程序简单地读取传入流，然后对生成的字节数组进行更多处理。

问题是客户端 OpenWriteCompleted 在所有数据都通过网络发送后立即完成。然后我的代码将继续下一个文件。我真正想要的是等到 ASHX 处理程序完成对该请求的所有处理。我怎么做？WebClient 上的任何等待机制？我可以对处理程序中的 HttpContext 进行任何回调吗？我应该使用其他类型的传输技术吗？请指教！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-11-30T10:51:47.387

[Silverlight论坛](http://forums.silverlight.net/t/20144.aspx/1/10)中也提出了同样的问题。微软认可的答案是，你不能用 WebClient 和 OpenWriteAsync 做到这一点。您需要使用 UploadStringAsync 或 HttpWebRequest。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T11:24:48.210

Hrm，也许一个简单的解决方案可能是用 GUID 标记 url（每个文件的 guid 是唯一的，或者传输，只要对您的情况有意义）。然后，您可以拥有另一个简单的 Web 服务，该服务能够根据 guid 检查其他服务的状态，并让您的 silverlight 客户端查询该新服务的处理状态（通过将新的 Web 服务传递给过去的转移）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T11:31:09.893

我假设您担心从处理程序返回的数据需要很长时间才能传输，并且在此期间没有使用服务器。没有办法判断服务器何时完成处理，所以我认为你不能在不改变架构的情况下做到这一点。

我会让您的处理程序只有某种标识符（如 GUID 或 int），可用于在另一个请求中检索处理程序的结果。因此页面将调用处理程序，处理程序将存储结果并返回标识符，页面将第二次调用处理程序并调用另一个处理程序以获取第一次调用的结果。这将使您的服务器在传输数据时保持使用状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T13:15:42.857

或者您可以使用 JavaScript (jQuery) 来实现...如果您不介意使用 JavaScript。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T17:46:33.813

如果文件不是很大，并且可以将每个文件保存在内存中，一个丑陋但有效的解决方案是将它们转换为字符串并使用 UploadStringAsync 方法发送它们。

如果文件大小不受限制，请避免使用此方法，但如果您现在可以将它们相对较小，则可以使用此方法。

# wordpress - Wordpress 站点监控软件/服务

> ID：152623
> 
> 赞同：1
> 
> 时间：2008-09-30T11:20:34.007
> 
> 标签：wordpress, uptime, server-monitoring

您使用什么来监控网站的正常运行时间/性能，特别是那些基于 PHP/MySQL 平台（如 Wordpress）的网站？

我正在寻找可以在站点关闭或执行速度过慢时提醒我的东西，并且有一些有用的（不是大量的！）图表向我显示任何潜在的问题，以及如何处理它们。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T12:08:51.800

我们与通常的[Nagios](http://www.nagios.org/)一起使用[Pingdom](http://pingdom.com/)。它带有许多默认检查。

例如，它还报告您的网站有多快，或者因为他们使用来自不同位置的测试，您会得到一个很好的图表，您的网站的可访问性。为了让它有意义，添加一个参考检查（例如谷歌），看看你的表现如何。

除了 HTTP 等，您还可以检查其他服务（邮件、数据库等）。如果从外部无法访问它们，您始终可以创建一个输出标准“OK”的脚本并让 Pingdom 检查它，并在输出更改时报告。

我应该补充一点，Pingdom 不是免费服务。但是我们已经使用它们 10 个月了，它们并没有给我们带来困扰。:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T11:22:16.873

尝试查看 Zabbix

[http://www.zabbix.com/](http://www.zabbix.com/)

*   WEB性能监控
*   WEB可用性监控
*   支持 POST 和 GET 方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-11T18:02:52.830

也试试[Insping](https://www.insping.com/)

1.  性能监控
2.  可用性监控
3.  电子邮件和短信提醒

# c++ - 从 const 映射中读取的惯用 C++

> ID：152643
> 
> 赞同：14
> 
> 时间：2008-09-30T11:29:14.207
> 
> 标签：c++, stl

对于一个`std::map<std::string, std::string> variables`，我想这样做：

```
BOOST_CHECK_EQUAL(variables["a"], "b"); 
```

唯一的问题是，在这种情况下`variables`是`const`，所以`operator[]`不会工作:(

现在，有几种解决方法；抛弃`const`，使用`variables.count("a") ? variables.find("a")->second : std::string()`甚至制作一个包装它的函数。在我看来，这些都不如`operator[]`. 我该怎么办？有没有标准的方法（漂亮地）？

**编辑：**只是为了说明你们都不想给出的答案：不，在 C++ 中没有方便、美观、标准的方法来做到这一点。我将不得不实现一个支持功能。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-30T11:38:08.240

```
template <typename K, typename V>
V get(std::map<K, V> const& map, K const& key)
{
    std::map<K, V>::const_iterator iter(map.find(key));
    return iter != map.end() ? iter->second : V();
} 
```

根据评论改进实施：

```
template <typename T>
typename T::mapped_type get(T const& map, typename T::key_type const& key)
{
    typename T::const_iterator iter(map.find(key));
    return iter != map.end() ? iter->second : typename T::mapped_type();
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-30T11:45:23.900

抛弃 const 是错误的，因为 map<> 上的 operator[] 将创建该条目，如果它不存在默认构造的字符串。如果地图实际上是在不可变存储中，那么它将失败。必须如此，因为 operator[] 返回一个非常量引用以允许赋值。（例如，m[1] = 2）

实现比较的快速免费功能：

```
template<typename CONT>
bool check_equal(const CONT& m, const typename CONT::key_type& k,
                    const typename CONT::mapped_type& v)
{
    CONT::const_iterator i(m.find(k));
    if (i == m.end()) return false;
    return i->second == v;
} 
```

如果我想到什么，我会考虑语法糖和更新。

...

直接的语法糖涉及一个自由函数，它执行 map<>::find() 并返回一个包装 map<>::const_iterator 的特殊类，然后重载 operator==() 和 operator!=() 以允许与映射类型进行比较。因此，您可以执行以下操作：

```
if (nonmutating_get(m, "key") == "value") { ... } 
```

我不相信这比：

```
if (check_equal(m, "key", "value")) { ... } 
```

而且它肯定要复杂得多，发生的事情也不那么明显。

包装迭代器的对象的目的是停止使用默认构造的数据对象。如果您不在乎，则只需使用“获取”答案。

为了回应关于 get 比比较更受欢迎的评论，希望能找到一些未来的用途，我有以下评论：

*   说出您的意思：调用一个名为“check_equal”的函数可以清楚地表明您正在进行相等比较而无需创建对象。

*   我建议仅在您有需要时才实施功能。在此之前做某事往往是错误的。

*   根据情况，默认构造函数可能会产生副作用。如果你在比较，为什么要做额外的事情？

*   SQL 参数：NULL 不等于空字符串。容器中缺少键是否与容器中存在具有默认构造值的键真的相同？

说了这么多，默认构造的对象等效于在非常量容器上使用 map<>::operator[] 。也许您当前需要一个返回默认构造对象的 get 函数；我知道我过去有过这样的要求。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-30T11:36:10.460

`find`是惯用的形式。抛弃`const`几乎总是一个坏主意。您必须保证不执行任何写操作。虽然可以合理地预期在地图上进行读取访问，但规范没有说明这一点。

如果您*知道*该值存在，您当然可以放弃测试使用`count`（无论如何，这是非常低效的，因为这意味着遍历地图两次。即使您不知道该元素是否存在，我也不会使用它。使用改为：

```
T const& item(map<TKey, T> const& m, TKey const& key, T const& def = T()) {
    map<TKey, T>::const_iterator i = m.find(key);
    return i == m.end() ? def : i->second;
} 
```

/ EDIT：正如克里斯正确指出的那样，类型对象的默认构造`T` *可能*很昂贵，特别是因为即使实际上不需要该对象（因为该条目存在）也要这样做。如果是这种情况，请不要`def`在上述情况下使用参数的默认值。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-30T14:03:58.733

有趣的是，有两种方法可以在被接受的 get 实现中进行模板类型发现（获取值或返回默认构造对象的方法）。一，您可以做被接受的事情并拥有：

```
template <typename K, typename V>
V get1(const std::map<K, V>& theMap, const K const key)
{
    std::map<K, V>::const_iterator iter(theMap.find(key));
    return iter != theMap.end() ? iter->second : V();
} 
```

或者您可以使用地图类型并从中获取类型：

```
template<typename T>
typename T::mapped_type
get2(const T& theMap, const typename T::key_type& key)
{
    typename T::const_iterator itr = theMap.find(key);
    return itr != theMap.end() ? itr->second : typename T::mapped_type();
} 
```

这样做的好处是传入的键的类型不会在类型发现中起作用，它可以是可以隐式转换为键的东西。例如：

```
std::map<std::string, int> data;
get1(data, "hey"); // doesn't compile because the key type is ambiguous
get2(data, "hey"); // just fine, a const char* can be converted to a string 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T11:36:45.263

实际上，operator[] 是 std::map 上的一个非常量，因为如果它不存在，它会自动在映射中插入一个键值对。（哦哦副作用！）

正确的方法是使用`map::find`and，如果返回的迭代器有效 ( `!= map.end()`)，则返回`second`，如您所示。

```
map<int, int> m;
m[1]=5; m[2]=6; // fill in some couples
...
map<int,int>::const_iterator it = m.find( 3 );
if( it != m.end() ) {
    int value = it->second;
    // ... do stuff with value
} 
```

您*可以*在您正在使用的 std::map 的子类中添加 a `map::operator[]( const key_type& key ) const`，并断言要找到的键，然后返回`it->second`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T16:40:00.650

```
std::map<std::string, std::string>::const_iterator it( m.find("a") );
BOOST_CHECK_EQUAL( 
                     ( it == m.end() ? std::string("") : it->second ), 
                     "b" 
                 ); 
```

这对我来说看起来还不错……我可能不会为此编写函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T07:51:41.670

遵循 xtofl 专门化地图容器的想法。下面的工作会好吗？

```
template <typename K,typename V>  
struct Dictionary:public std::map<K,V>  
{  
  const V& operator[] (const K& key) const  
  {  
    std::map<K,V>::const_iterator iter(this->find(key));  
    BOOST_VERIFY(iter!=this->end());  
    return iter->second;  
  }  
}; 
```

# wpf - WPF列表中每个项目的不同项目模板？

> ID：152664
> 
> 赞同：14
> 
> 时间：2008-09-30T11:37:22.827
> 
> 标签：wpf, itemtemplate

我在列表控件中有很多项目。我希望每个项目都有不同的项目模板，具体取决于项目的类型。所以列表中的第一项是 ObjectA 类型，所以我希望它使用 ItemTemplateA 呈现。第二项是 ObjectB 类型，因此我希望它具有 ItemTemplateB 进行渲染。目前我只能使用 ItemTemplate 设置来为他们定义一个模板。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-30T12:18:29.593

这将起作用，但我认为在您的资源部分创建多个 s 然后只给每个一个 s`ItemTemplateSelector`更容易。如果项目生成器检测到匹配的数据类型，这将自动使用它吗？`DataTemplate``DataType``DataTemplate`

```
<DataTemplate DataType={x:Type local:ObjectA}>
   ...
</DataTemplate> 
```

还要确保您没有`x:Key`为`DataTemplate`. [在此处](http://www.zagstudio.com/blog/361#.Us6JPJG-3nc)
阅读有关此方法的更多信息

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T11:41:22.383

查看列表控件的[ItemTemplateSelector](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemtemplateselector.aspx)属性。您可以将其指向自定义 TemplateSelector 并决定在代码中使用哪个模板。

这是一篇描述 TemplateSelectors 的博客文章：

[http://blogs.interknowlogy.com/johnbowen/archive/2007/06/21/20463.aspx](http://blogs.interknowlogy.com/johnbowen/archive/2007/06/21/20463.aspx)

编辑：这是一个更好的帖子：

[http://blog.paranoidferret.com/index.php/2008/07/16/wpf-tutorial-how-to-use-a-datatemplateselector/](http://blog.paranoidferret.com/index.php/2008/07/16/wpf-tutorial-how-to-use-a-datatemplateselector/)

# ms-access - Access 2003和2007都安装在同一台机器上时，如何防止Windows Installer在每次启动时运行？

> ID：152670
> 
> 赞同：1
> 
> 时间：2008-09-30T11:40:55.567
> 
> 标签：ms-access, ms-access-2007

是否可以阻止 Windows 安装程序在每次启动 Access 2003 和 Access 2007 时运行，当它们同时安装在同一台机器上时......？

像许多开发人员一样，我需要运行超过 1 个版本的 MS Access。我刚刚安装了 Access 2007。如果我打开 Access 2003，然后打开 Access 2007，我必须等待 3 分钟才能看到“正在配置 Microsoft Office Enterprise 2007...”对话框。然后，如果我再次打开 Access 2003，则需要另外 30 秒左右才能完成配置那个。

请注意：我使用快捷方式打开包含 Access 完整路径的文件。例如打开 Access 2007：

```
 "C:\program files\microsoft office 12\office12\msaccess.exe" "C:\test.accdb" 
```

2003 年：

```
 "C:\program files\microsoft office 11\office11\msaccess.exe" "C:\test.mdb" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-20T11:08:28.733

事实证明，该问题的修复非常简单 - 只需运行以下命令（通过按 Windows 键+R 或在“开始/运行”命令框中键入它。如果您安装了 Office 2003，请使用带有 Office\11.0 的行和 Office\12.0 如果您安装了 Office 2007。如果您同时安装了两者，则可以同时使用：

```
reg add HKCU\Software\Microsoft\Office\11.0\Word\Options /v NoReReg /t REG_DWORD /d 1

reg add HKCU\Software\Microsoft\Office\12.0\Word\Options /v NoReReg /t REG_DWORD /d 1 
```

这就对了。Office 2007 可能希望使用它的配置对话框再旋转一次，但应该就是这样。

C:\Program Files>Common Files>microsoft shared>OFFICE12>Office Setup Controller>SETUP.exe 改成 SETUPold.exe

[HKEY_CURRENT_USER\Software\Classes\Access.Application]

每次打开 Access 2007 时，此键都会导致配置屏幕不断循环。
通过删除该键及其下的所有内容，它可以解决循环问题，并且 Access 2007 会立即打开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T12:43:36.600

这是由两个安装程序都使用的 Windows Installer 引起的。Office 2003 和 Office 2007 使用的广告快捷方式调用 Windows Installer 来检查整个功能是否安装正确；安装程序检测到其他东西（在这种情况下是其他产品）已经注册了 Access 使用的文件扩展名（也可能是 ProgIds）并决定需要修复，因此它调用“配置 Office”对话框并继续重新安装各种组件。

为避免这种情况，请直接从 Program Files 运行 Access；如果您经常这样做，请创建快捷方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-01T03:09:53.850

想要在打开 Access 2003 后将其缩短到大约 20 秒以重新配置 Access 2007？下载并安装 Office 2007 sp1：

[http://www.microsoft.com/downloads/details.aspx?FamilyId=9EC51594-992C-4165-A997-25DA01F388F5&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=9EC51594-992C-4165-A997-25DA01F388F5&displaylang=en)

顺便说一句，您无法避免在 Access 2007 和早期版本之间进行重新配置。Access 2007 使用一些与早期版本相同的注册表项，并且在打开 Access 2007 时必须重写它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-22T16:19:57.790

只需安装 Office 2007 Sp2，即可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-02T01:37:09.307

我为此找到的最佳解决方法是使用 VMWare Thinapp 虚拟化一个（或多个）有问题的 Access 版本：

[http://www.vmware.com/products/thinapp/](http://www.vmware.com/products/thinapp/)

它比完整的 Virtual PC / VMWare / etc 安装更轻量级，但不幸的是设置起来还是有点麻烦，而且不是免费的。

# vb.net - 尝试块中的 DataReader 导致潜在的空引用错误

> ID：152675
> 
> 赞同：3
> 
> 时间：2008-09-30T11:43:16.403
> 
> 标签：vb.net, visual-studio, exception

可能有一个简单的解决方法，但我目前有类似的代码

```
dim dr as dbDataReader

try
      dr = connection.getDataReader(sql_str)
Catch ex as sqlClientException
     log.error(ex)
finally 

  if not IsNothing(dr) then
    dr.close
  end if
end try 
```

但是 Visual Studio 仍然警告我

```
if not IsNothing(dr) then
        dr.close
      end if 
```

可能导致 NullReferenceException。减轻这种情况的最佳方法是什么？我无法将声明移到 try 块中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-30T11:57:00.300

将 dr 声明显式初始化为 Nothing，如下所示：

```
Dim dr As DbDataReader = Nothing 
```

警告将消失。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-30T12:40:12.460

如果`GetDataReader`抛出，`dr`将不会被分配并且仍然具有它的初始值。VB.NET 确实初始化了对 的引用`Nothing`，但编译器不会让你依赖它。

如果使用 .NET 2.0，我会推荐一个`Using`声明：

```
Using dr As DbDataReader = connection.GetDataReader(sql_str)
    Try
        ' Do something with dr '
    Catch ex As SqlClientException
        log.error(ex)
    End Try
End Using 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T11:55:51.473

你的代码是正确的。在`finally`语句中，只要您检查以确保您的对象不为空，它就不会根据您的代码中发生的情况抛出空引用异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T11:56:30.833

我不记得究竟是如何 VB.NET 初始化变量，但在 C# 中，您必须在某处使用它们之前设置“dr”一些值/引用。

我认为这应该有效：

```
dim dr as dbDataReader

try
      dr = connection.getDataReader(sql_str)
Catch ex as sqlClientException
     log.error(ex)
     dr = Nothing ' there is the change '
' finaly block is not necesary '
end try

if not IsNothing(dr) then
  dr.close
end if 
```

# winforms - WinForms 打印：如何访问进度对话框？

> ID：152676
> 
> 赞同：1
> 
> 时间：2008-09-30T11:43:31.720
> 
> 标签：winforms, printing

在 Windows 窗体中打印或进行打印预览时，会显示一个对话框，其中包含如下文本

[DOC] 的第 [P] 页

其中 [P] 是页码，[DOC] 是文档的名称。该对话框还包含一个允许用户取消打印作业的按钮。

如何更改显示的文本？我更喜欢的是文字

第 [P] 页，共 [页]

其中 [Pages] 是总页数，用于向用户指示打印所有页面需要多长时间。如果可能的话，我还想显示一个进度条，因为当打印作业开始时，我确切地知道要打印多少页。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T11:52:14.260

我这样做了：

*   从 PrintDocument 派生您自己的类，处理所有打印
*   将打印控制器设置为新的 StandardPrintController（然后不显示对话框）
*   显示您自己的对话框，例如在 OnBeginPrint 和 OnEndPrint 中显示和关闭，在 OnPrintPage 中更新

如果我没记错的话，没有办法更改文本，而且由于默认对话框不可本地化，我们无法使用它。不过，它适用于我上面写的内容。

# java - Eclipse 是 Java 的最佳 IDE 吗？

> ID：152691
> 
> 赞同：84
> 
> 时间：2008-09-30T11:49:50.943
> 
> 标签：java, eclipse, ide

Eclipse 是否最`IDE`适合 Java？

如果没有，有更好的吗？

我想知道并可能尝试一下。谢谢。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-09-30T12:14:48.730

首先让我说 Eclipse 是适用于 Java 和许多其他语言的*出色*IDE。它的插件架构和可扩展性很难与之匹敌，而且它是免费的这一事实对于较小的团队或预算紧张来说是一个巨大的优势。

*我讨厌*Eclipse的一些事情。

*   文档真的很缺乏。我不知道这些东西是谁写的，但如果它不只是完全丢失，那它就是不完整的。如果它不是不完整的，那么它就是完全错误的。我已经浪费了许多宝贵的时间来尝试使用 Eclipse 中的给定特性，通过浏览它的文档却发现它一开始就是垃圾。
*   尽管项目规模很大，但我发现社区非常缺乏和/或令人困惑，难以参与。我曾多次尝试获得有关特定主题或插件的帮助，但只能发送给 3 或 4不同的新闻组都指向另一个新闻组或只是简单地不响应。这可能非常令人沮丧，因为我使用的更小的开源产品*非常*适合回答我的问题。也许这只是社区规模的一个函数。
*   如果您需要超出其发行版之一捆绑功能的功能（例如，捆绑了 WTP 之类的东西的 Eclipse for Java EE Developers 发行版），我发现额外插件的安装过程非常*痛苦*。我不知道为什么他们不能让这个过程更简单（或者我只是在家里的 Mac 上被宠坏了，不知道它在“现实”世界中到底有多糟糕）但如果我不仅不成功，通常需要几个小时才能安装新插件。这应该是他们在 3.4 中的目标之一（使新项目的安装更简单）；如果他们成功了，我不知道。
*   书籍和实际教程形式的文档非常缺乏。我想要一个像 Eclipse 这样密集且功能丰富的东西的主演练；上面写着“嘿，你知道这个功能以及它如何真正让你更有效率吗？”。据我发现，*没有*这样的东西存在。如果你想弄清楚 Eclipse，你有一个选择，坐下来玩它（实际上是玩它，而不只是看到一个特性然后去阅读它的文档，因为它可能不存在或者是错误的）。

尽管有这些东西，Eclipse 确实是一个很棒的 IDE。它的重构工具工作得非常好。Javadoc 的处理工作完美。我们对 IDE 的所有期望都是它们的（代码完成、模板、与各种 SCMS 的集成、与构建系统的集成）。它的代码格式化和清理工具非常强大。我发现它的构建系统运行良好且直观。我认为这些才是真正建立其声誉的基础。

我对其他 IDE 或其他 Eclipse 发行版没有足够的经验（我已经多次看到 RAD 在工作；我不敢相信*有人*会为此付出代价）来评论他们，但在大多数情况下，我对 Eclipse 非常满意。我从多个地方听到的一个提示是，如果您希望 Eclipse 没有直接安装带来的很多麻烦，请选择付费发行版。[我的 Eclipse](http://www.myeclipseide.com/)是我在网上看到的一个非常推荐的版本，它真的*非常*实惠（最后我听说，发行版 50 美元，外加一年的免费升级）。如果您有预算并且需要附加功能，我会选择类似的东西。

无论如何，我已经尽力做到尽可能详细。我希望这对您的搜索有所帮助并祝您好运！:)

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2008-09-30T23:19:52.437

IntelliJ IDEA 很棒。现在它只是“比 Eclipse 更好”。根据我的经验，你可以在 IDEA 中编码比在 Eclipse 中快几倍（我从 Eclipse 的早期采用者转到 IDEA 并且没有回头），但 IDEA 有许多缺陷：

*   完整版不是免费的。
*   它占用内存
*   项目管理不是很好
*   Jetbrains 不断推出次要增强功能并将其称为主要版本。与几年前相比，IDEA 现在变得更慢、更麻烦。你会因为快乐而被收费！（IDEA 现在有一个免费的社区版）

不过，我仍然不会回去；IDEA 中的代码重构和意图太好了。

Eclipse 的一个主要版本不久前发布了，我在网站上搜索了大约一个小时，以找出版本中实际包含的内容，这可能会说服我重新加入。访问[JetBrains](http://www.jetbrains.com)了解如何销售 IDE！

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2008-10-23T09:59:06.083

没有最好的 IDE。你让它和你习惯使用它一样好。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2011-01-27T08:35:27.233

在我看来，Eclipse 不能远程称为 IDE。好吧，这有点夸张，我知道。它只是反映了我对日食的强烈痛苦！无论你做什么，它都是行不通的！你总是需要与它抗争，让它以正确的方式做事。在那段时间里，你不是在开发你应该做的代码，对吧？eclipse和maven集成：不可靠！Eclipse 和 ivy 集成：不可靠。WTP：越野车越野车！Eclipse 和 wstl 验证：错误！它抱怨找不到 URL，即使它们确实存在，几天后，在没有更改它们的情况下，它突然发现它们等等。我可以写一本关于它的书。回答您的问题：NO ECLIPSE 甚至不是最好的 IDE！IntelliJ 应该更好！

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2008-09-30T12:22:03.347

Eclipse 是第一个让我脱离 XEmacs 的 IDE。然而，当我的雇主提出如果我想要一个 Intellij IDEA 许可证时，我只需要 3 天的时间和一份评估副本就说服我去购买它。

似乎很多小东西都更好。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2008-09-30T11:52:46.520

IntelliJ 不错，但不是免费的！！那么 NetBeans 也是一个不错的选择。另外，如果您是 IBM 套件，WSAD 也不错

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2008-09-30T12:25:19.453

我必须投票支持 Netbeans 作为目前最好的。Eclipse 不错，但现在 Netbeans 更好。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2008-10-01T01:59:21.897

我使用 IntelliJ 将近 5 年多（从 v1.5 到 v7），大约 8 个月前我迁移到 IBM RAD（建立在旧的 eclipse 平台之上），大约 3 个月前我用 Eclipse（Ganymede）安顿下来.

我在一个中等规模的项目（有 10k 个类）上使用了 IntelliJ，而我在一个只有几百个类的项目上使用了 Eclipse。

我发现这两个 IDE（IntelliJ 和 Eclipse）都很好。IBM RAD 只是浪费钱（当然，如果没有选择，可能会被困在 IBM 商店）。

与 Eclipse 相比，IntelliJ 的大部分功能具有更出色的重构功能和键盘快捷键。它支持从 Eclipse 导入项目。它具有更好的内置 xml 处理功能（重构几乎适用于 java 代码）。内置的 Intelli Sense 也非常好。

Eclipse 是一个很棒的工具，而且它是免费的。我花了大约 1-2 个月的时间从 IntelliJ 习惯了 Eclipse（很多忘记了快捷方式），但我掌握了 Eclipse，它非常顺利。我没有在中型项目上使用过 Eclipse。

IntelliJ 和 Eclipse 都有活跃的插件社区，并且都与版本控制系统、单元测试框架、应用程序服务器和分析器很好地集成在一起。

IntelliJ 从 v4.0 开始变得缓慢和臃肿。中型项目进展缓慢。除非可以提高性能，否则我不会使用 IntelliJ。

除了 java 开发之外，我没有将这两个 IDE 用于其他任何东西。

如果您是 Java 开发人员并且您的公司为 IntelliJ 付费，并且如果您的项目不是太大，那就去吧。否则，不要绝望：Eclipse 总是存在的。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2011-04-20T21:20:45.360

在我的新工作中，我给了 Eclipse 3 个月的时间，但之后我发现普通的 Maven 项目也可以在 IntelliJ IDEA 中运行（除非它是 Eclipse 插件/EMF/当然；-)）。3 个月不足以与 IDEA 的 8 年以上相比，但足以声称我给了它一个公平的尝试。我决定接受它的观点（其他 IDE 不需要它们），它的调试器很差（除非你点击它们，否则不显示日期值！等等），它的完成度比 IDEA 的相对差。

经过这么多年，现在 IDEA 也是免费的（社区版），我使用它没有太多麻烦。当然我很怀念付费版的一些“终极”功能，但它比 Eclipse 好得多。最大的不同是这两个 IDE 所需的整体思维方式。但是在你掌握了两者的思维方式之后，我无法理解任何人对 Eclipse 有什么看法——除非你需要它的插件生态系统或者你在那里有一些重大的投资。

“心态”差异的示例：您必须在 Eclipse 中保存，而不是在 IDEA 中，我不在乎什么是更好或更坏 - 但您必须在 Eclipse 中保存，让他清理带下划线的错误，这些错误不再是错误，等等；-) 你必须保存在那里才能消除其他文件中的错误，因为其他文件看不到更改。

我写了更多关于这个话题的博客——是的，我有偏见，尽管我试图尽可能少。但过了一段时间后，这不仅仅是可能的：:-)

*   [http://virgo47.wordpress.com/2011/01/30/eclipse-vs-intellij-idea/](http://virgo47.wordpress.com/2011/01/30/eclipse-vs-intellij-idea/)
*   [http://virgo47.wordpress.com/2011/02/22/from-intellij-idea-to-eclipse-2/](http://virgo47.wordpress.com/2011/02/22/from-intellij-idea-to-eclipse-2/)
*   [http://virgo47.wordpress.com/2011/03/24/from-intellij-idea-to-eclipse-3/](http://virgo47.wordpress.com/2011/03/24/from-intellij-idea-to-eclipse-3/)
*   [http://virgo47.wordpress.com/2011/04/10/from-intellij-idea-to-eclipse-4/](http://virgo47.wordpress.com/2011/04/10/from-intellij-idea-to-eclipse-4/)

不，即使 IDEA 也不是完美的，我知道。因为我经常使用它。但如果你问我，它是最好的 Java IDE。甚至社区版。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-09-30T13:07:15.233

[这不是一个真正的答案，只是一个轶事。我和那些使用大量加载宏和颜色编码的emacs的人一起工作。疯狂的！既然有这么多好的 IDE，为什么要这样做？]

如果你熟悉 emacs，你的编码速度可以比 IDE 快 100 倍。它可以处理多种不同的语言，因此如果您需要使用另一种语言进行编码，则无需更改编码环境。适用于所有操作系统，您可以自定义/添加任何您想要的东西。甚至可以通过 ssh 在世界的另一端编辑文件。（无需下载或上传）。在称他们为疯狂之前，您必须先使用它。我敢肯定，他们会因为使用 IDE 而称您为疯狂 :)。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2008-09-30T11:57:38.647

人们常说对于各种语言（例如 Java）有比 Eclipse 更好的 IDE。

Eclipse 的强大之处在于它对于*许多*语言来说基本上是相同的 IDE，这意味着如果您知道您必须使用多种编程语言（Java、C++、Python）进行编码，那么您只需学习一个 IDE 是一个巨大的优势：蚀。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-10-01T01:14:26.810

我不知道 Eclipse 是否是最好的 Java IDE，但它绝对是非常不错的，也是我最喜欢的 IDE。我之前尝试过 IntelliJ，发现它与 Eclipse 非常相似（IntelliJ 可能会提供一些更好的功能，但 Eclipse 是免费和开源的）。我从未真正尝试过 NetBean，因为我在了解 NetBean 之前就了解了 Eclipse。

Eclipse 是我的最爱，因为：

*   自由的
*   可扩展（可以将其转入 C++ IDE 或 DB 开发 IDE）
*   开源
*   我知道如何编写 Eclipse 插件
*   您可以使用 Eclipse 轻松开发产品（exp. Lime Wire 是 Eclipse 的底层）

如果您习惯使用像 JCreator 这样的传统 Java IDE，您可能需要一些时间来习惯 Eclipse。记得刚学Eclipse的时候，还不知道怎么编译Java源码……

我建议，为了找到最适合你的 IDE，试试人们推荐的（NetBean、Eclipse 和 IntelliJ），看看你最喜欢哪个，然后坚持下去，成为它的专家。在我看来，拥有正确的 IDE 将大大提高您的工作效率。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2008-09-30T11:51:22.513

蚀！它有时可能很慢并且使用大量内存，但效果很好。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2008-09-30T13:44:08.703

我将不得不推荐[Oracle JDeveloper](http://www.oracle.com/technology/products/jdev/index.html)。我个人曾一度认为 Eclipse 也是最好的 Java IDE。然后我被我的工作介绍给了[Oracle JDeveloper](http://www.oracle.com/technology/products/jdev/index.html)。我发现 UI 设计比 Eclipse 好得多。此外，它还内置了大量功能，包括对 EJB3、JSF、WebServices 等的强大支持。它本质上是一个适用于整个 JavaEE 堆栈（以及 Oracle ADF 框架）的 IDE。- JavaEE 开发所需的所有工具（可能）都随此 IDE 一起提供，无需插件（除非您下载极简版本）。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2011-01-08T08:16:30.850

谈到 java IDE，最好选择 NetBeans。在我看来，它比其他 ide 更好，并且提供了很大的优势，但它比 Eclipse 有缺点，它在工作时抓取更多，但对它的特性和支持我建议 Netbeans 比任何ide

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-09-30T11:55:21.973

同意其他人的意见。Netbeans 是一个相当不错的 IDE，如果您倾向于使用其中的任何一种，它也适用于其他语言（PHP、Ruby、C/C++）。然后，在决定学习一门新语言时，您会获得了解 IDE 的额外好处。

然而，公平地说，我没有太多时间使用 eclipse IDE。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-01T19:47:15.293

我同意其他一些人的观点，即 NetBeans 和 IntelliJ 都是很好的 IDE。我想说的是，在使用所有三个（Eclipse + 其他两个）时，Eclipse 是迄今为止我最喜欢的。我发现一些文档已经过时，但也发现支持社区非常有帮助。我开始使用 Eclipse 是跳到池子的最深处：在学习 IDE 之前编写一个 RCP。IDE 使用起来很直观，当我找到合适的新闻组发布时 - 我的大部分问题都已得到解答。对我来说最困难的事情（当然也令人沮丧）是知道如何表达我的搜索词以获得已经发布的答案。

请记住，Eclipse 作为 IDE 播放器仍然是“相对较新的”，尽管考虑到这一点 - 它非常强大。

我对 Eclipse 的唯一抱怨是，每次发布新版本时，它似乎都会占用更多资源。对于中型项目/工作空间，构建（或重建）项目似乎需要很长时间。与 IntelliJ 相比，它使用起来更快、更直观。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-09-30T11:52:12.857

这是主观的......我发现它是一个很好的工具。

这取决于你在做什么样的开发——对于 EJB 的东西，很多人会喜欢 Netbeans。这还取决于你想花多少钱——我假设你在谈论免费的 IDE？

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-30T11:53:37.437

在我看来，如果您有资源可以使用，那么请使用 eclipse。像 eclipse 一样棒的 NetBeans 是另一个最佳选择，这是我用过的唯一 2 个（喜欢、需要、想要）

Eclipse 无疑是最受欢迎的，而且有充分的理由！

希望这可以帮助。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-01-20T07:11:51.260

不要忘记 Eclipse Platform 是由 IBM 启动的。那里的平台很少。

*   IBM Websphere Application Developer (WSAD) 和/或 Rational Application Developer (RAD)，它是来自 IBM 的 Eclipse 类型的 IDE（实际上，它是带有 IBM 专用库/插件的 Eclipse）。
*   MyEclipse（从未使用过，但它是另一个 Eclipse 类型的 IDE）
*   Sun Microsystem 的 NetBeans。它过于以 Java 为中心，因为它旨在纯粹用 Java 创建应用程序（NetBeans 在 Java 中运行）。
*   IntelliJ（仅举几例）
*   Oracle JDeveloper（我从来没有真正喜欢过 JDeveloper 创建的目录结构布局）。

Eclipse 的优势在于它可以根据您的开发乐趣进行定制，可以为 Eclipse 编写插件以满足您的需求（例如，用于在 Windows Explorer 中浏览源目录的 Eclipse“Easy Explorer”插件）。Eclipse 还允许您合并其他语言/SDK，例如 C++、Silverlight 项目、Android 项目进行开发。您还可以轻松地在 Eclipse 中管理资源。

根据我的经验，NetBeans 是资源密集型的。不过，Oracle JDeveloper 和 IntelliJ 并不是免费的。哦，是的，如果您在使用 Eclipse 时遇到问题或错误，Eclipse 可以重新启动并将崩溃提交给 Eclipse 服务器。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-30T23:35:15.597

我有使用[JCreator LE](http://www.jcreator.com/)的经验。我喜欢它，因为它易于使用且免费。如果您感兴趣，请尝试一下。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-30T12:44:28.533

这不是一个真正的答案，只是一个轶事。我和那些使用大量加载宏和颜色编码的emacs的人一起工作。疯狂的！既然有这么多好的 IDE，为什么要这样做呢？

# axapta - 如何使用 X++ 扫描图像

> ID：152692
> 
> 赞同：2
> 
> 时间：2008-09-30T11:49:54.797
> 
> 标签：axapta, microsoft-dynamics, x++, ax

有谁知道如何用 X++ 扫描图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-05T03:23:09.290

没有办法直接做，但你应该可以通过 COM调用[Windows Image Acquisition API](http://msdn.microsoft.com/en-us/library/aa139779.aspx)

# exception-handling - 避免抛出新异常

> ID：152693
> 
> 赞同：-3
> 
> 时间：2008-09-30T11:50:43.687
> 
> 标签：exception-handling

我有一个**if**条件来检查值并抛出新的**NumberFormatException**

有没有其他方法来编码这个

```
if (foo)
{
    throw new NumberFormatException
}

// ..

catch (NumberFormatException exc)
{
    // some msg...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T11:57:02.080

如果你正在做这样的事情：

```
try
{
   // some stuff
   if (foo)
   {
      throw new NumberFormatException();
   }
}
catch (NumberFormatException exc)
{
   do something;
} 
```

那么当然，您可以完全避免异常并在条件块内执行“做某事”部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T11:54:31.697

如果您的目标是避免引发新异常：

```
if(foo)
{
  //some msg...
} else
{
  //do something else
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T12:07:16.937

如果您可以以另一种更优雅的方式处理它们，请不要抛出异常。异常是昂贵的，并且应该只用于发生超出您控制的事情的情况（例如，数据库服务器没有响应）。

如果您试图确保一个值的设置和格式正确，您应该尝试以更优雅的方式处理这些条件的失败。例如...

```
if(myObject.value != null && Checkformat(myObject.Value)
{
    // good to go
}
else
{
    // not a good place to be.  Prompt the user rather than raise an exception?
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T11:55:57.183

在 Java 中，您可以尝试使用正则表达式解析字符串，然后再尝试将其转换为数字。

如果您试图捕获自己的异常（为什么？？？），您可以这样做：

```
try { if (foo) throw new NumberFormatException(); }
catch(NumberFormatexception) {/* ... */} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T11:58:59.983

如果您试图用其他错误处理机制替换抛出异常，您唯一的选择是返回或设置错误代码 - 问题是您必须去确保在其他地方检查它。

例外是最好的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T12:27:56.327

如果您知道将导致您抛出 NumberFormatException 的流程，请编写处理该情况的代码。您不应该将异常层次结构用作程序流机制。

# svn - CruiseControl.net：使用 SvnLabeller / SvnRevisionLabeller

> ID：152694
> 
> 赞同：0
> 
> 时间：2008-09-30T11:50:51.190
> 
> 标签：svn, cruisecontrol.net

我正在使用 CruiseControl.net 1.4 设置一个新项目。

我从[ccnet 的贡献](http://confluence.public.thoughtworks.org/display/CCNETCOMM/Contributions)中看到 ，subversion 存储库编号标签器有两个选项 - 我真的很想使用这个功能。

1) SVNLabeller 可从[jcxsoftware 获得](http://www.jcxsoftware.com/jcx/ccnet-dev)

和

2) Svnrevisionlabeller 可从[谷歌代码获得](http://code.google.com/p/svnrevisionlabeller/)

我的问题是（1）声称支持 ccnet 1.4，但我找不到任何关于如何配置它的文档。

(2) 附带文档但不声称支持ccnet 1.4

谁能帮助我如何配置 SVNLabeller 或告诉我 Svnrevisionlabeller 是否适用于 1.4？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T03:07:56.800

这是 SvnRevisionLabeller 的作者/维护者 David Keaveny。我每天在工作中使用它来对抗 v1.4.2，所以我认为可以肯定地说它工作正常。我可能应该更新 Google Code 网站以反映这一点。

**更新**：我已经更新了项目 wiki 以反映这一点。哦，我也收到了一堆功能请求，所以请密切注意在不久的将来发布的新版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-26T16:38:53.633

您是否查看过[David Keaveny](http://ilmatte.wordpress.com/2008/03/05/cruisecontrolnet-and-subversion-svnrevisionlabeller/)关于 SVNRevisionLabeller 的博客文章？该链接将带您查看有关其用法的详细帖​​子。

我们目前正在针对 CCNet 的当前版本 (1.4) 测试该实用程序，没有任何问题，即它正在生成正确的修订版并构建附加到我们指定的主要/次要数字的标签。

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-01-07T00:48:05.630

我是 SVNLabeler 的作者。您可以在此处获得 1.5 版本：

[http://svn.jcxsoftware.com/node/216](http://svn.jcxsoftware.com/node/216)

以下是你如何使用它：

```
 <labeller type="SvnLabeller">
    <MajorVersion>1</MajorVersion>
    <MinorVersion>2</MinorVersion>
    <BuildNumber>3</BuildNumber>
    <workingDirectory>c:\path to your code</workingDirectory>
    <executable>c:\path to\svn.exe</executable>
  </labeller> 
```

版本如下：

1.2.3.SVN_REVISION_NUMBER

祝你好运，

胡安

# ruby - 在 Ruby 中打开默认浏览器

> ID：152699
> 
> 赞同：60
> 
> 时间：2008-09-30T11:51:37.270
> 
> 标签：ruby, browser

在 Python 中，您可以这样做：

```
import webbrowser
webbrowser.open_new("http://example.com/") 
```

它将在默认浏览器中打开传入的 url

有红宝石等价物吗？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2008-09-30T13:22:02.780

## 跨平台解决方案：

首先，安装[Launchy](http://www.copiousfreetime.org/projects/launchy/) gem：

```
$ gem install launchy 
```

然后，你可以运行这个：

```
require 'launchy'

Launchy.open("http://stackoverflow.com") 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-12-27T11:10:10.197

这应该适用于大多数平台：

```
link = "Insert desired link location here"
if RbConfig::CONFIG['host_os'] =~ /mswin|mingw|cygwin/
  system "start #{link}"
elsif RbConfig::CONFIG['host_os'] =~ /darwin/
  system "open #{link}"
elsif RbConfig::CONFIG['host_os'] =~ /linux|bsd/
  system "xdg-open #{link}"
end 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2008-09-30T13:08:58.443

仅限 Mac 的解决方案：

```
system("open", "http://stackoverflow.com/") 
```

或者

```
`open http://stackoverflow.com/` 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-30T21:24:25.413

最简单的获胜解决方案：

```
`开始 http://www.example.com`
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-10-03T04:53:57.747

仅限 Linux 的解决方案

```
system("xdg-open", "http://stackoverflow.com/") 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-30T15:29:26.733

这也有效：

```
system("start #{link}") 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-30T12:10:22.267

仅限 Windows 解决方案：

```
require 'win32ole'
shell = WIN32OLE.new('Shell.Application')
shell.ShellExecute(...) 
```

[MSDN 上的 Shell 执行](http://msdn.microsoft.com/en-us/library/bb774148.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-11-14T11:29:20.127

您可以使用“os”gem：[https](https://github.com/rdp/os) ://github.com/rdp/os让您的操作系统（最好是您拥有自己的操作系统，而不是 OS X）决定如何处理 URL。

通常这将是一个不错的选择。

```
require 'os'

system(OS.open_file_command, 'https://stackoverflow.com')
# ~ like `xdg-open stackoverflow.com` on most modern unixoids,
# but should work on most other operating systems, too. 
```

**注意**在 Windows 上，`system`需要转义的参数，请参阅评论部分。Rubys stdlib 中应该有一个函数，请随时将其添加到评论中，我会更新答案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T12:16:34.090

如果是 Windows 并且是 IE，试试这个：[http](http://rubyonwindows.blogspot.com/search/label/watir) ://rubyonwindows.blogspot.com/search/label/watir还可以查看 Selenium ruby​​：[http ://selenium.rubyforge.org/getting-started.html](http://selenium.rubyforge.org/getting-started.html)

高温高压

# linux - 如何在文件中搜索多行模式？

> ID：152708
> 
> 赞同：146
> 
> 时间：2008-09-30T11:54:17.657
> 
> 标签：linux, command-line, grep, find, pcregrep

我需要找到所有包含特定字符串模式的文件。想到的第一个解决方案是使用带有*xargs grep的**find*管道：

 *```
find . -iname '*.py' | xargs grep -e 'YOUR_PATTERN' 
```

但是，如果我需要找到跨越多行的模式，我会被卡住，因为 vanilla grep 无法找到多行模式。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2010-09-15T13:26:46.553

你为什么不去[awk](http://www.gnu.org/software/gawk/manual/gawk.html)：

```
awk '/Start pattern/,/End pattern/' filename 
```

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2008-09-30T11:54:44.207

所以我发现了[***pcregrep***](http://www.pcre.org/)，它代表**Perl Compatible Regular Expressions GREP**。

> -M 选项可以搜索跨越行边界的模式。

例如，您需要查找“ *_name* ”变量在下一行后面跟着“ *_description* ”变量的文件：

```
find . -iname '*.py' | xargs pcregrep -M '_name.*\n.*_description' 
```

提示：您需要在模式中包含换行符。根据您的平台，它可能是 '\n'、\r'、'\r\n'、...

* * *

## 回答 #3

> 赞同：105
> 
> 时间：2008-09-30T12:07:43.270

这是使用[GNU`grep`](https://www.gnu.org/software/grep/)的示例：

```
grep -Pzo '_name.*\n.*_description' 
```

> `-z`/`--null-data`将输入视为一组行，每行都以零字节（ASCII NUL 字符）而不是换行符结尾。

这具有将整个文件视为一大行的效果。请参阅[此处的说明](https://stackoverflow.com/questions/3717772/regex-grep-for-multi-line-search-needed/7167115#7167115)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2012-07-26T18:47:20.663

`grep -P`也使用 libpcre，但安装范围*更广*。要查找`title`html 文档的完整部分，即使它跨越多行，您也可以使用以下命令：

```
grep -P '(?s)<title>.*</title>' example.html 
```

由于[PCRE 项目](http://www.pcre.org/)实现了 perl 标准，请使用 perl 文档作为参考：

*   [http://perldoc.perl.org/perlre.html#Modifiers](http://perldoc.perl.org/perlre.html#Modifiers)
*   [http://perldoc.perl.org/perlre.html#Extended-Patterns](http://perldoc.perl.org/perlre.html#Extended-Patterns)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2008-09-30T12:36:49.457

这是一个更有用的例子：

```
pcregrep -Mi "<title>(.*\n){0,5}</title>" afile.html 
```

它会在 html 文件中搜索标题标签，即使它跨越多达 5 行。

这是无限行的示例：

```
pcregrep -Mi "(?s)<title>.*</title>" example.html 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-01-13T21:05:33.803

与[银搜索器](https://github.com/ggreer/the_silver_searcher)：

```
ag 'abc.*(\n|.)*efg' 
```

Silver Searcher 的速度优化可能会在这里大放异彩。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-02-22T22:50:03.237

您可以在此处使用 grep 替代[筛选](http://sift-tool.org)（免责声明：我是作者）。

它支持多行匹配并将搜索限制为开箱即用的特定文件类型：

```
筛选 -m --files '*.py' 'YOUR_PATTERN'
```

（在所有 *.py 文件中搜索指定的多行正则表达式模式）

它适用于所有主要操作系统。查看[示例页面](http://sift-tool.org/samples.html)，了解如何使用它从 XML 文件中提取多行值。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-08-24T03:19:57.020

这个答案可能有用：

[需要用于多行搜索的正则表达式（grep）](https://stackoverflow.com/questions/3717772/regex-grep-for-multi-line-search-needed/7167115#7167115)

要递归查找，您可以使用标志 -R（递归）和 --include（GLOB 模式）。看：

[使用 grep --exclude/--include 语法不通过某些文件 grep](https://stackoverflow.com/questions/221921/grep-exclude-include-syntax-do-not-grep-through-certain-files/221929#221929)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-07-23T13:53:13.940

@Marcin：非贪婪的 awk 示例：

```
awk '{if ($0 ~ /Start pattern/) {triggered=1;}if (triggered) {print; if ($0 ~ /End pattern/) { exit;}}}' filename 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-04-04T00:51:19.387

```
perl -ne 'print if (/begin pattern/../end pattern/)' filename 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-10-16T23:11:30.097

使用`ex`/`vi`编辑器和[globstar 选项](http://wiki.bash-hackers.org/internals/shell_options#globstar)（语法类似于`awk`and `sed`）：

```
ex +"/string1/,/string3/p" -R -scq! file.txt 
```

哪里`aaa`是你的起点，`bbb`是你的结束文本。

要递归搜索，请尝试：

```
ex +"/aaa/,/bbb/p" -scq! **/*.py 
```

^(注意：要启用`**`语法，请运行`shopt -s globstar`（Bash 4 或 zsh）。)

# css - 我会因为复制网站的样式表而陷入法律纠纷吗？

> ID：152712
> 
> 赞同：19
> 
> 时间：2008-09-30T11:55:14.377
> 
> 标签：css, wordpress

我喜欢一些 Microsoft 博客的简单外观和设计。唉，我不能加入 Microsoft 开发团队并在 blogs.msdn.com 页面上创建自己的开发博客，因为我不在 Microsoft 工作，而且我已经拥有自己的 wordpress 博客。

我希望将我的博客设置为此处显示的默认主题之一：http: [//blogs.msdn.com/jmeier/default.aspx](http://blogs.msdn.com/jmeier/default.aspx)

如果我使用他们页面中的样式表，Microsoft 可以对我采取法律行动吗？如果我让我的页面“基于”他们的样式表，例如从头开始编写，那会侵犯版权吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-09-30T12:00:36.347

> 如果我使用他们页面中的样式表，Microsoft 可以对我采取法律行动吗？

当然，因为你侵犯了他们的版权。另一方面，样式表本身是否构成了足够的原创性阈值来证明法律行动的正当性是有争议的¹。至少，不问就拿走通常被认为是粗鲁的。;-)

* * *

^(1))不。当然*不会*。然而，一个复杂的设计会。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-30T12:07:42.397

是的，您可能会因为复制网站的样式表而陷入法律纠纷，因为这通常是侵犯版权的行为。更糟糕的是，您可能会在诸如[youthoughtwewouldntnotice.com 之](http://youthoughtwewouldntnotice.com/)类的博客上遭到公开抨击，从而使此类关于您的博客文章以您的名字在 Google 搜索结果中排名靠前，从而不可逆转地损害您的声誉。

不要这样做，不值得冒险。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-30T12:35:42.877

你可以。你可能不会。

最重要的是：为什么要打扰？CSS 非常简单，它本质上是在周围放置一堆盒子，并为它们着色..

只需查看他们的 CSS 文件和布局，然后自己重​​新实现它。它可能最终会比修改他们的 CSS 以与您的网站一起使用更容易（除非您*完全*复制他们的网站，包括 CSS、HTML 和布局图像），另外当你这样做的时候，你会学到很多关于 CSS 的知识。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T12:00:20.697

AFAIK 和 IANAL，以及所有其他有用的首字母缩略词......

根据英国法律，我相信只要复制的文章和复制的文章之间至少有 6 个可证明和明显的差异，你就可以逃脱惩罚。由于我不是律师，因此我不打算讨论什么构成了可证明和明显的差异，但我想颜色变化会算作一个......

在接受此建议之前，您显然必须检查您所在地区的法律。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-10-05T00:23:33.987

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T11:59:13.477

我认为微软使用社区服务器开箱即用的模板之一。但即使他们没有，我也没有听说过有人基于利用别人的 css 而停止和停止的案例。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T12:00:48.933

从技术上讲，他们可以。这是对他们版权的侵犯。然而，如果他们行使这项权利，那很可能是一场公关灾难。

如果你使用它，我认为你可能是安全的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T12:05:59.513

这将是一个可怕的想法，但如果你只是链接到他们的 css，你就不会遇到任何麻烦。

您还可以链接到他们的 css 副本，该副本位于与您的网站无关的其他地方；o)

只是一些想法...

# java - Hamcrest 的多个正确结果（是否有或匹配器？）

> ID：152714
> 
> 赞同：79
> 
> 时间：2008-09-30T11:55:22.067
> 
> 标签：java, junit, hamcrest, matcher

我对匹配器比较陌生。我正在与 JUnit 结合使用[hamcrest](http://code.google.com/p/hamcrest/)，我有点喜欢它。

有没有办法声明多个选择中的一个是正确的？

就像是

```
assertThat( result, is( either( 1, or( 2, or( 3 ) ) ) ) ) //does not work in hamcrest 
```

我正在测试的方法返回集合的一个元素。该列表可能包含多个候选者。我当前的实现返回第一个命中，但这不是必需的。如果返回任何可能的候选人，我希望我的测试用例成功。你会如何用 Java 来表达这一点？

（我对 hamcrest-alternatives 持开放态度）

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2008-09-30T14:13:19.070

```
assertThat(result, anyOf(equalTo(1), equalTo(2), equalTo(3))) 
```

来自[Hamcrest 教程](http://hamcrest.org/JavaHamcrest/tutorial#logical)：

> `anyOf`- 如果任何匹配器匹配，则匹配，短路（如 Java ||）

另请参阅[Javadoc](http://hamcrest.org/JavaHamcrest/javadoc/2.2/org/hamcrest/core/AnyOf.html)。

此外，您可以编写自己的 Matcher，这很容易做到。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2011-07-02T02:20:48.147

marcos 是对的，但您还有其他几个选择。首先，有*一个*非此即彼的：

```
assertThat(result, either(is(1)).or(is(2))); 
```

但如果你有两个以上的项目，它可能会变得笨拙。另外，类型检查器有时会在这样的事情上变得奇怪。对于您的情况，您可以这样做：

```
assertThat(result, isOneOf(1, 2, 3)) 
```

或者如果您已经在数组/集合中有选项：

```
assertThat(result, isIn(theCollection)) 
```

另请参阅[Javadoc](http://hamcrest.org/JavaHamcrest/javadoc/1.3/org/hamcrest/Matchers.html)。

# reference - 有哪些在线资源可以了解 VxWorks？

> ID：152723
> 
> 赞同：2
> 
> 时间：2008-09-30T11:57:52.107
> 
> 标签：reference, vxworks

您发现哪些在线资源对了解 VxWorks 很有帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T12:02:01.957

[Tornado II/VxWorks FAQ](http://www.xs4all.nl/~borkhuis/vxworks/vxworks.html)是一个很好的基本信息来源，与 5.x 版本的 VxWorks 相关。

[VxWorks Cookbook](http://www.bluedonkey.org/cgi-bin/twiki/bin/view/Books/VxWorksCookBook)也有一些好东西

[VxWorks Usenet Group](http://groups.google.com/group/comp.os.vxworks)很高兴看到那些难倒人们的东西

[VxWorks 教程链接的集合](http://www.quickembeddedtips.com/vxworks-tutorials-links-howtos)（不是所有的都是实时的）

此[Google 搜索](http://www.google.com/search?q=vxworks+manual)提供了一些指向参考手册在线版本的链接。

# c# - GDI+ / C#：如何将图像保存为 EMF？

> ID：152729
> 
> 赞同：18
> 
> 时间：2008-09-30T11:59:49.140
> 
> 标签：c#, gdi+, .emf

如果您使用 Image.Save 方法将图像保存到 EMF/WMF，则会出现异常 ( [http://msdn.microsoft.com/en-us/library/ktx83wah.aspx](http://msdn.microsoft.com/en-us/library/ktx83wah.aspx) )

是否有另一种方法可以将图像保存到 EMF/WMF？有没有可用的编码器？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-10T21:51:52.327

`Image`是一个抽象类：你想要做什么取决于你是在处理 a`Metafile`还是 a `Bitmap`。

使用 GDI+ 创建图像并将其保存为 EMF 很简单，使用`Metafile`. 根据迈克的[帖子](https://stackoverflow.com/questions/152729/gdi-c-how-to-save-an-image-as-emf/152830#152830)：

```
var path = @"c:\foo.emf"
var g = CreateGraphics(); // get a graphics object from your form, or wherever
var img = new Metafile(path, g.GetHdc()); // file is created here
var ig = Graphics.FromImage(img);
// call drawing methods on ig, causing writes to the file
ig.Dispose(); img.Dispose(); g.ReleaseHdc(); g.Dispose(); 
```

这是您大部分时间想要做的事情，因为这就是 EMF 的用途：以 GDI+ 绘图命令的形式保存矢量图像。

您可以`Bitmap`使用上述方法并调用将 a 保存到 EMF 文件`ig.DrawImage(your_bitmap)`，但请注意，这不会神奇地将您的栅格数据转换为矢量图像。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-09T09:17:30.543

如果我没记错的话，它可以通过 Metafile.GetHenhmetafile()、API GetEnhMetaFileBits() 和 Stream.Write() 的组合来完成，类似于

```
[DllImport("gdi32")] static extern uint GetEnhMetaFileBits(IntPtr hemf, uint cbBuffer, byte[] lpbBuffer);

IntPtr h = metafile.GetHenhMetafile();
int size = GetEnhMetaFileBits(h, 0, null);
byte[] data = new byte[size];
GetEnhMetaFileBits(h, size, data);
using (FileStream w = File.Create("out.emf")) {
    w.Write(data, 0, size);
}
// TODO: I don't remember whether the handle needs to be closed, but I guess not. 
```

我认为这就是我遇到问题时解决问题的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-27T04:47:31.103

问题是：“还有其他方法可以将图像保存到 EMF/WMF 吗？” 不是“什么是图元文件”或“如何创建图元文件”或“如何将图元文件与图形一起使用”。

我也在寻找这个问题的答案“如何保存 EMF/WMF”事实上，如果你使用：

```
 Graphics grfx = CreateGraphics();
  MemoryStream ms = new MemoryStream();
  IntPtr ipHdc = grfx.GetHdc();

  Metafile mf = new Metafile(ms, ipHdc);

  grfx.ReleaseHdc(ipHdc);
  grfx.Dispose();
  grfx = Graphics.FromImage(mf);

  grfx.FillEllipse(Brushes.Gray, 0, 0, 100, 100);
  grfx.DrawEllipse(Pens.Black, 0, 0, 100, 100);
  grfx.DrawArc(new Pen(Color.Red, 10), 20, 20, 60, 60, 30, 120);
  grfx.Dispose();

  mf.Save(@"C:\file.emf", ImageFormat.Emf);
  mf.Save(@"C:\file.png", ImageFormat.Png); 
```

在这两种情况下，图像都保存为 png 格式。这是我无法解决的问题：/

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-30T12:31:40.577

元文件是记录一系列 GDI 操作的文件。它是可缩放的，因为捕获了生成图片的原始操作序列，因此可以缩放记录的坐标。

我认为，在 .NET 中，您应该创建一个`Metafile`对象，`Graphics`使用. 创建一个对象`Graphics.FromImage`，然后执行您的绘图步骤。当您在文件上绘图时，该文件会自动更新。[您可以在Graphics.AddMetafileComment](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.addmetafilecomment.aspx)的文档中找到一个小示例。

如果您真的想在元文件中存储位图，请使用这些步骤然后使用`Graphics.DrawImage`来绘制位图。但是，当它被缩放时，它将使用`StretchBlt`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-21T21:14:36.353

The answer by erikkallen is correct. I tried this from VB.NET, and had to use 2 different DllImports to get it to work:

```
<System.Runtime.InteropServices.DllImportAttribute("gdi32.dll", EntryPoint:="GetEnhMetaFileBits")> _
    Public Shared Function GetEnhMetaFileBits(<System.Runtime.InteropServices.InAttribute()> ByVal hEMF As System.IntPtr, ByVal nSize As UInteger, ByVal lpData As IntPtr) As UInteger
End Function

    <System.Runtime.InteropServices.DllImportAttribute("gdi32.dll", EntryPoint:="GetEnhMetaFileBits")> _
    Public Shared Function GetEnhMetaFileBits(<System.Runtime.InteropServices.InAttribute()> ByVal hEMF As System.IntPtr, ByVal nSize As UInteger, ByVal lpData() As Byte) As UInteger
End Function 
```

The first import is used for the first call to get the emf size. The second import to get the actual bits. Alternatively you could use:

```
Dim h As IntPtr = mf.GetHenhmetafile()
CopyEnhMetaFileW(h, FileName) 
```

This copies the emf bits directly to the named file.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-09T03:31:56.123

您还需要关闭`CopyEnhMetaFile`处理程序：

```
IntPtr ptr2 = CopyEnhMetaFile(iptrMetafileHandle, "image.emf");
DeleteEnhMetaFile(ptr2);

// Delete the metafile from memory
DeleteEnhMetaFile(iptrMetafileHandle); 
```

否则，您无法删除该文件，因为该进程仍在使用它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-17T15:17:25.507

我建议在托管的 .NET 应用程序中避免使用此类外部和非托管垃圾。相反，我会推荐一些更像这个线程中给出的托管解决方案的东西：

[使用 .NET 将图像转换为 WMF？](https://stackoverflow.com/questions/5270763/convert-an-image-into-wmf-with-net)

PS我正在回答这个旧线程，因为这是我找到的最佳答案，但最终开发了一个托管解决方案，然后将我带到上面的链接。所以，为了节省其他人的时间，我想我会把这个指向那个。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-03-03T11:31:32.630

我正在寻找一种将 Metafile 对象中的 GDI 指令保存到 EMF 文件的方法。韩的帖子帮我解决了这个问题。这是在我加入 SOF 之前。谢谢你，韩。这是[我尝试过](http://www.gnostice.com/nl_article.asp?id=188&t=How_To_Convert_PDF_to_EMF_In_NET)的。

```
    [DllImport("gdi32.dll")]
    static extern IntPtr CopyEnhMetaFile( // 复制 EMF 到文件
        IntPtr hemfSrc, // EMF 句柄
        字符串 lpszFile // 文件
    );

    [DllImport("gdi32.dll")]
    static extern int DeleteEnhMetaFile( // 删除 EMF
        IntPtr hemf // EMF 句柄
    );

   // 创建元文件的代码
   // 元文件元文件 = ...

   // 获取元文件的句柄
   IntPtr iptrMetafileHandle = metafile.GetHenhmetafile();

   // 将元文件导出为图像文件
   CopyEnhMetaFile(
         iptr元文件句柄，
          “图像.emf”）；

   // 从内存中删除元文件
   DeleteEnhMetaFile(iptrMetafileHandle);

```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-04-01T14:00:14.397

看起来矢量与位图有很多混淆。此线程中的所有代码都生成位图（非矢量）文件 - 它不保留矢量 GDI 调用。为了证明这一点，请下载“EMF Parser”工具并检查输出文件： http: [//downloads.z​​dnet.com/abstract.aspx?docid=749645](http://downloads.zdnet.com/abstract.aspx?docid=749645)。

这个问题引起了很多开发者考虑的苦恼。如果微软能解决这个问题并正确支持他们自己的 EMF 格式，那当然会很好。

# erlang - 是否应该将客户端处理过程添加到主管树中？

> ID：152744
> 
> 赞同：4
> 
> 时间：2008-09-30T12:05:15.617
> 
> 标签：erlang, erlang-supervisor

在 Erlang 中，我有一个进程主管树，其中包含一个接受 tcp/ip 连接的进程。对于每个传入的连接，我都会产生一个新进程。是否应该将此进程添加到主管树中？

问候，史蒂夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-07T13:25:40.727

是的，您应该将这些进程添加到监督层次结构中，因为您希望它们在应用程序停止时正确/优雅地关闭。（否则，您最终会泄漏连接，这些连接将因为它们所依赖的应用程序基础设施被关闭而失败）。

您可以创建一个`simple_one_for_one`策略主管，说它`yourapp_client_sup`的子规范为`{Id, {yourapp_client_connection, start_link_with_socket, []}, Restart, Shutdown, worker, temporary}`. 这里的`temporary`类型很重要，因为连接处理程序通常没有有用的重启策略——你不能连接到客户端来重启连接。`temporary`这里将导致主管报告连接处理程序退出，否则忽略它。

然后执行的进程`gen_tcp:accept`将通过执行`supervisor:start_child(yourapp_client_sup, [Socket,Options,...])`而不是创建连接处理程序进程`yourapp_client_sup:start_link(Socket, Options, ...)`。确保该`youreapp_client_connection:start_link_with_socket`函数通过`gen_server`or`proc_lib`函数（`supervisor`模块的要求）启动子进程，并且该函数将套接字的控制权转移给子进程，`gen_tcp:controlling_process`否则子进程将无法使用套接字。

An alternate approach is to create a dummy `yourapp_client_sup` process that `yourclient_connection_handler` processes can link to at startup. The `yourapp_client_sup` process will just exist to propagate `EXIT` messages from its parent to the connection handler processes. It will need to trap exists and ignore all `EXIT` messages other than those from its parent. On the whole, I prefer to use the `simple_one_for_one` supervisor approach.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T18:59:38.787

如果您希望这些流程很多，那么在您的主要主管下添加一个主管以分离职责可能是一个好主意（并且可能使用该`simple_one_for_one`设置使事情变得更简单，甚至可能比您当前的情况更简单）。

问题是，如果您需要控制这些流程，最好有一个主管。如果他们成功与否无关紧要，那么您可能不需要一个。但话又说回来，我总是认为那是草率的编码。;-)

我唯一*不会*做的就是将它们添加到您现有的树中，除非它们的来源非常明显并且它们很少。

# c++ - 优化 C++ 二维数组

> ID：152745
> 
> 赞同：7
> 
> 时间：2008-09-30T12:05:36.427
> 
> 标签：c++, linux, optimization, gcc, stl

我需要一种方法来表示 C++ 中双精度数的二维数组（密集矩阵），并且访问开销绝对最小。

我在各种 linux/unix 机器和 gcc 版本上做了一些计时。向量的 STL 向量，声明为：

```
vector<vector<double> > matrix(n,vector<double>(n)); 
```

并且通过`matrix[i][j]`访问比声明为的数组慢 5% 到 100% 访问：

```
double *matrix = new double[n*n]; 
```

通过内联索引函数访问`matrix[index(i,j)]`，`index(i,j)`计算结果为 i+n*j。在没有 STL 的情况下安排二维数组的其他方法——一个指向每行开头的 n 个指针的数组，或者将堆栈上的整个事物定义为一个常数大小`matrix[n][n]`——以与索引函数方法几乎完全相同的速度运行。

最近的 GCC 版本 (> 4.0) 似乎能够在打开优化时将 STL 向量的向量编译到与非 STL 代码几乎相同的效率，但这在某种程度上取决于机器。

如果可能，我想使用 STL，但必须选择最快的解决方案。有没有人有使用 GCC 优化 STL 的经验？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-30T12:08:52.440

对于矩阵，我的猜测是最快的，使用 1D STL 数组并覆盖 () 运算符以将其用作 2D 矩阵。

但是，STL 还专门为不可调整大小的数值数组定义了一种类型：valarray。您还可以对就地操作进行各种优化。

valarray 接受数值类型作为参数：

```
valarray<double> a; 
```

然后，您可以使用切片、间接数组...当然，您可以继承 valarray 并为二维数组定义自己的 operator()(int i, int j) ...

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-30T12:19:53.053

如果您使用 GCC，编译器可以分析您的矩阵访问并在某些情况下更改内存中的顺序。魔术编译器标志定义为：

```
-fipa-matrix-reorg 
```

> 执行矩阵展平和转置。矩阵展平尝试将 m 维矩阵替换为其等效的 n 维矩阵，其中 n < m。这降低了访问矩阵元素所需的间接级别。第二个优化是矩阵转置，它试图改变矩阵维度的顺序以提高缓存局部性。两种优化都需要 fhole-program 标志。仅当分析信息可用时才启用转置。

请注意，-O2 或 -O3 不会启用此选项。你必须自己通过。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-30T12:17:09.520

很可能这是一个参考位置问题。`vector`用于`new`分配其内部数组，因此由于每个块的标题，每一行在内存中至少会分开一点；如果分配时内存已经碎片化，则可能相距很远。数组的不同行可能至少会导致缓存行错误并且可能会导致页面错误；如果你真的很不幸，两个相邻的行可能在共享一个 TLB 插槽的内存线上，访问一个会驱逐另一个。

相比之下，您的其他解决方案保证所有数据都是相邻的。如果您对齐结构以使其越过尽可能少的缓存行，它可以帮助您提高性能。

`vector`专为*可调整大小*的数组而设计。如果您不需要调整数组大小，请使用常规 C++ 数组。STL 操作通常可以对 C++ 数组进行操作。

一定要沿着正确的方向走阵列，即穿过（连续的内存地址）而不是向下。这将减少缓存故障。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-30T12:08:57.980

我的建议是使用 Boost.UBLAS，它提供了快速的矩阵/向量类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T12:44:47.783

公平地说，取决于您在矩阵上使用的算法。

当您按行访问数据时，双重名称 [n*m] 格式非常快，因为除了乘法和加法之外几乎没有开销，而且因为您的行是在缓存中保持一致的打包数据。

如果您的算法访问按列排序的数据，那么其他布局可能具有更好的缓存一致性。如果您的算法访问矩阵象限中的数据，那么其他布局可能会更好。

尝试针对您正在使用的使用类型和算法进行一些研究。如果矩阵非常大，这一点尤其重要，因为缓存未命中可能会损害您的性能，而不是需要 1 或 2 次额外的数学运算来访问每个地址。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T17:37:05.943

你可以很容易地做 vector< double >( n*m );

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-08T22:44:06.737

您可能想查看[http://eigen.tuxfamily.org/](http://eigen.tuxfamily.org/)上的 Eigen C++ 模板库。它生成 AltiVec 或 sse2 代码以优化向量/矩阵计算。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T18:51:05.063

Boost中有uBLAS实现。值得一看。

[http://www.boost.org/doc/libs/1_36_0/libs/numeric/ublas/doc/matrix.htm](http://www.boost.org/doc/libs/1_36_0/libs/numeric/ublas/doc/matrix.htm)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-10T22:41:34.783

另一个相关的库是 Blitz++：[http ://www.oonumerics.org/blitz/docs/blitz.html](http://www.oonumerics.org/blitz/docs/blitz.html)

Blitz++ 旨在优化数组操作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-12T04:26:55.833

通过声明我自己的二维数组类，我已经为原始图像做了这个。

在普通的二维数组中，您可以访问以下元素：

数组[2][3]。现在要获得这种效果，您将拥有一个带有重载 [] 数组访问器的类数组。但是，这实际上会返回另一个数组，从而为您提供第二维。

这种方法的问题在于它具有双重函数调用开销。

我这样做的方式是使用 () 样式重载。

所以不是array[2][3]，而是改变我让它做这种风格的array(2,3)。

那个 () 函数非常小，我确保它是内联的。

有关一般概念，请参阅此链接：http: [//www.learncpp.com/cpp-tutorial/99-overloading-the-parenthesis-operator/](http://www.learncpp.com/cpp-tutorial/99-overloading-the-parenthesis-operator/)

如果需要，您可以对类型进行模板化。
我的不同之处在于我的数组是动态的。我有一块我要声明的 char 内存。而且我使用了列缓存，所以我知道下一行在我的字节序列中从哪里开始。Access 已针对访问相邻值进行了优化，因为我将其用于图像处理。

没有代码很难解释，但本质上结果和 C 一样快，而且更容易理解和使用。

# java - java对象序列化在1.5和1.6之间是否兼容

> ID：152757
> 
> 赞同：20
> 
> 时间：2008-09-30T12:07:54.003
> 
> 标签：java, serialization

我想知道混合 jdk 1.5 和 1.6（Java 6）对象序列化（双向通信）是否安全。我搜索了 sun 关于这个问题的明确声明，但没有成功。因此，除了技术可行性之外，我还在寻找有关该问题的“官方”声明。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-09-30T12:23:16.523

序列化机制本身并没有改变。对于个别班级，这将取决于具体班级。如果一个类有一个 serialVersionUID 字段，这应该表示序列化兼容性。

就像是：

```
private static final long serialVersionUID = 8683452581122892189L; 
```

如果未更改，则序列化版本是兼容的。对于 JDK 类，这是有保证的，但当然，在进行重大更改后总是可能忘记更新 serialVersionUID。

当 JDK 类不能保证兼容时，Javadoc 中通常会提到这一点。

> 警告：此类的序列化对象将与未来的 Swing 版本不兼容

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T13:05:45.610

1.5 和 1.6 中的序列化机制是兼容的。因此，在 1.5 和 1.6 上下文中编译/运行的相同代码可以交换序列化对象。两个 VM 实例是否具有相同/兼容的类版本（可能由 serialVersionUID 字段指示）是与 JDK 版本无关的不同问题。

如果您有一个可序列化的 Foo.java 并在 1.5 和 1.6 JDK/VM 中使用它，则 Foo 的序列化实例由一个 V 创建；可以被另一个反序列化。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T12:22:34.327

在使用 Java 1.5 程序中的 ObjectOutputStream 对写入文件的序列化对象进行测试之后，然后在 Java 1.6 程序中使用 ObjectInputStream 运行读取，我可以说这没有任何问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T12:27:43.083

我会很快补充一点，可以更改类但*忘记*更改serialVersionUID。所以“如果类定义了一个serialVersionUID，并且这没有改变，那么保证类是兼容的”是不正确的。相反，拥有相同的 serialVersionUID 是 API 承诺向后兼容性的方式。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-30T12:31:13.120

除非另有说明，否则这应该是二进制兼容性的一部分。Swing 类在版本之间明确不兼容。如果您发现其他类有问题，请在[bugs.sun.com](http://bugs.sun.com/)上报告错误。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-30T12:49:43.013

你读过[Java 对象序列化规范](http://java.sun.com/javase/6/docs/platform/serialization/spec/serialTOC.html)吗？有一个关于[版本控制](http://java.sun.com/javase/6/docs/platform/serialization/spec/version.html)的话题。还有一篇面向类实现者的文章：[发现 Java 序列化 API 的秘密](http://java.sun.com/developer/technicalArticles/Programming/serialization/)。每个 Java 版本都附有[兼容性说明](http://java.sun.com/javase/6/webnotes/compatibility.html)。

来自 Java 6 的序列化规范：

* * *

目标是：

*   通过以下方式支持在不同虚拟机中运行的类的不同版本之间的双向通信：
    *   定义一种机制，允许 JavaTM 类读取由同一类的旧版本编写的流。
    *   定义一种机制，允许 JavaTM 类编写旨在由同一类的旧版本读取的流。
*   为持久性和 RMI 提供默认序列化。
*   在简单的情况下执行良好并产生紧凑的流，以便 RMI 可以使用序列化。
*   能够识别和加载与用于写入流的确切类匹配的类。
*   保持非版本化类的开销较低。
*   使用允许遍历流的流格式，而不必调用特定于保存在流中的对象的方法。

* * *

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T23:06:47.680

请注意，Java Beans 规范详细说明了一种与版本无关的序列化方法，该方法允许强大的向后兼容性。它还导致可读的“序列化”表单。事实上，使用该机制可以很容易地创建序列化对象。

查找`XMLEncoder`和`XMLDecoder`类的文档。

我不一定会使用它来通过网络传递对象（尽管如果需要高性能，我也不会使用序列化），但它对于持久对象存储是非常宝贵的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-11T13:27:25.173

混合使用 Java 1.5 和 1.6 是不安全的。例如，我将一个 Java 1.5 对象序列化为一个文件，并尝试在 Java 1.6 中打开它，但它出现了以下错误。

```
java.io.InvalidClassException: javax.swing.JComponent; local class incompatible: stream classdesc serialVersionUID = 7917968344860800289, local class serialVersionUID = -1030230214076481435
    at java.io.ObjectStreamClass.initNonProxy(Unknown Source)
    at java.io.ObjectInputStream.readNonProxyDesc(Unknown Source)
    at java.io.ObjectInputStream.readClassDesc(Unknown Source)
    at java.io.ObjectInputStream.readNonProxyDesc(Unknown Source)
    at java.io.ObjectInputStream.readClassDesc(Unknown Source)
    at java.io.ObjectInputStream.readNonProxyDesc(Unknown Source)
    at java.io.ObjectInputStream.readClassDesc(Unknown Source)
    at java.io.ObjectInputStream.readOrdinaryObject(Unknown Source)
    at java.io.ObjectInputStream.readObject0(Unknown Source)
    at java.io.ObjectInputStream.readArray(Unknown Source)
    at java.io.ObjectInputStream.readObject0(Unknown Source)
    at java.io.ObjectInputStream.defaultReadFields(Unknown Source)
    at java.io.ObjectInputStream.readSerialData(Unknown Source)
    at java.io.ObjectInputStream.readOrdinaryObject(Unknown Source)
    at java.io.ObjectInputStream.readObject0(Unknown Source)
    at java.io.ObjectInputStream.defaultReadFields(Unknown Source)
    at java.io.ObjectInputStream.readSerialData(Unknown Source)
    at java.io.ObjectInputStream.readOrdinaryObject(Unknown Source)
    at java.io.ObjectInputStream.readObject0(Unknown Source)
    at java.io.ObjectInputStream.readArray(Unknown Source)
    at java.io.ObjectInputStream.readObject0(Unknown Source)
    at java.io.ObjectInputStream.defaultReadFields(Unknown Source)
    at java.io.ObjectInputStream.readSerialData(Unknown Source)
    at java.io.ObjectInputStream.readOrdinaryObject(Unknown Source)
    at java.io.ObjectInputStream.readObject0(Unknown Source)
    at java.io.ObjectInputStream.readObject(Unknown Source) 
```

# windows - 对话框|主/子/mdi 窗口之间有哪些区别？

> ID：152766
> 
> 赞同：0
> 
> 时间：2008-09-30T12:10:37.397
> 
> 标签：windows, winapi

我需要了解windows main/mdi/child/dialogs之间的区别......应该如何传播win32消息......为什么有些消息以一种类型而不是其他类型出现......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T12:18:39.127

MSDN 网站上提供[了](http://msdn.microsoft.com/en-us/library/ms632586%28VS.85%29.aspx)参考信息。如果您想要更多的介绍或教程，那么 Charles Petzold 的《[Programming Windows](http://www.charlespetzold.com/pw5/) 》一书非常棒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T12:26:39.013

**主窗口** 应用程序的顶部窗口。它被标记为进程主窗口，并且可以通过调用具有适当权限的进程轻松访问此信息。

**MDI（多文档界面）窗口** 这通常位于应用程序主窗口中，它包含一组 MDI 子窗口。这主要是一个与 Win32 API 集成的窗口类。我相信操作系统不会像任何其他窗口类一样对待它。这些正在消失，有利于多个 SDI 窗口（Word 2007）。

**Child** 这是任何其他窗口的子窗口。它的位置、可见性和大部分内容都取决于父窗口。孩子们向他们的父母发送**通知。**通知是一种特定类型的窗口消息。

**Dialog** Dialogs 提供了基于 95% 的对话框所需的简单子创建和输入处理。API 中的对话框函数允许您使用 PE 文件 (.exe) 中的已编译模板创建窗口及其子项。消息处理也略有不同，因为您主要处理来自孩子的通知。

与对话框的主要区别在于您使用的是模态对话框。创建调用将阻塞，直到用户关闭对话框。在某些情况下，这会使 UI 更新变得有些棘手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T12:17:32.950

我不是 Windows 开发人员，但这是我所理解的：

主窗口 - 您可以在任务栏中激活/查看的顶级容器。

对话框 - 小框锁定（如果模式）您的窗口，在任务栏中看不到。主要用于向用户显示消息。

mdi (Multiple Document Interface) - 不直接是一个窗口，而是一个用于存储子窗口的简单容器。每个子窗口都可以在此容器内最大化/最小化/关闭，但您不会在任务栏中找到任何这些。 [http://en.wikipedia.org/wiki/Multiple_document_interface](http://en.wikipedia.org/wiki/Multiple_document_interface)

# sql-server - 在 SQL Server 2000 中将一组行转换为列

> ID：152770
> 
> 赞同：8
> 
> 时间：2008-09-30T12:12:31.497
> 
> 标签：sql-server, pivot

在 SQL Server 中是否有任何将行转换为列的工具（在 MS-Access 中可以）？我很困惑，因为这个工具在 MS-Access 中可用，但在 SQL Server 中不可用。SQL Server 中没有包含此功能是设计使然吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T13:13:23.923

[http://jdixon.dotnetdevelopersjournal.com/pivot_table_data_in_sql_server_2000_and_2005.htm](http://jdixon.dotnetdevelopersjournal.com/pivot_table_data_in_sql_server_2000_and_2005.htm)上的示例仅在您事先知道行值可以是什么时才有效。例如，假设您有一个具有自定义属性的实体，并且自定义属性被实现为子表中的行，其中子表基本上是变量/值对，并且这些变量/值对是可配置的。

```
color red
size  big
city  Chicago 
```

我将描述一种有效的技术。我用过。我不是在宣传它，但它确实有效。

要在您事先不知道值是什么的情况下对数据进行透视，请动态创建一个没有列的临时表。然后使用游标遍历您的行，为每个变量发布一个动态构建的“更改表”，以便最终您的临时表具有列、颜色、大小、城市。

然后在临时表中插入一行，通过另一个游标通过变量、值对更新它，然后选择它，通常与其父实体连接，实际上使这些自定义变量/值对看起来像是内置的-在原始父实体的列中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-04T00:19:01.940

所描述的游标方法可能是最不像 SQL 那样使用的方法。如前所述，SQL 2005 及更高版本的 PIVOT 效果很好。但对于旧版本和非 MS SQL 服务器，来自“优化 Transact-SQL”的 Rozenshtein 方法（编辑：绝版，但可用。来自亚马逊：[http ://www.amazon.com/Optimizing-Transact-SQL- Advanced-Programming-Techniques/dp/0964981203](https://rads.stackoverflow.com/amzn/click/com/0964981203) )，非常适合旋转和取消旋转数据。它使用点特征将基于行的数据转换为列。Rozenshtein 描述了几种情况，这里有一个例子：

```
SELECT
    RowValueNowAColumn = 
       CONVERT(varchar,
           MAX(
          SUBSTRING(myTable.MyVarCharColumn,1,DATALENGTH(myTable.MyVarCharColumn)
       * CHARINDEX(sa.SearchAttributeName,'MyRowValue'))))
FROM
    myTable 
```

这种方法比使用 case 语句更有效，并且适用于各种数据类型和 SQL 实现（不仅仅是 MS SQL）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-26T02:00:17.237

这种事情最好限制在小范围内。如果您使用的是 SQL 2k 并且没有可用的 PIVOT 功能，我已经起草了一个应该为您完成这项工作的存储过程。有点拙劣的匆忙工作，所以尽可能多地拆开它。将以下内容粘贴到 sql 窗口中，并根据需要编辑底部的 EXEC。如果您想查看正在生成的内容，请删除中间的 --s：

```
IF EXISTS (SELECT * FROM SYSOBJECTS WHERE XTYPE = 'P' AND NAME = 'USP_LIST_CONCAT')
DROP PROCEDURE USP_LIST_CONCAT
GO

CREATE PROCEDURE USP_LIST_CONCAT (@SourceTable NVARCHAR(1000) = '' ,@SplitColumn NVARCHAR(1000) = '' , @Deli NVARCHAR(10) = '', @KeyColumns NVARCHAR(2000) = '' , @Condition NVARCHAR(1000) = '')
AS
BEGIN
SET NOCOUNT ON

/* PROCEDURE CREATED 2010 FOR SQL SERVER 2000\. SIMON HUGHES. */
/* NOTES: REMOVE --'s BELOW TO LIST GENERATED SQL. */

IF @SourceTable = '' OR @SourceTable = '?' OR @SourceTable = '/?' OR @SplitColumn = '' OR @KeyColumns = ''
BEGIN
PRINT 'Format for use:'
PRINT ' USP_LIST_CONCAT ''SourceTable'', ''SplitColumn'', ''Deli'', ''KeyColumn1,...'', ''Column1 = 12345 AND ...'''
PRINT ''
PRINT 'Description:'
PRINT 'The SourceTable should contain a number of records acting as a list of values.'
PRINT 'The SplitColumn should be the name of the column holding the values wanted.'
PRINT 'The Delimiter may be any single character or string ie ''/'''
PRINT 'The KeyColumn may contain a comma separated list of columns that will be returned before the concatenated list.'
PRINT 'The optional Conditions may be left blank or may include the following as examples:'
PRINT ' ''Column1 = 12334 AND (Column2 = ''ABC'' OR Column3 = ''DEF'')'''
PRINT ''
PRINT 'A standard list in the format:'
PRINT ' Store1, Employee1, Rabbits'
PRINT ' Store1, Employee1, Dogs'
PRINT ' Store1, Employee1, Cats'
PRINT ' Store1, Employee2, Dogs'
PRINT ''
PRINT 'Will be returned as:'
PRINT ' Store1, Employee1, Cats/Dogs/Rabbits'
PRINT ' Store1, Employee2, Dogs'
PRINT ''
PRINT 'A full ORDER BY and DISTINCT is included'
RETURN -1
END

DECLARE @SQLStatement NVARCHAR(4000)

SELECT @SQLStatement = '
DECLARE @DynamicSQLStatement NVARCHAR(4000)

SELECT @DynamicSQLStatement = ''SELECT '+@KeyColumns+', SUBSTRING(''

SELECT @DynamicSQLStatement = @DynamicSQLStatement + '' + '' + CHAR(10) +
'' MAX(CASE WHEN '+@SplitColumn+' = ''''''+RTRIM('+@SplitColumn+')+'''''' THEN '''''+@Deli+'''+RTRIM('+@SplitColumn+')+'''''' ELSE '''''''' END)''
FROM '+ @SourceTable +' ORDER BY '+@SplitColumn+'

SELECT @DynamicSQLStatement = @DynamicSQLStatement + '' ,2,7999) List'' + CHAR(10) + ''FROM '+ @SourceTable+''' + CHAR(10) +'''+CASE WHEN @Condition = '' THEN '/* WHERE */' ELSE 'WHERE '+@Condition END+ '''+ CHAR(10) + ''GROUP BY '+@KeyColumns+'''

SELECT @DynamicSQLStatement = REPLACE(@DynamicSQLStatement,''( +'',''('')

-- SELECT @DynamicSQLStatement -- DEBUG ONLY
EXEC (@DynamicSQLStatement)'

EXEC (@SQLStatement)

END
GO

EXEC USP_LIST_CONCAT 'MyTableName', 'ColumnForListing', 'Delimiter', 'KeyCol1, KeyCol2', 'Column1 = 123456' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T06:35:57.700

对于 sql server 2005 中的 UNPIVOT，我找到了一篇不错的文章

[sql-server 中的列到行](http://www.logiclabz.com/sql-server/transpose-columns-to-rows-in-sql-server-2005-using-unpivot.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-24T02:52:05.293

我有以下格式的数据

**调查_问题_ID**

**电子邮件（用户**）

**回答**

对于 1 项调查，有 13 个问题和答案我想要的期望输出是

**用户**--- **Survey_question_ID1** --- **Survey_question_ID2**

**电子邮件**---**回答**---**回答** ........**以此类推**

这是**SQL Server 2000**的解决方案，原因字段数据类型为**TEXT**。

```
DROP TABLE #tmp

DECLARE @tmpTable  TABLE
(
emailno NUMERIC,
question1 VARCHAR(80),
question2 VARCHAR(80),
question3 VARCHAR(80),
question4 VARCHAR(80),
question5 VARCHAR(80),
question6 VARCHAR(80),
question7 VARCHAR(80),
question8 VARCHAR(80),
question9 VARCHAR(80),
question10 VARCHAR(80),
question11 VARCHAR(80),
question12 VARCHAR(80),
question13 VARCHAR(8000)
)

DECLARE @tmpTable2  TABLE
(
emailNumber NUMERIC
)

DECLARE @counter INT
DECLARE @Email INT

SELECT @counter =COUNT(DISTINCT ans.email) FROM answers ans WHERE ans.surveyname=100430 AND ans.qnpkey BETWEEN 233702 AND 233714
SELECT * INTO #tmp FROM @tmpTable
INSERT INTO @tmpTable2 (emailNumber) SELECT DISTINCT CAST(ans.email AS NUMERIC) FROM answers ans WHERE ans.surveyname=100430 AND ans.qnpkey BETWEEN 233702 AND 233714

WHILE @counter >0

BEGIN

        SELECT TOP 1 @Email= emailNumber FROM @tmpTable2
        INSERT INTO @tmpTable (emailno) VALUES (@Email )

        Update @tmpTable set question1=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233702 and ans.email=@Email
        Update @tmpTable set question2=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233703 and email=@email
        Update @tmpTable set question3=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233704 and email=@email
        Update @tmpTable set question4=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233705 and email=@email
        Update @tmpTable set question5=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233706 and email=@email
        Update @tmpTable set question6=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233707 and email=@email
        Update @tmpTable set question7=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233708 and email=@email
        Update @tmpTable set question8=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233709 and email=@email
        Update @tmpTable set question9=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233710 and email=@email
        Update @tmpTable set question10=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233711 and email=@email
        Update @tmpTable set question11=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233712 and email=@email
        Update @tmpTable set question12=CAST(answer as VARCHAR(80)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233713 and email=@email
        Update @tmpTable set question13=CAST(answer as VARCHAR(8000)) from answers ans where ans.surveyname=100430 and ans.qnpkey = 233714 and email=@email

        insert into #tmp select * from  @tmpTable       

        DELETE FROM @tmpTable       
        DELETE FROM @tmpTable2 WHERE emailNumber= @Email

        set @counter =@counter -1

End

select * from #tmp 
```

# c# - 有没有更好的方法将 DateTime 修剪到特定的精度？

> ID：152774
> 
> 赞同：61
> 
> 时间：2008-09-30T12:16:12.970
> 
> 标签：c#, .net, datetime

将 DateTime 对象修剪到特定精度的最佳方法是什么？例如，如果我有一个值为“2008-09-29 09:41:43”的 DateTime，但我只希望它精确到分钟，还有比这更好的方法吗？

```
private static DateTime TrimDateToMinute(DateTime date)
{
    return new DateTime(
        date.Year, 
        date.Month, 
        date.Day, 
        date.Hour, 
        date.Minute, 
        0);
} 
```

我真正想要的是使其可变，以便我可以将其精度设置为秒、分钟、小时或天。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-09-30T13:26:37.917

```
static class Program
{
    //using extension method:
    static DateTime Trim(this DateTime date, long roundTicks)
    {
        return new DateTime(date.Ticks - date.Ticks % roundTicks, date.Kind);
    }

    //sample usage:
    static void Main(string[] args)
    {
        Console.WriteLine(DateTime.Now);
        Console.WriteLine(DateTime.Now.Trim(TimeSpan.TicksPerDay));
        Console.WriteLine(DateTime.Now.Trim(TimeSpan.TicksPerHour));
        Console.WriteLine(DateTime.Now.Trim(TimeSpan.TicksPerMillisecond));
        Console.WriteLine(DateTime.Now.Trim(TimeSpan.TicksPerMinute));
        Console.WriteLine(DateTime.Now.Trim(TimeSpan.TicksPerSecond));
        Console.ReadLine();
    }

} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-09-30T12:25:25.163

你可以使用枚举

```
public enum DateTimePrecision
{
  Hour, Minute, Second
}

public static DateTime TrimDate(DateTime date, DateTimePrecision precision)
{
  switch (precision)
  {
    case DateTimePrecision.Hour:
      return new DateTime(date.Year, date.Month, date.Day, date.Hour, 0, 0);
    case DateTimePrecision.Minute:
      return new DateTime(date.Year, date.Month, date.Day, date.Hour, date.Minute, 0);
    case DateTimePrecision.Second:
      return new DateTime(date.Year, date.Month, date.Day, date.Hour, date.Minute, date.Second);
    default:
      break;
  }
} 
```

并根据需要扩展。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-01T20:17:44.527

我喜欢这种方法。有人提到保留日期类型等很好。这样做是因为您不必创建新的日期时间。DateTime 是从原始 DateTime 正确克隆的，它只是减去剩余的刻度。

```
public static DateTime FloorTime(DateTime dt, TimeSpan interval) 
{
  return dt.AddTicks(-1 * (dt.Ticks % interval.Ticks));
} 
```

用法：

```
dt = FloorTime(dt, TimeSpan.FromMinutes(5)); // floor to the nearest 5min interval
dt = FloorTime(dt, TimeSpan.FromSeconds(1)); // floor to the nearest second
dt = FloorTime(dt, TimeSpan.FromDays(1));    // floor to the nearest day 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-07T18:30:12.133

这里提供了一些很好的解决方案，但是当我需要这样做时，我只是这样做：

```
DateTime truncDate;
truncDate = date.Date; // trim to day
truncDate = date.Date + TimeSpan.Parse(string.Format("{0:HH:00:00}", date)); // trim to hour
truncDate = date.Date + TimeSpan.Parse(string.Format("{0:HH:mm}", date)); // trim to minute
truncDate = date.Date + TimeSpan.Parse(string.Format("{0:HH:mm:ss}", date)); // trim to second 
```

希望能帮助到你。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-30T13:07:47.963

```
 static DateTime TrimDate(DateTime date, long roundTicks)
    {
        return new DateTime(date.Ticks - date.Ticks % roundTicks);
    }

    //sample usage:
    static void Main(string[] args)
    {
        Console.WriteLine(DateTime.Now);
        Console.WriteLine(TrimDate(DateTime.Now, TimeSpan.TicksPerDay));
        Console.WriteLine(TrimDate(DateTime.Now, TimeSpan.TicksPerHour));
        Console.WriteLine(TrimDate(DateTime.Now, TimeSpan.TicksPerMillisecond));
        Console.WriteLine(TrimDate(DateTime.Now, TimeSpan.TicksPerMinute));
        Console.WriteLine(TrimDate(DateTime.Now, TimeSpan.TicksPerSecond));
        Console.ReadLine();
    } 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-06-01T10:49:28.027

```
DateTime dt = new DateTime()
dt = dt.AddSeconds(-dt.Second) 
```

上面的代码将修剪秒。

# c - 这个 _popen / select 示例有什么问题？

> ID：152807
> 
> 赞同：3
> 
> 时间：2008-09-30T12:26:31.867
> 
> 标签：c, select, popen

**更新：**我更新了代码和问题描述以反映我的更改。

我现在知道我正在非套接字上尝试套接字操作。或者我的 fd_set 无效，因为：

`select`返回 -1 并 `WSAGetLastError()`返回 10038。

但我似乎无法弄清楚它是什么。平台是 Windows。我还没有发布该`WSAStartup`部分。

```
int loop = 0;
FILE *output

int main()
{
    fd_set fd;
    output = _popen("tail -f test.txt","r");

    while(forceExit == 0)
    {   
        FD_ZERO(&fd);
        FD_SET(_fileno(output),&fd);

        int returncode = select(_fileno(output)+1,&fd,NULL,NULL,NULL);
        if(returncode == 0)
        {
            printf("timed out");
        }
        else if (returncode < 0)
        {
            printf("returncode: %d\n",returncode);
            printf("Last Error: %d\n",WSAGetLastError());
        }
        else
        {
            if(FD_ISSET(_fileno(output),&fd))
            {
                if(fgets(buff, sizeof(buff), output) != NULL )
                {               
                    printf("Output: %s\n", buff);
                }
            }
            else
            {
                printf(".");
            }
        }
        Sleep(500);
    }
    return 0;
} 
```

现在的新结果当然是打印出返回码和最后一个错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T13:01:49.270

您有一些数据可供读取，但实际上您并没有读取任何内容。下次轮询描述符时，数据仍然存在。在继续轮询之前排空管道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T15:32:23.373

据我所知，Windows 匿名管道不能与 select 等非阻塞调用一起使用。因此，虽然您的 _popen 和 select 代码独立看起来不错，但您不能将两者结合在一起。

[这是其他地方的类似线程。](http://www.perlmonks.org/?node_id=621058)

使用 PIPE_NOWAIT 标志调用[SetNamedPipeHandleState](http://msdn.microsoft.com/en-us/library/aa365787.aspx)可能对您有用，但 MSDN 在这个主题上有点神秘。

所以，我认为你需要寻找其他方法来实现这一目标。我建议在单独的线程中读取，并使用正常的阻塞 I/O。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-02T00:47:26.883

首先，正如您自己和其他人所指出的，`select()`仅对 Windows 下的套接字有效。`select()`不适用于`_popen()`返回的流。错误 10038 清楚地表明了这一点。

我不明白你的例子的目的是什么。如果您只是想生成一个进程并收集它的标准输出，只需执行此操作（直接来自 MSDN _popen 页面）：

```
int main( void )
{

   char   psBuffer[128];
   FILE   *pPipe;

   if( (pPipe = _popen("tail -f test.txt", "rt" )) == NULL )
      exit( 1 );

   /* Read pipe until end of file, or an error occurs. */

   while(fgets(psBuffer, 128, pPipe))
   {
      printf(psBuffer);
   }

   /* Close pipe and print return value of pPipe. */
   if (feof( pPipe))
   {
     printf( "\nProcess returned %d\n", _pclose( pPipe ) );
   }
   else
   {
     printf( "Error: Failed to read the pipe to the end.\n");
   }
} 
```

而已。无需选择。

而且我不确定线程​​将如何帮助您，这只会使您的问题复杂化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T14:46:00.963

因为`select`不起作用，我使用了线程，特别[`_beginthread`是`_beginthreadex`](http://msdn.microsoft.com/en-us/library/kdzttdcb(VS.80).aspx).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T12:32:08.017

select 的第一个参数必须是三个集合中任何一个中编号最高的文件描述符，加上 1：

```
 int select(int nfds, fd_set *readfds, fd_set *writefds,
              fd_set *exceptfds, struct timeval *timeout); 
```

还：

```
 if(FD_ISSET(filePointer,&exceptfds))
    {
            printf("i have data\n");
    } 
```

应该：

```
 if(FD_ISSET(filePointer,&fd))
    {
            printf("i have data\n");
    } 
```

您应该检查 select() 的返回码。

您还需要在每次调用 select() 时重置 fdset。

您不需要超时，因为您没有使用它。

编辑：

显然在 Windows 上，nfds 被忽略了，但可能应该正确设置，这样代码就更便携了。

如果要使用超时，则需要将其作为最后一个参数传递给 select 调用：

```
// Reset fd, exceptfds, and timeout before each select()...
int result = select(maxFDPlusOne, &fd, NULL, &exceptfds, &timeout);

if (result == 0)
{
    // timeout
}
else if (result < 0)
{
    // error
}
else
{
    // something happened
    if (FD_ISSET(filePointer,&fd))
    {
        // Need to read the data, otherwise you'll get notified each time.
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T12:44:00.767

我注意到的第一件事是错误的，您在每个条件下都在 exceptfds 上调用 FD_ISSET。我认为你想要这样的东西：

```
if (FD_ISSET(filePointer,&fd))
{
    printf("i have data\n");
}
else .... 
```

select 中的 except 字段通常用于报告套接字上的错误或带外数据。当设置了您的异常的描述符之一时，它并不一定意味着错误，而是一些“消息”（即带外数据）。我怀疑对于您的应用程序，您可能无需将文件描述符放在异常集中即可。如果你真的想检查错误，你需要检查 select 的返回值，如果它返回 -1（或 Windows 上的 SOCKET_ERROR）则做一些事情。我不确定你的平台，所以我不能更具体地了解返回码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T13:31:12.743

1.  `select()`第一个参数是你的集合中最大的文件描述符，加1。（即输出+1）

    选择（输出+1，&fd，NULL，&exceptfds，NULL）；

2.  第一个`FD_ISSET(...)`应该在`fd_set`fd上。

    如果（FD_ISSET（文件指针，&fd））

3.  您的数据流有数据，那么您需要读取该数据流。使用 fgets(...) 或类似方法从数据源读取。

    字符缓冲区[1024]；... fgets(buf, sizeof(buf) * sizeof(char), 输出);

# vb.net - 将数据从 DataReader 获取到 Farpoint 电子表格的最佳方法？

> ID：152814
> 
> 赞同：0
> 
> 时间：2008-09-30T12:27:57.387
> 
> 标签：vb.net, farpoint-spread

我需要将数据从数据读取器移动到 Windows 窗体中的[Farpoint 电子表格](http://www.fpoint.com/products/spread/spread.aspx)组件中。fps 工作表的 DataSource[不能设置为 datareader](http://www.clubfarpoint.com/Forums/forums/thread/68432.aspx)。我不想为了这个目的而改变我的应用程序来使用 ADO。

现在我正在遍历查询数据并将其逐个单元格地推送到工作表中。这很难看，而且我确信大型数据集的性能会受到影响（尽管我还没有尝试过）。

这里有人知道将数据读取器放入其中一个组件的更好方法吗？我正在使用 VB.NET，但一个 C# 示例就可以了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T12:32:22.307

我不熟悉该产品，但您可以尝试将阅读器加载到 DataTable 并绑定它（如果支持）。

```
Dim dt as Datatable
dt.load(reader) 
```

# cookies - 当我调用 Request.ServerVariables("remote_host") 时出现“类不支持自动化”错误

> ID：152817
> 
> 赞同：0
> 
> 时间：2008-09-30T12:28:17.637
> 
> 标签：cookies, asp-classic, vbscript, remote-host

我正在为一个电子商务网站编写一个基本 cookie，该网站将存储用户的 IP 以及其他详细信息。

然后，我们将他们在数据库中查看的页面记录下来，并拉出最近查看的页面列表。

但是我对以下代码有疑问。

```
dim caller
caller = Response.Cookies("caller")
if caller = "" then 
    caller = Request.ServerVariables("remote_host")
end if 
```

在运行此程序时，我收到以下错误消息。

“Sun ONE ASP VBScript 运行时 (0x800A01AE) 类不支持自动化”

有任何想法吗？谷歌没有什么明显的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T12:35:30.473

检查值时应该是 Request.Cookies。：

```
dim caller
caller = Request.Cookies("caller")
if caller = "" then 
    caller = Request.ServerVariables("remote_host")
end if 
```

# .net - 如何声明返回节点集的用户定义函数？

> ID：152822
> 
> 赞同：4
> 
> 时间：2008-09-30T12:29:57.430
> 
> 标签：.net, xslt, msxml

我想要这样的东西：

```
<msxsl:script language="C#">
   ??? getNodes() { ... return ... }
</msxsl:script>

<xsl:for-each select="user:getNodes()">
    ...
</xsl:for-each> 
```

我应该使用什么返回类型，我`getNodes()`应该在它的主体中放入什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-05T18:16:51.413

原则上，您需要使用 XPathNodeIterator 返回节点集（如 Samjudson 所说）。我认为您给出的示例是一个退化的函数，因为您没有为它提供任何参数。但是，我认为看看如何凭空制造节点是*有启发性的。*

```
<msxsl:script language="C#">
   XPathNodeIterator getNodes() 
   { 
      XmlDocument doc = new XmlDocument();
      doc.PreserveWhitespace = true;
      doc.LoadXml("<root><fld>val</fld><fld>val2</fld></root>");
      return doc.CreateNavigator().Select("/root/fld");
   }
</msxsl:script> 
```

但是，通常您会希望在您的函数中做一些在 xslt 中不可能的事情，例如根据某些标准过滤节点集。通过代码更好地实现或依赖于某些外部数据结构的标准。另一种选择是简化冗长的表达式（如下例所示）。然后你会将一些参数传递给你的 getNodes 函数。为简单起见，我使用基于 XPath 的过滤，但它可以是任何东西：

```
 <msxsl:script language="C#">
       XPathNodeIterator getNodes(XPathNodeIterator NodesToFilter, string Criteria)
      {
         XPathNodeIterator x = NodesToFilter.Current.Select("SOMEVERYCOMPLEXPATH["+Criteria+"]");
         return x;
      }
   </msxsl:script>
   <xsl:for-each select="user:getNodes(values/val,'SomeCriteria')">
    ...
  </xsl:for-each> 
```

希望这会有所帮助，波阿斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T14:02:24.540

C# xslt msxml 的快速 google 显示了指向以下页面的链接，该链接提供了许多在 microsoft 环境中扩展 XSLT 的示例。

[http://msdn.microsoft.com/en-us/magazine/cc302079.aspx](http://msdn.microsoft.com/en-us/magazine/cc302079.aspx)

特别是 XSLT 和 .Net 之间的映射类型部分为您提供了所需的信息：

W3C XPath 类型 - 等效的 .NET 类（类型）

*   字符串 - System.String
*   布尔值 - System.Boolean
*   数字 - System.Double
*   结果树片段 - System.Xml.XPath.XPathNavigator
*   节点集 - System.Xml.XPath.XPathNodeIterator

所以在你的例子中，我会尝试 XPathNodeLiterator。

# php - htaccess 文件、php、包括目录和 windows XAMPP 配置噩梦

> ID：152823
> 
> 赞同：2
> 
> 时间：2008-09-30T12:29:57.897
> 
> 标签：php, apache, .htaccess, xampp, config

XAMPP 使为 Windows 配置本地 LAMP 堆栈变得轻而易举。因此，启用 htaccess 文件是一场噩梦，这非常令人失望。

我的问题：
我有一个 PHP 应用程序，它需要 apache/php 来搜索应用程序中包含的 /includes/ 目录。为此，apache 中必须允许 htaccess 文件，并且 htaccess 文件必须准确指定包含目录的位置。

问题是，我无法让我的 apache 配置查看这些 htaccess 文件。我在 uni 安装这个应用程序并让管理员在那里帮助设置时遇到了很大的麻烦。这不应该那么难，但由于某种原因，我无法让 apache 玩得很好。

这是我的设置：

c:\xampp
c:\xampp\htdocs
c:\xampp\apache\conf\httpd.conf - 我在其中进行了下面列出的更改
c:\xampp\apache\bin\php.ini - 对此文件的更改影响 php 安装
有趣的是，c:\xampp\php\php.ini 更改没有任何意义——这不是影响 php 安装的 ini。

以下几行是我在 httpd.conf 文件中添加的内容

```
#AccessFileName .htaccess
AccessFileName htaccess.txt
#
# The following lines prevent .htaccess and .htpasswd 
# files from being viewed by Web clients. 
#
#<Files ~ "^\.ht">
<Files ~ "^htaccess\.">
    Order allow,deny
    Deny from all
</Files>

<Directory "c:/xampp/htdocs">
#
# AllowOverride controls what directives may be placed in 
# .htaccess files.
# It can be "All", "None", or any combination of the keywords:
#   Options FileInfo AuthConfig Limit
#
    AllowOverride All
#
# Controls who can get stuff from this server.
#
    Order allow,deny
    Allow from all
</Directory> 
```

以下是整个htaccess文件包含在：c:\xampp\htdocs\application\htaccess.txt

```
<Files ~ "\.inc$">
  Order deny,allow
  Deny from all
</Files>

php_value default_charset "UTF-8"
php_value include_path ".;c:\xampp\htdocs\application\includes"
php_value register_globals 0
php_value magic_quotes_gpc 0
php_value magic_quotes_runtime 0
php_value magic_quotes_sybase 0
php_value session.use_cookies 1
php_value session.use_only_cookies 0
php_value session.use_trans_sid 1
php_value session.gc_maxlifetime 3600
php_value arg_separator.output "&amp;"
php_value url_rewriter.tags "a=href,area=href,frame=src,input=src,fieldset=" 
```

包含目录存在于指定的位置。

当我尝试访问应用程序时，我收到以下错误：

```
Warning: require(include.general.inc) [function.require]: failed to open stream: No such file or directory in C:\xampp\htdocs\application\menu\logon.php on line 21 
```

致命错误：require() [function.require]：在 C:\xampp\htdocs\application\ 中打开所需的 'include.general.inc' (include_path='.;C:\xampp\php\pear\random') 失败第 21 行的 menu\logon.php

包含路径 c..\random\ 在上面列出的 php.ini 文件中指定。xampp 安装无法允许在 htaccess.txt 文件中指定的另一个包含路径。

请帮忙！我猜 httpd.conf 或 htaccess.txt 文件可能有错误。但它似乎没有读取 htaccess 文件。我试图尽可能彻底，所以请原谅这篇文章的冗长。

现在我知道一种解决方法可能是简单地将 include_path 添加到 php 文件中，但我将无法访问我计划部署我的应用程序位置上的 php.ini 文件。但是，我将能够请求服务器管理员允许 htaccess 文件。

更新：将 htacces.txt 重命名为 .htaccess 并修改了 httpd.conf 文件中的相应指令，一切似乎都有效。该应用程序建议命名 htaccess.txt 和 httpd 中的修正指令。这些显然是错误的（至少对于 xampp 堆栈而言）。谢谢您的帮助。

顺便说一句，如果需要将应用程序部署到多个位置，使用 ini_set() 是一种更友好的方式，因此特别感谢该指针。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-30T12:39:32.757

1.  为什么需要将 .htaccess 重命名为 htaccess.txt
2.  尝试使用[set_include_path()](http://php.net/set_include_path())设置 include_path并查看是否有帮助（作为中间修复）
3.  通过[phpinfo()验证要使用的 php.ini](http://php.net/phpinfo)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T12:37:27.503

您可以使用 ini_set() 更改每个请求的 include_path。这将完全避免使用 htaccess。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T13:00:10.697

我的 htaccess 在 XAMPP 下工作正常 - 尽管默认情况下禁用了某些模块 - 你确定你想要的模块已启用吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T13:44:20.167

我认为您正在寻找的 searchprase 是：

[允许覆盖所有](http://www.google.com/search?site=&hl=en&q=allowoverride+all)

我的猜测是，在 xampp 中，您需要在 httpd.conf 中启用 AllowOverride（通过 .htaccess）。这是一种简单的安全措施，可以防止新手安装可破解的平台：P

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T20:39:35.083

您需要在主 http.conf 文件中启用 AllowOverride All。查看 XAMPP_DIR/apache/conf/http.conf 内部）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-09-09T18:46:47.230

只需这样做：

```
open file ...\xampp\apache\conf\httpd.conf

find line "LoadModule rewrite_module modules/mod_rewrite.so"

if here is a # before this line remove it.(remove comment) 
```

它的工作

# vb.net - 如何分析点数组的“噪音”

> ID：152829
> 
> 赞同：2
> 
> 时间：2008-09-30T12:31:37.003
> 
> 标签：vb.net, analysis, fft, noise

已经完成 fft（如果您有兴趣，请参阅之前的帖子！）并得到了结果，这对我有帮助。想分析一个数组的噪音/尖刺（实际上是一个 vb.nre 的集合）。嗯，怎么解释...

当信号良好时，fft 功率结果是 512 个数据点（频率桶），所有数据点（频率桶）的值都很低，但可能有 2 或 3 个数组条目，并且范围不错（即峰值很高，相对于几乎空桶中的噪声值） . 因此，当绘制图表时，我们在这几个桶中的值中有一个很好的大峰值。

当信号很差/嘈杂时，数据值的分布（最大值到最小值）很低，并且在更多的桶中存在成比例的更高噪声。

分析这个数据集的噪声有什么好处，计算量不大？某种统计方法、标准偏差或其他方法会有所帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T12:45:04.850

关键是定义什么是噪声和什么是信号，必须对其进行建模假设。通常假设是由白噪声（每个频带的恒定功率）或某些其他功率谱的噪声做出的，并且该模型适合数据。然后可以使用信噪比来测量噪声量。

拟合噪声模型取决于数据的性质：如果您知道真实信号在高频分量中没有功率，您可以在那里寻找噪声水平的指示，并使用模型来预测噪声将处于同时存在信号和噪声的较低频率分量。或者，如果您的信号在时间上是恒定的，则在不同时间点进行多个 FFT 并比较它们以获得每个频带的标准偏差可以给出存在的噪声水平。

我希望我不会光顾您在执行 FFT 时提及窗口函数固有的问题：这些问题可能会在频谱中引入虚假“噪声”，这实际上是 FFT 周期性特性的产物。在获得尖峰和“边带”噪声之间需要权衡取舍——更多信息[请参见 www.ee.iitm.ac.in/~nitin/_media/ee462/fftwindows.pdf](http://www.ee.iitm.ac.in/~nitin/_media/ee462/fftwindows.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T13:25:55.640

计算标准偏差，然后确定指示噪声的阈值。在实践中，这通常很容易，并且允许您根据需要轻松调整“噪声级别”。

Knuth 中有一个很好的单通道 stddev 算法。这是描述实现的链接。

[标准差](http://www.johndcook.com/standard_deviation.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T12:37:56.270

计算信噪比 [http://en.wikipedia.org/wiki/Signal-to-noise_ratio](http://en.wikipedia.org/wiki/Signal-to-noise_ratio)

您还可以检查每个点的标准差，如果它低于您选择的某个级别，那么信号是好的，否则不是。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T13:54:17.693

> 尖峰不会被视为 SNR 中的噪声故障，是要丢弃的异常值吗？

如果从时域数据中可以清楚地看出存在这样的尖峰，那么它们肯定会在频谱中产生大量噪声。选择忽略它们是个好主意，但不幸的是，FFT 不能接受其中尖峰已被移除的带有“洞”的数据。有两种技术可以解决这个问题。“肮脏的技巧”方法是将异常样本设置为任一站点上两个样本的平均值，并使用完整的数据集计算 FFT。

更难但更正确的方法是使用 Lomb 归一化周期图（参见 WHPress 等人的“数字食谱”一书），它与 FFT 的工作类似，但可以正确处理丢失的数据。

# asp.net - SQL Server 的默认端口

> ID：152834
> 
> 赞同：63
> 
> 时间：2008-09-30T12:32:40.463
> 
> 标签：asp.net, sql, sql-server

我需要知道以下服务的默认端口设置

1.  SQL 服务器
2.  SQL 浏览器
3.  SQL 报告服务
4.  SQL 分析服务

我需要知道不同版本 SQL Server (2000,2005,2008) 的这些服务的端口设置

另外让我知道默认端口设置是否会根据 sql server 版本而改变

提前致谢。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2008-09-30T12:47:37.527

1.  默认 SQL Server 端口是 1433，但前提是它是默认安装。命名实例获得一个随机端口号。

2.  浏览器服务在 UDP 1434 端口上运行。

3.  Reporting Services 是一种 Web 服务，因此它是端口 80，如果启用了 SSL，则为 443。

4.  分析服务是 2382，但前提是它是默认安装。命名实例获得一个随机端口号。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-02-17T23:08:15.617

如果您有权访问服务器，则可以使用

```
select local_tcp_port from sys.dm_exec_connections where local_tcp_port is not null 
```

有关完整详细信息，请参阅[SQL Server 的端口号](https://stackoverflow.com/questions/1281150/port-number-of-sql-server/5035779#5035779)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-30T12:52:16.097

默认的未命名实例始终获取 TCP 端口 1433。SQL Browser 服务使用 UDP 端口 1434 来定位命名实例。在 SQL Server 2000 中，要启动的第一个实例承担了这个角色。

默认情况下，非默认实例有自己的动态分配端口。如有必要，例如配置防火墙，您可以明确设置它们。如果您不想启用或允许访问 SQL Browser，则必须在连接字符串中包含实例的端口号，或者使用`cliconfg`每台客户端计算机上的（SQL Server 客户端网络实用程序）中的别名选项卡进行设置。

有关详细信息，请参阅MSDN 上的[SQL Server Browser 服务](http://msdn.microsoft.com/en-us/library/ms181087(SQL.90).aspx)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-30T12:34:19.760

1433

默认端口尚未更改

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-03-26T17:06:53.357

SQL Server 默认端口是**1434**。

为了允许远程访问，我必须在我的防火墙上释放这些端口：

```
Protocol  |   Port
---------------------
UDP       |   1050
TCP       |   1050
TCP       |   1433
UDP       |   1434 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-08-05T12:13:34.100

您可以使用 SQL 配置管理器设置单个 IP 地址以使用或不使用动态端口（值 0 = 是，使用动态端口），并设置用于每个 IP 的 TCP 端口。

但要小心：我建议首先映射您的实例、IP 和端口，并在开始随意进行更改之前进行规划，以确保没有实例或 IP 相互影响。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-17T16:42:05.677

我们可以看看三种不同的方式来识别 SQL Server 实例使用的端口。

1.  读取 SQL Server 错误日志
2.  使用 SQL Server 配置管理器
3.  使用 Windows 应用程序事件查看器

    使用大师
    GO

    xp_readerrorlog 0, 1, N'Server 正在监听', 'any', NULL, NULL, N'asc'
    GO

> 使用 SQL Server 配置管理器识别 SQL Server 数据库引擎使用的端口
> 
> 1.  单击开始 -> 程序 -> Microsoft SQL Server 2008 -> 配置工具 -> SQL Server 配置管理器
>     
>     
> 2.  在 SQL Server 配置管理器中，展开 SQL Server 网络配置，然后在左侧面板上选择协议。要识别 SQL Server 实例使用的 TCP/IP 端口，请右键单击 TCP/IP，然后从下拉列表中选择属性，如下所示。

如需更多帮助
[http://sqlnetcode.blogspot.com/2011/11/sql-server-identify-tcp-ip-port-being.html](http://sqlnetcode.blogspot.com/2011/11/sql-server-identify-tcp-ip-port-being.html)

# sql - 如何插入包含“&”的字符串

> ID：152837
> 
> 赞同：45
> 
> 时间：2008-09-30T12:34:18.120
> 
> 标签：sql, oracle, escaping, sqlplus

如何编写包含 & 字符的插入语句？例如，如果我想在数据库的列中插入“J&J Construction”。

我不确定它是否有所作为，但我使用的是 Oracle 9i。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2009-01-04T05:07:20.790

我一直忘记这一点，然后又回来了！我认为最好的答案是迄今为止提供的答案的组合。

首先，& 是 sqlplus/sqldeveloper 中的变量前缀，因此存在问题 - 当它出现时，它应该是变量名的一部分。

SET DEFINE OFF 将停止 sqlplus 以这种方式解释 &。

但是如果您需要使用 sqlplus 变量*和*文字 & 字符怎么办？

*   您需要 SET DEFINE ON 才能使变量起作用
*   并设置 ESCAPE ON 以逃避 & 的使用。

例如

```
set define on
set escape on

define myvar=/forth

select 'back\\ \& &myvar' as swing from dual; 
```

产生：

```
old   1: select 'back\\ \& &myvar' from dual
new   1: select 'back\ & /forth' from dual

SWING
--------------
back\ & /forth 
```

如果要使用不同的转义字符：

```
set define on
set escape '#'

define myvar=/forth

select 'back\ #& &myvar' as swing from dual; 
```

当您设置特定的转义字符时，您可能会看到“SP2-0272：转义字符不能是字母数字或空格”。这可能意味着您已经定义了转义字符，并且事情变得非常自我引用。避免这个问题的干净方法是首先设置逃生：

```
set escape off
set escape '#' 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-30T12:37:30.187

如果你是从 SQLPLUS 做的，请使用

```
SET DEFINE OFF 
```

阻止它作为特例

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-04-12T15:48:08.480

另一种解决方案，使用连接和 chr 函数：

```
select 'J' || chr(38) || 'J Construction' from dual; 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-09-30T13:15:44.993

正确的语法是

```
set def off;
insert into tablename values( 'J&J'); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-04T07:32:39.933

总是有 chr() 函数，它将 ascii 代码转换为字符串。

IE。类似于： INSERT INTO table VALUES ( CONCAT( 'J', CHR(38), 'J' ) )

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-01-22T13:16:00.290

```
INSERT INTO TEST_TABLE VALUES('Jonhy''s Sport &'||' Fitness') 
```

此查询的输出：**Jonhy's Sport & Fitness**

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-30T12:40:30.213

SET SCAN OFF 已过时 [http://download-uk.oracle.com/docs/cd/B10501_01/server.920/a90842/apc.htm](http://download-uk.oracle.com/docs/cd/B10501_01/server.920/a90842/apc.htm)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-30T12:45:13.647

在程序中，始终使用参数化查询。它避免了 SQL 注入攻击以及 SQL 解析器特有的任何其他字符。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-04-06T06:50:23.603

您可以插入这样的字符串**'J'||'&'||'Construction'**。它工作正常。

```
insert into table_name (col_name) values('J'||'&'||'Construction'); 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-30T12:39:18.357

我发现使用以下任一选项都有效：

`SET DEF OFF`

或者

`SET SCAN OFF`

我对数据库知之甚少，无法知道一个比另一个更好还是“更正确”。另外，如果有比这两个更好的东西，请告诉我。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-30T12:36:53.903

如果您使用的是 sql plus 那么我认为您需要发出命令

```
SET SCAN OFF 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-30T12:39:06.097

```
SET ESCAPE ON;
INSERT VALUES("J\&J Construction") INTO custnames; 
```

（未经测试，手头没有Oracle盒子，已经有一段时间了）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-06T19:54:59.693

停止使用 SQL/Plus，我强烈推荐[PL/SQL Developer](http://www.allroundautomations.nl/plsqldev.html) ，它不仅仅是一个 SQL 工具。

ps 有些人更喜欢[TOAD](http://www.toadsoft.com/)。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-08-30T11:35:27.763

看，安德鲁：

**《强生建设》**：

```
SELECT CONCAT('J', CONCAT(CHR(38), 'J Construction')) FROM DUAL; 
```

# apache-flex - Flex 与 DHTML 的区别是什么？

> ID：152846
> 
> 赞同：2
> 
> 时间：2008-09-30T12:36:28.520
> 
> 标签：apache-flex, flash, animation, dhtml

我刚开始使用 Adob​​e Flex SDK。我非常兴奋，因为这是我第一次找到一种好的、**免费**的方式来创建 Flash 应用程序。但后来我注意到了一些事情：Flex 似乎与制作动画或设计无关。它似乎更像是一个构建表单和菜单等的应用程序......我已经可以在 (D)HTML 中做到这一点。

Flex 有哪些特性使其在某些情况下比 HTML 更好？

另外，是否有任何技术/软件程序可以让我添加我之前提到的闪存/设计组件？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T12:40:30.213

与 Silverlight 一样，Flex 的营销目的是创建一种称为 RIA = 富互联网应用程序的东西。这个想法是 (D)HTML 并不适合在 Web 上创建大规模、响应良好的应用程序。我不确定这是否真的（仍然）正确，但从历史上看，它是合适的。

Flex 和 Silverlight 试图通过提供两件事来纠正这个问题：一种不同的、可扩展的技术以及一个大型库和一个适用于创建应用程序的工具集。这两种情况的缺点是依赖于其他（非自由、非标准）组件。其优点是潜在的生产力更高的工作流程和更好的性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T14:59:21.360

Flex 有一个内聚的组件模型，基本构建块旨在支持*应用程序*。另一方面，HTML 是为显示文本而设计的，而 DOM 是组件模型的一个遗憾的借口——而且它绝对不是为应用程序而设计的。

有大量的 JavaScript 库试图在 DOM 之上实现一个可行的平台，以消除浏览器之间的差异。虽然这些在许多情况下都可以正常工作，但它们中的大多数都没有接近 Flex 组件模型的丰富性，甚至没有更基本的 Flash API：s。

不管像Dojo、YUI、jQuery这样令人印象深刻的库，它们都受到平台的限制，而且确实是有限的。Flex 具有 Flash Player 平台的所有优点，如矢量图形、远程对象、视频支持、跨域加载、套接字、字体嵌入等，而且还具有非常好的组件模型、数据绑定和蒙皮功能，仅此而已一些。如果您正在编写富 Internet 应用程序，那么 Flex 将变得非常丰富。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T12:45:10.107

Flex 是 Fl​​ash 之上的一层，专为构建应用程序而设计。因此，它在接口构建和数据操作方面具有非常强大的功能。如果你对电影和动画感兴趣，坚持使用 Flash 更合适。

```
Flex 优于 DHTML (AJAX) 的优势包括：
- 更快的原型制作
- 更好的跨浏览器支持
- 更好地支持数据管理
- 更认真”

```

```
缺点包括：
- 被一个供应商困住了
- 需要 Flash 插件

```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T14:19:55.760

您可以在 Flex/Flash 与 DHTML 中制作音频和视频。

更多细节和比较在这篇[关于 Flex 的你应该知道的 10 件事](http://css.dzone.com/news/the-top-10-things-you-should-k)文章中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T14:51:40.537

如果您对利用 Flex 的图形潜​​力感兴趣，何不去看看[Degrafa](http://www.degrafa.com/)，它是一个开源图形和通用图形 API。这很酷，文档也很好，并且引用*了——“Adobe 已询问 Degrafa 团队是否会考虑直接帮助 Flex Graphics 开源工作。”* - 他们是！

这不仅仅是关于图表和图形。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T22:32:56.917

快速澄清一下 - 需要明确的是，Flex 是建立在 Flash 之上的。这意味着您可以在 Flash 中做的任何事情，在涉及到编程时，您都可以在 Flex 中做。Flex Builder 不附带任何工具，可让您使用时间线或矢量艺术或类似的东西制作动画，但只要您有在其他地方制作它们的工具，所有这些元素仍然可用。

Flex 真正是将 Actionscript 3 作为一种语言和作为运行时的 Flash 连接到一个应用程序程序员可以真正适应它的环境中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T13:02:46.710

如上所述，“更好的跨浏览器支持”。这可能是我现在最大的因素。

还有几...

*   实现“像素完美”设计要容易得多。
*   将 Flash 内容集成到 Flex 中非常容易。这使得与设计师合作更容易。
*   Actionscript 比 Javascript 更好（来吧，让我发火！）

除了购买 Flash 产品来制作基于时间线的动画之外，没有任何真正好的选择。

不好的一面：

*   有时，html 更简单/更强大

确保为正确的工作选择正确的工具。有时是 DHTML，有时是 Flex，有时是 Flash，很多时候是它们的组合。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T22:56:33.430

您在谈论的是 Flash 与 Javascript。Flex 是 Fl​​ash，DHTML 是 Javascript。

Flex 允许快速原型设计，是构建 Flash .swf 的替代 IDE，并且非常适合 Air - Javascript 仅在浏览器中运行，默认包含较少的动画支持（尽管有很多完善的库提供该功能）和不需要插件即可工作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-01T08:02:54.677

此外，使用 Flex，您不必处理 JSON、XMLHttpRequest、兼容性问题等等……一切都像魔术一样工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-16T23:17:59.080

*   除非您需要大量动画，否则 HTML 会感觉比 Flex 更轻量。

*   没有“加载”屏幕。

*   在 OS X 上，Flex 的性能非常*糟糕*。甚至 DHTML 动画也更快！（见[GUIMark](http://www.craftymind.com/guimark/)）。

*   HTML 比 Flex 具有更广泛的兼容性。它可能不像为单个供应商的单个实现编写那样容易，但OTOH您不限于该单个实现：

    *   iPhone 或 64 位 Linux 没有问题。
    *   通过优雅降级，甚至可以从 Lynx 或 BlackBerry 浏览器访问基本功能。
*   HTML 更好地与浏览器和操作系统集成：

    *   表单元素可以具有原生外观。
    *   文本具有首选类型的抗锯齿，ClearType 没有问题。
    *   键盘快捷键、上下文菜单和文本选择按预期工作。
*   浏览器扩展可以改进 DHTML 应用程序，但 Flex 是不可渗透的。

*   辅助工具对 HTML 有更好的支持。

# .net - 如何在 MSTest 单元测试项目中使用“外部”配置文件（即使用 configSource）？

> ID：152866
> 
> 赞同：11
> 
> 时间：2008-09-30T12:41:02.393
> 
> 标签：.net, unit-testing, mstest

为简单起见，我通常将很多配置（即 app.config 和 web.config 的内容）拆分为单独的 .config 文件，然后使用 'configSource' 属性从主配置文件中引用它们。例如：

```
<appSettings configSource="appSettings.config"/> 
```

然后将所有键/值对放在该 appSettings.config 文件中，而不是将其内联在主配置文件中：

```
<appSettings>
    <add key="FirstKey" value="FirstValue"/>
    <add key="SecondKey" value="SecondValue"/>
    ...
</appSettings> 
```

这通常适用于应用程序本身，但我在尝试编写单元测试时遇到问题，无论出于何种原因，需要从存储在这些外部文件之一中的配置部分获取某个值。（我知道其中大多数可能会被视为“集成测试”，因为它们依赖于配置系统，而且我也确实有“纯单元测试”，但这些不是问题。我真的在寻找测试这些配置值是否被正确检索并以正确的方式影响行为）。

由于 MSTest 如何编译并将输出复制到与每次测试运行不同的看起来模糊的文件夹（而不是您可能认为的“bin”文件夹），它似乎永远无法在测试时找到那些外部文件正在执行。我尝试过使用后期构建操作来完成这项工作，但没有运气。有没有办法在运行时将这些外部文件复制到正确的输出文件夹中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-30T12:43:20.360

找到了：

如果您编辑测试运行配置（通过在添加新单元测试时双击放入“解决方案项目”解决方案文件夹的 .testrunco​​nfig 文件），您会看到一个测试运行配置对话框。那里有一个名为“部署”的部分，您可以在其中指定解决方案中任何位置的文件或整个文件夹，这些文件或整个文件夹可以在运行时与已编译的程序集一起复制到正确的文件夹中。

通过这种方式，我现在实际上可以在一组外部 .config 文件中定义我的大部分配置，并在每次测试运行时自动将它们复制出来。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-12T11:56:05.487

尝试在 Visual Studio 之外运行测试时，测试运行配置有点尴尬。

对于使用 MSTest 执行命令行，保持“干净”变得非常麻烦。它们也是解决方案的“全局”，因此将为每个测试项目复制外部文件。

我更喜欢这个`DeploymentItem`属性。

```
[TestMethod]
[DeploymentItem(@"test_data.file")]
public void FooTest()
{...} 
```

使测试独立于 .testrunco​​nfig 文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-02-13T08:48:35.840

1.  把它写在你的connectionString中。第一个**ConnectionString.config**不存在。

    <"connectionStrings configSource="ConnectionString.config"> "

2.  以管理员权限打开命令提示符 (CMD)。

3.  在 bin/debug 文件夹中创建一个名为**ConnectionString.config的符号链接。**

C:\Windows\Systems32>`mklink "C:\Link To Folder\....\ConnectionString.config" "C:\Users\Name\Original Folder\.....\...\Secure ConnectionString.config"`

最后它在指定位置创建 ConnectionString 配置文件。并成功运行。

[![在此处输入图像描述](https://i.stack.imgur.com/K0JLb.png)](https://i.stack.imgur.com/K0JLb.png)

# asp.net - 使用 jQuery 突出显示选定的 ASP.NET DataGrid 行

> ID：152869
> 
> 赞同：4
> 
> 时间：2008-09-30T12:41:57.243
> 
> 标签：asp.net, jquery

突出显示选定的数据网格行很容易，例如在 tr 的单击事件中使用 toggleClass。但是，在选择了不同的行之后，如何最好地删除突出显示？对于较大的数据网格，迭代所有行以取消突出显示它们可能会变得昂贵。我会对最简单的解决方案以及最高效的解决方案感兴趣。

谢谢，
迈克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-30T12:44:09.673

如果您只想查找已切换类的项目**并**使用 jQuery 将其关闭：

```
$('.toggledClass').removeClass('toggledClass'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T13:50:36.533

此方法将活动行存储到变量中。变量开头的 $ 只是我自己对 jQuery 对象的匈牙利符号。

```
var $activeRow;

$('#myGrid tr').click(function() {
    if ($activeRow) $activeRow.removeClass('active');
    $activeRow = $(this).addClass('active');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-30T12:45:32.463

为了获得更快的性能，您可以将所选元素的 ID 推送到 var（或多个数组）中，然后在关闭类时使用该 var/迭代该数组。

# rest - 面向资源不是真的面向对象吗？

> ID：152871
> 
> 赞同：5
> 
> 时间：2008-09-30T12:42:34.340
> 
> 标签：rest, oop

当您考虑它时，面向资源的 REST 范式是否可以归结为面向对象（功能受限，尽可能利用 HTTP）？

我不一定说这是一件坏事，而是如果它们~~本质上是相同的~~非常相似，那么理解 REST 以及这种架构所带来的含义就会变得更加容易。

**更新：**以下是更具体的细节：

1.  REST 资源相当于公共类。私有类/资源根本没有公开。
2.  资源状态相当于类公共方法或字段。私有方法/字段/状态根本没有公开（这并不意味着它不存在）。
3.  虽然 REST 确实不会跨请求保留特定于客户端的状态，但它**确实会**跨所有客户端保留资源状态。资源**有**状态，就像类有状态一样。
4.  REST 资源由 URI 全局唯一标识，就像服务器对象由其数据库地址、表名和主键全局唯一标识一样。诚然（还没有）一个 URI 来表示这一点，但您可以轻松地构建一个。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-30T14:13:32.250

REST 类似于 OO，因为它们都将世界建模为接受消息（即方法）的实体，但除此之外它们是不同的。

面向对象强调状态和**不透明度**的封装，使用尽可能多的不同方法对状态进行操作。**REST 是关于状态和透明度**的（表示）转移。REST 中使用的方法数量是有限的，并且在*所有*资源中都是统一的。与 OOP 中最接近的是与`ToString()`HTTP GET 非常大致等效的方法。

面向对象是**有状态**的——您引用一个对象并可以在其上调用方法，同时在对象仍在范围内的会话中保持状态。REST 是**无状态**的——您想要对资源执行的所有操作都在单个消息中指定，并且您需要知道的有关该消息的所有信息都在单个响应中发回。

在面向对象中，**没有通用对象标识的概念——对象**要么在任何特定时刻从它们的内存地址、特定于框架的 UUID 或从数据库键中获取标识。在 REST**中，所有资源都用 URI 标识，**不需要实例化或处置——它们始终存在于云中，除非服务器以*404 Not Found*或*410 Gone*响应，在这种情况下，您知道没有资源URI。

REST 具有**安全**保证（例如，GET 消息不会改变状态）和**幂等**性（例如，多次发送的 PUT 请求与仅一次具有相同的效果）。尽管针对特定面向对象技术的一些指导方针对某些构造如何影响状态有所说明，但实际上并没有关于面向对象的任何内容来说明安全性和幂等性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-30T14:33:06.603

*我认为说一个概念可以用对象来表达和说这个概念与面向对象相同*是有区别的。

OO 提供了一种描述 REST 概念的方法。这并不意味着 REST 本身实现了 OO。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T12:49:49.863

你说的对。Dan Connolly在 1997 年写[了一篇关于它的文章。](http://www.w3.org/People/Connolly/9703-web-apps-essay.html)[菲尔丁论文](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)也谈到了它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-06T23:29:15.907

对象将状态和功能捆绑在一起。面向资源是关于显式建模状态（数据），将功能限制为具有通用语义的预定义动词（在 HTTP 的情况下，GET/PUT/POST/DELETE），并将其余处理留给客户端。

在面向对象的世界中，这些概念没有等价物。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T12:47:05.827

仅当您的对象是 DTO（[数据传输对象](http://en.wikipedia.org/wiki/Data_Transfer_Object)）时-因为除了持久性之外，您实际上没有其他行为。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T12:49:46.507

是的，您与面向对象的平行是正确的。

问题是，大多数 web 服务（REST、RESTful、SOAP、..）都可以以对象的形式传递信息，所以这并不是它与众不同的原因。SOAP 往往会导致使用更多方法的服务更少。REST 往往会导致更多的服务（每种资源类型 1 个），每个服务只有几个调用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T13:00:20.990

是的，REST 是关于对象的传输。但这不是整个对象。只是对象的当前状态。隐含的假设是 REST 两侧的类定义可能相似；否则对象状态已被强制转换为某个新对象。

REST 只关心对象生命中的 4 个事件，创建 (POST)、检索 (GET)、更新 (PUT) 和删除。它们是重大事件，但只有这四个。

一个对象可以与许多其他对象一起参与许多其他事件。此行为的所有其余部分完全在 REST 方法之外。

有一个密切的关系——REST 移动对象——但是说它们是相同的会将你的对象减少为没有方法的被动位集合。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T14:08:21.763

REST 不仅与对象有关，它还与属性有关 :: 使用新电话号码对 /users/john/phone_number 的发布请求不是添加新对象，而是设置用户对象“john”的属性

这甚至不是对象的全部状态，而只是对一小部分状态的改变。

这当然不是 1:1 的比赛。

# svn - 如何解决与 SVN 属性的合并冲突？

> ID：152887
> 
> 赞同：41
> 
> 时间：2008-09-30T12:45:49.967
> 
> 标签：svn

这一直困扰着我很长时间 - 我如何正确解决目录上设置的 SVN 属性中的合并冲突？例如，有两个开发人员在一个项目中工作，其中 svn:ignore 设置在某个目录上。如果两个开发人员都对此属性进行了更改，那么当第二个开发人员更新时，他们将看到合并冲突。

与文件合并冲突不同，在名为“dir_conflicts.prej”的目录中生成了一个文件，第二个开发人员必须阅读并手动更正该文件。通常，我最终要做的是将所有更改还原到本地副本，然后使用 dir_conflicts.prej 中的信息手动重新设置这些属性。然而，在处理 svn:externals 属性中的大量 URL 列表时，这相当麻烦，因为我们的许多项目都使用。

必须有更好的方法来做到这一点——有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T11:45:02.103

只是经过一些额外研究后的快速更新——*不可能*轻松地合并 SVN 属性。我最初描述的方法（还原、合并 .prej 文件中的数据、propset、重新提交）似乎是处理此类问题的最佳方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-10-06T12:28:48.323

与此同时，这可以在 Eclipse+Subclipse (Indigo) 中使用该函数

> 团队->编辑属性冲突

（刚刚尝试使用冲突的 svn:ignore 属性）

此功能会打开一个显示两个属性版本（本地和存储库）的对话框，您可以在其中复制和粘贴，然后使用 Team->Mark Resolved 解决冲突。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-31T09:56:10.557

我有同样的问题。

> 我尝试使用**Team->Edit Property Conflicts**但我的 STS 被挂起并且没有响应，因此我强制关闭。

可以用**TortoiseSVN解决**

> 这就是我解决的方法

*   选择它所在的文件`dir_conflicts.prej`夹
*   右键单击**TortoiseSVN -> 解决...**
*   然后它会要求解决财产冲突
*   解决并保存

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T13:09:24.510

我希望我能提供一个更有希望的解决方案，但根据我的经验，目前无法使用 TortoiseSVN 合并 svn 属性。看[http://svn.haxx.se/tsvn/archive-2008-09/0212.shtml](http://svn.haxx.se/tsvn/archive-2008-09/0212.shtml)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-01T02:06:14.283

您是指提交/更新或分支合并的合并冲突吗？

[SVN Book](http://svnbook.red-bean.com/en/1.1/ch07s02.html#svn-ch-7-sect-2.3.3)非常清楚 svn:ignore 属性，特别是：

> Subversion 并不假定工作副本目录中的每个文件或子目录都用于版本控制。必须使用 svn add 或 svn import 命令明确地将资源置于 Subversion 的管理之下。

...

> 强制该存储库的每个用户将这些资源的模式添加到他们的运行时配置区域不仅是一种负担，而且有可能与用户签出的其他工作副本的配置需求发生冲突。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-19T15:14:15.383

为了清楚起见，SVN 似乎使用 dir_conflicts.prej 文件来得出目录存在冲突的事实。如果您打算手动解决冲突，您可以简单地删除 dir_conflicts.prej 文件，然后根据需要手动设置 svn 属性。（当然，请确保在删除之前从 .prej 文件中获取您需要的内容！）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-17T19:38:46.773

我也有类似的冲突。我`dir_conflicts.prej`在文本编辑器中打开并看到`svn ignore list`已更改。幸运的是，列表的内容是相同的，只是顺序发生了变化。所以在 中`TortoiseSVN 1.9.3`，我只需右键单击该文件夹即可`TortoiseSVN -> Resolve...`。冲突得到了解决。

# networking - OSI 模型 - 表示层和会话层有什么用？

> ID：152889
> 
> 赞同：12
> 
> 时间：2008-09-30T12:47:03.817
> 
> 标签：networking, model, stack, osi

所以我觉得我非常了解应用层，以及传输层以下（包括）的所有内容。

但是，我并不完全理解会话层和表示层。我已经阅读了 Wikipedia 中的简单描述，但它没有一个示例说明为什么分离这些层是有用的。

所以：

*   什么是会话层？它有什么作用，在什么情况下拥有一个会话层比简单地与您的应用程序与传输通信更好？
*   什么是表示层？（与上述相同的问题）

-亚当

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-09-30T12:53:33.130

会话层旨在存储两个连接之间的状态，例如我们在使用 Web 编程时使用 cookie 的目的。

表示层旨在在不同格式之间进行转换。当唯一担心的格式是字符编码时，这更简单，即 ASCII 和 EBCDIC。当您考虑我们今天拥有的所有不同格式（Quicktime、Flash、Pdf）时，集中这一层是不可能的。

TCP/IP 不对这些层进行任何分配，因为它们确实超出了网络协议的范围。这取决于利用堆栈的应用程序来实现这些。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T12:50:59.733

维基百科上没有任何例子的原因是没有很多关于 OSI 网络模型的例子。

OSI 再次创建了一个没有人使用的标准，所以没有人真正知道*应该*如何使用它。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-30T13:48:52.683

第 5-6 层在当今的 Web 应用程序中并不常用，因此您对它们的了解不多。TCP/IP 堆栈与纯 OSI 模型略有不同。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-30T13:52:19.650

今天使用 TCP/IP 而不是 OSI 的原因之一是它过于臃肿和理论化，事实证明，会话和表示层并不真正需要作为单独的层。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-23T22:40:55.813

我认为表示层协议定义了数据的格式。这意味着像 XML 或 ASN.1 这样的协议。您可能会争辩说视频/音频编解码器是表示层的一部分，尽管这可能是走向应用层。

我无法帮助您处理会话层。这一直让我感到困惑。

老实说，传输层之上的一切都有非常模糊的界限。这是因为它通常由单个软件应用程序处理。此外，这些层与将数据从 A 传输到 B 没有直接关联。第 4 层及以下的每个层在移动数据方面都有非常特定的目的，例如交换、路由、确保数据完整性等。这使得区分这些层更容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-17T15:13:36.163

对于表示层：因为异构系统（操作系统、编程语言、cpu 架构）之间完成的大部分通信我们需要使用统一的 idepedent 规范。如 ANS1 和 BRE。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-08-18T13:28:14.697

**表示层** 表示层表示独立于应用层数据表示的区域——一般来说，它表示应用程序格式到网络格式或从网络格式到应用程序格式的准备或转换。换句话说，该层为应用程序或网络“呈现”数据。一个很好的例子是加密和解密数据以实现安全传输——这发生在第 6 层。

**会话层** 当两台设备、计算机或服务器需要相互“对话”时，需要创建一个会话，这是在会话层完成的。这一层的功能涉及设置、协调（例如，系统应该等待多长时间的响应）和会话结束时应用程序之间的终止。

[来源](https://www.networkworld.com/article/3239677/the-osi-model-explained-how-to-understand-and-remember-the-7-layer-network-model.html)

# user-interface - 您将如何设计具有许多动态字段的表单？

> ID：152893
> 
> 赞同：2
> 
> 时间：2008-09-30T12:49:21.377
> 
> 标签：user-interface, data-entry

我们有一个表单，允许用户为字段动态添加输入。例如，如果您有一个用于跟踪项目的表单，您希望将任务动态添加到该项目。只是为了澄清我的语言：您为任务字段动态添加输入。问题是，我们有 50 个这样的字段。我们当前的解决方案在所有 50 个字段旁边显示一个加号 (+)，以允许他们为该字段添加另一个输入框。字段的标签位于字段的左侧，添加的每个输入框都位于当前输入框的下方。

请相信动态添加输入是正确的解决方案，请相信这是经过深思熟虑的，请相信这是用户想要的，请相信我们已经走上了其他各种道路，这是最好的解决方案。

我的问题是关于演示的：你会怎么做？

请保留UI设计的答案。我们已经弄清楚了数据库模式。

* * *

**更新**

*Current Solution 是一个基于 Web 的应用程序，它使用 JavaScript 动态添加新的输入，看起来非常类似于 Corey Trager 的绘图：*

```
Task     [.............] +  
         [.............] +  
         [.............] +  
         [.............] +

Foo      [.............] +
         [.............] +
         [.............] +

Repeat 50 times... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T13:00:22.427

从@zachary 的建议中思考：

使用默认/上次保存的字段数显示为用户设计的表单。在表单的底部放置一个 DropDownButton，它有一个 + 图标和单词 Add Field ( **+ Add Field** )。

下拉此按钮将显示所有可用字段的列表。当用户选择其中之一时，表单将增长（足以容纳新字段），带有标签的新字段将显示在表单底部，添加字段按钮将显示在新字段下方。

* * *

**编辑：**

为了遵循 ASCII 图表的主题，这就是我认为我的建议的样子。

任务 [......................]
        [ + 添加任务 ▼]

Foo [........]
        [ + 添加 Foo ▼]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-30T13:00:48.370

那么，您所描述的可能看起来像这样？如果没有，您可以尝试“绘图”吗？

```
Task     [.............] +  
         [.............] +  
         [.............] +  
         [.............] +

Foo      [.............] +
         [.............] +
         [.............] + 
```

这是网页还是其他技术？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T14:27:56.723

这可能完全不合时宜，但取决于字段的要求，以及这是配置还是数据输入界面。

如果**确实**需要打开字段以进行数据输入，您可以将它们定义为字段名称和值的列表，并使用点击编辑根据需要在每个元素上动态放置输入框。

这种解决方案可以**减少视觉噪音**并节省**垂直空间**。如您所见，表单输入比纯文本占用更多空间。您可以通过捕获选项卡事件并触发下一个字段的单击以编辑功能来满足键盘用户的需求。

它可能看起来像这样。（刚刚点击 Foo 编辑内容）

```
Name   : Joe Blogs
Phone  : 555-1234
Cheese : Stilton
        -----------
Foo     | SNAFU   |    
        -----------
Bar    : fubar
Fifty  : Whatever

(+) Add new field... 
```

* * *

或者

如果这是一个配置页面，即您在流程的另一个屏幕或阶段添加要填写的新字段，您可以按顺序定义字段列表，然后将其显示给用户以供数据输入。

```
 -------------------------------------------------
Define Fields | name, phone, cheese, foo, bar ..(etc).. fifty |
              ------------------------------------------------- 
```

然后根据当前 UI 将字段显示在一个巨大的网格中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-01T03:10:08.390

好的，既然您已将我的图表添加到您的问题中，我的答案是......

我并不是说这更好，但它是一个替代方案。这是一种用点击代替水平滚动的不同方式。不要通过垂直滚动从“tasks”导航到“foo”再到“bar”，而是使用“tabs”，即使您必须将它们堆叠几行高。它确实使以随机顺序导航变得更容易。您甚至可以从这个选项卡式视图来回切换到您当前的“全部显示”视图。

```
[task][foo][another tab][another tab][etc][etc][etc][etc][etc][etc]
[row2][fred][another tab][etc][etc][etc][etc][etc][etc][etc]
[row3][another tab][wilma][etc][etc][etc][etc][etc][etc][etc]

[task1     ]+
[task2     }+
[task3     ]+ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T12:53:17.793

最后一个任务字段附近的小 + 图标带有“添加新任务”的链接。单击后，新任务字段会出现在当前最后一个任务下方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T12:53:46.937

我会使用拖放方法，让用户灵活定位。这甚至可以使用网络应用程序。例如，参见 Dropthings ( [http://www.dropthings.com/](http://www.dropthings.com/) )。这提供了在 ASP.NET 环境中实现拖放所需的所有代码。

你用的是什么环境？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T13:01:17.510

如果这是一个网络应用程序，那么您可以使用 Javascript 来动态管理附加字段。根据您是否可以异步处理表单，您可以使用 Ajax 来简化表单管理的某些方面。

基本上，每个任务都需要单独命名，然后您需要为他们选择附加的每个新字段附加一个新的唯一命名的表单输入元素。然后，您必须在提交表单之前使用 Javascript 遍历表单，或者在提交后遍历 POST 数据。

当然，这会将 Javascript 作为您的 Web 应用程序的要求引入，这并不总是可行的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-11T03:52:22.297

你能不能使用一个类似于 facebook 实现的系统，它只有一个文本框，但允许向其中添加多个项目？有一些预编码的解决方案，例如[这个](http://ajaxian.com/archives/facebook-style-input-box)是针对 mootools v1.2 的，或者[这个](http://loopj.com/2009/04/25/jquery-plugin-tokenizing-autocomplete-text-entry/)是针对 jQuery 的。您甚至可以允许自动完成系统中已有的任务。

# c# - .NET XmlDocument LoadXML 和实体

> ID：152900
> 
> 赞同：4
> 
> 时间：2008-09-30T12:51:19.297
> 
> 标签：c#, xml, entity

将 XML 加载到 XmlDocument 时，即

```
XmlDocument 文档 = 新 XmlDocument();
document.LoadXml(xmlData);

```

有什么方法可以阻止进程替换实体？我有一个奇怪的问题，我在 xml 中有一个 TM 符号（存储为实体 #8482）被转换为 TM 字符。就我而言，这不应该发生，因为 XML 文档具有编码 ISO-8859-1（没有 TM 符号）

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T13:26:22.300

这是对 XML 工具集的标准误解。整个业务带有“&#x”，是一种旨在应对字符编码的句法特征。您的 XmlDocument 不是字符流 - 它已经摆脱了字符编码问题 - 相反，它包含 XML 类型数据的抽象模型。这方面的词包括 DOM 和 InfoSet，我不确定哪个是准确的。

“&#x”gubbins 在此模型中将不存在，因为整个问题无关紧要，当您将信息集转换回某种特定编码的字符流时，它将返回 - 如果合适的话。

这种误解非常普遍，以至于将其作为类似怪癖集合的一部分纳入学术文献。看看这个位置的“Xml Fever”：http: [//doi.acm.org/10.1145/1364782.1364795](http://doi.acm.org/10.1145/1364782.1364795)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T13:01:28.243

你在写什么？一个文字作家？流？什么？

以下保留实体（嗯，它用十六进制等效替换它） - 但如果你对 StringWriter 做同样的事情，它会检测到 unicode 并改用它：

```
 XmlDocument doc = new XmlDocument();
    doc.LoadXml(@"<xml>&#8482;</xml>");
    using (MemoryStream ms = new MemoryStream())
    {
        XmlWriterSettings settings = new  XmlWriterSettings();
        settings.Encoding = Encoding.GetEncoding("ISO-8859-1");
        XmlWriter xw = XmlWriter.Create(ms, settings);
        doc.Save(xw);
        xw.Close();
        Console.WriteLine(Encoding.UTF8.GetString(ms.ToArray()));
    } 
```

输出：

```
 <?xml version="1.0" encoding="iso-8859-1"?><xml>&#x2122;</xml> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T12:59:42.647

我承认 XML 文档和编码有点令人困惑，但我希望当你再次保存它时它会被设置为适当的，如果你仍然使用 ISO-8859-1 - 但是如果你用 UTF-保存8、没必要。在某些方面，从逻辑上讲，文档确实包含符号而不是实体引用——后者只是一个编码问题。（我在这里大声思考-请不要将此作为权威信息。）

加载文件后你在做什么？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T13:01:21.520

我相信如果您将实体内容包含在 CDATA 部分中，它应该不理会它，例如

```
<root>
<testnode>
<![CDATA[some text &#8482;]]>
</testnode>
</root> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T13:11:36.627

实体引用不是特定于编码的。根据[W3C XML 1.0 推荐](http://www.w3.org/TR/2006/REC-xml-20060816/#sec-references)：

> 如果字符引用以“&#x”开头，则数字和字母直到终止；在 ISO/IEC 10646 中提供字符代码点的十六进制表示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T13:28:52.140

&#xxxx; 实体被认为是它们所代表的字符。所有 XML 在读取时都会转换为 unicode，并且任何此类实体都将被删除以支持它们所代表的 unicode 字符。这包括它们在 unicode 源中出现的任何情况，例如传递给 LoadXML 的字符串。

同样，在写入任何不能由正在写入的流表示的字符时，都将转换为 &#xxxx; 实体。试图保护它们毫无意义。

一个常见的错误是期望通过某种方式从 DOM 中获取字符串，该方式使用除 unicode 之外的编码。无论发生什么，这都不会发生

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T16:18:28.037

感谢所有的帮助。

我已经通过编写一个 HtmlEncode 函数解决了我的问题，该函数实际上在将所有字符吐出到网页之前替换了所有字符（而不是依赖于有点损坏的 HtmlEncode() .NET 函数，它似乎只编码了一小部分必要的字符）

# keyboard - 可怕的 VMware 键盘快捷键

> ID：152901
> 
> 赞同：18
> 
> 时间：2008-09-30T12:52:15.207
> 
> 标签：keyboard, vmware, shortcut

我是 VMware 用户，在编程时我经常使用键盘快捷键。然而，事实证明这非常令人痛苦，因为有时 VMware 会抓住它并关闭/暂停 ( `Ctrl`+ `Z`) 虚拟机。

有没有办法在 VMware 上禁用键盘快捷键？这里有人找到解决方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-30T12:57:13.353

我使用 AutoHotKey（您在 Windows 上运行 VMWare 吗？）禁用某些快捷方式。你可以在这里找到这个工具：

[http://www.autohotkey.com/](http://www.autohotkey.com/)

它是开源的，我非常喜欢它。可用于自动化任务，但您也可以让它对不同的窗口做出不同的响应。通过一些 AHK 脚本，我认为您应该能够解决您的问题。

该网站也有大量关于编写方便脚本的教程。

祝你好运。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-12-10T18:00:01.263

如果你觉得没问题 - 这里有一些非常简单的 hacky 解决方案 - 只需使用 ResHacker 程序来摆脱那些烦人的加速器（它们在 vmware.exe 中被定义为资源）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-29T17:06:16.247

这对我来说也很烦人。我终于通过执行以下操作为我解决了这个问题：

1.  打开 VMWare Workstation 首选项（编辑菜单 | 首选项）
2.  选择输入选项卡
3.  选中“按键时抓取键盘和鼠标输入”选项。

这样，如果您的鼠标移动到虚拟机窗口之外，当您键入某些内容时，虚拟机将“重新获得”焦点。

# abap - 获取 Application Server 目录的内容

> ID：152919
> 
> 赞同：11
> 
> 时间：2008-09-30T12:58:58.467
> 
> 标签：abap, directory-listing

我需要在 SAP 中获取服务器端目录的列表。我如何在 ABAP 中实现这一点？我可以调用任何内置的 SAP 函数吗？

理想情况下，我想要一个可以将路径作为输入传递的函数，它将返回内部表中的文件名列表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-11-24T09:57:31.790

`EPS2_GET_DIRECTORY_LISTING`与`EPS_GET_DIRECTORY_LISTING`但返回文件名最多**200 个**字符的操作相同！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-03T00:59:12.103

调用函数 RZL_READ_DIR_LOCAL：

```
FUNCTION RZL_READ_DIR_LOCAL.
*"----------------------------------------------------------------------
*"Lokale Schnittstelle:
*"       IMPORTING
*"             NAME LIKE SALFILE-LONGNAME
*"       TABLES
*"             FILE_TBL STRUCTURE SALFLDIR
*"       EXCEPTIONS
*"             ARGUMENT_ERROR
*"             NOT_FOUND
*"---------------------------------------------------------------------- 
```

将路径放在 NAME 导入参数中，返回后从 FILE_TBL 中读取目录列表。

RZL_READ_DIR_LOCAL 可以处理普通的本地路径以及 UNC 路径。

唯一的缺点是它只允许您访问每个文件名的前 32 个字符。但是，您可以轻松地基于 RZL_READ_DIR_LOCAL 代码创建一个新函数，并更改读取 C 程序输出的方式，因为每个文件名的前 187 个字符实际上是可用的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-02T14:49:26.267

答案是调用函数模块EPS_GET_DIRECTORY_LISTING。DIR_NAME -> 目录 FILE_MASK 的名称 -> 传递 '*' 以获取所有文件。

注意：这不处理非常大的文件名（80 个字符以上），它会截断名称。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-14T08:13:56.373

在阅读了 Chris Carrthers 和 tomdemuyt 的回答后，我会说：

1) 如果您需要简单的文件名列表，请使用 RZL_READ_DIR_LOCAL。

2) EPS_GET_DIRECTORY_LISTING 更强大 - 它还可以列出子目录。

谢谢你们！

最好的问候尼基加拉诺夫

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-09T14:48:05.457

看一下事务 AL11 源代码：RSWATCH0 表单`fill_file_list` 在那里您可以获取有关文件的所有信息。

希望这可以帮助！

# visual-studio-2005 - 在 Visual Studio 中查看变更集时，如何更改 cs 文件的视图？

> ID：152926
> 
> 赞同：19
> 
> 时间：2008-09-30T13:00:06.407
> 
> 标签：visual-studio-2005, tfs

在使用 TFS 作为源代码控制的 Visual Studio 中，当我查看历史记录并双击一个 cs 文件时，该文件会加载到记事本中。如何将应用程序更改为记事本++？

我还希望文件的操作系统默认应用程序仍然是 Visual Studio

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-10-15T17:34:25.203

在[翻阅 ProcessMonitor](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)日志后，我想我找到了解决方案！

您需要更改 Windows shell（资源管理器）对文本文件的“编辑”操作的看法。我能够更改此密钥：

`HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations\text\shell\edit\command`

到记事本以外的东西（在我的例子中是notepad2）。现在 Visual Studio 的 TFS 的变更集对话框使用该编辑器打开 cs 文件。

这可能不仅会更改 cs 文件的编辑选项，还会更改所有被视为“文本”的内容。文件关联的注册表项非常复杂。我怀疑可以将 .cs 文件与这个常见的“文本”类别和仅对 cs 文件进行此更改（但我并没有那么雄心勃勃）。此外，如果人们的文件关联/shell 命令（打开、编辑等）因机器而异（操作系统版本），我不会感到惊讶，安装的工具等） - 所以YMMV。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T06:35:45.983

\我可以通过向注册表添加新值来配置它。

操作系统：Windows 7 企业版 x64

如何做到这一点的步骤。

1.  运行：**Regedit**（alt + r，输入 regedit）
2.  寻找 `HKEY_LOCAL_MACHINE\SOFTWARE\Classes\SystemFileAssociations`
3.  右键单击“SystemFileAssociation”-> 添加新密钥，然后将其命名为**.cs**
4.  右键单击 .cs 并添加新密钥，然后将其命名为**shell**
5.  右键单击**外壳**并添加新键，将其命名为**编辑**并**打开**6
6.  右键单击**编辑**并添加新的键**命令**，然后将默认值更改为指向您希望它运行的文件 exe。例如：**C:\Program Files (x86)\Notepad++\notepad++.exe %1**
    不要忘记在 .exe 末尾添加 %1
7.  **对打开**做同样的事情

 **希望能帮助到你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-07-06T12:27:11.603

我发现的唯一方法是用记事本++替换记事本。本文[描述](http://www.howtogeek.com/howto/12617/how-to-replace-notepad-in-windows-7/)了如何做到这一点。不要忘记查看评论以获取 notepad++ 附带的“小 exe”的链接。像 W7 x64 上的魅力一样工作。

干杯，菲尔

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T13:44:24.957

我在 Visual Studio 中看不到任何更改它的选项，所以我猜它使用系统的默认文本编辑器。

尝试将 Notepad++ 指定为 *.cs 文件的默认处理程序。

您可以通过使用记事本++ 转到设置/首选项/文件关联来执行此操作。

您也可以通过右键单击资源管理器中的 .cs 文件，转到打开方式/选择程序...，然后选择 Notepad++ 并选中“始终使用所选程序打开此类文件”框，然后点击好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-08T22:00:47.753

唯一对我有用的是当我在 Windows 资源管理器中为特定文件类型设置默认程序以使用 VS IDE 打开时：

```
C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe 
```

这将在 VS 的新实例中打开代码。不理想，但至少它更容易阅读。

# user-interface - 什么时候可以接受模态 UI？

> ID：152938
> 
> 赞同：9
> 
> 时间：2008-09-30T13:02:41.593
> 
> 标签：user-interface, modal-dialog

总的来说，模态界面会吸大石头。另一方面，我想不出更好的方法来处理*File Open...*或*Print...*而我认为这是因为

*   它们是偶尔的动作，不频繁且重要，并且
*   它们本质上是原子的；您要么完成指定所有打印选项并完成它，要么取消整个节目。

让我们整理一些风格指南。建议对话是首选演示的任何用例以及首选的原因。对话框可以是非模态的吗？如果是，您如何标记事务边界，因为 Cancel 不再具有明确的含义。例如，您是否使用“应用”按钮？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-30T13:05:51.897

***IMO*** ，仅当您必须在应用程序继续之前处理对话框正在执行或询问的任何内容时，才应使用模态界面。任何其他时候，如果您使用对话框，它应该是非模态的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-30T13:13:27.387

在做非模态窗口时，您可能希望确保它们是唯一的：您并不真正想要两个相同的工具箱（例如在图形程序中）或两个相同的首选项对话框（我在一个产品中看到过），这可以是充其量是令人困惑的。

另一方面，当搜索/替换对话框是非模态的时，我很感激：我可以返回文档并取消上次更改，跳过其他地方等；不会丢失当前设置。

[不知何故，模态对话框告诉用户“停止其他一切并完成你正在做的事情”，正如斯蒂芬赖顿的回答](https://stackoverflow.com/questions/152938/when-is-modal-ui-acceptable/152945#152945)所指出的那样，它有它的用途。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T14:30:44.237

根据我的经验，在 UI 中很少有东西应该是模态的。Eclipse 就是最好的例子之一，而且可能是站点用户非常熟悉的例子。虽然它有一些模态对话框，而且我在这里只说核心 IDE，但它们主要分为三类：文件操作、首选项对话框和参数对话框。

偏好对话框虽然传统上是模态的，但也不一定是模态的。您所要做的就是查看 Mac OS 偏好模型，其中配置更改会立即发生，仅在更改可能会破坏正在进行的工作的情况下才会引入模式行为。

简而言之，这就是我要说的对模态的一个很好的总结。此集合的例外情况应通过使用来充分证明。

*   Parameter entry dialogs (example: refactoring wizards. anti-example: find dialogs)
*   File operations
*   Confirmation of an action that will take immediate disruptive effect

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-30T13:50:10.310

用户登录窗口怎么样，在您登录之前，您不能（或不应该）使用应用程序的其余部分，假设安全是必要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T14:02:47.550

我认为区别在于，如果在显示对话框时用户可以在应用程序中执行任何操作，那么它不应该是模态的。这包括复制/粘贴操作。如果文件/打开和打印对话框也不是模态的，我个人更喜欢它。我认为模态对话框是设计薄弱的标志，是让代码快速推出的必要之恶。

# progress-4gl - 在 Progress 4GL (ABL) 中不再使用 MS Excel 文件时收到通知

> ID：152946
> 
> 赞同：0
> 
> 时间：2008-09-30T13:06:59.087
> 
> 标签：progress-4gl, adm2

有一个使用 AppServer 的 GUI ADM2 Progress v9 应用程序。

它需要让用户能够查看存储在 AppServer 上的 MS Excel 文件。到目前为止：

1.  将 .xls 文件从 AppServer 拉到本地驱动器。
2.  启动 MS Excel 的副本并打开文件。

问题是，一旦不再需要本地驱动器上的临时文件，就需要将其删除。有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T05:56:15.860

您可以使用 Progress 中的 os-command 函数运行 Excel，并告诉它等到您完成查看后再返回进度代码。退出 Excel 后，对文件运行 os-delete 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-30T21:15:10.910

If you are "firing up a copy of Excel", is there any special reason you can't just point that "fired-up" Excel application at the file on your App Server?
If you are starting Excel from a command-line shell, you could just go `Excel.exe "http://myserver/myexcelbook.xls"` right?

If you are opening it via something like Office Interop Assemblies, then you can key off of the `Application.WorkBookBeforeClose` event like

```
ThisMethodHandlesTheWorkbookBeforeCloseEvent()
{
  DeleteTheFile();
} 
```

# .net - 部署工具 ENTERPRISE - 什么是最适合 Windows 环境的？

> ID：152957
> 
> 赞同：0
> 
> 时间：2008-09-30T13:12:07.127
> 
> 标签：.net, c++, windows, deployment

为所有“企业级”部署创建部署包/作业/东西的“最佳”工具是什么.....
GAC、COM+、凭据、应用程序池、网站、注册表项等...最好有办法“标记”凭据和注册表项，以便我们可以为“下一个”输入适当的凭据环境。假设企业 predev、dev、集成测试、用户测试、prod、pfix 中有 7 个环境，训练每个环境都需要它自己的一组凭据 您使用什么将内部网站迁移到您的公司环境（即使外部用户访问它)....我们将需要审核日志记录、报告、回滚、多服务器部署、从集群中删除服务器、停止服务、部署“一切”并启动一切备份然后将服务器放回集群中的能力... . 有没有人真的在使用他们喜欢的东西，那里有最少的“脚本”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-30T13:13:15.563

实际上，Power Shell

# java - 您可以在 VB.net 程序中使用 Java 库吗？

> ID：152967
> 
> 赞同：5
> 
> 时间：2008-09-30T13:14:29.117
> 
> 标签：java, vb.net

我想知道是否可以从 VB.net 应用程序调用 Java 库。

（谷歌搜索出现了很多可疑的答案，但没有确定的答案）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-30T13:18:17.343

不，你不能。除非您愿意使用一些“J#”库（与 Java 几乎不一样）或[IKVM](http://www.ikvm.net/)，后者是在 .NET 之上运行的 Java 实现，但正如他们的文档所述：

> IKVM.OpenJDK.ClassLibrary.dll：从 OpenJDK 类库派生的 Java 类库的编译版本，其中一些部分填充了来自 GNU Classpath 和 IcedTea 的代码，以及一些额外的 IKVM.NET 特定代码。

所以这不是真正的交易。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-10-31T18:41:03.320

我是[jni4net](http://jni4net.sf.net/)的作者，它是 JVM 和 CLR 之间的开源进程内桥梁。它建立在 JNI 和 PInvoke 之上。无需 C/C++ 代码。我希望它会帮助你。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T13:20:09.570

如果您以某种形式包装它以使其可访问，则可以从 .NET 调用 Java，最简单的方法通常是使用运行时桥，例如

[http://www.jnbridge.com/](http://www.jnbridge.com/)

另一种方法是用 java webservices 包装你的 API。

检查这个也[http://www.devx.com/interop/Article/19945](http://www.devx.com/interop/Article/19945)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T13:19:19.573

没有什么是开箱即用的。

我知道的大多数 java/.net 互操作都使用 Web 服务。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-30T13:19:21.053

如果您可以使用 Java 创建 COM 组件，则可以使用 tlbimp 创建一个互操作程序集以在 VB.Net 中使用。

如果可以创建可从 C++ 与 Java 一起使用的标准 DLL，则可以编写 P/Invoke 声明并从 VB.Net 调用它们。

如果您可以使用 Java 创建 Web 服务，则可以从 WSDL 生成代理类并从 VB.Net 调用它。

在任何情况下，Java 组件都有可能存在于单独的进程中。我怀疑您是否可以在同一进程中同时加载 Java VM 和 CLR。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-30T13:19:37.870

如果您有源代码并使用 J# 编译器进行编译，那么答案是肯定的。如果您想调用任何 Java 2（又名 1.2）之前的库，那么这些库几乎都包含在 J# 中。不过，最近的东西会很棘手（即，它不存在）。

商业使用的一个例子是 yWorks 的 yFiles 图形布局[算法](http://www.yworks.com/en/index.html)。这些最初只是一个 Java 库，但在过去几年中，他们一直在提供 .NET 版本，它只是用 Visual J# 编译的 Java 版本。

这并非没有问题，并且有一些您无法绕过的限制，但可以做到。所以......不幸的是，这个答案看起来也很阴暗。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T13:20:47.027

您可以使用 JNI 来实例化虚拟机，然后使用 Java 类。不过，这会很有趣，因为您需要使用 C++ 作为 VB.Net 和 Java 之间的桥梁。

Java 世界中的这篇文章有一个关于如何从 C++ 使用 Java 的快速教程，反之亦然。

[http://www.javaworld.com/javaworld/javatips/jw-javatip17.html](http://www.javaworld.com/javaworld/javatips/jw-javatip17.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T13:24:41.290

如果您有源代码，Visual Studio 将允许您将 Java 代码转换为 C#。

# perl - 如何在 Perl 中将数字转换为多重形式？

> ID：152968
> 
> 赞同：7
> 
> 时间：2008-09-30T13:14:31.283
> 
> 标签：perl, format, numbers

您是否知道一种简单直接的方法/子/模块，它允许我将数字（例如 1234567.89）转换为易于阅读的形式 - 例如 1.23M？

现在我可以通过多次比较来做到这一点，但我对我的方法不满意：

```
if($bytes > 1000000000){ 
   $bytes = ( sprintf( "%0.2f", $bytes/1000000000 )). " Gb/s";                   
}
elsif ($bytes > 1000000){       
   $bytes = ( sprintf( "%0.2f", $bytes/1000000 )). " Mb/s"; 
}
elsif ($bytes > 1000){
   $bytes = ( sprintf( "%0.2f", $bytes/1000 )). " Kb/s"; 
}
else{ 
   $bytes = sprintf( "%0.2f", $bytes ). "b/s";
} 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-09-30T13:18:04.770

[Number::Bytes::Human](http://search.cpan.org/dist/Number-Bytes-Human)模块应该能够帮助您。

可以在其概要中找到如何使用它的示例：

```
 use Number::Bytes::Human qw(format_bytes);

  $size = format_bytes(0); # '0'
  $size = format_bytes(2*1024); # '2.0K'

  $size = format_bytes(1_234_890, bs => 1000); # '1.3M'
  $size = format_bytes(1E9, bs => 1000); # '1.0G'

  # the OO way
  $human = Number::Bytes::Human->new(bs => 1000, si => 1);
  $size = $human->format(1E7); # '10MB'
  $human->set_options(zero => '-');
  $size = $human->format(0); # '-' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T13:18:52.757

[Number::Bytes::Human](http://search.cpan.org/perldoc?Number::Bytes::Human)似乎完全按照您的意愿行事。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T13:27:32.703

在纯 Perl 形式中，我使用嵌套的三元运算符来减少冗长：

```
sub BytesToReadableString($) {
   my $c = shift;
   $c >= 1073741824 ? sprintf("%0.2fGB", $c/1073741824)
      : $c >= 1048576 ? sprintf("%0.2fMB", $c/1048576)
      : $c >= 1024 ? sprintf("%0.2fKB", $c/1024)
      : $c . "bytes";
}

print BytesToReadableString(225939) . "/s\n"; 
```

输出：

```
220.64KB/秒
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T14:23:46.750

```
sub magnitudeformat {
  my $val = shift;
  my $expstr;

  my $exp = log($val) / log(10);
     if ($exp < 3)  { return $val;   }
  elsif ($exp < 6)  { $exp = 3;  $expstr = "K"; }
  elsif ($exp < 9)  { $exp = 6;  $expstr = "M"; }
  elsif ($exp < 12) { $exp = 9;  $expstr = "G"; } # Or "B".
  else              { $exp = 12; $expstr = "T"; }

  return sprintf("%0.1f%s", $val/(10**$exp), $expstr);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T13:30:36.660

这个片段是用 PHP 编写的，它大致基于其他人在他们网站上某个地方的一些示例（对不起，伙计，我不记得了）。

基本概念是使用循环而不是使用 if。

```
function formatNumberThousands($a,$dig)
{
    $unim = array("","k","m","g");
    $c = 0;
    while ($a>=1000 && $c<=3) {
        $c++;
        $a = $a/1000;
    }
    $d = $dig-ceil(log10($a));
    return number_format($a,($c ? $d : 0))."".$unim[$c];
} 
```

number_format() 调用是一个 PHP 库函数，它返回一个包含数千组之间逗号的字符串。我不确定perl中是否存在类似的东西。

$dig 参数设置了要显示的位数的限制。如果 $dig 是 2，它会给你 1237 的 1.2k。

要格式化字节，只需除以 1024。

时至今日，该函数仍在一些生产代码中使用。

# javascript - 如何检测元素外的点击？

> ID：152975
> 
> 赞同：2756
> 
> 时间：2008-09-30T13:17:12.340
> 
> 标签：javascript, jquery, click

我有一些 HTML 菜单，当用户单击这些菜单的头部时，我会完全显示这些菜单。当用户在菜单区域之外单击时，我想隐藏这些元素。

jQuery可以做到这样的事情吗？

```
$("#menuscontainer").clickOutsideThisElement(function() {
    // Hide the menus
}); 
```

* * *

## 回答 #1

> 赞同：1948
> 
> 时间：2008-09-30T13:38:11.133

> 注意：使用`stopPropagation`是应该避免的，因为它会破坏 DOM 中的正常事件流。有关更多信息，请参阅[这篇 CSS 技巧文章](https://css-tricks.com/dangers-stopping-event-propagation/)。请考虑改用[此方法](https://stackoverflow.com/a/3028037/561309)。

将单击事件附加到关闭窗口的文档正文。将单独的单击事件附加到容器，以停止传播到文档正文。

```
$(window).click(function() {
  //Hide the menus if visible
});

$('#menucontainer').click(function(event){
  event.stopPropagation();
}); 
```

* * *

## 回答 #2

> 赞同：1541
> 
> 时间：2010-06-12T08:35:55.927

您可以侦听**单击**事件`document`，然后使用 确保`#menucontainer`不是被单击元素的祖先或目标 [`.closest()`](http://api.jquery.com/closest/)。

如果不是，则单击的元素在外部，`#menucontainer`您可以安全地隐藏它。

```
$(document).click(function(event) { 
  var $target = $(event.target);
  if(!$target.closest('#menucontainer').length && 
  $('#menucontainer').is(":visible")) {
    $('#menucontainer').hide();
  }        
}); 
```

### 编辑 – 2017-06-23

如果您打算关闭菜单并希望停止侦听事件，您也可以在事件侦听器之后进行清理。此函数将仅清理新创建的侦听器，保留任何其他点击侦听器`document`。使用 ES2015 语法：

```
export function hideOnClickOutside(selector) {
  const outsideClickListener = (event) => {
    const $target = $(event.target);
    if (!$target.closest(selector).length && $(selector).is(':visible')) {
        $(selector).hide();
        removeClickListener();
    }
  }

  const removeClickListener = () => {
    document.removeEventListener('click', outsideClickListener)
  }

  document.addEventListener('click', outsideClickListener)
} 
```

### 编辑 – 2018-03-11

对于那些不想使用 jQuery 的人。这是普通 vanillaJS (ECMAScript6) 中的上述代码。

```
function hideOnClickOutside(element) {
    const outsideClickListener = event => {
        if (!element.contains(event.target) && isVisible(element)) { // or use: event.target.closest(selector) === null
          element.style.display = 'none'
          removeClickListener()
        }
    }

    const removeClickListener = () => {
        document.removeEventListener('click', outsideClickListener)
    }

    document.addEventListener('click', outsideClickListener)
}

const isVisible = elem => !!elem && !!( elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length ) // source (2018-03-11): https://github.com/jquery/jquery/blob/master/src/css/hiddenVisibleSelectors.js 
```

**注意：** 这是基于 Alex 的评论，只是使用`!element.contains(event.target)`而不是 jQuery 部分。

但`element.closest()`现在在所有主流浏览器中也可用（W3C 版本与 jQuery 版本略有不同）。Polyfill 可以在这里找到：[Element.closest()](https://developer.mozilla.org/en-US/docs/Web/API/Element/closest)

### 编辑 – 2020-05-21

如果您希望用户能够在元素内部单击并拖动，然后在元素外部释放鼠标，而不关闭元素：

```
 ...
      let lastMouseDownX = 0;
      let lastMouseDownY = 0;
      let lastMouseDownWasOutside = false;

      const mouseDownListener = (event: MouseEvent) => {
        lastMouseDownX = event.offsetX
        lastMouseDownY = event.offsetY
        lastMouseDownWasOutside = !$(event.target).closest(element).length
      }
      document.addEventListener('mousedown', mouseDownListener); 
```

并在`outsideClickListener`：

```
const outsideClickListener = event => {
        const deltaX = event.offsetX - lastMouseDownX
        const deltaY = event.offsetY - lastMouseDownY
        const distSq = (deltaX * deltaX) + (deltaY * deltaY)
        const isDrag = distSq > 3
        const isDragException = isDrag && !lastMouseDownWasOutside

        if (!element.contains(event.target) && isVisible(element) && !isDragException) { // or use: event.target.closest(selector) === null
          element.style.display = 'none'
          removeClickListener()
          document.removeEventListener('mousedown', mouseDownListener); // Or add this line to removeClickListener()
        }
    } 
```

* * *

## 回答 #3

> 赞同：379
> 
> 时间：2016-07-11T23:29:46.630

> 如何检测元素外的点击？

这个问题如此受欢迎并且有这么多答案的原因是它看起来很复杂。经过近八年和几十个答案，我真的很惊讶看到对可访问性的关注如此之少。

> 当用户在菜单区域之外单击时，我想隐藏这些元素。

这是一个崇高的事业，也是*真正*的问题。问题的标题——这是大多数答案似乎试图解决的问题——包含一个不幸的红鲱鱼。

**提示：是*“点击”*这个词！**

# 您实际上并不想绑定点击处理程序。

如果您正在绑定单击处理程序以关闭对话框，那么您已经失败了。你失败的原因是不是每个人都会触发`click`事件。不使用鼠标的用户将能够通过按 退出您的对话框（并且您的弹出菜单可以说是一种对话框）`Tab`，然后他们将无法在不触发`click`事件的情况下阅读对话框后面的内容。

所以让我们重新表述这个问题。

> 当用户完成对话框时如何关闭它？

这是目标。不幸的是，现在我们需要绑定`userisfinishedwiththedialog`事件，而绑定并不是那么简单。

那么我们如何才能检测到用户已经使用完一个对话框呢？

## `focusout`事件

一个好的开始是确定焦点是否离开了对话框。

**提示：小心`blur`事件，`blur`如果事件绑定到冒泡阶段，则不会传播！**

jQuery[`focusout`](http://api.jquery.com/focusout/)会做得很好。如果你不能使用 jQuery，那么你可以`blur`在捕获阶段使用：

```
element.addEventListener('blur', ..., true);
//                       use capture: ^^^^ 
```

此外，对于许多对话框，您需要让容器获得焦点。添加`tabindex="-1"`以允许对话框动态接收焦点，而不会中断选项卡流。

```
$('a').on('click', function () {
  $(this.hash).toggleClass('active').focus();
});

$('div').on('focusout', function () {
  $(this).removeClass('active');
});
```

```
div {
  display: none;
}
.active {
  display: block;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<a href="#example">Example</a>
<div id="example" tabindex="-1">
  Lorem ipsum <a href="http://example.com">dolor</a> sit amet.
</div>
```

* * *

如果您使用该演示超过一分钟，您应该很快就会开始看到问题。

首先是对话框中的链接不可点击。尝试单击它或使用选项卡将导致对话框在交互发生之前关闭。这是因为聚焦内部元素会在再次触发`focusout`事件之前触发`focusin`事件。

解决方法是在事件循环中对状态更改进行排队。这可以通过使用`setImmediate(...)`或`setTimeout(..., 0)`不支持的浏览器来完成`setImmediate`。一旦排队，它可以被后续取消`focusin`：

```
$('.submenu').on({
  focusout: function (e) {
    $(this).data('submenuTimer', setTimeout(function () {
      $(this).removeClass('submenu--active');
    }.bind(this), 0));
  },
  focusin: function (e) {
    clearTimeout($(this).data('submenuTimer'));
  }
}); 
```

```
$('a').on('click', function () {
  $(this.hash).toggleClass('active').focus();
});

$('div').on({
  focusout: function () {
    $(this).data('timer', setTimeout(function () {
      $(this).removeClass('active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this).data('timer'));
  }
});
```

```
div {
  display: none;
}
.active {
  display: block;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<a href="#example">Example</a>
<div id="example" tabindex="-1">
  Lorem ipsum <a href="http://example.com">dolor</a> sit amet.
</div>
```

第二个问题是再次按下链接时对话框不会关闭。这是因为对话框失去焦点，触发关闭行为，之后点击链接触发对话框重新打开。

与上一期类似，需要对焦点状态进行管理。鉴于状态更改已经排队，只需处理对话框触发器上的焦点事件即可：

[这应该看起来很熟悉]

```
$('a').on({
  focusout: function () {
    $(this.hash).data('timer', setTimeout(function () {
      $(this.hash).removeClass('active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this.hash).data('timer'));  
  }
}); 
```

```
$('a').on('click', function () {
  $(this.hash).toggleClass('active').focus();
});

$('div').on({
  focusout: function () {
    $(this).data('timer', setTimeout(function () {
      $(this).removeClass('active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this).data('timer'));
  }
});

$('a').on({
  focusout: function () {
    $(this.hash).data('timer', setTimeout(function () {
      $(this.hash).removeClass('active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this.hash).data('timer'));  
  }
});
```

```
div {
  display: none;
}
.active {
  display: block;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<a href="#example">Example</a>
<div id="example" tabindex="-1">
  Lorem ipsum <a href="http://example.com">dolor</a> sit amet.
</div>
```

* * *

## `Esc`钥匙

如果您认为处理焦点状态已经完成，那么您可以做更多的事情来简化用户体验。

这通常是一个“很高兴拥有”的功能，但是当您有任何类型的模式或弹出窗口时，该`Esc`键会将其关闭是很常见的。

```
keydown: function (e) {
  if (e.which === 27) {
    $(this).removeClass('active');
    e.preventDefault();
  }
} 
```

```
$('a').on('click', function () {
  $(this.hash).toggleClass('active').focus();
});

$('div').on({
  focusout: function () {
    $(this).data('timer', setTimeout(function () {
      $(this).removeClass('active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this).data('timer'));
  },
  keydown: function (e) {
    if (e.which === 27) {
      $(this).removeClass('active');
      e.preventDefault();
    }
  }
});

$('a').on({
  focusout: function () {
    $(this.hash).data('timer', setTimeout(function () {
      $(this.hash).removeClass('active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this.hash).data('timer'));  
  }
});
```

```
div {
  display: none;
}
.active {
  display: block;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<a href="#example">Example</a>
<div id="example" tabindex="-1">
  Lorem ipsum <a href="http://example.com">dolor</a> sit amet.
</div>
```

* * *

如果您知道对话框中有可聚焦的元素，则无需直接聚焦对话框。如果您正在构建菜单，则可以改为关注第一个菜单项。

```
click: function (e) {
  $(this.hash)
    .toggleClass('submenu--active')
    .find('a:first')
    .focus();
  e.preventDefault();
} 
```

```
$('.menu__link').on({
  click: function (e) {
    $(this.hash)
      .toggleClass('submenu--active')
      .find('a:first')
      .focus();
    e.preventDefault();
  },
  focusout: function () {
    $(this.hash).data('submenuTimer', setTimeout(function () {
      $(this.hash).removeClass('submenu--active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this.hash).data('submenuTimer'));  
  }
});

$('.submenu').on({
  focusout: function () {
    $(this).data('submenuTimer', setTimeout(function () {
      $(this).removeClass('submenu--active');
    }.bind(this), 0));
  },
  focusin: function () {
    clearTimeout($(this).data('submenuTimer'));
  },
  keydown: function (e) {
    if (e.which === 27) {
      $(this).removeClass('submenu--active');
      e.preventDefault();
    }
  }
});
```

```
.menu {
  list-style: none;
  margin: 0;
  padding: 0;
}
.menu:after {
  clear: both;
  content: '';
  display: table;
}
.menu__item {
  float: left;
  position: relative;
}

.menu__link {
  background-color: lightblue;
  color: black;
  display: block;
  padding: 0.5em 1em;
  text-decoration: none;
}
.menu__link:hover,
.menu__link:focus {
  background-color: black;
  color: lightblue;
}

.submenu {
  border: 1px solid black;
  display: none;
  left: 0;
  list-style: none;
  margin: 0;
  padding: 0;
  position: absolute;
  top: 100%;
}
.submenu--active {
  display: block;
}

.submenu__item {
  width: 150px;
}

.submenu__link {
  background-color: lightblue;
  color: black;
  display: block;
  padding: 0.5em 1em;
  text-decoration: none;
}

.submenu__link:hover,
.submenu__link:focus {
  background-color: black;
  color: lightblue;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<ul class="menu">
  <li class="menu__item">
    <a class="menu__link" href="#menu-1">Menu 1</a>
    <ul class="submenu" id="menu-1" tabindex="-1">
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#1">Example 1</a></li>
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#2">Example 2</a></li>
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#3">Example 3</a></li>
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#4">Example 4</a></li>
    </ul>
  </li>
  <li class="menu__item">
    <a  class="menu__link" href="#menu-2">Menu 2</a>
    <ul class="submenu" id="menu-2" tabindex="-1">
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#1">Example 1</a></li>
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#2">Example 2</a></li>
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#3">Example 3</a></li>
      <li class="submenu__item"><a class="submenu__link" href="http://example.com/#4">Example 4</a></li>
    </ul>
  </li>
</ul>
lorem ipsum <a href="http://example.com/">dolor</a> sit amet.
```

* * *

# WAI-ARIA 角色和其他辅助功能支持

这个答案希望涵盖此功能的可访问键盘和鼠标支持的基础知识，但由于它已经相当大，我将避免讨论[WAI-ARIA 角色和属性](https://www.w3.org/TR/wai-aria/)，但是我*强烈*建议实施者参考规范以获取详细信息他们应该使用什么角色以及任何其他适当的属性。

* * *

## 回答 #4

> 赞同：164
> 
> 时间：2009-07-06T23:10:07.377

这里的其他解决方案对我不起作用，所以我不得不使用：

```
if(!$(event.target).is('#foo'))
{
    // hide menu
} 
```

## 编辑：纯 Javascript 变体 (2021-03-31)

我使用这种方法来处理在单击外部时关闭下拉菜单。

首先，我为组件的所有元素创建了一个自定义类名。此类名称将添加到构成菜单小部件的所有元素中。

```
const className = `dropdown-${Date.now()}-${Math.random() * 100}`; 
```

我创建了一个函数来检查点击和被点击元素的类名。如果单击的元素不包含我上面生成的自定义类名，它应该将`show`标志设置为`false`并且菜单将关闭。

```
const onClickOutside = (e) => {
  if (!e.target.className.includes(className)) {
    show = false;
  }
}; 
```

然后我将点击处理程序附加到窗口对象。

```
// add when widget loads
window.addEventListener("click", onClickOutside); 
```

...最后是一些家政服务

```
// remove listener when destroying the widget
window.removeEventListener("click", onClickOutside); 
```

* * *

## 回答 #5

> 赞同：133
> 
> 时间：2008-09-30T18:13:39.537

我有一个与 Eran 的示例类似的应用程序，除了我在打开菜单时将点击事件附加到正文......有点像这样：

```
$('#menucontainer').click(function(event) {
  $('html').one('click',function() {
    // Hide the menus
  });

  event.stopPropagation();
}); 
```

更多关于[jQuery`one()`函数的信息](http://docs.jquery.com/Events/one)

* * *

## 回答 #6

> 赞同：77
> 
> 时间：2020-11-03T15:30:37.457

## 现在是 2020 年，您可以使用`event.composedPath()`

来自：[https ://developer.mozilla.org/en-US/docs/Web/API/Event/composedPath](https://developer.mozilla.org/en-US/docs/Web/API/Event/composedPath)

> Event 接口的composedPath() 方法返回事件的路径，该路径是一个对象数组，将在其上调用侦听器。

```
const target = document.querySelector('#myTarget')

document.addEventListener('click', (event) => {
  const withinBoundaries = event.composedPath().includes(target)

  if (withinBoundaries) {
    target.innerText = 'Click happened inside element'
  } else {
    target.innerText = 'Click happened **OUTSIDE** element'
  } 
})
```

```
/* just to make it good looking. you don't need this */
#myTarget {
  margin: 50px auto;
  width: 500px;
  height: 500px;
  background: gray;
  border: 10px solid black;
}
```

```
<div id="myTarget">
  click me (or not!)
</div>
```

* * *

## 回答 #7

> 赞同：53
> 
> 时间：2015-11-02T08:33:34.373

经过研究，我找到了三个可行的解决方案（我忘记了参考的页面链接）

## 第一个解决方案

```
<script>
    //The good thing about this solution is it doesn't stop event propagation.

    var clickFlag = 0;
    $('body').on('click', function () {
        if(clickFlag == 0) {
            console.log('hide element here');
            /* Hide element here */
        }
        else {
            clickFlag=0;
        }
    });
    $('body').on('click','#testDiv', function (event) {
        clickFlag = 1;
        console.log('showed the element');
        /* Show the element */
    });
</script> 
```

## 第二种解决方案

```
<script>
    $('body').on('click', function(e) {
        if($(e.target).closest('#testDiv').length == 0) {
           /* Hide dropdown here */
        }
    });
</script> 
```

## 第三个解决方案

```
<script>
    var specifiedElement = document.getElementById('testDiv');
    document.addEventListener('click', function(event) {
        var isClickInside = specifiedElement.contains(event.target);
        if (isClickInside) {
          console.log('You clicked inside')
        }
        else {
          console.log('You clicked outside')
        }
    });
</script> 
```

* * *

## 回答 #8

> 赞同：43
> 
> 时间：2009-11-17T06:13:44.147

```
$("#menuscontainer").click(function() {
    $(this).focus();
});
$("#menuscontainer").blur(function(){
    $(this).hide();
}); 
```

对我有用。

* * *

## 回答 #9

> 赞同：38
> 
> 时间：2010-04-05T10:07:36.267

现在有一个插件：[外部事件](https://github.com/cowboy/jquery-outside-events)（[博客文章](http://benalman.com/projects/jquery-outside-events-plugin/)）

当*clickoutside*处理程序 (WLOG) 绑定到元素时会发生以下情况：

*   该元素被添加到一个数组中，该数组包含所有带有*clickoutside*处理程序的元素
*   （[命名空间](http://docs.jquery.com/Namespaced_Events)）*点击*处理程序绑定到文档（如果还没有）
*   在文档中的任何*点击*上，都会为该数组中不等于*click* -events 目标或它的父级的那些元素触发*clickoutside事件*
**   此外，*clickoutside*事件的 event.target 设置为用户单击的元素（因此您甚至知道用户单击了什么，而不仅仅是他单击了外部）*

 *因此，不会停止传播任何事件，并且可以在带有外部处理程序的元素“上方”使用额外的*单击*处理程序。

* * *

## 回答 #10

> 赞同：33
> 
> 时间：2012-06-04T14:08:27.180

这对我来说非常有效！

```
$('html').click(function (e) {
    if (e.target.id == 'YOUR-DIV-ID') {
        //do something
    } else {
        //do something
    }
}); 
```

* * *

## 回答 #11

> 赞同：28
> 
> 时间：2015-12-15T03:50:58.497

这种情况的一个简单解决方案是：

```
$(document).mouseup(function (e)
{
    var container = $("YOUR SELECTOR"); // Give you class or ID

    if (!container.is(e.target) &&            // If the target of the click is not the desired div or section
        container.has(e.target).length === 0) // ... nor a descendant-child of the container
    {
        container.hide();
    }
}); 
```

上面的脚本将隐藏`div`如果`div`点击事件之外的触发。

您可以查看以下博客了解更多信息： http: [//www.codecanal.com/detect-click-outside-div-using-javascript/](http://www.codecanal.com/detect-click-outside-div-using-javascript/)

* * *

## 回答 #12

> 赞同：26
> 
> 时间：2011-05-18T21:15:19.563

我认为您真正需要的不是当用户在外面点击时关闭菜单；您需要的是当用户单击页面上的任何位置时关闭菜单。如果您单击菜单，或关闭菜单，它应该关闭吗？

在上面找不到令人满意的答案促使我前几天写[了这篇博](http://programming34m0.blogspot.com/2011/05/simplifying-javascript-jump-menu.html)文。对于更迂腐的人，有一些问题需要注意：

1.  如果在单击时将单击事件处理程序附加到正文元素，请确保在关闭菜单之前等待第二次单击，并取消绑定事件。否则，打开菜单的单击事件将冒泡到必须关闭菜单的侦听器。
2.  如果您在单击事件上使用 event.stopPropogation()，则页面中的任何其他元素都不能具有单击任意位置关闭功能。
3.  无限期地将单击事件处理程序附加到正文元素不是一个高性能的解决方案
4.  将事件的目标及其父事件与处理程序的创建者进行比较，假设您想要的是在您单击它时关闭菜单，而您真正想要的是在您单击页面上的任何位置时关闭它。
5.  监听 body 元素上的事件会使你的代码更脆弱。像这样无辜的造型会破坏它：`body { margin-left:auto; margin-right: auto; width:960px;}`

* * *

## 回答 #13

> 赞同：26
> 
> 时间：2011-12-22T11:59:02.103

正如另一位海报所说，有很多陷阱，特别是如果您正在显示的元素（在本例中为菜单）具有交互元素。我发现以下方法相当稳健：

```
$('#menuscontainer').click(function(event) {
    //your code that shows the menus fully

    //now set up an event listener so that clicking anywhere outside will close the menu
    $('html').click(function(event) {
        //check up the tree of the click target to check whether user has clicked outside of menu
        if ($(event.target).parents('#menuscontainer').length==0) {
            // your code to hide menu

            //this event listener has done its job so we can unbind it.
            $(this).unbind(event);
        }

    })
}); 
```

* * *

## 回答 #14

> 赞同：22
> 
> 时间：2008-09-30T13:20:30.023

检查窗口单击事件目标（它应该传播到窗口，只要它没有在其他任何地方捕获），并确保它不是任何菜单元素。如果不是，那么你就在你的菜单之外。

或者检查点击的位置，看看它是否包含在菜单区域内。

* * *

## 回答 #15

> 赞同：21
> 
> 时间：2015-01-28T17:24:20.657

## **解决方案1**

不要使用可能有一些副作用的 event.stopPropagation()，只需定义一个简单的标志变量并添加一个`if`条件。我对此进行了测试并正常工作，没有 stopPropagation 的任何副作用：

```
var flag = "1";
$('#menucontainer').click(function(event){
    flag = "0"; // flag 0 means click happened in the area where we should not do any action
});

$('html').click(function() {
    if(flag != "0"){
        // Hide the menus if visible
    }
    else {
        flag = "1";
    }
}); 
```

## **解决方案2**

只需一个简单的`if`条件：

```
$(document).on('click', function(event){
    var container = $("#menucontainer");
    if (!container.is(event.target) &&            // If the target of the click isn't the container...
        container.has(event.target).length === 0) // ... nor a descendant of the container
    {
        // Do whatever you want to do when click is outside the element
    }
}); 
```

* * *

## 回答 #16

> 赞同：20
> 
> 时间：2018-02-12T10:39:21.083

我很惊讶没有人真正承认[`focusout`](https://developer.mozilla.org/en-US/docs/Web/API/Element/focusout_event)事件：

```
var button = document.getElementById('button');
button.addEventListener('click', function(e){
  e.target.style.backgroundColor = 'green';
});
button.addEventListener('focusout', function(e){
  e.target.style.backgroundColor = '';
});
```

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
</head>
<body>
  <button id="button">Click</button>
</body>
</html>
```

* * *

## 回答 #17

> 赞同：19
> 
> 时间：2010-12-02T09:53:12.453

我在这样的事情上取得了成功：

```
var $menuscontainer = ...;

$('#trigger').click(function() {
  $menuscontainer.show();

  $('body').click(function(event) {
    var $target = $(event.target);

    if ($target.parents('#menuscontainer').length == 0) {
      $menuscontainer.hide();
    }
  });
}); 
```

逻辑是：当显示时，将单击处理程序绑定到仅当（单击的）目标不是它的子对象时才`#menuscontainer`隐藏的主体。`#menuscontainer`

* * *

## 回答 #18

> 赞同：17
> 
> 时间：2017-04-14T04:27:58.843

该事件有一个名为 event.path 的元素的属性，它是*“按树顺序排列其所有祖先的静态有序列表”*。要检查事件是否源自特定 DOM 元素或其子元素之一，只需检查该特定 DOM 元素的路径。它还可以用于通过在函数`OR`中对元素检查进行逻辑检查来检查多个元素。`some`

```
$("body").click(function() {
  target = document.getElementById("main");
  flag = event.path.some(function(el, i, arr) {
    return (el == target)
  })
  if (flag) {
    console.log("Inside")
  } else {
    console.log("Outside")
  }
});
```

```
#main {
  display: inline-block;
  background:yellow;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="main">
  <ul>
    <li>Test-Main</li>
    <li>Test-Main</li>
    <li>Test-Main</li>
    <li>Test-Main</li>
    <li>Test-Main</li>
  </ul>
</div>
<div id="main2">
  Outside Main
</div>
```

所以对于你的情况应该是

```
$("body").click(function() {
  target = $("#menuscontainer")[0];
  flag = event.path.some(function(el, i, arr) {
    return (el == target)
  });
  if (!flag) {
    // Hide the menus
  }
}); 
```

* * *

## 回答 #19

> 赞同：16
> 
> 时间：2014-07-24T09:41:53.297

作为变体：

```
var $menu = $('#menucontainer');
$(document).on('click', function (e) {

    // If element is opened and click target is outside it, hide it
    if ($menu.is(':visible') && !$menu.is(e.target) && !$menu.has(e.target).length) {
        $menu.hide();
    }
}); 
```

[它在停止事件传播](http://css-tricks.com/dangers-stopping-event-propagation/)方面没有问题，并且更好地支持同一页面上的多个菜单，其中在第一个菜单打开时单击第二个菜单将使第一个菜单在 stopPropagation 解决方案中保持打开状态。

* * *

## 回答 #20

> 赞同：14
> 
> 时间：2011-07-28T14:06:37.990

我在一些 jQuery 日历插件中找到了这个方法。

```
function ClickOutsideCheck(e)
{
  var el = e.target;
  var popup = $('.popup:visible')[0];
  if (popup==undefined)
    return true;

  while (true){
    if (el == popup ) {
      return true;
    } else if (el == document) {
      $(".popup").hide();
      return false;
    } else {
      el = $(el).parent()[0];
    }
  }
};

$(document).bind('mousedown.popup', ClickOutsideCheck); 
```

* * *

## 回答 #21

> 赞同：14
> 
> 时间：2015-05-19T22:52:49.757

这是面向未来观众的 vanilla JavaScript 解决方案。

单击文档中的任何元素时，如果单击的元素的 id 被切换，或者隐藏的元素未隐藏且隐藏的元素不包含单击的元素，则切换该元素。

```
(function () {
    "use strict";
    var hidden = document.getElementById('hidden');
    document.addEventListener('click', function (e) {
        if (e.target.id == 'toggle' || (hidden.style.display != 'none' && !hidden.contains(e.target))) hidden.style.display = hidden.style.display == 'none' ? 'block' : 'none';
    }, false);
})(); 
```

```
(function () {
    "use strict";
    var hidden = document.getElementById('hidden');
    document.addEventListener('click', function (e) {
        if (e.target.id == 'toggle' || (hidden.style.display != 'none' && !hidden.contains(e.target))) hidden.style.display = hidden.style.display == 'none' ? 'block' : 'none';
    }, false);
})();
```

```
<a href="javascript:void(0)" id="toggle">Toggle Hidden Div</a>
<div id="hidden" style="display: none;">This content is normally hidden. click anywhere other than this content to make me disappear</div>
```

如果您要在同一页面上进行多个切换，则可以使用以下内容：

1.  将类名添加`hidden`到可折叠项。
2.  单击文档时，关闭所有不包含单击元素且未隐藏的隐藏元素
3.  如果单击的元素是切换，则切换指定的元素。

```
(function () {
    "use strict";
    var hiddenItems = document.getElementsByClassName('hidden'), hidden;
    document.addEventListener('click', function (e) {
        for (var i = 0; hidden = hiddenItems[i]; i++) {
            if (!hidden.contains(e.target) && hidden.style.display != 'none')
                hidden.style.display = 'none';
        }
        if (e.target.getAttribute('data-toggle')) {
            var toggle = document.querySelector(e.target.getAttribute('data-toggle'));
            toggle.style.display = toggle.style.display == 'none' ? 'block' : 'none';
        }
    }, false);
})();
```

```
<a href="javascript:void(0)" data-toggle="#hidden1">Toggle Hidden Div</a>
<div class="hidden" id="hidden1" style="display: none;" data-hidden="true">This content is normally hidden</div>
<a href="javascript:void(0)" data-toggle="#hidden2">Toggle Hidden Div</a>
<div class="hidden" id="hidden2" style="display: none;" data-hidden="true">This content is normally hidden</div>
<a href="javascript:void(0)" data-toggle="#hidden3">Toggle Hidden Div</a>
<div class="hidden" id="hidden3" style="display: none;" data-hidden="true">This content is normally hidden</div>
```

* * *

## 回答 #22

> 赞同：10
> 
> 时间：2021-04-10T16:42:42.297

### 用于`focusout`可访问性

这里有一个答案说（非常正确）关注`click`事件是一个可访问性问题，因为我们想要满足键盘用户的需求。该`focusout`事件是在这里使用的正确方法，但它可以比其他答案更简单（也可以在纯 javascript 中）：

### 一种更简单的方法：

使用的“问题”`focusout`是，如果对话框/模态/菜单中的元素失去焦点，那么事件仍然会被触发。我们可以通过查看`event.relatedTarget`（它告诉我们哪个元素将获得焦点）来检查情况是否如此。

```
dialog = document.getElementById("dialogElement")

dialog.addEventListener("focusout", function (event) {
    if (
        // we are still inside the dialog so don't close
        dialog.contains(event.relatedTarget) ||
        // we have switched to another tab so probably don't want to close 
        !document.hasFocus()  
    ) {
        return;
    }
    dialog.close();  // or whatever logic you want to use to close
}); 
```

上面有一个小问题，那就是`relatedTarget`可能`null`。如果用户在对话框外部单击，这很好，但如果除非用户在对话框内部单击并且对话框碰巧不可聚焦，那么这将是一个问题。要解决此问题，您必须确保设置`tabIndex=0`为可聚焦对话框。

* * *

## 回答 #23

> 赞同：8
> 
> 时间：2009-08-14T14:08:21.577

如果您正在为 IE 和 FF 3.* 编写脚本，并且您只想知道点击是否发生在某个框区域内，您还可以使用以下内容：

```
this.outsideElementClick = function(objEvent, objElement){   
var objCurrentElement = objEvent.target || objEvent.srcElement;
var blnInsideX = false;
var blnInsideY = false;

if (objCurrentElement.getBoundingClientRect().left >= objElement.getBoundingClientRect().left && objCurrentElement.getBoundingClientRect().right <= objElement.getBoundingClientRect().right)
    blnInsideX = true;

if (objCurrentElement.getBoundingClientRect().top >= objElement.getBoundingClientRect().top && objCurrentElement.getBoundingClientRect().bottom <= objElement.getBoundingClientRect().bottom)
    blnInsideY = true;

if (blnInsideX && blnInsideY)
    return false;
else
    return true;} 
```

* * *

## 回答 #24

> 赞同：8
> 
> 时间：2011-01-09T23:47:54.120

采用：

```
var go = false;
$(document).click(function(){
    if(go){
        $('#divID').hide();
        go = false;
    }
})

$("#divID").mouseover(function(){
    go = false;
});

$("#divID").mouseout(function (){
    go = true;
});

$("btnID").click( function(){
    if($("#divID:visible").length==1)
        $("#divID").hide(); // Toggle
    $("#divID").show();
}); 
```

* * *

## 回答 #25

> 赞同：8
> 
> 时间：2013-06-05T15:05:20.813

而不是使用流中断、模糊/焦点事件或任何其他棘手的技术，只需将事件流与元素的亲属关系匹配：

```
$(document).on("click.menu-outside", function(event){
    // Test if target and it's parent aren't #menuscontainer
    // That means the click event occur on other branch of document tree
    if(!$(event.target).parents().andSelf().is("#menuscontainer")){
        // Click outisde #menuscontainer
        // Hide the menus (but test if menus aren't already hidden)
    }
}); 
```

要删除事件侦听器外部的点击，只需：

```
$(document).off("click.menu-outside"); 
```

* * *

## 回答 #26

> 赞同：7
> 
> 时间：2017-07-18T00:43:37.830

如果有人在这里好奇是javascript解决方案（es6）：

```
window.addEventListener('mouseup', e => {
        if (e.target != yourDiv && e.target.parentNode != yourDiv) {
            yourDiv.classList.remove('show-menu');
            //or yourDiv.style.display = 'none';
        }
    }) 
```

和 es5，以防万一：

```
window.addEventListener('mouseup', function (e) {
if (e.target != yourDiv && e.target.parentNode != yourDiv) {
    yourDiv.classList.remove('show-menu'); 
    //or yourDiv.style.display = 'none';
} 
```

});

* * *

## 回答 #27

> 赞同：7
> 
> 时间：2017-11-03T07:50:37.967

这是纯javascript的简单解决方案。它是**最新的 ES6**：

```
var isMenuClick = false;
var menu = document.getElementById('menuscontainer');
document.addEventListener('click',()=>{
    if(!isMenuClick){
       //Hide the menu here
    }
    //Reset isMenuClick 
    isMenuClick = false;
})
menu.addEventListener('click',()=>{
    isMenuClick = true;
}) 
```

* * *

## 回答 #28

> 赞同：7
> 
> 时间：2018-01-14T08:29:37.370

我使用了下面的脚本并使用 jQuery 完成。

```
jQuery(document).click(function(e) {
    var target = e.target; //target div recorded
    if (!jQuery(target).is('#tobehide') ) {
        jQuery(this).fadeOut(); //if the click element is not the above id will hide
    }
}) 
```

下面找到HTML代码

```
<div class="main-container">
<div> Hello I am the title</div>
<div class="tobehide">I will hide when you click outside of me</div>
</div> 
```

[你可以在这里](http://tutsplanet.com/trigger-function-clicks-outside-element-jquery-492/)阅读教程

* * *

## 回答 #29

> 赞同：7
> 
> 时间：2020-06-30T12:25:12.093

2020 年使用原生 JS API[最接近](https://developer.mozilla.org/en-US/docs/Web/API/Element/closest)方法的解决方案。

```
document.addEventListener('click', ({ target }) => {
  if (!target.closest('.el1, .el2, #el3')) {
    alert('click outside')
  }
}) 
```

* * *

## 回答 #30

> 赞同：6
> 
> 时间：2011-09-20T18:44:18.747

```
$(document).click(function() {
    $(".overlay-window").hide();
});
$(".overlay-window").click(function() {
    return false;
}); 
```

如果单击文档，则隐藏给定元素，除非单击同一元素。

* * *

## 回答 #31

> 赞同：6
> 
> 时间：2012-05-03T09:21:57.377

在文档上挂钩一个单击事件侦听器。在事件侦听器中，您可以查看[事件对象](http://api.jquery.com/category/events/event-object/)，特别是[event.target](http://api.jquery.com/event.target/)以查看单击了哪个元素：

```
$(document).click(function(e){
    if ($(e.target).closest("#menuscontainer").length == 0) {
        // .closest can help you determine if the element 
        // or one of its ancestors is #menuscontainer
        console.log("hide");
    }
}); 
```

* * *

## 回答 #32

> 赞同：6
> 
> 时间：2015-07-25T21:33:38.590

为最受欢迎的答案投票，但添加

```
&& (e.target != $('html').get(0)) // ignore the scrollbar 
```

因此，单击滚动条不会[隐藏或其他]您的目标元素。

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2011-12-06T13:42:42.560

[我在YUI](http://en.wikipedia.org/wiki/Yahoo!_UI_Library)  3中这样做了：

```
// Detect the click anywhere other than the overlay element to close it.
Y.one(document).on('click', function (e) {
    if (e.target.ancestor('#overlay') === null && e.target.get('id') != 'show' && overlay.get('visible') == true) {
        overlay.hide();
    }
}); 
```

我正在检查祖先是否不是小部件元素容器，
如果目标不是打开小部件/元素，
我要关闭的小部件/元素是否已经打开（不是那么重要）。

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2015-07-08T01:05:46.007

我们实施了一个解决方案，部分基于上述用户的评论，这对我们来说非常有效。当在这些元素之外单击时，我们使用它来隐藏搜索框/结果，不包括最初的元素。

```
// HIDE SEARCH BOX IF CLICKING OUTSIDE
$(document).click(function(event){ 
    // IF NOT CLICKING THE SEARCH BOX OR ITS CONTENTS OR SEARCH ICON 
    if ($("#search-holder").is(":visible") && !$(event.target).is("#search-holder *, #search")) {
        $("#search-holder").fadeOut('fast');
        $("#search").removeClass('active');
    }
}); 
```

它首先检查搜索框是否已经可见，在我们的例子中，它还删除了隐藏/显示搜索按钮上的活动类。

* * *

## 回答 #35

> 赞同：5
> 
> 时间：2016-04-21T20:04:49.000

为了更易于使用和更具表现力的代码，我为此创建了一个 jQuery 插件：

```
$('div.my-element').clickOut(function(target) { 
    //do something here... 
}); 
```

注意： **target**是用户实际点击的元素。但是回调仍然在原始元素的上下文中执行，因此您可以像在 jQuery 回调中所期望的那样使用**它。**

插入：

```
$.fn.clickOut = function (parent, fn) {
    var context = this;
    fn = (typeof parent === 'function') ? parent : fn;
    parent = (parent instanceof jQuery) ? parent : $(document);

    context.each(function () {
        var that = this;
        parent.on('click', function (e) {
            var clicked = $(e.target);
            if (!clicked.is(that) && !clicked.parents().is(that)) {
                if (typeof fn === 'function') {
                    fn.call(that, clicked);
                }
            }
        });

    });
    return context;
}; 
```

默认情况下，单击事件侦听器放置在文档上。但是，如果您想限制事件侦听器的范围，您可以传入一个代表父级元素的 jQuery 对象，该父级元素将是侦听点击的顶级父级。这可以防止不必要的文档级事件侦听器。显然，除非提供的父元素是初始元素的父元素，否则它不会起作用。

像这样使用：

```
$('div.my-element').clickOut($('div.my-parent'), function(target) { 
    //do something here...
}); 
```

* * *

## 回答 #36

> 赞同：4
> 
> 时间：2010-06-17T14:58:05.713

功能：

```
$(function() {
    $.fn.click_inout = function(clickin_handler, clickout_handler) {
        var item = this;
        var is_me = false;
        item.click(function(event) {
            clickin_handler(event);
            is_me = true;
        });
        $(document).click(function(event) {
            if (is_me) {
                is_me = false;
            } else {
                clickout_handler(event);
            }
        });
        return this;
    }
}); 
```

用法：

```
this.input = $('<input>')
    .click_inout(
        function(event) { me.ShowTree(event); },
        function() { me.Hide(); }
    )
    .appendTo(this.node); 
```

而且功能非常简单：

```
ShowTree: function(event) {
    this.data_span.show();
}
Hide: function() {
    this.data_span.hide();
} 
```

* * *

## 回答 #37

> 赞同：4
> 
> 时间：2012-03-21T16:24:38.463

这是我对这个问题的解决方案：

```
$(document).ready(function() {
  $('#user-toggle').click(function(e) {
    $('#user-nav').toggle();
    e.stopPropagation();
  });

  $('body').click(function() {
    $('#user-nav').hide(); 
  });

  $('#user-nav').click(function(e){
    e.stopPropagation();
  });
}); 
```

* * *

## 回答 #38

> 赞同：4
> 
> 时间：2013-01-12T11:43:29.937

这应该有效：

```
$('body').click(function (event) {
    var obj = $(event.target);
    obj = obj['context']; // context : clicked element inside body
    if ($(obj).attr('id') != "menuscontainer" && $('#menuscontainer').is(':visible') == true) {
        //hide menu
    }
}); 
```

* * *

## 回答 #39

> 赞同：4
> 
> 时间：2013-05-31T17:49:31.527

**当只管理一个元素时，**这里的解决方案可以正常工作。但是，如果有多个元素，问题就会复杂得多。使用 e.stopPropagation() 和其他所有技巧都行不通。

我想出了一个**解决方案**，也许不是那么容易，但总比没有好。看一看：

```
$view.on("click", function(e) {

    if(model.isActivated()) return;

        var watchUnclick = function() {
            rootView.one("mouseleave", function() {
                $(document).one("click", function() {
                    model.deactivate();
                });
                rootView.one("mouseenter", function() {
                    watchUnclick();
                });
            });
        };
        watchUnclick();
        model.activate();
    }); 
```

* * *

## 回答 #40

> 赞同：4
> 
> 时间：2013-11-19T01:40:52.687

我最终做了这样的事情：

```
$(document).on('click', 'body, #msg_count_results .close',function() {
    $(document).find('#msg_count_results').remove();
});
$(document).on('click','#msg_count_results',function(e) {
    e.preventDefault();
    return false;
}); 
```

我在新容器中有一个关闭按钮，用于最终用户友好的 UI 目的。我不得不使用 return false 为了不通过。当然，有一个 HREF 可以带你去某个地方会很好，或者你可以调用一些 ajax 的东西。无论哪种方式，它都适合我。正是我想要的。

* * *

## 回答 #41

> 赞同：4
> 
> 时间：2017-07-27T14:00:08.360

这是我为解决问题所做的。

```
$(window).click(function (event) {
    //To improve performance add a checklike 
    //if(myElement.isClosed) return;
    var isClickedElementChildOfMyBox = isChildOfElement(event,'#id-of-my-element');

    if (isClickedElementChildOfMyBox)
        return;

    //your code to hide the element 
});

var isChildOfElement = function (event, selector) {
    if (event.originalEvent.path) {
        return event.originalEvent.path[0].closest(selector) !== null;
    }

    return event.originalEvent.originalTarget.closest(selector) !== null;
} 
```

* * *

## 回答 #42

> 赞同：4
> 
> 时间：2018-03-07T08:49:30.047

我只是想让@Pistos 的答案更明显，因为它隐藏在评论中。

这个解决方案对我来说非常有效。纯JS：

```
var elementToToggle = $('.some-element');
$(document).click( function(event) {
  if( $(event.target).closest(elementToToggle).length === 0 ) {
    elementToToggle.hide();
  }
}); 
```

在 CoffeeScript 中：

```
elementToToggle = $('.some-element')
$(document).click (event) ->
  if $(event.target).closest(elementToToggle).length == 0
    elementToToggle.hide() 
```

* * *

## 回答 #43

> 赞同：4
> 
> 时间：2019-02-11T14:47:00.507

假设您要检测用户是否在外部或内部单击的 div 具有 id，例如：“my-special-widget”。

监听body点击事件：

```
document.body.addEventListener('click', (e) => {
    if (isInsideMySpecialWidget(e.target, "my-special-widget")) {
        console.log("user clicked INSIDE the widget");
    }
    console.log("user clicked OUTSIDE the widget");
});

function isInsideMySpecialWidget(elem, mySpecialWidgetId){
    while (elem.parentElement) {
        if (elem.id === mySpecialWidgetId) {
            return true;
        }
        elem = elem.parentElement;
    }
    return false;
} 
```

在这种情况下，您不会破坏点击页面中某些元素的正常流程，因为您没有使用“stopPropagation”方法。

* * *

## 回答 #44

> 赞同：3
> 
> 时间：2013-05-30T17:51:19.177

另一种解决方案在这里：

[http://jsfiddle.net/zR76D/](http://jsfiddle.net/zR76D/)

用法：

```
<div onClick="$('#menu').toggle();$('#menu').clickOutside(function() { $(this).hide(); $(this).clickOutside('disable'); });">Open / Close Menu</div>
<div id="menu" style="display: none; border: 1px solid #000000; background: #660000;">I am a menu, whoa is me.</div> 
```

插入：

```
(function($) {
    var clickOutsideElements = [];
    var clickListener = false;

    $.fn.clickOutside = function(options, ignoreFirstClick) {
        var that = this;
        if (ignoreFirstClick == null) ignoreFirstClick = true;

        if (options != "disable") {
            for (var i in clickOutsideElements) {
                if (clickOutsideElements[i].element[0] == $(this)[0]) return this;
            }

            clickOutsideElements.push({ element : this, clickDetected : ignoreFirstClick, fnc : (typeof(options) != "function") ? function() {} : options });

            $(this).on("click.clickOutside", function(event) {
                for (var i in clickOutsideElements) {
                    if (clickOutsideElements[i].element[0] == $(this)[0]) {
                        clickOutsideElements[i].clickDetected = true;
                    }
                }
            });

            if (!clickListener) {
                if (options != null && typeof(options) == "function") {
                    $('html').click(function() {
                        for (var i in clickOutsideElements) {
                            if (!clickOutsideElements[i].clickDetected) {
                                clickOutsideElements[i].fnc.call(that);
                            }
                            if (clickOutsideElements[i] != null) clickOutsideElements[i].clickDetected = false;
                        }
                    });
                    clickListener = true;
                }
            }
        }
        else {
            $(this).off("click.clickoutside");
            for (var i = 0; i < clickOutsideElements.length; ++i) {
                if (clickOutsideElements[i].element[0] == $(this)[0]) {
                    clickOutsideElements.splice(i, 1);
                }
            }
        }

        return this;
    }
})(jQuery); 
```

* * *

## 回答 #45

> 赞同：3
> 
> 时间：2013-06-18T13:16:06.823

标记为已接受答案的答案没有考虑到您可以在元素上覆盖，如对话框、弹出框、日期选择器等。单击这些不应隐藏元素。

我已经制作了自己的版本，它确实考虑到了这一点。它被创建为一个[KnockoutJS](http://en.wikipedia.org/wiki/KnockoutJS)绑定，但它可以很容易地转换为仅限 jQuery。

它通过第一次查询具有可见的 z-index 或绝对位置的所有元素起作用。然后，如果在外部单击，它会针对我想要隐藏的元素对这些元素进行测试。如果它是一个命中，我会计算一个新的边界矩形，它会考虑覆盖边界。

```
ko.bindingHandlers.clickedIn = (function () {
    function getBounds(element) {
        var pos = element.offset();
        return {
            x: pos.left,
            x2: pos.left + element.outerWidth(),
            y: pos.top,
            y2: pos.top + element.outerHeight()
        };
    }

    function hitTest(o, l) {
        function getOffset(o) {
            for (var r = { l: o.offsetLeft, t: o.offsetTop, r: o.offsetWidth, b: o.offsetHeight };
                o = o.offsetParent; r.l += o.offsetLeft, r.t += o.offsetTop);
            return r.r += r.l, r.b += r.t, r;
        }

        for (var b, s, r = [], a = getOffset(o), j = isNaN(l.length), i = (j ? l = [l] : l).length; i;
            b = getOffset(l[--i]), (a.l == b.l || (a.l > b.l ? a.l <= b.r : b.l <= a.r))
                && (a.t == b.t || (a.t > b.t ? a.t <= b.b : b.t <= a.b)) && (r[r.length] = l[i]));
        return j ? !!r.length : r;
    }

    return {
        init: function (element, valueAccessor) {
            var target = valueAccessor();
            $(document).click(function (e) {
                if (element._clickedInElementShowing === false && target()) {
                    var $element = $(element);
                    var bounds = getBounds($element);

                    var possibleOverlays = $("[style*=z-index],[style*=absolute]").not(":hidden");
                    $.each(possibleOverlays, function () {
                        if (hitTest(element, this)) {
                            var b = getBounds($(this));
                            bounds.x = Math.min(bounds.x, b.x);
                            bounds.x2 = Math.max(bounds.x2, b.x2);
                            bounds.y = Math.min(bounds.y, b.y);
                            bounds.y2 = Math.max(bounds.y2, b.y2);
                        }
                    });

                    if (e.clientX < bounds.x || e.clientX > bounds.x2 ||
                        e.clientY < bounds.y || e.clientY > bounds.y2) {

                        target(false);
                    }
                }
                element._clickedInElementShowing = false;
            });

            $(element).click(function (e) {
                e.stopPropagation();
            });
        },
        update: function (element, valueAccessor) {
            var showing = ko.utils.unwrapObservable(valueAccessor());
            if (showing) {
                element._clickedInElementShowing = true;
            }
        }
    };
})(); 
```

* * *

## 回答 #46

> 赞同：3
> 
> 时间：2014-10-08T13:30:06.967

对于 iPad 和 iPhone 等触控设备，我们可以使用以下代码：

```
$(document).on('touchstart', function (event) {
    var container = $("YOUR CONTAINER SELECTOR");

    if (!container.is(e.target) &&            // If the target of the click isn't the container...
        container.has(e.target).length === 0) // ... nor a descendant of the container
    {
        container.hide();
    }
}); 
```

* * *

## 回答 #47

> 赞同：3
> 
> 时间：2017-02-09T00:43:51.747

我知道这个问题有一百万个答案，但我一直喜欢使用 HTML 和 CSS 来完成大部分工作。在这种情况下，z-index 和定位。我发现执行此操作的最简单方法如下：

```
$("#show-trigger").click(function(){
  $("#element").animate({width: 'toggle'});
  $("#outside-element").show();
});
$("#outside-element").click(function(){
  $("#element").hide();
  $("#outside-element").hide();
});
```

```
#outside-element {
  position:fixed;
  width:100%;
  height:100%;
  z-index:1;
  display:none;
}
#element {
  display:none;
  padding:20px;
  background-color:#ccc;
  width:300px;
  z-index:2;
  position:relative;
}
#show-trigger {
  padding:20px;
  background-color:#ccc;
  margin:20px auto;
  z-index:2;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<div id="outside-element"></div>
<div id="element">
  <div class="menu-item"><a href="#1">Menu Item 1</a></div>
  <div class="menu-item"><a href="#2">Menu Item 1</a></div>
  <div class="menu-item"><a href="#3">Menu Item 1</a></div>
  <div class="menu-item"><a href="#4">Menu Item 1</a></div>
</div>
<div id="show-trigger">Show Menu</div>
```

这创建了一个安全的环境，因为除非菜单实际打开并且 z-index 保护元素中的任何内容在被单击时不会产生任何失火，否则不会触发任何内容。

此外，您不需要 jQuery 用传播调用覆盖所有基础，也不需要清除所有内部元素的失火。

* * *

## 回答 #48

> 赞同：3
> 
> 时间：2017-02-24T21:32:00.823

```
$(document).on("click",function (event)   
 {   
     console.log(event);
   if ($(event.target).closest('.element').length == 0)
     {
    //your code here
      if ($(".element").hasClass("active"))
      {
        $(".element").removeClass("active");
      }
     }
 }); 
```

尝试此编码以获得解决方案。

* * *

## 回答 #49

> 赞同：3
> 
> 时间：2017-09-13T02:11:50.150

这对我有用

```
$("body").mouseup(function(e) {
    var subject = $(".main-menu");
    if(e.target.id != subject.attr('id') && !subject.has(e.target).length) {
        $('.sub-menu').hide();
    }
}); 
```

* * *

## 回答 #50

> 赞同：3
> 
> 时间：2017-12-11T15:15:33.983

如果您使用“Pop-up”之类的工具，则可以使用“onFocusOut”事件。

```
window.onload=function(){
document.getElementById("inside-div").focus();
}
function loseFocus(){
alert("Clicked outside");
}
```

```
#container{
background-color:lightblue;
width:200px;
height:200px;
}

#inside-div{
background-color:lightgray;
width:100px;
height:100px;

}
```

```
<div id="container">
<input type="text" id="inside-div" onfocusout="loseFocus()">
</div>
```

* * *

## 回答 #51

> 赞同：3
> 
> 时间：2020-09-28T13:53:11.313

所有这些答案都解决了这个问题，但我想贡献一个完全符合需要的现代 es6 解决方案。我只是希望能让有人对这个可运行的演示感到满意。

```
window.clickOutSide = (element, clickOutside, clickInside) => {
  document.addEventListener('click', (event) => {
    if (!element.contains(event.target)) {
      if (typeof clickInside === 'function') {
        clickOutside();
      }
    } else {
      if (typeof clickInside === 'function') {
        clickInside();
      }
    }
  });
};

window.clickOutSide(document.querySelector('.block'), () => alert('clicked outside'), () => alert('clicked inside'));
```

```
.block {
  width: 400px;
  height: 400px;
  background-color: red;
}
```

```
<div class="block"></div>
```

* * *

## 回答 #52

> 赞同：3
> 
> 时间：2021-05-11T07:10:11.430

这是我对这个问题找到的最简单的答案：

```
window.addEventListener('click', close_window = function () {
  if(event.target !== windowEl){
    windowEl.style.display = "none";
    window.removeEventListener('click', close_window, false);
  }
}); 
```

您会看到我将函数命名为“close_window”，以便在窗口关闭时删除事件侦听器。

* * *

## 回答 #53

> 赞同：3
> 
> 时间：2021-07-06T15:18:38.407

**一种用纯 JavaScript 编写的方法**

```
let menu = document.getElementById("menu");

document.addEventListener("click", function(){
    // Hide the menus
    menu.style.display = "none";
}, false);

document.getElementById("menuscontainer").addEventListener("click", function(e){
    // Show the menus
    menu.style.display = "block";
    e.stopPropagation();
}, false); 
```

* * *

## 回答 #54

> 赞同：2
> 
> 时间：2010-06-02T19:15:33.213

这对我来说及时很好：

```
$('body').click(function() {
    // Hide the menus if visible.
}); 
```

* * *

## 回答 #55

> 赞同：2
> 
> 时间：2012-03-06T13:13:55.787

这是我的代码：

```
// Listen to every click
$('html').click(function(event) {
    if ( $('#mypopupmenu').is(':visible') ) {
        if (event.target.id != 'click_this_to_show_mypopupmenu') {
            $('#mypopupmenu').hide();
        }
    }
});

// Listen to selector's clicks
$('#click_this_to_show_mypopupmenu').click(function() {

  // If the menu is visible, and you clicked the selector again we need to hide
  if ( $('#mypopupmenu').is(':visible') {
      $('#mypopupmenu').hide();
      return true;
  }

  // Else we need to show the popup menu
  $('#mypopupmenu').show();
}); 
```

* * *

## 回答 #56

> 赞同：2
> 
> 时间：2012-04-09T14:02:00.430

```
jQuery().ready(function(){
    $('#nav').click(function (event) {
        $(this).addClass('activ');
        event.stopPropagation();
    });

    $('html').click(function () {
        if( $('#nav').hasClass('activ') ){
            $('#nav').removeClass('activ');
        }
    });
}); 
```

* * *

## 回答 #57

> 赞同：2
> 
> 时间：2012-11-25T20:29:12.353

老实说，我不喜欢以前的任何解决方案。

最好的方法是将“点击”事件绑定到文档，并比较该点击是否真的在元素之外（就像 Art 在他的建议中所说的那样）。

但是，您会遇到一些问题：您将永远无法解除绑定，并且您无法使用外部按钮来打开/关闭该元素。

这就是为什么我写了[这个小插件（点击这里链接）](http://www.imaginacom.com/eval.php?exec=29)，以简化这些任务。能不能简单点？

```
<a id='theButton' href="#">Toggle the menu</a><br/>
<div id='theMenu'>
    I should be toggled when the above menu is clicked,
    and hidden when user clicks outside.
</div>

<script>
$('#theButton').click(function(){
    $('#theMenu').slideDown();
});
$("#theMenu").dClickOutside({ ignoreList: $("#theButton") }, function(clickedObj){
    $(this).slideUp();
});
</script> 
```

* * *

## 回答 #58

> 赞同：2
> 
> 时间：2013-05-31T16:00:18.520

最广泛的方法是选择网页上的所有内容，除了您不希望检测到点击的元素，并在打开菜单时绑定点击事件。

然后当菜单关闭时删除绑定。

使用 .stopPropagation 防止事件影响菜单容器的任何部分。

```
$("*").not($("#menuscontainer")).bind("click.OutsideMenus", function ()
{
    // hide the menus

    //then remove all of the handlers
    $("*").unbind(".OutsideMenus");
});

$("#menuscontainer").bind("click.OutsideMenus", function (event) 
{
    event.stopPropagation(); 
}); 
```

* * *

## 回答 #59

> 赞同：2
> 
> 时间：2016-11-01T09:55:50.227

对于某些人来说，这可能是一个更好的解决方案。

```
$(".menu_link").click(function(){
    // show menu code
});

$(".menu_link").mouseleave(function(){
    //hide menu code, you may add a timer for 3 seconds before code to be run
}); 
```

我知道 mouseleave 不仅意味着在外部单击，还意味着离开该元素的区域。

一旦菜单本身位于`menu_link`元素内部，那么菜单本身就不应该成为单击或继续前进的问题。

* * *

## 回答 #60

> 赞同：2
> 
> 时间：2016-11-12T13:57:44.710

我相信最好的方法是这样的。

```
$(document).on("click", function(event) {
  clickedtarget = $(event.target).closest('#menuscontainer');
  $("#menuscontainer").not(clickedtarget).hide();
}); 
```

这种类型的解决方案可以很容易地用于多个菜单以及通过 javascript 动态添加的菜单。基本上它只允许您单击文档中的任何位置，并检查您单击的元素，并选择它最接近的“#menuscontainer”。然后它隐藏所有菜单容器，但不包括您单击的那个。

不确定您的菜单是如何构建的，但请随意在 JSFiddle 中复制我的代码。这是一个非常简单但功能齐全的菜单/模式系统。您需要做的就是构建 html 菜单，代码将为您完成工作。

[https://jsfiddle.net/zs6anrn7/](https://jsfiddle.net/zs6anrn7/)

* * *

## 回答 #61

> 赞同：2
> 
> 时间：2018-01-09T03:42:47.610

```
$('#propertyType').on("click",function(e){
          self.propertyTypeDialog = !self.propertyTypeDialog;
          b = true;
          e.stopPropagation();
          console.log("input clicked");
      });

      $(document).on('click','body:not(#propertyType)',function (e) {
          e.stopPropagation();
          if(b == true)  {
              if ($(e.target).closest("#configuration").length == 0) {
                  b = false;
                  self.propertyTypeDialog = false;
                  console.log("outside clicked");
              }
          }
        // console.log($(e.target).closest("#configuration").length);
      }); 
```

* * *

## 回答 #62

> 赞同：2
> 
> 时间：2019-12-27T18:25:13.013

```
const button = document.querySelector('button')
const box = document.querySelector('.box');

const toggle = event => {
  event.stopPropagation();

  if (!event.target.closest('.box')) {
    console.log('Click outside');

    box.classList.toggle('active');

    box.classList.contains('active')
      ? document.addEventListener('click', toggle)
      : document.removeEventListener('click', toggle);
  } else {
    console.log('Click inside');
  }
}

button.addEventListener('click', toggle);
```

```
.box {
  position: absolute;
  display: none;
  margin-top: 8px;
  padding: 20px;
  background: lightgray;
}

.box.active {
  display: block;
}
```

```
<button>Toggle box</button>

<div class="box">
  <form action="">
    <input type="text">
    <button type="button">Search</button>
  </form>
</div>
```

* * *

## 回答 #63

> 赞同：2
> 
> 时间：2020-08-27T13:30:42.427

还在寻找检测外部点击的完美解决方案吗？不要再看了！介绍[Clickout-Event](https://www.npmjs.com/package/clickout-event)，这是一个为 clickout 和其他类似事件提供通用支持的包，它适用于**所有**场景：纯 HTML`onclickout`属性、`.addEventListener('clickout')`vanilla JavaScript、`.on('clickout')`jQuery、`v-on:clickout`Vue.js 指令等等。只要前端框架在内部使用`addEventListener`来处理事件，Clickout-Event 就可以为它工作。只需在页面的任何位置添加脚本标签，它就可以像魔术一样工作。

HTML 属性

```
<div onclickout="console.log('clickout detected')">...</div> 
```

香草 JavaScript

```
document.getElementById('myId').addEventListener('clickout', myListener); 
```

jQuery

```
$('#myId').on('clickout', myListener); 
```

Vue.js

```
<div v-on:clickout="open=false">...</div> 
```

角

```
<div (clickout)="close()">...</div> 
```

* * *

## 回答 #64

> 赞同：1
> 
> 时间：2013-09-30T10:31:58.910

这是一个更通用的解决方案，它**允许监视多个元素，并从队列中动态添加和删除元素**。

它拥有一个全局队列 ( **autoCloseQueue** ) - 一个对象容器，用于存放应在外部单击时关闭的元素。

每个队列对象键应该是 DOM 元素 id，值应该是具有 2 个回调函数的对象：

```
 {onPress: someCallbackFunction, onOutsidePress: anotherCallbackFunction} 
```

将其放入您的文档就绪回调中：

```
window.autoCloseQueue = {}  

$(document).click(function(event) {
    for (id in autoCloseQueue){
        var element = autoCloseQueue[id];
        if ( ($(e.target).parents('#' + id).length) > 0) { // This is a click on the element (or its child element)
            console.log('This is a click on an element (or its child element) with  id: ' + id);
            if (typeof element.onPress == 'function') element.onPress(event, id);
        } else { //This is a click outside the element
            console.log('This is a click outside the element with id: ' + id);
            if (typeof element.onOutsidePress == 'function') element.onOutsidePress(event, id); //call the outside callback
            delete autoCloseQueue[id]; //remove the element from the queue
        }
    }
}); 
```

**然后，当创建 id 为 ' menuscontainer** '的 DOM 元素时，只需将此对象添加到队列中：

```
window.autoCloseQueue['menuscontainer'] = {onOutsidePress: clickOutsideThisElement} 
```

* * *

## 回答 #65

> 赞同：1
> 
> 时间：2016-08-17T13:00:21.187

`fileTreeClass`如果在其外部单击则 隐藏

```
 jQuery(document).mouseup(function (e) {
            var container = $(".fileTreeClass");
            if (!container.is(e.target) // if the target of the click isn't the container...
                && container.has(e.target).length === 0) // ... nor a descendant of the container
            {
                container.hide();
            }
        }); 
```

* * *

## 回答 #66

> 赞同：1
> 
> 时间：2016-09-09T19:31:58.253

简单的插件：

```
$.fn.clickOff = function(callback, selfDestroy) {
    var clicked = false;
    var parent = this;
    var destroy = selfDestroy || true;

    parent.click(function() {
        clicked = true;
    });

    $(document).click(function(event) {
        if (!clicked && parent.is(':visible')) {
            if(callback) callback.call(parent, event)
        }
        if (destroy) {
            //parent.clickOff = function() {};
            //parent.off("click");
            //$(document).off("click");
            parent.off("clickOff");
        }
        clicked = false;
    });
}; 
```

采用：

```
$("#myDiv").clickOff(function() {
   alert('clickOff');
}); 
```

* * *

## 回答 #67

> 赞同：0
> 
> 时间：2012-12-14T10:55:14.997

只是一个警告，使用这个：

```
$('html').click(function() {
  // Hide the menus if visible
});

$('#menucontainer').click(function(event){
  event.stopPropagation();
}); 
```

它会**阻止**[Ruby on Rails](http://en.wikipedia.org/wiki/Ruby_on_Rails) UJS 驱动程序正常工作。例如，`link_to 'click', '/url', :method => :delete`不会工作。

这可能是一种解决方法：

```
$('html').click(function() {
  // Hide the menus if visible
});

$('#menucontainer').click(function(event){
  if (!$(event.target).data('method')) {
    event.stopPropagation();
  }
}); 
```

* * *

## 回答 #68

> 赞同：0
> 
> 时间：2014-04-30T21:11:52.167

当您单击/关闭元素时，这将切换导航菜单。

```
$(document).on('click', function(e) {
    var elem = $(e.target).closest('#menu'),
    box = $(e.target).closest('#nav');
 if (elem.length) {
    e.preventDefault();
    $('#nav').toggle();
  } else if (!box.length) {
    $('#nav').hide();
 }
});

<li id="menu"><a></a></li>
<ul id="nav" >  //Nav will toggle when you Click on Menu(it can be an icon in this example)
        <li class="page"><a>Page1</a></li>
        <li class="page"><a>Pag2</a></li>
        <li class="page"><a>Page3</a></li>            
        <li class="page"><a>Page4</a></li>
</ul> 
```

* * *

## 回答 #69

> 赞同：0
> 
> 时间：2015-08-07T02:24:41.637

**外点击插件！**

**用法：**

```
$('.target-element').outsideClick(function(event){
    //code that fires when user clicks outside the element
    //event = the click event
    //$(this) = the '.target-element' that is firing this function 
}, '.excluded-element') 
```

**它的代码：**

```
(function($) {

//when the user hits the escape key, it will trigger all outsideClick functions
$(document).on("keyup", function (e) {
    if (e.which == 27) $('body').click(); //escape key
});

//The actual plugin
$.fn.outsideClick = function(callback, exclusions) {
    var subject = this;

    //test if exclusions have been set
    var hasExclusions = typeof exclusions !== 'undefined';

    //switches click event with touch event if on a touch device
    var ClickOrTouchEvent = "ontouchend" in document ? "touchend" : "click";

    $('body').on(ClickOrTouchEvent, function(event) {
        //click target does not contain subject as a parent
        var clickedOutside = !$(event.target).closest(subject).length;

        //click target was on one of the excluded elements
        var clickedExclusion = $(event.target).closest(exclusions).length;

        var testSuccessful;

        if (hasExclusions) {
            testSuccessful = clickedOutside && !clickedExclusion;
        } else {
            testSuccessful = clickedOutside;
        }

        if(testSuccessful) {
            callback.call(subject, event);
        }
    });

    return this;
};

}(jQuery)); 
```

改编自这个答案[https://stackoverflow.com/a/3028037/1611058](https://stackoverflow.com/a/3028037/1611058)

* * *

## 回答 #70

> 赞同：0
> 
> 时间：2016-01-28T07:24:29.653

```
$('html').click(function() {
//Hide the menus if visible
});

$('#menucontainer').click(function(event){
    event.stopPropagation();
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<html>
 <button id='#menucontainer'>Ok</button> 
</html>
```

* * *

## 回答 #71

> 赞同：0
> 
> 时间：2016-03-07T14:37:05.863

试试这个：

```
$('html').click(function(e) {
  if($(e.target).parents('#menuscontainer').length == 0) {
    $('#menuscontainer').hide();
  }
}); 
```

[https://jsfiddle.net/4cj4jxy0/](https://jsfiddle.net/4cj4jxy0/)

但请注意，如果点击事件无法到达`html`标签，这将无法正常工作。（也许其他元素有`stopPropagation()`）。

* * *

## 回答 #72

> 赞同：0
> 
> 时间：2016-04-11T13:21:09.983

订阅点击的*捕获阶段*以处理对调用的元素的点击`preventDefault`。
使用其他名称在文档元素上重新触发它`click-anywhere`。

```
document.addEventListener('click', function (event) {
  event = $.event.fix(event);
  event.type = 'click-anywhere';
  $document.trigger(event);
}, true); 
```

然后你需要点击外部功能订阅`click-anywhere`事件`document`并检查点击是否在你感兴趣的元素之外：

```
$(document).on('click-anywhere', function (event) {
  if (!$(event.target).closest('#smth').length) {
    // Do anything you need here
  }
}); 
```

一些注意事项：

*   您必须使用`document`，因为在单击发生之外的所有元素上触发事件将是性能错误。

*   此功能可以包装到特殊插件中，该插件在外部点击时调用一些回调。

*   您不能使用 jQuery 本身订阅捕获阶段。

*   您不需要文档加载来订阅，因为订阅是 on `document`，即使不是订阅`body`，所以它总是独立存在 ащкь 脚本放置和加载状态。

* * *

## 回答 #73

> 赞同：0
> 
> 时间：2016-05-11T21:13:40.107

```
$(document).on('click.menu.hide', function(e){
  if ( !$(e.target).closest('#my_menu').length ) {
    $('#my_menu').find('ul').toggleClass('active', false);
  }
});

$(document).on('click.menu.show', '#my_menu li', function(e){
  $(this).find('ul').toggleClass('active');
}); 
```

```
div {
  float: left;
}

ul {
  padding: 0;
  position: relative;
}
ul li {
  padding: 5px 25px 5px 10px;
  border: 1px solid silver;
  cursor: pointer;
  list-style: none;
  margin-top: -1px;
  white-space: nowrap;
}
ul li ul:before {
  margin-right: -20px;
  position: absolute;
  top: -17px;
  right: 0;
  content: "\25BC";
}
ul li ul li {
  visibility: hidden;
  height: 0;
  padding-top: 0;
  padding-bottom: 0;
  border-width: 0 0 1px 0;
}
ul li ul li:last-child {
  border: none;
}
ul li ul.active:before {
  content: "\25B2";
}
ul li ul.active li {
  display: list-item;
  visibility: visible;
  height: inherit;
  padding: 5px 25px 5px 10px;
} 
```

```
<script src="https://code.jquery.com/jquery-2.1.4.js"></script>
<div>
  <ul id="my_menu">
    <li>Menu 1
      <ul>
        <li>subMenu 1</li>
        <li>subMenu 2</li>
        <li>subMenu 3</li>
        <li>subMenu 4</li>
      </ul>
    </li>
    <li>Menu 2
      <ul>
        <li>subMenu 1</li>
        <li>subMenu 2</li>
        <li>subMenu 3</li>
        <li>subMenu 4</li>
      </ul>
    </li>
    <li>Menu 3</li>
    <li>Menu 4</li>
    <li>Menu 5</li>
    <li>Menu 6</li>
  </ul>
</div> 
```

这是 jsbin 版本[http://jsbin.com/xopacadeni/edit?html,css,js,output](http://jsbin.com/xopacadeni/edit?html,css,js,output)

* * *

## 回答 #74

> 赞同：0
> 
> 时间：2017-12-09T13:42:54.197

如果您只想在单击按钮时显示一个窗口，并在单击外部时取消显示此窗口。（或再次单击按钮）此波纹管效果很好

```
document.body.onclick = function() { undisp_menu(); };
var menu_on = 0;

function menu_trigger(event){

    if (menu_on == 0)
    {
        // otherwise u will call the undisp on body when 
        // click on the button
        event.stopPropagation(); 

        disp_menu();
    }

    else{
        undisp_menu();
    }

}

function disp_menu(){

    menu_on = 1;
    var e = document.getElementsByClassName("menu")[0];
    e.className = "menu on";

}

function undisp_menu(){

    menu_on = 0;
    var e = document.getElementsByClassName("menu")[0];
    e.className = "menu";

} 
```

不要忘记这个按钮

```
<div class="button" onclick="menu_trigger(event)">

<div class="menu"> 
```

和CSS：

```
.menu{
    display: none;
}

.on {
    display: inline-block;
} 
```

* * *

## 回答 #75

> 赞同：0
> 
> 时间：2020-10-13T19:55:49.280

这对我来说很好。我不是专家。

```
$(document).click(function(event) {
  var $target = $(event.target);
  if(!$target.closest('#hamburger, a').length &&
  $('#hamburger, a').is(":visible")) {
    $('nav').slideToggle();
  }
}); 
```

* * *

## 回答 #76

> 赞同：0
> 
> 时间：2021-02-16T16:26:53.713

我已经阅读了 2021 年的所有内容，但如果没有错的话，没有人建议像这样简单的方法来取消绑定和删除事件。使用上述两个答案和一个小技巧，将所有内容合二为一（也可以将参数添加到函数中以传递选择器，以获得更多弹出窗口）。可能有人知道这个笑话也可以这样做是有用的：

```
<div id="container" style="display:none"><h1>my menu is nice but disappear if i click outside it</h1></div>

<script>
 function printPopup(){
  $("#container").css({ "display":"block" });
  var remListener = $(document).mouseup(function (e) {
   if ($(e.target).closest("#container").length === 0 && (e.target != $('html').get(0))) 
   {
    //alert('closest call');
    $("#container").css({ "display":"none" });
    remListener.unbind('mouseup'); // isn't it?
   } 
  });
 }

 printPopup();

</script> 
```

干杯

* * *

## 回答 #77

> 赞同：0
> 
> 时间：2021-11-05T15:28:42.060

你不需要（很多）JavaScript，只需要`:focus-within`选择器：

*   用于`.sidebar:focus-within`显示您的侧边栏。
*   设置`tabindex=-1`在您的侧边栏和正文元素上，以使它们具有焦点。
*   `sidebarEl.focus()`使用和设置侧边栏可见性`document.body.focus()`。

```
const menuButton = document.querySelector('.menu-button');
const sidebar = document.querySelector('.sidebar');

menuButton.onmousedown = ev => {
  ev.preventDefault();
  (sidebar.contains(document.activeElement) ?
    document.body : sidebar).focus();
};
```

```
* { box-sizing: border-box; }

.sidebar {
  position: fixed;
  width: 15em;
  left: -15em;
  top: 0;
  bottom: 0;
  transition: left 0.3s ease-in-out;
  background-color: #eef;
  padding: 3em 1em;
}

.sidebar:focus-within {
  left: 0;
}

.sidebar:focus {
  outline: 0;
}

.menu-button {
  position: fixed;
  top: 0;
  left: 0;
  padding: 1em;
  background-color: #eef;
  border: 0;
}

body {
  max-width: 30em;
  margin: 3em;
}
```

```
<body tabindex='-1'>
  <nav class='sidebar' tabindex='-1'>
    Sidebar content
    <input type="text"/>
  </nav>
  <button class="menu-button">☰&lt;/button>
  Body content goes here, Lorem ipsum sit amet, etc
</body>
```

* * *

## 回答 #78

> 赞同：0
> 
> 时间：2022-02-22T20:44:36.540

对于那些想要一个简短的解决方案来集成到他们的 JS 代码中的人 - 一个没有 JQuery 的小型库：

用法：

```
// demo code
var htmlElem = document.getElementById('my-element')
function doSomething(){ console.log('outside click') }

// use the lib
var removeListener = new elemOutsideClickListener(htmlElem, doSomething);

// deregister on your wished event
$scope.$on('$destroy', removeListener); 
```

这是库：

```
 function elemOutsideClickListener (element, outsideClickFunc, insideClickFunc) {
   function onClickOutside (e) {
      var targetEl = e.target; // clicked element
      do {
         // click inside
         if (targetEl === element) {
            if (insideClickFunc) insideClickFunc();
            return;

         // Go up the DOM
         } else {
            targetEl = targetEl.parentNode;
         }
      } while (targetEl);

      // click outside
      if (!targetEl && outsideClickFunc) outsideClickFunc();
   }

   window.addEventListener('click', onClickOutside);

   return function () {
      window.removeEventListener('click', onClickOutside);
   };
} 
```

我从这里获取代码并将其放入一个函数中： [https ://www.w3docs.com/snippets/javascript/how-to-detect-a-click-outside-an-element.html](https://www.w3docs.com/snippets/javascript/how-to-detect-a-click-outside-an-element.html)

* * *

## 回答 #79

> 赞同：-1
> 
> 时间：2014-07-07T14:11:52.260

作为[来自 Art 的这个出色答案的包装](https://stackoverflow.com/a/3028037/1366033)，并使用 OP 最初请求的语法，这里有一个 jQuery 扩展，可以记录是否在 set 元素之外发生了点击。

```
$.fn.clickOutsideThisElement = function (callback) {
    return this.each(function () {
        var self = this;
        $(document).click(function (e) {
            if (!$(e.target).closest(self).length) {
                callback.call(self, e)
            }
        })
    });
}; 
```

然后你可以这样调用：

```
$("#menuscontainer").clickOutsideThisElement(function() {
    // handle menu toggle
}); 
```

## [这是小提琴中的演示](http://jsfiddle.net/KyleMit/Fv2fY/)

* * *

## 回答 #80

> 赞同：-1
> 
> 时间：2015-12-11T07:42:47.707

```
 $('#menucontainer').click(function(e){
        e.stopPropagation();
     });

    $(document).on('click',  function(e){
        // code
    }); 
```

* * *

## 回答 #81

> 赞同：-1
> 
> 时间：2019-06-25T15:23:25.403

首先，您必须使用 mouseenter 和 mouseleave 事件来跟踪鼠标是在 element1 内部还是外部。然后，您可以创建一个覆盖整个屏幕的 element2 以检测任何点击，并根据您是在 element1 内部还是外部做出相应的反应。

我强烈建议同时处理初始化和清理，并且由于显而易见的原因，element2 尽可能地是临时的。

在下面的示例中，叠加层是位于某处的元素，可以通过单击内部来选择它，并且可以通过单击外部来取消选择。_init 和 _release 方法被称为自动初始化/清理过程的一部分。该类继承自具有内部和外部元素的 ClickOverlay，不用担心。我使用了 outerElement.parentNode.appendChild 来避免冲突。

```
import ClickOverlay from './ClickOverlay.js'

/* CSS */
// .unselect-helper {
//  position: fixed; left: -100vw; top: -100vh;
//  width: 200vw; height: 200vh;
// }
// .selected {outline: 1px solid black}

export default class ResizeOverlay extends ClickOverlay {
    _init(_opts) {
        this.enterListener = () => this.onEnter()
        this.innerElement.addEventListener('mouseenter', this.enterListener)
        this.leaveListener = () => this.onLeave()
        this.innerElement.addEventListener('mouseleave', this.leaveListener)
        this.selectListener = () => {
            if (this.unselectHelper)
                return
            this.unselectHelper = document.createElement('div')
            this.unselectHelper.classList.add('unselect-helper')
            this.unselectListener = () => {
                if (this.mouseInside)
                    return
                this.clearUnselectHelper()
                this.onUnselect()
            }
            this.unselectHelper.addEventListener('pointerdown'
                , this.unselectListener)
            this.outerElement.parentNode.appendChild(this.unselectHelper)
            this.onSelect()
        }
        this.innerElement.addEventListener('pointerup', this.selectListener)
    }

    _release() {
        this.innerElement.removeEventListener('mouseenter', this.enterListener)
        this.innerElement.removeEventListener('mouseleave', this.leaveListener)
        this.innerElement.removeEventListener('pointerup', this.selectListener)
        this.clearUnselectHelper()
    }

    clearUnselectHelper() {
        if (!this.unselectHelper)
            return
        this.unselectHelper.removeEventListener('pointerdown'
            , this.unselectListener)
        this.unselectHelper.remove()
        delete this.unselectListener
        delete this.unselectHelper
    }

    onEnter() {
        this.mouseInside = true
    }

    onLeave() {
        delete this.mouseInside
    }

    onSelect() {
        this.innerElement.classList.add('selected')
    }

    onUnselect() {
        this.innerElement.classList.remove('selected')
    }
} 
```

* * *

## 回答 #82

> 赞同：-1
> 
> 时间：2020-05-19T13:38:33.400

最简单的方法：`mouseleave(function())`

更多信息：[https ://www.w3schools.com/jquery/jquery_events.asp](https://www.w3schools.com/jquery/jquery_events.asp)

* * *

## 回答 #83

> 赞同：-2
> 
> 时间：2014-03-13T18:06:37.350

您可以将 tabindex 设置为[DOM](http://en.wikipedia.org/wiki/Document_Object_Model)元素。当用户在 DOM 元素外部单击时，这将触发模糊事件。

[演示](http://jsbin.com/fuloqixe/5)

```
<div tabindex="1">
    Focus me
</div>

document.querySelector("div").onblur = function(){
   console.log('clicked outside')
}
document.querySelector("div").onfocus = function(){
   console.log('clicked inside')
} 
```

* * *

## 回答 #84

> 赞同：-3
> 
> 时间：2013-02-19T21:11:50.560

```
 <div class="feedbackCont" onblur="hidefeedback();">
        <div class="feedbackb" onclick="showfeedback();" ></div>
        <div class="feedbackhide" tabindex="1"> </div>
 </div>

function hidefeedback(){
    $j(".feedbackhide").hide();
}

function showfeedback(){
    $j(".feedbackhide").show();
    $j(".feedbackCont").attr("tabindex",1).focus();
} 
```

这是我想出的最简单的解决方案。

* * *

## 回答 #85

> 赞同：-3
> 
> 时间：2014-02-17T10:32:08.160

试试这个代码：

```
if ($(event.target).parents().index($('#searchFormEdit')) == -1 &&
    $(event.target).parents().index($('.DynarchCalendar-topCont')) == -1 &&
    (_x < os.left || _x > (os.left + 570) || _y < os.top || _y > (os.top + 155)) &&
    isShowEditForm) {

    setVisibleEditForm(false);
} 
```

* * *

## 回答 #86

> 赞同：-3
> 
> 时间：2014-06-10T12:56:17.857

标准 HTML：

用 a 包围菜单`<label>`并获取焦点状态更改。

[http://jsfiddle.net/bK3gL/](http://jsfiddle.net/bK3gL/)

另外：您可以通过 展开菜单`Tab`。

* * *

## 回答 #87

> 赞同：-3
> 
> 时间：2014-10-09T10:25:46.393

使用非（）：

```
$("#id").not().click(function() {
    alert('Clicked other that #id');
}); 
```

* * *

## 回答 #88

> 赞同：-3
> 
> 时间：2014-10-29T11:57:53.553

```
$("body > div:not(#dvid)").click(function (e) {
    //your code
}); 
```

* * *

## 回答 #89

> 赞同：-3
> 
> 时间：2014-12-18T01:12:27.700

```
$("html").click(function(){
    if($('#info').css("opacity")>0.9) {
        $('#info').fadeOut('fast');
    }
}); 
```

* * *

## 回答 #90

> 赞同：-3
> 
> 时间：2015-08-04T15:37:46.503

这是一个经典案例，其中对 HTML 进行调整会是更好的解决方案。为什么不对不包含菜单项的元素设置点击？然后你不需要添加传播。

```
$('.header, .footer, .main-content').click(function() {
//Hide the menus if visible
}); 
```

# ssis - 执行 SFTP 或 FTPS 任务的 SSIS 组件的推荐选择是什么？

> ID：152981
> 
> 赞同：6
> 
> 时间：2008-09-30T13:18:42.787
> 
> 标签：ssis, ftp, sftp, ftps

有时普通的 FTP 并不能完全解决它......当您需要通过 SSIS 包进行安全 FTP 时，您会推荐哪种产品？

在回答之前，请查看是否有人已经提出了相同的建议，如果是，请投票。

**`NOTE:`**理想情况下，它需要同时处理 SSH 和 SSL FTP 连接，但如果最有意义的话，我会考虑两个单独的组件......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-02T08:01:05.083

实际上不是 SSIS 组件。但是您可以考虑查看[如何在 SSIS 中使用 WinSCP 开源 SFTP 客户端作为任务的指南](http://winscp.net/eng/docs/guide_ssis)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-30T13:21:31.470

[Secure Blackbox](http://www.eldos.com/sbbsrv/ssis-ssh-connection-task.php?referer1=google&referer2=adwords_sbbsrv_sshssis&gclid=CM-SktPNg5YCFRfAQAodbQXjEw)做 SSH 并且应该很好，但没有个人经验。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-30T13:19:46.483

一位同事指出[CozyRoc](http://www.cozyroc.com/)，但我还没有尝试过。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-30T13:20:05.857

我使用[Rebex.net 文件传输包](http://www.rebex.net/file-transfer-pack/default.aspx)在 .NET 中进行 SFTP 和 FTP 传输。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-03T14:07:14.327

我们的[Rebex 文件传输包](http://www.rebex.net/file-transfer-pack/default.aspx)包括 SFTP 和 FTP/SSL。

我写了一篇关于注册组件以在 SSIS 包中使用的博文：http: [//blog.rebex.net/news/archive/2008/10/03/how-to-register-sftp-and-ftp-ssl-for-在 ssis-package.aspx 中使用](http://blog.rebex.net/news/archive/2008/10/03/how-to-register-sftp-and-ftp-ssl-for-use-in-ssis-package.aspx)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-02T19:04:26.100

您是否尝试过 Pragmatic Works 的 SSIS 任务工厂……社区版是免费的

[SSIS 自定义任务和组件](http://www.pragmaticworks.com/products/business-intelligence/taskfactory/)

包括 SFTP 任务（安全 FTP ... FTPS）压缩/压缩任务 Upsert 目标（批量更新或插入）

还有很多....

他们有一些非常酷的组件

# sql - 您是否将索引放在源代码管理中？

> ID：152985
> 
> 赞同：3
> 
> 时间：2008-09-30T13:19:32.973
> 
> 标签：sql, database, version-control, indexing, sdlc

以及如何使它们在测试和生产环境之间保持同步？

当谈到数据库表的索引时，我的理念是它们是编写任何查询数据库的代码的一个组成部分。如果不分析对索引的影响，就无法引入新查询或更改查询。

所以我尽我最大的努力让我的索引在我所有的环境之间保持同步，但老实说，我在自动化这方面做得不是很好。这是一种随意的手动过程。

我会定期查看索引统计数据并删除不必要的索引。我通常通过创建一个删除脚本来执行此操作，然后将其复制回其他环境。

但是这里和那里的索引是在正常过程之外创建和删除的，很难看出差异在哪里。

我发现真正有用的一件事是使用简单的数字索引名称，例如

```
idx_t_01
idx_t_02 
```

其中 t 是表格的缩写。当我试图对所有涉及的列变得聪明时，我发现索引维护是不可能的，比如，

```
idx_c1_c2_c5_c9_c3_c11_5 
```

区分这样的索引太难了。

有人有将索引维护集成到源代码控制和开发生命周期中的真正好方法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-30T13:24:12.727

索引是数据库模式的一部分，因此应该与其他所有内容一起进行源代码控制。如果没有经过正常的 QA 和发布流程（尤其是性能测试），任何人都不应该在生产环境中创建索引。

关于模式版本控制还有许多其他线程。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-30T13:25:09.807

数据库的完整架构应该在代码旁边的源代码控制中。当我说“完整模式”时，我指的是表定义、查询、存储过程、索引等等。

进行全新安装时，您可以： - 检查产品的 X 版本。- 从结帐的“数据库”目录中，运行数据库脚本来创建您的数据库。- 使用结帐中的代码库与数据库进行交互。

当您进行开发时，每个开发人员都应该针对他们自己的私有数据库实例工作。当他们进行模式更改时，他们会检查一组新的模式定义文件，这些文件适用于他们修改后的代码库。

使用这种方法，您永远不会遇到代码库-数据库同步问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-30T13:22:41.407

是的，*任何*DML 或 DDL 更改都会编写脚本并签入源代码控制，主要是通过 rails 中的 activerecord 迁移。我讨厌不断地吹牛，但在构建基于 DB 的系统的多年中，我发现迁移路线比我使用或构建的任何本土系统都要好得多。

但是，我确实命名了我所有的索引（不要让 DBMS 想出它选择的任何疯狂的名称）。**不要给它们加前缀**，这很愚蠢（因为您在 sysobjects 或您拥有的任何数据库中都有类型元数据），但我确实包含了表名和列，例如 tablename_col1_col2。

这样，如果我正在浏览 sysobjects，我可以很容易地看到特定表的索引（这也是一种习惯的力量，在我使用的一些 dBMS 上，索引名称在整个数据库中都是唯一的，所以唯一的方法以确保使用唯一名称）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-30T13:30:55.100

我认为这里有两个问题：索引命名约定，以及将数据库更改添加到源代码控制/生命周期。我会解决后一个问题。

很长时间以来，我一直是一名 Java 程序员，但最近被介绍到一个系统，该系统使用 Ruby on Rails 对系统的一部分进行数据库访问。我喜欢 RoR 的一件事是“迁移”的概念。基本上，您有一个充满文件的目录，这些文件看起来像 001_add_foo_table.rb、002_add_bar_table.rb、003_add_blah_column_to_foo.rb 等。这些 Ruby 源文件扩展了一个父类，覆盖了称为“up”和“down”的方法。“up”方法包含一组数据库更改，这些更改需要将先前版本的数据库模式带到当前版本。同样，“down”方法将更改恢复到以前的版本。当您想为特定版本设置架构时，

要使这部分成为您的开发过程，您可以将这些检查到源代码控制中，并根据口味调整。

Rails 在这里并没有什么特别或特别之处，只是我第一次看到这种技术被广泛使用。您也可以使用成对的 SQL DDL 文件，例如 001_UP_add_foo_table.sql 和 001_DOWN_remove_foo_table.sql。剩下的就是关于 shell 脚本的小事，留给读者的练习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-30T13:24:25.007

我没有将我的索引放在源代码管理中，而是将索引的创建脚本。;-)

索引命名：

*   IX_CUSTOMER_NAME 用于表“客户”中的字段“名称”
*   PK_CUSTOMER_ID 为主键，
*   UI_CUSTOMER_GUID，用于唯一的客户 GUID 字段（因此是“UI” - 唯一索引）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-30T13:25:17.110

我总是对 SQL 进行源代码控制（DDL、DML 等）。它的代码和其他代码一样。它的好习惯。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-30T13:26:03.237

我不确定索引在不同环境中是否应该相同，因为它们具有不同的数据大小。除非您的测试和生产环境具有相同的确切数据，否则索引会有所不同。

至于它们是否属于源代码控制，我不确定。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-30T13:32:34.457

在我当前的项目中，我在源代码控制中有两件事 - 一个空数据库的完整转储（使用 pg_dump -c 所以它具有创建表和索引的所有 ddl）和一个确定您拥有的数据库版本的脚本，并应用更改/删除/添加以将其升级到当前版本。前者在我们在新站点上安装时运行，并且在 QA 开始新一轮测试时运行，后者在每次升级时运行。当您进行数据库更改时，您需要更新这两个文件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-30T13:32:48.887

使用 grails 应用程序，索引默认存储在源代码管理中，因为您在代表域对象的文件中定义索引定义。仅提供“Grails”视角作为仅供参考。

# java - 关于 Java SE 客户端-服务器应用程序的远程处理（rpc、rmi）的建议？

> ID：152988
> 
> 赞同：0
> 
> 时间：2008-09-30T13:19:53.067
> 
> 标签：java, remoting

我非常喜欢 GWT 执行 RPC 的方式。您是否有类似的 Java SE 经验：

1.  不是春天
2.  不需要 Java EE/Servlet 容器来运行服务器端
3.  不是 Java SE 自带的 RMI

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-30T14:36:30.417

[阿帕奇米娜](http://mina.apache.org/)。不是真正的 rpc，但易于使用，肯定是一个值得考虑的选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-03T14:59:38.730

也许[是吉尼](http://www.jini.org/ "吉尼")。与 Spring 或 EJB 无关，不在容器中运行，您可以选择传输方式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-30T13:49:56.003

如果你想要分布式计算之类的东西，你可以看看[cajo](https://cajo.dev.java.net/)项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-10T03:12:48.383

POJ（普通旧 JSON）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-01T00:19:22.187

你试过 sfnrpc ( [http://code.google.com/p/sfnrpc](http://code.google.com/p/sfnrpc) ) 不需要弹簧。您可以在同一个 JVM 中运行多个服务器您也可以让一个客户端连接到多个服务器。没有事件风格的编程，但支持通过 nio 进行异步和同步调用。*********