# StackOverflow 问答 000917000-000917999

# java - 为清晰起见命名集合扩展

> ID：917002
> 
> 赞同：5
> 
> 时间：2009-05-27T17:21:22.633
> 
> 标签：java, generics, collections, coding-style

在不添加新的外部库依赖项的情况下将收集操作的一些优点引入我们的代码库，我们将这些方法添加到我们的实用程序包中。

```
static public List<T> filter(List<T> source, Predicate<T> filter);
static <Y,T> public List<Y> transform(List<T> source, Mutator<Y,T> filter);
static public boolean exists(List<T> source, Predicate<T> filter);
static public T findFirst(List<T> source, Predicate<T> filter);
static public boolean trueForAll(List<T> source, Predicate<T> filter); 
```

带话务员接口

```
public interface Predicate<T> { public boolean apply(T item); }
public interface Mutator<T,Y> { public Y apply(T item); } 
```

所以问题：

*   过滤器是包含扩展的类的好名字吗？如果没有，更好？
*   Mutator<T,Y> 的名称是否恰当？
*   我应该更喜欢**map**来**转换**和**reduce**来**过滤**吗？
*   有没有我忘记包含在库类中的重要的基于集合的函数？

**编辑添加**：我反对**map**（因此支持**transform**）的一个重要论点是**map**由于 java.util.Map 的许多用途而具有显着的语义负载

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T22:52:42.280

> 有没有我忘记包含在库类中的重要的基于集合的函数？

对于高阶集合函数，我使用 Adrian Kuhn 在他的文章“ [Pimp My Foreach](http://www.iam.unibe.ch/~akuhn/blog/2008/pimp-my-foreach-loop/) ”中概述的方法。

其中一些你已经有了，但我想我还是会把它们扔在那里：

*   全部满意
*   任何满足
*   基数
*   收集
*   数数
*   切块
*   探测
*   折叠
*   分组依据
*   指数
*   注入
*   拒绝
*   选择

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T17:29:18.610

这看起来真的很不错；我认为你在这里绝对是正确的。是的，我认为 Mutator 是个好名字；transform 更好，因为它更常被读作动词，而 map 有一个可能令人困惑的“名词”内涵；我认为您可能想要的唯一主要的基于集合的功能是重新排序功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:29:26.783

在我使用的类似库中：

*   **代替**Predicate的****规范**： `aSpecification.isSatisfiedBy(anObject);`**
***   **Mapper**代替**Mutator***   **地图**是为 smalltalkers**收集的（在你的情况下****转换**）*   **fold**是为 smalltalkers**注入的***   **过滤器**是为 smalltalkers**选择的****

 *** * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T17:31:13.690

我会称它们为**map**和**filter**。reduce 对我来说意义稍有不同，transform 太模糊了。至于类名，Filters 可能不是最好的，但我没有更好的推荐。

我知道您并没有特别要求这个，但是可以改进泛型方法中的一些签名：

```
 static public <T> List<T> filter(List<T> source, Predicate<? super T> filter);
 static public <Y,T> List<Y> transform(List<T> source, Mutator<Y,? super T> filter);
 static public <T> boolean exists(List<T> source, Predicate<? super T> filter);
 static public <T> T findFirst(List<T> source, Predicate<? super T> filter);
 static public <T> boolean trueForAll(List<T> source, Predicate<? super T> filter); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T17:28:27.067

这不是你真正问的，但它符合你的问题的精神。对我来说，最好说：

```
List<String> shortWords = filtered(allWords, short); 
```

比

```
List<String> shortWords = filter(allWords, short); 
```

我会坚持使用**transform**和**filter**。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T22:44:15.853

为了一致性起见，Transform 似乎应该是 Mutate（或者 Mutator 应该是 Transformer）。这似乎很清楚意图：

```
static <Y,T> public List<Y> mutate (List<T> originalForm, Mutator<Y,T> mutator); 
```

它对规范也有点冗长（但更一致和传统）：

```
static public boolean isTrueForAll(List<T> source, Predicate<T> filter); 
```

或者

```
static public boolean assertTrueForAll(List<T> source, Predicate<T> filter); 
```

# sql-server - 使用 Visual Studio 进行数据库版本控制

> ID：917008
> 
> 赞同：4
> 
> 时间：2009-05-27T17:23:34.127
> 
> 标签：sql-server, visual-studio-2008, tfs, database-versioning

在 SO 播客[第 54 集中](http://itc.conversationsnetwork.org/shows/detail4114.html)， Jeff 谈到了使用 Visual Studio 将所有数据库对象保存到单个文件中。这听起来就像我的团队需要更好地在 TFS 中实现数据库模式更改，我告诉了我的领导。他认为这样做是个好主意。

不幸的是，到目前为止，我还没有让这对我有用。我的问题之一是我的本地机器上没有安装 SQL Server（部门策略）。我显然做错了什么。

有人可以给我一个步骤的概要或提供一个像样的链接吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T17:33:32.220

1) 在服务器资源管理器中创建与数据库的连接。
2) 右键单击​​连接并选择 Publish to provider...
3) 下一步，脚本到文件，下一步，要发布的数据类型应该是 Schema（除非您需要一些初始数据），完成。
4）将脚本添加到项目并签入源代码管理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T17:35:13.683

他指的是 VS 中支持管理数据库的项目类型，包括（如果设置正确），对数据库发布进行版本控制。

查看这篇关于[VS 中的数据库项目的文章](http://blog.reamped.net/post/2008/05/Using-Database-Projects-for-Visual-Studio.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T03:14:21.937

您想使用 GDR 2。（有时称为 Data Dude）

这允许完全离线的解决方案。您无需在计算机上安装 SQL Server 即可使用。（事实上​​，GDR 是第一个不关心是否安装了 SQL Server 的版本。）

我将 GDR 用于我的数据库（由 3 名开发人员和 2 名测试人员组成的团队），效果很好！

这是 GDR 2 版本的链接：http: [//blogs.msdn.com/vstsdb/archive/2009/04/21/microsoft-visual-studio-team-system-2008-database-edition-gdr-r2。 aspx](http://blogs.msdn.com/vstsdb/archive/2009/04/21/microsoft-visual-studio-team-system-2008-database-edition-gdr-r2.aspx)

这是实际位的链接：http: [//www.microsoft.com/downloads/details.aspx?displaylang= en&FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=bb3ad767-5f69-4db9-b1c9-8f55759846ed)

基本用途是从现有数据库和服务器导入。（您可能需要一个服务器项目和 1 个或多个 DB 项目）

然后，您可以离线进行更改。当您准备好将更改发送回数据库时，您可以进行部署（确保首先设置部署选项，因为我认为默认设置是删除数据库并重新部署）。您还可以在 Visual Studio 中执行 Data->Schema Compare 并将您的项目与数据库进行比较，然后从差异输出中获取更改脚本。

这需要一些工作，但它确实允许很好的源代码控制，并且一旦你掌握了它就很容易。（我每周两次在夜间构建中自动部署数据库。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T20:20:06.157

如果您要导入现有的数据库模式，那么获得正确的数据库项目很重要。您应该可能正在使用“数据库项目\SQL Server 2005 向导”。

Visual Studio 需要一个数据库连接，它可以用来创建它正在使用的数据库的临时副本。听起来这就是问题所在。你的本地机器上有 SQLExpress 吗？使用它作为部署目标（如果 . 不起作用，服务器名称将是 .\sqlexpress）。

作为替代方案，获取 Visual Studio 的更新 GDR 2。据称，它允许人们在不使用本地 sql server 实例的情况下使用数据库项目来部署数据库的临时工作副本。

# javascript - CollapsiblePanelExtender 点击事件

> ID：917010
> 
> 赞同：2
> 
> 时间：2009-05-27T17:24:03.067
> 
> 标签：javascript, c#, onclick, dom-events, collapsiblepanelextender

我有一个带有通常的扩展和折叠按钮的 CollapsiblePanelExtender ......我希望在扩展器扩展时触发单击事件，并在扩展器折叠时触发不同的单击事件。但最重要的事件是它何时延长。即使在崩溃时，我也可以不用点击。

我发现在线搜索的大多数示例都使用：“CollapsiblePanelExtender”“点击事件”让扩展器根据点击做出反应，即使在其他地方......

我希望扩展器在单击时触发 JS。

我应该如何去完成这个？我问错了问题/使用了错误的搜索字符串吗？

```
 CollapsiblePanelExtender extendatron = new CollapsiblePanelExtender();
            extendatron.ID = "cpe" + MenuId;
            extendatron.TargetControlID = "pnlContent" + strMenuId;
            extendatron.ExpandControlID = "pnlMenu" + strMenuId;
            extendatron.CollapseControlID = "pnlMenu" + strMenuId;
            extendatron.Collapsed = bCollapsed;
            extendatron.TextLabelID = strMenuName;
            extendatron.ExpandedText = m_strButtonLabelHide;
            extendatron.CollapsedText = m_strButtonLabelShow;
            extendatron.ImageControlID = "imglnk" + strMenuId;
            extendatron.CollapsedImage = "~/App_Themes/default/nbExpand.gif";
            extendatron.ExpandedImage = "~/App_Themes/default/nbCollapse.gif";
            extendatron.SuppressPostBack = true;
            extendatron.ScrollContents = false;

            var extender = $find('extendatron'); //this would be <%=myExtender.ClientID%>
            extender.add_collapsed( function() { alert('collapsed'); });
            extender.add_expanded( function() { alert('expanded'); }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T18:08:18.077

我假设您在谈论 ASP.Net AJAX 控制工具包。您可以将处理程序添加到折叠和展开的事件中，如下所示：

```
//this would be <%=myExtender.ClientID%> when using a master page
var extender = $find('myExtender_ClientId'); 
extender.add_collapsed( function() { alert('collapsed'); });
extender.add_expanded( function() { alert('expanded'); }); 
```

如果您有任何问题，请告诉我...我已经在各种解决方案中对其中一些对象进行了相当多的自定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-11-10T16:09:46.537

`onClick`首先，您需要为用户单击的面板或控件创建客户端 (JavaScript)事件。

所以，进去输入`onClick="functionName();"`

```
<asp:Panel ID="pDocumentHeaderTitle" runat="server" CssClass="collapsePanelHeader" onClick="setCollapseState();"> 
       <asp:Image ID="imgDocumentHeaderHeader" runat="server" ImageUrl="~/images/wadown.gif"/>Document Header
       <asp:Label ID="lblDocumentHeaderHeader" runat="server">(Show)</asp:Label>
</asp:Panel> 
```

下一步：添加此 javascript。

```
<script type="text/javascript">
    function setCollapseState() {
        var extenderDocumentHeader = document.getElementById("MainContent_cpeDocumentHeader_ClientState");
        setCookie("cpeDocumentHeaderStatus", extenderDocumentHeader.value, 5)
    }

    //W3Schools cookie code.
    function setCookie(c_name, value, exdays) {
        var exdate = new Date();
        exdate.setDate(exdate.getDate() + exdays);
        var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString());
        document.cookie = c_name + "=" + c_value;
    }

    //W3Schools cookie code.
    function getCookie(c_name) {
        var i, x, y, ARRcookies = document.cookie.split(";");
        for (i = 0; i < ARRcookies.length; i++) {
            x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
            y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
            x = x.replace(/^\s+|\s+$/g, "");
            if (x == c_name) {
                return unescape(y);
            }
        }
    }

</script> 
```

请注意，当您的页面加载时，有一个隐藏字段是您的可折叠面板状态。这将是真实的或虚假的。转到页面源并搜索它，您会找到它。

然后加：

`var extenderDocumentHeader = document.getElementById("MainContent_cpeDocumentHeader_ClientState");`

因此，单击时，获取此客户端状态，将其保存在 cookie 中，一切顺利！

# xml - XML XSL 问题

> ID：917012
> 
> 赞同：0
> 
> 时间：2009-05-27T17:24:23.813
> 
> 标签：xml, xslt, xhtml

我有一个包含大约 150 个条目的 xml 文档。我以几种方式对条目进行排序。一个是按字母顺序排列的，它通过 XSLT 显示并且效果很好，另一个是按类别和解决方案，它们存在逐行交替色带颜色的问题。

当我遍历未显示的条目时出现问题，即使它们未显示，它们似乎也包含在计数中。我曾经在匿名用户下问过这个问题，希望这次我更清楚。

谢谢您的帮助。

XML 文档。

```
<case-studies>
    <!-- #### X #### -->
    <case-study>    
        <name>Entry 1</name>
        <category solution="Performance">Medical</category>
        <category solution="Medical">Security</category>
        <category solution="Industry">Medical</category>
        <category solution="A-Z">X</category>
    </case-study>

<!-- #### Y #### -->
    <case-study>    
        <name>Entry 2</name>
        <category solution="Industry">Education</category>
        <category solution="Convergence">Education</category>
        <category solution="A-Z">Y</category>
    </case-study>

</case-studies> 
```

XSLT 调用

```
 <%
        Dim mm_xsl As MM.XSLTransform = new MM.XSLTransform()
        mm_xsl.setXML(Server.MapPath("/data/xml/case-studies/case-studiesTest.xml"))
        mm_xsl.setXSL(Server.MapPath("/data/xslt/case-studies/categoryLandingOther.xsl"))
        mm_xsl.addParameter("solName", "Industry")
        mm_xsl.addParameter("catName", "Business services")
        Response.write(mm_xsl.Transform())
    %> 
```

xslt 的一部分

```
<xsl:for-each select="case-studies/case-study/category[. = $catName]">     

    <!--xsl:sort select="../name" /-->
    <xsl:if test="@solution[. = $solName]">

        <tr>
        <xsl:if test="(position() mod 2 = 1)">
            <xsl:attribute name="bgcolor">#e7e7e7</xsl:attribute>                
        </xsl:if>    
          <td class="cell1">                
          </td> 
          <td class="cell2" style="padding-top:2px;">» <a href="{../url}"><xsl:value-of select="../name"/></a></td>
          <td class="cell3">
            <xsl:for-each select="../solutionType">         
                <div class="clearRight"><xsl:value-of select="."/></div>
            </xsl:for-each>                
          </td>
        </tr>

    </xsl:if>
</xsl:for-each> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:40:24.373

第一：尽量避免`<xsl:for-each>`。[大多数时候这是一个糟糕的选择。](http://gregbeech.com/blogs/tech/archive/2006/08/17/using-xsl-for-each-is-almost-always-wrong.aspx)

第二：仅选择您要输出的那些节点，并且您的行交替将起作用：

```
<xsl:template match="/case-studies">
  <xsl:apply-templates select="case-study[
    category = $catName 
    and
    category/@solution = $solName
  ]">
    <xsl:sort select="name" />
  </xsl:apply-templates>
</xsl:template>

<xsl:template match="case-study">
  <tr>
    <xsl:if test="position() mod 2 = 1"> 
      <xsl:attribute name="bgcolor">#e7e7e7</xsl:attribute>
    </xsl:if>    
    <td class="cell1" />                
    <td class="cell2" style="padding-top:2px;">
      <xsl:text>» </xsl:text>
      <a href="{url}"><xsl:value-of select="name"/></a>
    </td>
    <td class="cell3">
      <xsl:apply-templates select="solutionType" />
    </td>
  </tr>
</xsl:template>

<xsl:template match="solutionType">
  <div class="clearRight">
    <xsl:value-of select="."/>
  </div>
</xsl:template> 
```

编辑：

您可以使用 an`<xsl:key>`来加快选择过程，但这只有在同一转换过程中重复查询相同数据时才会产生积极影响。

```
<xsl:key name="kCaseStudy" 
         match="case-study" 
         use="concat(category, category/@solution)" 
/>

<!-- no need to be in "/case-studies" context this time -->
<xsl:template match="/">
  <xsl:apply-templates select="key('kCaseStudy', concat($catName, $solName))">
    <xsl:sort select="name" />
  </xsl:apply-templates>
</xsl:template>

<!-- ... code that uses "key('kCaseStudy', ...)" again ... --> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T18:04:26.963

@Tomalak*总是*打败我（有更好更详细的答案）！

行交替的问题在于两行：

```
<xsl:for-each select="case-studies/case-study/category[. = $catName]"> 
```

和

```
<xsl:if test="@solution[. = $solName]"> 
```

发生的情况是您选择了与上述谓词条件匹配的节点集。处理器在循环的其余部分记住这一点。然后您应用另一个条件，进一步限制处理的节点（但不循环）。

您使用函数来测试循环内的位置`position()`......它包含总数。`<xsl:for...`循环匹配的节点数（*不排除`<xsl:if`条件过滤掉的节点。*）

一个解决方案是结合`xsl:for-each`和`xsl:if`条件：

```
<xsl:for-each select="case-study/category[. = $catName and @solution = $solName]"> 
```

当然，这个解释只是为了说明这一点。Tomalak 关于避免使用 for-each 的观点非常有效，他的解决方案也很棒。

# wpf - 在 WPF 应用程序中在运行时枚举已翻译的 .resx 资源

> ID：917014
> 
> 赞同：0
> 
> 时间：2009-05-27T17:26:28.130
> 
> 标签：wpf, localization, resources, internationalization, resx

我一直在通过将字符串存储在 .resx 文件中来为我的 WPF 应用程序进行本地化。我的默认（英文）字符串资源是 strings.resx。对于其他语言，法语称为 strings.fr-FR.resx，西班牙语称为 strings.es-ES.resx，依此类推。

这种本地化方法非常棒，因为当我将全球化区域设置为匹配的区域设置时，我的应用程序会自动加载正确的字符串，并且在没有时默认为英语。

是否可以在运行时枚举我的程序集中有哪些语言？

我可以绕过这个和包含语言的硬代码，但这可能会随着构建服务器的构建而改变，因为构建服务器将语言 resx 放在一起并动态构建。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T09:54:18.653

我看到两个选项，没有一个是理想的...

*   枚举所有已知的文化 (CultureInfo.GetCultures)，并尝试为这种文化获取给定的资源 => 简单但缓慢
*   在应用程序目录中查找附属程序集：对于每个子目录，检查其名称是否对应于文化名称 (CultureInfo.GetCultureInfo)，以及它是否包含 .resources.dll 文件

# php - Codeigniter：在 Mysql 中插入重音的问题

> ID：917018
> 
> 赞同：3
> 
> 时间：2009-05-27T17:28:35.070
> 
> 标签：php, mysql, codeigniter, internationalization

我正在尝试代码点火器，在尝试在 Mysql 数据库中插入新行时遇到错误消息。

我要插入的文本是法语的，并且包含一些重音符号。

这是我的代码：

```
 $data= array(
        'title' => $this->input->post('title'),
        'date' => $this->input->post('date'),
        'mytext' => $this->input->post('mytext')
        );

    $this->db->insert('blog', $data); 
```

这段代码似乎工作正常（我插入了一些“测试测试”条目），但是当我尝试输入带有重音符号的内容时，例如“ *Il était là* ”，我收到一条错误消息：

> 发生数据库错误
> 
> 错误号：1366
> 
> 不正确的字符串值：第 1 行的列 'mytext' 的 '\xE9tait ...'

我已经查看了代码点火器论坛以进行修复，但他们所说的只是在 mysql 中将排序规则更改为 UTF8。我已经尝试过了，但我一直遇到同样的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T17:31:06.623

在插入数据库之前尝试对其进行 uft8 编码。

```
utf8_encode($string) 
```

# url - SharePoint 发布 HTML 字段控件将相对 URL 转换为绝对 URL

> ID：917019
> 
> 赞同：2
> 
> 时间：2009-05-27T17:28:35.333
> 
> 标签：url, sharepoint

因此，在对是否应该在面向外部的 SharePoint 网站上使用 CEWP 或 HTML 字段控件进行大量研究之后，我们决定使用字段控件（非常感谢 AC）。现在，我们遇到了一个问题，我读过的所有博客都说不应该是一个问题。

当我们将相对 URL 放入 HTML 编辑器并点击 OK 时，它会自动更改为绝对 URL。从我一直在做的一些研究来看，这显然是 Internet Explorer 的一个“功能”。TinyMCE 有一个解决方法。我想知道是否有一些我缺少的 SharePoint 控件的解决方法。

这对我们来说是个大问题，因为我们有一个创作站点和 www 站点。因此，当在创作站点上完成创作并且所有链接都迁移到 www 站点时，它们是`http:// authoring.domain.com/en-us/Pages/`……而不是`/en-us/Pages/`……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-31T02:08:15.150

我也遇到了这个问题。我们通过功能部署了自定义站点字段和内容类型。HTML 字段的 RichText 属性在 caml 中正确地为 true，但一旦将 SPField 部署到根 Web 字段集合中并且每个页面列表中，RichText 属性就会变为 false。

通过在部署网站栏和内容类型的功能上使用功能接收器，我能够成功解决该问题。我的代码循环站点中的每个网站，然后遍历字段以更新它们。

代码片段：

```
 private void processweb(SPWeb web)
    {
        SPList list = web.Lists["Pages"];

        SPField field;
        for (int i = 0; i < list.Fields.Count; i++)
        {
            field = list.Fields[i];
            //to work around a sharepoint defect ... make html fields work in richtext mode
            if (field != null && string.Compare(field.TypeAsString, "HTML", true) == 0 && (field as SPFieldMultiLineText).RichText == false)
            {
                (field as SPFieldMultiLineText).RichText = true;
                field.Update(true);
            }
        }

        foreach (SPWeb w in web.Webs)
        {
            processweb(w);
        }
    } 
```

# sql-server - 在一对一的关系中删除？正常行为？

> ID：917020
> 
> 赞同：1
> 
> 时间：2009-05-27T17:28:36.317
> 
> 标签：sql-server, ms-access, relationship

在 Access 中工作时，每当我从一个表中删除一条记录时 - 当定义为一对一关系时，它在另一个表中的相应记录也会被删除。当我告诉它强制引用完整性并关注删除和更新时，这将是正常行为（我如何理解）。但是，当我清除删除的强制参照完整性选项时，或者当我将参照完整性的整个部分也清除时，它似乎也会这样做。

基本上，我有一个表，它是供应商列表，它是另一个不是我自己编写的数据库应用程序的来源。我在我的应用程序中使用此供应商表，将存储在第一个程序中的信息与用户在第二个程序中输入的信息放在一个单独的表中 - 但使用一对一的关系链接（使用两个主键的关系表）。

我不希望删除辅助信息记录导致删除主表中的数据 - 这会在第一个程序中导致重大问题（委婉地说）。有没有办法做到这一点？

--编辑添加于 2009 年 5 月 27 日 @ 1600--

这是从第一个应用程序创建 Supplier_Master 表的 SQL 脚本：

```
USE [gtdata_test]
GO

/****** Object:  Table [dbo].[Supplier_Master]    Script Date: 05/27/2009 15:58:17 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[Supplier_Master](
    [Supplier_Code] [nvarchar](50) NOT NULL,
    [Supplier_Master_Name] [nvarchar](50) NULL,
    [Salutation] [nvarchar](50) NULL,
    [Contact] [nvarchar](50) NULL,
    [Phone] [nvarchar](50) NULL,
    [Fax] [nvarchar](50) NULL,
    [EMail] [nvarchar](50) NULL,
    [Address] [nvarchar](50) NULL,
    [City] [nvarchar](50) NULL,
    [State] [nvarchar](50) NULL,
    [Zip] [nvarchar](50) NULL,
    [Country] [nvarchar](50) NULL,
    [Last_Review] [datetime] NULL,
    [Last_Rating] [datetime] NULL,
    [Last_Received] [datetime] NULL,
    [Last_Reject] [datetime] NULL,
    [Enabled] [int] NULL,
    [User1] [nvarchar](50) NULL,
    [User2] [nvarchar](50) NULL,
    [SupType] [nvarchar](50) NULL,
 CONSTRAINT [Supplier_Master$PrimaryKey] PRIMARY KEY CLUSTERED 
(
    [Supplier_Code] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Address$disallow_zero_length] CHECK  ((len([Address])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Address$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$City$disallow_zero_length] CHECK  ((len([City])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$City$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Contact$disallow_zero_length] CHECK  ((len([Contact])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Contact$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Country$disallow_zero_length] CHECK  ((len([Country])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Country$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$EMail$disallow_zero_length] CHECK  ((len([EMail])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$EMail$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Fax$disallow_zero_length] CHECK  ((len([Fax])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Fax$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Phone$disallow_zero_length] CHECK  ((len([Phone])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Phone$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Salutation$disallow_zero_length] CHECK  ((len([Salutation])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Salutation$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$State$disallow_zero_length] CHECK  ((len([State])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$State$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Code$disallow_zero_length] CHECK  ((len([Supplier_Code])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Code$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Master_Name$disallow_zero_length] CHECK  ((len([Supplier_Master_Name])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Supplier_Master_Name$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$SupType$disallow_zero_length] CHECK  ((len([SupType])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$SupType$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$User1$disallow_zero_length] CHECK  ((len([User1])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$User1$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$User2$disallow_zero_length] CHECK  ((len([User2])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$User2$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master]  WITH NOCHECK ADD  CONSTRAINT [SSMA_CC$Supplier_Master$Zip$disallow_zero_length] CHECK  ((len([Zip])>(0)))
GO

ALTER TABLE [dbo].[Supplier_Master] CHECK CONSTRAINT [SSMA_CC$Supplier_Master$Zip$disallow_zero_length]
GO

ALTER TABLE [dbo].[Supplier_Master] ADD  DEFAULT ((0)) FOR [Enabled]
GO 
```

下面是从第二个应用程序创建 tblSupplierInfo 表的 SQL 脚本：

```
USE [instkeeper_test]
GO

/****** Object:  Table [dbo].[tblSupplierInfo]    Script Date: 05/27/2009 15:57:30 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[tblSupplierInfo](
    [strSupplierID] [nvarchar](50) NOT NULL,
    [bolSupAltShipAddyRep] [bit] NULL,
    [bolSupAltShipAddyCal] [bit] NULL,
    [bolSupInsistNet30] [bit] NULL,
    [bolRMARequireRepair] [bit] NULL,
    [bolRMARequireCalibration] [bit] NULL,
    [bolSupShipOrCourier] [bit] NULL,
    [bolSupRequireMSDS] [bit] NULL,
    [bolSupBlanketPO] [bit] NULL,
    [bolSupRequirePricing] [bit] NULL,
    [bolSupBlankPricing] [bit] NULL,
    [bolSupFaxPOSend] [bit] NULL,
    [bolAdditionalPaperworkRepair] [bit] NULL,
    [bolAdditionalPaperworkCalibration] [bit] NULL,
    [strRMARepairWordage] [nvarchar](100) NULL,
    [strRMACalibrationWordage] [nvarchar](100) NULL,
    [intBlanketPO] [int] NULL,
    [bolUseFedExNumber] [bit] NULL,
    [strFedExNumber] [nvarchar](150) NULL,
    [bolUseUPSNumber] [bit] NULL,
    [strUPSNumber] [nvarchar](150) NULL,
    [bolSupA2LAAccredited] [bit] NULL,
    [bolSupFreightAllow] [bit] NULL,
    [bolSupFreightOnly] [bit] NULL,
    [bolSupUseMiscNum] [bit] NULL,
    [strSupMiscFreightNum] [nvarchar](150) NULL,
 CONSTRAINT [tblSupplierInfo$PrimaryKey] PRIMARY KEY CLUSTERED 
(
    [strSupplierID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Supplier Name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'strSupplierID'
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Alternate Shipping Address - Repairs?' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'bolSupAltShipAddyRep'
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Alternate Shipping Address - Calibrations?' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'bolSupAltShipAddyCal'
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Force Net 30 Wordage?' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'bolSupInsistNet30'
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Do repairs require RMAs?' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'bolRMARequireRepair'
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Do calibrations require RMAs?' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'bolRMARequireCalibration'
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Use Courier?' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'bolSupShipOrCourier'
GO

EXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Requires MSDS(s)?' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tblSupplierInfo', @level2type=N'COLUMN',@level2name=N'bolSupRequireMSDS'
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupAltShipAddyRep]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupAltShipAddyCal]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupInsistNet30]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolRMARequireRepair]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolRMARequireCalibration]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupShipOrCourier]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupRequireMSDS]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupBlanketPO]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((1)) FOR [bolSupRequirePricing]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupBlankPricing]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolSupFaxPOSend]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolAdditionalPaperworkRepair]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolAdditionalPaperworkCalibration]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ('RMA #') FOR [strRMARepairWordage]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ('RMA #') FOR [strRMACalibrationWordage]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [intBlanketPO]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolUseFedExNumber]
GO

ALTER TABLE [dbo].[tblSupplierInfo] ADD  DEFAULT ((0)) FOR [bolUseUPSNumber]
GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:39:03.097

是的，这是正常行为。如果您的表单基于包含单个一对一关系的查询，并且您删除了“记录”，它将删除两个表中的记录。

您需要抑制正常的删除过程并通过自定义按钮手动运行删除。

```
Private Sub Form_Delete(Cancel As Integer)

  'this cancels all normal deletes'
  Cancel = True

End Sub 
```

然后创建一个删除按钮

```
Private Sub cmdDelete_Click()

  Dim oDB as DAO.Database

  oDB.Execute "DELETE * FROM tblSupplierInfo WHERE strSupplierID = '" & Me.strSupplierID & "'", dbFailOnError

  Me.Requery

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:11:27.713

SQL Server 是如何参与的？如果您在 Access 或 SQL Server 中都没有级联删除，也许有一个触发器？

# iis - IIS下使用SSL的多个子域

> ID：917024
> 
> 赞同：20
> 
> 时间：2009-05-27T17:29:03.740
> 
> 标签：iis, ssl, https, subdomain

我目前需要在 SSL 下的同一个域下有 2 个子域。
两个子域（www 和affiliate）都在同一个 IIS 服务器上，在同一个 IP 下，并且每个子域都指定了一个主机头值（www.mydomain.com 和affiliate.mydomain.com）

第一个子域 (www) 是默认的，无论有无 SSL，都可以很好地工作。
第二个子域在 HTTP 下完美运行。

问题是我刚刚为附属子域购买并安装了 SSL 证书，当你转到[https://affiliate.mydomain.com](https://affiliate.mydomain.com)时，你会被重定向到[http://www.mydomain.com](http://www.mydomain.com)

我猜问题在于我无法为 SSL 指定主机头值？（我通常设置主机头值的对话框底部没有该选项，专用于 SSL）。

我能做些什么呢？我应该将每个子域放在单独的 IP 中吗？这根本不可行吗？

谢谢！丹尼尔

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-27T17:32:58.493

> “我猜问题在于我无法为 SSL 指定主机头值”

你猜对了。您将需要两个 IP 地址。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-27T17:38:54.813

这个问题是 HTTPS 工作方式的基础。

虚拟主机依赖于 HTTP/1.1 中引入的“Host”标头。这是 HTTP 协议的一部分，但从 SSL 协议的角度来看，HTTP 层是“应用程序数据”，直到 SSL 握手完成后才能传输。

但是，在握手*期间会提供服务器证书。*HTTP 服务器还没有看到“Host”标头，所以它不知道要发送哪个证书。使用不同的 IP 地址是可行的，因为它在 SSL 下的 IP 层可见。

* * *

*更新：*有一个新的 TLS 扩展允许客户端在握手期间指示他们打算使用的服务器。[有关更多信息，请参阅 dlongley 的答案](https://stackoverflow.com/a/3311829/3474)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-27T17:34:56.007

我不确定您正在运行什么 Web 服务器，但在 Windows Server 2003 上的 IIS 6 中，您可以将主机标头用于 SSL 站点，从而允许它们位于相同的 IP 地址上。

[http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/596b9108-b1a7-494d-885d-f8941b07554c.mspx?mfr=true](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/596b9108-b1a7-494d-885d-f8941b07554c.mspx?mfr=true)

编辑：这仅在证书是通配符证书时才有效。否则，子域“附属”将尝试使用与子域“www”相同的证书，访问者将收到警告。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-07-22T17:53:32.503

这可能对您没有帮助，但希望它提供信息。

一些 TLS 客户端使用的 TLS 协议有一个扩展，称为服务器名称指示 (SNI)。此扩展允许 TLS 客户端指定他们尝试联系的服务器的主机名。因此，当客户端在 TLS 协议中连接并发送 ClientHello 消息时，服务器可以决定使用哪个证书进行响应。这使得虚拟 SSL/TLS 服务器可以在单个 IP 上运行。

OpenSSL 提供回调函数，允许您读取客户端发送的主机名并处理获取适当的证书，但不幸的是，我不知道这是否可以通过 IIS 实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-16T10:37:36.990

在特定情况下，您需要同一域的 2 个子域，通配符证书**必须**工作......我使用通配符证书 3 年来为数十个站点，并且没有客户报告错误

如果您有东西告诉证书是“www”，那么您的证书不是真正的通配符证书，或者您遇到某种浏览器缓存问题，或者您正在使用 2 个证书副本并且您只更新了其中一个，或者您忘记重新启动服务器，或者..我不知道:)

# apache-flex - flex Flex中的keydown

> ID：917034
> 
> 赞同：1
> 
> 时间：2009-05-27T17:30:55.050
> 
> 标签：apache-flex, events, event-handling, keyboard, keydown

我在 flex 中有一个小型应用程序，其中定义了 2 个画布。在其中一个上我添加了控件，另一个用于绘制某些东西并且没有添加控件：

```
<mx:Canvas x="0" y="80" width="100%" height="520%" id="Canvas1"/>
<mx:Canvas x="0" y="0" width="100%" height="80" id="Canvas2"/> 
```

我添加了一个处理到应用程序的 keydown 事件，但只有在我用鼠标单击第一个 Canvas（已添加控件的那个）后才会触发它。否则，按下按键时不会触发事件。

我尝试了几件事：将焦点设置在第二个画布上，将 keydown 处理程序添加到应用程序（this）、舞台、画布......不幸的是，无论焦点在哪里，我都没有找到触发 keydown 的解决方案.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-16T16:18:54.337

这是针对 flex 4 的。

```
<?xml version="1.0" encoding="utf-8"?><s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" 
           xmlns:s="library://ns.adobe.com/flex/spark" 
           xmlns:mx="library://ns.adobe.com/flex/mx"
            name="MyApp"
            width="480" height="480"
            creationComplete="init();">

<fx:Declarations>
    <!-- Place non-visual elements (e.g., services, value objects) here -->
</fx:Declarations>
<fx:Script>
    <![CDATA[
        public function init():void
        {
            trace("init");
            this.addEventListener(KeyboardEvent.KEY_DOWN, keyDown); 
        }

        private function keyDown(event:KeyboardEvent):void
        {
            trace(event.charCode);
        }       
</fx:Script></s:Application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:40:54.420

您描述的第一个问题（必须在分派任何 KeyboardEvents 之前单击鼠标）可能是由于浏览器没有将焦点放在 Flex 应用程序本身上。您可以在 HTML 包装器中使用 Javascript 以编程方式将焦点放在 Flex 应用程序的“body”元素的“onLoad”事件上。我确定这在 Firefox 中有效，我相信它在 IE 中也可以正常工作。我将尝试挖掘相关的 Javascript 代码。

至于第二个问题，是否尝试将事件侦听器添加到 Application.application 以捕获所有键盘事件？

# 64-bit - 应用挂钩 :: x64 系统

> ID：917037
> 
> 赞同：0
> 
> 时间：2009-05-27T17:31:42.737
> 
> 标签：64-bit, hook, 32-bit

在 64 位系统上挂钩 64 位和 32 位进程是否有某种秘密？

在我目前正在编写的应用程序中，我需要能够挂钩 64 位进程。挂钩 32 位进程在 64 位和 32 位系统上工作得很好，但是在尝试挂钩 64 位应用程序时不会收到任何消息。

在有人告诉我不应该做这样的事情之前，让我解释一下这对我来说是一件非常必要的事情。如果没有设置全局系统挂钩，我的应用程序将毫无用处/毫无意义。

此应用程序是用 C#/WPF 编写的，但是使用 C++ dll 来执行实际的挂钩。我已经尝试为 64 位系统编译 dll，尽管它仍然没有做它应该做的事情。当为 32 位系统编译和运行时，它完全可以正常工作。

*编辑:: 我说的是挂钩窗口消息 - WH_CBT & WH_SHELL 消息

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-08T13:07:11.203

为了挂钩 32 位和 64 位进程，您需要确保：

1.  你有 32 位 DLL 来挂钩 32 位进程和 64 位 DLL 来挂钩 64 位进程
2.  **从 32 位代码调用**SetWindowsHookEx()以挂接 32 位进程，从 64 位代码调用以挂接 64 位进程。

后者基本上意味着您必须创建都调用 SetWindowsHookEx() 的 32 位和 64 位可执行文件，分别提供 32 位和 64 位 DLL 作为 hMod 参数。

如果您的应用程序是 32 位的，则您必须生成 64 位进程，该进程将调用 SetWindowsHookEx() 并且在您取消挂钩之前可能什么都不做。请注意，当/如果此进程退出/终止时，Windows 将自动取消设置挂钩，因此它必须在您需要挂钩时一直保持活动状态，可能是您的应用程序的整个生命周期 - 在这种情况下，您可以创建 64 位进程WaitForSingleObject() 直到您的主应用程序进程退出/终止，并在 WaitForSingleObject() 完成后取消挂钩并退出。

# c# - 获取程序集路径 C#

> ID：917053
> 
> 赞同：12
> 
> 时间：2009-05-27T17:35:38.300
> 
> 标签：c#, .net, dll, assemblies

我想知道一个 dll 的路径....有几个网站说我使用 System.Reflection.Assembly.GetExecutingAssembly().Location 但它返回 C:\Windows\Microsoft.Net 中的路径......等等。 ..\文件.dll

我想要 c:\MyProyect\MiWeb\Bin\File.Dll

有什么帮助吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-27T17:45:45.737

您可以使用以下方法执行此操作：

```
string file = (new System.Uri(Assembly.GetExecutingAssembly().CodeBase)).LocalPath; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T17:38:41.367

程序集的位置会根据重定向和卷影副本而更改。尝试改用 Codebase 属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:39:36.637

这实际上可能是程序使用的路径... IIRC，它开始在 GAC 中搜索方法调用，然后默认为工作目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T17:41:36.477

您确定您在项目中引用了正确的程序集吗？听起来您正在使用一些“默认”程序集，因为它位于 .NET 文件夹中。

# sharepoint - 如何链接 SharePoint 页面上的 2 个 Web 部件？

> ID：917056
> 
> 赞同：0
> 
> 时间：2009-05-27T17:36:34.723
> 
> 标签：sharepoint

我想为“公司”之类的项目构建一个 SharePoint 页面模板。我想在页面顶部有一个 Wiki 部分，在底部有一个文档列表。让我们以百事可乐为例。我希望顶部的 Wiki 部分是有关百事可乐的信息，但我希望过滤文档列表以**仅**显示列表中的百事可乐项目。你如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:37:57.950

如果我理解正确，我认为这可以使用 MOSS 2007 中的开箱即用过滤器 Web 部件。Ton Stegeman（SharePoint MVP）的帖子听起来与您想要实现的目标相似（使用莫斯 2007):

*   [SharePoint 2007 筛选器 web 部件 - 在查找字段上使用页面字段筛选器 web 部件](http://www.tonstegeman.com/Blog/Lists/Posts/Post.aspx?ID=29)

正如 Scott Price 指出的那样，您也可以自己编写。Ton 的博客也有一些指导：

*   [MOSS 2007 Filter webparts 第 1 部分 - 创建您自己的提供者和消费者](http://www.tonstegeman.com/Blog/Lists/Posts/Post.aspx?ID=37)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:25:20.360

SharePoint 中的许多内置 Web 部件都是可连接的。但是，要实现您想要的，您可能必须构建自己的。请查看以下文章，了解所需内容的概述。 [http://msdn.microsoft.com/en-us/library/ms469765.aspx](http://msdn.microsoft.com/en-us/library/ms469765.aspx)

# linux - v4l2可以用来从同一设备读取音频和视频吗？

> ID：917060
> 
> 赞同：2
> 
> 时间：2009-05-27T17:37:35.813
> 
> 标签：linux, audio, video, v4l2

我有一张捕获卡，可以捕获带有嵌入音频的 SDI 视频。我有一个 Linux 驱动程序的源代码，我正在尝试增强它以添加对 video4linux2 的支持。我的更改基于 vivi 示例。

我遇到的问题是我能找到的所有示例都只处理视频或音频。即使在客户端，一切似乎都假设 v4l 只是视频，比如 ffmpeg 的 libavdevice。

我是否需要让我的驱动程序创建两个单独的设备，一个 v4l2 设备和一个 alsa 设备？似乎这使得保持音频和视频同步的工作变得更加困难。

对于在驱动程序和应用程序之间传递的每个缓冲区（通过 v4l2 的 mmap 接口），我希望以某种方式包含一个帧，以及一些与该帧匹配（相对于时间）的音频。

或者也许让每个缓冲区包含一个标志，指示它是视频帧还是音频块。然后缓冲区上的时间戳可用于同步。

但是我没有看到使用 V4L2 API 规范的方法，也没有看到任何支持 v4l2 的应用程序（gstreamer、ffmpeg、转码等）从单个设备读取音频和视频的示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:56:49.137

通常，设备的音频捕获部分显示为单独的设备。它通常是不同的物理设备（可能共享一张卡），这是有道理的。我不确定这有多大帮助，但这就是我熟悉的所有软件的工作方式......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-24T19:53:31.140

v4l2 缓冲区中有一些备用或保留字段，可用于通过指向映射缓冲区的指针将音频或其他数据从驱动程序传递到调用应用程序。

我修改了 BT8x8 驱动程序以使用这种方法将数据从 A/D 卡同步到 Ubuntu 6.06 上的视频。

它工作正常，但是维护我修改过的驱动程序的努力使我放弃了这种方法。

如果您仍然感兴趣，我可以挖掘细节。

如果您希望您的驱动程序使用 gstreamer 等播放，通常需要一个单独的音频设备。

大多数便宜的 v4l2 采集卡的音频只是模拟通过音量控制，需要跳线通过声卡的线路输入来采集音频。

# sql - 有没有更好的方法将 SQL 日期时间从 hh:mm:ss 转换为 hhmmss？

> ID：917062
> 
> 赞同：2
> 
> 时间：2009-05-27T17:37:49.403
> 
> 标签：sql, sql-server, tsql

我必须编写一个 SQL 视图，将 datetime 列的时间部分作为 hhmmss 格式的字符串返回（显然 SAP BW 不理解 hh:mm:ss）。

这段代码是 SAP 推荐的实现方式，但我认为必须有更好、更优雅的方式来实现这一点

```
TIME = case len(convert(varchar(2), datepart(hh, timecolumn)))
             when 1 then       /* Hour Part of TIMES */
               case convert(varchar(2), datepart(hh, timecolumn))
                 when '0' then '24'    /* Map 00 to 24 ( TIMES ) */
                 else '0' + convert(varchar(1), datepart(hh, timecolumn))
               end
            else convert(varchar(2), datepart(hh, timecolumn))
            end
         + case len(convert(varchar(2), datepart(mi, timecolumn)))
              when 1 then '0' + convert(varchar(1), datepart(mi, timecolumn))
              else convert(varchar(2), datepart(mi, timecolumn))
           end
         + case len(convert(varchar(2), datepart(ss, timecolumn)))
              when 1 then '0' + convert(varchar(1), datepart(ss, timecolumn))
              else convert(varchar(2), datepart(ss, timecolumn))
           end 
```

这样就达到了预期的效果，21:10:45 显示为 211045。

我喜欢更紧凑、更容易阅读的东西，但到目前为止，我还没有想出任何可行的方法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T21:07:24.533

**笔记：**

问题说该列是 datatype `DATETIME`，而不是较新的（SQL Server 2008） `TIME`数据类型。

**回答：**

```
 REPLACE(CONVERT(VARCHAR(8),timecolumn,8),':','') 
```

让我们打开它。

首先，`CONVERT`将 datetime 的时间部分格式化为 varchar，格式为 'hh:mi:ss'（24 小时制），由格式样式值 8 指定。

接下来，该`REPLACE`函数删除冒号，以获取 varchar 格式`'hhmiss'`。

这应该足以获得您需要的格式的可用字符串。

* * *

**后续问题**

（由 OP 问题提出）

**内联表达式是否比用户定义的函数更快/更少服务器密集？**

快速的答案是肯定的。更长的答案是：这取决于几个因素，您确实需要衡量性能以确定这是否真的正确。

我创建并执行了一个基本的测试用例：

```
    -- 样本表
    创建表 tmp.dummy_datetimes (c1 datetime)

    -- 在两个日期之间每分钟填充一行
    插入 tmp.dummy_datetimes
    select * from udfDateTimes('2007-01-01','2009-01-01',1,'minute')

    （1052641 行受影响）

    -- 验证表格内容
    选择 min(c1) 作为 _max
         , max(c1) 为 _min
         , count(1) as _cnt
      来自 tmp.dummy_datetimes

    _cnt _min _max
    -------- ------------------------ -------- ---
    1052641 2007-01-01 00:00:00.000 2009-01-01 00:00:00.000

```

（注意，udfDateTimes 函数以指定的时间间隔返回两个日期时间值之间的所有日期时间值的集合。在这种情况下，我在虚拟表中填充了整整两年每分钟的行。大约为一百万（ 2x365x24x60 ) 行。

现在，用户定义的函数使用相同的语法执行与内联表达式相同的转换：

```
    创建函数 [tmp].[udfStrippedTime] (@ad DATETIME)
    返回 VARCHAR(6)
    开始
    -- 目的：将 datetime 参数的时间部分格式化为 'hhmiss'
    --（用于与等效的内联表达式进行性能比较）
    -  修改的：
    -- 2009 年 5 月 28 日 spencer7593

       返回替换（转换（varchar（8），@ad，8），'：'，''）

    结尾

```

注意：我知道该函数未定义为`DETERMINISTIC`. （我认为这需要使用模式绑定和其他一些声明来声明函数，例如`PRAGMA`所需的 Oracle。）但是由于每个 datetime 值在表中都是唯一的，所以这无关紧要。该函数必须为每个不同的值执行，即使它被正确声明为`DETERMINISTIC`.

我不是这里的 SQL Server '用户定义函数'专家，所以我可能会错过其他一些东西，这些东西会无意和不必要地减慢函数的速度。

好的。

因此，在测试中，我交替运行每个查询，第一个，然后是另一个，一遍又一遍地连续运行。第一次运行的经过时间与后续运行一致。（通常情况并非如此，我们想放弃第一次运行的时间。）SQL Server Management Studio 以 hh:mi:ss 格式报告查询经过的时间到最接近的秒数，这就是我在这里报告的内容。

```
    -- 内联表达式的经过时间
    从 tmp.dummy_datetimes 中选择 replace(convert(varchar(8),c1,8),':','')

    00:00:10
    00:00:11
    00:00:10

    -- 等效用户定义函数的经过时间
    从 tmp.dummy_datetimes 中选择 tmp.udfStrippedTime(c1)

    00:00:15
    00:00:15
    00:00:15

```

对于这个测试用例，我们观察到用户定义的函数比等效的内联表达式慢 45%。

高温高压

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T17:46:55.423

您可以使用用户定义的函数，例如：

```
create FUNCTION [dbo].[udfStrippedTime]
(
    @dt datetime
)
RETURNS varchar(32)
AS
BEGIN
    declare @t varchar(32)
    set @t = convert( varchar(32), @dt, 108 )
    set @t = left(@t,2) + substring(@t,4,2)

    RETURN @t
END 
```

然后

```
select dbo.udfStrippedTime(GETDATE()) 
```

秒的逻辑留给读者练习

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T17:49:41.000

**编辑 2：**更新以处理 0 --> 24 转换，以及更短的版本：

```
select replace(left(replace(convert(char,getdate(),8),':',''),2),'00','24') + right(replace(convert(char,getdate(),8),':',''),4) 
```

回到稍长的版本:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T18:14:15.320

这是一个问题。是否需要在 Db 服务器上进行格式化？服务器本身真的只关心，并且针对存储数据进行了优化。查看数据通常是 Db 之上的 hte 层的职责（在严格的学术意义上，现实世界有点混乱）

例如，如果您将结果输出到绑定到 GridControl 的 ASP.NET 页面中，您只需在绑定到列时指定 DataFormattingString。如果您使用 c# 将其写入文本文件，当您提取数据时，您只需将格式字符串传递给 .ToString() 函数。

如果您需要将它专门放在 DbServer 上，那么是的，几乎每个解决方案都会变得混乱，因为您需要的时间格式虽然紧凑且合乎逻辑，但不是服务器将识别的时间格式，因此您需要对其进行操作作为一个字符串。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T18:16:24.940

这处理 00 - > 24 转换

```
SELECT CASE WHEN DATEPART(hh,timecolumn) = 0 
    THEN  '24' + SUBSTRING(REPLACE(CONVERT(varchar(8),timecolumn, 108),':',''),3,4)
    ELSE REPLACE(CONVERT(varchar(8),timecolumn, 108),':','') END 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T18:39:49.090

SELECT replace(convert(varchar(15),datetimefield, 108), ':','') 从表

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T17:49:59.330

选择替换（'2009-05-27 12:49:19'，':'，''）2009-05-27 124919

# asp.net-mvc - 如何构建、分区和构建大型 MVC 应用程序以进行小增量部署？

> ID：917077
> 
> 赞同：5
> 
> 时间：2009-05-27T17:41:31.050
> 
> 标签：asp.net-mvc

我们将开发一个非常大的垂直市场 Web 应用程序，并且倾向于 MVC 方法。

它将具有应用程序中所有视图共有的 1 个母版页。Master 将为整个应用程序提供导航/搜索框架，允许用户搜索和选择实体，然后导航到要执行的功能。

数据库模型将有 700 到 1000 个表。该应用程序将有数百个控制器。

控制器及其视图可以组合到应用程序中的众多 (20-50) 子系统之一中。（我们正在研究一种区域方法来帮助组织）。

我们希望能够以小功能块的形式提供增强/更新。这些可能是新功能、错误修复、客户相关功能或最终用户单独购买的可选模块。

我们花了太多年时间开发/支持和交付一个大型 Windows vb 应用程序 exe。我们想采取另一种方法。

管理层不想交付一个大型应用程序。他们希望能够在必要时交付小的增量部分。

我们可能想要创建一个包含一个控制器、只有几个视图和模型的一部分的可交付成果。

为了交付它，我们要将 dll 复制到 bin 文件夹，并创建一个 View 文件夹并复制到新视图中。尽可能简单！

我花了很多天研究这个，还没有想出一个明确的路径来继续。（我发现的每个教程和文章都假设一个项目。）

我们如何构建应用程序来实现这一点？

我们如何将应用程序分解为单独的项目/程序集来做到这一点？

您能否构建一个包含母版页、身份验证和全局路由的基础项目，然后在每个模块的可能数百个其他项目中的每一个中引用它？

在开发中，每个子项目是否需要包含整个基础项目，或者只是共享视图文件夹、全局路由和 web.config 以及对基础项目 dll 的引用？

解释这种方法的任何详细文件？

任何开发/测试问题？

感谢所有输入，我们必须尽快完成。

**更新：**

按照此处的示例[链接文本](http://blog.maartenballiauw.be/post/2009/04/21/ASPNET-MVC-and-the-Managed-Extensibility-Framework-%28MEF%29.aspx)

这是一个很好的起点！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:12:11.993

我认为这正是 DLR 可以提供帮助的情况。您的控制器和视图可以作为脚本存储在数据库中。将您的应用程序作为一组“小功能块”交付将非常容易。您可以从阅读[Haacked - Scripting ASP.NET MVC Views Stored In The Database开始](http://haacked.com/archive/2009/04/22/scripted-db-views.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:09:55.427

当然，将项目分解为包含控制器的子项目/模块。您可以使用 Unity、Spring.Net 或 Castle Windsor 等 IoC 容器在子项目中找到合适的控制器。

实现您自己的 IControllerFactory 以根据传递给它的控制器名称在 IoC 容器中执行控制器查找。您正在寻找一个类似于以下内容的 IControllerFactory.CreateController 方法：

```
public IController CreateController(RequestContext requestContext, string controllerName) 
{
  return (IController)IoCContainer.GetObjectByName(controllerName);
} 
```

然后您应该能够简单地修改您的 IoC 配置文件以在部署新控制器时定义它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T21:02:05.043

Google for MVC 与 MEF。MEF 团队中有一个例子可以完全满足您的需求。

# iphone - UITextField 和 UITextView 的内容到 NSString

> ID：917085
> 
> 赞同：2
> 
> 时间：2009-05-27T17:42:57.817
> 
> 标签：iphone, nsstring, uitextfield, uitextview

我有一个 UITextView 和 2 个 UITextField 设置。当点击屏幕的空白部分时，UITextView 退出第一响应者状态，对于 2 UITextField 也是如此，另外对于这两个，返回键也退出第一响应者状态。所有 3 个都在接口中声明。

我想将所有这些内容获取到单独的 NSString 和/或学习如何将它们直接输入到类似的内容中：

```
NSString *urlstr = [[NSString alloc] initWithFormat:@"http://server.com/file.php?var1=%@&var2=%@&var3=%@", *content of UITextView*, *content of UITextField*, *content of UITextField*]; 
```

这是一个非常基本的问题，我知道，但我几乎是一个新手。如果我学会如何做到这一点，我可能能够从那里接起。

干杯

（已编辑）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T17:48:07.883

UITextField 和 UITextView 都有一个`text`可用于检索字符串值的属性。例如，

`NSString *string = [NSString stringWithFormat:@"%@, %@", textField.text, textView.text];`

请记住，在将字符串放入 URL 之前，您可能需要检查字符串以确保它们不为空或包含无效字符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-02T07:44:56.410

*公认的答案很好，我只是想添加以下内容以扩展查看在 iOS 中抓取文本。*

请参阅`textInRange:`以下代码的方面，我设计使用一个函数来确定文本是 UITextField、UITextView 还是任何其他符合 UITextInput 协议的类。

```
//handle text container object length whether it's a UITextField, UITextView et al
NSUInteger LengthOfStringInTextInput(NSObject<UITextInput> *textContainer)
{
    UITextPosition *beginningOfDocument = [textContainer beginningOfDocument];
    UITextPosition *endOfDocument =       [textContainer endOfDocument];
    UITextRange    *fullTextRange =       [textContainer textRangeFromPosition:beginningOfDocument 
                                                                    toPosition:endOfDocument];
    return [textContainer textInRange:fullTextRange].length;
} 
```

通过将返回类型更改为 NSString 并删除 .length 您可以在任何类上拥有 text 属性的功能。

# reporting-services - SSRS 模板

> ID：917088
> 
> 赞同：2
> 
> 时间：2009-05-27T17:43:41.043
> 
> 标签：reporting-services, reportingservices-2005, ssrs-2008

我试图弄清楚您是否可以为 SSRS 报告创建模板文件或皮肤。我们正在尝试标准化我们所有的报告，使其看起来相似。如果没有已知的方法来创建模板或皮肤，您如何解决此问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T07:02:09.937

如果您使用商业智能设计工作室来创建您的报告，这是我们用于 SQL 2005 的方法：

*   通过自定义 default.rdl 创建模板
*   复制到`C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\PrivateAssemblies\ProjectItems\ReportProject`
*   `Add > New Item`当您在解决方案资源管理器中选择时，此模板会显示在 BIDS中

我们使用批处理脚本在所有开发机器上复制最新模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T17:48:18.570

是的。它们被称为 RDLC 文件。

您基本上可以指定报告在这些文件中的外观，这些文件只是 XML 文件。Visual Studio 中有一个用于这些文件的内置编辑器，它是拖放式的，非常易于使用。

# asp.net - 有没有办法确保 ASP.NET 应用程序（仅）在 HTTPS 协议上运行？

> ID：917089
> 
> 赞同：5
> 
> 时间：2009-05-27T17:43:55.177
> 
> 标签：asp.net, http, iis, https

我想知道是否有办法确保 ASP.NET 应用程序只能使用 HTTPS 协议运行

我可以使用任何可以解决问题的代码（也许是防御性编程措施？），或者可能是一些可以完成工作的 IIS/Web 服务器设置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T17:45:41.460

IIS 肯定会允许您要求使用 HTTPS。说明[在这里](http://support.microsoft.com/kb/324069)。

**编辑：**我不得不去挖掘它，但还有[Request.IsSecureConnection](http://msdn.microsoft.com/en-us/library/system.web.httprequest.issecureconnection.aspx)用于防御性编程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T18:02:23.190

在 IIS 级别强制执行 SSL 的唯一问题是用户收到丑陋的 403.4 页面错误

> “该页面必须通过安全通道查看”

`Request.IsSecureConnection`为了使转换无缝，您可以使用如果用户不通过 SSL 生成请求，则将用户重定向到安全站点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:57:24.793

[至少privilege.com](http://www.leastprivilege.com/)上有一篇不错的[文章](http://www.leastprivilege.com/PartiallySSLSecuredWebAppsWithASPNET.aspx)，其中包含一些很好的信息和一个关于这个主题的辅助实用程序类

# sql - 为什么这个 MySQL 函数返回 null？

> ID：917091
> 
> 赞同：1
> 
> 时间：2009-05-27T17:44:03.680
> 
> 标签：sql, mysql, stored-functions

**说明：** 实际运行的查询返回了4个结果，从下面可以看出，我所做的只是连接项目然后返回，但没想到它是空的。

我认为代码是不言自明的：

```
DELIMITER |

DROP FUNCTION IF EXISTS get_idiscussion_ask|

CREATE FUNCTION get_idiscussion_ask(iask_id INT UNSIGNED) RETURNS TEXT DETERMINISTIC
BEGIN
  DECLARE done INT DEFAULT 0;
  DECLARE body varchar(600);
  DECLARE created DATETIME;
  DECLARE anonymous TINYINT(1);
  DECLARE screen_name varchar(64);
  DECLARE result TEXT;
  DECLARE cur1 CURSOR FOR SELECT body,created,anonymous,screen_name from idiscussion left join users on idiscussion.uid=users.id where idiscussion.iask_id=iask_id;
  DECLARE CONTINUE HANDLER FOR SQLSTATE '02000' SET done = 1;

  SET result = '';
  OPEN cur1;
  REPEAT
    FETCH cur1 INTO body, created, anonymous, screen_name;
    SET result = CONCAT(result,'<comment><body><![CDATA[',body,']]></body>','<replier>',if(screen_name is not null and !anonymous,screen_name,''),'</replier>','<created>',created,'</created></comment>');
  UNTIL done END REPEAT;
  CLOSE cur1;

  RETURN result;
END |

DELIMITER ;

mysql> DELIMITER ;
mysql> select get_idiscussion_ask(1);
+------------------------+
| get_idiscussion_ask(1) |
+------------------------+
| NULL                   |
+------------------------+
1 row in set (0.01 sec)

mysql> SELECT body,created,anonymous,screen_name from idiscussion left join users on idiscussion.uid=users.id where idiscussion.iask_id=1;
+------+---------------------+-----------+-------------+
| body | created             | anonymous | screen_name |
+------+---------------------+-----------+-------------+
| haha | 2009-05-27 04:57:51 |         0 | NULL        |
| haha | 2009-05-27 04:57:52 |         0 | NULL        |
| haha | 2009-05-27 04:57:52 |         0 | NULL        |
| haha | 2009-05-27 04:57:53 |         0 | NULL        |
+------+---------------------+-----------+-------------+
4 rows in set (0.00 sec) 
```

对于那些不认为代码不言自明的人：

**为什么函数返回`NULL`？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T17:50:51.437

重命名变量和输入参数，它们是不明确的。

这个查询：

```
SELECT  body, created, anonymous, screen_name
FROM    idiscussion
LEFT JOIN
        users
ON      idiscussion.uid = users.id
WHERE   idiscussion.iask_id = iask_id 
```

返回您之前声明的变量（即`NULL`），而不是表列。

在变量名称和输入参数名称前加上下划线。

您还对结果进行了额外的分配：

```
FETCH cur1 INTO body, created, anonymous, screen_name;
SET result = CONCAT(result,'<comment><body><![CDATA[',body,']]></body>','<replier>',if(screen_name is not null and !anonymous,screen_name,''),'</replier>','<created>',created,'</created></comment>'); 
```

处理程序`done`在`FETCH`失败后设置，但`result`仍然被分配。

将您的处理程序更改为：

```
DECLARE EXIT HANDLER FOR SQLSTATE '02000' RETURN result; 
```

最后：在 中`MySQL`，这可以通过单个查询来完成。没有必要用函数来做。

```
SELECT  GROUP_CONCAT(CONCAT(result,'<comment><body><![CDATA[',body,']]></body>','<replier>',if(screen_name is not null and !anonymous,screen_name,''),'</replier>','<created>',created,'</created></comment>') SEPARATOR '')
FROM   idiscussion
LEFT JOIN
       users
ON     idiscussion.uid=users.id
WHERE  idiscussion.iask_id = @_iask_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T18:39:01.837

请记住，将任何字符串与 NULL 连接在一起会返回 NULL。试试这个测试：

```
mysql> SET @s = 'test string';
mysql> SET @s = CONCAT(@s, '<tag>', NULL, '</tag>');
mysql> SELECT @s; 
```

这将返回 NULL。

因此，当您遍历游标时，如果`body`或`created`列在任何行上为 NULL，则`result`变为 NULL。然后在循环的后续迭代中，与 NULL 连接的任何内容`result`都无效；它保持为 NULL。

尝试这样的事情：

```
REPEAT
    FETCH cur1 INTO body, created, anonymous, screen_name;
    SET result = CONCAT(result, 
      '<comment><body><![CDATA[', 
      COALESCE(body, ''),
      ']]></body>', 
      '<replier>', 
      IF(COALESCE(anonymous, 0) != 0, COALESCE(screen_name, ''), ''), 
      '</replier>',
      '<created>',
      COALESCE(created, ''),
      '</created></comment>'
    );
UNTIL done END REPEAT; 
```

该`COALESCE()`函数是标准 SQL 中的一个有用函数。它返回其第一个非 NULL 参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-26T23:10:33.307

CONCAT_WS(separator, str1, str2,...) CONCAT_WS() 代表 CONCAT With Separator，是 CONCAT() 的一种特殊形式。第一个参数是其余参数的分隔符。在要连接的字符串之间添加分隔符：分隔符可以是字符串，其余参数也可以。如果分隔符为 NULL，则结果为 NULL。该函数跳过分隔符参数后的任何 NULL 值。

mysql>

```
SELECT CONCAT_WS(",","First name","Second name","Last Name");
   -> 'First name,Second name,Last Name' 
```

mysql>

```
SELECT CONCAT_WS(",","First name",NULL,"Last Name");
   -> 'First name,Last Name' 
```

在 MySQL 4.0.14 之前，CONCAT_WS() 会跳过空字符串以及 NULL 值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T18:39:21.727

我尽量冗长，因为你的问题不是;）

您期望函数的返回值是非 NULL，因为您通过仅连接非 NULL 字符串来创建返回值。

只有当其中一个字符串为 NULL 时，整个返回值才会为 NULL。您的演示数据仅在 screen_name 中包含 NULL 值，但您尊重这种情况。

但不知何故（atm 我不知道如何）其中一个值必须是 NULL 并且相关行以查看具有大 CONCAT 的那个。

如果出于调试原因将相关行缩短为：

```
SET result = if(screen_name is not null,screen_name,'') 
```

它仍然返回NULL吗？

# xml - 从 jsp 中删除中断

> ID：917094
> 
> 赞同：1
> 
> 时间：2009-05-27T17:45:13.630
> 
> 标签：xml, whitespace, trim

我有一个根据 XSLT 转换 XML 的函数。为了测试它，我在 jsp 中使用它，但它在我的输出之前输入了很多中断。这似乎是我在设置变量时输入的中断：

```
<c:set var="blah" value="blah" />
<c:set var="blah2" value="blah2" /> 
```

这将在输出之前显示两个换行符。有没有办法用 XML 来避免这种情况？我尝试添加 trimDirectiveWhitespaces="true" 但没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T14:02:12.803

如果你使用 Tomcat 来解析你的 jsp，你可以试试：

> ```
> <init-param>
>     <param-name>trimSpaces</param-name>
>     <param-value>true</param-value>
> </init-param> 
> ```

在您的 web.xml 中。YMMV

否则，我认为 JSP 2.1 支持以下内容：

最后一个解决方案是在你的 JSP 渲染和 XSLT 计算之间实现一个过滤器，这不起作用。可以调用一个简单的过滤器来修剪生成的主体周围的空间。

# git - 在 Git 中，有没有办法为任意提交获取“友好”名称？

> ID：917102
> 
> 赞同：19
> 
> 时间：2009-05-27T17:46:48.793
> 
> 标签：git

在 Git 中，有很多方法可以引用提交，包括完整的 SHA 哈希或哈希的缩短形式（例如，前 6 个字符左右）。您还可以使用“友好”语法命名提交，例如 HEAD、HEAD^、HEAD^^、HEAD~3 等。

给定 SHA 哈希形式的任意提交，Git 中是否有工具可以为所述提交找到“友好”名称？

如果我使用`git-show-branch`，我会得到一个“友好”形式的修订列表，所以我觉得必须有一种方法......我只是找不到一个工具来做到这一点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-27T18:09:13.520

您可以使用“git name-rev”来获取您要询问的表格。这种形式的一个问题是，相对于一个分支，它不是一个永久的名称。因此，另一种选择是“git describe”，它根据给定提交的标记提前多远产生一个替代友好名称。

例如：

```
srh@devo16:~/src/git <master>$ git name-rev 3cd7388
3cd7388 master~2 
```

但是在我做了一个“git pull”之后，master~2 可能意味着别的东西。相比之下：

```
srh@devo16:~/src/git <master>$ git describe 3cd7388
v1.6.3.1-153-g3cd7388 
```

现在“v1.6.3.1-153-g3cd7388”是一个永久名称。当然，它仍然有点长（尽管您可以通过例如指定“--abbrev=4”来缩短最后的哈希位）但它表明 3cd7388 是 1.6.3.1 版之后的 153 次更改。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T18:09:35.533

尝试`git describe`：

```
$ git describe --all --contains 90de2680dc54c0d600b0694bd175bd09357a8dba
master~2 
```

# emacs - VS2005 emacs 仿真模式下的 Intellisense Trigger 是什么？

> ID：917103
> 
> 赞同：1
> 
> 时间：2009-05-27T17:46:54.830
> 
> 标签：emacs, visual-studio-2005, intellisense

我已经在 VS2005 中启用了 emacs 键盘模式，到目前为止我很喜欢。

我遇到的唯一问题是我找不到触发 IntelliSense 菜单的热键。Cj 不再起作用，因为它被映射到其他东西。

那么什么是emacs-mode IntelliSense 触发键呢？

其次，如何去找出它是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T23:03:18.403

IntelliSense 触发器是 Alt-/（传统 emacs 表示法中的 M-/）。

这个和许多其他与格式相关的命令位于编辑菜单底部的子菜单中。

# java - 在 DefaultCellEditor 派生实例完成其工作后更新单元格渲染器

> ID：917105
> 
> 赞同：0
> 
> 时间：2009-05-27T17:47:11.023
> 
> 标签：java, swing, jtable

我使用`JTable`具有自己的单元格渲染器和单元格编辑器的 a。

比如说，这个表包含 2 列和 x 行：
第一列包含一个布尔值，它自己的单元格渲染和单元格编辑器（一个单选按钮）
第二列包含一个字符串值，它自己的单元格渲染器：它在第一个当前行的列设置为 true（选中单选按钮）

编辑器正确更新了所有值，但是当单选按钮设置为 true 时，第二行不会变为粗体...
我必须检查不同行的单选按钮才能查看更改

我在哪里可以触发这些更改？

干杯并感谢您的帮助

* * *

*RadiobuttonTableCellEditor.java*

```
public class RadiobuttonTableCellEditor extends DefaultCellEditor
                                    implements ItemListener {
JRadioButton rb = new JRadioButton();

public RadiobuttonTableCellEditor(JCheckBox pCheckBox) {
    super(pCheckBox);
}

public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row, int column) {
    if (value == null)
        return null;
    rb.addItemListener(this);
    rb.setSelected((Boolean)value);
    return rb;
}

public void itemStateChanged(ItemEvent e) {
    super.fireEditingStopped();
}

public Object getCellEditorValue() {
    rb.removeItemListener(this);
    return rb.isSelected();
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T04:18:04.567

在您的表模型中，每当您的值发生变化时，您都必须触发适当的事件。如果您的模型是从您那里继承而来的`AbstractTableModel`，则可以使用多种`fireXXX`方法。我的猜测是你应该从`setValueAt`方法中调用它们。

如果您知道确切的列和行 - 您可以调用`fireTableCellUpdated`，否则您可能必须使用`fireTableChanged`，因为您必须更新不同的列。

当然，您的渲染器应该正确渲染新值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:47:22.897

延伸到那里似乎没有任何意义`DeafultCellEditor`。实现这样的监听器接口也不是一个好主意。

渲染器作为薄层效果最好。如果另一个单元格应该更改，那么这需要反映在应该触发相关更新事件的表模型中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T13:44:25.647

我想它可以帮助有类似问题的人，使`true`单选按钮连续唯一，你必须扩展它`DefaultTableModel`来修改它的行为，尤其是`setValueAt`方法

干杯

* * *

```
/**
 * When <code>column</code> is the column that contains the Boolean (in fact the radio button):
 * If aValue == false and that it had a previous value set to true we don't do anything
 * If aValue == true and that it had a previous value set to false, we set all the other booleans to false and this one to true
 */
@Override
public void setValueAt(Object aValue, int row, int column) {
    if (column == colonneBoutonradio)
    {
        if (((Boolean)aValue && !(Boolean)super.getValueAt(row, column)))
            for (int i = 0; i < this.getRowCount(); i++)
                // i==row permet de vérifier si la ligne courante est celle à modifier (et donc celle à mettre à true)
                super.setValueAt(i==row, i, colonneBoutonradio);
    }
    else
        super.setValueAt(aValue, row, column);
} 
```

# sql - 如何优化 3 个表的 m:n 关系查询

> ID：917106
> 
> 赞同：0
> 
> 时间：2009-05-27T17:47:36.870
> 
> 标签：sql, database-design, relation

这是我的 sql 问题 - 有 3 个表：

```
名称列表 ListHasNames
Id 名称 Id 描述 ListsId NamesId
=-------- ------------ ----------------
1 保罗 1 足球 1 1
2 乔 2 篮球 1 2
3 珍妮 3 乒乓球 2 1
4 蒂娜 4 早餐俱乐部 2 3
              5 午夜俱乐部 3 2
                                   3 3
                                   4 1
                                   4 2
                                   4 3
                                   5 1
                                   5 2
                                   5 3
                                   5 4

```

这意味着 Paul (Id=1) 和 Joe (Id=2) 在足球队 (Lists.Id=1)，Paul 和 Jenny 在篮球队，等等...

现在我需要一个返回特定名称组合的 Lists.Id 的 SQL 语句：在哪些列表中 Paul、Joe 和 Jenny 是该列表的唯一成员？只回答 Lists.Id=4（早餐俱乐部） - 但不回答 5（午夜俱乐部），因为 Tina 也在该列表中。

我已经尝试过使用 INNER JOINS 和 SUB QUERIES：

```
选择 Q1.Lists_id FROM

(
选择 Lists_Id FROM
  名称为 T1，
  列表名称为 T2
在哪里
  (T1.Name='Paul') 和
  (T1.Id=T2.Names_ID) 和
   ( (
     选择计数（*）从
      列表名称为 Z1
     其中（Z1.lists_id = T2.lists_Id）
    ) = 3)

) 作为第一季度

内部联接 （

选择 Lists_Id FROM
  名称为 T1，
  列表名称为 T2
在哪里
  (T1.Name='Joe') 和
  (T1.Id=T2.Names_ID) 和
  (
    （选择计数（*）来自
      列表名称为 Z1
     哪里（Z1.Lists_id = T2.lists_id）
    ) = 3)

) 作为第二季度

开（Q1.Lists_id=Q2.Lists_id）

内部联接 （

选择 Lists_Id FROM
  名称为 T1，
  列表名称为 T2
在哪里
  (T1.Name='Jenny') 和
  (T1.Id=T2.Names_ID) 和
  (
    （选择计数（*）来自
      列表名称为 Z1
     哪里（Z1.Lists_id = T2.lists_id）
    ) = 3)

) 作为第三季度

开（Q1.Lists_id=Q3.Lists_id）

```

看起来有点复杂，嗯？如何优化它？我只需要包含特定名称的 Lists.Id（并且只有这些名称，没有其他人）。也许选择输入？

问候，丹尼斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:01:46.177

```
SELECT ListsId
FROM ListHasNames a
WHERE NamesId in (1, 2, 3)
AND NOT EXISTS
(SELECT * from ListHasNames b 
WHERE b.ListsId = a.ListsId 
AND b.NamesId not in (1, 2, 3))
GROUP BY ListsId
HAVING COUNT(*) = 3; 
```

**编辑**：由于 Chris Gow 的评论而更正；子选择对于排除其他人的列表是必要的。 **编辑 2**由于丹尼斯的评论更正了表名

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:41:36.113

使用 Carl Manaster 的解决方案作为起点，我想出了：

```
SELECT listsid 
FROM listhasnames 
GROUP BY listsid HAVING COUNT(*) = 3
INTERSECT
SELECT x.listsid 
FROM listhasnames x, names n 
WHERE n.name IN('Paul', 'Joe', 'Jenny') 
AND n.id = x.namesid 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T17:58:30.763

更新：

```
select a.ListsId from
(
    --lists with three names only
    select lhn.ListsId, count(*) as count
    from ListHasNames  lhn
    inner join Names n on lhn.NamesId = n.Id 
    group by lhn.ListsId
    having count(*) = 3
) a
where a.ListsId in (select ListsId from ListHasNames lhn where NamesId = (select NamesId from names where Name = 'Paul'))
and a.ListsId in (select ListsId from ListHasNames lhn where NamesId = (select NamesId from names where Name = 'Joe'))
and a.ListsId in (select ListsId from ListHasNames lhn where NamesId = (select NamesId from names where Name = 'Jenny')) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T19:56:31.150

我最近刚刚解决了一个问题，它也可能适用于您的情况。这可能是矫枉过正。

我采用了创建可能是正确解决方案的候选关联列表的方法，然后使用游标或队列表来检查可能正确的解决方案以进行全面验证。

就我而言，这是通过执行类似操作来实现的

```
select
ParentId
count(*) as ChildCount
checksum_agg(checksum(child.*) as ChildAggCrc
from parent join child on parent.parentId = child.parentId 
```

然后，您可以将计数和聚合校验和与您的查找数据（即要检查的 3 个名称）进行比较。如果没有行匹配，则保证没有匹配项。如果任何行匹配，您可以通过并执行该特定 ParentId 的连接，以验证行集之间是否存在任何差异。

清如泥？:)

# c# - 在 Silverlight 中，如果客户端 CPU 超频，DateTime 会受到影响吗？

> ID：917109
> 
> 赞同：0
> 
> 时间：2009-05-27T17:48:05.607
> 
> 标签：c#, silverlight, cpu

在 Silverlight 应用程序中，如果客户端 CPU 超频，DateTime 结构会返回正确的时间吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T17:52:16.050

是的。实时时钟不受 CPU 时钟的影响。

在没有 RTC 的计算机上，这可能是个问题。不再。

（听起来您确实有另一个问题要问。）

# c# - NUnit 2.5 在 Visual Studio 中返回不确定状态

> ID：917112
> 
> 赞同：1
> 
> 时间：2009-05-27T17:48:19.163
> 
> 标签：c#, visual-studio, unit-testing, nunit

所以'我要参加单元测试。我创建了一个非常简单的函数来测试它。

```
 public int MultiplyByFive(int x)
    {
        return x * 5;
    } 
```

测试方法包含

```
 [TestMethod()]
    [DeploymentItem("UnitTestApp.exe")]
    public void MultiplyByFiveTest()
    {
        Program_Accessor target = new Program_Accessor(); // TODO: Initialize to an appropriate value
        int x = 5; // TODO: Initialize to an appropriate value
        int expected = 25; // TODO: Initialize to an appropriate value
        int actual;
        actual = target.MultiplyByFive(x);
        Assert.AreEqual(expected, actual);
        Assert.Inconclusive("Verify the correctness of this test method.");
    } 
```

但是当我运行测试时它返回：

[nunit http://dl.getdropbox.com/u/357576/nunit.jpg](http://dl.getdropbox.com/u/357576/nunit.jpg)

“Assert.Inconclusive 失败。验证此测试方法的正确性。”

那么我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T17:54:58.527

NUnit 2.5 在成功和失败之间添加了“不确定”作为结果状态。[此处的发行说明中对此进行了说明](http://nunit.com/index.php?p=releaseNotes&r=2.5)。

NUnit 正在做你告诉它做的事情。新的不确定状态会终止测试。如果您希望在 Assert 失败的情况下显示消息，则 Assert.AreEqual() 具有采用消息字符串的重载。使用它，并删除 Assert.Inconclusive()。

```
Assert.AreEqual(expected, actual, "Verify the correctness of this test method."); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T17:54:10.307

`Assert.Inconclusive`如果您确定您的测试是正确的，则需要删除:)

# oop - OOP 新手：直接访问字段与将对象作为参数传递

> ID：917115
> 
> 赞同：5
> 
> 时间：2009-05-27T17:49:09.770
> 
> 标签：oop

假设 Object1 需要来自 Object2 的信息。我会说它在 Object2 属性中，但信息很容易成为 Object2 函数的返回值。当我查看其他人的代码时，我有时会看到他们在 Object1 中有一个方法可以直接访问该属性。其他时候，我看到人们将 Object2 作为方法中的参数传递，然后从传递的 Object2 访问属性。

这些场景在我看来几乎是一样的。直接访问该属性似乎更简单。作为一个新手，您认为我在决定 Object1 应该如何从 Object2 获取信息时应该考虑什么？（我什么时候想要一个对象参数而不是直接访问属性？）

谢谢——Al C.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T17:52:05.177

将 Object2 传递给 Object1 的一个问题是您在 Object2 和 Object1 之间创建了依赖关系。Object1 获得所需数据的唯一方法是引用 Object2。

现在，有时你想要那个，但大多数时候你不想要。因此，您最好将所需的值作为参数传递给方法，而不是传递 Object2 的实例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T17:58:43.947

如果该方法只需要 Object2 中的一个属性值，则最好直接传递该属性值。如果该方法需要访问 Object2 的许多属性或其他功能，则传递对 Object2 的引用将是合适的。

也有例外——如果您需要保护方法的签名（即它是公共的）并且您预计将来会在方法中额外使用 Object2，则传递对象引用可能是合适的。

先前的答案也提出了有效的观点 - 在做出此决定时，您应该考虑 Object1 和 Object 2 的耦合。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T18:02:30.633

通常目标是最小化对象之间的耦合。

让我们用一个简单的例子，我有三个对象；一个 AppController，它包含对 DataController 和 MainWindowController 的引用。您需要将 DataController.Data 传递给 MainWindowController，以便您可以在主窗口的表格中显示值。您可以将 DataController 作为方法参数传递给 MainWindowController，或者将 DataController 作为 MainWindowController 中的实例变量。为了最大限度地减少耦合，最干净的方法是 AppController 直接将 Data 传递给 MainWindowController，因此它不需要了解有关 DataController 的任何信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T17:55:19.320

这完全取决于 Object1 是否知道 Object2。在 OOP 中，良好设计的一部分是将对象存储为尽可能少的信息，这仍然允许它们正常运行。所以问题从根本上归结为：Object1 是否需要知道 Object2 的存在（即它是否**需要**Object2 的实例才能存在）或者是否可以**告诉**它Object2 实例的存在？通常，在 OOP 中，您希望更倾向于后者而不是前者。

然而，话虽如此，在 Object1 可以对来自 Object2 的数据进行操作的情况下，最好的方法可能是让 Object1 有一个对 Object2 上属性的数据**类型进行操作的方法；**这样，您将 Object1 和 Object2 解耦，因为 Object1 不**依赖**于 Object2 以给定方式提供给定属性；调用代码可以连接两者。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T17:58:02.140

是的，Randolpho 说的是真的。

请记住，使用 OOP，您的目标是创建可以在系统中作为一个整体发挥作用的单独身份。当您开始创建相互严重依赖的对象时，不仅会增加出现错误的机会，还会增加您的程序不再工作的机会。

现在您的示例是次要的，但想象 5、10、100 个对象通过参数相互调用，这是一件令人讨厌的工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T18:01:59.587

看看维基百科上的[封装](http://en.wikipedia.org/wiki/Encapsulation_%28computer_science%29)。

> 封装 [..] 通过防止用户将组件的内部数据设置为无效或不一致的状态来保护组件的完整性。

# c++ - 检查静态库/可执行文件的依赖关系

> ID：917118
> 
> 赞同：8
> 
> 时间：2009-05-27T17:49:49.877
> 
> 标签：c++, visual-studio-2008, static

我有一个相当大的项目，其中包含大量链接的依赖项。问题是有一个依赖链接到它是用 VS 2005 编译的，并与 vc80 调试 crt 链接，而我已经迁移到 VS 2008。问题是这也意味着我必须安装 vc80 调试 crt，我宁愿避免的事情，因为我不再使用安装 VS 2005。我希望能够找到罪魁祸首并避免从头开始重新编译整个项目和所有依赖项，那么，是否有一种方便的方法来找出哪个依赖项链接到 vc80 调试 crt？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T18:20:41.937

似乎dumpbin 使用-directives 开关可以解决问题，非常方便。它显示有关 lib 文件的各种有用信息，其中包括所有链接的依赖项及其版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T18:04:04.077

我不确定它是否适合您，但请看一下[Dependency Walker](http://www.dependencywalker.com/)。

# c++ - 将相似的函数组合成一个通用函数，包括将函数指针作为参数传递

> ID：917120
> 
> 赞同：5
> 
> 时间：2009-05-27T17:50:10.330
> 
> 标签：c++

我正在尝试将以下两个功能组合成一个可移植功能：

```
void NeedleUSsim::FindIdxRho()
{
    searchTmp = &ninfo->rho;
    double *p = std::find_if(tplRho_deg, tplRho_deg+sampleDim[2], &NeedleUSsim::GreaterThanOrEqualTo);
    while(p != tplRho_deg+sampleDim[2])
    {
        idxRho = p - tplRho_deg;
        p = std::find_if(p+1, tplRho_deg+sampleDim[2], &NeedleUSsim::GreaterThanOrEqualTo);
    }
}

void NeedleUSsim::FindIdxDepth()
{
    searchTmp = &ninfo->l;
    double *p = std::find_if(tplL, tplL+sampleDim[1], &NeedleUSsim::LessThanOrEqualTo);
    while(p != tplL+sampleDim[1])
    {
        idxL = p - tplL;
        p = std::find_if(p+1, tplL+sampleDim[1], &NeedleUSsim::LessThanOrEqualTo);
    }
} 
```

理想情况下，我希望函数的参数有 tpl 成员作为指针传递，大小和 rho/l 作为值传递。searchTmp 是文件范围双精度指针。是否有任何简单的方法可以将 &NeedleUSsim::GreaterThanOrEqualTo 函数作为我试图轻松编写的函数的参数传递？

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T18:05:17.287

使代码更通用的最简单方法如下：

```
template<typename ComparisonType>
double* NeedleUSsim::FindIdx(double* containerBegin, double* containerEnd, ComparisonType comparison) {
    double* p = std::find_if(containerBegin, containerEnd, comparison);
    double* idx = 0;
    while(p != containerEnd)
    {
        idx = p - containerBegin;
        p = std::find_if(p+1, containerEnd, comparison);
    }
    return idx;
}

void NeedleUSsim::FindIdxRho()
{
  searchTmp = &ninfo->rho;
  double* idx = FindIdx(tplRho_deg, tplRho_deg+sampleDim[2], &NeedleUSsim::GreaterThanOrEqualTo);
  if( idx != 0 )
  {
    idxL = idx;
  }

}

void NeedleUSsim::FindIdxDepth()
{
  searchTmp = &ninfo->l;
  double* idx = FindIdx(tplL, tplL+sampleDim[1], &NeedleUSsim::LessThanOrEqualTo);
  if( idx != 0 )
  {
    idxRho = idx;
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T18:03:41.830

> 是否有任何简单的方法可以将 &NeedleUSsim::GreaterThanOrEqualTo 函数作为我试图轻松编写的函数的参数传递？

有几种方法可以做到这一点。

1.  您可以传递函数指针
2.  您可以使用运行时多态性创建和传递函数对象
3.  您可以在函数对象上制作通用函数模板（编译时多态性）

eJames 在上面介绍了第一种方法。

## 选项 2

第二种方法涉及将比较函数包装在一些函数对象层次结构中。函数对象是具有 () 运算符重载的类的实例。这使得实例可调用：

```
 class IComparator
 {
 public:
    virtual bool operator()(lhs, rhs) = 0;
 }

 class CComparatorLessThan : public IComparator
 {
 public:
    virtual bool operator()(lhs, rhs) {...}
 }

 class CComparatorGreaterThan : public IComparator
 {
 public:
    virtual bool operator()(lhs, rhs) {...}
 } 
```

您的通用函数将采用 ICompatator 引用，并且行为将在运行时动态绑定。

## 选项 3

第三种方法涉及模板化而不是创建对象层次结构

```
template <class Comparator>
void foo(...)
{
   ...
   Comparator comparer;
   std::find_if(..., comparer);
} 
```

然后调用 foo 将涉及：

```
foo<CComparatorGreaterThan>(...); 
```

这消除了第二种解决方案的大量运行时开销。在这里您不必定义基类。你只需要有某种类重载了 operator() 并返回 bool。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T18:03:22.423

可以将成员函数指针传递给函数，如下所示：

```
typedef bool (NeedleUSsim::*compFunctionPtr)(NeedleUSsim &x, NeedleUSsim &y);

void NeedleUSsim::FindIdxRho(compFunctionPtr comparison)
{
    //..
    p = std::find_if(tplRho_deg, tplRho_deg+sampleDim[2], comparison);
    //..
} 
```

然后可以这样调用：

```
//..
someNeedleUSsim.FindIdxRho(&NeedleUSsim::LessThanOrEqualTo);
//.. 
```

查看[此](http://www.parashift.com/c++-faq-lite/pointers-to-members.html)C++ FAQ Lite 文章以获取更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T18:04:01.970

将函数和更复杂的参数带入函数的简单方法是将它们模板化（我猜测某些参数类型）

```
template <typename F>
void NeedleUSsim::FindIdx(double *ninfoMember, double *tplParam, size_t dimension, F CompareFunc, int &target)
{
    searchTmp = ninfoMember;
    double *p = std::find_if(tplParam, tplParam+sampleDim[dimension], CompareFunc);
    while(p != tplParam+sampleDim[dimension])
    {
        target= p - tplParam;
        p = std::find_if(p+1, tplParam+sampleDim[dimension], CompareFunc);
    }
} 
```

然后调用它：

```
FindIdx(&ninfo->rho, tplRho_deg, 2, &NeedleUSsim::GreaterThanOrEqualTo, idxRho);
FindIdx(&ninfo->l, tplL, 1, &NeedleUSsim::LessThanOrEqualTo, idxL); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T23:40:15.130

```
double *p = std::find_if(b, e, &NeedleUSsim::GreaterThanOrEqualTo);
while(p != e)
{
    idxRho = p - b;
    p = std::find_if(p + 1, e, &NeedleUSsim::GreaterThanOrEqualTo);
} 
```

请注意，您使用的这个循环不是必需的。使用反向迭代器

```
std::reverse_iterator<double*> rb(e), re(b);
rb = std::find_if(rb, re, &NeedleUSsim::GreaterThanOrEqualTo);
if(rb != re) {
    idxRho = re - rb;
} 
```

现在它的作用更明显了。如果仅在发现某些错误或无关紧要时才写入 idxRho，则可以将其缩短为

```
std::reverse_iterator<double*> rb(e), re(b);
idxRho = re - std::find_if(rb, re, &NeedleUSsim::GreaterThanOrEqualTo); 
```

# healthvault - HealthVault 应用程序可以编写为厚 Windows 窗体应用程序还是必须编写为 Web 应用程序？

> ID：917127
> 
> 赞同：2
> 
> 时间：2009-05-27T17:52:45.487
> 
> 标签：healthvault

那就是我的问题：

> HealthVault 应用程序可以编写为厚 Windows 窗体应用程序还是必须编写为 Web 应用程序？

在我看来，实现 Windows 窗体应用程序的障碍将是在 Windows 窗体应用程序中实现 OpenID / LiveID 登录，HealthVaultPage 超类为您做了。换句话说，我认为你必须实现一个 HealthVaultForm 超类并从那里开始。框架的其余部分似乎与平台无关。

我问的原因是一个合理的场景可能是在另一端实现一个带有管理厚应用程序的用户 Web。

我错过了重点还是尝试这样做是合理的？甚至有什么方法可以做到吗？

布赖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-10-20T17:52:26.963

您可以通过两种方式访问​​ HealthVault（这些术语有点令人困惑）。

1.  **在线**- 最常见的是“在线”模式，它要求用户在每次想要使用您的应用程序时使用他们的 LiveID/OpenID 登录。如果您正在编写 Web 应用程序，这就是您将使用的。
2.  [**离线**](http://msdn.microsoft.com/en-us/healthvault/bb871490.aspx)- 第二种方式是“离线”模式，这是您想要研究的。这将使您无需登录即可访问某人的 HealthVault 数据。但是，它要求用户登录一次，以便她可以批准您的应用程序，并且您的应用程序可以获取她的个人 ID（也称为用户 ID）和记录 ID，您需要执行任何离线操作。

另请注意，HealthVault 应用程序对每种模式具有不同的访问权限。例如，应用程序可能允许在线访问体重、身高和过敏数据，但可能只允许离线访问过敏数据。

请注意，SDK 附带的示例应用程序不支持离线访问，因此如果您想尝试使用此模式，则必须[创建自己的应用程序](http://msdn.microsoft.com/en-us/healthvault/bb898878.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T18:25:15.033

当然可以，HVCC 是用 Windows 窗体编写的！[https://account.healthvault.com/help.aspx?topicid=ConnectionCenterHelp](https://account.healthvault.com/help.aspx?topicid=ConnectionCenterHelp)

# winforms - 有没有人能够将 .NET 提供程序模型与 winforms 应用程序一起使用？

> ID：917128
> 
> 赞同：0
> 
> 时间：2009-05-27T17:52:54.350
> 
> 标签：winforms, provider-model

我已经看到了大量的 ASP.NET 示例，但没有看到 winforms 的示例。换句话说，使用 app.config 而不是 web.config。如果它不起作用，那将是一种耻辱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T18:01:40.743

如果您想在 Windows 应用程序中使用 ASP.NET 提供程序，请阅读[客户端应用程序服务。](http://msdn.microsoft.com/en-us/library/bb384297.aspx)

如果您希望在 Windows 应用程序中使用提供者模式，也可以这样做。我曾经这样做是为了允许在真实扫描仪和假扫描仪之间进行配置（是的，我知道我可以使用 IOC 容器）。

CodeProject 可能有几个提供者教程——这里是一个：[链接文本](http://www.codeproject.com/KB/architecture/provider_pattern_files.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:05:11.000

它的工作原理完全相同。基本提供者模型是 System.Configuration 的一部分，它抽象（提供者！）应用程序是通过 app.config 还是 web.config 配置的。

# c# - 类设计指南中的算术运算符与方法

> ID：917130
> 
> 赞同：1
> 
> 时间：2009-05-27T17:53:31.023
> 
> 标签：c#, .net, class

我有许多像 Point3 这样的数学类型，我遇到了实现运算符、实例和静态算术方法的困境。

所以说类型是`Point3`. 其中 a, b, c 是 a `Point3`，我当然想说：

```
c = a + b; 
```

但我是否也应该实施：

```
c = Point3.Add (a, b); 
```

和这个：

```
c = a.Add (b); 
```

对我来说，#3 比#1 没用而且可读性差。除非你有一个用于加、减、乘、除等的接口，否则#2 似乎毫无意义。

你有什么建议吗？仅使用运算符（+、-、*、/）有什么问题或缺点吗？这会阻碍泛型算术（我知道它不直接支持它，但也许拥有静态方法在解决方法中会很有用）？

无论是类还是结构，这方面的指导方针都可以吗？

编辑：同样对于#3，我忘了提到这是一个不可变类型，所以返回一个新的 Point3，而不是改变一个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T17:56:23.610

总的来说，我认为微软似乎在他们的大多数课程中都做了 A+B，类似于此。

有关示例，请参阅整个 System.Windows.Media.Media3D 命名空间以及 XNA 数学类。两者都有点/向量/四元数/矩阵/​​等，并使用Class.Operator(a,b)，偶尔做c = a + b;

就个人而言，我会在有意义且清晰的情况下做第一个，并且总是做第二个选项。我通常使用第二个选项来实现第一个（运算符是使用静态方法实现的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T17:57:37.333

使用运算符重载来满足您的需求。为了尊重不支持重载运算符的 .NET 语言，请包含包装运算符（或相反）的静态方法。第三个选项只有在您使用引用类型并且想要避免实例化新的类型时才可行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T18:12:36.697

VB.NET 等语言不像 C# 那样具有运算符重载，因此它们需要像您这样的静态方法`Point3.Add(a, b)`来提供加法和其他算术运算。如果您希望您的类型符合 CLR，则必须通过提供这些方法实现来支持这些其他语言。

尽管 VB.NET（和其他语言）程序员可以[使用`op_Addition`](http://blogs.msdn.com/csharpfaq/archive/2004/10/20/245226.aspx)编译 + 重载时创建的调用，但访问`Add`方法更好。[此 MSDN 部分描述了](http://msdn.microsoft.com/en-us/library/2sk3x8a7(VS.71).aspx)每个运算符的替代方法名称。

CLS 合规性不需要您描述的第三个选项。

# c++ - 从 C++ 队列的中间删除一个节点

> ID：917134
> 
> 赞同：1
> 
> 时间：2009-05-27T17:54:43.253
> 
> 标签：c++, linked-list

我有一个带有 c 样式`ctor`和`dtor`.

当这个 if 语句决定不测试 true 时，我太沮丧了，让我陷入了无限循环。我不明白为什么它永远不会测试为真。

我正在尝试从我的`LinkedList`.

也许有人可以帮助我？

```
Node *Current = first_; // I want this to be my only Node Ptr Varaible Declaration.
if ( NULL == first_ )
std::cout << "Cannot delete from an empty list: \n";

while ( Current != NULL )
{
  if ( first_->data_ == node->data_ ) 
  {
    //check to see if we are deleteing the head.
    first_ = first_->next_;
    --listLen_;
    delete Current;
    std::cout << "Head Deleted!\n";
  }
  if ( Current->data_ == node->data_ ) // FOR SOME REASON this is never true?
  {
    --listLen_;
    node->data_ = NULL;
    Current     = Current->next_;
    node->data_ = Current;
  }
  else  // we must not of found it.  // else should match previous i
  {
    Current->prev_ = Current;// since we are not deleting the first node we are OK here.
    Current        = first_->next_;

    if ( Current->next_ == NULL ) // see if we are at the end of the list.
    {
      first_ = NULL;  
      last_  = Current->prev_;

    }
  }
}
return; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T18:22:05.973

这真的应该重写，因为它有太多问题......还有为什么不使用STL容器？我认为这是一个家庭作业问题。

无限循环的答案是递增到下一个节点的 else 情况：

```
Current        = first_->next_; 
```

如果在前两个节点中找不到数据，这将使您永远循环...因为您将始终将下一个测试设置为第一个节点的下一个节点，并且如果有超过 2 个节点，它将永远不会将当前设置为 NULL在列表中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T18:23:23.977

我不完全确定您要完成什么，但我确定您做错了。如果你只是想从一个与 node->data_ 匹配的双向链表中删除一个元素，就这么简单：

```
Node *Current = first_;

while (Current != NULL)
{
  if (Current->data_ == node->_data)
  {
    //If Current isn't the head of the list, set prev to next
    if (Current != first_)
      Current->prev_->next_ = Current->next_
    else
    {
      first_ = Current->next_;
      if (first_ != NULL)
        first_->prev_ = NULL;
    }

    //If Current isn't the tail of the list, set next to prev
    if (Current->next_ != NULL)
      Current->next_->prev_ = Current->prev_
    else if (Current->prev_ != NULL)
      Current->prev_->next_ = NULL;

    delete Current;
    Current = NULL;
  }
  else
  {
    Current = Current->next_;
  }
}
return; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T18:16:01.947

您没有显示`node`来自哪里或如何`data_`定义，但如果它是指针类型，您可能需要比较*内容*，而不是地址。

假设这`data_`是一个指向某物的指针，并且它指向的内容已经`operator==`定义或者是一个内置类型*，并且*它具有您正在寻找的值，那么您可以这样做：

```
if ( *Current->data_ == *node->data_ )
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T18:23:11.683

如果`first_->data_ == node->data_`曾经计算为真，那么第二个 if 语句将始终计算为真，那么第二个 if 条件将始终计算为假`Current->data_ == node->data_` ，因为在第一次迭代时`first_ == Current`，您删除`Current`而不更新它

要从链表中删除一个节点，您似乎做了太多的工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-28T17:29:04.337

保持循环小，更容易找出问题所在。假设您的数据比较有意义，请查看以下内容：

```
curr = first_;
while( curr && (curr->data_ != node->data_) ) { 
  curr = curr->next_; 
}
if (!curr) return   // didnt find it, nothing to remove
if ( curr == first_ )   
  first_ = curr->next_  
else            
  curr->prev_->next_ = curr->next_
curr->next_->prev_ = curr->prev_ // always fix next's prev
delete curr 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T19:56:19.590

对于实际问题，这里并不是真正的答案，而是一个建议。

我永远不会遍历链接列表来删除列表中的条目。每个条目都应该有一个有效的下一个和上一个指针，当您从列表中删除一个条目时，您只需将前一个记录指向下一个，反之亦然，将您自己从列表中删除。一个空列表应该有一个头记录和一个尾记录，它们只是相互指向，并且所有有效的条目都插入到它们之间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-26T14:09:23.833

删除传递值的节点。

```
void deleteBegin()
{
 Node* temp =Head;
 if(temp==NULL)
     return;
 Head=Head->next;
 free(temp);
}
void deleteMiddle(int _data)
{
 Node* curr = Head;
 Node* prev = Head;

if(curr==NULL)
    return;

if(curr->next==NULL)
  {
    deleteBegin();
    return;
 }

 while(curr->next!=NULL && curr->data!=_data)
 {
    prev=curr;
    curr=curr->next;
 }

 if(curr->data == _data)
 {
     if(prev==curr)
     {
        deleteBegin();
        return;
      }
    prev->next = curr->next;
    free(curr);
 }  
 else
 {
    cout<<"Element Not Found\n";
    return;
 }

} 
```

# c# - 我的动态数据实体 wep 应用程序。不包括 App_code？

> ID：917138
> 
> 赞同：0
> 
> 时间：2009-05-27T17:55:31.490
> 
> 标签：c#, .net, asp.net, dynamic-data

我问：

asp.net 3.5中有两种模板

1) 动态数据 Web 应用程序。

2) 动态数据 Web 应用程序。实体

我的 SQL 数据库有 Customer Table ；列：ID、姓名、姓氏与姓名

如果您使用第一个（动态数据 Web 应用程序）；你看不到 ID 列（客户表）（Linq to Sql）

但是如果你使用第二个（Dynamic Data Web App.Entities），你可以看到 ID 列

我如何过滤列，尤其是 ID 区域。我是说; 我需要 ID 列可见 =false

你说：

```
In your metadata class, set the Id to the following:

[ScaffoldColumn(false)]
public object Id { get; set; }

In case you don't have a reference to the metadata class, you add this by adding the attribute to the partial class, something like this:

[MetadataType(typeof(MyEntityFromTable_MD))]
public partial class MyEntityFromTable
{

}

Then you need the metadata class itself. Something like:

public class MyEntityFromTable_MD
{
        [ScaffoldColumn(false)]
        public object Id;
} 
```

你是对的！但如果我尝试搜索。我找到这个链接：

[http://mattberseth.com/blog/2008/08/dynamic_data_and_custom_metada.html](http://mattberseth.com/blog/2008/08/dynamic_data_and_custom_metada.html)

[http://mattberseth.com/blog/2008/08/aspnet_dynamic_data_simple_5_t.html](http://mattberseth.com/blog/2008/08/aspnet_dynamic_data_simple_5_t.html)

**我读。我明白提出我的要求：我需要 App_code 但我找不到它！我怎样才能找到 App_code**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:38:22.507

如果您没有 App___Code 文件夹，您可能正在使用 Web 应用程序而不是网站。您可以在 WebApplication 中的任何位置添加分部类（您不需要在 App_Code 文件夹中添加它）。虽然我可能建议创建一个“模型”文件夹并将其放在那里（或创建一个单独的项目，并在那里创建它 - 但这可能比您要寻找的更复杂）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-29T11:38:57.290

使用 Web 应用程序项目时，您不需要 App_Code 文件夹，您可以在项目的任何位置创建类，您需要确保您的元数据类与您要使用元数据注释的模型位于相同的命名空间中。

# .net - 如何在 SSIS 中使用没有强名称的程序集

> ID：917139
> 
> 赞同：3
> 
> 时间：2009-05-27T17:55:40.163
> 
> 标签：.net, sql-server, ssis

我想在 SSIS 任务中使用程序集。但是，它是未签名的第三方。因此，我无法对其进行 GAC。有哪些解决方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T18:54:00.420

有一个答案。拆卸，然后重新组装并用您的密钥签署组装。Prolly 想与您的第 3 方核实，看看许可证是否允许这种手术。

详细信息：[我可以签署我没有源代码的程序集吗？](https://stackoverflow.com/questions/899856/can-i-sign-an-assembly-for-which-i-do-not-have-source-code)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:10:27.590

据我所知没有。我们最近遇到了这个问题，最终拆卸（ildasm），签名和重新组装（ilasm）。我们还尝试与供应商合作，让他们签署他们的程序集，但他们不会。我们会放弃该供应商并使用另一个对实际部署场景更友好的供应商。我希望你能找到更好的方法。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T06:12:04.803

唯一的解决方法是将其复制到将设计和运行此包的所有应用程序的主目录中。

通常，复制到 1) VS IDE 的位置就足够了：

```
Visual Studio\Common7\IDE\Private Assemblies\ 
```

2) dtexec、dtsdebughost 等的位置：

```
Microsoft SQL Server\Dts\Binn\ 
```

应用程序将能够从其主目录加载程序集。

# c# - 未处理的异常 CachedRawResponse asp.net

> ID：917146
> 
> 赞同：2
> 
> 时间：2009-05-27T17:57:20.143
> 
> 标签：c#, asp.net, exception, iis-6

无法将“System.Web.Caching.CachedRawResponse”类型的对象转换为“System.Web.Caching.CachedVary”类型。

我在对 aspx 页面的 AJAX 调用中得到了这个，并且在 webland 中找不到关于它的信息。CachedRawResponse 甚至不在 MSDN 上。有谁知道这件事，或者可能指出我正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-15T20:49:16.707

我们最近遇到了同样的问题，结果证明（在我们的例子中）页面输出缓存模块对您如何设置`Response.Cache.VaryByXyz`属性相当敏感。我们在 HTTP 压缩模块中使用了如下代码：

```
if (IsBrowserSupported(userAgent))
{
    Response.Cache.VaryByHeaders["Accept-Encoding"] = true;
    ...
} 
```

不幸的是，这会导致 ASP.NET 在页面被不受支持的浏览器调用后被缓存，并且随后被支持的浏览器从缓存中请求时抛出一个合适的结果。

不设置 any`VaryByXyz`会导致 a`CachedRawResponse`存储在 ASP.NET 输出缓存中，但如果您`VaryByXyz`在请求期间设置了 any，则 ASP.NET 期望 a`CachedVary`在该位置。而不是检查缓存页面是否是正确的类型，框架只是强制转换，产生一个`InvalidCastException`.

故事的寓意：始终设置`VaryByXyz`一致，无论请求标头或其他非请求相关变量如何。在我们的例子中，放置`VaryByHeaders`外部`if`解决了错误。

# javascript - 列出 IE 可用插件的 Javascript 方法

> ID：917148
> 
> 赞同：8
> 
> 时间：2009-05-27T17:57:26.243
> 
> 标签：javascript, internet-explorer, browser

有没有一种快速的方法来获取可用 Active X 插件的 JavaScript 列表？

在实际尝试运行插件之前，我需要进行测试以查看是否已安装插件。

实际上，我想创建一个显示“插件已安装并正常工作”的页面，或者让它优雅地失败。

如果插件不可用，我不确定如何让它优雅地失败。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T17:59:35.583

只是`try`它。

```
try {
  var plugin = new ActiveXObject('SomeActiveX');
} catch (e) {
  alert("Error"); // Or some other error code
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T18:23:37.063

如果无法实例化对象，对象标签将显示其中的任何内容[：](http://www.w3schools.com/TAGS/tag_object.asp)

```
<object ...>
 <p>
 So sorry, you need to install the object.  Get it <a href="...">here</a>.
 </p>
</object> 
```

所以，优雅的失败是内置的，你根本不需要使用脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T18:11:41.470

也许这个脚本可以帮助

```
function detectPlugin() {
// allow for multiple checks in a single pass
var daPlugins = detectPlugin.arguments;

// consider pluginFound to be false until proven true
var pluginFound = false;

// if plugins array is there and not fake
if (navigator.plugins && navigator.plugins.length > 0) {
var pluginsArrayLength = navigator.plugins.length;

// for each plugin...
for (pluginsArrayCounter=0; pluginsArrayCounter < pluginsArrayLength; pluginsArrayCounter++ ) {

    // loop through all desired names and check each against the current plugin name
    var numFound = 0;
    for(namesCounter=0; namesCounter < daPlugins.length; namesCounter++) {

    // if desired plugin name is found in either plugin name or description
    if( (navigator.plugins[pluginsArrayCounter].name.indexOf(daPlugins[namesCounter]) >= 0) || 
        (navigator.plugins[pluginsArrayCounter].description.indexOf(daPlugins[namesCounter]) >= 0) ) {
        // this name was found
        numFound++;
    }   
    }
    // now that we have checked all the required names against this one plugin,
    // if the number we found matches the total number provided then we were successful
    if(numFound == daPlugins.length) {
    pluginFound = true;
    // if we've found the plugin, we can stop looking through at the rest of the plugins
    break;
    }
}
}
return pluginFound;} // detectPlugin 
```

以此为例调用它

```
pluginFound = detectPlugin('Shockwave','Flash'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-26T13:46:11.847

对于 Internet Explorer 11，您可以使用***navigator.plugins*** JS API，但您需要添加适当的注册表项才能让 IE11 检测到它：

```
HKLM\SOFTWARE\Microsoft\Internet Explorer\NavigatorPluginsList 
```

或 64 位

```
HKLM\SOFTWARE\Wow6432\Microsoft\Internet Explorer\NavigatorPluginsList 
```

例如，对于名称为“ABC”和 mime 类型为“application/abc”的插件：

*   添加密钥*HKLM\SOFTWARE\Wow6432\Microsoft\Internet Explorer\NavigatorPluginsList\ABC*
*   为插件支持的每个自定义 MIME 类型创建子键，使用 MIME 类型值作为子键的名称，例如“application/abc”

然后使用以下代码检查插件是否存在：

```
var plugin = navigator.plugins["<your plugin activex id>"];
if(plugin) {
  //plugin detected
} else {
  //plugin not found
} 
```

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/ie/dn423948 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ie/dn423948(v=vs.85).aspx)

# c# - 在数据库未定义的外键关系上配置实体框架

> ID：917157
> 
> 赞同：3
> 
> 时间：2009-05-27T17:59:08.673
> 
> 标签：c#, entity-framework, .net-3.5, entity-relationship, foreign-key-relationship

由于多种原因，我正在处理的数据库（SQL Server 2005）没有定义任何关系。每个表都有一个主键。大多数表至少有一个外键，但是我们从未配置过约束。

谁能告诉我应该采取哪些步骤来通知实体框架表之间的基础关系？是否有描述此过程的特定文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T18:08:59.823

您将需要手动创建 EF 模型中的表之间的关联。

在实体框架设计器界面中，您基本上右键单击您的表并从上下文菜单中选择“添加 -> 关联”选项。在弹出的对话框中，您可以建立两个表之间的关联——即使在底层数据库中没有外键关系。

马克

# c# - 项目设置和未设置为实例错误

> ID：917160
> 
> 赞同：0
> 
> 时间：2009-05-27T18:00:08.563
> 
> 标签：c#, .net, class-library

我希望有人可以帮助我指出正确的方向。我的 Settings.Designer.cs 文件出现 StackOverFlow 错误。我根据这篇文章在[这里](https://stackoverflow.com/questions/911573/settings-designer-file-and-staticness)手动重新生成了文件现在我的设计器文件看起来应该是这样，所以他们告诉我，但是在我的类库（30 个位置）中访问设置文件的任何地方现在都会抛出一个`Object reference is required error`

这对其他人来说是显而易见的吗？我做错了什么或者我需要做什么来解决这个问题？下面分别是我的 Settings.Designer.cs 文件和类库示例的样子。

```
 public string CMOSQLConn {
        get {
            return ((string)(this["CMOSQLConn"]));
        }
    } 
```

* * *

```
 public class SupportWorker
{
    public DataSet RetrieveSupportWorkers()
    {
        DataSet ds = new DataSet("table");
        SqlConnection cnn = new SqlConnection(Settings.CMOSQLConn);
        SqlCommand cmd = new SqlCommand("spSelectSupportWorkers", cnn) {CommandType = CommandType.StoredProcedure};
        SqlDataAdapter da = new SqlDataAdapter(cmd); 
```

## 编辑 1

我将发布此内容，希望如果它明显错误并且似乎是正确的，那么有人会指出它。

`SqlConnection cnn = new SqlConnection(Settings.CMOSQLConn);`我用以下内容替换了所有 --> 实例-->`SqlConnection cnn = new SqlConnection(Settings.Default.CMOSQLConn);`

我不知道为什么它会起作用，但是......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T00:01:20.907

设置类中的所有属性都是实例属性。为了使用它们，您需要一个 Settings 类的实例。执行此操作的标准方法是访问 Settings 类上的静态 Default 属性，该属性返回 Settings 的实例。从那里您可以访问各个属性。

如果它以前在不使用默认值的情况下工作...出现严重错误。

# .net - .NET Windows 窗体的自动解析文本框控件

> ID：917162
> 
> 赞同：1
> 
> 时间：2009-05-27T18:00:52.243
> 
> 标签：.net, winforms, controls

我需要创建一个文本框，它将根据值列表自动解析用户键入的内容，类似于电子邮件客户端中的“收件人”字段。

例如，我的列表具有以下值：

汽车 房子 树

键入“hou”会自动解析为“House”，并且尝试删除该单词的单个字母（带有退格或删除）将完全删除它，也不会让人们弄乱已经解析的单词（例如“侯[某事]se”）。

当然，我可以使用常规文本框创建它并控制输入的内容并使用已解析的单词保持结构......但是有很多例外需要处理，我不愿意重新发明车轮。以前有没有人实施过类似的事情？Visual Studio 中是否有任何控件可以提供类似于我所描述的内容？

**更新**

请注意，我了解常规文本框支持自动完成，但除了自动完成之外，我还需要自动解析，这是一个不同的概念......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T18:03:25.123

标准[`TextBox`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.aspx)控件已经通过 、 和 属性支持[`AutoCompleteSource`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.autocompletesource.aspx)这[`AutoCompleteMode`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.autocompletemode.aspx)一点[`AutoCompleteCustomSource`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.autocompletecustomsource.aspx)。

您可以使用或指定自定义列表来选择标准完整源[`AutoCompleteSource`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.autocompletesource.aspx)，然后为属性提供[`AutoCompleteStringCollection`](http://msdn.microsoft.com/en-us/library/system.windows.forms.autocompletestringcollection.aspx)对象[`AutoCompleteCustomSource`](http://msdn.microsoft.com/en-us/library/system.windows.forms.textbox.autocompletecustomsource.aspx)。虽然我没有尝试过，但我怀疑这不像 Win32 变体那样灵活，您可以根据迄今为止输入的内容动态提供自动完成结果，但您可以通过压倒一切[`AutoCompleteStringCollection`](http://msdn.microsoft.com/en-us/library/system.windows.forms.autocompletestringcollection.aspx)。

### 更新

此答案是在问题更改以表明 OP 已经知道此信息之前提供的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-30T07:24:34.263

我将创建一个包含流布局控件的用户控件。flowlayout 控件将自动调整到用户控件的大小。

在开始时，flowlayoutcontrol 将包含一个没有任何可见边框的焦点文本框。用户输入文本，并为每次击键尝试解析单词。如果它解析为一个单词，则在文本框之前添加一个标签，该标签将解析的单词作为文本，其字体带有下划线。现在文本框已清除以供新条目。如果用户在空文本框中按退格键或左键，请在 flowlayout 中选择上一个控件并将该标签字体设置为粗体并等待（删除以删除单词或向左箭头和向右箭头以导航到另一个单词或空文本框）。站在已解决的单词上时：如果按向左，则移动文本框，使其现在位于已解决单词的左侧。如果按右，则将文本框移动到已解析单词的右侧。

通过使用标签（=已解析的单词）和用于输入新单词的文本框，可以很容易地模拟电子邮件程序中的“收件人”字段。唯一“难”的是让用户选择多个单词并删除，但是有很多解决方案（google +flowlayoutcontrol +multiple +select）。并且还可以在文本框上自动完成以“解析”到已知的单词列表。

我的一台电脑上有一个用户控件，今天会照顾它。如果我找到它，我将上传源代码并使用 zip 文件的链接更新答案。

**编辑：** 没有找到程序，所以我花了 30 分钟从头开始重写它，使用 (flowlayoutcontrol,label,textbox) 作为用户控件 ![在此处输入图像描述](https://i.stack.imgur.com/o9Zlk.jpg)

它的现场电影：[http ://www.youtube.com/watch?v=1MJ7bmFcCmE](http://www.youtube.com/watch?v=1MJ7bmFcCmE)

当然，这个 30 分钟的 hack 并不完美。一些导航的东西要实现。也许我今晚修好它。如果有人对此示例代码进行了改进，请将其发布在此线程中，以使所有人受益。

以下是此示例的源代码： [http ://www.filefactory.com/file/cda1d84/n/testproj.zip](http://www.filefactory.com/file/cda1d84/n/testproj.zip)

# java - 在Java中将字符串（如testing123）转换为二进制

> ID：917163
> 
> 赞同：47
> 
> 时间：2009-05-27T18:00:56.907
> 
> 标签：java, binary, ascii, hex

我希望能够将字符串（带有单词/字母）转换为其他形式，例如二进制。我将如何去做这件事。我正在使用 BLUEJ (Java) 进行编码。谢谢

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-05-27T18:07:00.733

通常的方法是用来`String#getBytes()`获取底层字节，然后以其他形式（十六进制、二进制等）呈现这些字节。

请注意，`getBytes()`使用默认字符集，因此如果您希望将字符串转换为某些特定的字符编码，您应该使用`getBytes(String encoding)`，但很多时候（尤其是处理 ASCII 时）`getBytes()`就足够了（并且具有不引发检查异常的优点）。

具体到二进制的转换，下面是一个例子：

```
 String s = "foo";
  byte[] bytes = s.getBytes();
  StringBuilder binary = new StringBuilder();
  for (byte b : bytes)
  {
     int val = b;
     for (int i = 0; i < 8; i++)
     {
        binary.append((val & 128) == 0 ? 0 : 1);
        val <<= 1;
     }
     binary.append(' ');
  }
  System.out.println("'" + s + "' to binary: " + binary); 
```

运行此示例将产生：

```
'foo' to binary: 01100110 01101111 01101111 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-27T20:11:58.327

一个简短的例子

```
private static final Charset UTF_8 = Charset.forName("UTF-8");

String text = "Hello World!";
byte[] bytes = text.getBytes(UTF_8);
System.out.println("bytes= "+Arrays.toString(bytes));
System.out.println("text again= "+new String(bytes, UTF_8)); 
```

印刷

```
bytes= [72, 101, 108, 108, 111, 32, 87, 111, 114, 108, 100, 33]
text again= Hello World! 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-01-10T16:18:32.953

这是我的解决方案。它们的优点是：易于理解的代码，适用于所有字符。享受。

**解决方案 1：**

```
public static void main(String[] args) {

    String str = "CC%";
    String result = "";
    char[] messChar = str.toCharArray();

    for (int i = 0; i < messChar.length; i++) {
        result += Integer.toBinaryString(messChar[i]) + " ";
    }

    System.out.println(result);
} 
```

印刷 ：

```
1000011 1000011 100101 
```

**解决方案 2：**

可以选择每个字符显示的位数。

```
public static String toBinary(String str, int bits) {
    String result = "";
    String tmpStr;
    int tmpInt;
    char[] messChar = str.toCharArray();

    for (int i = 0; i < messChar.length; i++) {
        tmpStr = Integer.toBinaryString(messChar[i]);
        tmpInt = tmpStr.length();
        if(tmpInt != bits) {
            tmpInt = bits - tmpInt;
            if (tmpInt == bits) {
                result += tmpStr;
            } else if (tmpInt > 0) {
                for (int j = 0; j < tmpInt; j++) {
                    result += "0";
                }
                result += tmpStr;
            } else {
                System.err.println("argument 'bits' is too small");
            }
        } else {
            result += tmpStr;
        }
        result += " "; // separator
    }

    return result;
} 
```

* * *

```
public static void main(String args[]) {
    System.out.println(toBinary("CC%", 8));
} 
```

印刷 ：

```
01000011 01000011 00100101 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-27T18:03:50.770

Java 中的 A`String`可以通过其[`getBytes(Charset)`](http://docs.oracle.com/javase/8/docs/api/java/lang/String.html#getBytes-java.nio.charset.Charset-)方法转换为“二进制”。

```
byte[] encoded = "こんにちは、世界!".getBytes(StandardCharsets.UTF_8); 
```

此方法的参数是“字符编码”；这是字符和字节序列之间的标准化映射。通常，每个字符都被编码为单个字节，但是没有足够的唯一字节值来表示每种语言中的每个字符。其他编码使用多个字节，因此它们可以处理更广泛的字符。

通常，要使用的编码将由您正在实施的某些标准或协议指定。如果您正在创建自己的界面，并且可以自由选择，“UTF-8”是一种简单、安全且广泛支持的编码。

*   这很容易，因为您可以默认使用 UTF-8，而不是包含一些方法来记录每条消息的编码。
*   它是安全的，因为 UTF-8 可以对Java 字符串中可以使用的*任何*字符进行编码。
*   它得到了广泛的支持，因为它是任何 Java 实现（一直到 J2ME）都需要存在的少数字符编码之一。大多数其他平台也支持它，并且它在 XML 等标准中用作默认值。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-12-28T06:53:18.133

```
 int no=44;
             String bNo=Integer.toString(no,2);//binary output 101100
             String oNo=Integer.toString(no,8);//Oct output 54
             String hNo=Integer.toString(no,16);//Hex output 2C

              String bNo1= Integer.toBinaryString(no);//binary output 101100
              String  oNo1=Integer.toOctalString(no);//Oct output 54
              String  hNo1=Integer.toHexString(no);//Hex output 2C

              String sBNo="101100";
              no=Integer.parseInt(sBNo,2);//binary to int output 44

              String sONo="54";
              no=Integer.parseInt(sONo,8);//oct to int  output 44

              String sHNo="2C";
              no=Integer.parseInt(sHNo,16);//hex to int output 44 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-04-08T22:18:52.547

这是我的实现。

```
public class Test {
    public String toBinary(String text) {
        StringBuilder sb = new StringBuilder();

        for (char character : text.toCharArray()) {
            sb.append(Integer.toBinaryString(character) + "\n");
        }

        return sb.toString();

    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-12-18T10:09:29.580

```
import java.lang.*;
import java.io.*;
class d2b
{
  public static void main(String args[]) throws IOException{
  BufferedReader b = new BufferedReader(new InputStreamReader(System.in));
  System.out.println("Enter the decimal value:");
  String h = b.readLine();
  int k = Integer.parseInt(h);  
  String out = Integer.toBinaryString(k);
  System.out.println("Binary: " + out);
  }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-12-03T19:12:45.490

在玩弄我在这里找到的答案以熟悉它的同时，我稍微扭曲了诺基亚的解决方案，以便将来在查看它时可以更快地理解它。

```
public static String stringToBinary(String str, boolean pad ) {
    byte[] bytes = str.getBytes();
    StringBuilder binary = new StringBuilder();
    for (byte b : bytes)
    {
       binary.append(Integer.toBinaryString((int) b));
       if(pad) { binary.append(' '); }
    }
    return binary.toString();        
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-07-24T08:23:16.383

您也可以使用 ol' good 方法来做到这一点：

```
String inputLine = "test123";
String translatedString = null;
char[] stringArray = inputLine.toCharArray();
for(int i=0;i<stringArray.length;i++){
      translatedString += Integer.toBinaryString((int) stringArray[i]);
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-09-06T10:11:49.017

```
public class HexadecimalToBinaryAndLong{
  public static void main(String[] args) throws IOException{
    BufferedReader bf = new BufferedReader(new InputStreamReader(System.in));
    System.out.println("Enter the hexa value!");
    String hex = bf.readLine();
    int i = Integer.parseInt(hex);               //hex to decimal
    String by = Integer.toBinaryString(i);       //decimal to binary
    System.out.println("This is Binary: " + by);
    }
} 
```

# selenium - 如何更改 Cruisecontrol head.xsl 以动态反映来自 testng 的值

> ID：917169
> 
> 赞同：0
> 
> 时间：2009-05-27T18:02:41.490
> 
> 标签：selenium, cruisecontrol.net, testng

目前，我可以在 Cruisecontrol 中对 header.xsl 进行硬编码以显示我想要的任何内容（例如浏览器类型），但我还想查看我的应用程序 testng 正在运行的版本。版本号位于我的应用程序的第一页上的 div 类下。有没有办法让 Cruisecontrol 通过获取 testng 报告将值设置到 header.xsl 中？

预期结果：我想在巡航控制报告中看到关于我的应用程序的信息，例如版本#

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T19:45:44.277

在构建过程中是否输出过该版本号？你能在构建日志中找到它吗？如果是这样，应该很容易找出获得它所需的 xsl。如果不是，您将不得不进行大量自定义，因为他们的系统只希望在构建日志、statistics.csv 和 report.xml 文件中显示信息。

# asp.net-mvc - ASP.NET MVC：AJAX 调用的控制器应该返回 JSON 还是呈现的 html？

> ID：917180
> 
> 赞同：22
> 
> 时间：2009-05-27T18:04:58.460
> 
> 标签：asp.net-mvc, json

我无法确定由 AJAX 调用的控制器操作是否应该返回部分视图或“原始”JSON。

返回带有渲染 HTML 的局部视图，使得 javascript 更容易使用返回的 HTML 简单地更新当前 DOM。但是，它确实限制了使用 web 服务的 javascript 客户端可以对返回的 HTML 执行的操作。

另一方面，让控制器操作返回 JSON 将需要 javascript 调用“手动”基于返回的 JSON 创建标记。

所以像往常一样，每种方法都有它的优点和缺点。每种方法还有其他优点/缺点吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-27T18:23:18.860

在我看来，由于以下限制，返回 JSON 然后让客户端视图对其进行排序可能会很麻烦：

1.  JavaScript 没有标准的模板语言。在最坏的情况下，您会很想将字符串连接起来以形成您需要的 HTML。
2.  没有简单的方法对您的连接代码生成的 HTML 进行单元测试。
3.  JavaScript 缺少 IntelliSense 意味着您也容易犯更多错误。

我处理这个的方法是返回渲染的 HTML，但是使用局部视图返回这个渲染的 HTML。这为您提供了两全其美的体验。您拥有服务器端模板以及 IntelliSense 支持。

这是一个例子：

这是我的 Ajax 调用，您可以看到它所做的只是替换我的无序列表的 html：

```
FilterRequests: function() {
    $.post("/Request.aspx/GetFilteredRequests", { }, function(data) {
        $('ul.requests').html(data);
    });
}, 
```

这是我对控制器的操作：

```
public ActionResult GetFilteredRequests(string filterJson)
{
    var requests = _requestDao.LoadAll();

    return PartialView("FilteredRequests", requests);
} 
```

最后，这是我的部分观点（无需了解这一点，我只是向您展示一些渲染在现实世界的应用程序中会变得多么复杂。我害怕在 JavaScript 中这样做。您还会注意到我的部分观点反过来也会调用其他部分视图。）：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<IEnumerable<Request>>" %>
<%@ Import Namespace="Diangy.HelpDesk.Models.Lookups"%>
<%@ Import Namespace="Diangy.HelpDesk.Models.Requests"%>
<%@ Import Namespace="System.Web.Mvc.Html"%>

<% foreach (var request in ViewData.Model) %>
<%{%>
    <li class="request">
        <h2>#<%= request.Id %>: <%= request.InitialInteraction().Description %></h2>
        <p>from <%= request.Customer.FullName %> (<%= request.Customer.EmailAddress %>), <%= request.InitialInteraction().UsableTimeStamp %></p>

        <h3>Custom Fields & Lookups</h3>
        <div class="tabs">
            <ul>
            <li><a href="#customfields<%= request.Id %>">Custom Fields</a></li>
            <% foreach (var lookupDefinition in (List<LookupDefinition>)ViewData["LookupDefinitions"]) %>
            <%{%>
            <li><a href="#<%= lookupDefinition.Name.ToLowerInvariant().Replace(" ", "") + request.Id %>"><%= lookupDefinition.Name %></a></li>
            <%}%>
        </ul>
        <% Html.RenderPartial("CustomFields", request); %>
    </div>

    <% Html.RenderPartial("Discussion", request); %>
    <% Html.RenderPartial("Attachment", request); %>
    </li>
<%}%> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-05-27T18:13:50.283

如果您使用 MVC 范例，控制器应该返回数据 (JSON) 并让视图自行整理，就像它的工作是查找/调整模型中的数据并将其传递给服务器上的视图边。

你得到布朗尼积分

*   保持逻辑和 UI 之间的关注点分离

*   使您的 ajax 操作可测试（祝您测试从该操作返回的 HTML 好运……）

它可能有点复杂，但它适合。

您可以使用客户端模板系统（例如 MS Ajax 工具包中现在提供的系统）来帮助承担一些负载并保持客户端的逻辑/渲染分离。

所以我肯定会说 JSON。但是，嘿，YMMV 像往常一样...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-04T14:33:29.597

我喜欢让调用应用程序来决定。我已经拼凑了一个 MultiViewController（我在网上找到的大部分代码，当我找到它时，我会尝试用信用更新），它会根据动作扩展返回适当的格式。例如：

```
myapp.com/api/Users/1 - defaults to html based on route
myapp.com/api/Users.html/1 - html
myapp.com/api/Users.json/1 - json
myapp.com/api/Users.xml/1 - xml
myapp.com/api/Users.partial/1 - returns a partial view of action name (see code)
myapp.com/api/Users.clean/1 - partial html without styling, etc... 
```

我的控制器继承自 MultiViewController 而不是“return view(Model);” 我只是调用“返回 FormatView(Model); 或 FormatView("ViewName",Model);"。第二个如果我需要对结果应用特定视图 - 而不是隐含视图。

MultiViewController 看起来像这样。特别注意FormatView，whitch返回一个动作结果：

```
 public abstract class MultiViewController : Controller
{
    private const string FORMAT_KEY = "format";
    public enum FileFormat {Html, Json, Xml, Partial, Clean}

    protected MultiViewController()
    {
        RequestedFormat = FileFormat.Html;
    }
    protected FileFormat RequestedFormat { get; private set; }

    protected override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        base.OnActionExecuting(filterContext);
        var routeValues = filterContext.RouteData.Values;
        if (routeValues.ContainsKey(FORMAT_KEY))
        {
            var requestedFormat = routeValues[FORMAT_KEY].ToString();
            if (isValidFormat(requestedFormat))
            {
                RequestedFormat = (FileFormat)Enum.Parse(typeof(FileFormat), requestedFormat, true);
            }
        }
    }

    private bool isValidFormat(string requestedFormat)
    {
        return Enum.GetNames(typeof (FileFormat)).Any(format => format.ToLower() == requestedFormat.ToLower());
    }

    protected ActionResult FormatView(string viewName, object viewModel)
    {
        switch (RequestedFormat)
        {
            case FileFormat.Html:
                if (viewName != string.Empty)
                {
                    return View(viewName,viewModel);
                }
                return View(viewModel);
            case FileFormat.Json:
                return Json(viewModel);
            case FileFormat.Xml:
                return new XmlResult(viewModel);
            case FileFormat.Partial:
            //return View(this.ControllerContext.RouteData.Values["action"] + "Partial");
            return PartialView(this.ControllerContext.RouteData.Values["action"] + "Partial");
            case FileFormat.Clean:
                if (viewName != string.Empty)
                {
                    return View(viewName, "~/Views/Shared/Clean.master", viewModel);
                }
                var v = View(viewModel);
                v.MasterName = "~/Views/Shared/Clean.Master";
                return v;
            default:
                throw new FormatException(string.Concat("Cannot server the content in the request format: ", RequestedFormat));
        }
    }
    protected ActionResult FormatView(object viewModel)
    {
        return FormatView("", viewModel);
    }

} 
```

Clean.master 只是一个不包含任何额外 html 的母版页 - 它采用视图（以便我可以合并任何部分类）并使用可以直接放置的干净 html 呈现它。

如果我想要 json - 控制器构建我的视图模型，然后将该视图模型作为 json 返回，而不是发送到默认视图 - 与 .xml 相同。

部分视图有点有趣，因为按照惯例，我的所有主要视图都被分解为部分，因此可以自行请求特定的部分 - 这对于使用 jquery 模拟更新面板的功能非常方便，没有所有垃圾与更新面板相关联。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T18:18:04.190

为了保持关注点的分离，您应该返回 JSON。

当您返回 html 时，您会限制您可以对返回的数据执行的操作。如果您需要数据列表并希望以不同的方式呈现它，请使用 JSON，否则您将必须在服务器上使用不同的方法来获取相同数据的不同渲染。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T20:53:07.637

为什么不同时使用 json 和 html？在当前项目中，我们正在制作路由，因此您可以从前端进行选择，在某些情况下哪种格式最适合......所以为什么不制作两个控制器，首先将返回 json 中的预期数据，另一个控制器将返回相同的数据，但使用 html ......这样你可以选择让我们说 jQuery 你想要什么，什么时候，你想要什么格式......最好的是，对于不同的格式，你只需要调用不同的地址......

换句话说，让它安静下来，宝贝！:)

干杯

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T21:17:54.093

至于我，我选择数据驱动的方法。以下是两者的一小部分功能：

数据驱动：

1.  来自服务器的 JSON（控制器直接将模型发送到响应）
2.  JS 模板绑定（在客户端可能需要更多时间）
3.  低带宽负载
4.  简直太性感了！

html驱动：

1.  来自服务器的 HTML（控制器将模型发送到某个部分视图，它呈现结果并返回它 - 在服务器端可能需要更多时间）
2.  JS绑定没有重载
3.  高带宽负载
4.  不性感，不不：）

因此，即使使用 HTML 驱动的方法，您也可以维护 MVC，尽管它会有点困难。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T18:10:28.900

如果您使用 JQuery，您应该使用 JSON 或 XML，因为它更易于修改，但如果您的 ajax 调用仅返回列表框的项目，例如您也可以使用 html。

我个人的偏好是 JSON 或 XML，因为经常使用 JQuery

# content-management - 从程序员的角度来看，fatwire 是什么？

> ID：917181
> 
> 赞同：6
> 
> 时间：2009-05-27T18:05:05.183
> 
> 标签：content-management, fatwire

fatwire 与什么开源工具包相比，fatwire 有什么特别的优势吗？

fatwire 出口并转向免费替代品有多难？

作为一个编写 java 扩展的平台，它有多稳定？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-28T03:56:00.893

从开发的角度来看，FatWire 可能是不友好的。在使用此应用程序在多个站点上工作后，它很容易膨胀，并且变得难以维护。

从用户的角度来看，用户界面已经付出了很多努力，这导致了一个功能强大的工具。

从客户的角度来看，所有客户 bar 1（一家大型新闻机构）都对最终结果感到满意。当使用复杂的逻辑来生成菜单或面包屑时，或者当你有大量的内容时，FatWire 可能会变慢。这是一位客户不满意的主要原因。FatWire 网站经常在负载下挣扎。它有时被视为满足所有 Web 需求的解决方案。

因此，FatWire 成功地提供了静态内容和半动态内容，但在被迫做完全动态的网站时可能会陷入困境（根据我的经验）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T18:31:09.077

来自原始新闻稿：

> FatWire Software 宣布推出 FirstSite，这是一组工具和最佳实践，可帮助使用 FatWire Content Server 的公司快速运行他们的第一个网站或应用程序，同时为未来的扩展奠定基础。FirstSite 包括大多数网站通用的标准模板和网站组件的集合，并结合了文档、培训、丰富的开发人员社区和最佳实践方法。FatWire 及其解决方案合作伙伴正在使用 FirstSite 作为为特定垂直市场开发以内容为中心的应用程序的基础。只需进行细微的外观改动，开发人员就可以使用 FirstSite 中的代码来实现第一个站点，同时学习如何利用 Content Server 的功能，

Firstsite 不是产品，除非自 2004 年以来发生了变化（不幸的是，我无法查看，因为他们的开发人员网站已关闭）。Fatwire 的内容服务器无法与我所知道的任何开源 CMS 相比。它的范围更进一步。我会一一回答你的问题：

**优点**- 有很多（或者没人会买，而且不便宜）

在交付方面：可扩展性、细粒度缓存控制、无状态 servlet 架构……

在后台方面：资产类型、动态内容属性、查找粒度的安全性和访问控制几乎没有限制，...

在开发方面：具有良好编码效率的智能架构 API、标签库、...

**开放性**

您不能轻易期望在任何两个 CMS 产品之间迁移内容，无论是否开源。虽然有一些方法可以使用产品工具或仅在数据库级别以 XML 和其他形式从数据库中提取内容，但我认为这不能成为支持或反对使用特定 CMS 的论据。曾经尝试过从 Drupal 迁移到 Joomla 吗？

**稳定的**

从 2000 年到 2004 年，我参与了多个 Fatwire 实现（当时是 OpenMarket Content Server，然后是 Divine Content Server）。对于《华盛顿邮报》、《纽约时报》和标准普尔网站来说，它已经足够稳定了，我希望今天的稳定性不会成为问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-08T13:10:56.023

从开发人员的角度来看，Fatwire 确实是一个独特的概念。它建立在一个非常抽象、极其灵活的智能资产建模框架上，该框架存储在关系数据库中。

应用程序逻辑基于实际上是 JSP 代码片段的“模板”。这个 JSP 代码不像传统的 Java，而是标签。开发人员需要很长时间才能学习这些标签和 Fatwire 资产 API。甚至在熟练的开发人员开始有生产力之前的几个月。

几乎没有任何可用的样品随产品一起运送。有广告“FirstSite”，但对于该产品的正常使用目的来说太简单了（巨大的复杂网站）。所以几乎所有东西都必须从头开始构建。

缓存控制被宣传为​​一项强大的功能。是的，但我们的学习曲线非常长，而且它从来没有像人们想象的那样工作。

即使是广告，该产品也缺少所见即所得的编辑。至少在 2009 年，它存在严重的概念问题，实际上阻止了在实际环境中使用它。但它对于演示和营销当然是很酷的功能。今天可能会修复。

作为总结，如果我是预算有限的客户，我会选择任何开源替代方案。主要是由于产品的独特性、缺乏良好的文档和极长的学习曲线，Fatwire 的开发成本很高。当然，产品价格标签也是要考虑的事情。

并且回答问题：如果您从 Fatwire 6.0 迁移到任何开源替代方案，您必须从头开始。并且在其上构建 Java 扩展是稳定的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T01:59:23.117

Fatwire 将内容存储在关系数据库和文件系统中。根据内容的类型（结构化/非结构化），可以评估 Fatwire。

# asp.net - 网格视图绑定

> ID：917191
> 
> 赞同：0
> 
> 时间：2009-05-27T18:07:19.203
> 
> 标签：asp.net, gridview

我将一个对象数据源绑定到一个网格视图。我的对象在其中一个属性中有一组项目。这是一个列表。如何循环通过此并将项目绑定到 GridView 中的列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:09:54.877

从对象中获取集合并使用绑定它

```
myGridView.DataSource = myCollection; 
myGridView.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:22:50.357

**编辑：**更新为在后面的代码中调用一个方法来为集合生成 html 标记。

在您的 aspx 标记中，您可能具有以下内容：

```
 <asp:GridView ID="myGridView" AutoGenerateColumns="False" runat="server">
        <Columns>
            <asp:BoundField HeaderText="Item Name" DataField="Name" />
            <asp:TemplateField HeaderText="Collection Field">
                <ItemTemplate>
                    <%# ((_Default)Page).GetHtmlForList(DataBinder.Eval(Container.DataItem, "List"))%>
                </ItemTemplate>
            </asp:TemplateField>
        </Columns>
    </asp:GridView> 
```

那么在你后面的代码中你可能会有这样的东西：

```
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!Page.IsPostBack)
        {
            myGridView.DataSource = GetCollection();
            myGridView.DataBind();
        }
    }

    public string GetHtmlForList(object value)
    {
        string html = "";
        List<string> list = (List<string>)value;
        foreach (string item in list)
            html += item + "<br/>";
        return html;
    }

    private List<MyClass> GetCollection()
    {
        List<MyClass> coll = new List<MyClass>();
        coll.Add(new MyClass { Name = "First Item", List = new List<string>(new string[] { "1", "2", "3" }) });
        coll.Add(new MyClass { Name = "Second Item", List = new List<string>(new string[] { "Apples", "Pears", "Oranges" }) });
        coll.Add(new MyClass { Name = "Third Item", List = new List<string>(new string[] { "Red", "Green", "Blue" }) });

        return coll;
    }
}

public class MyClass
{
    public string Name { get; set; }
    public List<string> List { get; set; }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:58:25.670

您能否在 Col. 模板中没有中继器，而只需在 RowDataBound 中将您的列表绑定到它？

# visual-studio - VS .Net 中是否有 CallStack 的可视化表示（而不是内置的堆叠表示）？

> ID：917195
> 
> 赞同：0
> 
> 时间：2009-05-27T18:08:31.743
> 
> 标签：visual-studio, visual-studio-2008, visual-studio-2005, callstack

是否有可用于 Visual Studio .Net 的插件，它在调试时提供 CallStack 的可视化表示（而不是内置的方法调用的堆叠表示）？（我正在想象类似于我们在 SQL 服务器中的执行路径的东西）恕我直言，这将有助于可视化程序的逻辑流程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T18:27:27.523

Microsoft 的[CLR Profiler](http://msdn.microsoft.com/en-us/library/ms979205.aspx)可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:34:00.817

还有其他代码分析器可能具有您正在寻找的内容。我知道的是商业（$）产品。Jetbrains 和 numega 就是两个例子。

坦率地说，我不知道为什么在执行期间/调试中断时您没有从调用堆栈中获得有用的信息。

请注意，您可以非常轻松地从 CLR 获取堆栈信息。我怀疑那里有一些免费/开源项目可以满足您的需求。我会试着环顾四周

# python - 对包含列表的元组进行排序

> ID：917202
> 
> 赞同：0
> 
> 时间：2009-05-27T18:09:44.113
> 
> 标签：python, list, sorting, tuples

我有一个与此类似的问题，[但](https://stackoverflow.com/questions/222752/sorting-a-tuple-that-contains-tuples)我的元组包含列表，如下所示：

```
mytuple = (
 ["tomato", 3],
 ["say", 2],
 ["say", 5],
 ["I", 4],
 ["you", 1],
 ["tomato", 6],
) 
```

排序这个最有效的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T18:16:04.380

你可以很容易地得到一个排序的元组：

```
>>> sorted(mytuple)
[['I', 4], ['say', 2], ['say', 5], ['tomato', 3], ['tomato', 6], ['you', 1]] 
```

这将根据列表中的项目进行排序。如果前两个匹配，则比较第二个，依此类推。

如果您有不同的标准，您可以提供比较功能。

**更新：**正如评论者所指出的，这将返回一个列表。你可以像这样得到另一个元组：

```
>>> tuple(sorted(mytuple))
(['I', 4], ['say', 2], ['say', 5], ['tomato', 3], ['tomato', 6], ['you', 1]) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T19:38:07.350

您不能对元组进行排序。

您可以做的是使用[sorted()](http://docs.python.org/library/functions.html?highlight=sorted#sorted)，它不会对元组进行排序，但会从您的元组创建一个排序列表。如果你真的需要一个排序的元组，你可以将 sorted 的返回值转换为一个元组：

```
mytuple = tuple(sorted(mytuple, key=lambda row: row[1])) 
```

这可能会浪费内存，因为您正在创建一个列表然后将其丢弃（同时也丢弃原始元组）。您可能不需要元组。从列表开始并对其进行排序会更有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T18:13:59.627

不幸的是，您将不得不实例化一个新元组：类似于

```
mytuple = sorted(mytuple) 
```

应该做的伎俩。 `sorted`但是，不会返回元组。`tuple()`如果你需要的话，把电话打进去。如果数据集很长，这可能代价高昂。

如果需要设置子列表中的第二个元素，可以使用函数的`key`参数`sorted`。为此，您需要一个辅助函数：

```
mytuple = sorted(mytuple, key=lambda row: row[1]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T18:14:09.330

该问题的公认答案中使用的技术 ( `sorted(..., key=itemgetter(...))`) 应该适用于任何此类迭代。根据您在此处提供的数据，我认为那里提供的确切解决方案就是您想要的。

# design-principles - 什么是“元数据设计原则”？

> ID：917208
> 
> 赞同：1
> 
> 时间：2009-05-27T18:10:44.733
> 
> 标签：design-principles

我正在查看我正在考虑申请的职位描述，其中列出的要求之一是“熟悉元数据设计原则”。

有人可以简单解释一下吗？我可能熟悉这个概念，但我以前从未听说过这个术语。

我用谷歌搜索更多信息，但没有得到好的结果。*[除了这份题为“元数据原则和实用性](http://www.dlib.org/dlib/april02/weibel/04weibel.html)*”的白皮书。它有点重，我希望能找到一个快速的解释。

* * *

附加说明：感谢到目前为止的所有答案。他们一直很好。我想澄清一下我熟悉什么是元数据，但我从未听说过“元数据设计原则”。元数据有哪些设计原则？对于一本书来说，这是一个足够大的主题吗？小册子？正如罗伯特·哈维（Robert Harvey）指出的那样，这听起来像是人力资源部门的某个人发明的一个模糊的术语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:16:35.173

我敢打赌这意味着“设计原则包括由元数据驱动”。

元数据的设计原则并不多——它通常由您的工具提供。

然而，一些组织希望将元数据作为应用软件规范、构建和运行的关键部分。

如果他们想要一个设计原则包括大量使用元数据的人，那么它可能会像“元数据设计原则”这样的短语出现。

但是，在我说任何话之前，我会问他们他们认为这是什么意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:18:19.213

本质上，这将是关于数据的数据设计；也就是说，用附加数据来表征数据。元数据是关于数据的数据；其中数据可以是您为给定项目获得的订单，有关它的元数据可以是您获得多少订单等。正确的元数据设计涉及了解哪些类型的信息可能对您的任何数据有用和有趣'正在分析，并认识到如何最恰当地跟踪和捕捉它。

例如，某一天给定书籍的销售数量可能是有用的；不一定是在给定分钟内同一本书的销售数量。同样，给定年份的销售额可能不如按月的销售额等有用。在这个例子中，它是粒度，但元数据设计可能涉及许多其他事情；另一个例子，也许销售的地理分布很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T18:57:42.517

“熟悉元数据设计原则”这句话听起来很可疑，像是一个不知道他们在说什么的人力资源部门发明的模糊短语之一。不过，我会试一试。

元数据是通过描述其他数据的属性或特征来增强其他数据的数据。

例子：

在以下标签中：

```
<a href="http://google.com">Link to Google</a> 
```

href 描述符是元数据，因为它“装饰”或进一步描述了链接。它是链接的属性。一般来说，所有 HTML 属性都是元数据。

AC# 属性是元数据。Microsoft 将属性称为“一种将*声明性信息*与类相关联的方法”。

```
[System.Serializable]
public class SampleClass
{
    // Objects of this type can be serialized.
} 
```

在数据库表中，记录的地址字段中包含的值：

```
12345 Main Street 
```

只是数据，但该字段在数据库中的定义：

```
Type: Text
Length: 50 
```

是元数据。

在 MP3 文件中，音频只是数据，但 MP3 标签（如作者、标题和比特率）是元数据。

XML 是数据，[XSD](http://en.wikipedia.org/wiki/XSD)是元数据。XSD 可用于表达一组规则，XML 文档必须符合这些规则才能被视为“有效”。

特定时期内特定书籍的销售数量不是该书籍的元数据，因为它没有进一步描述书籍本身，而只是其销量。但是，一本书的作者、标题和页数是该书的元数据（ISBN 也是如此）。

那里。现在您对“元数据设计原则”了如指掌。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-28T00:25:24.740

以下是 C. Larman 的“应用 UML 和模式”的摘录：

> **反射或元级设计**
> 
> 这种方法的一个例子是使用`java.beans.Introspector`获取一个`BeanInfo`对象，请求`Method`bean 属性 X 的 getter 对象，然后调用 `Method.invoke`. 使用自省和元语言服务的反射算法保护系统免受逻辑或外部代码变化的影响。它可以被认为是数据驱动设计的一种特殊情况。

# c# - 动态数据 App_code 目录 - 它在哪里？

> ID：917211
> 
> 赞同：0
> 
> 时间：2009-05-27T18:11:12.907
> 
> 标签：c#, .net, asp.net, dynamic-data

我尝试学习学习动态数据实体。我看到了一些关于它的样本。他们尝试在 App_code 中教授一些代码。我真的很想知道我的 Ap_code 在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T20:45:59.210

Web 应用程序不使用 App_Code 文件夹，仅使用网站。如果您想使用 App_Code 文件夹，请创建一个网站而不是一个新的 Web 应用程序。

如果您想使用 Web 应用程序，您可以将 .dbml 文件放在任何地方，您只需在要使用它的任何位置（例如：在 Global.asax 文件中）完全限定（使用命名空间）DataContext。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:25:03.223

似乎无法创建 app_code 文件夹。在社区内容部分查看[此页面](http://msdn.microsoft.com/en-us/library/cc488469.aspx)的底部 。有很多人有同样的问题。

解决方案：将 .dbml 添加到站点的文件根目录

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:58:50.277

如上所述，Web 应用项目默认不会创建 App_Code 文件夹。如果需要，您可以使用解决方案资源管理器创建一个 - 右键单击​​ Web 项目，新建文件夹...，将其命名为 App_Code。

# qtp - 网络可扩展性

> ID：917214
> 
> 赞同：0
> 
> 时间：2009-05-27T18:11:49.443
> 
> 标签：qtp, web-extensibility

我现在使用 QTP 已经有一段时间了，听说过 Web 可扩展性，我试图对这个主题进行大量研究，但无济于事。可以通过一些关于这个主题的光和小演示来取悦这个。从事 Web 可扩展性工作的先决条件是什么。我需要进一步探索这个主题以掌握它并在我的项目中使用。

非常感谢期待。。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-11T08:07:13.263

QTP Web 可扩展性的先决条件是 QTP 9.5 或更高版本（带有 IE），您可以在安装 DVD 的可扩展性子菜单下找到教程。

[您可以在高级 QTP 博客](http://www.advancedqtp.com/DemoMTW/content/tech.web_ext.html)中找到实现可扩展性的（不是很讨人喜欢的）描述。

如果您使用的是 QTP 10，那么[已经发布了一个 Web2.0 功能包](http://support.openview.hp.com/selfsolve/document/KM771788)，其中包括一个名为[Extensibility Accelerator](http://www.youtube.com/watch?v=Dttt_P1D4EU)的工具，它使创建 Web 可扩展性项目变得更加容易。

祝你好运。

# java - Hibernate/JPA Parent-Child - Parent equals()/hashCode() 可以使用 DB Id 吗？

> ID：917218
> 
> 赞同：3
> 
> 时间：2009-05-27T18:12:42.750
> 
> 标签：java, hibernate, jpa, jakarta-ee

鉴于以下情况：

```
@Entity
public class Parent implements Serializable {
  @Id
  private Long id;
  // mapped ManyToOne below...
  private List<Child> children = new ArrayList<Child>();

  ...

} 
```

让 Parent.equals() 和 Parent.hashCode() 只使用 id 是一种不好的做法吗？我知道 Child.equals() 和 Child.hashCode() 应该使用一组不可变的属性作为“自然键”，以便它们由 Parent 正确管理。但是，如果 Parent 始终是顶级对象（即它永远不是任何关联的反面），那么仅使用 id 有什么问题吗？

是否有任何不良影响可以通过这样做来表现出来？我猜也许如果我这样做，当我添加一个孩子（或删除）时，Hibernate 将无法判断 Parent 已更改（并且需要在 DB 中更新）？在这种情况下，我应该为 Parent.equals() 和 Parent.hashCode() 使用 children 属性吗？

我问是因为 Hibernate 文档明确说不要将 @Id 属性用于“自然键”......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:01:28.843

使用 ID 作为 equals 和 hashCode 基础的主要问题是未持久化的对象。这些对象可能都以相同的 ID 开头，并且无法正确比较是否相等。即使您从未将对象放入集合中，如果它们通过 API 公开并且其他人可以创建它们的实例并将它们放入集合中，那么您已经向一些讨厌的错误敞开了大门。

# c# - 简单代码解析器的设计策略

> ID：917219
> 
> 赞同：0
> 
> 时间：2009-05-27T18:13:17.427
> 
> 标签：c#, parsing, compiler-construction

我正在尝试编写一个应用程序来从专有 IDE 设计文件中提取属性和代码。文件格式如下所示：

```
HEADING
{
  SUBHEADING1
  {
    PropName1 = PropVal1;
    PropName2 = PropVal2;
  }

  SUBHEADING2
  {
    { 1 ; PropVal1 ; PropValue2 }
    { 2 ; PropVal1 ; PropValue2 ; OnEvent1=BEGIN
                                             MESSAGE('Hello, World!');
                                             { block comments are between braces }
                                             //inline comments are after double-slashes
                                           END; 
    PropVal3 }
    { 1 ; PropVal1 ; PropVal2; PropVal3 }
  }
} 
```

我要做的是提取副标题块下的内容。在 SUBHEADING2 的情况下，我还将用分号分隔每个标记。仅计算括号并跟踪我当前所在的子标题，我就取得了相当不错的成功。我遇到的主要问题涉及处理代码注释。

这种语言碰巧将 {} 用于块注释，这会干扰文件格式中的括号。为了让它更有趣，它还需要考虑双斜线内联注释并忽略直到行尾的所有内容。

解决这个问题的最佳方法是什么？我查看了另一篇文章中讨论的一些编译器库（ANTLR、Doxygen 等），但对于解决这个特定的解析问题，它们似乎有点矫枉过正。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:41:53.287

我建议编写一个标记器和解析器；这会给你更多的灵活性。标记器基本上对源代码进行简单的文本分解，并将其放入更可用的数据结构中；解析器弄清楚如何处理它，通常利用递归。

谷歌术语：分词器、解析器、编译器设计、语法

数学表达式求值器：http: [//www.codeproject.com/KB/vb/math_expression_evaluator.aspx](http://www.codeproject.com/KB/vb/math_expression_evaluator.aspx) （你可以举一个这样的例子，把它分解成你想要的）

有关解析的更多信息：http: [//www.codeproject.com/KB/recipes/TinyPG.aspx](http://www.codeproject.com/KB/recipes/TinyPG.aspx)

您不必像那些文章那样走得那么远，但是，您会想先研究一下这篇文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:54:27.427

无论您选择哪种解决方案，我很确定最好的方法是拥有 2 个解析器/标记器。一种用于以 {} 作为分组字符的主文件结构，另一种用于代码块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:20:05.327

您应该能够在几个小时内将一些东西放在一起，使用正则表达式和一些使用结果的代码。

这样的事情应该可以工作： - 通过将文件加载到字符串中来初始化进程。

*   从字符串中提取每个顶级块，使用正则表达式标签分别标识块关键字和内容。
*   如果找到一个块，
    *   根据关键字做出决定
    *   将内容递归地传递给这个过程。

在此之后，您将处理 HEADING，然后是第一个 SUBHEADING，然后是第二个 SUBHEADING，然后是每个子块。对于包含块注释的子块，您大概会根据块缺少关键字知道任何子块都是注释，因此无需处理子块。

# mysql - 如何在不定义表初始名称的情况下进行查询？

> ID：917233
> 
> 赞同：0
> 
> 时间：2009-05-27T18:15:01.183
> 
> 标签：mysql

我有下表。

```
genre:
  genre_id
  name

actors:
  actor_id
  name

movies:
  movie_id
  actor_id
  genre_id
  title 
```

我有以下查询来选择所有类型为 3 的演员。

```
select a.name, m.genre_id from 
actors as a
, movies as m
where
m.genre_id = 3; 
```

是否可以在没有“movies as m”的情况下进行查询，因为我不需要 m.genre_id。我只想显示演员的名字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:23:38.623

如果genre_id 是您拥有的唯一信息，则必须加入电影......

```
select a.name
from actors as a
inner join movies as m on a.actor_id = m.actor_id
where m.genre_id = 3; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T18:33:10.307

CSharpAtl 有它，但作为替代方案：

```
 select a.name
    from actors a
    where actor_id in (select m.actor_id 
                         from movies m 
                        where a.actor_id = m.actor_id
                          and genre_id = 3) 
```

# java - java word中的自动存根。用什么？

> ID：917240
> 
> 赞同：1
> 
> 时间：2009-05-27T18:16:19.730
> 
> 标签：java, mocking, stubbing

我有大量的课程需要为其构建存根。

为了给你图片，它是 GWT 的 Messages 类。通常这是一个有几十个返回字符串的方法的类。

使用 JMock，我可以做 stubbing，但我会以允许每种方法结束……这不是我希望看到的。

有什么东西会自动为每种方法构建存根吗？我需要这个方法来返回一些预定义的东西，比如空字符串，但我会对任何建议感到满意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:19:26.677

在 JMock 中，您可以使用显式结果允许您关心的方法，然后使用不包含方法的允许语句允许消息对象的任何其他方法。例如：

```
allowing(m).getBlah("something");
    will(returnValue("foo"));
allowing(m); // matches anything else, will return some default value if called 
```

但...

如果您只是存根一堆 getter 方法，那么使用模拟对象框架是错误的工具。模拟对象用于测试被测对象是否向相邻对象发送正确的命令以影响其环境的变化。

如果接口只包含 getter，那么创建存根类通常会更容易。或者您可以使用[Usurper](http://www.org-libs.org/org-lib-usurper/)自动生成存根。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:22:19.637

对于接口，您可以使用 java.lang.reflect.Proxy 的功能。假设您要为 MessageConstants 类存根答案，代码将类似于：

```
 InvocationHandler handler = new InvocationHandler() {

        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {

            if (String.class.equals(method.getReturnType()))
                return "proxy generated method return";

            throw new AbstractMethodError("Not implemented");
        }
    };
    Class<?> proxyClass = Proxy.getProxyClass(MessageConstants.class.getClassLoader(), new Class[] { MessageConstants.class });
    MessageConstants messageConstants = (MessageConstants) proxyClass.getConstructor(new Class[] {InvocationHandler.class}).newInstance(new Object[] { handler });

    System.out.println(messageConstants.description());

    messageConstants.getBoolean("someBoolean"); 
```

并会导致

```
proxy generated method return
Exception in thread "main" java.lang.Error: Not implemented
at xxx.Application$1.invoke(Application.java:48)
at $Proxy0.getBoolean(Unknown Source)
at xxx.Application.main(Application.java:64) 
```

InvocationHandler 驱动存根，而其余的只是管道。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T13:42:29.270

很高兴看到你找到了答案。只是为了获得更多信息，jMock 允许非常灵活地指定如何匹配方法，请参阅[http://www.jmock.org/match-object-or-method.html](http://www.jmock.org/match-object-or-method.html)。例如，您可以执行以下操作：

```
allowing (any(Object.class)).method("get.*").withNoArguments(); 
```

匹配任何吸气剂。

小号

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T18:29:18.627

如果您使用[EasyMock](http://easymock.org/)，您只需要为您实际希望被调用和使用的方法指定行为/期望/存根。

在同时使用了 JMock 和 EasyMock 之后，我不得不说 EasyMock 的 API 使用方便了大约 10 倍，而且由于接口大部分是静态类型的，所以它也可以安全地进行重构（您正在使用字符串作为方法名称等）。

# php - PHP、电子邮件和 Cron

> ID：917251
> 
> 赞同：0
> 
> 时间：2009-05-27T18:17:24.317
> 
> 标签：php, email, cron

让我重新提出我的问题，我有一个 mysql 数据库，它在共享主机上保存要发送的电子邮件。我想运行一个 cron 作业，它将读取数据库并每隔 10 分钟左右发送一次数据库中的任何消息。

现在我的问题是，使用 php 读取我的数据库并小批量发送电子邮件的最佳方式是什么，这样我就不会压倒共享主机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:37:37.150

假设使用 PDO，并为不知道您的模式做出一些调整，它可能看起来像这样：

```
$dbh = new PDO('mysql:dbname=testdb;host=127.0.0.1', 'dbuser', 'dbpass');
$msgh = $dbh->prepare('SELECT subject, body from message where listname = :listname');
$msgh->bindParam(':listname', $listname, PDO::PARAM_STR);
$msgh->execute();
$msg = $msgh->fetch(PDO::FETCH_ASSOC);

$usrh = $dbh->prepare('SELECT recipient from userlist where is_subscribed_to = :listname');
$usrh->bindParam(':listname', $listname, PDO::PARAM_STR);
$usrh->execute();
while ($recipient = $usrh->fetch(PDO::FETCH_ASSOC)) {
  mail($recipient, $msg['subject'], $msg['body']);
  if ($over_throttle) {
    sleep(THROTTLE_SLEEP_SECONDS);
    $over_throttle = 0;
  }
  ++$over_throttle;
} 
```

至于'prewritten'，你可以看看[phplist](http://www.phplist.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:02:13.727

我会把节流留给电子邮件服务器。即，在本地运行电子邮件服务器，并让您的 PHP 代码将所有这些消息中继到该服务器。然后将电子邮件服务器本身配置为仅以特定速率发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T18:56:51.490

好吧，我想出了类似于 PDO 的解决方案。将其作为 cron 作业运行是否有任何不可预见的问题？

```
<?php
$con = mysql_connect("localhost","root","123456");
$throttle = 0;
$batch = 50;
$pause = 10; // seconds

if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("maildb", $con);

// Message Table
$MSGresult = mysql_query("SELECT * FROM msgs");

// User Table
$USERresult = mysql_query("SELECT * FROM members");

while($MSGrow = mysql_fetch_array($MSGresult))
  {
    while($USERrow = mysql_fetch_array($USERresult))
        {
          mail($USERrow['email'],$MSGrow['subject'],$MSGrow['body']);
          $throttle += 1;
          if ($throttle > $batch ) { sleep($pause); $throttle = 0;} 
        }
    mysql_data_seek($USERresult,0);
  }

mysql_close($con);
?> 
```

# javascript - 如何检测用户是否正在运行 IE 6？

> ID：917252
> 
> 赞同：3
> 
> 时间：2009-05-27T18:17:35.860
> 
> 标签：javascript, html, internet-explorer-6

我需要能够判断页面是否正在 IE 6 中查看。如何在 javascript 中执行此操作而忽略 7、8 或其他浏览器等版本？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T18:19:32.237

直接从[马的嘴里](http://msdn.microsoft.com/en-us/library/ms537509.aspx)（和一个谷歌搜索）：

```
function getInternetExplorerVersion()
// Returns the version of Internet Explorer or a -1
// (indicating the use of another browser).
{
  var rv = -1; // Return value assumes failure.
  if (navigator.appName == 'Microsoft Internet Explorer')
  {
    var ua = navigator.userAgent;
    var re  = new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");
    if (re.exec(ua) != null)
      rv = parseFloat( RegExp.$1 );
  }
  return rv;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T18:22:17.190

您可以使用[条件注释](http://www.quirksmode.org/css/condcom.html)。

# bash - ${var} 参数扩展表达式可以嵌套在bash中吗？

> ID：917260
> 
> 赞同：85
> 
> 时间：2009-05-27T18:20:17.757
> 
> 标签：bash

我所拥有的是：

```
progname=${0%.*}
progname=${progname##*/} 
```

这可以嵌套（或不嵌套）到一行中，即单个表达式吗？

我试图从脚本名称中删除路径和扩展名，以便只留下基本名称。以上两行工作正常。我的“C”本性只是驱使我更加混淆这些。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-01-07T21:53:11.727

Bash 支持间接扩展：

```
$ FOO_BAR="foobar"
$ foo=FOO
$ foobar=${foo}_BAR
$ echo ${foobar}
FOO_BAR
$ echo ${!foobar}
foobar 
```

这应该支持您正在寻找的嵌套。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2009-05-27T18:32:23.147

如果用嵌套，你的意思是这样的：

```
#!/bin/bash

export HELLO="HELLO"
export HELLOWORLD="Hello, world!"

echo ${${HELLO}WORLD}
```

那么不，你不能嵌套`${var}`表达式。bash 语法扩展器不会理解它。

但是，如果我正确理解您的问题，您可能会考虑使用该`basename`命令 - 它从给定文件名中删除路径，如果给定扩展名，也会删除它。例如，运行`basename /some/path/to/script.sh .sh`将返回`script`.

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2016-02-18T19:38:42.150

以下选项对我有用：

```
NAME="par1-par2-par3"
echo $(TMP=${NAME%-*};echo ${TMP##*-}) 
```

输出是：

```
par2 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-12-16T09:36:17.410

一个旧线程，但也许答案是使用 Indirection:${!PARAMETER}

例如，考虑以下几行：

```
H="abc"
PARAM="H"
echo ${!PARAM} #gives abc 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-27T18:30:27.813

这种嵌套在 bash 中似乎是不可能的，但它在 zsh 中有效：

```
progname=${${0%.*}##*/} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-04-07T10:32:53.000

像这样的表达`${${a}}`不起作用。要解决它，您可以使用`eval`：

```
b=value
a=b
eval aval=\$$a
echo $aval 
```

输出是

`value`

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-01-10T17:50:16.063

实际上，可以使用两个步骤在 bash 中创建嵌套变量。

这是一个基于 Tim 的帖子的测试脚本，使用了 user1956358 建议的想法。

```
#!/bin/bash
export HELLO="HELLO"
export HELLOWORLD="Hello, world!"

# This command does not work properly in bash
echo ${${HELLO}WORLD}

# However, a two-step process does work
export TEMP=${HELLO}WORLD
echo ${!TEMP} 
```

输出是：

```
Hello, world! 
```

通过从命令行运行“ **info bash ”，然后搜索“** **Shell Parameter Expansion** ”可以解释很多巧妙的技巧。今天我自己读了几本，我一天只浪费了大约 20 分钟，但我的剧本会变得更好......

更新：在阅读更多内容后，我根据您最初的问题建议这个替代方案。

```
progname=${0##*/} 
```

它返回

```
bash 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-04-24T02:29:37.213

OP 的原始问题有一个 1 行解决方案，即删除了文件扩展名的脚本的基本名称：

```
progname=$(tmp=${0%.*} ; echo ${tmp##*/}) 
```

这是另一个，但是，使用基本名称作弊：

```
progname=$(basename ${0%.*}) 
```

其他答案已经偏离了 OP 的原始问题，而是专注于是否可以只扩展表达式的结果，`${!var}`但遇到了`var`必须明确匹配变量名的限制。话虽如此，如果您将表达式与分号链接在一起，则没有什么能阻止您获得 1-liner 答案。

```
ANIMAL=CAT
BABYCAT=KITTEN
tmp=BABY${ANIMAL} ; ANSWER=${!tmp} # ANSWER=KITTEN 
```

如果你想让它看起来像一个单一的语句，你可以将它嵌套在一个子shell中，即

```
ANSWER=$( tmp=BABY${ANIMAL) ; echo ${!tmp} ) # ANSWER=KITTEN 
```

一个有趣的用法是间接作用于 bash 函数的参数。然后，您可以嵌套 bash 函数调用以实现多级嵌套间接，因为我们可以执行嵌套命令：

这是表达式间接的演示：

```
deref() { echo ${!1} ; }
ANIMAL=CAT
BABYCAT=KITTEN
deref BABY${ANIMAL} # Outputs: KITTEN 
```

这是通过嵌套命令进行多级间接的演示：

```
deref() { echo ${!1} ; }
export AA=BB
export BB=CC
export CC=Hiya
deref AA # Outputs: BB
deref $(deref AA) # Outputs: CC
deref $(deref $(deref AA)) # Outputs: Hiya 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2020-04-22T12:15:13.707

由于那里已经有很多答案，我只想介绍**两种**不同的方法：*嵌套参数扩展* **和** *变量名操作*。（所以你会在那里找到四个不同的答案：）。

## *参数扩展*不是真正嵌套的，而是在一行中完成的：

### 没有分号 ( `;`) 也没有换行符：

```
progname=${0%.*} progname=${progname##*/} 
```

### 另一种方式：您可以使用叉子`basename`

```
progname=$(basename ${0%.*}) 
```

这将完成这项工作。

## 关于*连接*变量名

如果你想*构造 varname*，你可以

### 使用*间接扩展*

```
foobar="baz"
varname="foo"
varname+="bar"
echo ${!varname}
baz 
```

### 或使用*nameref*

```
foobar="baz"
bar="foo"
declare -n reffoobar=${bar}bar
echo $reffoobar
baz 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2012-08-16T00:53:13.213

我知道这是一条古老的线，但这是我的 2 美分。

这是一个（公认的笨拙的）bash 函数，它允许所需的功能：

```
read_var() {
  set | grep ^$1\\b | sed s/^$1=//
} 
```

这是一个简短的测试脚本：

```
#!/bin/bash

read_var() {
  set | grep ^$1\\b | sed s/^$1=//
}

FOO=12
BAR=34

ABC_VAR=FOO
DEF_VAR=BAR

for a in ABC DEF; do
  echo $a = $(read_var $(read_var ${a}_VAR))
done 
```

正如预期的那样，输出是：

```
ABC = 12
DEF = 34 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-04-30T23:22:22.527

如果您按照下面显示的方式进行中间步骤，它将起作用：

```
export HELLO="HELLO"
export HELLOWORLD="Hello, world!"

varname=${HELLO}WORLD
echo ${!varname} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-27T19:45:00.567

基本名称 bultin 可以对此有所帮助，因为您专门将 / 拆分为一个部分：

```
user@host# var=/path/to/file.extension
user@host# basename ${var%%.*}
file
user@host# 
```

它并不比两行变体快，但它只是使用内置功能的一行。或者，使用可以做模式嵌套的 zsh/ksh。:)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-06-21T17:44:23.967

虽然这是一个非常古老的线程，但该设备非常适合直接或随机选择文件/目录进行处理（播放曲调、选择要观看的电影或要阅读的书等）。

在 bash 中，我认为通常不能直接嵌套任何两个相同类型的扩展是正确的，但如果你可以用某种不同类型的扩展将它们分开，就可以做到。

```
e=($(find . -maxdepth 1 -type d))
c=${2:-${e[$((RANDOM%${#e[@]}))]}} 
```

说明：e 是目录名数组，c 是选定目录，或者显式命名为 $2，

```
${2:-...} 
```

其中 ... 是由下式给出的替代随机选择

```
${e[$((RANDOM%${#e[@]}))]} 
```

在哪里

```
$((RANDOM%...)) 
```

bash 生成的数字除以数组 e 中的项目数，由下式给出

```
${#e[@]} 
```

产生成为数组 e 索引的余数（来自 % 运算符）

```
${e[...]} 
```

因此，您有四个嵌套扩展。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-09-26T03:49:22.347

如果动机是本着 Python 的“理解”精神“混淆”（我会说简化）数组处理，请创建一个按顺序执行操作的辅助函数。

```
function fixupnames()
   {
   pre=$1 ; suf=$2 ; shift ; shift ; args=($@)
   args=(${args[@]/#/${pre}-})
   args=(${args[@]/%/-${suf}})
   echo ${args[@]}
   } 
```

您可以将结果与漂亮的单线一起使用。

```
$ echo $(fixupnames a b abc def ghi)
a-abc-b a-def-b a-ghi-b 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2016-05-16T14:51:34.763

eval 将允许你做你想做的事：

```
export HELLO="HELLO"
export HELLOWORLD="Hello, world!"

eval echo "\${${HELLO}WORLD}" 
```

输出：`Hello, world`

# javascript - 将 javascript 变量插入到 .innerHTML = 的 html 输出中

> ID：917262
> 
> 赞同：5
> 
> 时间：2009-05-27T18:21:06.803
> 
> 标签：javascript, html

我正在尝试将传递给我的函数的变量插入到我的 .innerHTML = 代码的输出中，但不知道如何正确地将其插入到 HTML 输出中。

```
function playsong(song)
{
    parent.document.getElementById('player').innerHTML = '<object width="199" height="26"><param name="movie" value="audio_player_black.swf"><embed src="audio_player_black.swf?audio_file=upload/'[song]'&color=00000" width="199" height="26"></embed></object>';
} 
```

我只是在我的 HTML 输出中得到 [song] 而不是 [song] 的值

不知道我需要如何正确地做到这一点

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T18:24:24.847

简单的：

```
parent.document.getElementById('player').innerHTML = '<object width="199" height="26"><param name="movie" value="audio_player_black.swf"><embed src="audio_player_black.swf?audio_file=upload/'+song+'&color=00`000" width="199" height="26"></embed></object>'; 
```

就像连接任何 2 + 字符串

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-27T18:23:18.547

代替：

```
[song] 
```

采用：

```
 +song+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-22T14:47:21.357

代替`[song]`使用`+song+`。这是一个将添加值的连接函数。

# .net - .net interop 是否为 COM 进行跨线程编组，还是我需要使用 CoMarshalInterThreadInterfaceInStream 或类似的？

> ID：917283
> 
> 赞同：2
> 
> 时间：2009-05-27T18:24:20.510
> 
> 标签：.net, interop, marshalling

谁能给我一个明确的答案，我是否需要使用 CoMarshalInterThreadInterfaceInStream、CoGetInterfaceAndReleaseStream 或 GlobalInterfaceTable 之类的东西来编组线程之间的 COM 接口？在[这个线程](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/852900e1-0351-4651-8e45-e36b94bc15f7/)中，有人说互操作为你做，有人说你需要使用这些调用。它是哪一个？

具体来说，我在 IE 中开发浏览器帮助器对象时使用了来自 mshtml 的各种 IHTMLxxx 对象。我从未使用过像 CoMarshalInterThreadInterfaceInStream 这样的方法，也从未意识到这会导致任何问题。但也许这可能是一些间歇性不可重复问题的原因......

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-05-20T10:35:04.427

根据经验，如果您的 dll 在 IE 中作为 BHO 加载，那么您不需要进行任何跨线程编组。似乎 .NET 自己完成了所有的魔法。

您应该做的是确保您只使用 STA 线程来访问 MSHTML 对象。任何从 IE 事件进入 BHO 的线程都将自动成为 STA 线程，但如果您有其他线程（例如后台计时器），那么您应该在访问 IE 对象之前确保它们是 STA，否则会发生坏事。

# visual-studio - 文件夹结构中的链接文件

> ID：917285
> 
> 赞同：2
> 
> 时间：2009-05-27T18:24:33.753
> 
> 标签：visual-studio, xaml, msbuild

在 Visual Studio 中，当我将文件从一个项目链接到下一个项目时，尝试加载链接资源时出现以下错误。仅当链接的文件位于文件夹中时才会发生这种情况。

错误：

Message="'pack://application:,,,/projectName ;component/ResourceDictionary .xaml' 值不能分配给对象 'System.Windows.SharedResourceDictionary' 的属性 'Source'。

例子：

```
Project1.Resources
           |
           |--> MergedResourceDictionary.xaml
           |--> ProjectResourceDictionary.xaml
           |--> Folder
                     |
                     |--> SharedResourceDictionary.xaml           

Project2.Resources
           |
           |--> MergedResourceDictionary.xaml
           |--> ProjectResourceDictionary.xaml
           |--> Folder
                     |
                     |--> SharedResourceDictionary.xaml  **LINKED** 
```

如果在 MergedResourceDictionary.xaml 中我们合并了这些字典，则不会找到 Project2 中的“SharedResourceDictionary.xaml”。但是，如果 SharedResourceDictionary.xaml 链接到项目的根目录，则在运行时找到资源。

**注意：在 project2 的“obj/debug”中，所有链接的资源都在根目录中，而在 project1 中，资源保留在项目中分配的文件夹结构中。

**重新创建的步骤** 这发生在运行时。步骤如下（使用原始帖子中列出的文件）。

1）在 Project1 中创建 SharedResourceDictionary，在“文件夹”中 2）在 Project2 中创建“文件夹”，然后在文件夹中添加“作为链接”SharedResourceDictionary 3）构建并运行应用程序 4）应用程序将无法找到 SharedResourceDictionary.xaml，由于它位于文件夹中。从文件夹结构中删除文件将作为链接文件正常工作。

我感谢任何帮助，

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-18T23:01:40.087

我花了一些时间与 Microsoft 支持部门合作解决这个问题。这是 MsBuild 的一个错误，并且不确定是否会成为他们将来修复的东西。

我为任何感兴趣的人找到了解决方法：

创建一个运行 LocBaml 并创建您需要的文件夹结构并将文件放置在正确文件夹中的 PostBuild 事件。

希望这可以帮助。

# nhibernate - 使用自联接和 NHibernate Criteria API 查询覆盖实体

> ID：917287
> 
> 赞同：1
> 
> 时间：2009-05-27T18:25:18.777
> 
> 标签：nhibernate, icriteria

我有一个简单的豁免模型，我想做一个查询，返回所有未被覆盖的豁免。

```
public class Waiver
{
    private readonly int id;

    protected Waiver()
    {
        this.id = 0;
    }

    public virtual int Id { get { return id; } }

    public virtual string Name { get; set; }
    public virtual string Description { get; set; }
    public virtual bool IsRequired { get; set; }
    public virtual DateTime EffectiveDate { get; set; }

    public virtual Waiver OverriddenWaiver { get; set; }
} 
```

这是地图：

```
 <class name="Waiver" table="Music_Waivers">
    <id name="id" access="field" column="WaiverId" unsaved-value="0">
      <generator class="native" />
    </id>

    <property name="Name" column="Name" />
    <property name="Description" column="Description" />
    <property name="IsRequired" column="IsRequired" />
    <property name="EffectiveDate" column="EffectiveDate" />

    <many-to-one name="OverriddenWaiver" class="Waiver" column="OverrideWaiverId" />
  </class> 
```

现在我想在我的存储库中有一个带有签名*public IList GetLatest()*的方法。出于某种原因，我很难用 CriteriaAPI 实现它。我可以用 T-SQL 写这个没问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T20:16:12.250

我最终暴力破解了一个解决方案。它不漂亮，但因为我知道表会很小（可能最终只有 5 行），所以我想出了以下代码解决方案：

```
public IList<Waiver> GetLatest()
{
    using (var session = SessionManager.OpenSession())
    {               
        var criteria = session.CreateCriteria(typeof (Waiver));
        var waivers = criteria.List<Waiver>();

        var nonOverridenWaivers = new List<Waiver>();

        foreach(var waiver in waivers)
        {
            bool overrideExists = waivers.Any(w => w.Overrides != null &&
                                                   w.Overrides.Id == waiver.Id);
            if (!overrideExists)
                nonOverridenWaivers.Add(waiver);
        }

        return nonOverridenWaivers;
    }
} 
```

# c# - 实体框架：抽象类上的私有设置器

> ID：917288
> 
> 赞同：1
> 
> 时间：2009-05-27T18:25:28.387
> 
> 标签：c#, .net, entity-framework

我们有一个抽象类，其中所有属性都有私有设置器。在我们的具体派生类中，代码生成器正在创建一个静态“create”方法，该方法试图设置抽象类的属性。显然这失败了，因为设置器是私有的。

我们如何抑制“create”方法的创建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:44:58.860

在 v3.5 中，我认为你不能只压制这部分。但是，它只会尝试设置不可为空/必需的属性。所以我看到了一些选择。没有一个是理想的。

1.  等待 v4.0，您可以在其中自定义 codegen。
2.  完全放弃 EF 代码生成并[使用自定义数据类](http://msdn.microsoft.com/en-us/library/bb738631.aspx)。
3.  使属性可以为空。
4.  不要将属性放在父类型上。将它们放在子类型上并使用接口进行多态性。
5.  不要将属性设为私有。

# apache-flex - Flex ItemRenderer 作为“数据”的字段？

> ID：917291
> 
> 赞同：0
> 
> 时间：2009-05-27T18:26:02.177
> 
> 标签：apache-flex, itemrenderer

我想让提供给 DataGrid 的数据决定它应该如何最好地呈现（也就是说，让数据随身携带一个将进行呈现的对象）。

例如，通过创建一个具有“renderer:IFactory”属性的“Renderable”接口，然后使用如下：

```
<mx:DataGrid x="0" y="0" width="100%" dataProvider="{myDataProvider}">
    <mx:columns>
    <mx:DataGridColumn headerText="Task" width="100"
        itemRenderer="{(data as Renderable).renderer}"/>
    </mx:columns>
</mx:DataGrid> 
```

但要做到这一点，Renderable 必须扩展`IEventDispatcher`，这似乎有点……

我也尝试过使用：

```
itemRenderer="{(data as Renderable).getRenderer()}" 
```

什么都不做（事实上，该`getRenderer`方法永远不会被调用）。

有一个更好的方法吗？我在做一些根本错误的事情吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T18:47:30.527

我可能是错的，但我认为您在上面的代码示例中引用的“数据”属性是您视图中顶级容器的“数据”，而不是 DataGrid 的特定行。我想到了其他一些方法：

1.  实现单个项目渲染器类，该类检查传递给它的数据，并针对所提供的数据类型使用适当的项目渲染器。
2.  在您的 DataGrid 视图中实现一个函数，该函数检查您的 dataProvider 并返回正确的项目渲染器类；使用绑定表达式在 DataGridColumn.itemRenderer 属性内调用它。
3.  实现 DataGridColumn 的子类，其中包含用于设置正确 itemRenderer 的逻辑。

我实际上建议不要将特定于视图的“渲染器数据”与模型中的数据混合。除非您将核心模型数据与渲染器一起公开的对象包装（有些人称之为 ViewModel）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:45:58.330

使 getRenderer 成为 [Bindable] 属性

# java - 我在哪里可以找到一些很好的例子来学习线程的基础知识？

> ID：917293
> 
> 赞同：5
> 
> 时间：2009-05-27T18:26:06.950
> 
> 标签：java, multithreading, concurrency

我在做计算机科学的第一年快结束了，想搞点基本的东西。我想使用线程，所以我可以学习。

有什么好的例子可以借鉴？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T18:27:33.810

您应该尝试Sun[的 Java 并发教程](http://java.sun.com/docs/books/tutorial/essential/concurrency/index.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T18:35:58.647

我推荐Doug Lea[的《Java 中的并发编程：设计原则和模式》一书。](https://rads.stackoverflow.com/amzn/click/com/0201695812)Doug Lea 是我在纽约州立大学奥斯威戈分校的教授之一——伟大的教授，聪明的人。这本书非常棒，它为您提供了大量关于用 Java 编写良好的多线程代码的重要信息。

哦，是的，Doug Lea 编写了大部分**java.util.concurrent**。所以他在这个问题上是一个很好的权威;-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T18:34:43.173

ServerSocket 示例非常简单，测试和使用线程非常简洁。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T18:32:46.187

图像处理和检索 Web 数据通常会阻塞用户界面，使其成为多线程设计的理想选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T18:52:50.093

我从编写批处理工具开始，决定我不喜欢等待，并寻找并行处理文件的方法。原谅伪代码；我的java真的生锈了。

考虑一下你做了几次需要一段时间的事情：

```
foreach(var item in list)
{
    doSomethingSlow(item);
} 
```

在这种情况下，添加一些调度代码以从方法调用中构建线程可能是有益的。我认为正常的 java 方法是按照如下方式关闭匿名线程。如果您需要能够指向线程以进行更多控制、取消等，您将必须实现并实例化一个从 Thread 继承的类。

```
new Thread({
    public void run(){
        doSomethingSlow(item);
    }
}).start(); 
```

**注意：我没有检查这是正确的语法，使用后果自负。**

这种方法应该可以为您节省一些时间，并为粗略地并行思考打开大门。您还可以查看[循环展开](http://en.wikipedia.org/wiki/Loop_unwinding)并使用现在可用的许多不同的并行类库。

我通常不喜欢代码的玩具示例，并且更喜欢通过创建有用的东西来学习，所以在玩了一些教程中的想法一段时间后，我建议你开始在你的所有项目中放置一些明智的并发代码，每次它这样做的意义。我不建议您尝试使每一行代码都并行，因为它很难调试并且在各处都引入了太多的开销实例化线程。

# c# - GDI+：如何在后台线程上将 Graphics 对象渲染为位图？

> ID：917294
> 
> 赞同：3
> 
> 时间：2009-05-27T18:26:29.163
> 
> 标签：c#, multithreading, image-processing, gdi+

我想使用 GDI+ 在后台线程上渲染图像。我找到[了这个](http://www.c-sharpcorner.com/UploadFile/mahesh/Transformations0412192005054803AM/Transformations04.aspx)关于如何使用 GDI+ 旋转图像的示例，这是我想做的操作。

```
private void RotationMenu_Click(object sender, System.EventArgs e)
{
    Graphics g = this.CreateGraphics();
    g.Clear(this.BackColor);
    Bitmap curBitmap = new Bitmap(@"roses.jpg"); 
    g.DrawImage(curBitmap, 0, 0, 200, 200);  

    // Create a Matrix object, call its Rotate method,
    // and set it as Graphics.Transform
    Matrix X = new Matrix();
    X.Rotate(30);
    g.Transform = X;  

    // Draw image
    g.DrawImage(curBitmap, 
    new Rectangle(205, 0, 200, 200), 
        0, 0, curBitmap.Width, 
        curBitmap.Height, 
        GraphicsUnit.Pixel);  

    // Dispose of objects
    curBitmap.Dispose();
    g.Dispose(); 
} 
```

我的问题有两个部分：

1.  您将如何`this.CreateGraphics()`在后台线程上完成？可能吗？我的理解是`this`这个例子中有一个 UI 对象。因此，如果我在后台线程上进行此处理，我将如何创建图形对象？

2.  完成处理后，如何从正在使用的 Graphics 对象中提取位图？我还没有找到一个很好的例子来说明如何做到这一点。

* * *

另外：格式化代码示例时，如何添加换行符？如果有人可以给我留下评论，解释说我真的很感激。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T18:36:32.623

要在位图上绘图，您不想`Graphics`为 UI 控件创建对象。您使用以下方法为位图创建一个`Graphics`对象`FromImage`：

```
Graphics g = Graphics.FromImage(theImage); 
```

一个`Graphics`对象不包含您绘制的图形，它只是在另一个画布上绘制的工具，通常是屏幕，但它也可以是一个`Bitmap`对象。

因此，您不要先绘制然后提取位图，而是先创建位图，然后创建`Graphics`要在其上绘制的对象：

```
Bitmap destination = new Bitmap(200, 200);
using (Graphics g = Graphics.FromImage(destination)) {
   Matrix rotation = new Matrix();
   rotation.Rotate(30);
   g.Transform = rotation;
   g.DrawImage(source, 0, 0, 200, 200);
} 
```

# c# - ObjectDataSource 对注释掉的 GridView 做出反应？

> ID：917297
> 
> 赞同：2
> 
> 时间：2009-05-27T18:27:02.017
> 
> 标签：c#, asp.net, gridview

我在 asp.net 中遇到了一个非常奇怪的行为，`ObjectDataSource`重现的描述有点长，所以在我设置场景时请耐心等待。

因此，想象一下用户控件中的一个微不足道的 ObjectDataSource/GridView 组合。ObjectDataSource 调用一个返回`List`对象的方法，GridView 以表格形式显示这些对象：

```
<div runat="server" ID="ControlWrapper">
    <asp:GridView ID="GridView1" AutoGenerateColumns="true" DataSourceID="ObjDataSource1" OnRowDataBound="GridView1_RowBound" runat="server">
    </asp:GridView>

</div>

<asp:ObjectDataSource ID="ObjDataSource1" runat="server" SelectMethod="GetBundle" OnSelecting="FixDataSource_Selecting"  OnSelected="FixDataSource_Selected"
    TypeName="West.VitalSigns.Contracts.ProdFixController">
</asp:ObjectDataSource> 
```

这种方法在代码隐藏中几乎没有任何内容。但是假设我们要`GridView`根据数据库的内容创建 n 个 -s。所以我们注释掉标记中的 GridView...

```
<div runat="server" ID="ControlWrapper">
<!--
<asp:GridView ID="GridView1" AutoGenerateColumns="true" DataSourceID="ObjDataSource1" OnRowDataBound="GridView1_RowBound" runat="server">
    </asp:GridView>
-->
</div> 
```

...并将类似这样的内容添加到 ObjectDataSource 的`Selected`事件处理程序中：

```
protected void FixDataSource_Selected(object sender, ObjectDataSourceStatusEventArgs args)
    {
        HashSet<string> components = new HashSet<string<()
        foreach (ProdFix fix in (List<ProdFix>)args.ReturnValue)
        {
            if (!components.Contains(fix.Component))
            {
                GridView v = new GridView();
                v.ID=fix.Component.Replace(" " ,"").Replace("-","");
                v.AutoGenerateColumns = true;
                v.DataSource = args.ReturnValue;
                v.RowDataBound +=new GridViewRowEventHandler(BundleGrid_RowBound);
                ControlWrapper.Controls.Add(v);
                components.Add(fix.Component);

            }
        }
    } 
```

此代码有效（或者至少未简化的版本在我的机器上有效），因此您决定从标记中删除注释掉的部分（毕竟，不希望那个杂乱无章！）

```
<div runat="server" ID="ControlWrapper">

</div> 
```

但是，当您这样做时，**代码将不再有效！**ObjectDataSource 不会触发，这意味着该`Selected`事件永远不会发生，这意味着您不会得到您的`GridView`-s。看起来 ObjectDataSource 正在对 aspx 文件中的注释掉的标记做出反应？

那么，这是不是：

*   ASP.NET 中的错误？
*   动态创建 GridView 的非标准方式？
*   我不应该尝试的WTF？
*   上述所有的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:40:51.647

标记中的 gridview 控件不会隐藏，即使有评论也是如此。HTML 注释不适用于服务器端标签。改用服务器端注释：

```
<% /* %>     <% */ %> 
```

或者

```
<%-– and -–%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T20:01:08.537

24 小时后，我注意到这种获得 N 个网格视图的方法非常愚蠢。`ObjectDataSource`我没有使用重构代码，而是`GetBundle`直接从 Page_Load() 调用该方法并以编程方式创建 GridView。

cdonner 有关于服务器端评论的正确答案。我没有意识到有区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T20:12:42.260

这也应该有效，因为您正在使用它“禁用”标签：

```
<!--asp:GridView ID="GridView1" AutoGenerateColumns="true" DataSourceID="ObjDataSource1" OnRowDataBound="GridView1_RowBound" runat="server">
    </asp:GridView--> 
```

# javascript - XULRunner 下的 javascript 服务器失败

> ID：917298
> 
> 赞同：0
> 
> 时间：2009-05-27T18:27:09.007
> 
> 标签：javascript, dom, screen-scraping, xulrunner

我正在尝试调试一个名为[crowbar](http://simile.mit.edu/wiki/Crowbar)的 DOM 抓取。无论如何，当我跑步时，我得到：

> 错误：[异常...“组件返回失败代码：0xc1f30001（NS_ERROR_NOT_INITIALIZED）[nsIServerSocket.asyncListen]”nsresult：“0xc1f30001（NS_ERROR_NOT_INITIALIZED）”位置：“JS 框架 :: chrome://crowbar/content/crowbar.js ： ：onLoad ::第375行“数据：否]
> 源文件：chrome：//crowbar/content/crowbar.js
> 行：375

基本上，`asyncListen()`就是投掷`NS_ERROR_NOT_INITIALIZED`。这很奇怪，因为紧接在此之前的代码行是对`init()`! 我试过添加：

```
netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"); 
```

就在调用之前`asyncListen()`，它没有任何效果。这是一个安全问题吗？（顺便说一句，如果重要的话，这是在 Fedora 机器上，以 root 身份运行，禁用 selinux）......我还尝试了一些不同的端口号......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-26T13:06:20.127

Here's the source code: [http://mxr.mozilla.org/mozilla-central/source/netwerk/base/src/nsServerSocket.cpp#369](http://mxr.mozilla.org/mozilla-central/source/netwerk/base/src/nsServerSocket.cpp#369)

Are you sure `init()` doesn't fail (that's what initializes `mFD`)? Maybe something `close`s it before your call?

I would [build a debug XULRunner](https://developer.mozilla.org/en/XULRunner/Build_Instructions) to build a debug version and/or try to get logging output from the app. Unfortunately, I can't figure out what the `LOG()` macro in that code resolves to, usually it's [NSPR logging](http://www.mozilla.org/projects/nspr/reference/html/prlog.html), but you have to guess the module name in order to enable logging for this module.

Boris Zbarsky (one mozilla core developers) [says](http://www.nabble.com/-FF3b5--nsIServerSocket-doesn%27t-work-td16837464.html):

> Since you're calling init(), the only other way I see to get an NS_ERROR_NOT_INITIALIZED out of asyncListen is for the thread you're running on to no longer be accepting events... So something odd is happening. Are there in fact multiple threads involved?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-08T12:43:44.430

我也面临这个问题。我从 CrowBar 派生了我的代码，并在 Win 7 上通过 xulrunner 1.9.1 运行它。

当我与网络断开连接时，我遇到了问题。如果我在网络上，它可以工作。我确实有多个线程[多个 xul 元素]。但我相信我在主线程上运行它（虽然我不确定如何找到当前线程），所以线程不监听不应该是问题。

我还注意到在 nsSocketTransportService2.cpp 线程变为空，所以鲍里斯可能是对的。

```
NS_IMETHODIMP
nsSocketTransportService::Dispatch (nsIRunnable *event, PRUint32 flags) 
{

    LOG(("STS dispatch [%p]\n", event));
    nsCOMPtr<nsIThread> thread = GetThreadSafely();
    NS_ENSURE_TRUE(thread, NS_ERROR_NOT_INITIALIZED);
    nsresult rv = thread->Dispatch(event, flags);
    if (rv == NS_ERROR_UNEXPECTED) {
        // Thread is no longer accepting events. We must have just shut it
        // down on the main thread. Pretend we never saw it.
        rv = NS_ERROR_NOT_INITIALIZED;
    }
    return rv;
} 
```

希望这有助于解决问题。

谢谢哈文德

# .net - 在 .NET 中实现数据绑定的线程安全集合

> ID：917306
> 
> 赞同：2
> 
> 时间：2009-05-27T18:29:57.333
> 
> 标签：.net, multithreading, collections, data-binding

我有一个 Windows 窗体应用程序，它显示一个窗体，其中 DataGridView 绑定到继承 BindingList 的自定义集合。我正在使用 BindingSource / DataSource 机制进行数据绑定。表单是一个监视器，显示集合中包含的状态信息。集合的每个元素代表许多子线程之一的状态信息。

我正在使用 SynchronizationContext 方法来确保我的集合中的 ListChanged 事件与 UI 线程同步，并且不会发生跨线程问题。但是，多个线程似乎仍然可以同时处理该集合。这会导致数据绑定问题。以下是已发生异常的示例：

> System.ArgumentOutOfRangeException：指定的参数超出了有效值的范围。参数名称： System.Windows.Forms.DataGridView.GetCellAdjustedDisplayRectangle(Int32 columnIndex, Int32 rowIndex, Boolean cutOverflow) 处 System.Windows.Forms.DataGridView.GetCellDisplayRectangle(Int32 columnIndex, Int32 rowIndex, Boolean cutOverflow) 处的 rowIndex .DataGridView.InvalidateCellPrivate(Int32 columnIndex, Int32 rowIndex) 在 System.Windows.Forms.DataGridView.OnCellCommonChange(Int32 columnIndex, Int32 rowIndex) 在 System.Windows.Forms.DataGridView.DataGridViewDataConnection.ProcessListChanged(ListChangedEventArgs e) 在 System.Windows.Forms .DataGridView.DataGridViewDataConnection.currencyManager_ListChanged(Object sender, ListChangedEventArgs e) 在 System.Windows。

这让我相信，在引发初始 ListChanged 事件并由 UI 线程处理后，集合再次更改。

所以，我的问题是如何使我的集合不仅是线程安全的，而且是阻塞的，以便 UI 可以在 ListChanged 事件之后刷新，然后再允许另一个更改？将 ListChanged 事件排队是不够的，我需要阻止导致 ListChanged 事件被触发的操作。例如，如果我更改元素的属性然后引发 ListChanged 事件 (ListChangedType = ItemChanged)，则尝试将项目添加到集合中的另一个线程将被阻止，直到 ListChanged 事件处理程序返回。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T18:36:47.287

将视图绑定到集合的副本，然后适当地控制对集合的访问：确保线程在 lock() 部分中进行更新，并确保在同一对象上也使用 lock() 完成复制。

这也可以让您对写入请求进行排队，以便编写者不会阻塞，他们只是发送一条带有更新的消息，这可能对性能有好处。

只是一个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-09-20T08:23:52.323

尝试 `ConcurrentBag<T>`

# regex - Ksh 脚本：运行类似 bash 的字符替换：${@/.txt/}

> ID：917307
> 
> 赞同：0
> 
> 时间：2009-05-27T18:29:59.577
> 
> 标签：regex, linux, ksh

我有一个必须保持不变的 ksh 脚本（它运行的一些程序坚持是 ksh）。我想获取输入参数“test.txt”并删除最后 4 个字符，或者查找并替换“.txt”。

在 bash 我会做

```
NewVar=${@/.txt/} 
```

不过，这在 ksh 中不起作用。如何摆脱 ksh 中的 .txt？我试过了

```
bash -c 'NewVar=${@/.txt/}' 
```

但它没有在这个新创建的 shell 中使用 $@ 变量。

谢谢，

担

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:39:25.473

为什么不使用[basename](http://linux.die.net/man/1/basename)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-12T14:11:41.083

ksh 不会让你用 $@ 来做，但是如果你把它分配给一个临时变量，你可以在不产生另一个 proc 的情况下做到这一点

```
tmp=$@
newvar=${tmp%.txt} 
```

# internet-explorer - FDF、MS CRM 和 iframe

> ID：917308
> 
> 赞同：0
> 
> 时间：2009-05-27T18:30:09.127
> 
> 标签：internet-explorer, iframe, dynamics-crm, dynamics-crm-4, fdf

我正在寻求将 iframe 与 FDF 一起使用的帮助。它还必须在 IE 中显示，因为我们使用 MS CRM。FDF 引用的 PDF 已加密，因此我无法进行任何服务器端合并（我不认为）。我已经查看了 FDF-Toolkit，但仅仅显示它就有点过分了，而且我听说它并不总是有效。

感谢您提供的任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-27T14:23:21.967

使用 XFDF 格式。它基本上是一种简单的 XML 格式（这里是规范：[http](http://partners.adobe.com/public/developer/en/xml/xfdf_2.0_draft.pdf) ://partners.adobe.com/public/developer/en/xml/xfdf_2.0_draft.pdf ）。确保您引用的 PDF 来自同一服务器并且 MIME 类型正确 (application/vnd.adobe.xfdf)。

# c# - 使用 .NET 时如何限制文件碎片？

> ID：917309
> 
> 赞同：4
> 
> 时间：2009-05-27T18:30:25.833
> 
> 标签：c#, .net, file-io, fragmentation

在我的应用程序中，随着时间的推移，我将小数据位收集到一个更大的文件中。结果，目标文件变得过度碎片化。可以做些什么来限制使用 .NET 的输出文件的碎片？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:08:41.950

您可以故意以更大的块增加文件大小，并在内部监视当前使用的结束位置。这样，您就可以让系统更好地为您的文件分配连续空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T19:12:47.713

可靠地减少文件碎片的唯一方法是一次性为整个文件分配空间（用零填充文件的其余部分，作为填充符）。但这只有在您对文件的最终大小有所了解时才能做到。

另一种选择是在每次增量期间将文件大小增加一个特定值（例如，100 MB）。这样，您将拥有较少的碎片整理块。

# jquery - 在jquery中选中/取消选中复选框时如何执行事件

> ID：917318
> 
> 赞同：10
> 
> 时间：2009-05-27T18:33:45.513
> 
> 标签：jquery

我有以下工作正常的 jquery 代码。

```
$('#onlyTwo').click(function() {
                $("#textarea3").attr("disabled", true);
                $("#textarea4").attr("disabled", true);
                $("#radio3").attr("disabled", true);
                $("#radio4").attr("disabled", true);
                return true;
            }); 
```

当单击“onlyTwo”复选框时，这会禁用某些字段。当未选中“onlyTwo”复选框时，如何使这些字段再次启用...

基本上我想知道如何找出复选框是否被选中

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-27T19:08:40.640

或者

```
$('#onlyTwo').click(function(){
   var stuff = $("#textarea3,  #textarea4, #radio3, #radio4");
   stuff.attr("disabled", $(this).is(":checked"));
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T19:23:32.793

```
$('#onlyTwo').change(function() {
    $('.disableMe').attr('disabled', $(this).is(':checked'));
}); 
```

因此，您需要将“disableMe”类添加到您希望禁用的所有输入、文本区域、选择...。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T18:38:54.210

```
$('#onlyTwo').click(function() {
     var elements = ['textarea3', 'textarea4', 'radio3', 'radio4'];
     var checked = $(this).attr('checked');

     jQuery.each(elements, function(element) {
       if (checked) {
         $('#'+element).attr('disabled', true);
       } else {
         $('#'+element).removeAttr('disabled');
       }
     });
}) 
```

`$('#onlyTwo')`这是一个简单的解决方案，可以在选中时在您想要的所有元素上切换禁用属性。

修复了数组问题，哈哈，这充满了小错误。

# objective-c - 为什么我的大纲视图中的所有复选框都在仅单击一个时检查？

> ID：917323
> 
> 赞同：0
> 
> 时间：2009-05-27T18:34:40.553
> 
> 标签：objective-c, cocoa

我正在使用带有两列的大纲视图，一列是文本字段，另一列是复选框字段。每列都绑定到一个 NSTreeController。我遇到的问题是，当我单击一个复选框时，我只希望它检查一个复选框，但它会检查列中的所有复选框。为了帮助回答我的问题，这是绑定：[http](http://snapplr.com/x5yh) ://snapplr.com/x5yh ，这是实体模型：[http ://snapplr.com/vqc9](http://snapplr.com/vqc9)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:55:38.343

控制器键错误。使用`arrangedObjects`而不是`selection`.

`selection`将显示当前选定对象的值。

# php - 获取我的 IP 地址

> ID：917332
> 
> 赞同：8
> 
> 时间：2009-05-27T18:36:47.957
> 
> 标签：php, c, networking, ip-address, wsh

我有一台小型网络上的计算机，所以我的 ip 是 192.168.2.100。

我正在尝试获取我的真实IP。我下载了 no-ip 客户端，但对于这么简单的事情来说，这似乎很麻烦。

我创建了这个 php 脚本，它获得了[http://www.ip-adress.com/](http://www.ip-adress.com/)页面并检索了它给我的 ip。

有没有更简单的方法？使用 C、WSH 或其他东西。或者如果在 php 中有更简单的方法，请告诉我。

当我得到 ip 时，我会将它上传到我的 ftp 站点，这样我就可以看到工作中的 ip。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T18:42:11.940

不，真的没有更简单的方法。你的计算机真的不知道它背后的公共 IP——它和公共互联网之间可能有任意数量的 NAT 层。它只知道它在 192.168.2.100 接收消息，并通过 192.168.2.1 的网关发送传出消息。它不知道数据包到达网关后会发生什么。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-28T14:56:27.343

请注意重新发明轮子，有一个[标准协议 STUN](https://stackoverflow.com/questions/905406/obtaining-own-external-ip-address-in-posix-c/910909#910909)（已经存在的实现），就是为了这个。另请参阅[以编程方式发现公共 IP](https://stackoverflow.com/questions/613471/discovering-public-ip-programatically/628180)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T18:43:28.990

不完全符合您的要求，但仍然适用于您想要的。我在我的家用电脑上设置了一个 GMail 通知程序，然后转到帐户活动页面以查看哪个 IP 地址正在访问我的 Google 帐户。安全、简单且有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T18:41:25.390

如果您想获得远程站点在处理流量时显示的最终 IP，那么唯一的方法是实际访问远程站点。在许多情况下，您的计算机可能不知道 IP 正在被代理或 NAT 服务器更改。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T18:50:09.630

我总是`curl http://whatismyip.org`在 NAT 后面获取我的公共 IP。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-25T04:14:07.493

您也可以访问此页面以获取您的 IP

[http://www.biranchi.com/ip.php](http://www.biranchi.com/ip.php)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-27T18:43:57.773

一些路由器可以通过 UPnP 或者更具体地说是[IGD 协议](http://en.wikipedia.org/wiki/Internet_Gateway_Device_Protocol)告诉您他们的外部 IP 地址。如果你碰巧拥有一个支持 UPnP 的路由器，你可以试试这个。[IStaticPortMapping::get_ExternalIPAddress](http://msdn.microsoft.com/en-us/library/aa366170(VS.85).aspx)听起来很有希望。

启用 SNMP 的设备也可以告诉您它们的 IP 地址。要请求的 OID 是[IP-MIB::ipAdEntAddr](http://www.mibsearch.com/vendors/RFC/objview/IP-MIB#ipAdEntAddr)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-28T19:30:53.380

当我需要检查我的公共 IP 地址时，我喜欢这个网站：

[http://www.whatismyip.global/](http://www.whatismyip.global/)

该网站保留了您的 IP 历史记录。对我来说非常有用！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T18:42:37.557

你这样做的方式可能和任何方式一样好。

你说你有一个公共的 FTP 站点——你那里也有一个网站吗？您的另一个选择是让您的本地计算机访问该面向公众的站点上的 php 页面。该 php 页面可以验证您的身份，然后使用 $_SERVER['REMOTE_ADDR'] 记录您的外部 IP。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-27T18:44:35.307

不幸的是，您的服务器很可能完全不知道它自己的外部地址是什么（因为它可能通过某些路由器/网关设置在上游）

你可以看看这个链接

[http://ip-address.domaintools.com/myip.xml](http://ip-address.domaintools.com/myip.xml)

它可能比您当前正在做的更容易解析。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-27T18:45:02.200

我想不出你会如何从另一台机器的角度解析你的 IP 地址。这里有几个想法：

*   自动加载 ip-adress.com 页面并解析它
*   看看[DynDNS](http://www.dyndns.com/services/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-27T19:11:29.510

除了下一跳是哪一跳（通常是您的路由器的内部 ip），您的计算机没有任何关于它和互联网之间发生的 NAT 或路由的信息。它根本不知道内部地址在哪一跳被转换为哪个公共地址。

因此，没有任何语言可以调用的简单函数或方法。

唯一的两种方法是问别人。如何？：

*   通过获取和解析路由器管理站点上的正确页面来询问您的 NAT 路由器（因为它本身会转换为公共 IP）。可以说是最可靠、最公平的。
*   通过获取和解析诸如[http://dynamic.zoneedit.com/checkip.html](http://dynamic.zoneedit.com/checkip.html)之类的公共服务，询问外部主机它如何看待您。VB 脚本中的一个示例在[这里](http://forums.speedguide.net/showpost.php?s=c7e2015877564a526e35b9d52219920c&p=1800201&postcount=3)。

# model-view-controller - 使用 Spring MVC 显示 unicode 的问题

> ID：917333
> 
> 赞同：0
> 
> 时间：2009-05-27T18:37:19.470
> 
> 标签：model-view-controller, spring, unicode

我正在尝试使用 freemarker 在我的 spring MVC webapp 中显示一些尼泊尔语言字符，

我做了所有事情，就像我在 web.xml 中有字符编码过滤器一样

```
<filter>
        <filter-name>encodingFilter</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
</filter> 
```

我的freemarker配置就像

```
<bean id="viewResolver" class="org.springframework.web.servlet.view.freemarker.FreeMarkerViewResolver">
        <property name="cache" value="true"/>
        <property name="prefix" value=""/>
        <property name="contentType" value="text/html; charset=UTF-8"/>
        <property name="suffix" value=".ftl"/>
        <property name="exposeSpringMacroHelpers" value="true"/>
</bean> 
```

在模板中我有

```
<meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
```

定义我只是在我的页面中看到一些奇怪的字符。认为响应标头具有正确的内容类型“text/html; charset=UTF-8”

不知道问题出在什么地方。我什至尝试从控制器设置内容类型 response.setContentType('text/html; charset=UTF-8");

帮助伙计们

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T18:24:09.437

好的，我解决了这个问题，我使用了 ReloadableResourceBundleMessageSource 而不是 ResourceBundleMessageSource，其属性 defaultEncoding 为 UTF-8，因此还必须为 basename 属性值添加类路径。

```
<bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
<property name="basename" value="classpath:messages"/>
<property name="defaultEncoding" value="UTF-8"/>
<property name="useCodeAsDefaultMessage" value="false"/>
</bean> 
```

它现在有效..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:53:25.630

你确定内容正确吗？也许它不是有效的 UTF-8。

“奇怪”的角色只是在一开始吗？然后它们可以是 Windows 格式的 UTF-8 BOM（字节顺序标记）。

# .net - 我应该使用 TDD 吗？

> ID：917334
> 
> 赞同：40
> 
> 时间：2009-05-27T18:37:29.593
> 
> 标签：.net, asp.net-mvc, tdd

我是我（非常小的）公司中唯一的开发人员，我即将开始为该公司开发一个中型 ASP.NET Web 应用程序。

我试图弄清楚我是否应该学习测试驱动开发（TDD）并在这个应用程序中实现它。

我需要尽快开始开发我们的新应用程序，我担心测试。我已经编程多年，但从未做过任何单元测试。

我已经阅读了许多有关 TDD 的在线资源，但我不确定我是否会“足够好”地掌握它以使其在应用程序中有效。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-05-27T18:42:08.663

这取决于您的优先事项在哪里。如果您有兴趣进一步发展自己作为开发人员，那么 TDD 绝对值得研究，即使只是为了体验。它将帮助您重新思考编码方式，并可能因此使您成为更好的开发人员。

但这很容易被 TDD 阻碍您及时推出产品的能力所抵消。您提到您是在这家公司工作的唯一开发人员，这意味着您面临完成项目的压力。TDD 无疑是一个很好的实践，但有时现实生活中的限制和实用性必须放在首位。

简而言之，如果您可以抽出时间，那么可以，使用 TDD。它实际上并没有*太多*开销，你总是可以在紧要关头跳过测试。但是，如果您真的时间紧迫，并且认为您无法在不将您的产品和工作置于风险的情况下整合它，那么没有人会因为您跳过它而责备您。纯粹主义者会不同意，但这不是一个非黑即白的世界，有时必须做出妥协才能完成任务。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-27T18:40:13.193

记住这一点：唯一不好的测试是你不执行的测试。

现在，您需要直接进入 TDD 吗？也许不吧。但是你绝对应该尽你所能开始单元测试。你不能很好地对 GUI 进行单元测试，这很好——把这些留给 UAT。

但是您可能会在幕后执行任何类型的逻辑吗？是的，你应该测试一下。

首先尝试测试单个方法。随着您的进行，您将开始遇到痛苦，因为您的代码很可能不是为测试而设计的。这可以; 重构你的代码！继续这样做，直到您*可以*测试您的代码。记住你必须做的事情，并在下次编写代码时第一次这样做。

经过几次迭代，您将了解需要学习的内容（实际上，您只能通过实践来学习）并且痛苦会消失。当这种情况发生时，我建议您可能已经准备好研究 TDD。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-27T19:40:22.743

基于 TDD 的开发方法的优势，我怎么强调都不为过。当您采用 TDD 时，您的单元测试将与您编写的代码一起成为一等公民，而不是为了进行单元测试而维护而不是保持最新的代码。

在 TDD 中，您将单元测试用作组件应该做什么的可执行规范。你可以通过考虑你想让你的组件做什么，然后编写测试来执行这个功能来做到这一点。由于您的代码最初没有任何此功能，因此您编写的所有新测试都会失败或变红。完成测试后，开始实现组件。逐渐地，随着您添加所需的功能，红色测试将变为绿色。好消息是，在您实现了足够的功能以使所有测试通过之后，您就知道您已经完成了预期规范的实现，并且确切地知道在哪里停止。我经常看到开发人员完成实现所需功能但没有停止的情况，

完成单元测试后，很容易在持续集成环境中进行设置。该环境将从您的存储库中签出最新代码，构建它，然后运行您的单元测试。如果发生任何回归，如果有人签入任何破坏您的单元测试的代码，您会立即知道它，而不是在它被部署到您的生产环境后才发现。为了确保新代码不会引入回归，我们在存储库上设置了登录挂钩，以确保所有提交的代码也运行了随附的测试并且它们通过了。当您有多个人在一个项目上工作时，这尤其有用，因为他们可以通过您可能使用的任何监控仪表板查看存储库是否适合在那个时间点同步到。它' s 也很容易本地化特定版本的存储库，它可以工作，让人们使用已知良好的版本，而其他人正在修复当前破坏您构建的任何问题。这也可能意味着仪表板指示的任何“绿色”构建都是在推送到生产环境时很有可能不会遇到问题的构建。

许多人认为采用 TDD 意味着额外的工作和麻烦，而且会更加耗时。考虑一下，编写测试所花费的额外时间将防止正在测试的任何功能被破坏，并且您会更快地而不是更晚地发现这些中断。

使用 TDD 的另一个优点是您将更加关注您的设计，并且与非 TDD 方法相比，它的结构和组件化要好得多。这种组件化对于能够拥有一个快速执行且不易碎的单元测试套件非常重要。

GUI 测试很困难，但并非不可能。考虑 Web-UI 测试技术，例如 Selenium、WebDriver 和 Watir，它们可以以编程方式测试 Web-UI。通过仅使用它们执行昂贵的端到端测试，也很容易滥用这些工具。更好的方法是抽象您的 UI 层，以便可以独立于您的业务逻辑对其进行单独测试。您不希望 UI 测试在数据库上进行并执行操作。

总而言之，您希望编写高效的单元测试以使使用 TDD 成为一种愉快的体验，而不是一种负担。您的测试应该是快速的，独立地测试组件，并且理想情况下应该一直运行。

我在这里描述的是一个理想的情况。您不必采用提到的每一个想法，但您可以挑选任何可行的方法来提高您的开发过程的效率。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-27T18:42:02.923

请注意，TDD 与测试无关。这是一个发展过程。测试不是为了取代测试功能——它定义了开发过程。

听起来您在谈论单元测试和其他自动化测试。测试很好。自动化测试很好。不要害怕犯错误。如果您考虑您的代码以及如何尽可能多地自动化测试，那么您处于一个很好的位置 - 但是收益递减会有一个截止点。100% 自动化测试可能不具有成本效益——尤其是对于您描述的组织。

如果您真的在谈论 TDD（专家称之为 TDD），那也很好。有很多发展过程。最好记住，开发过程是框架和指南——而不是像追求一样要遵循的宗教。没有一个过程是一刀切的。做对你有意义的事，并随着你的进步而改进。开发组织中只有一个人使更改过程相当轻松。首先解决您的高风险问题，并在处理低价值问题之前为这些问题制定一些轻量级的流程。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-27T18:41:12.893

最好的学习方式是边做边学。如果您已经阅读了这么多内容，那么是时候深入研究了——作为一个单一的开发人员，进行单元测试可能是天赐之物，因为没有另一双眼睛可以查看您的代码。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-27T18:40:57.903

我仍然是一名新开发人员，并进入了一家已经在进行应用程序开发的公司。TDD 帮助我确保新的更改不会破坏已经完成的工作，并且随着我的工作，它有助于在我添加或修改代码时进行大量的错误搜索。

我喜欢我从中学到的一切，强烈建议花时间学习 TDD。

-我的 .02

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-27T18:57:49.787

只有一个开发人员实际上是一个相当小的开发工作。即使您期望有很多屏幕，单个编码人员仍然需要很长时间才能进入中等内容（除非他们已经疯狂地剪切和粘贴）。

我不是 TDD 的忠实拥护者，但是如果您是相对较新的程序员（不到 10 年），您一个人并且担心质量问题，我相信它既会减慢您的速度，也会帮助您改进工作。对于年轻的程序员来说，这迫使他们更加专注于代码的真正底层行为，并使其一步一步地工作（一个早期的常见错误是大量代码太重，然后尝试一次全部调试. 老程序员可以侥幸逃脱，年轻人通常需要一次处理较小的部分）。粉丝们经常说它极大地改变了他们的编码方式（通常使整体工作更容易）。至少你可以从它开始，如果它没有真正的帮助，以后就放弃它。

TDD 无法解决的最大问题是为 Web 应用程序获得良好的架构结构。一个你不会想在五个月内扔掉的东西。Web 应用程序可能非常棘手，很少有人在最初的十到十二次就做对了。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-27T19:45:46.587

我最近也开始在所有新代码上使用 TDD。是的，起初它看起来只是在浪费时间，因为我所有的逻辑都与 Gui 耦合得太紧了，所以我无法编写任何单元测试来真正保证我的代码能做它应该做的事情。
但过了一段时间，我意识到编写单元测试是如此痛苦，因为代码写得不好。我开始以这种方式重构我的代码，这样我就可以为它编写重要的单元测试。我开始使我的方法更短，更多地使用接口，并尝试尽可能地将逻辑与 Gui 分开。
我认为在测试和验证代码之外使用单元测试的目的只是为了让你成为一个整体上更好的程序员。所以无论如何努力学习它是值得的。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-09-14T14:34:46.397

想我会总结和评论上面的一些评论：

1.  是的，TDD 是关于设计的。这与测试无关。
2.  不知道为什么 QA 会参与 George 的设计阶段。听起来他们正在指定自动化测试。正如蒂姆所指出的，这是一个开发过程。
3.  凯文，你说“跳过测试”。再一次。TDD 是关于设计的，而不是关于测试的。好的 你可以跳过设计，但完成的应用程序会出现错误且无法支持。
4.  Roshan 提到，“你的组件应该做什么的可执行规范”。这意味着完全最新的文档。当您是一个项目的新手时，您可以很快上手，您可以准确地看到原始开发人员的意图。而且，正如 Jon 所说，您可以更改代码并确保没有任何问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-06-01T08:33:07.867

Caleb - 我想推销一个网站，该网站旨在帮助您自己在家学习 TDD。如果你没有压力，你会学得更好。只需谷歌搜索“tdd-problems”，您就会找到它。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-27T18:43:47.367

您是否拥有易于单元测试的组件？您可以将您的应用程序构建为一组可单元测试的组件吗？这确实是在 TDD 环境中工作时要考虑的心态。

很容易说“它是一个 GUI 应用程序！它不可能对我的东西进行单元测试”！这可能是一个自我实现的预言。当然，您不能轻松地对所有小部件的布局进行单元测试，但是您的程序有多少与小部件的布局相关联？您可能会阻止自己做好 TDD，因为某些方面与 GUI 小部件的布局耦合得太紧，或者与其他不容易进行单元测试的东西耦合得太紧。停下来挑战自己——真的是这样吗？我可以对我的代码进行划分和模块化，以便更好地与系统的这些部分隔离吗？这样做是否合适（单元测试的收益是否值得付出代价？）。不要仅仅因为您的软件与不可单元测试的组件相关联而接受全权委托这是不可能的。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-05-28T07:07:50.190

TDD 的开销随着您在其中获得经验而减少，并且很快变得比不使用 TDD 开发的开销要少。

然而，一开始的开销可能很大，由于缺乏经验，你会浪费时间以错误的方式做事。一个关键项目是一个冒险的地方，包括学习一种新的开发技术所花费的时间

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-06-01T18:51:33.027

如果以务实的方式完成，它可能会带来巨大的好处。反对它的论点似乎总是花费太多时间，但众所周知，如果许多情况下故意牺牲质量可能会更加有害。

我学习 TDD 已经 3 年了，老实说，我已经看到它带来了巨大的价值，而且我也看到它完全是在浪费时间。

以下是每个示例...

有益：开发一个相当复杂的解决方案，具有许多依赖项和变化并且不断发展。设计时考虑到测试并拥有一套回归的单元测试使我们能够快速适应变化并能够重构代码以提高可维护性。我们在创建单元测试时使用了 80/20 规则，并忽略了低价值的测试用例。

无益：它（教条地）决定我们必须对 QA 可以想到的每个测试用例进行自动化测试，甚至是 UI 用例。许多案例非常初级，涉及的代码非常少，非常简单。让其中许多工作需要大量的设置，并增加了测试的数量以保持如此之多，这大大减慢了我们的速度。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-09-24T12:26:03.720

TDD 是一个很好的实践，我不能高度评价它。

但是，如果我处于你的位置，我现在不会太担心 TDD，而是专注于围绕你的代码进行一些好的单元测试。

当棘手的业务逻辑出现时，您总是可以稍后在项目中开始使用 TDD。

我不希望您对 TDD 有不好的体验，如果您面临交付压力并且没有使用该实践的经验，则可能会发生这种情况。

在工作中使用它之前，在家中尝试一些 TDD Katas 以熟悉它可能是一个想法。

可以在[这里找到一些好的 Katas](http://osherove.com/tdd-kata-1/)

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2016-03-18T12:40:59.800

TDD、伪TDD和准TDD。很多不同的方法。这仅取决于谁执行 TDD 的级别。也有很多优点和缺点，这又取决于您的人员。这是双刃剑哲学之一。如果您不知道自己在做什么，或者在您的团队中存在不同程度的理解，那么它将使您陷入困境并导致内部斗争，最终导致完全取消 TDD。TDD 也不同于（只是编写测试）。

# xml - 基于 W3C XML Schema 的 emacs 中的模式敏感编辑？（不是RNG）

> ID：917337
> 
> 赞同：8
> 
> 时间：2009-05-27T18:38:08.063
> 
> 标签：xml, emacs, xsd, relaxng

我刚刚在[这里](https://stackoverflow.com/questions/12492/pretty-printing-xml-files-on-emacs)了解了[nxml-mode](http://www.thaiopensource.com/nxml-mode/)，根据自述文件，它是一个

> GNU Emacs 编辑 XML 文档的主要模式。它支持编辑格式良好的 XML 文档，还可以使用 RELAX NG Compact Syntax 对 XML 文档进行模式敏感的编辑。

W3C XML Schema 是否有相同的模式？

如果我找不到这样的东西，那么假设我严格处理 W3C XML Schema 而不是 Relax-NG，那么 nxml-mode 对我有用吗？

相关：[VIM 中的模式感知编辑](https://stackoverflow.com/questions/322481/schema-aware-xml-editing-in-vim)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T05:43:51.730

只需使用 XSD 到 RNG 转换器，像[这样](http://code.google.com/p/xsdtorngconverter/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T14:37:06.113

我用一个相当简单的 XSD 模式进行了尝试——它定义了 4 个不同类型的元素。将此模式与 nxml-mode 一起使用需要我运行 3 次 XSL 转换：

*   XsdToRNG.xsl - 来自 Alex Ott 建议的[googlecode 。](http://code.google.com/p/xsdtorngconverter/)生成 RNG XML 语法。
*   RNGToRncXml.xsl - 来自[Pantor](http://www.pantor.com/download.html)。这对 RNG XML 语法进行操作，并生成模式的“中间”表示，它不是 {XSD, RNG, RNC}
*   RNGToRncText.xsl - 也来自 Pantor。对中间格式进行操作以生成 RNC。（RNG 紧凑语法），这就是 nxml-mode 想要的。

【在此之前我并没有意识到RNG有两种口味。]

结果是一个相当紧凑的 RNC 文件，这甚至是可以理解的。

我还用 XSLT XSD 尝试了同样的事情，并得到了类似的积极结果：一个很好的 .rnc 文件与 nxml-mode 一起使用。事实证明这是不必要的，因为 nxml-mode 附带了用于 XSLT 的 RNC。但它让我相信更复杂的 .XSD 文件可以转换为 .RNC。

获得 .RNC 后，您可以使用它来指导 XML 文档的编辑。打开文档（可能是一个新的空文档），如果它没有自动为您完成，请确保运行 nxml-mode。然后使用 Cc Cs Cf 以 nxml 模式将模式与该文档相关联。这仅在第一次编辑文档时是必需的 - 此后模式可以自动关联到文档。

架构与文档关联后，您将获得架构敏感的完成（也称为智能感知）和验证。nxml 模式商店为 XSLT、Docbook 和有趣的 RNG Xml 语法等提供 .rnc 模式。

它需要一些设置，但它的工作原理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T21:54:29.573

即使没有模式，它也非常有用。您可以自动完成结束标签、按标签导航以及许多其他很棒的花里胡哨。综上所述，亚历克斯·奥特是对的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-18T23:43:59.793

使用 Sun RNG 转换器将 XSD 转换为 RNG/XML，然后使用 Trang 将 RNG 转换为 RNG 紧凑语法。您可以从 msv.java.net 下载 Sun 转换器。

# asp.net - “ASP.NET”错误：访问远程服务器被拒绝，因为不存在登录映射

> ID：917339
> 
> 赞同：4
> 
> 时间：2009-05-27T18:38:21.497
> 
> 标签：asp.net, sql-server, sql-server-2008, linked-server

我能够执行直接查询链接服务器的存储过程，但是当我通过 ASP.NET 调用相同的存储过程时，我收到以下错误：

> 对远程服务器的访问被拒绝，因为不存在登录映射。

当我通过 SSMS 执行它时，我通过我的 Windows 域帐户进行连接。

该站点是 ASP.NET，在我的本地计算机上具有 IIS 7 和 SQL 2008 上的表单身份验证。

对于所有登录，链接服务器设置为“使用此安全上下文进行”。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T18:56:50.850

您连接到初始数据库的登录名无权访问链接的数据库。为什么不使用应用程序模拟的帐户连接到 Management Studio 中的数据库，并以这种方式诊断问题？如果您知道登录名，只需在链接数据库中创建它并使用所需的权限即可。

如果无法在链接服务器上创建新登录名，请创建映射。如果您阅读向导上的细则，它会使用当前安全上下文显示“对于未在上面列表中定义的登录，将建立连接”。这意味着如果您不定义映射，它将使用当前的凭据进行链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-21T18:41:01.050

需要两个登录名/密码对。一种是针对上面有链接服务器的 SQL 服务器。第二个是链接服务器正在连接的“事物”。例如，在 SQL 服务器所在的同一台机器上有一个 ODBC 连接。此 ODBC 连接连接到 ORACLE db。在 ODBC 设置期间，需要用户名和密码：UN "XYZ", PWD "123"。在创建与此 ODBC 连接的链接服务器时，需要添加用户名“XYZ”和密码“123”。这是在链接服务器属性的安全页面上完成的。单击“添加”并在“本地登录”框中输入应用程序用于连接到 SQL 服务器的 SQL 服务器用户名。在“远程用户”框中输入“XYZ”，在“远程密码”中输入“123”。

# sql - vbscript 插入 ms 访问

> ID：917346
> 
> 赞同：1
> 
> 时间：2009-05-27T18:40:23.613
> 
> 标签：sql, ms-access, vbscript

我正在开发一个小型应用程序，每次使用它时都使用 vbscript 写入 ms 访问数据库（真的仅供个人使用，所以我不需要担心 sql 注入）。当我运行它时，我不断收到“INSERT INTO 语句中的语法错误”。连接字符串是正确的，因为数据库在运行时会锁定。表名是 ors。我究竟做错了什么？

```
sql1="INSERT INTO ors  VALUES (,,'B223234','12/22/08')"
constring="Provider=Microsoft.Jet.OLEDB.4.0;
  Data Source=C:\Documents and Settings\me\My Documents\tracker.mdb;
    User Id=admin;Password=;" 
set con=createobject("adodb.connection")
con.open constring
con.execute sql1
con.close 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:54:09.000

“空白”值需要 NULL。您还需要使用 # 包围日期而不是日期字段的单引号。

如果您不想指定所有值，则可以仅指定要设置的字段。

（假设日期字段，而不是日期值的文本）

这：

`INSERT INTO ors VALUES (NULL,NULL,'B223234',#12/22/08#)`

或这个：

`INSERT INTO ors (Field3, Field4) VALUES ('B223234',#12/22/08#)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T18:44:43.213

如果我没记错的话，我认为 MS Access 中的日期需要 # 将它们括起来而不是单引号。尝试将您的插入更改为

```
INSERT INTO ors VALUES (,,'B223234',#12/22/08#) 
```

此外，您可能必须为缺少的参数指定空白

```
INSERT INTO ors VALUES (NULL,NULL,'B223234',#12/22/08#) 
```

我的 MS Access 知识有点生疏，但试一试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:02:34.067

插入 ors(field1, fiedl2) 值 ('B223234',#12/22/08#)

或者

INSERT INTO ors VALUES (NULL, NULL, 'B223234',#12/22/08#)

可能工作..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T22:53:34.943

另请注意，日期字段必须采用 mm/dd/yy 格式或另一种明确的格式，例如 mm/dd/yyyy、yyyy/mm/dd 或 yyyy-mm-dd。如果有人在 dd/mm/yy 或 yy/mm/dd 中运行他们的系统，这将导致插入错误的日期。

有关适用于 Access 的解决方案，请参阅[http://mvps.org/access/datetime/date0005.htm 。](http://mvps.org/access/datetime/date0005.htm)

我知道你说这仅供个人使用，但你应该知道这些细节以备不时之需。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T18:48:27.997

您需要指定要插入的字段：

示例：插入 Table1 (test1, test2, test3) 值 ('1','2','3')

# apache-flex - Flex：防止在有焦点的对象上突出显示？

> ID：917357
> 
> 赞同：0
> 
> 时间：2009-05-27T18:42:13.843
> 
> 标签：apache-flex

我有一个 TextInput 对象，它在聚焦时会突出显示...我希望它在聚焦时不突出显示...看起来应该很简单，但我想不出办法来阻止它？有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T18:48:27.857

只需将`focusThickness`样式设置为 0。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-01T12:56:16.283

如果不需要，focusEnabled="false" 将完全阻止选项卡

# web-services - 寻找 VoIP 服务提供商

> ID：917361
> 
> 赞同：3
> 
> 时间：2009-05-27T18:43:15.683
> 
> 标签：web-services, api, service, voip, telephony

我正在寻找我的应用程序可以用来拨打固定电话和移动电话的 VoIP 服务。

我需要的：

*   我会生成一个音频文件并将其发送到服务。然后该服务将发出呼叫并播放音频文件。

其他可以加分的功能：

*   TTS（我发送文本，服务为我将其转换为音频）
*   接收 DTMF 响应的能力

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-09-01T19:19:54.160

试试[Twilio](http://www.twilio.com/)。它非常易于使用，可以满足您的所有需求：[播放](http://www.twilio.com/docs/api_reference/TwiML/play)音频文件、[说](http://www.twilio.com/docs/api_reference/TwiML/say)文本和[收集](http://www.twilio.com/docs/api_reference/TwiML/gather)DTMF 输入。他们现在甚至有一些语音到文本转录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-05T19:58:16.717

经过相当多的挖掘后，我将尝试使用[CallFire](http://www.callfire.com/)。

它看起来很有希望。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T19:13:27.400

试试 Avtex 的 City Watch。它做所有这些事情。

-巴恩齐

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T19:14:03.577

对于调用和播放音频文件，您可以查看[Asterisk](http://www.asterisk.org)服务器。尽管这不是我认为您正在寻找的外部服务，但它可用于连接到 VoIP 提供商并播放文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-28T14:45:50.470

使用[Axvoice](http://www.axvoice.com/)，它是一种低成本的家庭电话服务，您肯定可以将它与您的应用程序集成。

您可以联系他们的实时聊天支持以获取详细信息。

# python - Ruby 是否有相当于 Python 的扭曲框架作为网络抽象层？

> ID：917369
> 
> 赞同：6
> 
> 时间：2009-05-27T18:44:57.770
> 
> 标签：python, ruby-on-rails, ruby, twisted

据我了解，Python 的扭曲框架为网络通信提供了更高级别的抽象（？）。

我正在寻找一个在 Rails 应用程序中使用的 Ruby 等价物。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T19:17:45.207

看看[EventMachine](http://eventmachine.rubyforge.org/)。它不像 Twisted 那样广泛，但它是围绕事件驱动网络编程的相同概念构建的。

# jquery - 在 jQuery 的 get() 方法中调用 URL

> ID：917378
> 
> 赞同：0
> 
> 时间：2009-05-27T18:47:40.823
> 
> 标签：jquery

行。我有以下 jQuery 代码

```
jQuery(function(){
jQuery.get('/GalleryPage.aspx?gallery=1234', {}, function(data) { 
galleryXML = data;
renderGallery(pageIndex);
}, "xml");          
}); 
```

如您所见，我有 1 个 URL ( `'/GalleryPage.aspx?gallery=147'`)，我将其显示在“GalleryView.html”中。现在我想在同一页面中显示另一个 URL/ID，像这样（`'/GalleryPage.aspx?gallery=258'`）。

我可以像这样在彼此旁边添加网址吗

```
jQuery.get('/GalleryPage.aspx?gallery=1234', 
'/GalleryPage.aspx?gallery=1234', {}, function(data) { 
```

如何在同一个 get() 函数中显示 2 个 URL？？？？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T18:54:08.173

不，您不能在 jquery 的 get 中放置两个 url。

你总是可以嵌套两个gets ...我在这里假设你想在一页上呈现两页画廊......

```
var galleryTemp;
jQuery(function(){
  jQuery.get('/GalleryPage.aspx?gallery=1234', {}, function(data) { 
    galleryTemp = data;
    jQuery.get('/GalleryPage.aspx?gallery=2345', {}, function(data) { 
      galleryXML = data;
      $(galleryXML).prepend($(galleryTemp).children());
      renderGallery(pageIndex);
  }, "xml");              
}); 
```

不幸的是，我没有一个很好的解决方案来加载 N 个页面......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T14:17:34.567

是的，JBristow，你答对了我的问题 :)

好吧，可能是我忘记在我的 Q 中添加以下代码。

```
jQuery('#placeholderGallery').empty();
jQuery(jQuery(html)).appendTo('#placeholderGallery'); 
```

其中（#placeholderGallery）包含媒体库，当我有新的时我想重复添加它。

所以我所做的是，评论第一行 [ `jQuery('#placeholderGallery').empty();`] ，然后重复我的第一个条目，如下所示：

```
 jQuery(function(){
        jQuery.get('GalleryPage.aspx?gallery=369', {}, function(data) { 
            galleryXML = data;
            renderGallery(pageIndex);
        }, "xml");          
    }); 
    jQuery(function(){
        jQuery.get('GalleryPage.aspx?gallery=365', {}, function(data) { 
            galleryXML = data;
            renderGallery(pageIndex);
        }, "xml");          
    }); 
```

希望这会有所帮助，并感谢大家的帮助:)

# asp.net-mvc - StackOverflow 上使用什么控件来显示帖子？

> ID：917379
> 
> 赞同：0
> 
> 时间：2009-05-27T18:47:42.350
> 
> 标签：asp.net-mvc, pagination, repeater

我正在用 ASP.NET MVC 构建一个站点。我打算复制 StackOverflow 显示其帖子的方式。这些人在 ASP.NET MVC 中使用中继器控件吗？我确实想要完全控制呈现的标记，但我也想要分页。

在这种情况下，最好的方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T19:08:25.273

在 MVC 中，我建议在您的控制器中（或在存储库中，在从控制器调用的函数中）中使用 LINQ 查询的组合，在您的视图中使用 for 循环，并取决于您想要显示的项目的复杂程度是，循环内的局部视图。

对于分页，您可以将 start 和 count 参数传递给函数，以通过 LINQ 获取对象列表的一部分。例如：

```
Function sliceList(ByVal startIndex As Integer, ByVal count As Integer) As Generic.List(Of myObject)
   Dim FullObjectList As Generic.List(Of myObject) = GetObjectsFromSomewhere()
   Dim returnList As New Generic.List(Of myObject)
   returnList = From o In FullObjectList Skip startIndex Take count
   Return returnList
End Function 
```

然后，您的控制器将返回的列表传递给视图进行显示，然后您循环遍历它，随意显示项目。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:10:57.810

我不知道 StackOverflow 是如何实现的，但你不需要使用任何 asp.net 控件。

当然，您需要构建自己的寻呼机。

看看 NerdDinner 教程，它有一个部分展示了如何创建分页列表。 [http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx](http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx)

这非常简单，您可以完全控制所有标记。事实上，您几乎必须提供所有标记，几乎没有一个标记是由 asp.net 生成的。

# perl - 同时学习 Perl 和 Catalyst 可行吗？

> ID：917380
> 
> 赞同：6
> 
> 时间：2009-05-27T18:47:48.187
> 
> 标签：perl, catalyst

同时学习 Perl 和 Catalyst 可行吗？如果是这样，典型的路径是什么？

我是经验丰富的 .Net/C#/C++ 开发人员，但对 Perl 相当陌生

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-27T18:54:52.023

Catalyst 是 Perl 中的一个 Web 框架，它确实使用了 Perl 中的一些高级概念，例如属性、引用等。应该先学习 Perl。当您对 Perl 感到满意时，您可以深入研究 Catalyst。

要学习 Perl，您可以查看[http://learn.perl.org/](http://learn.perl.org/)。还有很多 Perl Mongers 网站。您也可以在您所在地区附近找到一个社区！

还可以浏览[Perl Monks](http://perlmonks.org/ "修道院大门")。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T18:55:27.030

立即从温和的 Catalyst 教程开始，手边有一些初学者的 Perl 教程/参考资料。来自 C#/C++ 的你会对 Perl 有一些惊喜，但还不足以担心。Perl 通常随大量文档一起分发，而且非常宝贵。所以我觉得你可以在学习 Catalyst 的同时学习 Perl，然后再学习更深入的 Perl 技能。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-28T03:24:26.503

在 2009 年 7 月 12 日出版的[书中](http://www.apress.com/book/view/1430223650)，我们建议您熟悉 Perl 数据类型、引用和对象。我想出的用于学习这些东西的最佳免费资源是[Perlmonks 教程](http://www.perlmonks.org/?node=Tutorials)，尤其是[关于参考](http://www.perlmonks.org/?node_id=591878)的教程。

如果您是一位经验丰富的程序员，刚刚开始接触 perl，那么 Catalyst 是学习如何编写有纪律的、结构化的、面向对象的 Perl 的好方法。

除此之外，正如 dwc 所说[，该教程](http://search.cpan.org/perldoc?Catlyst::Manual::Tutorial)非常好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-28T20:55:40.940

**永远**要记住的最重要的事情：

```
use strict;
use warnings; 
```

在所有 Perl 文件的开头。

*（至少在你知道原因之前）*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-07-13T04:02:50.993

我认为在建造之前了解建筑材料是很自然的。而框架正是如此。

自然过渡是从基础开始的，如果您认为自己的时间较少，您可能应该从小书开始，例如 simon cozens 或 learn.perl.org 等的《Beginning perl》，以了解编写程序的感觉是什么？当涉及到 perl 等时，面向对象的术语。

# silverlight - 在 IE 7 中禁用 Silverlight 的其他方法？

> ID：917384
> 
> 赞同：0
> 
> 时间：2009-05-27T18:48:52.147
> 
> 标签：silverlight, internet-explorer-7, installation

我知道我可以使用“管理加载项”对话框禁用 Silverlight 加载项，但是如果计算机上实际安装了正确版本的 Silverlight，还有哪些其他设置会导致 Silverlight 无法运行并显示“安装”链接？

Silverlight 应用程序不会在一个管理用户帐户下的单个客户端计算机上的 Internet Explorer 7 中显示（它们显示安装链接）。它们在同一台计算机上的 FireFox 和 Chrome 中显示。它们适用于同一台计算机上 Internet Explorer 中的其他用户。插件已启用。它显示的症状与禁用 Silverlight 加载项相同。还有什么可能导致这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T18:51:52.170

IE 中是否启用了 Javascript？托管应用程序的站点是否位于受限站点区域？

# c# - 返回零结果的数据集

> ID：917387
> 
> 赞同：0
> 
> 时间：2009-05-27T18:49:50.583
> 
> 标签：c#, sql, winforms, debugging, data-access-layer

我正在尝试从数据库中填写我的 winform 应用程序的组合框。我知道数据库中有信息。我知道SP有效。它返回正确的列名。但是DataSet本身是空的吗？帮助！？！？

从我的表单调用-->

```
cboDiagnosisDescription.Properties.DataSource = myDiagnosis.RetrieveDiagnosisCodes(); 
```

RetrieveDiagnosisCodes -->

```
public DataSet RetrieveDiagnosisCodes()
    {
        string tableName = "tblDiagnosisCues";
        string strSQL = null;
        DataSet ds = new DataSet(tableName);
        SqlConnection cnn = new SqlConnection(Settings.Default.CMOSQLConn);
        //strSQL = "select * from " & tableName & " where effectivedate <= getdate() and (termdate >= getdate() or termdate is null)"
        strSQL = "select tblDiagnosisCues.*, tblDiagnosisCategory.Description as CategoryDesc, tblDiagnosisSubCategory.Description as SubCategoryDesc " + "FROM dbo.tblDiagnosisCategory INNER JOIN " + "dbo.tblDiagnosisSubCategory ON dbo.tblDiagnosisCategory.Category = dbo.tblDiagnosisSubCategory.Category INNER JOIN " + "dbo.tblDiagnosisCues ON dbo.tblDiagnosisSubCategory.SubCategory = dbo.tblDiagnosisCues.SubCategoryID " + "where effectivedate <= getdate() and (termdate >= getdate() or termdate is null) order by tblDiagnosisCues.Description";
        SqlCommand cmd = new SqlCommand(strSQL, cnn) {CommandType = CommandType.Text};
        SqlDataAdapter da = new SqlDataAdapter(cmd);
        try
        {
            //cnn.Open();
            da.Fill(ds);
        }
        catch (Exception ex)
        {
            throw;
        }
        finally
        {
            cmd.Dispose();
            da.Dispose();
            //ds.Dispose();
            cnn.Close();
            cnn.Dispose();
        }
        return ds;
    } 
```

我知道它返回正确列名的原因是我使用 DevExpress LookUpEdit 框尝试了以下操作，它从数据库中填充了正确的列 -->

```
 var myDiagnosis = new Diagnosis();
        var ds = myDiagnosis.RetrieveDiagnosisCodes();
        lkuDiagnosis.Properties.DataSource = ds;
        lkuDiagnosis.Properties.PopulateColumns();
        lkuDiagnosis.Properties.DisplayMember = ds.Tables[0].Columns[1].ColumnName;
        lkuDiagnosis.Properties.ValueMember = ds.Tables[0].Columns[0].ColumnName; 
```

想法？主要是，我什至不知道如何继续跟踪这个......如何调试它？

## 编辑 1

根据评论，我自己运行了以下 SQL，它返回了 650 个结果......

```
select tblDiagnosisCues.*, 
    tblDiagnosisCategory.Description as CategoryDesc,   
    tblDiagnosisSubCategory.Description as SubCategoryDesc 
FROM dbo.tblDiagnosisCategory 
    INNER JOIN dbo.tblDiagnosisSubCategory 
    ON dbo.tblDiagnosisCategory.Category = dbo.tblDiagnosisSubCategory.Category 
        INNER JOIN dbo.tblDiagnosisCues ON dbo.tblDiagnosisSubCategory.SubCategory = dbo.tblDiagnosisCues.SubCategoryID 
where effectivedate <= getdate() and (termdate >= getdate() or termdate is null) order by tblDiagnosisCues.Description 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T18:58:25.480

//cnn.open();

...

//ds.dispose();

无需在数据集构造函数中指定表名。fill 方法将添加一个表格。也无需打开连接，因为 sqldataadapter 将为您打开和关闭连接。另外，我更喜欢返回一个数据表，而不是一个表的数据集。

代码可以重构为以下...当然，如果要记录异常，请添加 try catch。

```
public DataTable RetrieveDiagnosisCodes()
{
    //string tableName = "tblDiagnosisCues";
    DataSet ds = new DataSet();
    Datatable dt = null;
    //strSQL = "select * from " & tableName & " where effectivedate <= getdate() and (termdate >= getdate() or termdate is null)"
    string strSQL = "select tblDiagnosisCues.*, tblDiagnosisCategory.Description as CategoryDesc, tblDiagnosisSubCategory.Description as SubCategoryDesc " + "FROM dbo.tblDiagnosisCategory INNER JOIN " + "dbo.tblDiagnosisSubCategory ON dbo.tblDiagnosisCategory.Category = dbo.tblDiagnosisSubCategory.Category INNER JOIN " + "dbo.tblDiagnosisCues ON dbo.tblDiagnosisSubCategory.SubCategory = dbo.tblDiagnosisCues.SubCategoryID " + "where effectivedate <= getdate() and (termdate >= getdate() or termdate is null) order by tblDiagnosisCues.Description";

    using(SqlDataAdapter da = new SqlDataAdapter(strSQL, Settings.Default.CMOSQLConn))
    {
      da.Fill(ds);
    }
    if (ds.Tables.Count > 0)
    {
      dt = ds.Tables[0];
    }

    return dt;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T18:53:15.927

如果数据正确绑定到另一个控件，则表明数据绑定过程存在问题。对于有问题的组合框，您的数据绑定设置是什么样的？所有列名的拼写和设置是否正确？

# sql - 如何确定 COALESCE 运算符成功选择的列/值？

> ID：917388
> 
> 赞同：9
> 
> 时间：2009-05-27T18:50:02.847
> 
> 标签：sql, sql-server, tsql, sql-server-2000, coalesce

我有一个表，我希望从每个 ID 的 3 个（并且只有 3 个）列中找到第一个非空值，从 Col1 开始，然后到 Col2，然后到 Col3

注意：Col3 永远不会为空

```
ID    Col1    Col2    Col3
------------------------------
1     A       B       X
2     NULL    C       X
3     NULL    NULL    X
4     D       NULL    X 
```

要为每个值获取正确的列，我使用以下 SQL 选择

```
SELECT    ID,
          COALESCE(Col1, Col2, Col3) AS Col
FROM      MyTable 
```

它返回以下内容并且工作正常

```
ID    Col
-------------
1     A
2     C
3     X
4     D 
```

我想要的是返回第三列，指示合并成功的列。以下是我希望生成的结果集：

```
ID    Col    Source
-----------------------
1     A      Col1
2     C      Col2
3     X      Col3
4     D      Col1 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T18:52:37.677

也许这会起作用？

```
SELECT    ID,
          COALESCE(Col1, Col2, Col3) AS Col,
          CASE COALESCE(Col1, Col2, Col3)
              WHEN Col1 THEN 'Col1'
              WHEN Col2 THEN 'Col2'
              WHEN Col3 THEN 'Col3'
              ELSE 'Unknown'
          END AS Source
FROM      MyTable 
```

# c++ - QPainter 彩色文本（语法着色）

> ID：917391
> 
> 赞同：2
> 
> 时间：2009-05-27T18:51:04.870
> 
> 标签：c++, qt, syntax-highlighting, qpainter

我有一个自定义的 Qt 小部件，用于显示反汇编，我希望为其添加语法着色。

目前，我只是将 设置`QPen`为纯色，构建我想要显示的文本，并将其渲染到`QPainter`适当的坐标处。

问题是，添加语法着色的最佳方法是什么？我想到了几个：

1.  我可以简单地将颜色划分为逻辑块，每个逻辑块之前都将 QPen 设置为所需的颜色。
2.  我可以有特殊的转义字符来表示调色板的变化，一次渲染 1 个字符。
3.  我可以对#1 进行修改并创建一个列表`std::pair<QColor, QString>`，然后我可以简单地迭代列表设置颜色并在我从列表前面弹出项目时绘制文本。
4.  完全不同的东西？

我知道我列出的 3 种方法中的每一种在技术上都是可行的，但我正在寻找一个非常有效的解决方案。这段代码会被调用很多次。而且由于这是一个交互式调试器，如果此代码很慢，那么快速步进或跟踪的人会看到明显的减速。

**编辑：**我知道`QSyntaxHighlighter`and `QTextDocument`。主要问题是这些通常不太适合我的目的。我有几列都有分隔线，可以来回滑动。为了给您一个想法，这是[我的调试器屏幕截图的](http://www.codef00.com/img/debugger.png)链接。如您所见，它根本不像一个文本文档。事实上，它更接近于列表或表格。但是已经有一堆自定义绘图正在进行，使正常`QTextDocument`有点不切实际。

**编辑**：我不正确，似乎`QTextDocument`可以直接渲染到`QPainter`. 看起来像我需要的！

**编辑**：目前尚不清楚如何控制在何处以及如何`QTextDocument`或`QTextLayout`将使用`QPainter`. 我试图使用它们无济于事。因此，如果有人可以提供一个基本示例，那将非常有帮助。

**编辑**：我最终能够使用这样的东西得到我想要的东西：

```
painter.setPen(default_color);
QTextDocument doc;
doc.setDefaultFont(font());
doc.setDocumentMargin(0);
doc.setPlainText(text);
highlighter_->setDocument(&doc);

painter.save();
painter.translate(x, y);
QAbstractTextDocumentLayout::PaintContext context;
context.palette.setColor(QPalette::Text, painter.pen().color());
doc.draw(&painter, context);
painter.restore(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:21:13.377

Qt 提供了一个[`QSyntaxHighlighter`](https://doc.qt.io/qt-5/qsyntaxhighlighter.html)可能正是你想要的。 `QSyntaxHighlighter`使用 a[`QTextDocument`](https://doc.qt.io/qt-5/qtextdocument.html)来标记具有特定状态的每个代码块，该状态可以与特定的表示[格式](https://doc.qt.io/qt-5/qtextcharformat.html)相关联。

上的文档`QSyntaxHighlighter`提供了一个示例，演示了如何实现这一点并做了一些好事：

*   将模型与演示分开
*   将格式分成不同的可重用类（如果这样实现）
*   如果对您的语言有用，则支持[State](http://exciton.cs.rice.edu/JavaResources/DesignPatterns/StatePat.htm)设计模式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T19:21:16.853

我会使用[QTextEdit](http://doc.trolltech.com/qtextedit.html)或直接为其下划线引擎[QTextDocument](http://doc.trolltech.com/qtextdocument.html)。

# svn - 我应该如何修复“svn：行尾样式不一致”？

> ID：917392
> 
> 赞同：40
> 
> 时间：2009-05-27T18:51:14.340
> 
> 标签：svn, line-endings

当我运行“svn propedit svn:ignore”。在我的 svn 存储库的根目录中，我收到此错误：svn: Inconsistent line ending style

我试图运行这个脚本：[http](http://blog.eflow.org/archives/130) : //blog.eflow.org/archives/130，它运行 dos2unix 并在所有文件上设置了 eol 样式，但是这个问题仍然存在。知道有什么问题吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2011-11-02T17:47:45.187

就我而言，`svn:eol-style`属性是在文件上设置的。并且“文件的某些行由 UNIX 行结尾（LF 字符）分隔，而其他行由 DOS 样式的行结尾（CR + LF 字符）分隔”。[这](http://lookfirst.com/2008/11/subversion-inconsistent-line-ending.html)是另一个关于这个问题的详细讨论。
`"Edit"->"EOL Conversion"->"Windows format"`在[记事本++](http://notepad-plus-plus.org/)中为我解决了这个问题。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2014-12-05T01:54:22.977

就我而言，我在 Windows 中进行编辑。修理：

1.  在记事本++中打开文件
2.  将行尾转换为 Unix（编辑菜单 -> EOL 转换 -> Unix）
3.  节省
4.  将行尾转换为 Windows（编辑菜单 -> EOL 转换 -> Windows）
5.  节省

这做到了。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-05-28T13:00:03.753

Subversion 不是抱怨任何文件的内容，而是抱怨 svn:ignore 属性的内容。解决此问题的一种方法是简单地删除该`svn:ignore`属性，`svn propdel`然后重新创建它。

如果您的 中有很多行，另一种方法可能更容易`svn:ignore`：

1.  在临时文件中获取 svn:ignore 的值，如下所示：

    `svn propget svn:ignore . > temp`

2.  `temp` 修复文件中的行尾
3.  从固定文件中设置 svn:ignore 的值，如下所示：

    `svn propset svn:ignore -F temp .`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2010-07-13T16:22:04.577

跑步

```
unix2dos [file] 
```

通过 cygwin 为我解决了这个问题。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2010-01-27T03:54:48.047

我的问题是我在 Visual Studio.NET 中得到了这个。为了修复它，我将文件的所有文本复制到记事本中，并将其从记事本保存到“xxx.aspx”或任何正确的文件名。然后在 Visual Studio 中，系统提示我重新加载已更改的文件，然后出现一个对话框，询问我是否要规范化我的行尾。问题解决了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-06T12:56:35.567

如果它只发生在一两个文件中，您也可以打开文件，将内容复制并粘贴到新文件（使用普通文本编辑器），然后保存。然后可以添加此文件（重命名或移动以使其成为正确的名称）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-12-09T13:40:34.000

我收到了这个错误，但它最终成为一个缺少最后一个谎言结尾的文件（最后一行不完整）。

通过在 VI 中打开文件并保存来解决此问题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-27T18:58:04.250

脚本是否确实触及了每个文本文件（假设您确实安装了 dos2unix，否则这就是为什么......）？

我能想到的另一件事是检查所有文件的 mime 类型设置是否正确（你没有以某种方式标记为签入文本文件的二进制文件，也许？）。

也就是说，如果您处于多操作系统环境中，*如果*您在操作系统之间共享和编辑文本文件，我认为将 svn:eol-style 设置为 CRLF 不是一个好主意，如上面的博客文章中所述。因为如果你这样做，在 Windows 中看起来还不错的文件在 Unix 中会被控制字符乱七八糟。最好使用“本机”作为 EOL 样式。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-03-19T20:04:28.410

vi 没有显示坏行，所以我从评论部分删除了行尾，读取它们（直到 END）并保存文件。在那之后它起作用了。

注意：在调整它之前备份你的 revprop 文件。如果你草皮它，就不会回头

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-04T06:17:50.603

通过 Windows 机器上的 ant 任务运行 javadoc 时，我遇到了同样的问题。

`<fixcrlf srcdir="${dir.javadoc}" eol="dos"/>`我通过在 javadoc ant 任务下方添加来修复它。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-28T03:39:39.690

如果您在进行 propedit 时得到它，那么在我看来，SVN 更多地抱怨您用于属性的文本文件的格式！

你在哪个操作系统上？您使用哪个编辑器进行宣传？如果 propedit 命令仍然启动编辑器，我将使用此编辑器检查其中的行尾（vi 执行此 IIRC）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-01-09T17:18:39.073

我在以前运行良好的存档中遇到了同样的问题。在记事本++中，我选择了将格式转换为 UTF-8。这对我有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-08T07:07:11.590

要使用 perl(1) 一致地将 Windows 转换为 UNIX 行结尾：

```
perl -p -i.bak -e 's#\r\n#\n#go' my-file.txt 
```

要从 UNIX 转换回 Windows：

```
perl -p -i.bak -e 's#\n#\r\n#go' my-file.txt 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-03-21T18:12:56.397

在对几个文本文件进行了一些修改之后，我出现了这个问题，这些修改只`\n`添加到单独的某些行，而通常`\r\n`终止每一行。因此，解决方法是使用 Notepad++ 查找`([^\r])\n` 并替换为`$1\r\n`. 这样，行尾字符在任何地方都是一致的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-06-12T00:00:45.660

这困扰了我很长时间，在一个使用 SVN 的多系统团队中工作。我制作了这个有用的应用程序，它导航一个带有子文件夹的文件夹，查找文本文件并将所有 UNIX EOL 转换为 DOS EOL。它是一个 AIR 应用程序，适用于 Windows 和 Mac。希望能帮助到你

[http://www.pippoflash.com/index.php/2012/06/11/svn-error-inconsistent-line-ending-style-nightmare-solved-download-app/](http://www.pippoflash.com/index.php/2012/06/11/svn-error-inconsistent-line-ending-style-nightmare-solved-download-app/)

菲利波

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-08-05T18:50:29.197

对于 mac osx，我收到了这个文件错误，必须使用 dos2mac 和 mac2unix 对其进行转换。一旦我这样做了，它就解决了行尾抱怨的问题。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-01-10T23:06:57.837

正如上面建议的'Marius Matioc'，将是简单快捷的修复 1.在 Notepad++ 中打开文件 2.Edit 菜单 -> EOL Conversion -> Unix 3.Save 4.Edit 菜单 -> EOL Conversion -> Windows 5.Save

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-02-02T11:58:58.750

尝试`svn propset eol-style:native`在 emacs 中使用 PHP 文件时，我收到了相同的错误消息，所以希望这会帮助解决这个问题的人。

我有类似以下内容：

```
str_replace('</li>^M<br>', '</li>', $text); 
```

单个字符在哪里`^M`（用于回车的插入符号转义）。

解决方法是将该行更改为等效项：

```
str_replace("</li>\r<br>", '</li>', $text); 
```

注意双引号而不是单引号！

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-09-15T13:18:36.683

在 NetBeans 中，您可以使用“[显示和更改行尾](http://plugins.netbeans.org/plugin/36810/show-and-change-line-endings)”插件。

安装并重新启动 NetBeans 后，行尾样式显示在状态栏的右侧。您可以单击它并选择要将文件转换为的结尾。

![NetBeans 显示和更改行尾插件](https://i.stack.imgur.com/0YuPm.png)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-09-01T12:09:19.980

就我而言，发生错误是因为该文件的编码为“UCS-2 LE BOM”。带有 ANSI 的文件没问题。我检查了行尾，在所有文件中它们都是正确的。似乎（至少在我的 SVN 版本中）宽字符文件有时无法正确识别。

最简单的解决方案是删除“svn:eol-style”属性。

# floating-point - 重新调整浮点方程

> ID：917393
> 
> 赞同：3
> 
> 时间：2009-05-27T18:51:24.637
> 
> 标签：floating-point, precision, linear-algebra

我想知道是否有办法提高计算斜率的准确性。（这是几个月前[在这里](https://stackoverflow.com/questions/696573/unexpected-loss-of-precision-when-dividing-doubles/917290#917290)提出的）。

似乎通过改变：

```
float get_slope(float dXa, float dXb, float dYa, float dYb) {
    return (dXa - dXb)/(dYa - dYb);
} 
```

至

```
float get_slope(float dXa, float dXb, float dYa, float dYb) {
    return  dXa/(dYa - dYb) - dXb/(dYa - dYb);
} 
```

可能是一个改进。建议？

编辑：我追求的是精度，而不是效率。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:23:24.773

将它们转换为函数内部的**两倍**。

* * *

很明显，当分母接近零时，你会遇到麻烦。你的斜率将接近无穷大。所以很大程度上取决于你想对斜坡做什么。有时，如果您知道您的 delta y 将接近于零，您可以计算斜率的倒数并改用它。您甚至可以检测哪个更小——deltax 或 deltay 的绝对值并返回斜率或 1/斜率。还要查看 atan2()。

* * *

如果您知道输入是十进制的，并且您也希望输出是十进制的，那么您可以通过使用十进制库进行所有计算来克服将浮点数转换为二进制并返回所固有的精度损失。我记得当我使用 Atari BASIC 进行十进制计算时我是多么高兴，因为它使用了 6502 的 BCD 模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:44:00.507

如果您不介意燃烧一些额外的循环，则可以通过循环获得更好的准确性。

计算 A 和 B 之间的线段的斜率。

计算 {(Xa - (Xa -Xb)), (Ya -(Ya -Yb)} 和 {(Xb + (Xa - Xb)), (Yb +(Ya - Yb))} 之间的线段的斜率。 .. 基本上是 A - 斜率和 B + 斜率。

然后比较得到的斜率。如果差异太大（选择您想要的阈值），则继续前进，并在最后平均所有斜率。

这可以帮助消除由非常小的斜率的浮点运算引起的异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:00:48.610

我认为你有一个错字。你大概是说

```
return  dXa/(dYa - dYb) - dXb/(dYa - dYb); 
```

我会说你给出的第一个表格具有更高的精度。如果 dXa 和 dXb 接近且很大，那么在相减之前您将失去两个除法的精度。

# .net - 在 .NET 中实现数据绑定的线程安全集合

> ID：917400
> 
> 赞同：0
> 
> 时间：2009-05-27T18:53:24.523
> 
> 标签：.net, multithreading, collections, data-binding

我有一个 Windows 窗体应用程序，它显示一个窗体，其中 DataGridView 绑定到继承 BindingList 的自定义集合。我正在使用 BindingSource / DataSource 机制进行数据绑定。表单是一个监视器，显示集合中包含的状态信息。集合的每个元素代表许多子线程之一的状态信息。

我正在使用 SynchronizationContext 方法来确保我的集合中的 ListChanged 事件与 UI 线程同步，并且不会发生跨线程问题。但是，多个线程似乎仍然可以同时处理该集合。这会导致数据绑定问题。以下是已发生异常的示例：

```
> System.ArgumentOutOfRangeException: Specified argument was out of the range of valid values. Parameter name: rowIndex
>    at System.Windows.Forms.DataGridView.GetCellDisplayRectangle(Int32 columnIndex, Int32 rowIndex, Boolean cutOverflow)
>    at System.Windows.Forms.DataGridView.GetCellAdjustedDisplayRectangle(Int32 columnIndex, Int32 rowIndex, Boolean cutOverflow)
>    at System.Windows.Forms.DataGridView.InvalidateCellPrivate(Int32 columnIndex, Int32 rowIndex)
>    at System.Windows.Forms.DataGridView.OnCellCommonChange(Int32 columnIndex, Int32 rowIndex)
>    at System.Windows.Forms.DataGridView.DataGridViewDataConnection.ProcessListChanged(ListChangedEventArgs e)
>    at System.Windows.Forms.DataGridView.DataGridViewDataConnection.currencyManager_ListChanged(Object sender, ListChangedEventArgs e)
>    at System.Windows.Forms.CurrencyManager.OnListChanged(ListChangedEventArgs e)
>    at System.Windows.Forms.CurrencyManager.List_ListChanged(Object sender, ListChangedEventArgs e)
>    at System.Windows.Forms.BindingSource.OnListChanged(ListChangedEventArgs e)
>    at System.Windows.Forms.BindingSource.InnerList_ListChanged(Object sender, ListChangedEventArgs e) 
```

这让我相信，在引发初始 ListChanged 事件并由 UI 线程处理后，集合再次更改。

所以，我的问题是如何使我的集合不仅是线程安全的，而且是阻塞的，以便 UI 可以在 ListChanged 事件之后刷新，然后再允许另一个更改？将 ListChanged 事件排队是不够的，我需要阻止导致 ListChanged 事件被触发的操作。例如，如果我更改元素的属性然后引发 ListChanged 事件 (ListChangedType = ItemChanged)，则尝试将项目添加到集合中的另一个线程将被阻止，直到 ListChanged 事件处理程序返回。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T21:53:25.300

你可以用你自己的任何你想要的接口来包装它。看看[这个对同一个问题的答案](https://stackoverflow.com/questions/148587/has-anyone-written-a-thread-safe-bindinglistt)......

# tfs - 如何以编程方式检测已删除的文件？

> ID：917406
> 
> 赞同：0
> 
> 时间：2009-05-27T18:54:03.727
> 
> 标签：tfs, detect, delete-file

在 Team Foundation 中，您可以通过执行以下操作要求 Team Explorer 显示已删除的文件：

> 工具 > 选项 > 源代码管理 > Visual Team Foundation Server > 在源代码管理资源管理器中显示已删除的项目。

我的问题是你如何以编程方式做同样的事情？

我正在开发一个同步工具，我需要在 TFS 中检测到已删除的文件。Workspace.Get(...) 仅返回未删除的文件。

知道如何实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T19:04:31.443

转到开始菜单中的 Visual Studio 文件夹，然后从“Visual Studio Tools”子文件夹中启动 Visual Studio 命令提示符。

您要运行的命令是：

```
tf dir /server:myserver $/myproject /recursive /deleted 
```

（其中 myserver 和 myproject 是您的服务器和项目）

使用“tf help”获取一般信息，使用“tfs help dir”获取有关此命令的更多帮助，或使用 Google 搜索“tf.exe”获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T09:39:44.143

VersionControlServer.QueryHistory API 将使您能够访问包含所有版本控制操作（包括删除）的变更集。

# iphone - 将 UITextView / UITextField 中的空格编码为 URL 格式

> ID：917409
> 
> 赞同：8
> 
> 时间：2009-05-27T18:54:20.217
> 
> 标签：iphone, nsstring, uitextfield, uitextview, urlencode

我正在尝试将 UITextView 或 UITextField 的内容作为参数发送到 php 文件

```
NSString *urlstr = [[NSString alloc] initWithFormat:@"http://server.com/file.php?name=%@&tags=%@&entry=%@",nameField.text, tagsField.text, dreamEntry.text]; 
```

当我记录 urlstr 时，只要 UITextView 或 UITextField 不包含空格，url 格式就可以了。我将如何将空格转换为 %20 ？

编辑

这是目前的代码，它不仅崩溃，而且没有正确编码 url。

name=John Doe&tags=recurring nightmare&entry=测试测试测试

被转换为

name=John -1844684964oe&tags=recurringightmare&entry=测试 4.214929e-307sting -1.992836e+00sting

```
- (IBAction)sendButtonPressed:(id)sender
{

    NSString *urlString = [[NSString alloc] initWithFormat:@"http://server.com/file.php?name=%@&tags=%@&entry=%@", nameField.text, tagsField.text, dreamEntry.text];

    NSString *encodedString = [urlString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

    NSURL *url = [[NSURL alloc] initWithString:encodedString];

    NSLog(encodedString);

    NSLog(urlString);

    [urlString release];
    [url release];
    [encodedString release];

} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2010-11-10T00:34:27.683

实际上，所有先前的答案都至少包含一些不准确之处，对于 TextFields 中用户提供的文本的许多常见值，它们无法与服务器正确通信

`stringByAddingPercentEscapesUsingEncoding:`percent 转义所有不是有效 URL 字符的字符。此方法应该对整个 URL 应用一次。

先前的答案声称它的`stringByAddingPercentEscapesUsingEncoding:`工作方式类似于许多脚本语言中的 URL 构建类，您不应将其应用于整个 URL 字符串，但事实并非如此。`&`任何人都可以通过检查其输出中未转义的 s 和s来轻松验证这一点`?`。因此，适用于整个字符串是可以的，但仅适用于您的“动态”url 内容是不够的。

前面的答案是正确的，因为您必须对进入 CGI 查询字符串的名称和值做更多的工作。由于 CGI 由 RFC3875 指定，这通常称为 RFC3875 百分比转义。它确保您的名称和值不包含有效的 URL 字符但在 URL 的其他部分很重要的字符（`;`、`?`、`:`、`@`、`&`、`=`、`$`、`+`、`{`、`}`、`<`、`>`和`,`）

然而，完成对整个字符串执行纯 URL 百分比转义以确保字符串中的所有字符都是有效的 URL 字符也是非常重要的。虽然您的示例中没有，但通常字符串的“静态”部分中可能存在无效 URL 字符的字符，因此您也需要转义这些字符。

不幸的是，`NSString`它没有给我们逃避 RFC3875 重要字符的能力，所以我们必须深入研究`CFString`这样做。显然使用`CFString`是一种痛苦，所以我通常会像这样添加`Category`一个`NSString`：

```
@interface NSString (RFC3875)
- (NSString *)stringByAddingRFC3875PercentEscapesUsingEncoding:(NSStringEncoding)encoding;
@end

@implementation NSString (RFC3875)
- (NSString *)stringByAddingRFC3875PercentEscapesUsingEncoding:(NSStringEncoding)encoding {
    CFStringEncoding cfEncoding = CFStringConvertNSStringEncodingToEncoding(encoding);
    NSString *rfcEscaped = (NSString *)CFURLCreateStringByAddingPercentEscapes(
                                                NULL, 
                                                (CFStringRef)self,
                                                NULL, 
                                                (CFStringRef)@";/?:@&=$+{}<>,",
                                                cfEncoding);
    return [rfcEscaped autorelease];
}
@end 
```

有了这个`Category`，原始问题可以通过以下方式正确解决：

```
NSString *urlEscapedBase = [@"http://server.com/file.php" stringByAddingPercentEscapesUsingEncoding:
                                            NSUTF8StringEncoding];
NSString *rfcEscapedName = [nameField.text stringByAddingRFC3875PercentEscapesUsingEncoding:
                                                NSUTF8StringEncoding];
NSString *rfcEscapedTags = [tagsField.text stringByAddingRFC3875PercentEscapesUsingEncoding:
                                                NSUTF8StringEncoding];
NSString *rfcEscapedEntry = [dreamEntry.text stringByAddingRFC3875PercentEscapesUsingEncoding:
                                                NSUTF8StringEncoding];

NSString *urlStr = [NSString stringWithFormat:@"%@?name=%@&tags=%@&entry=%@",
                                urlEscapedBase,
                                rfcEscapedName,
                                rfcEscapedTags,
                                rfcEscapedEntry];

NSURL *url = [NSURL URLWithString:urlStr]; 
```

这有点变重，只是更清楚。另请注意，提供给的变量列表`stringWithFormat:`不应`nil`终止。格式字符串描述了应该跟随它的变量的精确数量。此外，从技术上讲，查询字符串名称（名称、标签、条目等）的字符串应该`stringByAddingPercentEscapesUsingEncoding:`理所当然地运行，但在这个小示例中，我们可以很容易地看到它们不包含无效的 URL 字符。

要了解前面的解决方案为什么不正确，假设用户输入的文本`dreamEntry.text`包含一个`&`，这并非不可能。使用以前的解决方案，当服务器获取该文本时，该字符后面的所有文本都将丢失，因为未转义的 & 符号将被服务器解释为该查询字符串对的值部分的结尾。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-27T19:41:31.477

您不应该对整个字符串进行 URL 转义，而应该对动态组件进行 URL 转义。尝试

```
NSString *urlStr = [NSString stringWithFormat:@"http://server.com/file.php?name=%@&tags=%@&entry=%@",
                        [nameField.text stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding],
                        [tagsField.text stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding],
                        [dreamEntry.text stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding],
                        nil];
NSURL *url = [NSURL URLWithString:urlStr]; 
```

您的代码的第二个问题（无疑是奇怪打印的原因）是您将字符串直接传递给 NSLog，因此它被视为格式字符串。你需要使用

```
NSLog(@"%@", encodedString); 
```

反而。这将使它按预期打印。

编辑：您的代码的第三个问题是您混合了自动释放和拥有的对象，然后在最后释放它们。去看看你创建的 3 个对象，稍后你会发布它们。其中一个不应在以后发布，因为它是由不以 alloc、copy 或 new 开头的方法生成的。识别有问题的对象是留给读者的练习。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T18:59:02.157

您可以获取您的 URL 并使用：

```
NSString *urlStr = [[NSString alloc] initWithFormat:@"http://server.com/file.php?name=%@&tags=%@&entry=%@",nameField.text, tagsField.text, dreamEntry.text];

NSString *encStr = [urlStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

# version-control - 是否可以通过 Internet 使用 Source Safe？

> ID：917411
> 
> 赞同：3
> 
> 时间：2009-05-27T18:54:35.877
> 
> 标签：version-control, visual-sourcesafe

是否可以通过 Internet 使用 Source Safe？

你会做吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T18:57:29.087

[Sourceoffsite](http://www.sourcegear.com/sos/)是专门为此而设计的——如果我记得的话，它是一个非常好的产品。

如果可以选择，我不会使用 sourcesafe。在这个网站上搜索更多细节。它已经被打死了。

其他流行的产品是 subversion/svn、mercurial 和 git。当然还有其他需要花钱的商业产品。其中之一是本网站的赞助商。

编辑

如果您可以选择其他工具/产品，请选择其他工具/产品，但您可以使用 sourcesafe 来完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T18:59:29.083

如果您别无选择，您可以使用 VPN。但这会引发各种其他安全问题。也就是说，假设你甚至有能力这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T18:59:55.930

这取决于版本。IIRC，2005 支持通过 http 访问，[维基百科](http://en.wikipedia.org/wiki/Visual_SourceSafe)的文章似乎证实了这一点。

也就是说，svn+tortoise+ankh 会做所有 source safe 会做的事情，然后一些，只会更快更好，成本也更低。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T19:00:06.273

作为开发人员（和顾问），我们不能总是选择我们使用的工具。是的，您可以将 VSS 配置为使用 HTTP 协议，虽然我不会在 Internet 上使用它，但我已经通过 VPN 和 LAN 连接以这种方式使用它。在慢速 VPN 连接上它并不总是可靠的（会经常重新连接，但不会丢失数据），并且性能是一个问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T19:00:15.430

可能的？是的。我会这样做吗？不，我会使用 sourcesafe 的条件只有一个：如果这是一项工作要求，而我实际上别无选择。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-27T19:00:39.907

我发现 VSS 2005 通过高速连接的 VPN 可以正常工作。有一种方法可以通过 HTTP 访问它。我认为这是一个在 IIS 中为此设置网站的安装选项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T18:57:38.960

我不会。为什么不使用更可靠的东西？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T18:59:11.000

对的，这是可能的。我公司有。

# php - 不同服务器的jQuery firefox问题

> ID：917416
> 
> 赞同：0
> 
> 时间：2009-05-27T18:55:46.377
> 
> 标签：php, jquery, mysql, apache, firefox

我正在使用 jQuery 为我的网站开发一个简单的投票系统。当我在本地（自己的 PC 服务器）上测试它时，一切正常（在 IE、Firefox 和 Chrome 上）。当我上传到我的主服务器时，Firefox 给了我一个错误。

考虑到 Firefox 在我的本地服务器上运行良好，这与服务器的差异有关......

这是功能：

```
$("a.vote_up").click(function(){
//get the id
the_id = $(this).attr('id');

// show the spinner
$(this).parent().html("<img src='layout/images/spinner.gif'/>");

//fadeout
$("div#"+the_id).fadeOut("fast");

    $.ajax({
        type: "POST",
        url: "vote.php?action=up&id="+the_id,
        success: function(msg)
        {
            $("span#vp_container"+the_id).html(msg);
            $("span#vp_container"+the_id).fadeIn();
            //remove the spinner
            $("div#"+the_id).remove();

        }
    });
}); 
```

该功能基本上投票赞成。在 vote.php 中是一个简单的 SQL 函数，它给一个变量加 1。简单的。

我的主网络服务器上发生的事情是它没有删除微调器。它一直显示微调器。或者它继续加载，或者微调器没有被移除。

我的主服务器正在运行：PHP 5.2.5 Apache 2.0.63 MySQL 5.0.77

我的本地服务器是：PHP 5.1.4 Apache 2.0.58 MySQL 5.0.22

* * *

我不知道从哪里开始寻找。我不知道是什么导致了问题！

它发生在 Firefox 3.0.8 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T15:46:06.520

如果你在 Firefox 中有 Firebug

```
console.log("id=", the_id, "; msg=", msg); 
```

在你之前

```
$("span#vp_container"+the_id).html(msg); 
```

所以你可以看到返回的 msg 是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:51:23.843

由于 Firefox 和 jQuery 都在客户端运行，因此不同的服务器没有任何区别。

javascript、html 和 vote.php 文件是否都位于同一目录中？

对我来说似乎是一个路径问题，但如果没有更多信息（代码），这很难说。

**编辑：**服务器错误日志应该告诉你它是否找不到某些文件

# xml - 如何从 Delphi Prism 中的 XML 模式生成 Pascal 代码？

> ID：917418
> 
> 赞同：5
> 
> 时间：2009-05-27T18:56:04.207
> 
> 标签：xml, delphi, xsd, delphi-prism

我需要导入一些 XML 模式。
在 Delphi 中，我将使用**XML 数据绑定向导**从模式中生成**Pascal 代码**。**Delphi Prism**
中 是否有类似的东西来避免编写所有这些样板代码？

 *** * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T19:36:24.733

尝试 Microsoft SDK 中的 xsd.exe。/l:Oxygene 生成 Delphi Prism 代码。

# xhtml - 将 XHTML 呈现为 MS Word 文档 - 标题

> ID：917419
> 
> 赞同：0
> 
> 时间：2009-05-27T18:56:24.657
> 
> 标签：xhtml, ms-word

我生成了一个 XHTML 文档并将 Mime 类型设置为“application/msword”，以便它在 Word 中打开。

要创建一个标题，我似乎必须引用一个*外部*文件：

```
<style>
   ...
   @page{mso-footnote-separator:url("**OUT_files/header.htm**") fs;
   mso-footnote-continuation-separator:url("OUT_files/header.htm") fcs;
   mso-endnote-separator:url("OUT_files/header.htm") es;
   mso-endnote-continuation-separator:url("OUT_files/header.htm") ecs;}
   @page Section1{
      mso-header-margin:.5in;
      mso-header:url("OUT_files/header.htm") h1;
   }                }
   ...
</style> 
```

有谁知道如何引用主 XHTML 文档本身中定义的 div，而不必引用外部文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-11T15:21:22.000

MS Word 已完全锁定。我无法让它与非外部文件一起使用，但这似乎是有道理的。“包含”的值在显示中重复出现。不可能有“隐藏”的 div 并引用它们（至少，在我尝试的时候不是），所以不知道如何让它正常工作。

对我来说，我最终只是创建了一个简单的宏来为我处理这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:41:34.223

如果你很幸运，一个 data: URL 可能会在 Word 2007 中工作？我自己没有尝试过，但 MS 引入了对数据的部分支持：IE8 中的 URL。

# sql - SQL Server - 为 sysobjects 返回 SCHEMA

> ID：917431
> 
> 赞同：35
> 
> 时间：2009-05-27T18:59:02.750
> 
> 标签：sql, sql-server, tsql

在 sysobjects 上进行选择时如何获取 SCHEMA？

我正在修改一个名为**SearchObjectsForText**的存储过程，它只返回名称，但我也想包含 SCHEMA。

现在它正在做类似的事情：

```
SELECT DISTINCT name
FROM sysobjects 
```

我想知道需要加入哪些表才能返回每个“名称”的 SCHEME。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-05-27T19:06:36.650

如果您指的是 SQL Server 2005 或更高版本，请使用 sys.objects 而不是 sysobjects：

```
SELECT  sys.objects.name, sys.schemas.name AS schema_name
FROM    sys.objects 
INNER JOIN sys.schemas ON sys.objects.schema_id = sys.schemas.schema_id 
```

2005 年引入了模式。最多 2000 个，用户等于模式。SQL Server 2000 的相同查询：

```
SELECT  sysusers.name AS OwnerName, sysobjects.name
FROM sysobjects
INNER JOIN sysusers ON sysobjects.uid = sysusers.uid 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-27T19:14:12.920

在 Sql Server 2005（及更高版本）上，您可以使用 sys.objects 视图：

```
select 
  name                    as  ObjectName,     
  schema_Name(schema_id)  as  SchemaName
from 
  sys.objects 
```

在 Sql Server 2000（及以下）中，“模式”具有不同的概念含义。来自 MSDN 的注释：

*在 SQL Server 的早期版本中，数据库可能包含称为“模式”的实体，但该实体实际上是数据库用户。SQL Server 2005 是 SQL Server 的第一个版本，其中架构既是容器又是命名空间。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-27T19:07:06.133

您可以改用[Information_Schema 视图](http://msdn.microsoft.com/en-us/library/ms186778.aspx)吗？

```
SELECT DISTINCT table_name, table_schema
FROM INFORMATION_SCHEMA.TABLES 
```

根据[MSDN 页面](http://msdn.microsoft.com/en-us/library/ms186778.aspx)（适用于 SQL Server 2008 及更高版本），

> 不要使用 INFORMATION_SCHEMA 视图来确定对象的架构。查找对象架构的唯一可靠方法是查询 sys.objects 目录视图。

但是，似乎他们可能指的是您有一个表名并试图找到它的架构的问题，如果有多个同名的表（在不同的架构中），这将不起作用。如果您要查询多个结果（而不仅仅是尝试查找特定表的架构），那么应该没问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T19:26:07.297

我倾向于使用更集中的“sys”视图——sys.procedures 而不是 sys.objects。您需要将其与 sys.schemas 视图结合以获取架构名称等。

```
select
    p.name, 
    s.name 'Schema',
    p.type_desc, p.create_date, p.modify_date
from
    sys.procedures p
inner join
    sys.schemas s ON p.schema_id = s.schema_id 
```

我将开始远离使用“sysobjects”，因为 Microsoft 在 Books Online 中明确指出“sysobjects”在未来的版本中会被删除：

*包含此 SQL Server 2000 系统表作为向后兼容的视图。我们建议您改用当前的 SQL Server 系统视图。要查找等效的系统视图，请参阅将 SQL Server 2000 系统表映射到 SQL Server 2005 系统视图。此功能将在 Microsoft SQL Server 的未来版本中删除。避免在新的开发工作中使用此功能，并计划修改当前使用此功能的应用程序。*

马克

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-09-24T09:55:15.753

只是为了重复这里已经建议的内容，这是我使用的，在我的数据库中获取表、存储过程、视图和函数的列表：

```
SELECT schema_Name(schema_id)  as  SchemaName,
       [name],              --  Name of the Table, Stored Procedure or Function
       [type]               --  'V' for Views, 'U' for Table, 'P' for Stored Procedure, 'FN' for function
FROM sys.objects 
WHERE [type_desc] IN ( 'USER_TABLE', 'SQL_STORED_PROCEDURE', 'VIEW', 'SQL_SCALAR_FUNCTION')
AND [name] NOT LIKE 'sp_%'
AND [name] NOT LIKE 'fn_%'
ORDER BY 3 DESC,        --  type first
        1 ASC,          --  then schema
        2 ASC           --  then function/table name 
```

...这就是我们的好朋友**诺斯温德**会回来的...

[![在此处输入图像描述](https://i.stack.imgur.com/JT0ZQ.png)](https://i.stack.imgur.com/JT0ZQ.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-18T17:53:17.217

在 SQL 200 中：

```
select DISTINCT
  name            as  ObjectName,     
  USER_NAME(uid)  as  SchemaName
from 
  sysobjects 
```

在 SQL Server 的早期版本中，数据库可能包含称为“模式”的实体，但该实体实际上是数据库用户。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-24T15:18:53.597

包括一个选项，可以删除以特定前缀开头的所有对象，也可以从特定模式中删除。顺便说一句，我添加了额外的查询来获取默认情况下未存储在 sysobjects 上的所有类型。

我已将整个示例脚本上传到 GitHub： [DropAll_Dnn_Objects.sql](https://raw.githubusercontent.com/fomenta/scripts/master/SqlServer/Dropping/DropAll_Dnn_Objects.sql)

第 1 部分：临时存储过程：

```
IF OBJECT_ID('_temp_DropAllDnnObjects') IS NOT NULL
    DROP PROCEDURE _temp_DropAllDnnObjects;
GO

CREATE PROCEDURE _temp_DropAllDnnObjects
    @object_prefix NVARCHAR(30),
    @schema_name sysname = NULL
AS
BEGIN
    DECLARE @sname sysname, @name sysname, @type NVARCHAR(30)
    DECLARE @object_type NVARCHAR(255), @sql NVARCHAR(2000), @count INT = 0

    DECLARE curs CURSOR FOR
        SELECT sname, [name], xtype 
        FROM (
            SELECT SCHEMA_NAME(schema_id) as sname, [name], [type] as xtype
                FROM sys.objects
                WHERE [type] IN ('U', 'P', 'FN', 'IF', 'TF', 'V', 'TR')
                    AND name LIKE @object_prefix + '%'
                    AND (@schema_name IS NULL OR schema_id = SCHEMA_ID(@schema_name))
            UNION ALL
            SELECT SCHEMA_NAME(schema_id) as sname, [name], 'TYPE' as xtype
                FROM sys.types
                WHERE is_user_defined = 1
                    AND [name] LIKE @object_prefix + '%'
                    AND (@schema_name IS NULL OR schema_id = SCHEMA_ID(@schema_name))
            ) a
        ORDER BY CASE xtype
                        WHEN 'P'    THEN 1
                        WHEN 'FN'   THEN 2
                        WHEN 'IF'   THEN 3
                        WHEN 'TF'   THEN 4
                        WHEN 'TR'   THEN 5
                        WHEN 'V'    THEN 6
                        WHEN 'U'    THEN 7
                        WHEN 'TYPE' THEN 8
                        ELSE 9
                    END, name

    OPEN curs;
    FETCH NEXT FROM curs INTO @sname, @name, @type;

    WHILE @@FETCH_STATUS = 0
    BEGIN
        SET @count = @count + 1
        -- Configuration point 2
        SET @object_type = CASE @type
                        WHEN 'P'    THEN 'PROCEDURE'
                        WHEN 'FN'   THEN 'FUNCTION'
                        WHEN 'IF'   THEN 'FUNCTION'
                        WHEN 'TF'   THEN 'FUNCTION'
                        WHEN 'TR'   THEN 'TRIGGER'
                        WHEN 'V'    THEN 'VIEW'
                        WHEN 'U'    THEN 'TABLE'
                        WHEN 'TYPE' THEN 'TYPE'
                    END
        SET @sql = REPLACE(REPLACE(REPLACE('DROP <TYPE> [<SCHEMA>].[<NAME>];', 
                        '<TYPE>', @object_type),
                        '<SCHEMA>', @sname),
                        '<NAME>', @name)

        BEGIN TRY  
            PRINT @sql
            EXEC(@sql)
        END TRY  
        BEGIN CATCH  
            PRINT 'ERROR: ' + ERROR_MESSAGE()
        END CATCH  
        FETCH NEXT FROM curs INTO @sname, @name, @type;
    END;

    PRINT CONCAT('Objects Found: ', @Count)
    PRINT ''
    PRINT '------------------------------------------------------'
    PRINT ''

    CLOSE curs;
    DEALLOCATE curs;

    RETURN @Count
END;
GO 
```

它将继续出错（并显示错误消息）。它将返回找到的所有对象的计数。

第 2 部分：使用参数调用存储过程：

您可以创建一个 WHILE 循环以运行该命令，直到没有留下任何对象（依赖项），如下所示：

```
DECLARE @count INT = 1
WHILE @count > 0 EXEC @count = _temp_DropAllDnnObjects 'dnn';
SET @count = 1
WHILE @count > 0 EXEC @count = _temp_DropAllDnnObjects 'aspnet';
SET @count = 1
WHILE @count > 0 EXEC @count = _temp_DropAllDnnObjects 'vw_aspnet';
GO 
```

第 3 部分：最后，摆脱程序：

```
IF OBJECT_ID('_temp_DropAllDnnObjects') IS NOT NULL
    DROP PROCEDURE _temp_DropAllDnnObjects;
GO 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-08-19T03:24:12.780

为什么不使用它来填充您可以使用的临时表，而不是视图？

这是我在存储过程中使用的解决方案

这是动态获取模式并将其添加到数据库中的不同表以便动态获取其他信息的最佳方式

select @sql = 'insert #tables SELECT ''[''+SCHEMA_NAME(schema_id)+''.''+name+'']'' AS SchemaTable FROM sys.tables'

```
exec (@sql) 
```

当然#tables是存储过程中的动态表

# objective-c - 引用当前对象中的方法

> ID：917435
> 
> 赞同：4
> 
> 时间：2009-05-27T18:59:48.817
> 
> 标签：objective-c

如何在 Objective-C 中引用当前对象中的方法？Java中有类似*this*关键字的东西吗？

这里有一些假代码来澄清：

```
@implementation FooBard
- (void) foo {
   i = 1
   m = [this bar: i];
}

- (int) bar: int j {
   k = j - 1;
   return (k);
}
@end 
```

在 Java 中，我只需执行**this.bar()**并完成它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:10:00.980

```
m = [self bar:i]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:43:00.073

所有 Objective-C 方法都有一个隐式参数调用，它是一个指向当前实例`self`的类型的堆栈变量。`id`事实上，任何 C 函数都可以用作 Objective-C 方法，如果它的前两个参数是类型`id`和`SEL`（见下文）。

`self`不是 Objective-C 中的保留关键字，就像`this`在 Java 中一样。例如，您可以`self`在方法内重新分配。这是`init`方法中的标准模式：

```
-(id)init {
  if( (self = [super init]) ) {
    // do initialization here
  }

  return self;
} 
```

但重新分配`self`很少用于任何其他情况。

您可以`self`像使用任何其他类型的变量一样使用`id`:`[self bar:i]`在您提供的示例中。

为了完整起见，所有的 Objective-C 方法也都有一个隐含的参数`_cmd`，它是被调用方法的选择器（类型`SEL`）。有关详细信息，请参阅[Objetive-C 运行时参考](http://developer.apple.com/documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)。

# java - Tomcat 6 和 log4j 应用程序日志记录不产生输出

> ID：917442
> 
> 赞同：1
> 
> 时间：2009-05-27T19:00:38.253
> 
> 标签：java, tomcat, logging, log4j, tomcat6

我正在尝试让 log4j 应用程序（webapp）日志记录在 Tomcat 6 应用程序中工作。我的 WEB-INF 目录中有 log4j-1.2.15.jar，WEB-INF/classes 中有 log4j.dtd 和 log4j.xml。

我的 log4j.xml 看起来像：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd" >
<log4j:configuration>
<appender name="massAppender" class="org.apache.log4j.RollingFileAppender">
    <param name="maxFileSize" value="100KB" />
    <param name="maxBackupIndex" value="2" />
    <param name="File" value="${catalina.home}/logs/mass.log" />
    <layout class="org.apache.log4j.PatternLayout">
        <param name="ConversionPattern" value="%d{ABSOLUTE} %5p %c{1}: %m%n " />
    </layout>
</appender>

<category name="com.company.mass">
    <priority value="DEBUG"/>
    <appender-ref ref="massAppender"/>
</category>

<root>
     <appender-ref ref="massAppender" />
</root>

</log4j:configuration> 
```

我的 servlet 在包中：

```
package com.company.mass; 
```

记录器被声明为：

```
private static Logger logger = Logger.getLogger(Handler.class); 
```

在我的 doGet(...) 方法的顶部有：

```
logger.error("foo"); 
```

当我在 Tomcat 中部署应用程序并转到 servlet 时，它可以正常工作。我什至得到了一个 mass.log 文件，但没有放入其中。它也不会出现在任何其他日志中，也没有明显的错误。知道发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T19:39:44.290

您确定 log4j 实际上是在使用您`log4j.xml`的配置，而不是类路径上的另一个文件吗？

启用系统属性`-Dlog4j.debug`让 log4j 打印出关于它正在使用的配置文件的确切信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:48:56.193

尝试添加该行：

```
<param name="Threshold" value="ALL" /> 
```

到你的 massAppender 配置

这条线

```
<priority value ="debug"/> 
```

在您的根定义中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T19:06:25.403

不确定您的根记录器是否需要优先级。试试这个配置

```
<category name="com.company.mass">
    <priority value="DEBUG"/> 
    <!-- no need to specify appender again here -->
</category>

<root>
    <priority value="INFO"/> 
     <appender-ref ref="massAppender" />
</root> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-13T08:59:20.837

当我遇到这个问题时，我可以通过添加`common-logging.jar`到我的部署程序集中来解决它。

# asp.net - 拒绝频繁访问临时 ASP.NET 文件

> ID：917446
> 
> 赞同：15
> 
> 时间：2009-05-27T19:01:10.497
> 
> 标签：asp.net, visual-studio-2008

从字面上看，每次我运行一个又大又丑的网站项目时，我都会收到一个 UnauthorizedAccessException，并带有一条指向 DLL 的消息，例如，`Temporary ASP.NET Files\ctheweb\0d76d363\4695c81f\App_Web_vi6bbbpy.dll' is denied.` 我然后停止并重新启动该项目，它运行良好。我做了一些测试、调试、修复，再次运行它，再次得到错误。

我倾向于添加一个预构建命令来清除该目录，但我总是更喜欢用锤子以外的东西来解决问题，至少在最初是这样。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-27T19:15:52.653

这种情况在开发过程中经常发生，当您不断修改 aspx 页面时，ASP.NET 正在尝试编译，而 VS 正在尝试编译，而 ASP.NET 正在尝试执行文件。此外，有时当您重置 IIS 时锁定会消失。

```
iisreset /stop
del "C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322\Temporary ASP.NET Files\*.*"  /Q /F /S
del “C:\windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\*.*” /Q /F /S
iisreset /start 
```

如果在生产中发生这种情况，请将其添加到您的 web.config 中。

```
<compilation tempDirectory = “C:\windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\Other\” /> 
```

（滚动到一边，关键是选择一些 \Other\ 文件夹而不是默认文件夹。

最后，使用 Deployment 项目尝试提前预编译所有内容。不编译意味着不尝试替换临时文件夹中的内容

或者您可以尝试操作系统诊断并尝试找出哪个进程锁定了该文件并终止该进程。当存在更简单的解决方案时，不值得付出努力。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-12-07T19:48:57.660

就我而言，答案是微不足道的——从一开始就不是错误。对我来说，ASP.NET 实际上每次启动我的 Web 应用程序时都会在内部抛出这个，我只是偶然忘记了“所有异常中断”设置（来自另一个调试会话）。我检查了它，一切正常。

作为参考，这里是堆栈跟踪：

```
>   mscorlib.dll!System.IO.__Error.WinIOError(int errorCode, string maybeFullPath)  Unknown
    mscorlib.dll!System.IO.FileStream.Init(string path, System.IO.FileMode mode, System.IO.FileAccess access, int rights, bool useRights, System.IO.FileShare share, int bufferSize, System.IO.FileOptions options, Microsoft.Win32.Win32Native.SECURITY_ATTRIBUTES secAttrs, string msgPath, bool bFromProxy, bool useLongPath, bool checkHost)    Unknown
    mscorlib.dll!System.IO.FileStream.FileStream(string path, System.IO.FileMode mode, System.IO.FileAccess access, System.IO.FileShare share, int bufferSize, System.IO.FileOptions options, string msgPath, bool bFromProxy)  Unknown
    mscorlib.dll!System.IO.FileStream.FileStream(string path, System.IO.FileMode mode)  Unknown
    System.Web.dll!System.Web.UI.Util.HasWriteAccessToDirectory(string dir) Unknown
    System.Web.dll!System.Web.HttpRuntime.SetUpCodegenDirectory(System.Web.Configuration.CompilationSection compilationSection) Unknown
    System.Web.dll!System.Web.HttpRuntime.HostingInit(System.Web.Hosting.HostingEnvironmentFlags hostingFlags, System.Security.Policy.PolicyLevel policyLevel, System.Exception appDomainCreationException) Unknown
    System.Web.dll!System.Web.HttpRuntime.InitializeHostingFeatures(System.Web.Hosting.HostingEnvironmentFlags hostingFlags, System.Security.Policy.PolicyLevel policyLevel, System.Exception appDomainCreationException)   Unknown
    System.Web.dll!System.Web.Hosting.HostingEnvironment.Initialize(System.Web.Hosting.ApplicationManager appManager, System.Web.Hosting.IApplicationHost appHost, System.Web.Configuration.IConfigMapPathFactory configMapPathFactory, System.Web.Hosting.HostingEnvironmentParameters hostingParameters, System.Security.Policy.PolicyLevel policyLevel, System.Exception appDomainCreationException) Unknown
    System.Web.dll!System.Web.Hosting.HostingEnvironment.Initialize(System.Web.Hosting.ApplicationManager appManager, System.Web.Hosting.IApplicationHost appHost, System.Web.Configuration.IConfigMapPathFactory configMapPathFactory, System.Web.Hosting.HostingEnvironmentParameters hostingParameters, System.Security.Policy.PolicyLevel policyLevel)  Unknown
    [AppDomain (DefaultDomain, #1) -> AppDomain (/LM/W3SVC/4/ROOT-1-130624548490751465, #2)]  
    System.Web.dll!System.Web.Hosting.ApplicationManager.CreateAppDomainWithHostingEnvironment(string appId, System.Web.Hosting.IApplicationHost appHost, System.Web.Hosting.HostingEnvironmentParameters hostingParameters)    Unknown
    System.Web.dll!System.Web.Hosting.ApplicationManager.CreateAppDomainWithHostingEnvironmentAndReportErrors(string appId, System.Web.Hosting.IApplicationHost appHost, System.Web.Hosting.HostingEnvironmentParameters hostingParameters) Unknown
    System.Web.dll!System.Web.Hosting.ApplicationManager.GetAppDomainWithHostingEnvironment(string appId, System.Web.Hosting.IApplicationHost appHost, System.Web.Hosting.HostingEnvironmentParameters hostingParameters)   Unknown
    System.Web.dll!System.Web.Hosting.ApplicationManager.CreateObjectInternal(string appId, System.Type type, System.Web.Hosting.IApplicationHost appHost, bool failIfExists, System.Web.Hosting.HostingEnvironmentParameters hostingParameters)    Unknown
    System.Web.dll!System.Web.Hosting.ProcessHost.StartApplication(string appId, string appPath, out object runtimeInterface)   Unknown 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-20T10:01:35.593

如果*是*病毒扫描程序或搜索索引器等外部进程导致的锁定，则可以尝试使用 Windows 权限锁定其他用户和进程读取文件的权限。默认情况下，该`Temporary ASP.NET Files`目录可供用户、管理员、IIS_USR、SYSTEM 和 TrustedInstaller 使用——也就是说，几乎所有人都可以使用该目录。

试试 MatthewMartin 对不同编译文件夹的建议；

```
<compilation tempDirectory = “C:\LimitedPermissionCompilationDir\” /> 
```

然后将`LimitedPermissionCompilationDir`文件夹限制为仅需要权限的用户和组——例如，如果您在 IIS 上运行，则为 IIS_USR，或者如果您正在为基于文件的 Web 服务器进行编译，则为您自己的帐户。

无论如何，这是一种相对安全的尝试方式，因为您无需担心会影响您正在运行的站点以外的任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-23T11:28:10.340

当我在 web.config 中为另一个用户使用 ipersonation 并且该用户没有权限时，我发现了这一点。哦！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-04T15:26:13.973

由于工作站的防病毒程序在“错误”时间访问文件，我过去也遇到过类似的问题。您可以使用另一个工具来确定打开了哪些文件：[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)（坦率地说，即使它在这里没有用，也推荐用于您的个人武器库）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T19:10:28.827

确保您没有像“Windows 桌面搜索”那样为该文件夹编制索引的进程。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T19:14:40.440

听起来您有一些东西正在持有该文件的打开句柄；[您可以使用Filemon](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)或其他类似工具对其进行跟踪，以查看持有打开句柄的进程。

# java - 调用内置的 java 本地方法

> ID：917453
> 
> 赞同：1
> 
> 时间：2009-05-27T19:02:27.377
> 
> 标签：java, jvm, java-native-interface, native

是否可以调用JVM 内置的native 代码，即java.lang 和java.io 中的各个类调用的代码？换句话说，你能绕过内置的 java API 来访问各种系统级调用，例如文件系统访问吗？我知道我可以通过构建自己的本机代码库并通过 JNI 调用它来做到这一点，但是对于已经内置到 JVM 中的功能不需要额外的本机库会很优雅。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T19:03:22.477

不，你不能。它是故意这样设计的；如果可以的话，你会覆盖 API 合同。

无论如何，标准库包装器代码*非常*少，使用 JIT 编译器您应该不会注意到任何速度影响。

此外，这些方法的*实现*不是 API 规范的一部分。对于 Java 的一种实现来说，“本机”不一定是另一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T19:08:42.620

当然，如果代码是可信的，您可以使用反射来调用方法。但是，非公共 API 很容易在更新和实现之间发生变化，因此几乎毫无意义且绝对不优雅。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-27T19:04:10.040

如果您想要 Native IO，请使用 NIO 类。

# architecture - 在 ntier 应用程序中传递数据

> ID：917457
> 
> 赞同：8
> 
> 时间：2009-05-27T19:03:03.147
> 
> 标签：architecture, domain-driven-design, n-tier-architecture, layered

如何将数据传递到 n 层应用程序中的层？我已经制定了 3 种不同的方法。

***A)*** 通用 .net 对象通用数据表、哈希表、通用数据集、字符串、整数等......然后使用数据集填充发送到 UI 层的业务对象。

[替代文字 http://img11.imageshack.us/img11/460/generic.png](http://img11.imageshack.us/img11/460/generic.png)

[http://dabbleboard.com/draw?b=eiu165&i=26&c=54eef6f1ac01f03c85919518f4a24e798e57e133](http://dabbleboard.com/draw?b=eiu165&i=26&c=54eef6f1ac01f03c85919518f4a24e798e57e133)

*Pro-*不需要额外的层 *Con-*必须使用业务层中的通用数据集和表

***B）*** 使用其他层将引用的实体层。该层将包含强类型数据集或普通旧 C 对象。这些对象将主要是容器数据和很少的逻辑。这些将是发送到 UI 层的相同对象。

[替代文字 http://img8.imageshack.us/img8/6454/entities.png](http://img8.imageshack.us/img8/6454/entities.png)

[http://dabbleboard.com/draw?b=eiu165&i=6&c=d0c2b346894a96b12bd3867f630e474a2af098fa](http://dabbleboard.com/draw?b=eiu165&i=6&c=d0c2b346894a96b12bd3867f630e474a2af098fa)

*Pro-*在所有层中使用相同的类 将对 *entity.dll*的引用添加到所有层

***C)*** 使用数据访问层中定义的数据传输对象（仅限容器对象）。然后使用这些对象填充发送到 UI 层的业务对象。

[替代文字 http://img43.imageshack.us/img43/1236/transferp.png](http://img43.imageshack.us/img43/1236/transferp.png)

[http://dabbleboard.com/draw?b=eiu165&i=27&c=f886efa3f9d5eb4b45ddb02361c79cdcdaec0a9b](http://dabbleboard.com/draw?b=eiu165&i=27&c=f886efa3f9d5eb4b45ddb02361c79cdcdaec0a9b)

*Pro-*业务层不必使用通用类 *-*使用两种类型的对象，您必须将业务对象与传输对象结合起来

我们在工作中进行了讨论，想看看社区的想法。我还添加了一个指向 dabbleboard 的链接。请复制和创建而不是编辑。
谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:16:35.553

如果您使用的是*分层*方法，这意味着所有层（基本上）都在同一进程空间中执行，因此没有编组/序列化，我会选择方法 B。为您的实体创建一个单独的模块，所有方面都基于该模块您的程序取决于，并且耦合到那。

但是，如果您使用标题所暗示的*分层*方法，这意味着跨越了进程和/或网络边界，我建议您使用方法 C。您并没有真正传递实例，您重新传递副本，因此耦合到同一个对象的任何好处，例如 MVC 方法的可观察选项，无论如何都会丢失。在每个层级定义数据 API 比尝试使用相同的类更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:11:37.560

好问题 - 与往常一样，答案必须是“视情况而定”。

关于应用程序的类型，以及是否真的需要拥有业务对象（实体），而不是传输对象（即更多对应于数据库实体的简化业务对象）。

传统上，我会认为您总是需要通用数据集（或数据表），纯粹是出于性能原因。每当需要处理、显示或操作更大的集合时，实例化大量业务对象的传统严格 OO 方法就会失败。

然而，自从我开始使用 Linq to SQL 以来，我的范式发生了变化。不再需要这个，因为 Linq 模型可以是一切——业务对象、传输对象和通用数据集。我还没有探索这在真正的大型应用程序中的效果如何，以及是否需要将前端代码与 Linq 模型隔离开来。我曾与同事讨论过这个问题，但无论哪种方式都没有真正找到答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T19:08:09.923

我喜欢选项 C，但它也让我暂停，原因有两个：

1.  我必须在太多地方传播有关属性的知识。
2.  DTO 必须是可序列化的，这并不可怕，但仍然是一个考虑因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T19:10:39.760

我假设所有 3 层都存在于同一个应用程序中。在 java 中，我至少使用 Hibernate 进行数据访问，并在所有层中使用了这些数据 bean。（选项 B）能够在图层中重用实体是有意义的。

# .net - VB.NET：有没有办法减少将大量文本行加载到列表框的延迟？

> ID：917461
> 
> 赞同：0
> 
> 时间：2009-05-27T19:03:37.047
> 
> 标签：.net, vb.net, winforms, listbox

我正在使用 file.readalllines 将文件读入字符串，然后使用 listbox.items.addrange 并通过 vbcrlf 拆分来插入项目。有没有办法减少它导致加载大量列表的延迟？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:10:56.000

鉴于该文件大到足以通过原子读取它而导致不响应，看来您应该在单独的线程中进行读取。

线程池项目应该在这里完成工作。尝试这个：

```
ThreadPool.QueueUserWorkItem((state) =>
     using(var streamReader = new StreamReader("foo.txt"))
     {
         string line;
         while ((line = streamReader.ReadLine()) != null)
             listBox.Invoke(() => listBox.Items.Add(line));
     }) 
```

（我的 VB.NET 有点生疏，所以如果有人可以转换它，那会很有帮助。）

但是，您必须调用`Invoke`跨线程边界来更新 GUI 的事实将意味着您的性能实际上会*下降*，尽管至少您会得到 UI 的正常响应！

另一个明显的选择是使用[`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)，它旨在在 UI 应用程序的后台执行长时间的任务。但是，我不确定它在这种情况下是否提供任何优势，并且一个简单的线程池项会明显更简单，并允许您内联执行所有操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:09:01.123

使用 BeginUpdate 和 EndUpdate 方法；这将暂时禁用列表框的重绘，并可以加快填充它的过程。

```
ListBox1.BeginUpdate()
' fill the list using Items.Add or Items.AddRange '
ListBox1.EndUpdate() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:11:07.873

您可以尝试使用另一个线程填充列表框。这将避免“挂起”，让用户与另一个表单控件进行交互。您还可以部分加载项目，而不是一次加载所有数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T19:12:14.080

使用 BackgroundWorker 并在单独的线程中加载文件。小心将行从线程添加到 ListBox。您需要从正确的线程发布项目。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T19:18:41.227

> file.readalllines 将文件读入字符串

不！File.ReadAllLines 读入一个字符串*数组*。

> 由 vbcrlf 分割

所以这已经为你完成了：你正在做一堆额外的工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-10T15:10:06.063

Although you may want to read the data into an array of strings in another thread, I would suggest that populating the ListBox should probably be a single action on the UI thread. If the number of items is so large that the delay merely for populating the ListBox with an AddRange would be unacceptable, it would seem unlikely that users would be able to usefully interact with the control in the first place.

# sql - 如何按期间间隔选择/排序日期？

> ID：917469
> 
> 赞同：1
> 
> 时间：2009-05-27T19:06:13.157
> 
> 标签：sql, time, intervals

例如：

如果我们在表中有如下记录：

```
25/06/2009
28/12/2009
19/02/2010
16/04/2011
20/05/2012 
```

我想根据从当前日期开始的 6 个月间隔拆分/选择此日期。结果应该是：从现在开始 0-6 个月：第一次记录 从现在开始 7-12 个月：第二次记录...

如果你把它变得简单，那将非常感激，因为我让它变得非常愚蠢和复杂，比如：

```
declare variable like t1=curdate()+6 
t2=curdate()+12 
```

...

然后选择记录以适合 curdate() 和 t1，然后是 t1 和 t2 等。

谢谢，

河。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T19:25:11.777

更正：如果它倒退，需要使用模数，而不是整数除法 - 抱歉......

如果 MonthCount 是一个计算值，它计算自特定 12 月 31 日以来的月数，并且 mod 是模除法（输出除法后的余数）

```
Select [Column list here] 
From Table
Group By Case When MonthCount Mod 12 < 6 
         Then 0 Else 1 End 
```

例如，在 SQL Server 中，您可以使用 DateDiff 函数

```
Select [Column list here] 
From Table
Group By Case When DateDiff(month, myDateColumn, curdate) % 12 < 6 
         Then 0 Else 1 End 
```

（在 SQL Server 中，百分号是取模运算符）

这会将所有记录分组到每个包含六个月数据的存储桶中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T19:40:30.030

不完全是你想要完成的，但你可以使用 DATEDIFF 函数来区分每条记录的范围：

```
SELECT t.MonthGroup, SUM(t.Counter) AS TotalCount
FROM (    
      SELECT Counter, (DATEDIFF(m, GETDATE(), Date) / 6) AS MonthGroup
      FROM Table
     ) t
GROUP BY t.MonthGroup 
```

这将使用表达您想要的日期范围组的表达式创建一个子查询。然后它将按此日期范围组对子查询进行分组，然后您可以对结果做任何您想做的事情。

编辑：我根据您的示例修改了示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T00:49:28.487

如果您使用的是 SQL Server：

```
SELECT *,
    (
        FLOOR
        (
            (
                DATEDIFF(month, GETDATE(), date_column)
                - CASE WHEN DAY(GETDATE()) > DAY(date_column) THEN 1 ELSE 0 END
            ) / 6.0
        ) * 6
    ) AS SixMonthlyInterval
FROM your_table 
```

如果您使用的是 MySQL：

```
SELECT *,
    (
        FLOOR
        (
            (
                ((YEAR(date_column) - YEAR(CURDATE())) * 12)
                + MONTH(date_column) - MONTH(CURDATE())
                - CASE WHEN DAY(CURDATE()) > DAY(date_column) THEN 1 ELSE 0 END
            ) / 6.0
        ) * 6
    ) AS SixMonthlyInterval
FROM your_table 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T19:28:55.513

```
SELECT (DATEDIFF(MONTH, thedate, GETDATE()) / 6) AS semester,
       SUM(receipt)
FROM thetable
GROUP BY semester
ORDER BY semester 
```

关键思想是按为您提供“学期”的表达式进行分组和排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T19:29:00.147

这个问题真的让我很困惑，因为我实际上无法想出一个简单的解决方案。该死。

我能做到的最好的就是对以下内容进行绝对的混蛋，您可以在其中创建一个临时表，将“期间”插入其中，重新加入您的原始表，然后将其分组。

假设您的内容表具有以下内容

```
ID int
Date DateTime
Counter int 
```

你试图`counter`在六个月的时间内总结所有的

```
DECLARE @min_date datetime
select @min_date = min(date) from test

DECLARE @max_date datetime
select @max_date = max(date) from test

DECLARE @today_a datetime
DECLARE @today_b datetime
set @today_a = getdate()
set @today_b = getdate()

CREATE TABLE #temp (startdate DateTime, enddate DateTime)

WHILE @today_a > @min_date
BEGIN
    INSERT INTO #temp (startDate, endDate) VALUES (dateadd(month, -6, @today_a), @today_a)
    SET @today_a = dateadd(month, -6, @today_a)
END
WHILE @today_b < @max_date
BEGIN
    INSERT INTO #temp (startDate, endDate) VALUES (@today_b, dateadd(month, 6, @today_b))
    SET @today_b = dateadd(month, 6, @today_b)
END

SELECT * FROM #temp

SELECT 
    sum(counter), 
    'Between ' + Convert(nvarchar(10), startdate, 121) + ' => ' +  Convert(nvarchar(10), enddate, 121) as Period
FROM test t
    JOIN #Temp ht
        ON t.Date between ht.startDate AND ht.EndDate
GROUP BY 
    'Between ' + Convert(nvarchar(10), startdate, 121) + ' => ' +  Convert(nvarchar(10), enddate, 121)

DROP TABLE #temp 
```

我真的希望有人能想出一个更好的解决方案，我的大脑显然已经融化了。

# c# - 使用 safari、chrome 创建 cookie 失败，即使用 FF

> ID：917475
> 
> 赞同：3
> 
> 时间：2009-05-27T19:07:35.320
> 
> 标签：c#, cookies, cross-browser

我们正在使用以下代码来创建安全 cookie。在暂存环境中一切正常，但是在生产环境中，以下代码无法在 Safari、Chrome 或 IE 中创建 cookie，但它确实在 Firefox 中成功创建了 cookie。你们认为我在这里遗漏或有什么问题吗？

```
public static void SetAuthenticationCookie(CustomIdentity identity)
        {
            ConfigSettings configSettings = ConfigHelper.GetConfigSettings();

            string cookieName = configSettings.CookieName;
            if (cookieName == null || cookieName.Trim() == String.Empty)
            {
                throw new Exception("CookieName entry not found in Web.config");
            }

            string cookieExpr = configSettings.CookieExpiration.ToString();

            string encryptedUserDetails = Encrypt(identity);

            HttpCookie userCookie = new HttpCookie(cookieName.ToUpper());
            if (cookieExpr != null && cookieExpr.Trim() != String.Empty)
            {
                userCookie.Expires = DateTime.Now.AddMinutes(int.Parse(cookieExpr));
            }
            userCookie.Values["UserDetails"] = encryptedUserDetails;
            userCookie.Values["Culture"] = configSettings.Customer.Culture;

            MyContext.Current.Response.Cookies.Add(userCookie);
        } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-03-09T15:14:27.580

Safari 和 IE8 默认不接受第三方 cookie。

当您使用 JSONP 调用另一个域时，该脚本设置的每个 cookie 都将被 Safari 和 IE8 阻止。对此您无能为力（在 IE8 中，您可以添加 P3P 策略，但这在 Safari 中不起作用）。

有跨 JSONP 调用维护状态的解决方法，但它非常复杂（您必须手动管理状态并在被调用的 javascript 中使用 document.cookie）

作为替代方案，您可以要求您的用户降低其浏览器中的隐私设置，但这不值得考虑恕我直言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-12T20:18:10.083

我已经看到这个问题与服务器的 UTC 日期/时间不正确有关。无论服务器日期/时间如何，Firefox 都接受，但如果日期/时间超出一定的误差范围，其他浏览器将不会设置 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T19:10:22.103

您是否检查过您是否有 Web Developer 插件和禁用的 cookie？还是在 FF 中禁用了 cookie？

# java - Determining whether geographic point is within X meters of a state border (using shapefile for border data)

> ID：917484
> 
> 赞同：4
> 
> 时间：2009-05-27T19:08:42.090
> 
> 标签：java, maps, geospatial, geography, geotools

So I'm writing a Java app, and I've got an ESRI Shapefile which contains the borders of all the U.S. states. What I need is to be able to determine whether any given lat/lon point is within a specified distance from ANY state border line - i.e., I will *not* be specifying a particular border line, just need to see whether the point is close to *any* of them.

The solution does NOT have to be very precise at all; e.g. I don't need to be dealing with measuring perpendicular to the border, or whatever. Just checking to see if going X meters north, south, east or west would result in crossing a border would be more than sufficient. The solution DOES have to be computationally efficient, as I'll be performing a huge number of these calculations.

I'm planning to use the GeoTools library (though if there's a simpler option, I'm all for it) with the Shapefile plugin. What I don't really understand is: Once I've got the shapefile loaded into memory, how do I check to see whether I'm near a border?

Thanks! -Dan

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T19:55:24.163

Assuming [JTS](http://www.vividsolutions.com/jts/jtshome.htm) for Geometry which is what is included in GeoTools:

```
public boolean pointIsClose( File file, Point targetPoint,double distance) {

  boolean ret = false;
  Map connect = new HashMap();
  connect.put("url", file.toURL());
  DataStore dataStore = DataStoreFinder.getDataStore(connect);

  FeatureSource featureSource = dataStore.getFeatureSource(typeName);
  FeatureCollection collection = featureSource.getFeatures();
  FeatureIterator iterator = collection.features();

  try {
    while (iterator.hasNext()) {
      Feature feature = iterator.next();
      Geometry sourceGeometry = feature.getDefaultGeometry();
      ret= sourceGeometry.isWithinDistance(targetPoint, distance );
    }
  } finally {
    iterator.close();
  }
  return ret;
} 
```

The double number will have to come from the [CRS](http://docs.codehaus.org/display/GEOTDOC/01+CRS+Helper+Class) which will define the units in which the calculation will be performed.

These are the geotools imports:

```
import org.geotools.data.DataStore;
import org.geotools.data.DataStoreFinder;
import org.geotools.data.FeatureSource;
import org.geotools.feature.Feature;
import org.geotools.feature.FeatureCollection;
import org.geotools.feature.FeatureIterator;
import org.geotools.geometry.jts.JTS;
import org.geotools.referencing.CRS;
import org.opengis.referencing.crs.CoordinateReferenceSystem; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:00:01.863

If you just want to know if point A is within X meters of a state border and X is constant and you don't care which border it is, you can precompute the negative space as a series of boxes. Then all you have to do is a contains check for each of those boxes against the point. If none of them match, you're not in the negative space.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:34:50.120

If you can somehow extract the shape for each state from the shapefile, create an envelope that is x meters on a side (with your point in the exact center) and see if those two shapes intersect, you'll be able to answer the question.

If I was using ESRI's ArcGIS Engine, I'd use an ISpatialFilter with the point defined in the geometry (possibly with a buffer) and query that against the States shapefile. Any result(s) returned would indicate that the point was near a state. I'm unfamiliar with GeoTools and, while browsing through their documentation, I didn't come across anything that looked like that type of functionality, but they must have it. You may want to look for examples of how to use GeoTools to perform spatial queries on shapefiles.

# performance - 在 Delphi 2009 中 sqrt 仍然很慢吗？

> ID：917489
> 
> 赞同：4
> 
> 时间：2009-05-27T19:10:19.577
> 
> 标签：performance, delphi, optimization, delphi-2009

在 Delphi 2009 中 sqrt 仍然很慢吗？

旧技巧（查找表、近似函数）仍然有用吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:35:29.417

如果您正在处理一小组非常大的数字，那么查找表通常会更快。而如果您正在处理大量的小数字，那么即使是一个缓慢的例程也可能比维护一个大表更快。

我查看了 System.pas（**SQRT**所在的位置），虽然有许多块标记为从*Fastcode 项目*获得许可，但**SQRT**不是。事实上，它只是对**FSQRT**进行汇编调用，所以它很可能没有改变。因此，如果它在某一时刻相对较慢，那么它很可能仍然很慢（尽管您的 CPU 现在可能要快得多并为此进行了优化......）

我的建议是看看你的用法和测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T19:14:08.537

许多个月前，我有一个应用程序可以计算距离以对向量进行排序。我意识到按 un-sqrt-ed 值排序是一样的，所以我完全跳过了它。按距离^2 排序并节省了一些时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:14:09.223

我对效率问题的回答是先应用最简单的方法，然后再进行优化。当一个操作一开始就不需要那么快时，让操作变得更快似乎很愚蠢。

但是，我离题了，因为我的回答是关于效率，而不是您问题的历史方面。

# perl - Perl 散列应该总是包含值吗？

> ID：917494
> 
> 赞同：8
> 
> 时间：2009-05-27T19:10:49.887
> 
> 标签：perl, hash

我有一个较早的问题，得到了著名 Perl 专家、Perl 作者和 Perl 培训师 brian d foy的[以下回复：](https://stackoverflow.com/questions/898621/how-do-i-build-perl-regular-expressions-dynamically/910597#910597)

> [如果]您正在寻找每个文件名末尾的固定字符序列。您想知道该固定序列是否在您感兴趣的序列列表中。将所有扩展存储在哈希中并查看该哈希：
> 
> ```
>     我的( $extension ) = $filename =~ m/\.([^.]+)$/;
>     if( 存在 $hash{$extension} ) { ... }
> 
> ```
> 
> 您不需要构建正则表达式，也不需要通过几种可能的正则表达式替换来检查您必须检查的每个扩展。

感谢布赖恩的建议。

我现在想知道的是在上述情况下的最佳实践是什么。是否应该只定义键，这是我实现上述目标所需的全部内容，还是应该始终定义一个值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T20:06:46.077

通常最好为每个键设置一个定义的值。惯用值（当您不关心值时）是 1。

```
my %hash = map { $_ => 1 } @array; 
```

这样做会使使用哈希的代码稍微简单一些，因为您可以将`$hash{key}`其用作布尔值。如果该值可以未定义，则需要使用更详细的值`exists $hash{key}`。

也就是说，在某些情况下，值`undef`是可取的。例如：假设您正在解析 C 头文件以提取预处理器符号。将这些存储在 name => value 对的哈希中是合乎逻辑的。

```
#define FOO 1
#define BAR 
```

在 Perl 中，这将映射到：

```
my %symbols = ( FOO => 1, BAR => undef); 
```

在 C 中 a`#define`定义了一个*符号*，而不是一个*值*——C 中的“定义”映射到 Perl 中的“存在”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-27T19:17:37.860

您无法创建没有值的哈希键。该值可以是 undef，但它会在那里。否则您将如何构造哈希。或者您的问题是关于该值是否可以是 undef？在这种情况下，我会说您存储在那里的值 (undef, 1, 0...) 完全取决于您。如果很多人都在使用它，那么您可能希望存储一些真实值，尽管其他人使用 if ($hash{$extension}) {...} 而不是存在，因为他们没有注意。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T19:23:12.683

`undef` **是**一个值。

当然，这样的事情总是取决于你目前在做什么。但这`$foo{bar}`只是一个变量`$bar`，我看不出任何一个不应该时常出现的原因`undef`。

PS：这就是`exists`存在的原因。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-27T21:44:26.300

正如其他人所说，哈希集（仅包含键，不包含值的哈希）的惯用解决方案是使用 1 作为值，因为这使得存在性测试变得容易。但是，对于`undef`用作值，有一些话要说。它将迫使用户测试是否存在，[`exists`](http://perldoc.perl.org/functions/exists.html)这会稍微快一些。当然，`exists`即使值为 1，您也可以测试是否存在，并避免忘记使用的用户不可避免的错误`exists`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-29T21:55:22.020

使用 undef 作为哈希值比存储 1 更节省内存。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-29T18:31:16.550

## 在被认为有害的集合哈希中存储“1”

我知道使用[**Considered Harmful**被认为是有害的](http://meyerweb.com/eric/comment/chech.html)，但这很糟糕，几乎与无节制的`goto`使用一样糟糕。

好的，我已经在一些评论中强调了这一点，但我认为我需要一个完整的回应来证明这个问题。

假设我们有一个为销售小部件的商店提供后端库存控制的守护进程。

```
my @items = qw(
    widget
    thingy
    whozit
    whatsit
);

my @items_in_stock = qw(
    widget
    thingy
);

my %in_stock;
my @in_stock(@items_in_stock) = (1) x @items_in_stock;  #initialize all keys to 1

sub Process_Request {
    my $request = shift;

    if( $request eq REORDER ) {
        Reorder_Items(\@items, \%in_stock);
    }
    else { 
        Error_Response( ILLEGAL_REQUEST );
    }
}

sub Reorder_Items{
   my $items = shift;
   my $in_stock =  shift;

   # Order items we do not have in-stock.
   for my $item ( @$items ) {

       Reorder_Item( $item ) 
           if not exists $in_stock->{$item};
   }

} 
```

该工具很棒，它会自动保留库存物品。非常好。现在，老板要求自动生成的库存商品目录。所以我们修改`Process_Request()`并添加目录生成。

```
sub Process_Request {
    my $request = shift;

    if( $request eq REORDER ) {
        Reorder_Items(\@items, \%in_stock);
    }
    if( $request eq CATALOG ) {
        Build_Catalog(\@items, \%in_stock);
    }
    else { 
        Error_Response( ILLEGAL_REQUEST );
    }
}

sub Build_Catalog {
    my $items = shift;
    my $in_stock = shift;

    my $catalog_response = '';
    foreach my $item ( @$items ) {
        $catalog_response .= Catalog_Item($item)
            if $in_stock->{$item};
    }

    return $catalog_response;
} 
```

在测试中，`Build_Catalog()`工作正常。万岁，我们开始使用该应用程序。

哎呀。*由于某种原因没有订购任何东西，公司的所有东西都*缺货。

该`Build_Catalog()`例程将键添加到`%in_stock`，因此`Reorder_Items()`现在将所有内容视为库存并且从不下订单。

使用[Hash::Util](http://perldoc.perl.org/Hash/Util.html)`lock_hash`可以帮助防止意外的哈希修改。如果我们`%in_stock`在调用之前锁定，`Build_Catalog()`我们将得到一个致命错误，并且永远不会出现该错误。

总之，最好测试键的存在而不是你的集合哈希值的真实性。如果您使用存在作为指示符，请不要将您的值设置为“1”，因为这会掩盖错误并使它们更难跟踪。使用`lock_hash`可以帮助解决这些问题。

如果您**必须**检查值的真实性，请在***每种***情况下都这样做。

# security - 如何在 iframe 中保持会话？

> ID：917500
> 
> 赞同：4
> 
> 时间：2009-05-27T19:11:15.830
> 
> 标签：security, session, browser, iframe, cookies

假设我有一个网络应用程序，我想使用 iframe 嵌入到任何其他站点中。iframe 引用我的网站并独立于托管网页运行。

好吧，浏览器将 iframe 视为第三方站点，因此其会话 cookie 被视为第三方 cookie。存在一些使浏览器满意的方法（例如 P3P 标头），但用户仍有可能完全禁用第三方 cookie。如果是这样，那么会话 cookie 不能在 iframe 中保留。

在第三方网站的 iframe 中保持会话的好方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-04T11:30:13.840

我在这里遇到了类似的问题。有一种解决方法（如果您的意图是跟踪跨站点的用户行为，则将不起作用）。

一世。在要托管 iframe 的域上放置第一方持久性 cookie。（这可以使用 JavaScript 来完成）。

ii. 动态注入 iframe 并将 cookie 的值传递给您的站点。

iii. 如果您打算跨站点跟踪用户行为，请修改上述代码，以便在浏览器允许时使用第三方 cookie，否则切换您使用上述方法。

我还没有遇到任何其他方法来解决这个问题。如果您找到更可接受的解决方案，请告诉我。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-04T12:10:49.297

我的意图是跟踪 iframe 中的会话，以便点击和重新加载保持状态。没有必要在 iframe 和托管站点之间链接会话。

我能想到的最好的方法是无 cookie 会话。这有点手动，但这个站点运行 PHP，我只需要确保查询字符串始终包含“ `PHPSESSID=x`”，它会自动附加到该会话 ID。

# c# - ASP.net 日历控件的任何免费替代品？

> ID：917512
> 
> 赞同：3
> 
> 时间：2009-05-27T19:12:07.310
> 
> 标签：c#, .net, asp.net, calendar

以下是我在工厂控制时遇到的问题：

*   没有简单的方法来获得第一个可见日期（是的，我可以使用日渲染，但在页面周期的那个时候，我无法做我需要做的事情，即在视图状态中操作集合）
*   在我的代码中更改 visibledate 属性不会引发 visiblemonthchanged 事件。这对我来说没有任何意义。

有人可以建议一个免费的、改进的日历控件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:16:23.870

**jQuery** [日期选择器](http://docs.jquery.com/UI/Datepicker)：

例子：

```
<input id='datepicker' class='datepicker' />

$(function(){
$(".datepicker").datepicker({ 
                          buttonImage: "/Content/img/calendar.gif", 
                          buttonImageOnly: true });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:29:03.437

问候，

[您可以从http://www.eworldui.net](http://www.eworldui.net/)尝试使用日历控件。我使用它们没有任何问题，它们可以免费使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-16T02:38:13.473

使用[BaseCalendar](http://basecalendar.codeplex.com/)，您可以调用 FirstVisibleDay 来获取实际的第一个渲染日期。但是，BaseCalendar 的工作方式与内置日历不同。它使您可以完全控制 HTML，但不像内置的那样依赖/使用 PostBacks。

# flash - 通过 ProgressEvent 更新标签上的字节数

> ID：917518
> 
> 赞同：0
> 
> 时间：2009-05-27T19:13:15.310
> 
> 标签：flash, actionscript-3, flex3, flexbuilder

我有 main.mxml 和一个外部类 com.audio.AudioPlayer.as

AudioPlayer 加载一个音频文件并有一个用于计算 bytesLoaded 和 bytesTotal 的事件。

我想连续推送 bytesLoaded 信息，因为它从 ProgressEvent.PROGRESS 加载到 main.mxml 上的标签中

```
snd.addEventListener(ProgressEvent.PROGRESS, listenProgress);

    private function listenProgress(event:ProgressEvent):void
    {
        progressID.text = event.bytesLoaded + " / " + event.bytesTotal;
    } 
```

我找不到从 AudioPlayer 内部定位 main.mxml 中的标签控件并不断更新字节数的方法。

任何帮助，非常感谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T19:56:37.720

在 AudioPlayer 中创建一个可绑定变量，并在事件处理程序中将其设置为正确的值。

在您的 mxml 中，将标签的文本绑定到该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T19:05:53.487

好的，我想出了一个解决方法。在 AudioPlayer.as 我声明：

```
public var snd:Sound = new Sound(); 
```

在 main.mxml 中，我为 snd 添加了事件监听器：

```
newAudio.snd.addEventListener(Event.COMPLETE, onSoundComplete);
newAudio.snd.addEventListener(ProgressEvent.PROGRESS, listenProgress); 
```

...这样做我可以通过声明更新我的 mxml 控件：

```
[Bindable] private var progUpdate:String;

<mx:Label text="{progUpdate}" x="254.75" y="46" width="506.5" /> 
```

所以基本上我只是将 eventListeners 从 AudioPlayer 类移到了文档类中。

# ruby-on-rails - 如何包装所有 ActiveRecord 属性访问器

> ID：917526
> 
> 赞同：2
> 
> 时间：2009-05-27T19:14:50.267
> 
> 标签：ruby-on-rails, activerecord

我有一个模型，其中属性允许为空，但是当读取空属性时，我想采取特殊措施。特别是，我想抛出一个异常。也就是说，像

```
class MyModel < ActiveRecord::Base
  def anAttr
      read_attribute(:anAttr) or raise MyException(:anAttr)
  end
end 
```

没关系，但这意味着我必须为每个属性手动编码相同的自定义访问器。

我以为我可以重写 read_attribute，但我重写的 read_attribute 永远不会被调用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T20:46:57.133

不知道为什么你需要这样做，但唉：

```
def get(attr)
  val = self.send(attr)
  raise MyException unless val
  val
end

@object.get(:name) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T02:34:35.213

这很有趣，我们今天也在研究同样的事情。检查`attribute_method.rb`属性的所有 Rails 逻辑所在的位置。您将看到一个`define_attribute_methods`您应该能够覆盖的方法。

最后，我认为我们将以不同的方式来做这件事，但这是一个有用的练习。

# jquery - 使用 jQuery 更改 Enter 键？

> ID：917527
> 
> 赞同：0
> 
> 时间：2009-05-27T19:15:13.137
> 
> 标签：jquery

我在一个页面上使用多个框架集，每个框架集都有一个关联的按钮来执行服务器/客户端回发。我想更改默认的回车键以选择正确的按钮，这是我使用 jQuery 的解决方案。

```
 $("#<%= SearchCustomers.ClientID %>").find(":input").click(function() { $(this).parents("FIELDSET").addClass("default"); }).blur(function() { $(this).parents("FIELDSET").removeClass("default"); });
    $("#<%= SearchGroups.ClientID %>").find(":input").click(function() { $(this).parents("FIELDSET").addClass("default"); }).blur(function() { $(this).parents("FIELDSET").removeClass("default"); });

    $(document).keypress(function(e) {
        if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
            $(".default").find(":submit,:button").click();
            return false;
        }
    }); 
```

这是完美的，但我正在寻找改进它的方法。现在，代码依赖于我将框架集设置为“runat=server”，这样我就可以访问“ClientID”属性并将 ID 注入到我的 javascript 中。这使得代码的可重用性降低了一点，所以我很好奇其他人是否有更好的主意......

感谢您的意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T19:23:45.443

由于您的前两行非常相似，因此我将其简化为：

```
$('FIELDSET').find(":input").click(function() {
  $(this).parents("FIELDSET").addClass("default"); }).blur(function() {
  $(this).parents("FIELDSET").removeClass("default"); }); 
```

如果页面上除了您关心的两个框架集之外没有任何其他框架集，那应该没问题。那么您不需要拥有 ClientID。

如果您不能保证页面上只有这两个，那么我认为您确实需要 runat=server 和 ClientID - 因为您实际上确实需要唯一标识这两个特定的框架集

编辑：或者，您可以使用特定类标记您希望展示此行为的字段集：

```
<fieldset class='UseAutoEnterKey'> .... 
```

然后，您可以使用类选择器将行为全部添加到一起：

```
$('FIELDSET.UseAutoEnterKey').find(......... 
```

# networking - 当我只知道远程系统的 IP 地址时，如何获取远程系统的 MAC 地址？

> ID：917532
> 
> 赞同：4
> 
> 时间：2009-05-27T19:16:13.260
> 
> 标签：networking, wake-on-lan

我正在开发 LAN 唤醒服务，该服务将从网站运行并且应该与许多不同的平台进行交互 - 因此，没有仅限 Windows 的解决方案。当用户在网站上注册他们的系统时，我需要获取 MAC 地址以用于构建[“魔术”数据包](http://en.wikipedia.org/wiki/Wake_on_lan#Magic_Packet)。我有一个能够为我执行此操作的 Java Applet，并且我知道 ActiveX 控件可以工作，但我想知道是否有办法通过查询路由器/交换机来执行此服务器端。由于系统可能位于许多不同的物理子网中的任何一个上，因此使用 ARP 将不起作用——除非有办法配置路由器以代表我执行 ARP。

任何人都知道任何网络 API，专有的或其他的，可用于查找给定 IP 地址的 MAC 地址？我认为我们正在使用 Cisco 路由器，但它是一个复杂的网络，并且可能涉及多个不同级别的供应商。在我去祭祀网络之神之前，我想了解一些可能的解决方案的背景信息。如果技术上不可行，那么自卑是没有意义的。:-)

**编辑：**我们确实设置了网络基础设施以允许定向广播，但由于网络掩码并不总是 /24 而找出确切的广播地址是我需要解决的另一个难题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:22:40.190

如果您在使用 DHCP 的本地网络上，您可能能够查看服务器数据库以获取具有该地址的最后一个用户的 MAC。将来，您可以监视网络中的 ARP 请求并将响应缓存在某种表中。您还可以考虑使用 RMON 或 SNMP 来尝试查询交换机和路由器上的地址表。

应该注意的是，要跨路由器使用 WoL，您要么需要启用定向广播，要么需要在本地网段中有中继服务器。

自从我玩路由器和交换机以来已经有一段时间了，但这可能是使用 SNMP 查询的起点[http://www.cisco.com/en/US/tech/tk648/tk362/technologies_tech_note09186a00801c9199.shtml](http://www.cisco.com/en/US/tech/tk648/tk362/technologies_tech_note09186a00801c9199.shtml)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-01-05T06:31:49.727

使用以下内容：

```
getmac /s destIp 
```

获取远程会话 Mac 地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:28:37.230

我不知道这些是否有帮助，但请看一下：

[http://www.webdeveloper.com/forum/showthread.php?t=134120](http://www.webdeveloper.com/forum/showthread.php?t=134120)

[http://www.qualitycodes.com/tutorial.php?articleid=19](http://www.qualitycodes.com/tutorial.php?articleid=19)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T19:34:06.733

你把我能想到的都说了...

源 MAC 地址随着数据包从设备跳到设备而变化，因此除非客户端位于同一子网中，否则服务器将无法获取 MAC 地址。（你会通过 ARP 来做）

签名的 java 小程序或 activex 控件将是最简单的解决方案。它将能够（几乎被动地）获取您需要的所有网络信息（IE 甚至不会提示运行签名的小程序）

如果您完全了解正在使用该服务的网络，那么您可能可以通过 SNMP 或 CDP 查询网关的客户端列表。您将能够将 IP 地址映射到 MAC 地址......但这确实取决于供应商（但很常见），并且不会比拥有一个小程序更好（imo）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-23T12:59:37.240

目前，该应用程序正在使用 Java 6 小程序，它允许我从远程系统中提取主机名和 MAC 地址。我不喜欢这种对 Java 6 的依赖，但是 Snow Leopard 和 Windows 都支持它，所以我可能可以忍受它。

在相关方面，我们的网络人员向我寻求一些帮助，将一些现有代码转换为 ASP.NET。在谈话中，我问他们是否有实时的 MAC 地址信息（因为他们会根据可疑的网络活动——病毒/蠕虫关闭端口）。事实证明他们这样做了，我们也许可以利用这个项目来访问网络数据库中的信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T19:22:49.643

我认为没有任何方法可以做到这一点。当 IP 数据包通过第一个路由器时，主机的 MAC 信息会丢失（您知道 MAC 仅用于以太网层）。如果最靠近您 PC 的路由器能够将远程 MAC 代码告诉您，那么它只会看到您的 PC 和“另一端”之间的下一个路由器的 MAC。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T19:23:03.497

开始牺牲。

除非您不涉及路由器，否则在网络方面没有通用的方法可以做到这一点。如果涉及路由器，您将永远不会看到原始系统的 MAC 地址。

这假设始发系统只有一个网络接口，因此只有一个 MAC 地址。

事实上，您是否确定您的“魔术包”（无论是什么）会通过路由器到达您希望它到达的系统？这听起来像是路由器或其他网络基础设施应该执行的功能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T19:29:48.240

Mac地址只用在网段上，每跳都会丢失。仅保留 IP 用于端到端 - 即使这样，在 Natted 时也会重写来自 IP 地址。我想我的答案是，除非一切都在同一个网段上，或者您的路由器设置为代理 arp（这不太现实），否则这是不可能的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-27T20:05:03.177

您只能在同一网络上的机器的 ARP 表中获取 MAC 条目。如果您通过路由器连接到机器，那么您将只能在 ARP 表中看到路由器的 MAC 地址。因此，除非它是同一网络上的主机（不涉及路由器），否则无法知道*外部主机的 MAC 地址。*

顺便说一句，SO上已经有很多[类似的问题。](https://stackoverflow.com/search?q=mac+address)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-28T00:40:49.313

如果是 Windows 系统，您可以使用 NBTSTAT -A 这将返回 netbios 信息并且 IP 在那里

任何管理系统（如 SMS 或 Altiris）都会有此信息

DHCP 服务器是个好主意

如果它是本地的，您可以 ping 它然后快速运行 ARP - 查找 IP 并且 MAC 将在那里。您可能需要编写一个小批处理文件。

如果您有权访问 PC，则可以使用 WMI 通过 DHCP 访问 Nic 的信息。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-07-01T17:49:12.723

如上所述，如果该主机位于同一子网中，我们可以从已知 IP 地址获取 MAC 地址。首先ping那个ip；然后看看 arp -a | grep 并解析 nix* 上的字符串以获取 mac 地址。

我们可以从所有编程语言标准 API 发出系统命令，并可以解析输出以获取 mac 地址。Java api 可以 ping 一个 IP，但我不确定我们是否解析 ping 输出（某些库可以做到）。最好避免发出系统命令并找到替代解决方案，因为它不是真正的平台独立方式。

礼貌：[萨利姆·巴蒂教授](http://www.cs.st-andrews.ac.uk/~saleem/)

# html - 应该在主页中嵌入视频减慢页面速度吗？

> ID：917535
> 
> 赞同：1
> 
> 时间：2009-05-27T19:17:11.700
> 
> 标签：html, performance, video

如果我在我的主页中嵌入一个演示我的应用程序的视频，它会大大降低页面速度吗？

我试过，并检查它需要将近 1 秒，加载视频的预览。并且由于视频流不会被下载，直到视频被点击，整个视频不必被下载。

是否建议在首页嵌入视频？或者我应该把它放在不同的页面上，然后在主页上放一个链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T19:23:45.180

如果您要嵌入 Flash flv 视频，那么可以，它可能会减慢页面加载速度。这是因为页面需要加载 flash 插件才能获取内容大小等并渲染初始帧等。

但这并不意味着这是一件坏事。这不会是一个极端的减速（闪存现在已经非常优化），所以除非你试图在页面加载时勉强获得每一个性能的渣滓，否则评估它的外观而不是性能：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T04:33:45.453

这里有一种方法可以让你吃蛋糕也可以吃：

不要将 Flash 播放器放在默认加载的页面上......

放入一个看起来像玩家的图像（它应该更轻）。

如果/当您的用户点击播放器图像时，加载 Flash 播放器并播放。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:43:57.590

您添加到页面的每个对象都会减慢页面的加载时间。一般来说，如果加载时间不值得拥有该项目的额外好处，则不要包含任何内容。

话虽如此，您可以通过一些技巧来优化页面，以便页面呈现然后加载 Flash 视频。您可以预先生成 Flash 播放器/视频的缩略图并将其放在页面上与视频相同的位置，然后在页面加载时使用 javascript ( `jquery: $(document).ready()`) 创建 Flash 对象。这可以改善感知性能。更好的是，您可以推迟加载视频，直到用户单击按钮或其他内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T21:11:24.917

您嵌入的所有内容都会减慢页面的初始加载速度。

您有多种选择：(A) 以原始格式（mpeg、avi 等）嵌入视频或 (B) 将其转换为 Flash。flash 的一个好处是它接近通用且高度优化，因此加载 flash 插件需要很少的时间。

页面加载完成不需要加载整个视频（仅播放器），所以如果我们只讨论 1 个视频，将其嵌入页面中以提供更好的用户体验是有意义的。

看看Shiny先生和New先生的观点。它们也是有效的。

# c# - 用于 64 位 C# 开发的 CodeSite 替代方案

> ID：917544
> 
> 赞同：2
> 
> 时间：2009-05-27T19:20:52.487
> 
> 标签：c#, visual-studio, 64-bit, codesite

我已经使用[Raize CodeSite](http://www.raize.com/DevTools/CodeSite/Default.asp)多年了——首先是在 Delphi 中，现在是在 Visual Studio 中。我最近将我的开发机器升级到了 64 位操作系统。令我惊喜的是，一切都刚刚出现并正常工作 - 直到我尝试在针对“任何 CPU”的 C# 应用程序中使用 CodeSite。原来 64 位应用程序存在一个已知问题。

尽管我很喜欢 CodeSite，但我需要继续前进，但我真的越来越依赖这种类型的工具。

谁能建议 CodeSite 的替代方案？

——布鲁斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-04T21:46:11.163

为了深入了解正在执行的代码，您可能需要考虑的一些事项包括：

[Profile Sharp](http://www.softprodigy.net/products)（开源） [dotTrace](http://www.jetbrains.com/profiler/)（商业） [http://www.eqatec.com/tools/profiler](http://EQATEC)（免费）

# eclipse - 自定义eclipse任务栏

> ID：917545
> 
> 赞同：2
> 
> 时间：2009-05-27T19:20:53.063
> 
> 标签：eclipse, keyboard-shortcuts

我使用了很多 Eclipse 快捷方式，但对于某些任务，没有任何方便的快捷方式。例如，我经常查看 java 文件的颠覆历史。

我在右键单击菜单项旁边看到这些图标，我认为我应该能够将其放置在 Eclipse 任务栏上，这样我就可以节省几次鼠标点击。但我还没有弄清楚如何做到这一点。

安装 subclipse 插件后，我说的是 RightClick-Team-Show History 旁边的图标。我希望这个图标出现在我的任务栏上，这样我只需单击一下即可查看历史记录。

有什么建议么？

也欢迎其他有关为 java 开发定制 eclipse 的技巧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T19:32:33.213

看看我对类似问题的回答：[如何在 Eclipse 中向工具栏添加撤消/重做按钮？](https://stackoverflow.com/questions/819846/how-to-add-undo-redo-buttons-to-toolbar-in-eclipse)

可以对 Show History 命令执行相同的操作。区别在于：1）您需要声明对`org.tigris.subversion.subclipse.ui`插件的依赖，并且您要查找的命令ID是`org.tigris.subversion.subclipse.ui.showresourceinhistoryaction`. 您可能希望包含自定义图标以避免工具栏上的“显示历史记录”按钮过长。

**更新：**这是可下载的插件：[showsvnhistory_1.0.0.jar](http://www.foglyn.com/misc/showsvnhistory_1.0.0.jar)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:28:46.200

我知道“自定义”Eclipse 任务栏的唯一方法是通过 Window -> Customize Perspective。奇怪的是，“命令”选项卡对工具栏有一些影响。

但是，您要使用的任何组件的开发人员都必须启用该命令，并且（至少对我而言），SVN 不提供历史按钮。

也许一些 XML hacking 在这里更有帮助？

# http - 有人使用 YAWS 服务器作为 HTTP 代理吗？

> ID：917546
> 
> 赞同：3
> 
> 时间：2009-05-27T19:21:01.723
> 
> 标签：http, proxy, erlang, yaws

我打算将 YAWS 网络服务器设置为 HTTP 代理服务器。我基本上是在尝试实现一个高吞吐量的 HTTP 代理服务器，它应该能够承受网络规模的负载。

要求是能够将某些 URI 重定向到我们公司的企业门户。

有人在生产中使用过这个设置吗？有人知道预定要求有什么问题吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:22:10.430

Yaws 反向代理的东西是相当实验性的，如果你只需要它，我不会使用它。相反，我会看清漆甚至鱿鱼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T21:22:36.220

YAWS 是一个很好的应用程序服务器，但仅此而已，用于提供静态文件或代理它远非理想。我们在 Yaws 前面使用 haproxy 和 lighttpd 以获得更好的性能。

# c# - 没有返回类型的函数委托

> ID：917551
> 
> 赞同：637
> 
> 时间：2009-05-27T19:21:42.033
> 
> 标签：c#, .net

所有 Func 委托都返回一个值。可以与返回 void 的方法一起使用的 .NET 委托是什么？

* * *

## 回答 #1

> 赞同：851
> 
> 时间：2009-05-27T19:24:54.337

所有 Func 代表都返回一些东西；所有的 Action 代表都返回 void。

`Func<TResult>`不接受任何参数并返回 TResult：

```
public delegate TResult Func<TResult>() 
```

`Action<T>`接受一个参数并且不返回值：

```
public delegate void Action<T>(T obj) 
```

`Action`是最简单的“裸”代表：

```
public delegate void Action() 
```

还有`Func<TArg1, TResult>`and `Action<TArg1, TArg2>`（以及其他最多 16 个参数）。所有这些（除了`Action<T>`）都是 .NET 3.5 的新内容（在 System.Core 中定义）。

* * *

## 回答 #2

> 赞同：95
> 
> 时间：2009-05-27T19:23:10.330

> ... 不带参数并且返回类型为 void？

我相信`Action`这是一个解决方案。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2009-05-27T19:23:57.177

> 所有的 Func 委托都至少有一个参数

这不是真的。它们都至少采用一个类型参数，但该参数决定了返回类型。

所以`Func<T>`不接受任何参数并返回一个值。当您不想返回值时使用`Action`或。`Action<T>`

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-05-27T19:22:47.023

尝试`System.Func<T>`并`System.Action`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-01-25T17:06:26.943

调用返回和非返回值子例程的一种非常简单的方法。分别使用**Func**和**Action**。*（另见[https://msdn.microsoft.com/en-us/library/018hxwa8(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/018hxwa8(v=vs.110).aspx)）*

试试这个例子

```
using System;

public class Program
{
    private Func<string,string> FunctionPTR = null;  
    private Func<string,string, string> FunctionPTR1 = null;  
    private Action<object> ProcedurePTR = null; 

    private string Display(string message)  
    {  
        Console.WriteLine(message);  
        return null;  
    }  

    private string Display(string message1,string message2)  
    {  
        Console.WriteLine(message1);  
        Console.WriteLine(message2);  
        return null;  
    }  

    public void ObjectProcess(object param)
    {
        if (param == null)
        {
            throw new ArgumentNullException("Parameter is null or missing");
        }
        else 
        {
            Console.WriteLine("Object is valid");
        }
    }

    public void Main(string[] args)  
    {  
        FunctionPTR = Display;  
        FunctionPTR1= Display;  
        ProcedurePTR = ObjectProcess;
        FunctionPTR("Welcome to function pointer sample.");  
        FunctionPTR1("Welcome","This is function pointer sample");   
        ProcedurePTR(new object());
    }  
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-19T18:04:07.807

有时您会想要为事件处理编写一个委托，在这种情况下，您可以利用[`System.EvenHandler<T>`](https://msdn.microsoft.com/en-us/library/system.eventhandler(v=vs.110).aspx)它隐式接受一个类型`object`的参数，以及应该派生自的第二个参数[`EventArgs`](https://msdn.microsoft.com/en-us/library/system.eventargs(v=vs.110).aspx)。事件处理程序将返回`void`

我个人发现这在测试过程中对在函数体中创建一次性回调很有用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-25T18:40:50.870

> ... 不带参数并且返回类型为 void？

如果您正在为 写作`System.Windows.Forms`，您还可以使用：

```
public delegate void MethodInvoker() 
```

# c# - 如果第 2 代被填满，垃圾收集期间会发生什么？

> ID：917552
> 
> 赞同：13
> 
> 时间：2009-05-27T19:21:43.797
> 
> 标签：c#, .net, garbage-collection

我现在正在*[通过 C# 重新阅读 CLR，](https://rads.stackoverflow.com/amzn/click/com/0735621632)*并且对 .NET 中的垃圾收集有一些疑问。在本书中，第 0 代被填满后，垃圾收集开始并将所有未完成的对象引用移动到第 1 代。

当第 1 代被填满时，也会发生同样的情况。但是当第二代被填满时会发生什么？没有其他代可以移动参考。CLR 是否扩展了第 2 代的大小？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-27T19:23:42.183

是的，如果可以的话，它将扩大第 2 代的规模。如果没有更多可用空间，您将获得一个`OutOfMemoryException`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T19:31:01.513

不同代的垃圾收集不是关于具有特定的大小，而是关于垃圾的年龄。据我所知，没有几代人有大小限制。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T19:32:41.620

据我了解，只有一个堆（具有讽刺意味的是，它通常被描述为堆栈）。对象不是在第 0 代填满时被提升到第 1 代，而是在它们在集合中存活时。简而言之，引用没有“移动”，用于标识生成结束位置的位置被移动。

当堆接近满时，会发生一些事情：

1.  收集每一代，从 0 开始，以 2 结束。
    *   如果第 0 代收集足够，则不会收集第 1 代和第 2 代。
    *   如果第 0 代收集不足，但第 1 代收集充足，则不会收集第 2 代。
2.  堆被压缩（间隙被删除）
3.  促进世代
    *   第 1 代幸存者被标记为第 2 代。
    *   第 0 代幸存者被标记为第 1 代。

然后将在收集中幸存的对象移动到第 0 代（如果这是它们的第一个收集周期）或第 2 代（如果它们在多个收集中幸存下来）。这样做是为了提高效率，以确保我们不会不断地尝试收集长寿命的对象。

您不会以特定于生成的方式耗尽空间。 [请参阅这篇文章](http://msdn.microsoft.com/en-us/magazine/bb985011.aspx)以获得很好的解释。

# ruby - Ruby - 在模块/类之间共享记录器实例

> ID：917566
> 
> 赞同：52
> 
> 时间：2009-05-27T19:23:36.710
> 
> 标签：ruby, logging, class-design

编写一个小 Ruby 脚本，该脚本可以访问网络并爬取各种服务。我有一个模块，里面有几个类：

```
module Crawler
  class Runner
  class Options
  class Engine
end 
```

我想在所有这些类中共享一个记录器。通常我只是把它放在模块中的一个常量中并像这样引用它：

```
Crawler::LOGGER.info("Hello, world") 
```

问题是我无法创建我的记录器实例，直到我知道输出的去向。您通过命令行启动爬虫，此时您可以告诉它您要在开发（日志输出到 STDOUT）或生产（日志输出到文件 crawler.log）中运行：

```
crawler --environment=production 
```

我有一个类`Options`可以解析通过命令行传入的选项。只有到那时我才知道如何使用正确的输出位置实例化记录器。

所以，我的问题是：我如何/在哪里放置我的记录器对象，以便我的所有类都可以访问它？

我可以将我的记录器实例传递给`new()`我创建的每个类实例的每个调用，但我知道必须有一种更好的 Rubyish 方式来做到这一点。我想象模块上有一些奇怪的类变量与`class << self`其他魔法共享。:)

更多细节：`Runner`通过将命令行选项传递给`Options`类来启动一切，并返回一个带有几个实例变量的对象：

```
module Crawler
  class Runner
    def initialize(argv)
      @options = Options.new(argv)
      # feels like logger initialization should go here
      # @options.log_output => STDOUT or string (log file name)
      # @options.log_level => Logger::DEBUG or Logger::INFO
      @engine = Engine.new()
    end
    def run
      @engine.go
    end
  end
end

runner = Runner.new(ARGV)
runner.run 
```

我需要代码`Engine`才能访问记录器对象（以及在内部初始化的更多类`Engine`）。帮助！

如果您可以动态更改已经实例化的 Logger 的输出位置（类似于更改日志级别的方式），那么所有这些都可以避免。如果我在生产中，我会将其实例化为 STDOUT，然后转换为文件。我确实在某处看到了有关更改 Ruby 的 $stdout 全局变量的建议，该变量会将输出重定向到 STDOUT 以外的其他位置，但这似乎很 hacky。

谢谢！

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2011-07-20T20:34:00.843

我喜欢`logger`在我的类中有一个可用的方法，但我不喜欢`@logger = Logging.logger`在我所有的初始化程序中撒上。通常，我这样做：

```
module Logging
  # This is the magical bit that gets mixed into your classes
  def logger
    Logging.logger
  end

  # Global, memoized, lazy initialized instance of a logger
  def self.logger
    @logger ||= Logger.new(STDOUT)
  end
end 
```

然后，在您的课程中：

```
class Widget
  # Mix in the ability to log stuff ...
  include Logging

  # ... and proceed to log with impunity:
  def discombobulate(whizbang)
    logger.warn "About to combobulate the whizbang"
    # commence discombobulation
  end
end 
```

因为该`Logging#logger`方法可以访问该模块混入的实例，所以扩展您的日志记录模块以使用日志消息记录类名是微不足道的：

```
module Logging
  def logger
    @logger ||= Logging.logger_for(self.class.name)
  end

  # Use a hash class-ivar to cache a unique Logger per class:
  @loggers = {}

  class << self
    def logger_for(classname)
      @loggers[classname] ||= configure_logger_for(classname)
    end

    def configure_logger_for(classname)
      logger = Logger.new(STDOUT)
      logger.progname = classname
      logger
    end
  end
end 
```

您`Widget`现在使用其类名记录消息，并且不需要更改一点:)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-27T21:25:33.063

根据您布置的设计，看起来最简单的解决方案是为 Crawler 提供一个返回模块 ivar 的模块方法。

```
module Crawler
  def self.logger
    @logger
  end
  def self.logger=(logger)
    @logger = logger
  end
end 
```

或者，`class <<self`如果您愿意，可以使用“魔法”：

```
module Crawler
  class <<self
    attr_accessor :logger
  end
end 
```

它做同样的事情。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-05-07T03:40:59.873

正如 Zenagray 指出的那样，Jacob 的回答中忽略了类方法的日志记录。一个小补充解决了这个问题：

```
require 'logger'

module Logging
  class << self
    def logger
      @logger ||= Logger.new($stdout)
    end

    def logger=(logger)
      @logger = logger
    end
  end

  # Addition
  def self.included(base)
    class << base
      def logger
        Logging.logger
      end
    end
  end

  def logger
    Logging.logger
  end
end 
```

预期用途是通过“包括”：

```
class Dog
  include Logging

  def self.bark
    logger.debug "chirp"
    puts "#{logger.__id__}"
  end

  def bark
    logger.debug "grrr"
    puts "#{logger.__id__}"
  end
end

class Cat
  include Logging

  def self.bark
    logger.debug "chirp"
    puts "#{logger.__id__}"
  end

  def bark
    logger.debug "grrr"
    puts "#{logger.__id__}"
  end
end

Dog.new.bark
Dog.bark
Cat.new.bark
Cat.bark 
```

产生：

```
D, [2014-05-06T22:27:33.991454 #2735] DEBUG -- : grrr
70319381806200
D, [2014-05-06T22:27:33.991531 #2735] DEBUG -- : chirp
70319381806200
D, [2014-05-06T22:27:33.991562 #2735] DEBUG -- : grrr
70319381806200
D, [2014-05-06T22:27:33.991588 #2735] DEBUG -- : chirp
70319381806200 
```

请注意，记录器的 id 在所有四种情况下都是相同的。如果您想为每个类使用不同的实例，请不要使用`Logging.logger`，而是使用`self.class.logger`：

```
require 'logger'

module Logging
  def self.included(base)
    class << base
      def logger
        @logger ||= Logger.new($stdout)
      end

      def logger=(logger)
        @logger = logger
      end
    end
  end

  def logger
    self.class.logger
  end
end 
```

相同的程序现在产生：

```
D, [2014-05-06T22:36:07.709645 #2822] DEBUG -- : grrr
70350390296120
D, [2014-05-06T22:36:07.709723 #2822] DEBUG -- : chirp
70350390296120
D, [2014-05-06T22:36:07.709763 #2822] DEBUG -- : grrr
70350390295100
D, [2014-05-06T22:36:07.709791 #2822] DEBUG -- : chirp
70350390295100 
```

请注意，前两个 id 相同，但与第二个两个 id 不同，这表明我们有两个实例——每个类一个。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-06-03T20:31:48.797

受此线程的启发，我创建了[easy_logging](https://github.com/thisismydesign/easy_logging) gem。

它结合了所有讨论的功能，例如：

*   使用一个简短的自描述命令在任何地方添加日志记录功能
*   Logger 适用于类和实例方法
*   记录器特定于类并包含类名

安装：

```
gem install 'easy_logging 
```

用法：

```
require 'easy_logging'

class YourClass
  include EasyLogging

  def do_something
    # ...
    logger.info 'something happened'
  end
end

class YourOtherClass
  include EasyLogging

  def self.do_something
    # ...
    logger.info 'something happened'
  end
end

YourClass.new.do_something
YourOtherClass.do_something 
```

输出

```
I, [2017-06-03T21:59:25.160686 #5900]  INFO -- YourClass: something happened
I, [2017-06-03T21:59:25.160686 #5900]  INFO -- YourOtherClass: something happened 
```

更多细节在[GitHub 上](https://github.com/thisismydesign/easy_logging)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T20:08:55.870

这可能是一些奇怪的 Ruby 魔法，可以让你避免它，但有一个相当简单的解决方案，不需要奇怪。只需将记录器放入模块并直接访问它，并具有设置它的机制。如果您想对此保持冷静，请定义一个“惰性记录器”，该记录器保留一个标志以说明它是否有记录器，并且要么静默丢弃消息，直到设置记录器，要么在记录器被记录之前抛出异常记录是设置，或将日志消息添加到列表中，以便在定义记录器后对其进行记录。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T23:20:24.530

一小段代码来演示它是如何工作的。我只是创建一个新的基本对象，以便我可以观察到 object_id 在整个调用过程中保持不变：

```
module M

  class << self
    attr_accessor :logger
  end

  @logger = nil

  class C
    def initialize
      puts "C.initialize, before setting M.logger: #{M.logger.object_id}"
      M.logger = Object.new
      puts "C.initialize, after setting M.logger: #{M.logger.object_id}"
      @base = D.new
    end
  end

  class D
    def initialize
      puts "D.initialize M.logger: #{M.logger.object_id}"
    end
  end
end

puts "M.logger (before C.new): #{M.logger.object_id}"
engine = M::C.new
puts "M.logger (after C.new): #{M.logger.object_id}" 
```

此代码的输出如下所示（`object_id`4 表示`nil`）：

```
M.logger (before C.new): 4
C.initialize, before setting M.logger: 4
C.initialize, after setting M.logger: 59360
D.initialize M.logger: 59360
M.logger (after C.new): 59360 
```

谢谢你们的帮助！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-10-16T10:58:58.603

如何将记录器包装在单例中，然后您可以使用 MyLogger.instance 访问它

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-11-18T19:25:53.390

虽然是一个老问题，但我认为值得记录一种不同的方法。

基于 Jacob 的回答，我建议您在需要时添加一个模块。

我的版本是这样的：

```
# saved into lib/my_log.rb

require 'logger'

module MyLog

  def self.logger
    if @logger.nil?
      @logger = Logger.new( STDERR)
      @logger.datetime_format = "%H:%M:%S "
    end
    @logger
  end

  def self.logger=( logger)
    @logger = logger
  end

  levels = %w(debug info warn error fatal)
  levels.each do |level|
    define_method( "#{level.to_sym}") do |msg|
      self.logger.send( level, msg)
    end
  end
end

include MyLog 
```

我把它保存到一个方便的模块库中，我会这样使用它：

```
#! /usr/bin/env ruby
#

require_relative '../lib/my_log.rb'

MyLog.debug "hi"
# => D, [19:19:32 #31112] DEBUG -- : hi

MyLog.warn "ho"
# => W, [19:20:14 #31112]  WARN -- : ho

MyLog.logger.level = Logger::INFO

MyLog.logger = Logger.new( 'logfile.log')

MyLog.debug 'huh'
# => no output, sent to logfile.log instead 
```

我发现这比我迄今为止看到的其他选项更容易、更通用，所以我希望它对你有所帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-11-10T22:03:57.160

根据您的评论

> 如果您可以动态更改已经实例化的 Logger 的输出位置（类似于更改日志级别的方式），那么所有这些都可以避免。

如果您不限于默认记录器，则可以使用另一个 log-gem。

以[log4r 为例](https://rubygems.org/gems/log4r)：

```
require 'log4r' 

module Crawler
  LOGGER = Log4r::Logger.new('mylog')
  class Runner
    def initialize
        LOGGER.info('Created instance for %s' % self.class)
    end
  end
end

ARGV << 'test'  #testcode

#...
case ARGV.first
  when 'test'
    Crawler::LOGGER.outputters = Log4r::StdoutOutputter.new('stdout')
  when 'prod'
    Crawler::LOGGER.outputters = Log4r::FileOutputter.new('file', :filename => 'test.log') #append to existing log
end
#...
Crawler::Runner.new 
```

在 prod 模式下，日志数据存储在一个文件中（附加到现有文件，但有创建新日志文件或实施滚动日志文件的选项）。

结果：

```
 INFO main: Created instance for Crawler::Runner 
```

如果您使用 log4r (a) 的继承机制，您可以为每个类定义一个记录器（或者在我下面的示例中为每个实例）并共享输出器。

这个例子：

```
require 'log4r' 

module Crawler
  LOGGER = Log4r::Logger.new('mylog')
  class Runner
    def initialize(id)
      @log = Log4r::Logger.new('%s::%s %s' % [LOGGER.fullname,self.class,id])
      @log.info('Created instance for %s with id %s' % [self.class, id])
    end
  end
end

ARGV << 'test'  #testcode

#...
case ARGV.first
  when 'test'
    Crawler::LOGGER.outputters = Log4r::StdoutOutputter.new('stdout')
  when 'prod'
    Crawler::LOGGER.outputters = Log4r::FileOutputter.new('file', :filename => 'test.log') #append to existing log
end
#...
Crawler::Runner.new(1)
Crawler::Runner.new(2) 
```

结果：

```
 INFO Runner 1: Created instance for Crawler::Runner with id 1
 INFO Runner 2: Created instance for Crawler::Runner with id 2 
```

(a) 记录器名称 like`A::B`具有 name`B`并且是具有 name 的记录器的子级`A`。据我所知，这不是对象继承。

这种方法的一个优点是：如果您想为每个类使用一个记录器，您只需要更改记录器的名称。

# c# - C#正则表达式替换自定义html标签

> ID：917573
> 
> 赞同：-1
> 
> 时间：2009-05-27T19:25:11.107
> 
> 标签：c#, regex, string

我的应用程序收集内部用户提供的 HTML 内容，用于在公司网站上动态构建文章。

我想实现一个功能，用户可以用一个名为 <search>....</search> 的特殊标签将 HTML 内容中的单词/短语括起来，当内容保存在数据库中时，应用程序将转换 <search >WORD/PHRASE</search> 在对单词或短语进行编码后说出 www.google.com/?q=WORD/PHRASE。

我认为正则表达式可用于实现此功能，但需要一些有关如何执行此功能的指导，因为 HTML 内容中可能有多个 <search>....</search> 标记。

任何有关示例的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T19:37:12.627

像这样的东西应该工作：

```
string data = @"some text <search>search term 1</search> some more text <search>another search term</search>";
Console.WriteLine(Regex.Replace(data, @"(?:<search>)(.*?)(?:</search>)", @"<a href=""http://www.google.com/?q=$1"">$1</a>")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T19:36:56.103

你可以试试

```
Regex.Replace(strMyHtmlInputString, "\<search\>(.+?)\<\/search\>", "www.google.com/?q=\1") 
```

第一个分组中的问号表示“尽可能少分组以匹配该组”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:33:38.047

您应该考虑使用 HTML DOM 来解析内容而不是正则表达式。用于解析 html 的正则表达式因其复杂性和意外错误而臭名昭著。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T19:51:20.867

正则表达式不擅长处理 XML/HTML 数据。您最好使用真正的 HTML 或 XML 阅读 API。例如，当您处理其中包含嵌套标签的 HTML 时，正则表达式会遇到问题。

如果您正在获取标签汤 HTML（很可能是这种情况），那么您将无法毫无压力地使用 .NET 的本机[XmlDocument类。](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)您应该查看[HtmlAgilityPack](http://www.codeplex.com/htmlagilitypack)，它具有与 XmlDocument 完全相同的 API，但它包含一些特定于 HTML 的内容，例如清理 HTML 以使其格式正确。

此示例使用 XmlDocument 类，但使用 HtmlAgilityPack 的 HtmlDocument 应该非常相似（仅使用 HtmlDocument 而不是 XmlDocument）。这应该用`<search />`指向 Google 的链接替换标签。

```
XmlDocument doc = new XmlDocument();
doc.LoadXml(xml);
XmlNode searchTag = doc.SelectSingleNode("//search");
XmlElement linkTag = doc.CreateElement("a");
linkTag.InnerXml = searchTag.InnerXml;
linkTag.Attributes["href"].Value = "http://google.com/?q=" + linkTag.InnerText;
searchTag.ParentNode.ReplaceChild(searchTag, linkTag); 
```

**免责声明：**我没有测试上面的这个示例代码，但它应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T19:34:44.907

假设你不能嵌套搜索标签，贪婪匹配应该很容易。

更换

`<search>(.*?)</search> is going to be key.`

# c# - LINQ - VB.Net 中的动态 OrderBy

> ID：917575
> 
> 赞同：2
> 
> 时间：2009-05-27T19:25:35.830
> 
> 标签：c#, .net, vb.net, linq

我正在尝试做与从 Phil Haack 到 VB 的示例代码类似的事情，而 LINQ Orderby 给我带来了问题——我不知道该怎么做。为完整性发布了整个方法。

这是 C# 版本：

```
 public ActionResult DynamicGridData(string sidx, string sord, int page, int rows)
    {
        var context = new HaackOverflowDataContext();
        int pageIndex = Convert.ToInt32(page) - 1;
        int pageSize = rows;
        int totalRecords = context.Questions.Count();
        int totalPages = (int)Math.Ceiling((float)totalRecords / (float)pageSize);

        var questions = context.Questions.OrderBy(sidx + " " + sord).Skip(pageIndex * pageSize).Take(pageSize);

        var jsonData = new
        {
            total = totalPages,
            page = page,
            records = totalRecords,
            rows = (
                from question in questions
                select new
                {
                    i = question.Id,
                    cell = new string[] { question.Id.ToString(), question.Votes.ToString(), question.Title }
                }).ToArray()
        };
        return Json(jsonData);
    } 
```

我的问题是这条线......：

```
var questions = context.Questions.OrderBy(sidx + " " + sord).Skip(pageIndex * pageSize).Take(pageSize); 
```

在 VB.Net OrderBy 不接受字符串作为值 - 它似乎在 C# 中这样做（或者我遗漏了一些东西）。

（请不要使用 VAR 不是这里的问题，我已经涵盖了。:)）

**编辑：** 这是我得到的错误（我根本无法编译）：

重载解析失败，因为无法使用这些参数调用可访问的“OrderBy”...

完整错误消息的屏幕截图：[![替代文字](https://i.stack.imgur.com/5JBsa.png)](https://i.stack.imgur.com/5JBsa.png)

**编辑2：**

根据要求提供更多信息。sidx 包含要排序的列的名称 sord 包含 asc 或 desc

VB代码：

```
Function MemberData(ByVal sidx As String, ByVal sord As String, ByVal page As Integer, ByVal rows As Integer) As JsonResult

    Dim allRecords As IQueryable(Of Models.Member) = Me.MemberRepository.FindAllMembers
    Dim currentPageRecords As IQueryable(Of Models.Member)
    Dim pageIndex As Integer = page - 1
    Dim pageSize As Integer = rows
    Dim totalRecords As Integer = allRecords.Count
    Dim totalPages As Integer = CInt(Math.Ceiling(totalRecords / pageSize))

    Dim orderBy As String = sidx + " " + sord

    currentPageRecords = allRecords.OrderBy(Function(m) orderBy).Skip(pageIndex * pageSize).Take(pageSize)

    Dim jsonData = New With { _
          .total = totalPages, _
          .page = page, _
          .records = totalRecords, _
          .rows = New ArrayList _
        }

    For Each member As Models.Member In currentPageRecords
        jsonData.rows.Add(New With {.id = member.MemberId, .cell = GenerateCellData(member)})
    Next

    Return Json(jsonData)

End Function 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:23:09.460

有没有可能他正在使用[Dynamic Linq？](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)使用动态 linq，您可以将字符串传递给 OrderBy 方法以及许多其他 IEnumerable 扩展方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-18T17:31:02.853

我尝试与 Kjensen 做同样的事情，但我遇到了很多问题（包括原始 C# 示例存在一些错误：重新访问页面，省略了一些结果）。所以，我决定使用存储过程（我从来[没有](http://haacked.com/archive/2009/04/14/using-jquery-grid-with-asp.net-mvc.aspx)信任生成 SQL 代码的 ORM 事物，存储过程不是最好的，但也不是来自 Linq 的代码）和 vb。净（我还没有清理代码，一些评论是西班牙语）

SQL 代码

```
 Create procedure getDataPage1 
    (@tableName as varchar(100), 
    @columns as varchar(200),
    @columnOrder as varchar(100), 
    @columnOrderDirection as varchar(20),
    @currentPage as int,
    @pageSize as int, 
    @filter as varchar(2000) = '')
    AS
    BEGIN

    -- No se debe referenciar a otras columnas Identity (para esos casos se debe hacer un conversion previa antes de hacer el INSERT INTO)
    -- Version válida para Sql server 2000, usar funcion ROW_NUMBER para SQL server 2005 o posterior
    -- Ejemplos de uso: 
    -- exec getDataPage1 'DataTarjetasProcesada', 'linea = cast(linea as varchar(100)), Tarjeta, Bloqueo, Saldo', 'Tarjeta', 'desc', 6, 800
    -- exec getDataPage1 'Question', 'Id, Votes, Title', 'Title', 'desc', 2, 10

        set nocount on

        declare @query as nvarchar(1000)

        -- Paso 1: se numera el listado
        set @query = 'Select Identifier = Identity(int, 1, 1), ' + @columns  +
                ' into #temp ' +
                ' from ' + @tableName +
                case when @filter = '' then '' else ' where ' + @filter end + 
                ' Order By ' + @columnOrder + ' ' + @columnOrderDirection
        -- Paso 2: se toma la página de consulta
        +
        ' select ' + @columns  + ' from #temp '+
        ' where Identifier between '  + cast( @pageSize * (@currentPage -1) + 1 as varchar(15)) + 
        ' and '+ cast (@pageSize*( @currentPage ) as varchar (15)) 

        EXECUTE sp_executesql @query

        set nocount off
    END 
```

VB .net 代码

```
 Function DynamicGridData(ByVal sidx As String, ByVal sord As String, ByVal page As Integer, ByVal rows As Integer) As ActionResult
        Dim context As New MvcTestApplication.modelDataContext
        Dim pageIndex As Integer = Convert.ToInt32(page) - 1
        Dim pageSize As Integer = rows
        Dim totalRecords As Integer = context.Questions.Count()
        Dim totalPages As Integer = Math.Ceiling(CDec(totalRecords) / CDec(pageSize))

        ' Establecemos la función de ordenación dependiendo del valor del 
        ' parámetro "sidx", que es el campo de orden actual
        ' Establecemos si se trata de orden ascendente o descendente, en    
        ' función del parámetro "sord", que puede valer "asc" o "desc"

        Dim results As IMultipleResults = context.getDataPage1("Question", "Id, Votes, Title", sidx, sord, page, pageSize)

        Dim questions = results.GetResult(Of Question)()

        Dim jsonData = New With { _
          .total = totalPages, _
          .page = page, _
          .records = totalRecords, _
          .rows = (From question In questions _
                    Select New With _
                    { _
                        .i = question.Id, _
                        .cell = New String() {question.Id.ToString(), question.Votes.ToString(), question.Title} _
                    } _
                     ).ToArray() _
        }

        Return Json(jsonData)

    End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T19:47:16.630

OrderBy 采用 lambda 表达式；在这种情况下，C# 从传递的字符串中推断出一个。VB，显然不能做出这样的推断。

尝试使用`OrderBy(Function(str) sidx + " " + sord)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-23T05:05:43.630

```
Function MemberData(
        ByVal sidx As String, 
        ByVal sord As String, 
        ByVal page As Integer, 
        ByVal rows As Integer) As JsonResult

    Dim allRecords As IQueryable(Of Models.Member) = 
            Me.MemberRepository.FindAllMembers

    Dim currentPageRecords As IQueryable(Of Models.Member)
    Dim pageIndex As Integer = page - 1
    Dim pageSize As Integer = rows
    Dim totalRecords As Integer = allRecords.Count
    Dim totalPages As Integer = CInt(Math.Ceiling(totalRecords / pageSize))

    Dim orderBy As String = sidx + " " + sord

    currentPageRecords = allRecords.OrderBy(Function(m) orderBy).Skip(
            pageIndex * pageSize).Take(pageSize)

    Dim jsonData = New With { _
          .total = totalPages, _
          .page = page, _
          .records = totalRecords, _
          .rows = New ArrayList _
        }

    For Each member As Models.Member In currentPageRecords
        jsonData.rows.Add(
           New With {.id = member.MemberId, .cell = GenerateCellData(member)})
    Next

    Return Json(jsonData)

End Function 
```

# deployment - 如何避免将成品传递给安装团队的陷阱？

> ID：917576
> 
> 赞同：4
> 
> 时间：2009-05-27T19:25:48.403
> 
> 标签：deployment, communication

有没有人有将成品传递给安装团队的经验？

我们的产品可以通过 RPM 安装，但也需要复制一些 MySQL 数据、修改一些配置文件并运行一些开发编写的脚本。拥有一个安装团队固然很棒，但它是随叫随到的开发，每次安装后，我们都会在下班后接到客户的电话，我们必须提供支持。

我们确实从每起事件中吸取了教训，但更积极主动一点对我们的客户、我们的声誉和我的睡眠都有好处。

具体来说：

*   您使用了哪些工具来改善团队之间的沟通/协作？
*   您使用了哪些技术解决方案？
*   您使用了哪些政策？
*   有没有人在编写安装后验证工具方面取得任何成功？

**编辑：** 我应该澄清一下，我不是在谈论开发和/或 QA 应该发现的软件故障。问题是客户打来电话说“选项 A 突然不可用”，因为它没有配置为打开，或者“我无法登录”，因为身份验证服务器配置不正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T19:57:36.907

这基本上是阿萨夫不同重点的答案。在部署的双方都有过，有两个主要项目来确保良好的部署。

* * *

1.  **运动部件少**

这意味着，如果您可以选择提供一些文件并让部署者将它们放在生产环境中的某些文件夹中，或者您可以将文件预先放置在文件夹结构中，然后让部署者将其复制到根目录中. 或者更简单，一个批处理文件。或微星。如果他们必须运行 SQL 脚本，那么清楚地显示他们在哪里。

基本上，这一步归结为允许开发人员创建脚本和批处理文件，并尽可能人工（呵呵）自动化。这样一来，部署人员（他们并不像您一样了解应用程序）就不会想到他们应该对剩下的三个文件做什么。（呃，你应该把它们放在文件夹 A、B、D 和 ZZ 中）

* * *

2.  **部署指南**

这都是大写的，因为它胜过第一步。我说的是一个非常彻底的指南。

不应该说

"*将地图相关文件移动到 Map-App-Data 文件夹中。* "

应该说

“*将*文件 x、y、z*（位于部署包中的*文件夹 X*中）移动到 Map-App-Data 文件夹（位于*D:\AppName\Map-App-Data*）*”。

执行甚至说“远程进入 X 服务器，然后执行 y”的动作，因为您可能认为部署程序应该在哪个服务器上很清楚，但是对于多服务器设置，应该做什么可能会变得非常棘手在哪里。给定一份如此详尽的文档意味着任何人都可以部署，即使是您没有机会就正在发生的事情进行培训的人。

* * *

2.1**回滚计划**

将回滚计划直接放入部署指南中。如果部署出错，而且它们偶尔会出错，您不希望让服务器离线，直到部署人员能够唤醒知道发生了什么的人。它应该就在他们面前。即使这对您来说似乎很明显和简单，但请记住，您在过去的四个星期里全神贯注于这个项目，而这个人已经花了最后 20 分钟。他们根本不可能知道你没有告诉他们什么。

* * *

2.2**测试部署指南**

自己完成这些步骤。或者更好的是，请一位不在项目中的同事与您的向导一起尝试部署到 UAT，然后您坐在他们旁边。任何地方他们弄错了，改变指南。部署出错的任何地方（您以前见过的情况）在指南中添加一个脚注，解释为什么会出现这种情况，以及如果可能的话如何解决它。至关重要的是，您的部署指南没有错误，因为当您编写部署指南时，您实际上是在对部署进行操作（因为您知道如何操作）并且您获得了通过它睡觉的好处。但是，这也意味着任何错误都在你身上。

请为我错过的任何内容添加评论，我将把它扔进去。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:36:12.533

不是针对您的特定问题，而是曾经有一个开发人员和测试人员团队将 Web 应用程序部署到一组服务器以进行测试和验证。

到了发布的时候，客户得到了可部署的文件并按照规范进行了部署……到一组与我们的开发服务器完全不同的服务器。

大量错误涌入，混乱接踵而至，客户大发雷霆，可怜的开发人员无法入睡。

我的提示是最明显的提示之一；确保开发环境与生产环境匹配，以避免环境特定的错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:40:39.793

是的。一些基本规则：

1.  始终交付签名并盖章的产品。使用 zip（或任何具有校验和的东西），不要传递单个文件或目录。
2.  将其刻录在 CD 上并实际移交。这样你就会*知道*你有一个有效的硬拷贝（和一个备份）。您会惊奇地发现，由于 CD 刻录机会默默地损坏文件，因此搞砸安装是多么容易。
3.  安装团队（或 QA）应该收到客户收到的确切信息，仅此而已。假设他们比最愚蠢的客户更了解你的产品。
4.  自然，您应该始终保留按版本分类的所有此类交付的存储库。
5.  打印该版本附带的任何安装/部署/用户指南，并实际交付。作为纸。即使该文档自上一个版本以来没有更改。我浪费了很多时间来帮助 QA 调试安装，后来意识到他们使用了错误的安装指南。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T20:34:56.423

*   没有“安装团队”。开发人员应该负责开发一个工作系统，而不是他们扔在墙上的一堆碎片，让其他一些可怜的 sap 开始工作。

*   拥有完全自动化的部署/升级过程。部署不应该需要*手动*决策，因为总有一天有人会不小心做出错误的决定。

*   如果部署失败，请修复自动化并重新发布。不要将系统就地投入生产，因为人们总有一天会忘记将修复检查回源代码存储库。

*   在开发过程中定期测试部署/升级过程。最好在每次提交时，作为持续集成过程的一部分。

*   确保测试环境尽可能接近生产环境。理想情况下，唯一的区别应该是密码。

*   作为部署的一部分运行环境测试。我通常在系统本身中实现这些，以便它自我测试并报告其运行时环境的问题。

*   轻松回滚失败的部署。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-02T13:59:00.580

经过一番讨论，是我们的构建团队提出了使用称为 Jump Start 的想法。我们可以打包我们的 RPM 和任何必要的配置（MySQL 命令、对 httpd.conf 的更改等...）。一旦我们遇到安装问题，我们可以修改脚本；这几乎可以保证同样的错误不会发生两次。

一旦我们真正开始使用这个直播，我会更新。

# c# - 为什么我将 Stream 作为 System.IO.UnmanagedMemoryStream？

> ID：917589
> 
> 赞同：3
> 
> 时间：2009-05-27T19:32:19.827
> 
> 标签：c#, resources, assemblies, stream

我有一部分这样的代码

```
 Assembly myAssembly = Assembly.GetExecutingAssembly();
        string[] names = myAssembly.GetManifestResourceNames();
        foreach (string file in names)
        {
            if (file.EndsWith(".dtd"))
            {
                // attach to stream to the resource in the manifest
                  dtdStream = myAssembly.GetManifestResourceStream(file);
                  MessageBox.Show(dtdStream.ToString());
            }                
        } 
```

我的资源文件夹下有所有 dtd 文件。它的构建类型为嵌入式资源。
现在，当我调试代码时，我收到一个显示 System.IO.UnmanagedMemoryStream 的消息框

但我想要一个托管的 MemoryStream？
我的代码有什么问题？
谢谢...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T19:36:19.490

资源被编译为程序集（EXE 或 DLL）的一部分，这意味着当操作系统启动进程时它们被加载到非托管内存中。这就是为什么返回的任何流都`GetManifestResourceStream`必须是非*托管*的（类型`UnmanagedMemoryStream`）的原因。

无论如何，这有什么问题？`MemoryStream`和的界面`UnmanagedMemoryStream`基本相同，只是（隐藏的）功能不同，这对您没有任何影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T19:40:39.593

这是“设计使然”的行为，提供了更快的内存访问。

参考： http: [//msdn2.microsoft.com/en-us/library/system.reflection.emit.modulebuilder.definemanifestresource (VS.85).aspx](http://msdn2.microsoft.com/en-us/library/system.reflection.emit.modulebuilder.definemanifestresource(VS.85).aspx)

# java - 解码 base64 字符串 Java 5

> ID：917604
> 
> 赞同：6
> 
> 时间：2009-05-27T19:35:50.053
> 
> 标签：java, base64, decode

是否有直接使用 JAVA 1.5 库来解码 base64 字符串的方法？

由于 Windows 和 Mac OS X 之间的跨平台兼容性问题，我必须使用 Java 1.5（只有 Mac 10.5 支持 Java 1.6，低于 10.5 的所有东西都默认使用 Java 1.5）。

对象“sun.misc.Base64Decoder”存在于 Java 6 中，但不存在于 Java 5 中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-27T19:55:06.257

不，仅基于使用 JDK 5.0 是不可能的。

您需要推出自己的实现（这并不难），或者最好使用其中一种开源实现。有很多，包括提供 Base64 的 Commons Codec [http://commons.apache.org/codec/api-release/org/apache/commons/codec/binary/Base64.html](http://commons.apache.org/codec/api-release/org/apache/commons/codec/binary/Base64.html)

JavaMail 还通过 MimeUtility 提供 Base64 编码/解码，它还提供引用的可打印编码等...

[http://java.sun.com/products/javamail/javadocs/javax/mail/internet/MimeUtility.html](http://java.sun.com/products/javamail/javadocs/javax/mail/internet/MimeUtility.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-27T19:51:11.117

[Apache Commons 编解码器](http://commons.apache.org/codec/userguide.html)

仅供参考，即使在 Java 6 中你也应该使用它。 [不要在 sun 中使用类。*](http://java.sun.com/products/jdk/faq/faq-sun-packages.html)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-27T19:39:56.457

只需使用[http://iharder.sourceforge.net/current/java/base64/](http://iharder.sourceforge.net/current/java/base64/)。它在公共领域。因此，您可以将代码放入您的项目中，而无需担心许可证问题或包含其他 jar。您要查找的类不在 JDK 1.5 中。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-28T04:44:10.690

这是我的版本 - 它应该是完全独立的：

```
public class Base64
{

// *****************************************************************************
// INSTANCE PROPERTIES
// *****************************************************************************

private String                          lineSeparator;
private int                             lineLength;

// *****************************************************************************
// INSTANCE CONSTRUCTION/INITIALIZATON/FINALIZATION, OPEN/CLOSE
// *****************************************************************************

public Base64() {
    lineSeparator=System.getProperty("line.separator");
    lineLength=0;
    }

// *****************************************************************************
// INSTANCE METHODS
// *****************************************************************************

public String encode(byte[] bin) {
    return encode(bin,0,bin.length);
    }
/**
 * Encode an array of bytes as Base64.
 * It will be broken into lines if the line length is not 0\.  If broken into lines,
 * the last line is not terminated with a line separator.
 *
 * param ba         The byte array to encode.
 */
public String encode(byte[] bin, int str, int len) {
    int                                 ol;                                     // output length
    StringBuffer                        sb;                                     // string buffer for output(must be local for recursion to work).
    int                                 lp;                                     // line position(must be local for recursion to work).
    int                                 el;                                     // even multiple of 3 length
    int                                 ll;                                     // leftover length

    // CREATE OUTPUT BUFFER
    ol=(((len+2)/3)*4);
    if(lineLength!=0) {
        int lines=(((ol+lineLength-1)/lineLength)-1);
        if(lines>0) { ol+=(lines*lineSeparator.length()); }
        }
    sb=new StringBuffer(ol);
    lp=0;

    // EVEN MULTIPLES OF 3
    el=(len/3)*3;
    ll=(len-el);
    for(int xa=0; xa<el; xa+=3) {
        int cv;
        int c0,c1,c2,c3;

        if(lineLength!=0) {
            lp+=4;
            if(lp>lineLength) { sb.append(lineSeparator); lp=4; }
            }

        // get next three bytes in unsigned form lined up, in big-endian order
        cv =(bin[xa+str+0]&0xFF); cv<<=8;
        cv|=(bin[xa+str+1]&0xFF); cv<<=8;
        cv|=(bin[xa+str+2]&0xFF);

        // break those 24 bits into a 4 groups of 6 bits, working LSB to MSB.
        c3=cv&0x3F; cv >>>=6;
        c2=cv&0x3F; cv >>>=6;
        c1=cv&0x3F; cv >>>=6;
        c0=cv&0x3F;

        // Translate into the equivalent alpha character emitting them in big-endian order.
        sb.append(ENCODE[c0]);
        sb.append(ENCODE[c1]);
        sb.append(ENCODE[c2]);
        sb.append(ENCODE[c3]);
        }

    // LEFTOVERS
    if(lineLength!=0 && ll>0) {
        lp+=4;
        if(lp>lineLength) { sb.append(lineSeparator); lp=4; }
        }
    if(ll==1) {
        sb.append(encode(new byte[] { bin[el+str], 0, 0 }).substring(0,2)).append("==");            // Use recursion so escaping logic is not repeated, replacing last 2 chars with "==".
        }
    else if(ll==2) {
        sb.append(encode(new byte[] { bin[el+str], bin[el+str+1], 0 }).substring(0,3)).append("="); // Use recursion so escaping logic is not repeated, replacing last char and  "=".
        }
    if(ol!=sb.length()) { throw new RuntimeException("Error in Base64 encoding method: Calculated output length of "+ol+" did not match actual length of "+sb.length()); }
    return sb.toString();
    }

public byte[] decode(String b64) {
    return decode(b64,0,b64.length());
    }

/**
 * Decode a Base64 string to an array of bytes.
 * The string must have a length evenly divisible by 4 (not counting line separators and other
 * ignorable characters, like whitespace).
 */
public byte[] decode(String b64, int str, int len) {
    byte[]                              ba;                                     // target byte array
    int                                 dc;                                     // decode cycle (within sequence of 4 input chars).
    int                                 rv;                                     // reconstituted value
    int                                 ol;                                     // output length
    int                                 pc;                                     // padding count

    ba=new byte[(len/4)*3];                                                     // create array to largest possible size.
    dc=0;
    rv=0;
    ol=0;
    pc=0;

    for(int xa=0; xa<len; xa++) {
        int ch=b64.charAt(xa+str);
        int value=(ch<=255 ? DECODE[ch] : IGNORE);
        if(value!=IGNORE) {
            if(value==PAD) {
                value=0;
                pc++;
                }
            switch(dc) {
                case 0: {
                    rv=value;
                    dc=1;
                    } break;

                case 1: {
                    rv<<=6;
                    rv|=value;
                    dc=2;
                    } break;

                case 2: {
                    rv<<=6;
                    rv|=value;
                    dc=3;
                    } break;

                case 3: {
                    rv<<=6;
                    rv|=value;

                    // Completed a cycle of 4 chars, so recombine the four 6-bit values in big-endian order
                    ba[ol+2]=(byte)rv;  rv>>>=8;
                    ba[ol+1]=(byte)rv;  rv>>>=8;
                    ba[ol]=(byte)rv;    ol+=3;
                    dc=0;
                    } break;
                }
            }
        }
    if(dc!=0) {
        throw new ArrayIndexOutOfBoundsException("Base64 data given as input was not an even multiple of 4 characters (should be padded with '=' characters).");
        }
    ol-=pc;
    if(ba.length!=ol) {
        byte[] b2=new byte[ol];
        System.arraycopy(ba, 0, b2, 0, ol);
        ba=b2;
        }
    return ba;
    }

/**
* Set maximum line length for encoded lines.
* Ignored by decode.
* @param len        Length of each line. 0 means no newlines inserted. Must be a multiple of 4.
*/
public void setLineLength(int len) {
  this.lineLength=(len/4)*4;
  }

/**
* Set the line separator sequence for encoded lines.
* Ignored by decode.
* Usually contains only a combination of chars \n and \r, but could be any chars except 'A'-'Z', 'a'-'z', '0'-'9', '+' and '/'.
* @param linsep     Line separator - may be "" but not null.
*/
public void setLineSeparator(String linsep) {
  this.lineSeparator=linsep;
  }

// *****************************************************************************
// STATIC PROPERTIES
// *****************************************************************************

static private final char[]             ENCODE=new char[64];                    // translation array for encoding
static private final int[]              DECODE=new int[256];                    // translation array for decoding
static private final int                IGNORE=-1;                              // flag for values to ignore when decoding
static private final int                PAD=-2;                                 // flag value for padding value when decoding

static private final Base64             BASE64=new Base64();                    // default converter

// *****************************************************************************
// STATIC INIT & MAIN
// *****************************************************************************

static {
    for(int xa=0; xa<=25; xa++) { ENCODE[xa]=(char)('A'+xa); }                  //  0..25 -> 'A'..'Z'
    for(int xa=0; xa<=25; xa++) { ENCODE[xa+26]=(char)('a'+xa); }               // 26..51 -> 'a'..'z'
    for(int xa=0; xa<= 9; xa++) { ENCODE[xa+52]=(char)('0'+xa); }               // 52..61 -> '0'..'9'
    ENCODE[62]='+';
    ENCODE[63]='/';

    for(int xa=0; xa<256; xa++) { DECODE[xa]=IGNORE;     }                      // set all chars to IGNORE, first
    for(int xa=0; xa< 64; xa++) { DECODE[ENCODE[xa]]=xa; }                      // set the Base 64 chars to their integer byte values
    DECODE['=']=PAD;
    }

// *****************************************************************************
// STATIC METHODS
// *****************************************************************************

static public String toString(byte[] dta) {
    return BASE64.encode(dta);
    }

static public String toString(byte[] dta, int str, int len) {
    return BASE64.encode(dta,str,len);
    }

static public byte[] toBytes(String b64) {
    return BASE64.decode(b64);
    }

static public byte[] toBytes(String b64, int str, int len) {
    return BASE64.decode(b64,str,len);
    }

} // END PUBLIC CLASS 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T19:41:16.657

此页面上还有各种实现：[http ://www.rgagnon.com/javadetails/java-0598.html](http://www.rgagnon.com/javadetails/java-0598.html)

# jquery - jquery循环错误

> ID：917605
> 
> 赞同：0
> 
> 时间：2009-05-27T19:35:54.377
> 
> 标签：jquery

使用 jquery 循环插件时出现此错误：

> $cont.innerHeight 不是函数

这是我的 javascript

```
$(function() {
       $('#feature').cycle({
            fx: 'scrollDown',
            easing: 'bounceout',
            delay: -2000,
            timeout: 10000
        });
    }); 
```

这是 jquery.cycle.all.js 中的行

```
var reshape = opts.containerResize && !$cont.innerHeight(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-15T04:52:59.137

[jQuery Cycle Plugin](http://malsup.com/jquery/cycle/download.html)在其下载页面上这样说：

> 在 Cycle Plugin 2.23 版本中所做的更改需要使用 jQuery 1.2.3 或更高版本！

因此，您的问题似乎是您可能使用的是过时版本的 jQuery。

尝试更新版本：http: [//ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-07-15T04:45:42.223

我之前遇到过这个错误...尝试检查“jquery.js”的版本是否修复了“cycle.js”的要求。也许这可以帮助你。

# html - 将图标放在表单中的输入元素内

> ID：917610
> 
> 赞同：333
> 
> 时间：2009-05-27T19:36:46.683
> 
> 标签：html, css, forms, input, icons

如何在表单的输入元素中放置图标？

![具有三个输入的 Web 表单的屏幕截图，其中包含图标](https://i.stack.imgur.com/V0Tjp.png)

现场版在：[潮汐力主题](http://www.elegantthemes.com/preview/TidalForce/?p=9)

* * *

## 回答 #1

> 赞同：463
> 
> 时间：2009-05-27T19:42:27.747

您链接的站点使用 CSS 技巧的组合来实现这一目标。`<input>`首先，它为元素使用背景图像。然后，为了将光标推到上面，它使用`padding-left`.

换句话说，它们有以下两条 CSS 规则：

```
background: url(images/comment-author.gif) no-repeat scroll 7px 7px;
padding-left:30px; 
```

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2009-05-27T19:48:14.740

其他人发布的 CSS 解决方案是实现此目的的最佳方式。

如果这会给您带来任何问题（阅读 IE6），您还可以在 div 内使用无边框输入。

```
<div style="border: 1px solid #DDD;">
    <img src="icon.png"/>
    <input style="border: none;"/>
</div> 
```

不像“干净”，但应该适用于较旧的浏览器。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2016-10-26T11:30:41.520

没有背景图像的解决方案：

```
.icon {
  padding-left: 25px;
  background: url("https://static.thenounproject.com/png/101791-200.png") no-repeat left;
  background-size: 20px;
}
```

```
<input type="text" class="icon" value placeholder="Search">
```

或**从右到左**的图标

```
.icon-rtl {
  padding-right: 25px;
  background: url("https://static.thenounproject.com/png/101791-200.png") no-repeat right;
  background-size: 20px;
}
```

```
<input type="text" class="icon-rtl" value placeholder="Search">
```

* * *

## 回答 #4

> 赞同：38
> 
> 时间：2009-05-27T19:43:21.270

你可以试试这个：

```
input[type='text'] {
    background-image: url(images/comment-author.gif);
    background-position: 7px 7px;
    background-repeat: no-repeat;
}
```

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2015-09-02T10:20:26.987

我发现这是最好和最干净的解决方案。在元素上使用**文本缩进：**`input`

```
#icon {
  background-image: url(../images/icons/dollar.png);
  background-repeat: no-repeat;
  background-position: 2px 3px;
}
```

```
<input id="icon" style="text-indent:17px;" type="text" placeholder="Username" />
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2019-09-03T04:00:57.543

一种在输入中定位图标的简单方法是使用 position CSS 属性，如下面的代码所示。注意：为了清楚起见，我已经简化了代码。

1.  创建围绕输入和图标的容器。
2.  将容器位置设置为相对
3.  将图标设置为绝对位置。这将相对于周围容器定位图标。
4.  使用 top、left、bottom、right 将图标定位在容器中。
5.  在输入中设置填充，使文本不会与图标重叠。

```
#input-container {
  position: relative;
}

#input-container > img {
  position: absolute;
  top: 12px;
  left: 15px;
}

#input-container > input {
  padding-left: 40px;
}
```

```
<div id="input-container">
  <img/>
  <input/>
</div>
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-05-28T10:04:56.587

```
.icon{
background: url(1.jpg) no-repeat;
padding-left:25px;
} 
```

将上述标签添加到您的 CSS 文件中并使用指定的类。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2018-09-03T22:03:21.140

这对我有用：

```
input.valid {
   border-color: #28a745;
   padding-right: 30px;
   background-image: url('https://www.stephenwadechryslerdodgejeep.com/wp-content/plugins/pm-motors-plugin/modules/vehicle_save/images/check.png');
   background-repeat: no-repeat;
   background-size: 20px 20px;
   background-position: right center;
}
```

```
<form>
<label for="name">Name</label>
<input class="valid" type="text" name="name" />
</form>
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2018-06-23T04:06:52.883

你可以试试这个：***Bootstrap-4 Beta***
[https://www.codeply.com/go/W25zyByhec](https://www.codeply.com/go/W25zyByhec)

```
<div class="container">
            <form>
                <div class="row">
                    <div class="input-group mb-3 col-sm-6">
                      <input type="text" class="form-control border-right-0" placeholder="Username" aria-label="Username" aria-describedby="basic-addon1">
                        <div class="input-group-prepend bg-white">
                            <span class="input-group-text border-left-0 rounded-right bg-white" id="basic-addon1"><i class="fas fa-search"></i></span>
                        </div>
                    </div>
                </div>
            </form>
        </div> 
```

  </p>

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2019-02-13T06:48:18.673

在开始时使用此 css 类作为您的输入，然后进行相应的自定义：

```
.inp-icon {
    background: url(https://i.imgur.com/kSROoEB.png)no-repeat 100%;
    background-size: 16px;
}
```

```
<input class="inp-icon" type="text">
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2020-10-08T20:15:17.560

我用下面的代码实现了这一点。

首先，您弯曲容器，使输入和图标位于同一行。对齐项目使它们处于同一水平。

然后，不管怎样，让输入占据 100% 的宽度。给图标绝对定位，使其与输入重叠。

然后在输入中添加右填充，这样输入的文本就不会到达图标。最后使用`right`css 属性为图标从输入边缘留出一些空间。

注意：`Icon`如果您正在使用 ReactJs，标签可能是一个真正的图标，或者是您在项目中使用图标的任何其他方式的占位符。

```
.inputContainer {
  display: flex;
  align-items: center;
  position: relative;
}

.input {
  width: 100%;
  padding-right: 40px;
}

.inputIcon {
  position: absolute;
  right: 10px;
}
```

```
<div class="inputContainer">
   <input class="input" />
   <Icon class="inputIcon" />
 </div>
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-05-27T19:42:40.570

只需在 CSS 中使用背景属性。

```
<input id="foo" type="text" />

#foo
{
    background: url(/img/foo.png);
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2018-05-10T19:24:40.670

我有这样的情况。它没有工作，因为`background: #ebebeb;`。我想在输入字段上放置背景，并且该属性不断显示在背景图像的顶部，而我看不到图像！所以，我把房产移到了`background`房产的上方`background-image`，它起作用了。

```
input[type='text'] {
    border: 0;
    background-image: url('../img/search.png');
    background-position: 9px 20px;
    background-repeat: no-repeat;
    text-align: center;
    padding: 14px;
    background: #ebebeb;
} 
```

我的情况的解决方案是：

```
input[type='text'] {
    border: 0;
    background: #ebebeb;
    background-image: url('../img/search.png');
    background-position: 9px 20px;
    background-repeat: no-repeat;
    text-align: center;
    padding: 14px;
} 
```

顺便提一下，`border`和`padding`属性`text-align`对于解决方案并不重要。我只是复制了我的原始代码。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2017-01-06T19:36:17.180

与字体图标一起使用

```
<input name="foo" type="text" placeholder="&#61447;"> 
```

或者

```
<input id="foo" type="text" />

#foo::before
{
  font-family: 'FontAwesome';
  color:red;
  position: relative;
  left: -5px;
  content: "\f007";    
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2015-12-09T15:41:53.313

```
 <label for="fileEdit">
    <i class="fa fa-cloud-upload">
    </i>
    <input id="fileEdit" class="hidden" type="file" name="addImg" ng-file-change="onImageChange( $files )" ng-multiple="false" accept="{{ contentType }}"/>
  </label> 
```

例如，您可以使用：带有隐藏输入的标签（存在图标）。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-09-01T22:37:40.573

我不想更改输入文本的背景，它也不会与我的 SVG 图标一起使用。

我所做的是为图标添加**负边距**，使其出现在输入框中

并向输入添加相同的值**填充**，因此文本不会位于图标下方。

```
<div class="search-input-container">

  <input
    type="text"
    class="search-input"
    style="padding-right : 30px;"
  />

  <img 
    src="@/assets/search-icon.svg" 
    style="margin-left: -30px;"
   />

</div> 
```

*inline-style 是为了可读性考虑使用类

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-08T08:43:01.753

```
.input_container {
  display: flex;
  border-bottom: solid 1px grey;
  transition: border-color 0.1s ease-in;
  background: white;
}

.input {
  color: blue;
  display: block;
  width: calc(100% - 20px);
  border: none;
  outline: none;
  padding: 8px 16px;
}

.input_img {
  flex-basis: 20px;
  display: inline-block;
  padding: 8px 16px;
  cursor: pointer;
}
```

```
<div class="input_container">
  <input type="text" class="input" value>
  <span class="input_img" data-role="toggle">
    <svg
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
        <path
          d="M8 9C7.44772 9 7 9.44771 7 10C7 10.5523 7.44772 11 8 11H16C16.5523 11 17 10.5523 17 10C17 9.44771 16.5523 9 16 9H8Z"
          fill="currentColor"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M6 3C4.34315 3 3 4.34315 3 6V18C3 19.6569 4.34315 21 6 21H18C19.6569 21 21 19.6569 21 18V6C21 4.34315 19.6569 3 18 3H6ZM5 18V7H19V18C19 18.5523 18.5523 19 18 19H6C5.44772 19 5 18.5523 5 18Z"
          fill="currentColor"
        />
      </svg>
    </span>
</div>
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-07-20T16:11:03.383

您可以采用不同的方法，该方法还允许您单击它并让它发挥作用。看看下面的例子：

```
<div id="search-bar">
  <input placeholder="Search or Type a URL">
  <button><i class="fas fa-search"></i></button>
</div>

#search-bar {
  display: flex;
  justify-content: center;
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  margin: auto;
  height: 60px;
}
#search-bar > input {
  width: 750px;
  font-size: 30px;
  padding: 20px;
  border-radius: 50px 0px 0 50px;
  border: none;
  border-top: 1px solid #000;
  border-bottom: 1px solid #000;
  border-left: 1px solid #000;
  background: #fff; /* CSS Edit Here */
}
#search-bar > button {
  background: #fff;
  border: none;
  font-size: 30px;
  border-right: 1px solid #000;
  border-top: 1px solid #000;
  border-bottom: 1px solid #000;
  border-radius: 0 50px 50px 0 ;
  padding-right: 20px;
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2022-01-14T17:42:32.610

**css 后台解决方案**在大多数情况下都可以做到这一点，但它在图标消失的 webkit (chrome) 自动完成方面存在问题。

还有其他解决方案，包括通过将输入包装在 div 中并添加额外元素（img、div 或类似元素）来更改**html/dom 结构。**我不喜欢解决方案，因为您需要使用绝对位置调整元素 css 和/或按像素调整大小以获得正确的位置。或者重新创建输入边框以“合并”输入和 img 合二为一。

所以这个解决方案是基于css背景图像而不是应用在输入元素上，而是应用在一个包装器div上。

HTML：

```
<div class="input-email">
    <input type="text" placeholder="Email" name="email" id="email">
</div> 
```

CSS：

```
.input-email {
    background: url(/assets/images/email.svg) no-repeat scroll 14px 11px;
    display: inline-block;
} 

.input-email input{
    padding-left: 40px;
    background-color: transparent !important;
}

input:-webkit-autofill, input:-webkit-autofill:hover, 
input:-webkit-autofill:focus, input:-webkit-autofill:active {
    transition: background-color 5000s ease-in-out 0s;
} 
```

1.  通过这种方式，使用**.input-email**类，我将我的图标图像定义为 div 背景（不受 webkit 自动完成背景的影响）。
2.  下一个**.input-email 输入**定义我填充了输入元素以给图像留出空间并将其设置为透明（这在不应用自动完成时有效）
3.  最后使用**webkit-autofill**类，我通过转换删除了由自动完成设置的背景颜色。

注意：在第 2 点，我设置了**透明的 !important**，因为这个**-internal-autofill-selected**会在浏览器中呈现，如果不将 my 也设置为 !important，我就无法覆盖它：

```
input:-internal-autofill-selected {
    background-color: -internal-light-dark(rgb(232, 240, 254), rgba(70, 90, 126, 0.4)) !important;
} 
```

我从这篇文章[https://www.py4u.net/discuss/1069380](https://www.py4u.net/discuss/1069380)中得到了我的解决方案， 我做了一些调整，尽管主要归功于他们。

* * *

## 回答 #20

> 赞同：-3
> 
> 时间：2020-04-29T13:04:47.337

这适用于我或多或少的标准形式：

```
 <button type="submit" value="Submit" name="ButtonType" id="whateveristheId" class="button-class">Submit<img src="/img/selectedImage.png" alt=""></button> 
```

# dns - 域层访问持久性的东西

> ID：917612
> 
> 赞同：2
> 
> 时间：2009-05-27T19:37:00.537
> 
> 标签：dns, persistence, layer

我试图让我的领域层尽可能地“纯粹”，而不涉及持久性或其他基础设施问题。但是，有时我的域层需要使用 RDBMS 或其他外部依赖项的服务，我不知道如何处理它。

例如，我的应用程序中的每个域对象都实现了一个 IValidatable 接口，客户端调用该接口以获取阻止对象被持久化的损坏规则列表。在少数情况下，上述验证例程涉及调用 DAO 类以检查特定记录的存在。我们没有使用 ORM；相反，我们使用使用数据访问对象模式构建的持久层。我应该围绕这个数据库访问创建一个服务/包装类并让我的域对象与之协作吗？添加这种间接级别是否可以接受，还是我仍在污染我的域对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:57:46.127

通常的答案是使用某种对象关系接口。您的领域层呈现您的领域模型的接口。你有一个关系数据库，你需要在它们之间有一个层来执行[对象关系映射](http://en.wikipedia.org/wiki/Object-relational_mapping)。您说“我们没有使用 ORM”，但实际上您是：您只是直接在域层中进行映射。

进行该映射的问题被称为[对象关系阻抗失配](http://en.wikipedia.org/wiki/Object-Relational_impedance_mismatch)问题。如果你坚持不明确 ORM 层，那么是的，你应该编写类来封装使用 DBMS 的细节，（当然，当你这样做时，你会在那里引入 ORM 类。）

确实，很难避免使用*一些*ORM 层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-02T16:19:22.737

长期以来，我一直认为您不能将持久性知识隐藏在持久性域对象中。尝试这样做变得越来越不自然，并引入了奇怪的副作用。所以换句话说，我认为在领域层建立持久性知识是可以的，但不一定是持久性的确切方法；应该使用 DAO 接口。

我应该补充一点，根据您的验证检查，您会受到竞争条件的影响。您应该准备好处理因此可能发生的任何约束异常。

# c# - 隐式转换为 Func

> ID：917616
> 
> 赞同：7
> 
> 时间：2009-05-27T19:38:09.067
> 
> 标签：c#, delegates, lambda, anonymous-methods, implicit

假设我有一个`IMyInterface<T>`简单描述一个功能的接口：

```
public interface IMyInterface<T>
{
    T MyFunction(T item);
} 
```

我可以将其替换为`Func<T, T>`，但出于语义原因，我想要该界面。我是否可以在该接口之间定义一个隐式转换，`Func<T,T>`以便我可以将匿名委托或 lambda 作为参数传递给接受此接口作为参数的函数，就像我使用的`Func<T,T>`那样？

为了演示，使用上面声明的接口，我想要一个这样的函数：

```
public T TestFunction<T>(IMyInterface myInterface, T value)
{
    return myInterface.MyFunction(value);
} 
```

我可以这样称呼：

```
TestFunction(x => x + " world", "hello"); 
```

结果将是“hello world”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:42:38.153

由于 C# 中的接口不能包含运算符的定义（或任何静态方法），我相信答案是*否定*的。另一种方法是使用一个类（不幸的是不能是抽象的，因为静态成员/运算符在这里并不比在接口中更好）。这将允许您定义`implicit`转换运算符，因此能够准确地使用您指定的类型。

在类中（如果需要，您可以制作`virtual`），您可以将其定义如下。

```
public class MyClass<T>
{
    public static implicit operator MyClass<T>(Func<T, T> func)
    {
        return new MyClass<T>() { MyFunction = func };
    }

    public MyClass()
    {
    }

    public Func<T, T> MyFunction
    {
        get;
        set;
    }
} 
```

然后，您在问题中的定义`TestFunction`应该与您编写的代码完全相同。

```
public T TestFunction<T>(IMyInterface myInterface, T value)
{
    return myInterface.MyFunction(value);
} 
```

同样调用`TestFunction`：

```
TestFunction<string>(x => return x + " world", "hello"); 
```

这可能不是您正在寻找的确切内容，但它仍然相当接近，而且很可能是您能够获得的最好的。

# c# - 使用 GUID 是生成随机字符串和数字的有效方法吗？

> ID：917617
> 
> 赞同：2
> 
> 时间：2009-05-27T19:38:48.427
> 
> 标签：c#, .net, random

> **可能重复：**
> [System.Guid.NewGuid() 有多随机？](https://stackoverflow.com/questions/467271/how-random-is-system-guid-newguid)

基于[这个问题](https://stackoverflow.com/questions/292254/vb6-how-do-i-make-a-random-string-of-0-9-and-a-z-of-x-characters/)，我想知道使用 GUID 生成随机字符串和数字是否有任何缺陷？

因此，例如，如果我想要一个随机字符串和 32 个或更少字符的数字，我可以使用以下 C# 代码：

```
string s = Guid.NewGuid().ToString().Replace("-", ""); 
```

如果长度需要小于 32，我会截断字符串，如果需要更长，我会将多个 GUID 添加在一起。

这种方法有什么缺陷？

在我写完这篇文章后，我意识到一个缺陷是它只会有字母 a 到 f 所以我将修改这个问题：

这是一个真正的 6 个字符和 10 个数字的随机序列吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-27T19:41:44.487

GUID 不保证随机性，它保证唯一性。如果您想要随机性，请使用 Random 生成字符串。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-05-27T19:41:47.453

它实际上并不是随机的，而是（相对）独特的。如果你真的想要随机性，我建议使用 System.Random 中值的哈希值之类的东西。

[这是](http://msdn.microsoft.com/en-us/library/system.random.aspx).NET“System.Random”的 MSDN 文档的链接，以及他们的[Hashing package](http://msdn.microsoft.com/en-us/library/system.security.policy.hash.generatehash.aspx)的链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T23:29:46.010

正如其他答案所解释的那样， a`GUID`只保证唯一性，而不是随机性。

如果您只需要唯一性，那么您问题中的代码就可以了，尽管您可以只使用`Guid.NewGuid().ToString("N")`而不是显式替换连字符。

如果您确实需要一个随机字符串，请尝试以下操作：

```
// use RNGCryptoServiceProvider instead of Random if you need extra security
private readonly Random _rng = new Random();

public string GetRandomString(int length)
{
    const string allowedChars =
        "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

    char[] buffer = new char[length];

    for (int i = 0; i < length; i++)
    {
        buffer[i] = allowedChars[_rng.Next(allowedChars.Length)];
    }

    return new string(buffer);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T19:45:03.500

不会。例如，标准的 GUID 生成算法包括当前时间和生成计算机的 MAC 地址等内容。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T19:58:15.063

如前所述，GUID 被设计为唯一的而不是随机的。生成[“随机”字符串](http://www.c-sharpcorner.com/UploadFile/mahesh/RandomNumber11232005010428AM/RandomNumber.aspx)（即满足某些随机性统计要求）的更好且相当简单的方法是使用`Random`：

```
/// <summary>
/// Generates a random string with the given length
/// </summary>
/// <param name="size">Size of the string</param>
/// <param name="lowerCase">If true, generate lowercase string</param>
/// <returns>Random string</returns>
private string RandomString(int size, bool lowerCase)
{
    StringBuilder builder = new StringBuilder();
    Random random = new Random();
    char ch;
    for (int i = 0; i < size; i++)
    {
        ch = Convert.ToChar(Convert.ToInt32(Math.Floor(26 * random.NextDouble() + 65)));
        builder.Append(ch);
    }
    if (lowerCase)
        return builder.ToString().ToLower();
    return builder.ToString();
} 
```

如果您需要“更安全”的随机数，您可能需要查看[`RNGCryptoServiceProvider`](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rngcryptoserviceprovider.aspx). 但正如约翰·冯·诺依曼已经[说过](http://en.wikipedia.org/wiki/Pseudorandom_number_generator#cite_note-1)的那样：

> 当然，任何考虑产生随机数字的算术方法的人都处于犯罪状态。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T20:37:07.200

如前所述，GUID 设计为生成唯一的，然后几乎保持静态。由于所有随机生成都只是伪随机的（您将在生成几千个整数值后开始看到模式），因此只使用标准的 Random() 类是理想的。每次它构造一个新对象时，它都会用当前系统时间播种它。这将保证它最接近随机。您永远不应该使用静态的东西来播种 Random 方法。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-05-27T19:43:38.760

由于 Guid 是唯一的，因此解决方案是可以的。

# php - 如何以编程方式编写 nslookup？

> ID：917619
> 
> 赞同：2
> 
> 时间：2009-05-27T19:39:03.010
> 
> 标签：php, python, ruby, networking, nslookup

而不是在我们的脚本中使用 exec 来执行 nslookup，有没有一种简单的方法可以用 PHP、Python 或 Ruby 以编程方式编写它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:45:41.627

是的，尽管函数名称可能不是您所期望的。

由于 Python 和 Ruby 的答案已经发布，这里是一个 PHP 示例：

```
$ip = gethostbyname('www.example.com');
$hostname = gethostbyaddr('127.0.0.1'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T19:44:07.027

对于 Python，请参阅[http://small-code.blogspot.com/2008/05/nslookup-in-python.html](http://small-code.blogspot.com/2008/05/nslookup-in-python.html)。对于更丰富的功能，也在 Python 中，请参阅[http://www.dnspython.org/](http://www.dnspython.org/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:44:15.747

[Ruby 中的套接字类](http://www.ruby-doc.org/stdlib/libdoc/socket/rdoc/classes/Socket.html#M004531)。看到这个[答案](https://stackoverflow.com/questions/2993/reverse-dns-in-ruby/3012#3012)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T19:51:04.593

对于 PHP，您可以使用[gethostbyname](http://php.net/gethostbyname)和[gethostbyaddr](http://php.net/gethostbyaddr)。

对于 Python，导入 socket 模块并再次使用[gethostbyname](http://docs.python.org/library/socket.html#socket.gethostbyname)和[gethostbyaddr](http://docs.python.org/library/socket.html#socket.gethostbyaddr)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-14T10:42:27.570

```
$ip = gethostbyname('www.example.com'); 
```

这将起作用，但请注意，如果用户更改其主机文件，它将受到影响。你不能依赖它。

# c# - 如果您的数据表的主键是两列，您可以使用 DataTable.Contains(object key) 吗？

> ID：917622
> 
> 赞同：5
> 
> 时间：2009-05-27T19:40:14.273
> 
> 标签：c#, visual-studio, ado.net, datatable, datarow

如果是这样怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:53:32.263

要通过主键选择，您应该使用以下之一：

*   `DataTable.Rows.Find(Object)`如果您的 PK 是一列
*   `DataTable.Rows.Find(Object[])`如果您有超过 1 列作为主键

如果是类型化的 DataSet，`MyDataTable.Rows.Find(...)`将为您生成具有正确签名的方法。基本上它是 DataRowCollection 类的一个方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T19:45:33.933

“包含”似乎不是 DataRow 类的成员（也许这是一个类型化的数据集？）

在任何情况下，您始终可以使用 (DataTable.Select(....).Length > 0) 作为替代

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T21:30:18.543

我假设您指的是 DataRowCollection.Contains 方法？有一个需要一组对象的重载，你应该使用这个

# mysql - 有什么方法可以选择而不会导致 MySQL 锁定？

> ID：917640
> 
> 赞同：149
> 
> 时间：2009-05-27T19:43:03.783
> 
> 标签：mysql, locking

询问：

```
SELECT COUNT(online.account_id) cnt from online; 
```

但是在线表也是被事件修改的，所以经常可以通过运行看到锁`show processlist`。

MySQL中是否有任何语法可以使select语句不导致锁？

而且我忘记在上面提到它位于 MySQL 从属数据库上。

我添加到`my.cnf:transaction-isolation = READ-UNCOMMITTED` 从机后会遇到错误：

> 错误'无法进行二进制日志记录。消息：InnoDB 中的事务级别 'READ-UNCOMMITTED' 对于查询时的 binlog 模式 'STATEMENT'' 不安全

那么，有没有兼容的方法来做到这一点？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-05-27T21:27:19.860

找到一篇题为“MYSQL WITH NOLOCK”的文章

[https://web.archive.org/web/20100814144042/http://sqldba.org/articles/22-mysql-with-nolock.aspx](https://web.archive.org/web/20100814144042/http://sqldba.org/articles/22-mysql-with-nolock.aspx)

在 MS SQL Server 中，您将执行以下操作：

```
SELECT * FROM TABLE_NAME WITH (nolock) 
```

MYSQL 等价物是

```
SET SESSION TRANSACTION ISOLATION LEVEL READ UNCOMMITTED ;
SELECT * FROM TABLE_NAME ;
SET SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ ; 
```

**编辑**

[Michael Mior](https://stackoverflow.com/users/123695/michael-mior)提出以下建议（来自评论）

```
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED ;
SELECT * FROM TABLE_NAME ;
COMMIT ; 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-27T19:50:57.607

如果表是 InnoDB，请参阅[http://dev.mysql.com/doc/refman/5.1/en/innodb-consistent-read.html——](http://dev.mysql.com/doc/refman/5.1/en/innodb-consistent-read.html)它对 SELECT 使用一致读取（无锁定模式）“如果设置了 innodb_locks_unsafe_for_binlog 选项并且事务的隔离级别未设置为 SERIALIZABLE，则不要指定 FOR UPDATE 或 LOCK IN SHARE MODE。因此，从选定表读取的行上不会设置任何锁”。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-27T19:51:00.633

利用

`SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED.`

5.0 版文档在[这里](http://dev.mysql.com/doc/refman/5.0/en/set-transaction.html)。

5.1 版文档在[这里](http://dev.mysql.com/doc/refman/5.1/en/set-transaction.html)。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-05-27T19:49:04.457

您可能想阅读MySQL 手册的[这一页](http://dev.mysql.com/doc/refman/5.0/en/table-locking.html)。表如何被锁定取决于它是什么类型的表。

MyISAM 使用表锁来实现非常高的读取速度，但是如果您有一条 UPDATE 语句在等待，那么未来的 SELECTS 将在 UPDATE 之后排队。

InnoDB 表使用行级锁定，您不会在 UPDATE 之后锁定整个表。InnoDB 还有其他类型的锁定问题，但您可能会发现它符合您的需求。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-06-07T05:01:44.983

another way to enable dirty read in mysql is add hint: LOCK IN SHARE MODE

```
SELECT * FROM TABLE_NAME LOCK IN SHARE MODE; 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-27T20:05:16.330

根据您的表类型，锁定的执行方式会有所不同，但 SELECT 计数也会有所不同。对于 MyISAM 表，一个简单的 SELECT count(*) FROM 表不应锁定该表，因为它访问元数据以提取记录计数。Innodb 需要更长的时间，因为它必须在快照中抓取表来计算记录，但它不应该导致锁定。

您至少应该将 concurrent_insert 设置为 1（默认值）。然后，如果数据文件中没有要填充的表的“间隙”，则插入将附加到文件中，并且 SELECT 和 INSERT 可以与 MyISAM 表同时发生。请注意，删除记录会在数据文件中产生一个“空白”，它将尝试用未来的插入和更新来填充。

如果您很少删除记录，则可以将 concurrent_insert 设置为 2，并且插入将始终添加到数据文件的末尾。然后选择和插入可以同时发生，但是无论您删除多少条记录（所有记录除外），您的数据文件都不会变小。

最重要的是，如果你在一个表上有很多更新、插入和选择，你应该让它成为 InnoDB。不过，您可以在系统中自由混合表格类型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-27T19:49:05.660

从[这个](http://dev.mysql.com/doc/refman/5.0/en/internal-locking.html)参考：

> 如果您使用 LOCK TABLES 显式获取表锁，则可以请求 READ LOCAL 锁而不是 READ 锁，以使其他会话能够在您锁定表时执行并发插入。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-27T21:30:24.283

SELECT 通常不会对 InnoDB 表执行任何您关心的锁定。默认事务隔离级别意味着选择不会锁定内容。

当然，争论仍然存在。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-11-26T13:16:12.673

这是另一种编程解决方案，它可能适用于使用 MyISAM IF（重要）的其他人，您不在乎在查询过程中是否发生了更新。正如我们所知，MyISAM 可能会导致表级锁定，特别是如果您有一个将被锁定的更新挂起，然后此更新后面的其他选择查询也被锁定。

所以这种方法不会阻止锁，但会制造很多小锁，以免在很短的时间内挂起一个需要响应的网站。

这里的想法是我们基于一个快速的索引获取一个范围，然后我们只从那个查询中进行匹配，所以它是小批量的。然后我们将列表向下移动到下一个范围并检查它们是否匹配。

示例是在 Perl 中，带有一些伪代码，并且从高到低遍历。

```
 # object_id must be an index so it's fast
# First get the range of object_id, as it may not start from 0 to reduce empty queries later on.

my ( $first_id, $last_id ) = $db->db_query_array(
  sql => q{ SELECT MIN(object_id), MAX(object_id) FROM mytable }
);

my $keep_running = 1;
my $step_size    = 1000;
my $next_id      = $last_id;

while( $keep_running ) {

    my $sql = q{ 
SELECT object_id, created, status FROM 
    ( SELECT object_id, created, status FROM mytable AS is1 WHERE is1.object_id <= ? ORDER BY is1.object_id DESC LIMIT ? ) AS is2
WHERE status='live' ORDER BY object_id DESC 
};  

    my $sth = $db->db_query( sql => $sql, args => [ $step_size, $next_id ] );

    while( my ($object_id, $created, $status ) = $sth->fetchrow_array() ) {

        $last_id = $object_id;

        ## do your stuff

    }

    if( !$last_id ) {
        $next_id -= $step_size; # There weren't any matched in the range we grabbed
    } else {
        $next_id = $last_id - 1; # There were some, so we'll start from that.
    }

    $keep_running = 0 if $next_id < 1 || $next_id < $first_id;

} 
```

# c++ - 在 Windows DLL 函数参数中使用浮点数

> ID：917643
> 
> 赞同：2
> 
> 时间：2009-05-27T19:43:14.470
> 
> 标签：c++, windows, dll

我正在用 C++ 编写一个非托管 DLL。在 Windows DLL 中使用 float 作为函数参数是个好主意吗？

我希望我的 DLL 可以从尽可能多的语言（VB6、.NET 等）中使用。为此，我使用了 STDCALL 并避免使用 C++ 类型。

大多数语言会正确处理浮动吗？如果没有，我应该使用什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T19:47:07.910

大多数编译器中使用的`float`类型甚至以某种 IEEE 格式标准化，所以请继续。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T19:45:57.570

所有 Microsoft 语言，例如 VB 和 C# 都可以使用它。事实上，使用[VARIANT](http://msdn.microsoft.com/en-us/library/ms221627.aspx)支持的任何类型都应该没问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T20:02:15.273

诀窍是弄清楚如何将调用语言中的值“编组”为 dll 中函数所期望的类型。很多时候，调用语言中的数据类型与 C 使用的类型相似但略有不同。发生这种情况时，您需要一种方法将值复制到 C 类型中，然后将其传递给 DLL。

希望 MSDN 上的这篇文章可以帮助您入门：

[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:21:36.857

简短的回答是，主流语言将处理浮点参数到 DLL 函数几乎没有开销。

您可以使用任何基本的 C 数据类型，如果调用代码无法处理它，那么问题就出在他们身上，而不是您的问题上，因为您生成了一个完全有效的 DLL。

# asp.net - MSBuild ASP.NET VB6 DLL 互操作

> ID：917649
> 
> 赞同：0
> 
> 时间：2009-05-27T19:44:00.787
> 
> 标签：asp.net, vb6, msbuild, interop

我们有一个带有 VS 2008 的 C# ASP.NET 3.5 项目。

我们还有一个通过 Interop 调用的 VB6 DLL（哎呀……我知道）。

我们将 Web 部署项目与 MsBuild 一起使用，并运行批处理文件以在构建机器上构建项目。

我的问题是：

作为构建过程的一部分，有没有办法修改 MSBuild 项目以创建 VB6 DLL 和互操作文件并将其移动到正确的文件夹中？

目前，我们必须手动构建 VB6 DLL 和互操作文件，然后先将它们移动到适当的文件夹，然后运行 ​​MSBuild 批处理文件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T19:47:16.833

使用 MSBuild Exec 任务通过 /make 开关调用 VB6.exe 开发项目。然后使用 MSBUILD 复制任务将已知输出复制到您想要的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-28T11:26:40.387

如果可以以某种方式将命令插入 MSBuild 批处理文件，则可以从命令行构建 VB6 DLL。只需使用命令行开关 /make 运行 VB6 IDE (VB6.exe) 并将路径传递给 VBP 项目文件。使用 /? 运行 VB6.exe 如果您想查看其他命令行开关的列表。

我不确定如何自动创建互操作文件，但快速的 Google 搜索表明[Tlbimp](http://msdn.microsoft.com/en-us/library/tt0cf3sx(VS.80).aspx)可能[值得一试](http://msdn.microsoft.com/en-us/library/697w37zd(VS.80).aspx)。

我将把命令`copy`输出到所需目录作为读者的练习；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-28T11:46:46.990

或者，您可以查看诸如 FinalBuilder 之类的自动构建工具，您可以通过 gui 轻松编写脚本来执行您喜欢的任何事情，包括您在上面提出的问题。 [链接文本](http://www.finalbuilder.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-11T18:38:18.607

[http://msbuildextensionpack.codeplex.com/](http://msbuildextensionpack.codeplex.com/)

有一个 vb6 构建任务。但是，这只是`vb6.exe /make`.

Aka，msbuild 任务有助于构建这样的命令行：

```
C:\Program Files\Microsoft Visual Studio\VB98\VB6.exe /MAKE /OUT "..\MyProjectFolder\MyOldSchoolVB6Project.vbp.log" "..\MyProjectFolder\MyOldSchoolVB6Project.vbp" /outdir" "..\MyProjectBuildResults\bin" 
```

您不一定需要 msbuildextensionpack 任务，但我发现从长远来看它更好用。（您的另一个选择是连接一个 exec 任务并“硬调用”上面的命令行。

没有 VB6.EXE 就无法构建 .vbp。接受这个事实，你的世界就会变得更有意义。

我建议将绝对最小公分母 vb6 安装放在构建机器上（也就是取消选中所有可能的选项）。

然后编写您的 .msbuild 文件。

像这样的东西：

（我没有定义 SourceFilesBaseDirectory 或 OutputBuildDirectory，仅供参考）

```
 <PropertyGroup>
    <!-- This allows a way to provide a few options for the library  -->
    <TPath>$(MSBuildProjectDirectory)\..\MSBuild.ExtensionPack.tasks</TPath>
    <TPath Condition="Exists('$(ProgramFiles)\MSBuild\ExtensionPack\MSBuild.ExtensionPack.tasks')">$(ProgramFiles)\MSBuild\ExtensionPack\MSBuild.ExtensionPack.tasks</TPath>
  </PropertyGroup>

  <Import Project="$(TPath)"/>  

    <ItemGroup>
    <ProjectsToBuildIT001 Include="$(SourceFilesBaseDirectory)\MyProjectFolder\MyOldSchoolVB6Project.vbp">
          <OutDir>$(OutputBuildDirectory)</OutDir>
    </ProjectsToBuildIT001>
  </ItemGroup>

    <Target Name="BuildTheVBProjects001" >

        <MSBuild.ExtensionPack.VisualStudio.VB6 TaskAction="Build" Projects="@(ProjectsToBuildIT001)"/>             

    </Target> 
```

我个人不喜欢我的主要构建机器上的 vb6.exe。但这就是我。

谢天谢地，.Net 2.0 和后来提出了一种构建代码的方法，它不依赖于正在安装的 IDE。

“硬呼叫”看起来像这样。你会很想缩短它并尝试它，它可能会起作用。但我相信上面的任务要干净得多。

```
<exec program="c:\myfolder\myexe.exe" failonerror="false">
<arg value="/MAKE" />
</exec> 
```

当然，这只是一个示例，需要一些修补才能使其正确。

但归根结底，vb6.exe 必须存在于构建框~~某处。

..

# asp.net - 如何从 aspx 页面引用母版页？

> ID：917653
> 
> 赞同：2
> 
> 时间：2009-05-27T19:44:55.340
> 
> 标签：asp.net, master-pages

如何从 ASP.NET 网络表单中引用母版页？以下语句不起作用：

```
this.MasterPage.Page.Title = "My Title"; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T19:47:52.603

在您的 aspx 中，在 Page 指令下方，写入：

```
<%@ MasterType VirtualPath="YourMasterFile" %> 
```

然后从你的代码中，写Master。您想使用的任何东西，例如：

```
Master.Title = "My Title"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T19:48:37.610

您必须将 this.MasterPage 转换为您拥有的母版页类型，然后您可以按预期访问它

```
var mp = this.MasterPage as MyMasterPageType;
mp.Property = value... etc 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T19:52:26.027

从页面中，您可以使用该`Master`属性并将其转换为您的母版页。即`(MyMasterPage)this.Master`。但是，每当我尝试这样做时，我总是检查它是否可以先施放，所以我通常会得到类似...

```
MyMasterPage master;
if (this.Master is MyMasterPage)
{
    master = (MyMasterPage)this.Master
    //do stuff with master.
} 
```

如果您只想更改标题，那么您可以使用`Page.Title`并确保您的母版页中的 head 标记设置为 runat='server'。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:01:15.540

在您最初的问题中（在编辑之前），我认为您提到了“全局设置”。根据您想要做什么，您可能还想研究 BasePage 概念，因为我认为它可能更合适。由于您从它派生，因此它的所有成员都可以在您的代码隐藏中访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T19:49:22.367

在你的代码中写：

```
Dim masterpage As New MasterPage
    masterpage = CType(masterpage, MasterPage) 
```

并在定义语言等的源代码中键入此

```
MasterPageFile="~/MasterPage.master" 
```

如果你用 C# 编写

```
 MasterPage masterpage = new MasterPage();
masterpage = (MasterPage)masterpage; 
```

# ruby-on-rails - has_many ：通过二级多态性

> ID：917657
> 
> 赞同：0
> 
> 时间：2009-05-27T19:45:40.283
> 
> 标签：ruby-on-rails

鉴于下面定义的关联，我希望有人能阐明为什么我不能访问属于某个类别的所有分类广告，而这些分类广告又属于某个部分。我猜这与其中存在多态关系这一事实有关，但我想知道是否有一种正确的方法可以仅使用关联语句来做我想做的事情，或者我是否必须“滚动我自己的”，并分两个阶段获得分类广告。

只看代码可能更容易理解：

```
class CategorySection < ActiveRecord::Base
  has_many :categories
  has_many :categorizations, :through => :categories
  has_many :classifieds, :through => :categories
end

class Category < ActiveRecord::Base
  belongs_to :section, :class_name => 'CategorySection', 
                       :foreign_key => 'category_section_id', 
                       :counter_cache => true
  has_many :categorizations
  has_many :classifieds, :through => :categorizations, 
                         :source => :categorizable, 
                         :source_type => 'Classified'
end

class Categorization < ActiveRecord::Base
  belongs_to :category, :counter_cache => true
  belongs_to :categorizable, :polymorphic => true
end

class Classified < ActiveRecord::Base
  has_one :categorization, :as => :categorizable, :dependent => :destroy
  has_one :category, :through => :categorization
end 
```

在大多数情况下，除了我无法弄清楚的一个关联之外，这一切都正常工作。给定一个 CategorySection，我怎样才能快速找出属于它的所有分类广告？

例如：

给定一个类别，我可以得到它的所有分类：

```
>> @category.categorizations
>> [<Categorization...>,<Categorization...>] 
```

给定一个类别，我可以获得其中的所有分类：

```
>> @category.classifieds
>> [<Classified...>,<Classified...>] 
```

给定一个部分，我可以得到它的所有类别：

```
>> @section.categories
>> [<Category...>,<Category...>] 
```

给定一个部分，我可以通过 :categories 得到它的所有分类

```
>> @section.categorizations
>> [<Categorization...>,<Categorization...>] 
```

但是，给定一个部分，我无法让其所有分类广告都通过 :categories

```
>> @section.classifieds
ActiveRecord::HasManyThroughSourceAssociationMacroError: 
Invalid source reflection macro :has_many :through for 
has_many :classifieds, :through => :categories. Use :source 
to specify the source reflection. 
```

我已经接受了错误消息的指定：source 的建议，但我仍然无法让它工作。我已经尝试了几乎所有我能想到的关于该关联的选项组合，但无济于事。

任何意见或建议将不胜感激。提前致谢。

真诚的，肯尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T23:06:16.463

您是否尝试过定义没有“ `:through`”的 has_many？

```
class CategorySection < ActiveRecord::Base
  has_many :categories
  has_many :categorizations, :through => :categories
  has_many :classifieds
end 
```

可能想看看这个[railscast](http://railscasts.com/episodes/154-polymorphic-association)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T21:59:01.793

我记得 Rails 不允许在关联中多次使用 :through 。当然你不能做这样的事情：

```
has_many :books
has_many :authors, :through => :books
has_many :phones, :through => :authors 
```

但我不确定它是否允许在单独的模型（如你的模型）中做双重：通过。首先，您可以尝试在没有多态性的情况下进行操作 - 如果它有效，那么我的建议是错误的。

我认为 Rails 正在尝试为您的所有关联链生成单个 SQL 查询 - 这非常复杂。

当然，您可以为该关联编写自己的 :finder_sql 。

# editor - Vim 视觉模式脚本：搜索视觉选择周围的文本

> ID：917662
> 
> 赞同：0
> 
> 时间：2009-05-27T19:46:18.987
> 
> 标签：editor, vim

我将尝试通过示例来解释..

如果我们在 vim 中有这样一段代码：

```
if ($feck == true && $drink == false)
{
    echo 'They lie in wait like wolves..';
} 
```

我进入视觉模式并选择“ `$drink`”例如，有没有办法：

*   检测当前选择是否是 vim 的文本对象之一（word、WORD、inner { 等）
*   在选择的两侧进行查找以检查下一个可用的 vim 文本对象（再次，单词，WORD，块，内部“等。）

请注意，我正在考虑 vim 脚本，而不仅仅是简单的编辑，所以这两个“动作”都将在一个函数中，来源于我的 .vimrc

此外，我需要在不破坏视觉选择或移动光标的情况下执行此操作（或者，如果确实无法避免，请恢复选择和光标位置）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T13:23:25.877

这个问题只有在汉尼拔莱克特博士的[另一个问题](https://stackoverflow.com/questions/762613/is-there-a-way-to-emulate-resharpers-extend-selection-feature-in-vim "这另一个问题")的背景下才有意义。

我认为您想要实现的目标是可能的，但这需要一些工作。另一个答案中提供的信息和对您帖子的评论已经指向正确的方向。

从“扩展选择”键映射调用的 vim 函数必须执行以下操作：

1.  检查当前选择可能代表什么（标记 '< 和 '> 如 dwc 描述的那样，vim 函数应该对此有所帮助）。必须回答这样的问题：'< 和 '> 在同一行吗？'< 和 '> 之间的所有字母都是关键字字符吗？选择的第一个和最后一个字符是否是特殊分隔符，例如 '{'、'(' 等？等等 - 没有自动检查这一点的内置功能。另请参阅 :help visualmode(

2.  一旦确定了这一点，您就必须考虑如何进一步扩展您的选择 - 但是此逻辑在 ReSharper 中有效。

3.  您需要注意将光标放回原来的位置，具体取决于您用于扩展选择的命令。

一般来说， :help eval.txt 中提供的命令将有助于实现这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T19:56:47.047

进行视觉选择后，`'<`可`'>`用于任何接受“范围”的内容。

# c# - Unable to call a WCF service directly (.NET 3.0)

> ID：917663
> 
> 赞同：0
> 
> 时间：2009-05-27T19:46:31.313
> 
> 标签：c#, wcf, .net-3.0

I'm working with WCF (VS2005, .Net 3.0) and want to test out a service by directly calling it via a web browser instead of from code.

I have one method decorated with the OperationContract attribute call GetTest(). I have the service behind a .svc file that I can access; however, when I go .../Test.svc/GetTest, only a blank screen comes up.

Here is the web.config:

```
<system.serviceModel>
  <services>
    <service name="TestService" behaviorConfiguration="TestBehavior">
      <endpoint
        address=""
        binding="basicHttpBinding"
        contract="TestService.ITestService"></endpoint>
    </service>
  </services>
  <behaviors>
    <serviceBehaviors>
      <behavior name="TestBehavior">
        <serviceMetadata httpGetEnabled="true"/>
      </behavior>
    </serviceBehaviors>
  </behaviors>
</system.serviceModel> 
```

Whenever I try to set a breakpoint in the service, it does not get hit as well. Any ideas on where I'm going wrong here? I'm used to ASMX services where I get a response when I access the methods via a browser; however, I can only get the "You've created a Service" page when I access the service but nothing from the methods.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T20:29:46.047

Consider using the [Wcf Service Test Tool](http://msdn.microsoft.com/en-us/library/bb552364.aspx) for initial testing of your service (but really- unit testing is your friend :-)) (and yeah - you will need a mex endpoint, at least initially)

As for debugging - are you attached to the correct process hosting the service? are you compiled with debug symbols? if the service is published to IIS - is the published code the same as the code in visual studio?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T19:55:37.673

Have you tried using [SoapUI](http://soapui.org)? They provide a really great Web Services Testing tool. They even have a free version that will run as a webStart!

Also, try installing a mex endpoint, c.f. [msdn link.](http://msdn.microsoft.com/en-us/library/ms733766.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:37:15.157

WCF does not offer the "call it from the web" options that ASMX services used to do. Why? It's a huge security hole, and not the best way to test a web service.

One option is to do as @Yossi suggested, and use the Wcf Service Test Tool.

Or better yet, write your own client to consume your web service. This will help you deal with the same issues those who will consume your service will deal with, and believe me, WCF can have quite a few of those hangups.

Don't get me wrong, WCF is frikkin awesome! But there's a lot to juggle, and if you're new odds are you're going to get it wrong. Even early adopters still don't know all the ins and outs of WCF.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:50:06.987

Take a look at WebGetAttribute - which needs .NET 3.5.

This allows you to get REST data from a WCF web service.

# css - Firefox/Mac 的 Helvetica Neue 基线渲染问题

> ID：917664
> 
> 赞同：0
> 
> 时间：2009-05-27T19:46:54.650
> 
> 标签：css, firefox, fonts, safari

考虑这个 HTML：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<style type="text/css">
body {
    font-family: "Helvetica Neue", Arial, Helvetica, sans-serif;
    line-height:20px;
    font-size:14px;
}
.a {
    float:left;
}
.b {
    font-weight:bold;
}
</style>
</head>

<body>
    <div class="a">something1</div>
    <div class="a b">something2</div>
</body>
</html> 
```

在除 Firefox/Mac 之外的所有浏览器上，它都能正确呈现，即粗体和非粗体文本位于同一基线上。

在 Firefox/Mac 上，粗体和非粗体文本之间存在 1 像素的基线差异。请参阅下面的屏幕截图。左边是 Safari 3.2.3，右边是 Firefox 3.0.10。

[替代文字 http://www.jaanuskase.com/stuff/helveticaneue_ff_safari.png](http://www.jaanuskase.com/stuff/helveticaneue_ff_safari.png)

有什么办法可以解决这个问题，例如使用一些 CSS，除了在角落里安静地哭泣并使用 Arial（我不想这样做——如果可以的话，我会留在 Helvetica Neue）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:03:01.627

我的直觉反应是花车行为不端。我没有 Mac，但你能尝试这样做吗：

```
<span>something1</span><span class="b">something2</span>
<span class="a">something3</span><span class="a b">something4</span> 
```

看看他们的基线是否正确？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T23:28:08.620

以 line-height 为目标可以解决这个问题，但不确定它是否是罪魁祸首。如果你有 CSSEdit（或刷新很多），你可以通过一次增加行高 1px 来观察行为。

字体大小 14px 几乎不可能。FF 将在某些行高处将粗体元素删除 1 个像素，而 safari 将在完全相反的位置删除它！（即 line-height 20px safari 会降低粗体 1 像素，而 firefox 渲染正常，与您的问题相反）。

*除了*3 像素的行高之外，两者都渲染相同。但是 3 像素的行高很奇怪，如果它弄乱了布局，您可能需要通过调整 margin-top 来适应。

```
body {
    font: 14px "Helvetica Neue";
}

.b {
    font-weight: bold;
}

.a {
    line-height: 3px;
    float: left;
    margin-top: 9px;
} 
```

字体大小为 13 像素时，所有内容在 21 像素的行高（更接近于常规的行高。

使用不同的字体大小和行高我相信你会找到你需要的。

或者破解它，如果你是这样滚动的：

```
body {
    font: 14px "Helvetica Neue";
}

.b {
    font-weight: bold;
}

.a {
    line-height: 21px;
    float: left;

}

@media screen and (-webkit-min-device-pixel-ratio:0) {

/* Safari 3.0 and Chrome rules here */

    .a {
        line-height: 20px;
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-02T18:33:37.060

我使用 Helevetica Neue 的许可版本，我注意到按钮中的常规文本和粗体文本之间存在这种差异。我能够通过添加`descent-override: 0%;`到我`@font-face`的粗体版本声明来解决这个问题。在撰写本文时，每个浏览器都不支持（没有 IE 11 或 Safari），但 Mac 通常在本地安装 Helvetica Neue，所以我首先检查本地版本，然后我们只剩下不支持的 IE 11（像往常一样）。

[https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/descent-override](https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face/descent-override)

```
// index.scss

/* CDN version - we need to add descent-override to the CDN version only */
@font-face {
  font-family: "font-primary";
  font-style: normal;
  font-weight: 700;
  src:
    url("<MY-CDN-URL>.woff2")
      format("woff2"),
    url("<MY-CDN-URL>.woff")
      format("woff");
  font-display: swap;
  descent-override: 0%;
}
/* Local version */
@font-face {
  font-family: "font-primary-local";
  font-style: normal;
  font-weight: 700;
  src: local("Helvetica Neue Bold");
  font-display: swap;
}

$font-primary: "font-primary-local", "font-primary", "Helvetica Neue", "Helvetica", "Arial", sans-serif; 
```

前：

[![在此处输入图像描述](https://i.stack.imgur.com/h8FV6.png)](https://i.stack.imgur.com/h8FV6.png)

后：

[![在此处输入图像描述](https://i.stack.imgur.com/JYOmv.png)](https://i.stack.imgur.com/JYOmv.png)

# javascript - 在 Ruby 和 JavaScript 中复制计算的最佳方法是什么？

> ID：917665
> 
> 赞同：0
> 
> 时间：2009-05-27T19:46:58.550
> 
> 标签：javascript, ruby, json, function

我有一个 Ruby on Rails 应用程序，我需要在 Ruby 和 JavaScript 中复制一些计算。Ruby 用于服务器端，但我还需要使用 JavaScript 在浏览器上计算学生成绩。

我的第一个想法是使用字符串构建一个 JavaScript 函数，将其转换为 JSON，将其发送到浏览器进行解码并用作普通 JavaScript 函数。这听起来对你有用吗？我试过一些简单的东西，比如

```
def letterGradeCalc
  "函数 calcLetterGrade(score) {
    如果（分数> = 90）{返回'A'; }
    否则如果（分数> = 80）{返回'B'; }
    否则如果（分数> = 0）{返回'F'; }
    否则返回'';
  }".to_json
结尾

```

但当浏览器获取它时，它不是一个有效的 JavaScript 函数。它有点像一个，但它周围有双引号。

我在这里吠错树了吗？我觉得有一些非常简单的方法可以做到这一点，但我完全错过了它。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-27T19:54:37.350

对于像这样简单的事情，我建议使用该函数编写一个纯 JS 文件并将其包含在内。为此从 ruby​​ 生成 JS 听起来像是严重的矫枉过正。然后在 Ruby 中编写相同的函数。

如果它是一个中等复杂的算法，我建议只用 Ruby 编写它，并制作一个从 JS 调用的 Web 服务。

编辑，添加在我下面的评论中混杂的代码：

```
function calcLetterGrade(score, lowCutoff, hiCutoff) 
{ 
  if( score >= hiCutoff ) { return 'A'; } 
  else if( score >= lowCutoff ) { return 'B'; } 
  else if( score >= 0 ) { return 'F'; } 
  else return ''; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:08:37.180

如果不需要快速完成的话，让它成为从 JavaScript 到 Web 服务器的 AJAX 调用。使用 Rails，只需调用

```
remote_function :url    => remote_request_url,
                :update => dom_id_to_update 
```

并让它在控制器方法中将结果呈现为文本。

# javascript - 如何使用二进制搜索方法制作一个缩小字符串的 jQuery 函数？

> ID：917679
> 
> 赞同：3
> 
> 时间：2009-05-27T19:49:14.893
> 
> 标签：javascript, jquery

我正在尝试创建一个 jQuery 函数，它将一个字符串和一个固定宽度作为输入，然后通过二进制搜索方法（为了提高效率）“缩小”那段文本，使其不超过固定宽度。

这是我到目前为止所拥有的：

```
function constrain(text, ideal_width){
    var temp = $('.temp_item');
    temp.html(text);
    var item_width = temp.width();
    var ideal = parseInt(ideal_width);

    var text_len_lower = 0;
    var smaller_text = text;
    var text_len_higher = text.length;

    while (true) {
        if (item_width > ideal) {

            // make smaller to the mean of "lower" and this
            text_len_higher = smaller_text.length;
            smaller_text = text.substr(0, ((text_len_higher + text_len_lower)/2));

        } else {

            if (smaller_text.length >= text_len_higher) break;

            // make larger to the mean of "higher" and this
            text_len_lower = smaller_text.length;
            smaller_text = text.substr(0, ((smaller_text.length + text_len_higher)/2));

        }

        temp.html(smaller_text);
        item_width = temp.width();
    }

    var new_text = smaller_text + '&hellip;'
    return new_text;
} 
```

不幸的是，这会导致在我的浏览器中永远不会完成的“慢速脚本”。Firebug 指向 jquery.js（版本 1.3.2）的第 1131 行，这是“独特的”jQuery 实用程序，是罪魁祸首。但是，我没有在任何地方使用“唯一”。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T20:11:13.167

你能连接一个 javascript 调试器并检查它在哪里崩溃吗？将 Firebug 与 Firefox 或 MSVS 与 IE 一起使用。如果它爆炸得如此厉害，调试器就会死掉，单步执行这个函数，看看它能走多远。

根据最后的评论更新：我认为您需要单步执行您的代码，看看它能走多远。我会怀疑一些事情：

1.  设置新的内部文本后，可能尚未重新计算对象的宽度（或已变为无效）。可能是更新的宽度直到稍后 UI 进行重新调整时才可用。

2.  这个循环理论上应该总是终止，但它有可能（特别是如果浏览器没有正确地重新计算宽度）循环可能会永远继续下去。

3.  当您拆分内部文本时，您可能会拆分 HTML 标记，从而导致您的代码插入格式错误的 HTML，可能会导致页面布局中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T15:12:18.137

您正在尝试实现已经存在的东西：

CSS的`text-overflow:ellipsis`属性。不幸的是，它只被 IE 支持，但是一个 jQuery 插件为 Firefox 带来了这个功能。谷歌搜索“text-overflow:ellipsis firefox”，因为我还不允许发布链接。

# asp.net - ASP.net 没有为某些用户代理生成 javascript

> ID：917688
> 
> 赞同：5
> 
> 时间：2009-05-27T19:50:51.803
> 
> 标签：asp.net, javascript, user-agent, auto-generate

********************编辑 2************************ 我发现了问题所在。 ..但我不喜欢其中的含义。我之前正在测试我们的 iPhone 目标移动应用程序，并使用插件将 Firefox 的用户代理字符串屏蔽为 iPhone。

.Net 实际上并没有仅根据那条信息生成回发所需的代码。

然而我不喜欢这样，因为 iPhone 和其他多媒体设备可以解释 javascript，ASP.net 正在破坏任何依赖服务器生成的 javascript 运行的应用程序。

因此，如果社区允许...我想将我的官方问题更改为...为什么 ASP.net 不会为特定浏览器生成 javascript 以及如何关闭此“功能”。

*************** 结束编辑 2 ***************

我有一个奇怪的问题。我在工作时将一些工作代码从远程主机复制到了我的计算机上。当我尝试使用该页面时，我收到了一个 javascript 错误

```
__doPostBack is not defined
javascript:__doPostBack('ctl00$ContentPlaceHolder1$login','')()() 
```

当我很少输出页面源时，果然没有服务器端生成的javascript。

我尝试创建一个简单的页面：

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="jsTest.aspx.vb" Inherits="_jsTest" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
        <asp:TextBox ID="tbTest" runat="server"></asp:TextBox><br />
        <asp:LinkButton ID="linkTest" runat="server">LinkButton</asp:LinkButton>
    </form>
</body>
</html> 
```

代码隐藏：

```
Partial Class _jsTest
    Inherits System.Web.UI.Page
    Protected Sub linkTest_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles linkTest.Click
        Response.Write(tbTest.Text)
    End Sub
End Class 
```

得到同样的错误。

我试过重新启动（嘿，它工作了一半），从 App_Code、global.asax 和 web.config 中清除了所有内容，添加了一个带有 autopostback=true 的文本框......我没有想法。

任何人都可以阐明这里发生的事情吗？

**************更多信息************** 我刚刚在 IE 中再次尝试了一切，它按预期工作，页面源显示：

```
<input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
<input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTkxNTA2MDE2NWRkxhZMwlMVwJprcVsvQLJLrTcgaSM=" />

<script type="text/javascript">
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</script>
<div>
    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWAwK20LZAAuzRsusGAsz0+6YPxxO+Ewv1XsD5QKJiiprrGp+9a3Q=" />
</div> 
```

虽然 Firefox 中的源代码仅显示：

```
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwUKLTkxNTA2MDE2NWRkxhZMwlMVwJprcVsvQLJLrTcgaSM=" />

<input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWAwK20LZAAuzRsusGAsz0+6YPxxO+Ewv1XsD5QKJiiprrGp+9a3Q=" /> 
```

将网页保存到桌面并在记事本中打开显示同样的事情......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-28T15:56:30.637

问题是 ASP.net 处理未知浏览器的默认方式……例如 iPhone。尽管假设未知浏览器可以使用 javascript 会很好……您可以在 web.config 或 machine.config 部分指定浏览器具有的功能。

查看[http://slingfive.com/pages/code/browserCaps/](http://slingfive.com/pages/code/browserCaps/)获取更新的 asp.net 的 browsercaps 配置文件

这是匹配基于 GECKO 的浏览器（Netscape 6+、Mozilla/Firefox、...）的案例示例

```
<case match="^Mozilla/5\.0 \([^)]*\) (Gecko/[-\d]+)(?'VendorProductToken' (?'type'[^/\d]*)([\d]*)/(?'version'(?'major'\d+)(?'minor'\.\d+)(?'letters'\w*)))?">
                browser=Gecko
                <filter>
                    <case match="(Gecko/[-\d]+)(?'VendorProductToken' (?'type'[^/\d]*)([\d]*)/(?'version'(?'major'\d+)(?'minor'\.\d+)(?'letters'\w*)))">
                        type=${type}
                    </case>
                    <case> <!-- plain Mozilla if no VendorProductToken found -->
                        type=Mozilla
                    </case>
                </filter>
                frames=true
                tables=true
                cookies=true
                javascript=true
                javaapplets=true
                ecmascriptversion=1.5
                w3cdomversion=1.0
                css1=true
                css2=true
                xml=true
                tagwriter=System.Web.UI.HtmlTextWriter
                <case match="rv:(?'version'(?'major'\d+)(?'minor'\.\d+)(?'letters'\w*))">
                    version=${version}
                    majorversion=0${major}
                    minorversion=0${minor}
                    <case match="^b" with="${letters}">
                        beta=true
                    </case>
                </case>
            </case> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:42:48.173

在重新安装 Firefox 之前，请在调试模式下运行它（我认为它称为调试模式）。它会关闭所有插件，这可以帮助您缩小范围。Chrome 或 Safari 等其他浏览器呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T20:04:46.797

您已`AutoEventWireup`设置为 false，但没有覆盖 OnInit 以附加事件。尝试将其更改`AutoEventWireup`为 true。

编辑：从更多信息来看，它可能是在您的 machine.config 的浏览器功能部分中错误地识别 Firefox。（或 web.config）。

也可能是 Firefox 中的 JavaScript 已关闭，因此 .NET 确定渲染 Javascript 内容没有意义，如果有这样的事情，应该使用不同的方法来处理回发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-27T20:35:16.860

根据新信息，我认为很明显这是一个 Firefox 问题（也许你有一个插件阻塞 JS），而不是一个编程问题。我在 XP Pro 上使用 VS 2008 和 FF3 的代码得到了很好的结果，正如我所期望的那样，大多数人都会尝试它。

您可以尝试重新安装 Firefox，确保 JS 可以在所有其他站点上运行，确保 localhost 没有不同的安全权限...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-27T19:53:38.053

您确定您的 Web 服务器上安装了 ASP.NET 吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T19:54:29.690

看起来该`__doPostBack()`函数没有生成，因为您没有需要它的服务器端事件。

ASP.NET 喜欢仅在您订阅了需要它才能正常运行的事件侦听器时生成 __doPostBack() 函数。

# sql - SQL中的完整集

> ID：917697
> 
> 赞同：2
> 
> 时间：2009-05-27T19:52:39.520
> 
> 标签：sql, mysql

我需要提出一个返回满足多个条件的行的 SQL 查询。本文描述了我需要做的事情和解决方案： [http ://thenoyes.com/littlenoise/?p=58](http://thenoyes.com/littlenoise/?p=58)

基本上它使用位操作来确定是否找到了提供的字符串。但我很难理解它是如何工作的。

```
SET @q = 'A,B';

SELECT studentName
FROM quizAnswers
GROUP BY studentName
HAVING
        BIT_OR(1 << FIND_IN_SET(question, @q) - 1)
    =
        (1 << LENGTH(@q) - LENGTH(REPLACE(@q, ',', '')) + 1) - 1; -- This is 2^numValues - 1
+-------------+
| studentName |
+-------------+
| seekwill    |
+-------------+ 
```

我对其进行了测试，它按预期工作。有人可以解释这是如何工作的吗？

谢谢，阿米

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T20:45:27.120

我不会解释 BIT_OR 在做什么。

**替代解决方案：**

如果可能的话，我通常更喜欢不依赖于供应商特定功能的*纯SQL 解决方案。*如果您需要的内容与您参考的文章中的示例相似，那么此 SQL 语句应该几乎可以在任何 RDBMS 上运行并产生所需的结果：

```
-- //return those students that have correctly answered not less then 3 questions among A,B,C
select      studentName, COUNT(DISTINCT question) AS CNT
from        quizAnswers
where       question in ('A', 'B', 'C')
GROUP BY    studentName
HAVING COUNT(DISTINCT question) >= 3 
```

和你一起玩`HAVING COUNT...`更加灵活：

```
-- //return those students that have correctly answered at least 1 question among A,B (either A or B)
select      studentName, COUNT(DISTINCT question) AS CNT
from        quizAnswers
where       question in ('A', 'B',)
GROUP BY    studentName
HAVING COUNT(DISTINCT question) >= 1 
```

基本上您只需要填写`...`部分`where question in (...)`并设置 COUNT(...) 的值，默认情况下将是检查完整集的答案数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:12:31.447

如果列表中的某个值匹配，则设置一个位并将其左移与列表中匹配项的位置一样多的次数。group-by 对每个学生的所有单独的位图进行异或运算，产生一个包含相同信息的单个值（为每个存在的匹配值设置一个位）。

这种方法显然受到返回类型可以容纳的位数的限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:14:46.857

[MySQL 文档](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html)解释说 FIND_IN_SET() “返回第二个参数中第一个参数的索引位置”。鉴于可用问题集是“A”、“B”或“C”，我们可以使用此查询来查看 FIND_IN_SET() 正在做什么：

```
SELECT studentName, 
       question, 
       FIND_IN_SET(question, 'A,B,C') AS position 
FROM quizAnswers; 
```

使用他们的示例记录，我们将得到：

```
+-------------+----------+----------+
| studentName | question | position |
+-------------+----------+----------+
| seekwill    | A        |        1 |
| seekwill    | B        |        2 |
| seekwill    | C        |        3 |
| roxlu       | A        |        1 |
| fury        | B        |        2 |
| fury        | B        |        2 |
+-------------+----------+----------+ 
```

他们现在建议您将其转换为位掩码并使用按位异或来消除任何给定 (studentName, question) 对的重复项。

# dojo - DojoToolkit AccordionContainer

> ID：917703
> 
> 赞同：0
> 
> 时间：2009-05-27T19:54:02.233
> 
> 标签：dojo

让 Dojotoolkit 提供的 AccordionContainer 在 Title 的 MouseHover 上而不是在标题窗格的 onMouseClick 上上下滑动是多么容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T14:41:47.707

这相当简单，但涉及到连接到每个子窗格的半私有 _buttonWidget 属性，所以我不能保证该工具包的未来版本不会破坏它。也就是说，我已经在 AOL 的 CDN 上测试了 Dojo 1.3 版本。

基本上，在 AccordionContainer 上调用 startup() 后，您只需遍历其子级并将每个子级的 _buttonWidget 连接到匿名 onMouseOver 事件处理程序：

```
aContainer.getChildren().forEach(function(child){
    dojo.connect(child._buttonWidget, "onMouseOver", function(){
        aContainer.selectChild(child);
    });
});

```

完整的例子在[这里](http://www.buyog.com/code/misc/accordion.html)

# javascript - 在 javascript 中检测模态对话框

> ID：917705
> 
> 赞同：2
> 
> 时间：2009-05-27T19:54:26.630
> 
> 标签：javascript, modal-dialog

有没有办法检测页面何时加载到模式对话框中？比如当你调用 window.showModalDialog() 时。

一点背景知识：我正在尝试解决出现在模式对话框中的登录页面的表单身份验证问题，然后是用户登录时网站的其余部分。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T20:17:55.413

对于 window.open 您可以检查您当前所在的页面是否有父页面。

```
function parentExists(){
     return (window.opener != null)? true : false;
} 
```

当您的登录页面加载时调用它。如果它返回 true，则您处于弹出窗口（或模式）中。然后，您可以关闭页面并重定向父级。

对于模态框来说，这有点棘手，因为您无法访问开启器。首先，确保所有模态框都像这样打开：

```
window.showModalDialog('test.htm', self, <optional options>); 
```

这将确保某些内容被传递到窗口的争论中。

现在在您的登录页面上添加以下代码：

```
function parentExists()
{
    var opener = window.dialogArguments;
    return (opener == null)?false:true;
} 
```

编辑：添加了有关模态框的信息

# iphone - UIImage Rotation 自定义度数

> ID：917713
> 
> 赞同：8
> 
> 时间：2009-05-27T19:54:45.040
> 
> 标签：iphone, objective-c, uiimage, image-manipulation

我一直在使用此示例中的代码来提供帮助，并且效果很好。 [http://www.platinumball.net/blog/2009/03/30/iphone-uiimage-rotation-and-mirroring/](http://www.platinumball.net/blog/2009/03/30/iphone-uiimage-rotation-and-mirroring/)

我无法锻炼如何在 0 到 360 之间旋转自定义度数......

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-28T01:29:20.667

你会想做和那篇文章在轮换中所做的几乎一样的事情：

```
CGSize size = sizeOfImage;
UIGraphicsBeginImageContext(size);
CGContextRef ctx = UIGraphicsGetCurrentContext();
CGContextRotateCTM(ctx, angleInRadians);
CGContextDrawImage(ctx, (CGRect){{}, size}, image);

UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
return image; 
```

除了旋转以补偿旋转中心之外，您可能还需要平移 CTM。如果您不想在旋转时裁剪图像的边缘，您应该使用一些基本的触发来增加尺寸。

# c# - 在 WCF 中公开枚举以供客户端使用。WCF/C#/VS-2008

> ID：917715
> 
> 赞同：0
> 
> 时间：2009-05-27T19:55:15.787
> 
> 标签：c#, wcf, enums

这是我的起点[链接文本](http://www.codekeep.net/snippets/0002f271-1418-4027-b19a-3820702fc22f.aspx)，用于公开客户端可以使用的枚举；它不是方法签名的一部分。我的代码可以编译，但我无法查看它，`wsdl`也无法在我的 C# windows 窗体应用程序测试项目中使用它。链接中的测试代码是否缺少某些内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T19:56:35.287

使用[`KnownType`](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.knowntypeattribute.aspx)现有数据协定的属性。

```
[KnownType(typeof(YourEnum))]
[DataContract]
public class FooContract { } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:27:43.350

我关注的链接，[链接文本](http://www.codekeep.net/snippets/0002f271-1418-4027-b19a-3820702fc22f.aspx)给出了这个代码

```
[ServiceKnownType("GetKnownTypes", typeof(EnumHelper))] 
```

如果我把它改成这个

```
[ServiceKnownType("GetKnownTypes", typeof(MyEnumName))] 
```

我的消费客户端能够查看枚举类型。这 ？这就是为什么助手静态类不协助公开枚举的原因。我什至遇到了这个[链接文本](http://msdn.microsoft.com/en-us/library/system.servicemodel.serviceknowntypeattribute.aspx)

# entity-framework - EF4 - POCO 问题

> ID：917718
> 
> 赞同：1
> 
> 时间：2009-05-27T19:55:34.053
> 
> 标签：entity-framework

我只是想首先使用自我跟踪 POCO 方法做一些广泛的模型。但是，我没有让它按我的意愿工作。让我们来个博客。每个博客都有一组条目，每个条目都有一组评论。不幸的是，以下模型对我不起作用。 [替代文字 http://blog.zoolutions.se/issue.png](http://blog.zoolutions.se/issue.png)

POCO 类实现如下所示：

```
public class Blog
{
    public bool Id { get; private set; }
    public string Title { get; set; }
    public bool AllowComments { get; set; }
    public User User { get; set; }
    public IList<Entry> Entries { get; set; }
}

public abstract class Post
{
    public virtual int Id { get; set; }
    public virtual string Header { get; set; }
    public virtual string Text { get; set; }
    public virtual DateTime CreatedAt { get; set; }
    public virtual int UserId { get; set; }
}

public class Entry : Post
{
    public Blog Blog { get; set; }
    public IList<Comment> Comments { get; set; }        
}

public class Comment : Post
{
    public Entry Entry { get; set; }
} 
```

这给了我一个非常奇怪的错误：

> System.Data.MetadataException：指定的架构无效。错误：CLR 类型到 EDM 类型的映射不明确，因为多个 CLR 类型与 EDM 类型“条目”匹配。以前发现CLR类型'Entry'，新发现CLR类型'System.Collections.Generic.Dictionary `2+Entry'. The mapping of CLR type to EDM type is ambiguous because multiple CLR types match the EDM type 'Entry'. Previously found CLR type 'Entry', newly found CLR type 'System.Runtime.CompilerServices.ConditionalWeakTable`2+Entry'。

有什么线索吗？我无法理解该错误消息...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-28T06:51:35.277

在 Beta1 中，CLR 类到 EDM 类型的映射有些不可原谅。

听起来好像这里的问题是发现了多个与所需的“Entry”实体不匹配的“Entry”类。我们应该忽略这些，但在 Beta1 中我们不会，并且您会遇到异常。

我们已经在下一个测试版中对此进行了研究，因此 EF 会继续寻找匹配的类，并且在您的情况下会找到您的 Entry 类，一切都会好起来的。

在 Beta2 发布之前，您可能需要将 Entry 类的名称更改为更独特的名称。

希望这可以帮助

亚历克斯

实体框架团队的项目经理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-12-28T23:43:03.473

无法在 Alex James 的回复下添加此帖子。

EF4 仍然有一个错误，微软已经在 EF 4 Beta 2 中修复了类似的问题。

`local`当具有相似名称的类存储在包含实体的程序集中但属于不同的 EF4`edmx`模型文件时，我遇到了一个错误（例如：当`Country`GeographyConfigurationModel.edmx 和 CustomerServiceModel.edmx 中都存在实体时）。这两个`Country`类在每个模型中包含不同的属性集，并且每个模型都位于单独的项目文件夹中，`entity namespace`指定模型属性（并立即忽略）。

# java - Java：将String []数组元素分配给String？

> ID：917735
> 
> 赞同：1
> 
> 时间：2009-05-27T19:57:53.147
> 
> 标签：java, arrays, string

我对此很陌生，这可能是一个非常明显的答案。在我的 csv 脚本中，我试图弄清楚如何使用 CSVReader 类读取 csv 文件并写入新的 csv 文件。错误告诉我 writeNext(java.lang.String[]) 不能应用于 (java.lang.String)。我尝试使用直接分配和 getString() 方法，但没有任何效果。有任何想法吗？

我有以下代码：已 *更新*

```
public static void main(String[] args) throws IOException {
    //read csv file
    CSVReader reader = new CSVReader(new FileReader(ADDRESS_FILE));

    //write to csv file 
    CSVWriter writer2 = new CSVWriter(new FileWriter("output.csv"), '\t');

    String [] nextLine;
    while ((nextLine = reader.readNext()) != null) {
        System.out.println("Name: [" + nextLine[0] + "]\nAddress: [" + nextLine[1] + "]\nEmail: [" + nextLine[2] + "]");
        String[] newRow = new String[] {nextLine[0],nextLine[2], nextLine[1]};
    }

    //writer2.writeNext(entries);
    writer2.writeAll(newRow);
    writer2.close();

} 
```

错误：c:\java\examples\ETHImport.java:46：找不到符号符号：变量 newRow 位置：类 ETHImport writer2.writeAll(newRow);

1 个错误

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:01:23.857

您需要一个字符串数组，而不是单个字符串。您真的确定要将所有值提取到一个字符串中吗？我希望`writeNext`根据你给它的字符串值写一行，并将*它*放在逗号等中。毕竟，它是一个`CsvWriter`- 它应该用逗号分隔。

在我看来，`writeAll`您已经使用的方法可以满足您的要求，并且`writeNext`只会写一行……您要实现的目标`writeAll`对您没有用吗？为什么要逐行阅读并`entries`首先构建？你不能打电话给：

```
writer2.writeAll(allElements); 
```

我的猜测是，考虑到它的构造方式，它会编写一个*制表符*分隔的文件。`writer2`

编辑：鉴于评论中的其他信息，我怀疑您想要：

*   打开一个`CsvReader`
*   打开一个`CsvWriter`（使用适当的`Writer`和`;`作为构造函数参数）
*   循环读取一行作为字符串数组（使用`CsvReader.readNext()`），为输出创建一个新的字符串数组，然后调用`CsvWriter.writeNext()`将该字符串数组写入文件。
*   关闭`CsvReader`and `CsvWriter`in finally 块（所以如果出现任何问题，它们仍然会关闭）

从现有的字符串数组构建新的字符串数组将类似于（按照您的示例）：

```
String[] newRow = new String[] { oldRow[0], oldRow[2], oldRow[1] }; 
```

那基本上只保留前三列，在第二和第三列之间切换。如果您需要其他列，只需以相同的方式更改它。

请注意，我*不*建议使用`FileWriter`来写入文件 - 使用 a`FileOutputStream`和`OutputStreamWriter`链接到它，因为这可以让您设置字符编码而不是使用平台默认编码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:00:28.477

```
String[] entries = new String[] { "entry1", "entry2"}; 
```

它需要一组条目，而不仅仅是一个字符串。如果您遵循此示例[http://opencsv.sourceforge.net/](http://opencsv.sourceforge.net/)请注意

```
String[] entries = "first#second#third".split("#"); 
```

最后的 split 调用产生一个 String[]。

对于您的代码：

```
public static void main(String[] args) throws IOException {
        //read csv file
        CSVReader reader = new CSVReader(new FileReader(ADDRESS_FILE));

        //write to csv file 
        CSVWriter writer2 = new CSVWriter(new FileWriter("output.csv"), '\t');

        String [] nextLine;
        while ((nextLine = reader.readNext()) != null) {
                writer2.writeNext( new String[] {nextLine[0],nextLine[2], nextLine[1]});
        }

        writer2.close();

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T20:01:13.093

轻松使用`String`a `String[]`：

```
String[] entriesArr = new String[]{ entries }; 
```

或捷径

```
String[] entriesArr = { entries }; 
```

现在`entriesArr`是一个`String[]`包含一个元素，`entries`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:09:55.070

writer.writeNext(String[]) 正在寻找一个数组，然后将其写为 "[0],[1],[2]"

由于您将整个 csv 文件存储为一个字符串，因此您需要拆分该字符串备份。实际上，您不应该将每个项目组合成一个字符串，而是将其存储为代表 csv 文件中每一行的字符串数组。

# php - PHP 清理 url 无需访问 apache 配置

> ID：917750
> 
> 赞同：2
> 
> 时间：2009-05-27T20:01:51.843
> 
> 标签：php, url-rewriting

我知道获取干净 URL 的所有规范方法（www.mysite.com/getarticle?a=123 与 www.mysite.com/getarticle/123）。

这些解决方案主要包括 mod_rewrite、force_type 和各种 apache 配置。

由于我无法在我的共享主机上访问此类配置，是否有任何解决方案/黑客可以解决限制并完成工作？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:07:11.147

是的。

如果你通过 a 调用脚本，`www.example.com/index.php/my/path/here`你可以很容易地从`$_SERVER`. 我个人使用`$_SERVER['PHP_SELF']`，但有几个可供选择，具体取决于您使用的 PHP 版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:10:51.183

只是为了确定 - 你确定你不能使用 mod_rewrite 吗？

如果它已在共享托管服务器上安装/启用，您只需将 .htaccess 文件放在您的 public_html 目录中，其中包含您的重写规则。无需更改实际的 apache 配置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:23:20.957

如果系统无法正确处理它们，则不能使用系统相关的其他 URL。而网络服务器的本机行为是将请求的 URL 路径一对一地映射到文件系统上。

但是大多数 Web 服务器都提供了一些功能来允许这样的事情，在特定规则的帮助下将请求的 URL 路径映射到文件系统上。

例如，Apache 必须[`AcceptPathInfo`](http://httpd.apache.org/docs/2.2/mod/core.html#acceptpathinfo)在已经引用现有文件的 URL 路径之后附加额外的路径段，同时保留该信息（参见`PATH_INFO`环境变量）和[mod_rewrite](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)以获得更多功能。

# sql-server-ce - sql ce 数据库的每个用户密码

> ID：917751
> 
> 赞同：2
> 
> 时间：2009-05-27T20:01:52.247
> 
> 标签：sql-server-ce

是否有密码保护每个用户的 sqlce 数据库？
假设我有两个用户，Mary 和 Sally。Mary 只能访问她的信息，反之亦然。或者我是否必须为每个用户复制数据库并为每个实例提供它自己的密码。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T22:04:42.937

不，SQL CE 不支持任何用户概念。

# c# - C# .net 正则表达式匹配由空格和冒号分隔的文本

> ID：917756
> 
> 赞同：0
> 
> 时间：2009-05-27T20:03:37.067
> 
> 标签：c#, regex

我有以下三句话：

```
000000-00000 日期 第一个文本：something1
200000-00000 时间 第二个文本：something2
234222-34332 struc 第三个文本：somthing3

```

如何编写正则表达式以匹配 (Date|Time|struc) 和冒号 (:)，不包括 (Date|Time|struc)？。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:13:59.307

我怀疑这就是你所追求的。正则表达式部分是：

```
new Regex(@"^\d{6}-\d{5} \w* ([^:]*): ") 
```

这是一个简短但完整的测试程序：

```
using System;
using System.Text.RegularExpressions;

class Test
{   
    static void Main(string[] args)
    {
        Parse("000000-00000 Date First text: something1");
        Parse("200000-00000 Time Second text: something2");
        Parse("234222-34332 struc Third text: somthing3");
    }

    static readonly Regex Pattern = new Regex
        (@"^\d{6}-\d{5} \w* ([^:]*): ");

    static void Parse(string text)
    {
        Console.WriteLine("Input: {0}", text);
        Match match = Pattern.Match(text);
        if (!match.Success)
        {
            Console.WriteLine("No match!");
        }
        else
        {
            Console.WriteLine("Middle bit: {0}", match.Groups[1]);
        }
    }
} 
```

请注意，这并不假定“日期”、“时间”、“结构”是数字之后唯一可能的值，只是它们将由单词字符构成。它还假设您要匹配整行，而不仅仅是中间部分。如果这对您有帮助，那么很容易将其他部分与其他组一起提取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:09:36.617

以下表达式会将您想要的内容捕获到命名组中，`value`不包括`Date`, `Time`, `struc`, 后面的空格和值后面的冒号。

```
(?:Date|Time|struc) (?<value>[^:]*) 
```

此表达式将包括冒号。

```
(?:Date|Time|struc) (?<value>[^:]*:) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:14:35.670

这个：

```
^\d{6}-\d{5} \S+ ([^:]+) 
```

将匹配“第一个文本”、“第二个文本”和“第三个文本”，而不明确引用`(Date|Time|struc)`. 比赛在第 1 组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:17:44.963

如果您是示例，您期望输出为：

第一个文本 第二个文本 第三个文本

您将使用正则表达式

```
(?<=(DATE|TIME|STRUC)\s)[^:]* 
```

我无法想象查看您的示例会非常有用-看起来描述性文本*在*冒号之后，这意味着您真的希望所有内容都放在行尾，即：

```
(?i:(?<=(DATE|TIME|STRUC)\s).*) 
```

[使用 RegexBuddy 进行检查 - 因此，如果我正确解释了您的问题，则此方法有效]

# algorithm - 基于属性将输入数据分类为集合

> ID：917757
> 
> 赞同：2
> 
> 时间：2009-05-27T20:04:23.273
> 
> 标签：algorithm, optimization

问候！

我觉得这个问题与装箱问题有关，也可能与设置分区问题有关……我只是想在我走得太深之前从某人身上反弹。

我有如下输入数据（在数据文件中）：

```
entry_one 55
entry_two 56
entry_three 61
entry_four 62
entry_five 62
entry_six 68
entry_seven 72
entry_eight 73
entry_nine 78
entry_ten 79
entry_eleven 84
entry_twelve 85
entry_thirteen 91
entry_fourteen 92
entry_fifteen 99
entry_sixteen 100
entry_seventeen 121
entry_eighteen 125
entry_nineteen 127
entry_twenty 161 
```

有了这些数据，我希望有一个算法：将条目分组，使得组内条目的关联数值在 X 内（在我的例子中，X 是 16。）例如，一种排列可能是：

```
group one:
 entry_one
 entry_two
 entry_three
 entry_four
 entry_five
 entry_six

group two:
 entry_seven
 entry_eight
 entry_nine
 entry_ten
 entry_eleven
 entry_twelve

group three:
 entry_thirteen
 entry_fourteen
 entry_fifteen
 entry_sixteen

group four:
 entry_seventeen
 entry_eighteen
 entry_nineteen

group five:
 entry_twenty 
```

这种特殊的安排是使用天真的贪心算法实现的，在该算法中，我从最低值（entry_one 的 55）开始，并允许所有低于 55+16 的值成为该组的一部分。然后，我从不属于该组的下一个条目（entry_seven 的 72）开始，并允许所有低于 72+16 的值成为*该*组的一部分（第二组），依此类推。

我相信，虽然一个天真的贪心算法*有效，但它不太可能给我一个最佳的分组/分类，我定义“最佳分组”使得**组*的总数是最小化的（在我的情况下，这是为了工作调度，所以我想尽可能地将类似的工作分组，以尽量减少转换。）

人们可以提出任何想法、模块、算法、示例代码吗？

谢谢！

编辑：我想我应该补充一下这与装箱问题有何不同。在装箱问题中，优化是：“给定这些固定大小的箱，这些固定大小的对象，我怎样才能将这些固定大小的对象中的大部分塞入这些箱中而不会溢出每个箱。” 在我的情况下，我拥有的是*无限*大小但过滤条目的垃圾箱，因此如果一个对象确实“匹配”垃圾箱的签名，它可以插入到所述垃圾箱中，但我们想要的是*最小化*总数我们需要创建的垃圾箱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:52:18.373

1.  从离中点最近的点开始
2.  选择一半范围内的所有值
3.  使用您现有的解决方案在两个方向上进行。
4.  使用原始选择中的每个其他点从步骤 2 开始重复。
5.  选择最佳结果。

* * *

最坏的情况是这是一个问题，因为您可以将步骤 4 替换为“重复所有点”。`O(n`^(`2`)`)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T23:50:29.060

如果我对问题的理解正确，那么贪心算法实际上是最优的。令 G 为贪心解，令 S 为任意解。考虑 G 不同于 S 的第一组。由于 G 是一个贪心解，G 的组大于 S 的组。例如，

```
G : [1, 2, 3][4, 5, 6, 7][8, 9, 10][11, 12]...
S : [1, 2, 3][4, 5, 6][7, 8, 9][10, 11, 12]... 
```

我们可以从 S 推导出一个新的解决方案 S'，它在更长的前缀上与 G 一致，而无需引入新的组。只是从下一组偷一些物品。结果组是有效的，因为一个已经在 G 中，而另一个是有效组的子组。

```
S': [1, 2, 3][4, 5, 6, 7][8, 9][10, 11, 12]... 
```

通过归纳，可以得出 G 实际上是最优的。

# c# - 用户控件作为 TabItem

> ID：917759
> 
> 赞同：3
> 
> 时间：2009-05-27T20:04:58.187
> 
> 标签：c#, wpf, user-controls

我一直在玩 WPF，但我不确定我想做的事情是否可行。那么是否有可能有一个描述tabitem的用户控件？我试过但没有成功。

现在我对内容使用用户控件，但我想将其更改为更通用。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T20:50:24.287

你可以：

1) 将 a`UserControl`放在 a 内`TabItem`：

```
<TabControl>
    <TabItem>
        <local:MyUserControl/>
    </TabItem>
</TabControl> 
```

2）继承自`TabItem`而不是`UserControl`：

```
public class MyTabItem : TabItem { ... }

<TabControl>
    <local:MyTabItem/>
</TabControl> 
```

# google-calendar-api - 在 Google 日历之上构建日历服务

> ID：917761
> 
> 赞同：9
> 
> 时间：2009-05-27T20:05:10.433
> 
> 标签：google-calendar-api

我正在构建一个带有日历元素的应用程序。我正在考虑使用 Google 日历 API 构建我的应用程序。API 是我梦寐以求的在不同 Google 帐户拥有的日历之间进行交互的一切。但是，同一 Google 帐户拥有的日历之间的灵活性并不明显。

我希望能够仅使用 1 个 Google 帐户来保存应用程序的所有日历。在此帐户中，我想为我网站的每个用户创建 1 个日历。我希望我的用户能够创建个人事件并能够彼此共享它们。

**有没有办法在同一个 Google 帐户拥有的多个 Google 日历之间共享活动？**

不受欢迎的替代品：

1.  创建和管理重复条目。我宁愿不必使用像创建重复条目这样的技巧——这只是在所有者更改事件属性时提出问题。另外，我需要额外的逻辑来阻止非所有者编辑事件，因为他们在技术上是他们副本的所有者。

    *   另一种选择是让每个人都有一个实际的 Google 帐户。这至少有两个问题：

    *   如果他们使用自己的帐户，除非他们给我他们的登录凭据，否则我无法直接管理他们的日历。在很多层面上，这是一种可怕的做法。

    *   我可以让他们使用真正的 Google 帐户所需的信息注册到我的网站，完成提供 CAPTCHA 并在我的网站将管理的幕后为每个用户创建一个新的 Google 帐户，但我只是阅读了 Google 帐户服务条款这可能会违反第 5.3 和 10.2 节，具体取决于它们的解释方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-28T19:58:45.673

您的“不受欢迎的替代方案#2”并不是那么不受欢迎，因为 Google 支持 OpenID/OpenAuth 协议。这意味着用户不仅可以使用 Google 凭据登录您的服务，还可以授予您访问她的 Google 日历的权限。

在任何情况下，您都不必在幕后创建 Google 帐户。有关更多信息，请查看谷歌的 openid 页面

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-29T19:04:19.620

你想使用#2。

使用 Google OpenID 来验证他们是否拥有特定的 google 帐户。使用 OpenAuth 获取添加和删除事件的权限。

更好 - 只需在您的应用程序中构建日历事件并公开 iCal 提要。这样人们就可以在任意数量的其他应用程序中使用这些日历。

# iphone - 水平滚动在three20项目的tabBar中不起作用？

> ID：917765
> 
> 赞同：0
> 
> 时间：2009-05-27T20:05:35.767
> 
> 标签：iphone, objective-c, cocoa-touch, three20

我正在使用 Joe Hewitt 的three20 开源项目。

在 UITableViewController 中有以下代码：

```
_tabBar1 = [[TTTabStrip alloc] initWithFrame:CGRectMake(0, 0, 320, 41)];
_tabBar1.tabItems = [NSArray arrayWithObjects:
                [[[TTTabItem alloc] initWithTitle:@"item1"] autorelease],
                [[[TTTabItem alloc] initWithTitle:@"item2"] autorelease],
                [[[TTTabItem alloc] initWithTitle:@"item3"] autorelease],
                [[[TTTabItem alloc] initWithTitle:@"item4"] autorelease],
                [[[TTTabItem alloc] initWithTitle:@"item5"] autorelease],
                [[[TTTabItem alloc] initWithTitle:@"item6"] autorelease],                   nil];
self.tableView.tableHeaderView= _tabBar1; 
```

除了 TabBarStrip 不会水平滚动之外，一切似乎都运行良好？知道为什么会发生这种情况以及任何可能的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-25T13:52:53.343

这是我做错的：

在项目设置中，在其他链接器标志下，我没有添加“all_load”，我只添加了“ObjC”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:16:51.563

`TTTabStrip`Three20 源代码中不再提供。您可能希望将代码迁移到新`TTTabBar`类。

你知道`TTTabStrip`视图是否意味着水平滚动？在标签条中拥有如此多的项目似乎对于像 iPhone 这样的设备来说过于复杂的用户界面。

# sql-server - 我真的需要使用“SET XACT_ABORT ON”吗？

> ID：917773
> 
> 赞同：27
> 
> 时间：2009-05-27T20:08:06.493
> 
> 标签：sql-server, sql-server-2005, error-handling, transactions

如果您小心并在所有内容中使用 TRY-CATCH 并回滚错误，您真的需要使用：

```
SET XACT_ABORT ON 
```

换句话说，TRY-CATCH 是否会错过 SET XACT_ABORT ON 将处理的任何错误？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-28T05:15:10.333

请记住，无论有没有 .TRY-CATCH 都不会捕获错误`XACT_ABORT`。

但是，[`SET XACT_ABORT ON`](http://msdn.microsoft.com/en-us/library/ms188792.aspx)不影响捕获错误。它确实保证了任何事务都会回滚/注定失败。当“关闭”时，您仍然可以选择提交或回滚（取决于 xact_state）。这是 SQL 2005 的主要行为变化`XACT_ABORT`

如果客户端命令超时启动并且客户端发送“中止”指令，它还可以删除锁等。如果没有`SET XACT_ABORT`，如果连接保持打开状态，锁可以保持不变。我的同事（MVP）和我在年初进行了彻底的测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T23:22:23.590

我相信 SET XACT_ABORT ON 是执行分布式事务时的要求。

[来自在线书籍：](http://msdn.microsoft.com/en-us/library/ms188792.aspx) 对于大多数 OLE DB 提供程序（包括 SQL Server）的隐式或显式事务中的数据修改语句，必须将 XACT_ABORT 设置为 ON。唯一不需要此选项的情况是提供程序支持嵌套事务。有关详细信息，请参阅分布式查询和分布式事务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-10T10:08:49.420

`XACT_ABORT`我的理解是，即使使用了 try catch 并且在 catch 块中没有使用回滚语句，任何不可提交的事务都会在为 ON时回滚。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-09-16T13:26:18.733

有一个警告总是盲目地使用`SET XACT_ABORT ON`; 最近把我烧了。

我在 StackOverflow 上读到了一个令人信服的论点，建议您*应该*始终使用`XACT_ABORT ON`. 我更改了系统以在连接期间设置该选项。除了它会导致数据损坏和很多*痛苦*。

```
begin transaction
try
    perform insert
    catch duplicate key violation and react appropriately

    perform more actions

    commit transaction
catch
    rollback transaction
end 
```

除了您的*“更多操作”*将不再发生在事务中。因为即使您发现了**重复的密钥违规**，服务器也不再处于事务中：

```
begin transaction
try
    perform insert
    catch duplicate key violation and react appropriately
    transaction implicitly rolled back

    perform more actions

    commit transaction -> fails because not in a transaction
catch
    rollback transaction -> fails because not i a transaction
end 
```

我已经扭转了自己。**永远不要**使用`SET XACT_ABORT ON`.

* * *

**编辑**：人们似乎认为问题出在尝试`ROLLBACK TRANSACTION`在未进行交易时调用。`ROLLBACK`他们认为，如果交易没有进行，不打电话就可以解决问题。

让我们使用一些伪代码，更改名称以保护 NDA：

```
const
   SQLNativeErrorPrimaryKeyViolation = 2627; //Primary keys. 2601 is for other unique index

void x(String sql)
{
   database.Connection.ExecuteNoRecords(sql);
} 
```

这是一种使这个答案更具可读性的迂腐方法；我们`x`用来表示一些 SQL 语句的执行：

```
void DoStuff()
{
   x("BEGIN TRANSACTION");
   try
   {
      try
      {
         x("INSERT INTO Patrons (AccountNumber, Name, Gender)"+
           "VALUES (619, 'Shelby Jackson', 'W'"); 
      } 
      catch (ESqlServerException e)
      {
         //check if the patron already exists (or some other hypothetical situation arises)
         if (e.NativeError == SQLNativeErrorPrimaryKeyViolation)
         {
            //This patron already exists. Set their frob to grob because contoso the blingblong
            x("UPDATE Patrons SET Frob='Grob' WHERE AccountNumber = 619");

            //20110918: Dont forget we also need to bang the gardinker
            x("EXECUTE BangTheGardinker @floof=619");
         }
         else
            throw e;
      }

      //Continue with the stuff
      x("EXECUTE Frob('{498BBB4D-D9F7-4438-B7A6-4AB5D57937C0}')");

      //All done, commit the transaction
      x("COMMIT TRANSACTION");       
   }
   catch (Exception e)
   {
      //Something bad happened, rollback the transaction 
      //(if SQL Server didn't kill the transaction without our permission)
      x("IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION");

      throw e;
   }
} 
```

## XACT_ABORT ON 很酷，让我们使用它

因此，该代码有效。**如果出现我们预期**的错误，我们会处理它并继续。这称为*处理错误*。如果发生一些**未知**的异常（我们没有预料到的事情），我们`rollback`可能会进行任何交易。

现在让我们看看我们是否盲目地遵循`XACT_ABORT`应该始终启用的建议：

```
 DbConnection Connection()
 {
    if (_connection == null)
    {
       _connection = new SqlConnection();

       //It is generally recommended that you always have xact_abort on.
       //If a connection is closed with a transaction still in progress
       //it still leaves locks held until that connection is finally recycled
       //Also, when querying linked severs in a client-side transaction, the
       //operation won't work until xact_abort is on (SQL Server will throw an saying xactabort is off
       _connection.ExecuteNoRecords("SET XACT_ABORT ON");
    }

    return _connection;
 }

void x(String sql)
{
   database.Connection.ExecuteNoRecords(sql);
} 
```

## 您看到**DoStuff**中会导致的损坏吗？

**DoStuff**被正确编写以处理错误情况。但是现在引入`XACT_ABORT ON`连接会导致数据库损坏。对于那些没有看到错误的人，让我们看一下代码：

```
void DoStuff()
{
   x("BEGIN TRANSACTION");
   try
   {
      try
      {
         x("INSERT INTO Patrons (AccountNumber, Name, Gender)"+
           "VALUES (619, 'Shelby Jackson', 'W'"); 

      } 
      catch (ESqlServerException e)
      {
         //WARNING: WE ARE NO LONGER OPERATING IN A TRANASCTION
         //Because XACT_ABORT is on, the transaction that we started has been implicitly rolled back.
         //From now on, we are no longer in a transaction. If another error happens
         //the changes we make cannot be rolled back

         //check if the patron already exists (or some other hypothetical situation arises)
         if (e.NativeError == SQLNativeErrorPrimaryKeyViolation)
         {
            //WARNING: This update happens outside of any transaction!
            //This patron already exist. Set their frob to grob because contoso the blingblong
            x("UPDATE Patrons SET Frob='Grob' WHERE AccountNumber = 619");

            //WARNING: This stored procedure happens outside of any transaction!
            //20110918: Dont forget we also need to bang the gardinker
            x("EXECUTE BangTheGardinker @floof=619");
         }
         else
            throw e;
      }

      //WARNING: This stored procedure happens outside of any transaction!
      //If any error happens from
      //Continue with the stuff
      x("EXECUTE Frob('{498BBB4D-D9F7-4438-B7A6-4AB5D57937C0}')");

      //WARNING: This stored procedure happens outside of any transaction. It will throw:
      //   Msg 3902, Level 16, State 1, Line 1
      //   The COMMIT TRANSACTION request has no corresponding BEGIN TRANSACTION.
      //All done, commit the transaction
      x("COMMIT TRANSACTION");       
   }
   catch (Exception e)
   {
      //If there was an error during Frob, we would want to catch it and roll everything back.
      //But since SQL Server ended the transaction, we have no way to rollback the changes

      //And even if the call to Frob (or Updating the patron's Grob, or Banging the Gardinder)
      //didn't fail, the call to COMMIT TRANSACTION will throw an error

      //Either way, we have detected an error condition that cannot be rolled back in the database

      //Something bad happened, rollback the transaction 
      //(if SQL Server didn't kill the transaction without our permission)
      x("IF @@TRANCOUNT > 0 ROLLBACK TRANSACTION");

      throw e;
   }
} 
```

正确编写且有效的代码会损坏，导致错误，最坏的情况是导致数据库损坏。都是因为我打开了`XACT_ABORT ON`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-29T11:49:46.710

XACT_ABORT 确实会影响错误处理：当遇到错误时，它将中止整个批处理，并且产生错误的行后面的任何代码（包括错误检查！）将永远不会执行。此行为有两个例外：XACT_ABORT 被 TRY...CATCH 取代（CATCH 块将始终执行，事务不会自动回滚，只会呈现为不可提交），XACT_ABORT 将忽略 RAISERROR。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-18T08:45:43.970

当 XACT_ABORT 在触发器中设置为 OFF 并且我在触发器主体中调用 RAISEERROR 时，更改不会回滚。

# java - java正则表达式支持非ascii值吗？

> ID：917774
> 
> 赞同：2
> 
> 时间：2009-05-27T20:08:22.187
> 
> 标签：java, regex

我们有一个当前方法可以清除不是字母或空格的字符，这很简单

```
String clean(String input)
{
   return input==null?"":input.replaceAll("[^a-zA-Z ]","");
} 
```

确实应该修复它以支持非英语字符（例如 ś,ũ, ... ）。不幸的是，java regex 类（例如 "\W" -A non-word character, "\p{Alpha}" -US-ASCII only}.）似乎不支持这一点。有没有办法用 java 正则表达式来做到这一点，而不是通过每个字符手动循环来测试它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T20:12:00.387

Java 6 Pattern 处理 Unicode，请参阅[此文档](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html)。

> Unicode 转义序列（如 Java 源代码中的 \u2014）按照 Java 语言规范第 3.3 节中的描述进行处理。此类转义序列也由正则表达式解析器直接实现，因此 Unicode 转义可用于从文件或键盘读取的表达式中。因此，字符串“\u2014”和“\\u2014”虽然不相等，但编译成相同的模式，匹配十六进制值为 0x2014 的字符。
> 
> Unicode 块和类别是用 Perl 中的 \p 和 \P 结构编写的。如果输入具有属性 prop，则 \p{prop} 匹配，而如果输入具有该属性，则 \P{prop} 不匹配。块用前缀 In 指定，如 InMongolian。可以使用可选前缀 Is 指定类别：\p{L} 和 \p{IsL} 都表示 Unicode 字母的类别。块和类别可以在字符类的内部和外部使用。

# reference - SAS 袖珍参考

> ID：917778
> 
> 赞同：3
> 
> 时间：2009-05-27T20:09:02.437
> 
> 标签：reference, sas

我正在寻找提供 SAS 过程/语句列表的 SAS 袖珍参考。我不想要每个程序的详细解释——只是一个程序列表，也许是一个简短的描述，以便记忆。与每个过程关联的语句的子列表会很有帮助。类似于 O'Reilly “HTML 和 XHTML 袖珍参考”或“CSS 袖珍参考”的内容，但对于 SAS，将是最有益的。实体书更可取，但符合标准的在线资源也是可以接受的。

我目前有 The Little SAS Book (by Delwiche and Slaughter)，它是一个很好的资源，但它不是我想要的快速参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:36:00.183

我认为这正是您正在寻找的：

Rick Aster 的专业 SAS 程序员袖珍参考（平装本）

[http://www.amazon.com/Professional-SAS-Programmers-Pocket-Reference/dp/1891957023](https://rads.stackoverflow.com/amzn/click/com/1891957023)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:40:22.343

我不确定这是否*正是*您正在寻找的，但这里是[按名称](http://support.sas.com/documentation/cdl/en/allprodsproc/61917/HTML/default/a003135046.htm)或[按产品](http://support.sas.com/documentation/cdl/en/allprodsproc/61917/HTML/default/a003178332.htm)列出的程序列表。可能是一个方便的书签。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T01:49:01.843

文档中曾经有一张方便的参考卡，但随着 PROC 的数量和 PROC 上的选项的增加，它们并不实用。

# mediawiki - Mediawiki的AdminSettings.php的格式是什么

> ID：917782
> 
> 赞同：2
> 
> 时间：2009-05-27T20:10:12.730
> 
> 标签：mediawiki

我正在尝试运行 dumpBackup.php 并且我得到了

```
php dumpBackup.php  --current
DB connection error: Unknown error 
```

我的理解是我需要将文件 AdminSettings.sample 复制到 .php。但我似乎没有这样的文件。它的格式是什么。可能看错了地方，但所有参考资料都引用了示例文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T23:12:00.303

您应该在您的 MediaWiki 安装的根目录中找到 AdminSettings.sample - 在与 LocalSettings.php 相同的目录中，即“维护”目录的上一级目录。

细节：

*   [http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/AdminSettings.sample?view=markup](http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/AdminSettings.sample?view=markup)
*   [http://www.mediawiki.org/wiki/Manual:AdminSettings.php](http://www.mediawiki.org/wiki/Manual:AdminSettings.php)

# c - 如何在 C 中使用动态多维数组？

> ID：917783
> 
> 赞同：64
> 
> 时间：2009-05-27T20:10:16.613
> 
> 标签：c, arrays, dynamic

有人知道我如何使用 C 来使用动态分配的多维数组吗？那可能吗？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-10-09T18:16:10.017

从 C99 开始，C 就有了带有动态边界的二维数组。如果你想避免这样的野兽被分配在堆栈上（你应该这样做），你可以轻松地一次性分配它们，如下所示

```
double (*A)[n] = malloc(sizeof(double[n][n])); 
```

就是这样。然后，您可以轻松使用它，因为您用于 2D 数组，例如`A[i][j]`. 别忘了最后那个

```
free(A); 
```

Randy Meyers 撰写了一系列解释[*可变长度数组*(VLA)](http://www.drdobbs.com/the-new-cwhy-variable-length-arrays/184401444)的文章。

* * *

## 回答 #2

> 赞同：83
> 
> 时间：2009-05-27T20:19:00.793

通过动态分配，使用 malloc：

```
int** x;

x = malloc(dimension1_max * sizeof(*x));
for (int i = 0; i < dimension1_max; i++) {
  x[i] = malloc(dimension2_max * sizeof(x[0]));
}

//Writing values
x[0..(dimension1_max-1)][0..(dimension2_max-1)] = Value; 
[...]

for (int i = 0; i < dimension1_max; i++) {
  free(x[i]);
}
free(x); 
```

`dimension1_max`这分配了一个大小为*的二维数组`dimension2_max`。因此，例如，如果您想要一个 640*480 数组（图像的 fe 像素），请使用`dimension1_max`= 640, `dimension2_max`= 480。然后您可以使用`x[d1][d2]`where `d1`= 0..639, `d2`= 0..479 访问该数组。

但是在 SO 或 Google 上的搜索也揭示了其他可能性，例如[在这个 SO question](https://stackoverflow.com/questions/365782/how-do-i-best-handle-dynamic-multi-dimensional-arrays-in-c-c)

请注意，在这种情况下，您的数组不会分配连续的内存区域（640*480 字节），这可能会给假设这种情况的函数带来问题。因此，要使数组满足条件，请将上面的 malloc 块替换为：

```
int** x;
int* temp;

x = malloc(dimension1_max * sizeof(*x));
temp = malloc(dimension1_max * dimension2_max * sizeof(x[0]));
for (int i = 0; i < dimension1_max; i++) {
  x[i] = temp + (i * dimension2_max);
}

[...]

free(temp);
free(x); 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2009-05-27T21:34:12.560

## 基本

c 中的数组是使用`[]`运算符声明和访问的。以便

```
int ary1[5]; 
```

声明一个由 5 个整数组成的数组。元素从零开始编号，因此`ary1[0]`第一个元素`ary1[4]`是最后一个元素。注意1：没有默认初始化，所以数组占用的内存最初可能包含*任何东西*。注意2：`ary1[5]`以未定义的状态访问内存（您甚至可能无法访问），所以不要这样做！

多维数组被实现为数组的数组（数组 (of ... ) ）。所以

```
float ary2[3][5]; 
```

声明一个由 3 个一维数组组成的数组，每个数组包含 5 个浮点数。Now`ary2[0][0]`是第一个数组的第一个元素，是第一个数组`ary2[0][4]`的最后一个元素，并且`ary2[2][4]`是最后一个数组的最后一个元素。'89 标准要求此数据是连续的（我的 K&R 第 2 版第 216 页上的第 A8.6.2 节），但似乎与填充无关。

## 试图在不止一个维度上动态化

如果您在编译时不知道数组的大小，则需要动态分配数组。很想尝试

```
double *buf3;
buf3 = malloc(3*5*sizeof(double));
/* error checking goes here */ 
```

如果编译器不填充分配（在一维数组之间粘贴额外的空间），这应该可以工作。使用以下方法可能更安全：

```
double *buf4;
buf4 = malloc(sizeof(double[3][5]));
/* error checking */ 
```

但无论哪种方式，诀窍都是在取消引用时间。你不能写`buf[i][j]`，因为`buf`类型错误。也不能用

```
double **hdl4 = (double**)buf;
hdl4[2][3] = 0; /* Wrong! */ 
```

因为编译器期望`hdl4`是双精度地址的地址。你也不能使用`double incomplete_ary4[][];`，因为这是一个错误；

所以，你可以做什么？

*   自己做行列算术
*   在一个函数中分配和完成工作
*   使用指针数组（qrdl 所说的机制）

## 自己做数学

只需像这样计算每个元素的内存偏移量：

```
 for (i=0; i<3; ++i){
     for(j=0; j<3; ++j){
        buf3[i * 5 + j] = someValue(i,j); /* Don't need to worry about 
                                             padding in this case */
     }
  } 
```

## 在一个函数中分配和完成工作

定义一个将所需大小作为参数的函数并正常进行

```
void dary(int x, int y){
  double ary4[x][y];
  ary4[2][3] = 5;
} 
```

当然，在这种情况下`ary4`是一个局部变量，你不能返回它：数组的所有工作都必须在你调用的函数或*它*调用的函数中完成。

## 指针数组

考虑一下：

```
double **hdl5 = malloc(3*sizeof(double*));
/* Error checking */
for (i=0; i<3; ++i){
   hdl5[i] = malloc(5*sizeof(double))
   /* Error checking */
} 
```

现在`hdl5`指向一个指针数组，每个指针都指向一个双精度数组。很酷的一点是，您可以使用二维数组表示法来访问这个结构——`hdl5[0][2]`获取第一行的中间元素——但这与二维对象完全不同声明的数组`double ary[3][5];`。

这种结构比二维数组更灵活（因为行不必是相同的长度），但访问它通常会更慢并且需要更多内存（你需要一个地方来保存中间指针）。

请注意，由于我没有设置任何守卫，您必须自己跟踪所有数组的大小。

## 算术

c 不支持向量、矩阵或张量数学，你必须自己实现它，或者引入一个库。

乘法器的乘法以及相同等级的数组的加法和减法很容易：只需循环遍历元素并随时执行操作。内部产品同样直截了当。

外部产品意味着更多的循环。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2012-10-09T18:19:50.810

如果您在编译时知道列数，那很简单：

```
#define COLS ...
...
size_t rows;
// get number of rows
T (*ap)[COLS] = malloc(sizeof *ap * rows); // ap is a *pointer to an array* of T 
```

您可以`ap`像对待任何二维数组一样对待：

```
ap[i][j] = x; 
```

完成后，您将其释放为

```
free(ap); 
```

如果您在编译时不知道列数，但您正在使用支持可变长度数组的 C99 编译器或 C2011 编译器，它仍然非常简单：

```
size_t rows;
size_t cols;
// get rows and cols
T (*ap)[cols] = malloc(sizeof *ap * rows);
...
ap[i][j] = x;
...
free(ap); 
```

如果您在编译时不知道列数，并且您正在使用不支持可变长度数组的 C 版本，那么您需要做一些不同的事情。如果您需要将所有元素分配在一个连续的块中（如常规数组），那么您可以将内存分配为一维数组，并计算一维偏移：

```
size_t rows, cols;
// get rows and columns
T *ap = malloc(sizeof *ap * rows * cols);
...
ap[i * rows + j] = x;
...
free(ap); 
```

如果不需要内存是连续的，可以按照两步分配方法：

```
size_t rows, cols;
// get rows and cols
T **ap = malloc(sizeof *ap * rows);
if (ap)
{
  size_t i = 0;
  for (i = 0; i < cols; i++)
  {
    ap[i] = malloc(sizeof *ap[i] * cols);
  }
}

ap[i][j] = x; 
```

由于分配是一个两步过程，释放也需要是一个两步过程：

```
for (i = 0; i < cols; i++)
  free(ap[i]);
free(ap); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T16:18:29.227

malloc 会做。

```
 int rows = 20;
 int cols = 20;
 int *array;

  array = malloc(rows * cols * sizeof(int)); 
```

请参阅以下文章以获取帮助：-

[http://courses.cs.vt.edu/~cs2704/spring00/mcquain/Notes/4up/Managing2DArrays.pdf](http://courses.cs.vt.edu/~cs2704/spring00/mcquain/Notes/4up/Managing2DArrays.pdf)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-31T21:18:13.300

这是定义一个子例程的工作代码，用于`make_3d_array`分配一个多维 3D 数组，其中`N1`,`N2`和`N3`每个维度中的元素，然后用随机数填充它。您可以使用符号`A[i][j][k]`来访问其元素。

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

// Method to allocate a 2D array of floats
float*** make_3d_array(int nx, int ny, int nz) {
    float*** arr;
    int i,j;

    arr = (float ***) malloc(nx*sizeof(float**));

    for (i = 0; i < nx; i++) {
        arr[i] = (float **) malloc(ny*sizeof(float*));

        for(j = 0; j < ny; j++) {
            arr[i][j] = (float *) malloc(nz * sizeof(float));
        }
    }

    return arr;
} 

int main(int argc, char *argv[])
{
    int i, j, k;
    size_t N1=10,N2=20,N3=5;

    // allocates 3D array
    float ***ran = make_3d_array(N1, N2, N3);

    // initialize pseudo-random number generator
    srand(time(NULL)); 

    // populates the array with random numbers
    for (i = 0; i < N1; i++){
        for (j=0; j<N2; j++) {
            for (k=0; k<N3; k++) {
                ran[i][j][k] = ((float)rand()/(float)(RAND_MAX));
            }
        }
   }

    // prints values
    for (i=0; i<N1; i++) {
        for (j=0; j<N2; j++) {
            for (k=0; k<N3; k++) {
                printf("A[%d][%d][%d] = %f \n", i,j,k,ran[i][j][k]);
            }
        }
    }

    free(ran);
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-10-09T16:22:37.057

没有办法一次性分配所有的东西。相反，创建一个指针数组，然后为每个指针创建内存。例如：

```
int** array;
array = (int**)malloc(sizeof(int*) * 50);
for(int i = 0; i < 50; i++)
    array[i] = (int*)malloc(sizeof(int) * 50); 
```

当然，你也可以将数组声明为`int* array[50]`并跳过第一个malloc，但需要第二组才能动态分配所需的存储空间。

可以通过一个步骤破解一种分配它的方法，但它需要一个自定义查找函数，但是以一种始终有效的方式编写它可能会很烦人。一个例子可以是`L(arr,x,y,max_x) arr[(y)*(max_x) + (x)]`，然后 malloc 一个 50*50 整数块或其他任何东西，并使用该`L`宏进行访问，例如

```
#define L(arr,x,y,max_x) arr[(y)*(max_x) + (x)]

int dim_x = 50;
int dim_y = 50;

int* array = malloc(dim_x*dim_y*sizeof(int));

int foo = L(array, 4, 6, dim_x); 
```

但这更糟糕，除非您知道使用预处理器宏所做的事情的影响。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2012-10-09T16:47:00.387

```
int rows, columns;
/* initialize rows and columns to the desired value */

    arr = (int**)malloc(rows*sizeof(int*));
        for(i=0;i<rows;i++)
        {
            arr[i] = (int*)malloc(cols*sizeof(int));
        } 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2019-07-14T05:56:09.310

// 使用 new 而不是 malloc，因为使用 malloc 会导致内存泄漏 `在此处输入代码

```
 int **adj_list = new int*[rowsize];       
    for(int i = 0; i < rowsize; ++i)    
    {

        adj_list[i] = new int[colsize];

    } 
```

# java - 带有任意 C 代码的 Java 原生接口

> ID：917789
> 
> 赞同：4
> 
> 时间：2009-05-27T20:11:27.470
> 
> 标签：java, c, java-native-interface

我有一个提供的 .dll，我需要使用 java 与它交互。

我是否必须重写 C 才能使用 jni.h 中提供的 JNI 类型？如 java sun 的 jni 示例所示。否则，我如何声明我的 java 函数的本机函数来传递和接收指针？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T20:30:47.917

您可能会发现[JNA](https://github.com/twall/jna/)很有用

“JNA 使 Java 程序可以轻松访问本机共享库（Windows 上的 DLL），而无需编写 Java 代码以外的任何内容 - 不需要 JNI 或本机代码。此功能可与 Windows 的 Platform/Invoke 和 Python 的 ctypes 相媲美。访问在运行时是动态的无需代码生成。”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T20:20:43.257

在某种程度上，是的。

大多数时候，您只需要编写一个小的“包装器”dll，其中的函数可以进行类型转换并委托给“真实”DLL 中的相应函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T20:25:40.640

您当然可以重写 C 代码，但为 C 代码编写包装器（技术上，使用[Facade](http://en.wikipedia.org/wiki/Facade_pattern)或[Bridge](http://en.wikipedia.org/wiki/Bridge_pattern)模式）并不少见。您在 Java 中编写符合您期望的代码，并让该代码调用您现有的 C 代码。

# java - 来自无状态会话 bean 的 FileIO

> ID：917795
> 
> 赞同：2
> 
> 时间：2009-05-27T20:12:31.337
> 
> 标签：java, jboss

我需要从运行在 JBoss 中的无状态会话 bean 读取 xml 文件并将其写入磁盘。这样做的首选方法是什么？

现在我们正在使用 java.io 类访问文件系统。

我找到了一个简单的文件系统 RAR 示例，并且可以正常工作，但它可能比直接使用 java.io 更容易出错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:25:52.887

如果您检查[EJB 规范的](http://java.sun.com/products/ejb/docs.html)*编程限制*部分，您会发现以下内容：

> 企业 bean 不得使用 java.io 包来尝试访问文件系统中的文件和目录。

如果您能找到一种更好、可能更安全、更重要的是交易方式，请重新考虑。我们有一个系统将 PDF 文档作为 blob 存储在数据库中，然后通过电子邮件或 servlet 将它们提供给用户。

基于 JBoss JCA 的 FSManagedConnectionFactory 还不错。它基于 JNDI，并且可能在更多实例中工作，而不仅仅是围绕 java.io 进行黑客攻击

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:17:10.143

如果您正确关闭文件并清理，您可以使用任何您想要的东西。我会使用 XML 解析器来读取或写入 XML 文件，但它更安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:32:13.623

复杂的方法是编写一个读取文件的 ejb 客户端，或者以某种方式设置一个 xml 数据源。实际上，如果您在会话 bean 中使用 java.io，则不会发生任何不好的事情。但是，如果您正在使用集群和/或将迁移服务器，那么您必须注意您的 bean 在哪里运行以及将调用哪一个。

最简单的“批处理”解决方案是从集群中取出一台机器并在其中运行“批处理”应用程序。

# iphone - 找不到适用于 iPhone 的 CoreAudio.h

> ID：917797
> 
> 赞同：0
> 
> 时间：2009-05-27T20:13:14.283
> 
> 标签：iphone

我正在尝试将一个为 Mac 编写的应用程序移植到 iPhone 设备上。但是，我得到编译错误

# import CoreAudio/CoreAudio.h // 没有这个文件

你能告诉我如何解决吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T22:23:52.057

该错误非常具体，iPhone 应用程序没有 CoreAudio.h 之类的文件，这就是编译器找不到它的原因。你不能让 Xcode 找到它，因为它不存在。

因此，注释掉该行可以解决问题。

假设您实际上使用的是 CoreAudio，应用程序编译的原因是因为您确实包含了正确的标头。

# regex - 简单的 SED 命令

> ID：917798
> 
> 赞同：2
> 
> 时间：2009-05-27T20:13:14.877
> 
> 标签：regex, sed

我有一份来自我们使用的程序的 html 报告。它非常简单的 html 和 id 喜欢稍微修复它。

我需要在 sed 中执行什么代码来替换

```
<html>  with

<html><link rel="stylesheet" type="text/css" href="LivingInStyle.css"> 
```

谢谢，拉斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T20:18:00.593

```
sed 's/<html>/<html><link rel="stylesheet" type="text\/css" href="LivingInStyle.css">/g' file.html 
```

这会将新文件输出到控制台，您可以将其重定向到您需要的任何地方。或者您可以使用 -i 就地编辑。

编辑：忘记逃避斜线

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T20:24:29.440

您还可以使用：

```
sed -e 's!<html>!<html><link rel="stylesheet" type="text/css" href="LivingInStyle.css">!' < file 
```

即使用另一个分隔符而不是转义斜线。

# web-applications - 当我遵循 Web 编程的标准实践时，我的应用程序会自动 RESTful 吗？

> ID：917800
> 
> 赞同：2
> 
> 时间：2009-05-27T20:13:27.700
> 
> 标签：web-applications, rest

当我使用 GET 仅检索和显示信息，并使用 POST 创建、更新、删除时，我的 Web 应用程序会自动 RESTful 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:15:58.960

不，因为 REST 思想提供了以下映射：

```
GET - Retrieve
POST - Create
PUT - Update
DELETE - Destroy 
```

浏览器通常不支持这些 html 操作（PUT 和 DELETE）中的 2 个，因此 REST 框架倾向于使用一些捏造来允许它们通过浏览器。

在创建 RESTful 应用程序时也有很多设计理念，因此实际上不可能拥有“自动”宁静的东西。一些团体之间也有很多关于 REST 实际需要什么的讨论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T20:17:49.843

它会更接近，但不是完全 RESTful。

1.  最重要的是，您需要确保所有必要的状态都通过 URI 表示进行传输。（这就是为什么它是“代表性状态转移”。）

2.  在您的操作中使用其他 HTML 方法更为常见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T18:15:39.643

不，REST 与 HTTP 无关，它与协议无关。正确使用 HTTP 之类的协议（除了绕过其实现被破坏的地方，例如缺乏 PUT 支持等）是必要的，但不足以成为 RESTful。

# objective-c - NSTextFieldCell 代表？

> ID：917810
> 
> 赞同：10
> 
> 时间：2009-05-27T20:16:25.837
> 
> 标签：objective-c, cocoa

我在表格视图中有一个文本字段单元格，当它结束编辑时我需要知道它。我以为我会把我的Controller类设置为文本字段单元格的委托，然后使用NSTextField的委托方法textDidEndEditing:，但是意识到文本字段单元格似乎没有委托方法？为什么会这样，我可以做什么（除了子类化）在编辑完成时得到通知？

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T20:39:41.533

`NSTextFieldCell`继承自`NSCell`（好吧，从技术上讲`NSActionCell`，继承自`NSCell`）。该类`NSCell`用于（来自[文档](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSCell_Class/Reference/NSCell.html)）：

> NSCell 类**提供了一种在 NSView 对象中显示文本或图像的机制，而无需完整的 NSView 子类的开销**。

值得注意的是，单元格类用于*“显示文本或图像”*，而不是处理与用户的交互。同样，与`NSTextField`类：

> NSTextField 类使用 NSTextFieldCell 类来实现它的用户界面。

处理实际的`NSTextField`用户输入，同时使用文本字段单元格来简单地实现其用户界面，类似地，在文本编辑结束时提供通知的委托方法是通过`NSTextField`类而*不是*通过`NSTextFieldCell`类提供的。

如果您想在编辑结束时收到通知`NSTableView`，那么您需要将自己注册为 的观察者（如果您不熟悉通知，`NSTextDidEndEditingNotification`您可能需要阅读[NSNotificationCenter类参考）。](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSNotificationCenter_Class/Reference/Reference.html)为此，请将以下内容放在您的控制器类中；该`awakeFromNib`函数是一个包含它的好地方，以确保在您的应用程序启动时调用它：

```
NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
[nc addObserver:self
       selector:@selector(textDidEndEditing:)
           name:NSTextDidEndEditingNotification
         object:tableView]; 
```

指向对象`tableView`的指针在哪里。`NSTableView`然后，简单地实现方法如下：

```
- (void)textDidEndEditing:(NSNotification *)aNotification
{
    // Do what you want here
} 
```

不要忘记在解除分配时将自己移除为观察者：

```
- (void)dealloc
{
    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
    [nc removeObserver:self];
} 
```

将您正在观察的对象设置为`NSTableView`实例（而不是单元格本身）的原因是，在后台，当您编辑表格中的单元格时，您正在处理的单元格不会被直接编辑; 它是窗口的（或自定义的）字段编辑器。编辑结束时，字段编辑器然后将该单元格的新值传递给表格视图。但是，表格视图将发布通知，说明单元格已完成编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-08T12:20:41.547

实现`tableView:setObjectValue:forTableColumn:row:`NSTableViewDataSource 协议中的方法。`tableView:objectValueForTableColumn:row:`把它放在你已经实现的方法旁边。

```
- (void)tableView:(NSTableView *)aTableView
   setObjectValue:(id)anObject
   forTableColumn:(NSTableColumn *)aTableColumn
              row:(NSInteger)rowIndex
{
    [mutableArrayWithStrings replaceObjectAtIndex:rowIndex withObject:anObject];
} 
```

# ruby - Ruby 中的“主要”是什么？

> ID：917811
> 
> 赞同：47
> 
> 时间：2009-05-27T20:16:36.167
> 
> 标签：ruby, main

如果我将此文件作为“ `ruby x.rb`”运行：

```
class X
end
x = X.new 
```

叫“”的东西是`X.new`什么？

它是一个对象/过程/等吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-05-27T20:22:37.277

Ruby 中的一切都发生在某个对象的上下文中。顶层的对象称为“main”。它基本上是一个具有特殊属性的 Object 实例，其中定义的任何方法都被添加为 Object 的实例方法（因此它们在任何地方都可用）。

所以我们可以制作一个完全由以下内容组成的脚本：

```
puts object_id
@a = 'Look, I have instance variables!'
puts @a 
```

它将打印“105640”和“看，我有实例变量！”。

这不是你通常需要关心的事情，但它就在那里。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-27T20:30:14.860

顶级调用者是一个对象 main，它属于 Object 类。

试试这个红宝石程序：

```
p self
p self.class 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-27T20:19:07.173

这是X级。您正在调用创建类 X 对象的“new”方法。因此，如果您将此文本作为脚本运行，Ruby：

*   创建一个新类 X，它是 Object 的子类，并且自动（作为 Object 的子类）继承一些方法，其中`new`一个。
*   起个名字`x`
*   调用该`new`新类的方法`X`，创建一个 X 实例对象；x 获得对该对象的引用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-27T20:21:15.297

这是运行该行的 ruby​​ 解释器

```
x = X.new 
```

与许多脚本语言一样，脚本是从上到下解释的，而不是像大多数编译语言那样具有标准的入口点方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-27T20:23:35.900

正如查理马丁所说，X.new 是对 X 类的构造函数的调用，它返回一个 X 类型的对象，存储在变量 x 中。

根据您的标题，我认为您正在寻找更多。Ruby 不需要 main，它按照看到的顺序执行代码。因此，必须在调用它们之前包含依赖项。

因此，您的 main 是在类或模块定义之外编写的任何过程式代码。

# .net - .net 中的 SQLite 中不区分大小写的顺序

> ID：917813
> 
> 赞同：6
> 
> 时间：2009-05-27T20:17:06.023
> 
> 标签：.net, sqlite, sql-order-by, case-insensitive

我正在使用 SQLite.net ( [http://sqlite.phxsoftware.com](http://sqlite.phxsoftware.com) ) 的 C# 程序中使用 SQLite。

默认情况下，SQLite 选择 order by 子句排序区分大小写，我希望结果不区分大小写，我发现“COLLATE NOCASE”但文档说它只会处理 ascii 范围内的英文字符，我想要真正的语言国际不区分大小写排序使用 CultureInfo.CurrentCulture 排序规则（让它使用 String.Compare 就可以了）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T21:43:22.840

我相信当前版本的 SQLite 中没有提供这种排序规则。因此，似乎最明智的计划是从查询中删除排序，然后在纯 .Net 中排序，您可以完全控制和访问线程的文化信息等结构。

由于两者都发生在同一个过程中，除非您的数据集非常大，否则这不会在性能方面产生很大差异。

SQLite 3 确实允许用户定义排序规则函数，这些可以在 SQLite.Net 中作为 .net 函数完成，但是跨托管/非托管边界来回调用的开销是相当大的。这是一个[人尝试在 c++ 中进行的尝试](http://sqlite.phxsoftware.com/forums/t/1619.aspx)。除非您可以访问其他人在 C++ 中经过良好测试且稳定的 unicode 文化敏感排序，否则我建议尽可能坚持使用简单排序后的方法。

当然，如果用户定义的排序规则的性能足以满足您当前的需求，那就去吧。

```
[SQLiteFunction(Name = "CULTURESORT", FuncType = FunctionType.Collation)]
class CultureSort : SQLiteFunction
{
    public override int Compare(string param1, string param2)
    {
        return String.Compare(
            param1,param2, CultureInfo.CurrentCulture, CompareOptions.IgnoreCase)
        );
    }
} 
```

发布脚本，如果你喜欢花哨：有一个幸运的 SQLite 构建，它[集成了 ICU 库](http://www.sqlite.org/cvstrac/fileview?f=sqlite/ext/icu/README.txt)，用于在 ordering/like/upper/lower 上提供“适当”的 unicode 支持，但你需要将它集成到用作支持的 sqlite 代码中.Net 包装器。这很多都不容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T22:04:05.027

SQLite.NET 允许您在 C# 中定义可在 SQL 查询中使用的自定义函数。所以应该可以在 C# 中编写一个 custom_upper 或 custom_lower 函数来处理当前区域性排序规则的大小写转换......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-11T14:49:33.700

您可以简单地使用`lower()`sqlite 函数：

```
select * from data order by lower(name) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T21:56:46.477

是的，这比你想象的要复杂得多。在某些文化中，规则是不同的，如果不知道你想要建立什么样的文化，那就不可能了。考虑著名的（在 i18n 人中）[土耳其语](http://www.i18nguy.com/unicode/turkish-i18n.html)的例子。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-11-22T12:08:30.883

您可以使用 ToLower() 方法来获得快速结果：

```
return model.Users.OrderBy(u => u.Name.ToLower()).ToList(); 
```

# c# - MetaData.cs 在哪里？动态数据实体？

> ID：917821
> 
> 赞同：0
> 
> 时间：2009-05-27T20:18:31.263
> 
> 标签：c#, .net, asp.net, dynamic-data

asp.net 3.5中有两种模板

1) 动态数据 Web 应用程序。

2) 动态数据 Web 应用程序。实体

我的 SQL 数据库有 Customer Table ；列：ID、姓名、姓氏与姓名

如果您使用第一个（动态数据 Web 应用程序）；你看不到 ID 列（客户表）（Linq to Sql）

但是如果你使用第二个（Dynamic Data Web App.Entities），你可以看到 ID 列

我如何过滤列，尤其是 ID 区域。我是说; 我需要 ID 列可见 =false

**我如何使用 tihs 代码？**

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.ComponentModel.DataAnnotations;
using System.Linq;
using System.Web;
using System.Web.DynamicData;

public class StaffsBusinessMetadata
{
    [ScaffoldColumn(false)]
    public object ID { get; set; }
}
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:34:31.247

您需要将 MetadataType 属性添加到此元数据所针对的实体类型的部分类（在这种情况下，我假设实体是“StaffsBusiness”）。

```
[MetadataType(typeof(StaffsBusinessMetadata))]
public partial class StaffsBusiness
{

} 
```

这里有很多关于动态数据的信息：http: [//msdn.microsoft.com/en-us/library/cc488545.aspx](http://msdn.microsoft.com/en-us/library/cc488545.aspx)

# java - 标记化错误：java.util.regex.PatternSyntaxException，悬空元字符“*”

> ID：917822
> 
> 赞同：58
> 
> 时间：2009-05-27T20:18:54.647
> 
> 标签：java, regex, split, tokenize

我用来标记一个用以下格式`split()`分隔的字符串：`*`

```
name*lastName*ID*school*age
%
name*lastName*ID*school*age
%
name*lastName*ID*school*age 
```

我正在使用以下代码从名为“entrada.al”的文件中读取此内容：

```
static void leer() {

    try {
        String ruta="entrada.al";
        File myFile = new File (ruta);
        FileReader fileReader = new FileReader(myFile);

        BufferedReader reader = new BufferedReader(fileReader);

        String line = null;

        while ((line=reader.readLine())!=null){
            if (!(line.equals("%"))){
                String [] separado = line.split("*"); //SPLIT CALL
                names.add(separado[0]);
                lastNames.add(separado[1]);
                ids.add(separado[2]);
                ages.add(separado[3]);
            }
        }

        reader.close();
    } 
```

我得到了这个例外：

> 线程“主”java.util.regex.PatternSyntaxException 中的异常：在索引 0 附近悬空元字符 '*' *

我的猜测是`*`原始文本文件缺少后年龄导致了这种情况。我该如何解决？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-05-27T20:22:28.180

不，问题是它`*`是正则表达式中的保留字符，所以你需要转义它。

```
String [] separado = line.split("\\*"); 
```

`*`表示“前一个表达式的零个或多个”（参见[`Pattern`Javadocs](http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html)），并且您没有给它任何前一个表达式，从而使您的拆分表达式非法。这就是为什么错误是[`PatternSyntaxException`](http://java.sun.com/javase/6/docs/api/java/util/regex/PatternSyntaxException.html).

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-26T06:50:35.553

我有类似的问题`regex = "?"`。它发生在所有在正则表达式中具有某种意义的特殊字符上。因此，您需要将其`"\\"`作为正则表达式的前缀。

```
String [] separado = line.split("\\*"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-28T02:02:13.177

第一个答案涵盖了它。

我猜想你可能会决定将你的信息存储在不同的类/结构中。在这种情况下，您可能不希望结果从 split() 方法进入数组。

你没有要求它，但我很无聊，所以这里是一个例子，希望它有帮助。

这可能是您编写的代表一个人的类：

```
 class Person {
            public String firstName;
            public String lastName;
            public int id;
            public int age;

      public Person(String firstName, String lastName, int id, int age) {
         this.firstName = firstName;
         this.lastName = lastName;
         this.id = id;
         this.age = age;
      }  
      // Add 'get' and 'set' method if you want to make the attributes private rather than public.
} 

```

然后，您最初发布的解析代码版本将如下所示：（这将它们存储在 LinkedList 中，您可以使用其他东西，如 Hashtable 等。）

```
 try 
{
    String ruta="entrada.al";
    BufferedReader reader = new BufferedReader(new FileReader(ruta));

    LinkedList<Person> list = new LinkedList<Person>();

    String line = null;         
    while ((line=reader.readLine())!=null)
    {
        if (!(line.equals("%")))
        {
            StringTokenizer st = new StringTokenizer(line, "*");
            if (st.countTokens() == 4)          
                list.add(new Person(st.nextToken(), st.nextToken(), Integer.parseInt(st.nextToken()), Integer.parseInt(st.nextToken)));         
            else            
                // whatever you want to do to account for an invalid entry
                  // in your file. (not 4 '*' delimiters on a line). Or you
                  // could write the 'if' clause differently to account for it          
        }
    }
    reader.close();
} 

```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-09-05T09:09:49.440

这是因为 * 用作元字符来表示前一个字符的一个或多个出现。所以如果我写 M* 那么它会寻找文件 MMMMMM .....！在这里，您使用 * 作为唯一字符，因此编译器正在寻找该字符以查找多次出现，因此它会引发异常。:)

# asp.net - Umbraco 有什么好的电子商务扩展/插件吗？

> ID：917823
> 
> 赞同：8
> 
> 时间：2009-05-27T20:18:55.070
> 
> 标签：asp.net, content-management-system, e-commerce, umbraco

我正在开发一个将 Umbraco 用于 CMS 功能的项目，但也有一个相当简单的电子商务需求。我知道 Commerce4Umbraco，还有其他的吗？或者，我应该在别处寻找简单的电子商务功能。将相同的平台用于 CMS 和电子商务会很好......不过还是坚持使用 Umbraco。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-28T07:51:05.390

我知道的唯一其他软件包是[umbraco commerce](http://umbracoecommerce.codeplex.com)

看起来它已经有一段时间没有更新了，而且 Commerce4Umbraco 即将发布第一个版本，所以可能是一个更好的选择。

我知道它将在[Codegarden09 umbraco 会议上](http://codegarden09.com/)展出。

由于 Umbraco 是基于 .NET 的，您还可以使用现成的购物车，例如[dotNetCart](http://www.dotnetcart.com/)或开发一些定制的东西。当然，这意味着单独的后端，但如果需要，您也可以轻松地将其添加到后端。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-23T07:08:00.957

uCommerce 是一个完全集成的 Umbraco 4.0 电子商务包。[您可以在uCommerce 网站上](http://www.ucommerce.dk/en/features.aspx)查看完整的功能列表。

它可供开发人员免费使用，您可以[从我们的网站下载副本](http://www.ucommerce.dk/en/get-it-now.aspx)。.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-04T10:21:01.003

将其放在这里以供参考，上面的答案是 Umbraco 的两个主要付费电子商务插件。

但主要的免费电子商务解决方案是 Merchello：[https ://merchello.com](https://merchello.com)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-13T22:25:33.023

TeaCommerce 刚刚发布。看起来很有前途。

[http://www.teacommerce.dk](http://www.teacommerce.dk)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-20T16:55:30.507

Tea Commerce 非常适合简单或中型的电子商务项目。它是商业化的，但价格低廉，并且具有构建网上商店的 javascript ajax 方法。[在我的博客](http://rune.gronkjaer.dk/en-US/2010/11/10/umbraco-e-commerce-webshop/)上阅读它。

# iphone - 使用分页动画刷新 UIView

> ID：917825
> 
> 赞同：0
> 
> 时间：2009-05-27T20:19:06.300
> 
> 标签：iphone, paging

我有一个 UIView，它具有基于日期构建的控件。我想轻弹以更改日期并使用分页动画之类的动画刷新 UIView。那可能吗？我不想创建 UIView 的多个副本，因为它已经接近超出内存。我的 UIView 的 2 个副本肯定会使手机崩溃。有人有什么建议吗？请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T20:35:04.427

虽然我还没有测试过，但您应该能够使用相同的 UIView 实例来生成“翻转”或任何使用相同 UIView 作为底层视图和覆盖视图的动画。

我偶然发现了这个，试图让一些动画工作。

# c# - 批量重构 C#

> ID：917828
> 
> 赞同：3
> 
> 时间：2009-05-27T20:19:57.220
> 
> 标签：c#, visual-studio, refactoring

我希望能够同时重构 500 个项目。

我有大约 20 个解决方案，但我没有一个包含所有内容的主解决方案，因为我还没有[找到自动生成它的方法](https://stackoverflow.com/questions/414309/generate-solution-file-from-list-of-csproj)。

有什么建议么？

谢谢

**编辑**

我已经尝试使用 codeplex 中的 slnTools 来生成解决方案，而 Visual Studio 几乎可以关闭整个操作系统。不确定是解决方案没有正确生成还是只是 Windows / Visual Studio 的限制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:31:08.913

要创建巨大的解决方案，您应该能够从一个模糊的宏开始，如下所示：

```
 Dim d As New System.IO.DirectoryInfo(System.IO.Directory.GetCurrentDirectory())
    For Each f As System.IO.FileInfo In d.GetFiles("*.*proj")
        DTE.Solution.AddFromFile(f.FullName)
    Next
    DTE.Solution.Close(True) 
```

* * *

在开始大规模重构之前，我建议您使用 NDepend 之类的工具来分析代码的依赖结构，并将其与重构目标进行比较。您只需要内存中受特定重构影响的项目。如果您可以限制所需的集合，您将受益匪浅。

如果您无法将它们全部存储到内存中，您仍然应该能够对工作进行分区——您只需要重复它。考虑这样一种情况，您有一个由其他十个项目使用的类库，并且您想要重构公共接口。

1.  保存类库的副本
2.  加载 Project 1 和类库，然后进行重构。关闭解决方案。
3.  从保存的副本中恢复类库。
4.  加载项目 2 和类库，然后再次进行重构。关闭解决方案。

等等。最后，保留类库的最后更改副本。如果你真的重复重构，那么十个项目都应该很高兴。

我也会借此机会重构灵活性，这样你就不需要再这样做了。通过接口或外观类访问类库可以将您与公共接口的更改隔离开来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:26:49.717

你到底想重构什么？[ReSharper](http://www.jetbrains.com/resharper/download/)可能是最知名的大规模重构工具......但它是否合适取决于您想要做什么*。*

您可以随时下载试用版并试一试...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T20:27:04.333

如果它们都共享相同的业务/数据域库，您可以对其进行重构，然后更新项目中的引用。

您更有可能希望从这些分布式项目中创建该业务/数据域。我不知道细节，但我敢打赌，将 20 个解决方案组合在一起不会帮助您重构通用代码。

1.  我会从小处着手，并创建一个新的解决方案，即您的常见应用程序位。
2.  将明显的公共代码片段提取到该解决方案中，并在您的其他项目中引用它的编译 dll。
3.  检查您的项目并重复，直到您找到与您正在寻找的结构相似的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:26:02.933

我认为没有什么**可以满足**您的需求。

您可以尝试[使用 slnTools](http://slntools.codeplex.com/)来了解如何操作 sln 文件，并将它们合并到一个 .sln 文件中。

但我不确定 Visual Studio 是否可以很好地处理 500 个打开的项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-02-24T13:08:09.897

您最好使用较少数量的项目，每个项目都有更多文件。编写一个 C# 程序并创建一个包含所有源文件的项目文件并不难。

Visual Studio 可能会也可能无法应对它......

# crystal-reports - 如何在 Crystal Reports 中有条件地对项目进行分组？

> ID：917830
> 
> 赞同：1
> 
> 时间：2009-05-27T20:20:34.660
> 
> 标签：crystal-reports

我有一份报告，目前分为两个报告，我想合并它们。

基本上可以归结为：

我询问用户是否想为每个属性设置分页符，如果他们回答是，我按属性排序/分组，然后按 X 排序
如果用户回答否，我只想按 X 排序/分组

如果用户回答否，我尝试抑制初始分组，但它仍然会相应地排序（不是我想要的方式）。

如果不将其保存在两个报告中，我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:45:05.670

不要抑制分组字段，而是尝试将其设置为空字符串`""`。上周我刚刚写了一份非常相似的报告。即使选择了“不分组”，报告仍会按一些未知的默认值进行分组。在公式分组字段中，我发现如果选择了“不分组”，则该字段根本没有设置。一旦我将其更改为将字段设置为空字符串，报告就会按预期生成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-28T01:50:29.347

Are you grouping or sorting? If you do not use the group header/footer it is basically the same as sorting and you should simply use the record sort.

In general, to conditionally group fields you would use formulas. For this to work the fields in question need to be returned as the same type: number, string, date, etc. In your case it sounds like the first grouping formula would be like this...

```
//{?break_by_property} would be the parameter value to control the page break

if {?break_by_property) then
{the_property_field}
else
"" //any static value of the same type as {the_property_field} 
```

now go the "new page before" formula for that group header and enter this boolean formula (groupnumber is a special keyword)...

```
{?break_by_property} and groupnumber > 1 
```

then add a record sort for X.

# c# - 防止多线程应用程序内存不足

> ID：917834
> 
> 赞同：0
> 
> 时间：2009-05-27T20:21:45.360
> 
> 标签：c#, multithreading, memory

我编写了一个小型的内部 C# 程序，它可以在各种文件格式之间进行批量转换，主要依赖于其他 API。目前，UI 会生成一个 BackgroundWorker（不是线程）来处理转换，然后在队列中填充请求，这些请求会在 worker 完成作业时清空。队列对象本身非常小（3 个字符串告诉工作人员该做什么）并且不会对程序的内存占用有很大贡献。我的内存管理相当严格（在完成图像后处理它们，并在某些时候手动进行垃圾收集。）不过，该程序往往一次使用大约 100 MB 的内存，并且使用大约 50%总 CPU 时间。好像我天真地实现了线程，

除了捕获 OutOfMemory 异常和回滚死掉的线程之外，是否有一种简单/有效的方法来生成线程以防止系统内存不足（看起来效率很低，但是如果不使用过多的内存就无法保留状态）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T20:41:52.790

如果您使用[ThreadPool.QueueUserWorkItem](http://msdn.microsoft.com/en-us/library/system.threading.threadpool.queueuserworkitem.aspx)来产生转换，您将自动获得正在运行的线程数的限制。ThreadPool 在内部对此进行管理，并在池线程可用时立即处理排队的调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:32:33.013

限制队列大小，如果队列已满，则让发送者等待。不过，您必须凭经验找到正确的队列大小限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:33:52.370

内存不足异常可能很棘手，可能是由内存碎片引起的，实际上并不是内存不足。因此，它们可能很难追踪。

来自瑞典 Microsoft 产品支持的 Tess ( [http://blogs.msdn.com/tess/](http://blogs.msdn.com/tess/) ) 有很多关于跟踪内存的帖子，其中内存将有助于此过程。

您的应用程序的良好配置文件也可以提供帮助。JetBrains 和 AQTime 一样好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:37:30.727

对于图像处理应用程序来说，使用 100MB 的内存并不算多。

此外，在 .net 中，当您遇到 OutOfMemory 异常时，整个进程都会终止，您无法从中恢复。

如果您需要比系统提供的更多内存（或者更准确地说是更多地址空间），您可以在使用时将内存分页进出或切换到 64 位。

您可以限制队列大小以确保唯一的“重”内存用户是工作线程，您可以拥有多个工作线程，这将增加您的内存使用量但也会更快地清空队列，只需记住在 CPU 中像这样具有比 CPU 内核更多的线程的密集操作效率低下。

您谈论“幼稚实现的线程”，多线程充满了陷阱-幼稚的实现将效率低下并且充满错误。

# css - 如何引用 CSS 中给定选择器的第一次出现？

> ID：917835
> 
> 赞同：1
> 
> 时间：2009-05-27T20:21:52.067
> 
> 标签：css

### HTML：

```
<div class="foo">firstBar</div><!-- give this one a different style -->
<div class="foo">secondBar</div>
<div class="foo">thirdBar</div> 
```

### CSS：

```
 .foo { font-size: 12pt } 
```

如果不编辑现有的 HTML，是否可以以某种方式引用类“foo”的第一次出现并赋予它不同的样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:23:39.770

```
div:first-child { font-size: 12pt } 
```

注意：要让*:first-child*在 IE 中工作，必须声明一个 DOCTYPE。这在 IE6 中不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:26:22.120

如果 div 包含在一个外部 div 中并且第一个 foo 是这个外部 div 的第一个孩子，你可以使用`div#outer_div + div.foo { font-size: 12pt }`

**编辑：**评论者是对的，这是行不通的。使用 + 的方法是重置所有其他 div.foo 的 font-size 属性，无穷无尽：

div.foo + div.foo { ... } div.foo + div.foo + div.foo { ... }

这不是一个好方法，所以无视我的回答。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:28:31.257

如果元素相互成功，则可以使用：

```
.foo { font-size: 2em }
.foo + .foo { font-size: inherit } 
```

# iphone - 如何阻止 XCode 重复出现和消失构建错误？

> ID：917839
> 
> 赞同：0
> 
> 时间：2009-05-27T20:22:21.787
> 
> 标签：iphone, xcode

很多时候，当我为我的 iPhone 项目运行单元测试时，XCode 感觉就像是让实际的错误从错误和警告组中消失了。这些错误通常在该组的一般子项下，并且通常当我需要详细阅读错误文本时，所有错误都消失了，我只剩下构建警告。有没有其他人看到过这种行为，有没有办法解决它？

**编辑：** 我忘了提；当我有与任何文件无关的错误时，这似乎会发生（它在错误列表的第二列中显示 Line Location:0）。如果那里没有任何错误（通常唯一的错误是失败的断言），那么它似乎可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-28T01:39:32.723

I haven't seen this behavior but what you describe sounds like a bug to me. You should submit it to apple.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T04:02:22.430

很难听懂你在说什么。我可以推断的是你：

1.  构建单元测试目标
2.  在“构建结果”窗口中查看项目中的错误和警告
3.  做一些你不解释的事情来“详细阅读错误的文本”
4.  看到错误消失（从构建结果窗口？），但警告仍然存在

在错误消失之前查看项目的屏幕截图会有所帮助，并在错误消失之前了解您正在做的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T04:05:56.837

这可能是因为您有多个具有依赖关系的目标。

一个目标依赖于另一个目标（通常是单元测试）并且单元测试被构建并且它们的警告/错误出现。然后，构建主要目标并显示其警告/错误。由于它们是不同的目标，因此第二批出现在第一批之上。

假设这是问题所在，您可以通过临时手动更改目标来查看第一批。

# .net - WindowsIdentity.GetCurrent() 上的安全异常

> ID：917857
> 
> 赞同：0
> 
> 时间：2009-05-27T20:26:35.037
> 
> 标签：.net, security, clickonce, windows-identity

单击一次部署。

应用程序在 VS2008 中运行良好。

运行已部署的应用程序时抛出异常：WindowsIdentity.GetCurrent()

请求“System.Security.Permissions.SecurityPermission, mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089”类型的权限失败。

单击一次安全设置：完全信任应用程序。

有任何想法吗？

谢谢，英国石油公司

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T01:23:54.110

一种方法是指定每个最终用户都必须具有允许 SecurityPermissionFlag.ControlPrincipal 的部署区域策略。

另一种方法是在部署期间为您的应用程序请求此特定权限。如果最终用户同意，将授予权限。

或者，您可以在部署期间全力以赴并为您的应用程序请求 FullTrust。

# powershell - 列出所有源安全链接文件的工具

> ID：917858
> 
> 赞同：2
> 
> 时间：2009-05-27T20:26:40.153
> 
> 标签：powershell, visual-sourcesafe, clearcase

我的客户正在从 Source Safe 迁移到 Clearcase。他们需要列出 Source Safe 数据库中的所有链接文件，以便可以将链接转移到 Clearcase，因为显然所有源都必须在第 1 天检查到 Clearcase，从而丢失任何现有链接。

是否有任何工具可以创建此报告，或者甚至可以完全导入 clearcase ？

我的计划是编写一个powershell脚本来递归SS文件夹的Source Safe，使用COM发现链接。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T15:44:43.853

正如 VonC 所提到的，从 VSS 到 ClearCase 的导入确实很糟糕，因为：

*   导出/导入需要永远完成，所以我们为它打开了一个针对 IBM 的 PMR（这没有帮助，顺便说一句）
*   Source Safe 共享被转换为文件，这会在整个地方创建重复项（恐怖！）。

我自己在 ClearCase UCM 上工作，我们做出了和你一样的决定（在我 10 年的 CM 经验中，这始终是最好的决定）：留下历史以供参考，最多导入几个版本手动操作（例如当前开发中；当前测试中；当前实时）。

我们解决股票问题的方法如下：

1.  与源树隔离的“共享”，将独立于其他源导入

2.  从头开始导入的其他来源（没有历史记录和共享）。假设在一个名为 MAIN_SRC 的组件中

3.  从头开始导入的共享（没有历史记录）。假设在一个名为 SHARE_SRC 的组件中

4.  创建了一个包含两个组件的项目：MAIN___SRC 和 SHARE_SRC。

现在，问题没有解决，因为您的共享与*您*的主要源代码无关，当您的 IDE（例如 Visual Studio）完全期望它们位于与之前相同的文件夹中时（即在 Visual 中，如果您不这样做，您的所有项目都会出错'不解决这个问题，所有文件都需要从Visual本身重新链接，等等......很多工作）。

这可以通过使用 ClearCase **VOB 符号链接**来解决：

假设在 MAIN___SRC 中，您需要在 SHARE_SRC 中使用名为 myShared 的文件。

从需要使用 myShared 文件的文件夹中，使用命令行界面并运行：

```
cleartool ln -s ..\..\SHARE_SRC\(myPath)\mySharedFile . 
```

您需要尽可能多的 ..\.. 才能上到 ClearCase 中的组件文件夹级别，然后沿着 SHARE_SRC 组件文件夹中的路径 (myPath) 下移。

请记住，ClearCase 路径由以下部分组成：

`M:\View_name\VOB_name\Component_name\Your first level of files and folders`

（VOB_name\Component_name 是组件的“根”，如果您有单个组件 VOB，在这种情况下，VOB_name\Component_name 只是 VOB_name）

最简单的方法是对所有需要创建的 VOB 符号链接进行映射，并将所有必要的“cleartool ln -s”命令行放在一个脚本中运行一次。

在那之后，你应该没问题，并且你的 IDE 认为源是它们曾经所在的位置。

干杯，

托马斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-27T20:58:48.233

正如我在[这个问题](https://stackoverflow.com/questions/868789/whats-the-best-way-to-migrate-from-sourcesafe-to-clearcase/869066#869066)中提到的，[clearexport_ssafe](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.cc%5Fadmin.doc/topics/t%5Fimport%5Fssafe%5Fexport.htm)应该用于从 Source Safe 导入到 ClearCase。

但是，该[工具的文档明确提到](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m1/index.jsp?topic=/com.ibm.rational.clearcase.cc_admin.doc/topics/c_import_ssafe_results.htm)：

> 分享。Rational ClearCase 中没有与 Visual SourceSafe 共享等效的特性。clearexport_ssafe 在转换过程中不会将共享保留为硬链接。相反，共享成为单独的元素

因此，您的脚本需要列出所有链接，并在它们的初始目录和新创建的单独元素之间创建软链接。

但我相信您可能希望为目标 ClearCase 存储库考虑另一个组织，其中不再直接使用所有共享文件，如[this answer所示](https://stackoverflow.com/questions/504034/replicating-sourcesafes-link-ablity-in-svn-or-other-version-control-systems/504203#504203)（在本例中为 SVN 存储库）：

> 我们已经消除了所有链接文件。之前链接的所有类文件都已放入类库中，这些类库作为解决方案中的共享项目引用共享给我们的其他项目。所以本质上你共享库，而不是类文件。
> 
> 有一些调整过程来适应这一点，但从那时起我就没有错过任何链接。通过像这样设置代码，它确实促进了更好的设计实践。

我[主要使用 UCM 工作，所有这些“共享”都是](https://stackoverflow.com/questions/449549/how-to-leverage-clearcases-features/449810#449810)*UCM 组件*的自然候选者，使用 UCM 基线来引用它们的不同版本，然后您可以制作自己的“配置”（标签列表）以选择不同的您需要的组件，使它们可以轻松地跨项目重用。

# mysql - 如何在不重启的情况下刷新 MySQL 配置文件？

> ID：917865
> 
> 赞同：41
> 
> 时间：2009-05-27T20:29:11.973
> 
> 标签：mysql, database

Apache有这样的特性，那MySQL呢？

一个存在吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-07-23T19:42:55.837

你离得太近了！该`kill -HUP`方法对我也不起作用。

你打电话给：

```
select @@global.max_connections; 
```

您只需要设置而不是选择：

```
set @@global.max_connections = 400; 
```

看：

[http://www.netadmintools.com/art573.html](http://www.netadmintools.com/art573.html)

[http://www.electrictoolbox.com/update-max-connections-mysql/](http://www.electrictoolbox.com/update-max-connections-mysql/)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-05-27T20:32:14.153

尝试：

```
sudo /etc/init.d/mysql reload 
```

或者

```
sudo /etc/init.d/mysql force-reload 
```

这应该会重新加载配置。确保您的 init.d 脚本支持它，但我不知道您使用的是什么版本的 MySQL/OS？

我的 MySQL 脚本包含以下内容：

```
'reload'|'force-reload')
        log_daemon_msg "Reloading MySQL database server" "mysqld"
        $MYADMIN reload
        log_end_msg 0
        ;; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-09-03T18:47:13.097

如果不重新启动服务器，`my.cnf`则无法重新加载配置文件 ( )。`mysqld`

`FLUSH LOGS`只轮换几个日志文件。

`SET @@...=...`*为尚未登录的任何人*设置它，但它会在下次重新启动后消失。但这提供了一个线索……做`SET`,*并*改变`my.cnf`; 这样你就被覆盖了。警告：并非所有设置都可以通过`SET`.

**MySQL 8.0 的新功能**...

`SET PERSIST ...`将设置全局设置*并将*其保存到重启后。几乎所有设置都可以通过这种方式进行调整。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-02T10:54:32.043

您可以从 SQL 客户端执行特定操作，而无需重新启动任何操作：

```
SET GLOBAL log = 'ON';
FLUSH LOGS; 
```

# iphone - 如何获取 iPod/iPhone 的 UDID？

> ID：917867
> 
> 赞同：2
> 
> 时间：2009-05-27T20:29:28.713
> 
> 标签：iphone

我见过这样做的程序，例如非常有用的“BetaHelper”应用程序。

如何获取运行我的应用程序的 iPhone iPod 的唯一设备标识符？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-27T20:33:11.297

[[UIDevice currentDevice] 唯一标识符]

# .net - 在新机器上部署 .net 应用程序并得到“系统无法执行指定的程序”

> ID：917869
> 
> 赞同：3
> 
> 时间：2009-05-27T20:29:54.890
> 
> 标签：.net, .net-2.0

我有一个启动 excel 的 .net 控制台应用程序。我让它在我的开发环境中运行，但我无法让它在我的生产环境中运行。当我尝试运行它时，我收到以下错误“系统无法执行指定的程序”。我在生产服务器上安装了 .net 2.0 sp2。有任何想法吗？

谢谢，

代码

```
static void Main(string[] args) 
{ 

  DateTime priceDate; 
  bool runningForMidDay; 
  if (args.Length == 0) 
  { 
   priceDate = DateTime.Now; 
   runningForMidDay = false; 
  } 
  else 
  { 
     if (args[0].ToString() == "-?") 
     { 
        Console.WriteLine("This application..."); 
        Console.ReadLine(); 
        return; 
     } 
     if (!DateTime.TryParse(args[0].ToString(), out priceDate)) 
        priceDate = DateTime.Now; 
     if (!bool.TryParse(args[1].ToString(), out runningForMidDay)) 
        runningForMidDay = false; 
  } 
  if (runningForMidDay) 
  { ... } 
  else 
  { ... } 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-27T21:24:31.380

They say there is no such thing as a dumb question, just dumb people. Well that is the case here. I had an error in my config file. I have corrected the config file and it works.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:33:29.860

当部署机器上没有安装 C 运行时库时，我已经看到过这种情况；通常它们不是必需的，但由于您的应用程序启动 Excel，它们可能是必需的。

# python - 在 OS X Leopard 上重新安装 /Library/Python

> ID：917876
> 
> 赞同：0
> 
> 时间：2009-05-27T20:31:50.470
> 
> 标签：python, macos, osx-leopard, reinstall

我不小心删除了 OS X Leopard 上的 /Library/Python。我该如何重新安装它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:34:52.680

如果您愿意，我将从原始安装创建一个 tarball。我使用的是 MacOSX 10.5.7，而且只有 12K。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:36:08.530

我使用的是 10.4，但除非安装在 10.5 中发生巨大变化，否则`/Library/Python`它只是安装本地（用户安装）软件包的地方；实际的 Python 安装在`/System`. 在 10.4 上，我具有以下结构：

```
/Library/
    Python/
        2.3/
            README
            site-packages/
                README 
```

因此，只需重新创建该结构就足够了。（但不要`2.3`使用 10.5 上安装的 Python 版本。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T20:36:51.303

`/Library/Python`包含你的 python 站点包，这是你使用命令安装的本地软件，如`python setup.py install`. 这里的部分是第三方包，而不是 Apple 安装的项目 - 您的实际 Python 安装在 /System/Library/etc 中仍然是安全的...

换句话说，默认操作系统使这些目录大部分为空白......其中没有任何重要内容（只有自述文件和路径文件）。

在这种情况下，您必须：

1.  重新创建目录结构：

2.  重新安装您的第三方库。

默认 OS X 安装的目录结构是：

> /Library/Python/2.3/site-packages /Library/Python/2.5/site-packages

# visual-studio - 如何调试导致 VS2008 挂起的 VB.Net Crystal Reports 应用程序

> ID：917880
> 
> 赞同：0
> 
> 时间：2009-05-27T20:32:21.953
> 
> 标签：visual-studio, visual-studio-2008, debugging, com, crystal-reports

我在 Visual Studio 2008 中调试 VB.Net 应用程序时遇到错误。在 Visual Studio 中调试控制台应用程序时，当应用程序实例化 Crystal Reports 'ReportDocument' 对象时，VS2008 挂起。即使 devenv.exe 进程已被终止，我也无法终止控制台应用程序仍在运行的 vshost.exe 进程。控制台应用程序是旧版 VB6 应用程序的一个端口，我怀疑底层 COM 调用可能导致 VS2008 挂起。

任何人都可以就如何确定此问题的原因提供任何建议吗？如果您可以为这个特定问题提供一个确切的答案，很好，但我对进一步调试这个问题的过程更感兴趣，特别是围绕识别任何 COM 交互，我在这个领域没有任何经验。

谢谢，魔术师安迪。

**笔记**

*   我正在使用 Crystal Reports 2008 重新分发安装程序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T20:40:20.453

几周前我遇到了一个问题，视觉工作室在某个时候崩溃了。我打开了第二个 VS 实例，打开了所有错误，然后附加到 VS 的第一个实例的进程并再次遇到问题。异常被捕获，这让我知道出了什么问题。

在这种情况下它可能不起作用，但值得一试。

# c# - C#：如何 - 接受新参数的单实例应用程序？

> ID：917883
> 
> 赞同：17
> 
> 时间：2009-05-27T20:32:55.803
> 
> 标签：c#, parameters, instance

我正在创建一个 (C#) 程序，它使用 NZB 文件下载二进制文件，任何时候可能只有一个我的应用程序实例在运行。

因此，当用户双击 .nzb 文件并且我的程序没有运行时，它应该启动并处理它（简单，文件注册）。现在，如果我的程序已经在运行，我不想启动第二个实例——我希望已经运行的实例能够获取指定的文件。

使用带有 .IsSingleInstance 技巧的 Visual Basic DLL 可以使我的应用程序成为单实例，但我不想去那里。

正确的方法似乎是使用互斥锁来确保我的应用程序是单实例的，但现在我被困在如何将指定的参数（.nzb 文件）传递给已经运行的实例。

帮助将不胜感激！:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T20:37:04.657

试试这个：你的主程序创建一个命名管道或其他进程间通信工具并监听它。您创建一个单独的小程序，当以 NZB 文件作为参数运行时，它会打开管道，将文件信息输入其中，然后退出。然后您的主程序处理新文件并下载它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:37:19.197

为什么不使用一个程序将文件添加到队列中，然后在下载程序尚未运行时启动下载程序。该下载程序监视队列，该队列只是您将下载文件名附加到的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:38:03.267

看[**Genghis**](http://genghis.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=4954)项目的InitialInstanceActivator

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T20:39:24.013

使用 IPC（进程间通信）机制，例如[.net 远程处理](http://msdn.microsoft.com/en-us/library/kwdt6w2k(VS.71).aspx)

# objective-c - 在 Obj-C 2.0 中锁定合成原子 @properties 的详细信息

> ID：917884
> 
> 赞同：10
> 
> 时间：2009-05-27T20:32:55.947
> 
> 标签：objective-c, cocoa, multithreading

Obj-C 2.0 中的属性文档说原子属性在内部使用锁，但它没有记录锁的细节。有谁知道这是一个按属性锁，一个与@synchronized(self) 使用的隐式锁分开的每个对象锁，还是与@synchronized(self) 等效的锁？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2010-12-01T20:27:15.643

查看生成的代码（iOS SDK GCC 4.0/4.2 for ARM），

*   直接访问32 位`assign`属性（包括）。`struct {int32_t v;}`
*   使用 objc_copyStruct() 访问大于 32 位的结构。
*   `double`并`int64_t`使用 objc_copyStruct 进行访问，但在 GCC 4.0 上除外，它们直接使用 stmia/ldmia 访问（我不确定在中断的情况下这是否保证是原子的）。
*   保留/复制访问器调用 objc_getProperty 和 objc_setProperty。

[Cocoa with Love：内存和线程安全的自定义属性方法](http://cocoawithlove.com/2009/10/memory-and-thread-safe-custom-property.html)提供了一些关于它们在[运行时版本 objc4-371.2](http://www.opensource.apple.com/source/objc4/objc4-371.2/runtime/Accessors.subproj/objc-accessors.m)中如何实现的细节；显然，不同运行时的精确实现可能会有所不同（例如，在某些平台上，您可以使用原子交换/CAS 在 ivar 本身上旋转，而不是使用另一个锁）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-27T20:37:53.750

atomic @properties 使用的锁是一个实现细节——对于适当平台上的适当类型，没有锁的原子操作是可能的，如果 Apple 没有利用它们，我会感到惊讶。在任何情况下都无法公开访问该锁，因此您不能在同一个锁上@synchronize。几位 Apple 工程师指出，原子属性并不能保证线程安全；原子属性仅保证该值的获取/集合是原子的。为了正确的线程安全，您将不得不使用更高级别的锁定或同步，并且您几乎肯定不想使用与合成 getter/setter 可能使用的相同的锁。

# orm - ORM 框架

> ID：917889
> 
> 赞同：5
> 
> 时间：2009-05-27T20:34:38.703
> 
> 标签：orm, frameworks, comparison

我需要收集一些关于现有 ORM 解决方案的信息。请随意写任何编程语言。

你能说说你用过的最好的 ORM 框架吗？为什么它比其他的更好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T20:43:32.460

我使用了 NHibernate 和实体框架。

目前实体框架的稳定版本非常不成熟。执行常见任务太困难或不可能。测试您的代码也很困难，因为您无法真正将实体与数据访问类分开。但它与visual studio ide完美集成。设置很容易，从数据库更新所有模型只需几秒钟。即将发布的 EF (4.0) 版本将解决其中的一些问题。

NHibernate 非常强大。它支持普通的旧 clr 对象，因此您可以使用简单的实体。配置提供了非常详细的控制。框架功能令人满意，它拥有庞大而活跃的社区和良好的文档。设置和更新实体有点困难，因为您必须使用生成器来查找数据库并生成实体和 xml 文件。找到完全符合您需求的生成器或模板可能会很棘手。但是一旦你设置了所有东西，你就会喜欢它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T20:44:25.673

我发现 LINQ to SQL 是一个非常直接的解决方案。我第一次使用它时，我会说我有一个基本的 ORM 在几个小时内就可以工作，并且正在用它创建 LINQ 查询。

Microsoft 有一个额外的 ORM（实体框架），我听说它更复杂，但可能对具有多个数据源等的高度复杂的分布式应用程序有用。

总的来说，我发现 LINQ 是一种易于使用且快速使用的 ORM。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T21:21:05.350

过去几个月我一直在研究 Telerik Open Access，总的来说，这个 ORM 使用起来很痛苦，它被宣传为具有广泛的 linq 支持，但实际上您通常期望的许多 linq 功能在服务器端不起作用，并且在客户端上执行。在 where 子句中使用多个条件时我也遇到了问题，请参阅我的最后一个[问题](https://stackoverflow.com/questions/832748/telerik-openaccess-and-multiple-conditions-in-the-where-clause)。这是我发现的一些东西

*   不支持视图
*   无法将多个实体映射到同一张表
*   继承和接口支持要求您更改数据库模式
*   没有像 LINQ to SQL 和实体框架这样的可视化设计器
*   如果要执行插入，必须首先获取任何相关实体

罗汉

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-28T10:19:54.547

LINQ2SQL 很好，EF 很有意义，但是非常复杂并且面向 SQL Server。NHibernate 很特别，Telerik OpenAccess（完全 .NET / Visual Studio）获得了广泛的功能和专业支持。

因为我知道产品，所以我可以评论 Rohan 的担忧：

*   可以使用现有视图，并且即将提供完整的视图支持
*   对于类层次结构，将多个实体映射到同一个表“有效”，存在反向映射的限制
*   继承和接口支持“不需要”对数据库模式进行更改，但仍然存在反向映射的限制
*   视觉设计器来了，正向和反向映射向导让您已经可以轻松地做任何事情
*   提到的插入问题有一个解决方法，通常会修复

查看 Telerik 网站以找到满意的客户，并随时使用 Telerik 论坛和支持资源解决任何问题。

-彼得

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-03T03:16:45.230

我是 OpenAccess ORM 的新手，我们正在使用两种产品。报告和开放存取。我认为人们错过了一些功能。

1.  OpenAccess 使用图形设计器，而 nHibernate 仍然使用手写的 xml 文件
2.  OpenAccess 不限于 SQl Server 作为 EF4 和类似框架

使用它更容易，论坛也很有帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-26T10:47:39.820

使用 ORM 有多种可能性，一切都取决于您想要什么。

作为一个真正的 ORM 映射器，我强烈推荐**NHibernate**和**Fluent NH**映射。你需要大量的研究来构建一个漂亮的架构，但是没有什么能挡住你的路。以最小的妥协，您获得真正的灵活性。

**EF6x**（核心不是产品就绪恕我直言）被称为 ORM，但它生成的更接近于 DAL。有些事情是您无法使用 EF6 有效完成的。尽管如此，这仍然是我最喜欢的读取模型工具，而我确实将它与 NHibernate 结合在一起（我将 NH 用于 DDD/写入模型）。

现在来**表现**- 它总是有利有弊。如果您深入了解 ORM**架构**（请参阅我的文章：[避免 ORM 坏习惯](https://www.linkedin.com/pulse/get-know-your-orm-avoid-bad-habits-balazs-hideghety)），那么您会直观地找到使其更快的方法。这是我的另一篇关于如何使 EF6x**更快**5 倍的文章（至少在读取情况下）：[EF6.x 5x faster](https://www.linkedin.com/pulse/orm-read-performance-ef-vs-dapper-balazs-hideghety)

# javascript - 如何将键值添加到 javascript 对象

> ID：917904
> 
> 赞同：3
> 
> 时间：2009-05-27T20:37:36.920
> 
> 标签：javascript

我正在努力学习 JS。这看起来很简单，但我不知道该怎么做。

基于这个好的 [线程拥有这个 javascript 对象](https://stackoverflow.com/questions/688097/objects-vs-arrays-in-javascript-for-key-value-pairs)

```
变种人= {
  1：{名称：'乔'}，
  2：{名称：'山姆'}，
  3：{名称：'夏娃'}
};

```

如何添加以下值

```
4：{名称：'约翰'}
```

为了得到名字夏娃我写

```
人[“1”].name
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-27T20:39:46.663

以任何其他值的方式将匿名对象分配给它。

```
people["4"] = { name: 'John' }; 
```

对于它的价值，由于您的键是数字的，您还可以使用从零开始的索引并使人们成为一个数组。

```
var people = [ { name: 'Joe' },
               { name: 'Sam' },
               { name: 'Eve' } ]; 
```

和

```
alert( people[2].name ); // outputs Eve
people[3] = { name: 'John' }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T20:41:09.407

我认为人们应该是一个数组：

```
var people = [
  { name: 'Joe' },
  { name: 'Sam' },
  { name: 'Eve' }
]; 
```

由于键是整数，因此您可以通过以下方式添加一个人：

```
people.push({name:'John'}); 
```

您可以通过以下方式访问人员：

```
var somebody = people[1]; /// >>> Sam 
```

# objective-c - Add to arrayController, edit Core Data attribute

> ID：917907
> 
> 赞同：0
> 
> 时间：2009-05-27T20:37:58.150
> 
> 标签：objective-c, cocoa

***** EDIT ***** What I'm not sure of is how to access an entity from the model in the code, and how to access a specific instance of an entity in that code. That sums up the main issues I'm having.

***** END EDIT *****

I have a tableview with a button to add to it. When the button is clicked, the user is presented with an open dialog where they select a file(s). A new Object is added to the array controller. What I'm not sure how to do is to edit the core data attributes for this new object. There are two attributes, filename and pathname, and I'm not sure how to edit them. If you look at the bottom of the openPanelDidEnd:returnCode:contextInfo: function you'll see what I'm trying to accomplish.

```
- (IBAction)addAttachment:(id)sender
{
    panel = [NSOpenPanel openPanel];
    [panel beginSheetForDirectory:nil
                 file:nil
              modalForWindow:[NSApp mainWindow]
            modalDelegate:self
             didEndSelector:@selector(openPanelDidEnd:
                            returnCode:
                            contextInfo:)
              contextInfo:NULL];
}

- (void)openPanelDidEnd:(NSOpenPanel *)openPanel
             returnCode:(int)returnCode
             contextInfo:(void *)x
{
    if (returnCode == NSOKButton)
    {
        NSArray *files = [openPanel filenames];

        int i;
        for (i = 0; i < [files count]; i++)
        {
            NSString *file = [files objectAtIndex:i];
            [attachmentController add:x];
            // How do I add filenames here?
            // I'm assuming it involves KVC like
            // [something setValue:@"file" forKey:@"filename"];
            // But I don't know hot to get the something
            // i.e. since I have multiple attachments,
            // how do I get the one I just created
        }
    }
} 
```

*********** EDIT ************** Simplified, my model has 2 entities: Attachment and Item. Item has a to-many relationship with Attachment, as each Item may have many Attachment's.

My openPanelDidEnd:returnCode:contextInfo: method now looks like this:

```
 NSString *filename = [files objectAtIndex:i];
        MySchoolPlanner_AppDelegate *myAppDelegate = [[MySchoolPlanner_AppDelegate init] alloc];
        [NSEntityDescription insertNewObjectForEntityForName:@"Attachment"
                                      inManagedObjectContext:[myAppDelegate managedObjectContext]];
        [myAppDelegate release]; 
```

For some reason, the table view bound to the Attachment array controller does not add any. Also, I'm not sure how to access the attachment I just created to use KVC on it.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:04:45.960

NSArray's `add:` method is something you'd hook a button up to, when you have a Core Data entity that can be created and used without any initialization. In this case just call NSEntityDescription's

```
+ (id)insertNewObjectForEntityForName:(NSString *)entityName inManagedObjectContext:(NSManagedObjectContext *)context 
```

with the managed object context you're using with your array controller and the appropriate entity name to create your managed object in code. You can set properties on it directly if you've created a subclass for your entity, or just use key value coding if you haven't done that yet.

# c# - 如何在 Java、C# 和/或 C 中查找无线网络 (SSID) 列表？

> ID：917910
> 
> 赞同：12
> 
> 时间：2009-05-27T20:39:26.713
> 
> 标签：c#, java, c, wireless, ssid

是否有可用的工具包/程序包可用于查找在 Java、C# 或 C for Windows XP+ 中可用的无线网络 (SSID) 列表？任何示例代码将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-27T20:51:20.540

对于 C#，请查看[Managed Wifi API](http://www.codeplex.com/managedwifi) ，它是Windows XP SP2 及更高版本提供的[Native Wifi API](http://msdn.microsoft.com/en-us/library/ms705969.aspx)的包装器。

我尚未测试此代码，但查看托管 Wifi API 示例代码，这应该列出可用的 SSID。

```
WlanClient client = new WlanClient();
foreach ( WlanClient.WlanInterface wlanIface in client.Interfaces )
{
    // Lists all available networks
    Wlan.WlanAvailableNetwork[] networks = wlanIface.GetAvailableNetworkList( 0 );
    foreach ( Wlan.WlanAvailableNetwork network in networks )
    {                     
        Console.WriteLine( "Found network with SSID {0}.", GetStringForSSID(network.dot11Ssid));
    }
}

static string GetStringForSSID(Wlan.Dot11Ssid ssid)
{
    return Encoding.ASCII.GetString( ssid.SSID, 0, (int) ssid.SSIDLength );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-18T07:11:39.577

```
ArrayList<String>ssids=new ArrayList<String>();
ArrayList<String>signals=new ArrayList<String>();
ProcessBuilder builder = new ProcessBuilder(
        "cmd.exe", "/c", "netsh wlan show all");
builder.redirectErrorStream(true);
Process p = builder.start();
BufferedReader r = new BufferedReader(new InputStreamReader(p.getInputStream()));
String line;
while (true) {
    line = r.readLine();
    if (line.contains("SSID")||line.contains("Signal")){
        if(!line.contains("BSSID"))
            if(line.contains("SSID")&&!line.contains("name")&&!line.contains("SSIDs"))
            {
                line=line.substring(8);
                ssids.add(line);

            }
            if(line.contains("Signal"))
            {
                line=line.substring(30);
                signals.add(line);

            }

            if(signals.size()==7)
            {
                break;
            }

    }

}
for (int i=1;i<ssids.size();i++)
{
    System.out.println("SSID name == "+ssids.get(i)+"   and its signal == "+signals.get(i)  );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-11T07:35:52.453

好吧，你没有指定操作系统，所以对于 Linux，我会建议 Jean Tourrilhes 的 Wireless Tools for Linux ( [http://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html](http://www.hpl.hp.com/personal/Jean_Tourrilhes/Linux/Tools.html) )。iwlist() 命令显示大量有关可用网络的信息。源代码在 C 中。另一种方法是使用 libpcap 在 C 中编写您自己的代码，以捕获信标帧并从中提取 SSID（仅在监控模式下）。我还没有测试我的嗅探代码，所以我不会把它贴在这里，但这是一个非常简单的工作。

# java - 除了使用动作之外，通过单击按钮设置值

> ID：917916
> 
> 赞同：0
> 
> 时间：2009-05-27T20:40:07.677
> 
> 标签：java, jsp, icefaces

我有两个 bean 代码：

```
 public class ApplContactDtl {
 ....... 
```

和代码：

```
 public class ApplNotifBean extends ApplNotif{
 ...
 private List<ApplContactDtl> contactsList;
 ... 
```

在我的 JSPX 中，我正在显示 ApplNotifBean 的每个条目的 ApplContactDtl 条目列表我想为这些条目添加一个删除操作（删除数据库中 bean 之间的关系）。我遇到的问题是我需要在删除完成后更新 ApplNotifBean 的其他内容。理想情况下，我会将删除操作放在 ApplContactDtl 中，但我不确定如何调用引用已删除操作的 bean(ApplNotifBean) 的方法。如果我将删除操作放在 ApplNotifBean bean 中，我不确定如何为已删除的子 bean 分配 ID 以知道如何删除它！

有没有办法在 ApplNotifBean bean 中设置“deleteBeanID”变量，以便知道单击按钮后我要删除哪个变量？

谢谢，

谭

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T21:13:33.413

您可以选择使用 commondButton 的 action 属性，也可以选择使用标签调用另一个方法。在 JSF 中，将首先调用 actionListener 方法。

这是一种选择，或者如果您使用 Spring，您可以很容易地将 ApplContactDtl 的引用连接到 ApplNotifBean 中。

# php - PHP 最容易解析的格式是什么？

> ID：917920
> 
> 赞同：0
> 
> 时间：2009-05-27T20:40:41.017
> 
> 标签：php, parsing, format

在我的 PHP 文件中，我正在使用如下查询读取大量信息：

```
SELECT  GROUP_CONCAT(CONCAT('<comment><body><![CDATA[',body,']]></body>','<replier>',if(screen_name is not null and !anonymous,screen_name,''),'</replier>','<created>',created,'</created></comment>') SEPARATOR '')
                        FROM   idiscussion
                        LEFT JOIN
                               users
                        ON     idiscussion.uid=users.id
                        WHERE  idiscussion.iask_id = 1 
```

是的，它就像 xml 格式，但似乎在 PHP 中解析并不容易，

关于使用哪种格式以便以后轻松解析的任何建议？

至于我的我需要将它们连接在一起，

您可以考虑这种情况：一次检索1个主题和该主题下的讨论。1 个主题对应多个讨论。如何在 1 个查询中完成而不将其连接在一起？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:17:22.767

如果您从 SQL 数据库中获取数据，那么不使用 SQL 将其转换为某种文本格式会容易得多，而是执行常规查询并使用 SQL 函数来处理给定的结果。

如果您最终需要将数据序列化到其他 PHP 客户端，我会推荐[PHP 的标准序列化格式](http://php.net/serialize)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T20:49:15.913

您可以使用[DOM](http://de2.php.net/de/dom)或[SimpleXML](http://de2.php.net/manual/de/book.simplexml.php)来解析 XML 文件，也可以使用[JSON](http://de2.php.net/manual/de/book.json.php)或[YAML](http://code.google.com/p/spyc/)。所有这些都非常易于使用，因为您可以依赖 PHP 的高级解析器。它们各有优缺点，具体取决于您要如何使用该格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T20:44:52.957

取决于数据结构，但值列表可以使用 join() 轻松保存为分号分隔的条目列表，然后使用 split() 轻松解析。

这非常简单，但对于稍微复杂的数据可能并不理想。

回复评论：如果数据包含分号，则需要适当转义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T23:42:48.730

我能问一下为什么你不只是检索数据*而不*将它们连接在一起吗？

```
SELECT body,
       IF(screen_name IS NOT NULL AND !anonymous, screen_name, '') AS replier,
       created
FROM   idiscussion
LEFT JOIN
       users
ON     idiscussion.uid = users.id
WHERE  idiscussion.iask_id = 1 
```

这应该与您的原始查询一样快地执行，并且您可以像访问任何其他结果集一样访问其数据。假设您使用的是 MySQL 而不是 PDO：

```
$result = mysql_query($sql);
if ($result) {
    while ($row = mysql_fetch_assoc($result)) {
        // $row is an associative array containing the current row's data.
    }
} 
```

如果您需要创建 XML 但又想访问原始形式的数据，只需在 PHP 中创建即可。

```
$xml =
    '<comment>' .
         '<body><![CDATA[' . $row['body'] . ']]></body>' .
         '<replier>' . $row['replier'] . '</replier>' .
         '<created>' . $row['created'] . '</created>' .
    '</comment>'; 
```

如果尚未清理数据，您可能需要转义数据。您还可以使用[XMLWriter](http://php.net/manual/en/book.xmlwriter.php)等 XML 构建器，但这超出了本问题的范围。

# java - 从 DUAL 中选择 1：MySQL

> ID：917927
> 
> 赞同：13
> 
> 时间：2009-05-27T20:42:47.143
> 
> 标签：java, mysql, connection-pooling, apache-commons-dbcp

在查看我的查询日志时，我看到了一个我没有解释的奇怪模式。

在几乎每个查询之后，我都有“从 DUAL 中选择 1”。

我不知道这是从哪里来的，而且我当然没有明确地进行查询。

日志基本上是这样的：

```
 10 Query       SELECT some normal query
    10 Query       select 1 from DUAL
    10 Query       SELECT some normal query
    10 Query       select 1 from DUAL
    10 Query       SELECT some normal query
    10 Query       select 1 from DUAL
    10 Query       SELECT some normal query
    10 Query       select 1 from DUAL
    10 Query       SELECT some normal query
    10 Query       select 1 from DUAL
    ...etc... 
```

有没有人遇到过这个问题？

MySQL 版本：5.0.51

驱动程序：使用 JDBC 的 Java 6 应用程序。mysql-connector-java-5.1.6-bin.jar

连接池：commons-dbcp 1.2.2

validationQuery 设置为“从 DUAL 中选择 1”（显然），并且当验证查询为非空时，连接池显然默认 testOnBorrow 和 testOnReturn 为 true。

这给我带来的另一个问题是我是否真的**需要**验证查询，或者我是否可以通过禁用它或至少降低使用它的频率来提高性能。不幸的是，编写我们的“数据库管理器”的开发人员已不在我们身边，所以我不能要求他为我证明这一点。任何输入将不胜感激。我将通过 API 和谷歌挖掘一段时间，如果我发现任何有价值的东西，我会报告。

编辑：添加了更多信息

EDIT2：为以后发现此问题的任何人添加了正确答案中要求的信息

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-27T20:47:58.503

它可能来自您的应用程序正在使用的连接池。我们使用一个简单的查询来测试连接。

只是快速查看了 mysql-connector-j 的源代码，它不是来自那里。

最可能的原因是连接池。

常见的连接池：

**commons-dbcp**有一个配置属性，它与您看到的语句`validationQuery`结合`testOnBorrow`并可能导致。`testOnReturn`

**c3p0**有`preferredTestQuery`, `testConnectionOnCheckin`,`testConnectionOnCheckout`和`idleConnectionTestPeriod`

对于什么是值得的，我倾向于配置连接测试和结帐/借用，即使这意味着一点额外的网络聊天。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-02-18T11:20:45.260

我已经执行了 100 次插入/删除，并在 DBCP 和 C3PO 上进行了测试。

DBCP :: testOnBorrow=true 影响响应时间超过 4 倍。

C3P0 :: testConnectionOnCheckout=true 影响响应时间超过 3 倍。

结果如下： DBCP – BasicDataSource

100 个事务（插入操作）的平均时间 testOnBorrow=false :: 219.01 ms testOnBorrow=true :: 1071.56 ms

100 个事务的平均时间（删除操作） testOnBorrow=false :: 223.4 ms testOnBorrow=true :: 1067.51 ms

C3PO – ComboPooledDataSource 100 个事务（插入操作）的平均时间 testConnectionOnCheckout=false :: 220.08 ms testConnectionOnCheckout=true :: 661.44 ms

100 个事务的平均时间（删除操作） testConnectionOnCheckout=false :: 216.52 ms testConnectionOnCheckout=true :: 648.29 ms

结论：在 DBCP 中设置 testOnBorrow=true 或在 C3PO 中设置 testConnectionOnCheckout=true 会影响性能 3-4 倍。是否有任何其他设置可以提高性能。

——杜尔加·普拉萨德

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T20:48:59.877

“双重”表/对象名称是一种 Oracle 构造，MySQL 支持它以实现兼容性 - 或者为没有目标但人们希望感到温暖和模糊的查询提供目标。例如

```
select curdate() 
```

可

```
select curdate() from dual 
```

有人可能会嗅探您是否正在运行 Oracle。

# ios - 在 iOS 中检索 HTTPResponse/HTTPRequest 状态代码？

> ID：917932
> 
> 赞同：28
> 
> 时间：2009-05-27T20:43:10.730
> 
> 标签：ios, objective-c, nsurlconnection

我需要检查和评估我的 iPhone 应用程序中的 HTTP 状态代码。我有一个 NSURLRequest 对象和一个 NSURLConnection 成功（我认为）连接到该站点：

```
// create the request
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.apple.com/"]
                        cachePolicy:NSURLRequestUseProtocolCachePolicy
                    timeoutInterval:60.0];
// create the connection with the request
// and start loading the data
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
if (theConnection) {
    // Create the NSMutableData that will hold
    // the received data
    // receivedData is declared as a method instance elsewhere
    receivedData=[[NSMutableData data] retain];
} else {
    // inform the user that the download could not be made
} 
```

我在这里得到了这个代码：[https ://web.archive.org/web/20100908130503/http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html](https://web.archive.org/web/20100908130503/http://developer.apple.com/iphone/library/documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html)

但它（据我所知）并没有说明访问 HTTP 状态代码的任何内容。

如何建立与站点的连接，然后检查该连接的 HTTP 状态代码？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-27T20:48:12.810

我就是这样做的：

```
 #pragma mark -
    #pragma mark NSURLConnection Delegate Methods
    - (void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse*)response {
         NSHTTPURLResponse* httpResponse = (NSHTTPURLResponse*)response;
         int responseStatusCode = [httpResponse statusCode];
    } 
```

但是我使用的是异步 NSURLConnection，所以这可能对你没有帮助。但我希望它无论如何！

# iphone - 适用于 iPhone 移动 web 应用程序的工具包是什么？

> ID：917935
> 
> 赞同：16
> 
> 时间：2009-05-27T20:44:20.557
> 
> 标签：iphone, web-applications

我知道一些有助于为 iPhone 和 ipod Touch 创建 webapps 的 Javascript 框架：

*   乔·休伊特的 iui—— [http://code.google.com/p/iui/](http://code.google.com/p/iui/)
*   Ciui -- CNET 的 Vladimir Olexa 对 Joe 的工作进行了修订 -- [http://code.google.com/p/ciui-dev/](http://code.google.com/p/ciui-dev/)
*   WebApp——由 Chrilith 提供。[http://webapp.net.free.fr/](http://webapp.net.free.fr/)不幸的是，他直到发布后才发布他的代码。

我倾向于Ciui，但想要你的想法。

你为 iPhone webapps 使用哪个工具包？

谢谢，

拉里

从答案中添加以下内容：

*   [芽核](http://www.sproutcore.com/)
*   [JQuery Mobile——](http://jquerymobile.com/)仍在开发中。来自 JQuery 团队
*   [JQtouch](http://www.jqtouch.com/) ——JQuery 的超集。库大小的可能问题
*   [卡布奇诺](http://cappuccino.org/)——Ryan McCuaig 评论：280 North。在哲学上，他们将 Cocoa 和 Objective-C 移植到 Javascript 环境中（一直到 Javascript 的 Objective-C 样式语法扩展和重用 NIB 文件。非常不可思议）。
*   [眨眼](http://www.winktoolkit.org)
*   [徐](http://github.com/brianleroux/xui/tree/master)
*   [乔](http://www.joapp.com/)由戴夫巴尔默（[博客](http://davebalmer.wordpress.com/)）。专为与[PhoneGap](http://www.phonegap.com/)一起使用而设计，它可用于为 iPhone、iPad、Android 构建 Web 应用程序，以及为 iPhone、Android、webOS 和 Symbian 构建本机应用程序（通过 PhoneGap）。观看[演示视频](http://www.youtube.com/watch?v=wOjfKA23Of8)。将 res 设置为 720p 以读取屏幕。
*   [Zepto.js](http://zeptojs.com/)由 Thomas Fuchs 出名
*   [ChocolateChip-UI](http://www.chocolatechip-ui.com/index.html)

**JQtouch vs JQuery** 添加于 2010 年 12 月 12 日。这是 Dave Oliver 在公共板上关于 JQtouch vs JQuery mobile 的评论：JQuery Mobile 是超越 JQTouch 的又一进化步骤。JQTouch 现在是稳定的（并且特性包含在 Sencha Touch 框架中），而 JQuery Mobile 目前仅处于 Alpha 状态。

在“吸取了 JQTouch 的教训”之后，JQuery Mobile 采用了一些新的理念，可能会或可能不会符合您的喜好。除其他外，它定义了“跨平台的外观和感觉”（尽管稍后会添加 JQuery 的自动主题生成器的一个版本）。相比之下，JQTouch 是中性的（尽管您必须做一些工作才能使您的外观和感觉看起来像您想要的那样）。

您有时听到的有关 JQTouch 的主要缺点是缺少固定位置的页脚和子窗格滚动（原因：iPhone 原生应用程序具有这些功能）。事实证明，其他聪明人已经通过 JQTouch 内部的工作方式解决了这个问题（例如，参见 iScroll）。

我认为 JQuery 团队正在开发一个非常引人注目的产品，我认为它会引起很多兴趣和额外的社区审查，这很好。但是，在实际应用中对其进行了试验，在这一点上，它对于生产使用来说有点太新了。正如他们所说，“注意这个空间”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-05T16:26:18.583

Apple 在 Dashcode 中提供了一些工具来快速制作具有原生外观的基本 Web 应用程序。

但...

我一直发现我被大量难以理解的 div 和事件侦听器意大利面条所淹没，它们在 jQuery/Prototype 级别工作。我们正在考虑将几个抽象级别提升到 MVC 框架中。我们觉得我们需要的是相当于 Cocoa Touch 的网络应用程序。

我们正在调查的两个是：

1.  [Sproutcore](http://www.sproutcore.com/)，据我了解，Apple 将其用于他们的 Mobile Me 网络应用程序，

2.  [卡布奇诺](http://cappuccino.org/)，北 280 号。在哲学上，他们将 Cocoa 和 Objective-C 移植到 Javascript 环境中（一直到 Javascript 的 Objective-C 样式语法扩展和重用 NIB 文件。非常不可思议）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T02:15:24.677

根据我非常尊重的 Flickr 团队的说法，你不应该使用框架。相反，专注于通过小尺寸和仔细的 http 查询来榨取所有可能的性能：

**“1\. 不要使用 JavaScript 库或 CSS 框架”**

[Flickr 开发者博客文章](http://code.flickr.com/blog/2008/10/27/lessons-learned-while-building-an-iphone-site/)

# autoconf - Automake 和同名文件

> ID：917948
> 
> 赞同：5
> 
> 时间：2009-05-27T20:48:52.107
> 
> 标签：autoconf, automake, libtool

我有一个 C++ autoconf 托管项目，我正在调整它以在 FreeBSD 主机上编译。最初的系统是 Linux，所以我做了一个 AM_CONDITIONAL 来区分我正在构建的主机并将代码分成系统特定的文件。

配置.ac

```
AC_CANONICAL_HOST
AM_CONDITIONAL（[IS_FREEBSD]，假）
案例$主机在
        *自由*）    
            AC_DEFINE([IS_FREEBSD],[1],[FreeBSD 主机])
            AM_CONDITIONAL（[IS_FREEBSD]，真）
            BP_ADD_LDFLAG([-L/usr/local/lib])
                ;;
经社理事会

```

生成文件.am

```
lib_LTLIBRARIES=mylib.la
mylib_la_SOURCES=a.cpp \
                 b.cpp

如果 IS_FREEBSD
    mylib_la_SOURCES+=freebsd/c.cpp
别的
    mylib_la_SOURCES+=linux/c.cpp
万一

```

当我运行 automake 时，它​​会失败并显示以下消息：

```
Makefile.am：由 `linux/c.cpp' 和 `freebsd/c.cpp' 创建的对象 `c.lo'

```

即使在 Makefile.in 构建过程中，关于如何配置 automake 以尊重此条件的任何想法？

如果文件有不同的名称，我可以这样做，但它是 c++ 代码，我试图保持文件名与类名相同。

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-28T07:37:38.570

您可以请求在其各自的子目录中构建对象

```
AUTOMAKE_OPTIONS = subdir-objects 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-08-10T14:16:06.460

*除了subdir-objects*之外，另一种选择是为每个子项目提供一些自定义的每个项目构建标志。执行此操作时，automake 会更改其 *.o 命名规则，以将目标名称添加到模块名称之前。例如，这个：

```
mylib_la_CXXFLAGS=$(AM_CXXFLAGS)
mylib_la_SOURCES=a.cpp b.cpp 
```

将导致输出文件 mylib_la-ao 和 mylib_la-bo，而不是 ao 和 bo 因此，您可以有两个不同的项目，它们具有相同的输出目录，每个项目都有一个 b.cpp 文件，并且它们的输出不会冲突。

请注意，我通过将项目特定的 CXXFLAGS 设置为 automake 已经使用的值 AM_CXXFLAGS 来做到这一点。Automake 不够聪明，无法检测到这个技巧并使用较短的 *.o 名称。如果碰巧你确实需要每个项目的构建选项，你当然可以这样做而不是这个 hack。

有一个[完整](http://www.delorie.com/gnu/docs/automake/automake_45.html)的 automake 变量列表，当在每个可执行文件的基础上设置时，它们会产生相同的效果。例如，也许一个子项目已经需要特殊的链接标志，所以你给它一些类似的东西：

```
mylib_la_LDFLAGS=-lfoo 
```

这将为您提供前缀 *.o 文件，就像 AM_CXXFLAGS 技巧一样，只是现在您“合法地”使用此功能，而不是欺骗 automake 这样做。

顺便说一句，仅仅基于它所构建的操作系统来改变程序的构建方式是不好的 autoconf 风格。好的 autoconf 风格是只检查特定的平台功能，而不是整个平台，因为平台会发生变化。FreeBSD 在今天可能是某种方式，但也许在下一个版本中，它将从 Linux 复制一个特性，从而消除您以两种不同方式构建程序的需要。或者，您今天使用的功能可能已被弃用，并将在下一个版本中删除。

在 autotools、grasshopper 中有 40 年的可移植 Unix 编程智慧。我上面给出的“也许”过去*已经*发生过，而且肯定会再次发生。测试单个功能是应对不断变化的平台的最灵活的方法。

您也可以从这种方法中获得意想不到的好处。例如，也许你的程序需要两个不可移植的特性来完成它的工作。假设在 FreeBSD 上，这些是 A 和 B 特性，而在 Linux 上，它们是 X 和 Y 特性；A 和 X 是相似的机制，但具有不同的接口，B 和 Y 相同。可能是特性 A 来自原始 BSD，并且在 Solaris 中，因为它具有来自 80 年代 SunOS 的 BSD 根源，而 Solaris 也具有90 年代初基于 System V 的重新设计中的 Y 功能。通过测试这些特性，您的程序也可以在 Solaris 上运行，因为它具有您的程序需要的特性，只是与 FreeBSD 和 Linux 上的组合不同。

# .net - “激活上下文生成失败”投诉尝试添加应用程序清单

> ID：917957
> 
> 赞同：6
> 
> 时间：2009-05-27T20:50:36.690
> 
> 标签：.net, manifest, side-by-side

我正在尝试向我的 .NET 2.0 EXE 添加需要提升的应用程序清单。我已经为一个简单的 EXE 做到了这一点，它没有任何问题，但在这个更复杂的 EXE 上它不起作用。

我的 EXE 在我的解决方案中有一个配置文件和许多其他 DLL 的依赖项。

当我启动 EXE 时，我得到一个 SideBySide 错误说“ `Activation context generation failed for "C:\MyCompany.MyProduct.WinUI.exe".Error in manifest or policy file "C:\MyCompany.MyProduct.WinUI.exe.Config" on line 1\. Invalid Xml syntax.`”

我的配置文件与清单文件有什么关系？这是我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<asmv1:assembly manifestVersion="1.0" xmlns="urn:schemas-microsoft-com:asm.v1"
                xmlns:asmv1="urn:schemas-microsoft-com:asm.v1"
                xmlns:asmv2="urn:schemas-microsoft-com:asm.v2"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <assemblyIdentity version="2.10.0.0" name="MyCompany.MyProduct.WinUI"/>
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v2">
    <security>
      <requestedPrivileges xmlns="urn:schemas-microsoft-com:asm.v3">
        <requestedExecutionLevel level="requireAdministrator" uiAccess="false" />
      </requestedPrivileges>
    </security>
  </trustInfo>
</asmv1:assembly> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-28T15:27:44.363

我找到了解决方案。

不支持在 MyCompany.MyProduct.WinUI.exe.Config 中指定的编码。

```
<?xml version="1.0" encoding="iso-8859-1"?> 
```

我将编码更改为utf-8，一切正常...

```
<?xml version="1.0" encoding="utf-8"?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T20:54:22.407

您没有关闭 asmv1:assembly 标签。

此外，尝试下载[XML Notepad](http://www.microsoft.com/DownLoads/details.aspx?FamilyID=72d6aa49-787d-4118-ba5f-4f30fe913628&displaylang=en)并将您的 XML 加载到其中。它非常善于告诉你你做错了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-19T15:57:08.123

我的问题是我的应用程序配置中有无效的 XML，应用程序设置元素以两个引号结尾->“”

一旦我删除了第二个->“我的控制台应用程序运行良好，这是一个误导性的错误。

# .net - 如何约束泛型参数以实现基本数学运算符？

> ID：917961
> 
> 赞同：4
> 
> 时间：2009-05-27T20:51:22.787
> 
> 标签：.net, vb.net

有没有办法可以做到这一点？

我想要一个 T 的集合类，它能够对 T 类型进行加法、减法。我想保持 T 通用，而不是使用相同代码但类型不同的几个集合。

您将如何约束通用 T ？

示例：我想定义一个集合（T 为 IDoMaths）。我不想使用命名方法创建自己的整数等类来执行操作，因为我认为它会更慢。这部分代码实际上被非常频繁地调用，并且往往是性能的瓶颈。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-27T20:56:47.690

不幸的是你不能。

作为[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/)的一部分，Marc Gravell[实现](http://www.yoda.arachsys.com/csharp/miscutil/usage/genericoperators.html)了一种解决方法（也有[更一般的文章](http://www.yoda.arachsys.com/csharp/genericoperators.html)）。它很整洁，但是您确实会丢失静态类型检查。

与此类似（就丢失类型检查而言）`dynamic`，C# 4.0 的新特性允许您以任意方式使用运算符，仅在执行时解析它们：

```
dynamic x = 10.0;
dynamic y = 3.0;
double z = x / y; // z = 3.3333333 (double arithmetic)

dynamic a = 10;
dynamic b = 3;
int c = a / b; // c = 3 (integer arithmetic) 
```

就在今天下午，我用它来实现一个动态形式的[`Enumerable.Sum`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.sum.aspx). 我即将对其进行基准测试。Marc Gravell最近也写了一篇关于此[的博客文章。](http://marcgravell.blogspot.com/2009/05/exploring-40-expression-and-dynamic.html)

如果您使用的是 VB，则可能只`Option Strict`关闭您想要后期绑定的代码部分会产生相同的效果，但我对 VB 的熟悉程度不如对 C# 的熟悉，恐怕。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-27T21:40:12.860

如果您想要一个更简单但涉及更多冗余的替代解决方案，您可以尝试我刚刚提出的一些方法。这里的一个优点是它是完全类型安全的。

这是一个快速的脏版本，它实现了 int 和 float 的 + 和 - 操作。扩展它以包含更多操作以及支持更多原始类型（双精度、十进制等）甚至是自定义类型应该是微不足道的。只需将 GenericMath 替换为您需要的任何内容。

```
class Program
{
    static void Main(string[] args)
    {
        var gsInt = new GenericMath<int,IntOperators>();
        var gsFloat = new GenericMath<float,FloatOperators>();

        var intX = gsInt.Sum( 2, 3 );
        var floatX = gsFloat.Sum( 2.4f, 3.11f );
    }
}

interface IOperators<T>
{
    T Sum( T a, T b );
    T Difference( T a, T b );
}

sealed class IntOperators : IOperators<int>
{
    public int Sum( int a, int b ) { return a + b; }
    public int Difference( int a, int b ) { return a - b; }
}

sealed class FloatOperators : IOperators<float>
{
    public float Sum( float a, float b ) { return a + b; }
    public float Difference( float a, float b ) { return a + b; }
}

class GenericMath<T,Y>
    where Y : IOperators<T>, new()
{
    private readonly static Y Ops = new Y();

    public T Sum( T a, T b )
    {
        return Ops.Sum( a, b );
    }

    public T Difference( T a, T b )
    {
        return Ops.Difference( a, b );
    }
} 
```

# c++ - IMovieControl::Run 在 Windows XP 上失败？

> ID：917963
> 
> 赞同：0
> 
> 时间：2009-05-27T20:51:36.093
> 
> 标签：c++, windows, com, directshow

实际上，它只会在第二次调用时失败。我正在使用无窗口控件来播放视频内容，当控件仍在屏幕上时，正在播放的视频可能会发生变化。第一次构建图表后，我们通过停止播放、更换`SOURCE`过滤器并再次运行图表来切换媒体。这在 Vista 下运行良好，但在 XP 上运行时，第二次调用`Run()`返回`E_UNEXPECTED`.

初始化是这样的：

```
// Get the interface for DirectShow's GraphBuilder
mGB.CoCreateInstance(CLSID_FilterGraph, NULL, CLSCTX_INPROC_SERVER);

// Create the Video Mixing Renderer and add it to the graph
ATL::CComPtr<IBaseFilter> pVmr;
pVmr.CoCreateInstance(CLSID_VideoMixingRenderer9, NULL, CLSCTX_INPROC);
mGB->AddFilter(pVmr, L"Video Mixing Renderer 9");

// Set the rendering mode and number of streams
ATL::CComPtr<IVMRFilterConfig9> pConfig;
pVmr->QueryInterface(IID_IVMRFilterConfig9, (void**)&pConfig);
pConfig->SetRenderingMode(VMR9Mode_Windowless);
pVmr->QueryInterface(IID_IVMRWindowlessControl9, (void**)&mWC); 
```

当我们决定播放一部电影时，这就是我们所做的。是从DirectShow 示例区域`RenderFileToVideoRenderer`中借来的。`dshowutil.h`

```
// Release the source filter, if it exists, so we can replace it.
IBaseFilter *pSource = NULL;
if (SUCCEEDED(mpGB->FindFilterByName(L"SOURCE", &pSource)) && pSource)
{
    mpGB->RemoveFilter(pSource);
    pSource->Release();
    pSource = NULL;
}

// Render the file.
hr = RenderFileToVideoRenderer(mpGB, mPlayPath.c_str(), FALSE);

// QueryInterface for DirectShow interfaces
hr = mpGB->QueryInterface(&mMC);
hr = mpGB->QueryInterface(&mME);
hr = mpGB->QueryInterface(&mMS);

// Read the default video size
hr = mpWC->GetNativeVideoSize(&lWidth, &lHeight, NULL, NULL);
if (hr != E_NOINTERFACE)
{
    if (FAILED(hr))
    {
        return hr;
    }

    // Play video at native resolution, anchored at top-left corner.
    RECT r;
    r.left = 0;
    r.top = 0;
    r.right = lWidth;
    r.bottom = lHeight;
    hr = mpWC->SetVideoPosition(NULL, &r);
}

// Run the graph to play the media file
if (mMC)
{
    hr = mMC->Run();
    if (FAILED(hr))
    {
        // We get here the second time this code is executed.
        return hr;
    }
    mState = Running;
}

if (mME)
{
    mME->SetNotifyWindow((OAHWND)m_hWnd, WM_GRAPHNOTIFY, 0);
} 
```

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T21:57:48.690

1.  在删除源过滤器之前尝试调用[IMediaControl::StopWhenReady 。](http://msdn.microsoft.com/en-us/library/dd390179(VS.85).aspx)
2.  你什么时候直接调用QueryInterface？您可以使用 CComQIPtr<> 为您扭曲 QI。这样您就不必调用 Release，因为它会被自动调用。
    语法如下所示：`CComPtr<IMediaControl> mediaControl = pGraph;`
3.  在 FindFilterByName() 中，不是传递实时指针，而是传递一个 CComPtr，因此您不必显式调用 release。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T17:46:21.617

从来没有解决这个问题。`IGraphBuilder::Release`生产解决方案是从头开始调用和重建整个图表。切换视频时会出现 CPU 峰值和轻微的重绘延迟，但它没有我们担心的那么明显。

# google-apps - 获取 Google Apps 域的用户计数

> ID：917967
> 
> 赞同：3
> 
> 时间：2009-05-27T20:52:36.327
> 
> 标签：google-apps

您如何获取 Google Apps 域中的用户总数？我知道使用 Google Provisioning API 的[“检索域中的所有用户”调用](http://code.google.com/apis/apps/gdata_provisioning_api_v2.0_reference.html)，但我宁愿不执行如此密集的调用只是为了计算所有用户。有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-01T14:47:48.593

我找到了一个不像检索所有用户那样占用大量资源的解决方案：[Google Reporting API](http://code.google.com/apis/apps/reporting/google_apps_reporting_api.html#Summary_Report)可用于获取 Google Apps 域中的帐户总数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-25T19:43:03.237

Google Apps Admin Settings API 允许您检索域中的当前用户数和最大用户数：

[https://developers.google.com/google-apps/admin-settings/#retrieving_the_current_number_of_users_in_a_domain](https://developers.google.com/google-apps/admin-settings/#retrieving_the_current_number_of_users_in_a_domain)

这将比报告 API 更可取，因为它的流量较低且更接近实时（报告仅每 24 小时更新一次，因此不会考虑最近添加的用户）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T20:56:40.563

您可以尝试“检索域中的所有昵称”，这可以节省一些带宽，因为它希望真的只检索昵称，尽管我认为这不会让您获得确切的计数，因为“检索用户的所有昵称”似乎意味着用户可以有多个昵称。

如果您有一些测试域，还要确保检索所有用户确实是太多开销，并请记住，根据您想要做什么，您可能可以围绕它构建某种缓存，仅在之后执行完整请求缓存早于 X。

# django - 自定义 Django 管理模板

> ID：917973
> 
> 赞同：3
> 
> 时间：2009-05-27T20:54:32.593
> 
> 标签：django, forms, admin

我想在 Django 中修改一个管理模板。

```
 % cat /Library/Python/2.5/site-packages/django/contrib/admin/templates/admin/includes/fieldset.html 
<fieldset class="module aligned {{ fieldset.classes }}">
  {% if fieldset.name %}<h2>{{ fieldset.name }}</h2>{% endif %}
  {% if fieldset.description %}<div class="description">{{ fieldset.description|safe }}</div>{% endif %}
  {% for line in fieldset %}
      <div class="form-row{% if line.errors %} errors{% endif %} {% for field in line %}{{ field.field.name }} {% endfor %} ">
      {{ line.errors }}
      {% for field in line %}
      <div{% if not line.fields|length_is:"1" %} class="field-box"{% endif %}>
          {% if field.is_checkbox %}
              {{ field.field }}{{ field.label_tag }}
          {% else %}
              {{ field.label_tag }}{{ field.field }}
          {% endif %}
          {% if field.field.field.help_text %}<p class="help">{{ field.field.field.help_text|safe }}</p>{% endif %}
      </div>
      {% endfor %}
      </div>
  {% endfor %}
</fieldset> 
```

什么样的对象是字段，更具体地说，我将如何获得字段的名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-28T04:49:03.670

`field`是[`AdminField`](http://code.djangoproject.com/browser/django/trunk/django/contrib/admin/helpers.py#L82)和`field.field`的一个实例[`BoundField`](http://code.djangoproject.com/browser/django/trunk/django/forms/forms.py#L338)，因此您可以使用以下方式引用字段名称：

`{{ field.field.name }}`

一旦你开始深入研究管理定制，它是唯一真正缺乏文档的地方。话虽如此，如果您花时间研究它，代码编写得很好并且易于理解，恕我直言。

文件不多，所以花一个晚上通读一遍。在您的情况下，我将从：

*   [`contrib/admin/sites.py`](http://code.djangoproject.com/browser/django/trunk/django/contrib/admin/sites.py)
*   [`contrib/admin/options.py`](http://code.djangoproject.com/browser/django/trunk/django/contrib/admin/options.py)
*   [`contrib/admin/helpers.py`](http://code.djangoproject.com/browser/django/trunk/django/contrib/admin/helpers.py)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:59:35.990

你[做过研究](http://docs.djangoproject.com/en/dev/ref/contrib/admin/#overriding-admin-templates)吗？

之后，我将开始研究调用您的模板的 python 代码。我想该字段来自[表单系统](http://docs.djangoproject.com/en/dev/topics/forms/)

> Field 负责进行验证的类，例如确保其数据是有效电子邮件地址的 EmailField。

# java - Hibernate 可嵌入继承

> ID：917974
> 
> 赞同：9
> 
> 时间：2009-05-27T20:54:38.507
> 
> 标签：java, hibernate, inheritance, mapping

我有一个对象，其字段可以是多种对象类型。此对象在单个表中编码，其中包含字段子类型的鉴别器列。这些子类型中的每一个都将其字段映射到父对象表中的列。我似乎无法在休眠中对此进行建模。`getSubfield()`无论表中的子类型数据是什么，下面的代码都将返回 null 。

*架构*

```
  id 类型 whosit whatsit  
+----+------+--------+---------+
| 1 | “一个” | “测试” | 空 |
| 2 | "B" | 空 | “测试” |
+----+------+--------+---------+

```

*领域对象*

```
@Entity
public class Parent {
    protected @Id @GeneratedValue int id;
    protected Subfield subfield;

    public Subfield getSubfield() {return subfield;} 
}

@Embeddable
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="type", discriminatorType=DiscriminatorType.STRING)
public abstract class Subfield {}

@DiscriminatorValue("A")
public class TypeA extends Subfield {
    public String whosit;
}

@DiscriminatorValue("B")
public class TypeB extends Subfield {
    public String whatsit;
} 
```

*“从父 p 中选择 p”*

```
{id=1,subfield=null}
{id=2,subfield=null} 
```

是否有可能用这个对象模型完成我想要的，或者我需要更多的创意（这是一个遗留数据库，不推荐更改架构）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-20T19:00:28.410

正如提问者所指出的，hibernate 不支持可嵌入类的继承（[https://hibernate.atlassian.net/browse/HHH-1910](https://hibernate.atlassian.net/browse/HHH-1910)）。

根据 Eclipse wiki，JPA 没有指定这种行为，但 EclipseLink 确实支持它（[http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Entities/Embeddable#Inheritance](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Entities/Embeddable#Inheritance)）。

我的建议是在 Subfield 内完全粉碎类层次结构。可怕，但应该工作，直到解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-27T21:34:25.290

好的，您不能轻易更改架构，但是添加几个视图怎么样？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-07T12:31:04.430

我知道这是旧的。

解决此问题的一种方法是如上所述。创建视图。您说您不想更改架构。然后不要。您可以创建一个新架构来映射旧架构并执行您想要的操作。（可能取决于数据库）

# java - 远程休眠标准

> ID：917977
> 
> 赞同：0
> 
> 时间：2009-05-27T20:56:01.797
> 
> 标签：java, hibernate, criteria

我有多个服务调用我的数据库服务，它使用 Hibernate，我希望远程服务能够创建一个查询，然后将其传递给进程。理想情况下，我想传递一个 Criteria Object，但看起来它需要一个他们无法访问的 Session。是否有类似于我可以使用的 Criteria Object 的过程？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-27T20:58:11.853

使用 DetachedCriteria (org.hibernate.criterion.DetachedCriteria)

# web-services - 消费服务消费其他服务

> ID：917981
> 
> 赞同：2
> 
> 时间：2009-05-27T20:57:27.097
> 
> 标签：web-services, language-agnostic, exception-handling

在我实际尝试调用其操作合同之前，确认这些使用的服务实际上已启动并运行的最佳方法是什么？我想这样做，以便我可以优雅地向客户展示一些信息，给他/她一个更愉快的用户体验。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:09:34.653

我创建了一个`IsAvailable`方法来检查我的服务的所有底层依赖项。我的客户会在对我的服务执行任何其他操作之前调用此方法。如果它返回 true，我的服务就可以使用了。

如果底层依赖项之一在事务发生时不可用，我们还会进行中间检查以回滚任何更改。

**例子：**

这是客户端如何使用我的 IsAvailable 的简单示例：

可用代码

```
[WebMethod]
public bool IsAvailable()
{
    bool EverythingUpAndRunning = true;

    try
    {
        string TestConnectionString = WebConfigurationManager.ConnectionStrings["Sql"].ConnectionString;
        SqlConnection sqlConnection = new SqlConnection(TestConnectionString);
        sqlConnection.Open();
        sqlConnection.Close();
        sqlConnection.Dispose();
    }
    catch(Exception ex)
    {
        EverythingUpAndRunning = false;
    }

    return EverythingUpAndRunning;
} 
```

客户端代码：

```
MyWebService proxy = new MyWebService();
if(proxy.IsAvailable)
{
    //if true, you can use the other available methods in the service
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T21:06:59.747

我不认为自己是 SO 社区的一员，但我以前也遇到过这种情况，这是围绕服务调用进行的简单异常处理。如果您可以控制服务，则可以设置一个返回其当前状态的状态方法。如果网络出现故障并且您甚至无法访问该服务，那么您将不得不通过一些异常处理来处理它，但如果父服务无法使用它的子服务，您可以获得状态返回。

但是，如果您遵循我自己的观点，那么您不应该担心消耗的服务消耗其他服务。

# java - 如何在 Java 应用程序中播放 .SWF？

> ID：917982
> 
> 赞同：0
> 
> 时间：2009-05-27T20:57:32.510
> 
> 标签：java, flash

谁能告诉我如何在 Java 应用程序中播放 SWF 文件，*或者*有没有人知道一个免费的插件可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T04:13:39.830

您还可以查看 JFlashPlayer。[http://www.jpackages.com/jflashplayer/](http://www.jpackages.com/jflashplayer/)

我只玩了一点，但它确实有开发者许可费。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T21:24:47.417

也许你可以试试[JSwiff](http://www.jswiff.com/)。我自己从未使用过它，但它似乎非常有用，而且它是开源的；）

# python - 我应该什么时候开始考虑迁移到 Python 3？

> ID：917987
> 
> 赞同：4
> 
> 时间：2009-05-27T20:59:18.280
> 
> 标签：python, python-3.x

> **可能重复：**
> [为什么不切换到 Python 3.x？](https://stackoverflow.com/questions/766636/why-wont-you-switch-to-python-3-x)

我看到已经有很多重复的问题询问新的 Python 程序员是否应该学习 2 或 3。我不是在问这个问题。

我已经是一名 Python 2 程序员了。几年前我开始修补它。大约一年前，我几乎只将它用于我的个人项目。我什至最近从 PHP 工作转到了 Python 工作。然而，这一切都发生在 Python 2 中。

Python 3 现已推出，我知道它与 2 不向后兼容，尽管它很相似。我认为我在学习 Python 3 时不会遇到任何问题。但是，如果有必要，我将在转换旧代码时遇到问题。此外，如果开发工作从 Python 2 转移到 Python 3，我就不会被困在已弃用的平台上进行开发。

目前看来，Python 2 仍然很强大，并没有真正推动向 3 过渡。不过，这不可能永远持续下去。我应该什么时候开始行动？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-27T21:02:38.973

我能给你的最好的答案是在你需要的时候改变。如果您不需要 Python 3，请不要切换。如果您不确定是否需要切换，很可能您不需要。

也就是说，一旦 Python 3 成为更广泛使用的版本（在几年内，而不是很快），您可能会想要切换，因为它会得到更多支持（更多库等）。

如果您没有任何 Python 2 特定的库，您可以在 Python 3 中编写新项目以简化过渡，但此时您不需要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T21:02:22.673

如果你现在可以切换，你也可以。学习最新的东西对未来总是有帮助的。

既然你一直在使用 2，那么不用担心你不会知道如何使用它。

# c# - 自学正则表达式还是 xpath 查询？

> ID：917995
> 
> 赞同：0
> 
> 时间：2009-05-27T21:03:11.640
> 
> 标签：c#, .net, regex, xpath

是否可以编写生成正则表达式或 XPath 的代码来解析基于某些 HTML 文档的链接？

我想要的是解析一些链接的页面。我唯一知道的是页面上的大部分链接都是这些链接。

举个简单的例子，以 Google 搜索引擎结果页面为例，例如[this](http://www.google.com/search?hl=en&q=stackoverflow&btnG=Google-search)。大多数链接来自搜索结果，如下所示：

```
<h3 class="r"><a onmousedown="return rwt(this,'','','res','1','AFQjCNERidL9Hb6OvGW93_Y6MRj3aTdMVA','')" class="l" href="http://stackoverflow.com/"><em>Stack Overflow</em></a></h3> 
```

是否有可能编写代码来学习并识别这一点并能够解析所有链接，即使谷歌改变了他们的表现形式？

我正在考虑解析所有链接，并在每个标签之前和之后查看 X 字符，然后从中工作。

我知道这也可以用 XPath 来完成，但问题仍然是一样的。我可以解析此内容并生成有效的 XPath 来查找 serp 链接吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-27T21:37:45.440

如果我理解你的问题，真的没有必要写一个学习算法。正则表达式足够强大，可以解决这个问题。您可以使用以下正则表达式获取 HTML 页面中的所有链接：

```
(?<=href=")[^"]+(?=") 
```

在[Regex Hero](http://www.regexhero.com/)中验证，此正则表达式使用正向后视和正向前瞻来获取 href="" 内的 url。

如果您想更进一步，您还可以查找锚标记以确保您获得实际的锚链接，而不是对 css 文件或其他内容的引用。你可以这样做：

```
(?<=<a[^<]+href=")[^"]+(?=") 
```

只要页面遵循链接的 href="" 约定，这应该可以正常工作。如果他们使用 onclick 事件，那么一切都会变得更加复杂，因为您将要处理 Javascript 的不可预测性。甚至 Google 也不会抓取 Javascript 链接。

这有帮助吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T21:39:36.293

据我了解，大多数机器学习算法在它们有许多可以概括“智能”行为的示例时效果最好。在这种情况下，您没有太多示例。谷歌不太可能经常改变他们的格式。即使我们感觉很频繁，但对于机器学习算法来说可能还不够。

监视当前格式可能更容易，如果它发生变化，请更改您的代码。如果您将预期格式设置为可配置的正则表达式，则可以重新部署新格式，而无需重新构建项目的其余部分。

# python - 如何在日期时间字段中按时间过滤？

> ID：917996
> 
> 赞同：7
> 
> 时间：2009-05-27T21:03:17.960
> 
> 标签：python, django

在模型中“输入”是一个日期时间字段。我想查询数据以查找中午（开始时间）和下午 5:00（结束时间）之间的所有条目。

```
selected = Entry.objects.filter(entered__gte=start_time, entered__lte=end_time) 
```

（正如我所料）我收到以下错误：

```
"ValidationError: Enter a valid date/time in YYYY-MM-DD HH:MM[:ss[.uuuuuu]] format." 
```

所以我知道我可以使用 __year 所以我尝试了。

```
selected = Entry.objects.filter(entered__time__gte=start_time, entered__time__lte=end_time) 
```

我收到以下错误：

```
"FieldError: Join on field 'start' not permitted. Did you misspell 'time' for the lookup type?" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-27T21:21:34.723

我不相信对此有内置支持，但您可以传递[额外的 where 子句](http://docs.djangoproject.com/en/dev/ref/models/querysets/#extra-select-none-where-none-params-none-tables-none-order-by-none-select-params-none)参数（警告：这里可能会引入与 DB 相关的行为）。

例如，在 Postgres 上，类似：

```
Entry.objects.extra(where=['EXTRACT(hour from entered) >= 12 and '\
                    'EXTRACT(hour from entered) < 17']) 
```

如果您使用可能不安全的输入来确定值`12`和`17`，请注意，您还可以为 extra 指定一个 params 选项，以确保正确引用和转义，然后`%s`在 where 语句中使用标准 sql 占位符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-28T14:19:16.917

以 SQLite 为例，一个相对干净和通用的解决方案是：

```
Entry.objects.extra(where=["time(entered) between '%s' and '%s'"],
                    params=[start_time.strftime("%H:%M"), end_time.strftime("%H:%M")]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-28T14:28:59.347

您可以使用 db 的机制在 python 中进行过滤：

```
for e in Entry.objects.all():
   if i.entered.hour>= 9 and i.entered.hour < 17 :# or break down to minutes/seconds
        list.append(e) 
```

但我认为这两种解决方案都很丑陋。

史蒂夫，你必须决定，什么对你来说不那么丑：

*   在for循环中处理大量数据，
*   或使用 .extra(..) 并绕过 orm 系统

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T22:31:01.573

您是否为和提供了[日期时间对象](http://docs.python.org/library/datetime.html#datetime-objects)？`start_time``end_time`

快速试用：

```
class Entry(models.Model):
    entered = models.DateTimeField()

>>> from datetime import datetime
>>> Entry(entered = datetime.now()).save()
>>> Entry.objects.filter(entered__lte = datetime.now())
[<Entry: Entry object>]
>>> Entry.objects.filter(entered__gte = datetime.now())
[]
>>> Entry.objects.filter(entered__gte = datetime.now(), entered__lte=datetime(2009,11,1,0,0))
[<Entry: Entry object>] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-15T18:10:45.050

我建议 filter`x<=arg`和 exclude `x>=arg2`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-11T17:36:07.677

我刚刚想出了一个类似用例的解决方案——也许有人觉得这很有用：

就我而言，我有这样的可用性和约束模型（简化）：

```
class Availability(...):
    start = models.DateTimeField()
    end = models.DateTimeField()

class Constraint(...):
    from = models.TimeField()
    to = models.TimeField() 
```

我想找到不违反任何约束的可用性。

使用 Postgres，这对我有用：

```
Availability.objects.extra(
    where=['NOT (start::time, "end"::time) OVERLAPS (\'{0}\'::time, \'{1}\'::time)'.format(
        from.strftime("%H:%M"), to.strftime("%H:%M")
    )]
) 
```

请注意如何`DateTime`转换为`Time`（或者更确切地说`timestamp`是`time without timezone`Postgres 术语），`::time`然后用于`OVERLAPS`比较时间范围。

关于原始问题，您还可以执行以下操作：

```
Availability.objects.extra(
    where=['start::time BETWEEN \'{0}\'::time AND \'{1}\'::time AND
            "end"::time BETWEEN \'{0}\'::time AND \'{1}\'::time'.format(
        from.strftime("%H:%M"), to.strftime("%H:%M")
    )]
) 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2014-02-18T08:17:43.820

您可以使用范围在两者之间进行过滤。我发现这是最好的过滤方式，因为 SQL 的过滤效果比 Django 好。

```
fromRange=datetime.datetime.strptime(request.GET.get('from'),'%Y-%m-%dT%H:%M:%S.%fZ')
toRange=datetime.datetime.strptime(request.GET.get('to'),'%Y-%m-%dT%H:%M:%S.%fZ')

entry = Entry.objects.filter(entryTime__range=(fromRange,toRange)) 
```

# .net - VS 2008 Toolbox 显示同一控件的多个实例

> ID：917998
> 
> 赞同：1
> 
> 时间：2009-05-27T21:03:25.930
> 
> 标签：.net, asp.net, visual-studio-2008

我的笔记本上有 VS 2008 Team Suite，当我创建网页并打开工具箱时，我看到同一个控件的多个实例。有没有什么办法解决这一问题？

类似的问题[在这里](https://stackoverflow.com/questions/283238/my-toolbox-show-multiple-copies-of-the-same-control-vs2008)。我尝试了发布的唯一解决方案，它没有用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-27T21:37:33.570

该工具箱是完全可定制的。您可以右键单击工具箱并单击“**选择项目...** ”以向工具箱添加/删除东西。它有时会变得混乱，这就是为什么那里还有一个“**重置工具箱**”。

如果问题比那更深，我发现了这篇文章（看起来文章是针对 Windows XP 上的 VS2005，不知道如何将其转换为 Windows Vista 上的 VS2008）

[http://accidentaltechnologist.com/microsoft/visual-studio/fixing-the-toolbox-in-visual-studio-2005/](http://accidentaltechnologist.com/microsoft/visual-studio/fixing-the-toolbox-in-visual-studio-2005/)

基本上列出了这些步骤

1.  关闭 Visual Studio
2.  找到目录 - C:\Documents and Settings\\Local Settings\Application Data\Microsoft\VisualStudio\8.0
3.  删除所有名为 Toolbox.* 的文件（其中有 4 个）
4.  重新启动 Visual Studio

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-28T13:56:14.933

除了删除 Toolbox* 文件之外，我还删除了 .suo 文件，然后我还必须运行以下命令：

devenv /重置设置

开发环境/设置

devenv /resetskippkgs

devenv.exe /InstallVSTemplates

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-27T21:32:14.327

您尝试右键单击工具箱并选择**重置工具箱**？

可能值得一试，虽然没有在我的身上尝试过 - 我有太多自定义标签要松开抱歉**:)**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-27T21:39:38.167

这是自 2005 版（甚至更早）以来的常见问题。

右键单击并选择重置应该可以解决问题。****