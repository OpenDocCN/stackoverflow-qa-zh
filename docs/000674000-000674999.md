# StackOverflow 问答 000674000-000674999

# excel - 如何避免excel、SSRRS报告中较粗的边框宽度？

> ID：674007
> 
> 赞同：1
> 
> 时间：2009-03-23T16:08:30.373
> 
> 标签：excel, reporting-services, report

在我的 SSRS 报告中，当我将边框设为“实心”时，它在其 excel 版本中的边框比 excel 的正常边框宽度更厚。有没有人遇到过这样的情况。避免这种情况的可能解决方案是什么。

拜托，我将不胜感激您对此的所有帮助。

提前致谢。

苏尼

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T16:12:58.133

是的，我们也遇到了这个问题。1pt“实心”边界是 Excel 中 20 英尺厚的墙，有利于击退野蛮入侵者和潮汐。我们通过将边框宽度设置为 0.5pt，“实心”来解决这个问题。这在 Excel 中产生了我们想要的结果（“平均”宽度边界线，或多或少），并且在实际报告中看起来仍然很好（打印时，我会注意）。

# c++ - 如何在 .NET 中使用托管 DLL 中的非托管类？

> ID：674009
> 
> 赞同：1
> 
> 时间：2009-03-23T16:09:05.257
> 
> 标签：c++, dll, unmanaged, dllimport

我有一个*非托管类*，我试图从*托管*DLL 文件中进行 dllexport。我正在尝试在另一个*托管*DLL 文件中使用非托管类。但是，当我尝试这样做时，会出现*链接*错误。

我已经用非托管 DLL 文件做了很多次，所以我知道它是如何工作的。我知道如何在托管类中使用“公共参考”等。

我需要在某个地方设置一些标志吗？还是我必须做一些 DllImport 魔术？

这是在 .NET 2.0 和[Visual Studio 2005](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005)上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T17:16:10.103

如果您想使用托管代码中的非托管类，您可以：

1.  使用一些讨厌的[P/Invoke](http://en.wikipedia.org/wiki/Platform_Invocation_Services)来加载类成员函数（构造函数、析构函数等）并制作一个更糟糕的托管包装类来调用“真正的”成员函数。当涉及虚拟方法时，情况会变得更糟。
2.  第二种选择（在我看来更好）是编写一个[C++/CLI](http://en.wikipedia.org/wiki/C++/CLI)包装类（您提到您对此很熟悉），它是非托管类的简单代理。对于非托管类中的每个成员函数，代理类中都会有一个类似的成员函数。然后，这是一个从托管项目中添加对该 DLL 的引用的简单案例，您将能够像使用任何其他 .NET 类一样使用您的类。考虑到如果你的类暴露了其他非托管的东西（那些不能被编组的东西），你会遇到更多的工作。

如果您需要有关第二个选项的更多信息，我可以查找一些旧链接来更多地解释此技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:19:37.743

您需要为非托管库或 COM 组件使用互操作程序集。这是[一个链接](http://www32.brinkster.com/srisamp/netArticles/article_16.htm)，其中包含有关此的良好信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:20:16.790

如果它是一个 COM DLL 文件，那么您可以使用 COM .NET 互操作性。堆栈溢出问题*[是否有访问 C++ 本机 COM 函数以与 C# 互操作的最佳实践？](https://stackoverflow.com/questions/671837)*是另一个回答这个问题的问题。

# concurrency - 如何使用 Erlang 风格的并发“共享状态”？

> ID：674016
> 
> 赞同：3
> 
> 时间：2009-03-23T16:11:49.680
> 
> 标签：concurrency, erlang

Erlang 处理参与者之间的消息传递，因为它是并发模型。

假设我**有 3 个卖物品的演员**。商品总数为 7。**他们如何准确地卖出 7 件商品**？他们如何协调自己？我们可以有一个具有可用项目数量的参与者，根据“购买”消息（库存参与者）进行操作。不过，这将是一个**SPOF**。

当使用消息队列而不是锁进行并发时，Java 等其他语言中的并发性也是如此。

（最好没有**Amdahl**瓶颈）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T17:42:05.203

您有一个代表事物的流程 - 在本例中为库存。其他流程要买的时候，他们问库存，你有吗？我可以买吗？

代表交付的流程将告诉库存，这里有 20 件新事物...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T08:19:34.580

我将实现一个负责库存管理的服务器进程，例如使用 dets 或 Mnesia 表作为后端。此过程可能是监督树的一部分，因此如果失败，它将自动重新启动。我的推销员进程——你上面提到的 3 个演员——与这个服务器进程通信，询问他们出售的物品。只要有足够的物品就没有问题，否则销售人员会得到该物品已售罄的答案-另一个过程会获得购买新物品的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:18:50.037

这些演员是在真空中表演的吗？他们必须有 7 个买家或库存中有 7 件商品。也许排队的买家或库存商店应该协调他们。

# algorithm - 按关键字在数据存储中搜索相关主题

> ID：674017
> 
> 赞同：7
> 
> 时间：2009-03-23T16:11:53.330
> 
> 标签：algorithm

例如，StackOverflow 如何判断其他问题是否相似？

当我输入上面的问题，然后点击到这个备忘录控件时，我看到了一个现有问题的列表，这些问题可能与我要问的问题相同。

使用什么技术来查找类似问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:20:41.750

我在 3 月 20 日收到来自 team@stackoverflow.com 的电子邮件，其中提到了它的工作原理：

> “提问”搜索仅针对标题，不会匹配正文中的任何内容。为什么人们认为它更好，对我来说是个谜。

最后一句话指的是搜索栏，我发现当我试图查找我已经看过的特定问题时，它的用处不大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:15:57.050

我认为这是简单的旧词匹配。但是，我可能会补充一点，这个功能并不像我希望的那样好用。使用 site:stackoverflow.com 前缀进行谷歌搜索比依靠 SO 提供相关建议要好得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:16:50.387

匹配程序将存储所有问题的索引。当您提出问题时，您问题中的所有关键字都会与索引匹配。这类似于谷歌搜索。[Lucene](http://lucene.apache.org/java/docs/)开源搜索可以（并且很有可能已经）用于此目的。由于结果不是很准确，我假设他们只是索引问题的标题，作为一个近似值。

另一个相关的关键词是[协同过滤](http://en.wikipedia.org/wiki/Collaborative_filtering)，亚马逊推广的算法，根据其他类似客户的行为推荐产品。在当前情况下，基于协同过滤的替代算法是：从问题中提取关键字，然后找到与关键字相关联的标签（在历史中）。返回具有这些标签的问题。那么，需要进行实验来看看它是否有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T16:21:35.960

很差——我相信使用 MS SQL 全文搜索。使用 Lucene，IMO，你会有更好的运气。有关该主题的更多背景信息，请参阅有关[Lucene的 Wikipedia 文章或](http://en.wikipedia.org/wiki/Lucene)[信息检索](http://en.wikipedia.org/wiki/Information_retrieval)的一般主题。

# jquery - JSON 服务在失败/错误时应该返回什么

> ID：674027
> 
> 赞同：79
> 
> 时间：2009-03-23T16:15:49.157
> 
> 标签：jquery, web-services, json

我正在用 C#（.ashx 文件）编写 JSON 服务。在对服务的成功请求时，我返回一些 JSON 数据。如果请求失败，要么是因为抛出异常（例如数据库超时），要么是因为请求在某些方面是错误的（例如，数据库中不存在的 ID 作为参数给出）服务应该如何响应？哪些 HTTP 状态代码是合理的，我应该返回任何数据（如果有）？

我预计该服务将主要使用 jQuery.form 插件从 jQuery 调用，jQuery 或此插件是否有任何默认方式来处理错误响应？

**编辑：**我决定在成功时使用 jQuery + .ashx + HTTP [状态代码] 我将返回 JSON，但在错误时我将返回一个字符串，因为这似乎是 jQuery 的错误选项。阿贾克斯期望。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2009-03-23T16:39:21.797

请参阅[此问题](https://stackoverflow.com/questions/574035/how-to-handle-db-constraint-violations-in-the-user-interface)，了解适合您情况的最佳实践。

最重要的建议（来自所述链接）是标准化您的处理程序查找的响应结构（成功和失败），在服务器层捕获所有异常并将它们转换为相同的结构。例如（来自[这个答案](https://stackoverflow.com/questions/574035/how-to-handle-db-constraint-violations-in-the-user-interface/575092#575092)）：

```
{
    success:false,
    general_message:"You have reached your max number of Foos for the day",
    errors: {
        last_name:"This field is required",
        mrn:"Either SSN or MRN must be entered",
        zipcode:"996852 is not in Bernalillo county. Only Bernalillo residents are eligible"
    }
} 
```

这是 stackoverflow 使用的方法（如果您想知道其他人是如何做这种事情的）；无论是否允许投票，都可以写入诸如投票具有`"Success"`和字段之类的操作：`"Message"`

```
{ Success:true, NewScore:1, Message:"", LastVoteTypeId:3 } 
```

正如[@Phil.H 指出的那样](https://stackoverflow.com/questions/674027/what-should-a-json-service-return-on-failure-error#674046)，无论您选择什么，都应该保持一致。这说起来容易做起来难（开发中的一切都是如此！）。

例如，如果您在 SO 上提交评论太快，而不是保持一致并返回

```
{ Success: false, Message: "Can only comment once every blah..." } 
```

SO 将抛出一个服务器异常 ( ) 并在其回调`HTTP 500`中捕获它。`error`

尽管使用 jQuery + `.ashx`+ HTTP [状态代码] IMO“感觉不错”，但它会给您的客户端代码库增加比其价值更多的复杂性。意识到 jQuery 不会“检测”错误代码，而是缺少成功代码。在尝试使用 jQuery 围绕 http 响应代码设计客户端时，这是一个重要的区别。您只有两个选择（是“成功”还是“错误”？），您必须自己进一步分支。如果您有少量 Web 服务驱动少量页面，那可能没问题，但任何规模较大的东西都可能会变得混乱。

在`.asmx`WebService（或 WCF）中返回自定义对象比自定义 HTTP 状态代码要自然得多。此外，您还可以免费获得 JSON 序列化。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-03-23T16:20:34.340

您返回的 HTTP 状态代码应取决于已发生的错误类型。如果数据库中不存在 ID，则返回 404；如果用户没有足够的权限进行 Ajax 调用，则返回 403；如果数据库在能够找到记录之前超时，则返回 500（服务器错误）。

jQuery 自动检测此类错误代码，并运行您在 Ajax 调用中定义的回调函数。文档：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

`$.ajax`错误回调的简短示例：

```
$.ajax({
  type: 'POST',
  url: '/some/resource',
  success: function(data, textStatus) {
    // Handle success
  },
  error: function(xhr, textStatus, errorThrown) {
    // Handle error
  }
}); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-03-23T16:18:46.167

使用 HTTP 状态代码将是一种 RESTful 方式来执行此操作，但这建议您使用资源 URI 等使接口的其余部分成为 RESTful。

事实上，根据你的喜好定义接口（返回一个错误对象，例如，用错误详细说明属性，以及解释它的一大块 HTML 等），但是一旦你决定了在原型中工作的东西，无情一致。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-23T16:19:24.013

我认为如果你只是冒泡一个异常，它应该[在为 'error' 选项传入的 jQuery 回调中](http://docs.jquery.com/Ajax)处理。（我们还将服务器端的这个异常记录到中央日志中）。不需要特殊的 HTTP 错误代码，但我也很想看看其他人在做什么。

这就是我所做的，但这只是我的 $.02

如果您打算使用 RESTful 并返回错误代码，请尝试遵守 W3C 规定的标准代码：http: [//www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-08-03T07:58:04.000

我花了几个小时来解决这个问题。我的解决方案基于以下愿望/要求：

*   在所有 JSON 控制器操作中不要有重复的样板错误处理代码。
*   保留 HTTP（错误）状态代码。为什么？因为更高级别的关注不应该影响较低级别的实现。
*   当服务器发生错误/异常时能够获取 JSON 数据。为什么？因为我可能想要丰富的错误信息。例如错误消息、特定领域的错误状态代码、堆栈跟踪（在调试/开发环境中）。
*   易于使用的客户端 - 最好使用 jQuery。

我创建了一个 HandleErrorAttribute（有关详细信息的说明，请参见代码注释）。包括“使用”在内的一些细节被遗漏了，因此代码可能无法编译。我在 Global.asax.cs 中的应用程序初始化期间将过滤器添加到全局过滤器，如下所示：

```
GlobalFilters.Filters.Add(new UnikHandleErrorAttribute()); 
```

属性：

```
namespace Foo
{
  using System;
  using System.Diagnostics;
  using System.Linq;
  using System.Net;
  using System.Reflection;
  using System.Web;
  using System.Web.Mvc;

  /// <summary>
  /// Generel error handler attribute for Foo MVC solutions.
  /// It handles uncaught exceptions from controller actions.
  /// It outputs trace information.
  /// If custom errors are enabled then the following is performed:
  /// <ul>
  ///   <li>If the controller action return type is <see cref="JsonResult"/> then a <see cref="JsonResult"/> object with a <c>message</c> property is returned.
  ///       If the exception is of type <see cref="MySpecialExceptionWithUserMessage"/> it's message will be used as the <see cref="JsonResult"/> <c>message</c> property value.
  ///       Otherwise a localized resource text will be used.</li>
  /// </ul>
  /// Otherwise the exception will pass through unhandled.
  /// </summary>
  [AttributeUsage(AttributeTargets.Class | AttributeTargets.Method)]
  public sealed class FooHandleErrorAttribute : HandleErrorAttribute
  {
    private readonly TraceSource _TraceSource;

    /// <summary>
    /// <paramref name="traceSource"/> must not be null.
    /// </summary>
    /// <param name="traceSource"></param>
    public FooHandleErrorAttribute(TraceSource traceSource)
    {
      if (traceSource == null)
        throw new ArgumentNullException(@"traceSource");
      _TraceSource = traceSource;
    }

    public TraceSource TraceSource
    {
      get
      {
        return _TraceSource;
      }
    }

    /// <summary>
    /// Ctor.
    /// </summary>
    public FooHandleErrorAttribute()
    {
      var className = typeof(FooHandleErrorAttribute).FullName ?? typeof(FooHandleErrorAttribute).Name;
      _TraceSource = new TraceSource(className);
    }

    public override void OnException(ExceptionContext filterContext)
    {
      var actionMethodInfo = GetControllerAction(filterContext.Exception);
      // It's probably an error if we cannot find a controller action. But, hey, what should we do about it here?
      if(actionMethodInfo == null) return;

      var controllerName = filterContext.Controller.GetType().FullName; // filterContext.RouteData.Values[@"controller"];
      var actionName = actionMethodInfo.Name; // filterContext.RouteData.Values[@"action"];

      // Log the exception to the trace source
      var traceMessage = string.Format(@"Unhandled exception from {0}.{1} handled in {2}. Exception: {3}", controllerName, actionName, typeof(FooHandleErrorAttribute).FullName, filterContext.Exception);
      _TraceSource.TraceEvent(TraceEventType.Error, TraceEventId.UnhandledException, traceMessage);

      // Don't modify result if custom errors not enabled
      //if (!filterContext.HttpContext.IsCustomErrorEnabled)
      //  return;

      // We only handle actions with return type of JsonResult - I don't use AjaxRequestExtensions.IsAjaxRequest() because ajax requests does NOT imply JSON result.
      // (The downside is that you cannot just specify the return type as ActionResult - however I don't consider this a bad thing)
      if (actionMethodInfo.ReturnType != typeof(JsonResult)) return;

      // Handle JsonResult action exception by creating a useful JSON object which can be used client side
      // Only provide error message if we have an MySpecialExceptionWithUserMessage.
      var jsonMessage = FooHandleErrorAttributeResources.Error_Occured;
      if (filterContext.Exception is MySpecialExceptionWithUserMessage) jsonMessage = filterContext.Exception.Message;
      filterContext.Result = new JsonResult
        {
          Data = new
            {
              message = jsonMessage,
              // Only include stacktrace information in development environment
              stacktrace = MyEnvironmentHelper.IsDebugging ? filterContext.Exception.StackTrace : null
            },
          // Allow JSON get requests because we are already using this approach. However, we should consider avoiding this habit.
          JsonRequestBehavior = JsonRequestBehavior.AllowGet
        };

      // Exception is now (being) handled - set the HTTP error status code and prevent caching! Otherwise you'll get an HTTP 200 status code and running the risc of the browser caching the result.
      filterContext.ExceptionHandled = true;
      filterContext.HttpContext.Response.StatusCode = (int)HttpStatusCode.InternalServerError; // Consider using more error status codes depending on the type of exception
      filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);

      // Call the overrided method
      base.OnException(filterContext);
    }

    /// <summary>
    /// Does anybody know a better way to obtain the controller action method info?
    /// See http://stackoverflow.com/questions/2770303/how-to-find-in-which-controller-action-an-error-occurred.
    /// </summary>
    /// <param name="exception"></param>
    /// <returns></returns>
    private static MethodInfo GetControllerAction(Exception exception)
    {
      var stackTrace = new StackTrace(exception);
      var frames = stackTrace.GetFrames();
      if(frames == null) return null;
      var frame = frames.FirstOrDefault(f => typeof(IController).IsAssignableFrom(f.GetMethod().DeclaringType));
      if (frame == null) return null;
      var actionMethod = frame.GetMethod();
      return actionMethod as MethodInfo;
    }
  }
} 
```

我为客户端的易用性开发了以下 jQuery 插件：

```
(function ($, undefined) {
  "using strict";

  $.FooGetJSON = function (url, data, success, error) {
    /// <summary>
    /// **********************************************************
    /// * UNIK GET JSON JQUERY PLUGIN.                           *
    /// **********************************************************
    /// This plugin is a wrapper for jQuery.getJSON.
    /// The reason is that jQuery.getJSON success handler doesn't provides access to the JSON object returned from the url
    /// when a HTTP status code different from 200 is encountered. However, please note that whether there is JSON
    /// data or not depends on the requested service. if there is no JSON data (i.e. response.responseText cannot be
    /// parsed as JSON) then the data parameter will be undefined.
    ///
    /// This plugin solves this problem by providing a new error handler signature which includes a data parameter.
    /// Usage of the plugin is much equal to using the jQuery.getJSON method. Handlers can be added etc. However,
    /// the only way to obtain an error handler with the signature specified below with a JSON data parameter is
    /// to call the plugin with the error handler parameter directly specified in the call to the plugin.
    ///
    /// success: function(data, textStatus, jqXHR)
    /// error: function(data, jqXHR, textStatus, errorThrown)
    ///
    /// Example usage:
    ///
    ///   $.FooGetJSON('/foo', { id: 42 }, function(data) { alert('Name :' + data.name); }, function(data) { alert('Error: ' + data.message); });
    /// </summary>

    // Call the ordinary jQuery method
    var jqxhr = $.getJSON(url, data, success);

    // Do the error handler wrapping stuff to provide an error handler with a JSON object - if the response contains JSON object data
    if (typeof error !== "undefined") {
      jqxhr.error(function(response, textStatus, errorThrown) {
        try {
          var json = $.parseJSON(response.responseText);
          error(json, response, textStatus, errorThrown);
        } catch(e) {
          error(undefined, response, textStatus, errorThrown);
        }
      });
    }

    // Return the jQueryXmlHttpResponse object
    return jqxhr;
  };
})(jQuery); 
```

我能从这一切中得到什么？最后的结果是

*   我的控制器操作都没有对 HandleErrorAttributes 的要求。
*   我的控制器操作都不包含任何重复的样板错误处理代码。
*   我有一个单点错误处理代码，允许我轻松更改日志记录和其他与错误处理相关的内容。
*   一个简单的要求：返回 JsonResult 的控制器操作必须具有返回类型 JsonResult，而不是像 ActionResult 这样的基本类型。原因：见 FooHandleErrorAttribute 中的代码注释。

客户端示例：

```
var success = function(data) {
  alert(data.myjsonobject.foo);
};
var onError = function(data) {
  var message = "Error";
  if(typeof data !== "undefined")
    message += ": " + data.message;
  alert(message);
};
$.FooGetJSON(url, params, onSuccess, onError); 
```

欢迎评论！有一天我可能会在博客上介绍这个解决方案......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T16:55:56.843

我肯定会返回一个带有描述错误条件的 JSON 对象的 500 错误，类似于[ASP.NET AJAX "ScriptService" 错误返回](http://encosia.com/2009/03/04/use-jquery-to-catch-and-display-aspnet-ajax-service-errors/)的方式。我相信这是相当标准的。在处理潜在的意外错误条件时，保持这种一致性绝对是件好事。

另外，如果您是用 C# 编写的，为什么不直接使用 .NET 中的内置功能呢？WCF 和 ASMX 服务可以轻松地将数据序列化为 JSON，而无需重新发明轮子。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-05-27T15:29:46.167

Rails 脚手架用于`422 Unprocessable Entity`处理这些类型的错误。有关详细信息，请参阅[RFC 4918](https://www.rfc-editor.org/rfc/rfc4918#section-11.2)。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-01-15T10:07:30.260

是的，您应该使用 HTTP 状态代码。并且最好以某种标准化的 JSON 格式返回错误描述，例如[诺丁汉的提案](https://datatracker.ietf.org/doc/html/draft-nottingham-http-problem)，请参阅[apigility 错误报告](https://apigility.org/documentation/api-primer/error-reporting)：

> API 问题的有效负载具有以下结构：
> 
> *   **type**：描述错误条件的文档的 URL（可选，如果没有提供，则假定为“about:blank”；应该解析为*人类可读的*文档；Apigility 总是提供这个）。
> *   **title**：错误条件的简短标题（必需；并且对于相同**类型**的每个问题都应该是相同的；Apigility 总是提供这个）。
> *   **status**：当前请求的 HTTP 状态码（可选；Apigility 总是提供这个）。
> *   **detail**: error details specific to this request (optional; Apigility requires it for each problem).
> *   **instance**: URI identifying the specific instance of this problem (optional; Apigility currently does not provide this).

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-05T22:40:45.510

如果用户提供了无效数据，那肯定是一个`400 Bad Request`（*请求包含错误的语法或无法完成。*）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-23T16:19:37.180

我认为您不应该返回任何 http 错误代码，而是返回对应用程序客户端有用的自定义异常，以便界面知道实际发生了什么。我不会尝试用 404 错误代码或类似的东西来掩盖真正的问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-07-18T09:31:54.410

对于服务器/协议错误，我会尽量使用 REST/HTTP（与您在浏览器中输入 URL 进行比较）：

*   一个不存在的项目被称为 (/persons/{non-existing-id-here})。返回 404。
*   服务器上发生意外错误（代码错误）。返回 500。
*   客户端用户无权获取资源。返回 401。

对于特定于域/业务逻辑的错误，我会说该协议以正确的方式使用并且没有服务器内部错误，因此请使用错误 JSON/XML 对象或您喜欢用任何您喜欢的方式来描述您的数据进行响应（将此与您填写的内容进行比较网站上的表格）：

*   用户想要更改其帐户名称，但用户尚未通过单击发送给用户的电子邮件中的链接来验证其帐户。返回 {"error":"Account not verify"} 或其他。
*   用户想要订购一本书，但该书已售出（数据库中的状态已更改）并且无法再订购。返回 {"error":"图书已售出"}。

# python - Django syncdb 锁定表创建

> ID：674030
> 
> 赞同：3
> 
> 时间：2009-03-23T16:16:18.030
> 
> 标签：python, django, django-syncdb

我添加了新模型并推送到我们的登台服务器，运行 syncdb 来创建他们的表，它锁定了。它达到'创建表photos_photousertag'并且postgres输出显示创建'photos_photousertag_id_seq'的通知，但除此之外我什么都没有说。我无法 ctrl+c 同步数据库进程，并且我不知道从这里采取什么路线。有没有其他人遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T16:30:12.210

我们使用 postgres，虽然我们没有遇到这个特定问题，但您可能会发现一些步骤对调试很有帮助：

一个。您使用的是什么版本的 postgres 和 psycopg2？就此而言，什么版本的 django？

湾。尝试使用“--verbosity=2”选项运行 syncdb 命令以显示所有输出。

C。通过运行“manage.py sql”命令找到 django 正在生成的 SQL。在 postgres shell 中为您的新模型运行 CREATE TABLE 语句，看看会发生什么。

d。将 postgres 上的错误日志、语句日志和服务器状态日志调高，看看您是否可以捕获任何特定消息。

过去，我们通常发现选项 b 或选项 c 都指出了问题所在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T20:35:57.660

我也刚刚经历过这种情况，结果证明它只是那个特定表上的一个普通旧锁，与 Django 无关。一旦清除，同步就很好了。

尝试查询同步卡住的表，并首先确保它正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-21T09:53:51.577

这里也很奇怪，但**只需重新启动 PostgreSQL 服务（或服务器）即可**解决。我也尝试在 psql 中手动粘贴表创建代码，但这也没有解决它（好吧，如果它是一个锁定的东西，它就不可能） - 所以我只是使用了重新启动：

> systemctl 重启 postgresql.service

那在我的 Suse 盒子上。

不确定*重新加载*服务/服务器是否也会解除现有的表锁？

# java - 有没有一种优雅的方法可以将 ISO 639-2（3 个字母）语言代码转换为 Java 语言环境？

> ID：674041
> 
> 赞同：16
> 
> 时间：2009-03-23T16:17:59.353
> 
> 标签：java, localization, locale

例如 eng、spa、ita、ger

我可以迭代所有语言环境并比较代码，但我想知道是否有更优雅和高性能的方式来实现这一点......

非常感谢任何提示:)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-23T16:34:33.633

我不知道是否有一种简单的方法可以将 3 字母转换为 2 字母版本，但在更糟糕的情况下，您可以创建它们的 Map，如下所示：

```
String[] languages = Locale.getISOLanguages();
Map<String, Locale> localeMap = new HashMap<String, Locale>(languages.length);
for (String language : languages) {
    Locale locale = new Locale(language);
    localeMap.put(locale.getISO3Language(), locale);
} 
```

现在你可以使用类似的东西来查找语言环境`localeMap.get("eng")`；

编辑：修改了地图的创建方式。现在每种语言应该有一个对象。

编辑 2：已经有一段时间了，但是在初始化 Map 时更改了代码以使用语言数组的实际长度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T16:26:11.470

您可以使用 constructor `Locale(String language)`，其中语言是 2 个字母的 ISO-639-1 代码。我认为将 ISO-639-2 转换为 ISO-639-1 的最简单方法是创建`HashMap<String,String>`常量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:53:08.830

我项目中的一些修改代码，有类似的要求。我们有自己的历史时区格式，所以我们不能使用标准库。

```
public class MyProjectTimeZoneFactory  {

   private static Map timeZoneDb;

   /**
   * Set up our timezone id mappings; call this from any constructor
   * or static method that needs it.
   */
   private static void init() {
      if(null == TimeZoneDb) {
         timeZoneDb = new HashMap();   // Maybe a TreeMap would be more appropriate
         timeZoneDb.put("     ","GMT+00");
         timeZoneDb.put("EAD  ","GMT+10");
         timeZoneDb.put("JST  ","GMT+9");
         // etc.
       }
   }

   public static TimeZone getTimeZone(String id) 
                          throws CommandFormatException {
       init();

       TimeZone tz;
       if(timeZoneDb.containsKey(id)) {
           tz = TimeZone.getTimeZone((String)timeZoneDb.get(id));
       } else {
           throw new CommandFormatException("Invalid Timezone value");
       }

       return tz;
   }

 } 
```

您可能会争辩说，将地图放在配置中而不是代码中会更好 - 也许在属性文件中。这可能是真的——但请记住实用程序员的规则“你不需要它”。

# javascript - 使用 CSS 均匀分布元素

> ID：674045
> 
> 赞同：25
> 
> 时间：2009-03-23T16:18:43.063
> 
> 标签：javascript, css

[今天Smashing Magazine 上出现](http://www.smashingmagazine.com/2009/03/23/ask-sm-equal-spacing-css-image-replacement-max-side-on-images/)了一种使用 CSS 在容器中均匀分布元素的方法。

我最近不得不使用 Javascript 来为可变宽度的元素实现相同的效果，但是 SM 上提出的方法让我想知道是否可以在没有 Javascript 的情况下做到这一点。

有[这个问题](https://stackoverflow.com/questions/601096/distributing-inline-elements-using-css)，[gargantaun](https://stackoverflow.com/users/64586/gargantaun)说：

> 恕我直言，你可能不想听到这个，但设计可能有缺陷。众所周知，使用 CSS 在布局中均匀分布项目是一种痛苦，因此设计师应该避免使用它。

但我不能告诉设计师改变他的设计，我不同意CSS的缺点应该限制设计师。

无论如何，这就是我在 HTML 中的内容（翻译和简化）：

```
<div id="menu">
    <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/news">News</a></li>
        <li><a href="/theme">Theme</a></li>
        <li><a href="/activities">Activities</a></li>
        <li><a href="/contact">Contact</a></li>
    </ul>
</div> 
```

在 CSS 中（删除并简化了不相关的属性）：

```
#menu li { float: left; margin-right: 20px; }
#menu a  { display: block; padding: 0 1em; } 
```

在 Javascript 中：

```
function justifyMenu() {
    var menuItems  = $$("#menu li");
    var menuWidth  = $("menu").getWidth();
    var totalWidth = 0;

    menuItems.each(function(e) {
        totalWidth += e.getWidth();
    });

    var margin = (menuWidth - 4 - totalWidth) / (menuItems.length - 1);
    margin = parseInt(margin);

    menuItems.each(function(e) {
        e.setStyle({ marginRight: margin + 'px' });
    });

    menuItems[menuItems.length - 1].setStyle({ marginRight: '0' });
} 
```

这是一个按比例缩小的屏幕截图（查看菜单如何与标题图像对齐）：

[![截屏](https://i.stack.imgur.com/1VNcU.png)](https://i.stack.imgur.com/1VNcU.png)

知道如何在没有 Javascript 的情况下实现这一目标吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2010-08-03T06:27:50.897

当然，这正是*table*元素的用途。看到人们用 CSS 将自己扭成一个死结，这既可悲又可笑，他们中的大多数人甚至不知道他们*为什么*要避免使用表格。

无论出于何种原因，您可能会梦想拒绝表格，它不可能比依靠 Javascript 来布局您的页面更糟糕。

是的，我知道这不是您要寻找的答案，但天哪，它是如此*明显*。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-03-12T06:23:24.723

有人随意声称表格是显而易见的解决方案，但是，还没有真正讨论过如何实现它。我将向您展示将 div 显示为表格是正确的方法，但它不像将所有单元格居中并设置自动宽度那么容易。这样做的问题是您无法控制最左侧和最右侧单元格内容的外边距。它们都从其包含的框中插入了您无法控制的任意数量。这是一个解决方法：

首先对Guder的html稍作修改：

```
<div id="menu">
    <ul>
        <li class="left"><a href="/">Home</a></li>
        <li><a href="/news">News</a></li>
        <li><a href="/theme">Theme</a></li>
        <li><a href="/activities">Activities</a></li>
        <li><a href="/contact">Contact</a></li>
    </ul>
</div> 
```

现在的CSS：

```
#menu {display:table; width:// some width in px //}
#menu ul {display:table-row; width: 100%}
#menu li.left {display: table-cell; text-align: left; width: 20px; white-space:nowrap;}
#menu li {display: table-cell; text-align: right; width: auto;} 
```

现在，我们可以完全控制菜单的最外侧，它们与包含框的最左侧和最右侧对齐，并且每个元素之间的距离是一致的。你会注意到我使用了一个技巧来让最左边的单元格成为它内容的确切宽度。我将 width 属性设置为一个小尺寸，明显低于其通常的内容。然后我将空白设置为不换行，这会最小程度地拉伸单元格以适应单元格的文本。您可以在此处看到显示此效果的图像（使用不同的 html 元素）：

![对猫重复](https://i.stack.imgur.com/6A2bP.png)

这段代码的美妙之处在于它可以接受许多单元格和文本宽度，而无需知道它们的实际宽度，并将它们均匀地分布在页面上。一直以来，左右元素都到达了它们的边界，当然我们所有的 html 都在 div 中，没有浏览器或互联网极客会误导他们相信我们正在呈现表格数据。这里没有已知的妥协！

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-23T17:14:17.127

这就是 display:table-cell 应该实现的 - 但是，IE 只是不这样做，而且 FF<3 也有问题，我相信。

这些样式适用于 FF3、Chrome、Safari 和（我认为）Opera 9：

```
#menu ul {display:table;padding:0;}
#menu li {display:table-cell;text-align:center;} 
```

但是你需要一些技巧才能让它们在通常的商业浏览器中工作。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-27T17:27:23.577

尽管 Colin Brogan 的回答为解决问题提供了坚实的基础，但它仍然取决于文本长度。如果文本太长，“单元格”会更宽，因此左侧有更多空间。我试图根据他的回答中提供的代码来解决这个问题，但我得出的结论是，这个问题对于表格或假表格（display：table-cell）并不是真正可能的解决方案。

所以我们必须等待 CSS3 灵活的盒子模型得到更广泛的支持（你可以[在这里](http://caniuse.com/#feat=flexbox)查看更新的支持）。同时，您可以使用[Flexie polyfill](https://github.com/doctyper/flexie)修补不支持它的浏览器。如果你想检查它现在在 WebKit 上的样子（不需要 polyfill），你可以试试下面的 CSS：

```
#menu ul {
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-pack: justify;
  width: 940px;
  list-style: none;
  padding: 0;
  border: 1px solid gray;
}
#menu li {
  border: 1px solid silver;
} 
```

请注意，它仅使用 WebKit 前缀。如果您决定将其带到生产网站，您还应该为其他浏览器添加前缀。

**这种方法确实接受未知数量的项目和文本宽度，而不知道它们的实际宽度**，并将它们均匀地分布在它们的容器中（在本例中为`#menu ul`）。

如果您决定保守一点，Colin Brogan 建议的方法是最容易接受的，因为您将文本保持在大致相同的长度上。否则，将开始显示更宽的空间。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T17:27:54.177

是的，你可以这样做，只要预先知道要分布的元素的宽度。但这有点乱。

诀窍是，您需要 '(Wp-sum(Wc))/(Nc-1)' 的每个元素之间的间距，即父元素的宽度减去所有子元素的总宽度，在元素之间的间隙数。

因为 CSS 没有做表达式的能力，我们不得不稍微修改一下。首先，我们为大小为“sum(Wc)”的父元素添加边距，即所有子元素的总宽度。所以现在父母有宽度'（Wp-sum（Wc））'，我们可以使用相对于该宽度的百分比填充值。

例如，对于四个尺寸分别为 10px、20px、40px 和 80px 的图像，我们的“sum(Wc)”为 150px。将其设置为父级边距，然后子级可以将该宽度的三分之一作为它们之间的填充。

```
<style type="text/css">
    #nava { width: 10px; height: 20px;}
    #navb { width: 20px; height: 20px;}
    #navc { width: 40px; height: 20px;}
    #navd { width: 80px; height: 20px;}

    #nav { margin-right: 150px; white-space: nowrap; }
    #nava, #navb, #navc { padding-right: 33.3%; }
</style>

<div id="nav"
    ><img id="nava" src="nava.png" alt="a"
    ><img id="navb" src="navb.png" alt="b"
    ><img id="navc" src="navc.png" alt="c"
    ><img id="navd" src="navd.png" alt="d"
></div> 
```

有趣的标签缩进是为了避免图像之间有任何空白。'nowrap' 是必要的，因为父宽度设置为比页面宽度窄，否则将无法容纳行上的所有元素。最后，在 IE 中，您可能需要使用 'width: 100%; 在地块周围添加一个包装 div；如果您跨越整个页面，则溢出：隐藏以防止不需要的滚动条。当然，您会希望处于标准模式。

这也适用于文本元素，如果您将它们设为内联块以便添加填充，并在 ems 中显式调整它们的大小。如果事先不知道子元素的大小（例如，它们包含动态内容），它将不起作用，因为您不知道要使用的 'sum(Wc)' 值。

老实说，我可能只会使用一张桌子。表格布局算法非常顺利地计算如何分配备用表格宽度。（使用“表格布局：固定”以获得已知宽度单元格的最佳结果，或使用“自动”来响应动态内容。）这样您也不必担心像素舍入错误。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T16:22:40.277

如果您使用基于文本的尺寸（em，ex），它会容易得多。然后，您可以处理字母而不是像素。

示例：整个东西是 30 个大写字母 Ms 宽。然后，您可以使用每个导航元素的宽度（基于其文本内容）并从那里静态地进行数学运算。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-11-25T13:05:02.273

这是 jQuery 格式的代码，供任何觉得有用的人使用

```
function justifyClients() {
                        var menuItems  = $("#clients-wrapper ul li").get();                         
                        var menuWidth  = $("#clients-wrapper ul").width();                          
                        var totalWidth = 0;

                        $("#clients-wrapper ul li").each(function(i,e)
                                        {
                                            totalWidth += $(e).width();
                                        });

                        var margin = (menuWidth - 4 - totalWidth) / ($("#clients-wrapper ul li").length - 1);
                        margin = parseInt(margin);

                        $("#clients-wrapper ul li").each(function(i,e) {

                            if(i < $("#clients-wrapper ul li").length - 1)
                            {
                                alert(i + " " + $("#clients-wrapper ul li").length);
                                $(e).css('margin-right',  margin);
                            }
                        });
                    }

                    $(document).ready(function() {
                      justifyClients();
                    }); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-16T14:36:27.190

最佳答案对我不起作用，GarciaWebDev 的答案对我也不起作用，因为我需要支持一些其他浏览器，包括 IE8。

[这种方法](http://dr2ab.wordpress.com/2011/03/24/even-horizontal-spacing-of-menu-items-with-css/)对我有用。这个想法是使包含元素 text-align: justify 并使元素分布 display: inline-block。

HTML：

```
<div id="menu">
    <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/news">News</a></li>
        <li><a href="/theme">Theme</a></li>
        <li><a href="/activities">Activities</a></li>
        <li><a href="/contact">Contact</a></li>
        <li class="filler"></li>
    </ul>
</div> 
```

CSS：

```
#menu {
    text-align: justify;
}

ul {
    margin: 0;
    padding: 0;
}

#menu li {
    display: inline-block;
}

.filler {
    width: 100%;
    height: 0;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-23T16:23:14.783

AFAIK 没有办法仅使用 CSS 来实现这一点。如果这是错误的，请任何人纠正我，请。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-23T16:27:47.910

如果您使用雅虎！用户界面库 (YUI) [grids.css](http://developer.yahoo.com/yui/grids/)，它可能会工作。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-08-08T08:56:11.463

Trevor Dixon 的改进变体（没有额外的`<li>`）

HTML

```
<ul>
    <li><a href="/">Home</a></li>
    <li><a href="/news">News</a></li>
    <li><a href="/theme">Theme</a></li>
    <li><a href="/activities">Activities</a></li>
    <li><a href="/contact">Contact</a></li>
</ul> 
```

CSS

```
ul {
    margin: 0;
    padding: 0;
}
ul li {
    display: inline-block;
    text-align: justify;
}
ul:after{
    display: inline-block;
    content: '';
    width: 100%;
    height: 0;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-12-22T17:49:05.790

演示 - [http://codepen.io/vsync/pen/tFwxu](http://codepen.io/vsync/pen/tFwxu)

如果要制作列表本身`text-align:justify`，然后在其末尾添加一些伪项目并使其填充所有宽度，那么您所需要的一切，以欺骗列表证明其所有项目在其总宽度上的合理性。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-15T08:26:44.833

感谢[**CSS3 Flexbox 模块**](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)，这可以通过两行 CSS 实现。

查看[**Flexbox 的浏览器兼容性表**](http://caniuse.com/#search=flexbox)

**HTML**

```
<div id="menu">
  <ul>
    <li><a href="/">Home</a>
    </li>
    <li><a href="/news">News</a>
    </li>
    <li><a href="/theme">Theme</a>
    </li>
    <li><a href="/activities">Activities</a>
    </li>
    <li><a href="/contact">Contact</a>
    </li>
  </ul>
</div> 
```

**CSS**

```
ul {
  display: flex;
}
li {
  flex: 1; /* Short hand for flex-grow: 1 and flex-shrink: 1 */
} 
```

**输出：**

```
ul, li {
  margin: 0;
  padding: 0;
}
ul {
  display: flex;
  list-style: none;
}
li {
  flex: 1;
  text-align: center;
}
```

```
<div id="menu">
  <ul>
    <li><a href="/">Home</a>
    </li>
    <li><a href="/news">News</a>
    </li>
    <li><a href="/theme">Theme</a>
    </li>
    <li><a href="/activities">Activities</a>
    </li>
    <li><a href="/contact">Contact</a>
    </li>
  </ul>
</div>
```

# c++ - 自定义 cout

> ID：674060
> 
> 赞同：12
> 
> 时间：2009-03-23T16:22:16.330
> 
> 标签：c++, stl, iostream

我如何从中派生一个类`cout`，例如，写入它

`new_cout << "message";`

相当于

`cout << __FUNCTION__ << "message" << "end of message" << endl;`

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-03-23T16:34:05.103

```
class Log
{
public:
    Log(const std::string &funcName)
    {
        std::cout << funcName << ": ";
    }

    template <class T>
    Log &operator<<(const T &v)
    {
        std::cout << v;
        return *this;
    }

    ~Log()
    {
        std::cout << " [end of message]" << std::endl;
    }
};

#define MAGIC_LOG Log(__FUNCTION__) 
```

因此：

```
MAGIC_LOG << "here's a message";
MAGIC_LOG << "here's one with a number: " << 5; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T16:35:45.253

```
#define debug_print(message) (std::cout << __FUNCTION__ << (message) << std::endl) 
```

这样做的好处是您可以在完成后立即禁用所有调试消息

```
#define debug_print(message) () 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:35:42.057

进一步从 Mykola 的响应来看，我的代码中有以下实现。用法是

```
 LOG_DEBUG("print 3 " << 3); 
```

印刷

```
 DEBUG (f.cpp, 101): print 3 3 
```

您可以修改它以使用**FUNCTION**沿/代替**LINE**和**FILE**

```
/// Implements a simple logging facility. 
class Logger
{
        std::ostringstream os_;
        static Logger* instance_;
        Logger();
public:
        static Logger* getLogger();
        bool isDebugEnabled() const;
        void log(LogLevelEnum l, std::ostringstream& os, const char* filename, int lineno) const;
        std::ostringstream& getStream()
        { return os_; }
};

void Logger::log(LogLevelEnum l, std::ostringstream& os, const char* filename, int lineno) const
{
        std::cout << logLevelEnumToString(l) << "\t(" << fileName << ": " << lineno << ")\t- " << os.str();
        os.str("");
}

#define LOG_common(level, cptext) do {\
        utility::Logger::getLogger()->getStream() << cptext; \
        utility::Logger::getLogger()->log(utility::level, utility::Logger::getLogger()->getStream(), __FILE__, __LINE__);  \
} while(0); 

enum LogLevelEnum {
        DEBUG_LOG_LEVEL,
        INFO_LOG_LEVEL,
        WARN_LOG_LEVEL,
        ERROR_LOG_LEVEL,
        NOTICE_LOG_LEVEL,
        FATAL_LOG_LEVEL
};

#define LOG_DEBUG(cptext)    LOG_common(DEBUG_LOG_LEVEL, cptext)
#define LOG_INFO(cptext)     LOG_common(INFO_LOG_LEVEL , cptext)
#define LOG_WARN(cptext)     LOG_common(WARN_LOG_LEVEL , cptext)
#define LOG_ERROR(cptext)    LOG_common(ERROR_LOG_LEVEL, cptext)
#define LOG_NOTICE(cptext)   LOG_common(NOTICE_LOG_LEVEL, cptext)
#define LOG_FATAL(cptext)    LOG_common(FATAL_LOG_LEVEL, cptext)

const char* logLevelEnumToString(LogLevelEnum m)
{
        switch(m)
        {
                case DEBUG_LOG_LEVEL:
                        return "DEBUG";
                case INFO_LOG_LEVEL:
                        return "INFO";
                case WARN_LOG_LEVEL:
                        return "WARN";
                case NOTICE_LOG_LEVEL:
                        return "NOTICE";
                case ERROR_LOG_LEVEL:
                        return "ERROR";
                case FATAL_LOG_LEVEL:
                        return "FATAL";
                default:
                        CP_MSG_ASSERT(false, CP_TEXT("invalid value of LogLevelEnum"));
                        return 0;
        }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:00:33.540

出于记录目的，我使用类似的东西

```
#define LOG(x) \
  cout << __FUNCTION__ << x << endl

// ...
LOG("My message with number " << number << " and some more"); 
```

您的方法的问题是（正如 Mykola Golybyew 解释的那样）**FUNCTION**在编译时处理，因此总是使用非预处理器解决方案打印相同的名称。

如果仅用于将 endl 添加到您的消息中，您可以尝试以下操作：

```
class MyLine {
public:
  bool written;
  std::ostream& stream;
  MyLine(const MyLine& _line) : stream(_line.stream), written(false) { }
  MyLine(std::ostream& _stream) : stream(_stream), written(false) { }
  ~MyLine() { if (!written) stream << "End of Message" << std::endl; }
};

template <class T> MyLine operator<<(MyLine& line, const T& _val) {
  line.stream << _val;
  line.written = true;
  return line;
}

class MyStream {
public:
  std::ostream& parentStream;
  MyStream(std::ostream& _parentStream) : parentStream(_parentStream) { }
  MyLine getLine() { return MyLine(parentStream); }
};

template <class T> MyLine operator<<(MyStream& stream, const T& _val) {
  return (stream.getLine() << _val);
}

int main()
{
      MyStream stream(std::cout);
      stream << "Hello " << 13 << " some more data";
      stream << "This is in the next line " << " 1 ";
    return 0;
} 
```

请注意，重要的是不要从运算符函数返回引用。由于`MyLine`应该仅作为临时对象存在（因为它的析构函数触发了 的写入`endl`），所以第一个对象（由`getLine()`in 中的函数返回`MyStream`）将在`operator<<`调用第二个对象之前被破坏。因此，该`MyLine`对象在每次`operator<<`创建一个新对象时都会被复制。最后一个对象在没有被写入的情况下被破坏，并将消息的结尾写入其析构函数中。

只需在调试器中尝试一下即可了解发生了什么...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T16:28:33.493

你必须重写 operator<<()，但你甚至不必继承 std::cout。您也可以创建一个新对象或使用类似的现有对象。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-23T16:27:26.770

您还可以[覆盖 operator](http://www.cs.uc.edu/~schlipf/SoftDev/week1.pdf)。它将允许您调用另一个函数或前缀/后缀任何将离开输出缓冲区的任何内容：在您的情况下，您将让它输出一个特定的字符串。

# php - SQL_CALC_FOUND_ROWS / FOUND_ROWS() 在 PHP 中不起作用

> ID：674061
> 
> 赞同：18
> 
> 时间：2009-03-23T16:22:24.117
> 
> 标签：php, mysql

我`SQL_CALC_FOUND_ROWS`在 Mysql SELECT 语句中使用，以获取我的 SELECT 将在没有 LIMIT 子句的情况下返回的行数。

```
$sql = new mysqli('localhost', 'root', '');
$sql->select_db('mysql');
$s1 = $sql->query('select SQL_CALC_FOUND_ROWS * from db limit 0, 3');
$s2 = $sql->query('select FOUND_ROWS()');
if($row = $s2->fetch_row()) printf('%d/%d', $s1->num_rows, $row[0]); 
```

在我的 WinXP 开发站上，它在几周内每次都返回 3/0。当我从我的站使用另一个 MySQL 服务器时，它也返回 3/0。在另一台 PC 上，相同的代码运行良好，并返回正确的数字（例如，如果我在 mysql.db 表中有 17 条记录，则为 3/17）。每台 XP PC 都有相同的 PHP/Mysql 版本，并且过去在我的 PC 上运行良好 使用 Mysql Query Browser 和相同的 SQL 查询我得到了正确的数字。

谁能给我一个解决方案的想法，而无需重新安装所有？

抱歉，我之前的要求非常不清楚。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-15T17:34:46.610

谢谢你。

当我在 mysql 命令行上运行与您的示例类似的东西时，它会起作用；但是从php运行它，它失败了。第二个查询必须“了解”第一个查询，所以我认为链接两个查询的持久性/内存被 php.ini 搞砸了。

（事实证明，Wordpress 使用这种类型的查询来进行分页 - 所以我们更大的问题是，当我们迁移到 php 5.2.6 时，wordpress 安装中的分页突然停止工作......最终将其追踪到 FOUND_ROWS( ））。

只是为了为将来可能遇到此问题的人发帖……对我来说，这是 php 设置“mysql.trace_mode” - 这在 5.2.6 中默认为“on”，而不是像以前那样“off”，并且由于某种原因阻止 FOUND_ROWS() 工作。

作为“修复”，我们可以将它放在每个 php 页面中（实际上，在一个常见的“包含”中）：

```
ini_set("mysql.trace_mode", "0"); 
```

或将其添加到 .htaccess：

```
php_value mysql.trace_mode "0" 
```

再次感谢，杰瑞

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-23T16:29:23.257

您是否使用允许多个查询的 MySQL 查询方法。

来自 MySQL 文档。

> 要获取此行数，请在 SELECT 语句中包含一个选项，`SQL_CALC_FOUND_ROWS`然后调用`FOUND_ROWS()`

例子：

```
mysql> SELECT SQL_CALC_FOUND_ROWS * FROM tbl_name
    -> WHERE id > 100 LIMIT 10;
mysql> SELECT FOUND_ROWS(); 
```

`FOUND_ROWS()`也只是为了好玩，这里有一个关于' 使用的竞争条件的精彩讨论[。](http://is.php.net/manual/en/function.mysql-num-rows.php#85654)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-08T23:48:35.380

另一种方法是使用 PHP 手册中所述的 mysqli_multi_query，方法是传递包含 SQL_CALC_FOUND_ROWS 和 FOUND_ROWS 的两个查询，并用分号分隔

```
<?php
$mysqli = new mysqli("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query  = "SELECT SQL_CALC_FOUND_ROWS * FROM db limit 0, 3;";
$query .= "SELECT FOUND_ROWS()";

/* execute multi query */
if ($mysqli->multi_query($query)) {
    do {
        /* store first result set */
        if ($result = $mysqli->store_result()) {
            while ($row = $result->fetch_row()) {
                printf("%s\n", $row[0]);
            }
            $result->free();
        }
        /* print divider */
        if ($mysqli->more_results()) {
            printf("-----------------\n");
        }
    } while ($mysqli->next_result());
}

/* close connection */
$mysqli->close();
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-19T10:48:08.340

最快的解决方案是像这样子查询您的实际查询：

```
SELECT SQL_CALC_FOUND_ROWS * FROM (SELECT whatever FROM whatever WHERE whatever LIMIT whatever) ax; 
select FOUND_ROWS(); 
```

现在你会得到正确的结果。我认为主要原因是`SQL_CALC_FOUND_ROWS`主要跟踪找到的行（即没有`LIMITS`）而不是返回的行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-17T13:51:35.867

我遇到过同样的问题。解决方案很愚蠢，我使用`$wpdb->query`的是`$wpdb->get_var`. 所以你想做

```
$wpdb->get_var('select FOUND_ROWS()'); 
```

如果您使用的是 WordPress

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-26T10:39:07.053

好吧，这是与 php 5.2.6 捆绑在一起的 mysql php 扩展的问题。Mysqli 运行良好，还有另一个 php 版本。很抱歉噪音和不清楚的问题。

如果您有同样的问题，我的建议是重新安装 PHP 或更改版本。

# c# - 在数据库表中持久化枚举

> ID：674064
> 
> 赞同：14
> 
> 时间：2009-03-23T16:22:40.153
> 
> 标签：c#, database-design, enums

我有一个具有状态的订单（在代码中是一个枚举）。问题是如何坚持这一点。我可以：

1.  将字符串保留在字段中，然后在数据检索时映射回枚举。
2.  将其保留为整数，然后在数据检索时映射回枚举。
3.  为枚举值创建单独的表并对数据检索进行连接。

想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T16:27:03.293

如果这是一个固定列表（看起来确实如此，否则您不应该将其存储为枚举），我不会使用 #1。

使用#3 而不是#2 的主要原因是为了便于使用自助查询实用程序。但是，我实际上会使用 #2 的变体：将值存储为整数并映射到数据检索的枚举。但是，还要创建一个表示枚举类型的表，其中值作为 PK，名称作为另一列。这样，您的代码使用起来既简单、快速且高效，而且通过自助查询和其他不使用您的数据访问代码的用途也很容易获得逻辑值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T16:26:52.920

从数据库/规范化的角度来看，#3 是最“合适的”。实际上，您的状态是链接到订单实体的域实体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:25:28.960

hibernate 默认使用整数。如果您的枚举不会经常更改，我认为这不是一个坏主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:26:29.863

我会使用一个整数映射到另一个表中的值和值。然后，您也可以将枚举映射到相同的值，但是您必须在两个位置都进行更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T16:26:30.220

我想这取决于将在哪里检索数据。使用#3，您可以在不依赖 .NET 前端的情况下检索数据。但是您的数据库表也有可能与枚举代码不同步。

选项#2 无疑是最有效的存储方式……但存储​​很便宜。

# python - 如何在仍然记录错误的同时向用户显示错误？

> ID：674067
> 
> 赞同：2
> 
> 时间：2009-03-23T16:22:51.197
> 
> 标签：python, exception-handling, error-handling, pyqt4, error-logging

我正在使用 PyQt4 用户界面。我已将 stderr 重定向到一个日志文件，以便于调试和故障排除，但现在我需要在发生错误时向用户显示错误消息。

我的问题是我需要在异常发生时捕获它并让用户知道它发生了，但仍然让回溯传播到 stderr（即日志文件）。

如果我做这样的事情：

```
def updateResults(self):
    try:
        #code that updates the results
    except:
        #display error message box 
```

这将捕获异常并且不会传播到错误日志。

有没有办法向用户显示消息，然后继续传播错误？

这行得通吗？

```
except, e:
    #display error message box
    raise e 
```

有没有更好的方法来实现我的目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T16:41:55.253

我认为您正在以错误的方式考虑这一点。您不应该仅仅为了进一步记录错误而重新提出错误。在 Python 中执行此操作的规范方法是使用日志记录模块。改编自文档：

```
import logging
LOG_FILENAME = '/tmp/logging_example.out'
logging.basicConfig(filename=LOG_FILENAME,level=logging.DEBUG,)

...

try:
    # code
except:
    logging.debug('Something bad happened', exc_info=True)
    # display message box
    # raise (if necessary) 
```

这提供了一个比依赖 sys.stdout 产生的错误更灵活的日志系统。如果您可以通过某种方式从异常中恢复，则可能不需要重新引发异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T16:24:38.150

没错，但你可以

```
raise 
```

这将重新引发当前处理的异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T19:27:35.277

一些附加信息：

（使用 PyQt4）您还需要将 sys.excepthook 重新绑定到您自己的函数以捕获所有*未捕获*的异常。否则 PyQt 只会将它们打印到控制台，这可能不是你需要的......

```
import sys

def excepthook(exc_type, exc_val, tracebackobj):
    # do something useful with the uncaught exception
    ...

def main():
    # rebind excepthook
    sys.excepthook = excepthook
    ... 
```

# sql-server-2005 - Reporting Services 2005 中的组和小计列

> ID：674071
> 
> 赞同：0
> 
> 时间：2009-03-23T16:24:16.577
> 
> 标签：sql-server-2005, reporting-services

我有一份我继承的报告（RS2005，针对 MSSS2005 实例）。它显示了一个基本的数据表：一些用于将行组合在一起的关键字段，一些基本的数字字段，然后是一些日期（“分桶”）字段（例如 1 个月后，2 个月，6 个月，一年、两年等）

用户希望将这些有日期的字段组合在聚合组中，并且能够像行一样折叠或展开**列**。因此，我们将能够显示下一年的值的小计或将其扩展为按月细分。如果显示小计，则隐藏个别月份。

这是基本的数据透视表行为（可以使用 Excel 上的 Group/Subtotal 功能来完成 - 这是我可以用来描述需求的最接近的类似行为）。

虽然在 RptgSvcs 中按行分组似乎微不足道，但将列分组并将一个组折叠成一个小计并再次将其分解，似乎几乎是不可能的。

除非有人知道得更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T18:16:10.073

您应该能够通过选择要隐藏的列并将其可见性设置为隐藏来执行此操作。

然后将隐藏列上的切换项设置为显示小计的文本框。

然后，此文本框将带有 [+] 符号，单击将显示/隐藏您的逐月突破（隐藏的列）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-24T10:56:05.967

On the right hand side of the table control on your report (RDL file), you should see icons representing the detail and grouping information for the table.

Here you can see whether or not a grouping has a header/footer and how it is calculated e.g. =SUM(fields!mySalesValue)

You can also set things like whether it is collapsed and so on

# vb.net - VB.NET 数组交集

> ID：674075
> 
> 赞同：2
> 
> 时间：2009-03-23T16:25:00.083
> 
> 标签：vb.net, arrays, intersection

这可能非常微不足道，但我很难找到在不到 n^2 时间内执行的答案。假设我有两个字符串数组，我想知道两个数组中都存在哪些字符串。我将如何在 VB.NET 中有效地做到这一点，或者*除了*双循环之外还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:27:54.570

简单的方法（假设没有 .NET 3.5）是将一个数组中的字符串转储到哈希表中，然后遍历另一个数组以检查哈希表。这应该比 n^2 搜索快得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T16:29:52.897

如果您对两个数组进行排序，则可以分别遍历它们一次以找到所有匹配的字符串。

伪代码：

```
while(index1 < list1.Length && index2 < list2.Length)
{
   if(list1[index1] == list2[index2])
   {
      // You've found a match
      index1++;
      index2++;
   } else if(list1[index1] < list2[index2]) {
      index1++;
   } else {
      index2++;
   }
} 
```

然后，您将其减少到进行排序所需的时间。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T16:29:21.120

对两个列表进行排序。然后您可以确定地知道，如果列表 A 中的下一个条目是“cobble”并且列表 B 中的下一个条目是“确定的”，那么“cobble”不在列表 B 中。只需将指针/计数器推进到列表中的任何一个排名较低的结果并提升排名。

例如：

清单 1：D、B、M、A、I
清单 2：I、A、P、N、D、G

排序：

清单 1：A、B、D、I、M
清单 2：A、D、G、I、N、P

A vs A --> 匹配，存储 A，推进
B vs D --> B D vs D --> 匹配，存储 D，推进
I vs G --> I>G，推进 2
I vs I -->匹配，存储 I，同时推进
M 与 N --> M 列表 1 没有更多项目，退出。
匹配列表是 A,D,I

2 列表排序 O(n log(n))，加上 O(n) 比较使得这个 O(n(log(n) + 1))。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T16:29:44.427

如果其中一个数组已排序，您可以在内部循环中对其进行二进制搜索，这将减少时间`O(n log n)`

# java - Jpa 复合键可为空的列

> ID：674104
> 
> 赞同：6
> 
> 时间：2009-03-23T16:29:57.797
> 
> 标签：java, hibernate, jpa, composite-id

我正在使用 Hibernate 的 JPA impl 对一些表进行建模。我在映射一个表时遇到问题：

*   没有主键
*   在 4 列上具有唯一索引，其中 3 列可以为空

我试图破解它并将索引定义为复合 ID，但由于某些列可以为空，因此无法正常工作。这对 JPA/Hibernate 可行吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T17:06:34.323

似乎不可为空的列应该是您的主键。复合键的任何部分都不应该可以为空。

您将需要获取可为空的属性并将它们放在您的主键/复合键之外。

[此外，这看起来像是Hibernate 映射具有空值的复合键](https://stackoverflow.com/questions/70909/hibernate-mapping-a-composite-key-with-null-values)的副本，当我在谷歌上搜索“空复合键”时，它出现在 #3 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T10:24:04.497

一个工作方法是......您应该实现自己的 UserType 实现并处理空值以为此返回一个代表对象。

看我的例子。该字段是一个可以为空的数字，所以我的实现是：

**看起来像在 HBM 文件中**：

```
 <key-property name="fieldName" type="mypackage.forUserTypes.DefaultLongType">
    <column name="FIELD_NAME" precision="10" scale="0" />
   </key-property> 
```

**...在 Java 中**：

```
public class DefaultLongType implements UserType {
private static final long serialVersionUID = 1L;

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#assemble(java.io.Serializable, java.lang.Object)
 */
public Object assemble(Serializable cached, Object owner)
        throws HibernateException {
    return null;
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#deepCopy(java.lang.Object)
 */
public Object deepCopy(Object value) throws HibernateException {
    return null;
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#disassemble(java.lang.Object)
 */
public Serializable disassemble(Object value) throws HibernateException {
    return null;
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#equals(java.lang.Object, java.lang.Object)
 */
public boolean equals(Object x, Object y) throws HibernateException {
    if (x == y) return true;
    if (x == null) return false;
    return x.equals(y);
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#hashCode(java.lang.Object)
 */
public int hashCode(Object x) throws HibernateException {
    return x == null ? 0 : x.hashCode();
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#isMutable()
 */
public boolean isMutable() {
    return false;
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#nullSafeGet(java.sql.ResultSet, java.lang.String[], java.lang.Object)
 */
public Object nullSafeGet(ResultSet rs, String[] names, Object owner)
        throws HibernateException, SQLException {
    final long value = rs.getLong(names[0]);
    if (rs.wasNull()) {
        return new Long(Long.MIN_VALUE);
    }
    return new Long(value);
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#nullSafeSet(java.sql.PreparedStatement, java.lang.Object, int)
 */
public void nullSafeSet(PreparedStatement st, Object value, int index)
        throws HibernateException, SQLException {
    Long l = (Long) value;
    if (l == null || l.longValue() == Long.MIN_VALUE) {
        st.setNull(index, Types.NUMERIC);
    }
    else {
        st.setLong(index, l.longValue());
    }
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#replace(java.lang.Object, java.lang.Object, java.lang.Object)
 */
public Object replace(Object original, Object target, Object owner)
        throws HibernateException {
    return original;
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#returnedClass()
 */
public Class returnedClass() {
    return Long.class;
}

/* (non-Javadoc)
 * @see org.hibernate.usertype.UserType#sqlTypes()
 */
public int[] sqlTypes() {
    final int[] args = { Types.NUMERIC };
    return args;
} 
```

}

# java - 在 Java 中查询系统（不是 JVM）的正常运行时间

> ID：674106
> 
> 赞同：5
> 
> 时间：2009-03-23T16:30:17.497
> 
> 标签：java, operating-system, monitoring, jmx

在 JavaSE 6 中是否有一种与操作系统无关的查询系统（不是 JVM - 我知道 RuntimeMXBean.getUptime()）正常运行时间的方法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:47:27.940

是和不是。

*   有*系统特定*的查询正常运行时间的方法（例如 *nix 上的正常运行时间）
*   有办法[检测操作系统](http://objectmix.com/java/71837-can-java-detect-host-os.html)。
*   可能的操作系统数量有限。
*   而且您处于通用编程环境中，所以...

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-12-27T21:48:29.240

所以他们实现它应该没什么大不了的，因为他们正在为每个平台编写特定的 JRE，它知道每个操作系统的 uptime() 版本，他们可以很容易地将它包装到一些 java 调用中，比如 getSystemUptime( )

# wpf - 如何让这个 CRUD 代码在 WPF DataGrid 上工作？

> ID：674108
> 
> 赞同：2
> 
> 时间：2009-03-23T16:30:59.447
> 
> 标签：wpf, datagrid

我正在为 WPF Datagrid 编写 CRUD 代码。

在下面的 TheDataGrid_CellEditEnding 方法中：

*   在用户进行更改之前如何获取原始文本？
*   我需要原始文本才能更改客户并使用 _db.SubmitChanges() 将其保存回数据库

如果有人想对此进行试验，这是数据库的完整解决方案：

[http://www.tanguay.info/web/download/testDataGrid566northwindDatagrid.zip](http://www.tanguay.info/web/download/testDataGrid566northwindDatagrid.zip)

**XAML：**

```
<toolkit:DataGrid x:Name="TheDataGrid" 
                  AutoGenerateColumns="True"
                  CellEditEnding="TheDataGrid_CellEditEnding"/> 
```

**代码隐藏：**

```
private void TheDataGrid_CellEditEnding(object sender, Microsoft.Windows.Controls.DataGridCellEditEndingEventArgs e)
{
    //get the original text
    Customer customer = e.Row.Item as Customer;
    string customerID = customer.CustomerID;
    int displayIndex = (int)e.Column.DisplayIndex; // e.g. equals 4 when user edits the 5th column

    //HOW TO I GET THE ORIGINAL TEXT? THERE IS NO FIELDS METHOD IN THE LINQ-TO-SQL CLASSES
    string originalText = customer.Fields[displayIndex].value.ToString();

    //get the changed text
    TextBox changedTextBox = e.EditingElement as TextBox;
    string changedText = changedTextBox.Text;

    //inform user
    Message.Text = String.Format("cell was changed from {0} to {1}", originalText, changedText);

    //I NEED TO CHANGE THE CUSTOMER WITH THE ABOVE TEXT
    //BEFORE I SAVE IT BACK HERE
    _db.SubmitChanges();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:09:47.810

为什么需要原文？是显示一些信息性消息吗？

在您的情况下，您似乎将数据网格绑定到您的 LinqToSQL 对象。这意味着该行绑定到的 Customer 对象已经更新，您需要做的就是调用 SubmitChanges()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-27T21:48:21.743

我发现此博客中的示例非常有用 [http://blogsprajeesh.blogspot.com/2009/03/blog-post.html](http://blogsprajeesh.blogspot.com/2009/03/blog-post.html)

它解释了使用集合和网格事件进行排序。

# php - 如何在 PHP 中生成唯一的随机数？

> ID：674113
> 
> 赞同：0
> 
> 时间：2009-03-23T16:32:49.300
> 
> 标签：php, prng

我正在开发一个 MCQ 模块，我需要从我的数据库中获取随机问题。问题是我似乎得到了重复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T16:36:53.830

听起来你想改变问题，而不是随机访问它们。所以你的算法会是这样的。

1.  获取要显示的所有问题（或问题键）。
2.  洗牌
3.  以打乱的顺序检索/显示它们

洗牌结帐：[Fisher-Yates shuffle algorithm](http://en.wikipedia.org/wiki/Fisher-Yates_shuffle)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T16:53:19.207

如果您从数据库中获取它们，请使用 SQL 来完成您的工作。例如获取 20 个随机问题（不重复）：

```
SELECT * FROM questions ORDER BY RAND() LIMIT 20 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:44:47.837

如果您使用的是 MySql 并且您有合理的少量数据，则可以使用 ORDER BY RAND()

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:35:49.653

如果没有更多信息，我可以提出一个基本的解决方案。（但请用更多信息更新您的问题）

我猜你有用户，因为你可以将用户已经得到的问题保存到一个表中（无论是否是临时的）。

如果您没有用户，则可以将`SESSION_ID`用作该用户的用户标识符。

因此，当您第一次获取问题并且用户回答时，它会保存您需要保存的信息，然后将用户的 id 和问题的 id 保存到一个表中。

在获取下一个问题时，您会检查用户是否在这个新表中具有该问题 ID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T16:45:49.240

请参阅[是否存在无状态随机数生成器？](https://stackoverflow.com/questions/203382/do-stateless-random-number-generators-exist)

任何伪随机数序列最终都会重复。你如何获得你的伪随机数？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T19:27:00.413

如果您有大量行，您可以在表中添加一列，该列存储 0 到 1 之间的数字，然后使用查询获取：

```
SELECT * FROM `mytable` WHERE `randcolumn` > RAND() LIMIT 20 
```

这意味着您的数据库不必随机排序整个表以仅提供 20 行。

# iphone - 您如何处理纵向和横向视图？

> ID：674114
> 
> 赞同：0
> 
> 时间：2009-03-23T16:32:53.233
> 
> 标签：iphone

我知道您可以为整个应用程序指定一个横向，但如果它部分是横向和部分是纵向怎么办。

目前我有一些基本上是图像的观点。这些图像已被旋转，以便用户知道应用程序的某些部分将处于横向模式。我所有的 UILabel 也被旋转以产生这种效果。

我的问题是，有没有更好的方法来处理这个问题。有没有办法在运行时以编程方式设置方向？在这种情况下，我将不再需要旋转我的图像/uilabels。

澄清一下，我不需要自动旋转功能，现在实现它的方式是捕获我想包含在应用程序中的所有功能，但我只是想知道是否有一种不那么繁琐的方式来处理横向/纵向同一应用程序中的视图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T22:25:25.320

您可以随时通过调用强制轮换；

```
UIApplication *application = [UIApplication sharedApplication];    
[application setStatusBarOrientation: UIInterfaceOrientationWHATEVER animated:NO]; 
```

我当前的应用程序主要是横向的，但有一些纵向视图。在与用户应该能够旋转的视图相对应的视图控制器中，我允许旋转但阻止动画。这使您可以切换到 NIB 中的另一个视图，而不会出现任何奇怪的从屏幕上滑出的扭曲现象，因为您在动画期间堆积在一个视图上。

希望这对您有所帮助！

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
if (interfaceOrientation == UIInterfaceOrientationPortrait) {
    rotatingToPortrait = YES;
    [UIView setAnimationsEnabled:NO];
    return YES;
} else if (interfaceOrientation == UIInterfaceOrientationLandscapeLeft || interfaceOrientation == UIInterfaceOrientationLandscapeRight) {
    rotatingToPortrait = NO;
    [UIView setAnimationsEnabled:NO];
    return YES;
}
// Catch upside-down
return NO; }

- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {
[UIView setAnimationsEnabled:YES];
if (rotatingToPortrait) {
    // Swap in portrait view here
} else {
    // Swap it out here
} } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:06:55.457

目前我不知道以编程方式控制方向的任何方法。这意味着无法告诉设备“现在旋转到横向”。您只能指定以下内容：

(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation

您可以指定哪些视图控制器支持哪些方向，并通过覆盖函数对方向变化做出反应，但是何时以及如何调用这些函数是由系统决定的。您也可以从 UIDevice 类获得更详细的消息。

如果我正确理解您在说什么，您的应用程序基本上总是在一个方向，但是您只是以不同的方式绘制各种视图，以使应用程序的某些部分看起来像是处于纵向/横向模式？听起来你正试图在圆孔中安装一个正方形，iPhone 的方向 API 并不是为这种行为而设计的，你最好使用 API 而不是反对它们。

# mysql - 跨不同数据库选择列

> ID：674115
> 
> 赞同：57
> 
> 时间：2009-03-23T16:32:55.150
> 
> 标签：mysql

是否可以跨位于同一服务器上的不同数据库执行选择（或插入）语句？如果是，如何？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-03-23T16:36:39.743

您将使用语法指定数据库`databasename.tablename`

例子：

```
SELECT 
    mydatabase1.tblUsers.UserID, 
    mydatabse2.tblUsers.UserID
FROM 
   mydatabase1.tblUsers
       INNER JOIN mydatabase2.tblUsers 
           ON mydatabase1.tblUsers.UserID = mydatabase2.tblUsers.UserID 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-23T16:37:12.847

[您可以使用JOIN 语句](http://dev.mysql.com/doc/refman/5.0/en/join.html)并使用这种类型的语法从任何其他表中进行选择。

```
SELECT A.*, B.* FROM db1.table1 A LEFT JOIN db2.table1 B ON A.id = B.id 
```

# java - JDBC 瘦驱动程序：无效的数据包长度 [原文如此]

> ID：674137
> 
> 赞同：2
> 
> 时间：2009-03-23T16:37:21.553
> 
> 标签：java, oracle, testing, jdbc

当我对我的一些 Java 代码运行自动批量测试时，我遇到了一个奇怪的“Invalid Packet Lenght”（错误的拼写方式）错误，我希望有人之前遇到过这个错误或者可以指出我正确的方向。

通过 JUnit 单元测试或从 GUI 测试我的代码时，我没有遇到此错误。我只在自动批量测试中遇到此错误。关于我的批量测试的一点点：对于某些输入，我的代码将运行很长时间（这是意料之中的），但是为了将结果加快到更合理的时间范围，我正在创建一个新线程来运行每个单独测试，以便我可以在给定的最大经过时间后停止测试。

请注意，测试和实际代码都需要连接到同一个数据库实例来加载数据。实际代码使用单个连接从数据库读取（它不是多线程的）。我仍在尝试找出测试连接到数据库的最佳方式（因此提出了这个问题）。

我的第一个想法是我在关闭测试线程以提前退出运行的方式上做了一些不友好的事情。我打电话给弃用的

```
threadObject.stop(); 
```

方法，因为我的实际代码不是多线程的，并且没有“友好”的方式来杀死内置的线程。在几个（~2-3）停止线程之后，我的 JDBC 连接抛出一个“Invalid Packet Lenght”错误，然后其余测试的“套接字关闭”异常。

我已经尝试了所有这些，结果相同：

*   重用实际代码使用的相同连接
*   创建一个新连接并为所有测试重用相同的第二个连接
*   每次我 stop() 一个长时间运行的测试时关闭并重新创建测试连接
*   为每个测试创建一个新连接（这一直有效，直到我最大化我的连接数）

我已经确定在“测试”和“实际”这两个连接中，“测试”连接是引发异常的连接。

配置：

*   日食 3.4
*   Java 合规性 1.6
*   ojdbc14_g.jar JDBC 驱动程序
*   甲骨文 9 数据库

我究竟做错了什么？我应该以不同的方式处理我的“测试”连接吗？我是否需要重新构建我的“实际”连接才能运行批量测试？是什么导致“无效数据包长度”错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T22:12:09.923

I don't really understand what are you trying to accomplish with your bulk test, so I will offer some general advice regarding threading and `Connection`s that I know of:

1.  Perhaps one of your threads is leaving a connection in invalid state. What happens to connection when thread is stopped? In general terms, you should have a place where you `wait()` for an `InterruptedException` instead of stopping the thread in mid-operation. A `Connection` should be closed in a `finally` block, regardless of whether an exception occurred or not.

2.  If you want a timeout for a JDBC operation, use [Statement.setQueryTimeout()](http://java.sun.com/j2se/1.4.2/docs/api/java/sql/Statement.html#setQueryTimeout(int)).

3.  考虑使用连接池，例如[C3P0](http://www.mchange.com/projects/c3p0/index.html)。在代码中设置真的很容易，特别是看看[这个](http://www.mchange.com/projects/c3p0/index.html#using_combopooleddatasource)。它将负责大部分连接设置/拆除，并为您的代码提供有效的、随时可用的连接。

4.  考虑使用 Java 自己的[java.util.concurrent](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/package-summary.html)包，而不是推出自己的执行策略。看看[Executors](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/Executors.html)和[ExecutorService](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ExecutorService.html)类——它们提供了在单独的线程中执行任务并设置超时的方法。

希望有些帮助。

# version-control - 知道任何类似源代码控制“stash”的程序吗？

> ID：674140
> 
> 赞同：2
> 
> 时间：2009-03-23T16:37:41.897
> 
> 标签：version-control

我曾经遇到过一个用于 Windows 的商业工具，它允许您在源代码控制之外“隐藏”代码更改，但现在我不记得它的名称了。它会将文档的当前版本复制到备份位置并撤消您在源代码管理中的签出。然后，您可以稍后重新引入备份的更改。我相信它适用于多个源代码控制系统。有谁知道我要描述的程序是什么？

我问的目的是双重的：首先是找到一个好的方法来做到这一点。第二个是因为我不记得那个该死的程序是什么，它让我发疯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T16:40:30.453

吉特： http: [//git-scm.com/](http://git-scm.com/)

您可以使用`git stash`暂时搁置当前的更改集：http: [//git-scm.com/docs/git-stash](http://git-scm.com/docs/git-stash)。这会将您的更改存储在本地（无需提交），并允许您稍后将它们重新引入您的工作副本。

Git 不是商业化的，但很快就从 Subversion 等工具中获得了许多转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:40:36.023

我自己不是 git 用户，但我的几个同事是，他们似乎正是为了这个目的而喜欢它。他们使用各种 git 包装器向他们公司使用的 SCM 系统提交“真正的”更改，但在他们的驱动器上保留私有 git 存储库，他们可以保留他们不一定想要提交的更改。

当他们准备好提交到公司的 SCM 服务器时，他们只需合并并提交上游。那是你想要做的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:44:36.840

将您的私有更改存储在私有分支中不是更好的主意，例如`svn switch`在需要时使用例如更改到主分支？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T16:47:37.550

Mercurial 的[Shelve Extension 可以满足](http://www.selenic.com/mercurial/wiki/index.cgi/ShelveExtension)您的需求。

如果您真的需要，您甚至可以从单个文件中选择要搁置的更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T17:03:45.453

我认为您正在考虑的产品是 SmartBear Software 的“CodePickle”。但是，它似乎已停产。

似乎用于您正在寻找的功能类型的术语似乎是“搁置”。

Microsoft 的 Team 系统具有“搁置”功能。

Perforce 有几个不受支持的脚本，包括[p4tar](http://public.perforce.com/wiki/P4tar)和[p4 shelve](http://public.perforce.com/wiki/P4_Shelve)

Subversion 有几个“搁置”工具，但我不知道它们有多强大。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T16:49:36.670

在[Darcs](http://darcs.net/)中，您要么不记录您想要隐藏的更改（它会在您记录新补丁时询问您是否独立包含每个更改），或者将它们放在您不向上游推送的单独补丁中。

无需将本地私有存储库与公共/上游/其他存储库完全同步。你可以挑选你想在别处推送的补丁。选择补丁也可以通过模式来完成，因此如果您为隐藏的补丁采用命名约定，您可以轻松推送除它们之外的所有内容。

这样，您的私有更改仍处于修订控制之下，但在您希望它们共享之前不会共享它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T17:16:14.300

我发现了一篇关于使用 Subversion 分支获得类似功能的优秀文章： [Shelves-in-subversion](http://markphip.blogspot.com/2007/01/shelves-in-subversion.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-11T04:51:31.017

然后是旧的后备...“补丁”，甚至是旧的“将所有内容复制到另一个位置，然后还原”。

但是，这两者都不如使用大多数 VCS 系统中的工具方便。

# vb.net - 布尔变量和三态复选框：如何最好地进行类型转换？

> ID：674147
> 
> 赞同：0
> 
> 时间：2009-03-23T16:41:24.477
> 
> 标签：vb.net, vb6

这是在 VB6 中（也可能适用于 VB.net）

复选框可以具有三种状态（选中、未选中、灰色）。

但是我使用它们来设置布尔变量（MuteSound 等）。这绝对是一个只有**两个状态**的值。不幸的是，Checked 和 Unchecked 不对应于 True/False 值。

所以，我不能：

bMuteSound=ChkMute.value .......... 如果 bMuteSound 然后等等等等

两个选项： 1\. 设置/读取 Checkbox.value 时强制值为布尔值：

bMuteSound=Checkbox.value=选中.....

Checkbox.value=ConvertBooleanToCheckBox

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T16:48:21.213

```
bMuteSound = abs(chkMute.Value)  
chkMute.Value = abs(bMuteSound) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T05:58:18.780

对我来说看起来很简单：

```
Dim tsValue As VbTriState

'Conversions
tsValue = -Check1.Value
Check1.Value = -tsValue 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:44:28.587

布尔变量是否有默认值？如果是这样，那么如果框是灰色的，则不要更改变量，如果它不是灰色的，则将其更改为正确的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T17:07:31.637

一般来说，复选框也可以变灰并选中，因此您有 4 种可能的情况，只需使用 2 个布尔值，就分离而言，您的处理代码不需要知道复选框，因此不应传递灰色或非灰色状态，但只有活动或非活动状态。

# c# - 为什么这个用于 C++ 的 .NET StructLayout 示例

> ID：674155
> 
> 赞同：0
> 
> 时间：2009-03-23T16:43:21.617
> 
> 标签：c#, .net, c++

来自[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute(VS.71).aspx：](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute(VS.71).aspx)

```
[C++] 

[StructLayout(LayoutKind::Explicit, Size=16, CharSet=CharSet::Ansi)]
__value class MySystemTime {
public:
   [FieldOffset(0)] short int wYear;
   [FieldOffset(2)] short int  wMonth;
   [FieldOffset(4)] short int  wDayOfWeek;
   [FieldOffset(6)] short int  wDay;
   [FieldOffset(8)] short int  wHour;
   [FieldOffset(10)] short int  wMinute;
   [FieldOffset(12)] short int  wSecond;
   [FieldOffset(14)] short int  wMilliseconds;
}; 
```

我是在想象这个，还是方括号中的元素与 C++ 语法不一致？

当 C++ 提供了足够的工具来在语言的标准定义中指定结构布局时（也许还有通常支持的 #pragma pack() ），为什么还要麻烦做所有这些。设计到语言中的兼容性是否不能保证您可以在 C++ 中定义任何可以在 C 中定义的结构？我理解需要能够用其他语言显式描述 C 结构的布局，但似乎没有必要使用提供

```
extern "C" { } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T16:46:46.303

方括号中的东西称为属性，经常出现在 C# 代码中。它们在这里似乎具有相同的含义，因为这不是严格的 C++。它具有 Microsoft 扩展以允许与 CLI 集成。

当您在 C 或 C++ 中声明这样的结构时，这并不能保证特定的内存布局。要控制它，您需要特殊的编译指示来控制“打包”。这些是特定于平台的。所以你在这里看到的只是 CLR 的等价物。

更新：该示例来自旧版本的 Microsoft CLI 集成 C++ 文档，称为托管 C++。它很快就被放弃了，并在下一个版本中被[C++/CLI](http://en.wikipedia.org/wiki/C%2B%2B/CLI)取代——将 CLI 特性移植到 C++ 中，它是如此完整和广泛，它实际上变成了一种不同的语言，就像 C++ 是一种不同于 C 的语言一样。

# php - 获取获取变量的名称

> ID：674157
> 
> 赞同：0
> 
> 时间：2009-03-23T16:43:51.583
> 
> 标签：php

我需要得到一个未定义的 $_GET['$VARIABLE']。

这样如果链接进入 item.php?changitemstyle=10101010101010

我需要找出如何提取变量的名称而不是值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T16:45:48.023

使用该[`array_keys()`函数](http://docs.php.net/array_keys)检索数组键的数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T16:46:17.523

弄清楚了

php函数数组键

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T16:47:32.777

$_GET 是一个字典，所以你可以很容易地得到密钥（除非我误解了这个问题）：

```
foreach( $_GET as $var_name => $value ) {
   // Do something here
} 
```

# flex3 - flex 3 遍历对象值

> ID：674158
> 
> 赞同：5
> 
> 时间：2009-03-23T16:44:18.400
> 
> 标签：flex3, iteration, loops

我有一个代表数据库表的对象。我想遍历这个对象并打印每个值。我可以用什么来做到这一点？

我想在我的 mxml 中执行此操作而不是 actionscript

对于每个对象属性，我想创建一个输入字段

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-23T17:22:12.130

查看有关 Flex 3 循环的文档。如果你这样做，你会发现：

> **`for..in`**
> 
> 循环遍历对象的`for..in`属性或数组的元素。例如，您可以使用 for..in 循环遍历通用对象的属性（对象属性不按任何特定顺序保存，因此属性可能以看似随机的顺序出现）：

```
var myObj:Object = {x:20, y:30};
for (var i:String in myObj)
{
    trace(i + ": " + myObj[i]);
}
// output:
// x: 20
// y: 30 
```

我建议您不要尝试为每个对象创建输入字段，而是查看[DataGrid](http://livedocs.adobe.com/flex/3/html/dpcontrols_6.html)和自定义[ItemEditors](http://livedocs.adobe.com/flex/3/html/celleditor_8.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-30T16:02:45.497

我同意这个答案没有用。它仅适用于通用对象，不适用于用户声明的对象。

但是，这里有一些代码应该/可以使用上面建议的 describeType 工作。（而且我真的不认为它太复杂）。请注意，仅公开公共属性/方法等：

```
var ct:CustomObject = new CustomObject(); 
var xml:XML = describeType(ct);
for each(var accessor in xml..accessor) {
  var name:String = accessor.@name;
  var type.String = accessor.@type;
  trace(ct[name]);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-27T08:53:30.600

“for...in”的问题在于它只迭代动态属性。也就是说，如果你的对象被定义为一个类（而不是动态的），“for..in”不会给出任何东西。

ActionScript 文档建议对固定属性使用 describeType()，但对于这个简单的任务来说，它看起来过于复杂……</p>

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T16:48:20.217

您可以像 actionscript 一样编写它，但将其包含在带有 script 标签的 mxml 文件中：

```
<mx:Script>
   <![CDATA[
       public function LoopAndPrint() : void
       {
           //your code here
       }
   ]]>
 </mx:Script> 
```

# java - Scala 和接口

> ID：674164
> 
> 赞同：32
> 
> 时间：2009-03-23T16:45:30.130
> 
> 标签：java, scala, interface

在`Java`我通常会将我的整个域声明为`interface`s，可能带有某种`Factory`让我实现的方式。这部分是因为我太老了，我记得当一些持久层需要实现类来子类化特定类时，我也可以轻松地：

*   用于测试目的的模拟对象
*   如有必要，在运行时代理对象
*   提供不同的实现

即使我并不真正设想我真的想做上述任何事情，我也会遵循这种做法；我仍然认为这是一种很好的做法*，以防万一*。我认为这是一种相当普遍的方法。

如果我声明所有域对象，这在 Scala 领域会不会很不寻常`abstract`？以上几点也适用于 Scala 吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-24T00:47:26.150

Scala 有一些特性，它们是正在破解的接口。确实，它们应该是接口，诚然，在构造函数方面存在限制，但考虑到如果你有两个接口都具有构造函数的要求，那么这并不是什么大问题，你会遇到同样的问题。

然后是部分方法，在很多方面，基于依赖管理的许多好的面向对象设计原则几乎可以被视为获得更可组合的工作单元的方法，你真的不得不怀疑。您不仅可以处理方法输入和输出，或者使用策略对象/方法的预定义点，还可以提供更多的灵活性。

再加上伴随的对象，突然之间，工厂和更多的东西变得更加微不足道。

Given that's the case, you really can get away from having to use interfaces everywhere, and with more powerful generics system, some of what gets done with interfaces gets sucked up there.

Generally looking at Scala code it tends to be rather decomposed, and interfaces don't seem to be the main tool in that.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T16:53:57.253

这真是一个发人深省的问题。

这似乎不是一种常见的模式（至少在我见过的 Scala 中），但如果这是你真正想做的，我想不出一个好的论据来反对它。

另一方面，我不认为*我会*那样做（当我有实际需要时我会进行重构，而不是为可能永远不会到来的假设未来构建这种“灵活性”）。但是我能想到的反对它的最佳论点是避免不必要的间接性的类比（当你需要的只是一个整数时，不要使用指向指向整数的指针的指针），这不是很引人注目。

# vb.net - FxCop 在 VB.NET 上和在 C# 上一样有价值

> ID：674169
> 
> 赞同：4
> 
> 时间：2009-03-23T16:46:23.153
> 
> 标签：vb.net, fxcop

我一直在查看我们的一些使用 FxCop 的 VB.NET dll，所有错误都与 DLL 设置（即强名称、文化信息）和变量方法的情况有关。

查看 FxCop 检查 C# Dll 的几个示例，它似乎提供了更多潜在错误。

这是否意味着 FxCop 在 C# 开发中比 VB.NET 更有价值，或者我刚刚选择了不好的例子。

我认为 FxCop 是在 IL 而不是特定语言上工作的情况，所以我只是缺少 VB.NET 的规则文件还是 C# 有更多可用的文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T16:52:03.357

我会说这是不正确的。FxCop 对任何 .NET 开发人员来说都是无价之宝。

您需要展示一个示例，说明您从 FxCop 获得更多（或更少）输出的一段 VB.NET 代码，而不是一段 C# 代码，两者都编译为相同的 IL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T17:17:53.140

据我所知，FxCop 与语言无关。C# 更有可能在各个领域比 VB.NET 更自由，从而允许发生更多错误（正如 FxCop 所解释的那样），而不是 FxCop 以某种方式存在偏见。如果是这种情况，那么我可以看到它对 C# 开发人员来说比 VB.NET 开发人员更有价值，因为前一种语言具有更大的空间来创建 FxCop 可以检测到的问题。

然而，对于任何 .NET 项目来说，FxCop 都是一个非常宝贵的工具，即使某些语言更难出错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T02:14:40.557

FxCop 应该适用于已编译的代码，因此您编写的语言应该无关紧要。我已经在 C# 或 VB 的项目中使用过该工具，所以它确实有效。实际上，这很有帮助。

# java - 不使用 VB 使用 excel 作为 UI

> ID：674171
> 
> 赞同：6
> 
> 时间：2009-03-23T16:46:56.600
> 
> 标签：java, excel, user-interface

我认为每个商务人士都希望拥有 excel UI，但是他们被迫使用有时看起来非常糟糕的 excel 的 Web 应用程序。

是否有任何框架可以帮助在没有 VB 的情况下构建 excel ui？我不是指像 POI 或 JExcel 这样允许您生成 Excel 报告的框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T17:28:12.507

我见过许多使用 Excel 构建的应用程序。所有这些都笨拙，容易出错，并且几乎不可能保持最新状态。

如果最终用户需要一个应用程序来像 Excel 一样工作来进行某些网格计算，那么就给他们一个工具来做这件事，或者让他们使用 Excel 来完成那部分。

然而，专门使用 Excel/VBA 来开发大型企业级应用程序正在走向错误的道路。它可能会在一段时间内运作良好，但不久问题就会暴露出弱点。

既然你结束了关于报告的讨论......是的，无论如何都要让你的应用程序导出为 CSV、HTML、PDF、Excel 等。这样，想要使用 Excel 生成漂亮饼图的用户，并重新格式化/搜索/扫描/裁剪数据可以使用他们觉得舒服的工具来完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T11:14:41.287

两者的结合可以很好地工作...... Excel 不适合输入数据，这是应用程序（桌面或 Web）更好地工作的地方，但 Excel 适合动态报告和分析数据。

我见过的动态报告的最佳方法是编写向 Excel 添加新功能的插件（例如，提取实时数据）。在 java 空间中，您可以尝试[XLLoop](http://xlloop.sourceforge.net/ "XLloop") - 这允许您在 excel 中公开 POJO 函数（完全披露：我在这个项目上工作）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-14T15:52:02.003

[Obba](http://www.obba.info/)是一个 Excel 插件，它允许实例化 Java 对象并直接在 Excel 中使用它们（无需 VBA 或任何其他粘合代码）。

好的部分是 Excel 表 (UI) 对您的 Java 类所做的事情是完全透明的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T16:57:29.570

我不确定您在这里所说的 UI 是什么意思，但如果它是用于数据表示（而不是数据输入），您可以使用 SQL Server Reporting Services 并将结果导出为 excel 格式。或者，您可以将数据解析为 excel xml 格式并允许用户将其作为 excel 文件打开（如果您的数据比简单表格更复杂，这会有点痛苦）

**编辑**

在创建一个取代旧的基于纸质工作的网络系统时，我经历了使用 excel 呈现和处理数据的痛苦——这是过渡时间的要求。这是一个真正的痛苦，所有的数据验证，确保提交回来的内容没有被修改结构等。

我的结论是：

*   使用网络系统输入数据
*   如果需要，请提供用于报告的 excel 格式
*   如果真的，真的需要，您可以在 Web 系统中实现解析 excel 以输入数据，然后添加一些人工验证，因为人类无法预测在 excel 中可能创建的所有可能错误

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T17:34:17.437

您可以考虑将 Excel 作为 ActiveX 控件嵌入到您的应用程序中。它将允许您从您选择的语言中操作控件。

这可能会为您指明正确的方向：http: [//j-integra.intrinsyc.com/support/kb/Article.aspx ?id=30421](http://j-integra.intrinsyc.com/support/kb/Article.aspx?id=30421)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-29T00:32:50.380

对于java来说，这个很不错。

[http://www.jxcell.net](http://www.jxcell.net)

# html - 为什么 XHTML 1.0 过渡版如此受欢迎？

> ID：674184
> 
> 赞同：14
> 
> 时间：2009-03-23T16:49:20.727
> 
> 标签：html, xhtml, doctype

我的公司正在寻求用新的基于 CMS 的系统和类似的设计/样式替换组中的所有网站，并在未来阶段添加电子商务功能。这对我来说太大了，无法在合理的时间范围内完成，因此我们将邀请各机构投标。

我目前正在定义技术要求，我打算规定所选系统必须具有 Strict DOCTYPE 并且必须在普通浏览器中触发标准模式（或几乎标准模式），或者类似的东西[显然，我们必须允许几乎标准模式来迎合 IE]。

我已经做了一些功课——毕竟我不希望规范受到我的无知的限制——但我发现“当前观点”完全是在什么是好的做法上存在分歧。

有很多人提倡 HTML4.01 Strict（很公平），很多人推荐 XHTML1.0 Strict 作为 text/html 服务（我也可以），一些人推荐 HTML5*但仅限于 HTML4.01标签*（呃...仍然不确定这是否是一个好主意，但我看到了原理），但也有不少人（包括其他 SO 线程上的人）推荐 XHTML1.0 Transitional。

我只是不明白这样做的原因...好吧，您可能碰巧想暂时使用已弃用的东西，因此 Transitional 似乎是明智的，但有些人推荐 XHTML Transitional 用于新构建。

在查看了其他公司的网站以获取设计灵感后，我注意到许多网站（如果他们有任何指定的 DOCTYPE）将引用过渡 DTD。好的，我们都知道网络上有很多废话，所以也许我不应该得出太多的结论。但是查看我们遇到的 Web 设计机构，其中有惊人的比例（我会说绝大多数）正在使用 XHTML 1.0 Transitional。

很好，所以你不一定非得是专家才能称自己为网页设计师，但过渡布局的庞大数量让我想知道......大多数网站似乎都经过合理设计（CSS 布局、验证、可访问ETC）。

那么，终于说到重点了（！），有这么大比例的机构选择过渡 DOCTYPE 的原因吗？我是否遗漏了一些我需要为我的新网站考虑的东西？

**编辑：**是的，我意识到过渡 DTD 的目的 - 我只是怀疑这么多其他能力强的 Web 开发人员仍坚持使用已弃用的标记。我想知道你们是否正确，答案很简单，他们是 a) 懒得让自己的网站进行验证，或者 b) 坚持使用他们首选 IDE 的默认 DTD。

对我来说，关键的再保证是（根据您迄今为止的回答）我似乎没有错过使用过渡 DTD 的一些关键原因。

编辑 2：关于我们的 CMS 项目——谢天谢地，所有入围的机构似乎都被搞砸了——严格、有效且易于使用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-23T18:06:21.183

我将采取一种顽固的方法，并说过渡 doctypes 很受欢迎，因为有些人懒惰或根本不在乎。有人告诉他们应该验证他们的代码，而过渡是最容易验证的，因为它允许弃用标记。

我同意那些之前回答过这个问题的人的观点，他们说过渡文档类型是为了过渡到严格的。这些是我使用它们的唯一情况。

任何新的开发都应该使用严格的文档类型。Strict 与 Transitional 的选择比 XHTML 与 HTML4 更重要。我强烈建议您在您的技术要求中要求严格。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-23T16:53:39.250

简而言之，XHTML Transitional 允许开发人员更轻松地将遗留的 HTML 代码库迁移到该文档类型。Transitional doctype 比 Strict 更宽容，但它是通往 Strict 的垫脚石。

这是一篇关于过渡与严格的好文章：http: [//24ways.org/2005/transitional-vs-strict-markup](http://24ways.org/2005/transitional-vs-strict-markup)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-25T01:44:52.943

MS Visual Studio 的 DOCTYPE 默认是 XHTML 1.0 Transitional。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-23T17:10:46.433

XHTML 1.0 Transitional 比它的 Strict 对应物更宽容，并且是最容易过渡到的。

例如，在 Strict DTD 中，您需要编写 JS 以在新窗口中打开链接页面......并且 target="_blank" 会标记错误（例如，来自使用 Web 标准设计......）

严格绝对是前进的道路，但过渡是过渡的最佳选择*。*

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T16:57:12.847

我认为很多人使用 XHTML 1.0 Transitional 一方面是因为它看起来先进、最新甚至超越（*XHTML 是未来，伙计！*），但另一方面仍然允许这种“讨厌的东西” ，例如`center`，、,等。`font``align``border``target`

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T16:59:44.837

大多数网络[都没有 validate](http://dev.opera.com/articles/view/mama-markup-validation-report/)，无论是过渡的还是严格的。过渡通常更容易使用，但我认为它更频繁使用的一个更明显的原因是它也是 Dreamweaver 等编辑器的默认设置，并且许多 CMS 将其用作默认文档类型。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-26T00:55:35.317

大多数 Web 作者不验证他们的页面，在这种情况下，DOCTYPE 之间几乎没有选择余地，也没有充分的理由更改 IDE 默认值。Strict 和 Transitional 对浏览器的唯一实际区别是，在 gecko、presto、webkit 等中，严格触发标准模式和过渡触发几乎标准模式。实际需要标准模式行为的页面非常少且相差甚远，当然不会影响您在网络上看到的整体比例。

值得注意的是，HTML 5 的编写没有严格/过渡的区别，主要是因为其作者认识到 XHTML 和 HTML4 的过渡 DOCTYPE 被广泛滥用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-23T16:52:45.650

在 XHTML 1.0 Transitional 中，您拥有`<center>` `<font>`并且`<strike>`在严格版本中是不允许的。

原因主要是其他模板之间的可移植性。一篇关于这个的好文章是[here。](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5061538.html)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-05T15:43:17.167

Good luck bludgeoning your pages into validating if you're using user input in a CMS. XHTML Strict doesn't like really common things like target="_blank" (we can have a debate about that, but people still use it). Additionally, if anyone adds the default youtube embed html, it won't validate.

# c# - 在发生异常时记录方法的调用参数的最有效方法

> ID：674185
> 
> 赞同：0
> 
> 时间：2009-03-23T16:49:26.423
> 
> 标签：c#, exception-logging

C# 开发：我正在使用不同参数的 try catch 块中调用 Web 服务/其他方法，其中一些参数可能是自定义对象。请评论在发生异常时将参数记录在文本文件中的最佳方式。也可以从对象中跳过某些字段（例如，如果对象包含我不想记录到文本文件的图像文件）

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T17:00:05.023

简短的回答是，你不能，而不是不经过圈套。

当您收到异常时，它包含堆栈跟踪信息，但该信息不包含有关当时传递给方法的参数的任何内容。

为了解决这个问题，您必须将参数存储在异常处理程序代码中，以便在处理异常时可以访问它们。

例如，您将拥有一个对象，将参数实例传递给（连同它们的名称），然后在您的 catch 块中调用该对象的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T17:02:09.323

您可以为您的对象提供一个 to_string 方法，该方法可以根据需要显示它们。如果你想聪明一点，你甚至可以让他们第一次给出完整的细节，然后在以后的使用中参考完整版本（以免你的日志变得难以阅读）。

如果他们没有一个好名字作为参考，你可以给他们分配一些东西（比如“AxilWidget #7”或“PendingWhackQueue #14”）。

在许多情况下，这可以使日志更易于阅读，如果您要使用循环递归地序列化对象结构，这一点至关重要。如果对象在报告之间可能发生显着变化，您将必须特别小心 - 比如说始终包含包含这些成员的摘要，即使在反向引用中也是如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T17:30:09.007

我建议您查看[PostSharp](http://postsharp.org)。您可以使用属性声明您希望某些代码“围绕”正常方法执行。该代码可以使用该方法的参数，并且可以确保仅在原始代码引发异常等情况下才记录它。

这种横切关注点正是 AOP 的设计目的。我不知道 PostSharp 与 Web 服务的工作情况如何，但我无法想象你是第一个想要这个的人。

您将能够向属性添加属性以指定要跳过的任何参数等。

# java - 制作一个非常大的 Java 数组

> ID：674186
> 
> 赞同：10
> 
> 时间：2009-03-23T16:49:30.557
> 
> 标签：java, arrays

我试图找到一个[Pólya 猜想](http://en.wikipedia.org/wiki/P%C3%B3lya_conjecture)的反例，该猜想将在 9 亿左右。我正在使用一种非常有效的算法，它甚至不需要任何分解（类似于埃拉托色尼筛，但信息更多。因此，需要大量整数。

该程序高效且正确，但需要一个数组，直到要检查的 xi（它检查 (2, x) 中的所有数字）。所以，如果反例是 9 亿，我需要一个同样大的数组。Java 不允许我超过 2000 万。我能做些什么来获得这么大的数组吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-24T09:02:57.393

Java 数组由 int 索引，因此数组不能大于 2^31（没有无符号整数）。因此，数组的最大大小是 2147483648，它消耗（对于普通的 int[]）8589934592 字节（= 8GB）。

因此，int-index 通常不是限制，因为无论如何您都会耗尽内存。

在您的算法中，您应该使用 List（或 Map）作为您的数据结构，并选择可以增长超过 2^31 的 List（或 Map）的实现。这可能会变得很棘手，因为“通常”的实现 ArrayList（和 HashMap）在内部使用数组。您将必须实现自定义数据结构；例如，通过使用 2 级数组（列表/数组）。当您使用它时，您还可以尝试将这些位更紧密地打包。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-23T16:54:09.033

您可能想要扩展 JVM 堆的最大大小。您可以使用命令行选项来执行此操作。

我相信它是 -Xmx3600m（3600 兆字节）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-23T16:54:58.687

Java 将允许多达 20 亿个数组条目。是您的机器（以及您有限的内存）无法处理如此大量的数据。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-23T17:03:14.063

没有更多开销的 9 亿个 32 位整数 - 并且总会有更多开销 - 将需要 3.35 GiB 多一点。获得这么多内存的唯一方法是使用 64 位 JVM（在具有至少 8 GB RAM 的机器上）或使用一些磁盘支持的缓存。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-23T16:54:54.677

如果您不需要一次将其全部加载到内存中，则可以将其分段为文件并存储在磁盘上。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T16:54:08.313

“不允许”是什么意思。您可能会得到一个`OutOfMemoryError`, 所以使用`-Xmx`命令行选项添加更多内存。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T19:49:45.787

根据您需要访问数组的方式，您可能会发现[RandomAccessFile](http://java.sun.com/javase/6/docs/api/java/io/RandomAccessFile.html)将允许您使用大于内存容量的文件。但是，您获得的性能在很大程度上取决于您的访问行为。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T16:57:04.703

您可以定义自己的类，将数据存储在二维数组中，该数组将更接近 sqrt(n) by sqrt(n)。然后使用索引函数来确定数组的两个索引。这可以根据需要扩展到更多维度。

您将遇到的主要问题是内存不足。如果您接近此限制，您将需要重新考虑您的算法或考虑外部存储（即文件或数据库）。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T17:03:16.497

如果您的算法允许：

*   以适合内存的切片计算它。

    您将不得不为每个切片重做计算，但它通常足够快。

*   使用较小数值类型的数组，例如字节。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-23T17:57:56.930

使用 Tokyo Cabinet、Berkeley DB 或任何其他基于磁盘的键值存储。它们比任何传统数据库都快，但允许您使用磁盘而不是内存。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-24T08:26:49.057

9亿比特你能过得去吗？（可能存储为字节数组）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-23T17:34:26.500

我为 Project Euler 编写了一个版本的 Eratosthenes 筛子，它一次处理大量搜索空间。它处理前 1M 个整数（例如），但将找到的每个素数保存在一个表中。在您遍历了到目前为止找到的所有素数之后，数组将重新初始化，并且已经找到的素数用于在查找下一个之前标记数组。

该表将素数映射到其从数组开始的“偏移量”，以进行下一次处理迭代。

这在概念上（如果不是在实现中）类似于函数式编程语言对列表执行惰性求值的方式（尽管步骤更大）。无需预先分配所有内存，因为您只对通过素数测试的数组部分感兴趣。保持非素数对您没有用处。

该方法还为以后对素数的迭代提供了记忆。它比扫描你的稀疏筛子数据结构每次都更快。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-23T17:43:17.010

我支持@sfossen 的想法和@Aaron Digulla。我会去访问磁盘。如果您的算法可以采用 List 接口而不是普通数组，则可以将 List 中的适配器写入内存映射文件。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-10-24T02:14:01.427

您可以尝试将其拆分为多个数组。

```
for(int x = 0; x <= 1000000; x++){
    myFirstList.add(x);
}
for(int x = 1000001; x <= 2000000; x++){
    mySecondList.add(x);
} 
```

然后遍历它们。

```
for(int x: myFirstList){
    for(int y: myFirstList){
        //Remove multiples
    }
}
//repeat for second list 
```

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2009-03-23T16:54:13.213

请改用内存映射文件（Java 5 NIO 包）。或者将筛子移到一个小型 C 库中并使用[Java JNI](http://java.sun.com/j2se/1.5.0/docs/guide/jni/)。

# c# - 通过 TCP 传输程序集

> ID：674194
> 
> 赞同：2
> 
> 时间：2009-03-23T16:52:27.757
> 
> 标签：c#, .net, assemblies

我目前正在尝试通过 TCP 连接发送序列化对象，如下所示 -

```
BinaryFormatter formatter = new BinaryFormatter();

        formatter.Serialize(clientStream, (Object)Assembly.LoadFrom("test.dll")); 
```

客户端流在哪里

```
TcpClient tcpClient = (TcpClient)client;
        NetworkStream clientStream = tcpClient.GetStream(); 
```

这是发送部分。但是谁能告诉我如何在客户端接收它（即在另一端反序列化它）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T16:55:34.067

您正在尝试通过线路传递程序集的内存中表示，而不是包含程序集文件本身的字节。这真的是你想做的吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T17:51:16.227

不要序列化程序集。只需将程序集作为文件加载并将这些字节发送到另一端即可发送程序集本身。

然后，当双方的代码相同时，通过序列化发送对象。我相信反序列化对象的 AppDomain 必须加载相关的程序集（或至少可以加载）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T16:57:32.783

根据评论，答案完全不同。

您应该通过 Location 属性获取程序集的位置，而不是使用 BinaryFormatter，然后使用 FileStream 读取程序集的字节并通过网络*发送*。

序列化程序集只不过是发送程序集名称。您需要发送程序集的全部内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T16:59:56.303

尝试使用`BinaryWriter`for 写入流并`BinaryReader`从中读取。

# ruby - 如何在运行时将页面添加到 Gtk Notebook 小部件？

> ID：674195
> 
> 赞同：5
> 
> 时间：2009-03-23T16:52:40.393
> 
> 标签：ruby, gtk, widget

我有以下代码：

```
 require "gtk2"

# adds a page to the notebook with the given label
def create_page(nb,label="untitled")
    # create a textview
    tx = Gtk::TextView.new
    # append it
    nb.append_page(tx,Gtk::Label.new(label))
end

Gtk.init
window = Gtk::Window.new
window.set_default_size(800,600)
window.signal_connect("destroy") {
    Gtk.main_quit
}

container   = Gtk::VBox.new
notebook    = Gtk::Notebook.new
button      = Gtk::Button.new("New")

# when I push the button, I want a new page to be added
button.signal_connect("clicked") {
    create_page(notebook)
}

container.pack_start(button,false,false,0)
create_page(notebook)
container.pack_start(notebook,true,true,0)
window.add(container)

window.show_all
Gtk.main 
```

基本上，它是一个包含按钮和笔记本小部件的窗口。当我按下按钮时，我希望能够向笔记本小部件添加新页面/标签。然而，什么也没有发生。我应该手动进行某种重绘吗？我在滥用笔记本小部件吗？如何在运行时添加选项卡？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T17:03:33.067

通过替换这个：

```
 button.signal_connect("clicked") {
    create_page(notebook)
} 
```

有了这个：

```
 button.signal_connect("clicked") {
    create_page(notebook)
    notebook.show_all
} 
```

新添加的选项卡/页面变得可见。

# hash - 防止欺诈性提交给记分牌

> ID：674201
> 
> 赞同：1
> 
> 时间：2009-03-23T16:53:36.507
> 
> 标签：hash, flash, checksum, database-security

我正在开发 Flash 游戏的后端，我需要*保护*进入记分板的数据。

该游戏将在横幅广告中托管在许多网站上，用户将在广告中玩游戏，然后点击进入主站点以保存他们的详细信息。

目前我正在考虑这个问题

1.  用户玩游戏并点击提交他们的分数
2.  在后台，横幅将分数和原始域发送到主站点上的脚本。
3.  脚本检查域是托管广告的有效域之一。
4.  如果一切正常，脚本会创建此分数和域的哈希值，并将其与分数一起存储在数据库中。
5.  该脚本将哈希返回给 Flash，Flash 将其拼凑到打开主记分板的 getURL 的查询字符串中
6.  记分牌页面会检查引用者以确保它是有效域之一。
7.  如果是，则检查数据库的哈希值是否是有效令牌
8.  然后用户填写他们的详细信息并根据哈希更新记录

上次我检查 FLash 不发送推荐人信息时，这有点让我的计划陷入困境。那么，这种 Flash/Database 交互是否已经建立了模式？

我应该在第 4 步中使用哪种散列/校验和？这种操作的正确名称是什么，是哈希、校验和还是其他什么？

我知道作为一种客户端技术，Flash 永远不会真正那么安全，但在我看来，像上面这样的东西与你要破解这种应用程序一样困难。

更新：我的主要目标是让人们更难找到将分数添加到数据库的脚本的 URL，并简单地用虚假分数发送垃圾邮件。

谢谢，格雷格

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T17:30:20.443

本质上，您不想验证分数是否来自合法客户端，您想验证客户端实际玩游戏以获得分数。从本质上讲，您可以期望的最好的结果是人们被要求创建一个 AI 来玩游戏。

您可以尝试以下几件事：

*   将输入记录到游戏中并将其与分数一起发送。服务器然后可以验证分数对应于可能的游戏。您也可以通过这种方式检测重复提交。
*   应用速率限制以阻止客户以明显不人道的速度提交分数。根据实际可能达到的目标对允许分数应用上限，对每秒操作数等应用下限。
*   使用以前的输入来部分播种伪随机数生成器（假设您使用一个）。这使得客户不太可能稍微更改提交内容并仍然获得有效的游戏/分数组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T17:46:02.107

我之前在游戏行业工作过，也做过类似的事情。据我所知，没有人会费心破解分数提交部分。

它的完成方式是：

1.  生成一个随机数作为盐（来自闪存）
2.  基于盐（来自闪存）使用数学运算对分数进行编码
3.  添加校验和以确保乐谱上没有回火（来自闪存）
4.  将分数和任何所需数据发送到分数提交页面
5.  在服务器上，使用校验和验证分数没有被调和
6.  如果分数有效，则将其插入数据库，否则，拒绝它
7.  如果您愿意，您可以记录违反校验和的分数提交者的 IP 地址（可能是三个错误校验和的策略，您退出了）并添加一个脚本以禁止他们访问服务器 1 小时，但这可能不会除非有人想破解你的代码那么糟糕。

注意：散列/校验和是使用自定义函数进行的。不需要非常安全的东西。它是使用盐和分数的计算得出的。一些简单的数学运算，如求和、乘法和减法。

* * *

**编辑**：校验和的简单算法/数学

假设您的用户的得分为**5885**。
您生成一个随机数作为**134789**的盐（恒定长度，用 0 填充）

**cryptedScore** = **Score** * **Salt**（你应该在这里使用一些更复杂的东西，但这只是一个例子）

在我们的示例中，加密分数为：**793233265**

现在对于校验和，假设您希望将值**253**作为校验和。
您将加密分数的所有数字相加 7+9+3+2+3+3+2+6+5 = **40**

现在，您计算此分数
**253**的校验和值- （加密分数数字的总和 % **253**）

现在，我们有以下数字：
盐 = **134789**
加密分数 = **793233265**
校验和 = **40**

您向服务器发出请求，发送**134789793233265040**作为分数。

在分数服务器上，您可以将**793233265**除以**134789**得到**5885**，并使用与以前相同的函数验证校验和。

如果校验和失败，则数字已被篡改。

您可能最终会得到更安全的东西，但它应该可以解决问题。

# c# - 将通用列表绑定到转发器 - ASP.NET

> ID：674204
> 
> 赞同：36
> 
> 时间：2009-03-23T16:53:46.707
> 
> 标签：c#, asp.net, repeater

我正在尝试将 a 绑定`List<AreaField>`到中继器。我已经使用该方法将列表转换为数组`ToArray()`，现在有一个数组`AreaField[]`

这是我的类层次结构

```
public class AreaFields
{
    public List<Fields> Fields { set; get; }
}

public class Fields
{
    public string Name { set; get; }
    public string Value {set; get; }
} 
```

在aspx中，我想将它绑定一个转发器（类似这样）

```
DataBinder.Eval(Container.DataItem, "MyAreaFieldName1") 
```

MyAreaFieldName1 是 AreaFieldItem 类中 Name 属性的值。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2010-05-18T20:53:35.103

出乎意料的简单...

后面的代码：

```
// Here's your object that you'll create a list of
private class Products
{
    public string ProductName { get; set; }
    public string ProductDescription { get; set; }
    public string ProductPrice { get; set; }
}

// Here you pass in the List of Products
private void BindItemsInCart(List<Products> ListOfSelectedProducts)
{   
    // The the LIST as the DataSource
    this.rptItemsInCart.DataSource = ListOfSelectedProducts;

    // Then bind the repeater
    // The public properties become the columns of your repeater
    this.rptItemsInCart.DataBind();
} 
```

ASP 代码：

```
<asp:Repeater ID="rptItemsInCart" runat="server">
  <HeaderTemplate>
    <table>
      <thead>
        <tr>
            <th>Product Name</th>
            <th>Product Description</th>
            <th>Product Price</th>
        </tr>
      </thead>
      <tbody>
  </HeaderTemplate>
  <ItemTemplate>
    <tr>
      <td><%# Eval("ProductName") %></td>
      <td><%# Eval("ProductDescription")%></td>
      <td><%# Eval("ProductPrice")%></td>
    </tr>
  </ItemTemplate>
  <FooterTemplate>
    </tbody>
    </table>
  </FooterTemplate>
</asp:Repeater> 
```

我希望这有帮助！

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-23T17:00:43.337

您可能想要创建一个 subRepeater。

```
<asp:Repeater ID="SubRepeater" runat="server" DataSource='<%# Eval("Fields") %>'>
  <ItemTemplate>
    <span><%# Eval("Name") %></span>
  </ItemTemplate>
</asp:Repeater> 
```

你也可以投射你的领域

```
<%# ((ArrayFields)Container.DataItem).Fields[0].Name %> 
```

最后你可以做一个小 CSV 函数并用函数写出你的字段

```
<%# GetAsCsv(((ArrayFields)Container.DataItem).Fields) %>

public string GetAsCsv(IEnumerable<Fields> fields)
{
  var builder = new StringBuilder();
  foreach(var f in fields)
  {
    builder.Append(f);
    builder.Append(",");
  }
  builder.Remove(builder.Length - 1);
  return builder.ToString();
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-04-15T07:17:50.707

代码背后：

```
public class Friends
{
    public string   ID      { get; set; }
    public string   Name    { get; set; }
    public string   Image   { get; set; }
}

protected void Page_Load(object sender, EventArgs e)
{
        List <Friends> friendsList = new List<Friends>();

        foreach (var friend  in friendz)
        {
            friendsList.Add(
                new Friends { ID = friend.id, Name = friend.name }    
            );

        }

        this.rptFriends.DataSource = friendsList;
        this.rptFriends.DataBind();
} 
```

* * *

.aspx 页面

```
<asp:Repeater ID="rptFriends" runat="server">
            <HeaderTemplate>
                <table border="0" cellpadding="0" cellspacing="0">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                        </tr>
                    </thead>
                    <tbody>
            </HeaderTemplate>
            <ItemTemplate>
                    <tr>
                        <td><%# Eval("ID") %></td>
                        <td><%# Eval("Name") %></td>
                    </tr>
            </ItemTemplate>
            <FooterTemplate>
                    </tbody>
                </table>
            </FooterTemplate>
        </asp:Repeater> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-02-12T09:33:47.773

您应该使用 ToList() 方法。（不要忘记 System.Linq 命名空间）

前任。：

```
IList<Model> models = Builder<Model>.CreateListOfSize(10).Build();
List<Model> lstMOdels = models.ToList(); 
```

# java - 在 JSP 自定义标签中为 HTML 实现“窗口管理器”

> ID：674212
> 
> 赞同：0
> 
> 时间：2009-03-23T16:54:20.530
> 
> 标签：java, html, css, jsp, custom-tag

我有一个问题：我需要构建一个自定义标签，它可以获取它的子标签（每个都将呈现为某种 HTML 小部件）并以某种智能方式将它们呈现到页面中。

这是一个相当开放的问题，所以我想了很多不同的方法来解决它。我需要的是一些关于如何的输入：

*   其他人已经做到了
*   想法

我的想法：

*   使用类似于 960 网格系统 CSS 的布局，并使用 JSP 自定义标记属性指定每个小部件的位置。如果没有指定，做一个流布局
*   使用 HTML 表格，并使用流布局将每个小部件粘贴到单元格中（这可能会出现问题，因为某些小部件不是方形的，它们是 3x1 或 1x3 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:19:42.123

“其他人是怎么做到的”——他们可能使用过门户网站？

也许[Apache Portals](http://portals.apache.org/)页面上的一些东西可以帮助你。

# wpf - WPF - FocusVisualStyle 我在哪里应用它？

> ID：674219
> 
> 赞同：3
> 
> 时间：2009-03-23T16:55:17.063
> 
> 标签：wpf, focusvisualstyle

我有一个`UserControl`基本上`ListBox`像这样包装的 -

```
 <ListBox x:Name="lb" ItemsSource="{Binding ElementName=UC,Path=Pages}"
             Background="{Binding ElementName=UC,Path=Background}"
             BorderBrush="Transparent"
             ScrollViewer.CanContentScroll="False" 
             ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
             ScrollViewer.VerticalScrollBarVisibility="Disabled">

        <ListBox.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal" IsItemsHost="True"/>
            </ItemsPanelTemplate>
        </ListBox.ItemsPanel>

        <ListBox.ItemTemplate>
            <DataTemplate>
                <Grid Width="{Binding ElementName=UC,Path=ActualWidth}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition MinWidth="20"/>
                        <ColumnDefinition/>
                        <ColumnDefinition MinWidth="20"/>
                    </Grid.ColumnDefinitions>
                    <ContentPresenter Grid.Column="1" Content="{Binding}"/>
                </Grid>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

我需要将其设置`FocusVisualStyle`为`{x:Null}`隐藏此功能，但无论我在哪里应用它，我仍然会获得默认的蓝色选择颜色。我尝试在 ListBox、StackPanel 和 Grid 上设置它，但无济于事。

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T17:00:36.270

FocusVisualStyle 在焦点元素周围应用“行军蚂蚁”，而不是背景颜色。要更改所选 ListBoxItems 的背景颜色，请执行以下操作：

```
<ListBox>
    <ListBox.Resources>
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Value="Red"/>
        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Value="Black"/>
    </ListBox.Resources>    
</ListBox> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T17:17:49.897

Kent 是正确的，当使用 Tab 键选择控件时，FocusVisualStyle 仅与键盘焦点相关。

如果您只是想显示一个没有任何选择功能的列表，您可能只能将您的 ListBox 降级为 ItemsControl

```
<ItemsControl x:Name="lb" ItemsSource="{Binding ElementName=UC,Path=Pages}" 
  Background="{Binding ElementName=UC,Path=Background}" 
  BorderBrush="Transparent" ScrollViewer.CanContentScroll="False" 
  ScrollViewer.HorizontalScrollBarVisibility="Hidden" 
  ScrollViewer.VerticalScrollBarVisibility="Disabled">
  <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <StackPanel Orientation="Horizontal" IsItemsHost="True"/>
        </ItemsPanelTemplate>
  </ItemsControl.ItemsPanel>
  <!-- others -->
</ItemsControl> 
```

# c# - 在C#中从角度计算圆周上的点？

> ID：674225
> 
> 赞同：40
> 
> 时间：2009-03-23T16:57:06.827
> 
> 标签：c#, math, geometry, angle

我想这是一个简单的问题，但是我当前的代码得到了一些奇怪的结果，而且我没有数学背景来完全理解为什么。正如标题中所述，我的目标很简单：我只想找到与中心点有一定距离和角度的点。

我当前的代码：

```
Point centerPoint = new Point ( 0, 0 );
Point result      = new Point ( 0, 0 );
double angle      = 0.5; //between 0 and 2 * PI, angle is in radians
int distance      = 1000;

result.Y = centerPoint.Y + (int)Math.Round( distance * Math.Sin( angle ) );
result.X = centerPoint.X + (int)Math.Round( distance * Math.Cos( angle ) ); 
```

一般来说，这似乎相当合理，但我在不同的地方遇到了问题，最明显的是当角度对应于负 x 和 y 轴上的点时。很明显我做错了什么——思考那是什么？

更新：这是我的错误，这段代码工作正常——少数不工作的异常值实际上是由于计算 1.5PI 的角度存在错误。我以为我已经检查得足够好，但显然没有。感谢大家的时间，希望上面的工作代码对其他人有帮助。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-23T17:19:08.877

您忘记添加中心点：

```
result.Y = (int)Math.Round( centerPoint.Y + distance * Math.Sin( angle ) );
result.X = (int)Math.Round( centerPoint.X + distance * Math.Cos( angle ) ); 
```

其余的应该没问题......（你得到了什么奇怪的结果？你能给出准确的输入吗？）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T17:17:52.110

首先，因为你是弧度，所以定义你的角度可能是有益的：

```
double angle = (Math.PI / 3); // 60 degrees... 
```

功能本身运行良好。如果您的距离足够小，四舍五入只会影响您的答案。除此之外，答案应该很好。

如果这是您担心的舍入，请记住，默认情况下，.NET 会进行[银行家的舍入](http://blog.troyd.net/Bankers+Rounding+Vs+Common+Rounding+In+NET.aspx)，您可能想要：

```
result.X = (int)Math.Round(centerPoint.X + distance * Math.Cos(angle), MidpointRounding.AwayFromZero);
result.Y = (int)Math.Round(centerPoint.Y + distance * Math.Sin(angle), MidpointRounding.AwayFromZero); 
```

反而。

此外，在你想要*距离 X 和角度 Y*的问题中......我假设你没有把它与 point 联系起来`(X,Y)`，因为那是完全不同的。

距离公式为：

```
double distance = Math.Sqrt((centerPoint.X + result.X)^2 + (centerPoint.Y + result.Y)^2); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-08-08T19:43:25.863

一个 Swift3 版本

```
func pointOnCircle(radius: Double, angleInDegrees: Double, origin: CGPoint) -> CGPoint {
    let x = abs(Double(origin.x) + radius * cos(angleInDegrees * (.pi / 180)))
    let y = abs(Double(origin.y) - radius * sin(angleInDegrees * (.pi / 180)))

    return CGPoint(x: x, y: y)
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T18:12:00.560

如果没有关于确切错误的更多信息，就很难判断出了什么问题。方程看起来正确，应该可以工作。您确定您传入的角度对于 > 90 度的角度是否正确？我唯一能想到的另一件事是你将距离（一个 int）乘以 Math.sin （双精度）的结果，但这不应该是一个真正的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-20T05:58:54.497

```
-(NSMutableArray *)GetPointsForCircle
    {
       NSMutableArray *Points = [[NSMutableArray alloc] init];
       CGPoint CenterPoint = CGPointMake(160, 230);
       CGPoint Point;
       for (float Angel = 0; Angel <= 360; Angel+= 60)
         {
           Point.x = CenterPoint.x + 100 * cos(Angel);
           Point.y = CenterPoint.y + 100 * sin(Angel);
           [Points addObject:[NSValue valueWithCGPoint:Point]];
         }
       return Points;
    }

    - (CGPoint)pointOnCircle:(int)thisPoint withTotalPointCount:(int)totalPoints
     {
        CGPoint centerPoint = CGPointMake(self.view.frame.size.width / 2, self.view.frame.size.height / 2);
        float radius = 100.0;
        float angle = ( 2 * M_PI / (float)totalPoints ) * (float)thisPoint;
        CGPoint newPoint;
        newPoint.x = (centerPoint.x) + (radius * cosf(angle));
        newPoint.y = (centerPoint.y) + (radius * sinf(angle));
        return newPoint;   
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T18:18:37.987

我不知道 c#，无论如何，如果你想在某个地方画点，你必须考虑 Y 轴从屏幕顶部到底部折痕的事实，所以你的**sin**元素应该是**-sin(.. .)**而不是*+sin(...)*

所以

```
result.Y = centerPoint.Y + (int)Math.Round( distance * Math.Sin( angle ) ); 
```

应该变成：

```
result.Y = centerPoint.Y - (int)Math.Round( distance * Math.Sin( angle ) ); 
```

如果您不尝试绘制它们，我无法想象问题出在哪里，您能举个例子吗？

# python - Python list.index 在找不到索引时抛出异常

> ID：674229
> 
> 赞同：25
> 
> 时间：2009-03-23T16:58:07.463
> 
> 标签：python, indexing, list

为什么 list.index 会抛出异常，而不是使用任意值（例如`-1`）？这背后的想法是什么？

对我来说，处理特殊值而不是异常看起来更干净。

**编辑**：我没有意识到`-1`这是一个潜在的有效值。尽管如此，为什么不做其他事情呢？None 的值怎么样？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T17:02:18.810

因为`-1`它本身就是一个有效的索引。它可以使用不同的值，例如`None`，但这不会有用，这`-1`可能在其他情况下（因此`str.find()`），并且仅相当于错误检查，这正是异常的用途。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-23T17:04:10.927

好吧，特殊值实际上必须是**`None`**，因为 -1 是一个有效的索引（意味着列表的最后一个元素）。

您可以通过以下方式模拟此行为：

```
idx = l.index(x) if x in l else None 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-23T17:05:02.267

补充一下 Devin 的回答：这是特殊返回值与异常之间的老争论。许多编程大师更喜欢异常，因为在出​​现异常时，我可以看到整个堆栈跟踪并立即推断出什么是错误的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T21:46:03.057

“异常值与错误值”的争论部分是关于代码清晰度的。考虑带有错误值的代码：

```
idx = sequence.index(x)
if idx == ERROR:
    # do error processing
else:
    print '%s occurred at position %s.' % (x, idx) 
```

错误处理最终被塞进了我们算法的中间，使程序流程变得模糊。另一方面：

```
try:
    idx = sequence.index(x)
    print '%s occurred at position %s.' % (x, idx)
except IndexError:
    # do error processing 
```

在这种情况下，代码量实际上是相同的，但主要算法没有被错误处理破坏。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T17:28:02.117

主要是为了确保尽快发现错误。例如，考虑以下情况：

```
l = [1, 2, 3]
x = l.index("foo")  #normally, this will raise an error
l[x]  #However, if line 2 returned None, it would error here 
```

您会注意到，如果 index 返回 None ，则会引发错误`l[x]`而不是 at 。`x = l.index("foo")`在这个例子中，这并不是什么大问题。但是想象一下，第三行在百万行程序中的某个完全不同的地方。这可能会导致一些调试噩梦。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T17:04:00.600

在 Python 中，-1 是一个有效的索引，表示从列表末尾（而不是开头）开始的数字，所以如果你要这样做

```
idx = mylist.index(someval)
nextval = mylist[idx+1] 
```

然后你会得到数组的第一个值，而不是意识到有一个错误。这样你就可以捕获异常并处理它。如果您不想要异常，则只需事先检查：

```
if someval in mylist:
    idx = mylist.index(someval) 
```

编辑：返回 None 没有任何意义，因为如果您要测试 None，您不妨测试该值是否在上面的列表中！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T17:07:49.047

我同意 Devin Jeanpierre 的观点，并补充说在小例子中处理特殊值可能看起来不错，但是（除了一些值得注意的例外，例如 FPU 中的 NaN 和 SQL 中的 Null）它的扩展性几乎没有。它唯一有效的地方是：

*   你通常有很多嵌套的同构处理（例如数学或 SQL）
*   你不关心区分错误类型
*   你不在乎错误发生在哪里
*   这些操作是纯函数，没有副作用。
*   失败可以在更高级别赋予合理的含义（例如“没有匹配的行”）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T17:04:17.977

一个简单的想法：`-1`完全可以用作索引（与其他负值一样）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-23T17:07:23.540

这是一个语义论证。如果你想知道一个元素的索引，你就声称它已经存在于列表中。如果你想知道它是否存在，你应该使用`in`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-02-16T10:38:51.313

```
def GetListIndex(list, searchString):
    try:
        return list.index(searchString)

    except ValueError:
        return False

    except Exception:
        raise 
```

# asp.net - 函数体后缺少 MicrosoftAjax.js 错误 }

> ID：674231
> 
> 赞同：0
> 
> 时间：2009-03-23T16:58:49.347
> 
> 标签：asp.net, autocomplete

我正在用 asp .net 2.0 web 表单构建一个站点。

当我加载页面时，萤火虫给了我错误：

在函数体 createCallback()("") //]]>\n 之后缺少 }

它在一个名为 MicrosoftAjax.js 的文件中

这可能是什么原因造成的？

**更新** 我做了更多的挖掘，看起来问题来自ajaxtoolkit，特别是AutoCompleteExtender。

当我剥离页面时，页面的唯一 javascript 是扩展器。我不确定这是否相关，但扩展器位于 gridview 行中的文本框上。

我仍然不确定如何解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T17:11:18.943

你有任何自己的自定义 javascript 吗？尝试删除它，看看您是否仍然收到错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T17:20:07.283

如果您在列表中留下尾随的“，”，IE 的 jscript 引擎会变得非常混乱，例如 {a,b,} 将在与错误所在位置无关的位置创建编译错误。遵循本德威的做法是最好的做法——分而治之，找出问题所在。

我假设 firebug 使用与 IE 相同的 jscript 引擎。FF 和 Chrome 没有这个问题，所以这是一个额外的症状。

# c# - 如何让 msi 覆盖旧文件？

> ID：674233
> 
> 赞同：3
> 
> 时间：2009-03-23T16:59:29.113
> 
> 标签：c#, .net, iis, installation

我有一个标准的 Visual Studio (2008) 应用程序设置项目，它生成一个包含一些文件的 msi。然而，我注意到：1）当安装了 msi 并且某些文件已经存在时，它会默默地忽略这些文件。由于显而易见的原因，这是我*不想要的行为。*2) 当我卸载 msi 时，它不会删除我的主 dll 文件。

我该如何解决这两个问题？它们一起使我无法自动升级我的软件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T17:16:12.490

我遇到了完全相同的问题，最终放弃了。让它工作是一个可怕而复杂的过程，涉及大量的 GUID。之后你会觉得很脏（假设你曾经让它工作）。

我的建议是切换到更适合像你我这样的人的 Inno Setup。

将 .msi 留给进行“企业推广”而不是“安装”的人。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T18:54:42.800

您是否在安装项目中增加了版本号？增加版本号也会要求您创建一个新的产品 ID。您应该用“是”来确认这个问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-10T12:10:28.527

当我测试用 MSI 覆盖现有文件时，我遇到了类似的问题 - 现有的旧文件没有被 MSI 中的新文件替换。

我没有覆盖现有文件的新文件是版本化文件（它们是 DLL），并且文件版本号没有改变，即使修改日期较晚。一旦我将较新文件的文件版本号更改为比现有文件更高的版本，现有文件就会被 msi 覆盖。

然后还有其他文件，如 .manifest 和 .vsto，它们是由 Visual Studio 生成的，这些文件没有版本，通常遵循[安装程序版本控制](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368599%28v=vs.85%29.aspx "安装程序版本控制规则")规则。这些实际上都与一个 DLL 文件有关，并且为每个 .manifest、.vsto 等文件提供一个引用该 DLL 的 CompanionFile 属性就可以解决问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-24T22:31:43.097

只要不删除所有文件，请检查下面的引用计数 `[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\SharedDLLs]`

如果您使用`MSIZAP`了又名“Windows Installer Cleanup Utility”，那么您基本上已经将您的机器置于未知状态，您需要手动从注册表中删除所有内容（在我的公司，我们有一个实用程序可以删除所有已知的注册表项从产品的最后 10 个版本开始，基本上由一个 1000 行的 .reg 文件和一些其他工具组成），然后您才能再次可靠地测试您的设置。

请参阅[http://robmensching.com/blog/posts/2009/3/6/More-on-Haacks-Troubleshooting-Windows-MSI-Installers](http://robmensching.com/blog/posts/2009/3/6/More-on-Haacks-Troubleshooting-Windows-MSI-Installers)了解更多信息，了解当您的机器进入“不受支持的状态”时会发生什么" 以及在继续之前您需要如何手动清理内容或重新格式化。

我们遇到了这个问题，因为 Installshield 自动默认将组件设置为共享组件，所以我们最终会遇到奇怪的引用计数错误、遗留文件等等。一个非常丑陋的解决方案。

对于您的升级，请尝试进行主要升级而不是次要升级（补丁），因为当您第一次进入 Windows Installer 时，这更容易理解*。*但首先，您需要正确卸载您的应用程序，然后才能继续升级。如果无法正确卸载，则无法正确升级。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-03T12:22:48.030

另一种选择是在应用程序的安装文件夹中包含版本号。
将应用程序文件夹的默认位置设置为：

```
[ProgramFilesFolder]\\[ProductName]\\[ProductVersion] 
```

还将 Setup 项目的`RemovePreviousVersions`属性设置为 true。
这应该删除旧版本的文件夹并为新版本创建一个新文件夹。
每次发布新版本时，请记住更改安装项目的版本属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-02-01T06:52:26.510

另一种选择是以程序方式卸载当前应用程序并安装新的 msi，但这需要自定义 winforms 应用程序

# vb6 - VB6 内存泄漏

> ID：674247
> 
> 赞同：1
> 
> 时间：2009-03-23T17:01:45.143
> 
> 标签：vb6, memory-management, memory-leaks

不包含关键字“New”的 VB6 程序会出现内存泄漏吗？

如果有，请举个例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T08:49:31.513

总结到目前为止的答案：调用另一个组件可能会引入内存泄漏。该组件可能有问题，或者您可能正在滥用它。该组件可以是 OCX 或 DLL（包括对 Windows DLL 的 API 调用，这是泄漏内存和 Windows 资源的绝佳方式，更不用说许多其他令人兴奋的问题了）。

还有一个迂腐的观点：您可以使用 创建对象，因此您可以通过[循环引用](http://www.vbaccelerator.com/home/vb/Code/Techniques/Dealing_with_Circular_References/article.asp)`CreateObject`泄漏内存而不使用. onedaywhen在[评论](https://stackoverflow.com/users/15354/onedaywhen)中指出，您还可以使用表单变量创建循环引用，而无需使用. 但我认为问题的关键在于 VB6 内存泄漏除了循环引用之外是否还有其他原因。`New``New`

* * *

递归的[答案](https://stackoverflow.com/questions/674247/vb6-memory-leak/674270#674270)不会导致内存泄漏 - 引用计数将在每次执行循环时整理内存 - 请参阅我对答案的评论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T17:04:17.400

您可能正在调用存在内存泄漏的第三方 DLL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T17:04:29.053

是的，它可以。在我了解特定 Windows API 调用中的内存泄漏之前，我编写的一个使用透明 Blits 的 VB6 程序出现了内存泄漏。因此，虽然泄漏不在程序本身中，但在 VB6 在 Win32 API 中调用的函数之一中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:11:57.773

...并且不要忘记 OCX 中的内存泄漏

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T17:11:12.453

在 COM+ 下运行时，我们在模块中使用全局变量时发生了泄漏。这是很久以前的事了，具体不记得了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-25T05:47:03.487

关于内存泄漏，对 New 的痴迷是什么？除了通过在将引用变量设置为 Nothing 后触摸引用变量来分配另一个对象之外，我看不到任何关系。

如果你这样做，无论如何你可能有一个逻辑错误。不使用 New 只是意味着你会炸毁，这几乎不是我“修复”任何东西的想法。

最严重的泄漏可能涉及 API 调用，例如对 OLE 或 GDI 例程的调用，这些调用需要显式清理/释放隐式分配的数据结构。

但正如我所说，将 New 与内存泄漏联系起来对我来说听起来很疯狂。

# vb.net - 如何将 1400-1500 转换为 2pm - 3pm？

> ID：674269
> 
> 赞同：3
> 
> 时间：2009-03-23T17:05:10.410
> 
> 标签：vb.net, datetime, time

我正在从服务接收表示时隙的数据，格式为：

> 1500-1600

这意味着下午 3 点到 4 点。

我将列出这些，例如

> 1200-1300
> 
> 1300-1400
> 
> 1400-1500

我必须在 UI 中将其表示为

> 中午 12 点至下午 1 点
> 
> 下午 1 点 - 下午 2 点
> 
> 下午 2 点至 3 点

不幸的是，这个列表可能是随机的。

我的问题是有什么方法可以使用 DateTime 对象来将 24 小时时间转换为 12 小时时间，还有一种方法可以按顺序排列时间吗？

目前我觉得我将不得不编写一个自定义解析函数，但想知道是否有人知道如何更好地做到这一点？或者可以建议他们如何实现这一目标。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-23T17:11:25.277

我假设您知道如何将时间分成“1400”和“1500”。最简单的方法（IMO）是使用

```
DateTime.ParseExact(input, "HHmm", CultureInfo.InvariantCulture) 
```

这将返回`DateTime`带有今天日期和给定时间的 a。然后，您可以随意格式化`DateTime`。

或者，您可以将“1400”解析为整数，然后使用 Math.DivRem 除以 100 来查找分钟和小时。不过，我个人更喜欢使用 DateTime。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T17:15:19.247

如果你有四位数的字符串（1200、1300）并且它总是四位数（例如上午 9 点是 0900），那么你可以像这样调用[结构](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)上的静态[`ParseExact`方法](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)：[`DateTime`](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)

```
DateTime dt = DateTime.ParseExact(time, "HHmm", formatInfo); 
```

`formatInfo`是一个[`IFormatProvider`接口](http://msdn.microsoft.com/en-us/library/system.iformatprovider.aspx)实现。

如果你有一个三位数的字符串，那么你可以使用这个：

```
DateTime dt = DateTime.ParseExact(time, "Hmm", formatInfo); 
```

但是，我建议使用四位数的字符串，因为像“121”这样的时间会产生歧义。

从那里，如果你想输出 am/pm 等，你只需调用[`ToString`方法](http://msdn.microsoft.com/en-us/library/zdtaw1bw.aspx)，传递以下格式：

```
string ampm = dt.ToString("htt"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T17:13:01.983

我会首先拆分“ - ”以获取两个不同的字符串，然后使用该`DateTime.ParseExact()`方法将其转换为可用的日期时间对象

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T17:15:20.120

试试这个来转换和输出你需要的任何格式

```
Dim aDateTime As DateTime
aDateTime = DateTime.ParseExact(input, "HHmm", Nothing)
Dim outputToDesiredFormat As String = dt.ToString("h:mm tt") 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-03-23T17:11:01.893

自定义解析应该是微不足道的。在'-'处拆分并每次解析；去掉最后两位得到分钟，剩下的一两位得到小时，你就完成了。

如果您需要按顺序排列它们。

如果您需要更多帮助，请更新问题或发表评论。

# ant - 如何从 shellscript 任务中访问 ant 属性？

> ID：674276
> 
> 赞同：1
> 
> 时间：2009-03-23T17:07:15.757
> 
> 标签：ant, shell

在 ant 中，您可以执行以下操作：

```
<property name="version" value="${some.fake.version}"

<shellscript shell="bash" dir="${build.dir}"> 
   echo "some shell cmds"
   df -h
   ls *
   svn export http://svn.org/somedir              
</shellscript> 
```

好的，我知道，那个 shell 脚本没有做任何事情，但是我如何从那个 shellscript 中获取属性“版本”？

我知道您可以在 Java 脚本中执行上述所有操作，这比大多数用途都要好，但在实际脚本中，我正在执行大量 svn 命令，无论如何我都必须为此付出代价。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:10:17.370

如果您不想自己编写，可以使用一些[“官方”SVN Ant 任务。](http://subclipse.tigris.org/svnant.html)

否则，由于`ShellScript`extends[`Exec`](http://ant.apache.org/manual/Tasks/exec.html)您可以使用参数。

```
<shellscript shell="bash" dir="${build.dir}"> 
  <arg value="${someproperty}"/>
   echo $1
</shellscript> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T17:14:16.923

根据[shellscript 文档](http://ant-contrib.sourceforge.net/tasks/tasks/shellscript.html)：

> 嵌入的 ant 属性将被转换。

所以你可以使用 ${variable} 表示法：

```
<shellscript shell="bash" dir="${build.dir}"> 
   echo "Version: ${version}"
</shellscript> 
```

# eclipse-rcp - Eclipse RCP - 内容辅助问题

> ID：674278
> 
> 赞同：0
> 
> 时间：2009-03-23T17:07:29.500
> 
> 标签：eclipse-rcp

我正在尝试向我的编辑器添加内容辅助。我已经添加

```
 public IContentAssistant getContentAssistant(ISourceViewer sv) {
    ContentAssistant ca = new ContentAssistant();
    IContentAssistProcessor pr = new TagCompletionProcessor();
    ca.setContentAssistProcessor(pr, XMLPartitionScanner.XML_TAG);
    ca.setContentAssistProcessor(pr, IDocument.DEFAULT_CONTENT_TYPE);
    return ca;
} 
```

编辑器配置，然后完成处理器类：

```
public class TagCompletionProcessor implements IContentAssistProcessor {
private ITypedRegion wordRegion;
private String currentWord;
private SmartTreeSet tags;
public TagCompletionProcessor() {
    tags = new SmartTreeSet();
    //filling tags skipped
}
@Override
public ICompletionProposal[] computeCompletionProposals(ITextViewer viewer,
        int offset) {
    System.out.println("compute");
    wordRegion = viewer.getDocument().getDocumentPartitioner().getPartition(offset);
    try {
        int offs = wordRegion.getOffset();
        int len = wordRegion.getLength();
        currentWord = viewer.getDocument().get(offs, len);
        return tags.getProposals(currentWord.toLowerCase(), offs, len);
    } catch (BadLocationException e) {
        return null;
    }
}
@Override
public IContextInformation[] computeContextInformation(ITextViewer viewer,
        int offset) {
    return null;
}
@Override
public char[] getCompletionProposalAutoActivationCharacters() {
    return new char[] {'<'};
}
@Override
public char[] getContextInformationAutoActivationCharacters() {
    return null;
}
@Override
public IContextInformationValidator getContextInformationValidator() {
    return null;
}
@Override
public String getErrorMessage() {
    return "No tags found";
} 
```

}

...但它不起作用。初始化正常，但自动激活不起作用，当我按 ctrl-space（我已将 org.eclipse.ui.edit.text.contentAssist.proposals 命令添加到 Bindings 分机点）出现空列表（也是不在光标附近，而是在某个固定位置）。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-20T10:29:09.660

如果您的文档实现*IDocumentExtension3*，那么您必须设置助手的分区..

```
ca.setDocumentPartitioning(MyPartitionScanner.MyPartitioning); 
```

希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-09T17:48:01.460

您应该在编辑器中注册您的操作并替换默认操作。这是一个如何使用内容辅助操作的示例。

[http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/editors_actions.htm](http://help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/editors_actions.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-19T09:48:18.650

抱歉，中间有一些空输出。多么失败=（

# c# - 如何在 temp 以外的目录中创建临时文件？

> ID：674303
> 
> 赞同：6
> 
> 时间：2009-03-23T17:12:46.693
> 
> 标签：c#, .net

我编写了一些代码，应该将文件写入临时目录，然后将其复制到永久位置，但发现这样做会在复制命令上产生与权限相关的错误。代码如下所示：

```
 string tempPath = Path.GetTempFileName();
 Stream theStream = new FileStream(tempPath, FileMode.Create);

  // Do stuff.

  File.Copy(tempPath, _CMan.SavePath, true);
  File.Delete(tempPath); 
```

我依稀记得有一个 API 调用可以在指定目录中创建一个临时文件，并作为参数传递。但是，这是我 VB 6 天以来的一段模糊记忆。

那么，如何在 Windows 定义的临时目录以外的目录中创建临时文件呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T17:14:56.143

```
Path.Combine(directoryYouWantTheRandomFile, Path.GetRandomFileName()) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T17:16:03.753

您的问题有点离题，但也许您只是在尝试复制之前没有关闭流？如果确实是权限问题，则在打开流时似乎会遇到基于权限的问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-30T10:33:12.573

您也可以使用 GetTempFileName Win32 API 函数来执行此操作：

```
<DllImport("kernel32.dll")> _
Private Shared Function GetTempFileName(ByVal lpPathName As String, ByVal lpPrefixString As String, ByVal uUnique As Integer, ByVal lpTempFileName As StringBuilder) As Integer

End Function

Sub CreateFile()
    Const path As String = "C:\MyTemp"
    Const prefix As String = "tmp"
    Dim fileName As New StringBuilder(576)
    Dim result As Integer = GetTempFileName(path, prefix, 0, fileName)
End Sub 
```

# python - 为什么 __init__() 总是在 __new__() 之后调用？

> ID：674304
> 
> 赞同：641
> 
> 时间：2009-03-23T17:13:01.187
> 
> 标签：python, design-patterns, class-design

我只是想简化我的一个类，并引入了一些与[享元设计模式](https://en.wikipedia.org/wiki/Flyweight_pattern)相同风格的功能。

但是，我有点困惑为什么`__init__`总是在`__new__`. 我没想到会这样。谁能告诉我为什么会发生这种情况以及如何实现此功能？（除了将实现放入`__new__`感觉很hacky之外。）

这是一个例子：

```
class A(object):
    _dict = dict()

    def __new__(cls):
        if 'key' in A._dict:
            print "EXISTS"
            return A._dict['key']
        else:
            print "NEW"
            return super(A, cls).__new__(cls)

    def __init__(self):
        print "INIT"
        A._dict['key'] = self
        print ""

a1 = A()
a2 = A()
a3 = A() 
```

输出：

```
NEW
INIT

EXISTS
INIT

EXISTS
INIT 
```

为什么？

* * *

## 回答 #1

> 赞同：672
> 
> 时间：2009-03-23T17:23:04.923

> **`__new__`**当您需要控制新实例的创建时使用。

> **`__init__`**当您需要控制新实例的初始化时使用。
> 
> **`__new__`**是创建实例的第一步。它首先被调用，并负责返回你的类的一个新实例。

> 相反， **`__init__`**不返回任何东西；它只负责在创建实例后对其进行初始化。
> 
> **`__new__`**通常，除非您将不可变类型（如 str、int、unicode 或 tuple）子类化，否则您不需要重写。

来自 2008 年 4 月的帖子：[何时使用`__new__`vs. `__init__`？](http://mail.python.org/pipermail/tutor/2008-April/061426.html)在 mail.python.org 上。

您应该考虑到您尝试做的事情通常是通过[工厂](http://en.wikipedia.org/wiki/Factory_object)完成的，这是最好的方法。使用**`__new__`**不是一个好的清洁解决方案，因此请考虑使用工厂。这是一个很好的例子：[ActiveState Fᴀᴄᴛᴏʀʏ ᴘᴀᴛᴛᴇʀɴ 食谱](http://code.activestate.com/recipes/86900/)。

* * *

## 回答 #2

> 赞同：190
> 
> 时间：2009-03-23T17:20:19.157

**`__new__`**是静态类方法，**`__init__`**而是实例方法。 **`__new__`**必须先创建实例，所以**`__init__`**可以初始化它。请注意，**`__init__`**作为**`self`**参数。在您创建实例之前，没有**`self`**.

现在，我收集到，您正在尝试在 Python中实现[单例模式。](http://en.wikipedia.org/wiki/Singleton_pattern)有几种方法可以做到这一点。

此外，从 Python 2.6 开始，您可以使用类[装饰器](http://www.python.org/dev/peps/pep-0318/)。

```
def singleton(cls):
    instances = {}
    def getinstance():
        if cls not in instances:
            instances[cls] = cls()
        return instances[cls]
    return getinstance

@singleton
class MyClass:
  ... 
```

* * *

## 回答 #3

> 赞同：169
> 
> 时间：2011-12-29T07:39:47.963

在大多数著名的 OO 语言中，表达式 like`SomeClass(arg1, arg2)`将分配一个新实例，初始化该实例的属性，然后返回它。

在大多数著名的 OO 语言中，可以通过定义**构造函数**为每个类自定义“初始化实例的属性”部分，该构造函数基本上只是对新实例进行操作的代码块（使用提供给构造函数表达式的参数) 来设置所需的任何初始条件。在 Python 中，这对应于类的`__init__`方法。

Python`__new__`无非就是“分配一个新实例”部分的类似的每类定制。这当然允许您执行不寻常的事情，例如返回现有实例而不是分配新实例。所以在 Python 中，我们不应该真的认为这部分必然涉及分配；我们所需要的只是`__new__`从某个地方提出一个合适的实例。

但这仍然只是工作的一半，Python 系统无法知道有时你想在`__init__`之后运行另一半工作（ ），而有时你不想。如果你想要这种行为，你必须明确地说出来。

通常，您可以重构以便只需要`__new__`，或者不需要`__new__`，或者`__init__`在已经初始化的对象上表现不同。但如果你真的想这样做，Python 实际上确实允许你重新定义“工作”，所以`SomeClass(arg1, arg2)`不一定 call`__new__`后跟`__init__`. 为此，您需要创建一个元类，并定义它的`__call__`方法。

元类只是一个类的类。类的`__call__`方法控制调用类实例时发生的情况。所以一个*metaclass*的`__call__`方法控制了当你调用一个类时会发生什么；即它允许您**从头到尾重新定义实例创建机制**。这是您可以最优雅地实现完全非标准的实例创建过程（例如单例模式）的级别。实际上，只需不到 10 行代码，您就可以实现一个元类，甚至**根本**`Singleton`不需要您使用 futz ，并且只需添加!就可以将*任何*正常的类变成单例类`__new__` ***`__metaclass__ = Singleton`***

 ***```
class Singleton(type):
    def __init__(self, *args, **kwargs):
        super(Singleton, self).__init__(*args, **kwargs)
        self.__instance = None
    def __call__(self, *args, **kwargs):
        if self.__instance is None:
            self.__instance = super(Singleton, self).__call__(*args, **kwargs)
        return self.__instance 
```

然而，这可能是比这种情况真正需要的更深层次的魔法！

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2009-03-23T17:29:23.317

引用[文档](https://docs.python.org/3/reference/datamodel.html#object.__new__)：

> 典型的实现通过调用超类的 __new__() 方法使用“super(currentclass, cls).__new__(cls[, ...])”和适当的参数来创建类的新实例，然后根据需要修改新创建的实例在返回之前。
> 
> ...
> 
> 如果 __new__() 没有返回 cls 的实例，则不会调用新实例的 __init__() 方法。
> 
> __new__() 主要用于允许不可变类型（如 int、str 或 tuple）的子类自定义实例创建。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2013-05-13T14:12:10.363

我意识到这个问题已经很老了，但我有一个类似的问题。以下做了我想要的：

```
class Agent(object):
    _agents = dict()

    def __new__(cls, *p):
        number = p[0]
        if not number in cls._agents:
            cls._agents[number] = object.__new__(cls)
        return cls._agents[number]

    def __init__(self, number):
        self.number = number

    def __eq__(self, rhs):
        return self.number == rhs.number

Agent("a") is Agent("a") == True 
```

我将此页面用作资源[http://infohost.nmt.edu/tcc/help/pubs/python/web/new-new-method.html](http://infohost.nmt.edu/tcc/help/pubs/python/web/new-new-method.html)

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2015-01-26T21:25:19.400

当`__new__`返回同一类的实例时，`__init__`随后在返回的对象上运行。即你不能`__new__`用来防止`__init__`被运行。即使您从 中返回先前创建的对象，它也会被一次又一次地`__new__`初始化为两倍（三倍等） 。`__init__`

这是单例模式的通用方法，它扩展了上面的 vartec 答案并对其进行了修复：

```
def SingletonClass(cls):
    class Single(cls):
        __doc__ = cls.__doc__
        _initialized = False
        _instance = None

        def __new__(cls, *args, **kwargs):
            if not cls._instance:
                cls._instance = super(Single, cls).__new__(cls, *args, **kwargs)
            return cls._instance

        def __init__(self, *args, **kwargs):
            if self._initialized:
                return
            super(Single, self).__init__(*args, **kwargs)
            self.__class__._initialized = True  # Its crucial to set this variable on the class!
    return Single 
```

完整的故事在[这里](http://tech.zarmory.com/2015/01/python-singleton-pattern-generic.html)。

实际上涉及的另一种方法`__new__`是使用类方法：

```
class Singleton(object):
    __initialized = False

    def __new__(cls, *args, **kwargs):
        if not cls.__initialized:
            cls.__init__(*args, **kwargs)
            cls.__initialized = True
        return cls

class MyClass(Singleton):
    @classmethod
    def __init__(cls, x, y):
        print "init is here"

    @classmethod
    def do(cls):
        print "doing stuff" 
```

请注意，使用这种方法，您需要用 装饰所有方法`@classmethod`，因为您永远不会使用`MyClass`.

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2013-07-07T14:45:17.557

我认为这个问题的简单答案是，如果`__new__`返回一个与类相同类型的值，则`__init__`函数执行，否则不会。在这种情况下，您的代码返回*`A._dict('key')`*与 相同的类*`cls`*，因此`__init__`将被执行。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2015-07-30T12:04:51.010

```
class M(type):
    _dict = {}

    def __call__(cls, key):
        if key in cls._dict:
            print 'EXISTS'
            return cls._dict[key]
        else:
            print 'NEW'
            instance = super(M, cls).__call__(key)
            cls._dict[key] = instance
            return instance

class A(object):
    __metaclass__ = M

    def __init__(self, key):
        print 'INIT'
        self.key = key
        print

a1 = A('aaa')
a2 = A('bbb')
a3 = A('aaa') 
```

输出：

```
NEW
INIT

NEW
INIT

EXISTS 
```

注意：由于副作用`M._dict`属性会自动变得可访问，`A`因此`A._dict`请注意不要意外覆盖它。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-09-30T06:13:28.573

[参考此文档](http://www.python.org/download/releases/2.2/descrintro/#__new__)：

> 当继承不可变的内置类型（如数字和字符串）时，有时在其他情况下，静态方法**new**会派上用场。**new**是实例构造的第一步，在**init**之前调用。
> 
> 以类作为第一个参数调用**新方法；**它的职责是返回该类的一个新实例。
> 
> 将此与**init**进行比较：**init**以实例作为其第一个参数调用，它不返回任何内容；它的职责是初始化实例。
> 
> 在某些情况下，在不调用**init**的情况下创建了新实例（例如，从 pickle 加载实例时）。如果不调用**new**就无法创建新实例（尽管在某些情况下，您可以通过调用基类的**new**来逃避）。

关于您希望实现的目标，还有关于 Singleton 模式的相同文档信息

```
class Singleton(object):
        def __new__(cls, *args, **kwds):
            it = cls.__dict__.get("__it__")
            if it is not None:
                return it
            cls.__it__ = it = object.__new__(cls)
            it.init(*args, **kwds)
            return it
        def init(self, *args, **kwds):
            pass 
```

你也可以使用 PEP 318 中的这个实现，使用装饰器

```
def singleton(cls):
    instances = {}
    def getinstance():
        if cls not in instances:
            instances[cls] = cls()
        return instances[cls]
    return getinstance

@singleton
class MyClass:
... 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2017-07-18T19:39:06.347

@AntonyHatchkins 答案的更新，您可能希望元类型的每个类都有一个单独的实例字典，这意味着您应该在元类中有一个`__init__`方法来使用该字典初始化您的类对象，而不是使其在所有类中成为全局对象。

```
class MetaQuasiSingleton(type):
    def __init__(cls, name, bases, attibutes):
        cls._dict = {}

    def __call__(cls, key):
        if key in cls._dict:
            print('EXISTS')
            instance = cls._dict[key]
        else:
            print('NEW')
            instance = super().__call__(key)
            cls._dict[key] = instance
        return instance

class A(metaclass=MetaQuasiSingleton):
    def __init__(self, key):
        print 'INIT'
        self.key = key
        print() 
```

我已经继续使用`__init__`方法更新了原始代码，并将语法更改为 Python 3 表示法（类参数中的无参数调用`super`和元类，而不是作为属性）。

无论哪种方式，这里的重点是您的类初始化程序（`__call__`方法）将不会执行`__new__`或者`__init__`如果找到密钥。这比 using 干净得多`__new__`，如果要跳过默认`__init__`步骤，则需要标记对象。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-03-23T17:23:42.907

__new__ 应该返回一个新的、空白的类实例。然后调用 __init__ 来初始化该实例。你没有在 __new__ 的“新”案例中调用 __init__，所以它是为你调用的。正在调用的代码`__new__`不会跟踪 __init__ 是否已在特定实例上被调用，也不应该跟踪，因为您在这里做了一些非常不寻常的事情。

您可以在 __init__ 函数中为对象添加一个属性，以表明它已被初始化。检查该属性是否存在作为 __init__ 中的第一件事，如果已经存在，则不要继续进行。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-04-24T01:30:44.927

应该将`__init__`其视为传统 OO 语言中的简单构造函数。例如，如果您熟悉 Java 或 C++，则构造函数会隐式传递一个指向其自身实例的指针。在 Java 的情况下，它是`this`变量。如果要检查为 Java 生成的字节码，会注意到两个调用。第一次调用是“new”方法，然后下一次调用是 init 方法（这是对用户定义的构造函数的实际调用）。这两个步骤过程允许在调用类的构造方法之前创建实际实例，该构造方法只是该实例的另一种方法。

现在，在 Python 的情况下，`__new__`是用户可以访问的附加工具。Java 不提供这种灵活性，因为它是类型化的。如果一种语言提供了这种功能，那么`__new__`在返回实例之前，它的实现者可以在该方法中做很多事情，包括在某些情况下创建一个不相关对象的全新实例。而且，这种方法也非常适用于 Python 的不可变类型。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2016-11-15T20:47:55.403

再深入一点！

CPython 中泛型类的类型是`type`，它的基类是`Object`（除非您明确定义另一个基类，如元类）。可以在[此处](https://github.com/python/cpython/blob/master/Objects/typeobject.c#L877)找到低级别调用的顺序。调用的第一个方法是`type_call`then 调用`tp_new`then `tp_init`。

这里有趣的部分是`tp_new`它将调用`Object`的（基类）新方法`object_new`执行一个`tp_alloc`（`PyType_GenericAlloc`）为对象分配内存：）

此时对象在内存中创建，然后`__init__`方法被调用。如果`__init__`没有在你的类中实现，那么`object_init`会被调用并且它什么都不做:)

然后`type_call`只返回绑定到您的变量的对象。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2019-02-11T22:38:05.490

> 但是，我有点困惑为什么`__init__`总是在`__new__`.

我认为 C++ 类比在这里很有用：

1.  `__new__`只是为对象分配内存。对象的实例变量需要内存来保存它，这就是该步骤`__new__`要做的事情。

2.  `__init__`将对象的内部变量初始化为特定值（可以是默认值）。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-06-18T16:30:45.803

`__init__`之后调用，因此`__new__`当您在子类中覆盖它时，您添加的代码仍将被调用。

如果您尝试对已经具有 的类进行子类化，那么`__new__`不知道这一点的人可能会首先调整`__init__`并将调用转发到子类`__init__`。这种调用`__init__`后的约定`__new__`有助于按预期工作。

`__init__`仍然需要允许超类所需的任何参数，`__new__`但不这样做通常会产生明显的运行时错误。并且`__new__`应该明确允许`*args`和'**kw'，以明确扩展是可以的。

`__new__`由于原始海报描述的行为，`__init__`在同一类中具有相同的继承级别通常是不好的形式。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2018-07-25T19:21:33.323

现在我遇到了同样的问题，出于某些原因，我决定避免使用装饰器、工厂和元类。我是这样做的：

### 主文件

```
def _alt(func):
    import functools
    @functools.wraps(func)
    def init(self, *p, **k):
        if hasattr(self, "parent_initialized"):
            return
        else:
            self.parent_initialized = True
            func(self, *p, **k)

    return init

class Parent:
    # Empty dictionary, shouldn't ever be filled with anything else
    parent_cache = {}

    def __new__(cls, n, *args, **kwargs):

        # Checks if object with this ID (n) has been created
        if n in cls.parent_cache:

            # It was, return it
            return cls.parent_cache[n]

        else:

            # Check if it was modified by this function
            if not hasattr(cls, "parent_modified"):
                # Add the attribute
                cls.parent_modified = True
                cls.parent_cache = {}

                # Apply it
                cls.__init__ = _alt(cls.__init__)

            # Get the instance
            obj = super().__new__(cls)

            # Push it to cache
            cls.parent_cache[n] = obj

            # Return it
            return obj 
```

### 示例类

```
class A(Parent):

    def __init__(self, n):
        print("A.__init__", n)

class B(Parent):

    def __init__(self, n):
        print("B.__init__", n) 
```

## 正在使用

```
>>> A(1)
A.__init__ 1  # First A(1) initialized 
<__main__.A object at 0x000001A73A4A2E48>
>>> A(1)      # Returned previous A(1)
<__main__.A object at 0x000001A73A4A2E48>
>>> A(2)
A.__init__ 2  # First A(2) initialized
<__main__.A object at 0x000001A7395D9C88>
>>> B(2)
B.__init__ 2  # B class doesn't collide with A, thanks to separate cache
<__main__.B object at 0x000001A73951B080> 
```

*   **警告：**您不应该初始化 Parent，它*会*与其他类发生冲突 - 除非您在每个孩子中定义单独的缓存，否则这不是我们想要的。
*   **警告：**似乎以父母为祖父母的班级表现得很奇怪。[未验证]

[在线尝试！](https://tio.run/##nZNPSyQxEMXP5lMU4yUtMrDsTfAwriLeZNmbSMikq@1omw5JNbPt4mcfk/QfezLiYQMDQ7rye69eKranujU/9/sSKxCyIV51RhUXDMKKe9po4h6b6hzObPidvYwf49IV1NJLIjeWrKx0aEjEU1o2@g3L1aI@LofUOTNvYePxsCCS1sccuIQ/rsOD0ug1M8fYp0gyzxhTjfQe7hNy0DqFm1dLPZRakW6NdH3aHlWVVDUGvX/vbM5BCIM7Ibhq/DmYoCXdk0@Su/gvNDk7O4VfNaoXH@Npt8@oCHaaaqBae7i7Bm6KGBtsEQ0oh5KwXEYafUPQWS/tLPiDxl2gyuBgapW@SPmI8mAeWRZ9hk3Wowud@PDalrrSIf5tPzQQM4@ZHZyLrluahyGFNM3CRMgHYdDblGXgIsRzetsRHtUsepjNfDELWWl@h5mqtU2fZzYRRBo7IcLp9CKWe0We1y1S8q@NJ2nUoadw@wHiO4uOF@vFCB1h7jtfx8ipheScfddWuMWADfCc8vu7WUj141vY8OE1TGM7TPjQ4vigzOK6rNOG@Gozx7CK32fa1X/RrnLartYNpou9YCf4FxXXxnbEi2K/3/AfxQc "Python 3 – 在线试用")

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-03-23T17:23:37.900

> 但是，我有点困惑为什么`__init__`总是在`__new__`.

除了它只是这样做之外没有太多的原因。`__new__`没有初始化类的责任，其他一些方法可以（`__call__`，可能 - 我不确定）。

> 我没想到会这样。谁能告诉我为什么会发生这种情况以及我如何实现此功能？（除了将实现放入`__new__`感觉很hacky的地方）。

如果它已经被初始化，你可以什么都不做，或者你可以用一个只调用新实例`__init__`的 new 编写一个新的元类，否则只返回.`__call__``__init__``__new__(...)`

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-03-23T13:48:43.893

原因很简单，**new**用于创建实例，而**init**用于初始化实例。在初始化之前，应该先创建实例。这就是为什么**new**应该在**init**之前调用。

# asp.net - Telerik RadGrid - 我如何默认为编辑模式？

> ID：674307
> 
> 赞同：7
> 
> 时间：2009-03-23T17:13:18.160
> 
> 标签：asp.net, gridview, telerik, radgrid

我想让我的 RadGrid 的项目在页面加载时可编辑。我在这里尝试了这两种方法[http://www.telerik.com/help/aspnet/grid/grddefaulteditmodeforgriditemsoninitialload.html](http://www.telerik.com/help/aspnet/grid/grddefaulteditmodeforgriditemsoninitialload.html) 但都没有任何效果。

例如第二种方法，如下所示，在 ItemCreated 事件上设置了 Edit 属性，导致 Edit 模式设置为 true（由调试器验证），但它对显示页面时的结果没有影响。

有人知道我做错了什么吗？

```
protected void RadGrid1_ItemCreated(object sender, Telerik.WebControls.GridItemEventArgs e)
{
    if (!Page.IsPostBack && e.Item is GridEditableItem)
   {
       e.Item.Edit = true;
   }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-24T11:25:35.740

这有效：

```
for (int i = 0; i < RadGrid1.PageSize; i++)
{
    RadGrid1.EditIndexes.Add(i);
    RadGrid1.Rebind();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-18T18:21:57.377

这也有效：

```
protected void RadGrid1_ItemDataBound(object sender, GridItemEventArgs e)
{
    e.Item.Edit = true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T03:29:20.573

如果您想按照上述方式进行操作，但对于子表，可以使用下面的代码：

```
protected void RadGrid1_PreRender(object sender, EventArgs e)  
{  
    foreach (GridDataItem item in RadGrid1.MasterTableView.Items)  
    {  
        if (item.HasChildItems)  
        {  
            GridTableView childTable = (GridTableView)item.ChildItem.NestedTableViews[0];  

            foreach (GridDataItem childitem in childTable.Items)  
            {  

               //Check for the newly inserted row 
               //and set in edit mode 
               //childitem.Edit=true; 
            }  
        }  
    }  
    RadGrid1.MasterTableView.Rebind();  
} 
```

# sitecore - 创建指向 Sitecore 项目的链接

> ID：674308
> 
> 赞同：23
> 
> 时间：2009-03-23T17:13:19.563
> 
> 标签：sitecore, sitecore6

我知道我以前做过，但我似乎不记得在哪里或如何做。

我想在 Sitecore 中创建一个项目的链接。这段代码：

```
Sitecore.Data.Items.Item itm = Sitecore.Context.Database.GetItem(someID);
return itm.Paths.Path.ToString(); 
```

产生以下字符串：

```
http://localhost/sitecore/content/Home/Item1/Item11/thisItem 
```

我想改用这个字符串：

```
http://localhost/Item1/Item11/thisItem.aspx 
```

获取项目路径的正确方法是什么？在这种情况下，我不能使用普通的 Sitecore 链接：

```
Sitecore.Web.UI.WebControls.Link 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-23T20:30:52.380

您需要这个，假设您正在运行 Sitecore v6 或任何更新版本（使用 8.2-6 测试，也应该使用 9）：

```
Sitecore.Links.LinkManager.GetItemUrl(item); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-07-31T02:49:26.147

如果您仍在使用 Sitecore 5.3，则可以使用它。请注意，此方法在 Sitecore 6.0 中已弃用。

```
string url = item.Paths.GetFriendlyUrl(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T01:42:21.543

您的网络控制：

```
<asp:HyperLink ID="HyperLinkItem" runat="server">
    Item
</asp:HyperLink> 
```

您的代码：

```
var homeItem = Sitecore.Context.Database.GetItem("/sitecore/content/Home");
HyperLinkItem.NavigateUrl = Sitecore.Links.LinkManager.GetItemUrl(homeItem); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-23T15:46:41.957

您可以如下呈现项目链接：

```
Sitecore.Data.Items.Item itm = Sitecore.Context.Database.GetItem(someID);
return Sitecore.Links.LinkManager.GetItemUrl(itm); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-29T15:51:10.697

试试这个

```
 <asp:HyperLink ID="hlItem" runat="server">

    </asp:HyperLink> 
```

aspx.cs

```
 Sitecore.Data.Items.Item itm = Sitecore.Context.Database.GetItem("/sitecore/content/Home");

    hlItem.Navigateurl =sitecore.links.linkmanager.getitemurl(itm); 
```

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2012-08-09T17:59:58.800

你也可以这样做：

```
Item.Paths.FullPath 
```

它与以下内容相同：

```
Sitecore.Links.LinkManager.GetItemUrl(item); 
```

# .net - 程序集和 DLL 之间的区别

> ID：674312
> 
> 赞同：43
> 
> 时间：2009-03-23T17:14:11.980
> 
> 标签：.net, assemblies

程序集和 DLL 有什么区别？将代码发送到远程客户端时，应该发送一个 DLL 文件还是应该发送一个程序集（当两个之间有直接 TCP 连接时）？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-03-23T17:35:45.140

程序集是 .NET 的“最小部署单元”。通常一个程序集对应一个文件，但它不是必须的——你可以有多个文件，其中一个是知道所有其他位在哪里的主文件。

单文件程序集通常是 DLL 或 EXE 文件。如果您有一个普通的类库，并且只想将其发送到另一端，那么 DLL 就是您想要的。当您遇到更复杂的情况时，我只会担心它们:)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-23T17:17:05.763

好吧，.NET dll 是一个程序集，但 .NET exe 也可以是程序集，这意味着所有 .NET dll 都是程序集，但反之则不然。

您不应该将实际代码发送给客户端。相反，您应该在两端（客户端和服务器）都有类型定义，并在两者之间发送序列化*实例*。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-26T05:52:36.880

程序集基本上是一个包含 MSIL 代码和元数据的文件。它是 .NET 应用程序的最小部署单元。.NET 中的程序集有 2 个扩展名（.exe 和 .dll）

dll：动态链接库。所以，我们可以说一个 dll 是一个程序集，但一个程序集可能并不总是一个 dll

换句话说，dll 是一种程序集

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-03-23T20:44:02.307

程序集是包含已编译代码的文件。有两种组件。当你编译你的 C# 程序时，你正在创建一个程序集。可执行文件（有时称为“进程程序集”）具有 EXE 文件扩展名。我们书中的所有程序都编译为可执行文件。这些是您可以执行的程序集；要知道，EXE文件是可以双击运行的。还有一些库程序集，它们具有 DLL 文件扩展名。**DLL 代表动态链接库**。它们通常被称为类库，因为它们包含您可以在程序中使用的类。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-09-01T18:04:39.373

1.  dll项目独立。

2.  装配是项目特定的。

3.  程序集是一个或多个文件的集合，其中一个是 DLL 或 EXE。

4.  DLL 包含任何在 Windows 上运行的程序都可以使用的库代码。DLL 可能包含结构化或面向对象的库。

5.  一个 DLL 文件可以有几乎无限的可能入口点。

6.  bin 中存在的程序集可以具有强/弱名称，而 GAC 中的程序集应该具有强名称。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T17:28:40.290

程序集是将传递到 .net JIT 运行时的预编译代码。

它是一种独立于机器的代码格式，可以由任何 .net 命令语言运行时运行。

DLL 和 EXE 是程序集的常用格式。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-06T05:40:12.707

.Exe 1.这些是出站文件。2.每个应用程序只存在一个.exe 文件。3\. .exe不能与其他应用程序共享。

.dll 1.这些是入站文件。2.许多.dll文件可能存在于一个应用程序中。3\. .dll 可以与其他应用程序共享。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-04T12:55:05.107

这个问题似乎无效。.dll 和 .exe 都是程序集。这只是装配的延伸。两者都可以包含 MSIL 代码，但 .exe 具有单一入口点，即 Main 函数。但是.dll 可以有很多入口点。

程序集是最小的部署单元，可以是 dll 或 exe。此程序集有静态和动态两种类型。我们是另一种类型的静态程序集，即包含资源（图像、资源文件等）的卫星程序集。您可以通过在 GAC 中注册来为程序集使用强名称，以使其可供全球使用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-23T17:17:21.770

好吧，“程序集”是用于 .NET 资源的术语。这不一定是 DLL。DLL 可以是 .NET 资源，但也可以是“本机”资源。程序集可以打包在 DLL 或 EXE 中。它仅取决于特定的组件。

如果这与您的其他问题一样，您需要发送包含程序集的文件。你也许可以做一些更复杂的事情，但就是这样。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-13T01:55:23.167

从 .NET 项目构建的任何 DLL 都是程序集，就像可执行文件一样。程序集不仅包含在公共语言运行时下运行的 CLI 代码，它们还包含有关程序集中代码的类和结构的完整信息。

本机 DLL 的不同之处在于它几乎不包含关于 DLL 中包含的代码和资源的任何元信息。本机可执行文件几乎与 DLL 相同。

程序集非常棒，因为它们的模块化和内置的 API 元数据。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-07T06:00:52.590

程序集可以组织到单个文件中，其中所有这些信息都合并到单个动态链接库 (DLL) 文件或可执行 (EXE) 文件中，也可以将信息合并到单独的 DLL 文件中的多个文件中，程序集的主要功能是形成类型、引用和安全性的边界。组件的另一个重要功能是形成一个单元进行部署。

默认情况下，在创建程序集时，将其标记为私有。如果程序集必须在多个客户端程序集之间共享，则将其放置在 GAC，一个特殊的 Windows 文件夹中。要将私有程序集转换为共享程序集，必须运行实用程序来创建加密密钥，并且必须使用密钥对程序集进行签名。签署程序集后，您必须使用另一个实用程序将共享程序集添加到 GAC。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-04-15T04:29:30.140

程序集和dll的区别有点像飓风和台风的区别。这取决于它发生在哪个海洋。

A dll or exe in .NET world is called assemblies. That in the native Windows system are simply called dll or exe.

One other notable difference is that assembly can be dll or executable. Where as in native windows system, we generally think of dll and executable as two different type of items.

# asp.net - DropdownList 在加载时重置为索引 0

> ID：674315
> 
> 赞同：5
> 
> 时间：2009-03-23T17:14:54.350
> 
> 标签：asp.net, drop-down-menu, reload

每次在 Firefox 中“重新加载”页面（按下 F5）时，我如何将我的`asp:DropDownList`元素（具有）重置为索引 0？`runat="server"`

如果您建议使用 JavaScript，请注意

*   我没有使用表格
*   我不知道如何访问`runat="server"`带有 JavaScript的元素

如果这可以使用`.aspx`页面上的脚本完成，请解释。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-23T17:20:43.180

将代码放入[Page_Load](http://msdn.microsoft.com/en-us/library/ms178472.aspx)事件中以执行此操作

```
protected void Page_Load(object sender, EventArgs e)
{    
    myDropDownList.SelectedIndex =0;
} 
```

**编辑：**

作为对您的评论的回应，如果您已将上述逻辑放在 if 语句中以检查是否`Page.IsPostback = false`，则所选索引将不会在刷新时设置回 0 （执行客户端回发）。作为演示这一点的示例，这里有一个下拉列表设置为在选择时自动回发的页面

```
<%@ Page Language="C#" AutoEventWireup="true"  CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>My Example</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:DropDownList ID="ddl" runat="server" AutoPostBack="true" >
        </asp:DropDownList>
    </div>
    </form>
</body>
</html> 
```

这是后面的代码

```
public partial class _Default : System.Web.UI.Page 
{
    protected void Page_Init(object sender, EventArgs e)
    {
        //Apologies for Dairy Produce inspired list
        ddl.Items.Add(new ListItem("Cheese"));
        ddl.Items.Add(new ListItem("Yoghurt"));
        ddl.Items.Add(new ListItem("Milk"));
        ddl.Items.Add(new ListItem("Butter"));
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        //Run the Page with this in first, then comment out
        //the if statement to leave only ddl.SelectedIndex = 0;

        if (!Page.IsPostBack)
        {
            ddl.SelectedIndex = 0;
        }
    }
} 
```

正如将要演示的，当页面最初运行时，刷新时，选定的索引将保留在下拉列表中；但是，当`if`语句被注释掉时，在刷新时，选定的索引设置为 0（在本例中为*Cheese*）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-06T12:02:55.443

stop Firefox from retaining the viewstate and repopulating the form:

```
 protected void Page_Load(object sender, EventArgs e)
    {
        if (Request.Browser.Browser == "Firefox")
            Form.Attributes.Add("autocomplete", "off");
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T17:22:01.633

只需将此代码添加到您的 Page_Load 事件中：

```
if (myDropDown.Items.Count > 0)
{
    myDropDown.Items[myDropDown.SelectedIndex].Selected = false;
    myDropDown.Items[0].Selected = true;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-17T04:51:18.650

在代码 HTML 下的脚本中：

```
B01 = document.getElementById('<%=me.yourID.clientid %>');
B01.selectedIndex = 0; 
```

快乐编码^^

# c# - 异常与特殊返回值

> ID：674317
> 
> 赞同：8
> 
> 时间：2009-03-23T17:14:56.313
> 
> 标签：c#, .net, exception

哪一个是更好的编程实践？

我不是在谈论完全的排他性。更多的是：

`list<T>.Find`，您在哪里获得`default(T)`或您的价值，而不是`ValueNotFound`异常（示例）。

或者

`list<T>.IndexOf`, 你得到 -1 或正确的索引。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-23T17:20:14.303

好吧，答案是视情况而定。

如果在列表中找不到某个项目，则抛出异常是一种可怕的做法，因为该项目可能不在列表中是完全可行的。

现在，如果这是某种专门的列表，并且**绝对**应该在列表中找到该项目，那么应该抛出异常，因为您遇到了不可行/不合理的情况。

一般来说，对于诸如业务规则之类的事情，专门的错误代码会更好，因为您知道这些事情发生的可能性，并希望对这些可能性做出反应。异常适用于您不期望的情况，如果发生则无法继续执行代码。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-23T18:05:18.877

我在某个地方读到了一条我非常喜欢的关于这个的很好的规则。它说 - “当且仅当它不能执行它应该执行的任务时，一个函数才应该抛出异常”。

所以我通常做的是决定一个函数应该做什么（通常来自业务需求或其他东西），然后为其他一切抛出异常。

如果您的应用程序设计得很好，那么您的函数将非常小，并且执行相对简单的任务并具有简单的返回值。根据上述规则确定例外情况并不困难。

当然，总是有模棱两可的情况（比如在字典中找不到键）。这些应该是相距甚远的，但在那里你只需要使用你的直觉来了解更优雅的解决方案。

哦，还有这一切永远不要忘记：为了让它工作得很好，只能捕获你可以处理的异常。大多数情况下，这意味着您只能在较高的 UI 级别中捕获它们，您可以在其中向用户显示并记录它们或其他东西。较低级别可能会`finally`在自己的一些处理之后使用块或重新抛出异常，但在低级别中真正捕获的异常通常表明设计不佳。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-23T17:28:54.190

经验法则是仅在“不应该发生”的事情发生时才使用例外。

如果您期望对 IndexOf() 的调用可能找不到有问题的值（合理的期望），那么它应该有一个返回码（如您所说，可能是 -1）。一些不应该失败的事情，比如分配内存，应该在失败的情况下抛出异常。

要记住的另一件事是处理异常在性能方面是“昂贵的”。因此，如果您的代码定期将异常处理为正常操作的一部分，那么它的执行速度将不会尽可能快。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-23T17:20:40.153

在您提到的情况下，我更喜欢返回值，因为我知道该怎么做。并且没有理由在同一范围内为 catch 烦恼。

当然，如果您的逻辑是以值始终应在列表中的方式构建的，并且它们的缺失是程序员逻辑错误 - 例外是方式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T18:22:52.143

您更愿意使用哪个？

A：

```
item = list.Find(x); 
```

乙：

```
If (list.Contains(x))
    item = list.Find(x);
else
    item = null; 
```

C：

```
try {
   item = list.Find(x);
}
catch {
     item = null;
} 
```

我愿意打赌答案是 A。因此，在这种情况下，返回 Default(T) 是正确的选择。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T17:39:07.927

您可能会喜欢我的由两部分组成的博客系列，其中讨论了很多权衡，具体取决于您的编程语言支持的功能，因为它似乎非常相关：

[语言特性和库设计之间相互作用的一个例子，第一部分](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!180.entry)

[语言特性和库设计之间相互作用的一个例子，第二部分](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!181.entry)

我要补充一点，我认为这个问题的很多答案都很糟糕（我对我的许多同伙投了反对票）。尤其糟糕的是 API

```
if (ItWillSucceed(...)) {
    DoIt(...)
} 
```

这会产生各种不愉快的问题（有关详细信息，请参阅我的博客）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T19:15:15.167

更好的语言可以让你做任何适合你需要的事情。就像在 Smalltalk-80 中一样：

如果 id 没有用户，以下将引发异常：

```
user := userDictionary at: id 
```

这将评估给定的 Block 这是一个高级功能：

```
user := userDictionary at: id ifAbsent: [
    "no such id, let's return the user named Anonymous"
    users detect: [ :each | each name = 'Anonymous' ] ] 
```

请注意，实际的方法是在：ifAbsent:。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T17:50:57.087

正如与编程相关的许多问题一样，这一切都取决于......

我发现确实应该首先尝试定义您的 API，这样一开始就不会发生异常情况。

使用按合同设计可以帮助做到这一点。在这里可以插入引发错误或崩溃并指示编程错误（不是用户错误）的函数。（在某些情况下，这些检查在发布模式下会被删除。）

然后让您避免无法避免的一般故障异常，例如数据库连接失败、乐观事务失败、磁盘写入失败。

这些异常通常不需要被捕获，直到它们到达“用户”。并且会导致用户需要重试。

如果错误是用户错误，例如名称中的拼写错误或其他内容，则直接在应用程序接口代码本身中处理。由于这是一个常见错误，因此需要使用可能翻译的用户友好错误消息等来处理。

应用程序分层在这里也很有用。因此，让我们以将现金从一个帐户转移到另一个帐户为例：

```
transferInternal( int account_id_1, int account_id_2, double amount )
{
   // This is an internal function we require the client to provide us with
   // valid arguments only. (No error handling done here.)
   REQUIRE( accountExists( account_id_1 ) ); // Design by contract argument checks.
   REQUIRE( accountExists( account_id_2 ) );
   REQUIRE( balance( account_id_1 ) > amount );
   ... do the actual transfer work
}

string transfer( int account_id_1, int account_id_2, double amount )
{
   DB.start(); // start transaction
   string msg;
   if ( !checkAccount( account_id_1, msg ) ) return msg; // common checking code used from multiple operations.
   if ( !checkAccount( account_id_2, msg ) ) return msg;
   if ( !checkBalance( account_id_1, amount ) ) return msg;
   transferInternal( account_id_1, account_id_2, amount );
   DB.commit(); // This could fail with an exception if someone else changed the balance while this transaction was active. (Very unlikely but possible)
   return "cash transfer ok";
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T17:21:04.863

来自 Java 背景，在大多数情况下我更喜欢异常。当一半的代码不用于检查返回值时，它会使您的代码更加简洁。

也就是说，它还取决于某事可能导致“失败”的频率。异常可能代价高昂，因此您不想为了经常失败的事情而不必要地扔掉它们。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-03-23T17:23:19.163

Bill Wagner 的《更有效的 C#》就异常问题提出了极好的建议。想法是在执行操作时继续抛出异常，只需确保提供挂钩以检查值是否会抛出异常。

例如

```
// if this throws an exception
list.GetByName("Frank") // throws NotFound exception
// provide a method to test 
list.TryGetByName("Frank")  // returns false 
```

这样你就可以通过编写类似的东西来选择退出异常

```
MyItem item;
if (list.TryGetByName("Frank"))
  item = list.GetByName("Frank"); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-24T00:57:38.450

在这种情况下，我通常做的是定义一个 Option 类（受 F# 启发）并使用返回 Option 类的 TryFind() 方法扩展 IEnumerable。

```
public class Option<T>
{
    string _msg = "";
    T _item;

    public bool IsNone
    {
        get { return _msg != "" ? true : false; }
    }

    public string Msg
    {
        get { return _msg; }
    }

    internal Option(T item)
    {
        this._item = item;
        this._msg = "";
    }

    internal Option(string msg)
    {
        if (String.IsNullOrEmpty(msg))
            throw new ArgumentNullException("msg");

        this._msg = msg;
    }

    internal T Get()
    {
        if (this.IsNone)
            throw new Exception("Cannot call Get on a NONE instance.");

        return this._item;
    }

    public override string ToString()
    {
        if (this.IsNone)
            return String.Format("IsNone : {0}, {1}", this.IsNone, typeof(T).Name);

        else 
            return String.Format("IsNone : {0}, {1}, {2}", this.IsNone, typeof(T).Name, this._item.ToString());
    } 
```

}

然后您可以将其用作

```
var optionItem = list.TryFind(x => trueorFalseTest() );
if (!optionItem.IsNone)
   var myItem = optionItem.Get(); 
```

这样，无论项目是否存在，集合都只遍历一次。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-03-23T17:20:19.953

从纯粹的设计角度来看，我更喜欢在发生“异常”事情时抛出异常，例如找不到您要求的密钥。主要原因是它使消费者的生活更轻松 - 他们不必在每次调用您的函数后检查值。我也喜欢 TrySomething 功能，因为这样用户可以显式测试操作是否成功。

不幸的是，.Net 中的异常非常昂贵（根据我的经验，抛出一个异常通常需要大约 50 毫秒），因此从实际角度来看，您可能希望返回这些默认值之一而不是抛出异常，尤其是在 GUI 编程中。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-23T17:20:20.700

我认为这有点情境性，但更多地取决于返回事件是否在逻辑上实际上是一个例外。indexOf 示例是一个完全正常的输出响应，其中 -1 是唯一有意义的（或 null 用于 ref 类型）。

异常应该是：异常，这意味着您想要从真正的异常中获得的所有堆栈跟踪和处理。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-03-23T22:17:39.877

首先，我不太喜欢这个`default(T)`选项：如果你有一个`int`列表，其中`0`（大概这是`int`' 的默认值；我不使用 C#）是一个完全允许的值？

（为 Java 语法道歉，但如果我试图猜测 C#，我可能会在某处弄得一团糟:)）

```
class Maybe<T> {
    public Maybe() {
        set = false;
        value = null;
    }

    public Maybe(T value) {
        set = true;
        this.value = value;
    }

    public T get(T defaultVal) {
        if (set)
            return value;
        return defaultVal;
    }

    private boolean set;
    private T value;
} 
```

然后当然`Find`会返回 a ，并且调用者*在这个 context 中*`Maybe<T>`选择一个合理的默认值。当然，也许您可​​以添加一个方便的方法来判断何时*是*正确答案。*`getDefault``default(T)`*

 **不过，对于 来说`IndexOf`，这`-1`是一个合理的值，因为有效值显然总是 >= 0，所以我就这样做。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-03-23T17:22:07.983

异常应该是“异常”的东西。因此，如果您调用 Find，并且您希望找到某些东西，无论如何，如果您没有找到某些东西，则抛出异常是好的行为。

但是，如果它是正常流程，您有时找不到某些东西，那么抛出异常是不好的。

# c# - 如何在 F# 中编写一个采用可变数量参数的函数

> ID：674319
> 
> 赞同：33
> 
> 时间：2009-03-23T17:15:14.927
> 
> 标签：c#, f#

我在 C# 中有一个函数，我想将它（以及其他一些东西）移植到 F#，只是为了这样做。不幸的是，我刚刚遇到了一个在 F# 中似乎无法表达的案例：Take this C# function

```
public static T Min<T>(params T[] p) where T : IComparable
{
    T m1 = p[0];

    foreach (T v in p)
    {
        m1 = (m1.CompareTo(v) < 0) ? m1 : v;
    }

    return m1;
} 
```

我认为这很容易，但我不明白如何在 F# 中指定变量参数列表。我试过这个：

```
let rec Min l =
    match l with
    | [] -> 0 // should throw exception here
    | [v] -> v
    | (h::t) -> min h (Min t) 
```

但从 C# 调用它需要一个`Microsoft.FSharp.Collections.List`. 是否有可能得到它期望 a `params T[]`，如果是这样，如何？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-03-23T17:35:11.257

正如 Jon 所说，params 数组只是一个带有属性的数组。在参数前添加属性。

```
let test ([<ParamArray>] arr : 'a array) = 
    if arr.Length = 0 then invalid_arg "arr"
    // .... 
```

您无需指定类型：

```
let test ([<ParamArray>] arr) = ... // lets type inference do its thing 
```

但是......模式匹配不适用于数组类型。您可以编写一个主动模式来提供帮助。基本上，您必须决定哪个更重要：F# 代码还是 C# 代码。当您设计高阶函数、使用元组、使用可区分联合等时，同样的权衡也将适用。C# 无法表达大多数东西，而 F# 目前不支持 C# 的一些糖分（Expression Tree writing in例如编译器）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-23T17:22:43.737

您想从 F# 或 C# 调用此方法吗？[这篇 hubFS 帖子](http://cs.hubfs.net/forums/thread/8972.aspx)似乎表明 F# 不支持调用端的参数数组，但我怀疑如果您对参数使用普通类型注释使其成为数组，并用[ParamArrayAttribute](http://msdn.microsoft.com/en-us/library/system.paramarrayattribute.aspx)进行装饰，您应该能够使用 C# 中的可变参数调用它。

不能说我已经看到如何在 F# 中使用属性来装饰参数，但如果你愿意，我可以四处寻找……[这篇博](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!161.entry)文提供了几个示例，但不是在参数级别。

# c# - 数据集字段名称中的句点 (.) - 无法绑定到中继器

> ID：674336
> 
> 赞同：0
> 
> 时间：2009-03-23T17:18:39.817
> 
> 标签：c#, asp.net

我有一个绑定到中继器的数据集。数据集`GetXML()`如下所示：

```
<NewDataSet>
 <Table1>
   <Company.Date>03/22/2009</Company.Date>
  </Table1>
</NewDataSet> 
```

aspx 看起来像这样：

```
<%# DataBinder.Eval(Container.DataItem, "Company.Date")%> 
```

当我绑定它时，我收到错误：

```
System.Data.DataRowView' does not contain a property with the name 'Company'. 
```

它似乎不喜欢这个时期。有没有办法在不改变命名约定的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:22:44.517

使用[`DataBinder.GetPropertyValue(Object, String)`](http://msdn.microsoft.com/en-us/library/system.web.ui.databinder.getpropertyvalue.aspx)，它不会评估字符串，而是以确切的形式使用它来获取值。

[来源](http://www.victorchen.info/period-or-dot-in-column-name-error-in-c/)

# javascript - 如何支持跨浏览器的多个文本选择？

> ID：674355
> 
> 赞同：8
> 
> 时间：2009-03-23T17:21:49.853
> 
> 标签：javascript, html, safari, getselection

我正在构建一个基于 Web 的注释工具，最终用户可以在其中从 HTML 文档中选择和注释一段文本。从编程上讲，使用“window.getSelection”和“getRangeAt”可以直接访问和使用选定的文本和相应的范围。

但是，当我尝试将所有这些放在一个跨浏览器应用程序中时，我遇到了一个问题。在 Firefox 中一切正常，但在 Safari 中，我立即注意到，当我单击 HTML 按钮（即“注释”按钮）时，当前用户文本选择消失，好像单击按钮重新定位了文本插入符号。我尝试访问 window.getSelection 的代码从该按钮中的脚本执行，然后报告不存在任何选择。

我深入研究了谷歌文档，特别是他们的文字处理应用程序是如何处理这个问题的，因为本质上选择文本和单击“粗体”或“更改字体”的行为和机制对应于我的注释功能。在 Google Docs 中，他们将要编辑的文档文本加载到 iframe 中。通过玩这个，我了解到 Firefox 开箱即用支持在包含多个框架或 iframe 的网页中进行多个选择范围。换句话说，我可以在基本页面中选择一段文本，并在 iframe 中选择一段单独的文本，而第一个选择不会消失。这个 Google Docs 解决方案适用于 Firefox 和 Safari（我感兴趣的两种浏览器）。但是当我构建一个简单的示例页面来测试这个解决方案时，它在 Safari 中不起作用。

任何人都知道我在这里缺少什么才能使其正常工作吗？或者有另一种方法来让它工作的建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-31T13:08:42.020

将您的事件处理程序连接到按钮的 mousedown 事件（而不是 click 或 mouseup 事件）。这将允许您在清除当前选择之前获取它。

您可以通过将选择存储在变量中并仅在您的按钮收到点击事件时使用它来维护用户体验。像这样：

```
<button onmousedown="sel = window.getSelection()" onclick="alert(sel)">What's the selection?</button> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-03T01:10:27.427

在我的脑海中，我认为您最简单的解决方案是将事件处理程序附加到文本选择并将当前选择保存到缓冲区，这样您就不必担心时间问题。

在此页面上打开 firebug 并运行以下代码段：

```
var buffer = '';
$('p').mouseup(function() {
    buffer = window.getSelection();
}); 
```

然后，您可以选择所需的任何内容并通过运行查看最后选择的文本：

```
console.log(buffer); 
```

瞧，单击/取消选择时间问题已解决:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T20:01:13.263

> 我了解到 Firefox 开箱即用支持包含多个框架的网页中的多个选择范围

见鬼，Firefox 甚至支持单帧多选！（尝试单击并拖动，然后按住 ctrl 单击并拖动单独的一段文本。）

> 在 Safari 中，我立即注意到，当我单击 HTML 按钮时，当前用户文本选择消失了，好像单击按钮重新定位了文本插入符号

在 Windows 上的 Safari 3.2.1 中为我工作。单击 <button>、<input type="button"> 或 <a> 会将选择保留在原来的位置，尽管如果它在不同的框架中则显示为灰色。'window.getSelection()' 继续照常工作。

你能发布一个测试用例，哪个 Safari 版本让它行为不端？

# postgresql - 如何在运行时更改 Crystal Report 的 ODBC 数据库连接？

> ID：674363
> 
> 赞同：10
> 
> 时间：2009-03-23T17:22:21.820
> 
> 标签：postgresql, crystal-reports, odbc, database-connection

我有一个使用 Crystal Reports 2008 制作的报告，我需要部署一个生产系统，这意味着我需要能够在运行时更改数据库连接。数据库是 PostgreSQL 8.3.0，我用于创建初始报告的连接是 ODBC 连接。

我找到了各种更改数据库连接的方法，包括：

```
reportDoc.Load(report);
reportDoc.DataSourceConnections[0].SetConnection("server", "database", "user", "pwd");
reportDoc.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, path); 
```

但是，这总是失败并显示以下错误消息。

> 无法打开连接。

我已经通过使用 pgAdmin III 成功连接到数据库来验证连接参数，所以我知道连接参数是正确的。此外，如果我删除 SetConnection(...) 行，则代码如下所示：

```
reportDoc.Load(report);
reportDoc.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, path); 
```

然后使用存储在报告中的连接参数，报告运行良好。此方法是否可能不适用于 ODBC 连接？

如何在运行时更改 Crystal Report 的 ODBC 数据库连接？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-23T19:12:57.170

经过**更多的**研究，我发现有一个两部分的答案。

## 第1部分

如果您使用数据所有者通过 ODBC 连接到 PostgreSQL（Crystal Reports 在撰写本文时可以从 PostgreSQL 中提取数据的唯一方式），那么您可以使用以下代码：

```
reportDoc.Load(report);
reportDoc.DataSourceConnections[0].SetConnection("Driver={PostgreSQL ANSI};Server=myServer;Port=5432;", "myDatabase", "myUser", "myPassword");
reportDoc.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, path);
// Depending on your application you may have more than one data source connection that needs to be changed. 
```

此方法仅在您以拥有所报告数据的用户身份连接时才有效，因为不需要提供架构名称。

## 第2部分

如果您使用数据所有者以外的用户通过 ODBC 连接到 PostgreSQL，那么您需要手动提供模式名称。这是通过以下代码完成的。

```
reportDoc.Load(report);

ConnectionInfo connInfo = new ConnectionInfo();
connInfo.ServerName = "Driver={PostgreSQL ANSI};Server=myServer;Port=5432;";
connInfo.DatabaseName = "myDatabase";
connInfo.UserID = "myUser";
connInfo.Password = "myPassword";

TableLogOnInfo tableLogOnInfo = new TableLogOnInfo();
tableLogOnInfo.ConnectionInfo = connInfo;

foreach (Table table in reportDoc.Database.Tables)
{
    table.ApplyLogOnInfo(tableLogOnInfo);
    table.LogOnInfo.ConnectionInfo.ServerName = connInfo.ServerName;
    table.LogOnInfo.ConnectionInfo.DatabaseName = connInfo.DatabaseName;
    table.LogOnInfo.ConnectionInfo.UserID = connInfo.UserID;
    table.LogOnInfo.ConnectionInfo.Password = connInfo.Password;

    // Apply the schema name to the table's location
    table.Location = "mySchema." + table.Location;
}

reportDoc.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, path); 
```

## 概括

尝试从 Crystal Reports 连接到 PostgreSQL 数据库时，这里有两个关键信息。

1.  驱动程序、服务器和端口号都必须在服务器名称属性中指定。
2.  如果以数据所有者以外的用户身份连接，则必须为要从中提取数据的每个表指定架构名称。

## 来源

使用的几个来源没有在我的特定情况下有效的答案，但引导我朝着正确的方向前进。下面列出了这些来源。

*   [内森·库普的回答](https://stackoverflow.com/questions/674363/how-do-i-change-a-crystal-reports-odbc-database-connection-at-runtime/674433#674433)
*   [https://www.sdn.sap.com/irj/scn/thread?messageID=6913827#6913827](https://www.sdn.sap.com/irj/scn/thread?messageID=6913827#6913827)
*   [在运行时更改数据库的最佳实践](https://www.sdn.sap.com/irj/scn/go/portal/prtroot/docs/library/uuid/f0898a68-7164-2b10-40b2-e537b0499ebc)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T17:37:06.510

我刚刚经历了同样的磨难。

我这样设置我的连接（其中 sDataSource 等......是带有信息的字符串）

```
 Dim myConnectionInfo As ConnectionInfo = New ConnectionInfo()
    myConnectionInfo.ServerName = sDataSource
    myConnectionInfo.DatabaseName = sInitialCatalog
    myConnectionInfo.UserID = sUserID
    myConnectionInfo.Password = sPassword

    Dim myTables As Tables = report.Database.Tables
    Dim myTableLogonInfo As TableLogOnInfo = New TableLogOnInfo()
    myTableLogonInfo.ConnectionInfo = myConnectionInfo
    For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In myTables
        myTable.ApplyLogOnInfo(myTableLogonInfo)

        myTable.LogOnInfo.ConnectionInfo.DatabaseName = myTableLogonInfo.ConnectionInfo.DatabaseName
        myTable.LogOnInfo.ConnectionInfo.ServerName = myTableLogonInfo.ConnectionInfo.ServerName
        myTable.LogOnInfo.ConnectionInfo.UserID = myTableLogonInfo.ConnectionInfo.UserID
        myTable.LogOnInfo.ConnectionInfo.Password = myTableLogonInfo.ConnectionInfo.Password

    Next 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-12-28T19:06:13.450

首先感谢您提供这些信息！！！

我正在使用 MySQL/C#/Crystal 报告。在设置了 ODBC/DSN 之后，像这样简单的东西对我有用。

```
using CrystalDecisions.CrystalReports.Engine;

using CrystalDecisions.Shared;

using MySql.Data.MySqlClient;

.
.
.

ConnectionInfo connInfo = new ConnectionInfo();

connInfo.ServerName = "Driver={MySQL ODBC 3.51 Driver};DSN=MyODBCDatasourceName";

TableLogOnInfo tableLogOnInfo = new TableLogOnInfo();

tableLogOnInfo.ConnectionInfo = connInfo;

// rpt is my Crystal Reports ReportDocument

// Apply the schema name to the table's location

foreach (Table table in rpt.Database.Tables)

{

    table.ApplyLogOnInfo(tableLogOnInfo);

    table.Location = table.Location;

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-01-07T16:40:00.350

在水晶报表文件中更新 ODBC。

我们将 ODBC 与 MSSQL 一起使用，我们找不到如何在 C 语言项目的水晶文件中更新 ODBC。

通过此处提供的示例，我们能够找到在 MSSQL 中更新 ODBC 的方法，就像这样简单：

```
 Cursor.Current = Cursors.WaitCursor;

        CrystalDecisions.Windows.Forms.CrystalReportViewer CR_Viewer;
        CR_Viewer = new CrystalDecisions.Windows.Forms.CrystalReportViewer();
        this.Controls.Add(CR_Viewer);

        ConnectionInfo connInfo = new ConnectionInfo();
        connInfo.ServerName = "YOUR ODBC NAME"; 

        TableLogOnInfo tableLogOnInfo = new TableLogOnInfo();
        tableLogOnInfo.ConnectionInfo = connInfo;

         //THIS IS A CRYSTAL RPT FILE DIFINE AS A CLASS
        Facturation_Nord_Ouest.Reports.Facture_Français CrystalReportFr;

       CrystalReportFr = new Facturation_Nord_Ouest.Reports.Facture_Français();

            for (int i = 0; i < CrystalReportFr.Database.Tables.Count; i++)
            {
                CrystalReportFr.Database.Tables[i].ApplyLogOnInfo(tableLogOnInfo);
            }
            CR_Viewer.ReportSource = CrystalReportFr;

        CR_Viewer.ActiveViewIndex = 0;
        CR_Viewer.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
        CR_Viewer.Dock = System.Windows.Forms.DockStyle.Fill;
        CR_Viewer.Location = new System.Drawing.Point(0, 0);
        CR_Viewer.Size = new System.Drawing.Size(545, 379);
        CR_Viewer.TabIndex = 0;
        CR_Viewer.Name = "Invoice";
        CR_Viewer.Zoom(100);
        CR_Viewer.Show();

        Cursor.Current = Cursors.Default; 
```

这样，水晶文件中的 ODBC 就会自动更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-20T09:08:21.213

```
protected void Page_Load(object sender, EventArgs e)
        {
            try
            {

                ReportDocument cryRpt = new ReportDocument();
                TableLogOnInfos crtableLogoninfos = new TableLogOnInfos();
                TableLogOnInfo crtableLogoninfo = new TableLogOnInfo();
                ConnectionInfo crConnectionInfo = new ConnectionInfo();
                cryRpt.Load(@"D:\tem\WebAppReport\WebAppReport\CrystalReport1.rpt");
                crConnectionInfo.ServerName = "misserver";
                crConnectionInfo.DatabaseName = "testAccountability_data";
                crConnectionInfo.UserID = "RW";
                crConnectionInfo.Password = "RW";

                foreach (CrystalDecisions.CrystalReports.Engine.Table CrTable in cryRpt.Database.Tables)
                {
                    crtableLogoninfo = CrTable.LogOnInfo;
                    crtableLogoninfo.ConnectionInfo = crConnectionInfo;
                    CrTable.ApplyLogOnInfo(crtableLogoninfo);
                }

                CrystalReportViewer1.ReportSource = cryRpt;
                CrystalReportViewer1.RefreshReport();
            }
            catch
            {
            }

        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-07T03:18:11.597

这适用于 Sql Server 2008 R2 的 DSN 少连接。

```
Dim myConnectionInfo As CrystalDecisions.Shared.ConnectionInfo = New CrystalDecisions.Shared.ConnectionInfo()

    myConnectionInfo.ServerName = "Driver={SQL Server Native Client 10.0};Server=P03\sqlrs1;"
    myConnectionInfo.DatabaseName = "RS1DB"
    myConnectionInfo.UserID = "user"
    myConnectionInfo.Password = "pwd"

    For Each myTable As CrystalDecisions.CrystalReports.Engine.Table In mboReportDocument.Database.Tables

        Dim myTableLogonInfo As TableLogOnInfo = myTable.LogOnInfo
        myTableLogonInfo.ConnectionInfo = myConnectionInfo
        myTable.ApplyLogOnInfo(myTableLogonInfo)

    Next 
```

# ssis - 在 DTC 事务中登记 SSIS 包的间歇性失败

> ID：674364
> 
> 赞同：5
> 
> 时间：2009-03-23T17:22:22.910
> 
> 标签：ssis, msdtc

我们的软件包随机失败，并显示以下错误消息：

> SSIS 错误代码`DTS_E_OLEDBERROR`。发生 OLE DB 错误。错误代码：0x8004D00A。COM 错误对象信息可用。源：“[某些包名称]”错误代码：0x8004D00A 描述：“SSIS 运行时未能在分布式事务中登记 OLE DB 连接，错误为 0x8004D00A“无法登记在事务中。”

这不会一直发生，并且重新运行包通常会成功，所以我不认为这是 DTC 或网络配置问题。无论我们是在 Studio 中还是通过 SQL 代理作业运行包，都会发生这种情况。在后一种情况下，包在它尝试连接的同一个 SQL Server 实例上运行。

我们可以从日志中看到事务是在正确的时间点开始的——但是几秒钟后，我们得到了失败。

在这一点上感激地收到任何建议！

SQL Server 详细信息：在 Server 2003 64 位企业版 (3790) 上运行的 64 位企业版 (v9.0.3233)。这些服务器运行 E5345 Xeons，具有 6GB 的 RAM。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-01T08:56:49.223

我们最终找到了答案——控制流中有两个独立的任务正在建立到同一个数据库的连接。显然，某处存在某种竞争条件使其失败。添加优先约束以强制任务按顺序执行使问题消失。

# iphone - iPhone UIWebView - 你如何设置缩放级别和位置？

> ID：674368
> 
> 赞同：9
> 
> 时间：2009-03-23T17:23:02.737
> 
> 标签：iphone, uiwebview

我在 UIWebView 中显示一系列平铺图像，并希望以编程方式设置 UIWebview 的初始缩放和查看位置。

如何做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-04-06T07:42:37.497

将 UIWebView 的属性 scalesPageToFit 设置为 YES。然后网页被缩放以适应用户可以放大和缩小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-02-27T10:53:22.170

你可以使用这个：

```
for (UIView *subview in webView.subviews) {
    if ([subview isKindOfClass:[UIScrollView class]]) {
        ((UIScrollView *)subview).bounces = NO;
        [((UIScrollView *)subview) setZoomScale:10.5f animated:YES];
    }
} 
```

它可能是您问题的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T22:19:13.680

注意：此答案来自 2009 年。请参阅更文明时代的更好解决方案之一。

* * *

UIScrollView 的程序化滚动现在是一个已解决的问题。[我在github.com/andreyvit/ScrollingMadness/](http://github.com/andreyvit/ScrollingMadness/)详细讨论了 UIScrollView 缩放的工作原理、示例项目和 ZoomScrollView 类，它封装了所需的缩放魔法。

所以可能你应该像安迪建议的那样把你的图像放在 UIScrollView 中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T18:00:21.057

看起来没有记录在案的方式来做你想做的事。另一种只能解决一半问题的方法是使用 UIScrollView。您可以将 UIImageViews 放在 UIScrollView 中，然后滚动到滚动视图中的任何位置。但是，这不允许您以编程方式缩放视图。如果您认为应该将其添加到 SDK 文件中，请查看雷达：[http ://bugreport.apple.com/](http://bugreport.apple.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-04-13T09:17:52.617

```
for (id subview in webview)
    if ([[subview class] isSubclassOfClass: [UIScrollView class]])  {
         ((UIScrollView *)subview).bounces = NO;
     }
} 
```

尝试使用此滚动视图。

# c# - 将文件路径存储为 C# 控制台应用程序的变量

> ID：674373
> 
> 赞同：0
> 
> 时间：2009-03-23T17:23:33.127
> 
> 标签：c#, console-application, appsettings

我正在尝试创建一个将生成日志文件的 C# 控制台应用程序。我希望在存储日志文件的位置上有一些灵活性。

我尝试使用 Settings.settings 文件：

名称：logDrive 类型：字符串 范围：应用程序 值：C:\Scripts\Logs

在我的代码中，我正在使用：

```
string logFile = DateTime.Now.ToShortDateString() + " " + DateTime.Now.ToShortTimeString();
logFile = logFile.Replace(@"/", @"-").Replace(@"\", @"-") + ".log";
string logDrive = Properties.Settings.Default.logDrive;
StreamWriter output = new StreamWriter(logDrive + logFile); 
```

编译上述内容时，我收到错误消息“不支持给定路径的格式。”

如果有帮助，以下值：

logDrive = "C:\Scripts\ServiceDesk\Logs" logFile = "3-23-2009 1:20 PM.log"

有没有人对更好的方法和/或我做错了什么有任何想法/建议？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-23T17:24:28.757

您不能`:`在文件名中包含 a。更好的方法可能是使用类似的格式

```
YYYYMMDD_HHMMSS.log 
```

（例如`20090323_231245.log`）

这样做的好处是易于排序，并且不使用任何无效字符。

您可以使用

```
string logFile = string.Format("{0:yyyyMMdd_HHmmss}.log", DateTime.Now); 
```

**笔记：**

此外，正如评论中所建议的，您应该考虑使用`Path.Combine`来组合您的目录和文件名。这将有助于缓解尾随路径分隔符等问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T17:31:18.567

您还需要在“logDrive”中添加一个斜杠。IE：

```
logDrive = "C:\Scripts\ServiceDesk\Logs\" 
```

..或按照其他答案中的建议使用 Path.Combine

# ruby-on-rails - 如何使acts_as_list 与分组一起工作

> ID：674378
> 
> 赞同：2
> 
> 时间：2009-03-23T17:23:48.913
> 
> 标签：ruby-on-rails, ruby, ajax

我有一个使用acts_as_list 通过ajax 实现拖放的小型rails 应用程序。

该应用程序有 3 个主要模型：表格、部分和问题。按照设计，表格有很多部分，部分有很多问题。

我希望用户能够做 3 件事：

1.  重新排序表格中的部分
2.  重新排列部分中的问题
3.  dnd 一个问题到不同的部分。

我有一个可以处理#1 和#2 的设置，但是我遇到了#3 的问题。

您将在下面找到视图片段。关于从＃3开始的任何想法？

```
<p>
<ul id="section-list" style="cursor: move">
  <% @form.sections.each do |s| %>
    <li id="section_<%= s.id %>">
      <%= s.name %>
            <ul id="question-list-<%= s.id %>" style="cursor: move">
              <% s.questions.each do |q| %>
                    <li id="question_<%= q.id %>"><%= q.content %></li>
                <% end %>
            </ul>
        </li>
  <% end %>
</ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T21:59:15.727

`acts_as_list`有一个`:scope`选择。

```
acts_as_list :scope => "section_id" 
```

# c# - 字符串替换

> ID：674382
> 
> 赞同：0
> 
> 时间：2009-03-23T17:25:55.307
> 
> 标签：c#, asp.net, xml, localization

我有用于显示 Telerik 菜单的 leftmenu.xml，我需要将显示为 leftmenu 的 XML 中的文本转换为资源。

这是 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
<PanelItems>
  <PanelItem Text="sample" NavigateUrl="../Default.aspx?id=menu" />
  <PanelItem Text="sample2" NavigateUrl="../Default.aspx? 
        id=;category=sample2">
  <!--  -->
  <PanelItem Text="Products" NavigateUrl="../Default.aspx?id=sample3"/> 
```

这里我需要将 Txt 转换为 Dashboard、sample3、Products 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-29T19:44:33.300

您可以创建包含菜单条目的不同站点地图文件（每种语言一个）。然后将当前语言的站点地图文件分配给 Telerik 菜单控件。

有关示例，请参见以下[在线演示](http://demos.telerik.com/aspnet-ajax/menu/examples/programming/declarativedatasources/defaultcs.aspx)。

# c# - WPF Richtextbox FontFace/FontSize

> ID：674384
> 
> 赞同：6
> 
> 时间：2009-03-23T17:27:01.900
> 
> 标签：c#, wpf, richtextbox

我目前正在尝试在 WPF 项目中创建一些基本的文字处理器功能。我正在使用 RichTextBox 并且知道所有的 EditingCommands（ToggleBold、ToggleItalic...等）。我坚持的事情是允许用户更改字体大小和字体，就像在 MS Office 中一样，其中仅选定文本的值会更改，如果没有选定的文本，则当前插入符号位置的值将更改。我已经想出了相当多的代码来让它工作，但是我遇到了没有选择文本的问题。这是我为 RichTextBox.Selection 所做的。

```
TextSelection text = richTextBox.Selection;
if (text.IsEmpty)
{
    //doing this will change the entire word that the current caret position
    //is on which is not the desire/expected result.
    text.ApplyPropertyValue(RichTextBox.FontSizeProperty, value);
}
else
    //This works as expected.
    text.ApplyPropertyValue(RichTextBox.FontSizeProperty, value); 
```

所以我的问题是我应该怎么做呢？有没有更好/更方便的方法来做到这一点？我的一个想法是我需要在段落中插入一个新的内联，但我不知道该怎么做。任何帮助表示赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-10-22T16:58:56.877

我已经解决了这个问题：

```
TextRange r = new TextRange(richtextbox.Selection.Start, richtextbox.Selection.End);
r.ApplyPropertyValue(TextElement.FontSizeProperty, value); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-22T21:37:39.223

我只是遇到了完全相同的问题。正如本德威所说，我能够使用 TextElement.FontSizeProperty 。但是，它仍然无法正常工作。在查看下面链接的项目后，我发现我仍然做错了什么。我没有将焦点重新设置到 RichTextBox ... 下面项目的作者不需要这样做，因为他们使用的是功能区组合框。使用常规组合框，在您选择一种字体后，它确实会更改 RichTextBox 中选择的字体，但它会将焦点从 RTB 上移开。当您单击 RTB 以获取焦点并开始输入时，您将拥有一个新的选择对象，在这种情况下，字体将恢复为 RTB 本身的默认字体。

[http://www.codeplex.com/WPFRichEditorLibrary](http://www.codeplex.com/WPFRichEditorLibrary)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-28T09:50:22.020

@sub-jp 是对的，您需要将焦点设置回`RichTextBox`，否则您将更改一个选择的属性，但是当您单击返回文本框时，您将获得一个具有现有字体的新选择。尝试将您的代码更改为：

```
TextSelection text = richTextBox.Selection;

richTextBox.Focus();

text.ApplyPropertyValue(RichTextBox.FontSizeProperty, value); 
```

...然后它应该在突出显示文本和没有突出显示的情况下都能正常工作。

或者，[如此处所建议的](https://stackoverflow.com/a/3049235/55155)，您可以将`Focusable`ComboBox 的属性设置为`False`，以完全避免此问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:31:38.117

尝试这个

```
var range = new TextRange( richTextBox.Document.ContentStart, richTextBox.Document.ContentEnd );
range.ApplyPropertyValue( TextElement.FontSizeProperty, value ); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-11-16T21:12:02.637

如果我理解正确的话，我遇到了类似的问题。我尝试搜索大量接近但对我不太有用的各种答案。我的问题是字体更改对于明确选择的文本效果很好，但是如果没有选定的文本，并且字体大小发生了更改，则输入的以下文本将恢复为默认字体大小。这是我终于想出来的，试一试，让我知道它是否适用于其他人：

```
 public static void SetFontSize(RichTextBox target, double value)
    {
        // Make sure we have a richtextbox.
        if (target == null)
            return;

        // Make sure we have a selection. Should have one even if there is no text selected.
        if (target.Selection != null)
        {
            // Check whether there is text selected or just sitting at cursor
            if (target.Selection.IsEmpty)
            {
                // Check to see if we are at the start of the textbox and nothing has been added yet
                if (target.Selection.Start.Paragraph == null)
                {
                    // Add a new paragraph object to the richtextbox with the fontsize
                    Paragraph p = new Paragraph();
                    p.FontSize = value;
                    target.Document.Blocks.Add(p);
                }
                else
                {
                    // Get current position of cursor
                    TextPointer curCaret = target.CaretPosition;
                    // Get the current block object that the cursor is in
                    Block curBlock = target.Document.Blocks.Where
                        (x => x.ContentStart.CompareTo(curCaret) == -1 && x.ContentEnd.CompareTo(curCaret) == 1).FirstOrDefault();
                    if (curBlock != null)
                    {
                        Paragraph curParagraph = curBlock as Paragraph;
                        // Create a new run object with the fontsize, and add it to the current block
                        Run newRun = new Run();
                        newRun.FontSize = value;
                        curParagraph.Inlines.Add(newRun);
                        // Reset the cursor into the new block. 
                        // If we don't do this, the font size will default again when you start typing.
                        target.CaretPosition = newRun.ElementStart;
                    }
                }
            }
            else // There is selected text, so change the fontsize of the selection
            {
                TextRange selectionTextRange = new TextRange(target.Selection.Start, target.Selection.End);
                selectionTextRange.ApplyPropertyValue(TextElement.FontSizeProperty, value);
            }
        }
        // Reset the focus onto the richtextbox after selecting the font in a toolbar etc
        target.Focus();
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-09T14:58:46.207

问题是您必须在选择新的 FontFamily 或 Font Size 后将**焦点**设置回富文本框：

```
//When Font Size is changed
private void rbngFontSize_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        rtbMain.Focus(); // This part is what fixes the issue, just make sure it is set before ApplyPropertyValue method.

        try
        {
            ApplyPropertyValueToSelectedText(TextElement.FontSizeProperty, e.AddedItems[0]);
        }
        catch { };
    }

//When FontFamily is changed
private void rbngFontFamily_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        FontFamily editValue = (FontFamily)e.AddedItems[0];

        rtbMain.Focus(); // This part is what fixes the issue, just make sure it is set before ApplyPropertyValue method.

        ApplyPropertyValueToSelectedText(TextElement.FontFamilyProperty, editValue);            

    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-27T07:06:45.240

如果你正在处理它很容易解决`OnTextInput`。

```
protected override void OnTextInput(TextCompositionEventArgs e)
{
    TextRange range = new TextRange(this.Selection.Start, this.Selection.End);
    // Doesn't matter whether the selection is empty or not, it should be 
    // replaced with something new, and with the right formatting
    range.Text = e.Text;

    // Now nothing else would get affected...
    range.ApplyPropertyValue(TextElement.FontFamilyProperty, value);
    this.CaretPosition = range.End;
    e.Handled = true; // You might not need this line :)
} 
```

编辑：将 , 设置`CaretPosition`到 , 的末尾有时`TextRange`可能会使`Caret`对齐错误。我`RichTextBox`有很多`BaselineAlignment`调整，所以这可能是导致我的原因。但是，如果您遇到任何有趣的`Caret`跳跃或下沉，请在正确设置之前尝试检查是否在每次`Caret`结束时。像这样的东西会起作用：`Paragraph``CaretPosition`

```
TextRange test = new TextRange(range.End, range.End.Paragraph.ContentEnd);
bool IsAtEnd = test.IsEmpty || String.IsNullOrEmpty(test.Text) || test.Text == "\r\n";

// Now we know whether the Caret is still in the middle of the text or not
// This part corrects the Caret glitch! :)
if (!IsAtEnd)
    this.CaretPosition = range.End;
else
    this.CaretPosition = range.Start.GetNextContextPosition(LogicalDirection.Forward); 
```

我知道我的回答很晚了，但希望我帮助了别人。干杯!

# actionscript-3 - 如何在 Flash CS3 中访问组成员

> ID：674389
> 
> 赞同：3
> 
> 时间：2009-03-23T17:27:46.750
> 
> 标签：actionscript-3, flash-cs3, jsfl

我正在编写一个脚本来访问闪存（fla）文件库中的所有动态文本字段并嵌入某些字符集。

我遍历所有对象以查找文本字段，但是在尝试访问组对象的成员时似乎存在一些问题。它在 flash 文件中确实有子项，但我看不到从[jsfl 的 CS3 参考中](http://livedocs.adobe.com/flash/mx2004/main_7_2/wwhelp/wwhimpl/js/html/wwhelp.htm?href=Part_JSAPI.html)定义的 Group 对象访问它们的方法。Group 有一个未记录的 *layer*属性等，但它似乎只包含对自身的引用。

[CS4 参考](http://help.adobe.com/en_US/Flash/10.0_ExtendingFlash/WS5b3ccc516d4fbf351e63e3d118a9024f3f-7f57.html)定义了Group 对象的*members*属性。

所以我的问题是，它如何访问 Flash C3 jsfl 脚本 API 中 Group 对象的子对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T02:18:14.790

形状对象没有子对象。因此，如果您在递归中遇到 Shape 对象，那么它内部没有任何动态 texfields（或作为子对象的 flash 对象）

可能会让您感到困惑的是，将舞台上的对象分组形成一个形状，但事实并非如此。舞台上的对象“组”只存在于Flash编辑界面中，方便编辑和工作流程。一旦您发布它们实际上并没有在 swf/actionscript 中分组。

更令人困惑的是，当舞台上有多个矢量项目，甚至在某些情况下舞台上有位图项目时，Flash 只会将它们简化，展平为单个 Shape 对象。这进一步加深了这样一种错觉，即对对象进行分组会创建一个 Shape 对象，其中每个对象都是一个子对象，因此一个 Shape 对象可以有子对象，但实际上它所做的只是将所有对象扁平化为一个单一的 Shape，并将这些图形平放在其上，它不将它们中的任何一个作为单独的对象。这种情况永远不会发生在动态文本字段中，所以很简单，如果你点击一个 Shape 对象，那么那里就没有动态文本字段，继续:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T00:58:57.200

首先 unGroup() 形状。然后您可以在之后运行正常的“文本”转换。它不应该损害文档，因为分组没有真正的技术含义。

```
var doc = fl.getDocumentDOM();
var results = fl.findObjectInDocByType("shape", doc);
for (var i = 0; i < results.length; i++) 
{
    if ( results[i].obj.isGroup )
    {
        doc.selection = [results[i].obj];
        doc.unGroup();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T03:57:12.383

你确定你在使用 Shapes 吗？除了图形（它具有图形属性，如 Sprite）之外，形状不应该有任何实际的子元素，这些子元素实际上不算作子元素。它们更像是图形属性的值。

Shape 不扩展 DisplayObjectContainer，所以我很确定它不能有子显示对象，例如 Sprite 或 MovieClip。

如果搜索 TextFields，您应该可以安全地跳过这些内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-16T00:47:35.553

您自己已经暗示了答案：在形状对象上使用 members 属性。它返回一个包含在其中的对象数组，这些对象可能是也可能不是文本对象。

您没有指定是否使用 fl.findObjectInDocByType() 来扫描文档中的文本对象和形状（潜在组），但这也是一个好主意。

[http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00004151.html](http://livedocs.adobe.com/flash/9.0/main/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Parts&file=00004151.html)

我相信以下脚本将跟踪 FLA 中所有动态文本字段的文本值，除非我错过了一些讨厌的嵌套案例。无论如何，它应该有望让您继续前进。请注意，您需要从“命令”菜单运行脚本，以便 fl.findObjectInDocByType() 不会引发错误。有关更多信息，请参阅上面链接中的评论。

```
// Look for text objects
var doc = fl.getDocumentDOM();
var typeToSearchFor = "text";
var results = fl.findObjectInDocByType(typeToSearchFor, doc);

for(var i = 0; i < results.length; i++)
{
    if(results[i].obj.textType == "dynamic")
    {
        doWhatever(results[i].obj);
    }
}

// Look for shapes
typeToSearchFor = "shape";
results = fl.findObjectInDocByType(typeToSearchFor, doc);

var textObjects;

for(var i = 0; i < results.length; i++)
{
    var members = results[i].obj.members;

    for(var j = 0; j < members.length; j++)
    {
        if(members[j].elementType == "text" && members[j].textType == "dynamic")
        {
            doWhatever(members[j]);
        }
    }
}

function doWhatever(textObj)
{
    fl.trace(textObj.getTextString());
} 
```

# java - POJO 的 JUnit 测试

> ID：674408
> 
> 赞同：36
> 
> 时间：2009-03-23T17:31:45.307
> 
> 标签：java, junit, pojo

我在一个项目中工作，我们必须为所有简单的 bean (POJO) 创建单元测试。如果 POJO 只包含 getter 和 setter，那么为它们创建单元测试有什么意义吗？假设 POJO 将在大约 100% 的时间内工作，这是一个安全的假设吗？

* * *

重复 -[是否应该测试 @Entity Pojos？](https://stackoverflow.com/questions/337241/should-entity-pojos-be-tested)

**也可以看看**

[在数据库而不是假存储库上运行测试是不好的做法吗？](https://stackoverflow.com/questions/607620/is-it-bad-practice-to-run-tests-on-a-db-instead-of-on-fake-repositories/616537#616537)

[是否有自动测试 getter 和 setter 的 Java 单元测试框架？](https://stackoverflow.com/questions/108692/is-there-a-java-unit-test-framework-that-auto-tests-getters-and-setters)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-03-23T17:54:28.637

TDD 中的规则是[“测试所有可能破坏](http://www.xprogramming.com/xpmag/PracticesForaReason.htm) 的东西” getter 可以破坏吗？一般不会，所以我懒得去测试它。此外，我测试的代码*肯定*会调用 getter，所以它*会*被测试。

我个人的规则是，我将为任何做出决定或做出不只是微不足道的计算的函数编写一个测试。我不会为 编写测试`i+1`，但我可能会`if (i<0)...`并且肯定会为`(-b + Math.sqrt(b*b - 4*a*c))/(2*a)`。

顺便说一句，对 POJO 的强调背后有不同的原因。我们希望将大量代码写入*不依赖于它们运行环境的*POJO 。例如，很难测试 servlet，因为它们依赖于在容器中执行。因此，我们希望 servlet 调用不依赖于其环境并因此易于测试的 POJO。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-23T17:35:12.227

POJO 还可能包含其他函数，例如 equals()、hashCode()、compareTo() 和各种其他函数。了解这些功能是否正常工作可能很有用。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-03-23T18:22:04.810

我曾经因为这样的事情花了两个小时：

```
int getX()
{
    return (x);
}

int getY()
{
    return (x); // oops
} 
```

由于为简单的 getter 编写测试几乎不需要时间，所以我现在这样做是出于习惯。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-03-23T17:35:45.080

我认为测试简单的属性获取器和设置器没有意义。单元测试的重点不是验证您的编译器是否工作。

但是，一旦您向 getter 和 setter（或其他方法）添加条件、空检查或其他重要行为，我认为添加单元测试是合适的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-07-07T11:05:44.710

我使用 IntelliJ 作为 IDE，它几乎为我编写了琐碎的 POJO——当然是构造函数和 getter/settors。我认为单元测试没有任何意义，因为任何错误很可能出现在我编写的测试代码中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-10-17T23:05:08.123

有一个开源实用程序[http://meanbean.sourceforge.net/](http://meanbean.sourceforge.net/)允许您测试 POJO。还有一个页面描述了一个人可能对这个实用程序提供什么以及为什么应该使用它的优点/问题。

我自己（还）从来没有累过它，但它已被推荐给我。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T17:37:55.293

我的回答是微不足道的 getter 和 setter 不值得自己测试。如果我添加除了简单读取或写入之外的任何代码，那么我会添加测试。

当然，这都是样板文件，因此如果您认为那里有任何价值，您可以轻松地编写一个为您的 getter 和 setter 生成单元测试的脚本。某些 IDE 可能允许您定义一个模板，该模板使用为该样板代码填充的测试方法创建测试用例（我在此考虑 IntelliJ，但 Eclipse 可能也可以处理它，尽管我还没有做过类似的事情） IDE）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T17:39:00.687

以我的经验，只用 getter 和 setter 为 POJO 创建单元测试是矫枉过正的。当然，也有一些例外，如果 getter/setter 中有额外的逻辑，比如检查 null 和做一些特殊的事情，那么我会为此创建一个单元测试。

此外，如果 POJO 中有错误，我会为它创建一个单元测试，这样我们就可以防止它再次发生。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T17:48:28.167

可能值得一个简单的测试来确保你没有写过

```
public void setX(int x) {
   x = x;
} 
```

尽管您应该进行编码以避免这种情况（通过`final`在方法参数上放置修饰符或类似方法）。它还取决于您如何生成访问器，以及它们是否可能遭受复制/粘贴错误等（即使在尝试强制使用 IDE 的环境中也会发生这种情况 - 它只是会发生）。

但是，我对包含大量 setter/getter 的类的主要关注*是，该类在做什么*？对象应该为您做事，而不仅仅是保存和返回数据。如果这些是数据实体对象，那么 setter/getter 模式可能是正确的。然而更好的模式是在对象中设置数据，并要求对象用它做一些事情（计算你的银行余额，发射火箭等），而不是返回数据让你自己做！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-11-14T18:27:40.823

单元测试不仅验证代码是否正常工作，而且它们记录了预期的行为。我不知道有多少次我看到事情中断了，因为一段时间后，有人改变了 POJO 中的 getter 或 setter 的行为，然后它意外地破坏了其他东西（例如，有人向 setter 添加了逻辑如果有人在字符串上设置空值，setter 会将其更改为空字符串，这样 NPE 就不会发生）。

我不会将数据存储 POJO 的单元测试视为浪费时间，我将它们视为未来维护的安全网。话虽这么说，如果您手动编写测试来验证这些对象，那么您将很难做到。看看类似[http://gtcgroup.com/testutil.html](http://gtcgroup.com/testutil.html)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-04-05T15:43:55.617

恕我直言，在测试任何功能的逻辑时会自动测试 POJO，例如，为了测试任何功能，我们可能需要注入/模拟某些值，POJO 和 POJO 的 getter/setter 是间接测试的。

然而，对于消除 POJO 进行单元测试的特定用例，可以通过以下两种方式实现：

1.  使用库：使用有助于测试 POJO 的现有库。我遇到的一个这样的图书馆是meanbean。

    **参考**： http: [//meanbean.sourceforge.net/](http://meanbean.sourceforge.net/)

    **Maven**：[http](http://mvnrepository.com/artifact/org.meanbean/meanbean) ://mvnrepository.com/artifact/org.meanbean/meanbean（当前版本：2.0.3）

2.  IGNORE POJO：Sonar 可以配置为排除 POJO 或要从单元测试覆盖率报告中排除的特定包。下面的几个例子：

    ```
    <properties>
        <sonar.coverage.exclusions>
            **/domain/**/*,
            **/pojos/*
        </sonar.coverage.exclusions>
    </properties> 
    ```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2020-03-24T06:07:41.837

MeanBean 库提供了一个 API 来测试 POJO。例如下面的代码片段测试是否 Emplooyee pojo。演示应用程序[链接。](https://self-learning-java-tutorial.blogspot.com/2016/04/mean-bean-testing-java-beans-and-pojos.html)

```
BeanTester beanTester = new BeanTester();
beanTester.testBean(Employee.class); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-07T10:58:09.217

我正在尝试使用 cobatura 进行代码覆盖，但遇到了同样的问题。

最好有一个注释添加到类中，它说不要将此类包含在代码覆盖范围中。但是，可以将您的 pojo 放在一个单独的包中，然后将该包从分析中排除。

根据您的工具查看文档，它适用于 Ant、Maven 或命令行。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-06-12T15:15:35.513

我刚刚开始了一个项目来做到这一点。它现在处于 pre-alpha 阶段。它是一个 Eclipse 插件。

虽然我同意通常 POJO setter/getter 不一定需要测试，但我相信在那里进行简单测试很好，因为随着时间的推移，事情会发生变化，这将使您更容易为 POJO 添加更多测试. 设置了单元测试，测试setter/getter的方法在那里，你所要做的就是处理新的复杂性。

这也有助于代码覆盖率报告，这有助于让管理人员满意。（我的公司使用艾玛）。

[https://sourceforge.net/projects/unittestgplugin/](https://sourceforge.net/projects/unittestgplugin/)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2017-12-18T13:06:22.897

这个问题可以通过使用 Lombok 库来解决，该库消除了所有这些样板代码以及等号和哈希码。

因此，除非您对等号和哈希码有特定要求，否则您不需要测试它们

[https://projectlombok.org/](https://projectlombok.org/)

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2009-03-23T17:50:47.133

您想*知道*的单元测试代码有效（当然适用于测试的情况）。不要对您只想确定有效的代码进行单元测试。

我想不出太多我只想确定的事情。

* * *

## 回答 #17

> 赞同：-2
> 
> 时间：2009-03-23T17:37:53.437

我认为如果 getter 和 setter 是使用 IDE 创建的，那么应该没问题。我们还有其他东西可以放入我们的代码。显然，您将测试 POJO 的序列化/反序列化。

# jquery - 在 sharepoint 2007 中使用 JQuery 自动完成和外部 Json url

> ID：674409
> 
> 赞同：1
> 
> 时间：2009-03-23T17:31:47.913
> 
> 标签：jquery, autocomplete, sharepoint-2007

我正在尝试在 sharepoint 2007 的自定义 webpart 中实现 autocomeplete 框。当我在同一域中使用静态文件（对于具有 id f1 的文本框）时，一切正常，但是当我使用提供 json 输出的远程 url 时（对于带有id f2)，它在 javascript 中给出了 Permission Denied 错误。在最后一页中，以下是生成的 HTML -

```
$('#f1').autocomplete('documents/staticfile.txt');
$('#f2').autocomplete('http://url_that_spits_out_json', 
{ dataType:"json", 
  formatItem: function(data,i,max,value,term){ return value; }, 
  parse: function(data) { 
    var array = new Array(); 
    for(var i=0;i<data.length;i++) {
      array[array.length] = { data:data[i], value: data[i].text, result: data[i].text};
    } 
    return array;
  }
}); 
```

由于它在 f1 上运行良好，因此对我来说它看起来与 sharepoint 有关。任何人都有任何想法，如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:41:57.140

如果您收到权限被拒绝错误，很可能是因为您从另一个域获取 JSON 数据。您要么必须使用 JSONP，要么将数据保存在同一个域名上。

请参阅数据类型的 $.ajax 选项：[JSONP](http://docs.jquery.com/Ajax/jQuery.ajax#options)

# c++ - 在 C++ 中忽略 std::cin 上的 EOF

> ID：674413
> 
> 赞同：2
> 
> 时间：2009-03-23T17:32:43.527
> 
> 标签：c++, console, stdin

我有一个实现交互式 shell 的应用程序，类似于 Python 控制台/irb 的工作方式。现在的问题是，如果用户不小心点击`^D`EOF 并且我的`getline()`调用返回一个空字符串，我将其视为“无输入”并再次显示提示。

然后这会导致打印提示的无限循环。

现在在 Python 中，我会通过 catch 来解决这个问题`EOFError`，但在 C++ 中，我可以捕捉到没有异常，而且似乎没有设置`cin`忽略 EOF。

有什么提示吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T17:37:27.680

如果它无法读取任何内容，则设置`failbit`. 只需在 if 条件下测试流，然后清除该位：

```
if(!getline(std::cin, myline)) {
    std::cin.clear();
    std::cout << "you should enter something" << std::endl;
} 
```

在内部，您的情况是这样的：

*   在终端上等待字符串。终端将阻塞，直到用户发出换行符。两种可能的错误情况
    1.  用户立即按下 EOF。这将使`getline`read 什么都没有，它会设置`failbit`和`eofbit`。
    2.  用户输入一些东西，然后按 EOF。这将`getline`消耗一些东西，然后在尝试获取下一个字符时遇到 EOF。设置这个原因`eofbit`。
*   您将尝试再次阅读一些内容。提取函数将创建一个类型的对象，`istream::sentry`用于检查流的状态。如果设置了任何错误位，它将导致提取函数立即返回。这导致了之前的无限循环。

调用`clear()`清除所有错误位，您可以继续阅读您的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T17:51:19.300

感谢 litb 的正确解决方案：

```
if (!getline(std::cin, str)) {
    std::cin.clear();
    std::cout << std::endl;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T17:35:51.083

该[`getline()`](http://www.cplusplus.com/reference/iostream/istream/getline.html)函数使用以下位发出错误信号：

*   eofbit
*   故障位
*   坏比特

在继续之前尝试检查这些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T17:40:41.137

见[http://www.horstmann.com/cpp/pitfalls.html](http://www.horstmann.com/cpp/pitfalls.html)

您可以使用如下代码：

```
while (cin)
{  int x;
   cin >> x;
   if (cin) a.push_back(x);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T17:41:00.277

好的，在其他答案中，使用 cin.clear() 被描述为一种可能的解决方案。

另一个技巧是，您可以使用其他方式来处理来自控制台的输入，而不是典型标准，方法是将终端设置为另一种模式，以便您可以直接处理 Ctrl+D。在 RAW 模式或其他模式下，您可以更直接地访问来自用户端的输入和控制序列（如 Ctrl+D 或 Ctrl+C），不再在其他地方处理。

您可能会尝试收集更多信息（甚至节省编码时间）的一些库：

*   [GNU 阅读线](http://tiswww.case.edu/php/chet/readline/rltop.html)
*   [有用的终端 I/O 库](http://utio.sourceforge.net/)½
*   [NCurses](http://www.gnu.org/software/ncurses/)（非常强大）

[½ 您可以在此处](http://utio.sourceforge.net/#CKeyboard)的文档中找到有关您的问题的一些信息。

# c# - 等待用户输入

> ID：674416
> 
> 赞同：1
> 
> 时间：2009-03-23T17:33:18.953
> 
> 标签：c#, asp.net, events, webforms

我有一个调用 web 服务并处理响应的进程，一些响应需要一些用户输入，以便可以处理它们。当需要用户输入时，我想触发一个事件，在事件处理程序中我想向页面显示一个表单，然后等到用户输入被发回，然后让事件处理程序将用户输入返回给调用方法。

我很难让事件处理程序在返回输入之前等待回帖，我什至不知道它是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T18:03:12.143

如果我理解正确，我认为这里的问题是您正在尝试使用非常简单的基于事件的系统来解决问题。您需要做的是为此类任务创建自己的（非常简单的）工作流系统，并尝试从 UI 处理中分离出一些后端逻辑（尽管 ASP.NET MVC 框架非常适合这种情况）我看到您正在使用 WebForms，但这并不是什么大问题）。现在这个“工作流程”并不一定需要很复杂。首先将应用程序执行的操作分解为某种流程图。如果您可以看到非常简单的依赖关系，那么它可能只是实现基本状态机的问题。作为处理 Web 应用程序（各种：应用程序、会话、视图）中状态的一般指针，[这个页面](http://wiki.asp.net/page.aspx/30/state-management/)。恐怕我无法真正为您提供您所描述的更具体的内容（但也许我遗漏了一些明显的东西）。如果您想澄清您的网站/网络应用程序需要执行的任务，那么我可能会提供一些代码示例，但我怀疑仅从分析的角度/从流程的角度处理这个问题应该会给您一个很好的解决方案.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-18T14:25:01.673

就个人而言，我更喜欢 Noldorin 的建议，即找出工作流程并使用它来确定何时请求输入。请记住，就客户端渲染而言，服务器事件不会做任何事情，除非它们发生在用户发出请求时......在这种情况下，您已经有了工作流程并且不需要事件。

您可以通过使客户端计算机与服务器保持通信来解决此问题。例如，检查`<asp:Timer>`控件的 Tick 事件中的新事件。如果您的目标是，例如，有一个更新面板或表明服务器已完成 XX% 的用户请求处理，并在处理完成后要求用户输入，则此解决方案是实用的。

# sql-server - 根据输入参数对 SQL 结果排序

> ID：674419
> 
> 赞同：2
> 
> 时间：2009-03-23T17:33:41.543
> 
> 标签：sql-server, tsql

结合 fn_split 函数，我从基于逗号分隔值的表中返回结果列表。

存储过程 T-SQL 如下：

```
SELECT ProductCode, ProductDesc, ImageAsset, PriceEuros, PriceGBP, PriceDollars,  
replace([FileName],' ','\_') as [filename],  
ID as FileID, weight  
from Products  
LEFT OUTER JOIN Assets on Assets.ID = Products.ImageAsset  
where ProductCode COLLATE DATABASE_DEFAULT IN  
(select [value] from fn\_split(@txt,','))  
and showOnWeb = 1 
```

我将以下内容传递给@txt 参数（例如）：

> ABC001,ABC009,ABC098,ABC877,ABC723

这一切都很好，但是结果不会以任何特定的顺序返回 - 我需要以“相同顺序”返回的产品作为输入参数。

不幸的是，这是一个具有内置架构的实时站点，所以我无法更改任何内容（但我希望我可以） - 否则我会让它更明智。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T17:38:15.667

如果在 @txt 参数上传递的所有引用都是唯一的，您可以使用[CharIndex](http://msdn.microsoft.com/en-us/library/ms186323(SQL.90).aspx)来查找它们在参数中的位置，例如

```
order by charindex(ProductCode, @txt) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T17:41:11.710

在存储过程中，我将创建一个具有数字键的表，该键是临时表的 PK 并设置为自动增量。然后，我会将 fn_split 的结果插入到该表中，以便您拥有在列表中按顺序排列的参数（自动增量将处理此问题）。

然后，将结果集加入此临时表，按数字键排序。

如果参数列表中的条目不是唯一的，那么在将记录插入临时表后，我将删除所有重复项，除了 id 是该特定参数最小值的记录。

# javascript - 在 AJAX 响应中嵌入图像

> ID：674428
> 
> 赞同：7
> 
> 时间：2009-03-23T17:36:12.957
> 
> 标签：javascript, ajax

是否可以（并且支持跨浏览器）将图像嵌入到 AJAX 响应的 XML 中，然后使用 JavaScript 加载该图像？

我有一个系统，它根据通过它运行的会话数进行一些计算。然后将结果绘制成图表，并分两部分返回：

1) XML 包含有关图表、总计和图像地图数据的信息，允许用户单击相关区域。

2）图形图像。

由于数据可以在两个请求之间更改（并且计算起来可能很昂贵），我更愿意在单个请求中进行（返回带有 XML 的图像）。当前的实现将统计信息缓存一小段时间，以便多个请求的结果仍然匹配。由于需要缓存的数据量将会增加（从 ~2.5K 到 ~1.2MB），我想尝试另一种方法。

注意：我不想使用内联 b64 PNG 图像，因为 IE 不支持它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T17:39:52.480

你能不把图片存储在服务器上，然后把 URL 发送给客户端吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T19:38:43.130

由于这似乎是值得做的更多工作，我决定一个更简单的解决方案是：

1) 向客户端发送 XML 数据，其中包含要绘制的内容的详细信息。

2) 客户端发送图像请求，包括要绘制的数据（类似于 Google Chart API）。

这将图表渲染与数据分离，然后可以在将来用于为其他数据集生成通用图表。另一个好处是它不需要任何缓存服务器端，因为只使用了 1 个请求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T18:26:33.490

您可能想检查此[链接](http://bytes.com/groups/javascript/433203-getting-binary-data-image-object)以查看此概念是否有效。这个[链接](http://www.davidflanagan.com/javascript5/display.php?n=22-16&f=22/16.html)可能有用。

我认为尝试在 XML 中组合这两组数据会很有趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:41:54.347

您是否考虑过使用[Google 的 Chart API](http://code.google.com/apis/chart/)？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-21T03:11:25.220

[其实你可以](http://blog.calyptus.eu/seb/2009/05/png-parser-in-javascript/)，但它可能不值得。似乎基于矢量的方法（例如画布）和[IE 的 VML 替代方案](http://github.com/ibolmo/moocanvas)将是渲染图形的更好替代方案。然后您只需将图形数据传递给浏览器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T17:47:19.233

如果存储不是一种选择。在内存中创建图像并刷新二进制图像数据以响应脚本（如 php 文件）。只需使用正确的标题：

```
Content-type: image/png 
```

每次都会重新生成图像。

要绝对确保图像不会被缓存，请将一些随机参数附加到查询字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T17:55:36.513

您可以将图像返回给 ajax 客户端，然后将 XML 数据包含在图像的 X-HTTP-Header 中。

但是您需要确定是否可以从 ajax-client 读取 X-header。

# c# - 将程序集信息枚举到 xml 的工具

> ID：674429
> 
> 赞同：1
> 
> 时间：2009-03-23T17:36:25.437
> 
> 标签：c#, .net, assemblies

有谁知道是否有工具可以获取给定程序集的所有程序集信息。最好是 XML 格式。

所需资料：

*   完整的命名空间程序集名称
*   标题
*   文化
*   配置
*   版本
*   信息版
*   描述
*   公司
*   产品
*   版权
*   商标

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T19:58:07.903

```
 public static class AssemblyExtensions
    {
        public static string InfoToXML(this Assembly assembly)
        {
            string name = assembly.FullName;
            string title = String.Empty;
            string description = String.Empty;
            string company = String.Empty;
            string culture = String.Empty;
            string configuration = String.Empty;
            string version = String.Empty;
            string informationalVersion = String.Empty;
            string product = String.Empty;
            string trademark = String.Empty;
            string copyright = String.Empty;

            foreach (var attrib in assembly.GetCustomAttributes(false))
            {
                if (attrib is AssemblyTitleAttribute)
                {
                    title = ((AssemblyTitleAttribute)attrib).Title;
                }

                if (attrib is AssemblyDescriptionAttribute)
                {
                    description = ((AssemblyDescriptionAttribute)attrib).Description;
                }

                if (attrib is AssemblyCompanyAttribute)
                {
                    company = ((AssemblyCompanyAttribute)attrib).Company;
                }

                if (attrib is AssemblyCultureAttribute)
                {
                    culture = ((AssemblyCultureAttribute)attrib).Culture;
                }

                if (attrib is AssemblyConfigurationAttribute)
                {
                    configuration = ((AssemblyConfigurationAttribute)attrib).Configuration;
                }

                if (attrib is AssemblyVersionAttribute)
                {
                    version = ((AssemblyVersionAttribute)attrib).Version;
                }

                if (attrib is AssemblyInformationalVersionAttribute)
                {
                    informationalVersion = ((AssemblyInformationalVersionAttribute)attrib).InformationalVersion;
                }

                if (attrib is AssemblyProductAttribute)
                {
                    product = ((AssemblyProductAttribute)attrib).Product;
                }

                if (attrib is AssemblyTrademarkAttribute)
                {
                    trademark = ((AssemblyTrademarkAttribute)attrib).Trademark;
                }

                if (attrib is AssemblyCopyrightAttribute)
                {
                    copyright = ((AssemblyCopyrightAttribute)attrib).Copyright;
                }
            }

            StringBuilder builder = new StringBuilder();
            StringWriter stringWriter = new StringWriter(builder);
            XmlTextWriter xmlWriter = new XmlTextWriter(stringWriter);

            xmlWriter.WriteStartDocument();
            xmlWriter.WriteStartElement("AssemblyInformation");
            xmlWriter.WriteElementString("AssemblyName", name);
            xmlWriter.WriteElementString("Title", title);
            xmlWriter.WriteElementString("Description", description);
            xmlWriter.WriteElementString("Company", company);
            xmlWriter.WriteElementString("Culture", culture);
            xmlWriter.WriteElementString("Configuration", configuration);
            xmlWriter.WriteElementString("Version", version);
            xmlWriter.WriteElementString("InformationalVersion", informationalVersion);
            xmlWriter.WriteElementString("Product", product);
            xmlWriter.WriteElementString("Trademark", trademark);
            xmlWriter.WriteElementString("Copyright", copyright);
            xmlWriter.WriteEndElement();

            return builder.ToString();
        }
    } 
```

这应该让你开始。您可以添加错误处理和内容，但这应该可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T17:36:58.757

您可能可以使用[.NET Reflector](http://www.red-gate.com/products/reflector/)。我不知道它有一个 XML 导出，但我不明白为什么你不能添加它，或者自己编写一个工具。迭代属性并提取此类信息非常容易。

# c# - 系统范围的持久存储？

> ID：674431
> 
> 赞同：1
> 
> 时间：2009-03-23T17:36:50.257
> 
> 标签：c#, .net, windows, multithreading

我的程序启动了一个进程，我需要确保它被杀死，然后才能再次运行该程序。为此，我想将进程的开始时间存储在一个类似互斥体的东西中，我以后可以检索它并检查是否有任何进程具有匹配的名称和开始时间。

我怎么能这样做？我真的不想在硬盘驱动器上粘贴任何在用户注销后仍然存在的东西。

作为参考，我正在使用 C# 和 .NET

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T17:39:28.923

您要存储进程 ID，而不是进程名称和开始时间。这将使终止进程变得更简单。您可以将文件存储在 %TMP% 中，以便在硬盘空间不足时对其进行清理。

杀死进程的 C# 代码如下所示：

```
 int pid = Convert.ToInt32(File.ReadAllText(pidFile));
    Process proc = Process.GetProcessById(pid);
    proc.Kill(); 
```

您可以像这样找到 %TMP% 目录：

```
var tmp = Environment.GetEnvironmentVariable("TMP"); 
```

编辑：PID 可以重复使用，所以你也需要处理它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T18:15:43.453

我同意[rossfabricant](https://stackoverflow.com/questions/674431/system-wide-persistent-storage/674442#674442)应该存储进程 ID 而不是名称。进程 ID 直到重新启动后才会重用，因此这应该是安全的。

但是，我建议不要使用 TMP 环境变量进行存储，而是查看[独立存储](http://www.developerfusion.com/article/4636/isolated-storage-in-net/3/)。就存储而言，这将更加面向 .NET。此外，它会降低运行应用程序所需的安全性。

不幸的是，临时目录和隔离存储都会在注销后持续存在，因此您需要逻辑来处理这种情况。（但是，您的应用程序可以清除关闭时的信息）。

If you have access to the code of process you are starting, it might be better to use something like named pipes or shared memory to detect whether the application is running. This also gives you a much cleaner way to shut down the process. Killing a process should be a last resort - in general, I wouldn't build an application where the design requires killing a process if it was at all avoidable.

# c++ - C ++“未在此范围内声明”编译错误

> ID：674448
> 
> 赞同：11
> 
> 时间：2009-03-23T17:41:42.583
> 
> 标签：c++, scope

C++ 新手。在我正在编写的以下程序中，我收到此错误：

```
g++ -o Blob blob.cc
blob.cc: In function 'int nonrecursivecountcells(color (*)[7], int, int)':
blob.cc:41: error: 'grid' was not declared in this scope 
```

这是代码：

```
#include <iostream>
enum color {BACKGROUND, ABNORMAL, TEMPORARY};
const int ROW_SIZE = 7;
const int COL_SIZE = 7;
int nonrecursivecountcells(color[ROW_SIZE][COL_SIZE], int, int);
using namespace std;

int main() 
{
  color grid[ROW_SIZE][COL_SIZE] =
    {{BACKGROUND, ABNORMAL, BACKGROUND, ABNORMAL, BACKGROUND, BACKGROUND, BACKGROUND},
      {ABNORMAL, ABNORMAL, BACKGROUND, ABNORMAL, BACKGROUND, BACKGROUND, BACKGROUND},
       {BACKGROUND, BACKGROUND, ABNORMAL, ABNORMAL, BACKGROUND, BACKGROUND, ABNORMAL},
        {BACKGROUND, BACKGROUND, BACKGROUND, ABNORMAL, ABNORMAL, ABNORMAL, BACKGROUND},
         {BACKGROUND, BACKGROUND, BACKGROUND, ABNORMAL, BACKGROUND, BACKGROUND, BACKGROUND},
          {BACKGROUND, BACKGROUND, BACKGROUND, BACKGROUND, BACKGROUND, ABNORMAL, BACKGROUND},
           {BACKGROUND, ABNORMAL, ABNORMAL, BACKGROUND, BACKGROUND, BACKGROUND, ABNORMAL}};

   cout << "Enter row number" << endl;
   int row;
   cin >> row;
   cout << "Enter column number" << endl;
   int column;
   cin >> column;

   int number = nonrecursivecountcells(grid, row, column);
   cout << "Number off cells in the blob that contains grid[" << row << "][" << column << "] are: " << number << endl;

   return 0;

}

int nonrecursivecountcells(color[ROW_SIZE][COL_SIZE], int row, int column)
{
  if (row < 0 || row >= ROW_SIZE || column < 0 || column >= COL_SIZE)
  {
    return 0;
  }

  else if (grid[row][column] != ABNORMAL)
  {
    return 0;
  }

  else
  {
    grid[row][column] = TEMPORARY;
    return 1
    + nonrecursivecountcells(grid, row - 1, column - 1) + nonrecursivecountcells(grid, row - 1, column)
    + nonrecursivecountcells(grid, row - 1, column + 1) + nonrecursivecountcells(grid, row, column + 1)
    + nonrecursivecountcells(grid, row + 1, column + 1) + nonrecursivecountcells(grid, row + 1, column)
    + nonrecursivecountcells(grid, row + 1, column - 1) + nonrecursivecountcells(grid, row, column - 1);
  }
} 
```

有谁可以帮我离开这里吗？谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T17:43:45.247

**怎么了：**

“nonrecursivecountcells”的定义没有名为 grid 的参数。您需要将类型和变量名称传递给函数。你只传递了类型。

请注意，如果您使用名称网格作为参数，则该名称与您的网格的 main() 声明无关。您也可以使用任何其他名称。

[`***`您也不能将数组作为值传递。](https://stackoverflow.com/questions/671074/why-c-or-c-does-not-allow-passing-array-by-values-to-function/671076#671076)

* * *

**怎么修：**

解决此问题的简单方法是将指向数组的指针传递给函数“nonrecursivecountcells”。

```
int nonrecursivecountcells(color[ROW_SIZE][COL_SIZE], int, int); 
```

更好并且输入安全->

```
int nonrecursivecountcells(color (&grid)[ROW_SIZE][COL_SIZE], int, int); 
```

**关于范围：**

当声明它的块终止时，在堆栈上创建的变量超出范围。块是左大括号和**匹配**右大括号内的任何内容。例如 if() { }、function() { }、while() {}、...

注意我说的是变量而不是数据。例如，您可以在堆上分配内存，即使超出范围，数据仍将保持有效。但是最初指向它的变量仍然会超出范围。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T17:45:09.610

grid 不是全局的，它是 main 函数的局部。改变这个：

```
int nonrecursivecountcells(color[ROW_SIZE][COL_SIZE], int row, int column) 
```

对此：

```
int nonrecursivecountcells(color grid[ROW_SIZE][COL_SIZE], int row, int column) 
```

基本上你忘了给第一个参数一个名字，网格会因为它匹配你的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T17:45:49.000

nonrecursivecountcells() 的第一个参数没有变量名。您尝试在函数体中将其作为网格引用，因此您可能希望将其称为网格。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:46:30.700

正如编译器所说，`grid`没有在你的函数范围内声明:)“范围”基本上意味着一组花括号。每个变量都限于声明它的范围（不能在该范围之外访问）。在您的情况下，您`grid`在函数中声明变量`main()`并尝试在`nonrecursivecountcells()`. 但是，您似乎将其作为参数传递`colors`，因此我建议您将`grid`in的用途重命名`nonrecursivecountcells()`为`colors`。我认为尝试以这种方式传递数组也可能有问题，因此您可能应该调查将其作为指针传递（除非其他人说相反的话）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T17:44:30.753

**网格**不存在于 nonrecursivecountcells 的范围内。

要么使**grid**成为全局数组，要么将其作为参数传递给函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T17:45:42.713

修复函数声明

```
int nonrecursivecountcells(color grid[ROW_SIZE][COL_SIZE], int row, int column) 
```

# c# - 在 wpf-treeview 中查找父项

> ID：674453
> 
> 赞同：1
> 
> 时间：2009-03-23T17:42:10.243
> 
> 标签：c#, wpf, data-binding, xaml

我希望[我上一个问题](https://stackoverflow.com/questions/672005/c-find-treeviewitem-to-drop-data)的答案能帮助我解决这个问题，但事实并非如此。最初的情况几乎相同：

```
<TreeView ItemsSource="{Binding Groups}" Name="tvGroups" AllowDrop="True">
          <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate ItemsSource="{Binding Participants}">
                          <StackPanel Orientation="Horizontal" Drop="tvDrop" Tag="{Binding .}">
                               <TextBlock Text="{Binding Name}" />
                               <Button Tag="{Binding .}" Click="Button_Click_2">
                                    <Image Source="Resources/cross.png" />
                                </Button>
                          </StackPanel>
                          <HierarchicalDataTemplate.ItemTemplate>
                              <DataTemplate>
                                  <StackPanel Orientation="Horizontal" >
                                       <TextBlock Text="{Binding Alias}" />
                                       <Button Tag="{Binding .}" Name="btnDeleteParticipants" Click="btnParticipants_Click" >
                                            <Image Source="Resources/cross.png" />
                                       </Button>
                                  </StackPanel>
                              </DataTemplate>
                          </HierarchicalDataTemplate.ItemTemplate>
                    </HierarchicalDataTemplate>
          </TreeView.ItemTemplate>
</TreeView> 
```

* * *

```
 private void btnParticipants_Click(object sender, RoutedEventArgs e)//Probanten aus Gruppe entfernen
        {
            Participant p = ((sender as Button).Tag as Participant);
            if (p == null) return;
            //TODO: Raus bekommen in welcher Gruppe ich löschen will

        } 
```

我想通过单击按钮（btnDeleteParticipants）`Participant p`从 a中删除。`Group`我试过这样的东西：

```
Control c = sender as Control;
while (!(c is TreeViewItem))
     c = (c.Parent) as Control; 
```

但这不起作用（不要问为什么，我不确定）。我可以`Group`通过检查它是否包含`Participant`（绑定到`btnDeleteParticipants.Tag`）来找到它，但这将不允许参与者在超过 1 个组中。那么，任何想法如何获得正确的`Group`？

**编辑：**

```
Groups = new ObservableCollection<Group>();
Participants = new ObservableCollection<Participant>(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T17:50:12.580

组和参与者是 ObservableCollection 对象吗？

尝试使用这个：

```
static TObject FindVisualParent<TObject>(UIElement child) where TObject : UIElement
{
  if (child == null)
  {
    return null;
  }

  UIElement parent = VisualTreeHelper.GetParent(child) as UIElement;

  while (parent != null)
  {
    TObject found = parent as TObject;
    if (found != null)
    {
      return found;
    }
    else
    {
      parent = VisualTreeHelper.GetParent(parent) as UIElement;
    }
  }

  return null;
} 
```

另外，尝试使用 DataContext 获取参与者并将 Tag 设置为 TemplatedParent。

```
<Button Tag="{Binding RelativeSource={RelativeSource TemplatedParent}}" /> 
```

然后点击

```
private void btnParticipants_Click(object sender, RoutedEventArgs e)
{
  var button = sender as Button;
  var p = button.DataContext as Participant;
  if (p == null) return;

  var t= FindVisualParent<TreeViewItem>(button); // get the Participants TreeViewItem
  if (t == null) return;
  var groupTreeItem = FindVisualParent<TreeViewItem>(t);  // get the groups TreeViewItem
  if (groupTreeItem == null) return;
  var group = groupTreeItem.DataContext as Group;
  group.Participants.Remove(p);
} 
```

# c++ - Windows Mobile 中 atof 的 Unicode 版本在哪里

> ID：674456
> 
> 赞同：1
> 
> 时间：2009-03-23T17:43:22.907
> 
> 标签：c++, windows-mobile, windows-ce

我有一个 C++ 应用程序，出于性能原因，我用 atoi、atof 等替换了许多 sscanf 函数。该代码基于 TCHAR，因此 _stscanf 被 _ttoi 和[_ttof](http://msdn.microsoft.com/en-us/library/hc25t012%28VS.80%29.aspx)取代。除了在 Windows Mobile 5 上没有 _ttof，甚至没有 _wtof 来支持明确的宽字符。我最终改用了_tcstod，但这需要一个我不太感兴趣的额外参数。所以任何想法为什么在Windows Mobile 5.0 中没有_ttof、_tcstof() 或_wtof。 [它在 VS2005 中](http://msdn.microsoft.com/en-us/library/hc25t012%28VS.80%29.aspx)。我在这里错过了一些非常明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T18:04:01.470

Windows Mobile 的问题之一是设备上 RAM 和 ROM 的大小。因此，删除了许多冗余例程以确保操作系统尽可能小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T23:06:59.603

如果您要转换的数据保证仅在 ASCII 字符集中，您始终可以将其转换为 ASCII 和 cat atof、atol、atoi 和朋友。

我的意思是，如果你有这样的东西（伪代码）：

```
TCHAR buf_T[20]=_T("12345");
char buf_char[20];

from_TCHAR_to_ascii(buf_T,buf_char);

atoi(buf_char); 
```

# asp.net-mvc - ASP.NET MVC：使用 UrlHelper 的单元测试控制器

> ID：674458
> 
> 赞同：170
> 
> 时间：2009-03-23T17:43:29.193
> 
> 标签：asp.net-mvc, unit-testing, urlhelper

我的控制器操作之一，即在 Ajax 请求中调用的操作，正在向客户端返回一个 URL，以便它可以进行重定向。我正在使用`Url.RouteUrl(..)`并且在我的单元测试期间由于`Controller.Url`参数未预填充而失败。

我尝试了很多东西，其中包括尝试存根`UrlHelper`（失败），手动创建一个`UrlHelper`带有`RequestContext`存根的 a （调用失败）`HttpContextBase`。`RouteCollection.GetUrlWithApplicationPath`

我搜索了谷歌，但几乎没有找到关于这个主题的任何内容。我`Url.RouteUrl`在控制器动作中使用了一些非常愚蠢的东西吗？有没有更简单的方法？

更糟糕的是，我希望能够在我的单元测试中测试返回的 URL - 实际上我只对知道它重定向到正确的路由感兴趣，但是因为我返回的是 URL 而不是路线，我想控制已解析的 URL（例如，通过使用 stubbed `RouteCollection`） - 但我很乐意让我的测试开始通过。

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2009-03-23T21:18:03.860

这是我针对类似情况的测试之一（xUnit + Moq）（在控制器中使用 Url.RouteUrl）

希望这可以帮助：

```
var routes = new RouteCollection();
MvcApplication.RegisterRoutes(routes);

var request = new Mock<HttpRequestBase>(MockBehavior.Strict);
request.SetupGet(x => x.ApplicationPath).Returns("/");
request.SetupGet(x => x.Url).Returns(new Uri("http://localhost/a", UriKind.Absolute));
request.SetupGet(x => x.ServerVariables).Returns(new System.Collections.Specialized.NameValueCollection());

var response = new Mock<HttpResponseBase>(MockBehavior.Strict);
response.Setup(x => x.ApplyAppPathModifier("/post1")).Returns("http://localhost/post1");

var context = new Mock<HttpContextBase>(MockBehavior.Strict);
context.SetupGet(x => x.Request).Returns(request.Object);
context.SetupGet(x => x.Response).Returns(response.Object);

var controller = new LinkbackController(dbF.Object);
controller.ControllerContext = new ControllerContext(context.Object, new RouteData(), controller);
controller.Url = new UrlHelper(new RequestContext(context.Object, new RouteData()), routes); 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2011-12-06T23:52:55.353

来自 eu-ge-ne 的修改实现。这个返回基于应用程序中定义的路由生成的链接。eu-ge-ne 的示例总是返回一个固定的响应。下面的方法将允许您测试正确的操作/控制器和路由信息是否正在传递到 UrlHelper - 如果您正在测试对 UrlHelper 的调用，这就是您想要的。

```
var context = new Mock<HttpContextBase>();
var request = new Mock<HttpRequestBase>();
var response = new Mock<HttpResponseBase>();
var session = new Mock<HttpSessionStateBase>();
var server = new Mock<HttpServerUtilityBase>();

context.Setup(ctx => ctx.Request).Returns(request.Object);
context.Setup(ctx => ctx.Response).Returns(response.Object);
context.Setup(ctx => ctx.Session).Returns(session.Object);
context.Setup(ctx => ctx.Server).Returns(server.Object);

request.SetupGet(x => x.ApplicationPath).Returns("/");
request.SetupGet(x => x.Url).Returns(new Uri("http://localhost/a", UriKind.Absolute));
request.SetupGet(x => x.ServerVariables).Returns(new NameValueCollection());

response.Setup(x => x.ApplyAppPathModifier(It.IsAny<string>())).Returns<string>(x => x);

context.SetupGet(x => x.Request).Returns(request.Object);
context.SetupGet(x => x.Response).Returns(response.Object);

var routes = new RouteCollection();
MvcApplication.RegisterRoutes(routes);
var helper = new UrlHelper(new RequestContext(context.Object, new RouteData()), routes); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-04-28T20:35:28.827

如果您想模拟 HttpContextBase 类，这篇文章可能很有用。

[http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-10T23:04:15.787

以@eu-ge-ne 的答案为基础，这对我有很大帮助：

我有一个执行重定向的 ActionResult 以及一个带有 FormCollection 参数的 UpdateModel 调用。为了使 UpdateModel() 工作，我必须将其添加到我的 Mocked HttpRequestBase：

```
FormCollection collection = new FormCollection();
collection["KeyName"] = "KeyValue";

request.Setup(x => x.Form).Returns(collection);
request.Setup(x => x.QueryString).Returns(new NameValueCollection()); 
```

要测试重定向的 URL 是否正确，您可以执行以下操作：

```
RedirectResult result = controller.ActionName(modelToSubmit, collection) as RedirectResult;
Assert.AreEqual("/Expected/URL", result.Url); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-27T11:37:51.963

[http://kbochevski.blogspot.com/2010/06/unit-testing-mvcnet.html](http://kbochevski.blogspot.com/2010/06/unit-testing-mvcnet.html)讨论了如何使用单元测试覆盖所有层。它使用 Rhino 和 MVC.Contrib 进行控制器测试。google 上的源代码可能会有很大帮助。

# django - 如何仅在管理界面中显示 Django 身份验证消息？

> ID：674464
> 
> 赞同：0
> 
> 时间：2009-03-23T17:44:54.790
> 
> 标签：django, admin, messages

Django 的身份验证消息对于通知 CMS 用户某些配置问题非常方便。问题是，如果您包含“django.core.context_processors.auth”上下文处理器，则在每次页面加载时都会删除消息，并且如果您想使用管理界面，则必须包含该处理器。

我尝试通过在调用 admin.site.root 之前匹配管理员 url / 之后将该处理器添加到 TEMPLATE_CONTEXT_PROCESSORS 来绕过它，但似乎到那时它已经导入了处理器列表。

那么有什么方法可以在不更改任何 Django 核心文件本身的情况下做到这一点，并且在最后可能之前完全从您的配置中省略 django Auth 应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T22:01:09.607

如果 Django 消息系统对我的站点至关重要，我会将消息添加到我的视图中，例如：

*   [与 Growl 集成](http://arstechnica.com/apple/news/2007/12/add-growl-notifications-to-your-django-apps.ars)
*   一些 javascript 模态对话框，例如[jQuery Alert Dialogs](http://abeautifulsite.net/notebook/87)

如果您真的需要破解它以便它们只显示在管理页面中，那么最简单的解决方案是复制 django.contrib.core.context_processors.py 中的 auth 函数并将其放入您自己的应用程序目录中的 context_processors.py 中。在 CONTEXT_PROCESSORS 堆栈中使用它而不是 django.core 版本并对其进行修改，使其查看 REQUEST url，并且仅`user.get_and_delete_messages()`在它是 admin url 时调用。

# java - 如何为 java/jsf 代码制作自己的解析器？

> ID：674466
> 
> 赞同：4
> 
> 时间：2009-03-23T17:45:16.443
> 
> 标签：java, parsing

您好我想制作自己的“解析器”，例如：计算 (4+(3-4^2))*2 或解析 java、jsf、html 代码。

事实上我做了这样的事情，但我觉得它不好。

有什么对我有好处吗？我试图阅读更多内容，但我有点困惑，LL、LR、AST、BNF、javacc yacc 等 :)。当我想计算 4+ 时，我不确定要走哪条路……

或者如果我想解析 java、jsf 代码并从中产生一些东西（另一个 java 代码）

有什么像ast一样好的东西吗？或者我可以同时使用的东西？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T18:00:00.323

首先，您必须了解解析的所有内容都基于**语法**。

语法根据如何将文本分解为基本单元以及如何以某种有意义的方式堆叠这些单元来描述您想要实现的语言。您可能还想查找**令牌**、**非终端**、**终端**概念。

LL 和 LR 之间的差异可以有两种：实现差异和语法编写差异。如果您使用标准工具，您只需要了解第二部分。

我通常使用 LL（自上而下）语法。即使使用自定义代码，它们也更易于编写和实现。LR 语法理论上涵盖了更多种类的语言，但在正常情况下，当您需要一些正确的错误检测时，它们只是一个障碍。

一些随机指针：

*   **javacc** (java, LL),
*   **antlr** (java, LL),
*   **yepp** (smarteiffel, LL),
*   **bison （古老的****yacc**的 C、LR、GNU 版本）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T17:48:39.837

解析器的编写可能非常激烈。语法的标准工具是 bison 或 yacc，语法的标准工具是 flex。这些都是 C 或 C++ 中的输出代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T17:49:39.040

[ANTLR](http://www.antlr.org/)可能是 Java 的必经之路。有点紧张，这本书显然非常好（我只在网上文档上苦苦挣扎）。

如果您可以扩展到其他语言，那么 lex/yacc（或 flex/bison）是 C 的标准，尽管我不会特别推荐其中任何一种组合（陡峭的学习曲线，现在显示它们的年龄有点）。

Python 有大约一百万个可用的解析器（SimpleParse，Yapps）或者有用于 Ruby 的 TreeTop - 开发人员甚至有一个演示，可以像您的问题一样进行简单的计算 - 但请注意，这不会完成 LALR 解析器可以完成的所有事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T17:51:55.600

ANTLR，但请确保您阅读[了 The Definitive ANTLR Reference](http://www.pragprog.com/titles/tpantlr/the-definitive-antlr-reference)，它将引导您完成解析器的创建。ANTLR 做自顶向下的 LL 解析器，所以本书没有涉及 LALR 和其他类型。

JavaCC、Yacc 和 SableCC 是更传统的词法分析器/解析器生成器，您会发现它们更原始一些，学习曲线更陡峭。ANTLR 同样强大，但您不必一次全部学习。Wikipedia 提供了解析器生成器的全面[比较](http://en.wikipedia.org/wiki/Comparison_of_parser_generators#Context-free_languages)。

BNF 是用于指定语法的语法；ANTLR 使用它自己的，我觉得它更美观，但其他人通常不这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T17:59:43.057

如果这是一个学习练习，请尝试从自上而下的解析器开始——它们易于编写，不需要包含/学习任何其他工具。研究基础知识的最佳地点可能是维基百科或代码项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T17:50:33.967

您可能想查看[http://antlr.org/](http://antlr.org/)。它将输出java代码。如果我记得，他们的样品之一就是你想要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T17:53:17.080

您可能想查看[Steven John Metsker 的 Building Parsers With Java](https://rads.stackoverflow.com/amzn/click/com/0201719622)。这本书似乎涵盖了你想要做的事情。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T17:53:20.060

使用生成 Lexers 和 Parsers 的工具通常比从头开始编写自己的工具要容易得多。

除了已经列出的内容之外，您还可以使用[JLex](http://www.cs.princeton.edu/~appel/modern/java/JLex/)和[CUP](http://www2.cs.tum.edu/projects/cup/)之类的东西来非常轻松地为算术表达式之类的东西创建一个简单的解释器。

# matlab - matlab如何判断一个矩阵是否为空？

> ID：674474
> 
> 赞同：10
> 
> 时间：2009-03-23T17:47:16.067
> 
> 标签：matlab

在我的 matlab 程序中，我想在继续之前确定函数的变量或输出是否为空。

实际上，我编写了一个函数来计算两条线段之间的交点。如果没有交集，则函数不返回任何内容（因此函数分配的变量将为空矩阵）。

我知道我可以使用`size`函数，但有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-23T17:48:29.573

您可以使用[`isempty`](http://www.mathworks.com/help/matlab/ref/isempty.html). 例如：

```
>> isempty([])

ans =
     1

>> isempty([42])

ans =
     0 
```

# c# - 如何从文件的完整路径中获取目录？

> ID：674479
> 
> 赞同：588
> 
> 时间：2009-03-23T17:49:13.673
> 
> 标签：c#, .net, file, file-io, directory

获取文件所在目录的最简单方法是什么？我正在使用它来设置工作目录。

```
string filename = @"C:\MyDirectory\MyFile.bat"; 
```

在这个例子中，我应该得到“C:\MyDirectory”。

* * *

## 回答 #1

> 赞同：933
> 
> 时间：2009-03-23T17:52:23.573

如果您确定有绝对路径，请使用[`Path.GetDirectoryName(path)`](http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx).

如果您可能只获得一个相对名称，请使用`new FileInfo(path).Directory.FullName`.

请注意，`Path`和`FileInfo`都位于命名空间中`System.IO`。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2009-03-23T17:52:57.987

```
System.IO.Path.GetDirectoryName(filename) 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2009-03-23T17:52:44.133

```
Path.GetDirectoryName(filename); 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-03-23T17:53:47.127

您可以使用`System.IO.Path.GetDirectoryName(fileName)`，或将路径变成`FileInfo`using `FileInfo.Directory`。

如果您正在使用该路径做其他事情，则`FileInfo`该类可能具有优势。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2009-03-23T17:52:45.863

您可以使用`Path.GetDirectoryName`并传入文件名。

[MSDN 链接](http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2014-05-27T21:40:52.993

如果您正在使用一个`FileInfo`对象，那么有一种简单的方法可以`string`通过该`DirectoryName`属性提取目录完整路径的表示。

`FileInfo.DirectoryName`通过 MSDN对属性的描述：

> 获取表示目录完整路径的字符串。

示例用法：

```
string filename = @"C:\MyDirectory\MyFile.bat";
FileInfo fileInfo = new FileInfo(filename);
string directoryFullPath = fileInfo.DirectoryName; // contains "C:\MyDirectory" 
```

链接到[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.io.fileinfo.directoryname.aspx)。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-07-01T16:14:52.003

您可以使用以下方法获取当前的应用程序路径：

```
string AssemblyPath = Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location).ToString(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-01T16:19:34.983

首先，您必须使用 System.IO 命名空间。然后;

```
string filename = @"C:\MyDirectory\MyFile.bat";
string newPath = Path.GetFullPath(fileName); 
```

或者

```
string newPath = Path.GetFullPath(openFileDialog1.FileName)); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-28T11:49:49.543

您可以`Path.GetFullPath`在大多数情况下使用。但是如果你想在文件名相对定位的情况下也获取路径，那么你可以使用下面的通用方法：

```
string GetPath(string filePath)
{
  return Path.GetDirectoryName(Path.GetFullPath(filePath))
} 
```

例如：

`GetPath("C:\Temp\Filename.txt")`返回`"C:\Temp\"`

`GetPath("Filename.txt")`返回`current working directory`喜欢`"C:\Temp\"`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-17T14:44:23.413

就我而言，我需要找到（目录的）完整路径的目录名称，所以我只是做了：

```
var dirName = path.Split('\\').Last(); 
```

# reporting-services - 如何将 SQL Server 2000 报告迁移到 SQL Server 2005/2008？

> ID：674492
> 
> 赞同：0
> 
> 时间：2009-03-23T17:51:36.257
> 
> 标签：reporting-services

谁能解释如何将 SQL Server 2000 报告导入或迁移到 SQL Server 2005 或 2008？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T18:24:18.707

大多数情况下，您只需要将数据从旧 ReportServer 数据库移植到新数据库。例如，报表 RDL 存储在 Catalog 表中，您只需导入所有这些。该表还包括您定义的所有路径名。如您所料，订阅表包含所有已定义的订阅。

我没有在两者之间进行完整的迁移，但它应该相对简单——只需花一天左右的时间来匹配所有字段，然后运行它。

# python - 使用 Swig、python 包装 Patricia 尝试的问题

> ID：674494
> 
> 赞同：1
> 
> 时间：2009-03-23T17:52:17.193
> 
> 标签：python, c, pointers, swig

我正在尝试包装 Patricia Tries（Perl 的 NET::Patricia）以在 python 中公开。我在其中一门课上遇到困难。

因此，从 python 中查看的 patricia 节点（下图）的实例具有“数据”属性。阅读它很好，但写入它会中断。

```
typedef struct _patricia_node_t {
   u_int bit;           /* flag if this node used */
   prefix_t *prefix;        /* who we are in patricia tree */
   struct _patricia_node_t *l, *r;  /* left and right children */
   struct _patricia_node_t *parent;/* may be used */
   void *data;          /* pointer to data */
   void *user1;         /* pointer to usr data (ex. route flap info) */
} patricia_node_t; 
```

具体来说：

```
>>> N = patricia.patricia_node_t()
>>> assert N.data == None
>>> N.data = 1
TypeError: in method 'patricia_node_t_data_set', argument 2 of type 'void *' 
```

现在我的C很弱。从我在 SWIG 书中读到的内容来看，我认为这意味着我需要向它传递一个指向数据的指针。根据[书](http://www.swig.org/Doc1.3/Python.html#Python_nn18)：

> 此外，如果您需要将原始指针值传递给一些外部 python 库，您可以通过将指针对象转换为整数来实现...但是，反向操作是不可能的，即，您无法构建 Swig来自原始整数值的指针对象。

问题：

1.  我理解正确吗？
2.  我该如何解决这个问题？% 扩展了吗？打字机？细节会很有帮助。

笔记：

1.  我无法更改 C 源代码，但我可以在其他 .h 文件或接口 .i 文件中对其进行扩展。
2.  据我了解，“数据”字段应该能够包含“任何东西”，以获得我不知道的“任何东西”的一些合理价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-26T20:58:55.633

我有一段时间没有使用 SWIG，但我很确定您想要使用一个类型映射，它将采用 a`PyObject*`并将其转换为所需的类型`void*`，反之亦然。当然，一定要跟踪引用计数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:25:06.283

看起来您应该向 SWIG 传递一个指向整数的指针。例如，如果这一切都在 C 中，您的错误将是这样的：

```
void set(struct _patricia_node_t *tree, void *data) {
     tree->data = data;
}

...

int value = 1;
set(tree, &value); // OK! HOORAY!
set(tree,  value); // NOT OK! FIRE SCORPIONS! 
```

在我看来，您正在做的 Python 相当于`set(tree, value)`. 现在我不是 SWIG 的专家，但也许你可以传递一个元组而不是一个整数？`N.data = (1,)`行得通吗？这是[Allegro CL + SWIG](http://www.franz.com/support/tech_corner/swig111605.lhtml)示例建议的答案，但我不知道它对 Python 的适用程度如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-26T19:19:06.267

另一种方法是使用[PyRadix](http://www.mindrot.org/projects/py-radix/)，它使用相同的底层代码。

# asp.net - 使用 msbuild 发布网站

> ID：674501
> 
> 赞同：6
> 
> 时间：2009-03-23T17:53:17.313
> 
> 标签：asp.net, visual-studio, msbuild

> **可能重复：**
> [如何使用 MSBuild 发布 Asp.net Web 应用程序？](https://stackoverflow.com/questions/48550/how-do-i-publish-a-asp-net-web-application-using-msbuild)

如何通过命令行使用 msbuild 发布 Web 应用程序或插入批处理文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T18:06:16.377

我想知道你到底想做什么。它只是将您的文件复制到部署服务器还是还包括设置 IIS？

MSBuild 具有用于复制和构建的内置任务，但不包括 IIS 任务。为此，我建议找到一个任务库，例如 MSBuild 扩展包或 MSBuild 社区任务。

[http://www.codeplex.com/MSBuildExtensionPack/](http://www.codeplex.com/MSBuildExtensionPack/)

[http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-25T12:28:06.267

如果这是一个 Web 应用程序项目，您只需构建 sln/项目，然后将发布的网站文件复制到任何位置

如果它是一个网站，那么您可以使用 ASPNetCompiler 任务

```
<AspNetCompiler
      Clean="true"
      Debug="true"
      VirtualPath="/"
      PhysicalPath="$(BuildDir)\"
      TargetPath="$(BuildDir)\Publish\"
      Updateable="true"
      FixedNames="true"
      Force="true" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T17:58:03.573

您所说的称为 Web 部署，您可以在此处找到有关如何执行此操作的信息：

[http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/28/vs-2008-web-deployment-project-support-released.aspx)

# python - 如何遍历按值排序的 Python 字典？

> ID：674509
> 
> 赞同：28
> 
> 时间：2009-03-23T17:55:11.117
> 
> 标签：python

我有一本像这样的字典：

```
{ 'a': 6, 'b': 1, 'c': 2 } 
```

*我想通过 value*而不是 key来迭代它。换句话说：

```
(b, 1)
(c, 2)
(a, 6) 
```

最直接的方法是什么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-03-23T17:59:20.327

```
sorted(dictionary.items(), key=lambda x: x[1]) 
```

对于那些讨厌 lambda 的人 :-)

```
import operator
sorted(dictionary.items(), key=operator.itemgetter(1)) 
```

但是`operator`版本需要 CPython 2.5+

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-23T19:02:36.493

对于非 Python 3 程序，您将希望使用 iteritems 来提高生成器的性能，生成器一次生成一个值，而不是一次返回所有值。

```
sorted(d.iteritems(), key=lambda x: x[1]) 
```

对于更大的字典，我们可以更进一步，让关键函数[在 C 中](http://svn.python.org/projects/python/trunk/Modules/operator.c)而不是 Python 中，就像现在使用 lambda 一样。

```
import operator
sorted(d.iteritems(), key=operator.itemgetter(1)) 
```

万岁！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-08-29T20:36:06.780

**[使用namedtuple](http://docs.python.org/library/collections.html#collections.namedtuple)**通常非常方便。例如，您有一个包含名称和分数的字典，并且想要按“分数”排序：

```
import collections
Player = collections.namedtuple('Player', 'score name')
d = {'John':5, 'Alex':10, 'Richard': 7} 
```

首先以最低分排序：

```
worst = sorted(Player(v,k) for (k,v) in d.items()) 
```

首先以最高分排序：

```
best = sorted([Player(v,k) for (k,v) in d.items()], reverse=True) 
```

'key' 和 'value' 在列出的元组中的顺序是 (value, key)，但是现在你可以得到名字和分数，比如说第二好的玩家 (index=1) 非常 Python 像这样：

```
 player = best[1]
    player.name
        'Richard'
    player.score
         7 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-23T18:07:00.073

该`items`方法为您提供 (key,value) 元组列表，可以使用`sorted`自定义排序键对其进行排序：

```
Python 2.5.1 (r251:54863, Jan 13 2009, 10:26:13) 

>>> a={ 'a': 6, 'b': 1, 'c': 2 }
>>> sorted(a.items(), key=lambda (key,value): value)
[('b', 1), ('c', 2), ('a', 6)] 
```

在 Python 3 中，必须将 lambda 表达式更改为`lambda x: x[1]`.

# php - 不同 OpenID 提供者和 Facebook 的通用接口

> ID：674510
> 
> 赞同：1
> 
> 时间：2009-03-23T17:55:14.783
> 
> 标签：php, openid, facebook, authorization

[使用https://rpxnow.com/](https://rpxnow.com/)登录使用不同的服务时堆栈是否溢出？如果是这样，它是否很好，是否有很好的（最好是免费的，最好是使用 PHP API）替代品？

我正在寻找的是一个登录页面，它允许用户使用主要的网络开放 ID 提供商 + Facebook 连接登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T05:41:16.443

No, StackOverflow does not use RPXNow. And if you choose to use it be careful to avoid [its pitfalls](http://blog.nerdbank.net/2009/01/why-using-rpxnow-is-bad-idea.html).

I suggest you just accept OpenID, which covers many, many Providers (who uses Facebook but doesn't use one of Google, Yahoo, and (soon) Microsoft?). Besides, I expect as an OpenID supporter, Facebook will eventually become an OpenID Provider too. So I suggest you save yourself the trouble and just support OpenID using one of the PHP OpenID libraries since that is your language.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T17:58:40.407

我记得注册了 RPX 并能够在他们的网站上轻松找到 PHP 示例。

另外，我不相信堆栈溢出会使用它，但我可能是错的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-27T09:24:36.990

为了完整起见，www.clickpass.com 与 RPXNow 非常相似。然而，它也有它的批评者。[http://notsorelevant.com/2008-03-11/clickpass-i-dont-get-it/](http://notsorelevant.com/2008-03-11/clickpass-i-dont-get-it/)

# unix - 如何使用另一个文件作为输入搜索文件目录并将输出发送到另一个文件？

> ID：674512
> 
> 赞同：2
> 
> 时间：2009-03-23T17:56:34.157
> 
> 标签：unix, search, file, awk, grep

我正在使用 Unix 系统。我有一个名为 MailHistory 的文件目录。目录中的每个文件都包含前一天的所有电子邮件。
这些文件在午夜创建并以时间戳命名。因此，典型的文件名是 20090323000100。

我有一个包含名称列表的文件。使用这个文件作为输入，我需要搜索 MailHistory 目录。搜索结果只需要返回包含被搜索名称的文件的文件名。

这是文件中名称的示例：GADDIS、SHUREE V. HERWEYER、JILL RENEE KAPENGA、TRICIA JAMI MOTON、VIOLA NELSON、TAMMY K OBERLIN、DAVID LYNN PALS、WILLIAM BRYANT PEARSON-BUNCH、ELESE

电子邮件将具有相同格式的名称（LASTNAME、FIRSTNAME MIDDLENAME）和大小写（大写）。我想将输出发送到文件。

提前致谢，科里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T19:26:25.577

grep -rlFf names_file MailHistory > 匹配

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:05:40.250

猫名单 | xargs -I{} grep -l "SHUREE V\.HERWEYER" {} > 匹配

请记住，您需要在搜索字符串中转义 () 点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T18:15:28.773

```
grep -l SEARCH_TERM -r MailHistory 
```

或者，如果您不想递归检查目录：

```
cd MailHistory; grep -l SEARCH_TERM *; cd - 
```

# python - 如何将字典转换为元组列表？

> ID：674519
> 
> 赞同：244
> 
> 时间：2009-03-23T17:58:32.077
> 
> 标签：python, list, dictionary

如果我有这样的字典：

```
{'a': 1, 'b': 2, 'c': 3} 
```

我怎样才能把它转换成这个？

```
[('a', 1), ('b', 2), ('c', 3)] 
```

我怎样才能把它转换成这个？

```
[(1, 'a'), (2, 'b'), (3, 'c')] 
```

* * *

## 回答 #1

> 赞同：391
> 
> 时间：2009-03-23T18:01:38.387

```
>>> d = { 'a': 1, 'b': 2, 'c': 3 }
>>> list(d.items())
[('a', 1), ('c', 3), ('b', 2)] 
```

[对于 Python 3.6 及更高版本](https://stackoverflow.com/a/39980744/353337)，列表的顺序是您所期望的。

在 Python 2 中，您不需要`list`.

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2009-03-23T18:19:15.520

由于没有其他人这样做，我将添加 py3k 版本：

```
>>> d = { 'a': 1, 'b': 2, 'c': 3 }
>>> list(d.items())
[('a', 1), ('c', 3), ('b', 2)]
>>> [(v, k) for k, v in d.items()]
[(1, 'a'), (3, 'c'), (2, 'b')] 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-03-23T18:02:50.210

您可以使用列表推导。

```
[(k,v) for k,v in a.iteritems()] 
```

会得到你`[ ('a', 1), ('b', 2), ('c', 3) ]`和

```
[(v,k) for k,v in a.iteritems()] 
```

另一个例子。

[如果你愿意，可以阅读更多关于列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)的内容，你可以用它们做什么非常有趣。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-08-30T19:03:29.810

**创建一个命名元组列表**

**[使用namedtuple](http://docs.python.org/library/collections.html#collections.namedtuple)**通常非常方便。例如，您有一个字典，'name' 作为键，'score' 作为值，例如：

```
d = {'John':5, 'Alex':10, 'Richard': 7} 
```

您可以将项目列为元组，如果您愿意，可以排序，并获取名称和分数，假设得分最高（索引=0）的玩家非常Python 像这样：

```
>>> player = best[0]

>>> player.name
        'Alex'
>>> player.score
         10 
```

这该怎么做：

**以随机顺序列出或保持[collections.OrderedDict](http://docs.python.org/library/collections.html#collections.OrderedDict)的顺序：**

```
import collections
Player = collections.namedtuple('Player', 'name score')
players = list(Player(*item) for item in d.items()) 
```

**按顺序，按值（'score'）排序：**

```
import collections
Player = collections.namedtuple('Player', 'score name') 
```

首先以最低分数排序：

```
worst = sorted(Player(v,k) for (k,v) in d.items()) 
```

首先以最高分排序：

```
best = sorted([Player(v,k) for (k,v) in d.items()], reverse=True) 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-23T18:01:41.960

```
[(k,v) for (k,v) in d.iteritems()] 
```

和

```
[(v,k) for (k,v) in d.iteritems()] 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-03-23T18:02:38.837

你想要的是`dict`'s`items()`和`iteritems()`方法。`items`返回 (key,value) 元组的列表。由于元组是不可变的，它们不能被反转。因此，您必须迭代项目并创建新元组以获取反转的 (value,key) 元组。对于迭代，`iteritems`最好使用生成器来生成 (key,value) 元组，而不必将整个列表保存在内存中。

```
Python 2.5.1 (r251:54863, Jan 13 2009, 10:26:13) 
[GCC 4.0.1 (Apple Inc. build 5465)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> a = { 'a': 1, 'b': 2, 'c': 3 }
>>> a.items()
[('a', 1), ('c', 3), ('b', 2)]
>>> [(v,k) for (k,v) in a.iteritems()]
[(1, 'a'), (3, 'c'), (2, 'b')]
>>> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-06-30T11:25:40.297

这些是 Python 3.x 和 Python 2.x 的重大变化

对于 Python3.x 使用

```
dictlist = []
for key, value in dict.items():
    temp = [key,value]
    dictlist.append(temp) 
```

对于 Python 2.7 使用

```
dictlist = []
for key, value in dict.iteritems():
    temp = [key,value]
    dictlist.append(temp) 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-23T18:12:51.400

```
>>> a={ 'a': 1, 'b': 2, 'c': 3 }

>>> [(x,a[x]) for x in a.keys() ]
[('a', 1), ('c', 3), ('b', 2)]

>>> [(a[x],x) for x in a.keys() ]
[(1, 'a'), (3, 'c'), (2, 'b')]

```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2015-05-15T10:02:44.207

通过`keys()`和`values()`方法的字典和`zip`。

`zip`将返回一个像有序字典一样的元组列表。

**演示：**

```
>>> d = { 'a': 1, 'b': 2, 'c': 3 }
>>> zip(d.keys(), d.values())
[('a', 1), ('c', 3), ('b', 2)]
>>> zip(d.values(), d.keys())
[(1, 'a'), (3, 'c'), (2, 'b')] 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2016-08-23T09:31:01.237

```
d = {'John':5, 'Alex':10, 'Richard': 7}
list = []
for i in d:
   k = (i,d[i])
   list.append(k)

print list 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2019-10-31T10:21:35.423

另一种选择是

```
list(dictionary.items())  # list of (key, value) tuples
list(zip(dictionary.values(), dictionary.keys()))  # list of (value, key) tuples 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-13T07:23:57.997

Python3`dict.values()`不返回列表。这是示例

```
mydict = {
  "a": {"a1": 1, "a2": 2},
  "b": {"b1": 11, "b2": 22}
}

print(mydict.values())
> output: dict_values([{'a1': 1, 'a2': 2}, {'b1': 11, 'b2': 22}])

print(type(mydict.values()))
> output: <class 'dict_values'>

print(list(mydict.values()))
> output: [{'a1': 1, 'a2': 2}, {'b1': 11, 'b2': 22}]

print(type(list(mydict.values())))
> output: <class 'list'> 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-11-17T05:43:55.400

```
x = {'a': 1, 'b': 2, 'c': 4, 'd':3}   
sorted(map(lambda x : (x[1],x[0]),x.items()),key=lambda x : x[0]) 
```

让我们把上面的代码分成几个步骤

```
step1 = map(lambda x : (x[1],x[0]),x.items()) 
```

> **x[1]：值**
> **x[0]：键**

Step1 将创建一个包含 (value,key) 形式的对的元组列表，例如 (4,'c')

```
step2 = sorted(step1,key=lambda x : x[0]) 
```

Step2 从 Step 1 中获取输入并使用元组的第一个值进行排序

# vb.net - 正则表达式缺少空值？

> ID：674521
> 
> 赞同：0
> 
> 时间：2009-03-23T17:58:59.127
> 
> 标签：vb.net, regex, linq, csv

```
Dim re As New Regex("((?<field>[^"",\r\n]+)|""(?<field>([^""]|"""")+)"")((?<rowbreak>,\r\n|\r\n|\n|$)|,)")

3700,Collin,Franc,,franc@domain.com,Collins,Francine,,franc@domain.com,"Enel North America, Inc.",One T Drive,Suite 220,MyCity,MA,77774,1,traci@domain.com,,,,,3700,
3701,Steur,Larry,,larry@domain.com,Steur,Larry,,larry@domain.com,"St. Petersburg Corp, Inc.",10490 Gady Blvd,,MyCity,FL,33772,1,victor@domain.com,,,,,3701
3705,Giger,Tina,CFO,tina@mydomain.com,Giger,Tina,CFO,tina@mydomain.com,Net Technologies,23 Calab Rd,Suite 202,Calabas,CA,77777,1,Mark@mydomain.com,,,,,3705, 
```

我正在使用的 RegEx 不起作用，因为如果有空列，它会将下一列“滑动”到它的位置。我可以做些什么来允许以下内容为每行制作五列？

```
1,2,3,4,5
Test,,,Test,
Test,,Test,, 
```

这是我的完整代码：

```
<%@ Page Language="VB" MasterPageFile="~/_Common/MasterPage.master" %>

<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.IO" %>
<%@ Import Namespace="System.Text.RegularExpressions" %>
<%@ Import Namespace="System.Xml" %>

<script runat="server">

    Private Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)

        ' call the parser
        Dim dt As DataTable = ParseCSVFile(Server.MapPath("Documents/Test.csv"))

        ' bind the resulting DataTable to a DataGrid Web Control
        GridView1.DataSource = dt
        GridView1.DataBind()
    End Sub

    Public Function ParseCSV(ByVal inputString As String) As DataTable

        Dim dt As New DataTable()

        ' declare the Regular Expression that will match versus the input string
        Dim re As New Regex("((?<field>[^"",\r\n]+)|""(?<field>([^""]|"""")+)"")((?<rowbreak>,\r\n|\r\n|\n|$)|,)")

        Dim colArray As New ArrayList()
        Dim rowArray As New ArrayList()

        Dim colCount As Integer = 0
        Dim maxColCount As Integer = 0
        Dim rowbreak As String = ""
        Dim field As String = ""

        Dim mc As MatchCollection = re.Matches(inputString)

        For Each m As Match In mc

            ' retrieve the field and replace two double-quotes with a single double-quote
            field = m.Result("${field}").Replace("""""", """")

            rowbreak = m.Result("${rowbreak}")

            If field.Length > 0 Then
                colArray.Add(field)
                colCount += 1
            End If

            If rowbreak.Length > 0 Then

                ' add the column array to the row Array List
                rowArray.Add(colArray.ToArray())

                ' create a new Array List to hold the field values
                colArray = New ArrayList()

                If colCount > maxColCount Then
                    maxColCount = colCount
                End If

                colCount = 0
            End If
        Next

        If rowbreak.Length = 0 Then
            ' this is executed when the last line doesn't
            ' end with a line break
            rowArray.Add(colArray.ToArray())
            If colCount > maxColCount Then
                maxColCount = colCount
            End If
        End If

        ' create the columns for the table
        For i As Integer = 0 To maxColCount - 1
            dt.Columns.Add([String].Format("col{0:000}", i))
        Next

        ' convert the row Array List into an Array object for easier access
        Dim ra As Array = rowArray.ToArray()
        For i As Integer = 0 To ra.Length - 1

            ' create a new DataRow
            Dim dr As DataRow = dt.NewRow()

            ' convert the column Array List into an Array object for easier access
            Dim ca As Array = DirectCast((ra.GetValue(i)), Array)

            ' add each field into the new DataRow
            For j As Integer = 0 To ca.Length - 1
                dr(j) = ca.GetValue(j)
            Next

            ' add the new DataRow to the DataTable
            dt.Rows.Add(dr)
        Next

        ' in case no data was parsed, create a single column
        If dt.Columns.Count = 0 Then
            dt.Columns.Add("NoData")
        End If

        Return dt
    End Function

    Public Function ParseCSVFile(ByVal path As String) As DataTable

        Dim inputString As String = ""

        ' check that the file exists before opening it
        If File.Exists(path) Then

            Dim sr As New StreamReader(path)
            inputString = sr.ReadToEnd()
            sr.Close()

        End If

        Return ParseCSV(inputString)
    End Function

</script>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">

</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" Runat="Server">
    <asp:FileUpload ID="FileUpload1" runat="server" /> 
    <asp:Button ID="btnUpload" runat="server" Text="Upload" />
    <asp:GridView ID="GridView1" runat="server">
    </asp:GridView>
</asp:Content> 
```

实际上，我更喜欢使用 Linq 执行此操作，但我找不到任何使用包含引用值的 CSV 文件的示例（对于在值本身中包含逗号的值）。

****更新****

我将 RegEx 更改为此，它让我更接近：

```
Dim re As New Regex("(?<field>,)|((?<field>[^"",\r\n]+)|""(?<field>([^""]|"""")+)"")(,|(?<rowbreak>\r\n|\n|$))") 
```

现在它将所有数据放在正确的列中，但空列中只有一个逗号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T05:56:11.883

为什么要使用正则表达式？您有一个非常简单的解析工作 - 使用逗号作为分隔符，除非它们在引号内。因此，您可以逐个字符地遍历每一行，在点击开头引号时设置标志，并在点击结尾引号时取消设置。在“内部引用”时，您忽略逗号。（我放弃了尝试使用正则表达式来做到这一点）......试试这个：

```
private DataTable GetDataTableFromCsv(string csvContent)
    {
        DataTable dt = new DataTable();
        string all = csvContent;
        string[] lines = all.Split(new string[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries);
        foreach (String s in lines)
        {
            bool isInsideQuote = false;
            List<string> values = new List<string>();
            string accumulator = "";
            for (int j = 0; j < s.Length; j++)// (char c in s)
            {
                char c = s[j];
                if (c == '"')
                {
                    if (!isInsideQuote)
                    {
                        isInsideQuote = true;
                    }
                    else
                    {
                        isInsideQuote = false;
                    }
                    accumulator += "\"";
                }
                else if (c == ',' && !isInsideQuote)
                {
                    values.Add(accumulator);
                    accumulator = ""; //reset
                }
                else if (j == s.Length - 1)
                {
                    accumulator += c;
                    values.Add(accumulator);
                    accumulator = "";
                }
                else
                {
                    accumulator += c;
                }
            }
            //first time, create relevant columns
            if (dt.Columns.Count == 0)
            {
                foreach (string colExample in values)
                {
                    dt.Columns.Add();
                }
                //list of strings now contains an example.
            }
            DataRow dr = dt.NewRow();
            for (int i = 0; i < values.Count; i++)
            {
                dr[i] = values[i];
            }
            dt.Rows.Add(dr);
        }
        return dt;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-01T03:06:19.947

尝试这样的事情： `"(?<field1>.*),(?<field2>.*),(?<field3>.*),(?<field4>.*),(?<field5>.*)"`

# c - 通过 TCP 发送 int 数组时，为什么只有第一个数量是正确的？

> ID：674525
> 
> 赞同：1
> 
> 时间：2009-03-23T17:59:45.693
> 
> 标签：c, sockets, tcp

根据我之前的问题（[为什么从 TCP 套接字读取整数数组时我会得到奇怪的结果？](https://stackoverflow.com/questions/673799/why-do-i-get-weird-results-when-reading-an-array-of-integers-from-a-tcp-socket)），我想出了以下代码，它似乎可以工作。代码示例适用于少量数组元素，但一旦变大，数据最终会损坏。

这是通过 TCP 发送 int 数组的代码：

```
#define ARRAY_LEN 262144

long *sourceArrayPointer = getSourceArray();

long sourceArray[ARRAY_LEN];
for (int i = 0; i < ARRAY_LEN; i++)
{
    sourceArray[i] = sourceArrayPointer[i];
}

int result = send(clientSocketFD, sourceArray, sizeof(long) * ARRAY_LEN); 
```

这是接收 int 数组的代码：

```
#define ARRAY_LEN 262144

long targetArray[ARRAY_LEN];
int result = read(socketFD, targetArray, sizeof(long) * ARRAY_LEN); 
```

前几个数字很好，但在数组的下方，数字开始完全不同。最后，当数字应如下所示时：

```
0
0
0
0
0
0
0
0
0
0 
```

但他们实际上是这样出来的？

```
4310701
0
-12288
32767
-1
-1
10
0
-12288
32767 
```

这是因为我使用了错误的发送/接收大小吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T18:26:19.903

调用`read(..., len)`不`len`从套接字读取字节，它读取最大`len`字节数。您的数组相当大，它将被拆分为许多 TCP/IP 数据包，因此您的读取调用可能只返回数组的一部分，而其余部分仍在“传输中”。`read()`返回它收到的字节数，所以你应该再次调用它，直到你收到你想要的一切。你可以这样做：

```
long targetArray[ARRAY_LEN];

char *buffer = (char*)targetArray;
size_t remaining = sizeof(long) * ARRAY_LEN;
while (remaining) {
  ssize_t recvd = read(socketFD, buffer, remaining);
  // TODO: check for read errors etc here...
  remaining -= recvd;
  buffer += recvd;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-23T18:02:28.603

以下可以吗？

```
for (int i = 0; sourceArrayPointer < i; i++) 
```

您正在比较苹果和橙子（读取指针和整数）。由于指向`long`s 数组的指针 > 0（大多数情况下），因此不会执行此循环。因此，在接收端，您正在从一个未初始化的数组中读取数据，这会导致那些不正确的数字被传递）。

宁愿是：

```
for (int i = 0; i < ARRAY_LEN; i++) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T18:05:19.127

使用来自的函数`<net/hton.h>`

[http://en.wikipedia.org/wiki/Endianness#Endianness_in_networking](http://en.wikipedia.org/wiki/Endianness#Endianness_in_networking)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T18:07:58.870

与这个问题无关，但如果您想在不同平台上使用 TCP ，您还需要注意平台的[字节顺序。](http://en.wikipedia.org/wiki/Endianness#Endianness_in_networking)

如果可以选择使用 curl 或 ACE 之类的网络库，则要简单得多（此外，您还可以在更高级别学习更多，例如设计模式）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T18:17:47.397

没有什么可以保证 TCP 将如何将您发送到流的数据打包 - 它只保证它会在应用程序级别以正确的顺序结束。所以你需要检查结果的值，并继续阅读，直到你读到正确的字节数。否则，您将不会阅读全部数据。您使用长数组而不是字节数组使这对自己变得更加困难 - 数据可能以任意数量的块发送，这些块可能不会与长边界对齐。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-23T18:35:05.233

我看到这里有很多问题。首先，这就是我理解的重写您的发送代码的方式。我假设 getSourceArray 总是返回一个指向大小为 ARRAY_LEN 的静态或分配缓冲区的有效指针。我还假设您稍后在代码中不需要 sourceArrayPointer 。

```
#define ARRAY_LEN 262144

long *sourceArrayPointer = getSourceArray();

long sourceArray[ARRAY_LEN];
long *sourceArrayIdx = sourceArray;

for (; sourceArrayIdx < sourceArray+ARRAY_LEN ; )
    sourceArrayIdx++ = sourceArrayPointer++;

int result = send(clientSocketFD, sourceArray, sizeof(long) * ARRAY_LEN);
if (result < sizeof(long) * ARRAY_LEN)
    printf("send returned %d\n", result); 
```

查看您的原始代码，我猜您的 for 循环被搞砸了，并且从未执行，导致您发送内存中的任何随机垃圾文件 sourceArray 指向。基本上你的情况

```
sourceArrayPointer < i; 
```

几乎可以保证第一次失败。

# css - 覆盖 CSS 样式

> ID：674537
> 
> 赞同：8
> 
> 时间：2009-03-23T18:03:09.973
> 
> 标签：css, xhtml, overriding, stylesheet

在我们所有页面使用的全局样式表中，有以下行：

```
ul { margin: 0; }
li { list-style-type: none; padding-bottom: 3px; } 
```

因此，我的页面中的任何 ul 都呈现在 li 旁边没有光盘的情况。

但是，在特殊情况下，我需要将光盘显示在 li 旁边。

我有一个带有“博客文章”类的 div，尽管下面的内容对我有用。

```
.blog_body ul { list-style-type: disc; }
.blog_body ol { list-style-type: decimal; } 
```

然而，这并不能解决问题。

因此，使用以下 HTML 片段

```
<ul>
  <li>Testing</li>
</ul>
<ol>
  <li>Testing</li>
</ol> 
```

结果：

```
Testing
1\. Testing 
```

li 中仍然没有光盘嵌套在 ul 中。关于如何将它们带到那里的想法？我的 CSS-fu 很弱....

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T18:09:13.237

!important 不是必需的，因为特定于类的样式已经覆盖了全局样式。问题是因为在全局样式中您将边距设置为零。样式类型正在正确呈现，但您看不到它。这应该适合你：

```
.blog_body ul 
{
    list-style-type: disc; 
    margin: 1em;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T18:08:29.697

改变这个：

```
.blog_body ul { list-style-type: disc; }
.blog_body ol { list-style-type: decimal; } 
```

对此：

```
.blog_body ul li { list-style-type: disc; }
.blog_body ol li { list-style-type: decimal; } 
```

# git-svn - 如何将我的 git 修订历史复制到 svn 中？

> ID：674540
> 
> 赞同：0
> 
> 时间：2009-03-23T18:03:31.563
> 
> 标签：git-svn

我使用 Git，但我的一些同事现在无法离开 SVN。我们希望两个系统之间的集成是无缝的——到目前为止，我们所有的开发都是在 git 中进行的，所以我们需要将其复制到具有完整修订历史的 svn 中。

我已经能够对此进行调整，以便它在一次提交中复制存储库，但我希望它复制*所有*历史记录。我想这应该很容易使用 git svn dcommit 等，但它并没有以这种方式解决——合并似乎只作为一次提交进入，变基杀死 git-svn，并拉取只是合并。

所以，我在过去的几个小时里一直在尝试，但似乎无法得到它。Tailor 几乎可以工作，但在导入过程中死掉了，似乎是一个错误。

感谢所有帮助，再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-18T07:27:39.817

您是否尝试过创建 svn 存储库，git-svn 克隆它，从旧的 git 存储库（具有所有历史记录的存储库）中提取，git-rebase 这些更改到主分支，然后 git-svn dcommitting 更改到svn？这只是我的想法，但可能会奏效。

谷歌搜索“git svn export”也显示了这一点：http: [//kerneltrap.org/mailarchive/git/2008/10/29/3848124](http://kerneltrap.org/mailarchive/git/2008/10/29/3848124)这似乎与我刚刚描述的相似，但更详细和准确，其中应该带你到那里。

但是知道 Git - 我相信这对你来说是可能的:)

让我知道你是怎么办的！我也对这个问题感兴趣...

# java - Scala 等价于 new HashSet(Collection)

> ID：674545
> 
> 赞同：10
> 
> 时间：2009-03-23T18:05:27.893
> 
> 标签：java, scala, scala-collections

什么是Java等效的 Scala 构造函数（创建一个**不可变的）** `HashSet`

```
new HashSet<T>(c) 
```

`c`类型在哪里`Collection<? extends T>`？

我在`HashSet` *Object*中只能找到`apply`.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T18:42:16.853

最简洁的方法可能是使用`++`运算符：

```
import scala.collection.immutable.HashSet
val list = List(1,2,3)
val set = HashSet() ++ list 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-23T18:36:47.553

答案分为两部分。第一部分是采用 T* 的 Scala 可变参数方法是采用 Seq[T] 的方法的糖化。您告诉 Scala 将 Seq[T] 视为参数列表，而不是使用“seq : _*”的单个参数。

第二部分是将 Collection[T] 转换为 Seq[T]。Scala 的标准库中还没有通用的内置方法，但是一种非常简单（如果不一定有效）的方法是调用 toArray. 这是一个完整的例子。

```
scala> val lst : java.util.Collection[String] = new java.util.ArrayList
lst: java.util.Collection[String] = []

scala> lst add "hello"
res0: Boolean = true

scala> lst add "world"
res1: Boolean = true

scala> Set(lst.toArray : _*)
res2: scala.collection.immutable.Set[java.lang.Object] = Set(hello, world) 
```

注意 scala.Predef.Set 和 scala.collection.immutable.HashSet 是同义词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-07T23:34:27.183

从 Scala 2.13 开始使用伴生对象

```
import scala.collection.immutable.HashSet
val list = List(1,2,3)
val set = HashSet.from(list) 
```

# javascript - VS2008 中的 Javascript 调试器问题

> ID：674554
> 
> 赞同：1
> 
> 时间：2009-03-23T18:07:25.253
> 
> 标签：javascript, visual-studio-2008, debugging, breakpoints

我在用 VS2008 调试 javascript 时遇到了一个非常烦人的问题。

如果我只是按 F5（或从“调试”菜单中选择“开始调试”），将附加 iexplore 进程，但脚本中没有断点中断。脚本文档树甚至没有出现在解决方案资源管理器中。

我已经知道：

1.  我可以在 Javascript 中设置断点就好了。它不显示“此点不会被击中”消息。
2.  通过使用 'debugger' 关键字调用调试器可以正常工作，但附加到 iexplore 进程却不行，因为它会给出“进程已附加到调试器”消息。
3.  使用手册“附加到进程...”就可以了。脚本文档也会出现。
4.  该项目最近已从网站转换为 Web 应用程序。

我已经尝试过：

1.  清除 IE 缓存。
2.  关闭 VS2008，停止 IIS 并删除临时 asp.NET 文件，然后重新启动 IIS 和 VS2008。
3.  将 IE7 设置为 windows 和 VS2008 的默认浏览器。
4.  重置我的 VS2008 用户设置。
5.  检查是否启用了 IE 脚本调试。

到目前为止没有任何效果。虽然附加到进程并不太费力，但当我习惯于按 F5 时，这很烦人。

如果有人能想到解决方案，请（我在这里乞求！）让我知道！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T18:12:43.883

网站项目属性上是否启用了 Silverlight 调试？这将禁用 Javascript 调试。

# xml - 具有动态属性的 XSLT 转换问题

> ID：674558
> 
> 赞同：1
> 
> 时间：2009-03-23T18:08:09.243
> 
> 标签：xml, xslt

这是可行的：

```
$curRow[1]/@gridClose 
```

但可以说我不知道​​属性名称“gridclose”。我将循环并使用代码获取此属性。

使用调试器，我可以获得值“gridClose”：$curCol/@id。所以我试图得到类似的东西：

```
$curRow[1]/@{$curCol/@id} 
```

但它不起作用。知道我该怎么做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T18:20:44.813

也许是这样的：

```
$curRow[1]/@*[ name() = $curCol/@id ] 
```

# java - 列表的所有键，例如 VK_A..Z 供用户选择

> ID：674563
> 
> 赞同：0
> 
> 时间：2009-03-23T18:08:56.810
> 
> 标签：java, swing, list, combobox, keyboard-events

我正在制作一个允许用户自定义键盘快捷键的程序，为此我需要显示可用的键，在 java swing 中实现这一点的最佳方法是什么？

```
 KeyEvent.class.getDeclaredFields() 
```

我对下面的动态示例感兴趣，

```
keysLST.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "CTRL", "ALT", "SHIFT" })); 
```

我知道的一种方法是从 keyevent 类中获取所有内容，但我不确定如何将其集成到列表中。任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T18:16:34.637

无需从列表中选择，而是将 KeyListener 添加到任何组件（JTextField 有效）并在用户按下键时记录键代码。您也可以通过这种方式记录修饰符（ctrl、alt、shift）。

```
public void keyPressed(KeyEvent e)
{
    int keyTheUserJustPressed = e.getKeyCode();

    // then use for ctrl/alt/shift
    e.getModifiersEx();

    // or use
    e.isAltDown();
    e.isShiftDown();
} 
```

# ruby-on-rails - 如何解析远程网站并为字典工具提示的每个单词创建链接？

> ID：674565
> 
> 赞同：1
> 
> 时间：2009-03-23T18:09:25.560
> 
> 标签：ruby-on-rails, ruby, regex, parsing, tooltip

我想解析一个随机网站，修改内容，使每个单词都是一个链接（用于字典工具提示），然后在 iframe 中显示该网站。

我不是在寻找完整的解决方案，而是在寻找提示或可能的策略。链接是我的问题，解析网站并将其显示在 iframe 中非常简单。所以基本上我有一个包含所有 html 内容的字符串。我什至不确定是在服务器端还是在页面加载 JS 之后更好。

我正在使用 Ruby on Rails、jQuery、jRails。

注意：href 标记的内容取决于单词。

澄清：我尝试了一个正则表达式，它已经起作用了：

```
@site.gsub!(/[A-Za-z]+(?:['-][A-Za-z]+)?|\\d+(?:[,.]\\d+)?/) {|word| '<a href="">' + word + '</a>'} 
```

但问题是只替换文本中的单词并保持 HTML 不变。所以我想这是一个正则表达式问题......

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T19:17:19.127

我认为正则表达式不会为此工作 - 或者，至少，它总是很脆弱。更好的方法是使用[Hpricot](http://wiki.github.com/why/hpricot)或[Nokogiri](http://www.rubyinside.com/nokogiri-ruby-html-parser-and-xml-parser-1288.html)解析页面，然后通过它并修改纯文本节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T18:18:27.177

听起来你已经计划好了。

将内容拆分为单词，然后为每个单词创建一个链接，例如`<a href="http://dictionary.reference.com/dic?q=whatever&search=search">whatever</a>`

编辑（根据您的评论）：啊……我建议您四处搜索屏幕抓取技术。他们中的大多数应该从删除 < 和 > 字符之间的任何内容开始，并将 <br> 和 <p> 替换为换行符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T02:56:27.867

在您使用正则表达式之前，我会使用 Nokogiri 删除 HTML 结构。

```
no_html = Nokogiri::HTML(html_as_string).text 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-23T20:08:16.133

简单的。散列 HTML，运行正则表达式，然后取消散列 HTML。

```
<?php
class ht
{
    static $hashes = array();

    # hashes everything that matches $pattern and saves matches for later unhashing
    function hash($text, $pattern) { 
        return preg_replace_callback($pattern, array(self,'push'), $text);
    }

    # hashes all html tags and saves them
    function hash_html($html) {
        return self::hash($html, '`<[^>]+>`');
    }

    # hashes and saves $value, returns key
    function push($value) {
        if(is_array($value)) $value = $value[0];
        static $i = 0;
        $key = "\x05".++$i."\x06";
        self::$hashes[$key] = $value;
        return $key;
    }

    # unhashes all saved values found in $text
    function unhash($text) {
        return str_replace(array_keys(self::$hashes), self::$hashes, $text);
    }

    function get($key) {
        return self::$hashes[$key];
    }

    function clear() {
        self::$hashes = array();
    }
}
?> 
```

示例用法：

```
ht::hash_html($your_html);
// your word->href converter here
ht::unhash($your_formatted_html); 
```

哦...对，我是用 PHP 写的。猜猜你必须将它转换为 ruby​​ 或 js，但想法是一样的。

# c - 如何在 C 中将 UTF-8 转换为/从 UTF-16？

> ID：674575
> 
> 赞同：2
> 
> 时间：2009-03-23T18:13:55.737
> 
> 标签：c

是否有可用的库，还是我需要自己设计/编码？

目标平台很旧，编译器不提供`wchar_t`.

不允许使用任何库，因此纯 C 和标头将是合适的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T10:02:24.987

你也可以试试`iconv()`。在某些平台上，它是 C 运行时的一部分。

# jquery - jQuery：如何将超链接加载为 $.get 回调？

> ID：674581
> 
> 赞同：2
> 
> 时间：2009-03-23T18:15:54.903
> 
> 标签：jquery, hyperlink

如何在 $.get 请求发出之前延迟加载锚链接？我有

```
$("a.track").click(function() {
    $.get("track.php", { id: "page1.html" });
}); 
```

...但是在上述请求通过之前单击链接会加载新页面（我在 PHP 页面上的响应没有被记录）。如果我使用 停止链接`return false;`，$.get 请求会按预期工作，但现在链接不会加载。

我想做的是做类似的事情

```
$.get("track.php", { id: "page1.html" }, function() {
    return true;
}); 
```

...但是在执行此操作之前会加载新页面，因此无法按预期工作。

我怎样才能使这个链接的加载只在发送 GET 请求后发生？我并不真正关心从请求中获取结果，我只想在新页面加载之前发送它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T18:22:33.280

您可以向单击处理程序传递一个回调，该回调将在成功时重定向页面。

```
$("a.track").click(function(event) {
  event.preventDefault(); // Ignore user's click
  var href = $(this).attr('href');
  $.get("track.php", { id: "page1.html" }, function(data){
    window.location = href; // Redirect on success
  });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:21:15.873

```
$("a.track").click(function() {
    var that = this;
    $.get("track.php", { id: "page1.html" }, function(){
        $(that).attr('onclick', '').click();
    });
}); 
```

或类似的东西。你必须杀死你以前的点击事件处理 attr('onclick', '') 可能会也可能不会这样做。

# c# - 回发后可以访问对象 - ASP.NET

> ID：674586
> 
> 赞同：0
> 
> 时间：2009-03-23T18:17:39.113
> 
> 标签：c#, asp.net

我真的对这种行为感到困惑。谁可以给我解释一下这个？

我有以下类结构：

```
public abstract BaseUserControl : System.Web.UI.UserControl
{
  public List<string> listFieldMapper = new List<string>();
}

  public partial class Property : BaseUserControl
  {
    protected override void OnInit(EventArgs e)
    {
      base.OnInit(e);

      base.listFieldMapper.Add("test");
    }
  } 
```

在按钮的事件处理程序中（导致回发），我可以访问`base.listFieldMapper`

我的理解是，在回发之间，不维护状态，为了能够维护状态，使用 ViewState 对象。列表如何维护这些值？

附带说明一下，如果我设置`base.listFieldMapper`after `OnInit`(Ex: Load) 的值，则回发后我有一个空对象。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T18:47:53.860

我认为当按钮单击调用回发时：

1.  当服务器处理请求时，正在实例化用户控件的一个实例。
2.  然后服务器调用处理按钮单击的方法。

请求页面时（不处理按钮单击）：

1.  当服务器处理请求时，正在实例化用户控件的一个实例。
2.  然后服务器调用处理 Load 事件的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T21:17:23.937

ViewState 在这里不起作用。要让它跟踪任何内容，您需要在其中实际放入一些内容（大多数默认属性都可以）。

在您的情况下，第一种情况下的事件顺序是（在 init 上设置列表）：

```
Control.OnInit -> add value
Page.OnInit    -> value present
Page.OnLoad    -> value present
Control.OnLoad -> value present
#PostBack
Control.OnInit -> add value
Page.OnInit    -> value present
Page.OnLoad    -> value present
Control.OnLoad -> value present
Button.OnClick -> value present 
```

在第二种情况下（设置加载列表）：

```
Control.OnInit -> value absent
Page.OnInit    -> value absent
Page.OnLoad    -> value absent
Control.OnLoad -> add value
#PostBack
Control.OnInit -> value absent
Page.OnInit    -> value absent
Page.OnLoad    -> value absent
Control.OnLoad -> add value
Button.OnClick -> value present 
```

并且 listFieldMapper 本身在类构造函数中被分配，并且在控件生命周期的任何时候都将是非空的。

# zend-framework - 在 Zend 框架中使用表单

> ID：674596
> 
> 赞同：11
> 
> 时间：2009-03-23T18:19:57.297
> 
> 标签：zend-framework, forms, directory

我对 MVC 和 Zend 框架比较陌生。话虽如此，我觉得我很难弄清楚表单在我的目录结构中的位置。我有一个模块化的目录结构，所以我不知道是否应该有一个表单目录，或者每个模块目录中都有一个。

```
/application
    /modules/
        /default
            /controllers
            /views
        /admin
            /controllers
            /views 
```

一旦确定了表单的目录，是否将该目录设置在引导程序的包含路径中？或者您是否将表单包含在正在使用的控制器中？

*您*如何在 Zend 框架中使用表单？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-09-11T13:28:19.247

这有点晚了，但在当前版本的 ZF 中，这已经解决了：

在以下页面[http://framework.zend.com/manual/en/zend.loader.autoloader-resource.html](http://framework.zend.com/manual/en/zend.loader.autoloader-resource.html) 手册指出：

30.3.2\. 模块资源自动加载器 Zend 框架附带了 Zend_Loader_Autoloader_Resource 的具体实现，其中包含资源类型映射，涵盖了 Zend Framework MVC 应用程序的默认推荐目录结构。这个加载器 Zend_Application_Module_Autoloader 带有以下映射：

```
api/         => Api
forms/       => Form
models/      => Model
    DbTable/ => Model_DbTable
plugins/     => Plugin 
```

例如，如果您有一个前缀为“Blog_”的模块，并尝试实例化类“Blog_Form_Entry”，它将在资源目录的“forms/”子目录中查找名为“Entry.php”的文件。当使用 Zend_Application 的模块引导时，默认情况下会为每个离散模块创建一个 Zend_Application_Module_Autoloader 实例，允许您自动加载模块资源。

然而，这确实需要使用 Zend_Application

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-08-23T06:52:03.893

将此添加到 application/modules/yourmodule/Bootstrap.php 文件中。

```
class Yourmodule_Bootstrap extends Zend_Application_Module_Bootstrap
{

protected function _initAutoload()
    {
        $autoloader = new Zend_Application_Module_Autoloader(array(
            'namespace' => 'Yourmodule_',
            'basePath'  => APPLICATION_PATH .'/modules/yourmodule',
            'resourceTypes' => array (
                'form' => array(
                    'path' => 'forms',
                    'namespace' => 'Form',
                ),
                'model' => array(
                    'path' => 'models',
                    'namespace' => 'Model',
                ),
            )
        ));
        return $autoloader;
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T18:36:32.017

截至 09 年 3 月，ZF 的思想领袖似乎仍在争论组织一切的最佳方式。[作为 Zend_Tool 的一部分，](http://devzone.zend.com/article/3811-Using-Zend%5FTool-to-start-up-your-ZF-Project)有一个脚手架生成器，计划在 ZF v1.8 中发布。它目前在孵化器中，我上周尝试了它并且它可以工作，但是在它的当前状态下生成的组件并不多。

从我看到的示例中，它们似乎最好与它们交互的模型分开管理（这是来自 Zend Framework In Action）：

```
/application
    /modules/
        /default
            /controllers
            /forms
                ContactForm.php
                LoginForm.php
                RegisterForm.php
                SupportForm.php
            /models
                Comment.php
                User.php
                Users.php
            /views
        /admin
            /controllers
            /views 
```

但是，我也看到了模型目录下的表单结构。Matthew Weier O'Phinney 展示了如何[使用它们对模型](http://weierophinney.net/matthew/archives/200-Using-Zend_Form-in-Your-Models.html)本身进行验证：

```
/application
    /modules/
        /default
            /controllers
            /models
                Comment.php
                User.php
                /Form
                    Comment.php
                    Login.php
                    Register.php
            /views
        /admin
            /controllers
            /views 
```

要自动包含您的文件，请务必使用下划线模型命名您的类。

例如，当 Zend_Loader 看到

```
 class RegisterController extends Zend_Controller_Action 
```

它在 php include_path 中查找：

```
Zend/Controller/Action.php 
```

同样，假设上面的第一个结构，如果我们在 include_path 中包含“默认”模块：

```
# bootstrap.php
$rootDir = dirname(dirname(__FILE__));
define('ROOT_DIR', $rootDir);
set_include_path(get_include_path()
    . PATH_SEPARATOR . ROOT_DIR . '/library/'
    . PATH_SEPARATOR . ROOT_DIR . '/application/modules/default/'
);
include 'Zend/Loader.php';
Zend_Loader::registerAutoload(); 
```

你命名你的类：

```
Forms_ContactForm
Models_User 
```

一些程序员选择将他们的大部分文件放在库中，这样他们就不必添加额外的包含路径：

```
/library
    /My
        /Form
            Contact.php 
```

假设包含库文件夹，则上面的类将命名为：

```
My_Form_Contact 
```

祝你好运！-马特

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T20:27:18.817

就个人而言，我发现将我的模块目录放在包含路径中并在 Zend Loader 模式中命名我的表单类是最容易的。

[示例目录结构（从Matt](https://stackoverflow.com/questions/674596/using-forms-with-the-zend-framework/674678#674678)的答案复制）：

```
/application
    /modules/
        /default
            /controllers
            /forms
                Contact.php
                Login.php
                Register.php
                Support.php
            /models
                Comment.php
                User.php
                Users.php
            /views
        /admin
            /controllers
            /views 
```

示例表单类名称：

```
Default_Forms_Contact
Default_Forms_Login
Default_Forms_Register
Default_Forms_Support 
```

我以类似的方式命名我的模型和插件以保持简单。

我希望这个问题在 Zend 框架的更高版本中得到正确解决。

**更新：** 此结构不适用于 *nix 平台。艰难地发现了这一点！Zend Loader 需要将模块、表单和模型文件夹大写以在区分大小写的环境中工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-30T21:09:28.113

我个人喜欢将它们保存在我的应用程序文件夹中，因为我认为它们不属于库，并且只有一个文件夹可以更轻松地自动加载它们。

```
/application
/forms
/modules/
    /default
        /controllers
        /views
    /admin
        /controllers
        /views
/libray/
    /Zend 
```

我刚刚将表单路径添加到包含路径，我很高兴。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-08-02T07:28:28.413

zend 命令工具可以为此创建表单：

> zf create form 产品销售

其中 sales 是模块的名称，命令工具在模块 sales 内创建一个目录表单，并在 Product.php 文件中创建一个类：

```
class sales_Form_Product extends Zend_Form { 
```

并且您必须添加 de Zend_Application_Module_Autoloader 的定义，以定义您的模块目录

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-14T10:15:25.050

```
 $selectexamname = new Admin_Form_examresults_Selectexamname();
        $this->view->selectexamname = $selectexamname; 
```

您的班级应该必须根据这种格式定义

```
class Admin_Form_examresults_Selectexamname extends Zend_Form {} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-03-23T22:43:30.860

我把我所有的模型放在图书馆的一个文件夹里。Notion 是我公司的名称。

```
/application
/modules/
    /default
        /controllers
        /views
    /admin
        /controllers
        /views
/libray/
    /Zend
    /Notion
        /Form 
```

这使得包含和查找文件变得容易，因为您已经包含了库文件夹。

```
Notion_Form_Login
Notion_Db_Manager_Login 
```

# latex - LaTeX 表格标题中的特殊字符

> ID：674597
> 
> 赞同：3
> 
> 时间：2009-03-23T18:20:14.830
> 
> 标签：latex, caption

当我`\overline{x}`在表格的标题文本中包含或其他特殊字符时，整个标题文本根本不会出现。当我放置没有特殊字符的简单文本时，标题效果很好。如何在标题中包含特殊字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T18:31:16.130

你把美元放在数学上吗？IE：

```
\caption{This is a caption with maths $\overline{x}$ in it.} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T08:34:29.163

显然，您*真正的*问题是 TeX 奇特的纠错机制使您无法知道文档中存在语法错误。早在 1982 年左右，在长文档上运行 TeX 会花费很多时间，以至于 Knuth 不希望 TeX 在遇到错误时就退出。相反，TeX 会尝试猜测您的意思并继续排版文档，以便您可以在再次运行之前修复一堆错误；例如，当它在数学模式之外发现一个数学模式命令时，它假定您忘记了美元符号并插入它。没有一种自动纠错机制是完美的，因此语法错误往往会导致部分文本丢失，或者以错误的方式排版。

TeX 确实试图告诉你它发现了错误，但我想当前的 IDE 很容易忽略输出。尝试从命令行在文档上运行 latex 并注意它的内容。例如，短文档

```
\documentclass{article}
\begin{document}
It seems \sqrt{2} I forgot some dollar signs.
\end{document} 
```

导致 TeX 提示你

```
! Missing $ inserted.
<inserted text> 
                $
l.3 It seems \sqrt{
                   2} I forgot some dollar signs.
? 
```

2009 年处理此问题的方法是键入 X 退出，修复源文档，然后再次运行 latex - 但您实际上可以在提示符下输入其他命令来编辑 TeX 看到的输入。如果您只是键入 Q（安静地运行 - 与指定 \batchmode 相同，Emacs 或您正在使用的任何 IDE 可能会为您执行）您会得到一个排版文档，实际上可能并不明显有语法其中的错误。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2019-11-26T04:24:28.067

如果您正在寻找如何在表格中的 Latex 中插入任何特殊字符，那么这可能会对您有所帮助。看一下这个...

```
\documentclass{article}
\begin{document}
\begin{tabular}{|l|r|r|}
Item & Quality & Price(\$)\\
Nails & 500 &  34\\
Wooden boards & 100 & 4\\
Bricks & 240 & 11\\
\end{tabular}
\end{document} 
```

# python - Python、__init__ 和自我混淆

> ID：674600
> 
> 赞同：3
> 
> 时间：2009-03-23T18:20:44.800
> 
> 标签：python, self, init

好的，所以当我遇到这个时，我正在查看一些来源：

```
>>> def __parse(self, filename):
...         "parse ID3v1.0 tags from MP3 file"
...         self.clear()
...         try:
...             fsock = open(filename, "rb", 0)
...             try:
...                 fsock.seek(-128, 2)
...                 tagdata = fsock.read(128)
...             finally:
...                 fsock.close()
...             if tagdata[:3] == 'TAG':
...                 for tag, (start, end, parseFunc) in self.tagDataMap.items():
...                     self[tag] = parseFunc(tagdata[start:end])
...         except IOError:
...             pass
... 
```

所以，我决定测试一下。

```
 >>> __parse("blah.mp3") 
```

而且，我收到了这个错误：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: __parse() takes exactly 2 arguments (1 given) 
```

这不是我第一次遇到这种情况，我一直认为我应该将 self 包含在参数参数列表中，但我知道那是不对的。有人可以向我解释为什么我尝试使用的代码经常发生这种情况，我想这是由于我对这些术语的理解程度，我什至几乎不了解 init 或 self 做了什么，或者为什么它是相关的。def x(b): print b 和 def x(self, b): self.b = b print self.b 一样，不是吗？为什么这么重要！

我只是想要一个基本的解释，所以我可以摆脱这个想法，谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T18:23:11.220

在`def __parse`某些类定义中。

您不能将方法 defs 从类定义中提取出来。方法函数定义是类的一部分。

看看这两个例子：

```
def add( a, b ):
    return a + b 
```

和

```
class Adder( object ):
    def __init__( self ):
        self.grand_total = 0
    def add( self, a, b ):
        self.grand_total += a+b
        return a+b 
```

笔记。

1.  该功能不使用`self`.

2.  类方法确实使用`self`. 通常，所有实例方法都将使用`self`，除非它们有特定的装饰器，如`@classmethod`另有说明。

3.  该功能不依赖于其他任何东西。

4.  类方法依赖于被类的实例调用`Adder`；此外，它取决于该类的实例`Adder`是否已正确初始化。在这种情况下，初始化函数 ( `__init__`) 确保 的每个实例`Adder`总是有一个名为的实例变量，并且该实例变量的`grand_total`初始值为`0`

5.  你不能把`add`方法函数从`Adder`类中拉出来单独使用。它不是一个独立的功能。它是在类内定义*的，并且由于类**内*的位置而具有一定的期望。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T18:32:44.380

函数/方法可以在类之外编写，然后用于 Python 中称为**monkeypatching**的技术：

```
class C(object):
  def __init__(self):
    self.foo = 'bar'

def __output(self):
  print self.foo

C.output = __output
c = C()
c.output() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T22:05:32.543

看起来你对类和面向对象编程有点困惑。对于来自其他编程语言的人来说，“自我”是 python 的陷阱之一。IMO官方教程处理得不太好。 [这个教程](http://www.gidnetwork.com/b-133.html)看起来很不错。

如果你曾经学过 java，那么`self`in python 与 in java 非常相似`this`。不同之处在于，python 要求您列出`self`类定义中每个函数的第一个参数。

如果 python 是您的第一种编程语言（或您的第一种面向对象的语言），您可以将其记住为一个简单的经验法则：如果您要定义一个作为类的一部分的函数，则需要将其包含`self`为第一个争论。如果您要定义一个不属于类的函数，则不应包含`self`在参数中。如果不做一些（或者可能很多）额外的编码，你不能把一个类函数让它独立起来。最后，在*调用*`self`函数时永远不要包含作为参数。

 *这些规则也有例外，但现在不值得担心。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T18:23:45.383

self 由类上的 instancemethod 包装器自动传入。这个函数没有被包装；它不是一个方法，它只是一个函数。如果没有附加到一个类，它甚至没有意义，因为它需要 self 参数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T18:29:22.767

顺便说一句，*可以*在 Python 中创建类的静态方法。最简单的方法是通过装饰器（例如`@staticmethod`）。我怀疑这种事情通常不是 Pythonic 解决方案。

# jquery - JQuery Ui 还是 AjaxControlToolkit？

> ID：674602
> 
> 赞同：5
> 
> 时间：2009-03-23T18:20:48.980
> 
> 标签：jquery, ajax, asp.net-ajax, ajax.net

我正在构建一个 asp.net 应用程序，我应该使用哪种技术来获得 AJAX 功能？为什么？到目前为止，我只需要在网格视图中使用确认按钮，但可能需要更多功能。我可以两个都用，对吧？谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-03-09T21:35:45.353

它应该在很大程度上取决于您使用的是 WebForms 还是 ASP.NET MVC。

Ajax 控件工具包和 ASP.NET AJAX 非常依赖于服务器端功能，并且与 WebForms 集成得非常好。这对于需要快速高效地构建应用程序的开发人员来说是更好的选择，而无需过多关注性能或需要精确的 AJAX 功能。这是一种更“开箱即用”或快速开发的模型。虽然调整 AJAX 可能非常困难。

jQuery 和 jQuery UI 更适合 MVC 框架。这对于性能和精确的 AJAX 功能非常重要的更大、更复杂的应用程序来说更好。该模型更适合制作精良、质量更高的应用程序。虽然有一点学习曲线，但它需要更高程度的 HTML、CSS 和 JavaScript 知识。

不过在我看来，在大多数情况下，MVC 和 jQuery/jQueryUI 是更好的选择。一旦你通过了他们的学习曲线，你就会讨厌回到 WebForms。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:14:40.597

如果您想更多地了解 Javascript 方面的内容，jQuery 将为您提供更好的服务。如果您喜欢像在服务器端那样编写代码并且对 JS 不太熟悉，那么 MS AJAX 会“更简单”

然而，当我想要快速而肮脏的东西时，我发现自己使用 JQuery 来处理花哨的东西和 MS Ajax。（是的，当我有时看到 MS AJAX 库的大小时，我确实觉得很脏）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T19:23:01.310

我已经广泛使用了两者，并且毫无疑问地说值得学习 Jquery。

我发现 Ajax Control 工具包很容易启动，然后无缘无故地变得复杂，因为 Jquery 看起来很复杂，但从长远来看，你最终会更快地编写更好的客户端代码。

此外，如果您真的想有效地使用 ajax，我肯定会考虑学习 ASP.NET MVC，因为它是 .NET Web 应用程序的未来（在我看来）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T18:24:29.890

我知道您可以在 ASP.NET 应用程序中同时使用 jQuery UI 和 AjaxControlToolkit。我过去就是这样做的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T18:28:58.850

您可以同时使用两者。我的项目目前同时使用这两种方法，但我希望我们采用直接的 jQuery 路线，因为能够使用 Google 的 CDN 检索 jQuery 库或在服务器上组合库的能力。目前不要觉得 MS 堆栈具有灵活性。

# c# - SQL 表上的 XML 阅读器返回无效的 XML

> ID：674603
> 
> 赞同：2
> 
> 时间：2009-03-23T18:20:57.123
> 
> 标签：c#, sql, sql-server, xml, xmlreader

我有一个 SQL 表，它有一个 varchar(8) 列，其中偶尔有二进制数据。（0x01、0x02 等...）。（更改列的格式或内容不是一种选择。）

当我进入 SQL Server 2005 Management Studio 并运行查询时：

```
select * 
 from mytable 
 where clientID = 431620
 for xml auto 
```

我得到有用的结果。注意 proc_counts 是如何编码的：

```
<mytable clientID="431620" recno="19014235" pdate="2008-03-04T00:00:00"
   proc_counts="&#x1;&#x1;&#x2;&#x1;" otherstuff="foobar" 
   date="2008-02-17T00:00:00"/> 
```

完全有效的 XML，AFAIK。现在，当我实际编写 C# 代码来读取这一行时，我在 ReadOuterXml 期间抛出异常：

```
SqlCommand cmd = new SqlCommand("select * from testing xml auto", connection);
using (XmlReader xrd = cmd.ExecuteXmlReader())
{
    xrd.Read();
    while (xrd.ReadState != ReadState.EndOfFile)
    {
        string s = xrd.ReadOuterXml();
        records.Add(s);
    }
} 
```

这抛出：**XmlException 未处理。''，十六进制值 0x01 是无效字符**。我*想要*上面的 XML，但没有足够的 Google-fu 来弄清楚为什么我没有得到它。建议？

* * *

要使用此类数据创建表，此 Transact SQL 代码在 SSMS 中工作：

```
create table testing
(clientid int, proc_counts varchar(8));
insert into testing values (1, 'normal');
insert into testing values (2, char(65) + char(1) + char(65));
select * from testing for xml auto; 
```

* * *

**更新：验尸和解决方法**

Dommer 可能是对的，这是给我带来问题的`Normalization`财产。`XmlTextReader`问题是（正如您从评论中看到的那样）我发现几乎不可能从 a`(SqlCommand).ExecuteXmlReader()`转到任何可以让我靠近`Normalization`an 属性的东西`XmlTextReader`。通常，Microsoft 关于此的文档是矛盾的，或者完全是错误的。

所以我决定了一个解决方法。如果我只是使用 an`SqlDataReader`来吸收输出，一切都很好。XML 看起来很完美，解析也很好。

```
StringBuilder sb = new StringBuilder();
using(SqlDataReader dr = cmd.ExecuteReader())
{
    while(rdr.Read())
        sb.Append((string)rdr[0]);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T19:07:48.260

这与 XmlTextReader.Normalization 属性有关。当您显式创建 XmlTextReader 时，此属性设置为 false，因此会解码“无效”字符。当隐式创建 XmlTextReader 时，Normalization 设置为 true。

此处讨论该属性：

[http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.normalization.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.normalization.aspx)

如果您“手动”进行处理 - 即创建一个 XmlTextReader - 我认为您将避免该错误。

更新：

框架的最新版本中的更改意味着“XmlReaderSettings.CheckCharacters = false”可能是 ASP.NET 2.0+ 中的方式。可以将 XmlReaderSettings 对象传递给 XmlReader.Create。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T18:46:11.557

例外是告诉你真相。SQL Server 显然允许显示无效的 XML。试试这个：

```
select *  from mytable  where clientID = 431620 for xml auto, BINARY BASE64 
```

# java - 我可以使用 Flex Builder 对 Java 进行编程吗？

> ID：674606
> 
> 赞同：0
> 
> 时间：2009-03-23T18:21:07.137
> 
> 标签：java, eclipse, flex-builder-3

我没有Java经验，但我想学习它。我已经独立使用 Flex Builder 几个月了，现在熟悉 eclipse。因此，既然 Flex Builder 基本上是 eclipse，我可以使用相同的副本编写 Java 还是需要新安装 eclipse 来编写 Java？另外，如果有人可以向我指出一个教程，该教程显示了如何设置 eclipse 来编程 Java，那也将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T18:23:53.373

快速回答：是的。

完整的答案在这里详细描述：http: [//www.suketuvyas.com/2007/09/10/java-development-in-flex-builder/](http://www.suketuvyas.com/2007/09/10/java-development-in-flex-builder/)

# visual-studio-2008 - 有没有更好的方法来查看 TFS 中的工作项/与之交互？

> ID：674611
> 
> 赞同：0
> 
> 时间：2009-03-23T18:22:07.027
> 
> 标签：visual-studio-2008, tfs, agile, visio, extreme-programming

我正处于构建应用程序的需求/设计阶段。我们正在使用 VS 2008 和 TFS。我有一堆场景和相关任务。部分需求发生了变化，我想去看看哪些任务需要更改/删除。

使用任何现有的工作项视图都很难查看系统的概述——无论是在 VS 中的网格还是在 Excel 中查看它们。

有没有一种工具可以在分层视图中显示我的工作项？或者，我会采取一些将我的工作项导出到 Visio 的东西，这样我就可以以虚拟的“白板上的索引卡”方式与它们进行交互。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T12:41:26.313

2010 年应完全支持 Team Explorer 中的 WI 分层视图。

Web 访问电动工具在一定程度上提供了分层视图。你需要看看它是否能满足你的需求。

[Visual Studio 团队系统 Web 访问](http://msdn.microsoft.com/en-us/teamsystem/bb980951.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T13:36:37.383

我还建议您查看一个名为[Eylean board](http://www.eylean.com)的工具。它将 TFS 工作项转换为便签/白板，看起来像工作区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-18T14:23:12.393

TFS 2010 具有对分层工作项的内置支持。虽然 Team Web Access 确实包含一个基于网格的树视图来可视化工作项层次结构，但它仍然非常有限。然而，结合[Urban Turtle](http://urbanturtle.com)之类的工具，Team Web Access 允许用户在虚拟 Scrum（墙）板上查看工作项，并通过拖放操作它们。

# javascript - xmlHTTPrequest 不会打开 ("GET" , url, true); 我很生气！PHP

> ID：674612
> 
> 赞同：3
> 
> 时间：2009-03-23T18:22:20.910
> 
> 标签：javascript, php, url, get

我一直在尝试打开一个网址，但我对为什么这不起作用感到恼火。代码在下面列出并解释。任何帮助将不胜感激。

物体：

```
function getXMLHTTPRequest() {
   var req =  false;
   try {
      /* for Firefox */
      req = new XMLHttpRequest(); 
   } catch (err) {
      try {
         /* for some versions of IE */
         req = new ActiveXObject("Msxml2.XMLHTTP");
      } catch (err) {
         try {
            /* for some other versions of IE */
            req = new ActiveXObject("Microsoft.XMLHTTP");
         } catch (err) {
            req = false;
         }
     }
   }

   return req;
} 
```

该对象的调用方式如下：

```
<script type="text/javascript">
var myDelete = new getXMLHTTPRequest();
</script> 
```

现在这就是我想要做的：

```
function removeArticle(id) {

    if (myDelete) {

        try {
            var deletUrl = "delete.php";
            var query = deletUrl + "?theid=" + id;
            myDelete.open("GET", query, true);
            myDelete.onreadystatechange = removeArticleResponse;
            myDelete.send(null);
        } catch (e) {
            alert ("Unable to connect to the server:\n" + e.toString());
        }
    } else {
        alert ("Bad! Very BAD!");
    }
} 
```

当我这样做时：

```
 if (myDelete.open("GET", query, true)) {
        myDelete.onreadystatechange = removeArticleResponse;
        myDelete.send(null);
        } else {
            alert ("No road!");
        } 
```

alert("没有路！"); 告诉我代码没有执行通过了这一点：

```
if (myDelete.open("GET", query, true)) { 
```

这意味着 if (myDelete) { 有效。代码通过了这个阶段，由于某种原因在这里停止： myDelete.open("GET", query, true); 它不会打开网址。我不确定问题是什么。

**编辑：**这是用于访问服务器响应的函数：

```
function removeArticleResponse () {
    if (myDelete.status == 4) {
        if (myDelete.status == 200) {
                        try {
                            response = myDelete.responseText;
                            document.getElementById('displaynewsletterarticleresult').innerHTML = response;
                        } catch(e) {
                            alert("An error occured while reading the response:" + e.toString());
                        }
        } else {
        alert ("An error occured when attempting to retrieve the data:\n" + myDelete.statusText);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T18:28:02.690

据此[，](http://msdn.microsoft.com/en-us/library/ms536648(VS.85).aspx) XMLHttpRequest.open() 没有返回值，因此您的检查将始终失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:26:01.647

在您的响应函数中，您的意思是检查 .status == 4 而不是 .readyState？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T22:10:57.337

所有 xmlHTTPRequest 都绑定到相同的源策略。也许那是你的问题。

您可以在[http://en.wikipedia.org/wiki/Same_origin_policy阅读更多相关信息](http://en.wikipedia.org/wiki/Same_origin_policy)

# vim - VIM 折叠除某物之外的所有东西

> ID：674613
> 
> 赞同：9
> 
> 时间：2009-03-23T18:22:21.690
> 
> 标签：vim, folding

一个代码有超过 2 000 行的折叠。我在可视模式中选择了一个我想开始写入的块。然而，周围的东西，比如折叠，暗示了我的写作，我不小心倾向于修改它们。目前，我通过在单独的 VIM 中编写块来避免此类错误。这不是一个真正的解决方案，并且打开太多 VIM 会变得很尴尬。*我怎样才能隐藏除了折叠块之外的所有东西？*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-23T19:12:53.643

你可以做`zMzv`或`zMzO`。

`zM`关闭所有折叠，`zv`使当前行可见并`zO`递归打开光标下的所有折叠直到根。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T10:38:34.137

不完全是你要求的，但可能会工作......

将此朋友映射到某物：

```
:vnoremap <Leader>za <Esc>`<kzfgg`>jzfG`< 
```

我把它放在leader => z上（因为它必须折叠）=> a（因为它代表“周围”）

用法：

选择带 V 的线，击中前导 z a。
上面和下面的所有东西都将被折叠。

# java - 在数组中打印不同的整数

> ID：674618
> 
> 赞同：0
> 
> 时间：2009-03-23T18:23:05.870
> 
> 标签：java, arrays, duplicates

我正在尝试编写一个小程序来打印出数组中的不同数字。例如，如果用户输入 1,1,3,5,7,4,3，程序将只打印出 1,3,5,7,4。

我在函数中的 else if 行出现错误`checkDuplicate`。

到目前为止，这是我的代码：

```
import javax.swing.JOptionPane;

public static void main(String[] args) {
    int[] array = new int[10];
    for (int i=0; i<array.length;i++) {
        array[i] = Integer.parseInt(JOptionPane.showInputDialog("Please enter"
                                  + "an integer:"));
    }
    checkDuplicate (array);
}

public static int checkDuplicate(int array []) {
    for (int i = 0; i < array.length; i++) {
        boolean found = false;
        for (int j = 0; j < i; j++)
            if (array[i] == array[j]) {
                found = true;
                break;
            }
        if (!found)
            System.out.println(array[i]);
    }
    return 1;
}
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T18:25:42.650

最简单的方法是将所有元素添加到 a 中`Set<Integer>`，然后只打印`Set`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T18:54:28.820

首先，“ `else if`”语句是不正确的，因为你没有为if提供任何条件（如果你想要一个if，你需要写“ `if (condition) ...`”）。

其次，您无法*在内部*循环中决定是否应该打印一个值：您的代码的工作方式是*为每个*不同于 array[i] 的值 array[j] 编写一个值 array[i]！

第三：内部循环只需要从 0 到外部索引`i-1`：对于每个元素，您只需要确定它是否是第一次出现（即相同的值是否出现在任何先前的索引处）。如果是，打印出来，如果不是，忽略它。

一个正确的实现`CheckDuplicate()`是：

```
public static void checkDuplicate(int array []) {
  for (int i = 0; i < array.length; i++) {
    boolean found = false;
    for (int j = 0; j < i; j++)
      if (array[i] == array[j]) {
        found = true;
        break;
      }
    if (!found)
      System.out.println(array[i]);
  }
} 
```

但是，当然，对于更大的阵列，某种方式`Set`会更有效......

* * *

编辑：当然，*mmyers*（见评论）说得对，因为`CheckDuplicate()`不返回任何值，它应该有返回类型`void`（而不是`int`）。我在上面的代码中更正了这个......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T18:28:11.270

将它们放入按插入时间排序的集合中，然后在必要时转换回数组。

```
new LinkedHashSet<Integer>(array).toArray() 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T18:26:02.383

尝试将所有整数放入一个集合中。重复项永远不会添加到集合中，您将留下一组唯一整数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T20:55:10.310

您想要的可以使用 Java 集合 API 来完成，但不完全是单线，因为事实集合方法使用`Object`s 而不是原语。J2SE 缺少可以转换为 的方法`int[]`，`Integer[]`但是 Apache Commons Lang[库](http://commons.apache.org/lang/)包含这样有用的方法，例如[ArrayUtils.toObject()](http://commons.apache.org/lang/api-release/org/apache/commons/lang/ArrayUtils.html#toObject(int[]))和[ArrayUtils.toPrimitive()](http://commons.apache.org/lang/api-release/org/apache/commons/lang/ArrayUtils.html#toPrimitive(java.lang.Integer[]))。

使用它们，从整数数组中删除重复元素的方法如下所示：

```
public static int[] removeDuplicates(int... array) {
    Integer[] ints = ArrayUtils.toObject(array);
    Set<Integer> set = new LinkedHashSet<Integer>(Arrays.asList(ints));
    return ArrayUtils.toPrimitive(set.toArray(new Integer[set.size()]));
} 
```

如果您的应用程序可能包含更多的数组/集合操作，我建议您查看该库，而不是从头开始实现。但是，如果您是出于学习目的而这样做，请远离编码！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T18:26:31.697

将每个数字添加到[Set](http://java.sun.com/j2se/1.4.2/docs/api/java/util/Set.html)实现而不是数组可能会更好。集合专门用于存储要过滤掉重复项的元素集合。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T05:26:30.517

使用其他人建议的 Set 或使用 List 兼容类。对于列表兼容类，只需使用 Contains 方法检查它是否已存在于数组中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-07T05:02:31.967

导入 java.util.Scanner；公共类 PrintDistinctNumbers {

```
/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    int [] numberArray = createArray();
    System.out.println("The number u entered are:   ");
    displayArray(numberArray);
    getDistinctNumbers(numberArray);
}

public static int[] createArray() {
    Scanner input = new Scanner(System.in);
    int [] numberCollection = new int [10];
    System.out.println("Enter 10 numbers");

    for(int i = 0; i < numberCollection.length; i++){
        numberCollection[i] = input.nextInt();
    }
    return numberCollection;

}

public static void displayArray(int[] numberArray) {
    for(int i = 0; i < numberArray.length; i++){
        System.out.print(numberArray[i]+" ");
    }
}

public static void getDistinctNumbers(int[] numberArray) {
    boolean isDistinct = true;
    int temp = 0;
    int [] distinctArrayNumbers = new int [10];
    for ( int i = 0; i < numberArray.length; i++){
        isDistinct = true;
            temp = numberArray[i];

            for( int j = 0; j < distinctArrayNumbers.length; j++){
                if( numberArray[i] == distinctArrayNumbers[j] ){
                isDistinct = false;
            }

           }
            if(isDistinct){
                    distinctArrayNumbers[temp]=numberArray[i];
                    temp++;
                }

    }
    displayDistinctArray(distinctArrayNumbers);
}

public static void displayDistinctArray(int[] distinctArrayNumbers) {
    for( int i = 0; i < distinctArrayNumbers.length; i++){
        if(distinctArrayNumbers[i] != 0){
        System.out.println(distinctArrayNumbers[i]);
        }
    }
} 
```

}

# sql-server - 如何在 SQL Server 过程/触发器中查找文本？

> ID：674623
> 
> 赞同：188
> 
> 时间：2009-03-23T18:23:56.600
> 
> 标签：sql-server, stored-procedures, triggers, linked-server

我有一个会改变的链接服务器。一些程序像这样调用链接服务器：`[10.10.100.50].dbo.SPROCEDURE_EXAMPLE`. 我们也有触发器在做这种工作。我们需要找到所有`[10.10.100.50]`用来改变它的地方。

在 SQL Server Management Studio Express 中，我没有在 Visual Studio 中找到像“在整个数据库中查找”这样的功能。一个特殊的 sys-select 可以帮助我找到我需要的东西吗？

* * *

## 回答 #1

> 赞同：337
> 
> 时间：2009-03-23T19:24:53.477

这是我在系统上用于查找文本的程序的一部分......

```
DECLARE @Search varchar(255)
SET @Search='[10.10.100.50]'

SELECT DISTINCT
    o.name AS Object_Name,o.type_desc
    FROM sys.sql_modules        m 
        INNER JOIN sys.objects  o ON m.object_id=o.object_id
    WHERE m.definition Like '%'+@Search+'%'
    ORDER BY 2,1 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2010-11-19T05:31:50.720

你可以像这样找到它

```
SELECT DISTINCT OBJECT_NAME(id) FROM syscomments WHERE [text] LIKE '%User%' 
```

它将列出不同的存储过程名称，其中包含存储过程中的“用户”等文本。[更多信息](http://tinyurl.com/32c6v8v)

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-05-03T11:31:47.167

*[迟到的答案，但希望有用]*

使用系统表并不总能提供 100% 正确的结果，因为某些存储过程和/或视图可能已加密，在这种情况下，您需要使用[DAC](http://msdn.microsoft.com/en-us/library/ms189595.aspx)连接来获取所需的数据。

我建议使用可以轻松处理加密对象的第三方工具，例如[ApexSQL Search 。](http://www.apexsql.com/sql_tools_search.aspx)

如果对象被加密，Syscomments 系统表将为文本列提供空值。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-08-27T09:25:27.807

```
-- Declare the text we want to search for
DECLARE @Text nvarchar(4000);
SET @Text = 'employee';

-- Get the schema name, table name, and table type for:

-- Table names
SELECT
       TABLE_SCHEMA  AS 'Object Schema'
      ,TABLE_NAME    AS 'Object Name'
      ,TABLE_TYPE    AS 'Object Type'
      ,'Table Name'  AS 'TEXT Location'
FROM  INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME LIKE '%'+@Text+'%'
UNION
 --Column names
SELECT
      TABLE_SCHEMA   AS 'Object Schema'
      ,COLUMN_NAME   AS 'Object Name'
      ,'COLUMN'      AS 'Object Type'
      ,'Column Name' AS 'TEXT Location'
FROM  INFORMATION_SCHEMA.COLUMNS
WHERE COLUMN_NAME LIKE '%'+@Text+'%'
UNION
-- Function or procedure bodies
SELECT
      SPECIFIC_SCHEMA     AS 'Object Schema'
      ,ROUTINE_NAME       AS 'Object Name'
      ,ROUTINE_TYPE       AS 'Object Type'
      ,ROUTINE_DEFINITION AS 'TEXT Location'
FROM  INFORMATION_SCHEMA.ROUTINES 
WHERE ROUTINE_DEFINITION LIKE '%'+@Text+'%'
      AND (ROUTINE_TYPE = 'function' OR ROUTINE_TYPE = 'procedure'); 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-04-26T08:51:42.413

这将为您工作：

```
use [ANALYTICS]  ---> put your DB name here
GO
SELECT sm.object_id, OBJECT_NAME(sm.object_id) AS object_name, o.type, o.type_desc, sm.definition
FROM sys.sql_modules AS sm
JOIN sys.objects AS o ON sm.object_id = o.object_id
where sm.definition like '%SEARCH_WORD_HERE%' collate SQL_Latin1_General_CP1_CI_AS
ORDER BY o.type;
GO 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-03-20T18:22:31.517

有**比**每次链接服务器更改时修改存储过程、函数和视图的文本更好的解决方案。以下是一些选项：

1.  更新链接服务器。与其使用以 IP 地址命名的链接服务器，不如使用资源名称创建一个新的链接服务器，例如`Finance`or`DataLinkProd`或某些此类。然后，当您需要更改访问的服务器时，更新链接服务器以指向新服务器（或删除它并重新创建它）。

2.  虽然很遗憾您无法为链接服务器或模式创建同义词，但您可以为位于链接服务器上的对象创建同义词。例如，您的程序`[10.10.100.50].dbo.SPROCEDURE_EXAMPLE`可以使用别名。也许创建一个模式`datalinkprod`，然后`CREATE SYNONYM datalinkprod.dbo_SPROCEDURE_EXAMPLE FOR [10.10.100.50].dbo.SPROCEDURE_EXAMPLE;`。然后，编写一个接受链接服务器名称的存储过程，该过程从远程数据库中查询所有潜在对象并（重新）为它们创建同义词。您的所有 SP 和函数只需重写一次以使用以 开头的同义词名称`datalinkprod`，然后再从一个链接服务器更改为您刚刚执行的另一个链接服务器，`EXEC dbo.SwitchLinkedServer '[10.10.100.51]';`并在几分之一秒内使用不同的链接服务器。

可能还有更多选择。我强烈建议使用预处理、配置或间接的高级技术，而不是更改人工编写的脚本。自动更新机器创建的脚本很好，这是预处理。手动做事很糟糕。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-30T07:02:25.960

```
select text
from syscomments
where text like '%your text here%'
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-05-05T08:22:52.190

这是我在 SQL2008 中尝试过的，它可以一次从所有数据库中搜索。

```
Create table #temp1 
(ServerName varchar(64), dbname varchar(64)
,spName varchar(128),ObjectType varchar(32), SearchString varchar(64))

Declare @dbid smallint, @dbname varchar(64), @longstr varchar(5000)
Declare @searhString VARCHAR(250)

set  @searhString='firstweek'

declare db_cursor cursor for 
select dbid, [name] 
from master..sysdatabases
where [name] not in ('master', 'model', 'msdb', 'tempdb', 'northwind', 'pubs')

open db_cursor
fetch next from db_cursor into @dbid, @dbname

while (@@fetch_status = 0)
begin
    PRINT 'DB='+@dbname
    set @longstr = 'Use ' + @dbname + char(13) +        
        'insert into #temp1 ' + char(13) +  
        'SELECT @@ServerName,  ''' + @dbname + ''', Name 
        , case  when [Type]= ''P'' Then ''Procedure''
                when[Type]= ''V'' Then ''View''
                when [Type]=  ''TF'' Then ''Table-Valued Function'' 
                when [Type]=  ''FN'' Then ''Function'' 
                when [Type]=  ''TR'' Then ''Trigger'' 
                else [Type]/*''Others''*/
                end 
        , '''+ @searhString +''' FROM  [SYS].[SYSCOMMEnTS]
        JOIN  [SYS].objects ON ID = object_id
        WHERE TEXT LIKE ''%' + @searhString + '%'''

 exec (@longstr)
 fetch next from db_cursor into @dbid, @dbname
end

close db_cursor
deallocate db_cursor
select * from #temp1
Drop table #temp1 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-23T19:34:13.717

我用这个来工作。虽然在@TEXT 字段中去掉 []，但似乎想要返回所有内容......

```
设置无计数

声明 @TEXT VARCHAR(250)
声明 @SQL VARCHAR(250)

选择 @TEXT='10.10.100.50'

CREATE TABLE #results (db VARCHAR(64), objectname VARCHAR(100),xtype VARCHAR(10), definition TEXT)

选择 @TEXT 作为“搜索字符串”
DECLARE #databases CURSOR FOR SELECT NAME FROM master..sysdatabases where dbid>4
    声明 @c_dbname varchar(64)   
    打开#databases
    FETCH #databases INTO @c_dbname   
    而@@FETCH_STATUS -1
    开始
        SELECT @SQL = '插入 #results '
        SELECT @SQL = @SQL + 'SELECT ''' + @c_dbname + ''' AS db, o.name,o.xtype,m.definition '   
        SELECT @SQL = @SQL + ' FROM '+@c_dbname+'.sys.sql_modules m '   
        SELECT @SQL = @SQL + 'INNER JOIN '+@c_dbname+'..sysobjects o ON m.object_id=o.id'   
        SELECT @SQL = @SQL + ' WHERE [定义] LIKE ''%'+@TEXT+'%'''   
        执行（@SQL）
        FETCH #databases INTO @c_dbname
    结尾
    关闭#数据库
DEALLOCATE #databases

SELECT * FROM #results order by db, xtype, objectname
删除表#results

```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-23T19:35:14.963

我过去使用过这些：

*   [在所有用户存储过程中搜索表名](http://groups.google.com/group/comp.databases.ms-sqlserver/msg/6f53a7cfc6ae0db0)
*   [在所有表的所有列中搜索和替换 SQL Server 数据](http://vyaskn.tripod.com/sql_server_search_and_replace.htm)

在这种特殊情况下，您需要跨存储过程替换特定字符串，第一个链接可能更相关。

有点离题，[快速查找加载项](http://jcooney.net/archive/2007/11/26/55358.aspx)对于使用 SQL Server Management Studio 搜索对象名称也很有用。有一个经过一些改进的[修改版本，Codeplex 上还有另一个](http://www.karpach.com/ViewArticle.aspx?ArticleFileName=SQL-Server-Managment-Studio-Object-Explorer-Search-Add-In.htm)[更新的版本](http://www.codeplex.com/SSMSAddins)，还有一些其他有用的插件。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-04T12:17:43.540

使用 select 语句进行的任何搜索都只会产生对象名称，其中包含搜索关键字。最简单有效的方法是获取过程/函数的脚本，然后在生成的文本文件中搜索，我也遵循这种技术:) 所以你是准确的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-03-22T09:08:32.853

您可以使用以下 SQL 在所有数据库对象的定义中进行搜索：

```
SELECT 
    o.name, 
    o.id, 
    c.text,
    o.type
FROM 
    sysobjects o 
RIGHT JOIN syscomments c 
    ON o.id = c.id 
WHERE 
    c.text like '%text_to_find%' 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-07-06T10:50:20.583

```
SELECT ROUTINE_TYPE, ROUTINE_NAME, ROUTINE_DEFINITION
FROM INFORMATION_SCHEMA.ROUTINES 
WHERE ROUTINE_DEFINITION LIKE '%Your Text%' 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-01-22T23:17:26.140

刚刚为通用完整外部交叉参考写了这个

```
create table #XRefDBs(xtype varchar(2),SourceDB varchar(100), Object varchar(100), RefDB varchar(100))

declare @sourcedbname varchar(100),
        @searchfordbname varchar(100),
        @sql nvarchar(4000)
declare curs cursor for
    select name 
    from sysdatabases
    where dbid>4
open curs
fetch next from curs into @sourcedbname
while @@fetch_status=0
    begin
    print @sourcedbname
    declare curs2 cursor for 
        select name 
        from sysdatabases
        where dbid>4
        and name <> @sourcedbname
    open curs2
    fetch next from curs2 into @searchfordbname
    while @@fetch_status=0
        begin
        print @searchfordbname
        set @sql = 
        'INSERT INTO #XRefDBs (xtype,SourceDB,Object, RefDB)
        select DISTINCT o.xtype,'''+@sourcedbname+''', o.name,'''+@searchfordbname+'''
        from '+@sourcedbname+'.dbo.syscomments c
        join '+@sourcedbname+'.dbo.sysobjects o on c.id=o.id
        where o.xtype in (''V'',''P'',''FN'',''TR'')
        and (text like ''%'+@searchfordbname+'.%''
          or text like ''%'+@searchfordbname+'].%'')'
        print @sql
        exec sp_executesql @sql
        fetch next from curs2 into @searchfordbname
        end
    close curs2
    deallocate curs2
    fetch next from curs into @sourcedbname
    end
close curs
deallocate curs

select * from #XRefDBs 
```

# javascript - 时区 JS，需要格式化方面的帮助

> ID：674624
> 
> 赞同：1
> 
> 时间：2009-03-23T18:24:12.077
> 
> 标签：javascript

此代码垂直显示时区。我想以适当的间距水平显示它们。我想用一个在新名称和区域之间提供间距的标签替换“br”中断标签（代码的倒数第二行）。不起作用。简单但由于某种原因很棘手。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Untitled Document</title>
<script type="text/JavaScript">
//Universal clock 2006
//Genuine code by Corneliu Lucian "KOR" Rusu mailto:corneliulucian(AROND)apropo.ro
var wd=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
var D=[
['Bucharest',120,60],//city,standard time zone(minutes), DST(minutes)
['Madrid',60,60],
['New York',-300,60],
['Nairobi',180,0]
]
//add in the array your cities,STZ, DST
function calc(){
var spans=document.getElementById('zonediv').getElementsByTagName('span')
for(var i=0;i<D.length;i++){
var t=new Date();
t.setTime(t.getTime()+(t.getTimezoneOffset()*60000)+((D[i][1]+D[i][2])*60000));//the zone's time
var Dy=t.getFullYear();
var Dd=t.getDate()<10?'0'+t.getDate():t.getDate();
var Dm=t.getMonth()<10?'0'+(t.getMonth()+1):t.getMonth()+1;
var Dh=t.getHours()<10?'0'+t.getHours():t.getHours(); 
var Di=t.getMinutes()<10?'0'+t.getMinutes():t.getMinutes();
var Ds=t.getSeconds()<10?'0'+t.getSeconds():t.getSeconds();
var Dz=wd[t.getDay()];
spans[i].firstChild.data=Dh+':'+Di+':'+Ds+' - '+Dz+' '+Dd+'/'+Dm+'/'+Dy;
}
setTimeout('calc()',1000)
}
onload=function(){
var root = document.getElementById('zonediv');
for(var i=0;i<D.length;i++){
root.appendChild(document.createTextNode(D[i][0]+' '))
var sp= document.createElement('span');
sp.appendChild(document.createTextNode(' '));
root.appendChild(sp);root.appendChild(document.createElement('br'))
}
calc();
}
</script>
</head>
<body>
<div id="zonediv">
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T18:37:51.497

尝试更换

`root.appendChild(document.createElement('br'))`

有类似的东西

`root.appendChild(document.createTextNode(' '))`

这将附加一个空格而不是一个`br`元素:)

# c# - 如何设置程序在启动时启动

> ID：674628
> 
> 赞同：82
> 
> 时间：2009-03-23T18:24:31.093
> 
> 标签：c#, windows

我有一个小应用程序，`CheckBox`如果他们希望应用程序从 Windows 启动，用户可以设置一个选项。

我的问题是如何将应用程序设置为在启动时运行。

ps：我正在使用带有.NET 2.0 的C#。

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2009-03-23T21:40:13.213

感谢大家这么快的回复。乔尔，我使用了您的选项 2，并在当前用户的“运行”文件夹中添加了一个注册表项。这是我为其他感兴趣的人使用的代码。

```
 using Microsoft.Win32;
    private void SetStartup()
    {
        RegistryKey rk = Registry.CurrentUser.OpenSubKey
            ("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);

        if (chkStartUp.Checked)
            rk.SetValue(AppName, Application.ExecutablePath);
        else
            rk.DeleteValue(AppName,false);            

    } 
```

* * *

## 回答 #2

> 赞同：114
> 
> 时间：2009-03-23T18:29:08.617

几个选项，按优先顺序排列：

1.  将其添加到当前用户的启动文件夹。这需要您的应用程序运行的最少权限，并为用户提供对正在发生的事情的最大控制和反馈。不利的一面是，下次他们在程序中查看该屏幕时，确定是否显示已选中的复选框有点困难。
2.  将其添加到`HKey_Current_User\Software\Microsoft\Windows\CurrentVersion\Run`注册表项。这里唯一的问题是它需要对注册表的写访问权限，这并不总是可用的。
3.  创建在用户登录时触发的计划任务
4.  将其添加到`HKey_Local_Machine\Software\Microsoft\Windows\CurrentVersion\Run`注册表项。这里唯一的问题是它需要对注册表的写访问权限，这并不总是可用的。
5.  将其设置为 Windows 服务。仅当您*真的认真**并且*您确定要为计算机上的*所有*用户运行此程序时才执行此操作。

这个答案现在更老了。自从我写了这篇文章后，Windows 10 就发布了，它改变了“开始”菜单文件夹的工作方式……包括`Startup`文件夹。我还不清楚在该文件夹中添加或删除文件而不引用 Windows 用于这些位置的内部数据库是多么容易。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2018-12-19T09:36:08.337

这是将程序添加到 Windows Vista、7、8、10 启动的所有方法

> *   **文件路径**
> 
> `C:\Users\Bureau Briffault\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`（从任务管理器可见，在当前用户登录成功时运行，无需管理员权限）
> 
> `C:\Users\Default\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`（从任务管理器可见，在所有用户登录成功时运行，需要管理员权限）

* * *

> *   **注册表路径**
> 
> `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run` （从任务管理器可见，在当前用户登录成功时运行，无需管理员权限）
> 
> `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce` （在任务管理器中不可见，在当前用户登录成功时运行，运行一次登录，无需管理员权限）
> 
> `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run` （从任务管理器可见，在所有用户登录成功时运行，需要管理员权限）
> 
> `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce` （在任务管理器中不可见，在所有用户登录成功时运行，运行一次登录时间，需要管理员权限）

* * *

> *   **任务调度器**
> 
> `Microsoft.Win32.Taskscheduler.dll`（在任务管理器中不可见，在 Windows 启动时运行，以管理员身份运行，需要管理员权限）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-01-20T09:57:01.750

这是一个如此简单的解决方案：

加上

```
Microsoft.Win32.RegistryKey key = Microsoft.Win32.Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
key.SetValue("Your Application Name", Application.ExecutablePath); 
```

去除

```
Microsoft.Win32.RegistryKey key = Microsoft.Win32.Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);
key.DeleteValue("Your Application Name", false); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-12-23T10:25:55.430

除了 Xepher Dotcom 的回答，Windows 启动的文件夹路径应该这样编码：

```
var Startup = Environment.GetFolderPath(Environment.SpecialFolder.Startup); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-23T18:30:10.830

您可以在“HKCU\Software\Microsoft\Windows\CurrentVersion\Run”中创建一个注册表项，请注意它在 Vista 上的工作方式可能有所不同。由于 UAC，您的设置可能会“虚拟化”。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-10-14T05:12:01.900

```
 /// <summary>
    /// Add application to Startup of windows
    /// </summary>
    /// <param name="appName"></param>
    /// <param name="path"></param>
    public static void AddStartup(string appName, string path)
    {
        using (RegistryKey key = Registry.CurrentUser.OpenSubKey
            ("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true))
        {
            key.SetValue(appName, "\"" + path + "\"");
        }
    }

    /// <summary>
    /// Remove application from Startup of windows
    /// </summary>
    /// <param name="appName"></param>
    public static void RemoveStartup(string appName)
    {
        using (RegistryKey key = Registry.CurrentUser.OpenSubKey
            ("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true))
        {
            key.DeleteValue(appName, false);
        }
    } 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-23T18:30:41.360

如果应用程序设计为在 Windows 启动时启动（而不是在用户登录时），您唯一的选择是使用 Windows 服务。要么将应用程序编写为服务，要么编写一个仅用于启动应用程序的简单服务。

编写服务可能很棘手，并且可能会施加对您的特定情况可能不可接受的限制。一种常见的设计模式是前端/后端对，其中一个服务负责工作，一个应用程序前端与该服务通信以向用户显示信息。

另一方面，如果您只想让您的应用程序在用户登录时启动，您可以使用 Joel Coehoorn 列出的方法 1 或 2。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-07-23T18:43:03.430

我发现在启动文件夹中添加快捷方式对我来说是最简单的方法。我必须添加对“Windows Script Host Object Model”和“Microsoft.CSharp”的引用，然后使用以下代码：

```
IWshRuntimeLibrary.WshShell shell = new IWshRuntimeLibrary.WshShell();
string shortcutAddress = Environment.GetFolderPath(Environment.SpecialFolder.Startup) + @"\MyAppName.lnk";
System.Reflection.Assembly curAssembly = System.Reflection.Assembly.GetExecutingAssembly();

IWshRuntimeLibrary.IWshShortcut shortcut = (IWshRuntimeLibrary.IWshShortcut)shell.CreateShortcut(shortcutAddress);
shortcut.Description = "My App Name";
shortcut.WorkingDirectory = AppDomain.CurrentDomain.BaseDirectory;
shortcut.TargetPath = curAssembly.Location;
shortcut.IconLocation = AppDomain.CurrentDomain.BaseDirectory + @"MyIconName.ico";
shortcut.Save(); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-04-24T12:43:55.910

您可以使用 Microsoft 命名空间中的 win32 类执行此操作

```
using Microsoft.Win32;

using (RegistryKey key = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true))
 {
            key.SetValue("aldwin", "\"" + Application.ExecutablePath + "\"");
 } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-07-25T15:51:49.450

如果您使用 wpf，则“ExecutablePath”不起作用。所以我也制作了一个适用于 wpf 的代码。

```
using (RegistryKey key = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true))
{
    key.SetValue(
        "AutoStart.exe", 
        "\"" + System.Reflection.Assembly.GetExecutingAssembly().Location + "\""
    );
} 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2020-12-10T14:30:40.447

**添加应用程序以在 Windows 10 中启动时自动运行**

第 1 步：选择 Windows**开始**按钮并滚动查找要在启动时运行的应用程序。

第 2 步：右键单击应用程序，选择**更多**，然后选择**打开文件位置**。这将打开保存应用程序快捷方式的位置。如果没有**Open file location**选项，则意味着应用程序无法在启动时运行。

[![在此处输入图像描述](https://i.stack.imgur.com/PizUe.png)](https://i.stack.imgur.com/PizUe.png)

第 3 步：打开文件位置，按**Windows 徽标键 + R**，键入**shell:startup**，然后选择**OK**。这将打开**启动**文件夹。

[![在此处输入图像描述](https://i.stack.imgur.com/4qjra.png)](https://i.stack.imgur.com/4qjra.png)

第 4 步：将应用程序的快捷方式从文件位置复制并粘贴或创建到**启动**文件夹。

[![在此处输入图像描述](https://i.stack.imgur.com/541Iw.png)](https://i.stack.imgur.com/541Iw.png)

# mysql - 新 mysql 表中的高开销

> ID：674629
> 
> 赞同：3
> 
> 时间：2009-03-23T18:24:41.827
> 
> 标签：mysql, overhead

有谁知道为什么我在新创建的表（零行）上得到 131.0 MiB 的开销？我正在使用 phpmy admin，我的脚本代码是

```
CREATE  TABLE IF NOT EXISTS `mydb`.`mytable` (
  `idRol` INT NOT NULL AUTO_INCREMENT ,
  `Rol` VARCHAR(45) NOT NULL ,
  PRIMARY KEY (`idRol`) )
ENGINE = InnoDB; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T18:30:56.757

InnoDB 使用共享表空间。这意味着默认情况下，无论数据库如何，所有表都存储在文件系统中的单个文件中。这与例如将每个表存储为单个文件的 MyISAM 不同。

InnoDB 的行为是可以改变的，虽然我认为在这种情况下没有必要。请参阅[使用每表表空间](http://dev.mysql.com/doc/refman/5.1/en/multiple-tablespaces.html)。

开销可能是删除行留下的空间，InnoDB 会在你插入新数据时重用它。这没什么好担心的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:29:55.090

这可能是因为 mysql 在 'idRol' 上生成了一个索引

存储索引需要一些空间，但我不确定这是否是原因。这只是一个猜测。我不是 DBA。

# c# - 通用列表 FindAll() 与 foreach

> ID：674632
> 
> 赞同：31
> 
> 时间：2009-03-23T18:25:55.223
> 
> 标签：c#, .net, generics

我正在查看通用列表以查找基于某个参数的项目。

一般来说，最好和最快的实现是什么？
1\. 遍历列表中的每个项目并将每个匹配项保存到新列表并返回

```
foreach(string s in list)
{ 
    if(s == "match")
    {
       newList.Add(s);
    }
} 

return newList; 
```

或者
2\. 使用 FindAll 方法并将委托传递给它。

```
newList = list.FindAll(delegate(string s){return s == "match";}); 
```

他们不是都在〜O（N）中运行吗？这里的最佳做法是什么？

问候，乔纳森

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-23T19:10:14.773

您绝对应该使用该`FindAll`方法或等效的 LINQ 方法。此外，如果可以，请考虑使用更简洁的 lambda 代替您的委托（需要 C# 3.0）：

```
var list = new List<string>();
var newList = list.FindAll(s => s.Equals("match")); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-23T18:29:40.253

在这种情况下，我会使用该[`FindAll`方法](http://msdn.microsoft.com/en-us/library/fh1w7y8z.aspx)，因为它更简洁，而且 IMO 更易于阅读。

您是对的，它们几乎都将在 O(N) 时间内执行，尽管该[`foreach`语句](http://msdn.microsoft.com/en-us/library/ttw7t8t6%28v=vs.80%29.aspx) *应该**稍微*快一些，因为它不必执行委托调用（与直接调用方法相比，委托会产生轻微的开销） .

我必须强调这种差异是多么微不足道，除非您在*大量*列表上执行*大量*操作，否则它很可能永远不会产生影响。

 *与往常一样，进行测试以查看瓶颈在哪里并采取适当的行动。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-23T18:38:22.603

乔纳森，

您可以在[Linq To Action](http://linqinaction.net/)的第 5 章（性能考虑）中找到一个很好的答案。

他们为每个执行大约 50 次的搜索测量 a，得出 foreach = 68ms/周期 / List.FindAll = 62ms/周期。真的，创建一个测试并亲自查看可能符合您的利益。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-03-23T18:30:26.023

List.FindAll 是 O(n) 并且将搜索整个列表。

如果您想使用 foreach 运行自己的迭代器，我建议使用 yield 语句，并尽可能返回 IEnumerable。这样，如果您最终只需要集合中的一个元素，它会更快（因为您可以在不耗尽整个集合的情况下停止调用者）。

否则，坚持使用 BCL 接口。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-23T18:33:07.687

任何性能差异都将非常小。为了清楚起见，我建议使用 FindAll，或者，如果可能，建议使用 Enumerable.Where。我更喜欢使用 Enumerable 方法，因为它可以在重构代码时提供更大的灵活性（您不依赖于`List<T>`）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T19:10:57.940

是的，它们的实现都是 O(n)。他们需要查看列表中的每个元素以找到所有匹配项。在可读性方面，我也更喜欢 FindAll。出于性能考虑，请查看[LINQ in Action](http://linqinaction.net/) (Ch 5.3)。如果您使用的是 C# 3.0，您还可以应用 lambda 表达式。但这只是锦上添花：

```
var newList = aList.FindAll(s => s == "match"); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-23T19:14:15.840

我与 Lambdas

```
List<String> newList = list.FindAll(s => s.Equals("match")); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-24T01:59:55.443

除非 C# 团队改进了`LINQ`and的性能，否则`FindAll`下面的文章似乎表明`for`and会在对象枚举上`foreach`优于`LINQ`and ： [LINQ on Objects Performance](http://architecture-blog.rdacorp.com/2009/03/linq-on-objects-performance.html)。`FindAll`

这篇文章可以追溯到 2009 年 3 月，就在这篇文章最初询问之前。

# c++ - 指向数组元素的成员指针

> ID：674635
> 
> 赞同：15
> 
> 时间：2009-03-23T18:26:20.870
> 
> 标签：c++, class, pointers

可以定义一个指向成员的指针并在以后使用它：

```
struct foo
{
  int a;
  int b[2];
};

int main()
{

  foo bar;
  int foo::* aptr=&foo::a;
  bar.a=1;
  std::cout << bar.*aptr << std::endl;
} 
```

现在我需要一个指向数组特定元素的指针，所以通常我会写
`int foo::* bptr=&(foo::b[0]);`
但是，编译器只是抱怨`"invalid use of non-static data member 'foo::b'`“是否可以这样做（或者至少没有联合）？

**编辑：**我需要一个指向数组特定元素的指针，因此`int foo::* ptr`指向数组的第二个元素（`foo::b[1]`）。

**另一个编辑：**我需要通过 访问数组中的元素`bar.*ptr=2`，因为指针在其他地方使用，所以不能用`bar.*ptr[1]=2`or调用它`*ptr=2`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T18:33:21.213

> 但是，编译器只是抱怨“无效使用非静态数据成员 'foo::b'”

这是因为`foo::a`和`foo::b`有不同的类型。更具体地说，`foo::b`是一个大小为 2 的数组`int`。您的指针声明必须兼容，即：

```
int (foo::*aptr)[2]=&foo::b; 
```

> 是否有可能做到这一点（或至少没有工会）？

是的，见下文：

```
struct foo
{
  int a;
  int b[2];
};

int main()
{

  foo bar;

  int (foo::*aptr)[2]=&foo::b;
  /* this is a plain int pointer */
  int *bptr=&((bar.*aptr)[1]);

  bar.a=1; 
  bar.b[0] = 2;
  bar.b[1] = 11;

  std::cout << (bar.*aptr)[1] << std::endl;
  std::cout << *bptr << std::endl;
} 
```

更新了 OP 要求的帖子。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T18:53:08.793

问题是，访问数组中的项目是访问普通 int 的另一个间接级别。如果该数组是一个指针，那么您不会期望能够通过成员指针访问 int。

```
struct foo
{
  int a;
  int *b;
};

int main()
{

  foo bar;
  int foo::* aptr=&(*foo::b); // You can't do this either!
  bar.a=1;
  std::cout << bar.*aptr << std::endl;
} 
```

您可以做的是定义返回您想要的 int 的成员函数：

```
struct foo
{
  int a;
  int *b;
  int c[2];

  int &GetA() { return a; } // changed to return references so you can modify the values
  int &Getb() { return *b; }
  template <int index>
  int &GetC() { return c[index]; }
};
typedef long &(Test::*IntAccessor)();

void SetValue(foo &f, IntAccessor ptr, int newValue)
{  
    cout << "Value before: " << f.*ptr();
    f.*ptr() = newValue;
    cout << "Value after: " << f.*ptr();
}

int main()
{
  IntAccessor aptr=&foo::GetA;
  IntAccessor bptr=&foo::GetB;
  IntAccessor cptr=&foo::GetC<1>;

  int local;
  foo bar;
  bar.a=1;
  bar.b = &local;
  bar.c[1] = 2;

  SetValue(bar, aptr, 2);
  SetValue(bar, bptr, 3);
  SetValue(bar, cptr, 4);
  SetValue(bar, &foo::GetC<0>, 5);
} 
```

然后你至少有一个一致的接口来允许你改变 foo 的不同值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-01-25T23:10:24.970

2020年更新，实际解决方案：

*   该标准目前没有指定任何实际使用成员指针的方式，以允许算术或任何东西获取指向“内部”数组元素的指针
*   OTOH，标准库现在拥有自己修补适当的成员指针类的所有必需品，即使使用数组元素访问也是如此。

首先，成员指针通常被实现为“只是偏移量”，虽然很可怕。让我们看一个例子（在 g++9，arch amd64 上）：

```
struct S { int a; float b[10]; };

float(S::*mptr)[10] = &S::b;
*reinterpret_cast<uintptr_t *>(&mptr)  //this is 4

int S::*iptr = &S::a;
*reinterpret_cast<uintptr_t *>(&iptr)  //this is 0

iptr = nullptr;
*reinterpret_cast<uintptr_t *>(&iptr)  //this seems to be 18446744073709551615 on my box 
```

相反，您可以制作一些包装器（它很长，但我不想删除便利运算符）：

```
#include <type_traits>

template<class M, typename T>
class member_ptr
{
    size_t off_;
public:
    member_ptr() : off_(0) {}
    member_ptr(size_t offset) : off_(offset) {}

    /* member access */
    friend const T& operator->*(const M* a, const member_ptr<M, T>& p)
    { return (*a)->*p; }
    friend T& operator->*(M* a, const member_ptr<M, T>& p)
    { return (*a)->*p; }

    /* operator.* cannot be overloaded, so just take the arrow again */
    friend const T& operator->*(const M& a, const member_ptr<M, T>& p)
    { return *reinterpret_cast<const T*>(reinterpret_cast<const char*>(&a) + p.off_); }
    friend T& operator->*(M& a, const member_ptr<M, T>& p)
    { return *reinterpret_cast<T*>(reinterpret_cast<char*>(&a) + p.off_); }

    /* convert array access to array element access */
    member_ptr<M, typename std::remove_extent<T>::type> operator*() const
    { return member_ptr<M, typename std::remove_extent<T>::type>(off_); }

    /* the same with offset right away */
    member_ptr<M, typename std::remove_extent<T>::type> operator[](size_t offset) const
    { return member_ptr<M, typename std::remove_extent<T>::type>(off_)+offset; }

    /* some operators */
    member_ptr& operator++()
    { off_ += sizeof(T); return *this; };
    member_ptr& operator--()
    { off_ -= sizeof(T); return *this; };
    member_ptr operator++(int)
    { member_ptr copy; off_ += sizeof(T); return copy; };
    member_ptr operator--(int)
    { member_ptr copy; off_ -= sizeof(T); return copy; };

    member_ptr& operator+=(size_t offset)
    { off_ += offset * sizeof(T); return *this; }
    member_ptr& operator-=(size_t offset)
    { off_ -= offset * sizeof(T); return *this; }
    member_ptr operator+(size_t offset) const
    { auto copy = *this; copy += offset; return copy; }
    member_ptr operator-(size_t offset) const
    { auto copy = *this; copy -= offset; return copy; }

    size_t offset() const { return off_; }
};

template<class M, typename T>
member_ptr<M, T> make_member_ptr(T M::*a)
{ return member_ptr<M, T>(reinterpret_cast<uintptr_t>(&(((M*)nullptr)->*a)));} 
```

现在我们可以直接将指针指向数组元素：

```
auto mp = make_member_ptr(&S::b)[2];
S s;
s->*mp = 123.4;

// s.b[2] is now expectably 123.4 
```

最后，如果您真的非常喜欢具体化的引用，您可能会变得有点像haskell-lensish 并让它们组成：

```
// in class member_ptr, note transitivity of types M -> T -> TT:
    template<class TT>
    member_ptr<M,TT> operator+(const member_ptr<T,TT>&t)
    { return member_ptr<M,TT>(off_ + t.offset()); }

// test:
struct A { int a; };
struct B { A arr[10]; };

B x;
auto p = make_member_ptr(&B::arr)[5] + make_member_ptr(&A::a)

x->*p = 432.1;
// x.arr[5].a is now expectably 432.1 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-23T20:50:00.807

你不能在语言本身之外做到这一点。但是你可以通过提升。将仿函数绑定到该数组的某个元素并将其分配给 a `boost::function`：

```
#include <boost/lambda/lambda.hpp>
#include <boost/lambda/bind.hpp>
#include <boost/function.hpp>
#include <iostream>

struct test {
    int array[3];
};

int main() {
    namespace lmb = boost::lambda;

    // create functor that returns test::array[1]
    boost::function<int&(test&)> f;
    f = lmb::bind(&test::array, lmb::_1)[1];

    test t = {{ 11, 22, 33 }};
    std::cout << f(t) << std::endl; // 22

    f(t) = 44;
    std::cout << t.array[1] << std::endl; // 44
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T18:35:31.283

```
 typedef int (foo::*b_member_ptr)[2];
  b_member_ptr c= &foo::b; 
```

一切正常。

成员和函数指针使用的小技巧。
试着写

```
char c = &foo::b; // or any other function or member pointer 
```

并且在编译器错误中，您将看到针对您的情况的预期类型`int (foo::*)[2]`。

**编辑**
如果没有这个指针，我不确定你想要什么是合法的。要为您的指针添加 1 个偏移量，您应该从成员数组上的指针获取数组上的指针。但是你可以在没有这个的情况下取消引用成员指针。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-14T14:37:09.523

我不确定这是否对您有用，但我想做类似的事情并通过从另一个方向解决问题来解决它。在我的课堂上，我有几个对象，我想通过命名标识符访问它们或在循环中迭代它们。我没有在数组中的某处创建指向对象的成员指针，而是简单地单独声明了所有对象并创建了指向对象的成员指针的静态数组。

像这样：

```
struct obj
{
    int somestuff;
    double someotherstuff;
};

class foo
{
  public:
    obj apples;
    obj bananas;
    obj oranges;

    static obj foo::* fruit[3];

    void bar();
};

obj foo::* foo::fruit[3] = { &foo::apples, &foo::bananas, &foo::oranges };

void foo::bar()
{
    apples.somestuff = 0;
    (this->*(fruit[0])).somestuff = 5;
    if( apples.somestuff != 5 )
    {
        // fail!
    }
    else
    {
        // success!
    }
}

int main()
{
    foo blee;
    blee.bar();
    return 0;
} 
```

它似乎对我有用。我希望这会有所帮助。

# scala - Scala 将 Collection 转换为 Map-by-key 的最佳方式？

> ID：674639
> 
> 赞同：172
> 
> 时间：2009-03-23T18:26:59.090 标记“现在”
> 
> 标签：scala, map, scala-collections

如果我有一个`c`类型的集合`T`并且有一个属性`p`（例如`T`type `P`），那么执行*map-by-extracting-key*的最佳方法是什么？

```
val c: Collection[T]
val m: Map[P, T] 
```

一种方法如下：

```
m = new HashMap[P, T]
c foreach { t => m add (t.getP, t) } 
```

但现在我需要一个*可变*地图。有没有更好的方法来做到这一点，让它在 1 行，我最终得到一个*不可变*的地图？（显然我可以将上面的内容变成一个简单的库实用程序，就像在 Java 中一样，但我怀疑在 Scala 中没有必要）

* * *

## 回答 #1

> 赞同：248
> 
> 时间：2010-07-14T18:56:24.533

您可以使用

```
c map (t => t.getP -> t) toMap 
```

但请注意，这需要 2 次遍历。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-23T21:11:37.087

您可以使用可变数量的元组构造一个 Map。因此，使用集合上的 map 方法将其转换为元组集合，然后使用 :_* 技巧将结果转换为变量参数。

```
scala> val list = List("this", "maps", "string", "to", "length") map {s => (s, s.length)}
list: List[(java.lang.String, Int)] = List((this,4), (maps,4), (string,6), (to,2), (length,6))

scala> val list = List("this", "is", "a", "bunch", "of", "strings")
list: List[java.lang.String] = List(this, is, a, bunch, of, strings)

scala> val string2Length = Map(list map {s => (s, s.length)} : _*)
string2Length: scala.collection.immutable.Map[java.lang.String,Int] = Map(strings -> 7, of -> 2, bunch -> 5, a -> 1, is -> 2, this -> 4) 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-24T18:39:42.063

除了@James Iry 的解决方案之外，还可以使用折叠来完成此操作。我怀疑这个解决方案比元组方法稍快（创建的垃圾对象更少）：

```
val list = List("this", "maps", "string", "to", "length")
val map = list.foldLeft(Map[String, Int]()) { (m, s) => m(s) = s.length } 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-12-13T17:49:15.387

这可以通过按如下方式折叠集合来实现不变，并且只需一次遍历即可。

```
val map = c.foldLeft(Map[P, T]()) { (m, t) => m + (t.getP -> t) } 
```

该解决方案之所以有效，是因为添加到不可变 Map 会返回一个带有附加条目的新不可变 Map，并且该值通过折叠操作用作累加器。

这里的权衡是代码的简单性与其效率。因此，对于大型集合，这种方法可能比使用 2 种遍历实现（例如应用`map`和`toMap`.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-10-28T19:24:04.243

另一种解决方案（可能不适用于所有类型）

```
import scala.collection.breakOut
val m:Map[P, T] = c.map(t => (t.getP, t))(breakOut) 
```

这避免了中间列表的创建，更多信息在这里： [Scala 2.8 breakOut](https://stackoverflow.com/questions/1715681/scala-2-8-breakout)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-12-03T15:58:06.873

你想要达到的目标有点不确定。
如果两个或多个项目`c`共享相同`p`怎么办？哪个项目将映射到`p`地图中的那个？

更准确的查看方法是在`p`所有`c`拥有它的项目之间生成一个映射：

```
val m: Map[P, Collection[T]] 
```

这可以通过[groupBy](http://www.scala-lang.org/api/current/index.html#scala.collection.GenTraversableLike@groupBy[K](f:A=%3EK):scala.collection.GenMap[K,Repr])轻松实现：

```
val m: Map[P, Collection[T]] = c.groupBy(t => t.p) 
```

如果您仍然想要原始地图，例如，您可以映射`p`到第一个`t`拥有它的地图：

```
val m: Map[P, T] = c.groupBy(t => t.p) map { case (p, ts) =>  p -> ts.head } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-12-04T10:37:56.940

```
c map (_.getP) zip c 
```

效果很好，非常直观

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-07-27T06:22:49.880

这可能不是将列表转换为映射的最有效方法，但它使调用代码更具可读性。我使用隐式转换将**mapBy**方法添加到 List：

```
implicit def list2ListWithMapBy[T](list: List[T]): ListWithMapBy[T] = {
  new ListWithMapBy(list)
}

class ListWithMapBy[V](list: List[V]){
  def mapBy[K](keyFunc: V => K) = {
    list.map(a => keyFunc(a) -> a).toMap
  }
} 
```

调用代码示例：

```
val list = List("A", "AA", "AAA")
list.mapBy(_.length)                  //Map(1 -> A, 2 -> AA, 3 -> AAA) 
```

注意因为隐式转换，调用者代码需要导入scala的implicitConversions。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-07-03T20:25:23.823

使用 zip 和 toMap 怎么样？

```
myList.zip(myList.map(_.length)).toMap 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-04T10:07:23.747

对于它的价值，这里有两种*毫无意义*的方法：

```
scala> case class Foo(bar: Int)
defined class Foo

scala> import scalaz._, Scalaz._
import scalaz._
import Scalaz._

scala> val c = Vector(Foo(9), Foo(11))
c: scala.collection.immutable.Vector[Foo] = Vector(Foo(9), Foo(11))

scala> c.map(((_: Foo).bar) &&& identity).toMap
res30: scala.collection.immutable.Map[Int,Foo] = Map(9 -> Foo(9), 11 -> Foo(11))

scala> c.map(((_: Foo).bar) >>= (Pair.apply[Int, Foo] _).curried).toMap
res31: scala.collection.immutable.Map[Int,Foo] = Map(9 -> Foo(9), 11 -> Foo(11)) 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-09-01T14:14:18.250

斯卡拉 2.13+

而不是“breakOut”，你可以使用

`c.map(t => (t.getP, t)).to(Map)`

滚动到“查看”：[https ://www.scala-lang.org/blog/2017/02/28/collections-rework.html](https://www.scala-lang.org/blog/2017/02/28/collections-rework.html)

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2015-02-25T06:21:46.087

这对我有用：

```
val personsMap = persons.foldLeft(scala.collection.mutable.Map[Int, PersonDTO]()) {
    (m, p) => m(p.id) = p; m
} 
```

Map 必须是可变的，并且 Map 必须返回，因为添加到可变 Map 不会返回地图。

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2017-12-24T11:40:05.233

在集合上使用 map()，然后使用 toMap

```
val map = list.map(e => (e, e.length)).toMap 
```

# .net - 解析 resx 引用

> ID：674642
> 
> 赞同：1
> 
> 时间：2009-03-23T18:27:33.723
> 
> 标签：.net, asp.net, visual-studio, resx

当我编译我的 .NET 1.1 ASP.NET 应用程序时，我遇到了 RESX 参考问题。如何轻松地强制 VS2003 转储所有这些引用（我没有使用它们）并强制重建它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-26T18:10:17.047

您可以使用允许您使用正则表达式并对此正则表达式进行查找和替换的文本编辑器

^.*\n. *resx\"\n。* \n. *EmbeddedResource。* \n.*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T19:43:26.157

我同意 Danny 的观点，我会打开 .sln 文件以查看它在哪里引用了冲突的 RESX 并删除它们。

# asp.net - 将单选按钮与相应的标签对齐

> ID：674643
> 
> 赞同：15
> 
> 时间：2009-03-23T18:27:36.203
> 
> 标签：asp.net, css

我正在使用 ASP.NET 单选按钮列表控件。

它生成以下 HTML。

```
 <table>
            <tr>
                <td>
                    <input type="radio"/>
                    <label >
                        label 1</label>
                </td>
                <td>
                    <input  type="radio" 
                        value="False" checked="checked" />
                    <label >
                        label 2</label></td>                   
            </tr>
        </table> 
```

到目前为止一切看起来都很好（至少对用户而言），标签与单选按钮对齐。

但是，当我将字体调整为 10 像素时，标签的大小显然看起来更小，但这样做的副作用是标签看起来也与单选按钮的底部对齐。我需要一个标签来对齐单选按钮的中间。

我可以在 IE 中使用以下 css 执行此操作：

```
 <style type="text/css">
    label
    {
        font-size:10px; 
        line-height:12px;
        vertical-align:middle;
    } 
</style> 
```

但是这在 Firefox 或 Chrome 中不起作用

有什么建议么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-23T18:30:15.243

而不是这个：

```
label {
  font-size: 10px;
  line-height: 12px;
  vertical-align: middle;
} 
```

试试这个：

```
label, input[type="radio"] {
  font-size: 10px;
  vertical-align: middle;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-24T10:15:34.520

该属性选择器在 IE6 中不起作用——我发现的最简单的方法是在单选按钮中添加一个“radio”类，因此 CSS 变为：

```
label, input.radio{
  font-size:10px; 
  vertical-align:middle;
} 
```

当然，表格不是那种形式的正确标记——我个人更喜欢定义列表，在 DT 中带有标签，在 DD 中输入。在我看来，这在语义上是可以的 - 您正在显示用户需要定义（输入）的术语（标签）列表。

标记看起来像这样：

```
<dl class="formStructure">
    <dt class="radio"><label for="option1">Yes</label></dt>
    <dd class="radio"><input type="radio" name="option" id="option1" value="yes"/></dd>

    <dt class="radio"><label for="option2">No</label></dt>
    <dd class="radio"><input type="radio" name="option" id="option2" value="no"/></dd>
</dl> 
```

# database - 数据库更新顺序

> ID：674644
> 
> 赞同：2
> 
> 时间：2009-03-23T18:27:36.437
> 
> 标签：database, postgresql

我在我们的数据库中遇到了一种情况，我需要将许多记录的时间戳移动一天，但是我有一个唯一的约束，它要求一个 id 字段和一个时间戳字段是唯一的。

这是表格说明。

```
表“public.eedata”
   专栏 | 类型 | 修饰符                          
-------------+--------------------------------+--- -------------------------------------------------- --------
 eedata_id | 大整数 | 不为空默认 nextval('eedata_eedata_id_seq'::regclass)
 用户 ID | 整数 |
 eeupload_id | 大整数 |
 eetimestamp | 没有时区的时间戳（0）|
索引：
    “pk_eedata”主键，btree (eedata_id)
    "eedata_user_id_key" 唯一，btree (user_id, eetimestamp)
    “fki_eeuploadid” btree (eeupload_id)
外键约束：
    "fk_eeupload_id" 外键 (eeupload_id) 参考 eeupload(eeupload_id) ON UPDATE CASCADE ON DELETE CASCADE
    "fk_user_id" FOREIGN KEY (user_id) REFERENCES users(user_id) ON UPDATE CASCADE ON DELETE CASCADE

```

这种情况下的问题是由 eedata_user_id_key 约束引起的。我可以使用成功减去一天，

```
更新 eedata 集 eetimestamp = eetimestamp - 间隔“1 天”，其中 eeupload_id = xxx；
```

因为它应用更新的顺序可以防止任何冲突，但是当我尝试

```
更新 eedata 集 eetimestamp = eetimestamp + 间隔 '1 天' 其中 eeupload_id = xxx;
```

我明白了

```
错误：重复键违反唯一约束“eedata_user_id_key”
```

我需要做的是指定应用更新的顺序（实际上是更新语句的顺序）或暂停单个更新语句的约束的能力。

如果这很重要，我正在使用 Postgres 8.1.11。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T18:31:03.807

您能否在更新期间删除约束，然后在完成后将其重新添加？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:36:49.660

我最近遇到了类似的问题 - 我有 2008 年 9 月结束的测试数据，我需要它是更新的。我把它移了六个月，但有一些重复。我需要做的是在创建重复项之前检测它们，并对现有行进行更新，而不是对新行进行插入。

# php - 在html中保留嵌套的jquery可排序列表？

> ID：674645
> 
> 赞同：1
> 
> 时间：2009-03-23T18:27:37.013
> 
> 标签：php, javascript, jquery, nested, jquery-ui-sortable

**问题：**

我的配置页面上有一个嵌套列表，如下所示：

```
<a id='Save'>Save<a>
<ul id='configuration-list'>
   <li id='e1'>Elem A
      <ul>
          <li id='ey'>Elem Y </li>
          <li id='ex'>Elem X
             <ul><!-- and so on until 5 levels of nesting --></ul>
          </li>
          <li id='ez'>Elem Z </li>
      </ul>
   </li>
   <li id='e45'>
      <ul>
         <!-- more li's and ul's nesting here -->
      </ul>
   </li>
 <!-- even more li's and ul's nesting here -->
   <li id='eN'>
   </li>

</ul> 
```

列表中的每个 li 内部都可以有另一个无序列表，其中包含 li，其中可以包含其他无序列表。

所有列表都是可排序的，使用 jquery ui.sortable 插件。无法通过列表切换项目。

列表中的节点总数超过 1k。

保存配置（保存链接）后，我必须将列表顺序配置（从第一个到最深的节点）发送到服务器，服务器将解析它并将所有元素顺序保存在数据库中。为此，使用了 php。

**问题：**

解析配置的“最佳”或错误较少的方法是什么，我应该如何将它传递给我的 php 解析器？

是否有一种类似于`$('#configuration-list').sortable('serialize')`或`$('#configuration-list').sortable('toArray')`生成我的所有结构的 xml、JSON 或类似的方法？ui.sortable 的扩展或其他具有此功能的插件？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T18:39:47.623

不清楚 <li> 是否包含单选/检查/文本框，因此建议可能会有所不同。很久以前（我想是 5-6 年）我遇到过类似的情况，那次我使用了回忆数组结构的名称（如果我没记错的话，太旧的记忆：/）

IE

```
<input type="text" name="nodes[node1][item1]" />
<input type="text" name="nodes[node1][item2]" /> 
```

也许它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:37:47.220

[`.sortable('serialize')`接受一个可选的第二个参数](http://docs.jquery.com/UI/API/1.7.1/Sortable#method-serialize)（或者，`serialize()`接受一个参数。上帝我讨厌插件 api）：

> 确保 id 属性包含下划线。它们必须采用以下形式： `"set_number"`例如，具有 id 属性的 3 元素列表， `foo_1`将序列化为 。您可以使用下划线、等号或连字符来分隔集合和数字。例如or或全部序列化为.`foo_5``foo_2``foo[]=1&foo[]=5&foo[]=2``foo=1``foo-1``foo_1``foo[]=1`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-18T10:41:15.350

当您保存大型嵌套集时，您应该考虑嵌套集模型，它是一种将分层数据存储在平面表中的不同方法，MySQL 或任何其他非 XML 数据库都是如此。NSM 使用左右两个数字来定义集合的范围和其中的所有子项。

一个对我非常有用的链接：http: [//mikehillyer.com/articles/managing-hierarchical-data-in-mysql/](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

在您的 PHP 控制器（或在保存数据之前处理/控制数据的任何地方）中，您可以简单地遍历您的配置。在这种情况下，我更喜欢将数组值用于表单输入，就像其他海报所说的那样。

您应该为此使用表单元素，我更喜欢隐藏字段，将字段名称命名为 node_# ，其中 # 代表子项的父 ID。然后该值必须是当前孩子的 ID。

使用简单的 for 循环遍历“node_#”并从元素值 1 中获取数组值 1。当节点经过时，将具有相同父节点的每个节点的排序顺序增加 1。

样本：

```
<input type="hidden" name="node_1[]" value="4"/> 
<input type="hidden" name="node_1[]" value="5"/>
<input type="hidden" name="node_1[]" value="6"/>
<input type="hidden" name="node_1[]" value="7"/> 
```

然后节点 4 t/m 7 将作为数组存储在 $_POST["node_1"] 中。

# asp.net - 上传超过 Asp.net 请求长度限制的文件？

> ID：674651
> 
> 赞同：1
> 
> 时间：2009-03-23T18:28:43.657
> 
> 标签：asp.net, upload, file-upload

我搜索了 SO 并找到 [了这个问题](https://stackoverflow.com/questions/126167/asp-net-how-to-show-a-error-page-when-uploading-big-file-maximum-request-lengt)，但这并不是我要问的。我想知道是否可以创建一个可以检查请求的 ContentLength 的 IHttpModule，如果可以，则重定向或以某种方式抛出该请求并创建一个新请求。

具体来说，我正在尝试处理图像文件上传，但我想让请求继续到上传页面并发出某种警告，而不是一个平面错误页面。我有这段代码受到很大的请求：

```
 private void context_BeginRequest(object sender, EventArgs e)
    {
        HttpApplication application = (HttpApplication)sender;
        HttpContext context = application.Context;

        if (context.Request.ContentLength > (4 * 1024 * 1024))
        {

        }
    } 
```

执行路径像我想要的那样进入这个 IF 块。但从这里开始，我真的不知道该去哪里。这是一个不好的方法吗？

编辑：按原样（没有此模块），Fiddler 报告 IIS 正在返回 500 代码。我想避免这种情况，并让代码从请求的页面返回 200，就像我说的那样发出警告。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T21:59:44.373

由于 HTTP 的性质，在读取所有请求数据之前，您实际上无法返回任何内容。当您收到超大请求时，您有两种选择：

*   读入所有数据，然后返回一个漂亮的错误页面。这听起来不错，但意味着用户必须等待上传完成才能收到他无法上传的消息。它还打开了一个可能的 DOS 攻击漏洞
*   立即终止请求。这给用户一个蹩脚的断开页面，但保留了安全性。

还有第三种选择——使用一个高级组件，它提供了很好的错误消息和安全性。您可以仅使用 Flash 组件，并且其中有很多组件，但是当然，如​​果用户没有 Flash，那么您就不走运了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T18:47:22.817

读一读[_](http://nishantrana.wordpress.com/2009/01/19/fileupload-page-cannot-be-displayed-and-maximum-request-length-exceeded-error/) _

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T18:55:40.160

如果您只想向用户提供有关大图像上传状态的反馈，那么我建议您考虑使用基于 Ajax 或 Flash 的上传组件之一。其中大约有一百万个，并且大多数都有非常好的用户反馈。他们还可以处理大文件，并且许多还可以同时处理多个文件上传。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T18:47:17.387

上面的答案在 IIS 7.5 上对我不起作用。我们最终得出以下结论：

```
 void Application_PreSendRequestHeaders(Object sender, EventArgs e)
    {
        if (
            Request.Headers["Content-Length"] != null && 
            int.Parse(Request.Headers["Content-Length"]) > 150000000 &&
            Request.RawUrl.EndsWith("/ProjectReleases.aspx?Mode=Create", StringComparison.OrdinalIgnoreCase))
        {
            try
            {
                Response.Redirect("http://anyurl", true);
            }
            catch (HttpException ex)
            {
                if (String.Compare(ex.Message, "Maximum request length exceeded.", StringComparison.Ordinal) != 0)
                {
                    Server.ClearError();
                    Response.ClearHeaders();
                    Response.Redirect("http://www.edward-williams.com", true);
                }
            }
        }
    } 
```

Didn't have to modify the max upload size. Granted the final version actaully set a static value for the max upload size based on the value in the web.config and redirected to a custom error page vs that homepage, but you get the idea.

# ssis - 如何在 SSIS 的服务器上启动 EXE？

> ID：674662
> 
> 赞同：0
> 
> 时间：2009-03-23T18:30:38.893
> 
> 标签：ssis

我在 Server1 上有 c:\Program Files\Myexe.exe 我在 MyPC1 上运行 BIDS 包，但无法启动它。在任务管理器的服务器上，我看到进程已启动，但它挂起，可能是因为安全警告。

谢谢，

尼科尔茨

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T18:35:06.637

如果您看到程序启动，那么您已经成功启动它！

您现在需要找出它挂起的原因。你指的是什么安全警告？

程序有用户界面吗？如果是这样，如果远程启动它不会很好地工作 - 你希望它与哪个用户交谈？

# java - 如何在新项目中重用eclipse启动文件

> ID：674669
> 
> 赞同：2
> 
> 时间：2009-03-23T18:31:34.897
> 
> 标签：java, eclipse, svn, selenium

我刚刚在 Eclipse 中签出了一个 svn 项目作为一个 java 项目。其中有几个运行启动文件我想重用但不知道如何指向“运行”来查看这些启动文件或使用它。任何提示？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T11:49:30.067

通常这些会被项目自动拾取并放置在运行菜单中。如果不是，请右键单击 .launch 文件，然后选择“运行方式”并选择第一个选项。这将使用该运行配置运行。

# php - IE 中的 PHP 问题“提供的参数不是有效的流资源”

> ID：674682
> 
> 赞同：0
> 
> 时间：2009-03-23T18:36:56.943
> 
> 标签：php, internet-explorer

我设置了一个东西，以便从我网站上的各个位置链接到一个名为“linktothis.php”的页面，该页面将包含指向引用页面的链接。它在 Firefox 中运行良好，但 IE 似乎给它带来了麻烦，它告诉我：

```
Warning: fread(): supplied argument is not a valid stream resource in /usr/local/apache/sites/nextadvisor/linktothis.php on line 19 
```

（第 19 行是下面的第 4 行）

```
<?php
$filesource = $_SERVER['HTTP_REFERER'];
$a = fopen($filesource,"r"); //fopen("html_file.html","r");
$string = fread($a,1024);
if (eregi("<linkto>(.*)</linkto>", $string, $out)) {
    $outdata = $out[1];
}
//echo $outdata;
$outdatapart = explode( " " , $outdata);
echo $part[0];
if (empty($outdata)) if (eregi("<title>(.*)</title>", $string, $out)) {
    $outdata = $out[1];
}
//echo $outdata;
$outdatapart = explode( " " , $outdata);
echo $part[0];
?> 
```

我需要切换什么才能在 IE 中工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T18:41:15.157

可能是您的 IE 没有为您的脚本提供引用页面吗？尝试 var__dump($_SERVER) 来验证这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T18:43:23.543

应该是问题`$_SERVER['HTTP_REFERER'];`。尝试在 Ie 中回显这个变量，看看它包含什么。

# google-app-engine - 在开发服务器中消失 Expando dynamic_properties

> ID：674688
> 
> 赞同：0
> 
> 时间：2009-03-23T18:38:44.723
> 
> 标签：google-app-engine

我一直在开发一个使用 Expando 类来存储信息的 AppEngine 站点。我可以成功地将属性存储在开发服务器中。我通过开发人员（Web）控制台验证信息是否存在，但是当我运行代码时，我遇到以下问题：
-`hasattr(myobj, attr_name)`函数返回 false
-`getattr(myobj, attr_name)`函数引发异常
-`myobj.attr_name`引发异常
-`myobj.dynamic_properties()`返回空列表

所有这些都发生在开发（Web）控制台报告该属性仍然存在时。

此外，如果我设置一个新属性（并将其提交到数据存储区），旧属性就会消失。此类最近已从 db.Model 子类更改为 Expando 子类。更奇怪的是，另一个 Expando 子类正确地报告了它的动态属性。

我重新安装了开发服务器（Mac OS X 10.5.6 上的 GoogleAppEngineLauncher 1.1.9）并清除了数据存储区，但没有成功。我有点卡住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-19T17:11:07.127

我想通了。显然我正在使用超类'

```
Model.get('key') 
```

方法，而不是

```
db.get('key') 
```

呃。

# java - 使用 jUnit 测试数据目录

> ID：674689
> 
> 赞同：6
> 
> 时间：2009-03-23T18:39:06.580
> 
> 标签：java, unit-testing, junit

我正在编写一些依赖于数据文件的 jUnit 测试。这些数据文件应该去哪里？我将如何（在 jUnit 测试中）获取该目录的位置？

在 Python 中，我会使用类似于：

```
datadir = os.dirname(__file__) + "/data/" 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T19:04:29.937

有点取决于您使用数据文件的目的，但一般来说，只需创建一个包并确保它位于您的类路径中。要从“数据”包加载属性文件，请添加“MyData.props”文件，您可以使用加载属性文件，如：

```
this.getClass().getClassLoader().getResourceAsStream("/data/MyData.props"); 
```

同样，不确定这是否回答了您的问题，因为我不是 100% 确定您要做什么，但我希望它有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:41:26.120

使您的测试数据靠近您的测试类（相同的包）。正如 todd.run 所建议的，用于`getResourceAsStream()`访问您的数据文件。

# python - 在 Python 2.6 中，如何将列表对象传递给需要参数列表的方法？

> ID：674690
> 
> 赞同：1
> 
> 时间：2009-03-23T18:39:18.357
> 
> 标签：python, list, arguments

我有一个包含各种信息的列表，我想通过新的字符串`format`方法将这些信息传递给几个字符串以包含在内。作为一个玩具示例，让我们定义

`thelist = ['a', 'b', 'c']`

我想做一个打印声明，比如`print '{0} {2}'.format(thelist)`和`print '{1} {2}'.format(thelist)`

当我运行它时，我收到消息`IndexError: tuple index out of range`；在胡闹时，它显然将整个列表视为一个对象。当然，我宁愿把它翻译`thelist`成`'a', 'b', 'c'`.

我尝试使用元组并收到相同的错误。

这种特殊的技术到底叫什么？如果我知道这个名字，我可以搜索它。“扩大”显然不是它。“爆炸”不会产生任何有用的东西。

我的实际使用比玩具例子要长得多，也更乏味。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-23T18:43:31.953

`.format(*thelist)`

它是 Python 中调用语法的一部分。我也不知道这个名字，我不相信它有一个。请参阅[教程](http://docs.python.org/tutorial/controlflow.html#unpacking-argument-lists)。

但是，它不仅适用于列表，还适用于任何可迭代对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T18:41:11.410

```
'{0} {2}'.format(*thelist) 
```

[文档](http://docs.python.org/reference/compound_stmts.html#index-757)

# javascript - 关于 JavaScript for() 循环巫毒

> ID：674700
> 
> 赞同：14
> 
> 时间：2009-03-23T18:41:55.200
> 
> 标签：javascript

很长一段时间以来，我一直认为`for`循环*只能*以以下格式存在：

```
for (INITIALIZER; STOP CONDITION; INC(DEC)REMENTER)
 {
    CODE
 } 
```

但是，*绝对*不是这种情况。看看这个[Fisher-Yates Shuffle](http://en.wikipedia.org/wiki/Knuth_shuffle)的 JavaScript 实现：

```
shuffle = function(o)
 {
    for (var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
    return o;
 }; 
```

这个小片段完全让我大吃一惊；在一个简单的 for 循环声明中到底发生了这么多事情？我的意思是......它甚至没有打开一个支架！所有的魔法都*在*声明中完成`for`。如果有人能提供一个相对彻底的解释，说明这个巫毒教在世界上是如何做到的，那就太好了。非常感谢提前。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T18:58:31.743

```
shuffle = function(o){
     for (
          var j,                // declare j
              x,                // declare x
              i = o.length;     // declare i and set to o.length
          i;                    // loop while i evaluates true
          j = parseInt(Math.random() * i), // j=random number up to i
            x = o[--i],         // decrement i, and look up this index of o
            o[i] =  o[j],       // copy the jth value into the ith position
            o[j] = x            // complete the swap by putting the old o[i] into jth position
          );
     return o;
     }; 
```

这是从 i 开始，等于位置的数量，并且每次交换卡片 i 和 j，其中 j 是每次直到 i 的某个随机数，根据算法。

如果没有令人困惑的逗号集，它可以更简单地编写，真的。

顺便说一句，这**不是**javascript 中唯一的 for 循环。还有：

```
 for(var key in arr) {
      value = arr[key]);
 } 
```

但要小心，因为这也会循环遍历对象的属性，包括如果您传入 Array 对象。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-23T21:25:36.167

for 循环（不是 for-in 循环）的通用格式是

```
for ( EXPRESSION_1 ; EXPRESSION_2 ; EXPRESSION_3 ) STATEMENT 
```

第一个 EXPRESSION_1*通常*用于初始化循环变量，EXPRESSION_2 是循环条件，而 EXPRESSION_3*通常*是递增或递减操作，但没有规则说它们必须这样做。它相当于下面的 while 循环：

```
EXPRESSION_1;
while (EXPRESSION_2) {
    STATEMENT
    EXPRESSION_3;
} 
```

逗号只是将两个表达式组合成一个表达式的运算符，其值为第二个子表达式。它们用于 for 循环是因为每个部分（用分号分隔）都需要是一个表达式，而不是多个语句。真的没有理由（除了可能在文件中节省一些空间）来编写这样的 for 循环，因为这是等效的：

```
shuffle = function(o) {
    var j, x;
    for (var i = o.length; i > 0; i--) {
        j = parseInt(Math.random() * i);
        x = o[i - 1];
        o[i - 1] = o[j];
        o[j] = x;
    }
    return o;
}; 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-23T18:44:16.147

INITIALIZER 可以声明和初始化多个变量。STOP CONDITION 是一个单独的测试（这里只是“i”），而 INCREMENTER 是每次在正文之后执行的表达式（逗号运算符允许您有多个子表达式，它们都会被执行。）。for 循环的主体只是空语句“;”

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-23T19:09:07.413

在我看来，您引用的代码被混淆了。有更清晰的方法来编写相同的功能。

但是，您的理解是非常正确的。以下是完全相同的代码，除了空格和注释。

```
for (
     // Initializer
     var j, x, i = o.length;
     // Continue condition
     i;
     // Operation to be carried out on each loop
     j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x
 )
 // empty body, equivalent to { }
 ; 
```

编写等效项要清楚得多：

```
var j,x,i = o.length;
while(i) {
    j = parseInt(Math.random() * i);
    x = o[--i];
    o[i] = o[j];
    o[j] = x;
} 
```

为了提高可读性，还可以进行其他优化 - 包括使用`while(i > 0)`而不是`while(i)`，以及在单独的行上拆分为 a `--i`。`i--`

除了可读性之外，确实没有理由 for() 存在。这两个是等价的：

```
{ // this block is to scope int i
   int i=0;
   while(i<100) {
       myfunc(i);
       i++;
   }
}

for(int i=0; i<100; i++) {
    myfunc(i);
} 
```

您应该使用在给定时间内最易读的那个。我认为您的代码的作者做了相反的事情。公平地说，他这样做可能是为了实现更小的 JS 文件以更快地加载（这是自动代码压缩器可以做的那种转换）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T18:48:11.987

for循环的语法是：

```
for (pre-block; condition; post-loop-block)
    loop-block; 
```

首先，执行预块，定义各种变量。

在每个循环中：

1.  检查条件
2.  执行循环块
3.  执行后循环块
4.  从 1 开始重复。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T18:58:35.393

他们几乎只是将循环的主体移到了增量器部分。您可以将 for 循环重写为 while 循环，以了解它在做什么：

```
 shuffle=function(o) {
    var j; //Random position from 0 up to the current position - 1
    var x; //temp holder for swapping positions
    var i=o.length; //current position
    while(i>0) { // Loop through the array
        j = parseInt(Math.random()*i); //get a lower position
        x = o[--i]; // decrement the position and store that position's value in the temp var
        o[i]=o[j]; // copy position j to position i
        o[j]=x; // copy the temp value that stored the old value at position i into position j
    }
    return o;
} 
```

前三个 var 是展开的初始化器，while 中的检查是停止条件，while 的主体是在 for 的增量部分中完成的。

编辑：根据 Gumbo 的评论更正

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-23T19:04:10.483

该声明确实符合您的初始格式。

事实证明，您可以使用“，”（逗号）为每个句子添加多个句子

所以：

```
for (var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x); 
```

可以这样分析：

```
for (var j,                           //INITIALIZER(s)
         x,
         i = o.length;

     i;                               // STOP CONDITION ( i ) 

     j = parseInt(Math.random() * i), // INC(DEC)REMENTER
     x = o[--i],
     o[i] = o[j],
     o[j] = x);  // CODE ( ; ) 
```

如您所见，它完全符合您的初始格式。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-24T02:00:55.147

这一直追溯到 C 语法 - javascript 从中偷走了一堆。主要技巧是逗号运算符，除了循环之外，它似乎几乎没有出现在其他地方

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-23T18:46:48.887

第一个子句初始化您要使用的任何变量。第二个子句确实是停止条件。第三个子句包括在每次迭代结束时要执行的任何逻辑。多个语句可以用逗号分隔。

# asp.net - 使用 ActiveDirectoryMembershipProvider 时 connectionUsername 的最低权限是多少

> ID：674703
> 
> 赞同：1
> 
> 时间：2009-03-23T18:42:42.920
> 
> 标签：asp.net, security, active-directory

我正在使用 ActiveDirectoryMembershipProvider 编写一个 ASP.NET 应用程序，类似于此处概述的场景：http: [//channel9.msdn.com/wiki/securitywiki/aspnet2formsauthtoadrolesinadintranet/](http://channel9.msdn.com/wiki/securitywiki/aspnet2formsauthtoadrolesinadintranet/)

作为此设置的一部分，我将 ASP.NET Membership 配置如下：

```
 <membership defaultProvider="MyADMembershipProvider">
      <providers>
        <add
           name="MyADMembershipProvider"
           type="System.Web.Security.ActiveDirectoryMembershipProvider, System.Web, Version=2.0.0.0, 
                 Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
           connectionStringName="ADConnectionString"
           connectionUsername="testdomain\administrator" 
           connectionPassword="password"/>
        </providers>
      </membership> 
```

这可行，但在生产中，我想使用对其他任何内容具有最低权限的连接用户名，而不是“管理员”。应分配给此帐户的最低权限是多少？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-25T12:37:25.467

[请参阅http://msdn.microsoft.com/en-us/library/ms998360.aspx](http://msdn.microsoft.com/en-us/library/ms998360.aspx)上的“连接到 Active Directory”部分中的注释。

# html - OpenID 客户端应该如何查找 OpenID 委托？

> ID：674704
> 
> 赞同：4
> 
> 时间：2009-03-23T18:42:54.667
> 
> 标签：html, openid

我刚刚注意到我的 OpenID 委托的 stackoverflow 有问题，我注意到这是由于我的网站没有使用`<html>`and`<head>`部分引起的。

现在即使这是有效的 HTML，问题是它是否对 OpenID 委托查找有效。我能在网站上找到的官方资料只是谈论 HTML 文档的“头部”部分，但是根据 HTML4/5 标准是隐含的。

我现在很感兴趣，如果错误是在我声明委托或 stackoverflow OpenID 实现的方式中。

不工作的版本：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<title>Index &raquo; Armin Ronacher</title>
<link rel="openid.server" href="http://www.myopenid.com/server">
<link rel="openid.delegate" href="http://mitsuhiko.myopenid.com/">
<meta content="Zine" name="generator">
<!-- more link/meta stuff here -->

<!-- page contents here -->
<div class="header"> 
```

工作版本：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
<title>Index &raquo; Armin Ronacher</title>
<link rel="openid.server" href="http://www.myopenid.com/server">
<link rel="openid.delegate" href="http://mitsuhiko.myopenid.com/">
<meta content="Zine" name="generator">
<!-- more link/meta stuff here -->
</head>

<!-- page contents here -->
<div class="header">

<!-- at the very end of the page -->
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T23:46:30.617

I think it is assumed that an HTML page should have a HEAD tag. Most do, even if it's not strictly required by some standards.

However, the OpenID standard seems to [require](http://openid.net/specs/openid-authentication-1_1.html#anchor4) its tags to be placed in the HEAD tag. Do other sites detect your OpenID when it's not in HEAD?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T05:46:36.833

The bug is in your HTML page that declares the delegate. The HTML and HEAD tags are required to be around the delegate tag for a very good security reason. If this were not required, then many web pages like wiki's and blog pages could be hijacked for their identity merely by leaving a comment that included a specially crafted tag.

The "head section" referred to by OpenID is indeed the HEAD tag in an HTML page. Although I haven't read the entire beefy thing, I'd be drop-dead surprised if the HTML spec itself didn't mandate a surrounding HTML tag, and that all META tags must be within a HEAD tag. In my opinion, the OpenID spec doesn't go into detail about all the HTML requirements because it's a spec about OpenID and not HTML, but "head section" is a reference to the HTML spec, just as it references many other specs.

In conclusion, I believe StackOverflow.com is doing the right thing.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T19:46:21.910

> 我能够在网站上找到只是谈论 HTML 文档的“头部”部分，但是根据 HTML4/5 标准是隐含的。

你在哪里找到这个的？我搜索了标准，没有发现任何提到“头部”的内容（它谈到了“头部元素”）；我在更广泛的搜索中最接近的是，大多数实现在要求明确的`<html>`and方面是松懈的`<head>`，但这更多地是作为宽大接受不合规文档的情况，而不是作为标准的一部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T06:19:20.937

我在 getopenid.com 上找到了这个解决方案：

“如果您想将博客或主页用作 OpenID，则不必设置服务器！只需将以下内容复制到 HTML 或 XHTML 的头部，然后使用该 URL。

链接 rel="openid.server" href="http://getopenid.com/action/authenticate/"
链接 rel="openid.delegate" href="http://getopenid.com/YOURIDENTITY/"

请注意，除非您拥有自己的 SSL 服务器，否则您不能通过此 URL 使用安全登录。与您直接使用来自 GetOpenID.com 的身份时相比，网站也会将您视为不同的人。”

我认为您必须将 getopenid.com 替换为您的 OpenID 提供者，并将 YOURIDENTITY 替换为您的 OpenID 身份。

# jpa - 为什么我的 remove() 实际上没有使用 JPA @Many-to-Many 从数据库中删除引用

> ID：674707
> 
> 赞同：4
> 
> 时间：2009-03-23T18:43:37.023
> 
> 标签：jpa, many-to-many

我`@ManyToMany`在我的应用程序中设置了一个非常简单的 JPA 关系。A`Product`是一个或多个`OrderSystem`s的一部分。每个`OrderSystem`可以有很多`Product`s。这是典型的多对多关系。

我要解决的问题是：如果我使用`orderSystems.remove()`从 a 中删除`Product`对 an的引用`OrderSystem`，则该条目似乎已被删除（在该会话中）。但是，刷新时不会从交叉引用表中删除该条目，并且当我重新加载它时，`Product`它具有前一组`OrderSystem`s。

我有以下代码：

```
@Entity
@Table(name = "p_product_versions")
@Validation
public class Product {
    private List<OrderSystem> orderSystems;
    @ManyToMany
    @JoinTable(name = "p_order_systems_has_product_versions", 
            joinColumns =
                @JoinColumn(name = "p_product_versions_prod_version_id"),
            inverseJoinColumns =
                @JoinColumn(name = "p_order_systems_system_id"))
    public List<OrderSystem> getOrderSystems() {
        return orderSystems;
    }

}

@Entity
@Table(name = "p_order_systems")
@Validation
public class OrderSystem {
    private List<Product> products;
    @ManyToMany (mappedBy = "orderSystems")
    public List<Product> getProducts() {
        return products;
    }
} 
```

谁能指出我在这里缺少的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T19:22:00.847

执行删除的代码是什么样的？您是否在事务中执行此操作，并且您是否记得提交更改？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-31T15:45:59.630

原来问题在于我没有清除两个方向的关系。我会从 OrderSystem 中删除产品，但不会从产品中删除 OrderSystem。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-16T10:09:16.677

您需要从双方删除关系。这样做的方法是：

```
// Find your 2 beans with entityManager

product.setOrderSystems(null);
orderSystem.setProducts(null);

// then persist() and flush() 
```

# java - 将 Java 集合转换为 Scala 集合

> ID：674713
> 
> 赞同：90
> 
> 时间：2009-03-23T18:46:15.423
> 
> 标签：java, scala, scala-collections, scala-2.7

与 Stack Overflow 问题*[Scala 等效于 new HashSet(Collection)](https://stackoverflow.com/questions/674545)*相关，如何将 Java 集合（`java.util.List`比如说）转换为 Scala 集合`List`？

我实际上是在尝试将 Java API 调用转换为返回 a 的[Spring](http://en.wikipedia.org/wiki/Spring_Framework) 转换为 Scala immutable 。例如：`SimpleJdbcTemplate``java.util.List<T>``HashSet`

```
val l: java.util.List[String] = javaApi.query( ... )
val s: HashSet[String] = //make a set from l 
```

* * *

这似乎有效。欢迎批评！

```
import scala.collection.immutable.Set
import scala.collection.jcl.Buffer 
val s: scala.collection.Set[String] =
                      Set(Buffer(javaApi.query( ... ) ) : _ *) 
```

* * *

## 回答 #1

> 赞同：127
> 
> 时间：2010-10-19T14:49:48.777

供将来参考：使用 Scala 2.8，可以这样做：

```
import scala.collection.JavaConversions._
val list = new java.util.ArrayList[String]()
list.add("test")
val set = list.toSet 
```

`set`是`scala.collection.immutable.Set[String]`在这之后。

另请参阅[Ben James 的答案](https://stackoverflow.com/questions/674713/converting-java-collection-into-scala-collection/6356804#6356804)以获得更明确的方式（使用 JavaConverters），现在似乎推荐使用这种方式。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2011-06-15T11:11:21.677

如果您想比[robinst 的答案](https://stackoverflow.com/questions/674713/converting-java-collection-into-scala-collection/3969631#3969631)中演示的 JavaConversions 更明确，可以使用 JavaConverters：

```
import scala.collection.JavaConverters._
val l = new java.util.ArrayList[java.lang.String]
val s = l.asScala.toSet 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-08-18T08:52:38.550

***Scala 2.10**已弃用*JavaConversions*（[robinst 的回答](https://stackoverflow.com/questions/674713/converting-java-collection-into-scala-collection/3969631#3969631)）和*JavaConverters*（[Ben James 的回答](https://stackoverflow.com/questions/674713/converting-java-collection-into-scala-collection/6356804#6356804)） 。*

 ***而不是*JavaConversions*使用：

```
import scala.collection.convert.wrapAll._ 
```

正如[aleksandr_hramcov](https://stackoverflow.com/a/22242391/982265)所建议的那样。

而不是*JavaConverters*使用：

```
import scala.collection.convert.decorateAll._ 
```

对于两者，也可以仅将转换/转换器分别导入 Java 或 Scala，例如：

```
import scala.collection.convert.wrapAsScala._ 
```

**更新：** 上面关于*JavaConversions*和*JavaConverters*已被弃用的陈述似乎是错误的。Scala 2.10 中有一些已弃用的属性，在导入它们时会出现弃用警告。所以这里的替代进口似乎只是别名。尽管我仍然更喜欢它们，但恕我直言，这些名称更合适。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-24T07:51:54.863

您的最后一个建议有效，但您也可以避免使用`jcl.Buffer`：

```
Set(javaApi.query(...).toArray: _*) 
```

请注意，`scala.collection.immutable.Set`由于`Predef.scala`.

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-05-12T18:47:30.567

您可能还想探索这个优秀的库：[scalaj-collection](http://github.com/scalaj/scalaj-collection)，它在 Java 和 Scala 集合之间进行了双向转换。在您的情况下，要将 java.util.List 转换为 Scala List 您可以这样做：

```
val list = new java.util.ArrayList[java.lang.String]
list.add("A")
list.add("B")
list.asScala 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-03-29T00:16:19.950

开始`Scala 2.13`，包[`scala.jdk.CollectionConverters`](https://www.scala-lang.org/files/archive/api/2.13.x/scala/jdk/CollectionConverters$.html)替换包`scala.collection.JavaConverters/JavaConversions._`：

```
import scala.jdk.CollectionConverters._

// val javaList: java.util.List[String] = java.util.Arrays.asList("one","two","three")
javaList.asScala
// collection.mutable.Buffer[String] = Buffer("one", "two", "three")
javaList.asScala.toSet
// collection.immutable.Set[String] = Set("one", "two", "three") 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-10-08T07:26:00.743

```
val array = java.util.Arrays.asList("one","two","three").toArray

val list = array.toList.map(_.asInstanceOf[String]) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-03-23T19:43:10.817

您可以在 toArray 调用中添加类型信息以使 Set 参数化：

```
 val s = Set(javaApi.query(....).toArray(new Array[String](0)) : _*) 
```

这可能更可取，因为 collections 包正在经历 Scala 2.8 的重大返工，而 scala.collection.jcl 包[正在消失](http://www.acooke.org/cute/UsingJavaC0.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-23T18:50:03.340

您可以将 Java 集合转换为数组，然后从中创建一个 Scala 列表：

```
val array = java.util.Arrays.asList("one","two","three").toArray
val list = List.fromArray(array) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-03-07T05:38:26.417

解决此问题的另一种简单方法：

```
import collection.convert.wrapAll._ 
```

# c# - .NET 转换通用列表

> ID：674715
> 
> 赞同：6
> 
> 时间：2009-03-23T18:46:37.107
> 
> 标签：c#, .net, generics, casting

如果我有一个接口`IPackable`和一个实现该接口的类，有人可以向我解释为什么在 .NET 2.0 中`OrderItem`，当我有一个接受 a 的方法时`List<IPackable>`，传入一个列表`List<OrderItem>`不起作用？

有谁知道我怎么能完成这个功能？

代码：

```
public interface IPackable {
        double Weight{ get; }
}

public class OrderItem : IPackable

public List<IShipMethod> GetForShipWeight(List<IPackable> packages) {
   double totalWeight = 0;
   foreach (IPackable package in packages) {
        totalWeight += package.Weight;
   }
} 
```

以下代码不起作用。

```
List<OrderItem> orderItems = new List<OrderItem>();
List<IShipMethod> shipMethods = GetForShipWeight(orderItems); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-07-08T18:43:23.577

JMD 说对了一半。事实上，说我们将能够使用 C# 4.0 转换通用列表是绝对不正确的。确实，C# 4.0 将支持协变和逆变，但它只适用于接口和委托，并且会有很多约束。因此，它不适用于`List`.

原因其实很简单。

如果 B 是 A 的子类，我们不能说它`List<B>`是 的子类`List<A>`。

这就是为什么。

`List<A>`公开了一些协方差方法（返回一个值）和一些逆变方法（接受一个值作为参数）。

例如

*   `List<A>`暴露`Add(A);`
*   `List<B>`暴露`Add(B);`

如果`List<B>`继承自`List<A>`...比你能做的`List<B>.Add(A);`

因此，您将失去泛型的所有类型安全性。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-23T18:53:08.573

该功能称为协变/逆变，将在 c# 4.0 中得到支持。你可以在这里阅读：http: [//blogs.msdn.com/ericlippert/archive/tags/Covariance+and+Contravariance/default.aspx](http://blogs.msdn.com/ericlippert/archive/tags/Covariance+and+Contravariance/default.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-03-23T19:10:24.650

JMD 的回答是正确的。对于解决方法，您可以尝试以下操作：

```
List<IPackable> orderItems = new List<IPackable>();
List<IShipMethod> shipMethods = GetForShipWeight(orderItems); 
```

或者，如果列表必须强类型为 OrderItems，那么这个（仅限 3.0，抱歉）：

```
List<IShipMethod> shipMethods =
    GetForShipWeight(orderItems.Cast<IPackable>().ToList()); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-05-31T07:28:06.493

也适用于 .NET 3.5 的替代解决方案

```
List<IShipMethod> shipMethods = GetForShipWeight(orderItems).ConvertAll(sm => sm as IShipMethod); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-11T20:26:41.587

实际上，您可以通过将 GetForShipWeight 设为通用函数来解决此问题：

```
public interface IPackable { double Weight { get; } }
public interface IShipMethod { }

public class OrderItem : IPackable { }

public List<IShipMethod> GetForShipWeight<T>(List<T> packages) where T : IPackable
{
    List<IShipMethod> ship = new List<IShipMethod>();
    foreach (IPackable package in packages)
    {
        // Do something with packages to determine list of shipping methods
    }
    return ship;
}
public void Test()
{
    List<OrderItem> orderItems = new List<OrderItem>();
    // Now compiles...
    List<IShipMethod> shipMethods = GetForShipWeight(orderItems);
} 
```

# .net - Windows.Forms 或 WPF 中是否有用于快捷方式链的内置功能（如在 VS Ctrl + K、C 中）

> ID：674717
> 
> 赞同：1
> 
> 时间：2009-03-23T18:46:59.743
> 
> 标签：.net

快捷键有标准功能，即修饰符 + 键，这很容易实现，但是有没有办法轻松地（使用标准库）实现快捷键，如 Ctrl + K、C（按住 Ctrl 按 K，然后按 C）。类似键盘手势的东西，但我还没有找到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T10:34:45.020

不，没有任何内置功能。然而，对于 WPF，Kent Boogaart 最近发表了一篇非常不错的博客文章，其中包含一个[解决方案](http://kentb.blogspot.com/2009/03/multikeygesture.html)。

# c# - 如何在 C# 中将 DLLImport 与结构一起用作参数？

> ID：674718
> 
> 赞同：9
> 
> 时间：2009-03-23T18:47:01.070
> 
> 标签：c#, c++

我可以找到使用 DLLImport 从 C# 调用 C++ 代码的所有示例来回传递整数。我可以让这些例子工作得很好。我需要调用的方法将两个结构作为其导入参数，我不太清楚如何使其工作。

这是我必须使用的：

我拥有 C++ 代码，因此我可以对其进行任何我需要的更改/添加。

第三方应用程序将在启动时加载我的 DLL，并期望 DLLExport 以某种方式定义，因此我无法真正更改正在导出的方法签名。

我正在构建的 C# 应用程序将用作包装器，因此我可以将这个 C++ 部分集成到我们的其他一些应用程序中，这些应用程序都是用 C# 编写的。

我需要调用的 C++ 方法签名如下所示

```
DllExport int Calculate (const MathInputStuctType *input, 
    MathOutputStructType *output, void **formulaStorage) 
```

并且 MathInputStructType 定义如下

```
typedef struct MathInputStuctTypeS {
    int             _setData;
    double              _data[(int) FieldSize];
    int             _setTdData;
} MathInputStuctType; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-23T20:13:45.697

MSDN 主题[传递结构](http://msdn.microsoft.com/en-us/library/awbckfbz.aspx)很好地介绍了将结构传递给非托管代码。您还需要查看[使用 Platform Invoke](http://msdn.microsoft.com/en-us/library/fzhhdwae.aspx)和[Marshaling Arrays of Types](http://msdn.microsoft.com/en-us/library/dd93y453.aspx)的 Marshaling Data 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T18:52:50.777

根据您发布的声明，您的 C# 代码将如下所示：

```
[DllImport("mydll.dll")]
static extern int Calculate(ref MathInputStructType input,
    ref MathOutputStructType output, ref IntPtr formulaStorage); 
```

根据 C++ 中 MathInputStructType 和 MathOutputStructType 的结构，您还必须对这些结构声明进行属性化，以便它们正确编组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-23T19:03:49.330

对于结构：

```
struct MathInputStuctType 
{
    int       _setData;
    [MarshalAs(UnmanagedType.ByValArray, SizeConst = FieldSize)]
    double[]  _data;
    int       _setTdData;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T19:12:19.107

您可能想在 CodePlex 上查看这个项目，[http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx](http://www.codeplex.com/clrinterop/Release/ProjectReleases.aspx?ReleaseId=14120) ?ReleaseId=14120 。它应该可以帮助您正确编组结构。

# javascript - 如何从 JavaScript 中的日期减去分钟？

> ID：674721
> 
> 赞同：167
> 
> 时间：2009-03-23T18:47:28.493
> 
> 标签：javascript

我怎样才能把这个伪代码翻译成工作的 JS [不要担心结束日期来自哪里，除非它是一个有效的 JavaScript 日期]。

```
var myEndDateTime = somedate;  //somedate is a valid JS date  
var durationInMinutes = 100; //this can be any number of minutes from 1-7200 (5 days)

//this is the calculation I don't know how to do
var myStartDate = somedate - durationInMinutes;

alert("The event will start on " + myStartDate.toDateString() + " at " + myStartDate.toTimeString()); 
```

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2009-03-23T18:51:40.793

一旦你知道这一点：

*   自 1970 年 1 月 1 日起，您可以通过以毫秒为单位`Date`调用[构造函数来创建 a。](http://www.java2s.com/Tutorial/JavaScript/0240__Date/CreateDateobjectbycalltheconstructor.htm)
*   `valueOf()`a`Date`是自 1970 年 1 月 1 日以来的毫秒数
*   一分钟有`60,000`几毫秒:-]

在下面的代码中，`Date`通过从 减去适当的毫秒数来创建一个新的`myEndDateTime`：

```
var MS_PER_MINUTE = 60000;
var myStartDate = new Date(myEndDateTime - durationInMinutes * MS_PER_MINUTE); 
```

* * *

## 回答 #2

> 赞同：110
> 
> 时间：2009-03-23T19:20:22.317

您还可以使用 get 和 set minutes 来实现它：

```
var endDate = somedate;

var startdate = new Date(endDate);

var durationInMinutes = 20;

startdate.setMinutes(endDate.getMinutes() - durationInMinutes); 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2017-02-15T04:26:26.377

**一切都只是滴答声，无需记住方法**......

```
var aMinuteAgo = new Date( Date.now() - 1000 * 60 ); 
```

或者

```
var aMinuteLess = new Date( someDate.getTime() - 1000 * 60 ); 
```

# 更新

在使用了 momentjs 之后，我不得不说这是一个很棒的库，你应该去看看。确实，在许多情况下，滴答声都会使您的代码非常小，您应该尝试使您的代码尽可能小，以满足您的需要。但是对于任何复杂的事情，请使用 momentjs。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2017-01-22T15:14:36.333

[moment.js](http://momentjs.com/)有一些非常方便的方法来操作日期对象

.subtract方法允许您通过提供数量和时间单位[字符串](http://momentjs.com/docs/#/durations/subtract/)从日期中减去一定数量的时间单位。

```
var now = new Date();
// Sun Jan 22 2017 17:12:18 GMT+0200 ...
var olderDate = moment(now).subtract(3, 'minutes').toDate();
// Sun Jan 22 2017 17:09:18 GMT+0200 ... 
```

[Luxon](https://moment.github.io/luxon/)也有一个 API 来[操作](https://moment.github.io/luxon/docs/manual/tour.html#math)它自己的`DateTime`对象

```
var dt = DateTime.now(); 
// "1982-05-25T00:00:00.000Z"
dt.minus({ minutes: 3 });
dt.toISO();              
// "1982-05-24T23:57:00.000Z" 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-05-27T13:45:32.067

这是我发现的：

```
//First, start with a particular time
var date = new Date();

//Add two hours
var dd = date.setHours(date.getHours() + 2);

//Go back 3 days
var dd = date.setDate(date.getDate() - 3);

//One minute ago...
var dd = date.setMinutes(date.getMinutes() - 1);

//Display the date:
var monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
var date = new Date(dd);
var day = date.getDate();
var monthIndex = date.getMonth();
var year = date.getFullYear();
var displayDate = monthNames[monthIndex] + ' ' + day + ', ' + year;
alert('Date is now: ' + displayDate); 
```

资料来源：

[http://www.javascriptcookbook.com/article/Perform-date-manipulations-based-on-adding-or-subtracting-time/](http://www.javascriptcookbook.com/article/Perform-date-manipulations-based-on-adding-or-subtracting-time/)

[https://stackoverflow.com/a/12798270/1873386](https://stackoverflow.com/a/12798270/1873386)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-11-04T11:54:31.727

```
var date=new Date();

//here I am using "-30" to subtract 30 minutes from the current time.
var minute=date.setMinutes(date.getMinutes()-30); 

console.log(minute) //it will print the time and date according to the above condition in Unix-timestamp format. 
```

您可以使用`new Date()`.for将 Unix 时间戳转换为常规时间

```
var extract=new Date(minute)
console.log(minute)//this will print the time in the readable format. 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-05-20T11:02:59.743

尝试如下：

```
var dt = new Date();
dt.setMinutes( dt.getMinutes() - 20 );
console.log('#####',dt); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-05-31T13:44:56.950

使用此函数扩展 Date 类

```
// Add (or substract if value is negative) the value, expresed in timeUnit
// to the date and return the new date.
Date.dateAdd = function(currentDate, value, timeUnit) {

    timeUnit = timeUnit.toLowerCase();
    var multiplyBy = { w:604800000,
                     d:86400000,
                     h:3600000,
                     m:60000,
                     s:1000 };
    var updatedDate = new Date(currentDate.getTime() + multiplyBy[timeUnit] * value);

    return updatedDate;
}; 
```

因此，您可以为任何日期添加或减去数分钟、秒、小时、天……。

```
add_10_minutes_to_current_date = Date.dateAdd( Date(), 10, "m");
subs_1_hour_to_a_date = Date.dateAdd( date_value, -1, "h"); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-21T21:56:59.680

这就是我所做的：[见 Codepen](http://codepen.io/rhroyston/pen/jrqwEa)

```
var somedate = 1473888180593;
var myStartDate;
//var myStartDate = somedate - durationInMuntes;

myStartDate = new Date(dateAfterSubtracted('minutes', 100));

alert("The event will start on " + myStartDate.toDateString() + " at " + myStartDate.toTimeString());

function dateAfterSubtracted(range, amount){
    var now = new Date();
    if(range === 'years'){
        return now.setDate(now.getYear() - amount);
    }
    if(range === 'months'){
        return now.setDate(now.getMonth() - amount);
    }
    if(range === 'days'){
        return now.setDate(now.getDate() - amount);
    }
    if(range === 'hours'){
        return now.setDate(now.getHours() - amount);
    }
    if(range === 'minutes'){
        return now.setDate(now.getMinutes() - amount);
    }
    else {
        return null;
    }
} 
```

# c - 与来自面向对象领域的 C 作斗争？

> ID：674722
> 
> 赞同：19
> 
> 时间：2009-03-23T18:47:34.437
> 
> 标签：c, procedural-programming

当我遇到编程问题时，我自然会开始在脑海中将它们分解为逻辑对象。谁有什么责任，谁拥有什么，谁从什么得到什么，等等。

我在 C 中苦苦挣扎。我只是不知道如何用程序语言做事。

有经验的 C 程序员能否帮助解释我在设计时应该如何考虑我的程序？

例如，我想编写自己的 Semaphore 类。我的程序自然需要一个队列数据结构，我也想自己编写。如果我需要在 Java 或 C# 中执行此操作，我可以简单地快速创建一个 Queue 类并在我的 Semaphore 类中创建它的一个新实例。

但是在 C 中，没有对象。那么我是否必须内联队列数据结构的所有行为？

有人可以帮我“得到它”吗？

**相关**：[在 c 中计划和组织应用程序开发的最佳方式是什么](https://stackoverflow.com/questions/436446/what-is-the-best-way-to-plan-and-organize-development-of-an-application-in-c/)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-23T18:57:49.873

> 但是在 C 中，没有对象。那么我是否必须内联队列数据结构的所有行为？

不。

做这个。

1.  定义你的类，但是你觉得做 OO 设计很舒服。

2.  将类的属性写为 C 语言结构。

3.  将该结构与对该结构进行操作的所有函数一起放入头文件中。确保 a`MyStruct * self`是所有这些“方法函数”的第一个参数。

4.  编写一个包含所有方法函数主体的 C 模块。

C语言中的穷人的OO。它运行良好。只需遵守规则，将所有内容放入您需要的结构中——公共和私有实例变量——所有内容。

一般来说，首先要避免尝试使用私有变量。您没有 OO 编译器的全部功能，因此不要为诸如“私有”或“受保护”之类的低价值特性而烦恼。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-23T19:19:39.137

我会修改 S. Lott 的答案以使用[不透明指针](http://en.wikipedia.org/wiki/Opaque_pointer#C)来执行结构成员的数据隐藏：

1.  使用正常的 OO 设计定义您想要的类。
2.  您的类的成员变量进入 C 语言结构。
3.  在头文件中，您不想公开对象的成员变量（因为这些变量在 OO 语言中是“私有的”）。相反，使用不透明的指针，即
    `typedef struct mystruct_s *mystruct_t; // first argument to all your methods`
4.  对于您想要“公开”的所有方法，请将它们的签名放在您的 .h 文件中。方法体应该放在 .c 文件中，“私有”方法应该只在 .c 文件中定义，并且声明为静态的，这样它们的符号就不会与其他文件中定义的符号冲突。

使用此方法不需要像下划线这样的巧妙命名约定，但这意味着您的所有成员变量都是私有的。函数可以是公共的或私有的，尽管公共函数是全局命名空间的一部分，因此您可能希望使用“包”名称来限定它们的名称，例如`mystruct_push()`,`mystruct_pop()`等。

您还需要明确调用者或库是否负责调用`malloc()`and `free()`。很可能您将拥有`mystruct_t *create()`和`void destroy(mystruct_t *target)`方法。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-23T18:49:29.783

**你仍然可以用 C 来思考面向对象。**

您只需要创建一个结构和一组函数，这些函数将指向该结构实例的指针作为其第一个参数。

至于多态性，您可以将结构的大小作为结构的第一个成员传递，因此您知道如何转换它。

这里有一个很棒[的 ANSI-C 面向对象编程的 pdf 文件](http://www.planetpdf.com/codecuts/pdfs/ooc.pdf)。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T20:10:34.207

从程序思维转向面向对象思维，我经历了一段时间的痛苦，所以我感受到了你的痛苦。

我发现为了学习如何创建对象，最好考虑调用者对它们的看法。同样的方法可能会对您有所帮助，但反过来。考虑一下你的组件的 API 是什么样的。一个好方法是研究现有的 C API（我使用标准 Java API 作为 OO API 的一组示例）。

你习惯使用这样的队列组件：

```
import some.package.Queue;

Queue q = new Queue(); 
q.add(item); 
```

在典型的 C api 中，您会期望更多类似于：

```
#include <queue.h> // provides queue, make_queue(), queue_add(), others

queue q = make_queue(); // queue is probably a struct, or a struct*
queue_add(q,item); 
```

每当您发现自己在思考对象时，请进行类似的变换。

您可以使用指向函数等的指针，在 C 中创建类似对象的结构 - 但是成千上万的 C 程序员已经在没有的情况下进行了管理。

祝你好运！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-23T19:51:46.593

查看[Lua C api](http://www.lua.org/manual/5.1/manual.html#3)。就 C 接口设计而言，它一直是我的指路明灯。每个函数都将 Lua 状态作为主要参数，成为你的“this”。继承有点棘手，但[Chipmunk](http://wiki.slembcke.net/main/published/Chipmunk)设法很好地公开了采用通用形状结构的函数，并计算出通过“klass”实际调用的函数的细节。您通常可以利用 void* 让函数采用不同的类型（结构），就像在 OO 中重载一样。有时它可能会让人觉得有点骇人听闻，但效果很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-23T22:37:20.347

最初 C++ 只是一个从 C++ 源代码编写 C 代码的编译器；然后由本机 C 编译器编译、链接等。

因此，所有 OOP 方法在 C 中都可用——只是编译器不会帮助您，并且不提供所有编译时功能，例如模板、运算符覆盖、数据隐藏等。

1.  C++“结构”（可能仍然是）等同于所有成员“公共”的“类”。
2.  成员函数可以实现为结构中的函数指针；这可以提供封装和多态性。 *除非您使用工厂，否则构造函数存在于全局范围内。* 析构函数可以是成员函数。
3.  使用访问器成员函数，如*getColor()*，*setColor()*可以缓解内部差异并提供一些数据隐藏。如果你真的想要，你可以使用 Brian Bondy 的隐藏宏的建议。
4.  实际上有很多提供标准容器的 FOSS 库——哈希表、动态数组、链表等。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-23T19:34:24.107

我赞同做“C 中穷人的 OO”的建议。我还认为您可能会受益于花一些时间来了解 Perl 的 OO 是如何工作的。基本上，在 Perl 中，OO 是通过让解释器为每个方法提供实例作为隐式第一个参数来实现的。您将希望在 C 中显式地做同样的事情，并使用非常非常好的代码组织，因为编译器不会为您强制执行良好的封装。

顺便说一句，您可以通过使用[不透明指针](http://en.wikipedia.org/wiki/Opaque_pointer#C)来强制保持结构的成员私有。我似乎记得 GNU 编程标准和建议包括一种技术，通过在传递时将所有内容基本上强制转换为 void*，然后使用 typedef 来命名应该传递的每种特定类型的不透明指针。（即，每个“类”）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-24T00:17:40.620

你也可以用 C 做派生类：

[C 中的派生类 - 你最喜欢的方法是什么？](https://stackoverflow.com/questions/660083/derived-classes-in-c-what-is-your-favorite-method)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-05T04:03:46.713

使用 glib，带有 oop 的 c 库 [http://library.gnome.org/devel/glib/2.20/](http://library.gnome.org/devel/glib/2.20/)

# objective-c - 使用 Instruments Leaks & Object Alloc：自动释放的对象算作泄漏吗？

> ID：674724
> 
> 赞同：6
> 
> 时间：2009-03-23T18:48:03.003
> 
> 标签：objective-c, iphone, cocoa-touch, memory-leaks, instruments

我有一个 iPhone 应用程序收到内存警告，因此我试图在 Instruments 的帮助下找到泄漏、更有效地利用内存等。除其他外，我正在尝试取出任何自动释放的对象并用手动分配/初始化/释放对象替换。但是，某些 API 调用似乎没有“init”版本（参见下面的代码）。我承认有一些基本的误解：

1.  如果我“调用”API 并取回本质上是自动释放的对象，这些对象会在 Instruments 中显示为泄漏吗？看来我在 Instruments 中看到了这种行为。

2.  如果是 2，如果没有“非自动释放”替代方案并且我正在使用我需要的 API，我是否应该忽略？另外，如果这段代码被多次调用，我应该完全重新考虑算法吗？

这是我的应用程序中的一些实用程序代码，它们经常被调用。基本上确定两个日期是否有意义地“相等”。我留下了注释掉的代码，所以你可以看到我在我的代码库中追求的改进类型——当我开始手动创建 NSDate（和发布）时，**这个 DID 减少了随后在 Instruments 中运行时的内存泄漏**帮助。但是，我仍然有我认为正在泄漏的日期组件对象......但它是一个 API 调用（抱歉代码格式，但我似乎无法改进它）：

```
+ (BOOL)isDayEqualToDay:(NSDate*)date anotherDate:(NSDate*)anotherDate
{

    NSCalendar *cal = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];  
    //NSCalendar *cal;  
    NSDateComponents *componentsFromDate, *componentsFromAnotherDate;   
    NSUInteger unitFlags = NSYearCalendarUnit | NSMonthCalendarUnit | NSDayCalendarUnit;    
    //cal = [NSCalendar currentCalendar];
    componentsFromDate = [cal components:unitFlags fromDate:date];
    componentsFromAnotherDate = [cal components:unitFlags fromDate:anotherDate];

    BOOL bDatesEqual = ([componentsFromDate year] == [componentsFromAnotherDate year] && 
                        [componentsFromDate month] == [componentsFromAnotherDate month] && 
                        [componentsFromDate day] == [componentsFromAnotherDate day]);

    [cal release];

    return bDatesEqual;

    /*
    return (
        [componentsFromDate year] == [componentsFromAnotherDate year] &&
        [componentsFromDate month] == [componentsFromAnotherDate month] && 
        [componentsFromDate day] == [componentsFromAnotherDate day]
    );*/
} 
```

我认为 componentsFromDate 和 componentsFromAnotherDate 显示为泄漏，但实际上只是从 NSData API 调用（自动释放）返回的对象。不知道我还能做些什么来提高效率，我质疑我对如何最好地使用 Instruments 的理解。建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-24T22:06:07.323

自动释放的对象不应显示为内存泄漏。然而，有时 API 内部存在内存泄漏。您应该向苹果提交错误报告。NSCalendar 和 NSDateComponenets 等新类尤其值得怀疑。

至于保留与自动释放，一般规则是，除非您处于紧密循环中，否则这无关紧要。在这种情况下，如果紧密循环在没有事件离开的情况下进行了数千次，则意味着您永远不会“清理”自动释放池。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-04-05T11:58:58.033

当使用像 GCD 这样的东西时，会有一个自动释放池，但你无法知道默认的自动释放池何时（如果有的话）被耗尽。如果您确信 atoreleased 对象没有释放，请确保您了解您正在使用的线程 API。如果内存为我提供了正确的 GCD 调用 (dispatch_async) 为您整理自动释放池，但池的实际耗尽可能需要很长时间。另一方面，NSOperations 让您拥有自己的自动释放池。

我已经看到 Instruments 中的内存泄漏检测依赖于 10 秒的间隔，导致错误的内存泄漏警告，这是由于在自动释放池耗尽之前的长时间延迟。所以尝试将有问题的代码包装在：

```
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
... [your code] ...
[pool drain]; 
```

我建议不要尝试用手动发布替换所有自动发布。使用自动释放会在一个地方产生平衡的保留/释放调用计数。在我看来，创建一个对象然后立即自动释放它可以防止很多内存错误。快，容易。使用手动发布调用时，您将忘记发布内容。在进行手动发布时，尤其是错误情况非常棘手。

自己做一个池可以为您提供更多控制权，并且在分配密集型工作期间，创建和耗尽您自己的池有时可能是有益的。但与往常一样，尝试和测试，不要做任何假设。

# c# - 捕获特定的 WebException (550)

> ID：674726
> 
> 赞同：7
> 
> 时间：2009-03-23T18:48:34.857
> 
> 标签：c#, .net, exception, exception-handling, http-status-codes

假设我创建并执行了一个`System.Net.FtpWebRequest`.

我可以`catch (WebException ex) {}`用来捕获此请求引发的任何与 Web 相关的异常。但是，如果我有一些只想在抛出异常时执行的逻辑`(550) file not found`呢？

最好的方法是什么？我可以复制异常消息并测试是否相等：

```
const string fileNotFoundExceptionMessage =
    "The remote server returned an error: (550) File unavailable (e.g., file not found, no access).";
if (ex.Message == fileNotFoundExceptionMessage) { 
```

但从理论上讲，这条信息似乎可能会在未来发生变化。

或者，我可以测试一下异常消息是否包含“550”。如果消息被更改，这种方法可能更有效（它可能仍会在文本中的某处包含“550”）。`WebException`但是当然，如​​果其他一些文本恰好包含“550”，那么这样的测试也会返回 true 。

似乎没有一种方法可以仅访问异常的*数量*。这可能吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-23T18:51:18.330

`WebException`公开一个[`StatusCode`](http://msdn.microsoft.com/en-us/library/system.net.webexception.status.aspx)您可以检查的属性。

如果您想要实际的 HTTP 响应代码，可以执行以下操作：

```
(int)((HttpWebResponse)ex.Response).StatusCode 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T21:46:52.197

作为参考，这是我最终使用的实际代码：

```
catch (WebException ex) {
    if (ex.Status == WebExceptionStatus.ProtocolError &&
        ((FtpWebResponse)ex.Response).StatusCode == FtpStatusCode.ActionNotTakenFileUnavailable) {
        // Handle file not found here
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-03-23T19:06:37.623

声明一个 WebException 对象，将你的 Catch 块中的 ex 值转换为它。然后您可以检查 StatusCode 属性。

# c# - 使用 DynamicMethod 和 ILGenerator 在 C# 中生成动态事件

> ID：674728
> 
> 赞同：1
> 
> 时间：2009-03-23T18:48:56.650
> 
> 标签：c#, ilgenerator

我需要在运行时基于 EventInfo 对象生成一个事件处理程序，并在该事件处理程序中调用一个方法。类似于以下内容：

```
public void RegisterAction(ActionData actionData, EventInfo eventInfo, 
    Control control)
{
    MethodInfo methodInfo = eventInfo.EventHandlerType.GetMethod("Invoke");

    List<Type> ps = new List<Type>();
    foreach (ParameterInfo info in methodInfo.GetParameters())
    {
        ps.Add(info.ParameterType);
    }

     DynamicMethod method = new DynamicMethod("Adapter",
                                              typeof (void),
                                              ps.ToArray(),
                                              GetType(), 
                                              true);

     ILGenerator generator = method.GetILGenerator();

     // Here I need to generate a method to do the following:
     // ExecuteAction(actionData);

     // Then I can use this runtime method as an event handler and
     // bind it to the control
     Delegate proxy = method.CreateDelegate(eventInfo.EventHandlerType, this);

     eventInfo.AddEventHandler(control, proxy);
} 
```

我需要帮助来生成注释部分的 IL 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T18:59:39.120

我猜你想从你的事件的 MethodInfo 中做一个代表......

如果是这样，[这里有一篇文章](http://www.codeproject.com/KB/cs/dynamicmethoddelegates.aspx?display=Print)描述了如何去做。该文章中解释了所需的 IL 代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T07:59:01.057

```
public void RegisterAction(ActionData actionData, EventInfo eventInfo, 
    Control control)
{
    MethodInfo methodInfo = eventInfo.EventHandlerType.GetMethod("Invoke");

    List<Type> ps = new List<Type>();
    ps.Add  (typeof (ActionData)) ;
    foreach (ParameterInfo info in methodInfo.GetParameters())
    {
        ps.Add(info.ParameterType);
    }

     DynamicMethod method = new DynamicMethod("Adapter",
                                              typeof (void),
                                              ps.ToArray(),
                                              GetType(), 
                                              true);

     // compatible signatures for ExecuteAction
     // (assuming you aren't interested in sender and eventArgs):
     // static void ExecuteAction (ActionData) ;
     // void ActionData.ExecuteAction () ;
     MethodInfo miExecuteAction = <...> ;
     ILGenerator generator = method.GetILGenerator();
     generator.Emit (OpCodes.Ldarg_0) ;
     generator.Emit (OpCodes.Call, miExecuteAction) ;
     generator.Emit (OpCodes.Ret) ;

     // if you want to pass this to ExecuteAction, 
     // you'll need to put it into actionData.
     Delegate proxy = method.CreateDelegate(eventInfo.EventHandlerType, actionData);

     eventInfo.AddEventHandler(control, proxy);
} 
```

**编辑**：想想看，如果你所有的事件都遵循 (sender, args) 模式，你甚至不需要搞乱 SRE：

```
public static void Execute<T> (ActionData data, object sender, T args)
    where T : EventArgs
{
    ExecuteAction (data) ;
}

public void RegisterAction (ActionData actionData, EventInfo eventInfo, 
    Control control)
{
    MethodInfo compatibleMethod = typeof (this).GetMethod ("Execute",
        BindingFlags.Static | BindingFlags.Public).MakeGenericMethod (
        eventInfo.EventHandlerType.GetMethod ("Invoke").GetParameters ()[1].ParameterType)) ;
    eventInfo.AddEventHandler (control, 
        Delegate.CreateDelegate (eventInfo.EventHandlerType, actionData,
        compatibleMethod)) ;
} 
```

# php - 这个 PHP 表达式有什么问题？

> ID：674736
> 
> 赞同：0
> 
> 时间：2009-03-23T18:51:51.900
> 
> 标签：php, regex, preg-match-all

有人可以向我解释为什么以下返回空数组吗？

```
$reg = "/(\[{(false|true)};{.+};{\d}\])+/";
preg_match_all($reg,"[{false};{abcde};{10}][{true};{fghij};{10}]",$matches);
print_r($matches); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T18:55:00.833

你写的`\d`应该是`\d+`：

```
$reg = "/(\[{(false|true)};{.+};{\d+}\])+/";
preg_match_all($reg,"[{false};{abcde};{10}][{true};{fghij};{10}]",$matches);
print_r($matches); 
```

尽管在您的情况下似乎无关紧要，但我也会避开大括号，因为它们是特殊字符。

```
$reg = "/(\[\{(false|true)\};\{.+\};\{\d+\}\])+/"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T18:55:53.967

\d 应该是 \d+ 一个

# php - 基准测试 PHP 与 Pylons

> ID：674739
> 
> 赞同：2
> 
> 时间：2009-03-23T18:52:47.500
> 
> 标签：php, python, pylons, benchmarking

我想对 PHP 和 Pylons 进行基准测试。我希望我对两者的比较尽可能均匀，所以这就是我想出的：

*   带有 APC 的 PHP 5.1.6，使用 smarty 模板连接到 MySQL 数据库
*   Python 2.6.1，使用 Pylons 和 mako 模板连接同一个 MySQL 数据库

我应该在该设置中更改什么以使其进行更公平的比较吗？

我将在几乎没有任何活动、2G 内存和 4 个内核的备用服务器上运行它。

关于我应该或不应该如何对它们进行基准测试的任何建议？我计划使用 ab 进行实际的基准测试。

### 有关的

*   [哪个更快，python 网页或 php 网页？](https://stackoverflow.com/questions/77086/which-is-faster-python-webpages-or-php-webpages)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T19:15:57.817

如果你没有在 PHP 中使用 ORM，你也不应该使用 SQLAlchemy ORM 或 SQL-Expression 语言，而是使用原始 SQL 命令。如果您使用 APC，您应该确保 Python 对您的应用程序所在的文件夹具有写入权限，或者 .py 文件是预编译的。

此外，如果您使用 smarty 缓存，为了公平起见，请考虑启用 Mako 缓存。

但是有一个问题：Python MySQL 适配器非常糟糕。对于数据库连接，您可能会注意到性能下降（如果 SQLAlchemy 为自己执行 unicode 解码）或泄漏内存（如果 MySQL 适配器这样做）。

PHP 没有这两个问题，因为没有 unicode 支持。因此，为了公平起见，您必须在数据库连接中禁用 unicode（但这是一个令人难以置信的坏主意）。

所以：似乎没有一个公平的方法来比较 PHP 和 Pylons :)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:36:33.820

1.  你的 PHP 版本已经过时了，PHP 已经在 5.2.x 领域有一段时间了，虽然没有大的改进，但我会说有足够的变化来测试任何旧版本是不公平的比较。

2.  PHP 5.3 即将成为最终版本，您应该将其包含在您的基准测试中，因为 PHP 5.x 有很大的改进，并且是 5.x 的最后一个版本，如果您真的想分叉 PHP 6 也是在 alpha/beta 中，这也是一次大修。

3.  比较完全不同的语言可能很有趣，但不要忘记您是在比较苹果和橘子，而任何 2/3/N 层应用程序的最大瓶颈是等待 I/O。所以最大的因素是你的数据库速度，纯粹比较 PHP 与 Python VS ASP.Net 的速度是没有意义的，因为它们都将在不到 1 秒的时间内执行，但你可以轻松地等待 2-3 秒的数据库查询，具体取决于在你的硬件和你在做什么。

4.  **如果您担心什么更快，那么您在选择平台时采取了绝对错误的方法。** 还有更重要的问题，比如（不按顺序）：

    一种。在该平台上找到熟练的开发人员有多容易

    湾。那些熟练的开发人员要花多少钱

    C。该语言提供了多少投资回报率

    d。语言的功能有多丰富

# batch-file - 此代码等效的批处理文件

> ID：674744
> 
> 赞同：2
> 
> 时间：2009-03-23T18:53:37.153
> 
> 标签：batch-file, scripting, redirect, echo

嗨，我想在批处理文件中实现这个 C 代码

```
int i;
scanf("%d", &i);
for(int j = 0;j<i;j++)
{
  scanf("%d",&j);
  printf("%d",j);
} 
```

我将在 DOS 中使用 > 重定向运行 c 程序，以便打印输出以文件形式出现。我想在我的批处理文件中做同样的事情，我可以写类似的东西

```
 echo %variable% >> file 
```

但这对我不起作用

```
@echo off
for %%i in (1 2 3) do (
set /p c=enter a name?
echo %%i
echo %c% >> file.txt
) 
```

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T19:06:15.673

这是行不通的，因为您在尝试引用`if`块中的变化变量时需要延迟变量扩展。您可以尝试以下方法：

```
@echo off
setlocal enabledelayedexpansion
for %%i in (1 2 3) do (
  set /p c=enter a name? 
  echo %%i
  echo !c! >> file.txt
) 
```

`c`因为这只会在代码运行时评估，而不是在`if`解析行（在这种情况下是完整的语句）时评估。

不过，直接批量翻译您的 C 代码可能看起来更像以下内容：

```
@echo off
set /p i=
:loop
set /p j=
echo %j%
set /a j+=1
if %j% LSS %i% goto loop 
```

如果您愿意，您可以添加提示，尽管 C 程序也没有：)。现在您可以将批处理程序的输出作为一个整体进行管道传输，或者只是`>> file`在其中添加一个以进行良好测量。

# c# - 是否可以在“排列图标”菜单中添加选项？

> ID：674745
> 
> 赞同：0
> 
> 时间：2009-03-23T18:54:09.413
> 
> 标签：c#, sorting, desktop

我编写了一个基于控制台的简短 C# 应用程序，它会自动排列我的桌面图标。

是否可以在桌面“排列图标依据”菜单中添加一个条目以进行自定义排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T01:33:58.457

[这](http://www.extremetech.com/article2/0,1697,1839078,00.asp)可能会向您展示足够的技术来开始。

# php - 如何使用 PHP 将 RTF 文档拆分为单独的页面

> ID：674749
> 
> 赞同：1
> 
> 时间：2009-03-23T18:54:37.277
> 
> 标签：php, rtf, documents

我有一个 RTF 文档，用作从网页输入数据的模板。我需要知道如何将基本模板分解为单独的页面以显示在网站上。有没有办法使用 PHP 做到这一点？我曾尝试在文档中搜索 RTF 代码，但找不到任何可以给我一个很好的突破点的东西。如果有人有代码片段或知道如何做到这一点，我将永远感激不尽。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T19:10:57.767

RTF 文件中没有明确的分页符，除非用户将它们放在那里。“分页”是在呈现文档时计算的。IIUC 似乎没有简单的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T19:18:53.193

RTF 规范将 \page 表示为用于分页符的命令，但它似乎被大多数观众忽略了。例如，Google 文档在保存包含分页符的文档时不会生成带有分页符的 RTF。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-21T13:42:17.317

您可以添加`<br style=”page-break-before :always” />`到要结束页面的位置。

例子：

```
$string = 'This is page 1';
$string .= '<br style="page-break-before  :always" />';
$string .= 'This is page 2';
$string .= '<br style="page-break-before  :always" />'; 
```

更多详情请访问[http://www.webdev-tuts.com/create-an-rtf-file-and-add-page-break-using-php.html](http://www.webdev-tuts.com/create-an-rtf-file-and-add-page-break-using-php.html)

# windows - 在 IIS 中禁用匿名访问是否会产生安全风险？

> ID：674751
> 
> 赞同：8
> 
> 时间：2009-03-23T18:54:46.997
> 
> 标签：windows, security, http, iis

如果我*取消选中*IIS 中的“启用匿名访问”复选框，以便对站点进行密码保护，即通过限制对指定 Windows 帐户的读取访问，那么生成的密码对话是否会呈现给所有匿名 http 请求，是否存在安全风险因为它（似乎）提供了无限次数的尝试来猜测任何 Windows 帐户密码？

编辑：好的，到目前为止，对此并没有太大的乐趣，所以我附上了赏金。才50分对不起，我是个谦虚的人。为了澄清我所追求的：在 IIS 中禁用匿名访问是否会为公众提供以前不存在的密码猜测机会，或者浏览器的用户凭据对话是否可以通过在http 直接请求，并且响应将指示组合是否正确，即使该页面仍然对匿名用户开放？此外，通过 http 提交的错误密码尝试是否受到对内部登录强制执行的相同锁定策略的约束，如果是这样，这是否代表一个非常容易故意锁定已知用户名的机会，或者，如果不是，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-27T13:39:36.660

你的问题的简短回答是肯定的。每当您对网络上的任何资源进行任何远程访问时，都会带来安全风险。您最好的选择是遵循[IIS 最佳实践](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/596cdf5a-c852-4b79-b55a-708e5283ced5.mspx?mfr=true)，然后自己采取一些预防措施。[重命名您的内置管理员帐户](http://www.windowsecurity.com/articles/Protecting-Administrator-Account.html)。执行强密码策略。[更改服务器标头](http://windowsitpro.com/Web/article/articleid/22967/changing-the-server-http-header.html)。如果与适当的分层安全模型一起使用，则删除匿名访问虽然存在密码猜测风险，但它是一种非常易于管理的访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-24T07:55:01.457

您应该阅读有关可用的不同身份验证机制的信息：Basic、Digest、NTLM、Certificates 等。IETF[编制了一份文件](https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-security-properties-03)，讨论了其中一些的优缺点（NTLM 是专有的 MS 协议）。

底线是：您还没有完成仅禁用匿名访问。你一定要仔细考虑攻击场景是什么，潜在的损害可能是什么，用户可能愿意接受什么等等。

如果您引入授权，则需要解决凭据被泄露的风险。您还应该考虑您真正想要实现的是内容的机密传输：在这种情况下，您将不得不引入传输层安全性，例如 SSL。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-31T17:24:19.533

当您选择匿名以外的身份验证时，您肯定会受到密码黑客攻击。但是，使用的帐户受本地安全策略和您域的安全策略中设置的标准帐户锁定策略的约束。

例如，如果您有一个本地帐户“FRED”并且帐户锁定策略设置为 30 分钟内 5 次无效尝试，那么这可以有效地防止帐户密码被猜测，从而面临拒绝服务攻击的风险。但是，将重置窗口设置为一个值（15 分钟？）有效地限制了 DOS。

*   非 SSL 连接不建议使用基本身份验证，因为密码将以纯文本形式传输。

*   Digest 身份验证需要使用可逆加密将密码存储在服务器上，因此虽然比 Basic 更好，但 Digest 也有其缺陷。

*   Windows 集成身份验证包括 NTLM 和 Kerberos。

    *   IIS 服务器应通过组策略或本地安全设置配置以禁用 LM 身份验证（网络安全：LAN Manager 身份验证级别设置为“仅发送 NTLMv2 响应”或更高，首选是“仅发送 NTLMv2 响应\拒绝 LM 和 NTLM”）防止微不足道的 LM 哈希破解并防止 NTLM 中间人代理攻击。

    *   可以使用 Kerberos，但它仅在两台机器是同一域的成员并且可以访问 DC 时才有效。由于这通常不会在 Internet 上发生，因此您可以忽略 Kerberos。

所以最终的结果是，是的，禁用匿名确实会让您面临密码破解尝试和 DOS 攻击，但这些都是可以预防和减轻的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-27T14:00:20.510

我知道意味着托管大师，我想有办法做到这一点，但我个人的观点是，你所说的做的事情无疑是一种不必要的安全风险。如果该站点要在 Internet 上可用，即它将具有公共访问权限，那么您可能不想在 IIS 中禁用匿名访问。

请记住，能够在 IIS 中为站点配置匿名访问的想法是，您可以创建一个具有特定权限的用户来读取特定站点的相关文件。我们在这里谈论的是物理磁盘上的文件访问。一方面，公共 Web 服务器应该在 DMZ 中，而不是您公司域的一部分，因此用户无论如何都不能使用他们的域凭据登录。

我可以想象您想要关闭匿名访问并强制用户输入他们的 Windows 凭据的唯一原因是针对仅在内部使用的站点，即使那样我也可能不会选择以这种方式限制访问。

如果您想限制对公共网站上内容的访问，那么您最好编写一些处理身份验证的东西作为网站本身的一部分或网站可以使用的服务。然后，如果有人要获取用户凭据，那么至少他们所能做的就是访问该站点，并且不会以任何方式破坏您的内部网络。

开发人员花费大量时间编写用户管理解决方案是有原因的。你会发现很多关于如何编写这样的东西的建议，以及很多可以为你完成大部分工作的库。

# asp.net - 这个 ExecuteDataset 方法发生了什么？

> ID：674752
> 
> 赞同：0
> 
> 时间：2009-03-23T18:54:58.697
> 
> 标签：asp.net, sqlhelper

好的，所以我在一页上找到了这一行：

```
objDsCourse = SqlHelper.ExecuteDataset(ConfigurationManager.ConnectionStrings("connstr").ConnectionString, CommandType.StoredProcedure, "Course_NewReportGet_Get_Sav", objPAra) 
```

我将它复制到另一个页面以开始修改它以在那里工作：

```
getData = SqlHelper.ExecuteDataset(ConfigurationManager.ConnectionStrings("connstr").ConnectionString, CommandType.StoredProcedure, "Course_NewReportGet_Get_Sav", objPAra) 
```

但是在新页面上，它强调 .ConnectionStrings 说不可调用成员'System.Configuration.ConfigurationManager.ConnectionStrings'不能像方法一样使用'......那么为什么它在其他页面中起作用？

编辑：好的，所以我在 web.config 中找到了我认为它引用的内容，因为它说

```
<add name="ConnStr" connectionString="data source=..." /> 
```

为什么一个页面可以访问这个而另一个不能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T19:01:18.993

有没有可能一页使用 VB.NET，而另一页使用 C#？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:06:43.673

我同意丹尼尔的观点。在 Visual Basic 中，字典对象和方法都使用括号来引用。这可能会引起一些混乱。

所以在 VB 中，`ConfigurationManager.ConnectionStrings("connstr")`会指向字典中键为“connstr”的 ConnectionString 对象。

在 C# 中，字典对象由方括号 [] 引用，因此`ConfigurationManager.ConnectionStrings("connstr")`字面意思是“使用“connstr”作为参数调用 ConfigurationManager 对象的 ConnectionStrings 方法。

长话短说，检查顶部的 <%@ Page %> 声明以确保两个页面使用相同的语言。...或者，在出现错误的页面上，更改行以使用`ConfigurationManager.ConnectionStrings["connstr"]`语法。

# python - Python中的字符串查找示例

> ID：674764
> 
> 赞同：63
> 
> 时间：2009-03-23T18:57:43.417
> 
> 标签：python, string, find

我试图找到一些例子，但没有运气。有人知道网上的一些例子吗？我想知道它在找不到时返回什么，以及如何从头到尾指定，我猜这将是 0、-1。

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-03-23T19:00:13.940

我不确定你在找什么，你的意思是[`find()`](http://docs.python.org/library/stdtypes.html#str.find)？

```
>>> x = "Hello World"
>>> x.find('World')
6
>>> x.find('Aloha');
-1 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-03-23T19:00:24.843

你也可以使用[`str.index`](http://docs.python.org/library/stdtypes.html?highlight=index#str.index)：

```
>>> 'sdfasdf'.index('cc')
Traceback (most recent call last):
  File "<pyshell#144>", line 1, in <module>
    'sdfasdf'.index('cc')
ValueError: substring not found
>>> 'sdfasdf'.index('df')
1 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-03-23T19:03:50.170

从[文档中](https://docs.python.org/library/stdtypes.html#str.find)：

> ```
> str.find(sub[, start[, end]]) 
> ```
> 
> 返回在 slice 中找到子字符串*sub*`s[start:end]`的字符串中的最低索引。可选参数*start*和*end*被解释为切片表示法。`-1`如果未找到*sub*则返回。

所以，一些例子：

```
>>> my_str = 'abcdefioshgoihgs sijsiojs '
>>> my_str.find('a')
0
>>> my_str.find('g')
10
>>> my_str.find('s', 11)
15
>>> my_str.find('s', 15)
15
>>> my_str.find('s', 16)
17
>>> my_str.find('s', 11, 14)
-1 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-03-23T19:02:04.357

老实说，在这种情况下，我只是在命令行上打开 Python 并开始胡闹：

```
 >>> x = "Dana Larose is playing with find()"
 >>> x.find("Dana")
 0
 >>> x.find("ana")
 1
 >>> x.find("La")
 5
 >>> x.find("La", 6)
 -1 
```

Python 的解释器使这种实验变得容易。（对于具有类似解释器的其他语言也是如此）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-09-04T06:44:36.190

如果要在文本中搜索字符串的最后一个实例，可以运行 rfind。

例子：

```
 s="Hello"
   print s.rfind('l') 
```

输出：3

*无需导入

**完整的语法：**

```
stringEx.rfind(substr, beg=0, end=len(stringEx)) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T19:01:32.797

`find( sub[, start[, end]])`

返回找到子字符串 sub 的字符串中的最低索引，使得 sub 包含在范围 [start, end] 中。可选参数 start 和 end 被解释为切片表示法。如果未找到 sub，则返回 -1。

从[文档](http://www.python.org/doc/2.4.4/lib/string-methods.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-28T06:11:36.223

试试这个：

```
with open(file_dmp_path, 'rb') as file:
fsize = bsize = os.path.getsize(file_dmp_path)
word_len = len(SEARCH_WORD)
while True:
    p = file.read(bsize).find(SEARCH_WORD)
    if p > -1:
        pos_dec = file.tell() - (bsize - p)
        file.seek(pos_dec + word_len)
        bsize = fsize - file.tell()
    if file.tell() < fsize:
        seek = file.tell() - word_len + 1
        file.seek(seek)
    else:
        break 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-04T17:29:23.880

如果 x 是一个字符串并且您搜索 y 这也是一个字符串，它们有两种情况： **案例 1：** y 存在于 x 所以 **x.find(y)** = x 中 y 的索引（位置）。 **情况 2：** y 不存在，因此 **x.find (y)** = -1 这意味着在 x 中找不到 y。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-30T18:39:48.013

尝试

```
myString = 'abcabc'
myString.find('a') 
```

这会给你索引！！！

# drupal - 如何在 Drupal 中存储 Blob？

> ID：674766
> 
> 赞同：0
> 
> 时间：2009-03-23T18:57:58.063
> 
> 标签：drupal, drupal-6

我想在 Drupal 中存储 PDF 和图像文件。默认情况下，Drupal 似乎将二进制/上传的文件存储到文件系统中。我希望能够存储文件，以便 - 我可以拥有工作流、元数据、IP 信息和 URL 别名？

**更新**，我仍然坚持如何为文件系统上的文件创建 URL 别名。Drupal 似乎只允许为节点内容创建 URL 别名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T22:34:29.853

Drupal 最简单的解决方案是使用核心中的上传模块。上传模块允许您将文件附加到节点。正如您所注意到的，它们存储在文件系统中。

如果您想变得更复杂，您可以使用 CCK 系列模块（例如 filefield 模块或 imagefield 模块）通过 Web 界面构建自己的内容类型。您的文件仍存储在文件系统中。

您可以使用 CCK 创建所需的元数据字段。

您可以使用工作流或规则模块来实现工作流。

IP 信息由 Drupal 的日志记录模块（数据库日志记录模块，记录到数据库，或 syslog 模块，记录到 syslog）自动记录。

通过启用 path 模块（或下载 pathauto 模块以自动创建别名），可以在核心 Drupal 中使用节点的 URL 别名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-16T15:08:00.657

为文件创建别名可能需要一些自定义代码。

无法使用管理 > 站点构建 > URL 别名屏幕简单地创建别名。我尝试插入一条记录

```
insert into url_alias (src, dst) values ('sites/default/files/ChipotleArt.JPG', 'here-is-the-file.jpg'); 
```

那仍然没有用。所以，你真的很可能需要编写一些自定义代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T19:53:22.680

我尝试了 Drupal 的上传模块、FileField 以及使用 FCKEditor 上传文件——我更喜欢最后一个——它更接近我的具体场景。

# c# - WPF 数据绑定魔术

> ID：674771
> 
> 赞同：3
> 
> 时间：2009-03-23T18:59:19.450
> 
> 标签：c#, wpf, data-binding

我有绑定到 ItemsControl 的 ObservableCollection<Foo> （基本上显示一个列表）。

Foo 大多看起来像这样（还有其他成员，但它没有实现任何接口或事件）：

```
class Foo
{
  public string Name { get; set; }
  //...
} 
```

当用户单击一个项目时，我打开一个对话框，用户可以在其中编辑 Foo 的属性（绑定到具有所选项目的 Foo 属性的小视图模型），Xaml 如下所示：

```
<TextBox Text="{Binding Foo.Name,Mode=TwoWay}"
    Grid.Column="1" Grid.Row="0" Margin="2" /> 
```

真正奇怪的是，**当用户编辑名称时，列表中的值会发生变化！**（不是在打字时而是在焦点离开字段之后）

它是如何做到的？我还没有在 Foo 对象上实现 INotifyPropertyChanged 接口！

到目前为止，我检查它不仅刷新了整个列表 - 仅刷新了选定的项目。但我不知道我可以在哪里设置断点来检查谁在打电话。

* * *

更新：感谢 casperOne 提供解决方案的链接！我将在此处添加一个摘要，以防出现 404：

[..] 实际上，您遇到了 WPF 的另一个隐藏方面，那就是 WPF 的数据绑定引擎将数据绑定到 PropertyDescriptor 实例，如果源对象是普通 CLR 对象并且不实现 INotifyPropertyChanged 接口，则该实例包装源属性。并且数据绑定引擎将尝试通过 PropertyDescriptor.AddValueChanged() 方法订阅属性更改事件。而当目标数据绑定元素改变属性值时，数据绑定引擎会调用 PropertyDescriptor.SetValue() 方法将改变后的值传回源属性，同时会引发 ValueChanged 事件通知其他订阅者（在这种情况下，其他订阅者将是 ListBox 中的 TextBlock。

如果您正在实施 INotifyPropertyChanged，您将完全负责在需要将数据绑定到 UI 的属性的每个设置器中实施更改通知。否则，更改将不会像您期望的那样同步。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T19:05:14.410

这是一个完全的猜测，但我认为因为您启用了双向绑定，所以 WPF 现在知道**它**何时进行更改，并将更新它知道绑定到同一实例的其他项目。

因此，因为您已经通过文本框更改了 Name 属性的值，并且 WPF 知道您何时更改了该值，所以它会尽力更新它所知道的绑定到它的任何其他内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:03:11.733

它使用反射来设置该属性的值。仅当需要通知 TextBox Foo 类的 Name 属性发生更改时，才需要 INotifyPropertyChanged。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-24T11:27:20.073

因为它们数据绑定到同一个对象。如果您将绑定更改为

```
{Binding Foo.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged} 
```

然后当用户在文本框中键入时它们将同步。

# sql - Sql 数据库查询的统一记录

> ID：674776
> 
> 赞同：1
> 
> 时间：2009-03-23T19:01:05.857
> 
> 标签：sql, database, join

基本需求是，如果一条记录的属性为“紧急”，则该属性值应显示在“紧急”列中。如果记录的属性值为“已关闭”，则该属性值必须显示在“已关闭”列中。

我在下面有一个查询。我的问题是，在我返回的结果中，有两条具有相同 RequesterID 的记录（一条在“紧急”列中具有有效值，一条在“已关闭”列中具有值）我的问题是我需要这两个特定记录显示为一条记录。

有任何想法吗？

```
SELECT DISTINCT 
   r.RequesterID,
   sr.ModifiedDate,
   p.FirstName + ' ' + p.LastName AS RequesterName,
   CASE
     WHEN sa.Attribute = 'Urgent' THEN sa.AttributeValue
     ELSE NULL
   END AS Urgent,
   CASE
     WHEN sa.Attribute = 'Closed' THEN sa.AttributeValue 
     ELSE NULL
   END AS Closed
FROM
   Requester AS r 
   INNER JOIN SubRequester AS sr 
     ON r.RequesterID = sr.RequesterID
   INNER JOIN SubRequesterAttribute AS sa
     ON sr.SubRequesterID = sa.SubRequesterID
   CROSS JOIN Personnel AS p
WHERE 
     (r.UserID = p.ContractorID
     OR r.UserID = p.EmployeeID)
   AND 
     (sa.Attribute IN ('Urgent', 'Closed'))
GROUP BY r.RequesterID, sr.ModifiedDate, p.FirstName, p.LastName, 
   sa.Attribute, sa.AttributeValue 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T19:07:19.570

您需要将您的子请求者属性表加入到查询中两次。一个是紧急属性，一个是关闭属性。

对于它们可能为空的实例，您需要 LEFT 连接到这些实例，然后引用 SELECT 中的每个表以显示相关属性。

我也不推荐交叉连接。您应该在 FROM 子句中对 person 表执行“OR”连接，而不是在 WHERE 子句中执行交叉连接和过滤。

编辑：对不起，我的第一反应有点仓促。现在有机会再进一步​​看看。由于子请求者和子请求者属性都是重复的，您需要将它们都拆分为子查询。此外，两个值的修改日期可能不同。所以我加倍了。这是完全未经测试的，绝不是“最佳”解决方案。在没有实际数据库检查的情况下编写查询非常棘手。希望它能解释我的意思。

```
SELECT
    r.RequesterID,
    p.FirstName + ' ' + p.LastName AS RequesterName,
    sra1.ModifiedDate as UrgentModifiedDate,
    sra1.AttributeValue as Urgent,
    sra2.ModifiedDate as ClosedModifiedDate,
    sra2.AttributeValue as Closed
FROM
    Personnel AS p
INNER JOIN
    Requester AS r 
ON
(
    r.UserID = p.ContractorID
OR
    r.UserID = p.EmployeeID
)
LEFT OUTER JOIN
(
    SELECT
        sr1.RequesterID,
        sr1.ModifiedDate,
        sa1.Attribute,
        sa1.AttributeValue
    FROM
        SubRequester AS sr1
    INNER JOIN
        SubRequesterAttribute AS sa1
    ON
        sr1.SubRequesterID = sa1.SubRequesterID
    AND
        sa1.Attribute = 'Urgent'
) sra1
ON
    sra1.RequesterID = r.RequesterID
LEFT OUTER JOIN
(
    SELECT
        sr2.RequesterID,
        sr2.ModifiedDate,
        sa2.Attribute,
        sa2.AttributeValue
    FROM
        SubRequester AS sr2
    INNER JOIN
        SubRequesterAttribute AS sa2
    ON
        sr2.SubRequesterID = sa2.SubRequesterID
    AND
        sa2.Attribute = 'Closed'
) sra1
ON
    sra2.RequesterID = r.RequesterID 
```

第二次编辑：我的最后一次编辑是有多个​​ SubRequesters 以及多个 Attribute，从您最后的评论中您想显示所有 SubRequesters 和两个相关属性？您可以按如下方式实现。

```
SELECT
    r.RequesterID,
    p.FirstName + ' ' + p.LastName AS RequesterName,
    sr.ModifiedDate,
    sa1.AttributeValue as Urgent,
    sa2.AttributeValue as Closed
FROM
    Personnel AS p
INNER JOIN
    Requester AS r 
ON
(
    r.UserID = p.ContractorID
OR
    r.UserID = p.EmployeeID
)
INNER JOI N
    SubRequester as sr
ON
    sr.RequesterID = r.RequesterID
LEFT OUTER JOIN
    SubRequesterAttribute AS sa1
ON
    sa1.SubRequesterID = sr.SubRequesterID
AND
    sa1.Attribute = 'Urgent'
LEFT OUTER JOIN
    SubRequesterAttribute AS sa2
ON
    sa2.SubRequesterID = sr.SubRequesterID
AND
    sa2.Attribute = 'Closed' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:44:24.800

通常，如果您有多行并希望将它们合并为一行，则 GROUP BY 是实现此目的的基本工具。看起来您试图朝那个方向前进，但没有完全到达那里。您要做的是按行之间重复的表达式进行分组，并将组函数应用于将消除 NULL 值的其他表达式。我在下面的示例中使用了 MIN，但您也可以轻松使用 MAX；关键是，由于最多有一个行将具有该表达式的值，因此该值既是最小值又是最大值。

```
SELECT
   r.RequesterID,
   sr.ModifiedDate,
   p.FirstName + ' ' + p.LastName AS RequesterName,
   MIN(
   CASE
     WHEN sa.Attribute = 'Urgent' THEN sa.AttributeValue
     ELSE NULL
   END
   ) AS Urgent,
   MIN(
   CASE
     WHEN sa.Attribute = 'Closed' THEN sa.AttributeValue 
     ELSE NULL
   END
   ) AS Closed
FROM
   Requester AS r 
   INNER JOIN SubRequester AS sr 
     ON r.RequesterID = sr.RequesterID
   INNER JOIN SubRequesterAttribute AS sa
     ON sr.SubRequesterID = sa.SubRequesterID
   CROSS JOIN Personnel AS p
WHERE 
     (r.UserID = p.ContractorID
     OR r.UserID = p.EmployeeID)
   AND 
     (sa.Attribute IN ('Urgent', 'Closed'))
GROUP BY r.RequesterID, sr.ModifiedDate, p.FirstName + ' ' + p.LastName 
```

# c# - .Net SendAsync 总是发送所有数据？

> ID：674777
> 
> 赞同：1
> 
> 时间：2009-03-23T19:01:13.047
> 
> 标签：c#, networking

将`Socket.SendAsync`始终发送已分配的`byte[]`缓冲区中的所有数据吗？`SocketAsyncEventArgs`我已经测试了一些代码，但只在本地网络上测试过，而且似乎是这样的..

编辑：
好的，但它总是在运行完成的事件之前发送所有数据吗？

如果我没记错的话唯一`socket.BeginSend`没有..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T19:05:23.320

不，它不会。这里有很多因素需要考虑，包括缓冲、超时等......

最简单的考虑是 IPV4 级别的数据包限制。IPV4 数据包有一个不能超过的严格限制（65,535 字节）。因此，SendAsync 无法将大于 IPV4 数据包大小的数据推送到单个数据包中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T19:07:24.827

但是，它将尝试从 MSDN 上的文档发送所有数据：

“对于面向消息的套接字，不要超过底层 Windows 套接字服务提供者的最大消息大小。如果数据太长而无法以原子方式通过底层服务提供者，则不会传输任何数据，并且 SendAsync 方法会抛出带有SocketAsyncEventArgs.SocketError 设置为本机 Winsock WSAEMSGSIZE 错误代码 (10040)。”

有时应该拆分太大的缓冲区。这取决于底层的套接字实现。

# sql-server - 如何减少服务代理队列的泛滥？

> ID：674783
> 
> 赞同：2
> 
> 时间：2009-03-23T19:02:22.267
> 
> 标签：sql-server, sql-server-2005, service-broker

我是使用 SQL Service 2005 Service Broker 的新手。我已经创建了队列并成功地进行了对话，等等。但是，我想对消息进行“节流”，但我不知道该怎么做。

消息由多用户应用程序调用的存储过程发送。假设有 20 个用户在 30 秒内每个用户调用一次此 proc，它只需要发送一次。所以我认为我需要从我的 proc 中获取某种方式来查看是否在过去 30 秒内发送了一条消息？有没有办法做到这一点？

我的一个想法是向“响应”队列发送一条消息，指示是否已调用请求队列激活过程。然后在我的存储过程（由用户应用程序调用）中查看最近是否调用了该特定消息。问题是我不希望这弄乱响应队列。可以查看队列（不接收）以查看其中是否存在消息吗？

或者有没有更简单的方法来完成我所追求的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-06T08:17:46.533

是的，您可以先查看队列以查看其中是否有消息。只需使用 SELECT 而不是 RECEIVE 查询队列，您就可以查看数据。

更好的选择是发送消息并让接收消息的存储过程决定是否应该丢弃消息。

我一次向服务代理发送数十万条消息，没有任何性能问题。

如果您发现性能问题，请尝试在每个对话中发送多条消息，因为这是提高 Service Broker 性能的最快捷、最简单的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T20:31:13.377

不确定您是否可以以某种方式在 SB 中执行此操作，但是您是否可以只拥有一个包含时间戳字段的表，该表在发送消息时会更新。proc 将检查 > 30 秒的时间差异并发送。

# class - 静态内部类是个好主意还是糟糕的设计？

> ID：674788
> 
> 赞同：5
> 
> 时间：2009-03-23T19:03:23.980
> 
> 标签：class, oop, inheritance, inner-classes, nested-class

我发现我有几个地方设计了扩展“帮助器”类的公共静态内部类，这使我的代码更加安全，并且在我看来，可读性更高。例如，假设我有一个“SearchCriteria”类。我搜索的不同事物有很多共同点（一个搜索词，然后是一组搜索词类型、日期范围等）。通过在静态内部类中扩展它，我将扩展和可搜索紧密耦合类有具体区别。这在理论上*似乎*是一个坏主意（紧耦合坏！），但扩展是特定于这个可搜索的类（一个类，一个目的）。

我的问题是，根据你的经验，使用静态内部类（或任何你的语言等价物）是否使你的代码更具可读性/可维护性，或者这最终会在 EOF 中咬你？

另外，我不确定这是否是社区 wiki 材料。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T19:40:29.757

对我来说听起来很合理。通过使它成为一个内部类，当可搜索类发生变化时，您可以轻松找到它并成为审查的明显候选者。

只有当您将并不真正属于在一起的事物耦合在一起时，紧密耦合才是不好的，因为它们中的一个碰巧调用了另一个。对于密切协作的类，例如，在您的情况下，其中一个存在以支持另一个，则称为“内聚”，这是*一件好事*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T19:19:14.440

请注意，类不是重用单元。因此，类之间的一些耦合是正常的和预期的。重用单元通常是相关类的集合。

在 Python 中，我们有多种结构。

1.  包裹。它们包含模块。这些本质上是包含一些 Python 机制的目录。

2.  模块。它们包含类（和函数）。这些是文件；并且可以包含任意数量的密切相关的类。通常，“内部阶层”业务是在这个级别处理的。

3.  上课。这些可以包含内部类定义以及方法函数。有时（不经常）实际上可能会使用内部类。这很少见，因为类之间的模块级耦合通常非常清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-23T01:32:48.843

使用内部类的唯一警告是确保你不会在所有地方重复自己 - 就像 - 确保当你定义一个内部类时，你不需要在其他任何地方使用该功能，并且，该功能必须与外部类耦合。您不想最终得到一大堆实现完全相同`setOrderyByNameDesc()`方法的内部类。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-03-23T19:18:34.567

“松散耦合”的重点是保持两个类分开，这样如果“SearchCriteria”类中的代码发生更改，其他类中的任何内容都不必更改。我认为您正在谈论的静态内部类可能会使维护代码成为一场噩梦。SearchCriteria 中的一项更改可能会让您搜索所有静态类，以找出哪些因更新而损坏。就个人而言，除非出于某种原因确实需要它，否则我会远离任何此类内部类。

# sql-server - 笔记本电脑休眠模式、sql express 和数据损坏

> ID：674791
> 
> 赞同：1
> 
> 时间：2009-03-23T19:03:59.720
> 
> 标签：sql-server

我们最近在配置为使用休眠 (windows xp) 的笔记本电脑上的 sql server express 2005 中托管的数据库中遇到了损坏问题（错误 824）。我还没有访问这台笔记本电脑的权限来执行磁盘测试。

在笔记本电脑上使用休眠模式和 sql server express 是否存在任何已知问题？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T19:26:10.850

我很少看到它被提及（我认为是在休眠后无法创建新连接）。

我有一个类似的设置，虽然我现在使用的是 2008 版本，并且我经常（基本上每天）在一天结束时将我的机器发送到休眠模式，并且没有看到类似的问题。

我将从事件日志（系统和应用程序）开始，看看您在将其发送到休眠状态或 SQL Server 尝试启动时是否注意到与文件或 IO 错误相关的任何内容。

# javascript - 框架、脚本和加载顺序

> ID：674792
> 
> 赞同：4
> 
> 时间：2009-03-23T19:04:06.753
> 
> 标签：javascript, dhtml, frames

如果我有一个带有框架集和一些在 head 标记中定义的 javascript 的文档，例如：

```
<html>
 <head>
  <script>
     function foo() {}
  </script>   
 </head>
 <frameset>
    <frame src="A.html">
 </frameset>     
</html> 
```

我已经假设框架（A.html）在其父级之前触发其 onLoad 事件处理程序。我几乎肯定这是一个安全的假设。但是，假设 A.html 的脚本上下文可以安全地访问父窗口头部中定义的所有脚本代码是否安全？

我可以做出哪些假设？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T19:21:31.703

根据[此页面，您可以安全地访问](http://jennifermadden.com/javascript/frame.html)**parent**中的脚本，它是引用框架的父框架集文档的对象。

从一个小的本地测试来看，父母的 onload 事件**似乎没有触发**，但它的脚本标签似乎在加载子框架*之前已经被处理了。*

这些天框架集不受欢迎，因此请确保这是正确的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-25T06:30:28.093

`parent`框架脚本将能够通过引用访问其父 JS 空间。（但前提是这两个文档位于同一主机上 - 它们在您的精简示例中）。

我不会在*A.html之后依赖父级的***onLoad**触发，尽管正如 Phil 提到的，脚本将首先处理 - 这是因为内联脚本评估是一个阻塞操作。

 *# wpf - 使用表格 UI 显示多值列

> ID：674803
> 
> 赞同：1
> 
> 时间：2009-03-23T19:07:24.907
> 
> 标签：wpf, datagrid

我希望以表格 UI 格式显示多值列。多值列是指单个单元格可以同时具有多个值的列 - 也就是值列表。这些值可能来自一个简短的可能性列表（例如一个枚举）或一个长列表（例如另一个表）。想象一个包含“朋友”列的联系人表，该列可以引用零个或多个其他联系人。

我需要添加新值、删除值的能力，理想情况下，这些值将水平列出并自动换行。我有一种感觉，地球上没有开箱即用的数据网格控件可以做到这一点，但我认为这是提出这样一个问题的正确论坛。

我猜测当前的技术状态是以表格而不是表格的形式显示信息（例如，一行的“详细信息”）。但是，我们希望以水平环绕、内嵌可编辑的方式实际显示表格列中的值。目前，我们正计划使用 WPF，所以我希望有一个 WPF 解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T19:41:25.103

WPF 绝对是这项工作的正确工具。一旦您了解了一些核心 WPF 概念（主要是绑定和 DataTemplates），我认为您不会很难获得想要的布局。我建议可能是一个[ListView/GridView](http://msdn.microsoft.com/en-us/library/ms747048.aspx)和一个 GridViewColumn 和一个自定义 CellTemplate 包含一个 ItemsControl 和它自己的 DataTemplate ...简单，真的 ;-)

# flv - 如何在网页中显示带有 flv 文件的字幕？

> ID：674812
> 
> 赞同：1
> 
> 时间：2009-03-23T19:10:48.593
> 
> 标签：flv, flvplayback, subtitle

我已经为 mp4 格式的视频创建了字幕，我想将其作为 FLV 文件放到网上。是否可以将字幕与flv文件一起播放而无需将它们集成到视频图像中，因此将它们保持为srt格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T14:22:18.317

我找到了一种方法，使用 JW flv 播放器：

1.  将您的 .srt 文件转换为 xml 文件（下面的 php 代码）
2.  然后添加一个指向您的 xml 文件的变量“captions”：

s0.addVariable("captions","path/to/subtitles.xml");

活的例子[在这里](http://www.ergonomie-web.be/placer-lutilisateur-au-centre-paul-bennett-ideo-video/ "现场字幕 flv 视频示例")

 `````
// script to convert multi-line srt caption files to new-format (02-05-08) tt XML caption files
$use_cdata_tags = true;
$debug_output = true;

// the directory to write the new files in
// it must exist, be writeable, and be outside of the directory that is being scanned
$new_directory = '../temp/';

/////////////////////////////////// no user configuration below this \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\

// get filename or scan directory if it's a directory
$filename = (isset($_GET["filename"])) ? strval($_GET["filename"]) : "./";

// read each file into an array
$it = new RecursiveDirectoryIterator("$filename");

foreach(new RecursiveIteratorIterator($it) as $file)
{

// debug('Filename', $file); exit;
// debug('Ext', substr(strtolower($file), (strlen($file) - 4), 4));// exit;

// debug - only use test file
// if($file == '.\multi-line_test_file.srt')

  // check for .srt extension
  if(substr(strtolower($file), (strlen($file) - 4), 4) == '.srt')
  {
    $ttxml     = '';
    $full_line = '';

    if($file_array = file($file))
    {
      // write tt , head, and div elements for the new file
     $ttxml .= "";
      $ttxml .= "\n";
      $ttxml .= "  \n";
      $ttxml .= "  \n";
      $ttxml .= "  \n";
      $ttxml .= "    \n";

      foreach($file_array as $line)
      {
        $line = rtrim($line);

// debug('Line', $line);

        // get begin and end
        //                00  :  00  :  32  ,   000   -->   00  :  00  :  37  ,   000
        if(preg_match('/(\d\d):(\d\d):(\d\d),(\d\d\d) --> (\d\d):(\d\d):(\d\d),(\d\d\d)/', $line, $match))
        {
          $begin = $match[1] . ":" . $match[2] . ":" . $match[3] . "." . $match[4];
          $end   = $match[5] . ":" . $match[6] . ":" . $match[7] . "." . $match[8];
          $full_line = '';
        }
        // if the next line is not blank, get the text
        elseif($line != '')
        {
          if($full_line != '')
          {
            $full_line .= '
' . $line;
          }
          else
          {
            $full_line .= $line;
          }
        }

        // if the next line is blank, write the paragraph
        if($line == '')
        {
          // write new paragraph
          //                 Nothing is going on.
          if($use_cdata_tags)
          {
            $ttxml .= "      \n";
          }
          else
          {
            $ttxml .= "      " . $full_line . "\n";
          }

// debug('Text', $line);
// debug('ttxml', $ttxml); exit;

          $full_line = '';
        }
      }

// write ending tags
$ttxml .= " \n";
$ttxml .= " \n";
$ttxml .= "\n";

      // write new file
      $new_file = $new_directory . substr($file, 0, (strlen($file) - 4)) . '.xml';
      $fh = fopen($new_file, 'w') or die('Can\'t open: ' . $new_file);
      fwrite($fh, $ttxml) or die('Can\'t write to: ' . $new_file);
      fclose($fh);
    }
  }
}

function debug($title, $value)
{
  global $debug_output;

  if ($debug_output)
  {
    print "

```
";
    if (is_array($value))
    {
      print $title . ":\n";
      print_r($value);
    }
    else
    {
      print $title . ": " . $value;
    }
    print "
```

\n";
  }
}

?>

````  `# windows-vista - Windows Vista 在哪里存储配置文件图像？

> ID：674815
> 
> 赞同：3
> 
> 时间：2009-03-23T19:11:00.730
> 
> 标签：windows-vista, user-profile

我只是想知道是否有人知道 vista 将每个用户帐户的个人资料图像存储在哪里。我知道在 XP 中它存储在 C:\Documents and Settings\All Users\Application Data\Microsoft\User Account Pictures 中，但是当我在 vista 中浏览等效路径时，我只有一个 user.bmp 和一个 guest.bmp . 我知道如果我不允许任何自定义用户个人资料图像，这些是默认设置，但这不是我想要遵循的路线。我假设 vista 与配置文件图像名称为 .bmp 的 XP 相同，但是当我进行搜索时，我无法在任何地方找到任何图像。vista 是否已将配置文件图像存储移动到注册表中？

我也知道有一个临时目录 C:\Users\<username>\AppData\Local\Temp，其中包含我正在寻找的文件，但是我修改它们的所有内容，当我加载配置文件时，它们都会被覆盖. 我认为这正在发生，因为它是一个临时目录。这使我相信所有这些图像都有一个主目录。

谢谢，
乔纳森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-08-15T00:08:52.723

这个[有用的帖子](http://deployment.xtremeconsulting.com/2010/06/23/usertile-automation-part-1/)有一个 vb 脚本，它在 SysInternals psexec 的帮助下修改 SAM 以设置用户帐户图片（又名 UserTile）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-05T16:34:22.697

我也想这样做，但我发现在 Vista 下无法以编程方式更改用户图片。我在这里找到了答案：

[更改用户图片？](http://social.msdn.microsoft.com/Forums/en-US/windowsuidevelopment/thread/c720975f-e8cd-4e33-983e-58269ad33f6c)

# c# - 如何在 .NET 的 MVC 中捕获过滤器引发的异常？

> ID：674816
> 
> 赞同：2
> 
> 时间：2009-03-23T19:11:40.370
> 
> 标签：c#, .net, model-view-controller, exception, filter

我正在开发的应用程序中的一个过滤器检查用户是否拥有他们试图更改的项目。动作由`[RequiresOwnership]`属性修饰，在属性逻辑中，我检查用户是否拥有该项目，如果他们不拥有，我抛出一个`UnauthorizedAccessException`.

我的问题是：我在哪里可以捕捉到那个异常？理想情况下，我希望将用户重定向到一个页面，解释为什么不允许他们尝试做的事情，而不是仅仅显示一个异常页面。我认为我不会在由属性修饰的操作中捕获异常，那么在 .NET MVC 模型中是否有一些应用程序的基础部分可以处理更高层抛出的异常？

编辑：我意识到我可以通过过滤器本身重定向到一个页面，但这对我来说似乎有点 hacky。通过属性抛出异常会很好，并且有一个标准的地方可以捕获和处理它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T19:23:08.177

我认为您想要的是控制器上的 [HandleError] 属性，它采用错误处理程序视图的可选路径。默认为 ~/Views/Shared/Error.aspx；您可以在那里为您的特定例外添加额外的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-19T21:19:07.447

我遇到了这个问题，我解决它的方法是将异常添加到 FilterContext 的 TempData 集合中，而不是抛出它。然后，您可以在您的操作方法中检查它，重新抛出它并适当地处理它：

在属性中：

```
if (/*some error condition*/)
   filterContext.Controller.TempData["Err"] = new Exception("An error"); 
```

在动作方法中：

```
var e = TempData["Err"] as Exception;
if (e != null)
    throw e; 
```

这是一个不太理想的解决方案，但正如您所提到的，没有从属性中捕获异常的有用地方。

# php - Zend Framework Lucene Boolean / “Google”-like 搜索

> ID：674817
> 
> 赞同：1
> 
> 时间：2009-03-23T19:11:59.683
> 
> 标签：php, zend-framework, codeigniter

我正在[http://demos.zatechcorp.com/codeigniter/上处理该应用程序](http://demos.zatechcorp.com/codeigniter/)

在我的机器上运行的当前版本中，我在 Codeigniter 中加载了 ZendFramework，并生成了一个索引，如下所示：

```
 // ... Some code that loads all the markets
    foreach ($markets as $market)
    {
        $doc = new Zend_Search_Lucene_Document();
        // Id for retrieval
        $doc->addField(Zend_Search_Lucene_Field::UnIndexed('id', $market->id));
        // Store document URL to identify it in search result.
        $doc->addField(Zend_Search_Lucene_Field::Text('url', $market->permalink));
        // Index document content
        $doc->addField(Zend_Search_Lucene_Field::UnStored('contents', $market->description));
        // Title
        $doc->addField(Zend_Search_Lucene_Field::Text('title', $market->title));
        // Phone
        $doc->addField(Zend_Search_Lucene_Field::Keyword('phone', $market->phone));
        // Fax
        $doc->addField(Zend_Search_Lucene_Field::Keyword('fax', $market->fax));
        // Street
        $doc->addField(Zend_Search_Lucene_Field::Keyword('street', $market->street));
        // City
        $doc->addField(Zend_Search_Lucene_Field::Keyword('city', $market->city));
        // State
        $doc->addField(Zend_Search_Lucene_Field::Keyword('state', $market->state));
        // Zip
        $doc->addField(Zend_Search_Lucene_Field::Keyword('zip', $market->zip));
        // Type
        $doc->addField(Zend_Search_Lucene_Field::UnIndexed('type', 'market'));

        // Store Document
        $index->addDocument($doc);
    } 
```

在我的搜索中，我这样做：

```
 $hits    = $index->find($q); 
```

这适用于简单的单词，但是当我想进行像“Sheba Foods”（包括引号）这样的搜索时，它会返回一个结果，但结果是错误的，甚至没有“Sheba”这个词。

我放弃了 MySQL 全文搜索，因为它存在明显的问题，并且无法在这方面取得任何进展。

我一直在看`Zend_Search_Lucene_Search_QueryParser::parse()`方法。答案就在这个方法里吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T23:01:56.760

我想到了。使用 Lucene，您可以添加一个名为“id”的字段，但从命中检索 id 会给您带来不同的结果——我猜这是整个搜索结果中搜索词的 id。

在这种情况下我必须做的是使用不同的字段名称，如下所示：

```
 // Id for retrieval
    $doc->addField(Zend_Search_Lucene_Field::UnIndexed('item_id', $market->id)); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-03-23T22:03:25.590

我过去使用过 MySQL 全文搜索，但它确实是 CPU 密集型的。

你总是可以依靠一个`SELECT * FROM table WHERE column = '%query%'`

# algorithm - 在树的节点上构建等价类的好数据结构是什么？

> ID：674837
> 
> 赞同：7
> 
> 时间：2009-03-23T19:17:20.123
> 
> 标签：algorithm, language-agnostic, data-structures, tree, equivalence-classes

我正在寻找一个好的数据结构来在树的节点上构建等价类。在理想的结构中，以下操作应该是快速的（O(1)/O(n)，视情况而定）并且容易（没有神秘代码段落）：

*   (A) 从根部走树；在每个节点上 --> 子转换枚举子节点的所有等效版本
*   (B) 合并两个等价类
*   (C) 从现有节点（子节点）和其他数据的列表中创建新节点
*   (D) 找到任何结构上与node 等价的节点（即它们有相同数量的子节点，对应的子节点属于同一个等价类，并且它们的“其他数据”相等），以便可以放入新的（或新修改的）节点在正确的等价类中（通过合并）

到目前为止，我已经考虑过（其中一些可以组合使用）：

*   冻糕，其中子代是对节点集合的引用，而不是对节点的引用。(A) 速度快，(B) 需要遍历树并更新节点以指向合并的集合，(C) 需要找到包含新节点的每个子节点的集合，(D) 需要遍历树
*   通过节点的特征维护节点的哈希。这使得 (D) 更快但 (B) 更慢（因为当等价类被合并时哈希必须被更新）
*   将节点串在一起形成一个循环链表。(A) 很快，(B) 会很快，但是事实上，将循环列表的一部分与自身“合并”实际上会拆分列表 (C) 会很快，(D) 需要遍历树
*   与上面类似，但在每个节点中都有一个额外的“向上”指针，可用于查找循环列表的规范成员。

我错过了一个甜蜜的选择吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T00:44:26.097

你似乎有两种形式的等价处理。普通等价（A），被跟踪为保持最新的等价类和结构等价（D），您偶尔会为此构建一个单一的等价类，然后将其丢弃。

在我看来，如果您为普通和结构等价维护等价类，那么问题在概念上会更简单。如果这为结构等价引入了过多的流失，您可以为结构等价的某些方面维护等价类。然后你可以找到一个平衡点，你可以负担得起这些等价类的维护，但在构建结构上等价的节点列表时仍然大大减少要检查的节点数量。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-23T20:40:51.920

我认为任何一种结构都无法解决您的问题，但您可以看看[Disjoint-set data structure](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)。毕竟，等价类与集合的划分是一回事。它应该能够快速处理其中一些操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-14T01:13:33.633

退后一步，我建议完全不要使用树。上次我不得不面对类似的问题时，我从一棵树开始，但后来又转向了一个数组。

原因很多，但第一个原因是性能，我的类有多达 100 个左右的孩子，实际上在将它们作为数组操作时比通过树的节点执行更好，主要是因为硬件局部性、CPU 预取逻辑和 CPU流水线。

因此，尽管从算法上讲，数组结构需要比树更多的操作 N，但执行这几十个操作可能比在内存中追逐指针更快。

# trie - Trie 实现问题

> ID：674844
> 
> 赞同：1
> 
> 时间：2009-03-23T19:19:02.117
> 
> 标签：trie

我正在为 VB.NET 中的预测文本输入实现一个 trie - 就 trie 的使用而言，基本上是自动完成。我已经使我的 trie 成为基于通用字典类的递归数据结构。

基本上是：

```
class WordTree Inherits Dictionary(of Char, WordTree) 
```

单词中的每个字母（全部大写）都用作新 WordTrie 的键。叶子上的空字符表示单词的终止。要找到以前缀开头的单词，我会一直走到我的前缀，然后收集所有子单词。

我的问题基本上是关于 trie 本身的实现。我正在使用字典哈希函数来分支我的树。我可以使用一个列表并对列表进行线性搜索，或者做其他事情。这里有什么流畅的动作？这是进行分支的合理方法吗？

谢谢。

更新：

只是为了澄清，我基本上是在问字典分支方法是否明显不如其他替代方法。我使用此数据结构的应用程序仅使用大写字母，因此数组方法可能是最好的。我可能会在未来更复杂的预输入情况（更多字符）中使用相同的数据结构。在这种情况下，听起来字典是正确的方法——直到我需要使用更复杂的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T19:26:31.257

如果只是 26 个字母，则作为 26 个条目的数组。然后查找是按索引。如果桶列表长于 26，它可能比字典使用更少的空间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T21:01:20.687

如果您担心空间，您可以在有效字节转换上使用位图压缩，假设 26char 限制。

```
class State  // could be struct or whatever
{
    int valid; // can handle 32 transitions -- each bit set is valid
    vector<State> transitions;

    State getNextState( int ch )
    {
         int index;
         int mask  = ( 1 << ( toupper( ch ) - 'A' )) -1;
         int bitsToCount = valid & mask;

         for( index = 0; bitsToCount ; bitsToCount  >>= 1)
         {
             index  += bitsToCount  & 1;
         }  
         transitions.at( index );
    }
}; 
```

还有其他方法可以进行位计数[这里](http://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetNaive)，向量中的索引是有效位集中设置位的数量。另一种选择是状态的直接索引数组；

```
class State
{
    State transitions[ 26 ]; // use the char as the index.

    State getNextState( int ch )
    {
        return transitions[ ch ];
    }
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-23T19:46:02.660

三元搜索树是一种在空间上高效并可能提供亚线性前缀查找的良好数据结构。[Peter Kankowski 有一篇关于它的*精彩*文章](http://www.strchr.com/ternary_dags)。他使用 C，但是一旦你理解了数据结构，它就是简单的代码。正如他所提到的，这是 ispell 用于拼写更正的结构。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T19:49:11.840

我已经用 8 位字符在 C 中完成了这个（trie 实现），并且简单地使用了数组版本（正如“26 字符”答案所暗示的那样）。

但是，我猜你想要完整的 unicode 支持（因为 .NET char 是 unicode 以及其他原因）。假设你必须支持 unicode，hash/map/dictionary 查找可能是你最好的选择，因为每个节点中的 64K 条目数组并不能很好地工作。

关于我能想到的唯一破解方法是将整个字符串（后缀或可能的“in-fixes”）存储在尚未分裂的分支上，具体取决于树的稀疏程度，呃，trie，是。但是，这增加了很多逻辑来检测多字符字符串，并在引入替代路径时将它们拆分。

什么是读取 vs 更新模式？

---- 2013 年 7 月更新 ---

如果 .NET 字符串具有类似 java 的函数来获取字符串的字节（如 UTF-8），那么在每个节点中都有一个数组来表示当前位置的字节值可能是一个不错的方法。您甚至可以使数组大小可变，在每个节点中使用第一个/最后一个边界指示符，因为许多节点无论如何都只有小写 ASCII 字母，或者在某些情况下只有大写字母或数字 0-9。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-29T19:38:03.613

我发现[Burst Trie](http://goanna.cs.rmit.edu.au/~jz/fulltext/acmtois02.pdf)非常节省空间。我在 Scala 中编写了自己的[突发 trie](https://github.com/nbauernfeind/scala-burst-trie)，它还重用了我在 GWT 的 trie 实现中发现的一些想法。我在 Stripe 的 Capture the Flag 竞赛中使用了它来解决一个具有少量 RAM 的多节点问题。

# java - 如何从 Web 表单中获取数据？

> ID：674851
> 
> 赞同：2
> 
> 时间：2009-03-23T19:20:19.273
> 
> 标签：java, submit, forms

作为一个宠物项目，我想构建一个从英语翻译成希伯来语的程序。我想要进行翻译的方式是使用一个名为[morfix](http://milon.morfix.co.il/)的网站。在这个网站上可以输入一个英文单词，然后按下“תרגום”（翻译）按钮，翻译就会出现。

我的第一选择是用 Java 编写这个程序，我尝试使用[htmlunit](http://htmlunit.sourceforge.net/)，但它不起作用，因为我猜该站点使用 AJAX 来带来结果。

我可以用什么语言实现提交 Web 表单的部分？如何将 Java 与其他语言集成？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T19:28:49.130

您需要一个 http 分析器来检查按下该按钮时发生的情况（尝试使用 Firefox 的 Live HTTp 标头）。然后，您可以使用任何语言发出 Web 请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:34:51.970

您也可以在不提交表单的情况下发送您的请求：`http://milon.morfix.co.il/?q=try`

# c# - 在 C# 中，什么是单子？

> ID：674855
> 
> 赞同：197
> 
> 时间：2009-03-23T19:20:29.210
> 
> 标签：c#, c#-3.0, lambda, monads

这些天有很多关于 monad 的讨论。我已经阅读了几篇文章/博客文章，但我不能通过他们的例子走得足够远来完全掌握这个概念。原因是 monad 是一个函数式语言概念，因此这些示例使用的是我没有使用过的语言（因为我没有深入使用函数式语言）。我不能深入地掌握语法以完全遵循这些文章......但我可以说那里有一些值得理解的东西。

但是，我非常了解 C#，包括 lambda 表达式和其他功能特性。我知道 C# 只有一个功能特性的子集，所以也许 monads 不能用 C# 表达。

但是，肯定可以传达这个概念吗？至少我希望如此。也许您可以提供一个 C# 示例作为基础，然后描述 C# 开发人员**希望**他能从那里做什么但由于该语言缺乏函数式编程特性而无法做到的事情。这将是很棒的，因为它会传达单子的意图和好处。所以这是我的问题：**对于 C# 3 开发人员，你能给 monad 最好的解释是什么？**

谢谢！

（编辑：顺便说一句，我知道SO上已经有至少3个“什么是monad”问题。但是，我面临同样的问题......所以这个问题是需要imo的，因为C#-developer重点。谢谢。）

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2009-03-23T21:15:36.313

你整天在编程中所做的大部分事情都是将一些函数组合在一起以从中构建更大的函数。通常，您的工具箱中不仅有函数，还有其他东西，如运算符、变量赋值等，但通常您的程序将大量“计算”组合到更大的计算中，这些计算将进一步组合在一起。

monad 是执行这种“计算组合”的某种方式。

通常，将两个计算组合在一起的最基本的“运算符”是`;`：

```
a; b 
```

当你这么说时，你的意思是“先做`a`，然后做`b`”。结果`a; b`基本上又是一个可以与更多东西组合在一起的计算。这是一个简单的 monad，它是一种将小计算组合到大计算的方法。俗话说`;`“先做左边的事，再做右边的事”。

在面向对象语言中可以被视为 monad 的另一件事是`.`. 通常你会发现这样的事情：

```
a.b().c().d() 
```

基本上意味着“评估左侧的`.`计算，然后根据结果调用右侧的方法”。这是将函数/计算组合在一起的另一种方式，比`;`. 将事物链接在一起的概念`.`是一个单子，因为它是将两个计算组合在一起以形成新计算的一种方式。

另一个相当常见的没有特殊语法的 monad 是这种模式：

```
rv = socket.bind(address, port);
if (rv == -1)
  return -1;

rv = socket.connect(...);
if (rv == -1)
  return -1;

rv = socket.send(...);
if (rv == -1)
  return -1; 
```

返回值 -1 表示失败，但没有真正的方法可以抽象出这种错误检查，即使您有很多 API 调用需要以这种方式组合。这基本上只是另一个按规则组合函数调用的 monad：“如果左边的函数返回 -1，则自己返回 -1，否则调用右边的函数”。如果我们有一个操作员`>>=`来做这件事，我们可以简单地写：

```
socket.bind(...) >>= socket.connect(...) >>= socket.send(...) 
```

它将使事情更具可读性，并有助于抽象出我们组合函数的特殊方式，这样我们就不需要一遍又一遍地重复自己。

还有更多的方法可以组合函数/计算，这些方法作为通用模式很有用，并且可以抽象到 monad 中，使 monad 的用户能够编写更简洁明了的代码，因为所有的簿记和管理使用的函数是在 monad 中完成的。

例如，上面`>>=`可以扩展为“进行错误检查，然后调用我们作为输入获得的套接字的右侧”，这样我们就不需要明确指定`socket`很多次：

```
new socket() >>= bind(...) >>= connect(...) >>= send(...); 
```

正式定义有点复杂，因为如果该函数需要该输入，并且您想确保组合的函数适合，您必须担心如何将一个函数的结果作为下一个函数的输入您尝试将它们组合到您的 monad 中的方式。但基本概念只是您将不同的方式形式化以将功能组合在一起。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2010-03-20T17:56:47.843

我发布这个问题已经一年了。发布后，我深入研究了 Haskell 几个月。我非常喜欢它，但是当我准备深入研究 Monads 时，我把它放在一边。我回去工作，专注于我的项目所需的技术。

昨晚，我来重读了这些回复。*最重要*的是，我重新阅读了上面有人[提到](https://stackoverflow.com/a/674876/578288)[的 Brian Beckman 视频](http://channel9.msdn.com/shows/Going%2BDeep/Brian-Beckman-Dont-fear-the-Monads/)的文本评论中[的特定 C# 示例](http://channel9.msdn.com/Shows/Going+Deep/Brian-Beckman-Dont-fear-the-Monads#c633313640460000000)。它是如此的清晰和有启发性，我决定直接在这里发布。

由于这个评论，我不仅觉得我*完全*理解 Monad 是什么……我意识到我实际上已经用 C# 编写了一些*Monad 的*东西……或者至少非常接近，并努力解决相同的问题。

**所以，这是评论——这都是[sylvan](http://channel9.msdn.com/Niners/sylvan)[这里评论](http://channel9.msdn.com/Shows/Going+Deep/Brian-Beckman-Dont-fear-the-Monads#c633313640460000000)的直接引用：**

> 这很酷。虽然有点抽象。我可以想象那些不知道单子是什么的人已经因为缺乏真实的例子而感到困惑。
> 
> 因此，让我尝试遵守，并且为了非常清楚，我将在 C# 中做一个示例，即使它看起来很丑。我将在最后添加等效的 Haskell 并向您展示很酷的 Haskell 语法糖，这是 IMO monad 真正开始变得有用的地方。
> 
> 好的，所以最简单的 Monad 之一在 Haskell 中被称为“Maybe monad”。在 C# 中，Maybe 类型称为`Nullable<T>`. 它基本上是一个很小的类，它只是封装了一个值的概念，该值要么是有效的并且有一个值，要么是“null”并且没有值。
> 
> 坚持在 monad 中组合这种类型的值的一个有用的东西是失败的概念。即，我们希望能够查看多个可为空的值，并`null`在其中任何一个为空时立即返回。例如，如果您在字典或其他东西中查找大量键，最后您想要处理所有结果并以某种方式组合它们，但如果任何键不在字典中，这可能很有用，你想`null`为整个事情回来。手动检查每个查找并返回会很乏味 `null`，因此我们可以将这种检查隐藏在绑定运算符中（这有点像 monads，我们将簿记隐藏在绑定运算符中，这使得代码更容易使用，因为我们可以忘记细节）。
> 
> 这是激发整个事情的程序（我稍后会定义 `Bind`，这只是为了向您展示为什么它很好）。
> 
> ```
>  class Program
>     {
>         static Nullable<int> f(){ return 4; }        
>         static Nullable<int> g(){ return 7; }
>         static Nullable<int> h(){ return 9; }
> 
>         static void Main(string[] args)
>         {
>             Nullable<int> z = 
>                         f().Bind( fval => 
>                             g().Bind( gval => 
>                                 h().Bind( hval =>
>                                     new Nullable<int>( fval + gval + hval ))));
> 
>             Console.WriteLine(
>                     "z = {0}", z.HasValue ? z.Value.ToString() : "null" );
>             Console.WriteLine("Press any key to continue...");
>             Console.ReadKey();
>         }
>     } 
> ```
> 
> 现在，暂时忽略在 C# 中已经支持执行此`Nullable`操作（您可以将可为空的整数添加在一起，如果其中一个为空，则为空）。让我们假设没有这样的功能，它只是一个用户定义的类，没有什么特殊的魔法。关键是我们可以使用该`Bind`函数将变量绑定到我们的`Nullable`值的内容，然后假装没有发生什么奇怪的事情，并像使用普通整数一样使用它们，然后将它们加在一起。我们将结果包装在最后的可空值中，并且该可空值将是空值（如果有的话`f`，`g`或者`h`返回空值）或者它将是求和的结果`f`，`g`和`h`一起。（这类似于我们如何将数据库中的行绑定到 LINQ 中的变量，并对其进行处理，知道`Bind`操作员将确保变量只会被传递有效的行值是安全的）。
> 
> 您可以使用它并更改任何`f`、`g`和`h`以返回 null，您将看到整个事情将返回 null。
> 
> 所以很明显，bind 操作符必须为我们做这个检查，如果遇到 null 值，则返回 null ，否则将结构内的值传递`Nullable`给 lambda。
> 
> 这是`Bind`运算符：
> 
> ```
> public static Nullable<B> Bind<A,B>( this Nullable<A> a, Func<A,Nullable<B>> f ) 
>     where B : struct 
>     where A : struct
> {
>     return a.HasValue ? f(a.Value) : null;
> } 
> ```
> 
> 这里的类型和视频中的一样。在这种情况下，它需要一个`M a` (`Nullable<A>`在 C# 语法中) 和一个函数 from `a`to `M b`(`Func<A, Nullable<B>>`在 C# 语法中)，它返回一个`M b` ( `Nullable<B>`)。
> 
> 代码只是检查可空值是否包含一个值，如果是，则提取它并将其传递给函数，否则它只返回空值。这意味着`Bind`操作员将为我们处理所有的空值检查逻辑。当且仅当我们调用的值 `Bind`不为空时，该值才会“传递”给 lambda 函数，否则我们会提前退出，整个表达式为空。这允许我们使用 monad 编写的代码完全没有这种 null 检查行为，我们只需使用`Bind`并获取一个绑定到 monadic 值（和示例代码中）内的值的变量，我们可以安全地使用`fval`它们 知道在传递它们之前会检查它们是否为空。`gval``hval``Bind`
> 
> 还有其他可以用 monad 做的事情的例子。例如，您可以让`Bind`操作员处理输入的字符流，并使用它来编写解析器组合器。然后，每个解析器组合器可以完全忘记诸如回溯、解析器故障等之类的事情，而只是将较小的解析器组合在一起，就好像事情永远不会出错一样，安全地知道一个聪明的实现会`Bind`整理出所有背后的逻辑困难的位。然后稍后可能有人将日志记录添加到 monad，但是使用 monad 的代码没有改变，因为所有的魔法都发生在`Bind`操作符的定义中，其余的代码没有改变。
> 
> 最后，这是 Haskell 中相同代码的实现（`--` 开始注释行）。
> 
> ```
> -- Here's the data type, it's either nothing, or "Just" a value
> -- this is in the standard library
> data Maybe a = Nothing | Just a
> 
> -- The bind operator for Nothing
> Nothing >>= f = Nothing
> -- The bind operator for Just x
> Just x >>= f = f x
> 
> -- the "unit", called "return"
> return = Just
> 
> -- The sample code using the lambda syntax
> -- that Brian showed
> z = f >>= ( \fval ->
>      g >>= ( \gval ->  
>      h >>= ( \hval -> return (fval+gval+hval ) ) ) )
> 
> -- The following is exactly the same as the three lines above
> z2 = do 
>    fval <- f
>    gval <- g
>    hval <- h
>    return (fval+gval+hval) 
> ```
> 
> 正如你所看到的`do`，最后的漂亮符号使它看起来像直接的命令式代码。事实上，这是设计使然。Monad 可用于封装命令式编程中所有有用的东西（可变状态、IO 等），并使用这种漂亮的命令式语法来使用，但在幕后，这一切都只是 monad 和绑定运算符的巧妙实现！`>>=`很酷的是，您可以通过实现和来实现自己的 monad `return`。如果你这样做了，这些 monad 也可以使用`do`符号，这意味着你基本上可以通过定义两个函数来编写自己的小语言！

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-23T19:25:31.477

monad 本质上是延迟处理。如果你试图用一种不允许它们并且只允许纯计算的语言编写具有副作用（例如 I/O）的代码，一个躲闪的方法是说，“好吧，我知道你不会做副作用对我来说，但你能计算一下如果你这样做会发生什么吗？”

这是一种欺骗。

现在，这个解释将帮助你理解 monad 的大局意图，但魔鬼在细节中。你究竟*是如何*计算后果的？有时，它并不漂亮。

概述某人习惯于命令式编程的最佳方式是说它把你放在一个 DSL 中，其中在语法上看起来像你习惯于 monad 之外的操作被用来构建一个可以做的函数如果您可以（例如）写入输出文件，您想要什么。几乎（但不是真的）就好像您正在构建一个字符串中的代码以便稍后进行评估。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T19:25:49.837

我相信其他用户会深入发布，但我发现[这个视频](http://channel9.msdn.com/shows/Going+Deep/Brian-Beckman-Dont-fear-the-Monads/)在一定程度上很有帮助，但我会说我仍然不能流利地理解这个概念，所以我可以（或应该）开始解决Monads 的直观问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T19:36:10.937

您可以将 monad 视为[类必须实现](http://higherlogics.blogspot.com/2008/01/almost-type-safe-general-monad-in-c-aka.html)[的 C#`interface`](http://higherlogics.blogspot.com/2008/01/almost-type-safe-general-monad-in-c-aka.html)。这是一个务实的答案，它忽略了为什么您要选择在界面中包含这些声明背后的所有类别理论数学，并忽略了您希望在一种试图避免副作用的语言中使用 monad 的所有原因，但我发现对于了解（C#）接口的人来说，这是一个好的开始。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-08T21:31:53.197

请参阅我对“什么是单子？”的[回答。](https://stackoverflow.com/a/28924364/972499)

它从一个激励性的例子开始，通过这个例子，推导出一个 monad 的例子，并正式定义“monad”。

它假定没有函数式编程知识，并且使用`function(argument) := expression`具有最简单表达式的语法的伪代码。

这个 C# 程序是伪代码 monad 的实现。（供参考：`M`是类型构造函数，`feed`是“绑定”操作，`wrap`是“返回”操作。）

```
using System.IO;
using System;

class Program
{
    public class M<A>
    {
        public A val;
        public string messages;
    }

    public static M<B> feed<A, B>(Func<A, M<B>> f, M<A> x)
    {
        M<B> m = f(x.val);
        m.messages = x.messages + m.messages;
        return m;
    }

    public static M<A> wrap<A>(A x)
    {
        M<A> m = new M<A>();
        m.val = x;
        m.messages = "";
        return m;
    }

    public class T {};
    public class U {};
    public class V {};

    public static M<U> g(V x)
    {
        M<U> m = new M<U>();
        m.messages = "called g.\n";
        return m;
    }

    public static M<T> f(U x)
    {
        M<T> m = new M<T>();
        m.messages = "called f.\n";
        return m;
    }

    static void Main()
    {
        V x = new V();
        M<T> m = feed<U, T>(f, feed(g, wrap<V>(x)));
        Console.Write(m.messages);
    }
} 
```

# c# - 我应该使用 AppDomain.CurrentDomain.BaseDirectory 还是 System.Environment.CurrentDirectory？

> ID：674857
> 
> 赞同：91
> 
> 时间：2009-03-23T19:20:51.520
> 
> 标签：c#, exception

我在同一个文件夹中有两个 exe 文件，我可以从 exe1 中的一个按钮运行 exe2。今天我正在通过远程（终端服务）会话观察客户，并且 exe2 未能运行“找不到文件”错误，但当我们检查时 exe1 在同一目录中。那么我应该使用[AppDomain.CurrentDomain.BaseDirectory](http://msdn.microsoft.com/en-us/library/system.appdomain.basedirectory.aspx)还是[System.Environment.CurrentDirectory](http://msdn.microsoft.com/en-us/library/system.environment.currentdirectory.aspx)？

谢谢

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2009-03-23T19:24:13.587

如果您想在与您的应用程序相同的目录中查找文件，`AppDomain.CurrentDomain.BaseDirectory`是正确的选择。

`Environment.CurrentDirectory`是一个可以并且将会在运行应用程序的过程中发生变化的值。例如，使用默认参数，WinForms 中的 OpenFileDialog 会将此值更改为从中选择文件的目录。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-03-23T19:24:52.057

`AppDomain.CurrentDomain.BaseDirectory`返回加载当前应用程序域的目录。
`System.Environment.CurrentDirectory`返回当前系统目录。
在你的情况下`AppDomain.CurrentDomain.BaseDirectory`是最好的解决方案。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-05-14T17:55:54.310

你应该使用`AppDomain.CurrentDomain.BaseDirectory`.

例如在 Windows 服务应用程序中：

`System.Environment.CurrentDirectory`将返回**C:\Windows\system32**

尽管

`AppDomain.CurrentDomain.BaseDirectory`将返回 [Application.exe 位置]

另一个需要注意的重要因素是它`AppDomain.CurrentDomain.BaseDirectory`是一个只读属性，而`Environment.CurrentDirectory`必要时可以是其他东西：

```
// Change the directory to AppDomain.CurrentDomain.BaseDirectory
Environment.CurrentDirectory = AppDomain.CurrentDomain.BaseDirectory; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-23T19:24:02.870

据我了解，您应该使用`BaseDirectory`. `CurrentDirectory`可能会在程序执行过程中发生变化。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-23T18:38:14.040

在 Visual Studio 2010 测试项目中，如果启用编辑测试设置的部署选项，则 AppDomain.CurrentDomain.BaseDirectory 指向 TestResults\Out 文件夹（不是 bin\debug）。虽然，默认设置指向 bin\debug 文件夹。

在这里，我找到了令人信服的答案。

[为什么 AppDomain.CurrentDomain.BaseDirectory 在 asp.net 应用程序中不包含“bin”？](https://stackoverflow.com/questions/8669833/why-appdomain-currentdomain-basedirectory-not-contains-bin-in-asp-net-app)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T19:24:28.220

我通常使用类似的东西：

```
 string AppPath = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase);
            AppPath = AppPath.Replace("file:\\", ""); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-09-02T12:16:51.380

我也经历了这几天，因为我正在使用

```
Environment.CurrentDirectory 
```

因为它在生产服务器上给了我问题，但在我的本地服务器上运行良好，

所以，我尝试了

```
System.AppDomain.CurrentDomain.BaseDirectory; 
```

它在环境中都对我有用。

所以，正如他们所有人所说的，我们应该始终与

```
System.AppDomain.CurrentDomain.BaseDirectory; 
```

因为它检查当前域目录的路径。

查看更多信息

[在服务器上找不到部分路径错误](https://stackoverflow.com/questions/39290793/could-not-find-a-part-of-path-error-on-server)

# .net - 受限用户的 ClickOnce 部署

> ID：674870
> 
> 赞同：1
> 
> 时间：2009-03-23T19:24:48.310
> 
> 标签：.net, visual-studio-2008, deployment, clickonce, publishing

从第一手经验来看，ClickOnce 似乎只为当前用户安装，并且没有为所有用户安装的选项。这是一个问题，因为公司内的一些用户需要使用 ClickOnce 应用程序，但没有安装应用程序的权限（出于安全原因）。

到目前为止，我们对这个问题的唯一解决方案是授予相关用户安装程序的权限，让他们安装 ClickOnce 程序，然后撤销他们的权限。似乎应该有更好的解决方案来解决这个问题。

有什么建议么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T19:32:11.523

ClickOnce 应该允许这些用户安装。这就是 ClickOnce 的重点：它允许受限用户安装您的应用程序。否则，您可以使用组策略分发一个 msi。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T19:39:46.403

您应该寻求基于 .MSI 的安装来执行此操作（Wise for windows installer、Install Shield 或使用 Visual Studio 内置的打包程序）。ClickOnce 旨在为当前用户安装并且仅为当前用户安装，因为文件存储在已安装用户的应用程序目录中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T19:36:24.913

也许我错了，但我认为 ClickOnce 对于您的用例来说不是一个好的解决方案。Clickonce 部署是一个公开您的应用程序的网站，如果需要，ClickOnce 将安装该应用程序的新版本。如果您的用户有权访问该站点，那么唯一可以阻止他的是您的应用程序请求的权限，或者您的清单的 asInvoker/requireAdministrator/highestAvailable 元素。

# c# - 谁处置 IDisposable 公共财产？

> ID：674879
> 
> 赞同：32
> 
> 时间：2009-03-23T19:26:12.473
> 
> 标签：c#, .net, dispose, idisposable

如果我有一个`SomeDisposableObject`实现的类`IDisposable`：

```
class SomeDisposableObject : IDisposable
{
    public void Dispose()
    {
        // Do some important disposal work.
    }
} 
```

我还有另一个名为 的类`AContainer`，它有一个`SomeDisposableObject`作为公共属性的实例：

```
class AContainer
{
    SomeDisposableObject m_someObject = new SomeDisposableObject();

    public SomeDisposableObject SomeObject
    {
        get { return m_someObject; }
        set { m_someObject = value; }
    }
} 
```

然后FxCop会坚持说`AContainer`也是造的`IDisposable`。

这很好，但我看不到如何安全地调用`m_someObject.Dispose()`from `AContainer.Dispose()`，因为另一个类可能仍然有对该`m_someObject`实例的引用。

避免这种情况的最佳方法是什么？

（假设其他代码依赖于`AContainer.SomeObject`始终具有非空值，因此简单地将实例的创建移到外部`AContainer`不是一种选择）

**编辑**：我将用一些例子进行扩展，因为我认为一些评论者错过了这个问题。如果我只是实现一个调用 m_someObject.Dispose() 的方法，那么我会遇到以下情况`Dispose()`：`AContainer`

```
// Example One
AContainer container1 = new AContainer();
SomeDisposableObject obj1 = container1.SomeObject;
container1.Dispose();
obj1.DoSomething(); // BAD because obj1 has been disposed by container1.

// Example Two
AContainer container2 = new AContainer();
SomeObject obj2 = new SomeObject();
container2.SomeObject = obj2; // BAD because the previous value of SomeObject not disposed.
container2.Dispose();
obj2.DoSomething(); // BAD because obj2 has been disposed by container2, which doesn't really "own" it anyway. 
```

这有帮助吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-03-23T20:31:42.223

没有单一的答案，这取决于您的情况，关键是财产所代表的一次性资源的所有权，正如[Jon Skeet 指出的那样](https://stackoverflow.com/questions/674879/who-disposes-of-an-idisposable-public-property/674896#674896)。

查看 .NET Framework 中的示例有时会有所帮助。以下是三个表现不同的示例：

*   **容器总是配置**。System.IO.StreamReader 公开了一个一次性属性 BaseStream。它被认为拥有底层流，并且处置 StreamReader 总是处置底层流。

*   **容器从不丢弃**。System.DirectoryServices.DirectoryEntry 公开一个 Parent 属性。它不被认为拥有其父级，因此处置 DirectoryEntry 永远不会处置其父级。

    在这种情况下，每次取消引用 Parent 属性时都会返回一个新的 DirectoryEntry 实例，并且调用者可能会释放它。可以说这违反了属性的准则，也许应该有一个 GetParent() 方法。

*   **容器有时会配置**。System.Data.SqlClient.SqlDataReader 公开了一个一次性的 Connection 属性，但调用者使用 SqlCommand.ExecuteReader 的 CommandBehavior 参数决定读取器是否拥有（并因此处置）基础连接。

另一个有趣的例子是 System.DirectoryServices.DirectorySearcher，它有一个可读写的一次性属性 SearchRoot。如果此属性是从外部设置的，则假定底层资源不被拥有，因此不会被容器处置。如果它不是从外部设置的，则会在内部生成一个引用，并设置一个标志以确保它会被释放。您可以使用 Lutz Reflector 看到这一点。

您需要确定您的容器是否拥有该资源，并确保准确记录其行为。

如果您确实决定拥有该资源，并且该属性是读/写的，则需要确保您的 setter 处理它正在替换的任何引用，例如：

```
public SomeDisposableObject SomeObject    
{        
    get { return m_someObject; }        
    set 
    { 
        if ((m_someObject != null) && 
            (!object.ReferenceEquals(m_someObject, value))
        {
            m_someObject.Dispose();
        }
        m_someObject = value; 
    }    
}
private SomeDisposableObject m_someObject; 
```

**更新**：GrahamS 在评论中正确指出，最好在处理之前在 setter 中测试 m_someObject != 值：我已经更新了上面的示例以考虑到这一点（使用 ReferenceEquals 而不是 != 是明确的）。尽管在许多实际场景中，setter 的存在可能意味着该对象不属于容器，因此不会被释放。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-23T19:32:45.610

这实际上取决于谁在概念上“拥有”一次性物品。在某些情况下，您可能希望能够传入对象，例如在构造函数中，而不需要您的类负责清理它。其他时候你可能想自己清理它。如果您正在创建对象（如在您的示例代码中），那么清理它几乎肯定是您的责任。

至于房产——我认为拥有房产不应该真正转让所有权或类似的东西。如果你的类型负责处理对象，它应该保持这个责任。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-23T19:57:01.293

真正的问题可能是您的面向对象设计。如果 AContainer 是 Disposed，那么它的所有成员对象也应该被释放。如果不是，听起来你可以处理一个身体，但想让腿实例保持活力。听起来不对。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-23T19:27:48.413

如果您的类上有一个一次性对象，您可以使用处理包装的一次性用品`IDisposable`的方法来实现。`Dispose`现在调用代码必须确保使用它或处理对象`using()`的等效`try`/代码。`finally`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-24T12:03:17.537

我将尝试回答我自己的问题：

## 首先避免它

摆脱这种情况的最简单方法是重构代码以完全避免该问题。
有两种明显的方法可以做到这一点。

**外部实例创建**
如果`AContainer`不创建`SomeDisposableObject`实例，而是依赖外部代码来提供它，那么`AContainer`将不再“拥有”该实例并且不负责处置它。

可以通过构造函数或设置属性来提供外部创建的实例。

```
public class AContainerClass
{
    SomeDisposableObject m_someObject; // No creation here.

    public AContainerClass(SomeDisposableObject someObject)
    {
        m_someObject = someObject;
    }

    public SomeDisposableObject SomeObject
    {
        get { return m_someObject; }
        set { m_someObject = value; }
    }
} 
```

**保持实例私有**
发布代码的主要问题是所有权混淆。在 Dispose 时，`AContainer`该类无法分辨谁拥有该实例。它可能是它创建的实例，也可能是`set`通过属性在外部创建的其他实例。

即使它跟踪它并确定它正在处理它创建的实例，它仍然无法*安全地*处理它，因为其他类现在可能具有它们从公共属性获得的对它的引用。

如果可以重构代码以避免使实例公开（即完全删除属性），那么问题就消失了。

## 如果无法避免...

如果由于某种原因无法以这些方式重构代码（正如我在问题中规定的那样），那么在我看来，您将面临一些相当困难的设计选择。

**始终处置实例**
如果您选择这种方法，那么您实际上是在声明`AContainer`将`SomeDisposableObject`在设置属性时获得实例的所有权。

这在某些情况下是有意义的，尤其是在`SomeDisposableObject`明显是瞬态或从属对象的情况下。但是，应该仔细记录它，因为它要求调用代码知道这种所有权转移。

（使用方法而不是属性可能更合适，因为方法名称可用于提供有关所有权的进一步提示）。

```
public class AContainerClass: IDisposable
{
    SomeDisposableObject m_someObject = new SomeDisposableObject();

    public SomeDisposableObject SomeObject
    {
        get { return m_someObject; }
        set 
        {
            if (m_someObject != null && m_someObject != value)
                m_someObject.Dispose();

            m_someObject = value;
        }
    }

    public void Dispose()
    {
        if (m_someObject != null)
            m_someObject.Dispose();

        GC.SuppressFinalize(this);
    }
} 
```

**仅在仍然是原始实例时才处置**
在这种方法中，您将跟踪实例是否从最初创建的实例发生更改，`AContainer`并且仅在它是原始实例时才处置它。这里的所有权模式是混合的。`AContainer`仍然是其自己`SomeDisposableObject`实例的所有者，但如果提供了外部实例，则外部代码仍有责任处理它。

这种方法最能反映这里的实际情况，但可能难以正确实施。客户端代码仍然可以通过执行如下操作导致问题：

```
AContainerClass aContainer = new AContainerClass();
SomeDisposableObject originalInstance = aContainer.SomeObject;
aContainer.SomeObject = new SomeDisposableObject();
aContainer.DoSomething();
aContainer.SomeObject = originalInstance; 
```

这里换入了一个新实例，调用了一个方法，然后恢复了原始实例。不幸的是，当它被替换时，`AContainer`将调用`Dispose()`原始实例，因此它现在无效。

**干脆放弃，让GC来处理**
这显然不太理想。如果`SomeDisposableObject`该类确实包含一些稀缺资源，那么不及时处理它肯定会给您带来问题。

然而，就客户端代码如何交互而言，它也可能代表最稳健的方法，`AContainer`因为它不需要关于如何处理实例`AContainer`所有权的特殊知识。`SomeDisposableObject`

如果您知道系统上的一次性资源实际上并不稀缺，那么这实际上可能是最好的方法。

* * *

一些评论者建议可以使用引用计数来跟踪是否有任何其他类仍然具有对该`SomeDisposableObject`实例的引用。这将非常有用，因为它允许我们仅在我们知道这样做是安全的时候才处理它，否则就让 GC 处理它。

但是我不知道任何用于确定对象引用计数的 C#/.NET API。如果有，请告诉我。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-23T20:21:45.787

您不能安全地调用`Dispose()`的`AContainer`实例的`SomeDisposableObject`原因是缺乏封装。公共财产提供对部分内部状态的无限制访问。由于这部分内部状态必须遵守 IDisposable 协议的规则，因此确保良好封装非常重要。

该问题类似于允许访问用于锁定的实例。如果你这样做，就很难确定在哪里获取锁。

如果您可以避免暴露您的一次性实例，那么谁将处理呼叫的问题也会`Dispose()`消失。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-24T12:22:19.927

我遇到的一件有趣的事情是 SqlCommand 通常拥有一个 SqlConnection（两者都实现 IDisposable）实例。但是，在 SqlCommand 上调用 dispose 也**不会**释放连接。

[我在这里](https://stackoverflow.com/questions/60919/is-sqlcommand-dispose-enough)也借助 Stackoverflow 发现了这一点。

因此，换句话说，“子”（嵌套？）实例是否可以/将在以后重用很重要。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-23T20:24:25.547

总的来说，我认为创建对象的人应该对 Disposal 负责。在这种情况下，AContainer 会创建 SomeDisposableObject，所以它应该在 AContainer 存在的时候被 Disposed。

如果由于某种原因，您认为 SomeDisposableObject 应该比 AContainer 寿命更长 - 我只能想到以下方法：

*   将 SomeDisposableObject 保留为 unDisposed，在这种情况下，GC 将为您处理它
*   为 SomeDisposableObject 提供对 AContainer 的引用（请参阅 WinForms 控件和父属性）。只要 SomeDisposableObject 是可访问的，AContainer 也是如此。这将阻止 GC 处理 AContainer，但如果有人手动调用 Dispose - 好吧，你会处理 SomeDisposableObject。我会说这是意料之中的。
*   将 SomeDisposableObject 实现为方法，例如 CreateSomeDisposableObject()。这清楚（呃）客户负责处置。

不过，总而言之——我不太确定这个设计是否有意义。毕竟，您似乎期望客户端代码如下：

```
SomeDisposableObject d;
using (var c = new AContainer()) {
   d = c.SomeObject;
}
// do something with d 
```

对我来说，这似乎是损坏的客户端代码。这违反了得墨忒耳法则，对我来说也是常识。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-23T22:32:56.487

您在这里提到的设计不是可以处理这种情况的。您说该类有一个容器，然后它应该将其与自身一起处理。如果其他对象可能正在使用它，那么它不是容器，您的类的范围会扩大，它需要在该范围的边界处进行处理。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-03-23T19:30:31.900

您可以在 Dispose() 中标记 Disposal。毕竟 Disposal 不是析构函数 - 该对象仍然存在。

所以：

```
class AContainer : IDisposable
{
    bool _isDisposed=false;

    public void Dispose()
    {
        if (!_isDisposed) 
        {
           // dispose
        }
        _isDisposed=true;
    }
} 
```

将此添加到您的其他课程中。

# java - 动作监听器问题

> ID：674883
> 
> 赞同：1
> 
> 时间：2009-03-23T19:27:12.563
> 
> 标签：java, swing

我的 actionListener 有问题。似乎在我单击按钮之前 actionListener 会自动运行？在单击按钮之前，“这不应该出现在控制台中”在我单击按钮之前出现在控制台中“......这很奇怪。

```
.... 
button1.addActionListener(this); 
button2.addActionListener(this);
....
public void actionPerformed(ActionEvent e) {

   System.out.println("This should not appear in the console before button click");

   if (e.getSource()==button1)
      System.out.println ("answer1");

   else if (e.getSource()==button2)
      System.out.println ("answer2");
   .....
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-23T19:42:00.250

您可以通过调用来判断从哪里调用方法`Thread.dumpStack()`。这会将堆栈跟踪打印到错误流（可能是 Java 控制台）。或者使用调试器并在方法的第一行放置一个断点。

```
public void actionPerformed(ActionEvent e) {
   Thread.duumpStack();
   System.out.println("This should not appear in the console before button click");
   ... 
```

顺便说一句：我建议不要使用`EventObject.getSource`. 而是为每个操作添加一个新的侦听器。

因此，您的示例代码将变为：

```
button1.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent event) {
        System.out.println("answer1");
    } 
});
button2.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent event) {
        System.out.println("answer2");
    } 
}); 
```

不幸的是，与匿名内部类相关的样板文件显然很冗长，但意图更清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-30T15:07:02.743

还要确保在单击任一按钮之前，您没有将“this”作为 ActionListener 添加到可能使用的任何其他组件中。您还可以在代码中搜索 doClick() 调用，以确保您不会以编程方式调用它。

# html - th 标签中的 Scope 属性 - 它什么时候停止？

> ID：674889
> 
> 赞同：0
> 
> 时间：2009-03-23T19:29:35.460
> 
> 标签：html

设想：

*   有两个 tbody 的表
*   第一个 tbody 有一个 th 应用了 scope="col" 。
*   首先 tbody 关闭。
*   第二个 tbody 打开 - 它也有一个 th - 这也需要一个 scope="col" 应用。
*   假设为了争论，th 在同一列中。

问题：第一个作用域在到达第二个 tbody 时会停止吗？下一个范围？还是完全停止？

如果您有任何教程或见解，我会全力以赴。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T19:52:04.207

好吧，我没试过，但是[HTML4规范](http://www.w3.org/TR/html4/struct/tables.html#adef-scope)中的各种范围描述都有“当前单元格为包含它的其余[type]提供标题信息”的格式，其中[type]是范围属性。

因此，听起来它将适用于整个表格，而不仅仅是每个 tbody 部分。

顺便说一句，因为它说的是“其余的”，它也暗示具有相同范围的另一个单元格将成为其后任何单元格的新标题。

# java - Java：在套接字上重新连接有时会出错

> ID：674892
> 
> 赞同：0
> 
> 时间：2009-03-23T19:30:35.707
> 
> 标签：java, client, socketexception, reconnect

我正在制作原型客户端和服务器，以便了解如何处理重新连接。服务器应该创建一个 serversocket 并永远监听。客户端可以连接、发送其数据并关闭其套接字，但它不会向服务器发送“我完成并关闭”类型的消息。出于这个原因，由于远程客户端已经关闭，服务器在执行 a`EOFException`时会得到 a。`readByte()`在 的错误处理程序中`EOFException`，它将关闭套接字并打开一个新套接字。

这就是问题所在：即使在成功打开套接字/输入流/输出流之后，客户端有时也会`SocketWriteError`在调用时得到一个。`outputStream.write()`这可能与我打开和关闭这些套接字的频率有关。一件有趣的事情是客户端在退出之前会执行任意数量的写入/关闭/重新连接。有时会在第一次重新连接时出错，有时需要 50 次重新连接才能看到`SocketWriteError`.

这是客户端的错误：

```
java.net.SocketException：对等方重置连接：套接字写入错误
       在 java.net.SocketOutputStream.socketWrite0（本机方法）
       在 java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
       在 java.net.SocketOutputStream.write(SocketOutputStream.java:115)
       在 bytebuffertest.Client.main(Client.java:37)

```

以下是一些代码片段：

服务器：

```
public static void main(String[] args)
{
    Server x = new Server();
    x.initialize();
}

private void initialize()
{
    ServerSocket s;
    InputStream is;
    DataInputStream dis;
    while (true) //ADDED THIS!!!!!!!!!!!!!!!!!!!!!!
    {
        try
        {
            s = new ServerSocket(4448);
            s.setSoTimeout(0);
            s.setReuseAddress(true);
            is = s.accept().getInputStream();
            System.out.println("accepted client");
            dis = new DataInputStream(is);
            try
            {

                byte input = dis.readByte();
                System.out.println("read: " + input);
            } catch (Exception ex)
            {
                System.out.println("Exception");
                dis.close();
                is.close();
                s.close();
            }
        } catch (IOException ex)
        {
            System.out.println("ioexception");
        }
    }
} 
```

客户：

```
public static void main(String[] args)
{
    Socket s;
    OutputStream os;
    try
    {
        s = new Socket("localhost", 4448);
        s.setKeepAlive(true);
        s.setReuseAddress(true);
        os = s.getOutputStream();
        int counter = 0;
        while (true)
        {
            try
            {
                os.write((byte) counter++);
                os.flush();

                os.close();
                s.close();

                s = new Socket("localhost", 4448);
                s.setKeepAlive(true);
                s.setReuseAddress(true);
                os = s.getOutputStream();
            } catch (Exception e)
            {
                e.printStackTrace();
                System.err.println("ERROR: reconnecting...");
            }
        }
    } catch (Exception ex)
    {
        ex.printStackTrace();
        System.err.println("ERROR: could not connect");
    }
} 
```

有谁知道如何正确重新连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T19:34:51.610

不要在出现错误时关闭 ServerSocket，只需 .accept() 一个新连接。

我通常做的是每次 ServerSocket.accept() 返回一个 Socket 时，我都会产生一个线程来处理来自该 Socket 的发送和接收。这样，一旦有人想连接到您，您就可以开始接受新连接。

# regex - Perl 正则表达式用新行拆分

> ID：674897
> 
> 赞同：3
> 
> 时间：2009-03-23T19:32:48.027
> 
> 标签：regex, perl, split

我是 Perl 的新手，正在为学校做一个项目，但我被困住了。

输入：一个给定的文本文件，包含由空格、制表符、“、”、“;”分隔的电子邮件地址 或“:” [可以在不同的行上]。

我正在尝试读取电子邮件地址并将它们放入一个数组中。我可以在一行上解析数据，但是如果有换行符或返回，我只会得到最后一个元素。

有人可以帮我弄清楚如何将每个地址放在单独的行上并解析它们吗？我已经阅读了一些关于正则表达式的内容，但需要更多的练习。谢谢。

```
open(EmailAddresses, "EmailAdressesCommaList.txt") || die "Can not open file $!";

# 
while (<EmailAddresses>)
{
    chomp;
    # Split the line into words
    @lines = split /[ ,;:\t\r\n(\t\r\n\s)+?]/;
}

foreach $value (@lines)
{
    print $value . "\n";
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-23T19:35:17.570

```
open(EmailAddresses, "EmailAdressesCommaList.txt") || die "Can not open file $!";
while(<EmailAddresses>) {
    chomp;
    push @lines, split /[ ,;:\t\r\n(\t\r\n\s)+?]/;
}
foreach $value (@lines) {
    print $value . "\n";
} 
```

即问题不在于您的正则表达式，而在于您每次通过循环都覆盖@lines。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-24T10:54:23.553

Chaos is correct. If you are going to open the text file and process it again in the same program remember to clear the array.

```
@lines = (); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-23T22:35:41.427

正如混乱所指出的，您应该推入数组，而不是覆盖它，但是您的正则表达式也很奇怪。看来你想做：

```
/[ ,;:\t\r\n][\t\r\n\s]+/ 
```

但是，我认为这也可以：

```
/[,;:\s]+/ 
```

# .net - .Net 在哪里获得 D

> ID：674900
> 
> 赞同：4
> 
> 时间：2009-03-23T19:33:09.150
> 
> 标签：.net, d

我在哪里可以获得 .Net 框架的 D？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T19:35:07.787

（大量编辑。）

假设您[的意思是 D 编程语言](http://en.wikipedia.org/wiki/D_programming_language)，您目前不能这样做。当前发布的 D 编译器编译为本机代码，而不是托管代码。一个端口正在进行中，[最近的 InfoQ 采访](http://www.infoq.com/news/2009/03/D-NET)可能对更多信息感兴趣。

[这个现有的问题](https://stackoverflow.com/questions/539234/using-d-programming-language-in-a-net-context)有其他信息和链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:35:06.023

你指的是这个吗？

[D.Net 发布版本 1.0.0。](http://ddotnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=6306#ReleaseFiles)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-24T20:58:45.473

.NET有一个[D 编译器](http://dnet.codeplex.com/)。它出现在这个问题之后，所以 Jon Skeet 并没有错。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-02T01:50:10.497

我目前正在开发一个 D .net 编译器实现，它还没有准备好公开发布，并且它不支持第一个版本中的 Phobos 和 Tango 库（只是核心语言）。

# c# - 附加到 asp.net 母版页中的默认标题

> ID：674902
> 
> 赞同：4
> 
> 时间：2009-03-23T19:33:29.897
> 
> 标签：c#, asp.net, asp.net-mvc

我正在使用 MVC 向带有内容占位符的母版页添加标题。默认 MVC 母版页模板使用以下代码：

```
<head runat="server">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title><asp:ContentPlaceHolder ID="TitleContent" runat="server"/></title>
<link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
</head> 
```

当我尝试将默认文本添加到内容持有者的前面时，它不会在最终呈现的页面中显示文本。我试图让页面显示带有附加内容占位符文本的默认标题。

示例：（
默认文本）（ContentPlaceHolder 文本）
我的页面 - 关于我们

```
<head runat="server">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>My Page - <asp:ContentPlaceHolder ID="TitleContent" runat="server"/></title>
<link href="../../Content/Site.css" rel="stylesheet" type="text/css" />
</head> 
```

我正在寻找一种方法来实现这一点，而不必使用后面的代码。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-21T13:08:40.733

看来我们应该使用

```
<asp:Literal runat="server" Text=" - MySite" /> 
```

代替

```
<asp:LiteralControl runat="server" Text=" - MySite" /> 
```

文章中提到，否则我们会得到“未知的服务器标签”错误。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-06T19:09:28.463

在进一步查看之后，Phil Haack 实际上发布了一篇文章，它是我问题的解决方案。它可以在[Haacked](http://haacked.com/archive/2009/04/03/tipjar-title-tags-and-master-pages.aspx)找到。

总而言之，他说在头部呈现的所有内容都呈现为控件，我上面的问题的解决方法是在标题中放置一个 asp 文字控件以使其正确生成文本。

```
<%@ Master ... %>
<html>
<head runat="server">
  <title>
    <asp:ContentPlaceHolder ID="titleContent" runat="server" /> 
    <asp:LiteralControl runat="server" Text=" - MySite" />
  </title>
</head>
... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-20T05:21:20.963

为什么？

```
<title>
    <asp:ContentPlaceHolder ID="titleContent" runat="server" />
    <%= "- My Site" %>
</title> 
```

效果也一样。没有麻烦？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-17T00:50:56.180

我更喜欢使用这个：

```
<title>Site Name - <%=Page.Title%></title> 
```

比使用文字控制要干净得多..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-23T19:39:35.280

如果您使用 MVC 并将某些对象中的标题从控制器传递到页面，我将使用内联代码来显示它。

我们使用 MVC contrib 函数直接从母版页中的视图数据中获取类型化数据，因此：

```
<head>
<title>My Page - <%= ViewData.Get<Model.Page>().Title %></title>
</head> 
```

需要注意的是，我们已经从每个视图中删除了所有代码隐藏文件，我们必须使视图更清晰，我们发现这比为每个视图都隐藏代码要好得多。

# java - 在 Windows 上通过命令行设置 JVM

> ID：674903
> 
> 赞同：25
> 
> 时间：2009-03-23T19:33:36.807
> 
> 标签：java, windows, command-line, jvm

调用 "java jar jar_name.jar" 时是否可以指定要使用的 JVM。我的机器上安装了两个 JVM。我无法更改 JAVA_HOME，因为它可能会破坏所有准备好运行的代码。

亲切的问候

斯蒂芬

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-03-23T19:41:20.627

是的 - 只需明确提供 java.exe 的路径。例如：

```
c:\Users\Jon\Test>"c:\Program Files\java\jdk1.6.0_03\bin\java.exe" -version
java version "1.6.0_03"
Java(TM) SE Runtime Environment (build 1.6.0_03-b05)
Java HotSpot(TM) Client VM (build 1.6.0_03-b05, mixed mode, sharing)

c:\Users\Jon\Test>"c:\Program Files\java\jdk1.6.0_12\bin\java.exe" -version
java version "1.6.0_12"
Java(TM) SE Runtime Environment (build 1.6.0_12-b04)
Java HotSpot(TM) Client VM (build 11.2-b01, mixed mode, sharing) 
```

对正在运行的命令 shell 执行此操作的最简单方法是：

```
set PATH=c:\Program Files\Java\jdk1.6.0_03\bin;%PATH% 
```

例如，这是一个完整的会话，显示了我的默认 JVM，然后是路径的更改，然后是新的：

```
c:\Users\Jon\Test>java -version
java version "1.6.0_12"
Java(TM) SE Runtime Environment (build 1.6.0_12-b04)
Java HotSpot(TM) Client VM (build 11.2-b01, mixed mode, sharing)

c:\Users\Jon\Test>set PATH=c:\Program Files\Java\jdk1.6.0_03\bin;%PATH%

c:\Users\Jon\Test>java -version
java version "1.6.0_03"
Java(TM) SE Runtime Environment (build 1.6.0_03-b05)
Java HotSpot(TM) Client VM (build 1.6.0_03-b05, mixed mode, sharing) 
```

这不会改变显式使用 JAVA_HOME 的程序。

请注意，如果您在路径中找到错误的目录（包括不存在的目录），您将不会收到任何错误，它实际上会被忽略。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-23T19:42:29.720

您应该可以通过命令行参数执行此操作，假设这些是使用通常的 Windows InstallShield 机制安装的 Sun VM，并带有*system32*中的 JVM finder EXE 。

键入*java -help*选项。特别是，请参阅：

```
-version:<value>
              require the specified version to run
-jre-restrict-search | -jre-no-restrict-search
              include/exclude user private JREs in the version search 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-21T10:22:31.100

是的，我经常需要安装 3 个或更多的 JVM。例如，我注意到有时 JRE 与 JRE 的 JDK 版本略有不同。

我在 Windows 上进行一些“打包”的解决方案是这样的：

```
@echo off
setlocal
@rem  _________________________
@rem
@set  JAVA_HOME=b:\lang\java\jdk\v1.6\u45\x64\jre
@rem
@set  JAVA_EXE=%JAVA_HOME%\bin\java
@set  VER=test
@set  WRK=%~d0%~p0%VER%
@rem
@pushd %WRK%
cd 
@echo.
@echo  %JAVA_EXE%  -jar %WRK%\openmrs-standalone.jar
       %JAVA_EXE%  -jar %WRK%\openmrs-standalone.jar 
@rem
@rem  _________________________
popd
endlocal
@exit /b 
```

我认为这很简单。主要的是 setlocal 和 endlocal 为您的应用程序提供了一个“个人环境”，无论它做什么——即使还有其他程序要运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-09T15:43:29.763

如果您有 2 个 JVM 安装。将版本放在前面。Linux：导出 PATH=/usr/lib/jvm/java-8-oracle/bin:$PATH

这消除了歧义。

# hash - 加盐密码：最佳实践？

> ID：674904
> 
> 赞同：163
> 
> 时间：2009-03-23T19:33:50.863
> 
> 标签：hash, cryptography, passwords, salt

我一直很好奇......在为哈希加密密码时哪个更好：前缀还是后缀？为什么？或者，只要你加盐，这有关系吗？

解释一下：我们现在（希望）都知道，我们应该在对密码进行哈希处理以存储在数据库中之前对密码进行[加盐[](http://en.wikipedia.org/wiki/Salt_(cryptography))**编辑：**这样你就可以避免像[最近发生在 Jeff Atwood 身上的事情](http://blog.codinghorror.com/i-just-logged-in-as-you-how-it-happened/)]。通常这是通过在将盐传递给散列算法之前将盐与密码连接起来来完成的。但例子各不相同......一些例子在密码前加上盐。一些示例在密码*后添加盐。*我什至见过一些人试图把盐放在中间。

那么哪种方法更好，为什么？有没有一种方法可以减少哈希冲突的机会？我的谷歌搜索还没有对这个主题进行像样的分析。

**编辑：**很好的答案伙计们！对不起，我只能选择一个答案。:)

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2009-03-23T19:39:35.170

前缀或后缀无关紧要，它只是为密码添加一些熵和长度。

你应该考虑这三件事：

1.  对于您存储的每个密码，盐必须不同。（这是一个很常见的误解。）
2.  使用加密安全的随机数生成器。
3.  选择足够长的盐。想想生日问题。

[Dave Sherohman](https://stackoverflow.com/questions/536584/non-random-salt-for-password-hashes/536756#536756)对另一个问题有一个很好的回答，为什么你应该使用随机生成的盐而不是用户名（或其他个人数据）。如果您遵循这些建议，那么您将盐放在哪里并不重要。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-03-23T19:41:25.683

我认为这都是语义。将其放在之前或之后并不重要，除非针对的是非常具体的威胁模型。

它在那里的事实应该会击败彩虹桌。

我提到的威胁模型将是攻击*者可以*将彩虹表附加/附加到密码的情况。（比如美国国家安全局）你猜他们要么附加了它，要么附加了它，但不是两者兼而有之。这很愚蠢，而且是一个糟糕的猜测。

最好假设他们有能力存储这些彩虹表，但不能存储密码中间散布着奇怪盐的表。在*那种*狭隘的情况下，我猜想穿插是最好的。

就像我说的。是语义。为每个密码选择一个不同的盐，一个长盐，并在其中包含奇数字符，如符号和 ASCII 码：©¤¡

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-07-05T21:33:02.323

似乎没有人提到的真正答案是[两者都是错误的](http://benlog.com/articles/2008/06/19/dont-hash-secrets/)。如果您正在实施自己的加密，无论您认为自己在做什么微不足道的部分，您*都会*犯错误。

[HMAC](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)是一种更好的方法，但即便如此，即使您使用的是 SHA-1 之类的东西，您也已经选择了一种不适合密码散列的算法，因为它的设计是为了速度。使用像[bcrypt](http://en.wikipedia.org/wiki/Bcrypt)或可能的[scrypt](http://www.tarsnap.com/scrypt.html)之类的东西，完全摆脱你的问题。

哦，甚至不要考虑将生成的哈希值与您的编程语言或数据库字符串比较实用程序进行比较。那些比较字符和短路的字符就`false`好像字符不同一样。所以现在攻击者可以使用统计方法来尝试计算哈希是什么，一次一个字符。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-23T19:37:36.610

它不应该有任何区别。无论你把盐放在哪里，哈希都不会更容易被猜到。由于故意非线性，哈希冲突既罕见又不可预测。如果它对安全性产生影响，则表明散列存在问题，而不是加盐问题。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-23T20:55:27.720

如果使用加密安全散列，无论您是前置还是后缀都无关紧要；散列的一点是源数据中的单个位更改（无论在哪里）都应该产生不同的散列。

不过，重要的**是**使用长盐，使用适当的加密 PRNG 生成它们，并拥有每个用户的盐。在数据库中存储每个用户的盐*不是*安全问题，使用站点范围的哈希**是**.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-24T00:16:31.510

首先，“彩虹表”一词一直被误用。“彩虹”表只是一种特定*类型*的查找表，它允许对键进行特定类型的数据压缩。通过用计算换取空间，可以将占用 1000 TB 的查找表压缩一千倍，以便将其存储在更小的驱动器上。

您应该担心哈希到密码查找表、彩虹或其他方式。

@onebyone.livejournal.com：

> 攻击者的“彩虹表”不是由字典单词的哈希组成，而是在完成哈希计算之前的哈希计算状态。
> 
> 然后，使用后缀 salt 暴力破解密码文件条目可能比前缀 salt 更便宜：依次为每个字典单词加载状态，将 salt 字节添加到哈希中，然后完成它。使用前缀盐，每个字典单词的计算之间没有任何共同点。

对于线性扫描输入字符串的简单哈希函数，例如简单的线性同余生成器，这是一种实用的攻击。但是一个加密安全的散列函数被故意设计为多轮，每轮都使用输入字符串的所有位，因此在第一轮之后计算在添加盐*之前的内部状态是没有意义的。*例如，SHA-1 有 80 轮。

此外，像 PBKDF 这样的密码散列算法多次组合它们的散列函数（建议迭代 PBKDF-2 至少 1000 次，每次迭代应用 SHA-1 两次）使得这种攻击更加不切实际。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-23T19:40:44.780

如果平台有提供者，[则为 BCrypt 哈希。](http://www.google.ca/search?hl=en&q=BCrypt+hash)我喜欢你不用担心产生盐的方式，如果你愿意，你可以让它们变得更强壮。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-03-23T20:41:32.993

在密码中插入任意数量的字符是最不期望的情况，因此在社交上最“安全”，但在一般情况下它真的不是很重要，只要你使用长的，每个密码唯一盐的字符串。

# inheritance - Joomla：列表部分布局的参数不被继承

> ID：674905
> 
> 赞同：0
> 
> 时间：2009-03-23T19:34:01.067
> 
> 标签：inheritance, properties, menu, joomla

我是 Joomla，我有一个菜单项，其中列出了一个部分中的类别。我更改了一些参数（例如“不显示标题”）。它适用于初始类别列表，但是从该页面导航到类别后，这些参数不再适用。

例如，假设我们有一个应用了一些属性的菜单项“新闻”。导航到新闻 > 最新消息后，这些属性不再适用。

感谢你的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-21T12:29:05.370

如果没有有关设置的详细信息，很难说为什么会出现问题，但我会大胆猜测您的类别（例如最新）的另一个菜单中有子菜单项或菜单项。

我冒险这个猜测，因为这可以解释你的问题。如果您有类别的菜单项，那么这些设置将覆盖您的部分概述菜单项的设置。

在 Joomla 中，有三个级别的设置会对您的部分和类别概览页面产生影响（无论是列表还是博客视图）。最通用的设置是文章管理器参数中的设置。这些被相关菜单项的设置覆盖。如果有父子菜单项，则以最底层菜单项中的设置为准。最后，上述所有设置都可以通过文章编辑视图中的文章设置来设置。

所以，我最好的猜测是你必须检查你是否有子菜单项以及那里有什么设置。

# c - 解释来自 apr_dso_load() 的错误代码

> ID：674908
> 
> 赞同：0
> 
> 时间：2009-03-23T19:34:36.400
> 
> 标签：c, linux

在 Linux 系统上的团队环境中，我刚刚从树的头部提取了最新的代码库，一些已经工作了很长时间的东西已经停止工作了。我们有动态共享对象，并且 APR 库调用失败：

```
err = apr_dso_load(&mod->handle, mod->path, mod->pool);   
if (err ) {
     fprintf (stderr, "Failed %d\n", err); 
```

}

我收到错误 20019，不知道如何利用此错误。我不能打电话`apr_dso_error`，因为我没有有效的句柄。该文件在那里，可读，据我所知是正确的。

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T20:24:17.920

使用以下内容获取错误的人类可读字符串描述：

```
char* apr_strerror(apr_status_t statcode,
                   char * buf,
                   apr_size_t bufsize
                  ) 
```

# delphi - 可以解析Delphi XMLDoc格式并构建在线帮助的工具

> ID：674916
> 
> 赞同：2
> 
> 时间：2009-03-23T19:35:44.230
> 
> 标签：delphi, delphi-2009, delphi-2007, delphi-2006

API 文档的 XMLDoc 工具在此处解释：

[http://edn.embarcadero.com/article/32770](http://edn.embarcadero.com/article/32770)

是否有任何免费或商业工具可用于创建基于 Delphi 的 XML 文档格式的文档？

是否有更新版本的“入门”文档？此页面指的是 Delphi 2005 和第三方工具，其中一些似乎已经移动。

需要 Delphi 2005 的 XMLDoc

*   Python（使用 Python 2.3 测试）
*   Instant Saxon（使用 Instant Saxon 6.5.3 测试）
*   Java SDK（使用 J2SE v 1.4.2_05 SDK 测试）
*   以及 Visual Studio 帮助集成工具包

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-23T19:49:05.803

查看：

*   [帮助和手册](http://www.helpandmanual.com/)
*   [帮助涂鸦](http://www.helpscribble.com/)
*   [Doc-o-Matic](http://www.doc-o-matic.com/)

这些工具应该能够创建帮助文件，并且很可能还使用 XMLDoc 作为它们的输入（两者都与 Delphi 兼容，甚至是用 Delphi 编写的）。

马克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-07T05:53:12.447

这不是一个直接的答案，但如果您想为您的 Delphi 代码使用 XMLDoc，我强烈推荐[CodeCentral 的这个开放工具插件](http://cc.embarcadero.com/Item/23153)。我刚刚在 Delphi 2010 中对其进行了测试，它仍然可以正常工作。

# css - 如何让推页脚技巧在 IE 8 中工作？

> ID：674921
> 
> 赞同：1
> 
> 时间：2009-03-23T19:37:18.140
> 
> 标签：css, html, sticky-footer

我用这个：

```
body {font-size:12px; font-family:"trebuchet MS", verdana, arial, sans-serif; background: #CCCCCC; word-wrap:break-word; height: 100%; margin: 0; padding: 0;
}

#wrapper {
    text-align: left;
    height:auto;
    height: 100%;
    margin: 0 auto -200px; /* the bottom margin is the negative value of the footer's height */
    padding: 0px;
    border:0;
    width: 1000px;
    background: #FFFFFF;

.footer, .push {
    height: 200px; /* .push must be the same height as .footer */
    position:absolute;
} 
```

看起来它在 Firefox/Safari/Opera 和 IE 6 和 7 中运行良好，但在 8 中却不行。有什么遗漏或错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T12:16:55.290

你的代码有一些大漏洞，所以我不得不做一些猜测。你可以测试这个，它似乎在我测试的 ff3、ie7 和 ie8 上工作相同。

我不确定这是否是你想要的，但你真的应该为你的问题提供一个更好的例子。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>test</title>
    <style type="text/css">
html{
    height:100%;
    margin: 0; 
    padding: 0;
}
body {
    font-size:12px; font-family:"trebuchet MS", verdana, arial, sans-serif; 
    background: #CCCCCC; 
    word-wrap:break-word; 
    height: 100%; 
    margin: 0; 
    padding: 0;
}

#wrapper {
    text-align: left;
    height:auto;
    height: 100%;
    margin: 0 auto -200px; /* the bottom margin is the negative value of the footer's height */
    padding: 0px;
    border:0;
    width: 1000px;
    background: #FFFFFF;
}

.footer, 
.push {
    height: 200px; /* .push must be the same height as .footer */
    position:absolute;
    bottom:0;
    background:red;
}

    </style>
</head>
<body>
    <div id="wrapper">Lorem</div>
    <div class="footer">Footer jabba jibba jubba hubba bubba dubba dibba dei</div>
</body>
</html> 
```

我希望这会有所帮助。

# com - 如何让 ADO.NET 使用持久的 XML ADO 记录集进行更新

> ID：674925
> 
> 赞同：0
> 
> 时间：2009-03-23T19:38:21.617
> 
> 标签：com, ado.net, xml-serialization, recordset

我正在处理多层客户端-服务器应用程序的 .NET 2.0 转换。目前，我们正在将服务器端转换为 .NET，但将客户端应用程序保留在 COM (VB6) 中。我目前的工作重点是从基于分离的 COM 的客户端获取数据。
正在开发的当前版本使用 ADO(COM) 记录集作为 XML 持久化并发送到客户端。然后，客户端将 XML 加载到记录集对象中，以便对数据进行读/写访问。数据以相同的格式发送回服务器。
在收到要更新的持久 XML 记录集后，我们会进行一些相当笨拙的解析以生成 UPDATE 语句，这些语句通过 ADO.NET 推送以相应地更新源数据库。

在（非常粗略的）伪代码中：

```
adodb.recordset oRS = load(ADOXML)
for each rec in oRS
{
  string sSQL = "Update table set value = " + rec.ValueField + " where key = " + rec.KeyField
  executeNonQuery(sSQL)
} 
```

*免责声明：实际逻辑远非如此粗略，但最终结果是相同的。

我想知道是否有人有更好的解决方案将更新的数据重新输入数据库......？

谢谢，

担

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T19:55:19.330

将所有行设置为已修改后，您是否考虑过使用 TableAdapter 对数据执行更新？

如果您有一个预配置的 SQLTableAdapter，其中内置了更新函数，那么通过将表从 XML 读入数据集中，您可以从表适配器调用更新函数，以使用表中的每一行更新中央数据库。

```
var tableadapter = new MyTableAdapter();

var dataset = new MyDataSet();

dataset.ReadXml("c:\myxmldata.xml");

foreach(var row in dataset.tables[0].rows)
{
   row.SetModified();
}

tableadapter.Update(dataset); 
```

# sql - 从 SQL 中的多个数据库中选择 COUNT()

> ID：674929
> 
> 赞同：3
> 
> 时间：2009-03-23T19:39:23.127
> 
> 标签：sql, select, count, aggregate

我正在尝试返回位于特定州且已租借特定电影的客户数量，其中，rents 表包含两列，一列用于客户 ID，另一列用于电影 ID。该函数接受电影 ID 和状态，并返回一个包含客户数量的整数。

现在我有一个实现，但它计算了整个查询返回的行数：

```
SELECT COUNT(*) as numCustomers FROM CUSTOMER C, RENTS R WHERE C.ST = '" + state + "' AND R.mid = " + movieID 
```

然后我计算行数。我希望能够检查 numCustomers 以获取正确的数据。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-23T19:46:29.820

首先，您缺少一个子句来链接您的 RENTS 表和 CustomerId 上的 CUSTOMER 表？

其次，您应该使用 FROM 子句中的 INNER JOIN 功能来添加您的两个表。

第三，您不应该将您的 sql 构建为这样的字符串，因为您将对 SQL 注入开放。

猜测一下，您可能需要的 SQL 类型如下。

```
DECLARE @movieId int
DECLARE @state varchar(2)

SET @movieId = 12345
SET @state = 'NY'

SELECT
    COUNT(DISTINCT C.CustomerID) as numCustomers
FROM
    CUSTOMER C
INNER JOIN
    RENTS R
ON
    C.CustomerID = R.CustomerId
WHERE
    C.ST = @state
AND
    R.mid = @movieId 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-23T19:52:39.133

猜测您的架构（RENTS 与 CUSTOMER 的关系）：

```
SELECT COUNT(*) as numCustomers
FROM CUSTOMER c
WHERE
    c.ST = @State
    AND EXISTS
    (
        SELECT *
        FROM RENTS r
        WHERE r.CustomerID = c.CustomerID
        AND r.mid = @movieID
    ) 
```

此外，如果您还不熟悉该主题，您应该研究 SQL 注入攻击。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T19:57:27.297

您必须连接您的 Customer 和 Rental 表，否则您将获得每个表中每个条目的条目。

怎么样： `SELECT COUNT(C.ID) AS numCustomers` `FROM CUSTOMER C, RENTS R` `WHERE` `C.ID = R.RenterID` `AND` `C.ST = '" + state + "'` `AND` `R.mid = " + movieID`

# c++ - 转到 Vim 中 C++ 函数的末尾

> ID：674930
> 
> 赞同：18
> 
> 时间：2009-03-23T19:39:26.123
> 
> 标签：c++, vim

如果我在函数的中间，我想在 vim 中走到它的最后。我遇到了这个问题，因为我们有时有超过 500 行的功能（不要问为什么）。

我使用 vim，gvim。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-03-23T19:42:00.563

`][`转到第一列中的下一个“}”。

阅读`:help 29.3`以了解有关通过程序移动的更多信息。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-03-23T19:41:33.763

您可以使用“]}”命令。您可能需要重复它，具体取决于您的嵌套程度。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-23T19:40:43.407

][ 或 [] 将为您执行此操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-23T19:53:05.717

确保您使用 :split 和代码折叠对您有利 - 在屏幕顶部保持折叠视图，展开函数，拆分，编辑函数，关闭拆分窗口，折叠折叠。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-24T10:10:11.927

SHIFT+5 在 { 和 } 之间切换。您可以使用它来识别最顶层的代码块。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-05T14:22:23.317

经过近一个小时的“研究”，我发现@Ana Betts 的回答是最有帮助的。我尝试添加一些缓冲区映射以使其完美：

```
autocmd BufReadPre *.js nnoremap <buffer> [[ []%0
autocmd BufReadPre *.js nnoremap <buffer> ]] ][%0 
```

这到你的 .vimrc 并输入`]]`或`]]`看到魔法发生:)

# c++ - 角拼接数据结构，任何开源实现？

> ID：674933
> 
> 赞同：1
> 
> 时间：2009-03-23T19:39:37.527
> 
> 标签：c++, language-agnostic, open-source, data-structures, 2d

我记得几年前学习过拐角缝合的数据结构，从那时起就对它着迷。它起源于[Ousterhout 的一篇论文](http://www.eecs.berkeley.edu/Pubs/TechRpts/1983/6352.html)。

我已经搜索但无法找到免费/开放的实现。我更喜欢 C++ 实现，但此时会接受人们可能拥有的任何指针。

注意：角缝合数据结构是一种存储二维矩形数据的方法，显式维护插入元素之间的空白。这与只存储插入的数据元素的四叉树相反。有很多权衡，我最感兴趣的是实现——但也会接受具有相似属性的替代方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-25T22:38:41.340

Ousterhout 自己的软件包**Magic**实现了边角拼接。C 源代码可在[http://opencircuitdesign.com/magic](http://opencircuitdesign.com/magic)上获得 BSD 许可。

# javascript - JS 变量范围

> ID：674978
> 
> 赞同：2
> 
> 时间：2009-03-23T19:49:03.760
> 
> 标签：javascript, scope

JS 中的变量范围让我很困惑。在下面的代码中，如果我使用`setClient`public 方法设置 a`clientID`我可以使用该方法从 track 方法内部访问该值`getClient`。但是，我不能以这种方式（或任何其他私有成员）访问私有成员“版本”的值。我曾假设 var`_this = this`会创建某种闭包，允许访问 Container 函数的范围。

现在我很困惑。我意识到这可能很简单，所以我想我会在这里问。到底哪里有抓错了？

```
function Container()
{
    // private members
    var version = '0.1';
    var CID = false;
    var _this = this;

    // public members
    this.getVersion = function() { return _this.version; }
    this.getClient = function() { return _this.CID; }
    this.setClient = function(CID) { _this.CID = CID; }

    // private methods
    this.getQS = function() { return _this.version; }

    // public methods
    this.track = function()
    {
        if (_this.CID)
        {
            var date = new Date();

            data = 
            {
                cid: _this.getClient(),
                sw: screen.width ? screen.width : false,
                sh: screen.height ? screen.height : false,
                d: date.getTime()
            }

            qs = '';

            for (p in data) { qs += p+'~'+data[p]+'-'; }

            var elHd = document.getElementsByTagName("head")[0];         
            var elScr = document.createElement('script');

            elScr.type = 'text/javascript';
            elScr.src = 'http://example.org/'+qs+
                            'version-'+_this.getVersion();

            elHd.appendChild(elScr);
        }
        else
        {
            alert('no client ID');
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-23T20:19:24.047

稍微清理一下您的 Container 构造函数。version 和 CID 变量是私有的，并且在 Container 构造函数范围内，因此您不需要 this 范围引用，它根本不起作用。这。公共可访问的属性和方法需要引用，并且在您在构造函数之外定义原型时非常有用，如第二个代码块所示。

```
function Container() {
  var version = "0.1", CID = false;

  this.getVersion = function()      { return version };
  this.getClient  = function()      { return CID     };
  this.setClient  = function(value) { CID = value    };

  this.track = function() {
    if (CID) {
      var qs = "", data = {
        cid: this.getClient(),
        sw: screen.width ? screen.width: false,
        sh: screen.height ? screen.height: false,
        d: (new Date).getTime()
      };
      for (var p in data) qs += p +"~"+ data[p] +"-";
      var js = document.createElement("script");
      js.type = "text/javascript";
      js.src = "http://example.org/"+ qs +"version-"+ this.getVersion();
      document.getElementsByTagName("head")[0].appendChild(js);
    } else {
      alert("No Client ID");
    }
  };
}; 
```

这。当您在构造函数之后添加/覆盖原型时，引用变得至关重要。

```
function Container2() { }
Container2.prototype = {
  CID: null,
  version: "0.1",
  track: function() {
    alert(this.version);
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T19:58:02.350

我不确定我是否理解您在哪里感到困惑（或者为什么您以自己的方式做事，所以我可能会感到困惑）。如果你这样做会发生什么：

```
this.getVersion = function() { return version; } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T20:08:34.243

变量*版本*不是 Container 类的成员字段。它是一个局部变量，仅在 Container 构造函数期间存在。因此，您需要创建它（就像您使用方法一样）：

```
this.version = "0.1"; 
```

您应该对*CID*字段执行相同的操作。更好的是，将它们添加到类的原型对象中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T21:17:45.047

简单的答案是使用

```
this.getVersion = function() { return version; } 
```

因为 JavaScript 函数是闭包，所以即使在函数返回后，也可以访问上面函数中对局部变量*version*的引用。尝试访问`_this.version`是尝试读取对象的*版本*成员`_this`。由于您从未分配`_this`过*版本*成员，因此它将返回`undefined`.

在 JavaScript 中，您只能访问显式添加到您正在使用的对象，或添加到该对象的原型或原型的原型等的成员。

有关在 JavaScript 中使用私有成员的更多信息，请参阅 Douglas Crockford 的一篇精彩文章：[JavaScript 中的私有成员](http://www.crockford.com/javascript/private.html)

# c++ - C++ 风格转换对性能的影响？

> ID：674982
> 
> 赞同：69
> 
> 时间：2009-03-23T19:50:31.150
> 
> 标签：c++, performance, casting

我是 C++ 风格转换的新手，我**担心使用 C++ 风格转换会破坏我的应用程序的性能，**因为我的中断服务例程中有一个[实时关键的截止日期。](http://en.wikipedia.org/wiki/Real-time_computing)

我听说有些演员甚至会抛出异常！

我想使用 C++ 样式转换，因为它会使我的代码更“健壮”。但是，**如果有任何性能损失**，那么我可能不会使用 C++ 样式转换，而是会花更多时间测试使用 C 样式转换的代码。

* * *

有没有人做过任何严格的测试/分析来比较 C++ 风格转换和 C 风格转换的性能？

你的结果是什么？

你得出什么结论？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-03-23T19:54:16.883

如果 C++ 风格的转换可以在概念上被 C 风格的转换所取代，那么就不会产生任何开销。如果它不能，例如 ，`dynamic_cast`没有 C 等价物，您必须以一种或另一种方式支付成本。

例如，以下代码：

```
int x;
float f = 123.456;

x = (int) f;
x = static_cast<int>(f); 
```

使用 VC++ 为两种强制转换生成相同的代码 - 代码是：

```
00401041   fld         dword ptr [ebp-8]
00401044   call        __ftol (0040110c)
00401049   mov         dword ptr [ebp-4],eax 
```

唯一可以抛出的 C++ 转换是`dynamic_cast`在转换为引用时。为避免这种情况，请转换为一个指针，如果转换失败，该指针将返回 0。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-03-23T19:52:39.727

唯一在运行时有任何额外成本的是`dynamic_cast`，它具有无论如何都无法直接使用 C 样式转换来复制的功能。所以你没有问题。

让自己放心的最简单方法是指示编译器生成汇编器输出，并检查它生成的代码。例如，在任何合理实现的编译器中，`reinterpret_cast`它将完全消失，因为它只是意味着“盲目前进并假装数据属于这种类型”。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-03-23T20:11:14.830

为什么会有性能冲击？它们执行与 C 强制转换*完全相同的功能。*唯一的区别是它们在编译时捕获更多错误，并且更容易在源代码中搜索它们。

`static_cast<float>(3)`完全等同于`(float)3`，并且将生成完全相同的代码。

给定 a`float f = 42.0f` `reinterpret_cast<int*>(&f)`完全等价于`(int*)&f`，并且将生成完全相同的代码。

等等。唯一不同的是`dynamic_cast`，是的，可以抛出异常。但那是因为它做了 C 风格的演员不能做的事情。`dynamic_cast`所以除非你需要它的功能，否则不要使用。

通常可以安全地假设编译器编写者是聪明的。根据标准，给定两个具有相同语义的不同表达式，通常可以安全地假设它们将在编译器中以相同方式实现。

**糟糕**：第二个例子当然应该是 reinterpret_cast，而不是 dynamic_cast。现在修好了。

好的，为了明确起见，以下是 C++ 标准所说的：

§5.4.5：

> 执行的转换
> 
> *   ( `const_cast`5.2.11)
> *   ( `static_cast`5.2.9)
> *   一个`static_cast`接着一个`const_cast`
> *   a `reinterpret_cast`(5.2.10)，或
> *   a`reinterpret_cast`后跟 a `const_cast`。
> 
> 可以使用显式类型转换的强制转换表示法来执行。相同的语义限制和行为适用。如果转换可以用以上列出的一种以上方式解释，则使用列表中第一个出现的解释，即使由该解释产生的强制转换是格式错误的。

因此，如果*有的话*，由于 C 样式转换是根据 C++ 转换实现的，因此 C 样式转换应该*更慢*。（当然不是，因为编译器在任何情况下都会生成相同的代码，但它比 C++ 风格的转换更慢更合理。）

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-03-23T21:10:53.890

有四种 C++ 风格类型转换：

*   `const_cast`
*   `static_cast`
*   `reinterpret_cast`
*   `dynamic_cast`

如前所述，前三个是编译时操作。使用它们没有运行时惩罚。它们是给编译器的消息，表明以一种方式声明的数据需要以不同的方式访问。“我说这是一个`int*`，但让我访问它，就好像它是`char*`指向`sizeof(int) char`s 一样”或“我说这个数据是只读的，现在我需要将它传递给一个不会修改它的函数，但是不将参数作为 const 引用。”

除了通过强制转换为错误的类型和破坏数据（C 风格强制转换总是有可能）导致数据损坏之外，这些强制转换最常见的运行时问题是实际声明的数据`const`可能无法强制转换为非常量。将声明`const`的内容转换为非常量然后修改它是未定义的。 [未定义意味着您甚至不能保证会崩溃](http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_21.html)。

`dynamic_cast`是一个运行时构造，必须有运行时成本。

这些演员表的价值在于，它们特别说明了您要从中/向投射的内容，在视觉上突出，并且可以使用脑死亡工具进行搜索。我建议使用它们而不是使用 C 风格的演员表。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-23T20:09:00.640

当在运行时使用`dynamic_cast`多项检查以防止您做一些愚蠢的事情时（更多在[GCC 邮件列表中](http://gcc.gnu.org/ml/gcc/1999-12n/msg00544.html)），一项检查的成本`dynamic_cast`取决于有多少类受到影响，哪些类受到影响等。
如果您真的确定cast 是安全的，你仍然可以使用[`reinterpret_cast`](http://www.cplusplus.com/doc/tutorial/typecasting.html).

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-23T20:35:54.333

尽管我同意“唯一在运行时有任何额外成本是`dynamic_cast`”的说法，但请记住，可能存在特定于编译器的差异。

我已经看到一些针对我当前编译器的错误，其中代码生成或优化略有不同，具体取决于您使用的是 C 样式还是 C++ 样式`static_cast`转换。

因此，如果您担心，请检查热点上的反汇编。否则，当您不需要它们时，请避免使用动态强制转换。（如果你关闭 RTTI，你`dynamic_cast`无论如何都不能使用。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-21T14:45:56.937

规范的事实是汇编，所以尝试两者，看看你是否得到不同的逻辑。

如果您获得完全相同的组件，则没有区别-不可能。您真正需要坚持使用旧 C 类型转换的唯一地方是纯 C 例程和库，在这些地方引入 C++ 依赖关系仅用于类型转换是没有意义的。

需要注意的一件事是，转换发生在一段大小合适的代码中。在我的整个职业生涯中，我从来没有在逻辑上搜索过“所有演员表”——你倾向于搜索特定类型的演员表，比如“A”，而搜索“(A)”通常和类似“static_cast<A>”的东西。将较新的类型转换用于类型验证之类的事情，而不是因为它们使搜索变得更容易。

# jquery - Jquery 选项卡 - 选项卡太多

> ID：674984
> 
> 赞同：3
> 
> 时间：2009-03-23T19:51:41.350
> 
> 标签：jquery, jquery-ui-tabs

我正在使用 JQuery 选项卡。问题是当有太多标签时，某些标签被挤压到下一行，并且布局看起来很奇怪。我没有设置`<div>`选项卡的“宽度”属性。反正有没有`<div>`自动拉伸而不是将标签挤压到下一行？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-23T20:00:06.090

如果我查看提供的 CSS 主题，我会玩弄：

```
.ui-tabs .ui-tabs-nav li { 位置：相对；向左飘浮; 边框底部宽度：0！重要；边距：0 .2em -1px 0；填充：0；}
.ui-tabs .ui-tabs-nav li a { float: left; 文字装饰：无；填充：0.5em 1em；}

```

尝试类似：

```
.ui-tabs .ui-tabs-nav li {
宽度：自动；
最小宽度：自动；
}

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-23T20:32:07.587

在我查看了一个 css 文件并尝试了一下样式之后，我需要将“display:inline”添加到“.ui-tabs .ui-tabs-nav li”

此外，当存在太多标签时，将某些标签推到新行。如果我单击第一个选项卡中的项目，某些选项卡可能会移动。我通过删除“.ui-tabs .ui-tabs-nav li.ui-tabs-selected”中的“padding-bottom”来解决这个问题

# scheme - 您如何停止 DrScheme 的 R5RS 实施？

> ID：674998
> 
> 赞同：2
> 
> 时间：2009-03-23T19:55:46.163
> 
> 标签：scheme, racket

将 DrScheme 与 R5RS 一起使用时，没有错误功能。我打算自己写，但不知道如何停止程序执行。我尝试了以下命令：

*   （停止）
*   （出口）
*   （错误）

没有工作。你如何停止程序执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T20:11:02.193

[SLIB](http://people.csail.mit.edu/jaffer/SLIB.html)（可移植方案库）具有 ERROR 的实现。你可能想看看那个，或者在你的程序中使用 SLIB。

除此之外，停止程序的一种方法就是引发不同的错误！尝试这样的事情（感谢[Stephen Houben](http://srfi.schemers.org/srfi-23/srfi-23.html)）：

```
(define (error reason . args)
      (display "Error: ")
      (display reason)
      (for-each (lambda (arg) 
                  (display " ")
          (write arg))
        args)
      (newline)
      (scheme-report-environment -1))  ;; we hope that this will signal an error 
```

虽然这确实引发了第二个（不相关的）错误，但它肯定会停止程序执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T22:24:37.317

您是否有理由需要使用 R5RS？DrScheme 中的其他语言定义定义`error`和`exit`. 例如，`(module ...)`PLT 语言定义`error`和`exit`. 从命令行调用`mzscheme`也会为您提供这些定义。

注意：我有 DrScheme 372，它已经很老了。不过，事情不应该发生太大变化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-09T12:07:57.940

一个丑陋的解决方案是将 abort 定义为运行时错误。例如 ，如果您的幸运甚至显示字符串、错误代码或您关心的任何内容， `(define abort "the program was aborted") (define abort 123) (define abort #f)` 任何对 abort 的调用都 `(abort)` 应该会产生运行时错误。``***********