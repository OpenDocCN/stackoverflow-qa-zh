# StackOverflow 问答 11508000-11508999

# jquery - jquery 在删除之前不会等待动画完成，为什么？

> ID：11508004
> 
> 赞同：5
> 
> 时间：2012-07-16T15:56:56.647
> 
> 标签：jquery

我正在做一些简单的事情，而不仅仅是做：

```
$(this).next().remove(); 
```

我希望它有更多的闪光，并想添加一个动画功能

```
$(this).next().slideUp().remove(); 
```

它会在移除之前向上滑动以隐藏项目。在使用 Chrome 进行测试时，它几乎只是删除了这些项目，并没有完成我所期望的平滑过渡。

没有删除的测试有正确使用 slideUp() 的项目。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T15:58:34.943

尝试使用**[`slideUp()`](http://api.jquery.com/slideUp)**方法的回调函数。

```
$(this).next().slideUp(function() {
  // remove the element after 
  // animation finished
  $(this).remove();
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T15:58:37.283

这是因为`slideUp`发生在后台。要等到它完成，请使用它的回调。

```
$(this).next().slideUp(function(){
    $(this).remove();
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T15:59:34.733

动画调用是异步的，它开始但继续执行。完成你想要的方法是使用回调可能是这样的：

```
 $(this).next().slideUp(function(){
     $(this).remove();
    }); 
```

# objective-c - 将 HTML 加载到子 UIWebView 时可以保持平滑滚动吗？

> ID：11508007
> 
> 赞同：2
> 
> 时间：2012-07-16T15:57:16.397
> 
> 标签：objective-c, ios, uiwebview, uiscrollview, smooth-scrolling

我需要在 iPad 应用程序中显示适度 DOM 密集型 HTML 页面的分页幻灯片。
所有文档都是为 iPad 屏幕量身定做的，因此`UIWebView`s 内永远不会有任何滚动。

我决定将`UIWebView`s 放在里面 `UIScrollView`进行分页。
在所有 Web 视图都呈现了它们的内容之后，它工作得非常好和流畅。

但是，我不能在用户滚动之前等待 20、30 或 50 个 Web 视图加载：这需要几分钟。
我试图预测`scrollViewDidScroll`处理程序中的滑动并在**用户继续滚动时预加载几个下一页**。

这工作得更好（10 或 150 个 Web 视图之间没有性能差异）。
但是**调用处理程序会`loadHTMLString`导致`scrollViewDidScroll`滚动失去平滑度**。

我不在乎是否需要多一秒钟才能显示特定内容`UIWebView`——我想要的只是滚动流畅且尽快可用，并`UIWebView`在旅途中懒惰地预加载 s。

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:36:35.283

这是一个难题，没有简单/优雅的方法来解决它。

加快滚动速度的一种方法是延迟加载页面，如您在问题中所述。但是，为了确保平滑度，您必须控制加载发生的时间。

因此，假设您首先在初始启动时加载前 5 页。当用户滚动到第 2 页并**STOPS**时，您开始加载第 6 页。一旦用户再次开始滚动，您就会暂停加载，仅当他们在新页面上停止时才能恢复。在两者之间暂停加载将有助于平滑滚动。此外，请确保尽可能发布数据，因为它会累积并阻碍向下平滑滚动。

另一种选择是让 UIWebViews 仅在用户在页面上停止时才开始加载。所以说我滚动到页面，一旦滚动停止，我就开始加载 HTML。这不像第一个选项那样“漂亮”，但它将确保滚动流畅。

另一种选择是运行并加载所有 HTML 页面富文本。省略所有 DOM 密集型的东西。[然后使用此方法](https://stackoverflow.com/questions/7964153/ios-whats-the-fastest-most-performant-way-to-make-a-screenshot-programaticall)抓取那些半加载页面的屏幕截图。当用户停在页面上时，您会一直加载它，包括 DOM 密集型内容。这将让用户感觉他们正在快速滚动加载所有内容。

[这是我以前使用过的一个很棒的滚动类。](https://github.com/100grams/HGPageScrollView)

[这是一些帮助方法3的代码。](https://github.com/Cocoanetics/DTCoreText)

祝你好运，我希望这会有所帮助！

编辑： [LinkedIn 的人发表了一篇很棒的文章，介绍了他们如何解决 webView 滚动问题。值得一读。](http://engineering.linkedin.com/linkedin-ipad-5-techniques-smooth-infinite-scrolling-html5)

# c# - 将数组传递给事件 C# 中的方法

> ID：11508008
> 
> 赞同：0
> 
> 时间：2012-07-16T15:57:26.700
> 
> 标签：c#

我试图创建一个程序的一部分，其中用户按下一个按钮并将图像放置在 9 个图片框之一中。每次单击按钮时，应选择不同的图片框。但是，在我开始之前，我无法让我的方法看到我试图通过它的数组。

我有 2 个数组，Slots 和 SlotsUsed，我试图在程序启动时初始化它们。但是，当我尝试将它们传递给在“Button1”中调用的方法“randomBox”时，Visual Studio 说它们不存在。如何使这些数组在我的代码中可见？

非常感谢安东尼

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace pin_program
{
    public partial class Mainscreen : Form
    {
        //Sets where users files are to be stored (for later use)
        string activeDir = @"C:\Users\Tony\Downloads\Programs\pin program\Users";

        public Mainscreen()
        {
            InitializeComponent();
        }

        //method to generate random number
        private int RandomNumber(int min, int max)
        {
            Random random = new Random();
            return random.Next(min, max);
        }

        public void randomBox(int pictureVal, PictureBox[] Slots, bool[] SlotsUsed)
        {
            //generate random number
            int j = RandomNumber(0, 9);

            if (SlotsUsed[j] == false)
            {
                // Create image, assign it and set slots value to used
                Image newImage = Image.FromFile(@"C:\Users\Tony\Downloads\Programs\pin program\pin program\pin program\Images\" + pictureVal + ".jpg");
                Slots[j].Image = newImage;
                SlotsUsed[j] = true;
            }
            else
                do
                {
                    j = RandomNumber(0, 9);
                } while (SlotsUsed[j] == false);

            return;
        }

        private void button1_Click(object sender, EventArgs e)
        {
            //for use later
            string userName = textBox1.Text;
            //for use later
            label1.Visible = true;

            //test call of method.
            randomBox(1, Slots, SlotsUsed);
        }

        public void Mainscreen_Load(object sender, EventArgs e)
        {
            //array for slots
            PictureBox[] Slots = new PictureBox[9];
            Slots[0] = pictureBox1;
            Slots[1] = pictureBox2;
            Slots[2] = pictureBox3;
            Slots[3] = pictureBox4;
            Slots[4] = pictureBox5;
            Slots[5] = pictureBox6;
            Slots[6] = pictureBox7;
            Slots[7] = pictureBox8;
            Slots[8] = pictureBox9;

            //array for used slots
            bool[] SlotsUsed = new bool[9];
            for (int i = 0; i != (SlotsUsed.Length); i++)
            {
                SlotsUsed[i] = false;
            }
        }
    }
} 
```

编辑：由于某种原因，我似乎无法发表评论，所以我会在这里问。我如何将我的数组声明为实例变量而不是本地变量？实例变量是否有另一个我可能知道的名称？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:00:14.583

目前，您将`Slots`和`SlotsUsed`作为*局部*变量声明在`Mainscreen_Load`. 它们必须是您表单中的*实例*变量，否则您无法在其他地方引用它们 - 实际上它们在逻辑上不会*存在于*其他地方。它们是表单状态的一部分，因此它们应该是实例变量。

此外，您生成随机数的方法被破坏了 - 有关更多信息，请参阅我[关于随机数](http://csharpindepth.com/Articles/Chapter12/Random.aspx)的文章。

我还要补充一点，你可能会考虑只使用一个集合，从一开始就对其进行洗牌，然后在你去的时候从中删除项目——这样你就可以很容易地判断出图像何时用完，而你没有必须循环直到找到未使用的插槽。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:00:24.363

好吧，最简单的方法是声明一个字段。

```
protected PictureBox[] Slots 
```

在您的 Form 类中（在任何方法之外。

# python - 从文件中读取和存储任意字节长度的整数

> ID：11508010
> 
> 赞同：5
> 
> 时间：2012-07-16T15:57:29.273
> 
> 标签：python, numpy

我试图通过在 numpy 中进行解析/数据积累来加速我去年编写的二进制文件解析器。numpy 定义自定义数据结构并将二进制文件中的数据插入其中的能力看起来就像我需要的那样，除了这些文件中的某些字段是“非标准”长度（例如 6 个字节）的无符号整数。由于我使用的是 Python 2.7，因此我制作了自己的 int.from_bytes 模拟版本来处理这些字段，但是如果有任何方法可以在 numpy 中将这些字段本地读取为整数，那显然会更快、更可取。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T19:45:34.213

Numpy 不支持任意字节长度的整数，并且使用 ctypes 位域会比它的价值更麻烦。

我建议使用矢量化切片将您的数据转换为下一个更高的标准大小整数：

```
buf = "000000111111222222"
a = np.ndarray(len(buf), np.dtype('>i1'), buf)
e = np.zeros(len(buf) / 6, np.dtype('>i8'))
for i in range(3):
    e.view(dtype='>i2')[i + 1::4] = a.view(dtype='>i2')[i::3]
[hex(x) for x in e] 
```

# debugging - 首先调用DLL

> ID：11508011
> 
> 赞同：0
> 
> 时间：2012-07-16T15:57:33.410
> 
> 标签：debugging, windows-services, windbg, ida

所以，我有一个可能很简单的问题。首先我要注意我是 IDA 调试过程的初学者，请不要笑我...

我想调试windows服务，就是svchost.exe。我将 IDA 与 Windbg 一起使用。所以，我附上了适当的过程。我在右侧窗口的特殊列表中看到 - 我的进程使用了​​哪些 dll 文件。我的问题是：我怎样才能知道 - 首先将使用什么 dll？我想添加一个断点，但我不知道 - 我需要在什么函数中添加它...这个过程在 Windows 7 中使用 5355 远程端口，我向这个端口发送了一些数据，我希望看到我的数据......也许有可能找出第一个使用的dll。

我会感谢任何人的帮助或解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T02:10:02.840

您可以按照 MS KB824344 [http://support.microsoft.com/kb/824344](http://support.microsoft.com/kb/824344)告诉 Windows 在进程启动后立即附加调试器。查找名为**Configure a service to start with the WinDbg debugger attach**的部分。

# c++ - 块嵌套太深

> ID：11508013
> 
> 赞同：8
> 
> 时间：2012-07-16T15:57:44.430
> 
> 标签：c++

我有一些不典型的问题。我向用户提供 sendText() 函数。他可以输入例如

```
sendText( "mytext{newline}text{up}" ) 
```

{text} 是允许用户发送的特殊密钥。有很多特殊的键可用。

所以我的第一步是获取 {} 括号之间的字符串并创建：

```
if( _specialKey == "newline" ) {
    // action for VK_RETURN
} else if( _specialKey == "up" ) {
    // action for VK_UP
} else ..... 
```

例子：

```
if( specialKey == "n" ) {
    // enter click
    unsigned short key = VK_RETURN;
    inputs.push_back( keyDown( key ) );
    inputs.push_back( keyUp( key ) );

    return 2;
} else if( specialKey == "n+" ) {
    // enter down
    inputs.push_back( keyDown( VK_RETURN ) );

    return 2;
} else if( specialKey == "n-" ) {
    // enter up
    inputs.push_back( keyUp( VK_RETURN ) );

    return 2;
} else if( specialKey == "t" ) {
    // tabulator click
    unsigned short key = VK_TAB;
    inputs.push_back( keyDown( key ) );
    inputs.push_back( keyUp( key ) );

    return 2;
} else if( specialKey == "t+" ) {
    // tabulator down
    inputs.push_back( keyDown( VK_TAB ) );

    return 2;
} else if( specialKey == "t-" ) {
    // tabulator up
    inputs.push_back( keyUp( VK_TAB ) );

    return 2;
} else if( specialKey == "caps" ) {
    // caps lock click
    unsigned short key = VK_CAPITAL;
    inputs.push_back( keyDown( key ) );
    inputs.push_back( keyUp( key ) );

    return 2;
} else if( specialKey == "caps+" ) {
    // caps lock down
    inputs.push_back( keyDown( VK_CAPITAL ) );

    return 2;
} else if( specialKey == "caps-" ) {
    // caps lock up
    inputs.push_back( keyUp( VK_CAPITAL ) );

    return 2;
} else if( specialKey == "ralt" ) {
    // right alt click
    unsigned short key = VK_RMENU;
    inputs.push_back( keyDown( key ) );
    inputs.push_back( keyUp( key ) );

    return 2;
} else if( specialKey == "ralt+" ) {
    // right alt down
    inputs.push_back( keyDown( VK_RMENU ) );

    return 2;
} else if( specialKey == "ralt-" ) {
    // right alt up
    inputs.push_back( keyUp( VK_RMENU ) );

    return 2;
} else if( specialKey == "lalt" ) {
    // right alt click
    unsigned short key = VK_LMENU;
    inputs.push_back( keyDown( key ) );
    inputs.push_back( keyUp( key ) );

    return 2;
} else if( specialKey == "lalt+" ) {
    // right alt down
    inputs.push_back( keyDown( VK_LMENU ) );

    return 2;
} else if( specialKey == "lalt-" ) {
    // right alt up
    inputs.push_back( keyUp( VK_LMENU ) );

    return 2;
} else if( specialKey == "rctrl" ) {
    // right alt click
    unsigned short key = VK_RCONTROL;
    inputs.push_back( keyDown( key ) );
    inputs.push_back( keyUp( key ) );

    return 2;
} else if( specialKey == "rctrl+" ) {
    // right alt down
    inputs.push_back( keyDown( VK_RCONTROL ) );

    return 2;
} else if( specialKey == "rctrl-" ) {
    // right alt up
    inputs.push_back( keyUp( VK_RCONTROL ) );

    return 2;
} else if( specialKey == "lctrl" ) { 
```

但编译器说：

```
fatal error C1061: compiler limit : blocks nested too deeply 
```

我解决它的第一个想法是定义一个映射，该映射将存储映射到某个整数的所有特殊键（作为字符串）。然后我可以这样做：

```
switch( map[key] ) {
    case 0:
    ...
} 
```

但我不确定编译器是否也会抱怨它。有很多东西要改变，所以我不想因为没有结果而改变它。

或者你还有其他更好的想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T16:08:17.527

你有超过 127`else if`个区块。虽然这应该可以编译并且它肯定是 Microsoft 的 C++ 编译器中的一个错误，但它仍然是一个非常强烈的气味，即您的代码有问题。

您在控制流中存储数据，这 128 个块中的绝大多数是冗余复制和粘贴块。如果有可能不这样做，你就不应该这样做。分离您的代码和数据，对特殊情况使用控制流，同时将所有常见情况重构为单个哈希映射，将其作为一种类型处理。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T16:06:06.517

您可以使用如下地图：`map<string, int>`. 一个元素是`pair<string,int>("newline", VK_RETURN>`：

```
map<string, int> NameToKey;
NameToKey.insert(make_pair("newline", VK_RETURN)); 
```

并在 switch case 中使用相同的方法，例如：

```
map<string,int>::const_iterator iter = NameToKey.find(_specialKey);
switch(iter->second)
{
case VK_RETURN: // Handle as "newline"
   ;
 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T16:30:07.137

一点点 OOP 而不是指向函数的方式。

```
class ICommand
{
  public:
  virtual void execute() const =0;
  virtual void ~ICommand(){};
};

class KeyUpCommand : public ICommand
{
  DWORD key_; //not suare about win api here
  public:
  KeyUpCommand(key) : key_(key) {};
  virtual void execute() const
  {
     keyUp(key_);
  };
};

class KeyDownCommand : public ICommand
{
  DWORD key_; //not suare about win api here
  public:
  KeyDownCommand(key) : key_(key) {};
  virtual void execute() const
  {
     keyDown(key_);
  };
};

int main()
{
  std::map<std::string, ICommand *> commands;
  commands["t-"]=new KeyUpCommand(VK_TAB);

  //execute now
  std::map<std::string, ICommand *>::const_iterator iter = commands.find(_specialKey);
  iter->second->execute();
}; 
```

# windows-8 - 将数据保存到本地内存限制 Windows 8 Metro 风格应用程序

> ID：11508015
> 
> 赞同：0
> 
> 时间：2012-07-16T15:57:53.383
> 
> 标签：windows-8, microsoft-metro, memory-limit

我想知道 Metro 风格的应用程序是否有内存限制。我不是在谈论 RAM。我已经发现有 150 mb 的限制，对吗？

我想知道，是否有使用本地内存（硬盘存储）的限制。我正在创建一个数据库来保存大量数据。我可以这样做直到设备的存储空间用完吗？（我实际上并不打算这样做。但是占用 80mb 的内存会很好）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:11:43.027

本地数据没有限制。

*本地应用程序数据应该用于需要在应用程序会话之间保留并且在类型或大小方面不适合漫游应用程序数据的任何信息。不适用于其他设备的数据也应存储在此处。存储的本地数据没有一般大小限制。位置可通过 localFolder 属性获得。使用本地应用程序数据存储存储对漫游没有意义的数据和大型数据集。*

从[这里](http://msdn.microsoft.com/en-us/library/windows/apps/hh464917.aspx)。漫游数据有限制。同样的文件有。

# keymando - 如何在keymando中执行系统命令

> ID：11508017
> 
> 赞同：0
> 
> 时间：2012-07-16T15:57:58.367
> 
> 标签：keymando

我需要能够通过 Keymando 强制“检测显示”。我没有看到任何有关如何执行系统命令的示例。关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:13:12.537

您可以像在 ruby​​ 中一样使用反引号或 system() 来执行此操作。

例如：

```
map "<Ctrl-u>" do 
  `osascript -e 'set volume output volume (output volume of (get volume settings) + 7)'`
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-18T06:13:01.570

感谢 Kevin 和这篇[文章](http://raviudeshi.com/2011/03/automatically-detect-displays)，我使用这个脚本完成了这项工作。希望这对将来的某人有所帮助。

```
# Detect Displays
map "<Cmd-Ctrl-d>" do
  `osascript -e '
    tell application "System Preferences" to activate
    tell application "System Events"
      tell process "System Preferences"
        click menu item "Displays" of menu "View" of menu bar 1
        tell button "Detect Displays" of window 1 to click
      end tell
    end tell
    tell application "System Preferences" to quit
  '`
end 
```

# drupal - 将产品添加到 ubercart 时 eva 出错：注意：未定义变量：_eva_extract_entity_from_build() 中的实体

> ID：11508019
> 
> 赞同：1
> 
> 时间：2012-07-16T15:58:06.783
> 
> 标签：drupal, drupal-7, ubercart

不确定这个问题是否属于 eva 模块或 ubercart。该错误指向 eva 模块，但在使用 ubercart 时生成。

当用户将商品添加到 ubercart 结账时，就会出现此问题。

我使用 profile2/profile reg 路径来创建允许成员注册某些角色的自定义注册页面。角色和用户系统都基于高级会员网站，因此用户必须付费才能访问，注册后他们将被引导到超级购物车，他们必须完成支付才能被分配角色。将用户定向到 ubercart 并将会员类型添加到购物车后，就会出现此错误

注意：未定义的变量：_eva_extract_entity_from_build() 中的实体（/path-to-site/sites/all/modules/eva/eva.module 的第 148 行）。该行与此功能有关

```
function _eva_extract_entity_from_build($build) {
 // EntityAPI often sticks stuff in here.
 if (!empty($build['#entity'])) {
  return $entity;
 }

 // Other entities stick them here!
 elseif (!empty($build['#' . $build['#entity_type']])) {
  return $build['#' . $build['#entity_type']];
 }

   // Some entities are naughty.
     elseif ($build['#entity_type'] == 'user') {
   return $build['#account'];
   }
   elseif ($build['#entity_type'] == 'taxonomy_term') {
     return $build['#term'];
  }

     return FALSE;
  } 
```

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:49:41.217

这是去年在他们的开发分支中[明显修复](http://drupal.org/node/1278742)的 EVA 模块的一个错误。该行`return $entity;`应该是`return $build['#entity'];`.

# arrays - Matlab Simulink - 如何从我的 2 级 S 函数输出数组？

> ID：11508022
> 
> 赞同：0
> 
> 时间：2012-07-16T15:58:13.253
> 
> 标签：arrays, matlab, simulink

我有一个 S 函数，它将数组作为 excel 文件的输入，并使用数组进行计算。S 功能块中的最终结果是一个 Nx1 数组。我尝试将 Nx1 数组分配给 sFunc.OutputPort(1).Data，但它给了我错误，说我正在尝试将长度为 N 的向量分配给长度为 1 的向量。

我希望能够输出数组并将其馈送到 Simulink 中的另一个 S 函数和范围以针对另一个数组（时间）绘制数据。

任何帮助将不胜感激！</p>

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T15:15:58.237

对于 2 级 M 文件 s-function，您应该在 setup() 函数中明确指定 Outport 尺寸：

```
function setup(block)
....
block.OutputPort(1).Dimensions       = [N 1]; 
```

然后你可以在输出函数中像这样输出你的数组：

```
function Output(block)
...
block.OutputPort(1).Data = ones(N,1); 
```

我在一个虚拟的 L-2 MS-Fcn 中尝试了这个，它工作得很好......

# javascript - 使用 Object.freeze() 扩展函数对象 - 无法添加字段

> ID：11508028
> 
> 赞同：1
> 
> 时间：2012-07-16T15:58:31.237
> 
> 标签：javascript, jquery

很好奇为什么下面的代码会给出如此“奇怪”的结果：

```
var f = function() {}
$.extend(f, Object.freeze({foo1:"bar1"})); 
```

在 Chrome 中输入（请查看更新 - 它位于*Chromium*中，而不是来自此处和下方的*Chrome ）控制台：*

```
> f.foo1 
```

Chrome 控制台中的结果是：

```
> undefined 
```

此外，尝试以下方法：

```
$.extend(f, {foo2:Object.freeze([1,2,3])}); 
```

在 Chrome 控制台中输入：

```
> f.foo2 
```

结果更奇怪：

```
> function Object() { [native code] } 
```

我究竟做错了什么？为什么使用`Object.freeze()`会产生这些影响？

**更新**：不在*Chrome*中，但在*Chromium 18*中（在撰写本文时 Ubuntu 上的最新版本）。我想这是一个实现错误。接受唯一的答案，尽管效果仍然可以在我的浏览器上重现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:07:04.593

我认为这不像你描述的那样工作：[看看这里的 jsfiddle](http://jsfiddle.net/eqnq5/)

它像这样实现您的代码：

```
var f = function() {}
$.extend(f, Object.freeze({
  foo1: "bar1"
}));

$.extend(f, {
  foo2: Object.freeze([1, 2, 3])
});

$(document).ready(function() {
  document.getElementById('div').innerHTML = f.foo1.toString() + '<br/>' + f.foo2.toString()
});​ 
```

[对象冻结](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/freeze)不会阻止将属性和函数添加到您的函数`f`中。它只是冻结你实际冻结的对象。jQuery`extend`采用第一个参数并使用第二个参数对其进行扩展，因此不会触及您案例中的冻结对象。

# android - 如果用户向下滚动，TextView 如何永远不会离开屏幕？

> ID：11508041
> 
> 赞同：2
> 
> 时间：2012-07-16T15:58:59.297
> 
> 标签：android, layout, scrollview

我是一名 android 中级开发人员，我需要有人过期才能在我的内容活动中发挥作用；

这是我的内容活动：

```
<ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
  ....
 // How this TextView never go out of the screen if the user scroll Down
  <TextView ... />  
  ....
</ScrollView> 
```

*我做了什么 ：

```
 <FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
   android:layout_height="fill_parent"
    android:orientation="vertical" >

  <TextView ... android:visibility="gone" />

    <ScrollView
     android:layout_width="match_parent"
    android:layout_height="match_parent" >
    ....
  // 
 <TextView ...android:visibility="visible"/>
  ....
  </ScrollView>
 </FrameLayout> 
```

我想过有 2 个 TextView，一个在顶部不可见，另一个可见。当用户向下滚动并且在第二个 TextView 消失之前，我将第一个 textView 设置为可见。

这是一个好方法吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:37:11.533

关注这个帖子，真的很好。请注意，从那里你可以做一些很棒的事情！ [干得好 ：）](http://wiresareobsolete.com/wordpress/2011/09/synchronizing-scrollview/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:04:29.427

根据我从您的问题中了解到的情况，您正在寻找“将您的 textView 放在 ScrollView 之外并在 TextView 和 ScrollView 之间建立相对布局关系，这样 TextView 将固定在顶部位置”。谢谢

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView"
        android:layout_alignParentTop="true"
        android:text="VISIBLE EVERY TIME"
        android:visibility="visible" 
         android:layout_width="match_parent"
        android:layout_height="50dp"
        />

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_below="@+id/textView" >
    </ScrollView>

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:06:43.357

尝试将 TextView 放在 scrollView 之外。IE。

```
<LinearLayout> 
<EditText /> 
    <LinearLayout> 
       <ScrollView></ScrollView>  
    </LinearLayout> 
</Linearlayout> 
```

试一试，对不起格式

# ruby-on-rails - 使用 OmniAuth 设计还是直接使用 Omniauth？

> ID：11508047
> 
> 赞同：0
> 
> 时间：2012-07-16T15:59:22.757
> 
> 标签：ruby-on-rails, devise, omniauth

我目前在我的 Rails 应用程序中有一个简单的手动编码登录系统。现在，我希望通过 OmniAuth 集成 Facebook 登录（似乎是最好的方法）

但是，我一直看到 Devise 成为处理登录的一种流行方式，并与它一起实现了 OmniAuth。

如果我现在对我的登录系统很满意，是否有任何理由使用 Devise？它是否为 OmniAuth 提供了任何额外的功能/可扩展性或使其更易于使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T19:39:49.090

如果您是 railscasts 订阅者，请查看[http://railscasts.com/episodes/235-devise-and-omniauth-revised](http://railscasts.com/episodes/235-devise-and-omniauth-revised)

Devise 确实为omniauth 提供了一些方便的钩子，所以这是使用devise 的一个优点。话虽如此，如果您对身份验证感到满意，那么您可以简单地将omniauth 构建为单独的身份验证方法，并自己处理任何重叠。另请查看[http://railscasts.com/episodes/241-simple-omniauth](http://railscasts.com/episodes/241-simple-omniauth)。

祝你好运！

# mysql - 使用“重新索引”数组更新 MySQL 数据库

> ID：11508050
> 
> 赞同：1
> 
> 时间：2012-07-16T15:59:29.860
> 
> 标签：mysql, arrays

我正在做一个项目，我需要用数组的值更新数据库。起始值必须为 1，而不是 0，以便使用更新查询选择正确的数据库条目。

当我打印数组（见下文）时，结果以值 1 开始返回，但数据库未正确更新。数据库仍在使用数组的 0 值进行更新。

```
foreach($rowPrice as $priceID => $price) {
 $rowPrice = array_combine(range(1, count($rowPrice)), array_values($rowPrice));
  mysql_query("UPDATE ---- SET price='$price' WHERE id='$priceID' AND store_id='$store' LIMIT 1") or die (mysql_error());
} 
```

这是打印时数组的一部分。这部分正在工作，但不能通过更新查询进行翻译。

![大批](../Images/b9aaa8af62f5ead4be0d6cb5a8cdca1e.png)

这就是更新数据库中的条目的方式。

![数据库](../Images/2679d6498c911eec061b08c33d2662b5.png)

如您所见，查询仅插入从 2 开始的数组值。

我究竟做错了什么？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:23:55.437

在开始迭代之前`$rowPrice` **重新索引。**

```
$rowPrice = array_combine(range(1, count($rowPrice)), array_values($rowPrice));
foreach($rowPrice as $priceID => $price) {
    mysql_query(...);
} 
```

然而，这种方法似乎很脆弱，因为它假设了数组中的值与数据库中的 ID 之间的关联。最好在数组中包含原始 ID，以便您可以在更新期间引用它们。

# mysql - 获取每个帖子的第一条评论

> ID：11508051
> 
> 赞同：1
> 
> 时间：2012-07-16T15:59:32.370
> 
> 标签：mysql, django, model

我使用 django 评论系统，只想获取帖子的第一条评论。

```
mysql> desc django_comments ;
+-----------------+--------------+------+-----+---------+----------------+
| Field           | Type         | Null | Key | Default | Extra          |
+-----------------+--------------+------+-----+---------+----------------+
| id              | int(11)      | NO   | PRI | NULL    | auto_increment |
| content_type_id | int(11)      | NO   | MUL | NULL    |                |
| object_pk       | longtext     | NO   |     | NULL    |                |
| site_id         | int(11)      | NO   | MUL | NULL    |                |
| user_id         | int(11)      | YES  | MUL | NULL    |                |
| user_name       | varchar(50)  | NO   |     | NULL    |                |
| user_email      | varchar(75)  | NO   |     | NULL    |                |
| user_url        | varchar(200) | NO   |     | NULL    |                |
| comment         | longtext     | NO   |     | NULL    |                |
| submit_date     | datetime     | NO   |     | NULL    |                |
| ip_address      | char(15)     | YES  |     | NULL    |                |
| is_public       | tinyint(1)   | NO   |     | NULL    |                |
| is_removed      | tinyint(1)   | NO   |     | NULL    |                |
+-----------------+--------------+------+-----+---------+----------------+ 
```

我的帖子是 content_type_id = 48。

我想知道留下每个帖子（object_pk）的第一条评论（min submit_date）的用户。

有没有“django”的方式来做到这一点？还是需要使用原始 SQL？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:16:04.693

使用这样的函数：

```
def get_first_comment(post):
    from django.contrib.comments.models import Comment
    from django.contrib.contenttypes.models import ContentType
    ct = ContentType.objects.get_for_model(post)
    first_comments = Comment.objects.filter(
        content_type=ct,
        object_id=post.pk,
        ).order_by("submit_date")
    if first_comments:
        return first_comments[0]
    return None 
```

它为您的模型实例加载内容类型，然后按内容类型过滤评论，并按提交日期对它们进行排序。然后，如果查询不为空，它将采用第一条评论。

# php - 为什么我的基于递归的括号余额检查器不起作用？

> ID：11508053
> 
> 赞同：1
> 
> 时间：2012-07-16T15:59:35.420
> 
> 标签：php, syntax, recursion, parentheses

我正在尝试在 php 中实现[https://stackoverflow.com/a/2718114/1507339中描述的 C 括号平衡器](https://stackoverflow.com/a/2718114/1507339)

如下所示

* * *

```
function match ($string, $index)
{
    if (isset($string[$index]) == false){ return ""; }
    if ($string[$index] == "}") { return "}"; }
    if ($string[$index] == "{")
    {
        $closer = match($string, ++$index);
        if ($closer == "}"){
            return match($closer, ++$index);
    }
    return $index - 1;
    }
    return match($string, ++$index);
} 
```

它运行为

```
$string = "{hey}}";
echo match($string, 0); 
```

其中第一个没有闭合的开口大括号的位置被打印到屏幕上。这不会发生，我不确定为什么，有什么帮助吗？

# c# - 如何遍历用户定义列表数组中的元素 ?

> ID：11508059
> 
> 赞同：2
> 
> 时间：2012-07-16T16:00:02.610
> 
> 标签：c#, arrays, list

我有一个用户定义的列表

```
public class Level2
{
    public double price { get; set; }
    public int size { get; set; }

    public Level2(double price, int size)
    {
        this.price = price;
        this.size = size;
    }
} 
```

在我的程序中，我有这个片段，我循环遍历前 10 个元素

```
List<Level2> bid = new List<Level2>();

        for (int i = 0; i < 10; i++)
        {
            if (i < bid.Count && bid[i].price > bid[0].price - (20 * process.tickSize))
            {
                bidString = bidString + "," + bid[i].price.ToString() + "," + bid[i].size.ToString();
            }                
        } 
```

它编译并运行良好。现在我需要扩展我的程序并想将我的变量更改为数组类型，如下所示：

```
 List<Level2>[] bid = new List<Level2>[5]; 
```

我怎样才能改变我的循环，所以我可以循环通过第一个数组，即bid[0]？

请提供一些工作片段，非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:07:44.157

将所有出价替换为出价[0]

```
List<Level2>[] bid = new List<Level2>[5]; 

    for (int i = 0; i < 10; i++) 
    { 
        if (i < bid[0].Count && bid[0][i].price > bid[0][0].price - (20 * process.tickSize)) 
        { 
            bidString = bidString + "," + bid[0][i].price.ToString() + "," + bid[0][i].size.ToString(); 
        }                 
    } 
```

或者为出价数组使用不同的变量

```
List<Level2>[] bidArray = new List<Level2>[5]; 
```

然后将 bid 指定为第一个元素

```
List<Level2> bid = bidArray[0]; 
```

然后继续使用现有代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:06:18.187

为什么不这样使用 LINQ？

```
List<Level2>[] bidArray = new List<Level2>()[5];

List<Level2> bid = bidArray[0];
string bidstring = "";

double initialBid = (bid.ToArray())[0].price - (20 * process.tickSize);
IEnumerable<Level2> results = bid.Where( b => b.price > initialBid );

foreach( Level2 item in results ) {
    bidString += "," + item.price.ToString() + "," + item.size.ToString();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:27:38.940

```
List<Level2>[] bid2 = new List<Level2>[5];

foreach (List<Level2> level2List in bid2)
{   
    foreach (Level2 level2Item in level2List)
    {
    }
} 
```

我希望它应该适用于您的情况。

# android - Android：如何以编程方式根据其他位置设置 TextViews 位置？

> ID：11508061
> 
> 赞同：0
> 
> 时间：2012-07-16T16:00:06.823
> 
> 标签：android, textview

我想根据其他元素的位置将元素放在我的视图中。让我解释一下：首先，我有两个文本视图，我已经成功地将第二个（villeOffre）放在第一个（titreOffre）下面：

```
titreOffre = (TextView) findViewById(R.id.offreTitre);
titreOffre.setText(capitalizedString(offre.getTitle()));
villeOffre = (TextView) findViewById(R.id.offreVille);
villeOffre.setText(offre.getLocality());
infos = (TextView) findViewById(R.id.infos);

ViewTreeObserver vto = titreOffre.getViewTreeObserver();
vto.addOnGlobalLayoutListener(new OnGlobalLayoutListener(
{
    @Override
    public void onGlobalLayout()
    {
        FrameLayout.LayoutParams params = (FrameLayout.LayoutParams) villeOffre.getLayoutParams();
        params.setMargins(15,titreOffre.getBottom()+12,15,0);
        villeOffre.setLayoutParams(params);
        titreOffre.getViewTreeObserver().removeOnGlobalLayoutListener(this);
    }
}); 
```

这完美地工作，但现在我想放置第三个文本视图（信息），这取决于 villeOffre 位置。怎么做 ？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:33:50.443

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        rr = new RelativeLayout(this);

        b1 = new Button(this);
        b1.setId(R.id.Button01);
        recent = b1;
        b1.setText("Click me");
        rr.addView(b1);

        setContentView(rr);

        b1.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                tv1 = new TextView(can.this);
                tv1.setId((int)System.currentTimeMillis());
                lp = new RelativeLayout.LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT);
                lp.addRule(RelativeLayout.BELOW, recent.getId());
                tv1.setText("Time: "+System.currentTimeMillis());
                rr.addView(tv1, lp);
                recent = tv1;
            }
        });
    } 
```

# php - PHP 替换 Javascript 表单自动提交和重定向

> ID：11508064
> 
> 赞同：0
> 
> 时间：2012-07-16T16:00:13.830
> 
> 标签：php, post, curl, payment-gateway

我正在使用第三方提供商进行信用卡付款，他们需要通过表格发布数据，但是我传递的数据来自数据库，而不是来自填写表格的用户。

目前，我通过一个使用 JavaScript 自动提交的页面来解决这个问题，但是，虽然这可行，但它看起来并不专业。有没有办法让 PHP 发布到然后加载到浏览器中的页面？

```
<body onload="document.form1.submit()">
<form method="post" action="https://payment.provider.com/Servlet" id="form1" name="form1" target="_top">
    <input type="hidden" name="TRANSACTION_ID" value="<?php echo $transid; ?>" />
    <input type="hidden" name="AMOUNT" value="<?php echo $amount; ?>" />
    <input type="hidden" name="TERMINAL_ID" value="T04_000000000005" />
    <input type="submit" value="Click if not redirected" name="submitButton" />
</form>
</body> 
```

我知道 cURL 当然可以发布数据，但它需要响应。提交表单时，数据会发布到页面，但该页面随后会加载到浏览器中。发布数据后，需要将用户带到第三方提供商页面（该页面使用发布的值，因此我不能简单地进行重定向）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-12T05:02:19.627

是的，我已经找到了解决方案。

在我发现这个解决方案的过程中，我也遇到了一个新的发现。如果您使用计时器打开新页面，Chrome 会阻止该页面。如果您使用按钮打开新页面，Chrome 不会阻止它。

这是我想出的解决方案：

```
/** This is the script that will redraw current screen and submit to bank. */
echo '<script>'."\n" ;
echo 'function serverNotifySelected()'."\n" ;
echo '{'."\n" ;
echo '    window.open(\'\', \'BankPaymentScreen\');'."\n" ;
echo '    document.forms[\'bank_form\'].submit();'."\n" ;
echo '    document.forms[\'server_responder\'].submit();'."\n" ;
echo '}'."\n" ;
echo '</script>'."\n" ;

/** This form will be opened in a new window called BankPaymentScreen. */
echo '<form action="https://www.sandbox.bank.com/cgi-bin/webscr" name="bank_form" method="post" target="BankPaymentScreen">'."\n" ;
echo '<input type="hidden" name="cmd" value="_s-xclick">'."\n" ;
echo '<input type="hidden" name="custom" value="'.$transaction_start.'">'."\n" ;
echo '<input type="hidden" name="hosted_button_id" value="'.$single_product->hosted_button_id.'">'."\n" ;
echo '<table>'."\n" ;
echo '    <tr>'."\n";
echo '        <td><input type="hidden" name="'.$single_product->hide_name_a.'" value="'.$single_product->hide_value_a.'">Local</td>'."\n" ;
echo '    </tr>'."\n" ;
echo '    <tr>'."\n" ;
echo '        <td>'."\n" ;
echo '        <input type="hidden" name="'.$single_product->hide_name_b.'" value="'.$single_product->hide_value_b.'" />'.$single_product->short_desc.' $'.$adj_price.' USD'."\n" ;
echo '        </td>'."\n" ;
echo '    </tr>'."\n" ;
echo '</table>'."\n" ;
echo '<input type="hidden" name="currency_code" value="USD">'."\n" ;
echo '</form>'."\n" ;

/** This form will redraw the current page for approval. */
echo '<form action="ProductApprove.php" name="server_responder" method="post" target="_top">'."\n" ;
echo '<input type="hidden" name="trans" value="'.$transaction_start.'">'."\n" ;
echo '<input type="hidden" name="prod_id" value="'.$this->product_id.'">'."\n" ;
echo '</form>'."\n" ;

/** No form here just an input and a button.  onClick will handle all the forms */
echo '<input type="image" src="https://www.sandbox.bank.com/en_US/i/btn/btn_purchaseimmediateCC_LG.gif" border="0" alt="This Bank - The safer, easier way to pay!" onclick="serverNotifySelected()">'."\n" ;
echo '<img alt="" border="0" src="https://www.sandbox.bank.com/en_US/i/scr/pixel.gif" width="1" height="1">'."\n" ; 
```

上面的代码用于页面上的一个按钮。发生的情况是：您按下按钮，当前页面从 [product to purchase] 更改为 [pre-approval] 并打开一个新页面，该页面获得焦点，并传递给支付提供商。

这样，当用户完成支付服务提供商，并且用户只是关闭支付服务提供商的窗口，并且不使用 [返回您的网站] 按钮时，您的网站已准备就绪并在预批准屏幕中等待！

# php - 跨类的 PDO 对象

> ID：11508070
> 
> 赞同：3
> 
> 时间：2012-07-16T16:00:33.143
> 
> 标签：php, class, function, object, pdo

我正在寻找有关以下内容的一些反馈：

我目前有两个类，它们正在我的 PHP 应用程序中使用。

一个数据库连接类，当前正在使用`MySQL`（但正在切换到`PDO`）。

另一个需要数据库功能的类（具有多个功能）。

我正在寻找设计这个的最佳方法，我已经阅读了单例（评论非常复杂），阅读了简单地`new`为每个方法（类函数）声明对象的示例，以及将连接分配给的示例作为`__constructor`每个类的方法的一部分的私有变量（然后用 引用`$this->`）。

那么，其他人是如何做到的呢？我希望你能很好地举一个例子，也欢迎对其他人读过的内容发表意见。

我有 2 个单独的类，在两个单独的文件中。我想保持干净的代码，减少不必要的数据库开销，并避免任何可能被认为过时的东西（例如全局变量）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:03:41.710

`Database`负责连接的类应该**是连接到数据库、创建新的 PDO 实例并将其保存到自身的字段中的**类。

```
class Database {
    private $pdo;
    public __construct() {
        $this->pdo = new PDO(...);
    }
} 
```

第二个类，*它不关心数据库连接来自哪里，它只需要它工作*应该**注入`Database`类**：

```
class WorkerClass {
    private $db;
    public __construct(Database $db) {
        $this->db = $db;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:03:27.837

我一直在创建它，`__constructor`然后习惯于`$this->`得到它。这应该可以满足您的需求，但我鼓励您尝试不同的风格，看看哪种风格最有效。

我不会`new`每次都创建一个新对象，除非你有很好的理由。

# algorithm - 将表达式 ((A + B) * C – (D – E) ^ (F + G)) 转换为等效的前缀和后缀符号

> ID：11508076
> 
> 赞同：-3
> 
> 时间：2012-07-16T16:00:51.133
> 
> 标签：algorithm

我想将表达式转换`((A + B) * C – (D – E) ^ (F + G))`为等效的**前缀**和**后缀**表示法。你得到什么答案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:12:54.510

嗯，有很多步骤。由于这个问题到目前为止并没有反映你的进化，我只是给你一些提示

1.  定义考虑的操作
2.  优先考虑他们
3.  定义什么是表达式
4.  当表达式有括号和没有括号时你应该怎么做

这应该让你走上正轨

# php - mcrypt_decrypt - 奇怪的填充（不是默认值，不是 null）

> ID：11508084
> 
> 赞同：3
> 
> 时间：2012-07-16T16:01:13.020
> 
> 标签：php, cryptography, padding

我正在尝试使用带有以下代码的对称解密：

```
$encrypted = base64_decode($encryptedBase64String);
$returnText = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, key, $encrypted, MCRYPT_MODE_CBC, iv); 
```

我遇到了奇怪的结果（没有人质疑）。我不知道为什么方法`mcrypt_decrypt`返回带有填充的解密文本，其填充的字节值等于填充字符的数量。根据 php 手册，该方法应该用零值字节填充其返回值。

为了澄清这一点，我在下面放置了两个示例：

[以上`mcrypt_decrypt`pad 的调用返回字符串长度为 32]

**示例 1**

> 纯文本 = '文本'
> 
> 'text' 的长度为 4，因此填充的大小为 28 个字符（32 - 4）

所以我收到 returnText 为：

```
{\116\101\120\116\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28\28} 
```

**示例 2**

> '12345678901234567890'
> 
> 长度 = 20

```
{\49\50\51\52\53\54\55\56\57\48\49\50\51\52\53\54\55\56\57\48\12\12\12\12\12\12\12\12\12\12\12\12} 
```

我能做些什么来改变它？我在使用 rtrim("\0") 方法删除填充时遇到问题，因为填充不是空值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T16:04:49.103

如果要加密的字符串长度不正确，`mcrypt_encrypt`将用`\0`s 填充。加密您正在解密的字符串的人首先添加了自己的填充，因此 PHP 不必填充它。这种类型的填充称为[`PKCS7 padding`](http://en.wikipedia.org/wiki/Padding_%28cryptography%29#Byte_padding).

[要删除它，你可以尝试这样的事情（从这里](https://gist.github.com/1077723)偷走）：

```
$strPad = ord($returnText[strlen($returnText)-1]);
$returnText = substr($returnText, 0, -$strPad); 
```

# android - 硬件加速动态壁纸

> ID：11508085
> 
> 赞同：6
> 
> 时间：2012-07-16T16:01:14.460
> 
> 标签：android

我正在尝试创建一个可以利用 sdk 14 上的硬件加速的动态壁纸。但我创建的动态壁纸使用的是：

```
Canvas canvas = surfaceHolder.lockCanvas(); 
```

并且 Romain Guy 已经提到通过这种方法创建的 Canvas 不是硬件加速的。那么有没有另一种方法可以为 LWP 创建画布？

ps 我没有使用任何不受支持的硬件加速画布方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-04T12:51:47.470

考虑使用像 AndEngine 这样的图形引擎。使用 AndEngine，您的动态壁纸是硬件加速的，并且您拥有一个良好且灵活的框架。

这里有一个例子：[Andengine Livewallpaper 例子](http://www.andengine.org/forums/gles2/livewallpaper-example-with-gles2-extensions-t8490.html)

# django - Django，如何用 django-mptt 做 CRUD？

> ID：11508088
> 
> 赞同：3
> 
> 时间：2012-07-16T16:01:25.000
> 
> 标签：django, django-models, crud, django-mptt

我们如何使用**通用视图**和**django-mptt**实现 CRUD 功能？我进行了很多搜索，但找不到单个教程/示例代码。

假设我们有一个课程层次结构或类别层次结构，或类似的东西......我们如何添加/删除/更新/读取它们？

例如我有这个模型：

```
from django.db import models
from mptt.models import MPTTModel , TreeForeignKey

class Genre(MPTTModel):
    name            = models.CharField(max_length = 50 , unique = True)
    parent          = TreeForeignKey('self' , null = True , blank = True , related_name = 'children')

    class MPTTMeta:
        order_insertion_by = ['name'] 
```

这个views.py：

```
from django.views.generic.list_detail import object_list
from mp.models import Genre

def genres_list(request):
    ''' Shows all of the genres '''
    return object_list(request,
            queryset = Genre.tree.all() ,
            template_name = 'genres.html' ,
            # template_object_name = 'nodes' ## Adding "nodes" variable didn't solve the problem
    ) 
```

好吧...我收到此错误（错误在行号“5”中：{% recursetree nodes %}）：

```
Caught VariableDoesNotExist while rendering: Failed lookup for key [nodes] in u"[{'paginator': None, 'is_paginated': False, 'page_obj': None, 'nodes_list': [<Genre: Genre object>, <Genre: Genre object>, <Genre: Genre object>, <Genre: Genre object>]}, {'csrf_token': <django.utils.functional.__proxy__ object at 0x7f5bb810f090>}, {'perms': <django.utils.functional.__proxy__ object at 0x7f5bb810ff10>, 'messages': <django.contrib.messages.storage.user_messages.LegacyFallbackStorage object at 0x324af50>, 'user': ....................................

    <html>
2   
3       {% load mptt_tags %}
4       <ul>
5           {% recursetree nodes %}
6           <li>
7               {{node.name}} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-17T04:56:30.627

具有 MPTT 模型和基于类的通用视图的简单 CRUD 应用程序（Django 1.4[基于函数的实现已被弃用](https://docs.djangoproject.com/en/1.4/ref/class-based-views/)）。

让我们开始

**网址.py**

```
from django.conf.urls.defaults import patterns, include, url
from django.views.generic import DetailView, ListView, CreateView, UpdateView
from genre.models import Genre

urlpatterns = patterns('',
    url(r'detail/(?P<pk>\d+)', DetailView.as_view(model=Genre), name="genre_detail",),
    url(r'update/(?P<pk>\d+)', UpdateView.as_view(model=Genre), name="genre_update",),
    url(r'create', CreateView.as_view(model=Genre), name="genre_create",),
    url(r'list', ListView.as_view(model=Genre), name="genre_list",),
) 
```

**模型.py**

```
from django.core.urlresolvers import reverse
from django.db import models
from mptt.models import MPTTModel

class Genre(MPTTModel):
    name = models.CharField(max_length=50 , unique=True)
    parent = models.ForeignKey('self' , null=True , blank=True , related_name='children')

    def get_absolute_url(self):
        return reverse('genre_detail', kwargs={'pk': self.pk, })

    class MPTTMeta:
        order_insertion_by = ['name'] 
```

**模板/流派_detail.html**

```
<html>
<body>

<div>Object: {{ object }}</div>
<div>Object's name: {{ object.name }}</div>
<div>Object's parent: {{ object.parent }}</div>

</body>
</html> 
```

**模板/流派_form.html**

```
<html>
<body>

<form action="" method="post">
{% csrf_token %}
{{ form.as_ul }}

<button>save</button>
</form>
</body>
</html> 
```

**模板/流派列表.html**

```
{% load mptt_tags %}
<html>
<body>
<ul class="root">
    {% recursetree object_list %}
        <li>
            {{ node.name }}
            {% if not node.is_leaf_node %}
                <ul class="children">
                    {{ children }}
                </ul>
            {% endif %}
        </li>
    {% endrecursetree %}
</ul>
</body>
</html> 
```

就是这样。

我今天有一些空闲时间，并在 github [https://github.com/kaygorodov/simple-crud-mptt](https://github.com/kaygorodov/simple-crud-mptt)上分享了这个项目。

如何定义自己的基于类的视图？

**流派/views.py**

```
from django.view.generic import UpdateView
class MyCustomUpdateView(UpdateView):
    model = Genre

    def get_form_kwargs(self):
        """
        Returns the keyword arguments for instanciating the form.
        """
        kwargs = super(MyCustomUpdateView, self).get_form_kwargs()
        kwargs.update({'my_first_param_to_init_form': 1,
                      'my_second_param_to_init_form': 2,
        })
        return kwargs 
```

**流派/urls.py**

```
url(r'update/(?P<pk>\d+)', MyCustomUpdateView.as_view(), name="genre_update",), 
```

# background - 在 Cucumber 文件之间共享背景？

> ID：11508091
> 
> 赞同：3
> 
> 时间：2012-07-16T16:01:42.527
> 
> 标签：background, cucumber

我有一些 Cucumber 场景，为此我创建了以下文件：

*   create_extended_search.feature
*   activate_extended_search.feature
*   edit_extended_search.feature
*   delete_extended_search.feature

在这些文件中，我有几个场景。

其中三个文件使用相同的背景，如果能够将其放在一个文件中（例如`support/backgrounds.rb`），然后从功能文件中引用它，那就太好了。

这有可能吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:08:50.560

我相信您必须创建一个由当前背景中的步骤组成的步骤。然后在后台为每个功能调用该步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:05:29.183

Cucumber 中没有“包含”功能文件的概念。正如贾斯汀指出的那样，您可以创建一个代表您想要作为背景的步骤，并在适当的地方调用它。另一种方法是使用 Before 挂钩在您使用特定标签标记的场景之前执行某些任务。

就个人而言，我会将此问题视为一个危险信号，并开始询问我的功能文件是否以最佳方式拆分。通常，如果我发现自己无法包含其他功能文件，或者相反，希望我可以从运行我的背景中排除某些场景，这是一个非常强烈的迹象，表明我的功能文件切得太细了，或者我正在尝试补习不相关的功能在一起，需要进一步拆分。

# python - 使用 PyPI + 操作系统级依赖项打包 Python 应用程序

> ID：11508093
> 
> 赞同：6
> 
> 时间：2012-07-16T16:01:43.127
> 
> 标签：python, packaging, pip, pypi

我想为 PyPI 打包一个 Python 科学应用程序。我的问题是它依赖于 PyPI 级别的 deps（例如 numpy、scipy 等）以及其他必须在操作系统级别处理的：wxPython 和 Python-VTK（例如，在 Ubuntu 上使用 apt-get，在 homebrew 上OSX 等）。

我想知道执行此操作的理想策略是什么，特别是哪种包装系统最适合（我目前更喜欢分发）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:23:13.263

`distribute`是一个`setuptools`带有更好文档的分支。你基本上有`distutils`(stdlib) 和`setuptools`作为你的选择。由于`distutils`不允许您指定依赖项，`setuptools`因此只剩下。

您通常会列出所有依赖项，并清楚地记录安装过程（包括推送到 PyPI 的 long_description 字段）。包括操作系统级别的安装包，大多数发行版在安装这些包时都包含鸡蛋信息。

# php - 无法在 ajax url 中加载 Codeigniter 控制器

> ID：11508095
> 
> 赞同：1
> 
> 时间：2012-07-16T16:01:57.400
> 
> 标签：php, ajax, codeigniter

我想在 ajax url 中加载 codeigniter 的控制器。

这是codeigniter主视图头部的代码：

```
<script type="text/javascript">

        var x = 1;

        function cek(){
            $.ajax({
                url: "<?=base_url();?>cekPesan",
                cache: false,
                success: function(msg){
                    $("#notifikasi").html(msg);
                }
            });
            var waktu = setTimeout("cek()",3000);
        }

        $(document).ready(function(){
            cek();
            $("#pesan").click(function(){
                $("#loading").show();
                if(x=1){
                    $("#pesan").css("background-color","#efefef");
                    x = 0;
                }else{
                    $("#pesan").css("background-color","#4B59a9");
                    x = 1;
                }
                $("#info").toggle();
                //ajax untuk menampilkan pesan yang belum terbaca
                $.ajax({
                    url: "<?=base_url();?>lihatPesan",
                    cache: false,
                    success: function(msg){
                        $("#loading").hide();
                        $("#konten-info").html(msg);
                    }
                });

            });
            $("#content").click(function(){
                $("#info").hide();
                $("#pesan").css("background-color","#4B59a9");
                x = 1;
            });
        });

    </script> 
```

当我运行它时，页面无法加载。我不明白为什么。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-25T10:38:04.653

检查，您是否加载了 URL 帮助程序。并且在您的应用程序中是否允许使用 php 短标签。

# css - div 位置：绝对，宽度为 100%

> ID：11508096
> 
> 赞同：0
> 
> 时间：2012-07-16T16:02:00.480
> 
> 标签：css, html

我正在尝试`div`使用`position:absolute; top:50px; left:100px;`属性。问题是这个 div 只占用**里面**的`width`内容，但我希望这个 div 填满整个页面`width`，即使内容不是。

如果我添加`width:100%`，则 div 变为`100%`浏览器的总宽度，并在底部带来滚动。

有没有办法用 填充页面的其余宽度`position:absolute`？

我想填充其余宽度的 div 的 CSS

```
.container{position:absolute;top:50px;left;100px;} 
```

它在[http://jsfiddle.net/BxLy6/ 上供](http://jsfiddle.net/BxLy6/)您查看。

请建议我如何填写页面的其余部分`position:absolute`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:05:40.933

添加

```
bottom: 0; 
```

那应该这样做。 [http://jsfiddle.net/BxLy6/4/](http://jsfiddle.net/BxLy6/4/)

# jquery - 当用户按下浏览器上的后退按钮时，如何强制重新加载 Ajax 内容？

> ID：11508101
> 
> 赞同：1
> 
> 时间：2012-07-16T16:02:23.487
> 
> 标签：jquery, ajax, caching, browser-cache

我有一个产品列表页面，其中列出了产品、分页和一些使用 Ajax 的过滤器。

这一切都很好，但是我发现当用户单击产品然后使用后退按钮返回产品列表页面时，Ajax 内容无法正确加载。如果我刷新页面就可以了。

我已经在产品页面上添加了一个动态后退按钮，该按钮可以返回并正确加载，但我需要尝试捕获用户点击后退按钮的时间。

我尝试了以下方法：

*   使缓存控件必须重新验证，因此当浏览器返回时页面被刷新。
*   捕捉用户点击产品页面的事件并使用后退按钮使用的链接重定向他们。

不幸的是，这些都不适合我，所以我想知道是否有人有任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-30T21:40:09.400

这是我的解决方案，当点击后退浏览器按钮时强制浏览器刷新页面，它适用于我：

```
//disable ajax cache it solves that the Ajax content doesn't load properly when back button is clicked
$.ajaxSetup({ cache: false });
//force reload page on back browser button
window.onpopstate = function(event) {
    if(event && event.state) {
        location.reload()
    }
} 
```

# c# - 实体框架中的导航属性是什么

> ID：11508103
> 
> 赞同：12
> 
> 时间：2012-07-16T16:02:28.930
> 
> 标签：c#, .net, entity-framework

我是实体框架的新手。在Visual Studio创建模型图的时候，我们主要可以看到Entities.Propertie和Navigation Properties这两个东西，那么这些Navigation Properties是什么？如何使用它们？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-07-16T16:05:36.170

导航属性表示与主体实体相关的实体。外键通常由导航属性表示。

例如：如果您有两个表格 Invoice 和 invoice items 并且这些表格具有关系 1-> many，那么您将在发票实体中找到一个导航属性，其中列出了与发票相关的所有发票项目。
希望能帮助到你。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-16T16:05:23.830

[实体框架中的导航属性](http://msdn.microsoft.com/en-us/library/bb738520.aspx)提供了一种在两种实体类型之间导航关联的方法。每个对象都可以为它参与的每个关系都有一个导航属性。导航属性允许您在两个方向上导航和管理关系，如果多重性为 1 或零或一，则返回 EntityReference；如果多重性很多，则返回 EntityCollection。

当您使用 Entity Framework 生成的类时，将为参与关系的对象创建导航属性。

更新：这里是书籍、作者和出版商之间关系的很好的[导航属性示例。](http://msdn.microsoft.com/en-us/library/ee382841.aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-16T16:04:37.560

Navigation Property 主要用于 EF 中的外键关系。即用户到角色，产品到类别等。

因此，如果您有带有 OrderLines 的订单，导航属性将显示 Order_OrderLineItems，您可以访问与其关联的完整行项目。

看看这里的一些解释，[什么是实体框架中的导航属性？](https://stackoverflow.com/questions/1262307/what-are-navigation-properties-in-entity-framework-for)

# asp.net-mvc - 如何在 MVC 下拉列表中插入“请选择”项而不导致验证

> ID：11508106
> 
> 赞同：0
> 
> 时间：2012-07-16T16:02:45.193
> 
> 标签：asp.net-mvc, asp.net-mvc-3, validation, drop-down-menu

好的dokey，我有以下设置。

**模型**

```
public class SupplyType
{
    [Key]
    public int SupplyTypeId { get; set; }
    public string SupplyTypeName { get; set; }

}

public class Supply
{
    [Display(Name = "What type of supply is this from?")]
    public int SupplyTypeId { get; set; }
    public IEnumerable<SupplyType> SupplyType { get; set; }
} 
```

**控制器**

```
 public ActionResult (Guid id)
    {
            var model = Model(id);
            model.Supply.SupplyType = db.SupplyTypes.ToList();
            return View(model.);    
    } 
```

我现在可以**查看**以下内容

```
 //Good view
      <div class="editor-label">
                @Html.LabelFor(model => model.SupplyTypeId, "SupplyType")
            </div>
            <div class="editor-field">
       @Html.DropDownListFor(x => x.SupplyTypeId, new SelectList(Model.SupplyType, "SupplyTypeId", "SupplyTypeName"))
          @Html.ValidationMessageFor(model => model.SupplyTypeId)
        </div> 
```

这工作得很好而且花花公子，如果我不通过触摸它，那么验证不会触发，我可以点击我页面上的发布按钮。

但是，当我尝试在列表中实施“-请选择--”项目时，验证会发生并且我被卡住了，无法单击我的帖子按钮之一..嘘！

```
 //Bad view
  <div class="editor-label">
            @Html.LabelFor(model => model.SupplyTypeId, "SupplyType")
        </div>
        <div class="editor-field">
   @Html.DropDownListFor(x => x.SupplyTypeId, new SelectList(Model.SupplyType, "SupplyTypeId", "SupplyTypeName"), " -- Please Select -- ")
      @Html.ValidationMessageFor(model => model.SupplyTypeId)
    </div> 
```

我仍然需要下拉菜单中的“-- Please Select --”项，但如果尚未设置，我不希望验证生效。

关于如何在不完全关闭验证的情况下解决这个问题的任何想法？这样做的原因是下拉列表将有条件地显示，因此可能不需要填充。

任何帮助都得到了很大的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:08:35.580

对于您这样的特定要求，我认为简单的方法是添加`-- Please Select --`为新`List Item`值`SupplyTypID`as `0`。

```
public ActionResult (Guid id)
{
        var model = Model(id);
        model.Supply.SupplyType = db.SupplyTypes.ToList();
        model.Supply.SupplyType.Add(new 
                   {
                     SupplyTypID=0, SupplyTypeName=" Please Select"
                   });

        return View(model);    
} 
```

# search - 带搜索的 TreelistEx 字段

> ID：11508109
> 
> 赞同：1
> 
> 时间：2012-07-16T16:02:49.703
> 
> 标签：search, lucene, sitecore, treelist

我有一个客户要求修改 treelistex 字段以在左侧内容树列表框的顶部包含一个搜索框。这将允许搜索项目，而不是用户必须单击内容树。这个 Sitecore 安装有数以千计的页面，因此点击需要时间并知道页面项目存在的位置。

我怎样才能实现这个功能？我将使用 Sitecore 的 _system Lucene 索引来搜索各种项目。需要根据项目名称、标题字段、内容字段和日期字段来搜索项目。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:06:30.850

有趣的是，前几天类似这样的内容被发布到共享源！查看来自共享源的[专业树列表。](http://trac.sitecore.net/SpecializedTreelist)

> 使用内置的 Sitecore Lucene 索引进行搜索

![在此处输入图像描述](../Images/d85e252b1295ae616e20c72ed8fbeec9.png)

# celery - 重试属于链的 celery 失败的任务

> ID：11508112
> 
> 赞同：19
> 
> 时间：2012-07-16T16:03:03.493
> 
> 标签：celery, django-celery, celery-task

我有一个运行一些任务的芹菜链。每个任务都可能失败并重试。请参阅下面的快速示例：

```
from celery import task

@task(ignore_result=True)
def add(x, y, fail=True):
    try:
        if fail:
            raise Exception('Ugly exception.')
        print '%d + %d = %d' % (x, y, x+y)
    except Exception as e:
        raise add.retry(args=(x, y, False), exc=e, countdown=10)

@task(ignore_result=True)
def mul(x, y):
    print '%d * %d = %d' % (x, y, x*y) 
```

和链条：

```
from celery.canvas import chain
chain(add.si(1, 2), mul.si(3, 4)).apply_async() 
```

运行这两个任务（并假设没有失败），你会得到/看到打印：

```
1 + 2 = 3
3 * 4 = 12 
```

但是，当添加任务第一次失败并在随后的重试调用中成功时，链中的其余任务不会运行，即添加任务失败，链中的所有其他任务都不会运行，几秒钟后，添加任务再次运行并成功，链中的其余任务（在本例中为 mul.si(3, 4)）不运行。

celery 是否提供了一种方法来从失败的任务中继续失败的链？如果不是，那么完成此任务并确保链的任务以指定的顺序运行并且仅在前一个任务成功执行之后（即使该任务重试几次）的最佳方法是什么？

**注1：**这个问题可以通过做

```
add.delay(1, 2).get()
mul.delay(3, 4).get() 
```

但我有兴趣了解为什么链不适用于失败的任务。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-25T17:55:10.230

你发现了一个错误:)

[在https://github.com/celery/celery/commit/b2b9d922fdaed5571cf685249bdc46f28acacde3](https://github.com/celery/celery/commit/b2b9d922fdaed5571cf685249bdc46f28acacde3)中修复 将成为 3.0.4 的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-23T04:37:40.033

我也有兴趣了解为什么链不适用于失败的任务。

我挖掘了一些芹菜代码，到目前为止我发现的是：

实现发生在 app.builtins.py

```
@shared_task
def add_chain_task(app):
    from celery.canvas import chord, group, maybe_subtask
    _app = app

    class Chain(app.Task):
        app = _app
        name = 'celery.chain'
        accept_magic_kwargs = False

        def prepare_steps(self, args, tasks):
            steps = deque(tasks)
            next_step = prev_task = prev_res = None
            tasks, results = [], []
            i = 0
            while steps:
                # First task get partial args from chain.
                task = maybe_subtask(steps.popleft())
                task = task.clone() if i else task.clone(args)
                i += 1
                tid = task.options.get('task_id')
                if tid is None:
                    tid = task.options['task_id'] = uuid()
                res = task.type.AsyncResult(tid)

                # automatically upgrade group(..) | s to chord(group, s)
                if isinstance(task, group):
                    try:
                        next_step = steps.popleft()
                    except IndexError:
                        next_step = None
                if next_step is not None:
                    task = chord(task, body=next_step, task_id=tid)
                if prev_task:
                    # link previous task to this task.
                    prev_task.link(task)
                    # set the results parent attribute.
                    res.parent = prev_res

                results.append(res)
                tasks.append(task)
                prev_task, prev_res = task, res

            return tasks, results

        def apply_async(self, args=(), kwargs={}, group_id=None, chord=None,
                task_id=None, **options):
            if self.app.conf.CELERY_ALWAYS_EAGER:
                return self.apply(args, kwargs, **options)
            options.pop('publisher', None)
            tasks, results = self.prepare_steps(args, kwargs['tasks'])
            result = results[-1]
            if group_id:
                tasks[-1].set(group_id=group_id)
            if chord:
                tasks[-1].set(chord=chord)
            if task_id:
                tasks[-1].set(task_id=task_id)
                result = tasks[-1].type.AsyncResult(task_id)
            tasks[0].apply_async()
            return result

        def apply(self, args=(), kwargs={}, **options):
            tasks = [maybe_subtask(task).clone() for task in kwargs['tasks']]
            res = prev = None
            for task in tasks:
                res = task.apply((prev.get(), ) if prev else ())
                res.parent, prev = prev, res
            return res
    return Chain 
```

您可以看到最后`prepare_steps` `prev_task`链接到下一个任务。当 prev_task 失败时，不会调用下一个任务。

我正在测试将 prev 任务中的 link_error 添加到下一个任务：

```
if prev_task:
    # link and link_error previous task to this task.
    prev_task.link(task)
    prev_task.link_error(task)
    # set the results parent attribute.
    res.parent = prev_res 
```

但是，下一个任务必须处理这两种情况（也许，除非它被配置为不可变，例如不接受更多参数）。

我认为链可以通过允许一些这样的语法来支持这一点：

`c = chain(t1, (t2, t1e), (t3, t2e))`

意思是：

`t1` `link`去`t2`和`link_error`去`t1e`

`t2` `link`去`t3`和`link_error`去`t2e`

# ios - 有一个空的 iOS tableview 外观（但填充时会发生变化）？

> ID：11508114
> 
> 赞同：0
> 
> 时间：2012-07-16T16:03:09.820
> 
> 标签：ios, uitableview, user-interface

您好我正在尝试创建一个矩形区域（tableView），当它没有单元格时将只是一个背景颜色。然后当它有单元格时，单元格背景可以不同并且分隔符变得可见。这个想法可以 在第二个屏幕截图的[http://itunes.apple.com/us/app/spendings/id473857206?mt=8中看到。](http://itunes.apple.com/us/app/spendings/id473857206?mt=8)我可以通过将表格的背景颜色和单元格设置为不同的颜色来接近，但是当没有单元格时表格会折叠。该链接中的屏幕截图没有显示这一点，但是当没有项目时，它只是一个空矩形。即使没有单元格，如何保持表格的尺寸？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:23:46.893

您可以尝试将分隔符颜色设置为 clearColor 以便单元格为空时不可见，例如：

```
if([tableView numberOfRowsInSection:0]==0)
{
    tableView.separatorColor = [UIColor clearColor];
} 
```

# android - android - 如何检测按钮的持有？

> ID：11508115
> 
> 赞同：0
> 
> 时间：2012-07-16T16:03:19.943
> 
> 标签：android, button

在android中，如何检测按钮是否被按住？我想要做的是：如果一个按钮被按住 2 秒然后调用某个函数，如果它保持少于 2 秒然后调用另一个函数。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:07:27.820

除了 setOnClickListener 之外，您还可以为 View 对象定义[setOnLongClickListener](http://developer.android.com/reference/android/view/View.html#setOnLongClickListener%28android.view.View.OnLongClickListener%29)方法。

# android - Android NDK 中 System.loadLibrary 中的 java.lang.NoClassDefFoundError

> ID：11508119
> 
> 赞同：0
> 
> 时间：2012-07-16T16:03:33.920
> 
> 标签：android, java-native-interface, native, android-ndk

完全迷路了，在NDK错误中度过了几天，请帮助

我正在尝试从我的 java 类中调用用 C 编写的函数以在 android 应用程序中使用它。但是当我运行应用程序时，我得到以下 logcat

> D/mytag(27455): before_lib
> D/dalvikvm(27455): 试图加载库 /data/data/c.google.facedetect/lib/libface-detect.so 0x40517490
> D/dalvikvm(27455): 添加共享库 /data /data/c.google.facedetect/lib/libface-detect.so 0x40517490
> I/native_tag(27455)：Jni_OnLoad_Called
> W/dalvikvm(27455)：JNI_OnLoad 在 /data/data/c.google 中返回错误版本 (-1)。 facedetect/lib/libface-detect.so 0x40517490
> W/dalvikvm(27455)：异常 Ljava/lang/NoClassDefFoundError；初始化 Lc/google/facedetect/FaceDetect 时抛出；
> W/dalvikvm(27455): 类初始化在 newInstance 调用中失败 (Lc/google/facedetect/FaceDetect;)
> W/dalvikvm(27455): threadid=1: 线程退出未捕获异常 (group=0x40018578)
> E/AndroidRuntime(27455): 致命异常: 主要
> E/AndroidRuntime(27455): java.lang.ExceptionInInitializerError
> E/AndroidRuntime(27455): at java.lang.Class.newInstanceImpl(Native Method)
> E/AndroidRuntime(27455): at java.lang.Class.newInstance(Class.java:1409)
> E/AndroidRuntime(27455)：在 android.app.Instrumentation.newActivity(Instrumentation.java:1021)
> E/AndroidRuntime(27455)：在 android.app.ActivityThread。 performLaunchActivity(ActivityThread.java:1565)
> E/AndroidRuntime(27455): 在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
> E/AndroidRuntime(27455): 在 android.app.ActivityThread.access$1500(ActivityThread.java :117)
> E/AndroidRuntime(27455): 在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
> E/AndroidRuntime(27455): 在 android.os.Handler.dispatchMessage(Handler.java:99)
> E/AndroidRuntime( 27455): 在 android.os.Looper.loop(Looper.java:130)
> E/AndroidRuntime(27455): 在 android.app.ActivityThread.main(ActivityThread.java:3687)
> E/AndroidRuntime(27455): 在 java. lang.reflect.Method.invokeNative(Native Method)
> E/AndroidRuntime(27455): at java.lang.reflect.Method.invoke(Method.java:507)
> E/AndroidRuntime(27455): at com.android.internal.os .ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
> E/AndroidRuntime(27455): 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
> E/AndroidRuntime(27455): 在 dalvik.system.NativeStart.main(Native Method)
> E/AndroidRuntime(27455): Caused by: java.lang.NoClassDefFoundError: C
> E/AndroidRuntime(27455): at java.lang.Runtime。 nativeLoad(Native Method)
> E/AndroidRuntime(27455): at java.lang.Runtime.loadLibrary(Runtime.java:432)
> E/AndroidRuntime(27455): at java.lang.System.loadLibrary(System.java:554)
> E /AndroidRuntime(27455): 在 c.google.facedetect.FaceDetect.(FaceDetect.java:62)
> E/AndroidRuntime(27455): ... 15 更多
> E/AndroidRuntime(27455): 由: java.lang.ClassNotFoundException:加载器中的 C dalvik.system.PathClassLoader[/data/app/c.google.facedetect-1.apk]
> E/AndroidRuntime(27455): 在 dalvik.system.PathClassLoader.findClass(PathClassLoader.java:240)
> E/AndroidRuntime(27455): 在 java.lang.ClassLoader.loadClass(ClassLoader.java:551)
> E/AndroidRuntime(27455) : 在 java.lang.ClassLoader.loadClass(ClassLoader.java:511)
> E/AndroidRuntime(27455): ... 19 更多

包名是 c.google.facedetect

我的java类是FaceDetect.java，如下：

```
package c.google.facedetect;

import android.app.Activity;
.
.

public class FaceDetect extends Activity implements SurfaceHolder.Callback, Camera.PreviewCallback
{
.
.
    int[] argb8888 = new int[CAMERA_WIDTH * CAMERA_HEIGHT];

    static
    {
        Log.d("mytag", "before_lib");
        System.loadLibrary("face-detect");
        Log.d("mytag", "after_lib");
    }
    .
    .
    public void onCreate(Bundle savedInstanceState)
    {
    .
    .
        decodeYUV(argb8888, data, CAMERA_WIDTH, CAMERA_HEIGHT);
        .
        .
    }

    public static native void decodeYUV(int[] out, byte[] fg, int width, int height);
} 
```

我的 jni 生成的标头是 c_google_facedetect_FaceDetect.h 并放在 jni 文件夹中，如下所示：

```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class c_google_facedetect_FaceDetect */

#ifndef _Included_c_google_facedetect_FaceDetect
#define _Included_c_google_facedetect_FaceDetect
#ifdef __cplusplus
extern "C" {
#endif
#undef c_google_facedetect_FaceDetect_CAMERA_WIDTH
#define c_google_facedetect_FaceDetect_CAMERA_WIDTH 480L
#undef c_google_facedetect_FaceDetect_CAMERA_HEIGHT
#define c_google_facedetect_FaceDetect_CAMERA_HEIGHT 320L
/*
 * Class:     c_google_facedetect_FaceDetect
 * Method:    decodeYUV
 * Signature: ([I[BII)V
 */
JNIEXPORT void JNICALL Java_c_google_facedetect_FaceDetect_decodeYUV(JNIEnv *, jclass, jintArray, jbyteArray, jint, jint);

#ifdef __cplusplus
}
#endif
#endif 
```

我的C文件叫face-detect.c，放在jni文件夹下，内容如下：

```
#include <jni.h>
#include <stdio.h>
#include <android/log.h>

int* rgbData;
int rgbDataSize = 0;

JavaVM *cached_jvm;
jclass Class_C;
jmethodID MID_C_g;

JNIEXPORT void JNICALL Java_c_google_facedetect_FaceDetect_decodeYUV(
        JNIEnv * env, jobject obj, jintArray rgb, jbyteArray yuv420sp,
        jint width, jint height)
{
    int sz;
    int i;
    int j;
    int Y;
    int Cr = 0;
    int Cb = 0;
    int pixPtr = 0;
    int jDiv2 = 0;
    int R = 0;
    int G = 0;
    int B = 0;
    int cOff;
    int w = width;
    int h = height;
    sz = w * h;

    jbyte* yuv = yuv420sp;
    if (rgbDataSize < sz)
    {
        int tmp[sz];
        rgbData = &tmp[0];
        rgbDataSize = sz;
        //__android_log_write(ANDROID_LOG_INFO, "JNI", "alloc");
    }

    for (j = 0; j < h; j++)
    {
        pixPtr = j * w;
        jDiv2 = j >> 1;
        for (i = 0; i < w; i++)
        {
            Y = yuv[pixPtr];
            if (Y < 0)
                Y += 255;
            if ((i & 0x1) != 1)
            {
                cOff = sz + jDiv2 * w + (i >> 1) * 2;
                Cb = yuv[cOff];
                if (Cb < 0)
                    Cb += 127;
                else
                    Cb -= 128;
                Cr = yuv[cOff + 1];
                if (Cr < 0)
                    Cr += 127;
                else
                    Cr -= 128;
            }
            R = Y + Cr + (Cr >> 2) + (Cr >> 3) + (Cr >> 5);
            if (R < 0)
                R = 0;
            else
                if (R > 255)
                    R = 255;
            G = Y - (Cb >> 2) + (Cb >> 4) + (Cb >> 5) - (Cr >> 1) + (Cr >> 3)
                    + (Cr >> 4) + (Cr >> 5);
            if (G < 0)
                G = 0;
            else
                if (G > 255)
                    G = 255;
            B = Y + Cb + (Cb >> 1) + (Cb >> 2) + (Cb >> 6);
            if (B < 0)
                B = 0;
            else
                if (B > 255)
                    B = 255;
            rgbData[pixPtr++] = 0xff000000 + (B << 16) + (G << 8) + R;
        }
    }
    (*env)->SetIntArrayRegion(env, rgb, 0, sz, (jint *) &rgbData[0]);
}

JNIEXPORT jint JNICALL
JNI_OnLoad(JavaVM *jvm, void *reserved)
{
    JNIEnv *env;
    jclass cls;
    cached_jvm = jvm; /* cache the JavaVM pointer */

    __android_log_write(ANDROID_LOG_INFO, "native_tag", "Jni_OnLoad_Called");

    if ((*jvm)->GetEnv(jvm, (void **) &env, JNI_VERSION_1_2))
    {
        return JNI_ERR; /* JNI version not supported */
    }
    cls = (*env)->FindClass(env, "C");
    if (cls == NULL)
    {
        return JNI_ERR;
    }
    /* Use weak global ref to allow C class to be unloaded */
    Class_C = (*env)->NewWeakGlobalRef(env, cls);
    if (Class_C == NULL)
    {
        return JNI_ERR;
    }
    /* Compute and cache the method ID */
    MID_C_g = (*env)->GetMethodID(env, cls, "g", "()V");
    if (MID_C_g == NULL)
    {
        return JNI_ERR;
    }

    return JNI_VERSION_1_2;
} 
```

我的Android.mk文件放在jni文件夹下，内容如下：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := face-detect
LOCAL_SRC_FILES := face-detect.c

LOCAL_LDLIBS := -L$(SYSROOT)/usr/lib -llog 

include $(BUILD_SHARED_LIBRARY) 
```

我项目中的 libs/armeabi 文件夹包含 libface-detect.so，您可以在此处找到它[http://uploading.com/files/get/28f3c9bd/libface-detect.so](http://uploading.com/files/get/28f3c9bd/libface-detect.so)

还是不知道怎么回事，求大神帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T21:02:37.227

嗯，看来是我的错。[在对您的第一个问题的评论中，](https://stackoverflow.com/questions/11504155/javah-jni-generated-header-has-syntax-error-android-ndk-eclipse/11504581#comment15203388_11504581)我为您提供了 JNI 书的链接，该书介绍了如何编写 JNI_OnLoad 作为您的库确实被正确加载的证明。所以现在你看到了你的 logcat 语句，所以是的，你的库正确加载了。我真的没想到你会从 JNI 书中复制并粘贴整个 JNI_OnLoad 示例。完成查找 Java 代码中没有的类 :) 我告诉过你，你只需要 return 语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T09:04:15.053

我重建了ndk并重建了java jni头文件并且程序工作了，不知道如何

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:12:51.227

看起来它找不到类`'C'`或方法`'g'`，你的 Java 程序中确实有这样的类吗？

通常他们有类似的东西`FindClass("myorg/mypackage/myclass");`

# asp.net-web-api - 在每个 ASP.NET Web API 请求中重复逻辑，应该去哪里？

> ID：11508121
> 
> 赞同：0
> 
> 时间：2012-07-16T16:03:35.967
> 
> 标签：asp.net-web-api

我需要在会话（或 ASP.NET Web API 中的任何内容）中存储一些我需要在每个 API 请求中检索的信息。我们将有一个 api IIS 网站，并通过主机头添加多个网站绑定。当任何请求进入时，例如 api.xyz.com，将检查主机标头并将该网站信息存储在会话中，这些信息将在调用数据库时在每个后续 api 请求中使用。希望这很清楚。

我找到了一种在 ASP.NET Web API 中处理会话的方法。 [ASP.NET Web API 会话还是什么？](https://stackoverflow.com/questions/11478244/asp-net-web-api-session-or-something/11479021#11479021).

我对我们可以覆盖 PreRequestHandler 的 asp.net 网络表单了解更多。我正在 ASP.NET Web API 中寻找类似的东西，我可以在其中使用我的逻辑来获取 api 域的数据库 ID（例如，api.xyz.com）并将其存储在我想在每个 API GET/POST 中访问的会话中要求。

肯定有人会说通过添加会话我使其有状态，但 REST 是无状态的。但我想为每个 api 请求保存数据库之旅。如果我不使用 session 或类似的东西，我最终会为每个 api 请求重复相同的逻辑。

有没有更好的方法来处理这种情况？如何？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:32:56.997

如果所有请求都需要该逻辑，则最好使用[委托处理程序](http://byterot.blogspot.co.uk/2012/05/aspnet-web-api-series-messagehandler.html)的实现。

# api - 性能测试 Twitter Streaming API 消费者

> ID：11508123
> 
> 赞同：2
> 
> 时间：2012-07-16T16:03:39.763
> 
> 标签：api, node.js, eventmachine, performance-testing, twitter-streaming-api

我有一个使用 Twitter Streaming API 实时消费 Twitter 帖子的服务。

我已经建立了一个后台进程，它连接到流并将推文推送到 Redis。这是用 node.js 构建的

我需要做的是弄清楚这个过程可以消耗的最大推文数量。我需要对此设置进行性能测试。

对此进行测试的最佳方法是什么？

我需要知道：

*   在它崩溃之前它可以处理多少条推文
*   当进程无法处理更多推文时会发生什么

我想要这样做的另一个原因是确定它是否值得使用 node.js。我宁愿用 EventMachine 来写它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:00:45.447

由于您天生受到来自 Twitter 流 API 的推文的频率和数量的限制，因此您对基准测试真正感兴趣的是您的后台进程相对于 Redis 的 I/O 性能。

模拟推文并生成伪推文或收集大量实际推文样本，并在您的基准测试中使用此数据集。在模拟/生成这个数据集之后，你可以精确地写你的基准测试。例如，手头有数据集，您可以一次将整个数据集推送到新的推文事件处理逻辑中，或者模拟活动的高峰和低谷。

关键是，在进行基准测试时，识别和隔离所需的变量（推文数量），使用标准化样本，并模拟不一致和外部行为（API 限制、可变推文/秒速率）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T11:48:21.893

我建议创建模拟 Twitter Stream API 的自定义客户端。客户端可以生成推文供您的应用程序使用。我们可以使用支持自定义脚本的负载测试工具从分布式机器上运行这个 twitter 脚本来生成所需的负载。在生成推文时，您可以监控系统的运行状况，以衡量推文吞吐量对您的应用程序的影响。

# git - 如何使用 git 将更改推送到生产服务器？

> ID：11508129
> 
> 赞同：0
> 
> 时间：2012-07-16T16:03:56.077
> 
> 标签：git, ubuntu, repository, gitosis

我在生产服务器上设置 git 时遇到问题，我希望能够进行本地编辑，然后将它们推送到我的实时服务器 ubuntu 11.10。

我能够使用 gitosis 在我的服务器上创建一个 git repo，但这只是创建了一个我可以克隆和推送到的 repo，但我不知道如何为 live 文件夹创建 repo

```
/home/william/appname 
```

然后克隆它并在本地进行编辑。

任何能够联系并指出我正确方向的人。

基本上我想要完成的是 phpfog 用于那里的文件，你克隆你的应用程序并能够对其进行更改。

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:17:23.677

您可以使用 postcommit 脚本在产品服务器上的主存储库（裸存储库）更新时自动更新工作副本（webroot）。然后将所有更改推送到裸仓库上的 Master。

您也可以使用 CI 服务器为您执行此操作（例如 Hudson ）

祝你好运。PS htaccess .git 文件夹。

# .net - 如何将 Windows 窗体应用程序转换为 ActiveX 控件？

> ID：11508130
> 
> 赞同：1
> 
> 时间：2012-07-16T16:03:58.907
> 
> 标签：.net, winforms, browser, activex

我有一个 Windows 窗体应用程序，我需要将其转换为 ActiveX 应用程序，以便可以从浏览器调用它。

我尝试了互联网上的各种教程，但没有一个有效。我无法让表单加载到浏览器中。我还尝试更改 IE 中的安全设置以查看它是否会有所作为，但它没有。

有任何想法吗？

# c# - 如何计算与另一个点固定距离的随机点？

> ID：11508131
> 
> 赞同：-2
> 
> 时间：2012-07-16T16:04:01.270
> 
> 标签：c#

我想我所说的距离是指半径，所以另一种表述方式是“我如何在给定半径的圆的圆周上获得随机点，同时给定圆的中心点”。

我不明白降价。这是一个简单的 C# 问题，需要一个简单的 C# 答案，如下 Daniel DiPaolo 提供的那样。

降价和相关评论都无助于改进问题或提供答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T16:08:18.103

如果您的中心和半径是固定的，那么真正唯一变化的是角度。因此，只需计算 0 到 360 度（或 0 到 2π 弧度）之间的一些随机角度，然后使用极坐标转换来获取 xy 坐标。

```
x = r × cos( θ )
y = r x sin( θ ) 
```

将中心的 x,y 坐标添加为偏移量，您就有了坐标。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-16T16:05:45.453

计算一个随机角度，然后使用角度和距离作为与第一个点的极坐标偏移。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:07:29.043

看看[Circle Point Tracking](http://mathworld.wolfram.com/CirclePointPicking.html)，这里有一些挑选点的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T16:11:46.053

算法代码

给定圆 {[0,0], 1} - {center, radius}

1.  **x** => 从 [-1, 1] 中获取随机数 x
2.  **y+**或**y-** => 随机选择正或负 y 四分之一（例如 0 或 1）
3.  **y** => 获取垂直线 x=X1（来自步骤 1）和圆的交点，选择正或负四分之一（来自步骤 2）

**注意**这可以通过使用角度更简单、更快、更均匀地完成，请参阅其他答案。

我的算法的问题是，如果有人尝试使用它，由于圆形的弯曲形状，靠近的点`X=r+`被`X=r-`拾取的频率比靠近的点要少`X=0`。请参阅@Servy 的评论。

# bash - awk : 如果连续 >=4 行以 + 或 - 开头，则不打印记录

> ID：11508138
> 
> 赞同：3
> 
> 时间：2012-07-16T16:04:25.780
> 
> 标签：bash, shell, awk, gawk

我正在尝试使用 awk 读取文件，并且仅显示不以 + 或 - 连续 4 次或更多次开头的行。gawk 也可以。每个分组由一个空行分隔。

这是文件中的一个示例，这些是我不想打印的**行**：

```
+Host is up.
+Not shown: 95 closed ports, 3 filtered ports
+PORT     STATE SERVICE   VERSION
+23/tcp   open  telnet
+9100/tcp open  jetdirect

-Host is up.
-Not shown: 99 closed ports
-PORT     STATE SERVICE VERSION
-5900/tcp open  vnc 
```

**我**想要打印的文件样本（不是连续 4 个或更多）：

```
-Not shown: 76 closed ports, 18 filtered ports
+Not shown: 93 closed ports
PORT    STATE SERVICE VERSION
+514/tcp open  shell 
```

我正在学习如何使用 awk，因为我一直在阅读 O'Reilly 的 awk & sed 但我对这个问题有点困惑。此外，如果有人愿意，我不介意使用 shell 脚本解决这个问题的非 awk 方法。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:23:19.530

如果我理解你的问题，输入文件的记录是段落，所以你需要用空行分隔它们。我假设它用于下一个脚本：

内容`script.awk`：

```
BEGIN {
        ## Separate records by one or more blank lines.
        RS = ""

        ## Each line will be one field. Both for input and output.
        FS = OFS = "\n"
}

## For every paragraph...
{
        ## Flag to check if I will print the paragraph to output.
        ## If 1, print.
        ## If 0, don't print.
        output = 1

        ## Count how many consecutive rows have '+' or '-' as first
        ## character.
        j = 0

        ## Traverse all rows.
        for ( i = 1; i <= NF; i++ ) {
                if ( substr( $i, 1, 1 ) ~ /+|-/ ) {
                        ++j;
                }
                else {
                        j = 0
                }

                if ( j >= 4 ) {
                        output = 0
                        break
                }
        }

        if ( output == 1 ) {
                print $0 "\n"
        }
} 
```

假设以下测试输入文件为`infile`：

```
+Host is up. 
+Not shown: 95 closed ports, 3 filtered ports
+PORT     STATE SERVICE   VERSION

+Host is up. 
+Not shown: 95 closed ports, 3 filtered ports
+PORT     STATE SERVICE   VERSION
+23/tcp   open  telnet
+9100/tcp open  jetdirect

-Host is up. 
-Not shown: 99 closed ports
-PORT     STATE SERVICE VERSION
-5900/tcp open  vnc 

-Not shown: 76 closed ports, 18 filtered ports
+Not shown: 93 closed ports
PORT    STATE SERVICE VERSION
+514/tcp open  shell 
```

像这样运行脚本：

```
awk -f script.awk infile 
```

使用以下输出（第一个记录，因为它没有达到四个连续的行，第二个记录，因为它们之间有不同的行）：

```
+Host is up.
+Not shown: 95 closed ports, 3 filtered ports
+PORT     STATE SERVICE   VERSION

-Not shown: 76 closed ports, 18 filtered ports
+Not shown: 93 closed ports
PORT    STATE SERVICE VERSION
+514/tcp open  shell 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T16:36:43.100

```
awk '{if(NF>3 &&( $0 ~ /\+/ || $0 ~ /-/) ) print $0}' test.txt 
```

# xsd - XSD里面的所有选择

> ID：11508147
> 
> 赞同：9
> 
> 时间：2012-07-16T16:04:52.160
> 
> 标签：xsd

您不能将选择标签放在所有标签内。那么，是否有任何解决方法来获得此功能？例如，我有`<settings>`如下标签：

```
<settings>
    <logging />
    <sending />
    <useonly />
</settings> 
```

或者类似的东西

```
<settings>
    <logging />
    <notuseonly />
    <sending />
</settings> 
```

所以我想防止`<useonly>`和`<notuseonly>`出现一起出现，而顺序并不重要。如果允许，在 XSD 中它看起来像：

```
 <xs:all>
    <xs:element minOccurs="0" maxOccurs="1" ref="sending" />
    <xs:element minOccurs="0" maxOccurs="1" ref="logging" />
    <xs:choice>
         <xs:element minOccurs="0" maxOccurs="1" ref ="useonly" />
         <xs:element minOccurs="0" maxOccurs="1" ref ="notuseonly" />
     </xs:choice>
  </xs:all> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-07-17T06:29:45.903

检查此链接：[http ://www.w3.org/wiki/Needs_choice_inside_all](http://www.w3.org/wiki/Needs_choice_inside_all)

我为您总结了提出的解决方案：

一种解决方案是将可以更改的元素包装在另一个元素中：

```
 <xsd:all>
   <xsd:element minOccurs="0" maxOccurs="1" ref="sending" />
   <xsd:element minOccurs="0" maxOccurs="1" ref="logging"/>
   <xsd:element minOccurs="0" maxOccurs="1" ref ="usetype"/>
  </xsd:all>

 <xsd:element name="usetype">
  <xsd:complexType>
   <xsd:choice>
    <xsd:element ref="useonly"/>
    <xsd:element ref="notuseonly"/>
   </xsd:choice>
  </xsd:complexType>
 </xsd:element> 
```

另一种是使用替换组：

```
 <xsd:all>
   <xsd:element ref="sending"/>
   <xsd:element ref="logging"/>
   <xsd:element ref="usetype"/>
  </xsd:all>
 </xsd:complexType>
 <xsd:element name="usetype" abstract="true"/>
 <xsd:element name="useonly" substitutionGroup="usetype"> ... </xsd:element>
 <xsd:element name="notuseonly" substitutionGroup="usetype"> ... </xsd:element> 
```

# iis - Web 平台安装程序自动更新

> ID：11508149
> 
> 赞同：2
> 
> 时间：2012-07-16T16:04:59.603
> 
> 标签：iis

Web 平台安装程序是否支持自动更新？假设我什么都没配置，网络平台安装程序会：

1：检查自动更新。

2：未经我的许可，自动安装它们。

# java - 在线编译java代码和创建jar

> ID：11508150
> 
> 赞同：2
> 
> 时间：2012-07-16T16:05:09.570
> 
> 标签：java, java-7, jdk1.4

我的问题：我的机器上有 JDK 1.7 版本。我用它创建的 jar 不能在我的 Unix 机器上运行，因为它安装了 JRE 1.4（我没有这台机器的管理员权限）。

那么，有没有办法用 1.4 版编译我的代码，而无需在我的机器上卸载 1.7。可以在网上完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:07:02.633

您可以使用[-target version](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/javac.html)选项来执行交叉编译。

根据[javadoc的示例](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/solaris/javac.html)

> % javac -target 1.4 -bootclasspath jdk1.4.2/lib/classes.zip \ -extdirs "" OldCode.java

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:08:14.093

根据[javac 文档](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javac.html)，您可以使用 -source 参数设置 JDK 源：

```
javac -source 1.4 MyClass 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:19:20.963

[This](http://ideone.com/) , [this](http://rextester.com/runcode)和[this](http://www.onlinecompiler.net/)是非常好的站点，您可以在其中在线运行所有 java 代码并获得结果，而无需在您的机器上安装 JDK

# iphone - 创建 IPA，“包含多个产品”

> ID：11508151
> 
> 赞同：1
> 
> 时间：2012-07-16T16:05:12.050
> 
> 标签：iphone, ios, xcode, xcode4, mailcore

我正在开发基于 ReMail 的电子邮件客户端。基本上，我重用了 ReMail 项目，以便立即设置 MailCore 等依赖项，以便我可以在它们之上构建一个新应用程序。我正在尝试通过 ad hoc 将应用程序提供给一些 beta 测试人员，但是当我尝试创建 IPA 时，我收到此错误：

`xxxx does not contain a single–bundle application or contains multiple products. Please select another archive, or adjust your scheme to create a single–bundle application.`

我已将所有依赖项的 Skip Install 设置为 YES，并将 Copy Header 下的所有文件移动到“项目”部分，但我仍然无法构建单个 APP 文件。

我不知道这是否重要，但是当我打开 xcarchive 文件时，在 products 目录中，我在 Applications 下找到了一个 APP 文件，然后是一个文件结构，它反映了 MailCore 头文件的绝对路径。

关于可能发生什么的任何想法？我非常接近沮丧的头发撕裂阶段，我认为不自然的秃头疯子看起来不适合我。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:52:48.400

尝试完全删除“复制标题”阶段。它只应该用于框架，而不是静态库。包含“Copy Headers”阶段的 Xcode 静态库模板是错误的。

[查看来自WWDC 2012](https://developer.apple.com/videos/wwdc/2012/)的“在 Xcode 中使用方案和项目”视频，从 45 分 10 秒开始。

# sql-server-2008 - 将主键类型从 int 更改为 bigint

> ID：11508152
> 
> 赞同：0
> 
> 时间：2012-07-16T16:05:16.810
> 
> 标签：sql-server-2008, primary-key, bigint

我的数据库中有一些表具有 int 类型的主键，我想将其更改为 bigint 类型。在不删除/重新创建表和约束的情况下完成此任务的最佳策略是什么？

这些主键在其他表中被用作外键，因此会考虑在内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:14:15.663

在 SSMS 中，执行以下步骤。

> 1.  单击工具。
> 2.  选择选项
> 3.  选择设计师

只需取消选中屏幕截图中突出显示的选项即可。现在您可以使用`Alter script`来更改`DDL`.

![在此处输入图像描述](../Images/7594c576b7a06583cefaf5262597e376.png)

# php - 如果内容存在，则从多个表中选择数据，否则跳过一个表

> ID：11508154
> 
> 赞同：0
> 
> 时间：2012-07-16T16:05:22.630
> 
> 标签：php, mysql, sql

我有一个显示画廊的 php 页面。在所有项目下，我打印了一些信息，例如好/坏票（竖起/向下）以及它的浏览量。

对于内容中插入的每一行，也会有一行插入到 content_views 表中。但是，投票表将仅包含有人投票的行（1vote = 1row）。

我想选择某个类别（利基）中的所有信息（内容。*、视图和投票，如果有的话）。我遇到的问题是，如果没有投票，我的查询（见下文）将返回一个空结果。

```
 $result = mysql_query("
    SELECT content.*, content_views.views as views, votes.good, votes.bad 
    FROM content, content_niches, content_views , votes
    WHERE content_views.content = content.record_num 
    AND content.approved = 2 
    AND content_niches.content = content.record_num 
    AND votes.content = content.record_num
    AND content_niches.niche = '$niche' 
    AND content.enabled = 1 
    GROUP BY content.record_num 
    ORDER BY $orderby DESC LIMIT $from,$max_results") or die(mysql_error()); 
```

当然，我可以执行以下操作，但由于我的内容超过 50K 行，而且投票数更多，这将非常慢。

```
 $result = mysql_query("
    SELECT content.*, content_views.views as views,
            (SELECT votes.good FROM votes WHERE votes.content=content.record_num) AS good,
            (SELECT votes.bad FROM votes WHERE votes.content=content.record_num) AS bad
    FROM content, content_niches, content_views 
    WHERE content_views.content = content.record_num 
    AND content.approved = 2 
    AND content_niches.content = content.record_num 
    AND votes.video = content.record_num
    AND content_niches.niche = '$niche' 
    AND content.enabled = 1 
    GROUP BY content.record_num 
    ORDER BY $orderby DESC LIMIT $from,$max_results") or die(mysql_error()); 
```

这样做的“正确”方法是什么？

Edit1：新查询太慢了，怎么办？

```
 $result = mysql_query("
    SELECT content.*,content_niches.*, content_views.views as views 
    FROM content
    INNER JOIN 
       content_niches ON (content_niches.content = content.record_num AND content_niches.niche = '$chanid')
    INNER JOIN
       content_views ON (content_views.content = content.record_num )
    LEFT OUTER JOIN votes
       ON (votes.video = content.record_num)
    WHERE content.approved = 2 
    AND content.enabled = 1 
    GROUP BY content.record_num 
    ORDER BY $orderby DESC LIMIT $from,$max_results") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:12:57.163

它被称为`outer join`. 左外连接从左侧返回所有行，仅从右侧返回匹配的行。

因此，例如，如果你有一个 1 票的帖子和一个 0 票的帖子，你这样做：

```
select * 
from posts
left outer join votes
  on posts.id = votes.id 
```

它将返回所有存在并对应的帖子和任何投票记录。

你真的应该学会使用[ansi-join 语法](http://dev.mysql.com/doc/refman/5.0/en/join.html)而不是非 ansi 连接

# html - 在 html 中对齐包装的文本

> ID：11508156
> 
> 赞同：0
> 
> 时间：2012-07-16T16:05:27.440
> 
> 标签：html, text, formatting, alignment

我正在尝试使用以下方法在字段上进行左对齐：

```
 <TD ALIGN="left" WIDTH="20%" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#PrimaryKeyValues#</TD>    </div> 
```

但是，当文本太大时，它会被环绕，并且被环绕的文本不会从同一位置开始。

```
 PRODUCT_ID:1(Indirect Auto Retail),PREVIOUSLY_LOGGED_FLG:1,
EVALUATOR_ID:65(Product Test),DECISION_ID:1(APPCOND)
    PRODUCT_ID:1(Indirect Auto Retail),PREVIOUSLY_LOGGED_FLG:1,
EVALUATOR_ID:65(Product Test),DECISION_ID:1(APPCOND)
    USER_ID:PTKIM  
    USER_ID:PTKIM 
```

希望上面的文本示例显示正在发生的事情

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:07:16.640

永远不要使用（非中断或其他）空格“证明”文本。只需将 CSS 属性用于[text-align](http://www.w3.org/TR/css3-text/#text-align)、[text-wrap](http://www.w3.org/TR/css3-text/#text-wrap)等。有关更多信息，请查看[CSS Text](http://www.w3.org/TR/css3-text/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:09:01.927

你不能为此使用 CSS 吗？所有这些不间断的空间看起来都很吓人！

```
<TD ALIGN="left" WIDTH="20%" style="text-align: justify">#PrimaryKeyValues#</TD> 
```

[http://www.w3schools.com/cssref/pr_text_text-align.asp](http://www.w3schools.com/cssref/pr_text_text-align.asp)

或者，如果您只想缩进：

```
<TD ALIGN="left" WIDTH="20%" style="text-indent: 20px">#PrimaryKeyValues#</TD> 
```

这有帮助吗？

谢谢，迈克尔。

# ios5 - 如何在单击按钮 iOS5 时加载现有的 TableViewController

> ID：11508159
> 
> 赞同：0
> 
> 时间：2012-07-16T16:05:38.960
> 
> 标签：ios5, uiview, uitableview, pushviewcontroller, viewdidload

我使用情节提要创建了 UIExamsTVC。

单击单元格后，它会将我带到 UITestVC。

UITestVC 有 10 个问题，当我到达最后一个问题 #10 时，我有一个“完成”按钮。单击“完成”按钮后，我想返回原始 UIExamsTVC。

在：UITestVC.m

```
 #import UIExamsTVC.h
 (on button click)
 [self.navigationController pushViewController:UIExamsTVC animated:NO]; 
```

*   编译错误 - 意外的接口名称

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:24:35.607

如果你想**回去，**那么你不想推送任何新的东西……那只是添加到现有的堆栈中。如果您`UITestVC`通过推送到达，则需要“弹出”以返回。如果你通过模态呈现它到达那里，你想“解雇”它。

（您的实际错误告诉您的是，当您调用的方法需要对对象的引用时，您不能使用类的名称。）

# c++ - 如何从对象方法中访问对象属性？

> ID：11508163
> 
> 赞同：1
> 
> 时间：2012-07-16T16:05:48.510
> 
> 标签：c++

我有这个命名`Enemy`的类，它`Ninja`继承了它的属性。在`Ninja`的攻击函数中，我正在尝试调用`Ninja`的`getAttackPower`函数，但是我该如何获取它。我试过打电话`this.getAttackPower`，但没有用。

```
#include <iostream>
#include <cstdlib>
#include <ctime>

using namespace std;

class Enemy {
    int attackPower;
    public:
        virtual void attack() { cout << "I am attacking you!"; }
    protected:
        int getAttackPower() {
            return attackPower;
        }
        void setAttackPower( int a ) {
            attackPower = a;
        }
};

class Ninja : public Enemy {
    void attack() {
        cout << "(minus " << getAttackPower() << " points).";
        // .................. right here ......
    }
};

int main() {
    Ninja ninjaObj;

    ninjaObj.setAttackPower(23);

    ninjaObj.getAttackPower();

} 
```

以下是我得到的错误：

```
void Enemy::setAttackPower(int) is protected
error: within this context
error: 'int Enemy::getAttackPower()' is protected
error: within this context 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:20:41.367

你的问题`main`不在`attack`。您将访问修饰符设置为`Enemy::setAttackPower(int)`和。这意味着除非您在**扩展 Enemy**的类中，否则这些方法将被视为。`Enemy::getAttackPower()``protected``private`

 **这意味着当您在`main`其中时无法访问`ninjaObj.setAttackPower(23)`，因为`main`它**超出了任何 object 的范围**。

但是，如果您调用`ninjaObj.attack()`，它也会失败，因为您没有为 设置访问修饰符`Ninja::attack()`，因此它**默认为 private**。

解决方法：`public:`在 前面添加`Ninja::attack()`，不要调用`Enemy::setAttackPower(int)`or`Enemy::getAttackPower()`在 中`main`。**

# magento - Magento:- 在管理表单中添加网格

> ID：11508165
> 
> 赞同：0
> 
> 时间：2012-07-16T16:06:05.093
> 
> 标签：magento

我正在 Magento Adminhtml 中生成一个表单。我有两个列表框类别和子类别，它们是级联填充的。现在，在单击或更改子类别列表的事件后，我想在该子类别列表下方显示 magento 网格（带有分页过滤的网格）。

我不知道要使用哪个块来显示该网格。

帮助表示赞赏。-谢谢赫曼特

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T10:17:25.087

尝试查看 Mage 文件，`magento`已经使用网格进入表单，查看此文件： `core/Mage/Adminhtml/Block/Catalog/Category/Tap/Product.php` **Product.php 是一个网格**，要检查后台的结果，检查`catalog->manage categories`然后单击类别产品选项卡

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-16T16:12:24.790

有很多关于创建网格的教程。也许这个会有所帮助？ [http://www.webspeaks.in/2010/08/create-admin-backend-module-in-magento.html](http://www.webspeaks.in/2010/08/create-admin-backend-module-in-magento.html)

# git - 如何使用 Git Gui 添加远程？

> ID：11508168
> 
> 赞同：11
> 
> 时间：2012-07-16T16:06:15.390
> 
> 标签：git, git-gui

我想将我的更改推送到远程服务器上的文件夹。我什至可以对它进行地图驱动。希望有一个文件夹浏览器（与选择创建存储库的位置相同），我可以在其中选择要推送到的服务器文件夹。因为我不知道我在这里有语法错误。

![在此处输入图像描述](../Images/9e9789e9854a2d0dd67d429fbc969dee.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:17:29.620

添加遥控器与物理遥控器本身无关。它仅用于管理对遥控器本身的引用。

话虽如此，听起来您想使用 Git 部署到服务器。您可以使用推动分支来实现此目的。但是，您首先必须通过在服务器上运行它来进行远程设置

```
git clone --bare //path/to/your/repo /some/dir/on/the/server/.git 
```

现在，您必须在此 repo 中添加一个钩子，以便在每次推送到分支时触发。在这个钩子中，你会：

```
git --git-dir=/some/dir/on/the/server/.git --work-tree=/where/to/deploy/to checkout deployment-branch -- . 
```

您必须谷歌`git update hook`才能获得包装上述行所需的几行代码。

# php - 在 PHP 中为 JSON 对象分配标识符/名称

> ID：11508169
> 
> 赞同：4
> 
> 时间：2012-07-16T16:06:16.247
> 
> 标签：php, javascript, jquery, json

我正在从 mysql 数据库中获取数据并使用 PHP 对 JSON 对象进行编码以在 JS 中使用。在 PHP 端，我这样做了

而($row = mysql_fetch_array($result))

```
{
     $jmarkers = array(
        'id'=> $row['id'],
                'lat' => $row['lat'],
                'lng' => $row['lng'],
         etc...            
    );
    array_push($json, $jmarkers);
}

$jsonstring = json_encode($json);
echo $jsonstring; 
```

我可以使用 jQuery 访问 JS 中的数据，并制作了一个数组来保存 JSON 数据：

$.getJSON("getjson.php", 函数（数据）

```
{
     myMarkers = data;
     console.log(myMarkers);
}); 
```

我计划在循环内访问 myMarkers 数组中的数据，使用如下语句：

var tempLat = myMarkers.jmarkers[i].lat;

问题是我的 JSON 对象不被称为 jmarkers 或其他任何东西，当我将它们打印到控制台时，它们具有这个通用名称“对象”：

对象 { id="2", lat="40.6512", lng="-73.9691", 更多...},

所以我不确定如何在我的 JS 数组中指向它们。我查看了 PHP JSON 编码函数，但看不到在哪里设置或更改对象名称。有什么建议么？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:10:20.270

这是可以预料的。JSON 本质上是赋值操作的右侧：

```
var x = {'foo':'bar'};
        ^^^^^^^^^^^^^---- JSON 
```

该`x`部分不包括在内，因为这只是对象的名称。如果你想`jmarkers`包含你的文本，它必须是你要编码的数据结构的一部分：

```
$arr = array(
   'jmarkers' => array(...your data here...);
); 
```

但这一切只是无缘无故地为您的数据结构添加了另一层。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T16:08:30.400

`$jmarkers`只是 JSON 对象在 PHP 端的标识符。当它被传递时，它会将数组值转换为 JSON 编码的字符串，因此会丢失标识符。

目前在您的 PHP 代码中，`array_push($json, $jmarkers)`正在将一个数组附加到您当前的`$json`数组中。因此，您正在实例化一个二维数组，您的 Javascript 代码中的 jmarkers 标识符将无法检索该数组。只需使用来检索数据`myMarkers[i]`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:09:02.473

你……不要。整个*事物*是一个对象。您只需要引用其中的元素。

```
alert(myMarkers.id); 
```

# php - 在函数中访问配置的最佳做法是什么？

> ID：11508170
> 
> 赞同：4
> 
> 时间：2012-07-16T16:06:17.557
> 
> 标签：php, config

```
<?php
define('ABSPATH', dirname(__FILE__)); //Absolute path to index

/*
* Method 1
* Dependency Injection
*/
class Config{

    private $_config = NULL;
    private $_filepath = NULL;

    public function __construct($filepath){
        $this->_filepath = $filepath;
        $this->load();
    }

    private function load(){
        if ($this->_config === NULL){
            if (!file_exists($this->_filepath)){
                throw new Exception('Configuration file not found');
            }else{
                $this->_config = parse_ini_file($this->_filepath);
            }
        }
    }

    public function get($key){
        if ($this->_config === NULL){
            throw new Exception('Configuration file is not loaded');
        }
        if (isset($this->_config[$key])){
            return $this->_config[$key];
        }else{
            throw new Exception('Variable ' . $key . ' does not exist in configuration file');
        }
    }
}

function getLost($where, $why, $who){
    //do smth
}

try{
    $config = new Config(ABSPATH . '/app/config.ini');
    getLost('here', 'because', $config->get('who'));    
}catch(Exception $e){
    echo $e->getMessage();
}
?> 
```

* * *

```
<?php
/*
* Method 2
* Config is accessed via static class
*/

class Config{

    private static $_config = NULL;
    private static $_filepath = NULL;

    public static function load($filepath){
        if (self::$_config === NULL){
            self::$_filepath = $filepath;
            if (!file_exists(self::$_filepath)){
                throw new Exception('Configuration file not found');
            }else{
                self::$_config = parse_ini_file(self::$_filepath);
            }
        }
    }

    public static function get($key){
        if (self::$_config !== NULL){
            throw new Exception('Configuration file is not loaded');
        }
        if (isset(self::$_config[$key])){
            return self::$_config[$key];
        }else{
            throw new Exception('Variable ' . $key . ' does not exist in configuration file');
        }
    }
}

function getLost($where, $why){
    $who = Config::get('who');
}

try{
    Config::load(ABSPATH . '/app/config.ini');
    getLost('here', 'because');    
}catch(Exception $e){
    echo $e->getMessage();
}
?> 
```

* * *

```
<?php
/**
* Method 3
* Config variable needed is passed as function parameter
*/
$config = parse_ini_file(ABSPATH . '/app/config.ini');

function getLost($where, $why, $who){
    //do smth
}

getLost('here', 'because', $config['who']);
?> 
```

* * *

```
<?php
/*
* Mathod 4
* Config is accessed inside a function via global
*/
$config = parse_ini_file(ABSPATH . '/app/config.ini');

function getLost($where, $why){
    global $config;
    $who = $config['who'];
}

getLost('here', 'because');
?> 
```

这些变体中的哪一个是最佳实践解决方案？如果没有，请提供您的变体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:08:40.933

如果您将 $config 替换为 $onlyTheStuffThatMattersToThatFunction，我会说第一种情况会更好

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-17T16:44:10.990

我会选择变体 1（依赖注入）。

变体 2 使用`static`已经说明的方法，只是另一种`global`方法。我们都知道这很糟糕，对吧？对？

变体 3 不是我最喜欢的，因为它不够 OOP ;-)，但很严重：如果您（或使用您的代码的人）想要更改配置文件的格式怎么办？

变体 4：`global`...

所以基本上我对其他选项的问题是：可测试性、紧密耦合、全局。

所以变体 1 是。我还将为配置类创建一个接口，以便您稍后可以为您的配置内容添加一个不同的类。例如，您（或其他人）想要使用 XML 文件进行配置。

我要改变的另一件事是`private`东西。如果有人想扩展类，他/她将无法以这种方式访问​​变量。我的经验法则（不确定是否每个人都同意这一点）只有`private`在您希望人们可以访问它时才制作东西（例如，它会在某个时候改变）。使用的危险`private`是人们会通过黑客绕过它来做他们想做的事。

阅读有关[SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)的更多信息并查看 Google[干净代码](http://www.google.nl/url?sa=t&rct=j&q=google+clean+code+talks&source=web&cd=8&ved=0CG8QFjAH&url=http%3A%2F%2Fwww.g-truc.net%2Fpost-0182.html&ei=9JkFUIKjFsjVtAbc1qCkBg&usg=AFQjCNFm7v0EzstqyZfhumeFaCpxlUCeYw)讨论以获取更多信息。

只是我的2美分。

# iphone - C vs 汇编程序 vs NEON 性能

> ID：11508172
> 
> 赞同：18
> 
> 时间：2012-07-16T16:06:18.430
> 
> 标签：iphone, c, image-processing, assembly, neon

我正在开发一个进行实时图像处理的 iPhone 应用程序。其管道中最早的步骤之一是将 BGRA 图像转换为灰度。我尝试了几种不同的方法，计时结果的差异远比我想象的要大。首先我尝试使用 C。我通过添加 B+2*G+R /4 来近似转换为亮度

```
void BGRA_To_Byte(Image<BGRA> &imBGRA, Image<byte> &imByte)
{
uchar *pIn = (uchar*) imBGRA.data;
uchar *pLimit = pIn + imBGRA.MemSize();

uchar *pOut = imByte.data;
for(; pIn < pLimit; pIn+=16)   // Does four pixels at a time
{
    unsigned int sumA = pIn[0] + 2 * pIn[1] + pIn[2];
    pOut[0] = sumA / 4;
    unsigned int sumB = pIn[4] + 2 * pIn[5] + pIn[6];
    pOut[1] = sumB / 4;
    unsigned int sumC = pIn[8] + 2 * pIn[9] + pIn[10];
    pOut[2] = sumC / 4;
    unsigned int sumD = pIn[12] + 2 * pIn[13] + pIn[14];
    pOut[3] = sumD / 4;
    pOut +=4;
}       
} 
```

此代码需要 55 毫秒来转换 352x288 图像。然后我发现了一些本质上做同样事情的汇编代码

```
void BGRA_To_Byte(Image<BGRA> &imBGRA, Image<byte> &imByte)
{
uchar *pIn = (uchar*) imBGRA.data;
uchar *pLimit = pIn + imBGRA.MemSize();

unsigned int *pOut = (unsigned int*) imByte.data;

for(; pIn < pLimit; pIn+=16)   // Does four pixels at a time
{
  register unsigned int nBGRA1 asm("r4");
  register unsigned int nBGRA2 asm("r5");
  unsigned int nZero=0;
  unsigned int nSum1;
  unsigned int nSum2;
  unsigned int nPacked1;
  asm volatile(

               "ldrd %[nBGRA1], %[nBGRA2], [ %[pIn], #0]       \n"   // Load in two BGRA words
               "usad8 %[nSum1], %[nBGRA1], %[nZero]  \n"  // Add R+G+B+A 
               "usad8 %[nSum2], %[nBGRA2], %[nZero]  \n"  // Add R+G+B+A 
               "uxtab %[nSum1], %[nSum1], %[nBGRA1], ROR #8    \n"   // Add G again
               "uxtab %[nSum2], %[nSum2], %[nBGRA2], ROR #8    \n"   // Add G again
               "mov %[nPacked1], %[nSum1], LSR #2 \n"    // Init packed word   
               "mov %[nSum2], %[nSum2], LSR #2 \n"   // Div by four
               "add %[nPacked1], %[nPacked1], %[nSum2], LSL #8 \n"   // Add to packed word                 

               "ldrd %[nBGRA1], %[nBGRA2], [ %[pIn], #8]       \n"   // Load in two more BGRA words
               "usad8 %[nSum1], %[nBGRA1], %[nZero]  \n"  // Add R+G+B+A 
               "usad8 %[nSum2], %[nBGRA2], %[nZero]  \n"  // Add R+G+B+A 
               "uxtab %[nSum1], %[nSum1], %[nBGRA1], ROR #8    \n"   // Add G again
               "uxtab %[nSum2], %[nSum2], %[nBGRA2], ROR #8    \n"   // Add G again
               "mov %[nSum1], %[nSum1], LSR #2 \n"   // Div by four
               "add %[nPacked1], %[nPacked1], %[nSum1], LSL #16 \n"   // Add to packed word
               "mov %[nSum2], %[nSum2], LSR #2 \n"   // Div by four
               "add %[nPacked1], %[nPacked1], %[nSum2], LSL #24 \n"   // Add to packed word                 

               ///////////
               ////////////

               : [pIn]"+r" (pIn), 
         [nBGRA1]"+r"(nBGRA1),
         [nBGRA2]"+r"(nBGRA2),
         [nZero]"+r"(nZero),
         [nSum1]"+r"(nSum1),
         [nSum2]"+r"(nSum2),
         [nPacked1]"+r"(nPacked1)
               :
               : "cc"  );
  *pOut = nPacked1;
  pOut++;
 }
 } 
```

此功能在 12 毫秒内转换相同的图像，几乎快 5 倍！我以前没有在汇编器中编程过，但我认为对于这样一个简单的操作，它不会比 C 快得多。受到这次成功的启发，我继续搜索并[在这里](https://github.com/carlj/NEON-ASM-BGRA-to-Grayscale-conversion)发现了一个 NEON 转换示例。

```
void greyScaleNEON(uchar* output_data, uchar* input_data, int tot_pixels)
{
__asm__ volatile("lsr          %2, %2, #3      \n"
                 "# build the three constants: \n"
                 "mov         r4, #28          \n" // Blue channel multiplier
                 "mov         r5, #151         \n" // Green channel multiplier
                 "mov         r6, #77          \n" // Red channel multiplier
                 "vdup.8      d4, r4           \n"
                 "vdup.8      d5, r5           \n"
                 "vdup.8      d6, r6           \n"
                 "0:                           \n"
                 "# load 8 pixels:             \n"
                 "vld4.8      {d0-d3}, [%1]!   \n"
                 "# do the weight average:     \n"
                 "vmull.u8    q7, d0, d4       \n"
                 "vmlal.u8    q7, d1, d5       \n"
                 "vmlal.u8    q7, d2, d6       \n"
                 "# shift and store:           \n"
                 "vshrn.u16   d7, q7, #8       \n" // Divide q3 by 256 and store in the d7
                 "vst1.8      {d7}, [%0]!      \n"
                 "subs        %2, %2, #1       \n" // Decrement iteration count
                 "bne         0b            \n" // Repeat unil iteration count is not zero
                 :
                 :  "r"(output_data),           
                 "r"(input_data),           
                 "r"(tot_pixels)        
                 : "r4", "r5", "r6"
                 );
} 
```

计时结果令人难以置信。它在 1 毫秒内转换相同的图像。比汇编程序快 12 倍，比 C 快 55 倍。我不知道这样的性能提升是可能的。鉴于此，我有几个问题。首先，我在 C 代码中做错了什么吗？我仍然很难相信它是如此缓慢。其次，如果这些结果完全准确，我可以期望在哪些情况下看到这些收益？你可以想象我对让管道的其他部分运行速度提高 55 倍的前景感到多么兴奋。我应该学习汇编程序/NEON 并在任何需要大量时间的循环中使用它们吗？

更新 1：我已经在 [http://temp-share.com/show/f3Yg87jQn](http://temp-share.com/show/f3Yg87jQn)的文本文件中发布了我的 C 函数的汇编程序输出。它太大了，无法直接包含在此处。

计时是使用 OpenCV 函数完成的。

```
double duration = static_cast<double>(cv::getTickCount()); 
//function call 
duration = static_cast<double>(cv::getTickCount())-duration;
duration /= cv::getTickFrequency();
//duration should now be elapsed time in ms 
```

## 结果

我测试了几个建议的改进。首先，按照 Viktor 的建议，我对内部循环进行了重新排序，以将所有获取放在首位。然后内部循环看起来像。

```
for(; pIn < pLimit; pIn+=16)   // Does four pixels at a time
{     
  //Jul 16, 2012 MR: Read and writes collected
  sumA = pIn[0] + 2 * pIn[1] + pIn[2];
  sumB = pIn[4] + 2 * pIn[5] + pIn[6];
  sumC = pIn[8] + 2 * pIn[9] + pIn[10];
  sumD = pIn[12] + 2 * pIn[13] + pIn[14];
  pOut +=4;
  pOut[0] = sumA / 4;
  pOut[1] = sumB / 4;
  pOut[2] = sumC / 4;
  pOut[3] = sumD / 4;
} 
```

这一变化将处理时间降低到 53 毫秒，提高了 2 毫秒。接下来，按照 Victor 的建议，我将函数更改为 fetch as uint。然后内部循环看起来像

```
unsigned int* in_int = (unsigned int*) original.data;
unsigned int* end = (unsigned int*) in_int + out_length;
uchar* out = temp.data;

for(; in_int < end; in_int+=4)   // Does four pixels at a time
{
    unsigned int pixelA = in_int[0];
    unsigned int pixelB = in_int[1];
    unsigned int pixelC = in_int[2];
    unsigned int pixelD = in_int[3];

    uchar* byteA = (uchar*)&pixelA;
    uchar* byteB = (uchar*)&pixelB;
    uchar* byteC = (uchar*)&pixelC;
    uchar* byteD = (uchar*)&pixelD;         

    unsigned int sumA = byteA[0] + 2 * byteA[1] + byteA[2];
    unsigned int sumB = byteB[0] + 2 * byteB[1] + byteB[2];
    unsigned int sumC = byteC[0] + 2 * byteC[1] + byteC[2];
    unsigned int sumD = byteD[0] + 2 * byteD[1] + byteD[2];

    out[0] = sumA / 4;
    out[1] = sumB / 4;
    out[2] = sumC / 4;
    out[3] = sumD / 4;
    out +=4;
    } 
```

这种修改产生了显着的效果，将处理时间减少到 14 毫秒，减少了 39 毫秒 (75%)。最后一个结果非常接近 11ms 的汇编器性能。rob 建议的最终优化是包含 __restrict 关键字。我在每个指针声明前面添加了它，更改了以下几行

```
__restrict unsigned int* in_int = (unsigned int*) original.data;
unsigned int* end = (unsigned int*) in_int + out_length;
__restrict uchar* out = temp.data;  
...
__restrict uchar* byteA = (uchar*)&pixelA;
__restrict uchar* byteB = (uchar*)&pixelB;
__restrict uchar* byteC = (uchar*)&pixelC;
__restrict uchar* byteD = (uchar*)&pixelD;  
... 
```

这些变化对处理时间没有可测量的影响。感谢大家的帮助，以后我会更加关注内存管理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:39:49.347

这里有一个关于NEON“成功”的一些原因的解释：[http ://hilbert-space.de/?p=22](http://hilbert-space.de/?p=22)

尝试使用“-S -O3”开关编译您的 C 代码，以查看 GCC 编译器的优化输出。

恕我直言，成功的关键是两个程序集版本都采用了优化的读/写模式。NEON/MMX/其他矢量引擎也支持饱和（将结果钳位到 0..255，而不必使用“无符号整数”）。

在循环中查看这些行：

```
unsigned int sumA = pIn[0] + 2 * pIn[1] + pIn[2];
pOut[0] = sumA / 4;
unsigned int sumB = pIn[4] + 2 * pIn[5] + pIn[6];
pOut[1] = sumB / 4;
unsigned int sumC = pIn[8] + 2 * pIn[9] + pIn[10];
pOut[2] = sumC / 4;
unsigned int sumD = pIn[12] + 2 * pIn[13] + pIn[14];
pOut[3] = sumD / 4;
pOut +=4; 
```

读取和写入确实是混合的。循环周期的稍微好一点的版本是

```
// and the pIn reads can be combined into a single 4-byte fetch
sumA = pIn[0] + 2 * pIn[1] + pIn[2];
sumB = pIn[4] + 2 * pIn[5] + pIn[6];
sumC = pIn[8] + 2 * pIn[9] + pIn[10];
sumD = pIn[12] + 2 * pIn[13] + pIn[14];
pOut +=4;
pOut[0] = sumA / 4;
pOut[1] = sumB / 4;
pOut[2] = sumC / 4;
pOut[3] = sumD / 4; 
```

请记住，这里的“unsigned in sumA”行实际上可能意味着 alloca() 调用（堆栈上的分配），因此您在临时 var 分配上浪费了很多周期（函数调用 4 次）。

此外，pIn[i] 索引仅从内存中提取单字节。更好的方法是读取 int 然后提取单个字节。为了使事情更快，使用“unsgined int*”读取 4 个字节（pIn[i * 4 + 0]、pIn[i * 4 + 1]、pIn[i * 4 + 2]、pIn[i * 4 + 3]）。

NEON 版本显然更胜一筹：线条

```
 "# load 8 pixels:             \n"
             "vld4.8      {d0-d3}, [%1]!   \n" 
```

和

```
 "#save everything in one shot   \n"
             "vst1.8      {d7}, [%0]!      \n" 
```

节省大部分时间用于内存访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T17:29:00.037

如果性能至关重要（通常是实时图像处理），您确实需要注意机器代码。正如您所发现的，使用矢量指令（专为实时图像处理之类的事情而设计）尤其重要——编译器很难自动有效地使用矢量指令。

在提交汇编之前，您应该尝试的是使用[编译器内在函数](http://gcc.gnu.org/onlinedocs/gcc/ARM-NEON-Intrinsics.html)。编译器内在函数并不比汇编更具可移植性，但它们应该更易于阅读和编写，并且更易于编译器使用。除了可维护性问题之外，程序集的性能问题是它有效地关闭了优化器（您确实使用了适当的编译器标志来打开它，对吗？）。也就是说：使用内联汇编，编译器无法调整寄存器分配等等，所以如果你不在汇编中编写整个内部循环，它可能仍然没有它应该的效率。

但是，您仍然可以很好地利用新发现的汇编专业知识——因为您现在可以检查编译器生成的汇编，并确定它是否愚蠢。如果是这样，您可以调整 C 代码（如果编译器无法处理，可能手动进行一些[流水线操作](http://en.wikipedia.org/wiki/Software_pipelining)），重新编译它，查看程序集输出以查看编译器现在是否正在执行您想要的操作，然后进行基准测试看看它是否真的运行得更快......

如果您已经尝试了上述方法，但仍然无法促使编译器做正确的事情，请继续在汇编中编写您的内部循环（并且再次检查结果是否实际上更快）。由于上述原因，请务必获取*整个*内部循环，包括循环分支。

最后，正如其他人所提到的，花一些时间来尝试找出“正确的事情”是什么。学习机器架构的另一个好处是，它为您提供了事物如何工作的心理模型——因此您将有更好的机会了解如何组合高效的代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T17:46:49.297

Viktor Latypov 的答案有很多很好的信息，但我想再指出一件事：在您原来的 C 函数中，编译器无法分辨`pIn`并`pOut`指向非重叠的内存区域。现在看看这些行：

```
pOut[0] = sumA / 4;
unsigned int sumB = pIn[4] + 2 * pIn[5] + pIn[6]; 
```

编译器必须假设它`pOut[0]`可能与`pIn[4]`or `pIn[5]`or `pIn[6]`（或任何其他`pIn[x]`）相同。所以它基本上不能重新排序循环中的*任何*代码。

您可以通过声明它们来告诉编译器`pIn`并且`pOut`不要重叠`__restrict`：

```
__restrict uchar *pIn = (uchar*) imBGRA.data;
__restrict uchar *pOut = imByte.data; 
```

这可能会加快您原来的 C 版本的速度。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T16:14:43.313

这是性能和可维护性之间的折腾。通常，快速加载应用程序和功能对用户来说非常好，但需要权衡取舍。现在您的应用程序很难维护，而且速度提升可能是没有根据的。如果您的应用程序的用户抱怨它感觉很慢，那么这些优化是值得付出努力并且缺乏可维护性的，但是如果它来自您需要加速您的应用程序，那么您不应该在优化中走这么远。如果您在应用程序启动时进行这些图像转换，那么速度并不是关键，但如果您在应用程序运行时不断地进行它们（并且做了很多），那么它们更有意义。仅优化用户花费时间并实际体验到速度变慢的应用程序部分。

还查看程序集，他们不使用除法，而只使用乘法，因此请查看您的 C 代码。另一个例子是它优化了你的乘法 2 到两个加法。这又可能是另一个技巧，因为 iPhone 应用程序上的乘法可能比加法慢。

# c# - 在 URI 查询参数中传递键/值对列表的最佳方法

> ID：11508173
> 
> 赞同：0
> 
> 时间：2012-07-16T16:06:22.050
> 
> 标签：c#, httpwebrequest, restful-url, csv, query-parameters

通过 HTTP 请求传递一组键/值对的最佳方法是什么？

例如，我需要向 RESTful 服务发送排序命令。我需要指定要排序的属性列表以及我希望对它们中的每一个进行排序的顺序，例如按**升序排序****标题**，然后按**降序排序****名称**，等等。

 ******这就是我目前构建请求的方式：

&sort=标题：ASC，名称：DESC

所以，我用“：”分隔，然后用“，”分隔。就遵守 RESTful 准则来传递此类数据对而言，这是最好的方法吗？

谢谢，F。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:08:57.040

根据所使用的语言，有多种方法。

通常使用 encode(jsonstring) 是最好的方法，但这也取决于安全设置等......******

# java - 使用 Javascript 将拖动的小程序返回到浏览器窗口

> ID：11508179
> 
> 赞同：0
> 
> 时间：2012-07-16T16:06:44.357
> 
> 标签：java, javascript, applet, draggable, japplet

我希望关闭弹出的小程序以将其返回到被拖出的浏览器窗口。我这样做是为了当用户从小程序的页面移动时，小程序不会对他们保持开放。

我已经尝试过`destroy()`方法，`stop()`方法，以及尝试调用`removeAll()`窗口的容器，但我不确定我是否正确地做到了。

这是我的部分代码，当用户想要取消小程序的执行时会调用它。然而，我没有关闭小程序，而是让小程序变得不可见，尽管这留下了一个大的空白窗口，拖出的小程序曾经是，它留给用户关闭它。

```
function Cancel(){
    document.appletName.cancel();
    document.appletName.setVisible(false);
    window.location="/*newURL*/";
} 
```

我希望该窗口自行关闭，但我不确定该调用什么。

不幸的是，我无权访问小程序的源代码，因此必须从浏览器中完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T14:48:22.187

所以没有办法以“禅”的方式做到这一点，但是让小程序输出某种信息性消息，需要关闭它以及使用`setEnable(false)`它来制作它，这样他们就不能与之交互了用户必须关闭小程序。不是最用户友好的，但如果您的用户坚持将小程序拖出他们的窗口，那么绝对是一个好方法。

# ios - iOS：在 XLS 中读取

> ID：11508181
> 
> 赞同：0
> 
> 时间：2012-07-16T16:06:53.227
> 
> 标签：ios, io, xls

我试图弄清楚如何读取 XLS 文档的内容，并且我能够很好地获取字节，但我不知道从这里去哪里。尝试`[[NSString alloc] initWithBytes:data.bytes length:data.length encoding:NSUTF8StringEncoding]`并且`[NSString stringWithUTF8String:data.bytes]`两者都没有让我到任何地方（null）。您应该如何读取 XLS 文件的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:28:07.350

试图结合两个答案。

“没有先天能力将 Excel 数据读入 Foundation 容器，如 NSArray 或 NSDictionary。但是，您可以将文件（使用 Excel）转换为逗号分隔值 (CSV) 文件，然后解析每一行的单元格在 iPhone 上使用 NSString 实例方法 -componentsSeparatedByString:."

“逗号分隔值 (CSV) 文件以纯文本形式存储表格数据（数字和文本）。纯文本意味着该文件是一个字符序列，没有数据必须被解释为二进制数。 CSV 文件由任意数量的记录组成，由某种换行符分隔；每条记录由字段组成，由其他字符或字符串分隔，最常见的是文字 TAB 或逗号。通常，所有记录都有相同的字段序列"

--

[如何使用objective-c从Excel文档中读取单元格数据](https://stackoverflow.com/questions/3313836/how-to-read-cell-data-from-an-excel-document-with-objective-c)

[Objective-c 从 excel 加载数据](https://stackoverflow.com/questions/9974501/objective-c-loading-data-from-excel)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-27T22:50:55.013

尽管将您的 Excel 文件保存为 CSV 是更简单的答案，但有时这并不是您真正想要的，所以我创建了[QZXLSReader。](https://github.com/QuetzalMX/QuetzalXLSReader)这是一个拖放解决方案，因此使用起来更容易。我不认为它的功能完整，但它对我有用。

它基本上是一个可以打开 XLS 文件并将它们解析为 Obj-C 类的库。一旦你有了这些类，就很容易将它们发送到 Core Data 或字典或你有的东西。

我希望它有帮助！

# javafx-2 - 将对象从一个场景传递到另一个场景

> ID：11508182
> 
> 赞同：3
> 
> 时间：2012-07-16T16:06:53.827
> 
> 标签：javafx-2, scene, fxml

在学习 JavaFX2 的新世界时，我偶然发现了另一个恼人的问题。我正在开发一个具有多个场景（约 10 个场景）的程序。为此，我创建了一个像这样的小类：

```
public class SceneSelector {
    ...
    public void setScene(Stage stage, String fxmlfilename, ObservableList ol) throws Exception{
        String s = "../" + fxmlfilename;
        Parent root = FXMLLoader.load(getClass().getResource(s));
        root.setUserData(ol);

        Scene scene = new Scene(root);
        stage.setScene(scene);

        //show the stage
        stage.show();
    }
} 
```

这个类足以在场景之间切换。现在的问题是我有时需要将数据从 Scene1 传递到 Scene2。我试图通过设置`setUserData()`新场景来做到这一点，该场景基本上适用于一件事。初始化新场景时如何获取用户数据？（因为当时节点仍然为空）

场景1的代码：

```
//Code connected to a button that opens the new Scene
private void openLabID(ActionEvent event) throws Exception {       
    final Stage primaryStage = (Stage) btnNewScene.getScene().getWindow();

    ObservableList<Koe> olAfTeWerkenKoeien = DA_Koe.getAfTeWerkenKoeien();
    ss.setScene(primaryStage, "GUI/scenes/koe/Koe.fxml", olAfTeWerkenKoeien);
} 
```

场景2的代码：

```
public void initialize(URL url, ResourceBundle rb) {
    Scene s = lbl.getScene();
    ObservableList<Koe> olAfTeWerkenKoeien = (ObservableList<Koe>) s.getRoot().getUserData();
    System.out.println(olAfTeWerkenKoeien.size());
} 
```

当然 Scene s 此时给出了一个空值（因为此时 lbl 为空），所以我想知道，是否有一种方法在初始化后立即被触发？

当我将此代码附加到 Scene2 上的按钮时，它就像一个魅力，但它应该自动加载。

编辑：使用 setMyData() 方法设置数据不是问题，但是检索它是：

```
public ObservableList<Koe> getMyData() {
   return this.myData;
} 
```

控制器初始化时如何获取 CustomScene 对象？因为在下面执行此操作将导致 NullPointerException（因为 btnSluiten 尚未初始化）：

```
@Override
public void initialize(URL url, ResourceBundle rb) {
    ...
    Stage stage = (Stage) btnSluiten.getScene().getWindow();
    CustomScene cs = (CustomScene) stage.getScene();

    ObservableList<Koe> olKoe = cs.getMyData();

    System.out.println(olKoe.size());
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T23:15:06.173

如果您真的希望您的场景有意义（也就是存储特定的用户数据），您可以扩展它：

```
public class FooScene extends Scene {
   private ObservableList myData;

   public setMyData(ObservableList data) {
       this.myData = data;
       //handle data
   }
} 
```

确保在场景初始化后调用设置代码以自己调用它的最简单方法：

```
public class SceneSelector {
    ...
    public void setScene(Stage stage, String fxmlfilename, ObservableList ol) throws Exception{
        String s = "../" + fxmlfilename;
        Parent root = FXMLLoader.load(getClass().getResource(s));

        // first: add root to scene
        FooScene scene = new FooScene(root);
        // second: apply data to scene (or root)
        scene.setMyData(ol);
        stage.setScene(scene);

        //show the stage
        stage.show();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-30T08:27:59.497

您可以将控制器用于场景并通过控制器传递数据：

```
String filePath1 =  "../" + fxmlfilename;
URL location1 = YourController1.class.getResource(filePath1);
FXMLLoader fxmlLoader = new FXMLLoader();
fxmlLoader.setLocation(location1);
fxmlLoader.setBuilderFactory(new JavaFXBuilderFactory());
Parent root = (Node) fxmlLoader.load(location1.openStream());

YourController1 ctrl1 = (YourController1) fxmlLoader.getController(); 
```

然后您可以将数据分配给控制器：

```
ctrl1.setUserData(); 
```

最后，只显示你想要的场景：

```
Scene scene = new Scene(root);
stage.setScene(scene);

//show the stage
stage.show(); 
```

在控制器的 initialize() 方法中，只需从控制器获取数据作为通常的数据对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T19:26:09.583

我相信您错过了 Scene 对象中的要点。从 Scene 类文档中我们可以看到：

> JavaFX Scene 类是场景图中所有内容的容器。

这意味着 Scene 对象只是一个容器，因此它不应该保存任何数据。

考虑到这一点，您可以制作另一个带有字段的静态对象，例如

```
private static Label lbl;

...

public static Label getLbl()
{
    return MyStaticObject.Lbl;
}

... 
```

并使用它来存储您的 lbl（或任何适合您信息的对象），然后静态检索它。

我这样做是为了从我的应用程序中设置其他 Stage 对象的所有者。我希望它有所帮助。干杯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-01T08:08:39.700

@Sergey Grinev 的一些补充：

创建自定义场景：

```
package sample;

import javafx.scene.Parent;
import javafx.scene.Scene;

public class DataPassingScene extends Scene {

    public DataPassingScene(Parent parent) {
        super(parent);
    }

    String tafsir;

    public String getTafsir() {
        return tafsir;
    }

    public void setTafsir(String tafsir) {
        this.tafsir = tafsir;
    }
} 
```

假设您的 Main Class Name 是 App.java，然后创建一个方法来显示新 Stage ：

```
public  static void showLayout (Stage primaryStage, String fxmlFileName, String stringData) throws IOException {

        Parent root = FXMLLoader.load(Objects.requireNonNull(App.class.getClassLoader().getResource(fxmlFileName)));
        DataPassingScene scene =  new DataPassingScene(root);

        scene.setTafsir(stringData); // Here we pass the data 

        primaryStage.setScene(scene);
        primaryStage.show();
    } 
```

现在，当您要传递数据时，请从应用程序中的任何 Where / 任何类中调用上述方法，并使用一些数据：

```
 String tafsir = "This My Data" ; 

      try {
      App.showLayout(new Stage(), "showTafsirFxml.fxml",tafsir);
     } catch (IOException e) {
       e.printStackTrace();
    } 
```

然后获取控制器中的数据。要获得场景，您必须获得舞台，并且要获得舞台，您需要使用 FXML 的一个元素，假设这里您的元素是一个按钮，称为 closeButton，所以：

```
@FXML
    private Button closeButton;

@Override
    public void initialize(URL url, ResourceBundle rb) {

        Platform.runLater(new Runnable() {
            @Override public void run() {

                Stage stage = (Stage) closeButton.getScene().getWindow();
                DataPassingScene  scene = (DataPassingScene) stage.getScene();
                String s = scene.getTafsir(); // Here we get the Data
                if(s!=null)
                    System.out.println("This is Tafsir From Highlight Table: "+s);
                else         
                System.out.println("Data Passing Null");
            }});

    } 
```

因为，您必须在上面等待一些时间`runLater`，因为初始化场景需要一些时间。其他明智的场景将是空的。

# android - Android - 具有右对齐视图的椭圆

> ID：11508191
> 
> 赞同：6
> 
> 时间：2012-07-16T16:07:25.560
> 
> 标签：android, layout, alignment

我怎样才能实现以下布局， TextView 是一个`TextView`椭圆形结束，而 View 是`wrap_content`TextView 的右侧？

以下是布局应该如何表现的三个示例，具有不同的 TextView 宽度：

```
|[TextView] [View]              |

|[TextView TextView] [View]     |

|[TextView TextView T...] [View]| 
```

[编辑]

以下`TableLayout`给出了正确的行为：

```
<TableLayout
    android:id="@+id/upper_layout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_toLeftOf="@+id/alert_button"
    android:shrinkColumns="0"
    android:stretchColumns="2" >

    <TableRow>

        <TextView
            android:id="@+id/name_textview"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:ellipsize="end"
            android:includeFontPadding="false"
            android:lines="1"
            android:paddingTop="2dp"
            android:scrollHorizontally="true" />

        <TextView
            android:id="@+id/unread_count_textview"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dp"
            android:gravity="center"
            android:includeFontPadding="false"
            android:paddingBottom="0dp"
            android:paddingLeft="5dp"
            android:paddingRight="5dp"
            android:paddingTop="2dp" />
    </TableRow>
</TableLayout> 
```

使用`TableLayout`3 列，最后一个是 hack ：该`strechColumns`属性使其占用所有可用空间，因此第二个`TextView`总是立即在第一个的右侧。由于该属性，第一个`TextView`椭圆大小正确。`shrinkColumns`

但是，我不喜欢使用 a`TableLayout`来实现这一点的想法。有人知道更好的方法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:55:27.443

试试这个（我现在无法检查，但在我看来它应该可以工作）：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:padding="6dip" >

    <TextView
        android:id="@+id/my_txtvw_txtvw"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:ellipsize="marquee"
        android:maxLines="1" />

    <TextView
        android:id="@+id/my_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@id/my_txtvw_txtvw"
        android:maxLines="1" />

</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T23:57:44.797

尝试这个：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/text1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_toLeftOf="@+id/my_view"
        android:ellipsize="end"
        android:maxLines="1"
        android:layout_alignParentLeft="true"
        android:text="blablabla blablabla"
        android:layout_centerVertical="true"
        android:gravity="center_vertical|left" />

    <TextView
        android:id="@+id/my_view"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:maxLines="1" />

</RelativeLayout> 
```

我不确定你是想要`android:ellipsize="end"`还是`android:ellipsize="marquee"`. 我认为布局对你来说很好，只需替换所需的 ellipsize 值 id 即可。

让我知道你的进展...

# jquery - 自定义 Jquery 验证消息 css

> ID：11508195
> 
> 赞同：0
> 
> 时间：2012-07-16T16:07:31.300
> 
> 标签：jquery, css, jquery-validate

如何在 css 中自定义 Jquery 验证消息

由此 ![在此处输入图像描述](../Images/73b708f440035779c1b11ae1f6d702f6.png)

对此： ![在此处输入图像描述](../Images/d3e2636b5647caa7a947c3461a2f83c8.png)

我可以帮我制作上述样式吗？

我试过了 `label.error { float: none; padding-left: .5em; vertical-align: top; background-color: #333; font-size: 10px; border: 1px solid #999; color: #FFF; display: none; -moz-border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius-bottomleft: 0; -moz-border-radius-topleft: 0; -webkit-border-bottom-left-radius: 0; -webkit-border-top-left-radius: 0; -moz-box-shadow: 0 0 6px #ddd; -webkit-box-shadow: 0 0 6px #ddd; white-space: nowrap; padding-top: 2px; padding-right: 10px; padding-bottom: 2px; padding-left: 5px; font-family: Arial, Helvetica, sans-serif; -moz-opacity: .90; filter: alpha(opacity = 90); opacity: .90; margin-left: 5px; margin-top: -2px; }`

但我无法正确对齐![在此处输入图像描述](../Images/b2f9e7453cc5998a2823cb7cbdbc390f.png)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:10:52.287

像这样的东西：

```
box {
    padding: 5px;
    background: black;
    color: white;
    border: 1px solid gray;
}
box:after {
    content: "";
    position: absolute;
    left: 20px;
    bottom: 0px;
    border-top: 10px solid black;
    border-left: 10px solid transparent;
    border-right: 10px solid transparent;
    border-bottom: 10px solid transparent;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T09:47:28.257

我认为很难像这样自定义默认错误消息。

最好您可以为此进行自定义验证。即，您可以显示消息弹出窗口，而不是显示默认错误消息。所以根据错误的类型你可以显示相应的弹窗。

[在这个http://www.underdog.co.uk/](http://www.underdog.co.uk/)中可以看到类似的事情

# ios - iOS - UINavigationController 并添加左栏按钮？

> ID：11508197
> 
> 赞同：0
> 
> 时间：2012-07-16T16:07:46.733
> 
> 标签：ios, uinavigationcontroller, uibarbuttonitem

下面的 mwthod 是 UINavigationController 的委托方法。我想成为 abel 来决定是否将左侧项目添加到每个页面。下面的代码不起作用，我做错了吗？

**我不想通过 ViewController 本身来执行此操作。我希望 NavigationCopntroller 负责这项任务。**

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated
{
    UIBarButtonItem *menuItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemOrganize 
                                                                                  target:self 
                                                                                  action:@selector(menuItemSelected:)];
    [self.navigationItem setLeftBarButtonItem:menuItem];

    // I also tried 
    // [viewController.navigationItem setLeftBarButtonItem:menuItem];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:14:54.827

我认为问题在于您正在尝试访问`navigationItem`viewController 上的属性，但它不存在，因为在`willShowViewController`方法中 viewController 不在 navigationController 堆栈中，请尝试使用`didShowViewController`委托方法

像这样：

```
- (void)navigationController:(UINavigationController *)navigationController didShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
    UIBarButtonItem *menuItem = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemOrganize 
                                                                                  target:self 
                                                                                  action:@selector(menuItemSelected:)];
    [self.navigationItem setLeftBarButtonItem:menuItem];

    [viewController.navigationItem setLeftBarButtonItem:menuItem]; 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:48:53.563

控制台中有一条警告说“嵌套推送可能会损坏导航控制器”我将 2 个 Viewcontroller 推入堆栈，而不是一次推入 1 个 ViewController。

解决此问题并消除警告也解决了此问题。

# c# - 继承抽象类并实现接口的 C# 表单。

> ID：11508199
> 
> 赞同：4
> 
> 时间：2012-07-16T16:07:51.940
> 
> 标签：c#, winforms, interface, abstract-class

我需要在我的项目中有多个表单类。所以考虑将这些形式共有的所有东西放在抽象类中。该类将具有继承的 Form 类和一个接口。像这样：

```
public interface IMyForm
{
void Init();
}

public abstract class AMyForm : Form, IMyForm
{
    void IBrowser.Init()
    {
        throw new NotImplementedException();
    }     
}

public partial class MainClass : AMyForm 
{

// But here the warning is shown (That i have to add override keyword),
// but when i do, The error is shown that i cannot override from non abstract thing 
    public void Init() 
    {
    }
} 
```

你能告诉我如何实现吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T20:53:04.783

**虽然 Jon Skeets**的回答对于一般编程来说是正确的，但我建议不要在表单和用户控件上使用抽象类。第一个问题是，该设计器将无法创建抽象类的实例，因此将无法在设计器中显示**从**抽象表单继承的表单。这意味着您将无法通过设计器向表单添加新控件，**除非**- 正如下面评论中所建议的那样 - 您添加一个实现抽象类的代理类，然后用作其他继承表单的基础，例如：`AbstractMyForm -> MyFormSurrogate -> MyForm`.

在我看来，第二个也是更大的问题是，这意味着您正试图将逻辑融入表单。这*通常是*不希望的，尤其是当您最终将业务逻辑与显示技术耦合时，在这种情况下`Winforms`。我的建议是尝试使用[Model View Presenter 模式](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93presenter)在普通类（使用抽象类、接口等）中分离尽可能多的逻辑，然后将它们[数据绑定](http://msdn.microsoft.com/en-us/library/c8aebh9k.aspx)到表单。如果有共享的可视部分（例如：一组复选框），请为这些部分制作用户控件，然后在表单上重用它们。

我希望我没有过多地假设您对使用 winforms 的了解太多，但是当我开始从事 GUI 开发时，我也有类似的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-16T16:09:10.457

您只想*不在*抽象类中使用显式接口实现：

```
public abstract class AMyForm : Form, IMyForm
{
    public virtual void Init()
    {
        throw new NotImplementedException();
    }     
} 
```

或者只是使其抽象：

```
public abstract class AMyForm : Form, IMyForm
{
    public abstract void Init();
} 
```

在这两种情况下，您只需在具体类中覆盖它。

或者，如果你*真的*想在你的抽象类中使用显式接口实现，你应该在你的具体类中再次使用它：

```
public partial class MainClass : AMyForm, IMyForm
{
    void IMyForm.Init() 
    {
        // Stuff
    }
} 
```

缺点是任何*不*`AMyForm`这样做的子类基本上都会有损坏的实现。在这里使用第一种方法更好。*`IMyForm`*

 *编辑：或者，根据 supercat 的建议：

```
public abstract class AMyForm : Form, IMyForm
{
    void IBrowser.Init()
    {
        InitImpl();
        // And anything else you need...
    }     

    // Or abstract...
    protected virtual void InitImpl()
    {
    }
} 
```

然后`InitImpl`在你的具体类中覆盖。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-29T01:46:36.903

抽象类未在设计视图中显示；您可以通过在抽象类中添加编译器 if 语句以使其在设计时不抽象来解决它。

```
#if RELEASE
    public abstract class AbstractForm : Form, IInterface
#else
    public class AbstractForm : Form, IInterface
#endif
    {
        // Your abstract code here.
    } 
```

这是一个很好的小技巧，非常有效。您可以使用相同的技巧在设计时和运行时之间切换虚拟方法和抽象方法。

附录：

应该注意的是，不需要使用抽象形式。从非抽象形式继承更有效，并且产生的潜在问题更少。

```
public partial class Screen : Form, IInterface
{
    // Base Class here, complete with .designer.cs and .resx
    public Screen()
    {
        InitialiseComponent();
    }

    #region IInterface imported methods
    public partial void SomeMethod()
    {
        // Do something.
    }
    #endregion
} 
```

然后，如果您想创建一个登录屏幕，例如：

```
public partial class LogonScreen : Screen, IInterface
{
    // Derived Class here, complete with .designer.cs and .resx
    public Screen()
    {
        InitialiseComponent();
    }

    #region IInterface imported methods
    public partial void SomeMethod()
    {
        // Do more somethings!
    }
    #endregion
} 
```*

# java - 获取 id 的电子邮件的完整详细信息

> ID：11508205
> 
> 赞同：0
> 
> 时间：2012-07-16T16:08:24.847
> 
> 标签：java, gmail, gdata-api, google-api-java-client

嗨，我正在尝试在 gmail 中获取电子邮件的完整详细信息，以获取传入邮件的提要，我们必须使用请求标头调用 url [https://mail.google.com/mail/feed/atom/](https://mail.google.com/mail/feed/atom/)然后我必须输入编码的用户名并像这样传递帐户的字 conn.setRequestProperty("Authorization", "Basic " + Base64.encode((username + ":" + password).getBytes()));

我在调用此 url 后用 java 编写代码我正在获取用户的电子邮件提要，但我想了解单个电子邮件的完整详细信息，因为提要中的摘要元素非常短我想获得一封电子邮件的完整摘要，我将收到邮件在获取 id 后，此提要中的 id 使用什么请求标头或参数调用哪个 url，以获取有关特定电子邮件的完整信息，我在此示例中使用 clientlogin。这是代码片段

```
URL url2=new URL("https://mail.google.com/mail/feed/atom/");

        HttpURLConnection conn=(HttpURLConnection)url2.openConnection();
          conn.setDoOutput(true);
          conn.setRequestMethod("GET");

      conn.setRequestProperty("Authorization", "Basic " + Base64.encode(("riteshmehandiratta1" + ":" + "shinderjeetji").getBytes()));

        conn.connect();

        BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));

        String line;

        String contents = "";

        while ((line = reader.readLine()) != null) {

          contents += line;

        }

System.out.println(contents); 
```

用于获取提要。此示例正常工作。如何获取电子邮件详细信息？请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:02:56.843

Gmail 收件箱提要仅返回电子邮件数据的子集，并且仅应用于接收新的电子邮件提醒：

[https://developers.google.com/google-apps/gmail/gmail_inbox_feed](https://developers.google.com/google-apps/gmail/gmail_inbox_feed)

如果你想完全控制收件箱，你应该使用 IMAP：

[https://developers.google.com/google-apps/gmail/oauth_overview](https://developers.google.com/google-apps/gmail/oauth_overview)

# c++ - OpenCV - SURF 功能问题

> ID：11508209
> 
> 赞同：0
> 
> 时间：2012-07-16T16:08:36.493
> 
> 标签：c++, visual-studio-2010, windows-7, opencv

我正在尝试构建一个使用 SURF 匹配算法的 OpenCV 程序，代码在以下链接中：

[http://feelmare.blogspot.ro/2011/10/sift-matching-c-source-code-using.html](http://feelmare.blogspot.ro/2011/10/sift-matching-c-source-code-using.html)

但是，我收到关于一些外部符号的 2 个错误：`_cvExtractSurf`和`_cvSURFParams`。

```
error LNK2019: unresolved external symbol _cvExtractSURF referenced in function "public:    bool __thiscall CMareMatchingClass::ExtractBGsurf(struct _IplImage *)" (?ExtractBGsurf@CMareMatchingClass@@QAE_NPAU_IplImage@@@Z)
error LNK2019: unresolved external symbol _cvSURFParams referenced in function "public: __thiscall CMareMatchingClass::CMareMatchingClass(void)" (??0CMareMatchingClass@@QAE@XZ) 
```

你知道我该如何解决这个错误吗？我在 Windows 7 - 64 位的 Visual Studio 2010 中使用 opencv 2.3.0 运行代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:27:38.647

您没有链接所需的库 - 尝试在项目设置中链接所有 OpenCV 库。请参阅[文档](http://msdn.microsoft.com/en-us/library/799kze2z%28v=vs.80%29.aspx)。

# c# - Server.Mappath 错误

> ID：11508212
> 
> 赞同：-2
> 
> 时间：2012-07-16T16:08:43.700
> 
> 标签：c#

我正在尝试从服务器填充下拉框获取文件夹名称，但此代码显示错误。它在本地工作。但在服务器中不起作用。任何人都可以帮助解决这个问题

```
DirectoryInfo dirInfo = new DirectoryInfo(Server.MapPath(@"~\\*.***.***.**\Flextronics\Common\Surendra"));
// DirectoryInfo dirInfo = new DirectoryInfo("D:\\New Folder");
ddlModel.DataSource = dirInfo.GetDirectories();
ddlModel.DataBind(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T15:19:29.453

~ 符号查找本地计算机上代码文件的父文件夹

要访问网络驱动器上的 UNC，您需要类似以下内容：

```
Server.MapPath("\\\\servername\\folder\\desiredfile.ext"); 
```

"\\\\" 转义字符，您需要这样做才能正确导航。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:11:21.413

`Server.MapPath(@"~\\*.***.***.**\Flex...`返回虚拟路径，它适用于本地，因为你有物理路径`"D:\...."`

所以你必须使用`Request.MapPath("~/.....");`，因为它将指定的虚拟路径映射到物理路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-11T15:01:02.080

目录不喜欢 Server.MapPath。硬编码：

```
...new DirectoryInfo("stringUNCtoLoadFilesFrom"); 
```

# onclick - 阻止函数 onclick 但将其保留在代码中 | 小书签

> ID：11508221
> 
> 赞同：0
> 
> 时间：2012-07-16T16:09:10.527
> 
> 标签：onclick, bookmarklet

我有一个书签，希望人们将其拖到书签栏。如果不小心在网页中单击了小书签，我想防止该功能被触发。我该怎么做？

谢谢

```
 <div id="bookmarklet">
      <a href="javascript:(function(){alert('mimmo');});" class="title">Bookmarklet</a>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:22:23.570

```
onclick="alert('this is a bookmarklet');return false" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-18T02:10:06.850

用这个：

```
<div id="bookmarklet">
  <a href="javascript:(function(){alert('mimmo');})()" onclick="return false" class="title">Bookmarklet</a>
</div> 
```

或这个：

```
<div id="bookmarklet">
  <a href="javascript:(function(){alert('mimmo');})()" onclick="alert('Drag and drop this link onto browser toolbar to install');return false" class="title">Bookmarklet</a>
</div> 
```

我已经更正了`HREF`脚本代码，因为原始代码会声明一个函数而不执行它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:47:04.097

我这样解决了：

```
<script type="text/javascript">
    $('#bookmarklet a').mousedown(function() {
        $('#bookmarklet a').attr("href", "alert('mimmo')")
    });
    $('#bookmarklet a').mouseup(function() {
        $('#bookmarklet a').attr("href", "#")
    });
</script> 
```

# jquery - Jquery检查表行移动到顶部并返回未选中

> ID：11508222
> 
> 赞同：1
> 
> 时间：2012-07-16T16:09:16.077
> 
> 标签：jquery, tablerow

我对 JQuery 编程非常陌生，需要 JQuery 专家的帮助。我想要表格行中的 pin-able 功能。

设想：

1.  当我选中行中的复选框时，同一行移动到表格顶部。
2.  当我取消选中任何已选中的行时，移动到它被移动的同一个地方。

jsfiddle 演示：http: [//jsfiddle.net/safkass/DhpBw/8/](http://jsfiddle.net/safkass/DhpBw/8/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:32:01.530

可以使用一些清理，但这似乎工作（[jsfiddle](http://jsfiddle.net/7Xmt2/5/)）：

```
$(document).ready(function () {
            $('#grid').tablesorter({ widgets: ['staticRow'] });
            $("input").click(function () {
                var row = $(this).parents("tr:first");
                if ($(this).is(':checked', true)) {
                    var firstRow = row.parent().find("tr:first").not(row);
                    var index = row.parent().find("tr").index(row);
                    row.addClass("TopRow");
                    row.insertBefore(firstRow).data("prevIndex", index);
                } else {
                    row.removeClass("TopRow");
                    var rows = row.parent().find("tr");
                    var newPos = $(rows[row.data("prevIndex")]);
                    if (newPos > 0) {
                        row.insertAfter(newPos);
                    }
                }
             });
        });​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:10:01.560

这是我的小提琴：我相信它可以达到您想要的目的：

[演示](http://jsfiddle.net/DhpBw/14/)

即使在取消选中它们之前检查多行或全部时，这也有效。

# backbone.js - 如何在骨干木偶初始化程序中处理异步代码

> ID：11508225
> 
> 赞同：6
> 
> 时间：2012-07-16T16:09:35.697
> 
> 标签：backbone.js, marionette

我正在尝试使用 marionette 插件将主干应用程序放在一起，并且在让初始化程序按照我期望的方式工作时遇到了一些麻烦。我有以下代码：

```
var MyApp = new Backbone.Marionette.Application();

MyApp.addRegions({
    region1 : '#div1',
    region2 : '#div2'
});

MyApp.Resources = { };

MyApp.bind('initialize:before', function (options) {
    // display a modal dialog for app initialization
    options.initMessageId = noty({
        text : 'Initializing MyApp (this should only take a second or two)',
        layout : 'center',
        speed : 1,
        timeout : false,
        modal : true,
        closeOnSelfClick : false
    });
});

MyApp.addInitializer(function (options) {
    $.ajax({
        url: options.apiUrl + '/my-app-api-module',
        type: 'GET',
        contentType: 'application/json; charset=utf-8',
        success: function (results) {
            MyApp.Resources.urls = results;
            console.log(MyApp.Resources.urls); // <- THIS returns an object
        }
    });
});

MyApp.bind('initialize:after', function (options) {
    // initialization is done...close the modal dialog
    if (options.initMessageId) {
        $.noty.close(options.initMessageId);
    }

    if (Backbone.history) {
        Backbone.history.start();
    }

    console.log(MyApp.Resources.urls); // <- THIS returns 'undefined' BEFORE the console.log in the initializer above
}); 
```

请注意，在上面的代码中，我有两个`console.log`调用，一个在初始化程序中，一个在`initialize:after`处理程序中。两者都记录相同的对象属性。如您所见，我遇到的是处理程序中的`console.log`调用在初始化程序处理程序中的调用*之前*`initialize:after`被调用。我意识到这是因为初始化程序中有一个异步调用......我需要知道的是，在应用程序中执行任何其他操作之前，如何确保我的初始化程序中的所有异步代码都是完整的? 这有一个好的模式吗？我在文档中没有找到任何指示如何正确处理此问题的内容。*`success`*

 *谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T16:55:20.910

> 在应用程序中执行任何其他操作之前，如何确保我的初始化程序中的所有异步代码都是完整的？

不要使用该`initialize:after`事件。相反，从调用中触发您自己的事件`success`，然后从该调用绑定您的应用程序启动代码。

```
MyApp.addInitializer(function (options) {
    $.ajax({
        url: options.apiUrl + '/my-app-api-module',
        type: 'GET',
        contentType: 'application/json; charset=utf-8',
        success: function (results) {
            MyApp.Resources.urls = results;

            // trigger custom event here
            MyApp.vent.trigger("some:event:to:say:it:is:done")

        }
    });
});

// bind to your event here, instead of initialize:after
MyApp.vent.bind('some:event:to:say:it:is:done', function (options) {

    // initialization is done...close the modal dialog
    if (options.initMessageId) {
        $.noty.close(options.initMessageId);
    }

    if (Backbone.history) {
        Backbone.history.start();
    }

    console.log(MyApp.Resources.urls);
}); 
```

这样，您将在异步内容完成后触发事件，这意味着处理程序中的代码将在初始异步调用返回并设置好之后才会运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T21:08:02.180

我使用 jQuery defereds 重写了 start 方法，因此您可以指定一个异步初始化器，如身份验证。start 方法然后等待直到所有延迟都被解决，然后完成启动。

我用我的新同步回调类替换了木偶回调，这样我就可以在应用程序中使用常规方法调用。看看我的解决方案，看看是否有帮助。[https://github.com/AlexmReynolds/Marionette.Callbacks](https://github.com/AlexmReynolds/Marionette.Callbacks)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-03T18:42:52.800

这可用于在应用程序的其余部分开始之前完成任务。检查[文档](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.application.md)。

```
// Create our Application
var app = new Mn.Application();

// Start history when our application is ready
app.on('start', function() {
  Backbone.history.start();
});

// Load some initial data, and then start our application
loadInitialData().then(app.start); 
```*

# c++ - C++ 布尔函数返回 56

> ID：11508228
> 
> 赞同：7
> 
> 时间：2012-07-16T16:09:37.820
> 
> 标签：c++

我有一个返回布尔值的函数：

```
bool restart()
{
    std::string answer;
    bool answered = false;
    while(answered == false)
    {
        cout << endl << endl << "Do you want to play again? y/n : ";
        cin >> answer;
        if(answer == "y" || answer == "Y" || answer == "1" || answer == "yes")
        {return true;}
        if(answer == "n" || answer == "N" || answer == "0" || answer == "no")
        {return false;}
    }
} 
```

当我使用以下方法调用它时：

```
cout << restart(); 
```

我得到输出：

```
Do you want to play again? y/n : y
56 
```

谁能看到如何解决这个奇怪的问题？提前致谢。

我现在的 WIP 代码：

```
#include <iostream>
#include <cstdlib>

using namespace std;

void drawScreen(int grid[3][3]);                               //
int movef(int grid[3][3], bool playersMove);
int updateGrid(int grid[3][3], int move, bool playersMove);
bool hasWon(int grid[3][3]);
bool swapMover(bool playersMove);                              //
bool restart();
void endGame();

int main()
{
    int grid[3][3] = {{1,2,3},{4,5,6},{7,8,9}};
    bool appRunning = true, gameRunning = true, playersMove = true;
    int move;

    // tests //
    std::cout << restart();
    // tests //

    //while(appRunning == true)
    //{
    //    while(gameRunning == true)
    //    {
    //        drawScreen(grid);
    //        move = movef(grid, playersMove);
    //        grid[3][3] = updateGrid(grid, move, playersMove);
    //        drawScreen(grid);
    //        gameRunning = hasWon(grid);
    //        playersMove = swapMover(playersMove);
    //    }
    //    appRunning = restart();
    //}
    //endGame();
    }

    void drawScreen(int grid[3][3])
    {
        for(int i = 0; i < 3; i++)
        {
             for(int j = 0; j < 3; j++)
             {
             if(grid[i][j] == 10){cout << "X  ";if(j == 2){cout << endl << endl;}}
             if(grid[i][j] == 11){cout << "O  ";if(j == 2){cout << endl << endl;}}
             if(grid[i][j] != 10 && grid[i][j] != 11){cout << grid[i][j] << "  ";
             if(j == 2){cout << endl << endl;}}
             }
        }
   }

  int movef(int grid[3][3], bool playersMove)
  {
       return 0;
  }

  int updateGrid(int grid[3][3], int move, bool playersMove)
  {
       return 0;
  }

  bool hasWon(int grid[3][3])
  {
      return false;
  }

  bool swapMover(bool playersMove)
  {
       if(playersMove == true){return false;}
       if(playersMove == false){return true;}
  }

bool restart()
{
    std::string answer;
    bool answered = false;
    while(answered == false)
    {
       cout << endl << endl << "Do you want to play again? y/n : ";
       cin >> answer;
       if(answer == "y" || answer == "Y" || answer == "1" || answer == "yes")
       {return true;}
        if(answer == "n" || answer == "N" || answer == "0" || answer == "no")
       {return false;}
    }
}

void endGame()
{

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:37:33.623

[这在某种程度上是对我的评论的重新发布，因为 OP 说它解决了他的问题]

您没有在 while 循环之外定义返回值。如果您以某种方式超出它，则不会返回值（尽管我不知道预期的行为，或者即使在这种情况下预期有任何行为）

为了使我的回答更彻底，我发现了这一点： [为什么在不返回值的情况下从非 void 函数的末尾流出不会产生编译器错误？](https://stackoverflow.com/questions/1610030/why-can-you-return-from-a-non-void-function-without-returning-a-value-without-pr)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T16:44:52.283

好的，我在猜测。您的原始代码有该行

```
grid[3][3] = updateGrid(grid, move, playersMove); 
```

你的网格定义是

```
int grid[3][3] = {{1,2,3},{4,5,6},{7,8,9}}; 
```

这意味着您正在写出数组边界。这是未定义的行为。请更正此问题并检查您的程序是否按预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-10T15:49:26.790

我使用了 mingw32 编译器，在使用 g++ 4.8 时它工作正常。这似乎是一个编译器错误。（感谢灰熊）

# reporting-services - 我在 SSRS 的“查询设计器”的“定义查询参数”中输入什么来获取数组？

> ID：11508230
> 
> 赞同：0
> 
> 时间：2012-07-16T16:09:43.607
> 
> 标签：reporting-services, ssrs-2008

我有一个这样的查询：

```
SELECT
    *
FROM
    someTable
WHERE
    id IN (@EngineType_ids) 
```

查询工作得很好。我可以通过多选设置参数，所有工作都完美无缺。我的问题是： **我在框中输入什么来让 SSRS 返回多个结果？**（单个整数工作正常。我根本无法与此对话框沟通，我输入的字符串不应被解析为单个整数）

（我无法发布图片。可以在此处找到图片：http: [//imgur.com/tAQHb](http://imgur.com/tAQHb)）

*   =Split("1,2,3",",") 不起作用
*   (1,2,3) 不起作用
*   [1,2,3] 不起作用所有导致整个字符串试图被解析为单个整数

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T11:48:34.573

试试 1,2,3（不带括号）

# php - 将具有 GMT 偏移量的 MySQL 时间戳转换为本地 PHP 时间戳

> ID：11508231
> 
> 赞同：0
> 
> 时间：2012-07-16T16:09:47.467
> 
> 标签：php, timestamp, timestamp-with-timezone

我有一个外部供应商调用的 PHP 脚本。GET 值之一是 MySQL 格式的时间戳，GMT + 0200。这是一个示例：

2012-07-16 16:51:22

我可以将其转换为我使用后的格式：

```
$converted =  date ("m/d/Y h:i:s A", strtotime ($ts) ); 
```

但是，我也想将其转换为当地时间，例如 GMT + 10。我对最后一点感到困惑 - 如果有人可以推荐一些在时区/GMT 偏移量之间转换的选项，我将不胜感激，因为我不确定哪个 PHP 函数使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:17:58.120

使用 DateTime，如下所示：

```
$date = new DateTime($ts);
$date->setTimeZone(new DateTimeZone("Europe/Amsterdam");
$converted = date_format($date, 'm/d/Y h:i:s A'); 
```

# c - 为什么 char 数组需要 strcpy 而 char star 不需要 - 在 C 中使用结构

> ID：11508233
> 
> 赞同：3
> 
> 时间：2012-07-16T16:09:56.900
> 
> 标签：c, arrays, struct, strcpy

我对此代码有误解-

```
typedef struct _EXP{
    int x;
    char* name;
    char lastName[40];
 }XMP

...main...
XMP a;
a.name = "eaaa";
a.lastName = strcpy(a.lastName, "bbb"); 
```

为什么我不能使用：`a.lastName = "bbbb";`仅此而已？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:13:08.050

考虑一下这里的类型。该数组包含字符串的**内容**，而`char*`仅**指向**数据。因此数组需要`strcpy`和朋友。

此外，如果您`char*`在堆或堆栈上分配内存，然后想为其分配一些内容，您还必须使用`strcpy`，因为仅仅分配会创建一个悬空指针（即内存泄漏）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:13:13.480

因为数组的位置是固定的，而指针（它本身就是一个位置）的值不是。您可以将新值分配给指针，但不能分配给数组。

在引擎盖下，它们都是一样的。C 中的数组名称是一个指针，但从语义的角度来看，您不能重新分配数组，但可以重新指向指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:17:07.177

当你写

```
a.name = "eaaa" ; 
```

编译器将为 NULL 终止的字符串分配内存，`eaaa\0`并且由于该指令，它将使指针`name`指向该位置（例如，该`name`变量将包含该字符串的第一个字节所在的内存位置的地址）。

如果你有数组，你已经有一个分配的内存区域（不能分配给另一个内存位置！），你只能用数据填充它（在这种情况下字节代表你的字符串）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-15T10:37:19.997

这是我对可能是什么原因的理解。

我认为这与语言的工作方式有关。C（以及 C++）生成非托管代码 - 这意味着它们不需要运行环境（如 JVM）来管理内存、线程等。因此，代码被生成为由操作系统直接运行的可执行文件. 出于这个原因，可执行文件包括信息，例如，为包括数组在内的每种类型（虽然不确定动态类型）分配多少空间。（这也是 C++ 引入头文件的原因，因为这是在编译期间了解对象大小的唯一方法）

**因此，当编译器看到一个字符数组时，它会计算在编译阶段**需要多少空间并将该信息放入可执行文件中。运行程序时，流程可以计算出需要多少空间并分配多少内存。如果您多次更改它，假设在 C 函数中，每个赋值都会使前一个（s）无效。所以，IMO，这就是编译器不允许这样做的原因。

# javascript - 无法弄清楚为什么我的图像不会延迟加载

> ID：11508234
> 
> 赞同：-1
> 
> 时间：2012-07-16T16:09:57.897
> 
> 标签：javascript, jquery

嘿伙计们，我似乎根本无法在[我的页面](http://www.childrenoftheson.com/newindex/Untitled-14.html)上使用lazyload ，我不明白为什么。我环顾四周，仍然不知道。

我需要它，因为我正在为我的乐队 www.childrenoftheson.com/newindex/Newtest.html 设计一个新页面，并且由于整个网站都在一个页面上运行，我需要延迟加载图像以加快速度。

我也很想知道是否有人可以为我指出延迟加载小部件的正确方向。

感谢任何帮助/愤怒：D。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:42:57.773

尝试将延迟加载指向正确的 Web 路径：

```
<script src="https://raw.github.com/tuupola/jquery_lazyload/master/jquery.lazyload.min.js" type="text/javascript" charset="utf-8"></script> 
```

加上以这种方式加载意味着您​​的用户可能已经下载了文件，从而节省了他们在页面加载上的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:45:53.327

对我来说，似乎在您的服务器上找不到包含 jquery 插件 (jquery.lazyload.js) 的文件。它似乎位于[http://www.childrenoftheson.com/jquery.lazyload.js](http://www.childrenoftheson.com/jquery.lazyload.js)。在您的源代码中，您将其包括在内：

```
<script src="jquery.lazyload.js" type="text/javascript" charset="utf-8"></script> 
```

这解决了错误的路径。

如果您使用的是 Firefox，您可能想查看[Firebug](http://getfirebug.com/)的“Net”选项卡以查看哪些文件无法找到/加载...

# c# - Bron-Kerbosch 算法的 C# 实现

> ID：11508237
> 
> 赞同：7
> 
> 时间：2012-07-16T16:10:02.890
> 
> 标签：c#, .net, algorithm, graph, graph-algorithm

我正在尝试在图论中编写[Bron-Kerbosch 算法](http://en.wikipedia.org/wiki/Bron-Kerbosch_algorithm)的 C# 实现，该算法用于在图中查找最大大小的集团。

理想情况下，该算法将生成一个图列表，其中每个图将代表来自初始输入图的最大团。我的代码没有产生预期的结果，我希望得到一些指导来编写更好的代码来实现这个实现。

此实例中使用的图形类是基于图形的邻接列表表示的自定义类。

```
public class BronKerbosch
{
    public List<Graph<Person>> Run(Graph<Person> R, Graph<Person> P, Graph<Person> X, List<Graph<Person>> maximalCliques)
    {
        // if P and X are both empty, and the size of R is greater than 1 (implies clique):
        if (!P.Nodes.Any() && !X.Nodes.Any() && R.Nodes.Count() > 1)
            // report R as a maximal clique
            maximalCliques.Add(R);

        else
        {
            // Copy P's nodes for traversal
            List<GraphNode<Person>> nodesCopy = P.Nodes.ToList();

            // For each node v in P:
            foreach (GraphNode<Person> v in nodesCopy)
            {

                // Make graph with just v
                Graph<Person> vGraph = new Graph<Person>(new NodeList<Person>());
                vGraph.AddNode(v);

                // Make graph with just v's neighbors
                Graph<Person> neighborGraph = new Graph<Person>(v.Neighbors);

                // Move v to X
                P.Remove(v.Value);

                // BronKerbosch(R U {v}, P INTERSECT N(v), X INTERSECT N(v)))
                maximalCliques = Run(R.Union(vGraph), P.Intersect(neighborGraph), X.Intersect(neighborGraph), maximalCliques);

                X = X.Union(vGraph);
            }
        }
        return maximalCliques;           
    }
} 
```

提供的任何帮助将不胜感激 - 如果我可以提供任何其他信息，请告诉我。

--

**更新 1**输入和输出的一个上下文是三个人的图表 - 人员 A、人员 B 和人员 C。下面提供了代码以提供更准确的详细信息：

```
graphR = new Graph<Person>(new NodeList<Person>());
graphP = new Graph<Person>(new NodeList<Person>());
graphX = new Graph<Person>(new NodeList<Person>());

Person personA = new Person() {FirstName = "Person A"};
Person personB = new Person() {FirstName = "Person B"};
Person personC = new Person() {FirstName = "Person C"};

Anode = new GraphNode<Person>(personA);
Bnode = new GraphNode<Person>(personB);
Cnode = new GraphNode<Person>(personC);

graphP.AddNode(Anode);
graphP.AddNode(Bnode);
graphP.AddNode(Cnode);

graphP.AddUndirectedEdge(Anode, Bnode);
graphP.AddUndirectedEdge(Cnode, Anode);

expectedClique1 = new Graph<Person>(new NodeList<Person>());
expectedClique1.AddNode(Anode);
expectedClique1.AddNode(Bnode);
expectedClique1.AddUndirectedEdge(Anode, Bnode);

expectedClique2 = new Graph<Person>(new NodeList<Person>());
expectedClique2.AddNode(Cnode);
expectedClique2.AddNode(Anode);
expectedClique2.AddUndirectedEdge(Cnode, Anode);

maximalCliques = new List<Graph<Person>>();

bronKerbosch = new BronKerbosch();

bronKerbosch.Run(graphR, graphP, graphX, maximalCliques); 
```

在这种情况下，我希望输出是两个图 expectedClique1 和 expectedClique2 - 但是，实际输出是只有 personA 的四个图。希望这可以帮助！

--

**更新 2**看来我已经找到了解决问题的方法，但我很犹豫要不要结案，直到我进行更多测试以确认我的解决方案是正确的。当我能够确认我的解决方案足够时将更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T20:31:50.947

为了扩展 ananthonline 的评论，包含数据结构，例如这些是单元测试的完美候选者。启动您最喜欢的测试框架并设置您的预期输出，包括所有边界条件。

从简单开始，将其变为绿色，然后扩展。将您的期望形式化将帮助您思考算法，并可能为您打开灯泡。

# r - 如何调用 randomForest predict 与 ROCR 一起使用？

> ID：11508238
> 
> 赞同：0
> 
> 时间：2012-07-16T16:10:06.727
> 
> 标签：r, random-forest

我很难理解如何构建 ROC 曲线，现在我得出的结论是，我可能没有正确创建模型。我在类属性“y_n”为 0 或 1 的数据集中运行随机森林模型。出于预测目的，我将数据集划分为 bank_training 和 bank_testing。这是我做的步骤：

```
bankrf <- randomForest(y_n~., data=bank_training, mtry=4, ntree=2,
                  keep.forest=TRUE, importance=TRUE)
bankrf.pred <- predict(bankrf, bank_testing, type='response',
                  predict.all=TRUE, norm.votes=TRUE) 
```

到目前为止我所做的是否正确？创建的 bankrf.pred 对象是一个列表对象，具有 2 个名为：聚合和个体的类。我不明白这两个类名是从哪里来的？此外，当我运行时：

```
summary(bankrf.pred)
           Length Class  Mode     
aggregate  22606  factor numeric  
individual 45212  -none- character 
```

这个总结是什么意思？数据集（训练和测试）分别为 22605 和 22606。如果有人可以向我解释发生了什么，我将不胜感激。我认为这一切都有问题。

当我尝试使用 ROCR 设计 ROC 曲线时，我使用以下代码：

```
library(ROCR)
pred <- prediction(bank_testing$y_n, bankrf.pred$c(0,1))

Error in is.data.frame(labels) : attempt to apply non-function 
```

我尝试创建 ROC 曲线的方式只是一个错误，还是从 randomForest 开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:54:23.863

您尝试使用的函数的文档包括对其两个主要参数的描述：

> **预测** 包含预测的向量、矩阵、列表或数据框。
> 
> **标签** 包含真实类标签的向量、矩阵、列表或数据框。必须具有与“预测”相同的维度。

您当前正在将变量传递`y_n`给`predictions`参数，而在我看来，参数看起来像是胡说八道`labels`。

预测将存储在随机森林模型的输出中。如 中`?predict.randomForest`所述，它将是一个包含两个组件的列表。`aggregate`将包含整个森林的预测值，而`individual`将包含每棵树的预测值。

所以你可能想做这样的事情：

```
predictions(bankrf.pred$aggregate, bank_testing$y_n) 
```

看看它是如何工作的？*预测*值被传递给参数，而`predictions`“标签”或真实值被传递给`labels`参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-12T00:03:51.333

如果您只是想获得预测的类，则应该删除`predict.all=TRUE`参数。`predict`通过使用`predict.all=TRUE`，您告诉函数保留所有树木的预测，而不是来自森林的预测。

# paypal - 从 PayPal 获取无证 P_TRANSTATEN

> ID：11508239
> 
> 赞同：0
> 
> 时间：2012-07-16T16:10:06.460
> 
> 标签：paypal, payment-gateway, payflowpro

我正在查询交易状态历史记录，在来自 PayPal 的响应中，我得到一个未知的 P_TRANSTATEN 值为 0。这是响应末尾的示例（前面部分与此无关）

```
&P_RESULT1=23&P_TENDER1=C&P_AMT1=30.00&P_TRANSTATE1=0 
```

任何人都可以对此有所了解吗？

编辑：根据我发现的他们的文档，这些是预期的代码：

```
P_TRANSTATEn TRANS_STATE of the particular payment.
 1: error 
 6: settlement pending 
 7: settlement in progress 
 8: settlement completed/successfully 
 11: settlement failed 
 14: settlement incomplete 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:15:27.413

好的，似乎 0 是取消定期配置文件时分配给事务的状态。

# c# - 如何提供列表 到 SQL 参数？

> ID：11508240
> 
> 赞同：23
> 
> 时间：2012-07-16T16:10:07.873
> 
> 标签：c#, sql, winforms

我有如下 SQL 语句：

```
...
const string sql = @"UPDATE PLATYPUS
SET DUCKBILLID = :NEWDUCKBILLID
WHERE PLATYPUSID IN (:ListOfInts)";
...
ocmd.Parameters.Add("ListOfInts", ??WhatNow??); 
```

如何提供逗号分隔的整数列表，它可以是任何（合理*）数量的值

*   在这种情况下，“合理”是指一到几十个。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T16:14:35.893

您不能，您必须创建一些替换`:ListOfInts`为（例如）的辅助函数，`:I0,:I1,:I2...`并通过在代码中一一添加来传递参数。[Dapper.Net](http://code.google.com/p/dapper-dot-net/)在[其列表支持](http://code.google.com/p/dapper-dot-net/#List_Support)中优雅地模拟了您想要的功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T16:13:46.023

我认为唯一可能的解决方案是传递逗号分隔的值，您可以使用函数将其转换为 SQL 中的表。这是我正在使用的功能

```
CREATE FUNCTION dbo.CSVToList (@CSV varchar(3000)) 
    RETURNS @Result TABLE (Value varchar(30))
AS   
BEGIN
    DECLARE @List TABLE
    (
        Value varchar(30)
    )

    DECLARE
        @Value varchar(30),
        @Pos int

    SET @CSV = LTRIM(RTRIM(@CSV))+ ','
    SET @Pos = CHARINDEX(',', @CSV, 1)

    IF REPLACE(@CSV, ',', '') <> ''
    BEGIN
        WHILE @Pos > 0
        BEGIN
            SET @Value = LTRIM(RTRIM(LEFT(@CSV, @Pos - 1)))

            IF @Value <> ''
                INSERT INTO @List (Value) VALUES (@Value) 

            SET @CSV = RIGHT(@CSV, LEN(@CSV) - @Pos)
            SET @Pos = CHARINDEX(',', @CSV, 1)
        END
    END     

    INSERT @Result
    SELECT
        Value
    FROM
        @List

    RETURN
END 
```

您可以使用以下代码（例如）执行操作：

```
DECLARE @CSV varchar(100)
SET @CSV = '30,32,34,36,40'

SELECT 
    ProductID, 
    ProductName, 
    UnitPrice
FROM 
    Products
WHERE
    ProductID IN (SELECT * FROM dbo.CSVToLIst(@CSV)) 
```

我从这里获取代码：[http ://www.geekzilla.co.uk/view5C09B52C-4600-4B66-9DD7-DCE840D64CBD.htm](http://www.geekzilla.co.uk/view5C09B52C-4600-4B66-9DD7-DCE840D64CBD.htm)

希望能帮助到你。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-16T20:18:50.483

您没有说明您正在使用哪个数据库，但如果它是 SQL Server 2008+，您可能还需要考虑[Table Valued Parameters](http://msdn.microsoft.com/en-us/library/bb675163.aspx)。

对于您的示例，增加的复杂性可能不值得，但它们在其他场景中可能很有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T16:17:00.273

处理此问题的最佳方法是将列表保存在数据库中，这样您就可以编写一个选择查询来返回列表中的值。问题是，当数据来自客户端时，你怎么能做到这一点？大多数情况下，这些数据是由用户亲自挑选的，一次一条记录。在这种情况下，您可以使用一个表格（想想：“购物车”），在用户选择它们时，一次添加一个值的记录。如果它更像是一个批处理作业，您可能希望使用 BulkInsert 进程来创建记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T16:13:11.927

在 Ints 数组上使用 的`Join`方法。`string`您可以提及`comma` 作为分隔符

```
List<int> ints = new List<int>();
ints.Add(4);
ints.Add(6);
ints.Add(2);

string concatenatedIds= string.Join(",", ints.ToArray()); 
```

输出（ 中的值`concatenatedIds`）将为`4,6,2`。您可以将该字符串用作`IN`子句的参数值

```
ocmd.Parameters.Add("ListOfInts",concatenatedIds); 
```

# objective-c - 将一个类中声明的变量传递给另一个类

> ID：11508247
> 
> 赞同：1
> 
> 时间：2012-07-16T16:10:33.620
> 
> 标签：objective-c, ios, xcode

我试图在一个视图的文本字段中设置一个数字，该数字由一个类控制，并使该数字出现在另一个由其他类控制的视图中的标签中，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:25:25.077

非常简单的方法是 NSUserDefault。我不推荐这样做，但这是获取数据的一种方式

保存

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];

// saving an NSString

[prefs setObject:@"TextToSave" forKey:@"keyToLookupString"];

// saving an NSInteger

[prefs setInteger:42 forKey:@"integerKey"];

// saving a Double

[prefs setDouble:3.1415 forKey:@"doubleKey"];

// saving a Float

[prefs setFloat:1.2345678 forKey:@"floatKey"];

// This is suggested to synch prefs, but is not needed (I didn't put it in my tut)
[prefs synchronize];

Retrieving

NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];

// getting an NSString

NSString *myString = [prefs stringForKey:@"keyToLookupString"];

// getting an NSInteger

NSInteger myInt = [prefs integerForKey:@"integerKey"];

// getting an Float

float myFloat = [prefs floatForKey:@"floatKey"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:17:48.297

多次转发，例如：

[如何将参数传递到 iOS 中的视图中？](https://stackoverflow.com/questions/3924522/how-can-i-pass-a-parameter-into-a-view-in-ios)

[iphone将字符串传递给项目中的另一个.m文件](https://stackoverflow.com/questions/11507906/iphone-pass-string-to-another-m-file-in-project/)

你也可以看起来`segue`和`protocol delegate`

# c - 从 IP 摄像机抓取非连续帧

> ID：11508251
> 
> 赞同：0
> 
> 时间：2012-07-16T16:10:47.093
> 
> 标签：c, opencv, ffmpeg

我正在做一个项目，我需要每隔一秒（或两秒）从 IP 摄像机中检索帧并以某种方式处理它。初始化捕获后

```
CvCapture* capture = cvCaptureFromFile(ipSource); 
```

我从引入一（或两）秒延迟的循环中获取帧 -

```
frame = cvQueryFrame(capture); 
```

问题 - 我只得到连续的帧（我想来自缓冲区），而不是我试图得到它的那一刻的帧。我应该怎么做才能在我想要的那一刻获得框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:19:37.623

`cvQueryFrame`实际上调用`cvGrabFrame()`然后`cvRetrieveFrame()`。第一个函数从相机中检索图像并将其存储在内部。第二帧实际上将其解压缩并将 IPLImage 返回给您。您可以手动调用它并将您的处理器繁重的代码放在它们之间。

其他选项（快速和肮脏）是运行一个不同的线程，它将连续抓取帧。然后，您可以轻松获得最新帧。

希望有帮助..

# ms-access - 打开Access mdb时弹出READ ONLY，但实际上不是根据Properties

> ID：11508253
> 
> 赞同：0
> 
> 时间：2012-07-16T16:10:59.160
> 
> 标签：ms-access, readonly, ms-access-2003

关于为什么我打开某些 MS Access mdb 文件（abc.mdb）的任何想法，msgbox 弹出说它是只读的，但实际上不是当我右键单击 mdb 以查看“属性”时？

1.  mdb 所在的文件夹可以在其中写入文件夹/txt 文件。
2.  我将一个虚拟 mdb 文件复制到该文件夹​​中，并且该只读 msgbox 不会在该虚拟 mdb 中弹出。READ ONLY 问题似乎只存在于 ABC.mdb
3.  我在该文件夹中没有看到任何 .ldb 文件。

对此有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T02:00:54.120

几个建议（按顺序）：

*   检查“文件属性”对话框中的安全权限。确保管理员或您的登录名具有完全控制权。

*   修复并压缩数据库文件。运行此命令：“C:\Program Files\Microsoft Office\Office11\MSACCESS.EXE”“DatabaseFile.mdb”/nostartup /repair /compact

*   尝试在其他文件夹中打开，例如您的桌面。

*   如果一切都失败了.. 在同一文件夹中创建一个新的访问数据库并从只读数据库中导入所有访问对象并再次测试。

# amazon-ec2 - 无法在主机上启动光束并且无法在主机上启动新光束

> ID：11508254
> 
> 赞同：0
> 
> 时间：2012-07-16T16:11:02.153
> 
> 标签：amazon-ec2, erlang, load-testing, tsung, beam

有一些问题如下：

```
==> 20120712-1611/tsung_controller@tester0.log <==

=INFO REPORT==== 12-Jul-2012::16:12:45 ===
   ts_config_server:(0:<0.100.0>) Can't start newbeam on host tester1 (reason: timeout) ! Aborting!

=INFO REPORT==== 12-Jul-2012::16:12:45 ===
   ts_config_server:(0:<0.99.0>) Can't start newbeam on host tester2 (reason: timeout) ! Aborting!

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.74.0>) Fail to start beam on host "web1-1b" ({error,
                                    timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.74.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.372>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"web1-1b",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"web1-1b",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.82.0>) Fail to start beam on host "master3" ({error,
                                    timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.82.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.405>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"master3",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"master3",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.80.0>) Fail to start beam on host "master1" ({error,
                                    timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.80.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.397>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"master1",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"master1",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.81.0>) Fail to start beam on host "master2" ({error,
                                    timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.81.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.400>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"master2",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"master2",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.78.0>) Fail to start beam on host "memcache-1a" ({error,
                                        timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.78.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.386>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"memcache-1a",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"memcache-1a",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.79.0>) Fail to start beam on host "memcache-1b" ({error,
                                        timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.79.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.392>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"memcache-1b",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"memcache-1b",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.76.0>) Fail to start beam on host "task1" ({error,
                                      timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.76.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.374>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"task1",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"task1",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.77.0>) Fail to start beam on host "ffmpeg1" ({error,
                                    timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.77.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.380>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"ffmpeg1",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"ffmpeg1",
                                   {},10000,
                                   {global,
                                    ts_mon}}
=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(3:<0.73.0>) Fail to start beam on host "web1-1a" ({error,
                                    timeout})

=ERROR REPORT==== 12-Jul-2012::16:12:46 ===
** Generic server <0.73.0> terminating 
** Last message in was {timeout,#Ref<0.0.0.364>,start_beam}
** When Server state == {state,{global,ts_mon},
                  10000,undefined,"web1-1a",undefined}
** Reason for termination == 
** {error,timeout}

=INFO REPORT==== 12-Jul-2012::16:12:46 ===
   ts_os_mon_erlang:(5:<0.67.0>) starting os_mon_erlang with args {"web1-1a",
                                   {},10000,
                                   {global,
                                    ts_mon}} 
```

这是我的 /etc/hosts 文件（tester0）：

```
127.0.0.1 localhost

# The following lines are desirable for IPv6 capable hosts
::1 ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

10.0.3.192 vm0
10.0.3.199 vm1
10.0.3.242 vm2

10.100.238.56 master1
10.90.245.66 master2
10.70.78.51master3
10.37.53.46 web1-1a
10.94.245.79 web1-1b
10.127.46.19 task1
10.35.99.161 ffmpeg1
10.243.63.212 memcache-1a
10.223.50.72 memcache-1b
10.29.155.171 tester0
10.78.159.23 tester1
10.78.149.115 tester2 
```

每当我启动实例时（它们都有相同版本的 Erlang，我是从源代码构建的），我运行这个脚本：

```
#!/bin/bash

for i in web1-1a web1-1b task1 ffmpeg1 master1 master2 master3 memcache-1a memcache-1b tester1 tester2; do
    ssh $i -i ~/.ssh/amazon-key.pem "echo \"<MY PUB SSH KEY IN HERE>" | tee -a ~/.ssh/authorized_keys; ssh-keygen -t rsa << hereintime

hereintime; sudo hostname $i; exit" &> /dev/null
    ssh $i "echo \"host *
    user <myuser>
    StrictHostKeyChecking no\" | tee -a .ssh/config; sudo sed -i.bak -e \"s/localhost/localhost $i/\" -e \"/$i/d\" /etc/hosts; echo \"# need to have ssh-agent running
eval \`ssh-agent\`
[ -e /home/<myuser>/.ssh/id_rsa.pub ] && ssh-add\" | tee -a ~/.bashrc" &> /dev/null
    newhostline=`grep $i /etc/hosts`
    ssh $i "sudo sed -i -e \"/$i/d\" /etc/hosts; echo $newhostline | sudo tee -a /etc/hosts" &> /dev/null
    [ "${i:0:-1}" == "tester" ] && tester0=`grep tester0 /etc/hosts` && ssh $i "sudo sed -i -e '/tester0/d' /etc/hosts" &> /dev/null
    ssh $i "rm ~/.ssh/known_hosts; echo $tester0 | sudo tee -a /etc/hosts; ssh tester0 \"exit\""  &> /dev/null
    ssh $i "cat ~/.ssh/id_rsa.pub" | tee -a ~/.ssh/authorized_keys
    ssh $i "sudo hostname $i; exit"
done 
```

而且我完全能够运行您在文档中所述的测试（例如）：

```
# ssh tester1 erl
Eshell V5.9.1  (abort with ^G)
1> inet:gethostname().
{ok,"tester1"} 
```

以及页面中描述的内容：https: [//support.process-one.net/doc/display/ERL/Starting+a+set+of+Erlang+cluster+nodes](https://support.process-one.net/doc/display/ERL/Starting+a+set+of+Erlang+cluster+nodes)

```
-module(cluster).
-export([slaves/1]).

%% Argument:
%% %% Hosts: List of hostname (string)
slaves([]) ->
ok;
slaves([Host|Hosts]) ->
 Args = erl_system_args(),
 NodeName = "cluster",
 {ok, Node} = slave:start_link(Host, NodeName, Args),
 io:format("Erlang node started = [~p]~n", [Node]),
 slaves(Hosts).

erl_system_args()->
 Shared = case init:get_argument(shared) of
   error -> " ";
   {ok,[[]]} -> " -shared "
 end,
   lists:append(["-rsh ssh -setcookie",
         atom_to_list(erlang:get_cookie()),
         Shared, " +Mea r10b "]).

%% Do not forget to start erlang with a command like:
%% erl -rsh ssh -sname clustmaster 
```

然后我运行（在 tester0 上）：

```
# erl -rsh ssh -sname clustmaster
Erlang R15B01 (erts-5.9.1) [source] [64-bit] [async-threads:0] [kernel-poll:false]

Eshell V5.9.1  (abort with ^G)
(clustmaster@tester0)1> c(cluster).
{ok,cluster}
(clustmaster@tester0)2> cluster:slaves(["tester1","tester2"]).
** exception error: no match of right hand side value {error,timeout}
    in function  cluster:slaves/1 (cluster.erl, line 11)
(clustmaster@tester0)3> cluster:slaves(["tester0"]).          
Erlang node started = [cluster@tester0]
ok 
```

这是有道理的，因为：

```
(clustmaster@tester0)14> slave:start_link("tester0", "cluster", " -rsh ssh -setcookieVTJKCGTPGNTMRAUDYLBU +Mea r10b").   
{ok,cluster@tester0}
(clustmaster@tester0)15> slave:start_link("tester1", "cluster", " -rsh ssh -setcookieVTJKCGTPGNTMRAUDYLBU +Mea r10b").
{error,timeout} 
```

奇怪的？？？

```
(clustmaster@tester0)5> inet:gethostbyname("tester1").
{ok,{hostent,"tester1",[],inet,4,[{10,78,159,23}]}}
(clustmaster@tester0)6> inet:gethostbyname("tester2").
{ok,{hostent,"tester2",[],inet,4,[{10,78,149,115}]}}

# ping -c 1 tester1
PING tester1 (10.78.159.23) 56(84) bytes of data.
64 bytes from tester1 (10.78.159.23): icmp_req=1 ttl=56 time=1.69 ms
# ping -c 1 tester2
PING tester2 (10.78.149.115) 56(84) bytes of data.
64 bytes from tester2 (10.78.149.115): icmp_req=1 ttl=56 time=2.03 ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-20T12:28:25.437

发现我的脚本存在问题，无法将 ssh 密钥导入远程服务器。我正在使用：

```
sudo sed -i.bak -e \"s/localhost/localhost $i/\" -e \"/$i/d\" /etc/hosts; 
```

和

```
[ "${i:0:-1}" == "tester" ] && tester0=`grep tester0 /etc/hosts` && ssh $i "sudo sed -i -e '/tester0/d' /etc/hosts" &> /dev/null 
```

这从服务器中删除了我的“控制器”地址。现在它已被删除，我可以：

```
slave:start_linke(Host,Name,Args) 
```

# windows-phone-7 - WP7 上带有 HttpWebRequest 的 ManualResetEvent

> ID：11508258
> 
> 赞同：1
> 
> 时间：2012-07-16T16:11:12.523
> 
> 标签：windows-phone-7, httpwebrequest, manualresetevent

首先，这可能被标记为以下线程的副本： [Wait for HttpWebRequest.BeginGetResponse to finish in Windows Phone 7](https://stackoverflow.com/questions/4046058/wait-for-httpwebrequest-begingetresponse-to-finish-in-windows-phone-7)，但是，该线程中的响应并没有帮助我克服我的问题。

首先，我在 UI 线程上收集用户数据以处理应用程序注册，其中我还有一个 ManualResetEvent 实例：

```
private static ManualResetEvent registrationEvent = new ManualResetEvent(false); 
```

我有另一个线程处理注册过程（包括 HttpWebRequest.BeginGetResponse() 及其相应的回调方法。）

```
Thread t = new Thread(() => RegistrationHandler.sendRegistrationData(url));
t.Start(); 
```

在这个调用之后，我通过调用来阻塞当前（UI）线程

```
registrationEvent.WaitOne();

//Process the response, update some UI elements and navigate to a different page.
httpSessionCompleted(response); 
```

一旦处理注册过程的线程开始，我将实例化 HttpWebRequest 并在其上调用 BeginGetResponse() 方法。

```
try
{
    HttpWebRequest request = HttpWebRequest.CreateHttp(url);
    request.Method = "POST";
    request.ContentType = mimeType;

    request.BeginGetResponse(new AsyncCallback(GetRequestCallback), request);
}
catch (Exception ex)
{
    Console.WriteLine("Exception caught in sendData(): {0}", ex.Message);
} 
```

现在的问题是回调方法（下面的代码）从未被调用，应用程序只是冻结。似乎也没有抛出任何异常。

```
try
{
    HttpWebRequest request = (HttpWebRequest)asyncResult.AsyncState;

    if (request != null)
    {
        using (HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asyncResult))
                {
                    using (StreamReader reader = new StreamReader(response.GetResponseStream()))
                    {
                        String result = reader.ReadToEnd();
                        Globals.HostResponse = result;
                        //Signalling the calling thread to continue execution
                        RegistrationPage.RegistrationEvent.Set();
                    }
                }
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine("Exception caught in GetRequestCallback(): {0}", ex.Message);
        } 
```

理想情况下，我希望我的应用程序在回调方法完成执行后从 httpSessionCompleted() 继续。有人可以帮我一些指导/建议吗？

很抱歉很冗长。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:46:17.460

您不应该阻止`UI thread`，而是使用回调模式。看看这个：[Windows Phone 7 - 等待 Webclient 完成](https://stackoverflow.com/questions/10960416/windows-phone-7-wait-for-webclient-to-complete/10960468#10960468)。希望这可以帮助

# c# - 将 StringBuilder 传递给需要 char 指针的 DLL 函数

> ID：11508260
> 
> 赞同：4
> 
> 时间：2012-07-16T16:11:13.793
> 
> 标签：c#, c++, pointers, dllimport

我正在尝试与在 Delphi 中创建的 DLL 库进行交互。在 C++ 中，我把这个调用做得很好：

```
for(int y = 1; y <= 12; y++)
{
    char * chanName = (char *) malloc(21); 
    memset(chanName,0,21);
    channelName(y,20,chanName);
    ...
} 
```

类型`channelName`定义为`typedef int (CALLBACK* ChannelName)(int,int,char*);`

现在我正在尝试在 C# 中做同样的事情。我搜索并发现它`StringBuilder`通常用作 DLL 函数的 char 指针。这是我声明函数的方式：

```
[DllImport("myDLL.dll")]
public static extern int ChannelName(int x, int y, StringBuilder z); 
```

这就是我试图称呼它的方式：

```
for (int x = 0; x < 12; x++)
{
    StringBuilder b = new StringBuilder(100);
    DLLInterface.ChannelName(x+1, b.Length, b);
    Console.WriteLine(b.ToString());
} 
```

这只是让控制台打印出乱码，例如：

```
☺ §
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9
☺ î☺8f9 
```

我记得在 C++ 中遇到了类似的问题，这就是为什么我`memset`的内存`malloc`为 0。我试图在 C# 中找到一个等价物，但也许这是一个问题`StringBuilder`？如果我的问题不是很清楚，我只想能够将一个字符串传递给我的函数，让函数填充它，然后打印出来。字符串在 C# 中是不可变的，并且不存在好的指针选项，这就是我尝试的原因`StringBuilder`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T17:54:45.217

在 .NET 中，字符串（和 StringBuilders）是 16 位 Unicode 字符。我的猜测是您的本机函数处理 8 位 ASCII 字符。您需要告诉 Marshaller 在编组时如何转换字符。像这样更改您的 DllImport 属性：

```
[DllImport("myDLL.dll", CharSet=CharSet.Ansi)]
public static extern int ChannelName(int x, int y, [Out] StringBuilder z); 
```

**更新**

此外，您应该在 StringBuilder 上指定 [Out] 属性，以便 Marshaller 仅在退出时进行编组，因为您在进入的过程中没有传递任何内容。

**再次更新**

[In,Out] 属性是多余的（这是默认值），但是将其放在那里可以明确表明您知道您需要 In 和 Out 复制。

```
[DllImport("myDLL.dll")]
private static extern int ChannelName(int x, int y, [In,Out] byte[] z);
public static int ChannelName(int x, int y, out string result)
{
    byte[] z = new byte[100];
    int ret = ChannelName(x, y, z);
    result = Encoding.ASCII.GetString(z);
    return ret;
} 
```

**再次更新**

看起来（名字不好）'y'参数是传入的 char * 缓冲区的长度，我的猜测是它返回写入缓冲区的字符数。如果是这种情况，我会以更自然的 C# 方式包装此调用：

```
[DllImport("myDLL.dll")]
private static extern int ChannelName(int x, int y, [In, Out] byte[] z);

public static string ChannelName(int x)
{
    byte[] z = new byte[100];
    int length = ChannelName(x, z.Length, z);
    return Encoding.ASCII.GetString(z, 0, length);
} 
```

# jquery - 需要调整窗口大小的帮助。更改 div 位置（而不是动画）

> ID：11508261
> 
> 赞同：0
> 
> 时间：2012-07-16T16:11:14.277
> 
> 标签：jquery, css, media

我不确定这里的正确解决方案是什么。我已经使用了搜索功能和谷歌，但我仍然需要一些建议。

我在 window.load 上有几个 div 动画。例如：

```
var showreel = $('#plbg');              
showreel.delay(1500).animate({
right: $(window).width()/2 - showreel.outerWidth()/2}, 500, 'swing'); 
```

所以这会将 div 动画到屏幕的中心。现在，当我调整窗口大小时，它不会动态居中。

我又写了几行，像这样：

```
$(window).resize(function() {
var showreel = $('#plbg');              
showreel.delay(1500).animate({
right: $(window).width()/2 - showreel.outerWidth()/2}, 500, 'swing');
}); 
```

我让它与动画一起工作，但我只想将 div 移动到没有动画的新位置。但也许使用不同的解决方案会更好？

有人可以给我一些建议吗？

谢谢！

编辑：我猜案件已结案，谢谢大家！ [http://jsfiddle.net/jruddell/bV8qp/2/](http://jsfiddle.net/jruddell/bV8qp/2/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:13:47.687

采用`.center {position: relative; margin-left: auto; margin-right: auto; }`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:10:34.343

更新：

事实证明我最初的想法不太奏效，正确的答案是使用绝对和相对定位的组合。您似乎已经弄清楚了这一点，但是为了他人的利益，我正在纠正我的答案。

由于无法为边距的“自动”值设置动画，因此您仍然需要使用绝对定位将 div 设置为页面加载时的中心，就像您在原始代码中所做的那样。但是，一旦 div 到达页面的中心，您可以将其样式更改为使用自动边距的相对定位，以使其在窗口调整大小时保持居中。

与其直接在元素上设置 CSS，我建议在两个不同的类之间切换它，一个用于“动画”状态，一个用于“居中”状态。这样您就可以为元素添加额外的样式，而无需更改动画代码。但是，为了做到这一点，您需要确保在动画完成后撤消对 CSS 的直接修改，否则直接在元素上设置的绝对定位属性将覆盖样式表设置的相对定位属性。

所以在你页面的 CSS 中，你可以像这样定义两个类：

```
.fly-in {
    position:absolute;
    left:0px;
}
.center {
    position: relative;
    margin-left: auto;
    margin-right: auto;
} 
```

然后在你的 window.load 函数中，或者任何你想做动画的地方，你可以有这样的代码：

```
var showreel = $('#plbg');
showreel.addClass("fly-in");
showreel.delay(1500).animate({
    left: ($(window).width() - showreel.width()) / 2 + "px" 
}, 500, 'swing', function() {
    showreel.removeClass("fly-in").addClass("center");
    //Clear the "left" property that animate set directly on the div
    showreel.css('left',''); 
}); 
```

这会将 div 设置为在运行动画之前使用绝对定位，然后使用回调函数（的最后一个参数`animate`）运行动画，该函数在动画完成时将其设置为相对定位。

# excel - excel中的静态时间戳

> ID：11508263
> 
> 赞同：1
> 
> 时间：2012-07-16T16:11:16.180
> 
> 标签：excel, timestamp

我希望能够通过单击按钮将时间戳添加到 Excel 单元格。不幸的是， =Now() 总是会更新到当前时间，因此不是静态的。

我可以在记事本中做F5，然后将其转移到excel，但我宁愿去掉中间人。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:13:39.947

在单元格旁边创建一个按钮。

然后对于该按钮的“onclick”事件中的 VBA 代码执行以下操作：

```
Sheets("Sheetname").Range("C1").value = time() 
```

或日期和时间

```
Sheets("Sheetname").Range("C1").value = Now() 
```

无论哪种方式，只有在单击按钮时，该单元格的值才会设置为当前时间。

**笔记：**

如果您从未将按钮对象插入到 Excel 中，这里是 Excel 2003、2007 和 2010 的分步指南

[http://www.excel-vba-easy.com/vba-how-to-create-macro-excel.html#create-macro-excel-2003](http://www.excel-vba-easy.com/vba-how-to-create-macro-excel.html#create-macro-excel-2003)

**更新：**

如果您只想将时间戳添加到当前选定的单元格，请使用以下代码行：

```
ActiveCell.value = Now() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:29:41.723

如果您只使用 Ctrl+Shift+: 帮助说 Ctrl+: 您可能真的不需要按钮，但不要忘记使用 Shift 来获得它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T13:50:10.797

我见过的所有例子都没有真正简单地按照要求做。（注意使用 Excel 2010）

这是一个简单的宏。我保存了启用的​​工作表宏，并添加了一个快速访问工具栏按钮来运行它。

```
Sub MyTimeStamp()
Dim DT
'
' MyTimeStamp Macro
'
' Keyboard Shortcut: Ctrl+t
'

DT = Format(Now, "mm/dd/yyyy hh:mm:ss AM/PM")
ActiveCell.Select
Selection.NumberFormat = "mm/dd/yyyy hh:mm AM/PM"
ActiveCell.Value = DT

End Sub 
```

# php - 带有外部共享库的 php 自定义 c 扩展

> ID：11508265
> 
> 赞同：3
> 
> 时间：2012-07-16T16:11:28.147
> 
> 标签：php, c, linux

我想开发一个依赖于外部共享库的扩展。我目前的问题是我无法将此共享库链接到我的扩展程序。

我的开发环境是 Fedora Linux x64 + PHP 5.4。这个外部共享库是一个专有库，我只有它的头文件 (.h) 和 .so 文件（用于 32 位和 64 位）。

项目当前的config.m4文件如下：

```
PHP_ARG_WITH(projectname,
    [Whether to enable ProjectName support],
    [  --with-projectname              enable ProjectName support])

if test "$PHP_PROJECTNAME" != "no"; then
    PHP_ADD_LIBRARY_WITH_PATH(externallib, lib64, PROJECTNAME_SHARED_LIBADD)

    AC_DEFINE(HAVE_PROJECTNAME, 1, [Whether you have ProjectName])
    PHP_NEW_EXTENSION(projectname, projectname.c, $ext_shared)
fi 
```

这里的问题是每次我运行`./configure --with-projectname`生成的 makefile 都没有对库的任何引用，加上编译的 .so 文件失败（显然）。

如果我有办法根据架构确定正确的 lib 目录，那也会很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-17T14:39:57.147

您已包含该库，但看起来您缺少实际的链接选项。我已经很长时间没有这样做了，但我认为类似下面的方法应该可以。

```
EXTERNAL_LIB="blahLibName"
LIB_LINK_CMD="-L/usr/local/lib -l$EXTERNAL_LIB"

PHP_ADD_LIBRARY_WITH_PATH(externallib, lib64, PROJECTNAME_SHARED_LIBADD)
PHP_EVAL_LIBLINE($LIB_LINK_CMD, PROJECTNAME_SHARED_LIBADD) 
```

这里的语法可能根本不正确，但您肯定需要 PHP_EVAL_LIBLINE。

# python - 如何根据上下文更改 Blender 2.63 中操作员的标签？

> ID：11508267
> 
> 赞同：3
> 
> 时间：2012-07-16T16:11:32.600
> 
> 标签：python, user-interface, label, blender

我正在为我的朋友和我正在制作的游戏编写导出器，它涉及为对象设置自定义属性和标签，然后在游戏中识别并进行相应处理。我们用 C/C++ 编写的引擎已经用我当前版本的导出脚本成功测试，我目前正在整理它。

该脚本使用 Blender 的自定义属性功能将自定义标签写入输出文件。该模型通常由多个“部分”（Blender 网格对象作为父对象形成一棵树，具有一个“父”和多个“子”对象）组成，其中一些部分是简单的 Blender Empty 对象（只有它是 X、Y和 Z 坐标是必需的）具有自定义属性，用于标记诸如船舶推进（它是一个 3D 射击游戏）之类的东西的放置位置，或者船舶被射击时火焰/爆炸出现的位置。这些空的部分也是“根”对象或其任何子对象的父对象。到目前为止它运行良好，我编写了一个通用 Operator 类和一些扩展类，它们驻留在面板中设置部件的属性（非常方便，因为你不这样做'

现在我想进一步加快速度，即能够简单地单击所需类型的运算符，它应该自动将其添加到场景中并将其作为活动/选定对象的父级。我知道该怎么做，但我不能让那些运营商改变他们的标签。Basically, what I want is to operator to say 'Bullet point' when an existing empty is selected (I've got that part done), and when there's a mesh object selected to say 'Add bullet point'. 所以我只需要一种根据上下文动态更改操作员标签的方法（因为问题的标题清楚地说明了:)）

这是我到目前为止得到的：

```
class OBJECT_OT_tg_generic (bpy.types.Operator):
    bl_label        =   "Sets Generic Part Type"
    bl_idname       =   "rbm.set_generic_part_type"

    OB_TYPE         =   None

    @classmethod
    def poll (cls, context):
        act = context.active_object
        if 'Type' in act.keys ():
            if act['Type'] == cls.OB_TYPE:
                cls.bl_label = 'foo'
                print (cls.bl_label)
                # this prints foo but doesn't change the label
                return False
        return True

    def execute (self, context):
        # TODO: add code to automatically place empties and parent them to active object
        bpy.context.active_object['Type'] = self.OB_TYPE
        return{"FINISHED"} 
```

还有一个子类的例子：

```
class OBJECT_OT_tg_bullet_point (OBJECT_OT_tg_generic):
    bl_label        =   "Bullet Point"
    bl_idname       =   "rbm.set_bullet_point"

    OB_TYPE         =   OT_BULLET_POINT 
```

这是它在 Blender 中的外观：http: [//i.imgur.com/46RAS.png](http://i.imgur.com/46RAS.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-02T10:54:13.627

猜猜我解决了。当您将操作员添加到面板时，您可以执行以下操作：

```
def draw (self, context):
    layout = self.layout
    row = layout.row()
    row.operator("foo.bar", text="Whatever you want") 
```

并且“随心所欲”将成为您按钮的标签。但我所做的是另一回事。我没有更改操作员的标签，而是根据它是网格还是当前选择/活动的空来给他们不同的图标：

```
def draw (self, context):
    # (...) we're skipping some code here, obviously
    act = context.active_object
    if act.type == 'MESH':
        op_icon = 'ZOOMIN'
    else:
        op_icon = 'EMPTY_DATA'

    row = layout.column(align=True)
    row.operator('rbm.set_bullet_point', icon=op_icon)
    row.operator('rbm.set_rocket_point', icon=op_icon)
    # (...) rest of the code 
```

# ruby-on-rails - 使用控制器操作响应 JSON 的 Rails 方式（在 3.2.6 中）是什么？

> ID：11508269
> 
> 赞同：0
> 
> 时间：2012-07-16T16:11:37.023
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我在具有选择框的 Rails 3.2.6 应用程序中有一个简单的表单。根据更改事件选择框中的内容，我正在提交一个 Ajax 请求。

然后我有一个渲染的 .js.erb 文件。但后来我使用那个 .js.erb 文件来渲染一个部分。

那是 Rails 方式，还是我应该跳过 .js.erb 文件并从控制器操作中渲染部分？这似乎是一个不必要的步骤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:32:59.517

如果文件中没有其他内容，`js.erb`那么我会从控制器渲染部分内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:49:20.953

就我个人而言，我不喜欢直接从控制器生成/返回部分，我强烈建议从适当的`.js.erb`文件中调用部分 - 这样你将永远知道调用特定操作后返回的内容，而无需查看你的控制器。但我不知道，如果这是 Rails 方式，这只是我的常见做法。

# opengl - 如何有效地从深度纹理中读取像素？

> ID：11508276
> 
> 赞同：3
> 
> 时间：2012-07-16T16:12:03.267
> 
> 标签：opengl

我有一个 OpenGL 纹理，并且希望能够读回单个像素的值，这样我就可以在屏幕上显示它。如果纹理是常规的旧 RGB 纹理等，这没问题：我拿了一个空的 Framebuffer 对象，将纹理附加到帧缓冲区上的 COLOR0 并调用：

```
glReadPixels(x, y, 1, 1, GL_RGBA, GL_FLOAT, &c); 
```

其中 c 本质上是一个浮点数[4]。

但是，当它是深度纹理时，我必须沿着不同的代码路径，设置 DEPTH 附件而不是 COLOR0，然后调用：

```
glReadPixels(x, y, 1, 1, GL_DEPTH_COMPONENT, GL_FLOAT, &c); 
```

其中 c 是浮点数。这在我运行 NVIDIA GeForce 580 的 Windows 7 计算机上运行良好，但在我的旧 2008 MacBook pro 上会导致错误。具体来说，在将深度纹理附加到帧缓冲区之后，如果我调用 glCheckFrameBufferStatus(GL_READ_BUFFER)，我会得到 GL_FRAMEBUFFER_INCOMPLETE_READ_BUFFER。

在搜索 OpenGL 文档后，我找到了这一行，这似乎暗示如果没有颜色附件，OpenGL 不支持从帧缓冲区的深度组件中读取*：*

```
GL_FRAMEBUFFER_INCOMPLETE_READ_BUFFER is returned if GL_READ_BUFFER is not GL_NONE 
and the value of GL_FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE is GL_NONE for the color 
attachment point named by GL_READ_BUFFER. 
```

果然，如果我创建一个临时的颜色纹理并将其绑定到COLOR0，当我从深度纹理中读取像素时不会出现错误。

现在每次通过这段代码创建一个临时纹理（编辑：甚至一次并让GPU内存被它占用）很烦人并且可能很慢，所以我想知道是否有人知道从深度读取单个像素的替代方法质地？（当然，如果没有更好的方法，我将保留一个纹理以在需要时调整大小，并仅将其用于临时颜色附件，但这似乎相当迂回）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:59:16.970

答案包含在您的错误消息中：

> 如果 GL_READ_BUFFER 不是 GL_NONE

那就这样做吧；将读取缓冲区设置为`GL_NONE`. 与[`glReadBuffer`](http://www.opengl.org/wiki/GLAPI/glReadBuffer). 像这样：

```
glBindFramebuffer(GL_READ_FRAMEBUFFER, fbo); //where fbo is your FBO.
glReadBuffer(GL_NONE); 
```

这样，即使 FBO 只有深度纹理，FBO 也是正确完成的。

# c# - 向 Open Office XML 添加间距和空行

> ID：11508277
> 
> 赞同：0
> 
> 时间：2012-07-16T16:12:04.697
> 
> 标签：c#, ms-word, openxml, openxml-sdk

我正在尝试使用 Open Office XML 输出 word 文件，但似乎无法正确设置间距。

```
Variable name:ATTEND
 Description:Student's attendance status during the 
```

我希望单词文件是这样的（:) 后有空格：

```
Variable name: ATTEND
Description:Student's attendance status during the 
```

我的代码如下，间距消失了：

```
start of my function
// Add a new main document part. 
            MainDocumentPart mainPart = wordDocument.AddMainDocumentPart();

            // Create the Document DOM.
            mainPart.Document = new Document();

            Body body = mainPart.Document.AppendChild(new Body());

            ParagraphProperties paragraphProperties = new ParagraphProperties
            (
                new ParagraphStyleId() { Val = "No Spacing" },
                new SpacingBetweenLines() { After = "0" }
            );

            Paragraph para = body.AppendChild(new Paragraph(paragraphProperties));
            Run run = para.AppendChild(new Run());

            RunProperties runProperties = run.AppendChild(new RunProperties(new Bold()));
            run.AppendChild(new Text("Variable name: "));

            run = para.AppendChild(new Run());
            run.AppendChild(new Text(" ATTEND"));

            para = body.AppendChild(new Paragraph());

            run = para.AppendChild(new Run());

            runProperties = run.AppendChild(new RunProperties(new Bold()));
            run.AppendChild(new Text("Description: "));

            run = para.AppendChild(new Run());
            run.AppendChild(new Text(" Student's attendance status during the "));

            // Save changes to the main document part. 
            wordDocument.MainDocumentPart.Document.Save();
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T17:05:34.980

通常，OpenXML 会修剪每个`Text`成员。为了保留每个`Text`成员中的空格，因此您将使用 this`test test`而不是`test test`，设置成员的特殊`Space`属性`Text`：

`Text txt = new Text("text here ") { Space = SpaceProcessingModeValues.Preserve };`

# java - 如何检测和替换 char[] 中的换行符？

> ID：11508280
> 
> 赞同：4
> 
> 时间：2012-07-16T16:12:14.043
> 
> 标签：java, char

我的应用程序使用套接字连接到服务器并读取数据。数据最多有四个字符长，但偶尔会少于这个。数据由 CR LF 组合附加，我不想在下一步处理中出现。

由于我不想阅读超过四个字符，所以我有一个`char[4]`缓冲区。然后，考虑到数据少于四个字符的时间（以及 CR 和 LF 字符潜入），我有这个：

```
for(int i = 0; i < 4; i++) {
    String hexString = Integer.toHexString(buffer[i] | 0x10000).substring(1);
    if((hexString == "000d") || (hexString == "000a")) {
        buffer[i]='0';
    }
} 
```

通过明智的日志记录，我可以看到循环按预期执行，但不会覆盖 CR (U+000d) 和 LF (U+000a) 字符。我希望上面的代码用“0”替换任何回车或换行的实例，但缓冲区的内容似乎没有改变。

老实说，无论如何，这感觉像是一种笨拙的方式，所以我的问题有分歧：

1.  我的代码有什么问题？如何修复它以按预期执行？
2.  有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:17:50.917

听起来你最好使用`BufferedReader`它的`readLine()`方法开始：

```
BufferedReader reader = new BufferedReader(new InputStreamReader(stream, charset));
try {
    String line;
    while ((line = reader.readLine()) != null) {
        processLine(line);
    }
} finally {
    reader.close();
} 
```

这里的行不会有行分隔符，您不必担心单个调用是否会`read`在一行中途结束等。

# css - 缩小媒体查询？

> ID：11508281
> 
> 赞同：4
> 
> 时间：2012-07-16T16:12:15.293
> 
> 标签：css, media-queries, minify, squishit

我有一个完全有效的 CSS 样式表，它可以工作，并且可以识别查询，但是当我使用 SquishIt 缩小（并连接）样式表时，媒体查询似乎停止工作，我不知道为什么。

这是缩小的 CSS，美化了：

```
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td,article,aside,canvas,details,embed,figure,figcaption,footer,header,hgroup,menu,nav,output,ruby,section,summary,time,mark,audio,video {
border:0;
outline:0;
font-size:100%;
font:inherit;
vertical-align:baseline;
background:transparent;
color:inherit;
margin:0;
padding:0;
}

article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section {
display:block;
}

body {
line-height:1;
word-wrap:break-word;
overflow-x:hidden;
font-family:"Helvetica Neue","Lucida Grande","Segoe UI",Arial,Helvetica,Verdana,sans-serif;
}

ol,ul {
list-style:none;
margin-bottom:1em;
margin-left:30px;
}

blockquote,q {
quotes:none;
}

blockquote:before,blockquote:after,q:before,q:after {
content:none;
}

:focus {
outline:0;
}

table {
border-collapse:collapse;
border-spacing:0;
}

th {
text-align:left;
}

.layout-section {
width:93.75%;
text-align:left;
margin:0 auto;
}

header#layout-header {
margin-bottom:20px;
padding:12px 0;
}

header#layout-header h1 {
display:inline-block;
font-family:Calibri,Candara,Segoe,"Segoe UI",Optima,Arial,Helvetica,sans-serif;
font-weight:700;
font-size:2.4em;
margin:0 auto;
}

section#layout-content {
padding:6px 0;
}

section#layout-content h1 {
margin-bottom:12px;
}

#noscript-padding {
padding-bottom:37px;
}

#noscript-notice {
position:fixed;
top:0;
left:0;
width:100%;
z-index:99;
text-align:center;
font-family:sans-serif;
font-weight:700;
font-size:1.1em;
background-color:#ce756b;
color:#fff;
border-bottom:2px solid #9d0000;
cursor:not-allowed;
padding:6px 0;
}

#noscript-notice .ie-warning {
padding-top:6px;
}

html,body,form {
height:100%;
}

section#layout-container {
min-height:100%;
height:auto!important;
margin:0 auto -72px;
}

a#menu-icon {
float:right;
font-size:12px;
font-weight:700;
line-height:22px;
height:22px;
letter-spacing:.1em;
margin-top:10px;
color:#fff;
background:#4e4e4e;
text-transform:uppercase;
text-decoration:none;
-webkit-border-radius:3px;
-moz-border-radius:3px;
border-radius:3px;
-moz-background-clip:padding;
-webkit-background-clip:padding-box;
background-clip:padding-box;
padding:0 10px;
}

nav#menu {
margin-top:30px;
}

nav#menu ol {
background:#1c1c1c;
padding:5px 0;
}

nav#menu li a {
display:block;
font-weight:700;
text-transform:uppercase;
letter-spacing:.1em;
line-height:2em;
height:2em;
color:#fff;
text-decoration:none;
border-bottom:1px solid #383838;
padding:0 20px;
}

nav#menu li:last-child a {
border-bottom:none;
}

.left {
float:left;
}

.right {
float:right;
}

.hidden {
display:none!important;
}

h1 {
font-size:1.6em;
}

h2 {
font-size:1.5em;
}

h3 {
font-size:1.4em;
}

h4 {
font-size:1.3em;
}

h5 {
font-size:1.2em;
}

h6 {
font-size:1.1em;
}

hr {
border:0 none;
height:1px;
margin-bottom:20px;
}

blockquote {
margin-bottom:10px;
padding:10px 10px 1px;
}

pre,code {
font-family:Consolas,Menlo,Monaco,"Lucida Console","Liberation Mono","DejaVu Sans Mono","Bitstream Vera Sans Mono","Courier New",monospace,serif;
}

pre {
margin-bottom:10px;
max-height:600px;
overflow:auto;
width:auto;
padding:5px;
}

b,strong,.bold {
font-weight:700;
}

i,em,.italic {
font-style:italic;
}

del {
text-decoration:line-through;
}

img {
border:none;
}

ol,ul,li,p {
word-wrap:break-word;
}

ol {
list-style:decimal outside none;
}

ul {
list-style:disc outside none;
}

nav ol,nav ul {
list-style:none;
margin:inherit;
}

form legend {
padding-bottom:12px;
}

form input,form textarea,form button,form a.button {
margin-bottom:10px;
margin-right:3px;
display:inline-block;
padding:8px;
}

form input[type=text],form input[type=password],form textarea {
width:75%;
}

form input[type=submit],form form button.submit {
display:block;
text-align:center;
}

fieldset .field-validation-valid,fieldset .field-validation-error {
font-size:.8em;
display:block;
margin-bottom:15px;
}

fieldset .field-validation-valid.tooltip-icon,fieldset .field-validation-error.tooltip-icon {
display:inline-block;
margin-bottom:0;
background-image:url(/content/images/sprites/icons.png);
width:16px;
height:16px;
vertical-align:middle;
}

fieldset .field-validation-valid.tooltip-icon {
background-position:-208px -192px;
}

fieldset .field-validation-error.tooltip-icon {
background-position:-32px -192px;
}

.dialog {
display:none;
position:absolute;
top:50%;
left:50%;
font-size:100%;
background-color:#fff;
border:2px solid #222;
padding:15px;
}

.dialog>header {
font-family:Trebuchet MS,Helvetica,sans-serif;
font-size:1.4em;
font-weight:700;
margin-bottom:7px;
text-decoration:underline;
}

.dialog.notification {
cursor:pointer;
-webkit-box-shadow:2px 2px 5px #400;
-moz-box-shadow:2px 2px 5px #400;
box-shadow:2px 2px 5px #400;
color:#fff;
}

.dialog .dialog-buttons {
text-align:right;
margin-top:20px;
}

.tooltip {
text-align:center;
color:#fff;
background:#111;
position:absolute;
z-index:100;
padding:15px;
}

.tooltip:after {
width:0;
height:0;
border-left:10px solid transparent;
border-right:10px solid transparent;
border-top:10px solid #111;
content:'';
position:absolute;
left:50%;
bottom:-10px;
margin-left:-10px;
}

.tooltip.tooltip-top:after {
border-top-color:transparent;
border-bottom:10px solid #111;
top:-20px;
bottom:auto;
}

.tooltip.tooltip-left:after {
left:10px;
margin:0;
}

.tooltip.tooltip-right:after {
right:10px;
left:auto;
margin:0;
}

nav#menu li span {
color:#fff;
}

nav#menu li a:hover,nav#menu li a:focus {
color:#1c1c1c;
background:#ccc;
}

a,button,input[type=submit] {
cursor:pointer;
}

button.disabled,a.button.disabled {
cursor:not-allowed;
}

nav a,button.submit,input[type=submit] {
font-variant:small-caps;
}

input[type=submit],button.submit,a.button {
border:1px solid #313131;
background-color:#dbdbdb;
color:#171515;
}

form input.valid {
background-color:#F0FFFF;
}

form input.input-validation-error {
background-color:#fff0ff;
}

.dialog.notification.notification-error {
background-color:#ce756b;
border:2px solid #9d0000;
}

.dialog.notification.notification-message {
background-color:#ff8c00;
border:2px solid #cc8c00;
}

.exception {
padding:8px;
}

.exception>header {
font-weight:700;
font-size:1.1em;
color:#c00000;
margin-bottom:5px;
}

.exception>.stacktrace {
line-height:1.2em;
color:#333;
display:none;
}

.exception>.stacktrace p {
font-size:.8em;
margin:0 0 0 5px;
}

.exception>.inner {
margin-left:20px;
display:none;
}

section.rendering-error {
color:#C00000;
font-size:.8em;
font-weight:700;
margin:10px;
}

h2.error-description {
font-size:1em;
text-align:center;
color:#462046;
}

section#error-page {
text-align:center;
padding:20px;
}

section#error-page img {
width:160px;
}

img#nomnom-standing {
vertical-align:middle;
}

section.logon-container p.login-required {
display:block;
margin-bottom:24px;
}

form.site-logon {
vertical-align:top;
}

form.site-logon input[type=submit] {
margin:0 auto;
}

form.provider-logon {
display:block;
margin-top:35px;
}

form.provider-logon a.logon-provider-button {
display:inline-block;
margin:4px;
}

form.provider-logon a.provider-icon {
background-image:url(/content/images/sprites/providers-small.png);
width:32px;
height:32px;
}

form.provider-logon a.provider-icon.google-icon {
background-position:0 0;
}

form.provider-logon a.provider-icon.fb-icon {
background-position:-32px 0;
}

form.provider-logon a.provider-icon.twitter-icon {
background-position:-64px 0;
}

form.provider-logon a.provider-icon.yahoo-icon {
background-position:-96px 0;
}

section.create-post {
width:90%;
max-width:300px;
padding-left:12px;
margin:0 auto;
}

section.posts>article,section.more-posts {
margin-top:20px;
}

section.posts>article:first-child {
margin-top:0;
}

section.posts>article>header {
font-size:1.5em;
font-weight:700;
text-align:left;
}

section.posts>article>a.post-thumbnail img {
max-height:125px;
max-width:40%;
float:left;
margin-top:8px;
margin-right:12px;
margin-bottom:12px;
}

section.posts>article>a.post-image img {
max-height:300px;
max-width:100%;
margin-top:8px;
}

section.posts>article>section {
font-size:.8em;
line-height:1.2em;
text-align:left;
}

section.posts>article>section.post-description {
margin-top:8px;
}

div#push,footer#footer,fieldset .field-validation-valid.model-validation,h1.error-title,section#error-page>section#server-room,section#error-page>aside#error-content,section#error-page>footer,img#servers,section.preview-container {
display:none;
}

.clear,section.posts>article {
clear:both;
}

.center,section.logon-container,form.site-logon p,form.provider-logon section.provider-buttons,section.posts,section.more-posts {
text-align:center;
}

ins,a,a.button:hover {
text-decoration:none;
}

a:hover,#noscript-notice a {
text-decoration:underline;
}

@media only screen andmin-width768px{
header#layout-header {
margin-bottom:30px;
}

#noscript-padding {
padding-bottom:22px;
}

div#push {
display:inherit;
height:72px;
}

footer#footer {
display:inherit;
margin-top:40px;
height:12px;
text-align:center;
font-size:.7em;
padding:10px 0;
}

section#layout-content {
position:relative;
}

nav#menu {
margin-top:0;
position:absolute;
top:16px;
right:3.125%;
max-width:45%;
}

nav#menu ol {
-webkit-border-radius:4px;
-moz-border-radius:4px;
border-radius:4px;
-moz-background-clip:padding;
-webkit-background-clip:padding-box;
background-clip:padding-box;
padding:5px;
}

a#menu-icon,nav#menu li.nav-top {
display:none;
}

nav#menu li {
display:inline-block;
}

nav#menu li a {
float:left;
border:none;
-webkit-border-radius:2px;
-moz-border-radius:2px;
border-radius:2px;
-moz-background-clip:padding;
-webkit-background-clip:padding-box;
background-clip:padding-box;
border-bottom:inherit;
padding:0 10px;
}

header#layout-header h1 {
font-size:3.2em;
}

.exception {
margin-bottom:20px;
}

img#server {
padding-right:2px;
}

img#nomnom {
padding-left:4px;
}

section#error-page {
max-width:500px;
margin:0 auto;
}

section#error-page img {
width:200px;
}

section#error-page>img#notfound-sign,section#error-page>aside#error-content {
display:inline-block;
vertical-align:middle;
}

aside#error-content {
width:250px;
padding-left:30px;
border-left:1px solid #642D64;
margin-left:10px;
text-align:left;
}

aside#error-content header {
color:#642D64;
font-weight:700;
margin-bottom:20px;
}

aside#error-content p {
font-size:.9em;
line-height:1.3em;
margin-bottom:10px;
}

section#error-page>footer {
clear:both;
}

section#error-page>footer .apologies {
text-align:center;
padding-top:30px;
color:#642D64;
clear:left;
font-size:1.2em;
}

section#error-page>footer a {
text-align:center;
display:block;
padding-top:3px;
}

section.logon-container {
margin-top:3%;
}

form.site-logon {
display:inline-block;
margin-right:15px;
width:300px;
}

form.provider-logon {
padding-left:30px;
border-left:1px solid #ddd;
margin-top:0;
display:inline-block;
}

form.provider-logon a.provider-icon {
background-image:url(/content/images/sprites/providers-large.png);
width:100px;
height:60px;
}

form.provider-logon a.provider-icon.google-icon {
background-position:0 0;
}

form.provider-logon a.provider-icon.fb-icon {
background-position:-100px 0;
}

form.provider-logon a.provider-icon.twitter-icon {
background-position:-200px 0;
}

form.provider-logon a.provider-icon.yahoo-icon {
background-position:-300px 0;
}

form.provider-logon section.provider-buttons {
width:230px;
margin:0 auto;
}

section.create-post {
max-width:400px;
padding-left:20px;
}

section.posts {
min-width:700px;
max-width:900px;
margin:0 auto;
}

section.posts>article:first-child+article {
margin-top:0;
}

section.posts>article {
clear:none;
float:left;
width:45%;
}

section.posts>article.even {
margin-right:35px;
clear:both;
}

section.posts>article>a.post-thumbnail img {
max-height:200px;
max-width:50%;
}

section.posts>article>a.post-image img {
max-height:450px;
max-width:95%;
margin-top:16px;
}

.exception>.stacktrace,.exception>.inner,h1.error-title {
display:inherit;
}
}

@media only screen andmin-width1024px{
header#layout-header {
margin-bottom:40px;
}

nav#menu {
top:28px;
}

header#layout-header h1 {
font-size:4.6em;
}

section#error-page {
max-width:1200px;
}

section#error-page>section#server-room {
margin-right:20px;
display:inherit;
float:left;
}

section#error-page>section#server-room img {
width:180px;
}

section#error-page>footer {
display:inherit;
}

img#server {
vertical-align:middle;
}

img#nomnom {
vertical-align:bottom;
}

section#error-page>img#servers {
margin-right:20px;
display:inherit;
float:left;
width:40%;
}

section#error-page>img#nomnom-standing,section#error-page>aside#error-content {
margin-top:20px;
}

section.posts {
max-width:1000px;
}

section.posts>article,section.more-posts {
margin-top:32px;
}

section.posts>article.even {
margin-right:50px;
}
}

@media only screen\0{
#noscript-padding {
padding-bottom:67px;
}
}

@media only screen\0 andmin-width768px{
#noscript-padding {
padding-bottom:47px;
}
} 
```

我正在使用`YuiCompressor`，

但显然它将媒体查询缩小为：

```
@media only screen andmin-width768px{ 
```

我应该如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T16:15:53.270

在这里发帖描述了同样的问题，解决方法是下载最新版本的压缩软件：

[http://www.456bereastreet.com/archive/201012/yui_compressor_and_css_media_queries/](http://www.456bereastreet.com/archive/201012/yui_compressor_and_css_media_queries/)

# dll - 在 VBA 和 dll 之间传递任意类型的数据

> ID：11508283
> 
> 赞同：7
> 
> 时间：2012-07-16T16:12:22.093
> 
> 标签：dll, com, excel, variant, vba

所以我正在开发一个 Excel 项目，该项目将使用 VBA 加载 C++ dll。我想做的是能够将没有特定类型（数据可以是数字或分类）的 Excel 范围传递给 C++ dll（我可以描述我的 Excel 范围的最佳方式是 type `variant`）。

所以这些步骤可能涉及：

1.  在 VBA 中加载 dll
2.  将 excel 范围发送到 dll（范围可能包含数字列和/或字符串列）
3.  在 dll 文件中操作来自 excel 的数据

我正在考虑使用 excel 变体和 C++ 变体。但是我不清楚如何使用 C++ 变体，因为我找不到任何好的文档。

我收到的另一个建议是使用 COM 编程。

**我的问题：**

*   一个善良的灵魂可以为我提供如何进行的指导吗？（例如，通过提供 C++ 原型，以及如何处理变体的简单示例）
*   有谁知道有关使用 C++ 变体（可能与 VBA 联合使用）的任何好的文档/教程？
*   如果速度是一个问题，使用 COM 是否比使用 VARIANTS 更可取？
*   使用 C API 是一种选择吗？

**更新：**

*   我需要操作的范围的大小可能很大（约 500,000 行）。
*   速度是一个因素，因此，我想尽可能避免不必要的复制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:04:46.880

如果您只想将数据传递给 dll（而不是指向实际 Excel 对象的指针，例如`Range`），您有两个基本选项：

1.  您拥有庞大的数据集，并希望尽可能避免复制。
    在这种情况下，您可能希望传递`Variant`通过调用`Range.Value`. 为此，您必须编写一个小 TLB 以从 VB 中引用，在其中您可以将导出的 C++ 函数描述为期望`SAFEARRAY(VARIANT)*`. 这是因为`Declare`操作员不会让您实际传递 SAFEARRAY*。
    该函数将如下所示：

    ```
    LONG __stdcall ReturnArrLowerBound(SAFEARRAY** ppArr)
    {
        if (ppArr == NULL) return -1;
        SAFEARRAY* pArr = (*ppArr);

        LONG res = 0;
        SafeArrayGetLBound(pArr, 1, &res);

        return res;
    } 
    ```

    TLB 描述将如下所示：

    ```
    [
        uuid(A686B138-D8CE-462e-AEF2-75DA4DBF1C75)
    ]
    library foo
    {
        [
            dllname("TestSafearray.dll")
        ]
        module vb
        {
            [entry("ReturnArrLowerBound")]
            LONG __stdcall ReturnArrLowerBound(SAFEARRAY(VARIANT)* ppArr);
        }
    } 
    ```

    你的 C++ 项目显然会包含一个 def 文件：

    ```
    LIBRARY "TestSafearray"

    EXPORTS
        ReturnArrLowerBound 
    ```

2.  您的数据集大小合理，您不介意进行一点复制。
    然后让你的 C++ 函数接受一个`int[]`并在 VB 中声明它为接受`arr() as Long`。在 VB 端，在 s 上分配一个数组`Long`并将元素从`Range.Value`数组中复制到其中。

# c# - 带有 c# Interop 的 Word 中的项目符号

> ID：11508286
> 
> 赞同：4
> 
> 时间：2012-07-16T16:12:26.833
> 
> 标签：c#, list, ms-word, interop

我有以下代码，它应该将项目符号列表添加到我自动生成的 word 文档中。从其他答案我相信代码是正确的，但结果根本没有产生任何项目符号，它似乎也没有应用缩进。有任何想法吗？

```
Microsoft.Office.Interop.Word.Paragraph assets;
assets = doc.Content.Paragraphs.Add(Type.Missing);

// Some code to generate the text

foreach (String asset in assetsList)
{
    assetText = assetText + asset + "\n";
}

assets.Range.ListFormat.ApplyBulletDefault(Type.Missing);

// Add it to the document 
assets.Range.ParagraphFormat.LeftIndent = -1;
assets.Range.Text = assetText;
assets.Range.InsertParagraphAfter(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:21:26.087

发生这种情况是因为您将多个段落添加到范围之后的范围（似乎设置 Text 属性等同于 InsertAfter）。您想要在范围之前插入，以便应用您设置的格式。

```
 Paragraph assets = doc.Content.Paragraphs.Add();

    assets.Range.ListFormat.ApplyBulletDefault();
    string[] bulletItems = new string[] { "One", "Two", "Three" };

    for (int i = 0; i < bulletItems.Length; i++)
    {
        string bulletItem = bulletItems[i];
        if (i < bulletItems.Length - 1)
            bulletItem = bulletItem + "\n";
        assets.Range.InsertBefore(bulletItem);
    } 
```

请注意，我们为除最后一项之外的所有项添加了段落结束标记。如果您将一个添加到最后一个，您将得到一个空项目符号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-22T15:15:24.480

这是基于 Tergiver 的回答。不同之处在于它在最初创建的段落之后以正确的顺序插入列表项。供您自己使用，使起始范围等于您要在其后插入列表的项目。

```
Paragraph assets = doc.Content.Paragraphs.Add();
rng = assets.Range;
rng.InsertAfter("\n");
start = rng.End;
end = rng.End;
rng = _oDoc.Range(ref start, ref end);
object listType = 0;
rng.ListFormat.ApplyBulletDefault(ref listType);
string[] bulletItems = new string[] { "One", "Two", "Three" };
for (int i = 0; i < bulletItems.Length; i++)
{
  string bulletItem = bulletItems[i];
  if (i < RowCount - 1)
    bulletItem = bulletItem + "\n";
  rng.InsertAfter(bulletItem);
} 
```

请注意，我真的不明白我在用这里的范围做什么。这个解决方案是经过大量试验和错误后得出的。我怀疑这可能与我重用相同范围的事实有关，而 Tergiver 的解决方案是在每次访问该范围时获取一个新范围。我特别不明白以下几行：

```
rng.InsertAfter("\n");
start = rng.End;
end = rng.End;
rng = _oDoc.Range(ref start, ref end); 
```

通常，对上述代码和列表的任何更改都会与前一个元素混合在一起。如果有人可以解释为什么会这样，我将不胜感激。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-13T09:21:37.997

如果您想要**列表子列表**关系，您可以尝试下面的代码块：

```
static void Main(string[] args)
    {
        try
        {
            Application app = new Application();
            Document doc = app.Documents.Add();
            Range range = doc.Range(0, 0);
            range.ListFormat.ApplyNumberDefault();
            range.Text = "Birinci";
            range.InsertParagraphAfter();
            ListTemplate listTemplate = range.ListFormat.ListTemplate;

            //range.InsertAfter("Birinci");
            //range.InsertParagraphAfter();

            //range.InsertAfter("İkinci");
            //range.InsertParagraphAfter();

            //range.InsertAfter("Üçüncü");
            //range.InsertParagraphAfter();

            Range subRange = doc.Range(range.StoryLength - 1);
            subRange.ListFormat.ApplyBulletDefault();
            subRange.ListFormat.ListIndent();
            subRange.Text = "Alt Birinci";
            subRange.InsertParagraphAfter();
            ListTemplate sublistTemplate = subRange.ListFormat.ListTemplate;

            Range subRange2 = doc.Range(subRange.StoryLength - 1);
            subRange2.ListFormat.ApplyListTemplate(sublistTemplate);
            subRange2.ListFormat.ListIndent();
            subRange2.Text = "Alt İkinci";
            subRange2.InsertParagraphAfter();

            Range range2 = doc.Range(range.StoryLength - 1);
            range2.ListFormat.ApplyListTemplateWithLevel(listTemplate,true);
            WdContinue isContinue =  range2.ListFormat.CanContinuePreviousList(listTemplate);
            range2.Text = "İkinci";
            range2.InsertParagraphAfter();

            Range range3 = doc.Range(range2.StoryLength - 1);
            range3.ListFormat.ApplyListTemplate(listTemplate);
            range3.Text = "Üçüncü";
            range3.InsertParagraphAfter();

            string path = Environment.CurrentDirectory;
            int totalExistDocx = Directory.GetFiles(path, "test*.docx").Count();
            path = Path.Combine(path, string.Format("test{0}.docx", totalExistDocx + 1));

            app.ActiveDocument.SaveAs2(path, WdSaveFormat.wdFormatXMLDocument);
            doc.Close();

            Process.Start(path);
        }
        catch (Exception exception)
        {

            throw;
        }

    } 
```

注意这一点：如果你不知道输入长度，你不能像这样定义范围值的结束：

```
static void Main(string[] args)
    {
        try
        {
            Application app = new Application();
            Document doc = app.Documents.Add();
            Range range = doc.Range(0, 0);
            range.ListFormat.ApplyNumberDefault();
            range.Text = "Birinci";
            range.InsertParagraphAfter();
            ListTemplate listTemplate = range.ListFormat.ListTemplate;

            //range.InsertAfter("Birinci");
            //range.InsertParagraphAfter();

            //range.InsertAfter("İkinci");
            //range.InsertParagraphAfter();

            //range.InsertAfter("Üçüncü");
            //range.InsertParagraphAfter();

            Range subRange = doc.Range(range.StoryLength - 1, range.StoryLength - 1);
            subRange.ListFormat.ApplyBulletDefault();
            subRange.ListFormat.ListIndent();
            subRange.Text = "Alt Birinci";
            subRange.InsertParagraphAfter();
            ListTemplate sublistTemplate = subRange.ListFormat.ListTemplate;

            Range subRange2 = doc.Range(subRange.StoryLength - 1, range.StoryLength - 1);
            subRange2.ListFormat.ApplyListTemplate(sublistTemplate);
            subRange2.ListFormat.ListIndent();
            subRange2.Text = "Alt İkinci";
            subRange2.InsertParagraphAfter();

            Range range2 = doc.Range(range.StoryLength - 1, range.StoryLength - 1);
            range2.ListFormat.ApplyListTemplateWithLevel(listTemplate,true);
            WdContinue isContinue =  range2.ListFormat.CanContinuePreviousList(listTemplate);
            range2.Text = "İkinci";
            range2.InsertParagraphAfter();

            Range range3 = doc.Range(range2.StoryLength - 1, range.StoryLength - 1);
            range3.ListFormat.ApplyListTemplate(listTemplate);
            range3.Text = "Üçüncü";
            range3.InsertParagraphAfter();

            string path = Environment.CurrentDirectory;
            int totalExistDocx = Directory.GetFiles(path, "test*.docx").Count();
            path = Path.Combine(path, string.Format("test{0}.docx", totalExistDocx + 1));

            app.ActiveDocument.SaveAs2(path, WdSaveFormat.wdFormatXMLDocument);
            doc.Close();

            Process.Start(path);
        }
        catch (Exception exception)
        {

            throw;
        }

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-13T01:03:47.630

您只需要跟踪列表的开始和结束位置，然后应用列表格式。

```
 Application wordApp = new Application() {
            Visible = true
        };

        Document doc = wordApp.Documents.Add();

        Range range = doc.Content;
        range.Text = "Hello world!";

        range.InsertParagraphAfter();
        range = doc.Paragraphs.Last.Range;

        // start of list
        int startOfList = range.Start;

        // each \n character adds a new paragraph...
        range.Text = "Item 1\nItem 2\nItem 3";

        // ...or insert a new paragraph...
        range.InsertParagraphAfter();
        range = doc.Paragraphs.Last.Range;
        range.Text = "Item 4\nItem 5";

        // end of list
        int endOfList = range.End;

        // insert the next paragraph before applying the format, otherwise
        // the format will be copied to the suceeding paragraphs.
        range.InsertParagraphAfter();

        // apply list format
        Range listRange = doc.Range(startOfList, endOfList);
        listRange.ListFormat.ApplyBulletDefault();

        range = doc.Paragraphs.Last.Range;
        range.Text = "Bye for now!";
        range.InsertParagraphAfter(); 
```

# python-sphinx - Sphinx，使用自动模块查找子模块

> ID：11508290
> 
> 赞同：36
> 
> 时间：2012-07-16T16:12:41.977
> 
> 标签：python-sphinx

使用 sphinx 的自动模块 ( [https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html](https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html) ) 时，

我只是写在一个 .rst 文件中：

```
.. automodule:: my_module
    :members: 
```

它很好地记录了 my_module，但没有找到像 my_module.inner_module0 和 my_module.inner_module1 这样的内部模块。除了 __all__ 变量之外，是否需要在 __init__.py 文件中指定一些内容？

另外，我知道`sphinx-apidoc`. 但是该命令的文档太多了（暴露了每个函数/文件夹，包括未记录的函数/文件夹）。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-07-19T19:49:58.107

听起来你想给`automodule`指令一个包名，让它递归到目录中并记录每个 Python 模块。这还不支持。您将需要为要记录的每个模块指定完整的*点分模块名称。*

例如，给定以下目录结构（来自 Python 文档）。您不能指定`.. automodule:: sound.formats`并让它记录目录中的所有模块。您必须`automodule`为每个模块指定一个命令：`.. automodule:: sound.formats.waveread`、 `.. automodule:: sound.formats.wavewrite`等。

```
sound/                          Top-level package
      __init__.py               Initialize the sound package
      formats/                  Subpackage for file format conversions
              __init__.py
              wavread.py
              wavwrite.py
              aiffread.py
              aiffwrite.py
              auread.py
              auwrite.py
              ...
      effects/                  Subpackage for sound effects
              __init__.py
              echo.py
              surround.py
              reverse.py
              ... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-03-27T10:31:40.187

在我看来，如果导入这些子模块，现在应该可以[使用该`:imported-members:`选项（非直接链接，使用搜索）。](http://www.sphinx-doc.org/en/stable/ext/autodoc.html)`__init__.py`

但是，我个人无法完成这项工作（还）。

编辑：可能是一个[已知的错误](https://github.com/sphinx-doc/sphinx/issues/2128)。

# cakephp - Cakephp 2 模型 beforeSave() 未被调用

> ID：11508291
> 
> 赞同：1
> 
> 时间：2012-07-16T16:12:46.287
> 
> 标签：cakephp, cakephp-2.0, cakephp-model

我无法弄清楚为什么这段代码不起作用。`beforeSave`没有被调用。它应该会失败保存并在调试日志中添加一些行，但它实际上确实保存正常并且调试日志中没有写入任何行。

```
<?php
class Link extends AppModel {
    var $name = "Link";
    var $belongsTo = array('Category' => array('className' => 'Category', 'foreignKey' => 'category_id'));

  public function beforeSave(){
        if ($this->data[$this->alias]['id'] == null) {
            $this->log("new record", 'debug');
            $link = $this->find('first',array('conditions' => array('Link.status = 1 AND Link.category_id = '.$this->data[$this->alias]['category_id']), 'order' => array('Link.order DESC') ));
            if (is_null($link)) {
                $this->data[$this->alias]['order'] = 1;
            }else{
                $this->data[$this->alias]['order'] = $link['Link']['order'] + 1;
            }
        }
        else {
            $this->log("old record", 'debug');
        }
        return false;
    }
}   
?> 
```

我正在像这样在控制器中启动保存：

```
public function add($category_id = null)
    {
        if ($category_id == null) {
            $this->Session->setFlash(__('Category id cant be null'),'default', array('class' => 'error-message'));
            $this->redirect(array('action' => 'index', 'controller' => 'categories'));
        }
        else
        {
            if($this->request->is('post'))
            {
                $this->Link->create();
                $this->Link->set('category_id' => $category_id));
                if($this->Link->save($this->request->data))
                {
                    $this->Session->setFlash(__('The link has been saved'),'default', array('class' => 'success'));
                    $this->redirect(array('action' => 'index/'.$category_id));
                }
                else
                    $this->Session->setFlash(__('The link could not be saved. Please, try again.'),'default', array('class' => 'error-message'));
            }
            $this->set('category_id',$category_id);
        }
    } 
```

StackOverflow 中的另一个问题指出，`beforeSave`方法需要在 Model 中声明。我也对另一个模型做了同样的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-17T01:04:22.700

以下是一些一般性建议和对您的代码的一些评论以获得答案：

1) 如果模型回调或任何模型方法不起作用，请确保正在使用正确的模型而不是默认模型 (AppModel)。检查文件名、类名、扩展名（在您的情况下）和位置。

2）您错误地使用了条件数组（在这种情况下）。

`array('conditions' => array('Link.status = 1 AND Link.category_id = '.$this->data[$this->alias]['category_id'])`

你真的应该这样做：

```
array('conditions' => array('Link.status' => 1, 'Link.category_id' => $this->data[$this->alias]['category_id']) 
```

3）您的重定向使用错误

`$this->redirect(array('action' => 'index/'.$category_id));`

应该：

```
$this->redirect(array('action' => 'index', $category_id)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-23T20:56:05.777

如所写，您的 save() 将始终与此 beforeSave() 失败。beforeSave() 必须返回 true 才能使保存函数成功。事实上，你的似乎总是返回 false，保证保存失败。

从蛋糕手册：

> 确保 beforeSave() 返回 true，否则您的保存将失败。

# hadoop - HBase 作为输入 -> 无法平衡可用地图任务的负载

> ID：11508295
> 
> 赞同：0
> 
> 时间：2012-07-16T16:13:04.353
> 
> 标签：hadoop, hbase

我希望每个 hadoop 映射器在 M/R 作业中处理单独的数据部分，并且我想在伪分布式（单节点）设置上测试由于一个结果而需要存在许多映射器的情况更大的输入数据大小。鉴于我当前输入的大小和我正在试验的独立模式，我只能看到 1 个地图任务。

我的输入来自一个 hbase 表，我认为每个 hbase 表的区域数等于用于处理表数据的映射器数。

因此，为了重现许多映射器会处理输入数据的情况，我通过 shell 预定义了表的区域，如下所示：

创建 't1', 'f1', {NUMREGIONS => 4, SPLITALGO => 'HexStringSplit'}

或将“UniformSplit”设置为 SPLITALGO，但即使映射器确实**增加到**指定数量的区域（在将数据导入相应表之后），所有输入数据（在我尝试从该表中读取的后续测试作业中）通过仅通过**一个**映射器 - 其他映射器不处理任何输入行。

我在一个伪分布式（单节点）设置上工作，我真的不知道如何解决这个问题。有没有人有任何想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:41:25.273

您是扫描整个表格还是只扫描其中的一部分？如果您正在扫描表的一部分，那么这可能是您的问题的原因，因为您的数据源不足以触发多个映射器。

您可以尝试在 hbase-size.xml 配置中减小区域大小并重新启动 hbase 以达到预期的效果。

最后，在您的 mapred-site.xml 配置中，您有多少个映射器插槽？如果它只是 1，这不会限制 map 作业的数量，但会限制可以在该服务器上一次运行的 map 作业的数量。

除此之外，我认为您对指定每个作业的映射器数量没有太多控制权 - 不像您对减速器数量所做的那样。

# asp.net-mvc-4 - asp.net webapi 验证

> ID：11508304
> 
> 赞同：1
> 
> 时间：2012-07-16T16:13:19.853
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我有一个 API 控制器并从 JS 调用操作：

```
$('#create-se').on('click', function () {
    var data = {};

    $.ajax({
        url: 'api/registration',
        type: 'POST',
        data: data,
        dataType: 'json',
        contentType: 'application/json',
        success: function () {
        }
    });
});

public bool Post(UserRegistrationViewModel model)
{           
    if (!ModelState.IsValid) { return false; }
    return true;
} 
```

模型的必需属性和字符串长度很少。当我从 js 向控制器发送数据时，ModelState.IsValid 总是返回 true。我不知道如何解决它。即使发布的模型为空，Model.IsValid 仍然为真

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:23:34.340

[http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/](http://codebetter.com/johnvpetersen/2012/04/02/making-your-asp-net-web-apis-secure/) 这个网站有更好的方法来进行验证和使用标头发送令牌，如果它无效它将返回验证失败。

# html - 如何在图像上放置 iframe？

> ID：11508306
> 
> 赞同：5
> 
> 时间：2012-07-16T16:13:23.697
> 
> 标签：html, iframe

我想在我的 iframe 下放置一张图片，但我拼凑了一些代码，但它似乎并不完全正确。iframe 包含文本并具有透明背景。你能帮我吗？谢谢，

```
<td width="216" style="position: relative;">
<img src="http://southwestarkansasradio.com/images/onair995.jpg"></a><br>
<img src="http://southwestarkansasradio.com/images/playerbackground.jpg" style="z-index:  -1"/>
<div style="absolute;left:0px;top:0px;font-size: 32px;display: none">
  <iframe name="I1" width="316" height="216" src="http://southwestarkansasradio.com /NowPlaying.html" border="0" frameborder="0" allowTransparency="true">
Your browser does not support inline frames.</iframe>

</div>
</td> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:22:57.773

```
<img src="http://southwestarkansasradio.com/images/onair995.jpg"></a><br>
<img src="http://southwestarkansasradio.com/images/playerbackground.jpg" style="z-index:  -1"/>
<div style="position:absolute;left:0px;top:0px;font-size: 32px">
  <iframe width="316" height="216" src="http://southwestarkansasradio.com/NowPlaying.html" border="0" frameborder="0" allowTransparency="true">
      Your browser does not support inline frames.</iframe>
</div> 
```

您在包含 iframe 的 div 标签上有“display:none”。我测试了上面的代码，它的工作原理正如你所解释的那样。

# sql - 将一列中的标识符集合并到具有来自另一列的唯一标识符的组中

> ID：11508308
> 
> 赞同：2
> 
> 时间：2012-07-16T16:13:29.720
> 
> 标签：sql, sql-server-2008, tsql, uniqueidentifier

我在这个问题上花费的时间比我愿意承认的要多。我有一个实现游标的解决方案（如下），但我想知道其他方法是否可行？对我来说，这尤其困难，因为 SQL 中没有常见的构造，例如数组。

这似乎也是使用递归的一个好问题，但我无法弄清楚。该平台是 MSSQL 2008 或 T-SQL。

考虑一个具有两列非唯一标识符和一个日期列的表。对于每个日期，我想将一列 (X) 中的标识符合并或分组到第二列 (Y) 中的标识符是唯一的集合中。

*   X 标识符是非唯一的
*   Y 标识符在每组 X 标识符中是唯一的，但总体上不唯一
*   组合时，使用最小可能的 X 标识符
*   X 标识符不会跨越多个日期

也许最好的起点是一些样本数据。解决方案中还有一些扩展的示例数据。在我使用它的实际实现中，通常少于 200 行，通常少于 100 行。

```
Dt         X     Y     newX
6/1/2012   1     1     1
6/1/2012   1     2     1
6/1/2012   2     3     1
6/1/2012   3     1     3   <-- because Y=1 is already in X=1
6/1/2012   3     4     3
6/1/2012   4     5     1
6/1/2012   5     4     1   <-- Y=4 is in X=3 but not X=1
6/1/2012   5     6     1
6/1/2012   6     4     6   <-- Y=4 is in X=1 and X=3
6/1/2012   6     7     6 
```

解决方案...

```
-- task: combine/condense/reassign/coalesce/collapse/consolidate sets of X identifiers into groups with unique Y identifiers, and by date
--  - X identifiers are non-unique
--  - Y identifiers are unique within each set of X identifiers, but non-unique overall
--  - When combining, the minimum possible X identifier is used
--  - An X identifier will not span more than a single date

--drop table #tmpA

CREATE TABLE #tmpA (Dt DATETIME, X INT, Y INT, newX INT, origX INT)

-- sample data
--                        Dt                              X  Y  newX
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 1, 2, 0, 1)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 1, 1, 0, 1)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 2, 5, 0, 2)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 3, 2, 0, 3)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 3, 3, 0, 3)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 4, 3, 0, 4)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 5, 5, 0, 5)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 6, 5, 0, 6)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 7, 2, 0, 7)
INSERT INTO #tmpA VALUES (CAST('2012-06-01' AS DATETIME), 7, 1, 0, 7)       -- causes a debug 4

INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 1, 2, 0, 1)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 1, 1, 0, 1)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 2, 5, 0, 2)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 3, 2, 0, 3)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 3, 3, 0, 3)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 4, 3, 0, 4)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 5, 5, 0, 5)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 6, 5, 0, 6)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 7, 7, 0, 7)
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 7, 1, 0, 7)       -- causes a debug 3 if below not used
--INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 7, 6, 0, 7)     -- causes a debug 8 if above not used
INSERT INTO #tmpA VALUES (CAST('2012-06-02' AS DATETIME), 7, 5, 0, 7)

DECLARE @X          INT
DECLARE @tX         INT     -- temporary X
DECLARE @Y          INT
DECLARE @Dt         DATETIME
DECLARE @tDt        DATETIME = CAST('1900-01-01' AS DATETIME)   -- temporary date
DECLARE @newX       INT
DECLARE @min_X      INT     -- minimum X without Y duplicate
DECLARE @min_newX   INT

DECLARE CursorA CURSOR FOR SELECT Dt, X, Y, newX FROM #tmpA
ORDER BY Dt, X
OPEN CursorA
FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
SET @tX = @X        -- initialize for change in X detection

WHILE (@@FETCH_STATUS = 0)
BEGIN

-- a change in X?
IF (@tX != @X)
BEGIN
    -- change in X, update all prior X to their newX (which should all be the same)
    UPDATE #tmpA SET X = newX WHERE Dt = @tDt AND X = @tX
select 1 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
    SET @tX = @X
END

IF (@newX != 0)
BEGIN
    -- newX for this X and Y already assigned, move on
    FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
    CONTINUE
END

IF (@Dt != @tDt)
BEGIN
    -- date change
    SET @tDt = @Dt

    -- all for this first X are simply the same identifier
    UPDATE #tmpA SET newX = @X WHERE Dt = @Dt AND X = @X
select 2 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
    FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
    CONTINUE
END

-- still on same date
-- is there any duplicate Y already assigned a newX?
SELECT @min_X = MIN(X) FROM #tmpA
    WHERE Dt = @Dt AND X != @X AND Y = @Y AND newX != 0

IF @min_X IS NOT NULL
BEGIN

    -- there is a Y duplicate within this date
    -- find the earliest X which does not have a duplicate Y
    SELECT @min_newX = MIN(X) FROM #tmpA
        WHERE Dt = @Dt AND X != @X AND Y != @Y AND newX != 0
        AND X NOT IN (SELECT X FROM #tmpA
            WHERE Dt = @Dt AND X != @X AND Y = @Y AND newX != 0)

    IF @min_newX IS NOT NULL
    BEGIN

        -- is there an "earlier" X already assigned a newX?
        SELECT @min_X = MIN(newX) FROM #tmpA
            WHERE Dt = @Dt AND X = @X AND newX !=0

        IF @min_X IS NOT NULL
        BEGIN

            -- there is another X already assigned a newX
            IF @min_newX >= @min_X
            BEGIN
                -- set the other one to this one
                UPDATE #tmpA SET newX = @min_newX
                    WHERE Dt = @Dt AND X = @X AND newX = @min_X
                UPDATE #tmpA SET newX = @min_newX
                    WHERE Dt = @Dt AND X = @X AND Y = @Y
select 3 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
            END
            ELSE
            BEGIN
                UPDATE #tmpA SET newX = @min_X
                    WHERE Dt = @Dt AND X = @X AND Y = @Y
select 4 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
            END

            FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
            CONTINUE
        END

        -- 
        UPDATE #tmpA SET newX = @min_newX
            WHERE Dt = @Dt AND X = @X AND Y = @Y
select 5 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
        FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
        CONTINUE

    END

    -- no other X without a duplicate Y already assigned a newX so assign this entire X set to itself
    UPDATE #tmpA SET newX = @X WHERE Dt = @Dt AND X = @X
select 6 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
    FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
    CONTINUE
END

-- no other Y but it's possible that another newX for this X is set to something different
SELECT @min_newX = MIN(newX) FROM #tmpA
    WHERE Dt = @Dt AND X = @X AND Y != @Y AND newX != 0

-- also find the min X for this Y
SELECT @min_X = MIN(X) FROM #tmpA
    WHERE Dt = @Dt AND X != @X AND Y != @Y AND newX != 0

IF @min_newX IS NULL
BEGIN
    -- no other Y for this X is assigned so set it to the minimum X already found
    UPDATE #tmpA SET newX = @min_X
        WHERE Dt = @Dt AND X = @X AND Y = @Y
select 7 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
    FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
    CONTINUE
END

-- there is another of the same X with a newX
IF (@min_X = @min_newX OR @min_X > @min_newX OR @min_newX IS NULL)
BEGIN
    -- there is a different Y for this X which has already been assigned the same newX as this one should be
    -- or a later one was found
    UPDATE #tmpA SET newX = @min_X
        WHERE Dt = @Dt AND X = @X AND Y = @Y
select 8 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
    FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX
    CONTINUE
END

UPDATE #tmpA SET newX = @min_newX
    WHERE Dt = @Dt AND X = @X AND Y = @Y
select 9 as debug, @tX as tX, @min_X as minX, @min_newX as minR, @X as X, @Y as Y, @newX as newX
FETCH NEXT FROM CursorA INTO @Dt, @X, @Y, @newX

END

-- gotta catch the last set
UPDATE #tmpA SET X = newX WHERE Dt = @Dt AND X = @tX

SELECT * FROM #tmpA
--  ORDER BY Dt, X, Y
CLOSE CursorA
DEALLOCATE CursorA
RETURN 
```

这是输出的样子......

```
Dt                      X   Y   newX    origX
2012-06-01 00:00:00.000 1   2   1   1
2012-06-01 00:00:00.000 1   1   1   1
2012-06-01 00:00:00.000 1   5   1   2
2012-06-01 00:00:00.000 3   2   3   3
2012-06-01 00:00:00.000 3   3   3   3
2012-06-01 00:00:00.000 1   3   1   4
2012-06-01 00:00:00.000 3   5   3   5
2012-06-01 00:00:00.000 6   5   6   6
2012-06-01 00:00:00.000 6   2   6   7
2012-06-01 00:00:00.000 6   1   6   7
2012-06-02 00:00:00.000 1   2   1   1
2012-06-02 00:00:00.000 1   1   1   1
2012-06-02 00:00:00.000 1   5   1   2
2012-06-02 00:00:00.000 3   2   3   3
2012-06-02 00:00:00.000 3   3   3   3
2012-06-02 00:00:00.000 1   3   1   4
2012-06-02 00:00:00.000 3   5   3   5
2012-06-02 00:00:00.000 6   5   6   6
2012-06-02 00:00:00.000 7   7   7   7
2012-06-02 00:00:00.000 7   1   7   7
2012-06-02 00:00:00.000 7   5   7   7 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:20:56.607

你想要的是这样的。在插入临时表后将其粘贴

```
select * from 
(
select X, Y, origX, ROW_NUMBER() OVER(PARTITION BY X ORDER BY x) newX
from #tmpA
)
results 
```

# java - 检测内存不足错误

> ID：11508310
> 
> 赞同：15
> 
> 时间：2012-07-16T16:13:34.180
> 
> 标签：java, exception, exception-handling, out-of-memory

我想为我的系统提供一种检测是否发生内存不足异常的方法。此练习的目的是通过 JMX 公开此标志并采取相应措施（例如，通过在监控系统上配置相关警报），否则这些错误会在几天内被忽视。

天真的方法是为每个线程设置一个[未捕获的异常处理程序](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.UncaughtExceptionHandler.html)，并检查引发的异常是否是实例`OutOfMemoryError`并设置相关标志。但是，由于以下原因，这种方法并不现实：

*   异常可能发生在任何地方，包括 3rd 方库。我无法阻止他们抓住`Throwable`并为自己保留它。
*   库可以产生自己的线程，我无法为这些线程强制执行未捕获的异常处理程序。

我看到的一种可能的情况是字节码操作（例如在 顶部附加某种方面`OutOfMemoryError`），但是我不确定这是否是正确的方法，或者这在一般情况下是否可行。

我们已`-XX:+HeapDumpOnOutOfMemoryError`启用，但我不认为这是解决此问题的方法，因为它是为其他目的而设计的 - 并且在发生这种情况时它不提供 Java 回调。

有人做过吗？你会如何解决它或建议解决它？欢迎任何想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T18:12:16.577

您可以使用内存不足警告系统；这个[http://www.javaspecialists.eu/archive/Issue092.html](http://www.javaspecialists.eu/archive/Issue092.html)可以是一个灵感。您可以配置一个侦听器，该侦听器在超出某个内存阈值（例如 80%）后调用 - 您可以使用此调用开始采取纠正措施。

我们使用类似的东西，当组件的内存阈值达到 80% 时暂停组件的服务并启动清理动作；仅当已用内存低于另一个可配置值阈值时，组件才会返回。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-07T10:04:57.170

有[一篇](https://techblug.wordpress.com/2011/07/21/detecting-low-memory-in-java-part-2/)基于Scorpion 已经给出链接[的帖子的文章。](http://www.javaspecialists.eu/archive/Issue092.html)

该技术再次基于使用 MemoryPoolMXBean 并订阅“超出内存阈值”事件，但它与原始帖子中描述的略有不同。

作者指出，当您订阅普通的“超出内存阈值”事件时，可能会出现“误报”。想象一下内存消耗超过阈值的情况，但很快就会执行垃圾回收，之后会释放大量内存。事实上，这种情况在现实世界的应用中很常见。

幸运的是，还有另一个阈值，“收集使用阈值”，以及一个相应的事件，它会在垃圾回收后立即根据内存消耗触发。当您收到该事件时，您可以更加确信自己的内存不足。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T17:59:16.533

> 我们启用了 -XX:+HeapDumpOnOutOfMemoryError，但我不认为这是解决此问题的方法，因为它是为其他目的而设计的 - 并且在发生这种情况时它不提供 Java 回调。

这个标志应该是你所需要的。将生成的堆转储文件的输出目录设置在您定期检查的某个已知位置。回拨对您毫无用处。如果内存不足，就不能保证回调代码有足够的内存来执行！您所能做的就是收集数据并使用外部程序来分析内存不足的原因。任何在过程中恢复的尝试都会产生更大的问题。

字节码检测是可能的 - 但很难。 [HPjmeter 的](http://www.hpjmeter.com)监控工具能够预测未来的 OOM（带有警告）——但仅限于基于 HP-UX/Itanium 的系统。您可以专用一个守护线程来计算进程中的已用内存，并在超过此值时触发警报，但实际上您并没有解决问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:17:41.127

您可以使用静态捕获任何和所有*未捕获*的异常`Thread.setDefaultUncaughtExceptionHandler.` 当然，如果有人捕获所有 Throwables，它也无济于事。（我不认为任何事情都会发生，尽管使用 OOME 我怀疑你会得到级联效应，直到有问题的`try`块之外的东西爆炸为止。）希望线程会释放足够的内存以供异常处理程序工作；当您尝试处理它们时，OOM 错误确实会成倍增加。

# winapi - 为什么我的 Windows 事件跟踪不起作用？

> ID：11508317
> 
> 赞同：0
> 
> 时间：2012-07-16T16:14:02.043
> 
> 标签：winapi, etw

我试图弄清楚如何使用 Windows 的事件跟踪......但我失败了。
为什么这段代码会给我错误代码`ERROR_WMI_INSTANCE_NOT_FOUND`？

```
#include <stdio.h>
#include <tchar.h>
#include <Windows.h>
#include <Wmistr.h>
#include <Evntrace.h>
#include <evntcons.h>

ULONG NTAPI EtpEtwBufferCallback(IN PEVENT_TRACE_LOGFILE Buffer) { return TRUE; }
VOID  NTAPI  EtpEtwEventCallback(IN PEVENT_TRACE EventTrace) { }

int _tmain()
{
    LPCTSTR loggerName = KERNEL_LOGGER_NAME;
    EVENT_TRACE_LOGFILE logFile = {0};
    logFile.LoggerName = const_cast<LPTSTR>(loggerName);
    logFile.ProcessTraceMode = PROCESS_TRACE_MODE_REAL_TIME;
    logFile.BufferCallback = EtpEtwBufferCallback;
    logFile.EventCallback = EtpEtwEventCallback;
    TRACEHANDLE hTrace = OpenTrace(&logFile);
    ULONG result = ProcessTrace(&hTrace, 1, NULL, NULL);
    // result is ERROR_WMI_INSTANCE_NOT_FOUND
    _tprintf(_T("%u\n"), result);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:26:32.950

从[ProcessTrace docs](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364093%28v=vs.85%29.aspx)，`ERROR_WMI_INSTANCE_NOT_FOUND`意味着“您尝试实时使用事件的会话未运行或未启用实时跟踪模式”。

[您可以使用 Windows Driver Kit 中的tracelog](http://msdn.microsoft.com/en-us/library/windows/hardware/ff553012%28v=vs.85%29.aspx)启动 NT Kernel Logger ，但我手头没有 WDK，所以我没有尝试过。

[本文](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363691%28v=vs.85%29.aspx)解释了如何自己启动 NT Kernel Logger。

# reporting-services - Matrix中的列静态分组

> ID：11508319
> 
> 赞同：0
> 
> 时间：2012-07-16T16:14:14.347
> 
> 标签：reporting-services, grouping

我正在尝试在 Microsoft SSRS 中创建技术指标。我有一个数据集，其中有一个表格，告诉我我的产品是否通过了测试的各个阶段，我想采取其中一个阶段并将其静态分成两个子列。因此，例如，我有温度并想将其分解为最小和最大工作温度，因此列将如下所示：

```
|   Weight   |   Height   |   Temperature  |   Length    |
                          |  min  |  max   | 
```

但是我找不到任何方法来静态定义温度的列细分，我的主要问题之一是我需要从与其余信息不同的数据库中提取最小最大数据，因此需要使其成为自己的数据集。您对我可以分组的内容或如何将其拆分有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:19:49.830

我最终通过创建一个新行然后将组扩展到两列来弄清楚如何做到这一点。然后我只是用 if 语句隐藏了不需要的列。

# c# - 忘记密码网址

> ID：11508324
> 
> 赞同：5
> 
> 时间：2012-07-16T16:14:42.707
> 
> 标签：c#, asp.net, url

我有一个使用 asp.net 登录控件的 Web 应用程序。此外，我还为用户使用了密码恢复控件来恢复他们的密码。一旦用户在恢复控件中输入了他们的详细信息，一封包含验证 URL 的电子邮件将被发送到用户的电子邮件地址。单击 URL 后，它将引导用户进入我的 Web 应用程序的 UserProfile，其中允许用户更改密码。

现在的问题是，因为我对 UserProfile.aspx 设置了访问规则以拒绝匿名用户，所以当我从 URL 重定向到 UserProfile.aspx 页面时，它会将我定向到 LoginPage（系统将我识别为匿名用户）。

为什么会这样？单击 URL（包括所有用户信息）后，是否有任何地方可以直接进入用户配置文件页面？

URL 如下所示：

```
http://localhost:1039/Members/UserProfile.aspx?ID=56f74cc7-7680-4f1b-9207-0ab8dad63cad 
```

URL 的最后一部分实际上是 userId。

这是用户配置文件 aspx 的代码：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" 
              ConnectionString="<%$ ConnectionStrings:ASPNETDBConnectionString1 %>" 
              SelectCommand="SELECT aspnet_Membership.Email, Details.CustName, Details.CustNum, Details.CustRole, Details.CustStatus, Details.PName, Details.PEmail, Details.PRole, Details.WedDate, aspnet_Users.UserName, Details.UserId FROM Details INNER JOIN aspnet_Membership ON Details.UserId = aspnet_Membership.UserId INNER JOIN aspnet_Users ON aspnet_Membership.UserId = aspnet_Users.UserId WHERE (Details.UserId = @UserId)" 

              UpdateCommand="update Details SET CustName = @CustName, CustNum = @CustNum, CustRole = @CustRole, CustStatus = @CustStatus, PName = @PName, PEmail = @PEmail, PRole = @PRole, WedDate = @WedDate WHERE [UserId] = @UserId

                            Update aspnet_Membership Set Email= @email WHERE [UserId] = @UserId"

              DeleteCommand= "DELETE FROM Details WHERE UserId = @UserId;"> 

              <DeleteParameters>
                  <asp:ControlParameter ControlID="lblHidden" Name="UserId" PropertyName="Text" 
                      Type="String" />
              </DeleteParameters>

              <SelectParameters>
                  <asp:ControlParameter ControlID="lblHidden" Name="UserId" PropertyName="Text" />

              </SelectParameters>

              <UpdateParameters>
                  <asp:Parameter Name="CustName" />
                  <asp:Parameter Name="CustNum" />
                  <asp:Parameter Name="CustRole" />
                  <asp:Parameter Name="CustStatus" />
                  <asp:Parameter Name="PName" />
                  <asp:Parameter Name="PEmail" />
                  <asp:Parameter Name="PRole" />
                  <asp:Parameter Name="WedDate" />
                  <asp:Parameter Name="UserId" />
                  <asp:Parameter Name="email" />
              </UpdateParameters>

          </asp:SqlDataSource>
          <asp:DetailsView ID="DetailsView1" runat="server" AutoGenerateRows="False" 
              DataSourceID="SqlDataSource1" Height="50px" Width="125px">
              <Fields>
                  <asp:BoundField DataField="Email" HeaderText="Email" SortExpression="Email" />
                  <asp:BoundField DataField="CustName" HeaderText="CustName" 
                      SortExpression="CustName" />
                  <asp:BoundField DataField="CustNum" HeaderText="CustNum" 
                      SortExpression="CustNum" />
                  <asp:BoundField DataField="CustRole" HeaderText="CustRole" 
                      SortExpression="CustRole" />
                  <asp:BoundField DataField="CustStatus" HeaderText="CustStatus" 
                      SortExpression="CustStatus" />
                  <asp:BoundField DataField="PName" HeaderText="PName" SortExpression="PName" />
                  <asp:BoundField DataField="PEmail" HeaderText="PEmail" 
                      SortExpression="PEmail" />
                  <asp:BoundField DataField="PRole" HeaderText="PRole" SortExpression="PRole" />
                  <asp:BoundField DataField="WedDate" HeaderText="WedDate" 
                      SortExpression="WedDate" />
                  <asp:BoundField DataField="UserName" HeaderText="UserName" 
                      SortExpression="UserName" />
                  <asp:BoundField DataField="UserId" HeaderText="UserId" 
                      SortExpression="UserId" />
                  <asp:CommandField ShowEditButton="True" />
              </Fields>
          </asp:DetailsView>
          <asp:Label ID="lblHidden" runat="server" Text="Label" Visible="False"></asp:Label>

          <asp:Button ID="btnDelete" runat="server" onclick="btnDelete_Click" 
              Text="Delete" /> 
```

这是后面的代码：

```
protected void Page_Load(object sender, EventArgs e)
    {
         MembershipUser currentUser = Membership.GetUser();
        lblHidden.Text = currentUser.ProviderUserKey.ToString();
    }

    protected void SqlDataSource1_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
    {
        // Get a reference to the currently logged on user
        MembershipUser currentUser = Membership.GetUser();

        // Determine the currently logged on user's UserId value
        // Assign the currently logged on user's UserId to the @UserId parameter
        //access the parameter value using e.Command.Parameters 
        //programmatically set the @UserId:
        e.Command.Parameters["@UserId"].Value = currentUser.ProviderUserKey.ToString();

    }
    protected void btnDelete_Click(object sender, EventArgs e)
    {

        SqlConnection connection = new SqlConnection();
        connection.ConnectionString = ConfigurationManager.ConnectionStrings["ASPNETDBConnectionString1"].ConnectionString;
        SqlCommand cmd = new SqlCommand();
        SqlCommand cmd1 = new SqlCommand(); 
        string userId = lblHidden.Text;

        cmd.Connection = connection;
        cmd.CommandText = "DELETE FROM Details WHERE UserId ='" + userId + "'";

        cmd1.Connection = connection;
        cmd1.CommandText = "DELETE FROM aspnet_Membership WHERE UserId ='" + userId + "'"; 

        connection.Open();

        cmd.ExecuteNonQuery();
        cmd1.ExecuteNonQuery();

        connection.Close();

      Response.Redirect("Home.aspx");
    } 
```

其次，有什么办法可以设置 URL 的过期时间吗？如果 URL 被第二次点击，它不会将用户重定向到任何地方。我看到很多帖子，其中大多数建议在数据库中添加一列。有没有其他方法可以在不接触数据库的情况下设置到期时间？？？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:26:14.497

考虑更改密码链接的单独页面。让此页面采用唯一标识符。这个标识符应该只工作一次，有一个到期日期，并且是特定于该用户的。将此页面设为公开：

```
<location path="changepassword.aspx">
 <system.web>
   <authorization>
     <allow users="*"/>
   </authorization>
 </system.web>
</location> 
```

您需要在某处针对用户存储唯一标识符。如果您不想影响当前架构，可以创建一个新表：

```
PK | Identifier | UserID                               | expires
1  | abcd       | ffffffff-ffff-ffff-ffff-ffffffffffff | 16-jul-2012 18:26 
```

当请求页面时，如果标识符已过期，则不允许该页面运行。更改密码后，使标识符无效 - 要么将其删除，要么将过期日期设置为过去的某个时间（例如现在）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:35:27.257

这不是对所提出问题的直接回应，而是对构建密码重置工具的更一般的评论......

在编写此功能时，我会做一些不同的事情。

**访问个人资料页面或只是更改密码？**

首先，如果用户只需要更改他们的密码，他们不需要访问用户个人资料页面，只需更改密码页面即可。我会将他们直接带到“更改密码”页面，并使其特定于密码重置功能，因此可以毫无问题地匿名使用。

**为什么不对它们进行身份验证，然后将它们发送到个人资料页面？**

另一种选择是不要乱用匿名访问事物，只需执行自动登录即可。该 url 将指向一个登录页面，该页面将自动登录给定的用户（毕竟您拥有所有用户详细信息）。然后他们可以被重定向到个人资料页面，他们不再是匿名的，所以一切都很好。

**纯文本用户 ID 的问题**

您需要使用更好的令牌。如果有人可以找到另一个用户的用户 ID（如果您单击以查看用户的公共个人资料，它可能会显示在 url 中），那么他们可以更改该人的密码。我相信你知道这并不酷。

**我用什么代替纯文本用户 ID？**

*随机令牌*

围绕此的两种方法是创建存储在数据库中的随机令牌，然后在加载页面时验证它们。当然，当您想要使它们无效时，只需更改数据库中的某些内容，就可以很容易地使它们无效。您可以在数据库中存储一个随机令牌（我可能会选择一个大约 16 个字符长的 base64 编码字符串 - 实际上是 96 位随机性）以及任何必要的信息（例如用户 ID、创建日期（或到期日期）） ， ETC。）。如果您希望它成为一种用途，您可以在验证一次后将令牌从数据库中清除（或标记一个字段以说明其已被使用或任何数量的其他替代方案）。

*加密令牌*

不涉及接触数据库的更安全的方法是创建一个可以传递给用户的加密令牌。该令牌可能包含用户 ID 和创建令牌的时间（以及您喜欢的任何其他信息），并且会被放入电子邮件中并被遗忘。因为它是加密数据而不是回发时的随机令牌，而不是通过数据库进行验证，所以您可以解密给定的令牌以查找用户以及令牌的年龄。

如果您想在不访问数据库的情况下使它们成为一种用途，这有点棘手，但我可能会将生成的令牌存储在服务器应用程序字典中，如果令牌不在其中，则它无效并且您删除一旦使用，它就从您存储的列表中。您还定期清理旧令牌，以确保您没有存储太多垃圾。这种方法还有一个缺点，即如果重新启动应用程序，您将清除令牌列表，从而使它们全部失效。这只是一个问题，如果你需要它们是一个镜头。就个人而言，我会让他们在您确定适合使用单个令牌的任何时间范围内随心所欲地重置密码。:)

**原始场景中关于明文用户 ID 的另一个警告**

我不能强调你需要多么小心，只需将用户 ID 以纯文本形式放在 url 中作为唯一传递的信息。当有人发现另一个人的用户 ID 时，他们的帐户就被有效地入侵了。他们只需要将那个人的用户 ID 放入 url 中，他们就可以更改他们的密码。

即使您现在没有任何地方可以公开其他人的 UserID，您也必须 100% 确定将来永远不会，这在实践中是无法保证的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:20:43.770

`<configuration>`您可以通过将以下内容添加到标签内的 web.config 来尝试允许匿名用户进入您的用户配置文件页面。

```
 <location path="userProfile.aspx">
    <system.web>
      <authorization>
        <allow users="?"/>
      </authorization>
    </system.web>
  </location> 
```

# ruby-on-rails - Rails 2.3.5 中的唯一搜索结果

> ID：11508326
> 
> 赞同：2
> 
> 时间：2012-07-16T16:14:50.173
> 
> 标签：ruby-on-rails

感谢您对我遇到的这个问题的帮助。

我的控制器方法中有以下内容。

```
@search=Book.book2_scope.search(params[:search]) 
```

问题是@search 包含重复的条目。

我只想有不同的条目（不同的 id）。

我尝试了以下解决方案：

```
@search = Book.search(params[:search])

@search.book2_scope.select("DISTINCT(id), books.*") 
```

但它似乎是 rails 3 的解决方案，而不是 rails 2.3.5。

任何建议都是最受欢迎的。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T12:02:17.733

重复可能是您的`book2_scope`范围的结果。您可以重写它以确保只返回不同的记录。

# javascript - 脚本向 IE 弹出窗口阻止程序添加异常

> ID：11508331
> 
> 赞同：0
> 
> 时间：2012-07-16T16:15:02.707
> 
> 标签：javascript, sharepoint, sharepoint-2010

寻找其他建议或编写脚本的方法，将异常添加到 IE 弹出窗口阻止程序。这是情况。

我们有一个域 MyDomain.com，这是我们的核心 SP2010 站点站点所在的位置。然后，我们有 2 个其他域指向我们组织内的其他应用程序。即 site1.MyDomain.com 和 site2.MyDomain.com。我们在 SP2010 站点中有一个页面，该页面加载了一个 iframe，其中包含来自 site1.MyDomain.com 的目录页面。单击其中一个链接将弹出一个窗口，其中包含来自 site1.MyDomain.com 的详细信息供您选择。然后该弹出页面上的链接会将您带到 site2.MyDomain.com。问题在于，如果用户启用了弹出窗口阻止程序并关闭了横幅通知，则不会通知他们触发了弹出窗口。

我希望能够在 SP2010 页面的主页上运行脚本来检测 *.MyDomain.com 是否已添加到弹出窗口阻止程序排除列表中，如果没有，则提示添加站点。我不知道这是否可能，但任何反馈将不胜感激。我们正在寻找一种解决方案，将最终用户视为一个喋喋不休的白痴，并且仍然有这项工作。您知道营销人员的业务需求如何。

# perl - 使用来自另一个包的排序子例程

> ID：11508333
> 
> 赞同：8
> 
> 时间：2012-07-16T16:15:09.827
> 
> 标签：perl, sorting, package, subroutine

我有一个脚本和一个包，如下所示：

```
# file: sortscript.pl
use strict;
use warnings;
use SortPackage;

my @arrays = ([1,"array1"],[10,"array3"],[4,"array2"]);

print "Using sort outside package\n";
foreach (sort SortPackage::simplesort @arrays){
    print $_->[1],"\n";
}

print "\nUsing sort in same package\n";
SortPackage::sort_from_same_package(@arrays); 
```

--

```
# file: SortPackage.pm
use strict;
use warnings;
package SortPackage;

sub simplesort{
    return ($a->[0] <=> $b->[0]);
}

sub sort_from_same_package{
    my @arrs = @_;
    foreach (sort simplesort @arrs){
        print $_->[1],"\n";
    } 
}
1; 
```

运行脚本会产生输出：

```
$ perl sortscript.pl
Using sort outside package
Use of uninitialized value in numeric comparison (<=>) at SortPackage.pm line 15.
Use of uninitialized value in numeric comparison (<=>) at SortPackage.pm line 15.
Use of uninitialized value in numeric comparison (<=>) at SortPackage.pm line 15.
Use of uninitialized value in numeric comparison (<=>) at SortPackage.pm line 15.
Use of uninitialized value in numeric comparison (<=>) at SortPackage.pm line 15.
Use of uninitialized value in numeric comparison (<=>) at SortPackage.pm line 15.
array1
array3
array2

Using sort in same package
array1
array2
array3 
```

为什么当它在另一个包中时，我无法正确使用子例程进行排序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T16:22:42.080

`$a`并且`$b`是特殊的“包全局”变量。

要使用主范围`$a`和`$b`比较器功能，必须引用`$::a`or `$main::a`（同样适用于`$b`）。

但是，当从任何其他包甚至从其自己的包中调用时，该比较器函数*将不起作用。*

请参阅`perlvars`帮助和`perldoc`功能`sort`。解决方案也在后面的帮助文本中：

> 如果子例程的原型是`"($$)"`，则要比较的元素通过引用传递 in `@_`，就像普通子例程一样。这比非原型子例程要慢，其中要比较的元素作为包全局变量传递到子例程中`$a`（`$b`参见下面的示例）。`$a`请注意，在后一种情况下，将和声明`$b`为词法通常会适得其反。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-07-16T17:47:20.197

如前所述，`$a`并且`$b`是包全局变量，因此另一种解决方案是将调用站点的全局变量临时别名为 package 中的全局变量`SortPackage`：

```
{
    local (*a, *b) = (*SortPackage::a, *SortPackage::b);
    foreach (sort SortPackage::simplesort @arrays){
        print $_->[1],"\n";
    }
} 
```

但这当然很丑陋。我只需要`SortPackage`导出一个完整的排序例程，而不仅仅是一个比较器：

```
package SortPackage;
use strict;

sub _sort_by_first_element_comparator {
    return $a->[0] <=> $b->[0];
}

sub sort_by_first_element {
    return sort _sort_by_first_element_comparator @_;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-16T16:26:29.193

特殊变量`$a`和`$b`是包全局变量。您的子例程需要`$SortPackage::a`和`$SortPackage::b`. 当您从 调用它时`sortscript.pl`，变量`$main::a`和`$main::b`由 设置`sort`。

解决方案是使用原型子程序：

```
package SortPackage;

sub simplesort ($$) {
    return ($_[0]->[0] <=> $_[1]->[0]);
} 
```

它有点慢（因为您传递了实际参数，而不是读取预设的全局变量），但它允许您在尝试时按名称使用其他包中的子例程。

# objective-c - 首次启动时无法识别 iCloud KeyValue 存储

> ID：11508334
> 
> 赞同：8
> 
> 时间：2012-07-16T16:15:12.433
> 
> 标签：objective-c, ios, icloud, key-value-store

我的应用程序使用 iCloud（键值存储）在多个设备之间同步唯一 ID。如果它真的必须在应用程序的第一次启动时工作，那么这项工作就可以接受。看起来设备在首次启动时还不熟悉 iCloud 的值，只有在安装了应用程序并运行了一段时间之后。

我在应用程序主视图的 viewDidLoad 函数中检查 iCloud 值。

所以，我的问题：

*   这是预期的行为吗？
*   如果是，是否有其他解决方案？
*   难道这只是从 Xcode 运行时出现的问题，而不是发货版本？如果是这样，如何测试？

谢谢！

碧玉

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T14:53:06.580

我有一个类似的问题，无论我等了多长时间，NSUbiquitousKeyValueStoreDidChangeExternallyNotification 都没有在安装后的第一次启动时触发。在 NSUBiquitousKeyValueStore 中设置一个初始键似乎可以解决这个问题。

在将观察者添加到默认存储后，我立即调用：

```
[[NSUbiquitousKeyValueStore defaultStore] setString:@"testValue" forKey:@"testKey"];
[[NSUbiquitousKeyValueStore defaultStore] synchronize]; 
```

我对要同步的实际数据使用不同的键（即不是*testKey ）。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:32:09.393

当您第一次运行启用了 iCloud 的应用程序时，它必须从 Apple 服务器中提取所有数据。执行此操作所需的时间取决于许多因素，例如您当前使用的网络类型（Edge、3G、GPRS、WLAN）。它还取决于 iCloud 服务器当前必须处理多少流量，因此无论您拥有何种类型的网络连接，对 iCloud 服务器的请求都可能需要几秒钟的时间。

总结一下：是的，这听起来很正常。

如果运行您的应用程序取决于这些设置，请考虑实现一个“等待”或“加载”视图，只要应用程序执行初始同步并从云加载所有需要的数据，它就会一直停留在屏幕上。为了不永远阻塞 UI，还为此视图实现超时（如果 iCloud 数据未在 X 秒内加载，则关闭视图并通知用户）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-20T01:50:49.100

当您的应用程序首次启动时，您无法保证`NSUbiquitousKeyValueStore`会完成第一次同步。（事实上​​，在 iOS 5 上，它通常会在您第一次启动应用程序时开始同步）。

无法知道第一次初始同步是否已经发生、正在进行或已完成。您可以（实际上**应该**）订阅`NSUbiquitousKeyValueStoreDidChangeExternallyNotification`. 诀窍是，如果您的存储在 iCloud 服务器上为空，则在初始同步后您将不会收到任何通知（因为您的本地存储为空且云存储也为空，所以在初始同步之后“外部”没有真正改变同步…）

通常，您不应依赖已完成的初始同步。

在发布时保持乐观，即使您的商店是空的，也要立即推动您的价值观（例如您的唯一 ID）。如果初始同步同时或之后发生，并且服务器上已经有一些值，您的本地值将重置为服务器值，您将收到`NSUbiquitousKeyValueStoreDidChangeExternallyNotification`带有`NSUbiquitousKeyValueStoreInitialSyncChange`原因的通知。

最后，如果您真的想知道初始同步是否已完成，请向 bugreport.apple.com 提交错误并解释您真正需要它的原因。

# org-mode - org 模式议程忽略没有 TODO 状态的条目

> ID：11508335
> 
> 赞同：4
> 
> 时间：2012-07-16T16:15:16.987
> 
> 标签：org-mode

我在 org 文件中有以下（子）树

```
* Project
** SubProject
*** TODO Do this action 1
*** TODO Do this action 2 
```

我希望我的议程只显示带有 TODO 关键字的条目。目前议程给了我

```
Project
SubProject
TODO Do this action 1
TODO Do this action 2 
```

我希望它只显示

```
TODO Do this action 1
TODO Do this action 2 
```

目前我`org-agenda-skip-function-global`用来跳过`DONE`和`CANCELLED`操作

```
(setq org-agenda-skip-function-global 
      '(org-agenda-skip-entry-if 'todo '("DONE" "CANCELLED"))) 
```

有没有办法告诉它也跳过没有 TODO 状态的动作？我试过添加`nil`还是`""`不行？如果没有，还有其他方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T16:20:41.227

您可以将条件`nottodo`用于反向匹配并使用：

```
(org-agenda-skip-entry-if 'nottodo '("TODO")) 
```

用于`C-h f org-agenda-skip-if RET`查看完整文档。

# .net - 在哪里使用工作单元模式验证我的实体？

> ID：11508338
> 
> 赞同：3
> 
> 时间：2012-07-16T16:15:37.473
> 
> 标签：.net, asp.net-mvc, entity-framework, unit-of-work

我总是`DbContext.SaveChanges()`在`UnitOfWork.Commit()`方法中看到一个。但是，当我从 DbContext 获取实体并更改属性时，`UnitOfWork.Commit()`会将新实体值写回我的数据库，而无需任何验证。

我会避免使用集成的`DbContext.Configuration.ValidateOnSaveEnabled = true;`.

目前我不使用 UnitOfWork-Pattern。我对我的服务类中的每个插入/更新操作运行验证，如果验证成功，存储库调用`DbContext.SaveChanges()`。

如何避免`UnitOfWork.Commit()`使用无效实体？如果我在 ASP.NET MVC 控制器中使用 UnitOfWork 对象，正如它在此答案中所建议的那样： [在哪里工作单元属于 w/EF4、IoC (Unity) 和存储库？](https://stackoverflow.com/questions/5026265/where-does-unit-of-work-belong-w-ef4-ioc-unity-and-repository/5026857#5026857) ...无法保证验证已完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:44:05.493

你基本上在那里。当您使用 UoW 时，您的存储库更新将独立于对数据存储的任何提交。只需将您移动`DbContext.SaveChanges()`到一个新`UnitOfWork.Commit()`方法（或`DbContext.SaveChanges()`直接用作您的提交方法），并将验证逻辑留在您的存储库`Insert`/`Update`方法中。

```
using (var uow = new UnitOfWork())
{
  var e1 = new Entity() { ... };
  repo.Insert(e1);  // validates e1 immediately

  var e2 = GetExistingEntity();
  e2.Value = 42;
  repo.Update(e2);  // validates e2 immediately
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T19:03:14.310

我更喜欢不要混合验证和数据保存。当然，实体*必须*在保存到数据库之前进行验证，但这并不意味着它们必须*在*保存时进行验证。

根据应用程序，可能需要在上下文之外进行验证，例如在单元测试、某些 UI 操作、ASP.NET MVC 中的远程/客户端验证等中，可能并非所有这些操作都必须导致提交数据。

也许验证所有受影响的实体而不是保存它更好？使用默认的内置 ASP.NET MVC 验证很容易，因为它使用与 EF 相同的属性。当然，如果您使用第三方验证框架，那就更容易了。

备注：也不要忘记，有些错误不保存是*无法*处理的，通常是违反约束和触发逻辑。所以验证也*必须*处理这些错误。不幸的是，我不知道 EF 如何处理这些错误，在我的开发中，我通常对每个约束进行一些硬编码。

# java - Gmail Java 库

> ID：11508355
> 
> 赞同：3
> 
> 时间：2012-07-16T16:16:36.577
> 
> 标签：java, gmail

是否有任何 Gmail Java 库？我查看了来自 Google 和 GData 的 Java 库，但运气不佳。

我已经进行了搜索，我发现的很多图书馆似乎都过时了。我只是好奇是否有人知道更多最新的图书馆？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:22:49.617

我确信有一个简单的 Web 界面，但推荐的解决方案是 IMAP 和 SMTP，您会找到数十个库。

比尔的答案在这里有如何使用 SMTP 的示例：[https ://stackoverflow.com/a/47452/12943](https://stackoverflow.com/a/47452/12943)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-25T18:20:32.097

现在有谷歌的 Gmail API。这是它的[链接](https://developers.google.com/gmail/api/)。

# three.js - 网格的点表面朝向另一个对象

> ID：11508357
> 
> 赞同：1
> 
> 时间：2012-07-16T16:16:45.740
> 
> 标签：three.js

作为以下内容的延续：将 [一个物体指向远处的物体](https://stackoverflow.com/q/11440337/1518845)

我试图让网格的表面指向另一个对象。每当远处的物体移动时，我希望一个远处的物体指向一个近处的物体。

这是正在发生的事情的示例：http: [//jsfiddle.net/UsVUv/](http://jsfiddle.net/UsVUv/)

1）我创建了 2 个网格对象。2）由于远网格面朝上，我旋转它以便从相机可以看到它。-> farMesh.rotation = new THREE.Vector3(Math.PI/2, 0, 0); 3）当远网格移动时，我调用以下命令使其继续查看近网格。远网格的面不会看近网格，但其平面的边缘会看。-> farMesh.lookAt(nearMesh.position); 4）然后我尝试将网格向后旋转，使其再次面向相机，但这会消除lookAt所做的旋转。-> farMesh.rotation = new THREE.Vector3(Math.PI/2, 0, 0);

您可以注释掉示例中的 1)、2) 和 3) 行以查看发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:57:51.350

是的，`farMesh.lookAt()`和`farMesh.rotation`正在相互竞争。

相反，您需要做的`farMesh`是在创建平面几何图形后立即旋转它，`applyMatrix()`如下所示：

```
 farMesh.geometry.applyMatrix( new THREE.Matrix4().makeRotationX( Math.PI / 2 ) ); 
```

总而言之，`applyMatrix()`转换对象的几何形状，并`lookAt()`设置对象的`rotation`矢量。

这是一个更新的小提琴：http: [//jsfiddle.net/UsVUv/1/](http://jsfiddle.net/UsVUv/1/)

# javascript - 这是在不使用“Fancy Javascript”的情况下验证表单的最佳方法

> ID：11508358
> 
> 赞同：-1
> 
> 时间：2012-07-16T16:16:53.353
> 
> 标签：javascript, backbone.js, validation

我正在使用[`backbone.syphone`](https://github.com/derickbailey/backbone.syphon) 序列化数据并将它们保存到服务器。

我想知道在不使用“Fancy Javascript”的情况下处理错误或验证日期以将它们发送到服务器的最佳方法是什么。

附言

我只需要检查所有字段是否为空。

这是我的代码：

```
var myView = Backbone.View.extend({

    submitData: function (event) {
        event.preventDefault();
        var data = backboneSyphon.serialize(this);
        myModel.save(data, {
            success: function () {
            },
            error: function () {
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T19:42:38.967

如果您不想使用花哨的 javascript 代码，
在您的情况下，由于您使用的是 Backbone，
我建议您使用backbone.validation。

这是该库的链接：[backbone.validation](https://github.com/thedersen/backbone.validation/blob/master/backbone.validation.min.js)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:39:49.457

除非您想做纯粹的服务器端验证，否则您将*不得不*使用*一些*Javascript 来进行验证；我不太清楚你所说的“花哨”是什么意思。由于您使用的是 Backbone，这很可能意味着您使用的是 jQuery（嗯，或者 Zepto），所以我认为 jQuery 是在“花哨”范围内;-)

使用 jQuery，我能想到的最简单的 JS 是这样的：

```
var failed;
$('#yourForm :input').each(function(input) {
    if (!$(input).val()) {
        alert("You need to fill in " + input.name);
        failed = true;
        return false;
    }
}
// Do whatever else you want to do if (failed) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:19:04.260

这是一个“非花哨的javascript”:)

```
<!DOCTYPE html>
<title></title>
<form id="form" method="post" action="someform.php">
<input id="name" name="Name" value="Name*">
<input type="submit" value="">
</form>

<script>
window.onload = function () {
var yourForm = document.getElementById('form'),
    yourInput = document.getElementById('name');

yourForm.onsubmit = function () {
    if(yourInput.value == yourInput.defaultValue || yourInput.value == '') {
        alert('You must write something');
        return false;
    }
}
}
</script> 
```

# php - 循环浏览一排电子邮件

> ID：11508363
> 
> 赞同：1
> 
> 时间：2012-07-16T16:17:21.837
> 
> 标签：php, mysql

我需要从管理功能中隐藏某些帐户。

目前，为管理员列出了 eash 帐户。但是，我希望隐藏所有以 gmail.com 结尾的电子邮件，直到我要求将它们与其他电子邮件一起列出。

这是我拥有的电子邮件的代码：

```
 if(empty($resLine['ord_conEmail'])){
        $resLine['ord_conEmail'] = "Account {$resLine['ord_account']}";
    } 
```

较大的代码是：

```
 $buffer .= "
        <div id=\"catDetail\">
            <h1>Orders Listing$pnStr</h1>
            <div>
                <table class=\"roundTableFormat\">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Order Date</th>
                            <th>Cust. Email Address</th>
                            <th>Order Total</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>";

forEach($res as $resLine){
    if($resLine['ord_date'] > mktime() - 86400){
        //24 hours
        $resLine['ord_date'] = date("D jS - g:iA", $resLine['ord_date']);
    }else if($resLine['ord_date'] > mktime() - 259200){
        //OLD:display Day of Week for last five days (60*60*24*5=432000 sec
        //New: 3 days = 259200
        $resLine['ord_date'] = date("D jS - g:iA", $resLine['ord_date']);
    }else{
        //display full date
        $resLine['ord_date'] = date("M j, Y", $resLine['ord_date']);
    }

    $resLine['ord_total'] = "$".number_format($resLine['ord_total'], 2);

    if(empty($resLine['ord_conEmail'])){
        $resLine['ord_conEmail'] = "Account {$resLine['ord_account']}";
    }

    $buffer .= "
            <tr>
                <td class=\"ds br\">{$resLine['ord_id']}</td>
                <td class=\"al ls br\">{$resLine['ord_date']}</td>
                <td class=\"al ls\">{$resLine['ord_conEmail']}</td>
                <td class=\"ar bl br\">{$resLine['ord_total']}</td>
                <td class=\"ds \">
                    <a href=\"?action=orders&ordview={$resLine['ord_id']}\">View</a>
                    <a href=\"?action=orders&ordprint={$resLine['ord_id']}\">Print</a>
                </td>
            </tr>";
} 
```

如何创建一个循环来隐藏某些电子邮件不显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:42:51.540

您可以添加一个哈希表（关联数组）来存储您想要省略的电子邮件域。

```
$domains = array(
    'gmail.com' => true
); 
```

您可以添加一个条件语句来检查是否设置了域。它将被插入到缓冲要打印的 html 的行之前。

```
$email = $resLine['ord_conEmail'];

// Assumes e-mail address is correctly formatted: user@domain
$result = explode('@', $email);
$domain = $result[1];

if (isset($domains[$domain]) && $domains[$domain]) {
    continue; // Skip row
} 
```

# android - 使用 C 和 C++ 文件的 Android NDK

> ID：11508366
> 
> 赞同：2
> 
> 时间：2012-07-16T16:17:26.610
> 
> 标签：android, android-ndk

我正在使用 Android NDK 访问一个已用于 Palm Pilot 程序的库，但深入研究它，我发现该库中有一个 .cpp 文件。

NDK 是否会正确编译包含 C 和 C++ 文件的库，还是我需要创建两个单独的库？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-24T19:49:08.850

我有一个混合 c/c++ 代码的项目.. 我现在知道的是..

1.  C++ 代码应位于 .cpp 文件中（除非您在 Android.mk 文件中通过声明 cxx_extension=cc 或等效项来指定）
2.  c 代码应该在 .c 文件中

如果您正在使用 cpp 文件中明确为 c 的代码，反之亦然，那么您只需要遵守正常的开发规则，例如

> extern "C" {//你的 C 头文件和 C++ 文件中的代码}

ETC...

# pdf - 使用 TCPDF 生成的 PDF 中不需要的空间

> ID：11508369
> 
> 赞同：0
> 
> 时间：2012-07-16T16:17:45.817
> 
> 标签：pdf, pdf-generation, tcpdf

我们使用 TCPDF 生成 PDF。在一种特殊情况下，我遇到了一种奇怪的行为，看起来 TCPDF 在两个字符之间放置了一个空格。

我使用 cid0cs 作为字体，如果我在 PDF 中放置“µg”，就会出现奇怪的行为，它现在看起来像“µg”（中间有一些空格）。

我在索引 181 上编辑了 cid0cs.php（如这里：[http](http://bytethinker.com/blog/correct-display-of-imported-fonts-in-tcpdf) ://bytethinker.com/blog/correct-display-of-imported-fonts-in-tcpdf ）但没有成功。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-18T06:58:38.680

您是否编辑了字符 µ 或 g？如果您选择字母，您可以看到额外空间属于哪个字母。所以...对于一个小的“g”（第一个字母之后是空格，您必须编辑 $cw 数组的条目“130=>???”。

```
$cw=array(0=>0,1=>750,2=>750,3=>750,4=>750 
```

使其价值减半。如果是 750，则将其设为 400 并尝试。甚至更好：搜索可能与您的“g”相同的字母（例如“a”）。

干杯，

Guido（客户服务是当您查看指向您网站的所有链接时：）

# c# - 如何更改嵌套构造函数的调用顺序（抽象父级之前的子级）

> ID：11508372
> 
> 赞同：1
> 
> 时间：2012-07-16T16:17:56.503
> 
> 标签：c#, polymorphism, abstract

下面的代码抛出异常，因为抽象构造函数在子构造函数之前被调用。

我需要提供一个抽象类来封装来自程序不同部分的一些逻辑。但是，我还需要检查抽象成员是否在创建后正确初始化，而子类对此没有任何影响。

下面的编译示例应该说明我的问题。

```
using System;

namespace Stackoverflow
{
    class Program
    {
        static void Main(string[] args)
        {
            var x = new Thing(5);
            var y = new Child(x);
        }
    }

    class Child : AbstractParent
    {
        Thing childthing;

        public Child(Thing provided) : base(){
            childthing = provided;
        }

        public override void Initialise(){
            //Exception is thrown here - childthing is still null
            parentthing = childthing.Add(1);
        }
    }

    abstract class AbstractParent
    {
        protected Thing parentthing;

        public AbstractParent(){
            Initialise();
            AssertThingyNotNull();
        }

        private void AssertThingyNotNull(){
            if (parentthing == null) throw new Exception("Waaa");
        }

        public abstract void Initialise();

    }

    class Thing
    {
        private int i;

        public Thing(int i){
            this.i = i;
        }

        public Thing Add(int b){
            i += b;
            return new Thing(i);
        }
    }
} 
```

编辑＃1：

有没有办法通过反映调用者（应该是儿童权利的创造者？）然后在调用结束时做出反应来做到这一点？

编辑#2：获取创建孩子的 .ctor 很容易。操纵这些方法似乎介于不可能和坏主意之间。

```
 foreach (StackFrame frame in new StackTrace().GetFrames())
        {
            Console.WriteLine(frame.GetMethod().Name);
        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:19:31.477

你不能，基本上。这就是为什么您应该尽可能避免从构造函数调用虚拟（或抽象）成员的原因——您最终可能会得到在不完整上下文中运行的代码。在调用基类构造函数之前执行任何变量初始值设定项，但构造函数主体中的代码均不执行。

如果您需要执行初始化并且只想在派生类构造函数运行时执行此操作，则只需`Initialise`从派生类构造函数调用即可开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:21:40.710

你可以做一些类似于微软所做的事情`InitializeComponent()`

然后让孩子们尽可能地叫它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:36:42.577

试试这个。

编辑=更清洁的版本。

```
using System;

namespace ConsoleApplication3
{
class Program
{
    static void Main(string[] args)
    {
        var x = new Thing(5);
        var y = new Child(x);
    }
}

class Child : AbstractParent
{
    public Child(Thing provided)
        : base()
    {
        parentthing = provided;
        base.Initialise();
    }
}

abstract class AbstractParent
{
    protected Thing parentthing;

    public AbstractParent()
    {

    }

    private void AssertThingyNotNull()
    {
        if (parentthing == null) throw new Exception("Waaa");
    }

    public void Initialise()
    {
        AssertThingyNotNull();
    }

}

class Thing
{
    private int i;

    public Thing(int i)
    {
        this.i = i;
    }

    public Thing Add(int b)
    {
        i += b;
        return new Thing(i);
    }
} 
```

}

# javascript - 将 24 小时格式转换为 12 小时格式

> ID：11508375
> 
> 赞同：3
> 
> 时间：2012-07-16T16:18:20.663
> 
> 标签：javascript, jquery

这可能真的很容易，但我无法弄清楚。我正在尝试将 24 小时时间转换为 12 小时时间以显示在 UI 上。

```
var hrs = '<%=Model.Scheduled.Value.Hour%>';
var hrs12 = hrs > 12 ? hrs - 12 : hrs;
$("#ScheduledHour").val(hrs12); 
```

但以上不起作用，因为 hrs 是一个字符串。关于如何使它工作的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:20:23.390

你可以使用`parseInt()`：

```
var hrs = '<%=Model.Scheduled.Value.Hour%>';
hrs = parseInt(hrs, 10) // converts the value to an integer
var hrs12 = hrs > 12 ? hrs - 12 : hrs;
$("#ScheduledHour").val(hrs12); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:20:54.313

```
var hrs = '<%=Model.Scheduled.Value.Hour%>'
    thrs = parseInt(hrs, 10);  // As hrs is string, so you need to convert it to
                               // integer using parseInt(str, radix), don't forget to use 
                               // radix parameter

var hrs12 = thrs > 12 ? thrs - 12 : thrs;
$("#ScheduledHour").val(hrs12); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:20:06.330

只需转换`hrs`为数字：

```
hrs = '<%=Model.Scheduled.Value.Hour%>' * 1; 
```

另外，您的问题具有误导性。你真正要问的是“如何在 JavaScript 中将字符串转换为数字？” 在这种情况下，谷歌可能会帮助你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T16:20:35.860

您需要将 hrs 变量转换为数字。有很多方法可以做到这一点，但 parseInt 可能是你最好的选择......

parseInt：[http ://www.w3schools.com/jsref/jsref_parseint.asp](http://www.w3schools.com/jsref/jsref_parseint.asp)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T16:20:48.610

您可以将其转换为 int：

```
var hrsInt = parseInt(hrs); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T16:21:01.713

```
function formatDate(date) {
    var d = new Date(date);
    var hh = d.getHours();
    var m = d.getMinutes();
    var s = d.getSeconds();
    var dd = "AM";
    var h = hh;
    if (h >= 12) {
        h = hh-12;
        dd = "PM";
    }
    if (h == 0) {
        h = 12;
    }
    m = m<10?"0"+m:m;

    s = s<10?"0"+s:s;

    /* if you want 2 digit hours:
    h = h<10?"0"+h:h; */

    var pattern = new RegExp("0?"+hh+":"+m+":"+s);

    var replacement = h+":"+m;
    /* if you want to add seconds
    replacement += ":"+s;  */
    replacement += " "+dd;    

    return date.replace(pattern,replacement);
}

alert(formatDate("February 04, 2011 12:00:00")); 
```

# java - WriteUTF 仅每 2 次有效

> ID：11508379
> 
> 赞同：1
> 
> 时间：2012-07-16T16:18:38.617
> 
> 标签：java

我在使用简单的 Java 服务器、客户端应用程序时遇到了一些问题。基本上，主题说明了一切：当我在服务器端执行 writeUTF 时，它只会在每 2 次执行时发送一次。例如：

服务器：

```
public class Server {

    /**
     * @param args
     */
    public static void main(String[] args) {
        try {
            ServerSocket server     = new ServerSocket(7777);
            Socket client           = server.accept();
            DataOutputStream out    = new DataOutputStream(new BufferedOutputStream(client.getOutputStream()));
            DataInputStream in      = new DataInputStream(new BufferedInputStream(client.getInputStream()));
            while(true) {
                for(int i = 0; i < 100; i++) {
                    out.writeUTF("Test" + i);
                    out.flush();
                }
            }
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

和客户：

```
public class Client {

    /**
     * @param args
     */
    public static void main(String[] args) {
        try {
            Socket client           = new Socket("localhost", 7777);
            DataInputStream in      = new DataInputStream(new BufferedInputStream(client.getInputStream()));
            DataOutputStream out    = new DataOutputStream(new BufferedOutputStream(client.getOutputStream()));

            while(in.readUTF() != null) {
                System.out.println(in.readUTF());
            }
        } catch (UnknownHostException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

} 
```

控制台中的输出如下所示：

测试1 测试3 测试5 测试7 测试9 测试11

是什么导致了这种行为？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:20:22.243

这是因为您正在丢弃客户端上的数据。

当您检查时`while(in.readUTF() != null)`，您每次都从流中读取一个条目以查看它是否为非空。然后你丢弃这个值，并在循环中**读取一个新值。**（除了丢失值之外，这还有一个错误，即当总值为奇数时，while 条件将评估为 true，但下一次调用`readUTF()`将在循环内返回 null。）

要解决此问题，您应该将值读取到变量中，并在使用它之前对其进行测试 - 如下所示：

```
String value;
while((value = in.readUTF()) != null) {
     System.out.println(value);
} 
```

如果您不喜欢将赋值和空值检查作为单个表达式，则可以改为`value = in.readUTF()`在每个循环的初始和结束时赋值，但我个人认为这更容易出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:20:42.297

这个循环

```
 while(in.readUTF() != null) {
            System.out.println(in.readUTF());
        } 
```

丢弃它读取的每一秒字符串。您在测试文件结尾时读取了一个字符串，将其丢弃，然后读取另一个字符串并打印它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:23:43.733

您在此处使用 while 循环评估中的数据：

```
 while(in.readUTF() != null) {
      System.out.println(in.readUTF());
  } 
```

试试这个：

```
 String line;
  while( ((line = in.readUTF()) != null) {
      System.out.println(line);
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-11T06:28:07.390

如果您想要 UTF-8 格式的套接字

只需在 BufferedWriter 和 BufferedReader 的构造函数中添加“UTF-8”

这是样本

```
this.basicReader =   this.Client.getInputStream();
this.basicWriter =   this.Client.getOutputStream();
this.Reader= new BufferedReader(new InputStreamReader(basicReader,"UTF-8"));
this.Writer= new BufferedWriter(new OutputStreamWriter(basicWriter,"UTF-8")); 
```

如何发送数据

```
this.Writer.write("data"+"\r\n");
this.Writer.flush(); 
```

你的主要问题是当你的客户收到一个味精时你的客户没有回应一个味精

```
server to client
client to server
server to client 
```

像这样，试试看。

# html - 元素总是清除向左浮动的短项

> ID：11508383
> 
> 赞同：0
> 
> 时间：2012-07-16T16:19:10.950
> 
> 标签：html, css, css-float

请看这个小提琴：http: [//jsfiddle.net/FnED8/3/](http://jsfiddle.net/FnED8/3/)

`#nav`一旦通过第一行，右侧的项目网格项目总是在左侧元素下方清除，我希望右侧的项目始终保持对齐并且永远不会清除。显然，我可以将高度设置为`#nav`1000px 之类的大值并获得所需的结果，但这不是答案。

从本质上讲，我想`#nav`成为 100% 的高度并`#projects`尊重这一点，永远不要在下面清除，总是留在它旁边。

**编辑**-`#projects`是 90% 的宽度以使网格半流动，这不应该影响这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:23:58.133

使您的项目网格像这样：-

```
#projects-grid {
    float: left;
    width: 300px;

} 
```

[http://jsfiddle.net/FnED8/4/](http://jsfiddle.net/FnED8/4/)

或者你喜欢的任何宽度。马特

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:25:34.853

一种可能的解决方案是`display: inline-block`在`#projects-grid`元素上设置。但是请记住，您需要调整宽度，因为 90% 太宽，无法放在`#nav`.

[更新小提琴](http://jsfiddle.net/FnED8/5/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:30:14.773

这是你想要达到的目标吗？[http://jsfiddle.net/thebabydino/FnED8/7/](http://jsfiddle.net/thebabydino/FnED8/7/)

为网格设置适当的左边距`#projects`并删除其 90% 的宽度即可。

```
#projects-grid {
    margin-left: 174px;
} 
```

# html - Css 3选择器无法正常工作

> ID：11508384
> 
> 赞同：1
> 
> 时间：2012-07-16T16:19:13.703
> 
> 标签：html, css, css-selectors

我正在尝试做一些我认为很简单的任务，但它并不是那么简单......手头的问题可以在这 2 个链接上看到

[http://kurdaktuellt.se/](http://kurdaktuellt.se/)

[http://kurdaktuellt.se/category/aktuellt/](http://kurdaktuellt.se/category/aktuellt/)

我使用的选择器相当简单

```
body:not(.single) #content > .post:nth-child(odd){
}
body:not(.single) #content > .post:nth-child(even){
} 
```

问题是它在首页（第一个链接）上以一种方式工作，在类别页面（第二个链接）上以另一种方式工作，因为它需要计算标题元素，如果它正确地跟随我的选择器，它不应该......我在这里缺少什么吗？

感谢所有帮助... aloot！提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:22:39.280

在您的类别页面中，您有一个`h1`作为 的第一个孩子`#content`，这会干扰您孩子的顺序，导致您的第一个`div.post`不再是第一个孩子，而是实际上是第二个孩子（请参阅[规范](http://www.w3.org/TR/selectors/#nth-child-pseudo)）。

您可以`:nth-of-type()`改用，因此只考虑您`div`的 s （具有 class `.post`）：

```
body:not(.single) #content > div.post:nth-of-type(odd)
body:not(.single) #content > div.post:nth-of-type(even) 
```

或者您可以选择修改您的 HTML，或者通过将其移动到`h1`其他地方，或者通过在您的元素周围添加另一个容器`div.post`，这样您的`:nth-child()`排序就不会被弄乱。

# c# - 无法从 ASP.NET 网页发送邮件

> ID：11508386
> 
> 赞同：4
> 
> 时间：2012-07-16T16:19:21.510
> 
> 标签：c#, asp.net, email

我的网站中有一个联系我们页面，我试图从中发送邮件。这是我的代码 MailMessage feedBack = new MailMessage();

```
feedBack.To.Add("some@some.com");
feedBack.From = new MailAddress("MyClient@some.com");
feedBack.Subject = "Mail from My Client's Website.";  
feedBack.Body = "Sender Name: " + Name.Text + "<br/><br/>Sender Last Name:"+LastName.Text+"<br/><br/>Sender Company:"+Company.Text+"<br/><br/>Sender Designation:"+Designation.Text+"<br/><br/>Sender Email:"+Email.Text+"<br/><br/>Sender Phone No:"+ PhoneNo.Text+"<br/><br/>Sender Enquiry:"+Enquiry.Text;
feedBack.IsBodyHtml = true;
SmtpClient smtp = new SmtpClient();
smtp.Host = "smtp.MyClient.com"; //Or Your SMTP Server Address
//smtp.Port = 25;
//smtp.EnableSsl =false;
smtp.Credentials = new System.Net.NetworkCredential("MyClient@some.com","XXXX");
//Or your Smtp Email ID and Password
 smtp.Send(feedBack); 
```

我一直收到这个错误

> 连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应 64.37.118.141:25

我已经和我的客户核实过，所有的细节都是正确的（`smtp server name,credentials`）。

我也尝试将端口设置为 587 和 465，但它不起作用。

有人可以帮我解决这个问题吗？

可能是什么原因？

我找不到它。欢迎任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:31:51.403

我通过 telnet 用端口 25 测试了上面的 ip，得到了以下响应：

命令：

```
telnet 64.37.118.141 25 
```

回复：

```
Could not open connection to the host, on port 25: Connect failed 
```

很可能端口 25 被阻塞。您将需要找到您的 pop/smtp 服务器使用的端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T22:42:12.840

## 中等信任度

如果您使用的是共享托管服务，*那么很*可能 ASP.Net 已设置为在其中运行`medium-trust`（应该如此）。这将 SMTP 限制为**仅**端口 25 ，您不能使用任何其他端口。

*   [ASP.NET 未以完全信任方式运行时的 SMTP 问题](http://blogs.msdn.com/b/alvar/archive/2010/02/08/smtp-problems-when-asp-net-is-not-running-in-full-trust.aspx)

*   [如此相似的帖子](https://stackoverflow.com/q/10563397/304683)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:21:39.867

您是否检查过 Web 应用程序所在的服务器是否设置为允许通过 SMTP 服务器发送邮件？有时必须设置信任连接以允许将一台服务器中继到另一台服务器。

# android - 使用模拟器从 Android 使用 WS

> ID：11508387
> 
> 赞同：1
> 
> 时间：2012-07-16T16:19:23.493
> 
> 标签：android, web-services, android-emulator, ksoap2

我正在尝试运行一个使用 Web 服务的 Android 应用程序的简单示例。按照网上的一些例子，我终于做到了：

```
private String getValueFromWS()
{
    try
    {
        SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);

        String weight = "3700";
        String fromUnit = "Grams";
        String toUnit = "Kilograms";

        PropertyInfo weightProp =new PropertyInfo();
        weightProp.setName("Weight");
        weightProp.setValue(weight);
        weightProp.setType(double.class);
        request.addProperty(weightProp);

        PropertyInfo fromProp =new PropertyInfo();
        fromProp.setName("FromUnit");
        fromProp.setValue(fromUnit);
        fromProp.setType(String.class);
        request.addProperty(fromProp);

        PropertyInfo toProp =new PropertyInfo();
        toProp.setName("ToUnit");
        toProp.setValue(toUnit);
        toProp.setType(String.class);
        request.addProperty(toProp);

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true;
        envelope.setOutputSoapObject(request);
        HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);

        androidHttpTransport.call(SOAP_ACTION, envelope);
        SoapPrimitive response = (SoapPrimitive)envelope.getResponse();

        return response.toString();
    }
    catch (Exception e)
    {
        return "Error: " + e.getMessage();
    }
} 
```

我还添加了

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

在清单文件中。

我不知道为什么它会抛出异常

```
androidHttpTransport.call(SOAP_ACTION, envelope); 
```

当它与模拟器一起运行时。我使用的是 2.5.8 版本的 kSoap，模拟器运行的是 Android 4.1（16 级）。

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-26T15:38:10.890

抱歉回复晚了，因为您正在主 UI 线程上执行网络调用，所以发生了异常。尝试在 AsyncTask 的 doInBackground() 方法中执行调用以从主线程中卸载调用。另一种解决此问题的方法是更改​​ JellyBean (4.x) 模拟器上可能默认启用的严格模式。您也可以在旧版本的 sdk/emulator (2.3.x) 上尝试您的代码，以使其正常工作。

这解释了错误：

[http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html](http://developer.android.com/reference/android/os/NetworkOnMainThreadException.html)

# ruby-on-rails - 嵌套的弹性搜索

> ID：11508389
> 
> 赞同：0
> 
> 时间：2012-07-16T16:19:30.823
> 
> 标签：ruby-on-rails, elasticsearch, tire

我正在通过轮胎宝石使用弹性搜索。

给定这个结构来索引我的资源模型

```
mapping do
  indexes :_id
  indexes :version,             analyzer: 'snowball', boost: 100 
  indexes :resource_files do
    indexes :_id
    indexes :name,                analyzer: 'snowball', boost: 100
    indexes :resource_file_category do
      indexes :_id
      indexes :name,                analyzer: 'snowball', boost: 100
    end
  end
end 
```

如何检索具有给定 resource_file_category id 的 resource_files 的所有资源？

我查看了弹性搜索文档，我认为可以使用有子过滤器 [http://www.elasticsearch.org/guide/reference/query-dsl/has-child-filter.html](http://www.elasticsearch.org/guide/reference/query-dsl/has-child-filter.html)

我试过这种方式

```
filter :has_child, :type => 'resource_files', :query => {:filter => {:has_child => {:type => 'resource_file_category', :query => {:filter => {:term => {'_id' => params[:resource_file_category_id]}}}}}} 
```

但我不确定是否可以/有效地制作“嵌套的 has_child 过滤器”，或者是否有更好/更简单的方法来做到这一点......欢迎任何建议；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:33:31.053

恐怕我不知道您的映射定义是什么意思。如果您只是发布以下输出，则更容易阅读：

```
curl -XGET 'http://127.0.0.1:9200/YOUR_INDEX/_mapping?pretty=1' 
```

但你可能想要这样的东西：

```
curl -XGET 'http://127.0.0.1:9200/YOUR_INDEX/YOUR_TYPE/_search?pretty=1'  -d '
{
   "query" : {
      "term" : {
         "resource_files.resource_file_catagory._id" : "YOUR VALUE"
      }
   }
}
' 
```

注意：`_id`字段可能应该被映射，`{"index": "not_analyzed"}`以便它们不会被分析，而是存储确切的值。否则，如果您对文档进行`term`查询，`'FOO BAR'`将找不到，因为存储的实际术语是：`['foo','bar']`

注意：该`has_child`查询用于搜索具有匹配特定搜索条件的子文档（即指定父类型和 ID 的文档）的父文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-24T22:53:30.300

点运算符可用于访问嵌套数据。

你可以尝试这样的事情：

```
curl -XGET 'http://loclahost:port/INDEX/TYPE/_search?pretty=1'  -d 
'{
   "query": {
     "match": {
        "resource_files.resource_file_catagory.name": "VALUE"
      }
   }
 }' 
```

如果 resource_file_catagory 是 non_analyzed，则该值不会被标记并存储为单个值，因此可以为您提供完全匹配。

您还可以使用 elasticsearch-head 插件进行数据验证以及查询构建参考。

[https://www.elastic.co/guide/en/elasticsearch/reference/1.4/modules-plugins.html](https://www.elastic.co/guide/en/elasticsearch/reference/1.4/modules-plugins.html)或 [https://mobz.github.io/elasticsearch-head/](https://mobz.github.io/elasticsearch-head/)

# php - 上传文件时以 PHP 表格格式打印 CSV 文件的前 3 列

> ID：11508393
> 
> 赞同：3
> 
> 时间：2012-07-16T16:19:45.450
> 
> 标签：php, file-upload, html-table, import-from-csv

我是 PHP 新手，我遇到了这个问题。

```
$mimes = array('application/vnd.ms-excel','text/plain','text/csv','text/tsv');
if (((in_array($_FILES['uploadedfile']['type'],$mimes)))
    && ($_FILES["uploadedfile"]["size"] > 0))
{
    $filename = $_SESSION['username'].$_FILES["uploadedfile"]["name"];
    move_uploaded_file($_FILES["uploadedfile"]["tmp_name"],"./uploads/".$filename);

    echo "Stored in: " . "./uploads/" .$filename;
    echo "<br />\n";
    echo 'Daylight hours will be calculated for this latitude : '.$_POST['latCSV'];
    echo "<br>";
    //print out uploaded file.csv
    echo "<table BORDER=1>\n\n";
    echo "  <tr><th>AvgCrown</th><th>MinCrown</th><th>MaxCrown</th><th>dateLogged</th><th>DaylightHours</th></tr>";
    echo "<tbody id='tblBdyLoggedData'>";
    $f = fopen("./uploads/" .$filename, "r");
    $i=0;   //just a counter
    while (($line = fgetcsv($f)) !== false) {
        echo "<tr>";
        foreach ($line as $cell) {
            // Save the value before you output
            $lastColValue = htmlspecialchars($cell);
            //unset($lastColValue[3]);
            echo "<td>" . $lastColValue . "</td>";

        }
        //checking if date is valid
        checkDateString($lastColValue);

        // If you want to store all log dates in an array:
        $logDates[] = $lastColValue;                            
        $firstlogDate = $logDates[$i];
        echo "<td>" . checkDateString($lastColValue) . "</td>";
        //call function using firstlogDate for every row
        echo "<td>" . calcDaylight($firstlogDate,$_POST["latCSV"]) . "            </td>";
        echo "</tr>\n";
        $i = $i+1;
    }
    fclose($f);
    echo "</tbody></table></body></html>";
} 
```

**我想在文件上传时只打印 CSV 文件的前 3 列，**因为另外两列将使用各自的函数进行计算。Datelogged 将从 csv 中获取并正确重新格式化，并且还会根据 datelogged 计算日光时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:25:21.283

首先，使用 PHP 文件系统库解析 $file_contents：

$foo = split(',', $file_contents);

**参考**： http: [//php.net/manual/en/book.filesystem.php](http://php.net/manual/en/book.filesystem.php)

现在您可以访问前三列：

```
echo foo[0] . '/' . foo[1] . '/' . foo[2]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:24:38.437

愿此代码对您有所帮助

```
?php
echo "<html><body><table>\n\n";
$f = fopen("so-csv.csv", "r");
while (($line = fgetcsv($f)) !== false) {
        $count=0;
        echo "<tr>";
        foreach ($line as $cell ) 
        {
            if($count<3)
            {    
                echo "<td>" . htmlspecialchars($cell) . "</td>";
                $count++;
            }
        }
        echo "<tr>\n";
}
fclose($f);
echo "\n</table></body></html>"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:25:27.897

替换这个：

```
 foreach ($line as $cell) {
                        // Save the value before you output
                        $lastColValue = htmlspecialchars($cell);
                        //unset($lastColValue[3]);
                        echo "<td>" . $lastColValue . "</td>";

                    } 
```

有了这个：

```
 $lineValues = array_values($line);
                    if (count($line) < 3) {
                        echo "<td>This line is unusable</td><td></td><td></td>";
                    }
                    for ($colNum = 0; $colNum < 3; $colNum++) {
                        echo "<td>" . htmlspecialchars($lineValues[$colNum]) . "</td>";
                    } 
```

# asp.net - 我如何判断遗留的 asp 代码是否使用 webforms、mvc 或网页开发模型？

> ID：11508395
> 
> 赞同：0
> 
> 时间：2012-07-16T16:20:04.607
> 
> 标签：asp.net

我正在学习一些遗留的 asp.net 代码。我[上了 W3 学校开始](http://www.w3schools.com/aspnet/default.asp)学习，了解到有 3 种不同的发展模式。我是 ASP.net 的新手（但对 winforms 有很多经验）。如何判断代码使用的是哪个模型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:43:11.313

解决方案是否有一堆`.aspx`文件？如果是这样，Webforms。

它是否在一个文件夹中有一堆`.cshtml`, `.vbhtml`, or文件，在解决方案中也有一个and文件夹？如果是这样，MVC。`.aspx``views``controllers``models`

项目是否有一堆`.cshtml`或`.vbhtml`分散在多个文件夹（或没有文件夹）的文件？如果是这样，网页。

[这是3之间的比较。](http://www.asp.net/web-pages/overview/getting-started/aspnet-web-pages-%28razor%29-faq#Whats_the_difference_between_ASP.NET_Web_Pages,_ASP.NET_Web_Forms,_and_ASP.NET_MVC)

# r - 检查特定主题是否在另一列中并在 r 中的每一列中重复

> ID：11508397
> 
> 赞同：1
> 
> 时间：2012-07-16T16:20:05.990
> 
> 标签：r, duplicates

这是数据：示例1：完成

```
complete <- c("A", "B", "C","J", "C1", "L", "J2", "D", "M", "N")
lst1 <- c(NA, NA, NA, "A", "N", NA,"A", "C", "D", NA )
lst2 <- c(NA, NA, NA,"A", "L", NA, "C1", "J2", "J2", "B")
datf <- data.frame (complete, lst1, lst2, stringsAsFactors = FALSE) 
```

示例 2：不完整和重复

```
complete <- c("A", "B", "C","J", "C1", "L", "C", "D", "M", "N")
lst1 <- c(NA, NA, NA, "A", "N", NA,"A", "C", "D1", NA )
lst2 <- c(NA, NA, NA,"A", "L", NA, "C1", "J2", "J2", "B2")
datf2 <- data.frame (complete, lst1, lst2, stringsAsFactors = FALSE) 
```

我想检查：（1）lst1 和 lst2 的成员是否至少完整存在一次。如果不存在，则停止消息将显示此“？” 存在于 lst1 或 lst2 中（无论是否正确），但不完整。我的试验：例如1

```
if (datf$lst1 %in%  datf$complete | datf$lst2 %in%  datf$complete) {
     stop ("the subject in lst1 or lst2 must be complete list ")} else {
     cat("I am fine")
     }

I am fineWarning message:
In if (datf$lst1 %in% datf$complete | datf$lst2 %in% datf$complete) { :
  the condition has length > 1 and only the first element will be used 
```

为什么会出现此错误消息，我该如何抑制它？

```
 Example 2:
    if (datf2$lst1 %in%  datf2$complete | datf2$lst2 %in%  datf2$complete) {
         stop ("the subject in lst1 or lst2 must be complete list ")} else {
         cat("I am fine")
         }
   Although there is potential errors the error message is same:
      I am fineWarning message:
    In if (datf2$lst1 %in% datf2$complete | datf2$lst2 %in% datf2$complete) { :
      the condition has length > 1 and only the first element will be used 
```

还有办法提供不匹配的名称作为错误消息的一部分。

(2) 如果完整的任何成员被复制。

**编辑：**

```
Expected answer:
Example1 <-  all members of lst1 and lst2 are also member of complete 

expacted message here is "I am fine"

Example2 <-
B2, J2, is member of lst2 but not complete, D1 is member of lst1 but not complete. 
complete have two C, so C is duplicated. 
The function will stop and print a message 

"B2 and J2 are member of lst1, but not in complete 
 D1  is member of lst2, but not in complete,
 check completeness" 
"C is duplicated in complete" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:34:37.927

```
> datf$lst1 %in% datf$complete | datf$lst2 %in% datf$complete
 [1] FALSE FALSE FALSE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE 
```

来自`?'if'`if 的参数是一个非 NA 的长度为 1 的逻辑向量。

```
> na.omit(datf2$lst1)[!na.omit(datf2$lst1)%in%datf2$complete]
[1] "D1"
> na.omit(datf2$lst2)[!na.omit(datf2$lst2)%in%datf2$complete]
[1] "J2" "J2" "B2"

> datf2$complete[duplicated(datf2$complete)]
[1] "C" 
```

以上内容应该可以帮助您编写一个功能来执行您的建议。

# rally - 是否有 IterationCumulativeFlowData 字段的文档？

> ID：11508402
> 
> 赞同：0
> 
> 时间：2012-07-16T16:20:29.667
> 
> 标签：rally

我可以解释 IterationCumulativeFlowData 字段吗？CardCount, CardEstimateTotal, CardState ...

抱歉，我不是集会/敏捷专家，我只是想知道这些领域是否以任何方式与迭代速度有关（我们在这里考虑的速度是迭代期间接受的 US 的 planEstimate 的总和）。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:25:12.733

学习 Rally Object 模型的最佳方法是使用 WsapiReference 应用程序，该应用程序可在[此处](https://github.com/RallyCommunity/WsapiReference/blob/master/deploy/App.html)找到。如果您正在查看迭代累积流数据对象，这就是它的样子。

![WsapiReferenceApp 截图](../Images/2f077a6751e144644f4d3acf383b929e.png)

将迭代累积流数据对象视为特定日期的特定迭代的快照的最佳方式。您可以找出该迭代中还剩下多少小时的工作并以这种方式进行报告。

如果您想查看特定迭代的速度，您可以使用 HierarchicalRequirement 上的 AcceptedDate（wsapi 称之为用户故事）。如果您查询该迭代中所有故事的列表并将它们按时间框（日、周、月）存储，您可以报告特定迭代的速度。

# java - Are Spring MVC Controllers Singletons?

> ID：11508405
> 
> 赞同：59
> 
> 时间：2012-07-16T16:20:33.320
> 
> 标签：java, spring, spring-mvc

I have a query regarding **Spring 3 MVC** `@Controllers`. When a request comes in, does the container create a new instance of the controller for each request (Similar to an **Action** in Struts 2 - ThreadLocal `ActionContext`) or a single instance responds to all requests? By default are the controller beans singletons in a context?

What are the guidelines/ best practices for a Spring 3 MVC application? Are these settings configurable? Should those be configured? Does it change much if my environment is a clustered environment - I guess it should not as the jvm/containers would be different- but some authoritative suggestion would be welcome.

I have read Spring documentation but probably I missed it. Any 'this is how we implemented kind of' answers/ pointers/ links would be helpful Thanks.

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-07-16T16:22:52.837

Spring controllers are singletons (there is just one instance of each controller per web application) just like servlets. Typically there is no point in changing this behaviour (if it's even possible). See [Regarding thread safety of servlet](https://stackoverflow.com/questions/11485486) for common pitfalls, also applying to controllers.

If your application is clustered do as much as you can to avoid state. State in controllers will require synchronization to avoid threading issues. Also you'll probably replicate that state across servers - very expensive and troublesome.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-03-07T09:20:26.617

By default, Spring beans are singletons. Spring suggests to use singletons for stateless beans like controllers and DAOs, and prototype scope for stateful beans.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-24T16:51:56.587

The Struts2 Actions are not singletons because they carry state. Struts2 leverages javabeans properties on the action itself to carry the incoming request data and expose it to the various layers of the framework.

Spring, on the other hand, uses a model object that is handed to the controller. The controller itself doesn't hold state, so a singleton makes sense.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-03-13T13:56:34.097

Controller are singletons thus can avoid creating a lot of instances by keyword new if the webapp process a lot of requests at the same time.Using controller singleton could also relief the burden of JVM by decreasing young GC.

# java - JAVA：RMI 方法错误：java.lang.NoSuchMethodError

> ID：11508411
> 
> 赞同：2
> 
> 时间：2012-07-16T16:20:44.373
> 
> 标签：java, rmi, nosuchmethoderror

在 RMI 中执行方法 chat 时出现此错误：

```
 ...
    case talk:
    if(param!=null)
    {
       System.out.println("What do you want to say to "+param+"?");
       String msg=br.readLine();
       String room=myPG.getCurrentRoom();
       utils.chat(room,param,msg);
    }
    else
       System.out.println("Wrong usage: e.g. talk Ciccio");
    break;
    ... 
```

RMI方法的实现很简单……但是在进入方法之前就报错了：

```
public void chat(String room,String name,String msg) throws RemoteException
    {
        System.out.println(room+name+msg);
    } 
```

错误是：

```
Exception in thread "main" java.lang.NoSuchMethodError: pgUtils.PGUtilsInterface.chat(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;)V 
```

编辑：远程对象实用程序与我在应用程序中使用的所有其他远程方法都可以正常工作，所以......不知道发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:23:01.267

这只是一个版本控制错误。连接一端使用的`*.class`文件没有该方法；你只需要做一些清理，然后再试一次。

# android - Android：不出现覆盖窗口

> ID：11508415
> 
> 赞同：1
> 
> 时间：2012-07-16T16:20:51.183
> 
> 标签：android, android-layout, overlay, transparent, always-on-top

我尝试创建一个覆盖窗口，它位于我所有其他窗口的顶部，只是显示一些（半透明）信息。这就是我发现但不起作用的东西：

```
 LayoutInflater li = LayoutInflater.from(getBaseContext());
  View hudView = li.inflate(R.layout.hud,null);

  WindowManager.LayoutParams params = new WindowManager.LayoutParams(
          WindowManager.LayoutParams.TYPE_SYSTEM_OVERLAY,
          WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE|WindowManager.LayoutParams.FLAG_NOT_TOUCHABLE|WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED,
          PixelFormat.TRANSLUCENT);
  params.gravity = Gravity.RIGHT | Gravity.TOP;
  params.setTitle("Load Average");
  WindowManager wm = (WindowManager) getSystemService(WINDOW_SERVICE);
  wm.addView(hudView, params);      
  bigCntTextHud=(TextView)hudView.findViewById(R.id.bigCntTextHud); 
```

R.layout.hud 是我想用于该覆盖窗口的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/vertLinLayout"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:gravity="fill_horizontal"
android:orientation="vertical" >

 <TextView
     android:id="@+id/bigCntTextHud"
     android:layout_width="wrap_content"
     android:layout_height="fill_parent"
     android:textSize="105dp"
     android:textStyle="bold" 
     android:layout_gravity="right"
android:layout_marginTop="-30dp"
android:layout_marginBottom="0dp"
android:layout_marginRight="10dp"
     />

 <TextView
     android:id="@+id/bigOpenCntTextHud"
     android:layout_width="wrap_content"
     android:layout_height="fill_parent"
     android:gravity="right"
     android:textSize="56dp"
     android:layout_gravity="right"
     android:textStyle="bold" 
android:layout_marginTop="-42dp"
android:layout_marginBottom="0dp"
android:layout_marginRight="10dp"
      />

</LinearLayout> 
```

不幸的是，只有后退按钮被阻止，当我按下主页按钮时，我看不到我的“桌面”，只有空壁纸和我的 bigCntTextHud（肯定设置为某事）在任何地方都看不到。有什么想法我在这里做错了吗？

# javascript - 模块化 Jquery SPA (MVC)

> ID：11508420
> 
> 赞同：1
> 
> 时间：2012-07-16T16:21:10.177
> 
> 标签：javascript, jquery, model-view-controller, rest

我浏览了网络并在 JQuery 世界中找到了一些很酷的 MVC 实现示例。有些似乎“过时”（或者也许不是......），但看起来很有希望：

*   [CorMVC](http://www.bennadel.com/resources/projects/cormvc/demo/index.htm#/)（2-3 年前）
*   [Adam Wulf 教程](http://welcome.totheinter.net/tutorials/model-view-controller-in-jquery/)（3-4 年前）

最近（我发现）：

*   [Pirek GITHUB](https://github.com/dpirek/jQuery-MVC-Framework)（一年前）
*   [todoMVC](https://github.com/addyosmani/todomvc/tree/master/architecture-examples/jquery)：代码看起来很整洁。但是没有分隔（文件夹）。

**我想知道是否有更完整的用于实现 SPA 网站的 MVC 基础架构/框架示例（以及最近使用最新版本的 JQuery）**。[我正在尝试在twitter bootstrap](http://twitter.github.com/bootstrap/)之上构建它，对于后端，我在 Perl 中使用 rest。

我检查了各种[javascript 框架](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)（请注意，我来自 Ruby on Rails 世界）。我玩过各种：

总重量：

*   优点：我喜欢我只编写 java 代码和各种设计模式的“简单”实现这一事实。
*   缺点：调试时间（运行应用程序太慢）。

道场：

*   优点：自定义小部件、模块化（OOP 概念）
*   缺点：复杂、糟糕的社区、糟糕的文档、糟糕的示例。我已经阅读了所有文档，但是当我把它放在一起时，我感到非常困惑和迷失。

现在，我真的被 Jquery/ [JavascriptMVC](http://javascriptmvc.com/)诱惑了。以我的背景（RoR/MVC/Java），我认为这是一个相当不错/整洁的框架，还是有更好的框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:36:56.860

我建议使用 Backbone（还没有遇到不喜欢骨干的 JS 开发人员）+ Handlebars 模板（handlebars 比 mustache 好得多）。它不是真正的 MVC，但它非常轻量级和灵活。如果您需要更多功能，那么在主干之上有真正的 MVC 层（现在找不到它们，它们的名字很愚蠢），它们也相当小。所有这些东西加起来可能仍然是 JavascriptMVC 大小的一半。

GWT 是 meh（没有遇到很多喜欢它的人，遇到过很多不喜欢它的人，再加上它是 Java），Dojo 是 feh（非常大的代码库，小社区）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:50:19.147

我结合了 jquery、jsviews (http://www.borismoore.com/2011/10/jquery-templates-and-jsviews-roadmap.html) 和 RequireJS 构建了一些东西。最后，RequireJS 是一个学习曲线，但一旦我习惯了它，我发现它是一个非常强大的机制。我不确定 jsviews 的当前状态，所以如果我不得不再做一次，我可能会使用把手。当我看到它时，我真的不喜欢我正在做的事情的主干，如果我一直在研究更多的数据驱动器（而不是主要的视觉）应用程序，那么我可能会使用它。

# c - Linux C：收到信号后，是否可以知道发送者的PID？

> ID：11508427
> 
> 赞同：19
> 
> 时间：2012-07-16T16:21:50.897
> 
> 标签：c, linux, signals, system, ipc

假设我的 C 程序处理`SIGUSR1`.

当它接收到这个信号时，是否有可能知道是谁发出的？即，如何获取发送者进程的pid？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-07-16T16:47:44.683

是的，如果您使用[`sigaction()`](https://pubs.opengroup.org/onlinepubs/9699919799/functions/sigaction.html)调用来设置信号处理程序而不是`signal`. 这样做可以让您设置一个接受三个参数的信号处理程序：

*   An `int`, 用于信号编号（就像`signal`）
*   A `siginfo_t *`，它是一个包含有关信号源的各种信息的结构，包括发送者的 pid（如果适用）。（它还包括一些有关自动信号的信号原因的信息，例如`SIGSEGV`。）
*   A `ucontext_t *`，这与哪个线程得到信号有关。大多可以忽略。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-07-16T16:48:39.580

是的。`sigaction`使用标志注册您的信号处理程序`SA_SIGINFO`，并填写该`sa_sigaction`字段。现在您的处理函数接受一个`siginfo_t*`参数，其中包括一个字段`si_pid`。

请注意，`si_pid`仅在某些情况下设置。在您的情况下，您需要检查`si_code`设置为`SI_USER`or的检查`SI_QUEUE`。阅读`man 2 sigaction`更多。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-03-28T12:54:35.917

另一种选择是使用[`signalfd()`](http://man7.org/linux/man-pages/man2/signalfd.2.html). 如果您使用信号在进程之间发送信息，那么比信号处理程序更结构化的信号处理很可能是您想要的。`struct signalfd_siginfo::ssi_pid`是发件人。

手册页中的示例：

```
#include <sys/signalfd.h>
#include <signal.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>

#define handle_error(msg) \
    do { perror(msg); exit(EXIT_FAILURE); } while (0)

int main(int argc, char *argv[]) {
    sigset_t mask;
    int sfd;
    struct signalfd_siginfo fdsi;
    ssize_t s;

    sigemptyset(&mask);
    sigaddset(&mask, SIGINT);
    sigaddset(&mask, SIGQUIT);

    /* Block signals so that they aren't handled
       according to their default dispositions */

    if (sigprocmask(SIG_BLOCK, &mask, NULL) == -1)
        handle_error("sigprocmask");

    sfd = signalfd(-1, &mask, 0);
    if (sfd == -1)
        handle_error("signalfd");

    for (;;) {
        s = read(sfd, &fdsi, sizeof(struct signalfd_siginfo));
        if (s != sizeof(struct signalfd_siginfo))
            handle_error("read");

        if (fdsi.ssi_signo == SIGINT) {
            printf("Got SIGINT\n");
        } else if (fdsi.ssi_signo == SIGQUIT) {
            printf("Got SIGQUIT\n");
            exit(EXIT_SUCCESS);
        } else {
            printf("Read unexpected signal\n");
        }
    }
} 
```

**另见：** [`sigqueue()`](http://man7.org/linux/man-pages/man2/sigqueue.2.html)。像[`kill()`](http://man7.org/linux/man-pages/man2/kill.2.html)，但您可以在同一个调用中传递一个整数或指针。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-05-03T08:36:00.620

这是 POSIX 标准`sigaction()`API 的完整示例：

```
#include <errno.h>
#include <signal.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

void sigusr1(int signo, siginfo_t *si, void *data) {
  (void)signo;
  (void)data;
  printf("Signal %d from pid %lu\n", (int)si->si_signo,
         (unsigned long)si->si_pid);
  exit(0);
}

int main(void) {
  struct sigaction sa;
  memset(&sa, 0, sizeof(sa));
  sa.sa_flags = SA_SIGINFO;
  sa.sa_sigaction = sigusr1;
  if (sigaction(SIGUSR1, &sa, 0) == -1) {
    fprintf(stderr, "%s: %s\n", "sigaction", strerror(errno));
  }
  printf("Pid %lu waiting for SIGUSR1\n", (unsigned long)getpid());
  for (;;) {
    sleep(10);
  }
  return 0;
} 
```

尝试运行它，然后发送 SIGUSR1（例如`kill -SIGUSR1 that-pid`从 shell）

`sigaction`功能： http: [//pubs.opengroup.org/onlinepubs/009604499/functions/sigaction.html](http://pubs.opengroup.org/onlinepubs/009604499/functions/sigaction.html)

`siginfo`结构： http: [//pubs.opengroup.org/onlinepubs/009604499/basedefs/signal.h.html](http://pubs.opengroup.org/onlinepubs/009604499/basedefs/signal.h.html)

# firefox - Selenium WebDriver - Firefox - 无法在 45000 毫秒内绑定到锁定端口

> ID：11508429
> 
> 赞同：1
> 
> 时间：2012-07-16T16:22:04.380
> 
> 标签：firefox, selenium, webdriver

我正在尝试使用 Firefox 运行 Selenium 测试。我正在使用 C#。

```
new OpenQA.Selenium.Firefox.FirefoxDriver(); 
```

我还尝试了一个配置文件集：

```
FirefoxProfile profile = new FirefoxProfile(@"E:\...\FirefoxProfile"); 
new OpenQA.Selenium.Firefox.FirefoxDriver(); 
```

我得到的错误：

**无法在 45000 毫秒内绑定到锁定端口 7054**

我什至尝试卸载 Firefox，包括配置文件并重新安装。没有帮助。

* * *

仅供参考：我有一个关于 3 selenium webdrivers 的问题。我试图将问题分成多个，以便讨论更容易。原文： [Selenium WebDriver - 没有驱动程序为我工作](https://stackoverflow.com/questions/11456416/selenium-webdriver-no-driver-is-working-for-me)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T10:26:21.770

关于调试的一些提示：

我发现测试问题是否存在的最快方法是浏览

```
http://localhost:4444/wd/hub/static/resource/hub.html 
```

然后尝试在那里创建一个 Firefox 会话。

我遇到了 FF 18.0 和 Selenium server 2.28.0（撰写本文时的最新版本）的问题。我确保 Windows 防火墙没有阻止 Selenium 服务器，然后重新启动了机器——这成功了。所以我认为罗斯拉森是对的。

# c# - 加载从 ASP.NET MVC 中的路由参数获取其名称的局部视图是否安全？

> ID：11508434
> 
> 赞同：0
> 
> 时间：2012-07-16T16:22:43.693
> 
> 标签：c#, asp.net-mvc

我想知道加载从路由参数中获取名称的局部视图是否安全？

例如使用以下 URL

mydomain.com/home/services/sales

我希望视图加载名为的局部视图`selling`

这是视图中的代码：

```
string SubPage = ViewBag.SubPage;
@Html.Partial("~/Views/Pages/Services/"+SubPage) 
```

这是安全的还是我应该添加某种消毒？

**附加信息**

我不担心用户是否访问服务下的视图，因为所有这些视图都可以通过站点导航访问。

如果可以设置子页面以便它从文件夹外部加载视图，我更感兴趣`~/Views/Pages/Services/`，就像帐户文件夹中的视图一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:26:05.217

如果某人的行为可以修改`SubPage`以显示其下方的页面，`~/Views/Pages/Services/`则会导致他们获得对不应被允许的路线的访问权，这将是有害的。

如果您使用通用访问控制模型来验证是否允许用户执行给定的控制器操作，而无需额外检查`SubPage`是否允许他们执行，则可能会发生这种情况。

# jquery - 如何更改自定义 JQuery 脚本中加载的图像的来源？

> ID：11508437
> 
> 赞同：0
> 
> 时间：2012-07-16T16:22:52.970
> 
> 标签：jquery, image, slider

我正在尝试修改一个 JQuery Slider 以根据用户将大图像替换为另一个：如果他将鼠标悬停在一个小图像上，它将以更大的格式加载。

所以在脚本的某个时刻，我有加载图像过程：

```
// call this function after it's loaded
        img.onload = function() {

            // make wrapper fully visible
            wrap.fadeTo("fast", 1);

            // change the image
            wrap.find("img").attr("src", url);

        };

        // begin loading the image from www.flickr.com
        img.src = url; 
```

但是我在这里尝试做的是更改原始 src，通过向 src url 添加一些字符，以便当用户将鼠标悬停在图像上时，另一个会加载到滑块中（当然与小的有关） .

例如，如果我在小框中有 product1.jpg，并且用户将鼠标悬停在它上面，我想在滑块中加载 product1Big.jpg。

这是完整的脚本：

```
 $(function() {
        $(".scrollable").scrollable();

        $(".items img").hover(function() {
            // see if same thumb is being clicked
            if ($(this).hasClass("active")) { return; }

            // calclulate large image's URL based on the thumbnail URL (flickr specific)
            var url = $(this).attr("src").replace("_t", "");

            // get handle to element that wraps the image and make it semi-transparent
            var wrap = $("#image_wrap").fadeTo("medium", 0.5);

            // the large image from www.flickr.com
            var img = new Image();

            // call this function after it's loaded
            img.onload = function() {

                // make wrapper fully visible
                wrap.fadeTo("fast", 1);

                // change the image
                wrap.find("img").attr("src", url);

            };

            // begin loading the image from www.flickr.com
            img.src = url;

            // activate item
            $(".items img").removeClass("active");
            $(this).addClass("active");

        // when page loads simulate a "click" on the first image
        }).filter(":first").click();
    }); 
```

# visual-studio-2010 - opencv 特征检测器崩溃并出现未处理的异常错误

> ID：11508440
> 
> 赞同：2
> 
> 时间：2012-07-16T16:23:03.320
> 
> 标签：visual-studio-2010, opencv, feature-detection

在 Visual Studio 2010 中的简单程序中使用特征检测器失败。我使用的是 opencv 2.4.2 并在 2.4.1 上进行了检查。唯一要做的就是创建一个特征检测器并使用它来检测图像中的关键点。我在detectors.cpp（即features2d\detectors.cpp line:65）中遇到指向名为“detecImpl()”的函数的未处理异常崩溃。这个错误确实卡住了，并且花费了大量时间，因此非常感谢任何帮助。

```
#include <iostream>
#include <opencv2/core/core.hpp>
#include "opencv2/highgui/highgui.hpp" 
#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/features2d/features2d.hpp>

using namespace std; 
using namespace cv; 

int main(int argc, char* argv[]) 
{ 
cv::Ptr<cv::FeatureDetector> featureDetector; 
cv::Ptr<cv::DescriptorExtractor> descriptorExtractor; 
featureDetector = cv::FeatureDetector::create("SURF"); 
descriptorExtractor = cv::DescriptorExtractor::create("SURF"); 
cv::Mat imageColor; 
cv::Mat image = cv::imread("car1.jpg", 0); 
    cv::cvtColor(image, imageColor, CV_GRAY2BGR); 
try{ 
imshow("Test Image",imageColor); 
cv::waitKey(3000); 
} 
catch(cv::Exception exc) 
{ 
cout << "CV error occured : " + exc.msg; 
} 
std::vector<cv::KeyPoint> currentKeypoints; 

try{ 
    featureDetector->detect(image,currentKeypoints);   //This line generates the error but no exception is caught .... 
    } 
catch(cv::Exception exc) 
{ 
cout << "CV error occured : " + exc.msg; 
return -1; 
} 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-21T17:23:56.660

我已经想通了。在新版本的 opencv 中，SURF/SIFT 分布在一个单独的库中，需要在创建特征检测器之前对其进行初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-24T10:07:59.073

我在 VS2010 上使用 OpenCV 2.4.2 也发生了同样的事情。

我发现以下方法有效：FAST、STAR、ORB、BRISK、GFFT 和 Harris。

SIFT、SURF 将在包含非自由功能并启动它们后工作。

而 Dense & SimpleBob 崩溃了。

相对于其他结果而言，结果最好的是 FAST（在性能 + 准确性方面）

# asp.net-mvc - 输出缓存没有效果

> ID：11508442
> 
> 赞同：2
> 
> 时间：2012-07-16T16:23:13.750
> 
> 标签：asp.net-mvc, asp.net-mvc-3, mobile, outputcache, 51degrees

我回到了 MVC 应用程序，我认为输出缓存按预期工作。但是，在重新访问它时，我发现我使用的 OutputCache 属性没有效果（Duration 设置为高值）。无论我是否添加它，我的操作中的断点总是被命中，并且 Firebug 在每种情况下都会在请求的页面上向我显示 200 OK。

在我使用 VaryByCustom 的更复杂的操作中，从不调用 global.asax 中的 GetVaryByCustomString 方法。我知道它在过去被调用，因为我能够在那里进行调试，但现在不是。

我想知道我做了什么来打破这个......有什么想法吗？

（为了不仅测试 localhost，我使用了 dyndns.org 地址，使其成为有效的外部 URL。我也使用 IIS）。

**更新**：当我使用 localhost URL 时，定位相同的 url 不会再次输入操作代码。按F5可以。使用互联网 URL 时，它总是访问操作代码。

**更新 2**：Fiddler 在响应标头中显示了这一点：

```
200 OK

Cache:
Cache-Control: public, no-cache="Set-Cookie", max-age=86400
Date: Mon, 16 Jul 2012 19:38:46 GMT
Expires: Tue, 17 Jul 2012 19:38:46 GMT
Vary: * 
```

每次我请求相同的 url 时，Expires = Date + 24h，这表明每次都提供一个新页面。我也应该第一次得到 200，之后得到 304。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T20:53:29.377

刚刚发现了罪魁祸首，这与我的应用程序有关：

如果我从我的应用程序中删除 51degrees.mobi nuget 包，它就会再次工作。把它放回去（即使不使用它的功能），缓存就死了。嗯，其实有2种情况：

*   如果您只是添加包，**则永远不会调用 GetVaryByCustomString**。action 方法被正确调用一次，然后从缓存中提供。
*   如果添加包并且还使用 CompressFilter 属性，则**永远不会调用 GetVaryByCustomString 并且始终调用操作方法（缓存中没有提供页面）**。

我在他们的论坛上发帖报告这个问题。

***更新***：这些问题从 51degrees 版本 2.1.4.9 开始出现。我注意到这是第一个使用 Microsoft.Web.Infrastructure 的版本，以防万一……

***更新 2***：他们找到了此问题的原因，并将予以修复。

# eclipse - eclipse中hadoop公共项目的属性未定义错误

> ID：11508443
> 
> 赞同：1
> 
> 时间：2012-07-16T16:23:16.243
> 
> 标签：eclipse, hadoop

[我刚刚根据http://wiki.apache.org/hadoop/EclipseEnvironment](http://wiki.apache.org/hadoop/EclipseEnvironment)中给出的信息将 hadoop 项目导入到 eclipse 中，eclipse 在 hadoop-common 项目中显示了一些错误，所有错误都在同一个文件中，即 /hadoop -common/target/generated-sources/java/org/apache/hadoop/package-info.java

这是eclipse错误消息之一：

```
The attribute branch is undefined for the annotation type HadoopVersionAnnotation 
```

所有其他错误实际上是相同的。例如，另一个错误显示“属性日期”而不是“属性分支”。

最后我想给出 package-info.java 文件的源代码：

```
/*
 * Generated by src/saveVersion.sh
 */
@HadoopVersionAnnotation(version="3.0.0-SNAPSHOT", revision="930c89b105e19f1f4db755c0071378c507386824", branch="trunk",
                         user="byildiz", date="Mon Jul 16 18:56:16 EEST 2012", url="git://kaptan/home/byildiz/Desktop/hadoop-common/hadoop-common-project/hadoop-common",
                         srcChecksum="e54b3f6cb07ea1cd833d1ab0b947ac39")
package org.apache.hadoop; 
```

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T19:55:35.110

我认为这一定是一个 Eclipse 错误。我更改了 HadoopVersionAnnotation.java 中的一个字母（特别是 version -> versionx (save) -> version (save)）以触发重新编译，所有编译错误都消失了。

# c# - 如何将 HTML 插入 C# 程序？

> ID：11508444
> 
> 赞同：0
> 
> 时间：2012-07-16T16:23:25.893
> 
> 标签：c#, html

我在这里需要帮助。我正在尝试创建一个程序，允许用户从我工作的站点收听广播，而无需实际访问该站点。我已经创建了需要它显示的页面，但是我无法让它在表单应用程序中显示。这是它需要显示的页面：

如果有人可以帮助我，那就太好了。提前谢谢，尽管我可能会再说一遍。 [http://pastebin.com/0cSLMHht](http://pastebin.com/0cSLMHht)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:26:19.643

请为此使用 Windows WebBrowser 控件

请参阅此处的链接[http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)

示例在这里[http://msdn.microsoft.com/en-us/library/2te2y1x6](http://msdn.microsoft.com/en-us/library/2te2y1x6)

# git - 如何忽略 git 中现有的已提交文件？

> ID：11508445
> 
> 赞同：6
> 
> 时间：2012-07-16T16:23:28.540
> 
> 标签：git, github, gitignore, smartgit

> **可能重复：**
> [GIT：忽略版本控制文件](https://stackoverflow.com/questions/4633681/git-ignoring-version-controlled-files)

Stackoverflow上有很多答案`.gitignore`，但我还没有找到答案：

我有一个现有的 git 项目，其中 a`readme.md`和 a`sample_folder/`都在顶层。我确实想从我的 git(hub) 存储库中删除这些。但我想忽略它们，也就是说，在某个克隆的本地存储库中，即在部署机器上，完全阻止它们被拉取。

`.gitignore`我明白了，只是忽略*未提交的*文件？坦率地说，我没有发现任何隐藏（从拉+提交）已经提交*的*东西......

在 Perforce 时代，我会简单地将其从各自的“客户端规范”（非常接近本地克隆的仓库）中排除：

```
//whatever/myProject
-//whatever/myProject/readme.md
-//whatever/myProject/sample_folder 
```

当然，我可以选择第二个分支，我只需删除自述文件和整个示例文件夹。但是，我将不得不继续合并“开发”中的每一个微小修复。这是什么，我宁愿避免......我宁愿更喜欢本地“异常”而不是（跟踪）分支。

另外，我认为`git rm --cached`每当我提交时（这也可能不时发生在我的“部署回购”中）......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:32:34.343

也许我的问题错了，但是以下内容不能解决您的问题吗？

```
git rm --cached readme.md sample_folder/*
echo "readme.md" >>.gitignore
echo "sample_folder/*" >>.gitignore
git commit -am "Untracked some files" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T18:20:10.773

听起来您可能正在使用 git checkout 作为部署方法。有时这行得通，有时它需要更多。如果存储库中有开发工件，则需要更多。

最明显的处理方法是使用部署脚本执行拉取操作，然后删除多余的目录和文件。不幸的是，这会给您留下一个可能会使人们感到困惑的部分存储库，并且它添加了一个必须记住使用并保持最新的特殊脚本。

处理它的另一种方法是拥有一个部署分支。创建一个分支，删除有问题的文件和目录，然后从该分支中​​提取。是的，您必须将开发分支中的更改合并到部署中。你认为这是一件苦差事，但它是一种保障。如果您在开发过程中快速创造机会并快速部署它们，那么您的部署周期可能会出现问题。

您希望在开发和部署之间有一个步骤，您可以在其中考虑和测试您的更改。如果不出意外，这可以防止开发人员 A 推动错误的更改，而管理员 B 通过在不知不觉中将其投入生产来加剧错误。您还希望能够推动开发并与其他开发人员共享您的工作，而不会冒险将其投入生产。

您现在可能是一个处理开发和部署的人，但以后可能不会。如果不出意外，这可以保护您自己不会意外地将不稳定的更改推向开发，然后在您有机会思考之前将其拉入部署，从而加剧该错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:08:54.440

这不是关于 .gitignore 的问题。如果这些*不是*代码，您应该通过子模块在单独的 repo 中跟踪它，并且不要`git submodule`在服务器上运行任何 commandsh。或者只是在结帐后在部署机器上编写删除这些脚本。

# asp.net - ImageButton 比 Button 有什么优势吗？

> ID：11508448
> 
> 赞同：0
> 
> 时间：2012-07-16T16:23:34.683
> 
> 标签：asp.net

既然 a`Button`可以有背景图片和文字，那么 a 有什么意义`ImageButton`呢？

（我正在考虑将`ImageButton`s 更改为 simple `Button`s，并想知道这样做是否有任何缺点。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:27:49.573

简单的说：

*   `Button`呈现为`<input type="submit" />`

*   `ImageButton`呈现为`<input type="image" />`

这里提到了两者在可访问性方面的区别：

[http://www.10sharpdesign.com/accessibility/forms/6-button-submit.html](http://www.10sharpdesign.com/accessibility/forms/6-button-submit.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:37:54.423

我找到了一个 -`ImageButton`我可以将 url 称为**~/** myImage.jpg。我不能用普通的`Button`.

这在使用母版页时很重要 - 因为如果它们位于不同的目录中，不同页面的 url 的相对路径可能会有所不同。

# javascript - Bootstrap - 使用 jquery 切换图标

> ID：11508449
> 
> 赞同：6
> 
> 时间：2012-07-16T16:23:39.383
> 
> 标签：javascript, jquery, twitter-bootstrap

我在尝试切换 Bootstrap 图标时遇到了一点问题。当我运行代码时，它会在您第一次单击它切换的图标时执行预期的操作，但是当我再次单击时它不会改变。这是我的代码，任何帮助将不胜感激！

```
<a><i class="icon-plus"></i></a>

<script>
  $(".icon-minus").click(function(){
    $(this).removeClass("icon-minus").addClass("icon-plus");
  });
  $(".icon-plus").click(function(){
    $(this).removeClass("icon-plus").addClass("icon-minus");
  });
</script> 
```

**更新1：**

此图标用于可折叠菜单，其代码可在[此处](http://twitter.github.com/bootstrap/javascript.html#collapse)找到:)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-16T16:26:18.657

## *[jsBin 演示](http://jsbin.com/ujonij/edit#javascript,html,live)*

```
$(".icon-minus, .icon-plus").click(function(){
    $(this).toggleClass("icon-minus icon-plus");
}); 
```

**或者，如果您动态创建元素：**

```
$("#parent_el_NOT_dyn_gen").on('click','.icon-minus, .icon-plus',function(){
    $(this).toggleClass("icon-minus icon-plus");
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:26:09.817

jQuery 的选择器选择 DOM 元素，然后将点击处理程序应用于它们。更改元素上的类后，它不会重新评估选择器。

您可能希望 jQuery 中的[`delegate()`](http://api.jquery.com/delegate/)/[`on()`](http://api.jquery.com/on/)方法动态更改单击项目时触发的处理程序。委托与事件冒泡一起工作，并将处理点击并评估点击源是否与选择器匹配（在点击时），而不是`.click()`直接附加处理程序一次（在页面加载时或任何时候）代码已运行）。

另一种解决方案是以某种方式更改处理程序，要么通过评估现有元素上的类，要么使用`toggleClass()`将检查类然后反转它的类。

```
$(".icon-minus, .icon-plus").click(function() {
   var $this = $(this);
   if ($this.hasClass("icon-plus")) {
      $this.removeClass("icon-plus").addClass("icon-minus");
      return;
   }
   if ($this.hasClass("icon-minus")) {
      $this.removeClass("icon-minus").addClass("icon-plus");
      return;
   }
}); 
```

此方法将比使用`on()`/稍微快一些，`delegate()`因为它是在根处理程序中处理的，之后不会冒泡和检查。它也不易受到事件冒泡中的任何中断的影响。（即。`event.stopPropagation()`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-22T19:01:59.913

简单的解决方案适用于 Bootstrap 3。

```
$('[data-toggle="collapse"]').click(function(e) {
    $(e.target).find('.icon-minus-sign, .icon-plus-sign').toggleClass("icon-minus-sign icon-plus-sign");
}); 
```

# php - Android：如何向/从 PHP 网站发出安全请求并获得响应？

> ID：11508453
> 
> 赞同：0
> 
> 时间：2012-07-16T16:23:47.673
> 
> 标签：php, android, service, web

我正在为一家用户正在寻找房屋出租的企业工作。这些可以通过我们的网站查看。

我正在寻找创建一个 Android 应用程序来帮助人们在智能手机上找到房子。如何让移动应用程序从网络服务器（PHP/MySQL *）获取数据并向其发出请求？

这不是 Web 服务的定义吗？那么PHP和Android平台版本8（2.2 Froyo）支持什么样的webservice呢？

有一个重要要求：它应该是安全的，需要应用程序进行身份验证，即只有应用程序才能访问数据。

* 支持 Python 2.6.6。我真的很喜欢 Python，但我不喜欢混合服务器语言，因为网站 100% 是用 PHP 编写的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:57:22.633

> 如何让移动应用程序从网络服务器（PHP/MySQL *）获取数据并向其发出请求？

在 Android 上，您可以使用旧版本的[Apache HTTP 客户端](http://developer.android.com/reference/org/apache/http/package-summary.html)。因此，从您的应用程序向您的服务器发出 HTTP 请求的那一侧被覆盖：

```
HttpClient client = new DefaultHttpClient();
HttpGet request = new HttpGet("https://www.myserver.com/webservice/xyz");
HttpResponse response = client.execute(request); 
```

只需 3 行代码，您就有了一个 GET 请求。

> 那么PHP和Android平台版本8（2.2 Froyo）支持什么样的webservice呢？

有[多种不同的 Web 服务库](http://php.net/manual/en/refs.webservice.php)可用于 PHP，例如 SOAP 和其他基于 XML 的协议。我个人不会这样做，因为 XML 很臃肿。您希望保持服务器和客户端之间传输的数据较小，因为您正在处理移动设备、有限的带宽和昂贵的数据计划。JSON 是 XML 的更紧凑的替代方案。您还可以创建自己的“二进制”数据格式，用于在服务器和客户端之间交换数据。

在 Android 端，您只需要为您选择的 Web 服务寻找合适的 Java 客户端库。或者，如果您寻求自定义解决方案，您只需自己编写代码。

> 有一个重要要求：它应该是安全的，

使用 HTTPS

> 通过要求应用程序进行身份验证，即只有应用程序能够访问数据。

除非您正在处理用户登录，否则这无法可靠地执行，那么可以。如果您确实需要您的用户登录，请查看 OAuth。

不要在您的客户端应用程序或服务器上存储纯文本密码。

如果您只想强制只有您的应用程序可以访问该 Web 服务，那么您可以在应用程序的 HTTP 请求标头中添加类似“客户端密码”字符串的内容。您的服务器将要求该秘密字符串存在，否则访问将被拒绝。

不过，这不会阻止人们查看您的应用程序以找出这个秘密。你可以通过混淆那个秘密字符串来让它变得更难一些，比如在字母周围随机混杂等等。

您还可以在每次重大更新时定期更改客户端密码。这将要求您的用户*必须*更新，否则他们将被锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:30:44.570

[您可能需要考虑实现一个函数来在您的 Android 应用程序（如json-simple](http://code.google.com/p/json-simple/) ）中向 PHP 服务器查询 JSON 数据，并在您的服务器中实现一种检索 GET 请求的方法（查看 interperting $ _GET然后发送回[JSON](http://php.net/manual/en/book.json.php)）。

您也可以使用 XML、纯文本或其他任何内容，但 JSON 可能是最小且实现最快的。

# java - 使用@WebServiceRef 进行依赖注入我做错了。但是怎么做？

> ID：11508454
> 
> 赞同：1
> 
> 时间：2012-07-16T16:23:51.153
> 
> 标签：java, web-services, jakarta-ee, dependency-injection, apache-tomee

我在尝试注入与我的 JVM 完全分离的 Web 服务时遇到异常。

我的环境是 TomEE v1.0.0，它是一个 JEE6 webprofile 容器。

ThemeQueryService 是一个带有 JAXWS 注释的接口。

```
@SessionScoped 
@Named("managedBeanMB") 
public class ManagedBeanMB implements Serializable { 
        private static final long serialVersionUID = 1L; 

        @WebServiceRef(
            wsdlLocation = "http://localhost:8777/services/queryService?wsdl") 
        private QueryService queryService; 
.... 
} 
```

后来，在尝试使用注入服务时，我得到了一个 NPE：

```
Caused by: java.lang.NullPointerException 
        at org.apache.openejb.core.ivm.naming.JaxWsServiceReference.getObject(JaxWsServiceReference.java:73) 
        at org.apache.openejb.core.ivm.naming.IvmContext.lookup(IvmContext.java:173) 
        at org.apache.openejb.cdi.CdiResourceInjectionService.lookup(CdiResourceInjectionService.java:134) 
        at org.apache.openejb.cdi.CdiResourceInjectionService.fillInjectionProperties(CdiResourceInjectionService.java:112) 
        at org.apache.openejb.cdi.CdiResourceInjectionService.injectJavaEEResources(CdiResourceInjectionService.java:96) 
        at org.apache.webbeans.component.AbstractInjectionTargetBean.injectResources(AbstractInjectionTargetBean.java:432) 
        at org.apache.webbeans.portable.creation.InjectionTargetProducer.inject(InjectionTargetProducer.java:91) 
        at org.apache.webbeans.component.InjectionTargetWrapper.inject(InjectionTargetWrapper.java:79) 
        at org.apache.webbeans.component.AbstractOwbBean.create(AbstractOwbBean.java:182) 
```

我觉得我不理解 WebServiceRef... 它仅用于 JNDI 传输吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T15:02:18.910

您必须使用 TomEE+，而不是 TomEE（webprofile）。

见这里： http: [//openejb.979440.n4.nabble.com/JEE-Dependency-Injection-failure-on-WebServiceRef-results-in-bizzare-NullPointerException-td4656360.html#a4656377](http://openejb.979440.n4.nabble.com/JEE-Dependency-Injection-failure-on-WebServiceRef-results-in-bizzare-NullPointerException-td4656360.html#a4656377)

# c++ - C++/OpenCV 中视频的 AVI 大小（以千字节为单位）

> ID：11508459
> 
> 赞同：0
> 
> 时间：2012-07-16T16:23:59.880
> 
> 标签：c++, opencv

有没有办法知道 OpenCV 中 avi 视频的大小？有些视频是空白的，我不想处理它们，而是想通过将它们的大小与阈值进行比较来摆脱它们。例如，如果视频的大小为 200 kB 或更小，那么我会跳过处理该视频。

更新：

```
 CvCapture *capture = cvCreateFileCapture(path);
     IplImage *img = cvQueryFrame( capture ); 
```

所有视频的帧数都相同，但有些视频全是空白帧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:37:15.847

您可以通过使用[GetCaptureProperty](http://opencv.itseez.com/modules/highgui/doc/reading_and_writing_images_and_video.html#cv.GetCaptureProperty)`CV_CAP_PROP_FRAME_COUNT`获取视频属性来获取帧数：

> CV_CAP_PROP_FRAME_COUNT 视频文件中的帧数。

要获取文件（视频）的大小，还有另一个 API - 取决于您的系统（WinAPI、POSIX 等）。例如在 Windows 上它的`GetFileSizeEx()`功能。

另请查看此[SO 讨论](https://stackoverflow.com/questions/238603/how-can-i-get-a-files-size-in-c)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:41:39.057

如果您想获得实际的文件大小，您将不得不使用`fopen()`或`stat`因为 OpenCV 不会将此信息存储在`cvCapture`对象中。但是，您可以像这样检测空白视频：

```
CvCapture *capture = cvCaptureFromAVI( argv[1] );
int numFrames = (int) cvGetCaptureProperty(&capture, CV_CAP_PROP_FRAME_COUNT); 
```

然后只需根据帧数确定它是否为空白。

相关文档：

[http://opencv.willowgarage.com/documentation/reading_and_writing_images_and_video.html?highlight=cvcapture#getcaptureproperty](http://opencv.willowgarage.com/documentation/reading_and_writing_images_and_video.html?highlight=cvcapture#getcaptureproperty)

如果空白视频的文件大小不同，但文件的帧数相同，这是由于通过关键帧进行视频压缩所致。这意味着检测空白帧的最佳方法是通过获取文件大小，这超出了 OpenCV 的范围，并且可以使用普通的 C/C++ 轻松完成：

```
#include <sys/stat.h>
...
struct stat st;
stat(avi_filename, &st);
size = st.st_size; 
```

# git - 使用 Git 保持多个项目同步

> ID：11508460
> 
> 赞同：0
> 
> 时间：2012-07-16T16:24:15.143
> 
> 标签：git, multiple-repositories

假设我有两个使用 Git 管理的项目（在不同的存储库中）。我在 project1 上的工作完全独立于 project2。我现在意识到我可以在 project1 中使用 project2 作为第三方软件。我想让这些项目保持独立并且不使用子模块，但我希望始终拥有两个项目的最新版本。因此，当我在处理 project1 并执行 a`git pull`时，我想从 project1*和*project2 中提取所有更改。我该怎么做？

让我知道是否需要任何澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:02:11.447

为此制作了子模块。如果您不跟踪项目 1 的每次提交所使用的项目 2 的版本，那么您就忽略了源代码控制本身的许多好处。例如，尝试并使用`git blame`您的方法。

您可以使用 更新您的子模块`git submodule foreach git pull`。下一次按下`ctrl-R`并输入`submodule`会找到整行 - 即使不输入整个单词。

# android - 正确使用后台服务/广播接收器

> ID：11508462
> 
> 赞同：5
> 
> 时间：2012-07-16T16:24:21.277
> 
> 标签：android, broadcastreceiver, android-service

我为 Android 构建了一个应用程序来自动登录到特定的访客无线网络。我希望这个应用程序即使在 UI/Activity 没有显示/运行时也能工作和运行。

目前它似乎运作良好，但我质疑设计的后勤工作。我的问题是：

*   我什至需要服务吗？
*   我的设计倒退了吗？广播接收器是否应该调用服务来完成工作？
*   您可以在清单中注册广播接收器而不必在代码中调用它吗？
*   多次调用 startService() 不好？我知道只有 1 个服务在运行，但是如何在创建服务之前检查该服务是否已经在运行？

该应用程序有 3 个组件：

1.  **Activity** - 有一个用于显示当前网络信息和关闭/“停止服务”按钮的 GUI
2.  **服务**- 这个服务所做的只是注册一个广播接收器
3.  **广播接收器**- 这是大部分工作。3.

    *   Activity 的 onCreate() 调用 Context.startService()
    *   Service onCreate() 创建通知图标并注册广播接收器
    *   广播接收器 onReceive() 检查网络状态是否已更改意图，然后检查当前是否连接到特定 SSID，然后调用我创建的特殊类来注册/检查是否经过身份验证。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-20T08:38:15.410

> 我什至需要服务吗？

这取决于。如果您在 BraodcastReceiver 中所做的工作不需要太多时间，那么您可以在那里完成。但是，如果您的`onReceive()`运行时间过长，那么 Android 会杀死它。一般来说，您不应该在 BroadcastReceiver 中进行网络 I/O。所以你可以使用 BroadcastReceiver 来启动你的服务，它可以做真正的工作。

> 我的设计倒退了吗？广播接收器是否应该调用服务来完成工作？

见我对第一个问题的回答（上）

> 您可以在清单中注册广播接收器而不必在代码中调用它吗？

是的，您可以在清单中`<intent-filter>`的标签中添加标签。`<receiver>`每当广播适当的 Intent 时，这将自动启动您的 BroadcastReceiver。您的应用程序无需运行即可发生这种情况。像这样的东西：

```
 <receiver
            android:name=".MyReceiver" >
        <intent-filter>
            <action android:name="android.net.wifi.STATE_CHANGE"/>
        </intent-filter>
    </receiver> 
```

> 多次调用 startService() 不好？我知道只有 1 个服务在运行，但是如何在创建服务之前检查该服务是否已经在运行？

多次调用就`startService()`可以了。如果它已经启动，它将不会启动另一个。每次调用都会在您的服务中`startService()`生成调用。`onStartCommand()`如果你想查看它是否已经在运行，你可以`peekService()`从你的 BroadcastReceiver 中使用。如果它正在运行，这将返回一个`IBinder`，但如果它尚未运行，则不会启动它。

另请参阅[android.net.wifi.STATE_CHANGE: not trigger on Wifi disconnect](https://stackoverflow.com/questions/5365395/android-net-wifi-state-change-not-triggered-on-wifi-disconnect)

# javascript - JavaScript 通过变量设置对象键

> ID：11508463
> 
> 赞同：1371
> 
> 时间：2012-07-16T16:24:23.647
> 
> 标签：javascript

我在 JavaScript 中构建一些对象并将这些对象推送到一个数组中，我将我想要使用的密钥存储在一个变量中，然后创建我的对象，如下所示：

```
var key = "happyCount";
myArray.push( { key : someValueArray } ); 
```

但是当我尝试检查每个对象的对象数组时，键`"key"`不是变量键的值。有没有办法从变量中设置键的值？

小提琴以获得更好的解释：http: [//jsfiddle.net/Fr6eY/3/](http://jsfiddle.net/Fr6eY/3/)

* * *

## 回答 #1

> 赞同：2527
> 
> 时间：2012-07-16T16:26:12.093

您需要先制作对象，然后使用`[]`设置它。

```
var key = "happyCount";
var obj = {};

obj[key] = someValueArray;
myArray.push(obj); 
```

* * *

2021 年更新：

[计算属性名称](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer#computed_property_names)功能是在 ECMAScript 2015 (ES6) 中引入的，它允许您以 JavaScript 对象文字表示法动态计算对象属性的名称。

```
const yourKeyVariable = "happyCount";
const someValueArray= [...];

const obj = {
    [yourKeyVariable]: someValueArray,
} 
```

* * *

## 回答 #2

> 赞同：468
> 
> 时间：2012-07-16T16:29:01.607

**在 ES6 中，你可以这样做。**

```
var key = "name";
var person = {[key]:"John"}; // same as var person = {"name" : "John"}
console.log(person); // should print  Object { name="John"} 
```

```
 var key = "name";
    var person = {[key]:"John"};
    console.log(person); // should print  Object { name="John"}
```

它称为计算属性名称，它使用括号表示法（方括号）实现`[]`

例子：`{ [variableName] : someValue }`

> 从 ECMAScript 2015 开始，对象初始值设定项语法也支持计算属性名称。这允许您将表达式放在括号 [] 中，该表达式将被计算并用作属性名称。

**对于 ES5，试试这样的**

```
var yourObject = {};

yourObject[yourKey] = "yourValue";

console.log(yourObject ); 
```

**例子：**

```
var person = {};
var key = "name";

person[key] /* this is same as person.name */ = "John";

console.log(person); // should print  Object { name="John"} 
```

```
 var person = {};
    var key = "name";

    person[key] /* this is same as person.name */ = "John";

    console.log(person); // should print  Object { name="John"}
```

# c++ - const 修饰符 在 ANSI C 和 ANSI C++ 中

> ID：11508466
> 
> 赞同：-5
> 
> 时间：2012-07-16T16:24:45.400
> 
> 标签：c++, c, ansi-c

这是真的 ？

1.如果我们单独使用 const 修饰符，它默认为 int。例如，

```
const size = 10; 
```

方法

```
const int size =10; 
```

2.ANSI C 不需要 const 的初始化器；如果没有给出，它会将 const 初始化为 0。例如，

```
const int i; 
```

方法

```
const i = 0; 
```

请给出答案。根据 ANSI 标准

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:33:18.390

1.  C89/90 也是如此。这不适用于 C99 或 C++。“隐式 int”规则在 C99 中被禁止，并且在 C++ 中从未存在过。

    然而，

    ```
    const size 10; 
    ```

    不是有效的 C 语法。`=`仍然是必需的。一个非常古老的 C 预标准版本（称为 CRM C）使用没有 的初始化语法`=`，但该版本的语言甚至还`const`没有。

2.  不对。在 C 中，具有*静态存储持续时间*的对象默认为零初始化。这意味着，例如，任何*文件范围*对象默认为零初始化，无论是否初始化`const`。默认情况下，局部变量不进行零初始化，不管它们是否是`const`。换句话说，这个问题与`const`.

    C++ 实现了类似的规范。在任何其他初始化发生之前，所有具有*静态存储持续时间的对象都被初始化为零。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:28:19.940

根据标准（C99，我没有检查 C++ 或更早的 C 版本），这些都不是真的。

1.  如果您查看声明的语法定义（第 6.7 节），您会发现类型说明符不是可选的。

2.  在默认初始化（第 6.7.8 节）中，我们发现以下内容：

    > 如果具有自动存储持续时间的对象未显式初始化，则其值是不确定的。如果具有静态存储持续时间的对象未显式初始化，则：
    > 
    > ...
    > 
    > *   如果它具有算术类型，则将其初始化为（正或无符号）零；
    > 
    > ...

    这里什么都没有`const`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:30:33.840

[http://ideone.com/kl9CZ](http://ideone.com/kl9CZ)不，这不是真的。

C 允许 default `int`，但直到 1999 年，他们才将其定为非法。很久以前，变量`int`在 MSVC 2003 的 C++ 中默认为，但在标准 C++ 中，自从语言标准化以来，这一直是非法的。事实上，当我将代码输入到最新版本的 MSVC 中时，我会收到错误消息：

> 错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数

据我所知，`=`在 C 或 C++ 中省略 是不合法的。

在*某些*情况下，C 和 C++ 会将变量初始化为零，但在某些情况下，您有一些类似的东西`int a = int();`，并且全局/静态变量是零初始化的。在您的代码中，（如果它们在函数中）C 和 C++ 都不会对这些变量进行零初始化。

# freebase - 获取随机记录时，Freebase MQL 查询非常慢

> ID：11508467
> 
> 赞同：2
> 
> 时间：2012-07-16T16:24:47.710
> 
> 标签：freebase, mql

因为没有办法使用 MQL 获取随机记录，所以我尝试先使用计数来获取它：

```
[{ "return": "count", "id": null, "name": null, "type": "/people/person"}]​ 
```

并使用和`n`之间的随机页码。在此示例中，大约有 2.000.000 条记录（40.000 页，每页 50 条记录）。然后我发送一个带有“page”属性的信封，并且我还将查询限制为在第 n 页中获取 50 条记录：`0``total / records per page`

```
[{ "limit": 50, "id": null, "name": null, "type": "/people/person"}]​ 
```

在信封中：

```
{"page": n} 
```

但是，当`n > 50`. `n > 100`当, 和 (例如)`n > 2000`甚至没有返回时，它的速度非常慢。

我可以做些什么来获得随机记录吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:57:01.913

当您这样做时，数据库必须获取所有较早的记录，以便它可以计数到您想要的记录。这就是为什么它这么慢。你可以做几件不同的事情：

1.  使用 Freebase 数据转储，为随机人员生成 Freebase MID 列表，然后您通过 MQL 或整个任务进行查询（您没有说明要获取的信息）
2.  将随机化问题转换为更容易计算的不同形式。例如，您可能首先为主题（1997 年至今）选择一个随机创建时间范围，然后选择在该时间范围内创建的随机人物主题。

# php - 如何更正 php mysql 查询

> ID：11508468
> 
> 赞同：0
> 
> 时间：2012-07-16T16:24:48.320
> 
> 标签：php, mysql, sql, syntax

现在我有这样的部分代码：

```
$q_ins='INSERT INTO `TOF_ARTICLES` VALUES (''.$r['ART_ID'].'',''.$r['ART_ARTICLE_NR'].'',''.$r['ART_SUP_ID'].'',''.$r['ART_DES_ID'].'',''.$r['ART_COMPLETE_DES_ID'].'',''.$r['ART_CTM'].'',''.$r['ART_PACK_SELFSERVICE'].'',''.$r['ART_MATERIAL_MARK'].'',''.$r['ART_REPLACEMENT'].'',''.$r['ART_ACCESSORY'].'',''.$r['ART_BATCH_SIZE1'].'',''.$r['ART_BATCH_SIZE2'].'');'; 
```

但是php说：

> 解析错误：语法错误，第 40 行 X:\denwer\www\denwer\td.php 中的意外 T_STRING

怎么了？我理解有语法的东西，但是什么？以及如何正确？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:28:08.607

使用这个更新的查询

```
$q_ins="INSERT INTO `TOF_ARTICLES` VALUES ('".$r['ART_ID']."','".$r['ART_ARTICLE_NR']."','".$r['ART_SUP_ID']."','".$r['ART_DES_ID']."','".$r['ART_COMPLETE_DES_ID']."','".$r['ART_CTM']."','".$r['ART_PACK_SELFSERVICE']."','".$r['ART_MATERIAL_MARK']."','".$r['ART_REPLACEMENT']."','".$r['ART_ACCESSORY']."','".$r['ART_BATCH_SIZE1']."','".$r['ART_BATCH_SIZE2']."');"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-16T16:29:59.097

对于初学者来说，你真的不应该做你正在做的事情。使用非参数化查询是极其危险的。

但要回答你的问题，试试这个。

```
$q_ins= "INSERT INTO `TOF_ARTICLES` VALUES ('{$r['ART_ID']}','{$r['ART_ARTICLE_NR']}','{$r['ART_SUP_ID']}','{$r['ART_DES_ID']}','{$r['ART_COMPLETE_DES_ID']}','{$r['ART_CTM']}','{$r['ART_PACK_SELFSERVICE']}','{$r['ART_MATERIAL_MARK']}','{$r['ART_REPLACEMENT']}','{$r['ART_ACCESSORY']}','{$r['ART_BATCH_SIZE1']}','{$r['ART_BATCH_SIZE2']}');"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:32:45.943

```
$q_ins = <<<MySQL
INSERT INTO `TOF_ARTICLES`
VALUES (
  {$r["ART_ID"]}
  ,{$r["ART_ARTICLE_NR"]}
  ,{$r["ART_SUP_ID"]}
  ,{$r["ART_DES_ID"]}
  ,{$r["ART_COMPLETE_DES_ID"]}
  ,{$r["ART_CTM"]}
  ,{$r["ART_PACK_SELFSERVICE"]}
  ,{$r["ART_MATERIAL_MARK"]}
  ,{$r["ART_REPLACEMENT"]}
  ,{$r["ART_ACCESSORY"]}
  ,{$r["ART_BATCH_SIZE1"]}
  ,{$r["ART_BATCH_SIZE2"]}
  )
;
MySQL; 
```

那里，不是更好吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T16:27:28.767

尝试这个 ：

```
$q_ins='INSERT INTO `TOF_ARTICLES` VALUES ("'.$r['ART_ID'].'","'.$r['ART_ARTICLE_NR'].'","'.$r['ART_SUP_ID'].'","'.$r['ART_DES_ID'].'","'.$r['ART_COMPLETE_DES_ID'].'","'.$r['ART_CTM'].'","'.$r['ART_PACK_SELFSERVICE'].'","'.$r['ART_MATERIAL_MARK'].'","'.$r['ART_REPLACEMENT'].'","'.$r['ART_ACCESSORY'].'","'.$r['ART_BATCH_SIZE1'].'","'.$r['ART_BATCH_SIZE2'].'");'; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T16:28:42.390

您的代码插入似乎有一对多的“”：P

`'.$r['ART_COMPLETE_DES_ID'].''`替换为 '.$r["ART_COMPLETE_DES_ID"].'' 以免混淆。

这是一个完整的查询：

```
mysql_query("

INSERT INTO `TOF_ARTICLES` 
(`art_id`, 
`art_article_nr`, 
`art_sup_id`, 
`art_des_id`, 
`art_complete_des_id`, 
`art_ctm`, 
`art_pack_selfservice`, 
`art_material_mark`, 
`art_replcacement`, 
`art_accessory`, 
`art_batch_size1`, 
`art_batch_size2`)

VALUES (''.$r['ART_ID'].'',
''.$r['ART_ARTICLE_NR'].'',
'".$r['ART_SUP_ID']."',
''.$r['ART_DES_ID'].'',
''.$r['ART_COMPLETE_DES_ID'].'',
''.$r['ART_CTM'].'',
''.$r['ART_PACK_SELFSERVICE'].'',
''.$r['ART_MATERIAL_MARK'].'',
''.$r['ART_REPLACEMENT'].'',
''.$r['ART_ACCESSORY'].'',
''.$r['ART_BATCH_SIZE1'].'',
''.$r['ART_BATCH_SIZE2'].'');
") or die("Error: " . mysql_error()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T16:29:51.343

这可能是你的报价。尝试这个：

```
$q_ins = 'INSERT INTO `TOF_ARTICLES` VALUES ('.$r['ART_ID'].',
                                             '.$r['ART_ARTICLE_NR'].',
                                             '.$r['ART_SUP_ID'].',
                                             '.$r['ART_DES_ID'].',
                                             '.$r['ART_COMPLETE_DES_ID'].',
                                             '.$r['ART_CTM'].',
                                             '.$r['ART_PACK_SELFSERVICE'].',
                                             '.$r['ART_MATERIAL_MARK'].',
                                             '.$r['ART_REPLACEMENT'].',
                                             '.$r['ART_ACCESSORY'].',
                                             '.$r['ART_BATCH_SIZE1'].',
                                             '.$r['ART_BATCH_SIZE2'].')'; 
```

# javascript - 序列化具有方法的自定义对象。序列化后删除的方法 - 采取哪些步骤？

> ID：11508469
> 
> 赞同：0
> 
> 时间：2012-07-16T16:24:49.543
> 
> 标签：javascript, json, serialization

我创建了一个类似于这个简化示例的自定义对象。我的实现为 Playlist 提供了更复杂的方法：

```
function Playlist(id) {
    var _songs = [];

    if(!id)
        id = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) { var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8); return v.toString(16); });

    var playlist = {
        id: id,
        title: "New Playlist",

        clear: function(){
            _songs = [];
            _save();
        },

        songCount: function () {
            return _songs.length;
        },

        getSongs: function () {
            return _songs;
        }
    }

    return playlist;
} 
```

现在，我有另一个对象 Playlists，它保存了 Playlist 对象：

```
function playlists(){
    var _playlists = null;
    var _currentPlaylist = null;

    var _save = function () {
        localStorage.setItem('playlists', JSON.stringify(_playlists));
    };

    var _loadPlaylists = function(){
        _playlists = localStorage.getItem('playlists');

        try {
            if (_playlists && _playlists != 'undefined')
                _playlists = JSON.parse(_playlists);
        }
        catch(exception){
            console.error(exception);
        }

        if(!_playlists){
            _playlists = new Array();
            var defaultPlaylist = new Playlist(null, null);

            _playlists.push(defaultPlaylist);
            _save();
        }
    };

    var playlists = {
        count: function(){
            return _playlists.length;
        },

        getPlaylists: function(){
            return _playlists;
        },

        getCurrentPlaylist: function(){
            currentPlaylist = _currentPlaylist;

            if(!currentPlaylist){
                _loadPlaylists();
                currentPlaylist = _playlists[0];
                currentPlaylist.selected = true;
            }

            return currentPlaylist;
        },

        addPlaylist: function(playlistName){
            var playlist = new Playlist(null, playlistName);
            _playlists.push(playlist);
            _save();
        }
    }

    return playlists;
} 
```

当我使用 JSON.parse 将播放列表对象从 JSON 转换为对象时，我注意到播放列表对象已被剥离其方法。我相信这是因为 JSON.stringify 不知道如何（或者它不知道应该）将对象转换为 JSON。

我想知道对此的正确反应是什么？是否可以将方法标记为可序列化？还是需要更多的工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:26:52.017

`JSON.stringify()`保存数据属性，而不是方法。这就是它的工作原理。

如果您希望它保存您的实际 javascript 代码，那根本不是它的设计方式。如果你愿意，你可以添加一个作为对象自定义类型的数据属性，当你读回对象时，你可以使用它来重新附加适当的方法。`JSON.stringify()`但是， and不会发生这种情况`JSON.parse()`。

如果您事先知道您正在阅读什么类型的对象，您可以创建该类型的对象并将保存的 JSON 作为初始化程序传递给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:32:54.173

如前所述，`stringify`旨在序列化属性，而不是函数。我发现[这篇博客文章](http://blog.maxaller.name/2011/01/javascript-serialization/)解释了为什么会这样，最后是如何通过使用`__proto__`属性来保留对象的功能。看起来是目前唯一的解决方法。

# php - 按 SKU 将可配置产品添加到购物车 - Magento

> ID：11508470
> 
> 赞同：1
> 
> 时间：2012-07-16T16:24:52.947
> 
> 标签：php, magento

我正在玩程序化购物车娱乐。通过 id 将产品添加到购物车没有问题 ie

```
 $params = array(
    'product' => 272,
    'super_attribute' => array(
        22 =>30 ,
    ),
    'qty' => 2,
);

$cart = Mage::getSingleton('checkout/cart'); 
$product = new Mage_Catalog_Model_Product();
$product->load(272); 
$cart->addProduct($product, $params);
$cart->save(); 
Mage::getSingleton('checkout/session')->setCartWasUpdated(true); 
```

但是如果我只知道产品 sku 怎么做，我的意思是如何获取可配置产品的产品 id 和 super_attributes。

```
Mage::getModel('catalog/product')->loadByAttribute('sku','$sku'); 
```

似乎只返回该产品（sku）信息而没有 special_attribute。

有任何想法吗？

干杯，/马辛

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-12T16:46:27.040

我想，[feelela](https://stackoverflow.com/a/11509191/790879)没有回答这个问题。

一般（没有错误处理）：

```
$sku = 'any-sku-number';
$qty = 1;

$product = Mage::getModel('catalog/product')
    ->loadByAttribute('sku', $sku);

$parentIds = Mage::getResourceSingleton('catalog/product_type_configurable')
    ->getParentIdsByChild($product->getId());

$parent = Mage::getModel('catalog/product')->load(current($parentIds));

if ($parent->getTypeId() === Mage_Catalog_Model_Product_Type::TYPE_CONFIGURABLE) {
    $paramsSuperAttribute = array('super_attribute' => array());

    foreach ($parent->getTypeInstance(true)->getConfigurableAttributes($parent) as $attribute) {
        $paramsSuperAttribute['super_attribute'][$attribute->getProductAttribute()->getAttributeId()] =
            (int) $product->getData($attribute->getProductAttribute()->getAttributeCode());
    }
}

$params = array('qty' => $qty); 
```

现在，通过 sku 将产品添加到购物车有两种方法：

以编程方式：

```
$cart = Mage::getSingleton('checkout/cart');

$cart->addProduct(isset($parent) ? $parent : $product, array_merge($params, $paramsSuperAttribute))->save();

Mage::getSingleton('checkout/session')->setCartWasUpdated(true); 
```

通过网址：

```
$addToCartUrl = Mage::helper('checkout/cart')
    ->getAddUrl(isset($parent) ? $parent : $product, $params);

if (isset($parent)) {
    $addToCartUrl .= '?' . http_build_query($paramsSuperAttribute);
}

// now you can use this url like this (controller action)
$this->getResponse()->setRedirect($addToCartUrl);
return; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:11:16.347

您可以通过获取按 SKU 过滤的集合来检索产品：

```
$searchForThisSku = 'p_1234';

/** @var $productCollection Mage_Catalog_Model_Resource_Product_Collection */
$productCollection = Mage::getModel( 'catalog/product' )
    ->getResourceCollection()
    ->addFieldToFilter( 'sku', $searchForThisSku );

/** @var $product Mage_Catalog_Model_Product */
$product = $productCollection->getFirstItem();

// you should have the product now, maybe it isn't even necessary to get the ID
$product->getId();

// all in one line:
$productId = (int) Mage::getModel( 'catalog/product' )
    ->getResourceCollection()
    ->addFieldToFilter( 'sku', $searchForThisSku )
    ->getFirstItem()
    ->getId(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T20:15:30.217

尝试

```
/** @product Mage_Catalog_Model_Product */
$product = Mage::getModel('catalog/product');

$sku = 'sku';
$product->load($sku, 'sku'); 
```

# ubuntu - 如何在 ubuntu 中更改 netbeans 项目资源管理器背景？

> ID：11508472
> 
> 赞同：-1
> 
> 时间：2012-07-16T16:25:05.900
> 
> 标签：ubuntu, themes, netbeans-7

我在 ubuntu 11.10 上使用 netbeans 7.1。我安装了一个名为“暮光之城”的黑暗主题。但是项目浏览器仍然是白色的。

[截屏](http://s9.postimage.org/fo58qmhan/nbtheme.png)

如何更改项目浏览器的主题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:08:39.873

我相信你应该改变你的 GTK 主题来实现这一点。此外，这样做会反映到您正在使用的其他应用程序。看看这里： http: [//gnome-look.org/index.php](http://gnome-look.org/index.php)

# git - 如何让我的本地存储库与 github 上的主存储库中的 ha 文件同步？

> ID：11508480
> 
> 赞同：0
> 
> 时间：2012-07-16T16:25:31.533
> 
> 标签：git, github

我正在 git hub 上的 master 中查找文件。

我正在查看本地存储库中的相同文件，但它并未反映其他人提交的存储库中主文件的更改。

我试过 git pull git fetch 和合并。

我还需要做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:55:25.300

如果您不想在工作文件夹中保留任何更改，并且假设您确实成功运行了 fetch，您可以

```
git stash -u # safely clean up your working folder 
```

然后将 master 指向遥控器的版本（假设您的遥控器称为 origin）：

```
git merge --ff-only origin/master # if master is checked out 
```

或者

```
git push . origin/master:master # if master is not checked out 
```

如果最后 2 个出现错误，您可以添加该`--force`选项，但请记住在执行此操作之前将 master 保存到另一个分支或标签

```
git branch temp master
git push origin yourname/temp 
```

或者

```
git tag -m "last master" temp
git push origin yourname/temp 
```

远程分支或标签的“你的名字”部分是为了让别人知道这是你的分支，你不一定相信它对别人有价值。

# ruby-on-rails-3 - Rails 嵌套属性回调

> ID：11508481
> 
> 赞同：0
> 
> 时间：2012-07-16T16:25:34.003
> 
> 标签：ruby-on-rails-3, callback, nested-attributes

现在我正在开发一个具有模型的 Rails 应用程序，`Event`并且该模型具有`Category`模型作为嵌套属性。

我的`Event`模型有一个`state`属性，如果它的嵌套类别达到特定数量，则该属性必须更改为某个值。

我尝试使用模型`after_update`中的回调来做到这一点`Event`，但没有奏效。有人有什么主意吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:44:19.787

为什么它不起作用？可能是因为它达到了最大递归级别。尝试这样的事情：

```
class Event < ActiveRecord::Base
  attr_accessor :category_count_state_updated
  has_many :categories
  accepts_nested_attributes_for :categories
  attr_accessible :categories_attributes
  after_update :update_state

  private
    def update_state
      unless self.category_count_state_updated
        self.state = 'categories_count_reached' if self.categories.count == 5
        self.category_count_state_updated = true
        self.save
      end
    end
end 
```

# ruby-on-rails-3 - 如何以 DRY 方式在 Rails 中存储静态但重复的内容

> ID：11508484
> 
> 赞同：1
> 
> 时间：2012-07-16T16:25:47.197
> 
> 标签：ruby-on-rails-3, dry

我正在为我的个人网站制作投资组合部分。每个投资组合项目，其中有很多，看起来像这样：

```
 <li>
    <h3>Core Product</h3>
    <ul>
      <li>Snip</li>
      <li>2011 to 2012</li>
    </ul>
    <%= link_to "http://sniphq.com/demo" %>
    <p> 
      Snip is a company I started in January 2011.
      I did all the programming, design, usability testing, sales, marketing&mdash;everything.
      The overall idea is to allow hairstylists to spend more time on hair and less time on everything else.
    </p>
  </li> 
```

我不喜欢这里的数据如何与数据的显示方式如此紧密地耦合在一起。如果我能做这样的事情，我会很整洁：

```
snip:
  client_name: Snip
  project_name: Core Product
  period: 2011 to 2012
  link: http://sniphq.com/demo
  description: Snip is a company I... 
```

然后在我看来，我可以遍历这些项目。我意识到我可以为投资组合项目创建一个数据库表，但这对我作为内容编写者来说更难维护，而且作为程序员也比我需要的更复杂。

实现这种功能的最佳/最简单的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:29:21.657

有一个名为 StaticModel 的 gem，您可以在 YAML 文件中定义您的数据，它具有 ActiveRecord::Base 类的某些属性。在这里查看：http: [//code.quirkey.com/static_model/](http://code.quirkey.com/static_model/)

# android - 用于样式视图的 Android layout-xml

> ID：11508485
> 
> 赞同：0
> 
> 时间：2012-07-16T16:25:51.813
> 
> 标签：android, android-layout

使用预定义属性创建 View 对象的最佳实践是什么？

我想使用类似的东西

```
View view = (View) inflater.inflate(R.layout.orangeview, container,
                false); 
```

但它似乎需要橙色视图位于视图组内，我希望在布局文件中有更独立的东西 - 唯一的视图属性如

```
<?xml version="1.0" encoding="utf-8"?>
<RadioButton
    android:layout_width="fill_parent"
    android:id="@+id/orangeradiobutton"
    android:layout_weight="1"
    android:button="@null"
    android:gravity="center"
    android:textAppearance="?android:attr/textAppearanceSmall"
    android:textColor="@color/radiobutton_colors" /> 
```

这是可能的还是我应该使用另一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T20:23:19.797

container 参数用于“调整”您的膨胀布局。如果你不想要这个，你可以打电话

```
View view = inflater.inflate(R.layout.orangeView, null); 
```

# lua - 电晕sdk + xmpp

> ID：11508486
> 
> 赞同：0
> 
> 时间：2012-07-16T16:26:02.093
> 
> 标签：lua, xmpp, coronasdk

有谁知道我是否可以在 Corona SDK 中使用一些 XMPP 库来构建 Android 和 iOS 应用程序？我想到了[诗](http://matthewwild.co.uk/projects/verse/home)库。但我不确定是否可以在 Corona SDK 中使用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:32:54.737

Verse 不是纯 Lua，Prosody 也不是纯 Lua（不那么纯），因为它们依赖于 LuaSocket 和其他扩展。Lua 没有内置网络功能。Corona 实际上包含 LuaSocket，所以我猜你可以通过一些努力让 Prosody 工作，但它不是即插即用的。

# android - Android 应用程序 doPost

> ID：11508488
> 
> 赞同：1
> 
> 时间：2012-07-16T16:26:08.497
> 
> 标签：android, google-app-engine, httpwebrequest

我在执行从我的 android 应用程序到我的 Google 应用程序的简单 http post 请求时遇到问题。

所以这里是错误信息：

```
07-16 15:58:02.314: E/AndroidRuntime(911): FATAL EXCEPTION: main
07-16 15:58:02.314: E/AndroidRuntime(911): java.lang.IllegalStateException: Could not     execute method of the activity 
```

它发生在我的 android 应用程序中的 httpclient.execute 命令：

```
ConnectivityManager connMgr = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo networkInfo = connMgr.getActiveNetworkInfo();
HttpClient httpclient = new DefaultHttpClient();
HttpPost httppost = new HttpPost("http://localhost:8888/mywebapp");
try {
// Execute HTTP Post Request
HttpResponse response = httpclient.execute(httppost);
} 
```

在我的服务器上，没有任何迹象表明我到达了我的 post 方法：

```
protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws  ServletException, IOException {
System.out.println("SYL: POST request received");
super.doPost(req, resp);
} 
```

服务器是在我的 Eclipse 下本地运行的 google webb 应用程序，具有以下配置：

```
<servlet-name>MyWebApp</servlet-name>
<servlet-class>com.my.mywebapp.MyWebAppServlet</servlet-class>
</servlet>
<servlet-mapping>
<servlet-name>MyWebApp</servlet-name>
<url-pattern>/mywebapp/*</url-pattern>
</servlet-mapping> 
```

如果测试我通过网络导航器调用的 get 方法，它就可以工作。但是在java中调用get（与我为帖子所做的相同）不起作用。就像在 android 应用程序中一样，无法与我的服务器建立连接。

我把这些权限：

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

有人能帮助我吗？？

谢谢你。

PS：

用 10.0.2.2 替换 localhost 仍然是同样的错误。我正在复制完整的跟踪：

```
07-16 18:13:34.945: E/AndroidRuntime(1081): FATAL EXCEPTION: main
07-16 18:13:34.945: E/AndroidRuntime(1081): java.lang.IllegalStateException: Could not execute method of the activity
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.view.View$1.onClick(View.java:3044)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.view.View.performClick(View.java:3511)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.view.View$PerformClick.run(View.java:14105)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.os.Handler.handleCallback(Handler.java:605)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.os.Handler.dispatchMessage(Handler.java:92)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.os.Looper.loop(Looper.java:137)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.app.ActivityThread.main(ActivityThread.java:4424)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at java.lang.reflect.Method.invokeNative(Native Method)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at java.lang.reflect.Method.invoke(Method.java:511)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at dalvik.system.NativeStart.main(Native Method)
07-16 18:13:34.945: E/AndroidRuntime(1081): Caused by: java.lang.reflect.InvocationTargetException
07-16 18:13:34.945: E/AndroidRuntime(1081):     at java.lang.reflect.Method.invokeNative(Native Method)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at java.lang.reflect.Method.invoke(Method.java:511)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.view.View$1.onClick(View.java:3039)
07-16 18:13:34.945: E/AndroidRuntime(1081):     ... 11 more
07-16 18:13:34.945: E/AndroidRuntime(1081): Caused by: android.os.NetworkOnMainThreadException
07-16 18:13:34.945: E/AndroidRuntime(1081):     at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at java.net.InetAddress.lookupHostByName(InetAddress.java:391)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at java.net.InetAddress.getAllByNameImpl(InetAddress.java:242)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at java.net.InetAddress.getAllByName(InetAddress.java:220)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:137)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
07-16 18:13:34.945: E/AndroidRuntime(1081):     at com.my.my.MyActivity.sendMessage(MyActivity.java:72)
07-16 18:13:34.945: E/AndroidRuntime(1081):     ... 14 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:30:07.273

如果你在本地服务器调试，改变你要访问的IP，并设置这个：10.0.2.2。因此，您的 httpost 将如下所示：

```
HttpPost httppost = new HttpPost("http://10.0.2.2:8888/mywebapp"); 
```

欲了解更多信息，[http://developer.android.com/tools/devices/emulator.html#networkaddresses](http://developer.android.com/tools/devices/emulator.html#networkaddresses)

# sql-server-2008 - 在sql server中使用IN子句

> ID：11508494
> 
> 赞同：-1
> 
> 时间：2012-07-16T16:26:24.600
> 
> 标签：sql-server-2008

我的查询如下所示。如果 Type = 1 和 subtype = 1,3 或 2，我想选择值。

```
select sum(case when Type = 1 and  SubType in (1, 3 or 2) then 1 else 0 end) as 'WorkStations' 
```

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:31:02.797

由于您只是想计算符合我所见标准的工作站数量：

```
SELECT COUNT(*) AS Workstations FROM MyWorkStationTable WHERE Type = 1 AND SubType IN (1, 2, 3) 
```

此外，IN 子句本质上已经是 OR。它既不是有效的语法，也没有必要说明它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:01:01.207

如果您只是对记录进行计数，最好的办法是使用 SQL Server 提供的 COUNT 函数。考虑使用以下内容：

```
SELECT COUNT(*) FROM [Table] WHERE TYPE = 1
                              AND (SUBTYPE = 1
                               OR  SUBTYPE = 2
                               OR  SUBTYPE = 3) 
```

最好避免使用“IN”，因为它会导致对 SQL 引擎的不必要调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:32:14.033

```
SELECT COUNT(*) [Workstations] FROM [YourTable] t WHERE t.Type = 1 AND t.SubType IN (1, 2, 3) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T16:36:20.410

尝试避免`IN`使用谓词，而是使用连接，因为它不必要地迭代，尽管事实上只有一个/两个匹配。我将用一个例子来解释它。

假设我有两个列表对象。

```
List 1      List 2
  1           12
  2            7
  3            8
  4           98
  5            9
  6           10
  7            6 
```

使用`IN`，它将搜索**List-2中的每个****List-1**项目，这意味着迭代将发生**49 次**！

# jquery - 让 Chrome 和 Firefox 记住密码

> ID：11508504
> 
> 赞同：0
> 
> 时间：2012-07-16T16:27:03.357
> 
> 标签：jquery, ajax, firefox, google-chrome

我有一个登录表单，它重定向到一个 php 脚本，如果用户已注册并且所有这些好东西，则该脚本会检查数据库，我想做的是我想要 firefox 或 chrome 记住用户名和密码 ass 它发生在所有其他页面。
这是我的代码：

```
<form id="loginForm" action="../php/login.php" method="post">
            <table>
                <tr>
                    <td><label for="user">Username :</label></td>
                    <td><input name="user" id="user" type="text" /></td>                                        
                </tr>
                <tr>
                    <td><label for="password">Password :</label></td>
                    <td><input name="password" id="password" type="password" /></td>
                </tr>
                <tr>
                    <td></td>
                    <td id="subCont"><input id="submit" type="submit" value="Login"></td>
                </tr>
            </table>
        </form> 
```

我将使用 jQuery Ajax 方法处理所有信息

```
var form = $('#loginForm');             

            form.on('submit',function(e){
                e.preventDefault();
                $this = $(this);
                $.ajax({
                    type : 'post',
                    url  : 'php/login.php',
                    data : $this.serialize(),
                    dataType : 'json',
                    success  : function(r){

                    },
                    error : function(r){
                        window.alert(r.Message);
                    }
                });
            }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:47:49.540

记住用户名和密码是用户浏览器中的一个选项，不是您可以控制的。

# mysql - 为什么 if 子句不返回国籍

> ID：11508506
> 
> 赞同：1
> 
> 时间：2012-07-16T16:27:18.677
> 
> 标签：mysql, if-statement

在下面的 SQL 选择语句中，如果 name 为 null，我希望打印国籍，并且我有一个 SQL 子句的 if 语法工作，但在下面没有看到国籍打印：

```
table test2

id           integer
case         integer
nationality  char(10)
name         char(24)

1 1 france  ""
2 2 england john

select t.id, 
       if(t.name is null, t.nationality, t.name) 
       as name_equivalent 
from   test2 t; 
```

产生 id name_equivalent

* * *

```
1 ""
2 john 
```

这是为什么？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:29:23.980

您正在检查名称是否为空，但它被设置为空字符串。要检查两者，您需要：

```
if(t.name is null or t.name='', t.nationality, t.name) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:31:22.130

`null`不等于空字符串。空字符串`''`是有效的数据形式，`null`表示不存在数据。

尝试任一

```
if (t.name is null or t.name='', t.nationality, t.name) 
```

或者将第一列中的名称设置为null

```
1 1 france null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:29:32.480

看起来 France 的 name 字段实际上是一个空字符串，而不是 null。您还需要在您的选择语句中说明它是空的。如`t.name = ''`

# android - 日历事件意图 - startActivityForResult

> ID：11508511
> 
> 赞同：4
> 
> 时间：2012-07-16T16:27:38.130
> 
> 标签：android, android-intent, android-activity, android-contentprovider, android-calendar

我想从我的应用程序中创建一个事件到日历中。我可以通过以下方式开始新的活动：

```
Intent intent = new Intent(Intent.ACTION_EDIT).setData(uri);
intent.setType("vnd.android.cursor.item/event");
startActivityForResult(intent, REQUEST_ID); 
```

是否可以**获取已创建事件的 ID**？OnActivityResult resultCode 始终为 0 - 无论我是否创建事件。数据始终为空。有什么办法吗？

# ruby-on-rails - MassPayment on Rails 功能误区

> ID：11508517
> 
> 赞同：0
> 
> 时间：2012-07-16T16:28:02.717
> 
> 标签：ruby-on-rails, paypal

我想使用 MassPayments。

我的控制器中有功能：

```
def send_money(to_email, how_much_in_cents, options = {})
  credentials = {
    "USER" => 'pro._1342094044_biz_api1.gmail.com',
    "PWD" => '1342094095',
    "SIGNATURE" => 'AMVxTgrWf6tUTF0Rf0y4QsqTFFAcApSXcqINQj2b2-a5wFhIx3UG87E- ',
  }

  params = {
    "METHOD" => "MassPay",
    "CURRENCYCODE" => "USD",
    "RECEIVERTYPE" => "EmailAddress",
    "L_EMAIL0" => to_email,
    "L_AMT0" => ((how_much_in_cents.to_i)/100.to_f).to_s,
    "VERSION" => "51.0"
  }
  endpoint = RAILS_ENV == 'production' ? "https://api-3t.paypal.com" : "https://api3t.sandbox.paypal.com"
  url = URI.parse(endpoint)
  http = Net::HTTP.new(url.host, url.port)
  http.use_ssl = true
  all_params = credentials.merge(params)
  stringified_params = all_params.collect { |tuple| "#{tuple.first}={CGI.escape(tuple.last)}" }.join("&")

  response = http.post("/nvp", stringified_params)
end 
```

我只为一个用户调用这个函数（一开始）：

```
send_money('pro_1342434702_biz@gmail.com',1000) 
```

但此时它给了我错误：

```
uninitialized constant MerchantsController::RAILS_ENV 
```

所以我试图改变这一行：

```
endpoint = RAILS_ENV == 'production' ? "https://api-3t.paypal.com" : "https://api-3t.sandbox.paypal.com" 
```

但我所有的尝试都失败了。我在实验期间遇到的错误 - 环境或 SSL 证书错误。

当我离开时：

```
endpoint = "https://api-3t.sandbox.paypal.com" 
```

我得到错误：

```
SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:39:06.187

我认为您的帖子中有两个问题。首先，要测试您是否处于生产模式，您可以执行以下操作：

```
endpoint = ENV["RAILS_ENV"] == 'production' ? "https://api-3t.paypal.com" : "https://api-3t.sandbox.paypal.com" 
```

另一个问题是 SSL 的问题。您可以在这里找到解决方案：[SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed](https://stackoverflow.com/questions/4528101/ssl-connect-returned-1-errno-0-state-sslv3-read-server-certificate-b-certificat)

# c# - 图标属性的 ImageSource 必须是图标文件 - 嵌入式资源

> ID：11508525
> 
> 赞同：1
> 
> 时间：2012-07-16T16:28:31.420
> 
> 标签：c#, .net, wpf, embedded-resource, resx

我需要将一个分配`Icon`给 WPF 窗口，但似乎无法从资源文件中执行此操作。我尝试[了这个解决方案](https://stackoverflow.com/questions/1127647/convert-system-drawing-icon-to-system-media-imagesource)，但最终得到：

> Icon 属性的 ImageSource 必须是图标文件

但是，如果我尝试将其保留为`Icon`，那么我会收到一个需要转换为的错误`ImageSource`...

```
Icon = Properties.Resources.myIcon.ToImageSource(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:56:55.827

我最终做了以下事情：

```
using (var iconStream = new MemoryStream())
{
    icon.Save(iconStream);
    iconStream.Seek(0, SeekOrigin.Begin);
    return BitmapFrame.Create(iconStream);
} 
```

这实际上是我已经引用过的同一个问题的不被接受的答案之一：[只是一个不同的回应](https://stackoverflow.com/a/4031232/779513)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:32:00.483

您引用的另一个 SO 解决方案是从 IntPtr 创建一个图标，因此不适用于您的情况。而是尝试以下操作：

```
var icon = BitmapFrame.Create(Application.GetResourceStream(
              new Uri("MyAppIcon.ico", UriKind.RelativeOrAbsolute)).Stream); 
```

[http://welearndotnet.blogspot.com/2011_11_21_archive.html](http://welearndotnet.blogspot.com/2011_11_21_archive.html)

# android - 活动单元测试持有视觉结果

> ID：11508528
> 
> 赞同：0
> 
> 时间：2012-07-16T16:28:41.640
> 
> 标签：android, android-activity, android-ui, android-testing

我正在尝试测试一个活动。此活动包含一个包含列表视图的片段。我正在传入一个对象（从数据库生成）以显示在列表视图中。

我想将此作为测试执行，以便我可以用虚拟数据填充数据库，然后将要显示的对象移交给 Activity。我的问题是单元测试并没有真正设置为让我使用虚拟数据来玩和目视检查我的片段。测试只是运行并立即关闭应用程序。

任何人都可以就他们将如何进行测试提出任何建议吗？或者是我唯一的选择是创建一个测试数据库并在应用程序中使用这个数据库，即不使用测试框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:45:45.420

我建议您查看像[Robotium](http://code.google.com/p/robotium/)这样的 UI 测试框架，它可以测试 UI 元素是否具有某些值 - 例如 TextEdit 是否包含某些文本。

# arrays - 在 Powershell 中包含对象的两个数组中查找匹配项的最快方法是什么？

> ID：11508534
> 
> 赞同：-1
> 
> 时间：2012-07-16T16:29:14.713
> 
> 标签：arrays, object, powershell, active-directory

我在两个数组中有许多对象。每个对象都具有相同的属性。

示例对象：

```
$obj1 = New-Object System.Object;
$obj1 | Add-Member -Type NoteProperty -Name FirstName 'George'; 
$obj1 | Add-Member -Type NoteProperty -Name LastName 'Banks';
$obj1 | Add-Member -Type NoteProperty -Name EmployeeID '1903'; 
```

数组：

```
$array1 = @($obj1,$obj2,$obj3);
$array2 = @($obj5,$obj3,$obj9); 
```

我的目标是基于两个因素以 1:1 的关系匹配每个数组中的每个对象；匹配 EmployeeID 或者如果 EmployeeID 未填充，则匹配 FirstName,LastName 组合。

例如，假设我有以下情况：

```
$obj1 = New-Object System.Object;
$obj1 | Add-Member -Type NoteProperty -Name FirstName 'George'; 
$obj1 | Add-Member -Type NoteProperty -Name LastName 'Banks';
$obj1 | Add-Member -Type NoteProperty -Name EmployeeID '1903'; 

$obj2 = New-Object System.Object;
$obj2 | Add-Member -Type NoteProperty -Name FirstName 'Paul'; 
$obj2 | Add-Member -Type NoteProperty -Name LastName 'Newman';
$obj2 | Add-Member -Type NoteProperty -Name EmployeeID '567';

$obj3 = New-Object System.Object;
$obj3 | Add-Member -Type NoteProperty -Name FirstName 'George'; 
$obj3 | Add-Member -Type NoteProperty -Name LastName 'Banks';
$obj3 | Add-Member -Type NoteProperty -Name EmployeeID '1903'; 

$obj4 = New-Object System.Object;
$obj4 | Add-Member -Type NoteProperty -Name FirstName 'Paul'; 
$obj4 | Add-Member -Type NoteProperty -Name LastName 'Newman';
$obj4 | Add-Member -Type NoteProperty -Name EmployeeID '';

$array1 = @($obj1,$obj2);
$array2 = @($obj3,$obj4); 
```

在此示例中，我可以匹配 George Banks 的 EmployeeID，因为它存在于两个数组中。但是，Paul Newman 没有在 $array2 中填充 EmployeeID，因此我需要根据他的 FirstName/LastName 组合来匹配他。

最终，我想得到一个这样的数组输出，它将每个对象的所有属性合并到一个对象中。

```
$obj1.FirstName = 'George'
$obj1.LastName = 'Banks'
$obj1.EmployeeID = '1903'
$obj2.FirstName = 'Paul';
$obj2.LastName = 'Newman';
$obj2.EmployeeID = '567'

$aOutput = @($obj1,$obj2); 
```

我这样做的现实原因有两个。

1.  我有一个包含 FirstName、LastName、EmployeeID、Department 的员工电子表格。在 Active Directory 中，通常只填充 FirstName 和 LastName。我想获取电子表格中的数据并使用丢失的数据填充该用户的 Active Directory 用户帐户。

2.  我们有数以千计的 Active Directory 用户帐户，这些帐户并未专门分配给实际员工，目前也无法得知。我需要这个脚本来找到一种将实际员工与其各自的 Active Directory 用户帐户相匹配的方法，以便我们可以标记它。标记后，如果该用户帐户在 60 天内未通过身份验证，则该用户帐户将不会被删除。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T02:21:48.130

我想你想做这样的事情。此代码检查员工 ID 是否匹配，或者名字和姓氏的串联是否匹配。如果是这样，它将检查数组 1 中对象中的每个字段以查看它是否为空。如果是，则复制数组 2 中匹配对象中相应字段的内容。

```
foreach ($employee1 in $array1) { 
    foreach ($employee2 in $array2) {
        if( ($employee1.EmployeeID -eq $employee2.EmployeeID) -or 
            ("$($employee1.FirstName)$($employee1.LastName)" -eq "$($employee2.FirstName)$($employee2.LastName)")) {
            if ([string]::IsNullOrEmpty($employee1.FirstName)) {
                $employee1.FirstName = $employee2.FirstName
            } elseif ([string]::IsNullOrEmpty($employee1.LastName)) {
                $employee1.LastName = $employee2.LastName
            } elseif ([string]::IsNullOrEmpty($employee1.EmployeeID)) {
                $employee1.EmployeeID = $employee2.EmployeeID
            }       
        } 
    } 
} 
```

有几点需要考虑：

1.  您可能想要创建一组新对象，对更改进行完整性检查，然后复制原始对象。
2.  如果您有共享名字和姓氏的不同人的条目，则此代码将中断。
3.  此代码不考虑相应字段均为空的情况。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-17T22:46:51.953

After a lot of trial and tribulation I eventually got it. What I ended up doing was transferring all object properties into a regex string and then matching based on that.

# jquery - js setHours - 倒计时参数格式

> ID：11508535
> 
> 赞同：1
> 
> 时间：2012-07-16T16:29:16.900
> 
> 标签：jquery, time, countdown

我正在尝试修改脚本以每 5 分钟运行一次倒计时。目前，getCountDown() 函数设置为每 12 小时倒计时一次。我似乎无法弄清楚如何修改此时间格式以每 5 分钟倒计时一次。我需要更改的功能在这里

```
function getCountDown() {
var until = getGMT();
until.setHours(until.getHours() < 12 ? 12 : 24, 0, 0, 0); // Next midday or midnight
return until;

function getGMT() {
var now = new Date();
now.setMinutes(now.getMinutes() + now.getTimezoneOffset() - 0 * 60); // GMT is UTC-0
return now; 
```

}

我的 js 技能非常有限，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:57:22.910

注意：这个答案是为了引导发帖者找到解决方案和更好地理解JS，而不是给出解决方案。

当前代码的工作方式是首先获取一个日期对象，然后将该对象的时间设置为 24:00（下一个午夜）或 12:00（下一个中午）。它通过检查时间的当前小时值来解决这个问题（<12 表示接下来是中午，接下来是午夜）。然后它返回新修改的日期对象，显示我认为倒计时设计运行到的日期。

所以问题的核心是你需要返回一个不同的日期对象，这意味着你想将分钟设置为你选择的东西（秒和毫秒设置为 0）。

对于您想要做的事情，您可能希望使用 Date 对象上的 getMinutes 和 setMinutes 函数来检查当前日期，然后设置适当的分钟（以及秒和毫秒值）。当然，如果您的当前时间是 01:59，那么您可能需要更改小时以提供 02:00，因此您实际上可能仍想使用 setHours（因为这确实允许您设置小时和分钟）。

计算出你的新分钟值是你可以做的事情。您只需要四舍五入到最接近的 5，并适当处理上述情况，您需要四舍五入到一个小时。

可以在 msdn 站点上找到有关上述方法的文档：

*   [设置小时](http://msdn.microsoft.com/en-us/library/f4a5xhxy%28v=vs.94%29)
*   [获取时间](http://msdn.microsoft.com/en-us/library/815z9tc9%28v=vs.94%29)
*   [获取分钟](http://msdn.microsoft.com/en-us/library/t919zcb7%28v=vs.94%29)
*   [设置分钟](http://msdn.microsoft.com/en-us/library/3sbd2ey3%28v=vs.94%29)

**编辑以添加一些代码**

```
var hours = until.getHours();
var minutes = until.getMinutes();
var targetMinutes = Math.ceil((minutes+1)/5)*5;
if (targetMinutes==60)
{
    targetMinutes = 0;
    hours = hours+1;
}

until.setHours(hours, targetMinutes, 0, 0); 
```

您可能能够更有效地编写上述内容，并且您可能还需要检查它在午夜等边界周围的作用（它似乎有效，但您应该始终彻底测试代码）。希望你能明白它在做什么。:)

# wpf - WPF 列表框和 MVVM 绑定

> ID：11508536
> 
> 赞同：3
> 
> 时间：2012-07-16T16:29:20.643
> 
> 标签：wpf, listbox, datatemplate, datacontext, itemssource

我在 C# 中关注 MVVM 并尝试在列表框中显示视图。

我正在设置列表框项目源（在代码中，而不是在绑定和使用 viewmodels 集合中），然后将数据模板设置为我在 xaml 中的视图。我遇到的问题是我的视图总是加载它的默认构造函数值，如果我从视图中删除数据上下文但是它加载得很好。

下面是我在 xaml 中创建的列表框

```
<ListBox Name="lbCatalogues" HorizontalContentAlignment="Stretch">
     <ListBox.ItemTemplate>
         <DataTemplate>
              <view:CatalogueRowView/>
          </DataTemplate>
      </ListBox.ItemTemplate>
</ListBox> 
```

这是我认为的xaml。如果我删除 DataContext 它可以工作

```
<UserControl.DataContext>
    <model:CatalogueModel />
</UserControl.DataContext>

    <Grid Name="Container" >
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="50" />
        <ColumnDefinition Width="100" />
        <ColumnDefinition Width="100" />
        <ColumnDefinition Width="1*" />
        <ColumnDefinition Width="40" />
    </Grid.ColumnDefinitions>
    <!-- Catalogue_ID, UploadedTime, Client_ID, Name, Desc, Filesize -->
    <Label Name="lblCatalogueID" Content="{Binding Path=CatalogueID}" Grid.Column="0"/>
    <Label Name="lblUploadedTime" Content="{Binding Path=UploadedTime}" Grid.Column="1"/>
    <Label Name="lblCatalogueName" Content="{Binding Path=Name}" Grid.Column="2"/>
    <Label Name="lblCatalogueDescription" Content="{Binding Path=Description}" Grid.Column="3"/>
    <Label Name="lblFilesize" Content="{Binding Path=Filesize}" Grid.Column="4"/>
    <Grid/> 
```

这是我设置列表框 ItemSource 的代码：

`lbCatalogues.ItemsSource = catalogueViewModel.Records;`

我的问题是如何让视图在列表框中正确加载，以便列表框中的每个项目都有一个链接到该列表框 Itemsource 的 DataContext？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:10:49.727

您已经知道答案：只需`<UserControl.DataContext>`从您的`UserControl`

您告诉您`UserControl`使用 的新实例`CatelogueModel`，`DataContext`这会覆盖`DataContext`您使用`UserControl`. 有关更多信息，请参阅 MSDN 的[Dependency Property Precedence列表](http://msdn.microsoft.com/en-us/library/ms743230.aspx)

我不建议将`DataContext`内部设置为`UserControl`. 它与 WPF 的工作方式背道而驰，因为它具有单独的 UI 和数据层，并且对于任何尝试使用您的`UserControl`

至于您关于链接到 ItemsSource 的 ListBox 中的每个项目的问题，DataTemplates 只是告诉 WPF 如何绘制对象。对象背后的数据仍然存在。

例如，您的 ListBox 包含一个`Record`对象列表，并且您`DataTemplate`告诉 用`ListBox`绘制这些记录中的每一个`CatelogueRowView`。背后的实际数据`CatelogRowView`仍然是您的数据对象`catelogueViewModel.Records`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:37:45.727

> lbCatalogues.ItemsSource = catalogueViewModel.Records; 而不是这个简单地将 ListBox 的 ItemsSource 绑定为 xaml 中的 ItemsSource="{Binding Records}" 。我希望这将有所帮助。

# ios - 滚动经过某个点时的 Uitableview

> ID：11508542
> 
> 赞同：0
> 
> 时间：2012-07-16T16:29:43.717
> 
> 标签：ios, uitableview, scroll

我基本上已经浏览了每一个堆栈溢出问题，但我找不到答案。似乎没有一个答案有效。

我正在编写一个应用程序，其中包含一个 tableview，一个 uitableview 作为子视图。uitableview 是连接到一个名为 xvalues 的类的数据源和委托，该类是 uitableviewcontroller 的子类。我也有一堂课，我在其中加载了一个自定义的 uitableviewcell。这一切都不会导致任何错误。

这是我的 uitableview 代码，在 xvalues 中：

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
    {
        // Return the number of sections.
        return 1;
    }

    - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
    {
        // Return the number of rows in the section.
        return 1;
    }

    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        tableviewcell *cell = [[tableviewcell alloc]initWithFrame:CGRectZero];

        return cell;
   }
    - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
    {
        // Navigation logic may go here. Create and push another view controller.
        /*
         <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
         // ...
         // Pass the selected object to the new view controller.
         [self.navigationController pushViewController:detailViewController animated:YES];
         [detailViewController release];
         */
    } 
```

我删除了一些注释掉的方法，例如可以在索引路径编辑行和提交编辑样式。

在 cellforrowatindexpath 中，tableviewcell 是我的自定义单元格类。

由此，当我运行我的代码时，它会加载我的 uitableview，其中包含 1 个单元格和我的自定义单元格。但是，现在，如果我单击并拖动，它可以拖动大约一英寸，然后突然崩溃并出现错误：

```
2012-07-16 12:14:16.957 spreadsheet[68717:f803] -[__NSCFString tableView:cellForRowAtIndexPath:]: unrecognized selector sent to instance 0x6894400
2012-07-16 12:14:16.960 spreadsheet[68717:f803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString tableView:cellForRowAtIndexPath:]: unrecognized selector sent to instance 0x6894400'
*** First throw call stack: blah blah blah 
```

当我单击该行时也会发生这种情况，但我认为这是因为我在索引路径方法中确实选择了行。

如果有人可以帮助我，那将非常有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:54:51.570

您的表视图控制器正在被释放。确保您在创建实例的任何地方都保留了您的`xvalues`实例（或将其分配给`strong`某物上的某个属性，例如您的应用程序委托）。

# arrays - char 数组的 armv5tejl 编译器问题

> ID：11508549
> 
> 赞同：1
> 
> 时间：2012-07-16T16:29:58.503
> 
> 标签：arrays, compiler-construction, segmentation-fault, arm

我正在开发一个使用以下规格运行的嵌入式项目：

**# unname -a**

Linux FFxAV 2.6.30.10 #mvl-avb-0.6 Thu Jun 28 17:55:44 EDT 2012 armv5tejl GNU/Linux

**# 猫 /proc/cpuinfo**

处理器：ARM926EJ-S rev 5 (v5l)

BogoMIPS : 159.74

特点：swp half fastmult edsp java

CPU实现者：0x41

CPU架构：5TE

CPU变体：0x1

CPU部分：0x926

CPU 修订版：5

**$ /usr/local/arm-2007q3/bin/arm-none-linux-gnueabi-gcc --version**

arm-none-linux-gnueabi-gcc (CodeSourcery Sourcery G++ Lite 2007q3-51) 4.2.1

* * *

我正在编译 lldpd (0.6) 以在该平台上使用，并发现了一些新的有趣的方法来使我的代码段错误。

我遇到的问题与 char 数组的分配有关。

如果我以这种方式分配：

字符 * 选择；opts = (char*)malloc(sizeof(char) * 50);

代码正常运行（实际上在以后的调用中会出现段错误，但我们不要停留）。

但是，如果我像这样进行分配：

字符选择[49]；

在我的任何调试甚至打印之前代码段错误。这一切都发生在 main 方法的顶部。

```
 5 int main(int argc, char ** argv){ 
  6 
  7     fprintf(stderr, "%d\n", __LINE__);
  8     char bopts [50] = "H:vhkrdxX:m:4:6:I:C:p:M:P:S:i@                    ";
  9     bopts[10] = 'g';
 10 } 
```

在一个很小的测试程序中运行良好，但是

```
 1034     char opts [51] = "H:vhkrdxX:m:4:6:I:C:p:M:P:S:i@                    "; 
```

lldpd.c 中的段错误

我继续从每个分配中拉出程序集：

从简单的测试程序（功能）

```
107     char bopts [50] = "H:vhkrdxX:m:4:6:I:C:p:M:P:S:i@                    ";
108     8424:   e59f3044    ldr r3, [pc, #68]   ; 8470 <main+0x78>
109     8428:   e24b2036    sub r2, fp, #54 ; 0x36
110     842c:   e3a0c032    mov ip, #50 ; 0x32
111     8430:   e1a00002    mov r0, r2
112     8434:   e1a01003    mov r1, r3
113     8438:   e1a0200c    mov r2, ip
114     843c:   ebffffba    bl  832c <_init+0x44> 
```

来自 lldpd.c

```
5061     char opts [51] = "H:vhkrdxX:m:4:6:I:C:p:M:P:S:i@                    ";
5062     d414:   e59f3918    ldr r3, [pc, #2328] ; dd34 <lldpd_main+0x9d4>
5063     d418:   e51b20bc    ldr r2, [fp, #-188]
5064     d41c:   e0823003    add r3, r2, r3
5065     d420:   e24b2043    sub r2, fp, #67 ; 0x43
5066     d424:   e3a0c033    mov ip, #51 ; 0x33
5067     d428:   e1a00002    mov r0, r2
5068     d42c:   e1a01003    mov r1, r3
5069     d430:   e1a0200c    mov r2, ip
5070     d434:   ebfff229    bl  9ce0 <_init+0x344> 
```

到目前为止，我看不出这里有什么问题。

当在堆而不是堆栈上分配数组时，程序在尝试在堆栈上分配 sockaddr_un 结构时会出错。

来自 un.h

```
8  struct sockaddr_un {
9      __kernel_sa_family_t sun_family; /* AF_UNIX */
10     char sun_path[UNIX_PATH_MAX];   /* pathname */
11 }; 
```

我的假设是这是同一个堆栈数组问题，但我很难弄清楚到底是什么。

无论如何，感谢您的意见或建议。这已经让我发疯了几天了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:57:59.150

看起来编译器将堆栈变量对齐以在对齐的位置*结束*（参见`sub r2, fp, #67`说明）。这是非常奇怪的 IMO，但可能是段错误的解释（尽管我不确定为什么任何代码都会使用字长访问 char 数组）。如果您可以显示崩溃的确切位置和调用堆栈，它可能会变得更清晰一些。

我认为最简单的解决方案是升级到更新的工具链（2007 年相当旧），看看它是否效果更好；如果不是，请尝试确保所有本地变量的大小都对齐到 4 个字节。

# regex - 包含子字符串的前 5 个单词

> ID：11508557
> 
> 赞同：1
> 
> 时间：2012-07-16T16:30:15.837
> 
> 标签：regex

我尝试为 Mongo DB 查询编写正则表达式。我需要获取标题前 5 个单词包含“foo”的所有帖子。

例如

```
"It is a foo day" //true

"I try to find word foo" //false 
```

现在我有`'/^((\w+\s+){,5})\bfoo/i'`，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:35:19.620

试试这个：

```
/^(((\w+\s+){,4})foo)(?!\w)/i 
```

我将 5 降为 4 以仅匹配前 4 个单词及其后续空格。由于空格是事先捕获的，所以 \b 是不必要的。然后找到foo。之后，我们只想匹配 'foo' 而不是 'foot' 或 'food'，所以我们对单词字符进行否定前瞻。

这是一个显示有效案例的网站：[http ://rubular.com/r/3TQiR3pvku](http://rubular.com/r/3TQiR3pvku)

希望这可以帮助！

# c++ - 将指针从一种基本类型转换为另一种

> ID：11508558
> 
> 赞同：9
> 
> 时间：2012-07-16T16:30:20.267
> 
> 标签：c++, pointers

-编辑-

感谢您的快速响应，我的代码遇到了非常奇怪的问题，我将演员表更改为 dynamic_cast 并且现在可以正常工作

-原帖-

将一个基类的指针转换为另一个基类是否安全？稍微扩展一下，我在下面的代码中标记的指针不会导致任何未定义的行为吗？

```
class Base1
{
public:
   // Functions Here
};

class Base2
{
public:
   // Some other Functions here
};

class Derived: public Base1, public Base2
{
public:
  // Functions
};

int main()
{
  Base1* pointer1 = new Derived();
  Base2* pointer2 = (Base2*)pointer1; // Will using this pointer result in any undefined behavior?
  return 1;
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T16:32:57.753

> 使用这个指针会导致任何未定义的行为吗？

是的。C 风格的演员表只会尝试以下演员表：

*   `const_cast`
*   `static_cast`
*   `static_cast`， 然后`const_cast`
*   `reinterpret_cast`
*   `reinterpret_cast`， 然后`const_cast`

它会使用`reinterpret_cast`并做错事。

如果`Base2`是多态的，即有`virtual`函数，这里正确的转换是`dynamic_cast`.

```
Base2* pointer2 = dynamic_cast<Base2*>(pointer1); 
```

如果它没有虚函数，你不能直接做这个转换，需要`Derived`先转换。

```
Base2* pointer2 = static_cast<Derived*>(pointer1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:33:29.867

您应该使用`dynamic_cast`运算符。如果类型不兼容，此函数将返回 null。

# macos - 如何在 Mac OSX 上以 root 身份启动 Aptana Studio 3？

> ID：11508561
> 
> 赞同：1
> 
> 时间：2012-07-16T16:30:27.730
> 
> 标签：macos, eclipse-plugin, aptana, pydev

我以非 root 用户身份在我的 Mac Book OS 10.6 上安装了 Aptana Studio 3。我的目标是使用 Aptana Studio 开发 Python 应用程序。看到它的潜力，我决定使用 Aptana / Pydev 来玩转网络应用程序。令我沮丧的是，我无法打开 TCP 端口。无论我做什么，我都无法让 Aptana 以 root 身份打开。我会注意到的第一件事是默认工作区位于非root 用户的主目录中。要验证，即 os.getuid() 总是非零。当我在 Aptana 中运行 test-script.py 并尝试打开 TCP 端口时，它会遇到权限错误。但是，我从终端 shell 启动“sudo python2.7 test-script.py”没有任何问题。我试过以下方法无济于事：

1.  获得 root 访问权限“su”后，然后“打开 /Applications/Aptana\ Studio\ 3/.... .app”。"import os", "os.getuid()" 结果非零。
2.  获得 root 访问权限“su”后，然后“hdiutil mount Aptana_Studio_3_Setup.dmg”和“open /Volume/Aptana\ Studio\ 3/.....app”。"import os", "os.getuid()" 结果非零。
3.  注意到“env”输出“USER=nonroot”，我在“su”之后尝试了“export USER=root”，并重复了第 1 步和第 2 步。结果相同。
4.  在“sudo chown root test-script.py”和“sudo chmod a+s test-script.py”之后，重复步骤 1 和 2。结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T05:54:29.470

我的错误是使用 /usr/bin/open 命令打开应用程序。如果我输入了“sudo /Applications/MyAppName.app/Contents/MacOS/MyApp”，它会自动工作并且似乎已经解决了我的问题。

# c# - 更新部分发生后列表被删除

> ID：11508564
> 
> 赞同：1
> 
> 时间：2012-07-16T16:30:37.290
> 
> 标签：c#, asp.net, .net, global-variables

我有一个在 ASP.NET 网页更新面板中引用的全局变量。以下是更新面板中发生的情况：

```
 accidentListType.Add(Convert.ToString(AccidentDescription.SelectedItem));
        if (Atfault.Checked)
        {
            accidentAtFault.Add("True");
        }
        else accidentAtFault.Add("False");
        DateTime newDate = new DateTime(Convert.ToInt32(accidentyear.Text), Convert.ToInt32(accidentmonth.Text), 1);
        accidentListDate.Add(newDate);
        TestAccidentLabel.Text = "Success! " + newDate.ToString(); 
```

基本上，每次单击按钮时，列表都会获得另一个添加的成员。但是每次运行代码时，新索引都会神秘地被删除，所以当我将所有意外添加到数据库时，并没有添加任何意外。而且我不能动态添加它们，因为事故数据库的输入之一是来自另一个表的身份，我在创建表时提取它，所以无论如何我都必须添加它们。

任何人都可以帮忙吗？PS这是我第一次发帖，如有乱七八糟的地方请见谅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:54:42.727

您缺少两件事。尽管您的列表是全局的，但在每次请求之后页面对象都会被销毁，除非您将列表保留在 Session 中，否则这些值不会持续存在。此外，您必须重用您在会话中保存的列表来添加任何新值。执行以下操作。

```
//at the start of block
//check if there is anything in Session
//if not, create a new list
if(Session["accidentListType"] == null)
   accidentListType = new List<string>();
else //else a list already exists in session , use this list and add object to this list
  accidentListType = Session["accidentListType"] as List<string>;

//do your processing, as you are doing

//and at the end of bloack store the object to the session
Session["accidentListType"] = accidentListType 
```

# css - -webkit-overflow-scrolling: touch -- 动态注入容器时的奇怪行为

> ID：11508566
> 
> 赞同：0
> 
> 时间：2012-07-16T16:30:41.093
> 
> 标签：css, ios, webkit, mobile-safari

在动态注入具有 css 属性的容器时，我遇到了一个非常奇怪的行为，`-webkit-overflow-scrolling`并认为我会询问您的想法/想法。

通过 AJAX，我正在查询其他数据，并在处理后将其添加到 DOM。但是，当第一次访问页面（清除缓存）时，容器添加得很好，但我无法滚动！通过移动 safari 刷新页面会重新加载所有内容，然后容器突然滚动......

没有涉及额外的 JS，所以我想知道为什么它会在第二次加载页面时滚动……有人知道为什么会这样吗？

多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:35:12.217

可能是因为页面尚未适应新内容，您可以只添加`overflow-y: scroll`要添加内容的元素，以便它始终滚动。或者在添加新内容时添加它。

# python - 存储保存的列表时出现 Python MemoryError

> ID：11508570
> 
> 赞同：0
> 
> 时间：2012-07-16T16:30:52.980
> 
> 标签：python, parsing, bioinformatics

我是 python 新手，所以如果这个例子是微不足道的，我深表歉意。

我正在尝试编写一个简单的脚本，它将两个大型数据文件（每个约 40gb）的一部分粘贴并提取到一个格式稍有改变的结果文件中。我最初尝试使用 readlines()，但它会将所有文件读入内存，而我们的实例只有 28gb 的内存。使用 sizehint 参数仅解析文件的一部分。

我现在正在遍历文件。问题是我将文本解析的输出存储在三个变得相当大的列表中，使可用内存黯然失色。我认为这只会切换到使用交换，这很好，但它只是以“MemoryError”退出。

这适用于小样本文件，但会影响我们的实际数据。

剧本：

```
import sys

a = []
b = []
c = []

file1 = open(sys.argv[1],"r")
for line in file1:
    if '@' in line:
        a.append(line.lstrip('@').rstrip('\n'))
        b.append(file1.next().rstrip('\n'))
file1.close()

file2 = open(sys.argv[2],"r")
for line in file2:
    if '@' in line: 
        c.append(file2.next().rstrip('\n'))
file2.close()

file3 = open(sys.argv[3],"w")
for i in xrange(len(a)):
    file3.write("".join([">",a[i],'\n',b[i],":",c[i],"\n"])) 
```

我在网上找到的建议创建某种数据库来存储变量，但这不是必需的。你有什么想法我应该如何处理这个？

为了完整起见，这就是我想要做的（来自我们的示例测试数据：

```
file1: 

@Read.Salmonella_paratyphi_A_chromosome.29004.4835/1
TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACKIPPTCGTAG
+
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

file2:

@Read.Salmonella_paratyphi_A_chromosome.29004.4835/1
TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACAAACGATTCT
+
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

file3 (output):

>Read.Salmonella_paratyphi_A_chromosome.29004.4835/1
TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACKIPPTCGTAG:TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACAAACGATTCT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:49:59.593

`a`您可以在解析文件时写入文件，而不是将文件解析为数组（`b`和`c`）吗？

像这样的伪代码：

```
def get_line_with_at(a):
     while a:
         line = a.readline()
         if "@" in line:
             return line.strip()

# Open all file handles
a, b, c = [open(sys.argv[x + 1]) for x in range(3)]
out = open(sys.argv[4])

while a and b and c:
    # Repeat until a, b, and file handles are exhausted
    chunk1 = get_line_with_at(a)
    chunk2 = b.next().strip()
    chunk3 = get_line_with_at(c)

     out.write(
         ">%s\n%s:%s\n" % (chunk1, chunk2, chunk3)) 
```

这样你应该只需要很少加载到内存中（理论上 4 个文件句柄和当前行的内容）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:51:42.013

我自己没有尝试过，但似乎以下应该有效：

```
file1 = open(sys.argv[1],"r")
file2 = open(sys.argv[2],"r")
file3 = open(sys.argv[3],"w")

for line1 in file1:
    if '@' in line1:  # line1.startswith('@') is probably better here
        a=line1.lstrip('@').rstrip('\n')
        b=file1.next().rstrip('\n')
        for line2 in file2:
            if '@' in line2:
                c=file2.next().rstrip('\n')
                break
        file3.write(">%s\n%s:%s\n"%(a,b,c))

file1.close()
file2.close()
file3.close() 
```

在这种情况下，每个文件一次只在内存中保留一行……这应该没问题，除非文件的*行很长*；^）。

此外，由于您使用`lstrip`的是 '@' 字符，因此您可能需要考虑使用`if line.startswith('@')`而不是`if '@' in line`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:57:07.373

这是我的[第二个，更紧凑的]努力：

```
import sys
import itertools

def reader(fileobj, yield_at_line=False):
    for line in fileobj:
        if line.startswith('@'):
            at_line = line.lstrip('@').rstrip('\n')
            next_line = fileobj.next().rstrip('\n')
            yield (at_line, next_line) if yield_at_line else next_line

with open(sys.argv[1]) as file1, open(sys.argv[2]) as file2, open(sys.argv[3], "w") as file3:
    first = reader(file1, yield_at_line=True)
    second = reader(file2)
    for (a,b), c in itertools.izip(first, second):
        file3.write('>{}\n{}:{}\n'.format(a, b, c)) 
```

这使

```
~/coding$ cat file1
@Read.Salmonella_paratyphi_A_chromosome.29004.4835/1
TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACKIPPTCGTAG
+
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

~/coding$ cat file2
@Read.Salmonella_paratyphi_A_chromosome.29004.4835/1
TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACAAACGATTCT
+
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

~/coding$ python simulwork.py file1 file2 file3
~/coding$ cat file3
>Read.Salmonella_paratyphi_A_chromosome.29004.4835/1
TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACKIPPTCGTAG:TCGTGTACAGCATTCTTTATAGTGGAACGGTGACCGTACCGCAAAGCTGCGAAATCAACGCCGGACAAACGATTCT 
```

# jquery - CSS：如何在不使用表格的情况下链接元素的宽度

> ID：11508572
> 
> 赞同：2
> 
> 时间：2012-07-16T16:30:59.580
> 
> 标签：jquery, css

使用 3 级深度的嵌套 UL 制作树形菜单。默认情况下，底部 2 个级别是隐藏/折叠的。底部的第 3 级显示了“左”与“右”值的比较。我想让所有的“左”跨度相同，但不是固定宽度。我考虑了一个 jquery 循环来查找所有此类跨度的最大宽度，然后返回并将它们全部设置为该最大宽度。但是当隐藏时，jquery width() 总是 0。所以我必须先展开整个列表，做这个工作，然后再次折叠它。即使那样，通过 jquery 设置宽度似乎也没有做任何事情。跨度有一个 style="width: 93px;" 在它们中，但实际宽度没有改变。是否有任何 CSS2/3 方式来链接这些元素的宽度？还是更好的javascript方式？

```
<ul class="hidden">
  <li>
    <span class="left">cat</span>
    &hArr;
    <span class="right">dog</span>
  </li>
  <li>
    <span class="left">bird</span>
    &hArr;
    <span class="right">horse</span>
  </li>
  <li>
    <span class="left">some long text</span>
    &hArr;
    <span class="right">more long text</span>
  </li>
</ul>

span.left{text-align:right;}
ul.hidden{display:none;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:37:55.027

您可以使用 CSS 属性显示为表格单元格（例如[http://ajaxian.com/archives/display-table](http://ajaxian.com/archives/display-table)），但实际上，您描述的是语义上的表格。为什么不只使用表格标记？它没有被诅咒或任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:36:12.190

我建议将 left spans 更改为 div 并将“left”类的宽度设置为： `min-width:100px;`例如，如果它需要更多空间，它将动态扩展超过 100px。更改标签的原因是因为跨度标签通常在您想要添加文本样式时很有用，但在您想要应用宽度、高度、边距、填充等时却不是很有用......这就是我根据我的意见虽然经验。

* * *

***编辑***

**可能的解决方案：**为隐藏的ul设置一个边框并在其上使用min-width属性，整个列表的宽度将根据最大的列表项而变化。

# java - Java REST 应用程序的 HTTP 状态 500

> ID：11508575
> 
> 赞同：0
> 
> 时间：2012-07-16T16:31:07.543
> 
> 标签：java, rest, netbeans, amazon-web-services

尝试访问我的 EC2 服务器（使用 Elastic Beanstalk 部署）上的 .wadl 文件时，我不断收到此错误。任何想法这意味着什么/如何解决它？

类型异常报告

信息

描述 服务器遇到一个内部错误 () 阻止它完成这个请求。

例外

```
javax.servlet.ServletException: Servlet.init() for servlet ServletAdaptor threw exception
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:680)
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:298)
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
java.lang.Thread.run(Thread.java:636)

 root cause

java.lang.NoClassDefFoundError: javax/persistence/criteria/Expression
java.lang.Class.getDeclaredConstructors0(Native Method)
java.lang.Class.privateGetDeclaredConstructors(Class.java:2406)
java.lang.Class.getConstructors(Class.java:1476)
com.sun.jersey.server.impl.modelapi.annotation.IntrospectionModeller.createResource(IntrospectionModeller.java:111)
com.sun.jersey.server.impl.application.WebApplicationImpl.getAbstractResource(WebApplicationImpl.java:745)
com.sun.jersey.server.impl.application.WebApplicationImpl.createAbstractResourceModelStructures(WebApplicationImpl.java:1522)
com.sun.jersey.server.impl.application.WebApplicationImpl._initiate(WebApplicationImpl.java:1295)
com.sun.jersey.server.impl.application.WebApplicationImpl.access$700(WebApplicationImpl.java:169)
com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:775)
com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:771)
com.sun.jersey.spi.inject.Errors.processWithErrors(Errors.java:193)
com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:771)
com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:766)
com.sun.jersey.spi.container.servlet.ServletContainer.initiate(ServletContainer.java:488)
com.sun.jersey.spi.container.servlet.ServletContainer$InternalWebComponent.initiate(ServletContainer.java:318)
com.sun.jersey.spi.container.servlet.WebComponent.load(WebComponent.java:609)
com.sun.jersey.spi.container.servlet.WebComponent.init(WebComponent.java:210)
com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:373)
com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:556)
javax.servlet.GenericServlet.init(GenericServlet.java:160)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:680)
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:298)
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
java.lang.Thread.run(Thread.java:636)
root cause

 java.lang.ClassNotFoundException: javax.persistence.criteria.Expression
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1688)
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1533)
java.lang.Class.getDeclaredConstructors0(Native Method)
java.lang.Class.privateGetDeclaredConstructors(Class.java:2406)
java.lang.Class.getConstructors(Class.java:1476)
com.sun.jersey.server.impl.modelapi.annotation.IntrospectionModeller.createResource(IntrospectionModeller.java:111)
com.sun.jersey.server.impl.application.WebApplicationImpl.getAbstractResource(WebApplicationImpl.java:745)
com.sun.jersey.server.impl.application.WebApplicationImpl.createAbstractResourceModelStructures(WebApplicationImpl.java:1522)
com.sun.jersey.server.impl.application.WebApplicationImpl._initiate(WebApplicationImpl.java:1295)
com.sun.jersey.server.impl.application.WebApplicationImpl.access$700(WebApplicationImpl.java:169)
com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:775)
com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:771)
com.sun.jersey.spi.inject.Errors.processWithErrors(Errors.java:193)
com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:771)
com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:766)
com.sun.jersey.spi.container.servlet.ServletContainer.initiate(ServletContainer.java:488)
   com.sun.jersey.spi.container.servlet.ServletContainer$InternalWebComponent.initiate(ServletContainer.java:318)
com.sun.jersey.spi.container.servlet.WebComponent.load(WebComponent.java:609)
com.sun.jersey.spi.container.servlet.WebComponent.init(WebComponent.java:210)
com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:373)
com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:556)
javax.servlet.GenericServlet.init(GenericServlet.java:160)
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
org.apache.catalina.valves.RemoteIpValve.invoke(RemoteIpValve.java:680)
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:928)
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:987)
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:539)
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:298)
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
java.lang.Thread.run(Thread.java:636) 
```

note Apache Tomcat/7.0.23 日志中提供了根本原因的完整堆栈跟踪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:47:05.300

当服务器中出现某种错误时，通常会抛出错误代码 500，
例如未捕获的异常。
我提到了这个例子，因为这是你的情况，请参阅日志的这一部分：

```
java.lang.ClassNotFoundException: javax.persistence.criteria.Expression org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1688) org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:153 
```

您可能在代码中使用了 JPA，但 JPA jar 不在您的 WEB-INF/lib 目录中。
请检查您的 webapp 结构、修复和重新部署。

# javascript - Javascript查找特定文本

> ID：11508577
> 
> 赞同：-3
> 
> 时间：2012-07-16T16:31:24.273
> 
> 标签：javascript, jquery

我有一个表，其值是从数据库中显示的，但在第 8 行第二列显示一个值，即 8，它是加拿大的一个省，即“安大略省”，现在我想要省的名称而不是值。这是旧站点使用的，因此，我不想更改数据库中的数据，因为它的大小确实很大。我想使用 javascript，以便它只显示这个供用户阅读，而不是更改数据库中的值。

数据显示在表格中

```
<table>
<tr></tr>
 ...8th row<tr><td></td><td>Value lies here i.e. '8'</td></tr>
</table> 
```

这就是我想要的

如果值为“0”，则应显示“Alberta”

如果值为“1”不列颠哥伦比亚省

如果值为“2”马尼托巴

如果值为“3”新不伦瑞克

如果值为“4”纽芬兰

如果值为“5”新斯科舍省

如果值为“6”西北地区

如果值为“7”努纳武特

如果值为“8”安大略

如果值为“9”爱德华王子岛

如果值为“10”魁北克

如果值为“11”萨斯喀彻温省

如果值为“12”育空地区

“谢谢，但表单与显示值的页面不同”它应该使用 if else 语句，如果第 8 行第二列显示“8”，那么值应该显示为“安大略”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:34:32.717

您想像这样使用元素的[`selectedIndex`](https://developer.mozilla.org/en/XUL/Property/selectedIndex)属性：`select`

```
selectElement.options[selectElement.selectedIndex].innerText; 
```

[演示](http://jsfiddle.net/TLZTr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:34:32.823

简单的 ：）

```
$('option:selected').val(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:35:54.350

似乎是一个糟糕的解决方案，但是一个简单的选择器

```
var cell = $('#tableId tr:eq(7) td:eq(1)');
var txt = cell.text();
console.log(txt);
var selectOption = $("#selectId option").eq(parseInt(txt,10))
cell.text(selectOption.text()); 
```

编辑：

```
var provs = ["Alberta","British Columbia"...];
var cell = $('#tableId tr:eq(7) td:eq(1)');
var index = parseInt(cell.text());
cell.text(provs[index].text()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T16:37:11.513

如果您想使用纯 Javascript，这将起作用 -

假设您的选择元素的 id 是“myselect”

```
var name = document.getElementById('myselect').options[document.getElementById('myselect').selectedIndex].text; 
```

这会给你安大略而不是 8，这是它的价值。然后，您可以通过通常使用的任何方法将其插入数据库。

# java - java客户端服务器多线程，仅适用于一个连接

> ID：11508581
> 
> 赞同：2
> 
> 时间：2012-07-16T16:32:08.550
> 
> 标签：java, client-server

我做了我的客户端-服务器应用程序，但目前只有一个用户可以使用它。你能帮我如何让它为多个用户工作。我有以下功能： 每两分钟计数器开始减少。每个用户有 30 秒的时间连接到应用程序。每个连接的用户都应该看到相同的结果，他应该使用这些结果进行一些其他操作。我现在是通过这种方式做到的。不同情况下的代码并不那么重要。我需要一个建议如何使它作为代码的结构工作。提前致谢！

```
import java.net.*;
import java.io.*;

public class MultiServer {
    public static void main(String[] args) throws IOException {
        ServerSocket serverSocket = null;
        boolean listening = true;

        try {
            serverSocket = new ServerSocket(4444);
        } catch (IOException e) {
            System.err.println("Could not listen on port: 4444.");
            System.exit(-1);
        }

        while (listening)
        new MultiServerThread(serverSocket.accept()).start();

        serverSocket.close();
    }
}

import java.net.*;
import java.io.*;
import java.util.HashMap;

public class MultiServerThread extends Thread {
    private Socket socket = null;

    public MultiServerThread(Socket socket) {
        super("MultiServerThread");
    this.socket = socket;
    }

    public void run() {
        try {

            ObjectOutputStream toServer = new ObjectOutputStream(socket.getOutputStream());
            ObjectInputStream fromServer = new ObjectInputStream(socket.getInputStream());

            int userProcess = 0;
            Object data = 11111;
            boolean listening = true;

            CountDown c = new CountDown();
            int timeRemaining = 900;

            while (listening) {
                boolean send = true;
                Object ob;
                try {
                    ob = fromServer.readObject();
                    userProcess = Integer.parseInt(ob.toString());
                    HashMap<String,Integer> finalScores = new HashMap<String,Integer>();
                    if(userProcess == 0) {
                        timeRemaining = c.getRemainingTime();
                        int temp = 999;
                        while(timeRemaining-110>0) {
                            timeRemaining = c.getRemainingTime();
                            if(temp != timeRemaining) {
                                toServer.writeObject(timeRemaining-110);
                                toServer.flush();
                                temp = timeRemaining;
                            }
                        } 
                    } 
                    if(userProcess == 0 && timeRemaining-110 < 0) {
                        c = new CountDown();
                        send = false;
                    }

                    if(userProcess == 1) {   
                        BoardGeneraor board = new BoardGeneraor();
                        data = board.getBoard();
                    } 
                    if(userProcess == 2) {   
                        int score = (Integer)fromServer.readObject();
                        String username = (String)fromServer.readObject();
                        finalScores.put(username, score);
                        data = finalScores;
                        c = new CountDown();
                    }
                    if(send) {
                       toServer.writeObject(data);
                        toServer.flush();
                    } else {
                        toServer.writeObject("quit");
                        toServer.flush();
                    }
                } catch (ClassNotFoundException e) {
                    System.out.println(e);
                }
            }

            fromServer.close();
            toServer.close();
            socket.close(); 

        } catch(IOException e) {
             System.out.println(e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:34:25.283

我认为您的问题是您混淆了服务器和客户端，并将客户端和服务器代码放在同一个 Java 文件中。看起来您打算`MultiServerThread`成为客户端，因为它将套接字的输出流解释为“到服务器”，而套接字的输入流解释为“来自服务器”。但是，当您创建一个`MultiServerThread`with 时`serverSocket.accept()`，您将为其提供一个套接字，该套接字代表*服务器端与*一个客户端的连接。因此，返回的输出流`socket.getOutputStream()`表示从服务器*到客户端*的流。实际上应该`MultiServerThread`表示的是服务器与客户端通信的一个实例，而不是连接到服务器的客户端实例。

为了让客户端连接到您的服务器，您需要一个单独的 Java 文件，比如 Client.java，其中包含一个带有单独 main 方法的单独类。此类应使用`Socket(String host, int port)`构造函数打开与服务器的连接，并将该套接字的输入流视为来自服务器的输入流。这是一个简单的例子：

```
public class Client {

    public static void main(String[] args) {

        Socket serverConnection = null;

        try {
            serverConnection = new Socket("localhost", 4444);
        } catch(IOException e) {
            System.err.println("Could not connect to server");
            System.exit(-1);
        }

        try {
            ObjecttInputStream fromServer = new ObjectInputStream(serverConnection.getInputStream());
            Object ob = fromServer.readObject();
        } catch(IOException e) {
            System.err.println("Error reading from server");
        }

    }

} 
```

通过运行 MultiServer.class 文件启动服务器后，您可以通过运行 Client.class 文件启动客户端（在单独的窗口中，同时服务器仍在运行）。

# c# - 将到期日期设置为 .NET 输出（无硬件加密狗）

> ID：11508587
> 
> 赞同：0
> 
> 时间：2012-07-16T16:32:29.907
> 
> 标签：c#, .net, c#-4.0, .net-security

我对这个问题的第一个解决方案是使用 OS/BIOS 计时器并使用加密的日期文件检查它（见下面的伪代码）

```
public void CheckFrequently()
{ 
   DateTime registeredDate = ReadFromBiosOrOSTimer(); 
   DateTime readEncryptedDate = ReadFromEncryptedFile(); 

   if(registeredDate >= readEncryptedDate) 
   { 
      ShowExpireDateForm();
      CloseProgram();
   }
} 
```

在这种情况下，很明显用户可以轻松更改 OS/BIOS 计时器，而我的方法不起作用。

我的问题是：

1.  有什么方法可以解决用户操作系统/BIOS 定时器更改问题？
2.  有没有更好的方法来为 .Net 项目设置到期日期？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:38:01.103

（我的回答是假设你想要一个“到期”的某种程序。）

最终的老大哥答案是从外部来源（例如 Web 服务）检索受信任的时间。当然，连通性（或缺乏连通性）可能会使这成为不可能。

除此之外，如果知道有人要欺骗时钟，他们很可能会在接近到期时做这件事，定期在某处写入当前时间的时间戳。如果您遇到检索（通过系统调用）时间小于最后一个时间戳的情况，则可能有人试图欺骗时钟，您可以使用适当的错误消息使会话/实例无效。一旦你检测到“过期”的情况，很容易拨动开关并拒绝继续运行。

**综上所述，像这样的对策很可能总是被足够坚定的对手击败。**

# zend-form - 选择元素的 zf2 注释

> ID：11508593
> 
> 赞同：4
> 
> 时间：2012-07-16T16:32:46.507
> 
> 标签：zend-form, zend-framework2

我对 zf2 注释有点困惑，我根据[本教程](http://mwop.net/blog/2012-07-02-zf2-beta5-forms.html)创建了一些元素：

```
/**
 * @Annotation\Attributes({"type":"text" })
 * @Annotation\Required(false)
 * @Annotation\Options({"label":"Cardholder's Name: *:"})
 */
protected $cardholder; 
```

对于简单的文本，一切正常，但在尝试创建选择元素时我被卡住了。

如果您知道任何教程或 github repo，请告诉我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T17:19:55.380

问题已经出现，因此要获得选择，您需要
添加验证和过滤示例

```
/**
* @Annotation\Attributes({"type":"text" })
* @Annotation\Options({"label":"Cardholder's Name: *:"})
* @Annotation\Required(false)
* @Annotation\Filters({"name":"StripTags"},{"name":"StringTrim"}}) 
* @Annotation\Validator({"name":"StringLength","options":{"min":"1", "max":"20"}})
*/

protected $cardholder;

/**
 * @Annotation\Type("Zend\Form\Element\Select")
 * @Annotation\Options({"label":"Description"})
 * @Annotation\Attributes({"options":{"1":"Visa","2":"Maestro"}})
 */
protected $cardType; 
```

并且在视野中

```
<dt><?php echo $this->formLabel($form->get('cardholder')); ?></dt>
<dd><?php 
echo $this->formInput($form->get('cardholder'));
echo $this->formElementErrors($form->get('cardholder'));
?></dd>

<dt><?php echo $this->formLabel($form->get('cardType')); ?></dt>
<dd><?php 
echo $this->formSelect($form->get('cardType'));
echo $this->formElementErrors($form->get('cardType'));
?></dd> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-19T23:05:04.927

尝试这个：

```
/**
 * @Annotation\Type("Zend\Form\Element\Select")
 * @Annotation\Required(false)
 * @Annotation\Options({"label":"Cardholder's Name: *:", "value_options":{"1":"VISA", "2":"MASTER CARD", "3":"AMERICAN EXPRESS"}})
 */
protected $cardholder; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-21T16:35:11.607

尝试这个

```
 /**
     * @Annotation\Type("Zend\Form\Element\Select")
     * @Annotation\Required({"required":"false" })
     * @Annotation\Filter({"name":"StringTrim"})
     * 
     *
     */ 
```

# grails - 使用静态主体调用 Grails 标记

> ID：11508600
> 
> 赞同：0
> 
> 时间：2012-07-16T16:33:01.000
> 
> 标签：grails, tags

如果我想使用[g.link 标签](http://grails.org/doc/2.0.x/ref/Tags/link.html)将文本“foo”链接到图书控制器的列表操作，我可以这样做：

```
<g:link action='list' controller='book'>foo</g:link> 
```

上面的代码显示了“标签语法”，但我怎样才能使用“方法调用语法”做同样的事情呢？我尝试了以下方法：

```
g.link(action: 'list', controller: 'book', {'foo'}) 
```

但它不起作用。问题是我不知道如何为参数传递一段静态文本`body`。在上面的示例中，我尝试将文本放入闭包中，但这不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:31:46.753

像这样：

```
g.link ([uri:'/'], {"hello"}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:24:21.763

如果代码例如在控制器内部，您可以使用：

```
link( controller:'book', action:'list' ) { 'foo' } 
```

不必使用“g”命名空间，它是自动注入的。

# javascript - 日期和时间脚本 - 即 vs ff

> ID：11508606
> 
> 赞同：0
> 
> 时间：2012-07-16T16:33:34.170
> 
> 标签：javascript, datetime

我下面的脚本在 ie 中工作，但在 Firefox 中我得到：

```
Mon, July 16th 2012 //this is ok

NaN:NaN:NaN (UTC +2) //but the time??? 
```

...

```
var weekdaystxt = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

function showLocalTime(container, servermode, offsetMinutes, displayversion) {
    if (!document.getElementById || !document.getElementById(container)) return
    this.container = document.getElementById(container)
    this.displayversion = displayversion
    var servertimestring = (servermode == "server-php") ? '<? print date("D, F jS Y H:i:s", time())?>' : (servermode == "server-ssi") ? '<!--#config timefmt="%B %d, %Y %H:%M:%S"--><!--#echo var="DATE_LOCAL" -->' : '<%= Now() %>'
    this.localtime = this.serverdate = new Date(servertimestring)
    this.localtime.setTime(this.serverdate.getTime() + offsetMinutes * 60 * 1000) //add user offset to server time 
    this.updateTime()
    this.updateContainer()
}
showLocalTime.prototype.updateTime = function() {
    var thisobj = this
    this.localtime.setSeconds(this.localtime.getSeconds() + 1)
    setTimeout(function() {
        thisobj.updateTime()
    }, 1000) //update time every second 
}
showLocalTime.prototype.updateContainer = function() {
    var thisobj = this
    if (this.displayversion == "long") this.container.innerHTML = '<? print date("D, F jS Y")?>'
    else {
        var hour = this.localtime.getHours()
        var minutes = this.localtime.getMinutes()
        var seconds = this.localtime.getSeconds()
        var ampm = (hour >= 12) ? "PM" : "AM"
        var dayofweek = weekdaystxt[this.localtime.getDay()]
        this.container.innerHTML = formatField(hour, 1) + ":" + formatField(minutes) + ":" + formatField(seconds) + " (UTC +2)"
    }
    setTimeout(function() {
        thisobj.updateContainer()
    }, 1000) //update container every second 
}

function formatField(num, isHour) {
    if (typeof isHour != "undefined") { //if this is the hour field 
        var hour = (num > 24) ? num - 24 : num
        return (hour == 0) ? 24 : hour
    }
    return (num <= 9) ? "0" + num : num //if this is minute or sec field 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:58:26.513

首先，这是您发布的代码的 jsFiddle，因此我们都可以看到发生了什么-

[http://jsfiddle.net/HjDds/](http://jsfiddle.net/HjDds/)

请注意，这是一个工作版本。问题在于 IE 和 Chrome 解析日期的方式不同。无论 <% Now() %> 以何种方式返回，Chrome 都不喜欢它，并且在创建新的 Date() 对象时无法解析。

您需要确保您的服务器发回的日期字符串的格式可以跨浏览器使用。

至于我的修复（尽管它不是真正的修复，因为您似乎想要服务器时间）是用 new Date() 替换您的 servertimestring 字符串中的 <%= Now() %>。我还添加了分号，因为我还有一堆额外的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:05:15.667

无效格式数据：2012 年 7 月 16 日星期一 17:02:32

PHP 使用 $_SERVER ['REQUEST_TIME'] 并乘以 1000。

这个会：

```
var servertimestring = (servermode == "server-php") ? '<?php echo $_SERVER['REQUEST_TIME']*1000;?>' : (servermode == "server-ssi") ? '<!--#config timefmt="%B %d, %Y %H:%M:%S"--><!--#echo var="DATE_LOCAL" -->' : '<%= Now() %>'; 
```

:)

# c++ - 右值到左值转换 Visual Studio

> ID：11508607
> 
> 赞同：10
> 
> 时间：2012-07-16T16:33:48.647
> 
> 标签：c++, visual-studio

在 Visual Studio 2012RC 中有一些非标准扩展。例如这段代码编译：

```
#include <string>

using namespace std;

void value(string& value)
{
    value = "some";
}

int main()
{
    value(string("nice"));
} 
```

并警告它是非标准扩展。所以，我想了解它是如何真实的以及代码如何转换（右值引用或带有 const_cast 的 const 引用）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T16:47:44.010

类类型的临时对象仍然是对象。它存在于内存中的某个地方，这意味着编译器能够附加对它的引用并没有什么不寻常的地方。在物理层面上，它是常量引用还是非常量引用都没有区别。换句话说，在这种情况下，语言限制纯粹是概念性的、人为的。编译器只是忽略了这个限制。这里没有必要“转换”任何东西。引用只是直接附加到对象上，无论该对象恰好位于何处。

基本上，对于一个为外部词提供访问其`this`指针值（或左值访问`*this`）的类，可以立即轻松地模拟行为

```
struct S {
  S& get_lvalue() { return *this; }
};

void foo(S& s);
...

foo(S().get_lvalue()); 
```

上面的代码是完全合法的，它可以绕过上述限制。您可以将 MSVC++ 行为视为与此等价。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T16:42:19.570

基本上，VS 会在某处分配空间并让引用指向它，*就好像*它是一个`const`没有常量的引用（或者在 C++11 中是一个右值引用）。

`/Za`您可以使用下面的（禁用语言扩展）编译器开关禁用此行为

> 属性 -> C/C++ -> 语言

如果我没记错的话。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T16:42:22.653

在标准 C++ 中，您不能将临时 (rvalue / `string("nice")`) 绑定到非常量引用 (lvalue)，但 microsoft 编译器允许这样做。警告告诉您代码由于扩展而正在编译，并且不会与任何其他编译器一起编译。

# vb.net - 在 vb.net 中的 browsercontrol 和 winform 应用程序之间传递数据/操作？

> ID：11508612
> 
> 赞同：1
> 
> 时间：2012-07-16T16:34:21.037
> 
> 标签：vb.net, winforms, webbrowser-control

我是一名网络开发人员，但我正在尝试为游戏模拟器编写前端。因为我熟悉 html/css/javascript，所以理想情况下我想用它来完成我的所有布局。我需要知道的是，这是否会成为一个热门话题。我需要做一些事情，比如当用户单击浏览器控件上的元素时，使表单代码基于特定路径启动某些东西。

这可能吗？如果是这样，这是一个可怕的想法吗？我现在应该停下来只使用表单设计器吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:53:35.637

这篇文章帮助了我： http: [//www.codeproject.com/Articles/35373/VB-NET-C-and-JavaScript-communication](http://www.codeproject.com/Articles/35373/VB-NET-C-and-JavaScript-communication)

具体来说：

> 在 form1（主表单）中添加导入语句，如 Imports System.Security.Permissions。向 form1 添加几个属性，例如：
> 
> ```
>  <PermissionSet(SecurityAction.Demand, Name:="FullTrust")> _
>     <System.Runtime.InteropServices.ComVisibleAttribute(True)> _
>     Public Class Form1
>     End Class 
> ```

然后

> **从 JavaScript 调用 VB.NET**
> 
> 继续上一个项目，在 form1 中添加以下代码行：
> 
> ```
>  Public Sub showVbHelloWorld()
>          MsgBox("Hello world")
>      End Sub 
> ```
> 
> 在您的 form1 加载事件中，添加这行代码 Me.WebBrowser1.ObjectForScripting = Me 这行代码的作用是，它将您的 form1 类公开给 HTML 页面上的 JavaScript。您可以公开任何类，只要将其对 COM 可见并将其权限设置为完全信任即可。
> 
> 在您的 HTML 页面中，添加一个 Button，并在其单击事件上调用此函数：
> 
> ```
>  <script type="text/javascript">
>        function showVbHelloWorld() {
>           window.external.showVbHelloWorld();
>        } 
>     </script> 
> ```

# android - 推送通知技术如何在 Android 上运行？

> ID：11508613
> 
> 赞同：247
> 
> 时间：2012-07-16T16:34:28.003
> 
> 标签：android, push-notification, polling

谷歌是如何实现他们的推送通知功能的？它是通过在后台运行的服务完成的轮询工作还是以不同的方式工作？

* * *

## 回答 #1

> 赞同：190
> 
> 时间：2012-07-16T16:47:40.907

从我在以色列举行的 Android 开发者大会上听到的消息：

在云 Google 服务器上只有一个 TCP 套接字以[接受模式等待。](https://www.ibm.com/support/knowledgecenter/en//SSLTBW_2.2.0/com.ibm.zos.v2r2.halc001/icvacc1.html)TCP 连接已由 Google Play 应用程序启动。这就是为什么必须在设备上安装 Google Play 才能使[Google Cloud Messaging (GCM)](https://developer.android.com/google/gcm/)（以前的 Android Cloud to Device Messaging Service - [C2DM](http://en.wikipedia.org/wiki/Android_Cloud_to_Device_Messaging_Service)）工作。

当这个 TCP 客户端套接字接收到一些消息时，该消息包含信息，例如它应该被寻址到的应用程序的包名称，当然还有数据本身。这些数据被解析并打包到一个[意图](http://developer.android.com/reference/android/content/Intent.html)中，该意图被广播并最终由应用程序接收。

即使设备的无线电状态变为“空闲”模式，TCP 套接字仍保持打开状态。应用程序不必运行即可接收意图。

更多信息请访问[http://developer.android.com/google/gcm/gcm.html](http://developer.android.com/google/gcm/gcm.html)

* * *

## 回答 #2

> 赞同：157
> 
> 时间：2014-05-12T08:35:41.407

Android 与 Google 的服务器保持一个活动连接，但它不会使用太多电力或数据，因为在某些东西向您手机上的应用程序发送 Google Cloud Messaging (GCM) 消息之前，不会沿着它发送任何流量。手机上只有一个连接，所有应用程序都使用：安装使用 GCM 的新应用程序不会增加任何额外负载。

GCM 的第一步是第三方服务器（例如电子邮件服务器）向 Google 的 GCM 服务器发送请求。然后，此服务器通过该开放连接将消息发送到您的设备。Android 系统查看消息以确定它是针对哪个应用程序，然后启动该应用程序。该应用必须已在 Android 上注册才能使用 GCM，并且必须具有相关权限。当应用程序启动时，它可能会立即使用消息中的数据创建一个通知。GCM 消息的大小非常有限，因此应用程序可能会打开与第三方服务器的正常连接以获取更多信息（例如，下载新电子邮件的标题）。

使用推送通知的优点是应用程序不必定期运行以检查新数据，从而节省电力和数据。拥有像 GCM 这样的中心化机制的好处是设备只需要一个开放的网络连接，而 Android GCM 系统是唯一需要保持运行的东西，而不是每个应用程序都必须在后台保持运行以保持自己的网络连接到自己的服务器。

取自：[Source](https://android.stackexchange.com/questions/40990/how-do-push-notifications-work) 另见[此处](http://developer.android.com/google/gcm/gcm.html)。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-07T13:32:15.457

您可以通过长轮询 tcp 连接自己在 android 上实现推送通知。但这将涉及维护一个额外的插座 => 电池消耗。或者，您可以使用警报管理器定期打开连接。

Google 可能会为所有 C2DM 推送通知打开一个套接字，因此它的电池效率更高。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-10-29T17:51:15.297

> 自 2018 年 4 月 10 日起，Google 已弃用 GCM。GCM 服务器和客户端 API 已弃用，最早将于 2019 年 4 月 11 日被删除。将 GCM 应用迁移到 Firebase Cloud Messaging (FCM)，它继承了可靠且可扩展的 GCM 基础架构以及许多新功能。

[https://firebase.google.com/docs/cloud-messaging/](https://firebase.google.com/docs/cloud-messaging/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T16:40:43.173

你是对的。谷歌有一项服务（GTalk Service），该服务在某些时间段内询问谷歌服务器。

# c - sysv共享内存，会自动销毁吗？

> ID：11508616
> 
> 赞同：4
> 
> 时间：2012-07-16T16:34:33.850
> 
> 标签：c, system, shared-memory, sysv

如果您不这样做，在 Unix 中分配的共享内存会自动销毁吗？

例如，一个进程创建了该段，另一个进程使用它。现在它们都因某种原因崩溃了，那段是否导致内存泄漏？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:42:39.740

一般不会。

如果您使用的是 SysV 共享内存（例如`shm_open`），则不需要。SysV IPC 原语都不会自行清理；您总是必须明确地清理它们，或者使用`ipcrm`. 这是我强烈建议不要使用它们的几个原因之一。

如果您要`mmap`ping 一个文件以获取共享内存，那么该文件显然不会自行消失。像任何其他文件一样，你必须明确地`unlink`让它消失。如果你已经这样做了，那么你就准备好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T21:58:23.000

这取决于您给予该细分市场的持久性。根据经验，如果您通过`shm_open`（或键）给它一个名称，它将是持久的。这表明它会在您关闭创建它的进程后持续存在，除非您以某种方式“删除”它，即执行`shm_unlink`. 这是您可以在完全不同的进程之间共享段的唯一方法。

所以如果你这样做，你真的必须小心清理东西。这种持久段的最佳策略是让所有进程最初打开一个文件描述符，然后在每个人连接后立即取消链接。该段将一直存在，直到它的最后一个文件描述符被关闭。

非持久段可以直接使用匿名映射`mmap`。随着您的流程不复存在，它们将消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:40:18.410

不可以。分配的共享内存段应该被明确地丢弃。

用于列出粉碎内存段和删除的有用命令行工具： `ipcs`和`ipcrm`. 最后一个可以用于ex。当所有使用它的程序都崩溃时删除一个段。

# ruby-on-rails - 您如何永久修改您正在定义的方法？

> ID：11508627
> 
> 赞同：1
> 
> 时间：2012-07-16T16:35:24.560
> 
> 标签：ruby-on-rails, ruby

我正在尝试使用“backwards_string！” 通过将偶数字符大写然后反转字符串来永久修改 String 对象。

```
class String
    def backwards_string!
        reverse!
        scan(/..?/).map(&:capitalize) * ''
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:45:11.157

您可以使用`replace`

```
class String
    def backwards_string!
        reverse!
        replace(scan(/..?/).map(&:capitalize) * '')
    end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:06:44.073

```
class String
    def backwards_string!
        length.times {|i| self[i] = self[i].upcase if i.even? }
        reverse!        
    end
end 
```

# c - 将套接字绑定到计算机的地址以进行侦听

> ID：11508634
> 
> 赞同：2
> 
> 时间：2012-07-16T16:36:04.537
> 
> 标签：c, sockets, unix-socket, getaddrinfo

我创建了旨在将新套接字绑定到计算机地址的代码，以侦听特定端口上的传入连接。我正在使用 getaddrinfo。这是最好的方法吗？将端口整数转换为字符串似乎毫无意义。有没有不需要 sprintf 的方法来做到这一点？

```
bool CBSocketBind(void * socketID,u_int16_t port){
    struct addrinfo hints,*res,*ptr;
    int socketIDInt;
    // Set hints for the computer's addresses.
    memset(&hints, 0, sizeof(hints));
    hints.ai_flags = AI_PASSIVE;
    hints.ai_family = AF_UNSPEC;
    hints.ai_socktype = SOCK_STREAM;
    // Get host for listening
    char portStr[6];
    sprintf(portStr, "%u",port);
    if (getaddrinfo(NULL, portStr, &hints, &res) != 0)
        return false;
    // Attempt to bind to one of the addresses.
    for(ptr = res; ptr != NULL; ptr = ptr->ai_next) {
        if ((socketIDInt = socket(ptr->ai_family, ptr->ai_socktype,ptr->ai_protocol)) == -1)
            continue;
        if (bind(socketIDInt, ptr->ai_addr, ptr->ai_addrlen) == -1) {
            close(socketIDInt);
            continue;
        }
        break; // Success.
    }
    freeaddrinfo(res);
    if (ptr == NULL) // Failure
        return false;
    socketID = malloc(sizeof(int));
    *(int *)socketID = socketIDInt; // Set socket ID
    // Make socket non-blocking
    fcntl(socketIDInt,F_SETFL,fcntl(socketIDInt,F_GETFL,0) | O_NONBLOCK);
    return true;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T19:43:15.407

的设计`getaddrinfo()`旨在适应任何网络协议，这些协议可能对特定服务使用不同的名称。指定可能不是数字，或者可能使用比 TCP 使用的 16 位整数端口号更大的数字。为了获得最大的灵活性，可以提供服务名称，可以将其转换为协议和任何其他特定于协议的信息，例如`ftp`→ IPv4 或 IPv6 TCP 端口 21。如果您知道您将始终使用 IPv4 或 IPv6 和 TCP，那么您可以传递`NULL`服务名称并在返回的套接字地址结构中自己填写端口号（`sin_port`IPv4`sin6_port`的字段或 IPv6 的字段）。但是，仅使用它可能更清洁`sprintf()`; 这将处理 IPv4 和 IPv6 使用的不同套接字地址结构，以及以网络字节顺序存储端口号的要求，并且还可能允许您在不更改代码的情况下支持其他未来协议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:46:04.883

`getaddrinfo()`采用字符串而不是整数的原因是*服务*不必只是一个端口。例如，用户可以请求服务“http”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:42:58.400

这看起来非常习惯于在状态`getaddrinfo()`中通常使用的方式。`AI_PASSIVE`字符串化的数字是典型的。

# sql-server - 在 Sql Server 中为 .sql 文件使用备用扩展名

> ID：11508635
> 
> 赞同：1
> 
> 时间：2012-07-16T16:36:07.397
> 
> 标签：sql-server, sql-server-2008

我正在寻找一种让 sql server 将不同的文件扩展名视为 .sql 文件的方法......我的公司政策是我们将存储过程命名为 .PRC 而不是 .SQL。这使得打开文件并编辑/执行它变得很麻烦。虽然我可以关联 SQL Server Management Studio 来打开文件，但它不会将其视为脚本，因此执行脚本的所有选项以及脚本的颜色编码都被禁用。

目前我必须复制脚本并将其粘贴到新查询中，然后当我完成编辑后将其粘贴回来并保存。这都与我们的源代码控制有关，是一个主要的痛苦。有什么方法可以欺骗 sql server 并将其视为 .sql 文件，以便我可以直接执行它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:42:05.140

您可以从选项对话框（工具->选项）添加扩展。然后在Text Editor-File Extension下然后选择你想要的编辑体验

![在此处输入图像描述](../Images/ff0b8b40e7b3f36f6832e4485bdde66b.png)

应用后，您可以像使用 .SQL 一样使用它。在下图中，请注意文件 SQLQuery.rpc 上的突出显示和结果集

![在此处输入图像描述](../Images/571fc0f0bf9c79d3eff7959cb899193a.png)

# ios - ShareKit 2.0：Facebook 已通过身份验证

> ID：11508637
> 
> 赞同：2
> 
> 时间：2012-07-16T16:36:16.273
> 
> 标签：ios, facebook, sharekit

我正在使用[ShareKit 2.0](http://www.github.com/Sharekit/Sharekit)（通过 cocoapods 安装）将文本和图像从我的 iOS 应用程序发布到 facebook。

问题是它卡在打开 facebook 应用程序的无限循环中，在那里它显示应用程序的自动化页面，但显示它已经被授权的消息。

我将我的 fb id 的 URL 方案添加到 info.plist，我还添加了应用程序委托方法，例如在 ShareKit wiki 中。

我能做些什么呢？

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T13:33:39.937

所以问题是 ShareKit 与最新的 Facebook iOS sdk 不兼容，由于没有附加到依赖项的版本，它是由 cocoapods 安装的。现在应该已经修复了，所以清除你的 Pod 并再次安装 pod。

# cruisecontrol.net - 在 CC.net 配置中使用自定义任务

> ID：11508639
> 
> 赞同：1
> 
> 时间：2012-07-16T16:36:18.743
> 
> 标签：cruisecontrol.net

我为 Cruise Control .net 创建了以下自定义任务，但我找不到有关如何将自定义任务添加到项目配置的单一参考。有没有人有一个有用的例子来说明如何在 cc.net 中添加对自定义任务的引用？

（以下是我的新任务）

```
public class RestoreDb : TaskBase
{
    #region Parameters

    [Required]
    public string ServerName { get; set; }
    [Required]
    public string DbName { get; set; }

    public string BackupFileName { get; set; }

    #endregion

    protected override bool Execute(ThoughtWorks.CruiseControl.Core.IIntegrationResult result)
    {
        bool returnResult = false;
        try
        {
            SqlConnectionStringBuilder connectionStringBuilder = new SqlConnectionStringBuilder();
            connectionStringBuilder.IntegratedSecurity = true;
            connectionStringBuilder.DataSource = ServerName;
            SqlConnection connection = new SqlConnection(connectionStringBuilder.ToString());
            connection.Open();

            Server server = new Server(new ServerConnection(connection));

            if (server.Databases[DbName] != null)
            {
                Log.Info("Dropping existing " + DbName + " on " + ServerName);
                server.Databases[DbName].Drop();
            }
            else
            {
                Log.Info(DbName + " on " + ServerName + " doesn't exist.");
            }

            Log.Info("Restoring " + DbName + " on " + ServerName);
            Database newDb = new Database(server, DbName);

            Restore rs = new Restore();
            rs.NoRecovery = false;

            FileInfo fi = new FileInfo(server.Settings.BackupDirectory + "\\" + BackupFileName);
            rs.Devices.AddDevice(fi.FullName, DeviceType.File);
            rs.Database = DbName;
            rs.Action = RestoreActionType.Database;
            rs.ReplaceDatabase = true;

            DataTable fileContents = rs.ReadFileList(server);
            string originalDbName = fileContents.Rows[0][0].ToString();
            string originalLogFileName = fileContents.Rows[1][0].ToString();
            rs.RelocateFiles.Add(new RelocateFile(originalDbName, 
            string.Format(@"C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\{0}.mdf", DbName)));

            rs.RelocateFiles.Add(new RelocateFile(originalLogFileName,
            string.Format(@"C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\{0}_1.ldf", DbName)));

            rs.SqlRestore(server);
            Log.Info("Restoring done.");
            returnResult = true; // success!
        }
        catch (Exception ex)
        {
            Log.Error(ex);
            returnResult = false;
        }
        return returnResult;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-25T14:43:23.733

你没有提到你正在使用的版本，所以我假设用户将使用更新的版本来回答这个问题。我是根据为 Cruisecontrol.net 1.8.3.0 开发自定义任务的经验[构建](/questions/tagged/cruisecontrol.net "显示标记为“cruisecontrol.net”的问题")的

您可以在此处找到一些用于创建和使用[插件的](/questions/tagged/plugins "显示标记为“插件”的问题")[api](/questions/tagged/api "显示标记为“api”的问题") [文档](/questions/tagged/documentation "显示标记为“文档”的问题")： [http ://www.cruisecontrolnet.org/projects/ccnet/wiki/DevInfo_MakingPlugins](http://www.cruisecontrolnet.org/projects/ccnet/wiki/DevInfo_MakingPlugins)

**编辑：**我想指出，提供的链接中的 CruiseControl.NET 文档已更新，现在包含此处包含的大部分信息。

然而，该文档的重量相当轻，并没有真正涵盖您在尝试创建自己的任务时最终会遇到问题的主题范围。

过程，尽可能简单地说；

*   您的自定义任务项目需要引用以下程序集，这些程序集可以在根 CruiseControl.NET 服务器文件夹中找到。

    *   NetReflector.dll
    *   ThoughtWorks.CruiseControl.Core.Dll
    *   您引用的任何其他不属于 .NET 3.5 框架的程序集
*   构建自定义任务时，您需要使用反射器属性标记您希望公开的任何类或属性，以使它们在 ccnet.config 中可用

*   为了让 CruiseControl.NET 使用您的自定义库，您需要使用以下约定命名程序集：ccnet.WhateverYouWantHere.plugin.dll

*   您需要将此程序集放在 CruiseControl.NET Server 文件夹中。

    *   如果您通过在 ccnet.exe.config 中为 PluginLocation 提供值来设置插件目录，则需要将程序集放置在那里。
    *   您在项目中引用的任何尚未在 CruiseControl.NET 服务器文件夹中的程序集也需要添加到服务器或插件文件夹中

```
namespace MyTasks
{
    [ReflectorType("MyCustomTask")]
    public class MyCustomTaskClass : ITask 
    {
        [ReflectorProperty("MyCustomTaskProperty")]
        public string CustomProperty { get; set; }

        public string MyInternalPublicProperty { get; set; }

        public void Run(IIntegrationResult result){}
    }
} 
```

**注意：**属性名称和您向 ccnet.config 公开的名称不必匹配。

为了引用创建的任务、标签器等，您只需使用反射器属性中提供的字符串。

```
<project>
    <tasks>
        <MyCustomTask MyCustomTaskProperty="This is an example"/>
    </tasks>
</project> 
```

如果您尝试使用此代码，并在您的标签中添加对 MyInternalPublicProperty 的引用，它将不起作用：

```
<project>
    <tasks>
        <MyCustomTask MyInternalPublicProperty="This is will throw an exception in the service and not reload the ccnet config until the invalid content is removed from the config"/>
    </tasks>
</project> 
```

这是因为您没有使用它自己的 [ReflectorProperty()] 属性来装饰该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-17T14:22:50.557

所以我基本上放弃了这个，因为在任何地方都没有关于如何将自定义任务添加到 cc.net 配置的示例。下面是我编写的 powershell 脚本，它执行完全相同的步骤。

```
$ServerName = 'servernamehere';
$DatabaseName = 'newDbNameHere';
$BackupFile = 'C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\Backup\backupFileHere.bak';
if($args[0])
{
    $ServerName = $args[0];
}
if($args[1])
{
    $DatabaseName = $args[1];
}
if($args[2])
{
    $BackupFile = $args[2];
}

[reflection.assembly]::LoadWithPartialName("Microsoft.SqlServer.Smo")
[reflection.assembly]::LoadWithPartialName("Microsoft.SqlServer.SmoExtended")
try 
{
    $Server = new-object ("Microsoft.SqlServer.Management.Smo.Server") $ServerName

    If ($Server.Databases.Contains($DatabaseName))
    {
        write-host "Dropping existing " $DatabaseName " on " $ServerName;
        #$Server.Databases[$DatabaseName].SetOffline();
        $Server.Databases[$DatabaseName].Drop();
    }
    else
    {
        write-host $DatabaseName " on " $ServerName " doesn't exist.";
    }
    $Database = new-object ("Microsoft.SqlServer.Management.Smo.Database") ($Server, $DatabaseName);

    $restore = new-object ('Microsoft.SqlServer.Management.Smo.Restore');
    $restore.NoRecovery = $false;

    $fil=new-object "Microsoft.SqlServer.Management.Smo.BackupDeviceItem";
    $fil.DeviceType='File';
    $fil.Name= $BackupFile;
    $restore.Action="Database";
    $restore.Devices.Add($fil);
    $restore.Database=$DatabaseName;
    $restore.ReplaceDatabase = $true;

    #retrieving the backup file's original database values so we can replace them
    $FileContents = $restore.ReadFileList($Server);
    $originalDbName =  $FileContents.Rows[0][0].ToString();
    $originalLogFileName = $FileContents.Rows[1][0].ToString();

    #replacing the bak files original file names with the new file names
    $mdf = new-object "Microsoft.SqlServer.Management.Smo.RelocateFile" ($originalDbName,
        "C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\$DatabaseName.mdf");
    $restore.RelocateFiles.Add($mdf);
    $ldf = new-object "Microsoft.SqlServer.Management.Smo.RelocateFile" ($originalLogFileName,
        "C:\Program Files\Microsoft SQL Server\MSSQL10.MSSQLSERVER\MSSQL\DATA\$DatabaseName_Log.mdf");
    $restore.RelocateFiles.Add($ldf);

    write-host "Restoring database $DatabaseName  on  $ServerName from file $BackupFile";

        $restore.SqlRestore($Server);
        write-host "Restore Complete";
}
catch [System.Exception] {
  # $_ is set to the ErrorRecord of the exception
  $currentException = $_.Exception;
  write-host "Root Exception: " $currentException.Message;
  While($currentException.InnerException)
  {
    $currentException = $_.Exception.InnerException;
    write-host "Inner Exception: " $currentException.Message;
  }
  write-host "Restore Failed.";
  exit 0; #failure
}    
exit 1; 
```

# css - 谷歌表格 importXml

> ID：11508641
> 
> 赞同：1
> 
> 时间：2012-07-16T16:36:23.040
> 
> 标签：css, xml, xpath, google-sheets

我正在尝试使用 Google 表格中的 importXML 在网站上定位价格。我的目标代码如下：

```
 <span class="new_price" id="final_price">£29.99</span> 
```

因为它在“new_price”类中，所以我的导入不起作用：

```
 =importXml("http://www.hardware-ironmongers.com/details.aspx?code=7751913"; "//span[@id='final_price']") 
```

任何想法如何在类中定位一个 ID？

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T21:22:57.367

我不是专家，但这看起来可能会让你走上正确的道路：

[如何在 XPath 中使用一个表达式从同一个节点中选择两个属性？](https://stackoverflow.com/questions/6029232/xpath-select-multiple-attr)

# haskell - Haskell：如何为集合定义类型类？

> ID：11508642
> 
> 赞同：9
> 
> 时间：2012-07-16T16:36:27.677
> 
> 标签：haskell, set, typeclass

这里的新手，苦苦挣扎。

我正在尝试为集合定义一个类型类。对于这种情况，它只需要“存在”的定义。'exists' 将在一个集合项上接受一个集合和函数，并返回一个布尔值。我如何在 Haskell 中定义它？

下面的方向是否正确？所以有类型类定义和 set with list 的实现，'exists' 现在返回 true..

```
-- Set.hs --

class Set a b where

  exists :: a -> (b -> Bool) -> Bool

-- ListSet.hs --

instance Set ListSet a where 

  exists a f = True 
```

--

（结果：类 `Set' 的参数太多）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-16T16:59:48.557

你可以这样做，有足够的扩展。至少，您将需要多参数类型类。但是，使用起来会很烦人：您需要在各处指定显式类型签名。解决它的一种方法是引入功能依赖项（使用另一个扩展）：

```
class Set a b | a -> b where
    exists :: a -> (b -> Bool) -> Bool 
```

这就是说，如果您知道集合的类型，那么您也知道元素的类型。但是，有一种更简单的方法可以在没有任何扩展的情况下工作：

```
class Set f where
    exists :: f a -> (a -> Bool) -> Bool 
```

在这里，类型类涵盖了更高种类的类型，这是一个巧妙的技巧，如果你以前从未见过它，你很难自己想出它！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-07-16T17:52:51.520

丹尼尔瓦格纳已经对你正在尝试做的事情给出了完美的答案。我只想补充一点关于您的错误 - `Too many parameters for class 'Set'`。这意味着您没有启用相应的 GHC 扩展 - `MultiParamTypeClasses`. 您可以通过在源文件顶部指定特殊类型的注释来做到这一点：

```
{-# LANGUAGE MultiParamTypeClasses #-}
--
-- Your source code here
-- 
```

然后你应该能够编译你的代码。

Daniel 的回答中提到的另一个 Haskell 功能也需要启用某些扩展，即（这是类型类声明`FunctionalDependencies`中的奇怪之处）。`.. | a -> b ..`您可以使用逗号同时启用多个扩展，如下所示：

```
{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies #-} 
```

Carl 的评论提到了另一个扩展，`TypeFamilies`它也可以为您尝试做的事情提供方法（集合类型的泛型类或其他类型的集合）。你可以在这里阅读：[http](http://www.haskell.org/haskellwiki/Type_families) ://www.haskell.org/haskellwiki/Type_families 。

# android - 从 andengine sprite touch 打开首选项菜单

> ID：11508643
> 
> 赞同：2
> 
> 时间：2012-07-16T16:36:34.133
> 
> 标签：android, sharedpreferences, andengine, preferenceactivity

我正在创建一个基于 GLES2 的全屏和引擎应用程序。

在应用程序中有一些用户可以选择的设置，我使用了 android 中可用的 PreferencesActivity。

如果设备有一个物理菜单按钮，所有这些都可以工作。由于此按钮会随着时间的推移而消失，因此我在屏幕上添加了一个 ButtonSprite，我想像按下菜单按钮一样打开首选项活动。我没有使用操作栏，因为这是一个全屏应用程序，并且不想失去更多的屏幕空间。

我已经把所有东西都连接好了，这样我就知道什么时候按钮被触摸了，但是我无法确定我应该调用什么来实例化首选项活动。

我确信这是一件简单的事情，但是，文档和示例并没有提供任何线索，至少对我而言。

所以，鉴于我知道在哪里调用以显示偏好活动，我应该调用什么来真正实现这一点？

提前致谢，

B.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-04T07:54:38.787

要打开一个新活动，您需要触发一个 Intent。从您的主要活动来看，它可能如下所示：

```
Intent i = new Intent();
i.setClassname(this, "your.package.name.PreferencesActivity");
this.startActivity(i); 
```

但是，您将处于按钮单击处理程序所在的上下文中，因此您需要引用当前活动而不是`this`.

# html - IE7 忽略条件语句

> ID：11508649
> 
> 赞同：2
> 
> 时间：2012-07-16T16:36:51.797
> 
> 标签：html, css, internet-explorer-7, conditional-statements

我正在为一个 90% 的用户在 IE 上浏览的公司网站敲定代码。我的条件语句适用于除 IE7 之外的所有浏览器。我不确定为什么 IE 会忽略我为 IE 浏览创建的单独样式表。请在下面查看我的代码。

这里还有这段代码：

```
<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE" charset="utf-8" /> 
```

...允许我删除 IE 7-9 中的兼容模式。

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=EDGE" charset="utf-8" />
<tile>Company Site</title>
<link rel="stylesheet" href="css/style.css" media="screen" />
<!--[if IE]><link rel="stylesheet" href="css/ie.css"><![endif]-->
<!--[if IE 8]><link rel="stylesheet" href="css/ie8.css"><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="css/ie7.css"><![endif]-->
</head> 
```

然后我的其余代码似乎可以正常工作并验证没有问题。好像 IE7 被忽略了。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:48:50.787

您的`X-UA-Compatible`标题是多余的。它的内容应该只是`IE=edge`，不多也不少。

至于样式表，您可以通过添加一些可见的内容来测试评论是否正在处理，例如`<script>alert("Hello!");</script>`（因为您在 中`<head>`，您不能只在其中放置纯文本）。

如果您执行此操作并显示警报，则您的 CSS 文件可能存在问题。要么是 404，要么你有特异性问题（正如 CrazyVipa 建议的那样）。如果上述测试尚无定论，我们将需要更多信息来进一步诊断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:45:19.193

尼娜，

您应该检查日志以查看它是否正在本地下载。看起来您的 CSS 似乎没有被应用，但可能是 CSS 规则被覆盖了。

例如，如果您的标准 CSS 文件具有：

```
#content-custom a {
color:#fff;
} 
```

并且您的 CSS 条件具有：

```
.custom a {
color:#000;
} 
```

您的字体将显示为#fff。我还没有听到或看到任何与条件语句相关的实际错误。我注意到的唯一问题是人为错误。（错误类型、权限、本地环境等）我的假设是 CSS 文件被覆盖。CSS 禁用？无效的链接？

很抱歉这么说，但很可能是您的错字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T19:58:09.593

看起来我必须使用样式表的绝对链接而不是相对链接。所以使用类似的东西：

```
<link rel="stylesheet" href="http://mywebsite.com/css/style.css"> 
```

代替

```
<link rel="stylesheet" href="css/style.css"> 
```

感谢您的所有帮助，但它始终是 IE 的小事。

为了记录，我还确保我改变了我的标题的外观，这要归功于你们的一些很棒的提示。这是现在的最终标题示例：

```
<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" charset="utf-8" />
<title>My Site</title>
<link rel="stylesheet" href="css/style.css" media="screen">
<!--[if gte IE 8]><link rel="stylesheet" href="css/ie.css"><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="http://mysite.com/css/ie7.css"><![endif]-->
</head> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T19:27:59.910

我不确定为什么它没有调用文件，但可能是文件放错了地方。您现在可以取出 IE 的行，只测试 IE 7 文件。

# java - 为什么我的 java 服务器和 android 客户端不能来回发送任何消息？

> ID：11508650
> 
> 赞同：0
> 
> 时间：2012-07-16T16:36:51.853
> 
> 标签：java, android, tcp

对于我正在尝试创建的 mmo，我有一个连接到 java 服务器的 android 客户端。安卓在模拟器上运行，而服务器直接在我的电脑上运行。他们可以正常连接并确认连接，但客户端停在一个奇怪的地方，我不知道为什么。

服务器的 WorkerThread 的 Run 方法：

```
public void run() {
    try {
        InputStream input  = clientSocket.getInputStream();
        OutputStream output = clientSocket.getOutputStream();
        String returns="";
        String s="";
        try{
        s= inputStreamToString(input).toString();
        }
        catch(Exception e)
        {}
       output.write(("HTTP/1.1 200 OK\n\nWorkerRunnable: " +
               this.serverText + " - " +
               "").getBytes());
        output.close();
        input.close();
    } catch (IOException e) {
        //report exception somewhere.
        e.printStackTrace();
    }
} 
```

InputStream 字符串构建器：

```
private static StringBuilder inputStreamToString(InputStream is) {
    String line = "";
    StringBuilder total = new StringBuilder();

    BufferedReader rd = new BufferedReader(new InputStreamReader(is));

    try {
        while ((line = rd.readLine()) != null) {
            total.append(line);
        }
    } catch (Exception e) {
    }

    return total;} 
```

客户端的连接方式：

```
 public String sendMessage(String message)
      {
try{        clientSocket = new Socket("10.0.2.2", 9000);

          String modifiedSentence;
          DataOutputStream outToServer = new DataOutputStream(clientSocket.getOutputStream());
          BufferedReader inFromServer = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
          outToServer.writeBytes(message+"\n");
              //Stops here
          modifiedSentence = inFromServer.readLine();
          outToServer.close();
          inFromServer.close();
          clientSocket.close();
          Log.v(modifiedSentence, modifiedSentence);
          return modifiedSentence;}
catch(Exception e)
{
    return "";}

      } 
```

谢谢，任何帮助将不胜感激。

编辑：如果我关闭客户端或服务器，则更新另一个可以接收前者的消息，但如果两者都打开，则它们不能...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:55:51.630

一个好的做法是在执行写入之后执行刷新。
这会强制写入套接字。
另外，我建议您将流的关闭放在最后部分
（我知道这与您的问题无关，但我想帮助您更好地编码。
所以结合了我的两个答案的代码，应该看起来像：

```
OutputStream outStream = .... //Get it somehow
try {
   outStream.write(data);
   outStream.flush();
   //Do other stuff if needed
} catch (Exception ex) {
 //Do something with the exception
}
finally {
   if (outStream != null) {
      try {
        outStream.close();
     } catch (IOException ioex) {
        //Ignore
     }
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:27:20.797

尝试这个：

```
outToServer.writeBytes(message+"\n");
outToServer.flush(); // Flush output to socket
modifiedSentence = inFromServer.readLine(); 
```

还要检查您的服务器是否实际接收到数据。

# jquery - DIV 周围没有边框

> ID：11508659
> 
> 赞同：1
> 
> 时间：2012-07-16T16:37:33.610
> 
> 标签：jquery, css, html

我希望能够在悬停时将一个图像淡入另一个图像，然后在鼠标离开对象后淡出悬停的图像。因为它紧紧地包装在一个 DIV 中，所以我不希望它周围有任何空间，所以试图只使用不起作用的 SPAN。任何想法？我的脚本如下：

```
<style>
.fade {
          position: relative;
    border: 0;
    margin: 0 auto;
    padding: 0;
        }

        .fade div {
          position: absolute;
          top: 0;
          left: 0;
          display: none;
          height: 100px;
          width: 240px;
    border: 0;
    margin: 0 auto;
    padding: 0;
        }
-->
</style>

    <script type="text/javascript">
    <!--

    $(function () {
        // find the div.fade elements and hook the hover event
        $('span.fade').hover(function() {
            // on hovering over find the element we want to fade *up*
            var fade = $('> div', this);

            // if the element is currently being animated (to fadeOut)...
            if (fade.is(':animated')) {
                // ...stop the current animation, and fade it to 1 from current position
                fade.stop().fadeTo(250, 1);
            } else {
                fade.fadeIn(250);
            }
        }, function () {
            var fade = $('> div', this);
            if (fade.is(':animated')) {
                fade.stop().fadeTo(3000, 0);
            } else {
                fade.fadeOut(3000);
            }
        });
    });

    //-->
    </script> 
```

HTML：

```
<span class="fade">
        <img src="theImages/sApproveBW.jpg" alt="Who we are" />
        <div>
            <img src="theImages/sApprove.jpg" alt="Who we are" />
        </div>
    </span><img src="theImages/bApprove.jpg" height=100 width=240 /><br><img src="theImages/tApprove.jpg" height=100 width=240 /> 
```

我在第一张图片下方有一点空白。无论如何要摆脱它？

它的外观：http: [//img805.imageshack.us/img805/7417/imgct.png](http://img805.imageshack.us/img805/7417/imgct.png)

我想摆脱绿色图像顶部第一张图像之间的空白。

我的新 HTML 页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>Fade Method 1 (two images)</title>
    <style type="text/css" media="screen">
    <!--
* {
    margin: 0;
    padding: 0;
}
        img { border: 0;
display: block;
}

.fade {
    position: absolute
        }

        .fade div {
          position: absolute;
          top: 0;
          left: 0;
          display: none;
          height: 100px;
          width: 240px;
        }

    -->
    </style>

<script src="http://code.jquery.com/jquery-1.7.1.min.js" type="text/javascript"></script>

    <script type="text/javascript">
    <!--

    $(function () {
        // find the div.fade elements and hook the hover event
        $('span.fade').hover(function() {
            // on hovering over find the element we want to fade *up*
            var fade = $('> div', this);

            // if the element is currently being animated (to fadeOut)...
            if (fade.is(':animated')) {
                // ...stop the current animation, and fade it to 1 from current position
                fade.stop().fadeTo(250, 1);
            } else {
                fade.fadeIn(250);
            }
        }, function () {
            var fade = $('> div', this);
            if (fade.is(':animated')) {
                fade.stop().fadeTo(3000, 0);
            } else {
                fade.fadeOut(3000);
            }
        });
    });

    //-->
    </script>
</head>
<body id="page">
    <span class="fade">
        <img src="theImages/sApproveBW.jpg" alt="Who we are" />
        <div>
            <img src="theImages/sApprove.jpg" alt="Who we are" />
        </div>
    </span>
<img class=t src="theImages/bApprove.jpg" height=100 width=240 />
<img class=t src="theImages/tApprove.jpg" height=100 width=240 />
</body>
</html> 
```

但现在我有两张图片，第二张（绿色）在第一张（黑色）下方，第三张（黄色）在黑色下方。这是示例：http: [//img266.imageshack.us/img266/9557/imgdu.png](http://img266.imageshack.us/img266/9557/imgdu.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:40:50.713

```
img {
    display:block;
}​​​​
.fade div {
    margin-top:-100px !important;
} 
```

删除`top:0px; left:0px;`并添加上面的代码，这应该可以解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:39:40.767

尝试添加：`display:block`到每个图像，它应该工作

我编辑了你的代码，但这里是：http: [//jsfiddle.net/nTCr4/16/](http://jsfiddle.net/nTCr4/16/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:03:18.870

顺便说一句，您的空间和图像问题是因为您的图像在父元素内自然对齐，以防止您可以为图像使用 CSS 属性：`vertical-align:middle;`这将解决它。但这里有另一个例子：

## *[jsBin 演示](http://jsbin.com/ovivey/4/edit)*

您只需要这个 HTML：

```
<div class="fade">
  <img src="" alt="" />  
  <img src="" alt="" />  
</div> 
```

这个CSS：

```
 div.fade {
    position: relative;
    border: none;
    width:240px;
    height:100px;
}
div.fade img{
    position:absolute;
    top:0px;
    left:0px;
} 
```

和 jQ：

```
 var imgTwo = $('.fade').find('img:eq(1)');
  imgTwo.hide();

  $('.fade').hover(function() {
    imgTwo.stop().fadeTo(300,1);
  },function(){
    imgTwo.stop().fadeTo(3000,0);
  }); 
```

# git - GIT 对“结帐”一词的使用与 SmartGit 对它的使用有区别吗？

> ID：11508660
> 
> 赞同：1
> 
> 时间：2012-07-16T16:37:34.513
> 
> 标签：git, version-control, smartgit

几个月前我开始使用 Git，我想要一个 GUI 客户端，所以我使用[SmartGit](http://www.syntevo.com/smartgit/index.html)，我觉得它很棒。

唯一的事情是，当我尝试回到以前的提交时，我会感到非常困惑；例如，最近我发现了一个在我的项目中未被发现的错误。我在 SmartGit 中使用了**branch>>checkout**来更改为早期版本。这工作得很好，但是 SmartGit 建议我应该切换到本地分支来检查提交。我对此有几个问题（见下文），但我的主要问题是，当我阅读每个文档时，他们似乎在说些稍微不同的事情。Git的文档似乎说“结帐”是为了

> *检查***到工作树的***分支或路径*****

 **而[smartgit 说](http://www.syntevo.com/smartgit/documentation.html)你使用结帐来

> 将工作树切换到某个**提交**。

*   那么它们是两种不同的东西（即结帐一词的不同用法）吗？如果不是，为什么一个指分支而另一个指提交？
*   如果我想移动到**同一**分支中的较早提交，它是如何工作的？
*   为什么 smartgit 建议我为此启动一个新分支，这很重要吗？
*   如果我必须每次都建立一个新的分支，那么我应该为此建立一个特殊的分支，这样我就不会得到很多随机分支吗？
*   本地分支建议中“本地”的含义是什么，为什么它必须是本地的，这是否意味着它**不**应该与我的 bitbucket 帐户同步？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:56:17.873

## 不

我不使用 smartgit，但这些描述是等价的。

## 分支混乱

git 中的分支只是指向提交的指针。因此，当您签出一个分支时，您正在将您的工作副本更新为一个特定的提交（它只是有一个好听的名字，比如“master”）。

如果你想检查一个提交（它在你的回购历史中的位置并不重要） - 你可以通过哈希检查它。如果您*只是*检查它以环顾四周，那么没有必要创建一个新分支。但是，根据您正在做的事情，这样做可能是个好主意。您可以在签出提交之前或之后执行此操作 - 至少是 git - 没关系。

如果您使用 git 的 cli 执行操作，您会看到如下内容：

```
(master) $ git checkout c5d12604219ac1d6fa0f7d8ff4be98c8a3eee0da
Note: checking out 'c5d12604219ac1d6fa0f7d8ff4be98c8a3eee0da'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b new_branch_name

HEAD is now at c5d1260... Added CakeResponse::file() for serving files as response
((no branch))]$ 
```

即 git 还会通过示例命令提示您选择为您签出的提交创建一个分支并解释原因（*以保留您创建的提交*）。

## 当地分支机构

本地分支仅表示存在于本地工作副本中的分支（它出现在 .git/config 中，当你这样做时它会出现`git branch`）。本地分支可能有也可能没有上游远程分支（可能有也可能没有要推送的东西）——这是你的选择，不影响分支是否是本地的——它在你的仓库中定义，因此它是本地的.**

# c# - 如何最小化主窗体

> ID：11508665
> 
> 赞同：-1
> 
> 时间：2012-07-16T16:37:58.153
> 
> 标签：c#, visual-studio

我有带边框的主窗体，而其他窗体在项目中是无边框的。我已经对其进行了建模，但我面临着不能最小化表格的问题。

当主窗体打开时，它允许关闭、最小化和最大化按钮，但如果我从主窗体打开另一个窗体，则不允许。从主窗体打开其他无边框窗体时，关闭、最小化和最大化按钮被禁用。

我想在从主表单打开新的无边框表单时允许最小化和禁用最大化和关闭按钮。

怎么做？。

## 按照 LarseTech 回答（问题）：

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:48:26.733

根据聊天中的讨论：

```
f2.ShowDialog(this); 
```

使子窗体成为模态窗体，并且它将阻止对主窗体的访问，直到它被关闭。

尝试将其更改为：

```
f2.Show(this); 
```

至于 ALT-Tab 列表中显示的子窗体，我只能猜测 WinXP 会这样做。在 Win7 中，无边框的子窗体没有出现在 ALT-Tab 列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:40:35.270

请将 System.Windows.Forms.Form.WindowState 属性设置为 FormWindowState.Minimized。

您可以从表单设计器中执行此操作

# php - 浏览器查询与 python MySQLdb 查询

> ID：11508670
> 
> 赞同：0
> 
> 时间：2012-07-16T16:38:14.533
> 
> 标签：php, python, mysql, pyqt4, mysql-python

我想知道使用浏览器的 mysql 查询是否更快或 python 的 MySQLdb 更快。我将 MysqlDb 与 PyQt4 用于桌面 ui 和 PHP 用于 web ui。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T18:14:43.393

我相信您在问 Python 还是 PHP（我认为您所说的浏览器是什么意思？）在进行数据库调用时是否更有效。

答案？这取决于具体的代码和调用，但基本相同。Python 和 PHP 都是解释型语言，并在运行时解释代码。如果您使用的任何一种语言都经过编译（例如，如果您使用 C），我会说您可能会看到其中一种语言的速度优势，但是根据您提供给我们的当前信息，我可以不是真的判断。

我会使用您最熟悉或最适合该任务的语言 - 它们都将连接到 MySQL 数据库并执行相同的命令和查询，因此只需以对您而言最简单的方式编写代码去做吧。

另外，您提出的问题没有多大意义。浏览器不与 MySQL 数据库交互，PHP 会在您请求页面时由服务器执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:58:43.490

浏览器不执行数据库查询（除非您考虑嵌入式 SQLite 数据库），因此您的问题不仅荒谬，而且实际上完全无关紧要。

# iphone - 从 SubView (tableview) 到 ModalView (storyboard)

> ID：11508672
> 
> 赞同：0
> 
> 时间：2012-07-16T16:38:24.670
> 
> 标签：iphone, ios5, xcode4, storyboard, xcode4.3

我有一个名为 ExploreViewController 的 RootView

在这里，我加载了一个子视图：`[self.view addSubview:self.wallPostsTableViewController.view];`

这工作正常，但现在我想点击一个单元格并打开该销售的详细信息，通常我在 didSelectRowAtIndexPath 中使用 prepareToSegue 和 preformSegue ...

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
// call super because we're a custom subclass.
[super tableView:tableView didSelectRowAtIndexPath:indexPath];
[tableView deselectRowAtIndexPath:indexPath animated:YES];

[self performSegueWithIdentifier:@"ExploreModalSegue" sender:self]; 
```

}

和

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender { 
if ([segue.identifier isEqualToString:@"ExploreModalSegue"]) {
    MuseumViewController *detailViewController = [segue destinationViewController];
    NSInteger row = [[self tableView].indexPathForSelectedRow row];
    detailViewController.detailItems = [self.objects objectAtIndex:row];  
} 
```

}

这给出了一个错误：

> 由于未捕获的异常'NSInvalidArgumentException'而终止应用程序，原因：'Receiver（）没有标识符'ExploreModalSegue'的segue'

我需要一些东西来使用该单元格的正确信息调用 detailViewController，并且我想为该 detailViewController 使用 StoryBoard？

# ruby-on-rails - Rails - link_to 和 button_to

> ID：11508673
> 
> 赞同：2
> 
> 时间：2012-07-16T16:38:25.453
> 
> 标签：ruby-on-rails, ajax

在我的 Rails 3.2.3 应用程序中，我使用 Ajax 和 jQuery。页面上有一个链接，我想用一个按钮替换它。下面的代码运行完美

```
<%= link_to "More", {:controller => "home", :action => "test_method", :page=>@current_page }, :remote => true,:id => 'lnk_more' %> 
```

但是这个不

```
<%= button_to "More", {:controller => "home", :action => "test_method", :page=>@current_page }, :remote => true,:id => 'lnk_more' %> 
```

链接和按钮的结果 html 在这里

```
#link
<a href="/home/test_method?page=1" data-remote="true" id="lnk_more" disabled="disabled">More </a>

#button
<form action="/home/test_method?page=1" class="button_to" data-remote="true" method="post"><div><input id="lnk_more" type="submit" value="More "><input name="authenticity_token" type="hidden" value="hFCuBR+88FYKEvNTZok+QRhxf6fHA+ucC6i2yc9hBEk="></div></form> 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:46:41.497

```
<%= button_to "More", 
     { :controller => :home, :action=> :test_method, :page => @current_page}, 
     { :remote => true, :id => 'lnk_more' } 
 %> 
```

会给输入一个id

```
<input id="lnk_more" type="submit" value="More"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-11T06:05:17.650

您必须更改方法`:method=>:get`，因为默认情况下它设置为`post`. 而且您的路线可能没有正确路由

`<%= button_to "More", {:controller => "home", :action => "test_method", :page=>@current_page }, :method=>:get, :remote => true,:id => 'lnk_more' %>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:43:18.883

根据文档，该`remote`选项应该是`options`. 请参阅[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-button_to)

# c# - 多线程中的循环边界

> ID：11508675
> 
> 赞同：2
> 
> 时间：2012-07-16T16:38:33.543
> 
> 标签：c#, multithreading, c#-3.0

我有一个主线程，它使两个嵌套的其他线程成为。

```
private void mainthread()
        {
            List<Thread> ts= new List<Thread>();

            for (int w=0; w<7; w+=2)
                for (int h = 0; h < 5; h+=3)
                {
                    Thread t = new Thread(delegate() { otherthreads(w, h); });
                    ts.Add(t);
                    t.Start();
                }
            for (int i = 0; i < ts.Count; i++)
                ts[i].Join();
        }

        private void otherthreads(int w, int h)
        {                    
            listBox1.Invoke(new singleparam(addtolistbox), new object[] { "w:" + w.ToString() + ",h:" + h.ToString() });        
        } 
```

每个线程将其输入参数添加到列表框。我很困惑为什么某些线程的输入参数不在 for 范围内？

![在此处输入图像描述](../Images/83887c6086a1834eaeb400518a1ade09.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:45:30.643

您的循环运行正常，但发生的情况是：委托知道它必须传递`w`并传递`h`给`otherthreads()`函数，但这些*值*在实际调用之前不会绑定。换句话说，在委托实际执行之前，它只知道它必须使用`w`and `h`。在您的最后一次迭代中，您要求委托在执行之前执行，`w`并`h`在启动线程的最后一次递增，导致它们的值分别为 8 和 6。循环退出。然后，picomoments 之后，代理执行并且现在具有`w`和`h`...的值，但现在的值是 8 和 6。

您可以通过“快照”`w`和`h`局部变量在委托周围最紧密的范围内并适当地分配它们的值来避免这种情况：

```
for (int h = 0; h < 5; h+=3) 
{
    int h2=h;
    int w2=w;

    Thread t = new Thread(delegate() { otherthreads(w2, h2); });
    ts.Add(t);
    t.Start();
} 
```

# ruby - 跳过 Enumerable#each_cons 中的“n”次迭代

> ID：11508677
> 
> 赞同：4
> 
> 时间：2012-07-16T16:38:54.637
> 
> 标签：ruby

`n`执行块时是否可以跳过迭代`each`？

```
persons.each_cons(2) do |person|
  if person[0] == person[1]
    #SKIP 2 iterations
  end

  puts "Howdy? #{person[0]}"
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-12-16T14:48:08.620

**只需`Enumerator`明确使用：**

```
persons = [1, 2, 1, 1, 1, 3]
enum = persons.each_cons(2)

loop do
  p1, p2 = enum.next
  if p1 == p2
    2.times { enum.next }
  else
    puts "Howdy? #{p1}"
  end
end 
```

* * *

* * *

**一些注意事项：**

*   默认情况下，所有循环（例如`while`, `for`, ）已经通过ing 进行`loop`救援（惊喜惊喜），使ing 超级容易`StopIteration``break``next`
*   显式使用`Enumerator`is 和 Ruby 一样！拿一本*最新*的 Ruby Pickaxe 书，浏览到第 4.3 章（块和迭代器），尽情享受吧！
*   不要错过并行分配，即使是在块中
*   如果您无法按照自己想要的方式进行导航，我建议您花 10 分钟时间阅读模块文档：许多人可以像我一样`Enumerable`发现两者之间的区别`#each_cons`和启发性。 特别是，请至少查看所有以 、 和 开头的方法名称（欢迎*在*评论中提出更多建议！）。不得不手动调用实际上很少见。`#each_slice`
    *`chunk``drop``each``slice``#next`*

 ** * *

**奖励积分：**

了解“迭代器”和（与上面提到的 Pickaxe 相同的章节）之间的区别`Enumerator`实际上会派上用场。
有时通过构建自定义迭代器可以更好地解决您的难题：

```
persons = [1, 2, 1, 1, 1, 3]
custom_iter = Enumerator.new do |yielder|
  en = persons.each_cons(2)
  loop do
    2.times { en.next } while (p1, p2 = en.next).reduce(:==)
    yielder.yield p1
  end
end

custom_iter.each { |pers| puts "Howdy? #{pers}" } 
```

为什么要学习自定义迭代器？想象一下，您需要对任意大的（注意`#lazy`）偶数集进行操作：

```
def Integer.even from:0
  Enumerator.new do |yielder, n: (from.even? ? from : from+1 )|
    loop { yielder.yield n; n += 2}
  end.lazy
end

p Integer.even(from: 3).take(10).to_a 
```

Ruby 公开元素枚举而不是列表迭代的方式可以改变您对序列和集合的看法——给它一个机会；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:49:27.440

你不能直接这样做。

您可能想调用[`uniq`](http://ruby-doc.org/core-1.9.3/Array.html#method-i-uniq)您的数组，或者如果顺序很重要，请查看新[`chunk`](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-chunk)方法：

```
[1,1,1,2,1,3].uniq # => [1,2,3]
[1,1,1,2,1,3].chunk{|e| e}.map(&:first) # => [1,2,1,3]
# i.e. two adjacent items will always be different 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T18:47:10.053

另一种与 ruby​​ 不同的方法是使用`each`迭代器。

```
persons = [1,1,2,2,2,3,4,4,5,5,6,7,8,9]

persons_iterator = persons.each
begin
  while first_person = persons_iterator.next do
    second_person = persons_iterator.next
    if first_person == second_person
      persons_iterator.next.next # Skip 2 iterations
    end

    puts "Howdy? #{first_person}"
  end
rescue StopIteration
  # Iterator end
end 
```*

# linq - 如何返回具有相关实体属性条件的实体？

> ID：11508680
> 
> 赞同：0
> 
> 时间：2012-07-16T16:39:09.030
> 
> 标签：linq

在下面的代码中，第一个 LINQ 语句获取了我所有的活跃客户 (c) 并包括他们的访问。后续行执行额外的过滤，但与此问题无关。

在最后一行，我试图将客户限制为那些具有 Visit.Id 等于`parsedVisitId`但根本无法使这条线工作的客户。我什至无法将任何可以编译的东西放在一起。`parsedVisitId`是从字符串解析的 int。

如何重写最后一行以仅返回访问 id 等于 parsedVisitId 的客户？

```
var customers= this.db.Customers.Where(c => c.IsActive).Include(c => c.Visits).AsQueryable();
//
// more filtering stuff happens here...
//
customers= customers.Where(p => p.Visits.Where( v => v.Id == parsedVisitId)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:49:48.880

```
customers = customers.Where(p => p.Visits.Any( v => v.Id == parsedVisitId)); 
```

使用 Any 而不是 Where on Visits。我希望上面的代码行会有所帮助。

在您的代码中

> 客户=customers.Where(p => p.Visits.Where(v => v.Id == parsedVisitId));

customers.Where(...) 方法需要一个 lambda 表达式，其参数类型为 Customer 和 ReturnType bool 但您的 lambda 表达式

> p.Visits.Where(v => v.Id == parsedVisitId)

返回类型

```
IEnumerable<Visit> 
```

因此它不起作用。我想知道它是如何编译的。

# c# - C# 函数中的 Out 参数导致的初始化错误

> ID：11508683
> 
> 赞同：1
> 
> 时间：2012-07-16T16:39:31.503
> 
> 标签：c#, initialization

我有以下代码：

```
double dd;
Dictionary<string, double> dic = new Dictionary<string,double>();
bool notin = this.summedVars.TryGetValue(bacino, out dic);
if(notin == false)
    this.summedVars.Add(bacino,dic);
dic.TryGetValue(id, out dd);
dic[id] = dd + d; 
```

当我运行它时，我收到错误：

> dic 设置为空引用

如何在不添加值的情况下`summedVars`使用 new进行初始化？`Dictionary`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:44:31.300

我怀疑 TryGetValue 正在使您的输出参数（dic）归零。在那条线之后你需要一个安全网

例如

```
dic = dic ?? new Dictionary<string,double>(); 
```

您的代码将变为：

```
 double dd;
                Dictionary<string, double> dic;
                bool notin = this.summedVars.TryGetValue(bacino, out dic);
                dic = dic ?? new Dictionary<string,double>();
                if(notin == false)
                    this.summedVars.Add(bacino,dic);
                dic.TryGetValue(id, out dd);
                dic[id] = dd + d; 
```

# jquery - 释放小书签时jquery播放声音

> ID：11508694
> 
> 赞同：0
> 
> 时间：2012-07-16T16:40:06.220
> 
> 标签：jquery, bookmarklet

我有一个书签，我想在用户在书签栏上释放它时播放声音。

这是我的代码。

```
<audio id="applause" preload="auto" autobuffer>
    <source src="applause.mp3" />
    <source src="applause.ogg" />
</audio>
<script type="text/javascript">
    $('#bookmarklet a').mouseup(function() {
        $('#applause')[0].play();
    });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:01:54.977

我可能错了，但书签操作似乎不太可能触发网站能够做出反应的事件。所以很可能在保存小书签时无法播放声音。

# java - 在 Java 中使用继承或接口的案例？

> ID：11508696
> 
> 赞同：5
> 
> 时间：2012-07-16T16:40:17.137
> 
> 标签：java

我有一个非常简单的应用程序，它需要一个数据源。目前它是一个平面文件，但稍后它将更改为数据库。我需要您对这里使用继承或接口的意见。哪一个会更好，为什么？我的意见是使用接口，因为它很灵活，但我也可以将数据源作为抽象类。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-16T16:41:49.783

您将使用一个抽象类，其中存在所有实现都需要访问的通用功能。这里的数据库和文件实现是如此不同，它们没有任何共同点，所以我会选择接口。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:43:05.373

当只有访问数据的方法和类型保持不变时，您可以使用接口。当需要共享的事物之间存在共同的代码/功能时，您可以使用继承。

在这种情况下，似乎一个接口就足够了，而使用没有公共代码的抽象类将是一种浪费。使用接口的一个经常被遗忘的好处是您可以一次实现多个接口，而您只能从一个父类继承。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:44:05.793

在这种情况下，使用接口会更方便。

通过抽象出实现细节，您可以提供平面文件和数据库支持的通用接口。当需要更改时，只有实现此接口的代码会更改，而不会更改任何使用它们的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T16:45:05.917

我会选择一个抽象类。采用纯面向对象的方法，该类将非常小，只有必需品，然后让子类包含对象的所有参数和值。

为您计划的数据库做好准备的抽象类中的一个示例是`int`唯一 id。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-16T16:55:21.480

您可以使用 DAO 设计模式和工厂。[您可以在高级 DAO 编程](http://www.ibm.com/developerworks/library/j-dao/)中找到示例，在[核心 J2EE 模式 - 数据访问对象](http://java.sun.com/blueprints/corej2eepatterns/Patterns/DataAccessObject.html)中找到更多信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-16T16:45:39.837

正如您在帖子中提到的，最好创建一个接口来定义可以在您的数据源上执行的操作。对于每个单个数据源，您可以创建一个实现该接口的类。

要对平面文件进行操作，您可以实现 class `FileDataWrapper implements DataWrapper`，其中 FileDataWrapper 类实现可以对数据源执行的操作。稍后，当您更改为数据库时，只需实现类`DatabaseDataWrapper implements DataWrapper`。

# ios - 需要帮助修复内存泄漏 - NSMutableString

> ID：11508699
> 
> 赞同：0
> 
> 时间：2012-07-16T16:40:32.857
> 
> 标签：ios, memory-leaks, cocos2d-iphone, nsstring, nsmutablestring

一直在玩弄工具，但在弄清楚如何解决此内存泄漏方面运气不佳。

首先是代码：

```
-(NSString *) randomizeHint:(NSString *) wordToShuffle{

    NSMutableString * outputstring = [NSMutableString stringWithCapacity:[wordToShuffle length]];
    NSMutableSet * usedNumberSet = [NSMutableSet setWithCapacity:[wordToShuffle length]];

    for (int i=0; i<[wordToShuffle length]; i++) {
        int randomnum = arc4random()%[wordToShuffle length];

        while ([usedNumberSet containsObject:[NSNumber numberWithInt:randomnum]]==YES) {
            randomnum = arc4random()%[wordToShuffle length];
        }

        [usedNumberSet addObject:[NSNumber numberWithInt:randomnum]];
        [outputstring appendFormat:@"%c",[wordToShuffle characterAtIndex:randomnum]];
    }

    CCLOG(@"outputstring is:%@",outputstring);
    return outputstring;

 } 
```

Instruments 给了我以下信息：

`Leaked Object = NSCFString, Responsible Library = Foundation, Responsible Frame = -[NSPlaceholderMutableString initWithCapacity:]`

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:53:46.383

你真的不需要使用可变字符串......特别是因为你的返回类型是 NSString。只需使用 stringByAppendingFormat：

```
-(NSString *) randomizeHint:(NSString *) wordToShuffle{

    NSString * outputstring = @"";

    NSMutableSet * usedNumberSet = [NSMutableSet setWithCapacity:[wordToShuffle length]];

    for (int i=0; i<[wordToShuffle length]; i++) {
        int randomnum = arc4random()%[wordToShuffle length];

        while ([usedNumberSet containsObject:[NSNumber numberWithInt:randomnum]]==YES) {
            randomnum = arc4random()%[wordToShuffle length];
        }

        [usedNumberSet addObject:[NSNumber numberWithInt:randomnum]];

        // just set outputstring like so... no need to worry about a leaky mutable string then
        outputstring = [outputstring stringByAppendingFormat:@"%c",
                    [wordToShuffle characterAtIndex:randomnum]];
    }

    return outputstring;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:00:06.823

查看返回的字符串在哪里使用。可能您正在保留它并解除分配保留字符串的对象，而无需先释放保留的字符串。Instruments 仍会将这部分代码指向“泄露”的对象。最难的部分是找到“泄密者”。是的，你可以泄露一个字符串，我刚刚写了它的配方。

# iphone - iPhone 崩溃报告 - atos 无法获取符号

> ID：11508704
> 
> 赞同：2
> 
> 时间：2012-07-16T16:40:48.647
> 
> 标签：iphone, xcode4, crash-reports

我收到用户的崩溃报告，说应用程序在启动时崩溃。
我将崩溃报告拖到 Xcode 4 并收到以下信息（这是摘录），
但**Xcode 4 并没有**表示我真正想看到的第 10、24、25 行。

我使用 atos 命令：

```
atos -arch armv6 -o 'MyApp.app'/'MyApp' 0x0000449b 
```

但它显示的只是：
**0x0000449b（在 MyApp 中）+ 64**

**您知道如何阅读第 10、24、25 行中的符号吗？**

```
Incident Identifier: 5142E671-BD08-483A-AAF2-F7D680BE0267
CrashReporter Key:   481fe1c162975f8367127b52824e30d33ffaa014
Hardware Model:      iPhone4,1
Process:         MyApp [2463]
Path:            /var/mobile/Applications/79DE9C42-332C-4243-B637-9DCF6AC4EC35/MyApp.app/MyApp
Identifier:      MyApp
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-07-04 11:37:39.362 -0600
OS Version:      iPhone OS 5.1.1 (9B206)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x353a188f __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x37748259 objc_exception_throw + 33
2   CoreFoundation                  0x353a4a9b -[NSObject doesNotRecognizeSelector:] + 175
3   CoreFoundation                  0x353a3915 ___forwarding___ + 301
4   CoreFoundation                  0x352fe650 _CF_forwarding_prep_0 + 48
5   Foundation                      0x34eaf4ff __57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke_0 + 19
6   CoreFoundation                  0x3536d547 ___CFXNotificationPost_block_invoke_0 + 71
7   CoreFoundation                  0x352f9097 _CFXNotificationPost + 1407
8   Foundation                      0x34e233eb -[NSNotificationCenter postNotificationName:object:userInfo:] + 67
9   Foundation                      0x34e24c1b -[NSNotificationCenter postNotificationName:object:] + 31
10  MyApp                       0x0000449b 0x1000 + 13467
11  UIKit                           0x32e19c31 -[UIApplication _stopDeactivatingForReason:] + 189
12  UIKit                           0x32eb1381 -[UIApplication _handleApplicationResumeEvent:] + 1141
13  UIKit                           0x32dd5b03 -[UIApplication handleEvent:withNewEvent:] + 1075
14  UIKit                           0x32dd5567 -[UIApplication sendEvent:] + 55
15  UIKit                           0x32dd4f3b _UIApplicationHandleEvent + 5827
16  GraphicsServices                0x36f9422b PurpleEventCallback + 883
17  CoreFoundation                  0x35375523 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 39
18  CoreFoundation                  0x353754c5 __CFRunLoopDoSource1 + 141
19  CoreFoundation                  0x35374313 __CFRunLoopRun + 1371
20  CoreFoundation                  0x352f74a5 CFRunLoopRunSpecific + 301
21  CoreFoundation                  0x352f736d CFRunLoopRunInMode + 105
22  GraphicsServices                0x36f93439 GSEventRunModal + 137
23  UIKit                           0x32e03cd5 UIApplicationMain + 1081
24  MyApp                       0x00004b27 0x1000 + 15143
25  MyApp                       0x00003cd0 0x1000 + 11472 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T22:26:10.163

我没有在崩溃日志中找到有关如何读取内存地址的答案。

但是我已经想出了如何修复该错误：
-此崩溃表明它是由本地通知引起的
-引发了 [NSObject doesNotRecognizeSelector:]

于是我在项目中搜索了所有的Local Notifications，并为每个**观察者找到了对应的****选择器**， 其中一个选择器没有实现。这就是为什么我收到 并且应用程序崩溃的原因。 **`-[NSObject doesNotRecognizeSelector:`** 

 **实施缺少的选择器解决了这个问题。**

# mdx - 需要了解 MDX 查询

> ID：11508709
> 
> 赞同：0
> 
> 时间：2012-07-16T16:41:07.183
> 
> 标签：mdx

```
 SELECT 
 { [Measures].[Net] } ON COLUMNS
 , NON EMPTY 
 { ([Bill To].[Customer Name].[Customer Name].ALLMEMBERS 
 * [Bill To].[Account Type].[Account Type].ALLMEMBERS 
 * [Reporting Date].[Fiscal Period].[Fiscal Period].ALLMEMBERS ) } 
 DIMENSION PROPERTIES MEMBER_CAPTION, MEMBER_UNIQUE_NAME 
 ON ROWS 
 FROM ( SELECT ( STRTOSET(@EmployeeDimEmployeeManagerCode ) )  ON COLUMNS 
         FROM ( SELECT ( STRTOSET(@BillToDimCustAccountType ) ) ON COLUMNS 
         FROM ( SELECT ( STRTOSET(@GeneralLedgerDimGLBusinessUnit ) ) ON COLUMNS 
         FROM ( SELECT ( STRTOSET(@CompanyDimCompanyName ) ) ON COLUMNS 
         FROM ( SELECT ( STRTOMEMBER(@FromCalendarDateDimMonth ) : STRTOMEMBER(@FromCalendarDateDimMonth ).LAG(11) ) ON COLUMNS 
         FROM [Revenue])))))  WHERE ( IIF( STRTOSET(@CompanyDimCompanyName, CONSTRAINED).Count = 1
 , STRTOSET(@CompanyDimCompanyName, CONSTRAINED)
 , [Company].[Company].currentmember )
 , IIF( STRTOSET(@GeneralLedgerDimGLBusinessUnit, CONSTRAINED).Count = 1
 , STRTOSET(@GeneralLedgerDimGLBusinessUnit, CONSTRAINED)
 , [Product].[GL Business Unit].currentmember )
 , IIF( STRTOSET(@EmployeeDimEmployeeManagerCode, CONSTRAINED).Count = 1
 , STRTOSET(@EmployeeDimEmployeeManagerCode, CONSTRAINED)
 , [Order Primary Sales Assignment].[Order Primary Sales Assignment Manager Name].currentmember ) ) 
 CELL PROPERTIES VALUE, BACK_COLOR, FORE_COLOR, FORMATTED_VALUE
 , FORMAT_STRING, FONT_NAME, FONT_SIZE, FONT_FLAGS 
```

我只是一个菜鸟 MDX 开发人员。在上面的查询（由其他人编写）中，我不理解“来自”部分。为什么我们将 strtoset 参数放在列中，我们从收入立方体中提取什么？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T18:33:49.540

此查询包含[子选择](http://msdn.microsoft.com/en-us/library/ff487138.aspx)；此功能用于过滤查询。

`@EmployeeDimEmployeeManagerCode`在执行查询之前，所有变量都将被替换。StrToSet[函数](http://msdn.microsoft.com/en-us/library/ms144782.aspx)用于降低注入攻击的风险。

# core-data - 需要在restkit配置的App中选择核心数据并发布

> ID：11508711
> 
> 赞同：0
> 
> 时间：2012-07-16T16:41:17.507
> 
> 标签：core-data, post, boolean, restkit, predicate

我无法找到从现有 Core Data SQLite DB 中选择数据并发布它的示例。根据调试输出，我的核心数据似乎配置正常。我已将其设置为显示 SQLite 操作。当我尝试对布尔属性执行谓词或加载时，它不会给出错误，但它会检索零个对象。

```
@interface Offering : NSManagedObject

@property (nonatomic, retain) NSNumber * id;
@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSNumber * uploadToServerRequired; 

#import "AppDelegate.h"
#import <RestKit/RestKit.h>
#import "Offering.h"

@implementation AppDelegate

@synthesize window = _window;
@synthesize managedObjectContext = __managedObjectContext;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions

    RKObjectManager* manager = 
    [RKObjectManager objectManagerWithBaseURL: [[NSURL  alloc] initWithString:@"http://localhost:8080/anywhereAboutWebServices"] ];
    manager.objectStore = [RKManagedObjectStore objectStoreWithStoreFilename:@"AnywhereAbout2.sqlite"];

 NSError *error;

    NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"AnywhereAbout2.sqlite"];
    NSURL *url = [NSURL fileURLWithPath:path];

    NSManagedObjectModel *managedObjectModel = [NSManagedObjectModel mergedModelFromBundles:nil];
    NSPersistentStoreCoordinator *persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:managedObjectModel];
    if (![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:url options:[NSDictionary dictionaryWithObjectsAndKeys:     [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,                                 [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil] error:&error]);
    else {
        __managedObjectContext = [[NSManagedObjectContext alloc] init];
        [__managedObjectContext setPersistentStoreCoordinator: persistentStoreCoordinator];

    }

    NSArray* objects = [Offering allObjects];
    NSLog(@"We loaded %d objects", [objects count]);

    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"uploadToServerRequired == %@", [NSNumber numberWithBool: (BOOL)1]];

    int count = [filtered count]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T15:02:34.597

添加以下内容并使其工作：

```
NSFetchRequest *request = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Offering" inManagedObjectContext:__managedObjectContext];
[request setEntity:entity];

NSError *anyError = nil;
NSArray *fetched = [__managedObjectContext executeFetchRequest:request error: &anyError];
if (fetched == nil) {
     NSLog(@"Error with fetch");
}
NSLog(@"We fetched %d objects", [fetched count]); 
```

# c++ - 在多个 .cpp 中包含相同的标头

> ID：11508712
> 
> 赞同：0
> 
> 时间：2012-07-16T16:41:18.603
> 
> 标签：c++, c, header, linker

我正在尝试在许多其他 .cpp 文件中使用来自一个 .h 文件的数据（甚至函数），并且我得到一个编译器区域，提示链接错误。我知道这将非常简单，但我正在伤害自己。我正在使用 Xcode，但我认为这不是问题所在，更有可能是我有点思考！

我的版本更复杂，所以我将使用一个非常简单的示例来说明我正在寻找的内容。

如果我有一个头文件 data1.h：

```
 int a,b; // etc 
```

然后是一个 .cpp 文件，比如 setdataA.cpp：

```
 #include "data1.h"    
 void set_a(int numb){ a=1;} 
```

然后另一个，说 setdataB.cpp：

```
 #include "data1.h"    
 void set_b(int numb){ b=10;} 
```

我想知道我做错了什么，也许我什至应该尝试做这样的事情。

我什至尝试过交换

```
#include "data1.h" 
```

在 setdataB.cpp 到

```
#include "setdataA.h" 
```

但它仍然不起作用！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:10:59.513

首先，如果您提供了实际错误，将会有所帮助。

其次，您应该使用这样的 INCLUDE GUARD 包装您的标题内容：

```
#ifndef MY_UNIQUE_INCLUDE_GUARD
#define MY_UNIQUE_INCLUDE_GUARD
... // header contents
#endif 
```

第三，您的问题可能是 ints a 和 b 都在两个 .cpp 文件中定义（通过标题包含）导致多个定义的符号。

相反，您可能的意思是在标题中声明它们而不定义它们：

```
extern int a;
extern int b; 
```

然后，在 .cpp 文件中，定义它们：

```
int a;
int b; 
```

只需在一个 .cpp 文件中定义它们。如果这对您的项目有意义，您可以在一个 .cpp 文件中定义 a 并在另一个 .cpp 文件中定义 b 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-16T16:06:53.273

我弄清楚我做错了什么。这与我对头文件实际工作方式的误解有关，而我实际尝试做的事情是如此简单/基本，以至于人们（回答我的人）误认为我实际上在尝试做什么（我向他们道歉） .

我应该做的是放在data1.cpp中

```
int a;
int b;

void set_a(int numb) { a=numb; }
void set_b(int numb) { b=numb; }

int get_a() { return a }
int get_b() { return b } 
```

然后在 data.h 中放

```
void set_a(int numb);
void set_b(int numb);

int get_a();
int get_b(); 
```

然后，data.h 可以根据需要包含在尽可能多的文件中，并且可以通过调用其中一个函数而不是直接更改或调用它们的值来实现 a 或 b 的设置或获取。

希望这可以帮助人们，如果他们曾经试图解决这个问题。

（也很抱歉很长时间才回来回答这个问题，因为当我认为它是如此初级以至于我对我在提问时缺乏知识感到有点羞愧时，我有点尴尬。其次，因为这是我的第一次堆栈上的问题，我也认为可以更好地提出我的问题，以更好地了解我的要求）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T16:57:56.670

我对此有点生疏，但我相信只要包含已包含的文件，就会出现链接错误。从您的示例来看，情况似乎并非如此，但请仔细查看您的文件。此示例会给您一个错误：file1.h 包含 file2.h，而 file3.h 同时包含 file1 和 file2。您会看到在这种情况下 file2 将在 file3 中包含两次。

# .htaccess - HTAccess 多页

> ID：11508714
> 
> 赞同：0
> 
> 时间：2012-07-16T16:41:42.973
> 
> 标签：.htaccess

我需要转换这个

www.test.com/app.program?id=5

进入

www.test.com/app.program/5

我已经设置好删除 .php 文件扩展名了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:56:14.680

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/([0-9]+)$ /$1?id=$2 [L] 
```

更改`[L]`为`[L,QSA]`是否要将查询字符串附加到末尾，例如，如果您尝试访问：`http://www.test.com/app.program/5?some-other-param=value`，它将被附加到重写的末尾，以便 URI 为：`/app.program?id=5&some-other-param=value`

# c# - 使用树视图插入、更新和删除

> ID：11508716
> 
> 赞同：-6
> 
> 时间：2012-07-16T16:41:51.983
> 
> 标签：c#, asp.net, sql-server

我想知道如何使用数据库中的树视图插入、更新和删除，我希望有一个表，但能够在树视图上从数据库中检索父节点和节点。

如果您有任何可以帮助我的链接，请给我谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:43:57.630

树是分层的；关系数据库是基于集合的。

您必须将表中的映射器写入树视图或使用现有的映射器。

# sql - 编译器错误 E2451 函数 main() 中未定义符号“EXEC”

> ID：11508718
> 
> 赞同：1
> 
> 时间：2012-07-16T16:42:14.097
> 
> 标签：sql, c, oracle

这是我从网站上获得的程序示例：[http](http://www.csee.umbc.edu/portal/help/oracle8/server.815/a68022/sql.htm) ://www.csee.umbc.edu/portal/help/oracle8/server.815/a68022/sql.htm ：

```
#include <stdio.h> 

/* declare host variables */ 
char userid[12] = "SCOTT/TIGER";
char emp_name[10];
int emp_number;
int dept_number; 
char temp[32];
void sql_error();

/* include the SQL Communications Area */ 
//#include <sqlca.h> 

main() 
{ emp_number = 7499;
/* handle errors */ 
EXEC SQL WHENEVER SQLERROR do sql_error("Oracle error");

/* connect to Oracle */ 
EXEC SQL CONNECT :userid; 
printf("Connected.\n"); 

/* declare a cursor */ 
EXEC SQL DECLARE emp_cursor CURSOR FOR 
SELECT ename 
FROM emp 
WHERE deptno = :dept_number; 
```

每当编译器到达该`EXEC`语句时，就会发生编译错误：

> E2451 SQL.CPP 17：函数 main() 中未定义的符号“EXEC”

我正在使用 Borland c++ VER 5.5.1 和 SQL 2008 R2。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:47:15.977

这些 SQL 语句不是有效的 C 代码，在编译之前需要经过额外的预处理器，它知道如何将原始 SQL 语句转换为 C。

从您的链接的前几章开始，特别是[第 1 章](http://www.csee.umbc.edu/portal/help/oracle8/server.815/a68022/intro.htm)，*什么是 Oracle 预编译器？*.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:26:15.837

该页面上的代码**不是 C++**。

[它是与Pro*C/C++ Precompiler](http://www.csee.umbc.edu/portal/help/oracle8/server.815/a68022/intro.htm)一起使用的特殊方言。（从@pb2q 复制的链接。）

# fonts - GTK：更改文本视图中的一系列文本样式

> ID：11508723
> 
> 赞同：1
> 
> 时间：2012-07-16T16:42:29.477
> 
> 标签：fonts, gtk, gtktextview

我正在使用 gtk+2.0 在 Ubuntu 中编写 C 应用程序。

我有一个 textview 来显示聊天消息。每条消息都低于发送时间。

我想要做的是使用不同的字体样式（例如颜色）来显示它们。

我找到了这些字体选择器和颜色选择器，但我还没有找到如何使用它们。

有人可以给我一些建议或更好的例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T22:03:40.880

文本视图中显示的文本由[`GtkTextBuffer`](http://developer.gnome.org/gtk/stable/GtkTextBuffer.html). 要更改文本缓冲区的一部分的外观，您可以创建一个[`GtkTextTag`](http://developer.gnome.org/gtk/stable/GtkTextTag.html)，例如使用[`gtk_text_buffer_create_tag()`](http://developer.gnome.org/gtk/stable/GtkTextBuffer.html#gtk-text-buffer-create-tag)，根据需要设置字体和颜色，并将标记应用到[`gtk_text_buffer_apply_tag()`](http://developer.gnome.org/gtk/stable/GtkTextBuffer.html#gtk-text-buffer-apply-tag)由开始和结束迭代器标识的文本缓冲区范围内。

可能值得看一下 Gtk+ 手册，其中有一[节](http://developer.gnome.org/gtk/stable/TextWidget.html)描述了不同组件如何协同工作。

# excel - 在 Windows 07 中从 excel VBA 以管理员模式打开文件

> ID：11508724
> 
> 赞同：0
> 
> 时间：2012-07-16T16:42:30.917
> 
> 标签：excel, vba

我有一个excel文件，里面有一个按钮。如果我点击按钮，我应该能够在不同位置的管理员模式下打开文件“myfile.exe”。

有人可以帮助我如何在 Windows07 机器中使用 excel VBA 来实现...？

提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:43:57.057

是的，你可以使用它，`runas`但你需要有密码。

```
Shell "runas /profile /env /user:=<UserName>\admin ""c:\windows\Notepad.exe""" 
```

**快照**

关于 RunAs 的帮助：`runas/?`在 DOS 提示符下键入以查看语法。

![在此处输入图像描述](../Images/3042f18e3d75ad76241864a9b8a47717.png)

# php - 如何缓存同一页面的2个不同内容

> ID：11508727
> 
> 赞同：0
> 
> 时间：2012-07-16T16:42:42.560
> 
> 标签：php, caching

我想知道在登录用户和访客有不同内容的情况下缓存 php-output 的最佳方法是什么。“不同”意味着客人在该页面上看到的文字更少、没有评论并且功能更少（例如，他们无法将当前页面标记为收藏）。

我可以为可以访问页面的每个“模式”创建一个文件。所以我必须检查用户是否登录，然后决定我服务的缓存文件。
另一方面，我可以为每个页面只创建一个文件，并在该文件中使用 php-code 来决定打印出哪些内容（或者更好的是，打印多少内容）。

我更喜欢第二个选项，因为这意味着内容或部分内容不会存储两次。此外，我可以确定没有用户可以通过调用缓存文件来访问完整的内容（无论如何它在名称中使用哈希）。但是，我不确定我是否将所有相关事实都纳入考虑范围。我想知道我是否错过了一些（不利）优势或其他可能的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:46:30.300

我更喜欢第一种方式，它还使您能够以不同的方式缓存这些视图，例如。当添加新评论时，只需要重新渲染成员缓存；第二个也迫使你生成代码，并在以后包含，听起来像 php-selfmodifying-code，地狱调试

# r - R tm 包创建N个最常见术语的矩阵

> ID：11508728
> 
> 赞同：7
> 
> 时间：2012-07-16T16:42:46.627
> 
> 标签：r, text-mining, tm, term-document-matrix

我使用R 中的包`termDocumentMatrix`创建了一个。`tm`

我正在尝试创建一个包含 50 个最常出现的术语的矩阵/数据框。

当我尝试转换为矩阵时，出现此错误：

```
> ap.m <- as.matrix(mydata.dtm)
Error: cannot allocate vector of size 2.0 Gb 
```

所以我尝试使用 Matrix 包转换为稀疏矩阵：

```
> A <- as(mydata.dtm, "sparseMatrix") 
Error in as(from, "CsparseMatrix") : 
  no method or default for coercing "TermDocumentMatrix" to "CsparseMatrix"
> B <- Matrix(mydata.dtm, sparse = TRUE)
Error in asMethod(object) : invalid class 'NA' to dup_mMatrix_as_geMatrix 
```

我尝试使用以下方法访问 tdm 的不同部分：

```
> freqy1 <- data.frame(term1 = findFreqTerms(mydata.dtm, lowfreq=165))
> mydata.dtm[mydata.dtm$ Terms %in% freqy1$term1,]
Error in seq_len(nr) : argument must be coercible to non-negative integer 
```

这是其他一些信息：

```
> str(mydata.dtm)
List of 6
 $ i       : int [1:430206] 377 468 725 3067 3906 4150 4393 5188 5793 6665 ...
 $ j       : int [1:430206] 1 1 1 1 1 1 1 1 1 1 ...
 $ v       : num [1:430206] 1 1 1 1 1 1 1 1 2 3 ...
 $ nrow    : int 15643
 $ ncol    : int 17207
 $ dimnames:List of 2
  ..$ Terms: chr [1:15643] "000" "0mm" "100" "1000" ...
  ..$ Docs : chr [1:17207] "1" "2" "3" "4" ...
 - attr(*, "class")= chr [1:2] "TermDocumentMatrix" "simple_triplet_matrix"
 - attr(*, "Weighting")= chr [1:2] "term frequency" "tf"
> mydata.dtm
A term-document matrix (15643 terms, 17207 documents)

Non-/sparse entries: 430206/268738895
Sparsity           : 100%
Maximal term length: 54 
Weighting          : term frequency (tf) 
```

我的理想输出是这样的：

```
term      frequency
the         2123
and         2095
able         883
...          ... 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-17T07:33:02.370

tm 中的术语文档矩阵已经创建为稀疏矩阵。这里，`mydata.tdm$i`和`mydata.tdm$j`是矩阵的索引`mydata.tdm$v`向量， 是频率的相关向量。这样您就可以创建一个稀疏矩阵写作：

```
sparseMatrix(i=mydata.tdm$i, j=mydata.tdm$j, x=mydata.tdm$v) 
```

然后，您可以使用`rowSums`并将您感兴趣的行链接到它们所代表的术语，用`$Terms`.

# mysql - mysql 性能的最佳解决方案？

> ID：11508731
> 
> 赞同：0
> 
> 时间：2012-07-16T16:42:51.147
> 
> 标签：mysql

我在数据库中有几乎十万条记录......我想根据某些条件选择记录......比如

$val 是一个数组...所以我有一些像这样的选项

使用 for 循环

```
for(){
SELECT * FROM TABLE WHERE ID IN($val[$i]);
} 
```

否则连接......就像

```
$value=$val[$i].','.$val[$i];

SELECT * FROM TABLE WHERE ID IN($value); 
```

或者我可以去 OR 条件

```
SELECT * FROM TABLE WHERE(ID=$value1 OR ID=$value); 
```

哪个是最好的解决方案？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:45:32.177

选项 1 比选项 2 和 3 慢很多。一个查询总是更快。通过这种方式，您可以节省与服务器进行网络通信的时间，这会花费大部分时间进行简单（设计合理）的查询。

要在选项 2 和 3 之间进行选择，请参阅[MYSQL OR 与 IN 性能](https://stackoverflow.com/questions/782915/mysql-or-vs-in-performance)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:47:48.130

这取决于你需要做什么。

如果您想单独处理每个结果集，我会使用该`for`方法。

如果您需要一起处理所有数据，我会采用这种`in`方法。

无论哪种方式，请检查您的表是否已正确索引。

# php - 文件爬虫 PHP

> ID：11508732
> 
> 赞同：2
> 
> 时间：2012-07-16T16:42:51.883
> 
> 标签：php, directory, web-crawler

只是想知道如何递归搜索网站文件夹目录（与脚本上传到的目录相同）并打开/读取每个文件并搜索特定字符串？

例如我可能有这个：

search.php?string=hello%20world

这将运行一个进程，然后输出类似

```
"hello world found inside"

httpdocs
/index.php
/contact.php

httpdocs/private/
../prviate.php
../morestuff.php
../tastey.php

httpdocs/private/love
../../goodness.php 
```

我不希望它链接 - 因为私有文件和未链接文件是圆形的，但我希望其他所有非二进制文件都可以真正访问。

非常感谢

欧文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:59:30.723

我想到了两个直接的解决方案。

1）`grep`与`exec`命令一起使用（仅当服务器支持时）：

```
$query = $_GET['string'];
$found = array();
exec("grep -Ril '" . escapeshellarg($query) . "' " . $_SERVER['DOCUMENT_ROOT'], $found); 
```

完成后，包含查询的每个文件路径都将放在`$found`. 您可以遍历此数组并根据需要处理/显示它。

2）递归遍历文件夹并打开每个文件，搜索字符串，如果找到则保存：

```
function search($file, $query, &$found) {
    if (is_file($file)) {
        $contents = file_get_contents($file);
        if (strpos($contents, $query) !== false) {
            // file contains the query string
            $found[] = $file;
        }
    } else {
        // file is a directory
        $base_dir = $file;
        $dh = opendir($base_dir);
        while (($file = readdir($dh))) {
            if (($file != '.') && ($file != '..')) {
                // call search() on the found file/directory
                search($base_dir . '/' . $file, $query, $found);
            }
        }
        closedir($dh);
    }
}

$query = $_GET['string'];
$found = array();
search($_SERVER['DOCUMENT_ROOT'], $query, $found); 
```

这应该（未经测试）递归搜索每个子文件夹/文件以查找请求的字符串。如果找到，它将在变量中`$found`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:51:22.400

如果目录列表已打开，您可以尝试

```
<?php
$dir = "http://www.blah.com/";
foreach(scandir($dir) as $file){
  print '<a href="'.$dir.$file.'">'.$file.'</a><br>';
}
?> 
```

或者

```
<?php
$dir = "http://www.blah.com/";
$dh  = opendir($dir);
while (false !== ($file = readdir($dh))) {
  print '<a href="'.$dir.$file.'">'.$file.'</a><br>';
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:50:41.310

如果您不能使用任何提到的方法，您可以使用[带有回调的递归目录遍历](http://www.php.net/manual/en/function.scandir.php#96326)。并将您的回调定义为检查给定文件中给定字符串的函数。

# ios - Chrome IOS HTML5 地理定位权限被拒绝

> ID：11508739
> 
> 赞同：10
> 
> 时间：2012-07-16T16:43:17.290
> 
> 标签：ios, html, google-chrome, w3c-geolocation

当尝试在 ios 的移动 chrome 上使用 HTML5 地理定位 api 时，我的应用程序抛出“权限被拒绝”错误，甚至没有提示共享我的位置。有没有其他人遇到过这个问题？

PS。这发生在本地和 heroku 实例上。

这是我在准备好的文档上运行的代码

```
 var displayCloseFoo = function(position) {
        var lat = position.coords.latitude;
        var lon = position.coords.longitude;

    };

    var displayError =  function(error) {
        var errors = {
            1: 'Permission denied',
            2: 'Position unavailable',
            3: 'Request timeout'
        };
        alert("Error: " + errors[error.code]);
    };

    var runGeo =  function(){
        if (navigator.geolocation) {
            var timeoutVal = 10 * 1000 * 1000;
            navigator.geolocation.getCurrentPosition(
                    displayCloseFoo,
                    displayError,
                    { enableHighAccuracy: true, timeout: timeoutVal, maximumAge: 0 }
            );
        }
        else {
            alert("Geolocation is not supported by this browser");
        }
    };
    runGeo(); 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-23T16:19:36.867

您必须明确允许 Mobile Chrome 在 ios 中使用定位服务。在 ios6 中，您可以通过转到 Settings->Privacy->Location Services 并将 Chrome 切换为 On 来实现此目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T03:25:28.143

地理位置在 Chrome 中无法在本地工作...不知道为什么它不能在您的 Heroku 实例中工作

看看这个小提琴......它似乎在这里工作正常...... [http://jsfiddle.net/mattnull/YaCRe/](http://jsfiddle.net/mattnull/YaCRe/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T10:33:41.573

安装 chrome 后。当它打开时，如果你拒绝，它会要求你分享你的位置，你将无法获得位置

# python - 奇怪的字符串剥离

> ID：11508743
> 
> 赞同：0
> 
> 时间：2012-07-16T16:43:28.273
> 
> 标签：python

> **可能重复：**
> [python .rstrip 删除了一个额外的字符](https://stackoverflow.com/questions/6311968/python-rstrip-removes-one-additional-character)

我有一个字符串`vtype`定义为

```
vtype = "vidis.fit" 
```

我想去掉决赛`dis.fit`，所以

```
vtype.rstrip("dis.fit") 
```

但最终结果是`v`，而不是`vi`，我期望/想要的。我对此有点困惑，有人吗？

**编辑**

感谢大家。我想它首先让我感到困惑的原因是，命名`lstrip`和`rstrip`似乎暗示了一些序列，尽管它只对空格很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:46:26.073

`rstrip`实际上[在要剥离的字符串末尾采用一系列字符](http://docs.python.org/library/stdtypes.html#str.rstrip)，而不是要剥离的特定字符串。它正在删除`i`因为`i`在传入的字符序列中。

例如，字符的顺序`rstrip`无关紧要：

```
>>> vtype = "vidis.fit"
>>> vtype.rstrip("dis.fit")
'v'
>>> vtype.rstrip("ditfs.")
'v' 
```

字符出现在其中的次数也不是：

```
>>> vtype.rstrip("ditffffsssss.")
'v' 
```

正如[文档](http://docs.python.org/library/stdtypes.html#str.rstrip)所指定的：

> chars 参数不是后缀；相反，它的值的所有组合都被剥离

**编辑：** 为了好玩，如果您真的想解决“如何在字符串末尾删除字符串”问题，请使用`rfind`切片：

```
>>> vtype[:vtype.rfind("dis.fit")]
'vi' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:46:53.000

"v" 后面的 "i" 被删除，因为它是 'dis.fit' 中的一个字符。to 的参数`strip`不是要删除的子字符串，而是要删除的字符列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T16:52:23.593

如其他答案所示， rstrip 需要删除一系列字符，而不是特定字符串。

```
"vidis.fit".replace("dis.fit", "") 
```

实际上会做你想做的事情......除非“dis.fit”序列可能出现不止一次，或者出现在不同的位置。在这种情况下，您可能可以制定一些正则表达式解决方案。

# django - Django模型按外键过滤

> ID：11508744
> 
> 赞同：20
> 
> 时间：2012-07-16T16:43:36.013
> 
> 标签：django, filter, foreign-keys, models

我在从一组模型中过滤对象时遇到了一些麻烦。这是问题所在：

我有 3 节课：

```
class Autor(models.Model):    
    nome = models.CharField(max_length=50)
    slug = models.SlugField(max_length=50, blank=True, unique=True)
    foto = models.ImageField(upload_to='autores/', null=True, blank=True)
    ...

class CategoriaRecolha(models.Model):
    categoria = models.CharField(max_length=30)
    descricao = models.TextField()
    slug = models.SlugField(max_length=30, blank=True, unique=True)
    ...

class Recolha(models.Model):    
    titulo = models.CharField(max_length=100)
    slug = models.SlugField(max_length=100, blank=True, unique=True)
    descricao = models.TextField()
    ficha_tec = models.TextField()
    categoria = models.ForeignKey(CategoriaRecolha)
    autor = models.ForeignKey(Autor)
    .... 
```

我要检索的是 Autor 类的字段，其中 Recolha 类的字段类别等于特定值。

以更简单的方式，我需要获取所有参与特定类别的作者。

谢谢

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-07-16T17:02:50.447

更直接的选择：

```
autors = Autor.objects.filter(recolha__categoria=MyCategoria) 
```

`MyCategoria`相关`CategoriaRecolha`实例在哪里。或者，如果您想再次匹配特定类别名称，您可以将查询扩展到另一个级别：

```
autors = Autor.objects.filter(recolha__categoria__categoria='my_category_name') 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2018-01-31T10:11:34.550

在 django 2 中是 ForeignKey.limit_choices_to[文档](https://docs.djangoproject.com/en/2.0/ref/models/fields/)

```
staff_member = models.ForeignKey(
    User,
    on_delete=models.CASCADE,
    limit_choices_to={'is_staff': True},
) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-16T16:54:17.103

```
cat = CategoriaRecolha.objects.get(field=value)
rows = Recolha.filter(categoria=cat)
autors = [row.autor for row in rows] 
```

[Django Docs](https://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships)很好地解释了这一点。

# python - 如何在python中逐行并行读取两个文件？

> ID：11508746
> 
> 赞同：3
> 
> 时间：2012-07-16T16:43:40.983
> 
> 标签：python, dictionary

我整天都在尝试解决这个问题，但没有成功。

我有一个“原始文件”，我们称之为“infile”，这是我要编辑的文件。另外，我还有另一个文件用作“字典”，我们称它为“inlist”。

以下是 infile 的示例：

```
PRMT6   10505   Q96LA8  HMGA1   02829   NP_665906
WDR77   14387   NP_077007   SNRPE   00548   NP_003085
NCOA3   03570   NP_858045   RELA    01241   NP_068810
ITCH    07565   Q96J02  DTX1    03991   NP_004407 
```

和清单：

```
NP_060607   Q96LA8
NP_001244066    Q96J02
NP_077007   Q9BQA1
NP_858045   Q9Y6Q9 
```

我目前的方法包括拆分各列中的行，按现有选项卡拆分行。目标是读取 infile 的每一行并检查一些内容：

1.  如果 infile 的第 3 列中的元素在 inlist 的第 1 列中找到，则为 inlist 第 2 列中的相应元素更改该元素
2.  如果 infile 的第 3 列中的元素在 inlist 的第 2 列中找到，则不执行任何操作
3.  infile 的第 5 列也是如此

这应该检索输出：

```
PRMT6   10505   Q96LA8  HMGA1   02829   Q(...)
WDR77   14387   Q9BQA1  SNRPE   00548   Q(...)
NCOA3   03570   Q9Y6Q9  RELA    01241   Q(...)
ITCH    07565   Q96J02  DTX1    03991   Q(...) 
```

注意：并非所有代码都以 Q 开头

我尝试过使用while循环，但没有成功，我很惭愧在这里发布代码（我是编程新手，所以我不想在“游戏”中这么早就失去动力） . 解决这个问题的完美方法是：

```
for line in inlist #, infile: <--- THIS PART! Reading both files, splitting both files, replacing both files...
        inlistcolumns = line.split('\t')
        infilecolumns = line.split('\t')
        if inlistcolumns[0] in infilecolumns[2]:
            outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(inlistcolumns[1]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(infilecolumns[5]) + "\n")
        elif inlistcolumns[0] in infilecolumns[5]:
            outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(infilecolumns[2]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(inlistcolumns[1]) + "\n")
        else:
            outfile.write('\t'.join(infilecolumns) + '\n') 
```

帮助将不胜感激。谢谢！

好的，在 Sephallia 和 Jlengrand 的提示之后，我得到了这个：

```
for line in infile:
    try:
    # Read lines in the dictionary
        line2 = inlist.readline()
        inlistcolumns = line.split('\t')
        infilecolumns = line.split('\t')
        if inlistcolumns[0] in infilecolumns[2]:
            outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(inlistcolumns[1]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(infilecolumns[5]))
        elif inlistcolumns[0] in infilecolumns[5]:
                outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(infilecolumns[2]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(inlistcolumns[1]))
        else:
                    outfile.write('\t'.join(infilecolumns))
    except IndexError:
        print "End of dictionary reached. Restarting from top." 
```

问题是 if 语句显然没有发挥作用，因为输出文件仍然等于输入文件。我做错了什么？

编辑2：

正如一些人所问的，这里有完整的代码：

```
 import os

def replace(infilename, linename, outfilename):
    # Open original file and output file
    infile = open(infilename, 'rt')
    inlist = open(linename, 'rt')
    outfile = open(outfilename, 'wt')

    # Read lines and find those to be replaced
    for line in infile:
        infilecolumns = line.split('\t')
        line2 = inlist.readline()
        inlistcolumns = line2.split('\t')
        if inlistcolumns[0] in infilecolumns[2]:
            outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(inlistcolumns[1]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(infilecolumns[5]))
        elif inlistcolumns[0] in infilecolumns[5]:
            outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(infilecolumns[2]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(inlistcolumns[1]))
        outfile.write('\t'.join(infilecolumns))

    # Close files
    infile.close()
    inlist.close()
    outfile.close()

if __name__ == '__main__':
    wdir = os.getcwd()
    outdir = os.path.join(wdir, 'results.txt')
    outname = os.path.basename(outdir)
    original = raw_input("Type the name of the file to be parsed\n")
    inputlist = raw_input("Type the name of the libary to be used\n")
    linesdir = os.path.join(wdir, inputlist)
    linesname = os.path.basename(linesdir)
    indir = os.path.join(wdir, original)
    inname = os.path.basename(indir)

    replace(indir, linesdir, outdir)

    print "Successfully applied changes.\nOriginal: %s\nLibrary: %s\nOutput:%s" % (inname, linesname, outname) 
```

要使用的第一个文件是 hprdtotal.txt：[https](https://www.dropbox.com/s/hohvlcdqvziewte/hprdmap.txt) ://www.dropbox.com/s/hohvlcdqvziewte/hprdmap.txt 第二个是 hprdmap.txt：[https ://www.dropbox.com/s/9hd0e3a8rt95pao/ hprdtotal.txt](https://www.dropbox.com/s/9hd0e3a8rt95pao/hprdtotal.txt)

希望这可以帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:54:41.400

不会像这样简单地工作吗？

（按照你的片段）

```
for line in infile: # read file 1 one line after the other
        try
            line2 = inlist.readline() # read a line of file 2
        catch Exception:
            print "End of file 2 reached"
        inlistcolumns = line.split('\t')
        infilecolumns = line.split('\t')
        if inlistcolumns[0] in infilecolumns[2]:
            outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(inlistcolumns[1]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(infilecolumns[5]) + "\n")
        elif inlistcolumns[0] in infilecolumns[5]:
            outfile.write(str(infilecolumns[0]) + "\t" + str(infilecolumns[1]) + "\t" + str(infilecolumns[2]) + "\t" + str(infilecolumns[3]) + "\t" + str(infilecolumns[4]) + "\t" + str(inlistcolumns[1]) + "\n")
        else:
            outfile.write('\t'.join(infilecolumns) + '\n') 
```

我真的不明白为什么不先将文件保存在内存中，然后做一个简单的模式研究。我有正当的理由让你同时阅读这两个文件吗？（文件 1 的第 45 行是否与文件 2 的第 45 行匹配？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:12:45.613

您需要做的是首先将`inlist`文件读入内存，以便可以检查。

```
initems = []
for line in inlist:
    split = line.split()
    t = tuple(split[0], split[1])
    initems.append(t)
firstItems = dict(initems)
secondItems = [x[1] for x in initems] 
```

这将为您提供要打击的数据。然后打开你的 infile 并通读它，检查你的数据。

```
for line in infile:
    split = line.split('\t')
    if split[2] in firstItems.keys():
        split[2] = firstItems[split[2]] # proper field position
    if split[5] in firstItems.keys():
        split[5] = firstItems[split[5]] # proper field position
    outfile.write('\t'.join(split)+'\n') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:12:59.543

我建议将`inlist`查找表作为查找表加载到内存中 - 这是`dict`Python 中的 a 并循环`infile`并使用查找表来决定是否要替换。

我不是 100% 确定我在这里的逻辑是正确的，但它是你可以建立的基础。

```
import csv

lookup = {}
uniq2nd = set()
with open('inlist') as f:
    tabin = csv.reader(f, delimiter='\t')
    for c1, c2 in tabin:
        lookup[c1] = c2
        uniq2nd.add(c2)

with open('infile') as f, open('outfile', 'wb') as fout:
    tabin = csv.reader(f, delimiter='\t')
    tabout = csv.writer(fout, delimiter='\t')
    for row in csv.reader(tabin):
        if row[2] not in uniq2nd: # do nothing if col2 of inlist
            row[2] = lookup.get(row[2], row[2]) # replace or keep same
        # etc...
    csvout.writerow(row) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T17:32:08.547

```
#!/usr/bin/python

inFile = open("file1.txt")
inList = open("file2.txt")
oFile = open("output.txt", "w")

entry = {}
dictionary = {}

# Creates the dict for inFile
for line in inFile:
    lineData = line.split('\t')
    data = []
    for element in lineData:
        element = element.strip()
        data.append(element)
    entry[lineData[0]] = data

# Creates the dict for inList
for line in inList:
    lineData = line.split('\t')
    dictionary[lineData[0].strip()] = lineData[1].strip()

# Applies transformation to inFile
for item in entry.values():
    if item[2].startswith("-"):
        item[2] = item[2][1:-1]
    for key in dictionary.items():
        if item[2] == key[0]:
            item[2] = key[1]        
    item[5] = item[2]

# Writes the output file
for item in entry.values():
    for element in item:
        oFile.write(str(element))
        oFile.write('\t')
    oFile.write('\n') 
```

请注意，请确保使用正确的分隔符适当地格式化您的 inFile 和 inList。在这种情况下，我使用制表符 (\t) 来分割行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-17T16:52:49.707

好的，我发现了。这就是我所做的：

```
data = {}
    for line in inlist:
        k, v = [x.strip() for x in line.split('\t')]
        data[k] = v

    for line in infile:
        infilecolumns = line.strip().split('\t')

        value1 = data.get(infilecolumns[2])
        value2 = data.get(infilecolumns[5])

        if value1:
            infilecolumns[2] = value1
        if value2:
            infilecolumns[5] = value2

        outfile.write('\t'.join(infilecolumns) + '\n') 
```

这使所需的输出既好又容易。谢谢大家的回答，对我帮助很大！

# entity-framework-4.1 - 如何在 Code First 中建模 1 到 0 或 1

> ID：11508751
> 
> 赞同：1
> 
> 时间：2012-07-16T16:44:05.323
> 
> 标签：entity-framework-4.1

一个人可以有一个分配给他们的“程序 id 代码”，但该代码可以重新分配给其他人，但这个代码永远不能分配给多个人。此外，不需要分配程序 ID。

这听起来像是 1 到 0 或 1 - 我如何在代码优先方法中对此进行编码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:50:09.867

这将为您提供一对一/一对零的关系

```
public class User
{
  public int ID { set;get;}
  public string Name { set;get;}
  public virtual Program Program { set;get;}
}

public class Program
{
  public int ID { set;get;}
  public string ProgramName {set;get;}
} 
```

这将为您提供这样的表格，您可以在其中建立一对一/零关系

![在此处输入图像描述](../Images/fe343552b40e9c7e324c3e14ff13ddb3.png)

# php - 从“mysqli->prepare”导出“query”

> ID：11508752
> 
> 赞同：5
> 
> 时间：2012-07-16T16:44:09.257
> 
> 标签：php, mysqli, prepared-statement

是否可以导出由`mysqli::prepare`and格式化的查询`::bind_param`？

例子：

```
<?php
$mysqli = new mysqli('host', 'user', 'pass', 'table');
if(mysqli_connect_errno()){
    printf('Connect failed: %s\n', mysqli_connect_error());
    exit;
}

$data=7290;

if ($stmt = $mysqli->prepare('SELECT `id`,`info` FROM `propertys` WHERE id>?')){
    $stmt->bind_param('i',$data);
    $stmt->execute();
    $stmt->bind_result($id,$info);
    while($q=$stmt->fetch()){
        echo $id,': ',$info,'<br>';
    }
    $stmt->close();
}
$mysqli->close();
?> 
```

我想导出由等`QUERY`执行的功能 （这是一个虚构的例子）：`mysql::prepare``bind_param`

```
if ($stmt = $mysqli->prepare('SELECT `id`,`info` FROM `propertys` WHERE id>?')){
    $stmt->bind_param('i',$data);
    $stmt->execute();
    echo $stmt->exportQuery();//Function does not exist, just for example 
```

该函数`::exportQuery`将像这样打印：

```
SELECT `id`,`info` FROM `propertys` WHERE id>7290 
```

有什么解决办法吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-13T22:28:34.790

我知道这对调试很有用，但这不是准备好的语句的工作方式。参数不与客户端上的准备好的语句组合。PHP 永远不应访问与其参数组合的查询字符串。

执行prepare() 时将SQL 语句发送到数据库服务器，执行execute() 时将单独发送参数。MySQL 的一般查询日志确实显示了最终的 SQL，其中包含在您执行 () 之后插入的值。以下是我的一般查询日志的摘录。我从 mysql CLI 而不是 PHP 运行查询，但原理是一样的。

```
081016 16:51:28 2 Query       prepare s1 from 'select * from foo where i = ?'
                2 Prepare     [2] select * from foo where i = ?
081016 16:51:39 2 Query       set @a =1
081016 16:51:47 2 Query       execute s1 using @a
                2 Execute     [2] select * from foo where i = 1 
```

* * *

回复您的评论：

@Baily 是正确的，MySQL 没有客户端解决方案来返回插入参数的完整查询。这不是 PHP 的错。

要启用我上面提到的日志记录，请在 MySQL 客户端中使用此命令，或者通过 API 从 PHP 提交：

```
SET GLOBAL general_log = ON; 
```

收集完信息后，您应该关闭日志，因为记录每个查询确实需要一些开销。

```
SET GLOBAL general_log = OFF; 
```

PS：动态更改日志设置需要 MySQL 5.1 或更高版本。在早期版本中，更改日志记录时必须重新启动 mysqld。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T21:01:39.530

准备好的语句不能那样工作，你看不到语句是有原因的，因为它应该能够在不进行操作的情况下传递给数据库。

因此，唯一的解决方案是将数据附加到字符串，然后回显或保存到变量。

**编辑**以包括您评论的安全问题..

```
//Assume you're using $_GET to get the id
$data = mysql_real_escape_string($_GET['yourID']);

$yourStatement = 'SELECT `id`,`info` FROM `propertys` WHERE id>';
$savedStatement = $yourStatement.$data;

echo $savedStatement;
//Will return 'SELECT `id`,`info` FROM `propertys` WHERE id>4'

if ($stmt = $mysqli->prepare($yourStatement.'?')){
$stmt->bind_param('i',$data);
$stmt->execute();
  } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-06-14T20:48:22.130

您可以在 echo 行上重复查询字符串，然后手动将变量放入字符串中，如下所示：

```
if ($stmt = $mysqli->prepare('SELECT `id`,`info` FROM `propertys` WHERE id>?')){
    $stmt->bind_param('i',$data);
    if($stmt->execute()){
        echo 'SELECT `id`,`info` FROM `propertys` WHERE id>'.$data;
    };
} 
```

您发布的许多评论表明您的问题实际上是：

[如何显示在 MySQL 上执行的最后一个查询？](https://stackoverflow.com/questions/650238/how-to-show-the-last-queries-executed-on-mysql)

# android - Eclipse 没有用于布局的 Android 开发的智能感知

> ID：11508757
> 
> 赞同：0
> 
> 时间：2012-07-16T16:44:31.220
> 
> 标签：android, eclipse

我开始使用 Android 开发，并且无法让建议框/智能感知在 XML 布局中工作。

我阅读了许多建议更新“其他 Java 提案”的内容辅助设置的文章，但没有选择。

![在此处输入图像描述](../Images/7014bae8c7605644746a189327ee9c9e.png)

所以，目前我的布局页面中没有弹出任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:22:34.547

尝试使用打开您的 XML 文件，`Android Common XML Editor`而不是仅将其打开为`XML File`.

至于 Ctrl + 空格，请遵循以下问题： [Eclipse 中的 Ctrl-Space without Pressing Ctrl-Space](https://stackoverflow.com/questions/1959946/ctrl-space-in-eclipse-without-pressing-ctrl-space)

# facebook - Facebook 错误：“发生意外错误。请稍后重试您的请求。”

> ID：11508760
> 
> 赞同：3
> 
> 时间：2012-07-16T16:44:39.673
> 
> 标签：facebook, facebook-graph-api

从上周五 7 月 13 日开始，我们收到“发生意外错误。请稍后重试您的请求”。我们的 OG Graph 对象帖子的错误。在相同的 API 发布率下，我们对这些 API 调用的错误率在大约一分钟内从 0.13% 上升到 65%（不到 1% 到 65%）。周六下降到 46% 左右，目前为 28%。

我们通常会自动重试这些，但是当错误率上升时我们不得不禁用它，因为它阻塞了我们的队列。

如果我们手动重试任何失败的，它们每次都会失败并出现此错误。

这似乎只发生在我们的 OG 动作/对象组合之一 - “赢得奖牌”。我们所有的其他组合都可以在手动测试中正常工作。

由于我们的错误率突然上升，非常高，并且重试不起作用，显然有些错误。

我们可以超过速率限制吗？我们的“奖牌”OG Object 发生了什么事吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:44:39.673

在进行了一些手动测试后，我们意识到这只发生在我们的“奖牌”OG 对象（id 4）的特定实例中。其他人工作得很好。[所以我们在FB 的 URL 调试器](http://developers.facebook.com/tools/debug)中尝试了其中的一些实例（id 1 到 5），它们都解析得很好。

然后尝试再次手动发布这些奖牌，然后 id 4 每次都有效。

似乎 FB 上周五自动抓取了我们的 OG 对象，并且奖牌 id 4 对象请求由于某种原因失败，导致该对象的缓存在 FB 结束时消失。

因此，如果您发现 OG 对象 API 调用错误突然大幅增加，请尝试手动重新缓存失败的对象实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-19T04:21:09.827

值得注意的是，此错误可能会在没有合理原因的情况下随机发生。在根据限制参数获取页面的 Facebook 帖子时，我已经多次看到这种情况。如果我要求限制 100 的页面的 Facebook 帖子，我会收到错误消息：

```
{
  error: {
    message: "An unexpected error has occurred. Please retry your request later.",
    type: "OAuthException",
    is_transient: true,
    code: 2
  }
} 
```

如果我以限制 2 要求它，我不会得到错误。您可能会认为超时可能会导致这种情况。这是可能的，因为我之前已经看到过（当您请求大量数据时），但在这种情况下，将限制增加到 3 也会导致错误。 `limit=2`很好，同时`limit=3`导致上述错误。这是一个错误

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-19T21:15:40.197

我一直在寻找大约八小时的解决方案，在我的情况下，名称问题是“*发生了意外错误。请稍后重试您的请求。* ”在**错误的 PAGE ID** ... OMG

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-28T17:25:10.337

我不知道你是否解决了这个问题。尝试在 Facebook 上增加帖子或执行某些其他操作时，我的屏幕上出现了此错误消息。我终于发现我的间谍软件卡巴斯基安全软件正在干扰该功能。如果您有此或其他防病毒程序，请尝试暂时禁用或暂停保护。这意味着您将在没有防病毒程序的情况下处理敏感数据，但您的本地防火墙和病毒防护仍然存在。这很烦人......有时卡巴斯基的行为更像是病毒而不是反病毒。也许facebook支持人员也可以注意到这一点，因为这可能会解决许多拥有它但没有通过您建议的步骤找到解决方案的问题（例如，在卡巴斯基开启的情况下，我也无法访问广告管理器...... )

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-09T05:16:13.060

试试这个。这个对我有用

```
<?php 
$url = 'https://developers.facebook.com/tools/debug/og/echo?q='. $_SERVER['PATH_INFO'] ;
$response = file_get_contents($url);

?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-29T10:24:28.573

在我的 facebook 时间线上发布一些开放的图形操作和对象时，我遇到了这个错误，但我发现的问题基本上是 facebook 维护的缓存。

我在我的对象 URL 中进行了一些“og”元标记更改（在此处讨论 Open Graph 对象），并且不知何故 facebook 给出了与主要问题中提到的相同的错误，因为它没有在完全刷新我的页面时进行更改。然后，要从 facebook 端刷新这些，我只需要从[facebook 调试器](https://developers.facebook.com/tools/debug)调试我的对象 URL（'http' 和 'https' ） ，瞧！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-02T15:53:02.430

我做了一些测试，如果我更改了发送请求的服务器，因此更改了机器和 IP 地址，则获取相同的数据是 facebook。

# c# - ParseExact 和 TryParseExact 未按预期工作

> ID：11508764
> 
> 赞同：0
> 
> 时间：2012-07-16T16:44:41.407
> 
> 标签：c#, string, parsing, datetime, .net-4.0

我正在尝试转换几个不同的时间，尝试了`DateTime.ParseExact`并且`DateTime.TryParseExact`两者都没有为我工作。

我必须解析的数据格式如下：

```
5 PM
1:00
1:00 AM
12:00
18:00 
```

我尝试了以下方法：

```
DateTime.TryParseExact(stDate, "H:mm", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None, out visStartHour);

visStartHour = DateTime.ParseExact(stDate, "H:mm", System.Globalization.CultureInfo.InvariantCulture, System.Globalization.DateTimeStyles.None); 
```

我还尝试使用格式的字符串数组，但没有一个有效：

```
string[] timeFormats = new string[] { "H tt", "H:mm tt", "HH:mm", "H:mm" }; 
```

还尝试使用：

```
System.Globalization.DateTimeStyles.AllowWhiteSpaces 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:50:23.790

只需使用`TryParse()`

```
DateTime result;

DateTime.TryParse("5 PM", out result);
DateTime.TryParse("1:00", out result);
DateTime.TryParse("1:00 AM", out result);
DateTime.TryParse("12:00", out result);
DateTime.TryParse("18:00", out result); 
```

ETC...

# eclipse - Eclipse 项目中的链接 src 文件夹和 SVN 问题

> ID：11508765
> 
> 赞同：1
> 
> 时间：2012-07-16T16:44:46.277
> 
> 标签：eclipse, svn, subclipse, src, project-setup

我有一个 Eclipse 项目设置，它不直接放置在 SVN 结帐树中 - 相反，我在 Eclipse 中使用“链接 src”选项来设置我的项目。这种方法背后的想法主要是为了使 SVN 签出树免受 Eclipse（和任何正在运行的插件）在创建直接指向父 svn 树结构的项目时造成的所有混乱。这种方法的问题是 subclipse 无法从“链接的 src”文件夹中读取 .svn 信息，因此这些链接资源中的任何一个都无法使用比较/历史记录等功能。问题是有解决办法吗？如果没有，有更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:30:50.213

你为什么不使用 svn ignore 让杂乱无章远离你的 svn 树？见[Subclipse svn:ignore](https://stackoverflow.com/questions/1066809/subclipse-svnignore)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T15:51:11.310

Subclipse 遵循 Eclipse 文档中“链接友好”的策略，即我们自动忽略链接资源。看：

[http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/guide/team_resources_linked.htm](http://help.eclipse.org/juno/topic/org.eclipse.platform.doc.isv/guide/team_resources_linked.htm)

Subclipse 依赖于 Subversion API 进行所有操作，并且 Subversion 与文件系统一起工作。它不了解 Eclipse 特定的功能（如链接资源），因此它只能遵循 Subversion 工作副本的正常语义。它永远无法将这些资源的存在视为工作副本的一部分。

Subclipse 要求项目根目录是一个工作副本，然后包含或忽略的任何其他内容都基于您使用的 Subversion 功能。

# java - 如何在会话中放置一个列表并在 Javascript 中使用它

> ID：11508766
> 
> 赞同：0
> 
> 时间：2012-07-16T16:44:46.127
> 
> 标签：java, javascript, session, servlets

我有一个通知消息列表，我从数据库中提取并放入会话中的 servlet。然后使用`requesDipstacher.forward(request,response`) 将其转发到 jsp 页面。我现在获取消息列表并使用 jstl 循环它：

```
<c:foreach value = "item" items = '${sessionScope.notification}'>
   <a href = "javascript:printAll('${item}'}>Print</a>
</c:foreach> 
```

javascript看起来像这样

```
function printAll(item)
{  
  display(item) //note this is pseudo code . Here I kind of display the items.
} 
```

`print`现在我的问题是我的网页中显示的链接太多了。我想将整个列表发送到 javascript 中并对其进行迭代并显示各个消息。javascript 有可能吗？如果存在，请指出一个相同的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:46:29.630

*如果您将javascript*放在页面的同一文件中没有问题，您可以放置​​如下内容：

```
<script>
function printAll()
{
  var html = '<ul>';
  <c:foreach value = "item" items = '${sessionScope.notification}'>
    html += '<li>${item}</li>';
  </c:foreach>
  html += '</ul>';
  display(html);
}
</script>

<a href = "javascript:printAll();">Print</a> 
```

正如您所注意到的，有多种方法可以解决问题。

# python - 如何在没有额外模型的情况下在 django 中存储数据对？

> ID：11508772
> 
> 赞同：1
> 
> 时间：2012-07-16T16:45:05.697
> 
> 标签：python, django, python-2.7, django-1.4

我想创建一个为我存储账单的应用程序。由于我没有任何东西的固定价格，因此无需将我的服务存储在额外的模型中。我只想存储“动作”和“价格”的数据对，以便在表格中很好地打印出来。

django 中有什么东西可以帮助我完成这项任务，还是我应该将所有数据对放在一个文本字段中并在每次我想使用它时分解它？

每张账单的数据对数量不固定。数据对只在一张账单中使用，所以我不想要额外的表格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:53:41.253

你可能对 Postgres 的 hstore 感兴趣：[http ://www.postgresql.org/docs/9.1/static/hstore.html](http://www.postgresql.org/docs/9.1/static/hstore.html)

[https://github.com/jordanm/django-hstore/](https://github.com/jordanm/django-hstore/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T17:03:23.440

您应该查看更适合存储结构化数据的字段类型，而不是普通的`TextField`：除了 Acorn 的建议 (django-hstore) 之外，a[`JsonField`](https://github.com/django-extensions/django-extensions/blob/master/django_extensions/db/fields/json.py)或 a[`PickleField`](https://github.com/shrubberysoft/django-picklefield#readme)可能是适合您的用例（并且更便携）的解决方案。

# iphone - 确定用户是否通过我的应用在 facebook 上分享

> ID：11508773
> 
> 赞同：0
> 
> 时间：2012-07-16T16:45:08.300
> 
> 标签：iphone, objective-c, facebook-graph-api, ios5

我想知道是否有任何方法可以检查用户是否通过 facebook 共享了指向我的应用程序的链接。我已经实现了分享我的应用程序链接的功能，我只想知道用户是否分享了它。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-18T07:49:08.183

当用户从您的应用程序共享时，您可以存储用户的帖子 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:47:44.473

未经用户许可，您不能查看用户的 Facebook 帖子。一个好主意是，当您创建链接共享代码时，存储用户共享链接的信息。不是最理想的解决方案，但你知道，隐私法和其他东西。

# mongodb - 副本集中的 MongoDB 索引大小

> ID：11508776
> 
> 赞同：1
> 
> 时间：2012-07-16T16:45:12.240
> 
> 标签：mongodb, indexing

我基本上使用的是运行 3 个以上实例的副本集。

我的索引大小目前是：

```
"indexSizes" : {
    "filename_1" : 63290416
} 
```

我已经读过它必须适合 RAM 以避免[出现 The Foursquare Crash](http://highscalability.com/blog/2010/10/15/troubles-with-sharding-what-can-we-learn-from-the-foursquare.html)，但是由于我有 3 台以上的服务器，他们应该都有 64Go（这真的很贵：'（）？如果是，那么我可能需要审查我的索引...

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:08:34.193

`indexSizes`返回以字节为单位的索引，这使得只有 63M ......应该没问题！

# java - 如何清除属于另一个类的文本编辑字段

> ID：11508779
> 
> 赞同：0
> 
> 时间：2012-07-16T16:45:29.237
> 
> 标签：java, android, android-edittext

我正在尝试从另一个类中清除属于另一个类的编辑文本字段。这该怎么做？示例我想从注册类中清除登录类中的编辑文本用户名。我是安卓新手

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:49:53.790

通过调用 et.settext("") 清除 edittext 值。就在从同一个活动成功登录之后.. 这样你就不需要从 diff 类做...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:54:13.693

试试这个..

```
 public class Registration{

    public Login l;

    public void doEdit(){

    l = new Login();

    l.setUserName("");   // setUserName is the Method in Login class to set Username.

    }

} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-16T16:49:08.207

```
 Login myLogin = new Login;

myLogin.clearLogin();

class Login
{
    public clearLogin()
    {
        textField.setText("");
    }
} 
```

# ruby-on-rails - rails 设计：用户和帐户系统

> ID：11508781
> 
> 赞同：1
> 
> 时间：2012-07-16T16:45:31.050
> 
> 标签：ruby-on-rails, devise

几天来，我一直在尝试向用户添加帐户。

我已经顺利安装了 Devise，但现在我想在我的注册表单中添加一个**公司名称字段。**

这是我的代码：

# 应用程序/模型/account.rb

```
class Account < ActiveRecord::Base
   attr_accessible :name
   has_many :users
   accepts_nested_attributes_for :users
end 
```

# 应用程序/模型/user.rb

```
class User < ActiveRecord::Base

   belongs_to :account

   devise :database_authenticatable, :registerable,
     :recoverable, :rememberable, :trackable, :validatable, :confirmable

   attr_accessible :first_name, :last_name, :account_attributes, :account, :email, :password, :password_confirmation, :remember_me

end 
```

# app/views/devise/registrations/new.html.erb

```
<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
   <%= devise_error_messages! %>

   <div><%= f.label :first_name %><br />
   <%= f.text_field :first_name %></div>

   <div><%= f.label :last_name %><br />
   <%= f.text_field :last_name %></div>

   <%= f.fields_for :account do |account_form| %>
      <div><%= account_form.label :name %><br />
  <%= account_form.text_field :name %></div>
   <% end %>

   <div><%= f.label :email %><br />
   <%= f.email_field :email %></div>

   <div><%= f.label :password %><br />
   <%= f.password_field :password %></div>

   <div><%= f.label :password_confirmation %><br />
   <%= f.password_field :password_confirmation %></div>

   <div><%= f.submit "Sign up" %></div>
<% end %> 
```

这就是我拥有的所有代码。我没有再改变什么。

这是我得到的错误：

```
Account(#2175324980) expected, got ActiveSupport::HashWithIndifferentAccess(#2169631580) 
```

提前致谢。

**编辑**

我找到了解决方案：

我变了

```
<%= f.fields_for :account do |account_form| %> 
```

至

```
<%= f.fields_for :account_attributes, resource.account do |account_form| %> 
```

现在我正在尝试向 account_form 添加一个 :plan ，我得到：

```
Can't mass-assign protected attributes: plan 
```

**编辑 2**

好吧，菜鸟的错误。我刚刚将 :plan 添加到帐户模型中。

在那之后我遇到了一个查询错误，我只是将我的数据库中的一些字段从 null => false 更改为 null => true ，瞧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:28:48.490

我希望它看起来像这样。这涉及子类化设计的注册控制器

```
#models
class Account < ActiveRecord::Base
   attr_accessible :name
   has_many :users
end

class User < ActiveRecord::Base
   belongs_to :account
   accepts_nested_attributes_for :account
   attr_accessible :first_name, :last_name, :account_attributes, :account, :email, :password, :password_confirmation, :remember_me

end

#app/controllers/registrations_controller.rb
class RegistrationsController < Devise::RegistrationsController
   def new
      @account = Account.new
      super
   end
end

#routes
devise_for :users, :controllers => {:registrations => "registrations"}

#view
<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
   <%= devise_error_messages! %>

   <div><%= f.label :first_name %><br />
   <%= f.text_field :first_name %></div>

   <div><%= f.label :last_name %><br />
   <%= f.text_field :last_name %></div>

   <%= f.fields_for @account do |account_form| %>
      <div><%= account_form.label :name %><br />
  <%= account_form.text_field :name %></div>
   <% end %>

   <div><%= f.label :email %><br />
   <%= f.email_field :email %></div>

   <div><%= f.label :password %><br />
   <%= f.password_field :password %></div>

   <div><%= f.label :password_confirmation %><br />
   <%= f.password_field :password_confirmation %></div>

   <div><%= f.submit "Sign up" %></div>
<% end %> 
```

# algorithm - LibSVM 和 LibLinear 有什么区别

> ID：11508788
> 
> 赞同：28
> 
> 时间：2012-07-16T16:46:03.547
> 
> 标签：algorithm, machine-learning, svm, libsvm

[libsvm](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)和[liblinear](http://www.csie.ntu.edu.tw/~cjlin/liblinear/)都是实现支持向量机的软件库。有什么不同？以及这些差异如何使 liblinear 比 libsvm 更快？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-07-17T16:07:56.627

实际上，在 libsvm 中实现的 SMO 算法（适用于内核和线性 SVM）的复杂度是 O(n^2) 或 O(n^3)，而 liblinear 是 O(n)，但不支持内核 SVM。n 是训练数据集中的样本数。

因此，对于中到大规模，忘记内核并使用 liblinear（或者看看近似内核 SVM 求解器，例如[LaSVM](http://leon.bottou.org/projects/lasvm)）。

编辑：在实践中，libsvm 在 10k 样本时变得非常缓慢。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-07-16T17:01:34.577

SVM 是[支持向量机](http://en.wikipedia.org/wiki/Support_vector_machine)，它基本上是一个线性分类器，但是使用许多核变换预先将非线性问题变成线性问题。

从上面的链接来看，似乎 liblinear 几乎是一回事，没有那些内核转换。因此，正如他们所说，在不需要内核转换的情况下（他们提到文档分类），它会更快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-17T04:05:51.967

来自：[http ://www.csie.ntu.edu.tw/~cjlin/papers/liblinear.pdf](http://www.csie.ntu.edu.tw/~cjlin/papers/liblinear.pdf)

> 它支持 L2 正则化逻辑回归 (LR)、L2 损失和 L1 损失线性支持向量机 (SVM) (Boser et al., 1992)。它继承了流行的 SVM 库 LIBSVM 的许多特性

您还可能会从其中一位创建者那里看到一些有用的信息：[http ://agbs.kyb.tuebingen.mpg.de/km/bb/showthread.php?tid=710](http://agbs.kyb.tuebingen.mpg.de/km/bb/showthread.php?tid=710)

我想说，主要思想是 liblinear 被*优化*以处理线性分类（即不需要内核），而线性分类只是 libsvm 的众多功能之一，因此在逻辑上它可能与 liblinear 不匹配分类准确度。显然，我在这里做了一些广泛的概括，关于差异的确切细节可能包含在我上面链接的论文以及来自 libsvm 网站的相应用户指南中。

# c# - 什么是有效的事件日志数据源？

> ID：11508790
> 
> 赞同：1
> 
> 时间：2012-07-16T16:46:04.760
> 
> 标签：c#, event-log, azure-diagnostics

我最近一直在摆弄 Azure 诊断，尽管以下代码行的目的相当明确，但我可以用来代替的一组有效值`Application!*`却不是（取自[此处](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.diagnostics.diagnosticmonitorconfiguration.windowseventlog.aspx)）。

```
diagnosticConfiguration.WindowsEventLog.DataSources.Add("Application!*"); 
```

该字符串的语法是什么，特别是......感叹号是什么意思？！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T21:24:06.380

这是标准的 Windows 事件日志查询。[您可以在此处](http://msdn.microsoft.com/en-us/library/dd996910%28VS.85%29.aspx)获得更多信息。还有一些关于 Azure 诊断的解释，特别是[这里](http://blog.smarx.com/posts/capturing-filtered-windows-events-with-windows-azure-diagnostics)。

总之 - Application!* 将获取应用程序事件日志中的所有条目。但是您可以通过更具体来限制这一点 - 例如，如果您希望仅来自特定来源或事件事件类型的事件。

# php - 私有和受保护的区别

> ID：11508791
> 
> 赞同：-2
> 
> 时间：2012-07-16T16:46:05.343
> 
> 标签：php, oop, class, private, protected

`private`在 PHP 中，方法和方法之间似乎没有很大的差异`protected`。

我[问为什么我应该`protected`在 PHP Chatroom 中使用并得到这个答案：](https://chat.stackoverflow.com/transcript/message/4546104#4546104)

> 除非你有充分的理由不这样做：是
> 的，而且有充分的理由是，如果你的代码是闭源库
> ，即使那样，它也可以被反射覆盖

所以 -

如果该`private`方法可能被反射覆盖，那么`private`方法的意义何在？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T17:03:52.233

`private`是否可以更`protected`轻松地编写正确的代码。正如您所注意到的，它们并非牢不可破——如果您愿意，没有什么可以阻止您绕过它们。那是因为它们旨在保护您免于*意外*做错事，而不是积极*尝试*。

你*可以*通过反射绕过它们，并不意味着你*应该*。您可以考虑使用“如果损坏`private`则`protected`保修无效”标签；如果您忽略它们并直接自己乱搞东西，则对象/类可能无法正常运行。 *在这一点上它没有义务*，因为你已经自己搞砸了它的内部 - 而这样做的代码完全是罪魁祸首。

现在，至于标题中的问题……您使用`protected`专门为子类声明接口；您基本上声明您打算让他们直接使用这些东西，而`private`说您不打算。他们是否无视这取决于他们，但如果他们这样做，那就去他妈的。你试图警告他们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:52:13.553

是的，它可以使用反射来覆盖，但这不是重点，重点是在正常使用情况下限制对方法的访问，即如果有人正在使用您的类，他们不应该能够访问该方法，因为它违反了该类的合同拥有。

它是私有的/受保护的，具体取决于它的使用，所以如果有人将一个方法设为私有，那么他们已经完成了它，因为您不需要从另一个类访问它，如果他们已将其设为受保护，那么他们可能只是打算子类能够访问该方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-11-26T10:58:40.833

```
class GrandPa
{
    private $name = 'Mark Henry';

    function getName(){
        return $this->name;
    }
}

class Daddy extends GrandPa
{
    function displayGrandPaName()
    {
        return $this->name;
    }

}

$daddy = new Daddy;

echo $daddy->getName(); // work
echo $daddy->displayGrandPaName(); // Error Undefined property: 
```

尝试更改私人 $name = 'Mark Henry'; 保护

# entity-framework - 实体框架一对多关系

> ID：11508792
> 
> 赞同：0
> 
> 时间：2012-07-16T16:46:07.420
> 
> 标签：entity-framework, ef-code-first, domain-driven-design

嗨，我是 Entity Framework 的新手，这就是我需要的，有两个类，比如说“客户”和“订单”：

```
Class CustomerBE<br/>
{
    Public int CustomerID { get;set;}
    ...Other properties<br/>
}

Class OrderBE<br/>
{
    Public int OrderID{ get; set; }
    Public int CustomerID{ get;set;}
    Public CustomerBE Customer {get;set}
} 
```

如何将订单映射到客户？，我已经阅读了其他一些帖子和一些其他示例，他们正在做的是在 customerBE 中创建一个订单集合，例如：

```
Class CustomerBE
{
    Public int CustomerID{get;set;}
    Public Virtual ICollection Orders<orderBE>{get;set;}
} 
```

然后他们将客户映射到有很多订单，使用客户类中的订单集合，但是，对我来说这是不正确的，该类的消费者将能够使用客户类上的订单属性来访问所有客户的订单，我不让他们这样做：

```
ICollection<OrderBE> customerOrders = customer.Orders //I don't what this 
```

在什么情况下我想获得所有客户订单？，通常我们不希望客户订单按给定标准（日期，状态等），所以对于我来说，而不是使用该属性，我认为最好使用订单存储库通过给定的标准访问客户订单，例如： 所以任何机构都知道如何使用代码优先方法在订单和客户之间进行映射，而在客户类中没有订单集合？

`ICollection customerOrders = ordersRepository.GetCustomerOrdersByDate(customer.ID, Today.Date) //This is what i want, not orders = customer.oders` 

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:29:48.367

在 DbContext 类中使用 Fluent API：

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<OrderBE>().HasRequired(x => x.Customer);
} 
```

# php - Yii 控制器作为 URL 中的变量

> ID：11508793
> 
> 赞同：0
> 
> 时间：2012-07-16T16:46:15.400
> 
> 标签：php, yii

使用 PHP 框架 Yii 我想要一个像 url.com/xyz 这样的 url，其中 xyz 是我想要传递给特定控制器的参数（我不知道这个参数的值，因为它是动态生成的）。这可能吗？据我了解，Yii 会将 xyz 视为控制器，我不确定如何在不破坏站点其余部分功能的情况下更改它（url.com/controller/arg/etc）

帮助？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:08:07.100

显然你可以做到这一点。例如，如果您设置了[url 规则](http://www.yiiframework.com/doc/api/1.1/CUrlManager#rules-detail)

```
'<view:\w+>'=>'site/page', 
```

会将 url.com/xyz 的任何内容视为控制器`view`操作的参数。`page``site`

**问题是**你必须为每一个其他路由指定一个 action ，或者换句话说，任何其他控制器的[defaultAction](http://www.yiiframework.com/doc/api/1.1/CController#defaultAction-detail)都没有效果。

即没有上述规则的 url url.com/site 将重定向到`site/index`和`site/page`使用`view="index"`上述规则

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:03:43.353

这在指南的“URL 管理”章节中有解释：[http ://www.yiiframework.com/doc/guide/1.1/en/topics.url](http://www.yiiframework.com/doc/guide/1.1/en/topics.url)

像下面这样的规则会将到 example.com/foo 的请求路由到`myaction`in的操作`mycontroller`，将值 foo 赋予参数`name`。

```
 '<name>' => 'mycontroller/myaction' 
```

此规则应该是规则列表中的最后一条。否则，所有请求都将传递给`myaction`，从而破坏站点的现有部分。

# c++ - 有条件地替换字符串中的正则表达式匹配

> ID：11508798
> 
> 赞同：19
> 
> 时间：2012-07-16T16:46:34.970
> 
> 标签：c++, regex, visual-studio-2010, visual-c++, c++11

我正在尝试用不同的替换模式替换字符串中的某些模式。

例子：

```
string test = "test replacing \"these characters\""; 
```

我想要做的是将所有 ' ' 替换为 '_' ，并将所有其他非字母或数字字符替换为空字符串。我创建了以下正则表达式，它似乎可以正确标记，但我不确定如何（如果可能）使用`regex_replace`.

```
string test = "test replacing \"these characters\"";
regex reg("(\\s+)|(\\W+)"); 
```

替换后的预期结果是：

```
string result = "test_replacing_these_characters"; 
```

编辑：我不能使用 boost，这就是为什么我把它排除在标签之外。所以请不要回答包括提升。我必须用标准库来做这件事。可能是不同的正则表达式可以实现目标，或者我只是被困在做两次传球。

EDIT2：我不记得在`\w`我原来的正则表达式中包含了哪些字符，在查找之后我进一步简化了表达式。再次，目标是任何匹配 \s+ 都应该替换为 '_' 并且任何匹配 \W+ 都应该替换为空字符串。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-07-16T17:15:25.463

c++ (0x, 11, tr1) 正则表达式[并非在所有情况下都真正起作用（stackoverflow） （](https://stackoverflow.com/q/4716680/170194)[在](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.200x)[**此页面**](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.200x)上查找[短语**regex**](http://gcc.gnu.org/onlinedocs/libstdc++/manual/status.html#status.iso.200x)**以获取 gcc），因此最好[使用 boost](http://www.boost.org/libs/regex/)一段时间。**

 **如果您的编译器支持所需的正则表达式，您可以尝试：

```
#include <string>
#include <iostream>
#include <regex>

using namespace std;

int main(int argc, char * argv[]) {
    string test = "test replacing \"these characters\"";
    regex reg("[^\\w]+");
    test = regex_replace(test, reg, "_");
    cout << test << endl;
} 
```

以上适用于 Visual Studio 2012Rc。

**编辑1**：要一次替换**两个不同的字符串**（取决于匹配），我认为这在这里行不通。在 Perl 中，这可以很容易地在评估替换表达式 ( `/e`switch) 中完成。

因此，正如您已经怀疑的那样，您需要两次通行证：

```
 ...
 string test = "test replacing \"these characters\"";
 test = regex_replace(test, regex("\\s+"), "_");
 test = regex_replace(test, regex("\\W+"), "");
 ... 
```

**编辑 2**：

如果可以在 中使用**回调函数** `tr()`，`regex_replace`那么您可以在那里修改替换，例如：

```
 string output = regex_replace(test, regex("\\s+|\\W+"), tr); 
```

进行`tr()`更换工作：

```
 string tr(const smatch &m) { return m[0].str()[0] == ' ' ? "_" : ""; } 
```

问题本来就解决了。不幸的是，在一些 C++11 正则表达式实现中**没有这样的重载，但是 Boost****[有一个](http://boost.2283326.n4.nabble.com/regex-Context-sensitive-replacement-of-text-using-regex-replace-tp2589269p2589275.html)**. 以下将与 boost 一起使用并使用一次传递：

```
...
#include <boost/regex.hpp>
using namespace boost;
...
string tr(const smatch &m) { return m[0].str()[0] == ' ' ? "_" : ""; }
...

string test = "test replacing \"these characters\"";
test = regex_replace(test, regex("\\s+|\\W+"), tr);   // <= works in Boost
... 
```

也许有一天这将适用于 C++ **11**或接下来的任何数字。

问候

rbo

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-05-08T21:48:42.933

这样做的方法通常是通过使用四个反斜杠来删除影响实际 C 代码的反斜杠来完成的。然后你需要对括号进行第二次传递，然后在你的正则表达式中转义它们。

```
string tet = "test replacing \"these characters\"";
//regex reg("[^\\w]+");
regex reg("\\\\"); //--AS COMMONLY TAUGHT AND EXPLAINED
tet = regex_replace(tet, reg, " ");
cout << tet << endl;

regex reg2("\""); //--AS SHOWN
tet = regex_replace(tet, reg2, " "); 
cout << tet << endl; 
```

并且一次性使用；

```
string tet = "test replacing \"these characters\"";
//regex reg("[^\\w]+");
regex reg3("\\\""); //--AS EXPLAINED
tet = regex_replace(tet, reg3, "");
cout << tet << endl; 
```**

# android - 如何提取 .apk 文件并将其放入 Eclipse 中运行？

> ID：11508806
> 
> 赞同：0
> 
> 时间：2012-07-16T16:47:13.620
> 
> 标签：android

我是 Android 的新手，我打算运行一些从网上下载的示例程序，但我在提取 .apk 文件时遇到了问题，在 .apk 文件中有 META-INF、res、manifest、.dex 和 .arsc ，我将如何在 Eclipse 中打开示例程序？我只想运行一些示例编码...谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T16:53:55.707

您无需在 Eclipse 中打开程序即可运行它。

只需键入

```
adb install -r filename.apk 
```

-r 标志是允许重新安装，如果它已经存在具有相同的签名。如果存在不兼容的签名，则必须将其删除。

如果 adb 抱怨您有多个设备，请执行

```
adb devices 
```

注意你想要的序列号，然后

```
adb -s SERIAL -r filename.apk 
```

实际上，如果没有解包器/反编译器，在 Eclipse 中打开现有的 apk 相对毫无意义，这完全是另一个话题。

# javascript - 如何使用 JQuery 将数据从一个 HTML 页面传递到另一个 HTML 页面？

> ID：11508818
> 
> 赞同：1
> 
> 时间：2012-07-16T16:47:51.160
> 
> 标签：javascript, jquery, ajax, json, jquery-mobile

我有两个以这种方式在父子关系中工作的 HTML 页面：

第一个有一个按钮，它做两件事：首先它通过 AJAX 调用从数据库请求数据。其次，它将用户引导到具有请求数据的下一页，这些数据将由 JavaScript 处理以填充第二页。

我已经可以通过 ajax 调用获取数据并将其放入 JSON 数组中：

```
$.ajax({
    type: "POST",
    url: get_data_from_database_url,
    async:false,
    data: params,
    success: function(json)
    {
        json_send_my_data(json);
    }
});

function json_send_my_data(json)
{
    //pass the json object to the other page and load it
} 
```

我假设在第二页上，“准备好文档”的 JavaScript 函数可以轻松处理传递的 JSON 对象与所​​有数据的捕获。测试它是否有效的最好方法是`alert("My data: " + json.my_data.first_name);`在文档就绪函数中使用来查看 JSON 对象是否已正确传递。

我根本不知道一个值得信赖的真实方法来做到这一点。我已经阅读了论坛，并且知道使用`window.location.url`加载第二页的基础知识，但传递数据完全是另一回事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:54:46.580

会话 cookie 可能会解决您的问题。

在第二页上，您可以使用 Server-Script 标记或站点 document.cookie 在 cookie 中直接打印

并在下一节中再次在 Json 中转换 Cookie

怎么样？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:00:04.140

我认为你有两个选择。

1) 使用 cookie - 但它们有大小限制。

2) 使用[HTML5 网络存储](http://www.w3schools.com/html5/html5_webstorage.asp)。

下一个最安全、可靠和可行的方法是使用服务器端代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:12:40.463

免责声明：这很糟糕，但这里有：

首先，您将需要这个函数（我不久前编写了这个函数）。详细信息：[http ://refactor.blog.com/2012/07/13/porting-javas-getparametermap-functionality-to-pure-javascript/](http://refactor.blog.com/2012/07/13/porting-javas-getparametermap-functionality-to-pure-javascript/)

它将请求参数转换为 json 表示。

```
function getParameterMap () {
    if (window.location.href.indexOf('?') === (-1)) {
        return {};
    }
    var qparts = window.location.href.split('?')[1].split('&'),
        qmap   = {};
    qparts.map(function (part) {
        var kvPair = part.split('='),
            key    = decodeURIComponent(kvPair[0]),
            value  = kvPair[1];

        //handle params that lack a value: e.g. &delayed=
        qmap[key] = (!value) ? '' : decodeURIComponent(value);
    });
    return qmap;
} 
```

接下来，在您的成功处理函数中：

```
success: function(json) {
    //please really convert the server response to a json
    //I don't see you instructing jQuery to do that yet!
    //handleAs: 'json'

    var qstring = '?';
    for(key in json) {
        qstring += '&' + key + '=' + json[key];
        qstring = qstring.substr(1); //removing the first redundant &
    }
    var urlTarget = 'abc.html';
    var urlTargetWithParams = urlTarget + qstring;

    //will go to abc.html?key1=value1&key2=value2&key2=value2...
    window.location.href = urlTargetWithParams;
} 
```

在下一页上，调用 getParameterMap。

```
var jsonRebuilt = getParameterMap();
//use jsonRebuilt 
```

希望这会有所帮助（有一些额外的语句可以使事情变得非常明显）。（请记住，正如人们所指出的那样，这很可能是一种错误的做法）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-16T17:41:40.920

这是我关于两个 html 页面之间通信的帖子，它是纯 javascript，它使用 cookie： [浏览器选项卡/窗口之间的 Javascript 通信](https://stackoverflow.com/questions/4079280/javascript-communication-between-browser-tabs-windows/4079423#4079423)

您可以重用那里的代码将消息从一页发送到另一页。

该代码使用轮询来获取数据，您可以根据需要设置轮询时间。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-16T17:42:29.207

警告：这仅适用于单页模板，其中每个伪页面都有自己的 HTML 文档。

您可以通过手动使用该`$.mobile.changePage()`函数在页面之间传递数据，而不是让 jQuery Mobile 为您的链接调用它：

```
$(document).delegate('.ui-page', 'pageinit', function () {
    $(this).find('a').bind('click', function () {
        $.mobile.changePage(this.href, {
            reloadPage : true,
            type       : 'post',
            data       : { myKey : 'myVal' }
        });
        return false;
    });
}); 
```

以下是相关文档：http: [//jquerymobile.com/demos/1.1.1/docs/api/methods.html](http://jquerymobile.com/demos/1.1.1/docs/api/methods.html)

您也可以简单地将数据存储在下一页的变量中。这是可能的，因为 jQuery Mobile 页面存在于同一个 DOM 中，因为它们是通过 AJAX 引入 DOM 的。这是我不久前发布的一个答案：[jQuery Moblie：传递参数并动态加载页面内容](https://stackoverflow.com/questions/11296156/jquery-moblie-passing-parameters-and-dynamically-load-the-content-of-a-page/11297238#11297238)

# php - 使用 php 正确编写的 PostgreSQL 准备/执行语句？

> ID：11508820
> 
> 赞同：3
> 
> 时间：2012-07-16T16:47:59.953
> 
> 标签：php, sql, postgresql

我听说在 SQL 语句中使用`PREPARE`and`EXECUTE`会将用户提供的数据清理为无法进行 SQL 注入的数据。这是真的？

我原来的查询是这样的：

```
$query = 
"SELECT * FROM sales_orders 
WHERE ksisoldby ILIKE '".$user."'"; 
```

这是我将其更改为准备/执行语句的最佳猜测：

```
 <?php
$id = $_POST['id'];
$search = $_POST['user_supplied_search_term'];

PREPARE search_query_function (varchar, varchar) AS

SELECT * FROM sales_orders 
WHERE ksisoldby ILIKE '$1'";

EXECUTE search_query_function($id, $search);
?> 
```

这是正确写入/调用的吗？还有一些`PDO`我读过的内置 php 对象 ()。我应该使用它们来代替还是结合使用？感谢您对此类广泛问题的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T16:58:43.543

您可以通过使用准备好的语句将`prepare()`和合并`execute()`到 PHP 中，当您使用[`PDO`](http://php.net/manual/en/class.pdo.php). 此扩展负责根据您选择的数据库驱动程序为您的数据库创建适当的`PREPARE`和语句。`EXECUTE`

这是一个改编自[PHP 手册](http://us.php.net/pdo.prepare)的示例，使用`prepare()`和`execute()`.

```
$sth = $dbh->prepare('SELECT * FROM sales_orders 
    WHERE ksisoldby ILIKE ?');
$sth->execute( array( $_POST['user_supplied_search_term'])); 
```

这将为您处理参数转义并创建类似于以下内容的 SQL 语句：

```
SELECT * FROM sales_orders 
    WHERE ksisoldby ILIKE 'something' 
```

因此，您需要调整上述代码以在对 的调用中包含您的 SQL 语句`prepare()`，这需要您在希望包含参数的位置添加占位符。然后调用`execute()`，它将添加传递给它的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T04:59:48.283

您也可以使用[pg_query_params](http://nl3.php.net/manual/en/function.pg-query-params.php)，易于使用且安全。

# java - 跨多个进程均匀分布数据库记录

> ID：11508824
> 
> 赞同：1
> 
> 时间：2012-07-16T16:48:34.197
> 
> 标签：java, multithreading

我有一个包含 300 万条记录的数据库表。一个 java 线程从表中读取 10,000 条记录并对其进行处理。处理后跳转到下一个 10,000，依此类推。为了加快速度，我有 25 个线程执行相同的任务（读取 + 处理），然后我有 4 个物理服务器运行相同的 java 程序。所以有效地我有 100 个线程做同样的工作（阅读 + 处理）。

我使用的策略是拥有一个 sql 过程，该过程执行抓取下 10,000 条记录并将它们标记为由特定线程处理的工作。但是，我注意到线程似乎正在等待一段时间，试图调用该过程并获得响应。我可以使用什么其他策略来加快数据选择的过程。

我的数据库服务器是mysql，编程语言是java

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:53:51.193

处理这种情况的惯用方式是[生产者-消费者](/questions/tagged/producer-consumer "显示标记为“生产者-消费者”的问题")设计模式。在 Java 领域实现它的惯用方式是使用[jms](/questions/tagged/jms "显示标记为“jms”的问题")。

本质上，您需要一台主服务器读取记录并将它们推送到 JMS 队列。然后，您将有任意数量的消费者从该队列中读取并相互竞争。由您决定如何详细实现这一点：您要发送带有完整记录的消息还是只发送 ID？一条消息中的所有 10000 条记录或每条消息的记录？

另一种方法是[map-reduce](/questions/tagged/map-reduce "显示标记为“map-reduce”的问题")，看看[hadoop](/questions/tagged/hadoop "显示标记为“hadoop”的问题")。但是学习曲线有点陡峭。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:53:34.510

对我来说，这听起来像是 Hadoop 的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-07-16T17:01:03.777

我怀疑您主要是与此方案绑定的数据库 IO。如果您正在尝试提高系统的性能，如果可以的话，我建议您将数据分区到多个数据库服务器上。 MySQL 有一些我没有经验的[分区模式。](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html)如果您自己进行分区，它可能会给数据库模式增加很多复杂性，并且您必须使用散列机制添加某种路由层，以便以某种方式在多个分区中划分您的记录。但我怀疑你会获得显着的速度提升，并且你的线程不会等待那么多。

如果您无法对数据进行分区，那么我怀疑将数据库移动到[SSD 内存驱动器](http://www.mwave.com/mwave/subcat.asp?CatID=54&parent=2%5E49&pageTitle=Solid%20State%20Disks%20%28SSD%29)将是一个巨大的胜利——任何可以提高这些分区上 IO 速率的方法。由于固有的性能问题，请远离 RAID5。如果您需要一个可靠的文件系统，那么镜像或[RAID10](http://en.wikipedia.org/wiki/Raid10#RAID_1.2B0)将具有更好的性能，而[RAID50](http://en.wikipedia.org/wiki/Raid10#RAID_50_.28RAID_5.2B0.29)也是大分区的一个选项。

最后，您可能会发现，如果您的数据库 IO 总线受到干扰，您的应用程序会以更少的线程执行得更好。这取决于许多因素，包括并发查询、数据库布局等。您可以尝试降低每个客户端的线程数，看看是否会有所不同。然而，影响可能很小。

# c# - C#：Picturebox使用的绘图方法

> ID：11508827
> 
> 赞同：1
> 
> 时间：2012-07-16T16:48:44.297
> 
> 标签：c#, picturebox

**背景：**在 Picturebox 中，通过将 Bitmap 对象分配给 Picturebox 的 Image 属性，可以在屏幕上绘制位图图像。

**问题：** Picturebox在屏幕上绘制位图图像的绘制方法（GDI+？）是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:38:36.977

If by `PictureBox` you mean `System.Windows.Forms.PictureBox`, it paints with GDI+ as GDI+ is the rendering technology used by all of Windows Forms (WinForms). The GDI+ "wrapper" for WinForms comes from `System.Drawing`.

Windows Presentation Foundation (WPF) on the other hand, uses DirectX to "paint". WPF does not have a PictureBox control.

# ruby-on-rails - 延迟作业在heroku上失败，但在本地运行

> ID：11508830
> 
> 赞同：0
> 
> 时间：2012-07-16T16:48:53.230
> 
> 标签：ruby-on-rails, heroku, amazon-s3, delayed-job

我有一个延迟作业，它使用 aws/s3 处理一堆 S3 对象。它通过“rake jobs:work”在本地工作，但在 Heroku 上失败并出现以下错误：

“{Job 加载失败：未初始化的常量 Net::HTTP::ConnectionPool...”

我还可以通过“heroku run console”启动 Heroku 控制台并运行作业的方法而不会出现问题。ConnectionPool 来自 aws，所以我试图强制 require 'aws/s3' 但它没有帮助。有任何想法吗？

宝石：aws-sdk（1.5.6）rails（3.1.0）delayed_job（3.0.3）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T12:55:54.287

事实证明，我正在重用来自模块的 s3 连接。如果存在，该模块将返回一个现有连接，如果不存在，它会创建一个新连接。我不确定为什么它在我当地的 DJ 中有效，而不是在 Heroku Worker 上有效，因为我认为在这两种环境中都不应该存在现有的连接，并且在这两种情况下，这项工作都是通过 rake 任务开始的，就像工人。无论如何，在作业中通过 AWS::S3.new 创建新的 S3 连接后，问题就解决了。

希望这可以帮助某人。

# c# - 使用 libgit2sharp 克隆和推送

> ID：11508832
> 
> 赞同：2
> 
> 时间：2012-07-16T16:48:53.573
> 
> 标签：c#, github, github-api, libgit2, libgit2sharp

谁能告诉我如何克隆一个 repo 并推送或发布提交的更改？

目前我能够修改克隆仓库并能够提交我的更改，但我没有很好的 api 来推送它。最初也是为了克隆 repo。

如果它不可用，使用 c# 的替代方法是什么？

-贾弗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T18:06:46.587

> 谁能告诉我如何克隆一个 repo 并推送或发布提交的更改？目前我能够修改克隆仓库并能够提交我的更改，但我没有很好的 api 来推送它。最初也是为了克隆 repo。

`Clone`和`Push`功能目前正在 libgit2 中开发。下面是一些与此主题相关的 PR。

*   **克隆：** [问题 #778](https://github.com/libgit2/libgit2/pull/778)
*   **推送：** [问题 #761](https://github.com/libgit2/libgit2/pull/761)和[问题 #803](https://github.com/libgit2/libgit2/pull/803)。需要一些额外的 PR 来完成整个功能

一旦 C 代码经过审查、合并和测试，将发布一个新版本的 LibGit2Sharp，以公开这些功能。

考虑到目前的进展，`Clone`可能会在之前登陆`Push`，因此可以更快地从 LibGit2Sharp 中使用。

> 如果它不可用，使用 c# 的替代方法是什么？

`git.exe`您可以通过**[Process](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)**类型调用它来推迟它。不过，这需要在运行 .Net 代码的计算机上部署**[msysgit](http://msysgit.github.com/)**。

## 更新

两者`Clone`和`Push`现在都可以在 LibGit2Sharp 中使用。

*   此**[测试](https://github.com/libgit2/libgit2sharp/blob/vNext/LibGit2Sharp.Tests/CloneFixture.cs#L53-L90)**显示如何对本地存储库进行克隆和推送
*   **[在远程](https://github.com/libgit2/libgit2sharp/blob/vNext/LibGit2Sharp.Tests/RemoteFixture.cs)**和**[克隆](https://github.com/libgit2/libgit2sharp/blob/vNext/LibGit2Sharp.Tests/CloneFixture.cs)**测试套件中可以看到有关处理凭据和回调的其他提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T19:32:39.640

克隆现已实施。我希望 push 指日可待——C 版本看起来已经实现，但尚未合并。

# c# - 如何在 C# Word 加载项中打开 SharePoint 2010 文档

> ID：11508835
> 
> 赞同：1
> 
> 时间：2012-07-16T16:49:01.270
> 
> 标签：c#, sharepoint-2010, ms-office, add-in

我正在开发一个 MS Word 2010 加载项（使用 C#），它有一个自定义功能区选项卡。在该选项卡中有一个按钮，可以打开特定的 Word 文档 (MyTemplate.docx)，该文档位于 SharePoint 2010 服务器的共享文档库中。我的开发服务器（内部）的 URL 是“http://sharepoint2010”。我正在尝试使用 SP 对象模型元素，例如 SPSite、SPWeb 等...当我尝试时：

```
SPSite site = new SPSite(@"http://sharepoint2010"); 
```

我收到错误消息：“**找不到位于 'http://sharepoint2010' 的 Web 应用程序**”

我确实有一个有效的 Web 服务参考：

```
HomeDataContext dc = new HomeDataContext(new Uri("http://sharepoint2010/_vti_bin/listdata.svc")); 
```

这使我可以获取共享文档库中的文档列表。我能够遍历该列表并获得单个 SharedDocumentItem，但我不明白如何将其作为 Word 文档打开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T07:22:19.640

您不能在远程访问方案中使用 SharePoint 对象模型。对象模型（主要由 表示`Microsoft.SharePoint.dll`）取决于服务器代码，因此只能在 SharePoint 服务器上*使用*。这就是为什么实例化*总是*`SPSite`会抛出异常的原因。

 *另请注意，传递给的 URL`SPSite`与通过 HTTP、Web 服务或其他方式访问站点无关。它被解释为网站集的服务器端定位器。

如果您真的需要客户端，请查看[客户端对象模型](http://msdn.microsoft.com/en-us/library/ee537247.aspx)。*

# javascript - 只有 2 张图像的旋转效果

> ID：11508838
> 
> 赞同：3
> 
> 时间：2012-07-16T16:49:12.420
> 
> 标签：javascript, jquery, css, animation, jquery-animate

我们只有 2 张瓶子的图像（正面和背面），但想创造某种旋转效果。我试图用 jquery 或 CSS 来想办法做到这一点——也许是模糊。想不出好办法。

他们想按下一个按钮来查看瓶子的另一面（旋转到那里）。

关于我如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:52:02.050

看看[CSS Coke can](http://www.romancortes.com/blog/pure-css-coke-can/)的例子。这可能会帮助您获得一些快速的结果，或者至少可以作为新想法的基础。（[这里](http://ajaxian.com/archives/rolling-a-coke-can-around-with-pure-css)是英文，它也更容易显示发生了什么）。为此，您唯一需要的 JS 就是执行实际的“滚动”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T16:52:01.433

例如，您可以使用 jQuery 中转库[http://ricostacruz.com/jquery.transit/来执行此操作](http://ricostacruz.com/jquery.transit/)

```
$('button').on('click', function(){
  $('.bottle').transition({
    perspective: '100px',
    rotateY: '180deg'
  });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-16T16:55:30.550

将第一张图像（正面）左侧边距的宽度设置为`width: 300px; margin-left: 0px`动画`width: 0px; margin-left: 150px`。动画完成后，将第二张图像的动画从`width: 0px; margin-left: 150px`到`width: 300px; margin-left: 0px`。

您可以`.animate()`为此目的使用： http: [//api.jquery.com/animate/](http://api.jquery.com/animate/)

我希望这回答了你的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-16T17:00:31.740

[http://css3.bradshawenterprises.com/cfimg/](http://css3.bradshawenterprises.com/cfimg/)

使用按钮查看演示 2 以了解交叉淡入淡出。要让它旋转，添加如下内容：

```
transform:rotatey(180deg);
} 
```

# c++ - 图论算法——优化工作流中图形界面的直角箭头排列

> ID：11508839
> 
> 赞同：0
> 
> 时间：2012-07-16T16:49:12.603
> 
> 标签：c++, user-interface, graph, workflow, graph-theory

我正在开发一个在工作流模式下具有图形界面的软件，该软件接受拖放小部件，并在模块之间创建箭头，以显示数据的来源和去向。

当前的挑战是实现箭头的自动排列：当绘制箭头时，它应该是直角并避开所有其他小部件，并尽可能避免与其他箭头交叉。我假设图论中最小路径查找的算法可能很有用。

所有这些都是用 C++/Qt 实现的。

您是否遇到过同样的问题，您对合适的算法有更准确的想法吗？

你能暗示一些有益的参考吗？

谢谢并恭祝安康

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:01:20.757

这是一个非常有趣的问题......我认为最容易应用（和有趣）的方法是：Fruchterman：通过强制定向放置绘制图形

# c# - 使用 WMI 挂载网络驱动器

> ID：11508844
> 
> 赞同：0
> 
> 时间：2012-07-16T16:49:29.273
> 
> 标签：c#, .net, wmi, sysadmin

尝试使用已登录计算机的凭据编写 WMI 类函数以在任何计算机（远程或本地）上安装网络驱动器。

这是我为帮助台工作人员编写的一个大型项目的课程，用于在远程 PC 上进行第一线修复。技术人员输入机器名称或 IP 地址，应用程序连接到它，并允许技术人员单击几个按钮并修复一些基本项目，而无需远程 (VNC) 进入 PC。

我在整个互联网上都读过它比 WMI 更简单的方法，但由于应用程序的远程性质，我宁愿不使用本地 API 调用，也不想担心上传脚本并通过进程执行它开始。WMI 中也已经有其他功能，所以我想保持代码库相同。

基本思想是安装`H:`到`//fileserver.example.com/$username`

NetFixer 已经在生产中使用，所以我试图让我的代码保持整洁

![在此处输入图像描述](../Images/b8417eddacd4b102c691b6b4bbe63438.png)

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Management;

namespace WMIcontrols
{
  public class Remote
  {

   public string target;

   //Some code skipped here for simplicity sake... 

   public bool MountNetDrive(string DriveLetter, string MountLocation)
    {
      try
      {
          //Mount the network drive
          return true;
      }
      catch
      {
          //Mount Failed
          return false;
      }
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T00:07:28.497

这不是使用 WMI，但会完成您想要的并且非常简单

```
System.Diagnostics.Process.Start("cmd", "/c net use x: \\fileserver.example.com /user:Username Password"); 
```

# javascript - 在 JavaScript 中使数字值相反

> ID：11508845
> 
> 赞同：5
> 
> 时间：2012-07-16T16:49:35.600
> 
> 标签：javascript

我想知道是否可以使数字与当前使用 JavaScript 的数字相反。即如果一个数字是`400`。是否有可能做到`-400`，类似的，如果一个数字是`-400`有可能做到的`400`吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-07-16T16:50:25.170

这不是 jQuery！

只需乘以`-1`。

```
num = "400"
console.log(-num); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-10-19T13:15:09.273

核心JS，

```
function opposite(number) {
  return(-number);
} 
```

[作为http://www.codewars.com/](http://www.codewars.com/)的较短解决方案

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-25T19:06:49.620

在一条线上..

```
 const opposite = number => -number; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-24T11:05:50.980

```
function opposite(number) {
  let result;
  if (!isNaN(Math.sign(number))) {
    result = number * (-1);
  }
  return result;
}
```

# java - 在迭代时删除和添加元素到 ConcurrentSkipListSet

> ID：11508852
> 
> 赞同：0
> 
> 时间：2012-07-16T16:50:05.727
> 
> 标签：java, collections

`ConcurrentSkipListSet`在迭代它时删除和添加元素是否安全：

```
ConcurrentSkipListSet<Element> set = new ConcurrentSkipListSet<Element>(myComparator);
for(Element e : set)
{
   if(condition)
   {
      set.remove(e);
      set.add(anotherE);
   }
} 
```

其中`e`和`anotherE`由提供的比较器相等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:52:00.483

是的，它是安全的。来自[java 文档](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentSkipListSet.html)：

> 插入、删除和访问操作由多个线程安全地并发执行。迭代器是弱一致的，返回的元素反映了在迭代器创建时或之后的某个时间点的集合状态。它们不会抛出 ConcurrentModificationException，并且可以与其他操作同时进行。

# ios - 基于内容 iOS 动态调整单元格大小

> ID：11508855
> 
> 赞同：0
> 
> 时间：2012-07-16T16:50:14.203
> 
> 标签：ios, uitableview

我在附件中显示了一个自定义单元格：

![在此处输入图像描述](../Images/f1afa3841d7a75c90efaaf4f2eb88e86.png)

我正在使用 UIWebView 来显示推文文本。有些推文很短，我想调整 web 视图的大小，向上移动 Time since，然后最后调整单元格的大小。我知道如何调整 web 视图的大小，但不知道如何计算如何移动时间和调整单元格的大小。

```
- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSFetchedResultsController *fetchedResultsController = nil;

    if (self.tweetsSegmentedControl.selectedSegmentIndex == REPORTERS_SELECTED_INDEX)
    {
        fetchedResultsController = self.reportersFetchedResultsController;

    }
    else if (self.tweetsSegmentedControl.selectedSegmentIndex == PLAYERS_SELECTED_INDEX)
    {
        fetchedResultsController = self.playersFetchedResultsController;
    }

    Tweet *tweet = [fetchedResultsController objectAtIndexPath:indexPath];

    //Calcaulate height of box, instead of return a fixed number 
    return 170;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:02:37.193

> 我知道如何调整网页视图的大小

不。使用 autosizing 以单元格的高度拉伸 UIWebView。

> 如何移动时间以来

不。使用 autosizing 将 Time since 固定到单元格的底部。

> 调整单元格大小

利用`-tableView:heightForRowAtIndexPath:`

* * *

**更新**

我之前这样做的方法是在原型单元格中为灵活视图（为您的 web 视图）设置一个已知大小，并为原型单元格设置一个已知大小。在这种情况下，我们会说 Web 视图是 kPrototypeViewHeight，原型是 kPrototypeCellHeight。

在表视图控制器中：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UIWebView *webView = … // Whatever you need to do to get the web view
    CGFloat webViewHeight = webView.frame.size.height;
    return kPrototypeCellHeight - kPrototypeViewHeight + webViewHeight;
} 
```

注意：这将在`-tableView:cellForRowAtIndexPath:`调用之前完成。因此，在绘制自己之前，您需要知道自己的尺寸。

注意 2：因为您正在自己更改 webView 的大小，所以您不希望它自动调整大小。

注意 3：您将重新渲染表格中的每个 Web 视图以计算您的身高。我的猜测是滚动会很慢。

希望有帮助。

# sql - 编写一个 Groovy 脚本来执行这个命令到 PostgresDB

> ID：11508861
> 
> 赞同：0
> 
> 时间：2012-07-16T16:50:25.040
> 
> 标签：sql

我目前正在使用 SOAPUI 4.0 Pro 在特定主机上访问 Postgresdb。我已修改我的属性文件以包含端口、用户名、密码和数据库名称。以下是我的查询：

```
SELECT 
  eis_entity.local_id, 
  eis_trait_instance_history.trait_value,
  eis_identifier_domain.identifier,
  eis_identifier_domain.label
FROM 
  public.eis_entity,
  public.eis_trait_instance_history,
  public.eis_version_label,
  public.eis_identifier_domain
WHERE eis_identifier_domain.eis_identifier_domain_key = eis_entity.eis_identifier_domain_key
  AND eis_entity.eis_entity_key=eis_version_label.eis_entity_key  
  AND eis_version_label.eis_version_label_key=eis_trait_instance_history.eis_version_label_key
  AND eis_trait_instance_history.trait_value='<name of patient>'; 
```

我将如何为上面的查询创建一个 groovy 脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T16:57:12.413

假设您可以学习 Groovy SQL 基础知识并掌握`sql`实例...

```
sql = Sql.newInstance(...)
def List eisEntityList = sql.rows("""
    SELECT eis_entity.local_id,
           eis_trait_instance_history.trait_value,
           eis_identifier_domain.identifier,
           eis_identifier_domain.label
    FROM public.eis_entity,
         public.eis_trait_instance_history,
         public.eis_version_label,
         public.eis_identifier_domain
    WHERE eis_identifier_domain.eis_identifier_domain_key = eis_entity.eis_identifier_domain_key
          AND eis_entity.eis_entity_key = eis_version_label.eis_entity_key
          AND eis_version_label.eis_version_label_key = eis_trait_instance_history.eis_version_label_key
          AND eis_trait_instance_history.trait_value = ''
""")

if (eisEntityList?.size() > 0) {

    eisEntityList.each {
        // do something with each item...
    }
} 
```

# tridion - 是否可以将 Tridion SP1 HR#1 回滚到 Tridion SP1

> ID：11508863
> 
> 赞同：3
> 
> 时间：2012-07-16T16:50:28.017
> 
> 标签：tridion

是否可以从 CMS 中卸载 Tridion SP1 HR#1 修补程序并保留数据库更新？自从应用修补程序后，我们的 GUI 行为非常缓慢（可能与 TMS 服务失败有关？）并且需要返回到 SP1 - 但是，自从我们应用修补程序以来，我们已经对数据库进行了内容更新，并且想知道是否SP1 与 HR#1 数据库更新兼容。

我意识到这是一个非常具体的问题 - 但也许其他人出于不同的原因需要回滚到 SP1？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:55:23.843

没有支持的方式来回滚升级，也没有支持的方式在较新的数据库上运行旧版本的产品。

您可能得到的最接近的方法是恢复您的数据库备份并在新盒子上安装一个普通的 SP1。这是拥有虚拟化环境会有所帮助的情况之一，因为那时您可能会回滚到以前的 VM 快照（类似于还原数据库的方式）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-17T09:17:50.137

问题是应用 HR#1 后 GUI 性能非常缓慢。在保存组件时，World Server 连接器会将错误写入 Tridion 事件日志。我通过客户支持打开了一个案例，当我有解决方案时会在这里更新。

建议 - 如果您正在使用 World Server 连接器 - 不要安装 HR#1。等到为此问题创建修补程序或 Tridion 提供解决方案。

我们不会后退 - 只是继续前进！:) 在我们可以确保 HR#1 和 WSC 愉快地一起工作之前，我们会将 World Server 连接器从系统中移除。

# inno-setup - 版本升级后未创建卸载程序

> ID：11508864
> 
> 赞同：0
> 
> 时间：2012-07-16T16:50:31.933
> 
> 标签：inno-setup

我已将安装程序设置为使用本文中提到的代码[来](https://stackoverflow.com/questions/2000296/innosetup-how-to-automatically-uninstall-previous-installed-version)检查现有版本，然后在安装新版本之前对其调用卸载。效果很好。我的问题是，在卸载/安装步骤之后，没有创建新版本的卸载（unins000.exe）（或者它可能是但被删除了 IDK）。这可以防止以后正确卸载新版本。如果没有现有版本，则始终会创建卸载程序。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T13:18:28.203

您可以使用最初发布在此处的 Craig McQueen 的解决方案：[InnoSetup：如何自动卸载以前安装的版本？](https://stackoverflow.com/questions/2000296/innosetup-how-to-automatically-uninstall-previous-installed-version)

```
function GetUninstallString(): String;
var
    sUnInstPath: String;
    sUnInstallString: String;
    begin
        sUnInstPath := ExpandConstant('Software\Microsoft\Windows\CurrentVersion\Uninstall\{{A227028A-40D7-4695-8BA9-41DF6A3895C7}_is1'); //Your App GUID/ID
        sUnInstallString := '';
            if not RegQueryStringValue(HKLM, sUnInstPath, 'UninstallString', sUnInstallString) then
                RegQueryStringValue(HKCU, sUnInstPath, 'UninstallString', sUnInstallString);
                Result := sUnInstallString;
    end;

function IsUpgrade(): Boolean;
    begin
        Result := (GetUninstallString() <> '');
    end;

function InitializeSetup: Boolean;
var
    V: Integer;
    iResultCode: Integer;
    sUnInstallString: String;
    begin
        if RegValueExists(HKEY_LOCAL_MACHINE,'Software\Microsoft\Windows\CurrentVersion\Uninstall\{A227028A-40D7-4695-8BA9-41DF6A3895C7}_is1', 'UninstallString') then begin
//Your App GUID/ID
            V := MsgBox(ExpandConstant('{cm:YesNoUninstall}'), mbInformation, MB_YESNO); //Custom Message if App installed
            if V = IDYES then begin
                sUnInstallString := GetUninstallString();
                sUnInstallString :=  RemoveQuotes(sUnInstallString); 
                Exec(ExpandConstant(sUnInstallString), '', '', SW_SHOW, ewWaitUntilTerminated, iResultCode);
                Result := True; //if you want to proceed after uninstall
                //Exit; //if you want to quit after uninstall
            end
            else begin
                Result := False; //when older version present and not uninstalled
            end;
        end
        else begin
            Result := True; //when no previous version found   
        end;
    end; 
```

# c# - 如何在C#中将字符串与枚举进行比较

> ID：11508865
> 
> 赞同：57
> 
> 时间：2012-07-16T16:50:31.497
> 
> 标签：c#, .net

```
string strName = "John";
public enum Name { John,Peter }

private void DoSomething(string myname)
{
case1:
     if(myname.Equals(Name.John) //returns false
     {

     }

case2:
     if(myname == Name.John) //compilation error
     {

     }

case3:
     if(myname.Equals(Name.John.ToString()) //returns true (correct comparision)
     {

     }
} 
```

当我使用`.Equals`它时，它是参考比较，当我使用它时，`==`它意味着值比较。

是否有更好的代码而不是将枚举值转换`ToString()`为进行比较？因为它破坏了值类型枚举的目的，并且`ToString()`不推荐使用枚举？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-07-16T16:53:32.680

您可以使用该[`Enum.TryParse()`](http://msdn.microsoft.com/en-us/library/dd783499)方法将字符串转换为等效的枚举值（假设它存在）：

```
Name myName;
if (Enum.TryParse(nameString, out myName))
{
    switch (myName) { case John: ... }
} 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-07-16T16:52:57.360

您可以解析字符串值并进行枚举比较。

Enum.TryParse：见[http://msdn.microsoft.com/en-us/library/dd783499.aspx](http://msdn.microsoft.com/en-us/library/dd783499.aspx)

```
Name result;
if (Enum.TryParse(myname, out result))
{
    switch (result)
    {
        case Name.John:
            /* do 'John' logic */
            break;
        default:
            /* unexpected/unspecialized enum value, do general logic */
            break;
    }
}
else 
{
    /* invalid enum value, handle */
} 
```

如果您只是比较单个值：

```
Name result;
if (Enum.TryParse(myname, out result) && result == Name.John)
{
     /* do 'John' logic */
}
else 
{
    /* do non-'John' logic */
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-07-16T17:00:27.137

如果您使用 .NET4 或更高版本，则可以使用[`Enum.TryParse`](http://msdn.microsoft.com/en-us/library/system.enum.tryparse.aspx). 并且[`Enum.Parse`](http://msdn.microsoft.com/en-us/library/essfb559%28v=vs.80%29)适用于 .NET2 及更高版本

```
// .NET2 and later
try
{
    switch (Enum.Parse(typeof(Names), myName))
    {
        case John: ... 
        case Peter: ...
    }
}

// .NET4 and later
Name name;
if (Enum.TryParse(myName, out name))
    switch (name)
    {
        case John: ... 
        case Peter: ...
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-16T16:53:23.053

一种解决方案可能是获取枚举的类型，然后是类型名称。

```
myname.Equals(Enum.GetName(typeof(Name))) 
```

[http://msdn.microsoft.com/en-us/library/system.enum.getname.aspx](http://msdn.microsoft.com/en-us/library/system.enum.getname.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-09-20T07:42:20.553

出于某种原因，给定的解决方案对我没有用。我不得不以稍微不同的方式做：

```
Name myName;
if (Enum.TryParse<Name>(nameString, out myName))
{
    switch (myName) { case John: ... }
} 
```

希望它可以帮助某人:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-07-16T16:53:53.267

我想你正在寻找`Enum.Parse()`方法。

```
if(myname.Equals(Enum.Parse(Name.John)) //returns false
 {

 } 
```

# c - C 类型声明 intN_t

> ID：11508866
> 
> 赞同：1
> 
> 时间：2012-07-16T16:50:33.610
> 
> 标签：c, types, typedef, stdint, uint32-t

标头 stdint.h 如何在每台机器上将 u32 定义为 32 位？有人可以详细说明 stdint.h 为实现这一目标所做的过程吗？在哪里可以找到我的机器 (Windows 7) 的 stdint.h 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T16:54:20.307

编译器工具链的 C 标准库的提供者将确保它对于该特定部署是正确的。据推测，他们被允许使用任何必要的手段来确保这种情况。它可以像知道将其 typedef 为 int 还是 long 一样简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-16T16:57:55.407

stdint.h 在 C99 中（并且 2008 以下版本的 VC++ 仅实现 C89），因此要在 Win7 机器上安装此文件，您需要安装 VisualStudio 2010（或更高版本）。然后此文件位于 MSVS 安装的“VC\include\stdint.h”文件夹中。

MinGW（Win32 的 gcc 工具链）和 Cygwin（Windows 机器的 POSIX 层）也在其“include”目录中包含 stdint.h 文件。

对于您的问题： uintN_t 类型背后的“魔法”通常是使用条件编译来实现的。可能有一些预定义的符号（由编译器），如 Windows 上的 _WIN32 和 x64 目标的 _WIN64。

对于 2008 年前的 VisualStudio 版本，有一个单独的 stdint.h 实现：[http://msinttypes.googlecode.com/svn/trunk/stdint.h](http://msinttypes.googlecode.com/svn/trunk/stdint.h)

# android - Android线性布局不填充滚动视图

> ID：11508869
> 
> 赞同：1
> 
> 时间：2012-07-16T16:50:41.060
> 
> 标签：android, layout

我不明白为什么我无法将线性布局（蓝色轮廓）扩展到下图中的滚动视图（红色、绿色和黑色区域）的全尺寸。我尝试了重力和填充的不同组合，但没有运气。我错过了什么？

![在此处输入图像描述](../Images/20d26369538f891d33e1813ae2694793.png)

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <RelativeLayout
        android:id="@+id/top_control_bar"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:id="@+id/linearLayout1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="#111111"
            android:orientation="vertical" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:minHeight="60dip"
                android:orientation="horizontal" >

                <TextView
                    android:id="@+id/header"
                    android:layout_width="fill_parent"
                    android:layout_height="fill_parent"
                    android:layout_weight="50"
                    android:background="#999999"
                    android:gravity="center"
                    android:text="Title"
                    android:textColor="#FFFFFF"
                    android:textSize="18sp"
                    android:textStyle="bold" />

            </LinearLayout>
        </LinearLayout>
    </RelativeLayout>

    <LinearLayout
        android:id="@+id/bottom_control_bar"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:gravity="center"
        android:orientation="vertical" >

        <LinearLayout
            android:id="@+id/pagebar"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:background="#FFFF00"
            android:gravity="bottom|center"
            android:minHeight="70dip"
            android:orientation="horizontal" >

            <FrameLayout
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_marginRight="10dip" >

                <ImageButton
                    android:id="@+id/b_p1"
                    android:layout_width="58dip"
                    android:layout_height="58dip"
                    android:layout_gravity="top"
                    android:layout_marginTop="5dip"
                    android:adjustViewBounds="true"
                    android:clickable="true"
                    android:focusable="true"
                    android:scaleType="fitCenter"
                    android:src="@drawable/ic_launcher" />

                <TextView
                    android:id="@+id/tv_p1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center"
                    android:clickable="false"
                    android:focusable="false"
                    android:text="page1"
                    android:textSize="10sp" />
            </FrameLayout>

            <FrameLayout
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_marginRight="10dip" >

                <ImageButton
                    android:id="@+id/b_p2"
                    android:layout_width="58dip"
                    android:layout_height="58dip"
                    android:layout_gravity="top"
                    android:layout_marginTop="5dip"
                    android:adjustViewBounds="true"
                    android:clickable="true"
                    android:focusable="true"
                    android:scaleType="fitCenter"
                    android:src="@drawable/ic_launcher" />

                <TextView
                    android:id="@+id/tv_p2"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center"
                    android:clickable="false"
                    android:focusable="false"
                    android:text="page2"
                    android:textSize="10sp" />
            </FrameLayout>

            <FrameLayout
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_marginRight="10dip" >

                <ImageButton
                    android:id="@+id/b_p3"
                    android:layout_width="58dip"
                    android:layout_height="58dip"
                    android:layout_gravity="top"
                    android:layout_marginTop="5dip"
                    android:adjustViewBounds="true"
                    android:clickable="true"
                    android:focusable="true"
                    android:scaleType="fitCenter"
                    android:src="@drawable/ic_launcher" />

                <TextView
                    android:id="@+id/tv_p3"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center"
                    android:clickable="false"
                    android:focusable="false"
                    android:text="page3"
                    android:textSize="10sp" />
            </FrameLayout>

            <FrameLayout
                android:layout_width="wrap_content"
                android:layout_height="fill_parent"
                android:layout_marginRight="10dip" >

                <ImageButton
                    android:id="@+id/b_p4"
                    android:layout_width="58dip"
                    android:layout_height="58dip"
                    android:layout_gravity="top"
                    android:layout_marginTop="5dip"
                    android:adjustViewBounds="true"
                    android:clickable="true"
                    android:focusable="true"
                    android:scaleType="fitCenter"
                    android:src="@drawable/ic_launcher" />

                <TextView
                    android:id="@+id/tv_p4"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="bottom|center"
                    android:clickable="false"
                    android:focusable="false"
                    android:text="page4"
                    android:textSize="10sp" />
            </FrameLayout>

        </LinearLayout>
    </LinearLayout>

    <ScrollView
        android:id="@+id/scrollView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_above="@id/bottom_control_bar"
        android:layout_below="@id/top_control_bar"
        android:measureAllChildren="false" >

        <LinearLayout
            android:id="@+id/linlay1"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:background="#770000"
            android:clipChildren="true"
            android:duplicateParentState="false"
            android:fitsSystemWindows="false"
            android:orientation="vertical" >

            <LinearLayout
                android:id="@+id/searchbar"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:minHeight="60dip"
                android:orientation="horizontal" >

                <EditText
                    android:id="@+id/query"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="left|center_vertical"
                    android:layout_marginLeft="5dip"
                    android:layout_marginRight="5dip"
                    android:layout_weight="20"
                    android:imeOptions="actionSearch"
                    android:lines="1" >

                    <requestFocus />
                </EditText>

                <Button
                    android:id="@+id/btn_cancel"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="right|center_vertical"
                    android:layout_weight="60"
                    android:drawablePadding="5dip"
                    android:gravity="center"
                    android:hapticFeedbackEnabled="true"
                    android:maxHeight="48dip"
                    android:minHeight="48dip"
                    android:text="Search"
                    android:textSize="12sp"
                    android:textStyle="bold" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/buttons"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:minHeight="60dip"
                android:orientation="horizontal" >

                <Button
                    android:id="@+id/btn_1"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical|center_horizontal"
                    android:layout_weight="60"
                    android:drawablePadding="5dip"
                    android:gravity="center"
                    android:hapticFeedbackEnabled="true"
                    android:maxHeight="48dip"
                    android:minHeight="48dip"
                    android:text="b1"
                    android:textSize="12sp"
                    android:textStyle="bold" />

                <Button
                    android:id="@+id/btn_2"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical|center_horizontal"
                    android:layout_weight="60"
                    android:drawablePadding="5dip"
                    android:gravity="center"
                    android:hapticFeedbackEnabled="true"
                    android:maxHeight="48dip"
                    android:minHeight="48dip"
                    android:text="b2"
                    android:textSize="12sp"
                    android:textStyle="bold" />

                <Button
                    android:id="@+id/btn_3"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical|center_horizontal"
                    android:layout_weight="60"
                    android:drawablePadding="5dip"
                    android:gravity="center"
                    android:hapticFeedbackEnabled="true"
                    android:maxHeight="48dip"
                    android:minHeight="48dip"
                    android:text="b3"
                    android:textSize="12sp"
                    android:textStyle="bold" />

                <Button
                    android:id="@+id/btn_4"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center_vertical|center_horizontal"
                    android:layout_weight="60"
                    android:drawablePadding="5dip"
                    android:gravity="center"
                    android:hapticFeedbackEnabled="true"
                    android:maxHeight="48dip"
                    android:minHeight="48dip"
                    android:text="b4"
                    android:textSize="12sp"
                    android:textStyle="bold" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/picbar"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:orientation="vertical" >

                <ImageView
                    android:id="@+id/imageView1"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_gravity="center"
                    android:src="@android:drawable/toast_frame" />

            </LinearLayout>

            <LinearLayout
                android:id="@+id/actionbar"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_weight="10"
                android:background="#007700"
                android:orientation="horizontal" >

                <Button
                    android:id="@+id/btn_warp"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="5dip"
                    android:layout_marginTop="5dip"
                    android:text="warp"
                    android:textSize="12sp"
                    android:textStyle="bold" />
            </LinearLayout>

        </LinearLayout>
    </ScrollView>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:21:54.587

我想你想要这样

![在此处输入图像描述](../Images/d7e82e8a2782e2c207b9218bf8f61689.png)

这是更正后的代码

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<RelativeLayout
    android:id="@+id/top_control_bar"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="#111111"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:minHeight="60dip"
            android:orientation="horizontal" >

            <TextView
                android:id="@+id/header"
                android:layout_width="fill_parent"
                android:layout_height="fill_parent"
                android:layout_weight="50"
                android:background="#999999"
                android:gravity="center"
                android:text="Title"
                android:textColor="#FFFFFF"
                android:textSize="18sp"
                android:textStyle="bold" />
        </LinearLayout>
    </LinearLayout>
</RelativeLayout>

<LinearLayout
    android:id="@+id/bottom_control_bar"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:gravity="center"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/pagebar"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#FFFF00"
        android:gravity="bottom|center"
        android:minHeight="70dip"
        android:orientation="horizontal" >

        <FrameLayout
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_marginRight="10dip" >

            <ImageButton
                android:id="@+id/b_p1"
                android:layout_width="58dip"
                android:layout_height="58dip"
                android:layout_gravity="top"
                android:layout_marginTop="5dip"
                android:adjustViewBounds="true"
                android:clickable="true"
                android:focusable="true"
                android:scaleType="fitCenter"
                android:src="@drawable/ic_launcher" />

            <TextView
                android:id="@+id/tv_p1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="bottom|center"
                android:clickable="false"
                android:focusable="false"
                android:text="page1"
                android:textSize="10sp" />
        </FrameLayout>

        <FrameLayout
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_marginRight="10dip" >

            <ImageButton
                android:id="@+id/b_p2"
                android:layout_width="58dip"
                android:layout_height="58dip"
                android:layout_gravity="top"
                android:layout_marginTop="5dip"
                android:adjustViewBounds="true"
                android:clickable="true"
                android:focusable="true"
                android:scaleType="fitCenter"
                android:src="@drawable/ic_launcher" />

            <TextView
                android:id="@+id/tv_p2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="bottom|center"
                android:clickable="false"
                android:focusable="false"
                android:text="page2"
                android:textSize="10sp" />
        </FrameLayout>

        <FrameLayout
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_marginRight="10dip" >

            <ImageButton
                android:id="@+id/b_p3"
                android:layout_width="58dip"
                android:layout_height="58dip"
                android:layout_gravity="top"
                android:layout_marginTop="5dip"
                android:adjustViewBounds="true"
                android:clickable="true"
                android:focusable="true"
                android:scaleType="fitCenter"
                android:src="@drawable/ic_launcher" />

            <TextView
                android:id="@+id/tv_p3"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="bottom|center"
                android:clickable="false"
                android:focusable="false"
                android:text="page3"
                android:textSize="10sp" />
        </FrameLayout>

        <FrameLayout
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_marginRight="10dip" >

            <ImageButton
                android:id="@+id/b_p4"
                android:layout_width="58dip"
                android:layout_height="58dip"
                android:layout_gravity="top"
                android:layout_marginTop="5dip"
                android:adjustViewBounds="true"
                android:clickable="true"
                android:focusable="true"
                android:scaleType="fitCenter"
                android:src="@drawable/ic_launcher" />

            <TextView
                android:id="@+id/tv_p4"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="bottom|center"
                android:clickable="false"
                android:focusable="false"
                android:text="page4"
                android:textSize="10sp" />
        </FrameLayout>
    </LinearLayout>
</LinearLayout>

<ScrollView
    android:id="@+id/scrollView1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@id/bottom_control_bar"
    android:layout_below="@id/top_control_bar"
    android:fillViewport="true"
    android:measureAllChildren="false" >

    <LinearLayout
        android:id="@+id/linlay1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="#770000"
        android:clipChildren="true"
        android:duplicateParentState="false"
        android:fitsSystemWindows="false"
        android:orientation="vertical" >

        <LinearLayout
            android:id="@+id/searchbar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:minHeight="60dip"
            android:orientation="horizontal" >

            <EditText
                android:id="@+id/query"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="left|center_vertical"
                android:layout_marginLeft="5dip"
                android:layout_marginRight="5dip"
                android:layout_weight="20"
                android:imeOptions="actionSearch"
                android:lines="1" >

                <requestFocus />
            </EditText>

            <Button
                android:id="@+id/btn_cancel"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="right|center_vertical"
                android:layout_weight="60"
                android:drawablePadding="5dip"
                android:gravity="center"
                android:hapticFeedbackEnabled="true"
                android:maxHeight="48dip"
                android:minHeight="48dip"
                android:text="Search"
                android:textSize="12sp"
                android:textStyle="bold" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/buttons"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:minHeight="60dip"
            android:orientation="horizontal" >

            <Button
                android:id="@+id/btn_1"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical|center_horizontal"
                android:layout_weight="60"
                android:drawablePadding="5dip"
                android:gravity="center"
                android:hapticFeedbackEnabled="true"
                android:maxHeight="48dip"
                android:minHeight="48dip"
                android:text="b1"
                android:textSize="12sp"
                android:textStyle="bold" />

            <Button
                android:id="@+id/btn_2"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical|center_horizontal"
                android:layout_weight="60"
                android:drawablePadding="5dip"
                android:gravity="center"
                android:hapticFeedbackEnabled="true"
                android:maxHeight="48dip"
                android:minHeight="48dip"
                android:text="b2"
                android:textSize="12sp"
                android:textStyle="bold" />

            <Button
                android:id="@+id/btn_3"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical|center_horizontal"
                android:layout_weight="60"
                android:drawablePadding="5dip"
                android:gravity="center"
                android:hapticFeedbackEnabled="true"
                android:maxHeight="48dip"
                android:minHeight="48dip"
                android:text="b3"
                android:textSize="12sp"
                android:textStyle="bold" />

            <Button
                android:id="@+id/btn_4"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_gravity="center_vertical|center_horizontal"
                android:layout_weight="60"
                android:drawablePadding="5dip"
                android:gravity="center"
                android:hapticFeedbackEnabled="true"
                android:maxHeight="48dip"
                android:minHeight="48dip"
                android:text="b4"
                android:textSize="12sp"
                android:textStyle="bold" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/picbar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <ImageView
                android:id="@+id/imageView1"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_gravity="center"
                android:src="@android:drawable/toast_frame" />
        </LinearLayout>

        <LinearLayout
            android:id="@+id/actionbar"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="10"
            android:background="#007700"
            android:orientation="horizontal" >

            <Button
                android:id="@+id/btn_warp"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_marginBottom="5dip"
                android:layout_marginTop="5dip"
                android:text="warp"
                android:textSize="12sp"
                android:textStyle="bold" />
        </LinearLayout>
    </LinearLayout>
</ScrollView> 
```

# passwords - 寻找用于构建密码短语的单词列表

> ID：11508873
> 
> 赞同：2
> 
> 时间：2012-07-16T16:50:54.670
> 
> 标签：passwords

我一直在寻找可以导入并使用到我正在研究的密码短语构建工具中的名词、动词和形容词的单词列表。我没有抓住英语中的每一个单词，而是试图找到可以连接成声音密码短语的更简单的单词。

有谁知道这样的资源？我尝试过 Google 搜索、Binging、嬉皮士和 hoppity，但我似乎找不到任何相关内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:45:21.277

当您说“通过电话轻松沟通”时，您的意思是指在由各种说话者发音时通常很难与其他词混淆的词？即，也许“cape”听起来很独特，但是“teen”听起来太像“fifty”了？如果是这样，你手头有一项艰巨的任务。

您可以通过分析 Google Ngram 集获得“常用”词： [http ://storage.googleapis.com/books/ngrams/books/datasetsv2.html](http://storage.googleapis.com/books/ngrams/books/datasetsv2.html)

您可以使用 soundex/metaphone 分析来确定“声音唯一性”。

如果我接受这个，我会：

1.  获取某个（最近）年份最常见的 1 克。
2.  计算/存储每个单词的[双变音位](http://en.wikipedia.org/wiki/Metaphone#Double_Metaphone)。
3.  按变音位分组，看看在变音位只有 1 个与之相关的常用词的情况下你得到了多少。

所以，是的，这不是一个简单的列表，但你所要求的也不简单，对不起！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T03:16:45.490

您可以使用（几乎）所有 unix 发行版附带的词汇表。可以在`/usr/share/dict/words`.

[这是列表，如果您没有 unix 框](http://www.cs.duke.edu/~ola/ap/linuxwords)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T20:50:33.677

我会对此进行破解，但您可能不喜欢答案。我能想到的最简单的方法是使用搜索词“名词”或“动词”以及 fyletype:csv 在谷歌上查找 CSV 列表。找到符合条件的文件后。我在 GITHub 上找到了很多，您可以进行一些 github 调用，或者如果不在 GIT 上，您可以使用您选择的服务器端语言对文件进行 CURL 或 HTTP 调用...生成逗号分隔列表或数组（某种结构），然后创建一个随机函数并调整列表（使用 randrange 或类似的方法获取一个或两个最重要的单词并拼接 rand 号）。然后，您可以连接一串单词和数字。如果您可以为所有单词制作一个简单的两个或三个字段表（剪切并粘贴它们）或从原始文件导入，那就更容易了...... 并做一个做同样事情的查询。选择一个或三个随机单词并将它们连接起来，并使用记录的行号来唯一化它们。

但是有两件事是肯定的，你需要一个消耗过程，你需要字符串连接函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T18:59:28.547

请检查这些： http: [//ogden.basic-english.org/words.html](http://ogden.basic-english.org/words.html) [https://simple.wikipedia.org/wiki/Wikipedia:List_of_1000_basic_words](https://simple.wikipedia.org/wiki/Wikipedia:List_of_1000_basic_words) [https://simple.wikipedia.org/wiki/Wikipedia:Basic_English_alphabetical_wordlist](https://simple.wikipedia.org/wiki/Wikipedia:Basic_English_alphabetical_wordlist)

通过使用简单的网络抓取，您可以获取所有这些单词的列表，然后使它们独一无二。

此外还引用了其他一些链接，也请检查这些链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T20:10:58.707

我完全推荐这个： http: [//packetstormsecurity.com/Crackers/wordlists/](http://packetstormsecurity.com/Crackers/wordlists/)

只是在开玩笑！你试过[WordNet](http://wordnet.princeton.edu/)吗？它有各种语言、平台等的接口，非常强大。

# c# - 读/写加密的xml

> ID：11508878
> 
> 赞同：1
> 
> 时间：2012-07-16T16:51:40.357
> 
> 标签：c#, xml, serialization, encryption

在我尝试加密/解密之前，我可以很好地阅读我的序列化类......这是我的代码片段：

```
public class ShelfCache
{
    public Shelf Data;
    public ShelfCache()
    {
        Data = new Shelf();
    }

    public void Write(string Filename)
    {
        XmlSerializer xsl = new XmlSerializer(typeof(Shelf));
        TextWriter xslWriter = new StreamWriter(Filename);
        xsl.Serialize(xslWriter, Data);
        xslWriter.Flush();
        xslWriter.Close();
    }

    public void Read(string Filename)
    {
        Data = new Shelf();
        XmlSerializer xsl = new XmlSerializer(typeof(Shelf));
        TextReader xslReader = new StreamReader(Filename);
        Data = (Shelf)xsl.Deserialize(xslReader);
        xslReader.Close();
    }

    public void WriteEncrypted(string Filename, string EncryptionKey = "")
    {
        string _Key = EncryptionKey + Environment.ExpandEnvironmentVariables("%USERNAME%%COMPUTERNAME%123456789ABCDEF0123456789abcdef").Substring(0, 32);
        string _IV = Environment.ExpandEnvironmentVariables("%COMPUTERNAME%123456789abcdef").Substring(0, 16);
        byte[] Key = Encoding.UTF8.GetBytes(_Key);
        byte[] IV = Encoding.UTF8.GetBytes(_IV);

        FileStream CacheStream = new FileStream(Filename, FileMode.Create, FileAccess.ReadWrite, FileShare.Read);
        RijndaelManaged CryptoProvider = new RijndaelManaged();
        ICryptoTransform CacheTransform = CryptoProvider.CreateEncryptor(Key, IV);
        CryptoStream EncryptionStream = new CryptoStream(CacheStream, CacheTransform, CryptoStreamMode.Write);
        XmlSerializer xsl = new XmlSerializer(typeof(Shelf));
        xsl.Serialize(EncryptionStream, Data);
        EncryptionStream.Flush();
        CacheStream.Close();
    }

    public void ReadEncrypted(string Filename, string EncryptionKey = "")
    {
        string _Key = EncryptionKey + Environment.ExpandEnvironmentVariables("%USERNAME%%COMPUTERNAME%123456789ABCDEF0123456789abcdef").Substring(0, 32);
        string _IV = Environment.ExpandEnvironmentVariables("%COMPUTERNAME%123456789abcdef").Substring(0, 16);
        byte[] Key = Encoding.UTF8.GetBytes(_Key);
        byte[] IV = Encoding.UTF8.GetBytes(_IV);

        FileStream CacheStream = new FileStream(Filename, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
        RijndaelManaged CryptoProvider = new RijndaelManaged();
        ICryptoTransform CacheTransform = CryptoProvider.CreateEncryptor(Key, IV);
        CryptoStream DecryptionStream = new CryptoStream(CacheStream, CacheTransform, CryptoStreamMode.Read);
        XmlSerializer xsl = new XmlSerializer(typeof(Shelf));
        Data = (Shelf)xsl.Deserialize(DecryptionStream);
        CacheStream.Close();
    }

} 
```

我收到异常“XML 文档 (1 1) 中存在错误”。有一个内部异常“根级别的数据无效。第 1 行，位置 1。” 在线上：

```
 Data = (Shelf)xsl.Deserialize(DecryptionStream); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-17T13:42:56.083

这就是我最终要做的（我不喜欢这个解决方案，但它有效）......

```
public class ShelfCache
{
    public Shelf Data;

    public ShelfCache()
    {
        Data = new Shelf();
    }

    public void Write(string Filename)
    {           
        XmlSerializer CacheSerializer = new XmlSerializer(typeof(Shelf));
        TextWriter CacheWriter = new StreamWriter(Filename);
        CacheSerializer.Serialize(CacheWriter, Data);
        CacheWriter.Flush();
        CacheWriter.Close();
    }

    public void Read(string Filename)
    {
        Data = new Shelf();
        XmlSerializer CacheSerializer = new XmlSerializer(typeof(Shelf));
        TextReader CacheReader = new StreamReader(Filename);
        Data = (Shelf)CacheSerializer.Deserialize(CacheReader);
        CacheReader.Close();
    }

    public void WriteEncrypted(string Filename, string EncryptionKey = "")
    {
        string TempFile = System.IO.Path.GetTempFileName();
        Write(TempFile);
        EncryptFile(TempFile, Filename, EncryptionKey);
        File.Delete(TempFile);
    }

    public void ReadEncrypted(string Filename, string EncryptionKey = "")
    {
        string TempFile = System.IO.Path.GetTempFileName();
        DecryptFile(Filename, TempFile, EncryptionKey);
        Read(TempFile);
        File.Delete(TempFile);
    }

    private RijndaelManaged GetEncryptor(string Key = "", string Salt = "")
    {
        Key += Environment.ExpandEnvironmentVariables("%USERNAME%");
        Salt += Environment.ExpandEnvironmentVariables("%COMPUTERNAME%");
        Rfc2898DeriveBytes derivedKey = new Rfc2898DeriveBytes(Key, Encoding.Unicode.GetBytes(Salt));
        RijndaelManaged rijndaelCSP = new RijndaelManaged();
        rijndaelCSP.Key = derivedKey.GetBytes(rijndaelCSP.KeySize / 8);
        rijndaelCSP.IV = derivedKey.GetBytes(rijndaelCSP.BlockSize / 8);
        return rijndaelCSP;
    }

    private void EncryptFile(string Source, string Target, string EncryptionKey)
    {
        RijndaelManaged EncryptionProvider = GetEncryptor(EncryptionKey);
        ICryptoTransform Encryptor = EncryptionProvider.CreateEncryptor();

        FileStream SourceStream = new FileStream(Source, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
        byte[] SourceBytes = new byte[(int)SourceStream.Length];
        SourceStream.Read(SourceBytes, 0, (int)SourceStream.Length);
        FileStream TargetStream = new FileStream(Target, FileMode.Create, FileAccess.Write);
        CryptoStream EncryptionStream = new CryptoStream(TargetStream, Encryptor, CryptoStreamMode.Write);
        EncryptionStream.Write(SourceBytes, 0, (int)SourceStream.Length);
        EncryptionStream.FlushFinalBlock();

        EncryptionProvider.Clear();
        EncryptionStream.Close();
        SourceStream.Close();
        TargetStream.Close();
    }

    private void DecryptFile(string Source, string Target, string EncryptionKey)
    {
        RijndaelManaged EncryptionProvider = GetEncryptor(EncryptionKey);
        ICryptoTransform Decryptor = EncryptionProvider.CreateDecryptor();

        FileStream SourceStream = new FileStream(Source, FileMode.Open, FileAccess.Read);
        CryptoStream DecryptionStream = new CryptoStream(SourceStream, Decryptor, CryptoStreamMode.Read);
        byte[] SourceBytes = new byte[(int)SourceStream.Length];
        int DecryptionLength = DecryptionStream.Read(SourceBytes, 0, (int)SourceStream.Length);
        FileStream TargetStream = new FileStream(Target, FileMode.Create, FileAccess.Write);
        TargetStream.Write(SourceBytes, 0, DecryptionLength);
        TargetStream.Flush();

        EncryptionProvider.Clear();
        DecryptionStream.Close();
        SourceStream.Close();
        TargetStream.Close();
    }

} 
```

# clojure - Clojure Repl 无法解析所有函数的符号

> ID：11508881
> 
> 赞同：3
> 
> 时间：2012-07-16T16:51:55.943
> 
> 标签：clojure, read-eval-print-loop

我用 Leiningen 创建了项目，并在*Core.clj*文件中添加了以下代码：

```
(ns hyperstring.core
(:use [clojure.pprint :only (pprint)])
(:require [clojure.java.io :as io]
          [clojure.string :as str])
(:import  [java.io File]))

;;read file line by line
(defn read-line-by-line [filepath]
 (with-open [rdr (reader filepath)]
   (doseq [line (line-seq rdr)]
     (println line))))

;;write to a new file
(defn write-file [filepath]
(with-open [wrtr (writer filepath)]
    (.write wrtr "Line to be written"))) 
```

和其他功能

*我使用clojure-jack-in*进入 REPL并使用*(ns hyperstring.core)*切换到我的命名空间。接下来，我尝试在文件中启动任何函数并获取 REPL 答案：

```
java.lang.Exception: Unable to resolve symbol: read-line-by-line in this context 
```

**我想念什么？**也许一些选项或部门？

clojure-1.4.0、Leiningen-2.0、swank-1.4.4

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T18:06:21.600

`(ns some.thing)`不只是切换到命名空间；它创造了它。

您应该首先使用（例如）加载您的函数：

`(require 'hyperstring.core)`

或者在 core.clj 中来自 Slime, `C-c C-k`(slime-compile-and-load-file), `C-c C-p`(slime-repl-set-package)。

# c# - 具有动态结构的类对象

> ID：11508887
> 
> 赞同：0
> 
> 时间：2012-07-16T16:52:11.270
> 
> 标签：c#, json, oop

嗨，我正在尝试在 C# DataContractJsonSerializer 的帮助下解析 json 对象，这就是 json 的样子

{"user_id":"121","Q1":"问题 1","Q2":"问题 2","Q3":"问题 3"}

问题的数量可以是 200-500，所以我不想用 500 个变量创建一个 DataContract 来解析这个 Json，所以我在想是否有一种方法可以让我用一个数字调用这个类对象的构造函数或其他东西如果json中有Q1-Q30，则像这样的参数

Objectparse new_object = new Objectparse(30);

哪个会在运行时创建变量 Q1 到 Q30？并解析 Json

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T16:59:40.610

您可以使用[JavaScriptSerializer](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.aspx)：

```
var json = @"{""user_id"":""121"",""Q1"":""question 1"",""Q2"":""question 2"",""Q3"":""question 3""}";
var serializer = new JavaScriptSerializer();
dynamic result = serializer.DeserializeObject(json);
Console.WriteLine(result["Q1"]);
Console.WriteLine(result["Q2"]);
... 
```

如果您使用的是比 4.0 更旧的 .NET 版本并且无法使用该`dynamic`功能，您可以这样做：

```
var json = @"{""user_id"":""121"",""Q1"":""question 1"",""Q2"":""question 2"",""Q3"":""question 3""}";
var serializer = new JavaScriptSerializer();
var result = (IDictionary<string, object>)serializer.DeserializeObject(json);
Console.WriteLine(result["Q1"]);
Console.WriteLine(result["Q2"]);
... 
```

但让我指出，这是一个极其糟糕的 JSON 设计。设计这个类的人可能不知道 javascript 数组：

```
{
    "user_id": "121",
    "questions": [
        {
            "key": "Q1",
            "value": "question 1"
        },
        {
            "key": "Q2",
            "value": "question 2"
        },
        {
            "key": "Q3",
            "value": "question 3"
        }
    ]
} 
```

现在可以将其序列化为包含问题集合的强类型对象。

# ios - 将自定义 UIView 更改为 UIScrollView

> ID：11508890
> 
> 赞同：1
> 
> 时间：2012-07-16T16:52:26.120
> 
> 标签：ios, uiscrollview, uiimageview, xib, custom-view

一般来说：我在 UIViewController 上有一个带有 xib 文件的自定义 UIView 作为子视图。我在控制器中以编程方式添加子视图。

在我的 UIViewController 中：

```
NSArray *subviewArray = [[NSBundle mainBundle] loadNibNamed:@"MyCustomSubView" owner:self  options:nil];
mySubView = [subviewArray objectAtIndex:0];
...
[self.view addSubview:mapView]; 
```

因为我需要在这个子视图上滚动，它上面也有一个 UIImageView，所以我决定将我的自定义 UIView 更改为 UIScrollView。

我做了以下步骤：

*   更改了 MyCustomSubView.xib，添加了一个带有自定义类 MyCustomSubView 的 UIScrollView（和之前一样的 UIImageView）
*   更改了我的 MyCustomSubView 类以扩展 UIScrollView
*   更改了我的 MyViewController 以实现 UIScrollViewDelegate
*   将 mySubView.delegate 设置为 self（控制器）
*   实现 (UIView *)viewForZoomingInScrollView:(UIScrollView *)scrollView 并返回子视图的 UIImageView
*   在 imageview 和 uiscrollview 上启用用户交互

这些是我认为的总步骤。但作为示例，未调用 viewForZoomingInScrollView 方法。我也尝试放大，但什么也没发生。

任何人的想法，可能有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:00:09.057

简要查看[`UIScrollView`Class Reference page](http://developer.apple.com/library/ios/documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/doc/uid/TP40006922-CH3-DontLinkElementID_1 "UIScrollView 类参考")，我看到以下内容：

> UIScrollView 类可以有一个必须采用 UIScrollViewDelegate 协议的委托。要使缩放和平移工作，代理必须同时实现 viewForZoomingInScrollView: 和 scrollViewDidEndZooming:withView:atScale:; 另外，最大（maximumZoomScale）和最小（minimumZoomScale）缩放比例必须不同。

您提到了实施`viewForZoomingInScrollView:`，但没有提到`scrollViewDidEndZooming:atScale:`，也没有提到设置`maximumZoomScale`或`minimumZoomScale`。尝试做这些事情，然后检查您是否仍有问题。

# vb.net - 如何将数据集查询结果放入电子邮件正文

> ID：11508891
> 
> 赞同：0
> 
> 时间：2012-07-16T16:52:33.063
> 
> 标签：vb.net, dataset

我正在尝试制作一个程序，将查询结果（在数据集中）通过电子邮件发送给用户......我的代码是：

```
Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

        Me.Paid_Out_TbTableAdapter.Fill(Me.dataset.Paid_Out_Tb)
        Me.ReportViewer1.RefreshReport()
        Try
            Dim SmtpServer As New SmtpClient()
            Dim mail As New MailMessage()
            SmtpServer.Credentials = New  _
            Net.NetworkCredential("Bob", "password")
            SmtpServer.Port = 25
            SmtpServer.Host = "server"
            mail = New MailMessage()
            mail.From = New MailAddress("email@email.com")
            mail.To.Add("Email@email.com")
            mail.Subject = "Test Mail"
            mail.Body = (Me.DataSet.Paid_Out_Tb.ToString)
            SmtpServer.Send(mail)
            MsgBox("mail send")
        Catch ex As Exception
            MsgBox(ex.ToString)
        End Try
    End Sub 
```

除了发送电子邮件正文外，一切正常......我怎样才能将结果作为正文发送到电子邮件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:45:36.377

您可以使用 Linq 和 VB 的新内联 xml 文字功能来生成 html。尝试这个：

```
Dim payOuts = _
<html>
    <body>
        <table>
            <tr><th>My First Column Header</th><th>My Second Column Header</th></tr>
            <%= From paidOut In Me.DataDeliveryServiceDataSet.Paid_Out_Tb.AsEnumerable _
                Select <tr>
                            <td><%= paidOut.MyFirstColum %></td>
                            <td><%= paidOut.MySecondColum %></td>
                       </tr> %>
        </table>
    </body>
</html>

mail.IsBodyHtml = True 
mail.Body = payouts.ToString 
```

如果 System.Data.DataSetExtensions.dll 不存在，请务必在项目中包含对它的引用。你还需要`Imports System.Linq`在你的课上。请参阅 Éric Moreau 发布的 Using [LINQ and XML Literals to transform a DataTable into a HTML table](http://www.emoreau.com/Entries/Articles/2009/04/Using-LINQ-and-XML-Literals-to-transform-a-DataTable-into-a-HTML-table.aspx)博客以获得很好的解释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:08:39.080

您将需要循环浏览数据集的行并提取您希望通过电子邮件发送的数据。您可以通过添加以下语句使用 HTML 对其进行格式化：

```
mail.IsBodyHtml = True 
```

# servlets - jqGrid：dataurl 不起作用

> ID：11508896
> 
> 赞同：1
> 
> 时间：2012-07-16T16:52:53.897
> 
> 标签：servlets, select, jqgrid, population

我是 jQuery 和 jQGrid 的新手。我试图用来自服务器的数据填充网格中的下拉组合框，我在 java servlet 环境中。我使用了 dataUrl 方法和许多其他方法，但填充组合仍然没有运气。

我的 js 看起来像：

```
...
{name:'idTipologia',index:'idTipologia', width:80,editable: true,edittype:"select",editoptions:{dataUrl: "/sohara/comboTipologiaAction.do"}...
... 
```

我的服务器端代码基本上是：从服务器获取列表，格式化数据（无论是否为 json），打开 PrintWriter，在其中写入信息。

我尝试了来自 Firebug 的 JSON 转换和纯文本，我可以看到响应格式正确（“1：VALUE1；2：VALUE2”），但下拉列表仍然为空。

我的问题是：

是否有一种特殊的方法来组织数据以使这个组合人口？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T19:00:01.993

根据[jqGrid 文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:common_rules)，您的问题是`dataUrl`需要返回包含`SELECT`元素的 HTML，而不是 JSON：

> editoptions dataUrl 参数仅对edittype:select 的元素有效。dataUrl 参数表示应该从中获取 html 选择元素的 url。
> 
> 设置此选项后，元素将填充来自 AJAX 请求的值。数据应该是具有所需选项的有效 HTML 选择元素 - 例如：
> 
> ```
> <select> 
> <option value='1'>One</option> 
> <option value='2'>Two</option> 
> ...
> </select> 
> ```

所以最简单的解决方案是只返回 HTML。

* * *

也就是说，我不喜欢直接返回 UI 元素的想法。另一种选择是使用该`buildSelect`函数`SELECT`为您构造元素：

> 仅当设置了 dataUrl 参数时，此选项才相关。当服务器响应无法构建 select 元素时，您可以使用自己的函数来构建 select。该函数应返回一个包含 select 和 options 值的字符串，如 dataUrl 选项中所述。传递给此函数的参数是服务器响应

[这个答案](https://stackoverflow.com/questions/4101116/asp-net-mvc-post-call-returning-string-need-help-with-format-for-jqgrid/4102155#4102155)提供了一个如何使用的例子`buildSelect`。

# python - 如何使用 BeautifulSoup 匹配仅包含指定类而不包含任何其他类的标签？

> ID：11508897
> 
> 赞同：2
> 
> 时间：2012-07-16T16:52:53.647
> 
> 标签：python, python-3.x, beautifulsoup

有没有办法使用 BeautifulSoup 来匹配*仅*具有指示`class`属性的标签，而不是指示`class`属性等？例如，在这个简单的 HTML 中：

```
<html>
 <head>
  <title>
   Title here
  </title>
 </head>
 <body>
  <div class="one two">
   some content here
  </div>
  <div class="two">
   more content here
  </div>
 </body>
</html> 
```

是否可以只匹配`div`with`class="two"`而不匹配`div`with `class="one two"`？除非我遗漏了什么，否则文档的[该部分](http://www.crummy.com/software/BeautifulSoup/bs3/documentation.html#Searching%20by%20CSS%20class)不会给我任何想法。这是我目前使用的代码：

```
from bs4 import BeautifulSoup

html = '''
<html>
 <head>
  <title>
   Title here
  </title>
 </head>
 <body>
  <div class="one two">
   should not be matched
  </div>
  <div class="two">
   this should be matched
  </div>
 </body>
</html>
'''

soup = BeautifulSoup(html)
div_two = soup.find("div", "two")
print(div_two.contents[0].strip()) 
```

我试图让它打印`this should be matched`而不是`should not be matched`.

编辑：在这个简单的例子中，我知道类的唯一选项是`"one two"`or `"two"`，但在生产代码中，我只知道我想要匹配的将有 class `"two"`; 除了 之外，其他标签可能还有大量其他类`"two"`，这可能是未知的。

在相关说明中，阅读版本[**4**](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#multi-valued-attributes)[的文档](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#multi-valued-attributes)**也很有帮助，而不是我之前链接的版本 3。**

 *** * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:59:45.540

尝试：

```
divs = soup.findAll('div', class="two")

for div in divs:
    if div['class'] == ['two']:
        pass # handle class="two"
    else:
        pass # handle other cases, including but not limited to "one two" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:01:16.353

希望，下面的代码可以帮助你。虽然我没试过这个。

```
soup.find("div", { "class" : "two" }) 
```**

# android - 关于为 Android 开发时间线视图的建议？

> ID：11508898
> 
> 赞同：0
> 
> 时间：2012-07-16T16:52:55.770
> 
> 标签：android, android-asynctask, scrollview

我想为 Android 开发一个时间线视图，它就像一个无限滚动的谷歌日历日视图。

`RelativeLayout`现在我在 a 中使用了固定长度`ScrollView`，我想我应该使用它`AsyncTask`来动态加载数据。

1.  我不知道是否需要使用`AsynTask`来加载数据，因为我现在只想加载一些文本。

2.  我的想法是在上下边界附近设置两个点，`RelativeLayout`并在滚动这些点时加载数据。我应该准备子视图`AsyncTask`并将它们附加到`RelativeLayout`in`onPostExecute()`还是创建一个新`RelativeLayout`的然后替换旧的 in `onPostExecute()`？

常见的做法是什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T17:10:25.490

1.  如果您从静态数组或其他已经在内存中的数据源加载数据，您可以在 UI 线程上执行此操作。如果您要从磁盘或网络加载数据，您应该（并且在网络的情况下必须）从后台线程（即不是 UI 线程）加载它，这`AsyncTask<>`是一个很好的方法。

2.  你的方法似乎很合理。您可以在用户滚动时记忆和重用布局。

# php - 新 Imageick() 不运行

> ID：11508900
> 
> 赞同：0
> 
> 时间：2012-07-16T16:52:58.220
> 
> 标签：php, imagemagick

我已经在我的 ubuntu 12.04 服务器上安装了 imagemagick、php5-imagick。现在如果我想使用

```
$image = new Image() 
```

那里停了！

```
 echo "1";
            $img1 = new Imagick();
            $img1 -> readImage("/the/absolut/path/to/image.png");
            echo "1,3";
            // Upload image
            $img2 = new Imagick("dl/$md5");
            echo "2";

            $img1->compositeImage( $img2, imagick::COMPOSITE_COPYOPACITY, 0, 0 );
            echo "3";

            echo $img1; 
```

但它只给出“1”。为什么？怎么了？

# r - 在同一个ggplot中绘制离散和连续尺度

> ID：11508902
> 
> 赞同：13
> 
> 时间：2012-07-16T16:53:13.570
> 
> 标签：r, graphics, ggplot2, gis

我想使用 ggplot2 绘制一些不同的数据项，使用两种不同的色标（一个连续的，一个来自两个不同 df 的离散）。我可以单独绘制我想要的任何一个，但我不能让它们一起工作。似乎您不能在同一个情节中使用两种不同的色标？我在[这里](https://stackoverflow.com/questions/9232331/ggplot2-multiple-color-scales-or-shift-colors-systematically-on-different-layer)和[这里](https://stackoverflow.com/questions/9916194/two-color-scales-for-geom-line-in-ggplot2)看到了类似的问题，这让我相信我想要实现的目标在 ggplot2 中根本不可能，但以防万一我错了，我想说明我的问题，看看是否有变通方法。

我有一些 GIS 流数据，其中附加了一些分类属性，我可以绘制（`p1`在下面的代码中）来获得： ![在此处输入图像描述](../Images/b044bdba06cb6bfee7fd0d46957bfcec.png)

我还有一组具有连续响应的位置，我也可以绘制（`p2`在下面的代码中）来获得： ![在此处输入图像描述](../Images/d2102ea268225d2e13b0becfe188d6dc.png) 但是我不能将两者结合起来（`p3`在下面的代码中）。我收到这个错误

> 比例错误[[prev_aes]]：尝试选择少于一个元素

注释掉该行`scale_colour_hue("Strahler order") +`会将错误更改为

> 错误：提供给连续刻度的离散值

基本上，似乎 ggplot2 对`geom_path`调用和`geom_point`调用使用相同的比例类型（连续或离散）。因此，当我将离散变量 , 传递 `factor(Strahler)`给`scale_colour_gradientn`比例时，绘图失败。

有没有解决的办法？`data`如果scales 函数有一个参数来告诉它应该从哪里映射或设置属性，那就太棒了。这甚至可能吗？

非常感谢和可重现的代码如下：

```
library(ggplot2)

### Download df's   ###
oldwd <- getwd(); tmp <- tempdir(); setwd(tmp)
url <- "http://dl.dropbox.com/u/44829974/Data.zip"
f <- paste(tmp,"\\tmp.zip",sep="")
download.file(url,f)
unzip(f)

### Read in data    ###
riv_df <- read.table("riv_df.csv", sep=",",h=T)
afr_df <- read.table("afr_df.csv", sep=",",h=T)
vil_df <- read.table("vil_df.csv", sep=",",h=T)

### Min and max for plot area   ###
xmin <- -18; xmax <- 3; ymin <- 4; ymax <- 15

### Plot river data ###
p1 <-   ggplot(riv_df, aes(long, lat)) + 
    geom_map( mapping = aes( long , lat , map_id = id ) , fill = "white" , data = afr_df , map = afr_df ) +
    geom_path( colour = "grey95" , mapping = aes( long , lat , group = group , size = 1 ) , data = afr_df ) +
    geom_path( aes( group = id , alpha = I(Strahler/6) , colour = factor(Strahler) , size = Strahler/6 ) ) +
    scale_alpha( guide = "none" ) +
    scale_colour_hue("Strahler order") +
    scale_x_continuous( limits = c( xmin , xmax ) , expand = c( 0 , 0 ) ) +
    scale_y_continuous( limits = c( ymin , ymax ) , expand = c( 0 , 0 ) ) +
    coord_map()
print(p1) # This may take a little while depending on computer speed...

### Plot response data  ###
p2 <- ggplot( NULL ) +
    geom_point( aes( X , Y , colour = Z) , size = 2 , shape = 19 , data = vil_df ) +
    scale_colour_gradientn( colours = rev(heat.colors(25)) , guide="colourbar" ) +
    coord_equal()
print(p2)

### Plot both together  ###
p3 <-   ggplot(riv_df, aes(long, lat)) + 
    geom_map( mapping = aes( long , lat , map_id = id ) , fill = "white" , data = afr_df , map = afr_df ) +
    geom_path( colour = "grey95" , mapping = aes( long , lat , group = group , size = 1 ) , data = afr_df ) +
    geom_path( aes( group = id , alpha = I(Strahler/6) , colour = factor(Strahler) , size = Strahler/6 ) ) +
    scale_colour_hue("Strahler order") +
    scale_alpha( guide = "none" ) +
    scale_x_continuous( limits = c( xmin , xmax ) , expand = c( 0 , 0 ) ) +
    scale_y_continuous( limits = c( ymin , ymax ) , expand = c( 0 , 0 ) ) +
    geom_point( aes( X , Y , colour = Z) , size = 2 , shape = 19 , data = vil_df ) +
    scale_colour_gradientn( colours = rev(heat.colors(25)) , guide="colourbar" ) +
    coord_map()
print(p3)
#Error in scales[[prev_aes]] : attempt to select less than one element

### Clear-up downloaded files   ###
unlink(tmp,recursive=T)
setwd(oldwd) 
```

干杯，

西蒙

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-06-11T15:17:04.090

你可以这样做。您需要告诉网格图形将一个图覆盖在另一个图之上。您*必须*得到*完全*正确的边距和间距等，并且您必须考虑顶层的透明度。总之……*不值得*。以及可能使情节混乱。

但是，我认为有些人可能会喜欢有关如何实现这一目标的指针。注意我使用[**这个 gist**](https://gist.github.com/dsparks/3711166)中的代码使顶部图中的元素透明，这样它们就不会使下面的元素不透明：

```
grid.newpage()
pushViewport( viewport( layout = grid.layout( 1 , 1 , widths = unit( 1 , "npc" ) ) ) ) 
print( p1 + theme(legend.position="none") , vp = viewport( layout.pos.row = 1 , layout.pos.col = 1 ) )
print( p2 + theme(legend.position="none") , vp = viewport( layout.pos.row = 1 , layout.pos.col = 1 ) ) 
```

请参阅我的答案[**，**](https://stackoverflow.com/a/16368413/1478381)了解如何将图例添加到网格布局的另一个位置。

![在此处输入图像描述](../Images/fba121102a4bcb959488769767b71046.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-19T13:03:45.063

问题并不像你想象的那么复杂。通常，您只能映射一次美学。所以调用`scale_colour_*`两次对ggplot2没有意义。它会试图强迫一个进入另一个。

无论一个是连续的还是离散的，您都不能在同一个图表中有多个色标。包作者说他们也不打算添加这个。实现起来相当复杂，并且很容易制作令人难以置信的混乱图表。（由于类似的原因，永远不会实现多个 y 轴。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-04-23T03:52:55.197

我现在没有时间提供一个完整的工作示例，但还有另一种方法值得在这里提及：[ggplot 中 geom_point (scale_colour_manual) 中的填充和边框颜色](https://stackoverflow.com/questions/15965870/fill-and-border-colour-in-geom-point-scale-colour-manual-in-ggplot)

基本上，结合使用 geom_point可以让您使用而不是审美`shape = 21, color = NA`来控制一系列点的颜色。这是我的代码的样子。我知道没有提供数据，但希望它为您提供一个起点：`fill``color`

```
biloxi + 
  geom_point(data = filter(train, primary != 'na'), 
             aes(y = GEO_LATITUDE, x = GEO_LONGITUDE, fill = primary), 
             shape = 21, color = NA, size = 1) + 
    scale_fill_manual(values = c('dodgerblue', 'firebrick')) + 
  geom_point(data = test_map_frame, 
             aes(y = GEO_LATITUDE, x = GEO_LONGITUDE, color = var_score), 
            alpha = 1, size = 1) + 
    scale_color_gradient2(low = 'dodgerblue4', high = 'firebrick4', mid = 'white',
                    midpoint = mean(test_map_frame$var_score)) 
```

请注意对 geom_point 的每次调用如何调用不同的审美（`color`或`fill`）

# ruby-on-rails-3 - 一个二维数组作为参数值

> ID：11508903
> 
> 赞同：2
> 
> 时间：2012-07-16T16:53:13.497
> 
> 标签：ruby-on-rails-3, railstutorial.org

我刚刚完成了 Ruby on Rails 3 教程。最后一章相当复杂。整本书的教程基本上创建了一个用户可以发布微博的网站。此外，每个用户都可以关注任何其他用户，然后以下用户的微博将显示在原始用户的微博提要中。

我的问题与为什么RelationshipsController 中的create 操作的params 变量包含一个二维数组有关。

这是代码。

**用户**

```
class User < ActiveRecord::Base
  attr_accessible :email, :name, :password, :password_confirmation
  has_secure_password
  has_many :microposts, dependent: :destroy
  has_many :relationships, foreign_key: "follower_id", dependent: :destroy
  has_many :followed_users, through: :relationships, source: :followed
  has_many :reverse_relationships, foreign_key: "followed_id", 
      class_name: "Relationship", dependent:   :destroy
  has_many :followers, through: :reverse_relationships, source: :follower
end 
```

**微博**

```
class Micropost < ActiveRecord::Base
  attr_accessible :content
  belongs_to :user
end 
```

**关系**

```
class Relationship < ActiveRecord::Base
  attr_accessible :followed_id

  belongs_to :follower, class_name: "User"
  belongs_to :followed, class_name: "User"
end 
```

**我认为这是创建二维参数变量的代码（但为什么？）**

```
<%= form_for(current_user.relationships.build(followed_id: @user.id), remote: true) do       
    |f| %>
  <div><%= f.hidden_field :followed_id %></div>
  <%= f.submit "Follow", class: "btn btn-large btn-primary" %>
<% end %> 
```

**关系控制器**

```
class RelationshipsController < ApplicationController  
  def create
    @user = User.find(params[:relationship][:followed_id])
    current_user.follow!(@user)
    respond_to do |format|
      format.html { redirect_to @user }
      format.js
    end
  end
end 
```

所以也许我只是回答了我自己的问题，但我从未见过 params 变量的二维数组。有人可以对此有所了解吗？

哦，也许我也应该发布我的 routes.rb 文件：

```
SampleApp::Application.routes.draw do
  resources :users do
    member do
      get :following, :followers
    end
  end
  resources :sessions, only: [:new, :create, :destroy]
  resources :microposts, only: [:create, :destroy]
  resources :relationships, only: [:create, :destroy]

  root to: 'static_pages#home'
end 
```

谢谢，迈克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:36:57.787

简短的回答：

这不是一个二维数组，它是一个嵌套的关联数组。您使用它的原因是为了获得您真正想要的领域。

* * *

长答：

教程假设：当用户点击关注按钮时，目标是调用`current_user.follow!(other_user)`. 我将引导您了解代码是如何实现这一点的。所有的魔法都在关系控制器和视图中的 form_for 函数中。

首先，您为新的关系制作表格。因为它是一个嵌套资源，所以您通过关联来构建它。

```
current_user.relationships.build 
```

但是一个只对应一个用户的全新的关系对象并没有多大意义。相反，传入一个关联的值数组来初始化对象。在这种情况下，其他用户的 id。因此，您将要构建的关系对象的 :followed_id 属性分配给 @user.id 或您尝试关注的用户。

```
current_user.relationships.build(followed_id: @user.id) 
```

当您对一个对象进行 form_for 时，您可以访问该对象的属性。在这种情况下，如果我们查看关系模型，则只有 :followed_id 是可访问的。

```
class Relationship < ActiveRecord::Base
  attr_accessible :followed_id 
```

最后，我们需要捕获表单提交中的followed_id，因为表单的目标是能够`current_user.follow!(other_user)`在点击关注按钮时调用。所以我们将followed_id作为隐藏字段传入，这样它就可以在`params`控制器中访问，但用户在视图本身中也看不到它。

```
 <%= f.hidden_field :followed_id %> 
```

最后，当单击按钮时，因为表单是针对新的关系对象的，所以为关系控制器调用创建操作。在那里，要访问与表单对应的关系对象，您的操作方式与教程中的其他表单相同 -

```
params[:relationship] 
```

但是你不想要关系对象，你想要跟随的用户对象，这样你就可以调用`follow!`. 这很简单。只需从 id 中找到数据库中的用户即可。如何获得followed_id？它是表单中关系对象的一个​​属性。

```
params[:relationship][:followed_id] 
```

* * *

我认为值得注意的是，当你创建一个新的用户对象时，你使用了 params[:user]。这只是一个关联数组，如果您愿意，可以访问它的字段

```
params[:user][:name] 
```

希望这是有道理的。它只是一个嵌套的关联数组 Rails 用来跟踪参数，例如提交表单的参数。

# iphone - CFReadStreamCopyError 在 iPad 设备上报告错误

> ID：11508904
> 
> 赞同：0
> 
> 时间：2012-07-16T16:53:18.157
> 
> 标签：iphone, objective-c, nsstream

我遇到了一个问题。相同的代码在 iPhone (iOS 5) 和 iPhone/iPad 模拟器上运行良好。但它不适用于 iPad (iOS 5)。我会很感激任何帮助。

这是读取端口代码：

```
//Code for read port.
 CFIndex bytesRead = CFReadStreamRead(inputStream, bufferPoint, 1024);
 if (bytesRead < 0) {
     NSLog(@"bytesRead < 0");
     CFErrorRef error = CFReadStreamCopyError(inputStream);
     //reportError(error);
     DEBUGLOG(@"readResponse error \n") 
```

在上面之前，有连接部分代码。

```
//prevent to release before relocate
if ((inputStream != nil) && (outputStream != nil)) {
    [inputStream release];
    inputStream = nil;
    [outputStream release];
    outputStream = nil;
}
[NSStream getStreamsToHostNamed:relayHost port:relayPort inputStream:&inputStream outputStream:&outputStream];
//[self lgetStreamsToHostNamed:relayHost port:relayPort inputStream:&inputStream outputStream:&outputStream];
if ((inputStream != nil) && (outputStream != nil))
{
    sendState = kIMAPConnecting;

    isSecure = NO;

    [inputStream retain];
    [outputStream retain];

    [inputStream setDelegate:self];
    [outputStream setDelegate:self];

    result = [inputStream setProperty:NSStreamSocketSecurityLevelNegotiatedSSL forKey:NSStreamSocketSecurityLevelKey];
    DEBUGLOG(@"inputStream setProperty result: %d", result);
    result =[ outputStream setProperty:NSStreamSocketSecurityLevelNegotiatedSSL forKey:NSStreamSocketSecurityLevelKey];
    DEBUGLOG(@"outputStream setProperty result: %d", result);

    if (!CFReadStreamOpen(inputStream)) {
        DEBUGLOG(@"inputStream open failed");
        return NO;
    }

    if (!CFWriteStreamOpen(outputStream)) {
        DEBUGLOG(@"outputStream open failed");
        return NO;
    }

    self.inputString = [NSMutableString string];        

    DEBUGLOG(@"SCRIMAPMessage startToConnect end with YES\n");
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T18:02:04.393

以下内容无法通过 iOS 获得：

```
[NSStream getStreamsToHostNamed:relayHost port:relayPort inputStream:&inputStream outputStream:&outputStream]; 
```

我真的不知道它如何在 iPhone 的 iOS 上运行。

你的选择很简单...

A) 如 Apple 的技术说明中所述，在 NSStream 上创建一个类别：[here](http://developer.apple.com/library/ios/#qa/qa1652/_index.html)

B) 使用 CFStreamCreatePairWithSocketToHost() 并简单地桥接 CFReadStreamRef/CFWriteStreamRef

我推荐（B），因为它将为您提供灵活性的最佳选择。更具体地说，您可以创建自己的 StreamObject 类来处理此问题，并将流委托合二为一。

快乐编码！

# .net - 检查 AutoResetEvent 状态

> ID：11508908
> 
> 赞同：9
> 
> 时间：2012-07-16T16:53:29.107
> 
> 标签：.net, multithreading, autoresetevent

是否可以检查`AutoResetEvent`对象的实际处理方式？它是由超时触发还是通过从另一个方法调用 Set() 触发的？

这是我的代码。

```
private AutoResetEvent autoResetEvent = new AutoResetEvent(false);
private int timeout = 30000;

public void SyncMethod()
{
    // some code before
    autoResetEvent.WaitOne(timeout);
    // if autoResetEvent called by timeout then { do some stuff } 
    // some code after
}
public void AsyncMethod()
{
    // some code before
    // ok I am done
    autoResetEvent.Set();
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-07-16T16:58:48.553

WaitHandle::WaitOne 方法 (Int32)

返回值类型：System::Boolean

如果当前实例接收到信号，则为 true；否则为假。

因此，超时后返回 false。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-07-16T16:58:12.223

是的，检查返回值

> 如果当前实例接收到信号，则为 true；否则为假。

[http://msdn.microsoft.com/en-us/library/cc189907](http://msdn.microsoft.com/en-us/library/cc189907)

# c# - WPF，WinForm C#

> ID：11508910
> 
> 赞同：-2
> 
> 时间：2012-07-16T16:53:34.123
> 
> 标签：c#, wpf, avalondock

我正在尝试创建一个带有复选标记和 WPF 控件的表格（带有两个文本块的范围滑块）。WPF 控件是使用 Avalon 库编写的，我成功地将它添加到我的表中。但是，当表单关闭时，我需要从文本块中获取文本并将其应用到某个地方。我可以遍历表单上的控件，找到元素宿主，但我不知道如何从表单上的两个文本块中提取值。我的代码附在下面。你能帮我解决这个问题吗？

代码：

```
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public static TableLayoutPanel _T;
        static void set_globalvalue(TableLayoutPanel val)
        {
            _T = val;
        }

        public Form1()
        {
            InitializeComponent();

            TableLayoutPanel TP = new TableLayoutPanel();
            TP.ColumnCount = 2;
            TP.RowCount = 5;
            TP.BackColor = Color.White;
            this.Controls.Add(TP);
            TP.CellBorderStyle = TableLayoutPanelCellBorderStyle.Single;
            int size = 0;
            for (int i = 0; i < TP.RowCount; i++)
            {
                ElementHost host = new ElementHost();
                UserControl1 uc = new UserControl1(1,15);
                host.Name = i.ToString();
                host.Dock = DockStyle.Top;
                host.Child = uc;
                TP.Controls.Add(host, 1, i);
                host.Width = 270;
                host.Height = 40;
                CheckBox ch = new CheckBox();
                ch.Name = i.ToString() + "_che";
                TP.Controls.Add(ch, 0, i);
                size = size + host.Height+20;
            }

            TP.Height = size;
            TP.Width = 700;
            set_globalvalue(TP);
            this.FormClosing += Form1_FormClosing;
        }

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            for (int i = 1; i <= _T.ColumnCount; i++)
            {
                for (int j = 0; j <= _T.RowCount; j++)
                {
                    Control c = _T.GetControlFromPosition(i, j);

                    if (c != null & c is System.Windows.Forms.Integration.ElementHost)
                    {
                        ElementHost host =c as ElementHost;
                        System.Windows.UIElement u = host.Child;
                          ???????????????????
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:24:21.373

获得对元素宿主的引用后，您可以按照以下方式进行操作：

```
ElementHost host = c as ElementHost;

UserControl1 uc = host.Child as UserControl1;

if (uc != null)
{
   //Get the text from uc
} 
```

# objective-c - NSOpenPanel 没有从文件名中正确访问 NSUrl，带有空格

> ID：11508912
> 
> 赞同：3
> 
> 时间：2012-07-16T16:53:36.543
> 
> 标签：objective-c, xcode, csv, whitespace, nsopenpanel

搜索了一下，没有发现这方面的问题。

我的应用程序采用 .csv 文件，切换数据并以我公司认为有用的方式将其吐出。问题是该程序似乎需要没有空格的文件名。例如，“My data.csv”将不起作用，但“My_data.csv”将起作用。这是我认为相关的代码

```
 NSArray *allowedTypes = [NSArray arrayWithObjects:@"CSV",@"csv",nil];
openDLG = [NSOpenPanel openPanel];
[openDLG setDelegate:self];
[openDLG setCanChooseFiles:YES];
[openDLG setAllowedFileTypes:allowedTypes];

NSInteger openReturn = [openDLG runModal];
if (openReturn == NSFileHandlingPanelOKButton) {
    NSArray *rawCSVs = [openDLG URLs];
    NSEnumerator *enumerator = [rawCSVs objectEnumerator];
    id object;
    while ((object = [enumerator nextObject])) {
        NSString *tempDump = [NSString stringWithContentsOfURL:object encoding:NSUTF8StringEncoding error:NULL];
        NSArray *bigArray = [tempDump csvRows];
        int total = [bigArray count];
        ....do other things 
```

在调试模式下，“object”对于带有空格的文件名显示为 nil，“tempdump”字符串对于带有空格的文件名显示为@“nil”，但对于 names_with_underscores

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T19:19:44.637

URL 不允许每个字符，因此您需要进行一些转换。

```
NSString *rawString = [NSString stringWithString:@"/Users/myusername/test 1.txt"];
NSString *escapedString = [rawString stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSURL *url = [NSURL URLWithString:escapedString];
NSLog(@"url: %@", url); 
```

# .htaccess - 在某些 URL Zend Framework 上禁用 SSL

> ID：11508913
> 
> 赞同：1
> 
> 时间：2012-07-16T16:53:40.567
> 
> 标签：.htaccess, zend-framework, mod-rewrite

我有一个生成 URL 的 Zend 应用程序

```
http://miapp.com/module/controller/action/params/values 
```

我想从 SSL 中排除具有参数的某个 URL（打印或下载）

实际上我有这个 .htaccess 参数来通过 SSL 重定向所有请求并生成动态 URL 重写

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
RewriteCond %{REQUEST_FILENAME} !-s     
RewriteCond %{REQUEST_FILENAME} !-l     
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^.*$ /index.php [NC,L]
php_flag display_startup_errors off
php_flag display_errors off
php_flag html_errors off 
```

但是如何排除包含打印或下载的 URL？

你试试这样的东西:(但我得到了重定向循环错误

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,NC,L]
RewriteCond %{HTTPS} on
RewriteCond %{HTTP_REFERER} !^https(.*)/(print|download)(.*)$ [NC]
RewriteCond %{REQUEST_URI} !^(.*)/(print|download)(.*)$ [NC]
RewriteRule (.*) http://%{HTTP_HOST}%{REQUEST_URI} [R=301,NC,L]
RewriteCond %{REQUEST_FILENAME} !-s     
RewriteCond %{REQUEST_FILENAME} !-l     
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^.*$ /index.php [NC,L]
php_flag display_startup_errors off
php_flag display_errors off
php_flag html_errors off 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-17T14:56:11.053

通常对重写规则存在误解，因为它们是在 Web 服务器内部完成的。只要重写规则中不涉及重定向，这是正确的。重定向将带有新 URL 和状态码 3xx 的重定向返回给浏览器。

使用您的第二个 htaccess，您有两个重定向。您的第一条规则告诉浏览器“老兄，使用 SSL。再试一次”。如果请求不是 HTTPS，则在向客户端返回 301 状态代码和新 URL 后，连接将终止。htaccess 文件中不再处理任何行。浏览器必须向服务器发送一个新请求。

如果您的第一句话是正确的，并且您在 Zend 框架中创建没有 https 的 URL，这是一个奖励。如果你这样做，你基本上会产生大量流量，因为每个带有链接的请求都是 301 重定向的，即由浏览器返回并重新发送。您应该在 Zend 中使用 https 创建 URL 以避免这种情况。

现在关于你的第二条规则。此规则告诉浏览器“老兄，您的路径包含打印或下载，您不需要 HTTPS。再试一次。” 如上所述，连接现在终止，htaccess 文件中不再处理任何行。当然，这个新请求会在您提到的循环中结束您的第一条规则。

现在你真正需要的就是这个，我相信（我无法测试它）。您将打印|下载作为例外包含在您的 HTTPS 条件中。

```
RewriteEngine On
RewriteCond %{HTTPS} !=on
RewriteCond %{HTTP_REFERER} !^https(.*)/(print|download)(.*)$ [NC]
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,NC,L] 
```

不过，在您的 Zend 应用程序中，您必须确保您的链接只是 HTTP。不是让重写规则起作用，而是你的 IE 请求。

# mongodb - MongoDB 统计

> ID：11508915
> 
> 赞同：0
> 
> 时间：2012-07-16T16:53:43.767
> 
> 标签：mongodb, statistics

我正在使用副本集运行 MongoDB 实例，当有很多插入时，我可以在`faults`和上看到非常奇怪的统计信息`locked %`。

*   怎么`locked %`可能超过100个？！

*   故障发生在哪里，我没有提到任何故障的日志，有人知道这意味着什么吗？

    ```
    insert  query update delete getmore command flushes mapped  vsize    res faults locked % idx miss %     qr|qw   ar|aw  netIn netOut  conn      set repl       time 
     9      0      0      0       1       4       0  70.3g   141g  4.77g     20      124          0       0|0     0|1     1m     2m    10 socialdb    M   18:49:49 
    18      0      0      0       3       1       0  70.3g   141g  4.77g     17     73.8          0       0|0     0|1     1m     2m    10 socialdb    M   18:49:50 
    21      0      0      0       1       5       0  70.3g   141g  4.77g     18      104          0       0|0     0|1     1m     1m    10 socialdb    M   18:49:51 
    20      0      0      0       3       1       0  70.3g   141g  4.78g     18     98.8          0       0|0     0|1     1m     3m    10 socialdb    M   18:49:52 
    172      0      0      0       5       4       0  70.3g   141g  4.79g    133     72.8          0       0|0     0|0     7m    12m    10 socialdb    M   18:49:53 
    76      0      0      0       3       1       0  70.3g   141g   4.8g    114     65.1          0       0|0     0|1     6m    10m    10 socialdb    M   18:49:54 
    54      0      0      0       4       4       1  70.3g   141g  4.81g     45     90.6          0       0|0     0|1     2m     8m    10 socialdb    M   18:49:55 
    85      0      0      0       4       2       0  70.3g   141g  4.84g    101     98.1          0       0|0     0|1     6m    11m    10 socialdb    M   18:49:56 
    77      0      0      0       3       4       0  70.3g   141g  4.82g     78     74.5          0       0|0     0|1     4m     9m    10 socialdb    M   18:49:57 
    72      0      0      0       3       1       0  70.3g   141g  4.84g    111     95.7          0       0|0     0|1     6m    10m    10 socialdb    M   18:49:58 
    ```

*   有没有更好的（标准）监控工具，免费的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:45:40.260

不确定其他两个，但如果您使用的是 v2.2，这可能是您第一个问题的答案：http: [//docs.mongodb.org/manual/reference/mongostat/](http://docs.mongodb.org/manual/reference/mongostat/)
上面的页面提到：

锁定：百分比全局写锁中的时间。

（在 2.2 版中更改：锁定的 db 字段将锁定的 % 字段替换为关于 2.2 版中数据库特定锁的更合适的数据）

锁定数据库：2.2 版中的新功能。

每个数据库上下文特定锁定中的时间百分比。mongostat 将报告自上次使用写锁调用 mongostat 以来花费最多时间的数据库。

此值表示数据库具有特定于数据库的锁的时间量以及 mongod 在全局锁中花费的时间。因此，以及采样方法，您可能会看到一些*大于 100%*的值。

# matlab - 线与圆的交点

> ID：11508932
> 
> 赞同：0
> 
> 时间：2012-07-16T16:54:50.840
> 
> 标签：matlab, line, geometry

> **可能重复：**
> [不同斜率的线和圆相交](https://stackoverflow.com/questions/11510330/intersection-of-line-and-circle-with-different-slope)

我有当时绘制的`pp=randi([-400 400],2,2)`线`x=pp(:,1)`和`y=pp(:,2)`. 我有一个中心 (a,b) 半径为 r 的圆

我想检查圆和线的交点。

我使用`polyfit`命令来检查斜率和截距。然后我使用`lincirc`了命令，但问题是如果线只穿过一个点，那么另一个点也会显示出来。

例如，如果线越过一侧并停在中间，它也会显示另一个不会越过边界的点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:11:11.747

你有一个以 (a,b) 为中心的圆半径 r。你有一条线。如果您绘制了这些点，则必须将数据存储在 x 和 y 向量中，因此您将每个元素的第一个和最后一个元素作为 (x,y) 坐标。第一对形成线的起点，最后一对形成终点。将这些点称为 (c1,d1) 和 (c2,d2)。假设您的 lincirc 函数告诉您直线和圆之间有 2 个交点，计算

```
A1 = (c1-a,d1-b)
A2 = (c2-a,d2-b) 
```

现在如果

```
norm(A1,2) < r 
```

然后端点（c1，d1）在你的圈子内，如果

```
norm(A2,2) < r 
```

然后端点（c2，d2）在你的圈子内。

如果其中一个点在圆内，那么您只有一个交点。

如果两个点都不在圆内，那么您知道您的线两次穿过圆（假设您的 lincirc 函数告诉您有 2 个点）

如果两个点都在圆圈内，那么你的 lincirc 函数就是在骗你。

# licensing - 安装 Win CE 6.0 许可证

> ID：11508935
> 
> 赞同：2
> 
> 时间：2012-07-16T16:55:11.363
> 
> 标签：licensing, windows-ce, platform-builder, installation, windows-embedded-compact

我们终于设法开发和测试了我们的自定义 Win CE 6.0 安装。我们在试用版上所做的一切。现在想为每个设备购买许可证并将其安装到目标 Win CE 操作系统中。

有人有要遵循的程序的描述吗？Visual Studio 2005 中是否有任何工具可以做到这一点？

最终的操作系统是否必须使用许可证编译到 NK.bin 中，还是放在其他地方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:54:48.747

获得 NK.Bin 后，您可以使用 Platform Builder（AKA Visual Studio 2005 with Windows Embedded CE 6.0）用您的 Windows CE 许可证“标记”它：

![在此处输入图像描述](../Images/89e06d42aac23bc03caeccce134123ba.png)

查看 MSDN 中的此页面以获取更多详细信息：

[标记运行时映像 (Windows Embedded CE 6.0)](http://msdn.microsoft.com/en-us/library/ee478909%28v=winembedded.60%29.aspx)

此另一篇文章描述了如何使用命令行工具 stampbin 自动化该过程：

[自动化 CE *.bin 文件的标记](http://microsoft-personal-operating-systems.hostweb.com/TopicMessages/microsoft.public.windowsce.platbuilder/877519/1/Default.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T18:47:54.373

只需将[ship build ( `WINCESHIP`) 设置为 1](http://msdn.microsoft.com/en-us/library/ms934283.aspx)构建设备操作系统，然后将提供的 CAL 贴纸贴在设备上。

# class - visual basic 6 类图像

> ID：11508936
> 
> 赞同：0
> 
> 时间：2012-07-16T16:55:12.423
> 
> 标签：class, vb6

运行程序时出现错误。我想将图像更改为另一个图像，但图像不会改变。请帮我找出来。

这是我的代码：

```
Public Image1Color As String
Public Image1 As Image

Public Sub CheckIn()
If Image1Color = "Green" Then
    Image1.Picture = LoadPicture("Color\red1.jpg")
    Image1Color = "Red"
Else
    MsgBox ("This table is already occupied!")
End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:33:03.357

试试这个：

```
Set Image1.Picture = LoadPicture("Color\red1.jpg") 
```

（注意`Set`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T18:02:39.637

您可以使用`stdpicture`

```
Dim pic As New StdPicture
Set pic = LoadPicture("")
Set Me.Picture = pic 
```

在您的代码中，例如：

```
Public Image1Color As String
Public Image1 As New StdPicture

Public Sub CheckIn()
If Image1Color = "Green" Then
   Set Image1 = LoadPicture("Color\red1.jpg")
    Image1Color = "Red"
Else
    MsgBox ("This table is already occupied!")
End If
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-17T10:14:02.083

`Image1Color = "Green"`您必须在代码中的某处进行初始化。

如果您不初始化 Image1Color 那么它将是一个空字符串，并且总是转到`Else`您的语句的一部分

[编辑]

我刚刚阅读了您对错误消息的评论。

将 Image 控件添加到表单并使用该 Image 控件比在代码中声明它更容易。

# ruby-on-rails - redis 数据库大小（2N 或 N^2）

> ID：11508937
> 
> 赞同：1
> 
> 时间：2012-07-16T16:55:18.757
> 
> 标签：ruby-on-rails, ruby, nosql, redis, paradigms

我有一个用 Ruby 编写的 redis 数据库和客户端。这个数据库的大小是多少？

```
def follow!(user)
  $redis.multi do
    $redis.sadd(self.redis_key(:following), user.id)
    $redis.sadd(user.redis_key(:followers), self.id)
  end
end

def redis_key(str)
  "user:#{self.id}:#{str}"
end

# Usage:
userA.follow!(userB) 
```

我认为是2N，但有人告诉我是N^2，什么是真的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:17:29.650

Redis 数据库的大小是 INFO 返回的 used_memory_human 值。由于内存优化，从给定的数据结构中猜测实际大小并不容易。最好在有限数量的项目上进行测试并进行推断。

在这里，假设 N 是用户数，您将在 Redis 键空间中有 2N 个集合。这些集合的大小取决于追随者的数量。

如果所有用户都有一个关注者并且只有一个关注者，您将获得 2N 组 1 个项目，因此 2N 个项目。如果所有用户都将所有其他用户作为关注者，您将获得 2N 组 (N-1) 个项目，总共有 2N(N-1) 个项目。

# sql - 计算在多个网站上订购的用户的订单数量

> ID：11508941
> 
> 赞同：2
> 
> 时间：2012-07-16T16:55:26.620
> 
> 标签：sql, sql-server

我有一个订单表，用于存储来自我们公司内多个站点的订单。在表中，我们有字段 userid、ordernumber 和 sitename。我希望能够获得从我们的 2 个或更多站点订购的用户数量。

这是我开始的：

```
SELECT
  o.ordernumber,
  o.sitename,
  o.userdbid,
  o2.sitename,
  o2.userdbid,
  o2.ordernumber
FROM
  orders o
INNER JOIN
  orders o2
ON
  o.userdbid = o2.userdbid
WHERE
  o.sitename != o2.sitename
ORDER BY
  o.userdbid; 
```

这并不接近正确，但这是我能想到的。任何帮助或指导将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T16:59:16.870

您将需要一个`HAVING`子句将聚合`COUNT()`与 2 进行比较，其中您已按`userbid`. 请务必`DISTINCT`在您的聚合中使用，`COUNT()`以便您获得多个站点而不仅仅是多个订单。

```
SELECT
  o.userbid,
  COUNT(DISTINCT o.sitename) AS num_order_sites
FROM
  orders o
GROUP BY o.userbid
HAVING COUNT(DISTINCT o.sitename) >= 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T16:59:15.063

如果您只寻找从多个站点订购的用户，您实际上不需要进行自我加入。你只需要这个。

```
SELECT
  o.userdbid
FROM
  orders o
GROUP BY o.userdbid
HAVING 
    COUNT(o.sitename) > 1 
```

如果您想找到其他信息，您可以加入这些结果。

例如

```
SELECT 
     o.ordernumber,
     o.sitename,
     o.userdbid
FROM   orders o 
   INNER JOIN (SELECT o.userdbid 
               FROM   orders o 
               GROUP  BY o.userdbid 
               HAVING Count( DISTINCT o.sitename) > 1) morethanOne 
           ON o.userdbid = morethanone.o.userdbid 
```

更新：请注意[迈克尔](https://stackoverflow.com/a/11508997/119477)关于 DISTINCT的观点

[演示](http://sqlfiddle.com/#!3/4c629/21)

# facebook-graph-api - 为什么洞察力与图表不匹配？

> ID：11508949
> 
> 赞同：2
> 
> 时间：2012-07-16T16:56:02.150
> 
> 标签：facebook-graph-api, facebook-insights

我见过很多情况，其中从 Graph API 端点报告的特定帖子的点赞数、评论数和分享数与 Insights 报告的统计数据不匹配。IE：

[https://graph.facebook.com/PAGEID_POSTID](https://graph.facebook.com/PAGEID_POSTID)报告：

赞1000，评论450，分享300

[https://graph.facebook.com/PAGEID_POSTID/insights/post_stories_by_action_type](https://graph.facebook.com/PAGEID_POSTID/insights/post_stories_by_action_type)报告：

赞 725，评论 375，分享，200

或类似的东西。我确实意识到，有时，洞察力会显示**更高的**数字，因为洞察力会跟踪从原始帖子的共享副本生成的故事（非常酷），但在这些情况下，洞察力报告的数字**低于**Graph API 端点显示的数字。

这是因为 28 天后，Facebook Insights 停止更新个别帖子的统计信息吗？

有任何想法吗？

我在这里提交了一个错误：[https ://developers.facebook.com/bugs/400094966692945](https://developers.facebook.com/bugs/400094966692945)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:23:56.767

不幸的现实是 Facebook Insights 漏洞百出，一般来说修复 api 漏洞似乎并不是 Facebook 的首要任务。

如果您经常访问您的见解页面，您会看到这一点。应用删除次数激增 1000% 的日子，两天后用户安装量飙升 1000%。在您的数据库中记录了数千条应用程序帖子的评论为零的日子。名单还在继续……

即使他们“修复”了 Insights 错误，他们也并不总是修复历史记录，将不准确的数据留在原地，仅在前进的基础上进行更正。

这是任何报告或分析系统的死亡之吻。一旦您开始一遍又一遍地看到错误，您从自己的独立数据中知道报告系统存在错误，您就会开始质疑它向您展示的一切：这是现实还是错误？如果我不能信任这些数据，我该如何根据这些数据做出任何决定？有企业经验的人都知道这一点，但经营 Facebook 的孩子们……不知道。

# asp.net - 如何降低 asp.net gridview 控件的整体高度？

> ID：11508953
> 
> 赞同：0
> 
> 时间：2012-07-16T16:56:24.293
> 
> 标签：asp.net, gridview

我正在尝试降低此网格视图的整体高度，因此底部没有那么多“空行”。我尝试设置高度属性。我还尝试将 PagingSize 设置为较小的数字并设置 AllowPaging Attribute=true

数据源将返回可变数量的行，但 gridview 需要固定高度。现在，它占用的垂直空间比任何最大数量的 HearingInfo 都多得多。换句话说，底部有足够的空间至少再多 10 行，但永远不会再多 10 行。

我有一段时间没有使用 ASP.net Web 控件了...

```
 <asp:GridView ID="gvHearingInfo" runat="server" AutoGenerateColumns="False" EnableModelValidation="True" 
            ShowHeader="False" Width="100%" GridLines="Vertical" 
            Height="50px">
            <Columns>
                <asp:BoundField DataField="Authority" HeaderText="Authority" 
                    SortExpression="Authority">
                <ItemStyle Width="144px" Wrap="False" HorizontalAlign="Left" 
                    BorderColor="Black" />
                </asp:BoundField>
                <asp:BoundField DataField="PublicHearing" HeaderText="PublicHearing" 
                    SortExpression="PublicHearing" >
                <ItemStyle HorizontalAlign="Left" Width="431px" BorderColor="Black"  />
                </asp:BoundField>
                <asp:BoundField DataField="HearingDate" HeaderText="HearingDate" 
                    SortExpression="HearingDate" >
                <ItemStyle HorizontalAlign="Center" Width="93px" BorderColor="Black"  />
                </asp:BoundField>
                <asp:BoundField DataField="HearingTime" HeaderText="HearingTime" 
                    SortExpression="HearingTime" >
                <ItemStyle HorizontalAlign="Center" Width="92px" BorderColor="Black"  />
                </asp:BoundField>
                <asp:BoundField DataField="DistrictTelephone" HeaderText="DistrictTelephone" 
                    SortExpression="DistrictTelephone" >
                <ItemStyle HorizontalAlign="Center"  Width="94px" BorderColor="Black"  />
                </asp:BoundField>
            </Columns>
        </asp:GridView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:37:05.683

```
Results.DataSource = dataView;

Results.DataBind();

foreach(GridViewRow row in this.Results.Rows) 
{
   if (row.Equals(""))
     {
      Results.Rows[0].Visible = false;
     }

} 
```

否则您将不得不使用 GridView.RowDataBound 事件，但我认为代码应该可以完成工作......

# macros - 跨 CMakeLists 的 CMake 宏

> ID：11508959
> 
> 赞同：4
> 
> 时间：2012-07-16T16:57:22.040
> 
> 标签：macros, cmake

我有一个 c++ 项目，其目录结构如下：

```
server/
   code/
      BASE/
         Thread/
         Log/
         Memory/
      Net/
   cmake/
      CMakeList.txt
      BASE/
         CMakeList.txt
      Net/
         CMakeList.txt 
```

这是/cmake/CMakeList.txt 的一部分：

```
MACRO(SUBDIRLIST result curdir)
  FILE(GLOB children RELATIVE ${curdir} ${curdir}/*)
  SET(dirlist "")
  FOREACH(child ${children})
    IF(IS_DIRECTORY ${curdir}/${child})
        SET(dirlist ${dirlist} ${child})
    ENDIF()
  ENDFOREACH()
  SET(${result} ${dirlist})
ENDMACRO()

add_subdirectory(Base) 
```

然后在 /cmake/Base/CMakeList.txt 中使用宏：

```
SET(SUBDIR, "")
SUBDIRLIST(SUBDIRS, ${BASE_SRC_DIR})
message("SUBDIRS : " ${SUBDIRS}) 
```

输出：子目录：

我通过在宏中输出它的值来检查 ${dirlist}，我得到预期的目录列表，但是当 SET（${result} ${dirlist}）之后的消息（“result” ${result}）时，我无法获得预期的输出，我的 CMakeLists.txt 有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-16T18:23:23.987

这里有几个小问题：

1.  在您的宏中，`SET(dirlist "")`可能只是`SET(dirlist)`. 同样，`SET(SUBDIR, "")`可能只是`SET(SUBDIRS)`（我猜“SUBDIR”是一个错字，应该是“SUBDIRS”。你也不希望`set`命令中的逗号 - 可能是另一个错字？）
2.  `${result}`要在宏中输出 的内容，请使用`message("result: ${${result}}")`, 因为您不是每次都追加，而是追加`${child}`到. 在你的例子中是，所以是。`result``${result}``${result}``SUBDIRS``${${result}}``${SUBDIRS}`
3.  调用 时`SUBDIRLIST`，不要在参数之间使用逗号。
4.  当您输出 的值时`SUBDIRS`，请包含`${SUBDIRS}`在引号中，即，`message("SUBDIRS: ${SUBDIRS}")`否则您将丢失分号分隔符。

除此之外，您的宏似乎还不错。

# c++ - 多个相似的函数编码风格

> ID：11508963
> 
> 赞同：2
> 
> 时间：2012-07-16T16:57:37.197
> 
> 标签：c++, coding-style

我有一大堆看起来非常相似的函数：它们采用相同的争论类型并返回字符串。

```
std::string f1(T arg);
std::string f2(T arg);
std::string f3(T arg);
std::string f4(T arg);
.
.
. 
```

在一个循环中，它们是根据结构 T 中的一个变量来使用的。目前要做到这一点，我的代码中只有一个大块`switch/case`。

有没有更好的编码风格来做到这一点？大块代码看起来很奇怪。

我希望 c++ 可以像 python 那样做`eval("f" + str(i) + "(arg))"`

该块是这样的：

```
std::string out = "";

switch (arg.tag){
    case 1:
        out += f1(arg);
        break;
    case 2:
        out += f2(arg);
        break;
    .
    .
    .
} 
```

大约 2 打案例

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T17:04:22.950

使用 C++11，您可以使用地图相当轻松地做到这一点`std::function`：

```
#include <map>
#include <functional>
#include <string>
#include <iostream>

std::string f1(int) { return "f1"; }
std::string f2(int) { return "f2"; }

std::map<int, std::function<std::string(int)> > funcs = {
  {1,f1},
  {2,f2}
};

int main() {
  std::cout << funcs[1](100) << "\n";    
} 
```

如果没有 C++11，您将希望使用 Boost 代替`std::function`或滚动您自己的类型。您可以使用普通的旧函数指针，但这会排除一些方便的东西（例如`std::bind`/ `boost::bind`，仿函数对象，lambda 函数。您还可以使用您的函数实现的接口定义类型层次结构，例如以下在 C++03 中的作品，除了对于地图的初始化方式：

```
#include <map>
#include <functional>
#include <string>
#include <iostream>

std::string f1(int) { return "f1"; }
std::string f2(int) { return "f2"; }

std::map<int, std::string(*)(int)> funcs = {
  std::make_pair(1,f1),
  std::make_pair(2,f2)
};

int main() {
  std::cout << funcs[1](100) << "\n";    
} 
```

或者这个可以让你编写任何你喜欢的仿函数对象：

```
#include <map>
#include <string>
#include <iostream>

struct thing {
  virtual std::string operator()(int) const = 0;
};

struct f1 : thing {
  std::string operator()(int) const { return "f1"; }
};

struct f2 : thing {
  std::string operator()(int) const { return "f2"; }
};

// Note the leak - these never get deleted:
std::map<int, thing*> funcs = {
  std::make_pair(1,new f1),
  std::make_pair(2,new f2)
};

int main() {
  std::cout << (*funcs[1])(100) << "\n";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:04:01.337

模仿的一种方法`Eval()`是拥有一张地图。映射的键是函数的名称，值是指向相应函数的指针。

在这种情况下，您将能够通过地图`operator[]`名称调用所需的函数。这将以某种方式模拟该`eval("f" + str(i) + "(arg))"`行为，尽管它可能仍然不是您的最佳解决方案。

# android - Android SqlLite 没有这样的列 _id 异常

> ID：11508964
> 
> 赞同：1
> 
> 时间：2012-07-16T16:57:38.277
> 
> 标签：android, sqlite

不要立即标记我重复的问题。我的问题不同，因为我有一个格式正确的 SQL 查询。

```
public static final String TABLE_NAME = "log";
public static final String COLUMN_ID = "_id";
public static final String LOG_TEXT = "logtext";
private static final String TABLE_CREATE = "CREATE TABLE " + TABLE_NAME + " (" +
        COLUMN_ID + " integer primary key autoincrement, " +
        LOG_TEXT + " TEXT not null);";

@Override
public void onCreate(SQLiteDatabase db) {
    db.execSQL(TABLE_CREATE);

} 
```

我在这里查询

```
String[] columns = {LOG_TEXT,COLUMN_ID};
    Cursor cursor = helper.getReadableDatabase().query(TABLE_NAME, columns, null, null, null, null, COLUMN_ID + " desc"); 
```

我抓住了这个包含 sql 查询的异常。

```
catch(Exception e){
Log.D("sql Exception",e.getMessage());} 
```

它返回

```
no such column: _id: , while compiling: SELECT logtext, _id FROM log ORDER BY _id desc 
```

我对 Oracle SQL 和一般的关系数据库很熟悉。是我的 ORDER BY 子句吗？我确信你总是可以使用 order by。它与 GROUP BY 的行为不同。

关于为什么例外的任何想法？万一有人想看到我正在使用我的 ArrayAdaptor 语句进行更新。我在列表视图中使用光标

```
String[] data = query();

    adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, android.R.id.text1, data);
    listView.setAdapter(adapter);} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-07-16T17:02:06.323

**改写**

每当您更改架构时，`TABLE_CREATE`您必须将这些更改通知您的应用程序，当您更改时它们不会自动发生`TABLE_CREATE`。最简单的方法是`database_version`在扩展的 SQLiteOpenHelper 类中增加你的值。您发现您也可以卸载/重新安装该应用程序，以获得相同的结果。如果您精通 SQL，则可以更改表。但无论采用何种方法，您都必须确保您的应用在尝试访问新列之前进行架构更改......

也适用于 SQLite：

```
_id integer primary key 
```

是[同义词](http://www.sqlite.org/lang_createtable.html#rowid)：

```
_id integer primary key autoincrement not null 
```

并且查询使用降序作为默认顺序，因此`ORDER BY _id`与`ORDER BY _id DESC`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-26T21:27:03.120

有同样的问题，这意味着它应该可以工作但没有（我修复的 create 命令中有一些拼写错误，但仍然没有帮助）。然后一位同事告诉我尝试清除数据（仅在 AppInfo 然后“清除数据”）解决了我的问题，显然旧数据库（不起作用）仍然存在，必须先清除。

我只是把这个答案放在这里，以防像我这样的其他人（android初学者）偶然发现这个问题，因为我经历了几十个stackoverflow线程来解决这个问题，但没有一个提供这种可能性/解决方案，它困扰了我很长一段时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:10:51.220

您是否稍后将列的定义添加`_id`到您的 create 语句中，即在代码已经运行一次之后？数据库是持久文件，因此如果您在代码中修改表结构，则需要确保清除应用程序的数据，以便可以使用正确的表/列数据重新创建数据库文件。

# c# - 自定义管道组件 SSIS 错误：HREF 0xC0048021

> ID：11508965
> 
> 赞同：0
> 
> 时间：2012-07-16T16:57:41.500
> 
> 标签：c#, .net, sql-server-2008, ssis

我正在尝试在我的托管代码中实现自定义数据流组件。这是我的自定义数据流组件：

```
[DtsPipelineComponent(DisplayName = "RenameComponent", ComponentType = ComponentType.Transform)]
public class MapperComponent : PipelineComponent
{
    List<IDTSVirtualInputColumn100> dontMapList;

    public override void ProvideComponentProperties()
    {
        base.ProvideComponentProperties();

        base.RemoveAllInputsOutputsAndCustomProperties();
        IDTSInput100 input = ComponentMetaData.InputCollection.New();
        input.Name = "Input";

        IDTSOutput100 output = ComponentMetaData.OutputCollection.New();
        output.Name = "Output";
        output.SynchronousInputID = input.ID;

        // Make the output asynchronous
        output.SynchronousInputID = 0;
        FindOldColumns(input);
    }
} 
```

我编译它，将它注册到 gac，并将它保存到 C:\Program Files\Microsoft SQL Server\100\DTS\PipelineComponents 目录。

然后我运行以下代码将组件添加到我的数据流任务中：

```
private static IDTSComponentMetaData100 CreateRenameTransformation(MainPipe dataFlow, Train train)
    {
        IDTSComponentMetaData100 renameTransformation = dataFlow.ComponentMetaDataCollection.New();

        // Set stock properties
        renameTransformation.ComponentClassID = "Dexter.CustomComponents.MapperComponent";
        renameTransformation.Name = "RenameTransformation";
        renameTransformation.Description = "Rename and remove incompatible columns";

        CManagedComponentWrapper instance = renameTransformation.Instantiate();
        instance.ProvideComponentProperties();

        return renameTransformation as IDTSComponentMetaData100;
   } 
```

在运行时（当我尝试创建 pacakge 时），我收到以下错误：0xC0048021 -1073446879 DTS_E_ERRORCOMPONENT 组件丢失、未注册、不可升级或缺少所需的接口。此组件的联系信息是“%1”。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-15T12:49:32.150

我遇到了同样的问题“错误代码：0xC0048021”并解决了它。由于在数据流任务中添加了脚本组件，因此出现此问题。

我从这里安装了这个版本的 SSDT [https://msdn.microsoft.com/en-us/mt429383](https://msdn.microsoft.com/en-us/mt429383)

然后，在 SSDT 解决方案资源管理器中右键单击项目，转到属性 --> 配置属性 --> TargetServerVersion = SQL SERVER 2014

然后，在 SSDT 解决方案资源管理器中右键单击项目，转到属性 --> 配置属性 --> 调试 --> Run64BitRuntime = False

参考此链接[http://blogs.msdn.com/b/ssis/archive/2016/03/03/what-s-new-for-ssis-2016-rc0.aspx](http://blogs.msdn.com/b/ssis/archive/2016/03/03/what-s-new-for-ssis-2016-rc0.aspx)

# c# - 将联系方式打印到 PDF

> ID：11508969
> 
> 赞同：1
> 
> 时间：2012-07-16T16:57:53.113
> 
> 标签：c#, windows-phone-7

我需要获取一些联系方式并将其打印为 PDF。有没有办法在 Windows Phone 7 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-17T09:28:06.797

SharpPDF 项目有一个名为[PdfSharp for WP7](http://pdfsharpwp7.codeplex.com/)的分支。它指出它的功能不全。它可能/可能不会为您提供足够的功能来满足您的需求。我没有亲自查看该库，因此您可能希望下载它并查看它提供的功能。

除此之外，使用 C# 生成 PDF 文档的最常见方法之一是 iTextSharp。这很可能使用 .NET 框架中的高级功能，并且可能不会为 Windows Phone 重新编译。您可以编写自己的转换器服务，一旦完成，也可以通过电子邮件发送新创建的 PDF。该应用程序通常托管在某个地方（在服务器或云中），并且可以通过 WCF 访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-16T17:14:51.700

即使您在应用程序中创建 PDF，其他应用程序或您的计算机也无法访问它。解决方案是通过电子邮件发送该文件。因此，您应该将详细信息发送到服务器并将其转换为 PDF，然后将其下载到手机上，或者服务器可能会通过电子邮件将其发送给您。有许多 Web 服务可以为您做到这一点。看到这个： http: [//blog.nitropdf.com/2008/01/free-online-web-services-to-create-view-share-and-edit-pdf-files/](http://blog.nitropdf.com/2008/01/free-online-web-services-to-create-view-share-and-edit-pdf-files/)

# zend-framework - Symfony Zend Lucene 连接两个表

> ID：11508974
> 
> 赞同：0
> 
> 时间：2012-07-16T16:58:02.703
> 
> 标签：zend-framework, search, symfony1, lucene

我有 2 个带有外键的连接表。我想将这两个表中的字段索引到`Zend_Search_Lucene`搜索中。

```
//example:
table 1 users:
  username:
  email:
  ...other fields
table 2 Users info:
  users_id //Id from first table
  first_name
  last_name
  city 
```

我已经`Zend_Search_Lucene`在第一张桌子上，但我想搜索所有这些字段。

如何合并第一张和第二张表？

# java - 使用 JUnit 查询数据库的测试方法

> ID：11508975
> 
> 赞同：2
> 
> 时间：2012-07-16T16:58:03.780
> 
> 标签：java, unit-testing, testing, mocking

我应该如何对他们的意图是查询数据库并返回一些数据的方法进行单元测试？对于其他情况，我可以只模拟对象，但在这种情况下，我想测试它们是否返回正确的数据，我应该如何检查它与数据库的隔离？我应该使用某种特殊的数据库吗？但是，我应该如何配置该新数据库，使其与其他数据库一样使用所有这些列等？

谢谢。

更新：感谢大家，他们的回答使我走上了正确的道路。我终于用了debry。我刚刚为此添加了一个新的 persistence.xml。没有其他重大变化，它现在似乎正在工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:05:48.330

我成功使用的一种方法是使用：

1.  [Maven](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CGAQFjAA&url=http://maven.apache.org/&ei=-0gEUJzcJYHOhAfFioWUCA&usg=AFQjCNEOM94DrY-KbHD2ionSrXoOiwwnDg)来构建你的项目
2.  [Liquibase](http://www.liquibase.org/manual/maven)（或 Flyway）来管理您的数据库模式，并对其进行版本控制
3.  [H2](http://www.h2database.com/html/main.html)作为与您的测试一起启动的内存数据库。

如果您没有使用上述任何一种方法，那么在那里可以学到很多东西，但根据我的经验，这是非常值得的。这对 Spring 应用程序非常有效；对于其他设置，您的里程可能会有所不同。

在进行任何测试之前，Maven 应该在内存中启动一个 H2 数据库实例。在 Spring 应用程序中，您只需使用 H2 JDBC URL 指定数据源，它就会自动启动。

您可以使用 Liquibase 运行一组 XML 脚本来设置数据库模式，然后使用单独的文件来填充测试数据（通过在运行 Liquibase 时指定不同的文件，或者使用`context`每个文件的属性`changeSet`）。这可以使用 Maven 来完成，或者在 Spring 中使用特定的 Liquibase bean 来完成。

从那里您可以像测试普通应用程序一样测试您的应用程序。不需要嘲笑，结果你会得到更多有用的测试。您可能需要更改架构或以其他方式解决 H2 与您的本机 RDBMS 之间的 SQL 差异。

顺便说一句，我非常赞成这类测试。根据我的经验，模拟一切并不能真正让您获得任何有趣的见解，并且应该是无法进行内部构建集成测试时的最后手段。不过有很多不同意我的！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T17:18:20.443

您可以使用[DBUnit](http://www.dbunit.org/components.html#FlatXmlDataSet)。它采用您当前的模式，您可以轻松地模拟您的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-07-16T17:20:02.400

问题是你需要什么行为来进行单元测试？如果您模拟了数据库，那么您已经测试了所有重要的逻辑。您的数据库适配器将工作或不工作，您可以在针对真实数据库的集成/验收测试中进行验证。

# javascript - IE 的 document.GetElementById().files 等效于什么？

> ID：11508977
> 
> 赞同：0
> 
> 时间：2012-07-16T16:58:13.083
> 
> 标签：javascript, internet-explorer, getelementbyid

我目前正在构建一个文件上传页面，但它在 IE 中不起作用，因为 IE 不支持 getElementByID().files（或者我读过）有没有人知道在所有浏览器中都可以使用的等价物？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:01:19.073

IE 没有内置 API。您需要使用 Flash 等插件。

有一个[HTML 5 特性的 polyfills](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)列表，其中包括一些用于 File API 的。

# jquery-mobile - Jquery Mobile 需要一个下拉菜单来选择美国各州

> ID：11508981
> 
> 赞同：0
> 
> 时间：2012-07-16T16:58:29.260
> 
> 标签：jquery-mobile

我需要在我的 Jquery Mobile 应用程序中有一个下拉菜单，用户可以在其中选择美国各州。

对此使用的最佳控件是什么？

我正在考虑使用

```
 ListView 
```

但不确定是否为此目的有更好的控制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T17:35:10.230

您是否将 jquery-mobile 下拉列表也称为[selects](http://jquerymobile.com/demos/1.1.1/docs/forms/selects/)？（另请查看[自定义选择](http://jquerymobile.com/demos/1.1.1/docs/forms/selects/custom.html)页面）。

事实上，在我链接到的自定义选择的文档页面中（给出的示例是针对美国各州的下拉菜单。

# http - 一个简单的 Dart HTTP 服务器挂在 Apache Bench 上

> ID：11508982
> 
> 赞同：1
> 
> 时间：2012-07-16T16:58:30.400
> 
> 标签：http, dart, apachebench

我有这个[Google Dart](http://api.dartlang.org/io/HttpServer.html)测试程序：

```
#import('dart:io');

main() {
  var s = new HttpServer();

  s.defaultRequestHandler = (HttpRequest req, HttpResponse res) {
    res.statusCode = 200;
    res.contentLength = 4;
    res.outputStream.writeString("sup!!");
    res.outputStream.close();
  };

  s.listen('127.0.0.1', 80);
  print('its up!');
} 
```

它在 Chrome 和 Firefox 上运行良好，我收到了*sup*消息。

但是，一旦我尝试使用 Apache Bench，它就会挂起（`ab`挂起）：

```
Z:\www>ab -n 1 -c 1 "http://127.0.0.1/"
This is ApacheBench, Version 2.3 <$Revision: 655654 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking 127.0.0.1 (be patient)...apr_poll: The timeout specified has expired (70007) 
```

您可以`ab`通过安装 Apache HTTP 服务器找到它，它将位于该`bin`文件夹下。

附带说明：是否有其他一些类似于`ab`我可以使用（并且不会挂起）的基准测试工具？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-16T18:20:28.550

contentLength 可能有问题。您写了 4，但实际内容长度为 5。例如，如果 ab 看到 contentLength，它可能会读取 4 个字符并等待连接关闭。但是，连接可能不会关闭，因为服务器正在等待写入最后一个字符。客户端和服务器都在等待某些东西，导致死锁。

# oracle11g - 在 sama 表 oracle sql 或 pl/sql 中选择更新 -

> ID：11508983
> 
> 赞同：0
> 
> 时间：2012-07-16T16:58:30.470
> 
> 标签：oracle11g

我需要从 table_x 中选择 v_col1，并且该列给了我需要将（更新）放入相同 rowid 但放入 sama 表 table_x 中的不同列（h_col2）的字符串 - 抱歉，这看起来很容易，但我是初学者....

```
tabl_x 
rowid  V_col1,      h_col2     etc ..... 
1     672637263   GVRT1898
2     384738477   GVRT1876
3     263237863   GVRT1832 
```

就像在这个例子中我需要把 GVRT1898（更新）而不是 672637263 我需要进入这个 table_x 中的每一行并修复 - 就像下一行将是（rowid2 将是 GVRT1876 而不是 384738477 :-) 这个表有 40000 行像这样，我需要为每个 rowid 循环

谢谢你的回应贾斯汀 - 这有点复杂，

我在 h_col 中有这个字符串，只需要取出 GVRTnumber 并放入 v_col - 但这很难，因为 GVRTnumber 位于列中的不同位置，请参见此处....

"E_ID"=X:" **GVRT1878** ","RCode"=X:"156000","月"=d:1,"激活"=d:5,"Disp_Id"=X:"4673498","Tar"= X：“171758021”；

2"E_ID"=X:"561001760","RCode"=X:"156000","月"=d:1,"激活"=d:5,"Disp_Id"=X:" **GVRT1898** ","Tar" =X:"171758021";

h_col 列有我想要的这个数字，但在不同的地方，比如 somethimes，它在这个 600 字节的列中，它在字节 nr 156 中 - 有时在 287 中，但唯一唯一的是“GVRT ....”我怎么能把那个字符串放到v_col -

你能告诉我如何编写这样的 SQL pl/sql 吗？

问候和感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:05:38.177

听起来你只是想要

```
UPDATE tabl_x
   SET h_col2 = v_col1 
```

当然，如果您执行此类操作，则意味着应该删除两列之一，或者需要修复数据模型。如果没有别的，从规范化的角度来看，在每行中拥有相同数据的两个副本是一个坏主意。

# parallel-processing - 是否连续打印某些值会降低并行处理的性能

> ID：11508984
> 
> 赞同：0
> 
> 时间：2012-07-16T16:58:40.617
> 
> 标签：parallel-processing

我听说，连续 `Input/Ouput` 操作会降低并行处理的性能。我一直在不断地打印这些值，以便我可以检查通过了多少次迭代。它真的会影响过程的速度吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-16T17:02:01.537

是的，线程越多影响越大……如果您有 10 个线程一次生成 10,000 个数字，持续 30 秒的数字。它们都会生成然后等待 I/O 操作。您最好对每个附加线程进行计数，然后在最后显示它们。显示 I/O 没有磁盘 I/O 糟糕，但问题仍然存在。

例如：线程 1 进行了 30,000 次传递，线程 2 进行了 36,000 次传递，等等。

# garbage-collection - Racket 中的尾调用优化

> ID：11508987
> 
> 赞同：4
> 
> 时间：2012-07-16T16:58:45.643
> 
> 标签：garbage-collection, scheme, racket, tail-call-optimization

我在做 SICP[练习 2.28](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-15.html#%_thm_2.28)并偶然发现了以下代码的奇怪行为：

```
(define (fringe tree)
  (cond
    ((null? tree) '())
    ((not (pair? tree)) (list tree))
    (else (append (fringe (car tree)) (fringe (cdr tree))))))

(define (fringe-tail tree)
  (define (fringe-iter tree result)
    (cond
      ((null? tree) result)
      ((not (pair? tree)) (list tree))
      (else (fringe-iter (cdr tree) (append result (fringe-tail (car tree)))))))
  (fringe-iter tree '()))

(define x (make-list (expt 10 4) 4))
(time (fringe x))
(time (fringe-tail x)) 
```

普通`fringe`的运行速度比它的迭代版本快得多`fringe-tail`：

```
cpu time: 4 real time: 2 gc time: 0 
```

对比

```
cpu time: 1063 real time: 1071 gc time: 191 
```

它看起来像`fringe`被优化成循环并避免了任何分配，但`fringe-tail`运行速度要慢得多并且花费时间创建和销毁对象。

谁能给我解释一下？（以防我使用球拍 5.2.1）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-16T17:07:15.603

如果将最后一个子句替换为：

```
(else (fringe-iter (cdr tree) (append (fringe-tail (car tree)) result))) 
```

然后它们以相同的速度运行该输入，并且尾递归版本对于更大的输入更快。

问题是您`append`为 on 设置了更长的列表`cdr`到前面，它遍历和分配的内容比将 on 的边缘附加到前面的简单版本要多得多`car`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-07-17T20:56:40.580

给定的代码在非尾部位置有应用程序，因此该函数不是迭代的，尽管它的名称。:)

试试这个：

```
(define (fringe-tail tree)
  (define (iter tree k)
    (cond
      [(null? tree)
       (k '())]
      [(not (pair? tree)) 
       (k (list tree))]
      [else
       (iter (car tree)
             (lambda (v1)
               (iter (cdr tree)
                     (lambda (v2)
                       (k (append v1 v2))))))]))
  (iter tree (lambda (a-fringe) a-fringe))) 
```

但是，它仍然使用与第一个参数的长度一样昂贵的*append 。**边缘*和*边缘尾*的某些退化输入会导致大量计算问题。

让我们举一个这种退化输入的例子：

```
(define (build-evil-struct n)
  (if (= n 0)
      (list 0)
      (list (list (build-evil-struct (sub1 n)))
            (build-evil-struct (sub1 n))
            (list n))))

(define evil-struct (build-evil-struct 20)) 
```

当同时应用于*fringe*和*fringe-iter*时，您会看到非常糟糕的性能：我在自己的系统上观察到*fringe*和*fringe-tail*的计算时间只有几秒钟。这些测试在禁用调试的 DrRacket 下运行。如果您启用调试，您的数字将显着不同。

```
> (time (void (fringe evil-struct)))
cpu time: 2600 real time: 2602 gc time: 1212

> (time (void (fringe-tail evil-struct)))
cpu time: 4156 real time: 4155 gc time: 2740 
```

对于这两种情况，使用*append*使得它们容易受到某些退化输入的影响。*如果我们编写一个fringe*的累积版本，我们可以消除这个成本，因为我们可以使用恒定时间的*cons*操作：

```
(define (fringe/acc tree)
  (define (iter tree acc)
    (cond [(null? tree)
           acc]
          [(not (pair? tree))
           (cons tree acc)]
          [else
           (iter (car tree) (iter (cdr tree) acc))]))
  (iter tree '())) 
```

我们来看看 fringe/acc 在这个结构上的表现：

```
> (time (void (fringe/acc evil-struct)))
cpu time: 272 real time: 274 gc time: 92 
```

好多了！将这里的所有调用都转换为尾调用是一件简单的事情。

```
(define (fringe/acc/tail tree)
  (define (iter tree acc k)
    (cond [(null? tree)
           (k acc)]
          [(not (pair? tree))
           (k (cons tree acc))]
          [else
           (iter (cdr tree) acc
                 (lambda (v1)
                   (iter (car tree) v1 k)))]))
  (iter tree '() (lambda (v) v)))

> (time (void (fringe/acc/tail evil-struct)))
cpu time: 488 real time: 488 gc time: 280 
```

在这种特殊情况下，Racket 的堆栈实现比我们在延续中表示的具体堆栈快一点，因此*fringe/acc*比*fringe/acc/tail*快。尽管如此，这两者都比*fringe*好得多，因为它们避免了*append*。

[*话虽这么说：这个函数已经作为flatten*](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28lib._racket/list..rkt%29._flatten%29%29)函数内置在 Racket 中！因此，如果您不想重新发明轮子，不妨使用它。:)

# python - python中的字符串比较

> ID：11508988
> 
> 赞同：2
> 
> 时间：2012-07-16T16:58:45.587
> 
> 标签：python, string, string-comparison

我一直在使用 Python，但似乎无法通过字符串比较。我写了一个函数来接受用户输入并评估它。用户输入只能是“a”或“b”，否则会出错。我一直在使用这个：

```
def checkResponse(resp):
    #Make the incoming string trimmed & lowercase
    respRaw = resp.strip()
    respStr = respRaw.lower()
    #Make sure only a or b were chosen
    if respStr != "a" | respStr != "b":
        return False
    else:
        return True 
```

但是，当我输入`a`or时`b`，我收到：`TypeError: unsupported operand type(s) for |: 'str' and 'str'`

这是比较字符串的不正确方法吗？是否有内置函数可以像 Java 一样执行此操作？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-07-16T17:00:07.723

`|`是按位或运算符。你想要`or`。（你实际上想要`and`。）

你写了：

```
if respStr != "a" | respStr != "b": 
```

位运算符具有高优先级（类似于其他算术运算符），因此这相当于：

```
if respStr != ("a" | respStr) != "b": 
```

其中两个`!=`操作是[链式比较运算符](http://docs.python.org/reference/expressions.html#not-in)（`x != y != z`相当于`x != y and y != z`）。按位或应用于两个字符串是没有意义的。

你的意思是写：

```
if respStr != "a" and respStr != "b": 
```

您还可以使用链式运算符编写：

```
if "a" != respStr != "b": 
```

或者，使用包含运算符`in`：

```
if respStr not in ("a", "b"): 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-16T17:02:59.353

您想要的是`respStr != 'a' and respStr != 'b'`（`or`是布尔运算符，`|`按位运算符-但是，您需要`and`进行检查）。

但是，您可以以更好的方式编写条件，而无需重复变量名称：

```
return respStr in ('a', 'b') 
```

`True`如果 respStr 是`a`or`b`否则这将返回`False`。

# objective-c - UILocalizedIndexedCollat ion 不显示汉字

> ID：11508996
> 
> 赞同：2
> 
> 时间：2012-07-16T16:59:15.607
> 
> 标签：objective-c, ios, localization

在我的 iphone 应用程序中，我使用英语、西班牙语、俄语和中文本地化。本地化适用于所有本地化字符串。但是*UILocalizedIndexedCollat​​ion 不适*用于中文。当我将设备语言更改为英语、西班牙语和俄语时，表格索引显示正确。但是当我将设备语言设置为中文时，我得到的是英文的表索引，同时本地化的字符串本身就是中文的。

```
[[UILocalizedIndexedCollat​​ion currentCollat​​ion] sectionIndexTitles]
```

上面的代码为中文本地化返回一个英文字母数组，而它为其他三种语言（英语、西班牙语和俄语）返回正确的字符数组。

我正在使用以下 .lproj 文件进行本地化

1.  英语 - en.lproj
2.  西班牙语 - es.lproj
3.  俄语 - ru.lproj
4.  中文 - zh_Hans.lproj

谁能帮我找出问题所在。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-07-17T13:55:19.160

苹果[http://developer.apple.com/library/ios/#qa/qa1739/_index.html#//apple_ref/doc/uid/DTS40011151](http://developer.apple.com/library/ios/#qa/qa1739/_index.html#//apple_ref/doc/uid/DTS40011151)

> UILocalizedIndexedCollat​​ion 在运行时使用的本地化数据将基于您的应用程序包正在使用的本地化。如果您的应用程序仅支持英文，并且设备设置为使用繁体中文，则 UILocalizedIndexedCollat​​ion 将仅显示英文部分标题并将行排序到“A”到“Z”和“#”部分，即使 UILocalizedIndexedCollat​​ion 能够提供繁体中文中文节标题和将行数据排序到这些节中。
> 
> 为了解决这个问题，您的应用程序包必须正确声明对您希望 UILocalizedIndexedCollat​​ion 支持的语言的支持。您可以通过添加适当的 .lproj 文件夹或通过在应用程序的 info.plist 文件中的 CFBundleLocalizations 键中指定支持的本地化来将本地化添加到应用程序包中。请注意，首选前一种方法，因为如果将来需要将本地化资源添加到您的应用程序中，它更易于维护

# r - 如何有效地循环遍历三角矩阵

> ID：11508998
> 
> 赞同：4
> 
> 时间：2012-07-16T16:59:17.343
> 
> 标签：r, for-loop

我有一个三角矩阵，想有效地循环所有元素。有没有一种我根本看不到的聪明方法？

所以这是我的矩阵的一个小例子

```
 [,1] [,2] [,3] [,4]
  [1,]    1    0    0    0
  [2,]    2    1    0    0
  [3,]    3    7    1    0
  [4,]    4    4    10   1 
```

我想要做的是`f()`对该矩阵中位于主对角线下方（上方）的元素执行一些功能。（背景：我知道我有一个对称矩阵，想要执行一些耗时的数据操作，我想“镜像”我的矩阵）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-16T17:19:53.483

如下图所示，`lower.tri()`并`upper.tri()`提供了一种富有表现力（且快速）的方法，用于提取和替换相关扇区中的元素的矩阵。由于与索引操作相比，您应用于元素的函数可能很慢，因此搜索更快的索引选项（或试图避免单次调用`t()`）可能没有意义。

```
## Example data
m <- matrix(c(1,2,3,4,0,1,7,4,0,0,1,10,0,0,0,1), ncol=4)

## Example of a slow function
slowFun <- function(x) sapply(x, function(x) {Sys.sleep(0.1); x^2})

## Proposed strategy
m[lower.tri(m)] <- slowFun(m[lower.tri(m)])
m[upper.tri(m)] <- t(m)[upper.tri(m)] 
```