# StackOverflow 问答 000193000-000193999

# winapi - Capicom 3des：2键还是3键？

> ID：193002
> 
> 赞同：1
> 
> 时间：2008-10-10T21:01:31.557
> 
> 标签：winapi, encryption, capicom

大量搜索和阅读并没有告诉我`capicom.encrypteddata`类模块（它是 VB6，但这在回答这个问题时不重要）是使用 2-key 3DES 还是 3-key 3DES。( `.Algorithm.Name = CAPICOM_ENCRYPTION_ALGORITHM_3DES`) 有人知道它使用的是哪一个吗？此信息的来源也将有所帮助。我怀疑，因为我不认为支持足够高的密钥长度，所以它是 2DES。但我还没有找到可接受的确认。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-13T08:31:08.607

CAPICOM 是 CryptoAPI 之上的一个瘦包装器。如果您解码来自 EncryptedData.Encrypt() 的输出，您将看到类似这样的内容（它是以专有格式编码的 ASN.1）：

```
SEQUENCE {
  OBJECT IDENTIFIER '1 3 6 1 4 1 311 88 3'
  [0] {
    SEQUENCE {
      OBJECT IDENTIFIER '1 3 6 1 4 1 311 88 3 1'
      [0] {
        SEQUENCE {
          INTEGER 131073
          INTEGER 26115
          INTEGER 192
          OCTET STRING
            AA A6 05 4E FA AF 4C 0B
          OCTET STRING
            3A 22 58 C3 51 D8 91 C8 7B 3C C9 51 9B E7 BA B7
          OCTET STRING
            84 FA 56 AF 01 FE C9 74
          }
        }
      }
    }
  } 
```

注意 26115。这是 CALG_3DES 的值，它是具有三个密钥的 3DES 的 CryptoAPI 标识符（具有两个密钥的 3DES 称为 CALG_3DES_112）。192 是密钥长度，也匹配三密钥 3DES：

# wpf - WPF 比 winforms 更“华丽”吗？

> ID：193005
> 
> 赞同：1
> 
> 时间：2008-10-10T21:02:36.093
> 
> 标签：wpf, winforms

我刚刚安装了visio，安装程序几乎看起来像是内置在flash中的。当我将鼠标悬停在按钮上时，按钮有点发光，当我点击“继续”时，表单以一种很酷的方式逐渐消失。

我假设它是在 WPF 中构建的。

无论如何，WPF 也更像 Flash（从视觉上讲）。与 winforms 相比，它们是否具有新属性，您可以使表单更好/平滑地逐步淘汰？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-10T21:44:14.793

**免责声明**：我为微软工作。但是，我不在 Visio、WPF、CLR 或 Silverlight 团队工作。因此，以下是我个人对这些技术的看法。如果你想引用我的话，不要暗示这是微软的官方立场。:-))

**更新**：我在下面所说的关于 Flash/Flex/AIR 的任何内容都可能是错误的，因为我没有使用过这些技术，我对它们的了解是基于我在 intertubes 上阅读的内容。:-) 如果您发现任何错误，请在评论中大喊，我会纠正它。

据我所知，Visio 安装程序不是用 WPF 构建的。都是非托管代码；只是人们花了很多心思使它真正抛光。

WPF 是用于为 Windows 操作系统构建独立应用程序的新 UI 平台。它支持声明性 UI 语言 - XAML 和相关的 CLR 类型以进行编程。WPF 是与 WinForms 不同的平台，尽管可以构建混合使用两者构建的 UI 的应用程序。WPF 支持许多 WinForms 不支持的东西，例如位图效果、动画、控件样式等，并以 XAML 或通过代码公开它们。此外，与 WinForms 中的像素图形相反，WPF 严重依赖矢量图形。简而言之，WPF 非常强大，可以构建非常时髦的 UI。（不过，不要相信我的话，因为我有偏见；去看看人们对它的看法或与之建立的关系。:-)）

WPF 和 WinForms 不与 Flash/Flex 竞争。WPF 和 WinForms 都是用于构建独立客户端应用程序的 UI 框架。据我所知，Flash/Flex 是用于构建富互联网应用程序的框架 - RIA（尽管最近人们开始将此缩写解释为富交互应用程序）。

Adobe 在大约半年（或者可能是一年）前确实提出了 AIR，它允许构建独立的客户端应用程序，因此您可以说 Adob​​e 正试图将 Flash/Flex/AIR 定位为与 WPF 竞争。当然，这是我的看法，我怀疑 Adob​​e 的官方定位是这样的。

如果您想将特定的 MS 技术与 Flash/Flex 进行比较，请查看 Silverlight - 它是 MS RIA 平台。

Silverlight 与 WPF 相关，因为它们共享 XAML 和相应的 CLR 类型。不过，Silverlight 仅支持 WPF 提供的部分功能，因为它不仅仅针对 Windows 操作系统，因此受到它必须是可移植的事实的限制。

**快速更新以反映自我写下答案以来的一年中的变化:-)**

随着 Silverlight 3 的发布，SL 和 WPF 变得更加紧密，并共享更多受支持的功能。此外，大多数新的 XAML 控件同时是为平台构建的。因此，SL/WPF 正在达到一个奇点……

此外，SL 3 支持浏览器外应用程序。从这个意义上说，SL 不仅开始与 Flash/Flex 竞争，而且还在蚕食 AIR 的地盘。

不，我仍然不在 WPF 或 Silverlight 团队工作。:-)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T22:01:31.530

[WPF](http://en.wikipedia.org/wiki/Windows_Presentation_Foundation)正被用作[WinForms](http://en.wikipedia.org/wiki/Windows_Forms)的替代品，并作为[Silverlight](http://en.wikipedia.org/wiki/Silverlight)形式的 Flash 的竞争对手。WPF 包含一个全新的对象模型，它位于 DirectX（至少是桌面版本）之上。您可以完全使用 C# 或其他 .Net 语言创建 WPF 窗口、控件等，就像渲染 WinForms 一样。但是，微软还创建了一种称为[XAML的标记语言](http://en.wikipedia.org/wiki/XAML)（可扩展应用程序标记语言）。XAML 文档 (XML) 中的节点映射到对象的方式与 ASP.Net 映射到 Web 控件的方式类似。XAML 通常与代码隐藏样式的 C# 文件（或 VB.Net 或其他）一起存在于 .Net 项目中。C# 文件与 XAML 生成的对象交互。这与微软和其他公司正在推动的“图形通过标记，逻辑通过代码”模型相当一致。

讨论 WPF 时被忽视的功能之一是Microsoft 为 WPF 编写的***非常棒的数据绑定。***新的数据绑定框架是超越 Windows Forms 2.0 数据绑定的巨大飞跃。Microsoft 添加了几个新接口，使对象或集合更容易正确地发出数据绑定事件。他们还提供了一组非常丰富的数据绑定类。你可以将任何东西绑定到其他任何东西上。您可以将单向数据绑定到控件，将控件绑定到数据，将双向控件绑定到数据并返回，控件到控件等。

回到房子的图形方面，WPF 可以很容易地使现有控件看起来像任何东西。WP 允许您为一类按钮、一个按钮或所有按钮的外观编写自己的模板。或单选按钮。或标签。你明白我的意思。想象一下，如果 CSS 包含使用其他 HTML 控件定义输入按钮的外观的能力。

它们还提供了许多布局控件。您可以继续使用 WinForms 中的精确定位，或者您可以利用各种技术使您的窗口更像是一个随着调整大小等而增长和缩小的网页。

***缺点：*** 创建在较慢机器上爬行的壮观效果太容易了。一些图形没有利用图形卡的硬件，尽管 Microsoft 逐渐改进了对此的支持。我相信当 3.0 第一次出现时，阴影是纯粹使用软件渲染的。我认为 3.5 或 3.5 SP1 改变了它，以便 WPF 可以利用图形硬件来完成任务。微软表示他们将继续以这种方式增强 WPF。

WPF 是 .Net 3.0 及更高版本，可在 XP SP2、Vista 和 Servers 03 和 08 上运行。因此，不要计划将 WPF 部署到具有 Win2k 桌面的客户。

***摘要：***如果您在.Net 中进行桌面编程，那么您应该在WPF 中进行，除非您的目标是Win2k。您可以避免 WPF 的缺点，并且有很多优点。Microsoft 可能会在未来的某个版本中丢弃 WinForms，或者至少您将不再看到新功能等。

就 Silverlight 而言，SL 2.0 的测试版看起来不错。我认为 Silverlight 需要一些广泛的采用。微软已经尝试过实现这一目标。NBC Olypmics 网站使用 Silverlight，美国职业棒球大联盟将其用于其 MLB.tv 产品。一旦 Silverlight 获得良好的安装基础，我认为您将看到开发世界的 Microsoft 方面开始从 Flash 转向 Silverlight。

* * *

**使用 Silverlight 3 和 MVVM 后编辑：**

我已经离开 WPF 并且正在做很多 Silverlight 3 开发。但我认为我在这里的评论仍然适用于 WPF 开发人员。

我一直在我的应用程序中使用**[MVVM](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)**模式（想一想 MVC）。Microsoft 模式和实践团队发布了一组称为**[Prism](http://msdn.microsoft.com/en-us/library/cc707819.aspx)**的库，支持 MVVM 的各个方面。有 WPF 和 Silverlight 版本。如果您要进行 WPF 或 Silverlight 开发，请查看 MVVM 和 Prism。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T21:05:58.723

您可以使用 Winforms 或使用自定义组件来制作大量 Flash。但是，如果您想要开箱即用的一流可用性，那么 WPF 就是您的最佳选择。

是的，我认为其目的是像闪存一样，在我看来，MS 已经将目光投向了取消 Adob​​e。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-10T21:10:06.877

我的看法是：WPF 之于 Flash，就像 WinForms 之于 Flex。WPF 比编程更强调向量和状态。

# reverse-engineering - 逆向工程战争故事

> ID：193016
> 
> 赞同：44
> 
> 时间：2008-10-10T21:05:58.427
> 
> 标签：reverse-engineering

有时您没有源代码，需要对程序或黑盒进行逆向工程。有什么好玩的战争故事？

这是我的一个：

几年前，我需要重写一个我没有源代码的设备驱动程序。设备驱动运行在一台老式的CP/M微电脑上，通过串口驱动一台专用的照排机。我几乎没有关于照排机的文档。

我终于在一台模拟照排机响应的 DOS PC 上组装了一个串行端口监视器。当我通过 CP/M 机器输入数据时，我将 DOS PC 连接到 CP/M 机器并开始记录来自设备驱动程序的数据。这使我能够弄清楚设备驱动程序使用的握手和编码，并为 DOS 机器重新创建一个等效的。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-17T12:32:49.323

在此处阅读 C-64 的 FCopy 故事：

早在 80 年代，Commodore C-64 就有一个智能软盘驱动器 1541，即拥有自己的 CPU 和一切的外部单元。

C-64 将向驱动器发送命令，然后驱动器将自行执行它们，读取文件等，然后通过专用的串行电缆将数据发送到 C-64。

1541 的手册中提到，除了读取和写入文件的命令外，还可以读取和写入其内部存储空间。更令人兴奋的是，可以将 6502 代码下载到驱动器的内存中并在那里执行。

这让我着迷，我想玩它 - 在驱动器上执行代码。当然，*没有*关于可以在那里执行哪些代码以及可以使用哪些功能的文档。

我的一个朋友用 BASIC 编写了一个反汇编程序。所以我读出了它所有的 ROM 内容，即 16KB 的 6502 CPU 代码，并试图了解它的作用。驱动器上的操作系统非常了不起和先进的 IMO - 它有一种任务管理，命令从通信单元发送到磁盘 i/o 任务处理程序。

我学到了足够的知识来理解如何使用磁盘 i/o 命令来读/写磁盘的扇区。实际上，阅读了 Apple ][ 的 DOS 3.3 书籍，其中详细解释了其磁盘格式和算法的所有工作原理，对理解这一切有很大帮助。

（后来我了解到，我还可以在更多的 4032/4016 磁盘驱动器上找到用于“商业” Commodore 型号的预留信息，这些型号的工作原理与 1541 非常相似，但我无法将其作为当时相当断开的爱好程序员。）

最重要的是，我还了解了串行通信的工作原理。我意识到串行通信，使用 4 条线，两条用于数据，两条用于握手，编程效率非常低，全部在软件中（尽管使用经典的串行握手做得正确）。

因此，我设法编写了一个更快的通信程序，在其中我做了固定的时间假设，同时使用数据和握手线进行数据传输。

现在我能够读写扇区，并且传输数据的速度比以往任何时候都快。

当然，如果可以简单地将一些代码加载到驱动器中以加快通信速度，然后使用普通命令读取文件，这反过来会使用更快的通信，那就太好了。但是，这是不可能的，因为驱动器上的操作系统没有为此提供任何挂钩（请注意，所有操作系统都在 ROM 中，无法修改）。

因此，我想知道如何将我令人兴奋的发现变成有用的应用程序。

做了一段时间的程序员，一直在处理数据丢失的问题（当时磁带和软盘还不太现实），我想：备份！

所以我写了一个备份程序，它可以以前所未有的速度复制一张软盘：第一个版本只用了 8 分钟（是的，几分钟）就复制了整个 170 KB 的磁盘，第二个版本甚至用了大约 4.5 分钟。而我之前的应用程序花费了 25 分钟以上。（请注意，Apple ][，其磁盘操作系统直接在 Apple 上运行，具有快速并行数据访问功能，一分钟左右就完成了这一切）。

因此，C-64 的 FCopy 诞生了。

它很快变得非常流行。不是我想要的备份程序，而是任何想要为朋友复制游戏和其他软件的人的主要选择。

事实证明，我的代码中的简化，它会简单地跳过不可读的扇区，将具有错误 CRC 的扇区写入副本，确实绕过了当时使用的大多数复制保护方案，从而可以复制大多数以前无法复制的光盘。

我曾试图卖掉我的应用程序，实际上卖了 70 次。当它在杂志上刊登广告，声称它可以在不到 5 分钟的时间内复制一张光盘时，客户会打电话而不相信它，“更清楚”它无法完成，但还是试一试。

不久之后，其他人开始对*我的*应用程序进行逆向工程并对其进行优化，使通信速度更快，导致复制的应用程序甚至在 1.5 分钟内就完成了。更快几乎是不可能的，因为由于 1541 和 C-64 上可用的内存量有限，您必须在单个磁盘驱动器中多次交换磁盘才能复制其全部 170 KB 的内容。

最后，FCopy 及其优化的后续产品可能是 80 年代 C-64 上最受欢迎的软件。即使它没有为我带来经济上的回报，它仍然让我感到自豪，我学到了很多关于逆向工程、复制保护的徒劳以及明星的感觉。（实际上，加拿大一家 C-64 杂志的编辑 Jim Butterfield 向读者讲述了我的故事，很快他就收到了一张约 1000 加元的支票给我——这是该杂志从许多发送 5 美元支票的感激用户那里收集的，这在当时对我来说是一大笔钱。）

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2008-12-17T13:20:39.710

其实我还有一个故事：

在我的 FCopy “成功”故事过去几年，有人问我是否可以破解老虎机的软件。

这是在德国，几乎每个酒吧都有一两个这样的：你会投入一些相当于美国四分之一的钱，然后它会旋转三个轮子，如果你运气好的话，你会然后可以选择在下一场比赛中将您的胜利“加倍或不加倍”，或者获得当前的胜利。该游戏的目标是尝试将您的胜利翻倍，直到您进入“系列”模式，在这种模式下，任何成功的胜利，无论多么小，都会让您获得大笔报酬（大约是您每次花费的 10 倍）游戏）。

困难在于知道什么时候加倍，什么时候不加倍。当然，对于“局外人”来说，这完全是随机的。但事实证明，这些德国制造的机器在其 ROM 中使用简单的伪随机表。现在，如果你观察机器玩了几轮，你就可以弄清楚这个“随机表指针”在哪里，并预测它的下一步动作。这样，球员就会知道何时加倍以及何时传球，最终将他带入“大赢系列”。

现在，当这个人接近我时，这已经是一件很平常的事情了。有一个地下场景可以访问这些机器中的 ROM，找到表格并为 C-64 等计算机创建软件，用于预测机器的下一步动作。

然而，随后出现了一种新型机器，它使用了不同的算法：它没有使用预先计算好的表格，而是做了其他事情，没有一个常驻破解者可以弄清楚这一点。所以我被找上了，自从我的 FCopy 成名以来，我就被认为是一种天才。

所以我得到了ROM。16KB，像往常一样。没有关于它做了什么以及它是如何工作的信息。我独自一人。甚至代码看起来也不熟悉（那时我只知道 6502 和 8080）。经过一番挖掘和询问，我发现它是一个 6809（我发现它是现有的最好的 8 位 CPU，它与 680x0 CPU 设计类似，比 x86 系列的指令混乱更线性）。

到那时，我已经有一台 68000 计算机（我曾在“Gepard Computer”公司工作，该公司制造并销售了这样一台机器，拥有自己的开发人员操作系统等等）并且正在编程 Modula-2。所以我为 6809 编写了一个反汇编程序，它通过查找子程序、跳转等帮助我进行逆向工程。慢慢地，我对老虎机程序的流程控制有了一个概念。最终我发现了一些看起来像数学算法的代码，我突然意识到这可能是随机生成的代码。

由于我从未接受过计算机科学方面的正规教育，直到那时我都不知道使用 mul、add 和 mod 的典型随机数是如何工作的。但我记得我在 Modula-2 的书中看到过一些东西，然后才意识到它是什么。

现在我可以快速找到调用这个 randomgen 的代码，并了解哪些“事件”导致了 randomgen 迭代，这意味着我知道如何在游戏中预测下一次迭代及其值。

剩下的就是找出randomgen的当前位置。我从来不擅长代数等抽象事物。不过，我认识一个学习数学并且也是程序员的人。当我打电话给他时，他很快就知道如何解决这个问题，并且对确定随机数的种子值有多简单提出了很多质疑。我什么都不明白。好吧，我明白一件事：完成此操作的代码将花费大量时间，而 C-64 或任何其他 8 位计算机将需要数小时甚至数天才能完成。

因此，如果他能在 68000 中为我编写汇编程序，我决定给他 1000 DM（当时这对我来说是很多钱）。没用多久，我就有了可以在 68000 上测试的代码计算机。通常需要 5 到 8 分钟，这是可以接受的。所以我几乎到了。

它仍然需要一台便携式 68000 电脑才能被带到老虎机所在的酒吧。我的 Gepard 电脑显然不是便携式的。幸运的是，我在德国认识的其他人在一块小电路板上生产了整整 68000 台计算机。对于 I/O，它只有串行通信 (RS-232) 和一个并行端口（Centronics 是当时的标准）。我可以将一些 9V 块电池连接到它以使其工作。然后我买了一台夏普袖珍电脑，它有一个橡胶键盘和一个单行 32 字符显示屏。依靠电池运行，这是我的终端。它有一个 RS-232 连接器，我连接到 68000 板。夏普也有某种非易失性存储器，这让我可以将 68000 随机破解软件存储在夏普上，按需传输到 68000 计算机，然后计算种子值。最后，我有一台小型 Centronics 打印机，它打印在狭窄的热敏纸上（这是收银机用来打印收据的大小）。因此，一旦 68000 得到结果，它就会将老虎机上即将进行的游戏的一排结果发送给夏普，夏普将它们打印在纸上。

所以，要清空其中一台老虎机，你需要和两个人一起工作：你开始玩，写下它的结果，一个你有种子计算所需的最少游戏数量，一个你会去停着的车在外面，打开夏普，输入结果，68000电脑会响8分钟，然后出来一张打印的即将运行的游戏列表。然后你只需要这张小纸，把它带回给你的伙伴，他一直在忙着机器，将过去的结果与打印输出对齐，不到 2 分钟后，你就“惊讶”地赢得了历史上的 100 分系列。然后你会玩这 100 场比赛，实际上是清空机器（如果在 100 场比赛之前机器是空的，你有权等待它重新填充，甚至可能在第二天回来，

这不是拉斯维加斯，所以你只能从一台机器上得到大约 400 马克，但这是快速而可靠的钱，而且令人兴奋。一些酒吧老板怀疑我们作弊，但由于当时的法律，我们并没有反对我们，甚至当有些人报警时，警察也支持我们）。

当然，老虎机制造公司很快就知道了这一点，并试图抵消，关闭那些特定的机器，直到安装新的 ROM。但前几次他们只改变了随机数的数字。我们只需要拿到新的 ROM，我花了几分钟才找到新的数字并将它们应用到我的软件中。

所以这持续了一段时间，在此期间，我和朋友们浏览了德国几个城镇的酒吧，寻找那些只有我们才能破解的机器。

不过最终，机器制造商学会了如何“修复”它：在此之前，randomgen 仅在某些可预测的时间被推进，例如在游戏过程中大约 4 次，并且每次玩家按下“double or nothing”时再一次按钮。

但后来他们最终改变了它，以便不断地轮询 randomgen，这意味着我们不再能够准确地预测下一个种子值，以便按下按钮。

就这样结束了。尽管如此，还是为了这个单一的破解而努力编写反汇编程序，在 16KB 的 8 位 CPU 代码中找到关键例程，找出未知的算法，投入大量资金付钱给别人开发我不明白的代码，找到一台便携式高速计算机的项目，包括以夏普作为终端的“盲”68000 CPU 和方便输出的打印机，然后自己实际清空机器，这是我做过的最令人兴奋的事情之一用我的编程技巧。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-17T11:42:10.013

早在 90 年代初，我就忘记了 Compuserve 密码。我在CIS.INI中有加密版本，所以我写了一个小程序来进行明文攻击和分析，试图对加密算法进行逆向工程。24 小时后，我弄清楚了它是如何工作的以及我的密码是什么。

此后不久，我进行了清理并将程序作为免费软件发布，以便 Compuserve 客户可以恢复丢失的密码。公司的支持人员会经常将这些人推荐给我的计划。

它最终出现在了一些公告板（还记得吗？）和互联网论坛上，并被收录在一本关于 Compuserve 的德国书籍中。它仍然漂浮在外面的某个地方。事实上，谷歌[直接把我带到了它。](http://community.compuserve.com/n/pfx/forum.aspx?msg=136623.1&nav=messages&webtag=ws-winshare)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2008-10-10T21:28:28.117

有一次，在玩 Daggerfall II 时，我买不起 Daedric Dai-Katana，所以我对存档游戏进行了十六进制编辑。

不过说真的，我设法在多年前使用 SoftICE 删除了我父亲 AutoCAD 安装中的加密狗检查。这是在互联网大之前。他是一名工程师，所以他有一个合法的副本。他刚刚忘记了工作中的加密狗，他需要做一些事情，我认为这将是一个有趣的挑战。后来我很自豪。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2011-07-17T01:20:53.777

好吧，这不是逆向工程（相当），而是纯粹出于挫败感而产生的简单硬件破解。90 年代初，我是西南贝尔手机服务地区的一名 IT 经理。我的 IT 部门资金严重不足，所以我们把钱花在聪明人身上，而不是设备上。

我们在主要城市之间有一个 WAN，专门用于客户服务，具有关键的 IP 链接。我们的公司老板坚持要我们安装一个网络监控系统，以便在线路出现故障时通知我们（没有钱用于冗余，但要花钱处理故障。唉。）

强烈推荐的解决方案在 SPARC 工作站上运行，起价为 3 万美元加上一个 SPARC 工作站的成本（当时约为 2 万美元），这在我的预算中占了很大一部分。我看不到它-这是浪费$$。所以我决定进行一些黑客攻击。

我拿了一台计划销毁的旧 PC 并放了一份 ProComm 的副本（还记得 ProComm 吗？），让它 ping 路线上的每个所需节点（这是 ProComm 的较新版本之一，它编写了 FTP 和串行线路的脚本， KERMIT 等）当无法到达节点时，编码中的一个小逻辑会触发寻呼机消息。我已经用它为我们的技术人员拼凑了一个寻呼机系统，所以我重用了寻呼机代码。该脚本连续运行，每分钟在每个关键链接上发送一次 ping，并在未返回 ping 时分支到寻呼机代码。

我们以不到 500 美元的成本在每个关键位置复制了这个系统，并且在链接出现故障时能够非常快速地发出通知。下一个问题 - 我们的第一个故障排除方法之一是重启我们的路由器和/或终端服务器。我有一些拨号 X10 控制器和一些 X10 开/关设备电源开关。您必须知道要使用的正确电话号码和要推送的正确音调，但我们为每位技术人员打印了一张作弊卡，他们将其保存在寻呼机中。即时快速响应！然后，我的一位技术人员将我们都必须在每个站点重置特定设备的电话编程为快速拨号。一项技术解决问题！

现在“告诉你”揭幕。

我正与我们在达拉斯的公司网络经理共进午餐，他坚持要购买基于 Sun 的网络管理产品。我得到一个页面，其中一个链接已关闭，然后是第二个页面。由于寻呼机消息来自两个不同的服务器，我确切地知道涉及哪个路由器（这是一个设置，无论如何我都知道，因为与我会面的技术人员在用餐期间排队等待“关闭路由器”所以我们可以炫耀。）我向经理展示寻呼机消息，并询问他将采取什么措施来解决这个问题。他怀疑地看着我，因为他的 Solaris NMS 系统尚未成功寻呼他，该系统应该跟踪关键链接。“好吧，我想你最好打电话给技术人员，让他们重置路由器，看看是否能解决问题。” 我转向与我们共进午餐的技术人员，请他处理。他拿出手机（这次是在桌子上方），按下他为重置相关路由器而设置的快速拨号。手机拨通X10开关，让其关闭路由器电源，暂停五秒，让其开启路由器电源，然后断开连接。我们的 ProComm 脚本向我们发送了页面，告诉我们链接已在此例程的三分钟内备份。:-) 我们的 ProComm 脚本向我们发送了页面，告诉我们链接已在此例程的三分钟内备份。:-) 我们的 ProComm 脚本向我们发送了页面，告诉我们链接已在此例程的三分钟内备份。:-)

公司网络经理印象深刻。他问我新系统的成本是多少。当我告诉他不到 1000 美元时，他中风了。他刚刚订购了一套 BIG 的 Sun Solaris 网络管理解决方案，只是为了完成我所说明的任务。我想他花了大约 15 万美元。我告诉他魔法是如何做到的，并以午餐的价格为他提供了 ProComm 脚本。坦斯塔夫。他告诉我他会请我吃午饭让我闭嘴。

清理我旧的磁盘抽屉等，我找到了代码的副本——“Pingasaurus Rex”是我给它起的名字。在过去的好日子里，那是黑客行为。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-10T21:19:25.017

对我来说最痛苦的是这个产品，我们想在 Excel 电子表格中包含一个图像（几年前开放标准）。因此，如果文档的内部格式也存在这种情况，我必须得到并“理解”。我最终在有和没有图像的文件之间进行了一些十六进制比较，以弄清楚如何把它放在那里，再加上一些小端数学......

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-10-10T21:20:24.513

我曾经开发过一种工具，可以在登录网络时从 PC 收集库存信息。这个想法是跟踪公司中的所有 PC。

我们有一个新的需求来支持 Banyan VINES 网络系统，它现在早已被遗忘，但在它问世时非常酷。我不知道如何从 Banyan 的适配器获取以太网 MAC 地址，因为没有记录的 API 可以做到这一点。

在网上四处搜索，我发现了一个其他 Banyan 书呆子发布的程序，它执行了这个确切的操作。（我认为它会将 MAC 地址存储在环境变量中，以便您可以在脚本中使用它）。我试图写信给作者以了解他的程序是如何工作的，但他要么不想告诉我，要么想要一些荒谬的钱来获取信息（我不记得了）。

所以我只是启动了一个反汇编程序并将他的实用程序拆开。原来他正在对服务器进行*一次*简单的调用，这是 Banyan API 中未记录的函数代码。我很容易地计算出调用的细节，它基本上是通过 RPC 向服务器询问这个工作站地址，而 MAC 是 Banyan 网络地址的一部分。

然后我简单地给 Banyan 的工程师发了电子邮件，告诉他们我需要做什么。“嘿，似乎 RPC 函数编号 528（或其他）返回了我需要的内容。这样调用安全吗？”

Banyan 的工程师很酷，他们验证了我找到的功能是正确的，并且不太可能消失。我编写了自己的新代码来调用它，然后我就开始运行了。

多年后，我使用了基本相同的技术，在另外记录的文件格式上对未记录的压缩方案进行了逆向工程。我找到了一个鲜为人知的支持工具，由（现已不复存在的）公司提供，它可以解压缩这些文件，并对其进行逆向工程。事实证明，这是一个非常简单的 Lempel-Ziv 变体，应用于其文件格式的块结构中。那项工作的成果记录在[Wireshark 源代码](http://www.wireshark.org/develop.html)中供后人参考，只要搜索我的名字。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2011-07-17T14:12:07.743

大约 10 年前，我在当地一家书店的便宜货箱里买了 UFO/XCOM 典藏版，主要是出于怀旧之情。当我回到家时，我对它被移植到 Windows 感到有点兴奋（DOS 版本不能在 win2k 下运行）......然后又对它出现乱码感到失望。

我正要耸耸肩（讨价还价的垃圾箱和所有），但后来我的朋友说“你以前没有……修复过……软件吗？”这导致一夜喝了很多可乐和逆向工程和我的朋友出去玩的时候。最后，我编写了一个修复了间距与宽度问题的错误修复加载程序，终于可以在不启动旧硬件的情况下玩前两个 XCOM 游戏（DOSBOX 还没有出现，而且我的机器还不够强大全面的虚拟化）。

加载程序获得了一定的欢迎，甚至在一段时间内随着游戏的 STEAM 重新发布 - 我认为他们现在已经切换到 dosbox，不过。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-11T08:24:56.817

我为支持 Wacom 平板电脑的 Atari ST 编写了一个驱动程序。Wacom 的一些信息可以在他们的网站上找到，但我仍然需要自己弄清楚很多。

然后，一旦我编写了一个库来访问 wacom 表（和一个测试应用程序来显示结果），我突然意识到操作系统（GEM 窗口系统）没有 API 可以将鼠标光标实际放置在某个地方。我最终不得不在称为 VDI 的东西（如 Windows 中的 GDI）中挂钩一些中断，并且非常小心不要让里面的计算机崩溃。我从 VDI 加速版本 (NVDI) 的开发人员那里得到了一些帮助（以建议的形式），一切都是用 PurePascal 编写的。我仍然偶尔有人问我如何在 GEM 中移动鼠标光标等。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2011-07-17T13:00:25.323

When I was in highschool they introduced special hours each week (there were 3 hours if i recall correctly) in which we had to pick a classroom with a teacher there to help with any questions on their subject. No of course everybody always wanted to spend their time in the computer room to play around on the computers there.

To choose the room where you would have to be there was an application that would monitor how many students would go to a certain room, and so you had to reserve your slot on time or otherwise there was not much choice where to go.

At that time I always liked to play around on the computers there and I had obtained administrator access already, only for this application that would not help me so much. So I used my administrator access to make a copy of the application and take it home to examine. Now I don't remember all the details but I discoverd this application used some access database file located on a hidden network share. Then after taking a copy of this database file I found there was a password on the database. Using some linux access database tools I could easily work around that and after that it was easy to import this database in my own mysql server. Then though a simple web interface I could find details for every student in the school to change their slots and promote myself to sit in my room of choice every time.

The next step was to write my own application that would allow me to just select a student from the list and change anything without having to look up their password which was implemented in only a few hours.

While not such a very impressive story as some others in this thread, I still remember it was a lot of fun to do for a highschool child back then.

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-10T21:23:22.543

我不得不对一个视频处理应用程序进行逆向工程，而我只有部分源代码。我花了数周甚至数周的时间才算出控制流，因为它一直使用 CORBA 来调用自己，或者在我无法访问的应用程序的某些部分从 CORBA 调用。

纯粹的白痴。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-10T21:44:12.003

我最近编写了一个应用程序，它使用 Curl 从 Domino Webmail 服务器下载全部内容。这是因为运行服务器的分包商要求为每个归档请求支付几百美元。

在我为部门发布应用程序大约一周后，他们更改了他们的 webmail 版本，但设法使用大量的正则表达式和 XML 使其再次工作

# perl - 如何使用 Perl 模块中的常量？

> ID：193020
> 
> 赞同：43
> 
> 时间：2008-10-10T21:06:54.433
> 
> 标签：perl, module, export, constants

如果我在 Perl 模块中定义一个常量，我如何在我的主程序中使用该常量？（或者我如何在主程序中调用该常量？）

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-10-10T21:10:39.090

常量可以像其他包符号一样导出。使用标准的[Exporter](http://search.cpan.org/~ferreira/Exporter-5.63/lib/Exporter.pm)模块，您可以从包中导出常量，如下所示：

```
package Foo;
use strict;
use warnings;

use base 'Exporter';

use constant CONST => 42;

our @EXPORT_OK = ('CONST');

1; 
```

然后，在客户端脚本（或其他模块）中

```
use Foo 'CONST';
print CONST; 
```

您可以使用`%EXPORT_TAGS`散列（参见 Exporter 文档）来定义可以使用单个导入参数导出的常量组。

`%EXPORT_TAGS`更新：如果您有多个常量，这是一个如何使用该功能的示例。

```
use constant LARRY => 42;
use constant CURLY => 43;
use constant MOE   => 44;

our @EXPORT_OK = ('LARRY', 'CURLY', 'MOE');
our %EXPORT_TAGS = ( stooges => [ 'LARRY', 'CURLY', 'MOE' ] ); 
```

然后你可以说

```
use Foo ':stooges';
print "$_\n" for LARRY, CURLY, MOE; 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-10T21:11:36.670

常量只是具有空原型的子，因此它们可以像任何其他子一样导出。

```
# file Foo.pm
package Foo;
use constant BAR => 123;
use Exporter qw(import);
our @EXPORT_OK = qw(BAR);

# file main.pl:
use Foo qw(BAR);
print BAR; 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-10-10T21:21:01.160

为了扩展之前的答案，由于常量实际上只是子类，您也可以*直接*调用它们：

```
use Foo;
print Foo::BAR; 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-11T10:22:16.120

您可能需要考虑使用[Readonly](http://search.cpan.org/~roode/Readonly-1.03/Readonly.pm)而不是常量。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-10-12T20:04:02.170

```
package Foo;
use Readonly;
Readonly my  $C1 => 'const1';
Readonly our $C2 => 'const2';
sub get_c1 { return $C1 }
1;

perl -MFoo -e 'print "$_\n" for Foo->get_c1, $Foo::C2' 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-18T09:07:56.143

To add to the bag of tricks, since a constant is just a subroutine you can even call it as a class method.

```
package Foo;
use constant PI => 3.14;

print Foo->PI; 
```

If you have lots of constants it's a nice way to get at the occasional one without having to export them all. However, unlike `Foo::PI` or exporting `PI`, Perl will not compile out `Foo->PI` so you incur the cost of a method call (which probably doesn't matter).

# asp.net - 通过代码 ASP.NET 设置 ContentPlaceHolder 数据

> ID：193039
> 
> 赞同：5
> 
> 时间：2008-10-10T21:12:41.770
> 
> 标签：asp.net, contentplaceholder

是否可以通过代码在 ContentPlaceHolder 中设置数据？这就是我的想法：

```
dim oCPH as new ContentPlaceHolder
oCPH.id = "column1" 'this id is the one that corresponds with the ID I set on the page
oCPH.content = "content here" '<-- not real code 
```

显然这不是正确的语法，我希望这能澄清我的要求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T21:20:53.233

您应该能够通过当前页面上的 MasterPage 元素引用它。就像是：

```
ContentPlaceHolder cph = (ContentPlaceHolder)Master.FindControl("column1"); 
```

如果在 MasterPage 代码隐藏中，只需按名称引用它。

# php - PHP 是否有可以在代码中使用的 DEBUG 符号？

> ID：193044
> 
> 赞同：5
> 
> 时间：2008-10-10T21:13:43.060
> 
> 标签：php, debugging

像 C 甚至 C#（在技术上没有预处理器）这样的语言允许您编写如下代码：

```
#DEFINE DEBUG
...

string returnedStr = this.SomeFoo();
#if DEBUG
    Debug.WriteLine("returned string =" + returnedStr);
#endif 
```

这是我喜欢在我的代码中用作一种脚手架形式的东西，我想知道 PHP 是否有这样的东西。我确信我可以用变量来模拟它，但我想在大多数情况下解释 PHP 的事实并不容易在执行时自动剥离/删除调试代码（因为它不需要）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T21:23:46.770

PHP没有这样的东西。但是您绝对可以快速做出一些事情（如果您愿意，也许可以使用正则表达式解析将其删除）。我会这样做：

```
define('DEBUG', true);
...
if (DEBUG):
  $debug->writeLine("stuff");
endif; 
```

当然，您必须编写自己的调试模块来处理所有这些。如果您想让正则表达式解析更轻松，也许您可​​以使用三元运算符：

```
$str = 'string';
DEBUG ? $debug->writeLine("stuff is ".$str) : null; 
```

这将使删除调试行变得非常简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T21:32:55.940

xdump 是我个人最喜欢的调试工具之一。

[http://freshmeat.net/projects/xdump/](http://freshmeat.net/projects/xdump/)

```
define(DEBUG, true);

[...]

if(DEBUG) echo xdump::dump($debugOut); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T21:32:17.300

它有一个`define`功能，记录在这里：[http](http://us.php.net/manual/en/language.constants.php) ://us.php.net/manual/en/language.constants.php 。

鉴于文档中解释的变量和常量之间的差异集，我假设 PHP`define`允许解释器在编译时消除不可用的代码路径，但这只是一个猜测。

——道格拉斯·亨特

# database - Web 服务和数据库并发

> ID：193047
> 
> 赞同：0
> 
> 时间：2008-10-10T21:14:11.297
> 
> 标签：database, web-services, concurrency

我正在构建一个 .NET 客户端应用程序（C#、WinForms），它使用 Web 服务与数据库进行交互。客户端将使用 WAN 或 VPN 从远程位置运行，因此使用 Web 服务而不是直接访问数据库的想法。

我现在正在努力解决的问题是如何处理数据库并发。即如果两个不同位置的人更新了相同的数据，我该如何处理呢？我正在考虑在每个数据库记录上使用时间戳并将其作为更新 where 子句的一部分，但这意味着时间戳必须通过 Web 服务接口来回移动，这看起来有点难看。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T21:25:27.623

我认为您不希望您的 Web 服务直接与数据库对话。您可能希望您的服务与某种类型的业务组件交互，这些组件又与数据访问层交互。任何并发异常都可以从 DAL 传递到可以处理它们的业务层，这样 Web 服务就不必查看时间戳。

但是，如果您将数据表之类的内容传递给客户端，并且想要避免时间戳，则可以通过逐个字段比较来进行并发检查。如果您要求乐观并发检查，默认情况下，表适配器向导会生成这种类型的并发检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T22:39:47.570

如果您的冲突很少发生以至于可以手动解决，一个简单的解决方案是添加一个更新触发器，将行的更新前值复制到审计表中。这样，最近的写入是“赢家”，但不会因覆盖而丢失任何数据，管理员可以恢复较早的行状态，甚至将它们组合起来。

这种技术有其缺点，在频繁覆盖的情况下不是一个很好的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T22:43:55.733

此外，这有点离题，但使用 Web 服务不一定是要走的路，因为客户端将远程连接到网络中。ASP.NET Web 服务是基于 XML 的并且非常冗长。如果您的客户端应用程序可以指望始终保持连接，那么您最好不要使用 Web 服务。

# macos - Mac OS X/Linux 中是否有 RawInput 的替代品

> ID：193073
> 
> 赞同：1
> 
> 时间：2008-10-10T21:24:14.897
> 
> 标签：macos

我正在开发一个在连接了多个 USB 键盘的机器上运行的应用程序。偶尔会添加或删除键盘。每次按下一个键时，应用程序都需要找出按下了哪个键，以及使用了哪个键盘。

我有一个在 Windows 下使用 RawInput 的应用程序的工作版本。但是，如果您添加或删除一个集线器或两个完整的键盘，Windows 可能需要一段时间才能弄清楚发生了什么，我也在寻找是否可以在不同的操作系统上更强大地实现相同的目标。

如果可能的话，Mac OS X/Cocoa 将是第二选择，但如果你能提出一种方法，我愿意接受对任何其他平台（如 linux）的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-12T08:57:32.877

在 Mac OS X 上，您可以使用[HID 管理器](http://developer.apple.com/technotes/tn2007/tn2187.html "Leopard 中的 HID 管理器")直接查看哪些 HID 元素在哪些设备上被驱动。

这不仅适用于键盘，还适用于所有 HID 设备——鼠标、游戏手柄等——当然，您可以将代码关注的内容限制在特定设备或特定类别的设备上。

一般来说，您需要熟悉 USB 设备匹配和 USB 人机接口设备通信的概念，但如果您熟悉，那么在 Mac OS X Leopard (10.5 ）。

# database - 是什么减慢了不断增长的数据库性能？

> ID：193076
> 
> 赞同：5
> 
> 时间：2008-10-10T21:25:52.820
> 
> 标签：database, batch-file, insert, scalability

我正在创建一个数据库，并首先进行原型设计和基准测试。我正在使用 H2，一个开源的、商业免费的、可嵌入的、关系型的 Java 数据库。我目前没有对任何列进行索引。

数据库增长到 5GB 左右后，它的批量写入速度翻了一番（写入速度减慢了原来的 2 倍）。我每毫秒用一个新的、干净的数据库写大约 25 行，现在我写了 7GB 大约 7 行/毫秒。我的行由一个 short、一个 int、一个 float 和一个 byte[5] 组成。

我不太了解数据库内部结构，甚至对 H2 的编程方式也不太了解。我还想指出，我并不是在说 H2，因为这是我测试过的其他 DBMS 的问题。

如果没有索引开销，哪些因素可能会减慢这样的数据库速度？它主要与文件系统结构有关吗？根据我的结果，我假设 Windows XP 和 ntfs 处理文件的方式使得随着文件的增长将数据附加到文件末尾的速度变慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T16:26:40.020

这听起来很对。数据库性能通常会显着下降，因为数据不能再保存在内存中并且操作变得受磁盘限制。如果您使用普通的插入操作，并且想要显着提高性能，我建议在 H2 支持的情况下使用某种批量加载 API（如 Oracle sqlldr、Sybase BCP、Mysql 'load data infile'）。这种类型的 API 绕过许多数据库子系统将数据直接写入数据文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T22:15:24.013

随着数据库的增长，插入变得复杂的一个因素是表上的索引数量，以及这些索引的深度（如果它们是 B 树或类似的）。有更多工作要做，可能是您导致索引节点分裂，或者您可能只是从 5 级 B 树移动到 6 级 B 树（或更一般地说，从 N 到 N+1 级）。

另一个因素可能是磁盘空间的使用——如果您使用的是熟文件（大多数时候这是大多数人的正常类型；一些 DBMS 在 Unix 上使用“原始文件”，但您的嵌入式系统不太可能这样做，并且您会知道它是否这样做，因为您必须告诉它这样做），可能是您的较大表现在在磁盘上分散，导致性能下降。

如果问题出在 SELECT 性能上，那么可能还有许多其他因素也会影响系统的性能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T21:34:21.053

这很可能是由可变宽度字段引起的。我不知道 H2 是否允许这样做，但是在 MySQL 中，您必须创建具有所有固定宽度字段的表，然后将其显式声明为固定宽度字段表。这允许 MySQL 准确计算它需要在数据库文件中执行插入的位置。如果您不使用固定宽度的表格，则必须通读表格以找到最后一行的末尾。

追加数据（如果操作正确）是一个 O(n) 操作，其中 n 是要写入的数据的长度。它不依赖于文件长度，有查找操作可以轻松跳过。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T21:47:24.990

对于大多数数据库，追加到数据库文件肯定比预先增长文件然后添加行要慢。查看 H2 是否支持预增长文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T22:00:00.567

许多数据库引擎为每次更新创建一个隐式整数主键，因此即使您没有声明任何索引，您的表仍然会被索引。这可能是一个因素。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T21:42:43.440

另一个原因是整个数据库是否保存在内存中，或者操作系统是否必须进行大量磁盘交换才能找到存储记录的位置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T21:46:02.903

我会把它归咎于 I/O，特别是如果您在具有普通硬盘的普通 PC 上运行数据库（我的意思是不在具有超快硬盘驱动器等的服务器中）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-03T03:03:41.947

你在执行增量提交吗？由于 H2 是一个符合 ACID 的数据库，如果您不执行增量提交，那么会有某种类型的重做日志，以便在某些意外故障（例如断电）或回滚的情况下，可以回滚删除。

在这种情况下，您的重做日志可能会变得很大并且内存缓冲区溢出，并且需要将您的重做日志以及您的实际数据写入磁盘，从而增加您的 I/O 开销。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-06T20:03:54.847

从技术角度来看，将 H2 用于 7G 数据文件是错误的选择。如您所说，可嵌入。如果您需要存储这么多数据，您有什么样的“嵌入式”应用程序。

# python - Linux 中的独立 Python 应用程序

> ID：193077
> 
> 赞同：33
> 
> 时间：2008-10-10T21:26:26.280
> 
> 标签：python, linux

如何在 Linux 中分发独立的 Python 应用程序？

我认为我可以理所当然地认为任何现代发行版中都存在最近的 Python 解释器。问题在于处理那些不属于标准库的库，即 wxPython、scipy、python cryptographic toolkit、reportlab 等。

是否有一个可以运行的 Linux 对应物，例如 py2exe（顺便说一下，我从未尝试过）？有免费的、开源的吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-11T11:05:10.357

创建一个 deb（适用于所有 Debian 衍生产品）和一个 rpm（适用于 Fedora/SuSE）。将正确的依赖项添加到包装中，您可以合理地确定它会起作用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-26T05:32:13.203

您可以使用[cx_Freeze](http://cx-freeze.sourceforge.net/)来执行此操作。它就像 py2exe（将解释器和启动脚本以及所有必需的库和模块捆绑在一起），但适用于 Linux 和 Windows。

它从运行它的环境中收集依赖项，这意味着它们也需要适合目标。如果您正在做一些事情，比如在 32 位 Debian 上构建并在另一个 32 位 Debian 上进行部署，那很好。您可以通过在适当的环境（例如 32 位和 64 位 chroot）中构建多个版本并分发适当的版本来处理 32/64 位差异。如果您想要更通用的东西（例如在 Debian 上构建，在任何发行版上部署），那么这会变得有点模糊，具体取决于您的依赖项到底是什么。

如果您正在做一个相当简单的分发（即您知道您的构建环境和部署环境是相似的），那么这可以避免相当复杂的 rpm/deb/egg/etc 步骤（使用 cx_Freeze 非常容易，特别是如果您是熟悉py2exe）。如果没有，那么从滚动你自己的依赖安装程序到 deb/rpm/egg/etc 构建的任何东西都可以工作，这取决于你想要做多少工作，你想要提供的所需版本有多大的灵活性，以及​​依赖是什么。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-10T21:44:11.860

您可能想查看[setuptools](http://peak.telecommunity.com/DevCenter/setuptools?action=highlight&value=EasyInstall#declaring-dependencies)中的依赖声明。这可能会提供一种方法来确保正确的包要么在环境中可用，要么可以由具有适当权限的人安装。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-12T17:48:14.207

Setuptools 对我来说太过分了，因为我的程序的使用非常有限，所以这是我自己开发的替代方案。

我捆绑了一个包含所有先决条件的“第三方”目录，并使用 site.addsitedir 因此它们不需要全局安装。

```
# program startup code
import os
import sys
import site
path = os.path.abspath(os.path.dirname(__file__))
ver = 'python%d.%d' % sys.version_info[:2]
thirdparty = os.path.join(path, 'third-party', 'lib', ver, 'site-packages')
site.addsitedir(thirdparty) 
```

我的大多数先决条件都有 setup.py 安装程序。每个捆绑的模块都有自己的“安装”过程，因此任何定制的东西（例如./configure）都可以自动运行。我的安装脚本将这个 makefile 作为安装过程的一部分运行。

```
# sample third-party/Makefile
PYTHON_VER = `python -c "import sys; \
        print 'python%d.%d' % sys.version_info[:2]"`
PYTHON_PATH = lib/$(PYTHON_VER)/site-packages
MODS = egenix-mx-base-3.0.0 # etc

.PHONY: all init clean realclean $(MODS)
all: $(MODS)
$(MODS): init
init:
    mkdir -p bin
    mkdir -p $(PYTHON_PATH)
clean:
    rm -rf $(MODS)
realclean: clean
    rm -rf bin
    rm -rf lib

egenix-mx-base-3.0.0:
    tar xzf $@.tar.gz
    cd $@ && python setup.py install --prefix=..
    rm -rf $@ 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-10T21:34:01.350

您不能轻松地以与分发无关的格式来做到这一点。唯一可靠的依赖跟踪机制内置于发行版的包管理系统中，并且会因发行版而异。您实际上必须为 fedora 执行 rpm，为 ubuntu 和 debian 等执行 debs。

Py2exe 在 Windows 上运行良好。它为启动程序的 python 解释器构建了一个包含所有必要 DLL 和包装器的发行版。它的安装相当简单——只需将它放在一个目录中——因此为它制作一个 msi 文件是微不足道的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-13T19:56:31.843

标准的python方式是创建一个python“鸡蛋”。

你可以看看[这个教程](http://www.ibm.com/developerworks/library/l-cppeak3.html)，或者[这个关于 setuptools 的页面](http://pypi.python.org/pypi/setuptools/)。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-01-06T13:00:54.600

我认为你可以相当安全地认为大多数现代 Linux 发行版上的 python 支持是理所当然的——对于那些没有它的人，只要给出一个理智的错误消息，用户应该能够自己解决如何获得它（你可以使用一个简单的 bash 启动脚本）：

```
#!/bin/bash
if [ -e /usr/bin/python ]
then
    echo "Python found!"
else
    echo "Python missing!"
fi 
```

* * *

## 回答 #8

> 赞同：-9
> 
> 时间：2008-10-10T21:28:50.567

没有。

Python 在不同的设置方面是出了名的不稳定。部署 python 应用程序的唯一明智的方法是交付您在代码中依赖的整个解释器和库包。这很可能会奏效。

2019 年更新：我支持这一点。Virtualenv 是一种将库和解释器打包在一起的方式。Tox 是一个测试工具来测试解释器/依赖矩阵。Docker 是一种广泛使用的部署包的方式。

# .net - 如何：在 app.config 中指定在调用 Main() 之前调用函数？

> ID：193080
> 
> 赞同：1
> 
> 时间：2008-10-10T21:27:57.200
> 
> 标签：.net, app-config, startup

我真的想在 App.config 中放入某种节处理程序，它将在应用程序实际开始在 Main 执行之前执行一些代码。有没有办法做这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T21:42:37.590

不确定您要完成什么...但是，我不知道无论如何您可以让控制台应用程序在 Main() 之前运行任何其他方法。为什么不做这样的事情：

```
static void Main(string[] args)
{
    //read your app.config variable
    callAlternate = GetConfigSettings(); 
    if(callAlternate)
        AltMain();

    ///...rest of Main()
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T21:39:35.240

为什么不将该调用作为主函数中的第一条指令？

否则，您可以为您的程序定义另一个入口点并从那里调用您的 main 但它基本相同

# formatting - 你最喜欢的源格式化工具是什么？

> ID：193089
> 
> 赞同：0
> 
> 时间：2008-10-10T21:30:35.227
> 
> 标签：formatting

我们都知道最后期限和/或关键错误修正，让我们忘记了一点源格式指南。或者有时您需要使用似乎是由不知道空格和可读性含义的人编码的第 3 方源代码。您最喜欢将您的代码（或第 3 方代码）制成表格以符合您的规范的工具是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T21:37:41.577

Resharper 的内置工具非常棒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T21:41:27.263

我喜欢 Visual Studio 的自动格式化功能。这都是大众市场和男人的工具，但是嘿，它有效，我可以阅读它们的格式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-21T15:17:03.027

Python 本身......以及对 Resharper 的投票

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T21:50:13.830

还可以使用[Uncrustify](http://uncrustify.sourceforge.net/)和[UniversalIndentGUI](http://universalindent.sourceforge.net/)，也适用于大量标记。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-11T17:54:53.057

Emacs：

Cx h (全选)

CM-\（缩进区域）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-11T18:26:50.463

听说过关于[艺术风格](http://astyle.sourceforge.net/)的好消息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T21:32:43.320

对于 Delphi，我喜欢[Delforexp](http://www.aew.wur.nl/UK/Delforexp/)。简单而且相当快。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T21:33:19.043

我的 IDE，IntelliJ，在我签入或击键时执行此操作。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T21:37:18.303

Perl 是我使用最多的语言，[perltidy](http://search.cpan.org/dist/Perl-Tidy/)做得很好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-10T21:43:37.307

我个人使用[PolyStyle](http://polystyle.com/)，因为它支持很多很多语言，但我对替代品很好奇，因此提出了这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-11T18:06:18.557

[HTMLtidy](http://tidy.sourceforge.net/)非常适合 HTML 格式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-11T18:27:47.747

我最喜欢的工具是[indent](http://en.wikipedia.org/wiki/Indent_(Unix))。它在大多数 Unix 发行版中都是现成的。它有几十个选项来适应大多数 C 风格的约定。在 Windows 上，它可以通过 Cygwin 轻松安装。话虽如此，自动代码格式化应该是你最后的手段。没有任何工具可以像优秀的程序员那样格式化代码。

# c# - C# - 如何以编程方式添加 Excel 工作表 - Office XP / 2003

> ID：193092
> 
> 赞同：23
> 
> 时间：2008-10-10T21:30:56.227
> 
> 标签：c#, excel, com, office-interop, worksheet

我刚刚开始通过 C# 摆弄 Excel，以便能够自动创建和添加到 Excel 文件。

我可以打开文件并更新其数据并在现有工作表中移动。我的问题是如何添加新工作表？

我试过：

```
Excel.Worksheet newWorksheet;
newWorksheet = (Excel.Worksheet)excelApp.ThisWorkbook.Worksheets.Add(
                Type.Missing, Type.Missing, Type.Missing, Type.Missing); 
```

但是我低于*COM Exception*并且我的谷歌搜索没有给我任何答案。

> HRESULT 的异常：0x800A03EC 源是：“Interop.Excel”

我希望有人能把我从痛苦中解救出来。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2008-10-10T23:19:47.660

您需要在项目中将 COM 引用添加到**“ `Microsoft Excel 11.0 Object Library`”** - 或任何合适的版本。

这段代码对我有用：

```
private void AddWorksheetToExcelWorkbook(string fullFilename,string worksheetName)
{
    Microsoft.Office.Interop.Excel.Application xlApp = null;
    Workbook xlWorkbook = null;
    Sheets xlSheets = null;
    Worksheet xlNewSheet = null;

    try {
        xlApp = new Microsoft.Office.Interop.Excel.Application();

        if (xlApp == null)
            return;

        // Uncomment the line below if you want to see what's happening in Excel
        // xlApp.Visible = true;

        xlWorkbook = xlApp.Workbooks.Open(fullFilename, 0, false, 5, "", "",
                false, XlPlatform.xlWindows, "",
                true, false, 0, true, false, false);

        xlSheets = xlWorkbook.Sheets as Sheets;

        // The first argument below inserts the new worksheet as the first one
        xlNewSheet = (Worksheet)xlSheets.Add(xlSheets[1], Type.Missing, Type.Missing, Type.Missing);
        xlNewSheet.Name = worksheetName;

        xlWorkbook.Save();
        xlWorkbook.Close(Type.Missing,Type.Missing,Type.Missing);
        xlApp.Quit();
    }
    finally {
        Marshal.ReleaseComObject(xlNewSheet);
        Marshal.ReleaseComObject(xlSheets);
        Marshal.ReleaseComObject(xlWorkbook);
        Marshal.ReleaseComObject(xlApp);
        xlApp = null;
    }
} 
```

> 请注意，您要非常小心[地正确清理和释放您的 COM 对象引用](https://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c)。StackOverflow 问题中包含一个有用的经验法则：*“Never use 2 dots with COM objects”*。在您的代码中；你会遇到真正的麻烦。*我上面的演示代码没有正确清理 Excel 应用程序，但这是一个开始！*

在调查这个问题时，我发现其他一些有用的链接：

*   [使用 C# 打开和导航 Excel](http://www.codeproject.com/KB/office/csharp_excel.aspx)
*   [如何：使用 COM 互操作创建 Excel 电子表格（C# 编程指南）](http://msdn.microsoft.com/en-us/library/ms173186(VS.80).aspx)
*   [如何：将新工作表添加到工作簿](http://msdn.microsoft.com/en-us/library/6fczc37s(VS.80).aspx)

根据 MSDN

> 要使用 COM 互操作，您必须具有管理员或高级用户安全权限。

希望有帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-11T08:38:41.930

想感谢您的一些出色的答复。@AR.，你的明星，它工作得很好。我昨晚注意到`Excel.exe`没有关闭；所以我做了一些研究，发现了如何释放 COM 对象。这是我的最终代码：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Reflection;
using System.IO;
using Excel;

namespace testExcelconsoleApp
{
    class Program
    {
        private String fileLoc = @"C:\temp\test.xls";

        static void Main(string[] args)
        {
            Program p = new Program();
            p.createExcel();
        }

        private void createExcel()
        {
            Excel.Application excelApp = null;
            Excel.Workbook workbook = null;
            Excel.Sheets sheets = null;
            Excel.Worksheet newSheet = null;

            try
            {
                FileInfo file = new FileInfo(fileLoc);
                if (file.Exists)
                {
                    excelApp = new Excel.Application();
                    workbook = excelApp.Workbooks.Open(fileLoc, 0, false, 5, "", "",
                                                        false, XlPlatform.xlWindows, "",
                                                        true, false, 0, true, false, false);

                    sheets = workbook.Sheets;

                    //check columns exist
                    foreach (Excel.Worksheet sheet in sheets)
                    {
                        Console.WriteLine(sheet.Name);
                        sheet.Select(Type.Missing);

                        System.Runtime.InteropServices.Marshal.ReleaseComObject(sheet);
                    }

                    newSheet = (Worksheet)sheets.Add(sheets[1], Type.Missing, Type.Missing, Type.Missing);
                    newSheet.Name = "My New Sheet";
                    newSheet.Cells[1, 1] = "BOO!";

                    workbook.Save();
                    workbook.Close(null, null, null);
                    excelApp.Quit();
                }
            }
            finally
            {
                System.Runtime.InteropServices.Marshal.ReleaseComObject(newSheet);
                System.Runtime.InteropServices.Marshal.ReleaseComObject(sheets);
                System.Runtime.InteropServices.Marshal.ReleaseComObject(workbook);
                System.Runtime.InteropServices.Marshal.ReleaseComObject(excelApp);

                newSheet = null;
                sheets = null;
                workbook = null;
                excelApp = null;

                GC.Collect();
            }
        }
    }
} 
```

谢谢你的帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T06:39:20.173

AR的另一个“Up Tick”......，但如果你不必使用互操作，我会完全避免它。这个产品实际上很有趣： [http](http://www.clearoffice.com/) ://www.clearoffice.com/ ，它提供了一个非常直观的、完全托管的、用于处理 excel 文件的 api，并且似乎是免费的。（至少目前） [SpreadSheetGear](http://www.spreadsheetgear.com/)也很出色，但价格昂贵。

我的两分钱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-03-31T21:49:38.127

> 不要忘记包括*参考***`Microsoft Excel 12.0/11.0 object Library`**

```
using Excel = Microsoft.Office.Interop.Excel;
// Include this Namespace 
```

```
Microsoft.Office.Interop.Excel.Application xlApp = null;
Excel.Workbook xlWorkbook = null;
Excel.Sheets xlSheets = null;
Excel.Worksheet xlNewSheet = null;
string worksheetName ="Sheet_Name";
object readOnly1 = false;

object isVisible = true;

object missing = System.Reflection.Missing.Value;

try
{
    xlApp = new Microsoft.Office.Interop.Excel.Application();

    if (xlApp == null)
        return;

    // Uncomment the line below if you want to see what's happening in Excel
    // xlApp.Visible = true;

    xlWorkbook = xlApp.Workbooks.Open(@"C:\Book1.xls", missing, readOnly1, missing, missing, missing, missing, missing, missing, missing, missing, isVisible, missing, missing, missing);

    xlSheets = (Excel.Sheets)xlWorkbook.Sheets;

    // The first argument below inserts the new worksheet as the first one
    xlNewSheet = (Excel.Worksheet)xlSheets.Add(xlSheets[1], Type.Missing, Type.Missing, Type.Missing);
    xlNewSheet.Name = worksheetName;

    xlWorkbook.Save();
    xlWorkbook.Close(Type.Missing, Type.Missing, Type.Missing);
    xlApp.Quit();
}
finally
{
    System.Runtime.InteropServices.Marshal.ReleaseComObject(xlNewSheet);
    System.Runtime.InteropServices.Marshal.ReleaseComObject(xlSheets);
    System.Runtime.InteropServices.Marshal.ReleaseComObject(xlWorkbook);
    System.Runtime.InteropServices.Marshal.ReleaseComObject(xlApp);
    //xlApp = null;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T00:21:08.410

您可以使用 OLEDB 创建和操作 Excel 文件。有关链接和示例，请参阅[此问题](https://stackoverflow.com/questions/151005/create-excel-xls-and-xlsx-file-from-c#151048)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-21T17:51:58.960

这是我想出的几件事：

1.  您不能同时打开同一个对象的多个实例。例如，如果您实例化一个名为的新 excel 工作表对象`xlsheet1`，则必须在创建另一个 excel 工作表对象 ex 之前释放它`xlsheet2`。似乎 COM 失去了对对象的跟踪，并在服务器上留下了一个僵尸进程。

2.  如果您有多个用户访问同一个文件，使用 关联的打开方法`excel.workbooks`也变得难以关闭。改用 Add 方法，它在不锁定文件的情况下同样有效。例如。`xlBook = xlBooks.Add("C:\location\XlTemplate.xls")`

3.  释放 COM 对象后，将垃圾收集器放在单独的块或方法中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-16T13:20:27.593

**COM**绝对不是一个好方法。更具体地说，如果您正在处理网络环境，那就不行了......

我已经成功使用了以下开源项目：

*   OOXML 格式的 ExcelPackage (Office 2007)

*   .XLS 格式的 NPOI (Office 2003)

看看这些博客文章：

[在 C# 中创建 Excel 电子表格 .XLS 和 .XLSX](http://www.leniel.net/2009/07/creating-excel-spreadsheets-xls-xlsx-c.html)

[带有 Excel 表格和动态图表的 NPOI](http://www.leniel.net/2009/10/npoi-with-excel-table-and-dynamic-chart.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-10T07:41:57.753

这是我用来添加附加工作表的

```
Workbook workbook = null;
Worksheet worksheet = null;

workbook = app.Workbooks.Add(1);
workbook.Sheets.Add();

Worksheet additionalWorksheet = workbook.ActiveSheet; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-10-03T13:59:17.657

我在 VSTO 中遇到了类似的应用程序级加载项问题，添加新工作表时出现异常 HRESULT: 0x800A03EC。

> 错误代码 0x800A03EC（或 -2146827284）表示 NAME_NOT_FOUND；换句话说，你已经要求了一些东西，而 Excel 找不到它。

Dominic Zukiewicz @ [Excel 错误 HRESULT: 0x800A03EC 在尝试使用单元格名称获取范围时](https://stackoverflow.com/questions/891394/excel-error-hresult-0x800a03ec-while-trying-to-get-range-with-cells-name)

然后我终于意识到**ThisWorkbook**触发了异常。**ActiveWorkbook**正常。

```
Excel.Worksheet newSheetException = Globals.ThisAddIn.Application.ThisWorkbook.Worksheets.Add(Type.Missing, sheet, Type.Missing, Type.Missing);
Excel.Worksheet newSheetNoException = Globals.ThisAddIn.Application.ActiveWorkbook.Worksheets.Add(Type.Missing, sheet, Type.Missing, Type.Missing); 
```

# .net - 为什么.NET 不能解析带有时区的日期字符串？

> ID：193095
> 
> 赞同：3
> 
> 时间：2008-10-10T21:31:26.410
> 
> 标签：.net, datetime, parsing

.NET 尝试以这种格式解析日期时间字符串时抛出异常：

**2008 年 10 月 10 日星期五 00:05:51 CST**

Convert.ToDateTime("Fri, 10 Oct 2008 00:05:51 CST") 导致异常：

> 该字符串未被识别为有效的日期时间。从索引 26 开始有一个未知单词

字符 26 显然是“CST”的开始

在快速测试中，PHP 和 javascript 都可以毫无问题地将此字符串解析为日期。.NET 是完全失败还是有合理的解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T21:34:23.487

[http://msdn.microsoft.com/en-us/library/ey1cdcx8.aspx](http://msdn.microsoft.com/en-us/library/ey1cdcx8.aspx)

您需要使用重载的 DateTime.Parse 来准确解析时区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T21:35:17.887

如果将跨不同的语言环境解析特定的日期和时间格式，请使用 ParseExact 方法的重载之一并提供格式说明符。

# c# - VS调试器错了吗？代码抛出的IndexOutOfRangeException：f++

> ID：193096
> 
> 赞同：1
> 
> 时间：2008-10-10T21:32:00.060
> 
> 标签：c#, debugging, exception, visual-studio-2005

为什么下面代码的“f++”部分会抛出异常（“IndexOutOfRangeException 未被用户代码处理”）：

```
for (int f = 0; f < gnf; f++)  
{  
    fieldNames[g] = grid.FieldName(f);  
} 
```

该错误在代码的“fieldNames [g] = ...”部分中，我的算法应该是：

```
for (int f = 0; f < gnf; f++)  
{  
    fieldNames[f] = grid.FieldName(f);  
} 
```

（这不会崩溃。）但是当错误的（顶部）代码运行时，调试器没有在“fieldNames [g] ...”行上显示异常。

我此时没有使用线程，所以我不认为它是“在线程程序中调试异常是自杀”的情况之一。

为什么调试器在错误的地方显示异常？优化什么的？以前有没有其他人让调试器像这样“错误”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T22:34:32.447

可能是优化器。您的构建设置为 DEBUG 还是 RELEASE？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-12T06:14:21.503

我遇到过类似的调试问题，并认为这通常是调试（pdb）文件没有与代码保持同步。这可能是由许多问题引起的，包括

*   该文件已被修改，但由于某种原因没有进行库的编译。所以 .dll 和 .pdb 文件不是最新的源代码。
*   .pdb 文件已过期，因为编译发生在 RELEASE 设置中
*   该库存在于文件系统上的多个位置，并且当前的解决方案以某种方式设置为查看不同的 .dll 和 .pdb 文件。

发生这种情况时调试信息都存储在 .pdb 文件中，如果文件过期，它将在 Visual Studio 中突出显示不正确的行。

如果所有项目都在单个解决方案中并且引用设置正确，则重新启动 Visual Studio 通常可以解决此问题。（由于某种原因，编译可能无法正确进行，并且重新启动解决了这个问题 - 无论如何对我来说似乎就是这样......）

# .net - 在 3.0 之上安装 .net Framework 3.5SP1 - 就像“安装并运行”一样简单？

> ID：193104
> 
> 赞同：1
> 
> 时间：2008-10-10T21:35:00.350
> 
> 标签：.net

这可能是一个愚蠢的问题，但如果我决定这样做，我无法轻易撤消我的更改，我想我会先在这里问：

我有一个 Sharepoint 2007 服务器。相当标准的东西：Windows 2003（32 位）、IIS 6、Sharepoint 2007、.net 3.0。

目前，我使用带有 .net 3.0 的 Visual Studio 2005 作为我的目标。但是，我想使用 .net 3.5SP1 功能，因为添加了一些非常好的功能。

现在，据我了解，.net 3.0 和 3.5 是“仅”.net 2.0 + 一些新的程序集（非常简单），因此我想知道我是否可以在所有 Sharepoint 服务器上愉快地安装 3.5SP1 框架并使用它们 - 或者是否需要任何额外的黑魔法来防止整个东西爆炸？

我假设我需要更新到 Visual Studio 2008 SP1，这很好。是否需要重新编译任何代码？我可以安全地引用新编写的“旧”程序集吗？还是我没有发现任何大的不兼容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T21:42:16.593

我当然不会*高兴地在所有 [您的生产服务器] 上安装 3.5SP1 框架*。

使用 Virtual Server 或 VMware 并使用您的配置构建虚拟机，然后升级并测试、测试、测试。如果您认为物有所值，可以使用一些工具来进行 P2V（物理到虚拟）迁移，这样您就可以将*准确的*生产配置放入 VM，而不是从头开始重建它。

3.5SP1*中有*重大更改（例如，请参阅[Scott Hanselman 的博客](http://www.hanselman.com/blog/UpdateOnNETFramework35SP1AndWindowsUpdate.aspx)），如果您只是安装而没有测试 Murphy 说您可能至少会被其中一个所困扰。

# oracle - 在 Oracle SQL Developer SQL 工作表窗口中打印文本

> ID：193107
> 
> 赞同：99
> 
> 时间：2008-10-10T21:35:29.303
> 
> 标签：oracle, printing, oracle-sqldeveloper

我正在使用 Oracle SQL（在 SQLDeveloper 中，使用 SQL 工作表）。我想在我的选择之前打印一个声明，例如

```
PRINT 'Querying Table1';
SELECT * from Table1; 
```

我用什么来打印/显示文本输出？它不是打印，因为这给了我错误：绑定变量`Table1`未声明。DBMS_OUTPUT.PUT_LINE 是未知命令。（显然，我是一个缺乏经验的 SQLDeveloper 和 Oracle 用户。一定有一些 Print 的同义词，但我在不知道它是什么的情况下很难找到它的帮助。）

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2008-12-11T16:45:59.830

![在此处输入图像描述](https://i.stack.imgur.com/72MPn.png)

简单的评论：

```
set serveroutput on format wrapped;
begin
    DBMS_OUTPUT.put_line('simple comment');
end;
/

-- do something

begin
    DBMS_OUTPUT.put_line('second simple comment');
end;
/ 
```

你应该得到：

```
anonymous block completed
simple comment

anonymous block completed
second simple comment 
```

如果你想打印出变量的结果，这里有另一个例子：

```
set serveroutput on format wrapped;
declare
a_comment VARCHAR2(200) :='first comment';
begin
    DBMS_OUTPUT.put_line(a_comment);
end;

/

-- do something

declare
a_comment VARCHAR2(200) :='comment';
begin
    DBMS_OUTPUT.put_line(a_comment || 2);
end; 
```

你的输出应该是：

```
anonymous block completed
first comment

anonymous block completed
comment2 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2010-11-03T07:09:54.793

```
PROMPT text to print 
```

**注意：**必须使用 Run as Script (F5) 而不是 Run Statement (Ctl + Enter)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-10-10T21:50:10.757

您可以[将 echo 设置](http://download.oracle.com/docs/cd/B19306_01/server.102/b14357/ch12040.htm#SQPUG075)为 on：

```
set echo on
REM Querying table
select * from dual; 
```

在 SQLDeveloper 中，按 F5 以作为脚本运行。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2019-02-15T17:40:34.140

主要答案为新安装留下了一个必须打开 dbms 输出窗口的步骤。

[![在此处输入图像描述](https://i.stack.imgur.com/SlsOg.png)](https://i.stack.imgur.com/SlsOg.png)

然后我使用的脚本：

```
dbms_output.put_line('Start'); 
```

* * *

另一个脚本：

```
set serveroutput on format wrapped;
begin
    DBMS_OUTPUT.put_line('jabberwocky');
end; 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-10-12T02:25:30.343

您可以将您的文本放在一个选择语句中，例如...

```
SELECT 'Querying Table1' FROM dual; 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2011-03-02T16:19:11.083

对我来说，我只能让它与它一起工作

```
set serveroutput on format word_wrapped; 
```

wrapped 和 WRAPPED 只是抛出错误： SQLPLUS command failed - not enough arguments

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-05-20T04:56:27.447

如果我省略开始 - 结束它是错误的。所以对我来说这是有效的（不需要其他任何东西）：

```
set serveroutput on;
begin
DBMS_OUTPUT.PUT_LINE('testing');
end; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-12-08T23:24:00.483

如果您不希望所有 SQL 语句都被回显，但您只想查看脚本的易于识别的结果，请这样做：

> 设置回声
> 
> REM MyFirstTable
> 
> 关闭回声
> 
> 从 MyFirstTable 中删除；
> 
> 设置回声
> 
> REM MySecondTable
> 
> 关闭回声
> 
> 从 MySecondTable 中删除；

上述示例的输出将如下所示：

> -REM 我的第一个表
> 
> 删除了 13 行。
> 
> -REM MySecondTable
> 
> 删除了 27 行。

# opengl - 将 pbuffer 与 GLUT 一起使用？

> ID：193118
> 
> 赞同：1
> 
> 时间：2008-10-10T21:38:18.690
> 
> 标签：opengl, glut

我一直在网上搜索一个代码示例，该示例显示如何将 pbuffer 与 GLUT 一起使用，但我找不到任何东西......

我对 pbuffer 和渲染窗口之间的上下文切换感到困惑。我想我将不得不使用 glutSetWindow 在两个渲染表面之间切换，但我不太确定细节。

有人可以解释我如何使用 GLUT 的 pbuffer 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T05:00:32.900

简短的回答是没有*好的*方法可以做到这一点。

更长的答案是 pbuffers 不是跨平台的，因此您必须使用特定于平台的 API 来访问它们。如何在渲染表面之间切换取决于您的平台；在 Windows 上，您将使用 wglMakeCurrent() 等。

元答案是，如果可能的话，您应该避免使用 pbuffers - [FBO](http://opengl.org/registry/specs/ARB/framebuffer_object.txt)提供类似的功能，但没有此类问题，并且性能也更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T11:37:47.250

Mike F 的回答让我[从 ATI 那里得到了关于 pbuffers 的一个很好的解释](http://ati.amd.com/developer/ATIpbuffer.pdf)。谢谢！

我没有发现任何关于切换上下文的 GLUT 函数的提及，只有 wgl* 函数。我一定误解了 glutSetWindow 的用途。

# iphone - 我的 iPhone Objective-C 代码如何在 UIWebView 中收到有关 Javascript 错误的通知？

> ID：193119
> 
> 赞同：46
> 
> 时间：2008-10-10T21:39:21.857
> 
> 标签：iphone, objective-c, webkit

我需要让我的 iPhone Objective-C 代码在 UIWebView 中捕获 Javascript 错误。这包括未捕获的异常、加载文件时的语法错误、未定义的变量引用等。

这是一个开发环境，所以它不需要是 SDK-kosher。事实上，它只需要在模拟器上工作。

我已经发现使用了一些隐藏的 WebKit 技巧来例如将 Obj-C 对象暴露给 JS 并拦截警报弹出窗口，但是这个仍然让我望而却步。

[注意：发布此内容后，我确实找到了一种使用调试委托的方法。有没有一种方法可以降低开销，使用错误控制台/网络检查器？]

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-10T22:57:58.653

我现在找到了一种在 WebView 中使用脚本调试器钩子的方法（注意，不是 UIWebView）。我首先必须继承 UIWebView 并添加这样的方法：

```
- (void)webView:(id)webView windowScriptObjectAvailable:(id)newWindowScriptObject {
    // save these goodies
    windowScriptObject = newWindowScriptObject;
    privateWebView = webView;

    if (scriptDebuggingEnabled) {
        [webView setScriptDebugDelegate:[[YourScriptDebugDelegate alloc] init]];
    }
} 
```

接下来，您应该创建一个包含以下方法的 YourScriptDebugDelegate 类：

```
// in YourScriptDebugDelegate

- (void)webView:(WebView *)webView       didParseSource:(NSString *)source
 baseLineNumber:(unsigned)lineNumber
        fromURL:(NSURL *)url
       sourceId:(int)sid
    forWebFrame:(WebFrame *)webFrame
{
    NSLog(@"NSDD: called didParseSource: sid=%d, url=%@", sid, url);
}

// some source failed to parse
- (void)webView:(WebView *)webView  failedToParseSource:(NSString *)source
 baseLineNumber:(unsigned)lineNumber
        fromURL:(NSURL *)url
      withError:(NSError *)error
    forWebFrame:(WebFrame *)webFrame
{
    NSLog(@"NSDD: called failedToParseSource: url=%@ line=%d error=%@\nsource=%@", url, lineNumber, error, source);
}

- (void)webView:(WebView *)webView   exceptionWasRaised:(WebScriptCallFrame *)frame
       sourceId:(int)sid
           line:(int)lineno
    forWebFrame:(WebFrame *)webFrame
{
    NSLog(@"NSDD: exception: sid=%d line=%d function=%@, caller=%@, exception=%@", 
          sid, lineno, [frame functionName], [frame caller], [frame exception]);
} 
```

这可能会对运行时产生很大影响，因为调试委托还可以提供用于进入和退出堆栈帧以及执行每一行代码的方法。

有关 WebScriptDebugDelegate 的 Objective-C++ 定义，请参见[http://www.koders.com/noncode/fid7DE7ECEB052C3531743728D41A233A951C79E0AE.aspx](http://www.koders.com/noncode/fid7DE7ECEB052C3531743728D41A233A951C79E0AE.aspx)。

那些其他方法：

```
// just entered a stack frame (i.e. called a function, or started global scope)
- (void)webView:(WebView *)webView    didEnterCallFrame:(WebScriptCallFrame *)frame
      sourceId:(int)sid
          line:(int)lineno
   forWebFrame:(WebFrame *)webFrame;

// about to execute some code
- (void)webView:(WebView *)webView willExecuteStatement:(WebScriptCallFrame *)frame
      sourceId:(int)sid
          line:(int)lineno
   forWebFrame:(WebFrame *)webFrame;

// about to leave a stack frame (i.e. return from a function)
- (void)webView:(WebView *)webView   willLeaveCallFrame:(WebScriptCallFrame *)frame
      sourceId:(int)sid
          line:(int)lineno
   forWebFrame:(WebFrame *)webFrame; 
```

请注意，这一切都隐藏在一个私有框架中，所以不要试图将它放在你提交给 App Store 的代码中，并准备好一些黑客来让它工作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-07-16T00:10:27.800

我创建了一个不错的小插件类别，您可以将其添加到您的项目中......它基于 Robert Sanders 解决方案。荣誉。

你可以在这里下载：

[UIWebView+调试](https://github.com/PabloGS/UIWebView-Debug)

这应该会让你更容易调试 UIWebView :)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-11-05T17:02:54.640

我使用了 Robert Sanders 提出的出色解决方案：[我的 iPhone Objective-C 代码如何在 UIWebView 中收到有关 Javascript 错误的通知？](https://stackoverflow.com/questions/193119/how-can-my-iphone-objective-c-code-get-notified-of-javascript-errors-in-a-uiwebvi/193282#193282)

webkit 的那个钩子在**iPhone**上也可以正常工作。我分配了派生的 MyUIWebView 而不是标准 UIWebView。我还需要在 MyWebScriptObjectDelegate.h 中定义隐藏类：

`@class WebView;`
`@class WebFrame;`
`@class WebScriptCallFrame;`

在 ios sdk 4.1 中，函数：

```
- (void)webView:(id)webView windowScriptObjectAvailable:(id)newWindowScriptObject 
```

已**弃用**，我使用以下功能代替它：

```
- (void)webView:(id)sender didClearWindowObject:(id)windowObject forFrame:(WebFrame*)frame 
```

此外，我收到一些恼人的警告，例如“NSObject 可能无法响应 -windowScriptObject”，因为类接口是隐藏的。我忽略了它们，效果很好。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-03-18T18:53:41.977

如果您拥有 Safari v 6+（我不确定您需要什么 iOS 版本），那么在开发期间可以使用的一种方法是使用 Safari 开发工具并通过它连接到 UIWebView。

1.  在 Safari 中：启用开发菜单（首选项 > 高级 > 在菜单栏中显示开发菜单）
2.  通过数据线将手机插入计算机。
3.  项目清单
4.  加载应用程序（通过 xcode 或直接启动它）并转到您要调试的屏幕。
5.  回到 Safari，打开 Develop 菜单，在该菜单中查找您的设备名称（我的称为 iPhone 5），应该在 User Agent 下方。
6.  选择它，您应该会看到当前在您的应用程序中可见的 Web 视图的下拉列表。
7.  如果屏幕上有多个 webview，您可以尝试通过在开发菜单中滚动应用程序的名称来区分它们。对应的 UIWebView 会变成蓝色。
8.  选择应用程序的名称，开发窗口打开，您可以检查控制台。你甚至可以通过它发出 JS 命令。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-10-08T01:35:43.297

直截了当的方式：将此代码放在使用 UIWebView 的控制器/视图之上

```
#ifdef DEBUG
@interface DebugWebDelegate : NSObject
@end
@implementation DebugWebDelegate
@class WebView;
@class WebScriptCallFrame;
@class WebFrame;
- (void)webView:(WebView *)webView   exceptionWasRaised:(WebScriptCallFrame *)frame
       sourceId:(int)sid
           line:(int)lineno
    forWebFrame:(WebFrame *)webFrame
{
    NSLog(@"NSDD: exception: sid=%d line=%d function=%@, caller=%@, exception=%@", 
          sid, lineno, [frame functionName], [frame caller], [frame exception]);
}
@end
@interface DebugWebView : UIWebView
id windowScriptObject;
id privateWebView;
@end
@implementation DebugWebView
- (void)webView:(id)sender didClearWindowObject:(id)windowObject forFrame:(WebFrame*)frame
{
    [sender setScriptDebugDelegate:[[DebugWebDelegate alloc] init]];
}
@end
#endif 
```

然后像这样实例化它：

```
#ifdef DEBUG
        myWebview = [[DebugWebView alloc] initWithFrame:frame];
#else
        myWebview = [[UIWebView alloc] initWithFrame:frame];
#endif 
```

使用#ifdef DEBUG 可确保它不会进入发布版本，但我也建议您在不使用它时将其注释掉，因为它会影响性能。原始代码归功于 Robert Sanders 和 Prcela

此外，如果使用 ARC，您可能需要添加“-fno-objc-arc”以防止一些构建错误。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-04-21T20:58:36.453

我创建了一个 SDK 犹太洁食错误报告器，其中包括：

1.  错误信息
2.  发生错误的文件的名称
3.  错误发生的行号
4.  JavaScript 调用堆栈，包括传递的参数

它是[sourceForge 项目提供的 QuickConnectiPhone 框架的一部分](http://sourceforge.net/projects/quickconnect/)

甚至还有一个示例应用程序展示了如何向 Xcode 终端发送错误消息。

您需要做的就是用 try catch 包围您的 JavaScript 代码，包括函数定义等。它应该看起来像这样。

```
try{
//put your code here
}
catch(err){
    logError(err);
} 
```

它不适用于编译错误，但适用于所有其他错误。甚至是匿名函数。

开发[博客在](http://tetontech.wordpress.com/) 这里，包括指向 wiki、sourceForge、google 组和 twitter 的链接。也许这会帮助你。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T22:14:06.280

我在固件 1.x 中做到了这一点，但在 2.x 中没有。这是我在 1.x 中使用的代码，它至少应该对您有所帮助。

```
// Dismiss Javascript alerts and telephone confirms
/*- (void)alertSheet:(UIAlertSheet*)sheet buttonClicked:(int)button
{
    if (button == 1)
    {
        [sheet setContext: nil];
    }

    [sheet dismiss];
}*/

// Javascript errors and logs
- (void) webView: (WebView*)webView addMessageToConsole: (NSDictionary*)dictionary
{
    NSLog(@"Javascript log: %@", dictionary);
}

// Javascript alerts
- (void) webView: (WebView*)webView runJavaScriptAlertPanelWithMessage: (NSString*) message initiatedByFrame: (WebFrame*) frame
{
    NSLog(@"Javascript Alert: %@", message);

    UIAlertSheet *alertSheet = [[UIAlertSheet alloc] init];
    [alertSheet setTitle: @"Javascript Alert"];
    [alertSheet addButtonWithTitle: @"OK"];
    [alertSheet setBodyText:message];
    [alertSheet setDelegate: self];
    [alertSheet setContext: self];
    [alertSheet popupAlertAnimated:YES];
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-22T22:21:19.513

请参阅 iOS7 中的异常处理：http: [//www.bignerdranch.com/blog/javascriptcore-example/](http://www.bignerdranch.com/blog/javascriptcore-example/)

```
[context setExceptionHandler:^(JSContext *context, JSValue *value) {
    NSLog(@"%@", value);
}]; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-13T03:37:45.413

首先设置[WebViewJavascriptBridge](https://github.com/marcuswestin/WebViewJavascriptBridge)，然后覆盖 console.error 函数。

在 JavaScript 中

```
 window.originConsoleError = console.error;
    console.error = (msg) => {
        window.originConsoleError(msg);
        bridge.callHandler("sendConsoleLogToNative", {
            action:action,
            message:message
        }, null)
    }; 
```

在 Objective-C 中

```
[self.bridge registerHandler:@"sendConsoleLogToNative" handler:^(id data, WVJBResponseCallback responseCallback) {
    NSString *action = data[@"action"];
    NSString *msg = data[@"message"];
    if (isStringValid(action)){
        if ([@"console.error" isEqualToString:action]){
            NSLog(@"JS error :%@",msg);
        }
    }
}]; 
```

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2012-11-16T09:34:53.593

在某些情况下，更简单的解决方案可能是将[Firebug Lite](https://getfirebug.com/firebuglite)添加到网页中。

# c# - 如何在企业库中使用准备好的语句？

> ID：193123
> 
> 赞同：0
> 
> 时间：2008-10-10T21:40:13.040
> 
> 标签：c#, enterprise-library

有没有办法告诉企业库使用准备好的语句？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-19T21:11:28.413

简短的回答是使用 DbCommand.Prepare();

长答案是它完全无关紧要，并且在调用存储过程时会导致无操作。

此外，仅当代码将要使用相同的查询进行多次调用（如在循环中）时才应该真正使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T12:15:24.863

应该可以获取正在执行的sqlConnection/Command -> 执行前不能在这里设置相关设置吗？？

希望我有正确的结局......

# xml - 无法翻译 Unicode 字符

> ID：193124
> 
> 赞同：1
> 
> 时间：2008-10-10T21:40:14.083
> 
> 标签：xml, xslt

我有一个 ASPX 页面，它从 SQL 数据创建一个 XMLDocument 对象，然后使用带有 XPathNavigator 和 XslCompiledTransform 的 XSLT 文件将其转换为另一个 XML 文档（RSS 提要）。有时，数据将包含智能引号 (\u2019)，这会导致错误（无法将索引 947 处的 Unicode 字符 \u2019 转换为指定的代码页）。我不确定所有编码设置是如何工作的，但有没有办法防止这种情况发生，而无需在创建 XML 属性时检查所有数据中的这些类型的字符？

我的 XSLT 文件看起来像这样......

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <xsl:output method="xml" version="1.0" encoding="iso-8859-1"/> 
```

我尝试将 xsl:output 编码更改为 utf-8 和 utf-16 但仍然遇到同样的问题。有任何想法吗？

如果有帮助，这是我的代码...

```
XmlDocument xdoc = new XmlDocument();
XmlNode xnode = requests.XMLNode(xdoc, imageType, Request, promotionPageId, eventPageId);
xdoc.AppendChild(xnode);

Response.Clear();
Response.ContentType = "text/xml";
Response.AddHeader("Content-Type", "text/xml");

if (xsltFile != string.Empty)
{
    XPathNavigator xnav = xdoc.CreateNavigator();
    XslCompiledTransform xslTransform = new XslCompiledTransform();
    xslTransform.Load(Server.MapPath(string.Format("~/xslt/{0}.xslt", xsltFile)));
    xslTransform.OutputSettings.Encoding.
    xslTransform.Transform(xnav, null, Response.OutputStream);
}
else
{
    xdoc.Save(Response.OutputStream);
}

Response.End(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T19:52:33.817

您的转换工作正常。问题是转换发出的字符不受输出流的内容编码支持。设置`ContentEncoding`到`HttpResponse`，`Encoding.UTF16`这个问题应该会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T09:22:32.637

您的 XSL 正在处理的输入 XML 的文档编码是什么？您应该能够设置它，然后 XSL 将知道会发生什么。

# javascript - 如何在 Adob e AIR 的不同页面之间共享 javascript 对象？

> ID：193130
> 
> 赞同：0
> 
> 时间：2008-10-10T21:42:24.360
> 
> 标签：javascript, air

我想将一个自定义对象附加到应用程序，这样我就可以在 adobe air 中的不同 html 页面之间保留其中的状态。这可能吗？

* * *

我要求一个完整的解决方案来将自定义 js 对象存储在内存中并在从应用程序沙箱加载的页面之间保留它，但是除非我使用不太令人愉快的 iframe，否则无法做到这一点，因为我必须添加很多东西到桥上。另一种方法可能是对填充了从文件中读取的 html 填充的页面进行部分渲染，但这会暴露出很多令人不快的错误 + 你不能在 dom 中动态编写脚本标签。这是一个残缺的平台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T16:26:37.913

也许您可以尝试将对象附加到用户的机器上。网上有一个教程似乎可以提供帮助：

[http://corlan.org/2008/09/02/storing-data-locally-in-air/](http://corlan.org/2008/09/02/storing-data-locally-in-air/)

来自网站的示例：

```
//write an Object to a file
private function writeObject():void {
    var object:Object = new Object();//create an object to store
    object.value =  asObject.text; //set the text field value to the value property
    //create a file under the application storage folder
    var file:File = File.applicationStorageDirectory.resolvePath("myobject.file");
    if (file.exists)
        file.deleteFile();
    var fileStream:FileStream = new FileStream(); //create a file stream
    fileStream.open(file, FileMode.WRITE);// and open the file for write
    fileStream.writeObject(object);//write the object to the file
    fileStream.close();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T09:51:19.600

什么样的物体？-)

如果它只保存在字符串中有意义的值，则可以将其存储为 cookie 或可能存储在服务器端会话中...

# wpf - 为什么处理 WM_NCCALCSIZE 会导致我的窗口跳转？

> ID：193142
> 
> 赞同：5
> 
> 时间：2008-10-10T21:45:25.120
> 
> 标签：wpf, windows, winapi, pinvoke

我有一个捕捉到屏幕边缘的 WPF 应用程序（如果您在屏幕边缘的 20 像素范围内，我只需设置窗口的 .Top 或 .Left），但我最近添加[了 WPF SDK 团队提供的](http://blogs.msdn.com/wpfsdk/archive/2008/09/08/custom-window-chrome-in-wpf.aspx)一些代码到“窗口镶边的混乱”，虽然它工作得很好（[截图](http://huddledmasses.org/images/PoshConsole/NewLook_Aero.png)），但它导致“快照”意外移动窗口（例如：当它应该直接向下捕捉到底部时它会跳到左边）

我将其范围缩小到他们对 WM_NCCALCSIZE 的处理......这真的很奇怪，因为他们基本上什么都不做，他们只是说他们处理它，然后返回 0。

根据 WM_NCCALCSIZE 的文档，这应该只是导致整个窗口被视为客户端（没有非客户端边缘），但不知何故，这也意味着每当我的 snap-to 代码将窗口向下移动到屏幕底部，它也向左移动了大约 134 像素 ...（移动到其他边缘也有类似的副作用），只要我按住鼠标拖动它，它就会从它应该在的位置来回闪烁。如果我将 WM_NCCALCSIZE 处理注释掉，则 snap-to 会按应有的方式工作（但表单看起来不正确）。

我已经在 WM_NCCALCSIZE 处理程序中尝试了所有我能做的事情，但我无法阻止它向左跳......当然，WM_NCCALCSIZE 只有在窗口大小发生变化时才会被调用，所以我不明白它是如何导致的这首先！

PS如果您想实际查看代码，它已经[在 CodePlex 上](http://www.codeplex.com/PoshConsole/SourceControl/DirectoryView.aspx?SourcePath=%24%2fPoshConsole%2ftrunk&changeSetId=25220)，在两个文件中，查找[_HandleNCCalcSize](http://www.codeplex.com/PoshConsole/SourceControl/FileView.aspx?itemId=359235&changeSetId=25220)和[OnWindowLocationChanged](http://www.codeplex.com/PoshConsole/SourceControl/FileView.aspx?itemId=3029&changeSetId=25220)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T02:09:20.743

发生这种情况的原因是处理`WM_NCCALCSIZE`更改窗口的整体大小......但是如果您正在移动窗口，在`WM_MOVE`or期间更改您的位置`WM_WINDOWPOSCHANGED`（对应于 WPF`WindowPositionChanged`事件）会导致另`WM_NCCALCSIZE`一条消息......

在期间进行更改`WM_NCCALCSIZE`（甚至只是断言您处理了消息）会导致另一个调用`WM_MOVE`... 这使您进入一个循环，其中 positionchanged 消息的“FROM”部分保持不变（使窗口从它开始的位置“跳转”到您在`WM_MOVE`一遍又一遍地调整它的位置，因为它在之后变回`WM_NCCALCSIZE`）。

## 正确的方法

你要做的，就是顺从陈瑞峰，[去](https://web.archive.org/web/20080219212741/http://blogs.msdn.com/oldnewthing/archive/2008/01/16/7123299.aspx)[处理`WM_WINDOWPOSCHANGING`](https://web.archive.org/web/20080219212741/http://blogs.msdn.com/oldnewthing/archive/2008/01/16/7123299.aspx)。它发生**在**这些其他消息之前，这样它们就不会相互干扰！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T22:48:47.567

wParam 似乎总是 TRUE (1) 而 lParam 是一个 NCCALCSIZE_PARAMS ...

目的是完全按照您所说的去做：强制整个窗口成为“客户端”，然后使用 Vista DWM apis 将框架扩展到客户端区域。我只是不明白为什么它向左移动这么远......

如果我跟踪或断点 HandleNCCalcSize 方法，当我调整窗口大小时（当它位于边缘以便触发 snap-to 时），NCCalcSize 被调用两次：一次它应该在的地方，然后离开到左边，它结束的地方向上。

# c# - 如何强制 MSTEST TestMethod 在运行前重置所有单例/静态？

> ID：193143
> 
> 赞同：14
> 
> 时间：2008-10-10T21:45:52.060
> 
> 标签：c#, unit-testing, visual-studio-2008, mstest, appdomain

我在 Visual Studio 2008 中使用 MSTEST。如何让某个测试类中的每个单元测试方法都像运行的第一个测试一样，以便在运行每个测试之前重置所有全局状态？我不想使用 TestInitialize、ClassInitialize、AssemblyInitialize 等显式清理世界。例如：

```
[TestClass]
public class MyClassTests
{
    [TestMethod]
    public void Test1()
    {
       // The "Instance" property creates a new instance of "SomeSingleton"
       // if it hasn't been created before.
       var i1 = SomeSingleton.Instance;
       ...
    }
    [TestMethod]
    public void Test2()
    {
       // When I select "Test1" and "Test2" to run, I'd like Test2
       // to have a new AppDomain feel so that the static variable inside
       // of "SomeSingleton" is reset (it was previously set in Test1) on
       // the call to ".Instance"
       var i2 = SomeSingleton.Instance;
       // some code
    } 
```

尽管在该主题上出现了[类似的问题](https://stackoverflow.com/questions/154180/how-does-nunit-and-mstest-handle-tests-that-change-staticshared-variables)，但它只是澄清了测试不是并行运行的。我意识到测试是连续运行的，但似乎没有办法为每个方法显式强制一个新的 AppDomain （或等同于清除所有状态的东西）。

理想情况下，我只想为我的单元测试的一小部分指定这种行为，这样我就不必为不关心全局状态的测试（绝大多数我的测试）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-13T17:24:49.357

[最后，我写了一个使用AppDomain.CreateDomain](http://msdn.microsoft.com/en-us/library/system.appdomain.createdomain.aspx)的助手，然后使用反射在不同的 AppDomain 下调用单元测试。它提供了我需要的隔离。

[MSDN 论坛上的这篇文章](http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/130c923f-15cb-4a87-8d3b-0f9779080cfa/)展示了如果您只有几个静态需要重置的情况下如何处理这种情况。[它](http://social.msdn.microsoft.com/Forums/en-US/vststest/thread/130c923f-15cb-4a87-8d3b-0f9779080cfa/)确实提到了一些选项（例如使用 Reflection 和[PrivateType](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privatetype.aspx)）。

我继续欢迎任何进一步的想法，特别是如果我遗漏了有关 MSTEST 的一些明显内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-13T18:36:08.043

在您的测试中添加一个使用反射来删除单例实例的助手（您也可以向单例添加一个重置方法，但我会担心它的使用）。就像是：

```
public static class SingletonHelper {
            public static void CleanDALFactory() 
            {
                    typeof(DalFactory)
                        .GetField("_instance",BindingFlags.Static | BindingFlags.NonPublic)
                        .SetValue(null, null);
            }
} 
```

在您的 TestInitialize 方法中调用它。[我知道这是“清理世界”，但你只需要在每个单例的助手中编写一次方法，它非常简单并且给你明确的控制]

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-13T15:14:39.040

我认为您正在寻找 TestIntialize 属性和 TestCleanUp 属性。这是一个显示执行顺序[链接文本的 MSDN 博客](http://blogs.msdn.com/nnaderi/archive/2007/02/17/explaining-execution-order.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T15:07:34.423

我们的 MSTest 也出现了类似的问题。我们通过在需要它的特定测试的开头和结尾调用一个函数来处理它。

我们在应用配置中存储了一个测试到期日期。三个测试需要这个日期落入特定范围以确定适当的值。我们的应用程序的设置方式，只有在会话中没有分配值时才会重置配置值。因此，我们创建了两个新的私有静态函数 - 一个用于将配置值显式设置为指定日期，另一个用于在测试运行后从会话中清除该日期。在我们的三个测试中，我们调用了这两个函数。当下一个测试运行时，应用程序看到一个空的日期值并从配置文件中重新获取它。

我不确定这是否有帮助，但这就是我们解决类似问题的方式。

# wordpress - 如何跨多个子域分发 Wordpress 媒体文件

> ID：193151
> 
> 赞同：0
> 
> 时间：2008-10-10T21:49:18.917
> 
> 标签：wordpress, plugins, offloading

所以问题是如何在多个域中分发/卸载来自 Wordpress 帖子的媒体文件。

克服这一限制的原因是：“大多数浏览器只会同时向服务器发出 2 个请求，因此如果您的页面需要 16 个文件，它们将一次被请求 2 个。”

关于：[http ://codex.wordpress.org/WordPress_Optimization/Offloading](http://codex.wordpress.org/WordPress_Optimization/Offloading)

进一步澄清：
有两个用于“卸载”的插件已经这样做了。它们是 SteadyOffloading 插件和 Amazon S3 插件。
那么是否有任何人都遇到过的通用解决方案。如果它允许您更改媒体的基本 URL，则不必将该媒体上传到外部服务/服务器。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T00:17:35.407

您只需要在整个 WordPress 主题中编辑各种媒体文件的 URL。

例如，编辑“header.php”以将 css 文件更改为备用域。

改变这个：

```
print("<link rel="stylesheet" type="text/css" media="screen" href="<?php bloginfo('stylesheet_url'); ?>" />"); 
```

对于这样的事情：

```
print("<link rel="stylesheet" type="text/css" media="screen" href="http://www.NEW_DOMAIN.com/theme/stylesheet.css" />"); 
```

然后所有媒体都可以放在这个备用服务器上，并由样式表引用。

对于任何图片或其他媒体都可以这样做。甚至还有几个 WP 插件可用于使用 Flikr.com 等媒体服务

如果您实际上有多个物理服务器要使用，您将在基础 Web 服务器“www.DOMAIN.com”服务器上安装 WordPress。然后您的所有图像都可以驻留在第二个服务器“images.DOMAIN.com”上。接下来，您可以将样式表和 JavaScript 文件放在第三个子域/服务器“scripts.DOMAIN.com”上。然后你的第一个。server 将引用第三台服务器上的样式表，该样式表将访问第二台服务器上的所有媒体文件。

如果您拥有自己的所有硬件，您可能会非常疯狂，并使用某种脚本来镜像 2 台服务器之间的所有文件，并使用硬件负载均衡器来分割 Web 流量并使用日志传送在多台服务器之间镜像您的数据库。 ..但这有点荒谬。

希望这可以帮助。

-约旦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T22:12:07.890

这个问题有点模棱两可，我不确定，但如果域在同一台服务器上，你可以用符号链接替换 ​​wp-content/uploads 。

# c# - “操作对事务的状态无效”错误和事务范围

> ID：193154
> 
> 赞同：79
> 
> 时间：2008-10-10T21:49:52.130
> 
> 标签：c#, .net, sql-server, transactions, transactionscope

当我尝试调用包含 SELECT 语句的存储过程时出现以下错误：

> 该操作对事务的状态无效

这是我的通话结构：

```
public void MyAddUpdateMethod()
{

    using (TransactionScope Scope = new TransactionScope(TransactionScopeOption.RequiresNew))
    {
        using(SQLServer Sql = new SQLServer(this.m_connstring))
        {
            //do my first add update statement

            //do my call to the select statement sp
            bool DoesRecordExist = this.SelectStatementCall(id)
        }
    }
}

public bool SelectStatementCall(System.Guid id)
{
    using(SQLServer Sql = new SQLServer(this.m_connstring)) //breaks on this line
    {
        //create parameters
        //
    }
} 
```

我在事务中创建到同一个数据库的另一个连接有问题吗？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-10-15T01:07:19.267

在做了一些研究之后，似乎我无法使用 TransactionScope 块打开两个连接到同一个数据库。我需要修改我的代码看起来像这样：

```
public void MyAddUpdateMethod()
{
    using (TransactionScope Scope = new TransactionScope(TransactionScopeOption.RequiresNew))
    {
        using(SQLServer Sql = new SQLServer(this.m_connstring))
        {
            //do my first add update statement            
        }

        //removed the method call from the first sql server using statement
        bool DoesRecordExist = this.SelectStatementCall(id)
    }
}

public bool SelectStatementCall(System.Guid id)
{
    using(SQLServer Sql = new SQLServer(this.m_connstring))
    {
        //create parameters
    }
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-02-06T13:26:45.840

当我遇到这个异常时，有一个 InnerException "Transaction Timeout"。由于这是在调试会话期间，当我在 TransactionScope 内暂停我的代码一段时间时，我选择忽略这个问题。

当已部署的代码中出现此特定的超时异常时，我认为 .config 文件中的以下部分将为您提供帮助：

```
<system.transactions> 
        <machineSettings maxTimeout="00:05:00" /> 
</system.transactions> 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2010-11-30T11:36:21.353

我也遇到了同样的问题，我将事务超时更改为 15 分钟，它可以工作。我希望这有帮助。

```
TransactionOptions options = new TransactionOptions();
options.IsolationLevel = System.Transactions.IsolationLevel.ReadCommitted;
options.Timeout = new TimeSpan(0, 15, 0);
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Required,options))
{
    sp1();
    sp2();
    ...

} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T21:55:00.607

当我的事务嵌套在另一个事务中时，我遇到了这个错误。存储过程是否有可能声明自己的事务或调用函数声明一个？

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2020-08-19T11:33:44.073

对于将来遇到这种情况的任何流浪者。如果您的应用程序和数据库位于不同的机器上，并且您遇到上述错误，尤其是在使用 TransactionScope 时，请启用网络 DTC 访问。执行此操作的步骤是：

1.  添加防火墙规则以允许您的机器相互通信。
2.  确保分布式事务协调器服务正在运行
3.  启用网络 dtc 访问。运行 dcomcnfg。转到组件服务 > 我的电脑 > 分布式事务协调器 > 本地 DTC。右键单击属性。
4.  如图所示启用网络 dtc 访问。

**重要提示**：不要编辑/更改 DTC 登录帐户字段中的用户帐户和密码，保持原样，如果这样做，您最终将重新安装 Windows。

[![故障诊断卡照片](https://i.stack.imgur.com/2SaO0.png)](https://i.stack.imgur.com/2SaO0.png)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-05-04T14:10:04.217

对我来说，当我在另一个事务块内遇到异常后尝试回滚事务块时出现了这个错误。

我所要做的就是删除我的内部事务块。

使用嵌套事务时事情可能会变得非常混乱，最好避免这种情况并重新构建代码。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-06-03T21:48:14.457

就我而言，解决方案既不是增加“transactionscope”的时间，也不是增加 machine.config 文件的“system.transactions”的“machineSettings”属性的时间。

在这种情况下，有一些奇怪的事情，因为这个错误只发生在信息量非常大的时候。

所以问题是基于这样一个事实，即在事务内部的代码中有许多“foreach”对不同的表进行更新（我必须在其他人员开发的代码中解决这个问题）。如果在表中的记录很少的情况下执行测试，则不会显示错误，但如果记录数增加，则会显示错误。

最后，解决方案是将单个事务更改为事务内不同“foreach”中的几个单独事务。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-08-10T08:08:44.687

您不能同时打开两个事务。我所做的是在返回将由第二个事务使用的结果之前指定**transaction.Complete() ;)**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-11-15T14:27:57.767

我更新了一些处理部分数据库进程的专有第 3 方库，并在所有调用保存时都出现此错误。我不得不更改 web.config 事务键部分中的值，因为（事实证明）引用的事务范围方法已从一个库移动到另一个库。

以前还有其他与该密钥相关的错误，但我通过注释掉密钥来消除它们（我知道我当时应该怀疑，但我认为它现在是多余的，因为它不在闪亮的新库中）。

# sql - 插入：一种语法更优化还是偏好？

> ID：193155
> 
> 赞同：1
> 
> 时间：2008-10-10T21:50:05.250
> 
> 标签：sql, performance, optimization, insert

SQL 服务器 (2005/2008)

以下每个语句都有相同的结果。有谁知道一个是否优于另一个？

```
insert into SOMETABLE 
  values ('FieldOneValue','FieldTwoValue',3,4.55,'10/10/2008 16:42:00.000')

insert into SOMETABLE 
  select 'FieldOneValue','FieldTwoValue',3,4.55,'10/10/2008 16:42:00.000'

insert into SOMETALBE
  Select
    Field1 = 'FieldOneValue',
    Field2 = 'FieldTwoValue',
    Field3 = 3,
    Field4 = 4.55,
    Field5 = '10/10/2008 16:42:00.000' 
```

当然假设数据类型与表适当匹配......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T21:56:41.057

我认为，基于这个问题，你已经到了[过早优化](http://en.wikipedia.org/wiki/Code_optimization#When_to_optimize)的地步。如果您只是插入 1 条记录，我会坚持使用标准的 insert () values () 并让 Sql Server 团队使其性能最高。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-10T22:31:30.440

我刚刚测试了这个。

这两种方法在两组硬件上进行了 500 万次迭代，一组是 16GB RAM 的服务器，一组是 1GB 的笔记本电脑。

结果：它们看起来是一样的。

这些查询计划是相同的，性能差异在统计上是不显着的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T22:08:21.047

我怀疑如果存在性能差异，它会支持前者，尽管我怀疑存在差异。

然而，这是选择更清晰的版本（即带有 VALUES）提供可读性和可维护性优势的情况之一，这超过了可能微不足道的性能影响。如果您要指定所有值，请遵守通常的约定，以防其他人阅读代码，乍一看似乎是从另一个表执行 INSERT...SELECT，这是一种误导性的外观。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T00:59:15.197

对于 SQL Server，只需使用此模式

INSERT INTO TableName( *fieldList* ) SELECT( *valueList* / *columnList* ) [ *FROM 等*]

这是您唯一需要的插入模式。它无所不能。请指定*字段*列表以保护您的语句免受将来的表更改（添加可选列的位置）。

使用 INSERT INTO VALUES 有一些细微差别，我不记得了，因为我不必这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-10T21:52:33.937

看起来你只是在模仿

```
INSERT into SOMETABLE
(
SELECT * FROM SOMEOTHERTABLE
) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-10T22:10:16.350

*忽略此评论，这是错误的。对于那个很抱歉 ：（*

我知道当您输入多行时，您不能使用 INSERT VALUES()。

INSERT INTO Table SELECT 1, 2, 3, (SELECT 4 FROM Table2 WHERE columnA = columnB)

# apache - Win2k 上的 Apache htaccess 未被处理

> ID：193160
> 
> 赞同：0
> 
> 时间：2008-10-10T21:50:14.767
> 
> 标签：apache, .htaccess, mod-rewrite

我正在尝试使用 mod_rewrite 重写 URL。它在 httpd.conf 中启用，如果这些行在 httpd.conf 文件中，则 url 重写工作。但是，我希望规则在 .htaccess 文件中。Apache 在 Win2k 上似乎根本没有处理 .htaccess。

我将 ReWriteLogging 一路调高，但没有创建日志文件。httpd.conf 的最后一行是

```
AccessFileName .htaccess 
```

.htaccess 内容

```
RewriteEngine on
RewriteLog "c:/rewrite.log" 
RewriteLogLevel 15
RewriteRule /alice.html$ /bob.html 
```

谢谢

编辑：Windows 2k 上的 Apache 2.2 版

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-10T22:01:21.827

检查是否已为受影响的目录`AllowOverride FileInfo`启用`httpd.conf`；另请参阅[http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride](http://httpd.apache.org/docs/2.2/mod/core.html#allowoverride)。您还可以检查`.htaccess`文件本身的权限，以确保没有任何东西阻止 Apache 读取它们。

# python - Python 应用程序的最佳项目结构是什么？

> ID：193161
> 
> 赞同：865
> 
> 时间：2008-10-10T21:50:34.220
> 
> 标签：python, directory-structure, organization, project-structure

想象一下，您想用 Python 开发一个重要的最终用户桌面（不是 Web）应用程序。构建项目文件夹层次结构的最佳方法是什么？

理想的功能是易于维护、IDE 友好、适合源代码控制分支/合并以及易于生成安装包。

尤其：

1.  你把源放在哪里？
2.  您将应用程序启动脚本放在哪里？
3.  你把 IDE 项目放在哪里？
4.  你把单元/验收测试放在哪里？
5.  您将非 Python 数据（例如配置文件）放在哪里？
6.  对于 pyd/so 二进制扩展模块，您将非 Python 源代码（例如 C++）放在哪里？

* * *

## 回答 #1

> 赞同：462
> 
> 时间：2008-10-10T22:03:40.637

没有太大关系。任何让你开心的事情都会奏效。没有很多愚蠢的规则，因为 Python 项目可以很简单。

*   `/scripts`或者`/bin`对于那种命令行界面的东西
*   `/tests`为您的测试
*   `/lib`用于您的 C 语言库
*   `/doc`对于大多数文档
*   `/apidoc`对于 Epydoc 生成的 API 文档。

顶级目录可以包含 README、Config 等。

艰难的选择是是否使用`/src`树。Python不像 Java 或 C 那样区分`/src`、`/lib`和。`/bin`

由于`/src`某些人认为顶级目录毫无意义，因此您的顶级目录可以是应用程序的顶级架构。

*   `/foo`
*   `/bar`
*   `/baz`

我建议将所有这些放在“我的产品名称”目录下。因此，如果您正在编写一个名为 的应用程序`quux`，则包含所有这些内容的目录名为 `/quux`。

`PYTHONPATH`然后，另一个项目的可以包含`/path/to/quux/foo`以重用该`QUUX.foo`模块。

就我而言，因为我使用 Komodo Edit，所以我的 IDE cuft 是单个 .KPF 文件。我实际上将它放在顶级`/quux`目录中，并省略了将其添加到 SVN。

* * *

## 回答 #2

> 赞同：286
> 
> 时间：2011-05-13T23:49:13.033

根据 Jean-Paul Calderone's [Filesystem structure of a Python project](http://as.ynchrono.us/2007/12/filesystem-structure-of-python-project_21.html)：

```
Project/
|-- bin/
|   |-- project
|
|-- project/
|   |-- test/
|   |   |-- __init__.py
|   |   |-- test_main.py
|   |   
|   |-- __init__.py
|   |-- main.py
|
|-- setup.py
|-- README 
```

* * *

## 回答 #3

> 赞同：267
> 
> 时间：2010-08-05T23:29:58.970

[Jean-Paul Calderone 的](https://jcalderone.livejournal.com/39794.html)这篇博文通常在 Freenode 上的#python 中作为答案给出。

> ## Python项目的文件系统结构
> 
> 做：
> 
> *   将目录命名为与您的项目相关的名称。例如，如果您的项目名为“Twisted”，请将其源文件的顶级目录命名为`Twisted`。当你发布时，你应该包含一个版本号后缀：`Twisted-2.5`.
> *   创建一个目录`Twisted/bin`并将您的可执行文件放在那里，如果有的话。不要给它们`.py`扩展名，即使它们是 Python 源文件。除了导入和调用项目中其他地方定义的主函数外，不要在其中放置任何代码。（轻微的皱纹：因为在 Windows 上，解释器是由文件扩展名选择的，所以你的 Windows 用户确实想要 .py 扩展名。所以，当你为 Windows 打包时，你可能想要添加它。不幸的是，没有简单的 distutils 技巧我知道要自动化这个过程。考虑到在 POSIX 上，.py 扩展名只是一个缺点，而在 Windows 上，缺少的是一个实际的错误，如果您的用户群包括 Windows 用户，您可能希望选择只拥有 .py到处扩展。）
> *   如果您的项目可以表示为单个 Python 源文件，则将其放入目录中，并将其命名为与您的项目相关的名称。例如，`Twisted/twisted.py`。如果您需要多个源文件，请改为创建一个包（`Twisted/twisted/`, 为空`Twisted/twisted/__init__.py`）并将源文件放入其中。例如，`Twisted/twisted/internet.py`。
> *   将单元测试放在包的子包中（注意——这意味着上面的单个 Python 源文件选项是一个技巧——你**总是**需要至少一个其他文件来进行单元测试）。例如，`Twisted/twisted/test/`。当然，将其与`Twisted/twisted/test/__init__.py`. 将测试放在像`Twisted/twisted/test/test_internet.py`.
> *   如果您感觉不错，请分别添加`Twisted/README`和来解释和安装您的软件。`Twisted/setup.py`
> 
> 不：
> 
> *   将您的源代码放在名为`src`or的目录中`lib`。这使得不安装就很难运行。
> *   把你的测试放在你的 Python 包之外。这使得很难针对已安装的版本运行测试。
> *   创建一个**只有**a的包，`__init__.py`然后将所有代码放入`__init__.py`. 只需制作一个模块而不是一个包，它更简单。
> *   尝试想出一些神奇的技巧，让 Python 能够导入您的模块或包，而无需用户将包含它的目录添加到他们的导入路径中（通过 PYTHONPATH 或其他一些机制）。您**不会**正确处理所有情况，当您的软件在他们的环境中无法运行时，用户会生您的气。

* * *

## 回答 #4

> 赞同：144
> 
> 时间：2013-11-09T02:22:39.507

查看[以正确的方式开源 Python 项目](https://web.archive.org/web/20201214181824/https://www.jeffknupp.com/blog/2013/08/16/open-sourcing-a-python-project-the-right-way/)。

让我摘录那篇优秀文章的*项目布局*部分：

> 在设置项目时，布局（或目录结构）对于正确处理很重要。合理的布局意味着潜在的贡献者不必永远花时间寻找一段代码；文件位置很直观。由于我们正在处理现有项目，这意味着您可能需要移动一些东西。
> 
> 让我们从顶部开始。大多数项目都有许多顶级文件（如 setup.py、README.md、requirements.txt 等）。然后每个项目都应该有三个目录：
> 
> *   包含项目文档的 docs 目录
> *   以项目名称命名的目录，用于存储实际的 Python 包
> *   两个地方之一的测试目录
>     *   在包含测试代码和资源的包目录下
>     *   作为一个独立的顶级目录为了更好地了解你的文件应该如何组织，这里是我的一个项目的布局的简化快照，sandman：
> 
> ```
> $ pwd
> ~/code/sandman
> $ tree
> .
> |- LICENSE
> |- README.md
> |- TODO.md
> |- docs
> |   |-- conf.py
> |   |-- generated
> |   |-- index.rst
> |   |-- installation.rst
> |   |-- modules.rst
> |   |-- quickstart.rst
> |   |-- sandman.rst
> |- requirements.txt
> |- sandman
> |   |-- __init__.py
> |   |-- exception.py
> |   |-- model.py
> |   |-- sandman.py
> |   |-- test
> |       |-- models.py
> |       |-- test_sandman.py
> |- setup.py 
> ```
> 
> 如您所见，有一些顶级文件，一个 docs 目录（生成的是一个空目录，sphinx 将在其中放置生成的文档），一个 sandman 目录，以及 sandman 下的一个 test 目录。

* * *

## 回答 #5

> 赞同：46
> 
> 时间：2015-06-12T09:23:59.400

“Python Packaging Authority”有一个示例项目：

[https://github.com/pypa/sampleproject](https://github.com/pypa/sampleproject)

它是一个示例项目，作为 Python 打包用户指南的打包和分发项目教程的辅助工具。

* * *

## 回答 #6

> 赞同：27
> 
> 时间：2014-03-21T09:17:46.617

尝试使用[python_boilerplate](https://pypi.python.org/pypi/python_boilerplate_template)模板启动项目。它在很大程度上遵循最佳实践（例如[这里的那些](http://www.jeffknupp.com/blog/2013/08/16/open-sourcing-a-python-project-the-right-way/)），但更适合您发现自己愿意在某个时候将您的项目拆分为多个鸡蛋（相信我，除了最简单的项目之外，您会的。一个常见的情况是您必须使用其他人的库的本地修​​改版本）。

*   **你把源放在哪里？**

    *   对于相当大的项目，将源分成几个鸡蛋是有意义的。每个鸡蛋都将作为单独的 setuptools-layout 在`PROJECT_ROOT/src/<egg_name>`.
*   **您将应用程序启动脚本放在哪里？**

    *   理想的选择是将应用程序启动脚本注册为`entry_point`其中一个鸡蛋。
*   **你把 IDE 项目放在哪里？**

    *   取决于IDE。他们中的许多人将他们的东西保存在`PROJECT_ROOT/.<something>`项目的根目录中，这很好。
*   **你把单元/验收测试放在哪里？**

    *   每个鸡蛋都有一组单独的测试，保存在其`PROJECT_ROOT/src/<egg_name>/tests`目录中。我个人更喜欢用它`py.test`来运行它们。
*   **您将非 Python 数据（例如配置文件）放在哪里？**

    *   这取决于。可以有不同类型的非 Python 数据。
        *   *“资源”*，即必须打包在鸡蛋中的数据。该数据进入相应的 egg 目录，位于包命名空间中的某处。它可以通过来自 的`pkg_resources`包使用`setuptools`，或者从 Python 3.7 开始通过`importlib.resources`标准库中的模块使用。
        *   *"Config-files"*，即被视为项目源文件外部的非 Python 文件，但在应用程序开始运行时必须使用一些值进行初始化。在开发过程中，我更喜欢将此类文件保存在`PROJECT_ROOT/config`. 对于部署，可以有多种选择。在 Windows 上可以使用`%APP_DATA%/<app-name>/config`、 在 Linux 上`/etc/<app-name>`或`/opt/<app-name>/config`.
        *   *生成的文件*，即在执行期间可能由应用程序创建或修改的文件。我更愿意`PROJECT_ROOT/var`在开发过程中保留它们，并`/var`在 Linux 部署期间保留它们。
*   **对于 pyd/so 二进制扩展模块，您将非 Python 源代码（例如 C++）放在哪里？**
    *   进入`PROJECT_ROOT/src/<egg_name>/native`

文档通常会进入`PROJECT_ROOT/doc`或`PROJECT_ROOT/src/<egg_name>/doc`（这取决于您是否将某些鸡蛋视为单独的大型项目）。一些额外的配置将在文件中，如`PROJECT_ROOT/buildout.cfg`和`PROJECT_ROOT/setup.cfg`.

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2008-10-10T22:57:39.013

根据我的经验，这只是一个迭代的问题。将您的数据和代码放在您认为的任何地方。有可能，无论如何你都会错的。但是，一旦您对事情将如何形成有了更好的了解，您就可以更好地进行这些猜测。

至于扩展源，我们在 trunk 下有一个 Code 目录，其中包含一个用于 python 的目录和一个用于各种其他语言的目录。就个人而言，我更倾向于下次尝试将任何扩展代码放入自己的存储库中。

话虽如此，我回到我最初的观点：不要把它搞得太大。把它放在似乎对你有用的地方。如果您发现某些东西不起作用，则可以（并且应该）对其进行更改。

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2008-10-10T22:39:22.063

[使用setuptools](http://peak.telecommunity.com/DevCenter/setuptools)`package_data`中的支持，最好将非 Python 数据捆绑在 Python 模块中。我强烈推荐的一件事是使用命名空间包来创建多个项目可以使用的共享命名空间——很像 Java 将包放入的约定（并且能够拥有一个共享的命名空间）。`com.yourcompany.yourproject``com.yourcompany.utils`

重新分支和合并，如果你使用足够好的源代码控制系统，它甚至可以通过重命名来处理合并；[Bazaar](http://www.bazaar-vcs.org/)尤其擅长这一点。

与此处的其他一些答案相反，我对拥有`src`顶级目录（旁边有`doc`和目录）表示 +1。`test`文档目录树的特定约定将根据您使用的内容而有所不同；[例如， Sphinx](https://www.sphinx-doc.org/)有其快速入门工具支持的自己的约定。

请利用 setuptools 和 pkg_resources；这使得其他项目更容易依赖于您的代码的特定版本（如果您使用的是多个版本，则可以使用不同的非代码文件同时安装`package_data`）。

# java - 好的Java过程控制库

> ID：193166
> 
> 赞同：28
> 
> 时间：2008-10-10T21:54:01.623
> 
> 标签：java, open-source, process

Java 进程控制是出了名的糟糕 - 主要是由于 Java VM/JDK 类（例如 java.lang.Process）的支持不足。

我想知道，是否有任何可靠的优秀开源库。

要求是：

1.  开源软件
2.  启动/停止进程
3.  管理标准输入和标准输出
4.  跨平台（至少依次为 Linux、Windows、Solaris、HP 和 IBM）
5.  （可选）可重新启动
6.  （理想的）成熟的

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-11-11T22:58:11.383

[Apache Commons Exec](http://commons.apache.org/exec/download_exec.cgi)怎么样？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-11T05:39:47.720

[Java Service Wrapper](http://wrapper.tanukisoftware.org/doc/english/download.jsp)可能是您正在寻找的。它是跨平台的，可用于将事物作为 Windows 服务启动、捕获 IO，并且通常可以完全管理任何 Java 应用程序。它的重量非常轻且设计精良。Atlassian 使用它来包装他们的产品（Jira、Bamboo 等），因此它经过了实战考验。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-12-16T20:18:52.120

还有一个要求……跨平台支持杀死孤立的进程。使用`java.lang.Process`（和 Apache Commons Exec），当 Java 应用程序执行硬停止（kill -9）时，无法终止外部进程。我真的很想找到一个可以更好地处理问题的库。

一种解决方案可能是将 PID 存储在磁盘上的某个资源中，然后在 Java 应用程序重新启动时终止进程。当然，这将取决于平台，所以一个好的跨平台库会很棒。

# svn - 颠覆和切换标签

> ID：193170
> 
> 赞同：6
> 
> 时间：2008-10-10T21:56:59.090
> 
> 标签：svn, tags

我的自动部署系统通过颠覆更新了我的站点的最新版本。我没有让我的实时站点指向主干（这几乎总是一个正在进行的版本），而是让我的实时站点指向一个标签。

例如，我在主干上工作，当我的 v1.0 完成后，我创建了一个名为 1.0 的标签，并检查了该标签，这就是我的实时站点。现在，我继续在主干上工作，一段时间后有一个 v2.0。我创建了一个名为 2.0 的标签，我希望我的实时网站类似于这个 2.0 标签。

我可以擦除当前的活动站点并检查这个 2.0 标记。然而，这听起来很容易。我的网站大小约为 1GB，因为其中包含各种 PDF 文档和视频。我可以肯定地说，我进行更新的大部分时间都是复制更改或错误修复。这意味着每次更新可能只有 1% 的网站更改。而且由于我的版本控制只能通过异地 http 连接访问我的网络服务器，这意味着我需要一遍又一遍地下载整个站点。

有没有一种简单的方法可以在标签之间切换并让颠覆只更新这些标签之间的差异？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-10T22:01:22.263

实际上有一个开关功能可以做到这一点。我使用 TortiseSVN，它是 Subversion 的 Windows shell/gui，所以我不熟悉如何手动操作，但这看起来应该有帮助：

[http://svnbook.red-bean.com/en/1.1/ch04s05.html](http://svnbook.red-bean.com/en/1.1/ch04s05.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-10T22:02:59.017

命令行：svn 切换 URL

使用 svn help switch 获得更多细节。

但是，我建议反其道而行之。您的生产站点始终位于主干上，而您在分支上进行开发，这些分支在准备好发布时会合并回主干。在任何给定的版本之后，您可以为历史目的做一个标记。合并后，您只需执行 svn update 即可让您的站​​点运行新代码。

DivMod 将这个想法推向了合乎逻辑的结论，为每个正在处理的问题/工单创建一个分支。您可以[阅读他们对系统的描述](http://divmod.org/trac/wiki/UltimateQualityDevelopmentSystem)；它提供了一些令人信服的论据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T22:21:01.740

我使用类似的设置，但我使用的是实时分支，而不是标签。提交的工作量更大，因为我现在必须将主干中的更改合并到实时分支中，但是我可以在 webroot 中执行“svn up”来更新它。如果我想将来自不同分支的选定更改合并到实时中，它还可以让我更好地控制。

如果我再做一次，我会使用 mercurial（或类似的），因为分支更容易维护，但上述技术已经在 3 个实时站点上工作了大约两年。

# report - 让新手上报告。有益/有害？

> ID：193172
> 
> 赞同：7
> 
> 时间：2008-10-10T21:58:32.753
> 
> 标签：report

根据我的工作经验，大多数刚毕业的程序员都可以创建 6-12 个月左右的报告。虽然我看到了做一些不重要的事情的好处，但这似乎真的让他们望而却步。

所以我的问题是，组织是否应该允许新手与有经验的人一起工作，显然是在做一个项目的非关键阶段，对他们的职业选择有什么真实的感觉，或者把他们扔在报告之外大门？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-10T22:07:05.653

啊，真的没有什么比利用实习生做补习更好的了……

但说真的，你会收回你投入的东西。强迫他们长时间做一个不加思索、吃力不讨好的工作是建立一个无用的团队成员的快速方法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-10T22:01:38.690

也许他们应该在不同的公司寻找工作？也许他们不应该和解？

我曾经是一名应届毕业生，*从未*被要求撰写报告。我在工作的前 5 天内进行了一次编程签到。

也许我对这个问题感到困惑。我们说的是那些申请编程职位并被派去做“报告”相关工作的人？！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-10T22:35:24.347

我没有从“报告”开始。我开始进行转换——只是让东西在新平台上运行。相对安全，较小的编程更改。

然后我做了一段时间的新开发。

然后是另一个转换。

然后 - 在我的职业生涯中 2 年 - 不再是一个完整的 n00b - 我在“报告”中结束了。他们想要一打愚蠢的会计报告之类的东西。每个都是“从总账中提取”、“做一些快速数学”和“写一份柱状报告”。[那是 1980 年，事情就是这样完成的。]

我无法忍受复制和粘贴编程。所以我写了一个从账本中提取到值数组中的东西。它使用灵活的表示法对该数组中的值进行计算，然后写出计算结果。

它可以加、减、乘和除。您可以对一系列“单元”使用多个操作来计算极其复杂的事物。到极限。

我发明了作为 COBOL 批处理程序构建的电子表格。严重地。这就是让某人上报告可能导致的结果。一个程序生成了十几个愚蠢的财务报告。还有大量的附加报告。

奖金。它以敏捷、增量的方式构建。第一个版本做了六个非常简单的报告。下一个又做了两三个。

我不认为“报告”是一个糟糕的演出。不好的是强迫人们从千篇一律的模板中复制和粘贴另一个愚蠢的报告程序。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T22:04:43.317

我相信它是有益的。这是很久以前发生在我身上的事情，它为我提供了一个学习数据库模式、域以及如何使用数据的机会。

但是，如果他们被聘为软件工程师，他们不应该无限期地成为报告作者。然而，程序员/分析师......

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-10T22:06:25.983

这在短期内对公司有利，因为这样你就可以从应届毕业生那里得到有用的工作。从长远来看，这对每个人都是有害的，因为创建报告并不是那么难，所以新手不会从中学到很多东西。

话虽这么说，6 到 12 个月的时间让任何人都坚持做报告（除非他们喜欢它，而大多数人不喜欢）。也许更短的时间会更好地培训新员工。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-10T23:37:47.093

我曾在那些对新员工投入很多的商店工作，结果好坏参半- 诸如“读一本关于 C++ 的书”或“了解这种或那种技术的东西”这样的结束任务。这两种方法都是浪费精力和时间。

在我的店里，如果你是新人，你不会被自己的设备留下来找出 X 或为自己创造忙碌的工作。通常，我们会向您介绍我们的产品，以便您作为用户熟悉它们，然后我们将讨论我们需要您执行的任何任务，执行“我就在这里，告诉我您是否需要帮助”的事情，然后在早上检查他们“你在做什么？” 会议。我店的目标是让开发人员尽快上手，而不会跳过重要的东西。

我认为成功培养新员工的关键，尤其是那些可能刚刚离开学校的员工，就是挑战他们，为他们提供有趣的任务，让他们不再害怕上班。如果你让他们对工作感兴趣，你就会得到一个有价值的员工。有些任务并不有趣，我们都在我的地方做。对我来说，我害怕在 MS Word 附近的任何地方编写正式文档，但有时这与领域有关。“新人”需要意识到它并不总是代码吊索或新开发。有时是维护编码——大部分时间都是这样。有时它是“转动曲柄”类型的工作。有时是写报告。

一位优秀的经理或高级开发人员将指导新员工。如果一家商店不这样做，我可能不想自己在那里工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-10T22:16:44.963

他们应该与他们部门的不同人员进行几周的结对编程（或旁观者编程）。然后他们会了解所有人、结构、代码和有用的技巧。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-10T22:25:21.077

报告是一个精彩的介绍。

与许多其他项目不同，它们往往具有非常具体的规范。它们是一个很好的“独立”任务。它们还向开发人员很好地介绍了域模型，他们必须使用它来实际获取报告中的数据。

最后，它们（通常）相当简单，一些报告框架为它们完成了大部分繁重的工作。所以他们需要专注于学习交易、部署和数据模型的工具。

它们是对更大领域和应用程序的一个很好的渐进式介绍。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-10T22:36:59.523

我从来没有被派去担任安全部门的非重要工作。即使我不知道自己在做什么，我昨天也被安排在人们想要的重要项目上，然后与有特定发展的人配对，他/她想把工作交给新员工。

这种方式效果很好。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-10T23:11:42.230

如果你让一个大学毕业生长期承担撰​​写报告的职责，他会保释你。管理不善，浪费钱...

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-08T04:17:55.457

我在两家不同的公司使用 Crystal Reports 有过两种截然不同的经历：

由于我的第一个雇主（刚从大学毕业），我们的 Crystal Reports 专家要离开了，所以我被要求接任这个职位。没有提供实际培训，所以我必须在工作中学习所有内容，没有供应商或雇主的支持。虽然我的职位描述是作为一名 IT 开发人员，但我最终将 100% 的时间花在了 Crystal Reports 上。对我来说，这是一次徒劳的经历，而且浪费了人力和资源。

我现在的雇主要求我协助另一位开发人员创建和维护他们的 Crystal Reports 设置。因为他们提供了充分的培训，而且我在这个职位上得到了指导，所以我获得了有关多个系统和数据库的知识。我什至有一点管理和维护 SQL Server 的经验。我也有机会与公司的许多不同客户进行互动，因为公司的许多不同部门都需要这些报告。

所以我对最初问题的回答是，它真的取决于组织，而不是中心概念。如果您的雇主打算将其用作让新员工熟悉多个系统的一种方式，那么我认为这是一个好主意。如果这只是将吃力不讨好的工作强加给倒霉的新员工的短期方式，那么我认为这是对人力和资源的浪费。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-10T22:09:05.650

报告的好处是它们不会更新信息，因此不会丢失任何数据。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-10T22:09:14.027

也取决于用于报告的工具。当我做报告时，我学到了很多关于 SQL 和存储过程的知识。当然，这可能不是报告的标准。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-10T23:36:54.973

这取决于报告，也取决于工作。许多报告绝不是微不足道的，需要出色的 SQL 技能来创建高性能且可适当维护的后端。如果你的新手擅长 SQL，让他们在查询上大吃一惊。这将是他们学习数据库架构的好方法。

但是，如果“将它们放在报告中”只是他们徒劳地尝试了几个小时而没有方向或灵感来格式化 Crystal 报告 25（或任何当前版本）中的表格的委婉说法，那么，我想你可能已经知道我的回答那个问题...

# pdf - 如何在链中关闭 ABCpdf 的段落缩进？

> ID：193173
> 
> 赞同：1
> 
> 时间：2008-10-10T22:00:50.597
> 
> 标签：pdf, abcpdf

我正在处理的项目使用名为 ABCpdf 的第 3 方组件来生成 PDF 文档。它具有此功能，您可以将文本从一个内容区域“链接”到下一个内容区域，我们使用它来跨列流动文本。您还可以定义在“段落”开头使用的缩进大小。

这一切都很好，除了现在我刚刚发现，如果我将一段文本交给列底部的 ABCpdf 以便它需要“链接”到下一个的顶部，ABCpdf 认为新的顶部column 是一个新段落的开头，并且在那里也应用缩进。无论是在文档中还是通过实验，我似乎都找不到关闭它的方法。

有没有其他人解决过这个问题？（或者甚至遇到它？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-09T18:41:01.777

而且，如果这对其他人有帮助，我现在有一个答案。

事实证明，这是版本 6 的一个错误 - 升级到新的版本 7 解决了这个问题。V7 仅将缩进放在您期望的位置。

希望这对其他人有帮助。

# ios - 在 iOS 中以编程方式获取自己的电话号码

> ID：193182
> 
> 赞同：334
> 
> 时间：2008-10-10T22:03:53.897
> 
> 标签：ios, iphone, phone-number

有没有办法通过 iPhone SDK 的标准 API 获取自己的电话号码？

* * *

## 回答 #1

> 赞同：324
> 
> 时间：2009-11-06T04:16:35.673

冒着得到负分的风险，我想建议排名最高的解决方案（目前是第一个响应）违反了截至 2009 年 11 月 5 日的最新 SDK 协议。我们的应用程序只是因为使用它而被拒绝。以下是苹果公司的回应：

> “出于安全原因，iPhone OS 将应用程序（包括其首选项和数据）限制在文件系统中的唯一位置。此限制是称为应用程序“沙箱”的安全功能的一部分。沙箱是一组精细的-粒度控制限制应用程序对文件、首选项、网络资源、硬件等的访问。”
> 
> 设备的电话号码在您的应用程序容器中不可用。您需要修改您的应用程序，使其仅在您的目录容器中读取，并将您的二进制文件重新提交到 iTunes Connect，以便您的应用程序重新考虑在 App Store 中使用。

这真是令人失望，因为我们不想让用户输入自己的电话号码。

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2008-10-10T22:58:32.227

不，没有合法和可靠的方法可以做到这一点。

如果您找到了一种方法，它将在未来被禁用，就像以前的每种方法一样。

* * *

## 回答 #3

> 赞同：86
> 
> 时间：2008-10-22T03:09:03.383

**更新：** Apple 似乎在 iOS 4 上或附近删除了该功能

* * *

只是为了扩展较早的答案，这样的事情对我有用：

```
NSString *num = [[NSUserDefaults standardUserDefaults] stringForKey:@"SBFormattedPhoneNumber"]; 
```

**注意**：这会检索在 iPhone 的 iTunes 激活期间输入的“电话号码”，并且可以为空或不正确的值。它**不是**从 SIM 卡中读取的。

至少在 2.1 中是这样。NSUserDefaults 中还有一些其他有趣的键也可能不会持久。（这是在我使用 UIWebView 的应用程序中）

```
WebKitJavaScriptCanOpenWindowsAutomatically
NSInterfaceStyle
TVOutStatus
WebKitDeveloperExtrasEnabledPreferenceKey 
```

等等。

不知道其他人做了什么，如果有的话。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2012-08-30T14:28:04.080

使用 Private API，您可以通过以下方式获取用户电话号码：

```
extern NSString* CTSettingCopyMyPhoneNumber();

+(NSString *) phoneNumber {
NSString *phone = CTSettingCopyMyPhoneNumber();

return phone;
} 
```

还将 CoreTelephony.framework 包含到您的项目中。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2010-05-25T00:03:18.517

你可能都知道如果你使用以下代码行，你的应用程序将被 Apple 拒绝

```
NSString *num = [[NSUserDefaults standardUserDefaults] stringForKey:@"SBFormattedPhoneNumber"]; 
```

这是一个参考

[http://ayeapi.blogspot.com/2009/12/sbformatphonenumber-is-lie.html](http://ayeapi.blogspot.com/2009/12/sbformatphonenumber-is-lie.html)

您可以改用以下信息

```
NSString *phoneName = [[UIDevice currentDevice] name];

NSString *phoneUniqueIdentifier = [[UIDevice currentDevice] uniqueIdentifier]; 
```

等等

```
@property(nonatomic,readonly,retain) NSString    *name;              // e.g. "My iPhone"
@property(nonatomic,readonly,retain) NSString    *model;             // e.g. @"iPhone", @"iPod Touch"
@property(nonatomic,readonly,retain) NSString    *localizedModel;    // localized version of model
@property(nonatomic,readonly,retain) NSString    *systemName;        // e.g. @"iPhone OS"
@property(nonatomic,readonly,retain) NSString    *systemVersion;     // e.g. @"2.0"
@property(nonatomic,readonly) UIDeviceOrientation orientation;       // return current device orientation
@property(nonatomic,readonly,retain) NSString    *uniqueIdentifier;  // a string unique to each device based on various hardware info. 
```

希望这可以帮助！

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2018-07-13T16:34:59.497

您不能单独使用 iOS API 来捕获电话号码（即使在具有私有 API 的私有应用程序中），因为所有已知的执行此操作的方法在 iOS 11 中都已被修补和阻止。即使发现新的漏洞，Apple 已经明确表示他们将拒绝来自应用商店的任何应用使用私有 API 来执行此操作。有关详细信息，请参阅@Dylan 的答案。

但是，**有一种合法的方法可以在不输入任何用户数据的情况下捕获电话号码**。这类似于 Snapchat 所做的，但更简单，因为它不需要用户输入自己的电话号码。

这个想法是让应用程序以编程方式使用应用程序的唯一安装代码将 SMS 消息发送到服务器。然后，该应用程序可以查询同一服务器，以查看它最近是否收到了来自具有此唯一应用程序安装代码的设备的 SMS 消息。如果有，它可以读取发送它的电话号码。这是一个[演示视频](https://vimeo.com/269664301)，展示了该过程。如您所见，它就像一个魅力！

这不是很容易设置，但是使用[此处](http://www.davidgyoungtech.com/2018/07/13/capturing-mobile-phone-numbers)教程中提供的示例代码，可以在几个小时内免费在 AWS 层上免费配置它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-28T09:46:22.560

要获取您的电话号码，您可以阅读 plist 文件。它不适用于未越狱的 iDevices：

```
NSString *commcenter = @"/private/var/wireless/Library/Preferences/com.apple.commcenter.plist";
    NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:commcenter];
    NSString *PhoneNumber = [dict valueForKey:@"PhoneNumber"];
    NSLog([NSString stringWithFormat:@"Phone number: %@",PhoneNumber]); 
```

我不知道 Apple 是否允许这样做，但它适用于 iPhone。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-09-18T23:02:40.603

没有官方 API 可以做到这一点。使用私有 API，您可以使用以下方法：

```
-(NSString*) getMyNumber {
    NSLog(@"Open CoreTelephony");
    void *lib = dlopen("/Symbols/System/Library/Framework/CoreTelephony.framework/CoreTelephony",RTLD_LAZY);
    NSLog(@"Get CTSettingCopyMyPhoneNumber from CoreTelephony");
    NSString* (*pCTSettingCopyMyPhoneNumber)() = dlsym(lib, "CTSettingCopyMyPhoneNumber");
    NSLog(@"Get CTSettingCopyMyPhoneNumber from CoreTelephony");

    if (pCTSettingCopyMyPhoneNumber == nil) {
        NSLog(@"pCTSettingCopyMyPhoneNumber is nil");
        return nil;
    }
    NSString* ownPhoneNumber = pCTSettingCopyMyPhoneNumber();
    dlclose(lib);
    return ownPhoneNumber;
} 
```

它适用于没有 JB 和特殊签名的 iOS 6。

**正如在带有 JB 的 iOS 7**上提到[的 creker](https://stackoverflow.com/questions/193182/programmatically-get-own-phone-number-in-ios#comment35817384_12199204) ，您需要使用权利才能使其正常工作。

 **如何使用您可以在此处找到的权利： [iOS 7：如何通过私有 API 获取自己的号码？](https://stackoverflow.com/questions/19504478/ios-7-how-to-get-own-number-via-private-api)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-08-30T08:17:24.333

AppStore 将拒绝它，因为它到达了应用程序容器之外。

> 应用程序应在其捆绑包中自包含，并且不得在指定容器区域之外读取或写入数据

第 2.5.2 节： [https ://developer.apple.com/app-store/review/guidelines/#software-requirements](https://developer.apple.com/app-store/review/guidelines/#software-requirements)

# c# - 在 C# (.NET 3.5) 中反序列化 xml 时是否可以设置默认值？

> ID：193185
> 
> 赞同：3
> 
> 时间：2008-10-10T22:04:31.353
> 
> 标签：c#, xml, serialization

我有一个小问题，有点令人沮丧。在 C# (.NET 3.5) 中反序列化 xml 时是否可以设置默认值？基本上我试图反序列化一些不受我控制的xml，一个元素看起来像这样：

```
<assignee-id type="integer">38628</assignee-id> 
```

它也可以是这样的：

```
<assignee-id type="integer" nil="true"></assignee-id> 
```

现在，在我的课堂上，我有以下应该接收数据的属性：

```
[XmlElementAttribute("assignee-id")]
public int AssigneeId { get; set; } 
```

这适用于第一个 xml 元素示例，但第二个失败。我尝试将属性类型更改为 int？但这无济于事。我也需要在某个时候将其序列化回相同的 xml 格式，但我正在尝试使用内置的序列化支持，而不必求助于自己的序列化支持。

有没有人有这种问题的经验？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T08:57:53.203

看起来您的源 XML 正在使用 xsi:type 和 xsi:nil，但没有在它们前面加上命名空间。

你可以做的是用 XSLT 处理这些来改变它：

```
<assignees>
  <assignee>
    <assignee-id type="integer">123456</assignee-id>
  </assignee>
  <assignee>
    <assignee-id type="integer" nil="true"></assignee-id>
  </assignee>
</assignees> 
```

进入这个：

```
<assignees xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <assignee>
    <assignee-id xsi:type="integer">123456</assignee-id>
  </assignee>
  <assignee>
    <assignee-id xsi:type="integer" xsi:nil="true" />
  </assignee>
</assignees> 
```

这将由 XmlSerializer 正确处理，而无需任何自定义代码。用于此的 XSLT 相当简单，而且是一个有趣的练习。从众多“复制”XSLT 示例之一开始，然后简单地为“type”和“nil”属性添加一个模板以输出命名空间属性。

如果您愿意，您可以将 XML 文档加载到内存中并更改属性，但这不是一个好主意，因为 XSLT 引擎已针对性能进行了调整，并且可以处理相当大的文件而无需将它们完全加载到内存中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T22:13:21.367

您可能想查看[OnDeserializedAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.ondeserializedattribute.aspx)、[OnSerializingAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.onserializingattribute.aspx)、[OnSerializedAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.onserializedattribute.aspx)和[OnDeserializingAttribute](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.ondeserializingattribute.aspx)以将自定义逻辑添加到序列化过程

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-10T22:07:23.563

XmlSerializer 使用 xsi:nil - 所以我希望您需要为此进行自定义 IXmlSerializable 序列化。对不起。

# .net - XPS 与 Windows 窗体

> ID：193204
> 
> 赞同：5
> 
> 时间：2008-10-10T22:11:26.410
> 
> 标签：.net, wpf, winforms, xps, xpsdocument

在 Windows 窗体应用程序中**显示**和**打印**XPS 文件的最佳方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T22:21:55.297

我认为最简单的方法是使用 WPF，您可以在 WinForms 应用程序中托管 WPF 控件 - 您不必在 WPF 或类似的东西中重写您的 GUI。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/ms745781.aspx](http://msdn.microsoft.com/en-us/library/ms745781.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-15T20:12:21.733

在我的机器上，XPS 文件通过 IE 自动打开。我只需在表单上放置一个 WebBrowser 控件并导航到 XPS 文件，然后调用 Print() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T12:16:50.707

如果您安装了 xps 查看器 EP，我只需调用 Process.Start(XpsRchVw.exe, "pathtofile") 那么这将在 xpsviewer 中打开您的 xps 并允许您使用它来打印编辑等 binks

# oracle - Oracle PL/SQL 脚本中的这个斜杠字符是错误的吗？

> ID：193215
> 
> 赞同：7
> 
> 时间：2008-10-10T22:16:43.620
> 
> 标签：oracle, plsql

我正在为我的公司整理一系列用 Oracle PL/SQL 编写的 SQL 脚本。我遇到了一个基本脚本，底部附近有一个奇怪的斜线。它以这种方式被检入 CVS。这是纯语法错误还是有一些我不知道的功能。稍微混淆的脚本：

```
set serveroutput on size 2000;
--PL/SQL block to link ISSN in serial base on a company's ISSN text file

declare
    cursor ItemCursor is
        select issn is2 from web.obfuscated1 where issn is not null
            union
        select eissn is2 from web.obfuscated1 where eissn is not null;

    cursor ItemCursor1(aIS varchar2) is
        select obfuscated1_uid from web.obfuscated1 where group_num is null and issn in (
            select distinct issn from web.obfuscated1 where issn = aIS or eissn = aIS
                union
            select distinct eissn from web.obfuscated1 where issn = aIS or eissn = aIS
        )
            union
        select obfuscated1_uid from web.obfuscated1 where eissn in (
            select distinct issn from web.obfuscated1 where issn = aIS or eissn = aIS
                union
            select distinct eissn from web.obfuscated1 where issn = aIS or eissn = aIS
        );

    cursor ItemCursor2(aIS9 varchar2) is
        select obfuscated1_uid from web.obfuscated1 where issn in (
            select distinct issn from web.obfuscated1 where issn = aIS9 or eissn = aIS9
                union
            select distinct eissn from web.obfuscated1 where issn = aIS9 or eissn = aIS9
        ) and group_num is null;

    agroup      number(8);
    processCount    number(8);

    ------------------------------------------------------
    -- MAIN BLOCK -----------------------------------
    -------------------------------------------------
begin
    processCount := 0;

    agroup := null;
    for itemRec in ItemCursor loop
        agroup := null;
        begin
            select group_num into agroup from web.obfuscated1 where issn in (
                select distinct issn from web.obfuscated1 where issn = itemRec.is2 or eissn = itemRec.is2
                    union
                select distinct eissn from web.obfuscated1 where issn = itemRec.is2 or eissn = itemRec.is2
            ) and group_num is not null and issn is not null and eissn is not null and rownum <= 1;

        exception
            when no_data_found then
                agroup := null;
            when others then
                agroup := null;
        end;

        if agroup is not null then
            for itemRec2 in ItemCursor2(itemRec.is2) loop
                update web.obfuscated1 set group_num = agroup where obfuscated1_uid = itemRec2.obfuscated1_uid;
                commit;
            end loop;
        else
            processCount := processCount + 1;
            for itemRec1 in ItemCursor1(itemRec.is2) loop
                update web.obfuscated1 set group_num = processCount where obfuscated1_uid = itemRec1.obfuscated1_uid;
                commit;
            end loop;
            commit;
        end if;
    end loop;

    dbms_output.put_line('Total record read: ' || processCount);
exception
    when others then
        dbms_output.put_line('ORA' || sqlcode);
        dbms_output.put_line(substr(sqlerrm, 1, 255));
        dbms_output.put_line('ORA- Error during processing ' );
    end;
/
exit; 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-10T22:20:43.287

斜线有[一个含义](http://download.oracle.com/docs/cd/B28359_01/server.111/b31189/ch12004.htm#SQPUG162)：

> 执行存储在 SQL 缓冲区中的最近执行的 SQL 命令或 PL/SQL 块。您可以在命令提示符或多行命令的行号提示符处输入斜杠 (/)。斜杠命令的功能与 RUN 类似，但不列出该命令。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-27T09:20:53.460

使用 Oracle 时，您“混合”了三种不同的语法。

*   SQL
*   PL/SQL
*   sqlplus（命令行客户端）

sqlplus 可以通过将 SQL 和 PL/SQL 语句发送到 DB 服务器来执行/处理它们。而 sqlplus 命令由 sqlplus 本身解释。

分号“;” 不是 SQL 语法的一部分，sqlplus 将其识别为 SQL 语句的结尾。而对于 PL/SQL，它是语法的一部分，必须明确告诉 sqlplus 语句到此结束，应该使用斜杠执行。

其他 sqlplus 命令是“EXIT”、“DEFINE”“VARIABLE”“PRINT”“SET <something>”（SET ROLE 除外）。

另一方面，当 Toad 看到空行时，它会识别 PL/SQL 块的结尾。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T22:20:21.460

末尾的 / 是告诉解释器执行加载的脚本

基本上你输入东西然后输入“/”，你刚刚输入的内容将执行

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T22:45:54.810

斜杠和“退出”都让我怀疑您应该从 SQLPLUS 运行此脚本。如果您尝试以其他方式将其提交给 Oracle，您可能会收到错误消息。在这种情况下，只需摆脱两者。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T22:39:51.203

这不是错误。它执行脚本。

当您将各种脚本连接到一个文件中并希望每个单独的任务在下一个任务之前执行时，它很有用。

即创建函数/创建使用该函数的存储过程

如果没有斜杠，存储过程可能会创建错误或可能无法创建。

# php - 使用 PHP 和/或 Javascript 进行屏幕抓取？

> ID：193221
> 
> 赞同：0
> 
> 时间：2008-10-10T22:18:39.827
> 
> 标签：php, javascript, image, screen-grab

只是想知道是否可以使用 PHP 脚本或 javascript 屏幕抓取您正在查看的页面？例如，在 iframe 中加载页面，然后将该视图保存为 JPEG？

我敢肯定这是有可能的，但是有没有任何已知的实现/库可以提供帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-10T22:26:13.477

不，抱歉，Javascript 是不可能的，而像 PHP 这样的服务器端语言绝对不可能。（**编辑：**我的意思是不可能截取用户对页面的视图。）

这取决于您要执行此操作的目的，但您可能希望找到一个在服务器端运行并在那里呈现网页的脚本或程序。但是如果你真的想截取用户浏览页面的截图，那几乎是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T22:24:27.427

有一个名为[Webkit2png](http://www.paulhammond.org/webkit2png/)的 python 工具，希望对您有所帮助。但在 PHP 中，我不相信它可能

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T22:26:18.063

您不能在 JS 中执行此操作，但如果您知道要转换为图像的页面的 url，则可以在服务器端执行类似的操作。

可以从 php 调用像[khtml2png这样的工具来呈现页面。](http://khtml2png.sourceforge.net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-08-30T11:01:21.073

[http://html2canvas.hertzen.com/](http://html2canvas.hertzen.com/)可能会成功。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T22:32:02.997

可以使用 GD2 扩展和一些您正在捕获的内部知识 -[请阅读此处](http://blog.thepimp.net/archives/Screen-capture-with-PHP-and-GD.html)作为示例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T22:31:42.873

谢谢你们的帮助。我确实找到了这个有趣的资源：

[http://www.zubrag.com/scripts/website-thumbnail-generator.php](http://www.zubrag.com/scripts/website-thumbnail-generator.php)

无论如何，它都不是特定于 PHP 的，只是运行 PHP 调用的 EXE 脚本的示例。我相信需要一个 Windows 服务器。

# apache-flex - XIFF 实施的好例子或文档？

> ID：193240
> 
> 赞同：1
> 
> 时间：2008-10-10T22:30:49.363
> 
> 标签：apache-flex, actionscript-3, actionscript, xmpp, xiff

[XIFF](http://www.igniterealtime.org/projects/xiff/)是[XMPP](http://en.wikipedia.org/wiki/Jabber)协议在 actionscript 中的实现。

到目前为止，我看到的所有示例和文档都很稀少。有谁知道最新版本的 XIFF 和/或工作 Flex/AIR 应用程序的好例子的一个很好的解释？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T17:33:32.647

是的，网上没有很多好的例子/文档。

查看：

[http://www.mikechambers.com/blog/index.php?s=xiff](http://www.mikechambers.com/blog/index.php?s=xiff)

举几个例子来说明如何开始。

麦克风

# sql - 在 MS SQL Server 中，有没有办法“原子地”增加用作计数器的列？

> ID：193257
> 
> 赞同：39
> 
> 时间：2008-10-10T22:39:25.557
> 
> 标签：sql, sql-server-2005, transactions

假设 Read Committed Snapshot 事务隔离设置，在您永远不会“丢失”并发增量的意义上，以下语句是“原子的”吗？

```
update mytable set counter = counter + 1 
```

我假设在一般情况下，这个更新语句是更大事务的一部分，它不会是。例如，我认为这种情况是可能的：

*   更新事务 #1 中的计数器
*   在事务 #1 中做一些其他的事情
*   使用事务 #2 更新计数器
*   提交事务#2
*   提交事务#1

在这种情况下，计数器最终不会只增加 1 吗？如果这是交易中的唯一声明，它会有所不同吗？

像 stackoverflow 这样的网站如何为其问题视图计数器处理这个问题？或者“失去”一些增量的可能性只是被认为是可以接受的？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-04-23T02:27:53.687

根据 MSSQL 帮助，您可以这样做：

```
UPDATE tablename SET counterfield = counterfield + 1 OUTPUT INSERTED.counterfield 
```

这会将字段更新一，并将更新后的值作为 SQL 记录集返回。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-11T00:21:51.717

Read Committed Snapshot 只处理从表中选择数据的锁。

但是，在 t1 和 t2 中，您正在更新数据，这是一种不同的情况。

当您更新计数器时，您升级为写锁（在行上），防止发生其他更新。t2 可以读取，但 t2 将阻止其 UPDATE 直到 t1 完成，并且 t2 将无法在 t1 之前提交（这与您的时间线相反）。只有其中一个事务会更新计数器，因此在给出的代码的情况下，两者都将正确更新计数器。（已测试）

*   计数器 = 0
*   t1 更新计数器（计数器 => 1）
*   t2 更新计数器（阻塞）
*   t1 提交（计数器 = 1）
*   t2 畅通（现在可以更新计数器）（计数器 => 2）
*   t2 提交

* * *

Read Committed 仅意味着您只能读取已提交的值，但这并不意味着您具有可重复读取。因此，如果您使用并依赖于 counter 变量，并打算稍后对其进行更新，那么您可能会在错误的隔离级别上运行事务。

您可以使用可重复读锁，或者如果您只是偶尔更新计数器，您可以使用乐观锁技术自己完成。例如带有计数器表的时间戳列，或条件更新。

```
DECLARE @CounterInitialValue INT
DECLARE @NewCounterValue INT
SELECT @CounterInitialValue = SELECT counter FROM MyTable WHERE MyID = 1234

-- do stuff with the counter value

UPDATE MyTable
   SET counter = counter + 1
WHERE
   MyID = 1234
   AND 
   counter = @CounterInitialValue -- prevents the update if counter changed.

-- the value of counter must not change in this scenario.
-- so we rollback if the update affected no rows
IF( @@ROWCOUNT = 0 )
    ROLLBACK 
```

这篇[devx](http://www.devx.com/codemag/Article/21570)文章提供了丰富的信息，尽管它讨论了仍处于测试阶段的功能，因此它可能并不完全准确。

* * *

更新：正如Justice所指出的，如果t2是t1中的嵌套事务，则语义不同。同样，两者都会正确更新计数器（+2），因为从 t2 在 t1 内部的角度来看，计数器已经更新了一次。嵌套的 t2 无法访问 t1 更新它之前的计数器。

*   计数器 = 0
*   t1 更新计数器（计数器 => 1）
*   t2 更新计数器（嵌套事务）（计数器 => 2）
*   t2 提交
*   t1 提交（计数器 = 2）

对于嵌套事务，如果 t1 在 t1 COMMIT 之后发出 ROLLBACK，计数器将返回到它的原始值，因为它也撤消了 t2 的提交。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-10T22:45:00.583

不，这不对。该值以共享模式读取，然后以独占模式更新，因此可能会发生多次读取。

要么使用可序列化级别，要么使用类似的东西

```
update t
set counter = counter+1
from t with(updlock, <some other hints maybe>)
where foo = bar 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T00:43:50.733

本质上只有一笔交易，最外层的一笔交易。内部事务更像是事务中的检查点。隔离级别仅影响同级最外层事务，而不影响父/子相关事务。

计数器将增加 2。下面产生一个值为 (Num = 3) 的行。（我打开 SMSS 并将其指向本地 SQL Server 2008 Express 实例。我有一个名为 Playground 的数据库用于测试。）

```
use Playground

drop table C
create table C (
    Num int not null)

insert into C (Num) values (1)

begin tran X
    update C set Num = Num + 1
    begin tran Y
        update C set Num = Num + 1
    commit tran Y
commit tran X

select * from C 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-26T19:21:59.217

我使用这个 SP 来处理 name 最初没有计数器的情况

```
ALTER PROCEDURE [dbo].[GetNext](
@name   varchar(50) )
AS BEGIN SET NOCOUNT ON

DECLARE @Out TABLE(Id BIGINT)

MERGE TOP (1) dbo.Counter as Target
    USING (SELECT 1 as C, @name as name) as Source ON Target.name = Source.Name
    WHEN MATCHED THEN UPDATE SET Target.[current] = Target.[current] + 1
    WHEN NOT MATCHED THEN INSERT (name, [current]) VALUES (@name, 1)
OUTPUT
    INSERTED.[current];
END 
```

# svn - 简化 VisualSVN 服务器的 URL

> ID：193260
> 
> 赞同：1
> 
> 时间：2008-10-10T22:40:39.843
> 
> 标签：svn, friendly-url, visualsvn-server

我们目前正在将一个`svnserve`实例作为 NT 服务运行。虽然这可行，但管理起来不必要的麻烦，我想继续使用更简单的 VisualSVN 服务器。（额外的好处包括 Windows 集成的身份验证，并且多亏了 HTTP/WebDAV，可以浏览最新版本。）

也就是说，当前服务器提供的 URL 如下所示：

```
svn://oldserver/path/to/some/file.foo 
```

比较难忘。

新的，通过 VSVNS 设置：

```
https://newserver:8443/svn/Repos/path/to/some/file.foo 
```

哎哟。一方面，这`/svn`一位*完全*没有必要。由于 VSVNS 运行自己的 HTTP 服务器（这就是为什么它在特殊端口上`8443`，毕竟），*当然*一切都与`svn`. 此外，我们只有一个存储库（实际上不需要更多），所以存储库名称`/Repos`也不应该在那里——我们可以用 关闭它`svnserve`，所以现在也应该有办法做到这一点。

*   是否可以将 VisualSVN 服务器配置为删除`/svn`？（为什么要开始呢？）
*   鉴于只有一个存储库，我可以告诉它不要将存储库名称作为 URL 的一部分吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-10T22:51:37.013

您可以将 apache 位置配置为使用**SVNPath**而不是**SVNParentPath**。它位于 httpd.conf 的 <Location>-Block 内，您还应该将此块重命名为存储库的名称。然后你的 URL 的 ../svn/.. 部分就消失了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T15:13:06.143

您可以使用库存的 Collabnet SVN 安装程序并按照您的喜好配置 Apache。

除了普通的 SVN 安装之外，VisualSVN 有什么特别引人注目的地方吗？

# java - 服务器端 CSS 选择器

> ID：193269
> 
> 赞同：6
> 
> 时间：2008-10-10T22:47:43.107
> 
> 标签：java, html, coldfusion, css-selectors

我正在创建一个工具，它将检查动态生成的 XHTML 并根据预期内容对其进行验证。

我需要确认结构正确并且特定属性存在/匹配。可能还有其他我不感兴趣的属性，因此不适合直接进行字符串比较。

验证这一点的一种方法是使用 XPath，我已经实现了这一点，但我也想要一些不那么冗长的东西 - 我希望能够使用 CSS 选择器，就像我可以使用 jQuery 一样，但是在服务器上 - 在 CFML 代码中 -而不是在客户端。

**是否有 CFML 或 Java 库允许我针对 XHTML 字符串使用 CSS 选择器？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-07T12:03:53.703

我刚刚发布了一个开源项目，它是 Java 中的 W3C CSS Selectors Level 3 实现。请试一试。我一直在寻找同样的东西，并决定实现我自己的引擎。它的灵感来自 WebKit 等中的代码。

[http://github.com/chrsan/css-selectors/tree](http://github.com/chrsan/css-selectors/tree)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T23:59:14.960

我不知道 Java 库本身，但是有一个名为[Hpricot](http://code.whytheluckystiff.net/hpricot/)的 Ruby 库可以完全满足您的需求。结合 Java 平台上的 Ruby 实现[JRuby](http://jruby.codehaus.org/)，从 Java 代码调用 Ruby 方法应该相对简单（使用 BSF、[JSR-222 脚本 API](http://wiki.jruby.org/wiki/Java_Integration)或[内部 API](http://wiki.jruby.org/wiki/Direct_JRuby_Embedding)）。

您使用的是 Coldfusion 8 吗？Coldfusion 8 基于 Java 6，支持 JSR-222 脚本 API“javax.scripting”。

看看[这篇关于在 CFML 中嵌入 PHP 的博客文章](http://corfield.org/blog/index.cfm/do/blog.entry/entry/ColdFusion_8_running_PHP)。您应该能够对**Ruby 做同样的**事情。这篇博文中链接了 ZIP 文件示例代码，如果你打开 CFML，你会看到一个在 CFML 中嵌入 Ruby 的好例子。

尽管使所有部分一起工作可能需要一些工作，但通过一些投资，它应该为您提供您正在寻找的强大的解析/CSS 选择器查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-24T14:40:31.263

如果 JRuby-route 对您开放，Hpricot 绝对是一个很棒的解决方案。

写。XPath 是访问 XML 文档的“正确”方式……抱歉，这是垃圾。访问 XML 文档元素的方法有很多种：DOM 遍历、XPath、XQuery、CSS 选择器等等。XPath 肯定很流行，但 CSS 选择器非常强大，假设您的 XML 文档具有 HTML 语义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-08-22T17:00:05.800

如果你可以在你的 CFML 中使用 PHP（如上所述），你可以利用这个优秀的“jQuery for PHP”库，[phpQuery](http://code.google.com/p/phpquery/)

完整的 CSS 选择器支持、操作函数、遍历等。它应该可以很好地满足您的需求。

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T00:11:39.240

服务器和客户端之间存在理论上的差异。对于 Web 浏览器，文档是一个活生生的 DOM 层次结构。对于您的服务器代码，它只是一个任何类型的 XML 文档。XPath 是访问 XML 文档元素的“正确”方式。

因此，除非您当前的 XPath 解决方案存在严重的性能问题，或者它实际上不能正常工作，否则我建议您坚持使用它。尝试一些太聪明的东西会带来破坏正在工作的东西的风险。

如果您发现 XPath*过于*冗长和丑陋而无法闲置，或者想要在不同情况下重用该工具，或者只是无法抗拒尝试做一些聪明的事情，那么您可以尝试编写一个实用程序将给定的 CSS 选择器编译成 XPath。然后，您可以在需要时在一行中调用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-01-25T16:16:40.670

使用 cQuery.com 可能更容易 - cQuery.com 是一个基于 API 的“内容查询引擎”，通过使用 CSS 从实时网站中提取内容。

您可以在您的应用程序中以编程方式使用它。

# svn - 可以将 CVS 和 Subversion 设置为在合并时忽略空格吗？

> ID：193271
> 
> 赞同：21
> 
> 时间：2008-10-10T22:50:02.523
> 
> 标签：svn, version-control, cvs, whitespace

CVS 和 Subversion 都具有方便的合并功能，因此当您更新已修改的源文件时，它会合并其他人对同一文件所做的更改。

但是，如果您的更改与其他更改不兼容 - 通常如果您都更改了代码的相同部分 - 这将产生冲突。这两段源代码都将包含在合并文件中，您需要手动整理出要保留的更改。到目前为止一切都很好。

我的问题是我们中的一些人使用不同的开发环境（Netbeans 与 vi，如果你必须知道的话）并且 Netbeans 具有自动缩进功能，可以重新缩进代码。因此，当我们合并更改时，有时会发生巨大的冲突，这主要是由于缩进的简单更改引起的，而不是对代码的真正更改。这些通常会产生数百行明显的冲突，必须手动解决，但通常它们归结为几行真正的更改。当某人的编辑器将 unix 更改为 Windows 换行符时，也会发生类似的情况，反之亦然。

那么 - 在比较两个版本时，我可以设置合并以忽略这些“冲突”吗？Diff 具有 --ignore-space-change 或 -b 选项，我希望在 cvs 或 svn 中具有基本相同的功能。我们在不同的项目中使用每种工具，所以我很乐意得到其中一个或两个的答案。

最后的两个注意事项：

*   显然，合并过程必须任意选择在合并文件中使用哪个版本的空白。我很好 - 我们以后总是可以重新格式化它。
*   我可以通过更加自律和更频繁地检查来避免其中的一些 - 承认和理解。但我并不完美。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-10T22:57:22.183

对于 SVN：在命令行工具中，您可以将选项**-x**设置为“ **b** ”或“ **w** ”以忽略空间更改。所有空间。
您还可以提供第三方工具来进行合并。所以如果你有一个忽略空格的合并，你可以使用这个。TortoiseSVN 一如既往地是所有参数的前端，因此它也支持忽略空格。

[此处](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.ref.svn.c.merge)描述了 svn merge 命令。您需要的选项是**--diff3-cmd**

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T23:16:12.020

对于 Windows 用户，您可以使用[TortoiseSVN](http://tortoisesvn.net/)（Subversion 的 Windows Explorer shell 扩展），它带有支持您所描述内容的[合并功能：](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-diff.html#tsvn-dug-diff-eol-whitespace)

> 忽略行尾不包括仅由于行尾样式差异引起的更改。
> 
> 比较空格包括缩进和内联空格中的所有更改作为添加/删除的行。
> 
> 忽略空格更改不包括仅由于空格的数量或类型的更改而导致的更改，例如。更改缩进或将制表符更改为空格。在以前没有空格的地方添加空格或完全删除空格仍显示为更改。
> 
> 忽略所有空格会排除所有仅限空格的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-27T05:14:02.923

TortoiseMerge 没有任何 CLA（命令行参数）来忽略空格并忽略大小写。经过大量搜索后，似乎仍然可以通过调整注册表值来实现。

```
/* DisableWhitespaceDifferences and DisableCaseDifferences. 
* The settings for TortoiseMerge is stored in Registry in CurrentUser\Software\TortoiseMerge\
* DWORDS stored the property values.
* 
* IgnoreWS         :   Set to 1 to ignore the whitespace differences. 
*                      Set to 0 to allow the whitespace differences.             
* IgnoreEOL        :   Set to 1 to ignore the End of Line differences. 
*                      Set to 0 to allow the End of Line differences.             
* CaseInsensitive  :   Set to 1 to ignore the Case differences. 
*                      Set to 0 to allow the Case differences.             
*/

// Get the key from the registry
using (RegistryKey key = Registry.CurrentUser.OpenSubKey(@"Software\TortoiseMerge", true))
{
   if (key != null)
   {
        // Set the IgnoreWS and IgnoreEOL DWORDs based on DisableWhitespaceDifferences is set or not
        key.SetValue("IgnoreWS", DisableWhitespaceDifferences ? 1 : 0, RegistryValueKind.DWord);
        key.SetValue("IgnoreEOL", DisableWhitespaceDifferences ? 1 : 0, RegistryValueKind.DWord);

        // Set the CaseInsensitive DWORD based on DisableCaseDifferences is set or not
        key.SetValue("CaseInsensitive", DisableCaseDifferences ? 1 : 0, RegistryValueKind.DWord);

        // close key
        key.Close();
    }
} 
```

# php - 获取.htaccess 指向的文件的文件名？

> ID：193273
> 
> 赞同：1
> 
> 时间：2008-10-10T22:53:38.647
> 
> 标签：php, .htaccess, image, dynamic

我正在为不允许动态图像的论坛制作动态图像。

我尝试使用 .htacess 将所有 *.png 文件重定向到 image.png ... 效果很好，但是从这里我似乎无法获取生成内容所请求的 .png 的文件名。

例如：

1.  用户输入banana.png

2.  htaccess 转发到 image.php

我需要一种将香蕉放入我的 php 脚本的方法。

使用`$_SERVER['REQUEST_URI']`并`$_SERVER["SCRIPT_NAME"]`仅返回 PHP 文件的内容。

有没有办法将它重定向到`image.php?=bananana`例如？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T12:59:20.297

```
RewriteEngine on
RewriteRule ^(.+)\.png$ image.php?file=$1 [L,QSA] 
```

如果这不起作用，您可能没有启用 mod_rewrite。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-10T22:56:36.537

试试这个。您应该能够访问 $_GET['image'] 处的图像路径。如果需要，增加了保留现有查询字符串的能力，（但图像键显然会被覆盖）。

如果你仍然得到 404，我不知道该说什么。我对此进行了测试，它对我有用。

```
RewriteRule ^(.*\.png)$ image.php?%{QUERY_STRING}&image=$1 [L] 
```

# cross-platform - 每种主要语言和平台的利用率是多少？

> ID：193275
> 
> 赞同：-1
> 
> 时间：2008-10-10T22:55:29.580
> 
> 标签：cross-platform, programming-languages

我很想知道有多少开发人员使用每种主要语言/平台，但我最近找不到任何好的调查。如果您知道任何好的数据，请提供一个链接以及调查方法的简要概要（他们调查了谁以及如何调查等）及其结论（16% 的开发人员使用 Java，12% 使用 RoR 等）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-10T23:01:58.990

我与[Tiobe 指数](http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html)没有任何关系：这类问题经常被引用。它的准确性和方法有时会受到质疑，因为这些指标一定非常困难。

有关更多信息，请参阅[Dobb 博士的这篇文章](http://www.ddj.com/development-tools/207401593)...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T22:59:12.257

可能最接近任何目标的方法是在可能的范围内汇总开发平台供应商的收入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-10T23:48:58.707

招聘广告可以表明该行业的目标。这是英国的一些[统计数据。](http://www.itjobswatch.co.uk/jobs/uk/c++%20developer.do)

虽然不是直接你所追求的，但它可能很有趣。

# .net - Visual Studio 2005 与 2008 - 有什么好处？

> ID：193281
> 
> 赞同：10
> 
> 时间：2008-10-10T22:57:46.253
> 
> 标签：.net, visual-studio, visual-studio-2008, visual-studio-2005

从 Visual Studio 2005 升级到 2008 有什么好处？

关于是否值得一试，或者等待接下来发生的事情是否更好？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-10T23:05:41.557

有很多改进。最好的部分是您可以继续使用 VS 2008（[多目标](http://weblogs.asp.net/scottgu/archive/2007/06/20/vs-2008-multi-targeting-support.aspx)）定位 .Net 2.0 并使用所有新的 IDE 功能。

发布几个截屏视频，但您可以在网上找到更多信息：

[Visual Studio 2008 中的脚本智能感知和调试](http://channel9.msdn.com/posts/DanielMoth/Script-intellisense-and-debugging-in-Visual-Studio-2008/)

[Visual Studio 2008 中的多线程调试增强功能](http://channel9.msdn.com/posts/DanielMoth/Multi-threading-Debugging-Enhancements-in-Visual-Studio-2008/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-10T23:13:58.780

我最喜欢的新功能：当智能选项框显示时，您可以按住控件使其半透明并查看其背后的代码。有很多更大的新功能和切换的理由，但这对我来说是一个真正的胜利。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-10T23:31:02.067

如果您只是想升级到 3.0 和/或 3.5 框架的“大部分”新功能，则无需升级 Visual Studio。你可以升级你的框架。但是，有一些优点，比如一个新的编译器（如果我记得的话，这是使用 Linq 所必需的），以及一些不错的改进，比如 JavaScript 调试。

有很多关于这个确切主题的好文章，包括这篇文章，[Visual Studio 2008 的 22 个新功能](http://msdotnetsupport.blogspot.com/2007/11/22-new-features-of-visual-studio-2008.html)，您可能想要查看。

希望有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T23:16:23.157

2008 包括进入.Net 框架的能力。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-11T01:20:03.830

HTML 和预览屏幕之间的[垂直分割。](http://weblogs.asp.net/scottgu/archive/2007/07/30/enabling-vertical-split-view-in-vs-2008.aspx)在宽屏显示器上尤其方便。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T23:22:10.417

我在上一份工作中受益匪浅的一大特点是：提高了稳定性。我们有一个高度线程化的应用程序，它会导致 VS2005 崩溃（以多种方式）。切换到 2008 年，此类事件减少了 100 倍。

另外——对于同一个项目，VS2005 比 VS2008 占用更多的 RAM。至少对于大型解决方案（例如 50 个项目）。我认为，这使得 VS2008 比 VS2005 对我来说更灵敏/响应迅速。

是的，值得升级 - 只是从一个简单的稳定性因素。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-11T01:15:29.703

我喜欢 IDE 支持使用以下新技术创建应用程序

*   LINQ
*   银光
*   WPF
*   ASP.NET MVC

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-11T01:12:41.427

我会有点不同意最后一个帖子。我的稳定性并没有大大提高。我在构建过程中锁定了 2K8。什么？但总而言之，我喜欢这个版本就是因为 linq。现在我喜欢 2005 年引入的泛型，但 linq 让 2008 年变得值得，然后一些。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-10T23:11:47.130

看看[这个问题](https://stackoverflow.com/questions/46036/upgrading-to-visual-studio-2008-from-2005)……之前已经讨论过了。

尽管我要重复一遍，我喜欢 VS 2008 的主要原因是它们使用 Expression Web GUI 进行 Web 应用程序开发。它比 VS2K5 所拥有的要好得多。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-11T01:38:16.147

类型化数据集设计器生成的代码更加干净整洁，尤其是在使用 SQL Compact Edition 数据库时。

# objective-c - 在 Cocoa 中使用 autorelease 的成本是多少？

> ID：193288
> 
> 赞同：11
> 
> 时间：2008-10-10T23:00:13.113
> 
> 标签：objective-c, cocoa, memory-management

大多数 Apple 文档似乎都避免使用自动释放对象，尤其是在创建 gui 视图时，但我想知道使用自动释放对象的成本是多少？

```
UIScrollView *timeline = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 20, 320, 34)];
[self addSubview:timeline];
[timeline release]; 
```

最终，我是否应该使用自动释放所有内容的策略，并且使用保留/释放应该是特定情况下规则的例外？还是我通常应该使用保留/释放，而自动释放是从 [NSString stringWithEtc...] 等便捷方法返回的对象的例外？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-10-11T04:23:37.030

有两种费用：

1.  （假设您可以选择避免自动释放对象。）您实际上不必要地延长了对象的生命周期。这可能意味着您的内存占用量会不必要地增加。在受限平台上，这可能意味着如果您的应用程序超出限制，则会终止。即使你没有超过限制，也可能导致你的系统开始交换，这是非常低效的。

2.  查找当前自动释放池，将自动释放的对象添加到其中，然后在最后释放对象（额外的方法调用）的额外开销。这可能不是很大的开销，但它可以加起来。

任何平台上的最佳实践都是尽可能避免自动释放。

要回答问题：

> 最终，我是否应该使用自动释放所有内容的策略，并且使用保留/释放应该是特定情况下规则的例外？

恰恰相反。

> 还是我通常应该使用保留/释放，而自动释放是从 [NSString stringWithEtc...] 等便捷方法返回的对象的例外？

如果可以的话，您应该*始终*使用保留/释放——在`NSString`通常不需要使用`stringWithEtc`方法的情况下，因为有`initWithEtc`等效方法。

另请参阅[此问题](https://stackoverflow.com/questions/155964/what-are-best-practices-that-you-use-when-writing-objective-c-and-cocoa#175874)。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-12T16:23:40.353

我不得不不同意 Jim Puls - 我认为**不**使用 Autorelease 会使调试更加困难，因为您更有可能发现自己意外泄漏内存。当然，Clang 静态分析器可以提取其中一些实例，但对我来说，习惯使用自动释放的轻微开销成本远远超过了我的代码不太可能出现错误的情况。

然后，只有当我有一个需要优化的紧密循环时，我才会开始关注性能。否则这一切都只是过早的优化，这通常被认为是一件坏事。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-11T07:42:29.830

我很惊讶还没有人提到这一点。当你可以避免自动释放对象的最大原因与性能无关。是的，这里提到的所有性能问题都是*绝对*有效的，但自动释放的最大缺点是它使调试变得更加困难。

如果您有一个从不自动释放的过度释放对象，那么追踪起来非常容易。如果您有用户报告的崩溃，并且在 NSPopAutoreleasePool 以南某处回溯间歇性发生，那么祝您好运...

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-22T19:47:33.383

这些天我通常使用自动释放的对象，因为它们往往会导致更简单、更容易阅读的代码。您声明并初始化它们，然后让 drop 超出范围。从机械上讲，它们存在的时间要长得多，但从编写代码的人的角度来看，它相当于在 C++ 中声明的堆栈对象在函数返回并且其框架被销毁时自动被销毁。

虽然存在效率损失，但在大多数情况下并不显着。更大的问题是存在的对象越多，以后的内存恢复会导致地址空间更加碎片化。如果这是一个问题，通常很容易进入并通过一些热门方法切换到手动保留/释放并改进它。

正如其他人所说，可读性胜过非性能敏感代码的性能。在许多情况下，使用自动释放的对象会导致更多的内存碎片，但在任何情况下，对象的寿命都不会超过池。在这些情况下，您付出的唯一代价就是找到找到正确的自动释放池的成本。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-22T04:57:44.413

使用自动释放池的一个*好处*是它们在不使用`@try`/的情况下是异常安全的`@finally`。Greg Parker ('Mr. Objective-C') 有一篇[很棒的文章](http://sealiesoftware.com/blog/archive/2008/09/16/objc_explain_Exceptions_and_autorelease_pools.html)解释了这个细节。

我倾向于使用`autorelease`很多，因为它的代码更少，并且更具可读性，IMO。正如其他人指出的那样，缺点是您延长了对象的生命周期，因此暂时使用了更多内存。在实践中，我还没有发现`autorelease`在我编写的任何 Mac 应用程序中过度使用是一个重大问题。如果高内存使用似乎确实是一个问题（这不是由真正的泄漏引起的），我只需添加更多的自动释放池（在分析后向我展示我需要它们的位置）。但是，总的来说，这种情况非常罕见。正如 Mike Ash 的帖子所示（Graham Lee 链接到它），自动释放池的开销很小且速度很快。添加更多自动释放池的成本几乎为零。

当然，这一切都适用于 Mac 应用程序。在内存更紧张的 iPhone 应用程序中，您可能希望在使用自动释放时保持保守。但与往常一样，首先编写可读代码，然后*通过测量*慢速/内存密集型部分的位置进行优化。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-11T07:36:09.887

费用是：

1.  定位当前线程的自动释放池并将对象添加到其中的时间。
2.  对象在稍后释放之前占用的内存。

如果您想非常保守地使用内存，则应避免自动释放。但是，它是一种有用的技术，可以使代码更具可读性。过分使用保留/释放属于“过早优化”的范畴。

如果您在 Cocoa 的主事件处理线程中（大部分时间都在），则当控制权返回到事件处理程序时，自动释放池将被清空。如果您的方法很短并且不会遍历大量数据，那么使用 autorelease 将释放延迟到运行循环的末尾就可以了。

警惕自动释放的时间是当您处于循环中时。例如，您正在遍历用户的通讯录，并可能为每个条目加载一个图像文件。如果所有这些图像对象都是自动释放的，它们将在内存中累积，直到您访问了整个地址簿。如果通讯簿足够大，您可能会耗尽内存。如果您在处理完图像后立即释放它们，那么在循环中，您的应用程序可以回收内存。

如果您无法避免循环内的自动释放（这是由您未编写且无法更改的代码完成的），您还可以根据需要在循环内自行管理 NSAutoreleasePool。

因此，请注意在循环内使用 autorelease（或可能从循环调用的方法），但不要避免它可以使代码更具可读性。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-10T23:44:40.683

据我了解，使用自动释放的主要缺点是您不知道对象何时最终会被释放和销毁。如果您有很多自动释放的对象挂在周围但尚未释放，这可能会导致您的应用程序使用比所需更多的内存。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-12T13:10:23.583

其他人回答了您是否应该自动释放，但是当您*必须*自动释放时，请尽早排水并经常排水： http: [//www.mikeash.com/? page=pyblog/autorelease-is-fast.html](http://www.mikeash.com/?page=pyblog/autorelease-is-fast.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-15T14:17:00.153

我注意到您提供的代码示例适用于 iPhone。Apple 特别建议避免为 iPhone 应用程序自动释放对象。我找不到具体的原因，但他们在 WWDC 上强调了这一点。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-15T13:57:17.043

要记住的一个注意事项是，如果您正在生成一个新线程，则必须在执行任何其他操作之前在该线程上设置一个新的自动释放池。即使您不使用自动释放对象，也可能是 Cocoa API 中的某些东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-03-30T15:53:57.540

旧线程，但为了新读者的利益而努力。

我使用自动释放与保留/释放，具体取决于特定于对象的自动释放错误的风险和对象的大小。如果我只是在我的视图中添加一些微小的 UIImageViews 或几个 UILabels，那么 autorelease 会保持代码的可读性和可管理性。当视图被移除和释放时，这些子视图应该很快就会被释放。

另一方面，如果我们谈论的是 UIWebView（自动释放错误的高风险），或者当然是一些需要持久保存到对象“死亡”的数据，那么保留/释放是要走的路。

老实说，我的项目还没有那么大，自动释放对象的额外“停留时间”会产生内存问题。对于复杂的应用程序，这种担忧是合理的。

无论如何，我不认为一刀切的方法是正确的。您使用适合该项目的任何方法（或方法组合），同时牢记上述所有因素。

# functional-programming - 从 Ruby、Lisp、Haskell 和 Erlang 转向 Ocaml

> ID：193292
> 
> 赞同：9
> 
> 时间：2008-10-10T23:02:01.003
> 
> 标签：functional-programming, ocaml, paradigms, rapid-prototyping

我一直在阅读有关 Ocaml 始终如一的速度、快速原型设计能力和出色的内存管理的信息，并决定接受它。

因为我已经掌握了 Ruby、*lisp、Haskell 和 Erlang，所以我特别感兴趣的是我应该在 Ocaml 中注意哪些违反 KISS 的特性。

如果您以上述语言的背景开始 Ocaml，那么最令人沮丧的事情是什么？你是如何解决这个困难的？什么类比帮助你进入了语言的流程？

我也很想知道你是否已经做的不仅仅是简单地学习了 Ocaml，并且实际上已经为你的大部分编码问题转换了它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-11T07:59:43.693

我找到了关于 Ocaml 及其与大多数其他语言的关系的优秀资源：http: [//www.soton.ac.uk/~fangohr/software/ocamltutorial/lecture1.html](http://www.soton.ac.uk/~fangohr/software/ocamltutorial/lecture1.html)

它不仅解释了原因，还解释了许多在你开始时可能会困扰你的小怪癖。

啊，我发现了一张[小抄](http://merd.sourceforge.net/pixel/language-study/syntax-across-languages-per-language/OCaml.html)，其中几乎突出了它所有的语法怪异之处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T19:40:07.737

我听说 APress Practical OCaml 也很糟糕。

[Objective Caml 简介](http://files.metaprl.org/doc/ocaml-book.pdf)非常 *好*，专门解决了一些反 KISS 问题，例如类型系统可能无法容忍的方式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-19T05:22:10.353

从 C++ 背景来到 OCaml，我发现用变体类型替换类是最难的过渡（而且很容易！）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-13T05:46:38.393

有一本关于 Ocaml “Practical Ocaml”的书，它不是一本真正的好书，但至少对于入门来说它已经足够好了。这是一种非常实用的语言，不幸的是它是一种“奇怪”的语法。如果您想看到一些“真正的”Ocaml，那么只需查看 Shootout 页面。

问候弗里德里希

# .net - 在 .NET 中获取图像元数据而不考虑元数据格式

> ID：193293
> 
> 赞同：2
> 
> 时间：2008-10-10T23:03:10.330
> 
> 标签：.net, image, metadata, geotagging

给定一个文件名，我需要能够访问我当前正在开发的（封闭源）项目的图像中的某些元数据，而不考虑元数据的存储方式（即 Exif、IPTC 或 XMP）。特别是，我想访问地理标记数据。

有没有一种方法可以在不需要任何第三方程序集或库的情况下做到这一点**（**即，它是否可以使用股票 Microsoft .NET）以及如何完成？还是我被很多 P/Invoking [WIC](http://msdn.microsoft.com/en-us/library/ms735422(VS.85).aspx)卡住了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T23:16:11.753

检查[FreeImage 项目](http://freeimage.sourceforge.net/)- 具有 .NET 包装器的 C++ 图像加载和处理。也许它可以做到这一点

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-22T22:01:34.187

老问题，我知道，但 EXIF 可以仅使用基本的 .NET 框架（没有第三方 DLL）来提取。EXIF 项目可以作为 PropertyItems 从 Image 对象中提取。我正在使用与此类似的方法将特定属性提取为字符串（例如 Date Taken 或 Maker Note）：

```
public static string GetEXIFInfo(System.Drawing.Image img, int propertyItem) {
    return new ASCIIEncoding().GetString(img.GetPropertyItem(propertyItem).Value);
} 
```

以下是您可以用来获取各种 EXIF 值的 propertyitem 值列表：http: [//msdn.microsoft.com/en-us/library/ms534416%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms534416%28VS.85%29.aspx)

# javascript - 在 Javascript 中创建可排序的树/网格

> ID：193315
> 
> 赞同：7
> 
> 时间：2008-10-10T23:16:02.393
> 
> 标签：javascript, json, extjs, treetable

我想从 JSON 创建一个树结构，但有多个可以排序的列。我见过很多树和网格的实现，但从来没有混合过。

有谁知道任何 Javascript 工具包的插件或功能可以实现这一点，所以我不必在这里重新发明轮子？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-10T23:24:09.413

这看起来很不错： http: [//www.max-bazhenov.com/dev/ux.maximgb.treegrid/index.html](http://www.max-bazhenov.com/dev/ux.maximgb.treegrid/index.html)

使用 ExtJS，它有一些您必须考虑的许可限制。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-01-14T14:49:13.597

我找到了所有这些组件：

*   [Coqsoft Treegrid](http://www.coqsoft.com/treegrid/www/)，商业，似乎非加超！
*   [分机 JS](http://www.sencha.com/products/js/)，商业：
    *   [列树](http://dev.sencha.com/deploy/dev/examples/tree/column-tree.html)组件 *
    *   [Nested Grid](http://mikhailstadnik.com/ext/examples/nested-grid.htm)，即Mikhail 修改的[带有 Row Expander 的 Grid Plugin](http://dev.sencha.com/deploy/dev/examples/grid/grid-plugins.html)
    *   [Ext.ux.maximgb.treegrid](http://www.max-bazhenov.com/dev/ux.maximgb.treegrid/index.php)，另一个mod，由Max（由eyelidlessness提出的）
*   [JQTreeTable](http://www.hanpau.com/index.php?page=jqtreetable)，最小，需要 jQuery *
*   [Treetable](http://plugins.jquery.com/project/treeTable) , jQuery 插件 *
*   [dojo-treetable](http://code.google.com/p/dojo-treetable/)，基于 Dojo *
*   [Maxdesign](http://www.maxdesign.com.au/articles/tree-table/)，它只是一个很好的 css *

* 似乎不可排序

就我个人而言，我正在尝试**Treetable**，并且经过一些配置（在文档页面源代码中的示例中翻找......），我很享受它的简单性和清晰性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-03T07:37:01.570

经过对树形网格的长期研究，我遇到的最好的一个来自 jeasyui.com

[http://www.jeasyui.com/demo/main/index.php?plugin=TreeGrid](http://www.jeasyui.com/demo/main/index.php?plugin=TreeGrid)

![在此处输入图像描述](https://i.stack.imgur.com/YVjAO.jpg)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-05T02:48:36.200

用于 jQuery的[jstree](http://www.jstree.com/documentation)插件与其[jstree-grid](https://github.com/deitch/jstree-grid)插件捆绑在一起，可以处理非常灵活的排序（排序是[主 jstree 的插件](http://www.jstree.com/documentation/sort)）（并重用您应用的 jQuery UI 主题）。

那是您正在寻找的那种网格吗？你最终会得到一个非常像的视图：![jstree-grid-with-sort-themerolled](https://i.stack.imgur.com/h27tQ.png)

您必须手动添加按列排序，然后[触发重新排序](https://groups.google.com/forum/?fromgroups=#!topic/jstree/5jTBy1Fn2pU)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T04:27:47.263

这也是一个“官方”示例（页面顶部网格），使用 RowExpander UX。

[http://extjs.com/deploy/dev/examples/grid/grid3.html](http://extjs.com/deploy/dev/examples/grid/grid3.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-06-22T11:44:13.327

DHTMLX 还具有 TreeGrid JavaScript 组件（支持排序和其他与网格相关的功能）： [http ://dhtmlx.com/docs/products/dhtmlxTreeGrid/](http://dhtmlx.com/docs/products/dhtmlxTreeGrid/)

（免责声明：我为 DHTMLX 工作）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-20T18:12:33.200

另一个支持引导程序的树形网格。 [http://maxazan.github.io/jquery-treegrid/examples/example-bootstrap-3.html](http://maxazan.github.io/jquery-treegrid/examples/example-bootstrap-3.html)

# sql - sql 分区函数中的非确定性函数

> ID：193328
> 
> 赞同：0
> 
> 时间：2008-10-10T23:20:47.330
> 
> 标签：sql, database-partitioning

SQL 分区函数中如何使用非确定性函数？它们是否有用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-10T23:21:01.883

MsSql 允许在分区函数中使用非确定性函数：

```
CREATE PARTITION FUNCTION MyArchive(datetime)
AS RANGE LEFT FOR VALUES (GETDATE() – 10)
GO 
```

这是否意味着早于 10 天的记录会自动移至存档（第一个）分区？当然不是。

数据库存储分区模式的设置日期，并以最（逻辑）方式使用它。假设一个在 2000 -01-11 上设置上述模式，这使得定界日期为 2000-01-01。当您查询日期低于初始定界日期 (boundary_value - 2000-01-01) 的数据时，您将仅使用存档分区。当您查询日期高于当前日期减去 10 天 (GETDATE() – 10) 的数据时，您将仅使用当前分区。所有其他查询将使用两个分区，即查询日期低于当前日期减去 10 天但高于定界日期 (2000-01-01) 的数据。

这意味着随着时间的推移，使用这两个分区的日期范围越来越大。而且您最好确定性地将分区设置为定界日期。

我不认为这是有用的任何场景。

# shell - 第三方windows命令行程序？

> ID：193336
> 
> 赞同：5
> 
> 时间：2008-10-10T23:30:08.637
> 
> 标签：shell, command-line, windows-xp, upgrade

寻找更好的 Windows XP 命令行界面。Visual Studio 命令提示符不如 Linux/OSX 终端好。

想法？

**编辑：**

答案：Sourceforge 上的控制台和 Windows Powershell。谢谢，我会去挖掘它们并评估它们。Cygwin 包对于我想要的东西来说开销太大了。

**edit2：** 现在看起来像 Windows Powershell。它的复制和粘贴功能不是很好，但 MS 支持它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-10T23:31:08.790

看看 Console2 [http://sourceforge.net/projects/console/](http://sourceforge.net/projects/console/)

它的特点：

“多个选项卡，类似文本编辑器的文本选择，不同的背景类型，alpha 和颜色键透明度，可配置的字体，不同的窗口样式”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-10T23:34:53.823

正如您的问题已被标记，您是否尝试过[Windows PowerShell](http://en.wikipedia.org/wiki/Windows_PowerShell)？它的范例基于 unix 的管道，但不是输出文本，而是进程输出 .Net 对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-10T23:36:28.703

赛格温？www.cygwin.com。还是铭文？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T23:33:43.310

赛格温

这是一个答案延伸线。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-14T04:55:13.363

我不清楚您所说的 Linux/OSX 命令提示“很好”是什么意思。如果你只是说它们提供了更多的实用程序，我通常会安装[Windows Services for Unix](http://technet.microsoft.com/en-us/interopmigration/bb380242.aspx)来添加常用程序，如 grep 和 vi。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-10T23:34:06.633

我看到您将“powershell”作为标签之一。也许您可以通过解释您不喜欢 PowerShell 作为 cmd.exe 的替代品来帮助指导我们的答案？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-10T23:38:28.917

我使用[JP Software的 Take Command](http://www.jpsoft.com/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-10T23:49:06.977

[Cygwin](http://www.cygwin.com/)是一个不错的选择。您可以在 Windows 上运行 Bash 或其他 shell。您可以获得大部分经典的 Linux/UNIX 命令、shell 脚本等。您甚至可以获得 GNU 编译器，如果您愿意，可以避免使用 Visual Studio。从 Cygwin，您可以访问您的常规 Windows 程序、驱动器等，因此很少有理由返回 cmd.exe。

如果您只是想通过 shell 脚本（不是交互式 shell）自动执行任务，那么您应该查看[Windows Scripting Host](http://msdn.microsoft.com/en-us/library/9bbdkx3k(VS.85).aspx)。WSH 是一个功能丰富的 Windows 脚本环境，预装在所有现代版本的 Windows 上。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-11T00:01:28.137

我最近一直在组合 putty、cygwin、screen 和 zsh（不是 bash）。我喜欢 zsh 的很多特性，比如 autocd 和 auto-pushd，它们可以将您更改的目录放入目录堆栈，而无需键入 pushd。我也喜欢这样一个事实，即多个 shell 共享历史，并且不会相互覆盖。Screen 让我可以在一个 putty 窗口中运行多个 zsh shell。您可以从 cygwin 站点获取 zsh 和 screen。我运行：putty -cygterm screen

您还需要具有 -cygterm 支持的修补版 putty。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-13T03:25:49.350

git 的 GitBash 也是一个不错的选择。它可以配置为在类似unix的环境中使用。可以从这里下载[http://msysgit.github.io/](http://msysgit.github.io/)

# opengl - 简单的 3D 图形项目？

> ID：193339
> 
> 赞同：16
> 
> 时间：2008-10-10T23:31:15.593
> 
> 标签：opengl, graphics, 3d, rubiks-cube

我正在为一个简单的 3d 图形程序寻找一些好的想法，作为我计算机图形课程介绍的最终项目。至于一些背景信息，我们将使用 opengl 并且将有一个多月的时间来研究它，所以没什么太牵强的。看起来越简单和“漂亮”越好。但是，它确实需要某种用户可以与之交互的界面（因此非常简单的游戏或类似游戏是个好主意）并且必须是 3D 的。

到目前为止，我唯一的想法可能是 3D 版本的俄罗斯方块（谷歌的一些例子）。

编辑：我最终选择了 3D 俄罗斯方块。在不到一个月的时间里，[你可以在这里看到我想出的东西](http://www.cs.unc.edu/%7Epmerrell/comp575/projects/3DTetris%20v7.zip)。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-10T23:44:27.220

3D 文本/代码编辑器。文本是 3D 的，错误突出，代码缩进不仅缩进，而且在 z 轴上突出，页面/文件是 3D 的并且可以像 ringpad 一样翻转。

可能没有用，但比游戏 IMO 更有趣、更有趣。

![替代文字](https://i.stack.imgur.com/i7fRf.jpg)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-11T01:41:02.803

在大学里，为了我的并行编程课程，我完成了[Conway 的 Game of Life的 openGL/](http://en.wikipedia.org/wiki/Conway%27s_Game_of_Life) [MPI](http://www.lam-mpi.org/)实现。这很有趣。希望我在某个地方仍然有代码。使用 open GL 的优点是您可以以不同的方向布置网格，而不是平面网格。请记住，代码在签入源代码管理之前是不存在的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-10T23:37:19.870

加入一些物理学会使它更有趣。如何实现迷宫（你应该通过倾斜将球从起点引导到目标的迷宫玩具）。

![迷宫](https://i.stack.imgur.com/JLA17.jpg)

编辑：埃里克告诉我它叫做迷宫。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-10T23:34:32.263

[一款与此类](http://egraether.com/mine3d/)似的3D[扫雷](https://en.wikipedia.org/wiki/Minesweeper_(video_game))游戏。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-11T04:22:43.943

魔方。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-10T23:38:40.990

看看[http://www.contextfreeart.org/](http://www.contextfreeart.org/) ...写一些类似的东西，但对于3d。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-13T10:14:53.297

如果你曾经玩过[Missile Command](http://en.wikipedia.org/wiki/Missile_Command)，我相信这可能是一个很好的“3d-ify”项目。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-21T15:16:33.073

试试鸡过马路游戏。

您可能需要证明*最低*限度：

*   纹理
*   灯光
*   动画片
*   相互作用
*   碰撞检测

如果没有标记，即使是简单的物理也不要包括在内。根据标记方案确定任务的优先级。首先做一些简单的工作并备份它:)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-27T18:51:17.250

老实说，加载一堆动画模型并设置一个简单的第一人称射击游戏实际上非常容易。我的意思是，要使通用的东西正常工作，您不需要那么多：

*   加载并显示高度图或 BSP 树作为关卡。
*   加载和渲染一些简单的 MD2 模型（关键帧动画、少量多边形和简单格式）。
*   画一个简单的平视显示器。
*   Ray/AABB 相交，每次用户点击时，您都需要从屏幕中心投射一条光线，看看它是否与敌人的边界框相交。
*   简单的FPS相机系统。

就我而言，上述内容在一个月内是相当可行的。（如果你已经知道一些东西，它可能在一周内是可行的）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-10T23:34:12.013

我会检查[Panda3D](https://en.wikipedia.org/wiki/Panda3D)或[Pygame](https://en.wikipedia.org/wiki/Pygame)。

Panda3D 可能与您正在寻找的内容很接近，并且始终有效的一个想法是将用户的脸放在主角或对象中。3d-pong 与玩家的脸？使用一些意想不到的东西......比如用汉堡而不是砖块制成的俄罗斯方块。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-10T23:40:28.040

[我喜欢像boids](http://www.red3d.com/cwr/boids/)这样的小型自组织[生命](http://en.wikipedia.org/wiki/Artificial_life)应用程序。他们可以很有趣地编写代码，并且总是受益于漂亮的 UI，尤其是 3D 的。用户输入可以修改环境的各个方面以及在环境中移动/穿过。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-10T23:45:51.007

我曾经尝试为一堂课制作 3D 小行星。我从来没有完成游戏部分，因为它是一个图形类。这艘船可以四处移动，小行星也可以，但没有碰撞检测。飞船和小行星都应用了 3D 纹理，而且小行星是由椭圆体构成的，所以它们实际上是 3D 的。不过，游戏玩法都是 2D 的。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-10T23:48:42.080

其中一个游戏是一个木制迷宫，顶部有一个球在滚动。你倾斜板子并试图让球绕过迷宫而不掉进洞里？它的优点是上手相对简单，但如果你有时间，你可能会想到一些扩展。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-10-11T01:09:58.497

我喜欢系外行星。去阅读他们。在 Wikipedia 和[http://exoplanet.eu](http://exoplanet.eu)上有很多信息。天文学家和公众宣传人员总是可以使用新鲜的 3D 动画来展示[多普勒效应](https://en.wikipedia.org/wiki/Doppler_effect)是如何工作的，或者行星如何在恒星前面过境，例如使其变暗 0.5%。

或者，我的工作是，当行星从它的恒星后面经过时如何。在地球，我们从那颗恒星接收到的红外线只少了一点点。用户可以调整轨道、行星大小等，看看这会如何影响天文学家所看到的。它可能很有趣，做起来很简单，并且在扩展工作以获得更好的纹理、光滑的灯光效果等方面具有无限的潜力，你最终可能会为科学教育做出贡献。

如果我不忙于帮助处理实际科学的数字，我会自己制作这样的 3D 动画。我会吃醋的！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-13T10:07:09.770

如果你正在寻找一个真正的大学规模的任务，我的任务是制作一个小型直升机“游戏”，你可以在其中从海洋中的航空母舰起飞并在一些环境影响、流动的水等情况下四处飞行。即没什么太复杂的. 再举一个例子，我前一年的任务是一个没有对手的小赛车游戏。
我担心你可能会失去俄罗斯方块的标记，因为听起来在 z 轴上几乎不会做任何事情，并且可能会遇到太 2d 的问题，尽管这显然取决于你的简报。

无论如何，这些将让您有机会尝试基本的 OpenGL 功能，例如雾、光照、几何、纹理和一些基本的运动物理和碰撞检测/响应。

此外，虽然通常超出了这样一个大学规模的任务的范围，但您可以进一步添加诸如动画几何体（例如人）、环境映射、反射、阴影、粒子系统、着色器，也许是高度映射的岛屿。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-10-27T16:05:23.060

重写[块 3D](http://blocks3d.sourceforge.net/)。这个项目的图形现在看起来很糟糕。我记得在带有线框图形的 386 上玩过这个游戏（或类似的游戏）......太棒了。游戏基本上是3D俄罗斯方块。

# svn - 我怎样才能最好地利用 Trac？

> ID：193341
> 
> 赞同：16
> 
> 时间：2008-10-10T23:32:34.747
> 
> 标签：svn, project-management, trac

我在 Subversion 实现之上安装了一个 Trac 项目（由于 Webfaction 的控制面板很容易做到），但现在我有配置工作要做。考虑到这一点，是否有*简单*的方法可以在 Trac 中执行以下操作：

1) 确保客户只能看到高级别的进度指示器。
2) 提供关于工单、测试和任务的每日总结报告。

另外，我很想知道是否有任何**强烈**推荐的插件，我很抱歉忘记安装。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-11T00:15:52.523

我不建议使用相同的 Trac 项目来跟踪开发任务并显示客户进度。您希望能够坦诚地对待您的开发票、评论等。客户可能会专注于错误的事情并误解您放入票中的数据。我建议为客户提供一个包含高级任务的单独项目，并且只显示这些任务的进度，而不是细节。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-10T22:11:13.713

**1) 高级进度指标：**

路线图选项卡为您提供了一种高级进度指示器。它列出了所有里程碑，并为每个里程碑向您显示：

*   里程碑标题
*   简短的介绍
*   里程碑到期的日期
*   到那时还剩多少时间（或您落后于计划多长时间）
*   有多少票分配给了那个里程碑，有多少票已经关闭，可视化为一个漂亮的绿色进度条。该条是基于每张票的重量相同的假设绘制的，这可能会产生误导

您可以限制您的权限，使您的客户只能访问此视图。

根据您和您的客户之间的关系，您可能希望让他能够创建新工单（权限 TICKET_CREATE），这应该是可能的，而无需授予他对其他工单（TICKET_VIEW 和 TICKET_MODIFY）的读取权限。抱歉，但我目前无法测试这是否真的有效，也许有人可以对此发表评论。

**2) 每日总结报告**

trac 为您提供您能想到的所有内容的 RSS 提要。应该可以从中生成每日报告，或者您只需告诉您的 RSS 客户端每天检查一次提要。

Trac 还可以通过邮件通知票证所有者如果票证发生变化，但它会立即发生，而不是作为每日摘要。您可以对工单发表评论，有时我们会将它们用作讨论板或邮件列表，在这种情况下，最好立即收到通知。

**其他配置**

在我使用 trac 进行的每个项目中，我都会创建一个自定义查询来列出所有无人拥有的票证：

```
选择 p.value 作为 __color__，
   所有者 AS __group__,
地位，
   id AS 工单、摘要、组件、里程碑、t.type AS 类型、AS 创建时间、
   更改时间 AS _changetime，描述 AS _description，
   记者作为_reporter
  FROM 票 t
  LEFT JOIN enum p ON p.name = t.priority AND p.type = 'priority'
  WHERE status = 'new' AND (owner = '' OR owner = 'somebody' OR owner = 'None' )
  ORDER BY owner, p.value, t.type, time

```

每张工单可能有一个所有者和几个人在 cc 字段中，但*我的工*单的报告只列出了您是所有者的那些。为了克服这个问题，我添加了一个这样的查询：

```
  选择 p.value 作为 __color__，
   （案例所有者 WHEN '$USER' THEN
     （案例状态
       何时“分配”
       THEN '您接受的门票'
       ELSE '已分配给您的票，请接受或重新分配'
      结尾）
     ELSE '门票，cc 中有你的名字' END)
     作为__组__，
   id AS 票证、摘要、组件、版本、里程碑、
   t.type AS 类型、优先级、AS 创建时间、
   更改时间 AS _changetime，描述 AS _description，
   记者作为_reporter
  FROM 票 t
  LEFT JOIN enum p ON p.name = t.priority AND p.type = 'priority'
  WHERE t.status 'close' AND (owner = '$USER' OR cc like '%$USER%')
  ORDER BY owner, (status = 'assigned') DESC, p.value, 里程碑, t.type, time

```

*（此代码适用于 trac 0.11b）*

这是我最喜欢的票务报告。它将门票分为三个等级：

*   您拥有并接受的门票
*   已分配给您但您尚未接受的票证
*   有你在 cc 中的票（如果没有那个查询，你就不会得到花哨的东西）

这些查询可能看起来很吓人，但它们是对已经存在的查询的简单修改。您不必破解 trac 源代码，网络界面可让您编辑查询。

**插件**

如果您使用 eclipse，我推荐[XML RPC 插件。](http://trac-hacks.org/wiki/XmlRpcPlugin)它可以与[Mylin](http://www.eclipse.org/mylyn/start/)紧密集成。（我认为即使没有插件，基本集成也可以工作），因此您的开发人员可以在 eclipse 中完成许多任务，而无需切换到 trac Web 界面。

（如果你使用 eclipse，但不知道 mylin，你应该看看它。你可以在没有任何配置的情况下测试它，因为它带有大多数 eclipse 发行版，并且可以在没有 trac 的情况下独立运行。）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-20T11:45:00.070

至于其他插件，我们安装了 TocMacro、XmlRpcPlugin、WysiwygPlugin 和 TracRedirect。特别是，WYSIWYG 插件非常适合鼓励较少技术人员在 wiki 中维护他们自己的文档 - 您甚至可以在保留格式的同时从 MS Word 中进行 C&P，这很有帮助。

如果 Trac 的默认设置不能很好地代表您自己的工作流程，请查看 Trac 为您提供的自定义工单工作流程。这使我们能够将代码审查和集成测试步骤添加到工作流程中。

我建议让您的 Trac 服务器针对某些中央身份验证框架进行身份验证。我们运行一个带有身份验证凭据的 LDAP 树，它被我们所有的内部系统使用 - 包括 trac、svn、samba、openvpn 等。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-11T13:00:54.927

@Dave Dunkin 是对的。将 Trac 用于您的内部使用，并使用[Basecamp](http://www.basecamphq.com/)之类的系统为您的客户提供项目中正在发生的事情的高级概述。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-20T12:12:49.857

如果是库存安装，则数据库只是一个 SQLite3，因此您可以轻松编写脚本来获取“安全”信息，例如票的数量，或者为什么不获取其中一个报告。这样，只要票名没问题，就可以自由讨论。修订版、里程碑、维基页面、标签（如果您使用该插件）也可用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-08T01:08:30.950

您可能可以撤销除`ROADMAP_VIEW`匿名用户之外的所有权限，但这可能有点**太**高级了，不是吗？目前不支持个人票证或评论级别的访问控制 AFAIK。有关 trac 权限的详细信息，请参阅[http://trac.edgewall.org/wiki/TracPermissions](http://trac.edgewall.org/wiki/TracPermissions)。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-09T21:54:44.407

如评论之一所述，您不能基于用户限制票证或评论访问。寻找或创建外部报告系统是您最好的选择。

根据使用 Trac 的经验，有几件事：

1.  创建自定义[工作流程](http://trac.edgewall.org/wiki/TracWorkflow)非常简单。[GraphViz](http://www.graphviz.org/)的使用 对交流状态和动作有很大帮助。如果您需要更复杂的状态交互，那么进一步扩展内置功能的工作流插件（如[AdvancedTicketWorkflowPlugin](http://trac-hacks.org/wiki/AdvancedTicketWorkflowPlugin)）并不难。

2.  对于自定义报告，您可以编写带有命名参数的 SQL 查询，然后从 wiki 页面链接到这些：

例如，查询可以包含这样的 WHERE 子句：

```
WHERE datetime(t.changetime, 'unixepoch') >= datetime('now','-$DAYS days') 
```

维基页面可以有这个：

```
Show activity for last [http://server.com/trac/report/9?DAYS=8 8] days. 
```

# windows - 调试：修改文件时在运行时中断？（视窗）

> ID：193351
> 
> 赞同：3
> 
> 时间：2008-10-10T23:36:03.697
> 
> 标签：windows, debugging

修改特定文件后是否可以在运行时中断？

IE。监视文件并在对其进行更改后进入调试器。

这是针对 Windows 应用程序的……这在 Visual Studio 或 Windbg 中是否可行？

编辑：我应该提到这是一个 Win32 应用程序..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-10T23:45:29.120

您可以使用 System.IO.FileSystemWatcher 类。

```
FileSystemWatcher watcher = = new FileSystemWatcher();
watcher.Filter = @"myFile.ini";
watcher.Changed += new FileSystemEventHandler(watcher_Changed); 
```

然后实现 FileSystemEventHandler 类型的委托：

```
static void watcher_Changed(object sender, FileSystemArgs e)
{
    Console.WriteLine("File {0} has changed.", e.FullPath );
} 
```

每次修改您在过滤器中选择的文件时，您都会收到警报（您可以使用 Debug 类或 Trace 类来输出数据）。此外，FileSystemWatcher 类有更多事件（重命名、删除、创建）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-10T23:38:55.203

假设这是 .NET，System.IO。**FileSystemWatcher**类是您所需要的。

```
FileSystemWatcher watcher = new FileSystemWatcher("c:filename.txt");
watcher.Changed += new FileSystemEventHandler(watcher_Changed);
// 
void watcher_Changed(object sender, FileSystemEventArgs e)
{
    // put a breakpoint here
} 
```

# language-agnostic - 为您的项目命名：重要吗？

> ID：193364
> 
> 赞同：19
> 
> 时间：2008-10-10T23:40:10.630
> 
> 标签：language-agnostic, naming, projects

我使用不同的语言和平台从事各种项目。我将其中的一部分抽象到他们自己的独立项目中，我想向公众开放其中的一些。

让我卡住的是洗礼。

那么，有关系吗？我应该选择一些东西并坚持下去吗？

如果它确实重要，那么更好的是：一个听起来很酷但令人难忘的名字，还是一个更容易找到的描述性名字？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-11T00:03:26.603

我认为命名是传播想法的重要组成部分。我在名称中寻找的是：

1.  难忘。它应该与其他名称不同，但易于记忆。
2.  准确的。如果名称反映了项目的某些内容，这将很有帮助。
3.  积极的。如果名称的反面没有吸引力，这将很有帮助。例如，结构化编程遵循这一规则，因为没有人希望是非结构化的。
4.  聪明的。聪明是可选的，但它有助于在你实现它时让一个名字令人难忘。不过，聪明的人老化得很厉害。

除非你有很酷的名字，否则不值得等待编程。您对该项目的经验越多，命名就越容易。JUnit 直到它首次亮相几个月后才被命名。

有关命名的更多信息，我强烈推荐 Frank Luntz 的“有效[的词：这不是你说的，而是人们听到的](http://books.google.com/books?id=vHqxeKVLAYAC)”。他是一个不道德的政治活动家，但他热爱语言并有效地传达这种爱。

关于“粘性”项目的最后一点：一定要经常讲述“创造神话”，项目如何开始的故事。我见过的每一个产生长期影响的项目都有一个关于它的起源的经常重复的故事。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-10T23:43:40.793

我决定从通用名称开始，因为我宁愿开始快速编程并在以后担心名称。

这个 Web 2.0[名称生成器](http://www.dotomator.com/web20.html)很有趣。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-18T23:39:07.783

如果要公开使用该名称 - 营销、网络等，请确保您选择的名称是其他人尚未用于任何类似的名称。至少做一个谷歌搜索。在你花钱做广告或类似的事情之前，先花几块钱在一个更专业的名称和商标数据库中进行搜索。至少在美国，第一个名字给了你合法的权利，而且进行搜索比以后必须更改你的名字更便宜。

当然，在你走得太远之前，请确保域名也可用。

为了在名称中获得更强大的合法权利，请选择编造的内容，而不仅仅是对您的产品功能的通用参考。像微软这样的人可以花费大量资金来获得诸如“Word”或“Windows”之类的法律保护——你可能做不到。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T23:53:42.147

是的，我认为这很重要（我自己也处于同样的位置）。我认为这个名字要么需要很酷/令人难忘，要么很明显/简单——不一定两者兼而有之。根据经验，假设您正在寻找一个可以完成您的工作的程序/库。你给它起的名字会鼓励你还是让你失望，你会记得吗？这真的很重要。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-11T00:05:06.943

如果你看一下一般产品的历史，有很多例子表明选择不当的名字成为语言的一部分（Kleenex、Tasty-Freez、Wisker-Biskit），所以我认为这根本不重要营销的角度。不过，您确实想要一些易于通过电话输入和拼写的东西。我在一个名字很奇怪的公司工作，里面有很多听起来像 Fs 的 Ss，这是一场噩梦。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-11T00:09:34.813

如果您关心其他人使用您的代码，这很重要。更喜欢令人难忘的名字。它们之所以令人难忘，可能是因为它们具有描述性，或者因为它们“酷”，或者出于其他原因。如果您将代码放在网上，它应该包含将显示在相关搜索中的描述。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-11T00:58:36.883

在为您的应用程序确定名称之前，您可能需要检查该域名是否可用。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-23T14:32:29.563

**谷歌友好**

*   一些独特的东西（*或者至少你可以在前 10 个结果中获得主页的东西*）
*   容易拼写

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-12T22:31:47.843

并不总是考虑的一点是您可以轻松地在 Google 上搜索您的项目。这可能是一个因素，也可能不是一个因素，但您可能有兴趣密切关注社区/媒体对您的项目的看法。

如果它被称为“Project X”、“e”、“Raptor”或“Purple Windows”，那么几乎不可能进行明确的搜索。除了域名可用性问题之外，选择一个未在任何其他上下文中使用的名称可以让您做一些有用的事情，例如为项目的推文/博客评论设置自动警报。

可悲的是，这些名字中的大多数都很难明确地发音/拼写，所以这是一个权衡。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-25T19:45:59.557

我绝对认为命名对您的项目很重要。许多开源项目都存在这个问题，这使得它们的名称在屏幕上看起来很酷但很难发音。这意味着您的网站至少必须有一个发音指南，并且很多人会对如何发音您的项目感到困惑。当人们尝试考虑您的项目时，发音困难的名称可能会引起一些认知失调。是 Cool、Cooyil、Coowheel、Coil 还是什么？这些人不能命名他们的项目有什么问题？如果他们不能将项目命名为目标受众中理智的人可以轻松阅读的名称，我们真的可以相信他们能做出好的产品吗？

等待选择一个好名字，直到你有好名字来命名你的项目。一旦你找到一个很棒的名字，不要因为它而感到难过，没有必要与你在开发中使用的任何名字保持联系。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-10T23:41:59.517

如果我们不知道产品是什么，就很难建议使用名称。

此外，这听起来很像一个营销问题。我会说一些很酷且令人难忘的东西，但也是描述性的。iTunes 浮现在脑海中。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-10T23:49:11.563

你可以两者都做。一个很好的例子是红宝石鞋。它最初将被称为（或者他们这样说）“MIDAS MACLEAN 的好运之窗”，但后来他决定选择鞋子。

工具包/库与鞋子无关。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-18T23:03:12.443

我已经看到项目命名是一个大问题。我管理过大约 20 名程序员，他们可能在 40 个项目上工作，当你有一个名为 X 的项目、一个名为 Y 的虚拟目录、一个名为 Z 的 Visual Studio 项目等时，这将是一个真正的问题。当应用程序写入错误日志，是哪个项目？它属于谁？我们创建了一个项目数据库来捕获所有这些，但最好有约定，因为项目数据库并不总是完整和最新的。

我拒绝了这个想法，但最好有项目*编号*。有助记项目名称似乎更好，但如果你有很多项目，你会遇到助记词为谁的问题。

# algorithm - 很长整数的乘法

> ID：193398
> 
> 赞同：7
> 
> 时间：2008-10-10T23:53:26.937
> 
> 标签：algorithm, math, 64-bit

有没有一种算法可以准确地将两个任意长的整数相乘？我正在使用的语言限制为 64 位无符号整数长度（最大整数大小为 18446744073709551615）。实际上，我希望能够通过分解每个数字来做到这一点，使用无符号 64 位整数以某种方式处理它们，然后能够将它们重新组合成一个字符串（这将解决相乘结果的问题贮存）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-11T00:00:13.460

大多数语言都有执行此操作的函数或库，通常称为 Bignum 库（[GMP](http://gmplib.org/)是一个很好的库。）

如果你想自己做，我会像人们在纸上做长乘法一样做。为此，您可以使用包含数字的字符串，也可以使用按位运算以二进制形式进行。

例子：

```
 45
 x67
 ---
 315
+270
----
 585 
```

或二进制：

```
 101
  x101
  ----
   101
  000
+101
------
 11001 
```

**编辑：**在二进制中完成之后，我意识到使用按位运算而不是包含以 10 为基数的字符串进行编码会更简单（当然也更快）。我已经编辑了我的二进制乘法示例以显示一个模式：对于底部数字中的每个 1 位，添加顶部数字，*将 1 位*时间的位置向左移位到一个变量。最后，该变量将包含产品。

要存储产品，您必须有两个 64 位数字，并想象其中一个是产品的前 64 位，另一个是产品的第二个 64 位。您必须编写代码，将第二个数字的第 63 位加到第一个数字的第 0 位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-11T09:56:37.920

如果您不能使用现有的 bignum 库，如 GMP，请查看[Wikipedia 上关于计算机二进制乘法的文章](http://en.wikipedia.org/wiki/Multiplication_algorithm#Multiplication_algorithms_for_computer_algebra)。为此，有许多好的、有效的算法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-11T05:27:26.090

最简单的方法是使用教科书机制，将任意大小的数字分成 32 位的块。

给定 ABCD * EFGH（每个块 32 位，总共 128 位）
您需要一个 9 个双字宽的输出数组。将 Out[0..8] 设置为 0

你首先要做： H * D + out[8] => 64 位结果。
将低 32 位存储在 out[8] 中，将高 32 位作为进位
下一步：(H * C) + out[7] + 进位
再次将低 32 位存储在 out[7] 中，使用高做 H*A + out[4] + 进位后32 位作为进
位，你需要继续循环，直到你没有进位。

然后用 G、F、E 重复。
对于 G，您将从 out[7] 而不是 out[8] 开始，依此类推。

最后，遍历并将大整数转换为数字（这将需要“将大数除以一个单词”例程）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-10T23:57:18.537

是的，您使用的数据类型实际上是一串数字（就像普通的“字符串”是一串字符一样）。你如何做到这一点高度依赖于语言。例如，Java 使用 BigDecimal。您使用什么语言？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-10T23:59:03.883

这通常作为家庭作业给出。你在小学学到的算法会起作用。如果您需要将其用于实际应用程序，请使用库（其他帖子中提到了几个）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-03T19:25:39.980

这是我在 C 中的代码片段。很好的旧乘法方法

```
char *multiply(char s1[], char s2[]) {
    int l1 = strlen(s1);
    int l2 = strlen(s2);
    int i, j, k = 0, c = 0;
    char *r = (char *) malloc (l1+l2+1); // add one byte for the zero terminating string
    int temp;

    strrev(s1);
    strrev(s2);
    for (i = 0;i <l1+l2; i++) {
        r[i] = 0 + '0';
    }

    for (i = 0; i <l1; i ++) {
        c = 0; k = i;
        for (j = 0; j < l2; j++) {
            temp = get_int(s1[i]) * get_int(s2[j]);
            temp = temp + c + get_int(r[k]);
            c = temp /10;
            r[k] = temp%10 + '0';

            k++;
        }
        if (c!=0) {
            r[k] = c + '0';
            k++;
        }
    }

    r[k] = '\0';
    strrev(r);
    return r;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-18T08:19:51.060

```
 //Here is a JavaScript version of an Karatsuba Algorithm running with less time than the usual multiplication method

    function range(start, stop, step) {
        if (typeof stop == 'undefined') {
            // one param defined
            stop = start;
            start = 0;
        }
        if (typeof step == 'undefined') {
            step = 1;
        }
        if ((step > 0 && start >= stop) || (step < 0 && start <= stop)) {
            return [];
        }
        var result = [];
        for (var i = start; step > 0 ? i < stop : i > stop; i += step) {
            result.push(i);
        }
        return result;
    };
    function zeroPad(numberString, zeros, left = true) {
        //Return the string with zeros added to the left or right.
        for (var i in range(zeros)) {
            if (left)
                numberString = '0' + numberString
            else
                numberString = numberString + '0'
        }

        return numberString
    }
    function largeMultiplication(x, y) {
        x = x.toString();
        y = y.toString();

        if (x.length == 1 && y.length == 1)
            return parseInt(x) * parseInt(y)

        if (x.length < y.length)
            x = zeroPad(x, y.length - x.length);

        else
            y = zeroPad(y, x.length - y.length);

        n = x.length
        j = Math.floor(n/2);

        //for odd digit integers
        if ( n % 2 != 0)
            j += 1    
        var BZeroPadding = n - j
        var AZeroPadding = BZeroPadding * 2

        a = parseInt(x.substring(0,j));
        b = parseInt(x.substring(j));
        c = parseInt(y.substring(0,j));
        d = parseInt(y.substring(j));

        //recursively calculate
        ac = largeMultiplication(a, c)
        bd = largeMultiplication(b, d)
        k = largeMultiplication(a + b, c + d)
        A = parseInt(zeroPad(ac.toString(), AZeroPadding, false))
        B = parseInt(zeroPad((k - ac - bd).toString(), BZeroPadding, false))
        return A + B + bd
    }
    //testing the function here
    example = largeMultiplication(12, 34)
    console.log(example)
```

# sqlite - SQLite 和缓存应用程序块

> ID：193406
> 
> 赞同：0
> 
> 时间：2008-10-10T23:56:22.983
> 
> 标签：sqlite, caching-application-block

有没有人使用 SQLite 的缓存应用程序块来持久化数据？

我想了解一些细节。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-18T11:31:54.830

```
objCatch.Add("DsFromDb", ds, CacheItemPriority.Normal, null, new Microsoft.Practices.EnterpriseLibrary.Caching.Expirations.AbsoluteTime(TimeSpan.FromMinutes(5))); 
```

# asp.net - 使用 Entity Framework 和 VB.NET 构建解耦的 N 层应用程序

> ID：193423
> 
> 赞同：5
> 
> 时间：2008-10-11T00:03:17.557
> 
> 标签：asp.net, vb.net, entity-framework

所以我们正在构建一个应用程序

*   UI 层（Web、移动、Ajax 客户端等）
*   服务/API 层
*   业务逻辑层
*   数据访问层

我们的目标是拥有从服务层到 DAL 的实体框架依赖关系。这意味着服务层将只接受和返回 POCO（普通的旧 CLR 对象）。

我们目前正在做的是手动编写服务层和业务逻辑层之间的映射层，将 POCO 转换为 EF 实体，反之亦然。

所以简而言之，页面有表单，表单有代码隐藏，它获取表单内容，将它们填充到 POCO 中，然后将其发送到服务层。服务层转换为 EF 实体，将其发送到业务逻辑层，业务逻辑层对实体执行某些转换，然后与 DAL 交互以使其持久化。

**是的，它有点乏味**，但我们想知道是否有更好的方法？

**是**的，我知道有人发布了一个 EF Poco 适配器，但它都是用 C# 编写的，我们更喜欢 VB.NET 解决方案。

**是**的，切换到 NHibernate 是最后的选择，因为我们已经深入开发周期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T00:16:45.750

您应该在 POCO 上执行业务逻辑。ORM 的全部目的是它是一个实现细节。业务逻辑应该在领域模型和领域服务中实现——在业务应用程序中，“领域”意味着“业务”。DAL 应该在那里接受 POCO 并将其持久化 - 在您的情况下，这意味着将其映射到并持久化 EF 实体。

无论如何，这就是理论/ NHibernate 模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-15T15:19:24.070

你能忍受对 EF*接口的服务层的依赖吗？*您可以[实施 IPOCO](http://www.sitechno.com/Blog/IntroducingEntityFrameworkContribEasyIPocoImplementationV01.aspx)。

甚至[有一种方法可以自动完成](http://www.codeplex.com/efcontrib/Wiki/View.aspx?title=PostSharp4EF&referringTitle=Home "PostSharp4EF：自动实现 IPoco 接口")。

# amazon-web-services - 你有没有有趣地使用 Mechanical Turk？

> ID：193426
> 
> 赞同：19
> 
> 时间：2008-10-11T00:03:56.760
> 
> 标签：amazon-web-services, amazon, mechanicalturk, crowdsourcing

我想听听使用 Amazon 的 Mechanical Turk 的有趣项目。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-11T07:01:17.290

It was used to help search for [James Gray](http://en.wikipedia.org/wiki/Jim_Gray_(computer_scientist)) when he went missing.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-25T22:36:43.823

[亚伦·科布林 ( Aaron Koblin](http://aaronkoblin.com/) ) 的两部作品让我印象深刻：

*   [绵羊市场](http://www.thesheepmarket.com/)- 工人得到报酬画朝左的绵羊的图画。
*   [一万美分](http://www.tenthousandcents.com/)- 工人被支付复制较大图像的一小部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-05-14T16:43:13.097

With some colleagues I've been running a lot of behavioral experiments on Mturk exploring altruism and cooperation. Even though Mturk is the ultimate in anonymous and profit-minded settings, we still find high levels of people paying costs to help others.

For a writeup, check out this paper: [http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1591202](http://papers.ssrn.com/sol3/papers.cfm?abstract_id=1591202)

The Online Laboratory: Conducting Experiments in a Real Labor Market

John J. Horton, David G. Rand, Richard J. Zeckhauser

Harvard University

Abstract:
Online labor markets have great potential as platforms for conducting experiments, as they provide immediate access to a large and diverse subject pool and allow researchers to conduct randomized controlled trials. We argue that online experiments can be just as valid – both internally and externally – as laboratory and field experiments, while requiring far less money and time to design and to conduct. In this paper, we first describe the benefits of conducting experiments in online labor markets; we then use one such market to replicate three classic experiments and confirm their results. We confirm that subjects (1) reverse decisions in response to how a decision-problem is framed, (2) have pro-social preferences (value payoffs to others positively), and (3) respond to priming by altering their choices. We also conduct a labor supply field experiment in which we confirm that workers have upward sloping labor supply curves. In addition to reporting these results, we discuss the unique threats to validity in an online setting and propose methods for coping with these threats. We also discuss the external validity of results from online domains and explain why online results can have external validity equal to or even better than that of traditional methods, depending on the research question. We conclude with our views on the potential role that online experiments can play within the social sciences, and then recommend software development priorities and best practices.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-11T00:07:24.770

我还没有用它做任何事情，但我一直想通过一个应用程序来使用它进行音乐搜索，该应用程序可以接受人们哼唱或唱歌的录音，然后使用土耳其人来识别曲调。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-16T07:13:52.480

[waky.org](http://waxy.org/)的Andy Baio用它做了一些有趣的事情：

*   [便宜、简单的音频转录](http://waxy.org/2008/09/audio_transcription_with_mechanical_turk/)
*   [找出 Girl Talk 的“非法艺术”专辑中的数百个样本](http://waxy.org/2008/09/girl_turk/)
*   [机械土耳其人的面孔](http://waxy.org/2008/11/the_faces_of_mechanical_turk/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-16T22:47:10.547

我们已使用它来批准适用于企业的图像。不是很有趣，但在这方面发现它非常有用。任务完成得非常快。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-03T22:54:50.037

我最喜欢的 Mechanical Turk 实例是工人必须从科学文献中的图形和表格中提取数据。这里有一个很好的实验描述和视频：

[http://usefulchem.blogspot.com/2008/12/mechanical-turk-does-solubility-on.html](http://usefulchem.blogspot.com/2008/12/mechanical-turk-does-solubility-on.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-22T20:04:34.023

[Halosys](http://www.halosys.com)：我们在开发的一些客户项目中使用了 Mechanical Turk。

这是我们在客户准备推出但需要数据时向他们建议的事情之一。特别有趣的是一些项目，比如填写一些漫画的内容，然后在客户网站上展示。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-22T03:39:12.727

今天发现：使用 MTurk[进行科学研究](http://www.economist.com/science/displaystory.cfm?story_id=13226709)。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-05-28T15:50:01.953

www.nearlyeveryone.com 建立在 Mechanical Turk 之上

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2011-03-16T00:31:56.920

我在它之上创建了一个网站可用性测试服务[——EasyUsability.com](http://www.easyusability.com)，以及一个使用它的口音培训和评级服务[——AccentTraining.net](http://www.accenttraining.net)

# dotnetnuke - dotnetnuke 和 dotimage 问题

> ID：193435
> 
> 赞同：2
> 
> 时间：2008-10-11T00:09:52.677
> 
> 标签：dotnetnuke, dotimage

我为 dotnetnuke 创建了一个使用 Atalasoft 的 dotImage 查看器的模块。dotImage 使用和 iframe 进行“ajax”渲染。我的模块在主页上运行良好，但在任何其他页面中，模块都会在 dotImage iframe 中加载整个主页。

有人同时使用 dotnetnuke 和 dotImage 吗？

有小费吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-14T12:21:16.300

我来自 Atalasoft。您应该向我们提出支持案例，以便我们为您提供帮助。

在任何情况下，页面出现在框架中的通常原因是在生成框架的内容时引发了异常——您看到的是 DotNetNuke 的自定义 500 页面。

可能最简单的查看发生情况的方法是暂时关闭 web.config 中的自定义错误页面 - 然后问题将显示在框架中，您可以修复它。此时可能有很多事情（文件权限、未正确安装许可证等）——因此获取异常是解决此问题的关键。

您可以通过以下方式关闭自定义错误：

在你的 web.config 中寻找这样的部分：

```
<customErrors mode="RemoteOnly" defaultRedirect="GenericErrorPage.htm">
     <error statusCode="403" redirect="NoAccess.htm" />
     <error statusCode="404" redirect="FileNotFound.htm" />
</customErrors> 
```

确保它未注释，然后将 customErrors 节点中的模式更改为“关闭”

# sql-server - 什么是比较两个 SQL Server 数据库的免费工具？

> ID：193438
> 
> 赞同：55
> 
> 时间：2008-10-11T00:13:11.063
> 
> 标签：sql-server

什么是比较两个 Sql Server 表（数据和模式）的免费工具。

如果该工具可以编写发现的差异，那就太好了。

我还浏览了一些较旧的[帖子](https://stackoverflow.com/questions/176316/compare-tools-to-generate-update-script-for-sql-server)。我见过的最接近的是[SQLDBDiff](http://sqldbtools.com/)，但我很想尝试更多选择。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2008-10-11T00:15:21.853

TableDiff.exe 应该有你需要的一切。它是[SQL Server 2005 中隐藏的瑰宝之一](http://www.microsoft.com/technet/prodtechnol/sql/bestpractice/gems-top-10.mspx)。所以你不必下载任何东西。

• 表差异工具允许您发现和协调源表和目标表或视图之间的差异。Tablediff 实用程序可以报告模式和数据的差异。tablediff 最受欢迎的功能是它可以生成一个脚本，您可以在目标上运行该脚本来协调表之间的差异。TableDiff.exe 需要 2 组输入；• 连通性- 提供源和目标对象以及连通性信息。

• 比较选项 - 选择比较选项之一 • 比较模式：常规或严格

• 使用行数、散列或列比较进行比较

• 使用 I/U/D 语句生成差异脚本以将目标同步到源。TableDiff 旨在用于复制，但可以轻松应用于需要比较数据和模式的任何场景。您可以在 SQL Server 2005 联机丛书中找到有关命令行实用程序和 Tablediff 实用程序的更多信息。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-08-31T20:24:55.917

尽管这在几年前就已经得到了解答，但一个新来的非常好用的是 Visual Studio 中的数据比较。它是 Visual Studio 2010 的一部分，也是 Visual Studio 2008 的 Database Professionals GDR 更新的一部分。当您想要比较 2 个不同数据库中的相同表时，这非常有用。

如果您需要比较同一数据库中具有相同架构或具有不同名称的 2 个表，TableDiff（前面提到过）是一个不错的选择。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-08-10T09:33:55.897

[DBComparer](http://dbcomparer.com)是免费的，适用于 MS SQL Server

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-12-06T15:31:20.720

现在归[Pragmatic Works](http://pragmaticworks.com/Products/DBA-xPress.aspx)所有的 Atlantis Interactiv有两个~~免费~~工具，称为 Schema Inspector 和 Data Inspector，其工作方式与 Red Gates 工具非常相似。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-23T14:07:38.193

我们可以向您推荐我们可靠的 SQL Server 数据和架构比较解决方案：[dbForge Schema Compare for SQL Server](http://www.devart.com/dbforge/sql/schemacompare/)和[dbForge Data Compare for SQL Server](http://www.devart.com/dbforge/sql/datacompare/)。

它们的主要优势是速度快（比大多数竞争对手快 3 倍）和极高的可靠性。

这些工具不是免费的，但您可以免费试用 30 天，并且您有机会获得这两种产品的免费许可 - 请参阅我们的[免费许可条件页面](http://www.devart.com/dbforge/sql/get-free-license.html)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-19T23:03:11.517

试试 Zidsoft 的 CompareData。它可免费用于比较表/视图数据，并且有 30 次试用版可用于元数据比较

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-01-13T09:47:08.967

一个 SQL Server 特定的数据库表差异工具是[Volpet 的 Table Diff](http://www.volpet.com/)

# reporting-services - 在 SQL Server 2005 Express 版本中使用 SSRS 有哪些限制？

> ID：193439
> 
> 赞同：1
> 
> 时间：2008-10-11T00:13:22.717
> 
> 标签：reporting-services, sql-server-express

我发现[这个](http://www.microsoft.com/sql/technologies/reporting/rsfeatures.mspx)非常旧的文档似乎说在快速版上运行时许多 Web 客户端功能不可用——计划、订阅等——以及无法访问报表生成器。该信息是否仍然是最新的，是否还有其他不可用的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-12T02:11:46.127

在 MSSQLEx2005 和 MSSQLEx2008 中确实没有订阅和调度，但我从来没有发现这是一个很大的问题。底层平台有一个调度器，Web 服务将完成所有渲染，因此您可以轻松地重新创建丢失的元素。

报告生成器也不存在，复制起来并非易事*。*您总是可以在本地安装 SQLEx 并让他们使用 BIDS。或者你可以停止廉价。免费的还是蛮不错的。

* * *

我建议您使用 SSRS2008 而不是 2005，因为它不再需要 IIS，而且报表引擎中有几个令人兴奋的新功能。特别是它现在支持带有内联字段的基于流的富文本，用于邮件合并类型的报告。

兼容性很好，但一些应用程序拒绝更新的数据库引擎版本。如果这是一个问题，请继续为数据库使用 SQLExpr2005。

> 那么，您是说 A) SSRS 2005 需要 IIS 而 2008 不需要，并且 B) SSRS2008 向后兼容 SQL2005 数据库？（听起来您可能会说 SSRS 2008 可以与运行 2005 数据库的人一起使用

是的，我确实是这么说的

*   SSRS 2005 需要 IIS，而 2008 不需要
*   SSRS 2008 向后兼容 SQL2005 数据库
*   SSRS 2008 可以与运行 2005 甚至 2000 数据库的人一起使用。

您可以将 SSRS 与任何有 ADO.NET 驱动程序可用的数据库服务器一起使用，包括 Oracle 和 MySQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T14:47:27.450

我在某处发现了关于 SSRS 2008 中富文本的想法。正如我所见，它将允许我制作这样的静态文本

“一些测试用**粗体**和一些*斜体*文本进行测试”

with a single text box which was impossible in RS 2005\. (even don't know good way to make it there)

You wrote it doesn't require SQL Server 2008 to be installed. What about IDE for reports development ?

Looking forward with big hopes for SSRS 2008, thanks for attention in advance, Alex

# c - 在以下使用 C 的情况下，pNext 指针将是什么？

> ID：193440
> 
> 赞同：3
> 
> 时间：2008-10-11T00:13:32.527
> 
> 标签：c, pointers

```
func()
{
    Object* pNext;
    func1(pNext);
}

func1(Object* pNext)
{
    pNext = Segement->GetFirstPara(0);
} 
```

我期待它是指向从 func1() 返回的 firstpara 的指针，但我看到 NULL 可以解释一下以及如何修复它以实际返回 firstpara() 指针？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-11T00:24:54.940

仅对于 C++，您可以将参数设置为引用

```
func()
{
    Object* pNext;
    func1(pNext);
}

func1(Object*& pNext)
{
    pNext = Segement->GetFirstPara(0);
} 
```

这里发生的是按值传递参数和按引用传递之间的区别。C 总是按值传递。为了取回一个值，该值需要是一个引用值（例如 Object** 将 Object* 称为指针）。C++ 添加了引用参数（由 & 表示）。按值传递仅传递数据的副本，而不传递实际数据本身。这就是为什么函数调用中使用的变量没有在函数中更新的原因。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-11T00:21:42.027

在 c 中，你会想要：

```
func1(&pNext);
func1(Object** pNext) { *pNext = ... } 
```

在 C++ 中

```
func1(pNext);
func1(Object*& pNext) { pNext = ... } 
```

在任何一种语言中，您的示例都会传递一个未初始化`Object*`的 to `func1`，它将复制它，为副本分配一个值，然后返回。请注意，原始 pNext 永远不会被修改（如果您为变量使用不同的名称，这将有所帮助）。

在这两种语言中，如果需要传递引用而不是传递值，则需要显式传递引用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-11T00:19:29.677

要更改指针，您需要将指针传递给指针，即`Object** pNext`. 要更改函数内变量的值，请传递一个指针。因此，通过扩展，要更改函数内部指针的值，请将指针传递给指针。

```
func() { 
    Object* pNext;
    func1(&pNext);
}

func1(Object** pNext) { *pNext = Segement->GetFirstPara(0); } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T12:50:47.070

请在实例化时初始化 pNext。现在在调试时它可能为 NULL，但在该字段中它将是 0x12AbD468 或其他内容。如果您有类似的测试：

```
if( NULL != pNext )
{
  pNext->DoSomething();
} 
```

......你的程序会爆炸，用户会生气，打电话给支持并以某种方式获得你的电话分机，直接打电话给你，给你听。

在您的情况下，由于 'func1()' 不使用 pNext 作为参数，您可以简单地从函数中返回它：

```
func()
{
  Object *pNext = func1();
}

Object* func1()
{
  return Segment->GetFirstPara(0);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T00:21:22.933

它应该是

```
 func()
{
  Object *pNext;
  func1(&pNext);
}

void func1(Object **pNext)
{
  *pNext = Segment->GetFirstPara(0);
} 
```

# php - php 的 json_decode 和 firefox 的 javascript 兼容性

> ID：193448
> 
> 赞同：2
> 
> 时间：2008-10-11T00:18:08.913
> 
> 标签：php, javascript, drupal, compatibility, json

如果你有类似的东西

```
var my_var = {"foo" : "bar"}; 
```

在 javascript 中（至少使用 firefox）并将其发布到 php 服务器，您将收到一个字符串，例如

```
{foo:"bar",} 
```

在服务器端。但是 php 中的 json_decode 不喜欢尾随的 ',' 或 'foo' 周围的缺少或引号。有没有一种清理接收到的 json 字符串的好方法？

json 对象与 drupal 模块 json 服务一起发送。

**编辑：**这个问题可以关闭。json 格式不正确是由于 drupal 模块中的 js 编写错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T00:19:36.133

您使用什么代码发布数据？确保您使用的是[json2.js 之](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)类的东西。

# java - 在 Mac OS X 中获取 AWT 框架的可绘制区域？

> ID：193457
> 
> 赞同：6
> 
> 时间：2008-10-11T00:21:59.423
> 
> 标签：java, macos, graphics, awt, paint

我已经继承[`java.awt.Frame`](https://docs.oracle.com/javase/9/docs/api/java/awt/Frame.html)并覆盖了该[`paint()`](https://docs.oracle.com/javase/9/docs/api/java/awt/Window.html#paint-java.awt.Graphics-)方法，因为我希望手动绘制窗口的全部内容。

**但是，在图形对象上，(0,0) 对应于标题栏装饰内**窗口的左上角，而不是第一个可绘制像素。

我能否以跨平台的方式确定第一个可绘制像素的坐标（即装饰的高度），避免使用 Mac OS X 特定的[软糖因子](https://en.wikipedia.org/wiki/Fudge_factor)？为了找到窗口的实际可绘制区域，我是否会被迫嵌套[Panel组件？](https://docs.oracle.com/javase/9/docs/api/java/awt/Panel.html)

在这里，我的代码无法将蓝色方块居中在窗口的可绘制区域内：

```
@Override
public void paint (Graphics g) {
    g.setColor(Color.BLUE);
    g.setPaintMode();
    g.fillRect(30, 30, getWidth()-60, getHeight()-60);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T00:28:00.127

您可以通过调用 getInsets 方法（在 Container 中定义）找到框架插图。Frame insets 在 Frame API 文档的顶部进行了讨论。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-22T00:08:36.573

所以你想绘制整个区域而不想要标题栏？

假设您（至少）使用 JDK 1.4，那么您可以将框架声明为“未装饰”（java.awt.Frame#setUndecorated(boolean)）。这样就不会创建标题栏，因此帧可绘制区域与帧消耗区域相同。

# c++ - 在调试模式下执行控制台应用程序后，如何让 Visual Studio 暂停？

> ID：193469
> 
> 赞同：66
> 
> 时间：2008-10-11T00:30:31.433
> 
> 标签：c++, visual-studio, unit-testing, boost, console

我有一组要作为控制台应用程序运行的 Boost 单元测试。

当我处理项目并运行测试时，我希望能够调试测试，并且希望在测试运行后控制台保持打开状态。

我看到如果我在发布模式下运行，程序退出后控制台窗口会保持打开状态，但在调试模式下并非如此。

我不想添加 'system("pause");' 或任何其他技巧，例如将字符读取到我的程序中。我只想让 Visual Studio 在运行带有调试的测试后暂停，就像我在发布模式下运行一样。如果测试的输出是在 Visual Studio 的输出窗口之一中捕获的，我也希望这样做，但这似乎也比它应该的要难。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2008-12-14T10:07:10.273

尝试使用`Ctrl`+`F5`组合运行应用程序。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2012-02-03T14:35:46.967

[http://connect.microsoft.com/VisualStudio/feedback/details/540969/missing-press-any-key-to-continue-when-lauching-with-ctrl-f5](http://connect.microsoft.com/VisualStudio/feedback/details/540969/missing-press-any-key-to-continue-when-lauching-with-ctrl-f5)

在旧版本中，即使您选择了“空项目”，它也会默认为控制台子系统，但在 2010 年不会，因此您必须手动设置它。为此，请在右侧或左侧的解决方案资源管理器中选择项目（可能已被选中，因此您不必担心这一点）。然后从菜单栏下拉菜单中选择“项目”，然后选择“项目*名称*属性”>“配置属性”>“链接器”>“系统”并设置第一个属性，下拉“子系统”属性为“控制台（/子系统：控制台）”。控制台窗口现在应该像往常一样在执行后保持打开状态。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-10-11T06:56:49.687

[Boost test为 Visual Studio](http://www.boost.org/doc/libs/1_56_0/libs/test/doc/html/utf/usage-recommendations/dot-net-specific.html)提供了以下使用建议，使您能够在编译结束时自动运行单元测试并将输出捕获到构建窗口中。

这个技巧的一个很好的副作用是它使您能够将测试失败视为编译错误。“...您可以使用用于编译错误分析的常用键盘快捷键/鼠标单击来跳过这些错误...”

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-11T04:20:04.073

在代码的最后一行设置断点。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-02-23T09:37:55.070

[我刚刚从http://social.msdn.microsoft.com/forums/en-US/Vsexpressvc/thread/1555ce45-8313-4669-a31e-b95b5d28c787/?prof=required](http://social.msdn.microsoft.com/forums/en-US/Vsexpressvc/thread/1555ce45-8313-4669-a31e-b95b5d28c787/?prof=required)复制：

以下对我有用:-)

///////////////////////////////////////// //////////////////////////////

这是控制台可能消失的另一个原因。和解决方案：

使用新的 Visual Studio 2010，即使您使用`Ctrl`+ `F5`aka“不调试就开始”，您也可能会看到这种行为。这很可能是因为您创建了一个“空项目”而不是“Win32 控制台应用程序”。如果您将项目创建为“Win32 控制台应用程序”，则可以忽略它，因为它不适用。

在旧版本中，即使您选择了“空项目”，它也会默认使用控制台子系统，但在 Visual Studio 2010 中则不会，因此您必须手动设置它。为此，请在右侧或左侧的解决方案资源管理器中选择项目（可能已被选中，因此您不必担心这一点）。

然后从菜单栏下拉菜单中选择“项目”，然后选择“项目*名称*属性”→“配置属性”→“链接器”→“系统”并设置第一个属性，下拉“子系统”属性为“控制台(/子系统：控制台）”。控制台窗口现在应该像往常一样在执行后保持打开状态。

///////////////////////////////////////// //////////////////////////////

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2010-11-14T01:56:46.457

如果是控制台应用程序，请使用`Ctrl`+ `F5`。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-25T21:39:53.407

你说你不想使用`system("pause")`黑客。为什么不？

如果是因为您不希望程序在*未*调试时提示，那么有一种解决方法。这对我有用：

```
void pause () {
    system ("pause");
}

int main (int argc, char ** argv) {
    // If "launched", then don't let the console close at the end until
    // the user has seen the report.
    // (See the MSDN ConGUI sample code)
    //
    do {
        HANDLE hConsoleOutput = ::GetStdHandle (STD_OUTPUT_HANDLE);
        if (INVALID_HANDLE_VALUE == hConsoleOutput)
            break;
        CONSOLE_SCREEN_BUFFER_INFO csbi;
        if (0 == ::GetConsoleScreenBufferInfo (hConsoleOutput, &csbi))
            break;
        if (0 != csbi.dwCursorPosition.X)
            break;
        if (0 != csbi.dwCursorPosition.Y)
            break;
        if (csbi.dwSize.X <= 0)
            break;
        if (csbi.dwSize.Y <= 0)
            break;
        atexit (pause);
    } while (0); 
```

我只是将此代码粘贴到我正在编写的每个新控制台应用程序中。如果程序正在从命令窗口运行，则光标位置不会是 <0,0>，并且不会调用`atexit()`. 如果它已从您的调试器（任何调试器）启动，则控制台光标位置将为 <0,0> 并且`atexit()`将执行调用。

我从以前在 MSDN 库中的示例程序中得到了这个想法，但我认为它已被删除。

注意：system() 例程的 Microsoft Visual Studio 实现需要 COMSPEC 环境变量来识别命令行解释器。如果这个环境变量搞砸了——例如，如果你在 Visual Studio 项目的调试属性中遇到问题，以至于在程序启动时环境变量没有正确传递——那么它就会默默地失败.

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-05-03T10:50:11.137

在 Boost.Test 中，有一个`--auto_start_dbg`参数用于在测试失败时（异常或断言失败）进入调试器。出于某种原因，它对我不起作用。

请参阅[http://www.boost.org/doc/libs/1_40_0/libs/test/doc/html/utf/usage-recommendations/dot-net-specific.html](http://www.boost.org/doc/libs/1_40_0/libs/test/doc/html/utf/usage-recommendations/dot-net-specific.html)

出于这个原因，我创建了我的自定义 test_observer，它会在出现断言失败或异常时进入调试器。当我们在调试器下运行时，这在调试版本中启用。

在我的单元测试 EXE 文件的源文件之一中，我添加了以下代码：

```
#ifdef _DEBUG

#include <boost/test/framework.hpp>
#include <boost/test/test_observer.hpp>

struct BoostUnitTestCrtBreakpointInDebug: boost::unit_test::test_observer
{
    BoostUnitTestCrtBreakpointInDebug()
    {
        boost::unit_test::framework::register_observer(*this);
    }

    virtual ~BoostUnitTestCrtBreakpointInDebug()
    {
        boost::unit_test::framework::deregister_observer(*this);
    }

    virtual void assertion_result( bool passed /* passed */ )
    {
        if (!passed)
            BreakIfInDebugger();
    }

    virtual void exception_caught( boost::execution_exception const& )
    {
        BreakIfInDebugger();
    }

    void BreakIfInDebugger()
    {
        if (IsDebuggerPresent())
        {
            /**
             * Hello, I know you are here staring at the debugger :)
             *
             * If you got here then there is an exception in your unit
             * test code. Walk the call stack to find the actual cause.
             */
            _CrtDbgBreak();
        }
    }
};

BOOST_GLOBAL_FIXTURE(BoostUnitTestCrtBreakpointInDebug);

#endif 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-11T01:04:16.810

这实际上会更费力，但您可以在 VS.Net 中构建，从常规命令行 (cmd.exe) 运行它，然后在它开始运行后附加到进程。然而，这可能不是您正在寻找的解决方案。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-02-15T23:35:40.247

我会在您自己选择的特定时间（毫秒）内使用“等待”命令。应用程序一直执行到您要检查的行，然后在时间到期后继续。

包括`<time.h>`标题：

```
clock_t wait;

wait = clock();
while (clock() <= (wait + 5000)) // Wait for 5 seconds and then continue
    ;
wait = 0; 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-10-26T03:28:09.280

或者您可以使用 boost_test “测试日志输出”。

[http://www.boost.org/doc/libs/1_47_0/libs/test/doc/html/utf/user-guide/test-output/test-log.html](http://www.boost.org/doc/libs/1_47_0/libs/test/doc/html/utf/user-guide/test-output/test-log.html)

那么控制台窗口是否显示都无关紧要，并且您的构建日志记录可以将单元测试输出保留为用于检查失败构建的工件......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-11T01:16:29.233

只需使用 log4net 之类的日志库，并将其记录到文件 appender。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-11T01:58:55.373

您还可以将可执行文件设置为外部工具，并将该工具标记为*Use output window*。这样，该工具的输出将在 Visual Studio 本身中可见，而不是单独的窗口。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2010-03-13T23:21:26.357

我用 F11 启动应用程序并在 unit_test_main.ipp 的某处获得一个断点（可以是汇编代码）。我使用 shift-f11 (Step out) 来运行单元测试并在 CRT 中获取下一条汇编指令（通常在 mainCRTStartup() 中）。我使用 F9 在该指令处设置断点。

在下一次调用时，我可以使用 F5 启动应用程序，运行测试后应用程序将中断，因此我有机会查看控制台窗口

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-08-05T12:54:12.197

添加以下行将执行一个简单的 MS-DOS，`pause`不显示任何消息。

```
system("pause >nul | set /p \"=\""); 
```

并且不需要`Ctrl`+ `F5`（这将使您的应用程序在发布模式下运行）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-01-12T23:40:18.180

提示用户输入。

[https://www.youtube.com/watch?v=NIGhjrWLWBo](https://www.youtube.com/watch?v=NIGhjrWLWBo)

展示了如何为 C++ 做到这一点。对于 Node.js，这是直接从文档中获取的（并且有效）：

```
'use strict';

console.log('Hello world');

const readline = require('readline');
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

rl.question('Press enter to continue...', (answer) => {
    rl.close(); /* discard the answer */
}); 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2010-06-05T17:40:54.633

在最后做一个 readline（它是“forma cochina”，就像我们在哥伦比亚说的那样，但它有效）：

```
static void Main(string[] args)
{
    .
    .
    .
    String temp = Console.ReadLine();
} 
```

# c++ - BOOST_MPL_ASSERT 和 BOOST_STATIC_ASSERT 哪个更好？

> ID：193471
> 
> 赞同：12
> 
> 时间：2008-10-11T00:32:26.373
> 
> 标签：c++, boost

我记得`BOOST_MPL_ASSERT`曾经是首选。这仍然是真的吗？有谁知道为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-26T19:51:02.063

*[回答我自己的问题]*

这取决于。这是一个苹果与橘子的比较。尽管相似，但这些宏不可互换。以下是每个工作原理的摘要：

`BOOST_STATIC_ASSERT( P )`如果 . 生成编译错误`P != true`。

`BOOST_MPL_ASSERT(( P ))`如果 . 生成编译错误`P::type::value != true`。

尽管*需要双括号，但后一种形式特别有用，因为**如果*使用来自 Boost.MPL 或 TR1 的*布尔空元元函数*`<type_traits>`作为谓词，它可以生成更多信息性错误消息。

这是一个示例程序，演示了如何使用（和滥用）这些宏：

```
#include <boost/static_assert.hpp>
#include <boost/mpl/assert.hpp>
#include <type_traits>
using namespace ::boost::mpl;
using namespace ::std::tr1;

struct A {};
struct Z {};

int main() {
        // boolean predicates
    BOOST_STATIC_ASSERT( true );          // OK
    BOOST_STATIC_ASSERT( false );         // assert
//  BOOST_MPL_ASSERT( false );            // syntax error!
//  BOOST_MPL_ASSERT(( false ));          // syntax error!
    BOOST_MPL_ASSERT(( bool_< true > ));  // OK
    BOOST_MPL_ASSERT(( bool_< false > )); // assert

        // metafunction predicates
    BOOST_STATIC_ASSERT(( is_same< A, A >::type::value ));// OK
    BOOST_STATIC_ASSERT(( is_same< A, Z >::type::value ));// assert, line 19
    BOOST_MPL_ASSERT(( is_same< A, A > ));                // OK
    BOOST_MPL_ASSERT(( is_same< A, Z > ));                // assert, line 21
    return 0;
} 
```

为了比较，以下是我的编译器 (Microsoft Visual C++ 2008) 为上面的第 19 行和第 21 行生成的错误消息：

```
1>static_assert.cpp(19) : error C2027: use of undefined type 'boost::STATIC_ASSERTION_FAILURE<x>'
1>        with
1>        [
1>            x=false
1>        ]
1>static_assert.cpp(21) : error C2664: 'boost::mpl::assertion_failed' : cannot convert parameter 1 from 'boost::mpl::failed ************std::tr1::is_same<_Ty1,_Ty2>::* ***********' to 'boost::mpl::assert<false>::type'
1>        with
1>        [
1>            _Ty1=A,
1>            _Ty2=Z
1>        ]
1>        No constructor could take the source type, or constructor overload resolution was ambiguous 
```

因此，如果您使用元函数（如此[处](http://www.boost.org/doc/libs/1_38_0/libs/mpl/doc/refmanual/metafunction.html)定义）作为谓词，那么`BOOST_MPL_ASSERT`代码既不冗长，又在断言时提供更多信息。

对于简单的布尔谓词，`BOOST_STATIC_ASSERT`尽管其错误消息可能不太清楚（取决于您的编译器），但代码的冗长程度较低。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-11T01:58:56.043

`BOOST_MPL_ASSERT`（仍然）通常被认为更好。来自它的消息更容易看到（如果你使用 ，也更容易理解`BOOST_MPL_ASSERT_MSG`）。几个月前有一些关于 deprecating 的讨论`BOOST_STATIC_ASSERT`，尽管我认为每个人最终都同意世界上仍有它的空间。

# java - 如何创建一个 .INI 文件以在 Java 中存储一些设置？

> ID：193474
> 
> 赞同：21
> 
> 时间：2008-10-11T00:35:03.357
> 
> 标签：java, settings, configuration-files

我想创建一个 ini 文件来存储我的应用程序的一些设置。找到 jar 文件所在的位置并在那里创建一个 ini 文件是个好主意吗？如果是，那么我怎样才能找到 jar 文件的位置？

但是，如果您知道此类问题的更好解决方案，我想听听其中的一些。

**编辑**：我正在使用 mac，我想在 Windows 中运行相同的应用程序。我可以在 System.getProperty("user.home") 目录中写一些东西，但如果用户决定删除应用程序，我想保持系统清洁。没有更好的方法来存储设置文件，例如与应用程序在同一目录中？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-11T11:35:11.810

您可以使用 ClassLoader 找到您的应用程序目录。请参阅：[Java：查找应用程序目录](http://illegalargumentexception.blogspot.com/2008/04/java-finding-application-directory.html)。使用*.properties*文件而不是*.INI*文件- 您可以通过[Properties](http://java.sun.com/javase/6/docs/api/java/util/Properties.html)类加载和保存它。

 *正如其他人所指出的，您不应将用户设置写入应用程序目录。如果用户对应用程序目录没有写权限怎么办？如果您的应用程序同时被同一系统上的多个用户使用怎么办？这些情况都不是不寻常的，即使在 Windows 上也是如此。

您可能仍想从应用程序目录加载一些设置——也许管理员已经在那里配置了默认设置。

一个常见的约定是将用户设置保存到用户的主目录：

```
/home/user/.eclipse
C:\Documents and Settings\User\.eclipse 
```

尽管这意味着您可能会留下杂散文件，但如果用户重新安装应用程序，这可能会有所帮助。在自述文件中记录这些内容。以下是如何创建和获取对目录的引用：

```
public static File getSettingsDirectory() {
    String userHome = System.getProperty("user.home");
    if(userHome == null) {
        throw new IllegalStateException("user.home==null");
    }
    File home = new File(userHome);
    File settingsDirectory = new File(home, ".myappdir");
    if(!settingsDirectory.exists()) {
        if(!settingsDirectory.mkdir()) {
            throw new IllegalStateException(settingsDirectory.toString());
        }
    }
    return settingsDirectory;
} 
```

在类 unix 操作系统上，以句点 (".myappdir") 开头的目录名称将使目录隐藏。在 Windows 上，它将位于*My Documents*下方，因此用户不会看到该目录，除非他们去寻找它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-11T12:01:32.270

如果设置仅由您的应用程序编写（而不是手动编辑），请考虑使用[Preferences API](http://docs.oracle.com/javase/8/docs/technotes/guides/preferences/index.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T00:39:28.670

您不应该将临时文件存储在应用程序的安装目录中。请记住，运行应用程序的用户可能没有对该目录的写入权限。放置此类内容的最安全位置是 C:\Documents and Settings\username\Application Data\ApplicationName 文件夹（根据需要调整名称）。

尽管如此，我可能会将这种类型的东西存储在注册表中，而不是他们计算机上的文件中。（但是，这只是我。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T00:42:01.987

这取决于您的 ini 在正常情况下是否需要人类可读/可写。如果没有，您可以使用属性文件而不是 ini 文件，并将其存储在“用户”目录中。

至于查找 jar 文件，您必须找到已知从 jar 加载的类的 ClassLoader，检查它是否是适当类型的 ClassLoader（即它*确实*是从 jar 加载的），然后您可以提取从那的路径。如果这真的是你想要的，我可能会挖掘出代码来做到这一点。我不一定会推荐它。

**编辑**user.home 属性将为您提供可以安全使用的用户目录。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-11T00:46:47.157

通常，Java 程序员不使用 .ini 文件，而是使用 .properties 文件（不同的格式）。如果你愿意，你可以使用 java.lang.Properties 类作为一个很好的编程包装器。

虽然您**可以**通过调用类的 .class 成员的 getProtectionDomain().getCodeSource().getLocation() 来获取 jar 文件的位置，但我**不**建议您这样做。

我会将文件写入 System.getProperty("user.home") 目录 - 用户的主目录，或者如果它真的是临时的，则 System.getProperty("java.io.tmpdir")

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-01-19T17:18:54.663

使用 .properties 文件而不是 INI 文件的想法很好。此外，如果您在其中存储一些敏感数据，您可以考虑对其进行加密。看一下这个：

[https://www.owasp.org/index.php/How_to_encrypt_a_properties_file](https://www.owasp.org/index.php/How_to_encrypt_a_properties_file)

或这个：

[在java中加密和解密属性文件值](https://stackoverflow.com/questions/3769622/encrypt-and-decrypt-property-file-value-in-java)

# java - 如何为 Maven 构建的可执行 JAR 指定 JVM 参数

> ID：193483
> 
> 赞同：10
> 
> 时间：2008-10-11T00:43:42.763
> 
> 标签：java, maven-2, jar, executable-jar

使用 Maven 构建可执行 JAR 时，如何指定执行 JAR 时使用的 JVM 参数？

我可以使用`<mainClass>`. 我怀疑 JVM 参数有一个类似的属性。特别是我需要指定最大内存（例如-Xmx500m）。

这是我的组装插件：

```
 <plugin>
    <artifactId>maven-assembly-plugin</artifactId>
    <configuration>
      <descriptorRefs>
        <descriptorRef>jar-with-dependencies</descriptorRef>
      </descriptorRefs>
      <archive>
        <manifest>
          <addClasspath>true</addClasspath>
          <mainClass>com.me.myApplication</mainClass>
        </manifest>
      </archive>
    </configuration>
  </plugin> 
```

[编辑/跟进：根据这篇](http://forums.sun.com/thread.jspa?threadID=633125&messageID=3667132)文章和[这篇](http://www.javalobby.org/forums/thread.jspa?threadID=15486&tstart=0#91817576)文章，似乎不可能为可执行 JAR 指定 JVM 参数。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-12T02:34:04.770

我不知道任何这样的机制。JVM 配置由调用 java 命令指定。

这是 jar 文件规范，它明显没有提到 Main-Class 以外的任何属性用于独立执行：

[http://java.sun.com/javase/6/docs/technotes/guides/jar/jar.html](http://java.sun.com/javase/6/docs/technotes/guides/jar/jar.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-12T18:20:58.977

首先，让我说，任何这种棘手的事情可能很难是有原因的。

如果您真的需要，这种方法可能对您有用。如所写，它假定“java”在调用者的路径上。

概述：

1.  将 Bootstrapper 类声明为 jar 清单中的主类。

2.  引导程序产生另一个进程，我们在“真正的”主类上调用 java（传入任何你想要的命令行参数）。

3.  将子进程 System.out 和 System.err 重定向到引导程序各自的流

4.  等待子进程完成

这是一篇[很好的背景文章](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html)。

**src/main/java/scratch/Bootstrap.java** - 这个类在 pom.xml 中定义为 jar 的主类：`<mainClass>scratch.Bootstrap</mainClass>`

```
package scratch;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.PrintStream;

public class Bootstrap {
    class StreamProxy extends Thread {
        final InputStream is;
        final PrintStream os;

        StreamProxy(InputStream is, PrintStream os) {
            this.is = is;
            this.os = os;
        }

        public void run() {
            try {
                InputStreamReader isr = new InputStreamReader(is);
                BufferedReader br = new BufferedReader(isr);
                String line = null;
                while ((line = br.readLine()) != null) {
                    os.println(line);
                }
            } catch (IOException ex) {
                throw new RuntimeException(ex.getMessage(), ex);
            }
        }
    }

    private void go(){
        try {
            /*
             * Spin up a separate java process calling a non-default Main class in your Jar.  
             */
            Process process = Runtime.getRuntime().exec("java -cp scratch-1.0-SNAPSHOT-jar-with-dependencies.jar -Xmx500m scratch.App");

            /*
             * Proxy the System.out and System.err from the spawned process back to the user's window.  This
             * is important or the spawned process could block.
             */
            StreamProxy errorStreamProxy = new StreamProxy(process.getErrorStream(), System.err);
            StreamProxy outStreamProxy = new StreamProxy(process.getInputStream(), System.out);

            errorStreamProxy.start();
            outStreamProxy.start();

            System.out.println("Exit:" + process.waitFor());
        } catch (Exception ex) {
            System.out.println("There was a problem execting the program.  Details:");
            ex.printStackTrace(System.err);

            if(null != process){
                try{
                    process.destroy();
                } catch (Exception e){
                    System.err.println("Error destroying process: "+e.getMessage());
                }
            }
        }
    }

    public static void main(String[] args) {
        new Bootstrap().go();
    }

} 
```

**src/main/java/scratch/App.java** - 这是您程序的正常入口点

```
package scratch;

public class App 
{
    public static void main( String[] args )
    {
        System.out.println( "Hello World! maxMemory:"+Runtime.getRuntime().maxMemory() );
    }
} 
```

调用：`java -jar scratch-1.0-SNAPSHOT-jar-with-dependencies.jar` 返回：

```
Hello World! maxMemory:520290304
Exit:0 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-05T16:57:33.120

作为对 David Carlson 的回答，您可以通过使用 java.home 系统属性来定位 java 可执行文件，而不是依赖用户的路径来查找它，从而使其不那么脆弱。此外，您可能还应该将标准输入重定向到子进程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-16T21:31:43.993

如果你这样想的话，我认为这是可以做到的。生成一个`.bat`包含命令的文件：

`> java .. yourClass.. -D<jvmOption1> -D<jvmOption2>...`

您可以尝试查看这个适用于 maven 的[应用程序汇编器插件](http://www.mojohaus.org/appassembler/appassembler-maven-plugin/usage-program-jvmsettings.html)。

我试过了，似乎有效。我仍然不清楚如何使用略有不同的内容生成 .bat 文件，但我认为这是可行的。

作为另一种选择，您可能总是尝试在项目的资源子文件夹中创建 .bat 文件，并将该子文件夹包含在您的分发中。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2011-10-21T10:16:52.167

古老的问题，但在我的谷歌搜索中出现了这个确切的问题，所以我正在回答它。

尝试

```
<configuation>
...
<argLine> -Xmx500m </argLine>
...
</configuation> 
```

# php - PHP DOM：相当新手的问题

> ID：193488
> 
> 赞同：1
> 
> 时间：2008-10-11T00:47:11.493
> 
> 标签：php, xml, dom

我刚刚开始用 PHP 修改 XML 操作，但我偶然发现了一些意想不到的东西。这是我用作测试输入的 XML：

```
<list>
    <activity1> running </activity1>
    <activity2> swimming </activity2>
    <activity3> soccer </activity3>
</list> 
```

现在，我期待这个 PHP 代码会输出“activity1”：

```
$xmldoc = new DOMDocument();
$xmldoc->load('file.xml');

//the line below would make $root the <list> node
$root = $xmldoc->firstChild;

//the line below would make $cnode the first child 
//of the <list> node, which is <activity1>
$cnode = $root->firstChild;

//this should output 'activity1'
echo 'element name: ' . $cnode->nodeName; 
```

相反，此代码输出#text。在打印节点名称之前，我可以通过在代码中插入新行来解决这个问题：

```
$cnode = $cnode->nextSibling; 
```

现在，我本来希望打印“activity2”，但正在打印“activity1”。到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T01:01:15.067

第一个*节点*是开始列表标记和活动1 标记之间的文本（在本例中为空格），下一个*节点*是活动1*元素*。元素与节点不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T01:40:34.567

要获得您期望的行为，您需要传入 LIBXML_NOBLANKS 作为 load() 调用的第二个参数

```
<?php
$xmldoc = new DOMDocument();
$xmldoc->load('file.xml', LIBXML_NOBLANKS);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T19:40:28.287

如果您使用 XPath 来查询您的文档，则无需担心这种奥秘。用于`DOMDocument::xpath_eval()`评估模式`/list/*`，无论如何，您将得到的只是顶级元素的子元素`list`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T06:06:27.307

A note on Czimi's answer: removing whitespace-only nodes will not prevent you from having to check the type of node (whether it is an element, a text node, a comment...). In general if you're interested in only selecting element nodes, you'll want to do something like this:

```
while($nodeInQuestion->nodeType != 1 && $nodeInQuestion->nextSibling) {
    $nodeInQuestion = $nodeInQuestion->nextSibling;
} 
```

This is sort of pseudo-code. Obviously you'll need to handle failure somehow if you're looking for an element and reach the end of the parentNode's childNodes before you find it.

# php - PHP中的UTC偏移量

> ID：193499
> 
> 赞同：49
> 
> 时间：2008-10-11T00:58:36.260
> 
> 标签：php, timezone, utc

相对于当前（系统）时区，在 PHP 中获取 UTC 偏移的最简单方法是什么？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2008-10-11T01:06:27.680

```
 date('Z'); 
```

以秒为单位返回 UTC 偏移量。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2016-03-15T20:17:31.887

```
// will output something like +02:00 or -04:00
echo date('P'); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-10-11T01:06:20.673

[`timezone_offset_get()`](http://us.php.net/manual/en/function.timezone-offset-get.php)

```
$this_tz_str = date_default_timezone_get();
$this_tz = new DateTimeZone($this_tz_str);
$now = new DateTime("now", $this_tz);
$offset = $this_tz->getOffset($now); 
```

未经测试，但应该可以工作

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2015-06-09T15:08:09.687

我对奥斯卡所做的做了一个稍微修改的版本。

```
date_default_timezone_set('America/New_York');
$utc_offset =  date('Z') / 3600; 
```

这给了我从我的时区 EST 到 UTC 的偏移量，以小时为单位。

$utc_offset 的值为 -4。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-05-29T21:33:49.260

这是相同的 JavaScript`date.getTimezoneOffset()`函数：

```
<?php
echo date('Z')/-60;
?> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-03-23T17:31:57.570

只需您可以这样做：

```
//Object oriented style
function getUTCOffset_OOP($timezone)
{
    $current   = timezone_open($timezone);
    $utcTime  = new \DateTime('now', new \DateTimeZone('UTC'));
    $offsetInSecs =  $current->getOffset($utcTime);
    $hoursAndSec = gmdate('H:i', abs($offsetInSecs));
    return stripos($offsetInSecs, '-') === false ? "+{$hoursAndSec}" : "-{$hoursAndSec}";
}

//Procedural style
function getUTCOffset($timezone)
{
    $current   = timezone_open($timezone);
    $utcTime  = new \DateTime('now', new \DateTimeZone('UTC'));
    $offsetInSecs =  timezone_offset_get( $current, $utcTime);
    $hoursAndSec = gmdate('H:i', abs($offsetInSecs));
    return stripos($offsetInSecs, '-') === false ? "+{$hoursAndSec}" : "-{$hoursAndSec}";
}

$timezone = 'America/Mexico_City';

echo "Procedural style<br>";
echo getUTCOffset($timezone); //-06:00
echo "<br>";
echo "(UTC " . getUTCOffset($timezone) . ") " . $timezone; // (UTC -06:00) America/Mexico_City
echo "<br>--------------<br>";
echo "Object oriented style<br>";
echo getUTCOffset_OOP($timezone); //-06:00
echo "<br>";
echo "(UTC " . getUTCOffset_OOP($timezone) . ") " . $timezone; // (UTC -06:00) America/Mexico_City 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-01-05T15:55:42.893

`date("Z")`将返回相对于服务器时区而不是用户机器时区的 UTC 偏移量。要获取用户的机器时区，您可以使用 javascript`getTimezoneOffset()`函数返回 UTC 时间和本地时间之间的时差，以分钟为单位。

```
<script type="text/javascript">
    d = new Date();
    window.location.href = "page.php?offset=" + d.getTimezoneOffset();
</script> 
```

并且`page.php`其中包含您的 php 代码，您可以使用该偏移值做任何您想做的事情。或者，您可以根据需要通过 Ajax 将偏移值发送到您的 php 脚本，而不是重定向到另一个页面。

# php - 一个 Project Euler Puzzler（特别是在 PHP 中）

> ID：193514
> 
> 赞同：0
> 
> 时间：2008-10-11T01:05:12.173
> 
> 标签：php, math, puzzle

最近有另一个 Project Euler 问题，但我认为这更具体一些（我只对基于 PHP 的解决方案真正感兴趣）所以我还是在问。

[问题 #5](http://projecteuler.net/index.php?section=problems&id=5)要求您：“能被 1 到 20 的所有数字整除的最小数字是多少？”

现在，我已经解决了两次。曾经效率非常低，效率更高，但我离一个特别复杂的答案还很远（而且我在数学上并不是特别扎实，因此我的蛮力解决方案）。我可以看到几个可以改进的地方，但我想知道你们中是否有人可以展示一个更有效的解决方案来解决这个问题。

*剧透：这是我的不太理想（运行 7 秒）但仍然可以接受的解决方案（不确定如何处理双 $... 只是假装你只看到 1...

```
 function euler5(){
        $x = 20;

        for ($y = 1; $y < 20; $y++) {

            if (!($x%$y)) {

            } else {  
                $x+=20;
                $y = 1;  
            }   

        }echo $x;
     }; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T01:08:16.317

收集 1 到 20 之间所有数字的质因数。计算每个质因数的最大指数，我们有`16 = 2**4`，`9 = 3**2`，以及 5、7、11、13、17、19（每个仅出现一次）。乘以很多，你就有了答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-11T01:37:24.247

在 php 中它看起来像这样：

```
<?php
function gcd($a,$b) {
    while($a>0 && $b>0) {
        if($a>$b) $a=$a-$b; else $b=$b-$a;        
    }
    if($a==0) return $b;
    return $a;
}
function euler5($i=20) {
    $euler=$x=1;
    while($x++<$i) {
        $euler*=$x/gcd($euler,$x);
    }
    return $euler;
}

?> 
```

它至少比您发布的速度快两倍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T01:14:50.720

克里斯·杰斯特-杨是对的。

一般来说，如果你想要能被从 1 到 N 的所有数整除的最小数，你会想要找到从 2 到 N 的所有素数，并且对于每个素数，找出它除以任何素数的最大次数。范围内的数字。这可以通过找到不大于 N 的素数的最大幂来计算。

在 20 的情况下，正如 Chris 指出的，2^4 是 2 不大于 20 的最大幂，3^2 是 3 不大于 20 的最大幂，对于所有其他素数，只有一次幂不大于 20。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-11T04:29:10.093

您可以删除一些被除以的数字，例如 1 是不必要的，所有自然数都可以被 1 整除。您也不需要 2，因此，所有数字都可以被 2 的倍数整除（4、8、16、等）也能被 2 整除。所以相关数字将是 11、12、13、14、15、16、17、18 和 19。

所以：

```
<?
function eulerPuzzle()
{
  $integers = array( 11,12,13,14,15,16,17,18,19 );

  for ($n = 20; 1; $n += 20 ) {
    foreach ($integers as $int) { 
      if ( $n % $int ) { 
    break; 
      }
      if ( $int == 19 ) { 
    die ("Result:" . $n); 
      }
    }
  }
}

eulerPuzzle();
?> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-23T23:08:47.503

```
<?php
$i=20;
while ($i+=20) {
    for ($j=19;$j!==10;--$j){
        if ($i%$j) continue 2;
    }
    die ("result: $i\n");
} 
```

是迄今为止最快、最短的 php 解决方案。在我的比赛中，比 Czimi 的速度快大约 1.4 倍。但是查看 python 解决方案，这是一个不错的算法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T04:19:50.927

有些人真的想多了……

在红宝石中：

```
puts 5*7*9*11*13*16*17*19 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-07T08:57:47.430

@人们做简单的数学；我不确定这是否是练习的目标。你要学习新的语言和新的表演方式。仅仅通过计算器进行计算并不是正确的处理方式。

而且我知道这是一个旧帖子中的帖子，但它仍然出现在谷歌搜索结果中:)

用代码（即 PHP）进行操作，我发现这是最快的解决方案：

```
function eulerPuzzle() {
    $integers = array (11, 12, 13, 14, 15, 16, 17, 18, 19 );

    for($n = 2520; 1; $n += 2520) {
        foreach ( $integers as $int ) {
            if ($n % $int) {
                break;
            }
            if ($int == 19) {
                die ( "Result:" . $n );
            }
        }
    }
}

eulerPuzzle (); 
```

是的，它是 CMS 的修改版。它更快的主要原因是因为当您阅读问题时，他们已经声明前 10 个整数的最小可能数字是 2520。因此，您可以只增加 2520 而不是 20。导致循环次数减少 126 倍

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-11T05:00:02.560

我知道你说的是 PHP，但这是我用 Python 编写的草稿。

```
#!/usr/bin/env python

from operator import mul

def factor(n):
    factors = {}
    i = 2
    while i < n and n != 1:
        while n % i == 0:
            try:
                factors[i] += 1
            except KeyError:
                factors[i] = 1
            n = n / i
        i += 1
    if n != 1:
        factors[n] = 1
    return factors

base = {}
for i in range(2, 2000):
    for f, n in factor(i).items():
        try:
            base[f] = max(base[f], n)
        except KeyError:
            base[f] = n

print reduce(mul, [f**n for f, n in base.items()], 1) 
```

它没有我能做到的那么优雅，但它可以在 0.15 秒内计算从 2 到 2000 的数字的最小公倍数。如果您的迭代解决方案每秒可以处理十亿个候选者，则需要 10^849 年才能完成。

换句话说，不要费心优化错误的算法。

# javascript - 如何在 JavaScript 中模拟宏？

> ID：193536
> 
> 赞同：30
> 
> 时间：2008-10-11T01:15:39.813
> 
> 标签：javascript, macros, metaprogramming

我知道 JavaScript 不支持宏（Lisp 风格的），但我想知道是否有人有解决方案来模拟宏？我用谷歌搜索了它，其中一种解决方案建议使用`eval()`，但正如他所说，成本会很高。

他们真的不必很花哨。我只想和他们做一些简单的事情。而且它不应该使调试变得更加困难:)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-11T16:57:31.160

你可以使用[parenscript](http://common-lisp.net/project/parenscript/)。这将为您提供 Javascript 的宏。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-05T01:43:50.150

Mozilla 的一个库（称为[SweetJS](http://sweetjs.org/)）旨在模拟 JavaScript 中的宏。例如，您可以使用 SweetJS 将`function`关键字替换为`def`.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-07-21T12:28:10.837

现在还可以使用[ClojureScript](https://github.com/clojure/clojurescript/)将 clojure 编译为 javascript 并以这种方式获取宏。注意 ClojureScript 使用 Google Closure。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-09-07T19:27:48.833

我用javascript编写了一个gameboy模拟器，并以这种方式模拟cpu仿真的宏：

宏代码（该函数返回一个带有宏代码的字符串）：

```
function CPU_CP_A(R,C) { // this function simulates the CP instruction, 
  return ''+             // sets CPU flags and stores in CCC the number
  'FZ=(RA=='+R+');'+     // of cpu cycles needed
  'FN=1;'+
  'FC=RA<'+R+';'+
  'FH=(RA&0x0F)<('+R+'&0x0F);'+
  'ICC='+C+';';
} 
```

使用“宏”，所以代码是“即时”生成的，我们不需要对它进行函数调用或为每个指令编写大量重复的代码......

```
OP[0xB8]=new Function(CPU_CP_A('RB',4)); // CP B
OP[0xB9]=new Function(CPU_CP_A('RC',4)); // CP C
OP[0xBA]=new Function(CPU_CP_A('RD',4)); // CP D
OP[0xBB]=new Function(CPU_CP_A('RE',4)); // CP E
OP[0xBC]=new Function('T1=HL>>8;'+CPU_CP_A('T1',4)); // CP H
OP[0xBD]=new Function('T1=HL&0xFF;'+CPU_CP_A('T1',4)); // CP L
OP[0xBE]=new Function('T1=MEM[HL];'+CPU_CP_A('T1',8)); // CP (HL)
OP[0xBF]=new Function(CPU_CP_A('RA',4)); // CP A 
```

现在我们可以像这样执行模拟代码：

```
OP[MEM[PC]](); // MEM is an array of bytes and PC the program counter 
```

希望能帮助到你...

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-10-26T10:53:34.620

```
function unless(condition,body) {
    return 'if(! '+condition.toSource()+'() ) {' + body.toSource()+'(); }';
}

eval(unless( function() {
    return false;
  }, function() {
    alert("OK");
})); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-06T10:05:37.210

[LispyScript](https://github.com/santoshrajan/lispyscript)是最新的编译成 Javascript 的语言，它支持宏。它具有类似 Lisp 的树语法，但也保持相同的 Javascript 语义。免责声明：我是[LispyScript](https://github.com/santoshrajan/lispyscript)的作者。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-05-09T18:53:56.230

查看 Linux/Unix/GNU M4 处理器。它是适用于任何语言的通用且强大的宏处理器。它特别面向 JavaScript 所属的 Algol 风格的语言。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-10-11T01:50:58.667

Javascript被解释。Eval 并不比 Javascript 中的其他任何东西更昂贵。

# javascript - 有没有人使用/创建过“鱼眼”表格列？

> ID：193540
> 
> 赞同：3
> 
> 时间：2008-10-11T01:16:33.913
> 
> 标签：javascript, jquery

有没有人给表格列“鱼眼”效果？我正在谈论将鼠标悬停在表格列上时的扩展效果。如果有人尝试过，我很乐意看到一些代码。

编辑：...或手风琴效果

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-11T01:58:30.333

它不是为了一张桌子，但这是效果：

[http://safalra.com/web-design/javascript/mac-style-dock/](http://safalra.com/web-design/javascript/mac-style-dock/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T08:38:43.617

虽然不是基于表的解决方案，但这是一个快速的概念验证，我使用 JQuery 来看看我是否可以做基于列的手风琴效果。或许能给你一些启发……

```
<html>
<head>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript">
$(document).ready(function() {
   $("#table > div:even").addClass("row");
   $("#table > div:odd").addClass("altrow");
   $("#table > div > div").addClass("normal");
   $("div[class*='col']").hover(
      function () {
            var myclass = $(this).attr("class");
            $("div[class*='col']").css("width","20px");
            $("div[class*='"+myclass+"']").css("width","80px").css("overflow","auto");
      }, 
      function () {
            $("div[class*='col']").css("width","40px").css("overflow","hidden");
      }
   )
 });
</script>
<style type="text/css">
.row{
    background-color: #eee;
    float:left;
}
.altrow{
    background-color: #fff;
    float:left;
}
.normal{
    width: 40px;
    overflow: hidden;
    float:left;
    padding :3px;
    text-align:center;
}
</style>
</head>
<body>
<div id="table">
    <div>
        <div class="col1">Column1</div>
        <div class="col2">Column2</div>
        <div class="col3">Column3</div>
    </div>
    <br style="clear:both" />
    <div>
        <div class="col1">Column1</div>
        <div class="col2">Column2</div>
        <div class="col3">Column3</div>
    </div>
    <br style="clear:both" />
    <div>
        <div class="col1">Column1</div>
        <div class="col2">Column2</div>
        <div class="col3">Column3</div>
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-14T20:18:37.337

不需要 javascript 这只花了我几分钟的时间来解决

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/2001/REC-xhtml11-20010531/DTD/xhtml11-flat.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Example</title>
        <style type="text/css">
            td {
                border: thin black solid;
                width: 3em;
                height: 3em;
            }

            td:hover {
                background-color: red;
                width: 5em;

                /*height: 5em;*/
                /*uncomment the above if you also want to zoom the rows*/
            }
            </style>
        </head>
    <body>
        <table>
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                </tr>
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                </tr>
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                </tr>
            <tr>
                <td>1</td>
                <td>2</td>
                <td>3</td>
                <td>4</td>
                </tr>
            </table>
        </body>
    </html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-14T10:57:37.110

也许魔术表是您正在寻找的： http: [//www.grvisualisation.50webs.com/examples.html](http://www.grvisualisation.50webs.com/examples.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T01:59:38.617

列比行要复杂得多，但是我会这样做：

*   对每列的每个 TD 应用唯一的 CSS 类
*   附加 MouseIn 和 MouseOut 事件
*   选择具有列类名称的所有元素，并应用第二个“鱼眼”类
*   在鼠标移出时，删除该类。

编辑：我误解鱼眼更像是带有高光的斑马条纹......在列上做鱼眼会很棘手，请执行与我上面列出的相同的过程，但将动画应用于每个单元格而不是新的 css 类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-13T06:04:32.397

这是一种丑陋的效果，但仅适用于 CSS 的 :hover 您可以使用一些 JS 使其看起来更平滑：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
  <style>
    table{
      width: 150px;
      height: 150px;
    }
    tr{
      height: 20px;
    }
    tr:hover{
      height: 30px;
    }
    td{
      width: 20px;
      border: 1px solid black;
      text-align:center;
    }
    td:hover{
      width: 30px;
    }

  </style>

  </head>

  <body>
  <table>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
  </table>
  </body>
  </html> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-11T07:53:37.683

我认为乔纳森走在正确的轨道上。您需要方法来查找列中的所有单元格，以及相邻的列和行。我认为只需三个级别的“缩放”即可获得不错的效果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-23T13:41:10.120

the code below uses css to make cell wider on :hover, and jquery to toggle (display) additional content in the given cell... and toggle it again (hide) when you are no longer hovering the cell.

[http://jsfiddle.net/berteh/QDhcR/12/](http://jsfiddle.net/berteh/QDhcR/12/)

CSS:

```
 td {
     border: thin black solid;
     width: 3em;
 }
 td:hover {
     background-color: YellowGreen;
     max-width: 5em;
     font-size: 130%;
 } 
```

Javascript:

```
$(document).ready(function() {
    $('td').hover(function () {
        $(this).find('.desc').toggle(300);
    });
}); 
```

works on a simple table HTML:

```
<table>
  <tr>
        <th>row1</th>
        <td>1<div class="desc">descZ</div></td>
        <td>2<div class="desc">descU</div></td>
        <td>3<div class="desc">descI</div></td>
        <td>4<div class="desc">descO</div></td>
    </tr>

  <tr>
        <th>row2</th>
        <td>1<div class="desc">descZ</div></td>
        <td>2<div class="desc">descU</div></td>
        <td>3<div class="desc">descI</div></td>
        <td>4<div class="desc">descO</div></td>
    </tr>
</table> 
```

# javascript - 在 JavaScript 中执行循环的最佳方法是什么

> ID：193547
> 
> 赞同：29
> 
> 时间：2008-10-11T01:21:18.397
> 
> 标签：javascript, jquery, loops, macros

我偶然发现了几种在 JavaScript 中循环的方法，我最喜欢的是：

```
for(var i = 0; i < a.length; i++){
    var element = a[i];
} 
```

但是正如这里测试的那样（[http://www.robertnyman.com/2008/04/11/javascript-loop-performance/](http://www.robertnyman.com/2008/04/11/javascript-loop-performance/)），它可能应该被写成长度只计算一次。

在 jQuery 中有一个 .each 可以粘贴一个函数。我更喜欢这个，因为我不必像上面的解决方案那样输入两次数组。

如果 JavaScript 支持宏，那么你自己动手做就是小菜一碟，但遗憾的是它不支持。

那你们用什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2008-10-11T01:35:12.737

我已经开始在相关的地方使用迭代器。性能是合理的，但更重要的是它允许您封装循环逻辑：

```
function createIterator(x) {
    var i = 0;

     return function(){
       return x[i++];
    };
} 
```

然后使用：

```
var iterator=createIterator(['a','b','c','d','e','f','g']);

iterator(); 
```

返回“一”；

```
iterator(); 
```

返回“b”；

等等。

要迭代整个列表并显示每个项目：

```
无功电流；

而（当前=迭代器（））
{
    控制台.log（当前）；
}

```

请注意，上述内容仅适用于迭代包含“非虚假”值的列表。如果此数组包含以下任何一项：

*   0
*   错误的
*   “”
*   空值
*   钠

上一个循环将在该项目处停止，并不总是您想要/期望的。

为了避免这种使用：

```
var current;

while((current=iterator())!==undefined)
{
   console.log(current);
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-11T01:51:57.697

对原始的小改进，只计算一次数组大小：

```
for(var i = 0, len = a.length; i < len; i++){ var element = a[i]; } 
```

另外，我看到很多 for..in 循环。但请记住，它在技术上并不符合犹太教规，并且会特别导致 Prototype 出现问题：

```
for (i in a) { var element = a[i]; } 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-11T02:01:09.440

只需先将长度存储在变量中。

```
 var len = a.length;
  for (var i = 0; i < len; i++) {
    var element = a[i];
  } 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-14T15:10:54.930

我知道我迟到了，但我对不依赖于顺序的循环使用反向循环。

与@Mr. 非常相似。麝鼠 - 但简化了测试：

```
var i = a.length, element = null;
while (i--) {
  element = a[i];
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-11T01:26:00.120

您可以始终使用 while 循环，并事先计算数组限制。

```
Var max = a.length-1;
var i = 0;

while(i <= max)
{
var element = a[i];
i++;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-11T18:49:45.410

如果数组中有很多元素并且速度是一个问题，那么您希望使用从最高到最低迭代的 while 循环。

```
 var i = a.length;
  while( --i >= 0 ) {
    var element = a[i];
    // do stuff with element
  } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-12T10:14:12.080

我自己不使用它，但我的一位同事使用这种风格：

```
var myArray = [1,2,3,4];
for (var i = 0, item; item = myArray[i]; ++i) {
    alert(item);
} 
```

就像 Ash 的回答一样，如果您的数组中有“错误”值，这会遇到问题。为避免该问题，请将其更改为`(item = myArray[i]) != undefined`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-07T23:09:36.297

我看不出使用标准 for(;;) 循环有什么问题。一个小测试

```
var x;
var a = [];
// filling array
var t0 = new Date().getTime();
for( var i = 0; i < 100000; i++ ) {
    a[i] = Math.floor( Math.random()*100000 );
}

// normal loop
var t1 = new Date().getTime();
for( var i = 0; i < 100000; i++ ) {
    x = a[i];
}

// using length
var t2 = new Date().getTime();
for( var i = 0; i < a.length; i++ ) {
    x = a[i];
}

// storing length (pollution - we now have a global l as well as an i )
var t3 = new Date().getTime();
for( var i = 0, l = a.length; i < l; i++ ) {
    x = a[i];
}

// for in
var t4 = new Date().getTime();
for( var i in a ) {
    x = a[i];
}

// checked for in
var t5 = new Date().getTime();
for( var i in a ) {
    if (a.hasOwnProperty(i)) {
        x = a[i];
    }
}

var t6 = new Date().getTime();
var msg = 'filling array: '+(t1-t0)+'ms\n'+
          'normal loop: '+(t2-t1)+'ms\n'+
          'using length: '+(t3-t2)+'ms\n'+
          'storing length: '+(t4-t3)+'ms\n'+
          'for in: '+(t5-t4)+'ms\n'+
          'checked for in: '+(t6-t5)+'ms';
console.log( msg ); 
```

结果是：

```
filling array: 227ms
normal loop: 21ms
using length: 26ms
storing length: 24ms 
for in: 154ms
checked for in: 176ms 
```

所以：- 因为 in 是最长的，使用 length 属性（这是一个属性，不需要计算）几乎和首先存储它一样快 - 这只是比使用整数慢一点。
AND a for() 是循环数组的常用方法，这是每个人都期望和理解的。

All of them add a variable to the scope they run in - i - which is a common name for this use and so shouldn't be used for other things. Storing the length first adds another var - l - to the scope, which is unnecesary

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-01-07T20:25:06.003

所以，首先你确定完美的 javascript 循环，我相信它应该是这样的：

ary.each(function() {$arguments[0]).remove();})

这可能需要prototype.js 库。

接下来，您对 arguments[0] 部分感到厌恶，并让代码从您的服务器框架自动生成。这仅在梯子位于海边时才有效。

现在，您已通过以下方式生成上述内容：

ary do: [:each | 每个元素删除]。

这带有完整的语法完成，并完全转换为上述 javascript。当他们阅读您的代码时，它会让以前没有使用 seasides 原型集成的人头晕目眩。它肯定也会让你感觉很酷。更不用说你可以在这里获得的极客增益。女孩们喜欢它！

# compiler-construction - 用自己的语言编写编译器

> ID：193560
> 
> 赞同：220
> 
> 时间：2008-10-11T01:30:56.600
> 
> 标签：compiler-construction, bootstrapping

直观地说，似乎语言的编译器`Foo`本身不能用 Foo 编写。更具体地说，语言的*第一个*编译器`Foo`不能用 Foo 编写，但任何后续编译器都可以用`Foo`.

但这真的是真的吗？我对阅读第一个编译器是用“自身”编写的语言有一些非常模糊的回忆。这可能吗，如果可以，怎么办？

* * *

## 回答 #1

> 赞同：251
> 
> 时间：2008-10-11T01:34:48.493

这称为“引导”。您必须首先用其他语言（通常是 Java 或 C）为您的语言构建编译器（或解释器）。完成后，您可以使用 Foo 语言编写新版本的编译器。你使用第一个引导编译器来编译编译器，然后使用这个编译的编译器来编译其他所有东西（包括它自己的未来版本）。

大多数语言确实是以这种方式创建的，部分原因是语言设计者喜欢使用他们正在创建的语言，还因为非平凡的编译器通常可以作为语言“完整”程度的有用基准。

Scala就是一个例子。它的第一个编译器是用 Martin Odersky 的实验性语言 Pizza 创建的。从 2.0 版开始，编译器完全用 Scala 重写。从那时起，旧的 Pizza 编译器可能会被完全丢弃，因为新的 Scala 编译器可以用于为未来的迭代进行编译。

* * *

## 回答 #2

> 赞同：78
> 
> 时间：2008-10-13T18:42:57.327

我记得听过一个[软件工程广播播客，其中 Dick Gabriel 谈到通过](http://www.se-radio.net/2008/01/episode-84-dick-gabriel-on-lisp/)**在纸上**用 LISP 编写一个准系统版本并将其手工组装成机器代码来引导原始 LISP 解释器。从那时起，其余的 LISP 功能都是用 LISP 编写和解释的。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-01-28T09:14:29.393

当你为 C 编写你的第一个编译器时，你是用其他语言编写的。现在，你有一个用于 C 的编译器，比如汇编程序。最终，您将来到必须解析字符串的地方，特别是转义序列。您将编写代码以转换`\n`为十进制代码 10（以及`\r`13 等）的字符。

编译器准备好后，您将开始用 C 重新实现它。这个过程称为“[引导](http://en.wikipedia.org/wiki/Bootstrapping_(compilers))”。

字符串解析代码将变为：

```
...
if (c == 92) { // backslash
    c = getc();
    if (c == 110) { // n
        return 10;
    } else if (c == 92) { // another backslash
        return 92;
    } else {
        ...
    }
}
... 
```

当它编译时，你有一个理解'\n'的二进制文件。这意味着您可以更改源代码：

```
...
if (c == '\\') {
    c = getc();
    if (c == 'n') {
        return '\n';
    } else if (c == '\\') {
        return '\\';
    } else {
        ...
    }
}
... 
```

那么 '\n' 是 13 的代码的信息在哪里？它在二进制文件中！就像 DNA：用这个二进制文件编译 C 源代码会继承这个信息。如果编译器自己编译，它会将这些知识传递给它的后代。从现在开始，无法仅从源代码中看出编译器会做什么。

如果你想在某个程序的源代码中隐藏病毒，你可以这样做：获取编译器的源代码，找到编译函数的函数并将其替换为这个：

```
void compileFunction(char * name, char * filename, char * code) {
    if (strcmp("compileFunction", name) == 0 && strcmp("compile.c", filename) == 0) {
        code = A;
    } else if (strcmp("xxx", name) == 0 && strcmp("yyy.c", filename) == 0) {
        code = B;
    }

    ... code to compile the function body from the string in "code" ...
} 
```

有趣的部分是 A 和 B。A 是`compileFunction`包含病毒的源代码，可能以某种方式加密，因此搜索生成的二进制文件并不明显。这确保了使用自身编译到编译器将保留病毒注入代码。

B 对于我们想要用我们的病毒替换的功能是相同的。例如，它可能是来自 Linux 内核的源文件“login.c”中的函数“login”。除了普通密码外，我们可以将它替换为接受 root 帐户密码“joshua”的版本。

如果您将其编译并作为二进制文件传播，则无法通过查看源代码来找到病毒。

想法的原始出处：[https ://web.archive.org/web/20070714062657/http://www.acm.org/classics/sep95/](https://web.archive.org/web/20070714062657/http://www.acm.org/classics/sep95/)

* * *

## 回答 #4

> 赞同：47
> 
> 时间：2008-10-11T07:58:51.747

*对以前的答案增加好奇心。*

这是[Linux From Scratch](http://www.linuxfromscratch.org/)手册中的一段话，在开始从源代码构建 GCC 编译器的步骤中。（Linux From Scratch 是一种安装 Linux 的方法，它与安装发行版完全不同，因为您必须编译目标系统的*每*一个二进制文件。）

> ```
> make bootstrap 
> ```
> 
> 'bootstrap' 目标不只是编译 GCC，而是多次编译。它使用第一轮编译的程序进行第二次编译，然后再次编译第三次。然后它会比较这些第二次和第三次编译，以确保它可以完美地复制自己。这也意味着它被正确编译。

使用“引导”目标的动机是，用于构建目标系统工具链的编译器可能与目标编译器的版本不同。以这种方式进行，肯定会在目标系统中获得一个可以自行编译的编译器。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2008-10-11T01:41:22.677

你不能自己编写编译器，因为你没有任何东西可以用来编译你的起始源代码。有两种方法可以解决这个问题。

最不受欢迎的是以下。您在汇编程序（yuck）中为最小的语言集编写了一个最小的编译器，然后使用该编译器来实现该语言的额外功能。建立自己的方式，直到您拥有一个具有所有语言功能的编译器。一个痛苦的过程，通常只有在您别无选择时才会完成。

首选方法是使用交叉编译器。您更改另一台机器上现有编译器的后端，以创建在目标机器上运行的输出。然后你有一个很好的完整编译器并在目标机器上工作。最流行的是 C 语言，因为有很多现有的编译器具有可替换的可插拔后端。

一个鲜为人知的事实是 GNU C++ 编译器有一个只使用 C 子集的实现。原因是通常很容易为新的目标机器找到 C 编译器，然后您可以从中构建完整的 GNU C++ 编译器。您现在已经在目标机器上安装了 C++ 编译器。

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-11-02T09:00:08.917

通常，您需要首先对编译器进行工作（如果是原始的）切割 - 然后您可以开始考虑使其自托管。在某些语言中，这实际上被认为是一个重要的里程碑。

根据我对“mono”的记忆，他们可能需要在反射中添加一些东西才能使其正常工作：mono 团队一直指出有些事情根本不可能用`Reflection.Emit`; 当然，MS 团队可能会证明他们错了。

这有几个*真正的*优点：对于初学者来说，这是一个相当不错的单元测试！而且您只需要担心一种语言（即 C# 专家可能不太了解 C++；但现在您可以修复 C# 编译器）。但我想知道这里的工作是否缺乏职业自豪感：他们只是*希望*它是自托管的。

不是一个编译器，但我最近一直在开发一个自托管的系统；代码生成器用于生成代码生成器......所以如果架构发生变化，我只需在其自身上运行它：新版本。如果有错误，我只是回到早期版本并重试。很方便，也很容易维护。

* * *

### 更新 1

我刚刚在 PDC 观看了 Anders 的[这段视频](https://channel9.msdn.com/blogs/pdc2008/tl16)，并且（大约一个小时后）他确实给出了一些更有效的理由——关于编译器即服务。只是为了记录。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-11T01:42:12.537

这是一个转储（实际上很难搜索的主题）：

*   [短暂聊天](http://www.cincomsmalltalk.com/userblogs/avi/blogView?showComments=true&entry=3284695382)

*   [C](http://bytes.com/forum/thread212166.html)

这也是[PyPy](http://en.wikipedia.org/wiki/PyPy)和[Rubinius](http://en.wikipedia.org/wiki/Rubinius)的想法：

（我认为这也可能适用于[Forth](http://en.wikipedia.org/wiki/Forth_%28programming_language%29)，但我对 Forth 一无所知。）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2019-12-20T23:49:58.057

我自己编写了 SLIC（用于实现编译器的语言系统）。然后手工编译成程序集。SLIC 有很多功能，因为它是五种子语言的单一编译器：

*   语法解析器编程语言 PPL
*   GENERATOR LISP 2 基于树爬行伪代码生成语言
*   ISO In Sequence，伪代码，优化语言
*   PSEUDO 宏类似于汇编代码生成语言。
*   MACHOP 汇编机器指令定义语言。

SLIC 的灵感来自 CWIC（编写和实现编译器的编译器）。与大多数编译器开发包不同，SLIC 和 CWIC 使用专门的、特定于领域的语言来解决代码生成问题。SLIC 扩展了 CWIC 代码生成，添加了 ISO、PSEUDO 和 MACHOP 子语言，将目标机器的细节从树爬行生成器语言中分离出来。

## LISP 2 树和列表

基于 LISP 2 的生成器语言的动态内存管理系统是一个关键组件。列表用方括号括起来的语言表示，其组件用逗号分隔，即三元素 [a,b,c] 列表。

树木：

```
 ADD
    /   \
  MPY     3
 /   \
5     x 
```

由第一个条目是节点对象的列表表示：

```
[ADD,[MPY,5,x],3] 
```

树通常以节点分开显示在分支之前：

```
ADD[MPY[5,x],3] 
```

## 使用基于 LISP 2 的生成器函数进行解析

生成器函数是一组命名的 (unparse)=>action> 对 ...

```
<NAME>(<unparse>)=><action>;
      (<unparse>)=><action>;
            ...
      (<unparse>)=><action>; 
```

非解析表达式是匹配树模式和/或对象类型的测试，将它们分开并将这些部分分配给局部变量以通过其程序操作进行处理。有点像采用不同参数类型的重载函数。除了 ()=> ... 测试按编码顺序进行尝试。第一个成功的 unparse 执行其相应的操作。unparse 表达式是反汇编测试。ADD[x,y] 匹配两个分支的 ADD 树，将其分支分配给局部变量 x 和 y。动作可能是一个简单的表达式或一个 .BEGIN ... .END 有界代码块。我今天会使用 c style { ... } 块。树匹配、[]、未解析规则可能会调用生成器，将返回的结果传递给操作：

```
expr_gen(ADD[expr_gen(x),expr_gen(y)])=> x+y; 
```

具体来说，上面的 expr_gen unparse 匹配一个有两个分支的 ADD 树。在测试模式中，将使用该分支调用放置在树分支中的单个参数生成器。它的参数列表虽然是分配返回对象的局部变量。上面的unparse指定了两个分支是ADD树反汇编，递归压每个分支到expr_gen。左分支返回放入局部变量 x。同样，右分支通过返回对象 y 传递给 expr_gen。以上可能是数字表达式求值器的一部分。上面有称为向量的快捷功能，而不是节点字符串，节点向量可以与相应动作的向量一起使用：

```
expr_gen(#node[expr_gen(x),expr_gen(y)])=> #action;

  node:   ADD, SUB, MPY, DIV;
  action: x+y, x-y, x*y, x/y;

        (NUMBER(x))=> x;
        (SYMBOL(x))=> val:(x); 
```

上面更完整的表达式求值器将 expr_gen 左分支的返回值分配给 x，右分支分配给 y。返回在 x 和 y 上执行的相应动作向量。最后一个 unparse=>action 对匹配数字和符号对象。

## 符号和符号属性

符号可能具有命名属性。val:(x) 访问 x 中包含的符号对象的 val 属性。广义符号表堆栈是 SLIC 的一部分。SYMBOL 表可以被推送和弹出，为函数提供本地符号。新创建的符号在顶部符号表中进行编目。符号查找首先从顶部表向后向下搜索符号表堆栈。

## 生成机器无关代码

SLIC 的生成器语言生成 PSEUDO 指令对象，将它们附加到节代码列表中。.FLUSH 导致其 PSEUDO 代码列表运行，从列表中删除每个 PSEUDO 指令并调用它。执行后，一个 PSEUDO 对象的内存被释放。PSEUDO 和 GENERATOR 动作的程序主体除了输出之外基本上是相同的语言。PSEUDO 旨在充当提供与机器无关的代码序列化的汇编宏。它们提供了从树爬行生成器语言中分离特定目标机器的方法。PSEUDO 调用 MACHOP 函数来输出机器代码。MACHOP 用于定义汇编伪操作（如 dc、定义常量等）和机器指令或使用向量入口的类似格式指令系列。它们只是将参数转换为组成指令的位域序列。MACHOP 调用旨在看起来像汇编，并在汇编显示在编译列表中时提供字段的打印格式。在示例代码中，我使用了可以轻松添加但不是原始语言的 c 样式注释。MACHOP 正在将代码生成到可寻址的内存中。SLIC 链接器处理编译器的输出。使用向量入口的 DEC-10 用户模式指令的 MACHOP：MACHOP 正在将代码生成到可寻址的内存中。SLIC 链接器处理编译器的输出。使用向量入口的 DEC-10 用户模式指令的 MACHOP：MACHOP 正在将代码生成到可寻址的内存中。SLIC 链接器处理编译器的输出。使用向量入口的 DEC-10 用户模式指令的 MACHOP：

```
.MACHOP #opnm register,@indirect offset (index): // Instruction's parameters.
.MORG 36, O(18): $/36; // Align to 36 bit boundary print format: 18 bit octal $/36
O(9):  #opcd;          // Op code 9 bit octal print out
 (4):  register;       // 4 bit register field appended print
 (1):  indirect;       // 1 bit appended print
 (4):  index;          // 4 bit index register appended print
O(18): if (#opcd&&3==1) offset // immediate mode use value else
       else offset/36;         // memory address divide by 36
                               // to get word address.
// Vectored entry opcode table:
#opnm := MOVE, MOVEI, MOVEM, MOVES, MOVS, MOVSI, MOVSM, MOVSS,
         MOVN, MOVNI, MOVNM, MOVNS, MOVM, MOVMI, MOVMM, MOVMS,
         IMUL, IMULI, IMULM, IMULB, MUL,  MULI,  MULM,  MULB,
                           ...
         TDO,  TSO,   TDOE,  TSOE,  TDOA, TSOA,  TDON,  TSON;
// corresponding opcode value:
#opcd := 0O200, 0O201, 0O202, 0O203, 0O204, 0O205, 0O206, 0O207,
         0O210, 0O211, 0O212, 0O213, 0O214, 0O215, 0O216, 0O217,
         0O220, 0O221, 0O222, 0O223, 0O224, 0O225, 0O226, 0O227,
                           ...
         0O670, 0O671, 0O672, 0O673, 0O674, 0O675, 0O676, 0O677; 
```

.MORG 36，O(18)：$/36；将位置与 36 位边界对齐，以八进制打印 18 位的位置 $/36 字地址。将 9 位 opcd、4 位寄存器、间接位和 4 位索引寄存器组合起来打印，就像单个 18 位字段一样。18 位地址/36 或立即值以八进制输出和打印。使用 r1 = 1 和 r2=2 打印出 MOVEI 示例：

```
400020 201082 000005            MOVEI r1,5(r2) 
```

使用编译器汇编选项，您可以在编译列表中获得生成的汇编代码。

## 把它连在一起

SLIC 链接器作为处理链接和符号解析的库提供。目标特定的输出加载文件格式必须为目标机器编写并与链接器库链接。

生成器语言能够将树写入文件并读取它们，从而实现多通道编译器。

## 代码生成和起源的简短总结

我首先检查了代码生成，以确保 SLIC 是一个真正的编译器编译器。SLIC 的灵感来自于 1960 年代后期由 Systems Development Corporation 开发的 CWIC（编写和实现编译器的编译器）。CWIC 只有 SYNTAX 和 GENERATOR 语言从 GENERATOR 语言中产生数字字节码。字节代码被放置或植入（CWIC 文档中使用的术语）到与命名部分相关的内存缓冲区中，并由 .FLUSH 语句写出。ACM 档案中提供了关于 CWIC 的 ACM 论文。

## 成功实现一种主要的编程语言

在 1970 年代后期，SLIC 被用于编写 COBOL 交叉编译器。主要由一个程序员在大约 3 个月内完成。我根据需要与程序员一起工作。另一位程序员为目标 TI-990 mini-COMPUTER 编写了运行时库和 MACHOP。该 COBOL 编译器每秒编译的行数比以汇编语言编写的 DEC-10 本机 COBOL 编译器要多得多。

## 更多的编译器然后通常谈论

从头开始编写编译器的很大一部分是运行时库。你需要一个符号表。你需要输入和输出。动态内存管理等。为编译器编写运行时库比编写编译器更容易。但是对于 SLIC，运行时库对于在 SLIC 中开发的所有编译器都是通用的。请注意，有两个运行时库。一种用于语言的（例如 COBOL）目标机器。另一个是编译器编译器运行时库。

我想我已经确定这些不是解析器生成器。所以现在对后端有一点了解，我可以解释解析器编程语言。

## 解析器编程语言

解析器是使用以简单方程形式编写的公式编写的。

```
<name> <formula type operator> <expression> ; 
```

最低级别的语言元素是字符。标记由语言字符的子集形成。字符类用于命名和定义这些字符子集。定义运算符的字符类是冒号 (:) 字符。作为该类成员的字符在定义的右侧编码。可打印字符包含在素数单 ' 字符串中。非打印字符和特殊字符可以用它们的数字序号表示。类成员由替代 | 分隔 操作员。类公式以分号结尾。字符类可能包括先前定义的类：

```
/*  Character Class Formula                                    class_mask */
bin: '0'|'1';                                                // 0b00000010
oct: bin|'2'|'3'|'4'|'5'|'6'|'7';                            // 0b00000110
dgt: oct|'8'|'9';                                            // 0b00001110
hex: dgt|'A'|'B'|'C'|'D'|'E'|'F'|'a'|'b'|'c'|'d'|'e'|'f';    // 0b00011110
upr:  'A'|'B'|'C'|'D'|'E'|'F'|'G'|'H'|'I'|'J'|'K'|'L'|'M'|
      'N'|'O'|'P'|'Q'|'R'|'S'|'T'|'U'|'V'|'W'|'X'|'Y'|'Z';   // 0b00100000
lwr:  'a'|'b'|'c'|'d'|'e'|'f'|'g'|'h'|'i'|'j'|'k'|'l'|'m'|
      'n'|'o'|'p'|'q'|'r'|'s'|'t'|'u'|'v'|'w'|'x'|'y'|'z';   // 0b01000000
alpha:  upr|lwr;                                             // 0b01100000
alphanum: alpha|dgt;                                         // 0b01101110 
```

skip_class 0b00000001 是预定义的，但可能会过度定义skip_class。

总而言之：字符类是只能是字符常量、字符序数或先前定义的字符类的替代列表。当我实现字符类时：类公式被分配了一个类位掩码。（如上面的注释所示）任何具有任何字符文字或序数的类公式都会导致分配一个类位。掩码是通过将包含的类的类掩码与分配的位（如果有）一起进行或运算而制成的。从字符类创建一个类表。由字符序号索引的条目包含指示字符的类成员资格的位。类测试是内联完成的。在 eax 中带有字符序数的 IA-86 代码示例说明了类测试：

```
test    byte ptr [eax+_classmap],dgt 
```

其次是：

```
jne      <success> 
```

或者

```
je       <failure> 
```

使用 IA-86 指令代码示例是因为我认为 IA-86 指令在今天更为广为人知。评估到其类掩码的类名与由字符序数（在 eax 中）索引的类表进行非破坏性与运算。非零结果表示类成员资格。（除了包含字符的 al（EAX 的低 8 位）之外，EAX 为零）。

这些旧编译器中的令牌有点不同。关键词没有被解释为记号。它们只是通过解析器语言中的引用字符串常量进行匹配。通常不保留带引号的字符串。可以使用修饰符。A + 保持字符串匹配。（即 +'-' 匹配 - 字符，成功时保留该字符） , 操作（即，'E'）将字符串插入到标记中。空格由令牌公式处理，跳过前导 SKIP_CLASS 字符，直到进行第​​一次匹配。请注意，明确的 skip_class 字符匹配将停止跳过，从而允许令牌以 skip_class 字符开头。字符串标记公式会跳过与单引号相当dd 字符或双引号字符串匹配的前导skip_class 字符。有趣的是在 " 引用的字符串中匹配 " 字符：

```
string .. (''' .ANY ''' | '"' $(-"""" .ANY | """""","""") '"') MAKSTR[]; 
```

第一个替代匹配任何单引号引号字符。正确的选择匹配一个双引号引用的字符串，该字符串可能包含使用两个 " 字符一起表示单个 " 字符的双引号字符。此公式定义了在其自己的定义中使用的字符串。右内选项 '"' $(-"""" .ANY | """""","""") '"' 匹配双引号引用的字符串。我们可以使用单个 ' 引号字符来匹配双引号 " 字符。但是在双引号 " 字符串中，如果我们希望使用 " 字符，我们必须使用两个 " 字符来获得一个。例如，在左内替代匹配除引号之外的任何字符：

```
-"""" .ANY 
```

使用负向窥视 -"""" 表示成功时（不匹配 " 字符）然后匹配 .ANY 字符（不能是 " 字符，因为 -"""" 消除了这种可能性）。正确的选择是采用 -"""" 匹配一个 " 字符并且失败是正确的选择：

```
"""""","""" 
```

尝试匹配两个 " 字符用单个双 " 替换它们，使用 """" 插入 thw 单个 " 字符。匹配结束字符串引号字符失败的两个内部替代方案，并调用 MAKSTR[] 以创建字符串对象。 $序列，成功时循环，运算符用于匹配序列。标记公式跳过前导跳过类字符（空白）。一旦进行第一次匹配，skip_class跳过被禁用。我们可以使用[]调用以其他语言编程的函数。MAKSTR []、MAKBIN[]、MAKOCT[]、MAKHEX[]、MAKFLOAT[] 和 MAKINT[] 是提供的库函数，它们将匹配的标记字符串转换为类型化对象。下面的数字公式说明了一个相当复杂的标记识别：

```
number .. "0B" bin $bin MAKBIN[]        // binary integer
         |"0O" oct $oct MAKOCT[]        // octal integer
         |("0H"|"0X") hex $hex MAKHEX[] // hexadecimal integer
// look for decimal number determining if integer or floating point.
         | ('+'|+'-'|--)                // only - matters
           dgt $dgt                     // integer part
           ( +'.' $dgt                  // fractional part?
              ((+'E'|'e','E')           // exponent  part
               ('+'|+'-'|--)            // Only negative matters
               dgt(dgt(dgt|--)|--)|--)  // 1 2 or 3 digit exponent
             MAKFLOAT[] )               // floating point
           MAKINT[];                    // decimal integer 
```

上述数字标记公式可识别整数和浮点数。-- 替代方案总是成功的。数字对象可用于计算。公式成功后，令牌对象被推入解析堆栈。(+'E'|'e','E') 中的指数前导很有趣。我们希望 MAKEFLOAT[] 总是有一个大写的 E。但是我们允许使用小写的“e”替换它，“E”。

您可能已经注意到字符类和标记公式的一致性。解析公式继续添加回溯选项和树构造运算符。回溯和非回溯替代运算符不得在表达式级别内混合。你可能没有（a | b \ c）混合非回溯| withe \回溯替代。(a\b\c)、(a|b|c) 和 ((a|b)\c) 是有效的。\ 回溯替代在尝试其左侧替代之前保存解析状态，并且在失败时在尝试正确替代之前恢复解析状态。在一系列备选方案中，第一个成功的备选方案满足该组。没有尝试进一步的替代方案。分解和分组提供了连续推进的解析。回溯替代在尝试其左替代之前创建解析的保存状态。当解析可能进行部分匹配然后失败时，需要回溯：

```
(a b | c d)\ e 
```

在上面，如果返回失败，则尝试替代 cd。如果然后 c 返回失败，则将尝试回溯替代方案。如果 a 成功而 b 失败，则将回溯并尝试解析。同样，a 失败 c 成功且 b 失败，则回溯解析并采用替代 e。回溯不限于公式内。如果任何解析公式在任何时候进行部分匹配然后失败，则解析将重置为顶部回溯并采用其替代方案。如果代码已输出，则可能会发生编译失败，因为回溯已创建。在开始编译之前设置回溯。返回失败或回溯到它是编译器失败。回溯是堆叠的。我们可以使用负数和正数？peek/look ahead 运算符在不推进解析的情况下进行测试。字符串测试是一个预览，只需要保存和重置输入状态。向前看将是一个解析表达式，它在失败之前进行部分匹配。使用回溯实现前瞻。

解析器语言既不是 LL 也不是 LR 解析器。但是一种用于编写递归体面解析器的编程语言，您可以在其中编程树构造：

```
:<node name> creates a node object and pushes it onto the node stack.
..           Token formula create token objects and push them onto 
             the parse stack.
!<number>    pops the top node object and top <number> of parstack 
             entries into a list representation of the tree. The 
             tree then pushed onto the parse stack.
+[ ... ]+    creates a list of the parse stack entries created 
             between them:
              '(' +[argument $(',' argument]+ ')'
             could parse an argument list. into a list. 
```

一个常用的解析示例是算术表达式：

```
Exp = Term $(('+':ADD|'-':SUB) Term!2); 
Term = Factor $(('*':MPY|'/':DIV) Factor!2);
Factor = ( number
         | id  ( '(' +[Exp $(',' Exp)]+ ')' :FUN!2
               | --)
         | '(' Exp ')" )
         (^' Factor:XPO!2 |--); 
```

Exp 和 Term 使用循环创建左手树。使用右递归的因子创建一个右手树：

```
d^(x+5)^3-a+b*c => ADD[SUB[EXP[EXP[d,ADD[x,5]],3],a],MPY[b,c]]

              ADD
             /   \
          SUB     MPY
         /   \   /   \
      EXP     a b     c
     /   \
    d     EXP     
         /   \
      ADD     3
     /   \
    x     5 
```

这是 cc 编译器的一些内容，它是带有 c 样式注释的 SLIC 的更新版本。函数类型（语法、标记、字符类、生成器、PSEUDO 或 MACHOP）由其 id 后面的初始语法确定。使用这些自上而下的解析器，您可以从程序定义公式开始：

```
program = $((declaration            // A program is a sequence of
                                    // declarations terminated by
            |.EOF .STOP)            // End Of File finish & stop compile
           \                        // Backtrack: .EOF failed or
                                    // declaration long-failed.
             (ERRORX["?Error?"]     // report unknown error
                                    // flagging furthest parse point.
              $(-';' (.ANY          // find a ';'. skiping .ANY
                     | .STOP))      // character: .ANY fails on end of file
                                    // so .STOP ends the compile.
                                    // (-';') failing breaks loop.
              ';'));                // Match ';' and continue

declaration =  "#" directive                // Compiler directive.
             | comment                      // skips comment text
             | global        DECLAR[*1]     // Global linkage
             |(id                           // functions starting with an id:
                ( formula    PARSER[*1]     // Parsing formula
                | sequencer  GENERATOR[*1]  // Code generator
                | optimizer  ISO[*1]        // Optimizer
                | pseudo_op  PRODUCTION[*1] // Pseudo instruction
                | emitor_op  MACHOP[*1]     // Machine instruction
                )        // All the above start with an identifier
              \ (ERRORX["Syntax error."]
                 garbol);                    // skip over error. 
```

// 注意在创建树时 id 是如何被分解并在以后组合的。

```
formula =   ("==" syntax  :BCKTRAK   // backtrack grammar formula
            |'='  syntax  :SYNTAX    // grammar formula.
            |':'  chclass :CLASS     // character class define
            |".." token   :TOKEN     // token formula
              )';' !2                // Combine node name with id 
                                     // parsed in calling declaration 
                                     // formula and tree produced
                                     // by the called syntax, token
                                     // or character class formula.
                $(-(.NL |"/*") (.ANY|.STOP)); Comment ; to line separator?

chclass = +[ letter $('|' letter) ]+;// a simple list of character codes
                                     // except 
letter  = char | number | id;        // when including another class

syntax  = seq ('|' alt1|'\' alt2 |--);

alt1    = seq:ALT!2 ('|' alt1|--);  Non-backtrack alternative sequence.

alt2    = seq:BKTK!2 ('\' alt2|--); backtrack alternative sequence

seq     = +[oper $oper]+;

oper    = test | action | '(' syntax ')' | comment; 

test    = string | id ('[' (arg_list| ,NILL) ']':GENCALL!2|.EMPTY);

action  = ':' id:NODE!1
        | '!' number:MAKTREE!1
        | "+["  seq "]+" :MAKLST!1;

//     C style comments
comment  = "//" $(-.NL .ANY)
         | "/*" $(-"*/" .ANY) "*/"; 
```

值得注意的是解析器语言如何处理注释和错误恢复。

我想我已经回答了这个问题。已经编写了 SLIC 继任者的很大一部分，这里是 cc 语言本身。目前还没有编译器。但我可以将它手动编译成汇编代码、裸 asm c 或 c++ 函数。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-11T08:18:22.487

GNAT 是 GNU Ada 编译器，需要完全构建 Ada 编译器。将其移植到没有现成可用的 GNAT 二进制文件的平台时，这可能会很痛苦。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-02T09:06:26.550

Mono 项目 C# 编译器已经“自托管”了很长时间，这意味着它是用 C# 本身编写的。

我所知道的是编译器是作为纯 C 代码启动的，但是一旦实现了 ECMA 的“基本”功能，他们就开始用 C# 重写编译器。

我不知道用同一种语言编写编译器的好处，但我确信它至少与语言本身可以提供的特性有关（例如，C 不支持面向对象的编程） .

[您可以在此处](http://www.mono-project.com/CSharp_Compiler)找到更多信息。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-02T09:23:31.523

实际上，出于上述原因，大多数编译器都是用它们编译的语言编写的。

第一个引导编译器通常是用 C、C++ 或汇编语言编写的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-04-23T03:03:33.713

是的，您可以为该语言的语言编写编译器。不，您不需要第一个编译器来引导该语言。

您需要引导的是该语言的实现。这可以是编译器或解释器。

从历史上看，语言通常被认为是解释语言或编译语言。解释器只为前者编写，编译器只为后者编写。因此，通常如果要为一种语言编写编译器，第一个编译器会用其他语言编写以引导它，然后，可以选择为主题语言重新编写编译器。但是用另一种语言编写解释器是一种选择。

这不仅仅是理论上的。我碰巧目前正在自己​​做这件事。我正在为我自己开发的一种语言 Salmon 开发编译器。我首先用 C 创建了一个 Salmon 编译器，现在我正在用 Salmon 编写编译器，这样我就可以让 Salmon 编译器工作，而无需使用任何其他语言编写的 Salmon 编译器。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-06-25T21:58:31.470

请注意，从技术上讲，您可以用一种仍然不存在的语言编写编译器。为了做到这一点，您创建了一个解释器，它是原始语言的一种低级语言，它通常是缓慢且无用的，因为它在执行任何操作之前解释语言的每个语句。

如果您阅读它，它确实看起来完全像预期的语言，但它的执行经过了一些过程，该过程在不止一个步骤中将其转换为可执行文件。

这个编译器通常非常慢，因为它使用了一些适用于几乎所有现有语言的通用数学过程，但优点是你下次除了在现有代码上使用生成的编译器之外什么都不做。

这次当然不用解释了。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2008-10-11T01:37:16.523

也许你可以写一个描述 BNF 的 BNF [。](http://en.wikipedia.org/wiki/Backus%2DNaur_form)

# javascript - 你如何在 ExtJs 中清除一棵树？

> ID：193561
> 
> 赞同：7
> 
> 时间：2008-10-11T01:31:02.027
> 
> 标签：javascript, extjs, extjs3

我设法创建了一个动态加载子节点的[Ext.tree.TreePanel](http://docs.sencha.com/ext-js/3-4/#!/api/Ext.tree.TreeNode)，但是我很难清除树并用新数据加载它。有人可以帮我写代码吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-16T09:58:08.107

来自 ExtJS 大师 Saki 的精彩博客。

```
while (node.firstChild) {
    node.removeChild(node.firstChild);
} 
```

[http://blog.extjs.eu/know-how/how-to-remove-all-children-of-a-tree-node/](http://blog.extjs.eu/know-how/how-to-remove-all-children-of-a-tree-node/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-04T14:51:15.463

在 Ext JS 4 中：

如果要重新加载树面板的数据，则需要重新加载树存储：

```
getCmp('treeId').getStore().load(); 
```

其中 treeId 是树的 id。如果您有商店 id，您可以直接在商店 id 上使用 load()。

删除所有子节点：

```
getCmp('treeId').getRootNode().removeAll(); 
```

但是，从其存储区重新加载树节点不需要删除子节点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-11T22:16:29.893

在我的例子中，我的 Ext 树有一个 AsyncTreeNode 类型的隐藏根节点。如果我想清除树并从服务器重新填充，这很简单：

```
tree.getRootNode().reload(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T02:25:37.083

我终于在他们的论坛上找到了答案。对于任何有兴趣的人来说，这里是：

```
if (tree)
{
    var delNode;
    while (delNode = tree.root.childNodes[0])
        tree.root.removeChild(delNode);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-28T02:10:11.273

您可以简单地使用`node.removeAll()`从该节点中删除所有子节点。

[http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.data.NodeInterface-method-removeAll](http://docs.sencha.com/extjs/4.2.1/#!/api/Ext.data.NodeInterface-method-removeAll)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-11T18:51:26.163

我遇到了类似的问题，我想出的解决方案是“标记”节点在折叠时尚未加载，从而在重新展开时强制重新加载。

```
listeners: {
   collapsenode: function(node){
   node.loaded = false;
}, 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-11T05:13:41.517

> ```
> if (tree) { var delNode; while (delNode = tree.root.childNodes[0]) tree.root.removeChild(delNode); } 
> ```

I don't know Ext, but I'm guessing that they have DOM abstraction that might make that easier. An equivalent in Prototype would be something like:

```
tree.root.immediateDescendants().invoke('remove'); // or
tree.root.select('> *').invoke('remove'); 
```

Unless `tree.root` refers to a collection object rather than the tree's root DOM node, but is borrowing DOM API method names? That seems really unlikely, especially for a modern JS library.

# php - PHP货币字符串转换为整数错误

> ID：193593
> 
> 赞同：4
> 
> 时间：2008-10-11T01:59:35.590
> 
> 标签：php, currency, casting

我有一个小型金融应用程序，前端是 PHP，后端是 MySQL。我有古老的偏见，我在 MySQL 中将货币值存储为整数美分。我的 HTML 表单允许输入美元值，例如“156.64”，我使用 PHP 将其转换为美分，然后将美分存储在数据库中。

我有一个函数可以从表单中清除美元值，并将其转换为美分。我去掉前导文本，去掉尾随文本，乘以 100 并转换为整数。最后一步是

`$cents = (integer) ($dollars * 100);`

这对几乎所有东西都适用，除了像 '156.64' 这样的极少数值始终转换为 15663 美分。为什么这样做？

如果我这样做：

`$cents = (integer) ($dollars * 100 + 0.5);`

然后它一直有效。为什么我需要添加该舍入值？

另外，我对将金额存储为整数而不是浮点值的偏见是否不再需要？现代浮动计算是否会产生足以保持 100% 准确会计的完美四舍五入和准确的货币价值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-11T02:12:58.807

如果您想要精确，您应该在 MySQL 中使用[DECIMAL数据类型存储您的货币值。](http://dev.mysql.com/doc/refman/5.0/en/numeric-types.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T02:21:11.117

你对花车的“偏见”永远不会被克服——这是它们工作方式的基础。无需过多详细说明，它们存储基于 2 的幂的数字，并且由于并非所有十进制数都可以以这种方式呈现，因此它并不总是有效。您唯一可靠的解决方案是将数字存储为数字序列和小数点的位置（根据上述 DECIMAL 类型）。

我不是 100% 使用 PHP，但是乘法是否有可能将整数转换为浮点数，从而准确地引入你想要避免的问题？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T04:03:14.203

货币/货币值不应该作为浮点数存储在数据库中（或在程序中使用）。

您的整数方法很好，在可用的情况下使用`DECIMAL`,`NUMERIC`或`MONEY`类型也是如此。

您的问题是由 $dollars 被视为浮点数引起的，而 PHP 没有更好的类型来处理金钱。根据分配 $dollars 的时间，它可能被视为字符串或浮点数，但如果它仍然是 * 100 操作的字符串（如果它看起来像浮点数），则肯定会转换为浮点数。

您最好自己将字符串解析为整数“金钱”值（使用正则表达式），而不是依赖 PHP 正在执行的隐式转换。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-11T04:33:30.757

铸造不像`round()`四舍五入那样，它会[截断](http://en.wikipedia.org/wiki/Truncation)小数点：`(int)3.99`yield `3`。`(int)-3.99`产量`-3`。

由于浮点运算经常会导致错误（并且可能不是您想要的方向），`round()`如果您想要可靠的舍入，请使用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-13T05:31:29.093

您发布的代码首先进行乘法运算，在将值转换为整数之前强制进行会引入错误的浮点计算。相反，您应该通过颠倒顺序来完全避免浮点运算。首先转换为整数值，然后执行算术运算。

假设之前的代码已经验证并格式化了输入，试试这个：

```
list($bills, $pennies) = explode('.', $dollars);
$cents = 100 * $bills + $pennies; 
```

您对代表货币的浮点值的偏见是有根据的，因为截断以及因为值从 base-10 转换为 base-2 并再次转换回来。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-01-04T23:00:02.480

你永远不应该以浮点数存储货币，因为它总是会得到你意想不到的结果。

查看 php [BC Maths](http://php.net/manual/en/book.bc.php)，它允许您将货币存储为字符串，然后对它们执行非常高精度的算术运算。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-14T13:29:23.730

如果您通过浮点运算（没有双关语）输入钱，那么将钱存储为整数是没有意义的。如果您想从 to 转换`string`并`int`与您的“偏见”保持一致，您可以简单地使用字符串函数。

您可以使用任意精度库除以 10（它们在内部将数字作为字符串处理），例如[bcdiv()](http://es.php.net/manual/en/function.bcdiv.php)或gmp_div_q( [)](http://es.php.net/manual/en/function.gmp-div-q.php)，但当然，您也可以从一开始就使用它来进行所有数学运算。

或者您可以使用纯字符串函数：

```
<?php
// Quick ugly code not fully tested
$input = '156.64';
$output = NULL;

if( preg_match('/\d+(\.\d+)?/', $input) ){
    $tmp = explode('.', $input);
    switch( count($tmp) ){
        case 1:
            $output = $tmp[0];
            break;

        case 2:
            $output = $tmp[0] . substr($tmp[1], 0, 2);
            break;

        default:
            echo "Invalid decimal\n";
    }
}else{
    echo "Invalid number\n";
}

var_dump($output);

?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-07-04T05:39:17.410

而不是使用

$cents = (integer) ($dollars * 100);

您可能想尝试使用：

$cents = bcmul($dollars, 100, 2);

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-01-14T12:31:21.917

从浮点数转换为整数时，数字将向**零**（[src](http://es2.php.net/manual/en/language.types.integer.php)）四舍五入。

阅读[浮点精度](http://es2.php.net/manual/en/language.types.float.php)警告。

# java - 简单的 Java Web 服务

> ID：193602
> 
> 赞同：3
> 
> 时间：2008-10-11T02:12:36.423
> 
> 标签：java, web-services, remoting

有谁知道将 Java 方法发布为 Web 服务的一种非常简单的方法？我真的不想要使用 Tomcat 或 Jetty 或任何其他容器框架的开销。

场景：我在一个服务类型应用程序中有一组 Java 方法，我想从本地 LAN 上的其他机器访问这些方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T04:05:37.240

好吧，Tomcat 或 Jetty 可能只是将一些方法发布为 Web 服务。但另一方面，它并不太复杂，他们可以完成这项工作，为什么不呢？

不久前我遇到了类似的问题，并且将 Tomcat 与 Axis2 一起使用。只需下载 Tomcat，解压缩，部署 Axis2 WAR。要发布 Web 服务，有几种方法，我采用的方法可能是最简单的一种：

只需像往常一样构建您的应用程序，并使用来自 javax.jws.* 的适当注释来注释 Web 服务类和方法。把所有东西都打包到一个罐子里。在 jar 文件的 META-INF 目录中创建一个 service.xml 并将其放入其中：

```
<service name="name of the service" scope="<one of request, session or application>">
    <description>
    optional description of your service
    </description>

    <messageReceivers>
        <messageReceiver mep="http://www.w3.org/2004/08/wsdl/in-only" class="org.apache.axis2.rpc.receivers.RPCInOnlyMessageReceiver" />
        <messageReceiver mep="http://www.w3.org/2004/08/wsdl/in-out"  class="org.apache.axis2.rpc.receivers.RPCMessageReceiver"/>
    </messageReceivers>

    <parameter name="ServiceClass" locked="false">put here the fully qualified name of your service class (e.g. x.y.z.FooService)</parameter>

</service> 
```

将 .jar 重命名为 .aar 并放入 /webapps/axis2/WEB-INF/services/ 目录。启动tomcat，服务就会被部署。您可以通过访问axis2页面（[http://localhost:8080/axis2/](http://localhost:8080/axis2/)）来检查它是否正在运行。在那里，您将看到部署了哪些服务以及导出了哪些方法。您还可以在那里获取 WSDL url 以连接到您的服务。

有关使用 Axis2 的更多信息，请阅读[http://ws.apache.org/axis2/1_4_1/contents.html](http://ws.apache.org/axis2/1_4_1/contents.html)。我在这里描述的方法在文档中找不到完全一样的，但它工作得很好。

**更新：**如果您只想提供 Web 服务并且真的不需要 Tomcat 的任何其他功能（例如提供普通旧网页、jsps 或其他东西），您也可以使用 Axis2 独立服务器。但除了设置部分，它不会改变我描述的任何东西。

我写了一个稍微详细一点的版本，可以在以下位置找到：[http](http://www.slashslash.de/lang/en/2008/10/java-webservices-mit-apache-tomcat-und-axis2/) ://www.slashslash.de/lang/en/2008/10/java-webservices-mit-apache-tomcat-und-axis2/ （不要让 URL 中的德语激怒你，它是用英文写的）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T02:19:39.527

Web 服务依赖于 HTTP。你可能不想要 tomcat 或 Jetty。在这种情况下，您必须自己实现 HTTP。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T13:48:06.253

嗯。为什么不只使用[RMI](http://java.sun.com/javase/technologies/core/basic/rmi/index.jsp)？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T02:14:21.957

Jetty 相当轻巧。否则，我认为 XML-RPC 是您唯一明智的选择。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T22:35:56.027

比西蒙描述的更简单的解决方案是使用已经做到这一点的工具。如果您使用 Eclipse，您可以使用[http://ws.apache.org/axis2/tools/1_2/eclipse/servicearchiver-plugin.html](http://ws.apache.org/axis2/tools/1_2/eclipse/servicearchiver-plugin.html)

生成 aar 文件。

# opengl - 简单的线框格式？

> ID：193603
> 
> 赞同：6
> 
> 时间：2008-10-11T02:12:38.200
> 
> 标签：opengl, 3d, file-format, wireframe

我正在寻找一种用于线框模型的简单文件格式。我知道 VRML、u3D 等，但这些对于我的需求来说似乎很重要。我的标准是：

*   必须有明确的规范。无论是开放的还是非常完善的/记录在案的。
*   我只需要（想要）简单的模型——顶点和边。我不想处理面孔或物体。如果格式支持更多，那很好，只要我可以忽略它们。
*   最终用户工具不是必需的，但会很棒。如果不是，它必须是人类可读的（并且对于简单模型是可编辑的）。
*   能够注释或至少标记节点会很好（但不是必需的）。
*   我使用什么语言并不重要，但可能的选项是 Java/C++ 和 OpenGL

还是我只是更好地将顶点/边缘列表写入文本文件并完成它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-11T04:18:40.613

Wavefront OBJ 是一种非常简单的文本文件格式，用于存储 3d 模型，并且所有 3d 建模应用程序（例如，maya、3dsmax、lightwave）都支持它，因此您可以非常轻松地导出和导入模型。

您可以在此处阅读更多信息和规格：

[http://www.fileformat.info/format/wavefrontobj/](http://www.fileformat.info/format/wavefrontobj/)

我建议不要制作自己的文件格式。Wavefront OBJ 非常简单且指定明确。

这是一个 2x2 平面的示例。**v**代表顶点坐标，**f**代表面的描述（哪些顶点是相连的）：

```
v -0.500000 -0.000000 0.500000
v 0.000000 -0.000000 0.500000
v 0.500000 -0.000000 0.500000
v -0.500000 0.000000 0.000000
v 0.000000 0.000000 0.000000
v 0.500000 0.000000 0.000000
v -0.500000 0.000000 -0.500000
v 0.000000 0.000000 -0.500000
v 0.500000 0.000000 -0.500000
v -0.500000 -0.000000 0.500000
v 0.000000 -0.000000 0.500000
v 0.500000 -0.000000 0.500000
v -0.500000 0.000000 0.000000
v 0.000000 0.000000 0.000000
v 0.500000 0.000000 0.000000
v -0.500000 0.000000 -0.500000
v 0.000000 0.000000 -0.500000
v 0.500000 0.000000 -0.500000
f 1/1 2/2 5/5 4/4
f 2/2 3/3 6/6 5/5
f 4/4 5/5 8/8 7/7
f 5/5 6/6 9/9 8/8
f 10/10 11/11 14/14 13/13
f 11/11 12/12 15/15 14/14
f 13/13 14/14 17/17 16/16
f 14/14 15/15 18/18 17/17 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-11T04:59:26.507

我不知道有任何以线框视图为目标的格式。（仅限边缘/顶点）您几乎总是必须至少处理面部。幸运的是，除非您有非常特殊的需求，否则只需使用面部列表中的任何 API 即可完成边缘列表线框渲染。

至于格式，[OBJ](http://www.martinreddy.net/gfx/3d/OBJ.spec)既好又简单，虽然有点过时了。它也可能是最容易找到文档的格式。Microsoft 的 X 文件非常适合快速而肮脏的渲染，但我一直偏爱 Quake 格式。但是，它们往往非常面向游戏，因此包含很多您可能不想要的信息。

如果这些都不能满足您的需求，请查看[COLLADA](http://www.collada.org/)。它本身可能对您不起作用，但您可以将快速导出器编写为您自己的格式，仅包含边缘/顶点信息，此时您基本上支持地球上的每个建模包:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T02:16:48.567

在文本文件中执行这些列表可能更容易。这是我首先想到的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T05:04:37.590

POV-Ray 的[RAW 三角形格式](http://ozviz.wasp.uwa.edu.au/~pbourke/dataformats/povraw/)是我认为最简单的格式。在我看来，你真的不能再简单了。我在几分钟内就实现了这个负载——这是一种*非常简单的格式*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-18T19:01:56.740

OBJ 是最普遍和最简单的，但如果您需要的不仅仅是顶点位置、法线和单个纹理坐标，它就会崩溃。它根本不可扩展。它也是基于文本的，因此在使用大网格时会遇到问题。

GTO 已成为一种新的交换格式。它简单、快速且可扩展，并且有经过生产验证的开源代码可以读写它们：

[Gto 文件格式](http://www.tweakfilms.com/products/open-source-software/gto "Gto 文件格式")

这已在多个 VFX 和游戏工作室的生产中使用，但是将加载器编写为 OBJ 文件的工作量大致相同（其中一个示例是 OBJ 到 GTO 转换器）。

检查一下，帮助阻止 Collada 膨胀病毒的传播。

# asp.net - Lucene.Net 是否管理访问同一索引的多个线程，一个索引而另一个正在搜索？

> ID：193624
> 
> 赞同：16
> 
> 时间：2008-10-11T04:07:56.330
> 
> 标签：asp.net, concurrency, lucene, lucene.net

在将 Lucene.Net 与 ASP.NET 一起使用时，我可以想象一个 Web 请求可以触发对索引的更新，而另一个 Web 请求正在执行搜索。Lucene.Net 是否内置了管理并发访问的能力，还是我必须管理它，以避免“被另一个进程使用”错误？

编辑：在阅读文档和实验之后，这就是我认为我学到的：有两个问题，线程安全和并发。多线程是“安全的”，因为您不能对索引做任何坏事。但是，这是安全的，代价是一次只有一个对象锁定索引。第二个对象会出现并抛出异常。因此，您不能打开搜索并期望另一个线程中的作者能够更新索引。如果一个线程忙于更新索引，那么尝试创建搜索器将会失败。

此外，搜索者会看到他们打开时的索引，因此如果您保留它们并更新索引，他们将不会看到更新。

我希望我的搜索者看到最新的更新。

我的设计，到目前为止似乎还有效，是我的作者和搜索者共享一个锁，这样他们就不会失败——他们只是等待——直到当前的写入或搜索完成。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-10-11T22:07:38.007

根据[这个页面](http://darksleep.com/lucene/)，

> 索引和搜索不仅是线程安全的，而且是进程安全的。这意味着：
> 
> *   多个索引搜索器可以同时读取 lucene 索引文件。
> *   索引编写器或读取器可以在搜索进行时编辑 lucene 索引文件
> *   多个索引写入器或读取器可以尝试同时编辑 lucene 索引文件（关闭索引写入器/读取器很重要，这样它将释放文件锁定）。但是，查询解析器不是线程安全的，因此每个使用索引的线程都应该有自己的查询解析器。
> 
> 然而，索引编写器是线程安全的，因此您可以在人们搜索索引时更新索引。但是，您必须确保具有打开索引搜索器的线程关闭它们并打开新的，以获取新更新的数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-29T20:29:42.633

You may have issues, if your indexing thread is creating a new document which results in merging of some index segments, then the merged segments will be deleted and new segment will be created. The problem is that your index searcher loaded up all the segments when it was opened, such that is has "pointers" to those segments which existed when it was opened. Now if the index writer does a segment merge and deletes a segment, your index searcher will still think that segment file exists and will fail with a "file not found error". What you really need to do is seperate your writable index from your searchable index, by using SOLR or doing your own index snapshot replication similar to what SOLR does. I have build very similar system to SOLR using .NET and Lucene.NET on Windows, using NTFS hard-links to make efficient snapshot replication. I can give you more info if you are interested.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T05:01:44.850

与管理对索引的并发写入相比，您没有问题。我有一条更简单的 SOLR 路径，因为它作为服务器运行，所以它为我抽象了大部分差异。

# java - 如何防止浮点数和双精度数在 Java 和 C 中被截断？

> ID：193629
> 
> 赞同：3
> 
> 时间：2008-10-11T04:11:42.063
> 
> 标签：java, c, floating-point

当我给 Java 和 C 提供大的浮点数和双精度数（在十亿范围内）时，它们会将它们转换为科学计数法，从而在此过程中失去精度。我怎样才能阻止这种行为？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-11T04:18:19.553

对于 Java，请查看[BigDecimal](http://java.sun.com/j2se/1.5.0/docs/api/java/math/BigDecimal.html)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-11T04:19:27.913

转换为科学记数法纯粹是其显示方式的影响。更改显示取决于您如何输出它（格式说明符）

浮点数通常具有大约 6 位的精度，这使得它们不适合保存数十亿的数字。Doubles 的精度约为 15 位，因此它应该能够以完全准确的方式保存数万亿以上的数字。

在 C 中显示双精度：

```
printf("%10f", dbl); 
```

# ajax - 使用 AJAX 加载器的最佳方法？

> ID：193630
> 
> 赞同：2
> 
> 时间：2008-10-11T04:17:20.273
> 
> 标签：ajax, loader

在动态更新内容 DIV 之前，我已经实现了一些用于启动 AJAX 加载器的糟糕解决方案，但似乎没有一个是“通用的”，而且我发现每次这样做时我都在重新处理它。如果我有一个 DIV，其内容会根据用户在页面上单击的内容而更新，并且我想在此内容 DIV 上显示加载器，那么最好的方法是什么？我见过一些开发人员总是在页面上使用加载器，他们只是将它显示为块或不显示，我还看到其他人将它附加到 DIV。当您还有多个可以更新的区域时怎么办？我在想一些可重复的东西，我可以用函数调用，也许传递一些参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T16:17:00.353

一些 JavaScript 库允许监听打开和关闭请求。查看 Prototype 的 request Responder [http://www.prototypejs.org/api/ajax/responders](http://www.prototypejs.org/api/ajax/responders)。

你会做这样的事情：

```
Ajax.Responders.register({
  onCreate: function() {
    $('loader').show();
    Ajax.activeRequestCount++;
  },
  onComplete: function() {
    Ajax.activeRequestCount--;
    if (Ajax.activeRequestCount < 1) $('loader').hide();
  }
}); 
```

至于加载的可视化表示，您可能希望识别页面的不同部分，这些部分可能需要单独的加载图形并子类化 Request 对象，每次都指示请求的类型。

例如
，它是一个正在保存的字段吗？`new FieldUpdateRequest(field)`
是正在加载的页面吗？`new Request();`
容器是否正在更新？`new PartialRequest(div);`

然后捕获每个子类类型并显示或隐藏不同的加载器图形。

不幸的是，没有快速的解决方案，哈尔。您可以构建一个通用脚本来将加载器图形附加到容器中，这样可以节省一些重复。如果你这样做了，介意把它贴在这里:)？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T04:31:13.163

您可以在不同的库中使用[JQuery 进度条](http://ui.jquery.com/repository/latest/demos/functional/#ui.progressbar)或类似的东西。

# html - HTML页脚问题

> ID：193634
> 
> 赞同：10
> 
> 时间：2008-10-11T04:18:45.170
> 
> 标签：html, footer

不管中间有多少信息，是否可以创建一个位于网站底部的页脚 div？

目前，我拥有的 div 的位置取决于我在正文中有多少内容。

> ### 也可以看看：
> 
> [如何让页脚留在网页底部？](https://stackoverflow.com/questions/42294/how-do-you-get-the-footer-to-stay-at-the-bottom-of-a-web-page)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-11T04:20:58.427

我绝不是 css 专家，但这适用于主要浏览器：

```
.d_footer
{
    position:fixed;
    bottom:0px;
    background-color: #336699;
    width:100%;
    text-align:center;
    padding-top:5px;
    padding-bottom:5px;
    color:#ffffff;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T04:39:35.173

浮动内容 div 并使用页脚 div `clear: both`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-13T12:38:51.883

我知道我将此标记为已回答，但结果我遇到了另一个问题。页脚很好地位于页面底部，但是，如果内容超出页脚，页脚只是浮动在内容之上。

如果内容超出底部，有没有办法将页脚保持在页面底部而不重叠？

我的直觉是使用 iframe，但我不知道该怎么做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-07T17:41:34.250

JonathanMueller 是对的，它非常有效。

我一直在寻找试图这样做的帖子。我能找到的所有东西都固定在窗口的底部。谢谢！

# delphi - 测试 Delphi DLL 崩溃 VB6 IDE

> ID：193651
> 
> 赞同：4
> 
> 时间：2008-10-11T04:36:02.140
> 
> 标签：delphi, dll, vb6, typelib

我第一次尝试在 Delphi 中编写 DLL。到现在为止还挺好。通过使用类型库，我能够毫无困难地在 DLL 中传递 Widestrings 和从 DLL 传递 Widestrings。

目前令人好奇的是，我使用 VB6 作为测试平台，每次我在 IDE 中运行测试时，程序都会运行，然后 IDE 进程突然从内存中消失 - 没有错误消息，什么都没有。如果我单步执行代码，一切正常，直到我执行最后一行，然后 IDE 就会消失。

相比之下，当我将测试编译为 EXE 时，程序运行到最后，没有错误消息等。

以前有没有人遇到过这个问题，是否有一个明显的解决方案让我眼前一亮？

下面的源代码，以防万一：

- 项目

```
library BOSLAD;

uses
  ShareMem,
  SysUtils,
  Classes,
  BOSLADCode in 'BOSLADCode.pas';

exports
  version,
  DMesg,
  foo;
{$R *.res}

begin
end. 
```

- 单元

```
unit BOSLADCode;

interface
  function version() : Double; stdcall;
  procedure DMesg(sText : WideString; sHead : WideString ); stdcall;
  function foo() : PWideString; stdcall;

implementation
  uses Windows;

  function version() : Double;
  var
    s : String;
  begin
    result := 0.001;
  end;

  procedure DMesg( sText : WideString; sHead : WideString);
  begin
    Windows.MessageBoxW(0, PWideChar(sText), PWideChar(sHead), 0);
  end;

  function foo() : PWideString;
  var s : WideString;
  begin
    s := 'My dog''s got fleas';
    result := PWideString(s);
  end;
end. 
```

-- 类型库

```
 // This is the type library for BOSLAD.dll
      [
      // Use GUIDGEN.EXE to create the UUID that uniquely identifies
      // this library on the user's system. NOTE: This must be done!!
         uuid(0C55D7DA-0840-40c0-B77C-DC72BE9D109E),
      // This helpstring defines how the library will appear in the
      // References dialog of VB.
         helpstring("BOSLAD TypeLib"),
      // Assume standard English locale.
         lcid(0x0409),
      // Assign a version number to keep track of changes.
         version(1.0)
      ]
      library BOSLAD
      {

      // Now define the module that will "declare" your C functions.
      [
         helpstring("Functions in BOSLAD.DLL"),
         version(1.0),
      // Give the name of your DLL here.
         dllname("BOSLAD.dll")
      ]
      module BOSLADFunctions
      {
[helpstring("version"), entry("version")] void __stdcall version( [out,retval] double* res );
[helpstring("DMesg"), entry("DMesg")] void __stdcall DMesg( [in] BSTR msg, [in] BSTR head );
[helpstring("foo"), entry("foo")] void __stdcall foo( [out,retval] BSTR* msg );
      } // End of Module
      }; // End of Library 
```

* * *

我将 WideString 的声明移到我声明它的函数之外，期望这会将变量的生命周期增加到比`foo`函数的生命周期更长。它没有任何区别。

同样，我在 VB6 中注释掉了对该`foo`函数的调用。那也没什么区别。不管我做什么，VB6 IDE 在最​​后一行代码执行后就死掉了。

除了指向局部变量的指针之外，还有其他原因。但是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T06:59:03.253

```
result := PWideString(s); 
```

您在此处返回指向局部变量的指针。它立即变得无效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T11:18:54.527

详细说明 GSerg 的回答：

```
result := PWideString(s); 
```

你会认为这没问题，因为 s 是用字符串文字初始化的......但是 Delphi 中的宽字符串不像普通字符串那样被引用计数，所以 s 实际上拥有一些动态分配的堆内存，并且只要函数返回此内存可以重复使用:(

以下应该没问题：

```
function foo() : PWideString;
const s : WideString = 'My dog''s got fleas';
begin
  result := PWideString(s);
end; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T15:07:11.913

[在 delphi.wikia.com 网站上创建 DLL](http://delphi.wikia.com/wiki/Creating_DLLs#Notes_about_memory_management)有我一直在寻找的答案。还有解决方案。

*例如，Delphi 自动分配和释放内存来存储您的字符串，它知道何时不再需要它们等。这同样适用于例如 Visual Basic，但两者都以不同的方式进行。因此，如果您要将一个由 Visual Basic 分配的字符串传递给一个用 Delphi 编写的 DLL，那么您最终会遇到大麻烦，因为现在两者都将尝试管理该字符串并且会互相打扰。*

解决方案是使用[FastMM](http://sourceforge.net/projects/fastmm/)，它的效果非常好！！我现在有一个替换`BORLNDMM.DLL`我的项目，一切正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-15T04:17:07.930

感谢 Rob Kennedy 的新闻：comp.lang.pascal.delphi.misc

他说，除其他外：

1.  此 DLL 不需要 ShareMem、SysUtils 或 Classes。
2.  您获取了一个 WideString 并告诉编译器它实际上是一个指向 WideString 的指针。你在对编译器撒谎。它不在乎，但这个函数的调用者可能会。

因此，修改后的代码在没有 ShareMem（以及 DLL 向导添加的 SysUtils 和类）的情况下也能正常工作，如下所示：

```
library BOSLAD;
uses
  BOSLADCode in 'BOSLADCode.pas';
exports
  version,
  DMesg,
  foo;
{$R *.res}
begin
end. 
```

BOSLAD代码.pas：

```
unit BOSLADCode;

interface
  function version() : Double; stdcall;
  procedure DMesg(sText : PWideChar; sHead : PWideChar ); stdcall;
  function foo() : PWideChar; stdcall;

implementation
  uses Windows;

  var s : WideString;

  function version() : Double;
  begin
    result := 0.001;
  end;

  procedure DMesg( sText : PWideChar; sHead : PWideChar);
  begin
    Windows.MessageBoxW(0, sText, sHead, 0);
  end;

  function foo() : PWideChar;
  begin
    s := 'My dog''s got fleas';
    result := PWideChar(s);
  end;
end. 
```

boslad.odl：

```
// This is the type library for BOSLAD.dll
[
uuid(0C55D7DA-0840-40c0-B77C-DC72BE9D109E),
helpstring("BOSLAD TypeLib"),
lcid(0x0409),
version(1.0)
]
library BOSLAD
{
[
helpstring("Functions in BOSLAD.DLL"),
version(1.0),
dllname("BOSLAD.dll")
]
module BOSLADFunctions
{
[helpstring("version"), entry("version")] 
    void __stdcall version( [out,retval] double* res );
[helpstring("DMesg"), entry("DMesg")] 
    void __stdcall DMesg( [in] BSTR msg, [in] BSTR head );
[helpstring("foo"), entry("foo")] 
    void __stdcall foo( [out,retval] BSTR* msg );
} 
}; 
```

测试.bas：

```
Sub Main()
    Dim cfg As New CFGProject.cfg
    cfg.Load "test.cfg"
    Dim s As String
    s = cfg.Recall("msg")
    DMesg s, "" & version
    s = foo
    DMesg s, "" & version
End Sub 
```

测试.cfg

```
msg=毅訜訝 
```

所有这些都完美无缺。VB6 的 IDE 愉快地运行 DLL，并且 MsgBox 以应有的方式出现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-17T15:54:15.417

我想我们可以关闭这个。下面的代码似乎足以让人们`news:comp.lang.pascal.delphi.misc`开心，我真的需要从概念测试转向实际做一些事情。

BOSLAD.bdsproj：

```
library BOSLAD;

uses
  BOSLADCode in 'BOSLADCode.pas';

exports
  version,
  DMesg,
  foo;
{$R *.res}

begin
end. 
```

BOSLAD代码.pas：

```
unit BOSLADCode;

interface
  function version() : Double; stdcall;
  procedure DMesg(const sText : WideString; const sHead : WideString ); stdcall;
  function foo() : PWideChar; stdcall;

implementation
  uses Windows, ActiveX;

  function version() : Double;
  begin
    result := 0.001;
  end;

  procedure DMesg( const sText : WideString; const sHead : WideString);
  begin
    Windows.MessageBoxW(0, PWideChar(sText), PWideChar(sHead), 0);
  end;

  function foo() : PWideChar;
  var s : WideString;
  begin
    s := 'My dog''s got fleas';
    result := SysAllocString(PWideChar(s));
  end;
end. 
```

现在 VB 很高兴，我没有遇到奇怪的 IDE 崩溃。

# qt - Qt::paintEvent 是否需要可重入？

> ID：193656
> 
> 赞同：1
> 
> 时间：2008-10-11T04:40:33.767
> 
> 标签：qt

我可以将画家放入类变量中吗？：

```
protected:
QPainter *myPainter;

...

void MyWidget::paintEvent(QPaintEvent *event)
{
    myPainter = new QPainter(this); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-24T01:10:57.617

一种新的分析器，可以更具体地解决更多的重入问题......

[danatel对此](https://stackoverflow.com/users/19884/danatel)[消息](https://stackoverflow.com/questions/193656/is-it-necessary-for-qtpaintevent-to-be-reentrant#195755)发表了以下评论（部分）：

> 重入是指这种特定情况：1）paintEvent 处理程序将 QPainter 保存到类变量中。2）paintEvent 处理程序调用子程序来绘制东西 3）其中一个子程序调用 Qt 方法 4）这个 Qt 方法递归地生成另一个paintEvent

对此的答案是它应该是可以接受的，除非你做了一些非常奇怪的事情。（如果你做了一些奇怪的事情，Qt 可能会警告你或中止。）我认为对于可重入的含义可能仍然存在一些混淆，但是生成一个paintEvent 不会立即停止当前操作的执行流程处理那个事件。相反（像所有事件一样），它将排队等待稍后处理。只要您不执行多线程或调用 processEvents，当您在自己的函数之一中时代码的执行顺序应该非常简单。

例如，让我们按照您的步骤并更详细地检查它们。

1.  `Foo::paintEvent()`handler 创建一个 QPainter 并设置 `Foo::m_painter_p`它。
2.  `Foo::paintEvent()`来电 `Foo::paintAntarticaFlag()`。
3.  `Foo::paintAntarticaFlag()`: a) 使用`Foo::m_painter_p`，然后 b) 调用调用 的东西`Foo::update()`，然后 c) 使用`Foo::m_painter_p`更多。
4.  `Foo::update()`，这实际上是一个 Qt 方法，为 Foo 生成一个paintEvent。

上面的顺序很好，因为 update 创建**了一个 event**，这意味着延迟处理。相反，如果您调用 Foo::repaint()，这将导致立即递归到 Foo::paintEvent()，这将导致 Qt 中止，因为您正在为同一个对象创建超过 1 个画家，或者您的程序中止因为它最终（你知道，在几百毫秒内）炸毁了堆栈。

如果您正在执行多个线程并且只想触发重绘，您仍然可以从另一个线程执行此操作，因为它只会在队列中放置一个paintEvent，以便在适当的时间由适当的线程处理。如果您正在执行多个线程并且想使用同一个画家绘制这些标志，那么，不要。只是不要。在这种情况下，您可能会考虑将每个标志绘制到共享图像，并在您现在使用 QPainter 的位置绘制该图像。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T04:45:03.073

不要那样做。只需将它放在堆栈上，这样当它在析构函数中被销毁时，它就会自动执行绘画。

```
void MyWidget::paintEvent(QPaintEvent *event)
{
    QPainter painter(this);
    // use painter
    ...
    // paint object automatically closes and paint on desctruction
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-12T17:37:51.217

如果您试图避免将painter 小部件传递给许多子例程调用，您可能可以将指向painter 的指针作为类变量来逃避。如前所述，您仍然应该在paintEvent 函数中创建/销毁它。就个人而言，我可能只是将它传递给辅助函数，但你可以这样做。

另外，我不确定您的问题与重入有何关系。如果您有多个线程，则所有 UI 元素的绘制都应仅在 UI 线程中进行。您可以在不同线程中对图像进行绘制，但在这种情况下，您可能只想在该线程中绘制该图像，而不是在多个线程中。无论哪种方式，只要您遵守这些条件，我认为您不会在调用画家的 Qt 函数中遇到重入问题。

# asp.net - ASP.NET“页面模板”的任何替代方案？

> ID：193663
> 
> 赞同：3
> 
> 时间：2008-10-11T04:55:24.190
> 
> 标签：asp.net, .net

经典 ASP 具有“服务器端包含”，因此可以轻松地为页眉、页脚、左侧或右侧栏设计通用布局。

在 ASP.NET 中，我认为我们必须使用“页面模板”。虽然大多数人说它好用，但我觉得它相当复杂，因为我们必须将整个 HTML 代码复制到“渲染”函数中。有没有更简单的方法？我可以从 HTML 文件加载代码，而不是将整个代码粘贴到“渲染”函数中吗？

或者有没有比“页面模板”更好的选择？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-11T04:59:57.160

我原以为母版页是 ASP.NET（2.0 及更高版本）中的标准方法。

1.  在设计器中设计母版页。
2.  在此母版页中指定一个或多个内容区域。
3.  然后只需设计单独的“内容”页面并在 Page 指令中指明原始母版页。

请注意，这都是可视化创建的，无需在 Init/Load/Render 事件中手动复制 html，ASP.NET 会为您完成。

我读过的一本好书是Frtiz Onion的[《Essential ASP.NET 2.0 》。](https://rads.stackoverflow.com/amzn/click/com/0321237706)它在第 2 章中对母版页进行了很好的简洁讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T04:57:24.310

ASP.Net 2.0+ 利用母版页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-11T05:13:55.790

母版页和用户控件相结合，为您提供比 ASP 所包含的更多功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T05:54:45.117

我同意阿什和约翰的观点。设计一个 .master 页面来保存您希望在所有页面上可见的所有内容。根据我的经验，页眉、页脚一侧进入母版页。然后添加`<asp:content id='page_contents'>`标签以保存在每个页面中更改的页面内容。

If you have authentication page, where you allow a user to login, I would suggest not to include the master file for the form.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T11:56:03.077

MasterPages are the right thing to do here. Passing information back and forth from content to master can be difficult. I recommend this article from [Scott Mitchell](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx) regarding this topic as it will save you some headache.

# javascript - 您认为可以将哪些想法应用于此 GUI 以使其更有效地供真实用户使用？

> ID：193677
> 
> 赞同：0
> 
> 时间：2008-10-11T05:10:47.357
> 
> 标签：javascript, user-interface

我说的是[Google 语言工具](http://www.google.com/language_tools)中的 Google 文本翻译用户界面。

我喜欢这样一个事实，即您可以获得多种语言的文本翻译。但是，我认为总是显示所有翻译选项并不是很好。我认为最好首先显示最常见的文本翻译选项。

真的，例如，尝试从英语翻译成西班牙语变得非常烦人。使用键盘（E、Tab，然后重复 S 键），出现的前三个选项是塞尔维亚语、斯洛伐克语、斯洛文尼亚语，最后是西班牙语......

另一个例子：从英语到法语。再次使用键盘（F 键重复）在法语之前显示菲律宾语和完成！！！

您认为可以将什么样的想法应用于此 GUI 以使其更有效地用于真实的人使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T05:33:46.033

我觉得应该没问题。列表中只有 30 多种语言，其中近一半是非常常用的语言，所以我认为将常用语言放在首位并没有什么意义。它不像一个国家列表，你必须搜索 180 多个国家才能找到你的国家。

我唯一可能做的就是使用 cookie 来存储您最后的语言选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T13:27:14.407

我认为最好的是一个自动完成输入字段，类似于用于 Stack Overflow 上的标签和用于在 Facebook 上搜索的字段。您键入的每个字母都会缩小结果范围，并允许您使用鼠标或箭头键轻松选择正确的字母。

您还可以跟踪最受欢迎的标签并按最常用的方式对结果进行排序，就像 Stack Overflow 使用他们建议的标签所做的那样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T15:54:39.103

我也对这个界面感到沮丧。我认为 (a) 使用 cookie 优先考虑该用户过去选择的语言是一个好主意；(b) 显示最常用语言的有限列表（4-8 种语言），并带有扩展列表的“更多...”选项。

我非常感谢许多网站和软件应用程序在要求您指定时区时开始使用这种方法。如果您预计 95% 的用户位于（例如）美国 5 个时区，为什么要显示“中大西洋”、“亚速尔群岛”等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T05:53:43.590

执行您要求的最简单方法是按请求频率排序，然后按字母/数字排序。这会将翻译请求最常见的语言放在首位。它仍然不能完美地解决您的问题，但这将是一个简单的改进，并且对大多数人来说效果更好。

现在，如果只有一些谷歌员工来到这个网站;-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T07:47:28.227

如果可以的话，我会尝试通过浏览器/ISP 元数据检测他们的语言环境，然后默认为 - 但大多数人期望按字母顺序排列的语言列表。如果他们正在寻找塞尔维亚语，但在他们获得西班牙语后点击“S”，却看不到塞尔维亚语怎么办？他们可能会认为没有塞尔维亚语，因为这不是他们期望的地方（在西班牙语之前）并离开。那会很糟糕。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-11T10:50:34.397

我同意以前的大多数回复，就像这个页面一样简单，你可以预先做的不多，语言应该按字母顺序排序。

但是有些事情可以在后台执行，存储最后的设置或让您为翻译设置添加书签。

不要忘记，有些浏览器会让您使用多个字母作为快捷方式，例如，在 Firefox 中，您可以输入“SP”来访问西班牙语。

# ruby-on-rails - Ruby on Rails 的 phpBB 等效项

> ID：193682
> 
> 赞同：4
> 
> 时间：2008-10-11T05:14:31.140
> 
> 标签：ruby-on-rails, user-forums

我正在寻找类似于 phpBB 的论坛软件，但打算在 RoR 应用程序中运行。我正在寻找一个站点列表，以及一个当前是理想选择的建议（易于设置、简单、美观）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T05:21:00.877

[论坛](http://rforum.andreas-s.net/)？由[ruby​​-forum.com](http://www.ruby-forum.com/)使用。

e: 也有[Beast](http://beast.caboo.se/)，但看起来非常小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T23:10:44.257

看看[rBoard](https://github.com/radar/rboard/tree)，它在 github 上。

# php - XAMPP problems with PHP5

> ID：193686
> 
> 赞同：0
> 
> 时间：2008-10-11T05:21:07.057
> 
> 标签：php, xampp

I enabled PHP5 on my website and my webhost needs me to add the following to .htaccess files for PHP5 to work:

> AddHandler application/x-httpd-php5 .php5 .php4 .php .php3 .php2 .phtml
> AddType application/x-httpd-php5 .php5 .php4 .php .php3 .php2 .phtml

Locally, I am running XAMPP to develop code, but XAMPP does not want to work with the .htaccess file above.

I think it is an issue with XAMPP not recognizing php5 (but it does recognize php if I use "application/x-httpd-php" instead of "application/x-httpd-php5")

How do I resolve this?! I need the .htaccess files to look like above so they work with my webhost, but I need XAMPP to work locally with the same files without making changes!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T11:57:01.843

Apache有[`<IfDefine>`](http://httpd.apache.org/docs/2.0/mod/core.html#ifdefine)指令。您可以使用它来隐藏`AddType`您自己的服务器：

```
<IfDefine !MyServer>
AddType application/x-httpd-php5 .php5 …
…
</IfDefine> 
```

并启动apache

```
apachectl -D MyServer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T05:36:04.047

So, you're in kind of a tough place; ideally speaking your webhost should not need you to put extra gunk in your htaccess files. Not knowing XAMPP too well, I can't offer a specific solution, but I can give you some pointers:

1.  Your webhost is running a custom compiled version of PHP that uses application/x-httpd-php5; while it is totally possible to build PHP yourself or find a custom build that has the SAPI layer configured appropriately, you probably *don't* want to do this.

2.  Depending on how much leeway your host is giving htaccess files, it may be possible to use <IfDefine> or <IfModule> to only conditionally execute the PHP fudge code. I haven't tested, and your webhost may have disabled this functionality. Also, you will have to find an appropriate conditional to test against.

3.  My favorite answer would be to suck it up, and maintain separate htaccess files. I do this on my website; I have a .htaccess.in file which contains "global" declarations, and an htaccess.php file which generates the real .htaccess file based on configuration, etc.

Hope that helps.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-28T04:56:07.953

另一个简单的解决方案：在家里[更改配置文件名。](http://httpd.apache.org/docs/2.2/mod/core.html#accessfilename)例如在 httpd.conf 中：

```
<Directory />
    #existing stuff here...
    AccessFileName .htaccess.home
</Directory> 
```

现在您的家庭服务器将忽略您的“.htaccess”文件。您将使用“.htaccess.home”文件对其进行配置。

# php - 开发一致库的最佳实践是什么？

> ID：193701
> 
> 赞同：3
> 
> 时间：2008-10-11T05:34:54.860
> 
> 标签：php, python, api, rest

我正在开发一对库来使用 REST API。因为我需要能够在非常不同的设置中使用 API，所以我目前计划有一个 PHP 版本（用于 Web 应用程序）和一个 Python 版本（用于桌面应用程序和长时间运行的进程）。在开发图书馆时是否有任何最佳实践可以帮助我保持理智？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T05:46:00.297

因此，用不同语言开发并行库的问题在于，通常不同的语言对于相同的任务会有不同的习语。我从个人经验中知道这一点，将一个库从 Python 移植到 PHP。习语不仅仅是命名：例如，Python 有很多魔法，您可以使用 getter 和 setter 来使对象属性发挥神奇的作用；Python 有猴子补丁；Python 有命名参数。

使用移植，您想选择一种“基础”语言，然后尝试模仿另一种语言中的所有习语（不容易做到）；对于并行开发，最好不要做任何太棘手的事情并迎合最小的共同点。然后加上语法糖。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T05:46:18.237

“做你自己的客户”：我发现首先编写测试的技术是确保 API 易于使用的绝佳方式。首先编写测试意味着您将像 API 的“消费者”一样思考，而不仅仅是实现者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T07:28:57.937

尝试为两者编写一个通用的单元测试套件。也许通过用一种语言包装一个类以从另一种语言调用它。如果做不到，至少要确保两个版本的测试是等价的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T05:42:41.647

好吧，显而易见的一个是保持你的命名一致。在两个实现中，函数和类的名称应该相似（如果不相同）。每当您以两种不同的语言分别实现 API 时，这通常会自然而然地发生。不过（至少在我的书中）最重要的项目是遵循特定语言的习语。例如，假设我正在用我更熟悉的两种语言实现 REST API：Ruby 和 Scala。Ruby 版本可能有一个`MyCompany::Foo`包含 method的类`bar_baz()`。相反，相同 API 的 Scala 版本将有一个`com.mycompany.rest.Foo`带有方法的类`barBaz()`。这只是命名约定，但我发现它可以帮助您的 API 在特定语言中感到“宾至如归”，即使设计是在其他地方创建的。

除此之外，我只有一条建议：文件、文件、文件。在处理多实现 API 规范时，这很容易成为保持理智的最佳方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T14:41:44.470

AFAIKT 有很多从脚本语言到脚本语言的桥梁。让我们以 Jruby 为例，它是 Ruby + Java，然后有一些东西可以将 Ruby 嵌入 Python（或其他方式）。然后有像 Etoile 这样的例子，它的基础是 Objective-C，但也连接到 Python 和 Smalltalk，这是另一种广泛使用的方法：包装 C 库，例子是 libxml2、libcurl 等。也许这可能是基础。假设您为 Python 编写所有内容，但确实实现了与 PHP 的桥梁。所以你没有那么多平行发展。

或者，将这些东西建立在 .NET 上并不是最糟糕的主意，然后您突然有一大堆语言可供您使用，原则上这些语言应该可以从 .NET 平台上的所有其他语言中使用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-06T05:41:05.460

为什么不将 python 用于 Web 应用程序呢？有几个可用的框架：django、web2py - 类似于 django 但许多人说它更易于使用，还有 TurboGears、web.py、Pylons

沿着桥接的路线 - 您可以使用进程间通信让 PHP 和 python 应用程序（在守护程序模式下）相互交谈。

# c++ - tr1::reference_wrapper 有什么用？

> ID：193703
> 
> 赞同：21
> 
> 时间：2008-10-11T05:36:24.343
> 
> 标签：c++, stl, boost, tr1

最近，我一直在阅读 Scott Meyers 出色的[Effective C++](https://rads.stackoverflow.com/amzn/click/com/0321334876)书籍。在最后一个技巧中，他介绍了 TR1 的一些功能——我通过 Boost 了解了其中的许多功能。

但是，有一个我绝对不认识：tr1::reference_wrapper。

我将如何以及何时使用 tr1::reference_wrapper？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-11T06:26:39.513

据我所知，这就像 boost::ref。基本上，可以复制的参考。在绑定到需要通过引用传递参数的函数时非常有用。

例如（使用 boost 语法）：

```
void Increment( int& iValue )
{
    iValue++;
}

int iVariable = 0;
boost::function< void () > fIncrementMyVariable = boost::bind( &Increment, boost::ref( iVariable ));

fIncrementMyVariable(); 
```

[这篇 Dobbs 博士的文章](http://www.ddj.com/cpp/184401949)有一些信息。

希望这是正确的，并且有帮助。:)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-18T08:05:43.933

`reference_wrapper<T>`是一个非常有用且简单的库。在内部`reference_wrapper<T>`存储一个指向 T 的指针。但它公开的接口不包含任何指针表示法。

*   它允许引用的行为与其他简单对象一样 -`reference_wrapper<T>`可以存储在 STL 容器中。
*   它有助于避免可怕的指针符号——造成如此多的分段错误的原因。将指向 T 的指针替换为 a ，通过`reference_wrapper<T>`引用和任何可能的指针（当然需要存储指针以删除堆分配的对象，但对于内存管理，Boost Pointer Containers 非常有用）。`T->f()``T.f()`

例子：

```
class A
{
    //...
};

class B
{
 public:
   void setA(A& a) 
   {
     a_ = boost::ref(a); // use boost::cref if using/storing const A&
   }
   A& getA()
   {
      return a_;
   }
   B(A& a): a_(a) {}
private:
   boost::reference_wrapper<A> a_; 
};

int main()
{
   A a1;
   B b(a1);
   A a2;
   b.setA(a2);
   return 0;
} 
```

在这里，我使用了引用包装器的 boost 实现，但 C++0x 标准也将拥有它。另见[http://aszt.inf.elte.hu/~gsd/halado_cpp/ch11.html#Bind-ref](http://aszt.inf.elte.hu/~gsd/halado_cpp/ch11.html#Bind-ref)

# database - 如何存储循环时间窗口

> ID：193707
> 
> 赞同：4
> 
> 时间：2008-10-11T05:42:03.003
> 
> 标签：database, timezone

存储重复时间窗口的首选方式是什么？
例如。如果我有一个日历系统，我需要能够容纳每天、每周或每月重复发生的事件，那么哪种时间管理系统最好？

这在数据库中如何最好地表示？

**更多详细信息**
其具体目标是提供多组开放时间窗口。一旦我们有了这些时间窗口，代码就需要测试到达系统的消息是否落在其中一个时间窗口内。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T06:45:37.837

我将创建一个 RecurrenceType 表，该表将保存您的日历系统支持的每种重复类型的记录。CalendarEvents 表中的每个事件都会引用 RecurrenceType 表中的 ID。

然后，我将在代码中有一个 RecurrenceRules 对象，该对象将保存计算何时为下一个日期提供当前日期或开始日期或检索下一个 N 日期作为数组的业务逻辑。

大多数重复逻辑可能必须根据基于 RecurrenceType 表的 ID 的枚举值进行编码。如果你可以让它全部由数据驱动，我会感到惊讶，除非它是一个非常简单的日历系统。

希望有帮助。这听起来像是一个有趣的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T22:10:26.863

这延迟了很长时间，但经过多次测试和许多心痛，我们决定采用某种方案来完成这项工作。为了我们系统的需要，我们只需要每周重复一次（如果有的话）。最终产品将被设计成这样。

这是数据库模式

```
id : int(10)
window_name : varchar(100)
start_date : datetime
end_date : datetime
start_time : time
duration : int(10)
timezone: varchar(100)
monday : tinyint(1)
tuesday : tinyint(1)
...
sunday : tinyint(1) 
```

1.  每个时间“窗口”都有一个设定的开始日期、结束日期、开始时间和持续时间。
2.  该窗口将在开始日期和开始时间打开并运行“持续时间”秒
3.  该窗口仅在一周中的指定日期打开

这是唯一一个允许窗户每周打开和关闭的系统，并且窗户可以跨越到第二天早上。我确信有更复杂的系统可以执行重复窗口，但我们正在寻找灵活且快速的系统，并且不需要每月重复事件或每年事件。

# c++ - 什么是 tr1::result_of 的好用例？

> ID：193708
> 
> 赞同：3
> 
> 时间：2008-10-11T05:42:26.077
> 
> 标签：c++, stl, boost, tr1, use-case

我听说 tr1::result_of 在 Boost 内部经常使用......我想知道是否有任何好的（简单）用例用于 tr1::result_of 我可以在家里使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-11T06:12:13.910

在[open_std.org](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2003/n1454.html)中给出了 result_of 的描述。Microsoft 有一个使用 result_of的[单元测试包装器的快速示例。](http://msdn.microsoft.com/en-us/library/bb982028.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-11T07:24:54.280

没有简单的案例。但是，它用于`BOOST_AUTO`，可以使用，例如，在

```
BOOST_AUTO(x, make_pair(a, b)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T12:46:50.807

它在进行元编程时很有用。我唯一一次使用它是在包装函数中。如果 result_of<T>::type 为 void，则包装器不返回任何内容。否则，它返回包装函数返回的任何内容。

# c++ - atoi() conversion error

> ID：193715
> 
> 赞同：4
> 
> 时间：2008-10-11T05:47:24.133
> 
> 标签：c++, atoi

atoi() is giving me this error:

```
 error C2664: 'atoi' : cannot convert parameter 1 from 'char' to 'const char *'
        Conversion from integral type to pointer type requires reinterpret_cast, C-style cast or function-style cast 
```

from this line: int pid = atoi( token.at(0) ); where token is a vector

how can i go around this?

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-11T05:52:55.230

token.at(0) is returning a single char, but atoi() is expecting a string (a pointer to a char.) Either convert the single character to a string, or to convert a single digit char into the number it represents you can usually^* just do this:

```
int pid = token.at(0) - '0'; 
```

^(* The exception is when the charset doesn't encode digits 0-9 in order which is extremely rare.)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-11T05:50:13.330

You'll have to create a string:

```
int pid = atoi(std::string(1, token.at(0)).c_str()); 
```

... assuming that token is a std::vector of char, and using std::string's constructor that accepts a single character (and the number of that character that the string will contain, one in this case).

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T15:43:16.830

您的示例不完整，因为您没有说出向量的确切类型。我假设它是 std::vector<char> （也许，你用 C 字符串中的每个字符填充）。

我的解决方案是在 char * 上再次转换它，这将提供以下代码：

```
void doSomething(const std::vector & token)
{
    char c[2] = {token.at(0), 0} ;
    int pid   = std::atoi(c) ;
} 
```

请注意，这是一个类似 C 的解决方案（即，在 C++ 代码中非常难看），但它仍然有效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-02-20T14:41:46.613

```
const char tempChar = token.at(0);
int tempVal = atoi(&tempChar); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-11T06:21:59.740

```
stringstream ss;
ss << token.at(0);
int pid = -1;
ss >> pid; 
```

Example:

```
#include <iostream>
#include <sstream>
#include <vector>

int main()
{
  using namespace std;

  vector<char> token(1, '8');

  stringstream ss;
  ss << token.at(0);
  int pid = -1;
  ss >> pid;
  if(!ss) {
    cerr << "error: can't convert to int '" << token.at(0) << "'" << endl; 
  }

  cout << pid << endl;
  return 0;
} 
```

# unit-testing - 你如何将单元测试组织成包？

> ID：193716
> 
> 赞同：6
> 
> 时间：2008-10-11T05:49:54.860
> 
> 标签：unit-testing, packaging

事实上，你有 smth like `/java/src`and `/java/test`。但是，您如何命名单元测试所在的包/类？与它们所针对的类相同吗？当重构到来时，你是否在 /test 中手动重命名？请分享你的经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-11T05:52:01.393

我将测试保存在与他们正在测试的类相同的包中。这允许我使用包私有成员设置测试（需要时）。它还提供了一个很好的、易于记忆的约定。当我重构时，我通常会手动重构相应的测试类。前段时间有一些 IDE 能够自动进行这种重构，但我想不起来了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T06:02:06.117

在 Java 中，必须将它们与被测试的类放在同一个包中。这是测试具有默认/包保护可见性的方法的唯一方法。

# iis - IIS 6 Tuning Guide?

> ID：193720
> 
> 赞同：5
> 
> 时间：2008-10-11T05:51:44.047
> 
> 标签：iis, optimization, iis-6

I have been a developer for 10+ years and so far my IIS knowledge is just enough for deploying stuff on it and get it running. Recently I have been playing with IIS 6 and realize the huge difference on the worker process model. I think I would need some good guide to update my knowledge in this area. Any good article/book recommendation?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-01-14T21:48:05.267

[IIS Tuner](http://iistuner.codeplex.com)是用于调整 IIS 6、7 和 7.5 的开源工具

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-11T05:57:16.077

There are several online resources, starting with this one:

[Performance Tuning (IIS 6.0)](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/71490aae-f444-443c-8b2a-520c2961408e.mspx?mfr=true)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T06:07:51.110

[www.iis.net](http://blogs.iis.net/) - central place for everything related to IIS..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-11T06:35:26.827

I recently came across this which I thought was very good: [Best practices for creating websites in IIS 6.0](http://msmvps.com/blogs/omar/archive/2008/10/04/best-practices-for-creating-websites-in-iis-6-0.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T06:37:27.730

David Wang has some great articles on the inner workings of IIS6\. For various reasons his blog was split over two sites:

[http://blogs.msdn.com/david.wang/default.aspx](http://blogs.msdn.com/david.wang/default.aspx)

[http://w3-4u.blogspot.com/](http://w3-4u.blogspot.com/)

And...[Tess](http://blogs.msdn.com/tess/about.aspx) who is a MS escalation engineer has some amazing articles on debugging and diagnosing badly behaved/perfoming apps:

[http://blogs.msdn.com/tess/default.aspx](http://blogs.msdn.com/tess/default.aspx)

# xml - 免费的 XML 格式化工具

> ID：193728
> 
> 赞同：226
> 
> 时间：2008-10-11T05:56:06.470
> 
> 标签：xml, xml-formatting

是否有可用的免费 XML 格式化（缩进）工具，我可以在其中传递 XML 字符串并对其进行格式化，以便我可以正确读取 XML 文档？

谢谢

编辑 ~ 我在 Windows XP 上使用 XML 记事本。

* * *

## 回答 #1

> 赞同：351
> 
> 时间：2008-10-11T06:30:37.510

我相信[Notepad++](http://notepad-plus.sourceforge.net/)有这个功能。

**编辑（对于较新版本）**
安装“XML 工具”插件（菜单插件、插件管理器）
然后运行：菜单插件、Xml 工具、Pretty Print（仅限 XML - 带换行符）

**原始答案（对于旧版本的 Notepad++）**

Notepad++ 菜单：TextFX -> HTML Tidy -> Tidy: Reindent XML

然而，这个特性包装了 XML，这使它看起来“不干净”。没有包装，

*   打开`C:\Program Files\Notepad++\plugins\Config\tidy\TIDYCFG.INI`,
*   找到条目`[Tidy: Reindent XML]`并添加`wrap:0`，使其看起来像这样：

```
[整洁：重新缩进 XML]
输入-xml：是的
缩进：是
换行：0

```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2008-10-11T06:49:25.537

[Firstobject 的Windows 免费XML 编辑器叫做foxe](http://www.firstobject.com/dn_editor.htm)，是一个很棒的工具。

打开或粘贴您的 XML 并按 F8 进行缩进（您可能需要设置缩进空格的数量，因为它可能默认为 0）。

它看起来很简单，但是它包含一个用 C++ 编写的自定义编写的 XML 解析器，可以轻松高效地处理**非常大的 XML 文件**（与我使用的一些昂贵的“间谍”相关工具不同）。

*从产品页面：*

> 此 firstobject XML 编辑器（包括 CDataEdit 千兆字节编辑控件 MFC 组件）的完整 Visual C++ 源代码可作为高级 CMarkup 开发人员许可证的一部分。它允许开发人员为自己的目的实现自定义 XML 处理功能，例如验证、转换、美化和报告。

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2008-10-11T06:18:01.933

使用以下内容：

> [`xmllint`](http://xmlsoft.org/xmllint.html) `--format`

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2008-10-11T11:47:41.143

您可以在任何 Visual Studio Express 产品中打开 XML 文件，然后按`Ctrl`+ `A`、`Ctrl`+ `K`、`Ctrl`+`F`将其格式化。

嘿，它是免费的，它是一个工具，所以它适合这个问题。:-)

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2011-01-18T04:40:10.470

在 Notepad++ 中重新缩进 XML 的另一种方法：

从菜单中选择插件 -> XML 工具 -> 漂亮打印（仅限 XML - 带换行符）
或按`Ctrl`+ `Alt`+ `Shift`+ `B`。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2011-07-17T18:18:56.617

您也可以尝试[http://xmltoolbox.appspot.com/](http://xmltoolbox.appspot.com/)它是一个在线 xml 格式化程序。您只需将您的 xml 粘贴到一个大文本区域字段中，然后按“格式化 xml”，然后它会在文本区域中漂亮地打印 xml，以便于阅读或复制。

还有一个不错的小过滤器功能，可让您查看某个元素的所有内容。

希望你会喜欢这个工具

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-10-13T18:23:06.603

如果您使用 Notepad++，我建议您安装[XML Tools](http://sourceforge.net/project/showfiles.php?group_id=189927&package_id=264094)插件。您可以美化任何 XML 内容（缩进和换行）或对其进行线性化。您还可以（自动）验证您的文件并对其应用 XSL 转换。

下载最新的 zip 并将提取的 DLL 复制到 Notepad++ 安装的插件目录中。此外，下载外部库并将它们复制到您的 %SystemRoot%\system32\ 目录。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2011-09-07T15:45:14.893

**高级常规格式**[更新]

[XMLSpectrum](https://github.com/pgfearo/xmlspectrum)是一个开源语法高亮工具。支持 XML - 但具有 XSLT 2.0、XSD 1.1 和 XPath 2.0 的特殊功能。我在这里提到这一点是因为它还具有 XML 的特殊格式化功能：它垂直对齐属性及其内容以及元素 - 以增强 XML 的可读性。

输出 HTML 适合在浏览器中查看，或者如果 XML 需要进一步编辑，可以将其复制并粘贴到您选择的 XML 编辑器中

因为*xmlspectrum.xsl*使用它自己的 XML 文本解析器，所以实体引用和 CDATA 部分等所有内容都被保留 - 就像在编辑器中一样。

![在此处输入图像描述](https://i.stack.imgur.com/LBiFy.png)

*使用注意事项：这只是一个 XSLT 2.0 样式表，因此您需要将所需的命令行（提供的示例）包含在一个小脚本中，以便自动转换 XML 源。*

**虚拟格式化**

[XMLQuire](http://qutoric.com/xmlquire)是一个免费的 XML 编辑器，具有特殊的格式化功能 - 它可以正确格式化 XML，包括多行属性、属性值、自动换行缩进甚至 XML 注释。

所有 XML 缩进都是在不插入制表符或空格的情况下完成的，从而确保了 XML 的完整性。对于 XP 之后的 Windows 版本，不需要安装，它只是一个 3MB 的 .exe 文件。

如果您需要打印出格式化的 XML，则在打印预览中有特殊选项，例如缩进后的行号。如果您需要将格式化的 XML 作为富文本复制到文字处理器，这也是可用的。

[披露：我将 XMLQuire 和 XMLSpectrum 都维护为“家庭项目”]

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-13T18:30:24.137

不是直接的答案，但很高兴知道：缩进后，请确保随后将处理格式化 XML 的解析器和应用程序不会产生不同的结果。[空白在 XML 中通常很重要，](http://xml.silmaril.ie/whitespace.html)并且大多数符合标准的解析器将其冒泡到应用程序中。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-19T16:54:45.933

如果您是一名程序员，许多 XML 解析编程库将让您解析 XML，然后将其输出 - 生成漂亮的打印、缩进输出**是**一种输出选项。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-01-24T17:41:25.480

Notepad++ 只有在你使用 ANSI 时才能很好地处理它。如果您以“ANSI AS UTF8”之类的方式执行此操作，请整理一下文档：/。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2011-02-06T14:53:51.900

试试[http://prettydiff.com/](http://prettydiff.com/) 算法和 HTML Tidy 类似，但更完善。该程序完全用 JavaScript 编写，因此您无需安装任何东西。

# c# - 如何在 C# 中将 UTC 时间转换为任何其他时区的时间

> ID：193731
> 
> 赞同：9
> 
> 时间：2008-10-11T06:00:41.953
> 
> 标签：c#, time, timezone

我正在使用 C#.net - .Net fx 是 2.0，它不支持在不同时区之间进行转换。我已经编写了一个基于 UTC 的调度程序，但它在伦敦的 DTS 期间给出了 1 小时的错误。我需要一些解决方案，以便我可以通过正确的 DST 调整在相对于 UTC 的任何时区获得正确的时间。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-11T06:09:45.897

绝对不可能更改为 .NET 3.5 吗？它会让你的生活变得更加轻松。否则，你会被简单的 TimeZone 和 DaylightSavings 类困住，并且不得不使用 P/Invoke 获取已知的时区。

William Stacey 有一篇[博客文章，其中包含一些代码来执行此操作](http://staceyw.spaces.live.com/blog/cns!F4A38E96E598161E!931.entry)- 但我还没有尝试过，所以不能保证它的准确性。（根据我的经验，尽管他通常非常好 :) 如果那个代码对您没有帮助，那么毫无疑问会有类似的代码。

我相信他使用的 API 无法访问历史数据，顺便说一句。换句话说，它将假设 DST*总是*在 10 月的第一个星期日（或任何规则）开始，而不是知道规则随着时间的推移而改变。.NET 3.5 中的 TimeZoneInfo 支持操作系统支持的历史数据。

# process-management - 对支持 CMMI 目标的需求开发工具的建议

> ID：193754
> 
> 赞同：4
> 
> 时间：2008-10-11T06:31:12.127
> 
> 标签：process-management, cmmi

我们目前正在改进我们的开发流程，以努力符合​​ CMMI（我们将从第 2 级开始，然后从那里向上移动）。我们正试图找到一种便宜（或免费）的工具，它可以让我们本着 CMMI 的精神开发需求。换句话说，我们需要能够输入我们的需求，跟踪它们的变化，在需求变化时向个人提供警报，执行可追溯性等。我们的项目通常很小（通常是 3-7 个开发人员和一两个测试人员）。

我们已经研究了许多商业工具，但它们的成本超出了我们的承受能力。我们在 SourceForge（OSRM 和其他）上查看了一些，但找不到任何足够成熟且具有我们需要的功能的东西。

我们正在寻找满足上述要求的工具的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-01-02T19:13:53.917

INCOSE 是此类问题的绝佳资源。他们维护一个[工具数据库](http://www.incose.org/ProductsPubs/products/toolsdatabase.aspx)，索引 COTS 和 GOTS 系统工程工具。一些执行需求管理的工具还具有高级 System Eng 功能（例如 CORE），而另一些工具则专注于更狭隘的（即 RequistePro）。

这些工具中的大多数都需要花钱，但可能会提供一些有限的免费功能。例如，[Workspace.com提供了一些免费功能。](http://www.workspace.com)我建议不要推出你自己的解决方案，或者调整不是专门用于需求管理的工具，因为让它运行的隐性成本以及预期任务的低效率可能会成为负担。

如果您绝对不能在需求工具上花任何钱，那么最好使用商业工具的免费功能。但是不要那样做...为 RequisitePro 存钱，并且知道您正在获得适合这项工作的正确工具，从而睡得更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T08:13:02.683

从 Wiki 开始怎么样？我们使用[TWiki](http://twiki.org/)，但还有许多其他可用的。我们使用的维基

*   当任何页面发生变化时发送电子邮件
*   存储每个页面的更改历史
*   通过使用 wiki 的自动链接，您可以创建需求层次结构

这似乎涵盖了您的大部分项目。像 TWiki 这样的 Wiki 有插件也可以帮助你。

如果您在一个项目中只有 3-7 名开发人员使用其中一种大型商业工具可能对您的需求而言过于复杂。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-01-26T21:30:09.563

我们公司非常关注 CMMI，但我们所有的工具都是内部开发的。

我所能推荐的就是开发自己的工具。您至少将拥有反映您的业务流程的优势。

一般来说，对于一个新工具，我们从一个项目开发的工具开始，然后与公司的其他人共享，如果它成功的话。不要害怕使用 Excel 来跟踪您的需求以及 statuts，它与一个良好的变更控制系统（例如 subversion）一起为您提供了很多可追溯性。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-20T17:46:48.947

我曾经工作过的公司的一个团队正在定制 Visual Studio Team System 工作项模板以处理需求跟踪。您还应该考虑的一个目标是实现从需求到开发人员工作项再到缺陷的可追溯性。这可以对哪些需求与最多的缺陷相关联进行一些强有力的分析。

# x++ - 动态 Ax 报告中的分页符

> ID：193768
> 
> 赞同：6
> 
> 时间：2008-10-11T06:51:06.640
> 
> 标签：x++, axapta

如何在动态 AX 报表中插入分页符？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-11T13:55:05.800

打电话`element.newPage()`。如果您的报表上没有代码，并且您希望在特定部分之前有一个分页符，`executeSection`请`element.newpage()`在调用`super()`.

```
public void executeSection()
{
    ;
    element.newPage();
    super();
} 
```

# jquery - 如何最好地使用 jQuery：使用 HTML 或 CSS 进行格式化

> ID：193771
> 
> 赞同：4
> 
> 时间：2008-10-11T06:57:29.343
> 
> 标签：jquery, html, css

作为学习 jQuery 的一部分，我决定用 JavaScript 做一个简单的井字游戏，目前，我使用 HTML 表格来设置间距并在表格中使用图形图像。

图像要么是一个小圆圈，要么是一个大 X 或 O。当用户点击一个圆圈时，它会变为 X 或 O，然后检查游戏是否已获胜。

跛脚，我知道，但这是一次很好的教育经历。

图像大小相同（圆圈有很多空白）以确保表格大小不会改变。

我的问题有两个。

1/ 我是否应该使用 CSS 而不是表格来进行格式化以及如何最好地完成（HTML 表格很容易）？

2/ 有没有比使用图像更好的方法，这样我就不必事先创建 JPG？我尝试使用文本标签 (<a>)，但不断变化的颜色和下划线让我烦恼？

正如您可能知道的那样，我对 HTML 很满意，但对 CSS 不满意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-11T07:02:50.110

继续使用表格进行布局——井字游戏是一个网格，因此使用网格来包含游戏区域是有意义的。CSS 可用于颜色、字体、边框等。

您可以使用 CSS 覆盖锚点的颜色和下划线样式，但 IMO 只使用图像更容易。PNG 会比 JPEG 更好，因为您可以使 PNG 图像透明而没有伪影。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-11T21:18:13.980

澄清一点。您写道：“我应该使用 CSS 而不是表格……” CSS 可以应用于所有 HTML 元素。甚至桌子。

将 CSS 类与 jQuery 一起使用可以使您的 javascript 代码更简单、更易读。

例如：您定义了两个 CSS 类：“OH”和“EX”。（文本或背景图像可以正常工作。）然后，当单击单元格时，添加适当的类。

```
var ex_or_oh = 'EX'; // 'OH'
$('td.box').click(function() {
  var t = $(this);
  if (t.hasClass('OH') || t.hasClass('EX')) { return; } // spot taken
  t.addClass(ex_or_oh);
  (ex_or_oh == 'EX') ? ex_or_oh = 'OH' : ex_or_oh = 'EX';
}); 
```

HTML 将类似于：

```
<table><tr>
  <td class="box"></td>
  <td class="box"></td>
  <td class="box"></td></tr>
  ...
</table> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-11T07:18:50.703

只是为了好玩，这里有一个基本的 CSS 实现：

```
<!-- your html -->
<div id="board">
  <div class="square" id="topLeft">&nbsp;</div>
  <div class="square" id="topCenter">&nbsp;</div>
  <div class="square" id="topRight">&nbsp;</div>
<!-- 6 more .square divs! -->
</div> 
```

这是你的 CSS

```
#board {
  width: 606px;
  height: 606px;
  border: 1px solid #000000;
}

.square {
  float: left;
  width: 200px;
  height: 200px;
  border: 1px dotted #CCCCCC;
} 
```

板的额外像素占边框（1px x 2 边 x 每行 3 个框 = 6）

您可以使用以下 CSS 更改文本装饰：

```
a:hover, a:active, a:visited {
  text-decoration: none;
  font-color: blue;
} 
```

无论如何，我也不认为它是一个表格有任何问题（表格毕竟是用于表格数据的）。我发现有用的 CSS 参考网站是[w3schools](http://www.w3schools.com/css/css_reference.asp)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-11T17:08:26.050

如果你想以任何有意义的方式使用 jQuery，你需要学习 CSS - CSS 选择器是使用库时表达事物的主要方式之一。jQuery 的真正优势之一是它支持关注点分离的容易程度——在 HTML 中进行语义标记，在 CSS 中定义外观，然后使用 jQuery 对行为增强进行分层。

关于具体情况：

1.  有很多语义上有意义的方式来标记井字游戏（表格不是其中之一——行的标题是什么？）。无论您使用哪种方法，请确保您了解盒子模型和您需要解决的实现中特定于浏览器的错误。

2.  如果你学习 CSS，你可以将 O's 和 X's 作为文本然后设置它们的样式以使它们看起来像你想要的......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-11T07:25:59.800

您可以使用带有以下内容的表格：

```
.board {
    border-collapse: collapse;
}
.board td {
    width: 40px;
    height: 40px;
    border: 1px solid #666;
    font-size: 40px;
    line-height: 40px;
    font-family: 'courier new' serif;
    font-weight: bold;
    background-color: #ddf;
    text-align: center;
} 
```

和

```
<table class="board"> 
```

并在每个单元格中填写一个字母（X 或 O）

您不需要使用链接进行交互。您可以直接在表格单元格上使用 onclick 事件：

```
<td onclick="alert(1)"> 
```

玩得开心 ：）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-11T13:12:27.307

嗯，这是值得的，在我的[HTML tic-tac-toe 游戏中](http://noveltheory.com/TicTac/default.asp)，我没有使用表格或 CSS。我只是将图像并排放置，并使用 <br/>s 来打破线条。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-16T00:29:21.527

最终（当浏览器赶上，尤其是 IE8 时），在没有 HTML`<table>`语义的情况下获得类似表格的布局的“CSS 方式”将是使用`display: table-row;`和`display: table-cell;`.

文章中有一篇很好的文章：[你所知道的关于 CSS 的一切都是错误的](http://www.digital-web.com/articles/everything_you_know_about_CSS_Is_wrong/)

# .net - 对于初学者来说，.NET 框架中最重要的部分是什么？

> ID：193773
> 
> 赞同：13
> 
> 时间：2008-10-11T06:58:00.230
> 
> 标签：.net

您经常在[The Daily WTF](http://en.wikipedia.org/wiki/The_Daily_WTF)之类的网站上看到过度设计的代码示例，这些示例应该只是调用 .NET 框架中的内置方法。

对于开始他/她的第一份 .NET 工作的开发人员来说，哪些命名空间/类应该被视为必不可少的知识？

*根据 Joel Spolsky 对此类问题的说明，出于投票目的，请将您的答案限制在单个项目上。*

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-11T07:15:34.890

```
System;
System.Collections;
System.Collections.Generic; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-11T07:21:19.137

System.IO 非常重要。

当与来自 TextReader/TextWriter 实例的二进制数据或文本相结合时，了解 Streams 和各种实现（FileStream、MemoryStream、CompressionStream）如何工作是一项基本技能。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-11T07:39:47.790

```
System.IDisposable 
```

不正确地处理实现它的对象（流、数据库连接、套接字等）会导致文件锁定错误、打开数据库连接以及许多其他令人不快且难以在您的软件中找到的错误。

[http://www.codeproject.com/KB/cs/idispose.aspx](http://www.codeproject.com/KB/cs/idispose.aspx)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-14T22:02:50.260

System.Brains 和 System.CommonSense

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-10-11T07:07:54.563

使用系统；

System 可能是最重要的命名空间，因为它包含 Object 和 Array 以及 GC（垃圾收集器）等核心功能。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-11T07:03:45.477

系统字符串

并了解如何使用通过 System.Text.RegularExpressions 命名空间公开的正则表达式。

如果您最终重新编写文本解析器或其他已经为它们内置函数的字符串相关任务，这将为您节省大量时间。

[http://www.regular-expressions.info/dotnet.html](http://www.regular-expressions.info/dotnet.html)

每天的 WTF 都很棒：D

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-11T07:36:34.130

如果您在 VB.NET 中工作，我会说 My 命名空间非常重要。它包含通往框架中许多区域的快捷方式，这些区域过去分布在框架中的各个地方。它也很直观。您可以编写如下内容：
对于 My.Computer.Printers
或
My.Computer.FileSystem.OpenFile(Filename)
My.Computer.Info.AvailablePhysicalMemory
My.Computer.Screen.PrimaryScreen.WorkingArea中的每个打印机

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-11T07:10:26.133

System.Data，尤其是 Datatable，

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-11T07:23:50.257

您应该彻底查看此应用程序。它包含许多您应该遵循的模式和最佳实践。

[模式和实践指导资源管理器](http://www.codeplex.com/guidanceExplorer)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-11T11:31:35.467

*   System.IO 用于文件操作
*   System.Collections & System.Collections.Generic - 学习如何操作/使用列表、字典等。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-14T21:58:24.157

应该在 Windows 开发人员和 Web 开发人员之间划清界限，其中任何一个都可以使用 .NET Framework。如果您正在进行 Web 开发以及了解 .NET 如何与[IIS](http://en.wikipedia.org/wiki/Internet_Information_Services)交互，System.Web 非常有用，而这对于从事 Windows 和控制台应用程序的开发人员可能无关紧要。

这些有时开始变得模糊，因此开发人员应该尝试查看他们希望在堆栈中处于什么位置，例如，他们是否希望像在小型商业环境中那样做这一切，或者像大型商店那样主要专注于开发。

# mysql - 如何在 MySQL 中找到所有具有特定列名的表？

> ID：193780
> 
> 赞同：954
> 
> 时间：2008-10-11T07:02:05.463
> 
> 标签：mysql, information-schema

我有 2-3 个不同的列名，我想在整个数据库中查找并列出所有包含这些列的表。有没有简单的脚本？

* * *

## 回答 #1

> 赞同：1561
> 
> 时间：2008-10-11T08:42:40.427

要获取所有具有列的表`columnA`或`ColumnB`数据库中的所有表`YourDatabase`：

```
SELECT DISTINCT TABLE_NAME 
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE COLUMN_NAME IN ('columnA','ColumnB')
        AND TABLE_SCHEMA='YourDatabase'; 
```

* * *

## 回答 #2

> 赞同：226
> 
> 时间：2008-10-11T07:06:37.547

```
SELECT TABLE_NAME, COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE COLUMN_NAME LIKE '%wild%'; 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2012-10-09T10:46:03.213

更简单地在一行 SQL 中完成：

```
SELECT * FROM information_schema.columns WHERE column_name = 'column_name'; 
```

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2010-12-11T03:37:15.187

```
SELECT DISTINCT TABLE_NAME, COLUMN_NAME  
FROM INFORMATION_SCHEMA.COLUMNS  
WHERE column_name LIKE 'employee%'  
AND TABLE_SCHEMA='YourDatabase' 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-08-14T13:01:32.813

在较旧的 MySQL 版本或某些没有的 MySQL NDB Cluster 版本中`information_schema`，您可以转储表结构并手动搜索列。

```
mysqldump -h$host -u$user -p$pass --compact --no-data --all-databases > some_file.sql 
```

现在使用您喜欢的文本编辑器搜索列名`some_file.sql`，或使用一些漂亮的[AWK](https://en.wikipedia.org/wiki/AWK)脚本。

* * *

还有一个简单的[sed](https://en.wikipedia.org/wiki/Sed)脚本来查找该列。只需将*COLUMN_NAME*替换为您的：

```
sed -n '/^USE/{h};/^CREATE/{H;x;s/\nCREATE.*\n/\n/;x};/COLUMN_NAME/{x;p};' <some_file.sql
USE `DATABASE_NAME`;
CREATE TABLE `TABLE_NAME` (
  `COLUMN_NAME` varchar(10) NOT NULL, 
```

您可以直接在 sed 中通过管道传输转储，但这很简单。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2015-08-20T10:06:16.870

对于那些搜索与此相反的人，即寻找不包含特定列名的表，这里是查询...

```
SELECT DISTINCT TABLE_NAME FROM information_schema.columns WHERE 
TABLE_SCHEMA = 'your_db_name' AND TABLE_NAME NOT IN (SELECT DISTINCT 
TABLE_NAME FROM information_schema.columns WHERE column_name = 
'column_name' AND TABLE_SCHEMA = 'your_db_name'); 
```

当我们开始慢慢实现对 InnoDB 特殊`ai_col`列的使用并且需要弄清楚我们的 200 个表中的哪些表尚未升级时，这非常方便。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-12-11T12:42:23.450

如果您想“仅获取所有表”，请使用以下查询：

```
SELECT TABLE_NAME
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME like '%'
and TABLE_SCHEMA = 'tresbu_lk' 
```

如果您想“获取所有包含列的表”，请使用以下查询：

```
SELECT DISTINCT TABLE_NAME, COLUMN_NAME
FROM INFORMATION_SCHEMA.COLUMNS
WHERE column_name LIKE '%'
AND TABLE_SCHEMA='tresbu_lk' 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2017-09-19T15:44:14.813

使用这一行查询。将*desired_column_name*替换为您的列名。

```
SELECT TABLE_NAME FROM information_schema.columns WHERE column_name = 'desired_column_name'; 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2019-12-17T22:10:03.247

```
select distinct table_name 
from information_schema.columns 
where column_name in ('ColumnA') 
    and table_schema='YourDatabase';
    and table_name in 
    (
        select distinct table_name 
        from information_schema.columns 
        where column_name in ('ColumnB')
              and table_schema='YourDatabase';
    ); 
```

那 ^^ 将获得带有 ColumnA*和*ColumnB 的表格，而不是像接受的答案那样的 ColumnA*或ColumnB*

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-05-17T05:50:46.487

```
SELECT DISTINCT TABLE_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE COLUMN_NAME LIKE '%city_id%' AND TABLE_SCHEMA='database' 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2019-02-22T11:39:25.340

information_schema 的问题在于它可能非常慢。使用 SHOW 命令更快。

选择数据库后，您首先发送查询 SHOW TABLES。然后你为每个表做 SHOW COLUMNS 。

在 PHP 中看起来像

```
    $res = mysqli_query("显示表");
    而($row = mysqli_fetch_array($res))
    { $rs2 = mysqli_query("显示列".$row[0]);
        而($rw2 = mysqli_fetch_array($rs2))
        { if($rw2[0] == $target)
               ……
        }
    }

```

# database - LINQ 是对象关系映射器吗？

> ID：193781
> 
> 赞同：4
> 
> 时间：2008-10-11T07:02:43.683
> 
> 标签：database, linq

LINQ 是一种对象关系映射器吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-11T07:28:10.810

LINQ 本身是一组语言扩展，可帮助查询、提高可读性并减少代码。LINQ to SQL 是一种 OR Mapper，但不是特别强大。[实体框架](http://msdn.microsoft.com/en-us/library/aa697427(VS.80).aspx)通常被称为 OR 映射器，但它的功能[更多](http://blogs.msdn.com/esql/archive/2007/12/14/EntityFramework_5F00_ORM.aspx)。

还有其他几个 LINQ to *X*实现，包括 LINQ to NHibernate 和 LINQ to [LLBLGenPro](http://www.llblgen.com/)，它们以与实体框架大体相似的方式提供 OR 映射和支持框架。

不过，如果您只是学习 LINQ，我建议您坚持使用[LINQ to Objects](http://msdn.microsoft.com/en-us/library/bb397919.aspx)来感受它，而不是潜入其中一种更复杂的风格:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-11T08:19:44.760

LINQ 根本不是 ORM。LINQ 是一种查询“东西”的方式，可以或多或少地被视为不同事物的类似 SQL 的语言扩展（IEnumerables）。

可以查询各种类型的“资料”，其中包括 SQL Server 数据库。这称为 LINQ-to-SQL。它的工作方式是根据数据库的结构和您的查询生成（隐式）类。从这个意义上说，它更像是一个代码生成器。

LINQ-to-SQL 不是 ORM，因为它根本不尝试解决对象关系阻抗不匹配问题。在 ORM 中，您设计类，然后手动将它们映射到表或让 ORM 生成数据库。如果您随后出于任何原因更改数据库（通常是重构、重新规范化、非规范化），很多时候您可以通过更改映射来保持类的原样。

LINQ-to-SQL 不做任何事情。您的 LINQ 查询将与数据库结构紧密耦合。如果您更改数据库，您可能还必须更改 LINQ。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-12T09:21:51.047

I think a good test to ascertain whether a platform or code block displays the characteristics of an O/R-M is simply:

> With his solution hat on, does the developer(s) (or his/her code generator) have any direct, unabstracted knowledge of what's inside the database?

With this criterion, the answer for differing LINQ implementations can be

> Yes, knowledge of the database schema is entirely contained within the roll-your-own, LINQ utilizing O/R-M code layer

or

> No, knowledge of the database schema is scattered throughout the application

Further, I'd extend this characterization to three simple levels of O/R-M.

> 1\. Abandonment.
> 
> > It's a small app w/ a couple of developers and the object/data model isn't that complex and doesn't change very often. The small dev team can stay on top of it.
> 
> 2\. Roll your own in the data access layer.
> 
> > With some managable refactoring in a data access layer, the desired O/R-M functionality can be effected in an intermediate layer by the relatively small dev team. Enough to keep the entire team on the same page.
> 
> 3\. Enterprise-level O/R-M specification defining/overhead introducing tools.
> 
> > At some level of complexity, the need to keep all devs on the same page just swamps any overhead introduced by the formality. No need to reinvent the wheel at this level of complexity. N-hibernate or the (rough) V1.0 Entity Framework are examples of this scale.

For a richer classification, from which I borrowed and simplified, see Ted Neward's classic post at

    [http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx](http://blogs.tedneward.com/2006/06/26/The+Vietnam+Of+Computer+Science.aspx)

where he classifies O/R-M treatments (or abdications) as

> 1\. Abandonment.
> 
> > Developers simply give up on objects entirely, and return to a programming model that doesn't create the object/relational impedance mismatch. While distasteful, in certain scenarios an object-oriented approach creates more overhead than it saves, and the ROI simply isn't there to justify the cost of creating a rich domain model. ([Fowler] talks about this to some depth.) This eliminates the problem quite neatly, because if there are no objects, there is no impedance mismatch.
> 
> 2\. Wholehearted acceptance.
> 
> > Developers simply give up on relational storage entirely, and use a storage model that fits the way their languages of choice look at the world. Object-storage systems, such as the db4o project, solve the problem neatly by storing objects directly to disk, eliminating many (but not all) of the aforementioned issues; there is no "second schema", for example, because the only schema used is that of the object definitions themselves. While many DBAs will faint dead away at the thought, in an increasingly service-oriented world, which eschews the idea of direct data access but instead requires all access go through the service gateway thus encapsulating the storage mechanism away from prying eyes, it becomes entirely feasible to imagine developers storing data in a form that's much easier for them to use, rather than DBAs.
> 
> 3\. Manual mapping.
> 
> > Developers simply accept that it's not such a hard problem to solve manually after all, and write straight relational-access code to return relations to the language, access the tuples, and populate objects as necessary. In many cases, this code might even be automatically generated by a tool examining database metadata, eliminating some of the principal criticism of this approach (that being, "It's too much code to write and maintain").
> 
> 4\. Acceptance of O/R-M limitations.
> 
> > Developers simply accept that there is no way to efficiently and easily close the loop on the O/R mismatch, and use an O/R-M to solve 80% (or 50% or 95%, or whatever percentage seems appropriate) of the problem and make use of SQL and relational-based access (such as "raw" JDBC or ADO.NET) to carry them past those areas where an O/R-M would create problems. Doing so carries its own fair share of risks, however, as developers using an O/R-M must be aware of any caching the O/R-M solution does within it, because the "raw" relational access will clearly not be able to take advantage of that caching layer.
> 
> 5\. Integration of relational concepts into the languages.
> 
> > Developers simply accept that this is a problem that should be solved by the language, not by a library or framework. For the last decade or more, the emphasis on solutions to the O/R problem have focused on trying to bring objects closer to the database, so that developers can focus exclusively on programming in a single paradigm (that paradigm being, of course, objects). Over the last several years, however, interest in "scripting" languages with far stronger set and list support, like Ruby, has sparked the idea that perhaps another solution is appropriate: bring relational concepts (which, at heart, are set-based) into mainstream programming languages, making it easier to bridge the gap between "sets" and "objects". Work in this space has thus far been limited, constrained mostly to research projects and/or "fringe" languages, but several interesting efforts are gaining visibility within the community, such as functional/object hybrid languages like Scala or F#, as well as direct integration into traditional O-O languages, **such as the LINQ project from Microsoft for C# and Visual Basic**. One such effort that failed, unfortunately, was the SQL/J strategy; even there, the approach was limited, not seeking to incorporate sets into Java, but simply allow for embedded SQL calls to be preprocessed and translated into JDBC code by a translator.
> 
> 6\. Integration of relational concepts into frameworks.
> 
> > Developers simply accept that this problem is solvable, but only with a change of perspective. Instead of relying on language or library designers to solve this problem, developers take a different view of "objects" that is more relational in nature, building domain frameworks that are more directly built around relational constructs. For example, instead of creating a Person class that holds its instance data directly in fields inside the object, developers create a Person class that holds its instance data in a RowSet (Java) or DataSet (C#) instance, which can be assembled with other RowSets/DataSets into an easy-to-ship block of data for update against the database, or unpacked from the database into the individual objects.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-11T07:04:07.643

LINQ to SQL（Visual Studio 2008 的一部分）是一个 OR 映射器。

LINQ 是一种新的查询语言，可用于查询许多不同类型的源。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-11T08:00:58.137

LINQ 本身不是 ORM。LINQ 是允许您查询 SQL 等对象的语言特性和方法。

“LINQ to SQL”是一个提供程序，它允许我们对 SQL 强类型对象使用 LINQ。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-11T07:04:10.797

使用 dbml 设计器的 Linq To SQL 是的，否则 Linq 只是 Enumerables 的一组扩展方法。

# python - Python中的麦克风访问

> ID：193789
> 
> 赞同：10
> 
> 时间：2008-10-11T07:06:48.107
> 
> 标签：python, windows, microphone

我可以在 Python 中访问用户麦克风吗？

对不起，我忘了不是每个人都是读心者：Windows 至少 XP 但支持 Vista 会非常好。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-29T15:53:36.250

我用[pyaudio完成了工作](http://people.csail.mit.edu/hubert/pyaudio/)

它带有一个适用于 Windows 的二进制安装程序，甚至还有一个关于如何通过麦克风录制并保存到波形文件的示例。好的！我在 Windows XP 上使用它，但不确定它在 Vista 上的效果如何，抱歉。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-11T07:47:44.547

最好的方法是使用 ctypes 库并从中使用 WinMM。MixerOpen 将打开一个麦克风设备，您可以从那里轻松读取数据。应该很直接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-14T19:07:36.370

你可以试试[SWMixer](http://code.google.com/p/pygalaxy/wiki/SWMixer "SWMixer")。

# php - 如何使用 PHP 更改文件的扩展名？

> ID：193794
> 
> 赞同：34
> 
> 时间：2008-10-11T07:11:54.603
> 
> 标签：php, file

如何使用 PHP 更改文件的扩展名？

例如：photo.jpg 到 photo.exe

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2011-09-03T22:27:38.497

在现代操作系统中，文件名很可能在文件扩展名之前包含很长时间的句点，例如：

```
my.file.name.jpg 
```

PHP 提供了一种无需扩展名即可查找文件名的方法，考虑到这一点，然后只需添加新扩展名：

```
function replace_extension($filename, $new_extension) {
    $info = pathinfo($filename);
    return $info['filename'] . '.' . $new_extension;
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2011-02-10T22:30:49.937

```
substr_replace($file , 'png', strrpos($file , '.') +1) 
```

将任何扩展更改为您想要的。将 png 替换为您想要的扩展名。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2013-02-06T09:55:28.207

## 替换扩展名，保留路径信息

```
function replace_extension($filename, $new_extension) {
    $info = pathinfo($filename);
    return ($info['dirname'] ? $info['dirname'] . DIRECTORY_SEPARATOR : '') 
        . $info['filename'] 
        . '.' 
        . $new_extension;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-10-11T07:14:44.610

[http://www.php.net/rename](http://www.php.net/rename)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-10-11T07:17:33.670

在字符串中包含文件名后，首先使用正则表达式将扩展名替换为您选择的扩展名。这是一个可以做到这一点的小函数：

```
function replace_extension($filename, $new_extension) {
    return preg_replace('/\..+$/', '.' . $new_extension, $filename);
} 
```

然后使用[rename()](http://php.net/rename)函数用新文件名重命名文件。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-11-29T05:14:58.240

只需用正则表达式替换它：

```
$filename = preg_replace('"\.bmp$"', '.jpg', $filename); 
```

您还可以扩展此代码以删除其他图像扩展名，而不仅仅是 bmp：

```
$filename = preg_replace('"\.(bmp|gif)$"', '.jpg', $filename); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2014-10-19T03:22:14.617

对于正则表达式爱好者，Thanh Trung 的“preg_replace”解决方案的修改版本将始终包含新扩展名（这样如果您编写文件转换程序，您不会意外地用结果覆盖源文件）将是：

```
preg_replace('/\.[^.]+$/', '.', $file) . $extension 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-02-13T15:05:38.367

更好的方法：

```
substr($filename, 0, -strlen(pathinfo($filename, PATHINFO_EXTENSION))).$new_extension 
```

仅对扩展部分进行更改。保持其他信息不变。

它是安全的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-10-13T22:29:10.243

您可以使用[basename()](http://php.net/manual/en/function.basename.php)：

```
$oldname = 'path/photo.jpg';
$newname = (dirname($oldname) ? dirname($oldname) . DIRECTORY_SEPARATOR  : '') . basename($oldname, 'jpg') . 'exe'; 
```

或者对于所有扩展：

```
$newname = (dirname($oldname) ? dirname($oldname) . DIRECTORY_SEPARATOR  : '') . basename($oldname, pathinfo($path, PATHINFO_EXTENSION)) . 'exe'; 
```

最后使用[rename()](http://php.net/manual/en/function.rename.php)：

```
rename($oldname, $newname); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-01-08T08:07:59.847

已经提出了许多好的答案。**我认为评估和比较他们的表现**会很有帮助。结果如下：

*   answer by Tony Maro (`pathinfo`) took 0.000031040740966797 seconds. Note: It has the drawback for not including full path.
*   answer by Matt (`substr_replace`) took 0.000010013580322266 seconds.
*   answer by Jeremy Ruten (`preg_replace`) took 0.00070095062255859 seconds.

Therefore, **I would suggest `substr_replace`, since it's simpler and faster than others.**

Just as a note, There is the following solution too which took 0.000014066696166992 seconds. Still couldn't beat `substr_replace`:

```
$parts = explode('.', $inpath);
$parts[count( $parts ) - 1] = 'exe';
$outpath = implode('.', $parts); 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2008-10-16T01:42:07.137

我需要它来将所有带有图库的图像扩展名更改为小写。我最终做了以下事情：

```
// Converts image file extensions to all lowercase
$currentdir = opendir($gallerydir);
while(false !== ($file = readdir($currentdir))) {
  if(strpos($file,'.JPG',1) || strpos($file,'.GIF',1) || strpos($file,'.PNG',1)) {
    $srcfile = "$gallerydir/$file";
    $filearray = explode(".",$file);
    $count = count($filearray);
    $pos = $count - 1;
    $filearray[$pos] = strtolower($filearray[$pos]);
    $file = implode(".",$filearray);
    $dstfile = "$gallerydir/$file";
    rename($srcfile,$dstfile);
  }
} 
```

这对我的目的有用。

# c# - C# 和 .NET 文件夹 ID

> ID：193802
> 
> 赞同：1
> 
> 时间：2008-10-11T07:24:47.883
> 
> 标签：c#, .net, winapi

如何使用 Windows Vista 的 FOLDERID API 来检索系统或 Windows 等“已知文件夹”的文件路径？我见过一些 API，但我不知道如何正确导入它们。是的，我知道这是一个非常新手的问题，但我花了半个小时谷歌搜索却找不到答案；我也很感激将来有一种方法可以找到此类问题的答案。:-)

**编辑 1：**显然相关函数包含在 DLL 中，~~而不是任何可以导入的“正确”C# 类/库。pinvoke 语法可能会起作用，尽管我希望的是一个 OOP 接口，而不是一个函数。会测试。~~

**编辑 2：**所以我对 C# 很陌生，不知道托管接口是什么。System.Environment.GetFolderPath 是完美的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-11T07:39:29.710

看看[PInvoke SHGetKnownFolderPath](http://pinvoke.net/default.aspx/shell32/SHGetKnownFolderPath.html)

还有一个托管 API： [Environment.GetFolderPath](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx) ，但它不包含所有文件夹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T14:55:20.703

今天早上我读到了Vista Bridge。它可能会有所帮助。

但如果您没有网络带宽或只想要样本，那么最后一个选项应该是最合适的。……”

# java - BGGA 闭包作为 Java 的附加解决方案？

> ID：193809
> 
> 赞同：5
> 
> 时间：2008-10-11T07:31:05.420
> 
> 标签：java, closures, bgga

昨天@headius / Charles Nutter 在推特上提出了一个非常有趣的想法：

> @danny_l Gafter 犯了同样的错误；我并不是说分叉的 Java，就像 Groovy 是分叉一样。我想要一个带有闭包的“主要是Java”。

或@danny_l / Danny Lagrouw 的回复：

> @headius 或者 BGGA 原型是否可以“绑定”任何未来版本的 Java？这可能有用

这也是我真正希望看到的。难道我们不能有某种字节码预处理器来使 BGGA 原型在任何现代 Java 版本上工作吗？我的意思是 scala、Groovy 和 JRuby 有闭包并产生有效的字节码！

我什至愿意帮助并为此付出努力。虽然我真的不知道从哪里开始。

（以上是我写的关于这个话题的[博](http://maas-frensch.com/peter/2008/10/11/i-want-closures-bolted-on-to-java/)文的节选）

其他人如何看待这个想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T14:17:54.553

“预处理器”这个词把我带回了 C++，它让我害怕。

有一个奇怪的二分法：我庆祝 JVM 上语言的多样化花园，但我认为“熊妈妈”（又名 Java）不应该像这样支离破碎。我们需要一个坚实的基础。

也就是说，我赞成关闭 BGGA。我还认为一种语言应该提供其全部功能。如果一个团队有不能处理闭包（或泛型，或线程（！！））的人，那么该团队应该通过代码审查和静态分析来监督自己。

也许一个想法是在编译时切换到“禁止”这样的高级功能，但即使这样似乎也有点苛刻。

我认为'bolt-on' 的想法实际上是在试图解决Java 领域中的领导层断裂问题。与技术相比，这个问题更具政治性和外交性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T14:08:03.140

使这些东西成为一个螺栓的问题是您创建了一种支离破碎的语言。

java语言是java的最小部分，java。图书馆和文化构成了更大的部分。使闭包和泛型成为螺栓连接意味着它们不能在核心库中使用，或者核心库需要螺栓连接存在于正在使用的 SDK 中。这充其量会在库中产生碎片（因为一些开发人员致力于核心工作，而一些开发人员需要补充），最坏的情况意味着我们将开始在 java 的庄园中拥有 java 的“分发”，每个包含不同的集合罐子和“螺栓”。

我会说这是我宁愿远离的滑坡的开始。

# javascript - 如何在不使用 HTML 的情况下上传文件 ?

> ID：193810
> 
> 赞同：2
> 
> 时间：2008-10-11T07:31:14.140
> 
> 标签：javascript, jquery, http, upload

在我正在构建的 Web 应用程序中，我需要在不使用表单的情况下上传照片，否则它将提出嵌入在 XHTML 中不允许的外部的表单。

我认为上传文件是 jQuery.post 应该能够做的，但我目前无法弄清楚如何使用 jQuery 来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-11T07:40:24.450

看看[swfupload](http://swfupload.org/)，这是一个非常漂亮的小应用程序，应该可以完成你想要的。否则，您可以将表单分开，并在必要时使用 css/javascript 重新定位它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T07:40:05.810

使用[jQuery.post](http://docs.jquery.com/Ajax/jQuery.post)，您将只能在 POST 请求中将键/值对发送到服务器，但是您可以使用[jQuery Multiple File Upload Plugin](http://www.fyneworks.com/jquery/multiple-file-upload/)等插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-11T08:44:38.020

你检查过 fieldset 元素吗？为什么不将输入元素包装在其中，然后使用 jQuery 动态分配“提交”功能，而不是尝试将其附加到整个表单元素？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T17:08:06.007

我可以确认 jquery.fileupload 不需要表单来上传图像，实际上文件上传字段（fileupload 想要的）可以在表单中，您必须使用手动方面，例如定义您的 url：文件将被发送，可能还有 add: 事件。

只是一个注释，我很确定我的使用可能有点错误，但是会发送其他表单元素以及所有文件上传数据，但是简单地获取文件数据并忽略其余部分是微不足道的。是的，我的所有其他非文件上传字段的表单提交与我的提交操作都可以正常工作。希望这可以帮助。

# macros - Defining operators in Boo

> ID：193835
> 
> 赞同：1
> 
> 时间：2008-10-11T08:01:06.547
> 
> 标签：macros, metaprogramming, boo, nemerle

I'm looking to move some of my lighter weight metaprogramming from Nemerle to Boo and I'm trying to figure out how to define custom operators. For example, I can do the following in Nemerle:

```
macro @<-(func, v) {
    <[ $func($v) ]>
} 
```

Then these two are equivalent:

```
foo <- 5;
foo(5); 
```

I can't find a way of doing this in Boo -- any ideas?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-10T16:23:48.783

While Boo supports operator overloading by defining the appropriate static operator function (`op_addition`), and also supports syntactic macros, it does not support creating custom operators at this time.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-13T14:20:55.017

I'm not sure if this is exactly what you need but you can create syntactic macros in Boo. There's some information on the CodeHaus site, [http://boo.codehaus.org/Syntactic+Macros](http://boo.codehaus.org/Syntactic+Macros), but the syntax has changed in one of the recent releases. I don't know of any tutorials on the new syntax but the source release for Boo 0.8.2 has some examples (some of the language structures are implemented as macros). If you don't want to download the full source a view of the SVN repository is available, [https://svn.codehaus.org/boo/boo/trunk/src/Boo.Lang.Extensions/Macros/](https://svn.codehaus.org/boo/boo/trunk/src/Boo.Lang.Extensions/Macros/). The assert macro would be a good place to start.

HTH

Stoo

# ruby-on-rails - Rails 检查是否在 content_for 中定义了 yield :area

> ID：193838
> 
> 赞同：102
> 
> 时间：2008-10-11T08:09:21.770
> 
> 标签：ruby-on-rails, layout, yield

我想根据定义的实际模板在布局级别进行条件渲染`content_for(:an__area)`，知道如何完成吗？

* * *

## 回答 #1

> 赞同：224
> 
> 时间：2010-03-11T22:05:59.870

`@content_for_whatever`已弃用。改为使用`content_for?`，如下所示：

```
<% if content_for?(:whatever) %>
  <div><%= yield(:whatever) %></div>
<% end %> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-11T20:36:57.350

创建辅助方法并不是必需的：

```
<% if @content_for_sidebar %>
  <div id="sidebar">
    <%= yield :sidebar %>
  </div>
<% end %> 
```

那么当然在你看来：

```
<% content_for :sidebar do %>
  ...
<% end %> 
```

我一直使用它来有条件地在一列和两列布局之间切换

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-18T16:49:28.580

```
<%if content_for?(:content)%>
  <%= yield(:content) %>
<%end%> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-11T20:28:14.453

可以创建一个助手：

```
def content_defined?(var)
  content_var_name="@content_for_#{var}"    
  !instance_variable_get(content_var_name).nil?
end 
```

并在您的布局中使用它：

```
<% if content_defined?(:an__area) %>
  <h1>An area is defined: <%= yield :an__area %></h1>
<% end %> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-11T16:01:17.763

好的，我将无耻地做一个自我回复，因为没有人回答，我已经找到了答案:) 在 application_helper.rb 或任何您认为方便的地方将其定义为辅助方法。

```
 def content_defined?(symbol)
    content_var_name="@content_for_" + 
      if symbol.kind_of? Symbol 
        symbol.to_s
      elsif symbol.kind_of? String
        symbol
      else
        raise "Parameter symbol must be string or symbol"
      end

    !instance_variable_get(content_var_name).nil?

  end 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-11-16T12:01:49.347

我不确定两次调用 yield 对性能的影响，但是无论 yield 的内部实现如何（@content_for_xyz 已弃用）并且没有任何额外的代码或辅助方法，这都会起作用：

```
<% if yield :sidebar %>
  <div id="sidebar">
    <%= yield :sidebar %>
  </div>
<% end %> 
```

# testing - 您将如何对各种软件测试方法进行分类？

> ID：193849
> 
> 赞同：1
> 
> 时间：2008-10-11T08:28:27.397
> 
> 标签：testing, testing-strategies

这样对吗？？

1.  黑盒子

    1.1 功能性

    ```
     1.1.1 Equivalence
        1.1.2 BVA
        1.1.3 Use case
        1.1.4 Regression
        1.1.5 UAT 
    ```

    1.2 非功能性

    ```
     1.2.1 Testing the System Design 
    ```

2.  白盒

    2.1。功能性

    ```
     2.1.1 Unit
           2.1.2 Integration
           2.1.3 System 
    ```

**以上是否属于正确的类别？**

我问这个的原因是因为作为报告的一部分，我试图提出一个很好的参考来很好地分类测试技术。这是我从各种来源的分析和研究给我的。我希望这对可能正在进行相同研究的其他人有所帮助，但如果它不正确，则应更新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T09:12:46.293

您还可以考虑同时开发多个相互依赖的程序的情况。然后，您必须考虑将所有这些应用程序分组到几个*功能域的****应用程序架构***

 *因此，例如，必须处理大量数据的金融应用程序将是*一个*功能域，您必须在其中开发：

*   调度程序模块，以便在多台计算机上处​​理这些数据
*   GUI 以查看发生了什么
*   启动器以启动正确的连接检索正确的数据并格式化它们
*   等等

但这只是*一个*功能域，因为必须开发其他功能域才能*利用*程序的结果（例如，“参考域”将这些结果存储到各种数据库中，并提供通信总线供其他程序访问它们：那将是第二个功能域）。

因此，我将在您的测试中添加以下类别：

*   **组装测试**：当您在自己的功能域中进行测试时（在您部署域的不同应用程序时在组装服务器上使用一组测试数据）
*   **集成测试**：当你测试***来自所有功能域的所有应用程序***时，也称为***前端测试***。

***注意：“集成测试”与“持续集成测试”不同，后者基本上可以对一个***程序非常定期地处理您描述的黑白测试。

我所指的测试每周执行几次：

*   您所在领域的“*项目运营架构*”团队进行组装测试：通常是您团队的一些开发人员设置了组装服务器，检查数据是否是最新的，并部署您负责开发的各种程序。
*   “ *Production Operational Architectural* ”团队，负责设置“类生产”环境，是唯一能够真正*测试*从字体到后端的所有应用链的人。

注意：“运营架构”团队的职责是“让运营成为执行环境”，这意味着：

*   正确的物流团队联系以获得正确的服务器和网络，
*   正确的应用程序团队联系，以了解您系统中*所有*应用程序的各种启动/停止应用程序流程和部署程序！

简而言之：您的类别是针对*一个程序*的，但是当您开发 IS（信息系统）时，您不得不承认您不是在谈论“由部署在*一台*生产机器上的*一个团队开发的**一个*exe ”。 . 然后，欢迎来到全新的测试世界；）

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-11T09:04:09.417

我认为你的分类是一个很好的第一步。

黑盒和白盒（有些人更喜欢玻璃盒）测试的区别在于您是否只能访问规范或更多（设计、源代码）。

我将在功能测试和结构测试之间添加第二个分离，它侧重于您是否想考虑软件的功能（功能）或它是如何做的（结构）。

第三个分离处理如何确定性地或统计地生成测试输入（通过故意分布而不是随机分布）。无论哪种方式，您的重点是您的目标覆盖范围。

最后，众所周知的分离是在不同级别的软件周期之间：单元测试、集成、系统、验收……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-04T11:49:09.277

以下是软件测试中广泛定义的测试方法：

**1\. 黑盒测试** 是一种软件测试方法，其中被测试项目的内部结构/设计/实现不为测试人员所知。这些测试可以是功能性的或非功能性的，尽管通常是功能性的。测试设计技术包括：等价划分、边界值分析、因果图。

**2.** 白盒测试是一种软件测试方法，其中被测试项目的内部结构/设计/实现为测试人员所知。测试设计技术包括：控制流测试、数据流测试、分支测试和路径测试。

**3、灰盒测试** 是一种结合了黑盒测试和白盒测试的软件测试方法。

# c - C中的进度字符串解析

> ID：193852
> 
> 赞同：5
> 
> 时间：2008-10-11T08:32:37.670
> 
> 标签：c, string

我有以下字符串：

```
"..1....10..20....30...40....50...80..." 
```

我需要从中提取所有数字到数组中。

在 C 中最好的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-11T08:40:04.003

也许最简单的方法是使用该`strtok()`函数（或者`strtok_r()`如果重入是一个问题）：

```
char str[] = "..1...10...20";
char *p = strtok(str, ".");
while (p != NULL) {
    printf("%d\n", atoi(p));
    p = strtok(NULL, ".");
} 
```

一旦你得到了调用的结果，`atoi()`将这些整数保存到一个数组中应该是一件简单的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-11T09:28:32.250

您可以使用带有抑制赋值 (%*[.]) 的 sscanf 代码来跳过点（或您想要的任何其他字符），并使用扫描的字符计数代码 %n 来推进字符串指针。

```
const char *s = "..1....10..20....30...40....50...80...";
int num, nc;

while (sscanf(s, "%*[.]%d%n", &num, &nc) == 1) {
    printf("%d\n", num);
    s += nc;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T16:48:04.253

这是正确的方法，它比最简单的方法长一点，但如果读取的值超出范围，它不会受到未定义行为的影响，如果第一个字符不是点，则可以正常工作，等等。你没有指定数字是否可以为负，所以我使用了有符号类型，但只允许正值，您可以通过允许内部 while 循环顶部的负号轻松更改此设置。此版本允许任何非数字字符分隔整数，如果您只希望允许点，您可以修改内部循环以仅跳过点，然后检查数字。

```
#include <stdio.h>
#include <stdlib.h>
#include <ctype.h>
#include <errno.h>

#define ARRAY_SIZE 10

size_t store_numbers (const char *s, long *array, size_t elems)
{
  /* Scan string s, returning the number of integers found, delimited by
   * non-digit characters.  If array is not null, store the first elems
   * numbers into the provided array */

  long value;
  char *endptr;
  size_t index = 0;

  while (*s)
  {
    /* Skip any non-digits, add '-' to support negative numbers */
    while (!isdigit(*s) && *s != '\0')
      s++;

    /* Try to read a number with strtol, set errno to 0 first as
     * we need it to detect a range error. */
    errno = 0;
    value = strtol(s, &endptr, 10);

    if (s == endptr) break; /* Conversion failed, end of input */
    if (errno != 0) { /* Error handling for out of range values here */ }

    /* Store value if array is not null and index is within array bounds */
    if (array && index < elems) array[index] = value;
    index++;

    /* Update s to point to the first character not processed by strtol */
    s = endptr;
  }

  /* Return the number of numbers found which may be more than were stored */
  return index;
}

void print_numbers (const long *a, size_t elems)
{
  size_t idx;
  for (idx = 0; idx < elems; idx++) printf("%ld\n", a[idx]);
  return;
}

int main (void)
{
  size_t found, stored;
  long numbers[ARRAY_SIZE];
  found = store_numbers("..1....10..20....30...40....50...80...", numbers, ARRAY_SIZE);

  if (found > ARRAY_SIZE)
    stored = ARRAY_SIZE;
  else
    stored = found;

  printf("Found %zu numbers, stored %zu numbers:\n", found, stored);
  print_numbers(numbers, stored);

  return 0;
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-11T10:39:49.207

我更喜欢在 for 循环中使用 strtok。让它感觉更自然，虽然语法看起来有点奇怪。

```
char str[] = "..1....10..20....30...40....50...80..."
for ( char* p = strtok( strtok, "." ); p != NULL; p = strtok( NULL, "." ) )
{
    printf( "%d\n", atoi( p ) );
} 
```

# c# - 气球未显示 NotifyIcon.ShowBalloonTip

> ID：193855
> 
> 赞同：2
> 
> 时间：2008-10-11T08:36:09.643
> 
> 标签：c#, .net, notifyicon, systray

我遇到了一些我认为很容易的事情......我无法让我的 NotifyIcon 显示气球提示。基本代码是：

```
public void ShowSystrayBubble(string msg, int ms)
{
  sysTrayIcon.Visible = true;
  sysTrayIcon.ShowBalloonTip(20, "Title", "Text", ToolTipIcon.None);
} 
```

执行此代码时没有任何反应。我读到超时参数可能以秒或毫秒为单位，无法分辨，所以我尝试了两者，但都不起作用。

我正在使用 WinXP、.NET 3.5。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-11T08:45:48.937

我挫败了自己……结果证明这是操作系统级别的问题。几周前，我之前通过注册表禁用了所有气球。

您可以在此处阅读有关如何在 WinXP 中禁用气球提示的信息：http: [//support.microsoft.com/kb/307729](http://support.microsoft.com/kb/307729)

要启用它们，只需将注册表值设置为 1 并再次登录/重新启动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-11T09:20:15.327

然后，您应该为禁用气球的用户记录消息，以便在需要时查看它们。如果您可以获得读取注册表的权限，您可以检查该值并采取相应措施（不是修改该值，而是记录或显示气球）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-29T16:13:03.517

请参阅此内容，它涵盖了鼠标单击与 NotifyIcon 的所有组合以及更多内容。该代码位于模板中，并且是项目设置驱动的，因此您可以在所有项目中实现 NotifyIcon 逻辑，而无需进行任何编码工作。

更多在这里

[http://code.msdn.microsoft.com/TheNotifyIconExample](http://code.msdn.microsoft.com/TheNotifyIconExample)

# ironpython - 嘘与 IronPython

> ID：193862
> 
> 赞同：26
> 
> 时间：2008-10-11T08:44:02.747
> 
> 标签：ironpython, boo

在查看了这两个项目中的每一个之后，似乎两者都非常相似。两者都在 CLI 之上运行，都具有 Python 风格的语法，都使用 .NET 而不是标准的 Python 库。

那么，它们之间有什么区别和各自的优势呢？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-10-11T09:30:13.073

我看到的主要区别是 Boo 是静态类型的，这意味着变量的类型是在第一次赋值时推断出来的，并且从那里固定 - 而 IronPython 具有普通 Python 代码的“真实”动态行为。

IronPython~~现在由 Microsoft 正式维护，并~~针对 2.0 版中的新动态语言运行时。我怀疑因为它是静态类型的，所以 Boo 可能会更快。不过，我对此并没有太多“真实”经验……

[IronPython 还重新实现了许多 python 标准库，因此您可以在 IronPython（例如Django](http://unbracketed.org/2008/mar/16/pycon-2008-django-now-plays-dark-side/)）上运行许多 python 软件而无需更改。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-13T14:04:13.020

Boo 是静态类型的，但有可选的鸭子类型（根据我的经验，效果相当好）。Boo 还专门设计为“手腕友好” - 换句话说，以尽量减少使用 Shift 键组合的需要。[它在SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)中有很好的 IDE 支持。

很明显，Boo 从 Python 中汲取了很多灵感，但也旨在充分利用 .NET 功能。

在性能方面，Boo 感觉比 IronPython 稍微快一些，尤其是缺少 IronPython 明显的启动滞后。

Boo 仍然是一门不成熟的语言，缺乏 Python 社区。我个人对在生产中使用它有点谨慎。此外，我不同意它与 Python 的所有不同之处，例如在类中去掉显式的 self 。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-24T03:27:55.013

我还没有使用 IronPython，但这是我对 Boo 的了解...

*   Boo 受到 Python 的启发，在语法上有许多相似之处。有关差异，请参阅[http://boo.codehaus.org/Gotchas+for+Python+Users](http://boo.codehaus.org/Gotchas+for+Python+Users)
*   Boo 是专门为 CLR 编写的
*   它是静态类型的，有几个好处
    *   它可以编译成 DLL 并被 VB 和 C# 项目引用
    *   您可以在 IDE 中完成代码
*   语言本身是否可扩展。您可以编写“语法宏”并实际向语言中添加新元素。这使它成为编写 DSL 的理想选择。
*   它还不是 1.0，而 IronPython 是。该语言仍在经历成长的痛苦，但仍然非常有用。

我已经将 Boo 用于以下用途：

*   编写计划作业的脚本。它是 VBScript、BAT 文件的绝佳替代品，尤其是在访问 .NET API 时。从那以后，我主要切换到 Powershell，但它是特定于操作系统的，并且语法更重，所以我仍然使用 Boo 来处理一些东西。
*   编写单元测试
*   嵌入式脚本语言

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-01-15T23:34:37.187

正如 Winston 所说，Boo 由于其开放的编译器架构而具有很强的可扩展性，看看这些例子：

*   [http://ayende.com/Blog/archive/2008/05/27/The-magic-of-boo--Flexible-syntax.aspx](http://ayende.com/Blog/archive/2008/05/27/The-magic-of-boo--Flexible-syntax.aspx)
*   [http://www.infoq.com/articles/dsl-on-the-clr](http://www.infoq.com/articles/dsl-on-the-clr)
*   [http://ayende.com/Blog/archive/2007/12/21/Meta-Methods.aspx](http://ayende.com/Blog/archive/2007/12/21/Meta-Methods.aspx)
*   [http://ayende.com/Blog/archive/2007/11/24/Domain-Specific-Language-Losing-the-original-language.aspx](http://ayende.com/Blog/archive/2007/11/24/Domain-Specific-Language-Losing-the-original-language.aspx)
*   [http://ayende.com/Blog/archive/2007/10/14/By-the-DSL-guess-what-I-am-reading.aspx](http://ayende.com/Blog/archive/2007/10/14/By-the-DSL-guess-what-I-am-reading.aspx)
*   [http://ayende.com/Blog/archive/2007/10/04/Redefining-If.aspx](http://ayende.com/Blog/archive/2007/10/04/Redefining-If.aspx)
*   [http://ayende.com/Blog/archive/2007/09/21/Playing-with-Boos-DSLs.aspx](http://ayende.com/Blog/archive/2007/09/21/Playing-with-Boos-DSLs.aspx)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-13T22:23:22.357

我用 Boo 和 IronPython 编写了应用程序。对我来说 IronPython 是更强大的选择，而且我在 CPython 端口中编写的大部分内容都没有更改。如果针对 .Net Framework，所有最近的项目都是纯 IronPython。

自从 Jim “叛逃”到 Microsoft 后，IronPython 已被提升为顶级语言。甚至还有 Visual Studio。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-11T12:47:07.623

我同意 VolkA 的观点。能够运行 Django 非常重要。这是一个非常了不起的框架，Boo 很难重做它。今天，它更多是关于语言提供的框架的问题，而不是它提供的结构。并且 Boo 在它支持的结构上并没有提供比 Python 更多的改进。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-11T10:39:10.517

在我看来，主要区别在于[IronPython](http://www.codeplex.com/IronPython)是一种成熟语言的实现——而[Boo](http://boo.codehaus.org/)更年轻，知名度更低。

# c++ - 将所有代码放在 C++ 头文件中的优点和缺点？

> ID：193864
> 
> 赞同：50
> 
> 时间：2008-10-11T08:44:24.867
> 
> 标签：c++, architecture, compilation, header-files, circular-dependency

您可以构造一个 C++ 程序，以便（几乎）所有代码都驻留在头文件中。它本质上看起来像一个 C# 或 Java 程序。但是，在编译时，您确实需要至少一个`.cpp`文件来拉入所有头文件。现在我知道有些人绝对会讨厌这个想法。但我没有发现这样做有任何令人信服的缺点。我可以列出一些优点：

[1] 更快的编译时间。所有头文件只被解析一次，因为只有一个 .cpp 文件。此外，一个头文件不能包含多次，否则会导致构建中断。使用替代方法时，还有其他方法可以实现更快的编译，但这很简单。

[2] 它通过使它们绝对清晰来避免循环依赖。如果`ClassA`in对in`ClassA.h`有循环依赖，我必须提出一个前向引用并且它会突出。（请注意，这与编译器自动解析循环依赖关系的 C# 和 Java 不同。这鼓励了 IMO 的不良编码实践）。同样，如果您的代码在文件中，您可以避免循环依赖，但在实际项目中，文件往往包含随机标题，直到您无法弄清楚谁依赖于谁。`ClassB``ClassB.h``.cpp``.cpp`

你的意见？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-10-11T15:14:55.967

## 原因 [1] 更快的编译时间

不在我的项目中：源文件 (CPP) 仅包含他们需要的标头 (HPP)。因此，当我因为一个微小的变化而只需要重新编译一个 CPP 时，我有十倍于相同数量的未重新编译的文件。

也许您应该将项目分解为更合乎逻辑的源/标题：A 类实现的修改不需要重新编译 B、C、D、E 类等的实现。

## 原因[2] 避免循环依赖

代码中的循环依赖？

抱歉，但我还没有遇到真正的问题：假设 A 依赖于 B，B 依赖于 A：

```
struct A
{
   B * b ;
   void doSomethingWithB() ;
} ;

struct B
{
   A * a ;
   void doSomethingWithA() ;
} ;

void A::doSomethingWithB() { /* etc. */ }
void B::doSomethingWithA() { /* etc. */ } 
```

解决该问题的一个好方法是将此源分解为每个类至少一个源/标头（以类似于 Java 的方式，但每个类具有一个源和一个标头）：

```
// A.hpp

struct B ;

struct A
{
   B * b ;
   void doSomethingWithB() ;
} ; 
```

.

```
// B.hpp

struct A ;

struct B
{
   A * a ;
   void doSomethingWithA() ;
} ; 
```

.

```
// A.cpp
#include "A.hpp"
#include "B.hpp"

void A::doSomethingWithB() { /* etc. */ } 
```

.

```
// B.cpp
#include "B.hpp"
#include "A.hpp"

void B::doSomethingWithA() { /* etc. */ } 
```

因此，没有依赖性问题，并且编译时间仍然很快。

我错过了什么？

## 在从事“现实世界”项目时

> 在实际项目中，cpp 文件往往会包含随机标题，直到您无法弄清楚谁依赖于谁

当然。但是，如果您有时间重新组织这些文件以构建您的“一个 CPP”解决方案，那么您就有时间清理这些标头。我的标题规则是：

*   分解标题以使它们尽可能模块化
*   永远不要包含你不需要的标题
*   如果你需要一个符号，前向声明它
*   仅当上述失败时，才包含标头

无论如何，所有标题都必须是自给自足的，这意味着：

*   标头包括所有需要的标头（并且只有需要的标头 - 见上文）
*   必须编译包含一个标头的空 CPP 文件，而无需包含其他任何内容

这将消除排序问题和循环依赖。

## 编译时间有问题吗？然后...

如果编译时间真的是一个问题，我会考虑：

*   使用预编译头文件（这对 STL 和 BOOST 非常有用）
*   通过 PImpl 习语减少耦合，如[http://en.wikipedia.org/wiki/Opaque_pointer中所述](http://en.wikipedia.org/wiki/Opaque_pointer)
*   使用网络共享编译

## 结论

您所做的并不是将所有内容都放在标题中。

您基本上是将所有文件包含在一个且只有一个最终源中。

也许您在完整项目编译方面获胜。

但是当编译一个小的变化时，你总是会输。

编码时，我知道我经常编译小的更改（如果只是让编译器验证我的代码），然后最后一次，做一个完整的项目更改。

**如果我的项目按照你的方式组织，我会浪费很多时间。**

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2008-10-11T08:50:57.303

我不同意第 1 点。

是的，只有一个 .cpp 并且从头开始构建的时间更快。但是，您很少从头开始构建。您进行了一些小的更改，并且每次都需要重新编译整个项目。

我更喜欢反过来做：

*   将共享声明保存在 .h 文件中
*   保留仅在 .cpp 文件中一处使用的类的定义

所以，我的一些 .cpp 文件开始看起来像 Java 或 C# 代码；）

但是，在设计系统时， *“将内容保存在 .h”中的*方法很好，因为第 2 点。你做了。我通常在构建类层次结构时这样做，然后当代码架构变得稳定时，我将代码移动到 .cpp 文件。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2008-10-11T09:38:30.280

你说你的解决方案有效是对的。它甚至可能对您当前的项目和开发环境没有任何不利之处。

但...

正如其他人所说，每次更改一行代码时，将所有代码放在头文件中都会强制进行完整编译。这可能还不是问题，但您的项目可能会变得足够大，以至于编译时间将成为问题。

另一个问题是共享代码时。虽然您可能还没有直接关心，但重要的是要尽可能多地对代码的潜在用户隐藏代码。通过将您的代码放入头文件中，任何使用您的代码的程序员都必须查看整个代码，而只是对如何使用它感兴趣。将代码放在 cpp 文件中只允许将二进制组件（静态或动态库）及其接口作为头文件交付，这在某些环境中可能更简单。

如果您希望能够将当前代码转换为动态库，这将是一个问题。因为您没有与实际代码分离的正确接口声明，所以您将无法将编译的动态库及其使用接口作为可读的头文件提供。

您可能还没有这些问题，这就是为什么我告诉您您的解决方案在您当前的环境中可能没问题。但最好为任何变化做好准备，其中一些问题应该得到解决。

PS：关于 C# 或 Java，你应该记住，这些语言并没有按照你说的去做。它们实际上是独立编译文件（如 cpp 文件）并为每个文件全局存储接口。然后这些接口（以及任何其他链接的接口）用于链接整个项目，这就是它们能够处理循环引用的原因。因为 C++ 每个文件只进行一次编译，所以它不能全局存储接口。这就是为什么你需要在头文件中明确地编写它们。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-10-11T09:14:35.820

您误解了该语言的用途。.cpp 文件实际上是（或者应该除了内联代码和模板代码之外）您系统中唯一的可执行代码模块。.cpp 文件被编译成目标文件，然后链接在一起。.h 文件仅用于前向声明在 .cpp 文件中实现的代码。

这导致更快的编译时间和更小的可执行文件。它看起来也相当干净，因为您可以通过查看它的 .h 声明来快速了解您的类。

至于内联代码和模板代码——因为它们都用于由编译器而不是链接器生成代码——它们必须始终对每个 .cpp 文件的编译器可用。因此，唯一的解决方案是将其包含在您的 .h 文件中。

但是，我开发了一个解决方案，其中我的类声明在一个 .h 文件中，所有模板和内联代码在一个 .inl 文件中，所有非模板/内联代码的实现都在我的 .cpp 文件中。.inl 文件 #included 在我的 .h 文件底部。这使事情保持清洁和一致。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-10-11T08:47:32.490

对我来说明显的缺点是您总是必须一次构建所有代码。使用`.cpp`文件，您可以进行单独编译，因此您只需要重建真正改变的部分。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-12T16:25:27.963

您的方法的一个缺点是您不能进行并行编译。您可能认为您现在获得了更快的编译速度，但如果您有多个 .cpp 文件，您可以在自己机器上的多个内核上并行构建它们，或者使用 distcc 或 Incredibuild 等分布式构建系统。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-11T15:55:33.577

你放弃的一件事是匿名命名空间，如果没有我将很难生活。

我发现它们对于定义在类的实现文件之外应该不可见的特定于类的实用程序函数非常有价值。它们也非常适合保存对系统其余部分不可见的任何全局数据，例如单例实例。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-11T16:23:28.747

您超出了语言的设计范围。虽然你可能有一些好处，但它最终会咬你一口。

C++ 专为具有声明的 h 文件和具有实现的 cpp 文件而设计。编译器是围绕这种设计构建的。

*是*的，人们争论这是否是一个好的架构，但它是设计。最好把时间花在解决问题上，而不是重新发明设计 C++ 文件体系结构的新方法。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-11T12:56:35.263

您可能想查看[Lazy C++](http://www.lazycplusplus.com/)。它允许您将所有内容放在一个文件中，然后在编译之前运行并将代码拆分为 .h 和 .cpp 文件。这可能会为您提供两全其美的体验。

缓慢的编译时间通常是由于用 C++ 编写的系统内过度耦合造成的。也许您需要将代码拆分为具有外部接口的子系统。这些模块可以在单独的项目中编译。这样，您可以最大限度地减少系统不同模块之间的依赖关系。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-12T02:31:58.317

标题中的代码的一个问题是它必须被内联，否则在链接包含相同标题的多个翻译单元时，您将遇到多重定义问题。

最初的问题指定项目中只有一个 cpp，但如果您正在创建一个用于可重用库的组件，则情况并非如此。

因此，为了尽可能创建最可重用和可维护的代码，只将内联和可内联代码放在头文件中。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-11T17:58:46.433

我相信，除非您使用 MSVC 的预编译头文件，并且您使用的是 Makefile 或其他基于依赖项的构建系统，否则在迭代构建时，拥有单独的源文件应该编译得更快。因为，我的开发几乎总是迭代，我更关心它可以多快重新编译我在文件 x.cpp 中所做的更改，而不是我没有更改的其他 20 个源文件。此外，我对源文件的更改比对 API 的更改要频繁得多，因此它们的更改频率较低。

关于循环依赖。我会把paercebal的建议更进一步。他有两个类相互指向。相反，我更频繁地遇到一个类需要另一类的情况。发生这种情况时，我将依赖项的头文件包含在另一个类的头文件中。一个例子：

```
// foo.hpp
#ifndef __FOO_HPP__
#define __FOO_HPP__

struct foo
{
   int data ;
} ;

#endif // __FOO_HPP__ 
```

.

```
// bar.hpp
#ifndef __BAR_HPP__
#define __BAR_HPP__

#include "foo.hpp"

struct bar
{
   foo f ;
   void doSomethingWithFoo() ;
} ;
#endif // __BAR_HPP__ 
```

.

```
// bar.cpp
#include "bar.hpp"

void bar::doSomethingWithFoo()
{
  // Initialize f
  f.data = 0;
  // etc.
} 
```

我包含这个与循环依赖关系稍微无关的原因是，我觉得除了包含头文件之外还有其他选择。在此示例中，struct bar 源文件不包含 struct foo 头文件。这是在头文件中完成的。这样做的好处是，使用 bar 的开发人员不必知道开发人员使用该头文件需要包含的任何其他文件。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-10-11T14:06:20.380

我喜欢考虑在接口和实现方面分离 .h 和 .cpp 文件。.h 文件包含另一个类的接口描述，而 .cpp 文件包含实现。有时会出现一些实际问题或明确性会阻止完全干净的分离，但这就是我开始的地方。例如，为了清楚起见，我通常在类声明中内联编码小的访问器函数。较大的函数编码在 .cpp 文件中

无论如何，不​​要让编译时间决定你将如何构建你的程序。最好有一个可读和可维护的程序，而不是一个在 1.5 分钟而不是 2 分钟内编译的程序。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-11T16:49:18.913

好吧，正如许多人指出的那样，这个想法有很多缺点，但为了平衡一点并提供一个专业人士，我会说完全在标题中包含一些库代码是有道理的，因为它会使它独立于其他使用它的项目中的设置。

例如，如果尝试使用不同的开源库，则可以将它们设置为使用不同的方法链接到您的程序——一些可能使用操作系统的动态加载库代码，而另一些则设置为静态链接；有些可能被设置为使用多线程，而另一些则不是。对于程序员来说，尝试整理这些不兼容的方法很可能是一项艰巨的任务——尤其是在时间有限的情况下。

然而，当使用完全包含在标头中的库时，所有这些都不是问题。“它只是工作”对于一个合理的编写良好的库。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-04-16T08:29:27.217

面向对象编程的重要理念在于隐藏数据导致封装类的实现对用户隐藏。这主要是为了提供一个抽象层，其中类的用户主要使用可公开访问的成员函数，例如特定于实例的类型以及静态类型。然后类的开发者可以自由地修改实际的实现，只要实现不暴露给用户。即使实现是私有的并在头文件中声明，更改实现也需要重新编译所有依赖的代码库。然而，如果实现（成员函数的定义）在源代码（非头文件）中，那么库会被更改，并且依赖的代码库需要与库的修订版本重新链接。如果该库像共享库一样动态链接，则保持函数签名（接口）相同并且实现更改也不需要重新链接。优势？当然。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-11T09:07:12.497

静态或全局变量组合更不透明，可能无法调试。

例如计算迭代的总数以进行分析。

在 MY kludged 文件中，将这些项目放在 cpp 文件的顶部可以很容易地找到它们。

通过“可能无法调试”，我的意思是我通常会将这样一个全局变量放入 WATCH 窗口。由于它始终在范围内，因此无论程序计数器现在恰好在哪里，WATCH 窗口都可以始终访问它。通过将这些变量放在头文件顶部的 {} 之外，您可以让所有下游代码“看到”它们。通过将它们放在 {} 内，我认为如果您的程序计数器在 {} 之外，调试器将不再认为它们“在范围内”。而使用 kludge-global-at-Cpp-top，即使它可能是全局的，可以显示在您的链接映射 pdb-etc 中，但没有外部语句，其他 Cpp 文件无法访问它，避免意外耦合。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-30T01:16:24.490

没有人提出的一件事是编译大文件需要*大量*内存。一次编译整个项目将需要如此巨大的内存空间，即使您可以将所有代码放在头文件中也是不可行的。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-11-19T05:23:17.173

如果您使用的是模板类，则无论如何都必须将整个实现放在标题中...

一次性编译整个项目（通过单个基本 .cpp 文件）应该允许像“整个程序优化”或“跨模块优化”这样的东西，这仅在少数高级编译器中可用。如果您将所有 .cpp 文件预编译到目标文件中，然后进行链接，这对于标准编译器来说实际上是不可能的。

# c# - 我应该做哪些事情来制作高性能且强大的反射缓存？

> ID：193873
> 
> 赞同：2
> 
> 时间：2008-10-11T08:56:39.430
> 
> 标签：c#, .net, reflection, caching

在 .NET 3.5 中，我将使用 System.Reflection 来使用 AOP（可能在 Castle 的 Windsor 拦截器的上下文中）来执行诸如定义需要在方法级别执行哪些安全操作等事情。我有听说反射的某些部分很慢（我已经阅读了有关它的 MSDN 文章），并且想缓存这些部分（无论如何，当我更接近生产代码时）。我想验证我的方法：

*   缓存键是 {type} + {区分大小写的方法名称} + {参数类型列表}
*   缓存键对象可以通过 Equals 操作进行比较
*   缓存有效负载是 {MethodInfo} + {方法上定义的自定义属性列表}
*   缓存通过构造函数注入注入到我的拦截器
*   缓存可以维护很长时间（基于我不会编写自修改代码的假设；-)）

更新：

我不打算通过反射来调用我自己写的方法；只是（目前）查找我想要注入功能的属性，其中属性定义了要注入的行为。目前我的拦截器将使用 Castle 的 Windsor IInterceptor 机制，直到我发现有理由更改它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-11T09:07:31.513

显式调用 MethodInfo 确实很慢 - 但如果将其转换为委托，您可以让它变得更快*。*例如，请参阅[此博客文章](http://msmvps.com/blogs/jon_skeet/archive/2008/08/09/making-reflection-fly-and-exploring-delegates.aspx)。当然，这在查找方法等方面无济于事，但是如果您要反复调用该方法，则值得牢记。

缓存键听起来很容易构建 - 类型和字符串比较好和容易。价值观总是相对简单的:)

一旦构建，缓存是否将是只读的？你能把这些阶段分开，这样你就可以保证在完全构建之前不会被读取吗？如果是这样，您应该能够在没有任何显式锁定的情况下逃脱 - 基本上是从自定义键类型到自定义值类型的字典。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T14:44:20.617

我同意 Jon 的大部分帖子 - 一个关于字典的小注释：从性能的角度来看，你可能想要对这个和一个平面列表进行基准测试。上次我做了一个基准测试（字典与平面列表，检查每个项目直到找到匹配项），分割点（用于读取访问）大约是 150 个项目；在此之下，列表更快（只是通过简单）。但是做你自己的测试......（我没有数字来证明一种或另一种方式）。

根据代码，您可能可以使用泛型进一步拆分数据 - 即缓存，以便类型 T 的所有信息都在一个地方，填充在缓存的静态 ctor 中。这可能会也可能不会，具体取决于架构。

最后，它可能适合也可能不适合，但现有的 AOP 框架（如 PostSharp）可能有助于简化注入点。

关于通用点 - （在您的初始化代码中）为 Cache 方法上的方法创建一个类型化委托将相当容易，以减少它需要扫描的数据量 - 只需一点 Type.MakeGenericType 和Delegate.CreateDelegate - 在这一点之后，代码只知道你的 Func<...> 委托，不需要关心实现。

# .net - 程序集未正确保存

> ID：193875
> 
> 赞同：5
> 
> 时间：2008-10-11T09:03:31.850
> 
> 标签：.net, reflection, reflection.emit

我有一些非常简单的代码来生成程序集并在包含的类型上调用方法。该方法被调用并正确运行，但是当我使用反射器查看生成的程序集时，我看不到类型。

下面是示例代码：

```
namespace ConsoleApplication2
{
    class Proggy
    {
        public static void Main(string[] args)
        {
            var ab = AppDomain.CurrentDomain.DefineDynamicAssembly(
                new AssemblyName() { Name = "MyAssembly" },
                AssemblyBuilderAccess.RunAndSave);
            var module = ab.DefineDynamicModule(ab.GetName().Name);
            var typeBuilder = module.DefineType("MyType");
            var ctr = typeBuilder.DefineConstructor(MethodAttributes.Public, 
                CallingConventions.Standard, Type.EmptyTypes);
            var ilgc = ctr.GetILGenerator();
            ilgc.Emit(OpCodes.Ldarg_0);
            ilgc.Emit(OpCodes.Call, typeof(object).GetConstructor(Type.EmptyTypes));
            ilgc.Emit(OpCodes.Ret);
            var method = typeBuilder.DefineMethod("MyMethod", MethodAttributes.Public,
                typeof(int), new[] { typeof(string) });
            var ilg = method.GetILGenerator();
            ilg.Emit(OpCodes.Ldarg_1);
            ilg.EmitCall(OpCodes.Callvirt, typeof(string).GetProperty("Length").GetGetMethod(),
                null);
            ilg.Emit(OpCodes.Ret);
            var type = typeBuilder.CreateType();
            ab.Save("mytestasm.dll");
            var inst = Activator.CreateInstance(type);
            Console.WriteLine(type.InvokeMember("MyMethod", BindingFlags.InvokeMethod, null, inst,
                new[] { "MyTestString" }));
            Console.ReadLine();
        }
    }
} 
```

这是Reflector的相应反汇编：

```
.assembly MyAssembly
{
    .ver 0:0:0:0
    .hash algorithm 0x00008004
}
.module RefEmit_OnDiskManifestModule
// MVID: {0B944140-58D9-430E-A867-DE0AD0A8701F}
// Target Runtime Version: v2.0.50727 
```

... 和 ...

```
{
    .class private auto ansi <Module>
    {
    }
} 
```

谁能帮我正确保存程序集？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-11T10:40:12.917

诀窍是在 AssemblyBuilder 实例上使用 DefineDynamicModule 方法的“持久模块”版本。也就是说，而不是：

```
var module = ab.DefineDynamicModule(ab.GetName().Name); 
```

使用类似的东西：

```
var module = ab.DefineDynamicModule(ab.GetName().Name, ab.GetName().Name + ".mod"); 
```

此后相应的模块在保存后出现在程序集中。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2008-10-11T10:16:08.177

我不确定为什么没有添加该类型。

然而，另一种方法是通过传入包含您的类代码的字符串来动态创建代码。我认为这比上述方法要容易一些，因为您可以使用字符串生成器构建代码并在工作室中进行测试。

这是我用来生成 dll 的代码：

```
print(" Microsoft.CSharp.CSharpCodeProvider objCodeProvider = new Microsoft.CSharp.CSharpCodeProvider();
        string strCode = "using System;" + Environment.NewLine + "using System.Data;" + Environment.NewLine + "using DC.Common;" + Environment.NewLine + "" + Environment.NewLine + "using System.Data.SqlClient;" + Environment.NewLine + "using System.Configuration;" + Environment.NewLine + "" + Environment.NewLine + Environment.NewLine + BaseClassFile + Environment.NewLine + BaseManagerFile + Environment.NewLine;
        string strSourceModule = BuilderSettings.ExportDir + "/" + BuilderSettings.ProjectName + "/" +  "BaseFile.cs";

        FileHelper.WriteAllText(strSourceModule, strCode);
        FileHelper.WriteAllText(BuilderSettings.ExportDir + "/" + BuilderSettings.ProjectName + "/" + "test.txt", strCode);

        ICodeCompiler icc = objCodeProvider.CreateCompiler();
        string OutputPath = BuilderSettings.ExportDir + "/" + BuilderSettings.ProjectName + "/" + BuilderSettings.ProjectName + ".dll";
        CompilerParameters parameters = new CompilerParameters();
        CompilerResults results;

        parameters.GenerateExecutable = false;
        parameters.OutputAssembly = OutputPath;
        parameters.GenerateInMemory = false;
        parameters.IncludeDebugInformation = false;

        //Add required assemblies
        DynamicLinkLibraries.Clear();

        //User defined
        DynamicLinkLibraries.Add(@"d:\wwwroot\\DC.Common\bin\Debug\DC.Common.dll");

        //System
        DynamicLinkLibraries.Add("System.dll");
        DynamicLinkLibraries.Add("System.Data.dll");
        DynamicLinkLibraries.Add("mscorlib.dll");
        DynamicLinkLibraries.Add("System.xml.dll");
        DynamicLinkLibraries.Add("System.web.dll");
        DynamicLinkLibraries.Add("System.configuration.dll");

        //Any dynamic assembly adding must be done here
        foreach (string strLibrary in DynamicLinkLibraries)
        {
            parameters.ReferencedAssemblies.Add(strLibrary);
        }

            results = icc.CompileAssemblyFromSource(parameters, strCode);

            if (results.Errors.Count > 0)
            {
                //report any compilation errors
                string strErrors = "Compilation failed:" + Environment.NewLine;

                foreach (CompilerError oError in results.Errors)
                {
                    strErrors = strErrors + "Line number " + oError.Line + ", Error Number: " + oError.ErrorNumber + ", '" + oError.ErrorText + ";";

                }

                throw new Exception("Error in CompileSourceCode(): " + Environment.NewLine + strErrors);
            }

            objCodeProvider = null;
            icc = null;
            parameters = null;"); 
```

# statistics - How do I programmatically calculate Poker Odds?

> ID：193916
> 
> 赞同：35
> 
> 时间：2008-10-11T09:57:42.113
> 
> 标签：statistics, probability, poker

I'm trying to write a simple game/utility to calculate poker odds. I know there's plenty of [resources](http://wikipedia.org/wiki/Poker_probability_(Texas_hold_'em)) that talk about the formulas to do so, but I guess I'm having trouble translating that to code. Particularly, I'm interested in Texas Hold-em ...

I understand that there are several different approaches, one being that you can calculate the odds that you will draw some hand based on the cards you can see. The other approach is calculating the odds that you will win a certain hand. The second approach seems much more complex as you'd have to enter more data (how many players, etc.)

I'm not asking that you write it for me, but some nudges in the right direction would help :-)

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-11T10:01:48.113

Here are some links to articles, which could help as starting points: [Poker Logic in C#](http://www.codeproject.com/KB/game/pokerlogic.aspx) and [Fast, Texas Holdem Hand Evaluation and Analysis](http://www.codeproject.com/KB/game/pokerhandevaldoc.aspx)

*"This code snippet will let you calculate poker probabilities the hard way, using C# and .NET."*

The theoretical fundamentals are given in this [Wikipedia article about Poker Probabilities](http://en.wikipedia.org/wiki/Poker_probability_(Texas_hold_%27em)) and in this excellent [statistical tutorial](http://www.tightpoker.com/poker_odds.html).

An example of a complete project written in Objective-C, Java, C/C++ or Python is found at [SpecialKEval](http://code.google.com/p/specialkpokereval/). Further links and reading can be found therein.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-11T10:08:09.630

Monte carlo simulation is a common approach to get the odds calculation for poker hands. There are plenty of examples of implementing this kind of simulation for holdem on the net.

[http://www.codeproject.com/KB/game/MoreTexasHoldemAnalysis1.aspx](http://www.codeproject.com/KB/game/MoreTexasHoldemAnalysis1.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-11T10:13:37.933

Take a look at [pokersource](http://pokersource.sourceforge.net/) if you have reasonably strong C abilities. It's not simple, I'm afraid, but some of the things you're looking for are complex. The poker-eval program that uses the library will probably do much of what you want if you can get the input format correct (not easy either). Sites such as [this one](http://www.propokertools.com/simulator/simulationEditor.jsp) or [this](http://twodimes.net/poker/) also use this library AFAIK.

Still, it could be worse, you could be wanting to calculate something tricky like Omaha Hi-lo...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-17T12:50:32.683

Pokersource and the statistical articles are not bad suggestions. But this is really best done with a Monte Carlo simulation, a useful, simple, and powerful approach to this type of difficult problem.

It works equally well with Omaha Hi-lo as it does with Hold'em

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-29T11:55:38.013

Have a look here as well:

[http://specialk-coding.blogspot.com/2010/04/texas-holdem-7-card-evaluator_23.html](http://specialk-coding.blogspot.com/2010/04/texas-holdem-7-card-evaluator_23.html)

Monte Carlo simulation is often slower than the good exact evaluators.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-13T09:28:16.490

Complete source code for Texas hold'em poker game evaluator can be found here:

[http://www.advancedmcode.org/poker-predictor.html](http://www.advancedmcode.org/poker-predictor.html)

It is built for matlab, the GUI id m-coded but the computational engine is c++.

It allows for odds and probability calculation. It can deal, on my 2.4Ghz laptop, with a 100000 10 players game computation in 0,3 seconds.

An accurate real time computer:-)

# opengl - 将 Z 轴与矢量对齐的最简单方法是什么？

> ID：193918
> 
> 赞同：4
> 
> 时间：2008-10-11T09:58:45.920
> 
> 标签：opengl, 3d, vector, alignment, matrix

给定一个点，例如 (0, 0, 0) 和一个向量，例如 (x, y, z)。对齐以 (0, 0, 0) 为中心的负 Z 轴以指向该向量的方向的最简单方法是什么？欢迎使用 OpenGL 的示例，但不是必需的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-11T12:43:47.223

旋转坐标系以指向给定方向有很多不同的方法；它们都会使 z 轴指向您想要的方向，但 x 轴和 y 轴的方向会有所不同。

以下为您提供最短的轮换，这可能是也可能不是您想要的。

```
vec3 target_dir = normalise( vector );
float rot_angle = acos( dot_product(target_dir,z_axis) );
if( fabs(rot_angle) > a_very_small_number )
{
    vec3 rot_axis = normalise( cross_product(target_dir,z_axis) );
    glRotatef( rot_angle, rot_axis.x, rot_axis.y, rot_axis.z );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-11T10:02:51.747

要回答我自己的问题，我想出的最佳答案是：

将向量分成“分量”。x 分量是沿 x 轴的位移。如果我们转向三角学，我们有 cos(alpha) = x / vector_magnitude。如果我们计算 RHS，那么我们可以推导出 alpha，这是我们必须绕 y 轴旋转的量。

然后可以通过一系列调用 glRotatef() 将坐标系与向量对齐

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-06T13:42:02.063

你可能想看看[Diana Gruber 的](http://www.fastgraph.com/makegames/3drotation/)文章

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T19:44:22.803

有很多关于旋转坐标（或旋转对象，相当于同一件事）的资源。[我从这个网站](http://tfpsly.free.fr/Docs/3dIca/3dica2.htm#chap23)学到了很多东西，包括如何进行多维编程，尤其是[如何操作向量。](http://tfpsly.free.fr/Docs/3dIca/3dica1.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-05T20:05:17.327

[此处](http://inside.mines.edu/~gmurray/ArbitraryAxisRotation/ArbitraryAxisRotation.html)的页面有一个“将矢量移动到 z 轴的转换”部分，这似乎是您想要的，或者可能是它的倒数。

# python - Python 导入有哪些好的经验法则？

> ID：193919
> 
> 赞同：74
> 
> 时间：2008-10-11T09:59:35.903
> 
> 标签：python, python-import

我对在 Python 中导入模块的多种方式感到有些困惑。

```
import X
import X as Y
from A import B 
```

我一直在阅读有关范围和名称空间的信息，但我想就什么是最佳策略、在什么情况下以及为什么要提供一些实用的建议。导入应该发生在模块级别还是方法/函数级别？在`__init__.py`模块代码本身中还是在模块代码中？

[“ Python 包 - 按类导入，而不是文件](https://stackoverflow.com/questions/45122/python-packages-import-by-class-not-file)”并没有真正回答我的问题，尽管它显然是相关的。

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2008-10-11T10:15:40.457

在我们公司的生产代码中，我们尽量遵循以下规则。

我们将导入放在文件的开头，就在主文件的文档字符串之后，例如：

```
"""
Registry related functionality.
"""
import wx
# ... 
```

现在，如果我们导入一个类，它是导入模块中少数几个之一，我们直接导入名称，这样在代码中我们只需要使用最后一部分，例如：

```
from RegistryController import RegistryController
from ui.windows.lists import ListCtrl, DynamicListCtrl 
```

然而，有些模块包含几十个类，例如所有可能的异常列表。然后我们导入模块本身并在代码中引用它：

```
from main.core import Exceptions
# ...
raise Exceptions.FileNotFound() 
```

我们`import X as Y`尽可能少地使用，因为它使搜索特定模块或类的使用变得困难。但是，有时，如果您希望导入两个具有相同名称但存在于不同模块中的类，则必须使用它，例如：

```
from Queue import Queue
from main.core.MessageQueue import Queue as MessageQueue 
```

作为一般规则，我们不在方法内部进行导入——它们只会使代码变慢且可读性降低。有些人可能会发现这是轻松解决循环导入问题的好方法，但更好的解决方案是代码重组。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-10-11T18:34:42.087

让我将部分对话粘贴到由 Guido van Rossum 发起的 django-dev 邮件列表中：

> [...] 例如，Google Python 风格指南 [1] 的一部分是所有导入都必须导入一个模块，而不是来自该模块的类或函数。类和函数比模块多得多，因此如果以模块名称为前缀，则回忆特定事物的来源要容易得多。通常多个模块碰巧定义了具有相同名称的事物——因此代码的读者不必回到文件顶部来查看给定名称是从哪个模块导入的。

**来源：** [http ://groups.google.com/group/django-developers/browse_thread/thread/78975372cdfb7d1a](http://groups.google.com/group/django-developers/browse_thread/thread/78975372cdfb7d1a)

1：[http ://code.google.com/p/soc/wiki/PythonStyleGuide#Module_and_package_imports](http://code.google.com/p/soc/wiki/PythonStyleGuide#Module_and_package_imports)

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-11T10:10:13.417

我通常会`import X`在模块级别使用。如果您只需要模块中的单个对象，请使用`from X import Y`.

仅`import X as Y`在您遇到名称冲突的情况下使用。

当模块用作主模块时，我只在功能级别使用导入来导入我需要的东西，例如：

```
def main():
  import sys
  if len(sys.argv) > 1:
     pass 
```

高温高压

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-04-17T21:10:34.583

上面有人说

```
from X import A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P 
```

相当于

```
import X 
```

`import X`允许直接修改 AP，同时`from X import ...`创建 AP 的副本。因为`from X import A..P`如果变量被修改，你不会得到更新。如果您修改它们，您只修改您的副本，但 X 确实知道您的修改。

如果AP是函数，你就不会知道区别。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-11T13:49:34.970

其他人已经涵盖了这里的大部分内容，但我只想添加一个案例`import X as Y`，当我尝试新版本的类或模块时，我将（暂时）使用。

因此，如果我们要迁移到一个模块的新实现，但又不想一次性削减所有代码库，我们可能会编写一个`xyz_new`模块并在我们迁移的源文件中执行此操作：

```
import xyz_new as xyz 
```

然后，一旦我们切断了整个代码库，我们只需将`xyz`模块替换为`xyz_new`并将所有导入更改回

```
import xyz 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-11T14:00:13.000

不要这样做：

```
from X import * 
```

除非您绝对确定您将使用该模块中的每一件事。即使这样，您也应该重新考虑使用不同的方法。

除此之外，这只是风格问题。

```
from X import Y 
```

很好，可以为您节省大量打字时间。当我经常使用其中的某些内容时，我倾向于使用它但是如果您从该模块中导入了很多内容，则最终可能会得到如下所示的导入语句：

```
from X import A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P 
```

你明白了。那是当进口像

```
import X 
```

变得有用。要么是这样，要么我并没有真正经常在 X 中使用任何东西。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-11T11:27:35.647

我一般会尝试使用常规的`import modulename`，除非模块名称很长，或者经常使用..

例如，我会做..

```
from BeautifulSoup import BeautifulStoneSoup as BSS 
```

..所以我可以`soup = BSS(html)`代替`BeautifulSoup.BeautifulStoneSoup(html)`

或者..

```
from xmpp import XmppClientBase 
```

..而不是在我只使用 XmppClientBase 时导入整个 xmpp

`import x as y`如果您想导入非常长的方法名称，或者要防止破坏现有的导入/变量/类/方法（您应该尝试完全避免这种情况，但这并不总是可能的），使用很方便

假设我想从另一个脚本运行 main() 函数，但我已经有一个 main() 函数..

```
from my_other_module import main as other_module_main 
```

..不会用 my_other_module 替换我的`main`函数`main`

哦，有一件事——不要做`from x import *`——它使你的代码很难理解，因为你不能轻易地看到一个方法来自`from x import *; from y import *; my_func()`哪里（ - my_func 定义在哪里？）

在所有情况下，你*都可以*做`import modulename`然后做`modulename.subthing1.subthing2.method("test")`......

这些`from x import y as z`东西纯粹是为了方便——只要它能让你的代码更容易阅读或编写，就使用它！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-15T11:07:41.533

当你有一个编写良好的库时，有时在 python 中就是这种情况，你应该只导入它并使用它。编写良好的库倾向于采用自己的生命和语言，从而产生令人愉悦的阅读代码，而您很少引用该库。当一个库写得很好时，你不应该经常需要重命名或其他任何事情。

```
import gat

node = gat.Node()
child = node.children() 
```

有时不可能这样写，或者你想从你导入的库中删除一些东西。

```
from gat import Node, SubNode

node = Node()
child = SubNode(node) 
```

有时您会为很多事情这样做，如果您的导入字符串溢出 80 列，那么这样做是个好主意：

```
from gat import (
    Node, SubNode, TopNode, SuperNode, CoolNode,
    PowerNode, UpNode
) 
```

最好的策略是将所有这些导入保留在文件的顶部。最好按字母顺序排列，首先是 import -statements，然后是 from import -statements。

现在我告诉你为什么这是最好的约定。

Python 完全可以有一个自动导入，当无法从全局命名空间中找到它时，它会从主导入中查找值。但这不是一个好主意。我简要解释一下原因。除了实现起来比简单的导入更复杂之外，程序员不会过多地考虑依赖关系并找出从哪里导入的东西应该以其他方式完成，而不仅仅是查看导入。

需要找出依赖关系是人们讨厌“from ... import *”的原因之一。但是，您需要执行此操作的一些不好的示例存在，例如 opengl -wrappings。

因此，导入定义实际上对于定义程序的依赖关系很有价值。这是你应该如何利用它们的方式。从他们那里你可以快速检查一些奇怪的功能是从哪里导入的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-11T10:23:48.567

如果您有相同模块/类的不同实现，这`import X as Y`很有用。

使用一些嵌套`try..import..except ImportError..import`的 s，您可以从代码中隐藏实现。请参阅[lxml etree 导入示例](http://codespeak.net/lxml/tutorial.html)：

```
try:
  from lxml import etree
  print("running with lxml.etree")
except ImportError:
  try:
    # Python 2.5
    import xml.etree.cElementTree as etree
    print("running with cElementTree on Python 2.5+")
  except ImportError:
    try:
      # Python 2.5
      import xml.etree.ElementTree as etree
      print("running with ElementTree on Python 2.5+")
    except ImportError:
      try:
        # normal cElementTree install
        import cElementTree as etree
        print("running with cElementTree")
      except ImportError:
        try:
          # normal ElementTree install
          import elementtree.ElementTree as etree
          print("running with ElementTree")
        except ImportError:
          print("Failed to import ElementTree from any known place") 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-02-10T13:13:55.180

事实上，我和杰森在一起不使用

```
from X import * 
```

但就我而言（我不是专业程序员，所以我的代码不太符合编码风格）我通常在我的程序中创建一个包含所有常量的文件，如程序版本、作者、错误消息和所有这些东西，所以文件只是定义，然后我进行导入

```
from const import * 
```

这节省了我很多时间。但它是唯一具有该导入的文件，这是因为该文件中的所有内容都只是变量声明。

在包含类和定义的文件中进行这种导入可能很有用，但是当您必须阅读该代码时，您会花费大量时间来定位函数和类。

# .net - 呼叫和 Callvirt

> ID：193939
> 
> 赞同：62
> 
> 时间：2008-10-11T10:26:58.780
> 
> 标签：.net, reflection, cil, reflection.emit

CIL 指令“Call”和“Callvirt”有什么区别？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-10-11T10:51:59.837

当运行时执行一条`call`指令时，它正在调用一段确切的代码（方法）。毫无疑问它存在于何处。 ~~一旦 IL 被 JITted，在调用站点生成的机器代码就是一个无条件`jmp`指令。~~

相比之下，该`callvirt`指令用于以多态方式调用虚方法。必须在运行时为每次调用确定方法代码的确切位置。生成的 JITted 代码涉及通过 vtable 结构进行的一些间接操作。因此调用执行速度较慢，但​​它更灵活，因为它允许多态调用。

请注意，编译器可以发出`call`虚拟方法的指令。例如：

```
sealed class SealedObject : object
{
   public override bool Equals(object o)
   {
      // ...
   }
} 
```

考虑调用代码：

```
SealedObject a = // ...
object b = // ...

bool equal = a.Equals(b); 
```

虽然`System.Object.Equals(object)`是一个虚方法，但在这种用法中，方法的重载是不可能`Equals`存在的。 `SealedObject`是密封类，不能有子类。

出于这个原因，.NET 的`sealed`类可以比它们的非密封类具有更好的方法分派性能。

**编辑：**原来我错了。C# 编译器无法无条件跳转到方法的位置，因为对象的引用（`this`方法内的值）可能为空。相反，它会发出`callvirt`执行 null 检查并在需要时抛出。

这实际上解释了我在使用 Reflector 的 .NET 框架中发现的一些奇怪代码：

```
if (this==null) // ... 
```

编译器可以发出`this`指针 (local0) 为空值的可验证代码，只有 csc 不这样做。

所以我猜`call`它只用于类静态方法和结构。

鉴于这些信息，现在在我看来，这`sealed`仅对 API 安全有用。我发现[另一个问题](https://stackoverflow.com/questions/2134/do-sealed-classes-really-offer-performance-benefits)似乎表明密封你的课程没有性能优势。

**编辑2：**这比看起来的要多。例如下面的代码发出一条`call`指令：

```
new SealedObject().Equals("Rubber ducky"); 
```

显然，在这种情况下，对象实例不可能为空。

有趣的是，在 DEBUG 构建中，会发出以下代码`callvirt`：

```
var o = new SealedObject();
o.Equals("Rubber ducky"); 
```

这是因为您可以在第二行设置断点并修改`o`. 在发布版本中，我想调用将是 a`call`而不是`callvirt`.

不幸的是，我的电脑目前无法使用，但一旦它再次启动，我将对此进行试验。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-11T10:45:14.327

`call`用于调用非虚拟、静态或超类方法，即调用的目标不受覆盖。`callvirt`用于调用虚方法（因此如果`this`是覆盖该方法的子类，则改为调用子类版本）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-11T11:02:48.770

> 出于这个原因，.NET 的密封类比它们的非密封类具有更好的方法分派性能。

不幸的是，这种情况并非如此。Callvirt 做了另一件事，使它变得有用。当一个对象调用了一个方法时，callvirt 将检查该对象是否存在，如果不存在则抛出 NullReferenceException。即使对象引用不存在，调用也会简单地跳转到内存位置，并尝试执行该位置中的字节。

这意味着 C# 编译器（不确定 VB）总是将 callvirt 用于类，而 call 总是用于结构（因为它们永远不能为空或子类）。

**编辑**回应 Drew Noakes 评论：是的，您似乎可以让编译器发出对任何类的调用，但仅限于以下非常具体的情况：

```
public class SampleClass
{
    public override bool Equals(object obj)
    {
        if (obj.ToString().Equals("Rubber Ducky", StringComparison.InvariantCultureIgnoreCase))
            return true;

        return base.Equals(obj);
    }

    public void SomeOtherMethod()
    {
    }

    static void Main(string[] args)
    {
        // This will emit a callvirt to System.Object.Equals
        bool test1 = new SampleClass().Equals("Rubber Ducky");

        // This will emit a call to SampleClass.SomeOtherMethod
        new SampleClass().SomeOtherMethod();

        // This will emit a callvirt to System.Object.Equals
        SampleClass temp = new SampleClass();
        bool test2 = temp.Equals("Rubber Ducky");

        // This will emit a callvirt to SampleClass.SomeOtherMethod
        temp.SomeOtherMethod();
    }
} 
```

**注意**这个类不需要被密封才能工作。

所以看起来如果所有这些事情都是真的，编译器会发出一个调用：

*   方法调用是在对象创建之后立即调用的
*   该方法未在基​​类中实现

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-10-03T13:34:05.793

根据 MSDN：

[致电](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.call.aspx)：

调用指令调用与指令一起传递的方法描述符所指示的方法。方法描述符是一个元数据标记，指示要调用的方法……元数据标记携带足够的信息来确定调用是对静态方法、实例方法、虚拟方法还是全局函数。**在所有这些情况下，目标地址完全由方法描述符确定**（这与调用虚拟方法的 Callvirt 指令形成对比，其中目标地址还取决于在 Callvirt 之前推送的实例引用的运行时类型）。

[呼叫虚拟机](http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.callvirt.aspx)：

callvirt 指令调用对象的后期绑定方法。也就是说，**方法是根据 obj 的运行时类型而不是方法指针中可见的编译时类来选择的**。Callvirt 可用于调用虚拟和实例方法。

所以基本上，不同的路由被用来调用一个对象的实例方法，覆盖与否：

调用：变量 ->**变量的**类型对象 -> 方法

CallVirt：变量 -> 对象实例 ->**对象的**类型对象 -> 方法

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-06-28T15:15:02.313

可能值得在前面的答案中添加的一件事是，“IL call”的实际执行方式似乎只有一个方面，而“IL callvirt”的执行方式似乎只有两个方面。

采用此示例设置。

```
 public class Test {
        public int Val;
        public Test(int val)
            { Val = val; }
        public string FInst () // note: this==null throws before this point
            { return this == null ? "NO VALUE" : "ACTUAL VALUE " + Val; }
        public virtual string FVirt ()
            { return "ALWAYS AN ACTUAL VALUE " + Val; }
    }
    public static class TestExt {
        public static string FExt (this Test pObj) // note: pObj==null passes
            { return pObj == null ? "NO VALUE" : "VALUE " + pObj.Val; }
    } 
```

首先，FInst() 和 FExt() 的 CIL 主体是 100% 相同的，操作码到操作码（除了一个被声明为“实例”而另一个被声明为“静态”）——然而，FInst() 将被调用“callvirt”和带有“call”的 FExt()。

其次，FInst() 和 FVirt() 都将用“callvirt”调用——即使一个是虚拟的，而另一个不是——但它不是真正可以执行的“同一个 callvirt”。

以下是 JITting 后大致发生的情况：

```
 pObj.FExt(); // IL:call
    mov         rcx, <pObj>
    call        (direct-ptr-to) <TestExt.FExt>

    pObj.FInst(); // IL:callvirt[instance]
    mov         rax, <pObj>
    cmp         byte ptr [rax],0
    mov         rcx, <pObj>
    call        (direct-ptr-to) <Test.FInst>

    pObj.FVirt(); // IL:callvirt[virtual]
    mov         rax, <pObj>
    mov         rax, qword ptr [rax]  
    mov         rax, qword ptr [rax + NNN]  
    mov         rcx, <pObj>
    call        qword ptr [rax + MMM] 
```

"call" 和 "callvirt[instance]" 之间的唯一区别是 "callvirt[instance]" 在调用实例函数的直接指针之前故意尝试从 *pObj 访问一个字节（为了可能抛出异常）就在那儿，然后”）。

因此，如果您对必须编写的“检查部分”的次数感到恼火

```
var d = GetDForABC (a, b, c);
var e = d != null ? d.GetE() : ClassD.SOME_DEFAULT_E; 
```

您不能推送“if (this==null) return SOME_DEFAULT_E;” 深入到 ClassD.GetE() 本身（因为“IL callvirt [instance]”语义禁止你这样做）但是如果你将 .GetE() 移动到某个扩展函数，你可以自由地将它推入 .GetE() （正如“IL 调用”语义允许的那样——但可惜的是，失去了对私有成员的访问权限等）

也就是说，“callvirt[instance]”的执行与“call”相比与“callvirt[virtual]”的共同点更多，因为后者可能必须执行三次间接寻址才能找到函数的地址。（间接到 typedef base，然后到 base-vtab-or-some-interface，然后到实际插槽）

希望这会有所帮助，鲍里斯

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-03-13T16:01:10.647

只是添加到上面的答案，我认为改变已经很久了，这样Callvirt IL指令将为所有实例方法生成，Call IL指令将为静态方法生成。

参考 ：

Pluralsight 课程“C# 语言内部知识 - 第 1 部分，由 Bart De Smet 撰写（视频——简而言之 CLR IL 中的调用指令和调用堆栈）

还有 [https://blogs.msdn.microsoft.com/ericgu/2008/07/02/why-does-c-always-use-callvirt/](https://blogs.msdn.microsoft.com/ericgu/2008/07/02/why-does-c-always-use-callvirt/)

# scope - 项目范围的灵活性？

> ID：193940
> 
> 赞同：2
> 
> 时间：2008-10-11T10:29:28.323
> 
> 标签：scope, requirements

如果客户请求不在项目范围内的需求，程序员应该有多灵活？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-11T10:57:31.790

一般观点：

你需要谋生；客户需要一个计算解决方案：客户有权确保您提供的解决方案符合他的需求。达成协议后的更改和添加，反映了您将用户需求分析到系统设计中的能力，因为未能足够深入和详细地调查这些需求：您需要仔细执行此操作并获得书面签字与客户就您的系统设计达成一致。

法律观点：

您应该确定项目的范围，并让客户签署该范围的协议。一旦您达成了该协议，任何未包含在该协议中的内容都将构成一个新项目。

商业视角：

您想继续（与当前和未来的客户）开展业务吗？您需要评估添加所需的新功能对当前项目的影响：如果影响很小，那就去做，但要以书面形式告诉客户您是在帮他一个忙；如果影响更大，那么您必须与客户协商，概述问题，并调整您当前的协议，或制定新协议。你不想做的是与你的客户对抗。

最后：“客户永远是对的。” - （直到你不得不放弃并离开的地步。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-11T10:42:42.600

这个问题不能一概而论。这取决于项目。

例子：

客户有钱要烧，时间线长，没有其他项目在忙，我很灵活。

客户很紧张，时间很短，还有其他项目在进行中，我一点都不灵活。

其他因素也会发挥作用，例如为项目选择的过程。例如，您将在敏捷过程中更加灵活，而在瀑布方法中则不太灵活。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-11T10:44:27.107

我认为你的问题的答案归结为你的客户在时间和成本方面的灵活性，因为你不能在不影响这两件事的情况下改变项目的范围。

如果范围蔓延允许项目发展并对项目结果产生整体积极影响，那么范围蔓延可能是一件好事。您确实需要一个正式的变更流程来管理范围变更。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-11T14:00:03.060

如果这是一个固定投标项目，那么我愿意进行谈判，并同意扩大一个领域的范围，以换取在其他地方缩小范围，或增加预算，或换取其他一些考虑。

如果是我按小时计费的客户，那么他们可以扩大他们想要的范围，因为无论是否在项目的原始定义范围内，我都会按我花费的时间向他们收费。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-11T15:12:03.493

预先定义系统将执行的功能列表。

如果客户端添加了新功能，则相应地增加成本和时间。

如果客户决定将某个功能排除在范围之外，那么如果您还没有实现它，则减少成本和时间。

# boo - 什么时候一种新语言是适合这项工作的工具？

> ID：193941
> 
> 赞同：14
> 
> 时间：2008-10-11T10:30:20.160
> 
> 标签：boo, nemerle

很长一段时间以来，我一直在尝试不同的语言来找到我想要的功能集，但我一直无法找到它。我的语言非常适合我的各种项目，但我提出了这些语言的交集，这将使我能够用一种语言完成 99.9% 的项目。我想要以下内容：

*   构建在 .NET 之上或具有 .NET 实现
*   在编译时和运行时对 .NET 运行时的依赖很少（这很重要，因为主要用例之一是在 .NET 运行时完全自定义的嵌入式开发中）
*   有一个 100% .NET 代码的编译器，没有非托管依赖项
*   支持任意表达式嵌套（见下文）
*   支持自定义运算符定义
*   支持类型推断
*   优化尾调用
*   具有明确的不可变/可变定义（很好——我开始喜欢这个但没有它也可以生活）
*   支持强大的元编程的真实宏（绝对必备）

我主要使用的两种语言是 Boo 和 Nemerle，但我也使用过 F#。

对 Nemerle 的主要抱怨：编译器有可怕的错误报告，实现是地狱般的错误（编译器和库），宏只能在函数内或作为属性应用，而且依赖关系相当严重（尽管还不够破坏者）。
对 Boo 的主要抱怨：没有任意表达式嵌套（dealbreaker），宏难以编写，没有自定义运算符定义（潜在的 dealbreaker）。
对 F# 的主要抱怨：难看的语法、难以理解的元编程、非自由许可证（史诗般的交易破坏者）。

所以我想得越多，我就越想开发自己的语言。

优点：

*   获取我想要的确切语法
*   获得更快的周转时间；很难量化，但看到 1.5 倍的开发人员生产力我不会感到惊讶，特别是由于测试基础设施可以为某些项目启用
*   我可以轻松地向编译器添加自定义功能，以便与我的运行时完美配合
*   我得到了*完全*按照我想要的方式设计和工作的东西——尽管这听起来像 NIH，但这会让我的生活更轻松

缺点：

*   除非它能够流行起来，否则我将被维护的负担所困。我知道我至少可以让 Nemerle 人过来，因为我认为每个人都想要更专业的东西，但这需要一个村庄。
*   由于第一个骗局，我对在专业环境中使用它持谨慎态度。也就是说，我已经在使用 Nemerle 并使用我自己的自定义修改编译器，因为他们根本没有很好地维护它。
*   如果它没有得到普及，那么寻找开发人员将变得更加困难，以至于[保罗格雷厄姆](http://www.paulgraham.com/pypar.html)甚至可能不会宽恕。

所以基于所有这些，普遍的共识是什么——这是一个好主意还是一个坏主意？也许更有帮助的是，我是否错过了任何重大的利弊？

编辑：忘记添加嵌套示例——这是 Nemerle 的一个案例：

```
def foo = 
    if(bar == 5)
        match(baz) { | "foo" => 1 | _ => 0 }
    else bar; 
```

编辑＃2：认为如果存在将转换为这种语言的代码类型的示例，这不会有什么坏处（仅 S. Lott 的回答可能足以吓跑我不要这样做）。该代码大量使用了自定义语法（操作码、:=、quoteblock 等）、表达式嵌套等。您可以在此处查看一个很好的示例：[here](http://ironbabel.svn.sourceforge.net/viewvc/ironbabel/trunk/CPU/IA32/IA32StackMove.n?view=markup)。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-11T10:52:32.847

可悲的是，没有关于失败语言的指标或故事。只是成功的语言。显然，失败的次数多于成功的次数。

我有什么依据？两个共同的经历。

1.  一年一次或两次，我必须忍受一个绝对改变一切的产品/语言/工具/框架的推销。在过去 20 年左右的时间里，我的回答一直保持不变。告诉我需要支持的人，我的公司会支持他们。就是这样。再也不会收到他们的消息了。假设我已经听过其中的 25 个。

2.  每年一次或两次，我必须与一个拥有孤儿技术的客户一起工作。在过去的某个时候，一些聪明的编程构建了一个工具/框架/库/包，在内部用于多个项目。然后那个程序员离开了。没有人能弄清楚那该死的东西，他们希望我们替换/重写它。可悲的是，我们也无法弄清楚，我们的建议是从头开始重写。他们抱怨说，他们的天才在几周内就构建了一组应用程序，我们用 Java/Python/VB/C# 重写它们不能花费我们几个月的时间。假设我已经写了 25 个左右的此类提案。

那只是我，一位顾问。

确实，一个特别令人难过的情况是，一家公司的整个 IT 软件组合都是由一个聪明人用一种私人语言和工具编写的。他没有离开，但他意识到他的语言和工具集已经远远落后于时代——最先进的技术已经在进步，而他没有。

而这一举动——当然——是在一个意想不到的方向上。他的语言和工具还可以，但世界已经开始采用关系数据库，他绝对没有办法升级他的垃圾以摆脱平面文件。这是他没有预料到的。的确，这是他无法预料的事情。【你不会掉进这个陷阱吧？】

所以，我们谈了。他用普通的 VAX Fortran 重写了很多应用程序（是的，这是很久以前的事了。）他重写了它以使用普通的老式关系 SQL 东西（当时是 Ingres。）

经过一年的编码，他们遇到了性能问题。他们打电话给我，回顾他们在替换自制语言方面所做的所有伟大工作。可悲的是，他们做了最糟糕的关系数据库设计。最坏的可能。他们对文件进行了复制、合并、排序和诸如此类的操作，并使用 SQL 实现了每个低级文件系统操作，将数据库行左、右和中心复制。

他深陷于自己对完美语言的私人愿景中，无法适应一种相对普遍、无处不在的新技术。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-11T11:16:00.943

我说去吧。

*   无论天气如何，这将是一次很棒的体验。
*   如果您将其编译为 IL，那么您不必担心无法使用 C# 重新使用已编译的程序集
*   如果您认为您对上面列出的语言有有效的投诉，很可能很多人会像您一样思考。当然，对于每 1000 个感兴趣的人，可能会有 1 个愿意帮助您维护它 - 但这始终是风险

但这里有几点需要注意：

*   在开发之前获取您的语言规范 IN STONE。确保事先弄清楚所有语言功能 - 即使是您将来可能只想要的东西。在我看来，C# 正在慢慢落入“哦，只是多一种语言扩展”的陷阱，这将导致它最终走向灭亡。
*   一定要优化它。我不知道你已经知道了什么；但如果你不知道，那就学吧；) 没有人会想要一种语法优美但运行速度与 IE 的 javascript 实现一样慢的语言。

祝你好运：D

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-11T14:27:15.753

当我在 90 年代初开始我的职业生涯时，似乎有一种每个人都在开发自己的内部语言的热潮。我的前*3*份工作是在做这件事的公司工作的。一家公司甚至开发了自己的操作系统！

根据经验，我会说这是一个坏主意，原因如下：

1）除了代码库之外，您还将花时间调试语言本身
2）您雇用的任何开发人员都需要经历该语言的学习曲线
3）自从工作以来，很难吸引和留住开发人员使用专有语言是某人职业生涯的死胡同

我离开这三份工作的主要原因是因为他们有专有语言，你会注意到已经没有多少公司走这条路了:)。

我要提出的另一个论点是，大多数语言都有完整的团队，他们的全职工作是开发语言。也许您会是个例外，但如果您仅通过兼职研究该语言就能达到这种发展水平，我会感到非常惊讶。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-02-08T10:15:13.370

> 对 Nemerle 的主要抱怨：编译器有可怕的错误报告，实现是地狱般的错误（编译器和库），宏只能在函数内部或作为属性应用，并且依赖关系相当严重（尽管还不够破坏者）。

我看到你的帖子已经写了两年多了。我建议你今天尝试 Nemerle 语言。编译器是稳定的。今天没有阻止程序错误。VS 集成有很多改进，也有 SharpDevelop 集成。

如果你给它一个机会，你不会失望的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-11T10:54:54.963

永远不要开发自己的语言。

开发自己的语言是一个愚蠢的陷阱，更糟糕的是，它会限制您的想象力，同时要求您制定出您的开发环境和您正在编写的实际程序。

如果您是 Larry Wall、AWK 人员或致力于测试编程边界的大量人员中的一员，则这种情况几乎不适用。如果你属于这些类别中的任何一个，你不需要我的建议，但我强烈怀疑你的目标是一个没有适合该任务的编程语言和执行该任务的人的特征的利基市场。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-11T11:14:50.430

如果你和你看起来一样聪明（很可能），我的建议是继续进行语言的设计，重复几次，问一些你信任的智能编程语言相关的聪明人社区了解您提出的具体设计，然后做出决定。

例如，您可能会在创建设计的过程中意识到，只需快速破解 Nemerle 即可满足您的所有需求。很多事情都是在认真思考一个问题时发生的，最终的解决方案可能并不是你在开始项目时真正想到的。

在最坏的情况下，您被困在实际实现设计中，但到那时您将对其进行校对并使其成熟，并且您将高度肯定地知道这是一条好路。

一条相关的建议，从小处着手，只需定义您绝对需要的功能，然后在它们的基础上获得其余部分。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-11T10:48:34.790

编写自己的语言不是一个容易的项目。尤其是在任何类型的“专业环境”中使用的项目

这是一项**巨大**的工作，我怀疑您是否可以编写自己的语言，并且仍然编写使用它的任何大型项目——您将花费很长时间添加您需要的功能、修复错误和通用语言设计的东西。

我*强烈*建议选择一种最接近您想要的语言，并将其扩展为您需要的语言。它永远不会是你想要的，但与你花在编写自己的语言上的时间相比，我会说这是一个小小的妥协。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-11T13:04:31.847

Scala 有一个 .NET 编译器。虽然我不知道这个状态。它是 Scala 世界中的二等公民（更专注于 JVM）。但是，采用 .NET 编译器而不是从头开始创建新语言可能是一个很好的权衡。

Scala 在元编程部门 ATM 中有点弱。其他语言特性可能会在一定程度上减少对元编程的需求。无论如何，如果您要为其实现元编程功能，我认为没有人会感到难过。还有一个编译器插件基础设施正在开发中。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-11T14:35:18.577

我认为大多数语言永远无法满足所有要求。

您可能想要结合您最喜欢的 2 种语言（在我的例子中是 C# 和[Scheme](http://codeplex.com/IronScheme)）并将它们一起使用。

从专业的角度来看，这可能不是一个好主意。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-11T11:00:12.003

听到一些你觉得用现有语言做不到的事情会很有趣。您正在从事哪些 C# 无法完成的项目？

我只是古玩！

# c++ - 有没有什么好的 C/C++ 开源 BDD 工具？

> ID：193965
> 
> 赞同：22
> 
> 时间：2008-10-11T11:08:54.140
> 
> 标签：c++, c, testing, bdd

我喜欢 Ruby RSpec BDD 开发风格。有没有用 C/C++ 做这件事的好工具？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-11T12:48:09.400

[cspec](http://github.com/arnaudbrejeon/cspec/wikis/home)适用于 C。大概它可以与 C++ 一起使用。[行为驱动开发 Wikipedia 页面](http://en.wikipedia.org/wiki/Behavior_Driven_Development)上有各种语言的工具列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T20:10:53.743

原始链接 ( [CppSpec](http://www.laughingpanda.org/projects/cppspec) ) 已失效，但仍可在[CppSpec的](https://web.archive.org/web/20080208105001/http://www.laughingpanda.org/projects/cppspec/)[Internet 档案](https://archive.org/web/)中访问。

正如@VickyChijwani 已经提到的那样，[Github 上有该项目的副本 - tpuronen/cppspec](https://github.com/tpuronen/cppspec)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-06T05:09:28.023

看来您可以使用 Ruby 和 RSpec 测试您的 C 代码，使用 swig 生成包装器！请在此处查看 Ben Mabey 的帖子：http: [//benmabey.com/2007/09/09/bdd-your-c.html](http://benmabey.com/2007/09/09/bdd-your-c.html)

我已经尝试过这个例子，它对我有用。我不确定是否有人更进一步。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-24T18:59:31.690

[冰屋](http://igloo-testing.org/)是我期待尝试一段时间的一个

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-15T12:42:28.180

试试[CBehave](https://github.com/bigwhite/cbehave)！它是一个使用 given/when/then 宏的类似 RSpec 的 BDD 框架。例子：

```
FEATURE(1, "strstr")
    SCENARIO("The strstr finds the first occurrence of the substring in the source string")

       GIVEN("A source string: [Lionel Messi is a great football player]")
           char *str = "Lionel Messi is a great football player";
       GIVEN_END

       WHEN("we use strstr to find the first occurrence of [football]")
           char *p = strstr(str, "football");
       WHEN_END

       THEN("We should get the string: [football player]")
           SHOULD_STR_EQUAL(p, "football player");
       THEN_END
   SCENARIO_END
FEATURE_END 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-10-08T09:26:11.257

由于请求了类似 RSpec 的框架，我想添加最近的[igloo](http://igloo-testing.org/)。虽然最初针对的是 Context/Spec 语法，但它也支持 Describe/It 语法。像在那些基于 C 的框架中那样设置测试运行器和测试装置并没有太多噪音。它甚至比 CppSpec 看起来更好。他们通过使用体面的模板机制来实现这一点。

# variables - 如何正确命名代表值 1 - n 的变量？

> ID：193973
> 
> 赞同：2
> 
> 时间：2008-10-11T11:19:25.303
> 
> 标签：variables, naming

这显然取决于您使用它们的上下文，但是，我想知道是否有一种普遍接受的方式来命名这些变量，或者至少在数学上下文中。

我经常看到：

```
float k         = someValue;
float oneMinusK = 1 - k; 
```

...这对我来说似乎既具有描述性又毫无意义。

请注意，我不是在问如何命名变量，而是在这种情况下如何命名。非常感谢您使用它们的示例和上下文，

谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-11T11:26:16.570

假设 k 是 X 发生的概率，概率 1-k 是 X 不发生的概率。

所以

```
float will_win_lottery = 0.00000000001;
float will_not_win_lottery = 1 - will_win_lottery; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-11T11:22:41.413

您应该根据您正在处理的领域而不是您用来生成它的算法来命名您的变量。因此，如果 k 代表您的门牌号，则 k-1 可能代表您隔壁邻居的门牌号。相应地命名它。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-11T11:41:52.187

我称它为[Complement](http://en.wikipedia.org/wiki/Complement_(mathematics))。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-11T12:02:04.283

当我需要它时，我可能会计算出来。您认为将其存储在变量中可以节省多少时间？请记住，过早的优化是万恶之源。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T01:08:34.003

如果不知道“k”代表什么，就无法回答您的问题。具有讽刺意味的是，这不可能的原因首先是变量“k”的命名不当，所以这才是你应该担心的。如果你给“k”一个更具描述性的名字，那么“k-1”的一个好的命名选择应该很自然，就像“will_win_lottery”和“will_not_win_lottery”的例子一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-11T12:23:41.633

这些应该是常数吗？

如果您只是出于易读性的原因而这样做，为什么不按照 la Dan 的建议创建一个方法。

```
float complement(float n) { return (1.0 - n); } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-11T13:56:13.443

您的用法似乎已经足够具有描述性，请继续使用。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2008-10-11T11:28:36.127

真的有关系吗？使用我；它的描述性并不比 k 低。如果您是关于代码描述性的强迫症，则需要记录/注释此类事情。

# php - 在 PHP 中动态使用函数原型

> ID：193994
> 
> 赞同：3
> 
> 时间：2008-10-11T11:42:09.360
> 
> 标签：php, function-calls

我正在用 PHP 编写一个结构，其中解析器确定动态调用哪个函数，有点像这样：

```
// The definition of what to call
$function_call_spec = array( "prototype"  => "myFunction", 
                             "parameters" => array( "first_par"  => "Hello",
                                                    "second_par" => "World"));

// Dispatch
$funcPrototype = $function_call_spec["prototype"];
$funcPrototype(); // Here we call function 'myFunction'. 
```

这一切都很好，花花公子。但现在是下一步，传递参数，我真的不知道这是否可能是我想要的方式。它永远不会让我感到惊讶，但是这些天脚本语言可以做什么，所以这里是：

可以像这样将参数传递给函数：

```
// Here we call function 'myFunction' with the array of parameters.
$funcPrototype( $function_call_spec["parameters"] ); 
```

但是，我想用明确的参数等正确声明“myFunction”：

```
function myFunction( $first_par, $second_par )
{

} 
```

接下来的问题是 - 有没有办法简单地通过循环参数数组来动态地将参数传递给函数？

为了澄清，我**不想**这样做：

```
$funcPrototype( $function_call_spec["parameters"]["first_par"],
                $function_call_spec["parameters"]["second_par"]  ); 
```

因为这需要我的代码静态地了解有关 myFunction 的详细信息，这与整个想法背道而驰。

相反，我想以某种方式这样做：

```
// Special magic PHP function which can be used for invoking functions dynamically
InvokeFunction( $funcPrototype, $function_call_spec["parameters"] ); 
```

然后导致调用 myFunction 并将数组中的所有参数传递给原型中的每个单独的参数变量。

欢迎任何意见。

问候。

/R

PS：这篇文章中的所有代码都没有经过拼写等测试。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-11T11:49:10.283

您应该使用[`call_user_func_array`](http://php.net/call_user_func_array)which 可以调用任何函数或方法并从数组中获取参数。

或者，您可以使用[`ReflectionFunction::invokeArgs`](http://php.net/manual/en/language.oop5.reflection.php#language.oop5.reflection.reflectionfunction)，但没有任何好处，`call_user_func_array`除非您已经将此类用于其他用途（例如检查您调用的函数是否接受适当数量和类型的参数）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-11T11:48:10.723

```
call_user_func_array($funcPrototype, $function_call_spec["parameters"]); 
```

您可能想要创建一个包装器，根据您的喜好命名函数，例如：

```
function InvokeFunction($function, $args = array()) {
    return call_user_func_array($function, (array)$args);
} 
```

使用此函数，您可以通过 3 种不同的方式调用它：

```
$return = InvokeFunction('doStuff');
$return = InvokeFunction('doStuff', $single_arg);
$return = InvokeFunction('doStuff', $multiple_args); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-11T12:53:21.433

`call_user_func_array()`如果您不需要执行合同，是最好的选择，否则使用`ReflectionFunction`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-29T19:00:12.170

[http://us2.php.net/create_function](http://us2.php.net/create_function)

当您使用 create_function() 时，直到运行时才会评估您的参数。挺甜的。******