# StackOverflow 问答 000729000-000729999

# c# - 如何确定 XML 格式是否正确？

> ID：729001
> 
> 赞同：9
> 
> 时间：2009-04-08T08:15:36.567
> 
> 标签：c#, xml

我在一个字符串中有一个大的 xml 文档。确定 xml 格式是否正确的最佳方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-08T08:33:26.633

就像是：

```
 static void Main() {
        Test("<abc><def/></abc>");
        Test("<abc><def/><abc>");
    }
    static void Test(string xml) {
        using (XmlReader xr = XmlReader.Create(
                new StringReader(xml))) {
            try {
                while (xr.Read()) { }
                Console.WriteLine("Pass");
            } catch (Exception ex) {
                Console.WriteLine("Fail: " + ex.Message);
            }
        }
    } 
```

如果您需要检查 xsd，请使用`XmlReaderSettings`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-08T08:18:21.240

只需通过解析器运行它。这将执行适当的检查（是否解析正常）。

如果它是一个大文档（如所示），那么基于事件的解析器（例如 SAX）将是合适的，因为它不会将文档存储在内存中。

使用 XML 实用程序来检查这类东西通常很有用。我使用[XMLStarlet](http://xmlstar.sourceforge.net/)，它是一组用于 XML 检查/操作的命令行工具。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T08:19:24.997

XmlReader 似乎是一个不错的选择，因为它应该流式传输数据（而不是一次性加载整个 xml）

[http://msdn.microsoft.com/en-us/library/9d83k261.aspx](http://msdn.microsoft.com/en-us/library/9d83k261.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T08:20:05.167

尝试将[XmlReader](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.aspx)与设置了[ConformanceLevel](http://msdn.microsoft.com/en-us/library/system.xml.xmlreadersettings.conformancelevel.aspx) .Document的[XmlReaderSettings一起使用。](http://msdn.microsoft.com/en-us/library/system.xml.xmlreadersettings.aspx)

# linq - 如何使用 LINQ 从数据库中仅查询单个项目？

> ID：729005
> 
> 赞同：5
> 
> 时间：2009-04-08T08:17:39.777
> 
> 标签：linq

我想获得一个只返回一个项目而不是它们的集合的 LINQ-to-SQL 查询？

例如，我有一个具有特定名称的产品列表。数据库中没有重复名称的产品，因此我希望能够仅查询并返回该产品的该实例。

```
Products product = from p in _productContext.Products 
                   where p.name.Equals("BrownShoes") 
                   select p; 
```

我该怎么做这样的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-08T08:22:20.310

使用[`Single`](http://msdn.microsoft.com/en-us/library/system.linq.queryable.single.aspx)：

```
Product product = _productContext.Products
                                 .Single(p => p.Name == "BrownShoes"); 
```

或者

```
Product product = _productContext.Products
                                 .Where(p => p.Name == "BrownShoes")
                                 .Single(); 
```

Single 没有查询表达式语法，因此您必须将其称为普通扩展方法。此时，您的查询更简单，完全用点表示法编写，因此是上面的形式。你*可以*把它写成：

```
Product product = (from p in _productContext.Products 
                   where p => p.Name == "BrownShoes"
                   select p).Single(); 
```

但这有更多的绒毛。如果结果中不完全是单个元素，则会引发异常。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-08T08:27:24.417

我建议使用`IQueryable.SingleOrDefault()`. `IQueryable.SingleOrDefault()`如果记录多于一条，`IQueryable.Single()`则会抛出异常，但`IQueryable.Single()`如果记录**少于**一条，也会抛出异常。这意味着如果您正在搜索单个记录并且无论出于何种原因它不存在，您都必须处理异常。

IQueryable.SingleOrDefault() 更好，因为您只需检查 null：

```
var employee = (from e in context.Employees
                where e.ID == employeeID
                select e).SingleOrDefault();

if (employee == null)
{
    // Cope with employee not found
}

// Do stuff with employee 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-08T08:22:02.980

您需要使用`.Single()`或`.SingleOrDefault()`：

```
Products product = (from p in _productContext.Products where p.name.Equals("BrownShoes") select p).Single(); 
```

`Single()`如果那里不完全是 1 个产品，将引发异常，如果`SingleOrDefault()`不存在，将返回 null，如果有多个，则引发异常。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-08T08:23:01.247

```
Products product = (from p in _productContext.Products 
                    where p.name.Equals("BrownShoes") 
                    select p).FirstOrDefault(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T08:22:12.543

如果你确定你会找到一个产品。如果没有找到产品，将抛出异常：

```
Products product = _productContext.Products
                       .Single(p => p.name.Equals("BrownShoes")); 
```

或者，如果没有找到产品，产品将为空：

```
Products product = _productContext.Products
                       .SingleOrDefault(p => p.name.Equals("BrownShoes")); 
```

# vb.net - How to refer to a control that exists within an Ajax Tab?

> ID：729006
> 
> 赞同：1
> 
> 时间：2009-04-08T08:18:05.953
> 
> 标签：vb.net, asp.net-ajax, formatting

I have a problem with using a script that adds a NiceEdit toolbar to a text area when that text area is within an Ajax tab.

I want to know if I should refer to it in a different way than just the ID.

I mean the ID of that text area, I tried to take the text area outside the Tab Container, it works, but when I return it, it simply doesn't.

```
<%@ Page Language="VB"  ValidateRequest ="false" AutoEventWireup="false" CodeFile="tabbedNiceEditt.aspx.vb" Inherits="Client_tabbedNiceEditt" %>
<script src="../nicEdit/nicEdit.js" type="text/javascript"></script>

<script type="text/javascript">
bkLib.onDomLoaded(function() {
new nicEditor({buttonList : ['fontSize','fontFamily','fontFormat','bold','italic','underline','strikethrough','forecolor','bgcolor','removeformat'], iconsPath : '../nicEdit/nicEditorIcons.gif'}).panelInstance('txt');
});
</script>
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="cc1" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Untitled Page</title>
    <script type="text/javascript">

      function pageLoad() {
      }

    </script>
</head>
<body>
    <form id="form1" runat="server">

    <div>

        <asp:ScriptManager ID="ScriptManager1" runat="server" />
        <cc1:TabContainer ID="TabContainer1" runat="server">
        <cc1:TabPanel ID= "first" runat ="server" >
        <ContentTemplate>
        <b>Stuff Goes HERE</b>
        <br />
        <asp:TextBox ID = "txt" name = "txt" runat ="server" TextMode ="MultiLine" Height = "256" Width = "256">
        </asp:TextBox>
        <br />
        <br />
        <asp:Button id  = "btn" runat ="server" Text = "click" />
        </ContentTemplate>
        </cc1:TabPanel>
        <cc1:TabPanel ID = "second" runat ="server" >
        <ContentTemplate>
        <b>More Stuff for second tab</b>
        </ContentTemplate>
        </cc1:TabPanel>
        </cc1:TabContainer>
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T08:22:42.370

`txt` is the **server** ID of your control, you have to use the **client** ID :

```
....panelInstance('<%= txt.ClientID %>'); 
```

基本上，客户端 ID 派生自服务器 ID 和您的控件所在的命名容器，以避免任何命名冲突。当您的文本区域不在 Ajax 选项卡中时，客户端 ID 与服务器 ID 相同。当您将文本区域放在 Ajax 选项卡中时，它的客户端 ID 是不同的（您可以通过查看浏览器中的页面源来检查）。

* * *

编辑：

从曼

> 我在浏览器中查看了该页面，检查了页面源中的 ID，它是“TabContainer1$first$txt”，使用它而不是“txt”，脚本如下：panelInstance('<%= txt.TabContainer1$first$ txt %> 我收到一个错误：BC30456：“TabContainer1”不是“System.Web.UI.WebControls.TextBox”的成员。

这不是我的意思：您必须输入`panelInstance('<%= txt.ClientID %>')`源代码，**asp.net 会将其转换**为`panelInstance('TabContainer1$first$txt')`.

我告诉你在 Web 浏览器中检查页面源只是为了看到客户端 ID 不再是“txt”，而是由服务器 ID 和命名容器构造而成。

# wpf - 您将 XAML 放入样式的策略是什么？

> ID：729026
> 
> 赞同：2
> 
> 时间：2009-04-08T08:25:14.377
> 
> 标签：wpf, xaml, styling

当我创建 WPF 应用程序时，我的 XAML 很快就开始膨胀。

然后我**以 HTML/CSS 的方式处理 XAML/样式问题**，寻找重复的代码并将其打包到我放入 Window.Resources 部分的样式中。

这是其他人正在这样做的方式，还是现在在 XAML 中有更好的方式？似乎下面的两个块仅在两个小词上有所不同，**似乎我可以将它放在某种功能性用户控件中**（这是左侧菜单），这样当我的菜单中有 25 个元素时，我可以只有 25 行与名称相同，可能还有 Click 目标。

**或者，当我将其移至 MVVM 时，此问题将通过 DataBinding 自行解决**（它目前只是一个硬编码原型），因此我可以将菜单项的名称保存在我的 ViewModel 的集合中，然后创建在 ItemsControl 中动态菜单？

或者，臃肿的 XAML 文件只是WPF 应用程序**的现实吗？**

*创建 WPF 应用程序时，您有哪些 XAML 样式策略？*

**Window.Resources（文件顶部）：**

```
<Window.Resources>
    <Style x:Key="Link" TargetType="Button">
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Foreground" Value="#555"/>
        <Setter Property="Background" Value="Transparent"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <TextBlock TextDecorations="Underline" 
                Text="{TemplateBinding Content}"
                Background="{TemplateBinding Background}"/>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Foreground" Value="Red"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</Window.Resources> 
```

**当前 XAML：**

```
<Expander HorizontalAlignment="Left" Header="File" VerticalAlignment="Top" ExpandDirection="Down" Width="200" Padding="2">
    <Expander.Background>
        <LinearGradientBrush>
            <GradientStop Color="#bbb" Offset="0"/>
            <GradientStop Color="#ccc" Offset="1"/>
        </LinearGradientBrush>
    </Expander.Background>
    <Border CornerRadius="5">
        <Border.Background>
            <LinearGradientBrush>
                <GradientStop Color="#ccc" Offset="0"/>
                <GradientStop Color="#bbb" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Top">
            <Button Click="buttonClose_Click" 
                Style="{StaticResource Link}" 
                Margin="10 3 3 3"
                Content="Close">
            </Button>
        </StackPanel>
    </Border>
</Expander>

<Expander HorizontalAlignment="Left" Header="Customers" VerticalAlignment="Top" ExpandDirection="Down" Width="200" Padding="2">
    <Expander.Background>
        <LinearGradientBrush>
            <GradientStop Color="#bbb" Offset="0"/>
            <GradientStop Color="#ccc" Offset="1"/>
        </LinearGradientBrush>
    </Expander.Background>
    <Border CornerRadius="5">
        <Border.Background>
            <LinearGradientBrush>
                <GradientStop Color="#ccc" Offset="0"/>
                <GradientStop Color="#bbb" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>
        <StackPanel HorizontalAlignment="Left" VerticalAlignment="Top">
            <Button Click="btnAppPage_Click" 
                Tag="CustomerAdd"
                Style="{StaticResource Link}" 
                Margin="10 3 3 3"
                Content="Create Customer"/>
        </StackPanel>
    </Border>
</Expander> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T08:42:36.440

简单：识别重复并将其移动到控件中。控件可以具有在运行时组成所需变化所需的任何属性。并且可以通过作为控件来重新模板化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T17:20:34.493

此外，您可以识别重复并将它们移动到资源中。一个资源可以轻松引用另一个资源。

# visual-studio - Visual Studio 中项目之间的共享文件

> ID：729027
> 
> 赞同：2
> 
> 时间：2009-04-08T08:26:14.997
> 
> 标签：visual-studio, projects-and-solutions

我们有一个基于 Web 的系统，具有三个不同的前端。我们最近将这些项目分为三个项目，都在一个解决方案中。
我们在解决方案中也有一个共同的项目，用于帮助者等。
我正在寻找一种将共享的 css、js 和图像资源放在公共项目中的方法，以便所有三个前端项目都可以轻松访问。
我知道“添加为链接”，它适用于中央 css 等资源。但是，我们有一个包含一大堆图像、图标等的目录。我希望这个目录在所有项目的 /Content/ 下都是可见的，并且如果我在公共项目中添加新文件会得到更新。

在 unix/linux 中，我可以通过 synlink 轻松解决这个问题。我可以在 MS 环境中做类似的解决方案，还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T09:00:26.740

我认为**Junctions**可能是您正在寻找的东西，请参阅Scott Hanselman 的[这篇文章](http://www.hanselman.com/blog/HowDoYouOrganizeYourCode.aspx)了解更多信息。Uou 可以从[SysInternals下载](http://www.sysinternals.com)**Junctions**工具。

连接点是 NTFS 重解析点，也称为符号链接，类似于快捷方式，但功能更强大。

# apache-flex - Flex 中是否有轻量级数据网格替代方案？

> ID：729034
> 
> 赞同：1
> 
> 时间：2009-04-08T08:28:51.887
> 
> 标签：apache-flex, performance, datagrid

在 Flex 中显示数据表的最高效方式是什么？

是否有原生 Flex Datagrid 组件的替代品？以渲染速度着称的替代品？

还有其他显示表格的方法吗？

我有一个大约 70 行和 7 列简单文本数据的数据网格。这是当前在内存中创建和加载的。这正在快速刷新（大约 800 毫秒），并且在渲染表格时其他动画略有滞后......所以我试图减少这个渲染时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T08:47:47.503

据我所知，您已经获得了 DataGrid、AdvancedDataGrid 和 TileList。但我从来没有遇到过任何这样的速度问题。但是，根据您选择在单元格中显示的内容，它们可能会变慢，特别是如果您想使用胖图像（在这种情况下，您的选择是以较低的分辨率创建副本）。

所有控件都非常擅长加载和显示内容，因为它是基于滚动到视图中所需的。

您的问题案例有多慢？你在细胞里放了什么（和多少）？你确定它是 Flex 的吗，或者它可能在你的数据提供者中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-29T19:48:38.057

你需要一个数据网格吗？如果您不需要可调整大小的列，您还可以使用 List 和自定义 itemrenderer。假设您有 10 行和 4 列。一个数据网格将创建 40 个项目，而一个列表将创建 10 个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-31T21:18:24.870

您可以在这里尝试 ElfGrid：[http ://www.elfgrid.com/](http://www.elfgrid.com/)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-07-09T06:54:25.933

您可以使用 <mx:Grid> 组件。它比数据网格略轻。

# regex - 在 Perl 中使用正则表达式匹配元素

> ID：729036
> 
> 赞同：1
> 
> 时间：2009-04-08T08:29:55.050
> 
> 标签：regex, perl

我有一个包含正则表达式的哈希：要在其中捕获的匹配数和变量及其匹配位置。例如：

```
my %hash = (
    reg_ex => 'Variable1:\s+(.*?)\s+\n\s+Variable2:\s+(.*?)\s+\n',
    count => 2,
    Variable1 => 1,
    Variable2  => 2,
); 
```

我将在代码的其他部分中使用这个正则表达式，我将在这里给出说`$to_be_matched_variable =~ /$hash{reg_ex}/`，我们在`$1`, `$2`, ...中获得所需的匹配项

我需要使用key的值`Variable1`，它表示在我们通常使用的地方要使用的匹配数`$1`。

我试着给`$.$hash{Variable1}`和`$,$hash{Variable1}`。我无法找到如何构建相当于`$1`, `$2`...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T08:40:05.823

尝试：

```
(my @ArrayOfMatches) = $to_be_matched_variable =~ /$hash{reg_ex}/;

my $Variable1 = $ArrayOfMatches[$hash{Variable1}]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T08:59:05.527

由于您已经在使用哈希，您不妨使用`%+`将名称映射到匹配项的内置函数。因此，如果您将正则表达式更改为命名匹配，您可以轻松地使用它`%+`来检索匹配的部分。

```
$reg_ex = 'Variable1:\s+(?<foo>.*?)\s+\n\s+Variable2:\s+(?<bar>.*?)\s+\n'; 
```

成功匹配后，`%+`应该有键`foo`和`bar`值将与匹配的内容相对应。

因此，您的原始哈希可以更改为以下内容：

```
my %hash = (
    reg_ex => 'Variable1:\s+(?<foo>.*?)\s+\n\s+Variable2:\s+(?<bar>.*?)\s+\n',
    groups => [ 'foo', 'bar' ],
); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T08:42:43.147

($1, $2, $3, ...., $9)[$hash{Variable1}]

# c# - 覆盖 .NET 通用列表 .包含（MyTypeInstance）？

> ID：729037
> 
> 赞同：8
> 
> 时间：2009-04-08T08:30:07.233
> 
> 标签：c#, .net, list

是否有可能，如果可以，我该如何覆盖`Contains`原本正常的方法，`List<T>`我`T`自己的自定义类型在哪里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T08:37:06.047

`List<T>`用来`EqualityComparer<T>.Default`做比较；这首先检查您的对象是否实现`IEquatable<T>`；否则就是使用`object.Equals`.

所以; 最简单的做法是覆盖`Equals`（始终更新`GetHashCode`以匹配 中的逻辑`Equals`）。或者，改用 LINQ：

```
bool hasValue = list.Any(x => x.Foo == someValue); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-08T08:35:11.997

要制作您自己的 Contains 实现，您可以创建一个实现 IList 接口的类。这样你的类就会看起来像一个 IList。你可以在内部有一个真正的 List 来做标准的东西。

```
class MyTypeList : IList<MyType>
{
    private List<MyType> internalList = new ...;

    public bool Contains(MyType instance)
    {

    }

    ....
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T08:32:50.113

您需要在您的类中覆盖`Equals`和( )。`GetHashCode``MyType`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T08:38:33.563

根据您在覆盖中的特定需求，您可以使用 Linq 表达式来执行此操作：

```
list.Any(x => x.Name.Equals("asdas", .....)) // whatever comparison you need 
```

然后，为了方便起见，您可以将其包装在扩展方法中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T08:33:01.440

如果您实现自定义类型的等号，则 List 的 contains 功能将起作用

# php - 保护没有标题的网页

> ID：729041
> 
> 赞同：3
> 
> 时间：2009-04-08T08:30:54.173
> 
> 标签：php, security, http-headers

我刚刚[在 tdwtf.com 上阅读了这篇文章](http://thedailywtf.com/Articles/WellIntentioned-Destruction.aspx)。通常，它描述了一个归档机器人破坏事物，因为它忽略了标题。然后我意识到我不知道如何在没有标题的页面中进行安全保护。因此我的问题是：

**除了使用标头之外，我还可以采取哪些安全措施？**

我主要是用 php 开发，所以我对 header("Location:") 函数很熟悉。但是外面还有什么？

理想情况下，我正在寻找替换的逻辑

```
if (!$something_important) header("Location: somehereharmless.php"); 
```

其他（更）安全的东西？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T08:36:05.177

这个效果很好

```
if (!$something_important) {
  header("Location: somehereharmless.php");
  exit();
} 
```

即使它是机器人，所以它不尊重位置，你会调用一个退出，所以执行流程无论如何都会停止，所以没有害处

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T08:41:25.523

header：位置很好，只要你在最后包含一个出口。您可能还想包含链接或其他内容。

我通常使用这样的东西：

```
<?php
function redirect($url)
{
    header('Location: ' . $url);
    exit('<a href="' . $url . '">Redirecting you to: ' . $url . '</a>');
}

redirect('somepage.php');
?> 
```

这样人们就不能绕过重定向，并且知道他们应该被重定向。

* * *

[编辑]

另外，在删除东西时**总是**使用。`POST`制造假货非常容易`GET`（例如`<img src="http://www.example.org/action.php?do=SetAsAdmin&userid=MyUserId" />`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T08:35:03.230

确保你的所有获取都是幂等的

幂等意味着多次执行相同的请求与执行一次具有相同的效果。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T08:52:19.333

我想说，如果你有一个 PHP 脚本执行一些只有登录用户才能执行的操作，你**必须**在同一个脚本中检查是否登录，这样你就可以一看就知道代码是安全的。我的规则是保护安全代码只有两种有效模式：

```
if (user_is_authorized()) {
    // restricted code here
} 
```

或 Alekc 的

```
if (!user_is_authorized()) {
    // send headers or whatever if you want
    exit();
}
// restricted code here 
```

老实说，当我读到那篇文章时，我相当震惊……或者至少很失望……我不明白为什么有人会得出这样的结论，即网站可以使用 HTTP 标头进行保护。标头只不过是您的服务器发出的一些文本。这是客户可以随意遵循或忽略的指令（至少，出于安全目的，您必须以这种方式考虑它）。就我而言，传出（响应）HTTP 标头对于安全性几乎没有用处。（这不包括诸如 HTTP 身份验证之类的事情，您在其中发送一个标头并得到一个作为响应......但在这种情况下，您的安全性基于该回复标头的内容，而不是您发送的标头。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T08:43:57.607

您提供的链接中报告的事件的原因`exit;`是`header();`. 如果脚本停止，机器人不会造成任何伤害。-

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T09:46:03.073

```
if (!$something_important) {
  header("Location: somehereharmless.php");
  //close all your db connections and other stuff you need to end..parhaps calling a function?
  die("If the redirect doesnt start in 3 seconds, please <a href=\"somehereharmless.php\">click here</a>");
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-08T15:28:10.630

你的解决方案是

```
<?php
die($errormessage); 
```

Die 只会停止你的脚本，而不是开始，不要收集任何你不应该收集的数据。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T08:45:28.743

除了 Alekc 的回答。如果您有许多 header("Location:") 语句，并且此人符合所有条件。最后一个会开火。

```
if($foo && $bar)
{
    header("Location: somehereharmless.php");
}

if($foo && $baz)
{
    header("Location: someotherplace.php");
} 
```

因此，如果该用户设置了所有 3 个变量，他将被重定向到 someotherplace.php。除非你有一个 exit(); 或模具（）；在标头（）之后；

# wpf - ListView DisplayMemberBinding 与 DataTemplate

> ID：729044
> 
> 赞同：0
> 
> 时间：2009-04-08T08:32:59.863
> 
> 标签：wpf, listview

我可以使用 DisplayMemberBinding 并且仍然能够为该列的 Datatype 定义 DataTemplate。一旦我为一列设置了 DisplayMemberBinding，那一列就可以显示简单的文本。但我不想要文本:) 但是如果我使用 Celltemplate，该列的所有单元格都使用相同的 DataTemplate。但我不希望每个单元格都使用相同的模板。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T08:38:55.467

如果要根据项目动态选择模板，则需要使用[`DataTemplateSelector`](http://msdn.microsoft.com/en-us/library/system.windows.controls.gridviewcolumn.celltemplateselector.aspx)：

```
<GridViewColumn CellTemplateSelector="{StaticResource MyCellTemplateSelector"/> 
```

# xquery - XQuery：如何连接两个构造函数作为回报？

> ID：729046
> 
> 赞同：2
> 
> 时间：2009-04-08T08:33:21.750
> 
> 标签：xquery

我有一个包含构造函数的函数：

```
declare function local:Construct ($id)
{
  <tag id="{$id}"/>
} 
```

我使用该函数来返回“FLWOR”：

```
for $val in ...
...
return local:Construct(data($val/id)) 
```

这行得通。

现在我想像这样连接两个构造

```
for $val in ...
...
return local:Construct(data($val/id1)) + local:Construct(data($val/id2)) 
```

加号当然是错误的。我应该改用什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T09:44:58.757

我假设您想为每个*$val*返回两个节点，在这种情况下您想使用**,**运算符，如下所示：

```
for $val in ...
...
return (local:Construct(data($val/id1)), local:Construct(data($val/id2))) 
```

额外的括号是必需的，否则您将尝试连接`local:Construct(data($val/id2))`到 FLWOR 的结果，这将导致“未定义变量”错误。

# c# - 对 ValueTypes、Strings 和 Nullable 的 ValueTypes 的通用约束

> ID：729061
> 
> 赞同：6
> 
> 时间：2009-04-08T08:36:47.047
> 
> 标签：c#, generics, lambda, constraints

我正在尝试向通用方法添加一个约束，以便它检查 ValueTypes、Strings 或 Nullable 值类型。

问题是：

*   值类型是struts
*   字符串是不可变的引用类型
*   nullable 是值类型，但不会在“where S : struct”类型约束中被接受。

那么有人知道我是否可以在通用约束中接受这些类型并且只接受这些类型？

问题是我试图接受一个`Expression<Func<T, S>`参数，该参数将代表给定对象的这些类型的属性。

该功能将类似于以下内容（注意代码没有任何意义，只是快速了解我正在寻找的东西）：

```
public class Person
{
   public string Name {get; set;}
   public DateTime? DOB {get; set;}
   public int NumberOfChildren {get; set;}
   public Car CurrentCar {get; set;}
}

---

internal void MyGenericMethod<T, S>(T myObject, Expression<Func<T, S> property){...}

Person myPerson = new Person();
MyGenericMethod(myPerson, p => p.Name); //S would be a string
MyGenericMethod(myPerson, p => p.DOB); //S would be a DateTime? 
MyGenericMethod(myPerson, p => p.NumberOfChildren); //S would be a struct 
```

上面的三个调用都应该被接受，但不是下面的：

```
MyGenericMethod(myPerson, p => p.CurrentCar); //S would be a class and shouldn't compile 
```

提前致谢

更新：感谢安东和马克。MyGenericMethod 有 4 个不同的签名接受额外的参数，这就是为什么我不喜欢为现有的 4 个创建 3 个不同的（结构、可空、字符串）的想法......这将是一场噩梦！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T08:43:56.687

我唯一能想到的是一组三个功能（没有`Expression<>`东西）：

```
MyGenericFunction<T>(T t)
    where T : struct

MyGenericFunction<T>(T? t)
    where T : struct

MyGenericFunction(string s) 
```

**更新**鉴于方法有各种重载，我可以建议：

```
class Holder
{
    private object value;

    public Holder(object value)
    {
        this.value = value;
    }

    public static implicit operator Holder(DateTime dt)
    {
        return new Holder(dt);
    }

    public static implicit operator Holder(string s)
    {
        return new Holder(s);
    }

    // Implicit conversion operators from primitive types
} 
```

因此你的方法变成了

```
MyGenericMethod(Holder h); 
```

仍然非常麻烦，但它可能会奏效。

# .net - OCR .NET 推荐

> ID：729067
> 
> 赞同：0
> 
> 时间：2009-04-08T08:39:52.030
> 
> 标签：.net, ocr

嗨，我刚刚在 .NET 中尝试了一个用于 OCR 的组件，结果非常不准确。以前有没有人走这条路？您能否为我推荐一条路径，以节省我评估许多产生不满意结果的组件的时间。

非常感谢任何建议。我不介意购买或自己编码。任何效果最好且具有成本效益的方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T08:45:45.357

我们在项目中使用了[Abby Fine Reader SDK](http://new.abbyy.com/finereader_engine/)。它带有一个 COM 对象，您可以在 .Net 应用程序中使用它。引擎的成功已经足够好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T08:52:54.887

ABBYY 的组件非常昂贵。我评估了 Pegasus ImagXpress 和 Atalasoft DotImage，虽然我发现 DotImage 在整页 OCR 上更准确，但 ImagXpress 可以更好地阅读某些难以识别的小部分文本。我建议您尝试两者的演示版本，看看最适合您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-06T01:00:49.307

有关替代引擎的信息，请参阅[https://stackoverflow.com/a/18070183/852208 。](https://stackoverflow.com/a/18070183/852208)

您的准确性问题可能与图书馆本身有关。但是，它更有可能是您正在使用的图像源。考虑以下[提示](http://www.library.illinois.edu/dcc/bestpractices/chapter_05_ocr.html#factorsoutput)：

> 文本考虑
> 
> *   不应在某些材料上尝试标准 OCR。例如，目前不应该
>     在 1850 年之前发布的大多数文本上尝试使用默认设置的 OCR。对于某些语言（例如
>     德语），截止日期可能更晚。在尝试
>     通过 OCR 为这些材料创建转录之前，需要进行详细分析并经常进行实验来判断自定义 OCR 和键盘输入选项
>     之间的权衡。
>     
> *   必须以 RGB 模式扫描较旧和变色的文档，以捕获所有图像数据，并最大限度地提高 OCR 准确性。
> *   低对比度文档可能导致 OCR 不佳。
> *   打字稿的 OCR 比印刷字体差；字体和大小的不一致使用会降低 OCR 的准确性。
> *   原件中小于 6 磅的字体大小会限制 OCR，但将扫描图像的分辨率提高到 600 dpi 并使用灰度可能会改善 OCR 输出。
> *   无法以任何程度的准确度识别手写文件。
> 
> 影响 OCR 准确性的扫描注意事项包括：
> 
> *   OCR 精度的推荐最佳扫描分辨率为 300 dpi。更高的分辨率不一定会带来更好的准确性，并且会减慢 OCR 处理时间。低于 300 dpi 的分辨率可能会影响 OCR 结果的质量和准确性。
> *   亮度设置过高或过低都可能对 OCR 准确性产生不利影响。在大多数情况下，50% 的中等亮度值将是合适的。
> *   初始扫描的直线度会影响 OCR 质量；弯曲的文本行会产生较差的结果。
> *   必须以 RGB 模式扫描较旧和变色的文档，以捕获所有图像数据，并最大限度地提高 OCR 准确性。
> *   图像增强功能（例如对比度调整和模糊蒙版）并未显示可显着提高 OCR 的准确性。

# php - php-cli和mysql的问题，为什么mysql_pconnect()不可用？

> ID：729070
> 
> 赞同：1
> 
> 时间：2009-04-08T08:41:09.143
> 
> 标签：php

我已经安装了各种 PHP 包，以便能够将 PHP 与 Apache 一起使用，也可以在命令行中使用。我需要能够连接到 MySQL 数据库。很简单吧？这就是我的想法，但是使用 php-cli 我收到以下错误：

```
Fatal error: Call to undefined function mysql_pconnect() 
```

我尝试从头开始删除所有依赖的包和配置，如下所示：

```
sudo apt-get --purge remove php5 libapache2-mod-php5 php5-cli php5-mysql 
```

然后我运行以下命令来安装软件包：

```
sudo apt-get install php5 libapache2-mod-php5 php5-cli php5-mysql 
```

然后我发现了 cli 使用的 php.ini 是这样的：

```
php -r "phpinfo();" | grep php.ini 
```

这给了我这个：

```
Configuration File (php.ini) Path => /etc/php5/cli/php.ini 
```

然后我在扩展部分取消了'mysql.so'的注释，但是当我这样做并运行以下命令时，它说：

```
PHP Warning:  Module 'mysql' already loaded in Unknown on line 0 
```

因此，出于某种原因，他认为它已经加载，但是无论是否启用了“mysql.so”，php cli 都找不到“mysql_pconnect”函数。

我知道有一个部分可以启用持久连接，默认情况下它是打开的，标准功能 'mysql_connect' 也不可用。

我错过了什么？谢谢！

更新：

正如 Bart S. 'php -r "phpinfo();" 所建议的那样 | grep mysql':

> ```
> MYSQL_SOCKET => /var/run/mysqld/mysqld.sock
> MYSQL_INCLUDE => -I/usr/include/mysql
> MYSQL_LIBS => -L/usr/lib -lmysqlclient
> mysql.allow_persistent => On => On
> ... and more 
> ```

来自贾卡·扬查尔。'php -v' 显示：

> PHP 5.1.2 (cli)（构建时间：2009 年 2 月 11 日 19:55:22）

并从 php 交互模式 'php -r 'var_dump(extension_loaded("mysql"));' 什么都不给！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T08:50:59.697

```
php -i | grep mysql 
```

第一行应包含：

```
Configure Command =>  '../configure' ... '--with-mysql=shared,/usr' 
```

还要检查

```
grep extension_dir /etc/php5/cli/php.ini 
```

应该是这样的：`extension_dir = /usr/lib/php5/extensions` 然后检查权限`/usr/lib/php5/extensions/mysql.so`以及是否正确链接：

```
ldd  /usr/lib/php5/extensions/mysql.so 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T10:25:03.380

您不能在 CLI 模式下使用 pconnect。您没有像 Web 服务器这样可以保持打开连接的持久进程。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-08T09:04:43.047

cli模式下的pconnect有意义吗？也许这是“按预期工作”。

> 注意：请注意，这些类型的链接仅在您使用 PHP 的模块版本时才有效。有关详细信息，请参阅持久数据库连接部分。

[http://de2.php.net/mysql_pconnect](http://de2.php.net/mysql_pconnect)

# silverlight - 在 Silverlight DataBinding 期间自动创建子对象？

> ID：729080
> 
> 赞同：0
> 
> 时间：2009-04-08T08:42:55.237
> 
> 标签：silverlight, data-binding, silverlight-3.0

我有一个 Parent 类型的父对象，它当前有一个名为 Foo 的 Child 类型的 null 属性，并且该 Child 类有一个名为 Name 的字符串类型的属性。

如果用户为该 Name 属性键入文本框，那么我想在最终设置 Child 对象的 Name 属性之前自动创建 Child 的实例并将其设置为 Parent 的 Foo 属性。

如果我使用：

```
{Binding parent.foo.name, Mode=TwoWay} 
```

它不会创建 foo 并且基本上什么都不做。有没有什么方法可以实现我想要的，而无需预先创建所有可能的子对象，然后在未设置属性的情况下删除它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T15:01:17.597

没有自动的方法。您可以考虑使用类似 MV-VM 的模式并在 ViewModel 中处理此逻辑。您还可以使用 IValueConverter 获得创意，以便您的绑定可以在设置值时运行自定义代码。但是 WPF / Silverlight 绑定不会自动为您完成这项工作。

# iphone - iPhone - 为什么所有界面都有点下降

> ID：729081
> 
> 赞同：0
> 
> 时间：2009-04-08T08:43:33.457
> 
> 标签：iphone, cocoa-touch

我在我的 cocoa-touch 应用程序中更改了一些东西，所有界面都下降了大约 20 像素。在一个视图顶部有一个白色条（它没有背景颜色，尽管视图本身有一个）。在界面构建器中没有任何改变 - 一切看起来都应该看起来。

任何人都知道为什么会发生这种情况？在我的视图中手动更改项目的位置需要一段时间。

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T08:48:14.180

我打赌您更改了界面生成器中的模拟指标。

另请参阅：[iPhone NavigationController - 推送相同的视图，收到不同的布局](https://stackoverflow.com/questions/575794/iphone-navigationcontroller-same-view-pushed-different-layouts-received)

# mootools - Onload 将 div 不透明度设置为 50%

> ID：729083
> 
> 赞同：0
> 
> 时间：2009-04-08T08:43:49.010
> 
> 标签：mootools, mouseover, opacity, fade, onload

好的，所以我有一个运行 Joomla 的站点，它使用的是 mootools 1.11 框架。我已经使用 mootools 1.2 框架中的示例将它的工作版本拼凑在一起，但即使在兼容层的情况下也无法使两者共存，而不会破坏 Joomla 站点中的其他模块。

**问题** 我有几个带有“.box_panel”类的 div，我有它，以便它们在鼠标悬停时从 50% 不透明度变为鼠标离开时的 100% 不透明度。我遇到的问题是将它们设置为 50% onload 的代码是什么？

在 mootools 1.2 中，我使用了：

```
<body onload="$$('div.box_panel').fade(0.5);"> 
```

我用于鼠标悬停/鼠标离开效果的代码是：

```
window.addEvent('domready',function() { 
    //first, apply a class to each of your menu element
    //$$('.links') puts every element wearing the .links class into an array
    //$$('.links').each is to browse the array an apply a function to... each of them
    $$('.box_panel').each(function(el, i) {
        //there comes exactly your former fx statement except for
        var ExampleFx = new Fx.Style(el, 'opacity', { //the fact i apply the effect on el
            wait: false, //and wait: false which make the effect not waiting (very useful on the mouseout or mouseleave function...
            opacity: 0.5,
            duration: 500,
            transition: Fx.Transitions.Quart.easeInOut
        });
        //and there i apply (always on el) the effect on mouseenter (similar in this case but often better than mouseover)
        //and mouseleave (same for mouseenter but concerning mouesout)
        el.addEvent('mouseleave', function() { ExampleFx.start(1, 0.5); });
        el.addEvent('mouseenter', function() { ExampleFx.start(0.5, 1); });

    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T09:02:27.280

你不能只`ExampleFx.start(1, 0.5);`在最后一个括号之前（`$$('.box_panel')...`语句之后）添加吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T09:05:05.637

~~简单的：~~

```
$$('.box_panel').effect('不透明度', 0.5);
// 在你的 window.addEvent('domready', function() {

```

**编辑**：我在这里有点错误。姆拉登·米哈伊洛维奇的回答完全正确。另外，这里有一些链接供您使用：

*   [MooTools 1.11 文档](http://docs111.mootools.net/)
*   [MooTools 1.11 演示](http://demos111.mootools.net/)

# c - 将数组中的所有字符串向上移动（realloc 的问题）

> ID：729088
> 
> 赞同：0
> 
> 时间：2009-04-08T08:44:28.010
> 
> 标签：c

我正在尝试编写一个函数，将字符串数组中的所有元素向上移动一个。

```
void shift_frags(char **frags, int frag_len, int cur)
{
    int i;
    for(i = cur; i < frag_len-1; i++)
    {
        if(strlen(frags[i+1]) > strlen(frags[i]))
            frags[i] = realloc(frags[i], strlen(frags[i+1])*sizeof(char));
        strcpy(frags[i], frags[i+1]);
    }

    free(frags[frag_len-1]);
} 
```

这给了我错误：“realloc(): invalid next size: ...” 每个数组都被动态分配为从文件中读取的字符串的大小。我不应该能够动态分配新的数组大小，因为我的 frags 参数是一个指针数组吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T08:48:46.067

因为正如您所说的数组只是一个指针数组，您不需要执行任何重新分配。您只需要复制指针本身。只需简单调用 memmove 或数组部分中的类似内容即可。

近似于这个的东西。

```
void shift_frags(char **frags, int frag_len, int cur)
{
  free(frags[frag_len]);
  memmove(frags+cur+1, frags+cur, (frag_len-cur) * sizeof(char*));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T08:50:36.623

根本不需要`free()`/ `realloc()`。

您`char **frags`是指向指针列表的指针，因此您可以在不创建新字符串的情况下随意调整指针值。

只需确保从列表的远端开始，然后倒数，或使用`memmove()`：

```
void shift_frags(char **frags, int frag_len, int cur)
{
    int i;

    free(frags[frag_len]); /* because otherwise this is left dangling */

    for(i = frag_len; i > cur; i--)
    {
        frags[i] = frags[i - 1];
    }
} 
```

或者：

```
void shift_frags(char **frags, int frag_len, int cur)
{
    int n = frag_len - cur;
    frags += cur;
    free(frags[n]);
    memmove(frags + 1, frags, n * sizeof(*frags)); /* nb: memmove(dst, src, n) */
} 
```

注意：这里可能存在一个错误，这取决于您的 frag_len 值的语义，以及您是否知道该`frag`内存块已经足够大以容纳另一个指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T09:06:39.643

您的 realloc 可能会失败，因为您没有为字符串中的尾随 NUL ('\0') 字符保留一个字节——将 +1 添加到您的 realloc 大小：

```
 if(strlen(frags[i+1]) > strlen(frags[i]))
        frags[i] = realloc(frags[i], (strlen(frags[i+1]) + 1)*sizeof(char));
    strcpy(frags[i], frags[i+1]); 
```

将修复该错误。您遇到的具体错误可能是因为您的字符串之一的长度为 0，而 realloc(foo, 0) 只是在您的系统上为您提供了该错误，或​​者因为您在未分配的内存中写入尾随 '\0' 并且覆盖其他重要的东西，导致腐败。

不过，简单地重新排列指针（frags[i] = frags[i+1]，或使用 memmove()）会更容易、更快，并且不会浪费内存。

# c# - C#：如何在 ListView 中添加子项

> ID：729090
> 
> 赞同：27
> 
> 时间：2009-04-08T08:45:43.750
> 
> 标签：c#, .net, winforms, list, view

创建一个项目（在键下）很容易，但是如何添加子项目（值）？

```
listView1.Columns.Add("Key");
listView1.Columns.Add("Value");
listView1.Items.Add("sdasdasdasd");
//How to add "asdasdasd" under value? 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-08T08:48:41.603

您将子项打入一个数组并将该数组添加为列表项。

将值添加到数组的顺序决定了它们出现的列，因此将子项目标题视为 [0]、[1]、[2] 等。

这是一个代码示例：

```
//In this example an array of three items is added to a three column listview
string[] saLvwItem = new string[3];

foreach (string wholeitem in listofitems)
{
     saLvwItem[0] = "Status Message";
     saLvwItem[1] = wholeitem;
     saLvwItem[2] = DateTime.Now.ToString("dddd dd/MM/yyyy - HH:mm:ss");

     ListViewItem lvi = new ListViewItem(saLvwItem);

     lvwMyListView.Items.Add(lvi);
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-04-08T08:49:04.163

像这样：

```
ListViewItem lvi = new ListViewItem();
lvi.SubItems.Add("SubItem");
listView1.Items.Add(lvi); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-04-08T09:10:39.273

假设您有一个 List Collection，其中包含许多要在 ListView 中显示的项目，请看以下遍历 List Collection 的示例：

```
foreach (Inspection inspection in anInspector.getInspections())
  {
    ListViewItem item = new ListViewItem();
    item.Text=anInspector.getInspectorName().ToString();
    item.SubItems.Add(inspection.getInspectionDate().ToShortDateString());
    item.SubItems.Add(inspection.getHouse().getAddress().ToString());
    item.SubItems.Add(inspection.getHouse().getValue().ToString("C"));
    listView1.Items.Add(item);
  } 
```

该代码在 ListView 中产生以下输出（当然取决于您在 List 集合中有多少项目）：

基本上第一列是一个包含许多子项（其他列）的列表视图项。这可能看起来很奇怪，但 listview 非常灵活，你甚至可以用它构建一个类似 windows 的文件浏览器！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-01-06T14:41:56.647

我使用 ListViewItemsCollection 上的扩展方法对此进行了改进。在我看来，它使调用代码更简洁，也促进了更通用的重用。

```
internal static class ListViewItemCollectionExtender
{
    internal static void AddWithTextAndSubItems(
                                   this ListView.ListViewItemCollection col, 
                                   string text, params string[] subItems)
    {
        var item = new ListViewItem(text);
        foreach (var subItem in subItems)
        {
            item.SubItems.Add(subItem);
        }
        col.Add(item);
    }
} 
```

调用 AddWithTextAndSubItems 如下所示：

```
// can have many sub items as it's string array
myListViewControl.Items.AddWithTextAndSubItems("Text", "Sub Item 1", "Sub Item 2"); 
```

希望这可以帮助！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-05-21T19:53:28.813

我认为最快/最简洁的方法是：

对于每个类都有`string[] obj.ToListViewItem()`方法，然后执行以下操作：

```
foreach(var item in personList)
{
    listView1.Items.Add(new ListViewItem(item.ToListViewItem()));
} 
```

这是一个示例定义

```
public class Person
{
    public string Name { get; set; }
    public string Address { get; set; }
    public DateTime DOB { get; set; }
    public uint ID { get; set; }

    public string[] ToListViewItem()
    {
        return new string[] {
            ID.ToString("000000"),
            Name,
            Address,
            DOB.ToShortDateString()
        };
    }
} 
```

作为额外的奖励，您可以使用`static`返回`ColumnHeader[]`列表的方法来设置列表视图列

```
listView1.Columns.AddRange(Person.ListViewHeaders()); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-08T08:48:32.527

```
ListViewItem item = new ListViewItem();
item.Text = "fdfdfd";
item.SubItems.Add ("melp");
listView.Items.Add(item); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-08T08:48:58.873

创建一个列表视图项

```
ListViewItem item1 = new ListViewItem("sdasdasdasd", 0)
item1.SubItems.Add("asdasdasd") 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-05-21T19:18:51.390

添加：

```
.SubItems.Add("asdasdasd"); 
```

到代码的最后一行，所以它最终看起来像这样。

```
listView1.Items.Add("sdasdasdasd").SubItems.Add("asdasdasd"); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-05-21T19:27:16.073

一般来说：

```
ListViewItem item = new ListViewItem("Column1Text")
   { Tag = optionalRefToSourceObject };

item.SubItems.Add("Column2Text");
item.SubItems.Add("Column3Text");
myListView.Items.Add(item); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-11-03T12:09:41.923

伟大的 ！！它对我帮助很大。我曾经使用 VB6 做同样的事情，但现在完全不同了。我们应该添加这个

```
listView1.View = System.Windows.Forms.View.Details;
listView1.GridLines = true; 
listView1.FullRowSelect = true; 
```

# iphone - 如何将 Core Animation 框架添加到我的 Xcode 项目中？

> ID：729094
> 
> 赞同：15
> 
> 时间：2009-04-08T08:47:55.880
> 
> 标签：iphone, core-animation

我只是找不到添加它的框架。有任何想法吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-04-08T08:56:04.737

添加 QuartzCore 框架。它包含 CoreAnimation。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-08T12:38:52.737

另外，请确保您执行

```
#import <QuartzCore/QuartzCore.h> 
```

在使用任何特定于核心动画的类等之前。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-08T08:56:29.277

您需要将`QuartzCore`框架添加到您的项目中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-07-05T18:56:30.480

1.  在项目导航器中单击您的项目。
2.  点击目标。
3.  单击“构建阶段”选项卡。
4.  展开“将二进制文件与库链接”。
5.  点击“+”添加。

# asp.net-mvc - 在 ASP.NET MVC 中使用 HTML 表单？

> ID：729095
> 
> 赞同：3
> 
> 时间：2009-04-08T08:47:57.580
> 
> 标签：asp.net-mvc

似乎我在这个主题上查找的所有内容自发布以来都发生了变化，或者彼此大不相同。

我只想在我的视图中创建一个简单的表单。

我应该使用 Html.BeginForm()/TextBox()/EndForm() 方法还是应该使用普通的 jane HTML 表单？哪个是首选？

这是我到目前为止所拥有的：

```
<%=Html.BeginForm("Create", "Product", FormMethod.Post); %>  
    <%=Html.TextBox("productTextBox", "Enter a shoe name"); %>  
    <input type="submit" name="createButton" value="Create Me!" />    
<%=Html.EndForm(); %> 
```

在 ASP.NET MVC 中创建带有按钮和文本框的简单表单并允许我将表单中的数据提交给 /Product/Create 操作的“正确”方法是什么？

然后我如何从该方法中访问表单数据？有些人似乎使用“FormCollection”，而其他人只是使用 Request.Form 方法。我应该使用哪种方式？

有人可以启发我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T16:51:08.230

表单助手是推荐的方式，因为它允许您提供控制器、操作和其他路由数据，并且 URL 是根据您的路由自动生成的（在 Global.asax 中）。优点是，如果您决定更改路线，则不必更新站点中的每个 URL。

我使用实际的“<form>”标签的唯一原因是如果我需要对无法从 Html.Form 获得的标记进行额外控制（我现在想不出一个例子）。即使您选择这样做，您也应该使用“Url.Action”帮助程序从路由数据中获取 URL。例如：

```
<form action="<%= Url.Action("Create") %>"> 
```

至于你的第二个问题，我建议使用 Model Binder。查看[ScottGu 的博客](http://weblogs.asp.net/scottgu/archive/2008/09/02/asp-net-mvc-preview-5-and-form-posting-scenarios.aspx)以了解这方面的一些详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T08:52:28.850

看看[链接](http://code-inside.de/blog/2009/04/02/howto-daten-vom-view-zum-controller-bermitteln-bindings-in-aspnet-mvc/)。这是德语文本，但代码应该是可以理解的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T08:53:46.677

你有没有看过这个：

[http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx](http://weblogs.asp.net/scottgu/archive/2009/03/10/free-asp-net-mvc-ebook-tutorial.aspx)

它来自马的嘴，并且与最终版本保持同步。

# macos - 从 windows 到 mac 的 C# 单声道

> ID：729106
> 
> 赞同：4
> 
> 时间：2009-04-08T08:50:20.027
> 
> 标签：macos, mono, porting

我想知道我不应该在代码中做什么会阻止我的 C# 应用程序在 mac 上运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T14:33:06.503

Mono 的[应用程序可移植性](http://mono-project.com/Guidelines:Application_Portability "应用程序可移植性")指南是一个很好的参考。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T08:54:37.393

一般来说，您不应该使用`Microsoft.*`命名空间中的任何内容，没有 PInvoke（`DllImport`在 C# 中）和 UI 也可能有问题。

有关 Mono 兼容性的更多信息包含在 Mono Guide [**Porting Winforms Applications**](http://www.mono-project.com/Guide:%5FPorting%5FWinforms%5FApplications)中。可以使用[迁移分析器](http://mono-project.com/MoMA)工具检查现有应用程序的兼容性。

更新：PInvoke 实际上在 Mono 中工作，但如果你想让它跨平台工作，你必须为每个平台提供具有相同接口的本机共享库（即 Win API 很可能*不起作用*）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-15T12:58:44.743

除了 divo 的建议之外，我还推荐[Mono Migration Analyzer (MoMA) 工具](http://mono-project.com/MoMA)：“Mono Migration Analyzer (MoMA) 工具可帮助您识别在将 .Net 应用程序移植到 Mono 时可能遇到的问题”

另外，我会关注[Miguel de Icaza 的博客](http://tirania.org/blog/)和[Mono Project 网站](http://mono-project.com/)。

在他本月为 Boston.NET 用户组所做的演讲中，他展示了一个 Visual Studio 插件的预览，该插件可以使用 VM 在 Mono 上启动您的应用程序！这使您可以在开发过程中测试兼容性。

我相信他们的目标是在 TechEd 2009 上发布它，因此请在下个月左右寻找更新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T08:56:58.417

至少，您会想尽量避免使用 Windows 窗体，因为它只是 Windows 原生 UI 之上的薄薄的一层。

~~Mono 在 WINE 的帮助下在某种程度上模拟了它，但我不相信这一点。~~ Mono 前一阵子就这样做了，但这项努力被放弃了。有关更多信息，请参阅[Mono 上的 WinForms 。](http://www.mono-project.com/WinForms)谢谢[jpobst](https://stackoverflow.com/users/16089/jpobst)。

尝试使用 GTK# 或 Qt#（虽然我不太确定后者是否真的存在）来支持跨平台。您也可以考虑将 Java 与 SWT 甚至 Swing 一起使用而不是 C#，但这可能不是您愿意考虑的选项。

使用与 P/Invoke 相关的任何东西可能也是一个坏主意，因为这会调用可能不可移植的本机代码（除非您自己编写它，否则您可以选择使其可移植）。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-04-08T08:56:10.837

我不确定单声道是否可行，但 WIN32 API 调用肯定不起作用；）

# silverlight - 如何捕捉用户在键盘上被击中的符号？

> ID：729110
> 
> 赞同：1
> 
> 时间：2009-04-08T08:51:16.777
> 
> 标签：silverlight

是的，许多控件都有 KeyUp/KeyDown 属性。但在他们的争论中，我只能赶上 Key 课程。不是真正的符号。例如，当用户键入“d”符号时，KeyDown 中的 Key.D。在键盘上保持在​​同一平面上的任何其他语言中的所有符号也将是 Key.D。

如何在 WPF 中获得 KeyPress 的模拟，它可以代表一个字符（符号）来捕获取决于本地语言的本机类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T09:07:27.690

在这里阅读：http:
[//msdn.microsoft.com/en-us/library/ms754010.aspx#text_inputReal](http://msdn.microsoft.com/en-us/library/ms754010.aspx#text_inputReal)
看来您需要做的是处理`TextInput`事件而不是`KeyUp/KeyDown`事件。这可能与处理而不是
相同的区别`WM_CHAR``WM_KEYDOWN/WM_KEYUP`

# shell - BASH 和 CSH 上的变量值不一致

> ID：729116
> 
> 赞同：2
> 
> 时间：2009-04-08T08:52:21.410
> 
> 标签：shell

愿上帝永远不会给你在 Solaris 上工作的祸根。现在，我正在尝试运行这个简单的 shell 脚本：

```
#!/bin/sh

input="a
b
c"
data="123"

while read eachline
do      
   data="$data$eachline"
done <<  EOF
$(echo "$input")
EOF

echo "$data"
exit 0 
```

在 RHEL(BASH) 上，我收到预期的输出，即“123abc”，但是，在 Solaris 上，我只收到“123”。

经过一番谷歌搜索后，我意识到 Solaris 正在为 while 循环内的代码分叉一个进程，因此变量的 ($data) 值不会反映在 while 循环的外部。

任何希望使此代码在两个平台上兼容都将不胜感激。

哦，是的，使用临时文件进行重定向不是一个非常优雅的解决方案：| .

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T08:55:06.847

你在 Solaris 机器上有一个 bash 可执行文件吗？我注意到您指的是 RHEL 上的 bash，但您的 shell 设置为 #!/bin/sh（即 vanilla Bourne shell）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T09:11:29.427

您的脚本在 Mac OS X 10.5 上运行良好，这是经过认证的[Single Unix Specification version 3](http://www.opengroup.org/platform/single_unix_specification/)。

Solaris 上 /bin/sh 中的 while 行为非常奇怪。你能提供你发现分叉问题的链接吗？

一种可能的解决方案是使用另一个 shell，例如 /bin/ksh。

* * *

**编辑**

您的链接提供的示例不显示`while`任何外壳的问题，而是显示正常行为。所有这些的基本结构是：

```
first_command | second_command_updating_variable 
```

`second_command_updating_variable`这是一个循环的事实`while`并不重要。重要的是管道的第二个命令在子shell中执行，不能修改其父shell的变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T09:25:53.340

这个怎么样（请注意反引号）：

```
#!/bin/sh

input="a
b
c"
data="123"

z=`while read eachline
do      
   data="$data$eachline"
done <<  EOF
$(echo "$input")
EOF
echo $data
`
echo $z
exit 0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T04:29:47.117

下面的这段代码解决了我的问题。我想这里的关键是从子shell中回显变量，当然，不要使用“here”文档。

我已经在 CSH/BASH/KSH 上测试了这段代码。

```
#!/bin/sh
input="a
b
c"

printf "$input" | { 
data="123"
while read eachline
do      
    data="$data$eachline"
done 
echo "$data"
}

exit 0 
```

我衷心感谢所有参与本次讨论的人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T06:54:21.497

为什么要在here文档中执行一个[子shell ？](http://www.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_06_03)

```
while read eachline
do      
   data="$data$eachline"
done <<  EOF
$(echo "$input")
EOF 
```

你可以插值：

```
while read eachline
do      
   data="$data$eachline"
done <<  EOF
$input
EOF 
```

或回声：

```
echo "$input" | while read eachline
do      
   data="$data$eachline"
done 
```

实际上，当我测试这些时，它们在 Solaris 上对我来说都很好，所以我不确定你为什么会遇到麻烦。

# python - Python 脚本 - Windows 上的 SCP

> ID：729130
> 
> 赞同：0
> 
> 时间：2009-04-08T08:56:38.840
> 
> 标签：python, windows, copy

如何使用 python (windows native install - ActivePython) 进行安全复制。不幸的是 pexpect 模块仅适用于 unix，我们不希望在本地使用 cygwin。我编写了一个基于 pscp.exe win 工具的脚本 - 但由于指纹主机 ID 始终在第一次执行时停止。并且还没有找到关闭它的选项。远程主机在 cygwin（win 2003 服务器）上运行 ssh-server。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T13:00:19.160

[paramiko](http://www.lag.net/paramiko/)很漂亮。有关更多详细信息，请参阅[此问题。](https://stackoverflow.com/questions/250283/how-to-scp-in-python)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T18:02:33.130

我强烈建议您使用密钥而不是密码。如果您正确使用 ssh 密钥，则不需要使用 expect，因为 scp 命令不会要求任何用户输入。如果你安装了命令行 ssh，你可以像这样创建一个密钥：

```
ssh-keygen -t dsa 
```

然后只需按照提供的说明进行操作，并将密钥保存到默认位置。如果您在上面输入密码，则需要使用某种 ssh 代理，无论是命令行 ssh-agent 还是 windows 上的 pagent。您还可以使用 putty 套件的 puttygen 创建 ssh 密钥。

要设置用于身份验证的密钥，只需将 id_dsa.pub 的副本放在要 scp 到文件 ~/.ssh/authorized_keys 的主机上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T09:13:12.950

[http://pypi.python.org/pypi/ssh4py](http://pypi.python.org/pypi/ssh4py)

SCP 示例：[http ://blog.keyphrene.com/keyphrene/index.php/2008/09/18/13-scp](http://blog.keyphrene.com/keyphrene/index.php/2008/09/18/13-scp)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T13:39:42.280

[Twisted Conch](http://twistedmatrix.com/trac/wiki/TwistedConch)支持 ssh 和 sftp。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T09:00:39.063

您希望如何提供身份验证数据？最简单的方法是创建一个密钥，并确保它在服务器的接受主机列表中。这样 scp 将自动使用私钥/公钥对进行身份验证，并且“正常工作”。

[这](http://www.lesbell.com.au/Home.nsf/b8ec57204f60dfcb4a2568c60014ed0f/04eaff076bce249dca256fb6007f53e5?OpenDocument)是一个关于如何创建和上传密钥的方便教程。当然，这假设您对服务器具有必要的管理员访问权限。

# linq-to-sql - LINQ 代码生成属性名称

> ID：729131
> 
> 赞同：1
> 
> 时间：2009-04-08T08:56:45.703
> 
> 标签：linq-to-sql, naming-conventions

我正在使用 LINQ To SQL 来处理项目中的数据访问。对于我在同一个表的表中有多个外键的情况（例如 CustomerUserId、TechnicianUserId），它会生成像 ApplicationUser 和 ApplicationUser1 这样的属性名称。有没有办法调整代码生成器以产生更易于阅读的名称。

在这方面我对[LINQPad](http://www.linqpad.net/)感到很惊喜。它正确地生成属性名称（例如，在本例中为 CustomerUser 和 TechnicianUser）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T09:00:10.487

如果您使用 LINQ2SQL 设计器，您可以选择两个类之间的连接并修改属性名称（在属性窗口中展开子属性和/或父属性）。

# iphone - 为什么 iPhone 上没有 NSAttributedString？

> ID：729135
> 
> 赞同：2
> 
> 时间：2009-04-08T08:57:50.787
> 
> 标签：iphone, uikit, nsattributedstring

有谁知道是什么让 Apple 在将 AppKit 变成 UIKit 时遗漏了 NSAttributedString？

我问的原因是我真的很想在我的 iPhone 应用程序中使用它，而且除了自己做之外似乎没有替代或替代方法......

字符串上可能有混合字体属性——要实现类似的东西，用几行代码用 NSAttributedString 就可以实现。

此外，自己编写所有这些额外的绘图代码会使我的表格视图单元格非常沉重，并且确实会损害性能。

有人有什么想法吗？有任何天才正在研究 NSAttributedString 的开源替代品吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2010-04-14T17:26:00.210

NSAttributedString 现在在 iPhone 4.0 Beta 上

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T16:41:23.137

当前从文档推荐的方法是使用 UIWebView。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-16T10:49:36.377

我不知道这是否仍然与您相关，但乔·休伊特同时发布了他的[three20](http://github.com/joehewitt/three20/tree/master)库，其中包含`TTStyledText`并`TTStyledTextLabel`满足您的需求。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-08T13:01:48.423

恐怕您将不得不自己动手。如果您在绘制表格时陷入困境，我可能会切换到原始 Quartz 调用；尝试将所有绘图转储到一个视图中，并在其中绘制所有复杂的字符串。NSAttributedString 很方便，但我不认为它使用所有特殊的 AppKit-mojo 来获得比直接字符串绘制调用更好的性能。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-24T18:37:01.683

上面的答案表明 NSAttributedString 在 OS 4.0 及更高版本上可用，但根据文档，它在 3.2 上可用：

**NSAttributedString 类引用**
**继承自**NSObject
**符合**NSCoding、NSCopying、NSMutableCopying、NSObject (NSObject)
**框架**/System/Library/Frameworks/Foundation.framework
**可用性** *适用于 iPhone OS 3.2 及更高版本。*
**配套指南**属性字符串编程指南
**在**NSAttributedString.h中声明

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T15:22:28.367

另一种方法是使用带有 HTML 的 UIWebView。或者，如果您敢于使用 UITextView 上未记录的 setHTML 方法来设置格式化文本的小片段...

对我来说，这似乎更像是支持格式化文本的未来，以某种方式利用 Webkit 输出格式化字符串。

# random - Excel 2007 关于随机数的问题

> ID：729136
> 
> 赞同：0
> 
> 时间：2009-04-08T08:57:57.590
> 
> 标签：random, excel-2007

在单元格 A1:A50 中，我有由公式（从 0 到 20）生成的随机数，现在我所做的这些数字一直在变化，所以我想知道将这些随机数自动洗牌直到系列的公式连续获得 5-12-19 的将会出现。如果有人可以帮助我解决这个问题，我真的很感激......谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T09:02:32.913

我认为您将需要一个返回数组的 VBA 函数。该 VBA 函数必须不断生成数字序列，直到它得到你想要的（你*为什么*想要这是另一回事！）。

抱歉 - 我不是 VBA 高手，所以我不能轻松地为您整理这些内容。

# c# - .NET 计时器是否异步运行？

> ID：729137
> 
> 赞同：15
> 
> 时间：2009-04-08T08:58:18.710
> 
> 标签：c#, .net, multithreading, timer

我有一个使用[Jabber-net](http://code.google.com/p/jabber-net/)（一个[XMPP 库](http://en.wikipedia.org/wiki/List_of_XMPP_library_software)）的应用程序的消息传递方面。

如果由于某种原因与服务器的连接终止，我想做的就是每分钟左右继续尝试连接。

如果我在下一次尝试之前启动 Timer 等待一段时间，该计时器是否异步运行并且生成的 Tick 事件加入主线程，还是我需要启动自己的线程并从那里启动计时器？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-08T09:07:25.787

你用的是什么定时器？

*   `System.Windows.Forms.Timer`将在 UI 线程中执行
*   `System.Timers.Timer`在线程池线程中执行，除非您指定`SynchronizingObject`
*   `System.Threading.Timer`在线程池线程中执行其回调

在所有情况下，计时器本身都是异步的——它在触发之前不会“占用”线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T09:00:03.170

计时器将有效地在后台运行，并导致主线程中的事件被执行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T09:11:44.873

我不确定.NET中的计时器是如何实现的，但是如果他们使用windows API来创建计时器，表单消息循环会收到一条[`WM_TIMER`](http://msdn.microsoft.com/en-us/library/ms644902(VS.85).aspx)消息，并且只有当表单线程不忙时它才能处理该请求，所以计时器会在正确的时间触发，但您可能会停止 UI 线程。计时器将通过[`SetTimer`](http://msdn.microsoft.com/en-us/library/ms644906(VS.85).aspx)API 启动，操作系统将确保发布`WM_TIMER`消息。

我已经检查过，仅`System.Windows.Forms.Timer+TimerNativeWindow.StartTimer(Int32)`取决于：

```
[DllImport("user32.dll", CharSet=CharSet.Auto, ExactSpelling=true)]
public static extern IntPtr SetTimer(HandleRef hWnd, int nIDEvent, int uElapse, IntPtr lpTimerFunc); 
```

所以只有这个计时器有描述的“问题”。

# css - 您使用哪种字体系列规范在 mac 和 windows 上看起来很棒？

> ID：729142
> 
> 赞同：2
> 
> 时间：2009-04-08T09:00:18.473
> 
> 标签：css, fonts

Windows上的Arial看起来很糟糕，但在Mac上它很酷。您在您的网站中使用什么字体系列集确实有助于 mac 和 windows 具有漂亮的字体？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T09:54:23.397

主要问题不是选择哪种字体，而是微软和苹果决定在计算机屏幕上呈现它们的方式。微软专注于屏幕的可读性，对比度高但准确性较低，而苹果则强调排版准确性，在亚像素渲染上有些模糊。

Joel Spolsky 有一篇关于这个主题的文章：[字体平滑、抗锯齿和亚像素渲染](http://www.joelonsoftware.com/items/2007/06/12.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T09:11:51.423

维达纳...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T09:07:22.823

投石机，是另一个好东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T09:16:38.323

Georgia 适用于标题和正文。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T09:04:35.513

`sans-serif`:)

# c++ - 如何在 VC++ 中以编程方式检查 Internet 带宽？

> ID：729146
> 
> 赞同：5
> 
> 时间：2009-04-08T09:01:29.763
> 
> 标签：c++, visual-studio, winapi, mfc

我需要找到在特定时间可用的带宽。代码必须在 Visual C++ 或 .Net 系列中开发。如果有人知道怎么做，请帮帮我。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-08T09:11:31.613

检查带宽的唯一方法是实际尝试使用它，即从其他地方下载文件并测量吞吐量。

即使那样，它也只是一个近似值，因为其他网络效应会影响结果：

*   潜伏
*   非对称上传/下载
*   其他流量

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-21T12:19:44.627

如果您的意思是当前的网络利用率，您可以致电

[`DeviceIoControl`](http://msdn.microsoft.com/en-us/library/aa365915.aspx)`(hDevice,` [`OID_GEN_STATISTICS`](http://msdn.microsoft.com/en-us/library/ms798985.aspx)`,`...`)`

在 Vista 及更高版本上以获取特定于设备的信息。否则，调用[GetIpStatisticsEx](http://msdn.microsoft.com/en-us/library/aa365963.aspx)以获取系统范围的信息或使用 WMI 的[Win32_PerfRawData_Tcpip_NetworkInterface](http://msdn.microsoft.com/en-us/library/aa394340.aspx)。

通过尝试使连接饱和来尝试获得“可用”带宽不是明智或可靠的措施。只需尝试一些可用的在线速度测试，并考虑它涉及不可扩展的带宽，并且容易受到拥塞控制、QoS 和流量整形的影响。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T12:17:44.287

即使使用它，检查带宽也会很棘手。例如，如果您尝试从远程机器 X 下载数据并且您估计 N Kbs 的数字，那么您如何知道这是**您的**带宽限制还是远程机器 X 连接的限制？

您需要同时启动多台远程机器的同时下载（或上传，如果这是您想要测量的方向），并不断增加负载，直到吞吐量停止增加。

但正如 Alnitak 所说，您仍然不知道还有哪些其他因素可能会影响结果。例如，您的机器上是否有其他进程使用该连接？还是隔壁的孩子在您的无线局域网上捎带并窃取您的带宽？也许这就是你想要找出的！

# user-interface - 从 DB 生成 UI - 好的、坏的和丑陋的？

> ID：729148
> 
> 赞同：6
> 
> 时间：2009-04-08T09:02:10.357
> 
> 标签：user-interface, auto-generate

我在某处读过一个声明，即从 DB 布局（或业务对象，或任何其他业务层）自动生成 UI 是一个坏主意。我还可以想象一个人必须面对一些好的挑战才能做出这样的事情。

但是，我没有看到（也找不到）任何尝试它的人的例子。因此，我想知道 - 真的那么糟糕吗？这绝对不容易，但任何措施都可以成功吗？主要障碍是什么？很高兴看到一些成功和失败的例子。

澄清一下 - “自动生成 UI”我的意思是所有表单及其所有控件都是完全自动生成的（在运行时或编译时），可能基于元数据中关于如何表示数据的一些提示。这与手工设计表单（就像大多数人所做的那样）形成对比。

**补充：**发现[这个有点相关的问题](https://stackoverflow.com/questions/104348/any-metadata-driven-ui-sample-code)

**补充 2：**好的，似乎可以获得相当公平结果的一种方法是，如果有足够的与演示相关的元数据可用。对于这种方法，多少是“足够”的，它会比手动设计表单少吗？它是否也为未来的变化提供了更大的灵活性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T09:11:57.743

我们有一个项目，它将生成数据库表/存储过程以及来自业务类的 UI。它是在 .NET 中完成的，我们在类和属性上使用了很多自定义属性，以使其按照我们想要的方式运行。虽然它工作得很好，如果你设法遵循你的设计，你可以很容易地创建你的软件的定制。我们也确实有办法为一些非常特殊的情况添加“自定义”用户控件。

总而言之，这对我们来说效果很好。不幸的是，它是一种出售的银行产品，没有可用的来源。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T10:08:28.700

对于一些微小的东西来说没关系，你只需要一种实用的方法来获取数据。

但是，对于任何类似于真实应用程序的东西，这是一个糟糕的主意。一个好的 UI 是人性化因素，你可以调整的部分，以确保这台机器对人的触摸反应良好。

当您的界面是机械生成的时，您就无法做到这一点......也许是接近人工智能的东西。:)

编辑 - 澄清：从 code/db 生成的 UI 作为起点很好，它只是一个垃圾终点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T10:00:12.993

嘿，这根本不难实现，这也不是一个坏主意。这一切都取决于您的项目需求。许多软件产品（请注意不是项目而是产品）依赖于这个模型——所以他们不必为不同的客户需求重写他们的代码/用户界面逻辑。客户可以使用管理系统中的设计器表单以他们想要的方式自定义他们的用户界面

我已经使用 xml 来保存这类东西的元数据。我为每个字段保存的一些属性是：

1.  友好名称（标签标题）
2.  haspredefinedvalues（对于下拉列表/多复选框列表是）
3.  多选（如果是则复选框列表，如果否则下拉列表）
4.  数据类型
5.  最长长度
6.  必需的
7.  最小值
8.  最大值
9.  正则表达式
10.  启用（显示或不显示）
11.  sortkey（网络表单上的订单）

关于定位 - 我不太在意，只是在另一个下方生成表 tr td 标签 1 - 但是，如果您也想实现这一点，您可以再拥有 1 个名为 CssClass 的属性，您可以在其中定义 ui 特定属性（外观和感觉，定位等）在这里

更新：还请注意，当您想要输入产品信息时，许多电子商务产品都遵循这种动态用户界面 - 因为他们的客户可以在阳光下销售从家具到性玩具的所有东西 ;-) 所以而不是为每个不同的东西重写他们的代码行业他们只是让他们的客户通过管理表单输入产品属性的元数据:-)

我还建议您查看[Entity-attribute-value 模型](http://en.wikipedia.org/wiki/Entity-Attribute-Value_model)- 它有自己的优点和缺点，但我觉得它可以很好地满足您的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T10:48:25.450

在我看来，您应该考虑以下几点：

1.  客户是否需要自定义 UI 的功能？
2.  有很多不同的属性或元素吗？
3.  创建这样一个“渲染引擎”的努力值得吗？

好的，我认为这很明显为什么你应该考虑这些。这种模型是否有意义真的取决于你的项目......如果你想创建一些可以在运行时自定义的表单，那么这个模型可能非常有用。此外，如果您需要做很多较小的工具并将其用作某种“引擎”，那么这种努力可能是值得的，因为您可以节省大量时间。使用这种“渲染引擎”，您可以自动添加错误报告、检查值或添加始终以相同模式构建的其他内容。但是如果你有太多这样的东西、元素或属性，那么性能就会迅速下降。在更大的项目中变得有趣的另一件事是，必须在每种形式中发生的更改只需要在引擎中进行，不是每种形式。如果完成的应用程序中存在错误，这可以节省大量时间。

在我们公司，我们在现金软件（现在我不记得正确的词......）和我们的应用程序之间使用类似的模型作为接口生成器，只是它不创建 UI，而是为其中一个创建一个输出文件应用程序。我们使用 XML 来定义结构以及需要如何转换值等等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T12:51:58.853

我会说，在大多数情况下，数据不适合 UI 生成。这就是为什么您几乎总是在两者之间放置一层逻辑来向用户解释数据库信息。另一件事是，当您从 DB 生成 UI 时，您最终会显示系统的内部运作，这是您通常不想做的事情。

但这取决于数据库的来源。如果创建它以准确反映系统的用户目标是什么。如果应用程序应该帮助他们的用户心理模型存储在数据库中。那么它可能只是工作。但是你**必须**从用户端开始。如果不是，我建议你不要那样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-20T03:23:53.223

你能从应用程序架构的角度来看待你的问题吗？我认为你是另一个数据库恐怖分子——试图通过编写存储过程来解决所有问题。为什么要有 UI？尝试在数据库脚本中执行此操作。这种方法的效果——你最终会在什么复合系统上？当系统服务于不同的业务时——尝试模块化、选择性地发现组件、限制共享引用。UI 应该是可替换的，独立于业务层。当在 DB 中存储如此多的数据时——UI 存在硬依赖——系统变成了单体。生成 UI 时如何在场景中实现 MVVM 模式？像 Blend 这样的设计师包含许多功能，大多数未来派的 UI 生成器都无法替代 - 除非 - 您的开发平台仅是记事本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-02-26T14:47:34.173

有一种混合方法，其中表单和所有内容都在数据库中进行描述，以确保服务器端的一致性，然后对其进行编译以确保客户端在部署时的效率。

一个真实的例子是企业软件 MS Dynamics AX。

它有一个**“数据”**数据库和一个**“模型”**数据库。

“**模型”**存储应用程序需要运行的表单、类、作业和每个人工制品。

部署新的软件结构曾经是转储模型数据库并启动CIL编译（CIL为通用中间语言，微软在.net中使用的东西）

这种方式适用于企业范围的软件，并且可以处理大型定制。但请记住，这种方法设置了一个框架，以后维护和自定义应用程序的人都应该很好地理解该框架。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-02-16T16:20:05.360

我这样做（在 PHP / MySQL 中）是为了自动生成我为客户端构建的 CMS 的部分。它工作正常，我的主要问题是生成表单的代码变得非常不透明且难以理解，因此难以重用和修改，所以我没有重用它。

请注意，表遵循严格的约定，例如命名等，这使得 UI 可以预期特定列并推断有关列和表命名的信息。需要元信息来帮助 UI 显示数据。

一般来说它可以工作，但问题是如果你的 UI 只是镜像数据库，那么可能还有很多改进的空间。一个好的 UI 应该做的不仅仅是镜像数据库，它应该围绕人类交互模式和偏好构建，而不是围绕数据库结构。

因此，基本上，如果您想便宜并做一个快速而肮脏的界面来反映您的数据库，那么就去做吧。主要的挑战是找到可以做到这一点的高质量代码或自己编写。

# windows-xp - 双反斜杠不起作用？

> ID：729151
> 
> 赞同：1
> 
> 时间：2009-04-08T09:03:11.773
> 
> 标签：windows-xp, path, registry

有人知道为什么某些 Windows XP 安装不会评估带有双反斜杠的路径吗？

在某些 XP 上发现错误（相同的版本、补丁、未知的更多详细信息）。在大多数情况下一切正常，在某些 PC 上以下不起作用：

使用 RegEnumKeyEx、fopen 等函数查询路径（注册表或文件夹）如果路径包含两个反斜杠（例如`C:\\test\hello.txt`.

```
strPath = "\SOFTWARE\Microsoft\Windows\Currentversion\run"    // works

strPath = "\SOFTWARE\Microsoft\Windows\Currentversion\\run"   // doesn't work 
```

是否有一些可以影响它的策略选项或设置？

欢迎任何帮助，RM

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T07:49:11.867

为什么不简单地将路径修改为只有一个 \ 在使用它之前呢？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T10:04:05.403

可能完全不相关，但在 C/C++（以及其他语言）中 - `"c:\\\\test\hello.txt"`可以，但`"c:\test\hello.txt"`不是（因为`\t`被解析为制表符，所以你得到的名称并不真正存在）。

**当两个反斜杠不存在**时是否有可能发生失败，并且当它们存在时事情正常？

# visual-studio-2008 - 不允许循环文件引用

> ID：729153
> 
> 赞同：22
> 
> 时间：2009-04-08T09:04:01.163
> 
> 标签：visual-studio-2008, msbuild, aspnet-compiler

我在 VS2008 中构建解决方案时遇到问题。通常，它在环境中编译得很好。有时，它会失败：

```
/xxx_WEB/secure/CMSManagedTargetPage.aspx(1): error ASPPARSE: Circular
file references are not allowed. 
```

我重建，它工作正常。

然而，现在我正在设置 CruiseControl.NET 系统，并在将构建集成到 CC 之前使用 MSBuild 测试我签出的代码。现在，每次我进行 MSBuild 时，我都会得到：

```
"Q:\cc\xxx\checked out from svn\xxx.sln" (default target) (1) ->
(xxx_WEB target) ->
  /xxx_WEB/secure/CMSManagedTargetPage.aspx(1): error ASPPARSE: Circular
file references are not allowed. 
```

问题是，我看不到这个引用在哪里。

*   我已经在整个解决方案中搜索了引用，并且除了在页面或其代码隐藏或字符串中之外的任何地方都找不到对页面本身 (CMSManagedTargetPage) 的引用，例如：

    C:\dev2008\xxx\IWW.xxx.ASPNET\AspxHttpHandler.cs(82): inputFile = context.Server.MapPath("~/secure/CMSManagedTargetPage.aspx"); C:\dev2008\xxx\IWW.xxx.ASPNET\AspxHttpHandler.cs(83): virtualPath = "~/secure/CMSManagedTargetPage.aspx";

我的程序集引用也很好（据我所知）。我的 Web 应用程序位于依赖项的“顶部”，没有任何内容引用它，因此错误页面不会导致循环引用。当然，页面本身可能会引用同一个程序集/网站中的 UserControl 等内容，但如前所述，在 CMSManagedTargetPage 上的搜索没有产生任何结果，因此不会发生这种情况。

更改 web.config 中的批处理属性对 MSBuild 没有影响。

我发现它“有时”在 VS 中失败并且在 MSBuild 中总是失败，这很奇怪。我错过了一些微妙之处吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-02-14T11:04:29.610

转自：

[http://ellisweb.net/2009/12/fixing-the-circular-file-references-are-not-allowed-error-in-asp-net/](http://ellisweb.net/2009/12/fixing-the-circular-file-references-are-not-allowed-error-in-asp-net/)

*如果您有以下设置： /folder1/Control1.ascx > References Control2 /folder2/Control2.ascx > References Control3 /folder1/Control3.ascx 这意味着folder1 dll将引用folder2 dll，它将再次引用folder1 dll，导致“循环文件引用”。*

* * *

今天这对我有帮助；我在根目录中有一个母版页，它引用了文件夹中的母版页，该目录引用了根目录中的不同页面。改组哪些页面在哪些文件夹中就像一个魅力。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-05T22:50:53.777

I ran into your post when I ran into the same problem. There are probably a million solutions to a Circular reference problem, but mine was a direct result of Master Pages.

I accidentally created a page using a nested masterpage, outside the nested folder. Example:

```
Master1.Master
Page.aspx
(Folder1) 
Master2.Master 
```

While Page.aspx was referencing Master2.Master as its masterpage, It would build normally, and error when I "Publish".

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-04-13T20:27:22.323

我也遇到了这个问题，通过选择“使用固定命名和单页程序集”，能够从 Visual Studio 中成功发布。出于某种原因，这似乎避免了编译器认为存在循环引用。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-03-19T13:27:45.323

我有类似的问题，并从@JBicford 的回答中得到了密切的线索。我在另一个文件夹中使用 Master.master 在网站的根目录上使用 Default.aspx。不知道这是否会导致这种情况，尚未测试此解决方案。

但是对于有兴趣解决发布问题的人，以下选项适用于 VS 2012，所有其他选项都失败，因为对其他文件夹和页面的依赖不正确。

![在此处输入图像描述](https://i.stack.imgur.com/O8ich.jpg)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-01-03T22:18:46.000

我发现当 Visual Studio 批量编译页面时出现此错误。我可以通过在 web.config 中的编译元素上设置 batch="false" 来解决这个问题。

更具体地说，我在包含问题页面的目录中添加了一个 web.config。该 web.config 文件只有以下内容：

```
<?xml version="1.0"?>

<configuration>
  <system.web>
    <!-- Added to prevent error ASPPARSE: Circular file references are not allowed. -->
    <compilation batch="false" />
  </system.web>
</configuration> 
```

这样，Visual Studio/MSBuild 仍然可以根据需要批量编译其他不受影响的目录。

有关编译元素和批处理属性的更多信息，请[访问 msdn](http://msdn.microsoft.com/en-us/library/s10awwz0.aspx)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-09-22T13:55:11.070

对我来说，它也在母版页上注册 aspx 页面。

例如（在母版页中）：

```
<%@ Register Assembly="MyPage" Namespace="MyPage" TagPrefix="MyPage" %>
...
<asp:ContentPlaceHolder id="MyPage" runat="server"></asp:ContentPlaceHolder> 
```

然后在aspx页面中：

```
<%@ Page Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" 
    CodeFile="MyPage.aspx.cs" Inherits="MyPage" Title="Untitled Page" %>
<asp:Content ID="SomeContent" ContentPlaceHolderID="MyPage" Runat="Server"> 
```

删除寄存器修复它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-10-14T09:30:31.347

**我遇到了这个问题，但没有一个建议对我有用，我的可能是一个独特的案例，但以防其他人遇到同样的问题：**

我的似乎与我无关`Circular References`，实际上是由于我的构建输出。一段时间无处可去后，我在无法加载的控件上放置了一个断点，并收到一条通知，告诉我它不会被击中。

更改**项目属性**和**解决方案配置设置**以构建以`Any CPU`纠正问题。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-20T13:27:59.653

对于那些喜欢我的人来说，这个问题一直在绕圈子。我相信我可能有另一种解决方案，但其他方法都失败了。我们在 MVC 应用程序中遇到了这个问题，我们花了数周时间尝试各种建议，但无济于事。

我们发现我们正在运行 McAfee 病毒扫描程序 V 8.0。我们发现，当我们从 VirusScan 控制台禁用按访问扫描程序时，我们能够毫无问题地构建和调试。

唯一的问题是，当此设置禁用时，它将每 15 分钟自动重新启用一次。

我觉得这个值得分享。。

谢谢，院长

编辑：仅当您对您的机器具有本地管理员访问权限时，这才有效。从安全的角度来看，关闭 AV 扫描仪是有道理的（理所当然）。事实上，如果你在一个由网络管理员控制的工作环境中，你甚至可能会被他们拒绝。我确信还有另一种方法可以做到这一点，但现在这似乎对我们有用，但如果我找到另一种解决方法（即网络管理员友好），我将在这里分享。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-08-27T05:20:38.590

这个错误在 ASP.NET 4.0 中仍然存在。

我得到的错误是：

```
/DirA/PageA.aspx(3): error ASPPARSE: Circular file references are not allowed.
/DirA/PageA.aspx(71): error ASPPARSE: Unknown server tag 'Controls:ControlA'. 
```

ControlA 与 PageA.aspx(3) 中引用的控件相同。我发现我必须将 ControlA 移动到与 PageA 相同的目录中才能停止此错误。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-06-30T05:49:22.010

如果我有一个包含在母版页中的用户控件 (ASCX)，我会遇到这种行为。

通常我只是忽略该错误，因为它在第二次构建之后就消失了。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-07-14T19:54:58.053

实际上，这篇文章解释了它为什么会发生以及如何解决它： [http ://www.gitshah.com/2011/04/how-to-fix-circular-file-references-are.html](http://www.gitshah.com/2011/04/how-to-fix-circular-file-references-are.html)

> 如何修复 ASP.Net 中的“不允许循环文件引用”错误
> 
> 在我的一个 .Net 项目中，我遇到了一个有趣的问题。我浪费了几个小时来修复它。因此，我决定分享我的发现，这样其他人就不必浪费时间解决同样的问题。
> 
> 问题
> 
> 问题很简单，应用程序无法构建。我在使用 MSBuild 构建 ASP.Net Web 项目时遇到的错误是：/someProject/Controls/A/ucA.ascx(2): error ASPPARSE: Circular file references are not allowed。
> 
> 当然，错误表明我的代码中有某种循环引用。如果我错误地创建了循环引用，我环顾四周检查并重新检查。但是，如果有任何循环引用，则代码将无法编译。代码编译得很好，但是当我们运行 aspnet_compiler.exe 时它失败了。
> 
> ASP.Net 编译工具 (aspnet_compiler.exe) 使您能够编译 ASP.Net Web 应用程序，这有助于提高应用程序性能，因为最终用户不会遇到对应用程序的第一次请求的延迟。
> 
> 我再次检查，但肯定没有代码相关的循环依赖，那么为什么 aspnet_compiler.exe 抱怨循环文件引用？
> 
> 说明
> 
> 谷歌搜索了一下，我发现，默认情况下，在网站项目中，ASP.Net 会为每个文件夹创建一个 DLL。因此，如果您有以下设置：
> 
> 用户控件 ucA.ascx 存在于目录“A”中。ucA.ascx 引用另一个用户控件 ucB.ascx 用户控件 ucB.ascx 存在于目录“B”中。ucB.ascx 引用另一个用户控件 ucC.ascx 用户控件 ucC.ascx 存在于目录“A”中。
> 
> 文件夹A的DLL会引用文件夹B的DLL，又会引用文件夹A的DLL，造成“循环文件引用”。
> 
> 这就是 aspnet_compiler.exe 因“循环文件引用”错误而失败的原因。
> 
> 修复
> 
> 有两种方法可以解决此问题
> 
> 重新排列用户控件（或 MasterPages）以删除循环引用。通常这意味着将用户控件移动到单独的目录中。在我们的示例中，将 ucC.ascx 移动到新目录“C”（首选解决方案）。在 web.config 文件的编译标签中使用 batch=”false”。这将导致为站点中的每个控件/页面创建一个新的 DLL。这应该可以修复错误，但对于性能来说确实很糟糕，所以应该避免。
> 
> 我将 ucC.ascx 移到了不同​​的目录中，是的，错误消失了！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-05-24T02:57:15.830

Same issue on some code I inherited.

My issue was I had a file in the app_data Folder, but it had a namespace of MyControls in it. I ended up moving that file out of the app_data folder and created a new folder "my controls".

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-07-24T08:11:17.740

对我来说，这些技巧不起作用

-setting batch=true -deleting asp.net Temp 文件和 IIS reset -replaceing 可疑的 ascx 文件

问题在于将最近添加的项目引用到我的解决方案并在最终构建后将其卸载。删除对这个新添加的库的引用解决了问题

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-11-21T14:41:57.650

在一次重大的开发大修期间，我遇到了同样的错误。在我的特殊情况下，这是因为我使用的是“JUNK”文件夹，我在其中拖放未使用或重命名的文件。我的垃圾文件夹正在编译，我最近删除的一个文件导致了这个问题。

我通过排除垃圾文件夹中的单个文件来解决此问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2015-04-04T14:45:41.233

在大多数情况下，这发生在复制 aspx 页面之后。确保您的班级 `Inherits="MyPage"`没有在整个网站上重复。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-09-29T08:38:42.750

另一个问题在于后面的代码：**MasterPageA : B => PageC : B => PageC 使用 MasterPageA**。它发生错误“不允许循环文件引用”。Visual Studio 不会报告此类中的错误。您必须手动检查。

# c# - Foreach 因编组 COM 接口而失败

> ID：729156
> 
> 赞同：2
> 
> 时间：2009-04-08T09:04:48.400
> 
> 标签：c#, .net, com, interop, windows-server-2008

我们有一个用 C++ 用 ATL 编写的 32 位 COM 组件。当需要从 64 位 .NET 使用它时，我们创建一个 COM+ 应用程序，一切正常。

最近我们注意到 Win2k8 上的奇怪行为。我们组件中的 COM 对象触发一个事件，我们在 .NET 代码中处理它。该事件还有一个参数也从非托管代码传递。

这是澄清的部分定义（IDL表示法）：

```
interface IOurCollectionInterface : IDispatch 
{
[propget, restricted, id(DISPID_NEWENUM)]]
HRESULT _NewEnum( [out, retval] IUnknown** result );
}

interface IOurObjectInterface : IDispatch 
{
[propget]
HRESULT Collection( [out, retval] IOurCollectionInterface** result );
} 
```

事件处理程序被传递一个 IOurObjectInterface 实例。在里面我们尝试运行一个 foreach() 循环。

```
void onEvent( IOurObjectInterface ourObject )
{
    foreach( object element in ourObject.Collection ) {
       //do stuff
    }
} 
```

代码在*foreach*行崩溃并显示以下消息： **IEnumVARIANT 的 QI 在非托管服务器上失败**

`IEnumVARIANT`肯定是由实现返回的对象`IOurCollectionInterface::get__NewEnum()`实现的。上面的代码在 WinXP 和 Win2k3 上可以正常工作，但在 Win2k8 上不行。

这种行为的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T15:12:28.203

尝试使用系统帐户运行并检查事件以获取有关错误的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T10:21:56.497

很难确定。但会怀疑编组问题。

您是否检查过`IOurCollectionInterface._NewEnum`实际调用的实现？

您使用的是哪种 COM 编组？如果是 typelib，是否正确注册了 typelib？

如果接口在进程中实现，它是否工作？

* * *

来自[尖牙](https://stackoverflow.com/users/57428/sharptooth)的评论：

> 使用类型库编组并注册类型库。更糟糕的是，当从同一台机器上的 WinForms 应用程序调用时，这些东西可以正常工作，但从本地用户下运行的 NT 服务调用时会失败。

如果 WinForms 应用程序和服务以不同的用户身份运行，则需要非常仔细地检查安全性。从 COM+ 安全性开始，然后使用进程监视器检查注册表/文件访问问题（这似乎不太可能，但总是可能的）。

# windows - Windows 相当于 ulimit -n

> ID：729162
> 
> 赞同：8
> 
> 时间：2009-04-08T09:06:02.233
> 
> 标签：windows, file-descriptor, ulimit

什么是 windows 等效的 unix 命令“ulimit -n”？

基本上，我想通过命令提示符设置最大 fd 限制。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-08T09:16:12.177

我不相信当前的 Windows O/S 对文件描述符的*总数*`msvcrt.dll`有限制，但 MS 运行时库 ( ) 的*每个进程*限制为 2048，尽管据我所知，这不是由 O/ S。

据称只能通过从源代码构建您自己的 MS 运行时库版本来增加它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T09:09:14.380

嗯......我之前可能错了 - setmaxstdio（见[这里](http://www.codeproject.com/KB/system/File_Descriptor_Limit.aspx)） - 但它是每个进程的，而不是系统范围的。

~~我可能错了，但我认为在 Windows 中设置没有限制......~~但除非你能说出这与编程有何关系，否则我希望这个答案很快就会关闭。

如果您在“IT Pro”领域（而不是开发），那么有一个姊妹站点 serverfault.com - 即将针对此类问题。

# web-crawler - 网站蜘蛛自动检测

> ID：729167
> 
> 赞同：1
> 
> 时间：2009-04-08T09:07:37.567
> 
> 标签：web-crawler

是否可以编写代码来检测网站是否在抓取内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T09:13:55.477

一只好蜘蛛

*   读取 robots.txt
*   有合适的用户代理
*   将比普通用户更快地查询

但是我认为不可能清楚地检测它是浏览器还是蜘蛛。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T09:15:28.827

您尝试使用用户代理字符串来识别机器人。

不同的机器人似乎有不同的用户代理字符串：

[http://www.useragentstring.com/pages/useragentstring.php](http://www.useragentstring.com/pages/useragentstring.php)

但是，用户代理字符串很容易被欺骗。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T09:15:59.060

您可以使用常见机器人使用的用户代理字符串列表。您可以使用某种形式的速率检测并确定非常高的请求率可能是蜘蛛（或窃取您的整个站点的人）。

也可能有普通机器人使用的 IP 地址列表，但一个万无一失的检测系统很可能是不可能的。

您可以在您的页面上创建一个真正的访问者永远不会点击的链接，并将任何跟随该链接的人标记为蜘蛛。无论如何，您都会让一些人点击链接，但无法避免好奇心。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T09:17:11.067

如果蜘蛛很好，您可以通过它的用户代理使用现有用户代理列表来检测它，如下[所示](http://www.user-agents.org/)。但是一个好的网络蜘蛛通常也遵循[robots.txt](http://en.wikipedia.org/wiki/Robots_exclusion_standard)约定

忽略 robots.txt 文件并欺骗其用户代理的机器人很可能还会使用其他方式来隐藏它们是蜘蛛。

# c# - .NET 中 Xml 序列化失败的场景

> ID：729172
> 
> 赞同：6
> 
> 时间：2009-04-08T09:09:54.067
> 
> 标签：c#, .net, xml-serialization

我想知道 .NET 中 xml 序列化可能失败的最常见场景。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T09:15:33.490

我主要想到`XmlSerializer`这里：

*   它仅限于树状数据；它无法处理完整的对象图
*   它仅限于公共成员，公共课程
*   `object`它对成员真的没什么用
*   它在泛型方面有一些弱点
*   像许多序列化程序一样，它不会触及集合上的实例属性（首先是不好的做法）
*   对于大数据，xml 并不总是一个好的选择（尤其是对于性能而言）
*   需要公共无参数构造函数

`DataContractSerializer`解决了其中一些问题，但有其自身的局限性：

*   它无法处理属性中的值
*   需要 .NET 3.0（所以在 2.0 中用处不大）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T09:20:11.763

无法轻松序列化泛型集合。

查看另一个问题：[C# XML Serialization Gotchas](https://stackoverflow.com/questions/67959/c-xml-serialization-gotchas)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T09:17:27.370

根据序列化程序，循环引用可能不起作用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-22T23:38:06.987

对我来说，使用 shadows 关键字也破坏了序列化和反序列化，因为阴影会导致该属性的新实现存在，使其与正确重建不兼容。如果要重新键入子类的特定内容，请仅使用重载。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T09:13:58.597

`TimeSpan`对象不可序列化。`IDictionary`- 实现类型也不是可序列化的（尽管它们*可以*通过一些手动按摩来序列化）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T09:18:13.500

AFAIK，自.NET 2.0 以来，标记为 [Obsolete] 的类不会被 XmlSerializer 序列化

# visual-c++ - 如何在命令行中构建 vc++ 文件

> ID：729187
> 
> 赞同：2
> 
> 时间：2009-04-08T09:11:59.630
> 
> 标签：visual-c++, mfc, visual-c++-6

如何在命令行中构建用 VC++ 开发的项目我不是 Visual Studio（2003 或 2005 或 2008）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T09:22:07.640

我可能没有完全理解您的问题，但是使用 devenv.exe 的 /build 参数将使您能够从命令行构建解决方案。

# html - 在 IE 中选择框不在行中

> ID：729193
> 
> 赞同：0
> 
> 时间：2009-04-08T09:14:05.380
> 
> 标签：html, css, layout

好的，真的不想问这个问题，因为它应该是一个非常简单的解决方案，但我花了几个小时试图解决它无济于事。我有一个带有文本框的网页，然后是一个选择下拉菜单。在 Firefox 和 chrome 中，它们彼此相邻排列，但在 IE 中，选择框比文本框高。没有 CSS 应用于此选择框或文本框。

[![图片](https://i.stack.imgur.com/e1gNu.png)](https://i.stack.imgur.com/e1gNu.png)

这是一个 aspx 页面，为此生成的 HTML 源代码是：

```
<label for="ctl00_main_primaryEmail" id="ctl00_main_primaryEmailLabel">Primary Email: </label>
<input name="ctl00$main$primaryEmail" type="text" id="ctl00_main_primaryEmail" />
<select name="ctl00$main$acceptedDomainsDropDownList" id="ctl00_main_acceptedDomainsDropDownList">
            <option value="domain.com">domain.com</option>
            <option value="doamin1.com">domain1.com</option>
            <option value="domain2.com">domain2.com</option>
            <option value="domain3.com">domain3.com</option>
        </select> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T09:27:30.777

您是否使用任何 CSS 来重置所有标签的边距和填充？使用以下内容开始样式表非常有用：

```
 *,html {
    margin: 0;
    padding: 0;
    } 
```

这消除了浏览器（即 IE）之间的许多呈现不一致以及在实际需要的地方提供填充/边距所需的额外 CSS 往往是最小的。有了这个“重置”规则，这些框在 IE 中排成一行（测试了 6 和 7），尽管不同默认字体大小的问题仍然存在：

[替代文字 http://www.mikrogroove.com/stackoverflow/textbox_selectbox_alignment.gif](http://www.mikrogroove.com/stackoverflow/textbox_selectbox_alignment.gif)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T14:35:21.973

事实证明这个问题与 CSS 相关。它是深埋在蓝图库的 IE 样式表中的选择元素的边框设置，因此不会出现在 firebug 中。对于遇到它的任何其他人，它的这个 CSS 用于选择元素

```
margin : 0.5em 0px 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T09:24:35.963

我已经尝试了以下代码。在 IE7 中进行测试时，这完全符合。

```
<input type="text">

<select>
  <option>option1</option>
  <option>option2</option>
</select> 
```

我的猜测是来自父元素（`body`, `form`, 父类）的一些 CSS 样式被应用到这些元素中的一个或两个，但是没有看到源代码，这很难判断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T09:16:08.043

使用表格进行布局可能会有所帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T09:29:04.237

我建议将您的表单放在一些周围的标记中。我通常使用定义列表，所以标记类似于

```
<dl>
    <dt>
        <label for="ctl00_main_primaryEmail" id="ctl00_main_primaryEmailLabel">Primary Email: </label>
    </dt>
    <dd>
        <input name="ctl00$main$primaryEmail" type="text" id="ctl00_main_primaryEmail" />
    </dd>
    <dt style="display: none;">
        <label for="ctl00_main_acceptedDomainsDropDownList">Accepted Domains</label>
    </dt>
    <dd>
        <select name="ctl00$main$acceptedDomainsDropDownList" id="ctl00_main_acceptedDomainsDropDownList">
            <option value="exchange.samcogan.com">exchange.samcogan.com</option>
            <option value="doamin1.com">domain1.com</option>
            <option value="domain2.com">domain2.com</option>
            <option value="domain3.com">domain3.com</option>
        </select>
    </dt>
</dl> 
```

然后您可以浮动/定位 dt 和 dd 元素以显示在单个水平行中。

这种方法，无论您使用 dl、ul 还是其他方法，通常都能提供更好的定位。

# java - 用于签署和加密文件的客户端-服务器解决方案

> ID：729195
> 
> 赞同：0
> 
> 时间：2009-04-08T09:14:38.890
> 
> 标签：java, encryption, digital-signature

我正在寻找一种解决方案来执行文件加密和签名。这将在客户端完成，在服务器端进行签名检查和解密。

一些细节：

*   这应该适用于任何类型的文件（签名应该“附加”到文件中，而不是像 PDF 那样在文件中）
*   至少服务器端应该是基于 Java 的（客户端可以是 Java 小程序）

编辑：客户部分确实是这里更大的问题。虽然服务器端可以使用现有的库来实现，但客户端应该是现有的应用程序（即使是商业应用程序）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T09:19:58.643

[Cryptix 项目](http://www.cryptix.org/)是一个开源的 java PGP 库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-15T18:05:39.373

然后，您需要在客户端使用 PGP 或类似的东西。有对消息和/或文件签名和验证签名的标准，当然也有商业和免费产品。我建议在客户端上使用 PGP，您可以查找用于 Java 的 PGP 库以在服务器上使用，或者您可以查看 PGP 如何包装数据以模拟它（毕竟，签署数据是一个标准并且有据可查的程序，尽管很麻烦）。

Java的[Bouncy Castle](http://bouncycastle.org/java.html)库有一些 OpenPGP 支持，您可以查看它以了解它与 Windows 或任何客户端使用的 PGP 实现的兼容性如何。Cryptix 也有一些 OpenPGP 支持，但该库是为 Java 1.3 设计的，并且自 2005 年以来没有更新。我建议您使用 BC 代替。

# sql - 使用 SELECT * [except columnA] FROM tableA 排除列？

> ID：729197
> 
> 赞同：927
> 
> 时间：2009-04-08T09:15:28.297
> 
> 标签：sql, sql-server, tsql

我们都知道要从表中选择所有列，我们可以使用

```
SELECT * FROM tableA 
```

有没有办法在不指定所有列的情况下从表中排除列？

```
SELECT * [except columnA] FROM tableA 
```

我知道的唯一方法是手动指定所有列并排除不需要的列。这真的很耗时，所以我正在寻找节省时间和精力的方法，以及如果表有更多/更少的列，将来的维护。

* * *

## 回答 #1

> 赞同：523
> 
> 时间：2009-11-11T00:35:20.337

你可以这样尝试：

```
/* Get the data into a temp table */
SELECT * INTO #TempTable
FROM YourTable
/* Drop the columns that are not needed */
ALTER TABLE #TempTable
DROP COLUMN ColumnToDrop
/* Get results and drop temp table */
SELECT * FROM #TempTable
DROP TABLE #TempTable 
```

* * *

## 回答 #2

> 赞同：316
> 
> 时间：2009-04-08T09:19:58.083

不。

维护简单的最佳实践是仅指定所需的列。

至少有两个原因：

*   这使您的客户端和数据库之间的合同稳定。相同的数据，每次
*   性能，涵盖指标

编辑（2011 年 7 月）：

如果您从对象资源管理器中拖动`Columns`表的节点，它会在查询窗口中为您放置一个列的 CSV 列表，从而实现您的目标之一

* * *

## 回答 #3

> 赞同：89
> 
> 时间：2012-07-13T07:03:07.727

如果您不想手动编写每个列名，可以`Script Table As`通过右键单击*SSMS中的**表*或*视图*来使用，如下所示：

 *![在此处输入图像描述](https://i.stack.imgur.com/hjxWj.png)

*然后您将在新查询编辑器窗口*中获得整个选择查询，然后删除不需要的列，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/g1gLL.png)

**完毕**

* * *

## 回答 #4

> 赞同：81
> 
> 时间：2011-07-14T10:19:57.707

在 SQL (SQL Server) 中自动执行此操作的方法是：

```
declare @cols varchar(max), @query varchar(max);
SELECT  @cols = STUFF
    (
        ( 
            SELECT DISTINCT '], [' + name
            FROM sys.columns
            where object_id = (
                select top 1 object_id from sys.objects
                where name = 'MyTable'
            )
            and name not in ('ColumnIDontWant1', 'ColumnIDontWant2')
            FOR XML PATH('')
        ), 1, 2, ''
    ) + ']';

SELECT @query = 'select ' + @cols + ' from MyTable';  
EXEC (@query); 
```

* * *

## 回答 #5

> 赞同：51
> 
> 时间：2009-04-08T09:33:14.463

您可以创建一个包含您要选择的列的视图，然后您可以`select *`从视图中...

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2019-11-04T20:56:15.377

像 BigQuery 这样的现代 SQL 方言提出了一个很好的解决方案。

```
SELECT * EXCEPT(ColumnNameX, [ColumnNameY, ...])
FROM TableA 
```

这是一种非常强大的 SQL 语法，可以避免由于表列名更改而需要一直更新的一长列列。而目前的SQL Server实现中缺少这个功能，很可惜。希望有一天，Microsoft Azure 对数据科学家更加友好。

数据科学家喜欢快速选择缩短查询并删除一些列（由于重复或任何其他原因）。

[https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#select-modifiers](https://cloud.google.com/bigquery/docs/reference/standard-sql/query-syntax#select-modifiers)

* * *

## 回答 #7

> 赞同：34
> 
> 时间：2010-04-13T09:58:55.330

是的，这是可能的（但不推荐）。

```
CREATE TABLE contact (contactid int, name varchar(100), dob datetime)
INSERT INTO contact SELECT 1, 'Joe', '1974-01-01'

DECLARE @columns varchar(8000)

SELECT @columns = ISNULL(@columns + ', ','') + QUOTENAME(column_name)
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'contact' AND COLUMN_NAME <> 'dob'
ORDER BY ORDINAL_POSITION

EXEC ('SELECT ' + @columns + ' FROM contact') 
```

**代码说明**：

1.  声明一个变量来存储一个逗号分隔的列名列表。这默认为 NULL。
2.  使用系统视图来确定表中列的名称。
3.  用于`SELECT @variable = @variable + ... FROM`连接列名。这种类型`SELECT`不返回结果集。这可能是未记录的行为，但适用于 SQL Server 的每个版本。作为替代方案，您可以使用`SET @variable = (SELECT ... FOR XML PATH(''))`连接字符串。
4.  仅当这不是第一列名称时，才使用该`ISNULL`函数添加逗号。使用该`QUOTENAME`函数支持列名中的空格和标点符号。
5.  使用该`WHERE`子句隐藏我们不想看到的列。
6.  使用`EXEC (@variable)`，也称为*动态 SQL*，在运行时解析列名。这是必需的，因为我们在编译时不知道列名。

* * *

## 回答 #8

> 赞同：20
> 
> 时间：2009-04-08T09:21:31.883

就像其他人所说的那样，没有办法做到这一点，但是如果您使用的是 Sql Server，我使用的一个技巧是将输出更改为逗号分隔，然后执行

```
select top 1 * from table 
```

并从输出窗口中剪切整个列列表。然后，您可以选择您想要的列，而无需全部输入。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2009-04-08T12:37:57.077

基本上，你不能做你想做的事——但你可以得到正确的工具来帮助你让事情变得更容易。

如果您查看 Red-Gate 的[SQL Prompt](http://www.red-gate.com/products/SQL_Prompt/index.htm)，您可以键入“SELECT * FROM MyTable”，然后将光标移回“*”后面，然后点击 <TAB> 展开字段列表，并删除您的那几个字段不需要。

这不是一个完美的解决方案 - 但一个非常好的解决方案！:-) 太糟糕了 MS SQL Server Management Studio 的 Intellisense 仍然不够智能，无法提供此功能.......

马克

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2009-04-08T09:19:00.643

不，没有办法做到这一点。如果您的情况可行，也许您可​​以创建自定义视图

**编辑**可能是如果您的数据库支持执行动态 sql，您可以编写一个 SP 并将您不想看到的列传递给它，让它动态创建查询并将结果返回给您。我认为这至少在 SQL Server 中是可行的

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2017-10-16T15:58:24.590

```
DECLARE @SQL VARCHAR(max), @TableName sysname = 'YourTableName'

SELECT @SQL = COALESCE(@SQL + ', ', '') + Name 
FROM sys.columns
WHERE OBJECT_ID = OBJECT_ID(@TableName)
AND name NOT IN ('Not This', 'Or that');

SELECT @SQL = 'SELECT ' + @SQL + ' FROM ' + @TableName

EXEC (@SQL) 
```

UPDATE:

You can also create a stored procedure to take care of this task if you use it more often. In this example I have used the built in [STRING_SPLIT()](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql?view=sql-server-2017) which is available on SQL Server 2016+, but if you need there are pleanty of examples of how to create it manually on SO.

```
CREATE PROCEDURE [usp_select_without]
@schema_name sysname = N'dbo',
@table_name sysname,
@list_of_columns_excluded nvarchar(max),
@separator nchar(1) = N','
AS
BEGIN
 DECLARE 
 @SQL nvarchar(max),
 @full_table_name nvarchar(max) = CONCAT(@schema_name, N'.', @table_name);

 SELECT @SQL = COALESCE(@SQL + ', ', '') + QUOTENAME([Name])
 FROM sys.columns sc
 LEFT JOIN STRING_SPLIT(@list_of_columns_excluded, @separator) ss ON sc.[name] = ss.[value]
 WHERE sc.OBJECT_ID = OBJECT_ID(@full_table_name, N'u')
 AND ss.[value] IS NULL;

 SELECT @SQL = N'SELECT ' + @SQL + N' FROM ' + @full_table_name;
 EXEC(@SQL)
END 
```

And then just:

```
EXEC [usp_select_without] 
@table_name = N'Test_Table',
@list_of_columns_excluded = N'ID, Date, Name'; 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2010-05-06T19:03:29.830

总之你不能这样做，但我不同意上面的所有评论，有“一些”场景你可以合法地使用 * 当你创建一个嵌套查询以便从整个列表中选择一个特定范围时（例如分页）当您在内部完成时，为什么要在外部选择语句上指定每一列？

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2011-08-30T12:16:06.323

如果您使用的是 SQL Server Management Studio，请执行以下操作：

1.  输入您想要的表格名称并选择它
2.  按`Alt`+`F1`
3.  o/p 显示表中的列。
4.  选择所需的列
5.  复制并粘贴到您的选择查询中
6.  触发查询。

享受。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2010-05-19T07:55:21.363

在 SQL Management Studio 中，您可以在对象资源管理器中展开列，然后将`Columns`树项拖到查询窗口中以获取以逗号分隔的列列表。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2019-11-12T09:02:12.387

如果您想排除敏感的大小写列，例如密码，我这样做是为了隐藏值：

`SELECT * , "" as password FROM tableName;`

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2011-03-24T12:48:36.170

> 有没有办法在不指定所有列的情况下从表中排除列？

以通常的方式使用声明性 SQL，不。

我认为您提出的语法是值得的和好的。事实上，关系数据库语言“Tutorial D”具有非常相似的语法，其中关键字`ALL BUT`后跟一组属性（列）。

但是，SQL`SELECT *`已经受到了很多批评（@Guffa 的回答是一个典型的反对意见），所以我认为`SELECT ALL BUT`不会很快进入 SQL 标准。

我认为最好的“解决方法”是创建一个`VIEW`仅包含您想要的列的列`SELECT * FROM ThatView`。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2014-05-21T13:49:16.097

如果我们谈论的是过程，它使用这个技巧来生成一个新的查询并**立即执行**它：

```
SELECT LISTAGG((column_name), ', ') WITHIN GROUP (ORDER BY column_id)
INTO var_list_of_columns
FROM ALL_TAB_COLUMNS
WHERE table_name = 'PUT_HERE_YOUR_TABLE'
AND column_name NOT IN ('dont_want_this_column','neither_this_one','etc_column'); 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2009-04-08T09:19:23.637

我不知道有任何数据库支持这个（SQL Server、MySQL、Oracle、PostgreSQL）。它绝对不是 SQL 标准的一部分，所以我认为你必须只指定你想要的列。

您当然可以动态构建 SQL 语句并让服务器执行它。但这为 SQL 注入开辟了可能性。

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2016-06-30T12:37:00.037

解决此问题的最佳方法是使用视图，您可以使用所需列创建视图并从中检索数据

```
example

mysql> SELECT * FROM calls;
+----+------------+---------+
| id | date       | user_id |
+----+------------+---------+
|  1 | 2016-06-22 |       1 |
|  2 | 2016-06-22 |    NULL |
|  3 | 2016-06-22 |    NULL |
|  4 | 2016-06-23 |       2 |
|  5 | 2016-06-23 |       1 |
|  6 | 2016-06-23 |       1 |
|  7 | 2016-06-23 |    NULL |
+----+------------+---------+
7 rows in set (0.06 sec)

mysql> CREATE VIEW C_VIEW AS
    ->     SELECT id,date from calls;
Query OK, 0 rows affected (0.20 sec)

mysql> select * from C_VIEW;
+----+------------+
| id | date       |
+----+------------+
|  1 | 2016-06-22 |
|  2 | 2016-06-22 |
|  3 | 2016-06-22 |
|  4 | 2016-06-23 |
|  5 | 2016-06-23 |
|  6 | 2016-06-23 |
|  7 | 2016-06-23 |
+----+------------+
7 rows in set (0.00 sec) 
```

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2016-02-15T11:39:58.857

Postgres sql 有办法做到这一点

请参考： [http ://www.postgresonline.com/journal/archives/41-How-to-SELECT-ALL-EXCEPT-some-columns-in-a-table.html](http://www.postgresonline.com/journal/archives/41-How-to-SELECT-ALL-EXCEPT-some-columns-in-a-table.html)

信息模式黑客方式

```
SELECT 'SELECT ' || array_to_string(ARRAY(SELECT 'o' || '.' || c.column_name
        FROM information_schema.columns As c
            WHERE table_name = 'officepark' 
            AND  c.column_name NOT IN('officeparkid', 'contractor')
    ), ',') || ' FROM officepark As o' As sqlstmt 
```

以上针对我的特定示例表 - 生成一个看起来像这样的 sql 语句

SELECT o.officepark,o.owner,o.squarefootage FROM officepark As o

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2014-05-22T17:41:26.463

我知道这有点老了，但我刚刚遇到了同样的问题并正在寻找答案。然后我让一位高级开发人员向我展示了一个非常简单的技巧。

如果您使用的是 Management Studio 查询编辑器，请展开数据库，然后展开您从中选择的表，以便您可以看到列文件夹。

在您的选择语句中，只需突出显示上面引用的列文件夹并将其拖放到查询窗口中。它将粘贴表的所有列，然后只需从列列表中删除标识列...

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2009-04-08T09:24:07.870

好吧，一个常见的最佳实践是指定你想要的列，而不是仅仅指定 *. 因此，您应该只说明您希望您的选择返回哪些字段。

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2011-03-24T12:57:24.080

在对象资源管理器中右键单击表，选择前 1000 行

它将列出所有列而不是 *. 然后删除不需要的列。应该比自己打字快得多。

然后当你觉得这工作有点多时，获取 Red Gate 的 SQL Prompt，然后输入 ssf from tbl，转到 * 并再次单击 tab。

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2012-02-02T13:02:50.073

一位同事建议了一个不错的选择：

*   在前面的查询（生成或获取数据的地方）中执行 SELECT INTO 到表中（完成后将删除该表）。这将为您创建结构。
*   将脚本作为 CREATE 执行到新的查询窗口。
*   删除不需要的列。将剩余的列格式化为 1 行并粘贴为列列表。
*   删除您创建的表。

完毕...

这对我们帮助很大。

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2020-06-23T08:57:05.023

在 Hive Sql 中，您可以这样做：

```
set hive.support.quoted.identifiers=none;
select 
    `(unwanted_col1|unwanted_col2|unwanted_col3)?+.+`
from database.table 
```

这给了你剩下的cols

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2015-03-03T11:52:40.997

我经常在这种情况下使用的东西：

```
declare @colnames varchar(max)=''

select @colnames=@colnames+','+name from syscolumns where object_id(tablename)=id and name not in (column3,column4)

SET @colnames=RIGHT(@colnames,LEN(@colnames)-1) 
```

`@colnames`好像`column1,column2,column5`

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2015-10-01T10:19:31.947

有时同一个程序必须处理不同的数据库结构。所以我不能在程序中使用列列表来避免`select`语句中的错误。

`*`给了我所有的可选字段。我在使用前检查数据表中是否存在字段。这是我使用`*`in的原因`select`。

这就是我处理排除字段的方式：

```
Dim da As New SqlDataAdapter("select * from table", cn)
da.FillSchema(dt, SchemaType.Source)
Dim fieldlist As String = ""
For Each DC As DataColumn In DT.Columns
   If DC.ColumnName.ToLower <> excludefield Then
    fieldlist = fieldlist &  DC.Columnname & ","
   End If
  Next 
```

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2016-08-12T19:19:30.603

我知道这个问题很老，但我希望这仍然会有所帮助。答案的灵感来自[SQL Server Forums](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=24456)的讨论。您可以将此作为[存储过程](https://stackoverflow.com/a/38925973/4271117)。也可以修改为添加多个除字段。

```
DECLARE @SQL NVARCHAR(MAX)
SELECT @SQL = COALESCE(@SQL + ', ', ' ' ) + name from sys.columns where name not in ('colName1','colName2') and object_id = (Select id from sysobjects where name = 'tblName')
SELECT @SQL = 'SELECT ' + @SQL + ' FROM ' + 'tblName'
EXEC sp_executesql  @SQL 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2018-10-10T16:53:14.223

当使用视图而不是真实表格时，BartoszX 提出的答案（存储过程）对我不起作用。

这个想法和下面的代码（除了我的修复）属于 BartoszX。

为了使其适用于表和视图，请使用以下代码：

```
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[select_without]
@schema_name sysname = N'dbo',
@table_name sysname,
@list_of_columns_excluded nvarchar(max),
@separator nchar(1) = N','
AS
BEGIN
 DECLARE 
 @SQL nvarchar(max),
 @full_table_name nvarchar(max) = CONCAT(@schema_name, N'.', @table_name);

 SELECT @SQL = COALESCE(@SQL + ', ', '') + QUOTENAME([Name])
 FROM sys.columns sc
 LEFT JOIN STRING_SPLIT(@list_of_columns_excluded, @separator) ss ON sc.[name] = ss.[value]
 WHERE sc.OBJECT_ID = OBJECT_ID(@full_table_name)
 AND ss.[value] IS NULL;

 SELECT @SQL = N'SELECT ' + @SQL + N' FROM ' + @full_table_name;
 EXEC(@SQL)
END
GO 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2014-03-19T15:16:38.077

**在 SSMS 中，使用IntelliSense**和**Aliasing**有一种更简单的方法。尝试这个

1.  在文本编辑器中右键单击并确保**IntelliSense**已启用。
2.  使用别名 [SELECT **t.*** FROM tablename t] 键入查询。
3.  转到文本**t.***并删除*****，SSMS 将自动列出**f**别名表的列。

然后，您可以快速**仅指定您想要的列，** 而无需使用 SSMS 将选择写入另一个脚本，然后执行更多复制/粘贴操作。我经常用这个。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2011-05-12T15:43:56.307

这样做会不会更简单：

```
sp_help <table_name> 
```

-单击“Column_name”列>复制>粘贴（创建垂直列表）到新查询窗口中，只需在每个列值前面键入逗号...注释掉您不想要的列...少得多键入比此处提供的任何代码并且仍然易于管理。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-08-03T19:36:27.490

这不会节省从数据库加载的时间。但是，您总是可以在它所在的数组中取消设置您不想要的列。我在一个表中有几列，但不想要一个特定的列。我懒得把它们都写在 SELECT 语句中。

```
$i=0;
$row_array = array();

while($row = mysqli_fetch_assoc($result)){

  $row_array[$i]=$row;
  unset($row_array[$i]['col_name']);
  $i++;
} 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2012-03-27T00:21:30.890

您可以从 devart.com 获得 SQL Complete，它不仅像 Red Gate 的 SQL Prompt 那样扩展 * 通配符（如 cairnz 的回答中所述），还提供了一个带有复选框的列选择器下拉列表，您可以在其中检查所有您想要在选择列表中的列，它们将自动为您插入（如果您随后取消选中某个列，它将自动从选择列表中删除）。

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2015-05-02T10:17:01.000

我这样做了，它工作得很好（5.5.41版）：

```
# prepare column list using info from a table of choice
SET @dyn_colums = (SELECT REPLACE(
GROUP_CONCAT(`COLUMN_NAME`), ',column_name_to_remove','') 
FROM `INFORMATION_SCHEMA`.`COLUMNS` WHERE 
`TABLE_SCHEMA`='database_name' AND `TABLE_NAME`='table_name');

# set sql command using prepared columns
SET @sql = CONCAT("SELECT ", @dyn_colums, " FROM table_name");

# prepare and execute
PREPARE statement FROM @sql;
EXECUTE statement; 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2021-03-04T16:55:35.073

轻松解决。在 SSMS 中，找到您的表，右键单击它并 Script Table As，然后选择 To。查询将与列出的每一列一起写出。注释掉或删除您不想要的列。忽略列的非常快速和简单的解决方案。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2021-08-09T13:51:35.957

```
DECLARE @Columns NVARCHAR(MAX)='',@SQL NVARCHAR(MAX)
SELECT @Columns=CASE WHEN @Columns='' THEN name ELSE @Columns+','+name END  
FROM sys.columns 
WHERE object_ID=(sELECT id FROM sysobjects WHERE name='TheTableName') and NAME!='WithoutColumnName'

SELECT @SQL='SELECT '+@Columns+' FROM dbo.TheTableName'
EXEC sp_execute @SQL 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2021-09-13T08:25:32.693

当然，正如他们所说的那样，您需要使用动态 sql 来实现。这是我的实现：

```
SET NOCOUNT ON

DECLARE @Table NVARCHAR(100) = 'Table' --Table to Select
DECLARE @ExcludeColumns AS TABLE (ColumnName VARCHAR(255))
INSERT INTO @ExcludeColumns VALUES ('ExcludedColumn1'),('ExcludedColumn2') --Excluded columns

DECLARE @SelectedColumns NVARCHAR(MAX) = ''
SELECT 
    @SelectedColumns += CASE WHEN LEN(@SelectedColumns) = 0 THEN '' ELSE ',' END + '[' + COLUMN_NAME + ']' 
FROM 
    INFORMATION_SCHEMA.COLUMNS 
WHERE 
    TABLE_NAME = @Table AND COLUMN_NAME NOT IN (SELECT ColumnName FROM @ExcludeColumns)

DECLARE @sqlStatement NVARCHAR(MAX) = 'SELECT ' + @SelectedColumns + ' FROM [' + @Table + ']'
PRINT @sqlStatement
EXEC (@sqlStatement) 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2020-08-25T04:02:35.207

以下是生成要在查询中使用的列列表（不是自动执行查询，因为没有指定）：

```
SELECT 
    GROUP_CONCAT(
        CONCAT('`', `COLUMN_NAME`, '`')
        SEPARATOR ',\n'
    ) AS `cols`
FROM information_schema.`COLUMNS`
WHERE `TABLE_SCHEMA` = 'db'
AND `TABLE_NAME` = 'table_name_here'
AND `COLUMN_NAME` NOT IN ('exclude_col1', 'exclude_col2') 
```

将产生：

```
`included_col1`,
`included_col2`,
`included_col3` 
```

然后，您可以复制它以在查询中使用：

```
SELECT
    `included_col1`,
    `included_col2`,
    `included_col3`
FROM db.table_name_here 
```

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2016-02-13T22:58:02.360

如果这里有人像我一样使用 MySql：

```
CREATE TABLE TempTable AS SELECT * FROM #YourTable; 

ALTER TABLE TempTable 
DROP COLUMN #YourColumn; 

SELECT * FROM TempTable; 
DROP TABLE TempTable; 
```

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2021-03-29T16:03:50.653

尝试这个...

```
=QUERY(TRANSPOSE(QUERY('Data'!A1:AH,"SELECT * ",1)),"SELECT * WHERE Col1 <> 'Column 
 name'",1) 
```

* * *

## 回答 #41

> 赞同：-1
> 
> 时间：2009-04-08T09:24:06.293

不，没有任何方法可以做到这一点，也没有充分的理由这样做。

在选择您永远不应该使用的数据时`*`，您应该始终指定您想要的字段。原因是您希望查询工作相同，即使您稍后将另一个字段添加到表中。您还可以指定结果中字段的顺序，以便重新排列表中的字段不会更改结果。

如果可能的话，当然同样适用`* except`。

* * *

## 回答 #42

> 赞同：-1
> 
> 时间：2013-05-01T04:01:12.460

如果您使用的是 mysql-workbench，您可以右键单击表资源管理器，然后单击“发送到 SQL 编辑器->选择所有语句”。

它会发送一条类似“Select col1, col2,... from tablename”的语句。

然后删除那些你不需要的。

* * *

## 回答 #43

> 赞同：-1
> 
> 时间：2009-07-31T17:20:48.050

根据表格的大小，您可以将其导出到 Excel 中并将其转置为一个新表格，其中原始表格的列将是新表格中的行。然后将其带回您的 SQL 数据库并根据条件选择行并将它们插入到另一个新表中。最后将这个较新的表导出到 Excel 并进行另一个转置以获得所需的表并将其带回 SQL 数据库。

不确定是否可以在 SQL 数据库中完成转置，如果可以，那就更容易了。

杰夫

* * *

## 回答 #44

> 赞同：-3
> 
> 时间：2016-03-12T09:27:18.700

您可以使用 REGEX 列规范。

以下查询选择除 ds 和 hr SELECT `(ds|hr)?+.+`FROM sales之外的所有列

* * *

## 回答 #45

> 赞同：-8
> 
> 时间：2019-08-16T14:12:28.667

如果您使用的是 PHP，您只需执行查询，然后您可以取消设置特定元素：

```
$sql = "SELECT * FROM ........ your query";
    $result = $conection->query($sql); // execute your query
    $row_cnt = $result->num_rows;   

if ($row_cnt > 0) {
        while ($row = $result->fetch_object()) {
            unset($row->your_column_name); // Exclude column from your fetch
            $data[] = $row;
}
echo json_encode($data); // or whatever 
```

# wpf - 右对齐 wpf 扩展器标题中的项目

> ID：729200
> 
> 赞同：3
> 
> 时间：2009-04-08T09:15:56.157
> 
> 标签：wpf, expander

我想让扩展器标题中的一些文本左对齐，然后一些文本右对齐。我已经找到了如何将标题扩展到容器的宽度，并认为我可以简单地添加一个停靠面板并将第二个文本块设置为 Dock Right，但这似乎没有帮助。有什么解决办法吗？

```
<Expander>
  <Expander.Header>
    <DockPanel
      Width="{Binding
        RelativeSource={RelativeSource
        Mode=FindAncestor,
        AncestorType={x:Type Expander}},
        Path=ActualWidth}">
      <TextBlock
        Text="I am header text…"
        Background="LightBlue"
      />
      <TextBlock DockPanel.Dock="Right"
        Text="I am header text…"
        Background="Yellow"
      />
    </DockPanel>
  </Expander.Header>
</Expander> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-27T04:06:26.953

这对我有用。这也将箭头向右移动，因为它正在恢复标题的顺序并重新恢复内容的顺序。

```
<Expander FlowDirection="RightToLeft" >  
  <Expander.Header>
    <DockPanel FlowDirection="LeftToRight" 
          HorizontalAlignment="{Binding HorizontalAlignment,
                          RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ContentPresenter}},
                          Mode=OneWayToSource}"
          LastChildFill="True">
      <!-- Change the look inside header here -->

      <Label Content="Header" Background="Red" />
    </DockPanel>
  </Expander.Header>

  <Expander.Content>
    <!-- Change the look inside content here, by default Expander.Content is stretched -->
    <DockPanel FlowDirection="LeftToRight" LastChildFill="True">
      <Label Content="Left" Background="Aquamarine" />
      <Label Content="Fill" Background="Plum" />
    </DockPanel>
  </Expander.Content>
</Expander> 
```

（[来源](http://social.msdn.microsoft.com/Forums/vstudio/en-US/3ec14d80-027a-4470-a775-bcda65048e66/expander-with-a-rightaligned-dropdown-arrow-while-keeping-the-rest-properly-leftaligned)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T09:30:08.433

尝试将`TextAlignment`属性设置为 right 并将属性设置为在s`HorizontalAlignment`上伸展。`TextBlock`这应该有助于我想。

如果您使用颜色不是为了演示目的，并且您确实希望整个元素右对齐，那么您可能需要考虑将`LastChildFill`属性设置`DockPanel`为 false。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T15:27:21.897

不幸的是，这与默认扩展器模板的问题有关，该模板将标题的水平对齐设置为向左而不是拉伸。让它工作的最好方法是创建一个正确设置它的新模板。以下是更多信息的链接：

[http://silverlight.net/forums/p/57142/145801.aspx#145801](http://silverlight.net/forums/p/57142/145801.aspx#145801)

它适用于 Silverlight，但也适用于 wpf。另一种方法是将上面的停靠面板宽度绑定到包含扩展器的元素的实际宽度。这不是一个很好的解决方案，但它有效。您需要为宽度创建一个值转换器。这是一些代码：

```
[ValueConversion(typeof(double), typeof(double))]
public class OffsetDoubleConverter : IValueConverter
{
    #region IValueConverter Members

    public double Offset { get; set; }
    public bool KeepPositive { get; set; }

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        double number = (double)value + Offset;
        if ((KeepPositive) && (number < 0.0))
        {
            number = 0.0;
        }
        return number;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        double number = (double)value - Offset;
        if ((KeepPositive) && (number < 0.0))
        {
            number = 0.0;
        }
        return number;
    }

    #endregion
} 
```

在你的 xaml 中：

```
<!-- create a ref to your namespace -->
xmlns:loc="clr-namespace:YourNamespace"

...

<Window.Resources>
<loc:OffsetDoubleConverter x:Key="ExpanderConverter" Offset="-208.0" KeepPositive="True"/>
</Window.Resources>

...

<DockPanel Width="{Binding ElementName=ADifferentElement, Path=ActualWidth,
                   Converter={StaticResource ExpanderConverter}}">
... 
```

同样，这不是最好的解决方案，但它应该可以工作。需要注意的一点是，如果将偏移值设置得太小并将其绑定到扩展器的父级，则可以让 Visual Studio 挂起，因为父级的实际宽度将基于扩展器的宽度。

如果这个实现不是很清楚，请告诉我。同样，我真的建议只为扩展器使用自定义模板。您可以获取默认模板，只需稍加修改即可使其正常工作。如果你愿意，我也可以发布。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-19T18:52:34.863

我通过在 Expander.Header 部分添加一个网格并将其宽度设置为其祖先并拉伸它来解决这个问题。现在网格按预期工作。

```
 <Expander HorizontalAlignment="Stretch"  VerticalAlignment="Stretch" >
            <Expander.Header>
                <Grid HorizontalAlignment="Stretch" Width="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Expander}}, Path=ActualWidth}">
                    <Grid.ColumnDefinitions>
                         ...
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                         ...
                    </Grid.RowDefinitions>
                    <TextBlock Text="{Binding _header}" TextAlignment="Center" HorizontalAlignment="Stretch" />
                </Grid>
            </Expander.Header>
    </Expander> 
```

# java - Spring Security：UserDetailsManager 接口是做什么用的？和更多！

> ID：729203
> 
> 赞同：7
> 
> 时间：2009-04-08T09:16:10.697
> 
> 标签：java, spring-security

我对[UserDetailsManager](http://static.springframework.org/spring-security/site/apidocs/index.html)界面很好奇。参考指南中没有提到它，在 JavaDoc 中它被描述为：

> [UserDetailsS​​ervice](http://static.springframework.org/spring-security/site/apidocs/org/springframework/security/userdetails/UserDetailsService.html)的扩展， 它提供了创建新用户和更新现有用户的能力。

在实现[UserDetailsManager](http://static.springframework.org/spring-security/site/apidocs/index.html)接口时，您必须实现它自己的五个方法，其中一个方法继承自它扩展的 UserDetailsS​​ervice。

这些方法是：createUser、updateUser、deleteUser、changePassword、userExists 和继承的方法 loadUserByUsername。

在 Spring Security 框架 v2.0.4 中有两个 UserDetailsManager 的具体实现：[JdbcUserDetailsManager](http://static.springframework.org/spring-security/site/apidocs/org/springframework/security/userdetails/jdbc/JdbcUserDetailsManager.html)和[LdapUserDetailsManager](http://static.springframework.org/spring-security/site/apidocs/org/springframework/security/userdetails/ldap/LdapUserDetailsManager.html)。

接口和具体实现均由 Luke Taylor 实现。

似乎 Spring Security 框架从不使用具体的实现。

我的结论是，该界面纯粹是作为一个方便的界面，框架的用户可能会或可能不会决定使用它。也许有人认为稍后会存在更具体的实现并为框架用户完成一些工作？

我正在寻找更多信息。为了使信息有价值，它必须直接或**间接**（我想这很可能）来自对框架开发过程有洞察力的人。其他任何人都可以猜测，就像我在上面所做的那样。

如果它只是一个方便的界面。**是否还有更多没有出现在参考指南中的接口和类？**我有兴趣知道，因为它可能在开发过程中对我有所帮助。

查看所有接口和类以查看框架中实际使用了哪些接口和类有点繁琐，如果涉及反射，也可能容易出错（因此调用了我的 IDE 无法识别的调用）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T16:38:01.160

你的猜测是正确的。根据[最初的功能请求](http://jira.springframework.org/browse/SEC-513)，它被添加“*因为它是一个非常普遍的请求功能，并且通过扩展现有的接口和类来实现相当简单。* ”

[一直在谈论](http://forum.springsource.org/showthread.php?t=55995)创建一个单独的项目来填充这个界面，但还没有站稳脚跟。

# jquery - jquery 和正则表达式

> ID：729205
> 
> 赞同：0
> 
> 时间：2009-04-08T09:16:12.957
> 
> 标签：jquery, regex

我的页面上有文本框。我想验证这个文本框。

规则是：

1.  文本框不应超过 20 个字符
2.  只允许像 / - # & ^ 空格这样的字母数字和字符

如何以最佳方式使用 jquery

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T09:41:02.570

适当的正则表达式是：

```
^[a-zA-Z0-9/#&^\- ]{0,20}$
```

问问自己是否`A-Z`正确。您可能希望允许更多（例如重音字符）。

使用[JavaScript Unicode 块范围创建](http://kourge.net/projects/regexp-unicode-block)器来容纳更广泛的允许输入集的正则表达式。[使用方便的Javascript RegExp Unicode Character Class Tester](http://hamstersoup.com/javascript/regexp_character_class_tester.html)检查允许的字符。

与往常一样，在服务器端仔细检查表单值。依赖 JavaScript 进行所有输入检查是危险的。

对于 jQuery，请查看[Valitator 插件](http://docs.jquery.com/Plugins/Validation/Validator)，并使用以下代码：

```
$.validator.addMethod(
  "yourFormField", 
  function(value) { 
    return /^[a-zA-Z0-9/#&^\- ]{0,20}$/.test(value); 
  }, 
  "Please enter a valid value."
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T09:59:26.800

^[a-zA-Z0-9/#&^-]{0,20}$

# qt - 为什么 QCalendarWidget.setDateTextFormat(QDate(), ...) 不起作用？

> ID：729219
> 
> 赞同：2
> 
> 时间：2009-04-08T09:19:16.507
> 
> 标签：qt, pyqt

我正在使用 PyQt 4.4.3。

我有这段代码，它应该清除所有格式`QCalendarWidget`：

```
cal.setDateTextFormat(QDate(), QDateTextFormat()) 
```

根据[文档，](http://doc.trolltech.com/4.4/qcalendarwidget.html#setDateTextFormat)这应该有效：

> **`QCalendarWidget::setDateTextFormat(QDate &date, QTextCharFormat &format)`**
> 如果 date 为`null`，则清除所有日期格式。
> 
> **`QDate::QDate()`**
> 构造一个`null`日期。空日期无效。

我试过缩小这样的问题：

```
QDate().isNull()
True
cal.dateTextFormat()
{PyQt4.QtCore.QDate(-4713, 1, 1): PyQt4.QtGui.QTextCharFOrmat object} 
```

显然，`QDate()`被解释为在 -4713 年，而不是`null`。

知道我需要改变什么才能让它工作吗？

*编辑：*问题是，使用此方法未重置日历。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T10:33:17.140

QDate(-4713, 1, 1) 与 null 相同，

我认为这是设置日历`QCalendar`默认值的方法。正在返回具有所有特殊格式和（我认为）默认格式的地图。`QTextCharFormat``QCalendar::dateTextFormat()`

或者可能是一个错误，通知巨魔你的问题。

# sql - 无需使用子查询即可返回计数的简单 SQL

> ID：729224
> 
> 赞同：1
> 
> 时间：2009-04-08T09:21:29.997
> 
> 标签：sql, postgresql

我试图通过单个 SQL 语句获取参加课程的学生人数，但不使用子查询。到目前为止，我只能弄清楚如何使用子查询来做到这一点。还有其他方法吗？

考虑以下数据库设置：

```
创建表学生（id 整数非空主键）；
创建表 course_enrolment（学生整数不为空引用学生，课程整数不为空）；
插入学生价值观（1）；
插入学生价值观（2）；
插入学生价值观（3）；
插入 course_enrolment 值（2,20）；
插入 course_enrolment 值（2,30）；
插入 course_enrolment 值（3,10）；

```

我想获得参加课程的学生人数。在这种情况下，它是 2。

我可以使用子查询轻松实现这一点：

> SELECT COUNT(*) FROM (SELECT DISTINCT STUDENT FROM COURSE_ENROLMENT) 作为数据；

我想在不使用子查询的情况下获得计数。

我正在使用 Postgresql 8.3，但正在寻找与供应商无关的解决方案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T09:24:38.977

这个怎么样：

```
SELECT  course, COUNT(DISTINCT student)
FROM    course_enrolment
GROUP BY course 
```

这为每门课程的学生提供。如果您只想注册任何课程的总人数：

```
SELECT  COUNT(DISTINCT student)
FROM    course_enrolment 
```

我相信这都是 ANSI 标准的 SQL，所以应该在大多数地方工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T09:25:20.410

我不知道 postgres，但在 SQL Server 上：

```
SELECT COUNT(DISTINCT STUDENT) FROM COURSE_ENROLMENT 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T09:29:03.660

我对 Postgresql 了解不多，但这就是我将如何做 MS SQL Server ......

```
select count(distinct student)
From course_enrolment 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T09:24:46.277

```
SELECT COUNT(DISTINCT STUDENT) FROM COURSE_ENROLMENT 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T09:27:26.677

这是按课程选择学生：

```
select course, count(*) as students 
from course_enrolment
group by course 
```

这只是为了计算学生（希望不是糟糕的 SQL Server 特定的）

```
select count(distinct student) from course_enrolment 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T17:34:06.833

真正的问题是你为什么不想使用子查询？

一般来说，每个人都以正确的方式回答：

```
select count(distinct student) from course_enrolment 
```

但是 8.4 之前的 PostgreSQL 中的这种类型的查询对于大量学生/课程来说会很慢。更快的方法是：

```
select count(*) from (select student from course_enrolment group by student); 
```

但它使用子查询 - 由于某种原因，您不想要。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-02-20T12:37:20.570

```
select COUNT(distinct student) from course_enrolment 
```

# .net - 从字符串“System.Int32”创建 System.Type 时出错

> ID：729243
> 
> 赞同：0
> 
> 时间：2009-04-08T09:28:21.917
> 
> 标签：.net, asp.net, telerik

在我昨晚发布（预编译）的网站上，我收到以下错误。在预编译它之前，我收到了一个编译器错误，即找不到用户控件。在另一台机器上编译并运行后，我收到以下解析器错误：

```
"Cannot create an object of type 'System.Type' from its srting representation 'System.Int32' for the 'DataType' property" 
```

是我得到的现在运行时解析器错误。有问题的标签是 telerik:RadNumericTextBox .... DataType="System.Int32"...

我再次强调，这个错误只出现在 XP SP2 上，不会出现在 Vista 和 Win7 上。我要去Telerik做一些谷歌搜索并发布日志记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T11:00:37.200

我在我的一个项目中遇到了这个问题，当我迁移到最新版本 Q1 2009 SP1 时它就消失了。

迪克

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T17:40:33.587

这个问题的根源不仅仅是 Telerik，还有 ASP.NET 无法解释字符串表示。我只是在一个没有 Telerik 的小型测试项目上尝试过这个，我得到了同样的错误。

这并不是说没有修复它，但我会很高兴看到他们是如何做到的。这很容易用两个属性来完成，一个接受一个字符串并从中获取一个类型，然后设置实际的类型属性，但这会变得混乱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-29T05:53:09.530

我的猜测是`GetType`Telerik 内部某处有一个 -type-of-resolution 失败了。如果发生这种情况，可能值得尝试将程序集名称添加到字符串中，
例如：`"System.Int32, mscorlib"`...

# python - Python 的 eval() 和 globals()

> ID：729248
> 
> 赞同：8
> 
> 时间：2009-04-08T09:30:31.363
> 
> 标签：python, eval

我正在尝试使用 eval() 执行许多函数，并且我需要为它们创建某种运行环境。文档中说您可以将全局变量作为第二个参数传递给 eval()。

但这似乎不适用于我的情况。这是简化的示例（我尝试了两种方法，声明变量 global 和使用 globals()，但都不起作用）：

### 文件*script.py*：

```
import test

global test_variable
test_variable = 'test_value'
g = globals()
g['test_variable'] = 'test_value'
eval('test.my_func()', g) 
```

### 文件*test.py*：

```
def my_func():
    global test_variable
    print repr(test_variable) 
```

我得到：

> NameError：未定义全局名称“test_variable”。

我应该怎么做才能将其传递`test_variable`给`my_func()`？假设我不能将它作为参数传递。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-08T09:32:51.280

*test_variable*在 test.py 中应该是全局的。您收到名称错误，因为您试图声明一个尚不存在的全局变量。

所以你的 my_test.py 文件应该是这样的：

```
test_variable = None

def my_func():
    print test_variable 
```

并从命令提示符运行它：

```
>>> import my_test
>>> eval('my_test.my_func()')
None
>>> my_test.test_variable = 'hello'
>>> my_test.test_variable
'hello'
>>> eval('my_test.my_func()')
hello 
```

通常，使用 eval() 和全局变量是不好的形式，因此请确保您知道自己在做什么。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T10:44:36.287

*如果我错了，请纠正我的 Python 专家。我也在学习Python。以下是我目前对`NameError`抛出异常的原因的理解。*

在 Python 中，如果不指定模块名称，则无法创建可以跨模块访问的变量（即访问模块中的全局变量，您需要在模块`test`中使用）。全局变量的范围几乎仅限于模块本身。`mod1``mod1.test``mod2`

因此，当您有以下内容时`test.py`：

```
def my_func():
    global test_variable
    print repr(test_variable) 
```

这里`test_variable`指的是`test.test_variable`（即`test_variable`在`test`模块命名空间中）。

所以设置会将变量放在`test_variable`命名空间中（因为这是您提供给 Python 解释器执行的顶级模块/脚本）。因此，这将在不同的命名空间中，而不是在需要的模块命名空间中。因此Python生成a是因为在搜索模块全局命名空间和内置命名空间后找不到变量（由于语句跳过了本地函数命名空间）。`script.py``__main__``__main__``test_variable``test``NameError``test``global`

因此，为了`eval`工作，您需要`test_variable`在`test`模块命名空间中设置`script.py`：

```
import test
test.test_variable = 'test_value'
eval('test.my_func()') 
```

有关 Python 范围和命名空间的更多详细信息，请参阅：[http ://docs.python.org/tutorial/classes.html#python-scopes-and-name-spaces](http://docs.python.org/tutorial/classes.html#python-scopes-and-name-spaces)

# vim - 如何用 Vim 高效地“制作”

> ID：729249
> 
> 赞同：19
> 
> 时间：2009-04-08T09:31:13.297
> 
> 标签：vim, plugins, makefile

我正在尝试做的似乎是一个非常基本的东西，但我找不到任何关于它的东西。我正在做一个像往常一样构建的项目：

```
project
|-- bin
|-- inc
`-- src 
```

我想使用 Vim 中包含的 make 命令制作我的项目。但每次我都必须指定`:make -C ../`. 我希望，如果当前目录中没有 Makefile 文件，请进入父目录。我已经这样做了

```
set tags+=./tags;/ 
```

在我的`.vimrc`.

此外，make 默认是丑陋的。是否有添加颜色的选项，并允许直接访问错误（如在 Emacs 中）。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-08T19:04:03.950

[对亚当所说](https://stackoverflow.com/questions/729249/how-to-efficiently-make-with-vim/731393#729291)的稍作修改：

```
 :set makeprg=[[\ -f\ Makefile\ ]]\ &&\ make\ \\\|\\\|\ make\ -C\ .. 
```

逃不掉，这是

```
 [[ -f Makefile ]] && make || make -C .. 
```

这意味着，伪代码风格

```
 if file-exists(Makefile) 
 then make
 else make -C .. 
```

This only goes one directory up. If you'd like a more general solution that will go as many directories up as necessary, you'll need to be able to search ancestor directories until a Makefile is found, and I'm not sure how to do that simply from the command line. But writing a script (in whatever language you prefer) and then calling it from your makeprg shouldn't be hard.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-09T14:16:27.610

The solution of rampion is a first step, but computed on vim load. When I load a multi tab session, the path can be inconsistent from one tab to another.

Here my solution (+ extra with tabnew).

```
fun! SetMkfile()
  let filemk = "Makefile"
  let pathmk = "./"
  let depth = 1
  while depth < 4
    if filereadable(pathmk . filemk)
      return pathmk
    endif
    let depth += 1
    let pathmk = "../" . pathmk
  endwhile
  return "."
endf

command! -nargs=* Make tabnew | let $mkpath = SetMkfile() | make <args> -C $mkpath | cwindow 10 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-08T10:02:18.480

[要回答您的第二个问题，您可以使用VIM](http://vimdoc.sourceforge.net/htmldoc/quickfix.html)中的快速修复功能浏览错误。Quickfix 将错误存储在缓冲区中，并允许您向前/向后导航它们。

您可能必须定义错误正则表达式以允许 VIM 从 Make 的输出中识别这些，但我似乎记得它开箱即用的效果相当好（我不得不修改它在 Java Ant 构建中的工作方式 -显然不适用于这里）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-09T14:22:46.147

By far the easiest solution is to have a Makefile in your src directory, which is the way that many, many projects are set up regardless of editor/IDE. You can still have a top-level Makefile that calls `make -C src`, with the rules for building in src located in src where they belong.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-10-18T16:33:19.933

Another approach can be used if you have a single makefile on project root directory:

```
project
|-- bin
|-- inc
|-- src
| Makefile 
```

With your project path in variable like `b:projectDir` it is possible to use an "autocommand" to change to that directory before start executing `:make`or `:lmake`:

```
augroup changeMakeDir
    au!
    autocmd QuickfixCmdPre *make
                \ if exists("b:projectDir") &&
                                    \ b:projectDir != expand("%:p:h") |
                    \ exe 'cd ' . b:projectDir |
                \ endif
augroup END 
```

* * *

[Projectroot plugin](https://github.com/dbakker/vim-projectroot) can be used to set `b:projectDir`; it also provides the commands to change the current directory to the project root directory:

```
augroup changeMakeDir
    au!
    autocmd QuickfixCmdPre make ProjectRootCD
augroup END 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T09:49:21.647

在你的 .vimrc 中设置 makecmd="make -C .."

# .net - 列表中命名参数的多个实例

> ID：729253
> 
> 赞同：4
> 
> 时间：2009-04-08T09:33:03.697
> 
> 标签：.net, visual-studio-2008, stored-procedures, oracle10g, ora-06550

我从 Visual Studio 2008 的服务器资源管理器执行 oracle 程序时遇到问题，

当我尝试执行一个程序时，所有输入参数都加倍！

它只发生在我的一个工作站上，我试图重新安装 oracle 产品，但它没有帮助我......

当我尝试执行该过程时，我收到以下错误消息：

```
ORA-06550: line 1, column 7:
PLS-00703: multiple instances of named argument in list
ORA-06550: line 1, column 7:
PL/SQL: Statement ignored 
```

我的数据连接类型是“Oracle 数据库”，提供者是“.NET Framework Data Provider for Oracle”。

最好的问候， Guy Bertental

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-01-14T15:15:13.803

可能是您多次添加了***相同*****的**“OracleParameter” 。请控制您的参数列表并从您的代码中**删除重复**的参数；

 **** * *

## 回答 #2

> 赞同：6
> 
> 时间：2011-04-19T06:15:50.083

`oracom.Parameters.Clear();` 之后使用 `executenonquery();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-13T05:47:47.820

VS2008 的 Service Pack 1 解决了这个问题...

# windows - Windows Server 2008（域控制器）本地用户问题

> ID：729255
> 
> 赞同：1
> 
> 时间：2009-04-08T09:33:30.997
> 
> 标签：windows, active-directory, windows-server-2008, dns

在将 Windows Server 2008 用作域控制器时，我们遇到了问题：

我们有一个应用程序使用本地 Windows 数据库来保存用户帐户。当用户在所有系统中插入用户名*Padmin*时，登录工作完美。但在 Windows Server 2008 (DC) 中找不到用户。该应用程序不接受域用户帐户。

那么有没有办法在这台机器上使用域账户作为本地账户呢？或者创建一个链接或其他东西？

谢谢，

最好的祝福。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T09:38:31.080

将计算机提升为域控制器后，它会删除所有本地帐户。不可能在 DC 上拥有本地帐户，并且不会对其进行身份验证。您必须使用域帐户。

# c# - 我正在尝试为 Unity 映射通用类型

> ID：729257
> 
> 赞同：2
> 
> 时间：2009-04-08T09:34:18.267
> 
> 标签：c#, .net, dependency-injection, unity-container

我正在尝试使用 Unity Configuration 向类属性添加依赖项，并且我尝试注入的类型是通用的。我有一个“谷歌”，发现我需要使用 '1 语法。我正在关注 David Hayden 关于验证应用程序块 BUT 的教程，而不是以编程方式注册我通过配置文件设置它的类型。

```
<typeAliases>
    <!-- Lifetime manager types -->
    <typeAlias alias="singleton" type="Microsoft.Practices.Unity.ContainerControlledLifetimeManager,Microsoft.Practices.Unity" />
    <typeAlias alias="external" type="Microsoft.Practices.Unity.ExternallyControlledLifetimeManager,Microsoft.Practices.Unity" />
    <typeAlias alias="IValidator`1" type="MySerivice.IValidator`1,MyService" />
    <typeAlias alias="VABValidator`1" type="MySerivice.VABValidator`1,MyService" />
    <typeAlias alias="MyService" type="MySerivice.MyService,MyService" />
</typeAliases> 
```

然后我在这里注册映射和属性：

```
<types>    
  <type type="MyService">
    <typeConfig extensionType="Microsoft.Practices.Unity.Configuration.TypeInjectionElement Microsoft.Practices.Unity.Configuration">
      <property name="Validator" propertyType="IValidator`1"/>
    </typeConfig>
  </type>
  <type type="IValidator`1" mapTo="VABValidator`1">
    <lifetime type="singleton" />
  </type>
</types> 
```

在 MyService 我有以下属性：

```
private IValidator<RegExpressionObject> validator;

[Dependency]
public IValidator<RegExpressionObject> Validator
{
    get { return validator; }
    set { validator = value; }
} 
```

但是，当我运行它时，我得到了以下异常，这真的让我摸不着头脑：

> System.InvalidOperationException：MyService 类型上的属性 Validator 属于 IValidator'1 类型，不能注入 IValidator'1 类型的值

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T20:10:56.110

我相信您正在寻找这种语法：

```
<typeAlias alias="VABValidator`1" 
           type="MySerivice.VABValidator`1
                [[Assembly.Namespace.RegExpressionObject,Assembly]],MyService"/> 
```

这将指定您的泛型参数的类型并允许您注入它。

这个功能没有很好的记录:)

# ruby-on-rails - 网站的 Web 前端缓存最佳实践？

> ID：729259
> 
> 赞同：7
> 
> 时间：2009-04-08T09:35:03.053
> 
> 标签：ruby-on-rails, django, performance, zend-framework, symfony1

## 概括

当我查看 stackoverflow 和网络时，我发现普遍缺乏关于缓存使用会话的高性能站点的最佳实践的良好文档。如果我们可以围绕一些基本构建块分享一些想法，尤其是在缓存方面，那将会很有帮助。出于本次讨论的目的，我将避免使用 memcache，而是专注于静态和完全生成的页面的缓存。

所以要设置场景，想象一个 Web 服务器（比如 nginx）、反向代理（比如 varnish）、应用服务器（随便）、数据库服务器（比如 mysql）。

## 匿名的

1.  静态项目（gif/jpg 等）
2.  半动态 (js/css)
3.  动态的

## 登录

1.  静止的
2.  半动态 (js/css)
3.  动态的

一般来说，所有的 Anon 都应该是可缓存的，并且大部分都是 Logged In（忽略动态，暂时没有 ESI）。

**匿名 #1**

*   设置遥远的过期时间
*   如果可能，设置 ETag
*   缓存控制：max-age=315360000

**Anon #2** （如果动态生成，则反向代理缓存结果，否则 Anon #1 规则适用）

*   缓存控制：公共，s-maxage=3000

**匿名 #3**

*   缓存控制：公共，s-maxage=300

**登录 #1**

*   设置遥远的过期时间
*   如果可能，设置 ETag
*   缓存控制：max-age=315360000

**Logged In #2** （如果动态生成，则反向代理缓存结果，否则 Logged In #1 规则适用）

*   缓存控制：公共，s-maxage=3000

**登录 #3**

*   缓存控制：s-maxage=0，必须重新验证

你有什么建议？当答案出现时，我会更新帖子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T15:03:58.060

我对缓存一无所知，但这里有一些建议：

**Anon #1,2：（静态、半动态项目）** 您可以将它们设置为永不过期。如果您需要更改它们，请更改它们的 URL。If-modified-since 检查很便宜，但不是免费的。

**Anon #3：（动态项目）** 这就是 ETags 和/或 Last-Modified 派上用场的地方。根据您提供的服务，您可以生成一个好的 Last-Modified 标头。如果您的数据库存储了您计划显示的所有项目的修改日期，您可以使用`SELECT MAX(last_updated) FROM items_to_show`. *警告：*这考虑了数据的年龄，而不是模板的年龄，因此如果您更改了 django 模板，您将不知道如何在标头中进行通信。

或者你可以用 ETag 做类似的事情。它可能是生成的内容的校验和。这将考虑到模板的更改。

这两种缓存动态内容的方法需要注意的是，它们确实比 Web 服务器/数据库加载节省了更多的带宽。您始终可以明智地使用 Expires 标头，以帮助在页面更改是周期性且可预测的情况下提供帮助。

我对登录内容的建议是相似的，除了我会查看 Vary 标题。这可以向缓存代理发出信号，表明不会为不同的登录用户提供相同的内容。

一般来说，我会使用 ETag 或 Last-modified，但不会同时使用两者。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-29T09:52:17.473

我对此的最佳回答是，您对所有静态文件都有很多选择，它们可以以自己的方式产生很多收益，在特定情况下每种都有好处，因此请根据您的具体需要权衡利弊.

然而，大多数人忽略的是他们的动态内容，确保缓存数据库结果等很棒，但仍然涉及实际启动 PHP/ASP 的解析引擎或其他什么。

如果您查看 wordpress 的超级缓存插件，您会注意到它能够将您的 html 实际准备为静态文件。不仅如此，它还制作了一个 gzip 副本，并使用重写规则来检查这些文件是否存在，作为启动解析器的适当替代方法。这显然会给您带来最好的结果，因为它不仅可以节省您的处理时间，还可以节省带宽。

如果您想查看性能差异，请将 apachebench 的结果`<?php die('hello world');`与提供静态 .html 页面的结果进行比较。

显然，您需要小心使用这种缓存，但是从 PHP 等解释器内部替换整页缓存可能非常有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-16T08:21:20.580

[在ySlow pages](http://developer.yahoo.com/performance/rules.html)上有一些相关的建议。

[Etags](http://developer.yahoo.com/performance/rules.html#etags)显然不是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-17T00:12:01.697

我建议阅读[Scalable Internet Architectures](https://rads.stackoverflow.com/amzn/click/com/067232699X)有几章专门讨论通过缓存、CDN 等进行扩展。它应该为您指明正确的方向。帮助我扩大了我非常支持的网站。

--

# php - 我必须如何将我的图像保存在我的项目中？

> ID：729260
> 
> 赞同：1
> 
> 时间：2009-04-08T09:35:09.293
> 
> 标签：php, asp.net, image

这就是我想做的…………

我将让每个用户将多张图片上传到一个名为“pics”的文件夹中。如果用户上传说“MyImage.jpg”，我会将其重命名为“MyImage_UserID.jpg”。其中 UserID 当然是用户的唯一 ID。这样，当我查找用户的所有图像时，我只会查找以 UserID 结尾的图像名称。

这是错误的，还是有其他方法可以做到这一点？

我正在考虑将所有用户的所有图像放在 1 个文件夹中。

您不认为为每个用户创建一个文件夹会很愚蠢吗？

此外，该文件夹“图片”将如何保存？就像我不希望黑客从该文件夹中添加或删除图片一样。

有输入吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T09:39:58.097

如果有相当数量的用户每个用户拥有大量图像，您的文件系统将开始窒息（前提是它不会因为无法处理大量文件而崩溃）。

我建议为每个用户创建一个文件夹。不，这并不愚蠢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T11:41:33.390

在单个目录中存储太多文件可能会导致问题。不仅性能会在某个时候受到影响，而且一位朋友（比我更有经验）告诉我，一些备份程序有这个问题。

所以当我必须存储数千张图像时，我总是创建 256 个子目录，并将文件存储在目录中`files/{id mod 256}/{myfile_id}.jpg`

为了保护自己免受黑客攻击，有很多事情要做，但没有什么是安全的（因为黑客很可能会尝试获取 root 访问权限，然后您的数据无论如何都不安全）。

1）所以...定期备份。时期。
2）审核日志文件（谁什么时候）。这本身并不安全，但可以帮助您发现安全漏洞并修复错误
3) 相应地设置文件权限（在没有 chroot-ing 的共享服务器上很重要）
4) 仔细检查操作是否真的由正确的用户完成。猜测网址一定不可能造成伤害。

如果你想让文件名和 -paths 保密，还有更多。例如，可以不直接链接到图像，而是链接到为该图像提供服务的脚本。在这种情况下，您可以将文件存储在 webroot 之外（此外，您更独立于文件名）（参见最后的代码）。

另一个步骤是避免使用 auto_increment id 值来识别图像。最好使用`md5(mt_rand());`与 id 没有关联的唯一哈希 ( ) 并将其存储在数据库中（afaik youtube 和 flickr 这样做）。

用于传递的丑陋 php-pseudocode 类似于：

```
<?php
  if (isset($_REQUEST['img'])) {
    $hash = $_REQUEST['img']);
    if (($res = getImageByHash($hash)) !== false) {
      list($id, $name, $mimetype) = $res;
      $path = '../images/' . ($id % 256) . '/' . $name;

      if (file_exists($path)) {
        header('Content-type: ' . $mimetype); // e.g. image/png
        readfile($path);
        exit();
      }
    }
  }

  // if any error happened, then 404 - it's dirty
  header("HTTP/1.0 404 Not Found");
  echo 'sorry, we couldn\'t find this image';
?> 
```

getImageByHash() 将查询数据库。此解决方案较慢，因为网络服务器不能再直接提供图像。

并且：我宁愿不将图像存储在数据库中。出口会变得巨大，备份会很痛苦。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T10:49:48.567

将所有图像存储在一个目录中并不是一个好的选择。如果文件系统中有太多节点，文件系统将会阻塞。

第一种选择是为每个用户提供自己的目录。但是，如果您期望有很多用户，最终会出现同样的问题。

人们通常会想出的办法是：拆分userId：

```
+ 1
|- 11
|- 12
|- 1490
+ 2
|- 23
|- 240
...

```

但是随后数据并*没有通过目录结构均匀分布*，从而导致其他问题。

最简单的工作解决方案是从后面拆分 userId：

```
+ 1
|- 231
|- 91
|- 1
+ 2
|- 6322
|- 342
...

```

但是那里有更好的解决方案。
另请参阅：**[如何在文件系统中存储图像以](https://stackoverflow.com/questions/191845/how-to-store-images-in-your-filesystem)**获得更复杂的解决方案

*接下来要担心的是：如何使数据库和文件系统保持同步*

1.  创建数据库记录，标记为“未同步”
2.  获取新插入记录的id
3.  将数据存储在文件系统中，与新插入的 recordId 相关联
4.  将记录标记为“已同步”

删除东西则相反。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T09:44:03.483

为了帮助安全设置网站上的权限，以防止列出任何目录。因此，即使有人设法正确猜测文件夹的名称，他们也无法看到其中的内容。

您还可以做其他事情 - 对站点安全性进行一些研究。

我同意 Anton 的观点，每个用户都有一个目录是个好主意。然后你甚至不必重命名图像。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T09:49:30.680

只需有 1 个文件夹，您可以在其中上传所有图片，并有一个单独的表来记录用户 ID 和图像文件名

上传图片时唯一需要检查的是是否存在相同的图片文件名，如果存在则重命名并相应保存

这是如果您选择将图片保存在文件系统上

* * *

但是请注意，这些天来，数据库真的很好。因此，即使您将图像直接保存在 sql server 中，可伸缩性也不成问题。这样您就可以完全保护您的图像，无需重命名图像、管理文件系统等

这里有很多人会为此争论。但是请注意，sharepoint 2007 使用 sql server 来保存文档、图像等。如果您最终拥有很多用户，并且您需要负载平衡和回退，那么在文件系统上实现它非常非常困难（您将不得不依赖网络共享并复制您的网络共享以备后备）

但是用 sql server 完成同样的任务会轻而易举

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-23T12:34:31.020

如果您不确定安全性，最好将图像保存在数据库中。您需要确定的一件事是图片不会占用太多空间。你需要：

1 ) 将 em 存储为 JPEG，并将其他图像类型转换为 JPEG

2 ) 重新采样比您实际需要的像素大小更大的图片。

有一个特殊的组件AccessImagine，可以自动观看这个东西+给用户图像提交方法的自由。你可以在这里下载 - [http://access.bukrek.net](http://access.bukrek.net)

# c# - Rhino 使用 AAA 在属性获取器上模拟 AssertWasCalled（多次）

> ID：729267
> 
> 赞同：53
> 
> 时间：2009-04-08T09:38:36.617
> 
> 标签：c#, unit-testing, properties, rhino-mocks, getter

我有一个模拟对象，它作为构造函数参数传递给另一个对象。

如何测试已调用模拟对象的属性？这是我目前使用的代码：

```
INewContactAttributes newContact = MockRepository.GenerateMock<INewContactAttributes>();
newContact.Stub(x => x.Forenames).Return("One Two Three");
someobject.ConsumeContact(newContact);
newContact.AssertWasCalled(x => { var dummy = x.Forenames; }); 
```

这有效，除非在“someobject”内多次使用 Forenames 属性的 getter。那是我得到“Rhino.Mocks.Exceptions.ExpectationViolationException: INewContactAttributes.get_Forenames(); 预期 #1，实际 #2 ..”的时候

只需使用

```
newContact.AssertWasCalled(x => { var dummy = x.Forenames; }, options => options.Repeat.Any()); 
```

不起作用并给出以下错误：

“期望已从等待期望列表中删除，您是否调用了 Repeat.Any() ？ AssertWasCalled() 不支持此操作。”

那么如何满足多个呼叫的需求呢？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-19T23:45:14.550

`newContact.AssertWasCalled(x => { var dummy = x.Forenames; }, options => options.Repeat.AtLeastOnce());`

`Repeat.Any`不起作用，`AssertWasCalled`因为 0 算作任何......所以如果它没有被调用，`AsserWasCalled`即使它没有被调用，也会返回 TRUE。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2010-07-16T12:16:44.593

我同意克里斯的回答

```
newContact.AssertWasCalled(x => { var dummy = x.Forenames; }, options => options.Repeat.AtLeastOnce()); 
```

此外，如果您确切知道该属性将被调用多少次，您可以这样做

```
newContact.AssertWasCalled(x => { var dummy = x.Forenames; }, options => options.Repeat.Times(n)); 
```

其中 n 是一个整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T09:48:35.033

你检查它被调用的次数背后的动机是什么？这是一项特别昂贵的手术吗？如果是这样，那么我建议您将其放在方法后面，因为从语义上讲，属性应该是廉价的调用。

此外，检查属性被调用的次数并不是单元测试的重点（不要担心测试太多是一个常见的错误，我们都经历过）。您真正应该测试的是，给定模拟对象的状态，该方法会产生预期的输出。调用方法的次数并不重要（除非它是发送电子邮件或其他东西的服务）。这是一个你通常不会测试的实现细节，因为简单的重构会破坏你的测试，因为它们太具体了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-09-07T20:40:49.787

根据您使用的 Rhino 版本，您可以使用：

```
// Call to mock object here
LastCall.IgnoreArguments().Repeat.Never(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T09:50:59.630

newContact.Expect(c => c.ForeNames).Return(...).Repeat.Any()

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-10-11T14:02:39.340

从[这里](http://www.scribd.com/doc/49587062/RhinoMocksAAAQuickReference)：

```
mock.AssertWasCalled(x => x.Name ="Bob"); 
```

或者

```
mock.AssertWasCalled(x => x.Name =Arg.Is("Bob")); 
```

或者

```
mock.AssertWasCalled(x => x.Name =Arg<string>.Is.NotNull); 
```

# c# - 编码数字、z-base-32 的 C# 实现还是其他？

> ID：729268
> 
> 赞同：12
> 
> 时间：2009-04-08T09:38:40.953
> 
> 标签：c#, algorithm, encoding, base32

我需要编码/解码一个最长为 9 位但通常为 7 位的整数。我想让交流/记忆更容易——它将通过电话交流、复制和粘贴、从卡/内存/标签上键入、手写在标签上并且通常被滥用！

[我希望使用base 32](http://en.wikipedia.org/wiki/Base32)方案来减少位数（同时添加校验和） 。我最赞成[z-base-32](http://zooko.com/repos/z-base-32/base32/DESIGN)（通过[RFC4648](https://www.rfc-editor.org/rfc/rfc4648)实现），因为一些设计目标（例如手写）和字母表的选择（小写，排列以支持更易于阅读、书写的字符，说话，记住）。但是，我找不到 C# 实现，我担心从现有的 Python 实现移植。

有人有 C# 实现吗？或者，是否有人可以使用一组测试用例（规范中的示例除外）来验证端口？

我愿意接受有关替代编码方案的建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-03-10T03:19:31.530

我从死帐户提供的代码开始，并根据我的测试进行了一些更改。我希望这很有用。

```
/// <summary>
/// Author: Ben Maddox
/// </summary>
public class ZBase32Encoder
{
    /*
     * Accepted characters based on code from: 
     * http://www.codeproject.com/KB/recipes/Base32Encoding.aspx?display=Print
     */
    public const string AcceptedCharacters = "ybndrfg8ejkmcpqxot1uwisza345h769";

    public static string Encode(int input)
    {
        string result = "";

        if (input == 0)
        {
            result += AcceptedCharacters[0];
        }
        else
        {
            while (input > 0)
            {
                //Must make sure result is in the correct order
                result = AcceptedCharacters[input%AcceptedCharacters.Length] + result;
                input /= AcceptedCharacters.Length;
            }
        }

        return result;
    }

    public static int Decode(string input)
    {
        var inputString = input.ToLower();

        int result = 0;
        for (int i = 0; i < inputString.Length; i++)
        {
            result *= AcceptedCharacters.Length;
            var character = inputString[i];
            result += AcceptedCharacters.IndexOf(character);
        }
        return result;
    }

    public static int Decode(char data)
    {
        return Decode(data.ToString());
    }
} 
```

这是我使用的测试。使用应该断言库的 MS 测试。

```
[TestClass]
public class ZBase32EncoderTests
{

    [TestMethod]
    public void Encoding_0_ReturnsFirstCharacter()
    {
        var result = ZBase32Encoder.Encode(0);
        result.ShouldEqual(ZBase32Encoder.AcceptedCharacters[0].ToString());
    }

    [TestMethod]
    public void Encoding_1_ReturnsSecondCharacter()
    {
        var result = ZBase32Encoder.Encode(1);
        result.ShouldEqual(ZBase32Encoder.AcceptedCharacters[1].ToString());
    }

    [TestMethod]
    public void Encoding_32_ReturnsSecondAndFirstValues()
    {
        var result = ZBase32Encoder.Encode(32);
        result.ShouldEqual(ZBase32Encoder.AcceptedCharacters[1].ToString() + ZBase32Encoder.AcceptedCharacters[0].ToString());
    }

    [TestMethod]
    public void Encoding_64_ReturnsThirdAndFirstValues()
    {
        var result = ZBase32Encoder.Encode(64);
        result.ShouldEqual(ZBase32Encoder.AcceptedCharacters[2].ToString() + ZBase32Encoder.AcceptedCharacters[0].ToString());
    }

    [TestMethod]
    public void Encoding_65_ReturnsThirdAndSecondValues()
    {
        var result = ZBase32Encoder.Encode(65);
        result.ShouldEqual(ZBase32Encoder.AcceptedCharacters[2].ToString() + ZBase32Encoder.AcceptedCharacters[1].ToString());
    }

    [TestMethod]
    public void Decoding_FirstCharacter_Returns_0()
    {
        var inputCharacter = ZBase32Encoder.AcceptedCharacters[0];
        var result = ZBase32Encoder.Decode(inputCharacter);
        result.ShouldEqual(0);
    }

    [TestMethod]
    public void Decoding_SecondCharacter_Returns_1()
    {
        var inputCharacter = ZBase32Encoder.AcceptedCharacters[1];
        var result = ZBase32Encoder.Decode(inputCharacter);
        result.ShouldEqual(1);
    }

    [TestMethod]
    public void Decoding_SecondAndFirstValues_Shows_32()
    {
        var inputCharacters = ZBase32Encoder.AcceptedCharacters[1].ToString() + ZBase32Encoder.AcceptedCharacters[0];
        var result = ZBase32Encoder.Decode(inputCharacters);
        result.ShouldEqual(32);
    }

    [TestMethod]
    public void Decoding_ThirdAndFirstCharacters_Shows_64()
    {
        var inputCharacters = ZBase32Encoder.AcceptedCharacters[2].ToString() + ZBase32Encoder.AcceptedCharacters[0];
        var result = ZBase32Encoder.Decode(inputCharacters);
        result.ShouldEqual(64);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T09:47:58.670

您可能想使用自己的编码/解码例程？

编码：

```
 string acceptedChar = "ABCDEFGHJKLMNPQRSTUWXZ0123456789";
 int yourNumber = 12345678;

 string response = "";
 while (yourNumber > 0)
 {
      response += acceptedChar[yourNumber % acceptedChar.Length];
      yourNumber /= acceptedChar.Length;
 } 
```

解码：

```
 string acceptedChar = "ABCDEFGHJKLMNPQRSTUWXZ0123456789";
 string inputStr = "ABCD";

 int yourNumber = 0;
 for (int i = inputStr.Length; i > 0; i--)
 {
     yourNumber *= acceptedChar.Length;
     yourNumber += acceptedChar.IndexOf(inputStr[i]);
 } 
```

（未经测试的代码）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-23T01:11:09.367

BenMaddox 的帖子略有改进（使用 do-while）：

```
public static String encode(int num, String base) {
    String response = "";
    do{
        response = base.charAt(num % base.length()) + response;
        num /= base.length();
    } while(num>0); 
    return response;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T09:47:52.383

如果你看看你的手机键盘，数字 1985239 可以用这些字符来表示 (a,b,c), (w,x,y,z), (t,u,v), ... 试着找到一种算法，可以在给定一组有序的无序字符集的情况下生成或多或少类似英语的单词——这些将更容易记忆。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T09:57:17.900

这个项目看起来像你所追求的：

[.NET (C#) 的 Base 36 类型](http://www.codeproject.com/KB/cs/base36.aspx)

# wix - 验证用户必须安装至少一项子功能

> ID：729274
> 
> 赞同：8
> 
> 时间：2009-04-08T09:43:50.787
> 
> 标签：wix, windows-installer, wix3

这是我的应用程序安装程序在 FeatureTree/SelectionTree 中的结构

**应用核心
    |_ _ 功能 1
    |_ _ 功能 2
    |_ _ 功能 3**

我想确保当用户选择应用程序核心时，他必须选择功能 1、功能 2 或功能 3 中的至少一个。

我知道功能下的条件元素可能会有所帮助，但无法使其正常工作，有人在救援吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T10:51:29.657

您需要验证[ADDLOCAL](http://msdn.microsoft.com/en-us/library/aa367536(VS.85).aspx)属性并禁用下一个按钮，直到它具有“正确”值。
您可以查看 EULA 对话框中的示例，在用户按下同意 EULA 复选框之前，下一步按钮处于禁用状态。

# visual-studio-2008 - Compact Framework：无法在控件中使用 InputPanel

> ID：729276
> 
> 赞同：3
> 
> 时间：2009-04-08T09:44:18.710
> 
> 标签：visual-studio-2008, compact-framework, visual-studio-designer

我开发了一个使用 PDA`InputPanel`与用户交互的控件。代码的相关部分如下：

```
namespace MyNamespace
{
     // ...
     using Microsoft.WindowsCE.Forms;
     // ...

     public class MyControl
     {
         // ...
         public InputPanel MyPanel { get; set; }
         // ...
     }
} 
```

每当我尝试将 拖到`Control`a`Form`时，都会收到以下错误：

> System.IO.FileNotFoundException：无法加载文件或程序集“Microsoft.WindowsCE.Forms，Version=2.0.0.0，Culture=neutral，
> PublicKeyToken=969db8053d3322ac”或其依赖项之一。该系统找不到指定的文件。文件名：'Microsoft.WindowsCE.Forms, Version=2.0.0.0, Culture=neutral, PublicKeyToken=969db8053d3322ac'</p>

如果我从中删除该`InputPanel`行，`MyControl`我可以`Form`毫无问题地将其添加到。添加后，我可以再次`Control`添加该行，整个程序编译并正常工作。

一旦`Control`在设计器中查看带有 的表单，它就会崩溃并出现与上述类似的错误，我无法`Form`再次将其添加到任何其他表单中。

我正在使用带有 Windows Mobile 6 SDK 的 Visual Studio 2008 SP1。

* * *

所以我的问题是：有没有人遇到过类似的问题或找到解决方法？

* * *

编辑：放弃并使用父表单作为属性。该表单实现了 IInputPanel，它基本上是一个带有 InputPanel getter 的接口。尽管如此，ctake 的回答确实很有见地，并将我介绍给了 XMTA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T12:50:16.047

这是因为桌面没有 SIP（​​输入面板），因此设计者无法显示它。您需要将 XMTA 中的 DesktopCompatible 属性设置为 false。

编辑：我想我应该扩展这个答案。设置 DesktopCompatible 属性将阻止设计器直接查询该属性，但如果控件中有任何可能调用它的代码（因此，如果将在设计器中运行的任何代码都可能执行 CE 特定的代码），那么您还必须添加防止这种情况发生的代码。通过 Environment.OSVersion.Platform 检查当前平台工作得相当好，尽管还有其他更复杂的机制来确定您是否也在设计器中。

# php - CakePHP：如何使用 Set::contains 将数组的子集与给定的数组进行比较？

> ID：729281
> 
> 赞同：0
> 
> 时间：2009-04-08T09:46:52.197
> 
> 标签：php, cakephp

我有以下数组，名为 $usergrouppermissions：

```
Array
(
    [0] => Array
        (
            [UserGroupPermission] => Array
                (
                    [group_id] => 1
                    [permission_id] => 4
                )

        )

    [1] => Array
        (
            [UserGroupPermission] => Array
                (
                    [group_id] => 1
                    [permission_id] => 5
                )

        )

    [2] => Array
        (
            [UserGroupPermission] => Array
                (
                    [group_id] => 1
                    [permission_id] => 6
                )

        )

    [3] => Array

[...] 
```

在一个循环中，我构建了另一个这样的数组，名为 $searchme：

```
Array
(
    [UserGroupPermission] => Array
        (
            [permission_id] => 1
            [group_id] => 1
        )

) 
```

现在，我想检查上面的给定数组是否存在于顶部的数字索引数组中。我目前这样做：

```
$result = Set::contains($usergrouppermissions, $searchme); 
```

结果总是错误的。我在这里有什么问题吗？问题是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T10:47:28.887

由于 PH 4.2 in_array 也可以使用数组作为指针。所以，解决方案是这样的：

```
in_array($searchme, $usergrouppermissions) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-13T15:16:26.253

我知道我的这个答案已经很晚了，但无论如何都是为了后代:)

蛋糕的方式是：

```
$exists = Set::matches
    (
        sprintf
        (
            '/UserGroupPermission[group_id=%s][permission_id=%s]',
            $searchme['UserGroupPermission']['group_id'],
            $searchme['UserGroupPermission']['permission_id']
        ),
        $usergrouppermissions
    ); 
```

如果您查看代码，`Set::contains()`您会发现它不适用于嵌套包含（至少在您的情况下不是）。

`Set::matches()`基本上只是`Set::extract()`使用给定的 XPath 条件进行调用，并将结果转换为 bool 值以供您取悦。

# java - FileOutputStream 文件未找到错误

> ID：729283
> 
> 赞同：0
> 
> 时间：2009-04-08T09:47:35.067
> 
> 标签：java, file-io

我在使用以下代码时遇到问题。我正在尝试写入 .ppm 文件，但我得到了

> Red.java:6：未报告的异常 java.io.FileNotFoundException；必须被捕获或声明被抛出 FileOutputStream fout = new FileOutputStream(fileName); ^ 有什么想法吗？

导入java.io.*；

公共类红色{

```
public static void main(String args[]) {

String fileName = "RedDot.ppm"; 
FileOutputStream fout = new FileOutputStream(fileName); 
DataOutputStream out = new DataOutputStream(fout);

System.out.print("P6 1 1 255 ");
    System.out.write(255);
    System.out.write(0);
    System.out.write(0);
    System.out.flush();
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T09:49:41.833

Th FileNotFoundException 是一个检查异常。您需要将尝试写入文件的代码包含在 try/catch 块中，或者抛出异常。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T10:00:02.837

最简单的解决方案是重写您的主要声明：

```
public static void main(String args[]) throws FileNotFoundException {... 
```

因此表明如果它无法创建输出流（无论出于何种原因） ，它*可能会抛出此异常。*请注意，在这种情况下，FileNotFoundException 并不是异常的最佳名称，但这是您无法处理的命名问题。

事实上，您*可能*希望`IOException`在上面的`main()`throws 子句中声明。您调用的不同方法将被声明为 this 的 throwing 变体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T09:53:10.187

您是否在记事本中编写代码？尝试使用 Eclipse。它会在有未捕获异常问题的代码下划线，然后您可以将光标放在带下划线的部分（给出错误的行），按下`Ctrl+1`解决方案列表，然后在列表中选择一个。我想用 a 包围这个块`try{}catch{}`会平息异常，除非你 - 想 - 做点什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T10:05:54.663

代码中未处理 FileNotFoundException。添加 FileOutputStream fout = new FileOutputStream(fileName); 在 try catch 块之间可以解决问题。

```
import java.io.*;
public class Red {
    public static void main(String args[]) {

    String fileName = "RedDot.ppm"; 
    try
    {
        FileOutputStream fout = new FileOutputStream(fileName);
        DataOutputStream out = new DataOutputStream(fout);
    }catch(FileNotFoundException fnfExcep){
        System.out.println("Exception Occurred " + fnfExcep.getMessage() );
    }
    System.out.print("P6 1 1 255 ");
        System.out.write(255);
        System.out.write(0);
        System.out.write(0);
        System.out.flush();
    }
} 
```

# redirect - Xampp - 将外部 url 重定向到 localhost

> ID：729287
> 
> 赞同：10
> 
> 时间：2009-04-08T09:48:28.623
> 
> 标签：redirect, localhost, xampp, external

在将文件上传到 Web 服务器之前，我使用 Xampp 安装在本地测试我的文件。我的网页通常包含很多“硬编码”链接，这意味着要测试任何链接（或任何形式等），我需要将硬编码链接更改为指向 localhost，然后在完成测试后重新更改它。

我正在寻找的是一种将外部 url 重定向到我的 localhost 文件夹的方法，因此我可以将其设置为我的网站，然后我就可以在上传它们之前进行更改。例如，如果我在浏览器中输入“www.mysite.com/example/view.php”，我实际上会查看“localhost/example/view.php”。

这样的事情可能吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T10:06:55.677

我想到了两个解决方案：

1.  使用相对 URL（首选）
2.  将您的外部 URL 添加到您的主机文件中，该文件可以在

    C:\WINDOWS\system32\drivers\etc\hosts (Windows)

    或者

    /etc/hosts (Linux)

    只需添加这一行：

    www.mysite.com 本地主机

    也许你必须使用你的服务器 ip 而不是 mysite.com，我现在不确定

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-06-29T08:02:05.297

我只是偶然发现了这一点。

在主机中使用这一行：

127.0.0.1 www.yoururl.com

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T10:09:19.023

是的：不要使用硬编码链接！

说真的，我不确定我是否理解正确。如果您的页面中的 URL 指向同一站点上的其他页面，则应使用“/example/view.php”形式的链接，而不是“ [http://www.mysite.com/example/view.xml”。 php](http://www.mysite.com/example/view.php) ”。这样，您将始终指向同一个站点。

如果这些链接转到外部站点，但您需要在本地重定向它们以进行测试（我不明白为什么会这样，但您永远不知道......）那么您可以在配置文件中使用变量。您只需要在一个地方更改此变量...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-15T07:25:16.637

如果您的远程网站具有静态 IP，您可以在 Internet 路由器上使用重定向规则。根据需要打开和关闭规则。

捕获到 202.20.20.20（网站 IP）的流量并重定向到 192.168.1.10（您的本地 PC IP）

此方法在 DNS 解析之后而不是之前重定向。如果使用诸如 wordpress 之类的软件，这和上面的其他方法（使用 Hosts 文件）非常有用；它将开发 URL 硬编码到其数据库中。

# linux - 使用 Apache 服务器运行 Silverlight（在 linux 下）

> ID：729294
> 
> 赞同：10
> 
> 时间：2009-04-08T09:49:50.037
> 
> 标签：linux, silverlight, apache

我需要将 Silverlight 2.0 应用程序部署到 Apache 服务器，但它在 Linux 下。

这可能吗？我的意思是，我需要在服务器中安装 .Net 3.5 和可以执行 Asp.Net 的网站吗？

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-08T09:57:49.863

如果 apache 服务器只是为没有任何 ASPX 页面的 silverlight 应用程序提供服务，那么您应该没问题。Silverlight 是一种客户端技术，因此它不需要在服务器上安装 .NET（当然，除非您在 ASPX 页面上托管 silverlight 应用程序）。

如果您想从运行 linux 的客户端计算机上查看 silverlight 内容，那么您将需要考虑安装 Moonlight，正如 Sam 指出的那样。

编辑：Tim Sneath 有一篇[博客文章](http://blogs.msdn.com/tims/archive/2008/03/18/configuring-a-web-server-to-host-silverlight-content.aspx)解释了需要在 Web 服务器上配置哪些内容才能托管 silverlight 内容。简而言之，您需要配置以下 MIME 类型：

> .xaml - 应用程序/xaml+xml
> 
> .xap - 应用程序/x-silverlight-app

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-19T12:30:25.233

我必须定义比 KevB 建议的更多的 MIME 类型：

```
application/manifest            .manifest
application/xaml+xml            .xaml
application/x-ms-application    .application
application/x-ms-xbap           .xbap
application/octet-stream        .deploy
application/vnd.ms-xpsdocument  .xps 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-04-09T16:33:21.780

您应该利用[silverlight 流](http://silverlight.live.com/)。以 1.4 Mbps 的速率免费播放长达 10 分钟的视频。

这里的说明：

[http://msdn.microsoft.com/en-us/library/bb851621.aspx](http://msdn.microsoft.com/en-us/library/bb851621.aspx)

[样品](http://msdn.microsoft.com/en-us/library/bb851598.aspx)

# c# - 如何投射表达式 > 到表达式 >

> ID：729295
> 
> 赞同：65
> 
> 时间：2009-04-08T09:50:30.787
> 
> 标签：c#, lambda

我一直在搜索，但我找不到如何从类型中转换

```
Expression<Func<T, DateTime>> 
```

类型：

```
Expression<Func<T, object>> 
```

所以我必须再次求助于如此广泛的知识；）

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-04-08T09:58:28.893

你不能只在它们之间进行转换，因为它们不是同一种东西。但是，您可以在表达式树中有效地添加转换：

```
using System;
using System.Linq.Expressions;

class Test
{
    // This is the method you want, I think
    static Expression<Func<TInput,object>> AddBox<TInput, TOutput>
        (Expression<Func<TInput, TOutput>> expression)
    {
        // Add the boxing operation, but get a weakly typed expression
        Expression converted = Expression.Convert
             (expression.Body, typeof(object));
        // Use Expression.Lambda to get back to strong typing
        return Expression.Lambda<Func<TInput,object>>
             (converted, expression.Parameters);
    }

    // Just a simple demo
    static void Main()
    {
        Expression<Func<string, DateTime>> x = text => DateTime.Now;
        var y = AddBox(x);        
        object dt = y.Compile()("hi");
        Console.WriteLine(dt);
    }        
} 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2014-12-13T21:24:22.703

*Rob*和*Jon Skeet*的回答有一个问题。

你会得到类似的东西`x => Convert(x.PropertyName)`，但通常例如对于*ASP.NET MVC*，你想要这样的表达式`x => x.PropertyName`

在某些情况下“污染”表达`Expression.Convert`也是*如此*。

**解决方案：**

```
public static class LambdaExpressionExtensions
{
    public static Expression<Func<TInput, object>> ToUntypedPropertyExpression<TInput, TOutput> (this Expression<Func<TInput, TOutput>> expression)
    {
        var memberName = ((MemberExpression)expression.Body).Member.Name;

        var param = Expression.Parameter(typeof(TInput));
        var field = Expression.Property(param, memberName);
        return Expression.Lambda<Func<TInput, object>>(field, param);
    }
} 
```

**用法：**

```
Expression<Func<T, DateTime>> expression = ...;
Expression<Func<T, object>> expr = expression.ToUntypedPropertyExpression(); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2010-11-23T07:10:57.550

根据 Jon 的代码（感谢 btw），您可以更进一步以获得完全的灵活性：

```
public static Expression<Func<TModel, TToProperty>> Cast<TModel, TFromProperty, TToProperty>(Expression<Func<TModel, TFromProperty>> expression)
{
    Expression converted = Expression.Convert(expression.Body, typeof(TToProperty));

    return Expression.Lambda<Func<TModel, TToProperty>>(converted, expression.Parameters);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-24T11:52:49.047

只需将 out TResult 定义为对象并编译表达式，它适用于所有数据类型；

```
Expression<Func<string, object>> dateExp = text => DateTime.Now;
object dt = dateExp.Compile()("hi");
Console.WriteLine(dt); 
```

[小提琴样本在这里](https://dotnetfiddle.net/qhXAxn)

# jcarousel - jCarousel，即时获取数据

> ID：729296
> 
> 赞同：0
> 
> 时间：2009-04-08T09:50:47.290
> 
> 标签：jcarousel

我想使用 jCarousel，并且我希望能够通过 Ajax 调用即时获取下一批图像（如果尚未下载）

jCarousel 站点上的 Ajax 示例似乎显示了使用 Ajax 加载的整个项目集。如果它们还不存在，我只想加载下一组。

看来我需要使用这种方法，`itemLoadCallback`. 有人能证实这一点吗？

TIA

拍

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T14:41:01.880

[这](http://sorgalla.com/projects/jcarousel/examples/dynamic_ajax_php.html) 可能会有所帮助。

# php - GPL 许可证会污染吗？

> ID：729303
> 
> 赞同：3
> 
> 时间：2009-04-08T09:53:26.347
> 
> 标签：php, gpl, code-conversion

快速提问。

我正在将 GPL（而不是我创建）许可的 JavaScript 代码转换为 PHP。原始 GPL 是否有效，或者我可以在转换后的代码上放置任何许可证吗？

[我在 SO 上找到了这个](https://stackoverflow.com/questions/77044/licensing-a-rewrite-from-gpl-to-mit/525409#525409)，但想知道它是否适用。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-08T11:06:30.930

这真的不应该被视为一个法律问题。这真的是关于做正确的事。

在看事情的法律方面之前，首先要考虑一下对原作者的常识和礼貌。法律方面确实应该重新考虑。

根据 GPL 许可由您的“翻译”产生的工作肯定是处理该问题的最佳方式。

您作为起点使用的 JavaScript 软件是由其作者在 GPL 下“赠送”给您的，感谢他/她的礼物的最佳方式是在 GPL 许可下做出您自己的贡献。

现在，如果由于某种原因您无法使用 GPL，那么您确实有两个选择：

1.  **Contact the original author and get his/her approval for your plan** and the license you want to use on your own code. The original copyright holder could even allow you to either make a proprietary derivative of this original work or to license it under both GPL and another open-source license of your choice to work-around any GPL restriction you may have.
2.  **Do not start from that code**, and create your own PHP software independently from the JavaScript implementation but re-using the idea you've learned from reading the JavaScript code. *Re-using ideas from GPL code is a valid way to thank the original author whatever license you use*.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T10:03:50.957

IANAL，但如果您不是原作者，那么您的 PHP 版本将需要是 GPL。

> “修改”作品意味着以需要版权许可的方式复制或改编作品的全部或部分，而不是制作精确的副本。由此产生的作品被称为早期作品的“修改版”或“基于”早期作品的作品。

所以将一个js库移植到php中就可以算作是对原始库的修改，然后你就受了许可的约束，可以在GPL下发布修改后的代码。

版权可能是愚蠢的并且仅适用于文本，但如果您已将原件加载到计算机中查看它，那么您已经复制了它（至少根据英国法律，版权适用于数字副本）。

该复制行为是在许可下进行的，如果您不遵守许可条款，则无论您是否制作进一步的衍生副本，您都已经违反了版权。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T09:59:13.637

翻译不会删除版权。例如，考虑将 Windows 的二进制代码反编译为 Pascal，然后重新编译。你认为微软不会追随你吗？:)

我认为正确的方法是：

*   研究代码并生成它的技术规范。然后使用此规范重写代码。如果你是偏执狂，这些任务可以由不同的人来完成。（众所周知，公司会这样做）
*   或注明原作者并保留许可证。（您的代码是衍生作品）

这些建议可能不是绝对正确的，但它们不会给您带来麻烦。在考虑任何有争议的事情之前，您至少应该阅读：

[http://www.gnu.org/licenses/gpl-faq.html](http://www.gnu.org/licenses/gpl-faq.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T09:57:08.117

如果您是原始版权所有者，那么您可以在您喜欢的任何许可下发布副本或修改后的作品。当然，这不会改变先前发布的软件的许可。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T11:03:30.440

您将 GPL 嵌入到 LGPL 应用程序或模块中，而不仅仅是包装器++；这个新模块将是 LGPL，您可以干净地使用 LGPL 模块而不会分散。这就是我们的许可律师告诉我们的。

我相信我的律师，但这并不意味着你应该盲目相信我的律师:)

# sql-server-2005 - 如何将 SSIS 包添加到 SQL Server 2005 上的 MSDB 数据库？

> ID：729311
> 
> 赞同：3
> 
> 时间：2009-04-08T09:57:30.363
> 
> 标签：sql-server-2005

我在我的 PC 上安装了 SQL Server 2005，但存储在文件系统中的 SSIS 包存在执行问题。我想将其存储在 MSDB 数据库中，但不知道如何执行此操作。

我看了这个视频：http: [//download.microsoft.com/download/5/3/0/5303799D-8739-4BDC-8062-337368357391/SQLServerAgentTroubleshoot.wmv](http://download.microsoft.com/download/5/3/0/5303799D-8739-4BDC-8062-337368357391/SQLServerAgentTroubleshoot.wmv)

该视频将指导您完成 SQL Management Studio 中的过程，但是它将集成服务显示为 Management Studio 中的一个单独部分，而我没有这个？

任何想法如何在 Management Studio 中查看集成服务，或者如何在没有它的情况下将包添加到 MSDB 数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T09:59:37.533

在 Management Studio 的对象资源管理器中，连接按钮有一个下拉菜单，允许您指定集成服务。您可以使用它来访问您的 MSDB 包存储库。

但是，要将 SSIS 包放入其中，最简单的方法是构建它以进行部署，以便获得一个 .manifest 文件。运行它，您可以选择将其安装到 MSDB。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T13:41:24.443

或者，如果您在 BIDS 中构建了 SSIS 包，您可以转到菜单，选择“文件 > 将 PACKAGENAME.dtsx 的副本另存为...”，选择“SQL Server”作为目标并填写服务器名称。您还可以选择有关敏感数据的包的保护级别，您可以在[MSDN](http://msdn.microsoft.com/en-us/library/ms141747.aspx)查看所有选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-10T10:16:27.580

如果仍然感兴趣，如何构建用于部署的包：

1.  在 BIDS 中，右键单击解决方案（右侧栏顶部）并选择属性。
2.  在部署实用程序下，将 CreateDeploymentUtility 选项从 False 设置为 True。
3.  右键单击解决方案（右侧栏顶部），然后单击重建。
4.  现在转到解决方案项目文件夹。在文件夹“...\bin\deployment\”中，您将找到一个集成服务部署清单。右键单击它，选择部署，然后按照向导步骤操作。然后，SSIS 应出现在 SQL Server Management Studio 中 \MSDB 的 Integration Services 下。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-18T20:52:48.943

如果您使用的是较旧的包部署模型，则使用 CreateDeploymentUtility 选项是相关的，但如果您使用的是我相信的项目部署模型，则不是。

我也没有看到“文件 > 将 PACKAGENAME.dtsx 的副本另存为 ...”，使用项目部署模型时选择“SQL Server”选项。

# iphone - iPhone OS > 用户界面的 Window XIB 和 View XIB 模板有什么区别？

> ID：729314
> 
> 赞同：8
> 
> 时间：2009-04-08T09:58:14.807
> 
> 标签：iphone, xcode

就像我理解的那样，如果我要使用 View XIB，我有一个内容视图，我可以在其中放置 UI 控制元素。

但是什么是窗口呢？这不是差不多吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-08T15:54:46.230

在 iPhone 上，每个应用程序通常都有一个窗口和多个视图。在您的情况下，您将在 View XIB 中设计您的 UI，并在运行时将其添加到您的应用程序窗口中。您可以使用 MainWindow XIB 设置视图控制器，以便根据需要在应用程序中交换视图。

有关窗口和视图的更多信息，请参阅[iPhone 应用程序编程指南的 Windows 和视图部分](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/Introduction/Introduction.html#//apple_ref/doc/uid/TP40009503)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T14:35:04.470

一个窗口有*两个*视图：框架视图（包含只有 AppKit 可以访问的控件，如缩放、隐藏、关闭和最大化按钮，以及标题栏和代理图标）和内容视图，由您控制。

如果您正在设计要嵌入到另一个视图中的区域，或者将其交给需要视图的 API（例如，创建面板或工作表），那么请使用视图。如果您正在设计一个专门作为窗口的东西，例如文档窗口，那么请使用窗口。

对于一个窗口，您有额外的能力来控制它的外观和行为，例如，使它成为模态的，给它一个代理图标，在 Windows 菜单中列出它，相对于其他窗口对其进行排序，等等，你不能做一个简单的视图。

[窗户的工作原理](http://developer.apple.com/DOCUMENTATION/Cocoa/Conceptual/WinPanel/Concepts/HowWindowsWork.html#//apple_ref/doc/uid/20000221-BBCECFDH)

# delphi - Delphi 2009 - 对象检查器中的自定义枚举类型属性

> ID：729315
> 
> 赞同：2
> 
> 时间：2009-04-08T09:58:27.350
> 
> 标签：delphi, delphi-2009, custom-component

我创建了一个自定义 TAction 类型，它有 2 个附加属性，它们是字符串类型和枚举。

字符串值在对象检查器中正常显示，但是枚举类型根本没有出现。如何获取自定义枚举类型以在对象检查器中显示为下拉属性值？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-08T11:42:13.327

枚举属性应该使用默认的 TEnumProperty 类来编辑属性。

似乎找不到 RTTI 信息。枚举类型在哪里定义？在与组件相同的文件中？

您是否使用具有自定义值的枚举类型，例如：

```
TMyEnum = (aA = 1, aB = 3); 
```

说明：如果您定义一个带有值的枚举，您将创建一个带有预定义常量的子范围类型。所以上面要解释为：

```
type
  TMyEnum = 1..3;
const
  aA : TMyEnum = 1;
  aB : TMyEnum = 3; 
```

这可能会导致奇怪的情况，例如：Succ(aA) 不是 aB，而是 2。信息在帮助（语言指南）简单类型 [具有显式分配序数的枚举类型] 中。

这可能是问题的根源。

如果一切都失败了，您可以创建自己的属性编辑器。它能够更改对象检查器中的枚举属性。通常你可以使用默认的 TEnumProperty。但如果这还不够，你可以自己动手：

第 1 步，派生一个属性编辑器。在您的情况下，可能 TEnumProperty （单位 DesignEditors）可能只需很少的更改就足够了。

第 2 步，确保 GetValue 和 SetValue 方法工作正常。他们需要将字符串转换为枚举属性并返回。

第 3 步，如果您想要真正的特殊编辑，请确保覆盖编辑方法。

第 4 步，确保编辑器属性有效。

第 5 步，使用 RegisterPropertyEditor 注册属性编辑器。

只需查看组件编写器指南以获取更多信息。

# asp.net-mvc - 视图到控制器通信

> ID：729319
> 
> 赞同：1
> 
> 时间：2009-04-08T09:58:59.890
> 
> 标签：asp.net-mvc, model-view-controller, controller

我试图找到在我需要例如过滤的情况下视图控制器通信的最佳实践。

我收集了页面上的项目和过滤器控件。我正在按字母、状态等过滤项目......这是一个简单的场景，我将过滤器选择的值发送给控制器，控制器将结果返回给页面。

如果您考虑一下，这是一个方向循环。查看带有参数（过滤器值）的调用控制器，控制器调用数据库，然后获取元素并将该元素返回给视图。有没有办法将这些元素和控制器发送到控制器只是为了过滤它们并将过滤后的集合返回给视图？或者也许可以缩短到服务器的行程，给控制器只是元素的 id，控制器知道要从数据库中提取哪些元素，然后过滤它们，将过滤后的集合返回......

不好的做法？一些工作？

你怎么看？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T15:54:25.890

我是如何做到这一点的，就像您在上一段中提到的那样：

> 将这些元素和控制器发送到控制器只是为了过滤它们并将过滤后的集合返回给视图

您可以使用 linq 来执行此操作。所以让我们说一下你发送给它的一个列表。因此，当您执行过滤器时 - 比如说按类别 - 您期望按类别过滤列表（比如说 Category = “Book”）。

因此，在您的控制器中，您的 List() 操作（或您所称的任何操作）应该准备好接受过滤器参数。然后基于该参数使用 LINQ 缩小要传递给视图的集合。像这样：

```
public ActionResult List(bool fromCache, string filter)
{
    // if filtering - always pull from cache to increase performance
    ProductList productList;
    if (fromCache)
        productList = Session[SessionKeys.ProductList] as ProductList;
    else
    {
        productList = ProductInfoList.GetProductInfoList();
        Session[SessionKeys.ProductInfoList] = productList;
    }

    // apply filter
    var data = productList.Where(p => p.Category == filter);
    return View(ViewLocations.ProductListing, data);
} 
```

代码可能在语法上不正确，但你去 - 祝你好运。

# open-source - 开源 Java 项目（具有良好的设计文档）

> ID：729325
> 
> 赞同：2
> 
> 时间：2009-04-08T10:00:37.843
> 
> 标签：open-source

我写信是为了对一些精心设计的开源 Java 项目提出一些建议，这些项目包含良好的设计文档——尤其是随着越来越多的人研究它（并在提议的设计中提出了缺陷？），设计是如何演变的）。

我记得读过 Joel Spolsky 的评论，关于软件产品（或项目）的大部分价值来自良好的设计。虽然他发布了一个好的功能规范（CoPilot）的例子，但他（遗憾地）没有发布这个功能规范随后如何转化为技术规范，以及最终产品的设计。

目前，我正在尝试参与开源项目，以发展我的 Java 技能。我正处于一个平台期（为了取得进展），我需要更深入地了解项目如何从功能需求演变为技术设计，以便在融合到当前存在的代码库之前了解所考虑的问题。

我查看的大多数开源 Java 项目似乎都没有关于在融合到今天存在的设计（代码）之前考虑了哪些问题的任何信息。我确信某人（在某些时候）必须（至少）发布了一个类图，该类图对不同实体之间的关系进行建模，并说明为什么以这种方式设计它。

任何指针将不胜感激。

亲切的问候， 迪努克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T10:22:31.287

查看 Apache 项目。他们大多都有很好的文档记录，并且有活跃的开发和用户邮件列表，您可以在其中获取超出文档记录的信息。除了查看邮件列表上的过去对话之外，您还会看到出现了哪些问题以及如何解决这些问题。

# facebook - Facebook 用户没有头像，但我的网络应用程序中也没有显示默认的空白头像

> ID：729327
> 
> 赞同：3
> 
> 时间：2009-04-08T10:01:17.670
> 
> 标签：facebook, avatar

我有一个 Facebook 应用程序，我在我的页面上展示了 Facebook Connected 用户。

但我看到这个特定用户的头像是空白的。然而，Facebook 自己的“无照片”图像以及右下角的“f”标志都没有显示。

不明白为什么这么奇怪，有没有办法确定这样的用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T10:26:18.483

如果 Facebook 自己的头像也没有显示，这是 facebook 本身的错误/问题，与您的应用程序无关。我建议将此作为错误报告给 Facebook，然后等待他们修复。

编辑：问题似乎是用户尝试上传图像，但文件在上传过程中损坏，现在显示损坏的图像图标。只需要求用户重新上传他的图像​​，很可能会修复它。

# jquery - JQuery .trigger('submit') 中断

> ID：729330
> 
> 赞同：3
> 
> 时间：2009-04-08T10:02:46.950
> 
> 标签：jquery, form-submit

我发现，因为我正在处理的所有表单都有一个包含“name="submit"”属性的提交按钮，所以当我单击应该触发表单提交的链接时，触发器提交正在中断。

有谁知道我该如何解决这个问题。

下面的 JQuery 代码是我使用的：

```
$('#login_form :submit').each(
       function()
       {
          var $this = $(this);
          var f = this.form;
          var link = $('<a class="swap_link" href="#">' + $this.val() + '</a>')
             link.click(function()

                {
                   $(f).trigger('submit');
                   return false;
                }
             )
            $this.after(link).css({position:'absolute', top:'-2000px'});
            }
        ) 
```

感谢您对此的任何帮助。谢谢

你好。查看下面的链接：

[http://www.mr-scraggy.com/test.html](http://www.mr-scraggy.com/test.html)

在此页面上，您可以看到正在运行的表单。提交按钮中没有 name="submit" 的顶部表单有效。包含 name="submit" 的底部表单没有。（当我说工作时，表单没有连接到任何脚本，但您可以看到顶部表单中的提交链接做了“某事”）。

另请参见 html 表单下方：

```
<form id="swaplink" name="login" action="/action/login.php" method="post" accept-charset="utf-8" class="clearfix">
<input type="hidden" name="redirecturl" id="redirecturl" value="{$redirecturl}" />
<h2>My Account Login</h2>
<ul id="login_form">
    <li>
        <label for="username">Username:</label>
        <input type="text" name="username" id="username" class="input-text" maxlength="32" />
        </li>
    <li>
    <label for="password">Password:</label>
    <input type="password" name="password" id="password" class="input-text" maxlength="32" />
        </li>
    <li>
    <input type="submit" name="submit" value="Login" />
    </li>
</ul>
    {$failed_message}
</form> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-11-12T22:28:01.710

这是因为您为提交按钮命名为“提交”。因为这已经是表单对象的一个​​属性，所以它与提交事件的绑定混淆了。

[请参阅jQuery 文档](http://api.jquery.com/submit/)中的此注释：

> 表单及其子元素不应使用与表单属性（例如提交、长度或方法）冲突的输入名称或 ID。名称冲突可能会导致令人困惑的失败。

将提交按钮的名称更改为其他任何名称（例如“form_submit”），它就会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T23:26:53.227

您必须为按钮使用不同的名称。“submit”是一个保留字，使用名为“submit”的元素实际上会阻止 jQuery 提交您的表单。

[您可以在http://manicode.blogspot.com/2009/04/form-input-names-with-reserved-words.html](http://manicode.blogspot.com/2009/04/form-input-names-with-reserved-words.html)找到解决方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-03-14T16:04:11.057

如果你不能改变你的 html （例如因为 zend 表单是如此聪明......）

就这么简单（在尝试提交之前用 javascript 更改名称）：

```
$('#submit').attr('name', 'stupid_javascript'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T14:49:20.223

您应该像这样构建链接：

```
var link = $("<a />").addClass('swapLink')
           .atrr('href', '#')
           .text( $this.val() )
           .onclick( function() {
             $(f).trigger('submit');
             return false;
            }); 
```

还要确保将链接插入到 DOM 中，并且 f 确实是对表单的引用。

你也可以试试：

```
$(f).submit(); 
```

如果您发布用于表单的 HTML，将会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-10T04:41:43.587

`$('#yourelementhere').trigger('click');`

这对我有用...不是提交，而是点击。

# spidermonkey - jsprf.c:644：错误：分配中的类型不兼容

> ID：729331
> 
> 赞同：0
> 
> 时间：2009-04-08T10:02:50.210
> 
> 标签：spidermonkey, nspr

你能帮我解决我在 PPC 中构建 Spidermonkey 时遇到的这个错误吗？

```
make -f Makefile.ref cat: ../../dist/Linux_All_DBG.OBJ/nspr/Version:
没有这样的文件或目录
cd 编辑线；make -f Makefile.ref all
make[1]: 进入目录`/units/
spidermonkey-1.8-next-wip/src/editline'
make[1]: 'all' 无事可做。
make[1]: 离开目录`/units/
spidermonkey-1.8-next-wip/src/editline'
make -f Makefile.ref Linux_All_DBG.OBJ/libjs.a Linux_All_DBG.OBJ/
libjs.so Linux_All_DBG.OBJ/js Linux_All_DBG.OBJ/jsautocfg.h
Linux_All_DBG.OBJ/jscpucfg Linux_All_DBG.OBJ/jscpucfg.o
cat：../../dist/Linux_All_DBG.OBJ/nspr/Version：没有这样的文件或
目录
make[1]: 进入目录`/units/
spidermonkey-1.8-next-wip/src'
make[1]: 循环 jscpucfg.h <- Linux_All_DBG.OBJ/jsautocfg.h
依赖性下降。
make[1]: 循环 Linux_All_DBG.OBJ/jsautocfg.h <- Linux_All_DBG.OBJ/
jsautocfg.h 依赖项已删除。
/powerpc-750-
linux-gnu_gcc-3.4.6/bin/powerpc-750-linux-gnu-gcc -o Linux_All_DBG.OBJ/
jsprf.o -c -Wall -Wno-format -MMD -DGCC_OPT_BUG -g3 -DXP_UNIX -DSVR4 -
DSYSV -D_BSD_SOURCE -DPOSIX_SOURCE -DHAVE_LOCALTIME_R -DX86_LINUX -
DDEBUG -DDEBUG_build -DEDITLINE -ILinux_All_DBG.OBJ jsprf.c
jsprf.c：在函数“BuildArgArray”中：
jsprf.c:644：错误：分配中的类型不兼容
make[1]: *** [Linux_All_DBG.OBJ/jsprf.o] 错误 1
make[1]: 离开目录`/units/
spidermonkey-1.8-next-wip/src'
make: *** [全部] 错误 2

```

我正在使用 Redhat-Linux 机器。

我是否也需要 NSPR 来交叉编译蜘蛛猴？

非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-01-17T15:26:09.977

修复在这里：http: [//github.com/janl/couchdbx-core/blob/ff47372552d10df00d74cb7989dfed4a19a6040d/patches/js/patch-jsprf.c](http://github.com/janl/couchdbx-core/blob/ff47372552d10df00d74cb7989dfed4a19a6040d/patches/js/patch-jsprf.c)

BR维尔姆

# windows - 使用 SED 时出现“系统找不到文件”错误

> ID：729333
> 
> 赞同：1
> 
> 时间：2009-04-08T10:03:44.233
> 
> 标签：windows, batch-file, sed, cmd

我`sed`用来查找 txt 文件中的总行数。我想将 sed 的输出分配给一个变量。

我使用以下代码来执行此操作：

```
for /f %%a in (`"sed15 -n $= TEST.TXT"') do set linenum=%%a 
```

我收到此错误消息：

```
the system cannot find the file `"sed15 -n $= TEST.TXT"' 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-04T01:03:14.290

需要知道如何解释反引号：

```
for /f "usebackq" %%a in (`sed15 -n $= TEST.TXT`) do (set linenum=%%a) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T10:07:00.607

它正在寻找与您启动 DOS 命令的路径相关的文件。您可以提供文件的完整路径 - c:\text.txt 等，也可以在正确的目录中启动命令。

# php - 有没有办法在启动时将弹性 IP 地址与 EC2 实例相关联？

> ID：729344
> 
> 赞同：2
> 
> 时间：2009-04-08T10:07:35.143
> 
> 标签：php, rest, batch-file, amazon-ec2

您好我正在开发代码以在 Amazon Web Services 上启动 EC2 映像的实例，有 2 个步骤

1) 启动实例 2) 将我们的弹性 IP 地址分配给启动的实例

有没有办法在一个命令中执行这两个？

我将运行一个 .bat 文件来启动实例，然后当实例运行时，我将使用 REST 查询 API 来调用 AssociateAddress。除了定期调用它之外，我还不确定如何最好地确定启动的实例何时从挂起变为运行。我可以将 IP 地址关联到待处理的实例吗？

斯蒂芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T16:47:22.267

当然，您需要向您的 EC2 实例添加一个启动脚本，该脚本在启动时运行 allocate-address 命令以执行弹性 IP 的关联。这是向 EC2 实例添加启动/关闭脚本的[教程](http://sam.curren.ws/index.cfm/2007/9/13/EC2-Running-scripts-on-startup-and-shutdown)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T17:07:41.003

是的，您可以将 IP 分配给待处理的实例。它是从防火墙而不是您的实例处理的，因此无需运行即可进行更改。您的实例实际上永远不会知道弹性 IP。

# python - 在groovy中识别地图

> ID：729354
> 
> 赞同：3
> 
> 时间：2009-04-08T10:16:07.183
> 
> 标签：python, groovy

在从 python 移植代码片段时，我偶然发现了一个小问题：

```
if isinstance(v['content'], dict): 
```

将它移植到 groovy 的最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T11:30:36.270

您可以使用（请参阅[此处](http://groovy.codehaus.org/Collections)`instanceof`的地图特定示例），如下所示：

```
if (v['content'] instanceof java.util.map) 
```

# vb6 - 使用 webbrowser 控件保存网页

> ID：729355
> 
> 赞同：2
> 
> 时间：2009-04-08T10:16:21.660
> 
> 标签：vb6, webbrowser-control

我正在使用 VB6 和 webbrowser 控件导航到网页。我想在没有任何人工干预的情况下定期保存我访问的页面。

我知道如何使用 DOM 解析 HTML。但也需要保存页面而不显示任何对话框。

这可能吗？将不胜感激一些帮助。

谢谢。陶菲克。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T16:13:21.423

这篇[Microsoft 知识库文章](http://support.microsoft.com/kb/244757)(Q244757) 说无法使用 Web 浏览器控件执行此操作，但提供了使用 UrlMon.dll 的替代解决方案，我将其放在下面。

```
Private Declare Function URLDownloadToFile Lib "urlmon" Alias _ 
  "URLDownloadToFileA" (ByVal pCaller As Long, ByVal szURL As String, _ 
  ByVal szFileName As String, ByVal dwReserved As Long, _ 
  ByVal lpfnCB As Long) As Long 

returnValue = URLDownloadToFile(0, "http://www.microsoft.com/ms.htm", _
  "c:\ms.htm", 0, 0) 
```

显然，它不会下载像图像这样的嵌入内容。UrlMon.dll[需要](http://msdn.microsoft.com/en-us/library/ms775123(VS.85).aspx)Internet Explorer 3，因此可以在任何现代 PC 上使用。

对于加分，这里是如何[**异步**](https://stackoverflow.com/questions/537580/how-to-download-multiple-files-in-vb6-with-progress-bar/538382#538382)[下载多个文件](https://stackoverflow.com/questions/537580/how-to-download-multiple-files-in-vb6-with-progress-bar/538382#538382)**，在 100% 原生 VB6 中，根本不需要 API 调用！**

 **# php - 用户提供的输入 SQL 转义

> ID：729356
> 
> 赞同：1
> 
> 时间：2009-04-08T10:17:27.833
> 
> 标签：php, mysql, escaping, mysql-real-escape-string

你能给我建议吗？我搜索了问题，但没有找到与我相似的问题。

当我打算在 SQL 查询中使用我的用户输入时，如何使它们自动转义？我不喜欢在我的代码中充满类似的东西

```
$var_x = $DB->Escape($_POST['var_x']);
$another_var = $DB->Escape($_POST['another_var']);
$some_string = $DB->Escape($_POST['some_string']);
... 
```

*假设我有执行 mysql_real_escape_string 的 Escape 方法的数据库类*

但我也不能在 SQL 查询上设置自动转义，因为它会破坏插入查询：

```
function Exec($sql){
   $result = mysql_query($this->Escape($sql));
}

$q = $DB->Exec("SELECT * FROM table WHERE id = 'xxx'"); 
```

它使他们成为\'xxx\'。这是不正确的。

我想做的最后一件事是制作参数化语句，因为它会使系统更加复杂。当没有其他东西时，我会考虑这个选项。

简而言之 - 如何制作适用于整个查询并仅转义值的智能自动转义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T10:20:38.967

事实上，您应该考虑的一件事也是唯一一件事（我们这里显然不是在谈论测试项目）是使用参数化语句。这是唯一的方法（当然，当 SQL 语法允许它们时）。如果做得好，这些不会使您的系统更复杂，但它们*会*使其更健壮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T10:38:46.067

对不起，你不能自动任何东西。当你连接字符串时，你总是会遇到字符转义问题；这不是您可以“解决”一次就不必再考虑的事情。

如果你这样做：

```
$a= "a'b";
$query= "SELECT * FROM things WHERE name='$a'"; 
```

然后，您的查询字符串包含作为字符串文字中真正撇号的撇号和作为字符串定界符的撇号：

```
SELECT * FROM things WHERE name='a'b' 
```

一个人需要逃脱；另一个不能。你怎么知道哪个是哪个？您不能，该信息将永远丢失。你必须改为说：

```
$query= "SELECT * FROM things WHERE name='".mysql_real_escape_string($a)."'"; 
```

（或任何其他转义函数更适合您正在使用的数据库。）

丑陋？地狱是的。这就是我们使用参数化查询的原因。这摆脱了字符串连接的所有麻烦。

字符串连接看起来很简单。人们认为他们理解将字符串连接在一起。但实际上，他们没有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T10:22:56.947

我使用这种方法：

```
$db->set('name',$name);
$db->set('title',$title);
$db->insert('users'); 
```

这里`$db->set()`方法自动转义值（即第二个参数）。

使用 PHP 5，您还可以这样做：

```
$db->set('name',$name)->set('title',$title)->insert('users'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T10:54:29.213

> *我想做的最后一件事是制作参数化语句，因为它会使系统更加复杂。当没有其他东西时，我会考虑这个选项。*

想解释一下您关于参数化查询“更复杂”的说法吗？我不会将外部数据连接到查询中——*从来没有*——这是世界上最简单的事情，并且比任何转义技术都更接近“防弹”。

# c# - SelectedNode = .Nodes[0] 上的线程异常

> ID：729359
> 
> 赞同：0
> 
> 时间：2009-04-08T10:19:21.807
> 
> 标签：c#, user-interface, thread-exceptions

为什么我会得到 System.Threading.ThreadStateException？

```
void setupTree(TreeView tv, MyObj o)
{

    tv.Invoke((MethodInvoker)delegate
    {
        tv.Nodes.Clear();
        tv.Nodes.Add("<root>").Tag = o;
        tv.SelectedNode = tv.Nodes[0]; //it happens here
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T10:24:47.210

TreeView 是否已创建其句柄？

你能发布一个简短但完整的程序来证明这一点吗？

# wpf - WPF - 获取可视化树的快速方法

> ID：729360
> 
> 赞同：0
> 
> 时间：2009-04-08T10:19:22.697
> 
> 标签：wpf, visual-tree

我在网格中动态添加一些控件。我不知道有多少，也不知道确切的层次结构。我想要做的是访问一些具有特定类型的控件（例如按钮）并实例化一些属性。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T10:31:44.243

您可以在网格级别覆盖按钮样式。这是一个例子：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="144*" />
        <RowDefinition Height="171*" />
    </Grid.RowDefinitions>
    <Grid.Resources>
        <!-- Override all Buttons style that are childs of the grid -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="LightBlue"/>
            <Setter Property="FontSize" Value="20" />
        </Style>
    </Grid.Resources>
    <Button Grid.Row="0">Button1</Button>
    <Button Grid.Row="1">Button2</Button>
</Grid> 
```

在此示例中，放置在网格内的所有按钮都具有由网格资源中定义的样式设置的背景和字体大小。

编辑：这也适用于在运行时添加的控件按钮，样式将在添加到网格时应用于这些控件，并且您还可以根据需要以编程方式定义样式并将它们添加到网格资源中，它们将自动应用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T10:38:14.680

您必须使用 VisualTreeHelper 逐步完成[VisualTree](http://msdn.microsoft.com/en-us/library/system.windows.media.visualtreehelper_members.aspx)。有一些很好的例子说明如何获得[特定类型的控件](http://miguelmadero.blogspot.com/2008/07/use-visualtreehelper-to-navigate_18.html)

# sql-server - 如何使用 sqlsqerver 2005 将数据从一个数据库提取到另一个数据库

> ID：729362
> 
> 赞同：0
> 
> 时间：2009-04-08T10:20:50.963
> 
> 标签：sql-server

如何使用 sqlsqerver 2005 将数据从一个数据库拉到另一个数据库

就像..从一个导出数据并导入到另一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T10:24:57.613

任你选。

1.  链接服务器/数据库。
2.  SSIS
3.  从一个导出数据并导入到另一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T10:29:36.183

除了无人回答，如果数据库都是 SQL Server

4）从Server.Database.Owner.Table中选择*进入New_Table

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T13:51:45.480

根据您的评论，我了解两个数据库都在同一台服务器上您可以简单地执行以下操作：

```
use YourDestinationDatabaseName;

select * into dbo.yourNewTable from YourSourceDatabase.dbo.YourSourceTable 
```

如果你想插入到已经存在的表中

```
use YourDestinationDatabaseName;

insert into dbo.YourDestinationTable 
select * from YourSourceDatabase.dbo.YourSourceTable 
```

或更准确地说：

```
use YourDestinationDatabaseName;

insert into dbo.YourDestinationTable( col1, col2, etc...) 
select 
    col1a, col2a, etc ... 
from 
    YourSourceDatabase.dbo.YourSourceTable 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T14:06:43.697

如果你有 VS 2005，我喜欢这个工具，因为它生成 t-sql：[http ://www.microsoft.com/downloads/details.aspx?FamilyId=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en](http://www.microsoft.com/downloads/details.aspx?FamilyId=56E5B1C5-BF17-42E0-A410-371A838E570A&displaylang=en)

# c++ - 是否可以访问类的私有成员？

> ID：729363
> 
> 赞同：4
> 
> 时间：2009-04-08T10:21:28.557
> 
> 标签：c++, private, member

是否可以在 c++ 中访问类的私有成员。

> 前提是您没有朋友功能并且您无权访问类定义

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T10:23:31.720

您的意思是使用一些指针算法来获得访问权限？这是可能的，但绝对是危险的。也看看这个问题：[Accessing private members](https://stackoverflow.com/questions/726096/accessing-private-members/726304#726304)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T11:08:40.520

我认为有一些像这样的老派把戏：

```
#define private public
#include "header.h"
#define private private 
```

但是您强烈建议不要这样做（我已经快速阅读了 C++ 标准中关于此的内容） - 如果您想了解更多关于“#define private public”的谷歌信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T11:05:47.967

好吧，我可能在胡说八道，但我认为您可以尝试定义一个“双胞胎”类，其成员与您要修改的类相同但具有不同的公共/私有修饰符，然后使用 reintepret_cast 将原始类转换为您所在的类可以访问私有成员。

它有点hacky ;-)

一些代码来解释这个想法：

```
class ClassWithNoAccess 
{
public:
  someMethod();

private:
  int someVar;
};

class ClassTwin 
{
public:
  someMethod();

public:
  int someVar;
} 
```

在代码中的某处：

```
ClassWithNoAccess* noAccess = new ClassWithNoAccess();
ClassTwin* twin = reinterpret_cast<ClassTwin *>(noAccess);
twin->someVar = 1; 
```

编辑：所以就像有人之前已经写过的那样，这可能有效，但标准不保证带有 public 和 private 修饰符的变量的顺序是相同的

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T13:19:56.057

即使通过一些令人讨厌的黑客攻击是可能的——请参阅之前的帖子——你不应该这样做。

封装是为了一个很好的目的而存在的，将类成员设置为私有意味着开发人员不打算让任何人搞乱该成员。这应该意味着

“您无需访问此成员即可完全使用公共接口”

# java - 使用 ClassFileTransformer.transform 的字节码检测

> ID：729368
> 
> 赞同：6
> 
> 时间：2009-04-08T10:22:03.610
> 
> 标签：java, instrumentation

我已经编写了一个带有`premain`方法的类，并且在该方法中我添加了一个`ClassFileTransformer`to `Instrumentation`( `Instrumentation.addTransformer()`)。

我调用了一个应用程序

```
java -javaagent:<path_to_agnet.jar> <application> 
```

但是`ClassFileTransformer.transform()`方法没有被调用。
我观察到`premain`正在调用它。
我还观察到，如果我调用`Instrumentation.retransformClasses()`, then`ClassFileTransformer.transform()`就会被调用。
在第一个定义 ( `Classloader.defineClass()`) 中，`transform()`没有调用方法。

任何线索可能是什么问题？

注意：如果有任何帮助，我可以发布源代码。

问候，雷吉夫。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T10:34:53.567

### 可能的原因

.

**不正确的清单**

您是否遵循了定义 Instrumentation 类[所需的所有步骤？](http://www.donniepinkston.net/pages/programming-notes/simple-java-profiler)

尤其是“打包”步骤，它涉及在 JAR 清单中指定一组略有不同的属性：

> *   而不是`Main-Class`，您必须指定一个属性，该属性给出在您的代理`Premain-Class`中实现的类的完整类名。`premain()`

```
Premain-Class: my.package.MyAgentClass 
```

> *   如果您的代理使用任何类库，那么您应该指定该`Boot-Class-Path`属性，因为您的检测代理将需要其库从引导类加载器中可见。
>     如果您不这样做，您可能不得不对`-Xbootclasspath/a:...`JVM 使用古怪的参数。
>     命令行参数是让事情顺利进行的一种不错的方式，但从长远来看，您希望使用此属性，因为命令行已经因必须指定 Java 检测代理而增长。还不如让它尽可能简单。
>     
>     
> *   最后是`Can-Redefine-Classes`属性。
>     如果设置为 true，则 Java 检测代理能够重新定义代理本身使用的类。
>     这是一个非常奇怪的情况，当然不会出现太多。

.

**静默异常**

（[Rejeev Divakaran](https://stackoverflow.com/users/10980/rejeev-divakaran)得到了那个）。

我`classBeingRedefined.getName()`用来打印班级名称。
**`classBeingRedefined`是`null`第一次加载的时候**。

底线是**transform 方法中是否存在未捕获的异常**。
它会被**默默地吃掉**。

# c# - C#中带有winform的FIFO

> ID：729369
> 
> 赞同：1
> 
> 时间：2009-04-08T10:22:29.103
> 
> 标签：c#, fifo

我对线程中的 GUI 问题感到恼火。我如何创建一个 FIFO，以便我的主窗体/线程将接收数据来做事，而不是让我的线程使用回调并自己运行代码（并失败）？

有问题的gui问题-> [SelectedNode = .Nodes [0]上的线程异常](https://stackoverflow.com/questions/729359/thread-exception-on-selectednode-nodes0/729377)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T10:24:33.637

使用[SynchronizationContext](https://stackoverflow.com/search?q=SynchronizationContext)`Post` / `Send`“调用”到 UI 线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T10:33:12.197

Winform 控件上的 BeginInvoke，要跨线程进行调用，将使用 Window 的消息队列，即 FIFO。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T10:34:36.810

如果您有主窗体（或任何控件）的句柄，则可以使用`Control.Invoke`/ `Control.BeginInvoke`。

如果您不想分发`Control`实例，则可以为外部代码提供一个`ISynchronizeInvoke`实例（任何控件都会这样做，或者编写自己的类来*包装*a`Control`以防止调用者强制转换）。然后调用者可以使用它来执行方法。

最后，考虑使用事件；正在运行的代码引发您的 UI 处理的事件；然后 UI 可以`Control.Invoke`在本地调用以处理数据。

# c# - 如果 watin 中出现对话框，默认情况下如何使测试失败

> ID：729374
> 
> 赞同：3
> 
> 时间：2009-04-08T10:24:13.043
> 
> 标签：c#, .net, testing, automation, watin

每当出现对话框并且没有附加处理程序时，watin 自动关闭对话框。当您不想为应用程序可能具有的不同/几个简单确认添加代码时，这很有帮助。

问题是使用这种默认行为可能会导致一些简单的问题被忽视，例如在不应该出现的场景中出现确认对话框。

我正在寻找一种简单的方法来在出现未处理的对话框时优雅地使测试失败。优雅地，我的意思是当对话框出现异常时测试会立即停止，这会给出一个体面的消息，让您知道这是一个意外的对话框错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T08:11:45.147

另一种选择可能是使用 AlertAndConfirmDialogHandler。这个处理程序会关闭每个弹出的警报或确认对话框，但首先它会获取对话框显示的文本并将其存储。您可以检查此 Alerts 字符串数组并查看 Count 是否为零。您可以在测试类的 Teardown 或 FixtureTeardown 中执行此操作。

按照 WatiN 单元测试中的测试副本向您展示如何使用此处理程序：

```
 [Test]
    public void AlertAndConfirmDialogHandler()
    {
        DialogWatcher dialogWatcher;

        Assert.AreEqual(0, Ie.DialogWatcher.Count, "DialogWatcher count should be zero before test");

        // Create handler for Alert and confirm dialogs and register it.
        var dialogHandler = new AlertAndConfirmDialogHandler();
        using (new UseDialogOnce(Ie.DialogWatcher, dialogHandler))
        {
            Assert.AreEqual(0, dialogHandler.Count);

            Ie.Button("helloid").Click();

            Assert.AreEqual(1, dialogHandler.Count);
            Assert.AreEqual("hello", dialogHandler.Alerts[0]);

            // remove the alert text from the queue by using Pop
            Assert.AreEqual("hello", dialogHandler.Pop());

            Assert.AreEqual(0, dialogHandler.Count);

            // Clear the queue
            Ie.Button("helloid").Click();

            Assert.AreEqual(1, dialogHandler.Count);

            dialogHandler.Clear();

            Assert.AreEqual(0, dialogHandler.Count);

            dialogWatcher = Ie.DialogWatcher;
        }

        Assert.AreEqual(0, dialogWatcher.Count, "DialogWatcher count should be zero after test");
    } 
```

这也促使我使 AutoClose 行为更具可插入性。如果可以注册一个对话框处理程序，如果没有其他处理程序可以处理对话框，而不是自动关闭对话框，它将被调用，这将是很好的。

HTH Jeroen van Menen 领导开发者 WatiN

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T10:25:05.087

现在我们正在使用：

```
browser.DialogWatcher.CloseUnhandledDialogs = false 
```

它有以下（丑陋的）问题：

1.  该错误显示为下一个操作的超时（使用消息“Internet Explorer 忙时超时”）。
2.  由于上述原因，测试中存在不必要的延迟
3.  意外弹出的实例保持打开状态（在处置之后）。

# exception - 为什么不使用异常作为常规控制流？

> ID：729379
> 
> 赞同：210
> 
> 时间：2009-04-08T10:25:01.827
> 
> 标签：exception, language-agnostic

为了避免我在谷歌上搜索到的所有标准答案，我将提供一个大家都可以随意攻击的例子。

C# 和 Java（以及太多其他）有很多类型的一些我根本不喜欢的“溢出”行为（例如`type.MaxValue + type.SmallestValue == type.MinValue`：） `int.MaxValue + 1 == int.MinValue`。

但是，看到我的恶毒本性，我会通过将这种行为扩展到，让我们说一个 Overridden`DateTime`类型来增加对这种伤害的侮辱。（我知道`DateTime`在 .NET 中是密封的，但为了这个示例，我使用的伪语言与 C# 完全一样，只是 DateTime 没有密封）。

被覆盖的`Add`方法：

```
/// <summary>
/// Increments this date with a timespan, but loops when
/// the maximum value for datetime is exceeded.
/// </summary>
/// <param name="ts">The timespan to (try to) add</param>
/// <returns>The Date, incremented with the given timespan. 
/// If DateTime.MaxValue is exceeded, the sum wil 'overflow' and 
/// continue from DateTime.MinValue. 
/// </returns>
public DateTime override Add(TimeSpan ts) 
{
    try
    {                
        return base.Add(ts);
    }
    catch (ArgumentOutOfRangeException nb)
    {
        // calculate how much the MaxValue is exceeded
        // regular program flow
        TimeSpan saldo = ts - (base.MaxValue - this);
        return DateTime.MinValue.Add(saldo)                         
    }
    catch(Exception anyOther) 
    {
        // 'real' exception handling.
    }
} 
```

当然 if 可以很容易地解决这个问题，但事实仍然是我只是看不到为什么你不能使用异常（从逻辑上讲，我可以看到当性能是一个问题时，在某些情况下应该避免异常）。

我认为在许多情况下，它们比 if 结构更清晰，并且不会破坏该方法正在制定的任何合同。

恕我直言，“永远不要将它们用于常规程序流程”的反应似乎每个人都没有那么好，因为这种反应的强度可以证明是合理的。

还是我弄错了？

我读过其他帖子，处理各种特殊情况，但我的观点是，如果你们都是这样的话，这没有什么问题：

1.  清除
2.  遵守您的方法的合同

射击我。

* * *

## 回答 #1

> 赞同：188
> 
> 时间：2009-04-08T10:41:46.590

您是否尝试过调试在正常运行过程中每秒引发 5 个异常的程序？

我有。

该程序非常复杂（它是一个分布式计算服务器），在程序的一侧稍作修改就可以很容易地在完全不同的地方破坏某些东西。

我希望我可以启动程序并等待异常发生，但是*在正常操作过程中启动期间大约有 200 个异常*

我的观点：**如果您在正常情况下使用异常，您如何定位异常（即*异常*al）情况？**

当然，还有其他强有力的理由不要过多地使用异常，尤其是在性能方面

* * *

## 回答 #2

> 赞同：171
> 
> 时间：2009-04-08T10:37:22.530

异常基本上是非本地`goto`语句，具有后者的所有后果。使用异常进行流控制违反了[最小惊讶原则](http://c2.com/cgi/wiki?PrincipleOfLeastAstonishment)，使程序难以阅读（请记住，程序首先是为程序员编写的）。

此外，这不是编译器供应商所期望的。他们期望很少抛出异常，并且他们通常让`throw`代码效率很低。抛出异常是 .NET 中最昂贵的操作之一。

但是，某些语言（尤其是 Python）使用异常作为流控制结构。例如，`StopIteration`如果没有其他项，迭代器会引发异常。即使是标准语言结构（例如`for`）也依赖于此。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2009-04-08T10:38:53.400

我的经验法则是：

*   如果您可以采取任何措施从错误中恢复，请捕获异常
*   如果错误很常见（例如，用户尝试使用错误的密码登录），请使用返回值
*   如果您无法从错误中恢复，请不要将其捕获（或者在您的主​​要捕获器中捕获它以对应用程序进行一些半优雅的关闭）

我看到的异常问题是从纯语法的角度来看的（我很确定性能开销是最小的）。我不喜欢到处都是try-blocks。

举个例子：

```
try
{
   DoSomeMethod();  //Can throw Exception1
   DoSomeOtherMethod();  //Can throw Exception1 and Exception2
}
catch(Exception1)
{
   //Okay something messed up, but is it SomeMethod or SomeOtherMethod?
} 
```

.. 另一个例子可能是当您需要使用工厂将某些内容分配给句柄时，该工厂可能会抛出异常：

```
Class1 myInstance;
try
{
   myInstance = Class1Factory.Build();
}
catch(SomeException)
{
   // Couldn't instantiate class, do something else..
}
myInstance.BestMethodEver();   // Will throw a compile-time error, saying that myInstance is uninitalized, which it potentially is.. :( 
```

Soo，就个人而言，我认为您应该为罕见的错误条件（内存不足等）保留异常，并使用返回值（值类、结构或枚举）来进行错误检查。

希望我理解你的问题是正确的:)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2009-04-08T11:26:06.733

对很多答案的第一反应：

> 您正在为程序员和最小惊讶原则写作

当然！但是，如果只是不是一直更清楚。

这不应该*令人惊讶*，例如：divide (1/x) catch (divisionByZero) 对我来说比任何 if 都更清楚（在 Conrad 和其他人）。不期望这种编程的事实纯粹是传统的，实际上仍然是相关的。也许在我的例子中 if 会更清楚。

但是 DivisionByZero 和 FileNotFound 在这方面比 ifs 更清楚。

当然，如果它的性能较低并且每秒需要大量时间，您当然应该避免它，但我仍然没有读到任何避免整体设计的充分理由。

就最小惊讶原则而言：这里存在循环推理的危险：假设整个社区使用了一个糟糕的设计，这个设计将成为预期！因此，该原则不能成为圣杯，应慎重考虑。

> 正常情况的例外情况，您如何定位异常（即异常）情况？

在许多反应中。像这样闪耀着低谷。抓住他们，不是吗？你的方法应该是清晰的，有据可查的，并且遵守它的合同。我没有得到这个我必须承认的问题。

调试所有异常：相同，有时只是这样做，因为不使用异常的设计很常见。我的问题是：为什么它首先很常见？

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2013-07-12T22:21:12.280

在异常之前，在 C 中，有`setjmp`并且`longjmp`可以用来完成类似的堆栈帧展开。

然后给相同的构造一个名称：“异常”。并且大多数答案都依靠这个名字的含义来争论它的用法，声称异常是为了在异常情况下使用。这绝不是原作的意图`longjmp`。在某些情况下，您需要中断许多堆栈帧的控制流。

异常稍微更普遍，因为您也可以在同一个堆栈帧中使用它们。这引发了与`goto`我认为是错误的类比。Gotos 是紧耦合的一对（和 也是`setjmp`）`longjmp`。异常遵循松散耦合的发布/订阅，它更干净！`goto`因此，在同一个堆栈帧中使用它们与使用s几乎是一回事。

第三个混淆来源与它们是检查异常还是未检查异常有关。当然，未经检查的异常对于控制流和许多其他事情来说似乎特别糟糕。

然而，一旦你克服了所有维多利亚时代的挂断并活了一点，检查异常对于控制流来说非常有用。

我最喜欢的用法是`throw new Success()`一长串代码片段，它一个接一个地尝试，直到找到它正在寻找的东西。每件事——每条逻辑——都可能有任意嵌套，所以`break`就像任何类型的条件测试一样。`if-else`图案很脆。如果我以其他方式编辑`else`或弄乱语法，那么就会有一个毛茸茸的错误。

使用`throw new Success()` ***线性化***代码流。我使用本地定义`Success`的类——当然要检查——所以如果我忘记抓住它，代码将无法编译。而且我没有捕捉到另一种方法的`Success`es。

有时我的代码会一个接一个地检查，只有在一切正常的情况下才会成功。在这种情况下，我使用`throw new Failure()`.

使用单独的函数会破坏自然的划分级别。所以`return`解决方案不是最优的。出于认知原因，我更喜欢在一个地方放一两页代码。我不相信超精细划分的代码。

除非有热点，否则 JVM 或编译器所做的与我无关。我无法相信编译器有任何根本原因不检测本地抛出和捕获的异常，而只是`goto`在机器代码级别将它们视为非常有效的。

至于在控制流的函数中使用它们——即用于常见情况而不是特殊情况——我看不出它们的效率如何低于多次中断、条件测试、返回涉水通过三个堆栈帧而不是仅仅恢复堆栈指针。

我个人不跨堆栈框架使用该模式，我可以看到它需要设计复杂性才能优雅地做到这一点。不过少用应该没问题。

最后，对于令人惊讶的处女程序员，这不是一个令人信服的理由。如果你轻轻地向他们介绍这种做法，他们就会学会喜欢它。我记得 C++ 曾经让 C 程序员大吃一惊。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-04-08T10:48:16.527

标准答案是异常不是常规的，应该在异常情况下使用。

对我来说很重要的一个原因是，当我`try-catch`在我维护或调试的软件中读取控制结构时，我试图找出为什么原始编码器使用异常处理而不是`if-else`结构。我希望找到一个好的答案。

请记住，您不仅为计算机编写代码，而且还为其他编码人员编写代码。有一个与异常处理程序相关联的语义，你不能仅仅因为机器不介意就丢弃它。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-04-08T14:07:32.353

性能怎么样？在对 .NET Web 应用程序进行负载测试时，我们在每台 Web 服务器上模拟了 100 个用户，直到我们修复了一个常见的异常并且这个数字增加到 500 个用户。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-04-08T14:30:48.617

Josh Bloch 在 Effective Java 中广泛讨论了这个主题。他的建议很有启发性，也应该适用于 .NET（细节除外）。

特别是，应在特殊情况下使用例外。其原因主要与可用性有关。为了使给定的方法最大程度地可用，它的输入和输出条件应该受到最大程度的约束。

例如，第二种方法比第一种更容易使用：

```
/**
 * Adds two positive numbers.
 *
 * @param addend1 greater than zero
 * @param addend2 greater than zero
 * @throws AdditionException if addend1 or addend2 is less than or equal to zero
 */
int addPositiveNumbers(int addend1, int addend2) throws AdditionException{
  if( addend1 <= 0 ){
     throw new AdditionException("addend1 is <= 0");
  }
  else if( addend2 <= 0 ){
     throw new AdditionException("addend2 is <= 0");
  }
  return addend1 + addend2;
}

/**
 * Adds two positive numbers.
 *
 * @param addend1 greater than zero
 * @param addend2 greater than zero
 */
public int addPositiveNumbers(int addend1, int addend2) {
  if( addend1 <= 0 ){
     throw new IllegalArgumentException("addend1 is <= 0");
  }
  else if( addend2 <= 0 ){
     throw new IllegalArgumentException("addend2 is <= 0");
  }
  return addend1 + addend2;
} 
```

无论哪种情况，您都需要检查以确保调用者正确地使用了您的 API。但在第二种情况下，您需要它（隐式）。如果用户没有阅读 javadoc，仍然会抛出软异常，但是：

> 1.  你不需要记录它。
> 2.  您不需要对其进行测试（取决于您的单元测试策略的激进程度）。
> 3.  您不需要调用者处理三个用例。

最基本的一点是，不应将异常*用作*返回码，这主要是因为您不仅使您的 API 变得复杂，而且还使调用者的 API 变得复杂。

当然，做正确的事是有代价的。代价是每个人都需要了解他们需要阅读和遵循文档。希望无论如何都是这样。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2009-04-08T10:46:13.583

我认为您可以使用 Exceptions 进行流量控制。然而，这种技术也有另一面。创建异常是一件代价高昂的事情，因为它们必须创建堆栈跟踪。因此，如果您想更频繁地使用异常而不是仅仅发出异常情况的信号，您必须确保构建堆栈跟踪不会对您的性能产​​生负面影响。

降低创建异常成本的最佳方法是重写 fillInStackTrace() 方法，如下所示：

```
public Throwable fillInStackTrace() { return this; } 
```

这样的异常不会填充任何堆栈跟踪。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2015-02-26T21:09:12.347

以下是我在[博客文章](http://enterprisecraftsmanship.com/2015/02/26/exceptions-for-flow-control-in-c/)中描述的最佳实践：

*   **抛出异常以说明**软件中的意外情况。
*   **使用返回值进行输入验证**。
*   如果您知道如何处理库抛出的异常，**请尽可能在最低级别捕获它们**。
*   如果出现意外异常，请完全放弃当前操作。**不要假装你知道如何对付他们**。

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2009-04-08T10:52:58.997

我真的不明白你是如何在你引用的代码中控制程序流的。除了 ArgumentOutOfRange 异常之外，您永远不会看到另一个异常。（所以你的第二个 catch 子句永远不会被击中）。您所做的只是使用极其昂贵的 throw 来模仿 if 语句。

此外，您并没有执行更险恶的操作，您只是抛出一个异常，纯粹是为了让它在其他地方被捕获以执行流控制。你实际上是在处理一个例外情况。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-04-08T18:09:42.083

除了上述原因之外，不使用异常进行流控制的一个原因是它会使调试过程变得非常复杂。

例如，当我试图追踪 VS 中的错误时，我通常会打开“中断所有异常”。如果您使用异常进行流控制，那么我将定期中断调试器，并且必须继续忽略这些非异常异常，直到遇到真正的问题。这可能会让某人发疯！

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2009-04-08T12:21:13.123

因为代码难读，调试时可能会遇到麻烦，时间长了在修复bug时会引入新的bug，在资源和时间上比较昂贵，而且如果你在调试你的代码和它会很烦人调试器在每个异常发生时停止；）

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-04-08T11:27:23.237

假设您有一种方法可以进行一些计算。它必须验证许多输入参数，然后返回一个大于 0 的数字。

使用返回值来表示验证错误，很简单：如果方法返回的数字小于 0，则发生错误。那么如何判断*哪个*参数没有验证？

我记得在我的 C 时代，很多函数都返回了这样的错误代码：

```
-1 - x lesser then MinX
-2 - x greater then MaxX
-3 - y lesser then MinY 
```

等等

它真的比抛出和捕获异常更不可读吗？

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-08-21T05:15:23.497

您可以使用锤子的爪子转动螺丝，就像您可以使用例外来控制流一样。这并不意味着它是该功能的*预期用途*。该`if`语句表示条件，其预期用途*是*控制流量。

如果您以非预期的方式使用某个功能，而选择不使用为此目的而设计的功能，则会产生相关成本。在这种情况下，清晰度和性能不会受到真正的附加值的影响。`if`与广泛接受的声明相比，使用异常能为您带来什么？

换一种说法：仅仅因为你**可以**并不意味着你**应该**。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-01-11T08:13:20.503

As others have mentioned numerously, [the principle of least astonishment](http://c2.com/cgi/wiki?PrincipleOfLeastAstonishment) will forbid that you use exceptions excessively for control flow only purposes. On the other hand, no rule is 100% correct, and there are always those cases where an exception is "just the right tool" - much like `goto` itself, by the way, which ships in the form of `break` and `continue` in languages like Java, which are often the perfect way to jump out of heavily nested loops, which aren't always avoidable.

The following blog post explains a rather complex but also rather interesting use-case for a *non-local* `ControlFlowException`:

*   [http://blog.jooq.org/2013/04/28/rare-uses-of-a-controlflowexception](http://blog.jooq.org/2013/04/28/rare-uses-of-a-controlflowexception)

It explains how inside of [jOOQ (a SQL abstraction library for Java)](http://www.jooq.org), such exceptions are occasionally used to abort the SQL rendering process early when some "rare" condition is met.

### Examples of such conditions are:

*   Too many bind values are encountered. Some databases do not support arbitrary numbers of bind values in their SQL statements (SQLite: 999, Ingres 10.1.0: 1024, Sybase ASE 15.5: 2000, SQL Server 2008: 2100). In those cases, jOOQ aborts the SQL rendering phase and re-renders the SQL statement with inlined bind values. Example:

    ```
    // Pseudo-code attaching a "handler" that will
    // abort query rendering once the maximum number
    // of bind values was exceeded:
    context.attachBindValueCounter();
    String sql;
    try {

      // In most cases, this will succeed:
      sql = query.render();
    }
    catch (ReRenderWithInlinedVariables e) {
      sql = query.renderWithInlinedBindValues();
    } 
    ```

    If we explicitly extracted the bind values from the query AST to count them every time, we'd waste valuable CPU cycles for those 99.9% of the queries that don't suffer from this problem.

*   Some logic is available only indirectly via an API that we want to execute only "partially". The [`UpdatableRecord.store()`](http://www.jooq.org/javadoc/latest/org/jooq/UpdatableRecord.html) method generates an `INSERT` or `UPDATE` statement, depending on the `Record`'s internal flags. From the "outside", we don't know what kind of logic is contained in `store()` (e.g. optimistic locking, event listener handling, etc.) so we don't want to repeat that logic when we store several records in a batch statement, where we'd like to have `store()` only generate the SQL statement, not actually execute it. Example:

    ```
    // Pseudo-code attaching a "handler" that will
    // prevent query execution and throw exceptions
    // instead:
    context.attachQueryCollector();

    // Collect the SQL for every store operation
    for (int i = 0; i < records.length; i++) {
      try {
        records[i].store();
      }

      // The attached handler will result in this
      // exception being thrown rather than actually
      // storing records to the database
      catch (QueryCollectorException e) {

        // The exception is thrown after the rendered
        // SQL statement is available
        queries.add(e.query());                
      }
    } 
    ```

    If we had externalised the `store()` logic into "re-usable" API that can be customised to optionally *not* execute the SQL, we'd be looking into creating a rather hard to maintain, hardly re-usable API.

### Conclusion

In essence, our usage of these non-local `goto`s is just along the lines of what [Mason Wheeler][5] said in his answer:

> "I just encountered a situation that I cannot deal with properly at this point, because I don't have enough context to handle it, but the routine that called me (or something further up the call stack) ought to know how to handle it."

Both usages of `ControlFlowExceptions` were rather easy to implement compared to their alternatives, allowing us to reuse a wide range of logic without refactoring it out of the relevant internals.

But the feeling of this being a bit of a surprise to future maintainers remains. The code feels rather delicate and while it was the right choice in this case, we'd always prefer not to use exceptions for *local* control flow, where it is easy to avoid using ordinary branching through `if - else`.

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-04-08T17:20:59.157

我认为使用异常进行流量控制没有任何问题。异常有点类似于延续，在静态类型的语言中，异常比延续更强大，所以，如果你需要延续但你的语言没有它们，你可以使用异常来实现它们。

好吧，实际上，如果您需要延续而您的语言没有它们，那么您选择了错误的语言，您应该使用不同的语言。但有时你别无选择：客户端 Web 编程就是最好*的*例子——没有办法绕过 JavaScript。

一个例子：[Microsoft Volta](http://LiveLabs.Com/volta/)是一个允许在直接的 .NET 中编写 Web 应用程序的项目，并让框架负责确定哪些位需要在哪里运行。这样做的一个后果是 Volta 需要能够将 CIL 编译为 JavaScript，以便您可以在客户端上运行代码。但是，有一个问题：.NET 有多线程，而 JavaScript 没有。因此，Volta 使用 JavaScript 异常在 JavaScript 中实现延续，然后使用这些延续实现 .NET 线程。这样，使用线程的 Volta 应用程序可以编译为在未经修改的浏览器中运行——不需要 Silverlight。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2009-04-08T15:52:00.153

您可能有兴趣查看 Common Lisp 的条件系统，它是对正确处理异常的一种概括。因为您可以以受控方式展开或不展开堆栈，所以您也可以“重新启动”，这非常方便。

这与其他语言的最佳实践没有太大关系，但它向您展示了（大致）您正在考虑的方向上的一些设计思想可以做什么。

当然，如果您像溜溜球一样在堆栈上上下弹跳，仍然需要考虑性能，但它比大多数捕获/抛出异常系统所体现的“哦，废话，让保释”这种方法更为笼统。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-04-08T12:42:15.740

通常，在低级别处理异常本身并没有错。异常是一条有效消息，它提供了很多关于为什么无法执行操作的详细信息。如果你能处理它，你应该这样做。

一般来说，如果您知道可以检查的失败概率很高...您应该进行检查...即 if(obj != null) obj.method()

在您的情况下，我对 C# 库不够熟悉，无法知道日期时间是否有一种简单的方法来检查时间戳是否超出范围。如果是这样，只需调用 if(.isvalid(ts)) 否则您的代码基本上没问题。

所以，基本上它归结为无论哪种方式创建更清晰的代码......如果防止预期异常的操作比仅仅处理异常更复杂；比你有我的许可来处理异常而不是到处创建复杂的守卫。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-04-08T14:32:16.130

如果您将异常处理程序用于控制流，那么您就太笼统和懒惰了。正如其他人提到的，如果您在处理程序中处理处理，您知道发生了一些事情，但究竟是什么？本质上，如果您将异常用于控制流，则您将异常用于 else 语句。

如果您不知道可能发生的状态，那么您可以使用异常处理程序来处理意外状态，例如当您必须使用第三方库时，或者您必须捕获 UI 中的所有内容以显示一个不错的错误消息并记录异常。

但是，如果您确实知道可能会出现什么问题，并且您没有使用 if 语句或其他东西来检查它，那么您只是懒惰。让异常处理程序成为你知道可能发生的事情的包罗万象是懒惰的，它稍后会回来困扰你，因为你将试图根据一个可能错误的假设来修复你的异常处理程序中的一个情况。

如果您将逻辑放在异常处理程序中以确定究竟发生了什么，那么您将非常愚蠢，因为您没有将该逻辑放在 try 块中。

异常处理程序是最后的手段，因为当您用尽想法/方法来阻止某些事情出错，或者事情超出您的控制能力时。例如，服务器已关闭并超时，您无法阻止抛出该异常。

最后，预先完成所有检查表明您知道或期望会发生什么，并使其明确。代码的意图应该是明确的。你更愿意读什么？

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2013-09-25T09:06:26.703

审美原因之一：

try 总是伴随着 catch，而 if 不一定伴随着 else。

```
if (PerformCheckSucceeded())
   DoSomething(); 
```

使用 try/catch，它变得更加冗长。

```
try
{
   PerformCheckSucceeded();
   DoSomething();
}
catch
{
} 
```

那6行代码太多了。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-04-08T10:47:57.340

我觉得你的例子没有错。相反，忽略被调用函数抛出的异常是一种罪过。

在 JVM 中，抛出异常并没有那么昂贵，只需使用 new xyzException(...) 创建异常，因为后者涉及堆栈遍历。因此，如果您提前创建了一些异常，您可能会多次抛出它们而无需付出任何代价。当然，这种方式不能与异常一起传递数据，但我认为无论如何这是一件坏事。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-04-08T10:56:32.547

但是您并不总是知道您调用的 Method/s 中发生了什么。您不会确切知道异常是在哪里引发的。无需更详细地检查异常对象....

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-09-02T18:47:42.407

语言可以通过一些通用机制允许方法退出而不返回值并展开到下一个“catch”块：

*   让方法检查堆栈帧以确定调用站点，并使用调用站点的元数据来查找有关调用方法中的`try`块的信息，或者调用方法存储其调用者地址的位置；在后一种情况下，检查调用者的调用者的元数据以确定与直接调用者相同的方式，重复直到找到一个`try`块或堆栈为空。这种方法给无异常情况增加了很少的开销（它确实排除了一些优化），但在发生异常时代价高昂。

*   让该方法返回一个“隐藏”标志，以区分正常返回和异常，并让调用者检查该标志并分支到“异常”例程（如果已设置）。该例程在无异常情况下增加了 1-2 条指令，但发生异常时的开销相对较小。

*   让调用者将异常处理信息或代码放在相对于堆栈返回地址的固定地址。例如，对于 ARM，可以使用以下序列，而不是使用指令“BL 子程序”：

    ```
     adr lr,next_instr
        b subroutine
        b handle_exception
    next_instr: 
    ```

要正常退出，子程序只需执行`bx lr`or `pop {pc}`; 在异常退出的情况下，子例程会在执行返回或使用之前从 LR 中减去 4 `sub lr,#4,pc`（取决于 ARM 的变体、执行模式等）。如果调用者不是为适应这种情况而设计的，这种方法将非常糟糕。

使用检查异常的语言或框架可能会受益于使用上述 #2 或 #3 之类的机制处理这些异常，而使用 #1 处理未检查异常。尽管 Java 中检查异常的实现相当麻烦，但如果有一种方法可以让调用站点可以说，基本上，“这个方法被声明为抛出 XX，但我不希望它永远这样做；如果确实如此，则作为“未检查”异常重新抛出。在以这种方式处理已检查异常的框架中，它们可能是流控制的有效手段，例如解析在某些情况下可能具有失败的可能性很高，但失败应该返回与成功完全不同的信息。我' 但是，我不知道任何使用这种模式的框架。相反，更常见的模式是对所有异常都使用上面的第一种方法（无异常情况下成本最低，但抛出异常时成本高）。

# java - Java 的简单图形显示或显示小部件

> ID：729385
> 
> 赞同：2
> 
> 时间：2009-04-08T10:26:52.883
> 
> 标签：java, graphics

我们将在大约一周内提供一个计算几个移动平均线的程序的演示。如果我们可以像 perfmon 那样以图形方式显示这些平均值，而不是打印到控制台，那就更酷了。我正在寻找将这种动态线图显示到 GUI 上的最快、最简单的方法），所需的编程越少越好。在理想情况下，它会以某种方式接收某种格式的打印输出并基于该格式生成动态图。除此之外，一个非常简单的小部件，无论是免费的还是其他的，都可以在 Java GUI 中实现。请记住，我在 Swing 方面没有太多经验，并且总是觉得它有点不友好。此外，基于浏览器的解决方案有哪些可能性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T10:29:39.990

[JFreeChart](http://www.jfree.org/jfreechart/)是您正在寻找的。

它确实包括一个[MovingAverage 类](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/data/time/MovingAverage.html)，你在[这里有一个“移动平均线”演示](http://www.java2s.com/Code/Java/Chart/JFreeChartHighLowChartDemo2withamovingaverageoverlaidontop.htm)

[![替代文字](https://i.stack.imgur.com/PrldO.png)](https://i.stack.imgur.com/PrldO.png)
[（来源：[java2s.com](http://www.java2s.com/Code/JavaImages/JFreeChartHighLowChartDemo2.PNG)）]

# java - XtUnit 是否支持性能测试？

> ID：729386
> 
> 赞同：0
> 
> 时间：2009-04-08T10:27:35.720
> 
> 标签：java, xtunit

XtUnit 是否支持性能测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T11:09:47.630

单元测试是一种功能测试，而性能测试是为了验证非功能性需求。

[请参阅有关单元测试](http://en.wikipedia.org/wiki/Unit_testing)和[软件性能测试](http://en.wikipedia.org/wiki/Software_performance_testing)的 Wikipedia 条目

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T12:47:35.757

看看[http://www.jperf.org/](http://www.jperf.org/)。

有一个强有力的论点是，性能在关键的地方应该被指定为一项要求，因此应与其他要求一起进行测试。

# .net - .net Ajax calendarExtender 星期六在 IE7 中的剪辑（在 Firefox 中工作正常）

> ID：729392
> 
> 赞同：3
> 
> 时间：2009-04-08T10:31:44.947
> 
> 标签：.net, css, calendarextender

我在 IE7 中遇到了这个问题，其中星期六似乎从日历中丢失。它在 Firefox 中显示良好，一些人建议它可能是我的其他样式表搞砸了，所以我现在使用自定义日历 CSS 主题，但我仍然遇到同样的问题。

有任何想法吗？使用的 ajax 工具包是否存在已知错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T08:32:12.390

这是一个解决方案：

```
.cal_Theme1 .ajax__calendar_days td { padding:0px; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-07-30T02:47:46.460

SocialAddict 给出了很好的答案，但它对我不起作用......

我的问题是主体/容器大小。

所以这就是治愈我的方法：

```
<style>
    div.ajax__calendar_days table tr td{padding-right: 0px;}
    div.ajax__calendar_body{width: 205px;}
    div.ajax__calendar_container{width: 205px;}
</style> 
```

我还更改了我的日历样式*（就像 SocialAddict 所做的那样）*，但这种样式开箱即用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T10:42:16.777

ASP代码：

```
 <asp:TextBox ID="F1_I2" runat="server" CssClass="bigInput">
            </asp:TextBox>
            <cc1:CalendarExtender ID="F1_I2_CalendarExtender" CssClass="cal_Theme1" runat="server" 
                TargetControlID="F1_I2" Format="dd/MM/yyyy">
            </cc1:CalendarExtender>
            <div class="magiPad" /> 
```

我有一个自定义 CSS 应用于日历，我认为它不会在这里很好地显示，但就是这样：

```
/* Calendar css */
.cal_Theme1 .ajax__calendar_container {background-color: #e2e2e2;width:182px;border:solid 1px #cccccc;}
.cal_Theme1 .ajax__calendar_header{background-color: #ffffff; margin-bottom: 4px;}
.cal_Theme1 .ajax__calendar_title,.cal_Theme1 .ajax__calendar_next,.cal_Theme1 .ajax__calendar_prev{color: #004080; padding-top: 3px;}
.cal_Theme1 .ajax__calendar_body{background-color: #e9e9e9; border: solid 1px #cccccc;}
.cal_Theme1 .ajax__calendar_dayname{text-align:center; font-weight:bold; margin-bottom: 4px; margin-top: 2px;}
.cal_Theme1 .ajax__calendar_day{text-align:center;}
.cal_Theme1 .ajax__calendar_hover .ajax__calendar_day,.cal_Theme1 .ajax__calendar_hover .ajax__calendar_month,.cal_Theme1 .ajax__calendar_hover .ajax__calendar_year,.cal_Theme1 .ajax__calendar_active{color: #004080; font-weight:bold; background-color: #ffffff;} 
.cal_Theme1 .ajax__calendar_today{font-weight:bold;} 
.cal_Theme1 .ajax__calendar_other,.cal_Theme1 .ajax__calendar_hover .ajax__calendar_today,.cal_Theme1 .ajax__calendar_hover .ajax__calendar_title{color: #bbbbbb;} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T11:05:17.533

如果其他人有这个问题，那么我建议在样式的开头设置一个通配符 css 元素，以消除所有可能的填充和边距问题。

这解决了 IE6.IE7 中的问题，并且 firefox 也可以正常工作。

```
.yourCalendarTheme * {padding:0px;margin:0px;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-24T18:00:11.367

我遇到了类似的问题，标记为最佳的解决方案（由 SocialAddict 提供）对我不起作用。我的问题的核心是在表格中设置的 css 类导致我的日历扩展器切断了星期六。有效的解决方案涉及修改日历扩展器的 css。这里是：

```
.ajax__calendar_body tr td {
 padding: 0px; 
 margin: 0px;} 
```

# visual-studio - 在打开文件对话框和打开项目对话框中自定义快捷方式

> ID：729396
> 
> 赞同：0
> 
> 时间：2009-04-08T10:34:30.460
> 
> 标签：visual-studio, development-environment

在打开文件对话框和打开项目对话框的右侧有一个快捷面板。有什么办法可以在这里添加我们自己的捷径吗？Office 有一个非常相似的对话框，允许您执行此操作 - 但 Visual Studio 似乎不允许这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T10:45:34.397

这是一篇[MSDN](http://msdn.microsoft.com/en-us/magazine/cc300434.aspx)文章，如何*“自定义打开文件对话框”*

在 StackOverflow 中有一个关于[VS.NET Places Bar 自定义](https://stackoverflow.com/questions/237748/customizing-the-places-bar-in-visual-studio-2008)的线程。

# delphi - Delphi 最好的报告组件？

> ID：729399
> 
> 赞同：13
> 
> 时间：2009-04-08T10:34:39.603
> 
> 标签：delphi, report

我们是一个使用 Gnostice 和 RaveReports 来查看、打印、邮寄和使用 D2007 生成 PDF 报告的团队。D2009 在路线图中，但由于 Gnostice 不支持 D2009，我们必须等待。过去，报告是在代码中完成的，然后查看、打印等。现在我们已经开始评估 Ravereports 设计器并用它来制作报告。

但现在我们犹豫了。[Nevrona](http://www.nevrona.com/)似乎或多或少已经死了。我们还没有设法购买 Ravereports 的来源，并且 webmaster@nevrona.com 反弹了。嗯...它们是 Delphi 的默认组件...

还有其他报告解决方案，例如[数字隐喻](http://www.digital-metaphors.com/)和[快速报告](http://fast-report.com/en/)。我毫不怀疑他们既优秀又能干，但我们必须做点什么。有人知道 Codegear 是否会因为一些麻烦而放弃 Ravereports 吗？

欢迎对[数字隐喻](http://www.digital-metaphors.com/)和[快速报告](http://fast-report.com/en/)发表评论。我们想要一个好的报告组件，它可以在设计时使用代码构建报告。报告文件应以文本形式保存，与 rave 文件不同，首选 xml。设置默认打印机的简单方法会很好，因为我们使用的 Citrix 环境有时会在此任务中失败。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-08T12:16:52.323

我同意 idursun 的观点，我以前使用过很多报告引擎，但是当我使用 Fast-Report 时，我就不再看其他了。

我要补充一下快速报告

*   FastReport 支持 Delphi < 2009 的 unicode。
*   开发速度比其他报告工具快，他们在 Delphi 2009 发布日期之前就支持它，其他报告工具需要更长的时间，在某些情况下，
    Delphi 2009 的时间太长了。
*   非常灵活，您可以从 Delphi 代码访问任何报表组件，或在报表中使用任何 Delphi 函数。
*   如果您将 FR 与其他功能/价格进行比较，它具有许多高级功能且价格较低。
*   FR 文件格式为 XML。
*   有一个用于网络报告 的[服务器版本。](http://fast-report.com/en/products/fast-report-server.html)
*   还有[.net版](http://www.fast-report.com/en/products/FastReport.Net.html)。
*   它具有非常强大的脚本引擎，支持更多语言（Pascal、Basic、Java 和 C）。
*   拥有无需额外资金的最终用户设计工具（我认为您需要标准版或更高版本）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-08T10:49:48.210

我没有尝试过数字隐喻，但我已经使用 FastReports 很长时间了，我什至没有遇到与该产品相关的任何问题。

优点：

*   很好的功能设计师
*   查询对象
*   脚本支持（允许您从代码中调用函数）
*   多语言支持
*   广泛的导出选项

缺点：

*   设计师的代码编辑器有问题

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-08T12:01:24.310

我们已经使用 Reportbuilder 好几年了，我们认为它很棒。我们使用它在我们的工具中构建报告，以及让我们的客户自己构建报告。最终用户报告功能与开发人员相同。所有这些都可以在本机 Delphi 代码中根据需要进行定制。我认为每个可以想到的报表解决方案都可以使用 ReportBuilder 构建。

除了出色的工具外，它们还为产品提供了良好的支持。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-08T13:39:33.170

过去 10 年我们一直使用 FastReport。从来没有任何问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-08T21:33:06.167

另一件非常有趣的事情：Fast Report Team 的支持非常好！

只要问一个问题，你很快就会得到答案：你也可以要求一些改进，如果它看起来不傻，他们就做到了。

然后，如果您需要 OLAP 解决方案：您可以获取 Fast Cube 并快速生成报告

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-08T21:37:27.577

我已经使用 FastReports 大约 10 年了。当前版本非常好。我们在许多领域使用它，包括用于网络报告的 pdf 生成、用户报告设计和自动打印。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-08T16:05:18.950

几年前我开始测试 ReportBuilder，但不久前我切换到了 FastReports，并且对这种变化非常满意。

我的要求之一是报告引擎需要只是一种输出形式（生成柱状或类似报告），但我的框架需要能够输出到该引擎或生成填充的 PDF 表单或 Excel 报告的引擎格式或其他类型的数字报告。报告必须是报告超类的实例，以便它们可以作为具有多种输出类型和目的地的包组合和生成。

我不是高手程序员，但我发现这项工作很容易完成。FastReports 适合这个框架并出色地完成了它的工作。我对使用 Delphi、Firebird 和 FastReports 发现的强大功能和灵活性说得再多也不为过。我现在才刚刚开始探索使用其内置的 pascal 脚本更完整地与我的主程序集成的可能性。

我希望这是有帮助的。

杰克

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-14T09:44:07.010

策略略有不同，但我在其邮件合并功能中使用[WPTools](http://www.wptools.com/products/wptools/index.htm)来生成报告。我从标准报告系统切换，因为人们发现它更难使用，而且大多数报告都需要在 Word 中进行编辑（无论如何在我们的应用程序中）。不适合所有人，但值得深思。它支持banding类型的东西，所以你可以很好地循环，并且可以从数据库或静态结构中提供数据。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-12-13T23:13:56.843

虽然您没有明确提到 Bold，但我认为您更喜欢 Bold 意识记者。如果是这样，那么精心设计的“可插拔”数据意识就很重要。我还没有尝试过所有流行的产品，但我能够毫不费力地将 FastReport 加粗。它在任何其他领域都不缺乏，所以我强烈推荐它。

# mysql - SELECT from tbl 'value1' 减去 'previous value'

> ID：729414
> 
> 赞同：3
> 
> 时间：2009-04-08T10:42:29.240
> 
> 标签：mysql

```
SELECT      totalAmount
FROM        tbl
BETWEEN     'date1' AND 'date2'

GROUP BY    DATE(date created) 
ORDER BY    DATE(date created) 
```

这给了我表中每天的总金额。但我想要的是与上一个条目相比的增量值（不一定是前一天）

该表可能类似于：

```
totalAmount    |    date created
---------------------------------
1000           |    1st Jan
1001           |    2nd Jan
1003           |    3rd Jan
1008           |    15th Jan 
```

所以我的查询将返回：1000,1001,1003,1008。

我真正想要的是：（与以前的条目相比的数字 - 但不在 BETWEEN 日期范围内，以便开始我的罪行），1,2,5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T12:33:25.497

这样做：

```
SELECT IFNULL((t1.totalamount - t2.totalamount),0) as diff, t1.date_created
FROM view t1 LEFT OUTER JOIN view t2 
 ON t2.date = (SELECT MAX(date) FROM view WHERE date < t1.date)
WHERE t1.date_created BETWEEN 'date1' AND 'date2'
ORDER BY date_created 
```

这个查询在哪里“查看”：

```
SELECT date_created, SUM(totalamount) FROM tbl GROUP BY date_created 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T11:01:37.853

试试这个 ：

```
SELECT      totalAmount
FROM        tbl
BETWEEN     'date1' AND 'date2'

GROUP BY    DATE(date created) 
ORDER BY    totalAmount DESC, DATE(date created) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T12:08:58.473

您需要加入两个相同排名的子查询。我没有 MySQL 数据库来对此进行测试，但形式类似于：

```
select t1.TotalAmount, t1.DateCreated, 
    t1.TotalAmount - t2.TotalAmount as 'Delta'
from
(select rownum, TotalAmount
 from tbl
 order by DateCreated) t1
left outer join
(select rownum, TotalAmount
 from tbl
 order by DateCreated) t2
 on t1.rownum = t2.rownum + 1
 order by t1.rownum 
```

# runtime - 工作流运行时所有权已过期

> ID：729415
> 
> 赞同：1
> 
> 时间：2009-04-08T10:43:44.557
> 
> 标签：runtime, workflow, ownership

我在 Windows 工作流基础中面临一个奇怪的问题。我创建了一个状态机工作流程，它在一次构建中运行良好，但由于一些要求，我改变了工作流程，构建并重新安装了应用程序。现在，当我尝试访问我在以前的构建中创建的工作流实例时，它给了我一个`WorkflowOwnershipException`：

> 此工作流不属于 WorkflowRuntime。WorkflowRuntime 的所有权已过期，或另一个 WorkflowRuntime 拥有该工作流。

是否有解决此问题的根本原因的解决方法或方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-22T15:26:51.580

持久化服务的锁定时间是多久？我假设您使用的是内置的 SqlWorkflowPersistenceService。

也许此信息可以帮助您：

[http://www.dotnetconsult.co.uk/weblog2/PermaLink,guid,9c484cc4-ddd7-4dfd-b8e3-d5517fe9b0a2.aspx](http://www.dotnetconsult.co.uk/weblog2/PermaLink,guid,9c484cc4-ddd7-4dfd-b8e3-d5517fe9b0a2.aspx)

# sql - 选择或计算所有行时 Sql 表无响应

> ID：729416
> 
> 赞同：0
> 
> 时间：2009-04-08T10:43:49.707
> 
> 标签：sql, sql-server, select

我们在数据库中有一个有 35 行的表，根据

```
exec sp_spaceused 处。
```

我能跑

```
从部门中选择 TOP 1 *，
```

并得到一个结果，但是当我运行时

```
从部门中选择计数（*），
```

它运行时间超过 2 分钟（然后我取消了它并且没有等待结果，因为我希望这是一个简单而快速的查询）。

这可能是什么原因？你有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T10:46:24.740

表上是否有打开的锁阻止您读取某些行？

尝试：

```
sp_lock 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T13:39:46.320

这个查询会很快回来吗？

```
SELECT COUNT(*) FROM Department WITH (NOLOCK) 
```

如果是这样，我肯定会说你的表/索引上有某种锁，正如建议的那样。

马克

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T10:48:53.313

如果您的表确实有 35 行，则不需要两分钟。即使你的表有数十亿行，一个像样的 DBMS 也会存储行数以提高效率（我不知道微软是否这样做）。

请记住，“top 1”只会以（看似）随机顺序获得第一行，因此速度会很快。

我的第一个想法是数据库损坏 - 当您执行以下操作时会发生什么？

```
select top 2 * from Department
select top 3 * from Department
select top 4 * from Department 
```

等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T12:35:26.303

找出发生了什么的最好方法是跟踪查询的执行，但我不知道如何在 SQL Server 中执行此操作。

您也可以尝试查看查询的执行计划，这可能会告诉您是否有一些意想不到的事情发生在幕后（例如，如果部门真的是一个复杂的视图）。

假设该表有一个名为 Department_ID 的主键，它始终是一个正整数，您可以尝试以下操作：

```
SELECT COUNT(*) FROM Department WHERE Department_ID > 0 
```

这可能会迫使它扫描索引而不是实际的表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T20:27:28.197

检查表上的触发器。还可以启动性能监视器，以便查看服务器在资源上的表现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T10:47:18.433

您期望的简单而快速的查询实际上会导致*Table Scan*，它有效地从磁盘读取所有数据页并遍历每条记录。这是*非常*昂贵的。你可以使用[这种方法](http://www.mssqltips.com/tip.asp?tip=1044)，但我不能确定它是否精确。

# c# - .Net 混淆器

> ID：729417
> 
> 赞同：11
> 
> 时间：2009-04-08T10:44:11.983
> 
> 标签：c#, .net, linux, obfuscation

是否有适用于 Linux 的 .NET 混淆工具？或者是否有一个类可以为我提供为字节码编写混淆工具的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-28T08:10:48.583

试试这个工具，它是免费的：[http](http://www.foss.kharkov.ua/g1/projects/eazfuscator/dotnet/Default.aspx#downloads) ://www.foss.kharkov.ua/g1/projects/eazfuscator/dotnet/Default.aspx#downloads ，它和商业产品一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T12:24:17.047

你可以试试[Spices.Obfuscator](http://www.9rays.net/products/Spices.Obfuscator/Features.aspx)。它宣传它支持 Mono，但这可能是它*生成*与 Mono 兼容的程序集（假设它们首先是）而不是在 Mono 上运行。由于他们表示他们混淆了自己，这表明他们的命令行应用程序很有可能工作（我建议您尝试下载他们的评估包）

我同意 Marc Gravell 对其实用程序的评论，尤其是当您开始使用 c# 3.0 功能时，无论如何都会使生成的未混淆反编译代码非常难看。如果代码是本地的，它可能会被破坏，充其量您删除有意义的名称（以反射场景的永久性麻烦为代价）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-23T17:51:14.100

你想要一个在 Mono 下执行的混淆器还是一个输出将在 Mono 下运行的程序集的混淆器？

如果你想要一个在 Mono 下运行的，我不知道谁的 GUI 在 Mono 下运行，但我知道我们已经在 Mono 下内部测试了[Dotfuscator](http://www.preemptive.com/dotfuscator.html)命令行界面并且它可以工作。这（还）不是官方支持或经过广泛测试的解决方案，因此您的里程可能会有所不同。

Dotfuscator 接受任何标准的 MSIL 程序集，我们只发出 100% 可验证的程序集，只要您的源程序集与 Mono 兼容，Dotfuscator 输出也应该与 Mono 兼容。这可以在源程序集和 Dotfuscator 输出上使用[Mono Migration Analyzer进行验证。](http://www.mono-project.com/MoMA)

免责声明：我确实为 Dotfuscator 的制造商 PreEmptive Solutions 工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-22T05:29:04.943

[Crypto Obfuscator](http://www.ssware.com/cryptoobfuscator/obfuscator-net.htm)支持 Mono 应用程序。它本身不在 Mono 上运行，但只要原始程序集也在运行，所有被它混淆的程序集都将在 Mono 上运行。

免责声明：我为 Crypto Obfuscator 的开发商 LogicNP Software 工作。

# performance - 多少性能提升是值得/值得注意的？

> ID：729419
> 
> 赞同：0
> 
> 时间：2009-04-08T10:44:35.943
> 
> 标签：performance, survey

每个人对何时何地提高性能都有自己的看法，所以这里不感兴趣，但我想知道性能提升在什么时候变得值得提升（比如从分支开发到主干，或者足以放在一些进展上报告或其他）。

例如，我的经验法则是 10% 的性能提升是值得注意的，但 5% 并没有什么特别之处（当然加起来它们可能是值得的）

*注意：由于没有标记此 wiki 的正确答案，但我确实觉得在做出关于性能的决定时对这个主题有意见很有用*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T10:49:38.287

我宁愿使用绝对值。1 毫秒的 20% 不是你关心的。但是一个小时的 2% 是相当可观的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T10:50:31.110

如果提高的性能为系统增加了新的质量，那么值得一提。否则通常没人关心。

例如，如果系统在加载合理但高于正常数量的数据时工作明显变慢，并且您已经解决了这个问题，那么值得一提的是，那些加载大量数据的用户将从改进中受益。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T10:48:38.103

大 n 的 O(n) 到 O(log n) 算法改进*非常*好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T10:49:05.887

我认为这也取决于代码的优雅/可读性。如果一个特定的改变感觉像是一个更正确的解决方案，消除了代码中的一些愚蠢，那么如果它也提高了性能，那么它是“值得的”。但是，如果某个特定更改纯粹是为了性能而设计的，并且会降低代码的可读性或可维护性，那么最好是一个很好的提升，使其值得......也许是 50%。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-08T11:24:42.773

这是一个简单的测试：给某人未优化的系统并要求他们使用它。给他们优化的系统并要求他们使用它。询问他们是否能分辨出不同之处，以及他们最喜欢哪个。（确保这是一个双盲测试，并且系统在其他方面是平等的）。如果人们更喜欢优化后的系统，那就值得一提。

这是一个更简单的测试：你能分辨出区别吗？如果不能，那就不值一提了。（另一方面，小的改进会累积）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-08T10:57:29.300

这取决于。

如果这 5% 转化为节省的钱，例如在大型服务器场上，那将是值得注意的。

如果它在最终用户的计算机上快 5%，甚至不会注意到，那么就不会。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-08T11:01:30.740

这取决于上下文。

在需要实时播放视频的应用程序中，每帧 1 毫秒的改进可能是每秒 30 帧（这是视频剪辑的常见速率）到每秒 29 帧（看起来 - 视觉 - 很多）之间的差异由于丢帧而更糟）。

在另一个通宵运行的应用程序中，两小时与三小时可能不会产生任何实际差异（但在运行时对数据库造成的负载可能非常重要 - 而是优化它！）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-08T11:17:14.320

**基本上，对于一个完整**的工作单元来说，它是一个数量级或更好的数量级。

*   数小时到数分钟的*批处理*
*   几分钟到几秒的*用户触发批处理、安装、构建*
*   秒到第二个*用户触发的进程*
*   一秒到即时的*用户触发流程*

# asp.net - ASP.NET：更好地将可本地化的 UI 文本存储在资源或数据库中？

> ID：729424
> 
> 赞同：6
> 
> 时间：2009-04-08T10:46:15.753
> 
> 标签：asp.net, localization, resources, multilingual

似乎有两种不同的方法。ASP.NET 框架为我们提供了一种通过将 UI 字符串放入资源（如 UserProfile.en.resx、UserProfile.fr.resx 等）来本地化页面的简单方法。

另一种方法是将所有字符串放在数据库中的单独表中，然后使用一些自定义机制根据当前活动的语言/文化设置检索它们。

据我了解，数据库方法对于大型项目（例如企业软件）更为典型。它还有一个好处，您可以将对该数据库的外部访问权限授予翻译公司。有资源就难了。

另一方面，从数据库中检索所有静态字符串是额外的流量和负载开销。我看不出一个相对较小的网站这样做有什么好处。“小”的意思不是流量，而是页面的数量和复杂性。

我个人更喜欢将资源用于我的私人项目。这绝对是个坏主意吗？

顺便问一下，我还能在 ASP.NET MVC 中使用资源吗？

任何想法表示赞赏。

编辑：只有一个答案，不能相信这个问题对任何人都不感兴趣。没有人愿意分享他们的意见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T10:48:19.577

将两者结合起来。您可以编写一个使用数据库而不是资源文件的自定义资源提供程序，这样您就不必自己进行繁重的绑定文本（也就是说，让我们面对它，容易出错），您只需使用 ASP。 NET 的本地化功能。MSDN 有一个很好的[演练](http://msdn.microsoft.com/en-us/library/aa905797.aspx)Michelle Leroux Bustamante

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T10:58:59.030

我更喜欢将所有这些信息保存在数据库中，而不是依赖于 asp.net 资源文件。

我所做的是将我的常用控件（如标签）子类化并覆盖渲染方法。此方法查找当前文化并通过查找我的数据结构相应地设置适当的标题

关于将它们保存在数据库中时的性能 - 这就是我所做的：在我的 application_start 事件中，我只是将我所有的文化特定描述加载到一个自定义对象中并将它缓存得很长。这样我就不必访问数据库，直到我的缓存过期或我强制它过期

到目前为止，我们从未在遵循这种方法的性能方面遇到任何问题。说了这么多-请注意，我并不是说使用资源文件也是一个不好的选择

但如果给我一个选择，我更喜欢数据库方法而不是资源文件方法

# sql - 从结果集中消除部分重复行

> ID：729428
> 
> 赞同：2
> 
> 时间：2009-04-08T10:47:00.337
> 
> 标签：sql, sql-server, tsql

我有一个查询，它返回一个类似于下面的结果集（实际上它要大得多，有数千行）：

```
     一个 | 乙| C | D
     -----|----|----|-----
1 空 | d0 | d0 | 空值
2 空 | d0 | d1 | 空值
3 空值 | d0 | d2 | a0
4 天 | d1 | d1 | 空值
5 天 | d2 | d2 | a0

```

其中两行被认为是重复的，1 和 2，因为 A、B 和 D 相同。为了消除这种情况，我可以使用`SELECT DISTINCT A, B, D`但我没有在我的结果集中得到 C 列。C 列是第 3、4 和 5 行的必要信息。

那么我如何从上面的结果集到这个（出现在C4中的结果也可以是`NULL`代替`d1`）：

```
     一个 | 乙| C | D
     -----|----|-----|-----
1 空 | d0 | 空 | 空值
3 空值 | d0 | d2 | a0
4 天 | d1 | d1 | 空值
5 天 | d2 | d2 | a0

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T10:51:55.413

```
DECLARE @YourTable TABLE (
  A VARCHAR(2)
  , B VARCHAR(2)
  , C VARCHAR(2)
  , D VARCHAR(2))

INSERT INTO @YourTable VALUES (NULL, 'd0', 'd0', NULL)
INSERT INTO @YourTable VALUES (NULL, 'd0', 'd1', NULL)
INSERT INTO @YourTable VALUES (NULL, 'd0', 'd2', 'a0')
INSERT INTO @YourTable VALUES ('d0', 'd1', 'd1', NULL)
INSERT INTO @YourTable VALUES ('d0', 'd2', 'd2', 'a0')

SELECT A, B, C = MIN(C), D
FROM @YourTable
GROUP BY A, B, D 
```

* * *

```
SELECT A, B, CASE WHEN MIN(C) = MAX(C) THEN MIN(C) ELSE NULL END, D
FROM @YourTable
GROUP BY A, B, D 
```

* * *

```
SELECT A, B, CASE WHEN MIN(COALESCE(C, 'dx')) = MAX(COALESCE(C, 'dx')) THEN MIN(C) ELSE NULL END, D
FROM @YourTable
GROUP BY A, B, D 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T12:21:28.490

使用[Dense_Rank()](http://msdn.microsoft.com/en-us/library/ms173825.aspx)按 A、B 和 D 进行分区
（感谢 Lieven，对于临时表查询，我必须使用它来进行演示以保持一致；））

根据[MSDN](http://msdn.microsoft.com/en-us/library/ms173825.aspx)，

> 行的排名是相关行之前的不同排名数的加一

分区依据`A, B, C`然后排序依据`A, B, C, D`将为您提供第一个不同值的等级 1，其中唯一性由 定义`A, B, D`。这就是过滤的`1`来源。

> 其中 DenseRank = 1

这是结果

![替代文字](https://farm4.static.flickr.com/3301/3423982498_1a5b1c44d3.jpg)

这是代码：

```
DECLARE @YourTable TABLE (
  A VARCHAR(2)
  , B VARCHAR(2)
  , C VARCHAR(2)
  , D VARCHAR(2))

INSERT INTO @YourTable VALUES (NULL, 'd0', 'd0', NULL)
INSERT INTO @YourTable VALUES (NULL, 'd0', 'd1', NULL)
INSERT INTO @YourTable VALUES (NULL, 'd0', 'd2', 'a0')
INSERT INTO @YourTable VALUES ('d0', 'd1', 'd1', NULL)
INSERT INTO @YourTable VALUES ('d0', 'd2', 'd2', 'a0')

;with DistinctTable as (
    select  *, 
    DenseRank = Dense_Rank() over (Partition By A, B, D order by A, B, C, D)
    from    @YourTable
)
select  A, B, C, D
from    DistinctTable
where   DenseRank = 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T10:52:35.037

也许是一个子查询？

从表 1 中选择 A、B、C、D 在哪里存在（从表 1 中选择不同的 A、B、D）；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T11:08:18.507

如果你在表中有一个唯一的 id，那么我会选择这样的东西：

```
SELECT A,B,C,D 从表 WHERE id IN (SELECT DISTINCT A,B,D)

```

问题是你总是会得到 C 的第一个值，而不是第一个有值的值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T11:15:27.103

您在 A 和 D 中有 NULL 的事实使任何 EXISTS 都变得复杂。

C 上的任何 MIN/MAX 解决方案都可能不会像我想的那样给你 NULL。否则，使用 MIN(C) 和一个简单的 group by。

您必须首先提取唯一键（A，B，D），然后使用它来确定再次提取行并确定如何处理 C

```
DECLARE @TheTable TABLE (
  A varchar(2) NULL,
  B varchar(2) NULL,
  C varchar(2) NULL,
  D varchar(2) NULL
)

INSERT INTO @TheTable VALUES (NULL, 'd0', 'd0', NULL)
INSERT INTO @TheTable VALUES (NULL, 'd0', 'd1', NULL)
INSERT INTO @TheTable VALUES (NULL, 'd0', 'd2', 'a0')
INSERT INTO @TheTable VALUES ('d0', 'd1', 'd1', NULL)
INSERT INTO @TheTable VALUES ('d0', 'd2', 'd2', 'a0')

SELECT DISTINCT
    T.A,
    T.B,
    CASE Number WHEN 1 THEN T.C ELSE NULL END,
    T.D
FROM
    (SELECT
        COUNT(*) AS Number,
        A, B, D
    FROM
        @TheTable
    GROUP BY
        A, B, D
    ) UQ
    JOIN
    @TheTable T ON ISNULL(T.A, '') = ISNULL(UQ.A, '') AND ISNULL(T.B, '') = ISNULL(UQ.B, '') AND ISNULL(T.D, '') = ISNULL(UQ.D, '') 
```

# sql - MySQL多表查询问题

> ID：729429
> 
> 赞同：0
> 
> 时间：2009-04-08T10:47:03.317
> 
> 标签：sql, mysql, cartesian-product

我在查询多个表时遇到问题`MySQL`，目前我束手无策。

我`ID`在每个表中都有唯一的 s，并且正在使用 an`INNER JOIN`来组合它们；我很陌生`SQL`，这可能是错误的方法，因此我在这里发布：

询问：

```
SELECT res.UserID, res.QuizID, res.QuizResult, u.UserID, u.UserLogin, q.QuizID, q.QuizName, q.QuizFile
FROM results res
INNER JOIN users u ON (res.UserID = u.UserID) 
INNER JOIN quiz q ON (res.QuizID = q.QuizID) 
```

表`users`包含

```
UserID
UserLogin
UserPass 
```

表`quiz`包含

```
QuizID
QuizName
QuizFile 
```

表`results`包含

```
UserID
QuizID
QuizResults 
```

谁能告诉我为什么我要得到笛卡尔积，以及我应该如何修复它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T10:53:53.333

试试这个：

```
SELECT res.UserID, res.QuizID, res.QuizResult, u.UserID, u.UserLogin, q.QuizID, q.QuizName, q.QuizFile FROM results as res INNER JOIN users as u ON res.UserID = u.UserID INNER加入测验为 q ON res.QuizID = q.QuizID

```

实现类似 INNER JOIN 的另一种方法是：+

```
选择 res.UserID、res.QuizID、res.QuizResult、u.UserID、u.UserLogin、q.QuizID、q.QuizName、q.QuizFile
FROM 结果为 res，users 为 u，quiz 为 q
其中 res.UserID = u.UserID
AND res.QuizID = q.QuizID

```

# c# - C#如何使用多个参数调用

> ID：729430
> 
> 赞同：14
> 
> 时间：2009-04-08T10:47:04.457
> 
> 标签：c#, winforms, invoke

我使用下面的代码访问表单上的属性，但今天我想将内容写入 ListView，这需要更多参数。

```
 public string TextValue
    {
        set
        {
            if (this.Memo.InvokeRequired)
            {
                this.Invoke((MethodInvoker)delegate
                {
                    this.Memo.Text += value + "\n";
                });
            }
            else
            {
                this.Memo.Text += value + "\n";
            }
        }
    } 
```

如何添加多个参数以及如何使用它们（值，值）？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-08T10:48:24.983

（**编辑**- 我想我误解了原来的问题）

只需使其成为方法而不是属性：

```
public void DoSomething(string foo, int bar)
{
    if (this.InvokeRequired) {
        this.Invoke((MethodInvoker)delegate {
            DoSomething(foo,bar);
        });
        return;
    }
    // do something with foo and bar
    this.Text = foo;
    Console.WriteLine(bar);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-08T12:42:38.827

通常，您可以执行以下操作

*   在 C# 2012/Net 4.5 中创建一个名为 Lambda1 的 Windows 窗体应用程序项目
*   在 Form1 窗体中，插入一个名为 label1 的标签
*   按 F4 打开 Form1 属性（不是 label1 属性）
*   单击事件视图（带有雷声的图标）
*   双击表单关闭事件。将创建一个事件处理程序。
*   现在不要介意事件处理程序。稍后将被另一个替换；
*   选择并擦除 Form.cs 中的所有代码（Ctrl-A/Delete 键）
*   将以下代码复制并粘贴到Form1.cs；

* * *

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Linq.Expressions;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.Diagnostics;
namespace Lambda1
{
public partial class Form1 : Form
{

    System.Timers.Timer t = new System.Timers.Timer(1000);
    Int32 c = 0;
    Int32 d = 0;
    Func<Int32, Int32, Int32> y;

    public Form1()
    {

        InitializeComponent();           
        t.Elapsed += t_Elapsed;
        t.Enabled = true;
    }

    void t_Elapsed(object sender, System.Timers.ElapsedEventArgs e)
    {
        c = (Int32)(label1.Invoke(y = (x1, x2) => 
              { label1.Text = (x1 + x2).ToString(); 
                               x1++;  
                               return x1; },  
                               c,d));
        d++;
    }

    private void Form1_FormClosing(object sender, FormClosingEventArgs e)
    {
        t.Enabled = false;
    }
}

} 
```

* * *

这段代码的作用是：

创建了一个计时器。已用事件处理程序

```
void t_Elapsed(object sender, System.Timers.ElapsedEventArgs e) 
```

将每 1000 毫秒调用一次

label1.Text 将在此事件处理程序中更新。没有Invoke，就会发出一个线程

要使用新值更新 label1.Text，使用了代码

* * *

```
c = (Int32)(label1.Invoke(y = (x1, x2) => { label1.Text = (x1 +
x2).ToString(); x1++; return x1; }, c,d)); 
```

* * *

请注意，c 和 d 在 Invoke 函数中作为参数传递给 x1 和 x2，并且 x1 在 Invoke 调用中返回。

在这段代码中插入变量 d 只是为了说明在调用 Invoke 时如何传递多个变量。

# c# - 属性大括号的换行选项（C# VS 2005）

> ID：729434
> 
> 赞同：2
> 
> 时间：2009-04-08T10:47:54.687
> 
> 标签：c#, visual-studio-2005

真的很简单 - 在工具、选项、文本编辑器、C#、新行、大括号的新行选项中，没有属性选项...

还是我疯了，只是找不到它？

编辑：我正在使用一个生成代码的加载项，据报道使用了 VS 设置....但似乎没有，所以我已经放弃了这个问题，这并不重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T11:07:26.263

确实没有；它使用“方法”设置。Resharper 可能有更多的控制权，但也有价格标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T11:08:02.503

对于属性的外大括号，它与方法的外大括号相同（将左大括号放在方法的新行上）。

# windows - 发布版本中与 OutputDebugString 关联的开销

> ID：729435
> 
> 赞同：22
> 
> 时间：2009-04-08T10:47:56.980
> 
> 标签：windows, performance, winapi, logging

在发布版本中调用 OutputDebugString 是否存在重大开销？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-08T11:21:57.353

测量 - 10M 调用大约需要 50 秒。我认为这对于未使用的功能来说是一笔巨大的开销。

使用宏可以帮助在发布版本中摆脱这种情况：

```
#ifdef _DEBUG
    #define LOGMESSAGE( str ) OutputDebugString( str );
#else
    #define LOGMESSAGE( str )
#endif 
```

不仅删除了调用，还完全删除了参数评估和文本字符串，您不会在二进制文件中看到它们。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-08-18T08:30:42.477

我在回答这个问题很久之后才写这篇文章，但是给定的答案错过了某个方面：

当没有人收听它的输出时，OutputDebugString 可以非常快。然而，在后台运行一个监听器（无论是 DbgView、DBWin32、Visual Studio 等）可以使它慢 10 倍以上（在 MT 环境中要慢得多）。原因是这些侦听器挂钩了报告事件，并且它们对事件的处理是在 OutputDebugString 调用的范围内完成的。此外，如果多个线程同时调用 OutputDebugString，它们将被同步。有关更多信息，请参阅[注意：DebugView (OutputDebugString) 和性能](https://docs.microsoft.com/en-us/archive/blogs/darrenj/watch-out-debugview-outputdebugstring-performance)。

作为旁注，我认为除非您正在运行实时应用程序，否则您不应该担心需要 50 秒才能运行 10M 调用的设施。如果您的日志包含 10M 条目，那么浪费的 50 秒是您的问题中最少的，因为您必须以某种方式分析野兽。10K 的日志听起来要合理得多，根据Sharptooth 的测量，创建它只需0.05 秒。

因此，如果您的输出在合理的大小范围内，使用 OutputDebugString 应该不会对您造成太大伤害。但是，请记住，一旦系统上有人开始收听此输出，就会出现减速。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-08T11:56:01.297

我在一篇文章中读到 OutPutDebugString 在内部做了一些有趣的事情：

1.  创建\打开互斥锁并无限等待，直到获得互斥锁。
2.  在应用程序和调试器之间传递数据是通过一个 4kbyte 的共享内存块完成的，其中一个 Mutex 和两个 Event 对象保护对它的访问。

即使没有附加调试器（在发布模式下），使用 OutputDebugstring 和使用各种内核对象也会产生巨大的成本。

如果您编写示例代码并进行测试，性能损失非常明显。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-08T11:07:12.893

多年来，我在数十个服务器端发布模式的应用程序中没有看到任何问题，所有这些应用程序都有内置的指标。您可能会觉得它很慢，因为您可以找到的大多数调试捕获应用程序（DBWIN32 等）在将数据扔到屏幕上时都很慢，这给人一种滞后的印象*。*

当然，我们所有的应用程序都默认禁用此输出，但能够在现场打开它*很有*用，因为您可以查看多个应用程序的调试输出，在 DBWin32 等中序列化。对于涉及通信应用程序的错误，这可能是一种非常有用的调试技术。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-08T12:23:58.483

永远不要在发布版本中留下 OutputDebugString() 调用。始终使用#ifdef 语句删除它们，或者提供另一个开关来关闭它们。

如果您将它们留在其中，则默认禁用它们并仅在请求时激活它们，因为否则您的应用程序将难以调试其他表现良好的应用程序（即，仅在请求时输出调试数据）。

Theres [DebugView](http://technet.microsoft.com/en-us/sysinternals/bb896647.aspx)来捕捉应用程序的输出，但当然，如果不是每个应用程序都无缘无故地喋喋不休，那当然是好的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-08T10:57:46.957

为什么不自己测量呢？编译以下代码，运行它并计时。然后去掉对OutputDebugString的调用，重新编译重新运行。应该花你三分钟的时间。

```
 #include <windows.h>

    int main() {
        const int COUNT = 1000000;
        int z = 0;    
        for ( unsigned int i = 0; i < COUNT; i++ ) {
            z += i;
            OutputDebugString( "foo" );
        }
        return z;
    } 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-05-21T10:19:36.040

我对这个话题很好奇，所以我做了一些研究。

我已经发布了结果、源代码和项目文件，以便您可以为您的设置重复测试。涵盖了在不监视 OutputDebugString 的情况下运行发布模式应用程序，然后使用 Visual Studio 6、Visual Studio 2005 和 Visual Studio 2010 监视 OutputDebugString 以查看每个 Visual Studio 版本的性能差异。

有趣的结果是，Visual Studio 2010 处理 OutputDebugString 信息的速度比 Visual Studio 6 慢 7 倍。

全文在这里：[OutputDebugString 的成本是多少？](http://www.softwareverify.com/software-verify-blog/?p=261)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-06-22T14:19:11.457

现有答案可以追溯到 2009 / 2010 年。

虽然被遗忘的 OutputDebugString() 的性能可能没有太大变化，但我可以看出该工具有很大的不同。

*   无工具：30 µs/调用 (x86) 10 µs/调用 (x64)
*   [DebugView](https://docs.microsoft.com/en-us/sysinternals/downloads/debugview)（完全禁用）：64 µs/调用 (x86) 37 µs/调用 (x64)
*   [DebugView++](https://github.com/CobaltFusion/DebugViewPP)（暂停）：67 µs (x86)
*   DebugView（自动滚动停用）：735 µs/调用 (x86) 703 µs/调用 (x64)
*   DebugView++（自动滚动停用）：67 µs/调用
*   DebugView（自动滚动激活）：936 µs (x86) 799 µs/调用 (x64)
*   DebugView++（自动滚动激活）：67µs/调用
*   VS 2019：81 µs/通话
*   DebugView（同步 2 个实例）：高达 1736 µs/调用
*   DebugView++（同步 2 个实例）：高达 102µs/调用

结论：

原来的 DebugView 太慢了，我减少了样本的数量以在某个时候实际完成。

DebugView++ 做得非常好。

[VS 2019 似乎比这个答案](https://stackoverflow.com/a/2881218/480982)中提到的旧版 Visual Studio 做得更好。我无法比较自己，但它与 DebugView++ 非常接近，我认为它非常好。

* * *

测量：在单个 for 循环中调用了 100.000 次 OutPutDebugStringW。发布模式下的所有构建。Intel i7-6820HQ，2.7 GHz，限制为 99% 以防止 Turbo Boosting。用于在100.000`std::chrono::high_resolution_clock::now()`次通话之前和之后进行测量。

# c# - 参数类型“FluentNHibernate.Mapping.IProperty”不符合 CLS

> ID：729456
> 
> 赞同：0
> 
> 时间：2009-04-08T10:52:01.263
> 
> 标签：c#, .net, cls-compliant

名称不合规？布局？什么？

您有什么想法可以生成此消息吗？欢迎任何想法。我有一堆这样的警告。

实际上，我愿意删除 CLSCompliant(true)，但我想知道根本原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T11:10:58.347

它不只是`Fluent.NHibernate`组装不那么简单`CLSCompliant`吗？该 `IProperty`类型不合规，因此将其作为参数的方法不合规。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T10:57:21.063

您可能有一个成员使用不同大小写的相同名称 - 例如 iProperty。或者，也许您有两个仅在大小写上有所不同的论点。

# .htaccess - 重新设计网站 (SEO) 后的多个 301 重定向

> ID：729462
> 
> 赞同：5
> 
> 时间：2009-04-08T10:55:09.100
> 
> 标签：.htaccess, seo, http-status-code-404, http-status-code-301

我们最近更新了我们的网站；旧的大约有 300 页……新的大约 80 页；）

这是因为在旧结构中，对于每个论点，我们都有很多页。相反，现在我们只有一页带有“摘要”的页面。

例如，关于“汽车”参数的旧结构是：

1.  主页，“汽车”
2.  子页面，“轮胎”
3.  子页面，“引擎”
4.  子页面，“附件”
5.  ETC...

现在，我们只有一页“汽车”，里面全是。

实际上，我使用 .htaccess 301 重定向将所有子页面重定向到主页面：

```
Redirect 301 /cars-tires.php http://www.example.com/cars.php
Redirect 301 /cars-engines.php http://www.example.com/cars.php
Redirect 301 /cars-accessories.php http://www.example.com/cars.php 
```

因此，我们有许多不同的（即使主题相同）指向一页的页面。

你认为这对 seo 有好处，还是只重定向旧的主页并给旧的子页面一个 404 not found 更好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T11:08:53.140

拥有多个 301 会好得多。您不希望您的客户看到 404。

有多个页面 301 到同一页面没有 SEO 惩罚（我知道）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-09-28T23:34:55.407

301 肯定比用 404 甩掉你的客户要好。如果你做对人类用户真正最好的事情，你应该会发现搜索引擎会尊重这一点。

请注意，您可以通过将指令合并为一个来整理 .htaccess 文件：

```
RedirectMatch Permanent ^/cars-(tires|engines|accessories).php$ http://www.example.com/cars.php 
```

甚至更通用的

```
RedirectMatch Permanent ^/(.+)-(.+).php$ http://www.example.com/$1.php 
```

如果您有很多 /foo-bar.php 形式的 URL 必须重定向到 /foo.php

# iphone - “nib”和“xib”代表什么？

> ID：729463
> 
> 赞同：41
> 
> 时间：2009-04-08T10:56:23.967
> 
> 标签：iphone, xcode

我想知道为什么该文件扩展名被称为`nib`或`xib`.

我猜*nib*中的*ib*是.*`Interface Builder`*

 *但是`n`? 还是`x`？任何的想法？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-04-08T10:59:02.587

`nib`代表“NeXT Interface Builder”，而`xib`代表“Mac OS X Interface Builder”。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-08T10:58:55.707

我认为“n”表示 NextStep，添加“x”表示新的基于 XML 的格式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-11T06:34:53.260

*   “nib”代表**Next Interface Builder**
*   “xib”代表**Xml 接口生成器**。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-17T13:39:39.393

（“NextStep”中的 N 或“XML”中的 X）+ Interface Builder

# iphone - 如何使用 cocos2d 在 iPhone 应用程序中使某些文本不可见（显示在标签中）？

> ID：729481
> 
> 赞同：-1
> 
> 时间：2009-04-08T11:00:42.693
> 
> 标签：iphone, cocos2d-iphone

我想让一些显示在标签中的文本不可见。我可以使用它使它不可见：

```
labelname.visible = NO; 
```

但是，当我调用不同的屏幕时，这会产生问题。我需要一种不同的方法来使标签文本不可见，这不会产生此类问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-11T00:01:42.180

您可以从图层中添加/删除标签以隐藏/显示它，只需保留标签实例以供以后检索。虽然， [yourLabel setVisible:NO] 不应该在场景之间造成问题。

# perl - 如何使用 Perl 将多维数组 (AoA) 添加到 Excel？

> ID：729482
> 
> 赞同：3
> 
> 时间：2009-04-08T11:00:45.610
> 
> 标签：perl, arrays, excel, multidimensional-array

我想使用 Perl 在 Excel 中添加存储在 2x2 维数组中的数据。我知道如何打开和添加简单的数据。我可以使用 for 循环来做到这一点。但我怎样才能优雅地做到这一点？

这就是我想要做的

```
$sheet->Range("A1:B"."$size")->{Value} = @$data;
                                         or   @data;
                                         or   {@data};
                                         or   {\@data}; 
```

其中`@data`是二维数组。

```
# use existing instance if Excel is already running
eval {$ex = Win32::OLE->GetActiveObject('Excel.Application')};
die "Excel not installed" if $@;
unless (defined $ex) {
    $ex = Win32::OLE->new('Excel.Application', sub {$_[0]->Quit;})
            or die "Oops, cannot start Excel";
}

# get a new workbook
$book = $ex->Workbooks->Add;

# write to a particular cell
$sheet = $book->Worksheets(1);
print "A1:B"."$size";
# write a 2 rows by 3 columns range

$sheet->Range("A1:B"."$size")->{Value} = @$data; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T13:15:09.233

我看到你正在使用 Win32::OLE 但这种事情也很容易使用[Spreadsheet::WriteExcel](http://search.cpan.org/~jmcnamara/Spreadsheet-WriteExcel/lib/Spreadsheet/WriteExcel.pm)：

```
#!/usr/bin/perl -w

use strict;
use Spreadsheet::WriteExcel;

my $workbook  = Spreadsheet::WriteExcel->new('test.xls');
my $worksheet = $workbook->add_worksheet();

# Get your AoA from somewhere.
my $data = [
    [ 'Hello', 'world', 123   ],
    [ 'Bye',   'bye',   4.567 ],
];

# Write the data.
$worksheet->write_col( 'A1', $data ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T11:24:41.543

根据一些阅读（我面前没有 Win32 框），它看起来像正确处理对[AoA](http://perldoc.perl.org/perldsc.html#ARRAYS-OF-ARRAYS)的引用的`Value`属性，所以试着说：`Range`

```
my $data = [
    ["a1", "b1"],
    ["a2", "b2"],
];
$sheet->Range("A1:B" . @$data)->{Value} = $data; 
```

# c++ - 如何在 C++ 中切换到另一个目录？

> ID：729486
> 
> 赞同：2
> 
> 时间：2009-04-08T11:01:44.890
> 
> 标签：c++, file-io

我正在用 C++ 编写一个程序，其中有 500 个文件夹，每个文件夹包含一个文本文件。我想从 C++ 中的每个文件夹中读取每个文本文件。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-08T11:23:59.733

如果您想要一种简洁且可移植的方式来访问文件和目录，那么[Boost.Filesystem](http://www.boost.org/doc/libs/1_38_0/libs/filesystem/doc/index.htm)就是您的最佳选择。您应该浏览文档以准确找到您需要的内容。以下是有关如何使用该框架完成工作的建议。

```
#include <iostream>
#include <filesystem>

using std::tr2::sys;
using std::cout;

void do_something_with_file( std::string const& p )
{
  std::cout << "Found file : " << p << std::end;
}

void explore_directory( std::string const& p )
{
    for (directory_iterator itr(p); itr!=directory_iterator(); ++itr)
    {
      if( is_directory(itr->status()) )
      {
        explore_directory(itr->path().filename());
      }
      else if( is_regular_file(itr->status()) )
      {
        do_something_with_file(itr->path().filename());
      }
    }
}

int main(int argc, char* argv[])
{
  std::string p(argc <= 1 ? "." : argv[1]);

  if (is_directory(p))
  {
    explore_directory(p);
  }
  else cout << (exists(p) : "Found: " : "Not found: ") << p << '\n';

  return 0;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T11:06:53.037

C++ 标准没有指定任何目录函数，因此您必须使用特定于实现的东西。例如，在 Windows 上，您可以使用该`chdir()`功能。中声明`<direct.h>`。

顺便说一句，请注意在发布此类问题时指出您对哪个操作系统感兴趣是一个好主意。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T11:06:44.503

[查找第一个文件](http://msdn.microsoft.com/en-us/library/aa364418(VS.85).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T11:16:07.023

您不想更改目录，而只是打开它们以阅读它们的条目（请参阅 opendir() ）

通常我发现处理完整路径比依赖进程的当前目录更容易。

# sql - SQL：计算Oracle中多列的出现次数

> ID：729488
> 
> 赞同：2
> 
> 时间：2009-04-08T11:01:54.437
> 
> 标签：sql, database, oracle

无法理解将返回用户访问特定服务的次数的 SQL。认为它可能需要嵌套计数和选择，但无法理解它。

数据如下所示：

```
UserID  Service
---------------
1       Map1
1       Map2
1       Map1
2       Map1
2       Map2
3       Map4
3       Map2
3       Map2
3       Map2
...     ... 
```

所需的输出类型大致如下：

```
UserID  Service  TimesAccessed
------------------------------
1       Map1     2
1       Map2     1
2       Map1     1     
2       Map2     1
3       Map3     3
3       Map4     1
...     ...      ... 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-08T11:07:27.807

我认为这样做：

```
SELECT  UserID, Service, COUNT(UserID) TimesAccessed
FROM    Table
GROUP BY UserID, Service 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T11:07:27.713

像这样的东西？

```
select  
    userid, service, count(userid)  
 from   
    table  
 group by  
    userid, service 
```

# mysql - 在同一个 MySQL 表中复制/复制记录

> ID：729489
> 
> 赞同：88
> 
> 时间：2009-04-08T11:01:58.180
> 
> 标签：mysql

我一直在寻找一段时间，但我找不到一个简单的解决方案来解决我的问题。我想在表中复制一条记录，但当然，唯一的主键需要更新。

我有这个查询：

```
INSERT INTO invoices
    SELECT * FROM invoices AS iv WHERE iv.ID=XXXXX
    ON DUPLICATE KEY UPDATE ID = (SELECT MAX(ID)+1 FROM invoices) 
```

问题是这只是更改`ID`行的而不是复制行。有人知道如何解决这个问题吗？

//编辑：我想在不输入所有字段名称的情况下执行此操作，因为字段名称会随着时间而改变。

* * *

## 回答 #1

> 赞同：142
> 
> 时间：2010-05-29T18:22:36.163

我通常采用的方式是使用临时表。它可能在计算上效率不高，但似乎可以正常工作！在这里，我将完整复制记录 99，创建记录 100。

```
CREATE TEMPORARY TABLE tmp SELECT * FROM invoices WHERE id = 99;

UPDATE tmp SET id=100 WHERE id = 99;

INSERT INTO invoices SELECT * FROM tmp WHERE id = 100; 
```

希望这对你有用！

* * *

## 回答 #2

> 赞同：88
> 
> 时间：2011-11-10T10:18:08.600

Alex 的回答在多客户端环境中需要注意（例如锁定或事务）。

假设`AUTO ID`字段是表中的第一个字段（通常情况下），我们可以使用隐式事务。

```
    CREATE TEMPORARY TABLE tmp SELECT * from invoices WHERE ...;
    ALTER TABLE tmp 删除 ID；# 删除自增字段
    # 更新 tmp 设置 ...; # 只需要更改其他唯一键
    INSERT INTO invoices SELECT 0,tmp.* FROM tmp;
    删除表 tmp;

```

来自 MySQL 文档：

> 使用 AUTO_INCREMENT：您还可以显式地将 NULL 或 0 分配给列以生成序列号。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-04-08T11:07:48.527

您肯定知道，DUPLICATE KEY 将触发，因此您可以预先选择 MAX(ID)+1：

```
INSERT INTO invoices SELECT MAX(ID)+1, ... other fields ... FROM invoices AS iv WHERE iv.ID=XXXXX 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2017-01-30T15:10:35.050

我知道一个迟到的答案，但这仍然是一个常见问题，我想添加另一个对我有用的答案，只使用单行`insert into`语句，我认为它很简单，无需创建任何新表（因为它可以是`CREATE TEMPORARY TABLE`权限问题）：

```
INSERT INTO invoices (col_1, col_2, col_3, ... etc)
  SELECT
    t.col_1,
    t.col_2,
    t.col_3,
    ...
    t.updated_date,
  FROM invoices t; 
```

该解决方案适用于`AUTO_INCREMENT`id 列，否则，您也可以`ID`在语句中添加列：

```
INSERT INTO invoices (ID, col_1, col_2, col_3, ... etc)
  SELECT
    MAX(ID)+1,
    t.col_1,
    t.col_2,
    t.col_3,
    ... etc ,
  FROM invoices t; 
```

这真的很简单直接，您可以在一行中更新其他任何内容，而无需任何第二个更新语句供以后使用（例如：用额外的文本更新标题列或用另一个字符串替换字符串），您也可以具体说明什么你想复制，如果全部，那么它是，如果有的话，你可以这样做。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-04-12T19:27:37.980

您的方法很好，但问题是您使用“*”而不是登记字段名称。如果你把除主键之外的所有列名放在你的脚本上，你的脚本将像魅力一样在一条或多条记录上工作。

```
INSERT INTO invoices (iv.field_name, iv.field_name,iv.field_name
) SELECT iv.field_name, iv.field_name,iv.field_name FROM invoices AS iv     
WHERE iv.ID=XXXXX 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-07-12T19:40:00.950

如果您碰巧想要复制整组记录，我只是想扩展 Alex 的出色答案以使其适合：

```
SET @x=7;
CREATE TEMPORARY TABLE tmp SELECT * FROM invoices;
UPDATE tmp SET id=id+@x;
INSERT INTO invoices SELECT * FROM tmp; 
```

我只需要这样做，就发现亚历克斯的回答是一个完美的起点！当然，您必须将@x 设置为表中的最高行号（我相信您可以通过查询来获取它）。这仅在这种非常特殊的情况下有用，因此当您不希望复制所有行时要小心使用它。根据需要调整数学。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-03-13T18:59:48.687

我有一个类似的问题，这就是我正在做的事情：

```
insert into Preguntas  (`EncuestaID`, `Tipo` , `Seccion` , `RespuestaID` , `Texto` )  select '23', `Tipo`, `Seccion`, `RespuestaID`, `Texto` from Preguntas where `EncuestaID`= 18 
```

怀孕了：

```
CREATE TABLE IF NOT EXISTS `Preguntas` (
  `ID` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `EncuestaID` int(11) DEFAULT NULL,
  `Tipo` char(5) COLLATE utf8_unicode_ci DEFAULT NULL,
  `Seccion` int(11) DEFAULT NULL,
  `RespuestaID` bigint(11) DEFAULT NULL,
  `Texto` text COLLATE utf8_unicode_ci ,
  PRIMARY KEY (`ID`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci AUTO_INCREMENT=522 ; 
```

所以，`ID`是自动递增的，而且我使用一个固定值（'23'）`EncuestaID`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-03-24T11:32:25.303

我也需要这个；我的解决方案是使用 SQLYOG（免费版）将所需的记录导出为 SQL（创建插入）。

然后我手动编辑它以删除 id，因为这需要自动生成，然后将插入复制到 SQLYog 中以执行它。这是无痛的。我猜很多其他 MySQL GUI 也可以做到这一点。

这为我提供了可用于在实时系统上进行测试的记录。

我现在也有这个插入以供重复使用，因为该表每天都在重写。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-01-13T10:57:24.477

略有不同，主要区别是将主键字段（“varname”）设置为 null，这会产生警告但有效。通过将主键设置为 null，在最后一条语句中插入记录时，自动增量起作用。

此代码还清理了以前的尝试，并且可以多次运行而不会出现问题：

```
DELETE FROM `tbl` WHERE varname="primary key value for new record";
DROP TABLE tmp;
CREATE TEMPORARY TABLE tmp SELECT * FROM `tbl` WHERE varname="primary key value for old record";
UPDATE tmp SET varname=NULL;
INSERT INTO `tbl` SELECT * FROM tmp; 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-14T20:15:26.610

您可以更改临时表以将 ID 字段更改为 bigint 左右而不需要 NOT NULL 要求，然后在该临时表中将 ID 设置为 0。之后将其添加回原始表，NULL 将触发自动增量。

```
CREATE TEMPORARY TABLE tmptable SELECT * FROM x WHERE (id='123');
ALTER TABLE tmptable CHANGE id id bigint;
UPDATE tmptable SET id = NULL;
INSERT INTO x SELECT * FROM tmptable; 
```

# java - 主要修订版中Java语言变化的简明解释

> ID：729496
> 
> 赞同：4
> 
> 时间：2009-04-08T11:05:18.767
> 
> 标签：java, programming-languages, java-5, java1.4

几年后，我将再次进入 Java 开发领域。我使用的语言版本是 1.4.2。我知道从那时起语言发生了重大变化，我正在寻找一个网站或一本书来详细介绍这些内容。至少，我正在寻找一种资源，该资源表明在哪个版本中添加了哪些语言功能，因此我可以一目了然地跳过我已经熟悉的部分。有什么建议么 ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T11:09:56.587

[Wikipedia 条目](http://en.wikipedia.org/wiki/Java_version_history)对于您想要查看的内容似乎足够简洁。

提炼：

## J2SE 5.0（2004 年 9 月 30 日）

代号老虎。（最初编号为 1.5，仍用作内部版本号。）在 JSR 176 下开发，Tiger 添加了许多重要的新语言特性：

*   泛型：为集合提供编译时（静态）类型安全，并消除对大多数类型转换（类型转换）的需求。（由 JSR 14 指定。）
*   元数据：也称为注释；允许用附加数据标记诸如类和方法之类的语言结构，然后可以由元数据感知实用程序处理这些数据。（由 JSR 175 指定。）
*   自动装箱/拆箱：原始类型（例如 int）和原始包装类（例如 Integer）之间的自动转换。（由 JSR 201 指定。）
*   枚举： enum 关键字创建一个类型安全、有序的值列表（例如 Day.MONDAY、Day.TUESDAY 等）。以前，这只能通过非类型安全的常量整数或手动构造的类（类型安全的枚举模式）来实现。（由 JSR 201 指定。）
*   Swing：新的可换肤外观和感觉，称为合成器。
*   Varargs：方法的最后一个参数现在可以使用类型名称后跟三个点来声明（例如 void drawtext(String...lines)）。在调用代码中，可以使用任意数量的该类型的参数，然后将它们放在一个数组中以传递给方法，或者调用代码可以传递该类型的数组。
*   为每个循环增强：for 循环语法通过特殊语法进行了扩展，用于迭代数组或任何 Iterable 的每个成员，例如标准 Collection 类（由 JSR 201 指定。）
*   修复之前破坏的 Java 内存模型语义，它定义了线程如何通过内存进行交互。
*   RMI 对象的自动存根生成。
*   静态导入

*   1.5.0_17 (5u17) 是最后一个正式支持 Microsoft Windows 9x 系列（Windows 95、Windows 98、Windows ME）的 Java 版本。[1](http://en.wikipedia.org/wiki/Java_version_history)非正式地，Java SE 6 Update 7 (1.6.0.7) 是在该系列操作系统上展示的最后一个 Java 版本。

*   包 java.util.concurrent 中的并发实用程序。

J2SE 5.0 于 2008 年 4 月 8 日进入其生命周期，自 2009 年 10 月 30 日起，Sun 将不再提供支持。

## Java SE 6（2006 年 12 月 11 日）

代号野马。在此版本中，Sun 将名称“J2SE”替换为 Java SE，并从版本号中删除了“.0”。开发人员的内部编号仍为 1.6.0。这个版本是在 JSR 270 下开发的。

在开发阶段，大约每周都会发布包括增强功能和错误修复在内的新版本。Beta 版本于 2006 年 2 月和 6 月发布，最终版本于 2006 年 12 月 11 日发布。当前版本是 2009 年 2 月发布的 Update 12。

此版本中包含的主要更改：

*   放弃了对旧 Win9x 版本的支持。非官方的 Java 6 Update 7 是最后一个显示可在这些版本的 Windows 上工作的 Java 版本。这被认为是由于更新 10 中的重大变化。
*   脚本语言支持 (JSR 223)：用于与脚本语言紧密集成的通用 API，以及内置的 Mozilla Javascript Rhino 集成
*   核心平台 [17] [18] 和 Swing 的性能显着提升。
*   通过 JAX-WS (JSR 224) 改进了 Web 服务支持
*   JDBC 4.0 支持 (JSR 221)。
*   Java Compiler API (JSR 199)：允许 Java 程序以编程方式选择和调用 Java Compiler 的 API。
*   将 JAXB 升级到 2.0 版：包括集成 StAX 解析器。
*   支持可插入注释 (JSR 269)。
*   许多 GUI 改进，例如在 API 中集成 SwingWorker、表格排序和过滤以及真正的 Swing 双缓冲（消除灰色区域效果）。

### Java SE 6 更新 10

Java SE 6 Update 10（以前称为 Java SE 6 Update N）虽然没有更改任何公共 API，但在最终用户可用性方面是一项重大增强。发行版目前可供下载。

此更新的主要更改包括：

*   Java Deployment Toolkit，一组 JavaScript 函数，用于简化小程序和 Java Web Start 应用程序的部署。
*   Java Kernel，一个小型安装程序，仅包含最常用的 JRE 类。需要时下载其他软件包。
*   增强的更新程序。
*   增强的版本控制和 pack200 支持：不再需要服务器端支持。
*   Java Quick Starter，改善冷启动时间。
*   使用 Direct3D 和硬件加速改进了 Windows 上 Java2D 图形基元的性能。
*   一种新的 Swing 外观和感觉，称为 Nimbus，基于合成器。[23]
*   下一代 Java 插件：小程序现在在单独的进程中运行并支持 Web Start 应用程序的许多功能

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T11:10:22.467

您可以查看 Sun 网站。您可以找到[Java 5](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html)和[Java 6](http://java.sun.com/javase/6/webnotes/features.html)中的更改。我认为大多数重大的语言变化都来自 Java 5，包括泛型、自动装箱、可变参数、枚举等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T11:11:24.727

以下是 Sun 的[Java 5 新特性](http://java.sun.com/j2se/1.5.0/docs/relnotes/features.html)列表。

有很多，而且非常基础。

相比之下，我认为 Java 6 中的语言本身根本没有任何变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T12:22:44.990

大约一年前，我和你在同一条船上，发现[Java 1.5 Tiger A Developer's Notebook](http://oreilly.com/catalog/9780596007386/)作为 1.4 和 1.5 之间主要变化的速成课程非常有用。它会让你加快速度。然后可以使用sun的网站或者其他资源深入学习。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T11:09:24.403

[泛型](http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html)

如果您熟悉 C++，那么它只是 Java 的模板。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T16:47:20.533

Java 6 的主要功能我发现我不能没有，按重要性顺序排列：

*   **泛型**：允许语言了解类型参数（集合、容器、工厂...中的成员对象类型）
*   **自动装箱**：将原始类型自动转换为对象，反之亦然
*   **协变返回类型覆盖**：类似于多态性，允许您使用更具体的返回类型覆盖方法。

# sql - 使用连接进行 SQL 更新？

> ID：729497
> 
> 赞同：4
> 
> 时间：2009-04-08T11:05:23.710
> 
> 标签：sql, sql-server-2005, join, sql-update

我有两张桌子。一种是简单的字符串/ID 查找：

字符串表：

```
str_key 字符串
0'一个'
1'b'

```

其中字符串是唯一的。另一个更复杂，包括共享的 string_id

值表：

```
str_key other_key 值
0 0 1.234
0 1 1.567
1 0 1.890

```

现在，我想对 ValTable 进行更新，使用我查找的字符串通过 StrTable 获取 str_key。简单的更新将是：

```
UPDATE ValTable SET val = 2.124 WHERE str_key = 0 AND other_key = 1 LIMIT 1
IF @@ROWCOUNT=0 INSERT INTO ValTable VALUES (0,1,2.124); 
```

那么如何修改它以包括使用一些字符串'a'查找str_key？我假设我需要加入，但我从未在更新中加入过。或者我可以在 where 子句中添加更多内容吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-08T11:09:12.483

这是您需要的语法：

```
UPDATE  v
SET     val = 2.124
FROM    ValTable v
        INNER JOIN
                StringTable s
                ON v.str_key = s.str_key
WHERE   s.String = 'a'
AND     v.other_key = 1

IF @@ROWCOUNT = 0
BEGIN

        INSERT
        INTO    ValTable
        SELECT  str_key, 1, 2.124
        FROM    StringTable
        WHERE   String = 'a'

END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T18:31:59.190

David M 的上述示例是有效且有效的。根据表的大小，您可能希望避免“盲目更新”，因为这可能会导致非常大的表出现性能问题。请注意 IF EXISTS() 中的表提示。

```
IF EXISTS(
        SELECT 
            * 
        FROM 
            ValTable v WITH(NOLOCK)
            INNER JOIN StringTable s WITH(NOLOCK) ON v.str_key = s.str_key 
        WHERE 
            s.String = 'a' 
        AND v.other_key = 1
    )
BEGIN
    UPDATE  
        v
    SET     
        val = 2.124
    FROM    
        ValTable v
        INNER JOIN StringTable s ON v.str_key = s.str_key
    WHERE   
        s.String = 'a'
    AND v.other_key = 1
END
ELSE
BEGIN
    INSERT INTO ValTable
        --(You should define your columns here, You didn't provide a sample schema so I don't know what your columns are.)
        --(Col1,COl2,COl3,etc...)
    SELECT  
        str_key, 1, 2.124
    FROM    
        StringTable
    WHERE   
        String = 'a'
END 
```

# c# - 如何在 C# 中编组结构数组？

> ID：729514
> 
> 赞同：10
> 
> 时间：2009-04-08T11:09:10.003
> 
> 标签：c#, marshalling

我在 C# 中有以下结构：

```
[StructLayoutAttribute(LayoutKind.Sequential)]
public struct RECORD
{
    public uint m1;
    public uint m2;
    public uint m3;
} 
```

我还需要将这些结构的**数组**（固定长度）传递给本机代码，本机代码将一些数据写入这些结构。该数组在 C# 中分配并传递给 C dll。我将导入的函数声明为：

```
[DllImport("marshall.dll", CallingConvention = CallingConvention.Cdecl)]
private static extern void doIt(RECORD[] dataRecord); 
```

但我没有得到任何数据。我已经尝试过 PInvoke 互操作助手。我应该在这里使用 IntPtr 吗？有任何想法吗？

**编辑：**

这是调用本机函数的 C# 代码：

```
RECORD[] rec = new RECORD[256];
doIt(rec);
// values of rec are all zero here 
```

这是C函数：

```
int doIt(RECORD* rec)
{
    // deref pointer and write some data
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-08T11:31:26.223

我远非 P/Invoke 专家，但我想知道是否将其作为输入/输出参数可能会有所帮助：

```
DllImport("marshall.dll", CallingConvention = CallingConvention.Cdecl)]
private static extern void doIt([In, Out] RECORD[] dataRecord); 
```

不过，我没*想到*这是必要的，因为`LayoutKind.Sequential`我希望您的结构已经是 blittable 类型，并且数组也是 blittable 。

# c# - passing in object by ref

> ID：729526
> 
> 赞同：3
> 
> 时间：2009-04-08T11:12:03.647
> 
> 标签：c#, .net, ref

What is the difference between

```
public function Foo(ref Bar bar)
{
   bar.Prop = 1;
}

public function Foo(Bar bar)
{
   bar.Prop = 1;
} 
```

essentially what is the point of "ref". isn't an object always by reference?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-08T11:17:55.270

The point is that you never actually pass an *object*. You pass a *reference* - and the argument itself can be passed by reference or value. They behave differently if you change the parameter value itself, e.g. setting it to `null` or to a different reference. With `ref` this change affects the caller's variable; without `ref` it was only a *copy* of the value which was passed, so the caller doesn't see any change to their variable.

See [my article on argument passing](http://pobox.com/~skeet/csharp/parameters.html) for more details.

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-08T11:13:57.823

Yes. But if you were to do this:

```
public function Foo(ref Bar bar)
{
   bar = new Bar();
}

public function Foo(Bar bar)
{
    bar = new Bar();
} 
```

then you'd see the difference. The first passes a reference to the reference, and so in this case bar gets changed to your new object. In the second, it doesn't.

# c# - 是否可以使用显式类型转换将基类对象分配给派生类引用？

> ID：729527
> 
> 赞同：100
> 
> 时间：2009-04-08T11:12:38.997
> 
> 标签：c#, casting, derived-class, base-class, downcast

是否可以在 C# 中使用显式类型转换将基类对象分配给派生类引用？

我已经尝试过了，它会产生运行时错误。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-04-08T11:15:26.433

不可以。对派生类的引用必须实际引用派生类的一个实例（或 null）。否则你会如何期望它的行为？

例如：

```
object o = new object();
string s = (string) o;
int i = s.Length; // What can this sensibly do? 
```

如果您希望能够将基类型的实例转换为派生类型，我建议您编写一个方法来创建适当的派生类型实例。或者再次查看您的继承树并尝试重新设计，以便您一开始就不需要这样做。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2009-04-08T11:36:30.953

不，这是不可能的，因为将其分配给派生类引用就像说“基类是派生类的完全替代品，它可以做派生类可以做的一切”，这是不正确的，因为派生类通常提供比它们的基类更多的功能（至少，这是继承背后的想法）。

您可以在派生类中编写一个构造函数，将基类对象作为参数，复制值。

像这样的东西：

```
public class Base {
    public int Data;

    public void DoStuff() {
        // Do stuff with data
    }
}

public class Derived : Base {
    public int OtherData;

    public Derived(Base b) {
        this.Data = b.Data;
        OtherData = 0; // default value
    }

    public void DoOtherStuff() {
        // Do some other stuff
    }
} 
```

在这种情况下，您将复制基对象并获得具有派生成员默认值的功能齐全的派生类对象。这样你也可以避免 Jon Skeet 指出的问题：

```
Base b = new Base();//base class
Derived d = new Derived();//derived class

b.DoStuff();    // OK
d.DoStuff();    // Also OK
b.DoOtherStuff();    // Won't work!
d.DoOtherStuff();    // OK

d = new Derived(b);  // Copy construct a Derived with values of b
d.DoOtherStuff();    // Now works! 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-05-03T14:43:58.817

我遇到了这个问题，并通过添加一个采用类型参数并将当前对象转换为该类型的方法来解决它。

```
public TA As<TA>() where TA : Base
{
    var type = typeof (TA);
    var instance = Activator.CreateInstance(type);

     PropertyInfo[] properties = type.GetProperties();
     foreach (var property in properties)
     {
         property.SetValue(instance, property.GetValue(this, null), null);
     }

     return (TA)instance;
} 
```

这意味着您可以像这样在代码中使用它：

```
var base = new Base();
base.Data = 1;
var derived = base.As<Derived>();
Console.Write(derived.Data); // Would output 1 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2019-06-16T15:47:05.697

# 使用 JsonConvert 的解决方案（而不是类型转换）

今天我遇到了同样的问题，我找到了一个简单**快捷的解决**方案`JsonConvert`。

```
var base = new BaseClass();
var json = JsonConvert.SerializeObject(base);
DerivedClass derived = JsonConvert.DeserializeObject<DerivedClass>(json); 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2016-09-17T06:30:07.513

正如许多其他人回答的那样，不。

当我需要将基类型用作派生类型时，我会在那些不幸的情况下使用以下代码。是的，这违反了 Liskov 替换原则 (LSP)，是的，大多数时候我们更喜欢组合而不是继承。向 Markus Knappen Johansson 的道具，其原始答案基于此。

基类中的这段代码：

```
 public T As<T>()
    {
        var type = typeof(T);
        var instance = Activator.CreateInstance(type);

        if (type.BaseType != null)
        {
            var properties = type.BaseType.GetProperties();
            foreach (var property in properties)
                if (property.CanWrite)
                    property.SetValue(instance, property.GetValue(this, null), null);
        }

        return (T) instance;
    } 
```

允许：

```
 derivedObject = baseObect.As<derivedType>() 
```

由于它使用反射，它是“昂贵的”。相应地使用。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-04-08T11:14:39.633

不，这是不可能的，因此您的运行时错误。

但是您可以将派生类的实例分配给基类类型的变量。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-01-07T20:36:35.780

正如这里的每个人所说，这是不可能直接的。

我更喜欢并且相当干净的方法是使用像[AutoMapper](http://automapper.org/)这样的对象映射器。

它将自动完成将属性从一个实例复制到另一个实例（不一定是相同类型）的任务。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-08T11:16:04.947

扩展@ybo 的答案-这是不可能的，因为您拥有的基类实例实际上并不是派生类的实例。它只知道基类的成员，对派生类的成员一无所知。

您可以将派生类的实例强制转换为基类的实例的原因是派生类实际上已经是基类的实例，因为它已经具有这些成员。不能说相反的。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-08T11:17:56.597

您可以将类型为基类的**变量强制转换为派生类的类型；**但是，这必然会进行运行时检查，以查看所涉及的实际对象是否属于正确的类型。

一旦创建，对象的*类型*就无法更改（尤其是，它的大小可能不同）。但是，您可以*转换*实例，创建第二种类型的**新**实例 - 但您需要手动编写转换代码。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2021-10-11T21:40:40.820

您必须使用对象克隆器/复制器来一一分配所有属性。

手动执行此操作效率低下，而且不会面向未来。但是序列化和反序列化到 JSON 并返回不是最好的解决方案，它很慢而且内存效率很低。

但是，使用`AutoMapper`速度很快。`PropMapper`甚至更快。

PS。披露：我是[PropMapper](https://github.com/jitbit/PropMapper)开源项目的贡献者。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-08-25T11:09:02.127

不，这是不可能的。

考虑这样一个场景，其中 ACBus 是基类 Bus 的派生类。ACBus 具有 TurnOnAC 和 TurnOffAC 等功能，它们在名为 ACState 的字段上运行。TurnOnAC 将 ACState 设置为 on， TurnOffAC 将 ACState 设置为 off。如果您尝试在 Bus 上使用 TurnOnAC 和 TurnOffAC 功能，则毫无意义。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-09-11T15:22:10.317

```
class Program
{
    static void Main(string[] args)
    {
        a a1 = new b();  
        a1.print();  
    }
}
class a
{
    public a()
    {
        Console.WriteLine("base class object initiated");
    }
    public void print()
    {
        Console.WriteLine("base");
    }
}
class b:a
{
    public b()
    {
        Console.WriteLine("child class object");
    }
    public void print1()
    {
        Console.WriteLine("derived");
    }
} 
```

}

当我们创建一个子类对象时，基类对象是自动启动的，因此基类引用变量可以指向子类对象。

但反之亦然，因为子类引用变量不能指向基类对象，因为没有创建子类对象。

还要注意基类引用变量只能调用基类成员。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2017-05-07T12:44:15.967

实际上有一种方法可以做到这一点。考虑一下如何使用 Newtonsoft JSON 从 json 反序列化对象。它将（或至少可以）忽略缺失的元素并填充它确实知道的所有元素。

这就是我的做法。一个小的代码示例将遵循我的解释。

1.  从基类创建对象的实例并相应地填充它。

2.  使用 Newtonsoft json 的“jsonconvert”类，将该对象序列化为 json 字符串。

3.  现在通过反序列化步骤 2 中创建的 json 字符串来创建子类对象。这将创建具有基类所有属性的子类实例。

这就像一个魅力！所以..这什么时候有用？有些人问这什么时候有意义，并建议更改 OP 的架构以适应您不能通过类继承（在 .Net 中）原生地做到这一点的事实。

就我而言，我有一个设置类，其中包含服务的所有“基本”设置。特定服务有更多选项，并且来自不同的数据库表，因此这些类继承了基类。他们都有一组不同的选项。因此，在检索服务的数据时，首先使用基础对象的实例填充值要容易得多。使用单个数据库查询执行此操作的一种方法。之后，我使用上述方法创建子类对象。然后我进行第二次查询并填充子类对象上的所有动态值。

最终输出是具有所有选项集的派生类。对其他新子类重复此操作只需要几行代码。这很简单，并且它使用了一个非常久经考验的软件包（Newtonsoft）来使魔法发挥作用。

此示例代码是 vb.Net，但您可以轻松转换为 c#。

```
' First, create the base settings object.
    Dim basePMSettngs As gtmaPayMethodSettings = gtmaPayments.getBasePayMethodSetting(payTypeId, account_id)
    Dim basePMSettingsJson As String = JsonConvert.SerializeObject(basePMSettngs, Formatting.Indented)

    ' Create a pmSettings object of this specific type of payment and inherit from the base class object
    Dim pmSettings As gtmaPayMethodAimACHSettings = JsonConvert.DeserializeObject(Of gtmaPayMethodAimACHSettings)(basePMSettingsJson) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-04-27T17:13:29.297

您可以使用扩展：

```
public static void CopyOnlyEqualProperties<T>(this T objDest, object objSource) where T : class
    {
        foreach (PropertyInfo propInfo in typeof(T).GetProperties())
            if (objSource.GetType().GetProperties().Any(z => z.Name == propInfo.Name && z.GetType() == propInfo.GetType()))
                propInfo.SetValue(objDest, objSource.GetType().GetProperties().First(z => z.Name == propInfo.Name && z.GetType() == propInfo.GetType()).GetValue(objSource));
    } 
```

在代码中：

```
public class BaseClass
{
  public string test{ get; set;}
}
public Derived : BaseClass
{
//Some properies
}

public void CopyProps()
{
   BaseClass baseCl =new BaseClass();
   baseCl.test="Hello";
   Derived drv=new Derived();
   drv.CopyOnlyEqualProperties(baseCl);
   //Should return Hello to the console now in derived class.
   Console.WriteLine(drv.test);

} 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-01-13T10:16:33.603

在 c# 9.0 中，您可以尝试为此使用[记录](https://docs.microsoft.com/en-us/dotnet/csharp/tutorials/exploration/records)。它们具有复制所有字段的默认复制构造函数 - 无需对所有字段使用反射/构造函数。

```
public record BaseR
{
   public string Prop1 { get; set; }
}

public record DerivedR : BaseR
{
   public DerivedR(BaseR baseR) : base(baseR) { }
   public string Prop2 { get; set; }
}

var baseR = new BaseR { Prop1 = "base prob" };
var derivedR = new DerivedR(baseR) { Prop2 = "new prop" }; 
```

[![在此处输入图像描述](https://i.stack.imgur.com/klZvz.png)](https://i.stack.imgur.com/klZvz.png)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2015-11-25T04:12:54.257

可能无关紧要，但我能够在给定其基础的派生对象上运行代码。它绝对比我想要的更hacky，但它有效：

```
public static T Cast<T>(object obj)
{
    return (T)obj;
} 
```

...

```
//Invoke parent object's json function
MethodInfo castMethod = this.GetType().GetMethod("Cast").MakeGenericMethod(baseObj.GetType());
object castedObject = castMethod.Invoke(null, new object[] { baseObj });
MethodInfo jsonMethod = baseObj.GetType ().GetMethod ("ToJSON");
return (string)jsonMethod.Invoke (castedObject,null); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-07-19T13:55:41.463

您可以使用泛型来做到这一点。

```
public class BaseClass
{
    public int A { get; set; }
    public int B { get; set; }
    private T ConvertTo<T>() where T : BaseClass, new()
    {
         return new T
         {
             A = A,
             B = B
         }
    }

    public DerivedClass1 ConvertToDerivedClass1()
    {
         return ConvertTo<DerivedClass1>();
    }

    public DerivedClass2 ConvertToDerivedClass2()
    {
         return ConvertTo<DerivedClass2>();
    }
}

public class DerivedClass1 : BaseClass
{
    public int C { get; set; }
}

public class DerivedClass2 : BaseClass
{
    public int D { get; set; }
} 
```

使用这种方法可以获得三个好处。

1.  您没有复制代码
2.  您没有使用反射（这很慢）
3.  您的所有转化都集中在一个地方

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-07-25T00:46:27.797

我知道这很旧，但我已经成功使用了一段时间。

```
 private void PopulateDerivedFromBase<TB,TD>(TB baseclass,TD derivedclass)
    {
        //get our baseclass properties
        var bprops = baseclass.GetType().GetProperties();
        foreach (var bprop in bprops)
        {
            //get the corresponding property in the derived class
            var dprop = derivedclass.GetType().GetProperty(bprop.Name);
            //if the derived property exists and it's writable, set the value
            if (dprop != null && dprop.CanWrite)
                dprop.SetValue(derivedclass,bprop.GetValue(baseclass, null),null);
        }
    } 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-09-18T17:32:40.857

我结合了先前答案的某些部分（感谢那些作者），并将一个简单的静态类与我们正在使用的两种方法组合在一起。

是的，很简单，不，它不涵盖所有场景，是的，它可以扩展并变得更好，不，它并不完美，是的，它可能会变得更高效，不，它不是切片面包以来最棒的事情，是的全面强大的 nuget 包对象映射器，这些映射器更适合大量使用等，yada yada - 但它适用于我们的基本需求:)

当然，它会尝试将值从任何对象映射到任何对象，无论是否派生（当然只有名称相同的公共属性 - 忽略其余部分）。

**用法：**

```
SesameStreetCharacter puppet = new SesameStreetCharacter() { Name = "Elmo", Age = 5 };

// creates new object of type "RealPerson" and assigns any matching property 
// values from the puppet object 
// (this method requires that "RealPerson" have a parameterless constructor )
RealPerson person = ObjectMapper.MapToNewObject<RealPerson>(puppet);

// OR

// create the person object on our own 
// (so RealPerson can have any constructor type that it wants)
SesameStreetCharacter puppet = new SesameStreetCharacter() { Name = "Elmo", Age = 5 };
RealPerson person = new RealPerson("tall") {Name = "Steve"};

// maps and overwrites any matching property values from 
// the puppet object to the person object so now our person's age will get set to 5 and
// the name "Steve" will get overwritten with "Elmo" in this example
ObjectMapper.MapToExistingObject(puppet, person); 
```

**静态实用程序类：**

```
public static class ObjectMapper
{
    // the target object is created on the fly and the target type 
    // must have a parameterless constructor (either compiler-generated or explicit) 
    public static Ttarget MapToNewObject<Ttarget>(object sourceobject) where Ttarget : new()
    {
        // create an instance of the target class
        Ttarget targetobject = (Ttarget)Activator.CreateInstance(typeof(Ttarget));

        // map the source properties to the target object
        MapToExistingObject(sourceobject, targetobject);

        return targetobject;
    }

    // the target object is created beforehand and passed in
    public static void MapToExistingObject(object sourceobject, object targetobject)
    {
        // get the list of properties available in source class
        var sourceproperties = sourceobject.GetType().GetProperties().ToList();

        // loop through source object properties
        sourceproperties.ForEach(sourceproperty => {

            var targetProp = targetobject.GetType().GetProperty(sourceproperty.Name);

            // check whether that property is present in target class and is writeable
            if (targetProp != null && targetProp.CanWrite)
            {
                // if present get the value and map it
                var value = sourceobject.GetType().GetProperty(sourceproperty.Name).GetValue(sourceobject, null);
                targetobject.GetType().GetProperty(sourceproperty.Name).SetValue(targetobject, value, null);
            }
        });
    }
} 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2019-12-14T17:29:12.810

您可以使用立即调用实例构造函数的复制构造函数，或者如果您的实例构造函数执行的操作不止于赋值，则复制构造函数将传入值分配给实例。

```
class Person
{
    // Copy constructor 
    public Person(Person previousPerson)
    {
        Name = previousPerson.Name;
        Age = previousPerson.Age;
    }

    // Copy constructor calls the instance constructor.
    public Person(Person previousPerson)
        : this(previousPerson.Name, previousPerson.Age)
    {
    }

    // Instance constructor.
    public Person(string name, int age)
    {
        Name = name;
        Age = age;
    }

    public int Age { get; set; }

    public string Name { get; set; }
} 
```

[此示例在构造函数下](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/how-to-write-a-copy-constructor)引用了Microsoft C# 文档，过去曾遇到此问题。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2020-06-25T21:57:35.440

不是传统意义上的...转换为 Json，然后转换为您的对象，然后繁荣，完成！上面的杰西首先发布了答案，但没有使用这些扩展方法，这使得过程变得如此简单。创建几个扩展方法：

```
 public static string ConvertToJson<T>(this T obj)
    {
        return JsonConvert.SerializeObject(obj);
    }
    public static T ConvertToObject<T>(this string json)
    {
        if (string.IsNullOrEmpty(json))
        {
            return Activator.CreateInstance<T>();
        }
        return JsonConvert.DeserializeObject<T>(json);
    } 
```

将它们永远放在您的工具箱中，然后您可以随时执行此操作：

```
var derivedClass = baseClass.ConvertToJson().ConvertToObject<derivedClass>(); 
```

啊，JSON的力量。

这种方法有几个陷阱：我们实际上是在创建一个新对象，而不是强制转换，这可能很重要，也可能无关紧要。私有字段不会被传递，带参数的构造函数不会被调用等等。有可能一些子json不会被分配。JsonConvert 天生不处理流。但是，如果我们的类不依赖私有字段和构造函数，这是一种非常有效的将数据从一个类移动到另一个类的方法，无需映射和调用构造函数，这也是我们首先要进行强制转换的主要原因。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2021-11-09T12:09:13.350

关于@MarkusKnappenJohansson 的回答和下面的评论，我们可以更改他的代码扩展扩展函数:) 因此它可以通过此代码更新现有的派生类实例：

```
 public static TDerived As<TDerived>(this Base baseInstance, TDerived updateDerivedInstance = null) where TDerived : Base, new()
    {
        Type baseType = typeof(Base);
        Type derivedType = typeof(TDerived);

        PropertyInfo[] properties = baseType.GetProperties();
        object instanceDerived = null;

        if (updateDerivedInstance == null)
        {
            instanceDerived = Activator.CreateInstance(derivedType);             
        }
        else
        {
            instanceDerived = (object)(updateDerivedInstance);
        }

        foreach (PropertyInfo property in properties)
        {
            if (property.CanWrite)
            {
                property.SetValue(instanceDerived, property.GetValue(baseInstance, null), null);
            }
        }

        return (TDerived)instanceDerived;
    } 
```

获取新派生实例的用法是`var base = new Base(); base.Data = 1; var derived = base.As<Derived>(); Console.Write(derived.Data); // Would output 1`

用于更新现有派生实例的用法是`var derived = new Derived(); var base = new Base(); base.Data = 1; var derivedUpdated = base.As<Derived>(derived); Console.Write(derivedUpdated.Data); // Would output 1`

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-04-16T17:02:51.363

> 是否可以在 C# 中使用显式类型转换将基类对象分配给派生类引用？

不仅可以进行显式转换，还可以进行隐式转换。

C# 语言不允许此类转换运算符，但您仍然可以使用纯 C# 编写它们并且它们可以工作。请注意，定义隐式转换运算符 ( `Derived`) 的类和使用运算符 ( `Program`) 的类必须在单独的程序集中定义（例如，`Derived`该类位于通过包含该类`library.dll`引用的 a 中）。`program.exe``Program`

```
//In library.dll:
public class Base { }

public class Derived {
    [System.Runtime.CompilerServices.SpecialName]
    public static Derived op_Implicit(Base a) {
        return new Derived(a); //Write some Base -> Derived conversion code here
    }

    [System.Runtime.CompilerServices.SpecialName]
    public static Derived op_Explicit(Base a) {
        return new Derived(a); //Write some Base -> Derived conversion code here
    }
}

//In program.exe:
class Program {
    static void Main(string[] args) {
        Derived z = new Base(); //Visual Studio can show squiggles here, but it compiles just fine.
    }
} 
```

当您使用 Visual Studio 中的项目引用引用该库时，VS 在您使用隐式转换时会显示曲线，但它编译得很好。如果您只引用`library.dll`，则没有曲线。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2015-01-19T12:31:36.450

另一种解决方案是添加扩展方法，如下所示：

```
 public static void CopyProperties(this object destinationObject, object sourceObject, bool overwriteAll = true)
        {
            try
            {
                if (sourceObject != null)
                {
                    PropertyInfo[] sourceProps = sourceObject.GetType().GetProperties();
                    List<string> sourcePropNames = sourceProps.Select(p => p.Name).ToList();
                    foreach (PropertyInfo pi in destinationObject.GetType().GetProperties())
                    {
                        if (sourcePropNames.Contains(pi.Name))
                        {
                            PropertyInfo sourceProp = sourceProps.First(srcProp => srcProp.Name == pi.Name);
                            if (sourceProp.PropertyType == pi.PropertyType)
                                if (overwriteAll || pi.GetValue(destinationObject, null) == null)
                                {
                                    pi.SetValue(destinationObject, sourceProp.GetValue(sourceObject, null), null);
                                }
                        }
                    }
                }
            }
            catch (ApplicationException ex)
            {
                throw;
            }
        } 
```

然后在每个接受基类的派生类中都有一个构造函数：

```
 public class DerivedClass: BaseClass
    { 
        public DerivedClass(BaseClass baseModel)
        {
            this.CopyProperties(baseModel);
        }
    } 
```

如果已设置（非空）或未设置，它还将可选地覆盖目标属性。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-02-15T08:20:16.373

怎么样：

```
public static T As<T>(this object obj)
    {
        return JsonConvert.DeserializeObject<T>(JsonConvert.SerializeObject(obj));
    } 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2019-03-21T15:37:06.087

将所有基本属性添加到派生项的最佳方法是在 costructor 中使用反射。试试这段代码，不要创建方法或实例。

```
 public Derived(Base item) :base()
    {

        Type type = item.GetType();

        System.Reflection.PropertyInfo[] properties = type.GetProperties();
        foreach (var property in properties)
        {
            try
            {
                property.SetValue(this, property.GetValue(item, null), null);
            }
            catch (Exception) { }
        }

    } 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2019-08-10T00:12:21.457

我不同意这是不可能的。你可以这样做：

```
public class Auto 
{ 
    public string Make {get; set;}
    public string Model {get; set;}
}

public class Sedan : Auto
{ 
    public int NumberOfDoors {get; set;}
}

public static T ConvertAuto<T>(Sedan sedan) where T : class
{
    object auto = sedan;
    return (T)loc;
} 
```

用法：

```
var sedan = new Sedan();
sedan.NumberOfDoors = 4;
var auto = ConvertAuto<Auto>(sedan); 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-12-05T14:51:37.957

这就是我为字段解决这个问题的方法。如果需要，您可以通过属性进行相同的迭代。您可能想要对`null`等进行一些检查，但这就是我们的想法。

```
 public static DerivedClass ConvertFromBaseToDerived<BaseClass, DerivedClass>(BaseClass baseClass)
            where BaseClass : class, new()
            where DerivedClass : class, BaseClass, new()
        {
            DerivedClass derived = (DerivedClass)Activator.CreateInstance(typeof(DerivedClass));
            derived.GetType().GetFields().ToList().ForEach(field =>
            {
                var base_ = baseClass.GetType().GetField(field.Name).GetValue(baseClass);
                field.SetValue(derived, base_);

            });

            return derived;
        } 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2020-02-27T01:06:21.407

您可以将基础对象序列化为 JSON，然后将其反序列化为派生对象。

* * *

## 回答 #30

> 赞同：-1
> 
> 时间：2009-04-08T11:18:55.910

不，请参阅我提出的这个问题 - [Upcasting in .NET using generics](https://stackoverflow.com/questions/694449/upcasting-in-net-using-generics)

最好的方法是在类上做一个默认构造函数，构造然后调用一个`Initialise`方法

# c# - 随窗口改变大小的WPF Gui？

> ID：729534
> 
> 赞同：0
> 
> 时间：2009-04-08T11:15:39.537
> 
> 标签：c#, .net, wpf, windows, user-interface

有没有人建议如何创建一个可以随窗口大小改变大小的 gui。类似于媒体中心的工作方式。如果媒体中心最大化，字体等会增大。所以gui总是“统一的”？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-08T12:31:47.433

如果您希望包括字体和图像在内的所有内容都调整大小，则需要一个 Viewbox 作为最外层的容器。默认情况下，Viewbox 的 Stretch 属性设置为 Uniform，这意味着所有内容都保持相对纵横比并填充首先剪切它的方向。

这是 MSDN 中的一个示例，显示了各种 Stretch 值的效果。

[![替代文字](https://i.stack.imgur.com/oTBoZ.jpg)](https://i.stack.imgur.com/oTBoZ.jpg)
[（来源：[microsoft.com](http://i.msdn.microsoft.com/dynimg/IC40182.jpg)）]

# asp.net - 防止 TinyMCE 转换换行符

> ID：729543
> 
> 赞同：1
> 
> 时间：2009-04-08T11:17:28.877
> 
> 标签：asp.net, tinymce, wysiwyg, umbraco

我想阻止 TinyMCE 将换行符（例如从记事本粘贴）转换为`<br>`'s. 那是因为我想在标签内发布代码片段`<pre>`，我不想在里面放`<br>`'s。

我已经在配置中尝试了几个 TinyMCE 设置，但均未成功：

```
force_p_newlines : false,
force_br_newlines : false,
remove_linebreaks : false,
convert_newlines_to_brs : false 
```

提交内容后，TinyMCE 仍然会转换我所有的换行符。我正在使用带有 umbraco CMS 的 TinyMCE 3。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T09:41:51.233

问题解决了。这似乎是与 Firefox/TinyMCE 相关的错误。所述症状仅在使用 Firefox 时出现。测试了 Internet Explorer 8 和 Opera 9 并且可以正常工作。

# .net - 为什么 .NET 中不需要 Maven？

> ID：729545
> 
> 赞同：78
> 
> 时间：2009-04-08T11:17:33.977
> 
> 标签：.net, maven-2, build-process, build, build-automation

我的印象是，在 .NET 世界中，并没有真正需要类似 Maven 的工具。

我知道有[Byldan](http://byldan.codeplex.com/)和 NMaven（它还活着吗？），但我还没有看到使用它们的真实项目。

此外，在我从事的大多数 .NET 项目中，从未有人表示需要类似 Maven 的工具。Maven maven 正在解决的问题（自动依赖解析、基于约定的构建结构......）在 .NET 中似乎并不那么重要。

我的看法正确吗？

为什么会这样？

人们在 .NET 中真正使用的是什么？根本没有自动依赖解析？

他们是否在编写自己的构建工具？

是否有人使用 Maven 本身来管理他们的 .NET 项目？这是一个不错的选择吗？

你有什么经验？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2011-03-11T09:40:53.880

对于工件依赖性解决，我会说[Nuget](http://nuget.org)现在是首选的替代方案。它支持并促进构建时间分辨率，即无需将二进制依赖项工件检入到 vcs 中。请参阅[这些](http://blog.davidebbo.com/2011/03/using-nuget-without-committing-packages.html) [文章](http://blog.davidebbo.com/2014/01/the-right-way-to-restore-nuget-packages.html)。

从 Nuget 2.7 版开始，构建时间分辨率得到了更好的支持，命令 Nuget restore 作为选项之一。

**更新：** 现在有一个替代的、兼容 nuget 的包管理器可用 -在处理瞬态依赖关系和协调同一解决方案中项目之间的依赖关系方面，Paket 比 vanilla nuget 客户端更好[。](http://fsprojects.github.io/Paket/)工具似乎也很成熟（VS 集成和 CI 命令行工具）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-08T11:34:23.627

Apache 项目正在推动 Maven，这些项目是*庞大*的Java 开源基础设施的核心部分。maven的广泛采用肯定与此有关，目前的成熟度（质量）水平也很好。

我不认为 .NET 开源世界有任何非常大的开源参与者来推动这样一个概念。不知何故，.NET 似乎总是在等待 redmond 处理这些事情。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-03-24T05:05:13.300

虽然这个问题很老，但这是我的想法。Maven 不仅仅是一个构建工具，它的功能远不止于存储库管理、项目管理、依赖管理、构建管理等等……

但在我看来，主要的吸引力在于依赖管理。JAR 地狱从一开始就是 Java 领域的一个大问题，您需要一些工具来应对它。在 .Net 世界中没有这样的问题（实际上没有 DLL 地狱已被宣传为 .Net 最初的主要吸引力）所以大多数人对 MSBuild 都很好。后来由于大量第三方库的可用性，出现了管理问题。为了摆脱这个问题，他们现在有了 Nuget。

所以简而言之，MsBuild + Nuget 在 .Net 世界中对于大多数项目来说已经足够好了，Maven 对他们来说只是矫枉过正。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2016-04-15T02:45:06.857

我同意这里的很多答案。.NET 没有大量独立的 IDE，您使用 Visual Studio 编写代码、管理依赖项等。VS 中的解决方案对于 MSBuild 来说已经足够好了，因此您可以从构建服务器中使用它。

另一方面，Java 发展了许多 IDE，Java 走上了管理 IDE 外部项目的路线。让开发人员可以使用他们选择的 IDE。我最近开始从 C# 到 Java 的交叉训练，我可以告诉你 maven 构建概念非常陌生，但过了一段时间我喜欢它，更重要的是我看到了 repo 概念为我提供了什么。

现在 VS 托管依赖项如何要求您添加项目引用或对 DLL 的引用。这种添加 DLL 引用是有缺陷的。您如何管理版本更改，如何构建来自外部和内部源的第 3 方 dll，以及您希望从自己的团队中包含但不作为项目参考的 dll。我通常基于基于文件的目录结构完成了许多变通方法，但它们都不是优雅的，或者在版本更改时很好。也使分支变得困难，因为这成为您如何构建目录的考虑因素。

现在我已经使用 Java 和公共 mavan 存储库了，超级酷。我已经使用 Python 和 pip install 有效地再次从公共存储库中提取。最后，我用 VS 2015 再次在 C# 中做了一些事情，而与 Nuget 的集成正是缺少的。

现在在企业环境中，公共回购并不总是可以直接访问，因此您需要企业回购。非微软生态系统在这方面再次领先。

基本上总结 Java 是从不使用 IDE 项目维护的更开放源代码环境演变而来的，而 .NET 是从管理项目的 Visual Studio 演变而来的，这些不同的路径意味着 repo 稍后会出现在 Visual Studio 中。

最后，这是我的观察，Java 社区倾向于更多地使用其他人的框架，因为 Java 基础库提供的更少。而 .NET 人则编写了更多自己的代码。Java 社区拥有更大的模式和实践生态系统，而 .NET 再次编写自己的代码或等待微软。这种情况正在发生变化，但再次说明了为什么 .NET 在对 repos 的要求方面落后于 Java。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-04-08T11:24:32.743

我们使用 NAnt 是因为没有真正成熟的替代方案。同时处理多个项目，我们一直在努力拥有多个版本的库以及如何处理它们。Maven 提议确实很有前途，但还不够成熟，无法在 .NET 平台上使用。

我认为这种需求不太明显，因为大多数 .NET 项目都使用 Visual Studio，它会自动建议/强制执行目录结构、依赖项等。这是一个具有误导性的“解决方案”，因为依赖 IDE 来实现这些约定会限制开发团队的灵活性，并将您锁定在特定的解决方案和供应商中。在 Java 世界中显然不是这种情况，因此显然需要类似 Maven 的工具。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-16T18:35:41.960

我们使用 Uppercut。UppercuT 使用 NAnt 来构建，它是非常容易使用的构建框架。

自动化构建就像 (1) 解决方案名称，(2) 源代码控制路径，(3) 大多数项目的公司名称一样简单！

[https://github.com/chucknorris/uppercut/](https://github.com/chucknorris/uppercut)

这里有一些很好的解释：[Uppercut](http://ferventcoder.com/category/uppercut.aspx)

## 更多信息

* * *

UppercuT 是一种传统的自动构建，这意味着您设置一个配置文件，然后您就可以免费获得一堆功能。可以说，最强大的功能是能够在一个地方指定环境设置并将它们应用到任何地方，包括构建源代码时的文档。

可用文档：[https ://github.com/chucknorris/uppercut/wiki](https://github.com/chucknorris/uppercut/wiki)

特征 ：

*   简单的设置
*   简单升级
*   构建过程中每个步骤的自定义扩展点（前、后和替换）[http://uppercut.pbworks.com/CustomizeUsingExtensionPoints](http://uppercut.pbworks.com/CustomizeUsingExtensionPoints)
*   具有与 Team City、CruiseControl.NET 和 Jenkins（原 Hudson）集成的文档[https://github.com/chucknorris/uppercut/tree/master/docs](https://github.com/chucknorris/uppercut/tree/master/docs)
*   适用于带有 Mono 的 Linux
*   基于内部版本号和源代码控制修订版（SVN、TFS、Git、HG）对 DLL 进行版本控制
*   编译活动 - F5 或 Ctrl + Shift + B
*   强大的命名就像真/假一样简单
*   代码测试和分析
    *   测试
        *   单元
        *   MbUnit v2
        *   加里奥
        *   xUnit
    *   无盖
    *   依赖
    *   硝酸盐
    *   Mono 迁移分析器
*   混淆
*   合并
*   环境模板和构建（ConfigBuilder、DocBuilder、SQLBuilder、DeploymentBuilder）[https://github.com/chucknorris/uppercut/blob/master/docs/ConfigBuilder.doc?raw=true](https://github.com/chucknorris/uppercut/blob/master/docs/ConfigBuilder.doc?raw=true)
*   打包输出以准备部署
*   压缩输出

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-13T19:11:47.193

我不喜欢基于 XML 的构建工具。

我们采用 ruby​​ rake 来构建我们的 .net 产品。[Albacore](http://albacorebuild.net/)是一套非常好的用于构建 .net 项目的 rake 任务。

Rake 使创建复杂的构建脚本变得非常容易，并且您正在处理代码而不是大量的尖括号。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-10-28T08:04:03.880

我知道这是一篇旧帖子，但是当我遇到它时，我想分享其他不错的选择。

```
Build Automation with PowerShell and Psake 
```

很多人没有利用 Psake（发音为 sockey），真正酷的是它使用了 msbuild。

虽然这不是 maven 问题的答案（maven 是出于对基于繁琐冗长 ANT 脚本的 java 构建的需求）。

大多数人没有使用任何 CI（持续集成），例如 Jenkins、Hudson、Cruise Control、TeamCity、TFS，也没有使用 powershell。

这个利用 msbuild 的 PSake for Powershell 使事情变得任务驱动并且非常有条理。这是一个链接示例[http://www.shilony.net/2013/06/15/build-automation-with-powershell-and-psake/](http://www.shilony.net/2013/06/15/build-automation-with-powershell-and-psake/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-10-02T10:15:25.043

这看起来很旧，而且仍然是最新的。在过去的几年里，很少尝试使用 NMaven、Nant 等不同的解决方案......每次对于一个新项目，我都必须调查相同的问题并重新审视这些工具。最近使用 .NET Core，情况变得稍微好一些，但是它缺乏 maven 和 gradle 提供的大部分功能和可用性。

所以我目前发现的最可行的方法是`dotnet`结合使用 tool 和`make`. 在下面找到适用于所有内容的内容`Makefile`示例：`dotnet``docker-compose`

```
.ALL: all

all: specs down

clean: down

restore: clean
    dotnet restore

build: restore
    dotnet build

test: build
    dotnet test ./Backend.UnitTests

up:
    docker-compose up --build -V -d

down:
    docker-compose down -v --remove-orphans

specs: test up
    dotnet test ./Backend.Specs 
```

因此，默认情况下运行所有​​内容只需键入`make`并用于特定阶段，`make <phase name>`例如`make test`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-26T08:25:10.777

[Cake](https://cakebuild.net/)是一个很好的替代工具，其中 c# 可以用作 DSL，并且正在由 .NET 基金会积极开发。有关如何使用此工具的信息，请参阅[入门。](https://cakebuild.net/docs/getting-started/setting-up-a-new-project)

# c# - 创建更新列表时触发的事件

> ID：729552
> 
> 赞同：2
> 
> 时间：2009-04-08T11:19:34.003
> 
> 标签：c#, list, observer-pattern

我有一个包含通用 List 对象的静态类（DataFormSubject），如下所示：

```
private static List<DataForm> dataForms = new List<DataForm>(); 
```

依赖这个列表的其他类需要在列表更新时被告知，所以我创建了一个自定义事件，以及可以在添加或删除项目时触发的关联方法，如下所示：

```
 public delegate void DataFormsUpdatedHandler(object sender);
    public static event DataFormsUpdatedHandler DataFormsUpdatedEvent;

    public static void AddDataForm(DataForm df)
    {
        dataForms.Add(df);
        if (DataFormsUpdatedEvent != null)
            DataFormsUpdatedEvent(df);
    }

    public static void RemoveDataForm(DataForm df)
    {
        dataForms.Remove(df);
        if (DataFormsUpdatedEvent != null)
            DataFormsUpdatedEvent(df);
    } 
```

List 可通过属性从静态类获得，如下所示：

```
 public static List<DataForm> DataForms
    {
        get { return dataForms; }
        //set { dataForms = value; }
    } 
```

但是这里的问题是客户端现在可以通过访问属性并直接添加或删除类来*绕过更新事件！*例如

```
 DataFormSubject.DataForms.Add(new DataForm); 
```

我该如何防止这种情况，或者有没有更好的方法来实现我想要的？理想情况下，我想要的是观察者可以订阅的 List 类上的更新事件！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T11:20:44.140

考虑使用`BindingList<T>`or `ObservableCollection<T>`; 这两个都以标准方式做你想做的事。

通过子类化你不能做任何有趣的事情`List<T>`——这些方法不是虚拟的。`Collection<T>`被设计为更具可扩展性，但在这种情况下，您需要的一切都已经提供（by `BindingList<T>`）。

特别是，这提供了：

*   [IBindingList](http://msdn.microsoft.com/en-us/library/system.componentmodel.ibindinglist.aspx)（由许多 UI 绑定组件使用，例如网格）
*   [ListChanged](http://msdn.microsoft.com/en-us/library/ms132742.aspx) - 您的代码可以订阅以获取详细通知

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T11:21:33.000

您想考虑将 an`ObservableCollection`用于此目的。请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms748365.aspx)以开始使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T11:24:31.090

不显示静态类中的 IList，只显示 Enumerable：

```
public static IEnumerable<DataForm> DataForms
{
    get { return dataForms; }
    //set { dataForms = value; }
} 
```

这样，所有更改都必须通过您的班级完成

# registration - 我如何在新域名注册时记录它们？

> ID：729556
> 
> 赞同：1
> 
> 时间：2009-04-08T11:20:53.673
> 
> 标签：registration, dns

[Domain Daily](http://domain-daily.com/)网站提供了新域名的列表。

我有一个客户想在内部实现类似的功能，以半实时跟踪新注册，但不知道如何去做。

本能地，我会考虑某种与 DNS、WHOIS 交互的服务，甚至可能成为官方域名注册商。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T11:26:52.520

唯一可靠的方法是与您感兴趣的 TLD（例如 Verisign (.com)、Nominet (.co.uk) 等）的注册机构达成协议，并获得区域文件的常规副本。他们不倾向于使这种东西广泛可用！但是，像 .aero 这样的顶级域名免费赠送。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T23:57:26.320

这适用于 gTLD (com/net/org/...)，因为它们的区域文件是公开的（至少对于注册商而言）。对于大多数 ccTLD 来说，这根本不起作用，或者至少不是以简单的方式起作用。有一些服务主要从可用域的角度来看，围绕它提供一定程度的自动化，而不是相反。“只是在内部开发一些东西”是行不通的，因为您需要监控 DNS 多年才能获得至少一个有意义的基础来工作的 ccTLD 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T11:23:57.410

在这样做之前检查一下它是否合法。网站所有者可能已在其服务条款中明确禁止做事。

# c# - 如何使用 C++ 静态库编译 C# 应用程序？

> ID：729562
> 
> 赞同：23
> 
> 时间：2009-04-08T11:22:03.653
> 
> 标签：c#, c++, static

我把我的 C++ 动态链接库变成了静态库只是为了获得更多的知识。我的问题是如何使用 .obj 文件通过 C# express/MS Visual Studio 编译这两个项目？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-04-08T11:27:28.713

不，您不能直接从 C# 访问静态库。您*必须*使用 DLL。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-08T12:08:22.157

在 C# 中“使用”静态库的方法是首先创建一个托管 C++ 包装器，该包装器将为托管世界的其余部分提供外观。正如其他人已经评论的那样，C# 仅支持 P/Invoke 的 DLL。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-08T11:46:39.447

“静态库”意味着该库将与您的最终应用程序合并。这个概念在.net 中不存在。.net 仅支持 DLL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T11:28:36.993

没有办法做到这一点。

仅在运行时调用 DLL 函数或从您的库中创建 COM 对象

# javascript - javascript 可以从父页面访问 iframe 元素吗？

> ID：729577
> 
> 赞同：7
> 
> 时间：2009-04-08T11:27:22.800
> 
> 标签：javascript, jquery, html

我在一个页面上有 iframe，iframe 和父页面在不同的域中，父页面上的 javascript 代码可以访问这个 iframe 内的元素吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-08T11:32:13.350

如果页面来自不同的域，它应该不能，浏览器安全沙箱应该阻止这种类型的访问。当两个页面来自同一个域的不同*子*域时，它可能会起作用，但是在浏览器之间（甚至可能是同一浏览器的版本）可能并且会有所不同。

访问子 iframe 可能会起作用，但反过来肯定*不会*起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T11:32:05.160

最简单的方法是通过窗口上的框架对象，如下所示：

```
window.frames[0].document.getElementById('ElementId').style.backgroundColor="#000"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-11T09:20:20.417

如果两个域完全分开，那么这是不可能的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-11T21:38:18.120

使用 jQuery.postMessage 插件[http://benalman.com/code/projects/jquery-postmessage/docs/files/jquery-ba-postmessage-js.html](http://benalman.com/code/projects/jquery-postmessage/docs/files/jquery-ba-postmessage-js.html)

测试的浏览器 Internet Explorer 6-8、Firefox 3、Safari 3-4、Chrome、Opera 9。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-10-11T09:23:04.320

可以使用 Chrome 使用 --disable-web-security 参数来完成... ;)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-06T09:28:39.830

您可以使用 CORS 来实现这一点，特别是更改 'document.domain' 值以匹配父级和子级。但是，请理解这对安全的影响，并且您需要访问父文档和子文档的源代码。

如果您拥有多个子域，这一点尤其重要。我一直使用这种技术，所以我知道它有效，即使使用 SSL。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-04-08T11:29:18.677

是的，`document.frames`您可以通过数组访问 iframe。

# python - 获取导入模块的文件路径

> ID：729583
> 
> 赞同：60
> 
> 时间：2009-04-08T11:30:21.293
> 
> 标签：python

如何获取在 python 中导入的模块的文件路径。我正在使用 Linux（如果重要的话）。

例如：如果我在我的主目录中并导入一个模块，它应该返回我的主目录的完整路径。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-04-08T11:38:35.160

模块和包有一个`__file__`属性，该属性具有其路径信息。如果模块是相对于当前工作目录导入的，您可能希望获取其绝对路径。

```
import os.path
import my_module

print(os.path.abspath(my_module.__file__)) 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-08T11:40:21.753

我一直在使用这个：

```
import inspect
import os
class DummyClass: pass
print os.path.dirname(os.path.abspath(inspect.getsourcefile(DummyClass)) 
```

（编辑：这是一个“我在哪里”函数——它返回包含当前模块的目录。我不太确定这是否是你想要的）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-08T11:37:31.793

这将为您提供模块所在的目录：

```
import foo
os.path.dirname(foo.__file__) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-12-07T06:25:47.010

我可能会迟到，`AttributeError`使用`__file__`属性查找路径时，某些模块会抛出。在这种情况下，可以使用`__path__`来获取模块的路径。

```
>>> import some_module
>>> somemodule.__path__
['/usr/lib64/python2.7/site-packages/somemodule'] 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-07-30T10:36:07.350

查找已加载模块的加载路径：

```
>>> import sys
>>> sys.modules['os']
<module 'os' from 'c:\Python26\lib\os.pyc'> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-04-18T08:35:18.120

我一直在使用这种方法，它适用于非内置和内置模块：

```
def showModulePath(module):
        if (hasattr(module, '__name__') is False):
            print 'Error: ' + str(module) + ' is not a module object.'
            return None
        moduleName = module.__name__
        modulePath = None
        if imp.is_builtin(moduleName):
            modulePath = sys.modules[moduleName];
        else:
            modulePath = inspect.getsourcefile(module)
            modulePath = '<module \'' + moduleName + '\' from \'' + modulePath + 'c\'>'
        print modulePath 
        return modulePath 
```

例子：

```
Utils.showModulePath(os)
Utils.showModulePath(cPickle) 
```

结果：

```
<module 'os' from 'C:\SciSoft\WinPython-64bit-2.7.10.3\python-2.7.10.amd64\lib\os.pyc'>
<module 'cPickle' (built-in)> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-26T05:57:44.080

尝试：

> 帮助（'xxx'）

例如

```
>>> help(semanage)
Help on module semanage:

NAME
    semanage

FILE
    /usr/lib64/python2.7/site-packages/semanage.py 
```

# c# - 从 Windows 窗体应用程序在另一个线程中打开 WPF 窗口

> ID：729584
> 
> 赞同：8
> 
> 时间：2009-04-08T11:30:29.033
> 
> 标签：c#, wpf, winforms, multithreading

好的，我应该首先说我不确定这一定是处理这个问题的正确方法，但是......

基本上，我在 WPF 中创建了一个窗口，用于在我的应用程序中显示通知（有点像 Outlook 新邮件通知）。我想尝试在它自己的线程中显示这个窗口（它将来可能会做一些工作）。

我已经使用 WPF 创建了 Window，因为它在处理 AlwaysOnTop 和淡入淡出之类的事情上要好一些。

显示通知的应用程序是 3.5 Windows 窗体应用程序。我已经看到与此 SOF 类似的示例[：C# winforms startup (Splash) form not hidden](https://stackoverflow.com/questions/510765/510786#510786) for 在不同线程中显示表单但是我无法使用 WPF 窗口启动新的消息循环。

我试过在一个新线程中调用 Notification.Show() 但是窗口永远不会显示。

1.  是否可以在它自己的线程中显示这个 WPF？

2.  为什么我看到一些资源说您不应该在单独的线程中显示任何 UI？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-08T11:39:39.137

[WPF 线程模型](https://msdn.microsoft.com/library/ms741870(v=vs.100).aspx)对此有详细说明。寻找“多窗口，多线程”。

基本上，您启动一​​个新线程，该线程创建相关窗口，然后调用

```
System.Windows.Threading.Dispatcher.Run(); 
```

为了在新线程上为该窗口运行调度程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T11:45:40.760

> 1.  是否可以在它自己的线程中显示这个 WPF？

绝对地。只需创建一个新的 STA 线程并从中创建并显示您的线程`Window`。我已经将这种技术用于启动屏幕，因为主（UI）线程真的被束缚在做其他事情。由于我们使用的是第 3 方框架，在 UI 线程上完成了多少工作完全超出了我的控制。

> 2.  为什么我看到一些资源说您不应该在单独的线程中显示任何 UI？

可能是因为涉及的额外复杂性。如果您`Window`的其中一个想要将数据传递给另一个，您需要记住它们是在单独的线程上执行的。因此，每个都应该使用它的 Dispatcher 来编组对正确线程的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T11:35:18.710

您应该使用主 UI 线程显示通知，如果该窗口要执行任何工作，请在后台线程中运行该工作。您不应该使用多个线程来访问或创建 UI 对象，即使您不在线程之间共享这些对象也是如此。

# java - 带有 BugZilla 的 Eclipse MyLyn：是否需要修改/配置 BugZilla 安装？

> ID：729592
> 
> 赞同：7
> 
> 时间：2009-04-08T11:32:49.620
> 
> 标签：java, eclipse, bugzilla, mylyn

我对 MyLyn 感兴趣。我正在使用 Eclipse Ganymede，并且可以访问我正在处理的项目的 BugZilla 安装。

我想知道是否必须以任何方式更改/配置 BugZilla 安装，或者我是否能够“开箱即用”地使用 MyLyn？

我是否必须设置某种特殊类型的 MyLyn 服务器，或者我可以仅将它安装在客户端上吗？

如果需要在服务器上配置 BugZilla 或特殊的 MyLyn 服务。这是一个困难的设置，是否需要很长时间才能完成？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-09-22T18:33:31.697

**摘要：** Mylyn 将连接到 Bugzilla 3.0，并且不需要对 Bugzilla 进行**任何**更改。您只需要 Mylyn（一个客户端应用程序），它可以作为 Eclipse 插件使用。Mylyn 的 Bugzilla 连接器是最稳定和最受欢迎的 Mylyn 连接器之一。

**详细信息：** Mylyn 是 Eclipse 生态系统的领先 ALM 解决方案。它最近已成为 Eclipse 上的顶级项目。从开发人员的角度来看，其主要目的是：

*   将来自不同服务器（Bugzilla、Trac、Mantis 等）的任务带入 Eclipse [（认证连接器列表）](http://tasktop.com/connectors/) [（完整连接器列表）](http://wiki.eclipse.org/index.php/Mylyn_Extensions)
*   提供统一的任务列表来管理这些任务[（视频）](http://tasktop.com/videos/1.6/setup/tasklist/)
*   仅将用户界面集中在与当前任务相关的文件上[（视频）](http://tasktop.com/videos/1.6/setup/focus/)

虽然它提供了许多其他出色的功能，但这三点是使用 Mylyn（或 Tasktop，即商业 Mylyn+）的最常被引用的原因之一。

要下载 Mylyn，您可以下载包含 Mylyn 的 Eclipse（例如，[用于 Java EE 开发人员的 Eclipse IDE](http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/heliosr)），或者您可以使用[Mylyn 下载页面](http://www.eclipse.org/mylyn/downloads/)上提供的更新站点将其安装到现有的 Eclipse 中。更新站点的格式应为：http: [//download.eclipse.org/tools/mylyn/update/e3.4](http://download.eclipse.org/tools/mylyn/update/e3.4)。或者，您可以下载商业产品[Tasktop Pro](http://tasktop.com/support/download/1.)。

一旦您下载了 Mylyn，就很容易连接到 Bugzilla。您需要：

1.  打开任务存储库视图。
2.  单击“添加任务存储库”。
3.  选择“Bugzilla”并按“下一步”。
4.  输入您的存储库设置，例如其 URL 和您的凭据。
5.  打开任务列表视图。
6.  点击“新建查询”。
7.  使用该对话框创建一个查询，该查询从 Bugzilla 下载您的任务。

如果您想了解有关如何设置 Mylyn 以连接到 Bugzilla 的更多详细信息，请尝试这些关于[连接到存储库](http://tasktop.com/blog/mylyn/how-to-connect-task-repository)和[设置任务列表](http://tasktop.com/blog/mylyn/track-tasks-with-queries-not-email)的教程。

大卫·谢泼德，Tasktop 技术
[http://www.twitter.com/davidcshepherd](http://www.twitter.com/davidcshepherd)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-08T11:38:25.940

它应该开箱即用，只需尝试一下并指定您的任务来自的 BugZilla 服务器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T07:36:05.937

我已经安装了它，我不必在 bugzilla 中触摸任何东西，它也是 bugzilla 的旧版本（2.22.4）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T17:05:20.103

Bugzilla 不需要配置。您只需将 Mylyn 指向一个 Bugzilla 存储库，Mylyn Bugzilla 连接器就会为您完成工作。

此外，没有 Mylyn 服务器。它只是在客户端上运行。您可以通过指向相同的任务/问题/错误存储库与其他人协作，也可以使用 Mylyn 在本地创建自己的个人任务列表。（然后您可以通过将其推送到 Bugzilla 与他人分享）

我不记得配置中有任何 Mylyn 特定的困难。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-10-08T15:12:30.100

我为我的项目设置了这个，而且效果很好。

时不时会出现以下问题：

1.  Bugzilla 错误不会正常报告。例如，如果由于依赖错误打开而无法关闭错误，Bugzilla 将不允许更改，但 Mylyn 只会报告“服务器错误”。

2.  附加任务上下文并不总是按预期工作。我在寻找答案时遇到了这个问题。我发现的问题是：

    一种。如果上下文已附加，则附加更新的上下文是“困难的”。我不知道这是否是因为我必须首先将现有上下文标记为“过时”——我已经尝试过了。

    湾。附加上下文很慢。

祝你好运！

# mysql - 将 XML 文件数据加载到 MYSql 5.1 版本

> ID：729593
> 
> 赞同：0
> 
> 时间：2009-04-08T11:33:44.127
> 
> 标签：mysql, xml

大家好！我发现你们都很有帮助。

我正在使用 MySql 5.1 和 Java。我有一个很大的 XML 文件，需要将 XML 文件的数据填充到 MySql 表中。

对于 MySQL 5.1 有一个过程（[在 MySQL 5.1 和 6.0 中使用 XML](http://dev.mysql.com/tech-resources/articles/xml-in-mysql5.1-6.0.html)），但是当我在我的数据库中尝试它时，它没有显示错误，但在同一方面它没有效果。有谁能够帮我？

如果你给我一个简单的例子会更好。

该`LOAD XML`语句在 MySQL 6.0 之前不可用。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T11:59:51.427

您可能需要编写一个快速脚本来解析 XML 文件并生成 sql 查询？

唯一能想到尝试的就是PHPMyAdmin，我觉得可以导入XML，但是会有文件大小限制，你说大XML！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T12:29:42.557

另一个很好的方法是使用[DBUnit](http://dbunit.sourceforge.net/howto.html)，但首先您必须使用 XSL 样式表将 XML 数据转换为：

一个。匹配您的数据库模式 b。DBUnit 可以理解的东西

还要确保您使用 C++ 编程的 XSL 转换器进行转换，因为它允许您处理比基于 Java 的数据集更大的数据集，而不会增加 Java 堆栈的大小（也更快）。

如果您需要有关如何使用 DBUnit 的示例，请查看[Matt Raibles](http://raibledesigns.com/) [Appfuse 项目](http://raibledesigns.com/rd/tags/appfuse)。

# sql - 如何过滤大于数值的nvarchar？

> ID：729598
> 
> 赞同：4
> 
> 时间：2009-04-08T11:36:39.487
> 
> 标签：sql, sql-server-2005, tsql, query-optimization

我有一个带有 BigMacs nvarchar(255) 列的 MS SQL 表 McTable。我想获得 BigMacs 值大于 5 的行。

我要做的是：

```
select * from
  (
    select 
      BigMacs BigMacsS, 
      CAST(BigMacs as Binary) BigMacsB, 
      CAST(BigMacs as int) BigMacsL
    from 
      McTable
    where 
      BigMacs Like '%[0-9]%'
  ) table
where 
  Cast(table.BigMacsL as int) > 5 
```

结果我得到一个错误：

> 将 nvarchar 值“***”转换为数据类型 int 时，状态 1，第 67 行转换失败。

但是当我删除最后一个过滤器`where Cast(table.BigMacsL as int) > 5`时，它可以工作，我得到了这个结果：

```
6 0x36000000000000000000000000000000000000000000000000000000000000 6
23 0x3200330000000000000000000000000000000000000000000000000000000 23
22 0x320032000000000000000000000000000000000000000000000000000000 22
24 0x3200340000000000000000000000000000000000000000000000000000000 24
25 0x3200350000000000000000000000000000000000000000000000000000000 25
3 0x33000000000000000000000000000000000000000000000000000000000000 3
17 0x3100370000000000000000000000000000000000000000000000000000000 17
17 0x3100370000000000000000000000000000000000000000000000000000000 17
19 0x310039000000000000000000000000000000000000000000000000000000 19
20 0x32003000000000000000000000000000000000000000000000000000000000 20
659 0x360035003900000000000000000000000000000000000000000000000000 659
1 0x31000000000000000000000000000000000000000000000000000000000000 1
43 0x3400330000000000000000000000000000000000000000000000000000000 43
44 0x3400340000000000000000000000000000000000000000000000000000000 44
45 0x3400350000000000000000000000000000000000000000000000000000000 45
46 0x3400360000000000000000000000000000000000000000000000000000000 46
47 0x340037000000000000000000000000000000000000000000000000000000 47
44 0x3400340000000000000000000000000000000000000000000000000000000 44
44 0x3400340000000000000000000000000000000000000000000000000000000 44
47 0x340037000000000000000000000000000000000000000000000000000000 47
43 0x3400330000000000000000000000000000000000000000000000000000000 43
50 0x3500300000000000000000000000000000000000000000000000000000000 50
44 0x3400340000000000000000000000000000000000000000000000000000000 44

```

当我将第一个查询“select * from”更改为“select top 18 * from”时，我也没有收到错误！

我不知道是什么问题以及如何使它工作！请你帮助我好吗？

再一次：我在这里尝试完成的是让这些具有 BigMacs 值大于 5 的 McTable 行。

**更新**

**重现此错误的步骤：**

我已经准备好查询，因此您可以轻松地在数据库上收到此错误：

创建数据库TestDB，创建表：

```
USE [TestDB]
GO
/****** Object:  Table [dbo].[TestTable]    Script Date: 04/08/2009 16:27:40 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TestTable](
    [ID] [int] IDENTITY(1,1) NOT NULL,
    [MyVal] [nvarchar](255) COLLATE Polish_CI_AS NOT NULL,
 CONSTRAINT [PK_TestTable] PRIMARY KEY CLUSTERED 
(
    [ID] ASC
)WITH (PAD_INDEX  = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY] 
```

插入值：

```
delete from TestDB.dbo.TestTable
insert into TestDB.dbo.TestTable (MyVal) values ('fd')
insert into TestDB.dbo.TestTable (MyVal) values ('54543534')
insert into TestDB.dbo.TestTable (MyVal) values ('fat3tv3gv5')
insert into TestDB.dbo.TestTable (MyVal) values ('fdf4v43 4v434v')
insert into TestDB.dbo.TestTable (MyVal) values (' g dfg dfg df')
insert into TestDB.dbo.TestTable (MyVal) values ('f sd 4t4gsdf')
insert into TestDB.dbo.TestTable (MyVal) values ('f df 4 trwefg')
insert into TestDB.dbo.TestTable (MyVal) values ('f sd f4  fgsfg sd')
insert into TestDB.dbo.TestTable (MyVal) values ('54534534')
insert into TestDB.dbo.TestTable (MyVal) values ('454') 
```

这个查询：

```
 select 
        CAST(MyVal as int) MyValInt 
    from 
        dbo.TestTable 
    where 
        IsNumeric(MyVal) = 1 
```

产生有效数字，如下所示：

> 54543534
> 
> 54534534
> 
> 454

当您尝试使用此查询获取过滤值时：

```
select 
    * 
from
    (
        select 
            CAST(MyVal as int) MyValInt 
        from 
            dbo.TestTable 
        where 
            IsNumeric(MyVal) = 1
    ) tabela
where 
    tabela.MyValInt > 6 
```

你应该得到这个不应该发生的错误：

消息 245，级别 16，状态 1，行 1 将 nvarchar 值“fd”转换为数据类型 int 时转换失败。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-08T15:36:45.993

修改后的脚本的新答案。正在发生的事情是 SQL Server 查询优化器正在优化您的子查询。它对测试表执行单次扫描，并将内部和外部 WHERE 子句合并为一个。这就是为什么你仍然得到错误。要查看这一点，请查看查询的估计执行计划，并将鼠标悬停在聚集索引扫描图标上以查看实际执行的内容。您将看到以下谓词应用于扫描：

```
CONVERT(int,[testdb].[dbo].[TestTable].[MyVal],0)>(6)
AND isnumeric(CONVERT_IMPLICIT(varchar(510),
    [testdb].[dbo].[TestTable].[MyVal],0))=(1) 
```

因此，无论您的查询结构如何，它都会尝试对表中的每一行进行 CAST/CONVERT ......

为避免这种情况，请使用无法优化的表变量或临时表：

```
DECLARE @integers table (
    MyValInt int
)

INSERT
INTO    @integers
SELECT  CAST(MyVal AS int)
FROM    dbo.TestTable 
WHERE   ISNUMERIC(MyVal) = 1

SELECT  *
FROM    @integers
WHERE   MyValInt > 6 
```

您实际想要返回的结果集会有所不同，因此我建议将主键与 int 值一起存储在 table 变量中，然后像这样将最终查询作为连接进行：

```
DECLARE @integers table (
    ID int,
    MyValInt int
)

INSERT
INTO    @integers
SELECT  ID, CAST(MyVal AS int)
FROM    dbo.TestTable 
WHERE   ISNUMERIC(MyVal) = 1

SELECT  b.*
FROM    @integers t
        INNER JOIN
                TestTable b
                ON b.ID = t.ID
WHERE   t.MyValInt > 6 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T12:04:41.383

> 将 nvarchar 值“***”转换为数据类型 int 时，状态 1，第 67 行转换失败。

您正在获取此值，因为其中的某些值`BigMacs.BigMac`包含非数字值。在你的情况下“***”。

> 当我将第一个查询“select * from”更改为“select top 18 * from”时，我也没有收到错误！

这是因为*至少*首先返回的 18 行具有数值`BigMacs.BigMac`。

创建一个名为[isReallyNumeric()](http://classicasp.aspfaq.com/general/what-is-wrong-with-isnumeric.html)的新用户定义方法，该方法处理真正的数字或非数字。

[使用isReallyNumeric()](http://classicasp.aspfaq.com/general/what-is-wrong-with-isnumeric.html)函数仅过滤掉数字 BigMac
我还优化了查询，以便`BigMacs.BigMac`使用 CTE（公用表表达式）将查询转换为整数。

```
with NumericBigMacs as (
    select 
      BigMacs as BigMacsS, 
      CAST(BigMacs as Binary) as BigMacsB, 
      CAST(BigMacs as int) as BigMacsL
    from 
      McTable
    where 
      -- Filter only numeric values to compare.
      -- BigMacs Like '%[0-9]%'
      dbo.isReallyNumeric(BigMacs) = 1
)
select  *
from    NumericBigMacs NBM
where   BigMacsL > 5 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T11:57:34.303

问题是，如果它确实包含一个 int，您只能将一个值 CAST 到一个 int。显然你的前 18 行是这样。但是，如果您包含更多行，它会到达无法将值强制转换为 int 的行，并且您会收到您描述的错误。这个怎么样：

```
select 
      BigMacs BigMacsS, 
      CAST(BigMacs as Binary) BigMacsB 
    from 
      McTable
    where 
      BigMacs Like '%[6-9]%'
    or
      BigMacs LIKE '%[1-9][0-5]%' 
```

这将在该列的文本中查找包含大于 5 的数字的所有行（假设不包含小数或负数）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T13:37:56.183

将字符数据和数字存储在同一列中时，OK isumeric 并不总是有效。它也不限于可以转换为整数的项目。有关说明，请参阅此链接： [http ://www.tek-tips.com/faqs.cfm?fid=6423](http://www.tek-tips.com/faqs.cfm?fid=6423)

我的第一个问题是，为什么要将要用作数字和字符的东西存储在同一列中？这是一个严重的设计缺陷，应尽可能予以纠正。

我相信该链接可能会帮助您弄清楚如果您无法更改结构该怎么办。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T12:00:21.037

这似乎给出了预期的结果

### 编辑

*并*包括你的 where 子句

```
DECLARE @McTable TABLE (BigMacs VARCHAR(20))

INSERT INTO @McTable VALUES ('1')
INSERT INTO @McTable VALUES ('1dqsf')
INSERT INTO @McTable VALUES ('qsfsq1')
INSERT INTO @McTable VALUES ('10')

select   
  BigMacs,
  cast(BigMacs as Binary) as BigMacsB, 
  cast(BigMacs as int) as BigMacsL
from @McTable
where IsNumeric(BigMacs) = 1
      and cast(BigMacs as int) > 5 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T12:07:17.727

这就是正在发生的事情：谓词`BigMacs Like '%[0-9]%'`并不完全符合您的想法。它选择字符串中某处至少有一位数字的行。

这不是你想要的。你想要*只有*数字的字符串。不幸的是，LIKE 通配符并没有给我们一个简单的方法来要求它。

我们可能会为您的问题提供足够的帮助。如果我们要求

```
not (BigMacs like "%[A-Za-z!@#$%^&*()=;:'""]%") 
```

我们将过滤掉除数字之外的大多数*行*。“大多数”，因为我们的 like 通配符不包含所有可能的非数字字符。反过来，这应该允许演员工作。

所以：

```
select * from
  (
    select 
      BigMacs BigMacsS, 
      CAST(BigMacs as Binary) BigMacsB, 
      CAST(BigMacs as int) BigMacsL
    from 
      McTable
    where 
      not (BigMacs like "%[A-Za-z!@#$%^&*()=;:'""]%") 
  ) table
where 
  Cast(table.BigMacsL as int) > 5 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-08T12:10:00.590

我认为使用[ISNUMERIC()](http://msdn.microsoft.com/en-us/library/ms186272.aspx)函数也有帮助。

例子：

```
SELECT * FROM
(
    SELECT CAST(CASE WHEN ISNUMERIC(myval)=1 THEN myval ELSE 0 END AS INT) AS mi
    FROM dbo.TestTable 
) AS t2
WHERE mi>5 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T16:01:10.113

我认为 David M. 已经把它钉在了头上，但对于那些要求重现问题的脚本的人来说：

```
CREATE TABLE dbo.Test_Int_Conversion
(
    my_id   INT IDENTITY    NOT NULL,
    my_str  VARCHAR(20)     NOT NULL,
    CONSTRAINT PK_Test_Int_Conversion PRIMARY KEY CLUSTERED (my_id)
)
GO

INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('1')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('2')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('3')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('4')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('5')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('6')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('7')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('8')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('9')
INSERT INTO dbo.Test_Int_Conversion (my_str) VALUES ('*')
GO

SELECT * FROM (
SELECT
    my_id,
    CAST(my_str AS INT) my_strI
FROM
    dbo.Test_Int_Conversion
WHERE
    my_str LIKE '%[0-9]%'
) SQ
WHERE
    CAST(SQ.my_strI AS INT) > 5 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-08T16:24:43.520

该代码应该可以工作：

```
select
    tabela.*
from
    (
        select
                CAST(MyVal as int) MyValInt
        from
                dbo.TestTable
        where
                IsNumeric(MyVal) = 1
    ) tabela
    left join (select 1 a )a on tabela.MyValInt > 6 
```

我认为原始查询失败的原因可能与SQL评估查询的顺序有关。

# c# - 自定义处理程序在 Asp.NET 开发服务器上工作但不在 IIS 5.1 上？

> ID：729599
> 
> 赞同：0
> 
> 时间：2009-04-08T11:36:55.287
> 
> 标签：c#, ajax, httphandler, iis-5

## 大家好，我遇到了一个愚蠢的问题。

我的自定义处理程序在 Asp.NET 开发服务器上 100% 工作，但是当我将站点发布到 IIS 5.1 时，每当我尝试运行 Comment/Find（通过 AJAX 调用找到用户）（我知道我的处理程序 sux 的命名！ !! :)

## 我收到此错误：

页面无法显示 由于页面地址不正确，无法显示您要查找的页面。

请尝试以下方法：

```
* If you typed the page address in the Address bar, check that it is entered correctly.
* Open the home page and then look for links to the information you want. 
```

HTTP 405 - 资源不允许 Internet 信息服务

技术信息（支持人员）

```
* More information:
  Microsoft Support 
```

## 我的 AJAX 调用代码是：

```
 function findUser(skip, take) {

        http.open("post", 'Comment/FindUser', true);
        //make a connection to the server ... specifying that you intend to make a GET request
        //to the server. Specifiy the page name and the URL parameters to send
        http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        http.setRequestHeader('Criteria', document.getElementById('SearchCriteria').value);
        http.setRequestHeader("Skip", skip);
        http.setRequestHeader("Take", take);
        http.setRequestHeader("Connection", "close");

        //display loading gif
        document.getElementById('ctl00_ContentPlaceHolder1_DivUsers').innerHTML = 'Loading, Please Wait...<br /><img src="Images/loading.gif" /><br /><br />';

        //assign a handler for the response
        http.onreadystatechange = function() { findUserAction(); };

        //actually send the request to the server
        http.send(null);

} 
```

请问谁能帮帮我？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T11:44:17.783

在 IIS 上，并非所有调用都将由 asp.net 处理程序处理（与开发服务器 cassini 不同），除非调用以 .aspx、.ashx 等结尾。.NET isapi dll 不会处理调用。

线索在

HTTP 405 - 资源不允许 Internet 信息服务

如果文件系统中没有相应的 .ashx 文件，您还需要在 web.config 中映射处理程序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T11:45:27.920

确保您已允许 IIS 服务器上的扩展。开发服务器会自动为您执行此操作。

如果您打开网站的属性，然后转到主目录选项卡并单击配置按钮。

在那里尝试添加您用于处理程序指向的扩展名。将可执行文件设置为 aspnet_isapi.dll（查看标准的 .aspx 扩展名以找到它在您的计算机上的位置）并取消选中“检查文件是否存在”。

我被这件事烧了几次，这解决了问题

科林·G

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T08:38:47.093

问题是当我在开发人员上调用处理程序时。服务器我称它为like this

`http.open("post", 'Comment/Rate', true);`

因为在我的 web.config 中，我指示它捕获所有“评论/”网址并调用 CommentHandler.ashx 来处理它。

```
 <add verb="*" path="Comment/*" type="CoffeeMashup2.CommentHandler"/> 
```

但是由于某些原因在 IIS 中它不起作用，所以我将上面的调用更改为

```
http.open("post", 'CommentHandler.ashx/Rate', true); 
```

并且它的工作100％

非常感谢你们的帮助

# database - 使用 Cocoa 创建与远程数据库的连接

> ID：729601
> 
> 赞同：1
> 
> 时间：2009-04-08T11:37:04.070
> 
> 标签：database, ms-access

如何在 Mac OS X 上使用 Cocoa 和 Objective-C 从 Windows 平台上的远程服务器访问 MS Access 数据库？服务器位于远程位置，只能通过互联网访问。

如何通过 Internet 与服务器建立连接？进行此类申请的所有程序是什么？如果我需要使用 ODBC，实现连接所需的步骤是什么？我没有找到有关这些主题的任何有用文档？有什么框架可以使用吗？

提前致谢

马哈布布

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T12:19:14.390

好吧，因为它是一个 MS Access 文件，你需要在远程机器上设置一个文件服务器。我猜你已经这样做了。

现在，由于您已经在您的 Mac 上安装了 ODBC（我假设您有 Mac OS X 10.2 或更高版本），您需要一个驱动程序来打开 MS Access 文件。[你可以在这里](http://www.actualtechnologies.com/product_access.php)找到（买，真的）一个。也请查看此[常见问题解答](http://support.openlinksw.com/support/mac-faq.html)。它有一些关于 Mac OS 上的 ODBC 的有趣内容。

现在您已准备好编码。您可以直接在 Objective-C 中使用[ODBC API](http://msdn.microsoft.com/en-us/library/ms714562(VS.85).aspx)（毕竟，它是**C ！），或者您可以尝试一些像**[这样](http://download.cnet.com/ODBC-Cocoa-Class-Samples/3000-2247_4-64455.html)的纯 Objective-C 包装器。我肯定会建议坚持使用本机 ODBC API 以避免与开源或免费软件上的错误相关的头痛，您可能会在 Internet 上找到不受支持的包装器。

# windows-services - Powerpoint Interop 在 Windows 服务中失败，但在 Windows 窗体应用程序中工作正常

> ID：729609
> 
> 赞同：4
> 
> 时间：2009-04-08T11:40:53.967
> 
> 标签：windows-services, interop, powerpoint

我编写了一个应用程序来监视文件夹，每当将 PowerPoint 文档放入其中时，它都会遍历其中的幻灯片并生成每张幻灯片的 png 图像。这在 Windows 窗体应用程序中运行良好，但我在 Windows 服务中放置了完全相同的代码，使用了相同的测试文件，但无法打开它并出现以下错误：

错误：PowerPoint 无法打开文件。在 Microsoft.Office.Interop.PowerPoint.Presentations.Open（字符串文件名，MsoTriState 只读，MsoTriState 无标题，MsoTriState WithWindow）-2147467259 Com 错误

我已将服务设置为使用我自己的用户帐户（具有管理员权限）运行，因此我认为这将排除权限问题，但我想不出其他任何尝试。

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-07-15T16:20:20.240

一个名叫“Gary McGill”的人发布了一个对我来说效果很好的解决方案（在一个非常相似的问题上）：

[通过 Server 2008 上的 Windows 服务实现 Office 自动化](https://stackoverflow.com/questions/1006923/automating-office-via-windows-service-on-server-2008/1680214#1680214)

像魅力一样工作（我什至不必检查“登录”选项卡上的“允许服务与桌面交互”复选框）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T17:35:37.517

如果没有更多信息，就无法判断问题所在。它可以是任何数量的东西。如果操作系统是 XP 或更早版本，则在服务运行时不会加载用户的配置文件，因此 PP 可能无法访问它需要的某些信息。PP 可能正在尝试一些复杂的操作，假设它处于交互式会话中。由于缺少用户配置文件，PP 使用的 COM 组件可能无法初始化。真正的错误甚至可能不是安全问题，开发人员使用 ERROR_ACCESS_DENIED 或 ERROR_OUT_OF_MEMORY 来捕获所有意外错误的情况并不少见。

但真正的问题是 PowerPoint 在很大程度上是一个用户登陆应用程序——它不应该在服务中使用。将服务设置为与桌面交互是一个糟糕的解决方案。即使它确实有效，它也只会掩盖更深层次的问题，并使其作为服务运行变得毫无意义。有许多实用程序和组件可用于将 PowerPoint 幻灯片转换为图像文件。在 Google 上进行快速搜索会返回许多看起来更适合在服务中使用的可能性，而且其中大多数都很便宜。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-25T10:20:53.700

*   进入组件服务>计算机>我的电脑>DCOM 配置。
*   转到“Microsoft PowerPoint 幻灯片”DCOM 并选择属性。
*   转到身份选项卡并将用户从被继承更改为具有网络服务/访问权限的特定用户。

PowerPoint 互操作不应该尝试打开 UI，但这也可能是问题所在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T12:01:34.310

尝试将服务设置为与桌面交互。

# wcf - 使用 netMSMQ 绑定的有序交付

> ID：729612
> 
> 赞同：5
> 
> 时间：2009-04-08T11:42:03.340
> 
> 标签：wcf, msmq, messaging, ordered-delivery

使用 WCF netMSMQbinding 时是否可以保证有序交付？

我们在同一个队列中放置一个插入命令，然后是多个更新命令，有时其中一个更新会超过插入。

添加大量日志后，很明显它们以正确的顺序添加到队列中，并以不同的顺序进行处理。

我已经设法谷歌了几篇文章，指出这种行为是预期的，但似乎必须可以将其配置为以某种方式订购。

我们的队列是事务性的，所以我不认为在目的地添加序列号和重新排序会起作用，因为这会失去事务性

如果我添加属性`[DeliveryRequirements(RequireOrderedDelivery=true, QueuedDeliveryRequirements=QueuedDeliveryRequirementsMode.Require)]`，我会收到以下错误：

> 合同“IService”上的 DeliveryRequirementsAttribute 指定了 NotAllowed 的 QueuedDeliveryRequirements 值。但是，此合同的配置绑定指定它确实支持排队交付。此合同不得使用排队绑定。

我不知道为什么会出现此错误，因为一切“似乎”都设置正确。我还没有找到任何确认 MSMQ 允许此设置，因为它似乎是 WS-RM 设置，并且 AFAIK netMSMQBinding 不支持 WS-RM。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T13:17:36.590

MSMQ 不支持有序交付，因此您不能。

看一下 System.ServiceModel.Channels.MsmqBindingElementBase+BindingDeliveryCapabilitiesHelper ，它是指定 MSMQ 绑定功能的类，以及它如何实现该属性：

```
bool IBindingDeliveryCapabilities.AssuresOrderedDelivery
{
    get
    {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-17T11:53:11.427

[来自 Simon Gittins 的这篇文章](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/d5e62c68-08fa-492c-ba05-182ec313a54b)似乎表明可以订购交货：

> 事实证明，有一个未记录的功能可以处理这种情况：
> 
> *   将批处理大小为 ONE 的 TransactedBatchingBehavior 应用到服务端点。
> *   ReleaseServiceInstanceOnTransactionComplete 必须在服务实现上设置为 true。
> 
> 一旦完成这两件事，我的测试程序就不再产生乱序消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T16:28:33.267

看起来您可以对消息进行分组，因此您可以在合同中指定顺序。查看[这篇关于消息分组的 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms731796.aspx)。

# css - 如何在 css 中使用命名空间？

> ID：729615
> 
> 赞同：5
> 
> 时间：2009-04-08T11:44:07.517
> 
> 标签：css

我的 HTML 页面包含一个 id 名为“main”的 div，并且我在我的 HTML 页面中包含另一个 HTML 页面，其中包含一个具有相同 id（“main”）的 div。我需要在我的 HTML 页面的 id("main") 中附加一个命名空间。

我包含来自另一个站点的页眉、页脚，并将我的站点中的内容包含到该 HTML 页面。如果其他站点使用与我的站点相同的 ID，则冲突正在发生。

在这个 HTML 页面中包含两个 css 文件。如果它们在这里都包含具有不同样式的相同类，则存在问题。

我需要将我的 css 文件应用于我的代码，并将另一个文件应用于剩余代码。任何机构都可以解决我的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T12:14:01.627

两件事情：

*   听起来你需要一个类，而不是一个 ID。
*   如果您希望在样式之间应用每页差异，请使用嵌入式样式表。

在这种情况下使用相同的ID肯定是一个[破窗户](http://blogs.msdn.com/alanpa/archive/2005/03/12/394662.aspx)的情况。如果您对这种情况有任何控制权，则应该更新 HTML，而不是在以后引起更多混乱。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T11:55:19.767

是否有任何关于 div 的包含元素可以将它们彼此区分开来。如果有，您可以在您的 css 声明前加上包含元素，并为两个 div 指定唯一样式。

例如：

```
#main
{Style}
.container #main
{Another style} 
```

正如人们所提到的，如果您可以控制 HTML，明智的做法是为两个元素指定一个不同的类或为每个元素指定一个唯一 ID。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T12:15:29.643

具有重复 ID 的页面无效。即使您设法通过将 id 与类组合来定位单独的元素，也不能保证适用于所有浏览器。

要制作一个有效的页面，元素需要有一个唯一的 id。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T12:27:05.870

简而言之，CSS 中没有命名空间之类的东西。使用其他答案建议的解决方法之一:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T12:51:42.533

到目前为止，我同意每个人的观点，因为没有原生 CSS 命名空间功能，并且如果您可以控制（或希望/容量）编辑 HTML，那么这是最好的方法。

使该过程自动化的一种方法是编写一个脚本（PERL、PHP、.NET 等）来解析您拉入​​的 HTML，并用修改后的版本替换任何现有的 ID 或类。

即`<tag id="theID" class="theClass anotherClass">` 变成 `<tag id="NAMESPACEtheID" class="NAMESPACEtheClass NAMESPACEanotherClass">`

您可以使用一些创造性的正则表达式来完成此操作，但如果还有需要修改的 Javascript 代码会变得更加棘手。

就性能而言，这将是一个很大的打击，具体取决于文件的大小，您可能希望缓存结果或重写原始文件。

如果你决定走那条路，请告诉我，这个想法实际上听起来有点有趣，并且可以在我的工具箱中占有一席之地！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T11:52:52.737

在第二个 div 的 ID 中使用第二个 div 的名称。例如，如果调用第二页`signup.html`，请使用`main_signup`

# oracle - 甲骨文数据卫士

> ID：729616
> 
> 赞同：1
> 
> 时间：2009-04-08T11:44:10.653
> 
> 标签：oracle, database-design, replication, scalability, rdbms

Oracle DataGuard 是一种跨多个 Oracle 引擎实例复制存储在 Oracle RDBMS 中的数据的技术。我想知道 DataGuard 是否真的为 RDBMS 提供了线性可伸缩性。您有使用 DataGuard 的经验吗？它在重负载条件下的表现如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T14:15:06.080

DataGuard 通常用于业务连续性，即在主数据库不可用时拥有一个故障转移数据库。如果您正在寻找可扩展性，那么您需要 RAC（Real Application Clusters），其中不同主机上的多个实例挂载并共享同一组数据库文件。

通常，如果您有一个设计良好（以 db 为中心）的应用程序，该应用程序受数据库主机内存和 CPU 限制的约束，那么 RAC 会横向扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T14:49:26.120

我们在安装时不需要即时故障转移，因此我们在单独的服务器上使用 DataGuard 物理备用数据库。它的工作原理是通过 TNS 将归档日志数据传送到物理备用服务器，并且对于我们的环境（不是特别重）它工作正常。我们通常每小时有 1-10 个日志切换（57Mb 日志文件），备用数据库跟上没有问题。

这不是您要问的问题，但逻辑备用数据库和使用 Oracle 会话审计存在问题 - 您至少需要 10.2.0.4 和一些排除逻辑才能将审计记录排除在备用数据库之外，否则它无法跟上.

# java - 将字符串 XML 片段转换为 Java 中的文档节点

> ID：729621
> 
> 赞同：78
> 
> 时间：2009-04-08T11:45:18.700
> 
> 标签：java, xml, string

在 Java 中，如何将表示 XML 片段的字符串转换为插入 XML 文档？

例如

```
String newNode =  "<node>value</node>"; // Convert this to XML 
```

然后将此节点作为给定节点的子节点插入到**org.w3c.dom.Document中？**

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-04-08T12:02:35.070

```
Element node =  DocumentBuilderFactory
    .newInstance()
    .newDocumentBuilder()
    .parse(new ByteArrayInputStream("<node>value</node>".getBytes()))
    .getDocumentElement(); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-08T12:05:05.360

您可以使用文档的*[导入](http://java.sun.com/javase/6/docs/api/org/w3c/dom/Document.html#importNode(org.w3c.dom.Node,%20boolean))*（或*[采用](http://java.sun.com/javase/6/docs/api/org/w3c/dom/Document.html#adoptNode(org.w3c.dom.Node))*）方法添加 XML 片段：

```
 /**
   * @param docBuilder
   *          the parser
   * @param parent
   *          node to add fragment to
   * @param fragment
   *          a well formed XML fragment
   */
  public static void appendXmlFragment(
      DocumentBuilder docBuilder, Node parent,
      String fragment) throws IOException, SAXException {
    Document doc = parent.getOwnerDocument();
    Node fragmentNode = docBuilder.parse(
        new InputSource(new StringReader(fragment)))
        .getDocumentElement();
    fragmentNode = doc.importNode(fragmentNode, true);
    parent.appendChild(fragmentNode);
  } 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-08T13:22:58.577

对于它的价值，这是我使用[**dom4j**](http://dom4j.sourceforge.net/)库提出的解决方案。（我确实检查过它是否有效。）

将 XML 片段读入一个`org.dom4j.Document`（注意：下面使用的所有 XML 类均来自 org.dom4j；参见附录）：

```
 String newNode = "<node>value</node>"; // Convert this to XML
  SAXReader reader = new SAXReader();
  Document newNodeDocument = reader.read(new StringReader(newNode)); 
```

然后获取插入新节点的文档，以及从中插入的父元素。（您的 org.w3c.dom.Document 需要在此处转换为 org.dom4j.Document。）出于测试目的，我创建了一个这样的：

```
 Document originalDoc = 
      new SAXReader().read(new StringReader("<root><given></given></root>"));
    Element givenNode = originalDoc.getRootElement().element("given"); 
```

添加新的子元素非常简单：

```
 givenNode.add(newNodeDocument.getRootElement()); 
```

完毕。现在输出`originalDoc`产生：

```
<?xml version="1.0" encoding="utf-8"?>

<root>
    <given>
        <node>value</node>
    </given>
</root> 
```

**附录**：因为您的问题涉及`org.w3c.dom.Document`，这里是如何在 和 之间转换`org.dom4j.Document`。

```
// dom4j -> w3c
DOMWriter writer = new DOMWriter();
org.w3c.dom.Document w3cDoc = writer.write(dom4jDoc);

// w3c -> dom4j
DOMReader reader = new DOMReader();
Document dom4jDoc = reader.read(w3cDoc); 
```

（如果你`Document`经常需要这两种 s，将它们放在简洁的实用方法中可能是有意义的，也许放在一个名为的类`XMLUtils`或类似的东西中。）

也许有更好的方法来做到这一点，即使没有任何 3rd 方库。但是在迄今为止提出的解决方案中，在我看来这是最简单的方法，即使您需要进行 dom4j <-> w3c 转换。

**更新**（2011）：在将 dom4j 依赖项添加到您的代码之前，请注意[它*不是*一个积极维护的项目，并且还有一些其他问题](https://stackoverflow.com/questions/831865/what-java-xml-library-do-you-recommend-to-replace-dom4j)。改进的 2.0 版已经投入使用多年，但只有 alpha 版可用。您可能需要考虑替代方案，例如 XOM；在上面链接的问题中阅读更多内容。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-05T13:34:35.080

这是另一个解决方案，使用[**XOM**库](http://www.xom.nu/)，与[我的 dom4j 答案](https://stackoverflow.com/questions/729621/convert-string-xml-fragment-to-document-node-in-java/729979#729979)竞争。（这是我[寻找一个好的 dom4j 替代品](https://stackoverflow.com/questions/831865/what-java-xml-library-do-you-recommend-to-replace-dom4j)的一部分，其中 XOM 被建议作为一种选择。）

首先将 XML 片段读入`nu.xom.Document`：

```
String newNode = "<node>value</node>"; // Convert this to XML
Document newNodeDocument = new Builder().build(newNode, ""); 
```

然后，获取添加片段的 Document 和 Node。同样，出于测试目的，我将从字符串创建文档：

```
Document originalDoc = new Builder().build("<root><given></given></root>", "");
Element givenNode = originalDoc.getRootElement().getFirstChildElement("given"); 
```

现在，添加子节点很简单，与 dom4j 类似（除了 XOM 不允许添加已经属于的原始根元素`newNodeDocument`）：

```
givenNode.appendChild(newNodeDocument.getRootElement().copy()); 
```

输出文档会产生正确的 XML 结果（并且使用 XOM 非常容易：只需打印由 返回的字符串`originalDoc.toXML()`）：

```
<?xml version="1.0"?>
<root><given><node>value</node></given></root> 
```

（如果您想很好地格式化 XML（带有缩进和换行），请使用[`Serializer`](http://xom.nu/apidocs/nu/xom/Serializer.html); 感谢 Peter Štibraný 指出这一点。）

所以，诚然，这与 dom4j 解决方案没有太大区别。:) 然而，XOM 使用起来可能会更好一些，因为 API 有更好的文档记录，并且因为它的设计理念是每件事都有一个规范的方法。

**附录**：再次说明如何在 和 之间进行`org.w3c.dom.Document`转换`nu.xom.Document`。使用 XOM`DOMConverter`类中的辅助方法：

```
// w3c -> xom
Document xomDoc = DOMConverter.convert(w3cDoc);

// xom -> w3c
org.w3c.dom.Document w3cDoc = DOMConverter.convert(xomDoc, domImplementation);  
// You can get a DOMImplementation instance e.g. from DOMImplementationRegistry 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-07T14:42:49.643

```
/**
*
* Convert a string to a Document Object
*
* @param xml The xml to convert
* @return A document Object
* @throws IOException
* @throws SAXException
* @throws ParserConfigurationException
*/
public static Document string2Document(String xml) throws IOException, SAXException, ParserConfigurationException {

    if (xml == null)
    return null;

    return inputStream2Document(new ByteArrayInputStream(xml.getBytes()));

}

/**
* Convert an inputStream to a Document Object
* @param inputStream The inputstream to convert
* @return a Document Object
* @throws IOException
* @throws SAXException
* @throws ParserConfigurationException
*/
public static Document inputStream2Document(InputStream inputStream) throws IOException, SAXException, ParserConfigurationException {
    DocumentBuilderFactory newInstance = DocumentBuilderFactory.newInstance();
    newInstance.setNamespaceAware(true);
    Document parse = newInstance.newDocumentBuilder().parse(inputStream);
    return parse;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-23T11:34:30.220

如果你使用 dom4j，你可以这样做：

文档文档 = DocumentHelper.parseText(text);

（dom4j 现在在这里找到： [https](https://github.com/dom4j/dom4j) ://github.com/dom4j/dom4j ）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-04T07:48:58.993

试试[jcabi-xml](http://xml.jcabi.com)，用一个衬里：

```
Node node = new XMLDocument("<node>value</node>").node(); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-09-21T11:33:19.397

...如果您使用的是纯 XOM，则如下所示：

```
 String xml = "<fakeRoot>" + xml + "</fakeRoot>";
    Document doc = new Builder( false ).build( xml, null );
    Nodes children = doc.getRootElement().removeChildren();
    for( int ix = 0; ix < children.size(); ix++ ) {
        otherDocumentElement.appendChild( children.get( ix ) );
    } 
```

XOM 在内部使用 fakeRoot 来做几乎相同的事情，所以它应该是安全的，如果不是完全优雅的话。

# silverlight - Silverlight 单元测试 - 如何检查 UI 基本类型？

> ID：729626
> 
> 赞同：0
> 
> 时间：2009-04-08T11:46:36.280
> 
> 标签：silverlight, unit-testing, mvvm, silverlight-2.0

**简而言之：**在 Silverlight 单元测试期间如何检查 UI 用户控件的类型？

**详细说明：**我正在将子视图加载到父视图上的 ContentControl 中。在测试期间，我想检查是否在正确的时间加载了正确的视图。我的视图位于单独的项目中，我不想将这些程序集的引用添加到我的父视图的测试项目中（耦合太紧密）。

这是我卡住的地方：

```
[TestMethod]
[Asynchronous]
[Description("Test to confirm that upon initial class creation, the login view is loaded as the default content for the TaskRegion.")]
public void Shell_Initialisation_LoginViewIsLoadedByDefault()
{
   Shell shell = new Shell();

   //helper method from Justin Angels example 
   WaitFor(shell, "Loaded");

   TestPanel.Children.Add(shell);

   Shell_ViewModel viewModel = shell.DataContext as Shell_ViewModel;

   EnqueueCallback(() => Assert.IsTrue(viewModel.TaskRegionContent is **How do I reference my control type**));

   EnqueueTestComplete();
} 
```

我应该使用模拟吗？

（WaitFor 是[Justin Angel](http://silverlight.net/blogs/justinangel/archive/2009/02/25/silverlight-unit-testing-rhinomocks-unity-and-resharper.aspx?CommentPosted=true#commentmessage)提供的辅助方法）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-06T17:33:44.893

使用 GetType() 怎么样？然后，您可以在 Type 实例上使用各种方法来检查它是类型的实例还是继承自该类型。

```
Assert.IsInstanceOfType(viewModel.TaskRegionContent, typeof(Control)) 
```

上面的“控制”是您要检查的兴趣类型。

另请参阅：http: [//msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.assert.isinstanceoftype (VS.80).aspx](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.assert.isinstanceoftype(VS.80).aspx)

# wpf - 在多个 RichTextBox 之间共享 FlowDocument

> ID：729629
> 
> 赞同：2
> 
> 时间：2009-04-08T11:47:41.270
> 
> 标签：wpf, flowdocument

一个 WPF`FlowDocument`只能属于一个`RichTextBox`. 但是，我们希望使用一个可以在 UI 中的不同点（空间和时间）进行操作的文档。永远不会有两个`RichTextBoxes`同时显示一个文档（并且不能，因为 WPF 会抱怨）。

在这里使用`MemoryStream`and `XamlReader`/`Writer`将不起作用，因为我们希望保留单个文档并在使用它的任何地方反映更改，因此每次都复制它已经过时了。

有没有其他可行的方法来实现这一目标？您可以将其用作创建`FlowDocument`s 的基础模型吗？

澄清：使用 Document 的 RichTextBoxes 不再可见或在逻辑/视觉树中的任何位置，当另一个将被实例化时。虽然我可能无法强制他们已经被 GC 吃掉了。从窗口中删除 RichTextBox 后立即重新使用 Document 时，这似乎会导致问题；仍然会引发 Document 已在另一个控件中使用的异常。

基本上是有一组“向导页面”一个接一个地显示，我们可能会在两个连续的“页面”上重复使用文档，但每次都实例化一个新的 RTBox。也许有问题或更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-16T08:09:29.140

FlowDocument 不能由多个 RichTextBox 控件直接共享。

因此，您需要先“分离”该文档...

所以

```
RTB2.Document = RTB1.Document; 
```

不会工作，会导致你的例外..

```
FlowDocument doc = RTB1.Document;
RTB1.Document = new FlowDocument(); //Document cannot be null, so therefor the new FlowDocument instance
RTB2.Document = doc; 
```

会像魅力一样工作......

我的代码示例：

xml:

```
<Window x:Class="WpfApplication2.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <RichTextBox x:Name="RTB1" />

        <RichTextBox x:Name="RTB2" Grid.Column="1" />

        <Button x:Name="button" Grid.Row="1" Grid.ColumnSpan="2" Content="click" Click="button_Click"  />

    </Grid>

</Window> 
```

后面的代码..

```
public partial class Window1 : Window
{
    public Window1()
    {
        InitializeComponent();
    }

    private void button_Click(object sender, RoutedEventArgs e)
    {
        FlowDocument doc = RTB1.Document;
        RTB1.Document = new FlowDocument();
        RTB2.Document = doc;
    }
} 
```

它不是书中最漂亮的，但它确实有效......

希望这可以帮助..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T14:01:29.870

如果在任何给定时间界面中只有一个编辑器可见，我应该认为可以在活动编辑器的 LostFocus 事件中同步所有编辑器的内容。

如果一个编辑器中的更改需要立即反映在应用程序的另一个当前可见部分，您可以使用 Rectangle 来伪造它，例如，其中 Fill 是引用活动编辑器的 VisualBrush，并且 Rectangle 的宽度和高度绑定到编辑器的实际宽度和高度。棘手的部分是以相对无缝的方式处理活动编辑器切换。

**编辑：**我想我不明白为什么在向导中的页面之间移动时不能执行 XamlWriter.Save / XamlReader.Parse 序列，但是......如何始终使用相同的 RichTextBox 实例并将其重新设置为当该页面变为可见/活动时，每个页面中的容器？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T16:11:50.427

根据您的向导的构建方式，我实际上*建议*您只需将 RichTextBox 从一页移动到另一页。WPF 控件可以随意“取消父级”和“重新父级”，因此只需使 RichTextBox 实例在整个向导中共享的上下文中可用，并确保在您从一个页面移动到另一个页面时您是取消父级/重新父级。这还具有在向导中跨页面保存对编辑器状态的任何样式或更改的好处（这可能是可取的）。

如果无法跨页面共享 RichTextBox 实例，我认为有一种方法可以解除文档与原始 RichTextBox 的关联。看来，为了解除文档与 RichTextBox1 的关联，您必须为 RichTextBox1 提供一个新文档。您不能将 RichTextBox1.Document 设置为 null，但可以将 RichTextBox1.Document 设置为 new FlowDocument()，我相信这会起作用。我现在无法对此进行测试，但我看到在此 MSDN 论坛主题的最后一篇文章中推荐了它：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/797bfc96-cf24-4071-bff8-ce8c4a7b897b](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/797bfc96-cf24-4071-bff8-ce8c4a7b897b)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-13T03:48:04.400

流文档无法共享，因此您必须分离。

```
string flowDocument = XamlWriter.Save(RTF1.Document);
RichTextBox RTF2= new RichTextBox();
RTF2.Document = XamlReader.Load(new MemoryStream(Encoding.Default.GetBytes(flowDocument))) as FlowDocument; 
```

# c# - 在xml中存储DataRelation？

> ID：729634
> 
> 赞同：0
> 
> 时间：2009-04-08T11:49:50.530
> 
> 标签：c#, .net-3.5, ado.net

我正在使用一种新颖的方法设计一个数据库应用程序。（至少对我来说是小说...... :)）

所以我也在为此做一些研究。

我正在使用 .NET 3.5 ADO.NET 数据集来处理数据并将其离线存储在 XML 中。

首先，这种方法对于一个严肃的应用程序（虽然是一个小数据库，4-5 个用户，~25 个表~3-4k 条记录）应用程序有什么好处？

其次，如何将数据关系准确地存储在离线 XML 文件中？

谢谢！

索拉布。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T12:04:22.383

25 个表，每个表有 3-4k 行，这不是我所说的 xml 的“小”；特别是，在 xml 中跳转到正确的数据并不容易......

您是否考虑过数据库，例如 SQL Server Express Edition。免费，而且胜任这份工作。

* * *

重新存储；如果您使用的是内置序列化 a `DataSet`，这应该会自动工作。当然，xml 将特定于`DataSet`......老实说，我不推荐`DataSet`/xml 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T12:43:25.237

回答您的问题（即使我同意 Marc，您也不应该使用 XML 作为数据存储层）。

Ids 和 hrefs 通常用于在 XML 中创建关系（这是分层的而不是关系的，同样，您不应该使用 XML）。

举个小例子：

```
<region name="South Africa" id="region_1">
    <manager ref="#employee_1"/>
</region>

<employee name="John Doe" id="employee_1" region="#region_1">
    <manages>
        <employee ref="#employee_2" />
    </manages>
</employee>

<employee name="Cyril Smith" id="employee_2" region="#region_1">
    <manages /> <!-- code monkey -->
</employee> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T12:35:18.220

我同意 Marc 的建议。不要走 XML 路线。您可能不知道您的应用何时/如何增长。使用 xml，您没有事务，检查约束以保护数据的完整性，....

数据库不仅仅是愚蠢的存储。使用一些免费的 express db 版本。这样您就可以轻松迁移到更专业的 DBMS 版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T12:53:04.670

我同意其他海报。在您的情况下，我不会使用 XML。要提出不同的建议，请尝试 SQLlite：[http](http://www.sqlite.org/) ://www.sqlite.org/和 .NET ADO：[http](http://sqlite.phxsoftware.com/) ://sqlite.phxsoftware.com/ 。它不是一个超级强大的数据库，但它是免费的并且可以完成工作。

但是，如果您看到您的应用程序的数据库在未来不断扩大（更多用户、更多使用等），您应该使用更强大的数据库，例如 SQL 或 MySQL。

如果您出于某种原因绝对受 XML 约束，我会同意 Jonathan 的建议。

# vb.net - VB6中用于列出文件夹中指定类型的所有文件的任何函数

> ID：729636
> 
> 赞同：2
> 
> 时间：2009-04-08T11:50:45.100
> 
> 标签：vb.net, visual-studio-2005, vb6

我想知道下面描述的场景是否有一些内置函数：

输入是父文件夹的路径。函数必须做的是，它应该列出该父文件夹中的所有 .zip 文件。父文件夹可以包含任意数量的子文件夹，这同样适用于子文件夹.. 任何人都可以帮我解决这个问题吗？

VB版不是路障。VB6 或 VS2005 可以做的任何版本。请帮帮我。如果没有这样的内置功能，还有其他替代方法。提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T12:53:39.533

对于 VB6.0，我会使用`FileSystemObject`和 一个小的递归函数。

```
Sub test()
  Dim fso As New Scripting.FileSystemObject
  Dim files As New Collection
  Dim file As Scripting.file

  GetFilesRecursive fso.GetFolder("C:\YourFolder"), "zip", files, fso

  For Each file In files
    Debug.Print file.Name
  Next file
End Sub

Sub GetFilesRecursive(f As Scripting.Folder, filter As String, c As Collection, fso As Scripting.FileSystemObject)
  Dim sf As Scripting.Folder
  Dim file As Scripting.file

  For Each file In f.Files
    If InStr(1, fso.GetExtensionName(file.Name), filter, vbTextCompare) = 1 Then
      c.Add file, file.path
    End If
  Next file

  For Each sf In f.SubFolders
    GetFilesRecursive sf, filter, c, fso
  Next sf
End Sub 
```

不过，这不会像闪电一样快。只有直接使用 FindFirstFile 和 FindNextFile 等 Win32 API 函数才能获得最大性能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T11:55:12.000

使用 VB.NET，您可以使用[System.IO.Directory.GetFiles](http://msdn.microsoft.com/en-us/library/ms143316.aspx)来做到这一点。有一个版本可以搜索模式，让您也可以搜索子目录。

```
For Each dir In Directory.GetFiles("path","*.zip",SearchOptions.AllDirectories)
    Console.WriteLine( _
        "{0,-25} {1,25}", dir.FullName, dir.LastWriteTime)
Next dir 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T12:33:02.110

在 VB6 中，您想使用 Microsoft Scripting Runtime 的 FileSystemObject。您可以通过设置对脚本运行时的引用来访问它。

.NET 框架在 System.IO 命名空间中有一组类似但功能更强大的文件/目录处理对象

下面以一个例子说明如何在VB6中使用FileSystemObject。

```
Dim FSO As FileSystemObject
Dim Folder As Folder
Dim SubFolder As Folder
Dim File As File

Set FSO = New FileSystemObject

Set Folder = FSO.GetFolder("C:\")
For Each File In Folder.Files
    Debug.Print File.Name
Next File

For Each SubFolder In Folder.SubFolders
    Debug.Print SubFolder.Name
Next SubFolder

Set Folder = Nothing
Set SubFolder = Nothing
Set FSO = Nothing 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T13:04:23.143

VB6 没有任何东西可以一键完成，但是很容易获得所有 ZIP 文件的列表（例如）。

不推荐使用 FSO 有几个原因：第一，它添加了一个依赖项，第二，它依赖于脚本，可以根据策略禁用。

无论如何，这是您可以充实的最小示例：

```
 Dim Fils() As String
 Dim Counter As Long
 Dim CurrentFile As String

 Redim Fils(0 To 999) As String

 CurrentFile = Dir$(yourpath & "*.zip")

 Do While LenB(CurrentFile)
   Fils(Counter) = CurrentFile
   Counter = Counter + 1
   CurrentFile = Dir$()
 Loop 
```

当然，你想添加限制检查等，并根据需要进行redim，但这是基本思想。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T15:25:08.797

又一次尝试：

```
Private Sub EnumSubfiles(ByVal ParentFolder As String, _
                         ByVal FilePattern As String)
    'Report back via Report subroutine.
    Dim SubFolders As Collection
    Dim Name As String
    Dim FQName As String
    Dim SubFolder As Variant

    Set SubFolders = New Collection
    Name = Dir$(ParentFolder & "\*", vbNormal Or vbDirectory)
    Do Until Len(Name) = 0
        FQName = ParentFolder & "\" & Name
        If (GetAttr(FQName) And vbDirectory) = vbDirectory Then
            If Not (Name = "." Or Name = "..") Then
                SubFolders.Add FQName
            End If
        Else
            If Name Like FilePattern Then Report FQName
        End If
        Name = Dir$()
    Loop
    For Each SubFolder In SubFolders
        EnumSubfiles SubFolder, FilePattern
    Next
End Sub 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-09T15:50:37.827

只需在完整的原生 VB6 中插入一个为您完成所有工作的[CDirDrill 类](http://vb.mvps.org/samples/project.asp?id=DirDrill)。[Karl Peterson](http://vb.mvps.org/)的另一个出色解决方案:)

顺便说一句，我还建议避免使用 FileSystemObject。我遇到了一些错误，因为一些客户设法在他们的 PC 上弄乱了 scrrun.dll。消除依赖，除非它们真的对你有很大帮助。

# algorithm - 最优布局算法

> ID：729640
> 
> 赞同：3
> 
> 时间：2009-04-08T11:53:52.783
> 
> 标签：algorithm, math, geometry, css-sprites

我正在根据这篇文章在我的 ASP.NET 应用程序中实现 CSS Sprites 设置。

[http://weblogs.asp.net/zowens/archive/2008/03/05/css-sprite-for-asp-net.aspx](http://weblogs.asp.net/zowens/archive/2008/03/05/css-sprite-for-asp-net.aspx)

在*“已经获取 SPRITE！”部分中* ……作者说……

“唯一真正的缺点是你所有的图像都是垂直排列的。我不太确定这是否重要，但大多数其他生成器都能够以某种方式垂直和水平排列图像。”

我确信这一定是一个以前解决过的问题，所以我的问题是，**“给定一组矩形，你能以最佳方式有效地布置它们吗？”** （我想这取决于我对最优的定义，但从最接近正方形开始。（尽管实际上可能并非如此。））另外，您是否需要提前所有矩形或可以这样做逐步？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T12:18:36.297

这被称为矩形包装问题。即使在非常简单的情况下，找到最佳解决方案也是 NP 难的，尽管通常有很好的启发式方法。谷歌搜索矩形包装提供了一些有趣的算法和代码。

# c# - Int 到字符串：无法从“方法组”转换为“字符串”

> ID：729642
> 
> 赞同：32
> 
> 时间：2009-04-08T11:54:26.323
> 
> 标签：c#, winforms, string, listview, int

我的表单上有一个 listView。我想在程序运行期间添加一些东西。

这是我使用的代码

```
public void FillList(string[] Name,int[] empty,int[] Population,int[] Max,int[] Check,int size)
{
    if (this.InvokeRequired)
    {
        this.Invoke((MethodInvoker)delegate
        {
            for (int i = 0; i < size; i++)
            {
                ListViewItem item = new ListViewItem(Name[i]);

                item.SubItems.Add(empty[i].ToString); //error
                item.SubItems.Add(Population[i].ToString); //error
                item.SubItems.Add(Max[i].ToString);   //error

                if (Check != 1)
                    item.SubItems.Add("No");
                else
                    item.SubItems.Add("Yes");
                listView1.Items.Add(item);
            }
        });
    }
} 
```

参数必须是字符串，我试过了`.ToString`，但我明白了：

> 参数“1”：无法从“方法组”转换为“字符串”

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2009-04-08T11:56:03.933

您缺少方法调用的括号：

```
ToString**()**
```

如果没有括号，则表达式是一个[方法组](https://stackoverflow.com/q/886822/1968) ——即对一个或多个重载方法的引用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-08T11:56:34.197

你忘了括号。

它应该是`.ToString()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-20T07:06:43.530

约翰这是题外话，但您是否考虑过使用此方法传入一个由要添加的每个子项组成的类。所以：

```
class ListItem 
{
 public string Name {get; set;}
 public int Empty {get; set;}
 public int Population {get; set;}
 public int Max {get; set;}
 public bool Checked {get; set;}
} 
```

这样，您需要将传入的数组中的每个项目排成一行。尝试在许多数组中排列项目通常会使界面难以使用。你的方法看起来像

```
FillList(IList<ListItem> listItems)
{
if (this.InvokeRequired)
    {
        this.Invoke((MethodInvoker)delegate
        {
            foreach (ListItem listItem in listItems)
            {
                ListViewItem item = new ListViewItem(listItem .Name);

                item.SubItems.Add(listItem.Empty.ToString());
                item.SubItems.Add(listItem.Population.ToString());
                item.SubItems.Add(listItem.Max.ToString());

                item.SubItems.Add(listItem.Checked ? "No" : "Yes");

                listView1.Items.Add(item);
            }
        }
    }
} 
```

我刚刚直接写了这段代码，所以可能需要一些代码清理

# image - jQuery插件显示图像

> ID：729650
> 
> 赞同：1
> 
> 时间：2009-04-08T11:57:13.773
> 
> 标签：image, onclick

我生成一个 HTML 页面，其中包含指向目录中图像的链接。

首先，我想加载/显示所有图像，然后使用 jQuery 隐藏它们。`.hide()`当用户单击图像时，我将显示该图像，但我希望您能提供更好的方法。

仅当用户单击链接时才可以加载/显示图像？你能给我推荐一个插件或 PHP 脚本吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T12:00:01.333

您可以使用[Ibox](http://www.ibegin.com/labs/ibox/)并执行以下操作：

```
<a href="http://site.com/img.jpg" rel="ibox">Image 1</a> 
```

当有人单击此链接时，图像将显示在一个小的悬停窗口中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T12:01:58.940

lightbox，ThickBox 可以解决问题。

在灯箱技术下查看这个： [灯箱技术](http://www.smashingmagazine.com/2009/01/15/45-new-jquery-techniques-for-a-good-user-experience/)

# c++ - 使用 C++ STL 功能编写 MySQL UDF

> ID：729652
> 
> 赞同：1
> 
> 时间：2009-04-08T11:57:47.657
> 
> 标签：c++, mysql, user-defined-functions

[MySQL Docs ( http://dev.mysql.com/doc/refman/5.0/en/adding-udf.html](http://dev.mysql.com/doc/refman/5.0/en/adding-udf.html) ) 中有一条语句困扰着我：

> *“UDF 包含成为正在运行的服务器一部分的代码，因此当您编写 UDF 时，您会受到任何和所有适用于编写服务器代码的约束的约束。例如，**如果您尝试使用来自libstdc++ 库**。* "

如果使用 C++ 标准库函数编写 UDF，为什么会出现问题？
这是否意味着我注定要使用普通的旧 C 来编写我的 UDF？（请说不）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T17:02:34.187

特别是，您的 UDF 不得允许抛出任何 C++ 异常。在从 UDF 返回之前，必须捕获所有异常。这通常需要尝试/捕获任何进入 C++ 代码的 UDF，如果您特别偏执，包括“catch (...)”子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T12:15:40.343

对 libstdc++ 完全没有任何知识，但是通过“例如”位表示此警告不仅适用于 libstdc++，我建议这意味着一般要警惕标准库，因为它们可能会执行不会执行的操作在 UDF 环境中工作。

例如（回到 C 语言）strtok 在调用之间维护本地状态，这意味着如果您尝试使用它同时处理两个不同的字符串，则必须对其使用进行序列化或面临其结果的损坏。因此 strtok 无法在像 UDF 这样的环境中工作，在这种环境中，您无法控制函数的调用位置和时间。

因此，我会说应该避免在多线程环境中不起作用的任何事情。

但请注意，以上纯属我的推测，并非基于现实。

# iphone - 从另一个标签栏重新加载一个 tabbarView？

> ID：729655
> 
> 赞同：1
> 
> 时间：2009-04-08T12:00:05.297
> 
> 标签：iphone

我拥有的是具有不同视图控制器的基本 4 标签栏设置。我有一个设置选项卡，它使用正确的设置更新 .plist 文件。

我需要选项卡 1 来更新它在标签上，无论是从设置选项卡还是在 1 选项卡上的 didSelectViewController 上。但是我该怎么做，不能让它工作？

我唯一要做的就是让用户完全退出应用程序，以便调用 viewDidLoad 方法，并再次加载视图。

希望你能帮我 ：）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T14:30:57.913

您可以更新 中的标签`viewWillAppear:`，因为每次选择选项卡时都会调用它。

# c# - 为什么 c# 编译器会从此代码创建 PrivateImplementationDetails？

> ID：729667
> 
> 赞同：31
> 
> 时间：2009-04-08T12:04:50.447
> 
> 标签：c#

我发现以下代码：

```
public static class MimeHelper
    {
        public static string GetMimeType(string strFileName)
        {
            string retval;
            switch (System.IO.Path.GetExtension(strFileName).ToLower())
            {
                case ".3dm": retval = "x-world/x-3dmf"; break;
                case ".3dmf": retval = "x-world/x-3dmf"; break;
                case ".a": retval = "application/octet-stream"; break;
                // etc...
                default: retval = "application/octet-stream"; break;
            }
            return retval;
        } 
    } 
```

导致编译器创建这个无命名空间的内部类（从 Reflector 复制）：

```
<PrivateImplementationDetails>{621DEE27-4B15-4773-9203-D6658527CF2B}
    - $$method0x60000b0-1 : Dictionary<String, Int32>
    - Used By: MimeHelper.GetMimeType(String) : String 
```

这是为什么？我将如何更改上面的代码使其不会发生（只是出于兴趣）

谢谢

安德鲁

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-08T12:08:37.943

它正在创建字典来处理 switch 语句中各种情况的查找，而不是从中创建几个分支 if 来设置返回值。相信我——你不想改变它的工作方式——除非你想让地图明确。

**旁白**：我最初假设字典将每个案例的映射存储到另一个映射的索引中以获取返回值。根据@Scott（见评论），它实际上存储了一个标签的索引，用于该情况下应该执行的代码。当您考虑到为每种情况执行的代码可能不同并且可能比给定示例中长得多时，这绝对有意义。

**编辑**：根据您的评论，我想我可能很想将映射存储在外部配置文件中，在启动期间读取它们，并构建实际的映射——从键到值的单级映射或类似的多级从键映射到索引和索引到值。我认为在配置文件中维护这些映射比每次需要添加或删除特定案例时更新代码更容易。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-21T21:09:58.657

正在发生的事情是编译器正在创建一个它在编译时发出的内部类。此类称为`<PrivateImplementationDetails>{99999999-9999-9999-9999-999999999999}`，此类的 GUID 组件是在编译时生成的，因此它会随着每次构建而更改。在这个类内部有一个包含不同案例变量的字典，以及一个对应于每个值的 int。然后它将 switch 语句替换为在字典中查找以获取相应的 int，并对 int 值进行切换（比进行一堆 sting 比较效率更高）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T12:08:49.360

例如，[请参](http://bartdesmet.net/blogs/bart/archive/2008/08/21/how-c-array-initializers-work.aspx)见此。

# ruby-on-rails - 如何在rails中使用多个缓存？

> ID：729670
> 
> 赞同：7
> 
> 时间：2009-04-08T12:05:32.007
> 
> 标签：ruby-on-rails, caching

我有一个 Rails 应用程序，我想同时使用 memcached 和文件存储缓存，用于不同的目的。

我想使用文件存储缓存来保留大量不经常更改的页面（有些根本不更改） - 即页面缓存 - 并将 memcached 用于其他所有内容（操作和数据库缓存等）。原因是存储在文件存储缓存中的页面可能需要大量存储空间，但单独大部分将不经常访问。

这是可能的还是将 memcached 配置为缓存意味着它也用于页面缓存？

作为第二个问题，以某种形式的 cron 作业从文件存储缓存中删除页面的安全方法是什么，因为似乎没有为此缓存指定 ttl 的选项。例如，一个 UNIX 查找命令将快速查找并删除所有旧页面或长时间未访问的页面 - 考虑到应用服务器可能会尝试服务其中一个页面，这样做是否安全（虽然这不太可能）？如果没有，那么最好的方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-07T05:43:58.493

一种更简单的方法可能是使用应用程序上游的 http 缓存作为页面缓存，而不是在 rails 中使用两个存储。这样，您可以使用 http 标头来控制缓存行为，包括 TTL。这些相同的限制也适用于浏览器的本地缓存，作为一个不错的奖励。

[Varnish](http://varnish.projects.linpro.no/)具有尽可能高的性能，但需要在您的托管环境中设置另一个移动部件作为代理。这可能仍然值得，具体取决于您在做什么。

一个更简单的方法可能是[Rack::Cache](http://tomayko.com/src/rack-cache/)，如果您使用支持机架的 rails 版本，它将很容易设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-10T15:41:32.197

如果您只想将文件系统用于页面缓存，而将 memcached 用于操作和片段缓存，那很好。页面缓存*始终*使用文件系统。请记住，页面缓存会绕过您的 Rails 应用程序，因此您不能将它用于包含在用户之间更改的内容的页面或使用过滤器进行访问控制的页面。

关于页面的删除，在 Unix 上，可以删除一个文件，但直到所有打开的文件句柄都关闭后，它才真正从磁盘中删除。如果应用服务器已打开文件来处理请求，而 find 命令在一瞬间将其删除，则应用服务器在尝试读取时不会突然出错。

您还可以考虑`find`根据上次访问时间删除文件，而不是创建或修改文件，并在 Rails 应用程序中使用清扫器在其内容过期时删除缓存页面。

# seo - SEO 和会话参数

> ID：729671
> 
> 赞同：-2
> 
> 时间：2009-04-08T12:06:17.900
> 
> 标签：seo, session-variables

如果我们开发一个与 SEO 兼容的网站，是否可以使用会话变量？如果不是，还有什么选择？非常感谢。此致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T12:17:35.377

搜索引擎会根据 URL 为您网站上的页面编制索引。如果您的 URL 不依赖于分配给每个请求的唯一会话 ID，那么蜘蛛在索引您的站点时应该不会有问题。

也就是说，您页面的内容也很重要。如果页面内容严重依赖于 Session 变量（或 Viewstate 参数），您可能会在获取该页面的索引时遇到问题。最好的方法是为您网站的每个部分设置唯一的静态 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T12:27:04.763

您应该使用 cookie，因为它们依赖于机器。URL 中的会话标识符非常不保存（会话窃取），因为如果您将 url 发送给某人，您将丢失会话。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-09T06:40:21.377

来自[谷歌网站管理员指南](http://www.google.com/support/webmasters/bin/answer.py?answer=35769#2)：

> “允许搜索机器人在没有会话 ID 或跟踪其通过站点的路径的参数的情况下抓取您的站点。这些技术对于跟踪个人用户行为很有用，但机器人的访问模式完全不同。使用这些技术可能会导致不完整的索引您的网站，因为机器人可能无法消除看起来不同但实际上指向同一页面的 URL。”

因此，我认为要求您希望编入索引的内容需要会话不是一个好主意。这取决于您对可能的替代方案/解决方法的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T13:25:30.130

会话变量可以在 HTTP 请求中作为 cookie、POST 变量或在 URL 中传递。

搜索引擎不支持 cookie 或 POST 变量，它们会尽量避免在 URL 中包含会话变量的页面。

您可以为您的用户使用基于 cookie 或 POST 的会话跟踪，但请注意，来自搜索引擎的请求将始终显示为新会话的开始。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T12:54:22.187

我同意 Cerebrus 的观点。只要确保

*   您有唯一的静态 URL。如果您没有唯一的 url，您将失去指向该页面的链接。
*   页面的所有状态都具有相同的标题
*   您为页面的所有状态定位相同的关键字

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-03T09:19:27.307

URL 独立于分配给每个请求的唯一会话 ID，那么网络蜘蛛在谷歌上索引您的网站应该没有问题。

# c++ - sizeof(*this) 给出错误值

> ID：729683
> 
> 赞同：2
> 
> 时间：2009-04-08T12:11:05.987
> 
> 标签：c++, assembly, sizeof

我有一个类，C。C有一个成员变量声明为：bool markerStart;

在 C 中，对 sizeof(*this) 的调用会给出 0x216 字节的值。

在 C 的其他地方，我这样做：markerStart = false;

这个调用实际上不是将 markerStart 设置为 false，而是破坏了内存中下一个类的开始！

查看反汇编代码，我发现：

```
markerStart = false;
06FB6B7F mov            eax, dword ptr [this]
06FB6B78 mov            byte ptr [eax+218h], 0 
```

第二个移动指令将这个 + 0x218 处的一个字节设置为零，但由于该类只有 0x216 个字节长，这是破坏内存！

回应评论，肯定是markerStart = false 指令。我可以在反汇编视图和内存视图中看到它发生的情况（并使用 Windbg，通过使用数据断点）。下一个类的第一个字节被设置为零，这弄乱了它的 vftbl 指针。

注意：获取 markerStart 的地址并从中减去，得到 0x211！

谁能告诉我从哪里开始寻找解决这个问题的线索？

更新：感谢所有帮助。没有代码，你们中的任何人都几乎不可能解决问题。我正在寻找的是关于从哪里开始寻找的提示。你们中的大多数人都提供了很好的提示，所以谢谢！

我终于找到了问题所在。在这种情况下，对齐已经设置在一个类中，并且在关键代码块之后没有正确重置。对齐错误的类恰好在 C 类声明之前被编译——因此这就是问题出现的地方。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T12:27:09.630

您需要发布更多代码 - 如果您可以将其修剪到发生异常的最小类定义，那就更好了。这本身可能会帮助您确定正在发生的事情。

我想到的一些可能性：

1.  您正在引用另一个 markerStart 变量，它会隐藏您感兴趣的成员变量。
2.  您在 C 的基类的方法中计算 sizeof。sizeof() 仅测量静态类型，而不测量动态类型。
3.  您在某处违反了[单一定义规则](http://en.wikipedia.org/wiki/One_Definition_Rule)，并且有两个不同版本的 C 类（可能是通过头文件中的一些 #ifdef 在两个翻译单元中以不同方式解释）。

如果没有更多信息，我会选择违反 ODR。这些可能是阴险的，并且在编译或链接时无法检测到。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-08T14:27:17.750

正如 Pontus 所指出的，您可能以某种方式违反了单一定义规则。您可能已经在两个翻译单元中包含了带有 C 类定义的头文件，而其他代码（通常在前面的头文件中）更改了 C 类定义的解释方式，使其在两个翻译中具有不同的大小单位。

一种可能性是，您不小心更改了默认成员对齐方式（通过编译器的命令行参数或通过源代码中的 #pragma），因此两个不同的翻译单元认为结构具有不同的大小，因为数量不同填充（大多数 x86 编译器默认对齐 4 字节边界，但允许您根据需要请求对齐 1 字节边界）。查看其他头文件中的 #pragma 更改缺少以下 #prama 的默认对齐方式以将其恢复为先前的值（您没有指定什么编译器，所以我无法给出细节）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T12:53:44.417

你的班级有虚方法吗？还是从具有虚拟方法的类派生？或者你的类有多重继承？

答案取决于您使用的编译器，编译器可以存储指向虚拟表的指针。这确实是一个实现细节，但只要它与标准相同，它就可以为每个对象存储任何类型的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T13:05:14.170

您在代码中没有一些奇怪的指针转换问题吗？类似的东西？

```
struct A
{
  int i;
};

struct B : public A
{
  int j;
  void f() { j=0; }
};

int main()
{
  A x;
  A* p=&x;
  ((B*)p)->f();
  return 0;
} 
```

你能检查一下这实际上指向了正在破坏你记忆的行上的一个 C 实例吗？你能`typeid(*this).name()`在那个时候打印吗（假设这个类有一些虚函数）？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T13:51:23.250

您遇到的问题可能是由于一些依赖错误而不是编译器的任何错误（编译器被成千上万的开发人员使用，如果有这样的问题，现在应该已经发现了）。

考虑一个包含以下两个文件的简单项目。文件 a.cpp：

```
class C
{
public:
  C () : m_value (42) { }
  void Print () { cout << "C::m_value = " << m_value << endl; }
private:
  int m_value;
};

void DoSomethingWithC (C &c);

void main (void)
{
  C array_of_c [2];
  DoSomethingWithC (array_of_c [0]);
  array_of_c [0].Print ();
  array_of_c [1].Print ();
} 
```

和文件 b.cpp：

```
class C
{
public:
  int a,b;
};

void DoSomethingWithC (C &c)
{
  c.b = 666;
} 
```

如果您编译上述两个文件并链接它们，您将不会收到任何错误或警告。但是，当您运行应用程序时，您会发现 DoSomethingWithC 破坏了 array_of_c [1]，即使它的参数是 array_of_c [0]。

所以你的问题可能是一个源文件以一种方式看待类，而另一个文件以不同的方式看待它。如果相关性检查失败，就会发生这种情况。

尝试强制重建所有。如果可行，那么您将需要查看依赖项失败的原因（例如，DevStudio 有时可能会出错）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T16:40:23.530

您的班级定义或项目设置最近是否发生了变化？我见过这样的问题，我得到了像这样绝对荒谬的行为，原因是链接过时的目标文件。目标文件不再匹配源文件。尝试干净和完整的重建。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-08T12:19:31.347

该类可能只有 0x216 字节，但下一个对象当然是在第一个对象开始之后的 0x218 字节。您的对象显然在 4 字节内存边界对齐，这是默认设置。

你必须到别处寻找你的记忆被破坏的地方。这绝对不是“markerStart = false”指令。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T12:50:36.640

这可能是“类切片”问题的一个实例吗？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-08T16:54:17.413

检查 *this 是否真的指向类的开始，而不是通过错误指针进行调用。

# sharepoint - 有没有人在数据表单 web 部件上成功地重新创建了 ECB 菜单？

> ID：729686
> 
> 赞同：0
> 
> 时间：2009-04-08T12:14:29.677
> 
> 标签：sharepoint, sharepoint-designer

我想使用数据表单 Web 部件来显示来自不同站点列表的列表内容。我还想显示 ECB 菜单以显示视图属性、编辑属性、在 Microsoft Word 中编辑（如果它是 Word 文档）等。

我想这只是 XSLT 中的一个练习，但我想知道是否有人以前破解过这个问题并有一个例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T12:09:57.883

AFAIK 欧洲央行只能在 SPGridView 上创建。

这是一个[教程链接](http://www.devexpertise.com/2009/02/25/integrating-a-custom-aspnet-application-into-sharepoint-part-2/)，显示在网格上创建 ECB。

# nhibernate - 如何使用 NHibernate 的 ICriteria API 选择随机行？

> ID：729687
> 
> 赞同：6
> 
> 时间：2009-04-08T12:15:18.863
> 
> 标签：nhibernate, random, icriteria

我可以使用 NHibernate 的`ICriteria`API 选择随机行吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-08T23:16:24.467

正如 cundh2o 所说，它是特定于 DBMS 的。但是您可以继承 Order 类并定义您自己的自定义排序。例如，对于 SQL Server：

```
public class RandomOrder: Order {
    public RandomOrder() : base("", true) {}
    public override SqlString ToSqlString(ICriteria criteria, ICriteriaQuery criteriaQuery) {
        return new SqlString("newid()");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T12:28:27.647

如果您不限于使用 ICriteria，我可能会建议您使用 HQL 而不是选择随机行，因为它可以提供更大的灵活性来使用您的数据库提供商提供的 Random 函数。

```
 IQuery q = NHibernateSession.CreateQuery("your hql statement here") 

```

# silverlight - 将 Silverlight UserControl 自定义属性绑定到其元素

> ID：729689
> 
> 赞同：17
> 
> 时间：2009-04-08T12:15:40.187
> 
> 标签：silverlight, data-binding, user-controls, silverlight-2.0

我正在尝试在 Silverlight 2.0 中制作一个简单的填字游戏。我正在开发一个 UserControl-ish 组件，它代表拼图中的一个正方形。我在将 UserControl 的属性与其元素绑定时遇到问题。我终于（有点）让它工作了（可能对某些人有帮助——我花了几个小时），但想让它更“优雅”。

我想象它应该有一个内容隔间和一个标签（在右上角），可以选择包含它的编号。内容控件可能是 TextBox，而标签控件可能是 TextBlock。所以我用这个基本结构创建了一个 UserControl（值在这个阶段是硬编码的）：

```
 <UserControl x:Class="XWord.Square"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    FontSize="30" 
    Width="100" Height="100">
        <Grid x:Name="LayoutRoot" Background="White">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <TextBlock x:Name="Label" Grid.Row="0" Grid.Column="1" 
                Text="7"/>
            <TextBox x:Name="Content" Grid.Row="1" Grid.Column="0"  
                Text="A"
                BorderThickness="0" />

        </Grid>
    </UserControl> 
```

我还在 Square 类中创建了 DependencyProperties，如下所示：

```
 public static readonly DependencyProperty LabelTextProperty;
     public static readonly DependencyProperty ContentCharacterProperty;

     // ...(static constructor with property registration, .NET properties
     // omitted for brevity)... 
```

现在我想弄清楚如何将 Label 和 Content 元素绑定到这两个属性。我这样做（在代码隐藏文件中）：

```
 Label.SetBinding( TextBlock.TextProperty, new Binding { Source = this, Path = new PropertyPath( "LabelText" ), Mode = BindingMode.OneWay } );
     Content.SetBinding( TextBox.TextProperty, new Binding { Source = this, Path = new PropertyPath( "ContentCharacter" ), Mode = BindingMode.TwoWay } ); 
```

在 XAML 中这样做会更优雅。有谁知道这是怎么做到的？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2010-04-26T08:22:07.820

首先，使用 {RelativeSource Self} 在 UserControl 上设置 DataContext：

```
<UserControl x:Class="XWord.Square"  
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"   
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"  
FontSize="30"   
Width="100" Height="100" 
DataContext="{Binding RelativeSource={RelativeSource Self}}"> 
```

现在您可以将各个元素绑定到用户控件的属性：

```
<TextBlock x:Name="Label" Grid.Row="0" Grid.Column="1" 
Text="{Binding LabelText}"/>  
<TextBox x:Name="Content" Grid.Row="1" Grid.Column="0" 
Text="{Binding ContentCharacter}" BorderThickness="0" /> 
```

对于 SL 2.0，您需要在 UserControl 的 Loaded 事件处理程序上设置 DataContext。

```
private void UserControl_Loaded( object sender, RoutedEventArgs e ) {
    LayoutRoot.DataContext = this;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-04-23T17:58:50.207

由于 Silverlight 不能使用 FindAncestor 技术，您可以使用类似于设置 UserControl 名称的技巧，但不会通过使用 LayoutRoot 的名称破坏其功能...

```
<UserControl x:Class="XWord.Square"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
FontSize="30" 
Width="100" Height="100">
    <Grid x:Name="LayoutRoot" Background="White">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock x:Name="{Binding Path=Parent.LabelText, ElementName=LayoutRoot}" Grid.Row="0" Grid.Column="1" 
            Text="7"/>
        <TextBox x:Name="{Binding Path=Parent.ContentCharacter, ElementName=LayoutRoot}" Grid.Row="1" Grid.Column="0"  
            Text="A"
            BorderThickness="0" />
    </Grid>
</UserControl> 
```

它在 SL3 中工作而无需添加任何额外的代码（我在 WP7 应用程序中使用它），但不知道您是否可以在 SL2 中使用它。好吧，我现在意识到这个问题有多老了，希望它仍然有帮助，我来到这里是因为我在 WP7 中得到的相同问题的答案并没有说服我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-22T22:38:34.007

我认为您正在寻找[UI Element to Element Binding](http://community.irritatedvowel.com/blogs/pete_browns_blog/archive/2009/03/18/Silverlight-3-_1320_-UI-Element-to-Element-Binding.aspx)这是 Silverlight 3 的一个功能。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T17:48:26.893

我可能不完全理解你的问题。在 Silverlight 中，您几乎可以绑定到任何数据对象。因此，如果您有一个包含属性 Content 和 Label 的 PuzzleSquare 类，您可以直接从对象绑定到这些属性。

假设您创建了一个简单的对象 PuzzleSquare：

```
 public class PuzzleSquare
    {
      public string Content{ get; set; }
      public string Label{ get; set; }

      public void PuzzleSquare(){};
      public void PuzzleSquare(string label, string content):this()
      {
         Content = content;
         Label = label;
      }    
    } 
```

因此，如果您使用经典视图/代码隐藏模型构建应用程序，您的代码将在页面加载时将此对象添加到网格的 DataContext 属性中：

```
LayoutRoot.DataContext = new PuzzleSquare("1", "A"); 
```

您的 Xaml 将绑定到 Square 属性：

```
 <TextBlock x:Name="Label" Grid.Row="0" Grid.Column="1" 
Text="{Binding Label}"/>            
    <TextBox x:Name="Content" Grid.Row="1" Grid.Column="0" 
Text="{Binding Content}" BorderThickness="0" /> 
```

那有意义吗？

ib。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-09T11:09:14.453

This worked in Silverlight 4.0

Put a name on the UserControl, and then refer to it in the TextBlock

```
 <UserControl x:Class="XWord.Square"
    ...omitted for brevity ...
    x:Name="Square">

        <TextBlock x:Name="Label" ...
            Text="{Binding Path=LabelText,ElementName=Square}"/> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-09-27T20:05:03.880

尝试这个：

```
Public ReadOnly TextProperty As DependencyProperty = DependencyProperty.Register("Text", GetType(String), GetType(ButtonEdit), New System.Windows.PropertyMetadata("", AddressOf TextPropertyChanged))
Public Property Text As String
    Get
        Return GetValue(TextProperty)
    End Get
    Set(ByVal value As String)
        SetValue(TextProperty, value)
    End Set
End Property
Private Sub TextPropertyChanged()
    If String.IsNullOrEmpty(Text) Then
        TextBox1.Text = ""
    Else
        TextBox1.Text = Text
    End If
End Sub
Private Sub TextBox1_LostFocus(ByVal sender As Object, ByVal e As System.Windows.RoutedEventArgs) Handles TextBox1.LostFocus
    Text = TextBox1.Text
End Sub 
```

我可以在 XAML 和后面的代码中绑定。

# file - 为什么文本文件应该以换行符结尾？

> ID：729692
> 
> 赞同：1769
> 
> 时间：2009-04-08T12:16:39.483
> 
> 标签：file, unix, text-files, newline

我假设这里的每个人都熟悉所有文本文件都应该以换行符结尾的格言。我已经知道这个“规则”很多年了，但我一直想知道——为什么？

* * *

## 回答 #1

> 赞同：1660
> 
> 时间：2009-04-08T12:46:40.113

因为这就是[POSIX 标准定义**一行**](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_206)的方式：

> **3.206线**
> 
> 零个或多个非 <newline> 字符加上终止 <newline> 字符的序列。

因此，不以换行符结尾的行不被视为实际行。这就是为什么某些程序在处理文件的最后一行时遇到问题的原因，如果它不是换行符终止的话。

在终端仿真器上工作时，该指南至少有一个硬性优势：所有 Unix 工具都期望这个约定并使用它。例如，当使用 连接文件时`cat`，由换行符终止的文件将与没有的文件具有不同的效果：

```
*$* **more** a.txt
foo
*$* **more** b.txt
bar*$* **more** c.txt
baz
*$* **cat** {a,b,c}.txt
foo
barbaz
```

而且，正如前面的示例还演示的那样，当在命令行上显示文件时（例如 via `more`），换行符终止的文件会导致正确的显示。不正确终止的文件可能会出现乱码（第二行）。

为了保持一致性，遵循这条规则非常有帮助——否则在处理默认的 Unix 工具时会产生额外的工作。

* * *

换个角度想一想：如果行不被换行符终止，那么使命令`cat`变得有用就更难了：你如何创建一个命令来连接文件，这样

1.  它将每个文件的开头放在一个新行上，这是您 95% 的时间想要的；但
2.  它允许合并两个文件的最后一行和第一行，如上面的示例中`b.txt`和`c.txt`？

当然这是*可以解决*的，但是您需要使使用`cat`更复杂（通过添加位置命令行参数，例如`cat a.txt --no-newline b.txt c.txt`），现在*命令*而不是每个单独的文件控制它如何与其他文件一起粘贴。这几乎肯定不方便。

... 或者您需要引入一个特殊的标记字符来标记应该继续而不是终止的行。好吧，现在您遇到了与 POSIX 相同的情况，除了反转（行继续而不是行终止字符）。

* * *

[现在，在*不符合 POSIX*的系统（现在主要是 Windows）上，这一点没有实际意义：文件通常不以换行符结尾，并且行的（非正式）定义可能例如是“由换行符*分隔*的文本” （注意重点）。这是完全有效的。然而，对于结构化数据（例如编程代码），它使解析变得更加复杂：这通常意味着必须重写解析器。如果一个解析器最初是在考虑 POSIX 定义的情况下编写的，那么修改令牌流可能比修改解析器更容易——换句话说，在输入的末尾添加一个“人工换行”令牌。]

* * *

## 回答 #2

> 赞同：295
> 
> 时间：2009-04-08T12:26:46.917

每行都应以换行符结束，包括最后一行。如果文件不是换行符终止，则某些程序在处理文件的最后一行时会出现问题。

GCC 警告它不是因为它*不能*处理文件，而是因为它*必须*作为标准的一部分。

> C 语言标准规定非空的源文件应以换行符结尾，该换行符之前不应紧跟反斜杠字符。
> 
> 由于这是一个“shall”子句，因此我们必须针对违反此规则的行为发出诊断消息。
> 
> 这在 ANSI C 1989 标准的第 2.1.1.2 节中。ISO C 1999 标准的第 5.1.1.2 节（可能还有 ISO C 1990 标准）。

参考：[GCC/GNU 邮件存档](http://gcc.gnu.org/ml/gcc/2003-11/msg01568.html)。

* * *

## 回答 #3

> 赞同：124
> 
> 时间：2014-08-15T06:31:50.920

这个答案是对技术答案而不是意见的尝试。

如果我们想成为 POSIX 纯粹主义者，我们将一行定义为：

> 零个或多个非 <newline> 字符加上终止 <newline> 字符的序列。

来源：[https ://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_206](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_206)

不完整的行为：

> 文件末尾的一个或多个非 <newline> 字符序列。

来源：[https ://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_195](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_195)

一个文本文件为：

> 包含组织成零行或多行的字符的文件。这些行不包含 NUL 字符，长度不能超过 {LINE_MAX} 个字节，包括 <newline> 字符。尽管 POSIX.1-2008 不区分文本文件和二进制文件（参见 ISO C 标准），但许多实用程序仅在对文本文件进行操作时产生可预测或有意义的输出。具有此类限制的标准实用程序始终在其 STDIN 或 INPUT FILES 部分中指定“文本文件”。

来源：[https ://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_397](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_397)

一个字符串为：

> 由第一个空字节终止并包括第一个空字节的连续字节序列。

来源：[https ://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_396](https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap03.html#tag_03_396)

从此，我们可以得出，我们唯一*可能*遇到任何类型的问题的情况是，如果我们将文件的*行*或文件作为*文本文件*的概念处理（因为*文本文件*是零组织）或更多行，而我们知道的一行必须以 <newline> 结尾）。

一个例子：`wc -l filename`。

从`wc`'s 手册中我们读到：

> 行定义为由 <newline> 字符分隔的字符串。

那么对于 JavaScript、HTML 和 CSS 文件来说它们是*文本* 文件有什么影响呢？

在浏览器、现代 IDE 和其他前端应用程序中，在 EOF 跳过 EOL 没有问题。应用程序将正确解析文件。它必须因为并非所有操作系统都符合 POSIX 标准，因此非操作系统工具（例如浏览器）根据 POSIX 标准（或任何操作系统级标准）处理文件是不切实际的。

因此，我们可以相对确信 EOF 的 EOL 对应用程序级别几乎没有负面影响——无论它是否在 UNIX 操作系统上运行。

在这一点上，我们可以自信地说，在客户端处理 JS、HTML、CSS 时，在 EOF 处跳过 EOL 是安全的。实际上，我们可以说缩小这些文件中的任何一个，不包含 <newline> 是安全的。

我们可以更进一步说，就 NodeJS 而言，它也不能遵守 POSIX 标准，因为它可以在不符合 POSIX 的环境中运行。

那我们还剩下什么？系统级工具。

这意味着可能出现的唯一问题是那些努力将其功能与 POSIX 语义相结合的工具（例如，如图所示的行定义`wc`）。

即便如此，并不是所有的 shell 都会自动遵守 POSIX。例如，Bash 不默认为 POSIX 行为。有一个开关可以启用它：`POSIXLY_CORRECT`。

关于 EOL 的价值是 <newline> 的思考：[https ://www.rfc-editor.org/old/EOLstory.txt](https://www.rfc-editor.org/old/EOLstory.txt)

保持在工具轨道上，出于所有实际意图和目的，让我们考虑一下：

让我们使用没有 EOL 的文件。在撰写本文时，此示例中的文件是没有 EOL 的缩小 JavaScript。

```
curl http://cdnjs.cloudflare.com/ajax/libs/AniJS/0.5.0/anijs-min.js -o x.js
curl http://cdnjs.cloudflare.com/ajax/libs/AniJS/0.5.0/anijs-min.js -o y.js

$ cat x.js y.js > z.js

-rw-r--r--  1 milanadamovsky   7905 Aug 14 23:17 x.js
-rw-r--r--  1 milanadamovsky   7905 Aug 14 23:17 y.js
-rw-r--r--  1 milanadamovsky  15810 Aug 14 23:18 z.js 
```

请注意，`cat`文件大小恰好是其各个部分的总和。如果 JavaScript 文件的连接是 JS 文件的关注点，那么更合适的关注点是每个 JavaScript 文件都以分号开头。

正如该线程中的其他人所提到的：如果您想要`cat`两个文件的输出只是一行而不是两行怎么办？换句话说，`cat`做它应该做的事情。

`man`仅提到`cat`读取输入到 EOF，而不是 <newline> 。请注意，`-n`开关`cat`还将打印出非 <newline> 终止的行（或*不完整的行*）作为*一行*- 因为计数从*1*开始（根据`man`.）

> -n 为输出行编号，从 1 开始。

现在我们了解了 POSIX 如何定义*line*，这种行为变得模棱两可，或者说真的不合规。

了解给定工具的用途和合规性将有助于确定以 EOL 结束文件的重要性。在 C、C++、Java (JAR) 等中......一些标准将规定换行符的有效性 - JS、HTML、CSS 不存在这样的标准。

例如，不要使用`wc -l filename`one could do `awk '{x++}END{ print x}' filename`，并请放心，任务的成功不会受到我们可能想要处理但不是我们编写的文件的危害（例如，第三方库，例如我们`curl`d 的缩小 JS）——除非我们的真正的目的是在符合 POSIX 的意义上计算*行数。*

**结论**

对于某些文本文件（如 JS、HTML 和 CSS）在 EOF 跳过 EOL 会产生负面影响（如果有的话）的实际用例将非常少。如果我们依赖 <newline> 的存在，我们将工具的可靠性限制在我们创作的文件中，并对第三方文件引入的潜在错误敞开大门。

故事的寓意：工程师工具不具有在 EOF 依赖 EOL 的弱点。

随意发布适用于 JS、HTML 和 CSS 的用例，我们可以在其中检查跳过 EOL 如何产生不利影响。

* * *

## 回答 #4

> 赞同：65
> 
> 时间：2009-04-08T12:29:08.407

这可能与以下之间的[差异](http://markmail.org/message/5jsn4epq7ad3vyvt)有关：

*   文本文件（每一行都应该以行尾结尾）
*   二进制文件（没有真正的“行”可言，必须保留文件的长度）

如果每一行都以行尾结尾，例如，这可以避免连接两个文本文件会使第一个文件的最后一行变成第二个文件的第一行。

另外，编辑器可以在加载时检查文件是否以行尾结尾，将其保存在其本地选项“eol”中，并在写入文件时使用它。

几年前（2005 年），许多编辑（ZDE、Eclipse、Scite，...）确实“忘记”了最后的 EOL，[这并不是很受欢迎](http://slashdot.org/comments.pl?sid=165492&cid=13808398)。
不仅如此，他们还错误地将最终的 EOL 解释为“开始新行”，并且实际上开始显示另一行，就好像它已经存在一样。
与在上述编辑器之一中打开它相比，使用像 vim 这样表现良好的文本编辑器的“正确”文本文件非常明显。它在文件的实际最后一行下方显示了一个额外的行。你会看到这样的东西：

```
1 first line
2 middle line
3 last line
4 
```

* * *

## 回答 #5

> 赞同：49
> 
> 时间：2011-10-12T14:16:58.083

一些工具期望这一点。例如，`wc`期望这样：

```
$ echo -n "Line not ending in a new line" | wc -l
0
$ echo "Line ending with a new line" | wc -l
1 
```

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2016-09-05T13:17:51.007

一个单独的用例：当您的文本文件受版本控制时（在这种情况下，特别是在 git 下，尽管它也适用于其他文件）。如果将内容添加到文件的末尾，则之前最后一行的行将被编辑为包含换行符。这意味着`blame`对文件进行查找以找出该行最后一次编辑的时间将显示文本添加，而不是您实际想要查看的之前的提交。

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2009-04-08T12:21:13.293

基本上有很多程序如果没有得到最终的 EOL EOF，就无法正确处理文件。

GCC 会对此发出警告，因为它是 C 标准的一部分。（显然是第 5.1.1.2 节）

[“文件末尾没有换行符”编译器警告](https://stackoverflow.com/questions/72271/no-newline-at-end-of-file-compiler-warning)

* * *

## 回答 #8

> 赞同：21
> 
> 时间：2016-03-05T21:53:37.450

我自己多年来一直想知道这一点。但我今天遇到了一个很好的理由。

想象一个每行都有一条记录的文件（例如：CSV 文件）。并且计算机正在文件末尾写入记录。但它突然崩溃了。哎呀，最后一行完成了吗？（不是一个好的情况）

但是如果我们总是终止最后一行，那么我们就会知道（只需检查最后一行是否终止）。否则，为了安全起见，我们可能每次都必须丢弃最后一行。

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2009-04-08T12:41:21.063

这源于使用简单终端的早期阶段。换行符用于触发传输数据的“刷新”。

今天，换行符不再需要了。当然，如果没有换行符，许多应用程序仍然存在问题，但我认为这是这些应用程序中的一个错误。

但是，如果您有一个**需要**换行符的文本文件格式，那么您可以非常便宜地获得简单的数据验证：如果文件以没有换行符的行结尾，您就知道文件已损坏。每行只需一个额外的字节，您就可以高精度地检测损坏的文件，并且几乎不需要 CPU 时间。

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2015-09-25T12:23:09.343

除了上述实际原因之外，如果 Unix 的创始人（Thompson、Ritchie 等人）或他们的 Multics 前辈意识到使用行终止符而不是行分隔符有理论上的原因，我不会感到惊讶：终止符，您可以对所有可能的行文件进行编码。使用行分隔符，零行文件和包含单个空行的文件没有区别；它们都被编码为包含零个字符的文件。

所以，原因是：

1.  因为这就是 POSIX 定义它的方式。
2.  因为一些工具期望它或没有它“行为不端”。例如，`wc -l`如果最后的“行”不以换行符结尾，则不会计算它。
3.  因为它简单方便。在 Unix 上，`cat`它可以正常工作并且没有复杂性。它只是复制每个文件的字节，不需要任何解释。我认为没有 DOS 等效于`cat`. 使用`copy a+b c`最终会将 file 的最后一行与 file`a`的第一行合并`b`。
4.  因为零行的文件（或流）可以与一个空行的文件区分开来。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2011-11-04T10:12:54.267

最后缺少换行符的文件还有一个实际的编程问题：`read`内置的 Bash（我不知道其他`read`实现）无法按预期工作：

```
printf $'foo\nbar' | while read line
do
    echo $line
done 
```

*这仅`foo`*打印！原因是当`read`遇到最后一行时，它将内容写入`$line`但返回退出代码1，因为它到达了EOF。这打破了`while`循环，因此我们永远无法到达该`echo $line`部分。如果要处理这种情况，则必须执行以下操作：

```
while read line || [ -n "${line-}" ]
do
    echo $line
done < <(printf $'foo\nbar') 
```

也就是说，`echo`如果`read`由于文件末尾的非空行而失败，请执行此操作。自然地，在这种情况下，输出中会有一个额外的换行符，而输入中没有。

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2009-04-08T12:19:54.310

大概只是一些解析代码期望它在那里。

我不确定我是否会将其视为“规则”，而且这当然不是我虔诚地遵守的。大多数明智的代码都知道如何逐行解析文本（包括编码）（任何行尾选择），最后一行有或没有换行符。

确实-如果您以新行结尾：（理论上）EOL 和 EOF 之间是否有空的最后一行？一个值得深思...

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2015-06-20T15:26:39.273

> 为什么（文本）文件应该以换行符结尾？

许多人也表示，因为：

1.  许多程序表现不佳，或者没有它就会失败。

2.  即使可以很好地处理文件的程序也缺少结尾`'\n'`，该工具的功能也可能无法满足用户的期望——在这种极端情况下可能不清楚。

3.  程序很少*不允许*final `'\n'`（我不知道）。

* * *

然而这引出了下一个问题：

> 对于没有换行符的文本文件，代码应该怎么做？

1.  最重要的 -**不要编写假定文本文件以换行符结尾的代码**。 *假设*文件符合某种格式会导致数据损坏、黑客攻击和崩溃。例子：

    ```
    // Bad code
    while (fgets(buf, sizeof buf, instream)) {
      // What happens if there is no \n, buf[] is truncated leading to who knows what
      buf[strlen(buf) - 1] = '\0';  // attempt to rid trailing \n
      ...
    } 
    ```

2.  如果需要最后的尾随`'\n'`，请提醒用户它的缺失和所采取的措施。IOW，验证文件的格式。注意：这可能包括对最大行长度、字符编码等的限制。

3.  清楚地定义，记录，代码对缺少的 final 的处理`'\n'`。

4.  尽可能不要*生成*缺少结尾的文件`'\n'`。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2018-11-23T07:43:33.377

这里已经很晚了，但我刚刚在文件处理中遇到了一个错误，这是因为文件没有以空换行符结尾。我们正在处理文本文件，`sed`并`sed`省略了输出中的最后一行，这导致了无效的 json 结构，并将进程的其余部分发送到失败状态。

我们所做的只是：

有一个示例文件说：里面`foo.txt`有一些`json`内容。

```
[{
    someProp: value
},
{
    someProp: value
}] <-- No newline here 
```

该文件是在寡妇机器中创建的，窗口脚本正在使用 PowerShell 命令处理该文件。都好。

当我们使用`sed`命令处理相同的文件时`sed 's|value|newValue|g' foo.txt > foo.txt.tmp`

新生成的文件是

```
[{
    someProp: value
},
{
    someProp: value 
```

并且繁荣，由于无效的JSON，它使其余的过程失败。

因此，以空的新行结束文件始终是一个好习惯。

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2021-04-30T16:58:36.497

> 为什么文本文件应该以换行符结尾？

# 因为这是最明智的选择。

取一个包含以下内容的文件，

```
one\n
two\n
three 
```

where`\n`表示换行符，在 Windows 上是`\r\n`，返回字符后跟换行符，因为它很酷，对吧？

这个文件有多少行？Windows 说 3，我们说 3，POSIX (Linux) 说文件已损坏，因为文件`\n`末尾应该有 a。

无论如何，你会说它的最后一行是什么？我想有人同意这`three`是文件的最后一行，但 POSIX 说这是一条残缺的行。

它的第二行是什么？哦，这里我们有第一个强[分离](https://pillsofmovies.com/wp-content/uploads/2017/06/una-settimana-da-dio.jpg)：

*   Windows 说`two`因为文件是“由换行符分隔的行”（wth？）；
*   POSIX says `two\n`, adding that that's a true, honest line.

## What's the consequence of Windows choice, then? Simple:

***You cannot say that a file is made up of lines***

Why? Try to take the last line from the previous file and replicate it a few times... What you get? This:

```
one\n
two\n
threethreethreethree 
```

Try, instead, to swap second and third line... And you get this:

```
one\n
threetwo\n 
```

Therefore

***You must say that a text file is an alternation of lines and `\n`s, which starts with a line and ends with a line***

which is quite a mouthful, right?

And you want another strange consequence?

***You must accept that an empty file (0 bits) is a one-line file, magically, always because they are cool at Microsoft***

Which is quite a crazyness, don't you think?

## What is the consequence of POSIX choice?

That the file on the top is just a bit crippled, and we need some hack to deal with it.

## 认真

在前面的文本中，我是在挑衅，因为处理`\n`末尾缺少 的文本文件会迫使您使用*临时*记号/黑客来对待它们。您总是需要一个`if`/`else`某处才能使事情正常进行，其中处理残废线路的分支仅处理残废线路，所有其他线路都使用另一个分支。这有点种族主义，不是吗？

## 我的结论

我赞成使用 POSIX 定义一行，原因如下：

*   文件自然地被认为是一系列行
*   一行不应该是一回事，具体取决于它在文件中的位置
*   空文件不是一行文件，加油！
*   你不应该被迫在你的代码中进行黑客攻击

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2009-07-01T17:10:42.790

我一直觉得这条规则来自于解析没有结束换行符的文件很困难的日子。也就是说，您最终会编写代码，其中行尾由 EOL 字符或 EOF 定义。假设一行以 EOL 结尾更简单。

但是我相信该规则源自需要换行符的 C 编译器。[正如在“文件末尾没有换行符”编译器警告](https://stackoverflow.com/questions/72271/no-newline-at-end-of-file-compiler-warning)中指出的那样，#include 不会添加换行符。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-04-08T12:36:30.573

想象一下，当文件仍在由另一个进程生成时，正在处理该文件。

可能跟这个有关？指示文件已准备好进行处理的标志。

* * *

## 回答 #18

> 赞同：-5
> 
> 时间：2009-04-08T12:23:08.673

我个人喜欢源代码文件末尾的新行。

它可能起源于 Linux 或所有 UNIX 系统。我记得有编译错误（如果我没记错的话是 gcc），因为源代码文件没有以空的新行结尾。为什么它是这样制作的，值得怀疑。

* * *

## 回答 #19

> 赞同：-7
> 
> 时间：2009-04-08T12:38:48.820

恕我直言，这是个人风格和观点的问题。

在过去，我没有放那个换行符。保存一个字符意味着通过 14.4K 调制解调器的速度更快。

后来，我放了那个换行符，以便使用 shift+downarrow 更容易选择最后一行。

# sql - 以后如何将选择查询结果添加到数据集中再次选择查询运行

> ID：729698
> 
> 赞同：0
> 
> 时间：2009-04-08T12:18:04.707
> 
> 标签：sql, sql-server, sql-server-2005

我想将选择查询结果添加到数据集中，所以我可以编写新查询以在其上运行以获取网络数据集，但是如何？

**原始查询：**

```
 **MyDATASET=(**
select x, y,z from table1
union all
select k,l,m from table2
)
**i wan to this** select * from this.MyDATASET 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T12:23:35.083

那么，您也许可以创建一个 CTE、UDF 或视图？但它真的不清楚你想做什么......

```
CREATE VIEW MyView AS
    select x, y,z from table1
    union all
    select k,l,m from table2
GO

SELECT * FROM MyView
SELECT * FROM MyView WHERE x = 0 
```

ETC

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T12:51:28.637

假设您要缓存数据以供以后重复使用...

如果临时表或表变量包含在一位代码中，请使用它。

如果您想在多个进程或调用中引用相同的数据，请使用临时表。对许多呼叫使用本地呼叫但不要关闭连接，对许多不同的进程/连接使用全局呼叫。

如果它只是您想要重复使用相同数据的一个大选择，那么请使用 CTE。

视图也可以工作，但数据可能会在执行之间发生变化。

# vb.net - VB.NET 中的代码级跟踪

> ID：729709
> 
> 赞同：0
> 
> 时间：2009-04-08T12:22:36.363
> 
> 标签：vb.net, master-pages, trace

如何在 VB.NET 中为网站定义跟踪常量以启用跟踪输出？我知道它在哪里用于 Web 应用程序，但我无法在网站上找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T19:52:18.610

网站是网络应用程序。您可以在 web.config 中启用它：

```
<system.web>
 <trace enabled="true" pageOutput="true"/>
</system.web> 
```

# javascript - 如何使用滚动条图像？

> ID：729713
> 
> 赞同：1
> 
> 时间：2009-04-08T12:23:09.047
> 
> 标签：javascript, html, css

如何使用 HTML/CSS 替换滚动条的图像？

我有：

```
scrollbar-base-color: #00acee;  
scrollbar-dark-shadow-color: #00acee;  
scrollbar-track-color: #ffffff;  
scrollbar-face-color: #00acee;  
scrollbar-shadow-color: #00acee;  
scrollbar-highlight-color: #00acee;  
scrollbar-3d-light-color: #00acee; 
```

我可以使用图像来实现相同的想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T12:26:14.717

不，您不能使用图像代替滚动条。我还要提一下，更改颜色对用户来说非常烦人，而且它只能在 IE 中使用，所以只要坚持使用标准的 GUI 元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-23T08:01:55.853

对于基于 webkit 的浏览器（对于“webkit”的足够新的值），有一组[适当的 CSS 属性](http://webkit.org/blog/363/styling-scrollbars/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-23T07:51:27.250

不，您不能在滚动条中使用图像。（此外，即使在非标准模式下的 IE 中也支持更改颜色。）

在滚动条中使用图像的唯一方法是根本不使用标准滚动条，而是使用 DHTML 自己实现一个替换滚动条，或者找到已经这样做的人。

但是，在更改用户已经习惯的控件外观时，您应该有所限制。如果你不小心，你最终可能会让人们感到困惑，以至于他们甚至根本不会将其识别为滚动条......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T12:26:54.437

据我所知，您无法使用图像设置滚动条的样式。如果你想使用 jquery，你可以使用这个 jquery 插件轻松地做到这一点：

[http://www.kelvinluck.com/assets/jquery/jScrollPane/basic.html](http://www.kelvinluck.com/assets/jquery/jScrollPane/basic.html)

诀窍是使用一些 div 来“模拟”滚动条，因为它们只是普通的 div，因此您可以随意设置样式。之后很容易使用 scrollTop 属性和滚动事件等（但你真的不需要知道它是如何使用它的）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T12:30:18.747

无法将图像放在滚动条内。自定义滚动条不是 W3C 规范（仅限 IE CSS），但可以在此处找到有关可能的详细信息：

[http://www.quirksmode.org/css/scrollbars.html](http://www.quirksmode.org/css/scrollbars.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-23T07:39:25.453

[jScrollPane](http://www.kelvinluck.com/assets/jquery/jScrollPane/jScrollPane.html) ([演示](http://www.kelvinluck.com/assets/jquery/jScrollPane/examples.html))

或者

[界面](http://interface.eyecon.ro/)（[演示](http://interface.eyecon.ro/demos/scrollbar.html)）。

两者都使用 jQuery。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-23T07:44:37.377

对于[MooTools](http://www.mootools.net/)，有[MooScroller](http://www.clientcide.com/wiki/cnet-libraries/08-layout/02-mooscroller)。

史蒂夫

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-23T09:14:57.660

Webkit == Safari 和 Chrome，但 Firefox 和 Opera 计划在即将发布的版本中实现类似的功能。该规范是一个杀手，所以即使你有支持它也可能不值得使用。

Mootools 有很多：

1.  [Mooscroller](http://www.clientcide.com/wiki/cnet-libraries/08-layout/02-mooscroller)（将在 Mootools 中实现 -more），
2.  [MooScroll](http://greengeckodesign.com/projects/mooscroll.aspx)（基于 [Solutaire 的](http://solutoire.com/2008/03/10/mootools-css-styled-scrollbar/)？）
3.  [UvumiScroll](http://tools.uvumi.com/scrollbar.html)
4.  [MochaUI的](http://greghoustondesign.com/examples/mootools/scrollbars/)

我想它是 Ext UI 的一部分，可能是 JQ 的 UI 库，但在那里没有个人经验。

一个非库依赖类：[http ://www.hesido.com/web.php?page=customscrollbar](http://www.hesido.com/web.php?page=customscrollbar)

# database-design - 数据库设计

> ID：729715
> 
> 赞同：0
> 
> 时间：2009-04-08T12:23:50.230
> 
> 标签：database-design, search

我正在开发用于大学搜索的网络搜索工具...

工具应该支持搜索大学... 1\. 按课程 2\. 按费用 3\. 按名称

我是否必须遵循任何数据库算法才能使我的搜索如此高效...当大学数据变得如此庞大时，我是否必须使用数据挖掘技术...请指导我...我真的欢迎您的所有建议。 ..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T12:27:24.433

抛开你的问题几乎无法辨认，事情就是这样。

数据挖掘不仅仅是搜索。这是完全不同的事情，它不适用于您定义的任务。您需要的是一个健全的数据库模式（第三种范式），具有适当的索引（如果需要，还需要一些非规范化），并且可能还有外部全文搜索工具（想想 Lucene）。

# c++ - 等待 pthread_create 完成而不使用 pthread_join

> ID：729721
> 
> 赞同：1
> 
> 时间：2009-04-08T12:25:11.397
> 
> 标签：c++, multithreading

我想停止一个线程，直到另一个线程完成初始化而不使用 pthread_join。我尝试使用连接，但由于我们拥有一些异步线程间通信系统，它会导致死锁。现在，我正在使用（自定义）锁来实现这一点。

在线程 1 中：

```
lock_OfflineWorker.Lock()
if (pthread_create(&tid0, NULL, RunOfflineWorker, NULL) != 0)
{
}

lock_OfflineWorker.TryLock();
lock_OfflineWorker.Unlock(); 
```

在线程 2 中：

```
bool OfflineWorker::Initialize()
{
  lock_OfflineWorker.Unlock();
} 
```

但这是不雅的，我不太确定副作用（另一个僵局的可能性）。这个可以吗？如果没有，是否有另一种方法来实现这一点（使用锁或其他方式）

编辑：忘记包括“RunOfflineWorker”功能

```
void* RunOfflineWorker(void* pData)
{   
  g_OfflineWorker.Initialize();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T12:36:10.357

您可以使用 pthread 条件等待作业达到所需状态。

线程 1 等待，线程 2 用`pthread_cond_wait()`发出信号`pthread_cond_signal()`。

你需要 ：

```
bool            condition ; // or anything else to be tested
pthread_mutex_t mutex ;
pthread_cond_t  cond ; 
```

第一个线程初始化所有：

```
condition = false ;
pthread_mutex_init( &mutex , PTHREAD_MUTEX_INITIALIZER );
pthread_cond_init( &cond , PTHREAD_COND_INITIALIZER ); 
```

然后它等待互斥锁锁定。通常，您将等待置于循环中以检查条件。

```
pthread_mutex_lock( &mutex );
while( ! condition )
{
    pthread_cond_wait( &cond , &mutex );
}
pthread_mutex_unlock( &mutex ); 
```

另一个线程在适当的时候这样做：

```
pthread_mutex_lock( &mutex );
condition = true ; // or false ...
pthread_cond_signal( &cond );
pthread_mutex_unlock( &mutex ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T12:47:21.530

我认为你的解决方案很好，除了你需要在线程 1中使用`lock_OfflineWorker.Lock()`而不是- with ，它实际上不会等待任何东西。您不能为此使用互斥锁，因为它需要由锁定它的同一线程释放，但是例如。基于信号量的锁就可以了。使用监视器（即 mutex+condvar）会更复杂。`lock_OfflineWorker.TryLock()``TryLock()`

关于死锁：如果 OfflineWorker 的初始化部分（即释放锁之前的代码）不在任何地方等待，则死锁是不可能的。如果您的解决方案存在实际死锁，则使线程 1 等待线程 2 的任何其他解决方案也会有它们（我可以想象这种情况）。

注释后编辑：如果在线程 1 等待线程 2 的初始化完成时将消息传递给它，则可能会出现死锁，特别是如果消息有一些有界缓冲区或消息传递函数等待回复时。在这种情况下，我建议放弃等待线程 2 的想法，并可能在初始化完成时传递一些将从线程 2 调用的回调。

# xaml - 在 XAML TabControl 中，如何设置焦点选项卡标题的样式？

> ID：729744
> 
> 赞同：0
> 
> 时间：2009-04-08T12:32:09.837
> 
> 标签：xaml, tabcontrol

我可以使用TabItem.Background设置每个TabItem的背景，但*选择*该选项卡时，它是纯粹的香草白色。

如何设置*焦点*选项卡标题的样式？

```
<TabControl DockPanel.Dock="Top">
    <TabControl.Background>
        <LinearGradientBrush EndPoint="1.115,1.13" StartPoint="0,-0.02">
            <GradientStop Color="#FFFFFFFF" Offset="1"/>
            <GradientStop Color="#FFE0E376" Offset="0"/>
        </LinearGradientBrush>
    </TabControl.Background>

    <TabItem Header="Allgem." Cursor="Hand">
        <TabItem.Background>
            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                <GradientStop Color="#FFF3F3F3" Offset="0"/>
                <GradientStop Color="#FFF11818" Offset="1"/>
            </LinearGradientBrush>
        </TabItem.Background>
        <StackPanel DockPanel.Dock="Bottom" Width="400" HorizontalAlignment="Left" Margin="10">
            ... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T12:52:27.307

您可以使用触发器仅更改选定选项卡的样式：

```
<TabControl DockPanel.Dock="Top">
    <TabControl.Resources>
        <Style TargetType="{x:Type TabItem}">
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
                                <GradientStop Color="#FFF3F3F3" Offset="0"/>
                                <GradientStop Color="#FFF11818" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
    </TabControl.Resources>
    <TabControl.Background>
        <LinearGradientBrush EndPoint="1.115,1.13" StartPoint="0,-0.02">
            <GradientStop Color="#FFFFFFFF" Offset="1"/>
            <GradientStop Color="#FFE0E376" Offset="0"/>
        </LinearGradientBrush>
    </TabControl.Background>
    <TabItem Header="Allgem." Cursor="Hand">
        <StackPanel DockPanel.Dock="Bottom" Width="400"
            HorizontalAlignment="Left" Margin="10">
        ...
        </StackPanel>
    </TabItem>
</TabControl> 
```

这会将所选选项卡的背景设置为示例代码中使用的红色渐变。

# compact-framework - Windows Installer XML 是否支持 CE 安装文件？

> ID：729752
> 
> 赞同：0
> 
> 时间：2009-04-08T12:34:16.197
> 
> 标签：compact-framework, wix, cab

我想知道 Wix 是否支持 CE 平台。即基于组件列表生成可安装在 Win CE 和/或 Win Mobile 上的 cab 文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T15:40:59.960

不，Wix 无法生成 Windows CE CAB 安装程序文件。不幸的是，唯一能做到这一点的是[cabwiz.exe](http://msdn.microsoft.com/en-us/library/aa924359.aspx)（我真的希望他们为它创建一个 API）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T16:08:03.607

今天不行。这是我们已经考虑过但还没有时间去做的事情……还没有。

# python - 如何让 scons 调用外部脚本？

> ID：729759
> 
> 赞同：16
> 
> 时间：2009-04-08T12:36:53.880
> 
> 标签：python, latex, scons, tex

我正在尝试使用 scons 来构建乳胶文档。特别是，我想让 scons 调用一个 python 程序，该程序生成一个文件，该文件包含一个表，该表是 \input{} 到主文档中。我查看了 scons 文档，但我并不清楚我需要做什么。

我希望实现的基本上是您使用此 makefile 将获得的结果：

```
document.pdf:  table.tex
    pdflatex document.tex

table.tex:
    python table_generator.py 
```

我如何在 scons 中表达这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-08T14:33:08.250

沿着这些思路应该做的事情 -

```
env.Command ('document.tex', '', 'python table_generator.py')
env.PDF ('document.pdf', 'document.tex') 
```

它声明“document.tex”是通过调用 Python 脚本生成的，并请求从此生成的“document.tex”文件创建 PDF 文档。

请注意，这只是精神上的。它可能需要一些调整。特别是，我不确定生成'document.tex'需要什么样的语义 - 是否应该每次都生成？只有当它不存在时？当其他文件更改时？（在这种情况下，您可能希望将此依赖项添加为 Command() 的第二个参数）。

此外，如果需要，可以将 Command() 的输出用作 PDF() 的输入。为了清楚起见，我没有这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T13:14:31.420

在这种简单的情况下，最简单的方法是只使用 subprocess 模块

```
from subprocess import call
call("python table_generator.py")
call("pdflatex document.tex") 
```

无论这些行放在 SConstruct 文件中的什么位置，它们都会发生在 SCons 执行的任何编译和链接之前。

缺点是这些命令将在您每次运行 SCons 时执行，而不是仅在文件更改时执行，这在您的示例 Makefile 中会发生。因此，如果这些命令需要很长时间才能运行，这将不是一个好的解决方案。

如果您真的只需要在文件更改时运行这些命令，请查看 SCons 手册部分[编写您自己的构建](http://www.scons.org/doc/production/HTML/scons-user.html#chap-builders-writing)器。

# vb.net - 使用 vc++ 计算系统空闲时间

> ID：729761
> 
> 赞同：0
> 
> 时间：2009-04-08T12:37:15.580
> 
> 标签：vb.net, winapi, visual-c++, mfc

我需要获取系统空闲时间。它必须在 vc++ 中开发，代码不应该使用钩子是否有任何可能的方法从任务管理器获取 SystemIdleTime

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T12:39:37.430

[谷歌](http://www.google.com/search?hl=en&safe=off&q=system+idle+time+windows+c%2B%2B&btnG=Search)来拯救。

# c# - 界面问题

> ID：729767
> 
> 赞同：0
> 
> 时间：2009-04-08T12:39:13.657
> 
> 标签：c#, interface

我有一个名为 Foo 的对象。现在它实现了 IFoo ，它有很多属性。

我有一个只依赖于其中一些属性的类，所以我创建了 IMeasurableFoo （它只有几个属性）

为避免重复代码，我现在有 IFoo : IMeasurableFoo，因为我将属性移动到 IMeasurableFoo

但这从继承的角度来看是错误的，因为您有一个从特定接口继承的更通用的接口

关于组织这些抽象的最佳方式的任何想法

例如，如果这些是结核：

Bird 不会从 FlyingBird 继承（反之亦然）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T12:42:09.670

不，它不是“从特定接口继承的更通用的接口”。`IMeasurableFoo`，只有几个属性，是*通用*接口，而`IFoo`更具体，因为它提炼了关于`IMeasurableFoo`. 认为`IList`继承自`IEnumerable`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T12:42:43.493

也许改名字？IMeasurableFoo 听起来确实是一个更具体的接口，但你不能直接称它为 IFoo 并重命名原来的 IFoo 接口吗？还是两者都重命名？

IMeasurableFoo 真的是 IFoo 还是（也许）IMeasurable？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T12:42:34.787

不要仅仅为了避免重复代码而使用接口继承。如果两个接口之间没有关系，则不需要实现继承。

如果 Foo 不是 MeasurableFoo 则没有继承需求。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T12:42:40.233

不，我不认为这有什么问题。可能只是名称具有`IMeasurableFoo`误导性，因为它只是可测量的，而不是完整的`Foo`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T12:43:24.317

我不认为 IMeasurableFoo 不那么通用。由于 IFoo 包含 IMeasurableFoo，我认为 IMeasurebleFoo 更通用。

感觉就像你有 IBaseInterface 和 IExtendedInterface : IBaseInterface。

换句话说，我认为你有正确的方法。

编辑：使用您的示例 IBird 和 IFlyingBird，您只是遇到了命名问题。它应该是：

```
public interface IFlyer
{
    void Fly();
}

public interface IBird : IFlyer
{
    void Chirp();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T12:43:26.890

在这种情况下，我认为事物的命名是问题而不是事物本身。换句话说，具有较少成员的接口往往比具有更多成员的接口更抽象。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-08T12:45:46.730

这里有什么奇怪的？接口继承增加了每个继承级别的方法和属性的数量。

将 IMeasurableFoo 重命名为 IBar 并且更具体/更通用的感觉将消失

# asp.net - 如何使用 jquery“jsonp”调用外部 web 服务？

> ID：729771
> 
> 赞同：2
> 
> 时间：2009-04-08T12:40:19.177
> 
> 标签：asp.net, javascript, jquery, web-services

我有一个先前的问题[jquery ajax 可以调用外部 Web 服务吗？](https://stackoverflow.com/questions/727183/can-jquery-ajax-call-external-webservice)

一些优秀的开发人员回答我使用 jsonp，但我不知道如何使用它，我正在尝试使用以下代码调用我的服务：

```
$.ajax({
            type: "POST",
            url: "http://localhost:1096/MySite/WebService.asmx?callback=?",
            data: "{}",
            contentType: "application/json; charset=utf-8",
            dataType: "jsonp",
            success: function(msg) {alert(msg);}
            }); 
```

这是我的服务代码：

```
[WebMethod]
public string HelloWorld() {
    return "Hello World " ;
} 
```

有人有例子或可以为我解释这个问题吗？

**更新**：
我再次编写代码是这样的：

```
$.getJSON("http://localhost:1096/YourShoppingTest1/WebService.asmx/HelloWorld?jsonp=?",{name:"test"},
    function(data){
    alert(data.x);
    }); 
```

和这样的服务：

```
[WebMethod]
public string HelloWorld(string name)
{
    return "( {\"x\":10 , \"y\":100} )";
} 
```

但是当它回来时总是给我这个错误：“缺少;在声明[Break on this error]（{“x”：10，“y”：100}）之前

并且永远不要调用成功函数，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T13:04:36.950

我有一个类似的问题，不幸的是我手头没有代码。

从记忆里：

*   将 [ScriptService] 作为属性添加到您的 Web 方法
*   还要更改您的 url 以调用 HelloWorld 过程。
    类似[http://localhost:1096/MySite/WebService.asmx/HelloWorld?callback](http://localhost:1096/MySite/WebService.asmx/HelloWorld?callback)

请参阅：[使用 JSONP 与 .net 对话的 JQuery 有哪些好的示例？](https://stackoverflow.com/questions/448879/what-are-some-good-examples-of-jquery-using-jsonp-talking-to-net)&[使用 jquery 调用 .net web 服务的最佳方式是什么？](https://stackoverflow.com/questions/426420/what-is-the-best-way-to-call-a-net-webservice-using-jquery)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-13T13:49:31.937

JSONP 的重点是 P! P 与填充一样。您正在使用函数调用填充 JSON 对象文字 - 在调用页面上调用一个函数，将数据对象作为参数。

即，如果您请求网络服务，请在查询字符串中发送所需的回调函数名称

```
...service/?callback=hello 
```

然后服务应该回答（使用适当的 mime 类型）：

```
hello({a: 17, b: 4117}); 
```

更深入的解释见： http: [//www.stpe.se/2008/10/cross-site-data-retrieval-using-jsonp/](http://www.stpe.se/2008/10/cross-site-data-retrieval-using-jsonp/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T13:39:32.763

您不能使用 JSONP 发出 POST 请求，只能使用 GET（因为`<script src="...">` GET 获取资源）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-13T11:34:28.593

Hezil 的代码对我有用，但我不得不将服务器代码更改为：

```
$data = '{"name" : "hello world"}'; echo $_GET['callback'] . '(' . $data . ');'; 
```

注意“回调”而不是“jsoncallback”。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-12T08:44:40.157

首先，您应该在您的网络服务器中添加 jsonp ('callback')，例如 $_GET['callback']

第二，不要忘记';' 在输出脚本之后

```
$data = '{"name" : "hello world"}';
echo $_GET['jsoncallback'] . '(' . $data . ');'; 
```

现在您可以找出为什么会出现“缺少 ; before statement”问题。

html:

```
$.getJSON({"http://localhost:1096/MySite/WebService.asmx?callback=?",
        function(data){alert(data);}
        }); 
```

# sql - SQL 服务器探查器未显示 LINQ To Sql 查询

> ID：729774
> 
> 赞同：27
> 
> 时间：2009-04-08T12:41:51.543
> 
> 标签：sql, sql-server, sql-server-2005, linq-to-sql, sql-server-profiler

我正在尝试在 SQL Server Profiler (2005) 中查看由 Linq to SQL 生成的 SQL。

除了 linq to sql，我可以看到从任何东西发送到服务器的 sql。

我打赌我需要更改跟踪的事件选择，但不确定还有什么要选择的。

我目前只选择这个：SQL:StmtCompleted - TextData & SPID

我不想使用数据上下文日志记录，也不想使用 SQL Debug Visualizer。我需要使用分析器。

为什么我看不到 LINQ to SQL 查询？

谢谢。

### 编辑

我添加了 SQL:BatchCompleted 并没有帮助。

### 编辑 2

我添加了事件 RPC:Completed，它位于事件选择的存储过程类别下。这行得通！

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-04-08T12:52:41.190

您需要 RPC 调用 - 查询作为 exec_sql 执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T12:42:49.013

您是否在 SQL Profiler 中包含了足够多的选项来查看 BatchCompleted 事件？

马克

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T14:36:13.970

数据上下文类中还有一个选项可以在客户端启用日志。启用日志时，可以查看查询。

请参阅此链接：

[http://www.davidhayden.com/blog/dave/archive/2007/08/17/DataContextLogLoggingLINQToSQLOutputConsoleDebuggerOutputWindow.aspx](http://www.davidhayden.com/blog/dave/archive/2007/08/17/DataContextLogLoggingLINQToSQLOutputConsoleDebuggerOuputWindow.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-26T19:58:09.770

有同样的问题，上面的解决方案都不适合我。

对我有用的是将 ToList() 枚举器添加到查询中。

前：

```
var data = null == id ?
                   (from ...
                    select new
                    {
                        ...
                    })
                :
                   (from ..
                    select new
                    {
                        ...
                    }); 
```

后：

```
var data = null == id ?
                   (from ...
                    select new
                    {
                        ...
                    }).ToList()
                :
                   (from ..
                    select new
                    {
                        ...
                    }).ToList();

foreach (var obj in data)
{
   xxx = obj.somename; --> now you can see the sql query in Profiler 
```

# c# - 浅拷贝 - 引用类型异常性质

> ID：729788
> 
> 赞同：3
> 
> 时间：2009-04-08T12:45:03.050
> 
> 标签：c#, shallow-copy

我无法理解下面给出的两组代码片段的输出。怎么没有真正理解浅拷贝的概念。怎么解释？

班级：

```
 public class Person : ICloneable
 {
    public string Name;        
    public int[] arr; 
    public object Clone()
    {
        return this.MemberwiseClone();
    }
 } 
```

代码片段 1：

```
 static void Main(string[] args)
    {
        Person p1 = new Person();
        p1.Name = "Name1";
        p1.arr = new int[5] {1,2,3,4,5 };
        Person p2 = (Person)p1.Clone();

        p1.Name = "Name2";
        p1.arr[0] = 11;

        Console.WriteLine(p2.Name);
        Console.WriteLine(p2.arr[0].ToString());
        Console.Read();

    } 
```

输出：名称1 11

怀疑：字符串不是引用类型。那么为什么 p2.Name 在片段 1 中打印为“Name1”

代码片段 2：

```
static void Main(string[] args)
    {
        Person p1 = new Person();
        p1.Name = "Name1";
        p1.arr = new int[5] { 1, 2, 3, 4, 5 };
        Person p2 = (Person)p1.Clone();

        p1.Name = "Name2";
        p1.arr = new int[5] { 11, 12, 13, 14, 15 };

        Console.WriteLine(p2.Name);
        Console.WriteLine(p2.arr[0].ToString());
        Console.Read();

    } 
```

输出：名称1 1

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T12:59:43.857

您示例中的 int[] 数组是引用类型。这意味着，两者都`p1.arr`指向`p2.arr`内存中的同一个数组。

如果更改 的第一个索引的值`p1.arr`，这意味着 的第一个索引的`p2.arr`值也会更改。因此，代码片段 1 中的行为。

第二个代码片段的不同之处在于您更改了对 p1 数组的*引用。*现在，`p1.arr`是对新对象的引用。`p2.arr`仍然持有对“原始”数组的引用。因此，打印`p2.arr[0]`打印 1。

**编辑**：

希望消除一些疑问，如果您记得键入以下内容，可能会更清楚：

```
p1.Name = "Name2"; 
```

实际上是：

```
p1.Name = new String("Name2"); 
```

这与您的 int[] 数组完全相同。您没有更改 的值`p1.Name`，而是创建了一个新的字符串对象，并将p1.Name*的引用更改为这个新的字符串对象。*p2.Name 仍然拥有自己对“原始”字符串对象的引用，即“Name1”。通过更改 的引用`p1.Name`，*该*引用不会改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T13:30:00.803

为了减轻您对原始问题的怀疑。

String 确实是一种引用类型，要记住的是，你对数组所做的事情和你对字符串所做的事情是不一样的。

```
p1.Name = "Name2"; // new String - 等价于 p1.Name = new string("Name2")
p1.arr[0] = 11；//更新数组元素

```

对于数组，您正在更改引用的内存中的数据。对于字符串，您正在创建一个新字符串（在新的内存位置）并使 p1.Name （引用）指向新分配的内存。p2.Name（这是一个不同的引用）仍然指向存储字符“Name1”的原始内存位置

顺便说一句，由于字符串的*不变性*，p1.Name 的更改不会出现在 p2.Name 中。任何更改字符串的尝试，例如 string.replace，都会在内存中创建一个新字符串。

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T12:49:26.440

来自[http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)

MemberwiseClone 方法通过创建一个新对象，然后将当前对象的非静态字段复制到新对象来创建一个浅拷贝。如果字段是值类型，则执行该字段的逐位复制。如果字段是引用类型，则复制引用但不复制引用的对象；因此，原始对象及其克隆引用同一个对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T19:29:43.513

请看内联评论：

```
static void Main(string[] args)
{
    Person p1 = new Person();
    p1.Name = "Name1";
    p1.arr = new int[5] {1,2,3,4,5 };
    Person p2 = (Person)p1.Clone();

    p1.Name = "Name2"; //Now p1.Name points to a new memory location
    //But p2.Name is still pointing to the location p1.Name had
    // originally pointed to.

    p1.arr[0] = 11; //here p1.arr and p2.arr are pointing to the same place
    //So since you are changing the value of one location it gets 
    //reflected in both

    Console.WriteLine(p2.Name); //Prints Name1
    Console.WriteLine(p2.arr[0].ToString()); //Prints 11
    Console.Read();

} 
```

在你说的第二个片段中

```
p1.arr = new int[5] { 11, 12, 13, 14, 15 }; 
```

p1.arr 指向一个全新的位置。（就像你做 p1.Name = "Name2" 时会发生什么）所以它没有反映在 p2.arr 上，它仍然指向 p1.arr 之前指向的同一个地方。（即到数组 {1,2,3,4,5}）

# c++ - Qt 带宽限制

> ID：729792
> 
> 赞同：2
> 
> 时间：2009-04-08T12:45:57.853
> 
> 标签：c++, qt, bandwidth

我正在使用 QNetworkAccessManager 从 Web 下载文件，它为任务提供了一个简单的 API。但我希望为类添加下载速率限制，因此所有 http 回复都不会超过该限制（我认为没有理由限制请求）。

我用谷歌搜索了一下，[在这里](http://doc.trolltech.com/qq/qq17-ratecontrol.html)发现了一个有趣的帖子。但它所做的是 QTcpSocket 的子类，并使用管理一组套接字的单独类来控制带宽。虽然这很好，但我想继续使用 QNetworkAcessManager 类。

我看到它的方式可以：

1.  子类 QNetworkAccessManager 并以某种方式集成子类 QTcpSocket（这可能涉及子类化更多类，QHttp* 类）。
2.  使用文章中提供的类并围绕它们构建我自己的 QNetworkAccessManager。
3.  QNetworkAccessManager 允许使用代理。我可以编写一个虚假的代理类，其中包含带宽限制逻辑。但这对我来说似乎是一个丑陋的黑客。

虽然前两个选项是可能的，但我想知道是否有更简单的方法可以做到这一点？如果不是，你会推荐哪一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T08:12:50.047

我最终将[本文](http://doc.trolltech.com/qq/qq17-ratecontrol.html)中的 RcTcpSocket 和 RateController与 QHttp 类一起使用。在使用 QHttp 发出 get/post 请求之前，我创建了一个 RcTcpSocket，将它添加到我的 RateController 并使用 QHttp::setSocket(QTcpSocket*)。我仍然没有找到继续使用 QNetworkAccessManager 的解决方案，但这已经足够接近并且效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T14:03:37.197

你应该看看 QNetworkReply::setReadBufferSize(qint64 size)。我引用文档：

> *一旦此缓冲区已满（即 bytesAvailable() 返回大小或更多），QNetworkReply 将尝试停止从网络读取，从而导致**下载也减速**。如果缓冲区的大小不受限制，QNetworkReply 将尝试尽可能快地从网络下载。*

我猜你可以使用这个值，也许你从 downloadProgress() 信号中得到的值可以减慢速度。我认为它应该很难得到精确的东西，但它可能是可行的。

# html - 在 MSBuild 步骤中将 HTML（WSDL/XSD 文档）转换为 MHT

> ID：729793
> 
> 赞同：-1
> 
> 时间：2009-04-08T12:46:07.727
> 
> 标签：html, web-services, documentation, msbuild-task, mhtml

伙计们，

我有一些从我的 WSDL 和 XSD 文件生成的用于 Web 服务的 HTML，我想在我的连续过程中将这两个 HTML 以及一些图像（公司徽标）和 CSS 文件转换为单个 MHT 文件集成，以便我可以将其分发给客户（公司外部使用此 Web 服务的其他开发人员）。

我想**自动**实现这一点，最好使用 MSBuild 任务或命令行实用程序。

有没有一种快速简单的方法来做到这一点？便宜或免费的工具，还是 C# 解决方案？

马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T12:52:45.777

看到 [这个](http://www.codeproject.com/KB/files/MhtBuilder.aspx)

（ps：它是由 Jeff Atwood 写的 :)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T12:49:01.947

我不知道便宜，但如果您已经拥有 MS Office 2007，您可以使用 Word 将 HTML 文件另存为 MHT

# c# - NHibernate DetachedCriteria - 如何在外连接集上使用 Oracle 的 NVL 之类的东西

> ID：729794
> 
> 赞同：0
> 
> 时间：2009-04-08T12:46:22.813
> 
> 标签：c#, nhibernate

我想创建 DetachedCriteria 来执行类似于以下 SQL 代码的操作：

```
select *
FROM PRICELIST pl
LEFT OUTER JOIN PRICELISTDURATIONSHIFT sh ON sh.PRICELISTID = pl.ID
WHERE sh.CUSTOMERID = :cust
  AND nvl(sh.DATEFROM, pl.DATEFROM) <= :dt
ORDER BY nvl(sh.DATEFROM, pl.DATEFROM) DESC 
```

我能够左外加入`PriceListDurationShift`类/表并添加客户约束，但我无法弄清楚如何添加类似 nvl(sh.DATEFROM, pl.DATEFROM) <= :dt 限制的内容.

对于这个示例的任何建议，以及关于高级 DetachedCriteria 查询的 NHibernate 材料的任何建议，我都将不胜感激。

* * *

希望这会奏效：

```
var priceLists = priceListRepo.FindAll(DetachedCriteria.For<PriceList>("pl")
    .CreateCriteria((PriceList x) => x.PriceListDurationShifts, () => shift,
        JoinType.LeftOuterJoin)
    .Add<PriceListDurationShift>(x => x.Customer == cust)
    .Add(Expression.Or(
        Expression.And(Restrictions.IsNull("shift.DateFrom"),
            Restrictions.Le("pl.DateFrom", dt.DateTo)),
        Expression.And(Restrictions.IsNotNull("shift.DateFrom"),
            Restrictions.Le("shift.DateFrom", dt.DateTo))
        ))
    )
    .ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T14:33:19.513

我也在寻找类似的东西，但还没有找到解决方案。

同时，我通过使用 HQL 而不是 Criteria API 解决了这个问题。

HQL 有一种方法`coalesce`可以用于此目的。

```
from PriceList as pl
left join pl.PriceListDurationShift as shift
where coalesce (shift.DateFrom, pl.DateFrom) <= :dt
order by coalesce (shift.DateFrom, pl.DateFrom) 
```

# php - php标头函数在不应该产生错误时

> ID：729801
> 
> 赞同：1
> 
> 时间：2009-04-08T12:48:44.693
> 
> 标签：php, header

我正在使用 PHP 4.3.11，当我执行[标头](http://ar.php.net/header)时，总是以这样的错误响应

**警告：**无法修改标头信息 - 标头已由第 2 行的 d:\folder\file.php 中的（输出开始于 d:\folder\file.php: **1**）**发送**

 ****警告：**无法修改标头信息 - 标头已由第**3**行**d:\folder\file.php**中的（输出开始于 d:\folder\file.php:1）发送 当前 PHP 版本：4.3.11

 **我用来产生这个错误的代码是

```
<?php
    header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
    header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");   // Date in the past

    echo 'Current PHP version: ' . phpversion();

    // prints e.g. '2.0' or nothing if the extension isn't enabled
    echo phpversion('tidy');
?> 
```

它在 php 标记之前或之后没有空格或换行符，并且 5.x 版本中的相同代码只返回预期的 php 版本。

有什么线索吗？

提前致谢

**编辑：** 已解决！：我用西欧编码打开了文件并删除了[BOM](http://en.wikipedia.org/wiki/Byte-order_mark)，它工作正常。感谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T12:50:14.643

确保 PHP 块之前没有空行和不可见字符（例如[UTF BOM](http://en.wikipedia.org/wiki/Byte-order_mark)），以便它`<?php`确实是文件中的第一个。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-08T12:51:20.617

文件开头是否有[UTF BOM ？](http://en.wikipedia.org/wiki/Byte-order_mark)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T12:54:38.440

如果您的文件不包含任何其他内容，但 php 代码建议跳过 php 结束标记以避免文件末尾出现空格问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T12:53:33.933

您收到的错误意味着您的整个脚本（包括其他文件）在调用 header() 函数之前发送了一些输出。

你应该修改你所有的文件，看看它们中的任何一个是否正在输出一些东西（使用 echo() 或 print()），或者你是否在最后一个结束标记之后错过了一些空格**？>**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T13:03:02.600

这不太可能，但有可能在 php.ini 中定义 auto_prepend_file （也可能是 .htaccess）。

[http://at2.php.net/manual/en/ini.core.php](http://at2.php.net/manual/en/ini.core.php) - 这就像`require()`在每个脚本的开头一样。您可以通过查看`phpinfo();`输出来检查这一点。

但我也认为问题出在 utf-8 BOM 上。

# c# - 在c#中打印变量的名称

> ID：729803
> 
> 赞同：13
> 
> 时间：2009-04-08T12:49:02.447
> 
> 标签：c#, variables, printing

我有一个声明

```
int A = 10,B=6,C=5; 
```

我想编写一个打印函数，以便我将 int 变量传递给它，它会打印出变量名和值。

例如，如果我调用 print(A)，它必须返回“A: 10”，然后 print(B) 必须返回“B:6”

简而言之，我想知道如何访问变量的名称并将其打印到 c# 中的字符串。我必须使用反射吗？

**看完答案后**

大家好，感谢提供的建议。我将尝试一下，但是我想知道在 .NET 2.0 中是否有可能？没有类似的

```
#define prt(x) std::cout << #x " = '" << x << "'" << std::endl; 
```

C/C++ 中有哪些宏？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-08T12:52:55.653

唯一明智的做法是使用`Expression`API；但这进一步改变了代码......

```
static void Main() {
    int A = 10, B = 6, C = 5;
    Print(() => A);
}
static void Print<T>(Expression<Func<T>> expression) {
    Console.WriteLine("{0}={1}",
        ((MemberExpression)expression.Body).Member.Name,
        expression.Compile()());
} 
```

注意：如果这是出于调试目的，请务必添加`[Conditional("DEBUG")]`到方法中，因为以这种方式使用变量会以微妙的方式改变代码的性质。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-08T12:59:31.563

您可以使用 lambda 表达式：

```
static void Main( string[] args ) {
    int A = 50, B = 30, C = 17;
    Print( () => A );
    Print( () => B );
    Print( () => C );
}

static void Print<T>( System.Linq.Expressions.Expression<Func<T>> input ) {
    System.Linq.Expressions.LambdaExpression lambda = (System.Linq.Expressions.LambdaExpression)input;
    System.Linq.Expressions.MemberExpression member = (System.Linq.Expressions.MemberExpression)lambda.Body;

    var result = input.Compile()();
    Console.WriteLine( "{0}: {1}", member.Member.Name, result );
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-08T12:51:31.303

如果没有呼叫站点的一些“帮助”，这是不可能的；甚至反射也不知道局部变量的名称。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T12:54:02.297

这不可能与反射有关（参见 Brian 和 Joel）。一般来说，这是不可能的，因为您不能保证将命名值传递给您的打印函数。例如，我可以轻松地执行以下操作

```
print(42);
print(A + 42); 
```

这些表达式实际上都没有名称。您希望在这里打印什么？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-12-10T06:20:48.970

另一个解决方案（来自已[关闭的帖子](https://stackoverflow.com/questions/1871566/hot-get-the-name-of-an-object/1871585#1871585)）：

受 Jon Skeet 关于 Null Reference 异常处理的[帖子](http://msmvps.com/blogs/jon_skeet/archive/2009/12/09/quot-magic-quot-null-argument-testing.aspx)的启发，突然被提醒有关投影，有一种方法可以做到这一点。

这是完整的工作代码：

```
public static class ObjectExtensions {
    public static string GetVariableName<T>(this T obj) {
        System.Reflection.PropertyInfo[] objGetTypeGetProperties = obj.GetType().GetProperties();

        if(objGetTypeGetProperties.Length == 1)
            return objGetTypeGetProperties[0].Name;
        else
            throw new ArgumentException("object must contain one property");
    }
}

class Program {
    static void Main(string[] args) {
        string strName = "sdsd";
        Console.WriteLine(new {strName}.GetVariableName());

        int intName = 2343;
        Console.WriteLine(new { intName }.GetVariableName());
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-04-20T06:23:25.017

如果您需要支持的类型多于`int`，请使用`Expression`API 但避免使用泛型并优雅地处理不同的表达式：

```
private static string ToDebugOutput(params Expression<Func<object>>[] variables)
{
    var sb = new StringBuilder();
    foreach (var input in variables)
    {
        string name;
        if (input.Body is UnaryExpression unary && unary.Operand is MemberExpression operand)
        {
            name = operand.Member.Name;
        }
        else if (input.Body is MemberExpression member)
        {
            name = member.Member.Name;
        }
        else
        {
            throw new NotSupportedException($"typeof lambda: {input.Body.GetType()}");
        }

        var result = input.Compile()();
        sb.Append($"{name}={result}, ");
    }

    return sb.ToString();
} 
```

用法：

```
string s = "123";
double d = 1.23;
int i2 = 123;
var out2 = ToDebugOutput(() => s, () => d, () => i2);
// out2 = "s=123, d=1.23, i2=123, " 
```

# .net - 使用 .Net 创建快捷方式

> ID：729813
> 
> 赞同：2
> 
> 时间：2009-04-08T12:50:30.353
> 
> 标签：.net, shortcut

我想使用 VBScript 代码在桌面上创建一个快捷方式。我的计算机中有一个虚拟驱动器。（虚拟驱动器就像 G 驱动器）我希望这个快捷方式可以直接探索该驱动器。为此，我发现使用以下字符串作为 TargetPath 的快捷方式对我有用：

C:\WINDOWS\explorer.exe /n,::{20D04FE0-3AEA-1069-A2D8-08002B30309D}::{89214D20-CAC1-4A33-8DF4-BD9D18A996B9}

在使用 vb 脚本创建快捷方式时，我需要将上面的字符串括在“”中，这对我不起作用。我需要从创建的快捷方式的目标中删除“”，然后它才能工作。有什么方法可以让我以编程方式创建快捷方式，可以探索虚拟驱动器（在我的系统中可用）。我需要在 Vista 操作系统中获取它。

问候 Sumeet Nandan Garg

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T12:56:18.607

[谷歌](http://www.google.com/search?q=create+shortcut+programmatically)给出了很多有趣的结果。例如，[这](http://www.msjogren.net/dotnet/eng/samples/dotnet_shelllink.asp)- 带有 P/Invoke 调用，似乎是一个答案。（这是给你的帖子标签`.NET`）

[这](http://www.tek-tips.com/viewthread.cfm?qid=1088541&page=1)是 VBScript 的示例：

```
Set shell = WScript.CreateObject("WScript.Shell")
Set link= shell.CreateShortcut("Explorer.lnk")
link.TargetPath = "c:\windows\explorer.exe"
link.Save 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-24T12:22:15.533

我现在使用 Win32 方法，即 (IWshShortcut)shell.CreateShortcut() 以编程方式生成 .lnk 文件来创建快捷方式文件。它就像魅力一样。谢谢。！！

# sql-server - 为 SQL Server 集群准备数据库

> ID：729822
> 
> 赞同：4
> 
> 时间：2009-04-08T12:51:22.630
> 
> 标签：sql-server, database, scalability, load-balancing, cluster-computing

我们计划在未来几个月内实施 sql server 2005 集群。我想知道作为数据库开发人员在尝试实现这一目标时需要采取哪些步骤/预防措施？我们是否需要更改任何 ado.net 代码（在前端）/存储的 procs 等？有什么最佳做法可以遵循吗？

我问这个问题的原因是：对于 asp.net 负载平衡，您必须确保会话/应用程序/缓存的代码都符合负载平衡环境。（因此，如果您使用的是 inproc 会话，则必须重写该代码以使其在负载平衡环境中工作）。现在这是在您的 Web 服务器级别。我只是想在尝试在数据库服务器级别扩展时做正确的事情

如果这个问题很愚蠢，我很抱歉。请原谅我对这个主题的有限知识:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T13:00:19.720

您无需对前端进行任何更改即可实现 SQL Server 集群，您只需像往常一样连接到 SQL Server 实例。

然而，SQL Server 故障转移群集不是负载平衡。如果主节点上的任何硬件出现故障，它用于添加冗余。在您的主节点发生故障之前，您的另一个（辅助）节点什么都不做，在这种情况下，故障转移会自动发生，并且您的数据库会在 10-20 秒延迟后再次提供连接。

另一个问题是辅助节点上的缓存是空的，因此您可能会在故障转移后看到一些性能影响。您可以使用[SQL Server 数据库镜像](http://msdn.microsoft.com/en-us/library/bb934127.aspx)在镜像服务器上实现“热”缓存，但无法对集群执行类似操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T13:00:51.733

数据库集群不同于负载平衡。这是高可用性，而不是“向外扩展”

基本上：

*   2台共享磁盘的服务器（或节点）（任何时候只能由一个节点拥有）
*   一个是“活动的”，运行虚拟 Windows 服务器和 SQL Server 实例
*   一个正在监视另一个（“被动”）
*   您连接到虚拟 Windows 服务器。

如果节点 1 下线，则节点 2 接管。或者可以手动进行故障转移。

This means: services are shut down on node 1, node 2 takes control of the disks and services and starts up. Any connections will be broken, and no state or session is transferred.

# rdbms - 位于 3NF 或 4NF 但不在 DKNF 中的 DB 表

> ID：729837
> 
> 赞同：2
> 
> 时间：2009-04-08T12:52:58.350
> 
> 标签：rdbms, database-normalization, 3nf

是否有 3NF 或 4NF 但不在域键范式中的关系表的示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T13:06:40.563

编辑，9 年后 2018 年 8 月

DKNF 是消除所有以前的范式后数据库规范化的最终状态

```
 1NF -> 2NF -> 3NF -> BCNF -> 4NF -> 5NF -> 6NF/DKNF 
```

6NF/DKNF 问题（Fagin vs Date）不在此范围内

所以这个问题没有意义，因为任何“仅”在 3NF 或 4NF 中的设计都不会是 DKNF（或 6NF）

除非你有特别复杂的关系，否则大多数人不会设计超过 BCNF。

新链接：[https ://www.tutorialride.com/dbms/database-normalization.htm](https://www.tutorialride.com/dbms/database-normalization.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-26T18:39:01.783

是的。域密钥范式不是可执行的规范化步骤。DKNF 是“如果每个表都有一个主题，那么所有的功能依赖都将是键的逻辑结果。所有数据值约束都可以表示为域约束。” 换句话说，如果关系上的每个约束都是键和域定义的逻辑结果，那么关系就属于 DKNF。

DKNF 被研究界的一些人错误地称为第六范式 (6NF)，但它在技术上是不正确的。CJ Date 详细介绍了这一点，而这篇[关于 DK/NF 范式](https://web.archive.org/web/20120406123712/http://www.dbdebunk.com/page/page/621935.htm)的文章是我第一次了解 DKNF 并了解它的属性的地方。

# asp.net-mvc - 仅将视图用作模板

> ID：729852
> 
> 赞同：0
> 
> 时间：2009-04-08T12:55:32.353
> 
> 标签：asp.net-mvc, viewengine

我正在努力使用 WiewUserControls。我想要完成的是查看而不知道必须使用 RenderPartial 调用哪个用户控件才能呈现一些 html。

我想要的是提供某种 IViewEngine 接口，然后 View 只能调用 IViewEngine 的模板方法中将呈现内容的特定位置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T13:00:42.827

你可以看看[StringTemplate](http://www.stringtemplate.org/)，它是一个纯 MVC 模板引擎。它有一个[C# 端口](http://www.stringtemplate.org/download.html)，正在构建一个[ASP.NET 视图。](http://code.google.com/p/string-template-view-engine-mvc/)

# c# - Asp.Net 将图像添加到 SQL 表...我做错了什么？

> ID：729854
> 
> 赞同：0
> 
> 时间：2009-04-08T12:55:49.203
> 
> 标签：c#, asp.net, sql, image, insert

我以前做过，但方式不同。我试图让下面的代码工作。如果我不投射“OriginalPhoto”或“Thumbnail”，则会发生错误。不允许从数据类型 varchar 到 varbinary(max) 的隐式转换。使用 CONVERT 函数运行此查询。我不明白为什么它要求演员。但是，如果我确实投射它，图像以二进制数据格式添加到数据库中就好了。尝试查看图像时，我收到错误“无法显示给定数据”。我已经使用 SqlDataAdapter 将两个 byte[] 插入到表中，并且可以正常工作。我想使用这种方法，但我做错了什么？

ProfileGALLERY 表包含：

UserId nvarchar(50)
Title nvarchar(10)
OriginalImage varbinary(max)
ThumbImage varbinary(max)

```
protected void AddPhotoToDatabase()
{
    byte[] OriginalPhoto = GetImage();
    byte[] Thumbnail = GenerateThumbnail();
    string Title = FileUpload1.FileName.ToString();
    string sql = "INSERT INTO [ProfileGallery] ([UserId], [Title], [OriginalImage], [ThumbImage]) VALUES ('" + User.Identity.Name + "', '" + Title + "', CAST('" + OriginalPhoto + "'AS VARBINARY(MAX)), CAST('" + Thumbnail + "'AS VARBINARY(MAX)))";
    string strCon = System.Web.Configuration.WebConfigurationManager.ConnectionStrings["SocialSiteConnectionString"].ConnectionString;
    SqlConnection conn = new SqlConnection(strCon);
    SqlCommand comm = new SqlCommand(sql, conn);
    conn.Open();
    comm.ExecuteNonQuery();
    conn.Close();
}

protected byte[] GetImage()
{
    byte[] photo = new byte[FileUpload1.PostedFile.ContentLength];
    FileUpload1.PostedFile.InputStream.Read(photo, 0, photo.Length);
    return photo;
}

protected byte[] GenerateThumbnail()
{
    System.Drawing.Image image = System.Drawing.Image.FromStream(FileUpload1.PostedFile.InputStream);
    double thumbwidth = 0;
    double thumbheight = 0;
    double imgsz = 150.0;
    if (imgsz / image.Width < imgsz / image.Height)
    {
        thumbwidth = image.Width * (imgsz / image.Width);
        thumbheight = image.Height * (imgsz / image.Width);
    }
    else
    {
        thumbwidth = image.Width * (imgsz / image.Height);
        thumbheight = image.Height * (imgsz / image.Height);
    }
    System.Drawing.Image thumb = image.GetThumbnailImage((int)thumbwidth, (int)thumbheight, delegate() { return false; }, (IntPtr)0);
    MemoryStream ms = new MemoryStream();
    thumb.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);
    return ms.ToArray();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T13:08:15.817

您应该使用 sql 参数：

```
using( SqlConnection cnn = GetConnection() ) {
    using( SqlCommand cmd = cnn.CreateCommand() ) {
        cmd.CommandText = "INSERT INTO [ProfileGallery] ([UserId], [Title], [OriginalImage], [ThumbImage]) VALUES (@UserId, @Title, @OriginalPhoto, @Thumbnail)";
        cmd.Parameters.AddWithValue( "@UserId", User.Identity.Name );
        cmd.Parameters.AddWithValue( "@Title", Title );
        cmd.Parameters.AddWithValue( "@OriginalPhoto", OriginalPhoto );
        cmd.Parameters.AddWithValue( "@Thumbnail", Thumbnail );

        cnn.Open();
        cmd.ExecuteNonQuery();
        cnn.Close();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T13:10:15.487

不要尝试将数据构建到插入查询中。试试这个：

```
string sql = "INSERT INTO [ProfileGallery] ([UserId], [Title], [OriginalImage],
              [ThumbImage]) VALUES (@userId, @title, @originalImage, @thumbImage)";

string strCon = System.Web.Configuration.WebConfigurationManager.ConnectionStrings["SocialSiteConnectionString"].ConnectionString;

SqlConnection conn = new SqlConnection(strCon);
SqlCommand comm = new SqlCommand(sql, conn);

comm.Parameters.Add(new SqlParameter("@userId", User.Identity.Name));
comm.Parameters.Add(new SqlParameter("@title", Title));
comm.Parameters.Add(new SqlParameter("@originalImage", OriginalPhoto));
comm.Parameters.Add(new SqlParameter("@thumbImage", Thumbnail)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T13:10:34.470

仅查看您的代码，我有点担心您对 SQL 注入攻击持开放态度。为了帮助减轻这种情况，还应该解决您的问题。您需要使用参数化查询。就像是

```
cmd.CommandText="Insert into [ProfileGallery]" +
                "(UserId,OriginalPhoto) values (@UserId,@OriginalPhoto)";
cmd.Parameters.AddWithValue("UserId",User.Identity.Name);
cmd.Parameters.AddWithValue("OriginalPhoto",OriginalPhoto); 
```

使用此示例应用程序可以看到您的代码失败的原因：

```
static void Main(string[] args)
{
    byte[] byteArray = new byte[] { 1, 2, 0 };
    Console.WriteLine("This is my byte array: " + byteArray);
    Console.ReadLine();
} 
```

这输出这是我的字节数组：System.Byte []

您可以将字节数组添加到字符串中，这让我有些震惊，尤其是因为它只是为我们提供了类型的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T11:37:52.117

```
protected void Page_Load(object sender, EventArgs e)
    {
         if (!IsPostBack)
            {
                BindData();
            }
        }
    private void BindData()
    {
        SqlConnection cn = new SqlConnection("uid=test;pwd=te$t;server=10.10.0.10;database=TestDB");
        string strSQL = "Select * from table6";
        SqlDataAdapter dt = new SqlDataAdapter(strSQL, cn);
        DataSet ds = new DataSet();
        dt.Fill(ds);
        grd1.DataSource = ds;
        grd1.DataBind();
        cn.Close();
    }
    protected void btn1_Click(object sender, EventArgs e)
    {
        if(fileupload.HasFile)
        {

            string imageSrc = "~/Image/" +fileupload.PostedFile.FileName;
         string ImageName = txt1.Text;
        SqlConnection cn=new SqlConnection("uid=test;pwd=te$t;server=10.10.0.10;database=TestDB");
        cn.Open();
        string strSql = "Insert Into table6 (ImageName,Image) values ('" + ImageName + "','"+imageSrc+"')";
        SqlCommand cmd = new SqlCommand(strSql, cn);
        cmd.ExecuteNonQuery();
        cn.Close();
        BindData();
        txt1.Text = "";
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-25T11:42:25.910

**这个简单的代码足以在不使用 HTTP Handler 的情况下将图像插入 SQL**

```
 protected void Page_Load(object sender, EventArgs e)
    {
         if (!IsPostBack)
            {
                BindData();
            }
        }
    private void BindData()
    {
        SqlConnection cn = new SqlConnection("uid=test;pwd=te$t;server=10.10.0.10;database=TestDB");
        string strSQL = "Select * from table6";
        SqlDataAdapter dt = new SqlDataAdapter(strSQL, cn);
        DataSet ds = new DataSet();
        dt.Fill(ds);
        grd1.DataSource = ds;
        grd1.DataBind();
        cn.Close();
    }
protected void btn1_Click(object sender, EventArgs e)
    {
        if(fileupload.HasFile)
        {

            string imageSrc = "~/Image/" +fileupload.PostedFile.FileName;
         string ImageName = txt1.Text;
        SqlConnection cn=new SqlConnection("uid=test;pwd=te$t;server=10.10.0.10;database=TestDB");
        cn.Open();
        string strSql = "Insert Into table6 (ImageName,Image) values ('" + ImageName + "','"+imageSrc+"')";
        SqlCommand cmd = new SqlCommand(strSql, cn);
        cmd.ExecuteNonQuery();
        cn.Close();
        BindData();
        txt1.Text = "";
    } 
```

# java - 适用于 Java EE 的优秀 Ajax 框架

> ID：729862
> 
> 赞同：0
> 
> 时间：2009-04-08T12:57:16.437
> 
> 标签：java, javascript, ajax, dojo

我对 Java EE 比较陌生，我需要一个可以为我简化 AJAX 的框架。

目前我有使用 dojo 工具包绘制图形的代码，但我希望通过 AJAX 更新图形。是否有一个好的框架可以让我进行 Ajax 回调并将 javascript 插入和运行到页面中？

如果是这样，有没有关于如何使用这个框架的好教程？

我对 Ajax 的唯一体验是在 ASP.Net 下使用 Telerik。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T13:02:29.467

[Dojo 也做 AJAX](http://www.dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/ajax-transports/errors-and-timeouts)。

通常我会为这种事情推荐[jQuery](http://jquery.com/)，但你已经在使用 Dojo，所以你应该使用它。但是，如果需要，两者可以一起使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T13:04:01.990

有一些 JSF 组件库或多或少地支持 ajax。[例如， ICEfaces](http://www.icefaces.org/main/home/)使所有标准组件都变成了 ajax'ish，并提供了服务器推送技术。查看[jsfmatrix](http://www.jsfmatrix.net/)以获得概述。

# javascript - jQuery 在 Internet Explorer 中不起作用

> ID：729865
> 
> 赞同：0
> 
> 时间：2009-04-08T12:58:48.993
> 
> 标签：javascript, jquery, xml, internet-explorer

我正在尝试通过使用 jQuery 读取 XML 文件来创建动态菜单。我已经开发了代码，它在 Firefox 3 和 Chrome 中运行良好，但它不适用于 Internet Explorer 7/8。

我在下面发布我的代码。它有什么问题？

```
 var menu ="";
  $(document).ready(function()
  {
      $.ajax({
          type: "GET",
          url: "menu.xml",
          dataType: "xml",
          success: parseXml
      });
  });

  function parseXml(xml)
  {
      $(xml).find('link').each(function(x){
          var link = $(this);
          var title = link.attr("name");

          menu += "<div class='AccordionPanel AccordionPanelClosed'>";
          menu += "<div class='AccordionPanelTab'><span></span>";
          menu += "<a href='javascript:;'>"+title+"</a></div>";

          link.find("inLink").each(function(z){
              var intitle = $(this).attr("name");
              menu += "<div class='AccordionPanelContent'>";
              menu += "<ul><li>";
              menu += "<a href='"+$(this).attr("ref")+"'>"+intitle+"</a>";
              menu += "</li></ul></div>";
          });
          menu += "</div>";
      });

      $("#LeftMenu").append(menu);
  } 
```

XML 文件具有以下结构

```
 <links>
      <link name="Reception" ref="index.html">
          <inLink name="Registration" ref="registration.html"/>
          <inLink name="Inquiry" ref="#"/>
      </link>
      <link name="Records" ref="#">
          <inLink name="Records" ref="#"/>
          <inLink name="Records2" ref="#"/>
      </link>
  </links> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T15:19:26.060

我在解析 XML AJAX 返回时遇到了类似的问题，它在 FF 上运行良好，但在 IE 上失败了。

我遇到的问题是您期望的节点之间的额外节点。IE 将带有空格的文本节点添加到 XML 文件中有空格的 XML DOM。

我通过更改生成的 XML 来修复它，因此节点之间没有空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T13:05:41.113

你能试试：

```
 $("#LeftMenu").append($(menu)); 
```

这只是一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T02:36:41.793

我可能是错的，但请尝试将此作为您的 ajax 请求。

$.ajax({ type: "GET", url: "menu.xml", dataType: "xml", success: function(xml){parseXml(xml);} });

# .net - WPF：如何使用 XAML 隐藏 GridViewColumn？

> ID：729866
> 
> 赞同：32
> 
> 时间：2009-04-08T12:59:12.173
> 
> 标签：.net, wpf, gridviewcolumn

我在 App.xaml 中有以下对象

```
<Application.Resources>
        <ResourceDictionary>
            <GridView x:Key="myGridView" x:Shared="false">
                             <GridViewColumn Header="Created" DisplayMemberBinding="{Binding Path=Created}"/>

... more code ... 
```

我在多个地方使用这个网格视图。例子：

```
<ListView x:Name="detailList"   View="{StaticResource myGridView}" ...> 
```

在其中一种用法（例如上面的 detailList）中，我想隐藏 Created 列，可能使用 XAML？

有任何想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2010-06-21T20:45:15.623

实际上，我发现最简单的解决方案是通过附加属性：

```
public class GridViewColumnVisibilityManager
{       
    static void UpdateListView(ListView lv)
    {
        GridView gridview = lv.View as GridView;
        if (gridview == null || gridview.Columns == null) return;
        List<GridViewColumn> toRemove = new List<GridViewColumn>();
        foreach (GridViewColumn gc in gridview.Columns)
        {
            if (GetIsVisible(gc) == false)
            {
                toRemove.Add(gc);
            }
        }
        foreach (GridViewColumn gc in toRemove)
        {
            gridview.Columns.Remove(gc);
        }
    }

    public static bool GetIsVisible(DependencyObject obj)
    {
        return (bool)obj.GetValue(IsVisibleProperty);
    }

    public static void SetIsVisible(DependencyObject obj, bool value)
    {
        obj.SetValue(IsVisibleProperty, value);
    }

    public static readonly DependencyProperty IsVisibleProperty =
        DependencyProperty.RegisterAttached("IsVisible", typeof(bool), typeof(GridViewColumnVisibilityManager), new UIPropertyMetadata(true));

    public static bool GetEnabled(DependencyObject obj)
    {
        return (bool)obj.GetValue(EnabledProperty);
    }

    public static void SetEnabled(DependencyObject obj, bool value)
    {
        obj.SetValue(EnabledProperty, value);
    }

    public static readonly DependencyProperty EnabledProperty =
        DependencyProperty.RegisterAttached("Enabled", typeof(bool), typeof(GridViewColumnVisibilityManager), new UIPropertyMetadata(false,
            new PropertyChangedCallback(OnEnabledChanged)));

        private static void OnEnabledChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        ListView view = obj as ListView;
        if (view != null)
        {
            bool enabled = (bool)e.NewValue;
            if (enabled)
            {
                view.Loaded += (sender, e2) =>
                {
                    UpdateListView((ListView)sender);
                };
                view.TargetUpdated += (sender, e2) =>
                {
                    UpdateListView((ListView)sender);
                };
                view.DataContextChanged += (sender, e2) =>
                {
                    UpdateListView((ListView)sender);
                };
            }
        }
    }
} 
```

然后，它可以这样使用：

```
<ListView foo:GridViewColumnVisibilityManager.Enabled="True">
...
<GridViewColumn Header="Status" foo:GridViewColumnVisibilityManager.IsVisible="{Binding ShowStatusColumn}">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate> ... 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-03-09T13:24:53.090

基于 Ben McMillan 的回答，但支持可见属性的动态变化。我通过删除 IsEnabled 属性进一步简化了他的解决方案。

```
public class GridViewColumnVisibilityManager
{
    static Dictionary<GridViewColumn, double> originalColumnWidths = new Dictionary<GridViewColumn, double>();

    public static bool GetIsVisible(DependencyObject obj)
    {
        return (bool)obj.GetValue(IsVisibleProperty);
    }

    public static void SetIsVisible(DependencyObject obj, bool value)
    {
        obj.SetValue(IsVisibleProperty, value);
    }

    public static readonly DependencyProperty IsVisibleProperty =
        DependencyProperty.RegisterAttached("IsVisible", typeof(bool), typeof(GridViewColumnVisibilityManager), new UIPropertyMetadata(true, OnIsVisibleChanged));

    private static void OnIsVisibleChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        GridViewColumn gc = d as GridViewColumn;
        if (gc == null)
            return;

        if (GetIsVisible(gc) == false)
        {
            originalColumnWidths[gc] = gc.Width;
            gc.Width = 0;
        }
        else
        {
            if (gc.Width == 0)
                gc.Width = originalColumnWidths[gc];
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-08T22:23:42.473

您最好的选择可能是通过从**GridView**类继承、添加所需的列并公开有意义的属性来显示/隐藏特定列来创建**自定义控件。**您的自定义 GridView 类可能如下所示：

 **```
using System;
using System.Windows.Controls;

namespace MyProject.CustomControls
{
    public class CustomGridView : GridView
    {
        private GridViewColumn _fixedColumn;
        private GridViewColumn _optionalColumn;

        public CustomGridView()
        {
            this._fixedColumn = new GridViewColumn() { Header = "Fixed Column" };
            this._optionalColumn = new GridViewColumn() { Header = "Optional Column" };

            this.Columns.Add(_fixedColumn);
            this.Columns.Add(_optionalColumn);
        }

        public bool ShowOptionalColumn
        {
            get { return _optionalColumn.Width > 0; }
            set
            {
                // When 'False' hides the entire column
                // otherwise its width will be set to 'Auto'
                _optionalColumn.Width = (!value) ? 0 : Double.NaN;
            }
        }

    }
} 
```

然后您可以简单地从 XAML 设置该属性，如下例所示：

```
<Window x:Class="WpfApplication1.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:cc="clr-namespace:MyProject.CustomControls"
        Title="Window1"
        Height="300"
        Width="300">
    <StackPanel>
        <ListView>
            <ListView.View>
                <cc:CustomGridView ShowOptionalColumn="False" />
            </ListView.View>
        </ListView>

        <ListView>
            <ListView.View>
                <cc:CustomGridView ShowOptionalColumn="True" />
            </ListView.View>
        </ListView>
    </StackPanel>
</Window> 
```

或者，您可以将“ *CustomGridView.ShowOptionalColumn* ”设置为**DependencyProperty**，以便能够将其用作绑定目标。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-20T13:57:47.960

Taken from [here](http://social.msdn.microsoft.com/forums/en-US/wpf/thread/11be5fb7-bac1-4698-9f82-5bcc5eb88376)

```
<ListView Grid.Column="1" Grid.Row="1"  Name="FicheList" >
            <ListView.Resources>
                <ResourceDictionary>
                    <Style x:Key="hiddenStyle" TargetType="GridViewColumnHeader">
                        <Setter Property="Visibility" Value="Collapsed"/>
                    </Style>
                </ResourceDictionary>
            </ListView.Resources>
            <ListView.View>
                <GridView>
                    <GridViewColumn DisplayMemberBinding="{Binding Code}" Header="Code" Width="0" HeaderContainerStyle="{StaticResource hiddenStyle}" />
                    <GridViewColumn DisplayMemberBinding="{Binding FicheTitle}" Header="Title" Width="100" />
                    <GridViewColumn DisplayMemberBinding="{Binding CategoryName}" Header="Category" Width="100" />
                    <GridViewColumn DisplayMemberBinding="{Binding UpdateDate}" Header="Update Date" Width="100" />

                </GridView>
            </ListView.View>
        </ListView> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-23T05:53:41.143

我有一个比使用附加行为更简单的解决方案。

您所要做的就是将 GridViewColumn 的 Width 属性绑定到 ViewModel 上的布尔值。然后创建一个像 BooleanToWidthConverter 这样的简单转换器，它接受一个布尔值并返回一个双精度值，如果为假则返回零，如果为真则返回 x 宽度。

我希望这会有所帮助，并使您的生活更轻松。

XAML：

```
<GridViewColumn x:Name="MyHiddenGridViewColumn"
                Width={Binding Path=IsColumnVisibleProperty, Converter={StaticResource BooleanToWidthConverter}}">
   <!-- GridViewColumn.HeaderTemplate etc. goes here. -->
</GridViewColumn> 
```

转换器：

```
public class BooleanToWidthConverter : IValueConverter
    {
        private const double Column_Width = 40.0;

        public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
            if (value != null && value != DependencyProperty.UnsetValue)
            {
                bool isVisible = (bool) value;

                return isVisible ? Column_Width : 0;
            }
            return Column_Width;
        }

        public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
            throw new NotImplementedException();
        }
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-07-22T13:23:27.150

这是我的代码，它在我的项目中运行良好。如果您不喜欢添加一些外部代码。

```
 /// <summary>
    /// show/hide datagrid column
    /// </summary>
    /// <param name="datagrid"></param>
    /// <param name="header"></param>
    private void ToggleDataGridColumnsVisible()
    {
        if (IsNeedToShowHideColumn())
        {
            foreach (GridViewColumn column in ((GridView)(this.ListView1.View)).Columns)
            {
                GridViewColumnHeader header = column.Header as GridViewColumnHeader;
                if (header != null)
                {
                    string headerstring = header.Tag.ToString();

                    if (!IsAllWaysShowingHeader(headerstring ) )
                    {
                        if (IsShowingHeader())
                        {

                        }
                        else
                        {
                            //hide it
                            header.Template = null;
                            column.CellTemplate = null;
                            column.Width = 0;
                        }
                    }
                }

            }

        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-30T21:41:55.993

这对我
有用 需要在标题和内容上绑定可见性
在这种情况下它在最后所以我不担心宽度
但是用户没有获得 UI 挂钩来重置宽度所以如果你设置宽度为零它消失了

```
<GridViewColumn Width="60">
    <GridViewColumnHeader HorizontalContentAlignment="Stretch" HorizontalAlignment="Stretch"
                            Visibility="{Binding Source={x:Static Application.Current}, Path=MyGabeLib.CurUser.IsInRoleSysAdmin, Converter={StaticResource bvc}}">
        <TextBlock>WS<LineBreak/>Count</TextBlock>
    </GridViewColumnHeader>
    <GridViewColumn.CellTemplate>
        <DataTemplate>
            <TextBlock Text="{Binding Path=WordScoreCount, StringFormat={}{0:N0}}" HorizontalAlignment="Right"
                        Visibility="{Binding Source={x:Static Application.Current}, Path=MyGabeLib.CurUser.IsInRoleSysAdmin, Converter={StaticResource bvc}}"/>
        </DataTemplate>
    </GridViewColumn.CellTemplate>
</GridViewColumn> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T17:21:10.453

我建议在父级上使用自定义属性（或劫持现有属性），然后在 gridviewcolumnheader 上使用自定义样式来引用该祖先属性。像这样：

```
<Window.Resources>
    <Style TargetType="{x:Type GridViewColumnHeader}">
        <Setter Property="Visibility" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListView}}, Path=Tag}"/>
    </Style>
    <GridView x:Key="myGridView" x:Shared="false">                             
        <GridViewColumn Header="Created" DisplayMemberBinding="{Binding Path=Created}"/>    
    </GridView>
</Window.Resources>
<Grid x:Name="LayoutRoot">
    <StackPanel>
        <ListView x:Name="detailList"   View="{StaticResource myGridView}"/>
        <ListView x:Name="detailListHide" Tag="{x:Static Member=Visibility.Hidden}" View="{StaticResource myGridView}"/>
    </StackPanel>
</Grid> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-10-15T09:42:44.047

[在我编写的一个小实用程序](http://ulsdeobfuscator.codeplex.com/)中，我有一个列表视图，用户可以在其中隐藏/显示一些列。列上没有 Visibility 属性，所以我决定将隐藏列的宽度设置为零。不理想，因为用户仍然可以调整它们的大小并使它们再次可见。

无论如何，为此，我使用了：

```
<GridViewColumn.Width>
    <MultiBinding Converter="{StaticResource WidthConverter}" Mode="TwoWay">
        <Binding Path="ThreadIdColumnWidth" Mode="TwoWay" />
        <Binding Path="IsThreadIdShown" />
    </MultiBinding>
</GridViewColumn.Width> 
```

`IsThreadIdShown`绑定到工具栏上的复选框。多值转换器是：

```
public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture) {
    if (values.Length != 2) {
        return null;
    }

    object o0 = values[0];
    object o1 = values[1];

    if (! (o1 is bool)) {
        return o0;
    }
    bool toBeDisplayed = (bool) o1;
    if (! toBeDisplayed) {
        return 0.0;
    }

    if (! (o0 is double)) {
        return 0;
    }

    return (double) o0;
}

public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture) {

    return new object[] { (double)value, Binding.DoNothing };
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-25T10:07:06.707

```
<GridViewColumn Width="{Binding Tag, RelativeSource={RelativeSource AncestorType=ListView}, Converter={converters:BooleanToWidthConverter}, ConverterParameter=100}">
                            <GridViewColumn.HeaderContainerStyle>
                                <Style TargetType="{x:Type GridViewColumnHeader}" BasedOn="{StaticResource ColumnHeaderStyle}">
                                    <Setter Property="IsEnabled" Value="False"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Tag, RelativeSource={RelativeSource AncestorType=ListView}}" Value="true">
                                            <Setter Property="IsEnabled" Value="True"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </GridViewColumn.HeaderContainerStyle>
                            <GridViewColumn.Header>
                                <StackPanel Tag="columnHeader" Orientation="Horizontal">
                                </StackPanel>
                            </GridViewColumn.Header>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <ContentControl>
                                        <TextBlock Text="test" />
                                    </ContentControl>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn> 
```

类 BooleanToWidthConverter :IValueConverter {

```
 public object Convert (object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (value is bool b)
        {
            return b ? parameter : 0;
        }
        return 0;
    }

    public object ConvertBack (object value, Type targetType, object parameter, CultureInfo culture)
    {
        return null;
    }
} 
```

不幸的是，GridViewColumn 中没有“IsVisible”属性但是，我有一个解决方案可以通过简单而完整的方式解决这个问题：

1.  将宽度设置为0。很多Dev 只是在这一步停止，因为它似乎被隐藏了但没有。我们仍然使其可扩展，因此通过调整列大小将其重新显示在 UI 上，因此我们需要执行更多步骤 2。
2.  通过设置 GridViewColumnHeader IsEnabled = false 禁用调整 GridViewColumn 的大小。

上面的代码示例：

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-22T12:42:09.987

有点晚了，但我认为这可能仍然有用：

根据 A.Pissicat、Surfen 和 Ben McMillan 的代码（和评论），我更新`GridViewColumnVisibilityManager`如下：

```
 /// <summary>
    /// Used to hide the attached <see cref="GridViewColumn"/> and prevent the user
    /// from being able to access the column's resize "gripper" by
    /// temporarily setting both the column's width and style to
    /// a value of 0 and null (respectively) when IsVisible
    /// is set to false. The prior values will be restored
    /// once IsVisible is set to true.
    /// </summary>
    public static class GridViewColumnVisibilityManager
    {
        public static readonly DependencyProperty IsVisibleProperty =
            DependencyProperty.RegisterAttached(
                "IsVisible",
                typeof(bool),
                typeof(GridViewColumnVisibilityManager),
                new UIPropertyMetadata(true, OnIsVisibleChanged));

        private static readonly ConditionalWeakTable<GridViewColumn, ColumnValues> OriginalColumnValues = new ConditionalWeakTable<GridViewColumn, ColumnValues>();

        public static bool GetIsVisible(DependencyObject obj) => (bool)obj.GetValue(IsVisibleProperty);

        public static void SetIsVisible(DependencyObject obj, bool value) => obj.SetValue(IsVisibleProperty, value);

        private static void OnIsVisibleChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            if (!(d is GridViewColumn gridViewColumn))
            {
                return;
            }

            if (!GetIsVisible(gridViewColumn))
            {
                // Use GetOrCreateValue to ensure
                // we have a place to cache our values.
                // Any previous values will be overwritten.
                var columnValues = OriginalColumnValues.GetOrCreateValue(gridViewColumn);
                columnValues.Width = gridViewColumn.Width;
                columnValues.Style = gridViewColumn.HeaderContainerStyle;

                // Hide the column by
                // setting the Width to 0.
                gridViewColumn.Width = 0;

                // By setting HeaderContainerStyle to null,
                // this should remove the resize "gripper" so
                // the user won't be able to resize the column
                // and make it visible again.
                gridViewColumn.HeaderContainerStyle = null;
            }
            else if (gridViewColumn.Width == 0
                     && OriginalColumnValues.TryGetValue(gridViewColumn, out var columnValues))
            {
                // Revert back to the previously cached values.
                gridViewColumn.HeaderContainerStyle = columnValues.Style;
                gridViewColumn.Width = columnValues.Width;
            }
        }

        private class ColumnValues
        {
            public Style Style { get; set; }

            public double Width { get; set; }
        }
    } 
```

如果您希望在隐藏列时使用特定`HeaderContainerStyle` `Style`而不是，请替换：`null`

`gridViewColumn.HeaderContainerStyle = columnValues.Style;`

和

`gridViewColumn.HeaderContainerStyle = Application.Current.TryFindResource(@"disabledColumn") as Style;`

并更改`@"disabledColumn"`为您要使用的任何名称。

# java - Struts2，使用method={1}的最佳实践

> ID：729885
> 
> 赞同：3
> 
> 时间：2009-04-08T13:03:12.990
> 
> 标签：java, xml, struts2, struts

我是 Struts 2 的新手，我遇到过这种语法（在教程中推荐）。

```
<action name="Register_*" method="{1}" class="Register">
    <result name="input">/member/Register.jsp</result>
    <result type="redirectAction">Menu</result>
</action> 
```

我知道它调用了 Register.{1} 方法。问题是用户可以输入另一个（随机）值并导致 500 错误（这将被正确记录为错误）。

如何防止这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-24T21:07:02.340

在我的应用程序中，我们像这样使用它：

```
 <action name="*/*" class="{1}Action" method="{2}">
       <interceptor-ref name="CustomAuthStack" />       
            <result>/pages/{1}/{2}.jsp</result>
            <result name="input">/pages/error/denied.jsp</result>
            <result name="logout">/pages/error/denied.jsp</result>

            <!-- methods that come back to listing after processing -->
            <result name="remove" type="redirectAction">{1}/list</result>
            <result name="save"   type="redirectAction">{1}/list</result>
            <result name="enable"   type="redirectAction">{1}/list</result>

   ....

   </action> 
```

对于像 myapp/users/list 这样的斜杠，您必须使用

```
<constant name="struts.enable.SlashesInActionNames" value="true" /> 
```

在 strus.xml 中。

所以现在你有了一个标准：

action --> UserAction jsp -----> users/list.jsp

等等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T19:46:48.153

首先，它不会调用 Register.{1} 方法。它会调用 Register_{1}，其中 {1} 可能是一种操作类型（通常是编辑、显示等）

这意味着该 URL 实际上是

```
Register_View
Register_Edit
e.t.c. 
```

因此，如果用户手动将 URL 更改为不存在的内容，例如

```
Register_methodThatDoesNotExist 
```

那么struts 2会返回一个错误。

但为什么这是一个问题？在使用任何技术的任何 Web 应用程序中，如果用户手动篡改 URL，将返回错误（也是 404）

你到底想防止什么？

**更新：**

为了防止 500 错误，您可以捕获所有操作（不匹配任何规则）并将它们重定向到错误页面中。请参阅 struts 2 wiki 中的“Wildcard Default”默认段落

[http://cwiki.apache.org/WW/action-configuration.html](http://cwiki.apache.org/WW/action-configuration.html)

这**必须**在 struts 配置的末尾

# excel - 使用 vbscript 以编程方式将模块添加到 xls 2003

> ID：729895
> 
> 赞同：0
> 
> 时间：2009-04-08T13:04:41.333
> 
> 标签：excel, vba, vbscript, module, xls

第一部分现在正在工作[ *我有以下似乎挂起；添加/删除模块的部分在 VBA 中运行时有效0 并且也尝试了 2 但它仍然挂起（第二个参数是 UpdateLinks，可以在[这里](http://msdn.microsoft.com/en-us/library/aa195811(office.11).aspx)找到）* ]

```
dim objExcel
dim objWorkbook
Set objExcel = CreateObject("Excel.Application")
Set objWorkbook = objExcel.Workbooks.Open(  "H:\M\X\C.xls", 0 , , ,"PASSWORD!" )

Const modpath  = "H:\M\V\"
Const modtest  = "TEST.cls"
Const modname  = "TEST"

On Error Resume Next

Dim vbcomp
Set vbcomp = ActiveWorkbook.VBProject.VBComponents(modname)
objWorkbook.VBProject.VBComponents.Remove vbcomp
objWorkbook.VBProject.VBComponents.Import modpath & modtest

objWorkbook.Save
objWorkbool.Close
set vbcomp = nothing
set objworkbook = nothing
set objExcel = nothing 
```

**再次编辑** 2009 年 4 月 14 日我现在还允许“工具 - 宏 - 安全 - vbproject 访问”

脚本现在完成了，但是，当尝试打开 xls 以查看是否已进行更改时，我收到一条消息，通知我工作表已被“用于运行脚本的帐户”锁定；打开“只读”/通知

为什么它不能正确释放控制**？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T18:46:36.770

首先想到：您的工作簿是否已经包含对“Microsoft Visual Basic for Applications Extensibility”库的引用（在 VBA 中）？您需要它能够与 VBProject 对象对话。实际上，如果您的代码在 VBA 中工作，您可能确实有参考。

第二个想法：ActiveWorkbook 可能没有在实际工作簿之外定义。尝试用您的 objWorkbook 对象替换它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T15:55:14.133

这是第三个想法。在包含模块之前，您是否尝试将应用程序的 DisplayAlerts 属性设置为 FALSE？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T11:16:30.883

编辑后的脚本有效。

问题是因为我在工作簿级别而不是在 VBA 项目级别提供密码。

在网上快速搜索显示无论如何都不可能这样做（sendkeys等），所以在手动删除项目密码后，问题就解决了

# silverlight - Silverlight MVVM 单元测试说明

> ID：729896
> 
> 赞同：1
> 
> 时间：2009-04-08T13:04:58.493
> 
> 标签：silverlight, unit-testing, mvvm

谁能解释为什么当我使用调试器逐步完成单元测试时，在查看对象或属性时会得到空引用。例如：

```
1      [TestMethod]
2            [Description("Test to confirm that upon initial class creation, the login view is loaded as the default content for the TaskRegion.")]
3            public void Shell_Initialisation_LoginViewIsLoadedByDefault()
4            {
5                Shell shell = new Shell();
6    
7                TestPanel.Children.Add(shell);
8    
9                Shell_ViewModel viewModel = shell.DataContext as Shell_ViewModel;
10   
11               Assert.IsTrue(viewModel.TaskRegionContent is ContentControl);
12   
13               EnqueueTestComplete();
14           } 
```

[第 9 行] 当我将 viewModel 字段设置为 shell 视图的 DataContext 时，我得到一个“对象未设置为实例...”异常。我确定我的数据上下文是在我的 shell.xaml.cs 中设置的；整个文件：

```
1    using System.Windows;
2    
3    namespace eg.WorkManager.UI.Shell
4    {
5        public partial class Shell
6        {
7    
8            public Shell()
9            {
10               InitializeComponent();
11               this.Loaded += new RoutedEventHandler(Shell_Loaded);
12           }
13   
14           void Shell_Loaded(object sender, RoutedEventArgs e)
15           {
16               this.DataContext = new Shell_ViewModel();
17           }
18       }
19   }
20 
```

我知道我做错了什么，但谁能解释一下？

谢谢，马克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T13:11:39.553

您在事件`DataContext`期间设置`Loaded`，当您的控件实际加载到可视树中时会引发该事件。因此，您`DataContext`不会被设置，因为您所做的只是构建视图。您可以通过附加调试器运行单元测试并在`Loaded`处理程序中设置断点来轻松验证。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T13:12:55.917

我猜问题是您正在孤立地实例化 Shell 对象。您是否确认甚至调用了 Shell_Loaded（Loaded 事件）？

为什么不将视图模型创建为 xaml 中的静态资源？使用 MVVM，我通常将其创建为 xaml 中的静态资源，然后将其绑定为 LayoutRoot 中的数据上下文......全部在 xaml 中。

# c# - 区分用户交互引发的事件和我自己的代码

> ID：729897
> 
> 赞同：9
> 
> 时间：2009-04-08T13:05:07.463
> 
> 标签：c#, winforms, events, combobox

在以下情况下，该`SelectedIndexChanged`事件会从组合框中在我的应用程序中触发：

1.  用户在组合框中选择不同的项目，或者在以下情况下：
2.  我自己的代码更新组合框`SelectedItem`以反映组合框现在显示不同对象的属性。

我`SelectedIndexChanged`对案例 1 的事件感兴趣，以便我可以更新当前对象的属性。但是在情况 2 中，我不希望触发事件，因为对象的属性没有改变。

一个例子可能会有所帮助。假设我有一个包含人员列表的列表框，并且我有一个组合框，表示列表中当前选定人员的国籍。如果 Fred 当前在列表中被选中，则情况 1 可能会发生，我使用组合框将他的国籍从英语更改为威尔士语。如果我在列表中选择苏格兰人 Bob，则可能会发生案例 2。在这里，我的列表更新事件处理程序代码看到 Bob 现在已被选中，并更新组合框以使 Scottish 现在成为选定项目。这会导致组合框的`SelectedIndexChanged`事件被触发以将 Bob 的国籍设置为苏格兰，即使它已经是苏格兰。

**如何在不触发事件的情况下更新组合框的`SelectedItem`属性？`SelectedIndexChanged`**一种方法是取消注册事件处理程序 set `SelectedItem`，然后重新注册事件处理程序，但这似乎很乏味且容易出错。一定会有更好的办法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T13:13:48.613

我创建了一个名为`SuspendLatch`. 欢迎提供更好的名称，但它可以满足您的需要，您可以像这样使用它：

```
void Method()
{
    using (suspendLatch.GetToken())
    {
        // Update selected index etc
    }
}

void listbox1_SelectedIndexChanged(object sender, EventArgs e)
{
    if (suspendLatch.HasOutstandingTokens)
    {
        return;
    }

    // Do some work
} 
```

它并不漂亮，但它确实有效，并且与取消注册事件或布尔标志不同，它支持嵌套操作，有点像 TransactionScope。您不断地从闩锁中获取令牌，并且只有在处理完最后一个令牌时才会`HasOutstandingTokens`返回 false。美好而安全。不是线程安全的，虽然...

这是 SuspendLatch 的代码：

```
public class SuspendLatch
{
    private IDictionary<Guid, SuspendLatchToken> tokens = new Dictionary<Guid, SuspendLatchToken>();

    public SuspendLatchToken GetToken()
    {
        SuspendLatchToken token = new SuspendLatchToken(this);
        tokens.Add(token.Key, token);
        return token;
    }

    public bool HasOutstandingTokens
    {
        get { return tokens.Count > 0; }
    }

    public void CancelToken(SuspendLatchToken token)
    {
        tokens.Remove(token.Key);
    }

    public class SuspendLatchToken : IDisposable
    {
        private bool disposed = false;
        private Guid key = Guid.NewGuid();
        private SuspendLatch parent;

        internal SuspendLatchToken(SuspendLatch parent)
        {
            this.parent = parent;
        }

        public Guid Key
        {
            get { return this.key; }
        }

        public override bool Equals(object obj)
        {
            SuspendLatchToken other = obj as SuspendLatchToken;

            if (other != null)
            {
                return Key.Equals(other.Key);
            }
            else
            {
                return false;
            }
        }

        public override int GetHashCode()
        {
            return Key.GetHashCode();
        }

        public override string ToString()
        {
            return Key.ToString();
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!disposed)
            {
                if (disposing)
                {
                    // Dispose managed resources.
                    parent.CancelToken(this);
                }

                // There are no unmanaged resources to release, but
                // if we add them, they need to be released here.
            }
            disposed = true;

            // If it is available, make the call to the
            // base class's Dispose(Boolean) method
            //base.Dispose(disposing);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T13:15:06.520

我认为最好的方法是使用标志变量：

```
bool updatingCheckbox = false;

void updateCheckBox()
{
    updatingCheckBox = true;

    checkbox.Checked = true;

    updatingCheckBox = false;
}

void checkbox_CheckedChanged( object sender, EventArgs e )
{
    if (!updatingCheckBox)
        PerformActions()
} 
```

[编辑：仅发布代码并不是很清楚]

在这种情况下，当通过 updateCheckBox() 更改复选框时，事件处理程序不会执行其正常操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T13:43:51.490

我一直使用布尔标志变量来防止不需要的事件处理程序。[TaskVision](http://www.microsoft.com/downloads/details.aspx?FamilyID=6f6f03bd-c3f2-4f28-b8e6-e3d26a75635e&DisplayLang=en)示例应用程序教我如何做到这一点。

您所有事件的事件处理程序代码将如下所示：

```
private bool lockEvents;

protected void MyEventHandler(object sender, EventArgs e)
{
    if (this.lockEvents)
    {
        return;
    }

    this.lockEvents = true;
    //Handle your event...
    this.lockEvents = false;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T13:17:23.300

我让事件发生。但是，我在更改索引之前设置了一个标志，然后将其翻转回来。在事件处理程序中，我检查是否设置了标志，如果是则退出处理程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T13:43:46.793

我认为您的重点应该放在对象上，而不是正在发生的事件上。

比如说你有这个事件

```
void combobox_Changed( object sender, EventArgs e )
{
    PerformActions()
} 
```

和 PerformActions 做了一些事情

```
void PerformActions()
{
    (listBox.SelectedItem as IPerson).Nationality = 
        (comboBox.SelectedItem as INationality)
} 
```

然后在 Person 内部，您会期望看到以下效果

```
class Person: IPerson
{
    INationality Nationality
    {
        get { return m_nationality; }
        set 
        {
          if (m_nationality <> value)
          {
             m_nationality = value;
             this.IsDirty = true;
          }
        }
    }
} 
```

这里的重点是您让对象跟踪自身发生的事情，而不是 UI。这还可以让您跟踪对象上的脏标志跟踪，这对于以后的持久性可能很有用。

这也使您的 UI 保持干净，并防止它获得很可能容易出错的奇怪事件注册代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-18T16:02:08.073

我终于找到了一个解决方案，以避免不必要的事件被触发太多时间。

我使用一个计数器，我只在不需要时挂钩/取消挂钩我想要屏蔽的事件一次，并且在再次需要它时。

下面的示例显示了我如何隐藏数据网格的 CellValueChanged 事件。

```
EventMask valueChangedEventMask;

// In the class constructor
valueChangedEventMask = new EventMask(
    () => { dgv.CellValueChanged += new DataGridViewCellEventHandler(dgv_CellValueChanged); },
    () => { dgv.CellValueChanged -= new DataGridViewCellEventHandler(dgv_CellValueChanged); }
);

// Use push to hide the event and pop to make it available again. The operation can be nested or be used in the event itself.
void changeCellOperation()
{
    valueChangedEventMask.Push();

    ...
    cell.Value = myNewCellValue
    ...

    valueChangedEventMask.Pop();
}

// The class
public class EventMask
{
    Action hook;
    Action unHook;

    int count = 0;

    public EventMask(Action hook, Action unHook)
    {
        this.hook = hook;
        this.unHook = unHook;
    }

    public void Push()
    {
        count++;
        if (count == 1)
            unHook();
    }

    public void Pop()
    {
        count--;
        if (count == 0)
            hook();
    }
} 
```

# c# - 针对实体列表的 LINQ to SQL 查询

> ID：729899
> 
> 赞同：2
> 
> 时间：2009-04-08T13:05:18.633
> 
> 标签：c#, linq-to-sql

成分类：

```
class Ingredient
{
    public String Name { get; set; }
    public Double Amount { get; set; }
} 
```

成分清单：

```
var ingredientsList = new List<Ingredient>(); 
```

我的“成分”表的数据库布局：

```
[Ingredients] (
    [IngredientsID] [int] IDENTITY(1,1) NOT NULL,
    [RecipeID] [int] NOT NULL,
    [IngredientsName] [nvarchar](512) NOT NULL,
    [IngredientsAmount] [float] NOT NULL
) 
```

我可以查询我`ingredientsList`的“成分”表，做一个类似这样的 where 子句（伪代码警报！）：

```
SELECT * FROM Ingredients WHERE
IngredientsName = ["Name" property on entities in my ingredientsList] AND
IngredientsAmount <= ["Amount" property on entities in my ingredientsList] 
```

我当然希望使用 LINQ 来完成，而不是使用动态生成的 SQL 查询。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-08T13:42:04.833

LINQ 是可组合的，但要在不使用 UNION 的情况下执行此操作，您必须自己编写`Expression`. 基本上，我们（大概）想要创建以下形式的 TSQL：

```
SELECT *
FROM   [table]
WHERE  (Name = @name1 AND Amount <= @amount1)
OR     (Name = @name2 AND Amount <= @amount2)
OR     (Name = @name3 AND Amount <= @amount3)
... 
```

其中名称/金额对在运行时确定。在 LINQ 中有一种简单的表达方式；如果每次都是“AND”，我们可以`.Where(...)`重复使用。`Union`是候选人，但我看到反复有人对此有问题。我们想要做的是模拟我们编写一个 LINQ 查询，例如：

```
var qry = from i in db.Ingredients
          where (  (i.Name == name1 && i.Amount <= amount1)
                || (i.Name == name2 && i.Amount <= amount2)
                ... )
          select i; 
```

这是通过制作一个`Expression`, using`Expression.OrElse`来组合每个来完成的 - 所以我们需要迭代我们的名称/金额对，使一个更丰富的`Expression`.

`Expression`手工编写代码有点像黑魔法，但我有一个非常相似的例子（来自我提供的演示文稿）；它使用一些自定义扩展方法；通过以下方式使用：

```
 IQueryable query = db.Ingredients.WhereTrueForAny(
        localIngredient => dbIngredient =>
                   dbIngredient.Name == localIngredient.Name
                && dbIngredient.Amount <= localIngredient.Amount
            , args); 
```

`args`你的测试成分数组在哪里。它的作用是：对于每个`localIngredient`in `args`（我们的本地测试成分数组），它要求我们提供一个`Expression`（为此`localIngredient`），它是要在数据库中应用的测试。然后它将这些（依次）与`Expression.OrElse`：

* * *

```
public static IQueryable<TSource> WhereTrueForAny<TSource, TValue>(
    this IQueryable<TSource> source,
    Func<TValue, Expression<Func<TSource, bool>>> selector,
    params TValue[] values)
{
    return source.Where(BuildTrueForAny(selector, values));
}
public static Expression<Func<TSource, bool>> BuildTrueForAny<TSource, TValue>(
    Func<TValue, Expression<Func<TSource, bool>>> selector,
    params TValue[] values)
{
    if (selector == null) throw new ArgumentNullException("selector");
    if (values == null) throw new ArgumentNullException("values");
    // if there are no filters, return nothing
    if (values.Length == 0) return x => false;
    // if there is 1 filter, use it directly
    if (values.Length == 1) return selector(values[0]);

    var param = Expression.Parameter(typeof(TSource), "x");
    // start with the first filter
    Expression body = Expression.Invoke(selector(values[0]), param);
    for (int i = 1; i < values.Length; i++)
    { // for 2nd, 3rd, etc - use OrElse for that filter
        body = Expression.OrElse(body,
            Expression.Invoke(selector(values[i]), param));
    }
    return Expression.Lambda<Func<TSource, bool>>(body, param);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T13:22:30.200

您可以在 LINQ 2 SQL 查询中使用本地集合的唯一范围是`Contains()`函数，它基本上是对 SQL`in`子句的转换。例如...

```
var ingredientsList = new List<Ingredient>();

... add your ingredients

var myQuery = (from ingredient in context.Ingredients where ingredientsList.Select(i => i.Name).Contains(ingredient.Name) select ingredient); 
```

这将生成相当于“ `...where ingredients.Name in (...)`”的 SQL

不幸的是，我认为这对您不起作用，因为您必须以原子方式加入每一列。

顺便说一句，使用 LINQ 2 SQL*是*动态生成的 SQL 查询。

当然，您可以在客户端进行连接，但这需要恢复整个`Ingredients`表，这可能会限制性能，并且**绝对**是不好的做法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T13:10:48.120

我认为您要么必须使用多个查询，要么将成分列表复制到临时表中并以这种方式进行数据库查询。

我的意思是，你*可以*有一个 SQL 语句：

```
SELECT * FROM Ingredients WHERE
(IngredientsName = 'Flour' AND IngredientsAmount < 10) OR   
(IngredientsName = 'Water' AND IngredientsAmount <= 5) OR
(IngredientsName = 'Eggs' AND IngredientsAmount <= 20) 
```

但它很快就会变得丑陋。

我个人怀疑临时表解决方案将是最整洁的 - 但我不知道 LINQ to SQL 是否对它们有很多支持。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T21:17:27.513

```
List<string> ingredientNames = ingredientsList
  .Select( i => i.Name).ToList();
Dictionary<string, Double> ingredientValues = ingredientsList
  .ToDictionary(i => i.Name, i => i.Amount);
//database hit
List<Ingredient> queryResults = db.Ingredients
  .Where(i => ingredientNames.Contains(i.Name))
  .ToList();
//continue filtering locally - TODO: handle case-sensitivity
List<Ingredient> filteredResults = queryResults
  .Where(i => i.Amount <= ingredientValues[i.Name])
  .ToList(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T00:38:50.043

我在[LINQPad](http://www.linqpad.net)中搞乱了这个解决方案，如果你有它，你可以看到转储输出。不确定它是否是您需要的，但据我了解。我在我的`Users`桌子上使用了它，但是您可以将其替换为成分，将“用户列表”替换为“成分列表”，将“用户名”替换为“成分名称”。您可以在 if 语句中添加更多“OR”过滤表达式。不过，设置 ID 很重要。

所以最后注意“ `Dump()`”方法是特定于 LINQPad 的，不是必需的。

```
var userList = new List<User>();
userList.Add(new User() { ID = 1, Username = "goneale" });
userList.Add(new User() { ID = 2, Username = "Test" });

List<int> IDs = new List<int>();
//                       vv ingredients from db context
IQueryable<User> users = Users;
foreach(var user in userList)
{
    if (users.Any(x => x.Username == user.Username))
        IDs.Add(user.ID);
}
IDs.Dump();
userList.Dump();
users.Dump();
users = users.Where(x => IDs.Contains(x.ID));
users.Dump(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-26T17:30:52.307

我正在使用 Union 来连接每个子查询的结果：

```
 public static IQueryable<TSource> WhereTrueForAny<TSource, TValue>(this IQueryable<TSource> source, Func<TValue, Expression<Func<TSource, bool>>> selector, params TValue[] values)
    {
        // code is based on Marc Gravells answer
        if (selector == null) throw new ArgumentNullException("selector");
        if (values == null) throw new ArgumentNullException("values");

        // if there are no filters, return nothing
        if (values.Length == 0) return source.Where(x => false);
        // if there is 1 filter, use it directly
        if (values.Length == 1) return source.Where(selector(values[0]));

        var lockingUpArray = values;

        var p = lockingUpArray.First();

        IQueryable<TSource> query = source.Where(selector(p));

        foreach (var param in lockingUpArray.Skip(1))
        {
            query = query.Union(source.Where(selector(param)));
        }

        return query;
    } 
```

# javascript - JavaScript 图表库 - 谷歌分析风格

> ID：729900
> 
> 赞同：7
> 
> 时间：2009-04-08T13:05:34.717
> 
> 标签：javascript, canvas, charts

我正在寻找一个 Javascript 库来创建类似于 Google Analytics 的折线图。当鼠标悬停在一个点上时，一个框会显示数据。

一个例子是在[http://wikirank.com/en](http://wikirank.com/en)

没有 Flash 或 Air，只有 JS 和客户端 Canvas...

最好免费...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-08T13:08:40.090

编辑：如果你想要一个免费的图书馆，试试[Flot](http://code.google.com/p/flot/)。

[Emprise Charts](http://www.ejschart.com/)是我在新闻网站上看到的一个商业图书馆。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-08T17:02:00.983

另一种选择是使用 Google 的[可视化 API](http://code.google.com/apis/visualization/documentation/gallery.html)。它非常易于使用，并且它们有多种显示数据的选项。要记住的一件事是，一些可视化要求您将数据发送到他们的服务器，尽管 canvas/svg 都没有这个要求。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T13:40:33.977

有[JS-Charts](http://www.jscharts.com/)看起来非常棒。

[或者，如果您喜欢自己滚动，您可以使用此库](http://www.walterzorn.com/jsgraphics/jsgraphics_e.htm)创建自己的图表组件...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-17T19:55:25.360

作为 Flot 的替代方案，如果您使用 Prototype.js 作为 JS 框架，则可以使用[Flotr](http://code.google.com/p/flotr/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-05T07:58:37.507

Dojo 也有类似的东西，尽管显示的示例没有类似的功能，但可以实现为您想要的行为，

[http://dojocampus.org/explorer/#Dojox_Charting_2D_Lines,%20Markers,%20No%20Axes,%20Purple%20Theme,%20Custom%20Min%20Max](http://dojocampus.org/explorer/#Dojox_Charting_2D_Lines,%20Markers,%20No%20Axes,%20Purple%20Theme,%20Custom%20Min%20Max)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-12T12:40:23.867

[Raphael.js](http://raphaeljs.com)非常擅长用 svg/vml 制作图表，虽然你必须编写一些自定义代码，但你可以用它制作一些非常漂亮的动画，此外它与 ie6+ 兼容（仅与 android 2 浏览器不兼容）。

# c++ - 在运行时更改对象的行为

> ID：729905
> 
> 赞同：4
> 
> 时间：2009-04-08T13:06:51.157
> 
> 标签：c++

如何在运行时更改对象的行为？（使用 C++）

我将举一个简单的例子。我有一个`Operator`包含方法的类`operate`。假设它看起来像这样：

```
double operate(double a, double b){
  return 0.0;
} 
```

用户将为`a`和 提供一些输入值，并`b`选择要执行的操作，假设他可以选择计算加法或乘法。鉴于它的输入，我可以做的就是实例化`Operator`和调用`operate(a, b)`，这正是我之前提到的写法。

计算乘法或加法的方法将在某个地方实现（不知道在哪里）。

总之，我必须根据用户的输入来改变我的 Operator 对象的行为。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-08T13:22:05.160

标准模式是让外部类有一个指向“实现”类的指针。

```
// derive multiple implementations from this:
class Implementation
{
    virtual ~Implementation() {} // probably essential!

    virtual void foo() = 0;
};

class Switcheroo
{
    Implementation *impl_;

public:
    // constructor, destructor, copy constructor, assignment 
    // must all be properly defined (any that you can't define, 
    // make private)

    void foo()
    {
        impl_->foo();
    }
}; 
```

通过将所有成员函数转发`Switcheroo`给`impl_`成员，您可以在需要时切换不同的实现。

这种模式有多种名称：Pimpl（“私有实现”的缩写）、智能引用（与智能指针相反，由于转发成员函数），它与代理和桥接模式有一些共同点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-08T13:25:21.423

我只是将其作为琐事提及，不能再不推荐了，但是我们开始...

**警告危险！！！**

我认为我见过的一个**愚蠢的把戏叫做抓握，但它只适用于真正愚蠢的人。**基本上，您将虚拟表指针交换为另一个类的指针，它可以工作，但理论上它可能会破坏世界或导致其他一些未定义的行为:)

无论如何，而不是只使用动态分类和犹太 C++，但作为一个实验，上面有点有趣......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T13:42:42.710

Coplien 的信封/字母模式（在他的*必读*书籍*Advanced C++ Programming Styles and Idioms*中）是执行此操作的经典方法。

简而言之，信封和信函都是抽象基类/接口的子类，它定义了所有子类的公共接口。

信封包含（并隐藏）一封信的真实类型。

各种 Letter 类对抽象类的公共接口有不同的实现。

Envelope 没有真正的实现；它只是转发（代表）它的信。它拥有一个指向抽象基类的指针，并将其指向一个具体的 Letter 类实例。由于需要更改实现，因此更改了 Letter 子类指针的类型。

由于用户只有对 Envelope 的引用，因此这种变化对他们来说是不可见的，除了 Envelope 的行为发生了变化。

Coplien 的例子特别干净，因为是字母，而不是信封引起了变化。

一个示例是 Number 类层次结构。抽象基声明了对所有数字的某些操作，例如加法。Integer 和 Complex 是具体子类的示例。

添加一个 Integer 和一个 Integer 会产生一个 Integer，但是添加一个 Interget 和一个 Complex 会产生一个 Complex。

这是添加的信封的样子：

```
public class Number {
  Number* add( const Number* const n ) ; // abstract, deriveds override
}

public class Envelope : public Number {
  private Number* letter;

...

  Number* add( const Number& rhs) { // add a number to this
    // if letter and rhs are both Integers, letter->add returns an Integer
    // if letter is a a Complex, or rhs is, what comes back is a Complex
    //
    letter = letter->add( rhs ) ) ;
    return this;
  }
} 
```

现在客户的指针永远不会改变，他们永远不需要知道信封持有什么。这是客户端代码：

```
int main() {
  // makeInteger news up the Envelope, and returns a pointer to it
  Number* i = makeInteger( 1 ) ;  
  // makeComplex is similar, both return Envelopes.
  Number* c = makeComplex( 1, 1 ) ;

  // add c to i
  i->add(c) ;

  // to this code, i is now, for all intents and purposes, a Complex!
  // even though i still points to the same Envelope, because 
  // the envelope internally points to a Complex.
} 
```

在他的书中，Coplien 进行了更深入的研究——您会注意到 add 方法需要某种形式的多分派——并添加了语法糖。但这是如何获得所谓的“运行时多态性”的*要点。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-08T13:23:59.120

除非该对象旨在通过某种技术（组合、回调等）使用“插件”行为，否则您不能使用任何理智的方式更改任意对象的行为。

（疯狂的方法可能是覆盖函数代码所在的进程内存......）

但是，您可以通过覆盖 vtable（[可以在本文中找到一种方法](http://www.cs.nmsu.edu/please/ddl/cppredirection.php)）来覆盖虚拟方法中的对象行为，而无需覆盖可执行页面中的内存。但这仍然不是一种非常明智的方法，并且存在多种安全风险。

最安全的做法是通过提供适当的挂钩（回调、组合...）来更改设计为要更改的对象的行为。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-08T13:12:47.990

您可以通过动态绑定（多态性）来实现它......但这一切都取决于您实际想要实现的目标。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T13:09:58.823

对象始终具有由其类定义的行为。

如果你需要不同的行为，你需要一个不同的类......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-27T21:29:02.123

您也可以考虑使用动态绑定的[角色模式](http://st-www.cs.uiuc.edu/~plop/plop97/Proceedings/riehle.pdf)..我正在努力解决您所做的同样的事情..我读到了策略模式，但角色听起来也是一个很好的解决方案......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T13:26:37.990

创建一个抽象类，将行为必须是可变的方法声明为虚拟的。创建将实现虚拟方法的具体类。使用设计模式有很多方法可以实现这一点。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-08T13:26:55.803

[您可以使用动态绑定](http://www.elilabs.com/~rj/dreams/node18.html)更改对象行为。[像Decorator](http://en.wikipedia.org/wiki/Decorator_pattern)，[Strategy](http://en.wikipedia.org/wiki/Strategy_pattern)这样的设计模式实际上会帮助你实现同样的目标。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-08T13:11:23.690

有很多方法可以做到这一点，pImpl 惯用语，多态性，所有这些都有利有弊。最适合您的解决方案将取决于您要解决的具体问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-08T13:16:36.577

很多很多方式：

一开始试试`if`。您始终可以使用 if 语句更改行为。那么您可能会发现“多态性”方式更准确，但这取决于您的任务。

# security - 寻找 Web 服务安全漏洞的真实案例

> ID：729908
> 
> 赞同：4
> 
> 时间：2009-04-08T13:07:31.187
> 
> 标签：security

我是一名全职软件开发人员，但另一方面，我正在教授一门关于 Web 服务的大学课程。我现在正在讨论安全问题，想知道你们是否有任何可以告诉我的安全漏洞（根据需要隐藏细节）我可以与我的学生分享。现实生活中的故事比虚构的场景更有意义......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T21:03:38.123

这是我的一个故事：

我曾经是一家在线有声读物商店的客户。除了使用用户名和密码验证自己之外，我还需要我的浏览器接受 cookie。这并不稀奇。存储会话 ID 可能需要 cookie。

但是我很困惑，因为会话 ID 也在 URL 中传输，我没有看到为什么需要 cookie 的原因。所以我查看了我的 cookie 罐，看看有什么非常重要的信息必须存储在 cookie 中。

除了会话 ID 的 cookie 之外，还有另一个名为 cookie 的 cookie `customer_id`，显然是通过我的客户编号指定来识别我的。我想：“<em>来吧，没人能这么傻！” 我通过更改数字的一位数字（例如从 12345 到 12346）来更改值以查看会发生什么。

现在猜猜看：我现在以不同的用户身份登录，*而无需*任何进一步的身份验证请求，只需更改 cookie！`customer_id`cookie 值显然不仅用于识别（我*是谁？*），还用于身份验证（*我真的是我假装的那个人吗？*）！

这个故事的寓意：**[始终将身份验证与身份验证分开。](http://technet.microsoft.com/library/cc512578.aspx)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T14:03:27.980

这可能不是您的想法，因为没有信息泄露，但这仍然是一个*非常严重*的网络安全问题。

[http://www.crime-research.org/library/grcdos.pdf](http://www.crime-research.org/library/grcdos.pdf)

这是互联网安全大师史蒂夫·吉布森 (Steve Gibson) 的网站如何被僵尸网络攻击的经典故事。这是一个非常有趣的故事，肯定会让全班都参与进来。我知道这个故事让我对网络安全更加感兴趣。

我在 Steve Gibson 的网站 (grc.com) 上找不到该 pdf 的原始帖子，但我的计算机上有一份副本，并且能够搜索并在给定位置找到它。

我还建议您访问 grc.com 并收听“Security Now！” 播客：

[http://www.grc.com/securitynow.htm](http://www.grc.com/securitynow.htm)

您几乎肯定会在其中一些播客中听到一些故事。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-18T13:18:07.820

慕尼黑的欧洲身份会议 (EIC 2009) 将以 SOA 安全性案例研究为特色，其中包含您所寻求的信息。

# c# - C# 中的标准委托

> ID：729912
> 
> 赞同：48
> 
> 时间：2009-04-08T13:08:50.153
> 
> 标签：c#, list, delegates

C# 中预定义了一些委托

我知道这些：

```
EventHandler // Default event callbacks
EventHandler<T> // Default event callbacks with custom parameter (inheriting from EventArgs)
Action // Function without return value and without parameter
Action<T1, T2, T3, T4> // Function without return value and 1-4 parameters
Func<T1, T2, T3, T4, TResult> // Methos with 0-4 parameters and one result type
Predicate<T> // equivalent to Func<T, bool> 
```

对于特殊情况和生成的框架部分还有更多，但这些通常可以很好地用于自行编写的代码。

如果您知道一些更有用的添加它们。否则，这是回答。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-08T13:12:40.533

它们不是在 C# 中预定义的。它们由*框架*定义。

`Action`和`Func`委托的家庭比你展示的更广泛——他们上升到

```
Action<T1, T2, T3, T4> 
```

和

```
Func<T1, T2, T3, T4, TResult> 
```

.NET 2.0 中另一个常见的列表操作（在 LINQ 之前）是`Predicate<T>`.

对于使用线程：

```
ThreadStart
ParameterizedThreadStart
WaitCallback
TimerCallback
AsyncCallback 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T13:15:00.827

我喜欢使用`Predicate<T>`相当于`Func<T, bool>`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T13:12:28.273

转到[反射器](http://www.red-gate.com/products/reflector/)搜索**System.MulticastDelegate**并检查派生类型。您将获得您正在寻找的所有代表的列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-01T22:53:12.847

我也遇到过

```
Comparison<T> 
```

在里面

```
List.Sort(Comparison<T>) 
```

通用方法。我想这现在相当于：

```
Func<T1, T2, int> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T13:15:35.893

我经常使用`WaitCallback`并且`ThreadStart`经常足以让他们得到提及。

如果您知道您所追求的委托人的*签名*，但您不知道是否有具有该签名的*现有*委托人可以使用，您可以按照我博客上的[这些说明进行查找。](http://kentb.blogspot.com/2008/01/consolidating-delegates-with-reflector.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-29T16:24:11.120

System.Windows.ValidateValueCallback 表示用作验证依赖属性的有效值的回调的方法。

阅读更多：[MSDN：ValidateValueCallback 委托](http://msdn.microsoft.com/en-us/library/system.windows.validatevaluecallback.aspx)

# asp.net - 法语 IIS7 自定义错误页面语言

> ID：729913
> 
> 赞同：2
> 
> 时间：2009-04-08T13:09:18.890
> 
> 标签：asp.net, iis, iis-7, windows-server-2008

IIS7下提供自定义错误页面；

C:\inetpub\custerr\en-US

但是我也想要其他一些欧洲语言，因为默认情况下只提供英语。有没有人看到错误页面“语言包”可以在任何地方下载。我是否必须安装完整的 Windows 语言包，我宁愿不用。

[http://www.microsoft.com/Downloads/details.aspx?FamilyID=e9f6f200-cfaf-4516-8e96-e4d4750397ff](http://www.microsoft.com/Downloads/details.aspx?FamilyID=e9f6f200-cfaf-4516-8e96-e4d4750397ff "Server 2008 语言包下载")

蒂姆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-12-17T21:51:20.207

我认为这在任何地方都不存在。我的建议是将语言包下载到您不关心的计算机上并手动复制它们。我假设您只是想不使用不必要的软件污染您的服务器。

# javascript - 设置超时或设置间隔？

> ID：729921
> 
> 赞同：793
> 
> 时间：2009-04-08T13:11:01.100
> 
> 标签：javascript, setinterval

据我所知，这两段 javascript 的行为方式相同：

**选项 A：**

```
function myTimeoutFunction()
{
    doStuff();
    setTimeout(myTimeoutFunction, 1000);
}

myTimeoutFunction(); 
```

**选项 B：**

```
function myTimeoutFunction()
{
    doStuff();
}

myTimeoutFunction();
setInterval(myTimeoutFunction, 1000); 
```

[使用setTimeout](https://developer.mozilla.org/en-US/docs/Web/API/setTimeout)和[setInterval](https://developer.mozilla.org/en-US/docs/Web/API/setInterval)有什么区别吗？

* * *

## 回答 #1

> 赞同：692
> 
> 时间：2009-04-08T13:14:46.583

他们基本上尝试做同样的事情，但这种`setInterval`方法会比这种`setTimeout`方法更准确，因为`setTimeout`等待 1000 毫秒，运行函数，然后设置另一个超时。所以等待时间实际上比 1000 毫秒多一点（如果你的函数需要很长时间才能执行，那么等待时间会更长）。

尽管有人可能认为它`setInterval`会每 1000 毫秒执行一次，但重要的是要注意这也会延迟，因为 JavaScript**不是**`setInterval`一种多线程语言，这意味着 - 如果脚本的其他部分正在运行 - 间隔将有等待完成。

在[这个 Fiddle](http://jsfiddle.net/GustvandeWal/295jqqqb/)中，您可以清楚地看到超时将落后，而时间间隔几乎一直是 1 次调用/秒（脚本试图这样做）。如果将顶部的速度变量更改为 20 之类的小值（这意味着它将尝试每秒运行 50 次），则间隔永远不会达到平均每秒 50 次迭代。

延迟几乎总是可以忽略不计，但如果你正在编程非常精确的东西，你应该选择一个*自我调整计时器*（它本质上是一个基于超时的计时器，它会不断调整自身以适应它所创建的延迟）

* * *

## 回答 #2

> 赞同：659
> 
> 时间：2009-04-08T20:13:28.137

> 有什么区别吗？

是的。一个 Timeout 在 setTimeout() 被调用后执行一定的时间；间隔在上一个间隔触发后执行一定的时间。

如果您的 doStuff() 函数需要一段时间才能执行，您会注意到差异。例如，如果我们用 表示对 setTimeout/setInterval 的调用，用 表示`.`超时/间隔的触发，用 表示`*`JavaScript 代码执行`[-----]`，则时间线如下所示：

```
Timeout:

.    *  .    *  .    *  .    *  .
     [--]    [--]    [--]    [--]

Interval:

.    *    *    *    *    *    *
     [--] [--] [--] [--] [--] [--] 
```

下一个复杂情况是，如果在 JavaScript 已经忙于做某事（例如处理前一个间隔）时触发了间隔。在这种情况下，间隔会被记住，并在前一个处理程序完成并将控制权返回给浏览器时立即发生。例如，对于一个有时很短 ([-]) 有时很长 ([-----]) 的 doStuff() 过程：

```
.    *    *    •    *    •    *    *
     [-]  [-----][-][-----][-][-]  [-] 
```

• 表示无法立即执行其代码的间隔触发，而是处于挂起状态。

因此，间隔尝试“赶上”以恢复进度。但是，它们不会将一个放在彼此之上：每个间隔只能有一个待执行的执行。（如果他们都排队，浏览器会留下一个不断扩大的未完成执行列表！）

```
.    *    •    •    x    •    •    x
     [------][------][------][------] 
```

x 表示无法执行或被挂起的间隔触发，因此被丢弃。

如果你的 doStuff() 函数的执行时间习惯性地比为它设置的时间间隔长，浏览器将消耗 100% 的 CPU 来尝试服务它，并且可能会变得反应迟钝。

> 你使用哪个，为什么？

Chained-Timeout 为浏览器提供有保证的空闲时间；Interval 尝试确保它正在运行的函数尽可能接近其预定时间执行，但会牺牲浏览器 UI 的可用性。

我会考虑一次性动画的间隔，我希望尽可能平滑，而链接超时对于在页面加载时一直发生的持续动画更礼貌。对于要求不高的用途（例如每 30 秒触发一次的微不足道的更新程序等），您可以安全地使用其中任何一个。

在浏览器兼容性方面，setTimeout 早于 setInterval，但您今天遇到的所有浏览器都支持这两者。多年以来的最后一个落后者是 WinMo <6.5 中的 IE Mobile，但希望它现在也已落后于我们。

* * *

## 回答 #3

> 赞同：95
> 
> 时间：2013-08-14T05:12:32.157

### 设置间隔（）

`setInterval()`是一种基于时间间隔的代码执行方法，具有在达到间隔时重复运行指定脚本的本机能力。脚本作者不应*将*其嵌套到其回调函数中以使其循环，因为它***默认循环***。除非您调用`clearInterval()`.

如果要循环动画或时钟滴答的代码，请使用`setInterval()`.

```
function doStuff() {
    alert("run your code here when time interval is reached");
}
var myTimer = setInterval(doStuff, 5000); 
```

### 设置超时（）

`setTimeout()`是一种基于时间的代码执行方法，当达到间隔时将只执行***一次脚本。***它*不会*再次重复，除非您通过将对象嵌套在`setTimeout()`它调用运行的函数内来使其循环脚本。如果适合循环，除非您调用`clearTimeout()`.

```
function doStuff() {
    alert("run your code here when time interval is reached");
}
var myTimer = setTimeout(doStuff, 5000); 
```

如果您希望某事在指定时间段后发生一次，请使用`setTimeout()`. 那是因为它只在达到指定的时间间隔时执行一次。

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2009-04-08T13:25:24.420

setInterval 可以更轻松地取消将来执行代码。如果您使用 setTimeout，则必须跟踪计时器 ID，以防您以后想取消它。

```
var timerId = null;
function myTimeoutFunction()
{
    doStuff();
    timerId = setTimeout(myTimeoutFunction, 1000);
}

myTimeoutFunction();

// later on...
clearTimeout(timerId); 
```

相对

```
function myTimeoutFunction()
{
    doStuff();
}

myTimeoutFunction();
var timerId = setInterval(myTimeoutFunction, 1000);

// later on...
clearInterval(timerId); 
```

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-04-08T14:20:02.760

`setTimeout`如果您想取消超时，我发现该方法更易于使用：

```
function myTimeoutFunction() {
   doStuff();
   if (stillrunning) {
      setTimeout(myTimeoutFunction, 1000);
   }
}

myTimeoutFunction(); 
```

此外，如果函数中出现问题，它将在第一次错误时停止重复，而不是每秒重复一次错误。

* * *

## 回答 #6

> 赞同：20
> 
> 时间：2014-01-11T10:16:45.857

不同之处在于它们的目的。

```
setInterval()
   -> executes a function, over and over again, at specified time intervals  

setTimeout()
   -> executes a function, once, after waiting a specified number of milliseconds 
```

就这么简单

更详细的细节在这里[http://javascript.info/tutorial/settimeout-setinterval](http://javascript.info/tutorial/settimeout-setinterval)

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2014-04-26T17:42:53.623

当您在 setInterval 中运行某些函数时，它的工作时间比超时时间长-> 浏览器将被卡住。

- 例如，**doStuff()**需要 1500 秒。要执行，然后执行：**setInterval(doStuff, 1000);**
1) 浏览器运行**doStuff()**需要 1.5 秒。被执行；
2) 约 1 秒后，它尝试再次运行**doStuff()**。但是之前的**doStuff()**仍然执行->所以浏览器将此运行添加到队列中（在第一次完成后运行）。
3,4,..) 相同的添加到下一次迭代的执行队列中，但之前的**doStuff()**仍在进行中...... 结果 -
**浏览器卡住了。**

为了防止这种行为，最好的方法是在 setTimeout 中运行**setTimeout 来模拟 setInterval**。
要更正 setTimeout 调用之间的超时，您可以使用[自更正替代 JavaScript 的 setInterval](http://www.andrewduthie.com/post/a-self-correcting-setinterval-alternative/)技术。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2016-12-24T11:32:08.653

您的代码将有不同的执行间隔，并且在某些项目中，例如在线游戏，这是不可接受的。首先，你应该怎么做，为了让你的代码使用相同的间隔，你应该将“myTimeoutFunction”更改为：

```
function myTimeoutFunction()
{
    setTimeout(myTimeoutFunction, 1000);
    doStuff();
}
myTimeoutFunction() 
```

此更改后，它将等于

```
function myTimeoutFunction()
{
    doStuff();
}
myTimeoutFunction();
setInterval(myTimeoutFunction, 1000); 
```

但是，你仍然会得到不稳定的结果，因为 JS 是单线程的。目前，如果 JS 线程忙于某事，它将无法执行您的回调函数，执行将推迟 2-3 毫秒。您是否每秒执行 60 次，并且每次随机延迟 1-3 秒，这绝对是不可接受的（一分钟后延迟约为 7200 毫秒），我可以建议使用这样的东西：

```
 function Timer(clb, timeout) {
        this.clb = clb;
        this.timeout = timeout;
        this.stopTimeout = null;
        this.precision = -1;
    }

    Timer.prototype.start = function() {
        var me = this;
        var now = new Date();
        if(me.precision === -1) {
            me.precision = now.getTime();
        }
        me.stopTimeout = setTimeout(function(){
            me.start()
        }, me.precision - now.getTime() + me.timeout);
        me.precision += me.timeout;
        me.clb();
    };

    Timer.prototype.stop = function() {
        clearTimeout(this.stopTimeout);
        this.precision = -1;
    };

    function myTimeoutFunction()
    {
        doStuff();
    }

    var timer = new Timer(myTimeoutFunction, 1000);
    timer.start(); 
```

此代码将保证稳定的执行周期。甚至线程会很忙，你的代码会在 1005 毫秒后执行，下次它会有 995 毫秒的超时，结果会稳定。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2009-04-08T13:15:52.290

我使用 setTimeout。

显然不同之处在于 setTimeout 调用该方法一次， setInterval 重复调用它。

这是一篇很好的文章，解释了区别：[教程：带有 setTimeout 和 setInterval 的 JavaScript 计时器](http://www.elated.com/articles/javascript-timers-with-settimeout-and-setinterval/)

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2012-11-25T22:20:23.383

我对 进行了简单的测试`setInterval(func, milisec)`，因为我很好奇当函数时间消耗大于间隔持续时间时会发生什么。

`setInterval`**通常**会在前一次迭代**开始**之后安排下一次迭代，**除非函数仍在进行**中。如果是这样，`setInterval`将等待，直到函数结束。一旦发生，该函数会立即再次触发 - 无需根据计划等待下一次迭代（因为它会在没有超时函数的条件下）。也没有并行迭代运行的情况。

我已经在 Chrome v23 上对此进行了测试。我希望它是所有现代浏览器的确定性实现。

```
window.setInterval(function(start) {
    console.log('fired: ' + (new Date().getTime() - start));
    wait();
  }, 1000, new Date().getTime()); 
```

控制台输出：

```
fired: 1000    + ~2500 ajax call -.
fired: 3522    <------------------'
fired: 6032
fired: 8540
fired: 11048 
```

该`wait`函数只是一个线程阻塞助手 - 同步 ajax 调用，在服务器端需要**2500 毫秒的处理时间：**

```
function wait() {
    $.ajax({
        url: "...",
        async: false
    });
} 
```

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-04-08T14:47:06.423

setInterval 和 setTimeout 都返回一个计时器 id，您可以使用它来取消执行，即在触发超时之前。要取消，您可以像这样调用 clearInterval 或 clearTimeout：

```
var timeoutId = setTimeout(someFunction, 1000);
clearTimeout(timeoutId);
var intervalId = setInterval(someFunction, 1000),
clearInterval(intervalId); 
```

此外，当您离开页面或关闭浏览器窗口时，超时会自动取消。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2015-01-27T20:25:28.987

换个角度来看：setInterval 确保代码以每个给定的时间间隔（即 1000 毫秒，或您指定的时间间隔）运行，而 setTimeout 设置它“等待直到”运行代码的时间。而且由于运行代码需要额外的毫秒，它加起来是 1000 毫秒，因此 setTimeout 会在不精确的时间（超过 1000 毫秒）再次运行。

例如，计时器/倒计时不是使用 setTimeout 完成的，而是使用 setInterval 完成的，以确保它不会延迟并且代码以确切的给定间隔运行。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-11-17T21:45:40.587

当您运行以下 javascript 或检查此[JSFiddle时，您可以自己验证 bobince 答案](http://jsfiddle.net/dcy82Lj2/1/)

```
<div id="timeout"></div>
<div id="interval"></div>

var timeout = 0;
var interval = 0;

function doTimeout(){
    $('#timeout').html(timeout);
    timeout++;
    setTimeout(doTimeout, 1);
}

function doInterval(){
    $('#interval').html(interval);
    interval++;
}

$(function(){
    doTimeout();
    doInterval();
    setInterval(doInterval, 1);
}); 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2011-10-18T16:48:42.097

好吧，正如我刚刚了解到的，在一种情况下 setTimeout 更好。我总是使用 setInterval，我在后台运行了半个多小时。当我切换回该选项卡时，幻灯片（使用代码的）变化非常迅速，而不是它应该每 5 秒发生一次。事实上，当我对其进行更多测试时，它确实会再次发生，并且它是否是浏览器的错误并不重要，因为使用 setTimeout 这种情况是完全不可能的。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-01-04T21:02:31.980

控制台中的区别很明显：

![在此处输入图像描述](https://i.stack.imgur.com/VP6ax.png)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-05-26T15:43:34.317

只需添加已经说过的内容，但代码的 setTimeout 版本也将达到`Maximum call stack size`将阻止它运行的内容。由于递归函数没有停止的基本情况，因此您不能让它*永远运行。*

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-07-06T10:54:05.350

如果您将时间间隔设置`setInterval`得太短，它可能会在上一次调用该函数完成之前触发。我使用最近的浏览器（Firefox 78）遇到了这个问题。这导致垃圾收集无法足够快地释放内存并造成巨大的内存泄漏。Using`setTimeout(function, 500);`给了垃圾收集足够的时间来清理并保持内存随着时间的推移稳定。

Serg Hospodarets 在他的回答中提到了这个问题，我完全同意他的说法，但他没有包括内存泄漏/垃圾收集问题。我也经历了一些冻结，但内存使用量很快就达到了 4 GB，用于一些小任务，这对我来说真是太糟糕了。因此，我认为这个答案在我的情况下仍然对其他人有益。我会把它放在评论中，但缺乏这样做的声誉。我希望你不要介意。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-03-11T17:06:32.213

**选项 A**和**选项 B**看起来工作方式相同的原因主要是因为函数的位置和`setInterval`位置`setTimeout`。

```
function myTimeoutFunction()
{
    doStuff();
    setTimeout(myTimeoutFunction, 1000);
}

myTimeoutFunction(); 
```

这是一个递归函数，如果`doStuff`非常复杂，`setTimeout`必须跟踪所有对`setTimout`plus current*的*`doStuff`调用，这使得它变得越来越*慢*。

 *```
function myTimeoutFunction()
{
    doStuff();
}

myTimeoutFunction();
setInterval(myTimeoutFunction, 1000); 
```

另一方面，`setInterval`only 必须跟踪 last`setInterval`和 current `doStuff`，使其保持*恒定*速度。

那么你应该使用哪一个呢？

从上面，您应该可以得出结论，更好的是`setInterval`.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-12-22T16:08:33.627

要考虑的重要一点是性能。定期运行函数的唯一方法`setTimeout`是使用目标函数递归调用它，当你检查它时，它似乎是异步工作的，当你看到调用堆栈时你会发现它一直在增长。事实上，这是明智的。由于Javascript不支持多线程，所以在子函数完成之前不可能完成父函数的调用，因此只要有递归调用，栈就会一直增长。同时，`setInterval`我们不需要递归调用目标函数，因为它有一个逻辑可以将其作为循环定期运行。因此，这使调用堆栈保持清洁。您可以使用浏览器中的开发人员工具查看调用堆栈，您会注意到其中的不同。

长时间使用小间隔时，差异会很明显。

* * *

## 回答 #20

> 赞同：-5
> 
> 时间：2013-04-17T02:15:31.997

我认为`SetInterval`和`SetTimeout`不同。`SetInterval`根据设置的时间执行块 while，`SetTimeout`执行代码块一次。

在超时倒计时秒后尝试这组代码：

```
setInterval(function(e){
    alert('Ugbana Kelvin');
}, 2000); 
```

然后尝试

```
setTimeout(function(e){
    alert('Ugbana Kelvin');
}, 2000); 
```

您可以自己查看差异。

# inheritance - 平等和哈希码提供者的组合与继承

> ID：729924
> 
> 赞同：3
> 
> 时间：2009-04-08T13:11:26.683
> 
> 标签：inheritance, oop, equality, composition

在比较实体和聚合根时，我使用从 Oren Eini 借来的 ABC：[Generic Entity Equality](http://ayende.com/Blog/archive/2007/06/05/Generic-Entity-Equality.aspx)。对于价值对象，我同样巧妙。我使用了 Jimmy Bogard 的 Value Object ABC：[Generic Value Object Equality](http://grabbagoft.blogspot.com/2007/06/generic-value-object-equality.html)

现在我的问题是；我应该倾向于继承这些 ABC 还是应该使用通用[相等](http://msdn.microsoft.com/en-us/library/ms131188.aspx)/[比较器](http://msdn.microsoft.com/en-us/library/ms132152.aspx)并代替上述行为？我打算重用上述相等实现。

我认为这又回到了 System.Object 具有默认的 Equals 实现，这使得该语言非常易于使用，但也提供了有趣的难题。Jon Skeet 在这里详细介绍：[比较方法](http://msmvps.com/blogs/jon_skeet/archive/2008/12/05/redesigning-system-object-java-lang-object.aspx)

任何人都可以想到任何优点或缺点吗？

*   继承 ABC 更容易，并提供开箱即用的运算符重载。
*   我应该这么“拖”两个抽象类吗？它使我的继承图更复杂/增加了耦合。
*   我可以使用 DI 来组成平等提供者吗？

总而言之，有没有人有使用实体的自定义相等实现的经验？我的目标是更全面地了解实施选择并实施解决方案，这将延长项目的生命周期（减少熵）并提高可维护性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-11T09:17:34.327

这并不能真正回答您的问题（对不起！），但我认为这是一个试图帮助您解决这里的一些问题的项目。我不久前写了这些东西，但从那时起就没有做过任何事情。

该项目称为 Essence ( [http://essence.codeplex.com/](http://essence.codeplex.com/) )，它使用 System.Linq.Expression 库生成（基于属性）Equals/GetHashCode/CompareTo/ToString 的标准表示，以及能够基于参数列表创建 IEqualityComparer 和 IComparer 类。（我也有一些进一步的想法，但想在继续深入之前获得一些社区反馈。）

（这意味着它几乎和手写一样快 - 不是的主要是 CompareTo(); 因为 Linq.Expressions 在 3.5 版本中没有变量的概念 - 所以你有当你没有得到匹配时，在底层对象上调用 CompareTo() 两次。使用 Linq.Expressions 的 DLR 扩展解决了这个问题。我想我可以使用 emit il，但当时我并没有那么灵感.)

这是一个非常简单的想法，但我以前从未见过它。

现在的问题是，我对完善它失去了兴趣（这将包括为 codeproject 写一篇文章，记录一些代码等），但如果你觉得这会是什么，我可能会被说服这样做出于兴趣。

（codeplex 站点没有可下载的包；只需转到源代码并获取它 - 哦，它是用 f# 编写的（尽管所有测试代码都在 c# 中），因为这是我有兴趣学习的东西。）

无论如何，这是我的测试用例中的一些示例 C# 示例。

```
 // --------------------------------------------------------------------
    // USING MY ESSENCE LIBRARY:
    // --------------------------------------------------------------------
    [EssenceClass(UseIn = EssenceFunctions.All)]
    public class TestEssence : IEquatable<TestEssence>, IComparable<TestEssence>
    {
        [Essence(Order=0, Format="i={0},")]           public int MyInt           { get; set; }
        [Essence(Order=1, Format="s={0},")]           public string MyString     { get; set; }
        [Essence(Order=2, Format="d={0:yyyy-MM-dd}")] public DateTime MyDateTime { get; set; }

        public override int GetHashCode()                                { return Essence<TestEssence>.GetHashCodeStatic(this); }
        public override string ToString()                                { return Essence<TestEssence>.ToStringStatic(this); }
        public int CompareTo(TestEssence other)                          { return Essence<TestEssence>.CompareToStatic(this, other); }

        public static bool operator ==(TestEssence lhs, TestEssence rhs) { return Essence<TestEssence>.EqualsStatic(lhs, rhs); }
        public override bool Equals(object obj)                          { return this == (TestEssence)obj; }
        public bool Equals(TestEssence other)                            { return this == other; }
        public static bool operator !=(TestEssence lhs, TestEssence rhs) { return !(lhs == rhs); }
    }

    // --------------------------------------------------------------------
    // EQUIVALENT HAND WRITTEN CODE:
    // --------------------------------------------------------------------
    public class TestManual
    {
        public int MyInt;
        public string MyString;
        public DateTime MyDateTime;

        public override int GetHashCode()
        {
            var x = MyInt.GetHashCode();
            x *= Essence<TestEssence>.HashCodeMultiplier;
            x ^= (MyString == null) ? 0 : MyString.GetHashCode();
            x *= Essence<TestEssence>.HashCodeMultiplier;
            x ^= MyDateTime.GetHashCode();
            return x;
        }

        public static bool operator ==(TestManual lhs, TestManual rhs)
        {
            if (ReferenceEquals(lhs, null))
            {
                if (ReferenceEquals(rhs, null))
                    return true;
                return false;
            }
            if (ReferenceEquals(rhs, null))
                return false;
            if (ReferenceEquals(lhs, rhs))
                return true;
            if (typeof(TestManual) != rhs.GetType())
                return false;

            return lhs.MyInt == rhs.MyInt
                && lhs.MyString == rhs.MyString
                && lhs.MyDateTime == rhs.MyDateTime;
        }

        public override bool Equals(object obj)                 { return this == obj as TestManual; }
        public bool Equals(TestManual other)                    { return this == other; }
        public static bool operator !=(TestManual lhs, TestManual rhs) { return !(lhs == rhs); }

        public override string ToString()
        {
            if (MyString == null)
                return string.Format("i={0},d={1:yyyy-MM-dd}", MyInt, MyDateTime);

            return string.Format("i={0},s={1},d={2:yyyy-MM-dd}", MyInt, MyString, MyDateTime);
        }

        public int CompareTo(TestManual other)
        {
            if (other == null)
                return 1;
            if (ReferenceEquals(this, other))
                return 0;

            int result = 0;

            result = MyInt.CompareTo(other.MyInt);
            if (result != 0) return result;
            result = MyString.CompareTo(other.MyString);
            if (result != 0) return result;
            result = MyDateTime.CompareTo(other.MyDateTime);
            if (result != 0) return result;

            return result;
        }
    }

    // --------------------------------------------------------------------
    // --------------------------------------------------------------------
    // ALTERNATIVE USAGE
    // --------------------------------------------------------------------
    // --------------------------------------------------------------------

    class Simple
    {
        public Simple(int value) { Value1 = value; }
        public Simple(int value1, int value2) { Value1 = value1; Value2 = value2; }
        public readonly int Value1;
        public readonly int Value2;
    }

    [Test]
    public void TestReverseForwardString()
    {
        var _11 = new Simple(1, 1);
        var _12 = new Simple(1, 2);
        var _21 = new Simple(2, 1);
        var _22 = new Simple(2, 2);

        var items = new[] { _11, _12, _21, _22 };
        var reverseComparer = Essence<Simple>.CreateComparer("-Value1", "Value2");

        Array.Sort(items, reverseComparer);

        Assert.AreSame(_21, items[0]);
        Assert.AreSame(_22, items[1]);
        Assert.AreSame(_11, items[2]);
        Assert.AreSame(_12, items[3]);
    }

    [Test]
    public void TestReverseForwardLambda()
    {
        var _11 = new Simple(1, 1);
        var _12 = new Simple(1, 2);
        var _21 = new Simple(2, 1);
        var _22 = new Simple(2, 2);

        var items = new[] { _11, _12, _21, _22 };
        var reverseComparer = Essence<Simple>.CreateComparer(x => x.Action.ReverseNext, x => x.Member.Value1, x => x.Member.Value2);

        Array.Sort(items, reverseComparer);

        Assert.AreSame(_21, items[0]);
        Assert.AreSame(_22, items[1]);
        Assert.AreSame(_11, items[2]);
        Assert.AreSame(_12, items[3]);
    } 
```

玩得开心！

保罗。

# mysql - 未创建 MySQL 二进制日志文件 - Windows XP

> ID：729933
> 
> 赞同：1
> 
> 时间：2009-04-08T13:12:53.013
> 
> 标签：mysql, windows, xampp

我已经安装了 MySQL 作为 XAMPP 的一部分。

在尝试[设置复制](http://dev.mysql.com/doc/refman/5.0/en/replication-howto-masterbaseconfig.html)时，我在 c:\windows\my.ini 中添加了以下几行：

[mysqld]
log-bin=C:/mysql-bin
server-id=1

正如你所看到的，我已经为日志文件指定了一个完整的路径名，所以毫无疑问它在哪里。我还按照[建议](http://dev.mysql.com/doc/refman/5.0/en/windows-create-option-file.html)使用了正斜杠。我已经在 WinMySQLadmin 中确认正在读取 my.ini。

我已经运行了一个 INSERT 查询，并在 phpMyAdmin 中确认该表已更新。我已经完成了带有读锁的刷新表。在上面的链接中，这是设置复制的推荐下一步，但为了以防日志文件的输出被缓冲，我希望这会刷新它。但是 mysql-bin* 形式的文件不会出现在 C: 驱动器的任何位置。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-15T11:34:08.517

答案似乎存在于一个隐藏的 my.cnf 文件中。

MySQL 配置可以存储在 my.ini 或 my.cnf、C:\、C:\WINDOWS 或 MySQL 目录本身中。在 Windows 资源管理器中，my.cnf 显示为普通的 my（即使我没有隐藏已知文件类型的扩展名）。如果我让 Windows 搜索它，它不会找到它（显然它认为 .cnf 文件是快捷方式并忽略它们）。如果 my.ini 和 my.cnf 都存在，则几乎不可见的 my.cnf 优先。

WinMySQLadmin 显示 my.ini 的内容（被忽略）并没有帮助，但 my.cnf 的内容（不是）没有帮助。

# c# - 数据集和 XML 代替适当的 db：不是一个好主意吗？

> ID：729938
> 
> 赞同：2
> 
> 时间：2009-04-08T13:14:12.450
> 
> 标签：c#, .net-3.5, ado.net, dataset

继续：[在 xml 中存储 DataRelation？](https://stackoverflow.com/questions/729634/storing-datarelation-in-xml)

感谢大家对我之前的帖子的回答。但是，我能问一下为什么每个人都不支持这种基于 XML 的方法吗？究竟会出现什么问题？我可以对数据集应用约束，我猜我也可以使用事务。

我是新来的。因此，如果您能指出一些链接，我可以在其中找到某种比较，那将非常有帮助。

根据常见问题解答，讨论不是很受鼓励，但我想这是非常具体的。我希望，不要因此被解雇... :)

感谢阅读，索拉布。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-08T13:22:03.053

并发将是主要问题，多个用户想要访问同一个“数据库”文件。性能是另一个，因为必须将整个文件加载到内存中。如果文件大小增加，它将变得难以管理。此外，查询的性能也会受到影响，因为它不会像 RDBMS 那样为您完成调整和磨练的东西那么有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T13:25:59.503

数据库管理系统专门设计用于存储数据并快速检索数据，以保持数据的完整性并利用对数据的并发访问。

另一方面，XML 最初是为文档设计的，将内容与表示分离。它成为一种存储简单数据的便捷方式，因为文件结构定义得非常好，然后人们试图将整个数据库存储在一个不合适的结构中就失控了。

XML 不保证原子性、并发性、完整性、快速访问或类似的东西。反正不是天生的。.NET 的 DataSet 库在这方面确实有所帮助，但仅仅因为您可以将 DataSet 对象序列化为 XML 并不能使它成为为多个用户存储数据的好地方。

当您面对两种工具时，一种旨在完全执行您需要做的事情（在本例中为 DBMS），另一种旨在执行其他操作但已被整合为您想要做的事情，排序（在在这种情况下 XML），您可能应该使用第一个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T13:22:41.617

虽然我需要研究来支持这一点，但我怀疑不使用实际数据库会影响性能。

如果将来有可能构建在不同平台（不是 ADO.NET）上的另一个应用程序可能需要访问您的数据，那么必须使用巨大的 XML 文件很可能会使生活变得更加困难。关系数据库是解决此类问题的标准方法。

# apache-flex - flex textflow 文本高度

> ID：729945
> 
> 赞同：1
> 
> 时间：2009-04-08T13:14:57.563
> 
> 标签：apache-flex, flex3, air

我的应用程序中有一个 flex 数据网格。在那我有一个 itemrenderer 作为画布上的文本流。现在我想在数据网格的 itemrenderers 上实现查找/替换功能。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T16:06:12.207

我认为最简单的解决方案是扩展您正在使用的 itemRenderer，以便以某种方式识别与它们中的每一个相关联的数据。

itemRenderer 会在显示中重复使用，因此您的每个项目都没有一个唯一的渲染器。

我不知道我是否清楚。

# java - 禁止在包外直接扩展 Java 类

> ID：729954
> 
> 赞同：7
> 
> 时间：2009-04-08T13:17:13.347
> 
> 标签：java, inheritance, api-design

我有一个包裹

```
public abstract class Player { /*...*/ } 
```

还有这些

```
public abstract class GamePlayer extends Player { /*...*/ }
public abstract class TournamentPlayer extends Player { /*...*/ }
public abstract class StatelessPlayer extends Player { /*...*/ } 
```

该软件包的用户需要 Player，但为了在不破坏它的情况下使用该软件包，我要求他们永远不要*直接*扩展 Player。相反，他们应该扩展提供的子类之一。

问题：我应该如何防止用户直接扩展 Player？

我正在寻找一种方法来明确表明该禁令是有意的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-08T13:23:37.233

使构造函数`Player`仅具有包访问权限。然后他们将无法调用构造函数或自己扩展它。*如果您在 中还*没有显式构造函数`Player`，请创建一个（否则编译器将创建一个默认的公共无参数构造函数）。

（请注意，我只建议对*构造函数*执行此操作。类本身可以是公共的，以便客户端仍然可以使用它。）

这是有效的，因为任何构造函数（除了 in `java.lang.Object`）都必须调用超类构造函数（显式或隐式）。如果没有可访问的构造函数，则无法创建子类。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-08T13:24:28.603

确保 Player 的构造函数不公开：

```
public abstract class Player {
    Player() {
        // initialization goes here
    }
} 
```

然后类可以从同一个包内扩展 Player，但不能从包外扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T13:25:35.340

嗯……让 Player 类不公开？省略“public”，那么它将是包私有的，即只有同一个包中的类可以扩展它。

但是，没有什么能完全阻止人们将自己的类放入该包中。我相信可以通过将其放入已签名的 JAR 中来防止它，然后在同一包中加载未签名（或不同签名）类的任何尝试都将失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T15:06:02.883

我会推荐

*   为您希望客户端访问但不创建或子类的事物创建公共接口
*   为您希望客户访问*和*创建或子类化的事物创建公共类
*   其他任何事情都应该是非公开的

这种方法的问题在于，您最终需要将所有内容放在一个包中，随着库的增长，这对组织不利。

要允许使用具有保护的多个包，请查看 OSGi。

OSGi 允许您限制一个包（jar）允许其他包访问哪些包，甚至设置允许额外可见性的“朋友”包。

当您真的想保护变得很大的库时，Java 的包即保护单元模型是不够的......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-08T13:23:08.997

使用默认访问修饰符，也称为“包私有”访问。换句话说，不要指定访问修饰符

```
abstract class Player { /*...*/ } 
```

[Sun 网站上](http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html)的文档更详细地描述了所有访问修饰符。

# deployment - ClickOnce 和用户设置

> ID：729959
> 
> 赞同：5
> 
> 时间：2009-04-08T13:18:43.187
> 
> 标签：deployment, clickonce, settings

好的，我有一个正在测试的 ClickOnce 应用程序，当用户第一次使用加载应用程序时，我会向他们询问几条信息；客户 ID 和名称。然后我设置属性，以便它们可以跨会话保存。该属性是 Properties.Settings.Default["Customer ID"] 和名称类似。

所以我通过控制面板卸载应用程序并重新安装应用程序但设置仍然存在！我去找我的应用程序的所有目录并删除设置，但应用程序的行为就像它仍然有它们一样。我什至可以单步调试调试器并查看它们是否仍然存在。

我如何摆脱它们？这是非常令人沮丧的，因为它几乎不可能测试新数据和调试任何首次安装。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T13:24:38.757

我相信用户配置值存储在这个位置：

```
%APPDATA%\<AppName>\<AppName><AppConfigName_GUID>\<AssemblyVersion>\user.config 
```

你在那里查过吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T16:15:15.383

好的，以防将来有人遇到同样的问题。我已经通过 Settings.settings 编辑器在 Visual Studio 中设置了属性。我删除了它们，一切又恢复了正常...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-03T09:32:09.853

为了解决重新安装程序时删除设置的一般问题，您还可以添加唯一的数据，例如可执行文件的日期、其校验和或类似的东西。

然后在程序启动时检查保存的数据。如果它们不匹配，则重新安装，您可以删除存储的数据。

# java - Java 类型无法解析

> ID：729960
> 
> 赞同：5
> 
> 时间：2009-04-08T13:18:46.387
> 
> 标签：java

我有一个声明

```
String pass = com.liferay.portal.util.PortalUtil.getUserPassword(renderRequest); 
```

这会在 Eclipse IDE 中导致以下错误：

> javax.servlet.http.HttpSession 类型无法解析。它是从所需的 .class 文件中间接引用的

为什么会出现这个错误？我已经为该类型添加了一个导入语句，但错误仍然存​​在。如何消除此错误？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-08T13:22:28.157

听起来您没有引用正确的库。添加对 servlet.jar 的引用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-08T13:22:35.003

您需要将该类的定义（通常包含在 servlet.jar 文件中）放入项目的构建路径中（右键单击项目，选择“属性”，然后选择“构建路径”）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T13:24:02.800

检查您的项目设置。如果我没记错的话，这与使用 javax.servlet.http.HttpSession 的 com.liferay.portal.util.PortalUtil.getUserPassword(renderRequest) 有关，但 eclipse 无法找到该类。尝试将 servlet api jar 添加到项目类路径

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-13T03:40:55.030

下载 Apache-Tomcat。浏览到 lib 文件夹。现在打开 Eclipse 并转到构建路径-> 配置构建路径-> 添加外部库。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-12-29T09:01:05.513

为了消除这个错误，您需要将 Servlet API 添加到您的类路径中。在 Tomcat 6.0 中，它位于 Tomcat 的 lib 文件夹中名为 servlet-api.jar 的 JAR 中。您可以将对该 JAR 的引用添加到项目的类路径中，或者将 JAR 的副本放在您的 Eclipse 项目中并从那里将其添加到类路径中。

如果要将 JAR 留在 Tomcat 的 lib 文件夹中：

右键单击项目，单击属性。选择 Java 构建路径。单击 Add External JARs... 浏览找到 servlet-api.jar 并选择它。单击确定以更新构建路径。

如果您将 JAR 复制到您的项目中：

右键单击项目，单击属性。选择 Java 构建路径。单击 Add JARs... 在您的项目中找到 servlet-api.jar 并选择它。单击确定以更新构建路径。

# version-control - 在 SCM 中正确使用标签

> ID：729961
> 
> 赞同：8
> 
> 时间：2009-04-08T13:19:09.833
> 
> 标签：version-control, release-management

我和我的同事对发布/SCM 系统中标签的价值和使用存在争议。我们期待 StackOverflow 社区提出他们的想法，以帮助我们解决问题。

一方面声称标签是发布管理的一个有价值的补充。它们的使用示例：我们做了一个 Maven 版本，它创建了一个新标签（称为 1.0），这是用于此版本的代码快照。这个标签应该是一个 READONLY 分支。当需要修复错误时，我们可以将标签复制到新分支中（称为 1.1）。错误修复在那里。这些修复可以合并回主干，以便主开发分支获得错误修复。最后，发布 1.1 并自动创建一个 Tag 1.1。这个循环继续。Tag 的主要好处是，如果您出于任何原因需要重新发布 1.0 版，您可以放心地发布 Tag 1.0，因为它从未被任何人更改过。此外，说“Release Tag 1.0”比说“Release revision 1 of branch 1.0 which is original 1.0”更干净。

另一方声称标签没有提供任何有价值的好处，尤其是在像 Subversion 这样具有全局修订的系统中，它就像 CVS 中的标签一样。另外，Subversion 只在提交标签时给出警告；它实际上并没有阻止它。他们的方法是在 Trunk 中开发，发布后你会创建一个名为 1.0 的分支。您将继续在 Trunk 中修复错误，如果您需要将这些错误修复重新发布到生产环境，您可以将它们合并到 1.0 分支并重新发布 1.0。在某个时候，也许在 Trunk 中的主要修复或功能之后，您会发布并制作 Branch 1.1。循环继续。如果您需要发布原始 1.0 版本，则必须查看 Branch 1.0 修订版 1。

显然这两种方法都有效。我想听听社区对首选哪种方法以及原因的看法。

编辑：我有点担心“最佳”方式取决于底层的 SCM 系统。要么选择 Subversion 来寻找答案，要么尽可能让它与 SCM 无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-08T13:30:17.887

在我看来，标签很有用。在项目的生命周期中，有时您会遇到错误或更改，并且您想知道它是否存在于以前的版本中。将有理由将一个版本的代码与另一个版本进行比较，以衡量性能和实际代码开发的效率。

当然，你有可能把它搞砸，但它总是可以撤消的。确实没有理由不这样做，并且有几个原因可以说明它在未来可能有用。对我来说，这是不费吹灰之力的。

我同意您也应该使用分支并在那里进行开发，但是无论何时您实际发布某些内容，都应从中制作一个标签。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T14:16:18.557

从与 SCM 无关的角度来看，**标签**与修订版非常不同。

两者可能实现方式相同，都代表“时间线”，但目标不同：

*   一个标签代表一个**不可变**的状态，其中所有文件都由一个唯一的 id 引用。它是一个[代表许多事物](https://stackoverflow.com/questions/372321/best-practice-for-svn-tags)的名称，但主要是一种稳定的状态，...）
*   修订代表提交事务（[并非所有 SCM 都具有这些](https://stackoverflow.com/questions/645008/what-are-the-basic-clearcase-concepts-every-developer-should-know)，尤其是具有“逐个文件方法”的旧版本）。所有提交都不代表“稳定”状态（如“编译”或“执行”成功）。它们只是全球历史的一个新元素。

SVN 的问题是修订、标签和分支都实现相同。
但我仍然更喜欢将标签用作[“只读”分支](https://stackoverflow.com/questions/16142/what-does-branch-tag-and-trunk-really-mean#114384)的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-08T14:20:12.057

是的，您想使用标签。

将标签视为特定修订的标签或名称。根据我的经验，标记项目中的重要里程碑非常有帮助，无论是用于生产版本还是临时 QA 版本。您通常会想回到过去并查看特定版本的源代码。

如果您在发布时进行分支，您总能找出哪个版本发布到生产环境中，但与仅查看标签相比，这有点痛苦。如果您不使用发布分支，那么很容易忘记使用哪个修订版来创建特定构建。

svn 的问题在于它模糊了标签和分支之间的区别。任何人都可以随时提交标签，因此不能保证它是固定/不可变的。在 PVCS 等其他 VCS 中，“标签”是不可更改的。您可以采用团队约定来防止提交标签，甚至可以使用提交挂钩来防止提交标签。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-15T09:34:06.373

我们在创建新基线时使用标签（标签）。我们每周做一次，但有些团队甚至一天做几次。

（对我们而言）重点始终是确保新基线是稳定的：所以它不仅仅是一个构建，而是一个通过整个测试套件的构建，几个小时的自动化测试以及潜在的手动探索性测试。

然后基线用作下一次迭代期间所有任务的起点：每个新任务都是从基线开始的新分支，已知基线是稳定的，因此任务中的任何问题都应该易于在任务本身内部追踪.

通常我们只在主分支（或主干或主分支，取决于您的 SCM 风格）上放置标签（标签），这是所有其他分支的集成点。

When we release an official product we create a "release branch for it" so it will only receive fixes while new development stays on "main". Then these "maintenance branches" (hopefully only one or two at a time) can be tagged too.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-08T13:35:50.807

我喜欢将标签视为“只是修订的花哨名称”。我一直这样想他们，而 IIRC 在善变中他们就是这样。然而，在颠覆中，正如你所说，它们确实是 trunk/* 到 tags/fancy-name/ 的（廉价）副本

老实说，我会结合两种策略来获得最佳结果：发布时标记和分支。您的标签称为 1.0.0，分支 1.0-MAINT。错误修复进入分支，错误修复版本再次成为标签（1.0.1 可能由一个标签在某个时候为 1.0-MAINT 别名。）

但是不要忘记 subversion 中的标签和分支实际上是同一件事：廉价副本。它们之间的唯一区别是您/您的团队赋予它们的语义，所以它几乎可以归结为让人们同意一种特定的方法并坚持下去（可能在服务器上强制执行，例如不允许在标签中提交/除了发布协调员等）

我看到第二种方法的问题是：如果你重新发布 1.0，你将如何轻松区分该领域的软件？这意味着您可能有一个 1.0 和另一个 1.0 实际上指的是不同的代码库...。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-08T17:42:56.000

项目源代码（和可执行文件）的不可变快照对于进行任何类型的测试（无论是结构化测试还是现场使用）都是非常宝贵的。对于结构化测试，您将创建可能在未来数月或数年内引用的数据。每当您重新访问该数据时，墨菲定律说您需要知道它来自什么代码，除非您费心引用源代码的特定快照，否则不可能有把握地判断源代码对应于什么那个测试数据。

我无法告诉你有多少次有人来找我说“这个微控制器代码不起作用，你能帮忙吗？” 我问他们，“你用的是什么版本？” 他们说“我不确定”，因为他们没有做好发布管理（至少在设备上贴一个标签，最好将版本信息放在可以实时查询的 EEPROM 中）。>:(

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-08T18:45:04.293

在 SVN 中，使用标签和跟踪修订之间的技术差异为零。我发现自己基于 SVN 的实现只是一个廉价的副本并弄乱了你的“结构空间”来最小化标签的使用。

真正的区别在于将特定基线**传达**给大型开发人员团队。修订跟踪带来了额外的抽象层，可能成为错误的来源。我们都知道，当您与 50 多个开发人员打交道时，任何错误来源都会成为混乱和浪费时间的领域。详细标签可以消除这种混淆并消除对基线目的的任何疑问。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-08T19:09:25.467

我会结合这两种方法。每当您发布版本时，请对其进行标记。标签永远不会改变，因此“1.0.0”标签的存在表明您不应该尝试将其他任何东西作为 1.0.0 发布。

同时，到了做 1.0.0 的时候，我会把它放到一个 1.0 的分支上。所以流程是：将主干分支到 1.0，将这个新的 1.0 标记为 1.0.0，然后部署。然后可以在 1.0 分支上进行错误修复（以避免与现在可能已经在主干上的任何 1.1 目标开发混淆）并合并到主干中。固定 1.0 的每个版本都从 1.0 分支标记为 1.0.x。这基本上是我们在使用 Perforce 时使用的方法，并且确实与 Subversion 非常相似。（阅读回复，我认为这与文森特的建议几乎相同）

至于关于标签是多余的评论，因为你有修订号——这在很大程度上是正确的，除了标签还指定了一个范围：即存储库中的哪些文件被标签覆盖。您可以合理地要求某人查看/svn/proj1/tag/1.0.0，他们会立即查看一个连贯的工作区。如果您要求他们查看修订版 X，他们必须首先查看修订版 X 以查看它正在更改（例如）/svn/proj1/trunk/Makefile 并因此推断 /svn/proj1/trunk/@X 是什么他们应该看看。如果修订 X 触及 proj1 和 proj2 中的文件会发生什么？这当然是邪恶的，但严格来说你应该说/svn/proj1/trunk/@X。修订号列表存储在哪里？我们怎么知道 1.0.0 是版本 X？恕我直言，应该可以仅从存储库中确定。

在像 Git 这样的系统中，标签和分支基本上仍然是相同的东西（只是对对象数据库的引用），但*约定*是标签引用不会改变，而分支引用会改变（最好对它们如何改变有一个特定的约束）。Perforce 也有“标签”，它们是独立于变更列表将一组文件修订分组在一起的方式；这本质上是一个标签，但更令人困惑：历史上我们使用的变更列表编号（相当于 Subversion 修订编号）用它们应该所在的分支名称来限定版本来识别版本。两者几乎相同，所以在这里我猜是 TMTOWTDI。

# javascript - jquery自动完成：如何处理特殊字符（&和'）？

> ID：729966
> 
> 赞同：1
> 
> 时间：2009-04-08T13:20:12.060
> 
> 标签：javascript, jquery, autocomplete

在使用 jQuery 的自动完成功能时，我注意到字符`&`and`'`被转义为`&amp;`and `&#39`;

例如，自动完成显示`Barbara’s Straight Son`，但当我选择此字段时显示`Barbara&#39;s Straight Son`.

有什么想法可以避免这种情况吗？

感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T13:27:07.490

您需要对 html 实体进行转义。我发现最简单的方法是使用此功能：

```
var unescapeHtml = function (html) {
      var temp = document.createElement("div");
      temp.innerHTML = html;
      var result = temp.childNodes[0].nodeValue;
      temp.removeChild(temp.firstChild)
      return result;
  } 
```

因此，在将字符串放入您的输入框之前，请通过此函数传递您的字符串。您可能必须修改自动完成插件才能执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-12T08:42:15.487

例如，您可以使用此代码在自动完成中设置标签值

```
var temp = document.createElement("pre"); // create new DOM element 
temp.innerHTML = "Barbara&#39;s Straight Son" ; // set string which content HTML entities 
return {
            label: temp.firstChild.nodeValue, // get string from that DOM element which replace HTML entities to special character 
            value: "" // set your value here
} 
```

# java - 哪一个主要操作系统最适合快速启动和启动 Java 应用程序？

> ID：729980
> 
> 赞同：1
> 
> 时间：2009-04-08T13:23:04.097
> 
> 标签：java, windows, linux, operating-system, solaris

我创建了一个 Java 应用程序，它是工作站上唯一活动的应用程序。（类似于信息亭系统）

问题是应用程序必须在启动计算机后尽快启动并运行。

我想知道**哪个主要操作系统可以配置为提供最短的启动时间？**

我正在使用第 3 方音频和图形库，因此我的选择仅限于 Windows XP/Vista、Linux 和 Solaris。

目前在我的双启动机器上 Fedora 比 Vista 需要更长的时间，但另一方面，我在调整 Linux 的启动时间方面没有太多经验。因此，如果有人知道 Linux 可以有更好的快速启动机会，那么我会花时间在那里。

我也很欣赏有关调整启动时间和 Java 启动时间的一般提示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-08T13:56:12.550

我会查看[BootChart](http://www.bootchart.org/)以优化您的 Fedora 启动时间。如果您正在运行一个应用程序，那么您当然可以删除 Fedora 通常配置的许多服务。

我还要指出，也许对于您将要花大量时间优化它，您最好投资于适当的硬件（例如 SSDS 和类似的，如果引导时间由您的磁盘控制）。优化可能是一个主要的时间槽。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-08T13:29:32.523

如果您在不需要运行任何其他应用程序的信息亭之类的机器中运行您的应用程序，并且您知道需要提前加载哪些驱动程序/模块，我认为您的最佳启动时间将来自Linux。

只需要一些时间来微调您的启动过程，以尽可能快地加载所有适当的软件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T13:54:48.467

对于这样的任务，经过微调的 Linux 最适合。您可以查看一些更可定制的发行版，您可以在其中控制哪些驱动程序和应用程序可以进入。

[Debian](http://debian.org/)是高度模块化和可定制的，因此您可以获得非常好的启动速度。

另一个选择是[Gentoo](http://www.gentoo.org/) - 你可以严格选择要编译和包含的内容。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-08T20:40:55.653

带有 SSD 驱动器的 Linux。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-07T07:45:44.520

我还建议使用 linux 发行版。例如带有 initng ( [initng.org](http://www.initng.org/) ) 的 Gentoo。Initng 并行化启动过程。还有其他启动系统，您的系统将在几秒钟内启动。当然，快速的硬盘驱动器和足够的内存用于 java ;)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-08T15:15:28.150

我的猜测是嵌入式 Windows XP。我发现 Java 应用程序在 Windows 下启动得相当快，尤其是在您使用客户端 VM 的情况下。

您的第 3 方供应商极有可能支持 XP Embedded（特别是如果您是他们的大客户）。它与普通 XP 非常相似，只是减少了一些。

如果您正在制作自助服务终端类型的应用程序，为什么要关心启动时间？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T07:35:19.117

如果您只想运行单个 java 应用程序，Fedora 可以很容易地进行优化。有许多服务是在启动时预先配置的，可以省略。您也可以使用 SSD 驱动器来改善系统的启动时间，同时如果您花一些时间优化启动图表，它会解决您的问题。

# sql - SQL 存储过程：重叠 IF 中的语法不正确

> ID：729985
> 
> 赞同：0
> 
> 时间：2009-04-08T13:23:37.840
> 
> 标签：sql, stored-procedures, syntax-error

我在以下代码中的每个嵌套的 IF 和 ELSE 语句上都收到“语法错误”错误......怎么了？

```
ALTER PROCEDURE [WTFAULT].[usp_WTFault_GetPartFaultStatus]
(
@linxPartId int = -1,
@faultStatus varchar(10) output
)
AS
BEGIN

    DECLARE @NbFaultsInParts int,
            @NbPartsReturned int

    SET @NbPartsReturned = (SELECT COUNT(*) FROM WTFAULT.PART, WTFAULT.FAULT WHERE WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID 
                                AND WTFAULT.PART.LINX_PARTID = @linxPartId AND WTFAULT.FAULT.MATURITY = 'ALLOCATED')

    IF @NbPartsReturned > 0 BEGIN
            SET @faultStatus = 'ALLOCATED'
    END
    ELSE BEGIN
            SET @NbPartsReturned = (SELECT COUNT(*) FROM WTFAULT.PART, WTFAULT.FAULT WHERE WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID 
                                        AND WTFAULT.PART.LINX_PARTID = @linxPartId AND WTFAULT.FAULT.MATURITY = 'DRAFT')

            IF @NbPartsReturned > 0 BEGIN
                    SET @faultStatus = 'DRAFT'
            END
            ELSE BEGIN
                SET @NbPartsReturned = (SELECT COUNT(*) FROM WTFAULT.PART, WTFAULT.FAULT WHERE WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID 
                                            AND WTFAULT.PART.LINX_PARTID = @linxPartId AND WTFAULT.FAULT.MATURITY = 'CLOSED')
                IF @NbPartsReturned > 0 BEGIN
                        SET @faultStatus = 'CLOSED'
                END
                ELSE BEGIN
                        SET @faultStatus = ''
                END
            END
        END
END
GO 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T13:27:32.060

试试这个：

```
DECLARE @faultStatus nvarchar(20)
DECLARE @NbFaultsInParts int
DECLARE @NbPartsReturned int

SELECT @NbPartsReturned = COUNT(*) FROM WTFAULT.PART, WTFAULT.FAULT WHERE WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID AND WTFAULT.PART.LINX_PARTID = @linxPartId AND WTFAULT.FAULT.MATURITY = 'ALLOCATED'

IF @NbPartsReturned > 0 BEGIN
                SET @faultStatus = 'ALLOCATED'
END
ELSE BEGIN
                SELECT @NbPartsReturned = COUNT(*) FROM WTFAULT.PART, WTFAULT.FAULT WHERE WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID  AND WTFAULT.PART.LINX_PARTID = @linxPartId AND WTFAULT.FAULT.MATURITY = 'DRAFT'

                IF @NbPartsReturned > 0 BEGIN
                                SET @faultStatus = 'DRAFT'
                END
                ELSE BEGIN
                        SELECT @NbPartsReturned = COUNT(*) FROM WTFAULT.PART, WTFAULT.FAULT WHERE WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID  AND WTFAULT.PART.LINX_PARTID = @linxPartId AND WTFAULT.FAULT.MATURITY = 'CLOSED'

                        IF @NbPartsReturned > 0 BEGIN
                                        SET @faultStatus = 'CLOSED'
                        END
                        ELSE BEGIN
                                        SET @faultStatus = ''
                        END
                END
        END
END

GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-08T13:28:17.330

尽量不要把你的`begins`and 和`ends`其他陈述放在同一行。

另外，作为一个不相关的提示，尝试使用“ `select @NbPartsReturned = count(*) from WTFAULT.PART...`”而不是“ `set @NbPartsReturned = (select count(*) from WTFAULT.PART...`”之类的语句，因为您会将两个语句合二为一。

如果这不能解决您的问题，请尝试放置整个错误的文本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T13:40:16.223

消息 102，级别 15，状态 1，过程 usp_WTFault_GetPartFaultStatus，第 25 行

' ' 附近的语法不正确。

消息 156，级别 15，状态 1，过程 usp_WTFault_GetPartFaultStatus，第 29 行

关键字“ELSE”附近的语法不正确。

消息 102，级别 15，状态 1，过程 usp_WTFault_GetPartFaultStatus，第 33 行

' ' 附近的语法不正确。

消息 156，级别 15，状态 1，过程 usp_WTFault_GetPartFaultStatus，第 37 行

关键字“ELSE”附近的语法不正确。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T14:02:00.900

试试这个不同的方法：

```
ALTER PROCEDURE [WTFAULT].[usp_WTFault_GetPartFaultStatus](@linxPartId int = -1,
@faultStatus varchar(10) output)
AS   

SELECT COUNT(*) as MaturityCount,WTFAULT.FAULT.MATURITY  INTO #Temp
FROM WTFAULT.PART JOIN WTFAULT.FAULT 
    ON WTFAULT.PART.FAULT_COID = WTFAULT.FAULT.COID 
WHERE TFAULT.PART.LINX_PARTID = @linxPartId 
GROUP BY WTFAULT.FAULT.MATURITY

If (select MaturityCount from #temp where WTFAULT.FAULT.MATURITY = 'ALLOCATED') >0
    BEGIN
        SET @faultStatus = 'ALLOCATED'
    END
ELSE IF
(select MaturityCount from #temp where WTFAULT.FAULT.MATURITY = 'DRAFT') >0
    BEGIN
        SET @faultStatus = 'DRAFT'
    END
ELSE IF
(select MaturityCount from #temp where WTFAULT.FAULT.MATURITY = 'CLOSED') >0
    BEGIN
        SET @faultStatus = 'CLOSED'  
    END
ELSE 
    BEGIN                                        
        SET @faultStatus = ''                        
    END 
```

我还更改了您的查询以使用 ANSI 标准联接。从现在开始，您也应该使用它们。它们更清晰，更易于维护，并且在您使用外连接时不会给出错误的结果，并且不太可能意外导致交叉连接。

# javascript - JavaScript 压缩库使用哪些技术来最小化文件大小？

> ID：729988
> 
> 赞同：1
> 
> 时间：2009-04-08T13:24:24.623
> 
> 标签：javascript, optimization, theory

请注意，这个问题旨在更多地关注该主题的理论方面，但除了剥离空格之外，[JavaScript 压缩](http://compressorrater.thruhere.net/)还使用了哪些其他技术？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-08T13:33:15.680

从我的头顶上...

*   标记局部变量，然后将它们重命名为最小大小的变量。
*   删除大量空白。
*   删除不必要的大括号（例如，if 语句后的单行执行可以删除大括号并添加单个分号）。
*   删除不必要的分号（例如，在结束大括号 '}' 之前）。

我最常用的压缩器是[YUI Compressor](http://developer.yahoo.com/yui/compressor/)，[正如他们所说](http://developer.yahoo.com/yui/compressor/#work)，它是开源的，所以你可以自己看看他们到底做了什么。（我不确定他们所说的“微优化”是什么意思，可能是一堆罕见的情况，可以让你获得一两个角色。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-08T13:34:57.563

大多数压缩机使用不同技术的组合：

*   剥离空格
*   通过压缩算法压缩文件（gzip，deflate）
*   大部分空间被节省了将内部变量和函数重命名为更短的名称，例如：

这个功能：

```
function func (variable) {
  var temp = 2 * variable;
  return temp;
} 
```

会变成：

```
function func (a) {
  var b = 2 * a;
  return b;
} 
```

*   Dean Edwards[封隔器](http://dean.edwards.name/packer/)使用了一些内部压缩。脚本在页面上加载时被解压缩。
*   使程序代码更短的所有常见内容：
    *   删除未使用的代码
    *   函数内联

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-08T13:32:55.337

我可以列举一些在 Google Web Toolkit 编译器中找到的内容：

*   内联方法调用
*   死代码消除
*   变量重命名/源混淆
    *   这意味着将长变量重写为短变量等等

几乎所有这些都需要 Javascript 解析（即它们的工作超出了纯粹的词法分析）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-08T14:54:13.847

代码重命名和重新排序，以便 gzip 压缩器有更好的结果。

例如（不太聪明）

原始代码：

```
function mul(mul1, mul2)
{
 return mul1 * mul2;
}

function print(str)
{
  // do something 
}

function add(add1, add2)
{
 return add1 + add2;
} 
```

修改代码：

```
function mul(a,b)
{
 return a * b;
}

function add(a, b)
{
 return a + b;
}

function print(str)
{
  // do something 
} 
```

# crystal-reports - Crystal Reports 中的多个组

> ID：729997
> 
> 赞同：6
> 
> 时间：2009-04-08T13:25:49.020
> 
> 标签：crystal-reports

如何在 Crystal Reports 中使用多个未嵌套的组？

我想做的一个小例子：

```
-租车头
--rentals 标头（组）
---从 01-02-2008 到 01-06-2008 租用
---从 01-08-2008 到 01-09-2008 租用
---从 01-12-2008 到 01-15-2008 租用
--租金页脚
--repairs 标头（组）
---从 02-02-2008 到 02-05-2009 修复
--修复页脚
- 租用汽车页脚

```

`hire car`是正常报告，`rentals`和`repairs`是组。组不嵌套。我目前的问题是我无法真正创建类似的东西，也无法更改结构来解决这个问题......

我对水晶报告完全陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T16:51:46.117

这是个好问题。我称之为双一对多。您有“出租汽车”，可以进行多次出租和/或多次维修。

一种解决方案是使用两个子报告来进行租赁和维修。

另一种解决方案是将维修和租赁结合在一起。然后在指定行是出租数据还是维修数据的列上有水晶组。您还必须显示/抑制正确的标签、字段等。这非常笨拙，所以最好的办法是走子报告路线。

# vb.net - 你如何实现 IEqualityComparer 在 VB.NET 中？

> ID：729999
> 
> 赞同：1
> 
> 时间：2009-04-08T13:26:09.877
> 
> 标签：vb.net, iequalitycomparer, directoryinfo

我有以下函数循环遍历目录并检查指定的文件夹和文件：

```
Private Function VerifyPath(ByVal root As String, ByVal folder As String, _ 
                            ByVal file As String) As Boolean

    Dim folders As New List(Of String), files As New List(Of String)
    Dim oDir As New IO.DirectoryInfo(root)

    For Each dir As IO.DirectoryInfo In oDir.GetDirectories
        folders.Add(dir.Name.ToLower)
    Next
    If folders.Contains(folder) Then
        For Each item As IO.FileInfo In oDir.GetFiles
            files.Add(item.Name.ToLower)
        Next
        If files.Contains(file) Then
            Return True
        End If
    End If
    Return False
End Function 
```

我这样做的原因是我可以确保每个列表中的项目和传递的文件/文件夹都是小写的，否则我会做这样的事情：

```
If oDir.GetDirectories.Contains( _
        New IO.DirectoryInfo(String.Format("{0}\{1}", root, folder))) Then
    If oDir.GetFiles.Contains( _
            New IO.FileInfo(String.Format("{0}\{1}", root, file))) Then
        Return True
    End If
End If
Return False 
```

我的同事早些时候向我提到过使用比较器可以忽略大小写。扩展可以有一个比较器`.Contains`参数和值。我在 google 和 MSDN 上进行了一些搜索，并提出了以下比较器：

```
Public Class dirCompare
    Implements IEqualityComparer(Of IO.DirectoryInfo)

    Dim theCompare As CaseInsensitiveComparer

    Sub New()
        theCompare = CaseInsensitiveComparer.DefaultInvariant
    End Sub

    Sub New(ByVal culture As CultureInfo)
        theCompare = New CaseInsensitiveComparer(culture)
    End Sub

    Public Function Equals1(ByVal x As System.IO.DirectoryInfo, ByVal y As System.IO.DirectoryInfo) As Boolean Implements System.Collections.Generic.IEqualityComparer(Of System.IO.DirectoryInfo).Equals
        If theCompare.Compare(x.name, y.name) = 0 Then
            Return True
        Else
            Return False
        End If
    End Function

    Public Function GetHashCode1(ByVal obj As System.IO.DirectoryInfo) As Integer Implements System.Collections.Generic.IEqualityComparer(Of System.IO.DirectoryInfo).GetHashCode
        Return obj.ToString.ToLower.GetHashCode
    End Function
End Class 
```

当它到达`theCompare(x.name, y.name) = 0`线路时，它会出错，这是错误消息：

> `At least one object must implement IComparable.`

任何人都知道这个错误意味着什么以及如何纠正它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-08T13:51:24.670

好吧，您可以实现一个比较器，但在这种情况下这将是困难的方法。您还有其他几个选项可用。

首先是您可以使用一个不区分大小写的比较器。其实有一对。在 下查看您的智能感知提示`System.StringComparer`。

第二个是字符串已经有一个内置的方法来指定不区分大小写的比较：

```
Dim s As String = "a"
Dim t As String = "A"
If s.Equals(t, StringComparison.InvariantCultureIgnoreCase) Then
   ''//...
End If 
```

第三个是任何`searchPattern`传递给`Directory.GetFiles()`或`Directory.GetDirectories()`直接传递给操作系统的，Windows 只区分文件名的大小写，不区分大小写。因此，您可以将文件夹和文件作为搜索模式传递​​并以这种方式进行查找。**************