# StackOverflow 问答 10213000-10213999

# git - 将子模块与本地存储库一起使用

> ID：10213000
> 
> 赞同：0
> 
> 时间：2012-04-18T15:41:39.937
> 
> 标签：git, git-submodules

有没有人对以下问题有任何提示：

*   我有一些本地存储库 ABC，我在项目 X 中使用它们。
*   我将这些存储库 ABC 作为子模块添加到项目 X。

但是，当我推送我的项目 X 时，子模块内的文件不会推送到我的 ssh 服务器上的远程裸存储库（我只看到空目录）。我如何在将存储库 ABC 保持在本地的同时实现这一目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T18:53:14.493

我不确定这是否真的可能。当您推送到远程仓库时，git 将推送有关您的子模块的信息（即`.gitmodules`文件中的信息），但它不会推送子模块的文件本身。无论它是否是一个裸仓库，这都是正确的，并且是子模块的重点。子模块是在一个单独的 repo 中的东西，你在你的超级项目中保留的只是对它的引用。

我很确定，如果文件被分成子模块，并且您希望它们在服务器上可用，那么您需要在服务器上为这些子模块提供远程存储库。如果您开始跟踪超级项目中的 ABC 文件，那么它们就不再是真正的子模块。

您可以设置一个挂钩，在推送后将您的 ABC 文件*复制*到您的服务器，但是它们当然不会成为您的远程存储库的一部分，只能在您的远程服务器上使用。

总之，如果您必须将它们放在那里，只需为它们设置一个远程存储库。

# lucene.net - Lucene“包含”对索引子集的搜索

> ID：10213002
> 
> 赞同：0
> 
> 时间：2012-04-18T15:41:48.357
> 
> 标签：lucene.net

我有一个包含大约 500 万份文档的索引，我正在尝试对其进行“包含”搜索。我知道如何做到这一点，并且我已经向客户解释了性能成本，但这正是他们想要的。正如预期的那样，对整个索引进行“包含”搜索非常慢，但有时我只想搜索索引的一个非常小的子集（比如 100 个左右的文档）。我通过在搜索中添加过滤器来正确限制结果来完成此操作。但是我发现这个搜索和整个索引搜索的执行几乎完全一样。我在这里缺少什么吗？感觉这个搜索也在搜索整个索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T20:08:17.640

你可以试试[SingleCharTokenAnalyzer](https://svn.apache.org/repos/asf/incubator/lucene.net/tags/Lucene.Net_2_9_4g_RC1/src/contrib/Core/Analysis/Ext/Analysis.Ext.cs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T17:35:29.600

在搜索中添加过滤器不会限制索引的范围。

您需要更清楚地了解您需要从搜索中获得什么，但我不相信您想要什么是可能的。

文档的子集总是相同的吗？如果是这样，也许您可​​以使用多个索引变得聪明。（例如搜索较小的索引，如果没有足够的命中，则搜索较大的索引）。

# javascript - 函数中的 window.open 替换当前选项卡并打开新选项卡

> ID：10213004
> 
> 赞同：4
> 
> 时间：2012-04-18T15:41:56.300
> 
> 标签：javascript

我想了解一个有趣的复杂情况，如果我将 window.open 作为锚点的 onclick 事件，则会根据需要打开一个新选项卡。如果 onclick 调用一个函数，该函数又会打开一个 window.open 新选项卡，但当前选项卡也会获取新的 url。

我可以[在这里](http://jsfiddle.net/symeon/AJm9x/3/)演示它 ，当您单击链接时它可以正常工作，而[这里](http://jsfiddle.net/symeon/AJm9x/)的 url 也在结果区域中打开！

谢谢西蒙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T15:44:32.683

你的第一个`case`陈述落空了。您需要添加一个`break`：

```
switch (t) {
    case 1: 
        window.open(url,"_blank");
        break;
    case 2: 
        window.location = url;
        break;
} 
```

如果没有,将执行第一个匹配的下面的`break`每个。`case`

我也在`break`第二种情况下添加了一个，仅仅是因为通常认为总是`break`一个情况是好的做法。事实上，[JSLint](http://www.jslint.com/lint.html)会将缺失标记`break`为错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T15:45:39.030

在不起作用的示例中，您`break`在 switch 语句中缺少 a：

```
function doclick(t, url) {
    switch (t) {
        case 1: window.open(url,"_blank"); break;
        case 2: window.location = url; break;
    }
    return false;
}​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T15:45:05.957

你需要`break;`你`case`的s。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T15:55:45.673

只会`break;`给你你需要的结果。

# search - Solr 与 ElasticSearch

> ID：10213009
> 
> 赞同：759
> 
> 时间：2012-04-18T15:42:24.880
> 
> 标签：search, solr, lucene, elasticsearch

这些技术之间的核心架构差异是什么？

此外，哪些用例通常更适合每个用例？

* * *

## 回答 #1

> 赞同：572
> 
> 时间：2012-04-18T16:15:50.433

## 更新

既然问题范围已经更正，我也可能会在这方面添加一些内容：

[Apache Solr](http://lucene.apache.org/solr/)和[ElasticSearch](https://www.elastic.co/)之间有很多比较可用的，所以我将参考那些我自己认为最有用的比较，即涵盖最重要的方面：

*   Bob Yoplait 已经将 kimchy 的答案与[ElasticSearch、Sphinx、Lucene、Solr、Xapian 联系起来。哪个适合哪个用途？](https://stackoverflow.com/a/2288211/45773)，其中总结了他*继续创建 ElasticSearch*的原因，在他看来，与 Solr 相比，ElasticSearch*提供了更优越的分布式模型和易用性*。

*   Ryan Sonnek 的[实时搜索：Solr 与 Elasticsearch](http://blog.socialcast.com/realtime-search-solr-vs-elasticsearch/)提供了深刻的分析/比较，并解释了为什么他从 Solr 切换到 ElasticSeach，尽管他已经是一个快乐的 Solr 用户 - 他总结如下：

    > ****在构建标准搜索应用程序时，** **Solr**可能是首选武器，但**Elasticsearch**将其提升到一个新的水平，其 **架构可用于创建现代实时搜索应用程序**。渗透是一项令人兴奋的创新功能，可以单枪匹马地将 Solr 吹出水面。**Elasticsearch 具有可扩展性、快速性和与**. Adios Solr，很高兴认识你。*[强调我的]***

***   ElasticSearch 上的 Wikipedia 文章引用了著名的德国 iX 杂志的[比较](http://en.wikipedia.org/wiki/ElasticSearch#Comparison_to_other_software)，列出了优缺点，几乎总结了上面已经说过的内容：

    > **优点**：
    > 
    > *   ElasticSearch 是分布式的。不需要单独的项目。副本也接近实时，这称为“推送复制”。
    > *   ElasticSearch 完全支持 Apache Lucene 的近实时搜索。
    > *   处理多租户不是一个特殊的配置，在 Solr 中需要更高级的设置。
    > *   ElasticSearch 引入了网关的概念，它使完整备份变得更加容易。
    > 
    > **缺点**：
    > 
    > *   ~~只有一个主要开发人员[根据当前的~~ *[elasticsearch GitHub 组织](https://github.com/elastic)**不再适用，除了首先拥有非常活跃的提交者基础]*
    > *   ~~没有自动预热功能[根据新的~~ *[Index Warmup API](https://github.com/elastic/elasticsearch/issues/1913)**不再适用]*** 

 *** * *

## 初步答案

它们是针对完全不同用例的完全不同的技术，因此根本无法以任何有意义的方式进行比较：

*   [Apache Solr](http://lucene.apache.org/solr/) - *Apache Solr 在易于使用、快速的**搜索服务器**中提供 Lucene 的功能，并具有分面、可扩展性等附加功能*

*   [Amazon ElastiCache](http://aws.amazon.com/elasticache/) - *Amazon ElastiCache 是一种 Web 服务，可以轻松地在云中部署、操作和扩展**内存中的缓存。***

    *   请注意，*Amazon ElastiCache 与 Memcached 协议兼容，Memcached 是一种广泛采用的内存对象缓存系统，因此您目前在现有 Memcached 环境中使用的代码、应用程序和流行工具将与该服务无缝*协作（有关详细信息，请参阅[Memcached](http://memcached.org/)）。

*[强调我的]*

也许这已经以一种或另一种方式与以下两种相关技术混淆了：

*   [ElasticSearch](https://www.elastic.co/) -*它是一个开源 (Apache 2)、分布式、RESTful、建立在 Apache Lucene 之上的搜索引擎。*

*   [Amazon CloudSearch](http://aws.amazon.com/cloudsearch/) - *Amazon CloudSearch 是一种完全托管的云搜索服务，允许客户轻松地将快速且高度可扩展的搜索功能集成到他们的应用程序中。*

*Solr*和ElasticSearch产品*乍一看*非常相似，并且都使用相同的后端搜索引擎，即[Apache Lucene](http://lucene.apache.org/core/)。

虽然*Solr*较老、用途广泛且成熟并因此被广泛使用，*但 ElasticSearch*是专门为解决*Solr*在现代云环境中具有可扩展性要求的缺点而开发的，而这些缺点很难（更）用*Solr*解决。

因此，将*ElasticSearch*与最近推出的*Amazon CloudSearch*进行比较可能是最有用的（请参阅介绍性帖子[在一小时内以不到 100 美元/月的价格开始搜索](http://aws.typepad.com/aws/2012/04/amazon-cloudsearch-start-searching-in-one-hour.html)），因为两者都声称原则上涵盖了相同的用例。

* * *

## 回答 #2

> 赞同：210
> 
> 时间：2012-08-26T15:02:22.173

我看到上面的一些答案现在有点过时了。从我的角度来看，我每天都使用 Solr（云和非云）和 ElasticSearch，这里有一些有趣的区别：

*   社区：Solr 拥有更大、更成熟的用户、开发人员和贡献者社区。ES 有一个较小但活跃的用户社区和一个不断增长的贡献者社区
*   成熟度：Solr 比较成熟，但是 ES 增长很快，我认为稳定
*   性能：很难判断。我/我们没有做过直接的性能基准测试。LinkedIn 的一个人确实比较了 Solr、ES 和 Sensei，但最初的结果应该被忽略，因为他们对 Solr 和 ES 都使用了非专家设置。
*   设计：人们喜欢 Solr。Java API 有点冗长，但人们喜欢它的组合方式。不幸的是，Solr 代码并不总是很漂亮。此外，ES 内置了分片、实时复制、文档和路由。虽然其中一些也存在于 Solr 中，但感觉有点像事后的想法。
*   支持：有些公司为 Solr 和 ElasticSearch 提供技术和咨询支持。我认为唯一为两者提供支持的公司是 Sematext（披露：我是 Sematext 创始人）
*   可扩展性：两者都可以扩展到非常大的集群。ES 比 Solr 4.0 之前的版本更容易扩展，但在 Solr 4.0 中，情况不再如此。

有关 Solr 与 ElasticSearch 主题的更全面介绍，请查看[https://sematext.com/blog/solr-vs-elasticsearch-part-1-overview/](https://sematext.com/blog/solr-vs-elasticsearch-part-1-overview/)。这是 Sematext 进行直接和中立的 Solr 与 ElasticSearch 比较的系列文章中的第一篇。披露：我在 Sematext 工作。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2017-02-26T19:15:42.090

我看到这里的很多人已经在特性和功能方面回答了这个 ElasticSearch 与 Solr 的问题，但我在这里（或其他地方）没有看到太多关于它们在性能方面的比较的讨论。

这就是为什么我决定进行自己的[调查](http://glennengstrand.info/software/performance/elasticsearch/solr)。我采用了一个已经编码的异构数据源微服务，该微服务已经使用 Solr 进行术语搜索。我为 ElasticSearch 切换了 Solr，然后我在 AWS 上使用已经编码的负载测试应用程序运行了这两个版本，并捕获了性能指标以供后续分析。

这是我发现的。在索引文档方面，ElasticSearch 的吞吐量提高了 13%，但 Solr 的速度提高了 10 倍。在查询文档时，Solr 的吞吐量是 ElasticSearch 的五倍，速度是 ElasticSearch 的五倍。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2016-11-11T16:23:24.520

由于 Apache Solr 的悠久历史，我认为 Solr 的优势之一是它的**生态系统**。有许多 Solr 插件可用于不同类型的数据和用途。

![solr 堆栈](../Images/dd64510dffa2cbbb0555613bfe9a5925.png)

搜索平台从下到上分为以下几层：

*   数据
    *   目的：表示各种数据类型和来源
*   文件建设
    *   目的：为索引建立文档信息
*   索引和搜索
    *   目的：建立和查询文档索引
*   逻辑增强
    *   目的：用于处理搜索查询和结果的附加逻辑
*   搜索平台服务
    *   目的：增加搜索引擎核心的附加功能，提供服务平台。
*   界面应用
    *   目的：最终用户搜索界面或应用程序

参考文章：[企业搜索](http://manmustbecool.github.io/MyWiki/papers/Enterprise%20search%20with%20development%20for%20network%20management%20system.pdf)

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2016-09-07T14:35:20.163

我一直致力于 .Net 应用程序的 solr 和弹性搜索。我面临的主要区别是

弹性搜索：

*   更多的代码和更少的配置，但是有 api 的改变，但仍然是一个代码改变
*   对于复杂类型，类型内类型，即嵌套类型（在 solr 中无法实现）

索尔：

*   更少的代码和更多的配置，因此更少的维护
*   用于在查询期间对结果进行分组（在弹性搜索中需要做很多工作，简而言之，没有直接的方法）

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2017-05-03T21:51:56.177

我创建了一个关于 elasticsearch 与 Solr 和 splunk 之间主要区别的表格，您可以将其用作 2016 更新：[![在此处输入图像描述](../Images/9dc5e7a3f56912f594a879314a76e478.png)](https://i.stack.imgur.com/CpJYN.jpg)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2016-02-03T00:04:48.177

虽然上述所有链接都有优点，并且在过去使我受益匪浅，但作为过去 15 年“接触”各种 Lucene 搜索引擎的语言学家，我不得不说 Python 中的弹性搜索开发非常快。话虽如此，一些代码对我来说并不直观。因此，我从开源的角度接触了 ELK 堆栈的一个组件 Kibana，发现我可以在 Kibana 中非常轻松地生成有点神秘的 elasticsearch 代码。此外，我也可以将 Chrome Sense es 查询拉入 Kibana。如果你使用 Kibana 来评估 es，它会进一步加快你的评估速度。在其他平台上运行需要数小时才能在最坏的情况下在几分钟内（最大的数据集）在 Elasticsearch（RESTful 接口）之上的 Sense 中启动并运行 JSON；最好在几秒钟内。elasticsearch 的文档虽然有 700 多页，但没有回答我通常会在 SOLR 或其他 Lucene 文档中解决的问题，这显然需要更多时间来分析。此外，您可能想看看弹性搜索中的聚合，它把分面提升到了一个新的水平。

更大的图景：如果你从事数据科学、文本分析或计算语言学，elasticsearch 有一些排名算法，这些算法似乎在信息检索领域创新得很好。如果您使用任何 TF/IDF 算法、文本频率/逆文档频率，elasticsearch 将这个 1960 年的算法扩展到一个新的水平，甚至使用 BM25、Best Match 25 和其他相关性排名算法。因此，如果您要对单词、短语或句子进行评分或排名，elasticsearch 会即时进行评分，而无需花费数小时的其他数据分析方法的大量开销 - 另一个弹性搜索时间节省。使用 es，将聚合中的分桶的一些优势与实时 JSON 数据相关性评分和排名相结合，您可以找到一个成功的组合，

注意：确实在上面看到了关于聚合的类似讨论，但没有关于聚合和相关性评分——我对任何重叠表示歉意。披露：我不为弹性工作，并且由于不同的架构路径，在不久的将来将无法从他们的出色工作中受益，除非我用弹性搜索做一些慈善工作，这不是一个坏主意

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-08-25T11:54:07.087

如果您已经在使用 SOLR，请坚持使用它。如果您正在启动，请选择弹性搜索。

SOLR 已经修复了最大的主要问题，并且相当成熟。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-11-27T19:33:18.590

想象一下用例：

1.  大量（100+）小型（10Mb-100Mb，1000-100000 个文档）搜索索引。
2.  它们被许多应用程序（微服务）使用
3.  每个应用程序可以使用多个索引
4.  按尺寸指数小，是的。但是巨大的负载（每秒数百个搜索请求）和请求很复杂（多个聚合、条件等）
5.  不允许停机
6.  所有这些都持续了数年之久，并且还在不断增长。

每个索引都有单独的 ES 实例的想法 - 在这种情况下是巨大的开销。

根据我的经验，使用 Elasticsearch 支持这种用例非常复杂。

为什么？

第一的。

主要问题是基本的向后兼容性无视。

突破性的变化太酷了！（注意：想象一下 SQL-server 需要你对所有 SQL 语句进行小改动，升级时......无法想象。但对于 ES 来说这是正常的）

将在下一个主要版本中删除的弃用是如此性感！（注意：你知道，Java 包含一些弃用，它们已有 20 多年的历史，但仍在实际的 Java 版本中工作......）

不仅如此，有时你甚至有一些没有记录的东西（个人只遇到过一次，但是......）

所以。如果你想升级 ES（因为你需要一些应用程序的新功能或者你想修复错误）——你就在地狱里。特别是如果它是关于主要版本升级。

客户端 API 不会向后兼容。索引设置将不向后兼容。使用 ES 升级同时升级所有应用程序/服务是不现实的。

但是你必须时不时地这样做。别无退路。

现有索引自动升级？- 是的。但是当您需要更改一些旧索引设置时，它对您没有帮助。

为了适应这种情况，您需要不断地投入大量精力……您的应用程序/服务与 ES 的未来版本的前向兼容性。或者您需要在您的应用程序/服务和 ES 之间构建（并且始终支持）某种中间件，它为您提供向后兼容的客户端 API。（而且，您不能使用传输客户端（因为它需要为每个次要版本 ES 升级进行 jar 升级），而这一事实并没有让您的生活更轻松）

是不是看起来简单又便宜？不，这不对。离得很远。基于 ES 的复杂基础设施的持续维护在所有可能的意义上都是昂贵的。

第二。简单的 API ？嗯……真的没有。当您真正使用复杂的条件和聚合时......具有 5 个嵌套级别的 JSON 请求是什么，但并不简单。

* * *

不幸的是，我没有使用 SOLR 的经验，对此无话可说。

但是 Sphinxsearch 在这种情况下要好得多，因为完全向后兼容 SphinxQL。

注意：Sphinxsearch/Manticore 确实很有趣。它不是基于 Lucine 的，因此完全不同。包含 ES 所没有的几个独特功能，并且具有中小型索引的疯狂快速。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2016-02-26T06:45:59.300

我使用 Elasticsearch 3 年，使用 Solr 大约一个月，我觉得与安装 Solr 相比，Elasticsearch 集群安装起来非常容易。Elasticsearch 有一个帮助文档池，里面有很好的解释。其中一个用例是直方图聚合，它在 ES 中可用，但在 Solr 中找不到。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-07-12T08:43:10.190

在 solr 中添加嵌套文档非常复杂，嵌套数据搜索也非常复杂。但 Elastic Search 易于添加嵌套文档和搜索

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-09-27T01:03:14.760

我只使用弹性搜索。因为我发现 solr 很难开始。弹性搜索的特点：

1.  容易上手，很少设置。即使是新手也可以逐步建立集群。
2.  使用 NoSQL 查询的简单 Restful API。以及许多易于访问的语言库。
3.  好文档，可以看书：. 官网有网页版。**

# android - 如何在 Android 中为微调器捕获 onClick 事件

> ID：10213015
> 
> 赞同：15
> 
> 时间：2012-04-18T15:42:59.013
> 
> 标签：android, android-widget, android-spinner

我想在用户选择微调器值时捕获 onClick 事件。

我已经尝试实现`OnClickListener`和使用以下代码：

```
@Override
public void onClick(final View view) {
  if (view == countrySpinner) {
    Toast.makeText(this, "Override OK!", 3);
  }
} 
```

并绑定：

```
countrySpinner.setOnClickListener(this); 
```

这编译，但我得到一个`RuntimeException`建议我使用`OnItemClickListener`而不是`OnClickListener`一个`AdapterView`.

如何捕获该 onClick 事件？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-04-18T15:52:22.487

尝试设置 OnTouchListener 和 OnKeyListener，而不是设置微调器的 OnClickListener。

```
spinner.setOnTouchListener(spinnerOnTouch);
spinner.setOnKeyListener(spinnerOnKey); 
```

和听众：

```
private View.OnTouchListener spinnerOnTouch = new View.OnTouchListener() {
    public boolean onTouch(View v, MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_UP) {
            //Your code
        }
        return false;
    }
};
private static View.OnKeyListener spinnerOnKey = new View.OnKeyListener() {
    public boolean onKey(View v, int keyCode, KeyEvent event) {
        if (keyCode == KeyEvent.KEYCODE_DPAD_CENTER) {
            //your code
            return true;
        } else {
            return false;
        }
    }
}; 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2014-11-03T00:19:43.980

不要将微调器视为按钮，按钮具有 onClick 事件。Spinners 有 onItemSelected 事件。

**您应该像这样捕获 Spinner 的 onItemSelected 事件：**

```
import android.widget.AdapterView;

Spinner productname_spinner =(Spinner) findViewById(R.id.your_spinner);

productname_spinner.setOnItemSelectedListener(
    new AdapterView.OnItemSelectedListener() {
    public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {

        Object item = parent.getItemAtPosition(pos);
        System.out.println(item.toString());     //prints the text in spinner item.

    }
    public void onNothingSelected(AdapterView<?> parent) {
    }
}); 
```

在 Kotlin 中，类似于以下内容：

```
mySpinner.onItemSelectedListener = object: OnItemSelectedListener {
    override fun onNothingSelected(parent: AdapterView<*>?) {
        // Do nothing
    }
    override fun onItemSelected(parent: AdapterView<*>?, view: View?, position: Int, id: Long) {
        val selection = parent?.getItemAtPosition(position)
        viewModel.updateSelection(selection as String)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-13T13:28:42.847

我尝试`OnItemSelectedListener`使用以下代码实现获取 Selected Spinner Value ：

```
String selectAreaNameString;

AreaSpinner.setOnItemSelectedListener(AreaSpinnerSelected = new AdapterView.OnItemSelectedListener() {
        public void onItemSelected(AdapterView<?> parent, View view, int pos, long id) {

            Object item = parent.getItemAtPosition(pos);

            selectAreaNameString = item.toString();
}); 
```

# actionscript-3 - AS3 ViewStack 内容剪辑

> ID：10213017
> 
> 赞同：0
> 
> 时间：2012-04-18T15:43:07.943
> 
> 标签：actionscript-3, apache-flex, viewstack

我有下一个代码（Flash Builder 4.5）

这个主要的应用程序文件，用于测试我的 viewstack 组件。

选项卡面板测试

```
 </fx:Declarations>
    <fx:Script> 
        <![CDATA[
            import mx.events.FlexEvent;

            protected function creationCompleteHandler(event:FlexEvent):void
            {
                tp.AddPanel("111", new Button());
                tp.AddPanel("444", new TestPanel());
                tp.AddPanel("2222222", new Button());
                tp.AddPanel("3333333333", new Button());

            }

            protected function button1_clickHandler(event:MouseEvent):void
            {
                // TODO Auto-generated method stub
                tp.RemoveAllPanels();
            }

        ]]>
    </fx:Script>

    <ns1:TabPanel id="tp" x="25" y="27" width="321" height="199">
    </ns1:TabPanel>
    <s:Button x="439" y="25" label="Кнопка1" click="button1_clickHandler(event)"/>

</s:Application> 
```

这是 TabPanel，具有公共方法 AddPanel 和 RemoveAllPanels。

选项卡面板

```
 protected function creationCompleteHandler(event:FlexEvent):void
            {
                //buttons1.dataProvider=new ArrayCollection();
            }

            public function AddPanel(name:String, element:IVisualElement):void{
                var panel:NavigatorContent=new NavigatorContent();
                panel.label=name;
                panel.addElement(element);
                panels.addElement(panel);
            }
            public function RemoveAllPanels():void{
                //panels.swapElements(swapElementsAt(0,2);
                panels.removeAllElements();
                /*var but:Button;
                but=new Button();
                but.label=name;
                buttons.addElement(but);    */          
            }           
        ]]>
    </fx:Script>

    <mx:ViewStack id="panels" x="0" y="31" width="100%" height="100%" borderColor="#000000"
                  borderStyle="solid" borderVisible="true" clipContent="true" includeInLayout="true">
    </mx:ViewStack> 
    <s:ButtonBar id="buttons1" x="0" y="0" width="100%" dataProvider="{panels}"
                 justificationStyle="pushOutOnly"/>
</s:Group> 
```

这是测试面板，其大小大于视图堆栈，并且必须进行裁剪。测试面板

```
<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
         xmlns:s="library://ns.adobe.com/flex/spark"
         xmlns:mx="library://ns.adobe.com/flex/mx"
         width="100%" height="100%">
    <fx:Script>
        <![CDATA[
            import spark.components.NavigatorContent;           
            protected function button1_clickHandler(event:MouseEvent):void
            {
                // TODO Auto-generated method stub
                NavigatorContent(this.parent.parent.parent).label="bebe";
            }
        ]]>
    </fx:Script>

    <fx:Declarations>
    </fx:Declarations>
    <s:Button x="163" y="35" width="315" height="209" label="Кнопка"
              click="button1_clickHandler(event)"/>

</s:Group> 
```

当我单击按钮栏中的“444”时，我的内容不会剪辑。什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:17:21.220

问题在于 TestPanel 自定义组件的这一行：-

```
<s:Button x="163" y="35" width="315" height="209" label="Кнопка"
              click="button1_clickHandler(event)"/> 
```

如果您将任何组件添加到父容器：-

子组件将考虑相对于父组件的 x 和 y 位置。如果你想适合你的子组件，你应该使用 x=0 和 y=0 以及 width = 100% 和 height = 100%

试试这个，看看输出： -

```
<s:Button x="163" y="35" width="100%" height="100%" label="Кнопка"
              click="button1_clickHandler(event)"/> 
```

再试一次，看看结果： -

```
<s:Button x="0" y="0" width="100%" height="100%" label="Кнопка"
              click="button1_clickHandler(event)"/> 
```

您将了解组件的行为方式。

希望这可以解决您的问题......

# objective-c - 在数组中查找对象的索引/位置而不遍历其所有内容

> ID：10213018
> 
> 赞同：4
> 
> 时间：2012-04-18T15:43:12.440
> 
> 标签：objective-c, ios

拿下面的代码：

```
 NSPredicate *predicateSource = [NSPredicate predicateWithFormat:@"SELF = %d",5];
 NSArray *filteredArraySource = [[[self.myArray copy]autorelease] filteredArrayUsingPredicate:predicateSource]; 
```

`myArray`( `NSMutableArray`) 包含 100 个整数（数字 1-100 以随机顺序排列）。我想做的是以某种方式找出哪个索引包含数字`5`，而无需遍历数组中的每个对象。上面的代码只提取对象并将其放入数组中。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T15:49:00.430

您可以使用`indexOfObject:`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:48:40.140

您可以使用`indexOfObjectPassingTest:`. 如果您需要使用`NSPredicate`，请在块内调用您的谓词`evaluateWithObject:`；否则，只需检查对象的整数值是否为`5`.

# google-maps - Districts/Sublocalities：列表或如何使用 Google API

> ID：10213019
> 
> 赞同：3
> 
> 时间：2012-04-18T15:43:18.970
> 
> 标签：google-maps, google-maps-api-3, states, regions, countries

我正在拼命寻找世界所有城市的地区或次地区列表/数据库。

我使用来自 maxmind.com 的世界所有城市的列表，但是，它们不提供子地区或地区（例如纽约的“曼哈顿”、“布鲁克林”等）。

有人知道某处是否存在解决方案吗？或者是否有可能使用 Google Maps API 获取所有子区域？（因为我在数据库中有 2.7mio 城市的 LatLng 值）。

非常感谢您提前提供任何提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:33:08.197

服务条款禁止大量下载 Google 数据。

Geonames 可能是您最好的选择，尽管社区仅适用于美国城市： [http ://www.geonames.org/export/web-services.html#neighbourhood](http://www.geonames.org/export/web-services.html#neighbourhood)

[现有 Geonames 对象的子](http://www.geonames.org/export/place-hierarchy.html#children)级可用，但似乎不包括城市的子级。

# python - 在 Django 中扩展用户配置文件。管理员创建用户

> ID：10213020
> 
> 赞同：5
> 
> 时间：2012-04-18T15:43:23.497
> 
> 标签：python, django, django-models, django-forms

晚上好，

我目前正在使用 Django 创建一个站点，并使用用户配置文件扩展了用户。不过我有一个小问题。这是我的情况：

1.  我扩展了用户配置文件以添加自定义字段。
2.  我将模型添加到用户管理模型中，所以当我添加用户时，我可以直接填写字段来创建配置文件。
3.  现在，如果我没有在这些新的自定义用户字段中添加任何内容，则在用户添加页面中，Django 管理员不会向我抛出错误，说这些字段为空（并且它们不应该是）
4.  我希望它在此用户添加管理员页面中向我抛出错误，以便管理员在添加新用户时必须填写个人资料。
5.  所有用户都将添加到管理面板中。

这可能吗？非常感谢！

**在 admin.py**

```
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin as DjangoUserAdmin
from django.contrib.auth.models import User
from accounts.models import UserProfile

class UserProfileInline(admin.TabularInline):
    model = UserProfile

class UserAdmin(DjangoUserAdmin):
    inlines = [ UserProfileInline,]

admin.site.unregister(User)
admin.site.register(User, UserAdmin) 
```

**在模型.py**

```
class UserProfile(models.Model):
    user = models.OneToOneField(User)
    employee_number = models.PositiveIntegerField(unique=True)

    def __unicode__(self):
        return 'Number' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T17:44:18.910

默认情况下，允许空内联，因此不会对空表单进行进一步检查。您需要手动覆盖它：

```
class UserProfileForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(UserProfileForm, self).__init__(*args, **kwargs)
        if self.instance.pk is None:
            self.empty_permitted = False # Here

    class Meta:
        model = UserProfile

class UserProfileInline(admin.TabularInline):         
    model = UserProfile                               
    form = UserProfileForm 
```

# android - Android：为什么我的列标题被推离屏幕边缘？

> ID：10213022
> 
> 赞同：0
> 
> 时间：2012-04-18T15:43:27.343
> 
> 标签：android, alignment, tablelayout, gravity, android-tablelayout

我是 Android 开发的新手，如果这是一个菜鸟问题，请原谅我！我正在尝试显示一个包含 2 列的表格。第二列应右对齐，但可以是固定宽度。第一列应拉伸以填充任何剩余空间。我有一个非常简单的表格布局，但它会将第二列的文本推离屏幕边缘，因此您无法阅读它。

这是布局的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/tbl_my_tanks"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:stretchColumns="0">

    <TableRow android:padding="3dip">
        <TextView
            android:id="@+id/col_tank_name"
            android:text="@string/tanks_tank_name" />

        <TextView
            android:id="@+id/col_stock_level"
            android:gravity="right"
            android:text="@string/tanks_stock_level" />

    </TableRow>

</TableLayout> 
```

...这就是我运行它时的样子：

![Android中的文本从屏幕的右侧边缘消失](../Images/9a93d5eee568782bbcc3750c8a923bab.png)

我怎样才能让它正确对齐？（我尝试使用 android:layout_gravity="right"，但这没什么区别）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T15:56:37.977

如果从表格行中删除填充，应该没问题。尝试改用边距。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:47:16.333

根据 api docs，tablerow 应该始终是 tablelayout 的子项，也许这就是它表现得很时髦的原因？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-14T15:32:26.260

我有同样的问题。有时通过在行的最后一列添加与右边距相同的维度来补偿剪裁来修复它：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/tbl_my_tanks"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:stretchColumns="0">
    <TableRow android:padding="3dip">
        <TextView
            android:id="@+id/col_tank_name"
            android:text="@string/tanks_tank_name" />
        <TextView
            android:id="@+id/col_stock_level"
            android:gravity="right"
            android:layout_marginRight="3dip"
            android:text="@string/tanks_stock_level" />

    </TableRow>
</TableLayout> 
```

如果仍然裁剪，则只需将行填充添加为行的每一列的边距。

# c# - 手动混淆所需的想法

> ID：10213028
> 
> 赞同：0
> 
> 时间：2012-04-18T15:43:54.710
> 
> 标签：c#, .net, obfuscation

我想避免我的程序简单地删除许可证验证器部分。

我不想使用商业混淆器，因为：

1.  的成本。虽然他们可以比我做得更好——他们也不会让它变得不可能破解，只是更难。
2.  似乎有时混淆器会在生成的代码中导致错误。

显然，我将保留一份未混淆的副本以进行维护。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T15:51:52.380

我曾经不得不在客户可以修改的代码中隐藏一个许可证验证器。可以想象，如果他们知道去哪里看，他们本可以将其移除。以下是我当时使用的一些技巧。

1.  为您的验证器类、程序集名称和变量名称提供看起来像是它们实际上在做其他事情的名称。
2.  从代码的多个部分调用验证器。
3.  向验证调用添加随机化器，以便有时运行，有时不运行。这将使我们更难知道验证码的实际来源。

我应该补充一点，所有这些都是可以解决的，并且可能会导致严重的维护问题，但在我的特定场景中它确实有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:52:08.667

如果您的意图是让它变得更难，但并非不可能，一种方法是让多个代码点检查您的许可证文件是否有效。

假设您有一个带有一些密钥的许可证文件，如下所示

```
abc-def-fhi-asdf 
```

所以，关键的四个部分。然后，我们将创建四种不同的方法来检查密钥的各个部分。

通过这样做，并通过代码改变使用的方法（理想情况下，在运行时随机选择验证方法），您使删除验证变得更加困难。

最重要的是，一种方法是有一个发布过程来内联您的验证方法，每次调用它时都会巧妙地改变它。

例如这样的：

```
*user clicks a common function
// [VALIDATION STUB]
*perform user action 
```

新的发布过程贯穿代码，拉出 // [VALIDATION STUB] 并将其替换为您的验证代码（在代码编译之前），正如我所说的，每次都应该尽可能地变化。

从我的回答中得出的主要结论是，混淆很难，但并非不可能。尤其是如果您接受恶意用户最终总会破坏它的现实

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T21:44:38.757

我有一些你可能会觉得有用的建议。

首先，您当然可以使用免费的混淆器，例如 VisualStudio 附带的混淆器。总比没有好。

其次，您可以编写您的许可证验证代码，一旦它工作正常，尽可能重构它，将类名、成员变量、局部变量和方法更改为 c1、v1、l1、m1 等。这基本上就是混淆器所做的。

第三，做到以上所有。

第四，用非托管代码（C++、Delphi）编写您的许可证验证，并将其命名为重要的 DLL，例如 core.dll、net.dll 等。您还可以在其中放置一些无用的诱饵方法。从代码的多个位置对该 DLL 进行多次调用，并假装您对这些调用的结果做了一些事情。

# javascript - 使用正则表达式提取部分 SQL 语句

> ID：10213030
> 
> 赞同：2
> 
> 时间：2012-04-18T15:43:59.477
> 
> 标签：javascript, regex, extraction

我想像这样提取部分 SQL 字符串：

```
SELECT *,somecolumn, anothercolum FROM sometable INNER JOIN anotherTable WHERE somecolumn>1 
```

在变量中：

```
aVariable = "*,somecolumn, anothercolum";
anotherVariable = "sometable INNER JOIN anotherTable";
Vaiable = "somecolumn>1"; 
```

我试过这个（在 JavaScript 中）：

```
/SELECT\s(\*|[\w\,\_\d]+)\sFROM\s([\w\,\_]]+)(?:\s(.*)) 
```

但它失败了`INNER JOIN`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T20:41:36.460

```
/SELECT\s(.*?)\sFROM\s((?!WHERE|ORDER BY|GROUP BY).*?)(?:WHERE\s|ORDER BY\s|GROUP BY\s|\Z)(.*)/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-15T16:26:32.857

尝试这个：

```
var reg =/^(\s*select\s+)(\w+(\s+as\s+\w+\s*)?||\[\s*\w+\s*\](\s+as\s+\w+\s*)?||\*\s*)(\s*\,\s*\w+(\s+as\s+\w+\s*)?||\s*\,\s*\[\s*\w+\s*\](\s+as\s+\w+\s*)?)*(\,\*)?(\s+from\s+)\w+\s*(\s+where\s+\[?\s*\w+\s*\]?\s*((\+||\-||\*||\/||\%||\^||(\>\=)||(\<\=)||\=||\>||\<)\s*\[?\s*\w+\s*\]?)?(\s+and\s+\[?\s*\w+\s*\]?\s*((\+||\-||\*||\/||\%||\^||(\>\=)||(\<\=)||\=||\>||\<)\s*\[?\s*\w+\s*\]?)?(\s+and\s+\[?\s*\w+\s*\]?\s+like\s+\'\%?\s*\w+\W*\w+\s*((\+||\-||\*||\/||\%||\^||(\>\=)||(\<\=)||\=||\>||\<)\s*\w+)?\%?\')?)*\s*)?(\s+order\s+by\s+(\w+\s*((\+||\-||\*||\/||\%||\^||(\>\=)||(\<\=)||\=||\>||\<)\s*\w+)?(\s+desc||\s+asc)*)(\,\w+((\+||\-||\*||\/||\%||\^||(\>\=)||(\<\=)||\=||\>||\<)\w+)?(\s+desc||\s+asc)*)*)?(\s+group\s+by\s+\w+(\,\w+)?(\s+having\s+\w+(\s*(\+||\-||\*||\/||\%||\^||(\>\=)||(\<\=)||\=||\>||\<)\s*\w+)?(\s*\,\s*\w+\s*((\+||\-||\*||\/||\%||\^||(\>\=)||(\<\=)||\=||\>||\<)\s*\w+)?)?)?)?\s*$/g; 
```

# jsp - 如何在 JSP 页面之外运行 taglib？

> ID：10213032
> 
> 赞同：1
> 
> 时间：2012-04-18T15:44:17.997
> 
> 标签：jsp, jakarta-ee, servlets, jsp-tags, taglib

鉴于我在 JSP 上有这样的东西：

```
<cic:table listBeanParm="presbeans" showSelct="false" messageType="cicProductTable">
    <cic:column>
        <cic:title>A column title</cic:title>
    </cic:column>    
</cic:table>
....
<% TableModel tableModel = (TableModel)request.getAttribute( "cic.table.model"); %>
//tableModel used here 
```

我可以看到，在与之关联的代码中`cic:table`，它设置了属性“cic.table.model”（障碍：我必须反编译才能看到它......没有源代码）。

```
 public int doEndTag() throws JspException {
/*  47*/        request.setAttribute("cic.table.model", tableModel);
/*  48*/        init();
/*  49*/        return super.doEndTag();
            } 
```

看起来类型层次结构如下所示：

```
cicTable extends cicComponent
cicComponent extends BodyTagSupport
(cicComponent runs pageContext.getOut(), and we do not have a page!) 
```

但即便如此，我尝试了几个这样的变体（doStartTag，doEndTag），但我的调用总是失败，编译类中出现空指针：

```
 System.out.println("type:" + request.getAttribute("presbeans").getClass().getName());
    cicTable aTable = new cicTable();
    aTable.setListBeanParam("presbeans");
    aTable.setShowSelect("false");
    aTable.setMessageType("cicProductTable");
    //int result = Integer.MAX_VALUE;
    //try {result = aTable.doStartTag();} catch (Exception e) {System.out.println("doStartTag bombed: " + e.getMessage());}
    //System.out.println("doStartTag returned " + result);
    int result2 = Integer.MAX_VALUE;
    result2 = Integer.MAX_VALUE;
    try {result2 = aTable.doEndTag();} catch (Exception e) {System.out.println("doEndTag bombed: " + e.getMessage());}
// Always a null pointer on the line above
    System.out.println("doEndTag returned " + result2);

    TableModel tableModel = (TableModel)request.getAttribute( "cic.table.model"); 
```

我想做的是找到一种方法，将 JSP 页面上的标记库中发生的事情转换为将在 servlet 中运行的代码。 **是否有标准的食谱方法来让 taglib 的东西在 Servlet 中运行？**

# html - 动态验证复选框并将特定查询数据传递到操作页面？

> ID：10213042
> 
> 赞同：0
> 
> 时间：2012-04-18T15:44:42.040
> 
> 标签：html, sql, coldfusion

我正在做一些 CF 开发，但我遇到了一个问题。与其把头敲在键盘上，我想我会问一个更有经验的人。

所以这就是我正在处理的事情：

```
<form name="inv" action="action.cfm" method="post" >

<cfoutput query="getQuery">

<input type="checkbox" name="ischecked" value="1" unchecked />
<input type="Hidden" name="DeviceID" value="#DeviceID#">
</td>

    <td><font size="3"><b>Device ID:</b></font>#DeviceID#</td>
    <td><font size="3"><b>User</b></font>#User#</td>
    <td><font size="3"><b>Tag:</b></font>#Tag#</td>
  </table>
  </cfoutput>
      <table>
          <tr><td> Action: </td>
           <td>

           <select name="choose_action">

            <option value="1"> Action 1 </option>

            <option value="2"> Action 2  </option>

            <option value="3"> Action 3  </option>

        </select>

<INPUT type="reset" name="reset" action="reset">

<INPUT type="submit" name="submit" action="submit">

        </td>
        </tr> 
```

所以基本上我有这个表格，它输出我的查询中的所有信息（工作正常）并循环显示它。我希望用户能够查看此信息，单击特定设备的复选框，并根据底部的菜单执行操作，然后将转到操作页面并使用传入的信息执行查询基于 cfif 循环。

我遇到的问题是我无法弄清楚如何传递我想要用户特别检查的信息，因为它是一个循环。当我提交包含设备 ID 的隐藏字段时，我最终会提交每个具有复选框的设备 ID（即每一个）。复选框值也是如此。它只是将所有查询数据转储到查询中每个设备的操作页面中，而不仅仅是我想要首先检查的一个设备 ID。

我正在考虑一些后端 JS，但我并不完全确定我将如何去做。我希望我可以验证它并在提交之前说：“如果这被选中，那么只提交这个特定的设备 ID”

感谢您的时间和反馈！如果我需要澄清任何事情，请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T15:58:25.713

这是2个答案（我都看过）。

首先 - 尝试使设备 ID 成为复选框“名称”的一部分。

```
<cfoutput query="getQuery">

<input type="checkbox" name="ischecked_#deviceID#" value="1" unchecked />

</cfoutput> 
```

然后你会像这样循环表单：

```
<cfloop collection="#form#" item="fItem">
   <cfif listfirst(fItem,'_') IS 'ischecked'>
      <cfset thisDeviceID = listlast(fItem,'_')>
       ...do something with deviceID
   </cfif>
</cfloop> 
```

第二种方法是将设备 ID 存储在“ischecked”表单字段中，如下所示：

```
<cfoutput query="getQuery">

<input type="checkbox" name="ischecked" value="#deviceID#" unchecked />

</cfoutput> 
```

这些值作为包含任何已检查内容的列表出现...因此，如果您的用户检查 1、5 和 7，则变量 #form.isChecked# 将是一个看起来像 1、5、7 的列表。使用 listfind 或 cfloop 或其他任何东西来处理它。请记住，您必须使用检查来确保 taht form.isChecked 存在，因为如果未检查任何内容，它将不存在（对于大多数浏览器）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:00:16.763

有多种方法可以做到这一点，但总体思路是使用动态字段名称和值......

```
<input type="checkbox" name="ischecked" value="#DeviceID#" />

<select name="choose_action_#DeviceID#"> 
```

在 ColdFusion 中，多个同名字段表示为列表

```
<cfloop query="..">
    <cfif listfindnocase(form.ischecked, DeviceID)>
        <cfif form['choose_action_#DeviceID#'] eq 1>

        <cfelseif form['choose_action_#DeviceID#'] eq 2>

        etc

        </cfif>

    </cfif>
</cfloop> 
```

# python - 使用 rdflib 和 sparql 查询过滤 n3/turtle 文件

> ID：10213045
> 
> 赞同：3
> 
> 时间：2012-04-18T15:44:43.347
> 
> 标签：python, rdf, sparql, rdflib

我正在尝试使用 pyrdf 和 sparql 过滤海龟文件。但我注意到 sparql 查询丢失了元素上下文的信息。然后我想将查询结果重新打印为海龟文件，是否可以在不手动扫描元素的所有子字段的情况下做到这一点？我们有关于位置的数据，格式如下：

```
:pt0001
     vcard:category "Poste e Telegrafi"
    ; vcard:fn "Ufficio Bologna 1"
    ; vcard:extended-address "Via Cairoli 9, Bologna BO, Italy"
    ; vcard:latitude "44.504192"
    ; vcard:longitude "11.338661"
    ; vcard:tel "051 243425"
    ; vcard:fax "051 244459"
    ; cs:opening "Mon, Tue, Wed, Thu, Fri: 0800-1330\. Sat: 0800-1230."
    ; cs:closing "01-01, 01-06, P, LA, 04-25, 05-01, 06-02, 08-15, 11-01, 12-08, 12-25, 12-26: .". 
```

例如，我们只需要具有名称 (fn) 的位置。感谢您找到的任何提示...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T18:50:20.530

要取回所有具有名称的位置，您可以执行以下简单操作：

```
SELECT DISTINCT ?location
WHERE { 
   ?location vcard:fn [].
} 
```

这将为您返回标识符（`:pt0001`在您的示例中），但当然查询也可以适应返回所有属性值。

*（**编辑**我根据您的说明添加了其他示例，我认为这就是您所追求的）*

像这样：

```
SELECT ?location ?prop ?value
WHERE { 
   ?location vcard:fn [];
             ?prop ?value .
} ORDER BY ?location 
```

此查询的结果将是以下形式的结果表：

```
?location    ?prop           ?value
:pt0001      vcard:category  "Poste e Telegrafi"
:pt0001      vcard:name      "Ufficio Bologna 1"
:pt0001      vcard:tel       "051 243425"
(etc...) 
```

或者，作为另一种选择，您可以明确制定查询以获取每个位置的特定属性值：

```
SELECT ?location ?name ?cat ?tel
WHERE { 
   ?location vcard:fn ?name ;
             vcard:category ?cat ;
             vcard:tel ?tel .
} ORDER BY ?location 
```

这将为您提供以下形式的结果表：

```
?location ?name               ?cat                ?tel
:pt0001   "Ufficio Bologna 1" "Poste e Telegrafi" "051 243425" 
```

任你选。

SPARQL 查询的诀窍是考虑三元组。您的数据包含主谓宾三元组，SPARQL 查询在这些三元组上制定模式。

作为进一步的评论：我看到您正在考虑将查询结果重新打印为海龟。在这种情况下，CONSTRUCT 查询可能就是您所追求的。SELECT 查询的结果（如上所示）是一个表结构，而 CONSTRUCT 查询的结果是 RDF 三元组的集合：

```
 CONSTRUCT { ?subject ?predicate ?object }
 WHERE { 
   ?subject ?predicate ?object ;
            vcard:fn [] 
 } 
```

# asp.net - ASP.NET 中的运行时工作流

> ID：10213048
> 
> 赞同：0
> 
> 时间：2012-04-18T15:44:46.377
> 
> 标签：asp.net, silverlight, workflow-foundation

我需要创建一个 ASP.NET 应用程序，它允许用户动态创建工作流并实现它。当我们在案例工具中创建 UML 类图时，用户应该能够创建工作流。这意味着用户应该有一个界面来拖放多个工作流对象并设置各种步骤和流程。

我将使用：C# 4.0 ASP.NET、.NET 2010

我需要知道如何提供这样的功能以及我应该使用哪个工具来允许用户创建这样的运行时工作流并保存。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:23:15.200

要在 Web 上运行工作流基础设计器，您需要查看 WF 运行时的 XBAP 托管。查看 mtaulty[的博客](http://mtaulty.com/CommunityServer/blogs/mike_taultys_blog/archive/2006/11/22/8981.aspx)。

# javascript - 使用 JQuery 在另一个站点上获取元素的维度？

> ID：10213049
> 
> 赞同：0
> 
> 时间：2012-04-18T15:44:52.773
> 
> 标签：javascript, jquery

我有一组 url，其中都有一个 id 为“section_container”的 div。在一个完全独立的 url 上，我想访问这个页面，检测容器的宽度并返回该值，希望通过 post call 或其他方式返回。

这可以做到吗？顺便说一句，我拥有所有域。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T15:48:27.683

由于[同源策略](https://en.wikipedia.org/wiki/Same_origin_policy)等安全功能，我认为您无法做到这一点（主要是因为[跨站点脚本](https://en.wikipedia.org/wiki/Cross-site_scripting)）。

但是，如果您拥有所有域，则可以在您的站点上设置某种 API 来获取该元素的高度。显然，这需要在服务器上完成，但是您的任何站点都可以根据需要获取该信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:49:10.900

你需要让 jQuery 跨域工作，这可以通过使用这个插件来完成：[Cross Domain Plugin](https://github.com/padolsey/jQuery-Plugins/tree/master/cross-domain-ajax/)。

然后，您可以使用 $.ajax get 获取页面并找到该 div，一旦您拥有该 div，您就可以获得它的宽度和高度。

# c# - 在程序中存储数据时减少内存使用 - VB.NET / C#

> ID：10213056
> 
> 赞同：1
> 
> 时间：2012-04-18T15:45:11.117
> 
> 标签：c#, vb.net, arraylist

我有一个 ArrayList，其中存储了 100,000 多个数字。每个数字的长度为 10 位或更小。程序本身有数据输入，它循环通过用户输入来查看他们的任何数字是否已经在使用`if ArrayList.Contains(userinput)`.

看起来，当拥有这种大小的 ArrayList 时，会使用大量内存。是否有更快的方法来运行它，例如数据库或`If TextFile.Contains(Line)`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T15:47:34.177

您应该使用 a`List<T>`来避免装箱并节省内存。
使用 a`HashSet<T>`会快得多，但会比 a 使用更多的内存`List<T>`。

根据您的具体情况，数据库可能是最好的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T15:51:13.393

另一种解决方案可能是将`100.000+`元素数组*按排序顺序排列*并用于`BinarySearch`查找感兴趣的元素。

Mush 会更快`Contains`，而且您不需要分配字典，因此不会消耗额外的内存。

所有这些东西都是*衡量的主题，以便在**您的具体场景*中为您选择正确的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:56:12.963

一旦您有并发读/写场景，请考虑使用`System.Collections.Concurrent.ConcurrentDictionary<,>`. 它应该提供更好的性能，因为它不需要锁定它的操作。但是，如果操作比简单的添加/获取/删除更复杂，那么您仍然需要锁并且 a`HashSet<>`应该更快（正如 SLaks 所建议的那样）。

# jquery - TYPO3 extbase - jquery 的流体变量

> ID：10213062
> 
> 赞同：3
> 
> 时间：2012-04-18T15:45:21.537
> 
> 标签：jquery, typo3, fluid, extbase

如何将一个流体变量从控制器传递给 jQuery 或 JavaScript？

在我的控制器内部：

```
public function tabs () {
    $this->view->assign('tab', 1);
} 
```

在流体内部，我将变量用作 {tab} 但如何传递给 JavaScript？任何帮助，将不胜感激...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-17T10:11:50.937

如果您需要像 f:for 这样的流体标签，您可以使用 CDATA（也可以使用流体变量）。例如

```
 <script type="text/javascript"><![CDATA[
            function initialize() {
                    var marker = [];
                    var LatLng;
                    var queryLatlng = new google.maps.LatLng(]]>{queryLat}, {queryLng}<![CDATA[);
                    var mapOptions = {
                            center: queryLatlng,
                            zoom: 8,
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                    };
                    var map = new google.maps.Map(document.getElementById("tx_gmapplus-map"),mapOptions);

                    marker['0'] = new google.maps.Marker({
                            position: queryLatlng,
                            map: map,
                            title: "Standort"
                    });
                    ]]><f:for each="{addresses}" as="address" iteration="it"><![CDATA[
                            latlng = new google.maps.LatLng(]]>{address.txGmapplusLatitude}, {address.txGmapplusLongitude}<![CDATA[);
                            ]]>marker['{it.cycle}']<![CDATA[ = new google.maps.Marker({
                                    position: latlng,
                                    map: map,
                                    title: ]]>"{address.name}"<![CDATA[
                            });
                            ]]></f:for><![CDATA[
            }
]]></script> 
```

写起来不太舒服，但它正在工作，并且您具有流体逻辑的优势。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-01T13:34:56.940

我通常为此使用数据属性。所以在流体中你有这样的东西：

```
<div data-tab="{tab}"></div> 
```

在您的 JavaScript 中，您可以通过以下方式访问此属性：

```
jQuery('div').data('tab'); 
```

当然，您可以为此使用任何 HTML 元素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T17:00:54.687

流体模板中的 JS 行为是......在大多数情况下很糟糕，如果您的 JS 代码包含任何大括号，则您需要包含外部脚本，而不是将脚本放在视图中。

原因是 Fluid 认为，所有大括号都属于它的范围，所以当你写的时候：

```
$('#mySelectBox').change(function() {
    // functions body code
    // next line
    // next line
}); 
```

Fluid 销毁 JS 并将其呈现为：

```
$('#mySelectBox').change(function() Array); 
```

然后我经常使用这样的东西：

*在视图中：*

```
<script>var TxMyExtKeyTabNumber = {tab}</script>
<script src="path/to/static/script.js"></script> 
```

*在 script.js 中：*

```
$("#container").val(TxMyExtKeyTabNumber); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2021-03-10T20:15:45.073

我有没有 ![CDATA[. 我在将元素 ID 传递给流体模板中的模态时遇到问题

```
 document.addEventListener("DOMContentLoaded", function(event) {
                    var deki = '#modal-{data.uid}'; // data.uid is fluid variable 
                        $(deki).on('show.bs.modal', function () {
                            // call play() on the <video> DOM element
                            $('#videoId1')[0].play()
                        });
                        $(deki).on('hidden.bs.modal', function () {
                            // call play() on the <video> DOM element
                            $('#videoId1')[0].pause()
                        })

                }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-22T00:34:00.873

我做了这样的事情，对于值只需添加`{settings.mySettingName}`TypoScript 变量或您拥有的任何数据

```
function getHiddenSettings(className) {
    var settings = {};
    $.each($(className), function (index, input) {
        if (input.dataset.type === "integer") {
            settings[input.name] = parseInt(input.value) || 0;
        } else if (input.dataset.type === "boolean") {
            settings[input.name] = !!(parseInt(input.value) || input.value === "true")
        } else if (input.dataset.type === "string") {
            settings[input.name] = input.value;
        }
    });
    return settings;
}

var settings = getHiddenSettings(".mySettings");

$('pre').html(JSON.stringify(settings, null, 2));
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<input type="hidden" class="mySettings" name="closedTimes" value="0" data-type="integer">
<input type="hidden" class="mySettings" name="onlyEmail" value="false" data-type="boolean">
<input type="hidden" class="mySettings" name="serverError" value="Server problem" data-type="string">

<pre></pre>
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-19T15:46:34.133

不好（但也不比 CDATA 的东西更丑），但可以直接在 javaScript 中使用标记符号流。在 { } 括号之外，您当然可以直接访问流体变量。在括号内，您可以使用任何流体标签包装流体变量。

所以下面的所有例子都可以工作......

```
<script>
   var myGlobal = {fluidVar};
   function myFunc(){
      var myLocal = <f:format.raw>{fluidVar2}</f:format.raw>
      var myLocal2 = <f:if condition="1">{fluidVar3}</f:if>
   }
</script> 
```

# c++ - 在 C++ 中，如何仅使用带必需参数的长选项？

> ID：10213071
> 
> 赞同：5
> 
> 时间：2012-04-18T15:46:00.603
> 
> 标签：c++, options, getopt

在 C++ 程序中，我想要一个带有必需参数的“long-only”选项。下面是我使用[getopt_long()](http://www.gnu.org/software/libc/manual/html_node/Getopt-Long-Option-Example.html#Getopt-Long-Option-Example)的最小示例，但它不起作用：

```
#include <getopt.h>
#include <cstdlib>
#include <iostream>
using namespace std;

void help (char ** argv)
{
  cout << "`" << argv[0] << "` experiments with long options." << endl;
}

void parse_args (int argc, char ** argv, int & verbose, int & param)
{
  int c = 0;
  while (1)
  {
    static struct option long_options[] =
      {
        {"help", no_argument, 0, 'h'},
        {"verbose", required_argument, 0, 'v'},
        {"param", required_argument, 0, 0}
      };
    int option_index = 0;
    c = getopt_long (argc, argv, "hv:",
                     long_options, &option_index);
    cout << "c=" << c << endl;
    if (c == -1)
      break;
    switch (c)
    {
    case 0:
      if (long_options[option_index].flag != 0)
        break;
      printf ("option %s", long_options[option_index].name);
      if (optarg)
        printf (" with arg %s", optarg);
      printf ("\n");
      break;
    case 'h':
      help (argv);
      exit (0);
    case 'v':
      verbose = atoi(optarg);
      break;
    case 'param':
      param = atoi(optarg);
      break;
    case '?':
      abort ();
    default:
      abort ();
    }
  }
}

int main (int argc, char ** argv)
{
  int verbose = 0;
  int param = 0;
  parse_args (argc, argv, verbose, param);
  cout << "verbose=" << verbose << " param=" << param << endl;
  return EXIT_SUCCESS;
} 
```

我用这个命令编译它（gcc 版本 4.1.2 20080704 Red Hat 4.1.2-46）：

```
g++ -Wall test.cpp 
```

它告诉我这个：

```
test.cpp:44:10: warning: character constant too long for its type 
```

结果如下：

```
$ ./a.out -v 2 --param 3
c=118
c=0
option param with arg 3
c=-1
verbose=2 param=0 
```

我试图让它在[ideone](http://ideone.com/yllaO)上工作，但它甚至无法识别该选项`-v`。

正如 trojanfoe 在他对另一个问题的[评论](https://stackoverflow.com/a/8169291/597069)中所指出的那样，应该可以使用“long-only”选项，因为 GNU tar 可以做到这一点。但是，GNU tar 使用[argp](http://www.gnu.org/software/libc/manual/html_node/Argp.html#Argp)，我很难理解它的[源代码](http://git.savannah.gnu.org/cgit/tar.git/tree/src/tar.c#n385)。

有人可以给我一个适用于 GNU`getopt_long()`或GNU 的最小示例`argp()`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T16:26:33.813

有两个问题：

1.  根据示例代码（您的链接），结构中定义的最终选项必须是`{0,0,0,0}`. 我建议将定义更改为

    ```
    static struct option long_options[] =
      {
        {"help", no_argument, 0, 'h'},
        {"verbose", required_argument, 0, 'v'},
        {"param", required_argument, 0, 0},
        {0,0,0,0}
      }; 
    ```

2.  （更重要的是，）您必须包含实际处理“参数”选项的代码。你在这种`'0'`情况下这样做：

    ```
    case 0:
      if (long_options[option_index].flag != 0)
        break;
      if (strcmp(long_options[option_index].name,"param") == 0)
        param = atoi(optarg);
      break; 
    ```

如您所见，我使用该`strcmp`函数来比较字符串；为此，您需要`#include <cstring>`。顺便说一句，您还需要`#include <cstdio>`使用`printf`.

有了这些更改，该程序对我来说可以正常工作（在 GCC 4.5.1 上测试）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T15:49:47.047

在您的案例陈述中，您正在使用：

```
case 'param': 
```

这给了你警告，因为编译器需要在那个地方有一个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:23:17.310

事实上，我意识到我应该检查`option_index`when `c`has value 的值`0`，就像这样。这种情况不在 GNU libc 示例中，所以这里是：

```
switch (c)
{
case 0:
  if (long_options[option_index].flag != 0)
    break;
  if (option_index == 2)
  {
    param = atoi(optarg);
    break;
  }
case 'h':
  help (argv);
  exit (0);
case 'v':
  verbose = atoi(optarg);
  break;
case '?':
  abort ();
default:
  abort ();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-26T09:47:10.923

另一种解决方案是使用 struct 选项中定义的 'flag' 成员值。

设置您的选项，如下所示：

```
int param_flag = 0;

{"param", required_argument, &param_flag, 1} 
```

然后;

```
case 0:
    if (param_flag == 1) {
        do_something;
    } 
```

有关 struct 选项的详细信息，请参阅 man getopt_long。

# jsf - JSF 2、Facelets 和通过代理调用的内容的渲染问题

> ID：10213074
> 
> 赞同：1
> 
> 时间：2012-04-18T15:46:08.713
> 
> 标签：jsf, jsf-2, facelets

我们有一个 JSF2 Facelets 模板实现，它为整个企业的应用程序提供 HTML“包装器”。应用程序部署在 WAS 7 上，并通过共享库调用我们的 Facelets 模板。

我们有一个请求，通过外部 Web 服务器的 xhtml 文件拉入左侧导航 - 这需要通过我们的代理。由于包含的 xhtml 文件不会在 Web 项目中（它将被单独管理并位于 Web 服务器上） - 我正在尝试找到一种方法来通过代理拉入代码并使其正确呈现。由于代理，使用 不起作用。

我编写了一个简单的 bean 来设置代理配置并提取文件的内容。如果我使用 ResponseWriter 输出代码——标签不会在 HTML 输出中呈现：

```
<div class="aligncenter"> <a href="#"> <img src="/allweb/images/corporate/pcom/logout.gif" alt="Logout" width="138" height="30" /></a> </div>
<mycom:navBlockHeader type="custom" title="TPA Nav Pilot" />
<mycom:divStart expandableNav="true"/>
<mycom:navLink href="url" text="Link 1" />
<mycom:navSubLinkStart text="Link 2" href="#" expandable="true" expand_onload="true"/>
<mycom:navLink href="url" text="Link a"/>
<mycom:navLink href="url" text="Link b"/>
<mycom:navLink href="url" text="Link c"/>
<mycom:navSubLinkEnd/>
<mycom:navLink href="url" text="Link 3"/>
<mycom:divEnd /> 
```

我通过自定义标签调用托管 bean：`<mycom:tpaLeftNav/>`

主要的托管bean代码是：

```
public class LeftNavIncludeProxy extends UIComponentBase {
public void encodeBegin(FacesContext context) throws IOException{
    ResponseWriter writer = context.getResponseWriter();
    String include = "";
     System.setProperty("https.proxyHost", "proxy.mycompany.com");
     System.setProperty("https.proxyPort", "80");
     try{
         URL url = new URL("https://secure.mycompany.com/navigation/tpa/leftnav/leftnav-define.xhtml");
         BufferedReader bin = new BufferedReader(new InputStreamReader(url.openStream()));
         String line;
         while ((line = bin.readLine()) !=null){
            include += line;
         }
         include=include.toString();
         writer.write((String) include);
     }
     catch (Exception e){
         e.printStackTrace();
     }
} 
```

}

我可以轻松地检索 leftnav.xhtml 文件的内容——但是当我尝试将它写回 Facelets 模板时——它不会将 Facelets 标记呈现为 HTML。感觉就像我错过了渲染步骤，但我不确定如何轻松解决这个问题。

我确定这是一个初学者的问题 - 如果是，我很抱歉 - 我将不胜感激有关如何解决此问题的任何建议或想法。

谢谢。梅尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:53:48.733

您正在将 Facelets 文件的内容作为纯文本写入响应。这确实行不通。

你应该使用 a[`ResourceResolver`](http://docs.oracle.com/javaee/6/api/javax/faces/view/facelets/ResourceResolver.html)代替。这是您的特定案例的启动示例：

```
public class ProxyFaceletsResourceResolver extends ResourceResolver {

    private ResourceResolver parent;

    public FaceletsResourceResolver(ResourceResolver parent) {
        this.parent = parent;
    }

    @Override
    public URL resolveUrl(String path) {
        if (path.startsWith("/proxy/")) {
            return new URL("https://secure.mycompany.com/" + path.split("/proxy/")[1]);
        }
        else {
            return parent.resolveUrl(path);
        }
    }

} 
```

如果`web.xml`按如下方式配置

```
<context-param>
    <param-name>javax.faces.FACELETS_RESOURCE_RESOLVER</param-name>
    <param-value>com.example.ProxyFaceletsResourceResolver</param-value>
</context-param> 
```

那么你就可以通过例如

```
<ui:include src="/proxy/navigation/tpa/leftnav/leftnav-define.xhtml" /> 
```

# html - XHTML 5 标准检查 (HTML + CSS)

> ID：10213079
> 
> 赞同：-4
> 
> 时间：2012-04-18T15:46:27.640
> 
> 标签：html, css, xhtml

我的网页必须严格使用 XHTML 5 标准开发。我怎样才能检查它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T15:49:03.363

W3C 验证器：

[http://validator.w3.org/](http://validator.w3.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:49:59.657

您可以在此处使用 W3C 验证器：http: [//validator.w3.org/](http://validator.w3.org/)

附带说明：没有 XHTML5 标准这样的东西。上一个 XHTML 版本是 2，那里的开发已经结束。当前的标准只是称为 HTML5。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T15:52:08.680

W3C 有一个实验性的 HTML 5 验证引擎，您可能想在[这里](http://validator.w3.org/#validate_by_uri+with_options)查看。但由于该标准仍在开发中，我认为您还不会找到任何明确的验证引擎。

还请记住，不会有官方的 XHTML5 标准。HTML 5 将支持两种格式，一种使用严格的 XML 语法，另一种使用常规的 HTML 语法，后者稍微宽松一些，因为它不要求结束标记或大写规则。

要获得您正在寻找的内容，您可能需要尝试两种不同的验证。一个是检查您的文档是否是完全兼容的 XML 文档，另一个是通过 HTML 5 验证引擎运行它以检查不合格的标签等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T16:46:34.870

通过将您的代码与 HTML5 规范中的 XHTML 序列化规则进行比较，一旦它成为官方（允许十年交付）。同时，所谓的 HTML5 验证器，例如[http://validator.nu](http://validator.nu)和基于它的 W3C 服务可能有用，但 a) 众所周知，它们是不完整的，可能永远无法检查规则的*所有*方面，b ) 它们不一定反映最新的 HTML5 草案，并且 c) 草案本身正在进行中，可能随时更改，恕不另行通知。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T16:44:23.427

我建议使用[http://validator.nu/](http://validator.nu/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T19:22:26.503

请注意 Jukka 所说的，但关于使用 validator.nu 或 W3C HTML 验证器：

如果您想使用 W3C HTML 验证器将 URL 上的页面验证为 XHTML，并且该页面具有`<!DOCTYPE html>`其 doctype，那么您**必须**使用 XML mime 类型为该页面提供服务，例如`application/xhtml+xml`验证器。

这是一件好事。只有当您使用这种 mime 类型时，浏览器才会将您的 XHTML 视为 XHTML，否则它们会将其视为 HTML，而您所有细心的 XHTML 都将成为标签汤。在 HTML5 中，验证器现在的行为方式与浏览器相同。

# ios - 使用 Adob e Flash Builder 在移动设备上进行声学回声消除 (AEC)

> ID：10213088
> 
> 赞同：4
> 
> 时间：2012-04-18T15:47:07.450
> 
> 标签：ios, flash, flash-builder, microphone, aec

据说 AEC 在移动设备上不可用。但我注意到[Adob​​e Connect](http://www.adobe.com/products/adobeconnect.html)应用程序能够在 ipad 上进行回声消除。

这怎么**可能**？

我尝试了 sdk 4.6 air sdk 3.2 但`Microphone.getEnhancedMicrophone()`返回*null*。 `Microphone.setUseEchoSuppression(true)`也无济于事。

# git - 这个 git commit 发生了什么？“未跟踪文件”的问题

> ID：10213091
> 
> 赞同：1
> 
> 时间：2012-04-18T15:47:22.803
> 
> 标签：git, git-extensions

我刚刚帮助我团队中的一位开发人员修复了一个 git 提交，该提交以某种方式在他的本地 repo 中被修改了。你可以从下面的 Git Extensions 截图中看到，11 小时前他做了一个提交，他认为这包括了他所有的更改。他今天早上发现，他的文件系统上的工作副本中缺少一堆文件。在 repo 中查看，这些在提交“master 上的未跟踪文件”中。在玩了一些分支和合并之后，我把它们放回了主分支，现在一切似乎都很好。

关于他在创建这个场景的过程中发生了什么的任何想法？这些文件不在 .gitignore 中——您在下面看到的 .gitignore 签入是试图让 silverstripe-cache 文件夹内容被忽略。

我们是这里的新手，非常感谢您的帮助。

![Git 回购历史](../Images/0518ae3a8f04c3c411b79a0fa1f1030f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:11:37.010

“master 上未跟踪的文件”不在任何提交中，即它们仅存在于您的文件系统中，并且您从未告诉 git 跟踪它们。为了解决这个问题，对所有要添加到不完整提交的人执行“git add”，然后执行“git commit --amend”（假设要修改的提交仍然是您当前签出的分支点） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T11:37:45.333

从分支的外观（提交消息左侧的点和线）看来，提交“master 上的未跟踪文件”似乎不是在与其他提交相同的分支上进行的。

您必须进一步回顾历史，以检查“主”分支的历史中是否确实存在分叉。

盲目猜测这是如何发生的：

*   第一次提交是从另一台机器完成的，推送到中央仓库，但你的同事忘记拉（或认为他有，但有一个奇怪的错误消息），
*   `git checkout <branch>`并且`git checkout -b <branch>`具有完全不同的含义，并且可能会使新用户感到困惑-我花了一两个惊喜才发现；）。

# jquery - 当它们移动以填充其他淡出的div留下的空白空间时如何为div设置动画

> ID：10213095
> 
> 赞同：7
> 
> 时间：2012-04-18T15:47:41.210
> 
> 标签：jquery, html, jquery-animate

我有一组 div，每个对应一组类别。当我单击过滤器时，这将更改 div 的类并根据这些类别使它们可见或隐藏。我控制 div 如何淡入/淡出，它们做得很慢而且很好，但是每次 div 消失时，那些保持不变的 div 会突然移动以填充隐藏的那些留下的空白空间。

在其他 div 消失并留下空白空间后，如何平滑未隐藏的 div 的移动？

```
 //Before this goes a long function that decides wich divs will get their class changed
 $('#work-container > div[class*=visible]').fadeIn('slow','swing');
 $('#work-container > div[class*=hidden]').fadeOut('slow','swing'); 
```

编辑： http: [//jsfiddle.net/Ccswn/3/](http://jsfiddle.net/Ccswn/3/) Fiddle of the thing

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T15:58:28.053

我建议使用`animate()`代替`fadeOut()`：

```
$('div').click(
    function() {
        $(this).animate({
            'height': 0,
            'opacity': 0
        }, 750, function() {
            $(this).remove();
        });
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/ZdpBw/)。

* * *

**编辑**以合并 jQuery/CSS 解决方案：

更改 CSS`.item`以包含以下内容：

```
.item{
    /* other css removed for brevity */
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -o-transition: all 1s linear;
    -ms-transition: all 1s linear;
    transition: all 1s linear;
} 
```

并将其更改`a.hidden`为以下内容：

```
.hidden {
    width: 0; /* reset everything that might affect the size/visibility */
    height: 0;
    padding: 0;
    margin: 0;
    opacity: 0;
    -webkit-transition: all 1s linear;
    -moz-transition: all 1s linear;
    -o-transition: all 1s linear;
    -ms-transition: all 1s linear;
    transition: all 1s linear;
} 
```

使用以下 jQuery：

```
// content animate
$('#work-container > div[class*=hidden]').addClass('hidden');
return false; 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Ccswn/7/)。

然后一切似乎都如你所愿。尽管我没有尝试遵循`.addClass('visible')`上面块中的内容，但我没有理会它。

不过，这确实需要一个支持 CSS 转换（并且支持`opacity`）的浏览器，因此它在您的用例中可能并不完美。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:55:37.687

你可以使用`show`和`hide`方法：http:
[//jsfiddle.net/Ccswn/5/](http://jsfiddle.net/Ccswn/5/)

# asp.net-mvc - 如何在 MVC ef 中使用 where 子句

> ID：10213097
> 
> 赞同：11
> 
> 时间：2012-04-18T15:47:47.700
> 
> 标签：asp.net-mvc, entity-framework

使用 MVC EF，我将如何按 id 以外的字段过滤结果？

```
return View(db.Drafts.Where(PublicationId=id)); 
```

PublicationId 是 Drafts 表中的一列。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-18T15:49:32.317

```
public ActionResult Index(int id)
{
    var drafts = db.Drafts.Where(d => d.PublicationId == id).ToList();
    return View(drafts);
} 
```

或者如果你想要一个草稿（因为 id 通常是唯一的）：

```
public ActionResult Index(int id)
{
    var draft = db.Drafts.SingleOrDefault(d => d.PublicationId == id);
    return View(draft);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T15:55:44.170

我不确定您的`Draft`课程是什么样的，但让我们假设它看起来像这样：

```
public class Draft
{
    public int Id { get; set; }
    public int PublicationId { get; set; }
    public string Name { get; set; }
} 
```

你可以写一个这样的查询：

```
return View(db.Drafts.Where(d => d.Name == "foo")); 
```

这只会返回名称为“foo”的草稿。这本身可能没有用。您很可能希望通过将数据传递到控制器（查询字符串、表单值、路由值等）来控制它：

```
public ActionResult Index(int id, string filter)
{
    return View(db.Drafts.Where(d => d.Name == filter));
} 
```

或者您可以过滤多个属性：

```
public ActionResult Index(int id, string filter)
{
    return View(db.Drafts.Where(d => d.Name == filter && d.PublicationId == id));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T15:52:08.360

你熟悉 lambdas 吗？在 where 子句的 lambda 中，您可以指定任何您想要的属性。

```
return View(db.Drafts.Where(d => d.SomeProperty == value)); 
```

我还会考虑将您传递到页面的数据放入模型中，而不是使模型成为实际的 POCO 模型。MVC 模型驱动显示，POCO 模型驱动数据。

# java - JScrollPane 自动换行

> ID：10213100
> 
> 赞同：4
> 
> 时间：2012-04-18T15:47:54.790
> 
> 标签：java, swing, jscrollpane

我有个问题。在 JScrollPane 中，我使用 JPanel 的继承者作为 viewPort。继承者可以包含标签、单选按钮、复选框和其他元素（取决于实现）。在 JScrollPane 中设置 HORIZONTAL_SCROLLBAR_​​NEVER。JPanel 的继承者中的内容需要在纵横滚动中换行。在标签中显示长文本时（特别是 html 标签）没有自动换行，尽管 HORIZONTAL_SCROLLBAR_​​NEVER。如果不使用 JScrollPane（JPanel 的继承者有具体大小）的话要被包裹，但我需要垂直滚动。

尝试设置侦听器以调整 JScrollPane 的大小并为内部 JPanel 设置必要的大小。不工作。设置侦听器以调整内部 JPanel 的大小。设置宽度后发生另一个变化（显然非常重要）。

我怎么解决这个问题？需要在垂直和水平自动换行中滚动。提前致谢。对不起我的英语不好）。

## 示例（不好，之后更好）

```
import java.awt.BorderLayout;
import java.awt.EventQueue;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.ScrollPaneConstants;
import javax.swing.border.EmptyBorder;

public class Test extends JFrame
{

    private JPanel contentPane;

    /**
     * Launch the application.
     */
    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                try
                {
                    Test frame = new Test();

                    JScrollPane scrollPane =  new JScrollPane();
                    scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
                    JPanel panel = new JPanel();
                    panel.add(new JLabel("<html>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</html>"));
                    scrollPane.setViewportView(panel);
                    frame.add(scrollPane);
                    frame.setVisible(true);
                }
                catch (Exception e)
                {
                    e.printStackTrace();
                }
            }
        });
    }

    /**
     * Create the frame.
     */
    public Test()
    {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setBounds(100, 100, 450, 300);
        contentPane = new JPanel();
        contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
        contentPane.setLayout(new BorderLayout(0, 0));
        setContentPane(contentPane);
    }

} 
```

* * *

## 好的例子

屏幕链接：[http ://s44.radikal.ru/i104/1204/4d/72ea56d685ee.png](http://s44.radikal.ru/i104/1204/4d/72ea56d685ee.png)

```
import java.awt.EventQueue;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.ScrollPaneConstants;
import javax.swing.border.EmptyBorder;
import javax.swing.JScrollPane;

public class Test extends JFrame
{

private JPanel contentPane;

/**
 * Launch the application.
 */
public static void main(String[] args)
{
    EventQueue.invokeLater(new Runnable()
    {
        public void run()
        {
            try
            {
                Test frame = new Test();
                frame.setVisible(true);

            }
            catch (Exception e)
            {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the frame.
 */
public Test()
{
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 450, 300);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    setContentPane(contentPane);
    GridBagLayout gbl_contentPane = new GridBagLayout();
    gbl_contentPane.columnWidths = new int[] { 0, 0 };
    gbl_contentPane.rowHeights = new int[] { 0, 0 };
    gbl_contentPane.columnWeights = new double[] { 1.0, Double.MIN_VALUE };
    gbl_contentPane.rowWeights = new double[] { 1.0, Double.MIN_VALUE };
    contentPane.setLayout(gbl_contentPane);

    JScrollPane scrollPane = new JScrollPane();
    GridBagConstraints gbc_scrollPane = new GridBagConstraints();
    gbc_scrollPane.fill = GridBagConstraints.BOTH;
    gbc_scrollPane.gridx = 0;
    gbc_scrollPane.gridy = 0;
    contentPane.add(scrollPane, gbc_scrollPane);

    JPanel panel = new JPanel();
    scrollPane.setViewportView(panel);
    scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);        
    GridBagLayout gbl_panel = new GridBagLayout();
    gbl_panel.columnWidths = new int[]{0, 0};
    gbl_panel.rowHeights = new int[]{0, 0};
    gbl_panel.columnWeights = new double[]{0.0, Double.MIN_VALUE};
    gbl_panel.rowWeights = new double[]{0.0, Double.MIN_VALUE};
    panel.setLayout(gbl_panel);

    JLabel lblNewLabel = new JLabel("<html>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</html>");
    GridBagConstraints gbc_lblNewLabel = new GridBagConstraints();
    gbc_lblNewLabel.gridx = 0;
    gbc_lblNewLabel.gridy = 0;
    panel.add(lblNewLabel, gbc_lblNewLabel);
}

 } 
```

## JLabel 中带有 `tag html` 的自动换行示例：

屏幕链接：[http ://s019.radikal.ru/i628/1204/75/d14b8fa81f15.png](http://s019.radikal.ru/i628/1204/75/d14b8fa81f15.png)

```
import java.awt.EventQueue;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;

public class Test extends JFrame
{

private JPanel contentPane;

/**
 * Launch the application.
 */
public static void main(String[] args)
{
    EventQueue.invokeLater(new Runnable()
    {
        public void run()
        {
            try
            {
                Test frame = new Test();
                frame.setVisible(true);

            }
            catch (Exception e)
            {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the frame.
 */
public Test()
{
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 450, 300);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    setContentPane(contentPane);
    GridBagLayout gbl_contentPane = new GridBagLayout();
    gbl_contentPane.columnWidths = new int[] { 0, 0 };
    gbl_contentPane.rowHeights = new int[] { 0, 0 };
    gbl_contentPane.columnWeights = new double[] { 0.0, Double.MIN_VALUE };
    gbl_contentPane.rowWeights = new double[] { 0.0, Double.MIN_VALUE };
    contentPane.setLayout(gbl_contentPane);

    JLabel lblNewLabel = new JLabel(
            "<html>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</html>");
    GridBagConstraints gbc_lblNewLabel = new GridBagConstraints();
    gbc_lblNewLabel.weightx = 1.0;
    gbc_lblNewLabel.fill = GridBagConstraints.BOTH;
    gbc_lblNewLabel.gridx = 0;
    gbc_lblNewLabel.gridy = 0;
    contentPane.add(lblNewLabel, gbc_lblNewLabel);
}

  } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T17:11:50.563

![带有滚动条的文本区域](../Images/5ed77b43c425421d04d5327cfa13d208.png)

```
import java.awt.*;
import javax.swing.*;
import javax.swing.border.EmptyBorder;

public class Test extends JFrame {

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    Test frame = new Test();

                    JTextArea message = new JTextArea("Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."
                        ,6,40);
                    // make it look & act like a label
                    message.setWrapStyleWord(true);
                    message.setLineWrap(true);
                    message.setEditable(false);
                    message.setFocusable(false);
                    message.setOpaque(false);

                    JScrollPane scrollPane =  new JScrollPane(message,
                        ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED,
                        ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER
                        );
                    frame.add(scrollPane);
                    frame.pack();
                    frame.setVisible(true);
                }
                catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public Test() {
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLocationByPlatform(true);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T06:07:33.563

我认为你需要实现接口 Scrollable。实际上 JTextArea 也实现了 Scrollable。

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Rectangle;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.ScrollPaneConstants;
import javax.swing.Scrollable;
import javax.swing.border.EmptyBorder;

public class TestScrollLabel extends JFrame
{

private JPanel contentPane;

/**
 * Launch the application.
 */
public static void main(String[] args)
{
    EventQueue.invokeLater(new Runnable()
    {
        public void run()
        {
            try
            {
                TestScrollLabel frame = new TestScrollLabel();
                JScrollPane scrollPane =  new JScrollPane();
                scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
                JPanel panel = new MyPanel();
                //BorderLayout is a good choice here
                panel.setLayout(new BorderLayout());
                panel.add(new JLabel("<html>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</html>"));
                scrollPane.setViewportView(panel);
                frame.add(scrollPane);
                frame.setVisible(true);
            }
            catch (Exception e)
            {
                e.printStackTrace();
            }
        }
    });
}

static class MyPanel extends JPanel implements Scrollable{

    @Override
    public Dimension getPreferredScrollableViewportSize() {

        return this.getPreferredSize();
    }

    @Override
    public int getScrollableUnitIncrement(Rectangle visibleRect,
            int orientation, int direction) {
        return 50;
    }

    @Override
    public int getScrollableBlockIncrement(Rectangle visibleRect,
            int orientation, int direction) {
        return 80;
    }

    /*
     * (non-Javadoc)
     * @see javax.swing.Scrollable#getScrollableTracksViewportWidth()
     */
    @Override
    public boolean getScrollableTracksViewportWidth() {
        return true;
    }

    @Override
    public boolean getScrollableTracksViewportHeight() {
        return false;
    }

}

/**
 * Create the frame.
 */
public TestScrollLabel()
{
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    setBounds(100, 100, 450, 300);
    contentPane = new JPanel();
    contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));
    contentPane.setLayout(new BorderLayout(0, 0));
    setContentPane(contentPane);
}

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T17:08:54.820

`JLabel`没有自动换行功能。您可以通过创建一个来模拟这种效果，`JTextArea`使用它使其只读`setEditable(false)`，然后调用`setWrapStyleWord(true)`以启用自动换行。

我认为你也可以`setBorder()`尝试让它看起来更扁平，更像是一个普通的标签，但这可能会根据外观和感觉在不同的平台上产生不同的效果。

# asp.net - 使菜单项在母版页上不可见

> ID：10213101
> 
> 赞同：0
> 
> 时间：2012-04-18T15:47:57.247
> 
> 标签：asp.net, menu, master-pages, sitemap

我有一个使用我的母版页中的站点地图的菜单。我想根据用户禁用某些菜单项。在任何情况下，我都不想进入 MS“角色”的兔子洞。

我有以下 Site.Master：

```
 <div class="clear hideSkiplink">
            <asp:Menu ID="MainMenu" runat="server" DataSourceID="SiteMapDataSource1" 
              Orientation="Horizontal"
              CssClass="menu"
              StaticDisplayLevels="1"
              StaticMenuItemStyle-VerticalPadding="2"
              StaticMenuItemStyle-HorizontalPadding="10"
              StaticMenuItemStyle-Font-Name="Verdana"
              StaticMenuItemStyle-Font-Size="12pt"
              StaticHoverStyle-BackColor="#707070"
              StaticHoverStyle-ForeColor="#550000"

              DynamicMenuStyle-HorizontalPadding="2"
              DynamicMenuStyle-VerticalPadding="2"
              DynamicMenuStyle-BackColor="#E0E0E0"
              DynamicMenuStyle-ForeColor="#FFFFFF"
              DynamicMenuStyle-BorderWidth="1"
              DynamicMenuStyle-BorderColor="#C0C0C0"
              DynamicMenuItemStyle-VerticalPadding="2"
              DynamicMenuItemStyle-Font-Name="Verdana"
              DynamicMenuItemStyle-Font-Size="9pt"
              DynamicMenuItemStyle-ForeColor="#FFFFFF"
              DynamicHoverStyle-BackColor="#707070"
              DynamicHoverStyle-ForeColor="#550000" />               

            <asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server"  ShowStartingNode="False" /> 
```

我有类似于以下内容的 web.sitemap：

```
<siteMapNode >
    <siteMapNode url="default.aspx" title="Home"  description="" />

    <siteMapNode url="default.aspx?p=0" title="Admin" description="">
        <siteMapNode url="default.aspx?p=55" title="thing1"  description="" />
        <siteMapNode url="default.aspx?p=56" title="thing2"  description="" />
    </siteMapNode>

    <siteMapNode url="default.aspx?p=1" title="Thing3"   description="">
    </siteMapNode>
    <siteMapNode url="default.aspx?p=2" title="Thing4"  description="">
    </siteMapNode>
</siteMapNode> 
```

在 Site.Master.cs 中，我尝试在 Page_Load 和 MainMenu_MenuItemDataBound 下添加以下代码：

```
Response.Write(MainMenu.Items.Count.ToString()); 
```

当我把它放在 MainMenu_MenuItemDataBound 下时，它没有效果。当我将它放在 Page_Load() 下时，它打印为零，即使我可以看到正确显示的菜单并且它确实有项目！

事实：菜单存在。菜单有项目。菜单和项目显示正确。

我想进入，例如，使标题为“Admin”的项目不可见（连同它的子菜单项目） - 我想删除它，但要么让它不可见，要么禁用它。我已经尝试过涉及 MainMenu.FindItem 的各种咒语......该方法似乎与查找项目没有任何关系。这是当我注意到它没有找到任何项目的原因是因为项目计数为零（即使我可以看到这些项目）。

根据下面的 Dave D 解决方案，但还需要添加

```
OnMenuItemDataBound="MainMenu_MenuItemDataBound" 
```

到 MainMenu 标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:39:59.080

菜单不会绑定到 page_load 中的数据。这就是为什么它没有计数。

在绑定时检查 MenuItemDataBound 中的项目可以这样完成：

```
protected void MainMenu_MenuItemDataBound(Object sender, MenuEventArgs e)
{

    if (e.Item.Text == "Admin")
    {
        // disable the item
        //e.Item.Enabled = false;

        // remove the menu item
        MainMenu.Items.Remove(e.Item);

    }
} 
```

# excel - 如何创建自定义生成的各种长度的报告？

> ID：10213103
> 
> 赞同：0
> 
> 时间：2012-04-18T15:48:04.470
> 
> 标签：excel, vba

我正在尝试在 Excel 中为我从其他工作簿中提取的数据创建一个标准化表单。

我想根据单独的表（数据表）中提供的数据自动生成表单（报告表）。我认为这会比编写脚本从多个工作簿中提取个人信息更简单。

我的问题是记录（行）的数量是不同的。我不能简单地将数据表中的单元格映射到报告表，因为对于某些报告将有 20 行，有些将是 8 行，等等。

完成此任务的最简单方法是什么？我被困在如何创建一个宏来检查数据表上有多少行并在报告表上创建相应的数字，只选择我想要的预先确定的字段。

我意识到这可以在 Access 中更容易地完成，但我没有 Access。

感谢您的输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:44:11.230

首先，你有一个正确的想法，有一个数据表和一个单独的报告表，它以合适的格式显示所需的数据。

*“我不能简单地将数据表中的单元格映射到报告表，因为对于某些报告将有 20 行，有些将是 8 行，等等。”*

我不确定你的意思是什么，你是说数据表上的行可以扩大和缩小吗？或者您是说您希望最终用户能够在报告中选择他们想要的行？换句话说，是什么决定了您希望报告中的哪些行？

除此之外，首先您只想使用单元格值，这样在将它们复制到报告表时，报告表上的所有格式都会被保留。

至于传输数据，有多种方法可以使用 vba 来完成，具体取决于您对我上面问题的回答。

*   根据条件提前过滤行（使用复制到另一个位置）
*   复制用户选择的所有行（应该不需要使用循环，For Each Row 等）
*   根据用户输入所需行的用户输入框复制行。

我建议复制所有列，然后隐藏不需要的列：

```
Worksheets("Report").Range("B:B,D:E").EntireColumn.Hidden = True 
```

# knockout.js - 使用 KnockoutJS 映射插件执行部分更新

> ID：10213104
> 
> 赞同：6
> 
> 时间：2012-04-18T15:48:06.047
> 
> 标签：knockout.js, knockout-mapping-plugin

现在，我将这个 JSON 与 KO Mapping 插件一起使用，它工作正常：

```
{
  "Controls": [
    {
      "Fields": [
        {
          "Name": "emailField", 
          "Text": "email", 
          "Visible": true
        }, 
        {
          "Name": "hiddenField", 
          "Text": "text", 
          "Visible": true
        }
      ], 
      "Name": "form2", 
      "Type": "Form"
    }, 
    {
      "Data": [
        [
          "Federico Aloi", 
          20
        ], 
        [
          "Andres Lopez", 
          31
        ], 
        [
          "Pablo Perez", 
          32
        ]
      ], 
      "Fields": [
        {
          "Name": "nameField", 
          "Text": "Nombre", 
          "Visible": true
        }, 
        {
          "Name": "ageField", 
          "Text": "Edad", 
          "Visible": true
        }
      ], 
      "Name": "datagrid1", 
      "Type": "Datagrid"
    }
  ], 
  "Name": "pagina1", 
  "Title": "Probando el KO"
} 
```

现在我的要求是执行“部分更新”。我想这样做的一些场景：

*   我需要更改第二个控件中的 Data 数组。
*   我只需要更新一个控件而不是整个页面（这是我正在序列化的类，这个 JSON 中的根）。
*   我需要向我的页面添加另一个控件。

也许另一种解决方法是用 重新创建原始对象`ko.mapping.toJS(viewModel)`，对其进行更改然后重新映射它......但我相信你会得到更好的东西。

* * *

**编辑：**我试过`ko.mapping.fromJS(updatedControl, viewModel.Controls()[0])`但没有用，这是我的代码：

```
function (control) {
    $.getJSON($.format('api/control/{0}/{1}', viewModel.Name(), control.Name()), function (response) {
        ko.mapping.fromJS(response, viewModel.Controls()[0]);
    });
}, 
```

*回复：*

```
{
  "Fields": [
    {
      "Name": "emailField", 
      "Text": "email", 
      "Visible": true
    }, 
    {
      "Name": "hiddenField", 
      "Text": "text", 
      "Visible": true
    }
  ], 
  "Name": "form2", 
  "Type": "Form"
} 
```

**EDIT2:** check it out at [http://jsfiddle.net/faloi/4FcAy/10/](http://jsfiddle.net/faloi/4FcAy/10/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T22:16:27.547

I think this is now the single most asked question re the mapping plugin. The plugin can only currently do partial updates of properties. E.g if you were to remap the below data to your object

```
{ "Name": "pagina1 foo", "Title": "Probando el KO bar" } 
```

It would update just those properties. However the collections are treated differently so if you were to remap with the below.

```
{ "Name": "pagina1 foo", "Title": "Probando el KO bar", 
  Controls: [ { // snip some updated object } ] } 
```

It would remove the non-matching item in your Controls collection instead of updating the matching item. The only way to get this to work is to loop through the collection and map each individual item you wish to update. Your code is almost on the right track I believe it should be

```
ko.mapping.fromJS(updatedControl, viewModel.Controls()[0]) 
```

**EDIT**

You were missing the middle mapping argument on the fromJS call.

[http://jsfiddle.net/3CtFq/](http://jsfiddle.net/3CtFq/)

The mapping object is usually optional but I guess if you are mapping a sub object as is your case, the plugin can't tell that this sub items parent was originally mapped with no options.

Hope this helps.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T01:32:00.080

I thought that was the whole point of having the 'key' option. I realize there are caveats to this kind of feature, but I'm surprised there's no support for it at all.

Anyway - this is (regrettably) what I've ended up having to do to partially update a list of orders - which is to loop through and replace items.

`data` is my main AJAX/JSON model from the server and contains `data.orders` which is `ko.observableArray([])` of `OrderViewModel` items. It also contains all kinds of other stuff `data.products`, `data.foo` that I want to initially map.

I have a mapping rule to create new `OrderViewModel` objects automatically during the mapping process.

```
 var mapping =
            {
                'orders':
                {
                    key: function (item)
                    {
                        return ko.utils.unwrapObservable(item.orderId);
                    },

                    create: function (options)
                    {
                        return new OrderViewModel(options.data);
                    }
                }
            }; 
```

When I get the data back from the server I initially want to do a complete mapping of my model. So I set `initialUpdate=true`.

When I want to refresh a single order I have `initialUpdate=false`.

```
 if (initialUpdate) 
     {
         // standard initial mapping 
         ko.mapping.fromJS(data, mapping, this);
     }
     else
     {
         // merge orders
         var newModel = ko.mapping.fromJS(data, mapping);

         // go through all orders in the updated list
         for (var i = 0; i < newModel.orders().length; i++)
         {
             var newOrder = newModel.orders()[i];

             // find order with same key in existing ko model
             var match = ko.utils.arrayFirst(this.orders(), function (item)
             {
                 return newOrder.orderId() === item.orderId();
             });

             if (match == null)
             {
                 // TODO: insert new order                            
             }

             // replace original order in list
             this.orders.replace(match, newOrder);
         }
     } 
```

# asp.net - 循环遍历 asp:CheckBox 控件

> ID：10213108
> 
> 赞同：0
> 
> 时间：2012-04-18T15:48:17.997
> 
> 标签：asp.net

我的页面上有 11 个这样的控件，都是复选框。它包含在母版页中。

我可以像这样完成我想要的：

```
generalInformation.InputAttributes.Add( "class", "SetupChecklist" );
generalInformation2.InputAttributes.Add( "class", "SetupChecklist" );
generalInformation3.InputAttributes.Add( "class", "SetupChecklist" ); 
```

ETC..

我现在正试图遍历这些并做同样的事情来为自己节省一些代码，但是我在让它正常工作时遇到了很多麻烦，我根本无法让它工作。

谁能给我一个循环遍历这 11 个复选框控件并添加 css 类 SetupChecklist 的好方法？

我试过了，但由于某种原因它没有添加类。

```
protected void InitializeCheckboxes ()
    {
        //generalInformation.InputAttributes.Add( "class", "SetupChecklist" );
        var allCheckBoxes = Page.Controls.OfType<CheckBox>();
        foreach ( var c in allCheckBoxes )
        {
            c.InputAttributes.Add( "class", "SetupChecklist" );
        } 
    } 
```

我去调用`InitializeCheckboxes();`Page_Load 方法。当我只使用 generalInformation.InputAttribues.Add 等时它确实有效。但当我遍历它们时却不行。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T15:51:44.627

最好的办法是将它们放在`Panel`（呈现为 div）或其他容器控件中。然后您可以使用 LINQ 获取参考[`OfType`](http://msdn.microsoft.com/en-us/library/bb360913.aspx)：

```
// assuming all checkboxes are in a panel named "SetupContainer"
var allCheckBoxes = SetupContainer.Controls.OfType<CheckBox>();
foreach(var chb in allCheckBoxes)
    chb.InputAttributes.Add( "class", "SetupChecklist" ); 
```

当然你也可以用它来查找整个页面上的所有 CheckBox，但这可能容易出错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:51:37.060

未经测试，但可以帮助你..

```
foreach(Control oControl in Page.Controls)
{
  if(oControl is CheckBox && ((CheckBox)oControl).ID.StartsWith("generalInformation") )
   ((CheckBox)oControl).InputAttributes.Add( "class", "SetupChecklist" );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T15:58:07.960

由于`runat = "server"`.

```
<span class="SetupChecklist" class="SetupChecklist" name="generalInformation">
     <input id="generalInformation" type="checkbox" name="generalInformation" />
</span> 
```

* * *

## jQuery

```
<script type="text/javascript" language="javascript" src="Scripts/jquery-1.4.1.min.js"></script>
<script type="text/javascript" language="javascript" src="Scripts/jquery-1.4.1.js"></script>
<script language="javascript" type="text/javascript">
    $(document).ready(function () {
        $(this).find("input[type='checkbox']").addClass('GuestClass');
    });
</script> 
```

这将节省您执行以下步骤的时间。

> 1.  从客户到
> 2.  IIS 网络服务器
> 3.  ISAPI 扩展
> 4.  ISAPI 扩展加载/执行/将 aspx 转换为 HTML
> 5.  发送回 IIS Web 服务器。
> 6.  IIS 响应客户端

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T15:51:18.310

```
public void GetUserControls(ControlCollection controls)
{
    foreach (Control ctl in controls)
    {
        if (ctl is CheckBoxOrWhateverControlTypeYouWant)
        {
             /// Add attribute
        }

        if (ctl.Controls.Count > 0)
            GetUserControls(ctl.Controls);
    }
} 
```

# c# - 如何在 C# 中实现泛型多态性 - 第 2 部分？

> ID：10213115
> 
> 赞同：-1
> 
> 时间：2012-04-18T15:48:45.920
> 
> 标签：c#, generics, inheritance, casting, covariance

我已经[用一个坏样本发布了这个问题](https://stackoverflow.com/q/10211072/1341449)。

这段代码应该更好。

为了避免混淆，我总结了一些代码：

```
using System.Collections.Generic;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main()
        {
            IManager<ISpecificEntity> specificManager = new SpecificEntityManager();
            IManager<IAntoherSpecificEntity> anotherSpecificManager = new AnotherSpecificEntityManager();
            Dictionary<string, IManager<IIdentifier>> managers = new Dictionary<string, IManager<IIdentifier>>();
            managers.Add("SpecificManager", (IManager<IIdentifier>)specificManager);
            managers.Add("AnotherSpecificManager", (IManager<IIdentifier>)anotherSpecificManager);

            foreach (var manager in managers.Values)
            {
                IIdentifier entity = manager.Container.GetEntity();
            }
        }
    }

    internal interface IIdentifier
    {
        int Id { get; set; }
    }

    internal interface ISpecificEntity : IIdentifier
    {
        string SpecificValue { get; set; }
    }

    internal class SpecificEntity : ISpecificEntity
    {
        public int Id { get; set; }
        public string SpecificValue { get; set; }
    }

    internal interface IAntoherSpecificEntity : IIdentifier
    {
        string AnotherSpecificValue { get; set; }
    }

    internal class AntoherSpecificEntity : IAntoherSpecificEntity
    {
        public int Id { get; set; }
        public string AnotherSpecificValue { get; set; }
    }

    internal interface IContainer<out TIdentifier> where TIdentifier : IIdentifier
    {
        TIdentifier GetEntity();
    }

    internal interface ISpecificContainer : IContainer<ISpecificEntity>
    {
    }

    internal class SpecificContainer : ISpecificContainer
    {
        public ISpecificEntity GetEntity()
        {
            return new SpecificEntity { SpecificValue = "SpecificValue" };
        }
    }

    internal interface IAnotherSpecificContainer : IContainer<IAntoherSpecificEntity>
    {
    }

    internal class AnotherSpecificContainer : IAnotherSpecificContainer
    {
        public IAntoherSpecificEntity GetEntity()
        {
            return new AntoherSpecificEntity { AnotherSpecificValue = "AnotherSpecificValue" };
        }
    }

    internal interface IManager<TIdentifier> where TIdentifier : IIdentifier
    {
        IContainer<TIdentifier> Container { get; set; }
    }

    internal class SpecificEntityManager : IManager<ISpecificEntity>
    {
        public IContainer<ISpecificEntity> Container { get; set; }
    }

    internal class AnotherSpecificEntityManager : IManager<IAntoherSpecificEntity>
    {
        public IContainer<IAntoherSpecificEntity> Container { get; set; }
    }
} 
```

当我调试代码时，我`Main()`在第 12 行得到一个 InvalidCastException。

我知道`ISpecificEntity`实现`IIdentifier`. 但显然从 an 直接`IManager<ISpecificEntity>`转换为 an`IManager<IIdentifier>`是行不通的。

我认为使用协方差可以解决问题，但更改`IManager<TIdentifier>`为`IManager<in TIdentifier>`或`IManager<out TIdentifier>`也不起作用。

那么，有没有办法强制`specificManager`转换成`IManager<IIdentifier>`?

谢谢，一切顺利。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:08:02.327

首先，您对泛型的理解是错误的。

如果你看一下 Foo 它是一个泛型类型。Foo 和 Foo 是新类型，它们不是从 List 派生的，也不是通过继承连接的类型。*使用泛型创建新类型，它不会派生！*

但是，您正在寻找的是[Covariance 和 Contravariance](http://msdn.microsoft.com/en-us/library/ee207183.aspx)。这将允许您创建一种“通用多态性”，但为此您需要在通用**定义**中指定它。因此，它只适用于极少数开箱即用的框架泛型。

```
class Program
{
    static void Main(string[] args)
    {
        IManager<IIdentifier> f1 = new C1();
        IManager<IIdentifier> f2 = new SpecificEntityManager(); //IManager<ISpecificEntity>
    }
}

interface IIdentifier { }
interface ISpecificEntity : IIdentifier { }
interface IManager<out T> { }

class C1 : IManager<IIdentifier> { }
class SpecificEntityManager : IManager<ISpecificEntity> { } 
```

这是您必须更改的内容：

```
internal interface IContainer<out TIdentifier> where TIdentifier : IIdentifier 
{ 
    TIdentifier GetEntity(); 
}
internal interface IManager<out TIdentifier> where TIdentifier : IIdentifier 
{
    IContainer<IIdentifier> Container { get; }
}
internal class SpecificEntityManager : IManager<ISpecificEntity>
{
    public IContainer<IIdentifier> Container { get; set; }
}
internal class AnotherSpecificEntityManager : IManager<IAntoherSpecificEntity>
{
    public IContainer<IIdentifier> Container { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:56:13.747

您不需要 IManager<TIdentifier> 可以继承的非泛型 IManager。那么 IManager<IIdentifer> 是一个 IManager 并且可以强制转换？

# r - 从以另一个变量为条件的矩阵中提取行

> ID：10213116
> 
> 赞同：1
> 
> 时间：2012-04-18T15:48:47.263
> 
> 标签：r, matrix

如何提取`m`where `a`is even 的行？例如，

```
m = matrix(1:24, 6)
a = c(3, 4, 1, 1, 2, 5) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T15:56:21.440

你的问题有点模棱两可，但我想我知道你的意思。对于您的数据：

```
m = matrix(1:24, 6)
a = c(3, 4, 1, 1, 2, 5) 
```

您可能意味着要选择`m`where `a`is even 中的所有行。因此，在这种情况下，您需要 的*第二*行和*第五*行`m`，因为只有 的第二和第五个元素`a`是偶数。在这种情况下，这将起作用：

```
 m[a %% 2 ==0,] 
```

但是，我认为您的意思是要找到其中`a`的偶数（在本例中为 2 和 4），然后选择`m`. 在这种情况下，您将使用：

```
m[a[a %% 2 ==0],] 
```

所以这将首先选择*第四个*，然后是*第二*行 m。但是请记住，如果您有两次偶数，它将选择该行两次。

如果您想按顺序选择行（第 2 行，然后是第 4 行），您可以：

```
m[sort(a[a %% 2 ==0]),] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:59:22.210

尝试这个

```
m[which(a %% 2 != 0), ] 
```

# git - 开始在 Git 中跟踪文件而不添加到索引

> ID：10213117
> 
> 赞同：13
> 
> 时间：2012-04-18T15:48:55.843
> 
> 标签：git

是否可以在 git 中开始跟踪文件而不将它们添加到索引中？

我有新文件，我想在 . 中生存`git clean`，但可能会在下一次提交之前更改。我现在只是将它们添加到索引中，然后在提交之前再次添加它们吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2017-06-08T13:37:53.760

似乎您正在寻找`git add --intent-to-add`（或`git add -N`）。从[官方`git add`文档](https://git-scm.com/docs/git-add#git-add--N)：

> ```
> -N
> --intent-to-add 
> ```
> 
> 仅记录稍后将添加路径的事实。路径的条目被放置在没有内容的索引中。除其他外，这对于显示此类文件的未暂存内容`git diff`并使用`git commit -a`.

请参阅[git add --intent-to-add 或 -N 做什么以及何时使用？](https://stackoverflow.com/questions/24329051/what-does-git-add-intent-to-add-or-n-do-and-when-should-it-be-used)问题以获取更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T15:52:42.540

您可以使用 暂存文件`git add`，然后`git reset`在提交之前使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-27T20:44:32.427

（**ita**`add -N`，“intent to add”，为了“开始在 Git 中跟踪文件而不添加到索引”）的问题是：

 **> 由于意图添加条目的实现细节，
> 
> *   当前的“ `git diff`”（即没有树形或`--cached`参数）将显示 ita 文件中的更改，但它不会将该文件标记为新文件，
> *   而“ `diff --cached`”会将文件标记为新文件，同时将其内容显示为空。

Git 2.19（2018 年第三季度）改变了这一点；因为“ `git diff`”比较索引和工作树。
对于使用意图添加位添加的路径，该命令将其全部内容显示为已添加，但路径本身并未标记为新文件。
它们现在默认显示为新的。

请参阅[Nguyễn Thái Ngọc Duy (](https://github.com/pclouds) [)的](https://github.com/pclouds)[提交 cff5dc0](https://github.com/git/git/commit/cff5dc09ed0d07461bf77e9abef57dc86a11ab77)、[提交 8fc8f05](https://github.com/git/git/commit/8fc8f05cef9b5a60cc7adbd5cd6ed130a89ca4e1)、[提交 0231ae7](https://github.com/git/git/commit/0231ae71d3d6706183777fbfd91667d620776e87)、[提交 ba4e356](https://github.com/git/git/commit/ba4e356109e5bf2b86bde335128c0ab4161268a9)（2018 年 5 月 26 日） 。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 ac997db](https://github.com/git/git/commit/ac997db0c13d3acde8fcb6c79ff095ba6bd27169))^(中，2018 年 6 月 25 日）)[`pclouds`](https://github.com/pclouds)
^([`gitster`](https://github.com/gitster))

在 Git 2.19 之前：

> ```
> $ git diff                      | $ diff --cached
> --------------------------------|-------------------------------
>  diff --git a/new b/new         | diff --git a/new b/new
>  index e69de29..5ad28e2 100644  | new file mode 100644
>  --- a/new                      | index 0000000..e69de29
>  +++ b/new                      |
>  @@ -0,0 +1 @@                  |
>  +haha                          | 
> ```
> 
> 当前输出错误的一个证据是，`git diff`无法应用“”（带有 ita 条目）的输出，因为它假定在应用之前存在空文件。
> 
> 打开`--ita-invisible-in-index`（[commit 425a28e](https://github.com/git/git/commit/425a28e0a4edfc39585cec6b0b6368c0ad9dbf7e)，[commit b42b451](https://github.com/git/git/commit/b42b45191950a4ac39f6f5ae042c15ad114da79b) Oct. 2016, Git 2.11.0）可以解决这个问题。结果是“新文件”行从“ `git diff --cached`”移动到“ `git diff`”。
> 
> ```
> $ git diff                      | $ diff --cached
> --------------------------------|-------------------------------
>  diff --git a/new b/new         |
>  new file mode 100644           |
>  index 0000000..5ad28e2         |
>  --- /dev/null                  |
>  +++ b/new                      |
>  @@ -0,0 +1 @@                  |
>  +haha                          | 
> ```
> 
> 此选项在默认情况下处于启用状态，`git-status`但我们需要在重命名检测代码中进行更多修复（[提交 bc3dca0，2018 年 1 月，Git 2.17.0](https://github.com/git/git/commit/bc3dca07f435ed2ca5a974cdb0508f66cf442412)）。幸运的是，我们不需要为`diff.c`（`wt-status.c`使用自定义的）中的重命名检测代码做任何其他事情。

* * *

在 Git 2.28（2020 年第三季度）中，“ `git diff-files`”被教导说标记为意图添加的路径是新文件，而不是从空 blob 修改。

请参阅[Srinidhi Kaushik ( ) 的](https://github.com/clickyotomy)[commit feea694](https://github.com/git/git/commit/feea6946a5b746ff4ebf8ccdf959e303203a6011)（2020 年 6 月 20 日[）](https://github.com/clickyotomy)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 298d704](https://github.com/git/git/commit/298d704e708773f6ddeb4e680265ab904d710def))^(中，2020 年 6 月 29 日）)[`clickyotomy`](https://github.com/clickyotomy)
^([`gitster`](https://github.com/gitster))

> ## [`diff-files`](https://github.com/git/git/commit/feea6946a5b746ff4ebf8ccdf959e303203a6011): 将“ `i-t-a`”文件视为“ `not-in-index`”
> 
> ^(签字人：Srinidhi Kaushik)

> cmd_diff_files `diff-files' command and related commands which call the function` ()' 在将工作树与其进行比较时，将“意图添加”文件视为索引的一部分。
> 这之前在提交[0231ae71d3](https://github.com/git/git/commit/0231ae71d3d6706183777fbfd91667d620776e87)（`diff`：默认打开 --ita-invisible-in-index，2018-05-26）和[425a28e0a4](https://github.com/git/git/commit/425a28e0a4edfc39585cec6b0b6368c0ad9dbf7e)（`diff-lib`：允许将 ita 条目视为“索引中尚不存在”，2016-10- 24) 默认打开选项`--ita-invisible-in-index`（在[b42b451919](https://github.com/git/git/commit/b42b45191950a4ac39f6f5ae042c15ad114da79b) (" `diff`: add --ita-[in]visible-in-index", 2016-10-24, Git v2.11.0-rc0 -- [merge](https://github.com/git/git/commit/650360210afbd585f33ed622d3e700b1941b1ddb) ) 中引入）。
> 
> 对于`diff-files`（并`add -p`因此）将 ita 文件显示为新文件，`ita_invisible_in_index`默认情况下也将在此处启用。

* * *

警告：如果您在 git diff-filter 中使用排除（小写）和包含（大写），请**[使用 Git 2.36 (Q2 2022)](https://stackoverflow.com/a/71190099/6309)**。**

# c# - C# 异常调试 - 如何返回并恢复异常行

> ID：10213119
> 
> 赞同：0
> 
> 时间：2012-04-18T15:49:01.013
> 
> 标签：c#, visual-studio-2010

在过去的 VB6 中，当调试错误时，我会在错误处理程序中临时键入 Resume 以将我带回到导致错误的行。

有没有办法在 C# 中做同样的事情？我不是在谈论一种永久的返回方式，这只是在您进行调试并且您想知道哪一行导致您当前在 catch 语句中的异常时。

所以只是要清楚。

1.  我知道有什么东西导致了异常，所以我在 catch 语句上放了一个断点
2.  调试器在 catch 中遇到断点，我想知道是哪一行导致了它并将调试器带回它。

我不能使用 Debug > Options - 抛出所有异常，因为应用程序中还有其他异常静默发生（我没有写）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T15:55:21.523

需要继续跳出catch语句，然后可以“Set Next Statement”或者将黄色箭头向上拖到try语句的开头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T15:58:23.250

异常中的堆栈跟踪将告诉您它发生在哪一行。然后，您可以将黄色箭头拖回该行并从那里恢复调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T15:52:28.993

最好的想法可能是在 try 块的开头放置一个断点，如果您随后单步执行该块，它会告诉您错误在哪里。

或者，暂时删除 try 和 catch，Visual Studio 将在引发异常的行停止执行，因为不会捕获异常。

# android - Android - 发送类似于事件 MEDIA_NEXT 的意图

> ID：10213121
> 
> 赞同：0
> 
> 时间：2012-04-18T15:49:05.563
> 
> 标签：android, headset

是否可以发送一些意图，例如`KEYCODE_MEDIA_NEXT programically`？PS`KEYCODE_MEDIA_NEXT`是单击某些媒体按钮后出现的事件，但我想以编程方式发送它。

# android - iOS 可以像 Android 一样接收广播吗？

> ID：10213125
> 
> 赞同：5
> 
> 时间：2012-04-18T15:49:18.370
> 
> 标签：android, iphone, ios, service, broadcastreceiver

我希望我的应用程序在经过一段足够长的空闲时间后与设备断开连接时通知我的应用程序`iOS`，该应用程序已被清理（因此可能无法运行），类似于[`BroadcastReceiver`](http://developer.android.com/reference/android/content/BroadcastReceiver.html)在 android 中的工作方式。我怀疑这是不可能的，但会很感激任何想法。

我查看了[本地和推送通知](https://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Introduction/Introduction.html)以及[`NSNotificationCenter`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotificationCenter_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNotificationCenter). 推送通知不合适，因为事件发生在设备上。似乎只能安排（通过指定时间）本地通知，而不是从系统事件中创建它们，并且`NSNotificationCenter`仅在应用程序运行时才收到通知。

我是否误解了上述任何信息，或者还有其他技巧可以使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T22:55:52.843

在当前版本 (iOS 6) 和任何以前的版本中，无法为未运行的应用程序提供后台进程和基于系统事件的广播接收器。没有计划让我遇到这种情况。

如问题中所述，可以使用[`NSNotificationCenter`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotificationCenter_Class/Reference/Reference.html#//apple_ref/occ/cl/NSNotificationCenter)来实现类似的效果，但前提是触发通知的事件在电话外部或可以从预定时间触发通知。

# java - ArrayList Java BlueJ

> ID：10213129
> 
> 赞同：-1
> 
> 时间：2012-04-18T15:49:27.853
> 
> 标签：java, arraylist, bluej

我有 4 个类（汽车（超类）、CarToRent、CarToSell 和 CarCompany）。CarCompany 在构造函数中创建一个 GUI。我需要在 Car 的 CarCompany 类中存储一个数组列表。我该怎么做呢？请帮忙。

此外，目前 CarCompany 中的主要方法是：

```
public static void main(String[] args)
{
  CarCompany = new CarCompany();
} 
```

这个对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T15:52:00.740

不，这是不正确的，你只指定了一个类型，但你没有给它一个名字：

尝试：

```
public static void main(String[] args)
{
  CarCompany myCarCompany= new CarCompany();
} 
```

now`myCarCompany`是一个 Object 类型`CarCompany`。

**编译**

当您在 IDE 内部或从命令行进行编译时，编译器会发现这些错误并告诉您哪里出了问题。能够自己测试和调试代码很重要，因为有时没有人可以提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:52:59.303

首先，应该是 `CarCompany carCompany = new CarCompany();`

其次，如果四个类扩展同一个类，比如说`Car`，你可以这样创建它：

```
List<Car> cars = new ArrayList<Car>();
//and then
cars.add(new Car());
cars.add(new CarToRent());
// etc... 
```

如果它们没有相同的超类，那么您需要将它们放入`List<Object>`或放入四个不同的列表中。

# windows-phone-7.1 - WP7 - RestSharp - 无法以 XML 格式获取返回的数据

> ID：10213137
> 
> 赞同：1
> 
> 时间：2012-04-18T15:49:57.670
> 
> 标签：windows-phone-7.1, restsharp

我在我的 Windows Phone 7.1 项目中使用 RestSharp。

我的问题是我无法以 XML 格式返回响应数据，我的响应始终为 JSON，而我的服务器同时支持 JSON 和 XML。

示例：网址：[http ://timtim.vn:8080/fktw/services/timhot/photo/15732](http://timtim.vn:8080/fktw/services/timhot/photo/15732)

如您所见，服务器可以返回 XML。但在我的项目中，RestSharp 响应是 JSON 格式。我已经设置了 RequestFormat`request.RequestFormat = DataFormat.Xml;`但它不起作用！

使用JsonDeserializer，我仍然可以完美地反序列化响应，但我想知道这个问题的原因。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:49:19.160

原因是 RestSharp 默认有 6 个 ContentTypes（你可以在 RestClient 对象的 ContentTypes 属性中看到它们。第一个 ContentType 是“application/json”。所以对于 RestClient 来说，内容类型是它会请求的第一个，如[http:/ /timtim.vn:8080/fktw/services/timhot/photo/15732](http://timtim.vn:8080/fktw/services/timhot/photo/15732)支持 JSON 则响应内容类型为 JSON。

如果通过编码删除它：`client.RemoveHandler("application/json");`那么响应内容类型将是 XML，这实际上是下一个 ContentType 首选项。

但是我不知道如何明确客户的 ContentType 偏好。

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T07:10:18.437

我在客户端声明后加入了一个快速技巧：

```
client.ClearHandlers();
client.AddHandler("application/xml", new XmlDeserializer());
client.AddHandler("text/xml", new XmlDeserializer()); 
```

# css - Internet Exporer 输入按钮 - 单击时似乎添加了阴影并使文本变灰

> ID：10213140
> 
> 赞同：0
> 
> 时间：2012-04-18T15:50:06.003
> 
> 标签：css, internet-explorer, button, input

我在 Internet Explorer 中遇到了一个奇怪的问题。

我正在设计一个输入按钮。这就是我在我的 CSS 中提出的。

```
.gform_wrapper input.gform_button {
    float: left;
    display: block;
    background: #045d8e;
    padding: 2px 10px 0; 
    text-transform: uppercase;
    text-decoration: none !important;
    color: #ffffff !important;
    outline: none !important;
    border: none !important;
    cursor: pointer;
    margin: 0;
    height: 35px;
    width: auto !important;
    outline: none !important;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    text-shadow: none !important;
}

#ie7 .gform_wrapper input.gform_button {
    width: 90px;
    padding: 1px 0 0;
}

.gform_wrapper input.gform_button:hover {
    background: #024061 !important;
    color: #ffffff;
}

.gform_wrapper input.gform_button:active,
.gform_wrapper input.gform_button:focus {
    border: none !important;
    outline: none !important;
    color: #ffffff !important;
    text-shadow: none !important;
    background: #024061 !important;
} 
```

所有这些样式似乎都在起作用，但是在 IE 中，当您单击按钮时，在加载表单时，它会为文本添加灰色并出现白色阴影。这很奇怪，因为 IE 不支持文本阴影。

任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-26T14:10:35.253

我遇到了类似的问题，但在我的情况下，它是一个跨度元素，在我的脚本运行后显示带有白色阴影的灰色文本。事实证明，在 Internet Explorer 中，如果将 span 或 div 元素的 'disabled' 属性设置为 true，就会发生这种情况。

# java - 从浏览器中打开的 PDF 中读取文本

> ID：10213144
> 
> 赞同：0
> 
> 时间：2012-04-18T15:50:24.657
> 
> 标签：java, pdf, webdriver, itext, selenium-webdriver

有谁知道如何使用任何 Java 框架或 Javascript 或 Selenium2 Webdriver 访问 pdf 文件的内容，pdf 文件显示在浏览器中？

我需要验证在浏览器中打开的 PDF 文件的内容，PDF 文件位于远程 WebServer 中，无法直接访问它。

任何建议表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T21:26:43.247

“在浏览器中打开的 PDF 文件”是指在 Adob​​e Reader 或类似插件中？我担心你无法通过 Selenium 控制那个。这里最好的方法是下载文件（也不是微不足道的，但可以使用 Firefox 或一些[Java 下载器完成）并使用](https://github.com/Ardesco/Ebselen/blob/master/ebselen-core/src/main/java/com/lazerycode/ebselen/customhandlers/FileDownloader.java)[http://pdfbox.apache.org/](http://pdfbox.apache.org/)在磁盘上离线检查文件，正如用户*kundan bora*所建议的那样.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:43:03.460

您可以将 java 库用于 PDF Apache PDF-box-

[http://pdfbox.apache.org/](http://pdfbox.apache.org/)

# api - 使用 Google API - GClientGeocoder()

> ID：10213147
> 
> 赞同：8
> 
> 时间：2012-04-18T15:50:35.733
> 
> 标签：api, google-maps

我尝试关注此页面：

```
http://melandri.net/2009/07/03/get-location-coordinates-using-google-maps/ 
```

但未定义 GClientGeocoder() - 存在错误。

我已经在我的页面上使用了谷歌地图 API：

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=<%=System.Web.Configuration.WebConfigurationManager.AppSettings["myGoogleKey"]%>&sensor=false"></script> 
```

如何解决我的错误？

以下是我成功使用 API 的方法：

```
var map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-18T16:50:35.470

`GClientGeocoder()`是版本 2 对象。您正在加载版本 3 API 并且需要使用版本 3 对象和方法。

版本 3 的等效版本是`google.maps.Geocoder()`并且[在文档中进行了](https://developers.google.com/maps/documentation/javascript/geocoding)描述。它与第 2 版实现不同。

# javascript - 在 UIWebView 中将图像插入 Web 窗体

> ID：10213149
> 
> 赞同：0
> 
> 时间：2012-04-18T15:50:38.840
> 
> 标签：javascript, objective-c, ios, uiwebview

在我的应用程序中，自定义表单被加载到`UIWebView`. 要提交的所需信息的一部分是图像（这是必需的）。在提交之前如何将图像添加到表单中。

作为附带的问题，反过来将表单信息拉入Objective-C对象并通过？发送所有内容会更容易`NSURLConnection`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:02:15.573

您可以使用任何 HTML 编辑器（或手动编码）来创建 html 文件并插入图像......所以，假设您已经创建了一个 myhtmlfile.html 和一个名为“image1”的文件的图像.jpg”。您将在您的包中包含这两个文件（myhtmlfile.html 和 image1.jpg）（将它们添加到您的项目中）。

在 Objective-C (iOS) 中，您可以像这样使用 UIWebView 的 loadHTMLString 方法：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"myhtmlfile" ofType:@"html"];
NSFileHandle *readHandle = [NSFileHandle fileHandleForReadingAtPath:path];
NSString *htmlString = [[NSString alloc] initWithData: 
                            [readHandle readDataToEndOfFile] encoding:NSUTF8StringEncoding];

[self.myWebView loadHTMLString:htmlString baseURL:[[NSBundle mainBundle] bundleURL]]; 
```

假设 myWebView 是您的 UIWebView 的瞬间。这里的关键是 html 文件和图像文件都需要在您的主包中。

# c# - 从资源 C# 加载程序集

> ID：10213151
> 
> 赞同：1
> 
> 时间：2012-04-18T15:50:42.050
> 
> 标签：c#, reflection, .net-assembly

因此，我试图在 C# .NET 2.0 中的可移植应用程序中保留所有依赖项（包括非托管 - 所以没有 ILMerge）。

起初，我通过使用成功地将 DLL 写入磁盘，`File.WriteAllBytes("DLLName.dll", Propertes.Resources.dll_name)`以便程序可以从中读取，但问题是写入它们所花费的时间以及它造成的混乱。

相反，我注意到`Assembly.Load`. 这是我用来将资源中的依赖项读取到程序中的代码：

```
try
{
    // Load OpenHardwareMonitorLib
    Assembly.Load(Properties.Resources.lib_hardware_monitor);

    // Some computers explicitly require 32 or 64 bit versions of SQLite. Load either version depending on architecture.
    if (Environment.GetEnvironmentVariable("PROCESSOR_ARCHITECTURE") == "AMD64")
    {
        // 64 bit version
        Assembly.Load(Properties.Resources.lib_sqlite_x64);
    }
    else
    {
        // 32 bit version
        Assembly.Load(Properties.Resources.lib_sqlite_x86);
    }
}
catch ... 
```

这似乎工作正常。好吧，至少在我的电脑上。它进入了我朋友 PC 上的 catch 块，但我认为你写的这么好心的答案会用一块石头击中两只鸟。

但是，这是我在程序进入主应用程序时尝试/捕获后从我的计算机得到的错误：

“无法加载文件或程序集 'OpenHardwareMonitorLib, Version=0.4.0.0, Culture=neutral, PublicKeyToken=null' 或其依赖项之一。系统找不到指定的文件。”

但当然，它仍在寻找实际的 DLL 文件。现在，我该如何解决这个问题？

### 额外细节

OpenHardwareMonitorLib 没有外部依赖项。我还更新了这个问题，以明确在try/catch 块*之后它无法在**我*的计算机上运行，​​也不是我朋友的计算机*在*所示的 try/catch 块中失败。

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:02:07.760

您正在使用 Assembly.Load(byte[]) 重载。一般来说，这是一种非常麻烦的加载程序集的方式。您在这里遇到的具体问题是您正在尝试加载混合模式程序集。SqlLite 包含本机代码和托管代码。您使用的重载仅支持纯托管程序集。

你不能这样做。

我会推荐简单而通用的解决方案来解决您的问题，该解决方案也适用于具有 UAC 以阻止您尝试执行的操作的机器。名为“setup.exe”的单个可执行文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T15:56:26.103

罪魁祸首很可能是 DLL 的依赖项之一，而不是它本身。所以你的代码可能没问题，但需要在机器上安装依赖项。

您可以使用[fuslogvw](http://msdn.microsoft.com/en-us/library/e74a18c4%28v=vs.71%29.aspx)查看错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T15:57:20.737

可能是您朋友计算机上缺少的依赖 dll 之一。请使用 Fusion Log Viewer 识别它们

[http://msdn.microsoft.com/en-us/library/e74a18c4(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/e74a18c4(v=vs.71).aspx)**

# ruby - 如何在 Rhomobile 框架中访问数据库和创建表

> ID：10213152
> 
> 赞同：0
> 
> 时间：2012-04-18T15:50:44.343
> 
> 标签：ruby, rhomobile, rhodes

我是 Rhomobile 的新手。我正在 Rhomobile 开发应用程序。谁能指导我如何查看 RHOMOBILE 中的数据库和表以及如何创建数据库和表。

我看过 RHOMOBILE 教程。我没有得到任何明确的想法。请指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:24:38.450

如果在 Windows 中，您可以在路径中 gem 文件夹下的文件中查看数据库
`platform/wm/bin/win32/rhodes/Debug/rho/db/syncdblocal.sqlite`

您可以使用`SQLite Database Browser`(http://sqlitebrowser.sourceforge.net) 来操作您的数据。[在SourceForge SQLiteBrowser 项目页面](http://sourceforge.net/projects/sqlitebrowser/files/latest/download)下载它。

# javascript - 未关闭的 SVG 路径似乎已关闭

> ID：10213155
> 
> 赞同：45
> 
> 时间：2012-04-18T15:50:48.153
> 
> 标签：javascript, path, svg, d3.js

我正在用 d3 写一些东西，但遇到了一个奇怪的问题。封闭的路径以“Z”字符结尾，但无论我是否包含 Z，我制作的每条路径都会关闭（并填充）。即使与从规范中复制的示例隔离开来，也会发生这种情况。例如：

```
<svg>
    <path d="M 40 60 L 10 60 L 40 42.68 M 60 60 L 90 60 L 60 42.68"/>
</svg> 
```

我很困惑可能是什么问题。我将不胜感激。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-04-18T16:20:17.030

[SVG 规范](http://www.w3.org/TR/SVG/)中关于[填充路径](http://www.w3.org/TR/SVG/painting.html#FillProperties)的相关行：

> 填充操作通过执行填充操作来填充打开的子路径，就好像在路径中添加了一个附加的“closepath”命令以连接子路径的最后一个点和子路径的第一个点。

因此，就**填充**而言，末尾有一个隐含的“Z”。但是，对于**stroke**，没有隐含的闭包，因此除非您明确添加“Z”，否则它不会绘制连接最后一个点和第一个点的笔画。

如果您只想应用描边，请使用 CSS 禁用填充：

```
path {
  fill: none;
  stroke: #000;
  stroke-width: 1.5px;
} 
```

（我看到你回答了你自己的问题，但我认为其他人可能仍然会发现一个有用的解释。）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-12-14T04:00:19.453

我对答案投了赞成票，但有时当您尝试将 svg 转换为画布并希望防止 svg 路径填充或关闭时，css 不是一个选项。等效于 css 解决方案，但没有 css ...

```
<svg fill="white" fill-opacity="0" stroke="#000" stroke-width="1.5">
    <path d="M 40 60 L 10 60 L 40 42.68 M 60 60 L 90 60 L 60 42.68"/>
</svg> 
```

# android - Android 和 iOS 有哪些共同的音频格式编码器？

> ID：10213158
> 
> 赞同：2
> 
> 时间：2012-04-18T15:50:52.213
> 
> 标签：android, ios, audio, audio-recording

此外，必须跨设备共享记录（可能在服务器上存储/处理）。

除了常见的格式之外，我希望您能推荐正确的比特率/配置。我正在录制语音，我希望实现最小的空间，但对人们录制的内容有良好/体面的理解（或多或少是 WhatsApp 的工作方式），因此他们可以相互理解，并且文件足够轻，可以在慢速连接下相对快速地传输。

我已经去过这个[Android图表](http://developer.android.com/guide/appendix/media-formats.html)，但我对iOS（未来的发展）知之甚少。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:13:39.970

[您可以在文档](http://developer.apple.com/library/ios/#documentation/Miscellaneous/Conceptual/iPhoneOSTechOverview/MediaLayer/MediaLayer.html)中找到 iOS 上支持的媒体技术列表。但似乎没有太多重叠，所以您可能想继续使用像 open [speex](http://www.speex.org/)编解码器这样的编码器，它针对 VoIP 应用程序进行了优化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-18T10:25:54.310

[您可以在我的另一篇文章中找到答案，其中包含适用于 iOS 和 Android](https://stackoverflow.com/questions/15871407/audio-format-for-ios-and-android/29715880#29715880)的片段 MPEG_4 格式和 AAC 编码器 音频格式

# ruby-on-rails - Ruby 1.8.7 使用 JSON.parse 对哈希进行排序

> ID：10213159
> 
> 赞同：1
> 
> 时间：2012-04-18T15:51:08.403
> 
> 标签：ruby-on-rails, ruby, json

我一直无法解决这个问题，所以我想我会在这里问。我正在使用 Ruby 1.8.7 和 RoR 1.2.6。我有我的控制器呈现这个 JSON：

```
{
  "form_id": "1",
  "form_structure": {
    "3": {
        "answer_required": "undefined",
        "title": "This is a radio group, right?",
        "cssClass": "radio",
        "values": {
            "4": {
                "value": "Yes",
                "baseline": "undefined"
            },
            "5": {
                "value": "No",
                "baseline": "undefined"
            },
            "7": {
                "value": "Maybe",
                "baseline": "undefined"
            },
            "20": {
                "value": "Test",
                "baseline": "undefined"
            }
        }
    }
  }
} 
```

如您所见，“值”下的选项按表中的 ID 排序。在 JSON 中看起来很完美。当我使用`JSON.parse`它时，“值”下的所有内容都变得异常，它返回：

```
{
  "form_id"=>"1",
  "form_structure"=>{
    "3"=>{
        "title"=>"This is a radio group, right?",
        "cssClass"=>"radio",
        "answer_required"=>"undefined",
        "values"=>{
            "7"=>{
                "baseline"=>"undefined",
                "value"=>"Maybe"
            },
            "20"=>{
                "baseline"=>"undefined",
                "value"=>"Test"
            },
            "4"=>{
                "baseline"=>"undefined",
                "value"=>"Yes"
            },
            "5"=>{
                "baseline"=>"undefined",
                "value"=>"No"
            }
        }
    }
  }
} 
```

这段代码用于我正在制作的表单构建器中，如果一个人构建的表单元素没有按照他们构建它们的正确顺序显示，那将不是很好。任何人都对我如何可以在我输出时或在此之前保留订购或重新订购吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:10:10.250

干得好：

```
form["form_structure"]["3"]["values"] = 
form["form_structure"]["3"]["values"].sort {
        |a,b| a[0].to_i <=> b[0].to_i
 } 
```

这将根据值散列中键的整数值对散列进行排序，并将排序后的散列放回较大的散列中。

如果您需要保留所有哈希值，请使用以下命令：

```
 val = {}
 val = form["form_structure"]["3"]["values"].sort { 
      |a,b| a[0].to_i <=> b[0].to_i }
 ind = []
 val.each { |v| ind += [v[0]] }
 val = {}
 ind.each { |k| val[k] = form["form_structure"]["3"]["values"][k] }
 form["form_structure"]["3"]["values"] = val 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-27T21:10:37.380

升级到 1.9.x ruby​​ 版本获取哈希顺序

# ruby-on-rails-3 - 如何使用 postgresql 在 Rails 中设置表所有权？

> ID：10213164
> 
> 赞同：5
> 
> 时间：2012-04-18T15:51:24.343
> 
> 标签：ruby-on-rails-3, postgresql, roles

我对 Rails 很陌生，所以希望这不是一个愚蠢的问题。

我正在尝试让 rails 使用具有两个不同用户帐户的 postgresql 数据库。但是，我希望能够在这些帐户之间切换，因此它们对数据库具有相同的权限（理想情况下，它们都不是 postgresql 超级用户）。

我`NOLOGIN`在 postgres 中创建了一个角色，它是数据库的所有者。然后将两个用户帐户分配给此角色。但是，每当我这样做时`rake db:migrate`，它都会使用户帐户（而不是角色）成为**表**的所有者。如果我然后切换用户，第二个用户将没有第一个用户创建的表的正确权限。

拥有两个帐户的原因是能够快速切换，例如当我需要更改密码而不停机时。

**有没有办法告诉 Rails 在创建表时使用特定角色作为所有者？**（或者如果没有两个帐户在同一个 postgresql 角色中，也许有更好的方法来实现这一点？）

更新：到目前为止，我发现[这个解决方案](https://stackoverflow.com/a/2686185/305019)可以作为外部脚本手动运行，并将所有表的所有权更改为 NOLOGIN 角色，但我希望有更优雅的东西或者更适合 rails 的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T16:16:59.597

你可以在 PostgreSQL 方面做很多事情：

如果你想`role2`拥有所有的特权`role1`，你可以：

```
GRANT role1 TO role2; 
```

和/或，使用 PostgreSQL 9.0 或更高版本，您可以指示 PostgreSQL 为新对象设置[默认权限：](http://www.postgresql.org/docs/current/interactive/sql-alterdefaultprivileges.html)

> ALTER DEFAULT PRIVILEGES 允许您设置将应用于将来创建的对象的权限。（它不影响分配给已存在对象的权限。）目前，只能更改表（包括视图和外部表）、序列和函数的权限。

您可以对角色或模式执行此操作。对于您的情况，您可以：

```
ALTER DEFAULT PRIVILEGES FOR ROLE role1 GRANT SELECT ON TABLES TO role2; 
```

* * *

如果您希望**多个不同的角色共享一组权限**，我会将对象的所有权限授予一个非登录角色（曾经被称为`GROUP`） -`role0`在下面的示例中。使用`DEFAULT PRIVILEGES`它并且不要忘记预先存在的对象，包括序列（我倾向于忘记那些）。
然后`GRANT role0`是其他角色。

沿着这些思路：

```
ALTER DEFAULT PRIVILEGES FOR ROLE role1 GRANT SELECT ON TABLES TO role0;
ALTER DEFAULT PRIVILEGES FOR ROLE role2 GRANT SELECT ON TABLES TO role0;
...

GRANT role0 TO role1;
GRANT role0 TO role2; 
```

这样`GRANT`，如果需要，您可以轻松地将特权附加到一个角色。您可以在此设置中添加任意数量的角色。

许多**DML 语句**需要对象的**所有权**。我引用[手册`ALTER TABLE`](http://www.postgresql.org/docs/current/interactive/sql-altertable.html)：

> 您必须拥有该表才能使用 ALTER TABLE。

作为拥有表工作的角色的成员。因此，在上面的示例中，如果您制作`role0`自己的表格，`role1`并且`role2`可以使用`ALTER TABLE`. 执行：

```
ALTER TABLE tbl OWNER TO user0; 
```

对于您创建的每个表。

`CREATE`或者在运行命令之前进入角色：

```
SET ROLE user0;
CREATE ...;
CREATE ...;
RESET ROLE; 
```

如果你忘记了你是谁：

```
SELECT current_user, session_user; 
```

# android - 如何更改/禁用 onClick 突出显示颜色

> ID：10213165
> 
> 赞同：2
> 
> 时间：2012-04-18T15:51:28.947
> 
> 标签：android, xml, layout

当我单击一个项目时，它会突出显示橙色。

我试过了：

```
android:state_pressed="false" 
```

如果有什么方法可以阻止它这样做，或者改变突出显示的颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-04T18:38:35.647

就像每个人都说的那样，如果您设置按钮的背景，单击时它不会突出显示，将其设置为 null 或像这样的清晰颜色效果很好：

在按钮的 xml 中：

```
android:background="@color/clear" 
```

在你的 colors.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="clear">#00000000</color>
</resources> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T11:47:51.680

通过将项目的背景更改为 android:background="@null" 您将获得所需的结果。它适用于我的按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T17:16:38.880

尝试这个

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_selected="true" android:drawable="your_selected_drawable_or_color" />
    <item android:state_pressed="true" android:drawable="your_pressed_drawable_or_color" />
    <item android:drawable="your_default_drawable_or_color" />
</selector> 
```

玩弄组合以获得最适合您的组合。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T15:57:01.063

您需要通过自己的选择器更改视图的背景：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android"
    android:constantSize=["true" | "false"]
    android:dither=["true" | "false"]
    android:variablePadding=["true" | "false"] >
    <item
        android:drawable="@[package:]drawable/drawable_resource"
        android:state_pressed=["true" | "false"]
        android:state_focused=["true" | "false"]
        android:state_hovered=["true" | "false"]
        android:state_selected=["true" | "false"]
        android:state_checkable=["true" | "false"]
        android:state_checked=["true" | "false"]
        android:state_enabled=["true" | "false"]
        android:state_activated=["true" | "false"]
        android:state_window_focused=["true" | "false"] />
</selector> 
```

# javascript - 我们可以让 Google Maps Javascript Geocoding API v3 在响应中返回自定义标识符吗？

> ID：10213166
> 
> 赞同：1
> 
> 时间：2012-04-18T15:51:32.270
> 
> 标签：javascript, google-maps-api-3

我有一堆地址（字符串数组），我将它们写入页面变量并准备好`geocoder.geocode({'address': address}, callback)`调用每个地址。我还绘制了最初加载的地址表。并非所有这些都是“有效” *****地址，因此并非所有这些都会在地图上带有标记。

我想更新表格以仅显示映射的地址，并希望能够在单击标记时突出显示表格中的相应行。我需要的是，我最初拥有的地址和标记的地址之间存在某种联系。

我希望我能够传递一个自定义标识符值，我可以传递给`geocoder.geocode()`它会返回`results`我可以在`callback`函数中使用的值

有任何想法吗？

* *** *valid 是一些商业条件的简化术语

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T17:12:45.633

一种方法是使用`Function Closure`

```
function my_geocoder(address) {
    geocoder.geocode( { 'address': address}, function(results, status) {

       //do something with the geocoder responce here. 
       //you also still have access to the `address` variable to do what you will. 
    });
}

...

for(....) {
    my_geocoder(address);
} 
```

它可以在没有函数闭包的情况下完成，但这种模式很容易。（其他方法很容易被绊倒）。（如果是迂腐的，它实际上不是启用此功能的函数闭包，它的变量范围，但再次与闭包结合，避免了一些陷阱）

# java - java web 本地化支持

> ID：10213172
> 
> 赞同：1
> 
> 时间：2012-04-18T15:51:39.057
> 
> 标签：java, spring, jakarta-ee, localization

我已经创建了本地化的 .properties 文件。但我不知道如何即时更改它们。事情是我可以为语言制作一个表单选择器，但是我应该在哪里设置输出？它始终使用默认的 .properties 文件

我的表格看起来像这样

```
<h:form>
<h:selectOneMenu id="language" value="????">
  <f:selectItem id="item1" itemLabel="Czech" itemValue="cs_CZ" />
  <f:selectItem id="item2" itemLabel="Slovak" itemValue="sk_SK" />
  <f:selectItem id="item3" itemLabel="English" itemValue="default" />
</h:selectOneMenu>
</h:form> 
```

我正在使用带有休眠 JSF2.0 和 J2EE1.6 的 spring

谢谢

更新：

我像这样加载了捆绑包：

```
 <f:loadBundle basename="bundle/labels" var="labels"/> 
```

但我需要将其替换为：

```
<bean id="messageSource"
      class="org.springframework.context.support.ResourceBundleMessageSource">
            <property name="basenames">
                <list>
                    <value>Messages</value>
                    <value>labels</value>
                </list>
            </property>
</bean> 
```

但是这个解决方案不会在包包中找到 labels.properties。它在类路径中查找，但我无法重新定位它。

更新 2：

好的，现在我可以看到 JSF 和 SPRING 有不同的加载方法，而 SPRING 从 messageSource 获取捆绑包 JSF 仍然从其中获取它们，`<f:loadBundle>`那么我该如何`<f:loadBundle>`获取已翻译的属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:10:09.440

Spring Support this with a [`LocalChangeInterceptor`](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/web/servlet/i18n/LocaleChangeInterceptor.html). This interceptor can be configured to an property it is listen to.

```
<mvc:interceptors>
    <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor"
          p:paramName="lang" />
<mvc:interceptors> 
```

Then you need to send HTTP Requests with parameter `lang=cs_CZ`

@See [Spring Reference Chapter 15.6.4 LocaleChangeInterceptor](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/htmlsingle/#mvc-localeresolver-interceptor) for more details

# iphone - 使用界面生成器向 UITextView 添加文本

> ID：10213174
> 
> 赞同：0
> 
> 时间：2012-04-18T15:51:48.043
> 
> 标签：iphone, objective-c, interface-builder

我有一个`textview`，我已将`height`600设置为`interfacebuilder`. 然后我粘贴了一篇大文章（可能有超过 5000 多个字符）。应用程序滚动并且可以正确看到每一位文本。

我遇到的问题是，我需要有一个标题（粗体并增加字体大小），然后文本的正文以较小的字体大小出现等。我该怎么做`interface builder`？

如果无法使用`IB`，那么我该如何以编程方式进行呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T15:54:24.780

a 中的文本`UITextView`都具有相同的字体、样式和大小。您将需要一个`UILabel`或其他一些文本小部件来以不同方式显示任何内容。你可以使用 a`UIWebView`然后世界就是你的牡蛎。

此外，将您的文章文本放入文本文件，在运行时加载，然后将文本放入您的文本视图中，这将是更好的设计，如下所示：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"file" ofType:@"txt"];
NSError *error = nil;
NSString *text = [NSString stringWithContentsOfFile:path
                                          endcoding:NSUTF8StringEncoding
                                              error:&error];

if (text == nil) {
   [self doSomethingUsefulWith:error];
} else {
   myTextView.text = text;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T15:55:34.310

**您可以使用UIWebview**以 html 代码形式阅读

 **```
- (void)loadHTMLString:(NSString *)string baseURL:(NSURL *)baseURL; 
```

并对整个消息进行编码，然后将链接包装到

```
[webView.loadHTMLString:@"<h1>heading</h1><h2>test smaller</h2>" baseURL:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T15:54:06.557

这不能在 IB 中或以编程方式完成。`UITextView`可能仅使用整个内容的属性显示文本。

属性文本最简单的解决方案是使用 a `UIWebView`（以及由 adali 的答案起草）。

替代方案将使用多个`UITextView`s 或`UILabel`s。

满足您的需求的最复杂的方法是使用`CoreText`. 查看[本教程](http://www.cocoanetics.com/2011/01/befriending-core-text/)了解更多信息。**

# git - 在 GIT 中，如何防止人们更改或删除已推送的提交？

> ID：10213180
> 
> 赞同：6
> 
> 时间：2012-04-18T15:52:08.183
> 
> 标签：git, reset, githooks

我们最近有一个实习生运行“git reset --hard”并且不小心撤消了我们主要 GIT 存储库上的很多工作。我们正在恢复工作，但我想确保不会再发生类似的事情。

我知道对此有很多疑问，但它们似乎都是关于恢复而不是预防。有什么办法可以防止推送到我们的主仓库来更改或删除已经推送的提交？是否有一个配置设置或者一个推送钩子可以完成这项工作？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T16:30:20.940

您可以在中央（裸）存储库中设置2 个[配置选项，以帮助防止此问题：](http://progit.org/book/ch7-1.html)

```
receive.denyNonFastForwards
receive.denyDeletes 
```

第一个选项要求所有推送仅添加历史记录。A`git reset`后跟 a`git push`将被拒绝。

第二个关闭了一个漏洞，有人可以删除一个远程分支，`git push <origin> :<branch-to-delete>`然后用正常的`git push`和他们想要的任何更改再次推送。

# model-view-controller - 使 JavaScript 生成的 HTML 可抓取的网站最不冗余的方法是什么？

> ID：10213185
> 
> 赞同：31
> 
> 时间：2012-04-18T15:52:09.570
> 
> 标签：model-view-controller, seo, automation, dry, mustache

在阅读[了 Google 关于使 Ajax 生成的内容可抓取的政策](https://developers.google.com/webmasters/ajax-crawling/docs/learn-more)，以及许多开发人员的博客文章和有关该主题的 Stackoverflow 问答线程之后，我得出的结论是，没有办法制作一个仅使用 JavaScript/Ajax 生成的网站可抓取的 HTML。我目前正在工作的网站没有获得相当数量的内容索引。我们的非索引内容的所有表示层都是用 JavaScript 构建的，通过从基于 Ajax 的 Web 服务调用返回的 JSON 生成 HTML，我们相信 Google 不会因此而对内容进行索引。那是对的吗？

唯一的解决方案似乎是也为搜索引擎（特别是谷歌）提供一个“后备”版本的网站，其中所有的 HTML 和内容都将按照传统方式在服务器端生成。对于启用了 JavaScript 的客户端，我们似乎可以使用与现在基本相同的方法：使用 JavaScript 从异步加载的 JSON 生成 HTML。

环顾四周，我的理解是，当前在创建如上所述的可抓取 Ajax 生成的网站时应用[DRY 原则](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)的最佳实践是使用可以在客户端和服务器端使用相同模板的模板引擎。对于启用了 JavaScript 的客户端，客户端模板引擎（例如[mustache.js](https://github.com/janl/mustache.js/)）将从服务器发送的 JSON 数据转换为由其模板文件副本定义的 HTML。对于禁用 JavaScript 的搜索爬虫和客户端，相同模板引擎的服务器端实现（例如[mustache.java](https://github.com/spullara/mustache.java)）将类似地对其完全相同的模板文件副本进行操作以输出 HTML。

如果该解决方案是正确的，那么这与 4 或 5 年前前端重型网站使用的方法有何不同，在这些方法中，网站基本上必须维护模板代码的两份副本，一份用于启用 JavaScript 的用户（几乎每个人）以及没有启用 JavaScript 的搜索引擎和浏览器的另一个副本（例如在[FreeMarker](http://freemarker.sourceforge.net/)或[Velocity中）（几乎没有人）？](http://velocity.apache.org/)似乎应该有更好的方法。

这是否意味着需要维护两个模板模型层，一个在客户端，一个在服务器端？[将这些客户端模板与Backbone.js](http://documentcloud.github.com/backbone/)、[Ember.js](http://emberjs.com/)或[YUI App Library](http://yuilibrary.com/yui/docs/app/)等前端 MVC (MV/MVVC) 框架结合起来有多可取？这些解决方案如何影响维护成本？在不向开发团队的技术堆栈中引入更多框架（新的模板引擎和前端 MVC 框架）的情况下尝试这样做会更好吗？有没有办法减少冗余？

如果该解决方案不正确，那么我们是否缺少某些东西，并且可以使用 JavaScript 做得更好，以保持我们现有的异步 HTML-from-JSON 结构并将其编入索引，因此我们不需要引入新的东西到架构堆栈？当业务需求发生变化时，我们真的宁愿不必更新表示层的两个版本。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-23T03:00:28.987

我以前怎么没想到！只需使用[http://phantomjs.org](http://phantomjs.org)。这是一个无头 webkit 浏览器。您只需构建一组操作来抓取 UI 并在您想要的每个状态下捕获 html。Phantom 可以为您将捕获的 html 转换为 .html 文件并将它们保存到您的 Web 服务器。

每次构建/提交时，整个事情都会自动化（PhantomJS 是命令行驱动的）。您编写的用于抓取 UI 的 JS 代码会在您更改 UI 时中断，但它不应该比自动化 UI 测试更糟糕，而且它只是 Javascript，因此您可以使用 jQuery 选择器来抓取按钮并单击它们。

如果我必须解决 SEO 问题，这绝对是我制作原型的第一种方法。爬行并保存，宝贝。是的先生。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-23T02:56:18.937

我认为结合一些技术和一个你可以重复使用的手动编码的黑客技术可以解决你的问题。这是我疯狂的、半生不熟的想法。这是理论上的，可能不完整。步骤1：

*   按照您的建议，使用客户端模板。将每个模板放在一个单独的文件中（以便您可以在客户端和服务器之间轻松地重用它们）
*   使用 underscore.js 模板，或重新配置 Mustache。这样，您将在模板中获得 ERB 样式分隔符，与 Java 的 <%= %> 内容相同。
*   由于它们是单独的文件，因此您需要使用 curl.js 或 require.js 等模块加载器在 CommonJS 模块中开始开发，以便在客户端代码中加载模板。如果您不进行模块化开发，那真是太棒了。我开始〜一个月前。一开始似乎很难，但这只是包装代码的另一种方式：http: [//addyosmani.com/writing-modular-js/](http://addyosmani.com/writing-modular-js/)

好的，现在您有了独立的模板。现在我们只需要弄清楚如何在服务器上用它们构建一个平面页面。我只看到两种方法。第2步：

*   您可以注释您的 JS，以便服务器可以读取它并查看 ajax 调用的默认路径以及它们链接到的模板，然后服务器可以使用注释以正确的顺序调用控制器方法并填写一个平面页面。
*   或者您可以注释您的模板以指示它们应该调用哪个控制器并提供示例调用参数。这将很容易维护，并且会让像我这样必须一直查找控制器 URL 的前端开发人员受益。它还会告诉你的后端代码调用什么。

希望这可以帮助。很想听到这个问题的最佳答案。一个有趣的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-24T02:10:50.800

使用[远端](http://code.google.com/p/distal)模板。您的网站是可抓取的静态 HTML，并且 Distal 将静态 HTML 视为模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-06T22:20:49.090

我们确实为此目的使用了 PhantomJS，就像可以说的那样简单。如果您有权在主机上使用它，那将非常有用。

如果这不是一个选择，或者如果你只是不想自己处理。我们确实有这样做的免费服务。有关更多信息，请参阅此帖子：[http ://rogeralsing.com/2013/08/06/seo-indexing-angularjs-sites-or-other-ajax-sites-with-wombit-crawlr/](http://rogeralsing.com/2013/08/06/seo-indexing-angularjs-sites-or-other-ajax-sites-with-wombit-crawlr/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-07T15:05:35.580

我找到了一个不需要任何 Java、Node.js 或任何其他方式来制作 JS 代码生成网站的冗余副本的解决方案。它还支持所有浏览器。

所以你需要做的是为谷歌提供快照。这是最好的解决方案，因为您不需要弄乱其他 URL 等等。另外：您不会在基本网站中添加 noscript，因此它更轻巧。

如何制作快照？Phantomjs、HTMLUnit 等需要一个可以放置和调用的服务器。您需要对其进行配置，并与您的网站结合使用。这是一团糟。不幸的是，没有 PHP 无头浏览器。由于 PHP 的特殊性，这一点很明显。

那么获取快照的另一种方法是什么？好吧...如果用户打开网站，您可以通过 JS (innerHTML) 获得他所看到的快照。

所以你需要做的是：

*   检查您是否需要网站快照（如果有，则无需再拍摄）
*   您将此快照发送到服务器以保存到文件（PHP 使用快照处理 POST 请求，并保存到文件）

如果 Google Bot 访问您的 hash bang 网站，您将获得所请求页面的快照文件。

要解决的事情：

*   安全性：您不希望用户或他的浏览器（注入）的任何脚本保存到快照，也许最好的办法只有您可以生成快照（参见下面的站点地图）
*   兼容性：您不想从任何浏览器中保存，而是从最支持您的网站的浏览器中保存
*   不要打扰移动设备：只是不要使用移动用户来生成快照，这样页面对他们来说不会变慢
*   故障转移：如果你没有快照输出标准网站——它对谷歌没有好处，但总比没有好

还有一件事：并非所有页面都会被用户访问，但在他们访问之前您需要 Google 的快照。

那么该怎么办？对此也有解决方案：

*   生成包含您网站上所有页面的站点地图（必须即时生成才能保持最新，而爬虫软件无济于事，因为它不执行 JS）
*   以任何方式访问站点地图中没有快照的页面。这将调用快照代码并正确生成它
*   定期（每天？）

但是，嘿，如何访问所有这些页面？出色地。有一些解决方案：

*   用 Java、C# 或其他语言编写一个应用程序，以从服务器获取要访问的页面，并使用内置的浏览器控件访问它。将此添加到您在服务器上的日程安排中。
*   编写一个 JS 脚本，在 iFRAME 中逐个打开所需的页面。将此添加到您在计算机上的日程安排中。
*   如果您的网站大部分是静态的，只需手动打开上述脚本

还记得偶尔刷新旧快照以使它们保持最新。

我希望听到您对此解决方案的看法。

# sql - 从时间戳中丢弃毫秒部分

> ID：10213190
> 
> 赞同：84
> 
> 时间：2012-04-18T15:52:29.960
> 
> 标签：sql, postgresql, casting, timestamp, rounding

我怎样才能丢弃/舍入`millisecond`零件，如果`second`零件也从`timestamp`w/o中移除会更好`timezone`？

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2012-04-18T15:57:59.627

投到[`timestamp(0)`](https://www.postgresql.org/docs/current/datatype-datetime.html)或***舍***入到整秒：[`timestamptz(0)`](https://www.postgresql.org/docs/current/datatype-datetime.html)

 *```
SELECT now()::timestamp(0); 
```

分数不存储在这种类型的表列中。

[`date_trunc()`](https://www.postgresql.org/docs/current/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC) ***截断***（保持秒数不变） - 这通常是您真正想要的：

```
SELECT date_trunc('second', now()::timestamp); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2019-08-23T14:06:05.807

**丢弃毫秒：**

```
SELECT DATE_TRUNC('second', CURRENT_TIMESTAMP::timestamp); 
```

> 2019-08-23 16:42:43

**丢弃秒数：**

```
SELECT DATE_TRUNC('minute', CURRENT_TIMESTAMP::timestamp); 
```

> 2019-08-23 16:42:00

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-03-13T18:28:29.530

如果你只是想要时间，这里是 postgres 的代码

```
SELECT DATE_TRUNC('second', CURRENT_TIMESTAMP::timestamp)::time; 
```

它将返回“没有时区的时间”数据类型*

# asp.net - CustomValidator 在客户端触发，但验证失败时验证控件不呈现

> ID：10213192
> 
> 赞同：3
> 
> 时间：2012-04-18T15:52:33.660
> 
> 标签：asp.net

我有一个简单的：如果选中“是”单选按钮而不是使文本框成为必需的情况。我提供了客户端和服务器端验证。我发现的是：

1.  客户端验证正在触发并通过警报消息正确显示失败。
2.  验证控件从不呈现错误消息并且服务器被命中。
3.  当服务器被击中并且验证失败时，控件会呈现正确的错误消息。

为什么客户端在验证方面工作正常，但没有呈现错误消息并继续到服务器？

```
asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
<script src="Scripts/jquery-1.7.2.js" type="text/javascript"></script> 

<script type="text/javascript">
    function testClientValidation(src, args) {
        if ($('#<%=rblstTest.ClientID%>' + ' input:checked').length == 1) {
            if ($('#<%=rblstTest.ClientID%>' + ' input:checked').val().toLowerCase() == "yes") {
                args.isValid = !($('#<%=txtTest.ClientID%>').val() == "");  
            } else {
                args.isValid = true;
            }
        } else {
            args.isValid = true;
        }

        alert(args.isValid);
    }
</script>
</asp:Content>
<asp:Content ID="BodyContent" runat="server" ContentPlaceHolderID="MainContent">
<div>
<asp:RadioButtonList ID="rblstTest" RepeatDirection="Horizontal" RepeatLayout="Flow" runat="server">
    <asp:ListItem>Yes</asp:ListItem>
    <asp:ListItem>No</asp:ListItem>
</asp:RadioButtonList> 

<asp:TextBox ID="txtTest" runat="server"/>

<asp:CustomValidator ID="cust" ControlToValidate="rblstTest" 
                                OnServerValidate="testSeverValidation" 
                                ClientValidationFunction="testClientValidation" 
                                Display="Dynamic" 
                                ErrorMessage="Error!" runat="server"/>

 <asp:LinkButton runat="server" ID="lnkSubmit" Text="Submit"  />
 </div>  
 </asp:Content> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T09:13:34.120

使用`args.IsValid`代替`args.isValid`

```
function testClientValidation(src, args) {
        if ($('#<%=rblstTest.ClientID%>' + ' input:checked').length == 1) {
            if ($('#<%=rblstTest.ClientID%>' + ' input:checked').val().toLowerCase() == "yes") {
                args.IsValid = !($('#<%=txtTest.ClientID%>').val() == "");  
            } else {
                args.IsValid = true;
            }
        } else {
            args.IsValid = true;
        }

        alert(args.IsValid);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T17:13:12.993

我添加了一个`Hidden Field`新添加的。

```
<asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" runat="server">
<script type="text/javascript" language="javascript" src="Scripts/jquery-1.4.1.min.js"></script>
<script type="text/javascript" language="javascript" src="Scripts/jquery-1.4.1.js"></script>
<script language="javascript" type="text/javascript">

    function testClientValidation(src, args) {
        debugger;
        if (document.getElementById('<%= hdn.ClientID %>').value == '1') {
            var txtBox = document.getElementById('<%= txtTest.ClientID%>');
            if (txtBox.value == '') {
                document.getElementById('cust').style.display = 'block';
                document.getElementById('cust').innerHTML = 'Error!'
                document.getElementById('<%= hdn.ClientID %>').value = "1";
                args.IsValid = false;
                return false;
            }
            else {
                document.getElementById('cust').style.display = 'none';
                document.getElementById('cust').innerHTML = '';
                document.getElementById('<%= hdn.ClientID %>').value = "0";
                args.IsValid = true;
            }
        }
        else {
            document.getElementById('cust').style.display = 'none';
            document.getElementById('cust').innerHTML = '';
            document.getElementById('<%= hdn.ClientID %>').value = "0";
            args.IsValid = true;
        }
        return true;
    }

    $(document).ready(function () {
        $("span input[type='radio']").click(function () {
            debugger;
            if ($(this).val() == 'Yes') {
                document.getElementById('<%= hdn.ClientID %>').value = "1";
                if (document.getElementById('<%= txtTest.ClientID%>').value == '') {
                    Page_IsValid = false;
                    document.getElementById('<%= hdn.ClientID %>').value = "1";
                }
                else {
                    Page_IsValid = true;
                }
            }
            else {
                document.getElementById('<%= hdn.ClientID %>').value = "0";
                Page_IsValid = true;
            }
            return true;
        });
    });
</script>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <div>
        <asp:RadioButtonList ID="rblstTest" RepeatDirection="Horizontal" RepeatLayout="Flow"
            runat="server">
            <asp:ListItem>Yes</asp:ListItem>
            <asp:ListItem>No</asp:ListItem>
        </asp:RadioButtonList>
        <asp:TextBox ID="txtTest" runat="server" />
        <asp:CustomValidator ClientIDMode="Static" ID="cust" OnServerValidate="testSeverValidation"
            ClientValidationFunction="testClientValidation" Display="Dynamic" ErrorMessage="Error!"
            runat="server" />
        <asp:LinkButton runat="server" ID="lnkSubmit" Text="Submit" />
        <asp:HiddenField ID="hdn" runat="server" Value="0" />
    </div>
</asp:Content> 
```

* * *

**[有关更多信息，请在此处](http://msdn.microsoft.com/en-us/library/aa479045.aspx#aspplusvalid_clientside)**查看参考 ![在此处输入图像描述](../Images/d514581cb7738ce2ed5aa33de9cb0708.png)![在此处输入图像描述](../Images/a7e1b491f85ccc6aa0e233c3ffc5b3c4.png)

# r - 使用 RCurl 绕过“免责声明页面”，然后进行网络抓取

> ID：10213194
> 
> 赞同：1
> 
> 时间：2012-04-18T15:52:34.740
> 
> 标签：r, redirect, rcurl

我有一个像[这样](http://bank.hangseng.com/1/PA_1_1_P1/ComSvlet_MiniSite_eng_gif?app=eINVCFundPriceDividend&pri_fund_code=U42360&data_selection=0&keyword=U42360&start_day=30&start_month=03&start_year=2012&end_day=18&end_month=04&end_year=2012&data_selection2=0)的链接，我想从中提取数据`RCurl`，在此之前有一个免责声明页面，我需要在浏览器中单击它才能评估数据。以前我使用下面的脚本（来自[这里](https://stackoverflow.com/questions/3616406/object-moved-error-in-using-the-rcurl-geturl-function-in-order-to-access-an-as)）来“绕过”免责声明页面并使用以下方式访问数据`RCurl`：

```
 pagesource <- getURL(url,.opts=curlOptions(followlocation=TRUE,cookiefile="nosuchfile"))
 doc <- htmlParse(pagesource) 
```

以前可以用，最近几天就不行了。实际上我对它在做什么的代码不太了解，我想知道我是否必须更改 . 中的某些内容`curlOptions`，或者重新编写整段代码？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:43:10.817

正如我在评论中提到的，您的问题的解决方案将完全取决于“免责声明页面”的实施。看起来以前的解决方案使用了[此处](http://curl.haxx.se/docs/httpscripting.html)更详细定义的 cURL 选项。基本上，它指示 cURL 做的是提供一个虚假的 cookie 文件（名为“nosuchfile”），然后按照您尝试访问的站点给出的标头重定向。显然，该网站的设置方式是，如果访问者声称没有正确的 cookie，那么它会立即将访问者重定向到免责声明页面。

您没有碰巧在您的工作目录中创建一个名为“nosuchfile”的文件，对吗？如果没有，听起来目标站点改变了其免责声明页面的运行方式。如果是这种情况，除非我们拥有您尝试访问以进行诊断的实际页面，否则我们确实无法提供帮助。

在您在问题中引用的示例中，他们使用 Javascript 跳过免责声明，这可能很难通过。

但是，对于您提到的示例...

1.  在 Chrome（或带有 Firebug 的 Firefox）中打开它
2.  右键单击页面中的一些空白区域，然后选择“检查元素”
3.  单击网络选项卡
4.  如果那里有内容，请单击底部的“清除”按钮清空页面。
5.  接受许可协议
6.  观察通过网络的所有流量。就我而言，最重要的结果是有趣的结果。如果单击它，您可以预览它以验证它确实是一个 HTML 文档。如果您单击该项目下的“标题”选项卡，它将显示“请求 URL”。在我的情况下，这是：[http ://bank.hangseng.com/1/PA_1_1_P1/ComSvlet_MiniSite_eng_gif?app=eINV​​CFundPriceDividend&pri_fund_code=U42360&data_selection=0&keyword=U42360&start_day=30&start_month=03&start_year=2012_&end_day=18&end_month=04&122=0dataselection=02](http://bank.hangseng.com/1/PA_1_1_P1/ComSvlet_MiniSite_eng_gif?app=eINVCFundPriceDividend&pri_fund_code=U42360&data_selection=0&keyword=U42360&start_day=30&start_month=03&start_year=2012&end_day=18&end_month=04&end_year=2012&data_selection2=0)

您可以直接访问该 URL，而无需手动或从 cURL 接受任何许可协议。

请注意，如果您已经接受了协议，本网站会存储一个 cookie，说明需要将其删除才能返回许可协议页面。您可以通过单击“资源”选项卡，然后转到“Cookie”并删除每一个，然后刷新您在上面发布的 URL 来执行此操作。

# knockout.js - 如果周围和

> ID：10213197
> 
> 赞同：2
> 
> 时间：2012-04-18T15:52:42.893
> 
> 标签：knockout.js

我正在尝试按如下方式构建表，但出现“错误：找不到要匹配的结束注释标记：ko if: cellIsStartOfRow”。

我做错了吗？

```
<table>
    <tbody data-bind="foreach: MyDocs">
        <!-- ko if: cellIsStartOfRow --> 
            <tr class="docsRow">
        <!-- /ko -->  
                <td>

                      <!-- There is more databinding in here - a div containing a textarea and also containing a hyperlink surrounding an image.  I think the contents are irrelevant to my question, but I can post if someone disagrees.-->  

                </td> 

        <!-- ko if: cellIsEndOfRow --> 
            </ tr>
        <!-- /ko --> 

   </tbody>
</table> 
```

这是视图模型的 JS。上面 td 的内容有些简化，因为我认为里面的内容完全不相关。我从页面上的其他 js 调用函数。视图模型本身被分配给在页面上声明的变量。

```
Type.registerNamespace("HpDocs");

HpDocs.DocsVM = function (data) {
    ko.mapping.fromJS(data, {}, this);

    // add additional properties to each document for presentation
    // purposes
    for (i = 0; i < this.MyDocs().length; i++) {
        var myDoc = this.MyDocs()[i];
        myDoc.docObjectId = "docObject" + myDoc.Id();
        myDoc.textareaId = "ucHpDocs" + "_txta";

        if (i % 5 == 0) {
            myDoc.cellIsStartOfRow = true;
            myDoc.cellIsEndOfRow = false;
        } else if (i % 5 == 5) {
            myDoc.cellIsStartOfRow = false;
            myDoc.cellIsEndOfRow = true;
        } else {
            myDoc.cellIsStartOfRow = false;
            myDoc.cellIsEndOfRow = false;
        }
    }
};

HpDocs.DocsVM.prototype = {
//    cellIsStartOfRow: function(){
//        return true;
//    },
    getDocs: function (filter) {
        var self = this;
        $.ajax({
            url: getMethodUrl("GetDocs"),
            data: "{'filter': " + filter + "}",
            success: function (response) {
                ko.mapping.fromJS(response.d, {}, self.MyDocs);
            }
        })
    }
};

HpDocs.dbGetDocs = function (filter) {
    $.ajax({
        url: getMethodUrl("DbGetDocs"),
        data: "{'filter': " + filter + "}",
        success: function (response) {

            myDocsViewModel = new HpDocs.DocsVM({
                MyDocs: ko.mapping.fromJS(response.d)
            });

            var bindingScope = $("#divMyDocs")[0];
            ko.applyBindings(myDocsViewModel, bindingScope);

            $(".DocsUpdateProgress").addClass("invisible");
        }
    })
};

HpDocs.getPreferredTab = function () {
    var tabPref = $("[id$='hidDocTabPreference']").html();
    return tabPref;
};

HpDocs.showProgress = function () {
    $(".DocsUpdateProgress").removeClass("invisible");
};
HpDocs.hideProgress = function () {
    $(".DocsUpdateProgress").addClass("invisible");
};

//register the class
HpDocs.DocsVM.registerClass('HpDocs.DocsVM', null, Sys.IDisposable);

// notify ajax that the script is now loaded.
if (typeof (Sys) !== 'undefined') Sys.Application.notifyScriptLoaded(); 
```

### 回答

我重构了我的模型：不是让 MyDocs 包含对象列表，而是让它包含一个名为 Rows 的属性，该属性又包含一个名为 Documents 的属性。然后，我可以执行以下操作：

```
<table id="tblMyDocs">
                <tbody data-bind="foreach:  MyDocs.Rows">

                        <tr data-bind="foreach: Documents">
                                  <td>
                                          <!-- in here i present each document by databinding to the Model's properties -->
                                  <td>
                        </tr>
                 </tbody>
</table> 
```

当然，视图模型要容易得多，因为模型现在按行组织：

```
HpDocs.DocsVM = function (data) {
    ko.mapping.fromJS(data, {}, this);
};

HpDocs.DocsVM.prototype = {
    getDocs: function (filter) {
        var self = this;
        $.ajax({
            url: getMethodUrl("GetDocs"),
            data: "{'filter': " + filter + "}",
            success: function (response) {
                ko.mapping.fromJS(response.d, {}, self.MyDocs);
            }
        })
    }
};

HpDocs.dbGetDocs = function (filter) {
    $.ajax({
        url: getMethodUrl("DbGetDocs"),
        data: "{'filter': " + filter + "}",
        success: function (response) {

            myDocsViewModel = new HpDocs.DocsVM({
                MyDocs: ko.mapping.fromJS(response.d)
            });

            var bindingScope = $("#divMyDocs")[0];
            ko.applyBindings(myDocsViewModel, bindingScope);

            HpDocs.hideProgress();
        }
    })
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:46:32.287

而不是像下面这样向你的 js 添加格式化逻辑：

```
// add additional properties to each document for presentation
    // purposes
    for (i = 0; i < this.MyDocs().length; i++) {
        var myDoc = this.MyDocs()[i];
        myDoc.docObjectId = "docObject" + myDoc.Id();
        myDoc.textareaId = "ucHpDocs" + "_txta";

        if (i % 5 == 0) {
            myDoc.cellIsStartOfRow = true;
            myDoc.cellIsEndOfRow = false;
        } else if (i % 5 == 5) {
            myDoc.cellIsStartOfRow = false;
            myDoc.cellIsEndOfRow = true;
        } else {
            myDoc.cellIsStartOfRow = false;
            myDoc.cellIsEndOfRow = false;
        } 
```

我建议为数据行创建一个单独的视图模型。由于您没有提供任何 json 数据，我无法 100% 解决它，但希望这能让您朝着正确的方向前进。这是我正在使用的 jsfiddle：http: [//jsfiddle.net/JasonMore/GcSAn/2/](http://jsfiddle.net/JasonMore/GcSAn/2/)

**看法**

```
<table>
    <tbody data-bind="foreach: someArray">
            <tr class="docsRow" data-bind="foreach:docRows">
                <td>
                    <div data-bind="attr:  {id: objectId}">
                       <a data-bind="attr: {href: someUrl}">
                          <img data-bind="attr: {src: IconPath, alt: Tooltip}"/>
                       </a> 
                       <br/>
                       <textarea runat="server" readonly="readonly" data-bind="html: DisplayName"></textarea>

                    </div>
                </td> 
            </ tr>

   </tbody>
</table>​​​​​ 
```

**Javascript**

```
HpDocs.RowVM = function(data) {
    ko.mapping.fromJS(data, {}, this);

}

HpDocs.DocsVM = function(data) {
    ko.mapping.fromJS(data, {}, this);

    this.docRows = ko.observableArray();

    // add additional properties to each document for presentation
    // purposes
    for (i = 0; i < this.MyDocs().length; i++) {
        var myDoc = this.MyDocs()[i];
        myDoc.docObjectId = "docObject" + myDoc.Id();
        myDoc.textareaId = "ucHpDocs" + "_txta";

        if (i % 5 == 0) {
            // create new RowVM and start adding DocsVM to it
        } else if (i % 5 == 5) {
            // push the RowVM to this.docRows populated with cells
        } else {
            // add the myDoc to the current RowVM you are working with
        }
    }
}; 
```

**更新-关于如何创建正确的 mvvm 的淘汰赛讨论的链接**

幻灯片和示例：[http ://bit.ly/FamilyFeudSlides](http://bit.ly/FamilyFeudSlides)

代码：[https ://github.com/jasonmore/familyfeud](https://github.com/jasonmore/familyfeud)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-30T15:37:03.217

问题出在这里：

```
<!-- ko if: cellIsStartOfRow --> 
   <tr class="docsRow">
<!-- /ko --> 
```

你必须在 if 中有打开和关闭标签，所以..

```
<!-- ko if: cellIsStartOfRow --> 
   <tr class="docsRow">
   ... 
   </tr>
<!-- /ko --> 
```

# c - memcpy tcp 套接字上的段错误

> ID：10213204
> 
> 赞同：0
> 
> 时间：2012-04-18T15:53:05.140
> 
> 标签：c, segmentation-fault, memcpy

我正在编写一个连接到服务器的客户端。我在 TCP 套接字的第 124 行 memcpy() 上遇到了分段错误。使用 UDP 连接我想获取网络上服务器的 IP 地址，然后，获得 IP，我想通过 TCP 连接与其连接。TCP 连接的代码本身可以工作，因为我可以在一个新文件中编译。我不明白问题出在哪里。

```
#include <stdio.h>      
#include <sys/types.h>
#include <ifaddrs.h>
#include <netinet/in.h> 
#include <string.h> 
#include <arpa/inet.h>
#include <string.h>
#include <memory.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <sys/types.h>
#include <netdb.h>
#include "main.h"

int developer=1;
struct myHelloMsg {
    char myIp[25];
    char myID[25];
};
int FindMyIp(char myIpAddr[], char myMask[], char myBroad[]);
int RecvBroadTime(int sockfd, struct sockaddr_in server_addr);
void CheckID(char myUserID[]);

int main() {
    char myIpAddr[25], myMask[25], myBroad[25], myUserID[25]="";
    char otherUserIp[25], otherUserID[25];
    struct myHelloMsg myMsg, rxMsg;
    CheckID(myUserID);
    int checkConnection;
    disconnected: ;
    checkConnection=0;
    if (developer==1) printf("\nSearching for a network..\n");
    while (checkConnection == 0) {
        checkConnection = FindMyIp(myIpAddr, myMask, myBroad);
        if (checkConnection==0) {
            if (developer==1) printf("--Disconnected..\n");
            sleep(5);
        }
    }
    if (developer==1) printf("\n--Connected..\nIP Address\t: %s\n", myIpAddr);
    if (developer==1) printf("Subnet Mask\t: %s\n", myMask);
    if (developer==1) printf("Broadcast IP\t: %s\n", myBroad);

    int i=0;
    for (i=0;i<25;i++) {
        myMsg.myIp[i]=myIpAddr[i];
        myMsg.myID[i]=myUserID[i]; 
    }
    struct hostent *hptr = gethostbyname(myBroad);
    if (hptr == NULL) {
        if (developer==1) printf("Error while transmitting broadcast message..\n");
        return 0;
    }
    // create socket for initial UDP communication
    int sockfd = socket(AF_INET, SOCK_DGRAM, 0);
    struct sockaddr_in server_addr;
    bzero(&server_addr, sizeof(struct in_addr));
    server_addr.sin_family = AF_INET;
    server_addr.sin_port = htons(5051);
    server_addr.sin_addr.s_addr = htonl(INADDR_BROADCAST);
    memcpy(&server_addr.sin_addr, hptr->h_addr_list[0], sizeof(struct in_addr));
    int opt = 1;
    setsockopt(sockfd, SOL_SOCKET, SO_BROADCAST, &opt, sizeof(int));
    int error=0;
    if (developer==1) printf("--Contacting other users in the network..\n");
    sendto(sockfd, &myMsg, sizeof(myMsg), 0, (struct sockaddr *) &server_addr, sizeof(struct sockaddr_in));
    int foundSomeone=0;
    //try to connect with others for 5 times - because of UDP unreliable connection
    int countTries=0, received=0, lastTry=0;
    while (countTries<5) { 
        foundSomeone = RecvBroadTime(sockfd, server_addr);
        if (foundSomeone == 1) {
            if (developer==1) printf("An answer has been received..\n");
            socklen_t ssize = sizeof(struct sockaddr_in);
            recvfrom(sockfd, &rxMsg, sizeof(rxMsg), 0, (struct sockaddr *) &server_addr, &ssize);
            received=1;
            countTries=5;
        }
        else if (foundSomeone == 0) {
            if (developer==1) printf("Timeout(%d try)..\n", countTries+1);
            sendto(sockfd, &myMsg, sizeof(myMsg), 0, (struct sockaddr *) &server_addr, sizeof(struct sockaddr_in));
            if (countTries==4) {
                lastTry=1;
            }
        }
        else {
            if (developer==1) printf("--Error..\n");
        }
        countTries++;
    }
    if ((lastTry==1)&&(countTries==5)) {
        foundSomeone = RecvBroadTime(sockfd, server_addr);
        if (foundSomeone == 1) {
            if (developer==1) printf("An answer has been received..\n");
            socklen_t ssize = sizeof(struct sockaddr_in);
            recvfrom(sockfd, &rxMsg, sizeof(rxMsg), 0, (struct sockaddr *) &server_addr, &ssize);
            received=1;
        }
        else if (foundSomeone == 0) {
            if (developer==1) printf("--No one is connected to the current network..\n");
        }
        else {
            if (developer==1) printf("There has been an error while trying to contact other users..\n");
        }
    }
    close(sockfd);
    // someone else is connected to the network
    // i am gonna behave as a client in during the synchronization step
    if (received==1) {
        if (developer==1) printf("Contact made with user %s (%s).\n", myMsg.myID, myMsg.myIp);
        // check if the user belong to friends i am sharing content with
        i=0;
        for (i=0;i<25;i++) {
            otherUserIp[i]=rxMsg.myIp[i];
            otherUserID[i]=rxMsg.myID[i];
        }
        int socktcp = socket(AF_INET, SOCK_STREAM, 0);  
        struct hostent *hptr_tcp = gethostbyname(otherUserIp);
        struct sockaddr_in server_addr_tcp;
        bzero(&server_addr_tcp, sizeof(struct sockaddr_in));
        server_addr_tcp.sin_family = AF_INET;
        server_addr_tcp.sin_port = htons(5054);
        printf("a\n");
        memcpy(&server_addr_tcp.sin_addr, hptr_tcp->h_addr_list[0], sizeof(struct in_addr));
        printf("a\n");
        if (connect(socktcp, (struct sockaddr *) &server_addr_tcp, sizeof(struct sockaddr_in))<0) {
            printf("-Error..\n");
        } else {
            printf("Connection with %s established.. Ready for synchronization step..\n", otherUserID);
        }
    }

    return 0;
}

int RecvBroadTime(int sockfd, struct sockaddr_in server_addr) {
    fd_set socks;
    struct timeval t;
    t.tv_sec = 1;
    t.tv_usec = 0;
    FD_ZERO(&socks);
    FD_SET(sockfd, &socks);
    return select(sockfd+1, &socks, NULL, NULL, &t);
}

int FindMyIp(char myIpAddr[], char myMask[], char myBroad[]) {
    struct ifaddrs * ifAddrStruct=NULL;
    struct ifaddrs * ifa=NULL;
    void * tmpAddrPtr=NULL;
    getifaddrs(&ifAddrStruct);
    int i=0, connected=0;
    ifa = ifAddrStruct;
    while (i!=1) {
        if (((ifa ->ifa_addr->sa_family==AF_INET)&&(ifa->ifa_name[0]=='e')&&(ifa->ifa_name[1]=='n')&&(ifa->ifa_name[2]=='1'))||((ifa ->ifa_addr->sa_family==AF_INET)&&(ifa->ifa_name[0]=='e')&&(ifa->ifa_name[1]=='t')&&(ifa->ifa_name[2]=='h')&&(ifa->ifa_name[3]=='0'))) {
            i=1;
            connected=1;
        } else {
            if (ifa->ifa_next == NULL) return connected;
            ifa = ifa->ifa_next;
        }
    }
    tmpAddrPtr=&((struct sockaddr_in *)ifa->ifa_addr)->sin_addr;
    inet_ntop(AF_INET, tmpAddrPtr, myIpAddr, INET_ADDRSTRLEN);
    tmpAddrPtr=&((struct sockaddr_in *)ifa->ifa_netmask)->sin_addr;
    inet_ntop(AF_INET, tmpAddrPtr, myMask, INET_ADDRSTRLEN);
    tmpAddrPtr=&((struct sockaddr_in *)ifa->ifa_broadaddr)->sin_addr;
    inet_ntop(AF_INET, tmpAddrPtr, myBroad, INET_ADDRSTRLEN);
    return connected;
}

void CheckID(char myUserID[]) {
    FILE *fp;
    if((fp=fopen("userData.txt", "r+"))==NULL) {
        printf("Error while opening the file..\n");
    }
    else {
        fscanf(fp, "%25s", myUserID);
        if (strlen(myUserID)==0) {
            printf("First time you open this app..\nInsert your User ID: ");
            scanf("%s", myUserID);
            fprintf(fp, "%-25s", myUserID);
        }
        else {
            printf("Welcome back %s..\n", myUserID);
        }
        fclose(fp);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T17:04:33.510

我想说不可能使用`gethostbyname()`.

* * *

另外：`gethostbyname()`已过时，请`getnameinfo()`改用。

# jquery - jquery 元素有时不会在悬停时停止

> ID：10213208
> 
> 赞同：0
> 
> 时间：2012-04-18T15:53:17.890
> 
> 标签：jquery

当我将鼠标悬停在它们上时，我正在尝试制作 6 张 cd 图像以同时移动 35 像素和旋转 45 度。它有效，但有时当我离开悬停区域时，动画不会停止，有时它会在停止之前重复 6 或 7 次......我不知道为什么，这是我唯一的查询我的档案，我该怎么办？

谢谢

css

```
#cd1 {
    left: 0px;
}
#cd2 {
    left: 40px;
}
#cd3 {
    left: 80px;
}
#cd4 {
    left: 120px;
}
#cd5 {
    left: 160px;
}
#cd6 {
    left: 200px;
} 
```

html

```
<body>
    <div id="cd6"></div>
    <div id="cd5"></div>
    <div id="cd4"></div>
    <div id="cd3"></div>
    <div id="cd2"></div>
    <div id="cd1"></div>
</body> 
```

jQuery

```
var cds = ['#cd1', '#cd2', '#cd3', '#cd4', '#cd5', '#cd6'];
var pos_init = ['0', '40', '80', '120', '160', '200'];
$(cds).each(function(i) {
    $(cds[i]).hover(
        function() {
            var esquerda = parseInt(pos_init[i]);
            $(this).animate({left: (esquerda + 35) + 'px'}, 'slow');
            $(this).css({'-webkit-transform' : 'rotate(45deg)'});
        },
        function() {
            var esquerda = parseInt(pos_init[i]);
            $(this).animate({left: (esquerda) + 'px'}, 'slow');
            $(this).css({'-webkit-transform' : 'rotate(0deg)'});
        }
    );
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:04:28.410

尝试在动画之前添加[.stop()](http://api.jquery.com/stop/)函数。

```
var cds = ['#cd1', '#cd2', '#cd3', '#cd4', '#cd5', '#cd6'];
var pos_init = ['0', '40', '80', '120', '160', '200'];
$(cds).each(function(i) {
    $(cds[i]).hover(
        function() {
            var esquerda = parseInt(pos_init[i],10);
            $(this).stop().animate({left: (esquerda + 35) + 'px'}, 'slow');
            $(this).css({'-webkit-transform' : 'rotate(45deg)'});
        },
        function() {
            var esquerda = parseInt(pos_init[i]);
            $(this).stop().animate({left: (esquerda) + 'px'}, 'slow');
            $(this).css({'-webkit-transform' : 'rotate(0deg)'});
        }
    );
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:07:03.890

```
var cds = ['#cd1', '#cd2', '#cd3', '#cd4', '#cd5', '#cd6'];
var pos_init = ['0', '40', '80', '120', '160', '200'];
$(cds).each(function(i) {
        $(cds[i]).hover(function() {
            var esquerda = parseInt(pos_init[i]);
            $(this).stop(true, true).animate({left: (esquerda + 35) + 'px'}, 'slow');
            $(this).css({'-webkit-transform' : 'rotate(45deg)'});
        },
        function() {
            var esquerda = parseInt(pos_init[i]);
            $(this).stop(true, true).animate({left: (esquerda) + 'px'}, 'slow');
            $(this).css({'-webkit-transform' : 'rotate(0deg)'});
        }
    );
});​ 
```

# c# - 如何使用 c# WPF 打开 chm 文件中的特定页面

> ID：10213215
> 
> 赞同：5
> 
> 时间：2012-04-18T15:53:43.767
> 
> 标签：c#, wpf, chm

我想打开 CHM 文件的特定页面。我正在使用 WPF 应用程序。目前我已经实施

```
System.Diagnostics.Process.Start(filepath) 
```

这无助于打开特定页面

问候， NewDev

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:01:11.150

听起来您实际上是在尝试向 WPF 应用程序添加上下文相关的帮助。例如，如果您在特定文本框中使用光标按 F1，您将看到该特定文本框的帮助。

如果是这种情况，请参阅这篇文章：

[http://blogs.msdn.com/b/mikehillberg/archive/2007/07/26/a-context-sensitive-help-provider-in-wpf.aspx](http://blogs.msdn.com/b/mikehillberg/archive/2007/07/26/a-context-sensitive-help-provider-in-wpf.aspx)

或者这个：

[http://www.netframeworkdev.com/windows-presentation-foundation-wpf/contextsensitive-help-in-wpf-73953.shtml](http://www.netframeworkdev.com/windows-presentation-foundation-wpf/contextsensitive-help-in-wpf-73953.shtml)

具体来说，您可以使用[System.Windows.Forms.Help.ShowHelp(](http://msdn.microsoft.com/en-us/library/system.windows.forms.help.showhelp.aspx) ) 命令完成此操作。

您可能需要添加对 System.Windows.Forms.dll 的引用才能访问帮助功能。

最后，如果您仍然无法使用帮助文件，您需要的所有信息都应该在这里：http: [//msdn.microsoft.com/en-us/library/2ksk25ts.aspx](http://msdn.microsoft.com/en-us/library/2ksk25ts.aspx) 这都是针对 Windows 窗体的，当然，但如果你有正确的参考，它应该延续到 WPF。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-30T00:00:07.663

您必须在项目中添加“System.Windows.Forms”引用，然后调用 Help.ShowHelp 方法以在“xyz.chm”中打开特定页面

```
System.Windows.Forms.Help.ShowHelp(null, "xyz.chm","xyz_index.html"); 
```

希望这可以帮助 ：）

# oracle - JSTL 远程数据源连接失败

> ID：10213221
> 
> 赞同：0
> 
> 时间：2012-04-18T15:54:00.363
> 
> 标签：oracle, jsp, jstl

我正在尝试连接到我们的外部 Oracle 数据库，但我无法收到任何关于它失败原因的错误消息。

```
<c:catch var="error">
<sql:setDataSource var="snapshot" driver="oracle.jdbc.OracleDriver" url="jdbc:oracle:thin:@xx.xx.xx.xx:40004:TJUAWSP" user="xxxxx" password="xxxxx" />
</c:catch>
<c:out value="${error}" /> 
```

# mysql - 通过 REGEX 分组 MySQL 搜索 IP 地址

> ID：10213222
> 
> 赞同：0
> 
> 时间：2012-04-18T15:54:00.723
> 
> 标签：mysql, regex, database, group-by

我发现[了这个](https://stackoverflow.com/questions/8273405/mysql-group-by-regex)关于按模式对 MySQL 搜索进行分组的问题，但我需要对 IP 地址执行此操作。我需要按前 3 个八位字节对 IP 地址进行分组，但我不太明白如何完成此操作。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:10:08.733

[MySQL SUBSTRING_INDEX 函数](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_substring-index)在这里可能有用：

```
drop table if exists test_ip;

create table test_ip
(id int unsigned not null primary key auto_increment,
ip varchar(50) not null,
UNIQUE KEY test_ip_uidx1 (ip));

insert into test_ip (ip) values ('24.21.114.4');
insert into test_ip (ip) values ('24.21.114.5');
insert into test_ip (ip) values ('24.21.114.6');
insert into test_ip (ip) values ('24.21.115.6');
insert into test_ip (ip) values ('24.21.115.7');
insert into test_ip (ip) values ('24.21.115.8');
insert into test_ip (ip) values ('24.21.116.1');

select substring_index(ti.ip,'.',3) as firstThreeOctet,count(*) as ipCount
from test_ip ti
group by substring_index(ti.ip,'.',3); 
```

希望能帮助到你。

# javascript - 如何在用户在移动设备上输入日期后点击完成时注册事件？

> ID：10213225
> 
> 赞同：0
> 
> 时间：2012-04-18T15:54:10.130
> 
> 标签：javascript, jquery-mobile

我在我的 jQuery Mobile 应用程序中使用默认时间输入设备，它看起来像

![在此处输入图像描述](../Images/97e3af7575ccff616cb2c49d8348847c.png)

当用户在移动设备上单击“完成”时，如何注册 javascript 事件？我试过模糊无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:30:52.087

[文档](http://dev.jtsage.com/jQM-DateBox/demos/api/events.html)说要查找传递给元素的方法，然后您可以检查 close 方法。

```
$('element').bind('datebox', function (e, passed) { 
  if ( passed.method === 'close' ) {
    alert('test');
  }
}); 
```

希望这可以帮助。

# javascript-framework - M 项目与 Sproutcore

> ID：10213230
> 
> 赞同：1
> 
> 时间：2012-04-18T15:54:37.390
> 
> 标签：javascript-framework, sproutcore

我无法在这两个选项之间做出决定。

M 项目与 Sproutcore

我正在构建一个主要在移动设备上提供服务但必须在桌面上可行的应用程序。

Mproject 在他的预构建小部件的数量和可变性方面处于领先地位，并且可能会发生我需要更多或至少改变一些行为的情况。所以这是 Mproject 的缺点。但它寻找的第一个评论是 Mproject 需要更少的代码来处理基本的东西。

第二个问题来自于皮肤。我基本上需要重新设计所有东西。应用程序的设计必须非常独特。所以我想知道它们中的哪些很容易重新皮肤，而不仅仅是通过主题滚轮和类似的东西。

我将不胜感激任何其他仅 JavaScript 框架的建议。

感谢所有回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T16:00:07.727

我不确定你正在构建什么样的应用程序，所以你应该注意我的回答。

M-Project 很好地解决了我们的问题，并帮助我们编写清晰的代码……当您了解它的工作原理时。它需要一些努力，文档有点差，而且是一个新项目，有些东西还没有实现。您可以通过修改 HTML 和 CSS 来更改应用程序的外观，所以我认为您应该对此没有任何问题。

您也可以下载他们的代码并毫无问题地对其进行修改，如果您需要任何特定行为，它很容易阅读和修改。

另一方面，我从未使用过 Sproutcore，它的外观非常漂亮。但文档称它专注于桌面应用程序。我猜你可能不会有太多问题来适应移动设备的输出 HTML。

最后，我想你可以看看[Lungo.js Framework](http://www.lungojs.com/)。

最好的祝福。

# c# - 使用 iTextSharp 将句子中的单个单词加粗

> ID：10213231
> 
> 赞同：23
> 
> 时间：2012-04-18T15:54:39.743
> 
> 标签：c#, itextsharp

是否可以使用 iTextSharp 将句子中的单个单词加粗？我正在尝试将几个单独的单词加粗，而不必将字符串分成单独的短语。

我想要这种类型的输出

例如：**取消的原因：**参见本文件背面代码编号 1 指定的法定原因。

我的实际输出如下

例如：取消的原因：参见本文件背面代码编号 1 指定的法定原因。

代码

```
 pdftb4 = new PdfPTable(1);
    pdftb4.WidthPercentage = 100;
    width = new float[1];
    width[0] = 0.7F;
    pdftb4.SetWidths(width);

  pdfcel4 = new PdfPCell(new Phrase("\n REASON(S) FOR CANCELLATION: See Statutoryreason(s) designated by Code No(s) 1 on the reverse side hereof", docBlackFont10));
    pdfcel4.Border = 0;
    pdfcel4.HorizontalAlignment = Element.ALIGN_LEFT;
    pdftb4.AddCell(pdfcel4);
   objDocument.Add(pdftb4); 
```

有人请帮帮我

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-04-18T16:31:38.540

完成您正在尝试的方法是使用`Chunk`s。一个简单的例子是：

```
var normalFont = FontFactory.GetFont(FontFactory.HELVETICA, 12);
var boldFont = FontFactory.GetFont(FontFactory.HELVETICA_BOLD, 12);

var phrase = new Phrase();
phrase.Add(new Chunk("REASON(S) FOR CANCELLATION:", boldFont));
phrase.Add(new Chunk(" See Statutoryreason(s) designated by Code No(s) 1 on the reverse side hereof", normalFont)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-10T04:12:07.567

也可以创建类似的字体

```
Font verdanaBold = FontFactory.GetFont("Verdana", 7f, Font.BOLD); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:14:36.547

也许这个链接[在 iTextSharp 中使用富文本值加粗](https://stackoverflow.com/questions/8315791/bolding-with-rich-text-values-in-itextsharp)会有所帮助？

不确定它是否完全适合您的场景，但可能会让您到达您需要去的地方。

# wcf - 带有签名算法 sha1DSA 的证书上的 WCF 异常

> ID：10213233
> 
> 赞同：0
> 
> 时间：2012-04-18T15:54:54.250
> 
> 标签：wcf, rsa, dsa

我们正在使用 WCF 调用 java web 服务。当我们在测试服务器上调用该服务时，它运行良好，但是当我们转移到生产环境时，我们遇到了以下异常：

无法通过 HTTP 发送请求消息：令牌的加密集合不支持算法“http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p”

我们注意到的一件事是开发服务器证书的签名算法是“md5RSA”，而生产证书的签名算法是“sha1DSA”。是不是这种“RSA”“DSA”不匹配会导致异常？如果是这样，是否可以配置 WCF 来处理 DSA？

谢谢

# objective-c - PhoneGap/Cordova iOS：以持续时间限制（即 30 秒）捕获视频

> ID：10213234
> 
> 赞同：6
> 
> 时间：2012-04-18T15:54:54.800
> 
> 标签：objective-c, ios, cordova

我想将视频捕获限制为 30 秒。截至目前，PhoneGap 文档说明了以下 iOS 实现：

*“不支持持续时间参数。不能以编程方式限制录制长度。”*

我确实发现这篇文章似乎为纯粹客观的 C 实现提供了解决方案：

[iPhone：5秒视频拍摄](https://stackoverflow.com/questions/5838774/iphone-5-seconds-video-capture)

问题是：这是可以“轻松”制作成phonegap插件的东西，还是有其他原因phonegap无法实现这个？如果您认为可以做到 - 任何为我指明正确方向的信息都非常感谢！谢谢 ：）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-07T01:43:04.260

我正在尝试解决相同的问题，并且可能有解决方案：

[capture.captureVideo()函数返回一个](http://docs.phonegap.com/en/1.0.0/phonegap_media_capture_capture.md.html#capture.captureVideo)[MediaFile](http://docs.phonegap.com/en/1.0.0/phonegap_media_capture_capture.md.html#MediaFile)对象数组。这些对象有一个[MediaFile.getFormatData()](http://docs.phonegap.com/en/1.0.0/phonegap_media_capture_capture.md.html#MediaFile.getFormatData)方法，可以告诉您文件的持续时间是多少，因此如果文件太长，您可以拒绝该文件......

这是我的解决方案：

```
 navigator.device.capture.captureVideo(function(mediaFiles) {

                mediaFiles[0].getFormatData(function(data) {

                    if(data.duration > 30) {
                        /* Tell the user the video is too long */
                    } else {
                        /* Video is less than the max duration...all good */
                    }
                });

        }, function(error) { /* An error occured */ },
null); 
```

# facebook - 如何使用 Flash 创建一个网站，如“我的英特尔博物馆”？

> ID：10213237
> 
> 赞同：-3
> 
> 时间：2012-04-18T15:55:12.173
> 
> 标签：facebook, flash

我是 Flash 技术的新手。

有谁能告诉我或让我知道什么样的 Flash API 或库用于制作这个导入 Facebook 内容的 Flash 视频？

网站链接在这里： http: [//www.intel.com/museumofme/](http://www.intel.com/museumofme/)

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:24:00.643

如果您想学习如何将 Flash 与 Facebook 连接，那么您可能应该从[Adob​​e Flash 和 Facebook](http://www.adobe.com/devnet/facebook.html)教程开始。在那里，除了为 Facebook 平台配置 Adob​​e ActionScript 3 SDK 之外，您还可以找到一些关于如何登录 Facebook、如何获取当前用户以及其他内容的基本代码示例。

# ruby-on-rails - Hartl Ruby-on-Rails 教程 (3.2)，第 7.2 节 - 注册表单缺少模板

> ID：10213243
> 
> 赞同：2
> 
> 时间：2012-04-18T15:55:25.720
> 
> 标签：ruby-on-rails

**在测试 ruby​​-on-rails 教程的注册页面时出现以下错误：**

```
Failures:

1) User pages signup with valid information should create a user
 Failure/Error: expect { click_button submit }.to change(User, :count).by(1)
 ActionView::MissingTemplate:
   Missing template users/create, application/create with {:locale=>[:en], :formats=>[:html], :handlers=>[:erb, :builder, :coffee]}. Searched in:
     * "/Users/Fif/rails_projects/sample_app/app/views"
 # (eval):2:in `click_button'
 # ./spec/requests/user_pages_spec.rb:43:in `block (5 levels) in <top (required)>'
 # ./spec/requests/user_pages_spec.rb:43:in `block (4 levels) in <top (required)>'

Finished in 0.76918 seconds
35 examples, 1 failure

Failed examples:

rspec ./spec/requests/user_pages_spec.rb:42 # User pages signup with valid information should create a user 
```

**我不确定问题出在哪里，我已经多次检查代码以确保它与书中的示例匹配。我很确定它与 new.html.erb 文件有关**

# **user_pages_spec.rb**

```
require 'spec_helper'

describe "User pages" do
  subject { page }

  describe "signup page" do
    before { visit signup_path }

    it { should have_selector('h1',    text: 'Sign up') }
    it { should have_selector('title', text: full_title('Sign up')) }
  end

  describe "profile page" do
    let(:user) { FactoryGirl.create(:user) }
    before { visit user_path(user) }

    it { should have_selector('h1',    text: user.name) }
    it { should have_selector('title', text: user.name) }
  end

  describe "signup" do

    before { visit signup_path }

    let(:submit) { "Create my account" }

    describe "with invalid information" do
      it "should not create a user" do
        expect { click_button submit }.not_to change(User, :count)
      end
    end

    describe "with valid information" do
      before do
        fill_in "Name",         with: "Example User"
        fill_in "Email",        with: "user@example.com"
        fill_in "Password",     with: "foobar"
        fill_in "Confirmation", with: "foobar"
      end

      it "should create a user" do
        expect { click_button submit }.to change(User, :count).by(1)
      end
    end
  end
end 
```

# 新的.html.erb

```
<%= provide(:title, 'Sign up') %>
<h1>Sign up</h1>

<div class="row">
  <div class="span6 offset3">
    <%= form_for(@user) do |f| %>

      <%= f.label :name %>
      <%= f.text_field :name %>

      <%= f.label :email %>
      <%= f.text_field :email %>

      <%= f.label :password %>
      <%= f.password_field :password %>

      <%= f.label :password_confirmation, "Confirmation" %>
      <%= f.password_field :password_confirmation %>

      <%= f.submit "Create my account", class: "btn btn-large btn-primary" %>
    <% end %>
  </div>
</div> 
```

# users_controller.rb

```
class UsersController < ApplicationController

  def show
    @user = User.find(params[:id])
  end

  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      # Handle a successful save.
    else
      render 'new'
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T17:44:22.820

**简短的回答：**

它不应该工作（还）。继续教程，答案将在第 7.4 节；

**稍微长一点 回复：**

当您填写表单并按下提交按钮时，会触发 users_controller 中的创建事件。由于您（还）没有任何代码，Rails 假设您只想渲染`create.html.erb`，它不存在（并且永远不会存在）。为了让它立即工作，你必须在`redirect_to @user`下面添加`if @user.save`. 检查**清单 7.25**；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T10:00:41.597

跳到教程底部，问题得到解答。`redirect_to @user`在您的#Handle 下包含成功保存。

# java - ImageMagick/IM4J FileNotFoundException

> ID：10213249
> 
> 赞同：3
> 
> 时间：2012-04-18T15:55:40.213
> 
> 标签：java, imagemagick, filenotfoundexception

我正在尝试使用[IM4J](http://im4java.sourceforge.net/)（ImageMagick 的 Java 包装器）来创建 JPEG 的缩略图，这是我对这两个库的第一次体验（有史以来）。请注意，这是我的技术主管向我提出的硬性要求（所以请不要建议使用除 IM4J/ImageMagick 以外的任何东西）解决方案 - 我的双手被束缚在这里的技术选择上！

我得到一个`FileNotFoundException`on the and`convert`命令，它告诉我我没有正确设置这些库之一（或两者）。

在我的电脑上，这是我的目录结构：

```
C:/
    myApp/
        images/             --> where all of my JPEGs are
        thumbnails/         --> where I want ImageMagick to send the converted thumbnails to
        imageMagickHome/    --> Where I downloaded the DLL to
            ImageMagick-6.7.6-1-Q16-windows-dll.exe
    ... 
```

在我的 Java 项目中，我确保 IM4J JAR ( `im4java-1.2.0.jar`) 在运行时位于类路径中。虽然我需要使用 IM4J 的 1.2.0 版本，但我可以自由使用任何我想要的 ImageMagick 版本。我只是选择了这个版本，因为它似乎是我的 Windows 7（32 位）机器的最新/稳定版本。**如果我应该使用其他版本，请在您的答案中从 ImageMagick 下载页面向我发送指向它的链接！**

至于 ImageMagick，我只是从[这里](https://www.imagemagick.org/script/download.php#windows)下载了那个 EXE并将它放在上面提到的文件夹中——**我没有做任何安装、向导、MSI、环境变量配置等。**

然后，在我的 Java 代码中：

```
// In my driver...
File currentFile = new File("C:/myApp/images/test.jpg"); --> exists and is sitting at this location
File thumbFile = new File("C:/myApp/thumbnails/test-thumb.jpg"); --> doesnt exist yet! (destination file)
Thumbnailer myThumbnailer = new Thumbnailer();
myThumbnailer.generateThumbnail(currentFile, thumbFile);

// Then the Thumbnailer:
public class Thumbnailer
{
    // ... omitted for brevity

    public void generateThumbnail(File originalFile, File thumbnailFile)
    {
        // Reads appConfig.xml from classpath, validates it against a schema,
        // and reads the contents of an element called <imPath> into this
        // method's return value. See below
        String imPath = getIMPathFromAppConfigFile();

        org.im4java.core.IMOperation op = new Operation();
        op.colorspace(this.colorSpace);
        op.addImage(originalFile.getAbsolutePath());
        op.flatten();
        op.addImage(thumbnailFile.getAbsolutePath());

        ConvertCmd cmd = new ConvertCmd();

        cmd.setSearchPath(imPath);

        // This next line is what throws the FileNotFoundException
        cmd.run(op);
    }
} 
```

我的 appConfig.xml 文件中包含 imPath 的部分：

```
<imPath>C:/myApp/imageMagickHome</imPath> 
```

请注意 - 如果此 appConfig.xml 格式不正确，我们的模式验证器将捕获它。由于我们没有收到模式验证错误，因此我们可以将其排除为罪魁祸首。**但是**，请注意我的文件路径分隔符；它们都是正斜杠。我这样做是因为有人告诉我，在 Windows 系统上，正斜杠被视为与 *nix 反斜杠相同，参考文件路径。信不信由你，我们正在 Windows 机器上开发，但部署到 linux 服务器，所以这是我的解决方案（再次强调，*不是*我的要求！）。

IM4J 甚至承认 Windows 用户有时会遇到麻烦，并在本文中解释说[，](https://web.archive.org/web/20180422095431/http://im4java.sourceforge.net:80/docs/dev-guide.html) Windows 开发人员可能必须设置一个`IM4JAVA_TOOLPATH`env var 才能使该库正常工作。我尝试了这个建议，创建了一个新的同名系统范围环境变量并将其值设置为`C:\myApp\imageMagickHome`. 还是没有区别。**但请注意，我在这里使用了反斜杠**。这是因为这个 env var 在我的机器上是本地的，而 appConfig.xml 是一个配置描述符，它被部署到 linux 服务器上。

据我所知，罪魁祸首可能是以下一项（或多项）：

*   我没有正确“安装”ImageMagick EXE，应该使用安装程序/MSI；或者我需要为 ImageMagick（不是 IM4J）本身添加一些其他环境变量
*   也许我仍然没有正确配置 IM4J，需要添加更多环境变量
*   可能是我的 appConfig.xml 文件中的 Windows/*nix "/" vs. "" 问题，如上所述

我也很困惑为什么我会得到一个`FileNotFoundException`名为“convert”的文件：

> java.io.FileNotFoundException：转换

我假设这是一个位于 IM4J jar 内某处的批处理/shell 文件（因为我为 ImageMagick 下载的唯一内容是 EXE）。但是，如果我提取 IM4J jar，我只会看到其中的类。我看到“脚本生成器”类，所以我假设这些在我`cmd.run(op)`调用之前启动并创建`convert`文件，也许这就是我所缺少的（也许我需要手动启动这些生成器之一，就像`CmdScriptGenerator`在执行我的`Thumbnailer`方法之前一样。 .或者，也许我的下载不完整。

无论哪种方式，我对任何一个库都不够精通，不知道从哪里开始。

感谢您对此的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:02:42.967

首先运行“ImageMagick-6.7.6-1-Q16-windows-dll.exe”安装程序来安装 imagemagick 库。然后确保您的环境路径包含已安装二进制文件的位置（“convert.exe”、“mogrify.exe”等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-15T17:46:14.157

确保您已设置环境变量 IM4JAVA_TOOLPATH。

[![在此处输入图像描述](../Images/5a5fc91c699322dcef28edcfb303d120.png)](https://i.stack.imgur.com/3P7D1.png)

# javascript - Ember.View Contenteditable 事件

> ID：10213252
> 
> 赞同：2
> 
> 时间：2012-04-18T15:55:44.737
> 
> 标签：javascript, ember.js

我正在尝试让 Ember.View 监听由 contenteditable 元素触发的事件，但遇到了一些麻烦。

我想要的最终结果是将 contenteditable 更改绑定到 Ember 对象属性。

事件直接使用jQuery正确绑定，如此答案中给出的：[contenteditable change events](https://stackoverflow.com/questions/1391278/contenteditable-change-events#answer-6263537)

```
$(function () {
  $(document).on('focus', '[contenteditable]', function(event) {
    var $this = $(this);
    console.log("$" + event.type);
    return $this;
  });
  $(document).on('blur keyup paste', '[contenteditable]', function(event) {
    var $this = $(this);
    console.log("$" + event.type);
    return $this;
  });
}); 
```

但是在 Ember.View 上指定的事件处理程序永远不会被调用：

```
App.ContentEditable = Ember.View.extend({
  item: App.Item.create({name:"Editable content"}),
  tagName: "span",
  contenteditable:"true",
  attributeBindings: ["contenteditable"],

  // Only event that gets triggered
  click: function(){ console.log("click") },

  // None of these events are triggered
  focusin: function(){ console.log("focusin") },
  focusout: function(){ console.log("focusout") },
  keyup: function(){ console.log("keyup") },
  blur: function(){ console.log("blur") },
  paste: function(){ console.log("paste") },
});​ 
```

我整理了一个 jsfiddle，显示`.on()`事件已记录到控制台，但 Ember.View 上的事件不是：http: [//jsfiddle.net/chrisconley/RqSn4/](http://jsfiddle.net/chrisconley/RqSn4/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:10:40.677

这是因为 Ember 中的事件名称被转换为更类似于 Ember 的命名约定。这些东西发生在[packages/ember-views/lib/system/event_dispatcher.js](https://github.com/emberjs/ember.js/blob/master/packages/ember-views/lib/system/event_dispatcher.js#L48-73)中。如您所见，您必须将现有的事件处理程序重命名为`keyUp`,`focusIn`和`focusOut`.

其他事件默认情况`blur`下`paste`不处理，这就是`customEvents`on`Ember.Application`的用途，请参阅[http://jsfiddle.net/pangratz666/CHVRt/](http://jsfiddle.net/pangratz666/CHVRt/)

```
App = Ember.Application.create({
    customEvents: {
        blur: 'blur',
        paste: 'paste'
    }
}); 
```

# sql - 将类型和它们之间的纯函数（以类似 ML 或类似 Haskell 的语言）编译为 SQL

> ID：10213254
> 
> 赞同：3
> 
> 时间：2012-04-18T15:56:04.997
> 
> 标签：sql, functional-programming, ml

有时我们需要存储二叉树或森林或其他代数类型的数据项集。可以通过某种方式完成。**最好也仅**使用 SQL 对这些数据执行一些转换（例如，重新平衡二叉树）。

我对一种在它们之间声明类型和纯函数的方法（用类似 ML 或类似 Haskell 的语言）并将它们编译为 SQL 感兴趣；我希望，它可以让我重用标准算法的代码，例如hedge_union。它存在吗？可能是，这个编译器已经实现了（但是我不能谷歌它），或者 Coq 中的库存在，它可以提取 SQL 中的代码，或者其他东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T13:07:31.307

参见最近关于从嵌入式函数式语言（如[Ferry](http://db.inf.uni-tuebingen.de/staticfiles/publications/ferryhaskell.pdf) ）生成 SQL 的研究工作——本质上是类型化的、语言集成的查询。

另请参阅：[Ferry — 数据库支持的程序执行](http://www-db.informatik.uni-tuebingen.de/projects/ferry.html)和[DSH — 数据库支持的 Haskell](http://www-db.informatik.uni-tuebingen.de/projects/databasesupportedhaskell.html)。

# ruby-on-rails - Rails 3 - rake 任务以处理多个数据库连接

> ID：10213255
> 
> 赞同：0
> 
> 时间：2012-04-18T15:56:09.163
> 
> 标签：ruby-on-rails

假设我有不同的数据库连接......

现在为了这个例子的目的，让我们只关注开发。当我运行“rake db:setup”时，它只会创建开发，因为从 rake 任务的角度来看，另一个连接是另一个环境。我可以传入另一个连接作为 RAILS_ENV 来创建数据库。但是，问题在于我们如何定义数据库连接。我宁愿不撤消此操作，因为它使管理和部署更加容易。我们所做的是这...

在我们的 database.yml 中，我们添加了以下代码。

```
databases_file = File.join(Rails.root.to_s, "config", "databases", "#{Rails.env.to_s}.yml")
IO.read(databases_file) if File.exist?(databases_file) 
```

然后在 config 下的数据库子文件夹中，我们创建了不同的环境 yml 文件。

所以在 development.yml 我们有...

```
development:
  ... details ...

logging:
  ... details ... 
```

现在，如果我将 RAILS_ENV 设置为“日志记录”，它将永远不会加载该文件，因为该文件称为 development.yml。因此它永远不会找到日志连接。

如果我将所有这些设置合并回 database.yml 文件，那么我们将回到不将 database.yml 签入 git repo 并且必须在开发机器上为新员工等手动创建它。我们还必须更改我们的部署过程以开始将文件放置在较低的环境中。（我们的生产过程已经支持这一点）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:10:51.473

我们有多个数据库，我们大量使用分支......所以我想出了这个解决方案来创建多个数据库并将它们的名称与正在处理的分支联系起来......

```
# config/database.yml
<%=
    databases_file = File.join(Rails.root.to_s, "config", "databases", "#{Rails.env.to_s}.yml")
  if Rails.env.development? || Rails.env.test?
    branch = ENV['BRANCH'] || `git branch --no-color 2> /dev/null`.chomp.split("\n").grep(/^[*]/).first[/(\S+)$/,1].sub("-", "_")
    puts "Using databases for #{branch}"
    IO.read(databases_file).gsub!("<branch>", branch) if File.exist?(databases_file)
  else
    IO.read(databases_file) if File.exist?(databases_file)
  end
%> 
```

然后为每个环境创建一个数据库文件。在 development.yml 和 test.yml 中，您使用令牌让该脚本查找它需要什么来进行替换。所以一个示例文件看起来像这样。

```
# config/databases/development.yml
development:
  adapter: mysql2
  host: 127.0.0.1
  database: <branch>_dev
  username: user
  password: pass

versions:
  adapter: mysql2
  host: 127.0.0.1
  database: <branch>_versions
  username: user
  password: pass

reporting:
  adapter: mysql2
  host: 127.0.0.1
  database: <branch>_reporting
  username: user
  password: pass

ods:
  adapter: mysql2
  host: 127.0.0.1
  database: <branch>_ods
  username: user
  password: pass 
```

然后我扩展了 rake 任务以处理多个数据库

这是大部分工作的内容。因此，我将把它排除在答案之外，让你为它工作！实际上，不，这只是一个大混乱，我并不为此感到自豪，并且很想花时间修复它，但还没有找到任何东西。我不想把任何人引向错误的道路，但如果您有任何问题，请给我留言，我很乐意提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:03:19.707

您可以使用环境变量来管理这些。您可以有一个单独的 database.yml，其中定义了以下内容：

```
development:
  database: ENV['DEVELOPMENT_DATABASE'] 
```

然后在你的`.bashrc/.zshrc`.

# api - Foursquare 场地/搜索不返回完整的类别列表

> ID：10213260
> 
> 赞同：3
> 
> 时间：2012-04-18T15:56:25.113
> 
> 标签：api, foursquare

例如，在此请求中，我正在寻找 categoryId=4bf58dd8d48988d1e8941735（棒球场）的场地：[https ://developer.foursquare.com/docs/explore#req=venues/search%3Fll%3D40.7,-74%26categoryId %3D4bf58dd8d48988d1e8941735](https://developer.foursquare.com/docs/explore#req=venues/search%3Fll%3D40.7,-74%26categoryId%3D4bf58dd8d48988d1e8941735)

结果，每个场地只有一个（主要）类别。场地/搜索请求中是否可以返回完整场地的类别列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:14:16.470

抱歉不行。

出于性能考虑，这实际上是设计使然。在我们返回许多 JSON 项目（例如场所/搜索）的上下文中，我们只提供“紧凑”JSON 以降低整体响应大小，因为它是服务和处理请求成本的重要贡献者。特别是场所/搜索是我们流量最高的端点之一。

如果您想了解有关场所/搜索中特定结果的更多详细信息，您应该查询场所详细信息端点 (/venues/[VENUE-ID])，它将返回完整的类别列表。

# c# - 如何使用特定（非默认）类打开文件/协议

> ID：10213262
> 
> 赞同：1
> 
> 时间：2012-04-18T15:56:33.717
> 
> 标签：c#, .net, winapi, shellexecute

StackOverflow 上有几个问题，类似于“如何在 C# 中使用 ShellExecute/ShellExecuteEx？”，答案几乎是：“使用 System.Diagnostics.Process”。但是，我想做的是使用*非*默认处理程序打开文件或 URL。

我可以通过传入类名并设置[SEE_MASK_CLASSNAME 标志](http://msdn.microsoft.com/en-us/library/bb759784%28v=vs.85%29.aspx)来使用 ShellExecuteEx 完成此操作，并且我使用 DllImport 进行此工作。

我想知道的是：有没有办法在 C# 中做到这一点而无需从 DLL 导入？有没有办法将这种信息传递给 Process，或者我让它工作的方式是“正确”的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:03:30.513

在 .NET 中没有等效的方法。您的处理方式（使用 ShellExecuteEx）是正确的方式。

# jquery - jqgrid分页不起作用

> ID：10213276
> 
> 赞同：1
> 
> 时间：2012-04-18T15:57:02.617
> 
> 标签：jquery, jqgrid

我有一个 js 文件并将参数传递给一个 webmethod，它以 json 格式返回输出。只显示第一页。大约有 100 条记录，仅显示 20 条记录。我需要在后续页面中显示其他记录。我尝试在表格之后添加一个 div 标签

```
<div id="pager12" class="scroll" style="text-align:center;></div> 
```

然后在 jqgrid 中`function $('#SearchForComp).jqGrid()`，我添加了这一行 `pager: jQuery('#pager12')`。这足以在页面中显示输出还是我应该添加任何内容？它不工作。

谢谢

jquery 看起来像这样

```
$("#SearchForComp").jqGrid({
    scroll: true,
    treeGrid: true,
    altRows: true,
    treeGridModel: 'adjacency',
    ExpandColumn: 'DISPLAY_NAME',
    datatype: function (postdata) {
        postdata.deptSeqNo = null;
        postdata.searchString = $("#SearchForComp").val().trim();

        $.ajax({
            type: "POST",
            url: 'Department.aspx/compsearch',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            data: JSON.stringify(postdata),
            complete: completeUserSearch
        });
    },
    mtype: "POST",

    colModel: [{ name: 'KEY_FIELD', index: 'KEY_FIELD', width: 1, hidden: true, key: true },
               { label: 'Department/Name', name: 'DISPLAY_NAME', index: 'DISPLAY_NAME', width: 200, resizable: false, sortable: false },
               { label: 'Telephone', name: 'DISPLAY_PHONE', index: 'DISPLAY_PHONE', width: 150, align: 'center', resizable: false, sortable: false },
               { label: 'Email', name: 'DISPLAY_EMAIL', index: 'DISPLAY_EMAIL', width: 225, align: 'center', resizable: false, sortable: false, formatter: 'email'}],
    treeIcons: { plus: 'ui-icon-plus', minus: 'ui-icon-minus', leaf: 'ui-icon-radio-off' },
    height: 'auto',
    caption: "User Search",
    treeReader: {
        level_field: "TREE_LEVEL",
        parent_id_field: "PARENT_ID",
        leaf_field: "IS_LEAF",
        expanded_field: "EXPANDED"
    },
    jsonReader: {
        root: "Data",
        page: "CurrentPage",
        total: "TotalPages",
        records: "TotalRecords",
        repeatitems: false,
        id: "0",
        userdata: "UserData"

    },

    beforeSelectRow: function (id, e) { return false; },
 }); 
```

我调用了一个 web 方法“compsearch”，它以 json 格式返回数据，然后将其显示给用户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:29:52.877

可能您没有定义[rowNum](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aoptions)选项，因此将使用默认值`20`。通常，如果您正确实施服务器端数据分页，这不是问题。如果您不想在服务器端实现数据分页和过滤，您可以`loadonce: true`向 jqGrid 添加选项。在这种情况下，该`datatype`选项将更改为`'local'` *自动*，并且无需与您的服务器进行额外通信即可完成分页。不仅如此，您还可以使用[工具栏过滤器](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3atoolbar_searching)或[高级搜索](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aadvanced_searching)`loadonce: true`在一行中实现数据过滤。

# php - 进行ajax调用，如果不是想要的结果，提取一个值，然后不断重复直到达到想要的结果

> ID：10213280
> 
> 赞同：0
> 
> 时间：2012-04-18T15:57:11.063
> 
> 标签：php, javascript, html, ajax

如果没有达到预期的结果，是否有任何方法可以进行 ajax 调用，提取一个值并每隔 X 秒（或根据用户请求）不断重复，直到达到预期的结果？

调用的响应以 json 序列化数组的形式呈现。我希望 ajax 调用不断重复，直到`$status_code`is`1`或 response == `"error_bad_api_call"`。

*剪掉旧代码*

**更新：（**答案）

**我们要调用的 PHP 脚本（10% 的机会提供预期的结果）**：

```
<?php

$retArr = array();
$rand = rand(1, 1000);

if($rand < 100)
{
    $retArr["status_code"] = 1;
    echo json_encode($retArr);
}
else
{
    $retArr["status_code"] = 0;
    echo json_encode($retArr);
}

?> 
```

**javascript + html**：

```
<html>
<head>
<script src="include/jquery-1.7.2.min.js"></script>
<script src="include/jquery.json-2.3.min.js"></script>
<script type="text/javascript">
//Clean all elements on button click
function dosubmitClean(tries)
{
    document.getElementById("resultsHere").innerHTML="";
    document.getElementById("temp").innerHTML="";
    document.getElementById("tries").innerHTML="";

    dosubmit(tries); //Do actual work
}

function dosubmit(tries)
{
    if (window.XMLHttpRequest){// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else{// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function(){
        if (xmlhttp.readyState==4 && xmlhttp.status==200){
            var resp = xmlhttp.responseText; //Get response
            document.getElementById("temp").innerHTML+="resp: "+xmlhttp.responseText+"<br/>"; //Show in event log

            var status_code = $.evalJSON(resp).status_code; //Get status code
            document.getElementById("temp").innerHTML+="status_code: "+status_code+"<br/>"; //Show in event log

            document.getElementById("temp").innerHTML+="Checking status code <br/>"; //Show in event log
            if(status_code == "1"){
                document.getElementById("resultsHere").innerHTML+="status_code: is one <br/>"; //Show final result
                document.getElementById("temp").innerHTML+="status_code: is one <br/>"; //Show in event log
                document.getElementById("tries").innerHTML="Amount of tries: "+tries+"<br/><br/>Event log:<br/>"; //Show amount of tries
            }
            else{
                document.getElementById("temp").innerHTML+="status_code: is NOT one <br/>"; //Show in event log
                tries++; //Tries + 1
                dosubmit(tries,"someval"); //Loop
            }
            document.getElementById("temp").innerHTML+="Done checking status code <br/><br/>"; //Show in event log
        }
    }
    xmlhttp.open("GET","json_repeat_php.php",true);
    xmlhttp.send();
}
</script>
</head>
<body>

<input type="submit" value="submit" id="postDataSubmit" onClick="dosubmitClean(<?php echo 1; ?>);return false;">

<div id="resultsHere"></div>
<div id="tries"></div>
<div id="temp"></div>
</body>
</html> 
```

示例输出：

```
status_code: is one
Amount of tries: 2

Event log:
resp: {"status_code":0}
status_code: 0
Checking status code
status_code: is NOT one
Done checking status code

resp: {"status_code":1}
status_code: 1
Checking status code
status_code: is one
Done checking status code 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T20:34:31.230

这很容易。你已经有了回调函数，等待结果。

现在，不再像当前那样将结果返回为 html，而是将其返回为 JSON，以便您可以轻松地在客户端对其进行评估。`elseif{...}`在您的 php 代码中包含必要的 queueCodes 。

这可能是这样的（注意，这只是伪代码！）：

```
your json = { success : 0|1 , resultarray [item,item] /* only if success=1 */ , someMoreInfo : <queueCode> }

if ( success ){
     // populate your html with the resulting items
}
else{
     //perhaps wait some time, then
     // call your ajax function again, with your queuecode as parameter
     dosubmit( json.someMoreInfo );
} 
```

并且您的`dosubmit`函数将队列代码发送到您的服务器。

超时可能有用，无论是在服务器上还是客户端上，都更适合您。

此外，您可能想看看[JSONP](http://en.wikipedia.org/wiki/JSONP)

**旁注：** 在 php 的 elseif 分支中使用开关可能更合适。另外，尽量避免`{`在你的 javascript 代码中写在换行符上，而是总是写`function(){`or `else{`。这可能会为您尝试评估您的代码的 javascript 编译器节省一些麻烦。

例子：

```
return{
   object
}
// returns the object 
```

应该相同，但不一样：

```
return // comiler will add a ; after your return, thus your object won't be returned
{
   object
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T20:40:49.947

是的，您可以递归地执行此操作。

```
function send_request() 
{
    // perform ajax here and have a callback 
    // if value from callback indicates not successful call send_request() again
    send_request(); 
    // you may want to keep a count of how many times it fails, if it fails say, more than a set number of times then you can take the appropriate action 
}

send_request(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T06:40:21.787

不知道问题出在哪里，但如果我理解正确的话，你就足够了：

```
function gather(queue) {
    data = $('form#foo').serialize();
    if (typeof queue != 'undefined') {
        data += '&queue=' + queue;
    } else {
        queue = 0;
    }
    $.ajax('/frontend_test.php', data, function(r) {
        var result = $.parseJSON(r);
        if (typeof result.status_code == 'undefined' || result.status_code != 1) {
            gather(++queue);
        } else {
            // Success, do whatever you need to.
        }
    }); 
```

并且仅通过调用来使用它......它的结果不会达到 - 它使用递增队列进行递归调用，第一次调用不需要任何参数。

希望这正是您所需要的。

# extjs4 - ExtJS 4：将子树节点动态添加到非根节点？

> ID：10213281
> 
> 赞同：0
> 
> 时间：2012-04-18T15:57:13.333
> 
> 标签：extjs4

我试图在选择非根节点时动态地将子树节点添加到它。

这就是我实现它的方式：

首先，我用 TreeStore 填充我的树，然后动态添加子树节点，我在树控制器中的 itemexpand 事件上处理它。

```
//pThis is a NodeInterface obj of the selected node
itemexpand: function (pThis, pEOpts) {
      //type is an attribute that I added so that I know what type of node that got selected
      if (pThis.raw.type === 'Staff' && !pThis.hasChildNodes()) {
                    var staffNodeAry = [{text:"Teachers", type:"ChildStaff", leaf: false},
                                                     {text:"Principals", type:"ChildStaff", leaf: false}];          
                     pThis.appendChild(staffNodeAry); 
       }
} 
```

这工作得很好，因为我能够在“员工”类型下看到“教师”和“校长”节点，但到目前为止我发现了 2 个问题：

1）控制台上有这个错误：

未捕获的类型错误：无法读取未定义的属性“internalId”

我不知道为什么，但如果有人能启发，那就太好了。

2) 当我展开“Teachers”和“Principals”时，itemexpand 返回的 NodeInterface obj 有一个未定义的原始对象。

所以我不能这样做：pThis.raw.type

据我了解，我不需要创建一个新的 TreeStore 来添加任何新的子节点，我认为通过创建一个遵守 NodeInterface 的对象数组就足够了，但我可能错了。如果有人能指出我正确的方向，那就太好了。

汉地

**更多信息：**

我所做的实际上是遵循 ExtJs 4 文档，所以我相信这是 ExtJs 4 框架上的一个错误。

我还用 Extjs-4.1.0-rc3 对此进行了测试，它也产生了同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T08:15:42.847

.appendChild() 函数的文档说：

```
node : Ext.data.NodeInterface/Ext.data.NodeInterface[]
The node or Array of nodes to append 
```

您正在尝试附加 2 个对象的数组，但它们不是“NodeInterface”实例。所以你应该像这样正确地创建它们：

```
var nodeToAppend1 = pThis.createNode({text:"Teachers", type:"ChildStaff", leaf: false});
pThis.appendChild(nodeToAppend1); 
```

我记得一年前犯了同样的错误，所以我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T17:09:22.993

I have resolved this issue changing the event **itemexpand** with the event **afteritemexpand**. I have no documentation to justify this. The debugger says to me that the view listen for the itemexpand event and do something that goes wrong if add a node manually...

For the question number 2: you have no raw object because it is created by the reader of the store after the load operation. So if you add a node by hand the raw object does not exists.

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Model-property-raw](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Model-property-raw)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T06:23:00.153

我认为这是因为您的 Ext.TreePanel 异步工作。所以添加过程是：

1.  附加子节点，将虚拟子叶添加到您的树中，角落带有红色标记
2.  调用 store 的 create api
3.  接收响应，如果success=true，用virtual改变

更改的目标是设置 internakId 属性，因此您只能在更改发生后添加新的孩子。我认为更好的是编写一些递归函数并将其绑定到商店添加的事件

```
 tree.getStore().on('update', addChild); 
```

或者

```
tree.getStore().load({
  success: function() { 
     addChild()
  }); 
```

# mysql - Sql 默认国家、城市、城镇列表

> ID：10213282
> 
> 赞同：1
> 
> 时间：2012-04-18T15:57:13.553
> 
> 标签：mysql, sql, sql-order-by

我想在我的管理面板中的每个数据库网格中带来默认国家默认城市默认城镇
这些不是下拉这些是数据库网格

我有三个表
**国家表** id(int),name(varchar),is_default enum('1','0')

**城市表**
id(int),country_id(int),name(varchar),is_default enum('1','0')

**城镇表**
id(int),countr_id(int),city_id(int),name(varchar),is_default enum('1','0')

我的管理面板中有 3 个链接
国家列表
城市列表
城镇列表

**国家/地区列表**
- 当我打开国家/地区列表时，它会显示列表，但默认国家/地区会排在第一位

**国家/地区默认值**
USA 是（由于 is_dfault=1，它位于第一行）
德国 否

没关系
Select * from country where is_default='1'

**城市列表**
当我打开那个列表时

*   城市列表将带有自己的县名，但默认国家将出现在第一行

*   并且默认城市将在城市列表页面中此默认国家/地区的首位

    选择 city.*,country.name 作为国家
    左加入国家在 country.id=city.id
    order by country.is_default,city.is_default asc 那是
    错误的 sql 我知道
    示例
    **城市名称国家默认**
    新泽西州美国是（这个城市来第一行，因为它的 is_default=1) Chicago
    USA no
    koln Germany no (德国城市在美国城市之后开始，因为国家默认=1)

**城镇列表**

*   is_default 值 1 城镇将首先出现，第一行是自己的城市城镇
    示例
    **城镇名称城市名称国家默认**
    美国城镇新泽西州美国 1（这个城镇出现在第一行，因为它的 is_default=1）在美国城镇
    德国城镇 1 科隆德国 0 之后（德国或其他国家城市在美国城镇之后开始）

我认为我的问题在于订单（按 is_default 排序），或者我需要不同的 sql 和
其他
选择
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-22T02:26:39.307

我不知道我是否明白你的意思，我试着给出一个答案。

我认为混合国家或其他列的加入条件是错误的。你的sql在这里：

```
Select city.*,country.name as country 
    left join country on country.id=city.id
    order by country.is_default,city.is_default asc 
```

以上是您发布的内容，因为它不完整，我猜您的加入条件“on country.id=city.id”是错误的。如果你想结合这两个表，在它的国家 ID 上，你应该

```
SELECT city.*, county.name AS country_name from 
     country LEFT JOIN city ON country.id = city.country_id
     ORDER BY country.is_default, city.is_default DESC 
```

因为“is_default”是 1，所以我使用“DESC”，然后默认行首先弹出。

我希望这对你有帮助:)

# java - 共享文件而不将其保存在外部存储上

> ID：10213296
> 
> 赞同：3
> 
> 时间：2012-04-18T15:58:25.433
> 
> 标签：java, android, file, save

我正在使用以下代码允许用户共享位图，

```
try {

                    File save_dir = Environment.getExternalStorageDirectory();

                    FileOutputStream out = new FileOutputStream(save_dir
                            + "/test.jpg");

                    final_bitmap.compress(Bitmap.CompressFormat.JPEG, 100, out);

                    Intent share = new Intent(Intent.ACTION_SEND);
                    share.setType("image/jpeg");

                    share.putExtra(Intent.EXTRA_STREAM,
                            Uri.parse("file:///" + save_dir + "/test.jpg"));

                    startActivity(Intent.createChooser(share,
                            getString(R.string.share_dialog_title)));

                } catch (Exception e) {
                    Toast.makeText(mainActivity, "Error in sharing.",
                            Toast.LENGTH_LONG).show();
                } 
```

问题是，如果设备没有 SD 卡，文件将不会被保存。

有什么好的方法可以将它保存到内部存储中，其他应用程序可以访问的地方，因为将它保存在应用程序数据目录中不会允许其他应用程序访问它。

问候

# javascript - 结合两个独立函数的结果？

> ID：10213299
> 
> 赞同：0
> 
> 时间：2012-04-18T15:58:32.623
> 
> 标签：javascript, jquery, .net, dotnetnuke

*   利用 ASP 和 DotNetNuke 循环遍历重复单选按钮的列表。
*   使用 jQuery
*   当前显示 weightCalculations 函数的正确结果值（例如：3）
*   如何将 rbtCalculations 结果与 weightCalculations 结果结合起来？
*   例如：如果 rbtCalculations = 非常高并且 weightCalculations = 高 THEN $('p.custom' + ID).text("5");

    ```
    <input id="rbt_0" name="rbt" value="Very High" checked="checked" onclick="rbtCalculations(this,6559);" type="radio">
    <input id="rbt_1" name="rbt" value="High" onclick="rbtCalculations(this,6559);" type="radio">

    <input id="stakeholders_rbt_0" name="stakeholders_rbt" value="Very High" onclick="weightCalculations(this,6559);" type="radio">
    <input id="stakeholders_rbt_1" name="stakeholders_rbt" value="High" checked="checked" onclick="weightCalculations(this,6559);" type="radio">
    <input id="stakeholders_rbt_2" name="stakeholders_rbt" value="Low to Moderate" onclick="weightCalculations(this,6559);" type="radio">

    <p class="custom6559">3</p>

    <script type="text/javascript">
        function weightCalculations(value, ID) {
            if (value.value == "High") {
                $('p.custom' + ID).text("3");
            }
            else {
                $('p.custom' + ID).text("2");
            }
    } 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:11:58.720

```
function weightCalculations(value, ID) {
        if (value.value === "High" && $('input[name="rbt"]').val() === "Very High") {
            $('p.custom' + ID).text("5");
        }
        else if(value.value === "High"){
            $('p.custom' + ID).text("3");
        }
        else {
            $('p.custom' + ID).text("2");
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T18:08:52.393

我可能只是`class`在单选按钮中添加一个来识别它们，并添加一个包装元素来将所有部分关联在一起：

```
<div class="js-weight-calc-wrap">
    <input type="radio" class="js-rbt" ... />
    <input type="radio" class="js-rbt" ... />

    <input type="radio" class="js-weight" ... />
    <input type="radio" class="js-weight" ... />
    <input type="radio" class="js-weight" ... />

    <p class="js-result custom6559"></p>
</div>

<script>
jQuery(document).ready(function ($) {
    $('.js-rbt, .js-weight').change(function () {
        var $this = $(this),
            $wrap = $this.closest('.js-weight-calc-wrap'),
            rbtVal = $wrap.find('.js-rbt:checked').val(),
            weightVal = $wrap.find('.js-weight:checked').val(),
            result = rbtVal === 'VeryHigh' && weightVal === 'High' 
                     ? '5'
                     : rbtVal === 'VeryHigh' && weightVal === 'Low'
                         ? '4'
                         : '0';
        $wrap.find('.js-result').text(result)
    });
});
</script> 
```

我也可能最终创建一个 jQuery 插件来包含所有这些逻辑，所以在你的页面上它只是这样的调用：

```
jQuery(function ($) { 
    $('.js-weight-calc-wrap').weightCalculator({
        rbtSelector: '.js-rbt',
        weightSelector: '.js-weight',
        resultSelector: '.js-result'
    });
}); 
```

## 更新

我之前忘记了您需要在选择单选按钮时对其进行过滤，以便您仅获得选中的单选按钮（与`<select/>`元素混淆）。添加`:select`到选择器后，它按预期工作。我把它清理了一点，并创建了一个[工作 jsFiddle](http://jsfiddle.net/bdukes/KKsB2/)。

# algorithm - 用于池化整数的高效数据结构

> ID：10213302
> 
> 赞同：1
> 
> 时间：2012-04-18T15:58:41.300
> 
> 标签：algorithm, optimization, data-structures

我正在寻找一种数据结构来帮助我管理整数池。这是一个池，我从池中删除整数一会儿，然后将它们放回原处，期望它们会再次被使用。但是，它还有一些其他奇怪的限制，因此常规池不能很好地工作。

硬性要求：

*   恒定时间访问最大的使用整数。
*   整数的稀疏性需要有界（即使只是原则上）。
    我希望整数彼此接近，因此我可以使用范围内最少的未使用整数快速迭代它们。

如果它们有助于选择数据结构，请使用它们，否则请忽略它们：

*   池中的整数基于 0 且连续。
*   池的大小可以是恒定的。
*   池中的整数仅用于短期高流失率。

我有一个可行的解决方案，但感觉不优雅。
*我的（次优）解决方案*

恒定大小的池。
将所有可用的整数放入一个有序集合（free_set）。
当请求一个新整数时，从 free_set 中检索最小的整数。
将所有使用中的整数放入另一个排序集（used_set）。
当请求最大时，从 used_set 中检索最大的。

有一些优化可能有助于我的特定解决方案（优先队列、记忆等）。但我的整个方法似乎很浪费。

我希望有一些深奥的数据结构完全适合我的问题。或者至少是更好的池化算法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T19:37:21.897

为什么不使用平衡二叉搜索树？您可以存储指向 min 元素的指针/迭代器并免费访问它，并在插入/删除后更新它是 O(1) 操作。如果你使用自平衡树，插入/删除是 O(log(n))。详细说明：

> **insert**：只需将新元素与前一个元素进行比较；如果最好使迭代器指向新的最小值。
> 
> **delete**：如果 min 被删除，则在删除之前找到后继者（您可以通过将迭代器向前移动 1 步来完成），然后将该人作为新的 min。

虽然理论上可以使用某种复杂的超级堆数据结构（即斐波那契堆）做得更好，但在实践中，我认为您不会为了节省一个小日志因子而想要处理实现类似的东西。此外，作为奖励，您可以免费获得快速的顺序遍历——更不用说现在大多数编程语言^都带有开箱即用的自平衡二叉搜索树的快速实现（如红黑树/avl等.)。

^ 除了 javascript :P

*编辑：想到一个更好的答案。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:11:04.430

伪类：

```
class IntegerPool {

  int size = 0;
  Set<int> free_set = new Set<int>();

  public int Acquire() {
    if(!free_set.IsEmpty()) {
      return free_set.RemoveSmallest();
    } else {
      return size++;
    }
  }

  public void Release(int i) {
    if(i == size - 1) {
      size--;
    } else {
      free_set.Add(i);
    }
  }

  public int GetLargestUsedInteger() {
    return size;
  }
} 
```

**编辑**

`RemoveSmallest`并不是那么有用。`RemoveWhatever`已经足够好了。所以`Set<int>`可以替换`LinkedList<int>`为更快的替代方案（甚至`Stack<int>`）。

# windows - 如何在 Windows 上从 code.google 克隆项目

> ID：10213304
> 
> 赞同：2
> 
> 时间：2012-04-18T15:58:49.597
> 
> 标签：windows, mercurial, google-code

看到我需要从这个页面下载代码

[http://code.google.com/r/steverauny-treeview/source/checkout](http://code.google.com/r/steverauny-treeview/source/checkout)

显示克隆

```
hg clone https://code.google.com/r/steverauny-treeview/ 
```

在我的 linux 机器上我已经安装`hg` ，然后这个命令工作，我在我的机器上得到了那个项目的副本

但是如何在Windows机器上得到这个？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T02:20:46.053

下载并安装[TortoiseHg](https://tortoisehg.bitbucket.io/)。

运行相同的命令：

```
C:\>hg clone https://code.google.com/r/steverauny-treeview TreeView
requesting all changes
adding changesets
adding manifests
adding file changes
added 44 changesets with 255 changes to 111 files
updating to branch default
98 files updated, 0 files merged, 0 files removed, 0 files unresolved 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T16:03:32.047

使用[Windows Mercurial 安装程序之一。](http://mercurial.selenic.com/downloads)

# asp.net-mvc - 如何将数据保存到 MVC3 中的 DataTable 中？

> ID：10213307
> 
> 赞同：0
> 
> 时间：2012-04-18T15:58:55.340
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-view-controller

我有 mvc3 应用程序，我使用了两个部分视图 1.controls 2.webgrid

在控件内部，我正在从实际的数据库表中填充下拉列表。使用英孚

在 index.cshtml 上，我有一个表单需要从这些下拉列表中选择值，当按下插入按钮时，这些值必须转到 Temp“DataTable”并在 webgrid 中显示...我是 MVC3 的新手，并且不知道该怎么做。

```
Controls.cshtml
@model Mapping.Models.SecurityIdentifierMappingViewModel
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Mapping</legend>
        <div class="editor-label">
            @Html.Label("Pricing SecurityID")
        </div>
        <div class="editor-field">
            @Html.HiddenFor(model => model.MappingControls.Id)
            @Html.DropDownListFor(model => model.MappingControls.PricingSecurityID,
         new SelectList(Model.PricingSecurities, "Value", "Text"),
         "Select SecurityID"
            )
            @Html.ValidationMessageFor(model => model.MappingControls.PricingSecurityID)
        </div>
        <div class="editor-label">
            @Html.Label("CUSIP ID")
        </div>
        <div class="editor-field">
            @Html.DropDownListFor(model => model.MappingControls.CUSIP,
         new SelectList(Model.CUSIPs, "Value", "Text"),
            "Select CUSIP"
            )
            @Html.ValidationMessageFor(model => model.MappingControls.CUSIP)
        </div>

        <div class="editor-label">
            @Html.Label("Calculation")
        </div>
        <div class="editor-field">
            @Html.TextBoxFor(model => model.MappingControls.Calculation)
            @Html.ValidationMessageFor(model => model.MappingControls.Calculation)
        </div>
        <p>
            <input id="btnsubmit" type="submit" value="Insert" />

        </p>
    </fieldset>
}

HomeController.cs
public class HomeController : Controller
    {
        //
        // GET: /Home/

        mydataEntities dbContext = new mydataEntities();
        DataRepository objRepository = new DataRepository();

        //GET

        public ActionResult Index(string userAction , int uid = 0)
        {
            var mappingobj = new SecurityIdentifierMappingViewModel();
            mappingobj.MappingWebGridList = dbContext.SecurityIdentifierMappings.ToList();

                mappingobj.MappingControls = new SecurityIdentifierMapping();
                mappingobj.MappingControls.PricingSecurityID = 0;
                mappingobj.MappingControls.CUSIP = string.Empty;

            mappingobj.PricingSecurities = objRepository.GetPricingSecurityID();
            mappingobj.CUSIPs = objRepository.GetCUSIP();

            return View(mappingobj);
        }

        //POST

        [HttpPost]
        public ActionResult Index(SecurityIdentifierMappingViewModel objModel)
        {

            if (objModel.MappingControls.Id > 0)
            {
                if (ModelState.IsValid)
                {
                    dbContext.Entry(objModel.MappingControls).State = EntityState.Modified;
                    try
                    {
                        dbContext.SaveChanges();
                        //objModel = new SecurityIdentifierMappingViewModel();
                        //return RedirectToAction("Index", "Home");
                    }
                    catch (System.Data.Entity.Validation.DbEntityValidationException ex)
                    {
                        throw;
                    }
                }

            }

            //insert code
            else
            {
                if (ModelState.IsValid)
                {
                    dbContext.SecurityIdentifierMappings.Add(objModel.MappingControls);
                    try
                    {
                        dbContext.SaveChanges();
                    }
                    catch (System.Data.Entity.Validation.DbEntityValidationException ex)
                    {
                        throw;
                    }
                }

            }

            return RedirectToAction("Index");
        }
    }

public class SecurityIdentifierMappingViewModel
{
    public IEnumerable<SecurityIdentifierMapping> MappingWebGridList { get; set; }
    public SecurityIdentifierMapping MappingControls { get; set; }

    public List<SelectListItem> PricingSecurities { get; set; }
    public List<SelectListItem> CUSIPs { get; set; }
} 
```

目前使用 SecurityIdentifierMapping 作为数据库中的第三个表，其中插入我的表单数据......但需要将其插入“DataTable”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:46:58.037

您必须创建一个 DataTable 对象并为其分配适当的 DataColumn 对象。之后，将您的 SecurityIdentifierMapping 属性映射到临时数据表中的列。至于将 DataTable 映射到 WebGrid，我不会说这是不可能的，因为我从未亲自尝试过这个东西，但是您必须将它映射回 SecurityIdentifierMapping 的集合。

但是，为什么需要 DataTable？与 IQueryable 或 IEnumerable 相比，DataTable 有哪些可能的优势？您真正想使用此策略实现什么目标？

更新：

您已经在 ViewModel 类 (SecurityIndentifierMappingViewModel) 中使用了 IEnumerable。同时，您在 POST 到 Index 时将数据存储在数据库中，并在 GET 版本的 Index 中再次获取。

您缺少的是在您的视图中创建一个 WebGrid 对象。您的视图可以这样定义：

```
@{
    var columns = new List<string>();
    columns.Add("Column 1");
    columns.Add("Column 2");

    var grid = new WebGrid(model: Model.MappingWebGridList, columnNames: columns);
 }

 @grid.GetHtml() 
```

将上面的代码放在您的索引视图中的某个位置，并定义您自己的列。另外，看看我写的这篇文章，以获得更多关于 WebGrid 可以做什么的想法[http://apparch.wordpress.com/2012/01/04/webgrid-in-mvc3/](http://apparch.wordpress.com/2012/01/04/webgrid-in-mvc3/)。

我希望我能至少对你有所帮助。

# svn - 仅使用 subversion 提交修改过的文件

> ID：10213308
> 
> 赞同：2
> 
> 时间：2012-04-18T15:59:01.940
> 
> 标签：svn, unix, commit, ack, svncommit

我有一长串要提交的提交，因此，我想错开提交。所以，当我这样做时：

> svn st | 确认'^M'

我只想提交这些*文件*

这可以通过命令行实现吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-19T11:21:04.040

[xargs 命令](https://en.wikipedia.org/wiki/Xargs)对这种事情很有用。

假设您没有任何包含空格字符的文件名，您可以执行以下操作：

```
svn st | sed -n 's/^M//p' | xargs svn commit 
```

如果文件名中确实有空格字符，则`sed`命令会变得有点复杂，要在每个文件名周围添加引号：

```
svn st | sed -n 's/$/"/; s/^M */"/p' | xargs svn commit 
```

（我不熟悉`ack`——也许它也可以用来代替`sed`这些例子）

# android - 插入后检索自增值

> ID：10213311
> 
> 赞同：3
> 
> 时间：2012-04-18T15:59:11.760
> 
> 标签：android, android-intent, sqlite

这是我用来将一些数据插入数据库的插入方法：

```
public long insertBooking(String userId,int roomId,Timestamp checkInTime, Timestamp checkOutTime){
    final SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
    ContentValues contentValues=new ContentValues();

    contentValues.put(USER_ID, userId);
    contentValues.put(ROOM_ID, roomId);
    contentValues.put(CHECK_IN, dateFormat.format(checkInTime));
    contentValues.put(CHECK_OUT, dateFormat.format(checkOutTime));

    return database.insert(MRM_BOOKING_DETAILS_TABLE, null, contentValues);

} 
```

MRM_BOOKING_DETAILS表有一个名为 booking_id 的自动**增量****字段**。插入新行后，该列的值加1。是否可以在上述方法本身中插入完成后返回该行的**booking_id ，而无需编写单独的选择查询？**

或者，我是否必须编写一个单独的 SQL Select 查询来返回该新插入行的**booking_id ？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T16:03:58.257

**long insertId = database.insert(MRM_BOOKING_DETAILS_TABLE, null, contentValues);** 此行本身返回插入行的 booking_id ...

# iphone - 重命名持久存储协调器 URL

> ID：10213312
> 
> 赞同：6
> 
> 时间：2012-04-18T15:59:12.353
> 
> 标签：iphone, objective-c, ios, core-data

我的 coredata 持久存储有一个（可能）很容易解决的问题。

我创建了它：

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{

    if (persistentStoreCoordinator != nil)
    {
        return persistentStoreCoordinator;
    }

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"dummyURL.sqlite"];

    NSError *error = nil;
    persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    if (![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:nil error:&error])
    {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }  

    return persistentStoreCoordinator;
} 
```

使用网址`dummyURL.sqlite`

我在使用该项目的第一天就这样做了，忘记重命名它.. 现在我所有当前的测试设备 (4) 已经使用了 2 个多月，使用该应用程序，收集大量数据并将其存储在一个愚蠢的网址^^

**更新**我对持久存储的迁移做了一些研究并编写了这个函数：

```
-(void)migrate{

    NSPersistentStoreCoordinator *psc = [self.dataHandler.managedObjectContext persistentStoreCoordinator];
    NSURL *oldURL = [psc URLForPersistentStore:[[psc persistentStores]objectAtIndex:0]];

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    NSURL *newURL = [[appDelegate applicationDocumentsDirectory] URLByAppendingPathComponent:@"database.sqlite"];

    NSError *error = nil;

    NSPersistentStore *oldStore = [psc persistentStoreForURL:oldURL];
    NSPersistentStore *newStore = [psc migratePersistentStore:sqliStoreOld
                                                           toURL:newURL
                                                         options:nil
                                                        withType:NSSQLiteStoreType
                                                        error:&error];

} 
```

**问题 1** `will this work or will i lose some data with that?`

**问题2** `afterwards will i just have to change the appendString in my persistenstore function?`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:38:55.983

我设法使用 migratePersistentStore 函数自己解决了这个问题：

```
-(void)migrate{

    NSPersistentStoreCoordinator *psc = [self.dataHandler.managedObjectContext persistentStoreCoordinator];
    NSURL *oldURL = [psc URLForPersistentStore:[[psc persistentStores]objectAtIndex:0]];

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    NSURL *newURL = [[appDelegate applicationDocumentsDirectory] URLByAppendingPathComponent:@"database.sqlite"];

    NSError *error = nil;

    NSPersistentStore *oldStore = [psc persistentStoreForURL:oldURL];
    NSPersistentStore *newStore = [psc migratePersistentStore:sqliStoreOld
                                                           toURL:newURL
                                                         options:nil
                                                        withType:NSSQLiteStoreType
                                                        error:&error];

} 
```

之后我只是将appDelegate`database.sqli`中的appendURL更改为。奇迹般有效 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:14:22.600

我建议使用新 URL 创建第二个持久存储，并在某处添加一个按钮，将您拥有的所有数据复制到新 URL 中。在从应用程序中删除旧数据之前，请确保进行测试以确保所有数据都在新的持久存储中。

# python - 使用 awk 实用程序实现的场景

> ID：10213313
> 
> 赞同：0
> 
> 时间：2012-04-18T15:59:12.373
> 
> 标签：python, linux, awk

我有一个文件（非常大），其中包含行，每行都有一些用逗号分隔的字段。

从这个文件中，我必须提取几个字段并将它们转储到一个新行中。但这里的复杂之处在于，最后一个字段（列）本身包含一个逗号，但该特定字段由双引号“some,thing”（比如说）标识。

让我举个例子：-

```
the, quick, brown, fox, jumps, right, over, the little, "lazy,dog" 
```

这个文件中有很多这样的行，用逗号分隔。

最后一列中可能有很多逗号，

现在我需要从中提取几列，最后一列肯定是我想要提取的。

我想过使用 awk，但似乎 awk 对分隔符的拆分没有限制。

python 有一个 split() 函数，我们可以在其中限制编号。分割数，字符串的最后一个索引。['the', 'quick', 'brown', 'fox', 'jumps', 'right', 'over', 'the little', 'lazy,dog']。

此外，应从最终输出中删除双引号。

我试图使用 awk，因为 awk 在处理大文件时对我来说似乎更快。但是是否有可能实现这种事情，或者我需要使用 Pythonic 的循环和拆分方式，这似乎有点慢。

注：1）编号。列数是固定的。

请建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:07:36.240

这不会让您远离 Python，但这似乎是一种[`csv`](http://docs.python.org/library/csv.html)情况，尤其是当您提到要删除最后一项周围的引号时。

测试.csv：

```
ay,bee,cee,dee,"ee,eff"
foo,bar,"baz,quux" 
```

测试.py：

```
#!/usr/bin/env python

import csv

fp = open('test.csv', 'r')
for row in csv.reader(fp):
    print row
fp.close() 
```

输出：

```
['ay', 'bee', 'cee', 'dee', 'ee,eff']
['foo', 'bar', 'baz,quux'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:07:08.937

使用 python 的[`csv`](http://docs.python.org/library/csv.html)模块。

```
with open('myfile.txt') as data:
    for line in csv.reader(data):
        print line[2], line[5] 
```

它将无缝地为您处理报价。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:43:56.077

Python 对我来说似乎是一个更好的选择。

csv 模块对此非常有用，我使用它来解析 csv 文件并将每一行插入数据库中，使用这种开销，可以快速处理数十万行，并且如前所述，它会自动处理引号。

如果您更喜欢 split 方法，那么：

```
>>> string = 'the, quick, brown, fox, jumps, right, over, the little, "lazy,dog"'
>>> string = string.replace('"','').split(', ') # note the ', ' not ','
>>> print string
['the', 'quick', 'brown', 'fox', 'jumps', 'right', 'over', 'the little', 'lazy,dog'] 
```

将保持您的最后一个字段完好无损。

使用 awk：

```
$ cat tmp
the, quick, brown, fox, jumps, right, over, the little, "lazy,dog"
$ cat tmp | awk 'BEGIN { FS = ", " } ; { print $9 }'
"lazy,dog" 
```

为您提供您的字段，但不会删除引号，因此您必须将其传递给 sed 或其他东西。还要再次注意 FS 是 "," 不是 ","

```
$ cat tmp | awk 'BEGIN { FS = ", " } ; { print $9 }' | sed 's/"//g'
lazy,dog 
```

然后，当然，你仍然必须对数据做任何你想做的事情，即使其中一个 cl 程序更快地完成特定任务，我发现将它全部保存在 python 中会导致整体更快的过程和更少的头痛。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T16:11:04.063

是的，那里看起来像一个 csv 文件；）

这是一个`sed`替代方案

```
sed 's/"\([^"]\+\)"\|\([^,]\+\), \?/\n\1\2/g' 
```

这将为您提供新行中的每个令牌，然后您可以选择您想要的令牌

```
$ echo 'the, quick, brown, fox, jumps, right, over, the little, "lazy,foo , bar, fpp,dog"' | sed 's/"\([^"]\+\)"\|\([^,]\+\), \?/\n\1\2/g'

the
quick
brown
fox
jumps
right
over
the little
lazy,foo , bar, fpp,dog 
```

注意第一行是空的

获取第一个、第四个和最后一个字段

```
$ echo 'the, quick, brown, fox, jumps, right, over, the little, "lazy,foo , bar, fpp,dog"' | sed 's/"\([^"]\+\)"\|\([^,]\+\), \?/\n\1\2/g' | sed -n '2p;5p;$p'
the
fox
lazy,foo , bar, fpp,dog 
```

将所有内容放在一起（并使用*bash*）

```
while read -r; do
    sed 's/"\([^"]\+\)"\|\([^,]\+\), \?/\n\1\2/g' <<< "$REPLY" | sed -n '2p;5p;$p'
done < file 
```

# django - django 支持将您的模板分成几部分吗？

> ID：10213317
> 
> 赞同：0
> 
> 时间：2012-04-18T15:59:23.660
> 
> 标签：django

我想为页面的每个部分创建单独的模板，例如导航、侧边栏、登录面板等。Django 似乎使用继承而不是组合。我想知道是否支持将模板分成多个部分并将模板特定模型传递给每个模板。我在想类似的东西：

值 = { 'navbar_data' = ... 'sidebar_data' = ... }

{{ template.render('navbar', navbar_data) }} {{ template.render('sidebar', sidebar_data) }}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:11:41.340

有很多好方法可以做到这一点。

您可以为此使用内置的模板`include`。此模板标签允许您使用和重用模板的特定片段。这通常对于表示单个模型并将在整个站点中使用的迷你模板最有用。如果您将它与`with`模板标签结合使用以允许您制作包含模板中使用的上下文，这将特别有用

或者只是简单地使用`block`可能会给你你正在寻找的感觉

最后，您可以使用自定义包含模板标签 (https://docs.djangoproject.com/en/1.4/howto/custom-template-tags/#inclusion-tags) 为您提供更深层次的控制。这些将允许您呈现具有完全自定义上下文的子模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:03:02.700

这就是模板标签的用途。您在名为 myapp/templatetags/mytags.py 的文件中定义一个标签，然后在您的模板中执行此操作

```
{% load mytags %}

{% navbar %} {% sidebar %} 
```

官方文档有很多关于这方面的信息。

# jsf - 如何打包 backing bean 控制器管理器外观业务逻辑

> ID：10213318
> 
> 赞同：0
> 
> 时间：2012-04-18T15:59:27.803
> 
> 标签：jsf, architecture

我查看了几个使用 servlet 3.0 和 JSFtechnology 的 JavaEE 6 登录教程。通常它会显示一个请求范围的凭证 bean 和一个用户管理器会话 bean。大多数不提供包装信息，或者为了简单起见，将所有东西都放在一个包中。我一直在努力解决 Web 层和业务逻辑之间的打包问题。我不知道支持 bean、控制器、管理器和外观是否都在谈论同一件事。一个简短的答案可以告诉我如何打包用户管理器会话 bean 和凭证 bean，但更受欢迎的答案将帮助我浏览 Web 层和业务逻辑。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:11:28.903

对于打包，我喜欢首先按功能（如核心、gui）来划分，然后按业务单元级别划分。

例如

```
com.comp.db.beans // place your database beans here (if using any orm )

com.comp.web.ui.controller // place your controller, managedbeans here, this can be again broken into functionality wise like login, processing e.t.c.
com.comp.web.ui.beans //you place your vo here 
```

为了开始打包，您必须首先写下系统的不同功能。

然后明智地将它们分解为业务部门

然后将它们分解为更精细的级别，以区分功能是否将非常特定于 ui，或者它是否属于核心。

# mysql - MySQL中的增量更新表

> ID：10213319
> 
> 赞同：0
> 
> 时间：2012-04-18T15:59:28.733
> 
> 标签：mysql, insert

我正在处理一些高容量但不是非常可变的数据，并且想要维护一个更改表（调用它`update_history`），以及一个保存当前数据的表（调用它`current_data`）。

*   `current_data`包含：（`id`这是唯一的），，`value`（`tstamp`当前时间戳）
*   `update_history`包含：（`id`这也是唯一的），，`value`（`tstamp`对于所有更新），`delete`

假设我有`id`= 1 的某些数据。在时间 0 初始化为 10，在时间 5 更改为 2，在时间 8 删除，在时间 10 再次设置为 10。毕竟，我想要`update_history`包含装有：

```
Id Value Stamp Delete 
1    10     0     0
1     2     5     0
1     2     8     1
1    10    10     0 
```

虽然我可以从`update_history`对表的每次更改中进行选择`current_data`，但查看值是否已更改，或者是否删除了 id 并插入了一行，但这似乎有点过分。

我正在寻找一种在一个或两个查询中批量执行此操作的方法。特别是，我正在寻找一个查询，它检查每个in的对应`id`in ，如果未找到最新或in的值不匹配，则插入一行, , , =0。`update_history``id``current_data``tstamp``id``update_history``id``value``stamp``delete`

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:21:04.043

如果您希望持续执行此操作，那么我会阅读有关[MySQL](http://dev.mysql.com/doc/refman/5.5/en/triggers.html)中的触发器的信息。

否则，如果这是一次性任务，那么您可以在两个查询中完成。首先识别当前表中与历史中最后一个值不同的所有行，并在历史中插入新行

```
INSERT INTO update_history SELECT cd.id,cd.value,UNIX_TIMESTAMP(),0
FROM current_data cd 
INNER JOIN update_history uh1 ON ( cd.id=uh1.id AND cd.value!=uh1.value AND uh1.delete=0)
WHERE uh1.stamp = (
SELECT MAX(stamp) 
FROM update_history uh2
WHERE uh2.id=cd.id
) 
```

然后识别在历史记录中没有条目的任何当前行

```
INSERT INTO update_history SELECT cd.id,cd.value,UNIX_TIMESTAMP(),0
FROM current_data cd 
LEFT JOIN update_history uh1 ON cd.id=uh1.id 
WHERE uh1.id IS NULL 
```

我相信您的设计存在一些缺陷。例如，如果两个更改同时发生（就时间戳而言），会发生什么？您如何确定哪个是“第一”？您可能需要历史记录表上的唯一 ID。

# matlab - 在 Matlab 中使像素透明

> ID：10213320
> 
> 赞同：8
> 
> 时间：2012-04-18T15:59:29.980
> 
> 标签：matlab, matlab-figure, matlab-guide

我在 matlab 中导入了一个图像，在显示它之前如何使图像的背景透明？例如，我在白色背景上有一个红球，如何使图像的白色像素透明，以便只有红球可见而白色像素是透明的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-18T16:09:40.047

您需要确保图像以“png”格式保存。然后您可以使用 png 文件的['Alpha' 参数](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/imwrite.html#f25-742371)，这是一个单独指定每个像素的透明度的矩阵。它本质上是一个布尔矩阵，如果像素是透明的则为 1，否则为 0。只要您想要透明的颜色始终是相同的值（即 uint8 为 255），这可以通过 for 循环轻松完成。如果它并不总是相同的值，那么您可以定义一个阈值或值范围，其中该像素将是透明的。

**更新 ：**

首先通过迭代图像来生成 alpha 矩阵，并且（假设您将白色设置为透明）每当像素为白色时，将该像素处的 alpha 矩阵设置为 1。

```
# X is your image
[M,N] = size(X);
# Assign A as zero
A = zeros(M,N);
# Iterate through X, to assign A
for i=1:M
   for j=1:N
      if(X(i,j) == 255)   # Assuming uint8, 255 would be white
         A(i,j) = 1;      # Assign 1 to transparent color(white)
      end
   end
end 
```

然后使用这个新创建的 alpha 矩阵 (A) 将图像保存为“.png”

```
imwrite(X,'your_image.png','Alpha',A); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-09-27T16:17:28.727

注意 MATLAB 中的 for 循环应该不惜一切代价避免，因为它们很慢。重写代码以删除循环通常称为“矢量化”代码。在 ademing2 的答案的情况下，可以按如下方式完成：

```
A = zeros(size(X));
A(X == 255) = 1; 
```

# ios - IOS：关闭两个viewController

> ID：10213321
> 
> 赞同：6
> 
> 时间：2012-04-18T15:59:32.867
> 
> 标签：ios, xcode, uiviewcontroller, dismiss

我有三个 viewController

一、二、三

从第二个到打开第三个我用

```
Third *third = [[Third alloc]initWithNibName:@"Third" bundle:nil];
[self presentModalViewController:third animated:YES];
[third release]; 
```

现在我想从第三回到第一；然后我在第二个代码中设置 viewDidAppear：

```
[self dismissModalViewControllerAnimated:NO]; 
```

但是在 1 秒内我看到 Second 并且我不想看它……我该怎么办？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-18T17:16:58.123

您需要先关闭第三个视图控制器，然后再关闭第二个 Viewcontroller。当您想进入第一个视图控制器时，请执行以下代码。

```
-(void)goToFirstView{
        UIViewController *vc = [self parentViewController];
   //     UIViewController *vc = [self presentingViewController]; //ios 5 or later
        [self dismissModalViewControllerAnimated:NO];
        [vc dismissModalViewControllerAnimated:YES];
 } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T16:09:04.237

第三种模式视图首先是如何被驳回的？也许通过用户触摸“完成”按钮？如果是这样，则它位于您要关闭两者的按钮的处理程序中。

您可以将两者都解雇为：

```
[self dismissModalViewControllerAnimated: YES];
[self.presentingViewController dismissModalViewControllerAnimated: NO]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:41:00.687

发生这种情况是因为 viewDidAppear 每次在视图出现之前都会被调用，所以一旦它出现，您就将其关闭并消失..

我不认为你想要做的事情可以用 modalViewControllers 来实现......而是使用导航控制器并继续将你的视图控制器添加到堆栈中，当你想要转到第一个视图控制器时只需调用

```
 [self.navigationController popToRootViewControllerAnimated:YES]; 
```

**`EDIT`：**

只是想到了，这可以通过使用委托来实现..您将第二个作为第三个的代表，一旦您解雇第三个viecontroller，就会向代表发送一条消息。在此消息中调用`[self dismissModalViewControllerAnimated:NO];`..你就完成了..（如果你很容易知道委托。）

# javascript - 寻找可以与 GWT 一起使用的 JS 或纯 Java 中的 ZLIB 库

> ID：10213325
> 
> 赞同：0
> 
> 时间：2012-04-18T16:00:14.793
> 
> 标签：javascript, gwt, zlib

我正在使用 GWT 进行开发，需要分解一些数据。我在 JS 或 Java 中找不到任何可以用 GWT 编译的好库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:08:04.947

一个快速的谷歌搜索发现了[这个](http://www.jcraft.com/jzlib/)zlib 在纯 Java 中的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T07:56:45.503

[此页面](http://chemapps.stolaf.edu/jmol/jsmol/test2.htm)表明[JSmol](http://jsmol.sourceforge.net/)通过使用[Java2Script](http://www.jcraft.com/jzlib/)在 javascript 中使用[JZlib](http://j2s.sourceforge.net/)。

# scala - 保存记录时会导致 java.util.prefs.BackingStoreException: Raw Records don't save themselves

> ID：10213329
> 
> 赞同：0
> 
> 时间：2012-04-18T16:00:33.960
> 
> 标签：scala, lift, squeryl

用户.scala

```
import net.liftweb.record.{ MegaProtoUser, MetaMegaProtoUser }
import net.liftweb.squerylrecord.RecordTypeMode._
import net.liftweb.common._
import net.liftweb.util.FieldError
import net.liftweb.http.S

class User extends MegaProtoUser[User] {

  def meta = User

  protected def valUnique(errorMsg: => String)(email: String): List[FieldError] = {
    List[FieldError]()
  }

}

/**
 * The singleton that has methods for accessing the database
 */
object User extends User with MetaMegaProtoUser[User] {

  override def basePath = "profile" :: Nil

  override def signupFields = email :: password :: Nil

  override def signupXhtml(user: TheUserType) = {
    (<form method="post" action={ S.uri }><table>
                                            <tr><td colspan="2">{ S.??("sign.up") }</td></tr>
                                            { localForm(user, false, signupFields) }
                                            <tr><td>&nbsp;</td><td><user:submit class="btn btn-primary" /></td></tr>
                                          </table></form>)
  }

  override def screenWrap = Full(<lift:surround with="default" at="content">
                                   <lift:bind/>
                                 </lift:surround>)

  // redefine login form for nice formatting
  override def loginXhtml =
    <form method="post" action={ S.uri }>
      <lift:msg show="All"/>
      <div style="margin-bottom: 5px; margin-left: 5px;">
        <strong>
          { S.??("log.in") }
        </strong>
      </div>
      <div style="float: left; line-height: 2.5em;margin-left: 5px; margin-right: 20px;">
        { S.??("email.address") }<br/>{ S.??("password") }<br/>
        <a href={ lostPasswordPath.mkString("/", "/", "") }>
          { S.??("recover.password") }
        </a>
      </div>
      <div style="line-height: 2.5em;">
        <user:email/>
        <br/>
        <user:password/>
        <br/>
        <user:submit class="btn btn-primary"/>
      </div>
    </form>

  protected def userFromStringId(id: String): Box[User] = from(PPSchema.users)(u =>
    where(u.id === id.toLong)
      select (u)).headOption

  protected def findUserByUserName(email: String): Box[User] = from(PPSchema.users)(u =>
    where(u.email === email)
      select (u)).headOption

  protected def findUserByUniqueId(id: String): Box[User] = userFromStringId(id)
} 
```

我明白了。在 User 类中添加以下代码。

```
override def saveTheRecord() : Box[User] = {
    val u = User.createRecord.email(email.is).password(password.is).firstName(firstName.is).lastName(lastName.is).validated(validated.is).superUser(superUser.is)

    Full(PPSchema.users.insert(u))
  } 
```

错误信息如下：

消息：java.util.prefs.BackingStoreException：原始记录不保存自己 net.liftweb.record.Record$class.saveTheRecord(Record.scala:89) com.posplus.model.User.saveTheRecord(User.scala:17 ) net.liftweb.record.MetaMegaProtoUser$MyUserBridge.save(ProtoUser.scala:294) net.liftweb.proto.ProtoUser$class.actionsAfterSignup(ProtoUser.scala:696) com.posplus.model.User$.actionsAfterSignup(User. scala:32) net.liftweb.proto.ProtoUser$class.testSignup$1(ProtoUser.scala:737) net.liftweb.proto.ProtoUser$$anonfun$innerSignup$1$1.apply(ProtoUser.scala:745) net.liftweb。 proto.ProtoUser$$anonfun$innerSignup$1$1.apply(ProtoUser.scala:745) net.liftweb.http.S$NFuncHolder$$anonfun$apply$5.apply(S.scala:190) net.liftweb.http.S $NFuncHolder$$anonfun$apply$5.apply(S.scala:190) scala.collection。TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:194) scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:194) scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala: 59) scala.collection.immutable.List.foreach(List.scala:45) scala.collection.TraversableLike$class.map(TraversableLike.scala:194) scala.collection.immutable.List.map(List.scala:45) net.liftweb.http.S$NFuncHolder.apply(S.scala:190) net.liftweb.http.S$ProxyFuncHolder.apply(S.scala:115) net.liftweb.http.LiftSession$$anonfun$buildFunc$1$2 .apply(LiftSession.scala:651) net.liftweb.http.LiftSession$$anonfun$16$$anonfun$apply$39.apply(LiftSession.scala:667) net.liftweb.http.LiftSession$$anonfun$16$$anonfun$应用$39.apply(LiftSession.scala:667) scala.collection.TraversableLike$$anonfun$map$1。apply(TraversableLike.scala:194) scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:194) scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala:59) scala.collection.immutable。 List.foreach(List.scala:45) scala.collection.TraversableLike$class.map(TraversableLike.scala:194) scala.collection.immutable.List.map(List.scala:45) net.liftweb.http.LiftSession$ $anonfun$16.apply(LiftSession.scala:667) net.liftweb.http.LiftSession$$anonfun$16.apply(LiftSession.scala:656) scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala: 200) scala.collection.TraversableLike$$anonfun$flatMap$1.apply(TraversableLike.scala:200) scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala:59) scala.collection.immutable.List.foreach(List.斯卡拉：45) scala.collection.TraversableLike$class.flatMap(TraversableLike.scala:200) scala.collection.immutable.List.flatMap(List.scala:45) net.liftweb.http.LiftSession.runParams(LiftSession.scala:655) net.liftweb.http.LiftSession.processRequest(LiftSession.scala:1074) net.liftweb.http.LiftServlet.net$liftweb$http$LiftServlet$$dispatchStatefulRequest(LiftServlet.scala:414) net.liftweb.http.LiftServlet$$ anonfun$doSession$1$1.apply(LiftServlet.scala:27​​9) net.liftweb.http.LiftServlet$$anonfun$doSession$1$1.apply(LiftServlet.scala:27​​9) net.liftweb.http.S$class.net$liftweb $http$S$$wrapQuery(S.scala:1376) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_nest2InnerInit$1$$anonfun$apply$34.apply(S.scala:1524 ) net.liftweb.http.S$class.net$liftweb$http$S$$doAround(S.scala:1305) net.liftweb.http。S$$anonfun$net$liftweb$http$S$$doAround$1.apply(S.scala:1306) org.squeryl.dsl.QueryDsl$class._using(QueryDsl.scala:46) org.squeryl.dsl.QueryDsl $class._executeTransactionWithin(QueryDsl.scala:105) org.squeryl.dsl.QueryDsl$class.inTransaction(QueryDsl.scala:91) net.liftweb.squerylrecord.RecordTypeMode$.inTransaction(RecordTypeMode.scala:34) bootstrap.liftweb。 Boot$$anon$1.apply(Boot.scala:58) net.liftweb.http.S$class.net$liftweb$http$S$$doAround(S.scala:1306) net.liftweb.http.S$$ anonfun$net$liftweb$http$S$$$_nest2InnerInit$1.apply(S.scala:1522) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$class.net$ liftweb$http$S$$_nest2InnerInit(S.scala:1521) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_innerInit$1$$anonfun$apply$38$$anonfun$apply$39$ $anonfun$apply$40$$anonfun$apply$41。apply(S.scala:1561) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$withReq$1.apply(S.scala:1571) net.liftweb。 util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$class.withReq(S.scala:1570) net.liftweb.http.S$.withReq(S.scala:48) net.liftweb .http.S$$anonfun$net$liftweb$http$S$$_innerInit$1$$anonfun$apply$38$$anonfun$apply$39$$anonfun$apply$40.apply(S.scala:1560) net.liftweb。 util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_innerInit$1$$anonfun$apply$38$$anonfun$apply$39.apply(S .scala:1559) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_innerInit$1$$anonfun$apply$38。应用（S.scala：1558）net.liftweb.util.ThreadGlobal.doWith（ThreadGlobal.scala：71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_innerInit$1.apply(S.scala:1557) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) 净.liftweb.http.S$class.net$liftweb$http$S$$_innerInit(S.scala:1556) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1$$ anonfun$apply$44$$anonfun$apply$45$$anonfun$apply$46$$anonfun$apply$47$$anonfun$apply$48.apply(S.scala:1594) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala :71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1$$anonfun$apply$44$$anonfun$apply$45$$anonfun$apply$46$$anonfun$apply$47。 apply(S.scala:1592) net.liftweb.http.CoreRequestVarHandler$class.apply(Vars.scala:613) net.liftweb.http.RequestVarHandler$.apply(Vars.scala:515) net.liftweb.http.S $$anonfun$net$liftweb$http$S$$_init$1$$anonfun$apply$44$$anonfun$apply$45$$anonfun$apply$46。应用(S.scala:1591) net.liftweb.http.CoreRequestVarHandler$class.apply(Vars.scala:613) net.liftweb.http.TransientRequestVarHandler$.apply(Vars.scala:528) net.liftweb.http.S $$anonfun$net$liftweb$http$S$$_init$1$$anonfun$apply$44$$anonfun$apply$45.apply(S.scala:1590) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala: 71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1$$anonfun$apply$44.apply(S.scala:1589) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal .scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1.apply(S.scala:1588) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala: 71) net.liftweb.http.S$class.net$liftweb$http$S$$第528章 网易网.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1$$anonfun$apply$44.apply(S.scala:1589) 净值。 liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1.apply(S.scala:1588) net.liftweb.util .ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$class.net$liftweb$http$S$$第528章 网易网.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1$$anonfun$apply$44.apply(S.scala:1589) 净值。 liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1.apply(S.scala:1588) net.liftweb.util .ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.S$class.net$liftweb$http$S$$doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1.apply(S.scala:1588) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal .scala:71) net.liftweb.http.S$class.net$liftweb$http$S$$doWith(ThreadGlobal.scala:71) net.liftweb.http.S$$anonfun$net$liftweb$http$S$$_init$1.apply(S.scala:1588) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal .scala:71) net.liftweb.http.S$class.net$liftweb$http$S$$*init(S.scala:1587) net.liftweb.http.S$class.init(S.scala:1190) net.liftweb.http.LiftServlet.doSession$1(LiftServlet.scala:27​​8) net.liftweb.http.LiftServlet .doService(LiftServlet.scala:288) net.liftweb.http.LiftServlet$$anonfun$doIt$1$1.apply(LiftServlet.scala:132) net.liftweb.http.LiftServlet$$anonfun$doIt$1$1.apply(LiftServlet .scala:131) net.liftweb.util.TimeHelpers$class.calcTime(TimeHelpers.scala:344) net.liftweb.util.Helpers$.calcTime(Helpers.scala:34) net.liftweb.util.TimeHelpers$class。 logTime(TimeHelpers.scala:363) net.liftweb.util.Helpers$.logTime(Helpers.scala:34) net.liftweb.http.LiftServlet.doIt$1(LiftServlet.scala:131) net.liftweb.http.LiftServlet。服务（LiftServlet.scala:142）net.liftweb.http.provider.HTTPProvider$$anonfun$service$2$$anonfun$apply$mcV$sp$1$$anonfun$apply$mcV$sp$2。apply$mcV$sp(HTTPProvider.scala:72) net.liftweb.http.provider.HTTPProvider$$anonfun$service$2$$anonfun$apply$mcV$sp$1$$anonfun$apply$mcV$sp$2.apply( HTTPProvider.scala:71) net.liftweb.http.provider.HTTPProvider$$anonfun$service$2$$anonfun$apply$mcV$sp$1$$anonfun$apply$mcV$sp$2.apply(HTTPProvider.scala:71) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.URLRewriter$.doWith(Req.scala:1253) net.liftweb.http.provider.HTTPProvider$$anonfun$service$2$$ anonfun$apply$mcV$sp$1.apply$mcV$sp(HTTPProvider.scala:70) net.liftweb.http.provider.HTTPProvider$$anonfun$service$2$$anonfun$apply$mcV$sp$1.apply(HTTPProvider .scala:70) net.liftweb.http.provider.HTTPProvider$$anonfun$service$2$$anonfun$apply$mcV$sp$1.apply(HTTPProvider.scala:70) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal .scala:71) 净。liftweb.http.provider.HTTPProvider$$anonfun$service$2.apply$mcV$sp(HTTPProvider.scala:66) net.liftweb.http.provider.HTTPProvider$$anonfun$service$2.apply(HTTPProvider.scala:60) net.liftweb.http.provider.HTTPProvider$$anonfun$service$2.apply(HTTPProvider.scala:60) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.provider.HTTPProvider$ class.service(HTTPProvider.scala:60) net.liftweb.http.LiftFilter.service(LiftServlet.scala:757) net.liftweb.http.provider.servlet.ServletFilterProvider$$anonfun$doFilter$1$$anonfun$apply$mcV $sp$1.apply$mcV$sp(ServletFilterProvider.scala:67) net.liftweb.http.provider.servlet.ServletFilterProvider$$anonfun$doFilter$1$$anonfun$apply$mcV$sp$1.apply(ServletFilterProvider.scala: 62）net.liftweb.http.provider.servlet。ServletFilterProvider$$anonfun$doFilter$1$$anonfun$apply$mcV$sp$1.apply(ServletFilterProvider.scala:62) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16$$anonfun$apply$17$$anonfun$apply $18$$anonfun$apply$19.apply(Vars.scala:619) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16$$anonfun$apply $17$$anonfun$apply$18.apply(Vars.scala:618) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16$$anonfun$apply $17.apply(Vars.scala:617) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16.apply(Vars.scala:616) 净值。 liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$class.apply(Vars.scala:615) net.liftweb.http.RequestVarHandler$.apply(Vars.scala:515) net.liftweb.http.provider.servlet.ServletFilterProvider$$anonfun$doFilter$1.apply(ServletFilterProvider.scala:61) net.liftweb .http.provider.servlet.ServletFilterProvider$$anonfun$doFilter$1.apply(ServletFilterProvider.scala:61) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16$$anonfun$apply$17$$anonfun$apply$18$$ anonfun$apply$19.apply(Vars.scala:619) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16$$anonfun$apply$17$$ anonfun$apply$18.apply(Vars.scala:618) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16$$anonfun$apply$17.apply (Vars.scala:617) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$$anonfun$apply$16.apply(Vars.scala:616) net.liftweb.util.ThreadGlobal.doWith(ThreadGlobal.scala:71) net.liftweb.http.CoreRequestVarHandler$class。 apply(Vars.scala:615) net.liftweb.http.provider.servlet.ServletFilterProvider$class.doFilter(ServletFilterProvider.scala:60) net.liftweb.http.LiftFilter.doFilter(LiftServlet.scala:757) org.eclipse。 jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337) org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:486) org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler. java:119) org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:520) org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233) org.eclipse.jetty.server。处理程序。上下文处理程序。*_doHandle(ContextHandler.java:973) org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java) org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:417) org.eclipse.jetty。 server.session.SessionHandler.doScope(SessionHandler.java:192) org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:907) org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler. java:117) org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250) org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:110) org.eclipse.jetty。 server.Server.handle(Server.java:346) org.eclipse.jetty.server.HttpConnection.handleRequest(HttpConnection.java:442) org.eclipse.jetty.server.HttpConnection$RequestHandler.content(HttpConnection.java:941) org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:801) org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:224) org.eclipse.jetty.server.AsyncHttpConnection。句柄(AsyncHttpConnection.java:51) org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:586) org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:44) org .eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598) org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533) java.lang.Thread.run(Thread.爪哇：680）51) org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:586) org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:44) org.eclipse.jetty.util .thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598) org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533) java.lang.Thread.run(Thread.java:680)51) org.eclipse.jetty.io.nio.SelectChannelEndPoint.handle(SelectChannelEndPoint.java:586) org.eclipse.jetty.io.nio.SelectChannelEndPoint$1.run(SelectChannelEndPoint.java:44) org.eclipse.jetty.util .thread.QueuedThreadPool.runJob(QueuedThreadPool.java:598) org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:533) java.lang.Thread.run(Thread.java:680)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T17:56:57.763

恐怕 ProtoUser 现在不能与 SquerylRecord 一起使用。

# java - Android 与 websocket 通信（Node Websocket 服务器和 Android Java 客户端）。不适用于 Android 4

> ID：10213332
> 
> 赞同：4
> 
> 时间：2012-04-18T16:00:48.323
> 
> 标签：java, android, node.js, websocket, android-4.0-ice-cream-sandwich

我尝试将 Websocket 用作 Android 客户端 - [weberknecht](http://code.google.com/p/weberknecht/) 使用线程每秒向 Nodejs Websocket (js) 发送一条消息：[Node WebSocket Server](http://static.brandedcode.com/nws-docs/)

它在 android 2 或 2.3.3 上运行良好，但是当我在 android 4 上尝试时，我在 websocket.connect() 上得到一个错误；

你知道为什么或我做错了什么吗？

我的代码是：

```
public class MainThread extends Thread {

    private boolean is_running;
    private URI url = null;
    private de.roderick.weberknecht.WebSocket websocket = null;

    public MainThread() {
        this.is_running = false;
        try {
            url = new URI("ws://192.168.1.88:8088/");
            websocket = new WebSocketConnection(url);

            websocket.setEventHandler(new WebSocketEventHandler() {
                public void onOpen(){
                    System.out.println("--open");
                }
                public void onMessage(WebSocketMessage message){
                    System.out.println("--received message: " + message.getText());
                }
                public void onClose(){
                    System.out.println("--close");
                }
            });
        } catch (WebSocketException wse) {
            wse.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        } catch (URISyntaxException use) {
            use.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }

    }
    @Override
    public void run() {
        while(is_running){
            try {
                websocket.send("hello world");
                Thread.sleep(10000);
            }
            catch (WebSocketException wse) {
                wse.printStackTrace();
            } catch (InterruptedException e) {
                e.printStackTrace();  
            }

        }
    }

    public void set_running(boolean is_running) {
        if(is_running == true)
            try {
                websocket.connect();
                this.is_running = is_running;
            } catch (WebSocketException e) {
                System.out.println(e.toString());
                //e.printStackTrace();  
            }
    }
} 
```

以及我在 android 4 上遇到的错误：

```
ERROR/AndroidRuntime(562): FATAL EXCEPTION: main
        java.lang.RuntimeException: Unable to start activity ComponentInfo{com.biskis.test.websocket/com.biskis.test.websocket.GameActivity}: android.os.NetworkOnMainThreadException
        at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
        at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
        at android.app.ActivityThread.access$600(ActivityThread.java:123)
        at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
        at android.os.Handler.dispatchMessage(Handler.java:99)
        at android.os.Looper.loop(Looper.java:137)
        at android.app.ActivityThread.main(ActivityThread.java:4424)
        at java.lang.reflect.Method.invokeNative(Native Method)
        at java.lang.reflect.Method.invoke(Method.java:511)
        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
        at dalvik.system.NativeStart.main(Native Method)
        Caused by: android.os.NetworkOnMainThreadException
        at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1099)
        at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
        at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
        at libcore.io.IoBridge.connect(IoBridge.java:112)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
        at java.net.Socket.startupSocket(Socket.java:566)
        at java.net.Socket.tryAllAddresses(Socket.java:127)
        at java.net.Socket.<init>(Socket.java:177)
        at java.net.Socket.<init>(Socket.java:149)
        at de.roderick.weberknecht.WebSocketConnection.createSocket(WebSocketConnection.java:238)
        at de.roderick.weberknecht.WebSocketConnection.connect(WebSocketConnection.java:83)
        at com.biskis.test.websocket.MainThread.set_running(MainThread.java:76)
        at com.biskis.test.websocket.GameActivity.onCreate(GameActivity.java:20)
        at android.app.Activity.performCreate(Activity.java:4465)
        at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
        at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
        ... 11 more 
```

或者您是否知道如何以更好的方式将客户端（java、android）与服务器（nodejs、websocket）通信？

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T16:07:14.617

不要连接到主线程（即 in `GameActivity.onCreate`）上的 Websocket，错误就会消失。您可以使用 an`AsyncTask`在后台连接到 Websocket。

通过 I/O 操作阻塞主线程（网络访问最终是 I/O 操作）将导致（在最坏的情况下）缓慢的用户界面或 Android 杀死您的应用程序，因为它没有及时做出反应。请参阅[设计响应性](http://developer.android.com/guide/practices/design/responsiveness.html)文档。

# c++ - 如何使用 linux perf 获取 libc6 符号（例如 _int_malloc）的呼叫父母？

> ID：10213334
> 
> 赞同：8
> 
> 时间：2012-04-18T16:00:56.517
> 
> 标签：c++, linux, g++, profiling, perf

我正在使用 linux perf 分析 C++ 应用程序，并且使用[GProf2dot](http://code.google.com/p/jrfonseca/wiki/Gprof2Dot "Gprof2Dot")获得了一个很好的控制流图。但是，C 库 (libc6-2.13.so) 中的一些符号占用了总时间的很大一部分，但没有入边。

例如：

*   `_int_malloc`花费 8% 的时间，但没有给父母打电话。
*   `__strcmp_sse42`总共`__cxxabiv1::__si_class_type_info::__do_dyncast`花费大约 10% 的时间，并且有一个名为 的呼叫者`0`，其中有呼叫者`2d6935c`，`2cc748c`和`6`，没有呼叫者。

结果，我无法找出仅使用 perf 的所有这些 mallocing 和动态转换的例程。但是，似乎其他符号（例如`malloc`但不是`_int_malloc`）确实有呼叫父母。

为什么 perf show 不为 _int_malloc 调用父母？为什么我找不到 __do_dyn_cast 的最终调用者？而且，有什么方法可以让我修改我的设置，以便我可以获得这些信息吗？我在 x86-64 上，所以我想知道是否需要带有帧指针的（非标准）libc6。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-24T20:04:14.713

**更新：**从 3.7.0 内核开始，可以使用`perf record -gdwarf <command>`.

使用`-gdwarf`，无需编译`-fno-omit-frame-pointer`。

**原始答案：**`-fno-omit-framepointer`是的，目前（2012 年 5 月 24 日） 可能需要在 x86_64 上使用帧指针 ( ) 编译的 libc6 。

但是，开发人员目前正在努力让 perf 工具使用 DWARF 展开信息。这意味着不再需要帧指针来获取 x86_64 上的回溯信息。然而，Linus 不希望内核中有一个 DWARF 展开器。因此，性能工具将在系统运行时保存寄存器，并使用 libunwind 库在用户空间性能工具中执行 DWARF 展开。

该技术已经过测试，可以成功确定（例如）`malloc`和`dynamic_cast`. 但是，补丁集还没有集成到 Linux 内核中，需要进一步修改才能准备好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-20T12:58:53.933

`_int_malloc`并且`__do_dyn_cast`正在从分析器无法识别的例程中调用，因为它没有符号表信息。

更重要的是，看起来你正在展示*自我（独家）时间*。这仅对在 a) 有很多自用时间和 b) 您可以修复的例程中查找热点有用。

创建原始 unix 之后的分析器是有原因的`profil`。真正的软件由几乎所有时间都在调用其他函数的函数组成，并且您需要能够找到大部分时间都在堆栈上的代码，而不是大部分时间都有程序计数器的代码。

因此，您需要进行配置`perf`以获取堆栈样本并告诉您每个*例程*在堆栈上的时间百分比。如果它不仅报告例程，还报告代码行，就像在[Zoom](http://www.rotateright.com/)中一样，那就更好了。最好在挂钟时间取样，这样您就不会对 IO 视而不见。

[这一切还有很多话要说。](https://stackoverflow.com/questions/1777556/alternatives-to-gprof/1779343#1779343)

# ubuntu - CUDA 2.1“错误：未知类型名称‘size_t’”

> ID：10213337
> 
> 赞同：1
> 
> 时间：2012-04-18T16:01:16.040
> 
> 标签：ubuntu, cuda, nvidia, nvcc, size-t

系统：Ubuntu 11.10 x86_64 CUDA：v 2.1

在尝试制作像 matrixMul 这样的示例程序时，我遇到了大量错误，其中大部分是“未知类型名称‘size_t’”。我确保将 /usr/local/cuda/bin 放在我的 PATH 中，并将 /usr/local/cuda/lib 放在 /etc/ld.so.conf.d 的 .conf 中。

任何想法为什么我会收到这些错误？

```
matrixMul$ make emu=1
In file included from /tmp/tmpxft_00004089_00000000-1_matrixMul.cudafe1.stub.c:5:0,
                 from matrixMul.cu:196:
/usr/local/cuda//bin/../include/crt/host_runtime.h:192:0: warning: "__device_fun" redefined [enabled by default]
/usr/local/cuda//bin/../include/crt/host_runtime.h:215:0: note: this is the location of the previous definition
/usr/local/cuda//bin/../include/crt/host_runtime.h:194:0: warning: "__device_var" redefined [enabled by default]
/usr/local/cuda//bin/../include/crt/host_runtime.h:217:0: note: this is the location of the previous definition
/usr/local/cuda//bin/../include/crt/host_runtime.h:196:0: warning: "__tex_var" redefined [enabled by default]
/usr/local/cuda//bin/../include/crt/host_runtime.h:219:0: note: this is the location of the previous definition
/usr/local/cuda//bin/../include/crt/host_runtime.h:198:0: warning: "__cudaFatCubin" redefined [enabled by default]
/usr/local/cuda//bin/../include/crt/host_runtime.h:221:0: note: this is the location of the previous definition
/usr/local/cuda//bin/../include/crt/host_runtime.h:208:0: warning: "__ids" redefined [enabled by default]
/usr/local/cuda//bin/../include/crt/host_runtime.h:223:0: note: this is the location of the previous definition
In file included from /usr/local/cuda//bin/../include/builtin_types.h:43:0,
                 from /usr/local/cuda//bin/../include/cuda_runtime_api.h:54,
                 from /usr/local/cuda//bin/../include/crt/host_runtime.h:80,
                 from /usr/include/c++/4.6/x86_64-linux-gnu/./bits/c++config.h:156:
/usr/local/cuda//bin/../include/driver_types.h:184:3: error: unknown type name ‘size_t’
...
/usr/local/cuda//bin/../include/driver_types.h:274:3: error: unknown type name ‘size_t’
In file included from /usr/local/cuda//bin/../include/crt/host_runtime.h:80:0,
                 from /usr/include/c++/4.6/x86_64-linux-gnu/./bits/c++config.h:156:
/usr/local/cuda//bin/../include/cuda_runtime_api.h:102:46: error: unknown type name ‘size_t’
...
/usr/local/cuda//bin/../include/cuda_runtime_api.h:105:118: error: unknown type name ‘size_t’
In file included from /usr/local/cuda//bin/../include/crt/host_runtime.h:80:0,
                 from /usr/include/c++/4.6/x86_64-linux-gnu/./bits/c++config.h:156:
/usr/local/cuda//bin/../include/cuda_runtime_api.h:110:48: error: unknown type name ‘size_t’
In file included from /usr/local/cuda//bin/../include/crt/host_runtime.h:80:0,
                 from /usr/include/c++/4.6/x86_64-linux-gnu/./bits/c++config.h:156:
/usr/local/cuda//bin/../include/cuda_runtime_api.h:120:59: error: unknown type name ‘size_t’
...
/usr/local/cuda//bin/../include/cuda_runtime_api.h:121:110: error: unknown type name ‘size_t’
In file included from /usr/local/cuda//bin/../include/crt/host_runtime.h:80:0,
                 from /usr/include/c++/4.6/x86_64-linux-gnu/./bits/c++config.h:156:
/usr/local/cuda//bin/../include/cuda_runtime_api.h:122:80: error: unknown type name ‘size_t’
...
/usr/local/cuda//bin/../include/cuda_runtime_api.h:216:68: error: unknown type name ‘size_t’
In file included from /usr/local/cuda//bin/../include/crt/host_runtime.h:226:0,
                 from /usr/lib/gcc/x86_64-linux-gnu/4.6.1/include/stddef.h:213:
/usr/local/cuda//bin/../include/common_functions.h:70:1: error: unknown type name ‘clock_t’
/usr/include/time.h:183:43: error: conflicting types for ‘clock’
/usr/local/cuda//bin/../include/common_functions.h:72:10: note: previous implicit declaration of ‘clock’ was here
../../common/inc/cutil_inline_runtime.h:41:49: warning: inline function ‘_Z23cutGetMaxGflopsDeviceIdv’ declared weak [-Wattributes]
../../common/inc/cutil_inline_runtime.h:41:43: warning: inline function ‘_Z23cutGetMaxGflopsDeviceIdv’ declared weak [-Wattributes]
In file included from /tmp/tmpxft_00004089_00000000-1_matrixMul.cudafe1.stub.c:4:0,
                 from matrixMul.cu:196:
/usr/include/time.h:183:34: error: conflicting types for ‘__cuda_clock’
/usr/local/cuda//bin/../include/common_functions.h:70:16: note: previous definition of ‘__cuda_clock’ was here
In file included from /tmp/tmpxft_00004089_00000000-1_matrixMul.cudafe1.stub.c:4:0,
                 from matrixMul.cu:196:
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:193:30: error: static declaration of ‘__cuda_error_not_implememted’ follows non-static declaration
/usr/local/cuda//bin/../include/math_functions.h:864:78: note: previous declaration of ‘__cuda_error_not_implememted’ was here
In file included from /tmp/tmpxft_00004089_00000000-1_matrixMul.cudafe1.stub.c:5:0,
                 from matrixMul.cu:196:
/usr/local/cuda//bin/../include/crt/host_runtime.h:185:13: error: redefinition of ‘__cudaUnregisterBinaryUtil’
/usr/local/cuda//bin/../include/crt/host_runtime.h:185:13: note: previous definition of ‘__cudaUnregisterBinaryUtil’ was here
make: *** [obj/emurelease/matrixMul.cu.o] Error 255 
```

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T16:06:24.350

确保你`#include <stddef.h>`

如果这是 C++ 程序，请尝试添加`using namespace std`.

这个问题与“bin”或你的 $PATH; 无关。它与您在编译时选择的系统头文件和系统定义有关。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T20:42:49.240

升级 CUDA！

CUDA 2.1 于 2008/9 发布，您应该升级（例如升级到[CUDA 4.2](http://developer.nvidia.com/cuda-downloads)）。官方还不支持 Ubuntu 11.10，我自己也没试过，主要问题可能是你必须安装 GCC 4.5.2。有关受支持版本的更多信息，请参阅[发行说明](http://developer.download.nvidia.com/compute/DevZone/docs/html/C/doc/CUDA_Toolkit_Release_Notes.txt)。

# asp.net-mvc - ASP.NET MVC 1 到 Azure 的迁移

> ID：10213342
> 
> 赞同：1
> 
> 时间：2012-04-18T16:01:55.727
> 
> 标签：asp.net-mvc, visual-studio-2008, azure

我在 Visual Studio 2008 中有一个使用 ASP.NET MVC 1 构建的 Web 应用程序。

如何将此 Web 应用程序迁移到 Azure？所有教程要么适用于 Visual Studio 2010，要么不再适用。我已经安装了 Web 平台安装程序和 Azure SDK，在 VS2010 中可以使用 Azure 项目模板，但在 VS2008 中没有。我检查了很多指南，但 MSDN 上与 Visual Studio 2008 相关的所有下载链接似乎都已损坏。

我的想法只是将 Azure 部署项目添加到解决方案中，添加对正确 Azure 库的引用并进行部署，但我什至无法做到这一点，因为我不知道从哪里开始。

我的应用程序中的大部分 MVC 内容都是高度定制的，因此很难迁移到 ASP.NET MVC 2/3/4。由于它是 MVC 1，它不支持 Visual Studio 2010，因此我最好避免迁移到 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:22:36.123

你可以通过两种方式来解决这个问题。您可以使用 cspack 打包代码并部署到 Azure，也可以安装支持 Visual Studio 2008 的旧版 SDK：

CSPack：http: [//msdn.microsoft.com/en-us/library/windowsazure/gg432988.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/gg432988.aspx)

较旧的 SDK： http: [//www.windowsazure.com/en-us/develop/downloads/archive-net-downloads/](http://www.windowsazure.com/en-us/develop/downloads/archive-net-downloads/)

我知道 VS2008 上安装了 1.1，我知道 1.4 没有，不确定介于两者之间的那些。

# spring - 托管 spring 3.0 REST 应用程序？

> ID：10213346
> 
> 赞同：0
> 
> 时间：2012-04-18T16:02:34.383
> 
> 标签：spring, rest, hosting

我有一个基于 Spring 3.0 的 Spring 应用程序，用于休息 Web 服务。我打算将它部署到 heroku，但面临很多问题。有人可以告诉我一些免费托管甚至付费托管，我可以在哪里部署我的应用程序吗？

原谅我在服务器端的经验不足

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:16:52.563

[Cloudbees](http://www.cloudbees.com/)是一款出色的 PaaS 产品，可为您的应用程序提供 Tomcat/MySQL 基础架构。我试过免费版，完全没有问题。

另一个流行的选择是使用[Amazon Elastic Beanstalk](http://aws.amazon.com/es/elasticbeanstalk/)，但我还没有使用它（主要是因为价格）。可以在这篇[DeveloperWorks 文章](http://www.ibm.com/developerworks/library/j-paasshootout/)中找到流行的 PaaS 产品之间的一个很好的比较。

# tcl - Tk 获取当前焦点所在的窗口路径

> ID：10213350
> 
> 赞同：0
> 
> 时间：2012-04-18T16:02:45.373
> 
> 标签：tcl, tk

如何使用 Tcl/Tk 获得当前窗口的焦点。我尝试使用 focus 命令，但它返回和空字符串。

我在同一个愿望会话中有多个窗口。每个窗口都有相同的按钮集，但数据不同。我需要找出按下按钮的窗口的路径。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:16:00.063

不带参数的`focus`命令返回当前具有焦点的 Tk 小部件，如果没有 Tk 小部件具有焦点，则返回空结果。您可以通过启动 Tk 并打包一些窗口来测试这一点，然后`after 2000 {puts [focus]}`在 2 秒内使用并单击一个窗口。

然而！通过绑定按钮命令并将自身传递给命令过程，您想要达到的效果听起来更好：

```
pack [button .b -text Click -command [list Click .b]]
proc Click {widget args} {puts [list $widget $args [focus]]} 
```

如果您在其中添加一个条目小部件，您会发现当您单击它时焦点不一定等于按钮小部件。这需要首先点击按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-27T21:54:20.633

在寻找其他东西时，我遇到了这个，虽然它有点老了..在 Tcl 中，有更好的方法来做到这一点。一方面，您无法确定“活动窗口”是脚本运行时所需的窗口。知道按下了哪个窗口/按钮的方法是将其嵌入脚本代码中。当您使用“-command”参数将代码附加到 Tk 窗口/小部件时，您可以使用“[list mycommand uniqueid]”之类的东西，Tcl 解释器将在执行之前附加任何记录的参数。一个很好的例子是在 Tcl 中创建一个 TCP 套接字服务器。该命令是“socket -server <procname> <port>”，只要客户端尝试连接到 <port>，就会调用 <procname>。但它不必是一个简单的 procname，它可以是任何可以评估的 Tcl 命令：“socket -server [list myserver foo bar] 12344”将在端口 12345 上创建一个侦听套接字。当客户端尝试连接到服务器时，Tcl 将调用（从技术上讲，它将通过 "eval") "myserver foo bar <chan> <addr> <port>" 运行，其中 chan、addr 和 port 是 socket 命令添加到命令的参数。这些都记录在 Tcl 套接字命令页面中。addr 和 port 是 socket 命令添加到命令中的参数。这些都记录在 Tcl 套接字命令页面中。addr 和 port 是 socket 命令添加到命令中的参数。这些都记录在 Tcl 套接字命令页面中。

这里重要的部分是理解 Tcl 使用您提供的参数调用“myserver”，然后将附加参数附加到末尾。然后，您可以使用“socket -server myserver foo baz 12346”监听另一个套接字，该套接字将监听端口 12346，当客户端连接时，它将调用/eval“myserver foo baz <chan> <addr> <port>” . 然后，您可以将单个“myserver”过程编写为“ `proc myserver {argFoo argBar argChan argAddr argPort} {if {$argBar eq "bar"} {puts "do somthing"} else if {$argBar eq "baz"} {puts "do something else"} else {puts "Whatcha' talkin' about, foo'!?"}}`”。

对于 Tk 按钮示例：

```
button .pressme -text "Press Me!" -command [list cmdYouPressed [pid]]
proc cmdYouPressed {argPID args} {
  puts "You pressed the button for $argPID!"
} 
```

如果您在多个不同的 Tcl/Tk 中间件中运行此代码段，您可以通过进程 ID（这就是 [pid] 的用途）判断哪个按钮被按下，以了解在哪个正在运行的脚本中按下了哪个按钮。当然，您可以创建自己的唯一标识符，而不是使用 [pid]，就像我在 foo bar/baz 套接字示例中所做的那样。

这样做可以消除许多简单地尝试获取活动窗口的问题，例如“如果在命令运行时窗口不活动会发生什么，例如如果你有某种自动化/远程控制正在运行并且它正在响应背景窗口？” 它还使您不必在运行多个版本的脚本时尝试确定窗口/资源ID——每个版本都已经有它自己的系统唯一进程ID。

（对不起，如果我不清楚或太简洁......我的键盘工作不正常，这就是为什么我正在寻找其他东西，以帮助我“自动更正”错误......）

# c# - 使用 Dapper 从 T-SQL 视图填充对象

> ID：10213351
> 
> 赞同：2
> 
> 时间：2012-04-18T16:02:55.770
> 
> 标签：c#, dapper, multi-mapping

我正在尝试使用 Dapper 进行数据访问（在 ASP.NET MVC3 FWIW 中）。我有一个 T-SQL 视图（在 SQL Server 中），它是这样的：

```
SELECT s.*, c.CompanyId AS BreakPoint c.Name AS CompanyName
FROM tblStaff AS s
INNER JOIN tblCompanies AS c ON c.CompanyId = s.CompanyId 
```

非常简单。本质上是一个员工列表，每个员工都有一个公司。

我遇到的问题是我正在尝试将此查询的输出映射到我的 POCO，但是因为视图中的每个字段都必须是唯一的（即 CompanyName 而不是 tblStaff 中已经存在的 Name）映射到 POCO不工作。

这是代码：

```
var sql = @"select * from qryStaff";
var people = _db.Query<Person, Company, Person>(sql, (person, company) => {person.Company = company; return person;}, splitOn: "BreakPoint"); 
```

有什么建议我可以如何解决这个难题？我愿意改变我的观点，因为现在我对如何进步感到困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:05:06.723

您应该明确列出从您的视图返回的所有字段（没有星号！）并且字段名称不是唯一的，使用别名进行重复数据删除。例如：

```
SELECT 
    s.CompanyName as CompanyName1, 
    s.BreakPoint as BreakPoint1,
    ...
    c.CompanyId AS BreakPoint,
    c.Name AS CompanyName
FROM tblStaff AS s
INNER JOIN tblCompanies AS c ON c.CompanyId = s.CompanyId 
```

当然，列出的字段和您可能使用的别名完全取决于您的代码。通常，您调整查询中的别名以匹配 POCO 的属性名称。

此外，作为一般经验法则，最好远离 SQL 查询中的通配符，因为引入了此类问题。[这是一篇](http://www.databasejournal.com/features/mssql/article.php/3827091/T-SQL-Best-Practices.htm)关于 SQL 查询最佳实践的不错的文章。

摘抄：

> 在代码中的 SELECT 语句中使用明确的列名称有许多优点。首先，SQL Server 只返回您的应用程序需要的数据，而不是您的应用程序不会使用的一堆附加数据。通过只返回您需要的数据，您可以优化 SQL Server 收集您需要的所有信息列所需的工作量。此外，通过不使用星号 (*) 命名法，您还可以最大限度地减少将与您的 SELECT 语句关联的数据发送到应用程序所需的网络流量（字节数）。
> 
> 此外，通过显式命名列，您可以使应用程序免受与某些数据库架构更改相关的潜在故障的影响，这些更改可能发生在您在 SELECT 语句中引用的任何表上。如果您要使用星号 (*) 命名法并且有人要向表中添加一个新列，您的应用程序将开始接收此附加数据列的数据，即使不更改您的应用程序代码。如果您的应用程序只希望返回特定数量的列，那么一旦有人向您引用的表之一添加了额外的列，它就会失败。因此，通过在 SELECT 语句中显式命名列，您的应用程序将始终返回相同数量的列，

# mysql - 多进程访问并存储 1,000,000,000+ 4 列行的临时表的表设计

> ID：10213360
> 
> 赞同：1
> 
> 时间：2012-04-18T16:03:33.133
> 
> 标签：mysql, architecture

我正在使用 MySQL 临时存储十亿或更多结果的结果，其中结果是由并行执行的进程计算的。每个结果都是使用函数 [f] 对分别由 [o1] 和 [o2] 标识的对象的表示 [r1] 和 [r2] 计算的。目前，我使用三个表来执行此过程： (1) 将对象标识符映射到其表示的表：

```
mysql> describe v2_3282_fp;
+----------------+------+------+-----+---------+-------+
| Field          | Type | Null | Key | Default | Extra |
+----------------+------+------+-----+---------+-------+
| objid          | text | YES  |     | NULL    |       |
| representation | text | YES  |     | NULL    |       |
+----------------+------+------+-----+---------+-------+ 
```

(2) 保存每个计算进程应检索并计算的作业的表：

```
mysql> describe v2_3282_job;
+----------+---------------------+------+-----+---------+----------------+
| Field    | Type                | Null | Key | Default | Extra          |
+----------+---------------------+------+-----+---------+----------------+
| jobid    | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| workerid | int(11)             | YES  |     | NULL    |                |
| pairid1  | text                | YES  |     | NULL    |                |
| pairid2  | text                | YES  |     | NULL    |                |
+----------+---------------------+------+-----+---------+----------------+ 
```

(3) 保存计算作业结果的表：

```
mysql> describe v2_3282_res;
+-----------+---------------------+------+-----+---------+----------------+
| Field     | Type                | Null | Key | Default | Extra          |
+-----------+---------------------+------+-----+---------+----------------+
| resultid  | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |
| pairid1   | text                | YES  |     | NULL    |                |
| pairid2   | text                | YES  |     | NULL    |                |
| pairscore | double(36,18)       | YES  |     | NULL    |                |
+-----------+---------------------+------+-----+---------+----------------+ 
```

（pairscore 类型是在执行期间动态确定的，而不是固定为 (36,18) 。）

注册表示后，一个进程会不断扫描结果表以查找新结果以传输到内存中存在的对象，其余进程检索作业以进行计算，直到它们收到带有一对标识符的作业，表示计算结束。

在进行 1,000,000 次左右计算的单元测试期间，该系统运行良好。然而，随着使用该系统的需求增长到 1,000,000,000+，我看到系统最终陷入内存和磁盘之间来回交换的困境。当我检查正在使用的系统内存和交换空间时，使用的系统内存已完全使用，但通常不到 20% 的交换空间被使用。

我已经读到，当整个表都可以读入内存时，MySQL 的性能是最好的，而磁盘 I/O 是主要的瓶颈。这似乎对我来说也是如此，因为在我的具有 12 GB 和 16 GB RAM 的系统上运行计算最终需要越来越多的工作进程周期之间的时间，尽管我只有 64 GB 的系统似乎从未遇到过这个问题。

虽然直截了当的回答是“嘿，伙计，买更多的 RAM。”，但我认为有一个更基本的设计问题导致我的系统随着需求的增长而降级。我知道 MySQL 是一个广泛使用的精心设计的产品，数据库和表的设计考虑会极大地影响性能。

因此，在不求助于购买更多内存的蛮力解决方案的情况下，我正在寻找有关如何改进我提出的 MySQL 表设计工程的建议。虽然我了解 MySQL 表规范化的基础知识并且可以创建查询来实现我的需求，但我对每种类型的数据库引擎、索引的详细信息以及其他特定于数据库的设计注意事项知之甚少。

我的问题是：（1）如果我将结果表和作业表拆分为较小的表而不是单个大表，性能会有所不同吗？（我认为不是。）（2）我目前以编程方式发出一个限制子句，以在每个检索周期中检索固定数量的结果。但是，我不知道这是否可以通过简单的“SELECT ... FROM [result table] LIMIT start, size”进一步优化。（我想是的。） （3）告诉工作进程在周期之间休眠以让 MySQL “赶上”是否有意义？（我想不是。）

我提前感谢那些在数据库和表设计方面经验丰富的人提供的任何建议。

# javascript - 如何在 Three.js 中渲染地球上的“大气”？

> ID：10213361
> 
> 赞同：23
> 
> 时间：2012-04-18T16:03:33.683
> 
> 标签：javascript, html, three.js

在过去的几天里，我一直在尝试让 Three.js 纹理工作。我一直遇到的问题是我的浏览器阻止加载纹理，按照[此处](https://github.com/mrdoob/three.js/wiki/How-to-run-things-locally)的说明解决了这个问题。

无论如何，我正在为我的一个班级制作一个太空导航游戏，演示如何在太空中导航航天器。所以，我正在渲染一堆行星，地球就是其中之一。我在下面附上了我的地球渲染图。看起来不错，但我想做的是通过在地球周围添加一个“气氛”来让它看起来更真实。

我环顾四周，发现了一些非常[整洁的](http://bkcore.com/blog/3d/webgl-three-js-animated-selective-glow.html)处理发光的创作，但不幸的是，我认为它们不适用于我的情况。

这是将地球添加到我的场景的代码（这是我从 Three.js 教程中获得的代码的修改版本）：

```
 function addEarth(x,y){

        var sphereMaterial =
        new THREE.MeshLambertMaterial({
            //color: 0x0000ff,
            map: earthTexture
        });

        // set up the sphere vars
        var radius = 75;
        segments = 16;
        rings = 16;

        // create a new mesh with
        // sphere geometry - we will cover
        // the sphereMaterial next!
        earth = new THREE.Mesh(

        new THREE.SphereGeometry(
        radius,
        segments,
        rings),

        sphereMaterial);

        earth.position.x = x;
        earth.position.y = y;

        // add the sphere to the scene
        scene.add(earth);
    } 
```

![在此处输入图像描述](../Images/fadf6d5963a8e9676ff2fb2356b87651.png)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-10-29T13:31:50.350

好吧，一个古老且已经回答的问题，但我想添加我的解决方案以供初学者考虑。玩了很长时间的大气散射和 GLSL，开发了这个 VEEERRRYYY 大气散射的简化版本（如果动画停止刷新页面或以更堕落的方式查看**GIF ）：**

[![示例[1]](../Images/e8b400676690b2793c29a2ef3867d3ec.png)

1.  行星是和椭球体（中心`x,y,`z 和半径`rx,ry,rz`）
2.  大气也是椭球体（相同但大气高度更大）
3.  所有渲染都正常完成，但最重要的是为近观察者星球添加了 1 个通道
4.  该通行证是覆盖整个屏幕的单四边形
5.  在片段内部，它计算像素射线与这两个椭球的交点
6.  取可见部分（不是在后面，不是在地面之后）
7.  计算大气层内的射线长度
8.  通过光线长度将原始颜色扭曲为`r,g,b`缩放参数的函数（类似于沿路径积分）
    *   一些颜色是给定的......
    *   极大地影响颜色，因此只需几个属性就可以模拟不同的气氛
9.  它在大气层内外（从远处）都能很好地工作
10.  可以添加近恒星作为光源（我使用最大 3 星系统）

结果令人惊叹，请参见下图：

![在此处输入图像描述](../Images/79a4c065c702921189572129a40cd0c0.png) ![在此处输入图像描述](../Images/dc16a846d580becf3334b1f1c127f5d4.png) ![在此处输入图像描述](../Images/56fe109126e1d1629952d61095778fd9.png) ![在此处输入图像描述](../Images/b777abf96047c10b0f47a214268846ec.png) ![在此处输入图像描述](../Images/8aa1818cc1b9e9a7e53bfb37cf46c361.png)

顶点：

```
/* SSH GLSL Atmospheric Ray light scattering ver 3.0

    glEnable(GL_BLEND);
    glBlendFunc(GL_ONE,GL_ONE);
    use with single quad covering whole screen

    no Modelview/Projection/Texture matrixes used

    gl_Normal   is camera direction in ellipsoid space
    gl_Vertex   is pixel in ellipsoid space
    gl_Color    is pixel pos in screen space <-1,+1>

    const int _lights=3;
    uniform vec3 light_dir[_lights];     // direction to local star in ellipsoid space
    uniform vec3 light_col[_lights];     // local star color * visual intensity
    uniform vec4 light_posr[_lights];    // local star position and radius^-2 in ellipsoid space
    uniform vec4 B0;                     // atmosphere scattering coefficient (affects color) (r,g,b,-)

    [ToDo:]
    add light map texture for light source instead of uniform star colide parameters
    - all stars and distant planets as dots
    - near planets ??? maybe too slow for reading pixels
    aspect ratio correction
*/

varying vec3 pixel_nor;       // camera direction in ellipsoid space
varying vec4 pixel_pos;       // pixel in ellipsoid space

void main(void)
    {
    pixel_nor=gl_Normal;
    pixel_pos=gl_Vertex;
    gl_Position=gl_Color;
    } 
```

分段：

```
varying vec3 pixel_nor;              // camera direction in ellipsoid space
varying vec4 pixel_pos;              // pixel in ellipsoid space

uniform vec3 planet_r;               // rx^-2,ry^-2,rz^-2 - surface
uniform vec3 planet_R;               // Rx^-2,Ry^-2,Rz^-2 - atmosphere
uniform float planet_h;              // atmoshere height [m]
uniform float view_depth;            // max. optical path length [m] ... saturation

// lights are only for local stars-atmosphere ray colision to set start color to star color
const int _lights=3;
uniform vec3 light_dir[_lights];     // direction to local star in ellipsoid space
uniform vec3 light_col[_lights];     // local star color * visual intensity
uniform vec4 light_posr[_lights];    // local star position and radius^-2 in ellipsoid space
uniform vec4 B0;                     // atmosphere scattering coefficient (affects color) (r,g,b,-)

// compute length of ray(p0,dp) to intersection with ellipsoid((0,0,0),r) -> view_depth_l0,1
// where r.x is elipsoid rx^-2, r.y = ry^-2 and r.z=rz^-2
float view_depth_l0=-1.0,view_depth_l1=-1.0;
bool _view_depth(vec3 p0,vec3 dp,vec3 r)
    {
    float a,b,c,d,l0,l1;
    view_depth_l0=-1.0;
    view_depth_l1=-1.0;
    a=(dp.x*dp.x*r.x)
     +(dp.y*dp.y*r.y)
     +(dp.z*dp.z*r.z); a*=2.0;
    b=(p0.x*dp.x*r.x)
     +(p0.y*dp.y*r.y)
     +(p0.z*dp.z*r.z); b*=2.0;
    c=(p0.x*p0.x*r.x)
     +(p0.y*p0.y*r.y)
     +(p0.z*p0.z*r.z)-1.0;
    d=((b*b)-(2.0*a*c));
    if (d<0.0) return false;
    d=sqrt(d);
    l0=(-b+d)/a;
    l1=(-b-d)/a;
    if (abs(l0)>abs(l1)) { a=l0; l0=l1; l1=a; }
    if (l0<0.0)          { a=l0; l0=l1; l1=a; }
    if (l0<0.0) return false;
    view_depth_l0=l0;
    view_depth_l1=l1;
    return true;
    }
// determine if ray (p0,dp) hits a sphere ((0,0,0),r)
// where r is (sphere radius)^-2
bool _star_colide(vec3 p0,vec3 dp,float r)
    {
    float a,b,c,d,l0,l1;
    a=(dp.x*dp.x*r)
     +(dp.y*dp.y*r)
     +(dp.z*dp.z*r); a*=2.0;
    b=(p0.x*dp.x*r)
     +(p0.y*dp.y*r)
     +(p0.z*dp.z*r); b*=2.0;
    c=(p0.x*p0.x*r)
     +(p0.y*p0.y*r)
     +(p0.z*p0.z*r)-1.0;
    d=((b*b)-(2.0*a*c));
    if (d<0.0) return false;
    d=sqrt(d);
    l0=(-b+d)/a;
    l1=(-b-d)/a;
    if (abs(l0)>abs(l1)) { a=l0; l0=l1; l1=a; }
    if (l0<0.0)          { a=l0; l0=l1; l1=a; }
    if (l0<0.0) return false;
    return true;
    }

// compute atmosphere color between ellipsoids (planet_pos,planet_r) and (planet_pos,planet_R) for ray(pixel_pos,pixel_nor)
vec3 atmosphere()
    {
    const int n=8;
    const float _n=1.0/float(n);
    int i;
    bool b0,b1;
    vec3 p0,p1,dp,p,c,b;
    // c - color of pixel from start to end

    float l0,l1,l2,h,dl;
    c=vec3(0.0,0.0,0.0);
    b0=_view_depth(pixel_pos.xyz,pixel_nor,planet_r);
    if ((b0)&&(view_depth_l0>0.0)&&(view_depth_l1<0.0)) return c;
    l0=view_depth_l0;
    b1=_view_depth(pixel_pos.xyz,pixel_nor,planet_R);
    l1=view_depth_l0;
    l2=view_depth_l1;

    dp=pixel_nor;
    p0=pixel_pos.xyz;

    if (!b0)
        {                                       // outside surface
        if (!b1) return c;                      // completly outside planet
        if (l2<=0.0)                            // inside atmosphere to its boundary
            {
            l0=l1;
            }
        else{                                   // throu atmosphere from boundary to boundary
            p0=p0+(l1*dp);
            l0=l2-l1;
            }
        // if a light source is in visible path then start color is light source color
        for (i=0;i<_lights;i++)
        if (light_posr[i].a<=1.0)
        if (_star_colide(p0-light_posr[i].xyz,dp,light_posr[i].a))
        c+=light_col[i];
        }
    else{                                       // into surface
        if (l0<l1) b1=false;                    // atmosphere is behind surface
        if (!b1)                                // inside atmosphere to surface
            {
            l0=l0;
            }
        else{                                   // from atmosphere boundary to surface
            p0=p0+(l1*dp);
            l0=l0-l1;
            }
        }
    dp*=l0;
    p1=p0+dp;
    dp*=_n;
/*
    p=normalize(p1);
    h=0.0; l2=0.0;
    for (i=0;i<_lights;i++)
     if (light_posr[i].a<=1.0)
        {
        dl=dot(pixel_nor,light_dir[i]);         // cos(ang: light-eye)
        if (dl<0.0) dl=0.0;
        h+=dl;
        dl=dot(p,light_dir[i]);                 // normal shading
        if (dl<0.0) dl=0.0;
        l2+=dl;
        }
    if (h>1.0) h=1.0;
    if (l2>1.0) l2=1.0;
    h=0.5*(2.0+(h*h));
*/
    float qqq=dot(normalize(p1),light_dir[0]);

    dl=l0*_n/view_depth;
    for (p=p1,i=0;i<n;p-=dp,i++)                // p1->p0 path throu atmosphere from ground
        {
        _view_depth(p,normalize(p),planet_R);   // view_depth_l0=depth above atmosphere top [m]
        h=exp(view_depth_l0/planet_h)/2.78;

        b=B0.rgb*h*dl;
        c.r*=1.0-b.r;
        c.g*=1.0-b.g;
        c.b*=1.0-b.b;
        c+=b*qqq;
        }
    if (c.r<0.0) c.r=0.0;
    if (c.g<0.0) c.g=0.0;
    if (c.b<0.0) c.b=0.0;
    h=0.0;
    if (h<c.r) h=c.r;
    if (h<c.g) h=c.g;
    if (h<c.b) h=c.b;
    if (h>1.0)
        {
        h=1.0/h;
        c.r*=h;
        c.g*=h;
        c.b*=h;
        }
    return c;
    }

void main(void)
    {
    gl_FragColor.rgb=atmosphere();
    } 
```

对不起，但它是我的一个非常古老的来源......应该可能转换为核心配置文件

**[编辑 1]**抱歉忘记为地球大气添加我的输入散射常数

```
 double view_depth=1000000.0;    // [m] ... longer path is saturated atmosphere color
    double ha=40000.0;              // [m] ... usable atmosphere height (higher is too low pressure)

//  this is how B0 should be computed (for real atmospheric scattering with nested volume integration)
//  const float lambdar=650.0*0.000000001; // wavelengths for R,G,B rays
//  const float lambdag=525.0*0.000000001;
//  const float lambdab=450.0*0.000000001;
//  double r=1.0/(lambdar*lambdar*lambdar*lambdar); // B0 coefficients
//  double g=1.0/(lambdag*lambdag*lambdag*lambdag);
//  double b=1.0/(lambdab*lambdab*lambdab*lambdab);

//  and these are my empirical coefficients for earth like 
//  blue atmosphere with my simplified integration style
//  images above are rendered with this:
    float r=0.198141888310295;
    float g=0.465578010163675;
    float b=0.862540960504986;
    float B0=2.50000E-25;
    i=glGetUniformLocation(ShaderProgram,"planet_h");   glUniform1f(i,ha);
    i=glGetUniformLocation(ShaderProgram,"view_depth"); glUniform1f(i,view_depth);
    i=glGetUniformLocation(ShaderProgram,"B0");     glUniform4f(i,r,g,b,B0);
//  all other atributes are based on position and size of planet and are 
//  pretty straightforward so here is just the earth size i use ...
    double r_equator=6378141.2; // [m]
    double r_poles=6356754.8;   // [m] 
```

**[edit2] 3.9.2014 新源代码**

我最近有一些时间来实现对我的引擎的缩放，并发现原始源代码从 0.002 AU 以上的距离不是很精确。没有缩放，它只有几个像素，所以什么都看不到，但是缩放所有变化，所以我尽量提高准确性。

*   这里[射线和椭球相交精度的提高](https://stackoverflow.com/q/25470493/2521214)是与此相关的问题

经过一些更多的调整后，我发现它可以使用高达 25.0 AU，并且插值伪影高达 50.0-100.0 AU。这是当前硬件的限制，因为我无法将非`flat fp64`从顶点传递到片段的插值器。一种解决方法可能是将坐标系变换移动到片段但尚未尝试过。以下是一些变化：

*   新源使用 64 位浮点数
*   并添加`uniform int lights`这是使用过的灯的数量
*   B0 含义也有一些变化（它们不再是依赖于波长的常数，而是颜色），因此您需要稍微更改 CPU 代码中的统一值填充。
*   添加了一些性能改进

[顶点]

```
/* SSH GLSL Atmospheric Ray light scattering ver 3.1

    glEnable(GL_BLEND);
    glBlendFunc(GL_ONE,GL_ONE_MINUS_SRC_ALPHA);
    use with single quad covering whole screen

    no Modelview/Projection/Texture matrixes used

    gl_Normal   is camera direction in ellipsoid space
    gl_Vertex   is pixel in ellipsoid space
    gl_Color    is pixel pos in screen space <-1,+1>

    const int _lights=3;
    uniform int  lights;                 // actual number of lights
    uniform vec3 light_dir[_lights];     // direction to local star in ellipsoid space
    uniform vec3 light_col[_lights];     // local star color * visual intensity
    uniform vec4 light_posr[_lights];    // local star position and radius^-2 in ellipsoid space
    uniform vec4 B0;                     // atmosphere scattering coefficient (affects color) (r,g,b,-)

    [ToDo:]
    add light map texture for light source instead of uniform star colide parameters
    - all stars and distant planets as dots
    - near planets ??? maybe too slow for reading pixels
    aspect ratio correction
*/

varying vec3 pixel_nor;       // camera direction in ellipsoid space
varying vec4 pixel_pos;       // pixel in ellipsoid space
varying vec4 pixel_scr;       // pixel in screen space <-1,+1>

varying vec3 p_r;               // rx,ry,rz
uniform vec3 planet_r;          // rx^-2,ry^-2,rz^-2 - surface

void main(void)
    {
    p_r.x=1.0/sqrt(planet_r.x);
    p_r.y=1.0/sqrt(planet_r.y);
    p_r.z=1.0/sqrt(planet_r.z);
    pixel_nor=gl_Normal;
    pixel_pos=gl_Vertex;
    pixel_scr=gl_Color;
    gl_Position=gl_Color;
    } 
```

[分段]

```
#extension GL_ARB_gpu_shader_fp64 : enable
double abs(double x) { if (x<0.0) x=-x; return x; }

varying vec3 pixel_nor;              // camera direction in ellipsoid space
varying vec4 pixel_pos;              // pixel in ellipsoid space
varying vec4 pixel_scr;              // pixel in screen space
varying vec3 p_r;                    // rx,ry,rz                        

uniform vec3 planet_r;               // rx^-2,ry^-2,rz^-2 - surface
uniform vec3 planet_R;               // Rx^-2,Ry^-2,Rz^-2 - atmosphere
uniform float planet_h;              // atmoshere height [m]
uniform float view_depth;            // max. optical path length [m] ... saturation

// lights are only for local stars-atmosphere ray colision to set start color to star color
const int _lights=3;
uniform int  lights;                 // actual number of lights
uniform vec3 light_dir[_lights];     // direction to local star in ellipsoid space
uniform vec3 light_col[_lights];     // local star color * visual intensity
uniform vec4 light_posr[_lights];    // local star position and radius^-2 in ellipsoid space
uniform vec4 B0;                     // atmosphere scattering color coefficients (r,g,b,ambient)

// compute length of ray(p0,dp) to intersection with ellipsoid((0,0,0),r) -> view_depth_l0,1
// where r.x is elipsoid rx^-2, r.y = ry^-2 and r.z=rz^-2
const double view_depth_max=100000000.0; // > max view depth
double view_depth_l0=-1.0, // view_depth_l0 first hit
       view_depth_l1=-1.0; // view_depth_l1 second hit
bool  _view_depth_l0=false;
bool  _view_depth_l1=false;
bool _view_depth(vec3 _p0,vec3 _dp,vec3 _r)
    {
    dvec3 p0,dp,r;
    double a,b,c,d,l0,l1;
    view_depth_l0=-1.0; _view_depth_l0=false;
    view_depth_l1=-1.0; _view_depth_l1=false;
    // conversion to double
    p0=dvec3(_p0);
    dp=dvec3(_dp);
    r =dvec3(_r );
    // quadratic equation a.l.l+b.l+c=0; l0,l1=?;
    a=(dp.x*dp.x*r.x)
     +(dp.y*dp.y*r.y)
     +(dp.z*dp.z*r.z);
    b=(p0.x*dp.x*r.x)
     +(p0.y*dp.y*r.y)
     +(p0.z*dp.z*r.z); b*=2.0;
    c=(p0.x*p0.x*r.x)
     +(p0.y*p0.y*r.y)
     +(p0.z*p0.z*r.z)-1.0;
    // discriminant d=sqrt(b.b-4.a.c)
    d=((b*b)-(4.0*a*c));
    if (d<0.0) return false;
    d=sqrt(d);
    // standard solution l0,l1=(-b +/- d)/2.a
    a*=2.0;
    l0=(-b+d)/a;
    l1=(-b-d)/a;
    // alternative solution q=-0.5*(b+sign(b).d) l0=q/a; l1=c/q; (should be more accurate sometimes)
//  if (b<0.0) d=-d; d=-0.5*(b+d);
//  l0=d/a;
//  l1=c/d;
    // sort l0,l1 asc
    if ((l0<0.0)||((l1<l0)&&(l1>=0.0))) { a=l0; l0=l1; l1=a; }
    // exit
    if (l1>=0.0) { view_depth_l1=l1; _view_depth_l1=true; }
    if (l0>=0.0) { view_depth_l0=l0; _view_depth_l0=true; return true; }
    return false;
    }

// determine if ray (p0,dp) hits a sphere ((0,0,0),r)
// where r is (sphere radius)^-2
bool _star_colide(vec3 _p0,vec3 _dp,float _r)
    {
    dvec3 p0,dp,r;
    double a,b,c,d,l0,l1;
    // conversion to double
    p0=dvec3(_p0);
    dp=dvec3(_dp);
    r =dvec3(_r );
    // quadratic equation a.l.l+b.l+c=0; l0,l1=?;
    a=(dp.x*dp.x*r)
     +(dp.y*dp.y*r)
     +(dp.z*dp.z*r);
    b=(p0.x*dp.x*r)
     +(p0.y*dp.y*r)
     +(p0.z*dp.z*r); b*=2.0;
    c=(p0.x*p0.x*r)
     +(p0.y*p0.y*r)
     +(p0.z*p0.z*r)-1.0;
    // discriminant d=sqrt(b.b-4.a.c)
    d=((b*b)-(4.0*a*c));
    if (d<0.0) return false;
    d=sqrt(d);
    // standard solution l0,l1=(-b +/- d)/2.a
    a*=2.0;
    l0=(-b+d)/a;
    l1=(-b-d)/a;
    // alternative solution q=-0.5*(b+sign(b).d) l0=q/a; l1=c/q; (should be more accurate sometimes)
//  if (b<0.0) d=-d; d=-0.5*(b+d);
//  l0=d/a;
//  l1=c/d;
    // sort l0,l1 asc
    if (abs(l0)>abs(l1)) { a=l0; l0=l1; l1=a; }
    if (l0<0.0)          { a=l0; l0=l1; l1=a; }
    if (l0<0.0) return false;
    return true;
    }

// compute atmosphere color between ellipsoids (planet_pos,planet_r) and (planet_pos,planet_R) for ray(pixel_pos,pixel_nor)
vec4 atmosphere()
    {
    const int n=8;
    const float _n=1.0/float(n);
    int i;
    bool b0,b1;
    vec3 p0,p1,dp,p,b;
    vec4 c;     // c - color of pixel from start to end

    float h,dl,ll;
    double l0,l1,l2;
    bool   e0,e1,e2;
    c=vec4(0.0,0.0,0.0,0.0);    // a=0.0 full background color, a=1.0 no background color (ignore star)
    b1=_view_depth(pixel_pos.xyz,pixel_nor,planet_R);
    if (!b1) return c;                          // completly outside atmosphere
    e1=_view_depth_l0; l1=view_depth_l0;        // first atmosphere hit
    e2=_view_depth_l1; l2=view_depth_l1;        // second atmosphere hit
    b0=_view_depth(pixel_pos.xyz,pixel_nor,planet_r);
    e0=_view_depth_l0; l0=view_depth_l0;        // first surface hit
    if ((b0)&&(view_depth_l1<0.0)) return c;    // under ground
    // set l0 to view depth and p0 to start point
    dp=pixel_nor;
    p0=pixel_pos.xyz;
    if (!b0)                                    // outside surface
        {
        if (!e2)                                // inside atmosphere to its boundary
            {
            l0=l1;
            }
        else{                                   // throu atmosphere from boundary to boundary
            p0=vec3(dvec3(p0)+(dvec3(dp)*l1));
            l0=l2-l1;
            }
        // if a light source is in visible path then start color is light source color
        for (i=0;i<lights;i++)
         if (_star_colide(p0.xyz-light_posr[i].xyz,dp.xyz,light_posr[i].a*0.75)) // 0.75 is enlargment to hide star texture corona
            {
            c.rgb+=light_col[i];
            c.a=1.0; // ignore already drawed local star color
            }
        }
    else{                                       // into surface
        if (l1<l0)                              // from atmosphere boundary to surface
            {
            p0=vec3(dvec3(p0)+(dvec3(dp)*l1));
            l0=l0-l1;
            }
        else{                                   // inside atmosphere to surface
            l0=l0;
            }
        }
    // set p1 to end of view depth, dp to intergral step
    p1=vec3(dvec3(p0)+(dvec3(dp)*l0)); dp=p1-p0;
    dp*=_n;

    dl=float(l0)*_n/view_depth;
    ll=B0.a; for (i=0;i<lights;i++)             // compute normal shaded combined light sources into ll
     ll+=dot(normalize(p1),light_dir[0]);
    for (p=p1,i=0;i<n;p-=dp,i++)                // p1->p0 path throu atmosphere from ground
        {
//      _view_depth(p,normalize(p),planet_R);   // too slow... view_depth_l0=depth above atmosphere top [m]
//      h=exp(view_depth_l0/planet_h)/2.78;

        b=normalize(p)*p_r;                     // much much faster
        h=length(p-b);
        h=exp(h/planet_h)/2.78;

        b=B0.rgb*h*dl;
        c.r*=1.0-b.r;
        c.g*=1.0-b.g;
        c.b*=1.0-b.b;
        c.rgb+=b*ll;
        }
    if (c.r<0.0) c.r=0.0;
    if (c.g<0.0) c.g=0.0;
    if (c.b<0.0) c.b=0.0;
    h=0.0;
    if (h<c.r) h=c.r;
    if (h<c.g) h=c.g;
    if (h<c.b) h=c.b;
    if (h>1.0)
        {
        h=1.0/h;
        c.r*=h;
        c.g*=h;
        c.b*=h;
        }
    return c;
    }

void main(void)
    {
    gl_FragColor.rgba=atmosphere();
    } 
```

[统一值]

```
// Earth
re=6378141.2         // equatoreal radius r.x,r.y
rp=6356754.79506139 // polar radius r.z
planet_h=60000      // atmosphere thickness R(r.x+planet_h,r.y+planet_h,r.z+planet_h)
view_depth=250000   // max view distance before 100% scattering occur 
B0.r=0.1981         // 100% scattered atmosphere color
B0.g=0.4656
B0.b=0.8625
B0.a=0.75           // overglow (sky is lighter before Sun actually rise) it is added to light dot product

// Mars
re=3397000
rp=3374919.5
ha=30000
view_depth=300000
B0.r=0.4314
B0.g=0.3216
B0.b=0.196
B0.a=0.5 
```

有关更多信息（和更新的图像），另请参阅相关：

*   [是否有可能在大小和质量方面进行逼真的 n 体太阳系模拟？](https://stackoverflow.com/a/28020934/2521214)

**[编辑3]**

这是我在引擎中使用上面的着色器渲染气氛的一个小的**CPU端代码：**

```
if (sys->_enable_bodya) // has planet atmosphere?
 if (view_depth>=0.0)
    {
    glColor4f(1.0,1.0,1.0,1.0);
    double a,b,p[3],d[3];
    sys->shd_engine.unbind();
    sys->shd_scatter.bind(); // this is the atmospheric shader
    if (1) //*** GLSL_uniform_supported (leftover from old GL engine version)
        {
        int j;
        double *w;
        AnsiString s;
        a=re; b=rp; a=divide(1.0,a*a); b=divide(1.0,b*b); // radius of planet re equatoral and rp polar and ha is atmosphere thickness
        sys->shd_scatter.set3f("planet_r",a,a,b);
        a=re+ha; b=rp+ha;   a=divide(1.0,a*a); b=divide(1.0,b*b);
        sys->shd_scatter.set3f("planet_R"  ,a,a,b);
        sys->shd_scatter.set1f("planet_h"  ,ha);
        sys->shd_scatter.set1f("view_depth",view_depth); // visibility distance
        sys->shd_scatter.set4f("B0",B0[0],B0[1],B0[2],B0[3]); // saturated atmosphere color and overglow
        sys->shd_scatter.set1i("lights",sys->local_star.num); // local stars
        for (j=0;j<sys->local_star.num;j++)
            {
            a=sys->local_star[j].r;
            w=sys->local_star[j].p;
            s=AnsiString().sprintf("light_posr[%i]",j);
            sys->shd_scatter.set4f(s,w[0],w[1],w[2],divide(1.0,a*a));

            w=sys->local_star[j].d;
            s=AnsiString().sprintf("light_dir[%i]",j);
            sys->shd_scatter.set3f(s,w[0],w[1],w[2]);

            vector_mul(p,sys->local_star[j].col,10.0);
            s=AnsiString().sprintf("light_col[%i]",j);
            sys->shd_scatter.set3f(s,p[0],p[1],p[2]);
            }
        }
    glEnable(GL_BLEND);
    glBlendFunc(GL_ONE,GL_ONE_MINUS_SRC_ALPHA);
    a=1.0;
    b=-2.0*view.scr->views[view.scr->view].znear;
    // color  = pixel pos in screen space <-1,+1> ... no Projection/ModelView is used :)
    // vertex = pixel pos in elypsoid space
    // normal = eye-pixel direction in elypsoid space
    zsort.rep0.g2l_dir(d,zsort.obj_pos0);
    glDepthMask(0);
    glBegin(GL_QUADS);
    a=divide(1.0,view.zoom);
    glColor4d(-1.0,-1.0,0.0,1.0); vector_ld(p,-a,-a,b); view.scr->fromscr(p,p); view.eye0.l2g(q,p); zsort.rep0.g2l_dir(q,q); vector_sub(p,q,d); vector_one(q,q); glNormal3dv(q); glVertex3dv(p);
    glColor4d(+1.0,-1.0,0.0,1.0); vector_ld(p,+a,-a,b); view.scr->fromscr(p,p); view.eye0.l2g(q,p); zsort.rep0.g2l_dir(q,q); vector_sub(p,q,d); vector_one(q,q); glNormal3dv(q); glVertex3dv(p);
    glColor4d(+1.0,+1.0,0.0,1.0); vector_ld(p,+a,+a,b); view.scr->fromscr(p,p); view.eye0.l2g(q,p); zsort.rep0.g2l_dir(q,q); vector_sub(p,q,d); vector_one(q,q); glNormal3dv(q); glVertex3dv(p);
    glColor4d(-1.0,+1.0,0.0,1.0); vector_ld(p,-a,+a,b); view.scr->fromscr(p,p); view.eye0.l2g(q,p); zsort.rep0.g2l_dir(q,q); vector_sub(p,q,d); vector_one(q,q); glNormal3dv(q); glVertex3dv(p);
    glEnd();
    glDepthMask(1);
    glDisable(GL_BLEND);
    sys->shd_scatter.unbind();
    sys->shd_engine.bind();
    } 
```

它是从我的引擎中提取的，所以它使用了很多你没有的东西，但你知道这些东西是如何使用的……顺便说一句`l2g`，意思是从局部坐标转换到全局坐标，`g2l`反之亦然。如果`_dir`存在，`l2g_dir`则表示变换正在处理矢量而不是位置，因此没有平移。将`fromscr`屏幕转换`<-1,+1>`为 3D（相机本地）并将`vector_one`矢量标准化为单位一。希望我没有忘记解释一些事情......

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-04-18T16:38:11.957

你到底在寻找什么？它可以像在地球顶部渲染另一个稍大的透明球体一样简单，也可以*非常*复杂，实际上是折射进入它的光。（几乎就像皮肤渲染中使用的次表面散射）。

我自己从未尝试过这样的效果，但一些快速的谷歌搜索显示了一些有希望的结果。比如我觉得[这个效果](http://petrocket.blogspot.com/2010/01/simple-flexibile-atmosphere-shaders.html)看起来还不错，后来作者还跟进了一个更[详细的变体](http://petrocket.blogspot.com/2010/04/atmosphere-shader-update-and-treegrass.html)。如果您对更技术性的细分感兴趣，[该技术](http://www.cescg.org/CESCG-2005/papers/Brno-Josth-Radovan/index.html)会详细介绍很多理论背景。我敢肯定还有更多，你只需要四处逛逛。（说实话，我不知道这是一个如此受欢迎的渲染主题！）

如果您在这些技术的某些方面遇到问题，特别是适用于 Three.js，请不要犹豫！

[更新]

啊，对不起。是的，在没有事先着色器知识的情况下，这有点让你陷入困境。

第二个链接上的代码实际上是一个 DirectX FX 文件，核心代码是 HLSL，因此它不能简单地插入 WebGL，但两种着色器格式非常相似，通常在它们之间进行转换不是问题。如果你真的了解着色器，那就是。我建议在尝试深入研究像这样的复杂效果之前阅读着色器的工作原理。

我将从[本教程](http://aerotwist.com/tutorials/an-introduction-to-shaders-part-1/)之类的简单内容开始，它仅讨论如何使用 Three.js 运行基本着色器。一旦您知道如何让着色器与 Three.js 和 GLSL 一起使用，教程（例如[这个](http://www.lighthouse3d.com/opengl/glsl/)）将为您提供有关着色器如何工作以及您可以用它做什么的基础知识。

我知道这似乎需要大量的工作，但如果你想在 WebGL 中制作高级视觉效果（这当然符合高级效果的要求），你绝对*必须*了解着色器！

再说一次，如果您正在寻找快速解决方案，那么总是有我所说的透明球体选项。:)

# java - 如何将动态创建的 BufferedImage 实例的背景设置为透明？

> ID：10213362
> 
> 赞同：0
> 
> 时间：2012-04-18T16:03:38.050
> 
> 标签：java, bufferedimage

我正在尝试创建一个 BufferedImage 实例，该实例包含某种颜色的圆角矩形，并且在其他任何地方都是透明的。

我正在使用以下代码创建图像

```
 private BufferedImage createChromImage() {
    BufferedImage I = new BufferedImage(350, 20, ColorSpace.TYPE_RGB);
    Graphics2D g2 = I.createGraphics();

    g2.setPaint(new GradientPaint(0, 0, Color.DARK_GRAY, 100,
              100, Color.BLUE, false));

    g2.fillRoundRect(0, 0, 350, 20, 10, 10);

    return I;
 } 
```

我最终在黑色背景上得到一个圆角矩形，有没有办法可以在透明背景上得到它。我怀疑它需要不同的 ColorSpace 设置，但我不确定哪个.. 非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:20:40.967

在不支持透明度的图像中不能有透明背景。RGB 是没有透明度的 24 位图像。相反，您想使用 BufferedImage.TYPE_INT_ARGB 作为 BufferedImage 构造函数的参数：这将为您提供一个 alpha 通道来播放，这将允许透明度。

# iphone - 如何更改所有 UITableViewCells 的背景颜色

> ID：10213364
> 
> 赞同：3
> 
> 时间：2012-04-18T16:03:47.227
> 
> 标签：iphone, objective-c, ios, ipad, uitableview

我有一个非常简单的视图控制器，只有 a`UITableView`和 a `UIButton`，当点击按钮时，我想将所有的背景颜色更改`UITableViewCells`为绿色，因为有些单元格不可见，我使用这个循环来完成我的任务需要：

```
 - (IBAction)click:(id)sender {

for (int row = 0; row < [self.tableView numberOfRowsInSection:0]; row++)  {

    NSIndexPath* cellPath = [NSIndexPath indexPathForRow:row inSection:0];
    UITableViewCell* cell = [self.tableView cellForRowAtIndexPath:cellPath];

    cell.backgroundColor = [UIColor greenColor];

 }

} 
```

问题在于默认行为`UITableView`，它实际上并没有创建不可见的单元格，直到它们可见！所以不幸的是，上面的代码只适用于可见单元格。问题是，如何更改按钮点击上**所有单元格的颜色？**

ps 这个非常简单的项目示例[可以在这里下载](http://dl.dropbox.com/u/57066689/project29.zip)。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:08:43.130

你不必这样做

只需使用一个变量来保存单元格的背景颜色

```
UIColor cellColor; 
```

然后当你改变颜色调用

```
[tableView reloadData]; 
```

然后在

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
     UITableViewCell *cell = yourcell;

     ...
     ...
     ...

     cell.backgroundColor = cellColor;

     return cell ;
} 
```

完成！

**更新**

对不起，试试这个

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
     UITableViewCell *cell = yourcell;

     ...
     ...
     ...
    cell.textLabel.backgroundColor = [UIColor clearColor];
UIView* bgview = [[UIView alloc] initWithFrame:cell.bounds];
bgview.backgroundColor = [UIColor greenColor];
    [cell setBackgroundView:bgview];

     return cell ;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:21:01.197

您想使用 UITableViewDataSource 来处理此问题，因此只需在您的 .h 文件中创建一个 UIColor 变量，更改您的操作中的变量并告诉 tableView 重新加载它的数据，然后在数据源响应中设置颜色。

MyTableViewController.h

```
@interface MyTableViewController : UITableViewController {
    UIColor *cellColor;
}
-(IBAction)click:(id)sender; 
```

MyTableViewController.m

```
@implementation MyTableViewController

    -(IBAction)click:(id)sender{
        cellColor = [UIColor redColor];
        [self.tableView reloadData];
    }

    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        // Setup your cell
        cell.textLabel.backgroundColor = [UIColor clearColor];
        cell.detailTextLabel.backgroundColor = [UIColor clearColor];
        cell.accessoryView.backgroundColor = [UIColor clearColor];
        cell.contentView.backgroundColor = cellColor;
        return cell;
    }

@end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T17:35:01.877

您在对 Paul Hunter 的回答的评论中声明“不会为整个细胞着色”。

尝试设置背景视图：

```
cell.backgroundView = [[[UIView alloc] init] autorelease]; 
cell.backgroundView.backgroundColor = self.cellColor; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T11:45:43.727

在您的代码中只需更改此方法

可能这是你的临时解决方案

```
-(IBAction)click:(id)sender 
{

    self.tableView.backgroundColor=[UIColor greenColor];

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T16:17:15.867

将颜色存储为保留`property`并在单击按钮时进行设置。

```
@property (retain, nonatomic) UIColor *cellColor;

....

- (IBAction)click:(id)sender {
    self.cellColor = [UIColor greenColor];

    for (int row = 0; row < [self.tableView numberOfRowsInSection:0]; row++)  {

        NSIndexPath* cellPath = [NSIndexPath indexPathForRow:row inSection:0];
        UITableViewCell* cell = [self.tableView cellForRowAtIndexPath:cellPath];

        cell.contentView.backgroundColor = self.cellColor;
        cell.textLabel.backgroundColor = self.cellColor;
    }

} 
```

您还可以选择重新加载整体`tableView`而不是遍历单元格。

```
- (IBAction)click:(id)sender {
    self.cellColor = [UIColor greenColor];    
    [self.tableView reloadData];
} 
```

然后`tableView:cellForRowAtIndexPath:`检查是否`property`已设置并设置`contentView`背景`textLabel`颜色。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    ...
    if (self.cellColor) {
        cell.contentView.backgroundColor = self.cellColor;
        cell.textLabel.backgroundColor = self.cellColor;
    }
    return cell;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-21T09:52:53.707

这个链接可以解决你的问题，它有类似的问题，比如你 [在 iPhone 上设置表格视图单元格的背景颜色](https://stackoverflow.com/questions/900094/setting-background-color-of-a-table-view-cell-on-iphone)

# android - Android NDK 原生代码真原生？

> ID：10213365
> 
> 赞同：4
> 
> 时间：2012-04-18T16:03:52.933
> 
> 标签：android, android-ndk

我想知道在本机代码中执行加密功能是否更安全。使用 Java，您无法确定 GC 是否重新排序内存并在内存中留下密钥的浅表副本，即使您在加密/解密后立即将密钥清零。

也许这是一个愚蠢的问题，但我找不到任何信息。本机代码仍在沙盒中运行并在 VM 中运行，那么 GC/VM/系统是否可以重新排序内存并因此留下浅拷贝？那么堆栈和堆是静态的还是可以移动的？AFAIK 他们有虚拟地址，所以可以这样做。

感谢你并致以真诚的问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:07:15.767

本机代码是为 ARM（我认为现在是英特尔）而不是 Dalvik VM 编译的，它直接在处理器上运行，由 Dalvik 加载和调用，但它不受它直接控制。本机代码的堆栈和堆是真实的。调用 memcpy/memset 将永久更改内存。

所有现代系统也都有虚拟内存，所以这是你可能会得到的安全性。

# json - 将 bidir 循环引用序列化为 JSON 的最佳方法

> ID：10213370
> 
> 赞同：1
> 
> 时间：2012-04-18T16:04:19.180
> 
> 标签：json, serialization, spring-mvc, orm, jackson

我有一个数据结构 BookCollection，其中包含一组书籍。每本书都引用了它所在的 BookCollection。这是标准的一对多关系。它在服务器端运行良好，但随后我必须将其发送到客户端。该应用程序使用 Jackson ObjectMapper 进行序列化，设置为 Spring Bean。问题是您不能简单地序列化 BookCollection 和 Books，因为标准 JSON 中没有引用（我确实需要标准 JSON）。

当前的解决方案是将@JsonIgnore 放在Book.collection 字段上，或者更高级，将@JsonManagedReference 放在BookCollection.books 上，将@JsonBackReference 放在Book.collection 上。然而，这并不能解决我所有的问题，一些请求要求一个 Book 对象，并且还想获得它的 BookCollection。

最终，我正在寻找某种方法来告诉序列化程序只包含每个对象一次。因此，当我拿到一本书时，JSON 看起来像这样：

```
{
  isbn: 125412416,
  title: "Introduction to JSON",
  collection: {
     name: "Programming Books",
     books: [
         {
             isbn: 18723425,
             title: "Java for experts"
         },
         {
             isbn: 82472347,
             title: "C# and its extensions"
         },
     ]
  }
} 
```

虽然“C# 及其扩展”和“专家级 Java”也有对集合对象的引用，但它没有被序列化，因为它已经被序列化了。此外，集合对象不包括“JSON 简介”一书，因为它已经被序列化了。

当我要求 BookCollection 时，我得到了这个：

```
{
  name: "Programming Book",
  books: [
    {
      isbn: 125412416,
      title: "Introduction to JSON"
    },
    {
      isbn: 18723425,
      title: "Java for experts"
    },
    {
      isbn: 82472347,
      title: "C# and its extensions"
    },
  ]
} 
```

## 序列化字段一次

虽然 BookCollection 连载精彩，但 Book 有点混乱，因为目录现在有一些书（缺少原版）。更好的是允许指定对每个**字段进行**一次序列化。让 Book.collection 被允许序列化一次

序列化一本书将如下所示：

```
{
  isbn: 125412416,
  title: "Introduction to JSON",
  collection: {
     name: "Programming Books",
     books: [
         {
             isbn: 18723425,
             title: "Java for experts"
         },
         {
             isbn: 82472347,
             title: "C# and its extensions"
         },
         {
             isbn: 125412416,
             title: "Introduction to JSON"
         }
     ]
  }
} 
```

序列化图书收藏是类似的：

```
{
  name: "Programming Book",
  books: [
    {
      isbn: 125412416,
      title: "Introduction to JSON"
    },
    {
      isbn: 18723425,
      title: "Java for experts"
    },
    {
      isbn: 82472347,
      title: "C# and its extensions"
    },
  ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T15:04:02.430

我最近遇到了一个类似的问题：[Jackson - serialization of entity with birectional Relations (avoiding cycles)](https://stackoverflow.com/questions/10065002/jackson-serialization-of-entities-with-birectional-relationships-avoiding-cyc)

所以解决方案是升级到 Jackson 2.0，并在类中添加以下注释：

```
@JsonIdentityInfo(generator = ObjectIdGenerators.IntSequenceGenerator.class, 
                  property = "@id")
public class SomeEntityClass ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T08:16:07.927

```
 namespace ConsoleApplication4
    {
        public class Teacher
        {
            public int MyProperty { get; set; }
            // [ScriptIgnore]
            public ClassRoom working { get; set; }
        }
        public class ClassRoom
        {
            public ClassRoom()
            {

            }
            public int sss { get; set; }
            public int s2 { get; set; }
            public int ddy { get; set; }
            //  [ScriptIgnore]
            public Teacher teachers { get; set; }

        }
        class Program
        {
            static void Main(string[] args)
            {  
                Console.ForegroundColor = ConsoleColor.Green;

                ClassRoom @new = new ClassRoom();
                Teacher @teacher = new Teacher();
                @new.teachers = teacher;
                @teacher.working = @new;

                JavaScriptSerializer serializer = new JavaScriptSerializer();

                List<  ClassRoom> classrooms = new List<ClassRoom>();
                classrooms.Add(@new);
                classrooms.Add(@new);
                classrooms.Add(@new);
                classrooms.Add(@new);
                classrooms.Add(@new);

                var result = (from n in classrooms
                              select n).ToList();//tolist() to convert IEnumrable to list can be modified

                for (int i = 0; i < result.Count; i++)
                {
                    result[i].teachers.working = null;//making all child's parents =null to prevent circular refrencing
                }

                Console.WriteLine(serializer.Serialize(result));

                 Console.ReadLine();
            }
        }

    } 
```

我认为这个解决方案可以解决你的问题，它解决了我的问题（result[i].teachers.working = null;）使导致循环引用的属性 =null;

# android - 屏幕方向和片段

> ID：10213372
> 
> 赞同：2
> 
> 时间：2012-04-18T16:04:23.463
> 
> 标签：android, android-layout, fragment, android-orientation

有一件事真的让我抓狂。屏幕的布局没有正确地从陆地变为纵向。

我的布局文件夹中有两个文件夹来处理其中的方向和 .xml 文件，如下所示：

```
layout\main.xml  

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:orientation="vertical" 
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent">

<fragment
    android:id="@+id/menu"
    android:name="br.trebew.odonto.MenuData"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<fragment
    android:id="@+id/princ"
    android:name="br.trebew.odonto.FragList"    
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

</LinearLayout> 
```

和另一个：

```
layout-large-land\main.xml

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
    android:orientation="vertical" 
    android:layout_width="290dp" 
    android:layout_height="fill_parent">

<fragment
    android:id="@+id/menu"
    android:name="br.trebew.odonto.MenuData"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

<fragment
    android:id="@+id/princ"
    android:name="br.trebew.odonto.FragList"    
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

</LinearLayout>

<fragment 
    android:id="@+id/fdetalhe"
    android:name="br.trebew.odonto.DetalheFragment"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" />

</LinearLayout> 
```

我的主要java类是OdontO.java，它是：

```
public class OdontO extends FragmentActivity implements OnDateChangeListener, OnAgendaItemClickListener {

FragList fList;
MenuData mData;
DetalheFragment frag_detalhe;

private boolean detalhesInLine;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);   

    Log.i("LayoutOr", "Entrou no onCreate OdontO");

    mData = (MenuData) getSupportFragmentManager().findFragmentById(R.id.menu);
    fList = (FragList) getSupportFragmentManager().findFragmentById(R.id.princ);  

    frag_detalhe = (DetalheFragment) getSupportFragmentManager().findFragmentById(R.id.fdetalhe);
    detalhesInLine = (frag_detalhe != null && 
            (getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE));
    if (detalhesInLine) {
        fList.enablePersistentSelection();
    }
    else if (frag_detalhe != null) {
        frag_detalhe.getView().setVisibility(View.GONE);
    }
} 
```

如果屏幕是纵向而不是旋转它会正确改变。

问题是相反的。如果屏幕是陆地，那么旋转对布局没有任何变化。事实上，它正确调用了 onCreate 方法，但布局并没有更改为纵向！=/

任何人都会知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:52:28.343

问题可能是您的肖像位于普通尺寸屏幕的文件夹中，而您的横向位于大尺寸屏幕的文件夹中。也许您可以将 layout-large-land 更改为 layout-land （如果您的设备具有普通屏幕）或将 layout 更改为 layout-large （如果您的设备具有大屏幕）并查看它是否有任何作用。（注意：即使它有一个大屏幕，将它放在 layout 和 layout-land 中仍然可以工作）。

# vi - 有没有办法在 vi 中使用零基编号？

> ID：10213373
> 
> 赞同：1
> 
> 时间：2012-04-18T16:04:24.323
> 
> 标签：vi

有没有办法在 vi 或 vim 中对行号和列/字符号使用基本零编号？

# c - C - 图形，无法旋转多边形

> ID：10213374
> 
> 赞同：0
> 
> 时间：2012-04-18T16:04:24.907
> 
> 标签：c, graphics, turbo-c

在下面的程序中，我试图将三角形逆时针旋转 45 度。多边形确实旋转到某个角度并平移到其他地方。请让我知道如何解决此问题。

```
#include<stdio.h>
#include<conio.h>
#include<graphics.h>
#include<math.h>

int main(void)
{
 int poly[8], rpoly[8],angle;
 int gd = DETECT, gm;
 initgraph(&gd,&gm,"C:\\TC\\BGI");

 printf("\n Enter co-ordinates for Triangle :  \n\n");

 printf("Vertex 1 (x,y)  : ");
 scanf("%d %d", &poly[0], &poly[1]);
 printf("Vertex 2 (x,y)  : ");
 scanf("%d %d", &poly[2], &poly[3]);
 printf("Vertex 3 (x,y)  : ");
 scanf("%d %d", &poly[4], &poly[5]);
 poly[6] = poly[0];
 poly[7] = poly[1];

 setcolor(2);
 drawpoly(4,poly);

 angle = 45;
 rpoly[0] = poly[0]*cos(angle) - poly[1]*sin(angle);
 rpoly[1] = poly[0]*sin(angle) + poly[1]*cos(angle);

 rpoly[2] = poly[2]*cos(angle) - poly[3]*sin(angle);
 rpoly[3] = poly[2]*sin(angle) + poly[3]*cos(angle);

 rpoly[4] = poly[4]*cos(angle) - poly[5]*sin(angle);
 rpoly[5] = poly[4]*sin(angle) + poly[5]*cos(angle);

 rpoly[6] = rpoly[0];
 rpoly[7] = rpoly[1];

 setcolor(4);
 drawpoly(4,rpoly);

 getch();
 closegraph();
 return 0;
} 
```

输出： ![在此处输入图像描述](../Images/b95d83905a201d5801632123c874ee40.png)

编辑1：

在输出中，红色三角形（即旋转后的三角形）看起来比原来的大。

新代码

```
#include<stdio.h>
#include<conio.h>
#include<graphics.h>
#include<math.h>

int main(void)
{
 int poly[8], rpoly[8], angle, centroid_x, centroid_y,i;
 int gd = DETECT, gm;
 initgraph(&gd,&gm,"C:\\TC\\BGI");

 printf("\n Enter co-ordinates for Triangle :  \n\n");

 printf("Vertex 1 (x,y)  : ");
 scanf("%d %d", &poly[0], &poly[1]);
 printf("Vertex 2 (x,y)  : ");
 scanf("%d %d", &poly[2], &poly[3]);
 printf("Vertex 3 (x,y)  : ");
 scanf("%d %d", &poly[4], &poly[5]);
 poly[6] = poly[0];
 poly[7] = poly[1];

 setcolor(2);
 drawpoly(4,poly);

 angle = 45 * 2 * 3.14 / 360;
 centroid_x =  (poly[0] + poly[2] + poly[4]) / 3;
 centroid_y =  (poly[1] + poly[3] + poly[5]) / 3;

 rpoly[0] = (poly[0] - centroid_x) * cos(angle)  -  (poly[1] - centroid_y) * sin(angle)  +  centroid_x;
 rpoly[1] = (poly[0] - centroid_x) * sin(angle)  -  (poly[1] - centroid_y) * cos(angle)  +  centroid_y;

 rpoly[2] = (poly[2] - centroid_x) * cos(angle)  -  (poly[3] - centroid_y) * sin(angle)  +  centroid_x;
 rpoly[3] = (poly[2] - centroid_x) * sin(angle)  -  (poly[3] - centroid_y) * cos(angle)  +  centroid_y;

 rpoly[4] = (poly[4] - centroid_x) * cos(angle)  -  (poly[5] - centroid_y) * sin(angle)  +  centroid_x;
 rpoly[5] = (poly[4] - centroid_x) * sin(angle)  -  (poly[5] - centroid_y) * cos(angle)  +  centroid_y;

 rpoly[6] = rpoly[0];
 rpoly[7] = rpoly[1];

 setcolor(4);
 drawpoly(4,rpoly);

 for(i=0;i<7;i++)
 {printf("\n %d", &rpoly[i]);}

 getch();
 closegraph();
 return 0;
} 
```

输出： ![在此处输入图像描述](../Images/f3b3fe0ac9a655aaf91342ed5a114094.png)

编辑2：

更正 Y 项后的代码：

```
#include<stdio.h>
#include<conio.h>
#include<graphics.h>
#include<math.h>

int main(void)
{
 int poly[8], rpoly[8], angle, centroid_x, centroid_y,i;
 int gd = DETECT, gm;
 initgraph(&gd,&gm,"C:\\TC\\BGI");

 printf("\n Enter co-ordinates for Triangle :  \n\n");

 printf("Vertex 1 (x,y)  : ");
 scanf("%d %d", &poly[0], &poly[1]);
 printf("Vertex 2 (x,y)  : ");
 scanf("%d %d", &poly[2], &poly[3]);
 printf("Vertex 3 (x,y)  : ");
 scanf("%d %d", &poly[4], &poly[5]);
 poly[6] = poly[0];
 poly[7] = poly[1];

 setcolor(2);
 drawpoly(4,poly);

 angle = 45 * 2 * 3.14 / 360;
 centroid_x =  (poly[0] + poly[2] + poly[4]) / 3;
 centroid_y =  (poly[1] + poly[3] + poly[5]) / 3;

 rpoly[0] = (poly[0] - centroid_x) * cos(angle)  -  (poly[1] - centroid_y) * sin(angle)  +  centroid_x;
 rpoly[1] = (poly[0] - centroid_x) * sin(angle)  +  (poly[1] - centroid_y) * cos(angle)  +  centroid_y;

 rpoly[2] = (poly[2] - centroid_x) * cos(angle)  -  (poly[3] - centroid_y) * sin(angle)  +  centroid_x;
 rpoly[3] = (poly[2] - centroid_x) * sin(angle)  +  (poly[3] - centroid_y) * cos(angle)  +  centroid_y;

 rpoly[4] = (poly[4] - centroid_x) * cos(angle)  -  (poly[5] - centroid_y) * sin(angle)  +  centroid_x;
 rpoly[5] = (poly[4] - centroid_x) * sin(angle)  +  (poly[5] - centroid_y) * cos(angle)  +  centroid_y;

 rpoly[6] = rpoly[0];
 rpoly[7] = rpoly[1];

 setcolor(4);
 drawpoly(4,rpoly);

// for(i=0;i<8;i++)
// {printf("\n %d", &rpoly[i]);}

 getch();
 closegraph();
 return 0;
} 
```

输出：

![在此处输入图像描述](../Images/45aea80ee7f7bc6ee77dd86a06b652dc.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:07:00.110

两个问题：`sin`并`cos`以*弧度*而不是度数为参数；你可能想围绕它的中心旋转你的多边形，而不是大约 (0, 0)。

要解决第一个问题，请更改：

```
angle = 45; 
```

至：

```
angle = 45.0 * 2.0 * M_PI / 360.0; 
```

要解决第二个问题，您需要首先计算多边形的质心，然后平移顶点相对于质心的坐标。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-03T10:48:16.937

```
 rpoly[0] = (poly[0] - centroid_x) * cos(angle)  -  (poly[1] - centroid_y) * sin(angle)  +  centroid_x;
 rpoly[1] = (poly[0] - centroid_x) * sin(angle)  +  (poly[1] - centroid_y) * cos(angle)  +  centroid_y; 
```

rpoly[1] 是在 rpoly[0] 更改后计算的。

尝试这个;

```
float newX = .......;
rpoly[0] = newX;
float newY = .......;
rpoly[1] = newY; 
```

# c# - Loquacious Nhibernate 无法访问用于映射的非公共属性

> ID：10213375
> 
> 赞同：0
> 
> 时间：2012-04-18T16:04:26.487
> 
> 标签：c#, nhibernate, fluent-nhibernate

我正在从流利的语言转换为健谈的语言，并且遇到了非公共财产的问题。当我尝试映射它时，nhibernate 会抛出一个异常，即 memberInfo 的值为空。我得到了最新的源代码并逐步查看发生了什么，它看起来像这样的调用：

```
memberOfReflectType = typeof (TEntity).GetProperty(memberOfDeclaringType.Name, memberOfDeclaringType.GetPropertyOrFieldType()); 
```

是导致问题的原因。memberOfReflectType 设置为 null ，然后在 PropertyPath 构造函数中它在尝试访问它时中断。

我的映射如下所示：

```
public class Foo
{
  public virtual int SomePublicInt {get; set;}
  protected internal virtual int _someProtectedInt {get; set;}
}

public class FooMap : ClassMapping<Foo>
{
  public FooMap ()
  {
    Table("Foo");
    ComposedId(compIDMapper =>
    {
      compIDMapper.Property(x => x.SomePublicInt, m => m.Column("SomePublicInt"));
      compIDMapper.Property(x => _someProtectedInt, m => m.Column("SomeProtectedInt"));
    });
  }
} 
```

如果我将受保护的内部 int 更改为公共 int，它可以正常工作，但似乎您应该能够映射受保护的内部。我们可以用 nhibernate 做到这一点，没有任何问题。

我必须输入一些额外的映射命令来解决这个问题吗？我用谷歌搜索了一段时间，但没有想到任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T18:55:01.270

对于非公共字段，请尝试使用字符串而不是 lambda 表达式进行重载：

```
compIDMapper.Property("_someProtectedInt", m => m.Column("SomeProtectedInt")); 
```

# wpf - 如何将样式应用于所有 ItemsControl 元素中存在的所有 TextBlock 和 TextBox 元素？

> ID：10213379
> 
> 赞同：0
> 
> 时间：2012-04-18T16:04:35.547
> 
> 标签：wpf, xaml

我需要为所有元素定义一个全局样式`TextBlock`并且`TextBox`存在于`ItemsControl`元素中。

我需要所有`TextBlock`元素的宽度为 100 并左对齐，`TextBox`元素的宽度为 50 并右对齐。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:08:45.443

我不明白你的“存在于 ItemsControl 元素中”，但如果你在谈论你的 ItemsTemplate 它应该像这样工作

```
<Style x:Key="myTextBoxStyle">
    <Setter Property="Width" Value="50"/>
    <Setter Property="HorizontalAlignment" Value="Right"/>
</Style>

<Style x:Key="myTextBlockStyle">
    <Setter Property="Width" Value="100"/>
    <Setter Property="HorizontalAlignment" Value="Left"/>
</Style>

<ItemsControl>
    <ItemsControl.ItemsTemplate>
        <DataTemplate>
            <Grid>
                <TextBlock Style="{StaticResource myTextBlockStyle}"/>
                <TextBox Style="{StaticResource myTextBoxStyle}"/>
            <Grid>
        <DataTemplate>
    </ItemsControl.ItemsTemplate>
</ItemsControl> 
```

这将显示 ItemsControl 中的所有项目，其中包含使用 myTextBoxStyle 的文本框和使用 myTextBlockStyle 的文本块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T17:38:50.550

您也可以在 ItemsControl.Resources 中声明样式

```
 <ItemsControl ItemsSource="{Binding Persons}">
        <ItemsControl.Resources>
            <Style x:Key="TxtBlk1" TargetType="{x:Type TextBlock}">
                <Setter Property="Foreground"  Value="red"/>
                <Setter Property="FontSize" Value="56"/>
                <Setter Property="HorizontalAlignment" Value="Right"/>
            </Style>

        </ItemsControl.Resources>
        <ItemsControl.ItemTemplate>

            <DataTemplate>
                <TextBlock Text="{Binding Name}" Style="{StaticResource TxtBlk1}"></TextBlock>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl> 
```

# blackberry - BlackBerry - “初始化时卸载媒体”错误

> ID：10213380
> 
> 赞同：1
> 
> 时间：2012-04-18T16:04:40.840
> 
> 标签：blackberry, media-player, blackberry-simulator

我正在尝试播放基于`videorecordingdemo`JDE7.0 示例的视频（代码如下）。

我正在为 OS5.0 构建 - 这就是为什么我不能只运行为 OS7.0 编写的整个演示应用程序。

我正在使用模拟器（9300）并设置了一个文件夹用作我的 sd 卡。我在其中放置了一个 .AVI 视频。我还尝试将 .AVI 放入资源中，然后从那里进行流式传输。

在这两种情况下，当我调用时`Player.start()`，都会引发以下异常：

*   `net.rim.device.internal.media.RimMediaException`: 初始化时卸载媒体

我想知道：

1.  **这个错误是什么意思？**
2.  **我该如何解决？**

或者，播放 .AVI 文件是否有任何真正特殊、严格的要求？

* * *

**更新：**在真正的 Torch 设备上试用了该应用程序，它给了

*   `net.rim.device.internal.media.UnloadedMediaException`

* * *

FWIW 这里是示例代码 - 直接从`videorecordingdemo`示例应用程序复制。

* * *

```
package mypackage;
/*
 * VideoPlaybackScreen.java
 *
 * Copyright © 1998-2011 Research In Motion Ltd.
 * 
 * Note: For the sake of simplicity, this sample application may not leverage
 * resource bundles and resource strings.  However, it is STRONGLY recommended
 * that application developers make use of the localization features available
 * within the BlackBerry development platform to ensure a seamless application
 * experience across a variety of languages and geographies.  For more information
 * on localizing your application, please refer to the BlackBerry Java Development
 * Environment Development Guide associated with this release.
 */

import javax.microedition.media.Player;
import javax.microedition.media.PlayerListener;
import javax.microedition.media.control.VideoControl;
import javax.microedition.media.control.VolumeControl;

import java.io.IOException;
import java.io.InputStream;
import javax.microedition.io.Connector;
import javax.microedition.io.file.FileConnection;

import net.rim.device.api.ui.Field;
import net.rim.device.api.ui.UiApplication;
import net.rim.device.api.ui.component.Dialog;
import net.rim.device.api.ui.component.LabelField;
import net.rim.device.api.ui.container.MainScreen;

/**
 * A screen for playing a video
 */
public class VideoPlaybackScreen extends MainScreen
{
    private Player _videoPlayer;
    private VideoControl _videoControl;

    /**
     * Constructs a screen to playback the video from a specified input stream
     * 
     * @param inputStream The InputStream of the video to display
     * 
     * @throws NullPointerException Thrown if <code>inputStream</code> is null
     */
    public VideoPlaybackScreen(InputStream inputStream)
    {
        if (inputStream == null)
        {
            throw new NullPointerException("'inputStream' cannot be null");
        }

        try
        {  
            _videoPlayer = javax.microedition.media.Manager.createPlayer(inputStream, "video/sbv");
            initScreen();
        }
        catch( Exception e )
        {
            Dialog.alert("Exception while initializing the playback video player\n\n" + e);
        }
    }

    /**
     * Constructs the screen to playback the video from a file
     * 
     * @param file A locator string in URI syntax that points to the video file
     */
    public VideoPlaybackScreen(String file)
    {        
        boolean notEmpty;
        try
        {
            FileConnection fconn = (FileConnection) Connector.open(file);
            notEmpty = fconn.exists() && fconn.fileSize() > 0;
            fconn.close();
        }
        catch( IOException e )
        {
            Dialog.alert("Exception while accessing the video filesize:\n\n" + e);     
            notEmpty = false;           
        }

        // Initialize the player if the video is not empty
        if( notEmpty )
        {
            try
            {
                _videoPlayer = javax.microedition.media.Manager.createPlayer(file);
                initScreen();
            }
            catch( Exception e )
            {
                Dialog.alert("Exception while initializing the playback video player\n\n" + e);  
            }
        }
        else
        {
            add(new LabelField("The video file you are trying to play is empty"));
        }
    }

    /**
     * Initializes the screen after the player has been created
     * 
     * @throws Exception Thrown if an error occurs when initializing the video player, video display or volume control
     */
    private void initScreen() throws Exception
    {
        _videoPlayer.realize();
        _videoPlayer.addPlayerListener(new PlayerListener()
        {
            /**
             * @see javax.microedition.media.PlayerListener#playerUpdate(Player, String, Object)
             */
            public void playerUpdate(Player player, String event, Object eventData)
            {
                // Alert the user and close the screen after the video has
                // finished playing.
                if( event == PlayerListener.END_OF_MEDIA )
                {
                    UiApplication.getUiApplication().invokeLater(new Runnable()
                    {
                        public void run()
                        {
                            Dialog.alert("Finished playing");
                            close();
                        }
                    });
                }
            }
        });

        // Set up the playback
        _videoControl = (VideoControl) _videoPlayer.getControl("VideoControl");
        Field vField = (Field) _videoControl.initDisplayMode(VideoControl.USE_GUI_PRIMITIVE,
                "net.rim.device.api.ui.Field");
        add(vField);

        VolumeControl vol = (VolumeControl) _videoPlayer.getControl("VolumeControl");
        vol.setLevel(30);
    }

    /**
     * @see net.rim.device.api.ui.Field#onVisibilityChange(boolean)
     */
    protected void onVisibilityChange(boolean visible)
    {
        // If the screen becomes visible and the video player was created, then
        // start the playback.
        if( visible && _videoPlayer != null )
        {
            try
            {
                _videoPlayer.start();
            }
            catch( final Exception e )
            {
                UiApplication.getUiApplication().invokeLater(new Runnable()
                {
                    public void run()
                    {
                        // If starting the video fails, terminate the playback
                        Dialog.alert("Exception while starting the video\n\n" + e);       
                        close();
                    }
                });
            }
        }
    }

    /**
     * @see net.rim.device.api.ui.Screen#onClose()
     */
    public void close()
    {
        // Close the video player if it was created
        if( _videoPlayer != null )
        {
            _videoPlayer.close();
        }
        super.close();
    }
} 
```

# php - 使用 sftp 上传文件时如何修复 PHP curl 错误 CURLE_SSH (79)

> ID：10213383
> 
> 赞同：1
> 
> 时间：2012-04-18T16:04:49.703
> 
> 标签：php, curl, ssh, sftp, libssh2

我正在尝试在我的 PHP 应用程序上重现以下命令以通过 sftp 上传文件：

```
curl -T /var/repo/file -u user:password sftp://server.com/folder/ 
```

上面的命令工作得很好（不过，我必须在我的 ubuntu 机器上重新编译 libcurl 才能使其工作）。然而，当我尝试使用 PHP 的 curl 库时，事情对我来说并不顺利。

我正在使用的代码如下：

```
$ch = curl_init();
$localfile = 'file';
$fp = fopen($localfile, 'r');

curl_setopt($ch, CURLOPT_URL, 'sftp://server.com/folder/');
curl_setopt($ch, CURLOPT_UPLOAD, 1);
curl_setopt($ch, CURLOPT_USERPWD, 'user:password');
curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_SFTP);
curl_setopt($ch, CURLOPT_INFILE, $fp);
curl_setopt($ch, CURLOPT_INFILESIZE, filesize($localfile));
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_exec ($ch);
$error_no = curl_errno($ch);
curl_close ($ch);

if ($error_no == 0) {
    $error = 'File uploaded succesfully.';
} else {
    $error = 'File upload error.';
}
echo $error.' '.$error_no; 
```

这会返回错误 79：CURLE_SSH (79)，我不知道如何修复。你遇到过这个问题吗？你怎么修好它的？有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T06:35:10.270

这意味着 libcurl 从“SSH 层”（libssh2）得到某种错误。如果启用 VERBOSE，您可能会看到更多详细信息。

您使用的是相当旧的 libcurl 和 libssh2 版本，因此只需将它们升级到现代版本即可解决此问题并非不可想象。

# php - 将表格单元格的内容传输到 jQuery 加载的文档中

> ID：10213385
> 
> 赞同：0
> 
> 时间：2012-04-18T16:04:57.097
> 
> 标签：php, jquery

我目前有一个当前格式的表格：

```
ID  Client Info  Case Detail  Accident Date  Case Opened  No Days  Function
--  -----------  -----------  -------------  -----------  -------  -------- 
```

其中包含从数据库中提取的动态信息。

ID 列特别重要，因为当用户单击功能列下的**“管理”**按钮时，我需要从该单元格中提取数据。

现在，这是用户单击**“管理”**按钮时运行的代码。

```
<script>
  $(document).ready(function () {
    $(".manage").click(function () {
    $('#casesHeading').hide("slow");
    $('#casesTable').hide("slow");
    $('#results').load('components/manage.php');
    });
    });
</script> 
```

标题和表格被隐藏，页面“manage.php”被加载到结果 div 中。

*但我只是想知道是否有办法将 ID 单元格的内容（每行不同）明显地转移到 manage.php 文件（当前为空）中。*

因此，如果用户单击 ID 单元格数据**为 233-cv**的行，则此信息将被传输到 manage.php 文件中。希望我说得通。我阅读了 jQuery .find 函数，这很有意义，但我不知道如何将它合并到这个实例中。

**更新 1**

我正在尝试完成类似于此[http://jsfiddle.net/ZjvAz/](http://jsfiddle.net/ZjvAz/)的事情。

**更新 2**

我已经尝试了以下代码，但它似乎没有工作。

```
<script>
  $(document).ready(function () {
$(".manage").click(function() {
    var clickedButton = $(this);
        clickedButton.parent().find(".result").text(
            clickedButton.parent().parent().parent().find('.caseID').text()
        );
    });
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:41:30.807

我会让我的 manage.php 文件将案例 ID 作为参数。它将以诸如 的方式调用`manage.php?caseId=123`。

如果您可以控制生成的数据，则可以生成所需的信息以进入按钮。不需要 jquery 代码遍历 DOM 到 ID 字段。我会在表源中生成类似的东西

```
<tr>
  <td class="id">123</td>
  ...
  <td class="function">
    <button class="manage" onclick="loadManagementPage(123)">manage</button>
  </td>
</tr> 
```

如果您无法控制 HTML 源代码并且确实需要导航，那么您最好的朋友可能正在使用[`closest()`](http://api.jquery.com/closest/)它来向上导航 dom。使用它来查找行元素`tr`

出于自我记录的目的，我在这里没有使用链接

```
$( '.manage' ).click(function(){

  // find the row we are in
  var $self = $( this );
  var $row = $self.closest( 'tr' );

  // read the id
  var $idCell = $row.find( 'td.id' );
  var caseId = $idCell.text();

  // locate an area on the page and dynamically load in some content
  var $target = $row.find( 'td.result' ); // find the result cell
  var $target = $( '#knownId' )           // *OR* find a div with a known id
  $target.load( 'manage.php?caseId=' + caseId );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:11:00.263

> jQuery.load( handler(eventObject) ) 返回：jQuery
> 
> 描述：将事件处理程序绑定到“加载”JavaScript 事件。

因为`'components/manage.php'`不是事件处理程序——你想做什么？

如果您想从服务器请求数据（也向其发送 smoe ID），您应该阅读有关该`jQuery.ajax( url [, settings] )`功能的信息。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

[http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)

# perl - 从 PL/Perl 代码访问数据库

> ID：10213394
> 
> 赞同：2
> 
> 时间：2012-04-18T16:05:32.043
> 
> 标签：perl, postgresql, plperl

有人可以协助纠正这段代码中的错误。

（这只是我的代码的简化版本，但它确定了问题）。

```
DROP FUNCTION perl_func(VARIADIC params character varying[]);

CREATE OR REPLACE FUNCTION perl_func(VARIADIC params character varying[])
  RETURNS character varying AS
$BODY$   
   $val = spi_query("array_to_string($1,'###');");
   $s = `echo $val`;
   return $s; 
$BODY$
  LANGUAGE plperlu VOLATILE
  COST 100;

SELECT * from perl_func('a','d'); 
```

这会返回一个语法错误：

```
ERROR:  syntax error at or near "," at line 2.
CONTEXT:  PL/Perl function “perl_func” 
```

**主要目的：**是将输入参数制定为字符串，并用它来调用一些命令行程序，该程序返回一个字符串。然后输出这个字符串作为这个函数的返回值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:11:09.133

**原始尝试：**

该变量`$1`在 Perl 中的含义与在 plpgsql 函数中的含义不同。尝试

```
CREATE OR REPLACE FUNCTION perl_func(VARIADIC params character varying[])
  RETURNS character varying AS
$BODY$
   use strict;
   use warnings;
   my $val = join("###",@_);
   my $s = `echo $val`;
   chomp($s);
   return $s; 
$BODY$
  LANGUAGE plperlu VOLATILE
  COST 100; 
```

不幸的是，这不起作用（如下所述），因为它没有正确拆分字符串。不幸的是，plperl 认为参数是单个字符串：

```
CREATE OR REPLACE FUNCTION perl_str(VARIADIC text[])
  RETURNS text AS
$BODY$
   use strict;
   use warnings;
   my $array_str=shift;
   return $array_str;
$BODY$
  LANGUAGE plperl VOLATILE; 
```

当我们选择它时：

```
> select perl_str(ARRAY['abc','def']);
 perl_str
-----------
 {abc,def}
(1 row) 
```

为了确定它是一个字符串，我们可以求助于我们的老朋友[`Data::Dumper`](http://perldoc.perl.org/Data/Dumper.html)：

```
CREATE OR REPLACE FUNCTION perl_dump(VARIADIC text[])
  RETURNS text AS
$BODY$
   use strict;
   use warnings;
   use Data::Dumper;
   my $array_str=shift;
   return Dumper($array_str);
$BODY$
  LANGUAGE plperl VOLATILE; 
```

这会返回：

```
> select perl_dump(ARRAY['abc','def']);
      perl_dump
----------------------
 $VAR1 = '{abc,def}';

(1 row) 
```

因此，输出被认为是一个实际的字符串，末尾带有花括号，条目用逗号分隔。好吧，好吧……这很烦人，但至少我们可以处理它：

```
CREATE OR REPLACE FUNCTION final_perl_func(VARIADIC text[])
  RETURNS text AS
$BODY$
   use strict;
   use warnings;
   my $array_string=shift;
   $array_string=substr($array_string,1,length($array_string)-2);
   my @array=split(/,/,$array_string);
   my $val=join("###",@array);
   my $s=`echo $val`;
   chomp($s);
   return $s;
$BODY$
  LANGUAGE plperl VOLATILE; 
```

这得到了我们想要的：

```
> select final_perl_func(ARRAY['abc','def']);
 final_perl_func
-----------------
 abc###def
(1 row) 
```

请注意，由于我不明白的原因，我不得不求助于使用`substr`而不是简单的正则表达式替换（`$array_string=~s/{}//g;`），因为当我尝试正则表达式替换时，plperl 函数不断返回大括号。

在回答您有关它的问题之前，我没有处理过很多 plperl 问题，而我学到的主要内容是它是一个主要的痛苦……您可能需要考虑使用[Perl`DBI`](http://dbi.perl.org/docs/)从 Perl 操作数据库。

# scala - 具有覆盖抽象类型的蛋糕模式不适用于 Upper Type Bounds

> ID：10213395
> 
> 赞同：8
> 
> 时间：2012-04-18T16:05:34.337
> 
> 标签：scala, dependency-injection, traits, cake-pattern

我想用`<:`而不用覆盖特征中的抽象类型`=`（就像这里的回答[Scala Upper Bounds : value is not a member of type parameter](https://stackoverflow.com/questions/9217918/scala-upper-bounds-value-is-not-a-member-of-type-parameter)）。

我想使用蛋糕图案，但这不起作用，我不明白为什么？

```
trait A {
  def ping = println("ping")
}

trait Cake {
  type T
}

trait S { this: Cake =>
  type T = A
  def t: T
  t.ping
} 
```

好的，这个例子运行了，但是在我的实际用例中，我想用`<:`而不是用覆盖类型。`=`似乎无法访问 t 函数，为什么？

```
trait S { this: Cake =>
  type T <: A
  def t: T
  t.ping
} 
```

返回错误`value ping is not a member of S.this.T`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-19T07:21:03.230

这是 Scala 类型系统的一个缺点。在确定 mixin 中的成员时，Scala 使用两条规则：首先，具体总是覆盖抽象。其次，如果两个成员都是具体的，或者都是抽象的，那么在线性化顺序中后面的那个会获胜。

此外，特质的自我类型

```
trait S { this: C => ... } 
```

被隐式扩充为

```
trait S { this: S with C => ... } 
```

以便可以在 S 中访问特征 S 中的定义。在您的情况下，特征 S 被视为：

```
trait S { this: S with Cake =>
  type T = A
  def t: T
  t.ping
} 
```

现在，只要 T 是具体的就可以了，因为它覆盖了 Cake 中的抽象 T。但是如果 T 是抽象的，那么 Cake 中的那个在线性化顺序中排在后面并获胜。并且那个 T 没有上限，所以没有成员 ping。解决此问题的一种方法是通过编写以下内容来更改线性化顺序：

```
trait S { this: Cake with S =>
  type T <: A
  def t: T
  t.ping
} 
```

如果 Scala 有一条不同的规则，即所有抽象类型成员的约束都合并到 mixin 中，而不是根据线性化顺序选择单个成员，那会更简洁。这是我们将来要考虑的更改，但我们需要注意向后兼容性。

# java - 带有静态成员的java初始化顺序

> ID：10213396
> 
> 赞同：0
> 
> 时间：2012-04-18T16:05:34.563
> 
> 标签：java, virtual-machine

我不确定我是否有一个正确的 Java 初始化机制模型。每个类遵循以下内容：

1.  初始化超类，如果存在的话
2.  初始化自己

初始化如下：

1.  初始化在初始化程序之外设置其值的静态和实例变量。
2.  运行静态初始化块
3.  运行构造函数块

那是准确/正确的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:39:00.390

代码执行如下 -

静态初始化块在第一次加载类时运行一次。

静态变量

所有超级构造函数。

实例 init 块在构造函数调用 super() 之后运行。

实例变量。

（初始化块按照它们出现的顺序执行。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:14:13.353

根据[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.4.2)，您的假设或多或少是正确的。例外情况是：

1.  实例变量在类初始化后（与构造函数一起）构造时运行，
2.  具有编译时常量表达式的最终静态变量甚至在尝试加载超类之前就已加载，并且
3.  静态初始化块与静态变量一起作为一个块运行，按照它们在代码中出现的顺序。

# mod-rewrite - 更改 mod-rewrite 规则以将特定文件请求路由到 index.php

> ID：10213401
> 
> 赞同：1
> 
> 时间：2012-04-18T16:05:52.933
> 
> 标签：mod-rewrite

我的 PHP 框架在 .htaccess 文件中有一个默认规则，它将除特定文件之外的所有请求路由到 index.php。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule !\.(pdf|js|ico|gif|jpg|png|css|rar|zip|tar\.gz)$ index.php [L] 
```

例如，如果我在 /images 文件夹中有特定于站点的图像，则请求**foo.com/images/name.jpg**将直接处理到文件系统。

但是对于具有特定路径 fe /image 的 URL，我需要一种特殊的行为。**所以像foo.com/image/name.jpg**这样的请求也应该被路由到 index.php...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T06:04:41.627

`RewriteRule .*\.(pdf|js|ico|gif|jpg|png|css|rar|zip|tar|gz)$ /index.php [L]`

# c# - 如何在自定义控件中获取数据绑定文本块以进行更新？

> ID：10213402
> 
> 赞同：1
> 
> 时间：2012-04-18T16:05:59.170
> 
> 标签：c#, windows-phone-7, mvvm

## 设置

所以我有一个类，`ComputerItem`，旨在存储我需要了解的有关特定计算机的所有信息；这些项目存储在一个`ObservableCollection<ComputerItem>`. 然后我有一个自定义控件`ComputerControl`，它（除其他外）有几个文本框绑定到 ComputerItem 的成员，绑定如下：

```
<TextBlock Name="tb_computerName"TextWrapping="Wrap" Text="{Binding ElementName=ComputerControl1, Path=computerName}"/> 
```

在后面的代码中

```
public static DependencyProperty computerNameProperty = DependencyProperty.Register("computerName", typeof(string), typeof(ComputerControl), null); 
```

然后我创建一个`MultiselectList`ComputerControl 对象：

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
    <toolkit:MultiselectList x:Name="lb_computers" IsSelectionEnabledChanged="lb_computers_IsSelectionEnabledChanged"> <!--SelectionChanged="lb_computers_SelectionChanged" >-->
        <toolkit:MultiselectList.ItemTemplate>
            <DataTemplate>
               <StackPanel x:Name="sp">
                    <local:ComputerControl computerName="{Binding Name}" MACAddress="{Binding DisplayMAC}" playClicked="playClicked_Handler" editClicked="editClicked_Handler"/>
                </StackPanel>
            </DataTemplate>
        </toolkit:MultiselectList.ItemTemplate>
    </toolkit:MultiselectList>
</Grid> 
```

您可以在 ComputerControl 定义中看到数据绑定。在后面的代码中，我将 ObservableCollection 绑定到 MultiselectList：

```
this.lb_computers.ItemsSource = ComputerListMaintainer.GetList(); 
```

并且所有这些（以及我确定我忘记包括在这里的一些东西）都可以很好地使用代表 ObservableCollection 中的 ComputerItems 的 ComputerControls 填充 MultiselectList。

## 问题

我的问题是，当底层 ComputerItem 更改时，相应 ComputerControl 中的 TextBlocks 不会更新。我`INotifyPropertyChanged`在 ComputerItem 类中实现了：

```
public class ComputerItem : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;
    private string name;

    protected virtual void OnPropertyChanged(string name)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(name));
    }
    public string Name
    {
        get { return name; }
        set { OnPropertyChanged("Name"); name = value; }
    }
} 
```

但这并没有解决问题。我怀疑这与 ComputerControl 有关，但我不知道从哪里开始寻找；我发现的最接近的问题建议 INotifyPropertyChanged 应该是解决方案，但如果我没记错的话，在这种情况下他们没有使用自定义控件，只是一个自定义类。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:12:10.933

好吧，您的二传手不适合初学者；还请查看 MvvmLight，因为它为此类管道工作提供了出色的 API。

```
public string Name
{
    get { return name; }
    set 
    { 
        if(value != name)
        {
            name = value;
            OnPropertyChanged("Name"); 
        }
    }
} 
```

**更新：**

您不应该在后面的代码中设置 lb_computers.ItemsSource，因为这是一次性操作而不是绑定。最好绑定到可观察对象的 ObservableCollection（又名 INotifyPropertyChanged）。

另外我不确定您是否正确声明了依赖属性，因此您可以在下面找到有关如何定义“可绑定”属性的正确设置。

此外，对于 XAML，代码的体系结构很重要，以获得理智的体验。我强烈建议您使用 Mvvm 模式。我发现 MvvmLight 和 MEFedMVVM 对我的开发很有帮助。这需要在开始时做一些工作，但调试未来的问题和维护代码会容易得多。

如果这些提示没有帮助，那么我必须查看您的完整代码。

## 声明可绑定属性

```
#region ReportName

    public string ReportName
    {
        get { return (string)GetValue(ReportNameProperty); }
        set { SetValue(ReportNameProperty, value); }
    }

    public static readonly DependencyProperty ReportNameProperty = DependencyProperty.Register("ReportName",
        typeof(string), typeof(ExportableGridView), new PropertyMetadata("Report", new PropertyChangedCallback(OnReportNameChanged)));

    public static void OnReportNameChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
    {
        ExportableGridView control = sender as ExportableGridView;
        control.titleTextBlock.Text = e.NewValue as string;
    }

#endregion ReportName 
```

# .net - 代码库大而混乱的 DI

> ID：10213403
> 
> 赞同：1
> 
> 时间：2012-04-18T16:05:59.280
> 
> 标签：.net, architecture, dependency-injection, castle-windsor, brownfield

我想将 DI 引入现有的大型代码库，该代码库具有许多继承和抽象层（以及各种方式的引用！）。在最低级别之一，我想使用 DI 将特定对象的生活方式控制为单例（当前实现使用 ThreadStatic 并且存在问题）。我是否需要从顶部一直向下注入并在容器中注册所有对象（这需要大量工作），还是有一种方法可以让我做这种快速而肮脏的风格（现在；）？我正在使用 C# 和 Castle Windsor。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:32:49.037

You could go for a service locator pattern that provides the container. It is considered a bit of a bad practice by many [Is it bad to use servicelocation instead of constructor injection to avoid writing loads of factory classes](https://stackoverflow.com/questions/1599811/is-it-bad-to-use-servicelocation-instead-of-constructor-injection-to-avoid-writi) but one could argue its better then nothing if the option for you is to have hard dependencies and buggy code. There are some situation that it is not considered that bad [http://codeofrob.com/entries/service-location-is-not-always-evil.html](http://codeofrob.com/entries/service-location-is-not-always-evil.html)

I would however read up a bit on the subject if I were you and see how it fits you needs and your application. DI/IoC debates tend to get a bit religious sometimes imho.

# href - document.getElementById 包含 href

> ID：10213405
> 
> 赞同：1
> 
> 时间：2012-04-18T16:06:11.643
> 
> 标签：href, getelementbyid

```
<script type="text/javascript">
document.getElementById("IDOFELEMENT");
</script> 
```

将其转换为链接的正确方法是什么？

我可以写吗

```
<script type="text/javascript">
document.getElementById("IDOFELEMENT").href("http://www.address.com");
</script> 
```

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T20:14:01.227

javascript:

```
// this changes the href value<br>
document.getElementById("IDOFELEMENT").href = "http://www.address.com"; 
```

和html：

```
<a href="www.toBeChanged.com" id="IDOFELEMENT">To Website< /a> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T16:29:54.520

您应该指定**IDOFELEMENT**是哪种元素。但是您不能仅通过添加 href 属性将其转换为链接，它仅在**IDOFELEMENT** 是类似的超链接时才有效`<a id="IDOFELEMENT">stuff</a>`

最简单的方法是向将url 更改为所需地址的元素添加**onclick事件：**

```
<script type="text/javascript">
   var element = document.getElementById("IDOFELEMENT");
   element.setAttribute('onclick', 'window.location.href=\'http://address.com\'');
</script> 
```

或者，如果您想用超链接包装它：

```
<script type="text/javascript">
   var element = document.getElementById("IDOFELEMENT");
   var parent = element.parentNode; 
   var link = document.createElement('a');
   link.href = 'http://www.address.com';
   link.appendChild(element.cloneNode(true)); 
   parent.replaceChild(link, element);
</script> 
```

我希望这可以帮助你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-03T09:36:50.707

我遇到了这个问题 - Javascript 错误：无法读取 null 的属性“parentNode”。我发现这是由于在 DOM 尚未准备好时执行此代码所致。window.onload 为我解决了这个问题。

```
<script>
window.onload = function() {

   var element = document.getElementById("IDOFELEMENT");
   var parent = element.parentNode; 
   var link = document.createElement('a');
   link.href = 'http://www.google.com';
   link.appendChild(element.cloneNode(true)); 
   parent.replaceChild(link, element);
};
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T16:56:30.460

您只需将元素包装在锚标记中，如下所示...

```
<a href="http://www.address.com">
    <div id="IDOFELEMENT">
    ... content ...
    </div>
</a> 
```

# java - Java 中的 EasyMock 和文件

> ID：10213407
> 
> 赞同：0
> 
> 时间：2012-04-18T16:06:17.893
> 
> 标签：java, unit-testing, testing, mocking, easymock

我正在编写应用程序，我需要模拟文件来测试它。我的代码如下：

```
@Test
public void testPostMail() throws Exception
{
    Emailer instance = new Emailer();
    instance.setRecipientsFromFile(new File("list.txt"));
} 
```

问题是，我不想依赖硬盘上的文件（当然我可以制作一个内容正确的文件并在测试后删除它，但我想用 EasyMock 来做）。

我尝试导入 org.easymock.classextension.EasyMock 并使用它，但是：

1）我仍然收到错误“文件不是接口”

2) classextension.EasyMock 已弃用，所以我应该只使用 EasyMock

我不工作的 EasyMock 代码：

```
@Test
public void testSetReceipientsFromFile() throws Exception
{
File file = EasyMock.createMock(File.class);
FileReader in = EasyMock.createMock(FileReader.class);
BufferedReader br = EasyMock.createMock(BufferedReader.class);

EasyMock.expect(new FileReader(file)).andReturn(in);
EasyMock.expect(new BufferedReader(in)).andReturn(br);

EasyMock.expect(br.readLine()).andReturn("test@mail.com");
EasyMock.expect(br.readLine()).andReturn("test2@mail2.com");

EasyMock.replay(file, in, br);

EasyMock.verify(file, in, br);

// ...
} 
```

编辑：我想从 EasyMock 更改为 Mockito，因为我听到了更有利的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:16:01.543

在 Mockito 中，您可以这样做：

```
 BufferedReader br = Mockito.mock(BufferedReader.class);

    Mockito.when(br.readLine())
            .thenReturn("test@mail.com")
            .thenReturn("test2@mail2.com");

    // Alternative
    // Mockito.when(br.readLine()).thenReturn("aaa", "bbb");

    Assert.assertEquals("test@mail.com", br.readLine());
    Assert.assertEquals("test2@mail.com", br.readLine()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:31:15.127

EasyMock 和 Mockito 都不支持对象的模拟构造。因此，您需要一个支持它的库，例如[PowerMock](http://code.google.com/p/powermock/wiki/MockConstructor)或 PowerMockito。

但是，我认为这里存在设计缺陷。`Emailer`读取文件是否有责任？我不这么认为。

我将从`Emailer`负责从文件中读取收件人列表的新类中提取用于读取文件的代码。这将使`Emailer`更多的可测试性。如果你想测试这个新类，创建一个真实文件（使用[`TemporaryFolder`rule](http://kentbeck.github.com/junit/javadoc/latest/org/junit/rules/TemporaryFolder.html)）将是一个自然的选择，因为读取文件是该类的主要职责。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T09:17:46.647

“听你的测试”。您应该创建一个包装器`File`并在`Emailer`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T18:54:12.960

您使用的是哪个版本的 EasyMock。在最新版本 3.1 中，是的，扩展 EasyMock 已弃用。您可以改用普通的简单模拟，这就是他们在 API 文档[http://www.easymock.org/api/easymockclassextension/3.1/index.html](http://www.easymock.org/api/easymockclassextension/3.1/index.html)中建议的内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-02T09:04:22.530

从 EasyMock 3.0（当前版本为 3.2）开始，您可以模拟具体类，因此您现在不会收到此错误。

# facebook - 是否可以从 Facebook 页面发布操作？

> ID：10213409
> 
> 赞同：0
> 
> 时间：2012-04-18T16:06:24.713
> 
> 标签：facebook, web, facebook-opengraph

我一直在使用很棒的 facebook OpenGraph 和 publish_actions 权限。我的用户可以通过我们的网站发布操作，它直接连接到 Facebook-Timeline。很好的集成，开发非常简单：非常感谢您的工作！

但是，我还有一个问题：

是否可以不使用特定用户而是直接从 Facebook 页面使用 publish_actions？（如此处为用户描述的：[https](https://developers.facebook.com/docs/opengraph/actions/#create) ://developers.facebook.com/docs/opengraph/actions/#create ）

例如，用户 John Smith 有一个 Facebook 页面（名为“John Smith Advocate”），并且想要发布行动，不是来自 John Smith 本人，而是来自 Facebook 页面“John Smith Advocate”。

我想知道这是否可能。

非常感谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T10:38:23.640

为了发布为页面，您需要获取该页面的身份验证令牌。为此，您需要按照以下步骤操作（抱歉缺少详细信息，希望这会为您指明正确的方向）：

1）作为您页面管理员的用户需要通过您的应用程序进行身份验证，并且您需要为他们获得“manage_pages”扩展权限

2）获取用户是管理员的所有帐户的列表： [https ://graph.facebook.com/me/accounts](https://graph.facebook.com/me/accounts)

3）您将获得用户是管理员的页面的 json 数组，以及每个页面的访问令牌 - 提取相关的访问令牌

4）使用访问令牌发布到相关的专辑ID（由页面拥有） - 这是一些执行此操作的php代码；

```
<?php
$args = array('message' => 'Caption');
$args['image'] = '/path/to/image.jpg';
$args['access_token'] = $page_access_token;

$data = $facebook->api('/'. $album_id . '/photos', 'post', $args); 
```

# mysql - MySQL UNION LIMIT 的性能

> ID：10213410
> 
> 赞同：4
> 
> 时间：2012-04-18T16:06:29.647
> 
> 标签：mysql

我有两个不同的 MySQL 表，它们都包含时间序列数据（其中都包含“时间戳”列）。除了“timestamp”列之外，这两个表除了“client_id”列之外没有任何共同的特征。

```
table_a
- id
- client_id
- timestamp
- ...

table_b
- id
- client_id
- timestamp
- ... 
```

两个表都在（client_id，timestamp）上建立索引。

我正在尝试将这两个表组合成一个分页时间序列。具体来说，我的意思是我试图从 and 的`table_a`并集加载 N 条记录（偏移量为 M） `table_b`，按`timestamp`.

我试图用这样的声明来做到这一点：

```
(SELECT 'a', id FROM table_a WHERE client_id=1) UNION (SELECT 'b', id FROM table_b WHERE client_id=1) ORDER BY timestamp LIMIT 100; 
```

不幸的是，生成的查询似乎是从两个表中获取所有匹配的行，组合，然后应用 LIMIT。

请注意，对单个表的查询非常快：

```
SELECT 'a', id FROM table_a WHERE client_id=1 ORDER by timestamp LIMIT 100 
```

有没有更好的方法来索引表或编写 UNION 查询？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T16:33:20.770

你不能在这里很好地利用索引，因为两个单独的表中有两个单独的索引。

您可以为每个单独的选择添加限制，但这仅适用于第一页，不适用于偏移量。

如果您愿意放弃“页面”是限制加偏移量的要求，您可以使用其他一些绝对（而不是相对）方式进行分页，例如按天。例如：

```
(SELECT 'a', id, timestamp FROM table_a WHERE client_id=1 AND timestamp BETWEEN '2014-04-18 00:00:00' AND '2014-04-18 23:59:59')
UNION
(SELECT 'b', id, timestamp FROM table_b WHERE client_id=1 AND timestamp BETWEEN '2014-04-18 00:00:00' AND '2014-04-18 23:59:59')
ORDER BY timestamp; 
```

但是，您的数据也可能未完全规范化，并且 table_a 和 table_b 的公共属性应该在第三个表中。这种模式称为“联表继承”。

例如：

```
table_common
- id
- type ('a' or 'b')
- client_id
- timestamp
- primary key: (id, type) if id is not unique.
- index: (client_id, timestamp)

table_a
- id (same value as in table_common)
...

table_b
- id (same value as in table_common)
... 
```

由于您现在共享一个公共索引，您可以执行以下操作：

```
SELECT id, type, timestamp FROM table_common
WHERE client_id=1 ORDER BY timestamp LIMIT 100; 
```

如果您需要子表中的更多字段，请使用`LEFT OUTER JOIN`并包含`type`在条件中：

```
SELECT * FROM table_common
LEFT OUTER JOIN table_a ON table_common.type='a' AND table_common.id=table_a.id
LEFT OUTER JOIN table_b ON table_common.type='b' AND table_common.id=table_b.id
ORDER BY timestamp LIMIT 100; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T16:13:27.973

一种简单的方法是对每个单独的查询应用相同的 LIMIT，因为根据定义，任何单独的查询都不需要超过 N 行：

```
(SELECT 'a', id FROM table_a WHERE client_id=1 ORDER BY timestamp LIMIT 100) 
UNION 
(SELECT 'b', id FROM table_b WHERE client_id=1 ORDER BY timestamp LIMIT 100) 
ORDER BY timestamp 
LIMIT 100; 
```

# c# - 如何像 Linqpad 一样将 linq 结果导出到 excel

> ID：10213411
> 
> 赞同：4
> 
> 时间：2012-04-18T16:06:39.767
> 
> 标签：c#, linq, excel, linqpad

我有一个包含很多子查询的对象，我想像 Linqpad 一样导出到 excel，这是一个示例：

![在此处输入图像描述](../Images/c1be3629036889706393c42f19652f31.png)

有什么帮助吗？

Tks

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T18:27:32.133

如果您在项目中包含对 linqpad.exe 的引用，则可以使用它来导出到 html

例如，

```
List<User> users  = ....
var filename = "test.html";

var writer = LINQPad.Util.CreateXhtmlWriter();
writer.Write(users);

System.IO.File.WriteAllText(filename, writer.ToString());

// Open the file in excel
Process.Start("Excel" , filename); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T16:13:34.087

Excel 实际上可以打开一个 HTML 文档，重命名为“xls” - 将 HTML 表格结构读入 Excel 单元格。

不过，您必须将数据输出为 HTML。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-02T11:20:31.973

如前所述，LinqPad 并没有真正导出为 Excel 格式。但它会创建一个 HTML 文件，并使用 Ms-Excel 打开它。（但对于下载文件，您不能强制客户端如何打开文件，但您可以将扩展名命名为 XLS，并在 EXCEL 中打开并显示警告）。

为了生成 HTML 输出，LinqPad 使用[hyperlinq](https://github.com/hyperlinq/hyperlinq)库。

```
void Main()
{
    var filePath = Path.GetTempPath() + "output.html"; //or output.xls but with ms-excel warning
    var iEnumerbleValue = Enumerable.Range(1, 500).Select(e => new { a = 1, b = e });
    File.WriteAllText(filePath,  CreateHtml(iEnumerbleValue).ToString());
    Process.Start("EXCEL.EXE", filePath); 
}

HDoc CreateHtml<T>(IEnumerable<T> coll)
{
    var fields = typeof(T).GetProperties();

    return H.Doc(
            H.head(H.style()),
            H.body(
             H.table(
                H.tbody(
                    H.tr(fields.Select(f => H.th(f.Name))),
                    from item in coll
                    select H.tr(
                        fields.Select(f => H.td(f.GetValue(item)))
                    )
                        )
                    )
                  )
                );
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-07T13:24:58.973

我想为下一个搜索的人添加这个解决方案。我意识到这是一个老问题，但它是我搜索中唯一出现的问题。

您可以在命令行上运行 lprun。

```
lprun -format=html yourQuery.linq > output.xls 
```

Excel 能够打开 html，只要它是 xls 扩展名而不是 xlsx。如果您使用 xlsx，它会抱怨它的格式错误并且无法打开。使用 xls 扩展名，它会发出一条消息，但它可以打开。

正如一个注释 - 我需要一个实体框架的数据库连接字符串。我在 linqpad.config 中有它，我花了一段时间才弄清楚为什么 lprun 无法读取它。您必须将连接字符串部分添加到 lprun.exe.config 以便 lprun 可以使用它。

# php - 如何从另一台服务器接收和存储图像文件，通过参数以编程方式传递？

> ID：10213412
> 
> 赞同：0
> 
> 时间：2012-04-18T16:06:50.140
> 
> 标签：php, image, parameters, store

我正在使用图像编辑网站 (pixlr.com) 的 API 供我的网站成员使用。我在 iframe 中打开 Pixlr.com，他们可以在其中创建图像，保存后，pixlr 通过使用参数发送图像文件。

我想使用 PHP 将这些图像文件（每个成员唯一）保存在我的服务器（或 Amazon 的 S3 图像服务器）上的文件夹中。我如何接收他们的图像文件参数（“图像”）并将它们存储在我/亚马逊的图像服务器上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:06:39.597

如果图像通过 POST 发送到您的 PHP 脚本，那么您应该能够执行以下操作：

```
$handle = fopen($imageName, "wb");
fwrite($handle, $_POST["image"]);
fclose($handle); 
```

您要保存的图像的绝对路径和文件名在哪里`$imageName`（确保您的 Apache 用户对该目录具有写入权限）。根据图片的编码，您可能需要确定使用哪个扩展名保存它（即 .jpg、.bmp、.png 等）。

* * *

**编辑：**

看起来他们正在通过 发送图像`$_FILES`。试试这个：

```
move_uploaded_file($_FILES["image"]["tmp_name"], "/home/path/domain.com/upload/". time() .".png"); 
```

# c# - 为什么 callvirt IL 指令会导致虚拟方法中的递归调用？

> ID：10213413
> 
> 赞同：6
> 
> 时间：2012-04-18T16:06:50.373
> 
> 标签：c#, .net, cil

在这种情况下， IL 并不总是使用方法`callvirt`指令：`virtual`

```
class MakeMeASandwich{
  public override string ToString(){
    return base.ToString();
  }
} 
```

在这种情况下，据说 IL 将产生`call`而不是产生`callvirt`where`callvirt`来检查是否`variable`存在`null`，否则抛出`NullReferenceException`。

1.  `callvirt`如果使用而不是，为什么递归调用会发生直到堆栈溢出`call`？
2.  如果`call`使用，那么它什么时候检查它用来调用方法的实例变量是否为空？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T16:18:04.477

> 如果使用 callvirt 而不是调用，为什么递归调用会发生直到堆栈溢出？

因为那么您的代码与以下内容完全相同：

```
override string ToString()
{
    return this.ToString();
} 
```

这显然是一个无限递归，只要给定的方法是最重要的 ToString 版本。

> 如果使用 call ，那么它如何检查用于调用方法的实例变量是否为空？

这个问题是无法回答的，因为这个问题是假的。call 指令不*检查*对接收者的引用是否为 null，因此询问*call 指令为什么检查 null*没有任何意义。

让我把它改写成一些更好的问题：

> C#编译器在什么情况下生成调用vs callvirt？

如果 C# 代码对*虚拟方法执行**非虚拟调用*，则编译器*必须*生成调用，而不是 callvirt。真正发生这种情况的唯一一次是在使用调用虚拟方法时。**`base`**

 **如果 C# 代码正在执行*虚拟调用*，则编译器*必须*生成一个 callvirt。

如果 C# 代码对*非虚拟方法执行**非虚拟调用*，则编译器可以选择生成 call 或 callvirt。要么会工作。C# 编译器通常选择生成 callvirt。

 *> call 指令不会自动进行空值检查，但 callvirt 会。如果 C# 编译器选择生成调用而不是 callvirt，是否也有义务生成空检查？

否。如果已知接收器不为空，C# 编译器可以跳过空检查。例如，如果您说`(new C()).M()`的是非虚拟方法 M，那么编译器生成`call`没有空值检查的指令是合法的。我们知道 (1) 方法不是虚拟的，所以它不必是`callvirt`; 我们可以选择是否使用`callvirt`。而且我们知道 (2)`new C()`永远不会为空，因此我们不必生成空检查。

如果 C# 编译器*不*知道接收者不为 null，那么它将生成一个 callvirt，或者生成一个 null 检查，然后进行调用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T16:12:12.640

1.  callvirt 将调用 MakeMeASandwich 实现，而不是 Object 实现。这就是你如何让你的堆栈溢出。

2.  最初的调用是使用 callvirt，它确定引用不为空。如果控件在此 ToString 实现中，则您已经知道有一个对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-18T16:12:26.037

1.  `call`使用它是因为它在那里知道要调用哪个方法，并且不应该在运行时查找它（`callvirt`会导致代码调用在最具体的类中定义的方法，从而导致堆栈溢出）。

2.  `callvirt`意味着一个空检查，而`call`没有。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-18T16:12:19.373

Callvirt 调用最可用的派生方法。在这种情况下，这是 MakeMeASandwich.ToString()。

callvirt 的目的不仅仅是为了检查null，还为了执行一个虚方法调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-18T16:18:26.890

> 如果使用 callvirt 而不是调用，为什么递归调用会发生直到堆栈溢出？

正如其他人所回答的那样，`callvirt`虚拟地调用该方法。好像你写过

```
public override string ToString() {
    return ToString();
} 
```

> 如果使用 call ，那么它如何检查用于调用方法的实例变量是否为空？

其他人提到你已经知道那`this`不是空的。这是不正确的。*如果* `callvirt`用于调用`MakeMeASandwich.ToString`，则是，`this`不能为空。但是，没有`callvirt`用于调用您的函数的要求。其他语言确实允许您以生成操作码的方式编写调用，`call`在这种情况下，不执行空值检查。我认为 C++/CLI 允许它使用`makeMeASandwich->MakeMeASandwich::ToString()`，但我不完全确定。除非您检查，否则您无法确定它`this`不为空。***

# c# - VB6：调用 CreateObject 时出现运行时错误 424

> ID：10213416
> 
> 赞同：4
> 
> 时间：2012-04-18T16:07:01.010
> 
> 标签：c#, com, vb6, runtime-error, createobject

我创建了一个 C# COM 可访问的 dll，我想在 VB6 中使用它我能够在 VB6 中使用我的 COM 对象，并硬引用 TLB。我现在要做的是删除这个引用并动态加载它我正在创建它，如下所示：

```
Dim keylok As Object
Set keylok = CreateObject("MyClassLib.MyObject") 
```

一旦我点击第二行，我就会收到运行时错误 424“需要对象”。但是当我按如下方式创建它时：

```
Dim keylok As MyObject
Set keylok = CreateObject("MyClassLib.MyObject") 
```

它工作正常。我不确定为什么会有所作为。无论如何，我不能使用第二个，因为我仍然需要物理参考。

我也尝试作为一种调试来写入我的 COM 对象构造函数中的文件，以判断它是否真的被调用。是的，它确实如此，我什至能够在构造函数中成功地调用我的 COM 对象中的其他方法。

我什至可以使用以下方法从另一个 C# 应用程序动态加载并使用它：

```
dynamic myObj = Activator.CreateInstance(Type.GetTypeFromProgID("MyClassLib.MyObject")); 
```

有没有人遇到过类似的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T19:54:23.650

我在@rskar 输入的帮助下找到了解决方案。所以，我想我会回答我的问题，以防万一有人遇到同样的问题。

我的对象没有影响 IDsipatch。所以我所要做的就是用它来装饰我的 C# COM 接口，`InterfaceType(ComInterfaceType.InterfaceIsDual)`所以它同时实现了 IUnknown 和 IDispatch。最初它装饰着`InterfaceType(ComInterfaceType.InterfaceIsIUnknown)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T16:13:43.220

我认为无论如何您都将需要 .tlb 。COM 对象需要能够被编组，因为 .Net 宿主在与 VB6 运行时不同的线程上运行。默认编组使用来自类型库的信息来执行此操作。IDIspatch 有 4 种方法，其中 2 种与访问类型信息有关。因此，如果您删除了 .tlb，那么当您创建 IDispatch COM 时，可能会尝试从中调用 ITypeInfo，但无法加载已注册的类型库。如果您消除 .tlb，您将无法进行编组，并且可能必须为您的界面提供自定义编组器。

# ajax - 避免 Web 应用程序上的“页面加载”闪烁，同时在需要时仍提供消息

> ID：10213418
> 
> 赞同：4
> 
> 时间：2012-04-18T16:07:03.743
> 
> 标签：ajax, jquery

我有一个 Web 应用程序，它发出了很多 AJAX 请求。有些很轻，有些很重。

我有一个加载屏幕，对于繁重的请求非常有用，但在轻的请求上，它只是一个（n 烦人的）闪烁。

我可以避免显示轻量请求的加载屏幕，但有一个问题：我希望当用户处于远程（慢速）网络中时，这些轻量请求可能仍需要一段时间，使它们变得有用且一点也不烦人闪烁。

我考虑过每加载几个页面就用一个轻请求来测量延迟，但这可能很容易变得复杂（是否已经为此制作了库？）

无论如何，这个问题有标准的解决方案吗？你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:10:31.400

确实没有办法（据我所知）来测量预先完成 AJAX 请求所需的时间。如果有的话，我很想知道！

我要做的是在一定的延迟后引入加载栏。一个可观的延迟将在繁重的 AJAX 请求上显示加载栏，（希望）防止加载栏在轻量的 AJAX 请求上显示，并在 AJAX 请求异常长时优雅地回退到显示它。

但这并不能阻止闪烁——仍然有机会。但我想这将在不必要的场合显着减少闪烁。

# c# - 处理旧数据集并使用 C# 用新条目重新填充它

> ID：10213422
> 
> 赞同：1
> 
> 时间：2012-04-18T16:07:09.307
> 
> 标签：c#, dataset, reload

我有一个从 postgressql 数据库返回**DataSet的方法。**

```
 ds = stats.loadStats(); 
```

我需要随机更新 DataSet，每 3 分钟一次（例如）。

```
 Random r = new Random();
                var rendom_number = r.Next(0, 179);//3 minutes = 3*60 = 180 sec.
                if (rendom_number == 1)
                {
                   //reload Dataset here
                } 
```

**一旦触发事件 - 我需要处理旧数据集并使用新数据集对其进行更新，而不会导致过载、内存泄漏或其他问题。你是如何用 C# 做到这一点的？**

我知道三种方法，但哪种方法最好？

1.  方法

    ```
     ds.Clear(); //disposing of old DataSet
            ds = stats.loadStats(); //loading new 
    ```

2.  方法

    ```
     ds.Dispose(); //disposing of old DataSet
            ds = stats.loadStats(); //loading new 
    ```

3.  方法

    ```
     ds = null; //disposing of old DataSet
            ds = stats.loadStats(); //loading new 
    ```

4.  你的方法是什么？（或最佳选择）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:16:57.343

所有你需要的是

```
//ds.Clear(); 
//ds = null; 
ds.Dispose();  // not really needed but out of general principle
ds = stats.loadStats();  // gets a new instance 
```

剩下的留给垃圾收集器。

# c++ - 将仿函数作为 C++ 模板参数传递

> ID：10213427
> 
> 赞同：3
> 
> 时间：2012-04-18T16:07:15.647
> 
> 标签：c++, templates

作为我个人启蒙的练习，我使用表达式模板实现矢量数学。我想实现一些将相同的一元函数应用于向量表达式的所有元素的操作。到目前为止，我这样做。

我的基向量表达式模板是这样实现的

```
template <typename E>
class VectorExpr {
public:
  int size() const { return static_cast<E const&>(*this).size(); }

  float operator[](int i) const { return static_cast<E const&>(*this)[i]; }

  operator E& () { return static_cast<E&>(*this); }

  operator E const& () const { return static_cast<const E&>(*this); }
}; // class VectorExpr 
```

然后，应该是矢量的对象将如下所示

```
class Vector2 : public VectorExpr<Vector2> {
public:
    inline size_t size() const { return 2; }

    template <typename E>
    inline Vector2(VectorExpr<E> const& inExpr) {
    E const& u = inExpr;
    for(int i = 0; i < size(); ++i)
        mTuple[i] = u[i];
   }

private:
   float mTuple[2];
}; 
```

假设我想将 std::sin 应用于表达式的所有元素

```
template <typename E>
class VectorSin : public VectorExpr<VectorSin<E> > {
    E const& mV;

public:
    VectorSin(VectorExpr<E> const& inV) : mV(inV) {}

    int size() const { return mV.size(); }

    float operator [] (int i) const { return std::sin(mV[i]); }
}; 
```

问题 => 如果我想添加更多函数，我会复制粘贴我为 sin 函数所做的工作，以及每个函数（如 cos、sqrt、fabs 等）。我怎样才能避免这种复制粘贴？我尝试了一些东西，发现我的模板符仍然很低。不允许提升^^

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:17:04.650

```
template <typename F, typename E>
class VectorFunc : public VectorExpr<VectorFunc<F, E> > {
    E const& mV;

public:
    VectorSin(VectorExpr<E> const& inV) : mV(inV) {}

    int size() const { return mV.size(); }

    float operator [] (int i) const { return f(mV[i]); }

    // this assumes the Functor f is default constructible, this is
    // already not true for &std::sin. Adding the constructor that
    // takes f, is left as an exercise ;)
    F f;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:31:01.127

除了[pmr](https://stackoverflow.com/users/105672/pmr)的答案之外，标准`<cmath>`函数不是函子，因此您不能直接使用它们来指定您的类的独特特化 - 即您不会有 std::sin 与 std 的单独模板实例化： :cos （我猜你的目标是什么？如果我误解了你，请纠正我）。

您可以创建一个包装器，以便将函数指针映射到不同的类型，例如

```
#include <iostream>

template< void (*FuncPtr)() > struct Func2Type
{
    void operator() () { FuncPtr(); }
};

void Hello() { std::cout << "Hello" << std::endl; }
void World() { std::cout << "world" << std::endl; }

int main()
{
    Func2Type<Hello> test1;
    Func2Type<World> test2;
    test1(); 
    test2();
} 
```

这样你就可以像普通仿函数类一样使用它们作为模板参数

# java - 操作复杂的哈希图

> ID：10213428
> 
> 赞同：1
> 
> 时间：2012-04-18T16:07:18.317
> 
> 标签：java, data-structures, hashmap

我正在尝试实现一个看起来像的复杂数据结构

```
Map<A,Set<B>> map = new HashMap<A,Set<B>>(); 
```

但我不确定如何向此数据结构添加内容。我正在尝试做一个

```
map.put(a,b); 
```

但这无济于事，因为它需要一个集合。我的要求需要实现这个数据结构。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:09:56.037

您需要`add`在哈希映射中包含的集合内的元素：

```
if (!map.containsKey(a)) {
    map.put(a, new Set<B>());
}
map.get(a).add(b); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:10:15.433

如果您有能力为您的项目添加依赖项，那么[Guava](http://code.google.com/p/guava-libraries/)对此提供支持。您需要使用[SetMultimap](http://docs.guava-libraries.googlecode.com/git/javadoc/index.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:09:59.780

您首先需要获取集合，然后添加到它：

```
map.get(a).put(b); 
```

您可能还需要处理该集合不存在的特殊情况。

```
Set<B> set = map.get(a);
if (set == null)
{
    set = new HashSet<B>();
    map.put(a, set);
}
set.put(b); 
```

# geocoding - 必应地理编码与谷歌地理编码的使用限制？

> ID：10213431
> 
> 赞同：4
> 
> 时间：2012-04-18T16:07:20.263
> 
> 标签：geocoding, bing

我知道谷歌地理编码 API 在开始返回 REQUEST_DENIED 之前每天有 2,500 次点击的限制。bing 一个需要多少？我听说它是​​无限的，但我无法确认。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-06-17T11:02:36.197

刚碰到这个问题。它有点旧，但仍然相关。对于 Bing 地图，有两种不同的地址地理编码方式。第一个是批量地理编码，它具有 alfski 概述的限制。

第二个选项是 REST 地理编码服务，它允许您一次对一个地址进行地理编码。必应地图服务的免费交易因用例而异。对于 Windows/Windows Phone/WPF 应用程序，根据免费使用条款，您每天最多可以进行 50,000 笔交易。对于 iOS、Android 和 Web 应用程序等其他平台，每年允许进行 125,000 笔免费交易。您可以在此处找到更多详细信息：http: [//www.microsoft.com/maps/create-a-bing-maps-key.aspx](http://www.microsoft.com/maps/create-a-bing-maps-key.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-28T02:29:11.540

The Microsoft Bing Maps terms & conditions are at [http://www.microsoft.com/maps/product/terms.html](http://www.microsoft.com/maps/product/terms.html)

The T&C's will change so please check the link.

As of January 2013 under the General Terms of Use, the Bing geocoding limits are:

"a total of 5 batch geocoding or file uploads with a maximum of 50 records each, using the Bing Spatial Data Services API, within any 24 hour period."

However if you have a Bings Map Agreement:

"...a total of 24 batch geocoding or file uploads with a maximum of 200,000 records each, using the Bing Spatial Data Services API, within any 24 hour period.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-25T03:52:20.207

1) Google Maps API 最近更改了价格：

标准计划：

```
2,500 requests per day free.
After that is $0.50 per 1000 requests. 
```

高级计划：

```
Pay $10,000/year.
Get 100,000 requests per day "for free".
Above that - 500,000 requests per year are "free".
Above that - buy next package. 
```

但是，“Web 服务 API 和 JavaScript API 需要高级计划。” 我的理解是，如果您从服务器（而不是手机）调用地理编码，则必须正式使用高级计划（10000 美元/年）。

更多细节在这里：[http ://dennisgorelik.livejournal.com/112993.html](http://dennisgorelik.livejournal.com/112993.html)

2) Bing Maps API 不公布其价格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-27T10:01:17.263

顺便说一句，您还可以免费试用 Yandex Geocoding API，每个网站/移动应用每天最多可免费处理 25.000 个请求：

[http://api.yandex.com/maps/doc/geocoder/desc/concepts/input_params.xml](http://api.yandex.com/maps/doc/geocoder/desc/concepts/input_params.xml)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-26T17:33:04.393

这是许可工具，可了解他们将向您收取多少费用

[http://www.microsoft.com/maps/Licensing/licensing.aspx](http://www.microsoft.com/maps/Licensing/licensing.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-21T20:37:32.467

**截至 2022 年 2 月的更新答案**

谷歌地图提供每月 200 美元的[信用额度](https://mapsplatform.google.com/pricing/)，相当于每月 40,000 个免费地理编码。

Bing Maps 允许您为开发目的注册“基本密钥”，每个日历年为您提供 125,000 个免费地理编码。他们的许可页面在[这里](https://www.microsoft.com/en-us/maps/licensing/licensing-options/)。

# printing - GeoExt PDF 打印：“错误消息：Access-Control-Allow-Origin 不允许来源 http://localhost:55608”

> ID：10213440
> 
> 赞同：0
> 
> 时间：2012-04-18T16:07:56.677
> 
> 标签：printing, openlayers, geoserver, print-module

我正在尝试生成一个 pdf 文件以使用 GeoExt 打印地图，但遇到了问题。在 Chrome 上，我收到错误消息：

```
XMLHttpRequest cannot load http://Howard:8080/geoserver/pdf/create.json. Origin http://localhost:55608 is not allowed by Access-Control-Allow-Origin. 
```

我认为错误消息告诉我它与代理有关，所以我尝试将以下内容添加到 Config.yaml 但不是运气：

```
- !localMatch
  dummy: true
- !ipMatch
  host: 0.0.0.0
  mask: 0.0.0.0 
```

这应该允许所有本地 IP 地址和所有主机访问 Howard:8080 中的 create.json，但由于某种原因，我仍然收到错误消息。

但是，在 Firefox 上，我的行为略有不同。我没有收到任何错误消息，但最终触发了打印异常并显示错误消息“通信失败。

我被卡住了，没有想法，有人可以帮忙吗？

这是代码：

```
var printProvider =  new GeoExt.data.PrintProvider({
              //method: "GET", // "POST" recommended for production use
              method: "POST", // "POST" recommended for production use

              //capabilities: g_printCapabilities,  // provide url instead for lazy loading

              url: OpenLayers.ProxyHost + "http://Howard:8080/geoserver/pdf/",
              //url: "http://Howard:8080/geoserver/pdf/",
              autoLoad: true,

              customParams: {
                mapTitle: "GeoExt Printing Demo",
                comment: "This demo shows how to use GeoExt.PrintMapPanel with OSM"
              }
          });

var printPage = new GeoExt.data.PrintPage({
    printProvider: printProvider
});

var mapPanel = new GeoExt.MapPanel({
    title: "Map",
    region: "center",
    height: 400,
    width: 600,
    map: map,

    bbar: ["->", {
        text: "Print",
        handler: function() {
            // convenient way to fit the print page to the visible map area
            printPage.fit(mapPanel, true);

            printProvider.print(mapPanel, printPage);
        }
    }]
});

// create a panel and add the map panel and grid panel
// inside it
var mainPanel = new Ext.Panel({
    renderTo: "mainpanel",
    layout: "border",
    height: 800,
    width: 600,
    items: [mapPanel]
}); 
```

编辑：

我在javascript中添加了以下代码：

```
var invocation = new XMLHttpRequest();  
var url = 'http://Howard:8080/geoserver/pdf/create.json';  

function callOtherDomain() {  
  if(invocation) {      
      invocation.open('POST', url, true);  
      invocation.onreadystatechange = function (){
          alert("invocation.onreadystatechange");
      }  
      invocation.send();   
  }  
}  
callOtherDomain(); 
```

但我仍然收到错误消息。我是否在 Howard 服务器上添加 Access-Control-Allow-Origin 标头？如果是这样，我该怎么做？

编辑2：

我在后面的代码中添加了以下内容：

```
Response.AddHeader("Access-Control-Allow-Origin", "*");
Response.AddHeader("Access-Control-Allow-Headers", "POST");
Response.AddHeader("Access-Control-Allow-Headers", "GET"); 
```

我还放置了以下内容：

```
<httpProtocol>
  <customHeaders>
    <add name="Access-Control-Allow-Origin" value="*" />
  </customHeaders> 
```

机器上添加的两个代码块将调用我的 web.config 文件中的 pdf 文件，但仍然没有运气。

编辑 3。

如果我不包含任何矢量图层，pdf 文件似乎可以正确生成。这适用于 Firefox 和 chrome。我对 IE 有单独的问题，因此无法在那里进行测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-19T06:29:15.723

我在当前来源的服务器上使用代理方法，在客户端我只是重写打印并创建 url：

```
"loadcapabilities": function () {
                    if (self.printProvider.capabilities.createURL.indexOf('url') === -1) {
            self.printProvider.capabilities.createURL = GMARC.geoserverPrintProxy + '?url=' + encodeURIComponent(self.printProvider.capabilities.createURL);
            self.printProvider.capabilities.printURL = GMARC.geoserverPrintProxy + '?url=' + encodeURIComponent(self.printProvider.capabilities.printURL);
        }
                }, 
```

在服务器端类似于 node.js：

```
url = 'http://geoserveripaddress:8080/geoserver/pdf/' + self.c.req.params.id;
        var method = self.c.req.params.id === 'info.json' ? 'GET' : 'POST', params = {};
request(url,
            {
                auth: {
                    "user": username,
                    "password": password,
                    'sendImmediately': false
                },
                method: method,
                json: params
            }
        ).pipe(self.c.res); 
```

# c++ - 参考误差

> ID：10213444
> 
> 赞同：-2
> 
> 时间：2012-04-18T16:08:15.263
> 
> 标签：c++, reference

我有一个头文件，我在其中声明了一个函数。然后我创建了这个函数并尝试使用它，但我得到了一个错误。这是参考，但我不知道为什么它不起作用。

结构体.h

```
#ifndef LISTSTRUC_H_
#define LISTSTRUC_H_

template <class T> struct Array{
    int days;
    T * M;

Array( int size ) : days(size), M(new T[size])
{
}
~Array()
{
   delete[] M;
}
};

void currentDay();

template <class Expe>
void dummyData(Array<Expe> &);

#endif /* LISTSTRUC_H_ */ 
```

结构体.cpp

```
void dummyData(Array <Expe> &A){
for(int i=0; i<31; i++){
    A.M[i].Expe::setObj((i*3),(i*1),(i*6),(i*2),(i*4),(i*5));
}
 } 
```

M.cpp(主cpp)

```
int main(){
//Main function of the program. no pre/ post condition.

    Array <Expe> A(31);   // Work space
    Array <Expe> B(31);   // Backup space

    dummyData(&A);         // error
 } 
```

错误：

```
..\M.cpp:22:14: error: no matching function for call to 'dummyData(Array<Expe>*)' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:10:03.150

```
dummyData(&A); 
```

应该：

```
dummyData(A); 
```

**基本原理：**
您的函数采用引用而不是指针，`&A`这意味着您正在传递只能由指向该类型的指针接收的类型的地址，并且您没有该函数的重载版本，因此出现错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:11:40.467

如果通过引用传递对象，请不要传递其地址，就像您在此处所做的那样：

```
dummyData(&A); 
```

只需传递对象本身（因为引用是它的别名）：

```
dummyData(A); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:10:17.313

您不应该将引用`&`通过引用传递变量，只需传递它。

```
dummyData(A); 
```

通过引用传递意味着您没有复制对象，而是使用对象本身，如果作为变量（不是`const`）传递，更改将影响它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T16:10:47.113

```
dummyData(&A); 
```

应该

```
dummyData(A); 
```

`&`此上下文中的运算符正在获取`A`作为指针的地址。要传递引用，您只需使用实际的变量名称。

# qt - Qt：更改文本的颜色部分

> ID：10213446
> 
> 赞同：1
> 
> 时间：2012-04-18T16:08:19.360
> 
> 标签：qt

这是我的代码：

```
QTextCursor cursor = ui->editor->textCursor(); // editor is QTextEdit
cursor.select(QTextCursor::WordUnderCursor);
QString c = cursor.selectedText();

if (c == keywords[i])
{
    cursor.removeSelectedText();
    cursor.insertHtml("<font color=\"DeepPink\">" + keywords[i] + "</font>");
} 
```

所以，如果关键字是“新”，这个词是粉红色的。问题是在“新”之后插入的所有内容也都是红色的，而不是标准的黑色。有人吗？:)

更新：

愚蠢的我。刚刚添加`ui->editor->setTextColor("#000000");`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T18:39:53.517

```
ui->editor->setTextColor("#000000"); 
```

# ruby-on-rails - Rails update_all 在一个带有索引的查询中

> ID：10213448
> 
> 赞同：5
> 
> 时间：2012-04-18T16:08:33.650
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

这是我在控制器中的功能：

```
def sort
  params[:state].each_with_index do |id, index|
    State.update_all({:position => index+1, :country_id => params[:country_id]}, {:id => id})
  end
  render :nothing => true
end 
```

这是我的输出：

```
Started POST "/countries/83/states/sort" for 127.0.0.1 at Thu Apr 19 00:02:56 +0800 2012
  Processing by StatesController#sort as JS
  Parameters: {"country_id"=>"83", "state"=>["378", "381", "380"]}

ApplicationController::current_user_session
  Country Load (0.3ms)  SELECT `countries`.* FROM `countries` WHERE `countries`.`id` = 83 LIMIT 1
  SQL (1.0ms)  UPDATE `states` SET `country_id` = '83', `position` = 1 WHERE `states`.`id` = 378
  SQL (1.4ms)  UPDATE `states` SET `country_id` = '83', `position` = 2 WHERE `states`.`id` = 381
  SQL (0.9ms)  UPDATE `states` SET `country_id` = '83', `position` = 3 WHERE `states`.`id` = 380
  SQL (0.6ms)  UPDATE `countries` SET `updated_at` = '2012-04-19 00:02:56' WHERE `countries`.`id` = 83
Rendered text template (0.0ms)
Completed 200 OK in 559ms (Views: 13.0ms | ActiveRecord: 39.3ms | Sphinx: 0.0ms) 
```

显然，以上内容并不能在一个查询中运行，因为我无法让索引加速。

我想要做的是在一个查询中运行它`index`。`position`应该总是从id 数组的`1`排列开始`[378, 381, 380]`。

简而言之：上面的结果是正确的，但我想在一个查询中运行它。

注意：它必须是通用 SQL，它必须在 MySQL 和 Postgres 中都可以工作。因为我认为`FIND_IN_SET`在 MySQL 中有效，而不是在 Postgres 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T16:05:30.790

您是否尝试根据`:position`属性对模型对象列表进行排序？

如果是这样，我建议使用链表方法可能会更好。[使用Resort gem](https://github.com/codegram/resort)可以很容易地做到这一点。它还包含一些非常有用的辅助方法：

```
Product.first_in_order # returns the first ordered product.
Product.last_in_order # returns the last ordered product.
Product.ordered # returns all products ordered as an Array, not a Relation! 
```

除非我误解了你要做什么……</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-28T15:17:03.470

不知道它会有多大帮助，但我使用以下代码让这个插件工作，模型排序是 Step

宝石文件

```
# Use jquery-ui
gem 'jquery-ui-rails', '~> 5.0', '>= 5.0.5' 
```

在 application.js 中需要

```
//= require jquery_ujs 
```

查看：（我使用了一个表格，但 ul 也可以在表格正文中添加：

```
<tbody id="steps" data-update-url="<%= sort_course_steps_url %>"> 
```

对于每个表行添加：

```
<tr id="step_<%= step.id %>"> 
```

Javascript：应用可排序并发布序列化数据

```
jQuery(function() {
  return $('#steps').sortable({
    axis: 'y',
    update: function() {
     return $.post($(this).data('update-url'), $(this).sortable('serialize'));
    }
  });
}); 
```

路线

```
resources :steps do
    collection {post :sort}
end 
```

控制器：

```
def sort
  params[:step].each_with_index do |id, index|
    Step.where(id:id).update_all(order: index+1)
  end
  render nothing: true
end 
```

# powershell - Powershell：过滤事件日志

> ID：10213451
> 
> 赞同：1
> 
> 时间：2012-04-18T16:08:43.960
> 
> 标签：powershell, powershell-2.0, event-log

我编写了一个小脚本来从应用程序中检索过去 10 天的事件日志，但我收到了错误消息。任何想法为什么会出现错误？

> Where-Object：无法绑定参数“FilterScript”。无法将值“False”转换为类型“System.Management.Automation.ScriptBlock”。错误：“从 'System.Boolean' 到 'System.Management.Automation.ScriptBlock' 的无效转换。”

```
#Sets the application log to query 
$Log ="Application"
$FilterHashTable = @{LogName=$Log}

#stores the computer name 
$ComputerName = $env:COMPUTERNAME 

#sets the date 10 days ago 
$DeleteDate = Get-Date 
$DeleteDate = $DeleteDate.AddDays(-10) 
Write-Verbose $DeleteDate 

#retrieve WMIevent and logs the information 
$Winevent = Get-WinEvent -ComputerName $ComputerName -FilterHashTable $FilterHashTable  -ErrorAction SilentlyContinue

# Filter on time 
$Winevent | where-object ($_.timecreated -gt $DeleteDate) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:11:20.530

`Where-Object`需要一个 scriptblock 参数 - 使用花括号`{...}`而不是括号`(...)`来包含您的过滤器逻辑。

目前 PS 正在检查您的条件并返回一个布尔值，而不是将其用作过滤器。

# filemaker - 对值列表执行查找

> ID：10213453
> 
> 赞同：1
> 
> 时间：2012-04-18T16:08:54.867
> 
> 标签：filemaker

在 Filemaker11 中。

我有一个带有字段 categoryID 的表，并且想对这些记录执行查找。

我只想显示具有`categoryID`1、2、4、6、12 或 13 的记录。执行查找似乎不允许我设置 OR ......或者至少我看不到它在哪里.

我怎样才能做到这一点？

*注意：此表实际上是连接（具有只读权限）到 MySQL 数据库中的表，因此我无法设置显示布尔值 isOneOrTwoOr... 的字段*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:30:14.327

在查找模式下，进入“记录”菜单并选择新的查找请求。所有查找请求都是 ORed 在一起的。您可以通过执行“新记录/请求”脚本步骤在脚本中执行相同的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:12:50.310

你可以做这样的事情（假设你使用 MySql 数据库，因为你没有提到）

```
Select * from tablename where categoryID in (1,2,4,6,12,13); 
```

这是简单的 MySql 查询

# javascript - 在浏览器中 Javascript 编辑器和执行

> ID：10213455
> 
> 赞同：2
> 
> 时间：2012-04-18T16:09:04.117
> 
> 标签：javascript

我正在开发一个 Enyo Web 应用程序，并希望允许用户在浏览器中编写他们的 Javascript 代码并执行它。

我可以通过使用来做到这一点`window.eval`。但是，我已经阅读了 eval 的弊端。

有没有人可以阐明[http://learn.knockoutjs.com/](http://learn.knockoutjs.com/)、[http://jsfiddle.net](http://jsfiddle.net)等示例在浏览器执行中的安全性以及最佳实践是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-29T20:05:05.650

除了一种特定情况外，Eval 被认为是邪恶的，这是您在运行时（或元编程）期间生成程序的情况。唯一的选择是编写您的解析器/解释器（这可以在 javascript 中相对容易地完成，但是对于比 javascript 本身更简单的语言 - 我做到了，这很有趣）。因此`eval()`在此处使用函数是合法的（为了使浏览器端编译器生成相当快的代码，无论如何您都需要使用 eval 生成编译后的 javascript）。

但是，eval 的问题是安全性，因为评估的代码与运行它的脚本具有相同的权限和对其环境的访问权限。这是最近很热门的话题，EcmaScript 5 旨在通过引入严格模式来部分解决这个问题，因为可以静态分析严格模式代码以查找危险操作。

这通常是不够的（或者出于向后兼容性的原因有问题），所以有像[Caja](http://en.wikipedia.org/wiki/Caja_project)这样的方法通过分析服务器上的代码来解决安全问题，并且只允许使用严格安全的 javascript 子集。

另一种常用的方法是保护用户，但不能通过在`<iframe>`嵌入在父页面的元素中运行用户生成的 javascript（通常由[jsfiddle](http://jsfiddle.net/)等网站使用）来防止恶意攻击。`iframe`但是可以访问其父页面并获取其内容是不安全的。

即使在这种方法中，最近也取得了一些进展，例如在 chrome 中，通过使用属性`iframe`使其不那么容易受到攻击[`sandbox`](http://www.w3schools.com/html5/att_iframe_sandbox.asp)

```
<iframe src="sandboxedpage.html" sandbox="allow-scripts"></iframe> 
```

您甚至可以在其中指定不同的权限。

希望我们很快就会有一个简单的方法来使用安全和简单的元编程，但我们还没有做到。

# facebook-graph-api - facebook-ios-sdk 请求名称和带有类型的个人资料图片不起作用

> ID：10213457
> 
> 赞同：1
> 
> 时间：2012-04-18T16:09:06.297
> 
> 标签：facebook-graph-api, request, facebook-ios-sdk

我想做下面的事情，但它不起作用。

```
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:@"first_name,picture?type=normal", @"fields",nil];
[facebook requestWithGraphPath:@"me" andParams:params andDelegate:self]; 
```

我正在使用的 facebook-ios-sdk 在[这里](https://github.com/facebook/facebook-ios-sdk)

如果我想在一个请求中请求他们，该怎么做？谢谢。

我使用了批处理请求，例如

```
NSString *jsonRequest1 = @"{ \"method\": \"GET\", \"relative_url\": \"me?fields=first_name\" }";
NSString *jsonRequest2 = @"{ \"method\": \"GET\", \"relative_url\": \"me/picture?type=square\" }";
NSString *jsonRequestsArray = [NSString stringWithFormat:@"[ %@, %@ ]", jsonRequest1, jsonRequest2];
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObject:jsonRequestsArray forKey:@"batch"];
[facebookDelegate requestWithGraphPath:@"me" andParams:params andHttpMethod:@"POST" andDelegate:self]; 
```

我得到的结果是

```
({
body = "{\"first_name\":\"Eric\",\"id\":\"100003742445201\"}";
code = 200;
headers =     (
            {
        name = "Access-Control-Allow-Origin";
        value = "*";
    },
            {
        name = "Cache-Control";
        value = "private, no-cache, no-store, must-revalidate";
    },
            {
        name = Connection;
        value = close;
    },
            {
        name = "Content-Type";
        value = "text/javascript; charset=UTF-8";
    },
            {
        name = ETag;
        value = "\"3be1c3dfc20761062712ae899cc7c402062300a7\"";
    },
            {
        name = Expires;
        value = "Sat, 01 Jan 2000 00:00:00 GMT";
    },
            {
        name = Pragma;
        value = "no-cache";
    }
);},
{
body = "<null>";
code = 302;
headers =     (
            {
        name = "Access-Control-Allow-Origin";
        value = "*";
    },
            {
        name = "Cache-Control";
        value = "private, no-cache, no-store, must-revalidate";
    },
            {
        name = Connection;
        value = close;
    },
            {
        name = "Content-Type";
        value = "image/jpeg";
    },
            {
        name = Expires;
        value = "Sat, 01 Jan 2000 00:00:00 GMT";
    },
            {
        name = Location;
        value = "http://profile.ak.fbcdn.net/hprofile-ak-snc4/573359_100003742445201_1494953237_q.jpg";
    },
            {
        name = Pragma;
        value = "no-cache";
    }
);
}
) 
```

个人资料图片位置不正确。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:21:36.317

这是使用 ios-sdk 的示例批次

* * *

有关完整示例，请参阅[https://stackoverflow.com/a/5503010/912623](https://stackoverflow.com/a/5503010/912623)。

```
-(void) prepareMyBatchRequest {
    NSString *jsonRequest1 = @"{ \"method\": \"GET\", \"relative_url\": \"me?fields=first_name,picture\" }";
    NSString *jsonRequest2 = @"{ \"method\": \"GET\", \"relative_url\": \"me\" }";
    NSString *jsonRequestsArray = [NSString stringWithFormat:@"[ %@, %@ ]", jsonRequest1, jsonRequest2];
    NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObject:jsonRequestsArray forKey:@"batch"];
    [facebook requestWithGraphPath:@"me" andParams:params andHttpMethod:@"POST" andDelegate:self];
} 
```

# java - 如何使用 jacoco 获得外部 Java 库的代码覆盖率？

> ID：10213464
> 
> 赞同：13
> 
> 时间：2012-04-18T16:09:48.180
> 
> 标签：java, maven, jacoco

如果我有一个使用库（jar 文件）的 java 项目，是否可以获得该 jar 中类的代码覆盖率？

这背后的想法是，我想找出项目所依赖的外部库的比例（比如说 spring、hibernate，或者如果它是一个 scala 项目，它可能是 scala jar，为什么不）被实际使用。我什至想象我可以尝试将它们列出并将它们重新捆绑在一个*仅*包含必要的 .class 文件（例如，使用 apache felix 之类的插件）的单个 jar 中，以获得尽可能小的 jar。我不确定我是否真的想这样做，我知道出于多种原因这可能是一个坏主意，但我认为这是一个实验。

我找不到怎么做，jacoco 只报告了我项目中类文件的覆盖率。也许我做错了什么，我正在使用这样的maven插件：

```
 <plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <version>0.5.6.201201232323</version>
            <configuration>
                <destfile>${basedir}/target/coverage-reports/jacoco-unit.exec</destfile>
                <datafile>${basedir}/target/coverage-reports/jacoco-unit.exec</datafile>
                <includes>
                    <include>**</include>
                </includes>
            </configuration>
            <executions>
                <execution>
                    <id>jacoco-initialize</id>
                    <goals>
                        <goal>prepare-agent</goal>
                    </goals>
                </execution>
                <execution>
                    <id>jacoco-site</id>
                    <phase>package</phase>
                    <goals>
                        <goal>report</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

我尝试更改包含标记，但唯一的效果是限制默认值，它仅包含直接在我的项目中的类文件。

提前致谢 ！

* * *

在oers的回答后编辑：

我发现了如何使用 ant 和 antrun-plugin 来完成它，虽然它非常复杂，但我在使用 antrun 插件版本时遇到了很多麻烦（无法使最新版本工作，即使是基本任务），我真的很想坚持马文。**如果有人知道如何用 je jacoco maven 插件而不是 ant 来做同样的事情，我很感兴趣！**

ant 的部分解决方案：实际上 jacoco.exec 文件已经包含对我的外部 jar 类的引用；因此，应该告诉报告任务考虑这些 jar，而不是我认为的运行时阶段。这是我使用的 maven 配置（我在[http://intellectualcramps.wordpress.com/2012/03/22/jacoco-tycho-and-coverage-reports/](http://intellectualcramps.wordpress.com/2012/03/22/jacoco-tycho-and-coverage-reports/)上找到了帮助）：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <!--<version>1.7</version>-->
            <dependencies>
                <dependency>
                    <groupId>org.jacoco</groupId>
                    <artifactId>org.jacoco.ant</artifactId>
                    <version>0.5.6.201201232323</version>
                </dependency>
                <dependency>
                    <groupId>ant-contrib</groupId>
                    <artifactId>ant-contrib</artifactId>
                    <version>20020829</version>
                </dependency>
            </dependencies>
            <executions>
                <execution>
                    <id>jacoco-report</id>
                    <phase>package</phase>
                    <goals>
                        <goal>run</goal>
                    </goals>
                    <configuration>
                        <tasks>

                            <taskdef name="jacoco-report"
                                   classname="org.jacoco.ant.ReportTask"
                                   classpathref="maven.plugin.classpath" />
                            <taskdef classpathref="maven.runtime.classpath"
                     resource="net/sf/antcontrib/antcontrib.properties" />
                            <available
               file="${project.basedir}/target/jacoco.exec"
               property="jacoco.exec.file.exists" />
                            <echo message="${project.basedir}/target/jacoco.exec" />
                            <if>
                                <equals arg1="${jacoco.exec.file.exists}"
                      arg2="true" />
                                <then>
                                    <echo message="Executing jacoco report" />

                                    <trycatch>
                                        <try>
                                            <jacoco-report>
                                                <executiondata>
                                                    <file
                                 file="${project.basedir}/target/jacoco.exec" />
                                                </executiondata>

                                                <structure name="Minerva">
                                                    <classfiles>
                                                        <fileset
                                     dir="target/classes" />

                                                        <fileset dir="C:/Data/dev/m2Repository/com/groupama/framework/crypt/fwk-cryptage/1.0/">
                                                            <include name="**/*.jar"/>
                                                        </fileset>

                                                    </classfiles>

                                                    <sourcefiles
                                    encoding="UTF-8">
                                                        <fileset
                                     dir="src/main/java" />
                                                    </sourcefiles>
                                                </structure>
                                                <html destdir="${project.basedir}/target/jacoco/report" />
                                                <xml destfile="${project.basedir}/target/jacoco/report/jacoco.xml"/>
                                            </jacoco-report>
                                        </try>
                                        <catch>
                                            <echo>skipping</echo>
                                        </catch>
                                    </trycatch>
                                </then>
                                <else>
                                    <echo message="No jacoco.exec file found." />
                                </else>
                            </if>
                        </tasks>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:14:07.317

您需要为报告目标提供要分析的库的类。不幸的是，我找不到这方面的文档。[官方文档是……嗯……稀疏](http://www.eclemma.org/jacoco/trunk/doc/maven.html)

如果您可以执行 ant，我建议您查看[报告任务](http://www.eclemma.org/jacoco/trunk/doc/ant.html)。

```
<jacoco:report>

    <executiondata>
        <file file="jacoco.exec"/>
    </executiondata>

    <structure name="Example Project">
        <classfiles>
            <fileset dir="classes"/> <!-- HERE THE CLASSES FROM YOUR LIB -->
        </classfiles>
        <sourcefiles encoding="UTF-8">
            <fileset dir="src"/> <!-- HERE THE SORUCESFROM YOUR LIB -->
        </sourcefiles>
    </structure>

    <html destdir="report"/>

</jacoco:report> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-24T13:47:46.340

尽管这个问题很老，但它似乎仍然相关。如果外部库是 Maven 项目，您可以转到库源目录并从那里请求先前使用您的测试套件获得的 JaCoCo 报告：

```
mvn org.jacoco:jacoco-maven-plugin:0.7.8:report -Djacoco.dataFile=/path/to/jacoco.exec 
```

您在 ${project}/target/site/jacoco 目录中获取报告。

# c++ - 首先插入静态 STL 集会导致未处理的异常 0xC0000005：抛出访问冲突

> ID：10213472
> 
> 赞同：1
> 
> 时间：2012-04-18T16:10:12.830
> 
> 标签：c++, visual-studio-2008, exception, stl, set

所以我在 VS 2008 中使用 C++ 为嵌入式环境（ARM 处理器）工作。我为我的公司建立了一个中型项目。到目前为止，它一直是一个 Windows 应用程序。我被要求将其更改为控制台应用程序，因为这对这个应用程序更有意义。我没有真正的理由让它成为一个 Windows 应用程序......起初，我只是在 VS 中更改了适当的设置（我认为），然后重新构建。它构建得很好，但是每次我尝试运行程序时都会在标题中引用异常。我想强调的是，在我将它切换到控制台应用程序之前，该程序运行良好。我也对整个解决方案进行了全面清理和重建。

我认为这可能只是我手动更改设置的问题，所以我创建了一个新项目，将其设置为控制台应用程序并将所有源/其他相关项目插入其中。一旦我将解决方案中的所有不同项目正确链接在一起，这也可以很好地构建，但是会出现相同的错误。

当程序崩溃时，它会在以下方法中的插入命令处停止：

```
template<class Elem>
Node<Elem>* Node<Elem>::addChild(const Elem& value)
{
    Node<Elem>* newNode = new Node(value);
    newNode->m_pParentNode = this;
    m_childList.push_back(newNode);
    m_sNodeSet.insert(newNode);
    return newNode;
} 
```

m_sNodeSet 用于强制执行树中的每个节点必须是唯一的规则。第一次调用此 addChild 方法时发生错误。此时，m_sNodeSet 的大小为零，需要分配一些内存。但是抛出的异常是访问冲突，而不是预期的 Bad Alloc。我确实尝试在插入语句之前添加一个 m_sNodeSet.get_allocator().allocate(5) 以查看是否会执行任何操作，但会引发相同的异常。m_sNodeSet 是一个静态成员变量，如果有区别的话。

这个 Node 类是我创建的自定义树对象。几个星期以来，我没有在这个树项目中进行任何更改，并且运行良好。我不认为我在这个树项目上扔了任何它以前没有见过并且表现完美的东西，所以我认为问题不在于树项目本身。

我确信这也不是跨库边界访问 STL 容器的问题。此错误发生在单个静态库的操作中。

我觉得我的解决方案中必须有一些设置仍然需要更改才能使其正常工作。解决方案中有几个项目，一个DLL，一个LIB，一个EXE。树是第四个项目，但它只是简单地放入适当项目的“附加包含”中。我只更改了 EXE，以便它可以作为控制台应用程序执行。

如果你们对这里可能出现的问题有任何暗示，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:31:55.340

如果您已声明：

```
// Global scope
// > (quote)The m_sNodeSet is a static member variable,
std::set<Node<Elem>*>   Node<Elem>::m_sNodeSet; 
```

个人注意：前缀`m_`通常是成员变量的捐赠者（不是静态成员）。因此，使用此前缀会使很多人感到困惑。

如果`m_sNodeSet`是静态成员**并且**上面的代码**在 main 之前**运行，那么您可能会遇到初始化顺序问题。这很容易解决（见下文）。否则你有一些内存损坏。

```
class Node
{

    // Remove this line
    // static std::set<Node*>   m_sNodeSet;
    // Replace with this code
    static std::set<Node*>&  getNodeSet()
    {
        static std::set<Node*>   sNodeSet;
        return sNodeSet;
    }
    // Replace all references to m_sNodeSet with getNodeSet()
} 
```

这是有效的，因为在方法内部`getNodeSet()`变量`sNodeSet`是静态的，因此在第一次使用时创建并且在程序的长度内保持活动状态。每个调用都将返回对同一对象的引用。因为它是在第一次调用时创建的，所以在返回使用点时保证它是活动的（并且完全构造）。

# php - 使用 nid 参数在 Drupal 视图中为每个节点加载 Ajax

> ID：10213478
> 
> 赞同：1
> 
> 时间：2012-04-18T16:10:30.500
> 
> 标签：php, jquery, ajax, drupal, view

我对 Drupal 中的预告片有一个看法。每个预告片都有一个 click() 处理程序，该处理程序应该将其节点 ID 作为参数发送以通过 ajax 加载视图。我尝试了 2 种不同的 jquery 方法，但没有运气。

第一个示例仅发送视图中最后一个节点的 nid。因此，无论我单击什么预告片，都只会发送最后一个预告片的 nid。

```
Drupal.behaviors.ajaxview = function(context) {
    $(".ajaxclick").click(function(){
    $(".container").load(Drupal.settings.basePath + "myajax/" + <?php echo $node->nid;?>;);
});
} 
```

在第二种方法中，单击“ajaxview”类按钮将发送正确的nid，但不是仅将单击的按钮发送到其相应的div，而是为每个按钮发送一个带有“ajaxview”类的nid ” 进入带有“容器”类的每个 div。所以我最终得到了从每个预告片生成的每个视图的内容到每个 div 中。太多了！

```
$(document).ready(function() {
$(".ajaxclick").click(function(){
    $(".container").load(Drupal.settings.basePath + "myajax/" +  <?php echo  $node->nid; ?>);

});
}); 
```

这是按钮；

```
<button class="ajaxclick">click</button> 
```

和 div：

```
<div class="container"></div> 
```

知道如何让每次点击都将被点击的预告片的 nid 作为参数发送并仅加载该视图吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T19:32:38.397

你的代码是javascript。你不能使用：

```
<?php echo  $node->nid; ?> 
```

你将不得不使用 jQuery 方法来获得你想要的 nid。例如，如果您在隐藏文件中有 nid，例如：

```
<input type="hidden" id="ID" value="100" /> 
```

您可以使用以下 jQuery 来获取 nid：

```
var nid = $("#ID").val(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-22T08:31:46.520

事实证明，我能够使用 Ionut.A 建议的修订版让它工作；

```
Drupal.behaviors.ajaxview = function(context) {
    $(".ajaxclick").click(function(){
    var nid = $(".mynid").eq($('.ajaxclick').index( $(this) )).val();
    $('.container').eq($('.ajaxclick').index( $(this) )).load(Drupal.settings.basePath + 'myajax/' + nid);
    return false;
});
} 
```

对于 html；

```
<input type="hidden" class="mynid" value=<?php echo $node->nid;?> /> 
```

我不得不使用 class 而不是 id 因为 id 只会从第一个节点返回 id。

# javascript - 如何在 for 循环中维护迭代变量的原始值，该循环设置事件调用，其中迭代值是函数的一部分？

> ID：10213480
> 
> 赞同：0
> 
> 时间：2012-04-18T16:10:32.417
> 
> 标签：javascript, jquery

请帮我解决这个问题：

这组代码中有不确定的迭代次数：

```
var c = 1;
for(c=1; c<x; c++){
    $('#'+l_id+'_'+c).on("keypress", function(f){
        com_guide_add_li((c+1), $(this).parent().parent().attr('id'), f);
    })
} 
```

问题在于，当事件被调用时， (c+1) 是最后一次迭代的值 + 1，而不是在运行此代码时迭代期间某处的值。

如何确保 (c+1) 的原始值保留在函数调用中，即设置事件调用的迭代运行时的值？

谢谢

*对不起，长标题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:14:22.620

我认为这应该可行，早期绑定应该处理它。

```
var c = 1;
for(c=1; c<x; c++){¡   
     var tmp_var = c;        
     $('#'+l_id+'_'+c).on("keypress", function(f){                  
        com_gude_add_li((tmp_var+1), $(this).parent().parent().attr('id'), f);
    })
} 
```

让我知道这是否有帮助。

**选项 2**

由于您使用的是 jquery，因此您可以使用该`data`方法（更多内容请[在此处](http://api.jquery.com/jQuery.data/)阅读）：

```
var c = 1;
    for(c=1; c<x; c++){¡   
        $('#'+l_id+'_'+c).data("c", c);
        $('#'+l_id+'_'+c).on("keypress", function(f){            
            com_gude_add_li(($(this).data("c") + 1), $(this).parent().parent().attr('id'), f);
        })
    } 
```

# asp.net - IIS 6.1 Server 2003 Web 应用程序有时在重新启动时不启动

> ID：10213481
> 
> 赞同：1
> 
> 时间：2012-04-18T16:10:33.197
> 
> 标签：asp.net, windows, iis, asp-classic

有时，当我在客户端站点重新启动其中一台服务器时，在 IIS 中运行的 Web 应用程序不会在服务器完成重新启动后自动启动备份。IIS 服务启动得很好，它设置为自动启动，并且事件日志中没有错误。只是没有一个 Web 应用程序正在运行，我必须单击每个应用程序并单击开始。这只是偶尔发生，因为它们通常开始但完全令人困惑。

有什么想法吗？它是经典 ASP 和 ASP.NET 应用程序的混合体。在大约 8 个 Web 应用程序之间总共运行 4 个应用程序池。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:30:50.763

当应用程序依赖服务器尚不可用的资源（例如网络共享）时，我已经看到这种情况发生。

有些人通过编写一个 Windows 服务来解决这个问题，该服务的工作是检查这些条件并启动应用程序。

# grails - 在这种情况下如何删除关系？

> ID：10213482
> 
> 赞同：0
> 
> 时间：2012-04-18T16:10:33.563
> 
> 标签：grails

我有`User`课：

```
class User {
       static hasMany = [ project: Project ]
} 
```

和`Project`：

```
class Project {
     static hasMany = [ users : User ]
     static belongsTo = User
} 
```

在我的代码中的任何地方我都可以这样做：

```
user.project 
```

将返回类似：

```
[project name] 
```

我需要一种方法来*删除*任何`User`. 我怎样才能做到这一点？我可以找到`user` `project`使用动态查找器、条件查询等，但如何从`user`实例中删除该关系？

对 Grails 来说非常新。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:24:47.547

使用[`removeFrom`](http://grails.org/doc/latest/ref/Domain%20Classes/removeFrom.html). 例子：

```
user.removeFromProject(project) 
```

在多对多关系中，您应该从拥有方管理关联：作为`belongsTo`.

请注意，将项目关联命名为“项目”而不是“项目”可能更清楚，因为它是多对多关系。

# java - 将 Oracle Timestamp 数据类型字符串转换为 Java 日期

> ID：10213486
> 
> 赞同：3
> 
> 时间：2012-04-18T16:10:50.147
> 
> 标签：java, oracle, date

我在 Java 字符串中有一个 Oracle 的时间戳字段

字符串 strDate = "24.12.12 03:30:00,000"; //Oracle的时间戳字段

我需要将其转换为 Java.util.Date。

请告诉我一种方法来做到这一点。

**注意：我没有年份的前两位数字，java怎么能理解这是1912年或2012年等等。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:23:55.103

您想要的课程是[SimpleDateFormat](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)。您将创建一个与预期输入匹配的模式，并对其进行解析。这是一个示例，尽管在某些地方可能不正确（我使用了 0-23 小时，也许您想要 1-24 等）

```
String strDate = "24.12.12 03:30:00,000";
SimpleDateFormat sdf = new SimpleDateFormat("dd.MM.yy HH:mm:ss,SSS");
Date date = sdf.parse(strDate); 
```

关于您的 1912 与 2012 问题，Java 会在只有 2 位数字时做出一些假设。具体来说：

> 对于使用缩写年份模式（“y”或“yy”）进行解析，SimpleDateFormat 必须解释相对于某个世纪的缩写年份。它通过将日期调整为创建 SimpleDateFormat 实例之前的 80 年和之后的 20 年来实现这一点。

# android - 如何在 WebView 中获取 POST 请求的 JSON 响应？

> ID：10213487
> 
> 赞同：17
> 
> 时间：2012-04-18T16:10:56.490
> 
> 标签：android, json, post, android-webview

我有一个`WebView`包含表单（帖子）的带有 html 的内容。单击某个提交按钮时，我得到一个 JSON 响应。

我怎样才能得到这个 JSON？

如果我不拦截请求，则 json 会显示在 webview 上，所以我想我应该使用`shouldInterceptRequest`（我正在使用 API 12），但我不知道如何在其中获取 json。

或者也许有更好的方法，比如拦截响应而不是请求？

```
mWebView.loadUrl(myURL);  

isPageLoaded = false; // used because the url is the same for the response

mWebView.setWebViewClient(new WebViewClient() {
    @Override
    public WebResourceResponse shouldInterceptRequest (WebView view, String url) {

        if(isPageLoaded){
            // get the json
            return null;
        }
        else return super.shouldInterceptRequest(view, url);
    }

    public void onPageFinished(WebView view, String url) {
        isPageLoaded = true;
    }
}); 
```

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-22T14:25:16.633

你应该重写的`shouldOverrideUrlLoading`方法`WebViewClient`

```
@Override
public boolean shouldOverrideUrlLoading (WebView view, String url) {

    if(flag) { 

            URL aURL = new URL(url); 
            URLConnection conn = aURL.openConnection(); 
            conn.connect(); 
            InputStream is = conn.getInputStream(); 
            // read inputstream to get the json..
            ...
            ...
            return true;
    }

    return false
}

@override
public void onPageFinished (WebView view, String url) {
    if (url contains "form.html") {
        flag = true;
    }
} 
```

另请查看[如何从 WebView 获取网页内容？](https://stackoverflow.com/questions/2376471/how-do-i-get-the-web-page-contents-from-a-webview)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-01-17T07:08:06.350

这是我如何实现这一点的，因为提到的方法开始抱怨 UI 线程网络连接。

**使用 ChromeWebView 客户端和控制台记录输出**

```
 public void OnSignUp_Click(View v) {
    WebView mWebview = new WebView(this);

    mWebview.getSettings().setJavaScriptEnabled(true); // enable javascript

    final Activity activity = this;

    mWebview.setWebChromeClient(new WebChromeClient() {
        public boolean onConsoleMessage(ConsoleMessage cmsg)
        {

                /* process JSON */
            cmsg.message();
            return true;

        }
    });

    mWebview.setWebViewClient(new WebViewClient() {

        public void onReceivedError(WebView view, int errorCode,
                String description, String failingUrl) {
            Log.e("Load Signup page", description);
            Toast.makeText(
                    activity,
                    "Problem loading. Make sure internet connection is available.",
                    Toast.LENGTH_SHORT).show();
        }

        @Override
        public void onPageFinished(WebView view, String url) {
            view.loadUrl("javascript:console.log(document.body.getElementsByTagName('pre')[0].innerHTML);");
        }
    });

    mWebview.loadUrl("https://yourapp.com/json");

} 
```

希望它可以帮助别人。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T16:23:25.327

> 嗯，简短的回答是它的工作方式与 shouldOverrideUrlLoading(WebView view, String url) 非常相似，如 WebView 教程中所示。
> 
> 为了让您开始，请参阅下面的代码。您只需覆盖 WebViewClient 的 shouldInterceptRequest(WebView view, String url) 方法。显然，您不必内联执行此操作，但为了紧凑起见，这就是我所做的：

看看[这个](https://stackoverflow.com/questions/8273991/webview-shouldinterceptrequest-example)。

# oracle - ORA-00947 全局声明类型时值不足

> ID：10213489
> 
> 赞同：17
> 
> 时间：2012-04-18T16:11:02.993
> 
> 标签：oracle, plsql, oracle11g, ora-00947

```
 create table foo(
   id number,
   status varchar2(10)
 ); 
```

表已创建。

```
insert into foo values( 1, 'open' );
insert into foo values( 2, 'close' );
insert into foo values( 3, 'open' );
insert into foo values( 4, 'open' );
insert into foo values( 5, 'close' );

create type foo_obj is object (
      id number,
      status varchar2(10)
    );
   /

 create type foo_nt
     as table of foo_obj;
  /

 create or replace package test_bulk
 is 

 procedure temp;

 end;
 /

 create or replace package body test_bulk
 is 

 procedure  temp
   is 
   v_nt  foo_nt;
   begin
     select id ,status 
     bulk collect into v_nt
     from foo;

   end temp;

   end test_bulk; 
```

这是一个非常奇怪的情况，当我全局创建一个类型对象和该类型的嵌套表并创建一个嵌套表类型的变量并将批量收集到该变量中时，我得到

> ORA-00947: 值不足错误

但是，当我声明一个记录类型和该记录类型的嵌套表，然后是嵌套表的变量包里面，那么上面的批量收集工作，它不会抛出错误

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-18T16:21:23.580

您不能只将值放入对象表中 - 您需要将值转换为适当类型的对象，然后插入对象。尝试

```
procedure temp is
  v_nt  foo_nt;
begin
  select FOO_OBJ(id ,status)
    bulk collect into v_nt
    from foo;
end temp; 
```

未在动物身上进行测试 - 你会是第一个！

分享和享受。

# java - 如何对彼此相关的两个数组进行排序？

> ID：10213493
> 
> 赞同：2
> 
> 时间：2012-04-18T16:11:10.877
> 
> 标签：java, arrays, sorting

我在 python 中进行原型制作，并且为此使用了 zip 函数，我不确定如何在 Java 中执行此操作。基本上我有两个列表（一个是`names`，一个是`data`），并希望它们相互排序。我的程序只处理一个列表（`data`在本例中为 ），但我将`names`用作我正在处理的内容的参考，`data`并且我想尝试以不同的顺序处理我的数据。这是结构的一个示例（实际上，我的数据并没有存储给我，但我会对其进行基本排序或反向排序，没什么特别的）。

```
String[] names = new String[]{"Monkey1", "Dog2", "Horse3", "Cow4", "Spider5"};
int[] data = new int[]{1, 2, 3, 4, 5}; 
```

所以倒数是

```
name = Spider5, Cow4, Horse3, Dog2, Monkey1
data = 5, 4, 3, 2, 1 
```

我发现了这个问题：[是否有一个公认的 Java 等效于 Python 的 zip()](https://stackoverflow.com/questions/2118932/is-there-an-accepted-java-equivalent-to-pythons-zip)，但我宁愿（如果可能的话，并且对于胆小的人）使用我已经拥有的库（Java commons、apache commons 等）来执行此操作。如果没有其他办法，那我就`functional java`试一试。有什么建议么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-01T13:28:58.607

如果你真的不想重做你的数据结构来组合信息，你可以使用 Multimap 来做到这一点。

这个例子利用了优秀的 Google-Guava 库，无论如何你都应该使用它 :) [https://code.google.com/p/guava-libraries/](https://code.google.com/p/guava-libraries/)

```
String[] names = new String[] {"Monkey1", "Dog2", "Horse3", "Cow4", "Spider5"};
int[] data = new int[] {1,2,3,4,5};

/* guava, throws an IllegalStateException if your array aren't of the same length */
Preconditions.checkState(names.length == data.length, "data and names must be of equal length");

/* put your values in a MultiMap */
Multimap<String, Integer> multiMap = LinkedListMultimap.create();
for (int i=0; i<names.length; i++) {
    mmap.put(names[i], data[i]);
}

/* our output, 'newArrayList()' is just a guava convenience function */
List<String> sortedNames = Lists.newArrayList();
List<Integer> sortedData = Lists.newArrayList();

/* cycle through a sorted copy of the MultiMap's keys... */
for (String name : Ordering.natural().sortedCopy(mmap.keys())) {

    /* ...and add all of the associated values to the lists */
    for (Integer value : mmap.get(name)) {
        sortedNames.add(name);
        sortedData.add(value);
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T16:33:13.250

这是完整的代码：

StringIntTuple.java：

```
public class StringIntTuple{
    public final int intValue;
    public final String stringValue;
    public StringIntTuple(int intValue, String stringValue){
        this.intValue = intValue;
        this.stringValue = stringValue;
    }
    public String toString(){
        return "(" + this.intValue + ", " + this.stringValue + ")";
    }

} 
```

StringIntTupleStringComparator.java：

```
import java.util.Comparator;

public class StringIntTupleStringComparator implements
        Comparator<StringIntTuple> {

    @Override
    public int compare(StringIntTuple a, StringIntTuple b) {
        // TODO Auto-generated method stub
        return a.stringValue.compareTo(b.stringValue);
    }

} 
```

StringIntTupleIntComparator.java：

```
import java.util.Comparator;

public class StringIntTupleIntComparator implements Comparator<StringIntTuple> {

    @Override
    public int compare(StringIntTuple a,
            StringIntTuple b) {
        return ((Integer)a.intValue).compareTo((Integer)b.intValue);
    }

} 
```

驱动程序.java：

```
import java.util.ArrayList;
import java.util.Collections;

public class Driver {

    /**
     * @param args
     */
    public static String[] names = new String[] {"Monkey1", "Dog2", "Horse3", "Cow4", "Spider5"};
    public static int[] data = new int[] {1,2,3,4,5};
    public static void main(String[] args) {
        ArrayList<StringIntTuple> list = new ArrayList<StringIntTuple>();
        for(int i =0; i<names.length; i++){
            list.add(new StringIntTuple(data[i],names[i]));
        }
        Collections.sort(list, new StringIntTupleIntComparator());
        System.out.println(list.toString());
        Collections.sort(list, new StringIntTupleStringComparator());
        System.out.println(list.toString());
    }

} 
```

输出（首先按 int 字段排序，然后按 String 字段排序）：

[(1, Monkey1), (2, Dog2), (3, Horse3), (4, Cow4), (5, Spider5)]

[(4, Cow4), (2, Dog2), (3, Horse3), (1, Monkey1), (5, Spider5)]

编辑1（额外信息）：

如果你想让它适用于任何元组，即不将字段类型限制为 int、String，你可以简单地使用泛型执行相同的操作，即：

```
public class Tuple<A,B>{
    public Tuple(A aValue, B bValue){
        this.aValue = aValue;
        this.bValue = bValue;
    }
    public final A aValue;
    public final B bValue;

} 
```

然后，只需相应地调整比较器，您就有了一个通用的解决方案。编辑2（午餐后）：在这里。

```
public class TupleAComparator<A extends Comparable<A>,B extends Comparable<B>> implements Comparator<Tuple<A,B>> {

    @Override
    public int compare(Tuple<A, B> t1, Tuple<A, B> t2) {
        return t1.aValue.compareTo(t2.aValue);
    }

} 
```

编辑 3：代码补充作为对评论 #1 的回答（增加评论 #2）TupleArrayList.java：

```
import java.util.ArrayList;
import java.util.List;

public class TupleArrayList<A,B> extends ArrayList<Tuple<A,B>> {

    /**
     * An ArrayList for tuples that can generate a List of tuples' elements from a specific position within each tuple
     */
    private static final long serialVersionUID = -6931669375802967253L;

    public List<A> GetAValues(){
        ArrayList<A> aArr = new ArrayList<A>(this.size());
        for(Tuple<A,B> tuple : this){
            aArr.add(tuple.aValue);
        }
        return aArr;
    }

    public List<B> GetBValues(){
        ArrayList<B> bArr = new ArrayList<B>(this.size());
        for(Tuple<A,B> tuple : this){
            bArr.add(tuple.bValue);
        }
        return bArr;
    }

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T16:12:41.950

在 Java 中执行此操作的“正确”方法是创建一个包含相应元素的组合对象，并对其进行排序。

例子：

```
class NameAndData {
  private final String name;
  private final int data;
}

List<NameAndData> toBeSorted; 
```

然后你创建一个组合元素的列表并对其进行排序。基本上，您正在编写自己的特定`Pair`课程。（我和许多 Java 开发人员认为，`Pair`在 Java 中添加一个类只会导致代码更加模糊——`LatLong`例如，一个类比`Pair<Double, Double>`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-18T16:14:54.287

所以这里显而易见的答案是将`name`and`data`值包装在一个类中。然后维护该类的列表。该类应该实现`equals`，`hashCode`然后`Comparable`允许使用 对列表进行排序`Collections.sort`。

在两个不同的列表中维护相关数据是反 OOP 的。

像这样的东西。

```
class MyWrapper implements Comparable<MyWrapper>{
   private String name;
   private int data;
}

List<MyWrapper> listToBeSorted; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-07-11T01:01:29.397

在某些情况下，创建一个新类只是为了进行并发排序没有多大意义。

这里，是一个函数，可用于`List`根据实现的键对任意类型的任意数量的 s进行排序`Comparable`（[**此处为 Ideone 示例**](https://ideone.com/bU6lAv)）。

* * *

## 用法

以下是如何使用该函数对任意类型的多个列表进行排序的示例：

```
// Can be any type that implements Comparable, Dupes are allowed
List<Integer> key = Arrays.asList(4, 3, 1, 2, 1);

// List Types do not need to be the same
List<String> list1 = Arrays.asList("Four", "Three", "One", "Two", "One");
List<Character> list2 = Arrays.asList('d', 'c', 'a', 'b', 'a');

// Sorts key, list1, list2
// Remove second key if you don't want to sort key.
multiSort(key, key, list1, list2); 
```

**输出：**

```
key:   [1, 1, 2, 3, 4]
list1: [One, One, Two, Three, Four]
list2: [a, a, b, c, d] 
```

* * *

## 代码

可以在[**此处**](https://ideone.com/bU6lAv)找到一个 Ideone 示例，其中包括参数验证和测试用例。

```
public static <T extends Comparable<T>> void multiSort(
    final List<T> key, List<?>... lists){
  // Create a List of indices
  List<Integer> indices = new ArrayList<Integer>();
  for(int i = 0; i < key.size(); i++) {
    indices.add(i);
  }

  // Sort the indices list based on the key
  Collections.sort(indices, new Comparator<Integer>() {
    @Override public int compare(Integer i, Integer j) {
      return key.get(i).compareTo(key.get(j));
    }
  });

  // Create a mapping that allows sorting of the List by N swaps.
  // Only swaps can be used since we do not know the type of the lists
  Map<Integer,Integer> swapMap = new HashMap<Integer, Integer>(indices.size());
  List<Integer> swapFrom = new ArrayList<Integer>(indices.size()),
                swapTo   = new ArrayList<Integer>(indices.size());
  for (int i = 0; i < key.size(); i++) {
    int k = indices.get(i);
    while (i != k && swapMap.containsKey(k)) {
      k = swapMap.get(k);
    }

      swapFrom.add(i);
      swapTo.add(k);
      swapMap.put(i, k);
  }

  // use the swap order to sort each list by swapping elements
  for (List<?> list : lists)
    for (int i = 0; i < list.size(); i++)
      Collections.swap(list, swapFrom.get(i), swapTo.get(i));
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-18T16:26:41.287

您可以使用 a[`ConcurrentSkipListMap`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)它可以在键上提供正向和反向迭代器。如果您正在寻找除了固定的正向和反向排序之外的任意重新排序，您将不得不去其他地方。或者您可以始终保持一个简单的或任何`HashMap`东西来维护并行项目关联，然后通过提供适当的.`SortedMap``Treemap``ConcurrentSkipListMap``Comparator`

这种方法的缺点是键/值之间的关联更加短暂，并且更容易被地图更新意外破坏。创建元组、对或其他明确的 1-1 关系的所有其他答案都可以更好地解决这个问题。当然，如果您打算让关联更加流畅，那么仅使用地图会增加一点优势。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-01T00:16:27.200

假设这两个数组的长度相同，您可以创建*一个映射条目列表，*其中包含这些数组中的元素对，并按逆序对该列表进行排序*，*如下所示：

```
String[] names = new String[]{"Monkey1", "Dog2", "Horse3", "Cow4", "Spider5"};
int[] data = new int[]{1, 2, 3, 4, 5};

List<Map.Entry<Integer, String>> entryList = IntStream
        .range(0, names.length)
        .mapToObj(i -> Map.entry(data[i], names[i]))
        .sorted(Map.Entry.<Integer, String>comparingByKey().reversed())
        .collect(Collectors.toList());

System.out.println(entryList);
// [5=Spider5, 4=Cow4, 3=Horse3, 2=Dog2, 1=Monkey1] 
```

如果要替换数组的内容：

```
IntStream.range(0, entryList.size()).forEach(i -> {
    data[i] = entryList.get(i).getKey();
    names[i] = entryList.get(i).getValue();
});

System.out.println(Arrays.toString(data));
// [5, 4, 3, 2, 1]
System.out.println(Arrays.toString(names));
// [Spider5, Cow4, Horse3, Dog2, Monkey1] 
```

* * *

^(另请参阅：[对两个并行数组进行排序](https://stackoverflow.com/a/66155019/14940971))

# mercurial - 在 mercurial 中合并两个负责人的自动评论列表变更集 ids/guid

> ID：10213495
> 
> 赞同：1
> 
> 时间：2012-04-18T16:11:11.247
> 
> 标签：mercurial, merge, automation

我不再使用[`hg fetch`](https://stackoverflow.com/questions/5215445/how-to-auto-merge-2-heads-with-mercurial)在 Mercurial 存储库的另一个头中拉取和合并，因为我喜欢让提交消息说明什么与什么合并。此外，我正在从“merge repo1 -> repo2”转向更具体的“merge head1guid -> head2guid”格式。

我怎样才能自动化这个，所以我不必列出头，`hg heads`然后将两个变更集的 guid 复制并粘贴到我的提交消息中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:41:51.037

正如其他人在评论中指出的那样，变更集的一两个父项已经存储在变更集中并显示在`hg log`其他命令行视图中——最好不要重新存储它们。

如果你**真的**想要你可以这样做：

```
hg commit -m "merging $(hg log -r . --template '{parents}')" 
```

但我总是尝试在信息中加入一些真正有用的东西，比如“将 Jim 在 foo 上的工作合并到 Alice 在 bar 上的工作”；重新存储父母的节点ID没有新信息。

请注意，该命令仅在您提交合并时才有效——否则它将为空。

# node.js - 在 Node.js 中的两个不同进程之间进行通信

> ID：10213501
> 
> 赞同：49
> 
> 时间：2012-04-18T16:11:24.803
> 
> 标签：node.js, process

### 问题是：

*   假设我们有两个 Node.js 进程正在运行：`example1.js`和`example2.js`.

*   其中`example1.js`有作为结果`func1(input)`返回的函数。`result1`

*   有没有办法从内部`example2.js`调用`func1(input)`并获得`result1`结果？

根据我对 Node.js 的了解，我只找到了一种使用套接字进行通信的解决方案。然而，这不太理想，因为它需要一个进程监听端口。如果可能的话，我希望避免这种情况。

* * *

*编辑：* 在一些问题之后，我想补充一点，层次结构`example1.js`中不能是 的子进程`example2.js`，而是相反。此外，如果它有帮助 - 只能有一个`example1.js`处理自己的数据，而许多`example2.js`人处理自己的数据+来自第一个进程的数据。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-18T16:26:34.660

您描述的用例让我想到了[dnode](https://github.com/substack/dnode)，您可以使用它轻松公开要由不同进程调用的函数，由 dnode 协调，它使用网络套接字（和 socket.io，因此您可以在浏览器中使用相同的机制） .

另一种方法是使用消息队列，对于不同的消息队列有[很多很好的绑定](https://github.com/joyent/node/wiki/modules#wiki-message-queue)。

据我所知，最简单的方法是使用[child_process.fork()](http://nodejs.org/api/child_process.html#child_process_child_process_fork_modulepath_args_options)：

> `spawn()`这是生成节点进程的功能的一个特例。除了在普通 ChildProcess 实例中包含所有方法外，返回的对象还内置了一个通信通道。通道被写入 with`child.send(message, [sendHandle])`并且消息由`'message'`孩子上的事件接收。

因此，对于您的示例，您可以使用 example2.js：

```
var fork = require('child_process').fork;
var example1 = fork(__dirname + '/example1.js');

example1.on('message', function(response) {
  console.log(response);
});

example1.send({func: 'input'}); 
```

和example1.js：

```
function func(input) {
  process.send('Hello ' + input);
}

process.on('message', function(m) {
  func(m);
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-23T05:38:49.013

也许您应该尝试[Messenger.js](https://github.com/weixiyen/messenger.js)。它可以方便地进行IPC。

您不必自己进行两个进程之间的通信。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-09-13T02:52:33.113

使用 Redis 作为消息总线/代理。

[https://redis.io/topics/pubsub](https://redis.io/topics/pubsub)

您还可以使用像 ZeroMQ 这样的套接字消息传递，它是点对点/对等的，而不是使用像 Redis 这样的消息代理。

这是如何运作的？

使用 Redis，在您的两个节点应用程序中，您都有两个 Redis 客户端执行发布/订阅。所以每个 node.js 应用程序都会有一个发布者和订阅者客户端（是的，对于 Redis 发布/订阅，每个节点进程需要 2 个客户端）

使用 ZeroMQ，您可以通过 IPC 通道直接在 node.js 进程之间发送消息（不涉及代理 - 可能除了操作系统本身......）。

# python - Heroku 上的 Python、PIL 和 JPEG

> ID：10213509
> 
> 赞同：14
> 
> 时间：2012-04-18T16:12:03.280
> 
> 标签：python, heroku, python-imaging-library, virtualenv, libjpeg

我有一个**Django**站点，托管在**Heroku**上。其中一个模型有一个图像字段，用于获取上传的图像、调整它们的大小并将它们推送到 Amazon S3，以便它们可以持久存储。

这很好用，使用**PIL**

```
def save(self, *args, **kwargs):

    # Save this one
    super(Product, self).save(*args,**kwargs)

    # resize on file system
    size = 200, 200
    filename = str(self.thumbnail.path)
    image = Image.open(filename)
    image.thumbnail(size, Image.ANTIALIAS)
    image.save(filename)

    # send to amazon and remove from ephemeral file system
    if put_s3(filename):
        os.remove(filename)
        return True 
```

但是，PIL 似乎适用于 PNG 和 GIF，但未与**libjpeg**兼容。在本地开发环境或完全受控的 'nix 服务器上，只需安装 jpeg 扩展即可。

但是有谁知道是否可以使用 Cedar Heroku 堆栈进行 Jpeg 操作？还有什么可以添加到 requirements.txt 的吗？

在其他不相关的包中，这个 virtualenv 的 requirements.txt 包括：

```
Django==1.3.1
PIL==1.1.7
distribute==0.6.24
django-queued-storage==0.5
django-storages==1.1.4
psycopg2==2.4.4
python-dateutil==1.5
wsgiref==0.1.2 
```

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-04-22T12:31:49.340

我在 requirements.txt 中使用了这个 PIL 分支：

```
-e hg+https://bitbucket.org/etienned/pil-2009-raclette/#egg=PIL 
```

并且可以毫无问题地使用JPEG：

```
 --------------------------------------------------------------------
       PIL 1.2a0 SETUP SUMMARY
       --------------------------------------------------------------------
       version       1.2a0
       platform      Python 2.7.2 (default, Oct 31 2011, 16:22:04)
                     [GCC 4.4.3] on linux2
       --------------------------------------------------------------------
       *** TKINTER support not available
       --- JPEG support available
       *** WEBP support not available
       --- ZLIB (PNG/ZIP) support available
       --- FREETYPE2 support available
       --- LITTLECMS support available
       -------------------------------------------------------------------- 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-06-10T22:45:11.980

还请考虑使用[Pillow](https://pypi.python.org/pypi/Pillow)，这是一个“友好的” PIL 叉子，它提供：

*   设置工具兼容性
*   Python 3 兼容性
*   频繁的发布周期
*   许多错误修复

# plone - 描述字段后的克隆敏捷注入行为字段

> ID：10213510
> 
> 赞同：3
> 
> 时间：2012-04-18T16:12:05.550
> 
> 标签：plone, dexterity, plone-4.x

我试图在内容类型拥有字段（非基于行为的字段）之前，在描述之后直接从行为中注入一个字段。

```
form.order_after(myfield = 'IBasic.description') 
```

不起作用 - 该字段仍然显示在非行为字段之后。

```
form.order_before(myfield = '*') 
```

工作，但当然把该领域完全放在首位。

```
form.order_before(myfield = '*')
form.order_after(myfield = 'IBasic.description') 
```

该领域仍然在顶部。

我错过了什么？

```
form.order_before(myfield = 'first_field_from_ctype') 
```

有效，但在事物的本质上，内容类型具有不同的字段。

plone.app.dexterity-1.2.1

plone.dexterity-1.1.2

克隆 4.2b2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-17T15:40:04.243

该`description`字段在`IDublinCore`行为中，因此正确的代码是：

```
form.order_after(myfield = 'IDublinCore.description') 
```

# sql - 排序生成中的 SQL 语法问题

> ID：10213516
> 
> 赞同：0
> 
> 时间：2012-04-18T16:12:25.257
> 
> 标签：sql, entity-framework, stored-procedures

我目前正在开展一个项目，该项目涉及使用实体框架中的存储过程生成序列。[我在这里](http://www.codeproject.com/Articles/33274/Flexible-numbering-sequences-in-T-SQL)使用 Code Project 文章，在尝试生成以下存储过程时，我收到了一个语法错误：

```
SET QUOTED_IDENTIFIER OFF

GO 
SET ANSI_NULLS OFF
GO 

CREATE PROCEDURE DBO.p_GetNextInSequence 
    @SequenceKey VARCHAR(20)
AS 
BEGIN 
SET NOCOUNT ON 
DECLARE @LASTNUMBER INT
DECLARE @NEXTNUMBER INT
DECLARE @FORMATTEDNUMBER VARCHAR(40)
DECLARE @MYKEY VARCHAR(30)

IF NOT EXISTS(SELECT 'X' 
              FROM SequenceControl 
              WHERE SequenceControl.SequenceKey = @SequenceKey )
BEGIN 
    SELECT    @SequenceKey AS SequenceKey, 
              CAST('' AS VARCHAR(30)) AS NextSequenceFormatted, 
              CAST(0 AS INT) AS NextSequenceInt 
    RETURN 
END 

DECLARE @SEQFORMAT VARCHAR(30), @IncrementBy INT, 
                   @IncrementStep INT, @zeropadtodigits INT

SELECT @SEQFORMAT = RTRIM(LTRIM(SequenceFormat)),
       @IncrementBy = IncrementBy, 
       @zeropadtodigits = ZeroPadToDigits 
FROM    SequenceControl 
WHERE    SequenceControl.SequenceKey = @SequenceKey 

DECLARE @THEROWCOUNT INT 
SET @THEROWCOUNT    = 0 

BEGIN TRANSACTION T1
    WHILE ( @THEROWCOUNT =0 ) 
    BEGIN 
        SELECT   @LASTNUMBER= LastSequence 
        FROM     SequenceControl
        WHERE    SequenceControl.SequenceKey= @SequenceKey 

        UPDATE     SequenceControl 
        SET        LastSequence = @LASTNUMBER + @IncrementBy 
        WHERE      SequenceKey = @SequenceKey AND    
                   LastSequence = @LASTNUMBER 

        SELECT @THEROWCOUNT = @@ROWCOUNT
    END 
COMMIT TRANSACTION T1 

--SQL Complains near this region...
DECLARE @FMTNUM VARCHAR(20) 
SET @NEXTNUMBER = @LASTNUMBER + @IncrementBy 
IF ( @zeropadtodigits>0) 
    SET @FMTNUM = ( REPLICATE('0', @zeropadtodigits) + 
                    CAST(@NEXTNUMBER AS VARCHAR(20)), @zeropadtodigits) 
ELSE 
    SET @FMTNUM = CAST(@NEXTNUMBER AS VARCHAR(10)) 

SET @FORMATTEDNUMBER = REPLACE(@SEQFORMAT,'[#]', @FMTNUM ) 

SELECT    @SequenceKey AS SequenceKey, 
          CAST(@FORMATTEDNUMBER AS VARCHAR(30)) AS NextSequenceFormatted, 
          @NEXTNUMBER AS NextSequenceInt 
END 

GO 
SET QUOTED_IDENTIFIER OFF
GO 
SET ANSI_NULLS ON    
GO 
```

`','`SQL在第 56 行附近抱怨语法不正确：

```
DECLARE @FMTNUM VARCHAR(20) 
```

但是 - 我似乎无法弄清楚导致问题的原因或原因。此外，如果有人对在实体框架中使用存储过程（*并返回输出*）有任何建议或文章，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:17:14.973

实际错误在这里：

```
IF ( @zeropadtodigits>0) 
    SET @FMTNUM = ( REPLICATE('0', @zeropadtodigits) + 
                    CAST(@NEXTNUMBER AS VARCHAR(20)), @zeropadtodigits) 
```

更具体地说，在这里：

`, @zeropadtodigits)`

那个逗号没有任何作用，`@zeropadtodigits`也不适用于任何东西。括号内没有使用它作为参数的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:24:29.960

语法实际上在以下位置爆炸：

```
SET @FMTNUM = ( REPLICATE('0', @zeropadtodigits) + 
                CAST(@NEXTNUMBER AS VARCHAR(20)), @zeropadtodigits) 
```

为什么它在另一条线抱怨，我不知道。

# selection - 选择 Photoshop 对象（图层）的最快方法是什么？

> ID：10213524
> 
> 赞同：0
> 
> 时间：2012-04-18T16:12:39.857
> 
> 标签：selection, photoshop, layer

当您在 .ps 文件中有一些简单的图层时，您可以使用 Ctrl + 单击来选择其中一个。

当有很多叠瓦组并且您需要获取组层次结构中最低级别的层时怎么办？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T14:15:48.660

您只需使用移动工具并从工具栏中选择自动选择。您可以选择选择组或图层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-02T16:11:46.017

您也可以在要选择的对象上方的画布上单击鼠标右键；将弹出一个包含光标下图层的列表，您可以单击图层名称（这就是为什么命名图层总是好的原因）

# javascript - javascript计算不计算

> ID：10213528
> 
> 赞同：0
> 
> 时间：2012-04-18T16:12:45.807
> 
> 标签：javascript, jquery

基本上，我需要修复这个脚本，我试图修复它，但它返回 -1 天。您可以在此处查看新脚本 -

```
function calculatePrice(startDate, endDate, bike) {                           
    if(cars != "no") {
      console.log(startDate);
      console.log(endDate);
      var currentSeason = getSeason(startDate);
      var totalPrice = 0;
      var daysInSeason = 0;
      var currentDate = startDate;         
      var tierss = "";     
      var now = startDate;           
      var daye = 0;
      while(now <= endDate) {
        var season = getSeason(currentDate);
        daye++;
        now.setDate(now.getDate() + 1);    
      }
      if(daye <= 3) tierss = "t1";
      else if (daye <= 8) tierss = "t2";
      else tierss = "t3"                                    
      while (currentDate <= endDate) {                     
          var season = getSeason(currentDate);
          if (season != currentSeason) {
              totalPrice += getPrice(bike, currentSeason, daysInSeason, tierss);
              currentSeason = season;
              daysInSeason = 0;
          }
          daysInSeason++;
          console.log('days in season - ' + daysInSeason);
          currentDate.setDate(currentDate.getDate() + 1);
      }                                                
      totalPrice += getPrice(bike, currentSeason, daysInSeason, tierss);
      return totalPrice;
    }
    else {
      totalPrice = 0;
      return totalPrice;
    }
} 
```

返回-1，这是返回一切正常的脚本-

```
function calculatePrice(startDate, endDate, bike) {                           
  if(cars != "no") {
    console.log(startDate);
    console.log(endDate);
    var currentSeason = getSeason(startDate);
    var totalPrice = 0;
    var daysInSeason = 0;
    var currentDate = startDate;
    while (currentDate <= endDate) {
        var season = getSeason(currentDate);
        if (season != currentSeason) {
            totalPrice += getPrice(bike, currentSeason, daysInSeason);
            currentSeason = season;
            daysInSeason = 0;
        }
        daysInSeason++;
        currentDate.setDate(currentDate.getDate() + 1);
    }
    totalPrice += getPrice(bike, currentSeason, daysInSeason);
    return totalPrice;
  }
  else {
    totalPrice = 0;
    return totalPrice;
  }
} 
```

为什么我需要编辑脚本？简单地说，因为它返回当前季节的天数，但我需要在 totalPrice 中包含当前季节的总天数和天数。或者另一种可能性是我需要在 getprice 中包含该层，如上所示，两者都应该工作。

希望听到帮助:)！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:25:52.727

如果“now”和“startDate”是对象，那么每次调用

now.setDate(某事)

您还更改了 startDate... 因为 now 和 startDate 是指向同一个对象的指针。

我不确定这是否会导致您的错误，因为我看不到您在哪里使用 startDate ...但它可能会在调用者中更改它，例如。

编辑：是的，这是你的问题，currentDate、now 和 startDate 都指向同一个日期对象——所以你的第二个 while 循环永远不会执行。

# javascript - javascript - showModalDialog 未在 Chrome 中返回值

> ID：10213530
> 
> 赞同：18
> 
> 时间：2012-04-18T16:12:52.560
> 
> 标签：javascript, return-value, showmodaldialog

我用 Javascript 制作了一个小的日历弹出窗口。很简单，使用 ASP.NET 中的 Calendar 控件。我用 showModalDialog 调用弹出窗口。在模态窗口中，更改日历的当前月份会因为回发而出现问题，我在几个地方发现了解决方案是：

```
<base target="_self"/> 
```

在 aspx 文件的头部。一切都很好......除了一件事，而且只在谷歌浏览器中。为了取回选定的日期，我将弹出窗口的 returnValue 设置为日历中选定的日期。在 IE 和 Firefox 中，它始终有效。但是，在 Chrome 中，它仅在我不更改日历中的当前月份时才有效。一旦我更改它，返回值就不会传回给 showModalDialog 的调用者。就好像模态窗口不再是原来的窗口了；返回值未定义。

有没有人经历过这种行为并有建议让它发挥作用？我尝试使用 dialogArguments 来跟踪调用者窗口，但它只传递到第一个模式窗口（更改当前月份后它会丢失）。

调用过程中的代码：

```
var d = window.showModalDialog(...) 
```

模态窗口中的代码：

```
window.returnValue = selectedDate; 
self.close(); 
```

正如我对 Teemu 所说， selectedDate 和 window.returnValue 总是正确的。但是，在 Google Chrome 的情况下（在日历中更改一个月后），showModalDialog 不会将 returnValue 传回，并且 d 是未定义的。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-19T18:33:40.670

为了继续在我的页面中使用 showModalDialog，我必须想出我自己的解决方法来解决这个错误。所以，这里...

在 Google Chrome 中，回发后，showModalDialog 总是返回 undefined。但是，模式对话框中的 window.opener 属性指向调用者窗口，即使在回发之后也是如此。所以，我考虑将对话框的结果放在调用者窗口的 returnValue 属性中。它有效。

在来电窗口中：

```
var prevReturnValue = window.returnValue; // Save the current returnValue
window.returnValue = undefined;
var dlgReturnValue = window.showModalDialog(...);
if (dlgReturnValue == undefined) // We don't know here if undefined is the real result...
{
    // So we take no chance, in case this is the Google Chrome bug
    dlgReturnValue = window.returnValue;
}
window.returnValue = prevReturnValue; // Restore the original returnValue

At this point, use dlgReturnValue for further processing 
```

在模态对话框窗口中：

```
if (window.opener)
{
    window.opener.returnValue = dateValue;
}
window.returnValue = dateValue;
self.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T00:44:19.870

我遇到了同样的错误，我在某个论坛中发现，如果您将控件放在 updatePanel 和 ContentTemplate 中，它将起作用：

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server">
           <ContentTemplate>
           </ContentTemplate>
 </asp:UpdatePanel> 
```

# android - 我如何在 android webview 上播放我的 rtsp 视频？

> ID：10213532
> 
> 赞同：2
> 
> 时间：2012-04-18T16:12:54.443
> 
> 标签：android, android-webview, rtsp, android-mediaplayer, android-video-player

我的意思是我有一个这样的链接：`http://15....../a.stream`

我编写这段代码是为了在 android 上观看视频：

```
VideoView  wv = (VideoView)findViewById(R.id.videoView1);
wv.setVideoURI(Uri.parse("rtsp://15........./a.stream"));
MediaController controller = new MediaController(izle.this);
wv.setMediaController(controller);
wv.start(); 
```

此代码首先有效。但有一天，相同的代码说：无法播放视频对不起，此视频无法播放。

我的第一个问题是为什么会这样提醒我？第二个问题是也许我以另一种方式播放视频也许是工作。就像我在 webview 中播放视频也许是工作？如何在 webview 上播放 rtsp 视频流？

谢谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:46:40.933

你不能在 webview 中播放 rtsp。只有 Flash(rtmp) 流在带有 Flash 播放器的浏览器中播放。如果流是 rtsp，则浏览器将在外部视频播放器中打开它。

HTTPS 渐进式流仅在 3.0+ 下受支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-22T12:32:26.663

*   如果您的设备以某种方式运行闪存，WebView 会播放 rtmp 和 rtsp。没有它就无法播放，因此 API 版本很重要，因为 Flash 播放器曾经在早期的 API 上工作。

*   在 Android 中直播的最佳方式是使用 Vitamio。这是最好的解决方案。它可以播放多种流格式，包括 rtmp 和 rtsp。

# actionscript-3 - ActionScript 3 绑定事件的最佳位置

> ID：10213533
> 
> 赞同：0
> 
> 时间：2012-04-18T16:12:55.117
> 
> 标签：actionscript-3, actionscript

我正在为 Android 编写一个使用 air 的小型 Flash 游戏，但遇到了一个小问题。游戏有3个屏幕（不包括游戏屏幕），分别是主菜单、加载游戏和创建新游戏。在加载游戏并创建新游戏屏幕时，我想添加一个按钮，让用户返回主菜单。

我知道如何将事件侦听器添加到按钮，但我想知道在哪里将事件侦听器绑定回主菜单，在我的主类的构造函数中绑定会在运行时产生错误，并且在进入框架后绑定会被淘汰返回主屏幕时的其他按钮。

目前该应用程序跨越多个框架（可能是一个更好的结构，而不是每个菜单加载一个框架），我是 actionscript 的新手，所以我不完全确定这类事情的最佳实践。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:38:28.243

我建议您在 Fla 中仅使用一帧，然后使用 Document Class。在该主类中，您应该使用 ActionScript 放置所有显示对象。

我希望您知道如何将 Class 实例化为库剪辑。

# sql-server - 在 SQL Server 2008 R2 中获取时区

> ID：10213534
> 
> 赞同：3
> 
> 时间：2012-04-18T16:12:55.347
> 
> 标签：sql-server, timezone

如何在 Microsoft SQL Server 2008R2 中获取时区列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:18:22.883

 **[在 SQL Server 2008 http://blogs.msdn.com/b/sqlprogrammability/archive/2008/03/18/using-time-zone-data-in-sql-server-2008.aspx](http://blogs.msdn.com/b/sqlprogrammability/archive/2008/03/18/using-time-zone-data-in-sql-server-2008.aspx)**中使用时区数据**。**

 **如果我正确理解博客条目， SQL Server 2008 R2*中没有时区列表*，因为这样的列表没有国际公认的标准。相反，Microsoft 提供了一种`datetimeoffset`数据类型，允许您使用数字时区偏移量。

但是，本文确实提供了一些用于构建您自己的时区列表的暂定解决方案。特别是，它提供了一个示例程序，该程序使用 .NET 库将 Olson 时区数据库 (http://www.twinsun.com/tz/tz-link.htm) 中的数据写入表中，然后可以将其导入进入 SQL Server。**

# transactions - 如何创建使用事务的存储过程？

> ID：10213539
> 
> 赞同：0
> 
> 时间：2012-04-18T16:13:54.920
> 
> 标签：transactions

我能够在下面的 SQL Server 2008 R2 中创建存储过程，但现在我遇到了障碍，因为我需要以一种存储过程将使用事务并检查插入语句中的错误的方式来执行此操作。发现错误时 - 事务应回滚并且不应提交任何内容。任何帮助，将不胜感激。

使用 Northwind GO CREATE PROC spEmployee @EmployeeID int AS SELECT * FROM employees WHERE EmployeeID=''+@EmployeeID+'' GO EXEC spEmployee @EmployeeID=2 GO

* * *

CREATE PROC spEmployee @EmployeeID int

开始交易

SELECT * FROM employees WHERE EmployeeID=''+@EmployeeID+''

GO EXEC spEmployee @EmployeeID=2

如果@@ERROR <> 0 则执行

开始

回滚

RAISERROR ('EXECUTE 之后的事务计数表示 BEGIN 和 COMMIT 语句的数量不匹配。先前计数 = 1，当前计数 = 2。', 16, 2)

返回

结尾

犯罪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:07:30.270

首先阅读 SQL2005 以上的 try catch 块。您在此处使用 SQL 2000 错误处理。SQL 在线书籍对于您需要的信息非常有用。

# wcf - 如何解决 WCF 中的 400 错误请求错误

> ID：10213542
> 
> 赞同：7
> 
> 时间：2012-04-18T16:14:00.277
> 
> 标签：wcf

我是 WCF biginner。我做了一个简单的 WCF 服务和一个客户端来上传文件。但是当上传超过 100 KB 时，我收到了 400 个错误请求。我在互联网上搜索并找到了一些关于修改 max* **Length 或 max*** *size 的解决方案。但我还在挣扎。

所以，我想请教专家如何解决这个问题。

服务代码在这里。

```
[ServiceContract]
public interface IService1
{

    [OperationContract]
    void SaveFile(UploadFile uploadFile);
}

[DataContract]
public class UploadFile
{
    [DataMember]
    public string FileName { get; set; }

    [DataMember]
    public byte[] File { get; set; }
}

public class Service1 : IService1
{

    public void SaveFile(UploadFile uploadFile)
    {
        string str = uploadFile.FileName;
        byte[] data = uploadFile.File;
    }
} 
```

服务配置在这里。

```
<?xml version="1.0"?>
<configuration>
  <system.web>
    <compilation debug="true" targetFramework="4.0" />
    <httpRuntime maxRequestLength="64000000"/>
  </system.web>
  <system.serviceModel>
    <behaviors>
      <serviceBehaviors>
        <behavior>
          <serviceMetadata httpGetEnabled="true"/>
          <serviceDebug includeExceptionDetailInFaults="false"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
    <bindings>
      <webHttpBinding>
        <binding maxBufferSize="64000000" maxReceivedMessageSize="64000000" maxBufferPoolSize="64000000">
          <readerQuotas maxDepth="64000000" maxStringContentLength="64000000" maxArrayLength="64000000" maxBytesPerRead="64000000" />
          <security mode="None"/>
        </binding>
      </webHttpBinding>
    </bindings>
  </system.serviceModel>

 <system.webServer>
    <modules runAllManagedModulesForAllRequests="true"/>
  </system.webServer>
</configuration> 
```

客户端代码在这里。

```
private void button1_Click(object sender, RoutedEventArgs e)
{
    FileInfo info = new FileInfo(@"C:\Users\shingotada\Desktop\4.png");

    byte[] buf = new byte[32768];
    Stream stream = info.OpenRead();
    byte[] result;

    using (MemoryStream ms = new MemoryStream())
    {
        while (true)
        {
            int read = stream.Read(buf, 0, buf.Length);
            if (read > 0)
            {
                ms.Write(buf, 0, read);
            }
            else
            {
                break;
            }
        }
        result = ms.ToArray();
    }

        UploadFile file = new UploadFile();
        file.File = result;
        file.FileName = "test";

        ServiceReference2.Service1Client proxy2 = new ServiceReference2.Service1Client();
        proxy2.SaveFile(file);  //400 bad request
} 
```

客户端配置在这里。

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="BasicHttpBinding_IService1" closeTimeout="00:01:00"
                    openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                    allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                    messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                    useDefaultWebProxy="true">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="64000000"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                    <security mode="None">
                        <transport clientCredentialType="None" proxyCredentialType="None"
                            realm="" />
                        <message clientCredentialType="UserName" algorithmSuite="Default" />
                    </security>
                </binding>
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://localhost:53635/Service1.svc" binding="basicHttpBinding"
                bindingConfiguration="BasicHttpBinding_IService1" contract="ServiceReference2.IService1"
                name="BasicHttpBinding_IService1" />
        </client>
    </system.serviceModel>
</configuration> 
```

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T17:43:56.227

您非常接近解决方案，但您正在混合绑定。您的服务正在使用 basicHttpBinding，但您已对 webHttpBinding 设置了大小限制。

因此：在服务的 web.config 中，将 webHttpBinding 替换为 basicHttpBinding 即可，如下所示：

```
 <basicHttpBinding>
    <binding maxBufferSize="64000000" maxReceivedMessageSize="64000000" maxBufferPoolSize="64000000">
      <readerQuotas maxDepth="64000000" maxStringContentLength="64000000" maxArrayLength="64000000" maxBytesPerRead="64000000" />
      <security mode="None"/>
    </binding>
  </basicHttpBinding> 
```

# python - python中的十六进制转换错误

> ID：10213544
> 
> 赞同：2
> 
> 时间：2012-04-18T16:14:01.760
> 
> 标签：python, hex

我需要使用长十六进制数进行计算，因此我想将其转换为整数，但首先，我尝试删除空格和 EOL 字符。但是当我尝试转换时，我收到一个错误：“int() 的无效文字，基数为 16”。这是代码：

```
p = """670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B
E39E772C 180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9
DE2BCBF6 95581718 3995497C EA956AE5 15D22618 98FA0510
15728E5A 8AAAC42D AD33170D 04507A33 A85521AB DF1CBA64
ECFB8504 58DBEF0A 8AEA7157 5D060C7D B3970F85 A6E1E4C7
ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226 1AD2EE6B
F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C
BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31""" 

pps = hex(int(p, 16))
print pps 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T16:17:46.580

我想你想要

```
pps = int(''.join(p.split()), 16) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T16:16:56.537

先去掉空格。例如，您可以使用以下方法执行此操作`re.sub`：

```
p = re.sub(r'\s', '', p) 
```

在线查看它：[ideone](http://ideone.com/uTjYI)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T16:19:14.473

```
pps = hex(int(p.translate(None,' \n'),16)) 
```

# php - php表示真实类型

> ID：10213545
> 
> 赞同：0
> 
> 时间：2012-04-18T16:14:09.513
> 
> 标签：php, types, casting

我想或者我更喜欢用 Php 指示函数中参数的真实类型，这可能吗？

例子 ：

```
<?php
function test($param)
{
   echo $param;
}
$str = "hiiiii everyone";
test($str);
?> 
```

而不是把 $param 放在函数测试中；我想放这样的东西

```
function test(string $param) // string is the type of the param, that can be int, long ect or an object which I had created. 
```

使用最新版本的 PHP 可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:17:54.660

[类型提示](http://php.net/manual/en/language.oop5.typehinting.php)是在 PHP5 中引入的。您现在可以通过在参数列表本身中提供该类型来强制参数为某种类型，如您的示例所示。

不幸的是，标量对象（如`int`和`string`）是不允许的。

[`gettype()`](http://www.php.net/manual/en/function.gettype.php)您可以使用, [`is_string()`](http://www.php.net/manual/en/function.is-string.php)（也处理[其他类型](http://www.php.net/manual-lookup.php?pattern=is_&lang=en&scope=quickref)）甚至类型运算符等方法在内部进行自己的检查，以确定传递的对象是否属于正确的类型[`instanceof`](http://www.php.net/manual/en/language.operators.type.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:19:05.850

不，PHP 是一种动态类型的语言；变量（以及参数）没有设置类型。您可以尝试使用 来执行您自己的事情[`gettype`](http://php.net/manual/en/function.gettype.php)，即：

```
function test($param) {
    if(gettype($param) != "string")
        throw new TypeException //or something
} 
```

但这是个坏主意。不要尝试用您不熟悉的语言实现其他语言的功能。试着拥抱正确的方式，看看它是如何从那里开始的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:20:48.127

您正在寻找的是[Type Hinting](http://php.net/manual/en/language.oop5.typehinting.php)。但是，如链接的手册页中所述：

> 类型提示不能用于标量类型，例如 int 或 string。

这意味着不，您不能强制函数的参数为​​字符串。您可以强制它成为特定类的实例、可调用的东西或数组。

如果您想强制参数为字符串，请执行以下操作：

```
function my_func ($mustBeAString) {
  if (!is_string($mustBeAString)) return;
  // Do stuff here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T16:16:02.007

我想把这个带到桌面上：

```
var_dump($str); 
```

# c# - 如何在文件资源管理器中编程 BACK 按钮？

> ID：10213551
> 
> 赞同：0
> 
> 时间：2012-04-18T16:14:21.157
> 
> 标签：c#, explorer, file-manager

我正在开发一个小文件浏览器，我如何设置**后退**按钮。

我有：

*   `txtAddress.Text`这是资源管理器的地址栏。*   `string currAddress`其中有当前地址。*   `List<string> prevAddress`它应该包含一些以前为**返回按钮访问过的地址**

    我使用：

    *   `Root();`获取我的电脑项目。*   `Open(string Address);`从地址获取文件/文件夹。*   `Search(string Address, string keyword);`获取搜索结果项。

    我需要后退按钮，因为当我在路径中搜索时，我无法按下向上按钮（转到父路径），因为我需要返回到我正在搜索的路径，所以后退按钮如何工作探险家？我应该什么时候添加/删除地址？

    ![在此处输入图像描述](../Images/61ec05b64ac25e96ca80a61f67084903.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:18:22.287

建议您自己在应用程序中保持/管理此状态。

每次用户在地址栏中导航/强制使用新的/不同的路径时，然后将新目录添加到应用程序中的列表/集合中。

单击后退按钮时，您可以在列表/集合中找到“上一个”条目。那是您要显示的目录。

```
Key    Val
  1     D:\
  2     D:\Foo
  3     D:\Foo\Bar
  4     C:\        (here the user may have manually typed into the addr bar) 
```

您可能会遇到目录不再存在、重命名、不可用等问题。也许您已经在代码中处理了这些情况。您可以[`Directory.Exists`](http://msdn.microsoft.com/en-us/library/system.io.directory.exists.aspx)在尝试导航之前使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:20:53.830

为了很好地实现后退按钮，我建议使用某种堆栈来维护用户所在的位置。每次执行导航时，`push`旧位置都会放到堆栈中。当按下后退按钮`pop`时，堆栈顶部的项目并导航到该位置。如果堆栈为空，则使后退按钮不可用，因为无处可返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:51:11.820

后退（和前进）非常接近于经常讨论的撤消（即[“设计模式”](http://en.wikipedia.org/wiki/Design_Patterns)一书中提到的）。

常见实现 - 存储在“当前状态”和 2 个堆栈中的每个操作的状态（由 @p.campbell 回答）：一个用于撤消/返回，另一个用于重做/转发。每当用户进行更改（即通过键入某些内容或主动导航某处）时，重做/转发堆栈被清除，并且先前的状态被推送到撤消/返回堆栈。后退/前进相应地将当前状态放入其中一个堆栈并从另一个堆栈中弹出下一个状态。

# java - Java 的 CountDownLatch 可以从被动类而不是线程中使用吗？

> ID：10213554
> 
> 赞同：4
> 
> 时间：2012-04-18T16:14:28.990
> 
> 标签：java, concurrency, countdownlatch

所以我正在开发这个模拟一天工作的程序，每个工人都是自己的线程。我正在尝试实施工人参加会议的会议，但会议要等到应该参加会议的每个人都到达后才开始。所以我有这种参加会议的方法。

```
public void attendMeeting(Employee worker){
    this.cdStart.countDown();
    worker.meetingWait();
    try {
        this.cdStart.await();
        worker.meetingStart(this.length);
        if(this.attendees.get(0).equals(worker)){
            this.room.exit();
        } // end if

    } // end try
    catch (InterruptedException err) {
        // Do Nothing

    } // end catch

} // end method attendMeeting 
```

worker 参数是扩展 Thread 的 Employee 类的实例，this.cdStart 是 CountDownLatch。但是，在四名员工的会议上运行此程序时，似乎只有一名员工能够进入，减少计数，然后点击 await() 调用。其他工作线程似乎都无法进入它。我确实注意到许多在线使用示例将 CountDownLock 对象传递给线程本身来处理。有没有理由为什么这不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:57:28.897

我假设您在 Employee Thread 对象中传递了一个线程。该单个线程将无限期地等待，直到 N 方到达（除了 Employee 线程之外，每个 Employee 实例都需要一个单独的线程）。这意味着，如果只有一个线程不断通过员工/线程，您将永远不会有超过一个员工在会议上等待。

相反，该线程最多应该向员工线程发出信号以参加会议。

您应该在会议类中有闩锁，并让他们在该闩锁上等待。这也需要对其工作方式进行轻微重组。

您将 Meeting 实例传递给 Employee 以让该线程等待。

```
 public Employee extends Thread{

     //define this at some point whether in constructor or a 
     //means of notifying the thread to attend the meeting
      private Meeting meeting;

      public void run(){
          //do some stuff until this employee is ready to go  to a meeting

         meeting.waitForAllOthersToArrive();
      }

    }

   public class Meeting{  
     CountDownLatch latch =  new CountDownLatch(numberOfEmployees);

     public void waitForAllOthersToArrive(){
        latch.countDown();
        latch.await();
     } 
   } 
```

然而，我对此建议的是 CylicBarrier。尽管您不会重新使用它，但 CyclicBarrier 的工作方式更适合您尝试做的事情，然后 Meeting 类看起来像

```
 public class Meeting{
     CylicBarrier barrier = new CylicBarrier(numberOfEmployees);

     public void waitForAllOthersToArrive(){
         barrier.await(); //when await() is called numberOfEmployees then all waiting threads will awake
     }
 } 
```

# android - 列表视图已检查

> ID：10213555
> 
> 赞同：0
> 
> 时间：2012-04-18T16:14:31.930
> 
> 标签：android

嘿伙计们，我正在尝试设置列表视图上的第一项检查，但代码不起作用。

```
import android.app.ListActivity;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class ListView1 extends ListActivity {
@Override
   public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.main);

       String[] names = new String[] { "Android", "Windows7", "Symbian", "iPhone",
              "Android", "Windows7", "Symbian", "iPhone",
              "Android", "Windows7", "Symbian", "iPhone" };
         setListAdapter(new ArrayAdapter<String>(this,
                           android.R.layout.simple_list_item_single_choice,
                           android.R.id.text1, names));
         ListView listView = getListView();
         listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
         listView.setSelection(0);
         listView.setSelected(true);

   }} 
```

[我希望检查第一个单选按钮的活动图片](http://hidroilio.com/video/22.png) 任何帮助将不胜感激 最好的问候 HP

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:36:39.470

```
ListView listView = getListView();
listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
listView.setSelection(0);
listView.setSelected(true); 
```

用下面的:::use 替换上面的行

```
ListView listView = getListView();
listView.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
listView.setItemChecked(0,true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:34:05.353

setSelection 正是这样做的——它选择列表视图滚动中的项目——即给它焦点。

[http://developer.android.com/reference/android/widget/ListView.html#setSelection(int)](http://developer.android.com/reference/android/widget/ListView.html#setSelection%28int%29)

试试这个：

```
listview.setItemChecked(0,true) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:29:02.050

您需要为此做自己的适配器（BaseAdapter 的扩展）。在 getView 中，您可以轻松地做到这一点：

```
if(position == 0)layout.findViewById("mycheckbox").setchecked(true) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-17T14:18:03.423

如果你会坚持`setItemChecked(int, boolean)`

通过引用源代码，我发现以下内容：

```
 public void setItemChecked(int position, boolean value) {
       if (mChoiceMode == CHOICE_MODE_NONE) {
           return;
       }

        if (mChoiceMode == CHOICE_MODE_MULTIPLE) {
            mCheckStates.put(position, value);
       } else {
            boolean oldValue = mCheckStates.get(position, false);
            mCheckStates.clear();
            if (!oldValue) {
                mCheckStates.put(position, true);
            }
        }

        // Do not generate a data change while we are in the layout phase
        if (!mInLayout && !mBlockLayoutRequests) {
            mDataChanged = true;
            rememberSyncState();
            requestLayout();
        }
    } 
```

这里最重要的一行是

```
 // Do not generate a data change while we are in the layout phase 
```

这意味着即使检查项目后面的数据发生了变化，drawable也不会改变

介意

和平...

# python - Python：如何在 pygame 上制作标题画面？

> ID：10213558
> 
> 赞同：0
> 
> 时间：2012-04-18T16:14:41.217
> 
> 标签：python, pygame, page-title

您将如何在 pygame 中放置标题屏幕/结束屏幕？使用 Enter 键继续，使用 Esc 键退出。

我有一个我个人用 Photoshop 制作的标题屏幕，我想将它插入到游戏的开头，然后让用户按 Enter 或 Esc。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:03:38.187

网上有很多 Pygame 资源。Al Sweigart 最近出版的一本书，[用 Python 和 Pygame 制作游戏](http://inventwithpython.com/pygame/index.html)有一些你所描述的例子。

特别是看一下下面的示例[程序](http://inventwithpython.com/pygame/chapter6.html)。这有一些函数可以完成您想做的事情，即 showStartScreen()、checkForKeyPress() 和 drawPressKeyMsg() 函数。

# c++ - 输出错误 Project Euler 50

> ID：10213559
> 
> 赞同：3
> 
> 时间：2012-04-18T16:14:42.117
> 
> 标签：c++

所以我正在尝试项目欧拉的问题50。（如此接近 2 级：D）它是这样的：

> 素数 41 可以写成六个连续素数之和：

```
41 = 2 + 3 + 5 + 7 + 11 + 13 
```

> 这是添加到低于 100 的素数的最长的连续素数之和。与素数相加的一千以下的最长连续素数之和包含 21 项，等于 953。哪一个小于一百万的素数可以写为最多连续素数之和？

这是我的代码：

```
#include <iostream>
#include <vector>
using namespace std;

int main(){
    vector<int> primes(1000000,true);
    primes[0]=false;
    primes[1]=false;
    for (int n=4;n<1000000;n+=2)
        primes[n]=false;
    for (int n=3;n<1000000;n+=2){
        if (primes[n]==true){
            for (int b=n*2;b<100000;b+=n)
                primes[b]=false;
        }
    }
    int basicmax,basiccount=1,currentcount,biggermax,biggercount=1,sum=0,basicstart,basicend,biggerstart,biggerend;
    int limit=1000000;
        for (int start=2;start<limit;start++){
            //cout<<start;
            sum=0;
            currentcount=0;
            for (int basic=start;start<limit&&sum+basic<limit;basic++){
                if (primes[basic]==true){
                    //cout<<basic<<endl;
                    sum+=basic;currentcount++;}
                    if (primes[sum]&&currentcount>basiccount&&sum<limit)
                        {basicmax=sum;basiccount=currentcount;basicstart=start;basicend=basic;}

            }
            if (basiccount>biggercount)
                {biggercount=basiccount;biggermax=basicmax;biggerend=basicend;biggerstart=basicstart;}
        }
    cout<<biggercount<<endl<<biggermax<<endl;
    return 0;
} 
```

基本上，它只是创建一个包含最多 1000000 的所有素数的向量，然后循环遍历它们以找到正确的答案。答案是 997651，计数应该是 543，但我的程序分别输出 997661 和 546。可能有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:21:55.203

看起来您正在构建错误的素数向量

```
 for (int b=n*2;b<100000;b+=n)
            primes[b]=false; 
```

我认为应该是 1,000,000 而不是 100,000。最好将该数字重构为常数，以确保它始终保持一致。

其余的看起来基本没问题，虽然没有自己测试，我不确定我们还能添加什么。有很大的提高效率的空间：您确实对范围进行了很多重复扫描，例如当为假时没有必要开始求和`prime[start]`，您可以为求和等构建仅素数的第二个向量。（Euler 项目是否有运行时和内存限制限制？我不记得了）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:29:01.587

你正在以错误的方式思考这个问题。

1.  生成最大的素数序列，使得它们的总和小于 1,000,000。这是 2, 3, 5, ..., p。对于一些 p。
2.  对这个序列求和并测试它的素数。
3.  如果它是素数，则终止并返回总和。
4.  较短的序列必须是正确的。缩短序列和保留连续素数属性的方法有两种——删除第一个元素或删除最后一个元素。使用这两个序列从 2 递归。

# c# - 以给定备用安全身份凭证的用户身份登录

> ID：10213563
> 
> 赞同：3
> 
> 时间：2012-04-18T16:15:01.210
> 
> 标签：c#, winapi

我们的应用程序当前使用 LogonUser 来允许第二个用户验证更改。这适用于常规用户名和密码，但是我们需要为某些用户使用智能卡/pin 而不是密码。是否有任何可用于使用备用安全身份凭证而不是 Windows API 中的密码登录的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:38:10.587

试试看[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/aa374731%28v=vs.85%29.aspx#smart_card_functions)。据我所知，[CredUIPromptForWindowsCredentials](http://msdn.microsoft.com/en-us/library/windows/desktop/aa375178%28v=vs.85%29.aspx)也支持智能卡等。

# mongodb - 操作手册中MongoDB中的父子关系查询错误

> ID：10213566
> 
> 赞同：0
> 
> 时间：2012-04-18T16:15:33.153
> 
> 标签：mongodb, mongodb-.net-driver, mongodb-php

![在此处输入图像描述](../Images/fe681ea66da43f03841e7386650c4cbc.png)

我怀疑在[MongoDB in Action一书中定义的获取兄弟姐妹的方法](https://rads.stackoverflow.com/amzn/click/com/1935182870)

每个类别都保留作为父类别 ID 的 parent_id。所以兄弟类别应该有共同的parent_id。

但是要查询特定类别的兄弟姐妹（比方说`category['_id'] = C5`）书说如下：

```
siblings = db.categories.find({'parent_id': category['_id']}); 
```

返回的游标显然不是 C5 的兄弟姐妹，它们是 C5 的孩子。

根据我的理解，查询应该是

```
siblings = db.categories.find({'parent_id': category['parent_id']}); 
```

请评论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:12:02.717

你是对的，这在本书的第二次印刷中得到了解决。请参阅此处的勘误表：

[http://manning.com/banker/excerpt_errata.html](http://manning.com/banker/excerpt_errata.html)

# java - Java中的存根私有方法

> ID：10213570
> 
> 赞同：0
> 
> 时间：2012-04-18T16:15:50.907
> 
> 标签：java, unit-testing

我正在测试一个带有多个参数的函数，并根据它们的值调用不同的私有方法。

我想检查该函数是否始终调用正确的私有方法。

因为我知道私有方法会做什么，所以我可以检查最终结果，但是直接检查是否调用了正确的函数会更方便，因为我已经测试了私有方法。

有没有办法用存根替换 privae 方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:21:43.797

是的，有一些模拟库可以让你做到这一点。一个是[PowerMock](http://code.google.com/p/powermock/)。从他们的[私有方法教程](http://code.google.com/p/powermock/wiki/MockPrivate)中，你需要这样的东西：

```
@RunWith(PowerMockRunner.class)
@PrepareForTest(MyUnit.class)
public class TestMyUnit {

    @Test
    public void testSomething() {
        MyUnit unit = PowerMock.createPartialMock(MyUnit.class, "methodNameToStub");
        PowerMock.expectPrivate(unit, "methodNameToStub", param1).andReturn(retVal);

        EasyMock.replay(unit);

        unit.publicMethod(param1);

        EasyMock.verify(unit);

    }

} 
```

但是，我自己真的不同意这种做法。您的单元测试应该测试输入、输出和副作用，仅此而已。通过确保正确调用*私有*方法，您所做的就是防止您的代码被轻易重构。

换句话说，如果你想改变*你*的单位的工作方式怎么办？执行此操作的安全方法是确保代码处于（通过）测试中，然后重构代码（可能包括更改调用的内部方法），然后再次运行测试以确保您没有破坏任何东西。使用您的方法，这是不可能的，因为您的测试测试的是确切的实现，而不是单元本身的行为。重构几乎总是会破坏测试，那么测试到底能给你带来多少好处呢？

大多数情况下，您会想要这样做，因为您实际上将这些私有视为自己的一个单元（这听起来像您，因为您说您已经直接测试了这些私有方法！）。如果是这种情况，最好将该逻辑提取到它自己的类中，对其进行测试，然后在剩余的代码中与该新单元的模拟/存根版本进行交互。如果你这样做了，你的代码就会有更好的结构，而且你不需要依赖 PowerMock 的巫术魔法。进行此类重构的绝佳参考是 Michael Feathers 的[Working Effectively with Legacy Code](https://rads.stackoverflow.com/amzn/click/com/0131177052)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:24:47.183

如果调用正确的“私有方法”没有可观察到的外部结果，您确定要对此进行测试吗？也许不应该。

如果无论是否调用私有方法，最终结果都相同，并且您仍想观察其调用，则可以将该方法设为公共并将其移至其自己的类，然后模拟该类。然后你可以验证（使用 Mockito 或类似的框架）你的方法是否被调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:26:19.727

代码覆盖工具通过在测试实际运行之前重写字节码来做这种事情。所以，它必须是可能的，但它不是微不足道的。

更新：编写一个要求调用“正确”私有方法的单元测试会使重构工作变得非常痛苦，因为那时您必须重新编写所有测试。这违背了测试的目的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T16:22:58.173

作为解决方案之一，可以使用内部类的代理。您需要在每个必须测试的类中添加内部类。但对于大型产品项目来说，这不是很好的解决方案。它需要创建添加脚本以从您的发布文件（jar/war）中删除生成的类。

但更简单的方法将使用 PowerMock，如下面的评论（或上层:)） - [http://code.google.com/p/powermock/wiki/MockPrivate](http://code.google.com/p/powermock/wiki/MockPrivate)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T16:18:40.400

您可以检查 java 仪器以执行此操作

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T16:23:27.787

是否有可能为所讨论的类提供另一个对象，将私有方法移至该对象并使其公开？在这种情况下，很容易为该接口创建一个测试假人。

# wpf - 单击事件分派到错误的控件

> ID：10213573
> 
> 赞同：0
> 
> 时间：2012-04-18T16:15:57.793
> 
> 标签：wpf, event-handling, mouseevent

我们要求在一些不确定触发的硬件事件上，根据事件，GUI 会发生变化。由于 GUI 复杂性，这可能需要几秒钟。

现在的问题。如果我在 GUI 仍然忙碌时单击按钮，有时会调用错误的按钮，因为在 GUI 布局之后，此按钮现在位于之前发生单击的鼠标坐标处。

我确信 Windows 窗体的行为是不同的。我可以绕过这种行为吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:53:32.277

你可以 ：

*   刷新时隐藏或覆盖 UI（例如，使用[忙碌指示器](http://wpftoolkit.codeplex.com/wikipage?title=BusyIndicator)）
*   优化刷新（见[MSDN Wpf 优化类](http://msdn.microsoft.com/en-us/library/aa970683.aspx)，尤其是[布局和设计](http://msdn.microsoft.com/en-us/library/bb613542.aspx)）
*   快速而肮脏 - 存储 IsRefreshing 变量并使用它来禁用按钮或取消按钮处理程序

**编辑**

真正的问题是：你的瓶颈是什么？UI 刷新还是背后的逻辑？

# ubuntu - 通过软件服务访问 NAT 路由器后面的 Ubuntu PC

> ID：10213577
> 
> 赞同：0
> 
> 时间：2012-04-18T16:16:00.930
> 
> 标签：ubuntu, vnc, nat, portforwarding

如何在不重新配置 NAT 路由器的情况下通过纯软件（应用程序或服务）访问 NAT 路由器后面的 Ubuntu PC？

以下是问题描述：

1.  在我的办公室里，我有启用了 VNC 的 Ubuntu PC。Ubuntu PC 具有私有 IP 地址，并且不仅位于一个而是两个 Internet 路由器后面，因此无法在它们上配置 NAT（我无权访问它们）。
2.  在我的家里，我有自己的局域网工作组和一台直接连接到 Internet 并具有公共 IP 地址的服务器 PC (windows xp)。

所以我想要的是一种直接从我家 LAN 上的 PC 访问我的 Ubuntu PC 上的 VNC 服务器的方法。如您所见，两台计算机都有私有 IP 地址，并且都位于 NAT 路由器后面。我需要像 LogMeIn 之类的东西，除了 Windows 和 Ubuntu 之外。

我还想也许可以用 C++ 或 Java 编写程序，它应该由可以进行端口转发的服务器和客户端组成，我有一些想法，但我真的很想看看在 Ubuntu 中是否已经有一种方法可以在不重新发明轮子的情况下做到这一点.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:26:36.747

您应该查看[适用于 Linux 的 TeamViewer](http://www.teamviewer.com/en/download/index.aspx)。根据[常见问题解答](http://www.teamviewer.com/en/help/9-Does-it-work-behind-firewalls-proxy-server-and-NAT-routers.aspx)，它支持这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-06T18:54:19.190

您可以在两台计算机之间建立 SSH 隧道。

[以下是如何通过 SSH 建立 VNC 隧道](https://helpdeskgeek.com/how-to/tunnel-vnc-over-ss)的几种方法。

# php - 如何存储 PHP 变量直到另一个请求

> ID：10213587
> 
> 赞同：2
> 
> 时间：2012-04-18T16:16:41.890
> 
> 标签：php, variables, get

如何在 PHP 脚本中存储 PHP 变量，然后在另一个 PHP 脚本中使用相同的变量？

我试过这段代码，但没有用：

```
<?php                       
                    session_start();
                            $util=$_POST['util'];
                            $pw=$_POST['pw'];
                            include("abrebdvendas.php");
                            //testar a exist�ncia de liga��o ao MySQL
                            $ligax=mysql_connect($host,$user,$senha);
                            if (!$ligax) {
                                    echo 'Erro: Falha na liga&#231;&#227;o'.'<br>';
                                    exit;
                                    }
                                    //ligar � base de dados vendas
                                    mysql_select_db($dbname,$ligax);
                                    //criar uma query para inser��o do registo
                                    $lista="select * from utilizador where util='$util' and pw='$pw'";
                                    $result=mysql_query($lista) or die(mysql_error());
                                    $dados = mysql_fetch_array($result);
                                    $u=$dados['util'];
                                    $p=$dados['pw'];
                            if ($u=='' or $p=='')
                            {
                            echo "Tente de novo";
                            echo '<meta HTTP-EQUIV="Refresh" CONTENT="1; URL=http://localhost/ola1/Site/Sem%20Log%20In/longin.html">';
                            } 
                            else if ($u==$util and $p==$pw)
                                    {
                                    //obter tipo valor
                                    echo '<h2>Bem vindo '.$util.'</h2><br>';
                                    $paulo=$_POST['util'];
                                    echo '<meta HTTP-EQUIV="Refresh" CONTENT="100; URL=http://localhost/ola1/Site/Com%20LogIn/paginicial.php">';

                                     $_SESSION['myNumber']=$num;                
                                                                        }
                                    else
                                    {
                                    echo "Tente de novo";
                                    echo '<meta HTTP-EQUIV="Refresh" CONTENT="0.1; URL=http://localhost/ola1/Site/Sem%20Log%20In/longin.html">';
                                    }                                   
                    ?> 
```

代码来自[这里](http://www.skytopia.com/project/articles/compsci/form.html)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T16:25:57.107

当您想使用存储在另一个页面的另一个变量中的某个变量的值时，您应该使用 $_SESSION[] 如下：

```
 $_SESSION['myNumber']=$num; 
```

您需要在 php 页面顶部启动会话，如下所示：

```
 <?php
ob_start();
@session_start();
?> 
```

并从另一个 php 文件中获取变量，如下所示

```
$newnum = $_SESSION['myNumber']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:24:34.907

使用会话，第一行必须是`session_start();`

然后您可以存储一些值`$num = $_SESSION['myNumber'];`并将其用于其他操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:18:04.787

您可以将它们存储为会话变量

```
$_SESSION['myNumber'] = $num; 
```

# atk4 - 使用 Agile Toolkit 创建主从网格

> ID：10213594
> 
> 赞同：1
> 
> 时间：2012-04-18T16:17:08.357
> 
> 标签：atk4

如何创建一个显示两个网格（主网格和详细信息）的表单。当您从主文件中选择一条记录时，将刷新详细信息网格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T11:12:32.877

您的问题很难理解，因为您正在混合使用 Form & Grid 术语。这是两个不同的 UI 元素。但是，如果您想象过以下情况：

1) GridA - 显示用户列表
2) GridB - 显示按用户过滤的活动日志

那么语法将是直截了当的：

```
class page_x extends Page {
    function init(){
        parent::init();
        $g = $this->add("Grid");
        $g->setModel("User");
        $g->addColumn("button", "filter");

        $m = $this->add("Model_Log");
        if ($_GET["user_id"]){
             $m->addCondition("user_id", $_GET["user_id"]);
        }
        $g2=$this->add("Grid");
        $g2->setModel($m);
        if ($_GET["filter"]){
             $g2->js()->reload(array("user_id" => $_GET["filter"]))->execute();
        }
    }
} 
```

未解析，但应该让您了解如何使用条件重新加载、网格、按钮、事件处理。

# django - 我使用什么模型对象类型在 Django Admin 中存储时间值？

> ID：10213596
> 
> 赞同：2
> 
> 时间：2012-04-18T16:17:10.947
> 
> 标签：django, datetime, django-models

我正在尝试设置与时间长度相对应的产品（报纸订阅）。

我让客户使用 Django Admin 添加产品类型（各种订阅长度），但我找不到任何关于我应该使用什么模型对象类型来存储时间值（如 52 周、26 周、 1 周等）。我希望能够选择几天或几周的长度，因为有些论文是每周一次，有些则是每天一次。

现在我的产品模型是：

```
class Product(models.Model):
    product_type = models.CharField(max_length=100)
    product_description = models.CharField(max_length=255)
    product_cost = models.DecimalField(decimal_places=2, max_digits=4)
    product_active = models.BooleanField()
    def get_absolute_url(self):
        return "/signup/%i/" % self.id
    def __unicode__(self):
        return self.product_type 
```

有什么方法可以让 product_type 成为一个对象类型，让用户定义时间值？

谢谢，

安东尼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:26:50.690

我认为只存储两个值会更容易，一个数字值和一个数字代表的选择。

```
duration = models.IntegerField()
duration_type = models.CharField(max_length=32, choices=[
    ("day", "Days"),
    ("week", "Weeks")]) 
```

假设您有一个单独的订阅模型，那么您可以将该模型中的到期时间计算为一种方法：

```
class Subscription(models.Model):
    product = models.ForeignKey(Product)
    starts = models.DateField()
    def expires(self):
        from datetime import timedelta
        if self.product.duration_type == "day":
            days = self.product.duration
        elif self.product.duration_type == "week":
            days = self.product.duration * 7
        return self.starts + timedelta(days=days) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:29:40.103

您可以添加一些描述订阅开始和结束的 DateTime 模型字段。您可以创建一个模型的方法，通过从另一个日期时间减去一个日期时间来返回一个**时间增量**

```
class Product(models.Model):
    product_type = models.CharField(max_length=100)
    product_description = models.CharField(max_length=255)
    product_cost = models.DecimalField(decimal_places=2, max_digits=4)
    product_active = models.BooleanField()

    subscription_start = models.DateTimeField()
    subscription_end = models.DateTimeField()

    def get_duration(self):
        # returns a timedelta
        return self.subscription_end - self.subscription_start

    def get_absolute_url(self):
        return "/signup/%i/" % self.id
    def __unicode__(self):
        return self.product_type 
```

例如：

```
>> import datetime
>> d1 = datetime.datetime(1986,14,05,0,0,0)
>> d2 = datetime.datetime.now()
>> print d2 - d1
9471 days, 17:24:31 
```

您可以使用该 timedelta 在您的视图中进行计算

# .net - Raspberry Pi 上的单声道

> ID：10213600
> 
> 赞同：78
> 
> 时间：2012-04-18T16:17:27.240
> 
> 标签：.net, linux, mono, arm, raspberry-pi

我已经看到[很多关于在 Raspberry Pi 上运行 Mono/.NET 代码的讨论](https://stackoverflow.com/questions/9547047/monodevelop-armv6-raspberry-pi)。在 Raspberry Pi 上实际运行任何 Mono 代码是否有任何成功？

在他们的网站上，他们列出了在该设备上运行的几个 Linux 发行版，其中一些发行版包括 Mono。但是，没有详细说明 Mono 是否可以使用它。

有工作实施吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-06-28T14:36:58.117

我已经设法在 Debian 6.0 (Squeeze) 和 Mono 上运行我的[Delta Forth .NET](http://bocan.ro/deltaforthnet)编译器。它在完全二进制兼容性的情况下完美运行，我唯一要做的就是重新编译代码以针对 .NET 3.5（而不是 4.0），因为 Debian 上的 Mono 在 .NET 版本方面有点滞后。

编译器不是一个微不足道的 .NET 应用程序，所以我很高兴看到编译器在我的微型 Raspberry Pi 上实际运行。

我为使魔术发生而采取的实际步骤是（我从记忆中回忆）：

*   使用以下命令安装 Mono 运行时：**sudo apt-get install mono**
*   使用以下命令调用编译器本身：**mono DeltaForth.exe file_to_compile.4th**

就这些。这项工作中最具挑战性的部分是使用闪存驱动器将文件从我的 Windows 机器传输到 Raspberry Pi :-)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-04-20T22:45:08.493

Raspberri Pi 板上的人[报告说 Mono 确实可以工作](https://www.raspberrypi.org/forums/viewtopic.php?f=34&t=99595)，至少对于简单的应用程序是这样。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-07-04T09:10:19.267

Raspberry Pi 上的 Mono 是可能的，而且设置起来相当容易。以下假设您使用的是 Debian。这取自[我的博客](http://sbatman.com/Blog/EntryId/12/Raspberry-PI-Developing-with-Mono-c-vb-net-others)，该博客提供了许多 Raspberry Pi 教程

注意：目前可用的标准 Mono 运行时仅支持 .NET 3.5，除非您自己从源代码编译。

> 因此，您想开始为您的 Raspberry Pi 开发一些应用程序，但您的编程知识仅限于现代 .NET 语言，例如[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)和[C#](http://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29)。没问题！！欢迎来到 Mono 的世界，它是 .NET 框架的开源跨平台兼容版本。通过使用诸如 Visual Studio 之类的开发 IDE，甚至更好的[MonoDevelop](http://en.wikipedia.org/wiki/MonoDevelop)，您可以生成将在您的 Raspberry Pi 上运行的 EXE 文件。您需要做的就是在 Raspberry Pi 上安装 Mono 运行时。为此，我们输入以下行。

```
sudo apt-get update

sudo apt-get install mono-runtime 
```

> 正如在其他教程中提到的，第一行用于更新 APT-GET 包管理器，以确保它使用最新的源来下载你的包。第二行安装并准备运行时以供使用。就是这样，现在运行一个 Mono 开发的 EXE 文件。只需简单地在命令前加上`mono`如下所示的单词即可。

```
mono myprogram.exe 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-04-24T12:10:08.273

是的。我已经成功运行了基于 Mono 的 Winforms 和 Webforms 应用程序 (XSP)。详细的操作方法可以在我的博客中找到

[http://www.amazedsaint.com/2013/04/hack-raspberry-pi-how-to-build.html](http://www.amazedsaint.com/2013/04/hack-raspberry-pi-how-to-build.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-03-09T13:52:12.297

硬浮点支持现在在单声道 3.2.7 中：
[http ://www.raspberrypi.org/phpBB3/viewtopic.php?t=62496&p=468500](http://www.raspberrypi.org/phpBB3/viewtopic.php?t=62496&p=468500)

可以从 git 安装最新的源代码。它应该是这样的：（
首先删除以前的单声道安装）

```
sudo apt-get update
sudo apt-get install git build-essential automake autoconf libtool gettext
git clone git://github.com/mono/mono.git
cd mono
./autogen.sh --prefix=/usr/local
make get-monolite-latest
make EXTERNAL_MCS="${PWD}/mcs/class/lib/monolite/gmcs.exe"
sudo make install 
```

这就是“mono -V”在我的覆盆子上的样子：

```
Mono JIT compiler version 3.4.0 (master/ae165c5 Thu Mar 13 01:20:37 UTC 2014)
Copyright (C) 2002-2014 Novell, Inc, Xamarin Inc and Contributors. www.mono-project.com
    TLS:           __thread
    SIGSEGV:       normal
    Notifications: epoll
    Architecture:  armel,vfp+hard
    Disabled:      none
    Misc:          softdebug
    LLVM:          supported, not enabled.
    GC:            sgen 
```

快速测试似乎工作正常：

```
csharp> Math.Pow(2,4);
16 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-01-12T12:16:05.703

在我运行 Fedora 18 remix 的 Raspberry Pi 上，我只需要：

```
 # yum -y install mono-devel 
```

去检查：

```
 # csharp
    Mono C# Shell, type "help;" for help
    Enter statements below.
    csharp> Console.WriteLine("Hello, I am PI");
    Hello, I am PI
    csharp> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-01T10:34:54.070

我能够在树莓派（debian）上运行我的 .NET exe。

安装单声道 - [http://logicalgenetics.com/raspberry-pi-and-mono-hello-world/](http://logicalgenetics.com/raspberry-pi-and-mono-hello-world/)

然后运行你的exe`mono something.exe`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-05-29T18:03:51.200

[您可以使用ExaGear 桌面](http://eltechs.com/product/exagear-desktop/)软件在 Raspberry Pi 上运行 x86 版本的 Mono 。

它允许运行几乎所有 x86 应用程序，甚至可以安装 Wine 来运行 Windows 应用程序。

他们说 Firefox 的运行速度甚至比本机还快……

# gcc - gmake 在 PASE 中立即失败

> ID：10213602
> 
> 赞同：1
> 
> 时间：2012-04-18T16:17:46.257
> 
> 标签：gcc, ibm-midrange, ghostscript, gnu-make

我是这个 iSeries 的安全官员，使用 PASE（便携式应用程序安全环境——本质上是 OS/400 上的虚拟 AIX 沙箱）来编译 Ghostscript 9.05。我已经在我的 PASE 环境中下载并安装了 AIX 的 RPM，然后使用 gcc (gcc-4.0.0-1.aix5.3.ppc) 的 RPM 和标准 GNU 开发环境的其余部分在 PASE 上安装它们，以及。配置工作正常（在 /QOpenSys/usr/bin/-sh 中，我使用 CALL QP2TERM 到达那里），但是当我尝试 gmake （这里默认为 cc 而不是 gcc）时，它立即失败：

```
$ pwd                                                       
/QOpenSys/download/ghostscript-9.05/ghostscript-9.05      
$ gmake                                                     
Makefile:1: *** missing separator.  Stop. 
```

我阅读了关于这个的[上一个问题](https://stackoverflow.com/questions/1326822/makefile-cant-understand-comments)，并清除了我的 Makefile.in 的评论并运行它`cat -vet Makefile.in`。结果包括在下面；他们对我来说很好，但我仍然收到上面的错误。（请注意，这是从 5250 仿真器会话中提取的；显示中的换行符与 Makefile.in 换行符无关，而是显示为 $）：

```
$ cat -vet Makefile.in                                                     
BINDIR=./$(BUILDDIRPREFIX)bin$                                             
GLSRCDIR=./base$                                                           
GLGENDIR=./$(BUILDDIRPREFIX)@OBJDIR_BSDMAKE_WORKAROUND@$                   
GLOBJDIR=./$(BUILDDIRPREFIX)@OBJDIR_BSDMAKE_WORKAROUND@$                   
AUXDIR=$(GLGENDIR)/aux$                                                    
PSSRCDIR=./psi$                                                            
PSLIBDIR=./lib$                                                            
PSRESDIR=./Resource$                                                       
PSGENDIR=./$(BUILDDIRPREFIX)@OBJDIR_BSDMAKE_WORKAROUND@$                   
PSOBJDIR=./$(BUILDDIRPREFIX)@OBJDIR_BSDMAKE_WORKAROUND@$                   
CONTRIBDIR=./contrib$                                                      
include $(GLSRCDIR)/version.mak$                                           
DD=$(GLGENDIR)/$                                                            
GLD=$(GLGENDIR)/$                                                           
PSD=$(PSGENDIR)/$                                                           
INSTALL = $(GLSRCDIR)/instcopy -c$                                          
INSTALL_PROGRAM = $(INSTALL) -m 755$                                        
INSTALL_DATA = $(INSTALL) -m 644$                                           
INSTALL_SHARED = @INSTALL_SHARED@$                                          
prefix = @prefix@$                                                          
exec_prefix = @exec_prefix@$                                                
bindir = @bindir@$                                                          
scriptdir = $(bindir)$                                                      
includedir = @includedir@$                                                  
libdir = @libdir@$                                                          
mandir = @mandir@$                                                          
man1ext = 1$                                                               
man1dir = $(mandir)/man$(man1ext)$                                         
datadir = @datadir@$                                                       
datarootdir = @datarootdir@$                                               
gsdir = @datadir@/ghostscript$                                             
gsdatadir = $(gsdir)/$(GS_DOT_VERSION)$                                    
gssharedir = @libdir@/ghostscript/$(GS_DOT_VERSION)$                       
gsincludedir = @includedir@/ghostscript/$                                  
docdir=$(gsdatadir)/doc$                                                   
exdir=$(gsdatadir)/examples$                                               
GS_DOCDIR=$(docdir)$                                                       
CUPSCFLAGS=@CUPSCFLAGS@$                                                   
CUPSLIBS=@CUPSLIBS@$                                                       
CUPSLIBDIRS=@CUPSLIBDIRS@$                                                 
CUPSSERVERBIN=@CUPSSERVERBIN@$                                               
CUPSSERVERROOT=@CUPSSERVERROOT@$                                             
CUPSDATA=@CUPSDATA@$                                                         
CUPSPDFTORASTER=@CUPSPDFTORASTER@$                                           
CUPSINSTTARGET=@CUPSINSTALL@$                                                
COMPILE_INITS=@COMPILE_INITS@$                                               
GS_LIB_DEFAULT=$(gsdatadir)/Resource/Init:$(gsdatadir)/lib:$(gsdatadir)/Resou
rce/Font:$(gsdir)/fonts:@fontpath@$                                          
GS_CACHE_DIR="~/.ghostscript/cache/"$                                        
SEARCH_HERE_FIRST=0$                                                         
GS_INIT=gs_init.ps$                                                          
GENOPT=$                                                                     
CAPOPT= @HAVE_MKSTEMP@ @HAVE_FILE64@ @HAVE_MKSTEMP64@ @HAVE_FONTCONFIG@ @HAVE
_LIBIDN@ @HAVE_SETLOCALE@ @HAVE_SSE2@ @HAVE_DBUS@ @HAVE_BSWAP32@ @HAVE_BYTESW
AP_H@$                                                                      
GS=@GS@@EXEEXT@$                                                            
DEBUGDIRPREFIX=debug$                                                       
MEMENTODIRPREFIX=mem$                                                       
PGDIRPREFIX=pg$                                                             
FT_BRIDGE=@FT_BRIDGE@$                                                      
SHARE_FT=@SHARE_FT@$                                                        
FTSRCDIR=@FTSRCDIR@$                                                        
FT_CFLAGS=@FT_CFLAGS@$                                                      
FT_LIBS=@FT_LIBS@$                                                          
FT_CONFIG_SYSTEM_ZLIB=@FT_SYS_ZLIB@$                                        
@INSERT_UFST_BRIDGE_EQUAL_ONE@$                                             
UFST_ROOT=@UFST_ROOT@$                                                      
UFST_LIB_EXT=@UFST_LIB_EXT@$                                                
UFST_ROMFS_ARGS?=-b \$                                                       
 -P $(UFST_ROOT)/fontdata/mtfonts/pcl45/mt3/ -d fontdata/mtfonts/pcl45/mt3/ p
cl___xj.fco plug__xi.fco wd____xh.fco \$                                     
 -P $(UFST_ROOT)/fontdata/mtfonts/pclps2/mt3/ -d fontdata/mtfonts/pclps2/mt3/
 pclp2_xj.fco \$                                                             
 -c -P $(PSSRCDIR)/../lib/ -d Resource/Init/ FAPIconfig-FCO$                 
UFSTROMFONTDIR=\"%rom%fontdata/\"$                                           
UFSTDISCFONTDIR?=\"$(UFST_ROOT)/fontdata/\"$                                 
UFST_CFLAGS=@UFST_CFLAGS@$                                                   
JSRCDIR=@LIBJPEGDIR@$                                                        
SHARE_JPEG=@SHARE_LIBJPEG@$                                                  
JPEG_NAME=jpeg$                                                              
SHARE_LIBPNG=@SHARE_LIBPNG@$                                                 
PNGSRCDIR=@LIBPNGDIR@$                                                       
LIBPNG_NAME=png$                                                            
SHARE_LIBTIFF=@SHARE_LIBTIFF@$                                              
TIFFSRCDIR=@LIBTIFFDIR@$                                                    
TIFFPLATFORM=unix$                                                          
TIFFCONFIG_SUFFIX=$                                                         
LIBTIFF_NAME=tiff$                                                          
SHARE_ZLIB=@SHARE_ZLIB@$                                                    
ZSRCDIR=@ZLIBDIR@$                                                          
ZLIB_NAME=z$                                                                
JBIG2_LIB=@JBIG2_DECODER@$                                                  
SHARE_JBIG2=@SHARE_JBIG2@$                                                  
JBIG2SRCDIR=@JBIG2DIR@$                                                     
JBIG2_CFLAGS=@JBIG2_AUTOCONF_CFLAGS@$                                       
JPX_LIB=@JPX_DECODER@$                                                      
SHARE_JPX=@SHARE_JPX@$                                                      
JPXSRCDIR=@JPXDIR@$                                                         
JPX_CFLAGS=@JPX_AUTOCONF_CFLAGS@$                                           
ICCSRCDIR=icclib$                                                           
SHARE_LCMS=@SHARELCMS@$                                                     
LCMSSRCDIR=@LCMSDIR@$                                                       
LCMS2SRCDIR=@LCMS2DIR@$                                                     
LCMS_CFLAGS=@LCMS_ENDIAN@$                                                  
LCMS2_CFLAGS=@LCMS2_ENDIAN@$                                                
WHICH_CMS=@WHICHLCMS@$                                                      
SHARE_IJS=@SHAREIJS@$                                                       
IJS_NAME=@IJSLIB@$                                                          
IJSSRCDIR=@IJSDIR@$                                                         
IJSEXECTYPE=unix$                                                           
SHARE_LCUPS=@SHARELCUPS@$                                                   
LCUPS_NAME=cups$                                                            
LCUPSSRCDIR=cups$                                                           
LCUPSBUILDTYPE=@LCUPSBUILDTYPE@$                                            
CUPS_CC=$(CC)$                                                              
SHARE_LCUPSI=@SHARELCUPSI@$                                                 
LCUPSI_NAME=cupsimage$                                                      
LCUPSISRCDIR=cups$                                                          
CUPS_CC=$(CC)$                                                              
AR=ar$                                                                      
ARFLAGS=qc$                                                                 
RANLIB=@RANLIB@$                                                            
CC=@CC@$                                                                    
CCAUX=@CC@$                                                                 
CCLD=$(CC)$                                                                
CCAUXLD=$(CCAUX)$                                                          
GCFLAGS=@CPPFLAGS@ @GCFLAGS@ @CFLAGS@$                                     
CFLAGS_STANDARD=@OPT_CFLAGS@$                                              
CFLAGS_DEBUG=@DBG_CFLAGS@$                                                 
CFLAGS_PROFILE=-pg @OPT_CFLAGS@$                                           
CFLAGS_SO=@DYNAMIC_CFLAGS@$                                                
AC_CFLAGS=@DYNAMIC_FLAGS@$                                                 
FONTCONFIG_CFLAGS=@FONTCONFIG_CFLAGS@$                                     
FONTCONFIG_LIBS=@FONTCONFIG_LIBS@$                                         
DBUS_CFLAGS=@DBUS_CFLAGS@$                                                 
DBUS_LIBS=@DBUS_LIBS@$                                                     
ACDEFS=@DEFS@$                                                             
CFLAGS=$(CFLAGS_STANDARD) $(GCFLAGS) $(AC_CFLAGS) $(XCFLAGS)$              
AC_LDFLAGS=@X_LDFLAGS@$                                                     
LDFLAGS=@LDFLAGS@ $(AC_LDFLAGS) $(XLDFLAGS)$                                
EXTRALIBS=$(XTRALIBS) @LIBS@ @DYNAMIC_LIBS@ @FONTCONFIG_LIBS@ @FT_LIBS@$    
STDLIBS=@PTHREAD_LIBS@ -lm$                                                 
XINCLUDE=@X_CFLAGS@$                                                        
XLIBDIRS=@X_LDFLAGS@$                                                       
XLIBDIR=$                                                                   
XLIBS=@X_LIBS@$                                                             
SYNC=@SYNC@$                                                                
RM=rm -f$                                                                   
SOC_CFLAGS^I=^I@SOC_CFLAGS@$                                                
SOC_LIBS^I=^I@SOC_LIBS@$                                                    
SOC_LOADER^I=^I@SOC_LOADER@$                                                
FEATURE_DEVS=$(PSD)psl3.dev $(PSD)pdf.dev $(PSD)dpsnext.dev $(PSD)ttfont.dev
$(PSD)epsf.dev $(GLD)pipe.dev $(GLD)gsnogc.dev $(GLD)htxlib.dev $(PSD)fapi.de
v @JBIG2DEVS@ @JPXDEVS@ @UTF8DEVS@$                                          
FEATURE_DEVS_ALL=$(PSD)psl3.dev $(PSD)pdf.dev $(PSD)dpsnext.dev $(PSD)ttfont.
dev $(PSD)rasterop.dev $(PSD)double.dev $(PSD)trapping.dev $(PSD)stocht.dev $
(GLD)pipe.dev $(GLD)gsnogc.dev $(GLD)htxlib.dev @JBIG2DEVS@ @JPXDEVS@ @UTF8DE
VS@$                                                                         
RESOURCE_LIST=Resource/CMap/ Resource/ColorSpace/ Resource/Decoding/ Resource
/Font/ Resource/ProcSet/ Resource/IdiomSet/ Resource/CIDFont/$               
BAND_LIST_STORAGE=file$                                                      
BAND_LIST_COMPRESSOR=zlib$                                                   
FILE_IMPLEMENTATION=stdio$                                                   
STDIO_IMPLEMENTATION=c$                                                      
GS_DEV_DEFAULT="x11alpha bbox"$                                              
DISPLAY_DEV=$(DD)bbox.dev$                                                   
DEVICE_DEVS=$(DISPLAY_DEV) @X11_DEVS@$                                      
DEVICE_DEVS1=@F_DEVS@$                                                      
DEVICE_DEVS2=@P_DEVS@$                                                      
DEVICE_DEVS3=@CUPS_DEVS@$                                                   
DEVICE_DEVS4=@IJS_DEVS@$                                                    
DEVICE_DEVS5=@OMNIDEVS@$                                                    
DEVICE_DEVS6=@PNG_DEVS@$                                                    
DEVICE_DEVS7=@JBIG2_DEVS@$                                                  
DEVICE_DEVS8=@SVG_DEVS@$                                                    
DEVICE_DEVS9=$                                                              
DEVICE_DEVS10=$                                                             
DEVICE_DEVS11=$                                                             
DEVICE_DEVS12=$                                                             
DEVICE_DEVS13=$                                                             
DEVICE_DEVS14=$                                                             
DEVICE_DEVS15=$                                                             
DEVICE_DEVS16=$                                                             
DEVICE_DEVS17=$                                                             
DEVICE_DEVS18=$                                                             
DEVICE_DEVS19=$                                                             
DEVICE_DEVS20=$                                                             
DEVICE_DEVS21=$                                                             
GS_SHARED_OBJS=@DYNAMIC_DEVS@$                                              
MAKEFILE=Makefile$                                                          
TOP_MAKEFILES=$(MAKEFILE) $(GLSRCDIR)/unixhead.mak$                         
AK=$                                                                        
CCFLAGS=$(GENOPT) $(CAPOPT) $(CFLAGS)$                                      
CC_=$(CC) $(CCFLAGS)$                                                       
CCAUX_=$(CCAUX) $(CFLAGS)$                                                  
CC_LEAF=$(CC_)$                                                             
CC_LEAF_PG=$(CC_)$                                                          
CC_NO_WARN=$(CC_)$                                                          
CCAUX_NO_WARN=$(CCAUX_)$                                                    
CC_SHARED=$(CC_) @DYNAMIC_CFLAGS@$                                          
LD_SET_DT_SONAME=@SET_DT_SONAME@$                                           
FOR_MAC=@SO_FOR_MAC@$                                                       
MAKEDIRS=| directories$                                                     
MAKEDIRSTOP=$                                                               
INSTALL_CONTRIB=@INSTALL_CONTRIB@$                                          
include $(GLSRCDIR)/unixhead.mak$                                           
include $(GLSRCDIR)/gs.mak$                                                 
include $(PSSRCDIR)/psromfs.mak$                                            
include $(GLSRCDIR)/lib.mak$                                                
include $(PSSRCDIR)/int.mak$                                                
include $(GLSRCDIR)/freetype.mak$                                           
include $(GLSRCDIR)/jpeg.mak$                                               
include $(GLSRCDIR)/zlib.mak$                                               
include $(GLSRCDIR)/png.mak$                                                
include $(GLSRCDIR)/tiff.mak$                                               
include $(GLSRCDIR)/jbig2.mak$                                              
include $(GLSRCDIR)/jasper.mak$                                             
include $(GLSRCDIR)/ldf_jb2.mak$                                            
include $(GLSRCDIR)/lwf_jp2.mak$                                            
include $(GLSRCDIR)/openjpeg.mak$                                           
include $(GLSRCDIR)/icclib.mak$                                             
include $(GLSRCDIR)/$(WHICH_CMS).mak$                                       
include $(GLSRCDIR)/ijs.mak$                                                
@LCUPSINCLUDE@$                                                             
@LCUPSIINCLUDE@$                                                            
include $(GLSRCDIR)/devs.mak$                                               
include $(GLSRCDIR)/contrib.mak$                                            
include $(GLSRCDIR)/unix-aux.mak$                                           
include $(GLSRCDIR)/unixlink.mak$                                           
include $(GLSRCDIR)/unix-dll.mak$                                           
include $(GLSRCDIR)/unix-end.mak$                                           
include $(GLSRCDIR)/unixinst.mak$                                           
@CONTRIBINCLUDE@$                                                           
@CUPSINCLUDE@$                                                              
distclean : clean config-clean soclean pgclean debugclean$                  
^I-$(RM_) -r $(BINDIR) $(GLOBJDIR) $(PSOBJDIR) $(AUXDIR)$                   
^I-$(RM_) -r autom4te.cache$                                                 
^I-$(RM_) config.log config.status$                                          
^I-$(RM_) Makefile$                                                          
^I@-rmdir $(BINDIR) $(GLOBJDIR) $(PSOBJDIR)$                                 
^I-$(RM_) $(TIFFSRCDIR)$(D)libtiff$(D)tif_config.h $(TIFFSRCDIR)$(D)libtiff$(
D)tiffconf.h$                                                                
debug-clean : debugclean$                                                    
memento-clean : mementoclean$                                                
maintainer-clean : distclean$                                                
^I-$(RM_) configure.ac$                                                      
^I-$(RM_) configure$                                                         
^I-$(RM_) Makefile.in$                                                       
check : default$                                                             
^I$(NO_OP)$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:41:31.340

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-24T07:05:48.507

gmake 很可能不进行任何字符转换，因此它只读取原始 EBCDIC。

检查 IFS 文件上的 CCSID 是否为 819。

（我创建空文件的常用技巧是`touch -C 819 file`. 另外，如果可能在本机 AIX 上编译）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T16:45:57.610

环境变量 BUILDDIRPREFIX 的值是多少？它应该以'/'结尾吗？

# c# - 选项卡按钮变为禁用

> ID：10213606
> 
> 赞同：0
> 
> 时间：2012-04-18T16:18:00.137
> 
> 标签：c#, asp.net, wpf

我有一个 C# WPF 应用程序，顶部有一些按钮可以执行表查找或维护等功能：

```
 <Border Grid.Row="0" CornerRadius="5" BorderBrush="AliceBlue" Margin="10" VerticalAlignment="Top" >
        <StackPanel Orientation="Horizontal" Height="35" >
            <Button Content="Upload File" Margin="0,0,3,0" Command="{Binding CmdUploadFileCtrl}" Width="100"></Button>
            <Button Content="Medicine Price" Margin="0,0,3,0" Command="{Binding CmdMedicinePriceCtrl}" Width="100"></Button>
            <Button Content="NDC Discounts" Margin="0,0,3,0" Command="{Binding CmdNDCDiscountCtrl}" Width="100"></Button>
            <Button Content="Facility" Margin="0,0,3,0" Command="{Binding CmdFacilityCtrl}" Width="100"></Button>
        </StackPanel>
    </Border> 
```

* * *

```
<sdk:DataGrid 
                        Grid.Row="1"  x:Name="dgFacility" 
                        SelectionMode="Single"
                        SelectedItem="{Binding Path=SelectedItemFacility, Mode=TwoWay}"
                        ItemsSource="{Binding Path=LstFacility, Mode=TwoWay}" 
                        AutoGenerateColumns="False"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch" 
                        AllowDrop="False"> 
```

当用户按下 Facility 选项卡时，它会转到那里，但是当尝试“上传文件”时，该按钮被禁用。我怎样才能防止这种禁用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:37:17.650

由于按钮绑定到命令，因此应该有代码（某处）确定何时启用/禁用按钮。

根据使用的命令类型，您可能有一个名为 CanUploadFileCtrl 或 CmdUploadFileCtrl_CanExecute 的方法，它返回 true/false。

# php - 性能方面：拥有许多小的 ajax php 控制器脚本还是一个大的更好？

> ID：10213611
> 
> 赞同：0
> 
> 时间：2012-04-18T16:18:07.317
> 
> 标签：php, javascript, ajax, performance

**在速度/性能方面哪个更好？**

拥有一个大型 Ajax PHP 控制器脚本，其中包含用于多个不同调用的所有 php 函数。

或者

拥有许多只包含每个单独调用所需的 php 函数的小型 Ajax PHP 控制器脚本。

我在考虑性能和效率。

干杯，乔

编辑:: 只是为了添加更多信息，在一个脚本上拥有所有功能不会减少 ajax 请求的数量。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:42:16.517

如果你在一个文件中有一堆 PHP 函数，每次发出 AJAX 请求时都会调用它，它看起来像这样（我在假设）：

```
$func = $_GET['function'];

switch($func)
{
    //pick the function to call here
}

function test01() {
    //some stuff
}

function test02() {
    //some stuff
}

// 100 more such functions 
```

这肯定会更慢（尽管可能不是很明显）。单个大文件中的额外开销：

*   解析更大的文件需要更长的时间
*   为了知道调用哪个 PHP 函数，需要评估 switch 语句。

此外，维护更大的文件可能会更加困难。我通常使用单动作 PHP 脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:27:27.773

从我读过的信息来看，最好（性能方面）尽量减少客户端浏览器必须发送的请求数量。我建议将所有功能放在一个脚本中。

# ruby-on-rails - 在非 Rails Ruby 应用程序中包含 Rails 时间助手

> ID：10213616
> 
> 赞同：7
> 
> 时间：2012-04-18T16:18:26.633
> 
> 标签：ruby-on-rails, ruby, activesupport

我主要使用 Rails 进行开发，我喜欢Rails 内置的`1.hour.from_now`,`34.minutes`和helpers。`24.megabytes`但是现在我正在构建一个具有这些帮助程序的 Ruby 应用程序会很好。是否有可能只在 Ruby 应用程序中获取这些帮助程序而无需引入整个 Rails 框架？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-18T16:27:23.017

这些方法来自[ActiveSupport 的核心扩展](https://github.com/rails/rails/tree/master/activesupport/lib/active_support/core_ext)（特别是在 Integer & Numeric 上的），所以你可以只需要它们：

```
require 'active_support/core_ext/integer/time'
require 'active_support/core_ext/numeric/time' 
```

或者，如果您想要 ActiveSupport 提供的所有核心扩展：

```
require 'active_support/core_ext' 
```

或者，如果您想要所有 ActiveSupport（包括核心扩展）：

```
require 'active_support/all' 
```

当然，您必须确保已安装[`activesupport`gem](http://rubygems.org/gems/activesupport)。

# jquery - 如何检查一个选项是否被选中？

> ID：10213620
> 
> 赞同：165
> 
> 时间：2012-04-18T16:18:32.973
> 
> 标签：jquery, html-select

```
$('#mySelectBox option').each(function() {
    if ($(this).isChecked())
       alert('this option is selected');
     else
       alert('this is not');
}); 
```

显然，这`isChecked`不起作用。所以我的问题是这样做的正确方法是什么？谢谢。

* * *

## 回答 #1

> 赞同：292
> 
> 时间：2012-04-18T16:20:08.280

**更新**

对所选选项更直接的 jQuery 方法是：

```
var selected_option = $('#mySelectBox option:selected'); 
```

回答这个问题`.is(':selected')`就是你要找的：

```
$('#mySelectBox option').each(function() {
    if($(this).is(':selected')) ... 
```

非 jQuery（可以说是最佳实践）的方法是：

```
$('#mySelectBox option').each(function() {
    if(this.selected) ... 
```

虽然，如果您只是在寻找选定的值，请尝试：

```
$('#mySelectBox').val() 
```

如果您正在查找所选值的文本，请执行以下操作：

```
$('#mySelectBox option').filter(':selected').text(); 
```

查看：[http ://api.jquery.com/selected-selector/](http://api.jquery.com/selected-selector/)

下次寻找重复的 SO 问题：

[获取当前选定选项](https://stackoverflow.com/questions/8809265/get-current-selected-option) 或 [设置选定选项](https://stackoverflow.com/questions/10102252/set-selected-option) 或 [如何在 jQuery 中获取 $(this) 选定选项？](https://stackoverflow.com/questions/10011802/how-to-get-this-selected-option-in-jquery) 或 [选项 [selected=true] 不起作用](https://stackoverflow.com/questions/8974250/optionselected-true-doesnt-work)

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-04-18T16:23:03.887

您可以通过以下方式获取所选选项：

```
$('#mySelectBox option:selected')... 
```

[**现场演示**](http://jsfiddle.net/4tL6K/)

但是，如果您想迭代所有选项，请使用`this.selected`而不是`this.isChecked`which 不存在：

```
$('#mySelectBox option').each(function() {
    if (this.selected)
       alert('this option is selected');
     else
       alert('this is not');
}); 
```

[**现场演示**](http://jsfiddle.net/4tL6K/1/)

**更新：**

你有很多答案建议你使用这个：

`$(this).is(':selected')`好吧，它可以更快更容易地完成，`this.selected`那么为什么要使用它而不是原生 DOM 元素方法呢？！

阅读[标签信息](https://stackoverflow.com/tags/jquery/info)中的**Know Your DOM Properties and Functions**`jQuery`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-04-18T16:25:12.037

如果您不熟悉或不熟悉`is()`，您可以检查 的值`prop("selected")`。

[如此处所示](http://jsfiddle.net/upqZh/)：

```
$('#mySelectBox option').each(function() {
    if ($(this).prop("selected") == true) {
       // do something
    } else {
       // do something
    }
});​ 
```

**编辑**：

正如@gdoron 在评论中指出的那样，访问选项的 selected 属性的更快和最合适的方法是通过 DOM 选择器。这是显示此操作的小提琴[更新。](http://jsfiddle.net/upqZh/1/)

```
if (this.selected == true) { 
```

似乎也能正常工作！谢谢格多伦。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-08-18T06:41:57.060

您可以通过 jquery 使用这种方式：

```
$(document).ready(function(){
 $('#panel_master_user_job').change(function () {
 var job =  $('#panel_master_user_job').val();
 alert(job);
})
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<select name="job" id="panel_master_user_job" class="form-control">
                                    <option value="master">Master</option>
                                    <option value="user">User</option>
                                    <option value="admin">Admin</option>
                                    <option value="custom">Custom</option>
                                </select>
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-18T16:30:32.110

采用

```
 $("#mySelectBox option:selected"); 
```

测试它是否是一个特定的选项`myoption`：

```
 if($("#mySelectBox option:selected").text() == myoption){
          //...
 } 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-11-30T06:42:08.500

将此视为您的选择列表：

```
<select onchange="var optionVal = $(this).find(':selected').val(); doSomething(optionVal)">

                                <option value="mostSeen">Most Seen</option>
                                <option value="newst">Newest</option>
                                <option value="mostSell">Most Sell</option>
                                <option value="mostCheap">Most Cheap</option>
                                <option value="mostExpensive">Most Expensive</option>

                            </select> 
```

然后你检查选择的选项是这样的：

```
function doSomething(param) {

    if ($(param.selected)) {
        alert(param + ' is selected!');
    }

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-10-05T00:10:08.477

如果您需要检查**特定值**的选项选择状态：

```
$('#selectorId option[value=YOUR_VALUE]:selected') 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-06-04T11:58:10.943

就我而言，我不知道为什么 selected 总是正确的。所以我能想到的唯一方法是：

```
var optionSelected = false;
$( '#select_element option' ).each( function( i, el ) {
    var optionHTMLStr = el.outerHTML;

    if ( optionHTMLStr.indexOf( 'selected' ) > 0 ) {
        optionSelected = true;
        return false;
    }
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-23T10:01:17.317

如果您只想检查是否选择了一个选项，那么您不需要遍历所有选项。做就是了

```
if($('#mySelectBox').val()){
    // do something
} else {
    // do something else
} 
```

注意：如果您希望选择 value=0 的选项，则需要将 if-condition 更改为`$('#mySelectBox').val() != null`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-02-02T17:36:26.947

**如果您想通过 javascript 检查选定的选项**

最简单的方法是在该标记中添加 onchange 属性并在 js 文件中定义一个函数，如果您的 html 文件有类似这样的选项，请参见示例

```
 <select onchange="subjects(this.value)">
               <option>Select subject</option>
               <option value="Computer science">Computer science</option>
               <option value="Information Technolgy">Information Technolgy</option>
               <option value="Electronic Engineering">Electronic Engineering</option>
               <option value="Electrical Engineering">Electrical Engineering</option>
 </select> 
```

现在在js文件中添加函数

```
function subjects(str){
    console.log(`selected option is ${str}`);
} 
```

**如果要检查 php 文件中的选定选项**

只需在您的标签中提供 name 属性并访问它 php 文件全局变量 /array ($_GET 或 $_POST) 如果您的 html 文件是这样的，请参见示例

```
<form action="validation.php" method="POST">
             Subject:<br>
            <select name="subject">
               <option>Select subject</option>
               <option value="Computer science">Computer science</option>
               <option value="Information Technolgy">Information Technolgy</option>
               <option value="Electronic Engineering">Electronic Engineering</option>
               <option value="Electrical Engineering">Electrical Engineering</option>
            </select><br>

         </form> 
```

在您的 php 文件 validation.php 中，您可以像这样访问

```
$subject = $_POST['subject'];
echo "selected option is $subject"; 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-07T10:46:15.133

```
var selectedOption = $("option:selected", #selectIdentifier)

<select id="selectIdentifier">
<option>1</option>
<option>2</option>
<option selected="selected">3</option>
</select> 
```

编辑：这个答案是有效的，并且避免了 jQuery 的宗教战争。这个答案的关键是`:selected`。要回答实际问题，OP 需要在选项之间创建一些区别，以便能够查询天气，选择了特定选项。例如，选项本身的 id、data-、value 等装饰。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-02-01T13:10:22.607

你也可以在 CSS 中做一个双属性选择器

`$('[value="your_value"][selected="selected"]')`

选择“your_value”选择：

```
if( $('[value="your_value"][selected="selected"]') ) {
  // do something
} 
```

# web-services - 每次调用 Web 服务时自动传递一个 cookie

> ID：10213625
> 
> 赞同：3
> 
> 时间：2012-04-18T16:18:59.773
> 
> 标签：web-services, soap, jax-ws

我有一个独立的网络服务客户端。当调用任何 web 方法时，必须将附加的“cookie”字符串**隐式**（而不是作为 web 方法参数）传递给 WS。另一端的 WS 必须能够获取字符串并使用它。如何做到这一点？

我通过以下方式调用服务：

```
Service srv = Service.create(new URL(WSDL), QNAME);
myClassPort = srv.getPort(MyClass.class); 
```

我需要在第一行之前放置一些代码，这样每次我通过 myClassPort 调用一些远程方法时，客户端都会发送这个“cookie”字符串。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T16:44:30.513

By default `JAX-WS` web services and clients are stateless. When a client makes a request, the server responds and sets a cookie on the connection, if it participates in a session. But, the `JAX-WS` client ignores that cookie and the server treats subsequent requests as new interaction. When the session is enabled, `JAX-WS` client sends the same cookie with each subsequent request so that server can keep track of the client session.

So you should not be using either cookies or HTTP sessions with web services. Return a token ID as part of the response; then the client can send that along with the next request.

Anyway:

JAX-WS web service clients must be configured to maintain session information (such as cookies), using the `javax.xml.ws.session.maintain` property. Other web service stacks may have similar mechanisms.

**On the Server Side**

JAX-WS uses some handy annotations defined by *Common Annotations for the Java Platform* ([JSR 250](http://www.jcp.org/en/jsr/detail?id=250)), to inject the web service context and declaring lifecycle methods. `WebServiceContext` holds the context information pertaining to a request being served.

You don't need to implement `javax.xml.rpc.server.ServiceLifecycle`. With `JAX-WS` Web Service all you need to do is mark a field or method with `@Resource`. The type element MUST be either `java.lang.Object` or `javax.xml.ws.WebServiceContext`.

```
@WebService
public class HelloWorld {
    @Resource
    private WebServiceContext wsContext;
    public void sayHello(){
        MessageContext mc = wsContext.getMessageContext();
        HttpSession session = ((javax.servlet.http.HttpServletRequest)mc.get(MessageContext.SERVLET_REQUEST)).getSession();

     }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-20T19:39:47.263

这个问题有一些误导性的答案，所以我将尝试强调当前的最佳实践。这些建议中的大多数都是 OWASP 安全指南的一部分，我强烈建议任何从事 Web 开发工作的人进行审查。

1) 始终使用临时（会话范围）cookie。

2) 所有cookies都应该受到保护和加密。

3) 不要在请求有效载荷中传递令牌

4) 对于任何返回可能被发送回服务器的数据的请求，请在您的响应中包含一个随机数（单次使用令牌）。

5) 后面的请求应该（必须）包括 nonce 和 cookie

同样，我的建议是查看 OWASP 指南并相应地进行。您可能想考虑使用服务提供商进行身份验证 - 这比自己制作解决方案要聪明得多，因为实际上有一百万个细节都必须正确。Auth0.com 就是其中之一。

# c# - 参数属性不显示

> ID：10213628
> 
> 赞同：0
> 
> 时间：2012-04-18T16:19:05.960
> 
> 标签：c#, custom-attributes

我正在做一个审计工作，并试图使用属性将参数标记为应记录在审计中以获取更多信息的方法。但是，无论出于何种原因，我似乎无法检查该属性是否存在。

我的代码：

```
 [Audit(AuditType.GetReport)]
  public Stream GetReportStream([AuditParameter] Report report)
  {
     ...
  }

  [AttributeUsage(AttributeTargets.Parameter)]
  public class AuditParameterAttribute : Attribute
  {
  } 
```

而且，在我试图获取它的拦截器内部：

```
foreach (ParameterInfo param in invocation.Method.GetParameters ())
{
   var atts = CustomAttributeData.GetCustomAttributes (param);
   if (param.IsDefined (typeof(AuditParameterAttribute), false))
   {
      attributes.Add (param.Name, invocation.Arguments[param.Position].ToString ());
   }
} 
```

我开始添加一些额外的调用来尝试让某些东西起作用；这就是为什么额外`var atts`的东西在那里。该`invocation`变量包含有关所调用方法的信息，并且我能够从中获取表示参数的 ParameterInfo 对象。但是，无论我尝试了什么，我都无法从中获得任何自定义属性。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T18:17:22.847

知道了。原来这是我使用 Castle 缺乏经验的问题。我意识到它正在通过基于被调用类接口的代理，该类没有我正在寻找的属性。因此，将我的代码更改为：

```
foreach (ParameterInfo param in invocation.MethodInvocationTarget.GetParameters ())
{
   if (param.IsDefined (typeof(AuditParameterAttribute), false))
   {
      attributes.Add (param.Name, invocation.Arguments[param.Position].ToString ());
   }
} 
```

使用 MethodInvocationTarget 而不是 Method 解决了这个问题。

# c# - C# 在单独的线程中连接到数据库

> ID：10213631
> 
> 赞同：6
> 
> 时间：2012-04-18T16:19:19.167
> 
> 标签：c#, sql-server, database, multithreading

我有一个应用程序位于任务栏中并定期检查数据库（通过 SQLConnection）。如果数据库无法访问，它只会在通知图标上显示红色状态，而不是其他任何内容。这是因为用户将使用笔记本电脑在设施之间旅行，并且数据库只能在内部网络上或通过 VPN 连接时访问。

我遇到的问题是，当数据库无法访问时，我仍然希望通知图标上下文菜单能够响应。当前，如果用户在数据库尝试连接时尝试与菜单交互，则线程会因连接尝试而被锁定。

我希望数据库连接发生在一个单独的线程中，但我知道在线程之间共享连接对象是一件坏事。连接数据库后，我需要从原始线程中查询它。有什么好的方法可以做到这一点吗？

我知道我可以有一个在新线程中运行的函数并简单地检查连接是否失败，然后如果返回成功，则原始线程可以继续并连接它自己的数据库对象。但这种方法似乎是一个糟糕的解决方法。想法？

谢谢！

* * *

感谢您的建议 - 我从他们那里学到了很多东西。最后，我做了我从一开始就应该做的事情。每当需要定期更新数据库时，主 (UI) 线程就会启动一个新线程（包括数据库对象创建和连接）。

因此，就像 HenkHolterman 在对我的原始消息的评论中建议的那样，我真的不需要创建数据库并在单独的线程中使用它运行操作。

一旦我升级到 VS2010，我肯定会对使用 SqlConnection.OpenAsync 感兴趣。

再次感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T18:24:44.727

A`SqlConnection`没有线程关联性要求，因此您可以在单独的线程上创建和打开它，并将引用传递回 UI 线程。只要您不从多个线程同时调用同一实例上的任何属性或方法，您就不会有任何问题。

使用`Task`类 (System.Threading.Task) 在后台启动此操作，然后调用`ContinueWith`以将实例的所有权转移回 UI 线程。

```
public class TrayIconForm : Form
{
  private SqlConnection connection = null;

  private void Form_Load(object sender, EventArgs args)
  {
    TaskScheduler ui = TaskScheduler.FromCurrentSynchronizationContext();

    Task.Factory.StartNew(() =>
      {
        var sql = new SqlConnection();
        sql.ConnectionString = "your connection string";
        sql.Open();
        return sql;
      }).ContinueWith((task =>
      {
        connection = task.Result;
        // You can access other UI elements here as needed.
      }), ui);
  }
} 
```

使用将在 C# 5.0 中引入且现在可通过 Async CTP 使用的新关键字`async`和`await`关键字，您可以执行此操作。

```
private async void Form_Load(object sender, EventArgs args)
{
  connection = await Task.Run(() =>   // TaskEx.Run in the CTP
    {
      var sql = new SqlConnection();
      sql.ConnectionString = "your connection string";
      sql.Open();
      return sql;
    });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:22:16.393

我建议使用新的[C# Async CTP。](http://www.microsoft.com/download/en/details.aspx?displaylang=en&id=9983) 这将允许您留在 UI 线程上，从而降低复杂性。

[SqlConnection.OpenAsync](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.openasync%28v=VS.110%29.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:21:18.730

使用[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)对象应该以一种简单的方式解决您的问题，但更准确地说，您希望使用线程来尝试打开连接，让 UI 线程准备好接收用户输入。

# html - 使用 CSS3 对折页进行内容剪切

> ID：10213632
> 
> 赞同：1
> 
> 时间：2012-04-18T16:19:20.040
> 
> 标签：html, mobile, css, overflow

我有一个我正在设计的小型网络应用程序，但我遇到了一个非常奇怪的问题。内部内容将始终在页面折叠下方剪切 - 您无法向下滚动以阅读所有文本。我已经在 Mobile Safari 和 Chrome/Firefox 的桌面上尝试过这个，但没有成功。

实时 URL 是[http://byjakewithlove.com/code/mobile-webapp/](http://byjakewithlove.com/code/mobile-webapp/)

我可以尝试的任何建议都会有很大帮助。我基本上有 ID 为**#content**的 div ，它包含白色的 BG 和页面文本。我有`overflow: auto;`哪个应该在这个 div 中创建滚动条，甚至有`height: 100%;`. 我对问题是什么感到完全困惑 - 再次提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:03:04.143

您可以保留内容`height: 100%`元素上`relative`的`padding`标题的高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:54:28.253

被`height: 100%`误用 - “100%”指的是容器的高度，所以它是为父级计算的，因此导致了这种行为。

只需省略`height: 100%`声明并设置固定高度。

# .net - 将图像从 iPhone 上传到 .net ashx 处理程序

> ID：10213634
> 
> 赞同：1
> 
> 时间：2012-04-18T16:19:24.587
> 
> 标签：.net, ios, xcode, upload, image-upload

我正在使用接收图像的 ashx 脚本将图像从 iPhone 上传到我的服务器。我遇到的问题是，无论我尝试过什么， context.Request.Files 都是空的。

这是我的xcode代码

```
NSData *imageData = [[appDelegate currentProjectData] objectForKey:@"frontImage"];

NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://www.****.com/iPhoneJpgUploadHandler.ashx"]];
[request setHTTPMethod:@"POST"];
NSString *boundary = @"- - - - - - - - - - Boundary String - - - - - - - - - -";
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundary];
[request addValue:contentType forHTTPHeaderField:@"Content-Type"];

NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[@"Content-Disposition: form-data; name=\"userfile\"; filename=\"iphoneimage.jpg\"\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[@"Content-Type: application/octet-stream\r\n\r\n" dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:imageData]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n", boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[request setHTTPBody:body];
[request addValue:[NSString stringWithFormat:@"%d", [imageData length]] forHTTPHeaderField:@"Content-Length"];

NSData *returnData = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];
NSString *returnString = [[NSString alloc] initWithData:returnData encoding:NSUTF8StringEncoding];
NSLog(@"%@", returnString); 
```

这是我上传脚本中的代码

```
public void ProcessRequest (HttpContext context) {
    string uploadDir = "C:\\";

    if(context.Request.Files.Count > 0) {
        HttpPostedFile file = context.Request.Files[0];
        file.SaveAs(Path.Combine(uploadDir, file.FileName));
        context.Response.Write("success");
    } else {
        context.Response.Write("fail");
    }
} 
```

xcode 中的 nslog 写出“失败”，因此它正在运行脚本并返回。我没有收到任何错误。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T14:13:52.580

所以我让它工作。我改变的只是边界字符串

```
NSString *boundary = @"- - - - - - - - - - Boundary String - - - - - - - - - -"; 
```

对此

```
NSString *boundary = @"xxxxBoundaryStringxxxx"; 
```

我读过的只是说它必须是一个在其余帖子数据中不存在的字符串。我不知道我的第一个字符串如何具有，但可能还有其他我不知道的规定。无论哪种方式，它现在都有效。

# pthreads - 在 MingW 下编译简单的 pthread 代码时出现链接器错误

> ID：10213635
> 
> 赞同：6
> 
> 时间：2012-04-18T16:19:39.113
> 
> 标签：pthreads, mingw

我正在尝试编译单个 c++ 源文件 test.cpp，它有一个非常简单的代码来演示 pthread_create(); pthread_cond_signal/pthread_cond_wait() 功能。

我已经在我工作的 Windows XP 上安装了 Mingw / Ansys。在 MingW 提示符中，我执行以下操作：

```
g++ -IC:/MinGW/include/ -lpthread test.cpp 
//-IC:/MinGW/include to get pthread.h
//-LC:/MinGW/bin to get pthreadGC2.dll 
```

该 cpp 包括 pthread.h 为：

```
#include <pthread.h> 
```

但这给了我所有 pthread 库函数的多个链接器未定义的引用错误。

我在这里做错了什么。是否可以在 Windows 上的 MingW 环境中构建 pthread 代码？

如何解决此错误？

```
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x23): undefined reference to `_imp__pthread_mutex_lock'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x67): undefined reference to `_imp__pthread_cond_signal'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x75): undefined reference to `_imp__pthread_mutex_unlock'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x98): undefined reference to `_imp__pthread_exit'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0xbc): undefined reference to `_imp__pthread_mutex_lock'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0xe8): undefined reference to `_imp__pthread_cond_wait'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x10f): undefined reference to `_imp__pthread_mutex_unlock'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x135): undefined reference to `_imp__pthread_exit'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x153): undefined reference to `_imp__pthread_attr_init'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x169): undefined reference to `_imp__pthread_mutex_init'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x17f): undefined reference to `_imp__pthread_attr_setdetachstate'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x195): undefined reference to `_imp__pthread_cond_init'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x1bc): undefined reference to `_imp__pthread_create'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x1e3): undefined reference to `_imp__pthread_create'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x201): undefined reference to `_imp__pthread_join'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x21f): undefined reference to `_imp__pthread_join'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x239): undefined reference to `_imp__pthread_mutex_destroy'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x247): undefined reference to `_imp__pthread_cond_destroy'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x255): undefined reference to `_imp__pthread_attr_destroy'
C:\DOCUME~1\ADESHP~1\LOCALS~1\Temp\ccUQhu7D.o:pthread_cond.c:(.text+0x263): undefined reference to `_imp__pthread_exit'
collect2: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-20T06:10:49.523

您需要在依赖库的文件之后的 gcc/g++ 命令行中指定库。所以试试：

```
g++ -IC:/MinGW/include/ test.cpp -lpthread 
```

当我偶然发现答案时，我踢了自己一脚（这是图书馆和 gcc 的常见问题解答）。对于大多数 gcc 选项顺序无关紧要，但对于库来说它很重要。

如果 pthread 库随您的 MinGW 发行版一起提供，则不必指定库路径（您似乎就是这种情况）。另外，请记住上面的命令行会生成一个`a.exe`可执行文件；通过`-o test.exe`以避免这种情况。

# c# - 我如何混合这样的颜色？

> ID：10213636
> 
> 赞同：1
> 
> 时间：2012-04-18T16:19:39.730
> 
> 标签：c#, colors, blending, mixing

我正在编写一个工具来帮助将新角色改装到游戏十字军之王 II 中，但我有点坚持给头发和胡须上色。

游戏以这样的纹理开始：

[![](../Images/2ea217d8751a9a6afad86b8c9884f1ed.png)](https://i.stack.imgur.com/7sRet.png)
[（来源：[serayen.com](http://serayen.com/ck2/bearduncoloured.png)）]

然后将其与三种颜色混合——阴影、底色和高光，例如：

*   黑暗：10、10、10
*   基数：125、85、56
*   亮点：255、255、255

结果是：

[![](../Images/24a880e4e210477f1a95dc3e73d85e05.png)](https://i.stack.imgur.com/SW7mt.png)
[（来源：[serayen.com](http://serayen.com/ck2/beardcoloured.png)）]

它使用什么样的混合方式？我将如何在 C# 中进行操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:46:33.273

决定将其作为完整的答案，因为它更易于格式化并在此处提供示例。

作为一种猜测，我会说它正在执行颜色乘法，根据像素的整体强度选择三种颜色中的哪一种来乘以像素，可能使用三者之间的线性插值。除非您知道构成乘法的暗像素、基本像素或高光像素的阈值，否则您将很难正确复制它。

所以我假设他们的算法是：

```
(pixel(x,y).color * dark.color * THRESHDARK - min(pixel(x,y).intensity, THRESHDARK) //dark blending + 
(pixel(x,y).color * base.color * (pixel(x,y).intensity - THRESHDARK) / (THRESHLIGHT-THRESHDARK)) //middle blending +
(pixel(x,y).color * highlight.color * pixel(x,y).intensity - THRESHLIGHT) //light blending 
```

或类似的东西。希望这可以帮助。

# c# - MVC 3 图片上传路径

> ID：10213638
> 
> 赞同：2
> 
> 时间：2012-04-18T16:19:48.457
> 
> 标签：c#, asp.net-mvc-3, image, path

我正在尝试上传图片和缩略图。

我已将 web.config 中的上传路径设置为`<add key="UploadPath" value="/Images"/>`

当我上传图像时，它会获取应用程序所在的硬盘驱动器和文件夹的完整路径|：

```
D:\Projects\Social\FooApp\FooApp.BackOffice\Images\image_n.jpg 
```

但我只想`/images/image_n.jpg`

我正在使用`Path.Combine`你认为这是原因吗？

我该如何解决这个问题？

这是代码|：\

```
foreach (var file in files)
                {
                    if (file != null && file.ContentLength > 0)
                    {
                        var fileName = Path.GetFileName(file.FileName);
                        if (fileName != null) originalFile = Server.MapPath(upload_path) + DateTime.Now.Ticks + "_ " + fileName;

                        file.SaveAs(originalFile); 

                        images.Add(originalFile);
                    }
                } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T16:36:37.293

您需要使用[HttpContext.Current.Server.MapPath](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx)。

> *返回与 Web 服务器上指定的虚拟路径相对应的物理文件路径。*

您的代码可能如下所示：

```
Path.Combine(HttpContext.Current.Server.MapPath("~/Images"), fileName); 
```

*编辑 - 我正在添加您在上面提供的代码。它看起来像这样。

```
foreach (var file in files)
{
    if (file != null && file.ContentLength > 0)
    {
        var fileName = Path.GetFileName(file.FileName);
        var uploadPath = "~/Images"; //This is where you would grab from the Web.Config. Make sure to add the ~

        if (fileName != null) {
            var originalFile = Path.Combine(HttpContext.Current.Server.MapPath(uploadPath), DateTime.Now.Ticks + "_ " + fileName);
            file.SaveAs(originalFile); 
            images.Add(originalFile);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:34:59.707

我假设此代码在您的一个控制器中。你有没有尝试过：

```
Server.MapPath(yourPath); 
```

# javascript - 区分IE7浏览器和IE7兼容模式下的浏览器

> ID：10213639
> 
> 赞同：14
> 
> 时间：2012-04-18T16:19:52.957
> 
> 标签：javascript, internet-explorer, compatibility, browser-detection

在 IE7 兼容模式下，我可以区分客户端的浏览器是 IE7 还是 IE9？我试图弄清楚我是否可以在我的网站上进行 JS 检查，这将识别两种不同的事情并根据结果做不同的事情

1.  那个浏览器是IE7
2.  该浏览器处于 IE7 兼容模式

我的第一个条件可以正常工作，因为到处都在说如何去做。不确定第二个和/或两者的组合。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-06T08:38:03.917

至少对于 IE8 和 IE9，您可以检查其中是否`navigator.userAgent`有子字符串`Trident`。IE8+的用户代理中**总是**有一个`Trident`，而 IE7 没有。请参阅[此答案](https://stackoverflow.com/a/1356135/95357)和[其中的 MSDN 链接](http://blogs.msdn.com/b/ie/archive/2009/01/09/the-internet-explorer-8-user-agent-string-updated-edition.aspx)。

IE10 似乎更棘手：在下面的评论中报告说，IE7 仿真模式`Trident`并不**总是**存在。*如果 IE10 在 IE7 可用的任何平台上不可用，**操作系统字符串（例如）可能仍会显示 IE10。`Windows NT 6.2`*

另请注意，HTTP`User-Agent`标头可能并不总是匹配`navigator.userAgent`。至少在 IE9 具有兼容模式（发送 IE7`User-Agent`标头）但`IE=Edge`在响应中检测到类似内容（`navigator.userAgent`返回 IE9）时，情况就是如此。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-18T16:31:10.003

我不相信有办法检测用户的浏览器是否处于兼容模式。他们的用户代理字符串将由他们的浏览器模式决定，他们的文档模式将由`x-ua-compatible`元标记（或标题）的存在或可能由使用的文档类型决定。

兼容模式旨在保护现代浏览器用户免受依赖旧功能和过时功能或黑客攻击的页面的影响。这不是您真正想要测试的东西。相反，编写符合标准的代码，浏览器可以在兼容模式或非兼容模式下理解这些代码。

以下是不同浏览器模式和文档模式的各种结果：

**浏览器模式：IE10 兼容视图/文档模式：IE7 标准**

```
navigator.userAgent

"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; Trident/6.0; 
.NET4.0E; .NET4.0C; Media Center PC 6.0; .NET CLR 3.5.30729; 
.NET CLR 2.0.50727; .NET CLR 3.0.30729; BRI/2)" 

document.documentMode

7 
```

**浏览器模式：IE7 / 文档模式：IE7 标准**

```
navigator.userAgent

"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64; .NET4.0E; 
.NET4.0C; Media Center PC 6.0; .NET CLR 3.5.30729; .NET CLR 2.0.50727; 
.NET CLR 3.0.30729; BRI/2)"

document.documentMode

7 
```

如您所见，通过这两种方法无法判断用户是否处于兼容视图中。

## 覆盖兼容视图列表

如果您的网站出现在兼容性视图列表中，您可以通过提供自己的`x-ua-compatible`标题来覆盖他们建议的呈现选项：

```
<meta http-equiv="x-ua-compatible" content="IE=9" /> 
```

这会强制您的浏览器进入 IE9 标准模式（不评估文档类型）。您可以使用`IE=edge`强制它进入可能的最新模式（在 Internet Explorer 10 上，这将是 IE 10 标准），但不鼓励这样做。相反，请将其设置为您测试过的最新模式。

如果`x-ua-compatible`标头设置为 IE10，但用户在较早的浏览器上访问您的页面，则将使用最近的渲染引擎。例如，如果用户使用 IE9 访问您的页面，并且您的元标记指示浏览器使用 IE10，则浏览器将回退到 IE9 标准模式。

请注意，这`IE=9`会导致浏览器进入 IE9 标准模式。它不一定会导致浏览器表现得像 IE9 一样。如果您希望浏览器的行为与 IE9 一样，您可能需要使用以下`EmulateIE9`内容：

```
<meta http-equiv="x-ua-compatible" content="IE=EmulateIE9" /> 
```

这会导致浏览器回退到 DOCTYPE（如果存在）来确定文档模式是标准还是 Quirks。

有关详细信息，请参阅[定义文档兼容性](http://msdn.microsoft.com/en-us/library/cc288325%28v=vs.85%29.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-05T20:38:51.880

对于在 Google 上访问此主题的任何人，这里是另一种选择：

使用位于[http://www.quirksmode.org/js/detect.html](http://www.quirksmode.org/js/detect.html) ...的脚本。

```
if (BrowserDetect.browser == 'Explorer')
{
    if (document.documentMode == 7 && BrowserDetect.version > 7)
    {
        // user is running IE in compatability mode
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-08-09T14:43:30.527

这对我有用：

```
/**
 * Actual IE8-Browser running in IE8-Compat-Mode or IE7 Mode?
 */
MyUtils.isIE8CompatMode= function(){
    if($.browser.msie && navigator.userAgent.indexOf('MSIE 7.0')>=0){
        return true;
    }
    return false;
} 
```

一个实际的 IE8 浏览器有 3 种文档模式（IE7、IE8 和 Quirks）和 3 种浏览器模式（IE7、IE8 和 IE8 兼容性）。我们可以通过以下方式将 Document-Mode 强制为 IE8：

```
 <meta http-equiv="X-UA-Compatible" content="IE=8,chrome=1"/> 
```

但是，我们不能强制执行由浏览器配置决定的浏览器模式。例如：我们的一些客户在其兼容性-视图-设置-对话框中选中了“以兼容性模式呈现所有页面”复选框。如果是这样，我们就无能为力了。

请参阅此站点上非常有启发性的图表：

-> [ie8 如何确定兼容模式](http://blogs.msdn.com/b/ie/archive/2010/03/02/how-ie8-determines-document-mode.aspx)

**我们用上面的函数做什么？**由于我们的页面在兼容模式下显示一些故障，我们需要告诉用户，为什么它看起来很糟糕以及他能做些什么。所以我们使用上面的函数来判断我们是否遇到了麻烦，然后向用户发出一个小警告。

在 ie9 和 ie10 兼容模式下，我们的应用看起来很好，所以我们不需要它。此响应可被视为对以下问题的回答：[检测 ie8 兼容模式](https://stackoverflow.com/questions/1328963/detect-ie8-compatibility-mode?lq=1)，该模式被标记为此模式的副本。也许它可以帮助某人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-07T01:23:35.147

这是我为位于圣何塞的大型拍卖网站所做的一项相当防弹的检查。

```
var userAgentString = navigator.userAgent;

if(/MSIE 7\.0/gi.test(userAgentString) && /Trident/gi.test(userAgentString)){
    // compatibility mode
    // .... code goes here ....
} 
```

# c++ - C++ - Qt - Visual Studio 2010 - 带有 gui 和控制台的应用程序

> ID：10213642
> 
> 赞同：2
> 
> 时间：2012-04-18T16:20:02.893
> 
> 标签：c++, visual-studio-2010, qt

如果没有给它作为 GUI 应用程序启动的程序提供参数，如果给它 args，它会通过命令行运行。我能够使用属性>链接器>子系统（控制台/SUBSYSTEM：CONSOLE）让Visual Studio显示并打印到控制台，但这使得控制台始终在应用程序启动时显示，我如何有选择地显示控制台，以便当应用程序使用 GUI 运行时，它不会出现。我浏览了该站点，但我发现的只是如何将其设置为仅作为 Windows 应用程序，并且我需要它同时作为

谢谢！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T18:46:23.300

我猜这可行：

```
#include <QtGui/QApplication>
#include <QtGui/QMainWindow>

int
main(int n_app_args, char **app_arg)
{
    QCoreApplication * application = 0;

    if ( n_app_args == 1 )
    {
        application = new QCoreApplication(n_app_args, app_arg);
    }
    else
    {
        application = new QApplication(n_app_args, app_arg);
        QMainWindow * mainWindow = new QMainWindow();
        mainWindow->show();
    }

    return application->exec();
} 
```

用参数调用它，你会得到一个小（空）窗口。不带参数也不带窗口地调用它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-18T18:24:46.483

这里有一些代码，它创建了一个控制台并将输入和输出附加到它：

```
#include <Windows.h>
#include <stdio.h>
#include <io.h>
#include <fcntl.h>

void Console::createConsole()
{
    AllocConsole();
    SetConsoleTitle("Debug console");

    int hConHandle;
    long lStdHandle;

    FILE *fp;   // redirect unbuffered STDOUT to the console
    lStdHandle = (long)GetStdHandle(STD_OUTPUT_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);
    fp = _fdopen( hConHandle, "w" );
    *stdout = *fp;
    setvbuf( stdout, NULL, _IONBF, 0 ); 

    // redirect unbuffered STDIN to the console
    lStdHandle = (long)GetStdHandle(STD_INPUT_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);
    fp = _fdopen( hConHandle, "r" );
    *stdin = *fp;
    setvbuf( stdin, NULL, _IONBF, 0 );  

    // redirect unbuffered STDERR to the console
    lStdHandle = (long)GetStdHandle(STD_ERROR_HANDLE);
    hConHandle = _open_osfhandle(lStdHandle, _O_TEXT);
    fp = _fdopen( hConHandle, "w" );
    *stderr = *fp;
    setvbuf( stderr, NULL, _IONBF, 0 );
} 
```

我没有使用过 Qt，但您应该能够将其粘贴在某个地方并使其工作。

编辑：添加所需的标题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:24:47.110

您可以使用 windows 子系统来拥有它，并在需要控制台而应用程序也有 gui 时调用[AllocConsole 。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681944%28v=vs.85%29.aspx)

# javascript - slickgrid 标头的 Colspan 和行跨度

> ID：10213644
> 
> 赞同：3
> 
> 时间：2012-04-18T16:20:06.663
> 
> 标签：javascript, slickgrid

我只是想知道是否有一种方法可以为标题提供 colspan/rowspan 并具有多个标题行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-23T10:13:48.477

网格提供了一个辅助标题行。你可以用它来做任何你需要的事情。[查看这里](https://github.com/mleibman/SlickGrid/wiki/Grid-Options)了解更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-11T16:56:45.053

这是 colspan 的一个例子：http: [//6pac.github.io/SlickGrid/examples/example-colspan.html](http://6pac.github.io/SlickGrid/examples/example-colspan.html)

至于行跨度，它要复杂得多，您可以在以下 Github 问题中看到： [https ://github.com/6pac/SlickGrid/issues/381](https://github.com/6pac/SlickGrid/issues/381)

***请注意，活动存储库已从 mleibman 更改为这个： [https ://github.com/6pac/SlickGrid](https://github.com/6pac/SlickGrid)

# erlang - erlIDE 编译器选项

> ID：10213647
> 
> 赞同：1
> 
> 时间：2012-04-18T16:20:15.957
> 
> 标签：erlang, erlide

如何在 erlIDE 中指定编译器选项？[Erlang: add libraries to application](https://stackoverflow.com/questions/6315279/erlang-add-libraries-to-application)问题的答案是将所需的库添加到编译器选项中，但我看不到如何使用 erlIDE 执行此操作？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T12:24:27.267

如果你需要为你的库指定额外的包含目录，0.15.3 中有一个字段。我在 0.15.2 中错误地删除了它，我希望它不是太大的问题。

0.15.3 目前可从[http://erlide.org/update_beta](http://erlide.org/update_beta)获得，并将很快升级为正式版本。

如果您需要其他编译器设置，那么您必须让我知道哪些，我会添加它们。在这种情况下，请在[https://github.com/erlide/erlide/issues开票](https://github.com/erlide/erlide/issues)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:52:25.017

窗口 -> 首选项 -> Erlang -> 编译器 -> Erlang 格式的编译器选项。

[但如果您的项目使用某种构建工具（如rebar](https://github.com/basho/rebar)），通常不需要使用它。

# c# - 写一个 CSV 文件

> ID：10213651
> 
> 赞同：2
> 
> 时间：2012-04-18T16:20:23.580
> 
> 标签：c#, .net, filehelpers

我有一个用 C# 编写并用 FileHelpers 属性装饰的类

```
[DelimitedRecord(","), IgnoreFirst(1)]
class UserAndValues
{
    public int UserID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public ICollection<UserFavourites> Favourites {get;set;}

    public UserAndValues()
    { }
}

class UserFavourites
{
    public int Id {get;set;}
    public string Title {get;set;}
} 
```

然后我打电话给 CSV 作家

```
var engine = new FileHelperEngine<UserAndValues>();
engine.WriteFile(myPath, myListOfUsers); 
```

我收到以下错误：

> 字段：'k__BackingField' 的类型：ICollection`1 不是系统类型，因此该字段需要 CustomConverter（请查看文档以获取更多信息）。

我想写一个基本上看起来像的文件

```
UserId, FirstName, LastName, Favourite1Id, Favourite1Title, Favourite2Id, Favourite2Title...  
1, Joe, Smith, 1, Random Title, 2, More Title, ... 
```

收藏夹集合的深度可能为 10-50 条记录，并根据文件进行更改。

我不需要读这个文件，只需要写它。

如何使用上述类生成 CSV？（我可以修改类结构）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:36:49.690

好吧，非常未经测试：

```
class UserAndValues
{
    public int UserID { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    [FieldConverter(typeof(MyListConverter))] 
    public ICollection<UserFavourites> Favourites {get;set;}
}

public class MyListConverter: ConverterBase 
{ 

    public override object StringToField(string from) 
    { 
      throw new NotImplemented("bad luck");
    } 

    public override string FieldToString(object fieldValue) 
    { 
       var list = fieldValue as ICollection<UserFavourites>;

        return string.Join(",", 
            list.Select(f => f.ToString()));   // customize
    }

} 
```

# git - gitignore 忽略中间有空格的文件夹中的文件

> ID：10213653
> 
> 赞同：71
> 
> 时间：2012-04-18T16:20:35.027
> 
> 标签：git, github, gitignore

我有一个中间有空格的文件夹，但里面有一个 webconfig 文件。我希望 git 忽略 webconfig 文件，但由于文件夹中的空间，它不会忽略它。有人知道如何解决这个问题吗？

```
My FolderName/Web.config 
```

我试图`%20`在中间插入，但没有帮助。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-04-18T16:26:01.550

尝试`My\ FolderName/Web.config`或`"My FolderName/Web.config"`

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2012-04-18T16:23:22.863

我猜你可能不得不使用它`"My FolderName"/Web.config`。

# android - 如何获取拨出电话的状态

> ID：10213659
> 
> 赞同：4
> 
> 时间：2012-04-18T16:20:53.327
> 
> 标签：android, broadcastreceiver

在`OnReceive`方法中我有这样的东西：

```
 Bundle bundle=intent.getExtras();
   String phonenumber=intent.getStrngExtra(Intent.EXTRA_PHONE_NUMBER); 
```

如何查看拨号是否仍在通话或客户挂断电话？如何检查电话是否被接听？

当客户挂断电话或被叫客户接听电话时，我需要打印一个 toat。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:30:28.460

您将需要为操作**android.intent.action.PHONE_STATE注册的广播接收器**

*如果摘机*后电话状态**未**变为*空闲*，则表示通话仍在进行中。

*如果 read phone state 广播接收器中的状态**更改为 offhook** ，则呼叫被**应答**。在这些州根据需要举杯。*

```
 ***`public class CallDurationReceiver extends BroadcastReceiver {

static boolean flag =false;
static long start_time,end_time;    
@Override
    public void onReceive(Context arg0, Intent intent) {
        String action = intent.getAction();
        if(action.equalsIgnoreCase("android.intent.action.PHONE_STATE")){
            if (intent.getStringExtra(TelephonyManager.EXTRA_STATE).equals(
                                TelephonyManager.EXTRA_STATE_RINGING)) {

               //tOAST FOR INCOMING CALL, NOT YET PICKED UP

            }         
            if (intent.getStringExtra(TelephonyManager.EXTRA_STATE).equals(
                    TelephonyManager.EXTRA_STATE_IDLE)) {
                end_time=System.currentTimeMillis();
 //Total time talked =
                long total_time = end_time-start_time;
                //Store total_time somewhere or pass it to an Activity using intent

}     if (intent.getStringExtra(TelephonyManager.EXTRA_STATE).equals(
                    TelephonyManager.EXTRA_STATE_OFFHOOK)) {
                 start_time=System.currentTimeMillis();

}    

    }   
    }`*** 
```

 ***在清单文件中注册您的接收器，如下所示：

```
<receiver android:name=".CallDurationReceiver">
       <intent-filter>
           <action android:name="android.intent.action.PHONE_STATE" />
       </intent-filter>
    </receiver>
        } 
```

还要添加使用权限：

```
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-17T10:48:11.190

好吧，我找到了解决方案并成功实现了它。无法获取被叫方接受拨出电话的确切时间。

在另一端接听之前，它已经经过了两个阶段，即`on_State_idle`和`on_state_offhook`。`On_state_ringing`不适用于拨出电话。

假设如果对方没有接听电话，则电话连续响铃 40 秒（这不确定）。

1.  `on_State_idle`与和的开始阶段一起启动一个计时器`on_state_offhook`。

2.  如果计时器超过 40 秒，则有两种情况意味着另一方面的人接听了我的电话。

3.  如果`on_State_idle->on_state_offhook->on_State_idle`在 40 秒内工作意味着另一只手没有接我的电话。

4.  如果第二种情况为真，则从通话记录中获取通话时长。

5.  Totaltimer 运行时间 - 通话记录中的时间为您提供拨出电话的准确时间！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:31:54.557

您可以使用以下代码来处理呼叫状态:::

```
 private Runnable callMonitor = new Runnable() {
        public void run() {
            try {
                EndCallListener callListener = new EndCallListener();
                TelephonyManager mTM = (TelephonyManager)m_activity.getSystemService(Context.TELEPHONY_SERVICE);
                mTM.listen(callListener, PhoneStateListener.LISTEN_CALL_STATE);
            } catch(Exception e) {
                Log.e("callMonitor", "Exception: "+e.toString());
            }
        }
    };   

    private class EndCallListener extends PhoneStateListener {
        private boolean active = false;
        @Override
        public void onCallStateChanged(int state, String incomingNumber) {

            if(TelephonyManager.CALL_STATE_RINGING == state) {
                Log.i("EndCallListener", "RINGING, number: " + incomingNumber);
            }
            if(TelephonyManager.CALL_STATE_OFFHOOK == state) {
                //wait for phone to go offhook (probably set a boolean flag) so you know your app initiated the call.
                active = true;
                Log.i("EndCallListener", "OFFHOOK");
            }
            if(TelephonyManager.CALL_STATE_IDLE == state) {
                //when this state occurs, and your flag is set, restart your app
                Log.i("EndCallListener", "IDLE");
                if (active) {
                    active = false;

                    // stop listening                   
                    TelephonyManager mTM = (TelephonyManager)m_activity.getSystemService(Context.TELEPHONY_SERVICE);
                    mTM.listen(this, PhoneStateListener.LISTEN_NONE);

                    // restart the inbox activity
//                  Intent intent = new Intent(m_activity, MDInboxActivity.class);
//                  m_activity.startActivity(intent);
                }
            }
        }
    } 
```***

# javascript - 将数组从 MVC 控制器传递到 Javascript

> ID：10213665
> 
> 赞同：2
> 
> 时间：2012-04-18T16:21:21.203
> 
> 标签：javascript, model-view-controller

是否可以读取从 MVC 控制器传递到 JavaScript 的数组的内容？

这是我的控制器中返回数组的方法。（之前尝试过使用列表但没有成功）

```
public string[] GetAllEvents() 
{
    string[] array = new string[2];
    array[0] = "a";
    array[1] = "b";

    List<string> lst = new List<string>();
    lst.Add("a");
    lst.Add("b");
    return array;
} 
```

这是我从中调用 Controller 方法的 JavaScript 函数。

```
function GetAllEvents() {
    $.ajax({
        type: "GET",
        url: "/Service/GetAllEvents",
        success: function (result) {
            alert(result.toString() + "  " + result[0]);
        },
        error: function (req, status, error) {
            //alert("Error");
        }
    });
}; 
```

结果是 System.String[]，结果 [0] 给了我“S”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:22:49.623

MVC 操作应返回`ActionResult`s。

你可以然后`return Json(list, JsonRequestBehavior.AllowGet)`它会工作。

# r - 使用 Sweave 和 Latex 绘图为空

> ID：10213669
> 
> 赞同：4
> 
> 时间：2012-04-18T16:21:41.547
> 
> 标签：r, sweave, knitr

我想用我用 R 获得的图形制作一份报告。在这里，我向你展示了用 R 制作的`site_rose(site_ref)`和`site_time_series(site_ref)`我设计的图像。 ![在此处输入图像描述](../Images/c76347726daa18474b967d0f2d9864e7.png)

![在此处输入图像描述](../Images/7186b9b6235863e2ab0674c88ef01a62.png)

但是在运行 sweave('Profile.Rnw') 并获得 Profile.tex 之后，我获得了 Profile-002.pdf 和 Profile-003.pdf 这最后两个文档的大小为 0KB。所以我得到了一份没有任何数字的 .pdf 报告。这里我给你看代码：

```
\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[spanish]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

\title{Anàlisi in situ emplaçament}
\author{Jonel Palou Visa}

\begin{document}
\maketitle
\begin{center}
<<fig=TRUE,echo=TRUE>>=
 site_ref <- site_time_series(site_ref,peaks=T,stationary=T)
@
\end{center}

\begin{center}
<<fig=TRUE,echo=TRUE>>=
site_rose(site_ref)
@

\end{center}

\end{document} 
```

我想知道我打电话来绘制数字的新设备是否有问题，或者我真正的问题是什么。这两个函数的代码太大，无法在此处显示，这些函数中没有任何额外内容，因为要获得图形，我只调用 plot(...)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T16:26:38.320

如果没有您创建的两个函数的代码，仍然不清楚出了什么问题。但是，如果您使用`lattice`或`ggplot2`不调用`print`来自`ggplot2`or的对象`lattice`。在命令行上，这些类型的绘图工作，因为 print 然后被隐式调用。所以：

```
print(site_rose(site_ref)) 
```

应该产生正确的结果。或者，您可以开始使用`knitr`而不是`Sweave`. `knitr`没有这个问题。一般来说，我建议使用`knitr`而不是 Sweave。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:27:48.373

那是整个 Sweave 文件吗？创建 Sweave 文档时，您将无法重用当前环境变量中定义的变量。Sweave 的全部意义在于从端到端重现一些分析，因此无论如何这都不是一个好方法。

我建议`site_ref`在此 Sweave 文档中包括生成变量所需的任何分析。

如果您坚持走捷径，您可以保存当前的 R 环境并将其作为 Sweave 文档中的第一个命令加载，以提供对这些变量的访问。

用于`Stangle`从 Sweave 文档中提取 R 代码，然后创建一个新的 R 会话并尝试运行该代码。您可能会收到有关未定义变量的错误，或有关未定义函数的消息。您应该能够在空环境中运行 Sweave 文档中包含的 R 代码并使其成功运行。然后您就可以将其呈现为 PDF。

# sql - SQL Server索引B树是平面结构还是深度结构

> ID：10213674
> 
> 赞同：5
> 
> 时间：2012-04-18T16:22:04.663
> 
> 标签：sql, sql-server-2008, data-structures, indexing

几分钟前我在面试中被问到这个问题，我不知道答案。我从逻辑上回答它认为 B 树始终是深度结构，因为它具有多个级别。我的回答对吗？回答这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:23:50.507

是的，你的回答和推理都是对的。一棵树从来都不是一个扁平的结构。平面结构的一个例子是一维数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:24:21.677

B树因此名称将是树或深度结构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:48:09.513

你是对的。问这个问题的人是否也有正确的答案是未知的。

# php - 通过一个或多个数组值查询表

> ID：10213675
> 
> 赞同：-1
> 
> 时间：2012-04-18T16:22:07.290
> 
> 标签：php, mysql

我正在尝试运行查询以确定 A 列是否为真。如果为真，则获取不同列 B 的内容（可能是由“，”分隔的数组）并使用这些内容来查询不同的表。我的问题是，B 列可能是一个数字，也可能是 10 个数字，都用“，”分隔，我需要在第二个表中查询前一个查询的每个数字的列。如果有人可以提供帮助，那就太好了。

编辑：我尝试使用数组分解功能，但不知道如何查询下一个表以包含这些值。

我想象它是这样的

```
query = select * from table where location = arrayValue[1] or location = arrayValue[2] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:50:03.647

Telmo Marques 在这里的改编，但有所改进：

```
<?php
//Let's say $bcolumn is a string with the values of B column, separated by colons
$bcolumnArray = explode(",", $bcolumn);
array_walk($bcolumnArray, 'htmlentities');

//Build SQL query
$SQL = 'SELECT * FROM table';
if(count($bcolumnArray)){
    $SQL.= ' WHERE IN ("'.implode('", "', $vbcolumnArray).'")';
}

//Query your second table here
$Qry = mysql_query($sql);

// Results here :
while($Res = mysql_fetch_assoc($Qry)){
    print_r($Res);
}
?> 
```

我建议 PDO 也...看看：[PDO](http://php.net/manual/en/book.pdo.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:29:05.887

使用 PHP 的`explode()`函数将字符串转换为数组。

```
<?php
//Let's say $bcolumn is a string with the values of B column, separated by colons
$bcolumnArray = explode(",", $bcolumn);

//Build SQL query
$sql = "SELECT * FROM table WHERE ";
for($i=0; $i < count($bcolumnArray); $i++)
{
   $sql .= "location = " . $value;
   if($i != count($bcolumnArray)-1)
   {
      $sql .= " or ";
   }
}

//Query your second table here
mysql_query($sql);
?> 
```

文档： http: [//php.net/manual/en/function.explode.php](http://php.net/manual/en/function.explode.php)

# credit-card - 如何创建随机蜜罐信用卡数据

> ID：10213676
> 
> 赞同：1
> 
> 时间：2012-04-18T16:22:09.343
> 
> 标签：credit-card, data-generation, honeypot

所以我想创建一些蜜罐信用卡数据。

创建信用卡号码很容易（也许）。我可以在一定范围内创建数字整数值。如果我有野心，我可能会尝试创建 Luhn 有效数字，尽管我可能不想走那么远。事实上，我更喜欢创建已知的无效数字，这将是一种有用的技术。无论如何，至少我会创建一些随机整数。

Sec 码可以是随机的。有效期可以在一定范围内，随机。

困难的部分是：如何创建随机名称？出于明显的隐私原因，我不能真正使用现有的名字，即使我随机重新组合名字和姓氏（John Smith，Jane Doe，Bob Jenkins => John Jenkins，Bob Doe，Jane Jenkins），除非他们特别通用的，如果我在随机数据中创建一些 John Smith 名字，我可能不会介意。

但是我可以用什么来播种无害的数据呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T16:43:13.000

你看过[假名生成器](http://www.fakenamegenerator.com/gen-random-us-us.php)吗？他们有一个[API](http://www.fakenamegenerator.com/api.php)，它也会生成你的 CC 信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:28:13.903

尝试使用一些著名的卡通人物或在名称后附加一些数字，例如 John1 Doe1 ，以避免隐私问题。

# sqlite - 带有列数据的 SQLite X'...' 表示法

> ID：10213677
> 
> 赞同：1
> 
> 时间：2012-04-18T16:22:10.487
> 
> 标签：sqlite, hex, spiceworks

我正在尝试在 Spiceworks 中编写使用 SQLite 查询的自定义报告。该报告将获取硬盘序列号，不幸的是，这些序列号以几种不同的方式存储，具体取决于机器上的 Windows 和 WMI 版本。

三个常见示例（足以解决实际问题）如下：

**实际序列号：** `5VG95AZF`
**带前导空格的** `2020202057202d44585730354341543934383433`
**十六进制字符串：带前导零的十六进制字符串：** `3030303030303030313131343330423137454342`

这两个十六进制字符串更加复杂，因为即使将它们转换为 ASCII 表示，每对数字实际上都是倒数的。这是一个例子：

`3030303030303030313131343330423137454342`评估为`00000000111430B17ECB`

但是，该硬盘驱动器上的实际序列号是`1141031BE7BC`，没有前导零并且交换了字节。根据我在本网站上阅读的其他问题和答案，这与数据的“字节顺序”有关。

到目前为止，我的临时查询看起来像这样（缩短到仅相关部分）：

```
SELECT  pd.model as HDModel,
  CASE
     WHEN pd.serial like "30303030%" THEN
         cast(('X''' || pd.serial || '''') as TEXT)
     WHEN pd.serial like "202020%" THEN
         LTRIM(X'2020202057202d44585730354341543934383433')
  ELSE
     pd.serial
  END  as HDSerial 
```

该查询的结果是这样的：

```
HDModel             HDSerial
-----------------   -------------------------------------------
Normal Serial       5VG95AZF
202020% test case   W -DXW05CAT94843
303030% test case   X'3030303030303030313131343330423137454342' 
```

这表明当给定一个完全文字数字（202020% 线）时，`X'....'`符号样式确实转换为正确（但向后）的结果。`W -DXW05CAT94843`但是，我需要找到一种方法来对列中的实际数据执行相同的操作，但`pd.serial`我找不到方法。

我最初的想法是，如果我可以构建符号的字符串表示`X'...'`，那么也许`cast()`会评估它。但正如您所看到的，这最终只是吐出`X'3030303030303030313131343330423137454342'`而不是预期的`00000000111430B17ECB`. 这意味着串联工作正常，但我找不到与手动测试用例一样将其评估为十六进制的方法。

我整个早上都在谷歌搜索，看看是否缺少一些语法，但我最接近的是使用`||`运算符的连接。

**编辑：** 最终我只想能够在我的查询中有一个简单的 case 语句，如下所示：

```
SELECT  pd.model as HDModel,
  CASE
     WHEN pd.serial like "30303030%" THEN
         LTRIM(X'pd.serial')
     WHEN pd.serial like "202020%" THEN
         LTRIM(X'pd.serial')
  ELSE
     pd.serial
  END  as HDSerial 
```

但是因为 pd.serial 被单引号括起来，所以它被当作文字字符串而不是作为该列中包含的数据。我的希望是/是我需要指定一个字符或运算符，比如`X'$pd.serial'`或其他东西。

**结束编辑**

如果我能克服这第一个障碍，我的下一个任务将是尝试删除前导零（LTRIM 吃前导空格的方式）并反转字节，但老实说，即使那部分不是，我也会满足。这是不可能的，因为在 Excel 中对该报告进行后处理并不难。

如果有人能指出我正确的方向，我将不胜感激！如果我使用 PHP 或其他东西来执行此处理，显然会容易得多，但是因为我试图让它成为 Spiceworks 中的嵌入式报告，所以我必须在单个 SQLite 查询中完成所有这些操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:56:58.390

X'...' 是 sqlite 中的二进制表示。如果值是字符串，则可以直接使用它们。

这应该是一个开始：

```
sqlite> select X'3030303030303030313131343330423137454342';
00000000111430B17ECB
sqlite> select ltrim(X'3030303030303030313131343330423137454342','0');
111430B17ECB 
```

我希望这能让你走上正确的道路。

# jquery-ui - jQuery UI 滑块 - ajax 结果

> ID：10213678
> 
> 赞同：0
> 
> 时间：2012-04-18T16:22:13.013
> 
> 标签：jquery-ui, jquery

我正在尝试实现一个 jQuery UI 滑块，其中滑块值将用于通过 ajax 更新页面的一部分。

我可以让 ajax 工作，但我遇到了问题，让滑块范围在用户离开时保持不变。相反，只要松开滑块手柄，它就会返回默认值。

使用 jQuery 1.7.1、jQuery UI 1.8.16

代码：

```
$( "#example_slider" ).slider({
    range: true,
    step: 150,
    min: 0,
    max: 450,
    values: [ 0, 450 ],
    stop: function( event, ui ) {

        var value1 = ui.values[0];
        var value2 = ui.values[1];

        $.ajax({
            type: "POST",
            url: "ajax_file.php",
            data: "value1="+value1+"&value2="+value2,
            cache: false,
            success: function(html){
                $("#content_update").html(html);
            }
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T08:05:49.920

啊，我的错，也从 ajax_file.php 调用了 Javascript 初始化，这就是它重置滑块值的原因。删除了这个，现在可以按预期工作。

# c++ - 友谊：来自同一父母的许多班级

> ID：10213682
> 
> 赞同：0
> 
> 时间：2012-04-18T16:22:21.817
> 
> 标签：c++

`privateMember`如果没有`friend`所有派生类，我怎么能达到？

```
class parent{...};  //a virtual class

class A: public parent{...};
class B: public parent{...};
class C: public parent{...};
class D: public parent{...};
class E: public parent{...};
...
//each has a function, that want access to privateMember

class MyClass{
    int privateMember;

    friend parent;
    //I know it doesnt't work, but this shows the best what I want   
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:27:59.833

保持原样（使用）并为, , ...`friend class parent`添加一个访问器函数将使用。它将受到保护，因此层次结构之外的功能无法使用它。`parent``A``B`

```
class parent {
protected:
  static int& getPrivate( MyClass & c ) { return c.privateMember; }
...
}; 
```

您必须这样做，因为友谊不会扩展到派生类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:29:34.483

您可以创建一个 getter 函数，该函数将返回一个 privateMember：

`int getPrivateMember() const { return privateMEmber; }`

当然，这必须是公共方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:30:13.437

这里的简单答案是不要与其他类的内部状态混为一谈。相反，使用他们的公共 API。这样您就不必担心将自己锁定在实现中，并且您可以避免在修改变量时无意中破坏类不变量的各种潜在问题。

# javascript - 基于一个元素的更改事件触发多个事件 - jQuery

> ID：10213684
> 
> 赞同：0
> 
> 时间：2012-04-18T16:22:22.123
> 
> 标签：javascript, jquery, javascript-events

我有多行，每行有三个选择元素。在初始化期间有两个这样的行，并且可以动态添加更多行。当添加每一行时，我向所有这些元素添加了更改事件，这样当该行中的一个下拉菜单发生更改时，特定行中的所有其他元素都会更改。还有另一个选择元素`#foo`不属于任何行（它显示在页面顶部），它在更改时应该会更改所有行上所有选择元素的内容。

我尝试通过`jQuery("#foo select").change(callback_function)`在为每一行添加更改事件时添加来做到这一点。但是当我这样做时，更改`#foo`只更新最后插入的行而不是其他行。如何使其以更改`#foo`更新所有行的方式工作？

任何解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:35:19.943

如果您提供了一些源代码会更容易回答，但据我了解（当更改`select`id 的元素时`foo`，其他`select`元素会被某个函数更改）这可能对您有用：

```
$("#foo").on('change', function() {
  $('select.other-selects').each( function (i) {
    callback_function();
  });
}); 
```

`.other-selects`您指定其他`select`元素的类在哪里。

# java - Java 从模板创建 PDF：Apache FOP 与？

> ID：10213685
> 
> 赞同：4
> 
> 时间：2012-04-18T16:22:28.637
> 
> 标签：java, pdf, xsl-fo, apache-fop

我必须从 Java 创建一个 pdf，我想从模板创建它，而不是使用 java 代码创建它：

```
document.addLabel("a pdf..") 
```

我已经看到我可以使用使用 XSL-FO 作为模板的 Apache FOP 来做到这一点，有人知道 XSL-FO 的免费图形设计器吗？我只找到了[https://www.ecrion.com/Products/XFDesigner/StartTrial.aspx](https://www.ecrion.com/Products/XFDesigner/StartTrial.aspx)这个。

或者有一些 Apache FOP 的替代品吗？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:32:19.397

我向您推荐[JODReports](http://jodreports.sourceforge.net/)和[JODConverter](http://artofsolving.com/opensource/jodconverter)的组合。JODReports 是一个从 ODT 模板生成报告的解决方案，因此使用 LibreOffice 设计模板很容易。稍后，您可以将报告（格式为 .odt 或 .doc）转换为 PDF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:26:48.023

不确定是否免费 - Oxygen 和 XML spy 远非免费选项。你也可以使用 iText，我相信它不再是免费的了，而且有很多开源库围绕着谷歌。个人一直是手工完成 XSL-FO，所以不能对编辑发表评论（如果你的要求不高，这很容易）

根据您的使用和复杂性，还有其他选项，例如创建 html，然后使用 wkhtmltopdf 或其他东西处理它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T14:11:58.340

总是有 TeX（其中有[http://tex.stackexchange.com](http://tex.stackexchange.com)）。另请参阅[https://stackoverflow.com/questions/210029/pdf-libraries](https://stackoverflow.com/questions/210029/pdf-libraries)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-25T10:58:12.943

查看 XDocReport，您可以在其中从[odt（报告）](http://code.google.com/p/xdocreport/wiki/ODTReporting)或[docx（报告）](http://code.google.com/p/xdocreport/wiki/DocxReporting)创建模板，它提供了太完整的 Java 转换器（odt->pdf、odt-xhtml、docx->pdf、docx->xhtml 转换器）：

*   使用这些 XDocReport 完整 Java 转换器的优点是您无需安装 OpenOffice/LibreOffice（如 JODConverter）来管理转换。更多使用流媒体模式（不需要生成临时文件）
*   那些 XDocReport 完整的 Java 转换器的缺点是渲染器可能不如 OpenOffice/LibreOffice

# c# - Microsoft 图表网格线未以“整数”数字绘制

> ID：10213689
> 
> 赞同：0
> 
> 时间：2012-04-18T16:22:45.343
> 
> 标签：c#, data-visualization, mschart, dundas

放大 Microsoft 图表控件时，标签和网格线的值通常看起来像 38.2、39.2、40.2、41.2 ... 而不是 38、39、40、41。我试图通过使用下面显示的代码来设置间隔偏移来纠正这个问题，但没有成功。

```
myChart.ChartAreas[0].AxisX.MinorGrid.IntervalOffset = myChart.ChartAreas[0].AxisY.ScaleView.ViewMinimum % 1;
myChart.ChartAreas[0].AxisX.IntervalOffset = myChart.ChartAreas[0].AxisY.ScaleView.ViewMinimum % 1; 
```

从特定值开始绘制主要和次要网格线和标签的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T09:49:44.243

您的问题可能是由添加边距引起的。确保你设置

```
myChart.ChartArea[0].AxisX.IsMarginVisible = false; 
```

# css - Chrome 中的 Arial

> ID：10213691
> 
> 赞同：1
> 
> 时间：2012-04-18T16:22:54.933
> 
> 标签：css, google-chrome, fonts, font-face, chromium

我对 Chrome/Chromium 中的 Arial（也可能是其他字体）有疑问。当我使用 font-family: Arial; 时看起来不错 但是当我通过 @font-face 包含 Arial 字体文件时，它看起来不一样了！为什么会这样？我该怎么做才能让它们看起来一样？Chrome 究竟在哪里使用它的字体？这是我的CSS

```
@font-face {
    font-family: 'My Arial';
    src: url(Arial.ttf) format('truetype');
    font-weight: normal;
    font-style: normal;
}

body {
    padding: 20px;
    font-size: 16px;
}

body#native {
    font-family: Arial;
}

body#fontface {
    font-family: 'My Arial';
} 
```

这是渲染的文本：

![这是图片](../Images/ff4e94188aa96f041dd44b5a22140678.png).

对不起，我的英语不是我的母语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:28:51.367

我经常使用@font-face，而且不同的浏览器呈现它的方式总是存在差异的。对于某些字体，它变得非常丑陋，在您的特定情况下，我想说差异是微不足道的，其他一切就像 Sparky672 已经评论的那样。

如果您绝对必须在所有系统上进行像素精确的相同渲染，也许一些基于 javascript 的解决方案可能会有所帮助，请检查：

[https://stackoverflow.com/a/692994/525445](https://stackoverflow.com/a/692994/525445)

同样，如果这是我在您的屏幕截图上的网站，我会对它的外观非常满意。

这只是网络的本质，不是每个人都会看到相同的东西，有不同的显示器具有不同的颜色设置、不同的分辨率、有些人放大文本等。

仅提及该选项，您可以使用 JavaScript 检测 Chrome，然后应用一些特定的 CSS 来调整它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T17:24:37.977

您包含在@font-face 中的 Arial 文件是否与您系统中的完全相同的文件，还是您从其他地方获得的？导致差异的文件可能存在差异。如果没有，那么正如@Sparky672 在他最后的评论中所说，您无能为力，这只是浏览器渲染问题。

另外，出于好奇，您为什么要在 @font-face 中包含 Arial，因为它几乎在每个系统上都可用？

# visual-studio-2010 - Visual Studio 2010 SDK安装找不到Visual Studio

> ID：10213697
> 
> 赞同：7
> 
> 时间：2012-04-18T16:23:05.780
> 
> 标签：visual-studio-2010, visual-studio-sdk

任何人都有使用 Visual Studio SDK 的经验，并且可以帮助我指出正确的方向来解决这个~~问题~~的奇怪行为吗？

![在此处输入图像描述](../Images/d9ff40b4eaae13f2001c7bd2ddc9554c.png)

总结一下屏幕截图，我安装了 Visual Studio 2010（不，这不是新安装），但 SDK 安装程序似乎认为我没有。

是的，我已经尝试了不止一次，是的，我在尝试安装 SDK 之前关闭了 Visual Studio。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T16:27:50.490

有人找到了一个看起来像你的问题的解决方案：http: [//social.msdn.microsoft.com/Forums/en-IE/windowssdk/thread/ac4fab28-ab07-4b3c-b46c-8b6b293068c8](http://social.msdn.microsoft.com/Forums/en-IE/windowssdk/thread/ac4fab28-ab07-4b3c-b46c-8b6b293068c8)

# powershell - 模拟访客模式的脚本

> ID：10213700
> 
> 赞同：0
> 
> 时间：2012-04-18T16:23:16.003
> 
> 标签：powershell, windows-7, batch-file

这是我在这里的第一个问题，如果我违反了我还不知道的任何规则或没有遵循任何好的做法，我很抱歉。但是，我们走吧。

我有一台 Windows 7 笔记本电脑，通常，同事要求我用它来搜索一些东西、使用 Word 或其他东西。我想为客人提供一个安全的区域（就像客人模式一样，直到它从 Windows 7 最终版本中删除），让客人能够浏览、做他们想做的事情，并在注销期间撤消任何更改制作并擦除访客用户数据。由于我是前 linux 用户，我的第一个想法是类似于 Cron 调用的脚本或在 Init 适当级别上调用的脚本。

谷歌搜索了一下后，我找到了有关登录和注销脚本的信息。我对 MS 平台中的脚本几乎一无所知。您认为这种方法可以很好地解决我的问题吗？如果是，我必须用哪种语言编写这个脚本？如果可能，请提供一些简单的例子。在获得基本概念后，我可以处理其余的事情。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:14:30.567

我希望这可以回答您的问题，即使它不包括批处理脚本。

这是 Windows 7 上的访客帐户：（ [来源：][[sevenforums.com](https://www.sevenforums.com/attachments/tutorials/8417d1240117767-guest-account-turn-off-log_on.jpg)][）][![客人帐户证明](../Images/2b7e3e37f0a2d8c51a97329173899e26.png)](https://i.stack.imgur.com/kaiCU.jpg)

1.  打开控制面板（所有项目视图）。

2.  单击用户帐户图标。

3.  单击管理另一个帐户链接。（见下面的截图）

[![管理其他用户](../Images/d7bf1c7fba82f9ca83121d426656e1d1.png)](https://i.stack.imgur.com/Gg5w6.jpg)
[（来源：[sevenforums.com](https://www.sevenforums.com/attachments/tutorials/8418d1240117767t-guest-account-turn-off-step1.jpg)）]

4.  如果 UAC 提示，则单击是。

5.  单击列出的访客帐户。（见下面的截图）

[![点击访客账户](../Images/85de88d66be4c7a9158869bcd139f154.png)](https://i.stack.imgur.com/tRZnn.jpg)
[（来源：[sevenforums.com](https://www.sevenforums.com/attachments/tutorials/8419d1240117767t-guest-account-turn-off-step2.jpg)）]

6.  单击打开按钮。（见下面的截图）

[![开启访客账户](../Images/27620bef032c185cdc3ba8f88b4abc0b.png)](https://i.stack.imgur.com/UNS2f.jpg)
[（来源：[sevenforums.com](https://www.sevenforums.com/attachments/tutorials/8420d1240117767t-guest-account-turn-off-step3.jpg)）]

7.  来宾帐户现在已打开。关闭用户帐户窗口。（见下面的截图）

[![恭喜！](../Images/31cc22d762d656e8e50706f432389132.png)](https://i.stack.imgur.com/Gw6Fe.jpg)
[（来源：[sevenforums.com](https://www.sevenforums.com/attachments/tutorials/8421d1240117767t-guest-account-turn-off-step4.jpg)）]

删除内容的脚本是：

```
rd c:\directory1\ /s /q
md c:\directory1
rd c:\directory2\ /s /q
md c:\directory2 
```

等等。

所以...

```
rd "Insert filepath you want removed here" /s /q
md "Same filepath" 
```

对于您要删除的每个目录，您必须有一个 rd 和 md。

将其保存到您的“启动”文件夹中，以便在您每次登录时运行。

# javascript - 访问子域中的 IFRAME 内容

> ID：10213702
> 
> 赞同：0
> 
> 时间：2012-04-18T16:23:22.420
> 
> 标签：javascript, iframe

我有一个域名说

```
http://www.domain.com 
```

我有子域

```
http://support.domain.com 
```

我希望`support.domain.com`在 IFRAME 中加载`domain.com`

```
var ifr = document.getElementById( yourIframeId );
var ifrDoc = ifr.contentDocument || ifr.contentWindow.document;
var theForm = ifrDoc.getElementById( yourFormId ); 
```

此代码正常工作。但事实并非如此。

My question is should my subdomain be `domain.com/support` or is there any way I can work with `support.domain.com`

Please avoid giving answers in jQuery

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:26:04.817

如果你在最外层 HTML 文件的顶部附近添加它，它可能会起作用：

```
<script type="text/javascript">document.domain = 'domain.com';</script> 
```

* * *

您控制两个域还是控制两个域提供的内容？

# javascript - 如何查看 Chrome DevTools 中元素触发的事件？

> ID：10213703
> 
> 赞同：717
> 
> 时间：2012-04-18T16:23:22.633
> 
> 标签：javascript, google-chrome-devtools

我在图书馆的页面上有一个可自定义的表单元素。我想看看当我与它交互时会触发哪些 javascript 事件，因为我试图找出要使用的事件处理程序。

如何使用 Chrome Web Developer 做到这一点？

* * *

## 回答 #1

> 赞同：992
> 
> 时间：2012-04-18T16:29:12.267

*   点击`F12`打开开发工具
*   单击源选项卡
*   在右侧，向下滚动到“事件侦听器断点”，然后展开树
*   单击要收听的事件。
*   与目标元素交互，如果它们触发，您将在调试器中获得一个断点

同样，您可以右键单击目标元素->选择“检查元素”在开发框架的右侧向下滚动，底部是“事件侦听器”。展开树以查看附加到元素的事件。不确定这是否适用于通过冒泡处理的事件（我猜不是）

* * *

## 回答 #2

> 赞同：975
> 
> 时间：2013-04-10T10:50:36.873

您可以使用[monitorEvents](http://www.briangrinstead.com/blog/chrome-developer-tools-monitorevents)功能。

只需检查您的元素（`right mouse click`→`Inspect`在可见元素上或转到`Elements`Chrome 开发人员工具中的选项卡并选择想要的元素）然后转到`Console`选项卡并编写：

```
monitorEvents($0) 
```

现在，当您将鼠标移到该元素上、聚焦或单击它时，触发事件的名称将与其数据一起显示。

要停止获取此数据，只需将其写入控制台：

```
unmonitorEvents($0) 
```

[`$0`](https://developer.chrome.com/devtools/docs/commandline-api#0-4)只是 Chrome 开发者工具选择的最后一个 DOM 元素。您可以在那里传递任何其他 DOM 对象（例如`getElementById`or的结果`querySelector`）。

您还可以将事件“类型”指定为第二个参数，以将监控的事件范围缩小到一些预定义的集合。例如：

```
monitorEvents(document.body, 'mouse') 
```

此可用类型的列表在[这里](https://developer.chrome.com/devtools/docs/commandline-api#monitoreventsobject-events)。

我制作了一个小 gif 来说明此功能的工作原理：

![monitorEvents函数的使用](../Images/6f82c227c1c2391f64d528bf778f4cbc.png)

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2014-03-21T20:12:51.467

[Visual Event](http://www.sprymedia.co.uk/article/Visual+Event+2)是一个不错的小书签，可用于查看元素的事件处理程序。在线演示可以在[这里](http://sprymedia.co.uk/VisualEvent/demo/)查看。

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2016-07-14T15:11:53.707

对于 jQuery（至少版本 1.11.2），以下过程对我有用。

1.  右键单击该元素并打开“Chrome 开发人员工具”
2.  输入`$._data(($0), 'events');`“控制台”
3.  展开附加对象并双击该`handler:`值。
4.  这显示了附加函数的源代码，使用“搜索”选项卡搜索其中的一部分。

现在是时候停止重新发明轮子并开始使用香草 JS 事件了...... :)

[![如何找到-jquery-click-handler-function](../Images/fd3573213357a923d60edcec59c7ef23.png)](https://i.stack.imgur.com/oqVlc.png)

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2012-07-15T23:42:22.130

如果它是 jquery 插件，这将不会显示您的脚本可能创建的自定义事件。例如 ：

```
jQuery(function($){
 var ThingName="Something";

 $("body a").live('click', function(Event){
   var $this = $(Event.target);
       $this.trigger(ThingName + ":custom-event-one");
 });

 $.on(ThingName + ":custom-event-one", function(Event){
   console.log(ThingName, "Fired Custom Event: 1", Event);
 })

}); 
```

chrome 开发者工具中脚本下的事件面板不会显示“Something:custom-event-one”

# java - 基于 FIFO 的队列实现？

> ID：10213707
> 
> 赞同：84
> 
> 时间：2012-04-18T16:23:28.930
> 
> 标签：java, collections, queue

我需要一个简单的 FIFO 实现队列来存储一堆整数（如果它是泛型实现，我不介意）。

已经在 Trove/Guava 库或 Trove/Guava 库中为我烘焙过的任何东西`java.util`？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-04-18T16:24:33.020

是的。[队列](http://docs.oracle.com/javase/9/docs/api/java/util/Queue.html)

[LinkedList](http://docs.oracle.com/javase/9/docs/api/java/util/LinkedList.html)是最简单的具体实现。

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2012-09-03T16:59:26.790

下面是使用 java 的内置 FIFO 队列的示例代码：

```
public static void main(String[] args) {
    Queue<Integer> myQ = new LinkedList<Integer>();
    myQ.add(1);
    myQ.add(6);
    myQ.add(3);
    System.out.println(myQ);   // 1 6 3
    int first = myQ.poll();    // retrieve and remove the first element
    System.out.println(first); // 1
    System.out.println(myQ);   // 6 3
} 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-04-18T16:29:30.397

`ArrayDeque`可能是 JDK 中最快的基于对象的队列；Trove 有`TIntQueue`接口，但我不知道它的实现在哪里。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-12-22T02:53:16.377

[LinkedList](https://docs.oracle.com/javase/9/docs/api/java/util/LinkedList.html)可以用作队列 - 但您需要正确使用它。这是一个示例代码：

```
@Test
public void testQueue() {
    LinkedList<Integer> queue = new LinkedList<>();
    queue.add(1);
    queue.add(2);
    System.out.println(queue.pop());
    System.out.println(queue.pop());
} 
```

输出 ：

```
1
2 
```

**请记住**，如果您使用[push](https://docs.oracle.com/javase/9/docs/api/java/util/LinkedList.html#push-E-)而不是[add](https://docs.oracle.com/javase/9/docs/api/java/util/LinkedList.html#add-E-)（您很可能会直观地这样做），这将在列表的前面添加元素，使其表现得像一个堆栈。

> 因此，只有与 add 一起使用时，这才是一个队列。

试试这个 ：

```
@Test
public void testQueue() {
    LinkedList<Integer> queue = new LinkedList<>();
    queue.push(1);
    queue.push(2);
    System.out.println(queue.pop());
    System.out.println(queue.pop());
} 
```

输出 ：

```
2
1 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-12-11T18:52:26.980

`Queue``Collection`是一个在 Java中扩展的接口。`FIFO`它具有支持架构所需的所有功能。

对于具体实现，您可以使用`LinkedList`. LinkedList 实现`Deque`，而后者又实现`Queue`. 所有这些都是`java.util`包的一部分。

有关带有示例示例的方法的详细信息，您可以参考[Java 中基于 FIFO 的队列实现](http://opensourceforgeeks.blogspot.in/2013/12/fifo-based-queue-implementation-in-java.html)。

PS：上面的链接转到我的个人博客，其中有更多详细信息。

# php - 哈希碰撞担忧

> ID：10213709
> 
> 赞同：1
> 
> 时间：2012-04-18T16:23:43.050
> 
> 标签：php, algorithm, hash, probability, hash-collision

如果我有一个系统，其中哈希是从 100 万种可能性的总排列中生成的。如果有 10% 的碰撞几率，我应该担心生成算法运行 5 次吗？

*   我有一个类似于 jsfiddle 的系统，用户可以在我的服务器上“保存”一个文件。现在我使用`'23456789abcdefghijkmnopqrstuvwxyz'`的是 33 个字符，文件长度为 4 个字符，总共有多种`33^4 = 1,185,921`可能性。
*   “文件名”是随机生成的，如果发生冲突，它会重新运行以获取另一个文件名。使用[生日悖论计算器](http://jeff.aaron.ca/cgi-bin/birthday)我可以看到，在我有 500 个条目后，我有 10% 的机会发生碰撞。
*   我连续发生 5 次以上碰撞的可能性有多大？4个呢？
*   有没有办法解决这个问题？我应该担心吗？5000 个条目后会发生什么？
*   有没有一个程序可以通过任意输入来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:37:08.290

我不认为生日悖论计算适用。1185921 中的 500 个随机数字的几率完全不同，而一旦您拥有 500 个已知的唯一数字，一个新数字的几率就会不同。

如果您有 500 个分配的号码并随机生成一个新号码，则发生碰撞的几率为 500/1185921。使用 500 个名称，连续 4 次冲突的可能性为 (500/1185921) ⁴ < 10 ^(-13)。对于 5000 个现有文件名，新名称发生冲突的几率为 5000/1185921，并且连续 4 次冲突的几率 < 10 ^(-9)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:31:40.087

我的数学有点生疏，所以请耐心等待。
连续发生 x 次碰撞的机会很简单：

```
chance of collision ^ x; 
```

碰撞的可能性是：

```
entries/space (which is 500/1185921 or 0.04%). 
```

您可以在上面看到，条目越多，情况就越糟（空间越大越好）。

另请注意，生日悖论可能不是您想要的。10% 的几率是任何两个条目发生冲突的几率，而不是下一个条目发生冲突的几率。

# jquery - 单击以使用旋转按钮增加 RadNumericTextBox 时，我如何在 jQuery 中获取 td 跨度值

> ID：10213710
> 
> 赞同：1
> 
> 时间：2012-04-18T16:23:44.157
> 
> 标签：jquery, asp.net, telerik

我有 TABLE，在其中我有几个 CELLS - PRICE、QUANTITY、TOTAL 当单击 RadNumericTextbox 旋转按钮时，id 想增加 TOTAL 单元格。

我有以下

```
 <tr>
        <td><a href="#" title="View Product Details"><asp:Label ID="LblTitleTableView" runat="server" Text=""></asp:Label></a></td>
        <td><asp:Label ID="LblWeightTableView" runat="server" Text=""></asp:Label></td>
        <td>
            <asp:Label CssClass="TabPrice" ID="LblProdPriceTV" runat="server" Text=""></asp:Label>
        </td>
        <td>
            <telerik:RadNumericTextBox ID="txtQuantity" CssClass="ProdDropDowns" RegisterWithScriptManager="true" Value="1" MinValue="1" runat="server" Width="50px" Type="Number" ShowSpinButtons="true" >
                <NumberFormat DecimalDigits="0" />
                <ClientEvents OnValueChanged="TabularProductQtyChanged"></ClientEvents>
            </telerik:RadNumericTextBox>
        </td>
        <td><asp:Label ID="LblTotalTableView" runat="server" Text=""></asp:Label></td>
        <td>
            <a href="javascript:void(0)">
                <asp:Image ID="AddBasketImgTableView" runat="server" ImageUrl="~/clients/14/themes/moredetails.png" AlternateText="Click for More Information" />
            </a>
        </td>
    </tr> 
```

和 jQuery

```
 function TabularProductQtyChanged(sender, args) {
    var qty = args._initialValue;

} 
```

我可以获得数量，但无法遍历 DOM 树以获取标签内的价格 - LblProdPriceTV

关于我如何做到这一点的任何想法？

编辑：

在下面的帮助下，我一直在 FireBug 中挖掘并意识到 RadNumericTextBox 控件注入了额外的 html 标记。因此我需要进一步备份 DOM 树以获取我想要的元素 - 这最终有效：

```
 alert($('#' + elementID).parent().parent().parent().parent().parent().parent().parent().parent().find('.ThisIsPrice').find('span').html()); 
```

谢谢大家在下面的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:37:18.207

我不能给你确切的工作代码，但这里有一个我相信可以让你到达那里的食谱。

```
function TabularProductQtyChanged(sender, args) {
    var qty = args._initialValue;
    //Get the client-side id of the element that fired the event
    //There might be a method like sender.get_id() or simply a property such as sender.id;
    //use firebug and find out.
    var elementID = sender.id; 
    //The cell you need seems to be a span (asp labels are displayed as span elements)
    var price = $('#'+elementID).closest('.TabPrice').html();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:38:47.207

我无法使用 提供演示`RadNumericTextBox`，但我可以使用构成控件的相同元素来模拟它。这是一个要演示的[小提琴。](http://jsfiddle.net/WA4Ge/5/)

这是代码：

```
<script type="text/javascript">    
    $(function(){
       $("#table1 td input[type='text']").siblings("a").click(function(){
           $(this).parents("td").next(".total").css({ 
               width : $(this).hasClass("up") ? "300px" : "200px" 
           });
       }); 
    });​    
</script>
<table id="table1">
    <tr>
        <td>
            <!-- RadNumericTextBox Start -->
            <span>
                <span>
                    <!-- the input -->
                    <input type="text" id="txt1" /> 
                    <!-- spin buttons -->
                    <a href="#" class="up">Up</a> 
                    <a href="#" class="down">Down</a> 
                </span>
            </span>
            <!-- RadNumericTextBox End -->
        </td>            
        <td class="total">TOTALS HERE</td>
    </tr>
</table>​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T17:46:42.917

```
function TabularProductQtyChanged(sender, args) {
    var elementID = sender.id;
    alert($('#' + elementID).parent().next('td').find('span').html());
} 
```

* * *

## 解释

```
1\. $('#' + elementID) - This means your `RadNumericTextBox`
2\. $('#' + elementID).parent() mans the td. This contains `RadNumericTextBox`.
3\. $('#' + elementID).parent().next('td').find('span') means the next td which 
                                       contains your Label control to traverse. 
```

# xml - Perl 中的 XML 解析和替换

> ID：10213716
> 
> 赞同：1
> 
> 时间：2012-04-18T16:23:59.223
> 
> 标签：xml, perl, xml-parsing

问这个问题感觉很愚蠢，但到目前为止已经浪费了整个下午，而且离解决方案还差得远。我正在自动推出一些 Jenkins 实例，并且我想复制现有的作业。

我正在解析 perl 脚本中的 config.xml 文件，并且需要替换某些字符串元素。

我几乎使用 XML::Simple 到达那里，但我发现它丢失了输出所需的数据结构。进一步阅读，我发现这就是 XML::Simple 的工作方式。所以我开始尝试 XML::LibXML

示例输入将是：

```
<project>
  <properties>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>
        <hudson.model.ChoiceParameterDefinition>
          <name>environment</name>
          <choices class="java.util.Arrays$ArrayList">
            <a class="string-array">
              <string>1</string>
              <string>2</string>
              <string>3</string>
              <string>4</string>
              <string>5</string>
            </a>
          </choices>
        </hudson.model.ChoiceParameterDefinition>
      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
    <de.pellepelster.jenkins.walldisplay.WallDisplayJobProperty/>
  </properties>
</project> 
```

例如，我想要实现的是删除所有`<string>n</string>` 元素，然后添加一些不同的元素。

而且代码应该比较简单：

```
my $p           = XML::LibXML->new;
my $d           = $p->parse_string($input);
my $params  = $d->findnodes('/project/properties/hudson.model.ParametersDefinitionProperty/parameterDefinitions/hudson.model.ChoiceParameterDefinition/choices'); 
```

这将返回一个节点列表。但我似乎无法操纵此列表中的元素。如果我做一个

```
print $params->to_literal; 
```

然后我可以看到我已经得到了我想要操作的数据。但我正在努力迈出下一步。谁能帮我指出正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T18:00:04.087

这是一个[XML::Twig](https://www.metacpan.org/module/XML%3a%3aTwig)`string`程序，它将删除`a`.

```
use v5.10;

my $xml = <<'HERE';
<project>
  <properties>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>
        <hudson.model.ChoiceParameterDefinition>
          <name>environment</name>
          <choices class="java.util.Arrays$ArrayList">
            <a class="string-array">
              <string>1</string>
              <string>2</string>
              <string>3</string>
              <string>4</string>
              <string>5</string>
            </a>
          </choices>
        </hudson.model.ChoiceParameterDefinition>
      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
    <de.pellepelster.jenkins.walldisplay.WallDisplayJobProperty/>
  </properties>
</project>
HERE

use XML::Twig;

my $twig = XML::Twig->new(   
    twig_handlers => { 
        a   => sub {
            foreach my $child ( $_->children ) {
                say "Found ", $child->text;
                $child->cut;
                }
            },
      },
    pretty_print => 'indented',
    );

$twig->parse( $xml );
$twig->flush; 
```

如果您想更改标签名称和文本，设置是相同的，但您需要稍微更改处理程序。

```
my $twig = XML::Twig->new(   
    twig_handlers => { 
        a   => sub {
            foreach my $child ( $_->children ) {
                $child->set_tag( 'new_name' );
                $child->set_text( $child->text ** 2 );
                }
            },
      },
    pretty_print => 'indented',
    ); 
```

一旦你决定如何遍历 DOM，Twig 将处理细节以改变它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T18:45:06.133

从`nodeList`您有一个[XML::LibXML::Node](http://search.cpan.org/~shlomif/XML-LibXML-1.96/lib/XML/LibXML/Node.pod)对象列表。你想要做的是遍历每个节点调用父节点的`removeChild`函数传入子节点。

下面是一个使用 XML::LibXML 的示例：

```
my $params  = $d->findnodes('/project/properties/hudson.model.ParametersDefinitionProperty/parameterDefinitions/hudson.model.ChoiceParameterDefinition/choices/a');
foreach my $node ($params->[0]->childNodes()) {

    $params->[0]->removeChild($node);
} 
```

我假设元素的父节点将始终命名为“a”，并且“选择”节点下只有一个节点。然后，您可以使用 再次打印出 XML `print $d->toString();`。

# binding - JAXB 绑定简单类型

> ID：10213723
> 
> 赞同：1
> 
> 时间：2012-04-18T16:24:22.457
> 
> 标签：binding, jaxb

我正在尝试从 xsd 生成类，但在尝试自定义简单类型时出现以下异常：

```
 com.sun.istack.SAXParseException2: A type safe enum customization is specified to a simple type that cannot be mapped to a type safe enum. 
```

抛出异常的简单类型的声明如下：

```
 <xs:simpleType name="BroadcastAlertsItem">
    <xs:annotation>
        <xs:appinfo>
        reserved (0)
        broadcastAlertsAccepted (1)
        broadcastAlertsNotAccepted (2)
     </xs:appinfo>
    </xs:annotation>
    <xs:union>
        <xs:simpleType>
            <xs:restriction base="xs:unsignedInt">
                <xs:minInclusive value="0"/>
                <xs:maxInclusive value="2"/>
            </xs:restriction>
        </xs:simpleType>
        <xs:simpleType>
            <xs:restriction base="xs:string">
                <xs:enumeration value="reserved"/>
                <xs:enumeration value="broadcastAlertsAccepted"/>
                <xs:enumeration value="broadcastAlertsNotAccepted"/>
            </xs:restriction>
        </xs:simpleType>
    </xs:union>
</xs:simpleType> 
```

这是绑定自定义文件中的绑定：

```
 <jaxb:bindings node="//xs:simpleType[@name='BroadcastAlertsItem']">
        <jaxb:typesafeEnumBase name="BroadcastAlertsItem">
            <jaxb:typesafeEnumMember name="reserved"/>
            <jaxb:typesafeEnumMember name="broadcastAlertsAccepted"/>
            <jaxb:typesafeEnumMember name="broadcastAlertsNotAccepted"/>
        </jaxb:typesafeEnumBase>
    </jaxb:bindings> 
```

如您所想，我已经尝试了更多方法来实现这一目标:(

有谁知道是否有一种方法可以在不修改 xsd 文件的情况下绑定该简单类型？

非常感谢。

# css - CSS Float 导致内容被下推到 HTML 页面

> ID：10213737
> 
> 赞同：7
> 
> 时间：2012-04-18T16:25:20.833
> 
> 标签：css

我创建了一个非常简单的网页布局，可以在这里看到： http: [//s361608839.websitehome.co.uk/greengold/www/index.html](http://s361608839.websitehome.co.uk/greengold/www/index.html)如您所见，似乎有问题。div #rightcol 似乎被左侧顶部的 div 向下推（#leftcolbanner）。

#leftcolbanner 的 CSS 是：

```
#leftcolbanner{
width: 707px;
height: 266px;
float: left;
background: url(../images/banner_home.gif) no-repeat;
margin: 20px 0 20px 20px;
-webkit-border-radius: 5px;
-moz-border-radius: 5px;
border-radius: 5px;
border: 1px solid #e1dbce;
} 
```

和#rightcol：

```
#rightcol{
width: 190px;
background: #f4f2ec url(../images/bg_rightcol.gif) no-repeat right bottom;
float: right;
min-height: 550px;
padding: 25px;
-moz-border-radius-topleft: 0px;
-moz-border-radius-topright: 5px;
-moz-border-radius-bottomright: 5px;
-moz-border-radius-bottomleft: 0px;
-webkit-border-radius: 0px 5px 5px 0px;
border-radius: 0px 5px 5px 0px;
border-left: 1px solid #e1dbce;
} 
```

#leftcolbanner 的宽度不应该是#rightcol 被下推的问题。根据我的经验，这似乎是通常唯一的原因，但这次并非如此。

任何人都可以看到我看不到的任何东西吗？

非常感谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T16:28:33.030

将`#rightCol`div 移到 div 上方`#leftCol`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:32:17.443

您可以将右列放在 3 个 div 容器的第一个位置，它应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:32:06.543

```
<div id="main">
<div id="leftcolbanner">
<h2>Willkommen im Ausbildungsstall Green&amp;Gold</h2>
<p>Ut ligula eros, consequat vitae varius eget, consequat ac neque. Vestibulum venenatis odio vitae erat tristique gravida in in elit. Duis molestie ante turpis.</p>
</div>
<div id="rightcol">
<h2>Kontact</h2>
<p><strong>GREEN&amp;GOLD GmbH</strong><br>
Dressurausbildungsstall<br>
Hauptstrasse 3<br>
4525 Balm b. Günsberg</p>

<p><a href="mailto:green-gold@bluewin.ch" class="emailbutton">green-gold@bluewin.ch</a></p>

<div id="rightcolline"></div>

<p><strong>Christian Pläge</strong><br>
+41 79 4 73 52 10</p>

<p><strong>Birgit Wientzek Pläge</strong><br>
+41 79 2 74 27 67<br>
Fax +41 32 6 37 08 53</p>

</div>
<div id="leftcol">
<p>Curabitur gravida tristique felis, eu lobortis neque iaculis vitae. In lacus dui, feugiat eu iaculis sit amet, laoreet ut quam. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.</p>
<p>Nullam interdum, justo in porta rutrum, sem velit pulvinar purus, id scelerisque orci sem sit amet lacus. Proin posuere nunc quis sapien hendrerit sollicitudin sollicitudin dolor egestas. </p>
<p>Sed nibh magna, imperdiet a ullamcorper vel, elementum at turpis. Quisque sed sem et tellus pretium pretium sed vel nulla. Suspendisse potenti. Vivamus vehicula ultrices enim, quis sagittis tortor dignissim ut. Nulla quis neque sed erat interdum porta. Donec iaculis libero eu justo volutpat volutpat condimentum metus rutrum. Quisque viverra mattis suscipit.</p>
</div>

</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T16:32:38.270

我认为你应该添加一个 div 与 float: left; 并将 leftcolbanner 和 leftcol 放在那里，它应该可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T16:35:30.157

更好的方法是将`#leftcolbanner`&`#leftcol`放在一个 DIV 中。然后给他们浮动，这样写：

**HTML**

```
<div class="left">
 <div id="leftcolbanner"></div>
 <div id="leftcol"></div>
</div>
<div id="rightcol"></div> 
```

**CSS**

```
.left{float:left}
#rightcol{float:right} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T16:41:03.543

您需要将这些 div 放在一个容器 div 中，以适应其内容的尺寸。在这个[jsfiddle](http://jsfiddle.net/TLymx/)中看到，通过将它们都放在一个带有 a 的 div 中`width:1000px`，它们并排排列。

# objective-c - 在桌面上显示进度条（透明窗口） - Cocoa

> ID：10213740
> 
> 赞同：0
> 
> 时间：2012-04-18T16:25:38.080
> 
> 标签：objective-c, xcode, macos, cocoa, user-interface

好吧，这可能很难描述，但我想要的是：

当应用程序启动时，我希望它加载几个组件，并且我想显示一个进度条，加载到 100% 完成。但是为了界面的缘故，我只想要桌面上的进度条。我不想要 Window 控件或背景。我的自定义进度条应该出现在桌面上，加载到 100%，然后显示窗口，从而显示整个应用程序。

顺便提一下，我希望在 Xcode 中开发的 Mac App 中使用它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T19:57:46.893

我强烈建议你考虑一下你正在考虑的视觉效果和你所做的假设。我认为这是“糟糕的设计”：

1.  用户可以将*任何东西*作为桌面图片。如果我的背景恰好是蓝色的……而您的自定义进度条是蓝色的……那么我将看不到进度条，并且会想知道为什么您的应用程序没有响应。 *“去他妈的这个应用程序，我一启动它就挂了。删除！”*
2.  用户有可能运行了多个应用程序。您的“浮动进度条”会在其他应用程序窗口的海洋中丢失。（为什么 iTunes 正在加载一些东西？哦等等！！这是另一个没有窗口的东西...... *“不直观！不酷”*）
3.  这不是很像 Mac。不要忘记每个平台都有关于如何成为好公民的规则。Metro 应用程序需要遵循特定的接口范式。同样，“Mac-like”也有一些说法，我认为这种行为不是（浮动进度条）。

我**强烈**建议您将进度条保持在正确命名的模式窗口中。应用程序进出最前面......所以了解进度条的相关内容也很重要。

如果您考虑了所有这些，以下问题应该可以帮助您入门： [如何使 NSView 透明并显示 NSWindow 下的内容？](https://stackoverflow.com/q/8217487/1040049)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T19:56:59.133

您可能在谈论无边框`NSWindow`( `NSBorderlessWindowMask`)，其 alpha 设置为零的不透明背景视图和`NSProgressIndicator`显示进度的子视图。您可能还想使用该`-[NSWindow center]`方法很好地居中您的窗口。

但是，我怀疑您是否想要那种 UI。进度条可能在所有桌面上都不可见，因此在美学上毫无价值。

我认为圆形、半透明的黑色窗口更适合您的情况。看看[Matt Gemmell 的源代码](http://mattgemmell.com/source/#roundedfloatingpanel)。

# xml - XSD：如何接受与任何一组类型匹配的数据？

> ID：10213741
> 
> 赞同：1
> 
> 时间：2012-04-18T16:25:42.270
> 
> 标签：xml, xsd

在我的架构中，我想接受一个包含格式为 [`date`](http://www.w3.org/TR/xmlschema-2/#date)或的数据的元素[`dateTime`](http://www.w3.org/TR/xmlschema-2/#dateTime)。

例如，这些元素中的任何一个都应该验证：

```
<event_ts>2012-04-18</event_ts>
<event_ts>2012-04-18T12:00:00</event_ts>
<event_ts>2012-04-18T12:00:00Z</event_ts>
<event_ts>2012-04-18T12:00:00-05:00</event_ts> 
```

如果我只使用`dateTime`此元素的类型，我的第一个示例将无法通过验证，因为`dateTime`规范规定必须存在一天中的时间部分。

*XML Schema 中是否存在诸如类型*枚举而不是显式字符串之类的东西？

我真的宁愿避免在这里用一个大的正则表达式重新发明 ISO 8601 轮子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:55:29.540

我会为你的 event_ts 使用一种新类型，它被定义为 xs:date 和 xs:dateTime 的联合。

```
<?xml version="1.0" encoding="utf-8" ?>
<xsd:schema elementFormDefault="qualified" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element name="event_ts">
        <xsd:simpleType>
            <xsd:union memberTypes="xsd:date xsd:dateTime"/>
        </xsd:simpleType>
    </xsd:element>
</xsd:schema> 
```

那么你的 XML 是有效的......

# vim - VIM html自动缩进不起作用

> ID：10213744
> 
> 赞同：8
> 
> 时间：2012-04-18T16:25:56.513
> 
> 标签：vim, indentation

我尝试让 autoindent 使用 html 文件在 VIM 中工作，但不幸的是它不起作用。Autoindent 与其他语言完美配合，但它不适用于 html。[按照这个](https://stackoverflow.com/questions/459478/correct-indentation-of-html-and-php-using-vim)问题的建议，我已经尝试将 to 设置`filetype`为，但不幸的是它也不起作用。此外，当我选择所有内容并按下它时，它也不会缩进，即使 vim 报告.`html``=``XX lines indented`

我的 .vimrc 文件如下所示：

```
set autoindent 
set cindent 
set tabstop=4 
set shiftwidth=2 
set expandtab 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-18T18:15:15.617

您必须添加以下行以`.vimrc`确保 vim 使用特定于文件的缩进：

```
filetype on
filetype plugin on
filetype indent on 
```

这样，当文件类型设置为 时，它会将 html 缩进为 html `html`。

# javascript - Jquery + Knockoutjs GUI 动画

> ID：10213750
> 
> 赞同：0
> 
> 时间：2012-04-18T16:26:15.800
> 
> 标签：javascript, jquery, knockout.js

好吧，我一直在尝试制作一个 gui 组件，当您将鼠标移动到页面底部[http://jsfiddle.net/62u3A/4/](http://jsfiddle.net/62u3A/4/)时它会向上滑动，但它不能很好地工作，是否有人有一个好的想法如何使它更好地工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T21:51:57.447

至于我，你选择了错误的事件来处理。我尝试了 mouseenter/mouseleave - 看起来效果很好。停止动画也是个好主意

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:34:35.697

在 .slideup() 之前添加 .stop()

[jQuery 停止](http://api.jquery.com/stop/)

[jsfiddle](http://jsfiddle.net/62u3A/5/)

# c# - 如何在初始化时加载用户控件

> ID：10213754
> 
> 赞同：2
> 
> 时间：2012-04-18T16:26:28.600
> 
> 标签：c#, wpf, xaml, user-controls

如何在初始化时加载用户控件？我的构建中有一个用户控件，位于 appPages 文件夹中。用户控件称为 FindMe。

我试过了：

```
public MainWindow()
{         
InitializeComponent();
PanelMainContent.Children.Add(UserControl(appPages.FindMe)); 
```

但是我的语法是错误的，因为 usercontrol 是一种类型，但它说它像变量一样被使用..：S

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:40:57.037

您需要实例化您的控件：

```
PanelMainContent.Children.Add(new appPages.FindMe()); 
```

或者，如果您的控件已命名`UserControl`并且 appPages.FineMe 是静态属性？：

```
PanelMainContent.Children.Add(new UserControl(appPages.FindMe)); 
```

至少听起来是这样的。无论您的控件名称是什么，您都必须使用`new`它，这就是您`Add`想要`Children`的`PanelMainContent`

# javascript - Javascript 中的实时摩尔斯电码转换器

> ID：10213760
> 
> 赞同：7
> 
> 时间：2012-04-18T16:26:41.330
> 
> 标签：javascript, regex

在看到谷歌关于 gmail 莫尔斯电码的愚人节笑话后，我想我会尝试在 javascript 中创建一个实时莫尔斯电码转换器。

我正在使用正则表达式和替换将莫尔斯电码更改为字符。例如：

```
.replace(/.- /g, "a").replace(/.-. /g, "r") 
```

我遇到的问题是，当我输入`.-.`“r”时，它会给我一个“a”，因为它`.-`首先看到。我怎样才能让它只替换完全匹配？

**更新**和工作！感谢每一位帮助过我的人

[http://jsfiddle.net/EnigmaMaster/sPDHL/32/](http://jsfiddle.net/EnigmaMaster/sPDHL/32/) - 我的原始代码

[http://jsfiddle.net/EnigmaMaster/LDKKE/6/](http://jsfiddle.net/EnigmaMaster/LDKKE/6/) - 由 Shawn Chin 重写

[http://jsfiddle.net/EnigmaMaster/y9A4Y/2/](http://jsfiddle.net/EnigmaMaster/y9A4Y/2/) - 由 Matthias Tylkowski 重写

如果有人有其他编写此程序的方法，请发布[JsFiddle](http://jsFiddle.net)

我很想看看还能怎么做

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:41:19.967

您的问题突出了一个有趣的事实：**摩尔斯电码不是[前缀码](http://en.wikipedia.org/wiki/Prefix_code)**。因此，您需要某种分隔符（空格、逗号等）来分隔代码符号。

您似乎已决定使用空格，这很好。

话虽这么说，您的正则表达式中缺少的是点符号的转义（使用`/\.- /`而不是`/.- /`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T04:13:39.513

另一种方法是使用二分搜索。

![在此处输入图像描述](../Images/cb0e45f7d655d76442498c21046e5607.png)

二分搜索表的图形表示：用户在每个点处向左分支，在每个破折号处向右分支，直到字符完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:34:11.173

如果您一次处理一个莫尔斯字符，请从最长的序列开始，一直到较短的序列。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T16:34:37.523

您应该优先考虑您的规则并首先应用较长短语的替换：

```
.replace(/\.-\./g,'r')// longer
.replace(/\.-/g,'a')// shorter 
```

我建议您制作一个字典并按模式长度对其进行排序，然后替换字符串：

```
var str = '.-.-.';
var dictionary = [
    ['a', '\.-'],
    ['r', '\.-\.']
    // ... and so on
];
dictionary
    .sort(function(a,b){
        return a[1] > b[1];
    })
    .forEach(function(el,i){
         str = str.replace(new RegExp(el[1],'g'),el[0]);
    }); 
```

抱歉缺少括号，我似乎在手机上找不到它们。

**更新**：我已经避开了正则表达式中使用的点——我一开始就错过了。 **update2**：添加了括号 :) 您可以使用字典中未转义的点并即时转义它们：

```
 var dictionary = [
    ['a', '.-'],
    ['r', '.-.']
];
dictionary
    .sort(function(a,b){
        return a[1] > b[1];
    })
    .forEach(function(el,i){
         str = str.replace(new RegExp(el[1].replace(/([^\]\.)/g,'$1\.'),'g'),el[0]);
    }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T16:34:46.710

你必须逃避“。” 人物：

```
/\.- / 
```

代替

```
/.- / 
```

换句话说。在正则表达式中，“.” 匹配任何字符。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-18T16:42:42.493

在正则表达式中，点匹配任何字符，并且您似乎在没有适当的转义的情况下使用它：

```
/./  // this will match any character
/\./ // this will match a dot (".") character 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-19T09:05:55.490

其他答案已经涵盖了您的示例不起作用的原因，因此我将避免重复它们。

但是，我可以建议，由于您已经使用空格来分隔每个代码，一个直接的解决方案是做一个简单`.split()`的将输入文本分割成单独的单元，然后简单地做一个一对一的代码映射到字符。这将比重复的正则表达式替换更有效，并且更不容易出错。

例如：

```
var morse = {  // use object as a map
    '.-': 'a', 
    '-...': 'b', 
    '-.-.': 'c', 
    // .... the rest ...
};

function translate_morse(code) {  // given code, return matching char
    return (typeof morse[code] === "undefined") ? "" : morse[code];
    // if the var is not found, the code is unknown/invalid. Here we 
    // simply ignore it but you could print out the code verbatim and use
    // different font styles to indicate an erroneous code
}

// example usage
translated = code_text.split(" ").map(translate_morse).join(""); 
```

这是一个工作示例：http: [//jsfiddle.net/KGVAm/1/](http://jsfiddle.net/KGVAm/1/)

ps 我冒昧地稍微调整了代码和行为，即禁用其他字符的输入，但允许使用 backscape 进行更正。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-18T16:47:07.583

我认为这里的技巧是将某人键入的字符串拆分为块。每个“.”序列之后应该有一个空格。和 ”-”。然后您可以运行该数组并将每个条目替换为相应的字母。我会用一个开关。最后，您将数组作为字符串连接在一起并显示它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-07-29T13:16:49.317

对于那些正在寻找整个翻译*表*的人：

[这是一个**演示**](http://tools.timodenk.com/morse-code-to-text "演示")，这里是整个[**源**代码](https://github.com/Simsso/Online-Tools/blob/master/page/logic/morse-code-to-text.js "源代码")。

```
var morseCode = {
    '.-': 'a',
    '-...': 'b',
    '-.-.': 'c',
    '-..': 'd',
    '.': 'e',
    '..-.': 'f',
    '--.': 'g',
    '....': 'h',
    '..': 'i',
    '.---': 'j',
    '-.-': 'k',
    '.-..': 'l',
    '--': 'm',
    '-.': 'n',
    '---': 'o',
    '.--.': 'p',
    '--.-': 'q',
    '.-.': 'r',
    '...': 's',
    '-': 't',
    '..-': 'u',
    '...-': 'v',
    '.--': 'w',
    '-..-': 'x',
    '-.--': 'y',
    '--..': 'z',
    '-----': '0',
    '.----': '1',
    '..---': '2',
    '...--': '3',
    '....-': '4',
    '.....': '5',
    '-....': '6',
    '--...': '7',
    '---..': '8',
    '----.': '9',
    '.--.-': 'à',
    '.--.-': 'å',
    '.-.-': 'ä',
    '----': 'ch',
    '.-..-': 'è',
    '..-..': 'é',
    '---.': 'ö',
    '..--': 'ü',
    '...--..': 'ß',
    '--.--': 'ñ',
    '.-.-.-': '.',
    '--..--': ',',
    '---...': ':',
    '-.-.-.': ';',
    '..--..': '?',
    '-....-': '-',
    '..--.-': '_',
    '-.--.': '(',
    '-.--.-': ')',
    '.----.': '\'',
    '-...-': '=',
    '.-.-.': '+',
    '-..-.': '/',
    '.--.-.': '@'
}; 
```

# emacs - 下面的语句是如何被 emacs 解释的

> ID：10213763
> 
> 赞同：2
> 
> 时间：2012-04-18T16:26:50.737
> 
> 标签：emacs

[https://stackoverflow.com/a/663636/391104](https://stackoverflow.com/a/663636/391104)

```
(defun my-c++-mode-hook ()
  (setq c-basic-offset 4)
  (c-set-offset 'substatement-open 0))
(add-hook 'c++-mode-hook 'my-c++-mode-hook) 
```

根据我的调查，我只需要将上面的代码添加到我的 .emacs 中，然后它就可以神奇地工作了。

Q1> 什么`defun my-c++-mode-hook ()`意思？lisp 中的函数定义？

Q2> 下面一行的用途是什么？我应该在哪里触发它或者它由 emacs 自动运行

```
(add-hook 'c++-mode-hook 'my-c++-mode-hook) 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:41:22.697

Q1：是的，这是一个函数定义（因此`defun`）。第二个符号是名称，其后缀为“-hook”，向人类表明它旨在用作钩子。它可以（几乎）任意命名而不改变其行为。空`()`表示该函数不接受任何参数。其他一切都是函数的主体。

Q2：基本上，这会将指向前一个函数的指针添加到`c++-mode`启动时调用的函数列表中。每当您启动一个模式时，Emacs 都会查找该模式挂钩，并运行其中的所有函数。函数定义和 add-hook 行都需要放在你的 .emacs 中，它们会在你启动 emacs 时自动运行。

为了让您了解 elisp，强烈建议您进行介绍。它随 emacs 一起提供，可以从 info system: 访问`C-h i`，然后查找 Elisp Introduction。

# javascript - 如何仅在方向显示结束后运行函数？

> ID：10213764
> 
> 赞同：0
> 
> 时间：2012-04-18T16:26:54.330
> 
> 标签：javascript, google-maps-api-3

我正在跟进[这个问题](https://stackoverflow.com/q/10211559/1238040)，其中有一个异步请求来绘制从 A 点到 B 点的路线，称为`setDirections`. 最后，我们希望端点位于中心，但默认情况下地图中心显示大部分路线。简单地添加`setCenter(endpoint)`after`setDirections`不会导致在端点居中。

我通过使用 setTimeout 进行推理，这`setDirections`似乎是另一个异步函数，因为在稍等片刻之后，地图将按我的意愿居中。

那么我怎样才能确保我的`setCenter`跑步只在`setDirections`完成之后呢？我考虑过回调，但它没有做我想要的。

在我的代码中，我使用[Recurial](http://recurial.com/programming/understanding-callback-functions-in-javascript/)和[JavaScript Callback 中的模式在调用函数后执行](https://stackoverflow.com/questions/4700424/javascript-callback-after-calling-function)了以下操作：

1.  用`function wrapper (callback) {`
2.  方向请求和绘图是异步的，所以在成功响应块内，我调用 `callback(this.marker.getPosition())`
3.  定义后`wrapper`，我打电话`wrapper(function(latLng) { map.setCenter(latLng) })`

这是一个JSFiddle。[http://jsfiddle.net/EeXQF/2/](http://jsfiddle.net/EeXQF/2/)

setTimeout“解决方案”就在那里，只需要取消注释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:27:42.703

（老实说，我并没有真正按照您的要求进行操作，我想您的问题有很多背景，而我只是没有。）

但是，需要注意的一点是，Javascript 通常是单线程的。一次只执行一段代码。

所以你的代码要求发生一些事情。但这通常不会发生，而您的代码仍在运行。当您的代码完成时，浏览器将执行它。您“开始”的操作将被添加到队列中，并稍后运行。

setTimeout，将回调添加到队列的末尾。所以主要功能将完成。地图将有机会做它的事情（它在队列中有东西），然后你的回调将被触发。

（它比现实更复杂，但可能有助于解释你所看到的）

# windows-xp - 识别 DNS 请求的 PID 源 (Windows XP)

> ID：10213765
> 
> 赞同：3
> 
> 时间：2012-04-18T16:27:07.353
> 
> 标签：windows-xp, dns, pid

我希望确定发出 DNS 请求的进程。查看查询给了我一个线索，但不能帮助我确定确切的过程。

我可以在 Wireshark 中看到本地端口号，但请求太短暂，无法被 TCPView 接收。

是否有可以捕获 DNS 请求和 PID 的日志记录工具？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-19T02:11:03.237

[Sysinternals 的Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645 "进程监视器")将为您提供所需的一切。将捕获限制为仅网络活动，您将看到活动以及 PID 和进程名称。操作将是**UDP 发送**，路径将如下所示：*pc-host-name:port -> dns-server:domain*（注意“:domain”表示 dns 的端口 53）。进程名称和 pid 将在左侧。

起初我打算推荐使用 Netmon 3.4（来自 Microsoft），因为这将显示进程名称和 pid（需要将 pid 添加为列）。但是，这对我来说似乎很麻烦，因为大多数流量都没有使用进程名称/pid 进行标记。我不确定为什么会这样，但它可能对你有用。

# jquery - 如何根据周围 p 标签的类在输入上触发 jquery 事件？

> ID：10213769
> 
> 赞同：0
> 
> 时间：2012-04-18T16:27:15.683
> 
> 标签：jquery, jquery-selectors

当用户在下面的文本字段内单击时，我将如何触发事件。我遇到的问题是我可以添加 id/class 的唯一标签是

它位于实际表单域之外。

```
<p class="trigger">
<input type="text" name="test">
</p> 
```

我不想在输入标签上使用通用触发器，这不合适

```
$(input).focus(function() {
  alert('triggered');
}); 
```

它确实需要与 p 类“触发器”相关联，任何帮助都会很棒

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:29:25.190

你有没有尝试过

```
$('.trigger input').focus(function() {
  alert('triggered');
}); 
```

**[现场演示](http://jsfiddle.net/loktar/HB7Pz/)**

# jakarta-ee - 在不使用名称的情况下将具有映射名称的 ejb bean 注入另一个 bean

> ID：10213776
> 
> 赞同：0
> 
> 时间：2012-04-18T16:27:34.997
> 
> 标签：jakarta-ee, dependency-injection, ejb, jndi, lookup

我在 glassfish 上的 EAR 中有两个 ejb，它们都实现了远程接口，为什么它们都有一个映射名称分配给它们以用于客户端 jndi 查找。

现在我想将一个注入另一个。我成功地在我的 ejb 中注入了一个没有任何注释名称的 Singleton Bean。
但这在这里不起作用。

是否有必要在这里进行 JNDI 查找，即使它是本地的？

```
@Stateless(mappedName = "ChildBean")
public class ChildBean implements ChildBeanRemote {}

@Stateless(mappedName = "ParentBean")
public class ParentBean implements ParentBeanRemote
{
    @EJB
    private ChildBean childBean;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:14:56.523

我认为应该是

```
@Stateless(mappedName = "ChildBean")
public class ChildBean implements ChildBeanRemote {}

@Stateless(mappedName = "ParentBean")
public class ParentBean implements ParentBeanRemote
{
    @EJB
    private ChildBeanRemote childBean; //You should use the interface and not the bean
} 
```

# objective-c - 通过控制台从 JavaScript 调用 Obj-C 代码：参数被丢弃？

> ID：10213777
> 
> 赞同：9
> 
> 时间：2012-04-18T16:27:44.293
> 
> 标签：objective-c, macos, cocoa, webkit

和这个玩得很开心。

我有一个超级简单的 Cocoa 应用程序，其中包含一个 WebView、一个在页面中定义的 WebScripting API，以及在该 API 上定义的一个 NSObject。当我打开调试器工具（在嵌入式 WebView 中）时，我可以在 JavaScript 窗口对象上看到 API，并且可以看到我在其上定义的“api”属性——但是当我调用 API 的“get”方法时，参数没有被序列化——当调用 Obj-C 方法时，参数丢失了。见下文，希望能说明：

![在此处输入图像描述](../Images/f5a9e64422be043cc5e453b83292167f.png)

我已经梳理了文档，我（显然）设置了适当的方法来公开需要公开的所有内容，并且我可以看到正在调用的方法。我必须有一些愚蠢的东西，但作为这个环境的相对新手，我没有看到它。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-01T19:34:24.367

当您发送 -[NSUserDefaults registerDefaults:] 时，您是否在默认用户默认值中将 WebKitDeveloperExtras 设置为 YES？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-01T16:56:27.770

根据您使用的 Xcode 版本，您可能会遇到已知错误。如果您在除最新版本之外的任何东西上使用 LLDB，它可能不会在调试器中为您提供正确的变量。在 Apple 解决问题之前，解决方案一直是使用 GDB 而不是 LLDB。但我认为他们在最新版本中解决了这个问题。我会更改调试器以使用 GDB 并查看您是否在 Xcode 中获得了正确的变量。（产品-> 编辑方案...-> 运行-> 调试器）。不过，我在 iOS 中遇到了这个问题，所以我不知道它对 OSX 的适用性。总之值得一试。

我最初在这里遇到了这个问题：[https ://stackoverflow.com/a/9485349/1147934](https://stackoverflow.com/a/9485349/1147934)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-08T17:10:30.707

我在应用程序的主线程中从存储在应用程序目录中的本地文件处理 javascript。我检查我正在执行的 js 函数的开始和结束标记，以及该函数是否包含变量。

希望这可以为您的问题提供一些好的想法。您还可以在 js 中发出警报，以查看在您运行应用程序时值是否正确发布（我相信您已经想到了这一点，但值得一提。）快乐编码！我希望这有帮助！

在 .h 文件中定义：

```
NSMutableString *processedCommand;
NSArray *commandArguments; 
```

在 .m 文件中：

```
// tokens
#define kOpenToken @"<%%"
#define kCloseToken @"%%>"

// this will throw
-(void)executeJScriptCommand:(NSString *)aCommand {

[self performSelectorOnMainThread:@selector(executeThisCommand:) withObject:aCommand waitUntilDone:YES];
}

// this will throw 
-(NSString *)executeCommand:(NSString *)command {

NSString *aCommand = [[[command stringByReplacingOccurrencesOfString:kOpenToken withString:@""] 
                       stringByReplacingOccurrencesOfString:kCloseToken withString:@""] 
                      stringByTrimmingLeadingAndTrailingWhitespaces];

if ([aCommand hasPrefix:@"="])
{
    // variable. get value
    [self getVariableFromCommand:aCommand]; 
}
else {
    [self executeThisCommand:aCommand];
}

NSString *returnValue = [NSString stringWithString:processedCommand];

self.processedCommand = nil;
self.commandArguments = nil;

return returnValue;
}

-(void)executeThisCommand:(NSString *)aCommand {

BOOL hasError = NO;

// clear result
self.processedCommand = nil;
self.commandArguments = nil;

BOOL isFromJS = NO;
NSString *function = nil;
NSMutableArray *commandParts = nil;

@try {
    // first, break the command into its parts and extract the function that needs to be called, and the (optional) arguments
    commandParts = [[NSMutableArray alloc] initWithArray:[aCommand componentsSeparatedByString:@":"]];
    if ([[[commandParts objectAtIndex:0] lowercaseString] isEqualToString:@"js-call"]) {
        isFromJS = YES;
        [commandParts removeObjectAtIndex:0];
    }

    // get our function, arguments
    function = [[commandParts objectAtIndex:0] retain];
    [commandParts removeObjectAtIndex:0];

    if ([commandParts count] > 0){
        if (isFromJS == YES) {
            NSString *arguments = [[commandParts objectAtIndex:0] stringByReplacingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
            if ([arguments length] > 0) {
                self.commandArguments = [arguments JSONValue];
            }
        }
        else {
            self.commandArguments = [NSArray arrayWithArray:commandParts];
        }
    }

    // build invoke
    SEL sel = NSSelectorFromString(function);

    if ([self respondsToSelector:sel]) {

        [self performSelectorOnMainThread:sel withObject:nil waitUntilDone:YES];

        // using invocation causes a SIGABORT because the try/catch block was not catching the exception.
        // using perform selector fixed the problem (i.e., the try/catch block now correctly catches the exception, as expected)

    }
    else {
        [appDelegate buildNewExceptionWithName:@"" andMessage:[NSString stringWithFormat:@"Object does not respond to selector %@", function]];
    }

}
@catch (NSException * e) {
    hasError = YES;
    [self updateErrorMessage:[NSString stringWithFormat:@"Error processing command %@: %@", aCommand,  [e reason]]];
}
@finally {
    [function release];
    [commandParts release];
}

if (hasError == YES) {
    [appDelegate buildNewExceptionWithName:@"executeThisCommand" andMessage:self.errorMessage];
}
}

// this can return nil
-(NSString *)getQueryStringValue:(NSString *)name {

NSString *returnValue = nil;
if (queryString != nil) {
    returnValue = [queryString objectForKey:[name lowercaseString]];
}

return returnValue;
} 
```

# objective-c - 类别实例方法不调用

> ID：10213786
> 
> 赞同：0
> 
> 时间：2012-04-18T16:28:29.293
> 
> 标签：objective-c, ios, xcode, methods, categories

我有一个类（生成的核心数据）：

```
@interface Place : NSManagedObject

 @property (nonatomic, retain) NSString * title;
 @property (nonatomic, retain) NSString * subtitle;
 @property (nonatomic, retain) NSNumber * latitude;
 @property (nonatomic, retain) NSNumber * longitude;

@end
@implementation Place

@dynamic title;
@dynamic subtitle;
@dynamic latitude;
@dynamic longitude;

@end 
```

为它添加一个类别：

```
@interface Place (Create)
+ (Place *)placeWithTitle:(NSString *)title
        inManagedObjectContext:(NSManagedObjectContext *)context;

+(Place *) placeWithTitle:(NSString *)title andSubtitle:(NSString *)subtitle inManagedObjectContext:(NSManagedObjectContext *)context;
+(Place *) placeWithCoordinate:(CLLocationCoordinate2D) coordinate inManagedObjectContext:(NSManagedObjectContext *)context;
- (void) setLattitudeAndLongitudeByCoordinate:(CLLocationCoordinate2D) coordinate;

- (CLLocationCoordinate2D) coordinate;
@end 
```

在这个类别中，必须实例化方法：

```
- (void) setLattitudeAndLongitudeByCoordinate:(CLLocationCoordinate2D) coordinate
{
    self.latitude=[NSNumber numberWithDouble:coordinate.latitude];//break point HERE
    self.longitude=[NSNumber numberWithDouble:coordinate.longitude];
}

-(CLLocationCoordinate2D) coordinate
{
    CLLocationCoordinate2D coord;//break point HERE
    coord.latitude=[self.latitude doubleValue];
    coord.longitude=[self.longitude doubleValue];
    return coord;
} 
```

如您所见，我必须在那里设置断点。现在，然后我调用这些方法

```
#import "Place+Create.h"

-(void)someMethod
{
    [self.place setLattitudeAndLongitudeByCoordinate:coordiante];
} 
```

它似乎永远不会到达方法 setLattitudeAndLogitudeByCoordinate 中的那些断点，并且调试表明它甚至没有调用它们！为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:32:54.413

有`someMethod`没有达到？`NSLog`检查是否在其头部使用断点或额外的。

如果不是，那么您的问题出在其他地方，因为您的程序流程与您预期的不同。

如果达到了，那么`self.place`显然是`nil`。这意味着您从未再次初始化它，您的程序流程与您想象的不同。

# java-native-interface - glassfish 3.1.1 '唯一' JNI 错误

> ID：10213787
> 
> 赞同：1
> 
> 时间：2012-04-18T16:28:30.177
> 
> 标签：java-native-interface, glassfish-3

使用本机代码的 web 应用程序在 Glassfish 2.x 中运行良好。

在 3.1.1 中，它失败了：

```
[#|2012-04-18T14:43:08.330+0000|SEVERE|glassfish3.1.2|com.sun.jersey.spi.container.ContainerResponse|_ThreadID=21;_ThreadName=Thread-2;|The exception contained within MappableContainerException could not be mapped to a response, re-throwing to the HTTP container
java.lang.UnsatisfiedLinkError: com.basistech.rnt.jni.initializeEnvironmentSpecificRootDirectory(Ljava/lang/String;)Z
    at com.basistech.rnt.jni.initializeEnvironmentSpecificRootDirectory(Native Method) 
```

请注意，这是抱怨特定符号而不是整个库的链接错误的版本。

相同的 JNI 库可以在同一台机器上的 Glassfish*之外*的示例 Java 程序中正常运行。

阅读 JDK 源代码，这似乎只有在`dlsym`（我们在 Linux 上）未能返回符号时才有可能。（这都是Java 1.6.x。）我很难理解Glassfish 可能正在做什么，这会导致`dlsym`无法在共享库中看到这个符号。

有什么想法吗？

# android - Android - 自定义listView，每行不同颜色

> ID：10213789
> 
> 赞同：1
> 
> 时间：2012-04-18T16:28:36.103
> 
> 标签：android, android-listview, custom-lists

我创建了自定义列表视图，每一行看起来都像我的文件 custom_row.xml。有什么办法，如何分别为每一行设置不同的背景颜色（我需要设置它，因为我的行可以有不同的值）。

感谢您的任何想法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:52:03.030

由于您在为 custom_row.xml 充气后在 getView 方法中执行自定义列表视图，因此更改了 inflate 方法的返回视图的背景。请参阅下面的示例片段：

```
public getView(int position, View convertView, ViewGroup parent) {
       convertView = getLayoutInflater().inflate(R.layout.custom_xml, null);
       do some stuff...

       //let say you have an arraylist of color
       convertView.setBackgroundColor(arraylist.get(position));

       //in case that your color is limited, just re-use your color again
       //and some logic how to re-use the colors.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T05:46:12.520

在此处使用其他答案会阻止选择器正常工作，并且选择器停止完全突出显示行。通过按照接受的答案中的描述手动设置颜色，选择器在滚动时停止突出显示行。因此，让我描述一个不会弄乱您的选择器的解决方案。

[这篇文章](http://daniel-codes.blogspot.com/2010/07/how-to-change-listview-rows-background.html)描述了如何用透明度来解决这个问题，但我无法真正让它发挥作用。所以我的解决方案是我的可绘制文件夹中有两个列表选择器。这样我可以在运行时设置两种不同的背景颜色并保持选择器工作。

list_selector_darkgrey.xml 用于我的深灰色线

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:drawable="@drawable/gradient_bg_darkgrey" android:state_pressed="false" android:state_selected="false"/>
<item android:drawable="@drawable/gradient_bg_hover" android:state_pressed="true"/>
<item android:drawable="@drawable/gradient_bg_hover" android:state_pressed="false" android:state_selected="true"/>
</selector> 
```

和 list_selector.xml 为浅灰色线

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
<item android:drawable="@drawable/gradient_bg" android:state_pressed="false" android:state_selected="false"/>
<item android:drawable="@drawable/gradient_bg_hover" android:state_pressed="true"/>
<item android:drawable="@drawable/gradient_bg_hover" android:state_pressed="false" android:state_selected="true"/>
</selector> 
```

请忽略drawable中的渐变，您可以将其替换为您的颜色。

在 BaseAdapter 类中，我将调用 setBackgroundResource 以将一些行显示为浅灰色，将其他行显示为深灰色。选择器颜色相同，并在 XML 文件中定义。

```
public View getView(int position, View convertView, ViewGroup parent) {
    View vi = convertView;

    if (convertView == null)
        vi = inflater.inflate(R.layout.list_row, null);

             ... some logic ...

    if (... some condition ...) {
        vi.setBackgroundResource(R.drawable.list_selector_darkgrey);
    }
    else { 
        vi.setBackgroundResource(R.drawable.list_selector);
    }
    return vi;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:34:04.033

在适配器中，您可以在使用 getView 方法检索视图时手动设置视图的背景颜色。

```
 // set the background to green
    v.setBackgroundColor(Color.GREEN); 
```

# javascript - 如何使两个可折叠的div互斥

> ID：10213790
> 
> 赞同：0
> 
> 时间：2012-04-18T16:28:38.357
> 
> 标签：javascript, twitter-bootstrap

我有两个基于 twitter 的[bootstrap](http://twitter.github.com/bootstrap)的可折叠 div A(collapseOne) 和 B(collapseTwo) 。当B展开时如何使A折叠，反之亦然？

我的代码如下所示，

```
 <div class="shop-details" id="shop-accordion">
      <div id="collapseOne" class="shop-brief clearfix collapse hide">
          <h2 class="yahei ft30">MyName</h2>
          <span class="unfold"><a data-toggle="collapse" data-parent="#shop-accordion" href="#collapseOne"><i class="path-down"></i>Show details</a></span>
      </div>
      <dl id="collapseTwo" class="shop-ds clearfix collapse in">
           <dt>
                <a href="#" target="_parent"><img src="images/pt-small.jpg" width="246" height="169"></a>
                <div class="shop-ds-txt">
                     <h2 class="yahei ft30">MyName</h2>
                     <ul class="shop-ds-ul">
                         <li>Item1</li>
                         <li>Item2</li>
                         <li>Item3</li>
                         <li>Item4</li>
                         <li>Item5</li>
                     </ul>
                 </div>
            </dt>
            <dd>
               <div class="unfold-positon">
                     <div><span class="unfold"><a data-toggle="collapse" data-parent="#shop-accordion" href="#collapseTwo"><i class="path-up"></i>Show brief</a></span></div>
               </div>
           </dd>
      </dl>

  </div> 
```

我想 div`collapseOne`是隐藏`collapseTwo`的，默认是可见的。单击链接后`Show brief`，`collapseTwo`隐藏并`collapseOne`显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:28:42.190

只需使用[他们随文档提供的示例](http://twitter.github.com/bootstrap/javascript.html#collapse)。我在这里为你简化了它，确保你所有的 div 都相同`data-parent`，以便充当手风琴。

```
<div class="accordion" id="my-accordion">
    <div class="accordion-group">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#my-accordion" href="#collapseOne">
              Toggle 1
        </a>
        <div id="collapseOne" class="accordion-body in" style="height: auto; ">
            <div class="accordion-inner">
                Inner content 1
            </div>
        </div>
    </div>
    <div class="accordion-group">
        <a class="accordion-toggle" data-toggle="collapse" data-parent="#my-accordian" href="#collapseTwo">
           Toggle 2
        </a>
        <div id="collapseTwo" class="accordion-body collapse">
            <div class="accordion-inner">
              Inner content 2
            </div>
        </div>
    </div>            
</div> 
```

# hadoop - Hadoop 减少多种输入格式

> ID：10213791
> 
> 赞同：3
> 
> 时间：2012-04-18T16:28:41.130
> 
> 标签：hadoop, mapreduce, format

我在 HDFS 中有两个具有不同数据格式的文件。如果我需要减少两个数据文件，作业设置会是什么样子？

例如，想象一下常见的字数问题，在一个文件中你有空格作为世界分隔符，而在另一个文件中是下划线。在我的方法中，我需要不同的映射器来处理各种文件格式，而不是输入一个通用的减速器。

怎么做？还是有比我更好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T17:22:01.993

查看[`MultipleInputs`](http://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapred/lib/MultipleInputs.html)解决这个确切问题的课程。它非常简洁——您可以通过课程`InputFormat`和可选`Mapper`课程。

如果您在 google 上寻找代码示例，请搜索“Reduce-side join”，这是通常使用此方法的地方。

* * *

另一方面，有时我发现只使用 hack 更容易。例如，如果您有一组文件是空格分隔的，另一组文件是下划线分隔的，则使用相同的映射器加载这两个文件，`TextInputFormat`并对两个可能的分隔符进行标记。计算两个结果集中的标记数。在字数统计示例中，选择具有更多标记的那个。

如果两个文件是相同的分隔符但具有不同数量的标准列，这也适用。您可以用逗号标记然后查看有多少标记。如果是 5 个令牌，则来自数据集 A，如果是 7 个令牌，则来自数据集 B。

# c# - 具有大字体的多行 CheckBox 上的左上角框对齐

> ID：10213792
> 
> 赞同：2
> 
> 时间：2012-04-18T16:28:47.277
> 
> 标签：c#, .net, winforms, checkbox, .net-2.0

在处理 WinForms .Net 2.0 项目时，我需要一个复选框来支持多行，以便框本身与左上角对齐。
这是使用 完成的`CheckAlign = System.Drawing.ContentAlignment.TopLeft`，这与默认值 ( `MiddleLeft`) 不同。

使用默认字体时，这看起来不错，但是当字体变大时 - 文本上方的间隙会增加，但框本身上方的间隙保持不变。
结果是该框出现在文本上方（见下图）。

有任何想法吗？

我想指出：

1.  我已经尝试了一些选项，例如使用自定义设计器、TableLayoutPanel 等，但没有走多远。
2.  .Net 2.0 是强制的 - 升级不是一种选择。

提前致谢。

![复选框问题](../Images/cef87ffdcc2e183917ce1c4f5ac4d842.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T20:27:45.540

复选框实际上与文本对齐。但以某种方式只能取悦印刷商。只是大字体具有更高的上升高度，即变音符号所在的空间。试试“这是问题所在”。这不是你可以修补的东西。CheckedListBox 也不支持所有者绘制，它通常是一个相当有缺陷的控件。如果您不想使用 ownerdraw ListBox，那么 MiddleLeft 或更小的字体是唯一不错的选择。

![在此处输入图像描述](../Images/1ff4fb80d191abddca80c94b28de0e0e.png)

# java - 使用枚举或不使用枚举的 switch case 语句

> ID：10213798
> 
> 赞同：0
> 
> 时间：2012-04-18T16:29:11.517
> 
> 标签：java, android, android-intent, switch-statement

我正在尝试从通过意图返回的字符串创建一个 switch 语句

```
public class ContactDetailsActivity extends Activity {

String address;
String hours;
String name;
TextView textview;
String Zero = "0"; 
String One  = "1";
String Two  = "2";
String Three = "3";
String Four = "4";

 Intent receivedIntent = getIntent(); 
 String myUrl = receivedIntent.getStringExtra("key");

 public void main(String myUrl){
     Log.v("myUrl", myUrl);
       String locations = myUrl;
       locationsNum location = locationsNum.valueOf(locations);
       switch(location) {
       case Zero:
         textview.setText("Got it");
         textview.setText("It Worked!!");
        break;
       }
   }
   public enum locationsNum {
        Zero, 
        One,
        Two,
        Three,
        Four

   }
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    textview = new TextView(this);
    textview.setText("This is the Contact tab");

    //Intent receivedIntent = getIntent(); 
    //String myUrl = receivedIntent.getStringExtra("key"); 

     //   Toast.makeText(this, myUrl, Toast.LENGTH_SHORT).show(); 
} 
```

返回的数据是一个索引值“0 - 4”，我将它放在 myUrl 中进行测试。我收到了无法启动活动错误。

我做错了什么还是我只是错过了什么？

谢谢你的帮助！

这是错误日志

```
04-18 11:47:59.402: E/AndroidRuntime(1383): FATAL EXCEPTION: main
04-18 11:47:59.402: E/AndroidRuntime(1383): java.lang.RuntimeException: Unable to instantiate     activity ComponentInfo{com.mlgw.mlgwapp/com.mlgw.mlgwapp.ContactDetailsActivity}:  java.lang.NullPointerException
04-18 11:47:59.402: E/AndroidRuntime(1383):     at   android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.os.Looper.loop(Looper.java:130)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.app.ActivityThread.main(ActivityThread.java:3683)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at java.lang.reflect.Method.invokeNative(Native Method)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at  java.lang.reflect.Method.invoke(Method.java:507)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at dalvik.system.NativeStart.main(Native Method)
04-18 11:47:59.402: E/AndroidRuntime(1383): Caused by: java.lang.NullPointerException
04-18 11:47:59.402: E/AndroidRuntime(1383):     at com.mlgw.mlgwapp.ContactDetailsActivity.<init>(ContactDetailsActivity.java:23)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at java.lang.Class.newInstanceImpl(Native Method)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at java.lang.Class.newInstance(Class.java:1409)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
04-18 11:47:59.402: E/AndroidRuntime(1383):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1561)
04-18 11:47:59.402: E/AndroidRuntime(1383):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:00:07.133

尝试在 switch 案例中用 locationsNum.zero 替换零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T15:19:39.480

我想通了，不需要枚举。我唯一需要做的就是将返回的字符串转换为整数，将其添加到 switch 语句中并且它起作用了。

# iphone - Objective-C中内存管理的基本步骤

> ID：10213799
> 
> 赞同：-1
> 
> 时间：2012-04-18T16:29:11.867
> 
> 标签：iphone, objective-c, ios, xcode, memory-management

我对objective-c语言没有太多经验。我对目标 CI 中的内存管理很困惑，我知道内存管理是非常重要的因素，所以我们在开发时必须非常关注这一点。

**我的问题**是我们必须遵循哪些基本的事情来尽可能减少内存的使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T18:34:26.547

也许我见过的最明确的建议（ARC 之前）来自 Brent Simmons：[我如何管理内存](http://inessential.com/2010/06/28/how_i_manage_memory)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:36:21.070

这是一个很好的问题，因为在 Objective-C 中没有垃圾收集器。我们必须手动处理内存。

在 Objective-C 中，当你拥有`alloc`它、`copy`它或`new`它时，你就拥有了一个对象。例如（我从[http://interfacelab.com/objective-c-memory-management-for-lazy-people/](http://interfacelab.com/objective-c-memory-management-for-lazy-people/)复制了这个示例代码）：

```
 -(void)someMethod
{
  // I own this!
  SomeObject *iOwnThis = [[SomeObject alloc] init];

  [iOwnThis doYourThing];

  // I release this!
  [iOwnThis release];
}

-(void)someOtherMethod:(SomeObject *)someThing
{
  // I own this too!
  SomeObject *aCopyOfSomeThing = [someThing copy];

  [aCopyOfSomeThing doSomething];

  // I release this!
  [aCopyOfSomeThing release];
}

-(void)yetAnotherMethod
{
  // I own this too!
  SomeObject *anotherThingIOwn = [SomeObject new];

  [anotherThingIOwn doSomething];

  // I release this!
  [anotherThingIOwn release];
} 
```

# visual-studio - 停止 Visual Studio 告诉我“nowrap”属性无效

> ID：10213801
> 
> 赞同：1
> 
> 时间：2012-04-18T16:29:17.787
> 
> 标签：visual-studio, visual-studio-2010

在 Visual Studio 2010 中，在我看来（cshtml），有时我有一些代码不被接受。这是一个具体的例子：

![在此处输入图像描述](../Images/b34b18561eb4f899688f24ab8cc7bf40.png)

我知道这不是一个真正的问题。我想知道我是否可以“编辑” VS 的规则以停止告诉我这个“nowrap”有问题。我不想停用所有警告。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:39:57.197

您可以通过使用 CSS 规则来绕过这个特定的警告。

```
td {white-space:nowrap} 
```

[http://jsfiddle.net/3rwWh/4/](http://jsfiddle.net/3rwWh/4/)

# php - 在 iOS 上运行 PHP？

> ID：10213804
> 
> 赞同：3
> 
> 时间：2012-04-18T16:29:29.430
> 
> 标签：php, mysql, ios

我有一个使用一些 php 脚本来访问 mysql 数据库的应用程序。谁能建议如何实施离线版本？我知道在应用程序中创建 SQLLite 数据库并在 Web 服务器可用时填充它很容易？真的？

当我想查询它时，是否可以使用预先存在的 php 来做到这一点？

提前致谢

HMJ

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:33:51.583

区分您所说的组件很重要 - PHP 是一种服务器端语言，旨在执行数据库查询。SQLite 是允许我们在 iOS 操作系统上进行客户端数据库管理的 iOS 框架。在 iPhone 上，您可以执行使用 PHP 生成的相同查询，但它们将使用 Objective-c 构建。有一些有用的包装器可以做到这一点，包括 FMDB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-26T14:03:26.120

[Kodiak PHP](http://itunes.apple.com/app/kodiak-php/id542685332?mt=8)在 iPad 上运行。它已安装 PDO。您可以创建本地 sqlite 数据库。我用这段代码测试了它：

```
<?php
error_reporting(E_ALL);
$db = new PDO('sqlite:test.sql');

$n = $db->exec('DROP TABLE IF EXISTS USER');
$n = $db->exec('CREATE TABLE user (login TEXT)');
$n = $db->exec('INSERT INTO user VALUES("joe")');
$r = $db->query('SELECT * FROM user');
foreach ($r as $row) {
    echo $row['login']."\n";
}
?> 
```

关于PH7...它只是实现了PHP语言和一些功能，它不支持所有的PHP功能和扩展。例如，PCRE 经常用于正则表达式处理。PH7确实支持它。PH7 是针对嵌入式应用程序的重写，基本上是一个功能更强大的脚本引擎，例如 Lua，但不像 Javascript 那样占用空间大。

Kodiak PHP 是一个实际的 PHP 端口。使用 phpinfo(); 看看里面有什么编译出来的，还蛮多的。

要在 iOS 应用程序中运行 SQL 脚本，您需要将 PHP 引擎编译到您的 iOS 应用程序中并让 Apple 允许它:) - Kodiak 能够做到这一点，因为 Apple 允许导出在他们的应用程序中编写的文件，但 Apple不允许将文件导入应用程序。因此，您必须使用复制/粘贴。该应用程序旨在编写和测试不运行一堆 PHP 脚本来创建应用程序的代码。

简而言之，您的问题的答案是：是的，可以在 iOS 应用程序中运行 PHP 并写入 sqlite 数据库。但是，要这样做，您需要将 PHP 库编译到您的应用程序中。为 iOS 编译 PHP 可不是件小事（我还没做过）。Kodiak 已经做到了，但我还没有找到适用于 iOS 的免费 PHP 库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:33:07.927

我不认为你可以在 iOS 上“安装”php。但是，你也可以，我不能说。

我认为更容易做的是创建一个具有相同架构和内容的本地数据库。

如果离线，则从离线数据库中提取，从实时数据库（网络）在线。

如何 ？

编写一个将扮演“模型”角色的脚本。就像在 MVC 技术中一样。您的脚本只需要处理两个数据库。由于 SQL 是 SQL，因此您的查询不会真正改变：

```
if(Offline){
  // Offline
  Use something similair to PDO but for SQLLite
} else {
  // Online
  Use something similair to PDO but for MySQL
} 
```

# ruby - 如何使用 ruby 忽略 csv 文件中的换行符但保留漂亮的源文件？

> ID：10213806
> 
> 赞同：1
> 
> 时间：2012-04-18T16:29:33.733
> 
> 标签：ruby, csv, erb

我有一个包含大约 30 列的 csv 文件，我想输出这些列，并希望这些列出现在我的 .csv.erb 中的不同行中，例如：

```
<%= quantity.line_number  %>,
<%= quantity.created_at.strftime("%Y-%m-%d %H:%M:%S") %>,
<%= quantity.partner_entity_no %>,
<%= quantity.partner_name %>, 
```

但是，当我执行此操作时，我的 .csv 文件在每个“，”之后都有换行符，我想 1）将每一列保持在源代码中的单独行上，并且 2）在输出 .csv 文件中没有换行符。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:34:26.743

```
<%= [quantity.line_number,
     quantity.created_at.strftime("%Y-%m-%d %H:%M:%S"),
     quantity.partner_entity_no,
     quantity.partner_name].join(',') %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T18:28:56.857

使用 stdlib [CSV 类](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/CSV.html)来获得正确的 csv 引用和转义语义。或者更方便的是，使用它的[Array#to_csv](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/csv/rdoc/Array.html#method-i-to_csv)辅助方法。

```
<% require 'csv' %>
...
<%= [ 
      quantity.line_number,
      quantity.created_at.strftime("%Y-%m-%d %H:%M:%S"),
      quantity.partner_entity_no,
      quantity.partner_name,
    ].to_csv %> 
```

# android - Button 中的多个 EditText 值

> ID：10213811
> 
> 赞同：0
> 
> 时间：2012-04-18T16:29:46.963
> 
> 标签：android

是否可以将 4 个字符串组合成一个 Button，并在它们之间进行适当的分隔/样式设置？

例如， http: [//i.imgur.com/swJzQ.png](http://i.imgur.com/swJzQ.png)

目前我有一个表格中的值，但我希望它像一个按钮一样。

谢谢。

**编辑：想通了。**

在我添加的 onclicklistener 中：

```
 tr1.setBackgroundResource(drawable.list_selector_background); 
```

其中 tr1 是我的表格。（您需要将 tablerow 设为 final 才能正常工作）。

我目前正在研究一种不同的 list_selector 颜色，但这可以解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:37:27.303

在一个按钮中，我不这么认为，但您可以将 4 个字符串放入布局中，在背景中设置选择器并在布局中添加 clickListener。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:45:22.880

您可以创建一个具有正确间隔的四个字符串的图像，然后将其放入您的 drawables 文件夹并将其应用为按钮的背景。

或者，您可以创建一个内部包含四个按钮的 RelativeLayout。四个按钮中的每一个都有您想要的文本，并使它们都转到同一个地方。您可以将它们均匀地间隔到它们之间没有空余空间的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T17:07:20.863

您可以将其设为[Custom ListView](https://stackoverflow.com/questions/5781776/listview-custom-listview)，它不会是按钮，但您仍然可以拥有 OnItemClickListener

# php - 带有正则表达式的 CakePHP 路由

> ID：10213814
> 
> 赞同：3
> 
> 时间：2012-04-18T16:30:01.190
> 
> 标签：php, regex, cakephp, routes

我有一个控制器设置来接受两个变量：`/clients/view/var1/var2`

我想把它展示为`/var1/var2`

所以我试过

```
Router::connect('/*', array('admin'=>false, 'controller' => 'clients', 'action' => 'view')); 
```

但这会阻止**所有**其他控制器作为`/*`路由**一切工作**

站点上的所有其他页面都在`admin`前缀内，所以基本上我需要一个路由，如果当前前缀是`admin`！我试过这个（正则表达式来自[正则表达式来匹配不包含单词的行？](https://stackoverflow.com/questions/406230/regular-expression-to-match-string-not-containing-a-word)）：

```
Router::connect('/:one', array('admin'=>false, 'controller' => 'clients', 'action' => 'view'), array(
    'one' => '^((?!admin).*)$'
)); 
```

但我认为正则表达式不正确，因为如果我导航到`/test`它要求测试控制器，而不是客户端

我唯一的其他路线是：

```
Router::connect('/admin', array('admin'=>true, 'controller' => 'clients', 'action' => 'index'));
Router::connect('/', array('admin'=>false, 'controller' => 'users', 'action' => 'login')); 
```

我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T21:01:00.407

我第一次误解了你的问题。我测试了你的代码，也没有得到预期的结果。原因可能是正则表达式解析器不支持*负前瞻断言*。但我仍然认为你可以通过重新排序路线来解决这个问题：

CakeBook[描述了使用前缀路由时会自动生成哪些路由](http://book.cakephp.org/1.3/view/950/Prefix-Routing)。在您的情况下，必须在 '/*' 路由之前手动分配这些路由以捕获所有管理操作。这是对我有用的代码：

```
// the previously defined routes
Router::connect('/', array('controller' => 'pages', 'action' => 'display', 'home'));
Router::connect('/admin', array('controller' => 'clients', 'action' => 'index', 'admin' => true));

// prefix routing default routes with admin prefix
Router::connect("/admin/:controller", array('action' => 'index', 'prefix' => 'admin', 'admin' => true));
Router::connect("/admin/:controller/:action/*", array('prefix' => 'admin', 'admin' => true));   

// the 'handle all the rest' route, without regex
Router::connect(
    '/*', 
    array('admin'=>false, 'controller' => 'clients', 'action' => 'view'), 
    array()
); 
```

现在我得到所有带有管理员前缀的管理控制器操作，并且 /test1/test2 被重定向到客户端控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T20:10:39.447

我认为解决方案在[有关路由的面包店文章](http://bakery.cakephp.org/articles/Frank/2009/11/02/cakephp-s-routing-explained)中有所描述- “将参数传递给操作”（代码未测试）：

```
Router::connect(
    '/clients/view/:var1/:var2/*',  
    array( 
        'controller' => 'clients',
        'action' => 'view'
    ),
    array( 
        'pass' => array( 
            'var1', 
            'var2' 
        ) 
    ) 
); 
```

控制器动作如下所示：

```
public function view($var1 = null, $var2 = null) { 
    // do controller stuff
} 
```

此外，您还必须查看路线的顺序（阅读“路线的顺序很重要”部分）。在您的示例中，如果'/*'首先出现，则停止所有其他路由，如果您在其他路由之后分配规则，则它仅处理与任何其他路由不匹配的请求。

# c# - 将字符串加载到 LINQ 类并查询它

> ID：10213822
> 
> 赞同：1
> 
> 时间：2012-04-18T16:30:40.880
> 
> 标签：c#, .net, xml, linq

我对这个主题还不太了解，所以我愿意接受任何导致我最终目标的建议......

1.  我从 Web 服务收到一个 XML 字符串
2.  我想将字符串加载到能够用于 LINQ 的 C# 类中
3.  我希望能够使用带有该类的 LINQ 提取 XML 中所有“someentity”实例的数组。

这是我用 someentity 示例编写的一些示例 XML：

```
<replydata>
    <someentity>
        <role id="1234" roletype="2" />
        <history length="24" accessstr="http://someurl" />
    </someentity>
    <someentity>
        <role id="1235" roletype="2" />
        <history length="30" accessstr="http://someurl2" />
    </someentity>
    ... keep repeating for a while
</replydata> 
```

这是否可能，如果可以，有人可以提供一个简单的例子或指导我到正确的地方找到一个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T16:35:49.307

你可以这样做：

```
var responseString =
    @"<replydata>
        <someentity>
            <role id=""1234"" roletype=""2"" />
            <history length=""24"" accessstr=""http://someurl"" />
        </someentity>
        <someentity>
            <role id=""1235"" roletype=""2"" />
            <history length=""30"" accessstr=""http://someurl2"" />
        </someentity>
    </replydata>";
var response = XElement.Load(new StringReader(responseString));
var someentitys = response.Elements("someentity");
foreach(var e in someentitys) {
    Console.WriteLine(
        "Role: {0}, access: {1}"
    ,   e.Element("role").Attribute("roletype")
    ,   e.Element("history").Attribute("accessstr")
    );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:44:49.983

The class you're looking for here is `XDocument`

[http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)

You can create an `XDocument` from an XML String using it's `Parse()` method and then use LINQ to query that document.

Here's an article that demos its LINQ Capabilities

[http://broadcast.oreilly.com/2010/10/understanding-c-simple-linq-to.html](http://broadcast.oreilly.com/2010/10/understanding-c-simple-linq-to.html)

# mysql - SQL 使用不同的参数或值更新多条记录

> ID：10213823
> 
> 赞同：0
> 
> 时间：2012-04-18T16:30:45.433
> 
> 标签：mysql, sql

我知道这不起作用：

```
UPDATE `states` SET `country_id` = '83', `position` = (1,2,3) WHERE `states`.`id` IN (381, 378, 380); 
```

有没有办法根据

```
id = 381; position = 1
id = 378; position = 2
id = 380; position = 3 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:31:40.427

最简单的是使用三个单独的查询。

单个查询是可能的，但更复杂：

```
UPDATE states
SET country_id = '83',
    position = CASE id WHEN 381 THEN 1
                       WHEN 378 THEN 2
                       WHEN 370 THEN 3 END
WHERE id IN (381, 378, 380) 
```

# web-config - SlowCheetah XML 转换预览不适用于自定义转换

> ID：10213825
> 
> 赞同：1
> 
> 时间：2012-04-18T16:30:54.453
> 
> 标签：web-config, xslt, slowcheetah

SlowCheetah 很棒，但我试图让它与[Sayed 的自定义转换一起使用，以支持替换部分文本。](https://stackoverflow.com/questions/2915329/advanced-tasks-using-web-config-transformation)

当我尝试预览转换时，我得到“处理转换时出错”。我只是在[这里使用该项目，](http://sedodream.com/2010/09/09/ExtendingXMLWebconfigConfigTransformation.aspx)因为我想同时使用两者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T02:35:13.270

目前 web.config 不支持自定义转换的预览。对不起。从技术角度来看，这实际上也是非常具有挑战性的。[我在项目网站https://github.com/sayedihashimi/slow-cheetah/issues/6](https://github.com/sayedihashimi/slow-cheetah/issues/6)上为此创建了一个问题，但不会很快实施。

# objective-c - 检测屏幕/应用程序窗口的哪一部分正在使用 OpenGL？

> ID：10213827
> 
> 赞同：0
> 
> 时间：2012-04-18T16:30:58.447
> 
> 标签：objective-c, macos, cocoa, opengl, quartz-graphics

我有兴趣确定应用程序的哪个部分正在使用 OpenGL。

以 Chrome 为例，其中 Youtube 视频在 Flash 中播放（通过 OpenGL 渲染）。我有兴趣只检测正在进行 OpenGL 活动的应用程序区域吗？

如果条件是我需要在应用程序内部，比如在 Chrome 中注入，我也可以这样做。

让我知道我是否可以进一步澄清问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:44:10.640

您将问题标记为 MacOS X。然后您可以简单地假设屏幕上的所有内容都是使用 OpenGL 绘制的，因为 OpenGL 被用作整个系统的图形后端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T16:34:42.277

他们就是这个私有 API，它让你知道 opengl 正在渲染的表面。

```
CG_EXTERN CGError CGSGetSurfaceBounds(CGSConnectionID, CGWindowID, CGSSurfaceID, CGRect* bounds); 
```

使用它，我们可以检测使用 OpenGL 的特定应用程序区域。

# c++ - 即使是this_type，如何强制存档存储true_type？

> ID：10213828
> 
> 赞同：2
> 
> 时间：2012-04-18T16:30:58.887
> 
> 标签：c++, serialization, boost, boost-serialization

本主题涉及 boost 序列化。

当我序列化一个多态对象时，只有当它不等于 this_type（即序列化对象的类型）时，档案才会存储有关 true_type（即对象的具体类型）的信息。

即：仅当从基类序列化时才存储序列化对象的类型。

如何强制存档始终存储类型？

让我们用一个例子来说明，我不确定上面的文字是不是很明显......：

让我们有 2 个可序列化的类：

```
class Base { ... };
class Leaf : public Base { ... }; 
```

如果我做 ：

```
std::stringstream ios(std::ios_base::binary | std::ios_base::out | std::ios_base::in);

Base* b = new Leaf();
boost::archive::text_oarchive ar(ios);
ar & b; 
```

然后存档包含：

22 序列化::归档 9 0 4**叶**1 0 0 0 0 0 0 0 0

它包含叶具体类型信息。

但是，如果我这样做：

```
Leaf* b = new Leaf();
boost::archive::text_oarchive ar(ios);
ar & b; 
```

然后存档包含：

22 序列化::归档 9 0 1 0 0 0 0 0 0 0 0

它不包含叶子类型信息。

如何生成所有类型为 true_type 的**存档**？

我搜索了 2 种方法： - 调用归档类型（register_type，save_pointer，...）的方法不成功 - 直接更改 boost/archive/detail/oserializer.hpp 文件：在 struct 多态中，在函数模板中 static void save(Archive &ar , T & t) 我注释掉

```
if(*this_type == *true_type){
    const basic_pointer_oserializer * bpos = register_type(ar, t);
    ar.save_pointer(vp, bpos);
    return;
} 
```

不成功。

谢谢你的帮助。

尼古拉斯。

PS：关于我为什么要这样做的一个词。当 true_type 为“已注册”（我不确定 register 是否正确）时，我们可以将对象反序列化为任何基类。例子：

```
//SERIALIZATION:
Leaf* leaf = new Leaf();
ar & leaf;

//DESERIALIZATION:
Base* b = 0;
ar & b; // would work only if Leaf has been saved in the archive as true_type 
```

对于多团队项目中的工具，它'强大'：测试数据已由一个团队序列化，而另一个团队可以将图像反序列化到接口类 IImage 而无需询问：什么是 true_tyep ：一个 Image3D 、AImage2D、Image2DRGB、Image2DRAW 等。

# ruby-on-rails - 当控制器只有编辑和更新时如何设置路由？

> ID：10213831
> 
> 赞同：1
> 
> 时间：2012-04-18T16:31:13.280
> 
> 标签：ruby-on-rails, routing, routes

**我似乎无法弄清楚如何正确设置我的路线。**

在我的应用程序中，我有一个视图可以让网站所有者更新他们的地址信息。**new**和**create**操作是*注册过程*的一部分，位于`signups_controller`. **编辑**和**更新**操作位于`settings_controller`.

当用户进入设置区域时，他/她只看到编辑表单。填写完毕后，用户将返回到同一个表单，并显示一条闪现消息或错误消息。 **这是控制器的外观：**

```
class SettingsController < ApplicationController

  def edit
    @account = current_account
    @account.companies.first
    @account.companies.first.addresses.first
    @account.companies.first.phones.first
  end

  def update
    @account = current_account
    if @account.update_attributes(params[:account])
      redirect_to edit_setting_path
      flash[:notice] = "Success!"
    else
      render :edit
    end
  end
end 
```

**在我的路线中，我只有：**

```
resources :settings 
```

**指向该站点区域的链接**是一个名为 linke 的基本 RESTful，带有参数选项：

```
edit_setting_path(:id => current_account.id) 
```

**当用户到达此页面时，他们会看到以下 URL：**

```
http://domainname.com/settings/1/edit 
```

**当他们提交表单并收到错误时，URL 更改为：**

```
http://domainname.com/settings/1 
```

为什么 URL 会发生变化——我不希望它发生变化？有没有办法让它与初始编辑视图保持一致？我尝试对失败的更新进行重定向，但是我没有收到错误消息。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:39:50.520

要回答您的“为什么”问题：URL 正在更改，因为它反映了失败请求的 URL - 在本例中是对该 URL (/settings/1) 的 PUT 请求。您已提交表单并且该表单的提交（正确）指向该 URL。这是助手为您提供的 RESTful 路由的结果。由于您的操作中的逻辑属于渲染：操作，因此没有重定向，并且表单只是使用此操作中可用的相同数据在页面上重新渲染（这就是您可以看到错误的原因）。

如果您想重定向回编辑页面，是的，您将丢失在@account 实例变量中设置的错误，因为重定向将重置（重新查询）帐户。

您可以将与 PUT 匹配的路由添加到 /settings/1/edit 并将其指向您的更新操作并更改您的表单等。简而言之，我不推荐这样做，但它应该可以工作。

完全未经测试但可以尝试：

路线.rb

```
 put "/settings/:id/edit", :to=>"settings#update", :as=>"update_setting"
 resources :settings, :except=>:update 
```

您的表单还必须提交到 update_setting_path （这也意味着它不能重复用于新对象...... ew）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:47:12.443

首先，您应该阅读[The Rails Guides for Routing](http://guides.rubyonrails.org/routing.html)。他们将有助于理解为什么它会这样工作。

其次，要完成您想要做的事情，您需要通过`match`调用添加手动路由。你需要这样的东西。

```
match '/settings/:id/edit' => "settings#edit" 
```

# android - 无尽的列表演示

> ID：10213838
> 
> 赞同：0
> 
> 时间：2012-04-18T16:31:39.643
> 
> 标签：android, commonsware-cwac

我没有遵循 getPendingView 方法。它不应该使用pending.xml 布局而不是第一行吗？？？

> @Override protected View getPendingView(ViewGroup parent) { View row=getLayoutInflater().inflate(R. **layout** .row, null);

```
 View child=row.findViewById(android.R.id.text1);

  child.setVisibility(View.GONE);

  child=row.findViewById(R.id.throbber);
  child.setVisibility(View.VISIBLE);
  child.startAnimation(rotate);

  return(row);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:21:36.060

> 它不应该使用pending.xml 布局而不是第一行吗？

编号`pending.xml`被其他演示活动使用。

> 文本请稍候...没有出现

它不应该出现。因此，它不会出现。您引用的演示使用旋转`ImageView`来指示某些事情正在等待处理。

# c# - C#：需要一个类似于 Java 的 LinkedBlockingQueue 的阻塞 FIFO 队列

> ID：10213841
> 
> 赞同：5
> 
> 时间：2012-04-18T16:31:43.827
> 
> 标签：c#, multithreading, queue, blocking, fifo

需要与 java 类似的东西`LinkedBlockingQueue`。

感兴趣的方法：`messageQueue.poll(120000, TimeUnit.MILLISECONDS);` 意思是..尝试获取项目..如果在 X 单位时间内您仍然没有项目..返回 null

那+我必须是**先进先出**

经过一些谷歌搜索（但尚未测试）：我发现 ConcurrentQueue （具有 FIFO 行为）， BlockingCollection （FiFO 或没有 FIFO ？？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T16:34:36.977

`BlockingCollection`可以与任意数量的不同类型的集合一起使用。如果您不手动传入特定类型的并发集合，它将使用 a `ConcurrentQueue`，这意味着它将完全按照您的意愿行事。如果需要，您可以使用并发堆栈类型或并发优先级队列，这就是它使用通用名称（例如 Blocking Collection）而不是 BlockingConcurrentQueue 的原因。

`BlockingCollection`如果您不想相信我的话，所有这些都列在 MSDN 页面上。

# media-queries - 响应式网页设计

> ID：10213842
> 
> 赞同：-2
> 
> 时间：2012-04-18T16:31:51.253
> 
> 标签：media-queries, responsive-design

我有 3 个 css 文件：

1.  骨架.css
2.  base.css
3.  布局.css

我想要做的是让我的网站响应。

为此，将使用此 css 文件以使我的网站具有响应性。

我已经浏览了所有 3 个 CSS，它包含媒体查询等等。

我现在想知道如何使用或嵌入现有的 style.css 和媒体查询？如何应用媒体查询？以及在哪里应用媒体查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T20:35:46.750

Skeleton 是一个响应式 CSS 框架，效果非常好。最好的办法是查看 Dave 网站[http://www.getskeleton.com/](http://www.getskeleton.com/)上的代码 - 他发布的代码非常有用，会给您一个很好的开始。我从 Skeleton ( [http://72t.net](http://72t.net) ) 开始，后来转到 Bootstrap。

尽管如此，根据代码最初的编写方式，尝试将现有网站转换为响应式设计可能是一项真正的任务。我现在已经（或正在做）4 个响应式站点 - 在每种情况下，我发现从头开始更容易 - 原始站点是在 Asp.Net 中完成的，具有适当的膨胀。新站点是 html5、CSS、JQuery 和 Ajax。

# numbers - Bugzilla：大值错误 ID 号

> ID：10213845
> 
> 赞同：1
> 
> 时间：2012-04-18T16:31:58.583
> 
> 标签：numbers, bugzilla

有没有办法判断 Bugzilla 中的错误数量有多大？换句话说，我怎样才能找到上限？它是由处理器或表格调节的吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:20:23.243

这取决于`MEDIUMSERIAL`数据库上的抽象数据类型。

抽象模式在 中`Bugzilla::DB::Schema`，相应的实现在相应的`Bugzilla::DB::Schema::*`模块中。

在 MySQL 上，`MEDIUMSERIAL`是 a `mediumint`，所以 的最大值`bug_id`是 8388607。

只有一个已知的 Bugzilla 实例，其中包含多达 1M 行`bugs`，所以我不知道有任何驱动器可以增加 vanilla 源中的大小。

[http://lpsolit.wordpress.com/bugzilla-usage-worldwide/](http://lpsolit.wordpress.com/bugzilla-usage-worldwide/)

在 Yahoo! 中，我们有超过 500 万行`bugs`，我们已经增加到`bug_id`4 字节有符号整数，所以我们的新最大值`bug_id`是 2147483647。

# html - 让 Opera 和 Safari 播放声音

> ID：10213847
> 
> 赞同：0
> 
> 时间：2012-04-18T16:32:05.400
> 
> 标签：html, html5-audio

我使用以下 html 音频标签以不同的声音格式播放不同的文件

```
<audio controls="player_1">
<source src="D:\HND grrrrr\Year_2\RoyWebsite\Sounds\WAV\home_page_readout.wav"       type="audio/wav"/>
<source src="D:\HND grrrrr\Year_2\RoyWebsite\Sounds\MP3\home_page_readout.mp3" type="audio/mp3"/>
<source src="D:\HND grrrrr\Year_2\RoyWebsite\Sounds\ogg\home_page_readout.ogg" type="audio/ogg"/>
</audio> 
```

现在在 IE 和 Chrome 中播放正确的声音格式，但是当我在 Opera 或 Safari 中打开页面时，声音播放器出现但按下播放按钮时不起作用，好像找不到文件或什么？

哦，我不知道第一行的类型/部分如此分开

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:57:45.910

尝试使用相对路径，甚至将文件移动到某个 Web 服务器。应该是这样的。显然 - 更新您的浏览器。

顺便说一句：有一些 html5 功能（如桌面通知）根本无法在本地工作。

# android - Android内存需要在外部存储上安装apk吗？

> ID：10213852
> 
> 赞同：1
> 
> 时间：2012-04-18T16:32:26.840
> 
> 标签：android, mobile, apk, android-sdcard

我正在尝试在 Nexus One (2.3.6) 设备上安装应用程序。APK 的大小超过 100 MB，因为它包含大量资产。安装时，出现以下异常。

[2012-04-17 23:26:18] 无法在设备“[redacted]”上安装 [redacted].apk：设备上没有剩余空间 [2012-04-17 23:26:18] com.android.ddmlib .SyncException：设备上没有剩余空间 [2012-04-17 23:26:18] 启动已取消

我已经明确表示我希望将 apk 安装在外部存储设备上，即 SD 卡上。当我尝试使用较小的 apk 安装相同的应用程序时，我确认它确实安装在 SD 卡上。SD 卡有超过 3GB 的存储空间，足以容纳 100 MB。

到底是怎么回事？我注意到当我将 apk 大小减小到低于可用内部存储的大小时，一切正常；所以我能得出的唯一有意义的结论是需要内部存储器才能将 apk 安装到外部存储器。

有没有其他人遇到过同样的问题？

编辑：Google Play 确实将您的应用程序限制为 50 MB。但是这个限制纯粹是 Google Play 的限制，并不是安卓 apk 的限制。例如，亚马逊允许任何大小的 apk。您可以通过使用 Android 开发工具在手机上安装大小为 60 MB 的 apk 来尝试此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:35:16.307

将资产放在应用程序之外。首次使用（或安装后）时，将您现在存储在资产文件夹中的所有文件下载到外部存储上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T17:14:20.217

Android 应用程序必须小于 50MB。你可以避免这个限制（见这里：[http](http://android-developers.blogspot.com/2012/03/android-apps-break-50mb-barrier.html) ://android-developers.blogspot.com/2012/03/android-apps-break-50mb-barrier.html，http : [//developer.android.com/guide/market /expansion-files.html](http://developer.android.com/guide/market/expansion-files.html) )，但仅适用于扩展 apk。

# .net - 如何将字节数组转换为位图实例 (.NET)？

> ID：10213854
> 
> 赞同：15
> 
> 时间：2012-04-18T16:32:48.543
> 
> 标签：.net, vb.net, imaging

我正在使用 VB.NET 中的相机（在本例中为单色）。相机的 API 采用 C++ 语言，制造商提供包装器。在这些情况下很典型，图像作为`Byte`数组返回。在我的特殊情况下，它是每像素 8 位，所以没有花哨的位打包可以撤消。

令我**大吃一惊**的是 .NET 对这种类型的支持如此之少。网上搜索找到了各种主题，但是很多情况下人们都有对应图像数据的字节数组（也就是将图像文件读入字节数组，然后让.NET将数组解释为文件），这于事无补，带有标题和所有内容）。

在这种情况下，我需要将原始像素值数组转换为可以在屏幕上显示的东西。

似乎没有任何内置方法可以做到这一点，因为 .NET 中内置的 8bpp 格式已编入索引（需要调色板），但似乎不支持设置调色板。再一次，这真的让我感到惊讶。[这](https://stackoverflow.com/questions/2517477/converting-24bpp-to-4bpp-with-gdi-in-vb-net)是我发现的最有希望的话题。

所以我发现这样做的唯一方法是创建一个`Bitmap`然后逐个像素地复制像素值。在我的情况下，在最快的 i7 上使用8 MPixel 图像需要*几秒钟*`SetPixel`。

我发现使用的替代方法`SetPixel`是`LockBits`，然后您可以访问构成图像的（非托管）字节数组。这似乎很浪费，因为我必须在 .NET 中操作数组，然后将其复制回非托管空间。我已经复制了一次原始图像数据（因此原始图像数据可以被其余的事情重复使用或丢弃），所以虽然比使用`SetPixel`它快得多，但仍然看起来很浪费。

这是我的VB代码：

```
Public Function GetBitmap(ByRef TheBitmap As System.Drawing.Bitmap) As Integer
    Dim ImageData() As Byte
    Dim TheWidth, TheHeight As Integer
    'I've omitted the code here (too specific for this question) which allocates
    'ImageData and then uses Array.Copy to store a copy of the pixel values
    'in it. It also assigns the proper values to TheWidth and TheHeight.

    TheBitmap = New System.Drawing.Bitmap(TheWidth, TheHeight, System.Drawing.Imaging.PixelFormat.Format24bppRgb)
    Dim TheData As System.Drawing.Imaging.BitmapData = TheBitmap.LockBits(
        New System.Drawing.Rectangle(0, 0, TheWidth, TheHeight), Drawing.Imaging.ImageLockMode.ReadWrite, TheBitmap.PixelFormat)
    Dim Image24(Math.Abs(TheData.Stride) * TheHeight) As Byte
    'Then we have two choices: to do it in parallel or not. I tried both; the sequential version is commented out below.
    System.Threading.Tasks.Parallel.For(0, ImageData.Length, Sub(i)
                                                                 Image24(i * 3 + 0) = ImageData(i)
                                                                 Image24(i * 3 + 1) = ImageData(i)
                                                                 Image24(i * 3 + 2) = ImageData(i)
                                                             End Sub)
    'Dim i As Integer
    'For i = 0 To ImageData.Length - 1
    '    Image24(i * 3 + 0) = ImageData(i)
    '    Image24(i * 3 + 1) = ImageData(i)
    '    Image24(i * 3 + 2) = ImageData(i)
    'Next
    System.Runtime.InteropServices.Marshal.Copy(Image24, 0, TheData.Scan0, Image24.Length)
    TheBitmap.UnlockBits(TheData)

    'The above based on
    'http://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.aspx

    Return 1

End Function 
```

对于 8 MPixel 图像，顺序版本从创建`TheBitmap`到（包括）调用`TheBitmap.UnlockBits()`. 并行版本更加不一致，但范围在 60 到 80 毫秒之间。考虑到我同时从四个摄像头获取数据并流式传输到磁盘并且有足够的空闲时间，这非常令人失望。该 API 附带 C++ 示例代码，可以同时以全帧速率 (17 fps) 从所有四个摄像头显示。当然，它从不处理`Bitmap`，因为 GDI 访问的是原始像素值数组。

总之，我必须穿越托管/非托管障碍，因为没有直接的方法来获取像素值数组并将其“填充”到`Bitmap`实例中。在这种情况下，我还将像素值复制到 24bpp`Bitmap`中，因为我无法在索引图像中“设置”调色板，因此 8bpp 不是一种可行的显示格式。

没有更好的办法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-18T17:01:04.547

创建一个[有效的位图标头](http://en.wikipedia.org/wiki/BMP_file_format)，并将其预先附加到字节数组中。您只需要手动创建 56-128 字节的数据。

其次，[从字节数组创建一个流](https://stackoverflow.com/questions/4736155/how-do-i-convert-byte-to-stream-in-c)。

接下来，[使用 Image.FromStream()/Bitmap.FromStream() 创建图像或位图类](http://msdn.microsoft.com/en-us/library/93z9ee4x.aspx)

我不会想象.Net 中有任何类型的原始成像功能。图像有太多需要的信息，对于接受原始字节并创建图像（是位图、jpeg、gif、png 等，以及每个附加数据的方法）来说，这将是一个非常冗长的参数列表这些需要创建一个有效的图像）这是没有意义的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-15T15:09:50.813

试试这个

```
var img = new Bitmap(new MemoryStream(yourByteArray)); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-18T17:13:26.507

好像你所有的相机都是同一类型的，所以图像数据。我不知道这在您的情况下是否可行，但是您能否从任何图像创建一个“完整位图”，然后仅使用标题作为模板（因为它对于所有图像都是相同的）。

# c# - 多个列表框的选定索引

> ID：10213855
> 
> 赞同：0
> 
> 时间：2012-04-18T16:32:49.410
> 
> 标签：c#

我正在编写一个程序，要求用户输入他们的房子或公寓的信息。他们将输入有关房产 ID、地址、建造年份、卧室、面积和价格的信息。完成后，他们选择为“带家具”输入是或否（这适用于公寓），或者他们可以输入车库容量的数字（这适用于房屋）。我有一个名为 DisplayInfo() 的方法，它在一列中显示所有这些信息。该程序底部有两个列表框，一个用于公寓，一个用于房屋。还有两个按钮，一个用于添加房屋，一个用于添加公寓。此按钮会将地址添加到相应的列表框中。我遇到的问题是在最后一个名为 display 的按钮上，选定的房屋或公寓应显示在使用 DisplayInfo() 显示所有信息的消息框中。这就是我现在所拥有的

这是 DisplayInfo() 方法

```
 public virtual string DisplayInfo()
    {
        return string.Format("Property ID: {0}\nProperty Address: {1}\nYear Built: {2}\nNumber of Bedrooms: {3}\nSquare Footage: {4}\nPrice: {5}", GetID(),
            GetAddress(), GetYearBuilt(), GetBedrooms(), GetSquareFootage(), GetPrice()); 
```

这就是我用于显示消息框的内容，它所做的只是在不同的消息框中显示用户输入的每个房屋或公寓。

```
 foreach (Property_Dwelling property in Home)
        {
            MessageBox.Show(property.DisplayInfo(), property.GetType().ToString(), MessageBoxButtons.OK, MessageBoxIcon.Information);
        } 
```

和

```
 foreach (Property_Dwelling property in Home)
        {
            MessageBox.Show(property.DisplayInfo(), property.GetType().ToString(), MessageBoxButtons.OK, MessageBoxIcon.Information);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:40:20.827

**编辑：新代码，基于评论**

```
foreach (Property_Dwelling property in Home)
{
    //Only displays the messagebox if the address of the property is the same as the text displayed in the listbox
    if(property.GetAddress() == myListBox.Text)
    {
        MessageBox.Show(property.DisplayInfo(), property.GetType().ToString(), MessageBoxButtons.OK, MessageBoxIcon.Information);
    }
} 
```

不过，您可能希望在尝试显示其信息之前验证是否选择了某个项目。

那对你有用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:45:54.007

So, you are showing all the homes, because you are doing a for each around home (is that a class?) and that is showing all the info.

You should first locate the item you want to display inside home, and then only show it data.

# actionscript-3 - 在 agal 的片段着色器中获取当前缓冲区深度

> ID：10213856
> 
> 赞同：0
> 
> 时间：2012-04-18T16:32:51.113
> 
> 标签：actionscript-3, fragment-shader, stage3d, agal

如果有的话，是否可以在片段着色器中的 AGAL 中获取当前片段深度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T18:53:32.883

不，恐怕没有办法从 AGAL 中的深度缓冲区中读取数据。

但是，您可以通过首先将深度图渲染到纹理中，然后使用它来解决问题（这可能就足够了，具体取决于您尝试实现的效果）。

事实上，即使以良好的精度渲染深度图也可能（有点）棘手，因为闪存中没有 float32 纹理，因此要存储在 R8G8B8A8 纹理中的深度（通过在 GPU 上打包和解包值）。

# ios - 如何将调用视图控制器的引用传递给带有 segue 的视图控制器？

> ID：10213858
> 
> 赞同：1
> 
> 时间：2012-04-18T16:33:01.097
> 
> 标签：ios

这是我所拥有的：

我有一个带有图像数组的根视图控制器。我有一个 detailViewController，它只是有一个用于显示全屏图像的全屏 UIImageView。我还定义了一个 segue 来呈现 detailViewController。当用户在 rootViewController 中选择图像时，会以编程方式调用此 segue，如下所示：

```
- (void)carousel:(iCarousel *)carousel didSelectItemAtIndex:(NSInteger)index
{
    [self performSegueWithIdentifier:@"fullScreenSegue" sender:self];
} 
```

问题是 detailViewController 有一个 image 属性，它设置为它显示的 UIImageView 的图像，我需要一种方法将图像传递给它以显示。我该怎么做呢？根据苹果文档，我应该在调用控制器中实现 prepareForSegue 方法，但那时我不再有权访问上面的索引。图像位于根视图控制器的数组中，我需要该索引来知道将哪个图像传递给 detailViewController。我还将 detailViewController 设置为具有将调用控制器设置为委托的协议，然后在 init() 方法中调用“setImage”方法，但这似乎不起作用，而且无论如何似乎都是一个疯狂的实现。 .

我考虑过在 rootViewController 中声明一个属性，例如 @property int selectedIndex，然后在上述方法中设置该属性，然后在 prepareForSegue 方法中执行以下操作：

detailViewController.imageForDisplay = [图像 objectAtIndex:selectedIndex];

这可能会奏效，但这种方法让我错了......

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:50:11.617

两种处理方式。在调用 segue 之前，使用 prepareForSegue 并将索引保​​存在某处......

```
self.selectedIndex = index;
[self performSegueWithIdentifier:@"fullScreenSegue" sender:self]; 
```

然后在`prepareForSegue`使用中：

```
if([[segue identifier] isEqualToString:@"fullScreenSegue"])
{
    DetailViewController *detailViewController = segue.destinationViewController;
    detailViewController.imageForDisplay = [self.images objectAtIndex:self.selectedIndex];
} 
```

第二种方法是使用您的委托和协议，但`setImage`在您的方法中进行调用`viewDidLoad`，而不是在您的`init`.

希望有帮助。看起来你已经很接近了。

# python - 使用 ~/.ssh/config 时 Fabric 无法正常工作

> ID：10213864
> 
> 赞同：1
> 
> 时间：2012-04-18T16:33:16.790
> 
> 标签：python, bash, ssh, fabric

我的 ~/.ssh/config 上有以下配置

```
Host death-star
    HostName deathstar.empire.com
    User vader
    IdentityFile ~/.ssh/death_id_rsa 
```

和下面的fabfile

```
from fabric.api import env, task

env.use_ssh_config = True

@task
def destroy_rebels():
    run("echo Alderaan has been destroyed") 
```

我这样称呼任务：

```
$ fab --host death-star destroy_rebels 
```

这是我得到的输出：

```
[death-star] Executing task 'destroy_rebels'
[death-star] run: echo Alderaan has been destroyed

Fatal error: run() received nonzero return code -1 while executing!

Requested: echo Alderaan has been destroyed
Executed: /bin/bash -l -c "echo Alderaan has been destroyed"

Aborting.
Disconnecting from vader@deathstar.empire.com... done. 
```

我很确定 ssh 配置是正确的，因为我可以`ssh death-star`没有问题。

此外，当我指定主机名并使用用户 root 的默认密钥而不是使用 ssh 配置文件时，它可以工作：

```
$ fab --user root --host deathstar.empire.com destroy_rebels 
```

任何想法为什么会发生这种情况？

**编辑**：这是我的面料版本

```
$ fab --version
Fabric 1.4.1
ssh (library) 1.7.13 
```

**编辑 2**：

我已经重写了原帖的部分内容。我意识到`root`( 使用默认键`id_rsa`总是有效，即使使用 `.ssh/config`，如果我添加一个新条目：

```
Host root-death-star
    HostName deathstar.empire.com
    User root
    IdentityFile ~/.ssh/id_rsa

$ fab --host root-death-star destroy_rebels # this works 
```

但是使用非root用户`vader`，有自己的密钥`death_id_rsa`，它不会。但是，以 root 和 vader 的身份通过 SSH 连接到服务器仍然有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T00:39:20.080

从该输出来看，它与 ssh 连接无关，而是正在运行的 echo 的返回代码正在返回。至于是什么使它成为-1，根据您的附加说明，可能是您的 zsh 或 zshrc 中的某些自定义内容抛出了错误的返回码并且它正在冒泡。

# gwt - 使用 GQuery 为小部件分配 ID

> ID：10213866
> 
> 赞同：0
> 
> 时间：2012-04-18T16:33:20.707
> 
> 标签：gwt, gquery, gwtquery

我需要用 ID 包装一个小部件，所以我使用 GQuery 来执行此操作，如下所示：

```
GQuery g = $(signupButton);
g.id("signupButton"); 
```

现在我需要使用 GQuery 对象获取实际 Button 或 Widget 的实例，这可能吗？

将`g.get(0)`返回该按钮/小部件的包装实例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:53:36.793

使用 widget() 方法

```
Button b = g.widget();

//later if you want to query your button via its id
Button b = $("#signupButton").widget() 
```

朱利安

# c - 为目录中的所有文件添加头文件

> ID：10213871
> 
> 赞同：2
> 
> 时间：2012-04-18T16:33:59.457
> 
> 标签：c

我有一个包含很多 C 文件的目录。对于这些 C 文件中的每一个，我都需要添加`#include config.h`. 有没有办法避免手动执行此操作？

我在想也许有一种巧妙的方法可以告诉预处理器这样做，或者将结构良好的标志传递给链接器。如何让目录中的所有文件“包含”相同的头文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T16:39:13.383

要么使用`-include`开关

```
$ cat foo.c
int main(void) {
    printf("%s\n", "ohai there o/");
    return 0;
}
$ gcc -include stdio.h foo.c 
```

或编写一个脚本，该脚本将自动为您插入包含在内

在这些示例中编辑*`.c`*文件，并在文件的*第一行*添加包含。

假设**bash** shell，**GNU** `sed`：

```
while read -r; do
    sed -i '1i #include "config.h"' "$REPLY"
done < <(find /path/to/project/dir -type f -name "*.c") 
```

或者用一些**POSIX**

```
find /path/to/project/dir -type f -name "*.c" | while read -r file; do
    ed "$file" <<EOF
0a
#include "config.h"
.
wq
EOF
done 
```

# api - 运行 Google Places Autocomplete API 时出错

> ID：10213873
> 
> 赞同：0
> 
> 时间：2012-04-18T16:34:05.087
> 
> 标签：api, autocomplete

我是 Google Places Autocomplete API 和一般开发的新手，但我希望有人能帮助我指出正确的方向。我已经查看了 Google Places 文档和示例。在尝试复制 Google 的示例以获得更好的理解（http://code.google.com/apis/maps/documentation/javascript/examples/places-autocomplete.html）时，我在运行它时收到以下错误：

“Google Maps API 服务器拒绝了您的请求。请求中指定的“sensor”参数必须设置为“true”或“false”。”

令人抓狂的是我确实将“传感器”设置为“假”！请参阅下面的完整页面代码。任何建议将不胜感激。

```
<html>
  <head>
    <title>Google Maps JavaScript API v3 Example: Places Autocomplete</title>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"
      type="text/javascript"></script>

    <style type="text/css">
      body {
        font-family: sans-serif;
        font-size: 14px;
      }
      #map_canvas {
        height: 400px;
        width: 600px;
        margin-top: 0.6em;
      }
    </style>

    <script type="text/javascript">
        function initialize() {
            var mapOptions = {
                center: new google.maps.LatLng(-33.8688, 151.2195),
                zoom: 13,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById('map_canvas'),
          mapOptions);

            var input = document.getElementById('searchTextField');
            var autocomplete = new google.maps.places.Autocomplete(input);

            autocomplete.bindTo('bounds', map);

            var infowindow = new google.maps.InfoWindow();
            var marker = new google.maps.Marker({
                map: map
            });

            google.maps.event.addListener(autocomplete, 'place_changed', function () {
                infowindow.close();
                var place = autocomplete.getPlace();
                if (place.geometry.viewport) {
                    map.fitBounds(place.geometry.viewport);
                } else {
                    map.setCenter(place.geometry.location);
                    map.setZoom(17);  // Why 17? Because it looks good.
                }

                var image = new google.maps.MarkerImage(
              place.icon,
              new google.maps.Size(71, 71),
              new google.maps.Point(0, 0),
              new google.maps.Point(17, 34),
              new google.maps.Size(35, 35));
                marker.setIcon(image);
                marker.setPosition(place.geometry.location);

                var address = '';
                if (place.address_components) {
                    address = [(place.address_components[0] &&
                        place.address_components[0].short_name || ''),
                       (place.address_components[1] &&
                        place.address_components[1].short_name || ''),
                       (place.address_components[2] &&
                        place.address_components[2].short_name || '')
                      ].join(' ');
                }

                infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
                infowindow.open(map, marker);
            });

            // Sets a listener on a radio button to change the filter type on Places
            // Autocomplete.
            function setupClickListener(id, types) {
                var radioButton = document.getElementById(id);
                google.maps.event.addDomListener(radioButton, 'click', function () {
                    autocomplete.setTypes(types);
                });
            }

            setupClickListener('changetype-all', []);
            setupClickListener('changetype-establishment', ['establishment']);
            setupClickListener('changetype-geocode', ['geocode']);
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <div>
      <input id="searchTextField" type="text" size="50">
      <input type="radio" name="type" id="changetype-all" checked="checked">
      <label for="changetype-all">All</label>

      <input type="radio" name="type" id="changetype-establishment">
      <label for="changetype-establishment">Establishments</label>

      <input type="radio" name="type" id="changetype-geocode">
      <label for="changetype-geocode">Geocodes</label>
    </div>
    <div id="map_canvas"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-13T13:36:09.923

试试这个脚本

```
 <script>
  function initialize() {
 var mapOptions = {
  center: new google.maps.LatLng(-33.8688, 151.2195),
  zoom: 13,
  mapTypeId: google.maps.MapTypeId.ROADMAP
};
var map = new google.maps.Map(document.getElementById('map_canvas'),
  mapOptions);

var input = document.getElementById('searchTextField');
var autocomplete = new google.maps.places.Autocomplete(input);

autocomplete.bindTo('bounds', map);

var infowindow = new google.maps.InfoWindow();
var marker = new google.maps.Marker({
  map: map
});

google.maps.event.addListener(autocomplete, 'place_changed', function() {
  infowindow.close();
  marker.setVisible(false);
  input.className = '';
  var place = autocomplete.getPlace();
  if (!place.geometry) {
    // Inform the user that the place was not found and return.
    input.className = 'notfound';
    return;
  }

  // If the place has a geometry, then present it on a map.
  if (place.geometry.viewport) {
    map.fitBounds(place.geometry.viewport);
  } else {
    map.setCenter(place.geometry.location);
    map.setZoom(17);  // Why 17? Because it looks good.
  }
  var image = new google.maps.MarkerImage(
      place.icon,
      new google.maps.Size(71, 71),
      new google.maps.Point(0, 0),
      new google.maps.Point(17, 34),
      new google.maps.Size(35, 35));
  marker.setIcon(image);
  marker.setPosition(place.geometry.location);

  var address = '';
  if (place.address_components) {
    address = [
      (place.address_components[0] && place.address_components[0].short_name || ''),
      (place.address_components[1] && place.address_components[1].short_name || ''),
      (place.address_components[2] && place.address_components[2].short_name || '')
    ].join(' ');
  }

  infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
  infowindow.open(map, marker);
});

// Sets a listener on a radio button to change the filter type on Places
// Autocomplete.
function setupClickListener(id, types) {
  var radioButton = document.getElementById(id);
  google.maps.event.addDomListener(radioButton, 'click', function() {
    autocomplete.setTypes(types);
  });
}

setupClickListener('changetype-all', []);
setupClickListener('changetype-establishment', ['establishment']);
setupClickListener('changetype-geocode', ['geocode']);
  }

   google.maps.event.addDomListener(window, 'load', initialize);
    </script> 
```

# c# - 在 C# 中反序列化具有私有成员的对象图

> ID：10213876
> 
> 赞同：0
> 
> 时间：2012-04-18T16:34:08.910
> 
> 标签：c#, xml, serialization

我想在C#中反序列化一个对象图，图中的对象会有对象和集合属性，其中一些属性可能是私有的，但我不需要担心循环对象引用。我的意图是在构建应用程序时使用反序列化的对象图作为测试数据，因此需要能够在任何序列化之前从 XML 中反序列化对象。我希望尽可能容易地自由编辑 XML 以改变构造的对象。我希望反序列化过程不需要对象图中每一层的嵌套循环或嵌套 Linq to SQL 语句。

我发现缺少 DataContractSerializer。它确实可以使用私有 setter 反序列化为私有字段和属性，但在处理 XML 输入方面似乎非常脆弱。只需要 XML 中的一个元素的顺序不正确，它就会失败。更重要的是，它希望声明数据的顺序不一定与在类声明中声明对象成员的顺序相匹配，这使得如果没有对象中的数据开始就无法确定 XML 将起作用，以便您可以序列化它并检查它的期望。

XmlSerializer 似乎无法序列化为任何类型的非公共数据。

由于目的是在开发过程中为可能非常简单的应用程序生成测试输入数据，我宁愿不必求助于重量级的 ORM 技术，如 Entity 或 Nhibernate。

有简单的解决方案吗？

[更新] @Chuck Savage

非常感谢您的回复。由于评论字符限制，我在此编辑中做出回应。

在您建议的技术中，反序列化对象层次结构的每一层的逻辑是在每个类中维护的，因此从某种意义上说，您确实将 Linq to SQL 嵌套在涉及的各个类中。该技术还维护了对 XElement 的引用，每个对象都从该引用中获取每个类中的值，因此从这个意义上说，它并没有被反序列化，而只是在 XML 周围创建一个包装器。在我想到的场景中，理想情况下，我希望反序列化应用程序将使用的实际业务对象，因此像这样的 XML 包装器类型对象不能很好地工作，因为与测试使用相比，它需要完全不同的实现。生产使用。

我真正追求的是可以做类似于 XmlSerializer 可以做的事情，但也可以反序列化私有字段（或至少没有设置器的属性）。原因是 XmlSerializer 所做的事情对所涉及类的“正常”生产使用的影响最小（因此对它们的实现没有影响）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:04:35.090

像这样的东西怎么样：[https ://stackoverflow.com/a/10158569/353147](https://stackoverflow.com/a/10158569/353147)

您将必须创建自己的样板代码来回切换到 xml，但包含的扩展可以最小化。

这是另一个例子：[https ://stackoverflow.com/a/9035905/353147](https://stackoverflow.com/a/9035905/353147)

您还可以使用以下方法搜索我关于该主题的答案：`user:353147 XElement`在 StackOverflow 搜索中。

# java - 设置mysql进程之间的优先级

> ID：10213886
> 
> 赞同：1
> 
> 时间：2012-04-18T16:34:47.247
> 
> 标签：java, mysql, grails

我正在与 MySQL、Grails 和 Java 作斗争。

1.  我有应用程序服务器，在那里运行 Grails 应用程序。
2.  我有另一台带有 mysql db 的服务器。
3.  我有一个 Java 应用程序，它连接到服务器以导出 csv 文件中的数据。

我在数据库中有很多数据（1000 万个寄存器），每 15 分钟 Grails 应用程序就会连接到数据库，以检查和保存新信息。正常运作方式。

我的问题是，当 grails 应用程序正在运行时，我想执行一个 java 应用程序，该应用程序将部分信息导出到数据库中。但我的问题是这个过程真的很慢，但只是有时。我会解释：

1.  如果 Grails 应用程序正常工作，我的 Java 应用程序需要大约 4 天来导出所有数据。Java 进程占用大约 0.3-0% 的 CPU。

2.  如果我关闭了 Tomcat，那么所有到数据库的连接（mySQL 上的 show processlist 命令）大约需要 40 分钟才能完成所有过程。Java 进程占用大约 85% 的 CPU。

我不确定是什么问题，但我尝试了一切，我的问题是我无法在我想要导出的所有时间停止 grails 应用程序。正因为如此，有一些方法可以给进程之间的优先级以确保我的 Java 应用程序将具有最高优先级？

提前感谢您的回答，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T21:23:33.893

这听起来像是数据库锁定问题。我建议使用像[innotop](https://code.google.com/p/innotop/)这样的工具，并仔细查看数据库中发生的情况。特别是，我会仔细查看打开的表、锁和在 grails 应用程序运行时处于活动状态的查询。

# javascript - Facebook Open Graph 对象发布到时间线

> ID：10213889
> 
> 赞同：0
> 
> 时间：2012-04-18T16:35:00.507
> 
> 标签：javascript, facebook, graph

我已经多次遵循本教程： [https ://developers.facebook.com/docs/opengraph/tutorial/ 并且总是得到相同的结果。](https://developers.facebook.com/docs/opengraph/tutorial/)

我总是收到此错误：（#15）必须使用应用程序 access_token 调用此方法。我尝试添加应用程序 access_token 并收到另一个错误，说我只能查询信息而不能发帖。（我检查了隐私设置，并且允许该应用程序发布到时间线。）我确实制作了这些对象，并且在使用 facebook 调试工具时没有发现任何问题。

我还阅读了这部分：

> 为什么我在发布操作时收到“必须使用应用程序 access_token 调用此方法”错误？
> 
> *   在开发人员应用程序中为您的 Open Graph 操作类型取消选中配置页面（隐藏在高级部分下）上的“需要应用访问令牌才能写入”复选框。

我在应用程序配置中找不到这个，我觉得这很旧。我用来发帖的代码与教程完全相同：

```
 function postCook()
  {
      FB.api(
        '/me/[YOUR_APP_NAMESPACE]:cook?recipe=http://fbwerks.com:8000/zhen/cookie.html',
        'post',
        function(response) {
           if (!response || response.error) {
              alert('Error occured');
           } else {
              alert('Cook was successful! Action ID: ' + response.id);
           }
        });
  } 
```

[我当然做了适当的改变:)] 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:19:44.037

我认为这里的我假设您已经通过身份验证。如果不是，则必须将 me 替换为您要发布到的任何用户时间线的 fb id。该用户必须在您的应用程序中进行身份验证。并且您必须使用应用程序的访问令牌。所以 curl url 看起来像：

`curl -d "access_token=<app_access_token>" -d "badge=<object_url.(this has to be publicly accessible)>" https://graph.facebook.com/<authenticated_user_fb_id>/<app_namespace>:<action>`

# c++ - 运行官方 OpenCV 示例时出现向量下标超出范围错误

> ID：10213891
> 
> 赞同：1
> 
> 时间：2012-04-18T16:35:11.217
> 
> 标签：c++, opencv, sift, surf

我正在学习 OpenCV，我尝试运行[这个](http://codepad.org/LtydHOQu)来自 opencv 官方示例的示例。此示例使用 SURF 查找已知对象。我创建了一个 VS2010 项目并将以下内容添加到项目中：

```
opencv_core231.lib opencv_highgui231.lib opencv_features2d231.lib
opencv_video231.lib 
```

我可以成功编译项目。但是，当我运行它时，我收到以下错误：

```
Expression: vector subscript out of range 
```

我调试了程序，发现错误发生在 lin e60: 上`double dist = matches[i].distance`。我不明白为什么我会收到错误。谁能帮我纠正这个问题？

# java - JScrollPane 中的嵌套 JPanel 进入无限闪烁/重绘循环

> ID：10213893
> 
> 赞同：0
> 
> 时间：2012-04-18T16:35:21.513
> 
> 标签：java, swing, jscrollpane, repaint, jtabbedpane

我有一个 Swing 应用程序，其中包含一组中间复杂的嵌套布局。（多个拆分窗格和滚动窗格）SplitPane 中的 ScrollPane 中的一个 Jpanel 包含一个 Jpanel 列表，其中包含各种控件。

时不时地，当我调整窗口大小或用一组新面板重新填充它时，该面板会变得闪烁着疯狂。两个滚动条都显示并且需要，并且面板刚刚开始闪烁/摇晃，因为其中的控件稍微调整大小。

我什至在调试器中发现了这一点——我的代码都没有被调用。这一切都在 Swing/AWT 代码中。在此期间也没有调用我的 Swing.invokeLater 调用。我没有任何自定义控件或绘画发生。这是我暂停 AWT EventQueue 线程时调试器向我显示的堆栈跟踪。

```
Thread [AWT-EventQueue-0] (Suspended)   
X11TextRenderer.doDrawGlyphList(long, long, Region, GlyphList) line: not available [native method]  
X11TextRenderer.drawGlyphList(SunGraphics2D, GlyphList) line: 62    
X11TextRenderer(GlyphListPipe).drawChars(SunGraphics2D, char[], int, int, int, int) line: 86    
SunGraphics2D.drawChars(char[], int, int, int, int) line: 2843  
SwingUtilities2.drawChars(JComponent, Graphics, char[], int, int, int, int) line: 780   
Utilities.drawTabbedText(View, Segment, int, int, Graphics, TabExpander, int, int[]) line: 170  
Utilities.drawTabbedText(View, Segment, int, int, Graphics, TabExpander, int) line: 89  
PlainView.drawUnselectedText(Graphics, int, int, int, int) line: 137    
PlainView.drawElement(int, Element, Graphics, int, int) line: 96    
PlainView.drawLine(int, Graphics, int, int) line: 65    
PlainView.paint(Graphics, Shape) line: 288  
BasicTextUI$RootView.paint(Graphics, Shape) line: 1422  
BasicTextAreaUI(BasicTextUI).paintSafely(Graphics) line: 722    
BasicTextAreaUI(BasicTextUI).paint(Graphics, JComponent) line: 869  
BasicTextAreaUI(BasicTextUI).update(Graphics, JComponent) line: 848 
JTextArea(JComponent).paintComponent(Graphics) line: 752    
JTextArea(JComponent).paint(Graphics) line: 1029    
JPanel(JComponent).paintChildren(Graphics) line: 862    
JPanel(JComponent).paint(Graphics) line: 1038   
JPanel(JComponent).paintChildren(Graphics) line: 862    
JPanel(JComponent).paint(Graphics) line: 1038   
JPanel(JComponent).paintChildren(Graphics) line: 862    
JPanel(JComponent).paint(Graphics) line: 1038   
JViewport(JComponent).paintChildren(Graphics) line: 862 
JViewport(JComponent).paint(Graphics) line: 1038    
JViewport.paint(Graphics) line: 747 
JScrollPane(JComponent).paintChildren(Graphics) line: 862   
JScrollPane(JComponent).paint(Graphics) line: 1038  
JPanel(JComponent).paintChildren(Graphics) line: 862    
JPanel(JComponent).paint(Graphics) line: 1038   
JViewport(JComponent).paintChildren(Graphics) line: 862 
JViewport(JComponent).paint(Graphics) line: 1038    
JViewport.paint(Graphics) line: 747 
JScrollPane(JComponent).paintChildren(Graphics) line: 862   
JScrollPane(JComponent).paint(Graphics) line: 1038  
JScrollPane(JComponent).paintToOffscreen(Graphics, int, int, int, int, int, int) line: 5124 
BufferStrategyPaintManager.paint(JComponent, JComponent, Graphics, int, int, int, int) line: 278    
RepaintManager.paint(JComponent, JComponent, Graphics, int, int, int, int) line: 1224   
JScrollPane(JComponent)._paintImmediately(int, int, int, int) line: 5072    
JScrollPane(JComponent).paintImmediately(int, int, int, int) line: 4882 
RepaintManager.paintDirtyRegions(Map<Component,Rectangle>) line: 785    
RepaintManager.paintDirtyRegions() line: 713    
RepaintManager.seqPaintDirtyRegions() line: 693 
SystemEventQueueUtilities$ComponentWorkRequest.run() line: 125  
InvocationEvent.dispatch() line: 209    
EventQueue.dispatchEventImpl(AWTEvent, Object) line: 641    
EventQueue.access$000(EventQueue, AWTEvent, Object) line: 84    
EventQueue$1.run() line: 602    
EventQueue$1.run() line: 600    
AccessController.doPrivileged(PrivilegedAction<T>, AccessControlContext) line: not available [native method]    
AccessControlContext$1.doIntersectionPrivilege(PrivilegedAction<T>, AccessControlContext, AccessControlContext) line: 87    
EventQueue.dispatchEvent(AWTEvent) line: 611    
EventDispatchThread.pumpOneEventForFilters(int) line: 269   
EventDispatchThread.pumpEventsForFilter(int, Conditional, EventFilter) line: 184    
EventDispatchThread.pumpEventsForHierarchy(int, Conditional, Component) line: 174   
EventDispatchThread.pumpEvents(int, Conditional) line: 169  
EventDispatchThread.pumpEvents(Conditional) line: 161   
EventDispatchThread.run() line: 122 
```

# url - 通过带有参数的 URL 启动 BlackBerry WebWorks PhoneGap 应用程序？

> ID：10213895
> 
> 赞同：1
> 
> 时间：2012-04-18T16:35:26.303
> 
> 标签：url, blackberry, cordova, query-parameters

我有一个 WebWorks PhoneGap 应用程序，我想从浏览器 URL 启动它，并以这种方式将 URL 查询参数传递给应用程序。这可以做到吗？如何？我很乐意[使用](https://stackoverflow.com/questions/8165519/launching-blackberry-application-via-a-custom-url-scheme) [HttpFilterRegistry](https://stackoverflow.com/questions/4568503/how-to-launch-an-application-from-the-browser-in-blackberry)或[Invoke API](https://bdsc.webapps.blackberry.com/html5/apis/blackberry.invoke.html)，但我不知道如何使用这些方法从我的 WebWorks 应用程序中获取参数，即使我编写了自定义扩展。 [PhoneGap/Cordova](http://docs.phonegap.com/en/1.6.0/)也可能有解决方案，但我找不到。示例代码将非常有帮助，特别是对于使用参数。或者至少表明哪些 API 可以做到这一点。

# sql - SQL Server 2008 中嵌套循环连接和哈希连接的区别

> ID：10213900
> 
> 赞同：5
> 
> 时间：2012-04-18T16:35:39.253
> 
> 标签：sql, sql-server-2008, join, hash

嵌套循环连接和散列连接之间的主要区别是什么？我对此一无所知，我所知道的是它们出现在查询的执行计划中。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T16:47:17.423

这里有一些链接。我同意 usr，这个问题不是很有建设性，因为要回答它，我们只会重复在其他地方写的内容。如果您想以更具体的方式重新表述您的问题，例如向我们展示一个查询和一个计划，其中有一种类型，您可能期望另一种类型，或者想知道为什么选择特定类型，那么我认为它会是一个更合适的问题。以下链接应该会有所帮助：

[http://blog.tanelpoder.com/2010/10/06/a-the-most-fundamental-difference-between-hash-and-nested-loop-joins/](http://blog.tanelpoder.com/2010/10/06/a-the-most-fundamental-difference-between-hash-and-nested-loop-joins/)

[http://www.madeira.co.il/loop-hash-and-merge-join-types/](http://www.madeira.co.il/loop-hash-and-merge-join-types/)

[http://www.simple-talk.com/sql/performance/execution-plan-basics/](http://www.simple-talk.com/sql/performance/execution-plan-basics/)

[查询优化器运算符选择 - 嵌套循环与哈希匹配（或合并）](https://stackoverflow.com/questions/8460416/query-optimizer-operator-choice-nested-loops-vs-hash-match-or-merge)

# unit-testing - 多个应用程序的 Eunit 错误

> ID：10213901
> 
> 赞同：2
> 
> 时间：2012-04-18T16:35:39.393
> 
> 标签：unit-testing, erlang, erlang-otp, rebar, eunit

我有以下目录结构：

```
myapp
├── apps
│   ├── myapp
│   ├── myotherapp
│   └── myapp_common
├── deps
│   ├── cowboy
...... 
```

`myapp`我在主目录中使用 rebar 运行 eunit，如下所示：

```
./rebar skip_deps=true eunit 
```

它在`apps/`. 之后它尝试在父`myapp`目录中运行 eunit 并抛出以下错误：

```
......
==> myapp (eunit)
ERROR: eunit failed while processing /home/msheikh/myapp: {'EXIT',{{badmatch,{error,{1,
                           "cp: missing destination file operand after `.eunit'\nTry `cp --help' for more information.\n"}}},
         [{rebar_file_utils,cp_r,2,[]},
          {rebar_eunit,eunit,2,[]},
          {rebar_core,run_modules,4,[]},
          {rebar_core,execute,4,[]},
          {rebar_core,process_dir,4,[]},
          {rebar_core,process_commands,2,[]},
          {rebar,main,1,[]},
          {escript,run,2,[{file,"escript.erl"},{line,727}]}]}} 
```

**问题：**如何解决此问题或阻止 eunit 为父`myapp`目录运行？

`rebar.config`主目录中的文件如下`myapp`所示：

```
{lib_dirs, ["deps", "apps"]}.

{deps, [
        {lager, ".*", {git, "https://github.com/basho/lager.git", {branch, "master"}}},
        {jsx, ".*", {git, "git://github.com/talentdeficit/jsx.git", {tag, "v0.9.0"}}},
        {cowboy, "", {git, "git://github.com/extend/cowboy.git", {branch, "master"}}},
        ....
       ]}.

{require_otp_vsn, "R15"}.

{escript_incl_apps, [getopt]}.

{erl_opts, [
            debug_info, 
            warn_missing_spec,
            {parse_transform, lager_transform}
           ]}.

{eunit_opts, [verbose]}.

{validate_app_modules, false}.

{sub_dirs, [
            "apps/myapp/",
            "apps/myotherapp/",
            "apps/myapp_common/"]}. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-04T13:43:40.427

我有相同的项目结构，它的工作原理。

1.  您确定在顶级目录中没有`src`, `test`,文件夹吗？`ebin`
2.  如果没有，如果你会发生什么`mkdir .eunit`？（我不建议保留这个，而是从那里寻找解决方案）。

# javascript - 这是一个JS无限循环吗？

> ID：10213904
> 
> 赞同：3
> 
> 时间：2012-04-18T16:36:14.237
> 
> 标签：javascript, jquery

我有一个输入 type='text'，并且使用 jQuery，每次这个文本框被模糊时，我都会将 css('background', 'red') 应用于文本框。问题是，当我尝试通过 puttin 调试代码`alert('test')`并在对话框上单击“确定”时，会不断弹出带有“test”的相同对话框。

这仅仅是因为单击“确定”被认为是文本框模糊还是更严重？提前致谢。

```
$('#input').blur(function(){
       $(this).css('background','red');
       alert('test');
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:38:01.270

您应该使用控制台而不是警报进行调试：

```
$('#input').blur(function(){
       $(this).css('background','red');
       console.log('test');
}); 
```

我相信在大多数浏览器中按 F12 会调出控制台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T16:38:07.083

这不是一个无限循环。警报关闭只是调度事件。

尝试`console.log("test")`改用并观察您的浏览器控制台。

谢谢。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T16:38:31.637

改为这样做

```
$('#input').blur(function(){
       $(this).css('background','red');
       console.log('test');
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-18T16:38:52.217

您的代码[工作正常](http://jsfiddle.net/ThiefMaster/K7Gmy/)。

如果您一次又一次地获得模糊事件，听起来就像您将元素重新聚焦在模糊上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T16:38:56.177

代码错误：`);`缺失

```
$('#input').blur(function(){
       $(this).css('background','red');
       alert('test');
}); 
```

您的代码运行良好。

# visual-studio - Visual Studio 2010 中的选项卡组织

> ID：10213908
> 
> 赞同：1
> 
> 时间：2012-04-18T16:36:23.533
> 
> 标签：visual-studio

VS 2010 是否有任何插件可以在两行或多行中创建一个选项卡？或者如果我同时使用许多打开的窗口，如何组织我的选项卡有更好的想法？

我尝试使用垂直方向的选项卡，但我不喜欢它们占用宽度的多少空间（*减少了代码编辑器的空间*）。

也许像 tabsstudio 之类的东西，但免费......？

谢谢

# c# - 反向代理背后的WebService

> ID：10213911
> 
> 赞同：6
> 
> 时间：2012-04-18T16:36:37.457
> 
> 标签：c#, asp.net, web-services, asmx, reverse-proxy

我有一个 Web 服务，它位于这样的反向代理后面：

![反向代理](../Images/b7d1adb6c4d66aa9d4d24466c70da01c.png)

现在发生的事情是，当我尝试添加一个 Web 引用来测试 Web 服务时，它说它无法下载 wsdl 文件。那是因为当请求被发送时它是[https://uat.mywebservice.com/Service/Service.asmx](https://uat.mywebservice.com/Service/Service.asmx)但是当它点击反向代理然后厌倦下载 wsdl 和 disco 文件时，它会将链接更改为[http： //myservice.comp.com/Service/Service.asmx?wsdl](http://myservice.comp.com/Service/Service.asmx?wsdl)这不是正确的链接，因为`myservice.comp.com`它只是反向代理上的名称空间。

发生的事情是soap文件中的标题正在更新到这个命名空间，而不是实际的主机名`uat.mywebservice.com`，我能够看到这个使用提琴手迪斯科文件的地址不正确。我通过使用 wsdl.exe 工具创建代理类来解决问题，然后将该类中所有不正确的链接更新为正确的主机名。

有什么方法可以确保在点击反向代理时地址保持正确。

**不正确：**   `mywebservice.comp.com`

```
<?xml version="1.0" encoding="utf-8" ?> 
<discovery xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/disco/"> 
    <contractRef ref="http://mvwebservice.comp.com/Service/Service.asmx?wsdl" docRef="http://mvwebservice.comp.com/Service/Service.asmx" xmlns="http://schemas.xmlsoap.org/disco/scl/" /> 
    <soap address="http://mywebservice.comp.com/Service/Service.asmx" xmlns:q1="http://tempuri.org/" binding="q1:ServiceSoap" xmlns="http://schemas.xmlsoap.org/disco/soap/" /> 
    <soap address="http://mywebservice.comp.com/Service/Service.asmx" xmlns:q2="http://tempuri.org/" binding="q2:ServiceSoap12" xmlns="http://schemas.xmlsoap.org/disco/soap/" /> 
</discovery> 
```

**正确的：**   `uat.mywebservice.com`

```
<?xml version="1.0" encoding="utf-8" ?> 
<discovery xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/disco/"> 
    <contractRef ref="https://uat.mvwebservice.com/Service/Service.asmx?wsdl" docRef="https://uat.mvwebservice.com/Service/Service.asmx" xmlns="http://schemas.xmlsoap.org/disco/scl/" /> 
    <soap address="https://uat.mywebservice.com/Service/Service.asmx" xmlns:q1="http://tempuri.org/" binding="q1:ServiceSoap" xmlns="http://schemas.xmlsoap.org/disco/soap/" /> 
    <soap address="https://uat.mywebservice.com/Service/Service.asmx" xmlns:q2="http://tempuri.org/" binding="q2:ServiceSoap12" xmlns="http://schemas.xmlsoap.org/disco/soap/" /> 
</discovery> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-11T22:17:37.990

我为解决类似问题所做的是强制 Web 服务发出正确的标头。

您可以执行以下操作：

1.  在文件夹中创建以下类`App_Code`：

    ```
    using System;
    using System.Web.Services.Description;

    namespace Msdn.Web.Services.Samples
    {
      /// <summary> Summary description for WSDLReflector </summary>
      public class WSDLReflector : SoapExtensionReflector
      {
        public override void ReflectMethod()
        {
          //no-op
        }

        public override void ReflectDescription()
        {
          ServiceDescription description = ReflectionContext.ServiceDescription;
          foreach (Service service in description.Services)
          {
            foreach (Port port in service.Ports)
            {
              foreach (ServiceDescriptionFormatExtension extension in port.Extensions)
              {
                SoapAddressBinding binding = extension as SoapAddressBinding;
                if (null != binding)
                {
                  binding.Location = binding.Location.Replace("http://mywebservice.comp.com", "https://uat.mywebservice.com");
                }
              }
            }
          }
        }
      }
    } 
    ```

2.  并将其添加到`web.config`：

    ```
    <webServices>
      <diagnostics suppressReturningExceptions="true" />
      <soapExtensionReflectorTypes>
        <add type="Msdn.Web.Services.Samples.WSDLReflector,App_Code"/>
      </soapExtensionReflectorTypes>
    </webServices> 
    ```

# asp.net - 如何使用 asp.net 有效地传递图像

> ID：10213918
> 
> 赞同：1
> 
> 时间：2012-04-18T16:37:17.287
> 
> 标签：asp.net, asp.net-mvc, architecture, high-load

我的 asp.net 应用程序创建、存储在内存中并向用户显示图像。标准 HttpHandler 从池中获取线程以传递每个图像。我认为这不是有效的。asp.net 能否比 HttpHandler 更有效地传递图像？

更新：图像是临时的。我们将其存储在 1 小时内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T17:18:03.567

IIS 从磁盘提供图像最有效，但不确定是否有效，如果可能的话也使用 CDN。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T18:02:36.170

对于重载/访问的站点，将其作为文件系统是有意义的

# regex - 从 bash 变量中提取数字

> ID：10213920
> 
> 赞同：1
> 
> 时间：2012-04-18T16:37:24.010
> 
> 标签：regex, bash, variables, digits

我有这个代码：

```
for a in `ls *w.txt`; do perl getSequenceNs.pl $a /home/prenos/medicago/${a:0:1}.NOLE.fas >sequences/${a}_sequence.txt; done 
```

除非我认识到 ${a:0:1} 从 $a 中提取第一个数字，否则它一直工作得很好，不幸的是有时有两个。

所以，我的变量 $a 包含：

```
dsomeletters <-one digit and letters, for example 1.NOLE.fas

ddsomeletters <-two digits and letters, for example 12.NOLE.fas 
```

我怎样才能只提取数字？我应该如何修改我的代码（我应该使用什么 use 而不是`${a:0:1}`）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:54:41.743

```
${a//[^0-9]*} 
```

应该做你想做的。这实际上是一种 bashism，因此您可能更喜欢更便携的：

```
${a%%[^0-9]*} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T16:55:23.743

首先，不要 parse `ls`，只有 glob 会正确处理丑陋的字符。现在，您可以使用`bash`字符串操作几种方法来获取数字：

```
$ var=123abc456def
$ echo ${var%%[^0-9]*}
123
$ echo ${var//[^0-9]*/}
123 
```

请注意，`*`这里不是通常的 0+ 重复，它是 globbing。两种模式都从不是数字的第一个字符到字符串末尾删除。所以你的最终命令应该是这样的：

```
for a in *w.txt; do perl getSequenceNs.pl "$a" /home/prenos/medicago/${a%%[^0-9]*}.NOLE.fas >"sequences/${a}_sequence.txt"; done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T16:43:17.190

文件名的字母部分是否始终一致？如果是这样，您可以使用以下方法避免该问题`basename`：

```
NAME=`basename $a .NOLE.fas` 
```

# php - 使用机架空间上传图像

> ID：10213921
> 
> 赞同：1
> 
> 时间：2012-04-18T16:37:27.257
> 
> 标签：php, image, html, rackspace

所以我有以下代码将图像上传到目录/uploads。

```
<?php

// If you want to ignore the uploaded files, 
// set $demo_mode to true;

$demo_mode = false;
$upload_dir = 'uploads/';
$allowed_ext = array('jpg','jpeg','png','gif');

if(strtolower($_SERVER['REQUEST_METHOD']) != 'post'){
    exit_status('Error! Wrong HTTP method!');
}

if(array_key_exists('pic',$_FILES) && $_FILES['pic']['error'] == 0 ){

    $pic = $_FILES['pic'];

    if(!in_array(get_extension($pic['name']),$allowed_ext)){
        exit_status('Only '.implode(',',$allowed_ext).' files are allowed!');
    }   

    if($demo_mode){ 
        // File uploads are ignored. We only log them.

        $line = implode('', array( date('r'), $_SERVER['REMOTE_ADDR'], $pic['size'], $pic['name']));
        file_put_contents('log.txt', $line.PHP_EOL, FILE_APPEND);

        exit_status('Uploads are ignored in demo mode.');
    }

    // Move the uploaded file from the temporary 
    // directory to the uploads folder:

    if(move_uploaded_file($pic['tmp_name'], $upload_dir.$pic['name'])){
        exit_status('File was uploaded successfuly!');
    }
}

exit_status('Something went wrong with your upload!');

// Helper functions

function exit_status($str){
    echo json_encode(array('status'=>$str));
    exit;
}

function get_extension($file_name){
    $ext = explode('.', $file_name);
    $ext = array_pop($ext);
    return strtolower($ext);
}
?> 
```

我试着稍微改变一下代码。因此，我不想上传到目录，而是希望它上传到我的机架空间。我正在使用以下代码（适用于我的其他文件上传）

```
// cloud info
$username = ""; // username
$key = ""; // api key

// Connect to Rackspace
$auth = new CF_Authentication($username, $key);
$auth->authenticate();
$conn = new CF_Connection($auth);

// Get the container we want to use
$container = $conn->get_container('ContainerName');

// store file information
$localfile = $_FILES['pic']['tmp_name'];
$filename = $_FILES['pic']['name'];

// upload file to Rackspace
$object = $container->create_object($filename);
$object->load_from_filename($localfile);
?> 
```

我将图像上传到目录 /upload 的部分替换为上述部分。它不工作。

我正在使用这个 HTML5 拖放上传器。

[http://tutorialzine.com/2011/09/html5-file-upload-jquery-php/](http://tutorialzine.com/2011/09/html5-file-upload-jquery-php/)

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-22T15:04:01.280

我有一个类似的问题。我遇到的问题是该对象没有与之关联的文件类型。有人可能会更好地解释它，因为我是 PHP 新手，但这是我用来为我工作的：

```
$object = $container->create_object($filename);
$object->content_type = "image/jpeg"; //This is where the issue is
$object->load_from_filename($localfile); 
```

# git - Git 标记特定于分支的提交并防止合并

> ID：10213923
> 
> 赞同：-1
> 
> 时间：2012-04-18T16:37:29.937
> 
> 标签：git, git-branch, branching-and-merging

我的项目有两个主要分支 -`master`用于 Web 应用程序的“生产”版本，以及用于应用程序`X`的“测试”版本的分支。

我需要在这两个分支中保持与部署设置、数据库配置、Google Web Analytic ID 等相关的一些代码调整彼此分开，并防止它们`git merge X`在 master 上发生或`git merge master`在分支 X 上执行时被合并。

有没有一种可靠的方法可以做到这一点，即将一些提交标记为“仅用于这个分支”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:44:05.307

Simple answer : not trivially.

Instead, you can either :

*   Cherry pick each commit, excluding the marked ones (a keyword in commit message for example)
*   Make a second branch without these commits and regularly merge it with the branch including them. Merge the "bad commits free" branch with master and the new one.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T21:29:50.827

这并不理想，但我的一个项目中有类似的场景。我的解决方案是改为维护三个分支——master、devel 和 config。config 分支从 devel 上的某个点分支，并且仅包含配置内容（因此得名）。然后我可以按照你的指示在 master 和 devel 之间开发和合并，当我需要测试时，我使用 rebase 将 config 分支移到 devel 的尖端。

它有点麻烦，特别是如果你喜欢在开发中测试每个提交，而不是仅仅定期测试，但它至少是功能性的。

# google-app-engine - 使用 appcfg 将 .war 文件上传到 Google 应用引擎 (GAE)

> ID：10213925
> 
> 赞同：5
> 
> 时间：2012-04-18T16:37:43.823
> 
> 标签：google-app-engine, gwt

出于好奇，是否可以使用工具 appcfg.(/cmd/sh) 将 maven 生成的单个 .war 文件上传到 Google 应用引擎？

我尝试过但出现错误，当我将展开的目录（包含 gwt 文件的目录）指定为路径时，它起作用了。

将上传的单个存档 (.war) 指定为 appcfg 工具的路径会很好。

请让我知道您是否能够做到这一点，或者它是否受到支持。

干杯铅

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T18:04:45.493

Google App Engine 没有规定上传单个`.war`文件。

由于`war/`文件夹必须先于存档的创建`.war`（因为`.war`存档只是一个压缩`war/`目录），因此获得`war/`目录显然比获得`.war`文件更容易。

也许你习惯了 tomcat，你可以`.war`通过管理界面部署一个文件。当 tomcat 接收到该文件时，它所做的只是将其解压缩到`webapps/`. 我怀疑 GAE 会在您的内容`war/`实际上传到他们之前稍微摆弄一下。如果您提供有关您为什么要这样做的更多信息，也许我们可以发现您困惑的根源。

# algorithm - 线性 3SAT：线性时间的 3SAT 版本

> ID：10213929
> 
> 赞同：2
> 
> 时间：2012-04-18T16:38:03.230
> 
> 标签：algorithm, divide-and-conquer

考虑具有以下特殊位置属性的 3SAT 实例。假设布尔公式中有 n 个变量，并且它们的编号为 1,2,3....n，这样每个子句都包含编号在 +-10 范围内的变量。给出求解此类 3SAT 实例的线性时间算法。

我无法解决这个问题，但我的直觉是，如果我们可以将问题映射到图表中，那么可能会得到解决，但不能走得更远..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T17:06:33.330

这是一个相对简单的动态规划问题。我将描述一个解决方案，忽略围绕任一边界的相当简单的索引问题。

在第 m 步之后，我们有一组可能的变量值 (m-10, m-9, ..., m+10)，它们可能是迄今为止的解决方案，每个都链接到所有先前变量的一组值这导致方程 1..m 的解。

对于第 m+1' 步，我们采用这个可能的解决方案集的每个成员，忽略第 m-10' 值，并考虑第 m+11' 值的每种可能性。如果第 m+1 个方程为真，我们将其添加到下一个解集，指向我们的历史，前提是该解模式尚未添加。

这使我们为 m+2nd 步骤做好了准备。

需要 n 个步骤，每个步骤可以考虑大约 200 万个可能的情况，所以这是线性的。

（有趣的挑战。修改这个算法，不仅要找到解决方案，还要计算有多少解决方案。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:54:27.917

我认为你可以在多时间内暴力破解它。将子句列表分成两部分。对分裂两边的变量进行详尽的搜索。最多有 30 个，因此可以尝试 2^30 = O(1) 设置。一旦设置了这些变量，您就可以递归地解决两边，每一个都是具有 n/2 个变量的独立 SAT 实例。

# ruby-on-rails - 检查 nil 给出错误

> ID：10213930
> 
> 赞同：1
> 
> 时间：2012-04-18T16:38:03.387
> 
> 标签：ruby-on-rails, ruby, devise

我的控制器中有这一行：

```
user = User.any_of({:user_name => login}, {:email => login})

if user.nil?
  # ...
elsif user.legacy_password.nil? 
```

它会产生这个错误：

```
undefined method `legacy_password' for []:Array 
```

为什么会发生这种情况？用户对象应该是`nil`. 至少调试器是这么说的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:46:43.757

我假设您的`any_of`方法返回结果数组，而不是单个结果。您可能想要添加`.first`到它的末尾，这将为您提供一条用户记录，或者`nil`如果`any_of`返回一个空数组。

```
user = User.any_of({:user_name => login},{:email => login}).first 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T16:48:07.757

看起来您正在使用 mongoid ( `#any_of`) 并且它正在返回一个数组。

该错误是因为您正在调用`legacy_password`一个数组，但我认为它是在 User 模型上定义的。

# facebook - 想知道脸书更新的概念

> ID：10213933
> 
> 赞同：0
> 
> 时间：2012-04-18T16:38:09.970
> 
> 标签：facebook, live

我想知道 facebook 如何从服务器获取实时更新。做了一些分析，发现它使用了某种不断死亡和生成的频道，比如 0-143.channel.facebook.com

请给出你的想法可能是什么。谢谢 Ankur Goel

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:40:06.647

Facebook 使用 javascript 在指定的时间范围内向其服务器发送 ajax 请求，例如每 60 秒左右，如果有更新，则相应地更新您的 UI。

开始[http://jquery.com/](http://jquery.com/)更具体地说[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# java - 使用 Maven 和多个特殊命名的类路径生成自定义清单

> ID：10213936
> 
> 赞同：0
> 
> 时间：2012-04-18T16:38:20.680
> 
> 标签：java, maven, classpath, manifest

我正在尝试为 YAJSW（另一个 Java 服务包装器）实现一个 Maven 构建过程。我目前正在处理的部分是为 jar 生成自定义清单，以模仿当前硬编码的[MANIFEST.MF](https://github.com/griels/yajsw-maven/blob/30a10d2dd9ef13a196c9192cc8b3035d5f243f6c/yajsw-maven-git/build/MANIFEST.MF)文件中使用的格式，如下所示：

```
Manifest-Version: 1.0
Class-Path-Wrapper-Core: 
./wrapperApp.jar 
./lib/core/yajsw/ahessian.jar 
.
.
.
./lib/core/regex/jrexx-1.1.1.jar

Class-Path-Wrapper-Extended: 
./lib/extended/commons/commons-httpclient-3.0.1.jar 
./lib/extended/commons/commons-codec-1.3.jar 
.
.
./lib/extended/abeille/formsrt.jar

Class-Path-App: 
./wrapper.jar 
.
.
./lib/core/commons/commons-logging-1.1.jar

Main-Class: org.rzo.yajsw.boot.WrapperExeBooter 
```

我已经设法使用 dependency:build-dep 任务生成适当格式的类路径，如下所示：

```
<plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <version>2.4</version>
            <executions>
                <execution>
                    <id>build-classpath</id>
                    <phase>generate-sources</phase>
                    <goals>
                        <goal>build-classpath</goal>
                    </goals>
                    <configuration>
                        <attach>true</attach>
                        <localRepoProperty>.</localRepoProperty>
                        <pathSeparator>$${pathDelim}</pathSeparator>

                        <outputFile>${basedir}/target/assembly/classPath</outputFile>

                    </configuration>
                </execution>
            </executions>
</plugin> 
```

**注意 $${pathDelim} 部分是在对转义、antrun 和属性进行大量实验后得出的。最初我尝试使用 pathSeparator 参数直接添加换行符。我发现我能做到这一点的唯一方法是使用 $${line.separator}。似乎在管道中的某处发生了额外的反转义层。**

此代码成功生成所需格式的 classPath 文件。现在我不得不将它合并到一个 MANIFEST.MF 文件中。

在查看所有选项时，我使用[Antrun 任务](https://github.com/griels/yajsw-maven/blob/0a5bf8248d8ee7f1b656729ff199518e1f68d806/yajsw-maven-git/pom.xml)完成了这项工作：

```
<plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                    <id>compile</id>
                    <phase>compile</phase>
                    <configuration>
                        <target>
                            <property name="cp.props"
                                value="${basedir}/target/assembly/classPath.properties" />

                            <concat destfile="${cp.props}">
                                <string>wrapper.core.classpath=</string>
                                <filelist dir="${basedir}/target/assembly" files="classPath" />
                            </concat>
                            <property file="${cp.props}" />
                            <echo file="${MANIFEST}"
                                message="Manifest-Version: 1.0${line.separator}Class-Path-Wrapper-Core: ${line.separator}
                ${wrapper.core.classpath}${line.separator}
                ${line.separator}
                Class-Path-Wrapper-Extended: ${line.separator}
                ${wrapper.core.classpath}${line.separator}
                ${line.separator}
                Class-Path-App: ${line.separator}
                ${wrapper.core.classpath}${line.separator}
                ${line.separator}
                Main-Class: org.rzo.yajsw.boot.WrapperExeBooter${line.separator}" />
                            <replace file="${MANIFEST}" token="${pathDelim}" value=" " />
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

这在 MANIFEST.MF 文件中或多或少地产生了正确的输出：

```
Manifest-Version: 1.0

Class-Path-Wrapper-Core: 
    ./commons-daemon/commons-daemon/1.0.10/commons-daemon-1.0.10.jar ./commons-configuration/commons-configuration/1.7-SNAPSHOT/commons-configuration-1.7-SNAPSHOT.jar ...

    Class-Path-Wrapper-Extended: 
    ./commons-daemon/commons-daemon/1.0.10/commons-daemon-1.0.10.jar ./commons-configuration/commons-configuration/1.7-SNAPSHOT/commons-configuration-1.7-SNAPSHOT.jar ...

    Class-Path-App: 
    ./commons-daemon/commons-daemon/1.0.10/commons-daemon-1.0.10.jar ./commons-configuration/commons-configuration/1.7-SNAPSHOT/commons-configuration-1.7-SNAPSHOT.jar ...

    Main-Class: org.rzo.yajsw.boot.WrapperExeBooter 
```

然后我在 jar 插件设置中指出：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>2.3</version>
            <configuration>
                <useDefaultManifestFile>false</useDefaultManifestFile>
                <archive> <manifestFile>${MANIFEST}</manifestFile> </archive>
            </configuration>
        </plugin> 
```

但是，查看生成的 jar，它似乎已经使输出变平，如下所示：

```
Manifest-Version: 1.0     Class-Path-Wrapper-Core: ./commons-daemon/commons-daemon/1.0.10/commons-daemon-1.0.10.jar ./commons-configuration/commons-configuration/1.7-SNAPSHOT/commons-configuration-1.7-SNAPSHOT.jar ./commons-collections/commons-collections/3.2.1/commons-collections-3.2.1.jar ./commons-lang/commons-lang/2.6/commons-lang-2.6.jar ./commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar ./commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar ./commons-beanutils/commons-beanutils/1.8.3/commons-beanutils-1.8.3.jar ./org/apache/commons/commons-cli/2.0-SNAPSHOT/commons-cli-2.0-SNAPSHOT.jar ./commons-io/commons-io/1.3.1/commons-io-1.3.1.jar ./org/apache/commons/commons-vfs/2.0-SNAPSHOT/commons-vfs-2.0-SNAPSHOT.jar ./commons-httpclient/commons-httpclient/3.0/commons-httpclient-3.0.jar ./commons-codec/commons-codec/1.2/commons-codec-1.2.jar ./org/apache/commons/commons-vfs2/2.0/commons-vfs2-2.0.jar ./org/apache/maven/scm/maven-scm-api/1.4/maven-scm-api-1.4.jar ./org/apache/maven/scm/maven-scm-provider-svnexe/1.4/maven-scm-provider-svnexe-1.4.jar ./org/apache/maven/scm/maven-scm-provider-svn-commons/1.4/maven-scm-provider-svn-commons-1.4.jar ./regexp/regexp/1.3/regexp-1.3.jar ./org/codehaus/groovy/groovy-all/1.8.6/groovy-all-1.8.6.jar ./net/java/dev/jna/jna/3.4.0/jna-3.4.0.jar ./net/java/dev/jna/platform/3.4.0/platform-3.4.0.jar ./io/netty/netty/3.3.1.Final/netty-3.3.1.Final.jar ./jrexx/jrexx/1.1.1/jrexx-1.1.1.jar ./org/rzo/ahessian/yajsw.11.0/ahessian-yajsw.11.0.jar ./org/quartz-scheduler/quartz/1.8.0/quartz-1.8.0.jar ./javax/transaction/jta/1.1/jta-1.1.jar ./org/slf4j/slf4j-api/1.5.10/slf4j-api-1.5.10.jar ./org/slf4j/slf4j-log4j12/1.5.10/slf4j-log4j12-1.5.10.jar ./log4j/log4j/1.2.14/log4j-1.2.14.jar ./org/apache/velocity/velocity/1.6.3/velocity-1.6.3.jar ./oro/oro/2.0.8/oro-2.0.8.jar ./com/caucho/hessian/4.0.7/hessian-4.0.7.jar ./com/jgoodies/forms/1.2.0/forms-1.2.0.jar ./net/java/dev/glazedlists/glazedlists_java15/1.8.0/glazedlists_java15-1.8.0.jar ./com/jeta/abeille/forms/1.0/forms-1.0.jar ./org/codehaus/mojo/properties-maven-plugin/1.0-alpha-1/properties-maven-plugin-1.0-alpha-1.jar ./org/apache/maven/maven-model/2.0.4/maven-model-2.0.4.jar ./org/apache/maven/maven-plugin-api/2.0/maven-plugin-api-2.0.jar ./org/apache/maven/maven-project/2.0.4/maven-project-2.0.4.jar ./org/apache/maven/maven-settings/2.0.4/maven-settings-2.0.4.jar ./org/apache/maven/maven-profile/2.0.4/maven-profile-2.0.4.jar ./org/apache/maven/maven-artifact-manager/2.0.4/maven-artifact-manager-2.0.4.jar ./org/apache/maven/maven-repository-metadata/2.0.4/maven-repository-metadata-2.0.4.jar ./org/apache/maven/wagon/wagon-provider-api/1.0-alpha-6/wagon-provider-api-1.0-alpha-6.jar ./org/apache/maven/maven-artifact/2.0.4/maven-artifact-2.0.4.jar ./org/codehaus/plexus/plexus-container-default/1.0-alpha-9/plexus-container-default-1.0-alpha-9.jar ./junit/junit/3.8.1/junit-3.8.1.jar ./classworlds/classworlds/1.1-alpha-2/classworlds-1.1-alpha-2.jar ./org/codehaus/plexus/plexus-utils/1.1/plexus-utils-1.1.jar          Class-Path-Wrapper-Extended: ./commons-daemon/commons-daemon/1.0.10/commons-daemon-1.0.10.jar ./commons-configuration/commons-configuration/1.7-SNAPSHOT/commons-configuration-1.7-SNAPSHOT.jar ./commons-collections/commons-collections/3.2.1/commons-collections-3.2.1.jar ./commons-lang/commons-lang/2.6/commons-lang-2.6.jar ./commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar ./commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar ./commons-beanutils/commons-beanutils/1.8.3/commons-beanutils-1.8.3.jar ./org/apache/commons/commons-cli/2.0-SNAPSHOT/commons-cli-2.0-SNAPSHOT.jar ./commons-io/commons-io/1.3.1/commons-io-1.3.1.jar ./org/apache/commons/commons-vfs/2.0-SNAPSHOT/commons-vfs-2.0-SNAPSHOT.jar ./commons-httpclient/commons-httpclient/3.0/commons-httpclient-3.0.jar ./commons-codec/commons-codec/1.2/commons-codec-1.2.jar ./org/apache/commons/commons-vfs2/2.0/commons-vfs2-2.0.jar ./org/apache/maven/scm/maven-scm-api/1.4/maven-scm-api-1.4.jar ./org/apache/maven/scm/maven-scm-provider-svnexe/1.4/maven-scm-provider-svnexe-1.4.jar ./org/apache/maven/scm/maven-scm-provider-svn-commons/1.4/maven-scm-provider-svn-commons-1.4.jar ./regexp/regexp/1.3/regexp-1.3.jar ./org/codehaus/groovy/groovy-all/1.8.6/groovy-all-1.8.6.jar ./net/java/dev/jna/jna/3.4.0/jna-3.4.0.jar ./net/java/dev/jna/platform/3.4.0/platform-3.4.0.jar ./io/netty/netty/3.3.1.Final/netty-3.3.1.Final.jar ./jrexx/jrexx/1.1.1/jrexx-1.1.1.jar ./org/rzo/ahessian/yajsw.11.0/ahessian-yajsw.11.0.jar ./org/quartz-scheduler/quartz/1.8.0/quartz-1.8.0.jar ./javax/transaction/jta/1.1/jta-1.1.jar ./org/slf4j/slf4j-api/1.5.10/slf4j-api-1.5.10.jar ./org/slf4j/slf4j-log4j12/1.5.10/slf4j-log4j12-1.5.10.jar ./log4j/log4j/1.2.14/log4j-1.2.14.jar ./org/apache/velocity/velocity/1.6.3/velocity-1.6.3.jar ./oro/oro/2.0.8/oro-2.0.8.jar ./com/caucho/hessian/4.0.7/hessian-4.0.7.jar ./com/jgoodies/forms/1.2.0/forms-1.2.0.jar ./net/java/dev/glazedlists/glazedlists_java15/1.8.0/glazedlists_java15-1.8.0.jar ./com/jeta/abeille/forms/1.0/forms-1.0.jar ./org/codehaus/mojo/properties-maven-plugin/1.0-alpha-1/properties-maven-plugin-1.0-alpha-1.jar ./org/apache/maven/maven-model/2.0.4/maven-model-2.0.4.jar ./org/apache/maven/maven-plugin-api/2.0/maven-plugin-api-2.0.jar ./org/apache/maven/maven-project/2.0.4/maven-project-2.0.4.jar ./org/apache/maven/maven-settings/2.0.4/maven-settings-2.0.4.jar ./org/apache/maven/maven-profile/2.0.4/maven-profile-2.0.4.jar ./org/apache/maven/maven-artifact-manager/2.0.4/maven-artifact-manager-2.0.4.jar ./org/apache/maven/maven-repository-metadata/2.0.4/maven-repository-metadata-2.0.4.jar ./org/apache/maven/wagon/wagon-provider-api/1.0-alpha-6/wagon-provider-api-1.0-alpha-6.jar ./org/apache/maven/maven-artifact/2.0.4/maven-artifact-2.0.4.jar ./org/codehaus/plexus/plexus-container-default/1.0-alpha-9/plexus-container-default-1.0-alpha-9.jar ./junit/junit/3.8.1/junit-3.8.1.jar ./classworlds/classworlds/1.1-alpha-2/classworlds-1.1-alpha-2.jar ./org/codehaus/plexus/plexus-utils/1.1/plexus-utils-1.1.jar          Class-Path-App: ./commons-daemon/commons-daemon/1.0.10/commons-daemon-1.0.10.jar ./commons-configuration/commons-configuration/1.7-SNAPSHOT/commons-configuration-1.7-SNAPSHOT.jar ./commons-collections/commons-collections/3.2.1/commons-collections-3.2.1.jar ./commons-lang/commons-lang/2.6/commons-lang-2.6.jar ./commons-logging/commons-logging/1.1.1/commons-logging-1.1.1.jar ./commons-digester/commons-digester/1.8.1/commons-digester-1.8.1.jar ./commons-beanutils/commons-beanutils/1.8.3/commons-beanutils-1.8.3.jar ./org/apache/commons/commons-cli/2.0-SNAPSHOT/commons-cli-2.0-SNAPSHOT.jar ./commons-io/commons-io/1.3.1/commons-io-1.3.1.jar ./org/apache/commons/commons-vfs/2.0-SNAPSHOT/commons-vfs-2.0-SNAPSHOT.jar ./commons-httpclient/commons-httpclient/3.0/commons-httpclient-3.0.jar ./commons-codec/commons-codec/1.2/commons-codec-1.2.jar ./org/apache/commons/commons-vfs2/2.0/commons-vfs2-2.0.jar ./org/apache/maven/scm/maven-scm-api/1.4/maven-scm-api-1.4.jar ./org/apache/maven/scm/maven-scm-provider-svnexe/1.4/maven-scm-provider-svnexe-1.4.jar ./org/apache/maven/scm/maven-scm-provider-svn-commons/1.4/maven-scm-provider-svn-commons-1.4.jar ./regexp/regexp/1.3/regexp-1.3.jar ./org/codehaus/groovy/groovy-all/1.8.6/groovy-all-1.8.6.jar ./net/java/dev/jna/jna/3.4.0/jna-3.4.0.jar ./net/java/dev/jna/platform/3.4.0/platform-3.4.0.jar ./io/netty/netty/3.3.1.Final/netty-3.3.1.Final.jar ./jrexx/jrexx/1.1.1/jrexx-1.1.1.jar ./org/rzo/ahessian/yajsw.11.0/ahessian-yajsw.11.0.jar ./org/quartz-scheduler/quartz/1.8.0/quartz-1.8.0.jar ./javax/transaction/jta/1.1/jta-1.1.jar ./org/slf4j/slf4j-api/1.5.10/slf4j-api-1.5.10.jar ./org/slf4j/slf4j-log4j12/1.5.10/slf4j-log4j12-1.5.10.jar ./log4j/log4j/1.2.14/log4j-1.2.14.jar ./org/apache/velocity/velocity/1.6.3/velocity-1.6.3.jar ./oro/oro/2.0.8/oro-2.0.8.jar ./com/caucho/hessian/4.0.7/hessian-4.0.7.jar ./com/jgoodies/forms/1.2.0/forms-1.2.0.jar ./net/java/dev/glazedlists/glazedlists_java15/1.8.0/glazedlists_java15-1.8.0.jar ./com/jeta/abeille/forms/1.0/forms-1.0.jar ./org/codehaus/mojo/properties-maven-plugin/1.0-alpha-1/properties-maven-plugin-1.0-alpha-1.jar ./org/apache/maven/maven-model/2.0.4/maven-model-2.0.4.jar ./org/apache/maven/maven-plugin-api/2.0/maven-plugin-api-2.0.jar ./org/apache/maven/maven-project/2.0.4/maven-project-2.0.4.jar ./org/apache/maven/maven-settings/2.0.4/maven-settings-2.0.4.jar ./org/apache/maven/maven-profile/2.0.4/maven-profile-2.0.4.jar ./org/apache/maven/maven-artifact-manager/2.0.4/maven-artifact-manager-2.0.4.jar ./org/apache/maven/maven-repository-metadata/2.0.4/maven-repository-metadata-2.0.4.jar ./org/apache/maven/wagon/wagon-provider-api/1.0-alpha-6/wagon-provider-api-1.0-alpha-6.jar ./org/apache/maven/maven-artifact/2.0.4/maven-artifact-2.0.4.jar ./org/codehaus/plexus/plexus-container-default/1.0-alpha-9/plexus-container-default-1.0-alpha-9.jar ./junit/junit/3.8.1/junit-3.8.1.jar ./classworlds/classworlds/1.1-alpha-2/classworlds-1.1-alpha-2.jar ./org/codehaus/plexus/plexus-utils/1.1/plexus-utils-1.1.jar          Main-Class: org.rzo.yajsw.boot.WrapperExeBooter
Archiver-Version: Plexus Archiver
Created-By: 20.0-b11 (Sun Microsystems Inc.) 
```

知道如何解决这个问题吗？

* * *

PS在进一步检查中，似乎这种扁平化主要是 jar 构建过程的自然结果，并且也发生在原始 Gradle 构建中。但是，我仍然将所有类路径放在一条线上，并且需要将它们分开......我想知道这是否是 Gradle 合并多个离散清单的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T10:39:55.377

看起来 POM 文件中的缩进导致生成的 MANIFEST.MF 文件中出现空格，并且这些空格被解释为行继续的指示。

我重新调整了 antrun 部分[如下](https://github.com/griels/yajsw-maven/tree/58235e560c0d11f10a865c78f593c435190f0db7/yajsw-maven-git/pom.xml)：

```
<plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.7</version>
            <executions>
                <execution>
                    <id>compile</id>
                    <phase>compile</phase>
                    <configuration>
                        <target>
                            <property name="cp.props"
                                value="${basedir}/target/assembly/classPath.properties" />
                            <property name="ls" value="${line.separator}"/>

                            <concat destfile="${cp.props}">
                                <string>wrapper.core.classpath=</string>
                                <filelist dir="${basedir}/target/assembly" files="classPath" />
                            </concat>
                            <property file="${cp.props}" />
                            <echo file="${MANIFEST}"
                                message="Manifest-Version: 1.0
                ${ls}Class-Path-Wrapper-Core: ${ls} ${wrapper.core.classpath}${ls}
                ${ls}Class-Path-Wrapper-Extended: ${ls} ${wrapper.core.classpath}${ls}
                ${ls}Class-Path-App: ${ls} ${wrapper.core.classpath}${ls}
                ${ls}Main-Class: org.rzo.yajsw.boot.WrapperExeBooter${ls}" />
                            <replace file="${MANIFEST}" token="${pathDelim}" value=" " />
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

现在，当引用 .jar 中的类路径时，YAJSW 似乎更开心了，尽管我还没有完全正确。不过，对这个结果还是很满意的！希望我的所有发现对某人有用-我在 SO 或 Maven 文档中找不到此信息。

# asp.net-mvc-3 - Ninject 的 ASP.NET MVC 3 自定义属性未执行

> ID：10213938
> 
> 赞同：1
> 
> 时间：2012-04-18T16:38:28.260
> 
> 标签：asp.net-mvc-3, ninject, filterattribute

我一定做错了什么，因为我已经复制了很多关于这个主题的答案。我的属性绑定没有被击中，我不知道为什么。

控制器.cs

```
[NatGeoUserAccessAuthorization]
        [HttpGet]
        public virtual ActionResult Teacher(string id)
        { 
```

属性/过滤器

```
public class NatGeoUserAccessAuthorizationAttribute : FilterAttribute{}
    public class NatGeoUserAccessAuthorizationFilter : IAuthorizationFilter 
    {
        private readonly IUsersService _usersService;

        public NatGeoUserAccessAuthorizationFilter(IUsersService usersService)
        {
            _usersService = usersService;
        }

        public string QueryStringName { get; set; }

        #region Implementation of IAuthorizationFilter

        public void OnAuthorization(AuthorizationContext filterContext)
        {
            if (!_usersService.HasUserAccess(filterContext.HttpContext.User.Identity.Name, filterContext.HttpContext.Request.QueryString[QueryStringName ?? "id"]))
            {
                filterContext.Result = new RedirectToRouteResult(new RouteValueDictionary { { "action", "AccessDenied" }, { "controller", "Error" } });
            }
        }

        #endregion
    } 
```

全球.asax

```
protected void Application_Start()
        {            
            // NLog Custom Layouts
            ConfigurationItemFactory.Default.LayoutRenderers.RegisterDefinition("utc_date", typeof(UtcDateRenderer));
            ConfigurationItemFactory.Default.LayoutRenderers.RegisterDefinition("web_variables", typeof(WebVariablesRenderer));

            // Setup IoC Container
            DependencyResolver.SetResolver(Bootstrap.Configure((kernel) =>
            {
                kernel.Bind<IDatabaseFactory>().To<DatabaseFactory<MySqlConnection>>().InRequestScope().WithConstructorArgument("connectionString", Config.Data.MySQLConnection);

                ManagerBindings.Register(kernel);
                ProviderBindings.Register(kernel);
                RepositoryBindings.Register(kernel);
                ServiceBindings.Register(kernel);
                ValidationBindings.Register(kernel);

                kernel.BindFilter<NatGeoUserAccessAuthorizationFilter>(FilterScope.Action, 0).WhenActionMethodHas<NatGeoUserAccessAuthorizationAttribute>();

                kernel.Bind<IUserProfile>().To<UserProfile>();
                kernel.Inject(Roles.Provider);
            }));

            // Custom Default Model Binder
            ModelBinders.Binders.DefaultBinder = new ValidationModelBinder();

            AreaRegistration.RegisterAllAreas();

            RegisterGlobalFilters(GlobalFilters.Filters);
            RegisterRoutes(RouteTable.Routes);
        } 
```

引导程序

```
public class Bootstrap
    {
        public delegate void IocRegistrationDelegate(IKernel kernel);

        public static IDependencyResolver Configure(IocRegistrationDelegate serviceBindings)
        {
            var kernel = new StandardKernel();

            serviceBindings.Invoke(kernel);

            return new NinjectDependencyResolver(kernel);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T17:57:36.950

您正在使用自己的不支持过滤器绑定的引导机制。[在http://github.com/ninject/ninject.web.mvc/wiki](http://github.com/ninject/ninject.web.mvc/wiki)上阅读文档如何使用 Ninject.Mvc3 附带的文档

# zend-framework - Zend Form Elemenet addValidators 列表值

> ID：10213944
> 
> 赞同：-2
> 
> 时间：2012-04-18T16:38:46.460
> 
> 标签：zend-framework, zend-form, zend-form-element

在 Zend_Form_Element 中。我看到`addValidators()`了，但在 Zend 示例和书中没有。他们只向我展示了“NotEmpty”和“EmailAddress”。

还有`->addFilter('StripTags')`和“StringTrim”或“Int”

我想知道`addValidators()`&是否有更多价值`addFilter()`（不仅是“NotEmpty”和“EmailAddress”，对吧？）

但是我在 Zend 网站上找不到任何链接。他们的文档很难使用。

任何人都给我这些价值观的列表或指向我可以学习的某个页面的链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:42:35.537

[参考指南](http://framework.zend.com/manual/en/)是寻找有用信息的地方。

请参阅[Zend_Validate部分的](http://framework.zend.com/manual/en/zend.validate.html)[标准验证器](http://framework.zend.com/manual/en/zend.validate.set.html)页面，该页面显示了您可以使用的所有内置验证类，以及[Zend_Filter](http://framework.zend.com/manual/en/zend.filter.html)部分的[标准过滤器](http://framework.zend.com/manual/en/zend.filter.set.html)的类似页面。

[API 文档](http://framework.zend.com/apidoc/1.11/)为您提供了所有类及其方法的完整概述，但如果您是 ZF 的新手，可能很难在 API 文档中找到您要查找的内容。参考指南是您可能会花费大量时间阅读和学习示例的地方。

`Zend_Form_Element`与`Zend_Validate`类无缝协作，因此您可以为`Zend_Validate_*`表单元素添加 0 个或多个类，以根据一组规则验证它们，而不是手动编写代码来验证输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:46:25.160

您的项目中也有它，位于 library/Zend/Validate 和 library/Zend/Filter

# ruby-on-rails - Rails URL 不起作用

> ID：10213947
> 
> 赞同：0
> 
> 时间：2012-04-18T16:38:51.013
> 
> 标签：ruby-on-rails, ubuntu, webrick, refinerycms

我将在这里尝试做一个很长的故事。我在 Ubuntu 服务器上的 RefineryCMS 中构建了一个应用程序，一切正常，直到我开始收到以下错误消息：

```
.rvm/gems/ruby-1.9.2-p290/gems/activesupport-3.0.12/lib/active_support/dependencies.rb:242:in `require': no such file to load -- devise (LoadError) 
```

我能够通过运行解决此错误

```
gem install devise 
```

其次是

```
bundle install 
```

和

```
bundle update 
```

这解决了它无法启动的问题，但没有一个 url 工作，包括默认的，例如 /users/login 并且任何时候我会导航到这样的页面，我会页面显示错误

```
No route matches [GET] "/users/login" 
```

认为这是我的 gemset 的问题，我创建了一个新的并设置了一个新的，然后启动了新的炼油厂应用程序，目的是将我的文件移到它上面。但是，当启动它以确保炼油厂正常工作时，它把我带到了默认的 rails 页面，在删除 /public/index.html 后我再次启动它并得到了同样的错误

```
No route matches [GET] "/users/login" 
```

为了仔细检查炼油厂是否正常工作，我运行了一个简单的命令行命令来覆盖 /app/views/pages/show.html.erb 文件，该文件运行良好，然后再次启动并手动输入用户/注册页面的 url并再次遇到相同的路线错误。这几乎证实了我的路线被解释的方式存在一些问题，尽管我不知道在什么级别。

我在原始应用程序中使用 rails 版本 3.0.12、webrick 1.3.1 和 ruby​​ 1.9.2。

目前这是我的 Gemfile：

```
source 'http://rubygems.org'

gem "devise"
gem "savon"
gem 'refinerycms-testing'
gem "factory_girl_rails"
gem "guard-rspec"
gem "rspec"

# gem 'rails', '3.0.0'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3', :require => 'sqlite3'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug'

# Bundle the extra gems:
# gem 'bj'
# gem 'nokogiri'
# gem 'sqlite3-ruby', :require => 'sqlite3'
# gem 'aws-s3', :require => 'aws/s3'

# Bundle gems for the local environment. Make sure to
# put test-only gems in this group so their generators
# and rake tasks are available in development mode:
# group :development, :test do
#   gem 'webrat'
# end

# REFINERY CMS ================================================================
# Anything you put in here will be overridden when the app gets updated.

#gem 'refinerycms',              '~> 1.0.9'

=begin #testing
group :development, :test do
    # To use refinerycms-testing, uncomment it (if it's commented out) and run 'bundle install'
    # Then, run 'rails generate refinerycms_testing' which will copy its support files.
    # Finally, run 'rake' to run the tests.
    #gem 'refinerycms-testing'
    gem 'capybara-webkit'

     if RbConfig::CONFIG['target_os'] =~ /darwin/i
       gem 'growl'
    end

   gem 'spork', '~> 0.9.0.rc', :platforms => :ruby
   gem 'guard-spork', :platforms => :ruby
   gem 'guard-rspec', :platforms => :ruby
   gem 'generator_spec'
 end

 =end #testing

 # END REFINERY CMS ============================================================

 # USER DEFINED

   # Specify additional Refinery CMS Engines here (all optional):
   # gem 'refinerycms-inquiries',    '~> 1.0'
   # gem "refinerycms-news",         '~> 1.2'
   # gem 'refinerycms-blog',         '~> 1.6'
   # gem 'refinerycms-page-images',  '~> 1.0'

   # Add i18n support (optional, you can remove this if you really want to).
   #gem 'refinerycms-i18n',         '~> 1.0.0'

 # END USER DEFINED 
```

我的 routes.rb 文件看起来像：

```
 Quicksmile::Application.routes.draw do

   match "/" => redirect("/new-practices") 

   # The priority is based upon order of creation:
   # first created -> highest priority.

   # Sample of regular route:
   #   match 'products/:id' => 'catalog#view'
   # Keep in mind you can assign values other than :controller and :action

   # Sample of named route:
   #   match 'products/:id/purchase' => 'catalog#purchase', :as => :purchase
   # This route can be invoked with purchase_url(:id => product.id)

   # Sample resource route (maps HTTP verbs to controller actions automatically):
   #   resources :products

   # Sample resource route with options:
   #   resources :products do
   #     member do
   #       get 'short'
   #       post 'toggle'
   #     end
   #
   #     collection do
   #       get 'sold'
   #     end
   #   end

   # Sample resource route with sub-resources:
   #   resources :products do
   #     resources :comments, :sales
   #     resource :seller
   #   end

   # Sample resource route with more complex sub-resources
   #   resources :products do
   #     resources :comments
   #     resources :sales do
   #       get 'recent', :on => :collection
   #     end
   #   end

   # Sample resource route within a namespace:
   #   namespace :admin do
   #     # Directs /admin/products/* to Admin::ProductsController
   #     # (app/controllers/admin/products_controller.rb)
   #     resources :products
   #   end

   # You can have the root of your site routed with "root"
   # just remember to delete public/index.html.

   # See how all your routes lay out with "rake routes"

   # This is a legacy wild controller route that's not recommended for RESTful applications.
   # Note: This route will make all actions in every controller accessible via GET requests.
   # match ':controller(/:action(/:id(.:format)))'
 end 
```

为什么可能导致它停止识别原始应用程序或事后启动的新应用程序上的内置炼油厂路线？有没有办法解决它？如果没有，有没有办法将事情回滚到它们正常工作的点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:26:20.287

在我看来，您可能已经完成了部分设计设置，但不是全部。您是否同时运行了两个生成器？

```
rails generate devise:install
rails generate devise User 
```

您`routes.rb`通常会包含以下内容：`devise_for :users`如果设置正确。这就是创建所有路线的原因，例如`user/sign_in`.

# javascript - 是否可以在谷歌地图（v3）标记下创建径向渐变？

> ID：10213954
> 
> 赞同：1
> 
> 时间：2012-04-18T16:39:10.897
> 
> 标签：javascript, google-maps

我想知道如何创建一个径向渐变，从中心的实体到外部的透明，并将其放置在谷歌地图上的标记下。它是否需要在下面的图层上成为一个新的“标记”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T17:13:49.577

通常您可以使用静态图像，您必须在添加它们时定义其几何形状，因为默认值不太可能是您想要的。哦，我没有制作透明度，所以标记在陆地上看起来很奇怪。

见这里：http: [//jsfiddle.net/DRfuR/1/](http://jsfiddle.net/DRfuR/1/)

# ios - 可以终止的其他应用程序列表

> ID：10213957
> 
> 赞同：0
> 
> 时间：2012-04-18T16:39:33.523
> 
> 标签：ios, process

我有一个应用程序，要求查看所有用户启动的应用程序，可以终止。我尝试搜索，但没有找到继续的方法。我能够获取所有进程，包括系统和用户进程，但我只需要过滤可以终止的应用程序。我发现的一种方法是基于 pid 进行过滤，但我无法区分用户进程和系统进程的 pid。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T16:44:21.667

使用 Apple 的 SDK，这是无法做到的，这样的应用程序也无法通过 AppStore 的审批流程。您需要使用越狱的 iOS 设备来完成此类工作。

无论如何，我建议您不要在手动管理应用程序方面进行调查，因为 iOS 已经在那里完成了几乎完美的工作。

# java - 不同状态同步

> ID：10213963
> 
> 赞同：0
> 
> 时间：2012-04-18T16:39:55.473
> 
> 标签：java

我有两个线程thread1和thread2

**在线程1内**

```
synchronized(lock) {  
    lock.wait();  
    if(lock == null)
        {execute1}  
    if(lock != null)  
        {execute2}   
} 
```

**在线程2内**

```
synchronized(lock) {  
    lock.notify();  
    lock = null;  
} 
```

首先调用thread1，然后调用thread2。
在 thread1 调用 wait 之后，它释放它的锁。并且thread2调用notify并将lock设置为null。
现在，当 thread1 再次尝试获取锁时，为什么它没有抛出任何异常。由于 lock 设置为 null 并且 thread1 尝试获取该锁，因此在尝试获取锁时不应该抛出空指针异常。
如果它没有抛出任何异常，则 thread1 仍在读取锁值不为空。那么它不应该执行语句 {execute2} 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T16:49:08.467

您在对象上同步，而不是在变量上同步。监视器属于对象。

如果 lock 指向一个非空对象，然后你等待它，设置`lock`为 null 并不意味着什么，因为它是被等待并通知的对象*指向*的对象。`lock`

然后，当 thread1 重新获得控制权时，将调用 execute1，因为此时*变量*为空。

## 编辑

由于您似乎误解了整体`wait()`和语义，因此这[是 Javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#wait%28%29)`notify()`的相关引用（强调我的）：

> 当前线程必须拥有**该对象的**监视器。**线程释放此监视器**的所有权并等待，直到另一个线程通过调用 notify 方法或 notifyAll 方法通知在**此对象的监视器**上等待的线程唤醒。然后线程**等待直到它可以重新获得监视器的所有权**并恢复执行。

这应该向您表明该变量在用于指向您同步/等待/通知的*对象之前完全不相关。*

# visual-studio - VS 2010 - 如何修复在解决方案中创建 Visual Studio 2010 项目主题文件夹

> ID：10213968
> 
> 赞同：0
> 
> 时间：2012-04-18T16:40:10.577
> 
> 标签：visual-studio, visual-studio-2010

每当我使用 VS 打开文件（例如 aspx、ascx）或解决方案时，它会在文件或解决方案旁边创建以下 3 个文件夹。

*   视觉工作室 2010
*   Visual Studio 2010项目
*   视觉工作室 2010 模板

最近，我们网络中的 Windows 用户帐户出现问题；配置文件问题已由网络管理员修复。

我想知道如何解决这个VS问题。提前致谢。

![在此处输入图像描述](../Images/ec44d7f69d0624f333296f692c77f9b3.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T16:49:27.437

打开***Tools/Options/Projects and Solutions/General***对话框，并确保*Projects Location*、*User Projects Template Location*和*User Items Template Location 的设置正确。*

# mysql - mysql 从今天到现在全选

> ID：10213973
> 
> 赞同：2
> 
> 时间：2012-04-18T16:40:32.680
> 
> 标签：mysql, sql, date, time

我正在尝试构建一个查询，它将返回从今天开始的所有行，但只返回一天中的这个时间点。

例如

如果是下午 12.30，我希望它返回今天日期从 00:00 到 12:30 的所有行，但在 12:30 之后没有任何内容，或者脚本运行的任何时间

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T16:48:32.310

DATE(expression) 删除时间，NOW() 包括当前时间：

```
SELECT * FROM tbl WHERE iDate > DATE(NOW()) and iDate < NOW() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T16:44:46.670

您是否尝试过： SELECT * FROM table WHERE date < TODAY && date > DAYBEFORE 类似这样的东西对于时间戳保存的日期应该可以正常工作。不确定 DATE 格式的值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T16:46:07.403

您可以指定开始时间戳和结束时间戳：

`where created >= timestamp_start && created < timestamp_end`

请注意，我的回答假设您正在使用某种服务器端编程语言来运行这些 sql 查询，因此您会将一个变量传递给 timestamp_start 和 timestamp_end。时间格式：使用 Unix Timestamp

# php - 堆栈跟踪中带有消息“0”的未捕获异常“异常”：#0。基于 API 响应的 PHP 插入

> ID：10213976
> 
> 赞同：1
> 
> 时间：2012-04-18T16:40:59.973
> 
> 标签：php, mysql, api, exception, error-handling

我正在使用 RottenTomatoes Api 获取电影信息。我有一个包含 250 部电影的列表，其中包含有关信息的信息，但是当我到达某个点时，我得到了这个错误。这似乎是随机发生的。我正在获取 api 结果并将它们放入我自己的数据库中。这样的错误会有原因吗？

```
Fatal error:  Uncaught exception 'Exception' with message '0' in /home/ignitet1/public_html/CheckFilm/RottenTomatoes.php:340
Stack trace:
#0 /home/ignitet1/public_html/CheckFilm/RottenTomatoes.php(156): RottenTomatoes-&gt;getResource('http://api.rott...')
#1 ****/loadFullData.php(37): RottenTomatoes-&gt;getMovieInfo('771269025')
#2 {main}
  thrown in ****RottenTomatoes.php</b> on line <b>340</b><br /> 
```

在第 340 行，这是代码。rottentomatoes.php 是一个 php 库，用于解析来自 api 的响应。

```
if (isset($decodedResponse['error']))
            throw new Exception('API Error: ' + $decodedResponse['error']);

        return $decodedResponse; 
```

抱歉解释不佳我无法找到导致问题的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T19:08:22.197

代码中一个明显的错误是这一行：

```
throw new Exception('API Error: ' + $decodedResponse['error']); 
```

应该：

```
throw new Exception('API Error: ' . $decodedResponse['error']); 
```

`+`应该有一个`.`用于连接字符串的而不是。更正后，您应该可以正确看到异常文本。然而真正的问题是为什么首先抛出异常，这可能是（由于`if (isset($decodedResponse['error']))`）从服务器检索到的错误，或者由于某种原因解码/解析失败。

但是，为什么会发生这种情况没有答案，因为问题出在库内部，而不是在您发布的代码中。

# vb.net - 以模态方式将表单保持在另一个表单之上，但继续执行

> ID：10213982
> 
> 赞同：1
> 
> 时间：2012-04-18T16:41:09.793
> 
> 标签：vb.net, winforms

我在一个名为 PolicyRefreshStatus.vb 的 vb.net windows 窗体应用程序中有一个窗体，上面有一个 ProgressBar 控件。从名为 EditPolicy.vb 的主窗体中，我需要在 EditPolicy.vb 之上显示 PolicyRefreshStatus.vb - 但是连接方式我正在控制 ProgressBar，它是 EditPolicy.vb 内部逻辑的步骤。

如果我使用 .show() 方法显示 PolicyRefreshStatus.vb 栏，则一切正常。问题是如果用户在主窗体上单击返回，则 PolicyRefreshStatus.vb 失去焦点。如果我使用 .ShowDialog() 将 PolicyRefreshStatus.vb 显示为模式形式，则在 .ShowDialog() 语句之后的 EditPolicy.vb 中执行停止。

例如在代码中：

```
 mPolicyRefreshStatus = New PolicyRefreshStatus
 mPolicyRefreshStatus.pbMax = mPolicy.ClaimsUpdateMax
 mPolicyRefreshStatus.ShowDialog()
 mPolicy.UpdateFromFIS() 
```

mPolicy.UpdateFromFIS() 行永远不会执行，因为它正在等待 PolicyRefreshStatus 表单关闭。

如何以模态形式显示 PolicyRefreshStatus 但在 EditPolicy.vb 中继续执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T17:19:02.323

您不能以模态方式显示表格并让您的例程继续。您必须以非模态方式显示表单，然后执行其他操作，完成后关闭表单。也许是一个循环，直到任务完成？

将 Show() 与父表单参数一起使用将为您提供更好的可用性。更像是一个工具窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T12:01:49.327

你有几个相关的选项。

这首先是以委托或实现接口的类的形式将工作单元传递给进度条。像这样的东西（没有检查正确性，只是一个粗略的例子）：

```
mPolicyRefreshStatus = New PolicyRefreshStatus  
mPolicyRefreshStatus.pbMax = mPolicy.ClaimsUpdateMax  
mPolicyRefreshStatus.UnitOfWork = AddressOf(mPolicy.UpdateFromFIS())
mPolicyRefreshStatus.ShowDialog() 
```

然后在进度表中，您可以回调实际完成工作的例程。

Another approach is to define events on your ProgressForm and then the owning/launching object can handle those events to do the work in. With this option you can create a fairly detailed set of events to be able to handle incremental work or cancels, but the concept is the same, youu are calling back from the progress form into launcher to perform the actual business logic.

# ios - iPhone上的dyld API - 奇怪的输出

> ID：10213990
> 
> 赞同：2
> 
> 时间：2012-04-18T16:41:35.667
> 
> 标签：ios, c, jailbreak, dyld

我有三个问题要问你，都与 dyld 相关 :)

我一直在使用[这个 dyld 手册页](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/Manpages/man3/dyld.3.html)作为基础。我已经编译了以下代码并在我的越狱设备上成功执行了二进制文件。

```
#include <stdio.h>
#include <mach-o/dyld.h>

int main(int argc, const char* argv[]) {
   uint32_t image_count, i;
   image_count = _dyld_image_count();
   for (i = 0; i < image_count; i++) {
        printf("%s\n", _dyld_get_image_name(i));
   }
   return 0;
} 
```

我认为这些函数可以让我找到加载到我的程序地址空间中的所有共享库。在我的 Mac 上，输出非常简单：它显示了当前加载到内存中的所有库的路径。在我的 iPhone 上，输出几乎相同——我也获得了文件路径——但指定位置没有文件。（另一方面，在我的 Mac 上，我可以找到文件！）

这是输出中的示例行：/usr/lib/system/libdyld.dylib

根据 ls、iFile 和我使用的所有其他工具，这个目录（/usr/lib/system/）是空的。为什么？那些文件在哪里？

我想知道的另一件事是：是否可以在内存中找到一个库？从什么偏移量到库映射到内存的偏移量？我想我知道如何找到开始，但我不知道如何找到图书馆的尽头。要找到开头，我会使用 _dyld_get_image_header 返回的地址 - 对吗？

最后一个问题：我想在系统范围内加载一个动态库，所以我认为我可以使用 DYLD_INSERT_LIBRARIES 来做到这一点。但是，我在插入 lib 后尝试执行的每个二进制文件都会崩溃并产生总线错误！我是否忘记了什么或者是导致崩溃的动态库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T19:22:21.860

库位于：/System/Library/Caches/com.apple.dyld/dyld_shared_cache_armv6 (_armv7) 这是一个大文件，所有单个库都已合并为一个大文件。

请参阅[http://iphonedevwiki.net/index.php/MobileSubstrate](http://iphonedevwiki.net/index.php/MobileSubstrate)以了解越狱设备的挂钩

是的，即使在非越狱设备上，也可以确定 dylib 在内存中的位置。解析库的 LC_SEGMENT(_TEXT *)-Section Header(* _text) 就可以得到库的基地址和 TEXT __text 段的大小。然后查询 vmslide。将此添加到 TEXT __text 的基地址。

可以在此处找到有关 mach-o 文件格式的详细说明： [https](https://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/MachORuntime/Reference/reference.html) ://developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/MachORuntime/Reference/reference.html 。特别注意“segment_command”结构。

# python - 在 Python 中对元组列表进行排序

> ID：10213994
> 
> 赞同：5
> 
> 时间：2012-04-18T16:42:06.247
> 
> 标签：python

在处理 Google Python 类的问题时，我使用 Stack overflow 中的 2-3 个示例制定了以下结果-

```
def sort_last(tuples):
    return [b for a,b in sorted((tup[1], tup) for tup in tuples)]

print sort_last([(1, 3), (3, 2), (2, 1)]) 
```

我昨天学习了列表理解，所以对列表理解有一点了解，但我对这个解决方案的整体工作方式感到困惑。请帮助我理解这一点（函数中的第二行）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T16:46:53.303

这种模式称为装饰-排序-不装饰。

1.  你把每一个都`(1, 3)`变成`(3, (1, 3))`，将每一个包装`tuple`在一个新的元组中，并首先使用你想要排序的项目。
2.  您排序，外部`tuple`确保原始中的第二个项目`tuple`首先排序。
3.  您在保持列表顺序的同时返回从`(3, (1, 3))`到。`(1, 3)`

在 Python 中，显式装饰几乎总是不必要的。相反，使用 的[`key`参数`sorted`](http://docs.python.org/library/functions.html#sorted)：

```
sorted(list_of_tuples, key=lambda tup: tup[1]) # or key=operator.itemgetter(1) 
```

或者，如果您想对 的反转版本进行排序`tuple`，无论其长度如何：

```
sorted(list_of_tuples, key=lambda tup: tup[::-1]) 
                              # or key=operator.itemgetter(slice(None, None, -1)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T16:54:41.340

让我们分解一下：

在 ：`[(tup[1],tup) for tup in tuples]`

出去：`[(3, (1, 3)), (2, (3, 2)), (1, (2, 1))]`

所以我们刚刚创建了新的元组，它的第一个值是内部元组的最后一个值 - 这样它就按“元组”中每个元组的第二个值排序。

现在我们对返回的列表进行排序：

在：`sorted([(3, (1, 3)), (2, (3, 2)), (1, (2, 1))])`

出去：`[(1, (2, 1)), (2, (3, 2)), (3, (1, 3))]`

所以我们现在有我们的列表按每个元组的第二个值排序。剩下的就是提取原始元组，这是通过从 for 循环中仅获取 b 来完成的。

列表推导迭代给定列表（`sorted([...]`在本例中）并按顺序返回提取的值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T16:45:25.630

您的示例通过创建一个新列表来工作，其中索引处的元素`1`后跟列表中每个元组的原始元组。例如。`(3,(1,3))`对于第一个元素。sorted 函数从 index 开始按每个元素`0`排序，因此列表按第二项排序。然后该函数遍历新列表中的每个项目，并返回原始元组。

另一种方法是使用`key`sorted 函数中的参数，该参数根据`key`. 在这种情况下，您希望 成为`key`index 处每个元组中的项目`1`。

```
>>> from operator import itemgetter
>>> sorted([(1, 3), (3, 2), (2, 1)],key=itemgetter(1)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-25T18:30:21.047

请参考接受的答案.. + 这是一个更好的可视化示例，

`key`是一个函数，将被调用以转换集合的项目以进行比较..类似于`compareTo`Java 中的方法。

传递给 key 的参数必须是可调用的。在这里，使用`lambda`创建了一个匿名函数（它是可调用的）。
lambda 的语法是单词 lambda，后跟一个可迭代的名称，然后是一个代码块。

在下面的示例中，我们正在对包含特定事件和演员姓名的信息 abt 时间的元组列表进行排序。

我们按事件发生的时间对这个列表进行排序——这是元组的第 0 个元素。

*为准备好的球员一号球迷大喊！*=)

```
>>> gunters = [('2044-04-05', 'parzival'), ('2044-04-07', 'aech'), ('2044-04-06', 'art3mis')]
>>> gunters.sort(key=lambda tup: tup[0])
>>> print gunters
[('2044-04-05', 'parzival'), ('2044-04-06', 'art3mis'), ('2044-04-07', 'aech')] 
```

注意 -`s.sort([cmp[, key[, reverse]]])` 对 s 的项目进行就地排序