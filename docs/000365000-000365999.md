# StackOverflow 问答 000365000-000365999

# asp.net - ASP.NET MVC：如何在 MVC 应用程序中使用静态 HTML 页面？

> ID：365001
> 
> 赞同：19
> 
> 时间：2008-12-13T08:30:31.423
> 
> 标签：asp.net, asp.net-mvc

在我正在开发的应用程序中，我希望允许用户上传静态 HTML 页面来替换默认的“用户配置文件”MVC 视图页面。这可能吗？也就是说，用户上传的html页面将完全用完MVC，它可以包含自己的CSS链接等。

想法？建议？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-13T09:21:03.647

显然，.net MVC 框架已经为图像/css/js 等处理静态内容。这只是扩展（路由？）以将 .html 文件直接传递到 IIS 的问题。再加上一些重写以制作更漂亮的网址应该可以解决问题。

但是，我会非常非常谨慎地允许以原始 HTML 上传形式的用户生成内容，因为您打开了一扇非常非常大的门。充其量，你会看到人们的页面充满垃圾邮件/色情/广告。在最坏的情况下，您将为人们提供一个网关来上传跨站点脚本黑客并可能上传恶意内容以破坏您的站点。他们可以轻松地在您的网站上采用现有表单，将大量垃圾硬编码到其中，然后从他们的主页执行它并破坏一大堆东西。

至少您应该解析上传的内容以将其缩减为只是一个内容块，然后将其包装在您自己的内容中等。我个人更倾向于为用户提供一个不错的所见即所得编辑器来编辑单个内容块 - 任何值得称道的编辑器都应该为您提供关于它包含/排除哪些元素的消毒。然后将此内容片段存储在您的数据库/磁盘上，并让对主页的请求通过标准 MVC 控制器路由并加载该内容。

* * *

编辑-为您请求示例您应该能够将忽略规则添加到您的路由中-可能已经有这些示例-打开您的 Global.asax 文件-您将要调用路由。忽略路由方法：

```
routes.IgnoreRoute("UserPages/{*path}"); 
```

应该让 IIS 处理对 yourwebsite.com/UserPages/aUser/homepage.html 的所有请求 - 您还可以使用通配符片段/约束来获得更漂亮的解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T09:21:42.303

我建议你制作你的自定义 ViewEngine，它允许使用带有自定义标签的静态 html 标记，它将被用户信息替换。

因此，您的视图引擎可能会接受以下内容：

```
<html>
    <body>
        <b><user:FirstName /></b>
        <b><user:LastName /></b>
    </body>
</html> 
```

并生产

```
<html>
    <body>
        <b>First Name</b>
        <b>Last Name</b>
    </body>
</html> 
```

例如，您可以将此自定义标记存储在数据库中。您可以在[MVC Contrib 项目](http://www.codeplex.com/MVCContrib)中查看自定义 ViewEngine 实现。

# certificate - 从 Comodo 获得代码签名证书需要多长时间？

> ID：365003
> 
> 赞同：3
> 
> 时间：2008-12-13T08:34:03.460
> 
> 标签：certificate

我正在考虑从 Comodo 购买代码签名证书（它们似乎是最便宜的）。

做过这件事的人能告诉我提交商业文件后需要多长时间才能签发证书吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T09:06:16.143

一旦我们传真了所有必要的文件，我们花了大约 1 个工作日

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-01T11:36:51.263

最后花了我大约3个工作日

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-30T15:40:21.917

我们花了 8 个工作日（总共 10 天）才收到我们的，但 Comodo 很难验证我们的公司。我建议向他们提交您的 DUNS # 以及您的 Yellowbook.com 列表，以帮助加快请求速度。我们最初并没有这样做，他们试图通过一个我以前从未听说过的第三方网站列表来验证我们的信息不存在或不正确。

# svn - 远程连接到我的家庭版本控制存储库？

> ID：365006
> 
> 赞同：5
> 
> 时间：2008-12-13T08:38:21.190
> 
> 标签：svn, tortoisesvn

我在家中使用**TortoiseSVN建立了一个版本控制系统来管理我的宠物项目、学校项目等......它在本地工作。**

现在我需要能够远程访问我的代码存储库，就像从学校一样，这样我就能够从存储库更新学校的源代码，并在完成工作后再次提交它。

问题是，**如何远程连接到我的存储库**？例如，我需要在路由器上打开哪些端口？

另外，我不能在学校安装 Tortoise 客户端，所以我需要一些其他的*便携式*应用程序来完成这项任务，无论是 GUI 还是[CLI](http://en.wikipedia.org/wiki/Command-line_interface)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-13T09:02:08.553

有多种方法可以提供远程访问。在您的情况下，最简单的事情可能是设置一个[svnserve server](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-serversetup-svnserve.html)。您可以使用 --daemon 手动启动它，也可以将其安装为 Windows 服务。在任何一种情况下，端口 3690 都必须打开。确保设置密码，并将 svnserve 限制在存储库所在的目录。

作为一个可移植的应用程序，我推荐使用命令行 svn 客户端。Windows存在各种[命令行客户端。](http://subversion.tigris.org/getting.html#windows)您应该在您的机器上安装其中一个，确保您了解如何使用它，然后将它与它需要的所有 DLL 一起复制到 U 盘上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T16:50:53.940

我建议使用[visual svn server](http://www.visualsvn.com/server/download/)来快速设置和运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T17:44:36.950

如果这是您提供的第一个“外部服务”，我会提醒您检查家庭网络的防御。如果您是老手，在防火墙上打开一个洞可能会很轻松，但如果您以前没有这样做过，您将需要谨慎处理。做你的阅读。:-)

或者，有免费的在线代码项目管理站点（[SourceForge](http://sourceforge.net/)和[Google Code](http://code.google.com/hosting/)都会想到），它们提供 Subversion 托管。有些服务甚至允许您提供一个 svndump 来保存您现有的存储库（我相信 Google 代码至少在某个特殊要求下允许这样做，但我不知道这是否仍然可行）。

这两者的一个潜在缺点是它们的存储库是公开可见的。如果您想限制对您的存储库的读取访问权限，还有其他免费服务允许这样做，但恐怕我无法说出任何名字。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-17T11:39:43.457

由于人们已经专门回答了您的问题 - 另一种解决方案：分布式版本控制系统。

Git 可能是最流行的，但我建议尝试 darcs - 因为它被编译成一个可移植的单个二进制文件，不像 git，它是一堆 shell 脚本、perl 脚本/库和 C（或`C++`？）二进制文件。

“DVCS”的固有好处是您可以在不连接到中央服务器的情况下提交（并执行几乎所有其他操作）——当您在学校时，您可以提交、创建/合并分支等等。然后，当您在家时，您“推送”到您的主存储库。

这意味着无需通过路由器打开端口，也不必依赖家庭计算机/互联网连接始终处于启动状态。

另一种替代解决方案是使用第 3 方 SVN 服务器（例如 Google Code，或数百个其他服务器之一 - 有些允许私有存储库，有些则收费），而且您再次不必担心端口 -转发等。

> 问题是，如何远程连接到我的存储库？例如，我需要在路由器上打开哪些端口？

您可以通过像 Apache（[指南](http://www.howtoforge.com/apache_subversion_repository)）这样的网络服务器为 SVN 提供服务 - 然后您只需转发端口 80，并且通常允许在所有网络上使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T18:35:49.140

Martin 是对的：它需要作为守护进程或注册服务运行。在我的机器上，我使用命令 svnserve -d 来启动它。

查看官方的 SVN 书，它也有很多信息：

[http://svnbook.red-bean.com/en/1.5/svn-book.html](http://svnbook.red-bean.com/en/1.5/svn-book.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T16:12:21.303

我建议使用一些提供托管 SVN 的托管服务提供商，例如 Dreamhost。比自己配置和维护要容易得多。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-15T13:13:01.990

您可以将记忆棒上的[RapidSVN](http://rapidsvn.tigris.org/)用作图形 SVN 客户端。下载的是一个安装程序，但安装后，您可以将程序文件文件夹的内容复制到记忆棒，然后从那里运行它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-17T12:30:38.020

我在家里有 svn 服务器，通过 ADSL 线路使用动态 IP。我的设置使我能够远程访问：

*   将颠覆服务器设置为 Windows 服务
*   在服务器防火墙打开端口 3690。
*   在路由器防火墙上打开端口 3690。
*   在 ADSL 路由器上配置端口转发
*   [在www.dyndns.og](http://www.dyndns.org)为家庭服务器设置 DNS
*   设置 SVN 安全性（授权和认证）

# compiler-construction - 我在哪里可以获得学习 EBNF 的材料？

> ID：365012
> 
> 赞同：10
> 
> 时间：2008-12-13T08:47:39.643
> 
> 标签：compiler-construction, boost, parsing, bnf, ebnf

扩展巴库斯-瑙尔形式：**EBNF**

我对解析概念很陌生。我在哪里可以获得足够容易阅读和遵循的材料来为 boost::spirit 库编写语法，它使用类似于 EBNF 的语法？

目前我正在从维基百科研究[EBNF](http://en.wikipedia.org/wiki/Extended_Backus%E2%80%93Naur_form)。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T09:09:09.537

BNF 本身很简单，但是您需要习惯编译器编写者的思维方式。它们不一定容易阅读，但以下是加州大学伯克利分校和斯坦福大学的讲义。

*   [伯克利 CS 164：讲义](http://inst.eecs.berkeley.edu/~cs164/sp08/lectures/index.html)
*   [斯坦福 CS143：讲义](http://www.stanford.edu/class/cs143/materials/lectures/index.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-18T02:40:44.807

维基百科的文章是准确的。如果您有访问权限，请务必阅读[Wirth](http://portal.acm.org/citation.cfm?id=359883)关于 EBNF 的原始文章。

要知道的另一件事是，EBNF 的设计目的是使**手写递归下降解析器变得容易，**因为在这些语言中，每个句法结构在开始时都有识别关键字。花括号转换为`while`循环；方括号（可选的东西）转换为`if`，替代项转换为`if-then-else`or`case`语句。如果您有幸以这种方式设计您的语言，您可以快速敲出解析器*并*给出良好的错误消息。

唯一有点乏味的地方是当你的语言中存在具有许多不同优先级的中缀运算符时。为此，您需要 Dave Hanson 的论文[Compact Recursive-Descent Parsing of Expressions](http://www3.interscience.wiley.com/journal/113447083/abstract?CRETRY=1&SRETRY=0)。也许普林斯顿科技报告系列有免费版，你可以随时查看[汉森的C前端](http://www.cs.princeton.edu/software/lcc)代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-12T05:01:20.077

[这](http://karmin.ch/ebnf/index)是 php 中的 ebnf 解析器。

此外，了解一些有关如何实现正则表达式引擎的知识可能会有所帮助。尝试：[re2](http://code.google.com/p/re2/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T11:07:31.530

好吧，我认为维基百科是最简单的方法，原因有两个：

*   它说明了文章中最相关的观点
*   它在页面底部有进一步阅读的链接

另外，我建议阅读[标准 BNF](http://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form "标准 BNF")以熟悉其背后的想法。

至少我也总是从维基百科开始，而且它几乎总是有帮助的。

# windows - 如何知道本地连接是否可用

> ID：365015
> 
> 赞同：0
> 
> 时间：2008-12-13T08:52:30.303
> 
> 标签：windows, language-agnostic, winapi, networking

我使用的是 Windows XP，我想知道本地区域是否可用？

如果我使用另一个操作系统会影响我的代码吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T10:44:57.180

使用以下代码

```
using System.Net.NetworkInformation; //(Add reference of System.Net.dll)
public partial class Form1: Form
{
    public Form1()
    {
        InitializeComponent();
        NetworkChange.NetworkAvailabilityChanged += NetworkChange_NetworkAvailabilityChanged;
    }
    private void NetworkChange_NetworkAvailabilityChanged(object sender, NetworkAvailabilityEventArgs e)
    {
        if(e.IsAvailable)
        {
            //connected
        }
        else
        {
            //disconnected
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-15T14:49:33.387

[以下是在 Delphi 中的操作方法。](https://stackoverflow.com/questions/325872/detect-an-internet-connection-activation-with-delphi)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2010-03-24T07:30:25.283

~~[ToggleNic](http://channel9.msdn.com/Link/0219bb13-fac4-4794-8cf1-d1c2b969939f/wmv)~~的源代码向您展示了如何启用、禁用或检查 Windows 上的可用网络连接。这是在 C# 中。

# agile - 分布式开发团队 - 所需工具

> ID：365016
> 
> 赞同：3
> 
> 时间：2008-12-13T08:55:36.693
> 
> 标签：agile, distributed

我有一个开发人员团队，分布在全球不同时区。

在这样的团队中实现最大生产力的最佳工具是什么？

我在寻找：

*   源代码控制
*   错误跟踪
*   构建管理
*   任何其他可能有帮助的事情

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T09:07:15.360

对于前两个：

*   分布式源代码控制，如[git](http://git.or.cz/)
*   一个很好的问题跟踪工具，比如[Jira](http://www.atlassian.com/software/jira/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-13T09:08:23.673

这个问题没有详细说明。您列出的每个类别都存在许多软件包，所有软件包都旨在支持分布在不同时区的全球人员之间的协作。

所以我可以根据过去对我有用的开源工具提出建议。您可能有需要更具体解决方案的特定需求，但您没有提及它们。此外，为了提高生产力，如果人们可以继续使用他们熟悉的工具，并且您没有解释您的人们已经知道哪些工具，这将很有用。

无论如何，这是我的建议：

1.  使用 Subversion 进行源代码控制
2.  使用 Roundup 作为错误跟踪器
3.  使用 make 进行构建管理，使用 Buildbot 进行自动化的分布式构建
4.  使用基于 Mailman 的邮件列表

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-13T09:28:22.353

对于 .NET 环境：

*   SVN 服务器：[VisualSVN 服务器](http://www.visualsvn.com/server/)（免费）
*   SVN 客户端：[AnkhSVN 2.0](http://ankhsvn.open.collab.net/)（开源）
*   持续集成：[CruiseControl.Net](http://confluence.public.thoughtworks.org/display/CCNET)（开源）
*   错误跟踪器：[BugTracker.NET](http://www.ifdefined.com/bugtrackernet.html)（开源）。但如果可以的话，我会推荐[Trac](http://trac.edgewall.org/)。

我对[Assembla](http://www.assembla.com/)非常满意——他们以非常合理的价格为您的项目托管 SVN 服务器和[Trac （如果 oproject 是公开的，则免费）。](http://trac.edgewall.org/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T09:53:28.760

作为源代码控制：为什么不使用分布式系统，例如 git（如果您不使用 Windows）、Mercurial 或 Bazaar？
对于错误跟踪，我会继续使用 Trac——它还有一个集成的 Wiki，对于项目文档总是有用的。
至于构建管理，你可以继续巡航控制，或者蚂蚁——我不是这方面的专家。

但是，您确实应该考虑一些事情：分布式团队的主要问题不是工具集，而是**沟通**。
正如您的标签所建议的那样，这在“敏捷”设置中更为重要。

对于这个问题，我见过的最好的缓解方法是视频会议。它对于提高分布式团队的通信带宽非常有效，而且现在使用 GTalk 和 Skype 真的很便宜。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-13T09:54:46.200

考虑[使用 Fogbugz](http://www.fogcreek.com/FogBUGZ)进行错误跟踪。这很有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-13T11:06:17.007

当您说“开源”时，您只是指自由软件，还是“我需要/希望能够看到源代码”？

请注意，您的决定将受到项目性质的影响。有许多免费的开发/项目托管站点要求您的项目必须是开源项目并且免费/向公众开放。

您还可以根据您用于开发项目的语言选择使用特定的托管平台。例如，[CodePlex (http://www.codeplex.com/)](http://www.codeplex.com/)是一个托管基于 .Net 的开源项目的站点，而[Java.Net (http://community.java.net/projects/)](http://community.java.net/projects/)是托管 Java 项目的站点。

对您的问题给出的其他答案是可靠的，这是我目前使用或过去使用过的：

一个很棒的持续构建工具[JetBrains TeamCity。(http://www.jetbrains.com/teamcity/)](http://www.jetbrains.com/teamcity/)该工具对许多构建工具以及开箱即用的 Visual Studio 解决方案提供开箱即用的支持。它对 20 人或更少的开发人员的团队是免费的。它还具有大量开箱即用的功能，并且可以在几分钟内为您启动并运行——在不削减功能的情况下，学习曲线非常低。

[Unfuddle](http://www.unfuddle.com)是一个有用的 SVN 存储库，对两个开发人员免费，可以节省您设置和管理自己的 SVN 存储库的时间。[(http://www.unfuddle.com)](http://www.unfuddle.com) Unfuddle 还具有额外的付费功能和基本任务跟踪。

另一个付费源存储库是 ProjectLocker ( [http://www.projectlocker.com](http://www.projectlocker.com) )，它具有低价的 SVN 存储库和用于任务管理的 Trac 集成。

一个有用的任务跟踪工具是 Remember The Milk ( [http://www.rememberthemilk.com](http://www.rememberthemilk.com) ) - 它不适用于 Trac 之类的“票证”，它不仅用于跟踪项目，还允许您通过电子邮件相互发送任务，并拥有共享的任务列表。*我还要指出它们，因为产品本身是由分布式开发团队开发的，您可能想尝试通过邮件向他们寻求建议。:-)*

祝你的团队一切顺利！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-13T14:34:28.303

[维基](http://en.wikipedia.org/wiki/Wiki)是必须的。

它有助于作为团队内部人员之间的异步通信媒体。人们可以分享他们的技巧（例如，我如何编译这个，如何激活痕迹......）。它可用于收集设计决策或更改...人们可以向整个团队提问，而不会破坏其他邮箱。它也可以用来扩展文档。

有大量的[wiki](http://en.wikipedia.org/wiki/Wiki)，根据您打算用它做什么来[选择一个。](http://www.wikimatrix.org/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-13T18:59:34.227

我认为你需要更多的东西来帮助这个项目，而不是你所要求的。

首先，我将针对您的列表给出我的建议：

*   源代码控制：git 或 svn，如果你使用其中任何一个，你需要一种方法让你的开发人员知道谁在什么时候检查了什么，Trac 对 svn 有好处
*   错误跟踪：Trac（不是 Bugzilla）、Mantis、FogBuz
*   构建管理：CruiseControl 非常适合持续集成；如果您需要构建脚本，请尝试 Ant 或 Maven

您可能需要的其他东西：

*   协作工具：Trac 有一个 wiki 或选择您选择的 wiki
*   聊天工具：即使它们跨时区，也需要即时通信。IRC、Jabber、Skype，非常适合通过 Internet 进行视频或音频通话。
*   项目管理：您需要一种方法来设置发布（如果使用 Scrum，则为冲刺）和待办事项。我最喜欢的工具是 Acunote：( [http://www.acunote.com](http://www.acunote.com) )。还有一些其他的，但它们更贵，你可以获得你可能不需要的所有功能。

我希望这有帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-22T16:55:10.737

是的，我坚信在分布式团队中，工具很重要。如果你们不在本地一起工作，沟通就够难了。像[Agilo for Scrum](http://www.agile42.com/cms/pages/agilo/)这样的基于[trac](http://trac.edgewall.org/)的工具为您提供了一个 wiki、一个计划板（在线白板），并以这种方式支持您改善与同事的沟通。

# javascript - DOM manip 和 GreaseMonkey 的一点帮助

> ID：365028
> 
> 赞同：2
> 
> 时间：2008-12-13T09:10:53.573
> 
> 标签：javascript, twitter, greasemonkey

我不是 JS 人，所以我有点在黑暗中磕磕绊绊。基本上，我想要的东西可以在该人的页面上添加指向特定用户的@replies 的 Twitter 搜索链接。

我想弄清楚两件事：

1.  如何从页面中提取用户名，以便构建正确的 URL。IE。如果我在[http://twitter.com/ev](http://twitter.com/ev)上，我应该得到“ev”。
2.  如何操作 DOM 在正确的位置插入东西

这是我要定位的 HTML 片段：

```
<ul id="tabMenu">
  <li>
    <a href="/ev" id="updates_tab">Updates</a>  </li>
  <li>
    <a href="/ev/favourites" id="favorites_tab">Favorites</a>  </li>
  </ul> 
```

这是脚本（到目前为止）：

```
// ==UserScript==
// @name         Twitter Replies Search
// @namespace    http://jauderho.com/
// @description  Find all the replies for a particular user
// @include      http://twitter.com/*
// @include      https://twitter.com/*
// @exclude      http://twitter.com/home
// @exclude      https://twitter.com/home
// @author       Jauder Ho
// ==/UserScript==

var menuNode = document.getElementById('tabMenu');
if (typeof(menuNode) != "undefined" && menuNode != null)
{
    var html = [];
    html[html.length] = '<li>';
    html[html.length] = '<a href="http://search.twitter.com/search?q=to:ev" class="section-links" id="replies_search_tab">@Replies Search</a>';
    html[html.length] = '</li>';

    // this is obviously wrong
        var div = document.createElement('div');
    div.className = 'section last';
    div.innerHTML = html.join('');
    followingNode = menuNode.parentNode;
    followingNode.parentNode.insertBefore(div, followingNode);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T13:00:09.367

这是上面的纯 DOM 方法——为了好玩，我也提取了用户名：

```
var menuNode = document.getElementById('tabMenu');
if (menuNode!=null)
{
    // extract username from URL; matches /ev and /ev/favourites
    var username = document.location.pathname.split("/")[1];

    // create the link
    var link = document.createElement('a');
    link.setAttribute('href', 'http://search.twitter.com/search?q=to:'+username);
    link.setAttribute('id', 'replies_search_tab');
    link.appendChild(document.createTextNode('@Replies Search'));

    // create the list element
    var li = document.createElement('li');

    // add link to the proper location
    li.appendChild(link);
    menuNode.appendChild(li);    
} 
```

这相当于（基于原始代码片段）：

```
 <ul id="tabMenu">
  <li>
    <a href="/ev" id="updates_tab">Updates</a>  </li>
  <li>
    <a href="/ev/favourites" id="favorites_tab">Favorites</a>  </li>
  <li>
    <a href="http://search.twitter.com/search?q=to:ev" id="replies_search_tab">@Replies Search</a></li>
  </ul> 
```

如果您希望添加的链接显示在不同的位置，您需要花点功夫`insertBefore`。

PS。冒昧地忽略了“section-links”类，因为这是 x 关注、y 关注、z 更新链接的格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T09:35:28.703

这是一种方法，没有经过真正的测试（没有 Twitter 帐户）。

```
var userName = window.location.href.match(/^http:\/\/twitter\.com\/(\w+)/)
if (userName == null)
  return; // Problem?
userName = userName[1];
var menuNode = document.getElementById('tabMenu');
if (menuNode != null)
{
  var html = '<a href="http://search.twitter.com/search?q=to:' +
      userName +
      '" class="section-links" id="replies_search_tab">@Replies Search</a>';

  var li = document.createElement('li');
  li.className = 'section last';
  li.innerHTML = html;
  menuNode.appendChild(li);
} 
```

它将 li 添加到末尾，我删除了 div，因为我怀疑将 li 放入 div 是否正确。如果您确实需要将 li 放在 ul 的开头，请尝试`menuNode.insertBefore(li, menuNode.firstChild)`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T08:25:44.127

在没有库的情况下编写 JavaScript 是我永远无法回到的地狱。

这是一个启用 jQuery 的脚本框架：

```
// ==UserScript==
// @name           MyScript
// @namespace      http://example.com
// @description    Example
// @include        *
//
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.3.1/jquery.min.js
// ==/UserScript==

var menuNode = $('#tabMenu');
if (menuNode!=null)
{
    // extract username from URL; matches /ev and /ev/favourites
    var username = document.location.pathname.split("/")[1];

    // create the link
    var link = $('<a id="replies_search_tab">@Replies Search</a>');
    link.href = 'http://search.twitter.com/search?q=to:'+username;

    // create the list element
    var li = $('<li />');

    // add link to the proper location
    li.append(link);
    menuNode.append(li);    
} 
```

# c++ - 模板语法

> ID：365029
> 
> 赞同：3
> 
> 时间：2008-12-13T09:12:32.057
> 
> 标签：c++, templates

我正在阅读一本关于模板的书，并找到了以下代码：

```
template <template <class> class CreationPolicy>
class WidgetManager : public CreationPolicy<Widget>
{
...
void DoSomething()
{
Gadget* pW = CreationPolicy<Gadget>().Create();
...
}
}; 
```

我没有得到为 CreationPolicy 指定的嵌套模板（这又是一个模板）。这种看起来很奇怪的语法是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T09:23:40.320

这意味着它`CreationPolicy`也必须是一个模板，它接受一个类型参数。你可以把它想象成函数指针或回调的模板等价物。

正如您在该示例中看到的，`CreationPolicy`与参数一起使用：

```
CreationPolicy<SomeType> 
```

除非被声明为“模板模板参数”，否则这是不可能`CreationPolicy`的（是的，这就是所谓的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T09:42:45.990

这是一个模板模板参数。

见[http://www.comeaucomputing.com/techtalk/templates/#ttp](http://www.comeaucomputing.com/techtalk/templates/#ttp)

基本上，CreationPolicy 是模板参数，其约束是它必须是具有一个参数的模板类。

# sql - SQL问题：排除记录

> ID：365045
> 
> 赞同：2
> 
> 时间：2008-12-13T09:38:40.320
> 
> 标签：sql, nexusdb, sql-match-all

我有一个数据库（NexusDB（应该符合 SQL-92）），其中包含 Item 表、一个 Category 表和一个多对多 ItemCategory 表，它只是一对键。如您所料，项目被分配到多个类别。

我希望所有最终用户选择所有项目

物品编号 | 分类号
--------------------------------
01 | 01
01 | 02
01 | 12

02 | 01
02 | 02
02 | 47

03 | 01
03 | 02
03 | 14
等...

我希望能够选择分配给类别 X、Y 和 Z 但未分配给类别 P 和 Q 的所有 ItemID。

例如，对于上面的示例数据，假设我想获取分配给类别 01 或 02 但不是 12 的所有项目（产生项目 02 和 03）。类似于以下内容：

SELECT ItemID WHERE (CategoryID IN (01, 02))

...并从该集合中删除 SELECT ItemID WHERE NOT (CategoryID = 12)

这可能是一个非常基本的 SQL 问题，但它现在难倒我。任何帮助 w/b 表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T09:52:12.023

你可以试试 EXCEPT

```
SELECT ItemID FROM Table
EXCEPT
SELECT ItemID FROM Table
WHERE
CategoryID <> 12 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T17:50:03.197

> 我希望能够选择分配给类别 X、Y 和 Z 但未分配给类别 P 和 Q 的所有 ItemID。

我无法从有关[SELECT](http://www.nexusdb.com/support/index.php?q=node/384)的 NexusDB 文档中确认它们支持子查询，但它们确实支持 LEFT OUTER JOIN 和 GROUP BY。所以这是一个在这些限制范围内工作的查询：

```
SELECT i1.ItemID
FROM ItemCategory i1
  LEFT OUTER JOIN ItemCategory i2
    ON (i1.ItemID = i2.ItemID AND i2.CategoryID IN ('P', 'Q'))
WHERE i1.CategoryID IN ('X', 'Y', 'Z')
  AND i2.ItemID IS NULL
GROUP BY i1.ItemID
HAVING COUNT(i1.CategoryID) = 3; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T09:55:46.103

```
SELECT i.ItemID, ic.CategoryID FROM Item AS i
INNER JOIN ItemCategory ic
ON i.ItemID = ic.ItemID
WHERE ic.CategoryId = 1 OR ic.CategoryId = 2 
```

当然，您需要在 WHERE 子句中输入您想要获取的类别。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T14:00:08.157

对于类别数量较少且已知的简单情况，您可以简单地使用多个连接来检查存在和不存在：

```
SELECT
     ItemID
FROM
     Items I
INNER JOIN ItemCategories IC1 ON IC1.ItemID = I.ItemID AND IC1.CategoryID = '01'
INNER JOIN ItemCategories IC2 ON IC2.ItemID = I.ItemID AND IC2.CategoryID = '02'
LEFT OUTER JOIN ItemCategories IC3 ON IC3.ItemID = I.ItemID AND IC3.CategoryID = '12'
WHERE IC3.ItemID IS NULL 
```

对于更一般的情况，给定匹配和不匹配列表中未知数量的项目，您可以使用以下查询。我为每个列表使用了一个表变量（在 SQL Server 中可用），但您可以根据需要对实际表或变量/参数列表使用选择。这个想法保持不变：

```
SELECT
     ItemID
FROM
     Items I
WHERE
     (
      SELECT COUNT(*)
      FROM ItemCategories IC1
      WHERE IC1.ItemID = I.ItemID
        AND IC.CategoryID IN
           (SELECT CategoryID FROM @MustHaves)
      ) = (SELECT COUNT(*) FROM @MustHaves) AND
      (
      SELECT COUNT(*)
      FROM ItemCategories IC1
      WHERE IC1.ItemID = I.ItemID
        AND IC.CategoryID IN
           (SELECT COUNT(*) FROM @MustNotHaves)
      ) = 0 
```

# c++ - 有趣的 C++ 抽象函数

> ID：365048
> 
> 赞同：3
> 
> 时间：2008-12-13T09:43:17.813
> 
> 标签：c++, internals

为什么会这样？

当您在c ++中创建抽象类时：从类**A**继承**类B之后的****类A**（具有纯虚函数）

 ****如果**A 类** 有一个名为**A()**的构造函数， 假设我创建了**B 类的一个****对象** ，那么编译器首先初始化基类，即**A 类**，然后初始化**B 类**然后.......？

 ******首先是我们不能访问没有 Object 的任何类的构造函数，那么如果我们不能创建抽象类的对象，它是如何初始化抽象类的构造函数的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-13T09:53:25.470

快速回答：构造函数是特殊的。

当 A 的构造函数仍在运行时，则正在构造的对象还不是真正的 A 类型。它仍在构造中。当构造函数完成时，它现在是一个 A。

派生的 B 也是如此。 A 的构造函数首先运行。现在它是一个 A。然后 B 的构造函数开始运行。在此期间，对象仍然是真正的 A。只有当 B 的构造函数完成时，它才会成为 B。

您可以通过尝试从构造函数调用纯虚函数来验证这一点。如果函数在 A 中定义，并且 B 的构造函数调用了它，则会出现运行时错误，而不是运行 B 的覆盖，因为对象还不是 B 类型。

由于纯虚函数，编译器将不允许您生成将构造 A 的代码。但它会生成代码来构造 A 作为构造 B 的过程的一部分。这并不涉及任何魔法。不能构造 A 的规则是语言规则而不是物理学强加的。在构造 B 的对象的特殊情况下，该语言提升了该规则。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-13T09:52:15.533

`class A`是抽象的，但`class B`不是。为了构造`class B`，它必须实现所有的纯虚成员函数`class A`。

```
class A
{
public:
    A() {}
    virtual ~A() {}
    virtual void foo() = 0; // pure virtual
    int i;
};

class B : public A
{
public:
    B() {}
    virtual ~B() {}
    virtual void foo() {}
    int j;
}; 
```

A 类布局可能是这样的：

```
+---------+ +---------+
| 可变表 | --> | 〜A（）| --> A::~A() 的地址
+---------+ +---------+
| 我 | | 富（）| --> NULL，纯虚拟
+---------+ +---------+

```

B 类布局可能是这样的：

```
+---------+ +---------+
| 可变表 | --> | 〜B（）| --> B::~B() 的地址
+---------+ +---------+
| 我 | | 富（）| --> B::foo() 的地址
+---------+ +---------+
| j |
+----------+

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T10:17:04.253

```
struct A {
  A(int x) {..}
  virtual void do() = 0;
};

struct B : public A {
   B() : A(13) {}      // <--- there you see how we give params to A c'tor
   virtual void do() {..}
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T17:18:14.163

```
 And if class A has constructor called A() suppose i created an
 Object of class B then the compiler initializes the base class
 first i.e.class A and then initialize the class B
 Then.......? 
```

实际上你有错误的方法：

当您创建 B 类的对象时，将调用 B 的构造函数。
如果您没有指定 B 构造函数如何调用 A 构造函数，那么编译器将自动插入对 A 的默认构造函数的调用作为初始值设定项列表中的第一个操作。

如果您不想使用默认构造函数，则必须显式调用适当的 A 构造函数作为初始值设定项列表中的第一个元素。

当A的建设完成后，B的建设将继续。

```
First thing is we can not access a constructor of any class without an Object
then how it is initialize the constructor of abstract class if we can not create
an object of abstract class . 
```

您说上面的话，就好像您考虑 A 和 B 不同的事情一样。B 类的对象也是 A 类的对象。有效的是作为一个整体的对象。整个对象属于 B 类，但这包含（作为同一对象的一部分）来自 A 类的所有信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T17:46:29.007

不能直接实例化 class`A`并不意味着不能实例化 class `A`。您不允许实例化`A`，因为编译器知道这`A`是抽象的，并拒绝您编写的任何试图直接实例化的代码`A`。它禁止这样的代码：

```
A a;
new A(); 
```

使类抽象的原因在于它具有纯虚方法。但是，没有什么本质上阻止这样一个类被实例化。C++ 标准只是简单地说这是不允许的。编译器完全能够生成指令来实例化一个抽象类。它所要做的就是保留适量的内存，然后调用构造函数，就像它对非抽象类一样。

当您实例化时`B`，该类的所有内存都会立即分配。由于所有字节都在那里，因此那里基本上有一个`A`实例，准备好由构造函数初始化。*（但请注意，在*构造函数完成运行`A`之前，内存不会被正式视为类型对象。）构造函数运行，然后构造函数运行。*`A``A``B`*

 *# python - 在Python中检测Windows注销

> ID：365058
> 
> 赞同：5
> 
> 时间：2008-12-13T09:55:16.200
> 
> 标签：python, winapi

当 Windows 在 python 中注销时，如何检测或通知？

编辑：Martin v. Löwis 的回答很好，适用于完全注销，但不适用于“快速用户切换”事件，例如按 win+L，这是我真正需要的。

编辑：我没有使用作为服务运行的 gui

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T13:53:12.273

您可以使用终端服务 API 检测快速用户切换事件，您可以使用[pywin32](http://sourceforge.net/projects/pywin32/)`win32ts`中的模块从Python 访问该 API 。在 GUI 应用程序中，调用[WTSRegisterSessionNotification](http://msdn.microsoft.com/en-us/library/aa383841.aspx)接收通知消息，调用[WTSUnRegisterSessionNotification](http://msdn.microsoft.com/en-us/library/aa383847.aspx)停止接收通知，并在窗口过程中处理消息。[`WM_WTSSESSION_CHANGE`](http://msdn.microsoft.com/en-us/library/aa383828.aspx)

如果您使用 Python 编写 Windows 服务，请使用该[`RegisterServiceCtrlHandlerEx`](http://msdn.microsoft.com/en-us/library/ms685058.aspx)函数来检测快速用户切换事件。这在 pywin32 库中作为模块中的`RegisterServiceCtrlHandler`函数可用。`servicemanager`在您的[处理程序函数](http://msdn.microsoft.com/en-us/library/ms683241.aspx)中，查找`SERVICE_CONTROL_SESSIONCHANGE`通知。有关特定通知代码的详细信息，另请参阅[`WM_WTSSESSION_CHANGE`](http://msdn.microsoft.com/en-us/library/aa383828.aspx)文档。

[python-win32 邮件列表中的这个线程](http://mail.python.org/pipermail/python-win32/2008-January/006736.html)中有更多细节，这可能很有用。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-13T10:50:02.203

在控制台应用程序中，您可以使用 win32api.SetConsoleCtrlHandler 并查找 CTRL_LOGOFF_EVENT。在 GUI 应用程序中，您需要打开一个窗口并等待 WM_QUERYENDSESSION 消息。其工作的精确程度（以及是否有效）取决于您的 GUI 库。

# ajax - 如何在 UpdatePanel 中保存历史记录？

> ID：365060
> 
> 赞同：6
> 
> 时间：2008-12-13T09:55:46.340
> 
> 标签：ajax, updatepanel, history

我为 Web 应用程序创建了一个管理页面，它主要是 ajax。页面中的几乎所有事件都会更新页面上的一个 UpdatePanel。如何将每个 UpdatePanel 状态保存在用户的历史记录中，以便当用户按下浏览器“返回”按钮时，他们不会被重定向到登录屏幕？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T21:16:24.200

.NET 3.5 SP 1 中添加了管理历史记录的功能。这里有一些资源可以帮助您快速上手。

[ASP.NET Ajax 历史简介](http://www.asp.net/learn/3.5-SP1/video-242.aspx)

[ASP.NET Podcast Show #117 - 在 .NET 3.5 Service Pack 1 Beta 1 中将历史记录功能与 ASP.NET AJAX UpdatePanel 一起使用](http://aspnetpodcast.com/CS11/blogs/asp.net_podcast/archive/2008/06/15/asp-net-podcast-show-116-using-the-history-functionality-with-the-asp-net-ajax-updatepanel-in-net-3-5-service-pack-1-beta-1.aspx)

[ASP.NET Podcast Show #119 - 在 .NET 3.5 Service Pack 1 Beta 1 中将历史记录（返回）功能与 ASP.NET AJAX Web 服务一起使用](http://aspnetpodcast.com/CS11/blogs/asp.net_podcast/archive/2008/07/01/asp-net-podcast-show-119-using-the-history-back-functionality-with-the-asp-net-ajax-web-services-in-net-3-5-service-pack-1-beta-1.aspx)

# axapta - 在 Axapta/Dynamics Ax 中过滤链接表

> ID：365071
> 
> 赞同：3
> 
> 时间：2008-12-13T10:15:42.587
> 
> 标签：axapta

我在 Axapta/Dynamics Ax (EmplTable) 中有一个表单，它有两个数据源（EmplTable 和 HRMVirtualNetworkTable），其中第二个数据源（HRMVirtualNetworkTable）以“延迟”链接类型链接到第一个数据源。

有没有办法根据第二个数据源对记录设置过滤器，而无需将链接类型更改为“InnerJoin”？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-07-08T12:34:16.280

您可以使用“外部联接”而不是“延迟”，然后在 HRMVirtualNetworkTable 上搜索字段时以编程方式更改联接模式。

将此方法添加到类 SysQuery：

```
static void updateJoinMode(QueryBuildDataSource qds)
{
    Counter r;
    if (qds)
    {
        qds.joinMode(JoinMode::OuterJoin);
        for (r = 1; r <= qds.rangeCount(); r++)
        {
            if (qds.range(r).value() && qds.range(r).status() == RangeStatus::Open)
            {
                qds.joinMode(JoinMode::InnerJoin);
                break;
            }
        }
    }
} 
```

在 EmplTable 数据源的 executeQuery() 中：

```
public void executeQuery()
{;
    SysQuery::updateJoinMode(this.queryRun() ? this.queryRun().query().dataSourceTable(tableNum(HRMVirtualNetworkTable)) : this.query().dataSourceTable(tableNum(HRMVirtualNetworkTable)));    
    super();
} 
```

有时 this.queryRun() 返回 null 所以使用 this.query() 代替。

**更新：**

请注意，上述内容与 AX 2012 及更高版本无关，您可以在外部联接中使用查询过滤器。请参阅[如何将 QueryFilter 类与外部连接一起使用](http://msdn.microsoft.com/en-us/library/gg881181.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-28T09:03:17.910

您可以通过加入 QueryBuildDataSource 或扩展过滤器（Alt+F3，右键单击 datasorce，1:n 并找到 sev\condary DS）以编程方式进行

# axapta - Axapta/Dynamics Ax 中整数字段的范围

> ID：365076
> 
> 赞同：3
> 
> 时间：2008-12-13T10:21:06.507
> 
> 标签：axapta, x++

有没有办法在 Axapta/Dynamics Ax 中创建整数类型的扩展数据类型，它只允许指定范围内的值（即，如果扩展数据类型用于存储年份，我应该能够设置范围（如 1900-2100），还是我必须使用 X++ 代码管理范围？

如果我需要使用 X++ 代码来管理范围，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-27T15:25:20.837

我建议你使用对应表的''validateField''。在 AOT\Data Dictionay\Tables 中搜索该方法以查看许多示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-02T18:51:55.367

您不能指定扩展数据类型本身的范围。如果该类型用于表字段，您可以在表的 insert 和 update 方法中添加代码，以便在更新记录时验证值。然而，这种方法可能会在性能方面付出代价。

如果您对仅在从 UI 修改值时发生的验证感到满意，您还可以选择仅在表的 validateWrite 方法中添加代码。

# python - 您可以更改 Django Admin 应用程序中的字段标签吗？

> ID：365082
> 
> 赞同：61
> 
> 时间：2008-12-13T10:30:41.947
> 
> 标签：python, django, django-admin, django-forms

正如标题所示。我希望能够更改管理应用程序中单个字段的标签。我知道 Form.field 属性，但是如何让我的 Model 或 ModelAdmin 传递该信息？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-12-13T13:59:40.527

字段的[详细名称](http://docs.djangoproject.com/en/dev/topics/db/models/#verbose-field-names)是字段构造时的（可选）第一个参数。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-02-07T04:25:28.450

如果您的字段是一个属性（一种方法），那么您应该使用 short_description：

```
class Person(models.Model):
    ...

    def address_report(self, instance):
        ...
    # short_description functions like a model field's verbose_name
    address_report.short_description = "Address" 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-06-09T13:36:37.217

正如 Javier 建议的那样，您可以在 model.py 的字段中使用详细名称。示例如下，

```
class Employee(models.Model):
     name = models.CharField(max_length = 100)
     dob = models.DateField('Date Of Birth')
     doj = models.DateField(verbose_name='Date Of Joining')
     mobile=models.IntegerField(max_length = 12)
     email = models.EmailField(max_length=50)
     bill = models.BooleanField(db_index=True,default=False)
     proj = models.ForeignKey(Project, verbose_name='Project') 
```

此处 dob、doj 和 proj 文件将根据这些字段中提到的 verbose_name 以管理员形式显示其名称。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2016-10-13T08:51:27.173

```
from django.db import models

class MyClassName(models.Model):    
    field_name = models.IntegerField(verbose_name='Field Caption') 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-13T16:56:52.620

以哈维尔的回答为基础；如果您需要表单中的一个标签（在前端）和管理员上的另一个标签，最好在模型中设置一个内部（管理员）标签并将其覆盖在表单上。管理员当然会自动使用模型字段中的标签。

# linq - 如何将行号投影到 Linq 查询结果中

> ID：365086
> 
> 赞同：34
> 
> 时间：2008-12-13T10:38:52.400
> 
> 标签：linq, row-number

如何将行号投影到 linq 查询结果集。

而不是说：

场 1、场 2、场 3

场 1、场 2、场 3

我想：

1、字段1、字段2、字段3

2、字段1、字段2、字段3

这是我的尝试：

```
public List<ScoreWithRank> GetHighScoresWithRank(string gameId, int count)
{
    Guid guid = new Guid(gameId);
    using (PPGEntities entities = new PPGEntities())
    {
        int i = 1;
        var query = from s in entities.Scores
                    where s.Game.Id == guid
                    orderby s.PlayerScore descending
                    select new ScoreWithRank()
                    {
                        Rank=i++,
                        PlayerName = s.PlayerName,
                        PlayerScore = s.PlayerScore
                    };
        return query.ToList<ScoreWithRank>();
    }
} 
```

不幸的是，“Rank=i++”行抛出以下编译时异常：

“表达式树可能不包含赋值运算符”

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-12-13T11:39:31.277

好吧，最简单的方法是在客户端而不是数据库端执行此操作，并使用 Select 的重载，它也提供索引：

```
public List<ScoreWithRank> GetHighScoresWithRank(string gameId, int count)
{
    Guid guid = new Guid(gameId);
    using (PPGEntities entities = new PPGEntities())
    {
        var query = from s in entities.Scores
                    where s.Game.Id == guid
                    orderby s.PlayerScore descending
                    select new
                    {
                        PlayerName = s.PlayerName,
                        PlayerScore = s.PlayerScore
                    };

        return query.AsEnumerable() // Client-side from here on
                    .Select((player, index) => new ScoreWithRank()
                            {
                                PlayerName = player.PlayerName,
                                PlayerScore = player.PlayerScore,
                                Rank = index + 1;
                            })
                    .ToList();

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T12:09:37.957

好的，这成功了。谢谢。

这是我的最终代码...

服务器：

```
public List<Score> GetHighScores(string gameId, int count)
{
    Guid guid = new Guid(gameId);
    using (PPGEntities entities = new PPGEntities())
    {
        var query = from s in entities.Scores
                    where s.Game.Id == guid
                    orderby s.PlayerScore descending
                    select s;
        return query.ToList<Score>();
    }                                                                      
} 
```

客户：

```
void hsc_LoadHighScoreCompleted(object sender, GetHighScoreCompletedEventArgs e)
{
    ObservableCollection<Score> list = e.Result;

    _listBox.ItemsSource = list.Select((player, index) => new ScoreWithRank()
                            {
                                PlayerName = player.PlayerName,
                                PlayerScore = player.PlayerScore,
                                Rank = index+=1
                            }).ToList();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-02-03T18:39:37.267

您也可以对原始代码稍作调整以使其正常工作。请注意，如果您再次数据绑定或访问该对象，Rank 将每次递增。在这些情况下，最佳答案更好。

```
let Rank = i++ 
```

和

```
Rank.ToString() 
```

完整代码：

```
public List<ScoreWithRank> GetHighScoresWithRank(string gameId, int count)
{
Guid guid = new Guid(gameId);
using (PPGEntities entities = new PPGEntities())
{
    int i = 1;
    var query = from s in entities.Scores
                let Rank = i++
                where s.Game.Id == guid
                orderby s.PlayerScore descending
                select new ScoreWithRank()
                {
                    Rank.ToString(),
                    PlayerName = s.PlayerName,
                    PlayerScore = s.PlayerScore
                };
    return query.ToList<ScoreWithRank>();
} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T12:56:14.120

这个解决方案对我有用。 [http://www.dotnetfunda.com/articles/article1995-rownumber-simulation-in-linq.aspx](http://www.dotnetfunda.com/articles/article1995-rownumber-simulation-in-linq.aspx)

```
.Select((x, index) => new
{
     SequentialNumber = index + 1
    ,FieldFoo = x.FieldFoo                        
}).ToList(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-12T14:48:34.290

```
List<Emp> Lstemp = GetEmpList(); 
int Srno = 0; 
var columns = from t in Lstemp 
              orderby t.Name 
              select new { 
                  Row_number=++Srno, 
                  EmpID = t.ID, 
                  Name = t.Name, 
                  City = t.City 
              }; 
```

# asp.net - 如何从表的列中设置下拉列表的第一个项目 - 选择 - 和剩余项目？

> ID：365087
> 
> 赞同：1
> 
> 时间：2008-12-13T10:39:10.447
> 
> 标签：asp.net, drop-down-menu, c#-2.0

我正在使用下拉菜单来显示表格的“位置”字段。我想将 dropdowm 的第一项设置为“-Select Location-”。我无法将表的第一个记录设置为“选择”，因为表是以 xml 格式存储的。并且表格文件是动态生成的。我目前正在使用

```
 ddlLocationName.Dispose();
    ddlLocationName.AppendDataBoundItems = true;
    ddlLocationName.Items.Add("Select Location");        
    ddlLocationName.DataSource = _section.GetLocations();
    ddlLocationName.DataBind();
    ddlLocationName.AppendDataBoundItems = false; 
```

但数据是重复绑定的。这个问题的解决方案是什么？提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T10:44:22.310

数据绑定后，调用 ddlLocationName.Items.Insert(0, "Select Location");

例子：

```
ddlLocationName.Items.Clear();
ddlLocationName.DataSource = _section.GetLocations();
ddlLocationName.DataBind();
ddlLocationName.Items.Insert(0, "Select Location"); // Adds the item in the first position 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T10:44:04.963

以 ListItems 的形式访问项目：

```
ListItem li = new ListItem("Select Location","-1");
ddlLocationName.Items.Add(li); 
```

绑定其他数据后，使用：

```
ddlLocationName.SelectedValue = "-1"; 
```

此外，您可以先以与 ListItem 类似的方式添加表的值。

# c# - “桌面”窗口

> ID：365094
> 
> 赞同：14
> 
> 时间：2008-12-13T10:45:01.717
> 
> 标签：c#, wpf

我使用[Rainlendar](http://www.rainlendar.net)已经有一段时间了，我注意到它可以选择将窗口“放在桌面上”。它就像一个bottomMost 窗口（相对于topmost）。

我怎么能在 WPF 应用程序上做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-13T12:42:12.133

我的回答是关于 Win32 API，而不是特定于 WPF（并且可能需要来自 C# 的 P/Invoke）：

Rainlendar 有两种选择：

*   “在桌面上”，它成为资源管理器桌面窗口（“程序管理器”）的子级。[您可以使用SetParent](http://msdn.microsoft.com/en-us/library/ms633541(VS.85).aspx) API实现此目的。
*   “在底部”就是您所描述的 - 它的窗口位于 Z 顺序的底部，就在桌面的前面。将它们放在那里很容易（请参阅[SetWindowPos](http://msdn.microsoft.com/en-us/library/ms633545(VS.85).aspx)） - 诀窍是在单击时阻止它们出现在前面。我建议处理[WM_WINDOWPOSCHANGING](http://msdn.microsoft.com/en-us/library/ms632653(VS.85).aspx)消息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-13T14:36:27.020

这是我使用的，所以窗口总是“在底部”：

```
 using System;
    using System.Runtime.InteropServices;
    using System.Windows;
    using System.Windows.Interop; 
```

...

```
[DllImport("user32.dll")]
static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X,
   int Y, int cx, int cy, uint uFlags);

const UInt32 SWP_NOSIZE = 0x0001;
const UInt32 SWP_NOMOVE = 0x0002;
const UInt32 SWP_NOACTIVATE = 0x0010;

static readonly IntPtr HWND_BOTTOM = new IntPtr(1);

public static void SetBottom(Window window)
{
    IntPtr hWnd = new WindowInteropHelper(window).Handle;
    SetWindowPos(hWnd, HWND_BOTTOM, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE);
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-19T12:12:53.100

我试图做同样的事情......我已经使用了很多想法，但我能够做到并防止闪烁。

我设法覆盖了 WndProc，之前使用了一个 setwindowpos 将其置于后台，并使用另一个 setwindowpos 来防止它获得焦点......

```
 const UInt32 SWP_NOSIZE = 0x0001;
    const UInt32 SWP_NOMOVE = 0x0002;
    const UInt32 SWP_NOACTIVATE = 0x0010;
    const UInt32 SWP_NOZORDER = 0x0004;
    const int WM_ACTIVATEAPP = 0x001C;
    const int WM_ACTIVATE = 0x0006;
    const int WM_SETFOCUS = 0x0007;
    static readonly IntPtr HWND_BOTTOM = new IntPtr(1);
    const int WM_WINDOWPOSCHANGING = 0x0046;

    [DllImport("user32.dll")]
    static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X,
       int Y, int cx, int cy, uint uFlags);
    [DllImport("user32.dll")]
    static extern IntPtr DeferWindowPos(IntPtr hWinPosInfo, IntPtr hWnd,
       IntPtr hWndInsertAfter, int x, int y, int cx, int cy, uint uFlags);
    [DllImport("user32.dll")]
    static extern IntPtr BeginDeferWindowPos(int nNumWindows);
    [DllImport("user32.dll")]
    static extern bool EndDeferWindowPos(IntPtr hWinPosInfo);

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
        IntPtr hWnd = new WindowInteropHelper(this).Handle;
        SetWindowPos(hWnd, HWND_BOTTOM, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE);

        IntPtr windowHandle = (new WindowInteropHelper(this)).Handle;
        HwndSource src = HwndSource.FromHwnd(windowHandle);
        src.AddHook(new HwndSourceHook(WndProc));
    }

    private IntPtr WndProc(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
    {
        if (msg == WM_SETFOCUS)
        {
            IntPtr hWnd = new WindowInteropHelper(this).Handle;
            SetWindowPos(hWnd, HWND_BOTTOM, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE);
            handled = true;
        }
        return IntPtr.Zero;
    }

    private void Window_Closing(object sender, System.ComponentModel.CancelEventArgs e)
    {
        IntPtr windowHandle = (new WindowInteropHelper(this)).Handle;
        HwndSource src = HwndSource.FromHwnd(windowHandle);
        src.RemoveHook(new HwndSourceHook(this.WndProc));
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-27T22:14:18.360

我使用的 OnDesktop 版本：

```
[DllImport("user32.dll")]
static extern IntPtr SetParent(IntPtr hWndChild, IntPtr hWndNewParent);
[DllImport("user32.dll", SetLastError = true)]
static extern IntPtr FindWindow(string lpClassName, string lpWindowName);

public static void SetOnDesktop(Window window)
{
    IntPtr hWnd = new WindowInteropHelper(window).Handle;         
    IntPtr hWndProgMan = FindWindow("Progman", "Program Manager");
    SetParent(hWnd, hWndProgMan);
} 
```

我在查找“程序管理器”窗口时遇到了一些麻烦，但 Rainlendar 的创建者 Kimmo 给了我一个代码链接：

[http://www.ipi.fi/~rainy/legacy.html](http://www.ipi.fi/~rainy/legacy.html)

如果有人需要更多详细信息，只需在 library/rainwindow.cpp 中查找函数 SetWindowZPos。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-08-25T16:52:32.023

@HrejWaltz 答案的附加属性版本：

**更新（2016 年 12 月 28 日）**

```
public class WindowSinker
{
    #region Properties

    const UInt32 SWP_NOSIZE = 0x0001;
    const UInt32 SWP_NOMOVE = 0x0002;
    const UInt32 SWP_NOACTIVATE = 0x0010;
    const UInt32 SWP_NOZORDER = 0x0004;
    const int WM_ACTIVATEAPP = 0x001C;
    const int WM_ACTIVATE = 0x0006;
    const int WM_SETFOCUS = 0x0007;
    const int WM_WINDOWPOSCHANGING = 0x0046;

    static readonly IntPtr HWND_BOTTOM = new IntPtr(1);

    Window Window = null;

    #endregion

    #region WindowSinker

    public WindowSinker(Window Window)
    {
        this.Window = Window;
    }

    #endregion

    #region Methods

    [DllImport("user32.dll")]
    static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int X, int Y, int cx, int cy, uint uFlags);

    [DllImport("user32.dll")]
    static extern IntPtr DeferWindowPos(IntPtr hWinPosInfo, IntPtr hWnd, IntPtr hWndInsertAfter, int x, int y, int cx, int cy, uint uFlags);

    [DllImport("user32.dll")]
    static extern IntPtr BeginDeferWindowPos(int nNumWindows);

    [DllImport("user32.dll")]
    static extern bool EndDeferWindowPos(IntPtr hWinPosInfo);

    void OnClosing(object sender, System.ComponentModel.CancelEventArgs e)
    {
        var Handle = (new WindowInteropHelper(Window)).Handle;

        var Source = HwndSource.FromHwnd(Handle);
        Source.RemoveHook(new HwndSourceHook(WndProc));
    }

    void OnLoaded(object sender, RoutedEventArgs e)
    {
        var Hwnd = new WindowInteropHelper(Window).Handle;
        SetWindowPos(Hwnd, HWND_BOTTOM, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE);

        var Handle = (new WindowInteropHelper(Window)).Handle;

        var Source = HwndSource.FromHwnd(Handle);
        Source.AddHook(new HwndSourceHook(WndProc));
    }

    IntPtr WndProc(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
    {
        if (msg == WM_SETFOCUS)
        {
            hWnd = new WindowInteropHelper(Window).Handle;
            SetWindowPos(hWnd, HWND_BOTTOM, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE);
            handled = true;
        }
        return IntPtr.Zero;
    }

    public void Sink()
    {
        Window.Loaded += OnLoaded;
        Window.Closing += OnClosing;
    }

    public void Unsink()
    {
        Window.Loaded -= OnLoaded;
        Window.Closing -= OnClosing;
    }

    #endregion
}

public static class WindowExtensions
{
    #region Always On Bottom

    public static readonly DependencyProperty SinkerProperty = DependencyProperty.RegisterAttached("Sinker", typeof(WindowSinker), typeof(WindowExtensions), new UIPropertyMetadata(null));
    public static WindowSinker GetSinker(DependencyObject obj)
    {
        return (WindowSinker)obj.GetValue(SinkerProperty);
    }
    public static void SetSinker(DependencyObject obj, WindowSinker value)
    {
        obj.SetValue(SinkerProperty, value);
    }

    public static readonly DependencyProperty AlwaysOnBottomProperty = DependencyProperty.RegisterAttached("AlwaysOnBottom", typeof(bool), typeof(WindowExtensions), new UIPropertyMetadata(false, OnAlwaysOnBottomChanged));
    public static bool GetAlwaysOnBottom(DependencyObject obj)
    {
        return (bool)obj.GetValue(AlwaysOnBottomProperty);
    }
    public static void SetAlwaysOnBottom(DependencyObject obj, bool value)
    {
        obj.SetValue(AlwaysOnBottomProperty, value);
    }
    static void OnAlwaysOnBottomChanged(object sender, DependencyPropertyChangedEventArgs e)
    {
        var Window = sender as Window;
        if (Window != null)
        {
            if ((bool)e.NewValue)
            {
                var Sinker = new WindowSinker(Window);
                Sinker.Sink();
                SetSinker(Window, Sinker);
            }
            else
            {
                var Sinker = GetSinker(Window);
                Sinker.Unsink();
                SetSinker(Window, null);
            }
        }
    }

    #endregion
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-07-05T15:52:35.687

根据[HrejWaltz](https://stackoverflow.com/a/15499185/291823)和[James M](https://stackoverflow.com/a/39150799/291823)的回答，我想提供一个修改后的解决方案，`WM_WINDOWPOSCHANGING`通过设置`SWP_NOZORDER`标志而不是`SetWindowPos`每次`WM_SETFOCUS`收到消息时调用来拦截和修改传入的消息。

该类提供附加属性以使用`WindowSinker.AlwaysOnBottom="True"`.

```
using System;
using System.ComponentModel;
using System.Runtime.InteropServices;
using System.Windows;
using System.Windows.Interop;

public class WindowSinker
{
    #region Windows API

    // ReSharper disable InconsistentNaming

    private const int WM_WINDOWPOSCHANGING = 0x0046;

    private const uint SWP_NOSIZE = 0x0001;
    private const uint SWP_NOMOVE = 0x0002;
    private const uint SWP_NOZORDER = 0x0004;
    private const uint SWP_NOACTIVATE = 0x0010;

    [StructLayout(LayoutKind.Sequential)]
    public struct WINDOWPOS
    {
        public IntPtr hwnd;
        public IntPtr hwndInsertAfter;
        public int x;
        public int y;
        public int cx;
        public int cy;
        public uint flags;
    }

    private static readonly IntPtr HWND_BOTTOM = new IntPtr(1);

    // ReSharper restore InconsistentNaming

    #endregion

    #region WindowSinker

    private readonly Window window;
    private bool disposed;

    public WindowSinker(Window window)
    {
        this.window = window;

        if (window.IsLoaded)
        {
            OnWindowLoaded(window, null);
        }
        else
        {
            window.Loaded += OnWindowLoaded;
        }

        window.Closing += OnWindowClosing;
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposed) return;

        window.Loaded -= OnWindowLoaded;
        window.Closing -= OnWindowClosing;

        disposed = true;
    }

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    ~WindowSinker()
    {
        Dispose(false);
    }

    #endregion

    #region Event Handlers

    [DllImport("user32.dll")]
    private static extern bool SetWindowPos(IntPtr hWnd, IntPtr hWndInsertAfter, int x, int y, int cx, int cy,
        uint uFlags);

    private void OnWindowLoaded(object sender, RoutedEventArgs e)
    {
        SetWindowPos(new WindowInteropHelper(window).Handle, HWND_BOTTOM, 0, 0, 0, 0,
            SWP_NOSIZE | SWP_NOMOVE | SWP_NOACTIVATE);

        var source = HwndSource.FromHwnd(new WindowInteropHelper(window).Handle);
        source?.AddHook(WndProc);
    }

    private void OnWindowClosing(object sender, CancelEventArgs e)
    {
        var source = HwndSource.FromHwnd(new WindowInteropHelper(window).Handle);
        source?.RemoveHook(WndProc);
    }

    private IntPtr WndProc(IntPtr hWnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
    {
        if (msg == WM_WINDOWPOSCHANGING)
        {
            var windowPos = Marshal.PtrToStructure<WINDOWPOS>(lParam);
            windowPos.flags |= SWP_NOZORDER;
            Marshal.StructureToPtr(windowPos, lParam, false);
        }

        return IntPtr.Zero;
    }

    #endregion

    #region Attached Properties

    private static readonly DependencyProperty SinkerProperty = DependencyProperty.RegisterAttached(
        "Sinker",
        typeof(WindowSinker),
        typeof(WindowSinker),
        null);

    public static readonly DependencyProperty AlwaysOnBottomProperty = DependencyProperty.RegisterAttached(
        "AlwaysOnBottom",
        typeof(bool),
        typeof(WindowSinker),
        new UIPropertyMetadata(false, OnAlwaysOnBottomChanged));

    public static WindowSinker GetSinker(DependencyObject d)
    {
        return (WindowSinker) d.GetValue(SinkerProperty);
    }

    private static void SetSinker(DependencyObject d, WindowSinker value)
    {
        d.SetValue(SinkerProperty, value);
    }

    public static bool GetAlwaysOnBottom(DependencyObject d)
    {
        return (bool) d.GetValue(AlwaysOnBottomProperty);
    }

    public static void SetAlwaysOnBottom(DependencyObject d, bool value)
    {
        d.SetValue(AlwaysOnBottomProperty, value);
    }

    private static void OnAlwaysOnBottomChanged(object sender, DependencyPropertyChangedEventArgs e)
    {
        if (sender is Window window)
        {
            if ((bool) e.NewValue)
            {
                SetSinker(window, new WindowSinker(window));
            }
            else
            {
                GetSinker(window)?.Dispose();
                SetSinker(window, null);
            }
        }
    }

    #endregion
} 
```

# linux - 依赖于客户端计算机的基于浏览器的应用程序的身份验证

> ID：365095
> 
> 赞同：1
> 
> 时间：2008-12-13T10:49:40.397
> 
> 标签：linux, security, web-applications, apache2, acl

您如何使基于浏览器的应用程序的身份验证依赖于客户端计算机？假设管理员只能**从这**台机器登录。

假设：对网络和所涉及的所有机器（客户端和服务器）有完全的控制。

我正在寻找一个 apache/linux 解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T11:02:57.123

你需要想出一些方法来识别**这**台机器。在您的应用程序中什么是重要的？物理位置？IP地址？

如果您可以完全控制机器，我会将 SSL 与客户端证书一起使用，并将客户端证书仅放在必须使用的机器上。有关如何使用 Apache 进行配置的详细信息，请参见[此处](http://www.garex.net/apache/)

正如那篇文章所说，您可以将 Apache 设置为需要证书、用户名和密码，并将连接限制为特定的 IP 地址。

编辑：您不需要单独的 Web 服务器来使用客户端证书。

根据您的应用程序的工作方式，您可能需要一个单独的 URL。

请注意，该示例仅为某个目录配置证书

```
 <Directory "/www/hidden/docs"> 
```

. 因此，让某些类别的用户以不同的方式登录，或者在登录后将它们重定向到您网站的受客户端证书保护的部分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T01:55:37.927

如果您担心恶意尝试在网络上欺骗客户端工作站，您可以考虑在客户端和服务器上设置 IPSEC，然后您可以简单地使用 IP 地址并将其视为受信任 - 即使用标准 Apache 技术来控制通过IP访问。

或者，如果您认为您的网络受信任，只需给客户端一个静态 IP 并使用标准 apache 技术来限制 IP 访问。

两者都需要在网络级别进行一些管理工作，但好处是您不需要更改应用程序。

# asp.net - 回发和回调之间的区别

> ID：365100
> 
> 赞同：118
> 
> 时间：2008-12-13T11:02:24.347
> 
> 标签：asp.net, javascript, postback, callback

我不断听到“**回调**”和“**回发**”这两个词被折腾。
两者有什么区别？

回发是否非常特定于 ASP.NET 页面？

* * *

## 回答 #1

> 赞同：207
> 
> 时间：2008-12-13T11:06:59.457

当页面上的数据（整个页面）从客户端发布到服务器时，就会发生回发……即**数据被回发到服务器**，因此页面被刷新（重绘）……想想看作为'**向服务器发送充满数据的整个页面（asp.net）** '。

另一方面，**回调也是一种特殊的回发**，但它只是快速往返服务器以获取一小部分数据（通常），因此页面不会刷新，与回发不同...将其视为“**调用服务器并接收*一些*数据**”。

对于 Asp.Net，**ViewState 在调用回调时不会刷新，这**与回发不同。

使用 ASP.Net 发布整个页面的原因是因为 ASP.Net 将整个页面包含在`<form>`一个**post 方法**中，因此当在页面中单击提交按钮时，表单将连同所有表单中的字段......基本上是整个页面本身。

如果您使用的是*FireBug*（用于 Firefox），您实际上可以在`Console`. 这样，您将看到正在发送到服务器的*特定数据*`Request`( ) 以及服务器发回给您的数据 ( `Response`)。

* * *

下图说明了基于 ASP.NET 的网站中回发和回调的页面生命周期：

[![ASP.NET 页面生命周期](https://i.stack.imgur.com/6kWWi.png)](https://i.stack.imgur.com/6kWWi.png)
[（来源：[esri.com](http://edndoc.esri.com/arcobjects/9.2/NET_Server_Doc/developer/ADF/graphics%5Cpage_lifecycle.png)）]

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2008-12-13T18:59:43.023

当从客户端向服务器发送与用户当前正在查看的页面相同的页面的请求时，就会发生回发。当回发发生时，整个页面都会刷新，您可以在浏览器底部的进度条上看到典型的进度。

回调，通常与 AJAX 一起使用，当请求从客户端发送到服务器时，页面没有刷新，只有部分更新，浏览器上没有任何闪烁

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-01-28T01:05:42.897

很多这个讨论是 ASP.NET gobbledygook 语言....

答案是肯定的。Postback 是 Microsoft 的 ASP.NET 特有的“术语” 但是请记住，像 Microsoft 这样的供应商将这些进程的 OWN 版本包装在他们自己的实现中，这让我们都对 Http/Html 世界中真正发生的事情感到困惑。

他们的 POSTBACK 版本基本上是发送回原始服务器的传统 HTTP POST 请求。但在 ASP.NET 中，他们通过在整个网页周围粘贴一个巨大的 FORM HTML 元素标记（带有 POST 方法属性）而不是在网页的一小部分中粘贴传统的表单控件来做到这一点。他们这样做是因为他们使用 HTTP 规范来维护他们的页面及其控件的“状态”，并确保整个页面，甚至是传统的非表单字段标记，都完好无损。

不幸的是，这会通过网络发送大量不必要的数据，以至于他们在页面中的 VIEWSTATE 和它的姊妹 POSTBACK 已被许多人视为浪费带宽和实现网页状态的草率方式。我可以向您展示大多数现代浏览器和网站，如果使用可缓存的 CSS 和一致的 HTML 标记进行设计，将使用浏览器的原生 HTML 缓存非常自然地返回页面状态。即完整的回发通常是不必要的。

CALLBACK 只是 JavaScript。它只是 ECMASCRIPT 马戏团技巧 ASP.NET 将它们称为 AJAX API 的东西存储在浏览器从服务器下载的巨大 JavaScript 库中，并且 ASP.NET 开发人员在不知情的情况下将其打包到他们的网页中以触发网页中的更改而无需完整的 POSTBACK。用于 AJAX 的 ASP.NET API 只是在客户端创建了所有这些庞大的 Javascript，当用户更改某些内容、滚动某些内容或单击浏览器中的某些内容触发传统的 JavaScript 浏览器 DOM 事件时，这些 JavaScript 会在浏览器中触发然后将大量 JSON 或其他数据发送回服务器进行处理。然后，浏览器内存中的 Javascipted 库和对象将返回并接受它，并更改用户网页和标记的部分内容。

它说大约 5-10% 的用户和浏览器禁用了 Javascript，因此所有这些 JSON 和 AJAX 都会为这些人崩溃和烧毁。即 CALLBACK 不起作用。

这就是幕后发生的事情。如果你问我的话，大部分都是矫枉过正的。这就是为什么 ASP.NET 中的 Web 控制模型过去一直受到批评的原因。

如果您暂时放弃了 ASP.NET，您可以自己在 HTML 网页中使用单个文本框和按钮编写一个简单的 FORM 字段，然后按下它并观看它发布到服务器，就像 ASP.NET 页面一样，但是更快更简单。这就是真正的 POSTBACK。浏览器自然会向服务器发送必要的 POST HTTP Header 来执行此操作，但会将 HTML 缓存在页面的其余部分，因此它自己会以闪电般的速度呈现。

对于 CALLBACK，您只需将简单的 Javascript/ECMAScript 代码添加到同一个 HTML 页面，当用户滚动某些文本或按钮、单击或更改表单字段时，网页不会 POST，但在幕后您让Javascript向服务器发送一些东西。如何通过自己的 JavaScript、JSON 或库来处理它是另一回事。但它不是魔法。对于没有禁用 Javascipt 或 Javascript 的人，您应该设计没有 CALLBACK 的页面，并且只缓存单击表单字段控件或超链接时返回的任何更改。尽管现在大多数现代用户代理都是为 ECMAScripted 网站例程设置的，但重新考虑回调例程的原因之一。

这就是让人们感到困惑的地方......这些非常基本的 HTTP 请求和 Javascript 技巧的供应商实现被分层到不清楚的语言中。然后，它会导致人们构建可怕的 Web 应用程序，这些应用程序可以完成所有这些非常简单的编码可以解决的不必要的事情。

我仍然使用并推荐 ASP.NET。它已经走过了漫长的道路和一个伟大的系统。但是，如果更多的人在使用它们之前了解他们所做工作的基础知识，这将有所帮助，因为如果您看到引擎盖下真正发生的事情，这些框架可以进行定制和简化以改进它们。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-14T05:22:14.750

我同意 Dreas 的回答，但我想补充几点。正如 Dreas 所解释的，回发是最近由 ASP .NET 编程引入的一个术语，而回调更通用，并且在 Web 开发存在之前就已经使用过。事实上，我第一次听说回调是在我开始用 C 编程的时候（也许这个术语在此之前就已经存在，我不知道），它只是指一个指向函数的指针和指向一个函数的指针（命名为 A）被传递给另一个函数（命名为 B），该函数稍后将调用 A。回调最近也被[Yahoo UI Connection Manager](http://developer.yahoo.com/yui/connection/#file)和其他 Ajax 框架使用，但我相信该术语在旧 C 时代首次使用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-23T09:43:28.970

当请求被发送到服务器时会发生回发，不需要为每个请求提供有关安全性的详细信息。

当您请求服务器使用其他页面回调时

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-27T02:35:46.833

回发基本上也是往返，当回发当时执行时，它调用称为往返的特殊方法。回发在服务器端，而往返在客户端 sid 上。

# postgresql - 如何分析 PostgreSQL 数据库？

> ID：365103
> 
> 赞同：31
> 
> 时间：2008-12-13T11:04:41.380
> 
> 标签：postgresql, profiling, monitoring

我想分析（密切关注）在 PostgreSQL 中的数据库中进行的所有活动。

有没有这样的实用程序可以帮助我做到这一点？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-12-13T11:52:51.143

在我看来，“密切关注”和“个人资料”是两个完全不同的任务。

对于分析（不是实时查看正在发生的事情，而是查看哪些查询花费最多时间等），请查看 pgFouine：

[http://pgfouine.projects.postgresql.org/](http://pgfouine.projects.postgresql.org/)

这将让您查看哪些查询是资源密集型的，并采取适当的措施：添加缺失的索引、使用其他技术重写查询等。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-13T22:13:36.457

为了“密切注意”，我使用[pgtop](http://ptop.projects.postgresql.org/)，这是一个故意模仿 Unix 'top' 命令的程序。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-06-12T14:35:20.093

[PgBadger](https://pgbadger.darold.net)是一个积极维护的分析工具，它提供了非常详细的报告和图表（[参见示例](https://pgbadger.darold.net/#reports)）。它可以处理大量 PostgreSQL 日志来[回答以下问题](https://pgbadger.darold.net/documentation.html#FEATURE)：

*   最频繁的等待查询。
*   等待时间最长的查询。
*   最慢的查询。

（PgBadger 被明确构建为“替代并超越”pgFouine，它自 2010 年左右以来就没有得到维护。）

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-13T11:11:34.937

好吧，如果您正在查看正在发生的事情，关于选择、更新、删除等，`pg_catalog`架构中有一些视图，我主要使用`pg_stat_user_tables`，`pg_stat_user_indexes`但还有更多，都在`pg_stat*`.

还有一个`pg_stat_activity`视图可以告诉您现在服务器上正在运行什么。

我已经一起破解了四个使用 user_tables 和 user_indexes 的 munin 插件，它们在[那里可用](http://mat.cc/distfiles/munin/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-13T11:41:02.227

查看[Nagios-Plugin 脚本](http://pgfoundry.org/projects/nagiosplugins/)或[check_postgres.pl](http://bucardo.org/nagios/)

# c++ - 为什么 C++ 中需要析构函数？

> ID：365104
> 
> 赞同：11
> 
> 时间：2008-12-13T11:05:46.103
> 
> 标签：c++

当指针超出范围时，它的内存被释放，那么为什么`destructor`在 c++ 中创建 s 呢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-12-13T11:11:15.173

如果你问为什么 C++ 类有析构函数，有些类的要求不仅仅是释放内存。例如，您可能有一个对象分配了一个需要彻底关闭的套接字连接。

此外，“取消作用域”指针不会*释放*它指向的内存，因为其他指针可能正在引用它。

如果堆栈上有指针，退出函数将释放指针使用的内存，但*不会*释放指针指向的内存。有一个微妙但非常重要的区别。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-12-13T11:14:00.143

当指针超出范围时，*指针*占用的内存将被释放。即指针占用的 4 或 8 个字节（通常）的内存。

当指针超出范围时，指针指向的*对象*（或其他内存）*不会被释放。*你可以通过*delete*指针来做到这一点。如果有的话，它会调用析构函数。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-13T12:31:34.900

首先，您错误地声明当指针超出范围时内存被释放。如果原始指针为假，则内存会丢失，指向的对象所持有的任何资源也会随之丢失。

析构函数是语言的核心特性，也是[RAII](http://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)资源管理习语的基础。对象在构造过程中获取资源并在析构函数中释放相同的资源。它是一种简单、可控、简单的资源管理方法。请注意，资源是来自内存的任何东西（智能指针析构函数释放它们控制的内存，容器释放它们的内部内存结构）或任何其他资源（ofstreams 释放打开的文件，数据库连接释放套接字）。

虽然 C# 或 Java 等托管语言的内存由垃圾收集器自动释放，但只有内存被释放，用户不得不在使用位置手动控制所有其他资源。

如果您检查 C#/Java 中的异常控制结构，您会注意到 C++ 中不存在 finally 子句。原因是托管语言必须为用户提供一个保证执行的代码块，以便手动释放资源。释放资源的压力由使用库的程序员承担。

在 C++ 中，使用 RAII 习语，每个对象都对其持有的资源负责，并且必须在销毁期间释放它们。这意味着如果您使用堆栈中的对象，资源将在没有用户交互的情况下被释放。控制资源的责任在类中，用户千万不要记得手动释放每个资源。

许多托管语言被告高兴地说，不必记住何时何地释放内存，因为它会被垃圾收集器声称是一个很大的优势，但他们不会讨论如何控制其他资源。内存管理只是资源管理问题的一个子集，同样的解决方案也适用。如果您将内存保存在智能指针中（std::auto_ptr、boost::shared_ptr、std::tr1::unique_ptr、std::tr1::shared_ptr...，选择适合您使用的那个），那么内存将被管理为你。

虽然这篇文章似乎偏离了最初的析构函数问题，但它确实非常密切相关。所有资源控制必须在析构函数中执行，这就是智能指针的工作方式：当堆栈分配的智能指针超出范围时，析构函数被调用并检查是否必须释放堆（新）分配的内存，如果是，则*删除*叫。但话又说回来，这只是更一般问题的一个子集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T12:05:25.157

当有一个指针（作为类成员存在）时，应该有一个该类的析构函数应该删除指针成员指向的对象。如果您在类中有 smart_pointer 代替指针，则不需要析构函数。

下面的 qn 将帮助您更好地理解。 [下面的代码会导致c ++中的内存泄漏吗](https://stackoverflow.com/questions/147572/will-the-below-code-cause-memory-leak-in-c)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-22T10:19:35.077

如果你正在编写好的 C++，那么你应该只有很少的析构函数（事实上，我认为“很少有析构函数”是衡量 C++ 代码质量的一个很好的指标）。

我能想到的几个例外是：

a) 当您使用不会自毁的东西时，例如。“文件*”。

b）当您使用“pimpl”成语时（谷歌为“pimpl idiom”）。

注意。像 std::auto_ptr 和 std::vector 这样的类将属于 (a) 类，因为在某些时候它们需要一个 C 风格的内存指针。

# delphi - 如何从 Delphi 或 VB6 访问 USB (Pen Drive) 固件编号？

> ID：365107
> 
> 赞同：3
> 
> 时间：2008-12-13T11:07:04.323
> 
> 标签：delphi, usb, usb-drive

我想访问/读取连接在 PC 的 USB 端口上的 Pendrive 的固件编号。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T15:17:18.750

在四处寻找一段时间后，我发现以下链接可能会为您指明正确的方向。

1.  [艾伦·麦克克](http://www.alanmacek.com/usb/)
2.  [USB-IF 开发者专区](http://www.usb.org/developers)

*编辑*：请注意，您可以查阅注册表，该注册表还存储了当前连接的 USB 设备的信息。请参阅[在 XP 上跟踪 USB 设备](http://scissec.scis.ecu.edu.au/conference_proceedings/2007/forensics/23_Luo_Tracing_USB_Device_artefacts_on_Windows_XP.pdf)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T19:21:00.220

这 100% 取决于协议/供应商。可以选择将版本信息添加到标准 USB 设备描述符，但假设每个 USB 笔都使用相同的机制是错误的。

# python - 跨平台键盘记录器

> ID：365110
> 
> 赞同：9
> 
> 时间：2008-12-13T11:10:29.387
> 
> 标签：python, cross-platform, time-management, keylogger

我正在寻找通过 Python 在 Windows、Linux 和 Mac 上观看鼠标和键盘事件的方法。

我的应用程序是一个时间跟踪器。我不是在调查事件，我只是记录事件发生的时间。如果在一定时间内没有事件，比如 10 分钟，我假设用户已经离开并停止当前项目。

当用户返回时（事件再次出现），我稍等片刻（所以这不会被清洁人员或您的宠物或地震触发）。如果事件持续较长时间，我假设用户已经返回，我会弹出一个小的非活动窗口，她可以在其中选择将时间间隔添加到“中断”、当前项目（会议等）或一个不同的项目。

我已经使用[pyHook](http://sourceforge.net/projects/pyhook/)解决了 Windows 的键盘记录器。

在 Linux 上，我找到了一个解决方案，但我不喜欢它：我可以查看 /etc/input 中的所有设备节点，并在每次看到事件时更新 /var 或 /tmp 中某处的时间戳。有两个缺点：1.我无法判断事件是否来自运行时间跟踪器的用户和2.这个小程序需要以root身份运行（不好）。

在 Mac 上，我还不知道。

问题：

1.  有没有比在 Linux 上观看事件设备更好的方法来了解用户是否正在创建事件？

2.  任何指针如何在Mac上做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-13T13:46:12.427

有几个开源应用程序可能会给你一些指导：

*   [PyKeylogger](http://sourceforge.net/p/pykeylogger/wiki/Main_Page/)是适用于 windows 和 linux 的 python 键盘记录器
*   [logKext](http://code.google.com/p/logkext/)是一个用于 mac 的 c++ 键盘记录器

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-01-15T19:16:24.713

**关于编写 Linux 内核键盘记录器** 有一篇很棒的文章
[http://www.phrack.com/issues.html?issue=59&id=14#article](http://www.phrack.com/issues.html?issue=59&id=14#article)

如果您正在尝试运行蜜罐，那么一定要试试 Sebek：
[https ://projects.honeynet.org/sebek/](https://projects.honeynet.org/sebek/)

> Sebek 是一种数据捕获工具，旨在捕获攻击者在蜜罐上的活动，而攻击者（希望）不知道它。它有两个组成部分。第一个是在蜜罐上运行的客户端，其目的是捕获所有攻击者的活动（击键、文件上传、密码），然后秘密地将数据发送到服务器。第二个组件是从蜜罐收集数据的服务器。服务器通常运行在 Honeywall 网关上，但也可以独立运行。有关 Sebek 的更多信息，请参阅 [http://www.honeynet.org/tools/sebek](http://www.honeynet.org/tools/sebek)

但是，如果您宁愿遵循脚本小子路线/不学习，请尝试以下应用程序：

LINUX
[http://sourceforge.net/projects/lkl/](http://sourceforge.net/projects/lkl/)

WINDOWS
[http://www.rohos.com/kid-logger/](http://www.rohos.com/kid-logger/)
[http://code.google.com/p/freelogger/](http://code.google.com/p/freelogger/)

* * *

ADVICE: You're better off writing your own for learning-and-profit purposes.

# vba - 如何使用 VBA 设置 Excel 单元格的背景颜色？

> ID：365125
> 
> 赞同：27
> 
> 时间：2008-12-13T11:39:08.830
> 
> 标签：vba, excel

作为 VBA 程序的一部分，我必须根据它们的值将某些单元格的背景颜色设置为绿色、黄色或红色（基本上是一个健康监视器，其中绿色是可以的，黄色是边界线，红色是危险的）。

我知道如何设置这些单元格的值，但是如何设置背景颜色。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-12-13T11:43:01.240

您可以使用：

```
ActiveCell.Interior.ColorIndex = 28 
```

或者

```
ActiveCell.Interior.Color = RGB(255,0,0) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-04-18T02:34:41.617

这是您应该在哪里使用宏记录器的完美示例。打开记录器并通过 UI 设置单元格的颜色。停止记录器并查看宏。它会生成一堆无关的代码，但它也会向您展示适用于您想要完成的内容的语法。去掉你不需要的东西并修改（如果你需要的话）剩下的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-04T15:07:19.503

执行快速“记录宏”以查看与您要查找的颜色相关的颜色编号（黄色突出显示为 65535）。然后擦除代码并放入

```
Sub Name()
Selection.Interior.Color = 65535 '(your number may be different depending on the above)
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-30T12:34:43.270

或者，您也不必为它编写代码，而是使用 Excel 中的“条件格式”功能，该功能将根据单元格值设置背景颜色和字体颜色。

这里只有两个变量，因此将默认值设置为黄色，然后在值大于或小于阈值时覆盖。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2015-03-22T18:08:56.267

如果您使用 Function 则不起作用，但如果您使用 Sub. 但是，您不能使用公式从单元格中调用子项。

# delphi - 调试 Windows CGI 的最佳方法

> ID：365129
> 
> 赞同：2
> 
> 时间：2008-12-13T11:40:14.350
> 
> 标签：delphi, debugging, cgi, isapi

我使用需要调试的 CGIExpert 使用 Delphi 2007 创建了一个 Windows CGI。

在将参数传递给它的同时，是否有任何简单的方法可以从 IDE 中运行它？我尝试将主机应用程序设置为 iexplore.exe（运行|参数）并在参数字段中输入一些文本，但它似乎无法在运行时传递任何参数。

任何人都知道一种方法，以便我可以使用 Delphi IDE 中的一些参数运行 cgi？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T14:04:49.797

我用来调试基于 ISAPI 的应用程序的东西是[idDebugger](http://users.telenet.be/ws36637/)。虽然我没有专门用 CGI 应用程序尝试过它，但它可能值得一看。作者特别提到了它协助 CGI 应用程序的事实。这个解决方案的好处在于，它使调试 ISAPI（我怀疑是 CGI 应用程序）就像调试基于 Windows 窗体的应用程序一样容易……只需设置几个断点并进行调试。

要使用它，只需将工作目录设置为 CGI/ISAPI 可执行文件所在的目录，并将主机应用程序设置为 idDebugger.exe 文件。然后将参数设置为 URL 行（减去[http://localhost/](http://localhost/)）和所有设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T17:41:54.303

如果您有较新版本的 Delphi，它会附带一个内置的 WebApp 调试器，仅用于此目的。如果您有旧版本的 Delphi，请尝试 CGIExpert，这是在 Delphi 中使用 CGI 的最佳方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T11:46:17.927

这没有回答您的问题，但可能会有所帮助：

[http://www.htmlhelp.org/tools/cg-eye/live.html](http://www.htmlhelp.org/tools/cg-eye/live.html)

您传递 CGI 的 URL，它会向它发送值以检测问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T14:05:58.533

为此，您需要一个网络服务器。一旦你将它加载到网络服务器中，你就可以将 Delphi 调试器附加到它上面。不完全是 F9 和调试，但它可以工作。

如果你已经使用 Delphi 的 web-broker 构建了 CGI，你也可以选择制作一个 Webapp Debugger，它只使用一个小型 web 服务器进行调试。如果您对应用程序建模正确，您可以在实际生产 CGI 和 webapp 调试器版本中使用相同的代码，以获得两全其美的效果。见[https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-1050539.html](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-1050539.html)

# websphere - 如何在不运行服务器的情况下在 websphere 中创建客户端 jar？

> ID：365146
> 
> 赞同：1
> 
> 时间：2008-12-13T12:04:29.073
> 
> 标签：websphere

我对我的研发有一个要求，这似乎很棘手。

我想为 EJB 应用程序创建一个客户端 jar。

考虑一下我有一个`EJB`应用程序和它的罐子。我只需要为该`EJB`应用程序创建一个客户端 jar。

要创建它，我需要服务器正在运行。但我的要求是，我必须在不启动服务器的情况下创建 jar。

我尝试了一些东西，但 adminclient 创建尝试`SOAP`在指定地址创建连接器端口，这对我来说失败了。

**PS：**我正在Windows平台上尝试这个expt。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-24T13:02:27.723

使用 astk ( [http://www-01.ibm.com/support/docview.wss?rs=180&uid=swg24007418](http://www-01.ibm.com/support/docview.wss?rs=180&uid=swg24007418) )

> 导入ear->右键单击jar->生成客户端jar。

# c++ - 在 C++ 中解析 YAML 文件

> ID：365155
> 
> 赞同：42
> 
> 时间：2008-12-13T12:23:07.820
> 
> 标签：c++, yaml

我想要一个简单的教程来告诉我加载一个 yaml 文件并解析数据。Expat 风格会很棒，但任何能够以某种形式实际向我展示数据的解决方案都会很有用。

到目前为止，我在 yaml-0.1.1 源代码中为 C 运行了多个测试，我要么得到一个错误，要么没有输出，要么在 run-emitter.c 的情况下。它读入 yaml 文件并将其打印到 STDOUT，它不会通过 libyaml 函数/结构生成文本。在出现错误的情况下，我不知道是文件错误还是我的构建不正确（我没有修改任何内容......）文件是从 yaml.org 复制的

谁能指点我一个教程？（我用谷歌搜索了至少 30 分钟，阅读了任何看起来相关的内容）或具有良好教程或示例的库的名称。也许您可以告诉我文件中加载了哪些 libyaml 测试并对其进行了处理，或者我为什么会出错。本文档不解释如何使用该文件，只解释如何加载它。

[http://pyyaml.org/wiki/LibYAML#Documentation](http://pyyaml.org/wiki/LibYAML#Documentation)

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-05-08T06:02:10.683

为 C++ 解析器尝试[yaml-cpp](https://github.com/jbeder/yaml-cpp)（如[这个问题](https://stackoverflow.com/questions/244784/yaml-serialization-library-for-c)所建议的）。

披露：我是作者。

示例语法（来自[教程](https://github.com/jbeder/yaml-cpp/wiki/Tutorial)）：

```
YAML::Node config = YAML::LoadFile("config.yaml");

if (config["lastLogin"]) {
  std::cout << "Last logged in: " << config["lastLogin"].as<DateTime>() << "\n";
}

const std::string username = config["username"].as<std::string>();
const std::string password = config["password"].as<std::string>();
login(username, password);
config["lastLogin"] = getCurrentDateTime();

std::ofstream fout("config.yaml");
fout << config; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-07T06:57:41.300

C 示例 - 将 YAML 树解析为[glib “N-ary 树”](http://developer.gimp.org/api/2.0/glib/glib-N-ary-Trees.html)：

```
#include <yaml.h>
#include <stdio.h>
#include <glib.h>

void process_layer(yaml_parser_t *parser, GNode *data);
gboolean dump(GNode *n, gpointer data);

int main (int argc, char **argv) {
    char *file_path = "test.yaml";
    GNode *cfg = g_node_new(file_path);
    yaml_parser_t parser;

    FILE *source = fopen(file_path, "rb");
    yaml_parser_initialize(&parser);
    yaml_parser_set_input_file(&parser, source);
    process_layer(&parser, cfg); // Recursive parsing
    yaml_parser_delete(&parser);
    fclose(source);

    printf("Results iteration:\n");
    g_node_traverse(cfg, G_PRE_ORDER, G_TRAVERSE_ALL, -1, dump, NULL);
    g_node_destroy(cfg);

    return(0);
}

enum storage_flags { VAR, VAL, SEQ }; // "Store as" switch

void process_layer(yaml_parser_t *parser, GNode *data) {
    GNode *last_leaf = data;
    yaml_event_t event;
    int storage = VAR; // mapping cannot start with VAL definition w/o VAR key

    while (1) {
        yaml_parser_parse(parser, &event);

        // Parse value either as a new leaf in the mapping
        //  or as a leaf value (one of them, in case it's a sequence)
        if (event.type == YAML_SCALAR_EVENT) {
            if (storage) g_node_append_data(last_leaf, g_strdup((gchar*) event.data.scalar.value));
            else last_leaf = g_node_append(data, g_node_new(g_strdup((gchar*) event.data.scalar.value)));
            storage ^= VAL; // Flip VAR/VAL switch for the next event
        }

        // Sequence - all the following scalars will be appended to the last_leaf
        else if (event.type == YAML_SEQUENCE_START_EVENT) storage = SEQ;
        else if (event.type == YAML_SEQUENCE_END_EVENT) storage = VAR;

        // depth += 1
        else if (event.type == YAML_MAPPING_START_EVENT) {
            process_layer(parser, last_leaf);
            storage ^= VAL; // Flip VAR/VAL, w/o touching SEQ
        }

        // depth -= 1
        else if (
            event.type == YAML_MAPPING_END_EVENT
            || event.type == YAML_STREAM_END_EVENT
        ) break;

        yaml_event_delete(&event);
    }
}

gboolean dump(GNode *node, gpointer data) {
    int i = g_node_depth(node);
    while (--i) printf(" ");
    printf("%s\n", (char*) node->data);
    return(FALSE);
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2011-01-12T20:53:45.403

我在 [http://wpsoftware.net/andrew/pages/libyaml.html](http://wpsoftware.net/andrew/pages/libyaml.html)写了一个教程。

这涵盖了在 C 中使用 libyaml 的基础知识，使用基于令牌和基于事件的解析。它包括用于输出 YAML 文件内容的示例代码。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-13T13:50:18.767

“yaml load lang:c++”的谷歌代码搜索（现已失效）将此作为第一个链接：[demo.cc](https://github.com/wilhelmtell/libyamlpp/blob/master/demo/begin/demo.cc)：

```
#include <iyaml++.hh>
#include <tr1/memory>
#include <iostream>
#include <stdexcept>

using namespace std;

// What should libyaml++ do when a YAML entity is parsed?
// NOTE:  if any of the event handlers is not defined, a respective default
// no-op handler will be used.  For example, not defining on_eos() is
// equivalent to defining void on_eos() { }.
class my_handler : public yaml::event_handler {
    void on_string(const std::string& s) { cout << "parsed string:  " << s << endl; }
    void on_integer(const std::string& s) { cout << "parsed integer:  " << s << endl; }
    void on_sequence_begin() { cout << "parsed sequence-begin." << endl; }
    void on_mapping_begin() { cout << "parsed mapping-begin." << endl; }
    void on_sequence_end() { cout << "parsed sequence-end." << endl; }
    void on_mapping_end() { cout << "parsed mapping-end." << endl; }
    void on_document() { cout << "parsed document." << endl; }
    void on_pair() { cout << "parsed pair." << endl; }
    void on_eos() { cout << "parsed eos." << endl; }
};

// ok then, now that i know how to behave on each YAML entity encountered, just
// give me a stream to parse!
int main(int argc, char* argv[])
{
    tr1::shared_ptr<my_handler> handler(new my_handler());
    while( cin ) {
        try { yaml::load(cin, handler); } // throws on syntax error

        catch( const runtime_error& e ) {
            cerr << e.what() << endl;
        }
    }
    return 0;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-10-13T08:29:11.703

作为替代品`yaml-cpp`，`libyaml`还有[rapidyaml](https://github.com/biojppm/rapidyaml)。这是一个例子。

```
#include <fstream>
#include <iostream>
#include <sstream>
#include <string>

#include <ryml_std.hpp>
#include <ryml.hpp>

std::string get_file_contents(const char *filename)
{
    std::ifstream in(filename, std::ios::in | std::ios::binary);
    if (!in) {
        std::cerr << "could not open " << filename << std::endl;
        exit(1);
    }
    std::ostringstream contents;
    contents << in.rdbuf();
    return contents.str();
}

int main(int argc, char const *argv[]) 
{
    std::string contents = get_file_contents("config.yml");
    ryml::Tree tree = ryml::parse(ryml::to_csubstr(contents));
    ryml::NodeRef foo = tree["foo"];
    for (ryml::NodeRef const& child : foo.children()) {
        std::cout << "key: " << child.key() << " val: " << child.val() << std::endl;
    }
    return 0;
} 
```

**配置.yaml**

```
foo:
  bar: a
  barbar: b
  barbarbar: c 
```

# security - 我们如何保护在线弱势群体？

> ID：365158
> 
> 赞同：0
> 
> 时间：2008-12-13T12:29:51.643
> 
> 标签：security

最近，我工作的公司被要求为创建一个针对儿童的论坛作为网站解决方案的一部分进行宣传。

我认为至少我们应该推荐

*   由受过训练的人进行人为节制以保护这些孩子
*   代码报警/可疑分析进论坛

其他人是如何解决这个问题的，其他人对此有什么想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T13:03:26.303

这不是一个在线论坛，但他们确实讨论了一些他们必须处理的事情，以便为儿童提供一个安全的环境。查看开发迪士尼卡通城的游戏团队的验尸报告：[http ://www.gamasutra.com/view/feature/2027/postmortem_disney_onlines_.php](http://www.gamasutra.com/view/feature/2027/postmortem_disney_onlines_.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T13:15:38.043

将“在线”视为“一个拥挤的地方，其中包含陌生人”。有些解决方案是相同的，有些则不起作用。

例如，在商场的托儿所，您可以要求父母为孩子办理入住手续，并由同一位父母办理退房手续。这种想法有时会导致意识到部分安全必须掌握在父母手中：您不能将孩子“限制”在在线系统中，因此保护他们免于上网的其他地方必须是他们的父母工作。

但是每个孩子都有一个负责任的成年人的想法可能是一个非常好的想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T03:40:56.967

现场版主可能是您最好的选择。迪士尼的卡通城实际上遇到了很多隐私/安全问题，因为他们错过了孩子们通常相当聪明。

虽然我不知道它是否还在那里，但曾经有一个功能，你有一个“公寓”，你可以用 SIMS 风格的“家具”填充，然后展示给其他玩家。

因此，想要颠覆受控通信的玩家会一次拼出一个字母，直到一个不受控制的聊天的屏幕名称被传达出来。据称，即使在发现之后，仍然有一个显示图片的系统同样有效。

总而言之，您无法涵盖所有​​基础。您能做的最好的事情就是掩盖粗心和无能，并尝试对可能表明某些事情的奇怪行为保持警惕。所以如果你必须做一个“儿童论坛”，我肯定会和版主一起去。

# mysql - MySql-在添加了字符串的重复键插入

> ID：365163
> 
> 赞同：2
> 
> 时间：2008-12-13T12:35:44.737
> 
> 标签：mysql

如何从一个表插入到另一个表并在重复键上将字符串附加到新行？

如果我得到带有值的表：
a
b
c

并希望插入 tablevith 值：
a

我想追加像'x'这样的字符串，所以我会得到带有值的表：
a
b
c
xa

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T20:43:59.973

```
INSERT INTO aatest
SELECT IF(COUNT(a2.letter)=0,'a','xa')
FROM aatest a1
LEFT JOIN aatest a2 ON a1.letter = a2.letter OR a2.letter IS NULL
WHERE a2.letter = 'a' 
```

真的会按照你的要求去做......但这不是一个合适的解决方案，除非你有一个非常独特的问题要解决。如果 'a' 再次出现在列表中，它将失败，因为 'xa' 也已经在那里了。假设您在 PHP 或其他东西中执行此操作，那么执行两个查询解决方案会容易得多。

希望这会有所帮助...如果您提供更多详细信息，我可能会更有帮助。

# java - 更快地插入 Oracle 哈希集群表

> ID：365168
> 
> 赞同：1
> 
> 时间：2008-12-13T12:41:38.283
> 
> 标签：java, oracle, insert, hashtable, cluster-computing

由于我开始了将 7M 行从一个表插入另外两个表的过程，我现在想知道是否有更快的方法来执行此操作。该过程预计将在一个小时内完成，即 24 小时的处理时间。

事情是这样的：

此表中的数据

```
RAW (word VARCHAR2(4000), doc VARCHAR2(4000), count NUMBER); 
```

应该在另外两个集群表 T1 和 T2 中找到新家

```
CREATE CLUSTER C1 (word VARCHAR2(4000)) SIZE 200 HASHKEYS 10000000;
CREATE CLUSTER C2 (doc VARCHAR2(4000)) SIZE 200 HASHKEYS 10000000;

T1 (word VARCHAR2(4000), doc VARCHAR2(4000), count NUMBER) CLUSTER C1(word);
T2 (doc VARCHAR2(4000), word VARCHAR2(4000), count NUMBER) CLUSTER C2(doc); 
```

通过像这样手动提交的Java插入

```
stmtT1 = conn.prepareStatement("insert into T1 values(?,?,?)");
stmtT2 = conn.prepareStatement("insert into T2 values(?,?,?)");

rs = stmt.executeQuery("select word, doc, count from RAW");

conn.setAutoCommit(false);

while (rs.next()) {
    word = rs.getString(1);
    doc = rs.getString(2);
    count = rs.getInt(3);

    if (commitCount++==10000) { conn.commit(); commitCount=0; }

    stmtT1.setString(1, word);
    stmtT1.setString(2, doc);
    stmtT1.setInt(3, count);

    stmtT2.setString(1, doc);
    stmtT2.setString(2, word);
    stmtT2.setInt(3,count);

    stmtT1.execute();
    stmtT2.execute();
}

conn.commit(); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T13:46:22.240

我推荐的第一件事是做一个简单的插入-选择语句，让数据库处理所有的数据移动。如果您在两台机器之间移动数据，或者如果您没有足够大的回滚段来处理整个查询，那么它就不那么有用了。

我的第二件事是了解[addBatch()](http://file:///usr/local/java/jdk-1.5/docs/api/java/sql/PreparedStatement.html#addBatch())方法。当您编写代码时，它会为您插入的每一行往返于数据库，这会增加网络开销。

第三，除非您在目标表中已经有很多行，否则在插入之前删除任何索引，然后重新创建。如果您保留索引，则必须为每一行更新它们，从而增加脏块开销。

最后：您需要聚簇表吗？我的经验是他们不会给你买很多东西（警告：这种体验是在单个表空间上的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T14:07:14.987

好吧，您不能在 Oracle 中调用表 RAW ——它是一个保留字，因此会引发 ORA-00903 错误。

除此之外，您将使用：

```
insert all
into t1
into t2
select * from RAW
/ 
```

“逐行等于慢慢来” :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T23:02:51.800

除非您有特殊原因要在应用程序中处理数据，否则我会选择直接 INSERT AS SELECT。使用 Parallel DML 可以给您带来巨大的不同。

如果符合您的需要，还要检查 INSERT ALL 语法（1 次读取 2 次写入）。

除非你有 IO 问题，否则 1h 应该绰绰有余...

问候

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-05T17:47:06.463

在概念上类似于 addBatch，您可以编写一个 PL/SQL 过程，它接受（word、doc、count）的数组并在服务器端处理插入。它在概念上是相似的，因为您通过一次发送多个记录来减少网络旅行，并且您可以获得更快的性能。另一方面，它更加复杂和脆弱，因为它需要在服务器端编写 PL/SQL，并且在客户端需要额外的数组逻辑。Oracle TechNet 有几个这样的例子。

//尼古拉斯

# asp.net - 我可以在 MasterPage 中使用 UpdatePanel 来包装嵌套页面吗？

> ID：365183
> 
> 赞同：7
> 
> 时间：2008-12-13T12:57:12.963
> 
> 标签：asp.net, asp.net-ajax, ajax.net

我是否可以在 masterpage 中使用更新面板来包装嵌套页面，以便从一个页面浏览到另一个客户端时仅获得部分刷新（MasterPage 不会重新加载）。

如果是这样 - 如何？我只是`ContentPlaceholder`在母版页中放置一个更新面板吗？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-13T13:02:18.990

**我不建议您将整个页面包装在 中`UpdatePanel`**，原因如下：

*   如果您希望您的网站被搜索引擎索引，您将需要**在单独的页面上显示您的内容**……只需在每个内容部分使用不同的查询字符串就足够了。这是因为对于搜索引擎而言，**内容为王**，而且由于搜索引擎目前无法索引动态生成的数据，他们将无法索引您的页面。

*   **将整个页面包装在一个`Update Panel`中是非常危险**的，因为**发送到服务器的开销很大**。如果这样做，您将看到性能显着下降。阅读[本文](http://encosia.com/2007/07/11/why-aspnet-ajax-updatepanels-are-dangerous/)以获取有关该主题的更多信息

*   由于这个巨大的开销，建议使用`Update Panel`更新**网站的一小部分**（如侧面的小框小部件等......）而不是整个内容部分。

*   在更新面板中包装内容部分意味着您必须自己手动动态更改 url（使用 # 锚点），这样您就可以让用户能够使用浏览器上的后退按钮去到网站的上一部分。 **无法返回页面对用户来说非常烦人**

* * *

这是一个演示`UpdatePanel`s 问题的示例。

以下是带有标签和按钮的简单 aspx 页面的代码：

```
<asp:ScriptManager ID="ScriptManager1" runat="server" />
<asp:UpdatePanel runat="server" ID="up1">
 <ContentTemplate>
   <asp:Label runat="server" ID="Label1" Text="Update Me!" /><br />
   <asp:Button runat="server" ID="Button1" 
     Text="Postback Update" OnClick="Button1_Click" />
 </ContentTemplate>
</asp:UpdatePanel> 
```

```
protected void Button1_Click(object sender, EventArgs e)
{
  Label1.Text = DateTime.Now.ToLongDateString();
} 
```

以下是`UpdatePanel`单击按钮时完成的部分回发（注意所涉及的巨大开销）：（[来源：][[encosia.com](http://encosia.com/blog/media/images/updatepanel-payload-response-sm.png)][）]

                  [![替代文字](https://i.stack.imgur.com/iN8sX.png)](https://i.stack.imgur.com/iN8sX.png)

如您所见，服务器基本上是将所有在`UpdatePanel`后面的元素发送给客户端。

* * *

另一方面，这是一个涉及使用[ASP.Net 页面方法](http://encosia.com/2008/05/29/using-jquery-to-directly-call-aspnet-ajax-page-methods/)的示例。注意这次从服务器发送的响应（*不涉及更新面板*）：

                    [![替代文字](https://i.stack.imgur.com/0ZySl.png)](https://i.stack.imgur.com/0ZySl.png)
[（来源：[encosia.com](http://encosia.com/blog/media/images/json-payload-response.png)）]

# php - 如何在PHP中以分钟为单位获取时差

> ID：365191
> 
> 赞同：316
> 
> 时间：2008-12-13T13:05:25.160
> 
> 标签：php, date, time, minute

如何计算 PHP 中两个日期时间之间的微小差异？

* * *

## 回答 #1

> 赞同：457
> 
> 时间：2012-09-12T07:11:30.617

上面的答案适用于旧版本的 PHP。由于 PHP 5.3 已成为标准，请使用 DateTime 类进行任何日期计算。例如。

```
$start_date = new DateTime('2007-09-01 04:10:58');
$since_start = $start_date->diff(new DateTime('2012-09-11 10:25:00'));
echo $since_start->days.' days total<br>';
echo $since_start->y.' years<br>';
echo $since_start->m.' months<br>';
echo $since_start->d.' days<br>';
echo $since_start->h.' hours<br>';
echo $since_start->i.' minutes<br>';
echo $since_start->s.' seconds<br>'; 
```

$since_start 是一个[DateInterval](http://www.php.net/manual/en/class.dateinterval.php)对象。请注意，days 属性是可用的（因为我们使用了 DateTime 类的 diff 方法来生成 DateInterval 对象）。

上面的代码将输出：

总共 1837 天
5 年
0 个月
10 天
6 小时
14 分
2 秒

要获得总分钟数：

```
$minutes = $since_start->days * 24 * 60;
$minutes += $since_start->h * 60;
$minutes += $since_start->i;
echo $minutes.' minutes'; 
```

这将输出：

2645654 分钟

这是两个日期之间经过的实际分钟数。DateTime 类将考虑夏令时（取决于时区），而“旧方式”则不会。阅读有关日期和时间的手册[http://www.php.net/manual/en/book.datetime.php](http://www.php.net/manual/en/book.datetime.php)

* * *

## 回答 #2

> 赞同：361
> 
> 时间：2008-12-13T13:36:18.047

这是答案：

```
$to_time = strtotime("2008-12-13 10:42:00");
$from_time = strtotime("2008-12-13 10:21:00");
echo round(abs($to_time - $from_time) / 60,2). " minute"; 
```

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2008-12-13T13:23:44.860

未来最值一减去过去最值一除以60。

时间是以 Unix 格式完成的，所以它们只是一个很大的数字，显示从`January 1, 1970, 00:00:00 GMT`

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-12-13T15:49:50.603

```
<?php
$date1 = time();
sleep(2000);
$date2 = time();
$mins = ($date2 - $date1) / 60;
echo $mins;
?> 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2019-09-12T14:10:59.890

```
<?php
$start = strtotime('12:01:00');
$end = strtotime('13:16:00');
$mins = ($end - $start) / 60;
echo $mins;
?> 
```

**输出：**

```
75 
```

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2015-07-09T15:43:16.703

它适用于我的程序，我正在使用`date_diff`，你可以在[这里](http://php.net/manual/en/function.date-diff.php)`date_diff`查看手册。

```
$start = date_create('2015-01-26 12:01:00');
$end = date_create('2015-01-26 13:15:00');
$diff=date_diff($end,$start);
print_r($diff); 
```

你得到你想要的结果。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2013-12-24T13:16:00.723

时区的另一种方式。

```
$start_date = new DateTime("2013-12-24 06:00:00",new DateTimeZone('Pacific/Nauru'));
$end_date = new DateTime("2013-12-24 06:45:00", new DateTimeZone('Pacific/Nauru'));
$interval = $start_date->diff($end_date);
$hours   = $interval->format('%h'); 
$minutes = $interval->format('%i');
echo  'Diff. in minutes is: '.($hours * 60 + $minutes); 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2014-06-07T19:21:49.783

我为我的一个博客站点编写了这个函数（过去日期和服务器日期之间的差异）。它会给你这样的输出

“49 秒前”、“20 分钟前”、“21 小时前”等

我使用了一个函数，可以让我知道过去的日期和服务器的日期之间的差异。

```
<?php

//Code written by purpledesign.in Jan 2014
function dateDiff($date)
{
    $mydate= date("Y-m-d H:i:s");
    $theDiff="";
    //echo $mydate;//2014-06-06 21:35:55
    $datetime1 = date_create($date);
    $datetime2 = date_create($mydate);
    $interval = date_diff($datetime1, $datetime2);
    //echo $interval->format('%s Seconds %i Minutes %h Hours %d days %m Months %y Year    Ago')."<br>";
    $min=$interval->format('%i');
    $sec=$interval->format('%s');
    $hour=$interval->format('%h');
    $mon=$interval->format('%m');
    $day=$interval->format('%d');
    $year=$interval->format('%y');
    if($interval->format('%i%h%d%m%y')=="00000") {
        //echo $interval->format('%i%h%d%m%y')."<br>";
        return $sec." Seconds";
    } else if($interval->format('%h%d%m%y')=="0000"){
        return $min." Minutes";
    } else if($interval->format('%d%m%y')=="000"){
        return $hour." Hours";
    } else if($interval->format('%m%y')=="00"){
        return $day." Days";
    } else if($interval->format('%y')=="0"){
        return $mon." Months";
    } else{
        return $year." Years";
    }    
}
?> 
```

将其保存为文件假设“date.php”。像这样从另一个页面调用函数

```
<?php
 require('date.php');
 $mydate='2014-11-14 21:35:55';
 echo "The Difference between the server's date and $mydate is:<br> ";
 echo dateDiff($mydate);
?> 
```

当然你可以修改函数来传递两个值。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2014-10-31T05:26:06.537

我想这会对你有所帮助

```
function calculate_time_span($date){
    $seconds  = strtotime(date('Y-m-d H:i:s')) - strtotime($date);

        $months = floor($seconds / (3600*24*30));
        $day = floor($seconds / (3600*24));
        $hours = floor($seconds / 3600);
        $mins = floor(($seconds - ($hours*3600)) / 60);
        $secs = floor($seconds % 60);

        if($seconds < 60)
            $time = $secs." seconds ago";
        else if($seconds < 60*60 )
            $time = $mins." min ago";
        else if($seconds < 24*60*60)
            $time = $hours." hours ago";
        else if($seconds < 24*60*60)
            $time = $day." day ago";
        else
            $time = $months." month ago";

        return $time;
} 
```

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2014-03-27T04:11:59.107

这就是我在 php > 5.2 中显示“xx 次前”的方式 .. 这是有关[DateTime](http://www.paulund.co.uk/datetime-php)对象的更多信息

```
//Usage:
$pubDate = $row['rssfeed']['pubDates']; // e.g. this could be like 'Sun, 10 Nov 2013 14:26:00 GMT'
$diff = ago($pubDate);    // output: 23 hrs ago

// Return the value of time different in "xx times ago" format
function ago($timestamp)
{

    $today = new DateTime(date('y-m-d h:i:s')); // [2]
    //$thatDay = new DateTime('Sun, 10 Nov 2013 14:26:00 GMT');
    $thatDay = new DateTime($timestamp);
    $dt = $today->diff($thatDay);

    if ($dt->y > 0){
        $number = $dt->y;
        $unit = "year";
    } else if ($dt->m > 0) {
        $number = $dt->m;
        $unit = "month";
    } else if ($dt->d > 0) {
        $number = $dt->d;
        $unit = "day";
    } else if ($dt->h > 0) {
        $number = $dt->h;
        $unit = "hour";
    } else if ($dt->i > 0) {
        $number = $dt->i;
        $unit = "minute";
    } else if ($dt->s > 0) {
        $number = $dt->s;
        $unit = "second";
    }

    $unit .= $number  > 1 ? "s" : "";

    $ret = $number." ".$unit." "."ago";
    return $ret;
} 
```

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2015-01-28T07:05:47.913

```
function date_getFullTimeDifference( $start, $end )
{
$uts['start']      =    strtotime( $start );
        $uts['end']        =    strtotime( $end );
        if( $uts['start']!==-1 && $uts['end']!==-1 )
        {
            if( $uts['end'] >= $uts['start'] )
            {
                $diff    =    $uts['end'] - $uts['start'];
                if( $years=intval((floor($diff/31104000))) )
                    $diff = $diff % 31104000;
                if( $months=intval((floor($diff/2592000))) )
                    $diff = $diff % 2592000;
                if( $days=intval((floor($diff/86400))) )
                    $diff = $diff % 86400;
                if( $hours=intval((floor($diff/3600))) )
                    $diff = $diff % 3600;
                if( $minutes=intval((floor($diff/60))) )
                    $diff = $diff % 60;
                $diff    =    intval( $diff );
                return( array('years'=>$years,'months'=>$months,'days'=>$days, 'hours'=>$hours, 'minutes'=>$minutes, 'seconds'=>$diff) );
            }
            else
            {
                echo "Ending date/time is earlier than the start date/time";
            }
        }
        else
        {
            echo "Invalid date/time data detected";
        }
} 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2017-06-01T22:19:02.580

一个更通用的版本，以天、小时、分钟或秒返回结果，包括分数/小数：

```
function DateDiffInterval($sDate1, $sDate2, $sUnit='H') {
//subtract $sDate2-$sDate1 and return the difference in $sUnit (Days,Hours,Minutes,Seconds)
    $nInterval = strtotime($sDate2) - strtotime($sDate1);
    if ($sUnit=='D') { // days
        $nInterval = $nInterval/60/60/24;
    } else if ($sUnit=='H') { // hours
        $nInterval = $nInterval/60/60;
    } else if ($sUnit=='M') { // minutes
        $nInterval = $nInterval/60;
    } else if ($sUnit=='S') { // seconds
    }
    return $nInterval;
} //DateDiffInterval 
```

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2021-05-25T15:26:37.730

`DateTime::diff`很酷，但对于这种需要单个单位结果的计算来说很尴尬。手动减去时间戳效果更好：

```
$date1 = new DateTime('2020-09-01 01:00:00');
$date2 = new DateTime('2021-09-01 14:00:00');
$diff_mins = abs($date1->getTimestamp() - $date2->getTimestamp()) / 60; 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2019-10-30T14:54:19.320

减去时间并除以 60。

这是一个`2019/02/01 10:23:45`以分钟为单位计算经过时间的示例：

```
$diff_time=(strtotime(date("Y/m/d H:i:s"))-strtotime("2019/02/01 10:23:45"))/60; 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2019-03-24T02:52:02.533

我找到两个日期之间差异的解决方案在这里。使用此功能，您可以找到秒、分钟、小时、天、年和月等差异。

```
function alihan_diff_dates($date = null, $diff = "minutes") {
 $start_date = new DateTime($date);
 $since_start = $start_date->diff(new DateTime( date('Y-m-d H:i:s') )); // date now
 print_r($since_start);
 switch ($diff) {
    case 'seconds':
        return $since_start->s;
        break;
    case 'minutes':
        return $since_start->i;
        break;
    case 'hours':
        return $since_start->h;
        break;
    case 'days':
        return $since_start->d;
        break;      
    default:
        # code...
        break;
 }
} 
```

您可以开发此功能。我测试并为我工作。DateInterval 对象输出在这里：

```
/*
DateInterval Object ( [y] => 0 [m] => 0 [d] => 0 [h] => 0 [i] => 5 [s] => 13 [f] => 0 [weekday] => 0 [weekday_behavior] => 0 [first_last_day_of] => 0 [invert] => 0 [days] => 0 [special_type] => 0 [special_amount] => 0 [have_weekday_relative] => 0 [have_special_relative] => 0 ) 
*/ 
```

功能用法：

$date = 过去的日期，$diff = 类型 例如：“分钟”、“天”、“秒”

```
$diff_mins = alihan_diff_dates("2019-03-24 13:24:19", "minutes"); 
```

祝你好运。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2020-11-01T11:42:05.573

```
$date1=date_create("2020-03-15");
$date2=date_create("2020-12-12");
$diff=date_diff($date1,$date2);
echo $diff->format("%R%a days"); 
```

有关详细的格式说明符，请访问[链接](https://www.php.net/manual/en/dateinterval.format.php)。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-02-13T20:20:22.323

另一种以分钟为单位计算差异的简单方法。请注意，这是一个在 1 年范围内计算的样本。更多详情请点击[这里](https://www.php.net/manual/en/datetime.diff.php)

```
$origin = new DateTime('2021-02-10 09:46:32');
$target = new DateTime('2021-02-11 09:46:32');
$interval = $origin->diff($target);
echo (($interval->format('%d')*24) + $interval->format('%h'))*60; //1440 (difference in minutes) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-01-16T04:57:01.017

这会有所帮助....

```
function get_time($date,$nosuffix=''){
    $datetime = new DateTime($date);
    $interval = date_create('now')->diff( $datetime );
    if(empty($nosuffix))$suffix = ( $interval->invert ? ' ago' : '' );
    else $suffix='';
    //return $interval->y;
    if($interval->y >=1)        {$count = date(VDATE, strtotime($date)); $text = '';}
    elseif($interval->m >=1)    {$count = date('M d', strtotime($date)); $text = '';}
    elseif($interval->d >=1)    {$count = $interval->d; $text = 'day';} 
    elseif($interval->h >=1)    {$count = $interval->h; $text = 'hour';}
    elseif($interval->i >=1)    {$count = $interval->i; $text = 'minute';}
    elseif($interval->s ==0)    {$count = 'Just Now'; $text = '';}
    else                        {$count = $interval->s; $text = 'second';}
    if(empty($text)) return '<i class="fa fa-clock-o"></i> '.$count;
    return '<i class="fa fa-clock-o"></i> '.$count.(($count ==1)?(" $text"):(" ${text}s")).' '.$suffix;     
} 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-06-05T09:45:20.517

我找到了很多解决方案，但我从来没有得到正确的解决方案。但我创建了一些代码来查找分钟，请检查它。

```
<?php

  $time1 = "23:58";
  $time2 = "01:00";
  $time1 = explode(':',$time1);
  $time2 = explode(':',$time2);
  $hours1 = $time1[0];
  $hours2 = $time2[0];
  $mins1 = $time1[1];
  $mins2 = $time2[1];
  $hours = $hours2 - $hours1;
  $mins = 0;
  if($hours < 0)
  {
    $hours = 24 + $hours;
  }
  if($mins2 >= $mins1) {
        $mins = $mins2 - $mins1;
    }
    else {
      $mins = ($mins2 + 60) - $mins1;
      $hours--;
    }
    if($mins < 9)
    {
      $mins = str_pad($mins, 2, '0', STR_PAD_LEFT);
    }
    if($hours < 9)
    {
      $hours =str_pad($hours, 2, '0', STR_PAD_LEFT);
    }
echo $hours.':'.$mins;
?> 
```

它以小时和分钟为单位提供输出，例如 01 小时 02 分钟，如 01:02

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-11-30T17:11:20.717

这是一个简单的单行：

```
$start = new DateTime('yesterday');
$end = new DateTime('now');
$diffInMinutes = iterator_count(new \DatePeriod($start, new \DateInterval('PT1M'), $end)); 
```

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2021-05-08T08:43:41.443

试试这个

```
$now = \Carbon\Carbon::now()->toDateString(); // get current time 
             $a = strtotime("2012-09-21 12:12:22"); 
             $b = strtotime($now);
             $minutes = ceil(($a - $b) / 3600); it will get ceiling value 
```

# c++ - 让这个 BST 模板工作

> ID：365198
> 
> 赞同：1
> 
> 时间：2008-12-13T13:08:35.997
> 
> 标签：c++

嗨，我正在尝试从 Larry Nyhoff 的书中获取此代码以在 Bloodshed 中编译。它实际上是从作者的网站上逐字逐句的，尽管我在 .cpp 而不是 .h 上声明了它（.h 文件不适用于测试仪应用程序）。

[http://cs.calvin.edu/activities/books/c++/ds/2e/SourcePrograms/Chap12/](http://cs.calvin.edu/activities/books/c++/ds/2e/SourcePrograms/Chap12/)

search(const DataType & item) 函数让我很伤心。编译器错误说：

```
In member function `bool BST<DataType>::search(const DataType&) const': 
expected `;' before "locptr" 
`locptr' undeclared (first use this function) 
```

我在这里想念什么？

```
 #include <iostream>

#ifndef BINARY_SEARCH_TREE
#define BINARY_SEARCH_TREE

template <typename DataType>
class BST
{
 public:
  /***** Function Members *****/
  BST();

  bool empty() const;

  bool search(const DataType & item) const;

  void insert(const DataType & item);

  void remove(const DataType & item);

  void inorder(std::ostream & out) const;

  void graph(std::ostream & out) const;

  private:
  /***** Node class *****/
  class BinNode 
  {
   public:
    DataType data;
    BinNode * left;
    BinNode * right;

    // BinNode constructors
    // Default -- data part is default DataType value; both links are null.
    BinNode()
    : left(0), right(0)
    {}

    // Explicit Value -- data part contains item; both links are null.
    BinNode(DataType item)
    : data(item), left(0), right(0)
    {}

}; //end inner class

typedef BinNode * BinNodePointer; 

  /***** Private Function Members *****/
  void search2(const DataType & item, bool & found,
               BinNodePointer & locptr, BinNodePointer & parent) const;
 /*------------------------------------------------------------------------
   Locate a node containing item and its parent.

   Precondition:  None.
   Postcondition: locptr points to node containing item or is null if 
       not found, and parent points to its parent.#include <iostream>
 ------------------------------------------------------------------------*/

  void inorderAux(std::ostream & out, 
                  BST<DataType>::BinNodePointer subtreePtr) const;
  /*------------------------------------------------------------------------
    Inorder traversal auxiliary function.

    Precondition:  ostream out is open; subtreePtr points to a subtree 
        of this BST.
    Postcondition: Subtree with root pointed to by subtreePtr has been
        output to out.
 ------------------------------------------------------------------------*/

  void graphAux(std::ostream & out, int indent,
                      BST<DataType>::BinNodePointer subtreeRoot) const;
  /*------------------------------------------------------------------------
    Graph auxiliary function.

    Precondition:  ostream out is open; subtreePtr points to a subtree 
        of this BST.
    Postcondition: Graphical representation of subtree with root pointed 
        to by subtreePtr has been output to out, indented indent spaces.
 ------------------------------------------------------------------------*/

 /***** Data Members *****/
  BinNodePointer myRoot; 

}; // end of class template declaration

//--- Definition of constructor
template <typename DataType>
inline BST<DataType>::BST()
: myRoot(0)
{}

//--- Definition of empty()
template <typename DataType>
inline bool BST<DataType>::empty() const
{ return myRoot == 0; }

//--- Definition of search()
template <typename DataType>
bool BST<DataType>::search(const DataType & item) const
{
   BST<DataType>::BinNodePointer locptr = myRoot; //**THIS FAILS, WHY?**//
   bool found = false;
   while (!found && locptr != 0)
   {
      if (item < locptr->data)       // descend left
        locptr = locptr->left;
      else if (locptr->data < item)  // descend right
        locptr = locptr->right;
      else                           // item found
        found = true;
   }
   return found;
}

#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T13:14:35.517

`typename`在声明之前放一个：

```
typename BST<DataType>::BinNodePointer locptr = myRoot; 
```

关键是由于潜在的模板特化，编译器无法知道依赖标识符`BinNodePointer`标识了一个类型。

# product-management - 将网络产品转换为桌面版本的挑战

> ID：365199
> 
> 赞同：-2
> 
> 时间：2008-12-13T13:08:49.787
> 
> 标签：product-management

我有一个基于 Web 的产品，并希望将其转换为可以托管在防火墙内（或）由客户端本地托管的产品。

我预见的一些挑战是：

1.  防止盗版
2.  支持
3.  维护补丁和版本（发布）
4.  源代码控制（在定制的情况下）

请分享您对此的一些经验..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T13:14:05.033

您是否考虑过提供瘦客户端的可能性？您可以向它们部署大量应用程序，但在您控制的托管服务器上维护核心逻辑和功能并通过 Web 服务提供访问？

# events - 用户控件中的事件

> ID：365204
> 
> 赞同：3
> 
> 时间：2008-12-13T13:13:15.440
> 
> 标签：events, user-controls, propertygrid

我是 UserControls 的新手，在开发自己的控件时，我发现在设计时在属性网格中显示控件的事件时出现问题。如果我的控件中有一些事件，我想在属性网格中看到它们，并且如果我双击我想要一个处理程序，就像 Microsoft 对其控件所做的那样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T13:27:40.280

如果我没记错的话，它们应该会自动出现。确保您已经构建了您的项目，否则更改不会传播到开放的设计师。并确保它也是一个**`public`**事件。（私人/受保护的事件不应该出现，因为它们不可访问。）

为了让用户的设计体验更好，您可以做的一件事是执行以下操作：

```
 [Description("This event is raised when the user presses the enter key while the control has focus."),
    Category("Key")]
    public event EventHandler EnterPressed; 
```

“描述”位在属性窗口的描述面板中放置了一条很好的消息。“类别”位将其归入某个类别（默认为 Misc. 最后）。

顺便说一句，您还没有指定语言或环境，因此如果在 Visual Studio 2005+ 中不是 C#，则可能需要修改上述内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-03T11:50:41.867

我通常使用这种模式，在 UserControls 中创建自定义事件：

```
 #region MyEvent CUSTOM EVENT

    protected virtual void OnMyEvent(MyEventEventArgs e)
    {
        if (MyEvent != null)
            MyEvent(this, e);
    }

    public delegate void MyEventHandler(object sender, MyEventEventArgs e);
    public event MyEventHandler MyEvent;

    public class MyEventEventArgs : EventArgs
    {

    }

    #endregion MyEvent CUSTOM EVENT 
```

这与 Microsoft 事件具有相同的命名约定，您可以从控件内部触发 OnMyEvent，具有自定义 EventArgs，从其他控件处理 MyEvent。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T03:24:47.537

您应该在 UserControl 使用 Delegate 并在 Main 页面（aspx 页面）提出它。如果这种方式不起作用，则在注册 UserControlID 时应小心。它需要与其他 UserControl 不同。每个 UserControl 都需要一个 ID。

# .net - 代码生成器 (.net)

> ID：365208
> 
> 赞同：1
> 
> 时间：2008-12-13T13:18:08.707
> 
> 标签：.net, code-generation, t4, codesmith

您有使用[T4](http://www.olegsych.com/2007/12/text-template-transformation-toolkit/)和[T4 Editor](http://www.t4editor.net/)的经验吗？您可以将它与[CodeSmith](http://www.codesmithtools.com/)或[MyGeneration](http://www.mygenerationsoftware.com/)进行比较吗？

你使用什么代码生成器？你有什么建议吗？

我想用它来生成 SP。你觉得代码生成还有什么有用的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-05-26T14:36:38.480

作为代码生成引擎，T4 与 CodeSmith 或 MyGeneration 一样强大。它的主要优点是与 Visual Studio 的紧密集成；主要缺点是即用型模板数量较少。

我个人更喜欢 Tangible 的[T4 编辑器，](http://www.olegsych.com/2009/04/t4-editor-by-tangible-engineering/)因为它可以与[T4 Toolbox](http://t4toolbox.codeplex.com)一起使用。

奥列格

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T13:27:38.860

你到底想做什么？我想这也取决于您尝试从哪里生成代码（模型）。

Codesmith 和 MyGeneration 的优势在于，它们为您提供了多种生成代码的选项——例如，在 MyGeneration 中，您可以使用各种语言编写模板。

MyGeneration 可以提供任何数据库的元模型和许多内置的生成器脚本——因此，如果你想生成 SP，最简单的方法就是使用 MyGeneration 的生成器——你可以在那里找到 CRUD SP 的生成器。如果您想修改生成器，它还提供了一个相当不错的编辑器。

如果您正在构建 DSL 或其他东西（我的意思是，模型来自其他地方），那么您可能会考虑使用 T4。然而，T4 编辑并不是我做过的最简单的事情，因为 Visual Studio 中没有 T4 编辑支持。您可以考虑购买 Clarius T4 编辑器以获得良好的编辑支持。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T13:21:14.350

提高生产力的方法是使用**Visual Studio 的内置片段**。

`tab tab`

就像键入`if`并按两次 Tab 会为您生成一个 if 语句，然后基本上您只需填写空白

`try`两个选项卡将生成一个 try-catch 块

ETC...

您可以使用完整的片段列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-15T15:38:28.490

除了现在推荐的 T4 模板外，还有另一种在 VS 中生成代码的方法 - [MVC Scaffolding](http://blog.stevensanderson.com/2011/01/13/scaffold-your-aspnet-mvc-3-project-with-the-mvcscaffolding-package/)，可以用于任何代码生成（不仅是 ASP.NET MVC）。

它基于 T4，但添加了一些有用的功能，如模板参数、与 VS 的集成（打开文档等）、PowerShell 脚本和多文件生成。

# sql-server - sp_start_job 等待作业完成

> ID：365219
> 
> 赞同：7
> 
> 时间：2008-12-13T13:34:54.307
> 
> 标签：sql-server, sql-server-agent

> **可能重复：**
> [从存储过程执行 SQL Server 代理作业并返回作业结果](https://stackoverflow.com/questions/12249056/executing-sql-server-agent-job-from-a-stored-procedure-and-returning-job-result)

使用 sp_start_job 启动 sql 代理作业后，有没有办法确定它何时完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T19:53:11.050

本文[介绍](http://blog.boxedbits.com/archives/124)了一个 SP 启动一个 sql 代理作业并等待。

```
-- output from stored procedure xp_sqlagent_enum_jobs is captured in the following table
    declare @xp_results TABLE ( job_id                UNIQUEIDENTIFIER NOT NULL,
                                last_run_date         INT              NOT NULL,
                                last_run_time         INT              NOT NULL,
                                next_run_date         INT              NOT NULL,
                                next_run_time         INT              NOT NULL,
                                next_run_schedule_id  INT              NOT NULL,
                                requested_to_run      INT              NOT NULL, -- BOOL
                                request_source        INT              NOT NULL,
                                request_source_id     sysname          COLLATE database_default NULL,
                                running               INT              NOT NULL, -- BOOL
                                current_step          INT              NOT NULL,
                                current_retry_attempt INT              NOT NULL,
                                job_state             INT              NOT NULL)

    -- start the job
    declare @r as int
    exec @r = msdb..sp_start_job @job

    -- quit if unable to start
    if @r<>0
        RAISERROR (N'Could not start job: %s.', 16, 2, @job)

    -- start with an initial delay to allow the job to appear in the job list (maybe I am missing something ?)
    WAITFOR DELAY '0:0:01';
    set @seccount = 1

    -- check job run state
    insert into @xp_results
    execute master.dbo.xp_sqlagent_enum_jobs 1, @job_owner, @job_id

    set @running= (SELECT top 1 running from @xp_results)

    while @running<>0
    begin
        WAITFOR DELAY '0:0:01';
        set @seccount = @seccount + 1

        delete from @xp_results

        insert into @xp_results
        execute master.dbo.xp_sqlagent_enum_jobs 1, @job_owner, @job_id

        set @running= (SELECT top 1 running from @xp_results)
    end

    -- result: not ok (=1) if still running

    if @running <> 0 begin
        -- still running
        return 0
    end
    else begin

        -- did it finish ok ?
        set @run_status = 0

        select @run_status=run_status
        from msdb.dbo.sysjobhistory
        where job_id=@job_id
          and cast(run_date as bigint) * 1000000 + run_time >= @start_job

        if @run_status=1
            return 1  --finished ok
        else  --error
            RAISERROR (N'job %s did not finish successfully.', 16, 2, @job)

    end

    END TRY 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-13T14:16:03.100

`XP_SQLAGENT_ENUM_JOBS`可以使用，但没有记录。它通常用于检测长时间运行的作业。

当然，也有`sp_help_jobs`或只是监控作业历史表

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-25T20:08:51.687

```
SELECT TOP 1 1 AS FinishedRunning
FROM msdb..sysjobactivity aj
JOIN msdb..sysjobs sj on sj.job_id = aj.job_id
WHERE aj.stop_execution_date IS NOT NULL
AND aj.start_execution_date IS NOT NULL
AND sj.name = 'YourJobNameHere'
AND NOT EXISTS
(
    SELECT TOP 1 1
    FROM msdb..sysjobactivity New
    WHERE New.job_id = aj.job_id
    AND new.start_execution_date > aj.start_execution_date
) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-06-23T19:20:27.957

实际上我最近不得不这样做，这就是我正在考虑实施它的方式。我正在通过 sp_add_job 和 sp_add_jobstep 创建一个临时作业，并将 @delete_level 设置为 3（总是在运行后删除）。

我不是 100% 相信这种方法的，正如您可能从存储过程的标题中看出的那样。但是，它确实有效：

```
CREATE PROCEDURE spWorkaround_checkJobExists

@job_id UNIQUEIDENTIFIER   
, @thisIteration tinyint  
, @maxRecurse tinyint

AS

IF (@thisIteration <= @maxRecurse)
BEGIN
    IF EXISTS(
    select * FROM msdb.dbo.sysjobs where job_id = @job_id
    ) 
    BEGIN
        WAITFOR DELAY '00:00:01'
        DECLARE @nextIteration int
        SET @nextIteration = @thisIteration + 1
        EXEC dbo.spWorkaround_checkJobExists  @job_id, @nextIteration, @maxRecurse
    END
END 
```

当然，您需要输入一些代码来确保递归的最大次数，但您明白了。您还可以传入一个参数来控制递归发生的频率。就我而言，十秒钟后，结果毫无意义。

我在这里所做的可以通过更改选择标准以检查作业的执行状态来修改不打算在执行后立即删除的作业，例如，使用 sp_help_job 传递 @job_name 或 @job_id 和 @execution_status = 0。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-08T11:54:09.653

```
 sp_help_job   @job_name   @execution_status = 0 
```

# c# - LinqToSql 用内部类 C# 覆盖插入

> ID：365222
> 
> 赞同：2
> 
> 时间：2008-12-13T13:37:45.517
> 
> 标签：c#, linq-to-sql

我有一个基本配方类，并且正在使用数据上下文。我在数据上下文中覆盖了配方的插入方法，并试图插入到它的子项中。不管我做什么，我都无法让孩子插入。目前，只有食谱插入，孩子没有任何反应。

```
 partial void InsertRecipe(Recipe instance)
    {
        // set up the arrays
        for (int x = 0; x < instance.PlainIngredients.Count; ++x)
        {
            instance.TextIngredients.Add(new TextIngredient()
            {
                StepNumber = x + 1,
                Text = instance.PlainIngredients[x]
            });
        }

        this.ExecuteDynamicInsert(instance);
    } 
```

我已经尝试了我能想到的一切。我什至在该方法中实例化了另一个数据上下文，并且在实例从 ExecuteDynamicInsert 返回带有 id 后，尝试添加它，但出现超时错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-15T01:57:21.497

我想到了。覆盖 DataContext 中的 SubmitChanges，并找到所有作为配方的插入和更新。运行算法以在其中添加孩子。

```
 public override void SubmitChanges(
        System.Data.Linq.ConflictMode failureMode)
    {
        ChangeSet changes = this.GetChangeSet();

        var recipeInserts = (from r in changes.Inserts
                       where (r as Recipe) != null
                       select r as Recipe).ToList<Recipe>();

        var recipeUpdates = (from r in changes.Updates
                       where (r as Recipe) != null
                       select r as Recipe).ToList<Recipe>();

        ConvertTextData(recipeInserts);
        ConvertTextData(recipeUpdates);

        base.SubmitChanges(failureMode);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-14T19:25:30.163

InsertX/UpdateX/DeleteX 方法在 LINQ to SQL 确定哪些对象将包含在 SubmitChanges 中后调用。

由于两个事务之间的锁定问题，您很可能会因为两个事务之间的锁定问题而使用两个 DataContext 超时。

我无法清楚地弄清楚您要在这里实现什么 - 通常 LINQ to SQL 自己管理子关系 - PlainIngredients 和 TextIngredients 是什么？

# windows - 禁用 USB 存储设备

> ID：365223
> 
> 赞同：4
> 
> 时间：2008-12-13T13:38:43.580
> 
> 标签：windows, usb

有没有办法以编程方式禁用 USB 存储设备的工作，同时仍然保持 USB 端口可用于其他类型的设备（如键盘和鼠标）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-13T14:10:05.747

取自[这里](http://www.pragmaticutopia.com/content/view/89/125/)，未经测试：

```
Directions for Use:

1.)  Take the following blue text, copy it, and paste it into a text  document.  Then, save it as USBSTOR.ADM.
CLASS MACHINE
CATEGORY "Custom Policies"
KEYNAME "SYSTEM\CurrentControlSet\Services\UsbStor"
  POLICY "USB Mass Storage Installation"
   EXPLAIN "When this policy is enabled, USB mass storage device permissions can be changed by using the drop down box.

Selecting 'Grant Permission' will allow USB mass storage devices to be installed.  Selecting 'Deny Permission' will prohibit
the installation of USB mass storage devices.

IF REMOVING THIS POLICY: Reset to original setting and let policy propegate before deleting policy."
     PART "Change Settings:" DROPDOWNLIST REQUIRED
       VALUENAME "Start"
       ITEMLIST
        NAME "Grant Permission" VALUE NUMERIC 3 DEFAULT
        NAME "Deny Permission" VALUE NUMERIC 4
       END ITEMLIST
     END PART
   END POLICY
END CATEGORY

2.)  Open a group policy management console (gpedit.msc), and right click on "administrative templates" under "Computer Configuration".  Select "Add/Remove Templates".

3.)  Browse to the text document you just saved and click OK.  You'll now see "Custom Policies" under "Administrative Templates".  Right click on it, select "View", then select "Filtering".  Uncheck the bottom box, labeled "Only show policy settings that can be fully managed".

4.)  Click ok.  Now you'll see the USB policy available for use under the custom policy heading.  From there, you can enable or disable it just like any other policy. 
```

或（禁用 USB 存储设备，在 XP SP3 上测试）

```
REG ADD "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR" /v Start /t REG_DWORD /d 4 /f 
```

（启用 USB 存储设备，在 XP SP3 上测试）

```
REG ADD "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR" /v Start /t REG_DWORD /d 3 /f 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-04-03T03:36:24.100

我们可以使用以下批处理文件来禁用和启用 USB 存储。

### Disable_usb_storage.bat

```
@echo off

:: Disable USBstor driver
reg add HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR /v Start /t REG_DWORD /d 4 /f

:: USB Read Only Mode
reg add HKLM\SYSTEM\CurrentControlSet\Control\StorageDevicePolicies /v WriteProtect /t REG_DWORD /d 1 /f

:: USB Disable startup

reg add HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR /v Boot /t REG_DWORD /d 0 /f

rem reg add HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR /v System /t REG_DWORD /d 1 /f

reg add HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR /v Auto Load /t REG_DWORD /d 0 /f

:: Disable read permissions on USBstor driver

:: Remove Access for Users from  files

cacls %SystemRoot%\inf\usbstor.inf /E /R users
cacls %SystemRoot%\inf\usbstor.PNF /E /R users
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /R users
cacls %SystemRoot%\inf\usbstor.inf /E /D users
cacls %SystemRoot%\inf\usbstor.PNF /E /D users
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /D users

:: Remove Access for System
cacls %SystemRoot%\inf\usbstor.inf /E /R system
cacls %SystemRoot%\inf\usbstor.PNF /E /R system
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /R system
cacls %SystemRoot%\inf\usbstor.inf /E /D system
cacls %SystemRoot%\inf\usbstor.PNF /E /D system
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /D system

:: Remove Access for ower Users
cacls %SystemRoot%\inf\usbstor.inf /E /R "Power Users"
cacls %SystemRoot%\inf\usbstor.PNF /E /R "Power Users"
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /R "Power Users"
cacls %SystemRoot%\inf\usbstor.inf /E /D "Power Users"
cacls %SystemRoot%\inf\usbstor.PNF /E /D "Power Users"
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /D "Power Users"

:: Remove Access for Administrators
cacls %SystemRoot%\inf\usbstor.inf /E /R Administrators
cacls %SystemRoot%\inf\usbstor.PNF /E /R Administrators
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /R Administrators
cacls %SystemRoot%\inf\usbstor.inf /E /D Administrators
cacls %SystemRoot%\inf\usbstor.PNF /E /D Administrators
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /D Administrators

:: Remove Access for EveryOne
cacls %SystemRoot%\inf\usbstor.inf /E /R Everyone
cacls %SystemRoot%\inf\usbstor.PNF /E /R Everyone
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /R Everyone
cacls %SystemRoot%\inf\usbstor.inf /E /D Everyone
cacls %SystemRoot%\inf\usbstor.PNF /E /D Everyone
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /D Everyone

REM ::USB_REG_PERMISSION_changes

:: If parameter recover then undo all this
IF [%1]==[enable] GOTO Enable
:: Create a temporary .REG file - DISABLE USB
> "%Temp%.\u1.ini" ECHO HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR [0 0 0 0]
regini "%Temp%.\u1.ini"
DEL "%Temp%.\u1.ini"

:Exit

:: Leave state 
-----------------------------------------------------------------

========================================

Enable_usb_storage.bat
----------------------------------------------

@echo off

:: Enable USBstor driver from registry 
reg add HKLM\SYSTEM\CurrentControlSet\Services\USBSTOR /v Start /t REG_DWORD /d 3 /f

:: Enable USBstor READ / Write mode
reg add HKLM\SYSTEM\CurrentControlSet\Control\StorageDevicePolicies /v WriteProtect /t REG_DWORD /d 0 /f

REM :: Remove permissions of actual USBSTORAGE Files

:: Provide Access for Users from  files
cacls %SystemRoot%\inf\usbstor.inf /E /G users:F
cacls %SystemRoot%\inf\usbstor.PNF /E /G users:F
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /G users:F
rem cacls %SystemRoot%\inf\usbstor.inf /E /D users
rem cacls %SystemRoot%\inf\usbstor.PNF /E /D users

:: Provide Access for System
cacls %SystemRoot%\inf\usbstor.inf /E /G system:F
cacls %SystemRoot%\inf\usbstor.PNF /E /G system:F
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /G system:F
rem cacls %SystemRoot%\inf\usbstor.inf /E /D system
rem cacls %SystemRoot%\inf\usbstor.PNF /E /D system

:: Provide Access for ower Users
cacls %SystemRoot%\inf\usbstor.inf /E /G "Power Users":F
cacls %SystemRoot%\inf\usbstor.PNF /E /G "Power Users":F
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /G "Power Users":F
rem cacls %SystemRoot%\inf\usbstor.inf /E /D "Power Users"
rem cacls %SystemRoot%\inf\usbstor.PNF /E /D "Power Users"

:: Provide Access for Administrators
cacls %SystemRoot%\inf\usbstor.inf /E /G Administrators:F
cacls %SystemRoot%\inf\usbstor.PNF /E /G Administrators:F
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /G Administrators:F
rem cacls %SystemRoot%\inf\usbstor.inf /E /D Administrators
rem cacls %SystemRoot%\inf\usbstor.PNF /E /D Administrators

:: Provide Access for EveryOne
cacls %SystemRoot%\inf\usbstor.inf /E /G Everyone:F
cacls %SystemRoot%\inf\usbstor.PNF /E /G Everyone:F
cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /F Everyone:F
rem cacls %SystemRoot%\inf\usbstor.inf /E /D Everyone
rem cacls %SystemRoot%\inf\usbstor.PNF /E /D Everyone
rem cacls %SystemRoot%\system32\drivers\USBSTOR.SYS /E /D Everyone

REM ::USB_REG_PERMISSION_changes

:: If parameter recover then undo all this
IF [%1]==[enable] GOTO Enable
:: Create a temporary .REG file - DISABLE USB
> "%Temp%.\u1.ini" ECHO HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR [1 5 8 11 17]
regini "%Temp%.\u1.ini"
DEL "%Temp%.\u1.ini"

:Exit

:: Leave state 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-30T07:19:32.470

1.  首先重启你的机器
2.  打开注册表
3.  `HKEY_LOCAL_MACHINE`
4.  系统
5.  当前控制集
6.  服务
7.  USB存储
8.  设置*禁用*`4`和*启用*_ _`3`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-19T20:48:00.280

最简单的方法是使用更改的注册表值创建一个 .reg 文件，然后使用 WA 运行这样的 dos 命令：regedit.exe /s pathto.regfile

# c# - 您以什么方式使用 C# Lambda 表达式？

> ID：365224
> 
> 赞同：6
> 
> 时间：2008-12-13T13:43:30.700
> 
> 标签：c#, .net, c#-3.0, lambda

倒入你的帖子。我将从一对夫妇开始，让我们看看我们可以收集多少。

提供内联事件处理程序，如

```
button.Click += (sender,args) =>
{
}; 
```

在集合中查找项目

```
 var dogs= animals.Where(animal => animal.Type == "dog"); 
```

用于迭代集合，例如

```
 animals.ForEach(animal=>Console.WriteLine(animal.Name)); 
```

让他们来！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T13:50:05.960

返回一个自定义对象：

```
var dude = mySource.Select(x => new {Name = x.name, Surname = x.surname}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T20:20:45.280

一根线功能

```
Func<int, int> multiply = x => x * 2;
int y = multiply(4); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T23:12:26.073

这是一个稍微不同的 - 您可以使用它们[（像这样）](http://groups.google.com/group/microsoft.public.dotnet.languages.csharp/browse_thread/thread/f44dc57a9dc5168d/02c312dcf8a9a769#4805324df6b30218)来模拟 C# 中缺少的“infoof”/“nameof”运算符 - 即，您可以使用 lambda，而不是将属性名称硬编码为字符串. 这意味着它在编译时被验证（哪些字符串不能）。

这显然有性能成本，因此“只是为了好玩”，但很有趣......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-20T10:23:30.277

使用方法调用程序从多线程组件事件更新 UI

```
void Task_Progress(object sender,TaskProgressArgs  e)
{
    BeginInvoke(new MethodInvoker(() => UpdateProgress(e)));
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T14:27:14.247

创建累加器。

```
 static Func<int, int> Foo(int n)
    {
        return a => n += a;
    } 
```

注意这里的闭包用法。它正在创建一个累加器，在调用之间“记住” n 的值 - 没有类或实例变量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T12:46:22.623

对于 Linq 的聚合操作：

```
public Double GetLengthOfElements(string[] wordArr) {

   double count = wordArr.Sum(word => word.Length);
   return count;
} 
```

使用 foreach 确保节拍

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-13T17:16:09.067

表达一个未命名的函数。

# sql - 在 Oracle 中使用数据透视表的建议

> ID：365238
> 
> 赞同：3
> 
> 时间：2008-12-13T14:01:11.257
> 
> 标签：sql, oracle, plsql, pivot

我需要一个报告，我应该为它使用数据透视表。报告将按类别分组。在声明时使用案例不好，因为有很多类别。你可以将 Northwind 数据库视为示例，所有类别将显示为列和报告将显示客户在类别中的偏好。我不知道另一种解决方案，并在 Internet 中看到了用于 Sql Server 的存储过程的示例。除了使用案例之外，你知道一个解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-14T16:40:06.207

一旦您获得了 Oracle 11G，就会有一个[内置的 PIVOT 特性](http://www.oracle.com/technology/pub/articles/oracle-database-11g-top-features/11g-pivot.html)。在此之前，您只能使用 CASE（或 DECODE）表达式。[我的博客](http://tonyandrews.blogspot.com/2004/10/pivot-queries.html)上有一篇关于如何自动执行此操作的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T05:21:45.390

在 SQL 中进行行/列交换是很痛苦的。你想把每一行变成一列，你必须明确要求。所以如果你有很多类别，你的查询会很长，并且每次添加/删除/更改类别时它都会改变（这可能是你提到的 CASE 方法）。您可以编写一个存储过程来生成，它将为您生成该查询（或以其他方式构建您想要的结果集），但老实说，这种方式是疯狂的（并且可能是糟糕的性能）。

将数据作为行，就像 SQL 肯定想要给它一样，然后让您的应用程序将其转换为列。这比强迫 SQL 做它不想做的事情要容易得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T10:15:39.010

您可以使用 Oracle Data Cartridges ( [http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14289/dciwhatis.htm](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14289/dciwhatis.htm) ) 比 case/when 更有效地生成数据透视表，但请注意这并不容易东西，而且我发现文档在某些地方相当稀疏。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-06T20:47:09.260

我使用报告工具来生成报告，它有助于保持视图和查询的清洁且无需格式化。通常用户要求使用 Excel，而 Excel 本身就是一个非常好的报告工具。Excel 有很多方法可以导入数据，但我建议使用 XML 作为输入，因为您可以将其作为常规 Excel 表格打开。

1.  使用 Excel 打开带有示例数据的 XML 文件
2.  选择表格并单击“插入数据透视表”
3.  添加格式并将此文件另存为模板

Excel 会记住数据 XML 文件的路径，您只需替换数据即可刷新报告。还有很多其他的方法，我在 Web 服务器上使用 JAVA 应用程序来合并 Excel 模板和 SQL 输出。此代码是免费和开源的，但对非 JAVA 开发人员没有帮助[https://github.com/jbaliuka/x4j-analytic](https://github.com/jbaliuka/x4j-analytic) 还有许多其他报告工具可以生成“专业”报告。

# asp.net - 当调用 ASP.NET System.Web.HttpResponse.End() 时，当前线程被中止？

> ID：365249
> 
> 赞同：18
> 
> 时间：2008-12-13T14:15:48.687
> 
> 标签：asp.net, httpresponse, thread-abort

当 System.Web.HttpResponse.End() 被称为 System.Thread.Abort 被触发时，我猜这是（或触发）异常？我有一些日志记录，这已列在日志文件中...

第一次机会

```
exception of type 'System.Threading.ThreadAbortException' occurred in mscorlib.dll
12/14/2008 01:09:31::
Error in Path :/authenticate
Raw Url :/authenticate
Message :Thread was being aborted.
Source :mscorlib
Stack Trace :   at System.Threading.Thread.AbortInternal()
   at System.Threading.Thread.Abort(Object stateInfo)
   at System.Web.HttpResponse.End()
   at DotNetOpenId.Response.Send()
   at DotNetOpenId.RelyingParty.AuthenticationRequest.RedirectToProvider()
   at MyProject.Services.Authentication.OpenIdAuthenticationService.GetOpenIdPersonaDetails(Uri serviceUri) in C:\Users\Pure Krome\Documents\Visual Studio 2008\Projects\MyProject\Projects\Services\Authentication\OpenIdAuthenticationService.cs:line 108
   at MyProject.Mvc.Controllers.AuthenticationController.Authenticate() in C:\Users\Pure Krome\Documents\Visual Studio 2008\Projects\MyProject\Projects\MVC Application\Controllers\AuthenticationController.cs:line 69
TargetSite :Void AbortInternal()
A first chance exception of type 'System.Threading.ThreadAbortException' occurred in Ackbar.Mvc.DLL
An exception of type 'System.Threading.ThreadAbortException' occurred in Ackbar.Mvc.DLL but was not handled in user code 
```

这是正常行为吗，是否可以优雅地中止而不是（看起来像）突然中止？

## 更新

到目前为止，这是[设计](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.end.aspx)使然的普查。所以我想知道我们是否有可能提出这个问题，看看我们是否可以调整代码以使其不会感觉我们*过早*地结束线程并优雅地退出......可能吗？代码示例？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-13T14:36:08.333

没有所谓的“优雅”中止。但是，您可以简单地 Flush() 响应，而不是结束它并让框架为您关闭连接。在这种情况下，我假设您希望将响应发送给客户端，即典型情况。

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.end.aspx)，当响应过早结束时，调用 Response.End() 会引发 ThreadAbortException。当你想要引发异常时，你真的应该只调用 Response.End() 。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-13T14:41:12.877

是的，这确实是设计使然。微软甚至已经[记录](http://msdn.microsoft.com/lv-lv/library/system.web.httpresponse.end(en-us).aspx)了它。否则您将如何阻止程序的其余部分执行？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-13T18:37:30.900

异常递归堆栈以停止当前执行本身并没有什么不优雅的。当然，只不过是您抛出异常并在异常中的某个较低位置捕获它。

我会考虑从您的日志中过滤它。如果您使用 ASP.Net 运行状况监视，您可以配置/映射每个异常到给定的提供程序（事件日志、邮件等），以控制是否收到有关线程中止异常的通知。如果它是自定义日志记录，那么我只需添加一个 if 来检查它。

请注意，您不能吃 ThreadAbortException 因此，即使您的日志记录代码正在执行类似`catch(Exception e) { // log exception and then do not throw again }`ThreadAbortException 的操作，一旦您的 catch 块退出，框架仍会再次引发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-06T11:31:07.620

不要使用 Response.End() 方法，因为它使用 Application.End() 并停止应用程序。进一步使用违反页面生命周期的 HTTP 请求或响应。使用 HttpContext.Current.Response.Close() 或 HttpContext.Current.ApplicationInstance.CompleteRequest();

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-13T04:06:00.023

我使用了上述所有更改，但我的 Web 应用程序仍然遇到同样的问题。

然后我联系了我的托管服务提供商并要求他们检查是否有任何软件或防病毒软件阻止我们的文件通过 HTTP 传输。或 ISP/网络不允许文件传输。

他们检查了服务器设置并绕过了我的服务器的“数据中心共享防火墙”，现在我们的应用程序开始下载文件。

**希望这个答案会对某人有所帮助。这对我有用**

# regex - 如何快速找到与正则表达式匹配的文件的第一行？

> ID：365259
> 
> 赞同：5
> 
> 时间：2008-12-13T14:30:36.893
> 
> 标签：regex, perl, sed, grep

我想在 Perl 脚本中使用正则表达式在文件中搜索一行。

假设它在安装了 grep 的系统中，最好：

*   `grep`通过`open()`命令调用外部
*   `open()`直接文件并使用`while`循环和`if ($line =~ m/regex/)`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-13T14:50:03.187

在现代 Perl 实现中，regexp 代码应该和 grep 一样快，但是如果您关心性能，为什么不直接尝试一下呢？从代码清洁度和健壮性的角度来看，调用外部命令行工具肯定不好。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-13T16:43:19.357

你不需要`open`明确的文件。

```
my $regex = qr/blah/;
while (<>) {
  if (/$regex/) {
    print;
    exit;
  }
}
print "Not found\n"; 
```

由于您似乎关心性能，我让匹配并使用不分配给任何东西所提供`print`的默认值，这稍微快一点。在正常的生产代码中，`$_``<>`

```
while (my $line = <>) {
  if ($line =~ /$regex/) {
    print $line;
    exit;
  }
} 
```

将是首选。

**编辑：** 这假设要检查的文件是在命令行上给出的，我刚刚注意到你没有说它适用于你的情况。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-13T16:34:32.557

使用 grep 需要注意的一件事：在最近的 Linux 发行版中，如果您的 LANG 环境变量定义了 UTF-8 类型（例如我的是 LANG=en_GB.UTF-8），那么 grep、sed、sort 和可能还有一堆其他文本-处理实用程序的运行速度要慢约 10 倍。因此，如果您正在进行性能比较，请注意这一点。我现在将我的 grep 命令别名为：

```
LANG= LANGUAGE= /bin/grep 
```

编辑：实际上，它更像是慢了 100 倍

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-13T14:50:34.183

这取决于。

*   在 Perl 中工作可以为您节省进程启动时间和其他相关资源成本。
*   grep 可能比在 Perl 中做同样的工作要快，但不是很大。

我会说在 Perl 中执行此操作，除非性能迫使您进行优化。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-14T06:50:07.067

这取决于。如果您想优化开发时间，

```
$line = `grep '$regex' file | head -n 1`; 
```

显然是要做的事情。

但它的代价是必须启动外部进程，这取决于除了安装 perl 之外的其他东西，并且在出现问题时失去了进行详细错误报告的机会。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-15T20:33:40.073

我曾经编写了一个脚本来在一些大文本文件（每个大约 10 MB）中搜索一些正则表达式。我用 Perl 正则表达式完成了它，并注意到它运行得很慢。所以我尝试从脚本中运行 grep，速度提升非常可观。所以，根据我自己的经验，Perl 内置的正则表达式比 grep 慢。但是您可能只会在大文件中注意到它。我的建议是：尝试两种方式，看看效果如何。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-01T17:12:02.303

```
sed '/pattern/q' file 
```

# singleton - 好吧，全局变量被谴责，单身被鄙视，还有什么办法？

> ID：365261
> 
> 赞同：46
> 
> 时间：2008-12-13T14:32:21.600
> 
> 标签：singleton, global-variables

对于桌面应用程序。这只是一个一般性问题，可能只需要一般性答案。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-13T14:40:47.183

具有静态数据成员的静态类？但谁在乎。静态数据成员只是具有更政治正确包装的全局变量。

不要让时尚凌驾于你的常识之上。使用普通的旧全局变量没有任何问题。单例模式通常是多余的，打字很烦人，当你单步调试代码时也很烦人。

假设您使用的是 C/C++，我建议您不要将全局变量作为从堆中分配内存的类实例。它们将使您更难使用检查内存泄漏的工具。将全局声明为一个指针，在 main() 的开头新建它，在末尾删除它。

6 条评论后编辑：考虑日志记录。您不希望能够从应用程序的任何位置向日志写入一行吗？在没有全局可见的东西来进行日志记录的情况下，您如何具体实现这一点？如果你想要全局可见的东西，那么继续让它全局可见。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-12-13T19:41:43.313

答案取决于语言。我最近遇到了一个人，他的公司开发了可在许多流行手机上运行的 USB 堆栈（例如，这样您的手机就可以与您的计算机通信）。他们的商店中有一条规则，即所有 C 程序都必须是可重入的。实际上，这意味着它们不是使用全局变量，而是对每个例程使用一个额外的参数；该参数指向应该在例程之间保持的状态。

我一直使用这种技术进行状态抽象。示例：照片图像的阅读器抽象：阅读器一次提供对一个像素的访问；它必须知道打开的文件描述符，图像中的当前位置，等等。所有这些信息都进入私有 C 结构或 C++ 类的私有成员。没有全局变量。外界看到：

```
typedef struct Pnmrdr_T *Pnmrdr_T;

struct Pnmrdr_T *Pnmrdr_new(FILE *);
pixel Pnmrdr_get(Pnmrdr_T);
void Pnmrdr_close(Pnmrdr_T);
void Pnmrdr_free(Pnmrdr_T *rp); // frees memory and sets *rp = NULL 
```

这种编程风格与 OO 方法非常相似。

为什么比全局变量更好？ **没有惊喜**。如果出现问题或者你想添加一个特性，你知道所有的东西都在传入的值中是明确的。此外，你知道你可以将许多模块连接在一起，除非你明确地在它们之间传递状态，否则它们不会干扰。我在手机业务中的联系人说，这个属性对他的公司来说非常重要——他们是一家 OEM 软件公司，他们可以很容易地将不同的部分组合在一起以供不同的客户使用。

我真的很喜欢这种编程方式，因为我可以看到正在发生的一切，并且我的私有数据结构受到保护，不会被窥探 :-)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-13T18:24:25.030

首先，假装单身比全局更好或更容易接受是没有意义的。单例只是一个装扮成 OOP 的全局变量。还有一堆其他问题。

另一种选择当然是*没有*全局数据。而不是你的类在某处访问一些静态（全局）变量，而是将数据传递给它的构造函数。是的，这意味着您必须向构造函数添加一些参数，但这是一件坏事吗？它使类的依赖关系显式。我可以简单地通过在构造函数中向它提供不同的对象来测试该类，而如果它依赖于全局数据，那么这些全局变量必须存在于我的测试中，这很混乱。

同样，我可以轻松地重构，因为除了直接传递给对象的内容之外，对类没有任何神奇的依赖。

线程安全变得更容易管理，因为您不再让所有对象与同一个全局实例进行通信。相反，可以将它们传递给类的单独实例。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-13T15:37:17.133

我不在乎是否不推荐单例或全局变量。如果我觉得这是实现它的最合乎逻辑的方式，那么我会继续使用它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-13T14:48:39.460

这完全取决于您要解决的问题。您忽略了这一关键信息。如果您正在寻找一个包罗万象的解决方案，那么没有。只有我们在适用时应用的模式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-13T15:50:05.623

我在全局变量和单例变量中看到的最常见的问题是，在使用线程时可能会出现不良行为。在这种情况下，您应该始终使用执行范围作为基本单元。这是 OO 编程的优势之一 - 您可以使用对象成员来保存所有相关数据，而不必担心意外的线程混乱。这与不支持 OO 的编程语言形成鲜明对比，在这种语言中，您必须通过参数传递数据。

另一个常见的问题往往是组织性的——当可以随时读取/写入数据时，很难准确地理解大型系统中数据的来源。根据我的经验，这更多是开发人员的问题，而不是代码本身的问题。除非您正在研究那些似乎主要出现在编程书籍中作为困难问题示例的数亿行巨型系统之一，否则您将能够在相当短的时间内搜索整个代码库以查找特定项目一段的时间。必要的下一步是定期审核代码库，以确保不会随机分配全局/静态变量。这对许多开发方法来说都是一种厌恶，但对于一定规模和复杂性的系统来说，这是一个完美可行的解决方案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T15:32:14.663

一个常见的解决方案是使用单实例类而不是单例/全局变量。

您的应用程序将负责确保您只有一个实例。

这个解决方案有点糟糕，因为你不能阻止人们实例化你的类（不是单例），所以它必须是一个内部类。

不过，我不会太在意关于单例模式的所有[宗教战争](http://c2.com/cgi/wiki?SimpletonPatternDiscussion)——如果我认为它适合我的需要，我通常会使用它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-23T13:57:00.023

在使用全局变量和单身人士并看到一切都变得一团糟之后，我想出了这个解决方案。

1.  make every global variable a member of a class. Logically every global variable belongs to application (or system). just create an application class. define global objects as properties. so they are created when first called.

2.  create a singleton for application class, so you can access it globally. This will be the only singleton in your code. well, at the end it is like system.out or system.in objects in java.

note: I know that, this is a very old question, but still popular.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-13T15:47:54.803

全局变量在小程序中很好，但是当它们变大时，当有人通过“哦，我将设置这个全局变量然后问题消失”进行更改或修复错误时，你开始得到奇怪的副作用

# sql-server - Microsoft (SQL) 服务器许可

> ID：365262
> 
> 赞同：4
> 
> 时间：2008-12-13T14:32:22.677
> 
> 标签：sql-server, windows-server-2008, licensing

我们正在计划一个与 WCF 服务对话的浏览器应用程序 (xbap)。这些 WCF 服务从 SQL 数据库中获取信息。我们的每个客户在此服务器上都有自己的数据库。客户端需要从 SQL Reporting Services 获取报告。一个客户端可以运行该应用程序的多个实例。

这如何与许可一起使用？我们考虑从 1 台在 Windows 服务器上运行 MSSQL 和 IIS 的服务器开始（尽管我可能很聪明地从一开始就将它们分开）。那么这将是 Server 2008 的 1 个许可证和 SQL2008 的 1 个许可证？为每个用户添加一个？那么，每个客户是我们客户的用户还是每个员工？这对于报告服务是否相同，还是 SQL2008 的一部分？我很困惑...

**补充：** 我听说这家公司被收取了大约 100.000 美元的费用，因为他们使用了错误许可证的报告服务。他们的 Web 应用程序被描述为普通应用程序，因为他们使用了报告服务。我们正试图阻止这种情况。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-13T14:58:51.907

使用完整的 SQL Server 2008 产品（企业版、标准版、工作组和 Web 服务器），您可以获得许多选择：

*   有一个 Webserver 版本基本上负责在 Web 应用程序中使用 SQL Server。
*   如果您拥有超过 25 个用户，则客户端访问许可证 (CAL) 基本上没有意义。
*   每 CPU 许可证最昂贵，但灵活性最大。

但是您需要小心：严格来说，对于一个网站，如果您不使用特殊的 Web 服务器版本或 CPU 许可证，您必须考虑到每个 Web 客户端（那里的 Web 用户）都需要他们自己的 CAL。
如果您只是购买最便宜的 5 CAL 版本的 SQL Server Standard（或 Workgroup），您将不符合要求。

SQL Server 上的软件不会强制执行合规性：您需要确保有足够的许可证来满足您的控制需求。

根据您需要的功能，您必须获得[可用版本](http://www.microsoft.com/sqlserver/2008/en/us/editions.aspx)之一：

*   企业 - 所有的花里胡哨，非常昂贵，无限的 CPU/RAM。
*   标准 - 非常完整。4 CPU/ 无 RAM 限制。比企业版便宜很多，但仍然相当昂贵。
*   工作组 - 限制为 2 个 CPU，没有 RAM 限制。比标准便宜一点。
*   Express - 免费，但仅限于 1GB RAM、1 个 CPU 和 4GB 数据库。

并非所有[版本都提供所有功能](http://msdn.microsoft.com/en-gb/library/cc645993.aspx)，但通常，如果您的初始需求不高，只需下载免费的*Express Edition*，然后升级以满足您的实际需求。

[Microsoft SQL Server 2008 网站上提供了](http://www.microsoft.com/sqlserver/2008/en/us/pricing.aspx)示例价格和一些许可说明。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-13T15:40:25.253

每 cpu 许可可能是您最好的。但要回答您的问题，您通常可以为他们的软件购买“每台设备”或“每用户”CALS。这就像听起来一样。如果您有一台计算机将通过该计算机上的多个用户访问 SQL Server，那么“每设备”CALS 是有意义的。但是，如果通常每台计算机有一个用户，那么购买“每用户”CALS 是有意义的。

SQL Server Std 的每个 CPU 许可证并不那么昂贵。我们为该许可证支付了大约 3000 美元。

# agile - 敏捷开发能否弥补项目中期失去三名测试人员的损失？

> ID：365265
> 
> 赞同：0
> 
> 时间：2008-12-13T14:34:46.603
> 
> 标签：agile

由于预算限制，在一个采用敏捷开发实践的项目中间，我们不得不解雇 3 个软件测试承包商。管理态度是投入同等数量的全职机构来弥补这一点。敏捷开发是否允许这种中断？我想知道有没有人遇到过类似的情况，是怎么处理的？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-13T19:52:47.910

我在一个项目中，有 9 个开发人员进展顺利。由于种种原因，我们不得不在两个月内裁掉 5 个人并增加 3 个新人。我们遵循大多数 XP 实践（不能说我们是 100% XP，但我们很接近）。我们的速度下降了一段时间，但没有归零。

*   缺乏代码所有权意味着离开的人没有没有相对较好地共享的特殊知识。
*   单元测试很好地以可执行的方式记录代码，以便新人可以看到正在发生的事情并以更安全的方式进行更改。
*   结对编程帮助我们让人们快速上手。
*   短暂的迭代让我们能够证明，虽然速度下降，但它确实开始迅速回升，并让业务用户相信我们仍在创造价值。
*   迭代计划会议帮助新人了解需求并专注于迭代目标，而不是仅仅跑遍代码库。

这不是一个理想的情况。敏捷帮助它变得更好，但它仍然受到伤害。仍然需要所有相关人员的大量努力。如果不是他们都是真正优秀的开发人员和团队成员，它就不会奏效。我只能推测，但团队足够好，即使没有敏捷，我们可能也会成功，但我认为因为敏捷，它变得更加顺利。如果它是一群笨蛋，什么都不会起作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-13T16:54:52.640

好吧，任何方法*都必须*考虑到团队损失的中断或根本不现实。无论是下岗、辞职还是干脆死去，人们都会离开。新人不会有过往记录，这会影响团队的速度，至少在开始时是这样。分析你的项目——继续做过去证明自己成功的事情。假设（这就是我所做的）他们将在第一个月的工作效率提高 1/2，并根据他们正在从事的项目的复杂性将它们向上滑动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T15:11:22.520

你做什么类型的敏捷？

如果我们笼统地说，我会说他们没有任何问题。您只需要更改您的团队任务即可继续进行测试。不要停止测试！您只需要花时间进行最初计划开发的测试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T16:58:37.967

我们使用 Scrum 方法，这当然允许这样做。事实上，它正是围绕这种情况而构建的。因为业务决定了您想要处理积压工作的哪些部分，取决于您可用于该 sprint 的资源量，您可以逐个 sprint 更改可用资源，这仍然是可行的，尽管可能不可行建议

# javascript - JavaScript 核心源代码

> ID：365272
> 
> 赞同：4
> 
> 时间：2008-12-13T14:39:15.673
> 
> 标签：javascript

众所周知，javascript 是一种开源语言，我们使用的是 Mozilla FireFox 3，在这个浏览器中，mozilla 基金会已经发布了更新版本的 javascript，但我仍然无法弄清楚 javascript 源代码在哪里FireFox 3 浏览器以及我们在日常生活中使用 javascript 开发时使用的各种功能的实现列表。

* * *

谢谢你的回复。我虽然知道如何在 javascript 中编程，但我要问的是，如果我使用 split 函数来拆分字符串，我在哪里可以找到 split 函数和 toUpperCase() 函数的实现。

也许它会让你知道我在找什么

感谢您的回复

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T15:01:34.817

[V8 的源代码](http://code.google.com/p/v8/)（谷歌浏览器的 javascript 引擎）

也可以独立运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T15:25:40.713

我认为您可能想要更多的语言规范而不是实现。我强烈建议阅读 ECMA-262 规范。它几乎涵盖了 javascript 的所有现代实现，并且在我学习 javascript 时帮助了我很多。

您可以在 Mozilla 的网站上找到规格：

[https://developer.mozilla.org/en/JavaScript_Language_Resources](https://developer.mozilla.org/en/JavaScript_Language_Resources)

如果您正在寻找如何操作网页中的对象，您可能需要查看 W3C DOM Level 2 HTML 规范中的 ECMA 脚本绑定。这也帮了我不少忙。

[http://www.w3.org/TR/2003/REC-DOM-Level-2-HTML-20030109/ecma-script-binding.html](http://www.w3.org/TR/2003/REC-DOM-Level-2-HTML-20030109/ecma-script-binding.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T14:44:28.597

你可能会在这里找到你要找的[东西](https://developer.mozilla.org/en/About_JavaScript)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-13T14:44:54.367

有很多[javascript 实现，](http://en.wikipedia.org/wiki/List_of_ECMAScript_engines)包括[SpiderMonkey](http://www.mozilla.org/js/spidermonkey/)，Gecko 浏览器（如 FireFox）中使用的版本

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T14:45:25.583

Mozilla 有一个单独的 Javascript 引擎发行版，称为[Spidermonkey](http://www.mozilla.org/js/spidermonkey/)

此外，如果您确实下载了 Firefox 的源代码，那么 Javascript 引擎就在其中。

如果您指的是浏览器源代码，在 Firefox 和 Mozilla 中，这也主要是用 Javascript 编写的，这也是全部。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-13T14:46:07.703

如果您询问 Javascript Interpreter 的“代码”

通常，如您所知，Javascript 在浏览器中工作。每个浏览器都有自己的 Javascript 解释器。如果您想了解解释器的实现，请查看 Webkit - 它是开源的，并被 Safari 等浏览器使用

如果您询问 Javascript 示例源代码

我想你可以通过谷歌搜索找到很多。

这些文章可能会对您有所帮助。

[http://computer.howstuffworks.com/question369.htm](http://computer.howstuffworks.com/question369.htm)

[http://www.webdesignfromscratch.com/how-html-css-js-work-together.php](http://www.webdesignfromscratch.com/how-html-css-js-work-together.php)

希望这可以帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T14:45:25.117

Mozilla 源代码可从[developer.mozilla.org获得](https://developer.mozilla.org/en/Download_Mozilla_Source_Code)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-09-11T04:59:07.803

这是 JavaScript Core - Apple 使用的 Safari javascript 引擎（就像 Chrome 的 V8）：[http ://trac.webkit.org/wiki/JavaScriptCore](http://trac.webkit.org/wiki/JavaScriptCore)

# .net - 是否有任何 Robocopy 的 API 包装器？

> ID：365278
> 
> 赞同：9
> 
> 时间：2008-12-13T14:45:08.703
> 
> 标签：.net, windows, api, robocopy

Robocopy 是在 Windows 上批量复制文件的最可靠且功能丰富的方法。但是，它是一个命令行工具。

我正在寻找可以在我的程序中执行相同操作的库/API。我尝试使用 Process.Start()，但随后我必须捕获并解析 stdout 以获取进度条，并且无法覆盖行为。

例如，基于委托功能排除文件；如果文件较旧，则重命名文件；（重新）根据某些事件开始复制。

我猜copy、xcopy、recursive copy等等，应该是程序员最常改造的频率。有没有我错过的 API/库？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-10-23T16:12:27.913

我意识到这是一个非常古老的帖子，但以防万一有人偶然发现它......

我在 c# 中为 Robocopy 编写了一个名为 RoboSharp 的包装器。它完全符合 OP 最初的要求。

[https://github.com/tjscience/RoboSharp](https://github.com/tjscience/RoboSharp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-29T14:19:58.320

感谢您的回答，经过更多研究，我相信 API 不存在。

重用 Robocopy 功能的最大程度是使用命令行参数分叉一个子进程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T15:39:02.277

似乎有一些东西可以在上面放置一个 GUI，例如[在 Windows Vista 和 XP 中使用 Microsoft SyncToy](http://www.microsoft.com/downloads/details.aspx?familyid=50FA5932-0685-4FE3-9605-536F39BD6C86&displaylang=en)（[此处](http://forums.microsoft.com/sync/ShowForum.aspx?ForumID=2026&SiteID=75)为论坛）和[Utility Spotlight - Robocopy GUI](http://technet.microsoft.com/en-us/magazine/cc160891.aspx)同步图像和文件。我还没有找到 API，也没有找到 Robocopy 是否公开 ActiveX 样式的控件。

*编辑：* [Robocopy](http://www.ss64.com/nt/robocopy.html)的相当大的在线描述说明了一些关于

> Robocopy 'Jobs' 和 'MOnitor source' 选项提供了设置计划任务以使用 RoboCopy 命令运行批处理文件的替代方法。

可能有帮助。可能不。

# image - 如何避免图像截断 旋转？

> ID：365284
> 
> 赞同：16
> 
> 时间：2008-12-13T14:49:17.463
> 
> 标签：image, html, canvas, rotation

当您使用画布旋转图像时，它会被切断 - 我该如何避免这种情况？我已经使画布元素比图像更大，但它仍然切断了边缘。

例子：

```
<html>
    <head>
        <title>test</title>
        <script type="text/javascript">
            function startup() {
                var canvas = document.getElementById('canvas');
                var ctx = canvas.getContext('2d');
                var img = new Image();
                img.src = 'player.gif';
                img.onload = function() {
                    ctx.rotate(5 * Math.PI / 180);
                    ctx.drawImage(img, 0, 0, 64, 120);
                }
            }
        </script>
    </head>
    <body onload='startup();'>
        <canvas id="canvas" style="position: absolute; left: 300px; top: 300px;" width="800" height="800"></canvas>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-18T22:15:56.613

除了在旋转之前旋转画布之外，您还需要在放置图像之前再次使用“翻译”，如下所示：

```
ctx.translate(85, 85);
ctx.rotate(5 * Math.PI / 180);  // for 5 degrees like the example from Vincent 
```

然后在添加图像之前再次使用 translate

```
ctx.translate(-85, -85); 
```

这会将 ctx.drawImage(img,0,0,10,10) 的 (0,0) 坐标移回 CANVAS 的预期 0,0 坐标。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-13T14:53:37.783

旋转总是围绕当前原点发生。因此，您可能希望先使用 translate 将画布平移到要旋转的位置（例如中心），然后再旋转。

例如

```
ctx.translate(85, 85);
ctx.rotate(5 * Math.PI / 180); 
```

画布现在围绕 (85, 85) 旋转。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-21T23:33:08.947

或者只是在画布中包含保存和恢复功能

```
ctx.save();
ctx.translate(85,85);
ctx.rotate(5 * Math.PI / 180);
ctx.fillRect(10,10,10,10);
ctx.restore(); 
```

如果您想围绕绘制的对象轴旋转，您可以通过对象 x 位置和 y 位置进行平移。然后在创建对象时，它的 x 位置将是其宽度的一半，而 y 将是其高度的一半。

例子：

```
Square = {
    x:10,
    y:10,
    width:10,
    height:10,
    angle:5
}
ctx.save();
ctx.translate(Square.x,Square.y);
ctx.rotate(Square.angle * Math.PI / 180);
ctx.fillRect(-Square.width/2,-Square.height/2,Square.width,Square.height);
ctx.restore(); 
```

希望这可以帮助某人:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-22T11:50:25.333

我创建了一个完整的函数，可以根据角度和位置排列图像

```
function drawImage(myContext,imgSrc, x, y, size, rotate) {<br/>
            var halfS = size / 2;<br/>
            var imageCursor = new Image();<br/>
            imageCursor.src = imgSrc;<br/>
            myContext.save();<br/>
            var tX = x - halfS;<br/>
            var tY = y - halfS;<br/>
            myContext.translate(tX, tY);<br/>
            myContext.rotate(Math.PI / 180 * rotate);<br/>
            var dX = 0, dY = 0;<br/>
            if (rotate == 0) { dX = 0; dY = 0; }<br/>
            else if (rotate > 0 && rotate < 90) { dX = 0; dY = -(size / (90 / rotate)); }<br/>
            else if (rotate == 90) { dX = 0; dY = -size; }<br/>
            else if (rotate > 90 && rotate < 180) { dX = -(size / (90 / (rotate - 90))); dY = -size; }<br/>
            else if (rotate == 180) { dX = dY = -size; }<br/>
            else if (rotate > 180 && rotate < 270) { dX = -size; dY = -size + (size / (90 / (rotate - 180))); }<br/>
            else if (rotate == 270) { dX = -size; dY = 0; }<br/>
            else if (rotate > 270 && rotate < 360) { dX = -size + (size / (90 / (rotate - 270))); dY = 0; }<br/>
            else if (rotate == 360) { dX = 0; dY = 0; }<br/>
            myContext.drawImage(imageCursor, dX, dY, size, size);<br/>
            myContext.restore();<br/>
        } 
```

# iphone - iPhone 上的 Flash（或 Silverlight）

> ID：365286
> 
> 赞同：2
> 
> 时间：2008-12-13T14:49:38.600
> 
> 标签：iphone, flash, silverlight, cocoa-touch

我对在 iPhone 上开发应用程序很感兴趣，并且是一名 .NET 和 ActionScript 开发人员，我对 Objective-C Cocoa Touch 编程的学习曲线有点害怕。我知道 Adob​​e 已经为 iPhone 准备了 Flash 播放器，我认为 Apple 不只是出于政治原因想要它。在不使用 Objective-C 和 Cocoa Touch 的情况下构建访问内部 GPS、电话等的应用程序是否有任何简单的替代方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T00:20:30.270

目前没有其他办法。作为长期的 Apple Fanboy，我一次又一次地了解到一件事“这是史蒂夫的方式或高速公路”。如果史蒂夫说没有闪光，那么你可以打赌你可爱的小比比不会有闪光。所以要么开发一个 Web 应用程序，要么学习 Objective-C。我是一个 JAVA 负责人，我在大约一个月的空闲时间里学到了所有我需要知道的东西，所以它并不像最初看起来那么糟糕。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T18:43:39.610

我认为简短的答案是没有人知道。史蒂夫乔布斯过去曾说过很多话，但他又回到了过去（iTunes 中的电影、iPod 上的视频仅举两例）。我个人的看法是，如果你精通任何 C 风格的语言，Objective-C 的学习曲线就不会像你想象的那么陡峭。此外，我认为学习新的语言和环境符合任何程序员的最大利益。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T14:56:41.973

IIRC Steve Jobs 说 iPhone 没有 flash 支持，因为 flash 太慢了。

另一方面，iPhone 浏览器使用 WebKit，因此对于 Web 应用程序，您可能只需将 javascript 与画布对象一起使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T18:34:54.337

Iphone macosx 内核不允许 jit 编译，因此 java、.net、flash 或 silverlight 之类的都不能工作。

此外，所有软件都经过苹果商店，不得复制内置在 iphone/itouch 中的标准应用程序的功能。那是ULA或类似的东西。通过JIT编译，每个人都可以下载使用flash/silverlight应用程序，最终取代内置应用程序，阻止苹果控制iphone/itouch软件市场。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-19T18:54:48.707

上个月，我阅读了这篇关于 Silverlight 的“开源克隆”进入 Iphone 的博客文章。我很好奇这个

[http://www.downloadsquad.com/2010/03/14/novell-to-bring-open-source-silverlight-clone-to-iphone/](http://www.downloadsquad.com/2010/03/14/novell-to-bring-open-source-silverlight-clone-to-iphone/)

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-12-14T03:37:02.840

Flash 是专有运行时。苹果为什么要在他们的设备上使用这个？

更不用说 Flash 开发人员经常在 Web 上占用 CPU 周期。浏览网页时，您的粉丝是否曾在大量 Flash 对象占用您的 CPU 的情况下旋转？

我没有看到 Apple 支持 Flash，我很高兴他们不会。Web 是开放标准，Flash 归一家公司所有。

# c# - 查找不可 [Serializable] 的项目

> ID：365291
> 
> 赞同：2
> 
> 时间：2008-12-13T14:52:32.230
> 
> 标签：c#, asp.net, reflection, session-state

我想知道是否有人知道一种快速方法，或者是否有人编写了反射工具来判断解决方案中的哪些对象未标记为可序列化。我正在将站点切换到 StateServer，并且我需要将所有对象标记为可序列化。我不想错过任何一个。

另外，第二部分枚举必须是可序列化的吗？

该网站是一个使用 VS 2003 构建的 ASP.NET 1.1 网站

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T15:05:06.823

枚举需要可序列化。

为了找出什么是不可序列化的，我对这些对象进行了单元测试，这些对象只是调用一个方法来知道它是否是可序列化的。此方法尝试序列化，如果失败，则对象不是...

```
 public static Stream serialize<T>(T objectToSerialize)
    {
        MemoryStream mem = new MemoryStream();
        BinaryFormatter b = new BinaryFormatter();
        b.Serialize(mem, objectToSerialize);
        return mem;
    } 
```

在您的单元测试中，您需要调用 serialize(objectToCheck); 如果不是可序列化的，则会引发异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T15:12:26.760

枚举本质上是可序列化的。

我编写了这个帮助程序来获取对象的属性，您可以在应用程序的顶部添加一行调用以下代码：

```
var assemblies = GetTheAssembliesFromYourApp();
foreach (var assembly in assemblies)
{
    var types = assembly.GetTypes ();
    foreach (var type in types)
    {
        if (AttributeHelper.GetAttrbiute<Serializable> (type) == null)
        {
            // Log somewhere - this type isn't serialisable...
        }
    }
}

static class AttributeHelper
{
    #region Static public methods

    #region GetAttribute

    static public T GetAttribute<T> (object obj)
        where T : Attribute
    {
        if (obj == null)
            throw new ArgumentNullException ("obj");

                    // If the object is a member info then we can use it, otherwise it's an instance of 'something' so get it's type...
        var member = (obj is System.Reflection.MemberInfo) ? (System.Reflection.MemberInfo)obj : obj.GetType ();

        return GetAttributeImpl<T> (member);
    }

    #endregion GetAttribute

    #endregion Static public methods

    #region Static methods

    #region GetAttributeImpl

    static T GetAttributeImpl<T> (System.Reflection.MemberInfo member)
        where T : Attribute
    {
        var attribs = member.GetCustomAttributes (typeof (T), false);
        if (attribs == null || attribs.Length == 0)
            return null;

        return attribs[0] as T;
    }

    #endregion GetAttributeImpl

    #endregion Static methods
} 
```

# security - 我在哪里可以找到故意不安全的开源 Web 应用程序？

> ID：365309
> 
> 赞同：28
> 
> 时间：2008-12-13T15:10:48.870
> 
> 标签：security, web-applications, open-source

作为一名开发人员，我了解到我通常会通过经验更好地了解最佳/最差实践。Web 应用程序安全领域并不是我的组织真正有能力让开发人员通过反复试验学习的地方。

因此，在寻找一种实践方法来分享 Web 应用程序安全最佳实践的知识时，我认为拥有一个故意构建为不安全的开源应用程序会很有用，以便帮助初级开发人员了解应用程序安全性.

有没有人知道在哪里可以找到这样的东西？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-13T16:06:39.507

有在线（黑客挑战/练习/乐趣）和离线（你有源代码）应用程序：

**离线 ：**

*   [OWASP 网络山羊](http://www.owasp.org/index.php/Category:OWASP_WebGoat_Project)
*   [Foundstone Hackme 系列](http://www.foundstone.com/us/resources-free-tools.asp)
    *   哈克米银行
    *   哈克米旅行
    *   哈克米赌场
    *   哈克我书
*   [WebMaven](http://www.mavensecurity.com/WebMaven.php)
*   [SecuriBench](http://suif.stanford.edu/~livshits/securibench/)
*   您可以下载旧的易受攻击的已知 CMS 的 VmWare 映像，或者仅从存储库下载它们（尝试 sourceforge 或官方旧版本并从[Securityfocus BID](http://www.securityfocus.com/bid/)查找漏洞）

**在线的**

**更真实的演示**

*   [http://zero.webappsecurity.com](http://zero.webappsecurity.com)
*   [http://crackme.cenzic.com](http://crackme.cenzic.com)
*   [http://testphp.acunetix.com](http://testphp.acunetix.com)
*   [http://testasp.acunetix.com](http://testasp.acunetix.com)
*   [http://testaspnet.acunetix.com](http://testaspnet.acunetix.com)
*   [http://hackme.ntobjectives.com](http://hackme.ntobjectives.com)

这是我从某个地方抓取的旧列表，其中一些现在可能已被删除。

**挑战类的例子**

*   [http://hackergames.net/](http://hackergames.net/)
*   [http://www.hackthissite.org](http://www.hackthissite.org)
*   [http://www.ngsec.com](http://www.ngsec.com)
*   [http://www.try2hack.nl](http://www.try2hack.nl)
*   [http://www.hackerslab.org](http://www.hackerslab.org)
*   [http://www.slyfx.com](http://www.slyfx.com)
*   [http://www.mod-x.co.uk](http://www.mod-x.co.uk)
*   [http://hackme.elderson.net](http://hackme.elderson.net)
*   [http://mindlock.bestweb.net/join.php](http://mindlock.bestweb.net/join.php)
*   [http://www.cyberarmy.com/zebulun/](http://www.cyberarmy.com/zebulun/)
*   [http://www.roothack.org/](http://www.roothack.org/)
*   [http://hack.datafort.net/](http://hack.datafort.net/)
*   [http://hacknull.com/](http://hacknull.com/)
*   [http://wargames.unix.se/](http://wargames.unix.se/)
*   [http://www.osix.net/](http://www.osix.net/)
*   [http://www.h4ckerx.ne](http://www.h4ckerx.ne)
*   [http://www.bright-shadows.net/](http://www.bright-shadows.net/)
*   [http://www.0penhack.com/](http://www.0penhack.com/)
*   [http://scifi.pages.at/hackits/](http://scifi.pages.at/hackits/)
*   [http://lightning.prohosting.com/~thegame/](http://lightning.prohosting.com/~thegame/)
*   [http://www.hackquest.de/](http://www.hackquest.de/)
*   [http://www.hack4u.nl](http://www.hack4u.nl)
*   [http://hackergames.net/](http://hackergames.net/)
*   [http://bigcontest.securityhack.net](http://bigcontest.securityhack.net)
*   [http://www.hackerss.com](http://www.hackerss.com)
*   [http://www.izhal.com](http://www.izhal.com)
*   [http://www.boinasnegras.com](http://www.boinasnegras.com)
*   [http://ambience.digitalshell.net/~llamatron/](http://ambience.digitalshell.net/~llamatron/)
*   [http://www.blind-dice.com](http://www.blind-dice.com)
*   [http://www.arcanum.co.nz](http://www.arcanum.co.nz)
*   [http://www.ralf-mengwasser.de](http://www.ralf-mengwasser.de)
*   [http://www.cyberarmy.com](http://www.cyberarmy.com)
*   [http://hackme.elderson.net](http://hackme.elderson.net)
*   [http://www.slyfx.com](http://www.slyfx.com)
*   [http://lightning.prohosting.com/thegame](http://lightning.prohosting.com/thegame)
*   [http://digitalparadox.org](http://digitalparadox.org)
*   [http://www.learntohack.org](http://www.learntohack.org)
*   [http://x-avier.com](http://x-avier.com)
*   [http://m4tr1x.wsn.at](http://m4tr1x.wsn.at)
*   [http://www.hdcwargame.com](http://www.hdcwargame.com)
*   [http://vortex.labs.pulltheplug.com](http://vortex.labs.pulltheplug.com)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-13T15:50:30.647

查看[WebGoat](http://www.owasp.org/index.php/Category:OWASP_WebGoat_Project)。这是一个充满[OWASP](http://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project)列表中漏洞的应用程序，旨在作为 Web 应用程序开发人员的学习资源。该应用程序是一个教程，引导开发人员了解其中包含的漏洞，并为每节课进行测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-09T11:17:37.297

您可能想尝试[https://hack.me](https://hack.me)

这是一个社区驱动的项目，托管和共享各种易受攻击的 Web 应用程序。您可以在新的沙箱中安全地运行它们，而无需下载/配置任何服务器。

我是项目创始人，但由于它是一个完全免费的项目，我认为除了提到的其他大量资源之外，这也是值得一说的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T15:29:30.830

有一个网站是为了不安全而建立的，目的是破解它。我不记得它的名字了。 ~~我正在四处寻找它。将在我找到时进行编辑。~~

找到它：名称是[hackthissite.org](http://www.hackthissite.org/)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-15T10:29:27.617

还有......该死的易受攻击的网络应用程序（DVWA）......

这里... [dvwa.co.uk](http://dvwa.co.uk)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-29T01:09:31.950

您还可以使用 SQLol 练习各种风格的 SQL 注入和使用[XMLmao](https://github.com/SpiderLabs/XMLmao)[进行](https://github.com/SpiderLabs/SQLol)XML 注入 /xPath 注入。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T15:34:27.107

我想起了[这个 OSCON 演讲](http://en.oreilly.com/oscon2008/public/schedule/detail/2949 "这个 OSCON 演讲")，尽管它可能过于具体，无法满足您的需求。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-03-12T15:30:40.970

有一个 OWASP 项目只是为了记录所有已知的易受攻击的 Web 应用程序：[https ://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project](https://www.owasp.org/index.php/OWASP_Vulnerable_Web_Applications_Directory_Project)

# silverlight - Silverlight 2.0 是一个可行的游戏开发平台吗？

> ID：365311
> 
> 赞同：9
> 
> 时间：2008-12-13T15:12:11.817
> 
> 标签：silverlight, silverlight-2.0

我使用 Silverlight 2.0 编写了一些较小的项目，这令人印象深刻。

Silverlight 2.0 是否具备成为 Web 游戏开发平台所需的条件？
（帧率是否足够高，是否会开发 3D 引擎，以及更多问题）

是或否，如果需要，请提供详细信息，以及原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T16:31:40.347

由于 Silverlight 2 缺乏 3D 支持或扭曲变换或位图操作，因此您几乎仅限于 2D 精灵游戏，但您可以制作出色的休闲游戏，甚至可以使用 Farseer 物理引擎或类似的东西制作基于物理的游戏。出于性能原因，LineRider 游戏从 Flash 移植到 Silverlight，因为在浏览器中运行 .Net 框架可以让您获得比 Flash 更高的性能。因此，如果您的游戏是计算密集型的，那么它现在可能是适合您的平台。

随着 Silverlight 3 中的一些 3D 支持、硬件加速和位图操作，我认为它将成为一个非常引人注目的网络游戏平台。

即使没有这些功能，Innoveware 也将 Quake 移植到 Silverlight，令人印象深刻，您可以在这里看到：

[http://www.innoveware.com/quakelight.html](http://www.innoveware.com/quakelight.html)

作者使用一些技巧来对位图进行扫描线光栅化以供显示，这在 Silverlight 3 中会变得容易得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-17T16:08:44.473

Silverlight 是一个非常可行的 2D 网页游戏平台。

我用它构建了[Diver](http://www.physicspoweredgames.com/Games/Diver/Diver.aspx)，开发体验非常愉快。我即将发布我的第二款游戏，这一次开发体验甚至更好，因为这些工具已经过测试版。

我现在看到的唯一缺点是缺乏网络游戏门户网站和[MochiAds等广告收入共享网站的支持](http://www.mochiads.com/)

如果没有这些网站的支持，您从游戏中赚钱的选择将受到限制。您现在赚钱的最佳选择是使用 Google adSense 帐户在您自己的网站上托管您的游戏。

我希望网络游戏门户和其他网络游戏服务能够在插件变得更加普遍并且我们在 Silverlight 游戏和游戏开发者的数量上达到一个临界点时增加对 Silverlight 的支持。

我的建议：跳入！开发 Silverliht 游戏的人越多，我们就越快达到这个临界点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T16:04:49.543

好吧，Silverlight 可以用于游戏开发，就像可以使用 Java 一样。

在我看来，这是一个非常糟糕的主意，但这是可能的。如果您有兴趣为 Web 浏览器开发游戏，我会推荐 Flash。

为什么不使用它呢？它已经存在多年了，您可能会获得大量可以使用的示例代码，并且它已被证明是网络游戏平台。

祝您游戏开发顺利。这很有趣:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-13T15:16:33.460

你可以做小游戏，你可以[在这里看到一些教程游戏](http://www.bluerosegames.com/brg/silverlight_game_development.aspx)。[它有一些用于3d 引擎](http://www.codeplex.com/Balder)的开源项目。但我不认为这是 SilverLight 的主要目的 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-08T14:51:40.773

我认为 SilverLight 今天的主要问题是与 Flash 相比，它的浏览器渗透率非常低。即使是推出不到 6 个月的 FlashPlayer 10 也超过了 SilverLight 的采用率。有充分的理由相信这*会*随着时间的推移而改变，尤其是。在 Windows 平台上，当然是因为 .NET 程序员大军是一支强大的队伍。但现在你的游戏将取决于用户是否同意安装下载——这并不总是那么容易。而如果他们去过 YouTube，比如说，那么他们就会有 Flash。

# xml - 使用 XSLT 将 XML 转换为 CSV

> ID：365312
> 
> 赞同：76
> 
> 时间：2008-12-13T15:12:22.317
> 
> 标签：xml, xslt, csv

我有以下 XML 文档：

```
<projects>
  <project>
   <name>Shockwave</name> 
   <language>Ruby</language> 
   <owner>Brian May</owner> 
   <state>New</state> 
   <startDate>31/10/2008 0:00:00</startDate> 
  </project>
  <project>
   <name>Other</name> 
   <language>Erlang</language> 
   <owner>Takashi Miike</owner> 
   <state> Canceled </state> 
   <startDate>07/11/2008 0:00:00</startDate> 
  </project>
... 
```

我想从转换（XSLT）结果中得到这个：

```
Shockwave,Ruby,Brian May,New,31/10/2008 0:00:00
Other,Erlang,Takashi Miike,Cancelled,07/11/2008 0:00:00 
```

有谁知道 XSLT 来实现这一点？我正在使用 .net 以防万一。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-12-13T16:13:36.623

这是一个带有可配置参数的版本，您可以通过编程方式设置：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text" encoding="utf-8" />

  <xsl:param name="delim" select="','" />
  <xsl:param name="quote" select="'&quot;'" />
  <xsl:param name="break" select="'&#xA;'" />

  <xsl:template match="/">
    <xsl:apply-templates select="projects/project" />
  </xsl:template>

  <xsl:template match="project">
    <xsl:apply-templates />
    <xsl:if test="following-sibling::*">
      <xsl:value-of select="$break" />
    </xsl:if>
  </xsl:template>

  <xsl:template match="*">
    <!-- remove normalize-space() if you want keep white-space at it is --> 
    <xsl:value-of select="concat($quote, normalize-space(), $quote)" />
    <xsl:if test="following-sibling::*">
      <xsl:value-of select="$delim" />
    </xsl:if>
  </xsl:template>

  <xsl:template match="text()" />
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2008-12-13T15:41:32.723

[在这里](https://web.archive.org/web/20160624174014/http://wenzlaff.de/xmltocsv.html)找到了一个 XML 转换样式表（回程机器链接，站点本身是德语）

此处添加的样式表可能会有所帮助：

```
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="text" encoding="iso-8859-1"/>

<xsl:strip-space elements="*" />

<xsl:template match="/*/child::*">
<xsl:for-each select="child::*">
<xsl:if test="position() != last()">"<xsl:value-of select="normalize-space(.)"/>",    </xsl:if>
<xsl:if test="position()  = last()">"<xsl:value-of select="normalize-space(.)"/>"<xsl:text>&#xD;</xsl:text>
</xsl:if>
</xsl:for-each>
</xsl:template>

</xsl:stylesheet> 
```

也许您想删除 xsl:if 标记内的引号，以便它不会将您的值放入引号中，具体取决于您要使用 CSV 文件的位置。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-02-22T11:40:03.490

这`xsl:stylesheet`可以使用指定的列标题列表，并确保行正确排序。它需要 XSLT 2.0 版。

```
<?xml version="1.0"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:csv="csv:csv">
    <xsl:output method="text" encoding="utf-8"/>
    <xsl:strip-space elements="*"/>

    <xsl:variable name="delimiter" select="','"/>

    <csv:columns>
        <column>name</column>
        <column>sublease</column>
        <column>addressBookID</column>
        <column>boundAmount</column>
        <column>rentalAmount</column>
        <column>rentalPeriod</column>
        <column>rentalBillingCycle</column>
        <column>tenureIncome</column>
        <column>tenureBalance</column>
        <column>totalIncome</column>
        <column>balance</column>
        <column>available</column>
    </csv:columns>

    <xsl:template match="/property-manager/properties">
        <!-- Output the CSV header -->
        <xsl:for-each select="document('')/*/csv:columns/*">
                <xsl:value-of select="."/>
                <xsl:if test="position() != last()">
                    <xsl:value-of select="$delimiter"/>
                </xsl:if>
        </xsl:for-each>
        <xsl:text>&#xa;</xsl:text>

        <!-- Output rows for each matched property -->
        <xsl:apply-templates select="property"/>
    </xsl:template>

    <xsl:template match="property">
        <xsl:variable name="property" select="."/>

        <!-- Loop through the columns in order  -->
        <xsl:for-each select="document('')/*/csv:columns/*">
            <!-- Extract the column name and value  -->
            <xsl:variable name="column" select="."/>
            <xsl:variable name="value" select="$property/*[name() = $column]"/>

            <!-- Quote the value if required -->
            <xsl:choose>
                <xsl:when test="contains($value, '&quot;')">
                    <xsl:variable name="x" select="replace($value, '&quot;',  '&quot;&quot;')"/>
                    <xsl:value-of select="concat('&quot;', $x, '&quot;')"/>
                </xsl:when>
                <xsl:when test="contains($value, $delimiter)">
                    <xsl:value-of select="concat('&quot;', $value, '&quot;')"/>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:value-of select="$value"/>
                </xsl:otherwise>
            </xsl:choose>

            <!-- Add the delimiter unless we are the last expression -->
            <xsl:if test="position() != last()">
                <xsl:value-of select="$delimiter"/>
            </xsl:if>
        </xsl:for-each>

        <!-- Add a newline at the end of the record -->
        <xsl:text>&#xa;</xsl:text>
    </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-05-15T13:30:50.067

此`CsvEscape`函数是 XSLT 1.0 并转义列值`,`、、`"`和换行符，如[RFC 4180](https://www.rfc-editor.org/rfc/rfc4180)或 Excel。它利用了可以递归调用 XSLT 模板的事实：

*   该模板`EscapeQuotes`从字符串的开头递归地用 2 个双引号替换所有双引号。
*   模板`CsvEscape`检查文本是否包含逗号或双引号，如果是，则用一对双引号将整个字符串括起来并调用`EscapeQuotes`该字符串。

示例用法：`xsltproc xmltocsv.xslt file.xml > file.csv`

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text" encoding="UTF-8"/>

  <xsl:template name="EscapeQuotes">
    <xsl:param name="value"/>
    <xsl:choose>
      <xsl:when test="contains($value,'&quot;')">
    <xsl:value-of select="substring-before($value,'&quot;')"/>
    <xsl:text>&quot;&quot;</xsl:text>
    <xsl:call-template name="EscapeQuotes">
      <xsl:with-param name="value" select="substring-after($value,'&quot;')"/>
    </xsl:call-template>
      </xsl:when>
      <xsl:otherwise>
    <xsl:value-of select="$value"/>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

  <xsl:template name="CsvEscape">
    <xsl:param name="value"/>
    <xsl:choose>
    <xsl:when test="contains($value,',')">
      <xsl:text>&quot;</xsl:text>
      <xsl:call-template name="EscapeQuotes">
    <xsl:with-param name="value" select="$value"/>
      </xsl:call-template>
      <xsl:text>&quot;</xsl:text>
    </xsl:when>
    <xsl:when test="contains($value,'&#xA;')">
      <xsl:text>&quot;</xsl:text>
      <xsl:call-template name="EscapeQuotes">
    <xsl:with-param name="value" select="$value"/>
      </xsl:call-template>
      <xsl:text>&quot;</xsl:text>
    </xsl:when>
    <xsl:when test="contains($value,'&quot;')">
      <xsl:text>&quot;</xsl:text>
      <xsl:call-template name="EscapeQuotes">
    <xsl:with-param name="value" select="$value"/>
      </xsl:call-template>
      <xsl:text>&quot;</xsl:text>
    </xsl:when>
    <xsl:otherwise>
      <xsl:value-of select="$value"/>
    </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

  <xsl:template match="/">
    <xsl:text>project,name,language,owner,state,startDate</xsl:text>
    <xsl:text>&#xA;</xsl:text>
    <xsl:for-each select="projects/project">
      <xsl:call-template name="CsvEscape"><xsl:with-param name="value" select="normalize-space(name)"/></xsl:call-template>
      <xsl:text>,</xsl:text>
      <xsl:call-template name="CsvEscape"><xsl:with-param name="value" select="normalize-space(language)"/></xsl:call-template>
      <xsl:text>,</xsl:text>
      <xsl:call-template name="CsvEscape"><xsl:with-param name="value" select="normalize-space(owner)"/></xsl:call-template>
      <xsl:text>,</xsl:text>
      <xsl:call-template name="CsvEscape"><xsl:with-param name="value" select="normalize-space(state)"/></xsl:call-template>
      <xsl:text>,</xsl:text>
      <xsl:call-template name="CsvEscape"><xsl:with-param name="value" select="normalize-space(startDate)"/></xsl:call-template>
      <xsl:text>&#xA;</xsl:text>
    </xsl:for-each>
  </xsl:template>
</xsl:stylesheet> 
```

# c++ - 3D 引擎比较

> ID：365316
> 
> 赞同：13
> 
> 时间：2008-12-13T15:18:39.027
> 
> 标签：c++, open-source, opengl, 3d, cross-platform

我目前正在研究几个基于 OpenGL 的免费/开源 3D 引擎，并且想知道你们是否可以就这些引擎提供一些反馈，以及它们如何在现实世界的项目中使用。

被比较的引擎是（没有特别的顺序）：

[Crystal Space](http://www.crystalspace3d.org/main/Main_Page)
[Panda3D](http://panda3d.org/)
[Irrlicht](http://irrlicht.sourceforge.net/)

这些是我知道的主要跨平台的，还有其他我应该看的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-13T17:29:14.783

**[你可以在这个数据库](http://www.devmaster.net/engines/)上找到很多关于很多引擎的信息。**

CrystalSpace 是一个完整的引擎，因此它是一个整体，您必须根据自己的需要进行定制。Irrlicht 也是如此，但它让做事变得容易。反作用是很难做具体的事情。

现在，我认为[Ogre](http://www.ogre3d.org)可能是这里最通用的硬件加速 3D 渲染引擎。也许 Horde3D 更适合特定的高质量渲染，但 Ogre 也无法做到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-13T18:25:24.467

比游戏更关注大地形（想想 GIS 或飞行模拟器）还有[openscenegraph](http://www.openscenegraph.org/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-13T15:34:59.367

如果你只想要一个图形引擎，我推荐 Ogre3d。在这方面它非常强大。如果您想要一个游戏引擎的开端——即易于插入网络、游戏实体、物理等的东西，那么我推荐 Crystalspace 3d。我使用 cs3d (Crystalspace 3d) 制作游戏，很容易让它快速启动和运行 - 但 Ogre3d 似乎在如何调整图形方面提供了更多功能，但它并不容易挂钩所有其他游戏内容都像 Crystalspace 一样打包。

顺便说一句，如果你只是用谷歌搜索的话，这些引擎有很多比较。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-14T01:30:36.963

[Terathon](http://www.terathon.com/)制造了一种名为 C4 的发动机。它是一个具有非常成熟的功能集的游戏引擎，对于一个包含完整源代码的 350 美元的引擎来说令人印象深刻。该引擎也可用并在 PS3 上使用，因此这是一个非常可靠的平台。不确定您是在考虑仅考虑 3D 图形引擎还是完整的游戏引擎，但我想我会提到它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T15:24:34.023

您可能还想查看 Ogre 3D：[http ://www.ogre3d.org/](http://www.ogre3d.org/)

不幸的是，我没有任何使用 Ogre 或您提到的任何开发经验。

# c# - 在 C# 中生成 PDF

> ID：365339
> 
> 赞同：1
> 
> 时间：2008-12-13T15:42:03.363
> 
> 标签：c#, .net, sql-server, pdf, reporting-services

我们目前以纯文本或 html 格式发送电子邮件通知。我们的环境是 C#/.NET/SQL Server。

我想知道是否有人推荐特定的解决方案。我看到了两种方法：

*   使用第三方库将当前电子邮件动态转换为 pdf 并将 pdf 作为附件发送

或者

*   使用 SSRS 允许用户导出 pdf 报告（最终可能会有 SSRS 推送报告）

我对第三方库开放（特别是如果它们是开源和免费的）。SSRS 似乎是最简单、最容易的方法。有人有任何提示吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-13T16:31:45.027

您可以使用[iTextSharp](http://itextsharp.sourceforge.net/)将您的 html 页面转换为 pdf。这是一个例子：

```
class Program
{
    static void Main(string[] args)
    {
        string html = 
@"<html>
<head>
  <meta http-equiv=""Content-Type"" content=""text/html; charset=utf-8"" />
</head>
<body>
  <p style=""color: red;"">Hello World</p>
</body>
</html>";

        Document document = new Document(PageSize.A4);
        using (Stream output = new FileStream("out.pdf", FileMode.Create, FileAccess.Write, FileShare.None))
        using (StringReader htmlReader = new StringReader(html))
        using (XmlTextReader reader = new XmlTextReader(htmlReader))
        {
            PdfWriter.GetInstance(document, output);
            HtmlParser.Parse(document, reader);
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T15:43:41.317

[iText-Sharp](http://itextsharp.sourceforge.net/)
与 java 版本非常相似，并且有很好的文档和多本书可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-20T20:22:33.493

If you only need simple html -> pdf conversion, look at [wkhtmltopdf](http://wkhtmltopdf.org). It's free, opensource, command line utility based on webkit.

If you want something more complex like prepare multiple templates or store history of pdf outputs. Look at reporting server [jsreport](http://jsreport.net)

# c# - 调用代码书呆子 - 嵌套循环的替代方案？

> ID：365352
> 
> 赞同：8
> 
> 时间：2008-12-13T15:50:10.693
> 
> 标签：c#, linq, loops

对于我（或者可能是其他任何人）来说，拥有一个我需要迭代然后与属性列表交互的对象列表并不少见。我使用嵌套循环，如下所示：

```
IList<T> listOfObjects;
IList<TProperty> listOfProperties;

foreach (T dataObject in listOfObjects)
{
    foreach (TProperty property in listOfProperties)
    {
        //do something clever and extremely useful here
    }
} 
```

这是这个问题的时间和性能测试模式吗？或者有什么更高效、更优雅、或者只是简单有趣的东西（当然仍然是可读和可维护的）？

上面的代码不会让我微笑。有人可以帮我的循环带来一些快乐吗？

谢谢！

更新：我在最积极的意义上使用“书呆子”这个词。作为维基百科定义的一部分，它“指的是一个热情地追求智力活动的人”。我所说的“代码书呆子”是指关注不断提高自己作为程序员的人，寻找新的、新颖的、优雅的快速、可维护和美观的编码方式！他们很高兴能离开 VB6，并希望聪明的人批评他们的代码并帮助他们使自己变得聪明。（注意：他们也喜欢造以 -ify 结尾的新词）。

最后说明：

感谢 Dave R、Earwicker 和 TheSoftwareJedi 让我走上了 Linq 之路。这正是我正在寻找的那种快乐代码！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-13T16:15:26.883

嵌套循环当然没有错。它们速度快、可读性强，并且自软件开发迈出第一步以来就一直存在。

当您想要在迭代集合时执行操作时，您可能会发现 LINQ 将是一个有趣的探索途径：

[http://msdn.microsoft.com/en-us/vcsharp/aa904594.aspx](http://msdn.microsoft.com/en-us/vcsharp/aa904594.aspx)

您将限制自己使用更高版本的框架（3.5 及更高版本），但实际上您可能会发现函数式编程方法非常优雅。当你走这条路时，其他语言特性会发挥作用，包括 lambdas 和匿名方法，它们本身就很吸引人。

祝你好运，我希望你在路上玩得开心 - 这是一个很好的方法:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-13T17:07:54.543

看起来您正在尝试笛卡尔连接两个列表，并应用 where 子句。这是一个简单的示例，显示了执行此操作的 Linq 语法，我认为这是您正在寻找的。list1 和 list2 可以是任何 IEnumerable，您的 where 子句可以包含更详细的逻辑，并且在您的 select 子句中您可以抽出您需要的内容。

```
 var list1 = Enumerable.Range(1, 100);
        var list2 = Enumerable.Range(1, 100);

        foreach (var item in from a in list1
                             from b in list2
                             where a % b == 0
                             select new { a, b })
        {
            Console.WriteLine(item);
        }; 
```

性能将与您发布的内容相同 - 不想在这方面误导。我确实更喜欢这种 Linq 语法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-13T16:59:48.043

```
foreach (var pair in from obj in listOfObjects
                     from prop in listOfProperties  
                     select new {obj, prop})
{
   Console.WriteLine(pair.obj + ", " + pair.prop);
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-13T16:04:16.830

如果您需要对每个对象和每个属性都做某事，那么没有太多工作要做。您可能能够做一些语法上令人愉悦的事情，但没有办法绕过这项工作。

如果您只处理对象和/或属性的子集，请过滤它（使用 linq to objects，如果您正在使用 .net 3.5）！

您可能会喜欢使用[Filter/Map/Reduce](http://diditwith.net/2007/06/21/AHigherCalling.aspx)来为您的集合提供更好的语法来执行集合操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-15T17:27:54.300

```
Action<T, TProp> somethingClever = //your clever method

listOfObjects
  .SelectMany(
    o => listOfProperties,
    (o, p) => new {o, p})
  .ToList()
  .ForEach(x => somethingClever(x.o, x.p)); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-15T17:39:38.707

虽然我确实喜欢 Linq 解决方案的优雅，但我认为我的建议是将内部循环提取到方法中；您的代码最终看起来像：

```
foreach(dataObject in listOfObjects)
    DoSomethingCleverWithProperties(dataObject, listOfProperties); 
```

这对我来说更易于维护。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T16:01:48.033

在这种情况下，我们通常从过滤我们感兴趣的部分开始。你的块 dosomethingclever() 通常开始于

```
foreach (T dataObject in listOfObjects)
{    
  foreach (TProperty property in listOfProperties)    
  {
    if (property.something == "blah") 
    { // OK, we found the piece we're interested in...

      // do something clever...

    }
  }
} 
```

这就是 LINQ 是你的朋友的地方，它允许你用一个 select 语句替换你的循环。当然，您可能仍需要对结果集进行迭代。

[这里有大量样品](http://msdn.microsoft.com/en-us/vcsharp/aa336746.aspx)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-15T17:35:24.627

我喜欢 Ayende 的[管道和过滤器](http://ayende.com/Blog/archive/2008/01/05/Pipes-and-filters-The-IEnumerable-appraoch.aspx)，但它比用于简单循环的内置 LINQ 的代码要多得多（我假设问题中的代码示例很简单）。

# php - 从 WordPress 抓取页面

> ID：365353
> 
> 赞同：1
> 
> 时间：2008-12-13T15:50:12.630
> 
> 标签：php, wordpress

1.  在 WordPress 中，如何隐藏页面？
2.  然后我如何将它重新实现为 DIV，比方说，在另一个页面上？

**语境**

我正在尝试为我的自由职业者获得一些年终税收减免，因此我将 WordPress 网站捐赠给教堂。现在，不幸的是，我发现有几位牧师不太了解计算机，尽管 WordPress 对于像你我这样的技术人员来说相当容易，但他们还是有点困惑。因此，我注释掉了帖子、评论、插件、小部件、用户、设计，只留下了页面（新建、编辑、删除）和媒体库。然后，我采用了一个主题，将页面显示为顶部的标签，就像普通网站一样。

我希望将像 Sidebar1 这样的特定页面称为标题。但是，它不会显示为选项卡，而是会被隐藏。然后，它将在标题为 Home 的页面中重新实现为 DIV。如果牧师不小心删除了 Sidebar1，他所要做的就是重新创建它并重新出现。

这不涉及 Wordpress 网站，而是涉及 Wordpress 安装。

我已经更改了管理员——我只需要更改前端。

我可以自己解决这个问题，但为了节省时间，我想知道是否有人已经这样做了？

你的帮助可以帮助我在圣诞节前为这里的一些地区教堂完成这项工作。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T17:21:42.597

*另一个论坛中名为“greyhoundcode”的人回答了我，所以我想我会在这里发布。*

*他的回应...*

例如，如果您有四个页面：

1.  家
2.  关于
3.  侧边栏
4.  接触

并且您故意希望将侧边栏页面排除在页面导航的一部分之外，您可以像这样排除它：

```
wp_list_pages('sort_column=menu_order&exclude=3&title_li='); 
```

您可以使用 wp_query 语句在要放入它的页面上检索它。

*...这正是我所需要的。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T18:27:26.473

我认为最合乎逻辑的方式是自定义主题。我相信，主题系统很复杂，可以轻松处理这样的事情。至少如果我理解这个问题。

不过，在修改核心系统时要小心。众所周知，WordPress 经常发布新的安全修复程序。

# .net - 带有 (object, EventArgs) 参数的事件回调是 1.1 和 WinForms 的保留吗？

> ID：365354
> 
> 赞同：2
> 
> 时间：2008-12-13T15:50:23.347
> 
> 标签：.net, architecture, coding-style, callback

所以我最近开始玩 FxCop，我注意到的一件事是它坚持认为附加到事件的任何方法都应该采用以下形式

```
void Callback(object sender, EventArgs args) { ...} 
```

并附上

```
MyObject.Event += new EventHandler(Callback); 
```

现在在.Net 1.1 的日子里一切都很好，但从 3.5 开始，我发现只进行 Action 类型的事件调用或其泛型之一，并完全按照我的方式编写方法变得更加容易和直观如果它被显式调用；没有那个对象发送者或EventHandler cruft。

作为一个问题，我认为这是一个平面设计的必要性。如果您为事件回调设计了不同的方法，这意味着该方法至少隐含了一些关于其调用的信息——这是一个主要的禁忌！

我完全愿意接受我可能会遗漏一些东西。你们对此有何看法，FxCop 错了还是我错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T18:56:48.817

你应该遵守约定。

1.  使用通用 EventHandler<T>，其中 T 是 EventArgs 或派生自 EventArgs。与活动挂钩

    MyObject.SomeEvent += new EventHandler<EventArgs>(SomeMethod);

2.  事件处理程序方法应该返回 void（向事件引发者返回一些东西是没有意义的），并且应该遵循在事件 args 中获取带有数据的发送者对象的约定。

“废话”的原因（发送者和事件参数）

*   习俗
*   可扩展性更容易实现（引发事件的类和处理它的类）
*   有时您想知道是谁发送了事件。
*   任何/所有数据都可以封装在事件参数中。
*   您可以对许多事件使用相同的事件处理程序。

该模式进一步延续。您还应该在名为 OnSomeEvent() 的受保护方法中引发事件“SomeEvent”，以便类的派生者可以执行诸如抑制事件之类的操作，以线程安全的方式引发它们，在 UI 线程上引发它们，通过超时引发它们或异常保护，记录事件引发过程等。

嘿，这不是一个完美的模式（也许发件人可能已经被放入事件参数中）但几乎所有的 .Net 代码都遵循它，并且框架代码总是遵循它。为什么不也跟着。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T17:43:32.193

我认为 FxCop 已经很久没有更新了。您是否使用 VS2008 代码分析工具（FxCop 的继任者）尝试过？

# networking - 为什么网络用户界面如此技术性和不直观？

> ID：365366
> 
> 赞同：5
> 
> 时间：2008-12-13T16:05:37.090
> 
> 标签：networking, user-interface

尽管我是一位经验丰富的程序员和工程师，但我发现在处理网络时我总是会遇到繁琐的问题。路由器等的安装很少开箱即用，您会发现自己尝试学习各种首字母缩略词，如 WPA、UPnP 等，并且很难将它们与网络的概念逻辑进行映射。我认为网络尤其如此。解决诸如编译、安装硬件外围设备或在计算机上显示东亚字体之类的问题要容易得多。

为什么网络 UI:s 这么差？网络本质上是否复杂而困难，反映了 UI？由于安全问题？还是这些问题更多是历史性的？或者你完全不同意我的观点？

2009 年 22 月 1 日更新：我认为下面的评论者有一个很好的观点，即家电公司没有能力聘请软件工程师，优先考虑硬件技能。但我觉得在 UI、术语等方面，网络比任何其他类别都差，所以我正在寻找特定于网络的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T16:48:45.693

没有共性。

每个供应商对界面应该是什么样子都有不同的想法，而且经常使用不同的术语。

更不用说大多数设备是在远东制造的，而且无论是文档还是软件界面的翻译通常都很差。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T17:09:10.267

我同意你的观点，配置网络设备和设备是一项相当乏味和无聊的任务。

我相信这归结为对良好用户界面的需求。客户要求消费电子产品提供漂亮的用户界面，而游戏玩家需要在他们的游戏中使用非常直观的游戏界面。由于网络工程可能不会就此向 Cisco 等公司抱怨，因此它的优先级仍然较低。

此外，成本是另一个因素。路由器可以由网络工程师（例如您自己）配置，多年后可能不再需要任何配置。我想像思科这样的公司都知道这一点，并且认为对设计好的用户界面工具的投资是不必要的。他们可以通过在 UI 部门做最低限度的工作来节省很多钱。

话虽如此，Apple 在其消费类无线设备（例如 Airport Extreme）上的 UI 方面做得非常好。UI 是一个看起来不错的实际应用程序，而不是 Web 界面。

从好的方面来说，因为网络用户界面通常很难使用，它可以让你保持工作，并使你的工作更重要（并且薪水更高）。还记得你是唯一可以制造计算机的人的日子吗？我这样做了，而且现在这并不是一项真正的技能，因为几乎任何高中生都可以做到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-24T23:48:14.397

我认为这个问题突出了电信和软件工程之间的历史鸿沟。通常情况下，无法向用户隐藏更多的电信技术问题，因为功能设置可能需要这些细节。此外，电信文档往往对首字母缩写词很重（进一步混淆事物）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T16:13:49.353

因为通常设备的软件是由没有受过软件工程师培训的人完成的；因为为了让这些电器便宜，他们几乎可以节省一切，所以没有专门的用户体验设计师为你服务。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-13T16:57:53.117

正如最新博客 (33) 所述，硬件公司的所有软件都很糟糕。我不相信这仅仅是因为硬件工程师没有像 Joel 所说的那样受过编写好软件的培训，毕竟大多数软件工程师也没有受过编写好软件的培训！
我认为这更多的是市场、金钱和时间——你不会选择嵌入式 uP、DSP、FPGA 甚至是基于它的软件的路由器，所以除了周五下午的最小工作之外，没有任何优势。
你花的越多，它并没有变得更好，你可以花 1 万美元购买一个 uP devkit，它只是一堆 bat 文件，围绕着一些免费的 1980 年代 C 编译器。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-13T17:05:48.450

决定用户友好性的因素有很多。学习起着重要的作用。想想微软office，大多数人都认为他们知道如何使用它。我问我的朋友，他们有多少次被样式设置不当（字体大小、缩进等问题）所困扰。微软office是由软件白痴开发的！

没有了解人类心理的设计师，最仁慈的努力变成了痛苦。我们见过多少次由软件工程师创建的笨拙的演示文稿。这和编程能力有关吗？不，只是优秀的 UI 设计师会开发易于理解的界面。

# c# - 停止 TcpListener 的正确方法

> ID：365370
> 
> 赞同：73
> 
> 时间：2008-12-13T16:12:27.077
> 
> 标签：c#, sockets, networking, tcplistener

我目前正在使用 TcpListener 来处理传入连接，每个连接都有一个线程来处理通信，然后关闭该单个连接。代码如下所示：

```
TcpListener listener = new TcpListener(IPAddress.Any, Port);
System.Console.WriteLine("Server Initialized, listening for incoming connections");
listener.Start();
while (listen)
{
     // Step 0: Client connection
     TcpClient client = listener.AcceptTcpClient();
     Thread clientThread = new Thread(new ParameterizedThreadStart(HandleConnection));
     clientThread.Start(client.GetStream());
     client.Close();
} 
```

该`listen`变量是一个布尔值，它是类上的一个字段。现在，当程序关闭时，我希望它停止监听客户端。设置监听`false`将阻止它接受更多连接，但由于`AcceptTcpClient`是阻塞调用，它至少会占用下一个客户端然后退出。有什么办法可以迫使它在那时就在那里简单地爆发并停止？在另一个阻塞调用运行时调用 listener.Stop() 有什么影响？

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2008-12-13T18:20:53.413

鉴于代码和我认为是您的设计，这是您可以使用的两个快速修复：

## 1\. 线程.Abort()

如果你已经`TcpListener`从另一个线程启动了这个线程，你可以简单地调用`Abort()`线程，这将导致`ThreadAbortException`阻塞调用并向上堆栈。

## 2.TcpListener.Pending()

第二个低成本解决方法是使用该`listener.Pending()`方法来实现轮询模型。然后`Thread.Sleep()`在查看是否有新连接挂起之前使用 a 等待。一旦你有一个挂起的连接，你调用`AcceptTcpClient()`并释放挂起的连接。代码看起来像这样：

```
while (listen) {
     // Step 0: Client connection
     if (!listener.Pending()) {
          Thread.Sleep(500); // choose a number (in milliseconds) that makes sense
          continue; // skip to next iteration of loop
     }
     TcpClient client = listener.AcceptTcpClient();
     Thread clientThread = new Thread(new ParameterizedThreadStart(HandleConnection));
     clientThread.Start(client.GetStream());
     client.Close();
} 
```

## 异步重写

但是，您应该真正为您的应用程序转向非阻塞方法。在幕后，框架将使用重叠的 I/O 和 I/O 完成端口来实现异步调用的非阻塞 I/O。这也不是很困难，它只需要稍微不同地考虑你的代码。

基本上，您将使用该`BeginAcceptTcpClient()`方法开始您的代码并跟踪`IAsyncResult`您返回的内容。您将其指向一个方法，该方法负责获取`TcpClient`并将其传递给*不是*新线程而是传递给 的线程`ThreadPool.QueueUserWorkerItem`，因此您不会为每个客户端请求启动并关闭一个新线程（注意：您可能需要如果您有特别长的请求，请使用您自己的线程池，因为线程池是共享的，如果您垄断了所有线程，则系统实现的应用程序的其他部分可能会被饿死）。一旦侦听器方法启动了您自己的新`TcpClient`请求`ThreadPool`，它就会`BeginAcceptTcpClient()`再次调用并将委托指向自身。

实际上，您只是将当前方法分解为 3 种不同的方法，然后由各个部分调用：

1.  引导一切；
2.  成为调用的目标`EndAcceptTcpClient()`，启动`TcpClient`它自己的线程，然后再次调用自己；
3.  处理客户端请求并在完成后关闭它。

（**注意**：您应该将您的`TcpClient`调用包含在一个`using(){}`块中，以确保即使在发生异常时也会调用方法。或者，您可以将其放在`TcpClient.Dispose()`块的块中。）`TcpClient.Close()``finally``try {} finally {}`

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-10-27T18:19:00.087

`listener.Server.Close()`从另一个线程中断阻塞调用。

```
A blocking operation was interrupted by a call to WSACancelBlockingCall 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-13T18:00:04.407

不要使用循环。相反，在没有循环的情况下调用 BeginAcceptTcpClient()。在回调中，如果您的监听标志仍然设置，只需再次调用 BeginAcceptTcpClient()。

要停止侦听器，由于您没有被阻止，您的代码只需调用 Close() 即可。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-13T20:19:39.417

套接字提供了强大的异步功能。看看[使用异步服务器套接字](http://msdn.microsoft.com/en-us/library/5w7b7x5f.aspx)

这里有几个关于代码的注释。

在这种情况下使用手动创建的线程可能会产生开销。

下面的代码受竞争条件的影响 - TcpClient.Close() 关闭您通过 TcpClient.GetStream() 获得的网络流。考虑关闭客户端，您可以肯定地说不再需要它。

```
 clientThread.Start(client.GetStream());
 client.Close(); 
```

TcpClient.Stop() 关闭底层套接字。TcpCliet.AcceptTcpClient() 在底层套接字上使用 Socket.Accept() 方法，一旦关闭就会抛出 SocketException。您可以从不同的线程调用它。

无论如何，我推荐异步套接字。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-07-23T17:35:35.313

在这里查看我的答案[https://stackoverflow.com/a/17816763/2548170](https://stackoverflow.com/a/17816763/2548170) `TcpListener.Pending()`不是好的解决方案

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-05T18:51:23.083

只是为了添加更多使用异步方法的理由，我很确定 Thread.Abort 不会工作，因为调用在操作系统级别的 TCP 堆栈中被阻止。

另外...如果您在回调中调用 BeginAcceptTCPClient 以侦听除第一个连接之外的每个连接，请注意确保执行初始 BeginAccept 的线程不会终止，否则侦听器将自动被框架处理。我想这是一个功能，但实际上它很烦人。在桌面应用程序中，这通常不是问题，但在 Web 上，您可能想要使用线程池，因为这些线程不会真正终止。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-18T16:57:28.823

上面已经提到过，改用 BeginAcceptTcpClient，异步管理要容易得多。

这是一些示例代码：

```
 ServerSocket = new TcpListener(endpoint);
        try
        {
            ServerSocket.Start();
            ServerSocket.BeginAcceptTcpClient(OnClientConnect, null);
            ServerStarted = true;

            Console.WriteLine("Server has successfully started.");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Server was unable to start : {ex.Message}");
            return false;
        } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-13T16:28:50.600

可能最好使用异步[BeginAcceptTcpClient](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.beginaccepttcpclient.aspx)函数。然后你可以在监听器上调用 Stop() ，因为它不会阻塞。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-06-12T12:22:54.113

一些改变使 Peter Oehlert anwer 完美。因为在 500 毫秒之前，侦听器再次阻塞。要纠正这一点：

```
 while (listen)     
    {
       // Step 0: Client connection     
       if (!listener.Pending())     
       {
           Thread.Sleep(500); // choose a number (in milliseconds) that makes sense
           continue; // skip to next iteration of loop
       }
       else // Enter here only if have pending clients
       {
          TcpClient client = listener.AcceptTcpClient();
          Thread clientThread = new Thread(new ParameterizedThreadStart(HandleConnection));
          clientThread.Start(client.GetStream());
          client.Close();
       }
   } 
```

# css - CSS：两列

> ID：365371
> 
> 赞同：3
> 
> 时间：2008-12-13T16:12:48.637
> 
> 标签：css, layout

我不知道如何用 CSS 实现以下布局（可能是因为我实际上并不了解 CSS）。

我有一堆这样的div：

```
<div class="right"> <p>1</p> </div>
<div class="left">  <p>2</p> </div>
<div class="left">  <p>3</p> </div>
<div class="left">  <p>4</p> </div>
<div class="right"> <p>5</p> </div>
<div class="right"> <p>6</p> </div> 
```

（不是真实内容）

现在我希望布局看起来像两列相等的 div，右边是“右”，左边是“左”，因此：

```
2 1
3 5
4 6 
```

[**编辑：在这个问题的先前版本中，我在 div 中有文本区域，并且 div 都有不同的名称，如“one”和“xyz”。**] 我尝试过类似的东西

```
div.right { width:50%; float:right; clear:right; }
div.left { width:50%; float:left; clear:left;} 
```

但它并不完全有效：它会产生类似的东西：

```
2 1
3 
4 5
  6 
```

（没有“clear”，它会愉快地产生

```
2 1
3 4
6 5 
```

这不是想要的）。

很明显，如果 div 的顺序不同，它可以工作，但我不想这样做（因为如果浏览器有 Javascript，这些 div 是动态生成的，我不想改变实际的顺序出于语义原因，在没有 Javascript 的情况下显示）。是否仍然可以实现我想要的布局？

[对于它的价值，我愿意让它不能在 IE 或旧版本的其他浏览器上运行，所以如果有一个只适用于标准兼容浏览器的解决方案，那没关系 :-)]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T16:38:26.573

以下在 Firefox 3 中适用于我：

```
div {
  width: 198px;
  border: 1px solid black;
}
div.onediv, div.tendiv, div.xyzdiv { float: right; }
div.twodiv, div.abcdiv, div.pqrdiv { float: left; }
```

```
<div style="width: 400px;">
  <div class="onediv"><p>One name</p> <textarea id="one"></textarea></div>
  <div class="twodiv"><p>Two name</p> <textarea id="two"></textarea></div>
  <div class="tendiv"><p>Ten name</p> <textarea id="ten"></textarea></div>
  <div class="abcdiv"><p>Abc name</p> <textarea id="abc"></textarea></div>
  <div class="xyzdiv"><p>Xyz name</p> <textarea id="xyz"></textarea></div>
  <div class="pqrdiv"><p>Pqr name</p> <textarea id="pqr"></textarea></div>
</div>
```

只是一个简短的说明：放入`div`你的类名（即 abcdiv）有点多余和奇怪。如果不对正确的班级使用进行大规模的诽谤，我会忽略它。

如果您只说“col1”和“col2”，您实际上可以简化您的代码。这样，如果您愿意，您甚至可以稍后交换列：

```
div {
  width: 198px;
  border: 1px solid black;
}
div.col1 { float: right; }
div.col2 { float: left; }
```

```
<div style="width: 400px;">
  <div class="col1"><p>One name</p> <textarea id="one"></textarea></div>
  <div class="col2"><p>Two name</p> <textarea id="two"></textarea></div>
  <div class="col1"><p>Ten name</p> <textarea id="ten"></textarea></div>
  <div class="col2"><p>Abc name</p> <textarea id="abc"></textarea></div>
  <div class="col1"><p>Xyz name</p> <textarea id="xyz"></textarea></div>
  <div class="col2"><p>Pqr name</p> <textarea id="pqr"></textarea></div>
</div>
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-10T18:24:31.417

### 解决方案 1

如果您有能力复制 HTML：

```
.left-column .right, .right-column .left {
    display: none;
} 
```

### 解决方案 2

稍等一下，直到浏览器支持[CSS3](http://www.w3.org/TR/2007/WD-css3-gcpm-20070205/#named0)：

```
.right {
    position: flow(side); 
} 
```

### 解决方案 3

如果您的 div 具有相同的高度，请使用[**间接相邻的兄弟组合器**](http://www.w3.org/TR/css3-selectors/#general-sibling-combinators)。尽管它属于 CSS Level 3，但它已经得到了[很好的支持](http://eriwen.com/css/css-indirect-adjacent-combinator/)：

```
.container {
    position: relative;
}

.left, .right {
    position: absolute;
    top : 0;
    width: 50%;
} 

.left {
    left: 0;
}

.right {
    left: 50%;
}

.left ~ .left, .right ~ .right {
    top : 100px;
}

.left ~ .left ~ .left, .right ~ .right ~ .right {
    top : 200px;
}

.left ~ .left ~ .left ~ .left, .right ~ .right ~ .right ~ .right {
    top : 300px;
}

... /* you need to include as many rules as the maximum possible height */ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-15T22:52:05.177

*我将保留此答案的其余部分，以便其他人可以看到我最初的想法，但这种方法实际上失败了，并且要求浮动元素总是比没有浮动元素多。*

我认为这是您的解决方案（未经测试）。

```
.left { width: 51%; float: left; }
.right { width: 49%; } 
```

51% 阻止它们彼此相邻浮动，然后让所有 .right 内容包裹在这些浮动块周围。

不经常思考会给你更多的 HTML/css，而且再次 - 不使用表格进行布局。

===[编辑]===

我对此进行了测试，它确实可以进行一些调整，并且如果您知道第一个项目向左浮动（或向右浮动以反转行为）。

```
<style>
  div div { text-align: center; padding: 20px 0; overflow: hidden; }
  .left { width: 251px; float: left; background: red; }
  .right { width: 249px; background: green; }
</style>
<div style="width: 500px;" >
  <div class="left"> <p>1</p> </div>
  <div class="right">  <p>2</p> </div>
  <div class="left">  <p>3</p> </div>
  <div class="left">  <p>4</p> </div>
  <div class="right"> <p>5</p> </div>
  <div class="right"> <p>6</p> </div>
</div> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T16:38:09.833

您尝试将输入流分成两个独立的流，我认为 CSS 不允许您这样做。使用左右浮动是一个聪明的主意，但它并不总是有效。[CSS 规范](http://www.w3.org/TR/2006/WD-CSS21-20061106/visuren.html#float-position)在 9.5.1 规则 5 中说：

> 浮动框的外部顶部不得高于源文档中早期元素生成的任何块或浮动框的外部顶部。

因此，您的花车可以向左、向右和向下跳跃，但不能向上跳跃。

您可以通过绝对定位来实现所有目标，但这并不是自动的。

编辑：我在评论中说我不希望 CSS3 支持这样的功能，因为它违反了内容和布局的分离。后来，我想起[CSS3 计划有脚注](http://www.w3.org/TR/2007/WD-css3-gcpm-20070205/#footnotes)。因此，如果您用“float: note”标记某些 div，则选定的 div 将流入页面的一个单独的“脚注”区域。我想您可以将它们放在布局其余部分的右侧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-15T20:46:39.860

## 你有 Javascript - 为什么不使用它？

你这样说：

> 如果浏览器有 Javascript，这些 div 是动态生成的，出于语义原因，我不想更改在没有 Javascript 的情况下显示的实际顺序......

`<div>`如果用户有 Javascript，您只会显示这些s -**为什么不使用 Javascript 重新排列它们？**如果您将#4 移到#5 之后，那么您当前的 CSS 看起来不错。

所以（使用 jQuery）：

```
$("div:eq(3)").remove().insertAfter("div:eq(4)"); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-13T17:29:12.567

当我遇到这种问题时，我通常会使用表格。

```
<table>
    <tr>
        <td>
            <p>One name</p> <textarea id="one"></textarea>
        </td>
       <td>
            <p>XYZ name</p> <textarea id="xyz"></textarea>
        </td>
    </tr>
   ....
 </table> 
```

Alignement 与所有浏览器完美配合。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T22:54:51.627

我对纯 css 方法不起作用感到内疚，但如果你不介意使用 JavaScript 来获得你想要的东西，那么这里有一些 jQuery 可以工作（其他人可能会清理这个你如果你不喜欢臃肿）。

```
<style>
  #container { width: 500px; border: 1px grey solid; overflow: hidden; }
  #container .rightSide { width: 250px; float: right; }
  #container .left { width: 250px; background: red; padding: 20px 0; overflow: hidden; text-align: center; }
  #container .right { width: 250px; background: green; padding: 20px 0; overflow: hidden; text-align: center; }
</style>
<script type="text/javascript">
$(document).ready(function() {
  $('#container').prepend('<div class="rightSide"></div>');
  $('#container div.right').each(function() {
    var $rightContent = $(this).remove().html();
    $('.rightSide').append('<div class="right">' + $rightContent + '</div>');
  });
});
</script>
<div id="container" >
  <div class="right"> <p>1</p> </div>
  <div class="left">  <p>2</p> </div>
  <div class="left">  <p>3</p> </div>
  <div class="left">  <p>4</p> </div>
  <div class="right"> <p>5</p> </div>
  <div class="right"> <p>6</p> </div>
</div> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-13T16:28:00.323

如果你摆脱清除它工作正常。无论出于何种原因，中间似乎有一些重叠（舍入误差？）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-13T22:27:31.373

也许您可以使用绝对定位？这当然取决于页面结构的其余部分，但通常这是非常可行的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-13T17:38:20.503

对于这个恕我直言，表格是一个完全可以接受的解决方案。

对表格的强烈反对是针对在整个站点布局中使用它们。但是如果你需要在行和列中显示你的数据......这就是表格的用途:)

如果您仍然对可行的跨浏览器 CSS 解决方案感兴趣，我会考虑使用框架。这将节省您尝试让您的页面看起来正确的时间。

[http://www.blueprintcss.org/](http://www.blueprintcss.org/)是一个优秀的框架恕我直言。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-10T18:31:54.257

查看[960 网格系统](http://960.gs/)。我过去在项目中使用过它，我不得不说它工作得很好。不仅如此，它易于使用并且跨浏览器保持一致：D

使用这个框架：

```
<html>
    <head>
        <link rel="stylesheet" type="text/css" media="all" href="css/reset.css" />
        <link rel="stylesheet" type="text/css" media="all" href="css/text.css" />
        <link rel="stylesheet" type="text/css" media="all" href="css/960.css" />
     </head>
     <body>
     <div class="container_16">
         <div class="grid_1 alpha" style="text-align:center;">
            2
         </div>
         <div class="grid_1 omega" style="text-align:center;">
            1
         </div>
         <div class="clear"></div>
         <div class="grid_1 alpha" style="text-align:center;">
            4
         </div>
         <div class="grid_1 omega" style="text-align:center;">
            3
         </div>
         <div class="clear"></div>
         <div class="grid_1 alpha" style="text-align:center;">
            5
         </div>
         <div class="grid_1 omega" style="text-align:center;">
            4
         </div>
    </div>
</body>
</html> 
```

[替代文字 http://img40.imageshack.us/img40/6889/cd3cc920a04b80e06b8efef.png](http://img40.imageshack.us/img40/6889/cd3cc920a04b80e06b8efef.png)

文本顶部的栏来自我的浏览器，而不是 CSS 或布局的一部分。

# django - Flex HTTPservice 和 POST，发送文件？

> ID：365376
> 
> 赞同：2
> 
> 时间：2008-12-13T16:15:45.917
> 
> 标签：django, apache-flex, http

我使用基本的 Post 将数据发送到 Django 服务器。

数据由 flex 组件动态创建的 base64 编码的 640*380 PNG 图像组成。

```
<mx:HTTPService id="formSend" showBusyCursor="true" 
    useProxy="false" url="http://127.0.0.1/form/" 
    method="POST" result="formSentConfirmation(event)"    fault="formSendingFailed(event)"/>

private function sendForm(url:String, message:String, meteo:Number):void {
    formSend.url = url;
    var params:Object = { message: message, image_data: getEncodedImage() }; 
    snapButton.label = "sending ...";
    formSend.send(params);
} 
```

在服务器端，我可以看到数据在 request.POST 而不是 request.FILES 中。这意味着图像不会作为具有多重编码 HTTP 的文件发送。

1.  我会在真正的服务器上遇到麻烦吗？因为 urlencoded POST var 的限制是 200k。

2.  如何让 HTTPservice 将数据作为文件发送？

3.  还有其他解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-09-24T13:57:24.030

发现了一些我们无法挖掘的有趣的东西。用这个：

```
var urlLoader:URLLoader = new URLLoader();
    urlLoader.dataFormat = URLLoaderDataFormat.BINARY;
    urlLoader.data = _img.data;
    urlLoader.addEventListener(Event.COMPLETE,LoadedComplete);

    var request:URLRequest = new URLRequest("www.url.com?toto=toto");
    request.method = URLRequestMethod.POST
    request.contentType = "multipart/form-data";
    request.data = _img.data;
    request.requestHeaders = new Array(new URLRequestHeader("toto", "toto"));

    urlLoader.load(request); 
```

好吧，我在 C# 服务器端得到了一些东西，请求内容长度不是空的，我在参数和标题中得到了 toto，文件收集中的一个问题没有发送文件......发送的字节在哪里？？？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T11:54:35.583

1.  可能是。这取决于您是否对文件大小施加硬限制以及目标页面如何处理请求。

2.  我不相信这实际上是可能的。

3.  读[这个](http://livedocs.adobe.com/flex/201/html/wwhelp/wwhimpl/common/html/wwhelp.htm?context=LiveDocs_Book_Parts&file=17_Networking_and_communications_173_8.html)。FileReference 是上传文件的推荐方式。

# wpf - 在 WPF 中显示动态数据的好方法是什么？

> ID：365378
> 
> 赞同：8
> 
> 时间：2008-12-13T16:16:37.630
> 
> 标签：wpf, data-binding

我正在努力寻找处理具有动态数据更新的 WPF 应用程序的最佳方法。我是否应该使用 WPF 提供的丰富数据绑定？

我将在下面的讨论中尽可能简化我的问题域，并简要提及一些解决方案。我对这个社区可以提供的任何评论都非常感兴趣。

**简化的问题域**：假设您有一个包含大约 1,000 个项目的系统，每个项目都有一个唯一的“<em>name”，以及一个动态的“<em>speed”和“<em>location”。这些项目的数据每秒更新 60 次。您希望在各种 UI 中向用户显示这些数据——从“显示数字的标签”到图形刻度盘/仪表/仪表/等。WPF 的完美工作——将视觉效果与应用程序的其余部分分开。你会如何设计这个系统？

**我的第一个解决方案**：我的第一个解决方案是定义一个名为“<em>DataItem”的具有速度和位置属性（双精度）的对象，定义一个具有*名称*属性（字符串）的接口。显示数据的控件必须实现名称接口，创建了一个“DataManager”，用于扫描实现该接口的 FrameworkElements，在初始化时构建一个名称/FrameworkElements 对的列表。然后，每秒 60 次更新 1,000 个 DataItems 的列表，并将每个匹配的 FrameworkElement 的 DataContext 设置为 DataItem 对象。这行得通，性能是可以接受的（特别是如果数据并不总是在变化）。

我的第二个解决方案解决了第一个解决方案中的 UI 控件都必须实现一些接口的问题 - yuk。我想使用开箱即用的未修改的 WPF 控件（在某些情况下）。所以，第二个解决方案是定义一个“附加属性”（我把它放在 DataManager 对象上），所以你可以 - 在 xaml 中 - 做类似的事情

```
<Label DataManager.Name = "objectname"  Content="{Binding}" /> 
```

不知何故，这个解决方案似乎仍然不正确。我的第三个解决方案是研究实现自定义 DataSourceProvider。我没有成功。我无法理解数据源提供者模型，以及在这种情况下如何使用它。

现在，我正在查看 Microsoft Research 发布的 CodePlex “动态数据显示”项目。该项目是关于绘制/绘制动态数据的，但那里可能有一些想法。所以我在 StackOverflow 上——通常是一个有简短问题和快速答案的地方。:-)

我对 WPF 非常陌生，如果有人对这些问题有任何想法，我将不胜感激。请记住，此处指定的问题域已简化，因此我需要一个可靠的解决方案。实际上有许多不同类型的数据对象，每种都有不同的属性；每个对象的数据更新速率不同，UI控件显示单个项目和项目组，数据来自多个来源等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-13T17:08:35.587

您快到了。您希望在两个级别上进行数据绑定。

首先 - 让您的*DataItem*实现`INotifyPropertyChanged`或让它们派生`DispatchingObject`并实现您要绑定到的每个值的依赖属性

第二 - 将所有*DataItem*保存在其中一个`ObservableCollection<DataItem>`或 DataTable 中。`INotifyCollectionChanged`您需要一个支持或的集合`IBindingList`。

第三 - 使用某种容器控件（列表框、第三层网格控件等）将*DataItem*列表绑定到您的应用程序

第四 - 定义 a`DataTemplate`为每个*DataItem* s 提供视觉外观

第五 - 如果需要，使用 a`DataTemplateSelector`为不同类型的 DataItem 动态选择*DataTemplate*

这里有一些 xaml 可以帮助您入门

```
<ListBox ItemsSource="{Binding ...}" ItemTemplateSelector="{StaticResource DTSelector}"> 
```

# mysql - 大主键：1+ 十亿行 MySQL + InnoDB？

> ID：365380
> 
> 赞同：5
> 
> 时间：2008-12-13T16:18:12.760
> 
> 标签：mysql, indexing, twitter, large-data-volumes

我想知道 InnoDB 是否是格式化表格的最佳方式？该表包含一个字段，主键，并且该表每天将获得 816k 行（估计）。这将很快变得非常大！我正在研究一种文件存储方式（这会更快吗）？该表将存储已处理的 Twitter ID 的 ID 号？

`SELECT min('id')`此外，对语句的任何估计内存使用情况？非常感谢任何其他想法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T16:55:59.563

我建议您开始按 ID 或日期对表进行[分区。](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html)分区根据一些定义的逻辑（比如按日期范围拆分）将一个大表拆分为几个较小的表，这使得它们在性能和内存方面更易于管理。MySQL 5.1 内置了这个特性，或者您可以使用自定义解决方案来实现它。

在平面文件中实现存储时，您将失去数据库的所有优势——您不能再执行涉及数据的查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T22:14:57.310

唯一确定的答案是尝试两者并测试，看看会发生什么。

通常，MyISAM 的写入和读取速度更快，但不能同时进行。当您写入 MyISAM 表时，整个表将被锁定以完成插入。InnoDB 有更多的开销，但使用了行级锁定，因此可以同时进行读取和写入，而不会出现 MyISAM 的表锁定引起的问题。

但是，如果我理解正确，您的问题会有所不同。只有一个列，该列作为主键在 MyISAM 和 InnoDB 处理主键索引的不同方式中具有重要的考虑。

在 MyISAM 中，主键索引就像任何其他二级索引一样。在内部，每一行都有一个行 ID，索引节点只指向数据页的行 ID。主键索引的处理方式与任何其他索引不同。

然而，在 InnoDB 中，主键是集群的，这意味着它们保持连接到数据页，并确保行内容根据主键在磁盘上保持物理排序（但仅在单个数据页内，它们本身可能分散在任何顺序。）

在这种情况下，我希望 InnoDB 可能具有优势，因为 MyISAM 基本上必须做双重工作——在数据页中写入一次整数，然后在索引页中再次写入。InnoDB 不会这样做，主键索引将与数据页相同，并且只需要写入一次。它只需要在一个地方管理数据，而 MyISAM 无需管理两个副本。

对于任一存储引擎，在索引列上执行诸如 min() 或 max() 之类的操作应该是微不足道的，或者只是检查索引中是否存在数字。由于该表只有一列，因此甚至不需要书签查找，因为数据将完全在索引本身中表示。这应该是一个非常有效的索引。

我也不会担心桌子的大小。在行宽只有一个整数的情况下，每个索引/数据页可以容纳大量行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T16:38:07.180

如果这些 ID 号单调递增并且您的写入仅附加数据（从不修改），则使用单个文件可能会快得多。A `SELECT min('id')`then 只是读取文件的第一行，其他任何内容都是二进制搜索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T17:39:48.863

如果您的 id 列上有索引，则 select min(id) 应该是 O(1)，对此应该没有太多的内存要求。

如果你的主键在 twitter id 上，那么你就有一个索引。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T20:52:48.553

MySQL Dev zone上有一个很好的存储引擎比较：

*   [MySQL 存储引擎架构，第 1 部分：概述](http://dev.mysql.com/tech-resources/articles/storage-engine/part_1.html)
*   [MySQL 存储引擎架构，第 2 部分：深入了解](http://dev.mysql.com/tech-resources/articles/storage-engine/part_2.html)
*   [MySQL 存储引擎架构，第 3 部分：详细信息和比较](http://dev.mysql.com/tech-resources/articles/storage-engine/part_3.html)

根据您的描述，我会说 MyISAM 会更好，但这在很大程度上取决于您应用程序的比较读写模式。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-13T22:20:01.280

使用一个字段作为主键，只添加记录，这并不适合常规数据库。

首先，您存储的信息是您需要的两倍，每个字段都进入数据表和索引。

顺便说一句，之所以称为关系数据库，是因为它们将相关数据存储在一行中；很难看出您的数据是如何合格的 :-) 如果您还要存储其他东西，那么数据库将是值得的。

你没有提到数据是否会被多个进程同时访问——如果没有，那么你就不需要数据库 ACID 原则赋予的所有优势。即使您确实需要 ACID，仍然可以在没有完整数据库的情况下实现。

我的第一个想法是构建自己的 B-tree 或 B+-tree 数据文件来存储 twitter ID 以避免数据重复。我能看到你做的唯一查询（基于问题）是：

*   从 tbl 中选择 min(id)；和
*   从 tbl 中选择 id，其中 id = ？

第一个可以通过简单地将最低的存储在 B 树结构之外的另一个文件中（并在获得较低的文件时替换它）来实现 O(1)。我不确定这个的商业案例，除非它是为了快速找出某个 twitter ID 不在表中（所以在这种情况下你可能也想要 max ）。

第二个是标准的树搜索技术，这是数据库通常在幕后使用的技术。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-02-06T19:05:15.040

我还看到一些贸易公司使用分时数据库，即。kdb+ [http://kx.com/](http://kx.com/)

# javascript - 画布从底部中心图像角度旋转？

> ID：365382
> 
> 赞同：15
> 
> 时间：2008-12-13T16:21:00.850
> 
> 标签：javascript, html, canvas, rotation

如何从底部中心角度旋转带有 canvas html5 元素的图像？

```
<html>
    <head>
        <title>test</title>
        <script type="text/javascript">
            function startup() {
                var canvas = document.getElementById('canvas');
                var ctx = canvas.getContext('2d');
                var img = new Image();
                img.src = 'player.gif';
                img.onload = function() {
                    ctx.translate(185, 185);
                    ctx.rotate(90 * Math.PI / 180);
                    ctx.drawImage(img, 0, 0, 64, 120);
                }
            }
        </script>
    </head>
    <body onload='startup();'>
        <canvas id="canvas" style="position: absolute; left: 300px; top: 300px;" width="800" height="800"></canvas>
    </body>
</html> 
```

不幸的是，这似乎从图像的左上角旋转它。任何的想法？

编辑：最后，物体（太空船）必须像时钟指针一样旋转，就好像它在向右/向左转动一样。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-12-13T16:51:04.083

首先，您必须翻译到您想要旋转的点。在这种情况下，图像尺寸为 64 x 120。要围绕底部中心旋转，您需要转换为 32、120。

```
ctx.translate(32, 120); 
```

这会将您带到图像的底部中心。然后旋转画布：

```
ctx.rotate(90 * Math.PI/180); 
```

旋转 90 度。

然后，当您绘制图像时，请尝试以下操作：

```
ctx.drawImage(img, -32, -120, 64, 120); 
```

? 那样有用吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-14T10:01:19.337

正确的答案当然是文森特的答案。
我对这个旋转/平移的事情有点摸索，我认为我的小实验可能会很有趣：

```
<html>
  <head>
    <title>test</title>
    <script type="text/javascript">
    canvasW = canvasH = 800;
    imgW = imgH = 128;
    function startup() {
      var canvas = document.getElementById('canvas');
      var ctx = canvas.getContext('2d');
      // Just to see what I do...
      ctx.strokeRect(0, 0, canvasW, canvasH);
      var img = new Image();
      img.src = 'player.png';
      img.onload = function() {
        // Just for reference
        ctx.drawImage(img, 0, 0, 128, 128);
        ctx.drawImage(img, canvasW/2 - imgW/2, canvasH/2 - imgH/2, 128, 128);
        mark(ctx, "red");
        // Keep current context (transformations)
        ctx.save();
        // Put bottom center at origin
        ctx.translate(imgW/2, imgH);
        // Rotate
        // Beware the next translations/positions are done along the rotated axis
        ctx.rotate(45 * Math.PI / 180);
        // Mark new origin
        mark(ctx, "red");
        // Restore position
        ctx.translate(-imgW/2, -imgH);
        ctx.drawImage(img, 0, 0, imgW, imgH);
        mark(ctx, "green");
        // Draw it an wanted position
        ctx.drawImage(img, canvasW/2, canvasH/3, imgW, imgH);
        // Move elsewhere:
        ctx.translate(canvasW/2, canvasH/2);
        ctx.drawImage(img, 0, 0, imgW, imgH);
        mark(ctx, "blue");
        ctx.restore();
      }
    }
    function mark(ctx, color) {
     ctx.save();
//~      ctx.fillStyle = color;
//~      ctx.fillRect(-2, -2, 4, 4);
     ctx.strokeStyle = color;
     ctx.strokeRect(0, 0, imgW, imgH);
     ctx.restore();
    }
    </script>
  </head>
  <body onload='startup();'>
    <canvas id="canvas" style="position: absolute; left: 300px; top: 300px;" width="800" height="800"></canvas>
  </body>
</html> 
```

我的绊脚石是定位旋转的图形很困难，因为它是沿着旋转轴的：要么我们必须做一些三角数学来在原始原点上绘画，要么我们必须在第二个隐藏的画布上绘画，然后在上面绘画目标之一。
除非别人有更好的主意？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T18:40:38.597

当我需要从指定点（中心）开始旋转文本时，我使用过这个？

```
ctx.save(); 
ctx.translate(x,y);
ctx.rotate(degree*Math.PI/180);
ctx.translate(-x,-y);   
ctx.fillText(text,x,y); 
ctx.stroke();   
ctx.restore(); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-01-07T23:04:03.827

```
<html>
  <head>
    <title>Canvas Pinball flippers by stirfry</title>
    <script type="application/x-javascript">
     /*THIS SCRIPT ADAPTED BY STIRFRY. SOURCE TEETHGRINDER no warranty or liability implied or otherwise. use at your own risk. No credit required. Enjoy.stirfry.thank(you)*/
    var img = new Image();
                            //img.src = "flipper.gif";//right
    img.src="http://i39.tinypic.com/k1vq0x.gif"
    var img2 = new Image();
                             //img2.src = "flipper2.gif";//left
    img2.src ="http://i42.tinypic.com/14c8wht.gif"
    var gAngle = 0;
    gAngle = 60;
    stop = false;
    inertia = .8;
    vel = 10;
    k = 0.1;

    function drawagain(){
      gAngle = 60;
      stop = false;
      inertia = .8;
      vel = 10;
      k = 0.1;
     draw()
   }

   function draw(){
     var ctx = document.getElementById('canvas').getContext('2d');
     ctx.save();

        vel = ( vel * inertia ) + ( -gAngle * k );

        gAngle += vel;

        ctx.fillStyle = 'rgb(255,255,255)';
        ctx.fillRect (0, 0, 600, 600);

        ctx.translate(380, 480);              //location of the system
        ctx.rotate( gAngle * Math.PI / 180 );//rotate first then draw the flipper
        ctx.drawImage(img, -105, -16); 
ctx.restore();
ctx.save();
        ctx.translate(120, 480);              //location of the system
        ctx.rotate( -1*gAngle * Math.PI / 180 );//rotate first then draw the flipper
        ctx.drawImage(img2, -18, -16); 

ctx.restore();

        if( !stop )
          setTimeout(draw, 30);
      }

    </script>
    <style type="text/css">
      body { margin: 20px; font-family: arial,verdana,helvetica; background: #fff;}
      h1 { font-size: 140%; font-weight:normal; color: #036; border-bottom: 1px solid #ccc; }
      canvas { border: 2px solid #000; float: left; margin-right: 20px; margin-bottom: 20px; }
      pre { float:left; display:block; background: rgb(238,238,238); border: 1px dashed #666; padding: 15px 20px; margin: 0 0 10px 0; }
      .gameLayer {position: absolute; top: 0px; left: 0px;}
      #scoreLayer {font-family: arial; color: #FF0000; left: 10px; font-size: 70%; }
      #windowcontainer {position:relative; height:300px;}
    </style>
  </head>

  <body onload="draw()">
    <div id="windowcontainer">
      <canvas id="canvas" width="500" height="500"></canvas>
      <INPUT VALUE="flip" TYPE=BUTTON onClick="drawagain();"><br/>
    </div>

  </body>
</html> 
```

# python - 在另一个函数中运行一个函数 N 次

> ID：365384
> 
> 赞同：0
> 
> 时间：2008-12-13T16:24:07.303
> 
> 标签：python

我以前问过这种问题，但由于我的英语不好，我之前的问题似乎有点误导。我再次要求澄清。我真的很困惑。提前致谢。

假设我有一个函数 A 用于在某个规则中生成一个单元格的状态，并且我有另一个函数生成一个单元格的状态 N 次，每次规则与第一个函数相同。而且，是的，不知道该怎么做...

```
def 1st_funtion(a_matrixA)
    #apply some rule on a_matrixA and return a new matrix(next state of the cell)
    return new_matrix

def 2nd_funtion(a_matrixB,repeat_times=n)
    #how to import the 1st_funtion and run for n times and return the final_matrix?
    #I know if n=1, just make final_matrix=1st_funtion(a_matrixB)
    return final_matrix 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T16:37:41.877

```
def 1st_funtion(a_matrixA)
    #apply some rule on a_matrixA and return a new matrix(next state of the cell)
    return new_matrix

def 2nd_funtion(a_matrixB,repeat_times)

    for i in range(repeat_times):
        a_matrixB = 1st_funtion(a_matrixB)
    return a_matrixB 
```

# refactoring - 重构：你什么时候知道是时候了，什么时候做？

> ID：365387
> 
> 赞同：5
> 
> 时间：2008-12-13T16:25:52.557
> 
> 标签：refactoring, project-planning

你什么时候知道是时候重构/审查一些代码了？更好的是，你什么时候做？

可能像其他人一样，我发现自己知道某些事情需要重构/审查，但截止日期和管理没有时间去做。我还想听听您如何在一般开发过程中包含代码审查。

最近我发现自己在开发新功能/代码之前就这样做了。例如，如果我必须在应用程序的模块 X 中开发新内容或更改某些内容，我会对该模块进行代码审查。我发现它还可以帮助我更好地理解模块，这样我就可以更轻松地进行更改。

那么你什么时候知道是时候了，什么时候做呢？最重要的是，您如何将其纳入项目规划中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-13T16:29:36.963

重构不是我留出时间单独做的事情。当我开发新代码或维护旧代码时，我一直在这样做。将其融入您的日常工作中，并始终在代码中寻找可以改进的地方。

为了回应您在自己对这个问题的回答中添加的具体案例：我认为您的情况是一个很好的例子，说明什么时候重构而不是完全重写是个好主意。在更改一行代码*之前*，请确保为有问题的代码编写了一组好的测试用例。如果代码未通过某些测试，它将用于三个目的。首先，它会给你特定的领域来集中你的努力。其次，它将为您（向您的老板）提供编写代码的可靠理由。第三是您希望在重构代码时使用的标准单元测试安全网。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-13T16:29:13.643

标准的 TDD 方式是 Red-Green-Refactor：做一个失败的测试，编写代码以通过测试，然后在仍然通过测试的同时重构现有代码。重构发生在测试通过之后，当你发现代码太复杂或使用了错误的模式时。重构应该是您日常开发过程的一部分，而不是开发周期结束时的附加组件。我认为，将重构保持在较小的范围内效果会更好。将其作为日常活动的一部分来防止糟糕的代码在重构发生之前变得太大——至少理想情况下是这样。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-13T16:52:52.550

我倾向于看到“代码气味”，就像我一遍又一遍地重复相同的代码，或者我看到一些让我思考的东西，“必须有更好的方法来做到这一点，我会去寻找它。” 这是我编写代码的一部分，我认为拥有好的代码可能需要更长的时间才能完成，但它更容易扩展、可维护，或者让其他人接受它而不必花钱，这在某种程度上是一件好事几天弄清楚我在代码中做了什么。

如果您正在继承代码，那么我倾向于认为有两种关于如何处理它的思想流派：

1）保持距离。您可以在此处进行必要的更改以获取该功能并且不再执行此操作。如果您知道该模块将很快被替换，或者您每年只在此工作一次或两次，那么我可以看到不想花大量时间修复它的逻辑。

2）让自己沉浸其中并立即修复它。如果您所做的是相当广泛的更改或者是您将定期使用的一段代码，那么它可能被视为进行一些重构或文档的维护的一部分，或者您想描述哪里有错误的代码变成了不那么糟糕的代码，因为这将在以后节省您的时间。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T16:33:09.843

重构是我在开发过程中不断做的事情，而不是我计划的事情。每当代码表明它可以以某种方式更好地结构化时，我都会进行适当的更改。

你永远不能期望得到完全正确的设计。实际的细微差别在实现过程中显露出来，通过不断重构，您始终努力获得更好的设计和分解代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-13T16:45:56.870

我认为正确的答案是：**总是**！在开发新功能时，如果我看到一段可以重构的代码，我就去做。因为我使用 TDD，所以我不担心旧功能会停止工作。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-13T16:53:24.093

当你的代码[有异味时](http://www.amazon.co.uk/Refactoring-Improving-Design-Existing-Technology/dp/0201485672/ref=sr_1_1?ie=UTF8&s=books&qid=1229187193&sr=8-1)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T16:33:35.177

除非我知道我将要复制代码，否则我通常不会这样做。因此，在编写新功能时，如果我发现自己说“嗯，我在其他地方做过类似的事情......”我会尝试看看如何重构原始功能以实现尽可能多的代码重用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-13T16:39:35.493

我一边进行重构，一边尝试保持快速和安全 - 代码区域测试得越好，我可以快速安全地完成更多工作。

此外，我标记了我认为需要进行更大检查的领域或架构问题，并尝试单独安排这些更大的会话——通常，使它们变得更大的原因是缺乏测试，这意味着我必须花一些时间来添加我需要的那些测试.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-13T16:43:47.810

解决一个具体问题：有一个项目在几个月内编写了一些糟糕的代码（甚至是由不再在公司工作的人编写的）。完全重写是不可行的，我无法向客户或管理层解释。

所以我想知道在这种情况下是否可以接受在对该模块进行更改之前重构某个模块。

我知道这不是最好的情况，但上下文是一种特殊情况（代码已经损坏，无法全部重写）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-13T17:10:20.593

我会说我也在寻找代码气味，但我想更具体一些。我正在使用我的设计框架，该框架随着每个项目的发展而不断发展。我将倾向于在项目的早期进行大量重构和重新设计（训练自己将这些分开是我仍在努力的事情），随着我接近截止日期并接近解决任何问题或代码异味，我会放松并专注于我的具体实现。当我这样做时，我通常会发现（或创造）更多的东西，虽然功能性，但我并不完全满意。我将记录这些，并在我的下一次迭代项目中解决这些问题。

当我回到代码时，有时我会发现有一种更优雅的方式来处理这种情况，并为自己没有早点看到它而自责。有时，我会发现有更好的方法，但这不是我最初设想的方式。有时我发现它的方式很好，而改变它会过度设计。其他时候，我发现在修复其他问题时，我原来的问题已经消失了。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-13T17:14:39.867

1.  当我准备对代码进行功能性更改（功能、错误修复、性能等）时，我首先会问自己，如果代码具有理想的结构以进行更改，它会是什么样子。

2.  然后我朝着那个方向重构

3.  我现在进行功能更改。

4.  最后，我再次重构以清理我的更改带来的丑陋。

我总是想平衡我的重构工作与其他因素（截止日期、这段代码的重要性、测试覆盖率等）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-13T17:58:53.520

如果您不需要更改该代码（它可以工作，无需扩展它），请不要这样做。随它去。换句话说，如果它需要更改，请编写一些测试重构它并包含您的更改。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-13T18:01:18.570

我认为自己是一名新手程序员（目前我一直以编程为生仅 6 个月）并且我注意到，只要查看代码，您就应该感觉到它是否需要重构。

据我了解，有些人将此称为“代码气味”，但我会说这更像是一种不公平的感觉，即您没有尽自己最大的努力来处理您正在关注的代码。您可能不确定该做什么或如何改进代码，但如果您对代码不完美有一点怀疑，那么它很可能不是。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-13T18:03:58.317

您通常可以使范围比模块更小。有时单个函数显然是单独重构的候选者，即使它只是重命名局部变量，通过使代码自我解释来消除对注释的需求，诸如此类。

如果您可以确定需要更改的区域，请在进行更改之前和期间清理该区域。我经常发现我需要执行一些重构才能对代码有足够的理解才能进行更改。

不过，我会向其他所有说要围绕代码进行某种测试的人添加我的声音。尝试至少涵盖一组合理的“正常”案例并实现一些自动化（几乎每种语言都有可用的框架），以便在每次小的更改后轻松快速地运行测试。当我第一次开始我的代码清理活动时，我希望我能想到/知道测试框架......

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-13T18:09:47.417

如果我在修复错误时一遍又一遍地访问相同的代码，我认为是时候重构它了。如果我加入了一个新项目或负责新代码，我也会坐下来开始重构。如果我要扩展某些东西，那么在进行任何重大更改之前，我会首先重构所有旧问题（在它们变得过于根深蒂固之前）。

当您达到某个目标[标准化](http://theprogrammersparadox.blogspot.com/2008/11/code-normal-form.html)水平时，您就完成了重构。如果只是一般清理：1,2 或 3 就足够了。如果您要扩展代码，那么 4 或 5 会更好。如果你真的想在很长一段时间内利用现有的工作，那么 6 是要走的路。

保罗。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-13T18:19:26.287

只回答你的部分问题：我会在这里重申其他一些人已经提出的观点 - 一般来说，如果你没有一组可重复的测试，你可以运行以确保你所做的改变没有' t破坏了代码-那么您可能根本不应该重构。

你说代码已经坏了。您可能会倾向于最初对其进行尽可能少的小改动，以使其“正常工作”。问题是，没有测试，你怎么能说它真的“工作”？

祝你好运！

# svn - 用于用符号链接替换某些文件的 shell 脚本

> ID：365388
> 
> 赞同：1
> 
> 时间：2008-12-13T16:27:12.460
> 
> 标签：svn, ftp, shell

有些服务器只支持ftp上传文件。

当我将一个项目从我的 subversion 存储库导出到我的 windows 机器时，所有 (linux) 符号链接都被占位符文件替换：

```
链接 ../www_public/images

```

上传我现在使用的所有导出文件后

```
查找 | xargs grep -P ^link

```

找到所有这些占位符。然后我手动将它们替换为实际的符号链接。

**我真的很想用一个shell脚本来自动化这一步。
我该怎么做？**

注意：
如果这个问题有更好/不同的解决方案，请不要犹豫分享:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T18:07:32.507

这是一种可能的解决方案：

```
:
grep -lr '^link' . | while read placeholderfile
do
  linkfile=`cut -c6- "$placeholderfile"`
  ln -sf "$linkfile" "$placeholderfile"
done 
```

**编辑：**在下面的评论中更改了上面的代码。

# excel - 使用VB自动化IE“目标另存为”

> ID：365391
> 
> 赞同：4
> 
> 时间：2008-12-13T16:29:13.283
> 
> 标签：excel, internet-explorer, save-as

我正在尝试使用 excel VB 宏从受会员密码保护的站点下载 excel 文件。我正在使用“InternetExplorer”对象打开浏览器窗口，登录并浏览到正确的页面，然后在页面中扫描我想要的链接。使用 Workbooks.Open(URLstring) 不起作用，因为没有记录 Excel。它打开的不是实际文件，而是要求登录的 html 页面。

我的偏好是使用 VB 宏在 Internet Explorer 中的正确链接上自动执行右键单击“目标另存为”事件，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T20:05:53.703

使用 Internet Explorer API 并没有真正的方法来做到这一点。如果它只是一个一次性脚本，您可能可以证明自己使用 SendKeys 是合理的。

```
Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
...
Sub YourMacro()
    ... Navigate IE to the correct document, and get it to pop 
    up the "Save As" dialog ...

    Set sh = CreateObject("WScript.Shell")
    sh.AppActivate "File Download"
    sh.SendKeys "S"
    Sleep 100
    sh.SendKeys "C:\Path\filename.ext{ENTER}"
End Sub 
```

[WScript.Shell 文档](http://msdn.microsoft.com/en-us/library/aew9yb99(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-15T18:07:40.693

If you know the URL of the file you want to download you can use this routine:

```
Sub HTTPDownloadFile(ByVal URL As String, ByVal LocalFileName As String)
    Dim http As Object ' Inet
    Dim Contents() As Byte

    Set http = New Inet
    Set http = CreateObject("InetCtls.Inet")
    With http
        .protocol = icHTTP
        .URL = URL
        Contents() = .OpenURL(.URL, icByteArray)
    End With
    Set http = Nothing

    Open LocalFileName For Binary Access Write As #1
    Put #1, , Contents()
    Close #1
End Sub 
```

# python - 如何使用 NumPy (Python) 截断矩阵

> ID：365395
> 
> 赞同：5
> 
> 时间：2008-12-13T16:30:16.463
> 
> 标签：python, numpy

只是一个简单的问题，如果我有一个有 n 行和 m 列的矩阵，我怎样才能切断矩阵的 4 个边并返回一个新矩阵？（新矩阵将有 n-2 行 m-2 列）。

提前致谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-13T16:32:17.147

```
a[1:-1, 1:-1] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-14T00:20:57.243

一个更普遍的答案是：

```
a[[slice(1, -1) for _ in a.shape]] 
```

# iphone - 如何修复适用于 iPhone OS 2.2 的 iPhone 应用程序中的声音？

> ID：365414
> 
> 赞同：1
> 
> 时间：2008-12-13T16:46:44.043
> 
> 标签：iphone, cocoa-touch, core-audio

当我运行 iPhone OS 2.0 时，我的 iPhone 应用程序的声音运行良好。我更新到 OS 2.2，现在声音只适用于耳机。如何使声音再次适用于耳机和扬声器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T15:05:24.510

尝试切换装置左侧音量控制上方的响铃/静音开关。

# c - 如何学习 C 调试和最佳实践

> ID：365424
> 
> 赞同：7
> 
> 时间：2008-12-13T16:53:17.540
> 
> 标签：c, apache, debugging, gdb, valgrind

我用 C 编写了一个 Apache 模块。在某些条件下，我可以让它出现段错误，但我不知道为什么。此时，可能是我的代码，可能是我编译程序的方式，也可能是操作系统库中的错误（段错误发生在调用 dlopen() 期间）。

我尝试过运行 GDB 和 Valgrind，但没有成功。GDB 让我回溯到看起来毫无意义的 dlopen() 系统调用。在 Valgrind 中，该错误实际上似乎消失了，或者至少变得不可重现。另一方面，当谈到这些工具时，我完全是个新手。

我对生产质量的 C 编程有点陌生（我多年前开始使用 C，但从未专业地使用它。）对我来说学习调试程序的最佳方法是什么？我还应该研究哪些其他工具？总之，您如何弄清楚如何应对新的错误挑战？

编辑：澄清一下，我要感谢 Sydius 和 dmckee 的意见。我看过 Apache 的指南，并且对 dlopen（以及 dlsym 和 dlclose）相当熟悉。我的模块大部分都可以工作（它大约有 3k 行代码，只要我不激活这一部分，一切似乎就可以正常工作。）

我想这就是我最初的问题的来源——我不知道下一步该做什么。我知道我没有充分利用 GDB 和 Valgrind。我知道我可能没有使用完全正确的标志进行编译。但我很难弄清楚更多。我可以找到告诉我已经知道的内容的初学者指南，以及告诉我比我需要知道的更多但没有指导的手册页。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T19:30:24.507

不幸的是，GNU 工具并不是最好的，我的经验是动态链接器极大地搅乱了局面。如果您可以让 Apache 与您的模块进行静态链接，这将使 gdb 尤其能够更可靠地执行。我不知道这有多容易；很大程度上取决于 Apache 构建系统。

使用 valgrind 无法轻松重现该错误令人担忧，但并不令人震惊。

关于使用正确的标志进行编译，如果您使用`-g -O0`. 不要相信 gcc 手册页上的声明`gcc -g -O`已经足够好了；它不是——甚至`-O`会导致源代码中的变量被优化器消除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-13T19:02:35.453

我确信调试技术在一般语言中是独立的，并且没有这样的想法“C 调试”。
有很多不同的工具可以帮助您找到简单的问题，例如内存泄漏，或者只是代码中的愚蠢错误，有时它甚至可以捕获简单的内存溢出。但是对于真正难以发现的问题，例如源自多任务/中断、dma 内存损坏的问题，唯一的工具是您的大脑和编写良好的代码（事先考虑到该代码将被调试）。[您可以在此处](https://stackoverflow.com/questions/238517/whats-a-quick-way-to-trace-the-entry-and-exit-of-functions-in-a-visual-studio-2#238601)找到有关准备调试代码的更多信息。从[Sydius 的帖子](https://stackoverflow.com/questions/365424/how-to-learn-c-debugging-and-best-practices#365530)看来，Apache 已经有了一个很好的跟踪机制，所以只需使用它并将 simalar 添加到您的代码库中。
另外我想说调试中的另一个重要步骤是“不要假设/思考”。将所有步骤都建立在赤裸裸的事实之上，以 100% 的准确度证明您的所有假设，然后再根据该假设进行下一步。基于假设进行调试通常会将您引向错误的方向。

戴夫澄清后编辑：

您下一步应该找到导致问题的代码的最小部分。您很遗憾，如果您禁用某个部分，则会加载模块。只需将此部分尽可能小，删除/删除该部分中的所有内容，直到您找到理想的一行会导致模块无法加载。在你找到这条线之后。这将是开始使用您的大脑的确切时间:) 只是不要忘记 100% 验证**这是行**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T18:25:18.600

## 非常一般的建议：

*   再看看那个回溯。您控制的代码中是否有任何堆栈帧？如果是这样，那是哪条线，那里发生了什么？

*   你知道做什么`dlopen()`吗？如果不看说明书。如果回溯不包括您的任何代码，那么在`Apache`尝试加载您的代码时这很可能会失败。您确定您已经使用正确的编译器选项构建了模块吗？

*   有效的调试需要了解您的环境和工具。Sydius 的建议在这里很好。

*   如果您卡在其他路径上，请检查您是否可以编写、加载和运行一个简单的模块。您可能会在几乎所有有关该主题的文档中找到这样的示例。

* * *

**戴夫澄清说：**初学者和专家之间可能是一个棘手的问题。

您是否在其他地方不使用的违规代码中调用库？也许加载器路径只是为了那个资源而搞砸了。

除此之外，我几乎没有建议。对不起。

* * *

注意：去年我有机会阅读 David J. Agans 的书[*Debugging*](https://rads.stackoverflow.com/amzn/click/com/0814471684)。它不是特定于软件的，但它是一本很好的读物，并且*即使*您已经是一个非常好的调试器也很有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T21:57:44.770

它在 dlopen() 调用上失败的事实对我来说似乎有点可疑。尝试打开共享对象时，有很多事情可能会出错。但它们*都不应该*导致段错误。

我能想到的一个例外是 SO 的库初始化问题。在此基础上，我建议您尝试获取更多信息。

*   检查您的库路径，并确保您尝试加载的库位于此路径中。（注意：由于您使用的是 Apache，我认为您还需要检查运行 Apache 的用户的库路径。（我认为该用户是“nobody”。）我相信您正在寻找 LD_LIBRARY_PATH 环境变量。）还要注意，如果您有多个版本的库，这可能非常重要。确保您正在加载正确版本的库。
*   作为一般调试原则，尽量简化问题。鉴于我对 Apache 模块知之甚少，我会尝试从等式中删除 Apache：尝试编写一个简单的 C 程序，它只执行 dlopen() 和可能的后续 dlsym()，然后退出。该程序提供了一个更简单的环境来进行故障排除和/或调试。如果该程序运行干净，那么您可能需要更仔细地查看程序段错误时的不同之处。（Apache 的做法有何不同？）另一方面，如果您的程序也出现段错误，您可能会考虑库、程序的编译器切换以及程序中的代码存在潜在问题。（或以上所有。）

虽然我可能没有提供很多通用调试技巧，但我希望这里的一些东西可能会有所帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T19:47:45.783

我查看了 valgrind 文档，默认情况下它不检查子进程。如果**Apache 可以在子线程中运行您的模块，**我一点也不感到惊讶。请试试

```
valgrind --trace-children=yes .... 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-13T20:18:50.587

我在 Kernighan 的编程讲座“编程实践”中推荐我们的非 CS 学生（即电气工程、数学、物理专业的学生）。它很好地提供了一些有助于开发的基本概念（如测试，它来了：调试）。

如果您已经是经验丰富的程序员，那可能对您来说太基础了。然后我再给你一句禅宗谚语：“没有经验过滤的智慧是毫无价值的”。

我只能备份一个答案：再次查看堆栈跟踪，这是调试最相关的帮助（尤其是在边界处，执行跨越不同模块（尤其是您的和 lib/OS 边界），并查看函数的参数并检查它们是否正常）。

# c++ - 提升精神提取第一个单词并将其存储在向量中

> ID：365427
> 
> 赞同：3
> 
> 时间：2008-12-13T16:54:41.237
> 
> 标签：c++, boost, boost-spirit

我在 Boost.Spirit 解析字符串时遇到问题。

字符串看起来像

```
name1 has this and that.\n 
name 2 has this and that.\n 
na me has this and that.\n 
```

我必须提取名称。文本“有这个和那个”总是相同的，但名称可以包含空格，因此我不能使用 graph_p。

1）如何解析这样的字符串？

由于字符串有几行这种格式，我必须将名称存储在一个向量中。

我用过类似的东西

```
std::string name;
rule<> r = *graph_p[append(name)]; 
```

为了保存一个名字，但

2）在向量中保存多个名称的最佳方法是什么？

提前致谢

康拉德

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-13T22:18:11.890

我认为这可以解决问题：

```
vector<string> names;
string name;
parse(str,
    *(  
       (*(anychar_p - "has this and that.")) [assign_a(name)]
       >> "has this and that.\n") [push_back_a(names, name)]
     )) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-12-17T15:01:10.417

如果您使用较新的 Spirit V2.x（这是自 Boost V1.42 以来的默认设置），这很简单：

```
#include <boost/spirit/include/qi.hpp>

namespace qi = boost::spirit::qi;

std::vector<std::string> names;
std::string input = "name1 has this and that.\n"
                    "name 2 has this and that.\n"
                    "na me has this and that.\n";
bool result = qi::parse(
    input.begin(), input.end(),
    *(*(qi::char_ - " has this and that.\n") >> " has this and that.\n"),
    names
); 
```

之后，如果`result`是`true`，该向量`names`将保存所有已解析的名称（使用 Boost V1.45 测试）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T21:10:27.923

[我认为您使用Boost.Spirit](http://www.boost.org/doc/libs/1_37_0/libs/spirit/classic/index.html)而不是[STL](http://www.sgi.com/tech/stl/table_of_contents.html)的[string](http://www.cplusplus.com/reference/string/string/)的[find](http://www.cplusplus.com/reference/string/string/find.html)方法是有原因的？例如：

```
string s = "na me has this and that.\n";
myVector . push_back( s.substr( 0, s.find( "has this and that" ) ) ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-02T03:17:02.673

要删除“有这个和那个”，请使用：

```
qi::lit("has this and that") 
```

# .net - 是否有用于 ASP.NET 的简单且可扩展的数据类？

> ID：365442
> 
> 赞同：0
> 
> 时间：2008-12-13T17:07:41.487
> 
> 标签：.net, asp.net

我过去曾使用过其中的一些，但我正在为 ASP.NET 3.5 寻找一个好的、可靠且可扩展的数据类，我可以在未来的项目中采用和扩展它。

我不是在寻找 LinQ，我不想要任何不是源代码级解决方案的东西。

理想情况下，它也不会很重。
简单。最佳实践。易于实施。易于扩展。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T17:45:47.823

您可能想查看 Mircrosoft 的 Enterprise library 的[Data Access Block](http://msdn.microsoft.com/en-us/library/cc309504.aspx) ，我发现它很有用，它是[.netTiers](http://nettiers.com/)的构建块。 [模式与实践 Codeplex 页面](http://www.codeplex.com/entlib)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T19:55:16.190

我希望有类似于 DataSet/DataTable/DataRow/etc ADO 数据类的东西，但可以扩展。虽然与它们一起工作有时非常困难，但它们使许多昂贵且复杂的任务变得容易。绝对是一种权衡。

# windows - 如何在 Windows XP 上的 XMPP 上设置 Django

> ID：365453
> 
> 赞同：3
> 
> 时间：2008-12-13T17:15:49.363
> 
> 标签：windows, django, xampp

问候！

我想调查 Django，但我正在运行 Windows XP。我已经安装了 XMPP，并且目前已经安装了 Python 2.6（2.5 真的是唯一可以与 XMPP 一起使用的版本吗？）。我还需要什么来启动和运行？任何提示、推荐的 IDE 等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T18:54:17.793

正如 Sam 所说，对于开发，请使用开发服务器。使用“真实”服务器实际上更痛苦，因为您必须确保它在您进行编辑时重新加载您的项目。如果这是您需要的（正如大多数人所做的那样），您还可以在开发环境中托管所有媒体。

就 IDE 而言，Python 是一种很难提供自动完成功能的语言，因为它具有动态类型。也就是说，PyDev（一个 Eclipse 插件）可以让您的生活更轻松，但这真的取决于个人选择。

一半的 Django 正在编写 HTML 模板，因此请确保您手头也有一个好的 HTML 编辑器。Eclipse（自然是 IMO）对于这个来说太笨重了（即使使用 Aptana 等插件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T17:28:11.633

如果您只是想玩 django，我建议您使用内置的[开发服务器](http://docs.djangoproject.com/en/dev/ref/django-admin/#runserver-optional-port-number-or-ipaddr-port)。为方便起见，在您的项目文件夹中有一个服务器启动器快捷方式。
运行服务器.cmd：

```
@echo off
python manage.py runserver 
```

至于 IDE，我推荐[Notepad++](http://notepad-plus.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T20:39:35.973

如果您真的需要它在 Apache 下工作，请[从 Django 文档中尝试。](http://docs.djangoproject.com/en/dev/howto/deployment/modpython/?from=olddocs)否则，使用开发服务器。如果您想要一种简单的入门方式，请尝试[Instant Django](http://www.instantdjango.com/)，尽管它只有 Python 2.5.2。

最后，关于 IDE，一个好的文本编辑器如[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)或[SciTE](http://www.scintilla.org/SciTE.html)就足够了。如果你想要一个 Python IDE，[Python wiki](http://wiki.python.org/moin/IntegratedDevelopmentEnvironments)上有一个很好的列表，而且[SPE](http://pythonide.blogspot.com/)对我来说一直很好用。

（哦，还有一个提示：打开两个 cmd 窗口 - 一个用于服务器，一个用于测试、syncdb-ing 等）

# c++ - 如何检测程序是否从 valgrind 中运行？

> ID：365458
> 
> 赞同：14
> 
> 时间：2008-12-13T17:18:29.640
> 
> 标签：c++, unit-testing, valgrind

有没有办法在运行时识别从 valgrind 中运行的可执行文件？我有一组 C++ 单元测试，其中一个预计`std::vector::reserve`会抛出`std::bad_alloc`. 当我在 valgrind 下运行它时，它完全退出，阻止我测试内存泄漏（使用 valgrind）和行为（期望抛出异常）。

这是一个重现它的最小示例：

```
#include <vector>
int main()
{
    size_t uint_max = static_cast<size_t>(-1);
    std::vector<char> v;
    v.reserve(uint_max);
} 
```

运行 valgrind，我得到以下输出：

```
Warning: silly arg (-1) to __builtin_new()
new/new[] failed and should throw an exception, but Valgrind
   cannot throw exceptions and so is aborting instead.  Sorry.
   at 0x40192BC: VALGRIND_PRINTF_BACKTRACE (valgrind.h:319)
   by 0x401C823: operator new(unsigned) (vg_replace_malloc.c:164)
   by 0x80487BF: std::vector<char, std::allocator<char> >::reserve(unsigned) new_allocator.h:92)
   by 0x804874D: main (vg.cxx:6) 
```

我想修改我的单元测试，以便在从 valgrind 中运行时跳过有问题的代码。这可能吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-13T21:48:22.467

您应该从 Valgrind 手册中查看[此页面](http://valgrind.org/docs/manual/manual-core-adv.html#manual-core-adv.clientreq)`RUNNING_ON_VALGRIND`，它包含一个宏（包含在 valgrind.h 中），它可以满足您的需求。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-06-13T19:32:26.213

如果不想包含`valgrind.h`（需要 autoconf 测试或类似的）或使用包装器，这里有一个针对 Linux（和其他使用 ELF 的系统？）的启发式方法：测试`LD_PRELOAD`环境变量的值，因为 Valgrind 通过预加载库工作。我在 C 中使用以下测试来检查是否`LD_PRELOAD`包含字符串`"/valgrind/"`或`"/vgpreload"`：

```
int tests_run_within_valgrind (void)
{
  char *p = getenv ("LD_PRELOAD");
  if (p == NULL)
    return 0;
  return (strstr (p, "/valgrind/") != NULL ||
          strstr (p, "/vgpreload") != NULL);
} 
```

其他系统可能有类似的解决方案。我建议使用以下命令来查看环境是否提到了 Valgrind：

```
valgrind env | grep -i valgrind 
```

编辑：如果您尝试在 macOS 或在 amd64 内核上运行的 FreeBSD i386 上执行此操作相对不太可能发生，那么环境变量会有所不同。

*   macOS 使用 DYLD_INSERT_LIBRARIES
*   FreeBSD 使用 LD_32_PRELOAD（仅适用于 amd64 上的 i386，不适用于 amd64 上的 amd64 或 i386 上的 i386）。

普通 LD_PRELOAD 应该适用于所有 Linux 和 Solaris 变体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T19:54:42.447

我查看了 valgrind 文档并没有找到简单的答案。但是您可以尝试以下几件事：

*   围绕有问题的新操作编写自己的包装器，并在 valgrind 获取其私有新功能之前引发异常。

*   尝试上面建议的海报，除了使用环境变量而不是命令行选项（需要管道）：

    ```
    MYAPP_UNIT_TESTS_DISABLED="NEW_MINUS_ONE,FLY_TO_MOON,DEREF_NULL" valgrind myapp 
    ```

然后你可以很容易地写一个函数

```
bool unit_test_enabled(const char *testname); 
```

根据 getenv(3) 返回的值保护您的单元测试。

# javascript - 选择使用值的标签选项我想通过值在选择标签中选择一个选项。- javascript var selectbox=document.getElementById("Lstrtemplate"); var TemplateName=selectbox.options[selectbox.selectedIndex].text; 现在我在 TemplateName 中有选项文本，使用它我想更新另一个选择标签，它具有相同的文本..但不想使用索引或 id..只想通过值实现请帮助我尝试它像这样： var

> ID：365460
> 
> 赞同：0
> 
> 时间：2008-12-13T17:22:13.813
> 
> 标签：javascript, html

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T17:31:28.897

我不确定我是否正确解释了您的问题。您有两个选择元素，并且您希望对一个元素的更改反映在另一个元素中。我假设它们都具有相同的选项集，并且您需要将它们同步。

如果是，那么：

```
var selectbox=document.getElementById("temp1");
var selectbox2=document.getElementById("temp2");
selectbox2.value = selectbox.value; 
```

这使 temp2 与 temp1 保持同步，其中 temp1 和 temp2 是两个选择元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T17:27:14.803

试试这样：

```
var TemplateName = selectbox.options[selectbox.selectedIndex].value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T17:41:40.483

上面的示例（selectobx2.value = selectbox.value）将根据值关联 2 个选择元素，根据您的描述，我认为您想根据显示值或文本属性关联 2 个选择元素。

不幸的是，没有捷径可以做到这一点，您需要自己枚举选项，以搜索其文本属性与您正在寻找的选项匹配的选项。

```
var selectbox=document.getElementById("Lstrtemplate");
var TemplateName=selectbox.options[selectbox.selectedIndex].text;

var select2 = document.getElementById("SecondSelect");
for (optionElem in select2.options)
    if (optionElem.text == TemplateName)
    {
        select2.value = optionElem.value;
        break;
    } 
```

# c# - ActionLink CS1026:) 预期

> ID：365472
> 
> 赞同：12
> 
> 时间：2008-12-13T17:39:40.597
> 
> 标签：c#, asp.net, asp.net-mvc

每当我尝试使用 ActionLink 时都会出现上述错误？我才刚刚开始使用 MVC，并不太明白代码有什么问题（如下）：

```
<%= Html.ActionLink("Lists", "Index", "Lists"); %> 
```

这似乎只是一个解析问题，但它只发生在我运行页面时。应用程序构建得非常好，所以我真的不明白，因为错误是编译错误？如果我将第 25 行取出，它将发生在下一行...

```
 Compilation Error
Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately.

Compiler Error Message: CS1026: ) expected

Source Error:

Line 23:   </div>
Line 24:   
Line 25:   <%= Html.ActionLink("Lists", "Index", "Lists"); %>
Line 26:   <a href="<%= Url.Action("/", "Lists"); %>">Click here to view your lists</a>
Line 27:   

Source File: d:\Coding\Playground\HowDidYouKnowMVCSoln\HowDidYouKnowMVC\Views\Home\Index.aspx    Line: 25 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-13T17:43:57.717

从 ActionLink 行中删除分号。

注意：使用时`<%= ... %>`没有分号，代码应该返回一些东西，通常是一个字符串。使用 时`<% ...; %>`，即百分比后不等于，代码应返回 void，并且您需要在结束百分比之前使用分号。

例如，当使用 Html 方法时，VS intellisense 会告诉你它是否返回 void。如果是这样，请不要使用等号并以分号结尾。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-13T17:43:21.120

使用它不带分号：

```
<%= Html.ActionLink("Lists", "Index", "Lists") %> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-03-10T16:06:22.080

就我而言，我真的错过了 ActionLink 末尾的 )。

```
<%= Url.Action("SearchPatientSchedules", "PatientSchedules" **)** %> 
```

# c++ - C ++问题将8位填充到一个字符中

> ID：365476
> 
> 赞同：0
> 
> 时间：2008-12-13T17:42:14.913
> 
> 标签：c++

这很奇怪。这是一个微不足道的问题：

长度为 8 倍数位的 std::string，前 8 位为：“10011100”。

```
//Convert each 8 bits of encoded string to bytes
unsigned char c = 0;
for(size_t i = 0; i < encoded.size(); i += 8)
{
    for(size_t k = 0; k < 8; k++)
    {
        c <<= k;
        if(encoded.at(i + k) == '1') c += 1;

        //Debug for first 8 bits
        if(i == 0) cout << "at k = " << k << ", c = " << (int)c << endl;
    }
    outFile.write(reinterpret_cast<char*>(&c), sizeof(char));
} 
```

* * *

产生输出：

```
at k = 0, c = 1
at k = 1, c = 2
at k = 2, c = 8
at k = 3, c = 65
at k = 4, c = 17
at k = 5, c = 33
at k = 6, c = 64
at k = 7, c = 0 
```

这没有任何意义。左移 2 位并从 2 中得到 8 是不可能的。它可以具有的最大值应该是 111b = 7d，在这种情况下应该是 100b = 4d。

照亮我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T17:50:14.427

```
at k = 0, c = 1
at k = 1, c = 2
at k = 2, c = 8 
```

那是因为：

```
input = 10011100
c = 0

`k=0, b=1` shift by 0 add 1 => `c = 1`, dec = 1
`k=1, b=0` shift by 1 add 0 => `c = 10`, dec = 2
`k=2, b=0` shift by 2 add 0 => `c = 1000`, dec = 8 
```

b 表示“当前位”。可能你不想改变`k`，但是`1`？如果您寻找标准 C++ 解决方案，您可以使用`std::bitset`：

```
std::bitset<8> bits("10011100");
unsigned char c = bits.to_ulong(); 
```

对于输出到流中，您可以使用以下`put`功能：

```
outFile.put(c); 
```

它避免了转换指针并且还输出未格式化（忽略字段宽度等设置）。

# visual-studio - Visual Studio 中的撤消/重做文件

> ID：365481
> 
> 赞同：1
> 
> 时间：2008-12-13T17:45:01.240
> 
> 标签：visual-studio

为什么 VS 不支持撤消/重做文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T18:13:04.880

它将重现修订控制系统（例如 Subversion 或 CVS）的功能，但没有这些系统的一些好处（例如标签和分支）。这可能就是为什么它不存在（或在许多 IDE 中）。许多人似乎不鼓励对小型项目使用修订控制，但它值得进行初始设置，并且可以在许多项目之间共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T17:49:00.077

如果该功能符合我的想法，那么它基本上是您的源代码控制系统的功能，而不应该由 Visual Studio 处理。另一方面，VS 确实保留了自您打开 Visual Studio 以来所做的每项更改的完整历史记录，如果您将 VS 保持打开足够长的时间，您可以撤消一整天甚至一周的重做更改。

# .net - .NET：ArrayList 与列表

> ID：365482
> 
> 赞同：37
> 
> 时间：2008-12-13T17:45:03.563
> 
> 标签：.net, vb.net, collections

VB.NET中ArrayList和List有什么区别

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-13T17:50:56.330

ArrayLists 本质上已被弃用，因为它们是无类型的——您需要对它们使用强制转换——并且它们对于值类型来说速度较慢且空间效率较低，因为它们需要对项目进行装箱。

通用列表是在 .Net 2.0 中引入的，并且是要走的路。列表通常比数组好，几乎没有缺点。

由于这些集合是 .Net 基类库的一部分，因此该建议也适用于 C# 和任何支持泛型的 .Net 语言——它并不特定于 VB.NET。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-13T17:51:59.743

List 是 ArrayList 的通用实现。ArrayList 将所有对象存储为*System.Object*您需要然后将其转换为适当的类型。ArrayList 是异构的，List 只能存储一种类型的对象 - 作为其通用参数提供的类型。

```
List<string> strList; // can store only strings
List<int> intList; // can store only ints
ArrayList someList; // can store anything 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-22T03:03:24.870

ArrayList 在 64 位上用于存储原始元素时，空间效率更低，因为 64 位宽的内存引用与 32 位机器上的 32 位引用相比，以及装箱。

有关更多详细信息，请参见：http: [//blogs.msdn.com/joshwil/archive/2004/04/13/112598.aspx](http://blogs.msdn.com/joshwil/archive/2004/04/13/112598.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-14T05:02:40.670

ArrayList 允许你这样写：

```
Dim customers as new ArrayList
Dim c as new Customer
Dim m as new Manager
customers.Add(c)
customers.Add(m)

'This will cause an exception '  
For each c as Customer in customers
console.writeline(c.Name)
Next 
```

List(of Customer) 只允许 Customer 类型的对象和从 Customer 继承的类型，所以你不能犯这样的错误。

即使您需要将不相关类型的对象放在同一个集合中，List(Of Object) 也是更好的选择，因为它明确表明您正在处理不同的类型。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-13T17:47:16.650

List 可以利用泛型，因此只能将特定类型的对象放入其中，这样您就可以进行额外的类型检查，从而可以减少由于装箱和拆箱而导致的处理时间。Arraylist 不能使用它。在几乎所有情况下，您都希望使用 List 而不是 Arraylist。

# c# - 使用正则表达式解析电子邮件内容

> ID：365487
> 
> 赞同：2
> 
> 时间：2008-12-13T17:46:47.180
> 
> 标签：c#, email-parsing

每天我都会收到数千封电子邮件，我想解析这些电子邮件的内容/正文以将它们加载到数据库中。

我的问题是，现在我手动解析电子邮件正文，我想将逻辑更改为**C# 中的正则表达式。**

以下是电子邮件的正文：

* * *

Gentilissima Agenzia Nexity Residenziale

前言：

Sig./Sig.ra：**巴勃罗·阿佐林**

电子邮件：**pabloazorin@gmail.com**

电话：**02322-498900**

sta cercando un immobile con le seguenti caratteristiche:

类别：**住宅**

Tipologia:**别墅**

Tipo di contratto: **Vendita**

公社：阿萨戈省 **米兰**

Zona:**不详**

Fascia di Prezzo：**非特定**

* * *

我需要以粗体提取文本，我认为 RegEx 是我需要的...

期待得到您关于如何使其工作的建议。

谢谢！

**——巴勃罗**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T13:26:08.767

假设您的电子邮件中非粗体的部分总是出现在所有电子邮件中，您可以使用正则表达式轻松地从电子邮件中获取所有部分：

```
Sig\./Sig\.ra :(.*)

Email: (.*)

Tel\.: (.*)

sta cercando un immobile con le seguenti caratteristiche:

Categoria: (.*)

Tipologia: (.*)

Tipo di contratto: (.*)

Comune: (.*)

Zona: (.*)

Fascia di prezzo: (.*) 
```

在 C# 中

```
Regex regexObj = new Regex(@"Sig\./Sig\.ra :(.*)

Email: (.*)

Tel\.: (.*)

sta cercando un immobile con le seguenti caratteristiche:

Categoria: (.*)

Tipologia: (.*)

Tipo di contratto: (.*)

Comune: (.*)

Zona: (.*)

Fascia di prezzo: (.*)");
Match matchObj = regexObj.Match(subjectString);
string Sig = matchObj.Groups[1].Value;
string Email = matchObj.Groups[2].Value;
// and so on to get all the other parts 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T17:52:52.440

阅读[掌握正则表达式](http://www.amazon.ca/Mastering-Regular-Expressions-Jeffrey-Friedl/dp/0596528124/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1229190700&sr=8-1)。它将教你完成这个和其他类似的正则表达式问题所需知道的一切，并且会给你足够的理解和洞察力，让你开始编写更复杂的正则表达式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-25T13:31:05.727

对于电子邮件下载，我使用了 Mailbee .Net 对象。这个库很容易使用并且有据可查。但是如果你想避免编程，你也可以使用像[EmailParser2Database](http://www.emailparser2database.com/)这样的电子邮件解析器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-11-01T19:10:50.077

我认为将此字符串拆分为行数组会更好，您可以使用所有标题作为键来初始化字典，然后您将从字典中搜索每一行的标题（例如“电子邮件：”）然后你将结果作为值放回字典中，最后你将拥有一个包含所有标题和值的字典。我认为您不需要正则表达式。实际上这样标题的顺序就无关紧要了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T19:40:38.340

如果电子邮件始终采用相同的格式，您可以通过多种不同的方式执行此操作。一种简单的方法是在换行符上拆分并在每行上取一个子字符串，从标签之后开始。

使用正则表达式，您可能会创建一个创建多个命名捕获的正则表达式。然后，您可以索引到每个命名组名称的匹配项的 Groups 属性，以便从中获取值。当然，这有点复杂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-15T02:22:45.000

您真的不想手动或使用正则表达式来执行此操作。有许多不同的方法可以对电子邮件中的数据进行编码，并且许多不严格符合规范的电子邮件仍然可以被解析。我在 .NET 环境中使用[AnPOP取得了成功。](http://www.emailarchitect.net/webapp/popcom/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-13T20:06:04.590

我们发现，对于垃圾邮件过滤和其他大容量应用程序，**正则表达式在解析 MIME 标头时有点慢**，这正是您想要做的。代码有些特殊，但我编写了一个[C 状态机来进行解析](http://www.cs.tufts.edu/~nr/drop/fastmime.c)，它的速度与你得到的一样快，而无需使用 re2c 之类的东西。该代码不适合胆小的人，但速度非常快。

对于电子邮件，我认为您会发现显式状态机比正则表达式更容易使用。这也是 goto 语句的最后避难所！

# .net - 每个优秀的 .NET 开发人员都应该能够回答的问题？

> ID：365489
> 
> 赞同：246
> 
> 时间：2008-12-13T17:47:33.777
> 
> 标签：.net

我的公司即将招聘**.NET 开发人员**。我们在各种 .NET 平台上工作：ASP.NET、Compact Framework、Windowsforms、Web 服务。我想编制一份好问题的清单/目录，这是一种最低标准，看看申请人是否有经验。所以，我的问题是：

**您认为优秀的**.NET 程序员应该能够回答****哪些问题**？**

 **我也将其视为我自己的**清单**，以便了解我自己的缺陷在哪里*（有很多......）*。

![替代文字](https://i.imgur.com/Xo2yI.png)

*更新：要明确的是，我们不仅仅测试 .NET 知识，解决问题的能力和通用编程技能对我们来说更为重要。

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2008-12-13T18:41:39.410

基本问题包括：

*   [抽象类和接口有什么区别？您想什么时候使用它们？](https://stackoverflow.com/questions/479142/when-to-use-an-interface-instead-of-an-abstract-class-and-vice-versa)
*   [左连接和内连接有什么区别？](https://stackoverflow.com/questions/448023/what-is-the-difference-between-left-right-outer-and-inner-joins)
*   [视图状态和会话状态有什么区别？](https://stackoverflow.com/questions/733482/what-is-the-difference-between-sessionstate-and-viewstate)
*   覆盖和重载方法有什么区别？解释两者是如何完成的。
*   保护和内部有什么区别？“受保护的内部”呢？
*   短路运算符如何工作？
*   解释什么是 StringBuilder 类以及为什么要使用它？
*   静态方法和非静态方法有什么区别？
*   C# 中的“volatile”关键字是什么意思？
*   解释将“ref”或“out”参数传递给方法时会发生什么。[这两个关键字有什么区别](https://stackoverflow.com/questions/135234/difference-between-ref-and-out-parameters-in-net)？
*   什么是弱引用？你什么时候想用一个？
*   DataTable 和 DataReader 有什么区别？
*   值类型和引用类型有什么区别？
*   C# 中的“readonly”关键字是什么意思？

我认为要求您的申请人完成一个简单的编码练习通常会有所帮助，例如：

*   在不使用内置类的情况下编写自己的链表类。
*   在不使用内置类的情况下编写自己的哈希表类。
*   编写一个表示二叉树的类。编写一个遍历树的所有节点的方法。
*   编写一个方法以在不使用内置方法的情况下对数组执行二进制搜索。
*   为博客绘制数据库模式。每个用户只有一个博客，每个博客有很多类别，每个类别有很多帖子，每个帖子可以属于多个类别。要求您的申请人编写查询以提取特定信息。

接下来，寻找具体的技术诀窍：

*   （事件处理程序）使用自定义事件处理程序创建一个类，创建另一个挂钩到自定义事件处理程序的类。
*   (XML) 加载一个 XML 文档并选择所有具有 x、y 和 z 属性的节点。
*   （函数式编程）创建一个接受另一个函数作为参数的函数。地图或折叠功能对此非常有效。
*   （反思）编写一个函数来确定一个类是否具有特定属性。
*   （正则表达式）编写一个从 HTML 块中删除所有标签的正则表达式。

对于一个熟练的 C# 程序员来说，这些都不是特别难回答的问题，它们应该让你很好地了解你的申请者的特殊优势。您可能还想处理一些使用特定设计模式的问题/代码示例。

**[编辑澄清]**：

似乎很多人不明白我为什么要问这些类型的问题。让我谈谈一些人的评论（我不是直接引用，而是转述）：

* * *

**问：**最后一次有人使用 volatile 或弱引用是什么时候？

**A：**当我进行技术面试时，我会看一个人是否了解 .NET 的高级*和*低级特性。易失性和弱引用是 .NET 提供的两个低级特性——即使这些特性在实践中不经常使用，这些问题的答案也非常具有启发性：

*   对 volatile 的良好理解表明，一个人了解编译器优化如何改变代码的正确性，线程如何保留在任何给定时间可能不同步的共享状态的本地副本，并且对多线程代码的某些复杂性知之甚少.

*   对弱引用的良好理解表明人们了解垃圾收集器的内部细节以及它如何决定何时释放内存。当然，你可以问候选人“垃圾收集器是如何工作的”，但询问弱引用会得到更好、更周到的回答。

.NET 是一种相当抽象的语言，但明星开发人员几乎总是对 CLR 和 .NET 运行时的低级细节有深入的了解。

* * *

**问：**为什么有人需要实现自己的哈希表或链表？

**答：**我并不是说 Dictionary 类是劣等的，或者人们应该滚动他们自己的哈希表。这是一个基本问题，它测试一个人是否对数据结构有*最低限度的*了解。这就是这些问题所要测试的：最低限度的理解。

你在数据结构 101 的第一天就了解了这些哈希表和链表。如果有人不能从头开始编写哈希表或链表，那么他们的技术知识就有*很大*的差距。

* * *

**问：**为什么这些问题如此粗俗？

**答：**因为这个帖子的标题是“每个优秀的 .NET 开发人员都应该知道的问题”。每个 .NET 开发人员的职业生涯都是从编写 crud 应用程序开始的，而 90% 的应用程序开发人员都与业务线应用程序有关。

我认为在大多数情况下，测试一个人对业务线应用程序知识的问题是合适的，除非您正在寻找非常特定领域的开发人员，例如编译器开发、游戏引擎开发、定理证明、图像处理等.

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2008-12-14T10:34:11.483

[我在Scott Hanselman](https://stackoverflow.com/users/6380/scott-hanselman)的[博客](http://www.hanselman.com/blog/)上找到了这些列表：

*   [伟大的 .NET 开发人员应该知道什么（更多 .NET 面试问题）](http://www.hanselman.com/blog/WhatGreatNETDevelopersOughtToKnowMoreNETInterviewQuestions.aspx)
*   [ASP.NET 面试问题](http://www.hanselman.com/blog/ASPNETInterviewQuestions.aspx)

以下是我认为这些帖子中最重要的问题，分为几类。我编辑并重新安排了它们。幸运的是，对于这些问题中的大多数，Stack Overflow 上已经有了很好的答案。只需点击链接*（我会尽快更新它们）*。

## 独立于平台的 .NET 问题

*   [**线程**和**进程**](https://stackoverflow.com/questions/200469/what-is-the-difference-between-a-process-and-a-thread)[有什么区别](https://stackoverflow.com/questions/200469/what-is-the-difference-between-a-process-and-a-thread)？
*   [**EXE**和**DLL**](http://www.dotnetspider.com/forum/ViewForum.aspx?ForumId=27373)[有什么区别](http://www.dotnetspider.com/forum/ViewForum.aspx?ForumId=27373)？
*   [什么是**强类型**与**弱类型**](https://stackoverflow.com/questions/323323/can-someone-tell-me-what-strong-typing-and-weak-typing-means-and-which-one-is-b)？
*   [`a.Equals(b)`和 和有什么不一样`a == b`](https://stackoverflow.com/questions/112625/vs-objectequalsobject-in-net)？
*   [什么是**拳击**](https://stackoverflow.com/questions/13055/what-is-boxing-and-unboxing-and-why-is-it-bad)？
*   [字符串是**值类型**还是**引用类型**](http://msdn.microsoft.com/en-us/library/t63sy5hs(VS.80).aspx)？
*   [什么是**全局程序集缓存**(GAC)？它解决了什么问题](https://stackoverflow.com/questions/23578/what-are-the-advantages-and-disadvantages-of-using-the-gac)？
*   [什么是**接口**](https://stackoverflow.com/questions/570302/when-are-interfaces-needed)，它与类有何不同？
*   [什么是**反射**？](http://www.odetocode.com/Articles/288.aspx)
*   **[从概念上讲，早期绑定](http://visualbasic.about.com/od/usingvbnet/a/earlybind.htm)**和**[后期绑定](http://blogs.msdn.com/davidklinems/archive/2006/11/27/what-is-late-binding.aspx)**有什么区别？
*   什么时候使用[`Assembly.LoadFrom`或`Assembly.LoadFile`](http://www.codeproject.com/KB/dotnet/AssemblyLoadFile.aspx)合适？
*   什么是程序**[集限定名称](http://msdn.microsoft.com/en-us/library/k8xx4k69.aspx)**？是文件名吗？它有什么不同？
*   **[强命名程序集与非强命名程序集](http://msdn.microsoft.com/en-us/library/wd40t7ad.aspx)**有何不同？
*   这是做什么的？[sn -t foo.dll](http://www.ondotnet.com/pub/a/dotnet/2003/04/28/strongnaming.html)
*   [.NET CLR 中的分代垃圾收集器如何管理](http://it.toolbox.com/blogs/programming-life/memory-manangement-in-net-6788)对象**生命**周期？什么[是非确定性终结](http://www.ondotnet.com/pub/a/oreilly/dotnet/news/programmingCsharp_0801.html)？
*   [`Finalize()`和 和有什么不一样`Dispose()`？](https://stackoverflow.com/questions/339063/what-is-the-difference-between-using-idisposable-vs-a-destructor-in-c)（[外部文章](http://www.dotnetspider.com/resources/1382-Understanding-IDisposable-pattern.aspx)）
*   **in-proc**和**out-of-** proc 和有什么不一样？什么技术可以在 .NET[中实现进程外通信？](http://walkin-interview.com/aspnet-interview-questions/what-technology-enables-out-of-proc-communication-in-net)
*   [什么是**完全信任**](https://stackoverflow.com/questions/102282/does-full-trust-mean-the-same-as-run-as-administrator)？GAC 的程序集是否具有 FullTrust？
*   [`Debug.Write`和 和有什么不一样`Trace.Write`](http://support.microsoft.com/?scid=kb%3Ben-us%3B815788)？什么时候应该使用每个？
*   [**Debug 和 Release 构建**有什么区别？](http://www.hanselman.com/blog/PermaLink.aspx?guid=a40c0d4f-66d0-4704-94f6-0efda4a44465)有明显的速度差异吗？为什么或者为什么不？
*   [`catch (Exception e) {throw e;}`和 catch 和有什么不一样`(Exception e) {throw;}`](https://stackoverflow.com/questions/88490/throwing-exceptions-in-asp-net-c)？
*   [`typeof(foo)`和 和有什么不一样`myFoo.GetType()`](https://stackoverflow.com/questions/139607/what-is-the-difference-between-mycustomergettype-and-typeofcustomer-in-c)？
*   [**XML 命名空间**](https://stackoverflow.com/questions/128389/what-are-xml-namespaces-for)[的目的是什么](https://stackoverflow.com/questions/128389/what-are-xml-namespaces-for)？
*   **XML“片段**”和 XML“**文档**”有什么区别？（[XML 基础](http://jameleon.sourceforge.net/xmlBasics.html)）
*   [您将如何使用 .NET**验证 XML**](http://support.microsoft.com/?scid=kb;en-us;318504)？

## ASP.NET

*   [什么是**回发**](http://www.xefteri.com/articles/show.cfm?id=18)？
*   [什么是**ViewState**](http://msdn.microsoft.com/en-us/library/bb386448.aspx)？它是如何[编码](http://www.pluralsight.com/community/blogs/fritz/archive/2004/06/03/408.aspx)的？是加密的吗？谁使用 ViewState？为什么它有用或邪恶？
*   ASP.NET 中提供了哪些[**会话状态提供程序？**](http://msdn.microsoft.com/en-us/library/aa479034.aspx)各自的优缺点是什么？
*   **ASPX 页面与其 CS/ [VB 代码隐藏](http://support.microsoft.com/?scid=kb;en-us;312311&x=10&y=12)**文件之间的 OO 关系是什么？
*   如何实现[ASP.NET HTML**输出缓存**](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)`q=`，缓存通过除了 where的所有值生成的页面的传出版本`q=5`（如 in `http://localhost/page.aspx?q=5`）？
*   [什么是**HttpHandler**](https://stackoverflow.com/questions/391130/what-is-a-httphandler-in-aspnet)？
*   [什么是**HttpModules**](http://www.15seconds.com/Issue/020417.htm)？
*   [在 ASP.NET中](http://blogs.msdn.com/gduthie/archive/2007/03/14/custom-file-extensions-in-asp-net-2-0.aspx)[**配置新扩展**](http://blogs.msdn.com/gduthie/archive/2007/03/14/custom-file-extensions-in-asp-net-2-0.aspx)需要什么？例如，如果我希望我的系统提供带有 *.jsp 扩展名的 ASPX 文件怎么办？
*   [**cookie**是如何工作的？](http://en.wikipedia.org/wiki/HTTP_cookie)什么是 Cookie 滥用的例子？
*   [通过**HTTP 标头**传递什么样的数据？](http://en.wikipedia.org/wiki/HTTP_headers)
*   [**IIS**](http://msdn.microsoft.com/en-us/library/aa479328.aspx)如何在运行时[与 ASP.NET](http://msdn.microsoft.com/en-us/library/aa479328.aspx)进行通信？在不同版本的 IIS（5 到 7）中运行时的 ASP.NET 在哪里？

* * *

## 回答 #3

> 赞同：94
> 
> 时间：2008-12-13T17:56:44.523

这可能不是你想听到的，但我建议不要关注狭隘的技术，而是关注一般的编程和解决问题的技能。扎实的开发人员可以快速学习您希望他们完成的任何事情。

例如，我不是一个紧凑框架的人，所以如果你朝那个方向走，我可能会通过你的面试。但如果我需要使用它，我可以做一些研究并直接加入。

Joel 的书[Smart and Gets Things Done](https://rads.stackoverflow.com/amzn/click/com/1590598385)为招聘开发人员提供了很好的建议，并且有大量关于要问的问题的多汁部分。我强烈推荐它。

* * *

## 回答 #4

> 赞同：66
> 
> 时间：2008-12-13T18:25:23.437

我想如果我在采访有 LINQ 经验的人，我可能会要求*他们*解释 LINQ。如果他们能解释延迟执行、流式传输、IEnumerable/IEnumerator 接口、foreach、迭代器块、表达式树（无论如何都是为了加分），那么他们可能可以应付其余的问题。（诚​​然，他们可能是“好的”开发人员，但还没有“获得”LINQ——我真的在考虑他们声称知道足够多的 LINQ 以使其成为一个公平问题的情况。）

在过去，我已经问过几个已经列出的问题，还有一些其他问题：

*   引用类型和值类型之间的区别
*   按引用传递与按值传递
*   IDisposable 和终结器
*   字符串、不变性、字符编码
*   浮点
*   代表们
*   泛型
*   可空类型

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2008-12-13T18:14:36.437

我和那些寻求解决问题能力的人在一起，而不是那些你可以从 '101 顶级 .NET 面试 Qs 和 As 中查找和记忆的东西。

以我自己为例，我倾向于“知道”我每天需要使用的东西。我倾向于忘记（后来不得不重新查找）我很少使用的东西。

如果你想在面试中绊倒我，那很容易。

尽管如此，我已经为一个使用相同业务对象和数据层作为其 WinForms 和 ASP.NET 化身的系统构建和编码了大部分基础架构，并且我们的代码库足够健壮且可重用，足以支持和开发 20+不同配置的网站版本，以及越来越多（目前为 5 个）的 WinForms 应用程序......

... 有两个开发团队。

我曾经在一个团队中担任技术主管，我的工作涉及大量的招聘和面试。我最严重的错误是雇佣了一个比我们其他人（包括我）加起来更了解我们正在使用的技术的人，我认为自己是专家。他什么都知道……

...除了如何编写满足要求或除他自己之外的任何人都可以理解的代码。当我最终说服首相不要续签他的合同时，他写的每一件事都必须重写。

明智地安排你的面试...

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2008-12-13T19:50:29.147

乔恩·斯基特是谁？

* * *

## 回答 #7

> 赞同：33
> 
> 时间：2008-12-13T18:02:07.727

我被问到的好问题是

*   您认为.NET的*优点是什么？*
*   您认为.NET有什么*不好的地方？*

看看候选人会想出什么会很有趣，你肯定会学到很多关于他/她如何使用该框架的知识。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2008-12-13T17:59:34.363

我总是会自己寻找软技能——没有双关语的意思。如此出色的 OO 设计、测试驱动开发、良好的多（编程）语言背景和全面的通用智能（我猜是把事情做好了！）。

一个聪明的开发人员在学习你需要他们知道的个别技术时应该不会有任何困难，即使他们以前从未看过它们——所以我不会太担心关于 WCF/紧凑框架等的具体问题。

我会让他们编写一些代码 - 找出他们知道什么以及他们如何工作的最佳方式。任何人都可以记住“引用类型和值类型有什么区别？”的答案。

* * *

## 回答 #9

> 赞同：13
> 
> 时间：2009-02-26T06:12:13.717

诚实地？

“什么是.NET？”

如果他们可以就 .NET 是什么、不是什么、它是如何使用、它由什么元素组成等给你一个明确的答案......如果他们能让你相信他们知道它是什么，那么他们很有可能很清楚。

事实上，很多人并不真正了解.NET 是什么。甚至那些为它编写程序的人。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2008-12-29T23:31:12.277

没有，真的。世界上最聪明的人可能不知道一些非常简单的问题的答案。不是因为它们很难，而仅仅是因为它们还没有遇到过。您应该查看整个软件包和开发人员的技能，而不是他们是否可以回答任意问题。

如果这个问题很容易用一两句话回答，那么告诉不知道的人就很容易了。您应该寻找他们对概念和推理能力的理解，而不是他们回答“每个 .NET 开发人员都应该能够回答”问题的能力。

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2008-12-13T17:54:09.147

了解引用类型和值类型之间的区别。

知道事件被存储为硬引用（即记住取消注册事件，否则应用程序将泄漏内存）。

字符串是不可变的。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2008-12-13T21:10:16.520

Martin Fowler[更喜欢设计技能而不是平台知识](http://martinfowler.com/bliki/PreferDesignSkills.html)。另一方面，您可以提出一个问题，该问题将显示设计模式和 .NET 平台的知识，如下所示：

*   说出您知道的设计模式和原则以及它们在 .NET Framework 中的用途？

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-12-15T12:43:16.293

我建议询问他们定期阅读的博客和他们从事的个人编程项目，因为这将显示出学习的意愿和对编程的热情。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-12-13T17:54:36.963

以下是我用来筛选申请 C# 程序员工作的程序员的一些方法：

引用类型和值类型有什么区别？

解释 IDisposable 接口、哪种 C# 语言构造需要它以及如何实现它。

如果将 null 作为参数传递给具有不允许该参数为 null 的协定的方法，您会抛出哪个异常？

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-04-11T11:33:51.813

“哪一个 ASP：你会在生产中使用什么控件，为什么？”

这将很快告诉您，您的主题是否曾经真正构建并维护过一个大型项目，其时间是否足以被 DataGrids 和 LinkBut​​tons 烧毁，或者他是否仍处于拖放“21 天自学”阶段。

（答案是 asp:Repeater、asp:PlaceHolder、asp:Literal 和 asp:Content）

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-12-13T17:57:19.280

什么是线程？

什么是GC？

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-12-13T20:59:18.680

这是一个有点多变的问题，并不是你现在应该能够完全回答的问题，而是你应该能够在适当的时候回答的问题：

“.NET 框架为完成任务 X 提供了什么？”

或者更具体地说：

“.NET 框架是否包含执行 X 的对象？”

例如，我最近花了几个小时开发一个对象，该对象经过优化以存储布尔数组并对其进行操作，例如执行集合方式的 NOT、OR、XOR、AND、设置所有值等。直到我完成编写所有单元测试并对其进行调整以获得最佳性能后，我才意识到我的“BoolArray”对象已经以“BitArray”的名称存在于 .NET 框架中。

这可能是一个很难回答的问题，因为很多时候关于使用什么对象/助手的最佳答案是您不知道或完全理解的那个。如果每个人都知道即使是简单的 StringBuilder，.NET 世界将会多么美好，这是一个可以显着提高性能的基本工具。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2008-12-17T10:49:48.190

我不会问那些“从教科书中知道的东西”的问题，而是问一些修补的东西，比如：

*   foreach 循环在纯 C# 中做了什么？（期待他写一个迭代器循环。）
*   什么是单例？
*   让他/她将字符串解析为日期时间（期望他/她使用 TryParse 而不是 try/catch）
*   实现单例、策略和命令模式
*   让他/她重构一段代码进行测试。期望他/她将外部服务从被测单元中抽象出来并实现他自己的服务测试替身（不提供模拟框架）

这些都不是 100% 确定的，这取决于我可能会问他们的人：

*   让他/她保护一个方法免受空输入（期望他/她使用多个返回来减少嵌套）
*   对象初始化器如何工作（期望他/她编写线程安全分配）

另外我会问他/她是如何学习他/她的东西的，以及他/她正在阅读什么（什么博客、书籍）。

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2009-01-14T13:39:19.853

我会建议一些问题集中在理解使用 dotnet 的编程概念上，例如

托管环境和非托管环境有什么区别？GC 的优缺点 JIT 的优缺点 如果我们需要开发应用程序 X，我们可以使用 dotnet 吗？为什么？（这将确定他如何看待 dotnet）

我还建议编写小方法，并要求他使用更好的 dotnet 类或标准方法以更好的性能重写它们。还要写不正确的方法（就任何而言）合乎逻辑的或其他的，并要求他更正它们。

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-02-26T06:05:21.970

除了已经提到的一些问题之外，我还喜欢以下内容：

*   什么是代表？
*   应用程序域是什么？
*   什么时候使用 lock 关键字？
*   标准库通用集合类线程安全吗？
*   什么是扩展方法？
*   XmlDocument 和 XmlReader 有什么区别？
*   您如何从应用程序配置文件中读取配置设置？

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2010-01-22T09:38:03.287

还有几个：

1.  部分班。以及它的局限性？
2.  密封类
3.  如何在 .NET 中进行本地化？
4.  数据库连接
5.  各种配置文件
6.  代表与活动
7.  非托管 dll 访问
8.  思考
9.  泛型类
10.  .NET 3.5 中最热门的
11.  您使用过的单元测试框架。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2010-01-23T16:37:24.990

这很有趣，并且有可能因为提出我的意见而被否决，因为我天生耳聋，被问到这样的问题需要更多的努力来传达我个人的想法。

坦率地说，我真的不会阅读太多典型问题，因为基本范式是“*你能在多大程度上表达你的想法和理解？*'，这确实是面试官正在寻找的。由于我的方式，沟通一直是我最大的弱点，而且很容易感到沮丧。

拥有知识并成为无所不知的人是理想的，但不幸的是，有些事情我不知道，但如果你真的不知道答案并承认而不是虚张声势，不要害怕通过这。如果面试官问我一个类似上述问题的问题，我不确定或误解/误解了这个问题，我会直接说出来，这可能会让我个人感到尴尬，但我已经学会了处理这个问题。

你会惊讶于有多少人实际上会胡说八道并虚张声势，在一天结束时，他们会隐喻地“脱裤子”。

我的 2cents，最好的问候，汤姆。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2008-12-13T17:59:48.497

还有几个：

垃圾收集的限制是什么。

了解终结器和 IDisposable。

请注意线程池以及何时使用它。

如果您正在做 GUI 应用程序 - 请注意 Windows GUI 是单线程的。

使用 foreach（我看到很多人在做 MoveNext 等）

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2010-01-22T10:27:17.807

我认为这不应该只是问题，我认识一些在你采访他们时表现出色的人，但一旦他们接触到真实的事物，他们就过于完美主义了，我会说他们无法对任务进行悲惨的编码。

我曾经接受过面试，我有点喜欢第一个雇主给我一份技术问卷让我填写 30 分钟的方法。如果一个人成功，那么他将被要求进行 1 小时的面试，内容包括性格判断和性格发现问题以及技术术语。

然后我被要求在 6 小时内开发一个三页 Web 应用程序。应用程序中施加的约束巧妙地涵盖了应用程序开发的主要方面，例如小型 ERD、分层设计、UI 一致性、控制特定问题，例如在 GridView 中使用单选按钮以及在网页上从数据库中获取和显示图像类型，一种算法开发，安全、加密、散列、数据表示和操作。

然后第二天，他们就开发的应用程序进行了 30 分钟的讨论，涵盖了性能瓶颈领域以及设计和使用算法的改进。以及 1 小时的可选测试，以改进您在上一步中开发的特定条件下的算法。

所以这花费了相当多的时间，但这样你可以确保你所雇用的人至少知道那些对优秀开发人员至关重要的概念。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2010-08-13T12:49:47.130

我宁愿给他一个问题，并要求他使用您知道的 .net 功能以及为什么您认为这是最好的解决方案来解决它。

这将破解候选人在技术、分析和解决问题能力方面的几乎所有能力，以及他解决问题的方法。

# security - 网络安全

> ID：365495
> 
> 赞同：4
> 
> 时间：2008-12-13T17:52:10.493
> 
> 标签：security, networking

在过去的三年里，我一直是一名 .net 开发人员。只是想知道网络安全领域。在这些领域工作的开发人员从事什么样的工作？我真的对网络安全知之甚少，但我的理解是这些人参与保护网络，防止对网络的攻击是显而易见的。谁能给我一些关于这个领域的细节，以及搬到这个领域需要什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T18:08:40.397

网络安全是一个浩瀚的课题。在开发人员方面，我认为您很可能会担心许多加密方案和流程安全性。有一些基本的事情，比如使用 SSL 处理程序的网络流量，以及更高级的主题，比如在程序处理（并且可能加密）它之后防止敏感操作的任何痕迹留在 RAM 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T18:30:13.910

看看罗斯安德森的“安全工程”。第一版和第二版的部分内容可在[此处](http://www.cl.cam.ac.uk/~rja14/book.html)免费在线获取。虽然他谈到了许多非网络问题，但这些原则大多适用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T19:12:01.673

今天，您需要成为 TCP/IP 协议方面的专家。从 ARP、DNS、UDP、ICMG、BGP 等等。大多数网络都是基于 IP 的，带有基于 IP 的防火墙。例如，防火墙将允许“端口 80 上的 TCP 流量”通过。您需要能够了解该流量是否是有效的网上冲浪、DOS 攻击或其他恶意行为。只有详细了解 IP 网络的工作原理，才能做到这一点。DNS 等其他协议也是如此。此外，对以太网通信和其他传输方式（如手机网络或 WiFi 网络）的较低层次的理解也很重要。我想这取决于您所说的“网络安全” - 对我来说，这在应用层之下。

# php - 由于长时间的mysql查询，如何防止php脚本超时

> ID：365496
> 
> 赞同：14
> 
> 时间：2008-12-13T17:52:28.107
> 
> 标签：php, mysql, timeout

我有一个由超时的 cron 任务运行的更新查询。在navicat 中执行时，查询平均需要五分钟才能执行。

代码看起来大致是这样的。这很简单：

```
// $db is a mysqli link
set_time_limit (0); // should keep the script from timing out
$query = "SLOW QUERY";
$result = $db->query($query);
if (!$result)
    echo "error"; 
```

即使脚本不应该超时，等待 sql 调用所花费的时间似乎仍然会超时。

有可以使用的异步调用吗？或者调整超时时间？

超时是否不同，因为它是从命令行而不是通过 Apache 调用的？

谢谢

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2008-12-13T18:34:02.903

我在某个地方遇到了同样的问题，并使用以下代码（文件的前两行）“解决”了它：

```
set_time_limit(0);
ignore_user_abort(1); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-13T18:39:37.463

根据[手册](http://us3.php.net/set_time_limit)：

> **注意**： set_time_limit() 函数和配置指令 max_execution_time 只影响脚本本身的执行时间。在确定脚本运行的最长时间时，不包括在脚本执行之外发生的活动所花费的任何时间，例如使用 system() 的系统调用、流操作、数据库查询等。

所以它不太可能与 PHP 的时间限制有任何关系。超时时您收到什么消息？也许涉及到 MySQL 设置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T17:57:22.650

您的 php 是否在安全模式下运行？引用[set_time_limit 的 PHP 手册](http://fi.php.net/set_time_limit)：

> 当 PHP 在安全模式下运行时，此功能无效。除了关闭安全模式或更改 php.ini 中的时间限制之外，没有其他解决方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T18:10:02.750

假设您在 linux 上，基于 Debian 的系统对 mod_php/php cgi 和 php-cli 有单独的配置。在不分离 cgi/cli 配置的不同 linux 系统上进行设置应该不会太难。

一旦你有单独的配置，我会调整你的 php cli 配置。禁用安全模式以及任何时间限制和内存限制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T18:10:05.090

查看 php,ini 中的一些资源限制变量：max_execution_time、max_input_time、memory_limit

您还可以在 PHP 本身中为脚本设置时间限制：http: [//ca3.php.net/set_time_limit](http://ca3.php.net/set_time_limit)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-18T17:50:58.663

我在我的一个 PHP 脚本中遇到了类似的东西，我在执行慢查询之前添加了这个内联：

```
$timeout_seconds = 3153600; // 1 year... 

// Make sure the PHP script doesn't time out
set_time_limit(0);
ignore_user_abort(1);

// Make sure the PHP socket doesn't time out
ini_set('default_socket_timeout', $timeout_seconds);
ini_set('mysqlnd.net_read_timeout', $timeout_seconds);

// Make sure the MySQL server doesn't time out
// Assuming your $link is a MySQLi object:
$link->query("SET SESSION connect_timeout=" . $timeout_seconds);
$link->query("SET SESSION delayed_insert_timeout=" . $timeout_seconds);
$link->query("SET SESSION have_statement_timeout='NO'");
$link->query("SET SESSION net_read_timeout=" . $timeout_seconds);
$link->query("SET SESSION net_write_timeout=" . $timeout_seconds); 
```

显然，您需要适当地设置秒数，但我根本不希望我的脚本超时。

PHP 初始化指令：[https ://www.php.net/manual/en/ini.list.php](https://www.php.net/manual/en/ini.list.php)

MySQL 服务器变量：[https ://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html](https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html)

注意：查看文档以获取更多信息，并验证变量是否与您使用的 PHP 和 MySQL 版本匹配。我正在使用 PHP 7.3 和 MySQL 5.7。

** 编辑：设置 PHP 超时对于我的脚本来说还不够，我还必须添加 MySQL SESSION 变量。

# iphone - 是否可以在 iPhone 上进行流式 WiFi 通信？

> ID：365510
> 
> 赞同：0
> 
> 时间：2008-12-13T18:03:35.400
> 
> 标签：iphone, wifi

我正在寻找开发需要在 iPhone 上进行点对点 WiFi 通信的 iPhone 应用程序。我想使用 WiFi 接口并在手机和 WiFi 设备之间进行应用程序流。有没有人有这方面的经验？甚至可能吗？我知道有一个发现应用程序，但我正在寻找更强大的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-13T18:47:56.840

据我所知（就目前的 SDK 而言），唯一可用的是通过现有网络连接进行通信。SDK 不允许设置无线网络连接或创建 ad-hoc 网络。我相信加入或创建 wifi 网络的唯一方法是通过设置应用程序。

# low-level - 在不使用 + 运算符的情况下添加两个数字的最佳方法是什么？

> ID：365522
> 
> 赞同：32
> 
> 时间：2008-12-13T18:13:51.353
> 
> 标签：low-level, addition

我和一个朋友在脑筋急转弯中来回走动，我不知道如何解决这个问题。我的假设是使用一些位运算符是可能的，但不确定。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-13T18:27:20.063

在 C 中，使用位运算符：

```
#include<stdio.h>

int add(int x, int y) {
    int a, b;
    do {
        a = x & y;
        b = x ^ y;
        x = a << 1;
        y = b;
    } while (a);
    return b;
}

int main( void ){
    printf( "2 + 3 = %d", add(2,3));
    return 0;
} 
```

XOR ( `x ^ y`) 是不带进位的加法。 `(x & y)`是每个位的进位。 `(x & y) << 1`是每个位的进位。

循环不断添加进位，直到所有位的进位为零。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-12-14T06:57:19.893

```
int add(int a, int b) {
   const char *c=0;
   return &(&c[a])[b];
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-12-13T19:09:20.150

没有+对吗？

```
int add(int a, int b) 
{
   return -(-a) - (-b);
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-13T18:46:21.413

定义“最佳”。这是一个python版本：

```
len(range(x)+range(y)) 
```

`+`执行列表连接，而不是添加。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-02-22T12:14:51.830

CMS 的 add() 函数很漂亮。它不应该被一元否定所玷污（非按位运算，相当于使用加法：-y==(~y)+1）。所以这是一个使用相同的仅按位设计的减法函数：

```
int sub(int x, int y) {
    unsigned a, b;
    do {
        a = ~x & y;
        b =  x ^ y;
        x = b;
        y = a << 1;
    } while (a);
    return b;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-13T18:16:48.040

欺骗。你可以否定这个数字并从第一个中减去它:)

如果做不到这一点，请查看二进制加法器的工作原理。:)

编辑：啊，我发布后看到你的评论。

二进制加法的细节在[这里](https://en.wikipedia.org/wiki/Two%27s_complement#Addition)。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-12-13T19:01:05.067

请注意，这适用于称为[波纹进位加法器的加法器](https://en.wikipedia.org/wiki/Adder_(electronics)#Ripple-carry_adder)，它可以工作，但性能不佳。大多数内置于硬件中的二进制加法器都是一种快速加法器，例如[进位预读加法器](https://en.wikipedia.org/wiki/Carry-lookahead_adder)。

如果将 carry_in 设置为 0，我的波纹进位加法器适用于无符号整数和 2 的补码整数，如果将 carry_in 设置为 1，则适用于 1 的补码整数。我还添加了标志以显示加法时的下溢或溢出。

```
#define BIT_LEN 32
#define ADD_OK 0
#define ADD_UNDERFLOW 1
#define ADD_OVERFLOW 2

int ripple_add(int a, int b, char carry_in, char* flags) {
    int result = 0;
    int current_bit_position = 0;
    char a_bit = 0, b_bit = 0, result_bit = 0;

    while ((a || b) && current_bit_position < BIT_LEN) {
        a_bit = a & 1;
        b_bit = b & 1;
        result_bit = (a_bit ^ b_bit ^ carry_in);
        result |= result_bit << current_bit_position++;
        carry_in = (a_bit & b_bit) | (a_bit & carry_in) | (b_bit & carry_in);
        a >>= 1;
        b >>= 1;
    }

    if (current_bit_position < BIT_LEN) {
        *flags = ADD_OK;
    }
    else if (a_bit & b_bit & ~result_bit) {
        *flags = ADD_UNDERFLOW;
    }
    else if (~a_bit & ~b_bit & result_bit) {
        *flags = ADD_OVERFLOW;
    }
    else {
        *flags = ADD_OK;
    }

    return result;
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2017-02-26T07:38:23.650

使用按位运算符的 Java 解决方案：

```
// Recursive solution
public static int addR(int x, int y) {

    if (y == 0) return x;
    int sum = x ^ y; //SUM of two integer is X XOR Y
    int carry = (x & y) << 1;  //CARRY of two integer is X AND Y
    return addR(sum, carry);
}

//Iterative solution
public static int addI(int x, int y) {

    while (y != 0) {
        int carry = (x & y); //CARRY is AND of two bits
        x = x ^ y; //SUM of two bits is X XOR Y
        y = carry << 1; //shifts carry to 1 bit to calculate sum
    }
    return x;
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2019-10-13T16:23:08.623

基于 Go 的解决方案

```
func add(a int, b int) int {

for {
    carry := (a & b) << 1
    a = a ^ b
    b = carry 
    if b == 0 {
        break
    }
}

return a 

} 
```

相同的解决方案可以在 Python 中实现如下，但是在 Python 中数字表示存在一些问题，Python 有超过 32 位的整数。所以我们将使用掩码来获取最后 32 位。

例如：如果我们不使用掩码，我们将不会得到数字的结果 (-1,1)

```
def add(a,b):   
    mask = 0xffffffff

    while b & mask:
        carry = a & b
        a = a ^ b
        b = carry << 1

    return (a & mask) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-12-13T18:16:19.837

为什么不像第二个数字一样频繁地增加第一个数字呢？

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-12-13T18:32:16.527

ADD 在汇编程序中作为单个指令而不是按位操作的某种组合实现的原因是它很难做到。您必须担心从给定的低位到下一个高位的进位。这是机器在硬件中快速完成的事情，但即使使用 C，您也无法在软件中快速完成。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2018-10-13T23:31:58.297

这是一个可移植的单行三元递归解决方案。

```
int add(int x, int y) {
    return y == 0 ? x : add(x ^ y, (x & y) << 1);
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-08-02T09:14:50.787

我在编码面试中将此视为问题 18.1。我的蟒蛇解决方案：

```
def foo(a, b):
"""iterate through a and b, count iteration via a list, check len"""
    x = []
    for i in range(a):
            x.append(a)
    for i in range(b):
            x.append(b)
    print len(x) 
```

该方法使用迭代，因此时间复杂度不是最优的。我相信最好的方法是使用按位运算在较低级别上工作。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2018-09-19T00:03:39.717

在 python 中使用按位运算符：

```
def sum_no_arithmetic_operators(x,y):
    while True:
        carry = x & y
        x = x ^ y
        y = carry << 1
        if y == 0:
            break
    return x 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-13T18:46:38.683

添加两个整数并不难；网上有很多二进制加法的例子。

一个更具挑战性的问题是浮点数！[在http://pages.cs.wisc.edu/~smoler/x86text/lect.notes/arith.flpt.html](http://pages.cs.wisc.edu/~smoler/x86text/lect.notes/arith.flpt.html)有一个例子

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2013-10-15T23:42:27.230

您可以使用位移位和 AND 操作来做到这一点。

```
#include <stdio.h>

int main()
{
    unsigned int x = 3, y = 1, sum, carry;
    sum = x ^ y; // Ex - OR x and y
    carry = x & y; // AND x and y
    while (carry != 0) {
        carry = carry << 1; // left shift the carry
        x = sum; // initialize x as sum
        y = carry; // initialize y as carry
        sum = x ^ y; // sum is calculated
        carry = x & y; /* carry is calculated, the loop condition is
                        evaluated and the process is repeated until
                        carry is equal to 0.
                        */
    }
    printf("%d\n", sum); // the program will print 4
    return 0;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-08-09T13:37:54.740

以与我们在纸上进行二进制加法相同的方式实现。

```
int add(int x, int y)
{
    int t1_set, t2_set;
    int carry = 0;
    int result = 0;
    int mask = 0x1;

    while (mask != 0) {
        t1_set = x & mask;
        t2_set = y & mask;
        if (carry) {
           if (!t1_set && !t2_set) {
               carry = 0;
               result |= mask;
           } else if (t1_set && t2_set) {
               result |= mask;
           }
        } else {
           if ((t1_set && !t2_set) || (!t1_set && t2_set)) {
                result |= mask;
           } else if (t1_set && t2_set) {
                carry = 1;
           }
        }
        mask <<= 1;
    }
    return (result);
} 
```

速度改进如下：

```
int add_better (int x, int y)
{
  int b1_set, b2_set;
  int mask = 0x1;
  int result = 0;
  int carry = 0;

  while (mask != 0) {
      b1_set = x & mask ? 1 : 0;
      b2_set = y & mask ? 1 : 0;
      if ( (b1_set ^ b2_set) ^ carry)
          result |= mask;
      carry = (b1_set &  b2_set) | (b1_set & carry) | (b2_set & carry);
      mask <<= 1;
  }
  return (result);
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-07-03T05:00:23.100

我自己在 C# 中解决了这个问题，但无法通过所有测试用例。然后我遇到了[这个](http://www.geeksforgeeks.org/add-two-numbers-without-using-arithmetic-operators/)。

这是 C# 6 中的一个实现：

```
public int Sum(int a, int b) => b != 0 ? Sum(a ^ b, (a & b) << 1) : a; 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2016-08-28T15:13:45.410

这是我在 Python 上的实现。当我们知道字节数（或位数）时，它运行良好。

```
def summ(a, b):
    #for 4 bytes(or 4*8 bits)
    max_num = 0xFFFFFFFF
    while a != 0:
        a, b = ((a & b) << 1),  (a ^ b)
        if a > max_num:
            b = (b&max_num) 
            break
    return b 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2017-04-01T02:46:21.373

如果输入符号相反，则投票最多的答案将不起作用。然而，以下将。我在一个地方作弊，但只是为了保持代码有点干净。欢迎任何改进建议

```
def add(x, y):
if (x >= 0 and y >= 0) or (x < 0 and y < 0):
    return _add(x, y)
else:
    return __add(x, y)

def _add(x, y):
if y == 0:
    return x
else:
    return _add((x ^ y), ((x & y) << 1))

def __add(x, y):
if x < 0 < y:
    x = _add(~x, 1)
    if x > y:
        diff = -sub(x, y)
    else:
        diff = sub(y, x)
    return diff
elif y < 0 < x:
    y = _add(~y, 1)
    if y > x:
        diff = -sub(y, x)
    else:
        diff = sub(y, x)
    return diff
else:
    raise ValueError("Invalid Input")

def sub(x, y):
if y > x:
    raise ValueError('y must be less than x')
while y > 0:
    b = ~x & y
    x ^= y
    y = b << 1
return x 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-05-28T17:26:05.780

这是 C++ 中的解决方案，您可以在我的 github 上找到它：[https ://github.com/CrispenGari/Add-Without-Integers-without-operators/blob/master/main.cpp](https://github.com/CrispenGari/Add-Without-Integers-without-operators/blob/master/main.cpp)

```
int add(int a, int b){
   while(b!=0){
      int sum = a^b; // add without carrying
      int carry = (a&b)<<1; // carrying without adding
      a= sum;
      b= carry;
    }
   return a;
 }
 // the function can be writen as follows :
 int add(int a, int b){
     if(b==0){
        return a; // any number plus 0 = that number simple!
    }
    int sum = a ^ b;// adding without carrying;
    int carry = (a & b)<<1; // carry, without adding
    return add(sum, carry);
  } 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-09-16T15:00:49.007

```
This can be done using Half Adder.
Half Adder is method to find sum of numbers with single bit.
A   B    SUM   CARRY   A & B    A ^ B
0   0    0     0        0         0
0   1    1     0        0         1
1   0    1     0        0         1
1   1    0     1        0         0

We can observe here that SUM = A ^ B and CARRY = A & B
We know CARRY is always added at 1 left position from where it was 
generated.
so now add ( CARRY << 1 ) in SUM, and repeat this process until we get 
Carry 0.

int Addition( int a, int b)
{
 if(B==0)
    return A;
 Addition( A ^ B, (A & B) <<1 )
}

let's add 7 (0111) and 3 (0011) answer will be 10 (1010) 
```

1.  A = 0100 和 B = 0110
2.  A = 0010 和 B = 1000
3.  A = 1010 和 B = 0000 最终答案是 A。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2022-02-01T08:58:46.680

我在 Swift 中实现了这个，我相信有人会从中受益

```
 var a = 3
   var b = 5
   var sum = 0
   var carry = 0

   while (b != 0) {
      sum = a ^ b
      carry = a & b
      a = sum
      b = carry << 1
   }

   print (sum) 
```

* * *

## 回答 #24

> 赞同：-2
> 
> 时间：2015-08-23T07:29:21.253

Python代码：（1）

```
add = lambda a,b : -(-a)-(-b) 
```

使用带有“-”运算符的 lambda 函数

(2)

```
add= lambda a,b : len(list(map(lambda x:x,(i for i in range(-a,b))))) 
```

# algorithm - 将 RSS 条目映射到 HTML 正文 w。非精确搜索

> ID：365525
> 
> 赞同：1
> 
> 时间：2008-12-13T18:15:54.220
> 
> 标签：algorithm, rss, screen-scraping, html-content-extraction, fuzzy-search

你将如何解决这个问题？

您正在抓取博客的 HTML。博客的一些 HTML 是博客文章，一些是格式、侧边栏等。如果有的话，您希望能够分辨 HTML 中的哪些文本属于哪个文章（即永久链接）。

我知道你在想什么：你可以只看 RSS 而完全忽略 HTML！但是，RSS 通常只包含非常短的摘录或删除您可能感兴趣的链接。您希望通过同时使用同一页面的 HTML 和 RSS 从本质上打败 RSS 的摘录。

RSS 条目如下所示：

```
标题
帖子正文摘录
永久链接

```

HTML 格式的博客文章如下所示：

```
标题（可能被永久链接包围）
...
永久链接，也许
...
帖子正文
...
永久链接，也许
```

因此 HTML 页面包含相同的字段，但预先不知道永久链接的位置，并且这些字段将被一些主要是 HTML 和空白的噪声文本分隔，但也可能包含一些额外的元数据，例如“由 Johnny 发布"或日期或类似的东西。如下所述，文本在 HTML 和 RSS 中也可能略有不同。

附加规则/注意事项：

*   标题可能不是唯一的。这种情况发生的频率比您想象的要多。我见过的例子：“周一综述”、“TGIF”等。
*   标题甚至可以留空。
*   RSS 中的摘录也是可选的，但假设必须至少有非空白摘录或非空白标题
*   RSS 摘录可能包含完整的帖子内容，但更有可能包含帖子正文开头的简短摘录
*   假设永久链接必须是唯一的，并且在 HTML 和 RSS 中必须相同。
*   RSS 和 HTML 中的标题、摘录和帖子正文的格式可能略有不同。例如：
    *   RSS 可能在标题或正文中去除了 HTML，或者在 HTML 页面上可以添加更多 HTML（例如用某些东西包围文章正文的第一个字母）或格式可能略有不同
    *   文本的编码可能略有不同，例如在 RSS 中是 utf8，而在 HTML 中的非 ascii 字符总是使用 & 号编码。但是，假设这是英文文本，非 ascii 字符很少见。
    *   可能存在编码错误的 Windows-1252 可怕性。对于像弯引号这样的符号字符，这种情况经常发生。但是，可以安全地假设大部分文本都是 ascii。
    *   可能会在任何一个方向上折叠，尤其是在标题中。因此，他们可以将 HTML 页面中的标题全部大写，但不能在 RSS 中。
*   假定 RSS 提要和 HTML 页面中的条目数不同。要么有更多或更少的旧条目。我们只能期望只获得出现在两者中的那些帖子。
*   RSS 可能会滞后。HTML 页面中可能有一个新条目尚未出现在 RSS 提要中。如果 RSS 通过 Feedburner 进行联合，则可能会发生这种情况。同样，我们只能期望解析那些同时出现在 RSS 和 HTML 中的帖子。
*   帖子的正文可以很短也可以很长。

100% 准确率*不是*限制。但是，越准确越好。

嗯，你会怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T19:54:00.257

我会为每个主要的博客引擎创建一个刮板。从每页一篇文章的正文开始。

如果幸运的话，引擎会提供合理的 XHTML，所以你可以想出一些有用的 XPath 表达式来获取与文章对应的节点。如果不是，那么恐怕是[TagSoup](http://home.ccil.org/~cowan/XML/tagsoup/)或[Tidy](http://tidy.sourceforge.net/)将其强制转换为格式良好的 XML。

从那里，您可以查找元数据和全文。这应该安全地删除页眉/页脚/侧边栏/小部件/广告，尽管可能会留下嵌入的对象等。

将页面分割成文章元数据、文本、评论等，并将其放入相当合理的 RSS/Atom 项目中也应该相当容易 (TM)。

这将是获取 RSS 提要（非全文）并将其转换为全文（通过遵循官方 RSS 中给出的永久链接）的基础。

一旦你有了一个博客引擎的爬虫，你就可以开始考虑编写一个检测器——这将是“给定一个页面，它是用什么博客引擎发布的”的基础。

有了足够多的爬虫和检测器，应该可以将给定的 RSS/Atom 提要指向外部并将其转换为全文提要。

但是，这种方法存在许多问题：

*   虽然您可能能够针对 5 大博客引擎，但可能有一些您只需要拥有的博客没有被它们覆盖：例如[，维基百科上列出了 61 个引擎](http://en.wikipedia.org/wiki/Category:Blog_software)；编写自己的博客引擎的人[每个](http://www.glasshalfempty.co.uk/)人都需要自己的刮板。
*   每次博客引擎更改版本时，您都需要更改检测器和抓取工具。更准确地说，您需要添加一个新的刮板和检测器。检测器必须变得越来越挑剔以区分同一引擎的一个版本和下一个版本（例如，每次[slashcode](http://www.slashcode.com/)更改时，它通常会更改 HTML，但[不同的](http://slashdot.org) [站点](http://kuro5hin.org)使用不同版本的 slash）。

我正在尝试考虑一个不错的后备方案，但一旦有我就会进行编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T10:42:52.230

**RSS**实际上很容易使用 XPath 解析任何 XML 解析器（或正则表达式，但不建议这样做），您正在浏览 <item> 标记，寻找 <title>、<link>、<description> 。

然后，您可以将它们作为不同的字段发布到数据库中，或者直接将它们合并到 HTML 中。如果 <description> 丢失，您可以抓取链接（一种方法是比较多个页面以清除 HTML 的布局部分）。

# internet-explorer - 在所有浏览器中旋转图像（IE 中的画布？）

> ID：365532
> 
> 赞同：2
> 
> 时间：2008-12-13T18:20:46.753
> 
> 标签：internet-explorer, image, canvas, rotation, angle

我终于开始使用画布，却发现它没有在 IE 中实现。我尝试从谷歌探索画布以在 Internet Explorer 中使用它，但它不适用于我的代码（[http://uptowar.com/test.php](http://uptowar.com/test.php) - 小错误，尽管它在旋转时不会删除旧图像）。

那么，有没有其他方法可以围绕其底部中心角平滑旋转图像？也许是JavaScript？或者有没有办法用 IE 和画布来做到这一点？

编辑：谷歌浏览器似乎也为画布示例添加了一个丑陋的边框..必须有其他平滑的方式吗？

Edit2：尝试了一种 hacky javascript 方式：它导致市长滞后并破坏图像（[http://uptowar.com/test2.php](http://uptowar.com/test2.php)），有人知道一种工作方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-01T02:37:24.070

[RaphaelJS](http://raphaeljs.com/)是一个很棒的跨浏览器 JavaScript 库，可以完全满足您的需求。我强烈推荐它。如果您访问该站点，甚至还有一个涉及旋转图像的特定示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T15:02:29.587

有一些框架（例如 Dojo）提供了跨浏览器的绘图界面。他们在大多数浏览器上使用画布，在 IE 风格上使用 VML。VML 是矢量标记语言，是 SVG 的一种专有祖先。

我在谷歌搜索了*svg vml 库*，很惊讶有很多库，显然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T03:32:43.877

也许只是使用动画 .gif 文件

如果您想要更多控制权，Flash 是另一种选择。

# flash - 使用 as3 的 Flash 动画中的对角线移动

> ID：365559
> 
> 赞同：0
> 
> 时间：2008-12-13T18:44:00.997
> 
> 标签：flash, animation

我正在尝试使用 as3 在我的 Flash 动画中产生云效果

我可以通过动作脚本生成云，但真正的问题是如何使它们在屏幕的一端生成并沿对角线移动到另一端...

有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T22:29:32.570

这是您想要做的准系统版本，handleEnterFrame 函数将在每帧运行一次（并且对于每个云，但我猜您会更喜欢更简单的解决方案）

```
package {

    import flash.display.Sprite;
    import flash.events.Event;

    public class Cloud extends Sprite{

        public var xSpeed:Number = 1;
        public var ySpeed:Number = 1;

        public function Cloud() {
            addEventListener(Event.ENTER_FRAME, handleEnterFrame);
        }

        public function handleEnterFrame(e:Event):void {
            x += xSpeed;
            y += ySpeed;
        }

    }

} 
```

在云符号的链接菜单中设置“导出为动作脚本”，并将类名设置为“云”。
此代码应放置在名为“Cloud.as”的外部文件中，与您的 Flash 文件位于同一目录中。
（感谢[aaaidan](https://stackoverflow.com/users/26331/aaaidan)指出这一点）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-07T02:13:55.910

查看一个名为 Tweener 的包：[http ://code.google.com/p/tweener/](http://code.google.com/p/tweener/)

我使用 Tweener 来满足我所有的动画需求。您只需编写一行代码，如下所示：

Tweener.addTween(cloudObject, {x: targetX, time: 3.0});

# .net - 什么是卫星组件？

> ID：365569
> 
> 赞同：54
> 
> 时间：2008-12-13T18:57:10.487
> 
> 标签：.net, satellite-assembly

什么是卫星组件，什么时候应该使用它们？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2008-12-13T19:13:29.313

来自 MSDN 的定义是这样的：“一个 .NET Framework 程序集包含特定于给定语言的资源。使用附属程序集，您可以将不同语言的资源放在不同的程序集中，并且只有在以下情况下才能将正确的程序集加载到内存中用户选择以该语言查看应用程序。”

这意味着您可以使用默认语言开发应用程序，并增加对语言环境变化做出反应的灵活性。例如，假设您在 en-US 语言环境中开发了您的应用程序。现在，您的应用程序具有多语言支持。当您在印度等地部署代码时，您希望以非英语的国家语言显示标签和消息。

附属程序集提供了这种灵活性。您可以使用已翻译的字符串创建任何简单的文本文件，创建资源，然后将它们放入 bin\debug 文件夹。就是这样。下一次，您的代码将读取当前线程的 CurrentCulture 属性并相应地加载适当的资源。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-01-21T16:30:37.983

1.  附属程序集是一个编译库 (DLL)，其中包含特定于给定文化的“可本地化”资源，例如字符串、位图等。

2.  在创建多语言 UI 应用程序时，您可能会使用附属程序集。它们用于在多种文化中部署应用程序，每种文化有 1 个附属程序集（默认行为）

更多信息：http: [//blogs.msdn.com/b/global_developer/archive/2011/07/22/introduction-to-satellite-assemblies.aspx](http://blogs.msdn.com/b/global_developer/archive/2011/07/22/introduction-to-satellite-assemblies.aspx)

# c++ - mmioOpen 出现奇怪的文件未找到错误

> ID：365579
> 
> 赞同：3
> 
> 时间：2008-12-13T19:07:24.117
> 
> 标签：c++, windows, xaudio2

我一直在玩 XAudio2 但遇到了一些奇怪的`mmioOpen`问题

由于某种原因，它似乎失败了`MMIOERR_FILENOTFOUND`，即使文件在那里，实际上该文件与我正在加载的其他文件位于同一目录中，这些文件工作正常......

我用来测试的 wav 文件只是 August SDK 示例中的文件，如果我将名称复制到 XAudio2BasicSound 示例中，这些文件可以正常工作......在某些情况下，我实际上不得不将声音重命名为 1.wav 之类的东西让他们打开...

```
//"Counting.wav" does not work
Sounds.append(Audio.Sound(L"c:/test/xaudio2/Counting.wav"))
Sounds.append(Audio.Sound(L"Electro_1.wav"))
//"heli.wav" does not work
Sounds.append(Audio.Sound(L"c:/test/xaudio2/heli.wav"))
//"HipHoppy_1.wav" does not work
//"c:/test/xaudio2/HipHoppy_1.wav" does not work
Sounds.append(Audio.Sound(L"1.wav"))
Sounds.append(Audio.Sound(L"MusicMono.wav"))
Sounds.append(Audio.Sound(L"MusicSurround.wav"))
//"Techno_1.wav" does not work
//"c:/test/xaudio2/Techno_1.wav" does not work
Sounds.append(Audio.Sound(L"2.wav")) 
```

我只是使用 SDKwavefile.h 中的 wav 类。我添加了`mmioinfo`结构来获取错误号，并且在它给我的不起作用的情况下`MMIOERR_FILENOTFOUND`，即使文件在那里，都在同一个目录中......我只是稍微更改了第 63 行，所以我可以从中获取错误代码`mmioOpen`. 除了将它传递给方法`Audio.Sound`之外，不对字符串做任何事情。`wav.Open`

```
MMIOINFO info;
ZeroMemory(&info, sizeof(MMIOINFO));
m_hmmio = mmioOpen( strFileName, &info, MMIO_ALLOCBUF | MMIO_READ );
if(!h_hmmio)
    std::wcout << L"Error Code: " << info.wErrorRet << L"\n"; 
```

我真的看不出它为什么无法打开其中一些波浪的原因......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-17T11:11:20.927

改变

```
m_hmmio = mmioOpen( strFileName, &info, MMIO_ALLOCBUF | MMIO_READ ) 
```

至

```
m_hmmio = mmioOpen( strFileName, NULL, MMIO_ALLOCBUF | MMIO_READ ) 
```

# asp.net - ASP.NET Ajax 日历

> ID：365583
> 
> 赞同：2
> 
> 时间：2008-12-13T19:09:13.067
> 
> 标签：asp.net, ajax, calendar

我正在使用 MS AJAX ASP.NET 组件（日历扩展器），我发现了这个问题。

有些工作日没有显示....

我上传了一张图片，以便您可以准确查看它的显示方式...

图片右侧（calnder）取自微软的样品。

你知道是什么导致了这个问题吗？

见截图： http: [//www.sajtkik.com/calendar.jpg](http://www.sajtkik.com/calendar.jpg)

多谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T19:15:55.380

在跨不同浏览器使用 MS“Ajax”对象时，我已经看到了足够多的奇怪行为，如果可以避免，建议不要使用 Calendar 对象。有足够多的客户端 (JS) 库来存储明显更好的日历。

为什么不试试[jQuery 日历](http://marcgrabanski.com/article/jquery-calendar-version-2)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T20:03:03.020

您不需要了解太多关于 javascript 的知识即可使用 JQuery。它比 Javascript 更简单，只需几行代码即可在页面上使用 JQuery 日历。

但当然，要好需要一些努力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T20:07:37.443

看起来您的页面 CSS 会影响此日历标记。您可以使用 FireBug 查看哪些 CSS 规则会产生这种效果。

# apache-flex - Flex著名的2048安全违规错误，跨域

> ID：365591
> 
> 赞同：0
> 
> 时间：2008-12-13T19:17:18.277
> 
> 标签：apache-flex, flash, apache, networking

我认为尝试访问其他域时会发生 2048 安全违规错误。

我有：

**“安全沙箱违规： http: [//127.0.0.1/site_media/main.swf](http://127.0.0.1/site_media/main.swf)无法从 127.0.0.1:80 加载数据”**，是同一个域吗？解决办法是什么 ？

在做

```
var loader:MultipartLoader = new MultipartLoader("http://127.0.0.1/create/"); 
```

我错过了什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-15T06:40:35.853

尽管被称为“跨域”策略文件，但该策略实际上适用于域和端口的组合：就 FP 的安全策略而言，localhost:80 和 localhost:443 并不是一回事。我也不认为 Flash Player 本身假定默认端口为 80，因此“localhost”和“localhost:80”也不会被视为相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-15T04:41:40.073

如果 Jon Romero 的建议不起作用，您也可以尝试使用相对 URL：

```
var loader:MultipartLoader = new MultipartLoader("/create/"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T22:27:23.853

尝试使用，本地主机。如果这不起作用，只需创建一个跨域文件。

# fraud-prevention - 用户身份验证

> ID：365597
> 
> 赞同：0
> 
> 时间：2008-12-13T19:27:39.503
> 
> 标签：fraud-prevention

如果我正在建立一个网站，我将如何确保给我信用卡号的人（例如）是有权使用它的人？也许更一般地说，我将如何减少欺诈和被盗 ID 使用的机会，无论是用于购买还是系统访问。

我不在这个领域（在线购买）工作，但我认为用户身份验证必须是一项非常困难/棘手的工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T19:34:08.603

我想说的是坚持行业标准方法。

如果某人可以提供与卡支付网关进行验证的信息，则假定他们拥有该卡。作为其中的一部分，例如，[万事达卡/VISA 3D 身份验证](http://www.advansys.com/default.asp/p=87)方案为在线支付添加了密码。

您可以尝试比这种带有欺诈预防的[2 因素身份验证](http://en.wikipedia.org/wiki/Two-factor_authentication)更进一步，但信用卡公司对它有更多的既得利益，所以只要跟随他们的领导。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T20:15:56.630

另一种常见的方法是[地址验证系统](http://en.wikipedia.org/wiki/Address_Verification_System)，被许多在线供应商使用。

# .net - 智能导航

> ID：365600
> 
> 赞同：4
> 
> 时间：2008-12-13T19:32:29.837
> 
> 标签：.net

.NET 中的智能导航是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T19:40:50.477

SmartNavigation 是 System.Web.UI 中 Page 类的属性。当请求进入 Internet Explorer 5.5 或更高版本并且 SmartNavigation 已打开（设置为 true）时，将执行以下操作：

*   消除了导航引起的闪灯
*   从一个页面移动到另一个页面时，滚动位置保持不变
*   元素焦点在导航之间保持不变
*   仅保留浏览器历史记录中的最后一个页面状态

这是一篇关于它的[好文章](http://msdn.microsoft.com/en-us/magazine/cc163735.aspx)。

*警告*它不适用于 IE 以外的其他浏览器。不应用于公共网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T19:34:51.533

ASP.NET 的一项功能，它允许网页执行回发并显示新内容，而不会闪烁或跳回页面顶部。我认为现在 AJAX 存在的地方并不多。

# python - 以列格式打印数据的最佳方法？

> ID：365601
> 
> 赞同：0
> 
> 时间：2008-12-13T19:33:09.587
> 
> 标签：python, html, css, formatting

我正在使用 Python 以用户不友好的格式读取数据并将其转换为更易于阅读的格式。我输出的记录通常只是姓氏、名字和房间代码。一世

我想*输出*一系列页面，每个页面包含总记录的一个连续子集，分为多个列，每列包含页面上总记录的一个连续子集。（换句话说，您将阅读第一列，移至下一列，移至下一列，等等，然后从下一页重新开始......）

我现在面临的问题是，对于输出格式，我几乎可以肯定仅限于 HTML（以及 Javascript、CSS 等）。将数据转换为这种列格式的最佳方法是什么？例如，如果我确定纸张的可打印区域将容纳 20 条垂直记录和 5 条水平记录，我可以轻松打印 5x20 的表格，但我不知道是否有办法指示分页符 - 和我不知道是否有任何方法可以以编程方式计算页面上可以容纳多少记录。

你会如何处理这个问题？

**编辑：** 我说我的输出受限的原因：我必须在一台计算机上生成文件，然后将其带到另一台计算机上，在该计算机上我们无法安装新软件，并且现有软件的选择不是最佳的。该文件本身仅用于制作物理打印输出（这是最终用户实际使用的打印输出），但我在计算机上可以打印的时间将受到限制，因此我需要文件全部准备就绪，无需大量调整即可立即打印。

现在我已经设法找到一个可以在目标机器上使用的文字处理器，所以我要看看我是否可以定位文字处理器使用的格式。

**编辑：** 一旦我知道有一个我可以使用的文字处理器，我就用我想要的设置（列和选项卡设置，小点大小的等宽字体等）制作了一个简单的骨架文件，然后测量我有多少个字符得到每列的每一行以及每列得到多少行。我已经非常仔细地观看了运行，以确保没有一些奇怪的行以某种方式超出了每行字符的准则（当然，等宽字体不应该发生这种情况，但是你最终会出现多少次必须弄清楚为什么“不应该”发生的事情无论如何都会发生？）

如果目标机器上没有我可以使用的文字处理器，我可能会将 PDF 视为一种输出格式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T22:39:53.953

“如果我确定纸张的可打印区域可以垂直容纳 20 条记录，水平容纳 5 条记录”

你确实知道。

你知道你的纸的大小。你知道你的字体的大小。你可以很容易地做数学。

“几乎可以肯定仅限于 HTML ......”没有多大意义。这是一个网络应用程序吗？页面可以有一个“上一个”和“下一个”按钮来逐页浏览？选择一个适合您的尺寸，并使用“上一个”和“下一个”按钮显示一个完整的页面。

如果它应该是一个正确打印的 HTML 页面，那就很难了。你可以做一些 CSS 的事情，但你会更乐意创建一个 PDF 文件。

获取[PyX](http://pyx.sourceforge.net/)或[ReportLab](http://www.reportlab.com/)并创建一个可以正确打印的 PDF。

我——就个人而言——对这一切都没有耐心。我尝试将这种东西放入 CSV 文件中。然后我的用户可以使用工具电子表格打开 CSV（Open Office Org 有一个很好的），然后调整列并使用它进行打印。

# language-design - 创建自己的语言

> ID：365602
> 
> 赞同：9
> 
> 时间：2008-12-13T19:33:12.597
> 
> 标签：language-design

如果我想创建自己的语言，有什么工具可以帮助我吗？我听说过 yacc，但我想知道如何在语言中实现我想要的功能。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-13T20:02:09.093

密切相关的问题（全部通过在`[compiler]`stackoverflow 上搜索得到）：

*   [解析器、解释器和编译器的学习资源](https://stackoverflow.com/questions/41785/learning-resources-on-parsers-interpreters-and-compilers)

*   [学习编写编译器](https://stackoverflow.com/questions/1669/learning-to-write-a-compiler)

*   [构建一个简单的解释器](https://stackoverflow.com/questions/256629/constructing-a-simple-interpreter)

*   ...

和类似的主题（来自同一个搜索）：

*   [引导语言](https://stackoverflow.com/questions/13537/bootstrapping-a-language)

*   [我们应该知道多少编译器？](https://stackoverflow.com/questions/351690/how-much-of-the-compiler-should-we-know)

*   [用自己的语言编写编译器](https://stackoverflow.com/questions/193560/implementing-a-compiler-in-itself)

*   ...

* * *

编辑：我知道与 stackoverflow 相关的问题搜索不是我们想要的，但我们真的需要这个主题的第 n 次迭代吗？呸！

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-13T19:49:36.230

我推荐的第一个工具是 Dragon Book。这是构建编译器的参考。设计一门语言绝非易事，实现它更是难上加难。龙书有帮助。本书甚至参考了标准的 unix 工具 lex 和 yacc。gnu 等效工具称为 flex 和 bison。它们都生成词法分析器和解析器。还有更现代的工具用于生成词法分析器和解析器，例如对于 java 有 ANTLR（我还记得 javacc 和 CUP，但我自己只使用了 ANTLR）。ANTLR 结合了解析器和词法分析器以及可用的 Eclipse 插件这一事实使其使用起来非常舒适。但是要比较它们，你需要的解析器类型，并知道你需要它们，你应该阅读 Dragon 的书。您还需要考虑其他一些事情，例如运行时环境、编程范式......

如果您已经有了某些设计理念并且需要某个步骤或细节的帮助，那么 anwsers 可能会更有帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-13T19:40:03.880

ANTLR 是一个用 Java 编写的非常好的解析器生成器。还有一[本很棒的书](https://rads.stackoverflow.com/amzn/click/com/0978739256)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T20:02:43.037

我喜欢 Flex (Fast Lex) [词法扫描器]
和 Bison (A Hairy Yacc) [Yet another compiler compiler]

两者都是免费的，可用于所有 *NIX 安装。对于 Windows，只需安装 cygwin。
但我老同学。

通过使用这些工具，您还可以在 Internet 上找到许多流行语言的 lex 规则和 yacc 语法。从而为您提供快速启动和运行的方法，然后您可以随时自定义语法。

示例：算术表达式处理 [优先顺序等是一个完蛋的问题] 您可以从网上快速获取此语法。

可以考虑的替代方法是编写 GCC 的前端扩展。
不平凡，但如果你想要一种编译语言，它会在代码生成部分节省大量工作（你仍然需要了解爱和理解 flex/bison）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-14T08:18:04.083

我从未完成过完整的语言，我使用过 rply 和 llvmlite 实现了一个简单的 foxbase 语言，在[https://github.com/acekingke/foxbase_compiler](https://github.com/acekingke/foxbase_compiler)

所以如果你想使用python，`rply`或者`llvmlite`是有帮助的。如果你想使用 golang，`goyacc`也许有用。但是你应该通过手工硬编码来编写一个词法分析器。或者你可以使用[https://github.com/acekingke/lexergo](https://github.com/acekingke/lexergo)来简化它。

# html - Firefox 插件以智能方式复制文本及其格式？

> ID：365603
> 
> 赞同：3
> 
> 时间：2008-12-13T19:33:14.017
> 
> 标签：html, firefox, plugins

查看网页时，我想将一段带有 html 格式的文本复制到一个片段中。这意味着如果某些文本是粗体和蓝色的，我希望该工具在 html 中创建一个样式或类，使文本变为蓝色。一切都包含在生成的 html 中。

我已经下载了一个类似的插件，但类定义仍然是外部的，这意味着我必须单独获取它们。非技术用户在这里会不知所措。我希望用户能够复制并粘贴到新网页，并且该页面可以正常工作，因为复制的 html 包含所有内容。

这不一定是 FF 插件。它可以是 IE 或 Windows 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-02T18:51:50.383

我认为您可以通过使用 Firebug for Firefox 扩展来实现这一点。我经常使用它来导出网页的内容以用于重建类似的对象。这还是太技术性了吗？我认为 Firebug 是一个强大且可行的选择，值得学习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-26T10:31:03.067

试试[SnappySnippet](https://chrome.google.com/webstore/search/snappysnippet)，它是一个 Chrome 扩展，允许复制 html 和元素的所有相关 css 样式。它将自身集成到 Chrome 控制台中。我希望这有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T20:29:10.347

我认为复制操作已经这样做了。如果我复制此页面并将其粘贴到所见即所得的编辑器中，例如 TinyMCE（包含在 Wordpress 中），我会得到格式。例如，此页面的文本是（粘贴的）：

```
<h2><a href="http://stackoverflow.com/questions/365603/firefox-plugin-to-copy-text-with-its-formatting-intelligently">Firefox plugin to copy text with its formatting Intelligently?</a></h2> 
```

复制 HTML 标记，但不复制外部 CSS。我怀疑如果可能的话，创建一段将应用于您的独立代码片段的 CSS 在 DOM 层次结构中具有的样式将非常困难。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-09T13:58:33.823

这似乎是您正在寻找的：

**网页设计海盗：** [https ://addons.mozilla.org/en-CA/firefox/addon/web-design-pirate-for-devtools/](https://addons.mozilla.org/en-CA/firefox/addon/web-design-pirate-for-devtools/)

它在开发人员工具中创建了一个新的“海盗”选项卡，让您可以获取所需的元素，包括所有相关的 CSS。

# php - php fsockopen

> ID：365608
> 
> 赞同：2
> 
> 时间：2008-12-13T19:37:16.240
> 
> 标签：php, sockets

我在使用 fsockopen 连接到服务器的服务器上有一个简单的 php 脚本。

```
<?php
$fp = fsockopen("smtp.gmail.com", 25, $errno, $errstr, 30);
if (!$fp) {
    echo "$errstr ($errno)<br />\n";
} else {
    echo fgets($fp, 1024);
    fclose($fp);
}
?> 
```

问题是脚本超时并且无法连接。例如，如果我将端口从 25 更改为 80，它在任何主机上都可以正常工作。因此，无论我使用什么主机，问题似乎都只是端口 25，我尝试了很多，并且都适用于端口 80 和其他端口，但对于 25 失败。
连接不会被防火墙阻止，就像我从 shell telnet 它成功连接到任何主机上的任何端口一样。
知道可能是什么问题，因为它真的很奇怪吗？

LE：如果我从 shell 运行相同的 php 脚本，php scriptname.php 它可以工作，所以只有当我通过 http 运行它时它才会失败。我有 SuPHP 的 apache，所以问题出在某个地方

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T19:50:05.560

有趣...一些防火墙可以阻止特定程序与特定端口的连接。请再次检查，尝试完全停止防火墙。还要尝试停止任何反间谍软件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-15T03:08:01.243

就像*maxnk*提到的防火墙是最有可能的问题，无论是在服务器上，还是由您的 ISP 造成的。端口 25 经常被防火墙作为防止垃圾邮件的方法。

作为一个快速测试，由于您提到了 gmail，您可能想尝试连接到端口 587。除了端口 25 之外，Gmail 还会在此备用端口上侦听 smpt，以帮助用户绕过过于严格的防火墙。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-14T08:32:07.987

我也遇到了一些关于 PHP 套接字处理的奇怪问题。它最终成为运行它的系统的问题。您是否尝试过在另一台机器上运行您的代码？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-15T08:35:20.100

我认为连接问题与您的机器有关。我刚刚将您的代码复制到我的机器（linux suse）上的脚本中，并使用 php -f test_script 运行它。我收到以下消息

> 220 mx.google.com ESMTP j8sm1814228gvb.0

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-04T16:45:19.080

CentOS 可以启用 SELinux，这可能会导致连接异常。你检查过你的错误日志吗？

# c# - 在 .NET 中，哪个循环运行得更快，“for”还是“foreach”？

> ID：365615
> 
> 赞同：402
> 
> 时间：2008-12-13T19:45:42.947
> 
> 标签：c#, .net, performance, for-loop

在 C#/VB.NET/.NET 中，哪个循环运行得更快，`for`或者`foreach`？

自从[很久以前](https://docs.microsoft.com/previous-versions/dotnet/articles/ms973839(v=msdn.10))我读到循环比循环`for`运行得更快时，我就认为它适用于所有集合、泛型集合、所有数组等。`foreach`

我搜索了谷歌并找到了几篇文章，但大多数都没有结论（阅读文章的评论）并且是开放式的。

理想的做法是列出每个场景以及相同的最佳解决方案。

例如（只是应该如何做的一个例子）：

1.  用于迭代 1000 多个字符串的数组 -`for`优于`foreach`
2.  用于迭代`IList`（非通用）字符串 -`foreach`优于`for`

在网上找到了一些相同的参考资料：

1.  [Emmanuel Schanzer 的原始大旧文章](https://docs.microsoft.com/previous-versions/dotnet/articles/ms973839(v=msdn.10))
2.  [CodeProject FOREACH 与。为了](https://www.codeproject.com/KB/cs/foreach.aspx)
3.  [博客 -`foreach`做或不做`foreach`，这是个问题](https://docs.microsoft.com/archive/blogs/kevin_ransom/to-foreach-or-not-to-foreach-that-is-the-question)
4.  [ASP.NET 论坛 - NET 1.1 C#`for`与`foreach`](https://web.archive.org/web/20100123104946/http://weblogs.asp.net/mdavey/archive/2004/02/25/79504.aspx)

[编辑]

除了它的可读性方面，我对事实和数字真的很感兴趣。在某些应用程序中，最后一英里的性能优化确实很重要。

* * *

## 回答 #1

> 赞同：418
> 
> 时间：2008-12-13T20:14:50.377

Patrick Smacchia 上个月[在博客中谈到了这一点](http://codebetter.com/blogs/patricksmacchia/archive/2008/11/19/an-easy-and-efficient-way-to-improve-net-code-performances.aspx)，得出以下结论：

> *   List 上的 for 循环比 List 上的 foreach 循环便宜 2 倍多。
> *   在数组上循环比在 List 上循环便宜大约 2 倍。
> *   因此，使用 for 在数组上循环比使用 foreach 在 List 上循环便宜 5 倍（我相信这是我们所有人都在做的事情）。

* * *

## 回答 #2

> 赞同：177
> 
> 时间：2009-01-23T08:26:50.420

[首先，对德米特里（现已删除）的回答](https://stackoverflow.com/a/472200)提出反诉。对于数组，C# 编译器发出的代码与`foreach`等效`for`循环的代码基本相同。这就解释了为什么对于这个基准，结果基本相同：

```
using System;
using System.Diagnostics;
using System.Linq;

class Test
{
    const int Size = 1000000;
    const int Iterations = 10000;

    static void Main()
    {
        double[] data = new double[Size];
        Random rng = new Random();
        for (int i=0; i < data.Length; i++)
        {
            data[i] = rng.NextDouble();
        }

        double correctSum = data.Sum();

        Stopwatch sw = Stopwatch.StartNew();
        for (int i=0; i < Iterations; i++)
        {
            double sum = 0;
            for (int j=0; j < data.Length; j++)
            {
                sum += data[j];
            }
            if (Math.Abs(sum-correctSum) > 0.1)
            {
                Console.WriteLine("Summation failed");
                return;
            }
        }
        sw.Stop();
        Console.WriteLine("For loop: {0}", sw.ElapsedMilliseconds);

        sw = Stopwatch.StartNew();
        for (int i=0; i < Iterations; i++)
        {
            double sum = 0;
            foreach (double d in data)
            {
                sum += d;
            }
            if (Math.Abs(sum-correctSum) > 0.1)
            {
                Console.WriteLine("Summation failed");
                return;
            }
        }
        sw.Stop();
        Console.WriteLine("Foreach loop: {0}", sw.ElapsedMilliseconds);
    }
} 
```

结果：

```
For loop: 16638
Foreach loop: 16529 
```

接下来，验证 Greg 关于集合类型的重要性的观点——将数组更改为`List<double>`上面的 a，你会得到完全不同的结果。它不仅总体上要慢得多，而且 foreach 比按索引访问要慢得多。话虽如此，我仍然*几乎总是*更喜欢 foreach 而不是 for 循环，因为它使代码更简单 - 因为可读性几乎总是很重要，而微优化很少。

* * *

## 回答 #3

> 赞同：164
> 
> 时间：2009-12-22T15:08:09.773

**`foreach``for`loops 比loops表现出更具体的意图**。

使用`foreach`循环向使用您的代码的任何人展示您计划对集合的每个成员执行某些操作，而不管其在集合中的位置如何。它还表明您没有修改原始集合（如果您尝试这样做，则会引发异常）。

的另一个优点`foreach`是它适用于 any `IEnumerable`，其中 as`for`仅对 有意义`IList`，其中每个元素实际上都有一个索引。

但是，如果您需要使用元素的索引，那么当然应该允许您使用`for`循环。但是，如果您不需要使用索引，那么拥有一个索引只会使您的代码变得混乱。

据我所知，没有显着的性能影响。在未来的某个阶段，使用`foreach`在多核上运行来调整代码可能会更容易，但这不是现在需要担心的事情。

* * *

## 回答 #4

> 赞同：53
> 
> 时间：2009-12-22T15:08:32.550

每当有关于性能的争论时，您只需要编写一个小测试，以便您可以使用定量结果来支持您的案例。

使用 StopWatch 类并重复几百万次，以确保准确性。（如果没有 for 循环，这可能很难）：

```
using System.Diagnostics;
//...
Stopwatch sw = new Stopwatch()
sw.Start()
for(int i = 0; i < 1000000;i ++)
{
    //do whatever it is you need to time
}
sw.Stop();
//print out sw.ElapsedMilliseconds 
```

手指交叉的结果表明差异可以忽略不计，您不妨只做最可维护的代码的任何结果

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2008-12-13T19:56:21.600

它总是很接近。对于数组，*有时* `for`会稍微快一些，但`foreach`更具表现力，并提供 LINQ 等。通常，坚持使用`foreach`.

此外，`foreach`在某些情况下可能会进行优化。例如，一个链表对于索引器来说可能很糟糕，但对于`foreach`. 实际上，`LinkedList<T>`出于这个原因，该标准甚至没有提供索引器。

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2008-12-13T19:51:41.017

我的猜测是，在 99% 的情况下它可能并不重要，那么为什么你会选择更快的而不是最合适的（因为最容易理解/维护）？

* * *

## 回答 #7

> 赞同：33
> 
> 时间：2009-12-22T15:13:35.243

有很好的理由**更喜欢** `foreach`循环而不是`for`循环。如果您可以使用`foreach`循环，那么您的老板是对的，您应该这样做。

但是，并非每次迭代都只是按顺序逐一遍历列表。如果他是*禁止*的，是的，那是错误的。

如果我是你，我会做的就是**把你所有的自然 for 循环变成 recursion**。那会教他，这对你来说也是一个很好的心理锻炼。

* * *

## 回答 #8

> 赞同：32
> 
> 时间：2009-01-23T07:36:03.830

两者之间不太可能存在巨大的性能差异。与往常一样，当面临“哪个更快？”时 问题，您应该始终认为“我可以衡量这个”。

在循环体中写两个做同样事情的循环，执行它们并计时，看看速度上有什么不同。使用几乎为空的主体和类似于您实际执行的循环主体来执行此操作。也可以尝试使用您正在使用的集合类型，因为不同类型的集合可能具有不同的性能特征。

* * *

## 回答 #9

> 赞同：18
> 
> 时间：2009-12-03T15:38:08.113

杰弗里·里希特在 TechEd 2005 上：

> “这些年来我开始学习 C# 编译器对我来说基本上是个骗子。” ..“它涉及很多事情。” .. “就像你做一个 foreach 循环一样......” .. “......这是你写的一小行代码，但是 C# 编译器为了做到这一点而吐出的东西是惊人的。它提出了一个try/finally 块在那里，在 finally 块内，它将您的变量转换为 IDisposable 接口，如果转换成功，它会在其上调用 Dispose 方法，在循环内它会在循环内重复调用 Current 属性和 MoveNext 方法，对象是在幕后创建的。很多人使用 foreach 因为它很容易编码，很容易做......” .. “foreach 在性能方面不是很好，

点播网络广播： [http ://msevents.microsoft.com/CUI/WebCastEventDetails.aspx?EventID=1032292286&EventCategory=3&culture=en-US&CountryCode=US](http://msevents.microsoft.com/CUI/WebCastEventDetails.aspx?EventID=1032292286&EventCategory=3&culture=en-US&CountryCode=US)

* * *

## 回答 #10

> 赞同：12
> 
> 时间：2009-12-22T15:11:28.707

这是荒唐的。没有令人信服的理由禁止 for 循环、性能方面或其他方面。

有关性能基准和其他参数，请参阅[Jon Skeet 的博客](http://codeblog.jonskeet.uk/2009/01/29/for-vs-foreach-on-arrays-and-lists/)。

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2018-09-21T22:29:34.150

你可以阅读[Deep .NET - part 1 Iteration](https://medium.com/deep-net/part-1-iteration-2f33bf5ea50f)

它涵盖了从 .NET 源代码一直到反汇编的结果（没有第一次初始化）。

例如 - 带有 foreach 循环的数组迭代： [![在此处输入图像描述](https://i.stack.imgur.com/o2Rfs.png)](https://i.stack.imgur.com/o2Rfs.png)

和 - 使用 foreach 循环列出迭代： [![在此处输入图像描述](https://i.stack.imgur.com/Q9XEF.png)](https://i.stack.imgur.com/Q9XEF.png)

和最终结果： [![在此处输入图像描述](https://i.stack.imgur.com/Pzoiz.png)](https://i.stack.imgur.com/Pzoiz.png)

[![在此处输入图像描述](https://i.stack.imgur.com/OQJlS.png)](https://i.stack.imgur.com/OQJlS.png)

* * *

## 回答 #12

> 赞同：11
> 
> 时间：2009-12-22T15:08:14.127

如果您使用对象集合，`foreach`则更好，但如果您增加一个数字，`for`则循环更好。

请注意，在最后一种情况下，您可以执行以下操作：

```
foreach (int i in Enumerable.Range(1, 10))... 
```

但它肯定不会表现得更好，与`for`.

* * *

## 回答 #13

> 赞同：10
> 
> 时间：2009-12-22T18:37:42.397

这应该可以节省您：

```
public IEnumerator<int> For(int start, int end, int step) {
    int n = start;
    while (n <= end) {
        yield n;
        n += step;
    }
} 
```

采用：

```
foreach (int n in For(1, 200, 4)) {
    Console.WriteLine(n);
} 
```

为了获得更大的胜利，您可以将三个代表作为参数。

* * *

## 回答 #14

> 赞同：9
> 
> 时间：2008-12-13T20:38:14.760

当您循环遍历数组、列表等常见结构时，a`for`和 a循环的速度差异很小，并且对集合进行查询几乎总是稍微慢一些，尽管写起来更好！正如其他海报所说，追求表现力而不是一毫秒的额外性能。`foreach``LINQ`

到目前为止还没有说的是，当一个`foreach`循环被编译时，它会由编译器根据它正在迭代的集合进行优化。这意味着当您不确定要使用哪个循环时，您应该使用`foreach`循环 - 它会在编译时为您生成最佳循环。它也更具可读性。

循环的另一个关键优势`foreach`是，如果您的集合实现发生变化（例如从 int`array`到 a `List<int>`），那么您的`foreach`循环将不需要任何代码更改：

```
foreach (int i in myCollection) 
```

无论您的集合是什么类型，上述内容都是相同的，而在您的循环中，如果您从 an更改为 a `for`，则不会构建以下内容：`myCollection``array``List`

```
for (int i = 0; i < myCollection.Length, i++) 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2014-11-13T06:22:22.247

这与大多数“哪个更快”问题具有相同的两个答案：

1）如果你不测量，你就不知道。

2）（因为......）这取决于。

对于您将要迭代的 IEnumerable 类型（或多个类型），这取决于“MoveNext()”方法相对于“this[int index]”方法的成本有多高。

“foreach”关键字是一系列操作的简写——它在 IEnumerable 上调用一次 GetEnumerator()，每次迭代调用一次 MoveNext()，进行一些类型检查，等等。最有可能影响性能测量的是 MoveNext() 的成本，因为它被调用了 O(N) 次。也许它很便宜，但也许不是。

“for”关键字看起来更容易预测，但在大多数“for”循环中，您会发现类似“collection[index]”的内容。这看起来像一个简单的数组索引操作，但它实际上是一个方法调用，其成本完全取决于您正在迭代的集合的性质。也许它很便宜，但也许不是。

如果集合的底层结构本质上是一个链表，则 MoveNext 非常便宜，但索引器可能有 O(N) 成本，使得“for”循环的真正成本为 O(N*N)。

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2009-12-22T15:50:52.980

“有什么论据可以用来帮助我说服他使用 for 循环是可以接受的吗？”

不，如果你的老板是微观管理到告诉你使用什么编程语言结构的程度，你真的无话可说。对不起。

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2009-01-23T07:35:12.617

这可能取决于您要枚举的集合类型及其索引器的实现。但总的来说，使用`foreach`可能是一种更好的方法。

此外，它适用于任何`IEnumerable`东西——不仅仅是索引器。

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2009-12-22T18:11:14.850

每种语言结构都有适当的使用时间和地点。C# 语言有四个独立的[迭代语句](http://msdn.microsoft.com/en-us/library/aa664750(VS.71).aspx)是有原因的——每个语句都有特定的用途，并且有适当的用途。

我建议和你的老板坐下来，试着理性地解释为什么`for`循环有目的。有时`for`迭代块比迭代更清楚地描述算法`foreach`。当这是真的时，使用它们是合适的。

我还要向你的老板指出——性能不是，也不应该成为任何实际的问题——它更多的是以简洁、有意义、可维护的方式表达算法的问题。像这样的微优化完全忽略了性能优化的重点，因为任何真正的性能优势都来自算法重新设计和重构，而不是循环重构。

如果经过理性的讨论，还是有这种专制的观点，那怎么做就看你自己了。就个人而言，我不会乐于在不鼓励理性思考的环境中工作，并会考虑跳槽到不同雇主的另一个职位。但是，我强烈建议在生气之前进行讨论——这可能只是一个简单的误解。

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2009-12-22T15:31:32.273

题外话是否`for`比`foreach`真的快。我严重怀疑选择一个而不是另一个会对你的表现产生重大影响。

优化应用程序的最佳方法是通过分析实际代码。这将查明占工作/时间最多的方法。先优化那些。如果性能仍然不可接受，请重复该过程。

作为一般规则，我建议远离微优化，因为它们很少会产生任何重大收益。唯一的例外是在优化已识别的热路径时（即，如果您的分析识别了一些高度使用的方法，那么对这些方法进行广泛优化可能是有意义的）。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2009-12-22T16:13:47.253

影响性能的是您*在*循环中所做的事情，而不是实际的循环构造（假设您的情况不重要）。

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2009-12-22T15:08:28.747

两者将以几乎完全相同的方式运行。编写一些代码来使用两者，然后向他展示 IL。它应该显示可比较的计算，这意味着性能没有差异。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2009-12-22T15:12:25.010

完全禁止使用 for 循环之类的东西似乎有点奇怪。

[这里](http://www.codeproject.com/KB/cs/foreach.aspx)有一篇有趣的文章，涵盖了两个循环之间的许多性能差异。

我个人会说，我发现 foreach 比 for 循环更具可读性，但是如果 for 循环更合适，您应该使用最好的方法来完成手头的工作，而不必编写额外的长代码来包含 foreach 循环。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2009-12-22T15:12:51.997

在大多数情况下，真的没有什么区别。

通常，当您没有明确的数字索引时，您总是必须使用 foreach，并且当您实际上没有可迭代的集合时（例如，在上三角形中迭代二维数组网格）时，您总是必须使用 for . 在某些情况下，您可以选择。

有人可能会争辩说，如果代码中开始出现幻数，那么 for 循环可能会更难以维护。你应该为不能使用 for 循环而感到恼火，而不得不构建一个集合或使用 lambda 来构建一个子集合，而不是仅仅因为 for 循环已被禁止。

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2009-12-22T15:45:01.477

你真的可以把他的脑袋搞砸，改为使用 IQueryable .foreach 闭包：

```
myList.ForEach(c => Console.WriteLine(c.ToString()); 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2008-12-13T19:57:33.780

前段时间我确实测试过它，结果`for`循环比循环快得多`foreach`。原因很简单，`foreach`循环首先需要`IEnumerator`为集合实例化一个。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2008-12-13T19:59:32.233

for 具有更简单的实现逻辑，因此它比 foreach 更快。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2009-01-23T09:02:19.100

除非您处于特定的速度优化过程中，否则我会说使用产生最容易阅读和维护代码的任何方法。

如果已经设置了迭代器，例如其中一个集合类，那么 foreach 是一个很好的简单选择。如果它是您正在迭代的整数范围，那么 for 可能更干净。

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2009-01-23T10:16:38.500

Jeffrey Richter 在最近的播客中谈到了 for 和 foreach 之间的性能差异：[http ://pixel8.infragistics.com/shows/everything.aspx#Episode:9317](http://pixel8.infragistics.com/shows/everything.aspx#Episode:9317)

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2014-06-12T05:34:29.447

我找到了迭代**更快**`foreach`的循环。请参阅下面的测试结果。在下面的代码中，我分别使用和循环来迭代大小为 100、10000 和 100000的值来测量时间。`List` **`array``for``foreach`**

 **![在此处输入图像描述](https://i.stack.imgur.com/RVPa9.png)

```
private static void MeasureTime()
    {
        var array = new int[10000];
        var list = array.ToList();
        Console.WriteLine("Array size: {0}", array.Length);

        Console.WriteLine("Array For loop ......");
        var stopWatch = Stopwatch.StartNew();
        for (int i = 0; i < array.Length; i++)
        {
            Thread.Sleep(1);
        }
        stopWatch.Stop();
        Console.WriteLine("Time take to run the for loop is {0} millisecond", stopWatch.ElapsedMilliseconds);

        Console.WriteLine(" ");
        Console.WriteLine("Array Foreach loop ......");
        var stopWatch1 = Stopwatch.StartNew();
        foreach (var item in array)
        {
            Thread.Sleep(1);
        }
        stopWatch1.Stop();
        Console.WriteLine("Time take to run the foreach loop is {0} millisecond", stopWatch1.ElapsedMilliseconds);

        Console.WriteLine(" ");
        Console.WriteLine("List For loop ......");
        var stopWatch2 = Stopwatch.StartNew();
        for (int i = 0; i < list.Count; i++)
        {
            Thread.Sleep(1);
        }
        stopWatch2.Stop();
        Console.WriteLine("Time take to run the for loop is {0} millisecond", stopWatch2.ElapsedMilliseconds);

        Console.WriteLine(" ");
        Console.WriteLine("List Foreach loop ......");
        var stopWatch3 = Stopwatch.StartNew();
        foreach (var item in list)
        {
            Thread.Sleep(1);
        }
        stopWatch3.Stop();
        Console.WriteLine("Time take to run the foreach loop is {0} millisecond", stopWatch3.ElapsedMilliseconds);
    } 
```

# 更新

在@jgauffin 建议后，我使用了@johnskeet 代码，发现`for`循环`array`比跟随要快，

*   带数组的 Foreach 循环。
*   带列表的 for 循环。
*   带有列表的 Foreach 循环。

请参阅下面的测试结果和代码，

![在此处输入图像描述](https://i.stack.imgur.com/68dww.png)

```
private static void MeasureNewTime()
    {
        var data = new double[Size];
        var rng = new Random();
        for (int i = 0; i < data.Length; i++)
        {
            data[i] = rng.NextDouble();
        }
        Console.WriteLine("Lenght of array: {0}", data.Length);
        Console.WriteLine("No. of iteration: {0}", Iterations);
        Console.WriteLine(" ");
        double correctSum = data.Sum();

        Stopwatch sw = Stopwatch.StartNew();
        for (int i = 0; i < Iterations; i++)
        {
            double sum = 0;
            for (int j = 0; j < data.Length; j++)
            {
                sum += data[j];
            }
            if (Math.Abs(sum - correctSum) > 0.1)
            {
                Console.WriteLine("Summation failed");
                return;
            }
        }
        sw.Stop();
        Console.WriteLine("For loop with Array: {0}", sw.ElapsedMilliseconds);

        sw = Stopwatch.StartNew();
        for (var i = 0; i < Iterations; i++)
        {
            double sum = 0;
            foreach (double d in data)
            {
                sum += d;
            }
            if (Math.Abs(sum - correctSum) > 0.1)
            {
                Console.WriteLine("Summation failed");
                return;
            }
        }
        sw.Stop();
        Console.WriteLine("Foreach loop with Array: {0}", sw.ElapsedMilliseconds);
        Console.WriteLine(" ");

        var dataList = data.ToList();
        sw = Stopwatch.StartNew();
        for (int i = 0; i < Iterations; i++)
        {
            double sum = 0;
            for (int j = 0; j < dataList.Count; j++)
            {
                sum += data[j];
            }
            if (Math.Abs(sum - correctSum) > 0.1)
            {
                Console.WriteLine("Summation failed");
                return;
            }
        }
        sw.Stop();
        Console.WriteLine("For loop with List: {0}", sw.ElapsedMilliseconds);

        sw = Stopwatch.StartNew();
        for (int i = 0; i < Iterations; i++)
        {
            double sum = 0;
            foreach (double d in dataList)
            {
                sum += d;
            }
            if (Math.Abs(sum - correctSum) > 0.1)
            {
                Console.WriteLine("Summation failed");
                return;
            }
        }
        sw.Stop();
        Console.WriteLine("Foreach loop with List: {0}", sw.ElapsedMilliseconds);
    } 
```

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2009-01-23T10:17:18.403

我不希望任何人发现两者之间的“巨大”性能差异。

我想答案取决于您尝试访问的集合是否具有更快的索引器访问实现或更快的 IEnumerator 访问实现。由于 IEnumerator 经常使用索引器并且只保存当前索引位置的副本，我希望枚举器访问至少与直接索引访问一样慢或更慢，但不会慢很多。

当然，这个答案没有考虑编译器可能实现的任何优化。

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2009-02-17T16:59:48.163

请记住，for 循环和 foreach 循环并不总是等价的。如果列表发生更改，列表枚举器将引发异常，但您不会总是通过正常的 for 循环获得该警告。如果列表在错误的时间更改，您甚至可能会遇到不同的异常。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2016-09-23T06:00:27.580

我遇到了一个案例，其中 foreach 方式比 For 快

[为什么在读取richtextbox行时foreach比for循环快](https://stackoverflow.com/questions/1136825/why-foreach-is-faster-than-for-loop-while-reading-richtextbox-lines/1136863#comment66437239_1136863)

在那个问题中，我有一个类似于 OP 的案例。

一个读取大约 72K 行的文本框，我正在访问 Lines 属性（这实际上是一个 getter 方法）。（显然，在winforms中经常有不是O（1）的getter方法。我想它是O（n），所以文本框越大，从该“属性”获取值所需的时间就越长。在for循环我和那里的 OP 一样`for(int i=0;i<textBox1.lines.length;i++) str=textBox1.Lines[i]` ，它真的很慢，因为它每次读取一行时都在读取整个文本框，而且每次检查条件时它都在读取整个文本框。

Jon Skeet 表明您可以只访问一次 Lines 属性（每次迭代甚至一次，仅一次）。而不是每次迭代两次（这是很多次）。做 string[] strarrlines = textBox1.Lines; 并循环通过strarrlines。

但可以肯定的是，以相当直观的形式使用 for 循环并访问 Lines 属性是非常低效的

```
for (int i = 0; i < richTextBox.Lines.Length; i++)
{
    s = richTextBox.Lines[i];
} 
```

对于文本框或富文本框，它非常慢。

OP 在富文本框上测试该循环，发现“有 15000 行。for 循环需要 8 分钟才能循环到 15000 行。而 foreach 花了几分之一秒来枚举它。”

该链接上的 OP 发现这个 foreach 比上面提到的他的（相同的 OP）for 循环效率更高。正如我所做的那样。

```
 String s=String.Empty;
   foreach(string str in txtText.Lines)
    {
       s=str;
    } 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2009-12-22T15:58:18.600

我认为在大多数情况下 for 比 foreach 稍微快一点，但这确实没有抓住重点。我没有看到提到的一件事是，在您正在谈论的场景中（即，大容量网络应用程序），for 和 foreach 之间的性能差异将不会影响网站的性能。您将受到请求/响应时间和数据库时间的限制，而不是 v. foreach。

也就是说，我不明白你对 foreach 的厌恶。在我看来，在可以使用任何一种的情况下，foreach 通常会更清晰。我通常保留用于需要以某种丑陋、非标准方式遍历集合的情况。

* * *

## 回答 #34

> 赞同：1
> 
> 时间：2011-08-10T00:19:56.513

在我的 Windows Mobile 项目中，我`for`为控件集合使用了循环。20 个控件花费了 100 毫秒！一个`foreach`循环只用了 4 毫秒。那是性能问题...

* * *

## 回答 #35

> 赞同：1
> 
> 时间：2015-11-08T20:37:48.030

Ben Watson，《编写高性能 .NET 代码》的作者：

> “这些优化对你的程序很重要吗？只有当你的程序受 CPU 限制并且集合迭代是你处理的核心部分时。正如你将看到的，如果你不小心，有一些方法可能会损害你的性能，但那仅当它是您程序的重要组成部分时才重要。我的理念是：大多数人永远不需要知道这一点，但如果您这样做，那么了解系统的每一层都很重要，这样您就可以做出明智的选择“ .

最详尽的解释可以在这里找到：http: [//www.codeproject.com/Articles/844781/Digging-Into-NET-Loop-Performance-Bounds-checking](http://www.codeproject.com/Articles/844781/Digging-Into-NET-Loop-Performance-Bounds-checking)

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2016-01-11T04:46:32.080

我根据 for 和 foreach 的收集速度提到了这个细节。

List -For 循环比 Foreach 循环稍快

ArrayList - For 循环的速度比 Foreach 循环快 2 倍以上。

数组 - 两者的速度相同。但 Foreach 循环似乎要快一些。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2009-01-23T08:45:57.200

我建议阅读[本文](http://www.codeproject.com/KB/cs/foreach.aspx)以获得具体答案。文章的结论是，使用for循环通常比foreach循环更好更快。

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2009-12-22T15:11:53.467

`for`至少我没有看到我的任何同事或上级这么说，考虑到和之间没有显着的速度差异这一事实，这简直是荒谬的`foreach`。如果他要求在所有情况下都使用它，这同样适用！

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2013-12-18T09:39:24.940

从 .NET Framework 4 开始，您还可以使用 Parallel.For 和 Parallel.ForEach，如下所述：[C# Multithreading Loop with Parallel.For or Parallel.ForEach](http://www.codearsenal.net/2013/12/csharp-multithreading-loop-parallel-for.html)

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2014-06-27T15:04:55.190

我需要使用三个嵌套循环（on `List<MyCustomType>`）来解析一些大数据。**我认为，使用上面的 Rob Fonseca-Ensor 的帖子，使用for**和**foreach**计时和比较差异会很有趣。

不同之处在于：foreach（嵌套的三个 foreach 像 foreach{foreach{forech{}}} 在**171.441**秒内完成了这项工作，而 for (for{for{for{}}}) 在**158.616**秒内完成了这项工作。

现在 13 秒大约减少了**13%**的时间 - 这对我来说有点重要。但是，foreach 绝对比使用三个索引的 fors 更具可读性......

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2021-02-24T11:05:34.053

```
 internal static void Test()
    {
        int LOOP_LENGTH = 10000000;
        Random random = new Random((int)DateTime.Now.ToFileTime());

        {
            Dictionary<int, int> dict = new Dictionary<int, int>();
            long first_memory = GC.GetTotalMemory(true);
            var stopWatch = Stopwatch.StartNew();
            for (int i = 0; i < 64; i++)
            {
                dict.Add(i, i);
            }

            for (int i = 0; i < LOOP_LENGTH; i++)
            {
                for (int k = 0; k < dict.Count; k++)
                {
                    if (dict[k] > 1000000) Console.WriteLine("Test");
                }
            }
            stopWatch.Stop();
            var last_memory = GC.GetTotalMemory(true);
            Console.WriteLine($"Dictionary for T:{stopWatch.Elapsed.TotalSeconds}s\t M:{last_memory - first_memory}");

            GC.Collect();
        }

        {
            Dictionary<int, int> dict = new Dictionary<int, int>();
            long first_memory = GC.GetTotalMemory(true);
            var stopWatch = Stopwatch.StartNew();
            for (int i = 0; i < 64; i++)
            {
                dict.Add(i, i);
            }

            for (int i = 0; i < LOOP_LENGTH; i++)
            {
                foreach (var item in dict)
                {
                    if (item.Value > 1000000) Console.WriteLine("Test");
                }
            }
            stopWatch.Stop();
            var last_memory = GC.GetTotalMemory(true);
            Console.WriteLine($"Dictionary foreach T:{stopWatch.Elapsed.TotalSeconds}s\t M:{last_memory - first_memory}");

            GC.Collect();
        }

        {
            Dictionary<int, int> dict = new Dictionary<int, int>();
            long first_memory = GC.GetTotalMemory(true);
            var stopWatch = Stopwatch.StartNew();
            for (int i = 0; i < 64; i++)
            {
                dict.Add(i, i);
            }

            for (int i = 0; i < LOOP_LENGTH; i++)
            {
                foreach (var item in dict.Values)
                {
                    if (item > 1000000) Console.WriteLine("Test");
                }
            }
            stopWatch.Stop();
            var last_memory = GC.GetTotalMemory(true);
            Console.WriteLine($"Dictionary foreach values T:{stopWatch.Elapsed.TotalSeconds}s\t M:{last_memory - first_memory}");

            GC.Collect();
        }

        {
            List<int> dict = new List<int>();
            long first_memory = GC.GetTotalMemory(true);
            var stopWatch = Stopwatch.StartNew();
            for (int i = 0; i < 64; i++)
            {
                dict.Add(i);
            }

            for (int i = 0; i < LOOP_LENGTH; i++)
            {
                for (int k = 0; k < dict.Count; k++)
                {
                    if (dict[k] > 1000000) Console.WriteLine("Test");
                }
            }
            stopWatch.Stop();
            var last_memory = GC.GetTotalMemory(true);
            Console.WriteLine($"list for T:{stopWatch.Elapsed.TotalSeconds}s\t M:{last_memory - first_memory}");

            GC.Collect();
        }

        {
            List<int> dict = new List<int>();
            long first_memory = GC.GetTotalMemory(true);
            var stopWatch = Stopwatch.StartNew();
            for (int i = 0; i < 64; i++)
            {
                dict.Add(i);
            }

            for (int i = 0; i < LOOP_LENGTH; i++)
            {
                foreach (var item in dict)
                {
                    if (item > 1000000) Console.WriteLine("Test");
                }
            }
            stopWatch.Stop();
            var last_memory = GC.GetTotalMemory(true);
            Console.WriteLine($"list foreach T:{stopWatch.Elapsed.TotalSeconds}s\t M:{last_memory - first_memory}");

            GC.Collect();
        }
    } 
```

T:10.1957728s M:2080
字典 foreach T:10.5900586s M:1952
字典 foreach 值 T:3.8294776s M:2088
T:3.7981471s M:320
列表 foreach T:4.4861377s M:648

# plsql - 如何备份 PLSQL 数据库？

> ID：365618
> 
> 赞同：2
> 
> 时间：2008-12-13T19:49:53.767
> 
> 标签：plsql, backup

如何备份 PLSQL 数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T19:56:23.877

问题是你真的想通过 PL/SQL 来做吗？

假设您使用的是 oracle 数据库，他们有将您的数据库转储到文件中的命令。它以这样一种方式转储，即可以从头开始重新创建数据库（表和所有）（因此您可以重新创建辅助备份 [不是我推荐这种方式]）。

这是常见问题解答
[http://www.orafaq.com/wiki/Import_Export_FAQ](http://www.orafaq.com/wiki/Import_Export_FAQ)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-29T04:05:13.113

您的问题需要澄清一下。

您是否要：a) 创建数据库副本以供其他地方使用 b) 创建数据库备份以用于备份和可恢复性目的

如果您只想在其他地方创建数据库的副本，那么使用导入和导出实用程序（imp 和 exp，或 10g 中的 impdp 和 expdp）就足够了。

如果您希望备份数据库以实现可恢复性，那么您真的应该考虑使用 RMAN，这是 Oracle 的企业备份解决方案。文档可以在这里找到： [RMAN 快速入门指南](http://download.oracle.com/docs/cd/B19306_01/backup.102/b14193/toc.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-23T15:03:28.603

当我进行物理备份时，我使用 RMAN，而不是 PL/SQL，因为它是这种工作的工具。但是，这里有一个链接可能对您有所帮助。[http://psst0101.wordpress.com/2008/01/23/move-a-tablespace/](http://psst0101.wordpress.com/2008/01/23/move-a-tablespace/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-22T12:31:05.070

EXP 命令将帮助完成这项工作 语法： **EXP schema_user_name/schema_pwd file=file_name.dmp**

您甚至可以导出（备份）单个数据库对象

# language-agnostic - 作为技术主管，根据个人喜好拒绝一种语言是否合适？

> ID：365634
> 
> 赞同：5
> 
> 时间：2008-12-13T20:01:09.390
> 
> 标签：language-agnostic

您可以很好地省略“作为技术负责人”，但我认为它会将情况置于上下文中。我是技术主管，我们正在构建一个新的应用程序，并且我对我希望团队使用的语言有一个想法。如果一个或多个想要使用不同的语言（出于个人喜好），我是否适合拒绝它（出于个人喜好）。它确实与编码风格有关，仅此而已。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-13T20:04:54.327

我认为您不需要“出于偏好而拒绝它”。您需要确定为什么它不是您的偏好的根本原因，并出于这些原因拒绝它。

如果您可以根据这些原因合理化您的决定，那么您的报告听起来会更可信，并且有充分的可证明理由说明您使用或不使用给定技术的原因。对于我从事的项目，这些“原因”通常是必需的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-13T20:14:06.180

您对项目的技术成功负责。你的报告不是。所以是的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-13T20:06:34.840

按优先级

1.  选择一个最适合该任务的
2.  选择一个你和你的人最流利的
3.  选择一个已经在你的代码库中使用的

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-13T20:03:22.100

“当国王真好”

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T20:07:07.320

我认为解雇其他语言是不对的，因为您更喜欢另一种语言，除非它确实对您使用的语言没有任何影响。

首先客观地看待另一种语言，看看该语言的优点是什么。你应该拒绝一种语言，因为它不是工作的正确工具，而不是因为你不喜欢它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-13T20:49:04.630

/火饵开启

如果是VisualBasic，那么是的……

/灭焰诱饵

血红蛋白

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-13T20:50:29.667

仅仅因为你不熟悉它或对它有偏见而拒绝它绝不是一个好主意。不使用语言/技术有充分的理由，这些应该是您做出决定的基础。通常，这些原因包括：

1.  缺乏对团队语言的支持，支持团队。这是一个大问题 - 如果您的团队交付的应用程序由于没有其他人知道该技术而无法得到支持，那么您不应该这样做。

2.  该技术未经证实。您不应该仅仅因为开发人员想要改进他们的简历就使用实时项目来证明技术。这里有太多的陷阱，我已经看到很多项目因为开发人员都在寻找错误的技术而惨遭失败。

3.  许可。仅仅因为有一种新的语言出现了，并不意味着你可以负担得起使用它。该语言可能需要您没有并且必须投资的某些库/IDE。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-13T20:03:52.880

你不能低估你将成为一个更有效的领导者，使用你熟悉和相信的工具和技术领导团队。但是，如果你强迫团队使用可能不是最适合项目的东西，你不会获得他们的尊重，最终会非常无效。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-13T20:20:07.213

你说的是哪种语言？

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2008-12-13T20:13:08.837

这应该是团队的决定。

# javascript - Javascript/ECMA 中的 snarf 是什么？

> ID：365649
> 
> 赞同：3
> 
> 时间：2008-12-13T20:08:34.570
> 
> 标签：javascript

[我在 JS](http://mxr.mozilla.org/mozilla/source/js/narcissus/jsexec.js)代码中查看 Mozilla 的JS并遇到了[snarf 函数](http://mxr.mozilla.org/mozilla/source/js/narcissus/jsexec.js#137)。它似乎没有在 javascript 中定义，只是在[此处](http://mxr.mozilla.org/mozilla/source/js/src/js.c#3712)的 C 版本中。不过，它的评论不是很好。我谷歌搜索了这个无济于事。

这是 JavaScript 的标准部分吗？（我的猜测是没有。）它是某种扩展吗？它应该做什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-13T20:56:23.477

不，这不是标准的。它是 Mozilla 的 Narcissus（在 SpiderMonkey 之上实现的 JS 解释器中的 JS）的一部分。`snarf(filename)`抓取文件的内容并将其作为字符串返回以供进一步处理（例如，评估）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T20:28:06.090

它加载一个文件并以字符串形式返回文件的内容。

# c++ - Visual Studio 跳过构建

> ID：365650
> 
> 赞同：14
> 
> 时间：2008-12-13T20:08:45.757
> 
> 标签：c++, windows, visual-studio-2005, build

当我尝试构建我的项目时，我在构建窗口中收到以下消息：

**========== 构建：0 成功或最新，0 失败，1 跳过 ==========**

我尝试重建，然后重新构建，但没有帮助。有没有办法查看更详细的消息？“跳过”部分没有给我任何关于什么是错的信息。我正在使用 Visual Studio 2005 专业版。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-13T20:21:22.983

请与 CMS 所说的配置管理器联系，并确保您设置了正确的平台。很多时候，当您使用 MS Application Blocks 之类的东西时，默认平台设置为 Itanium。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-13T20:15:09.970

检查您的解决方案属性，然后转到“配置属性”，并确保您要构建的所有项目都检查了构建标志：

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-11T13:30:24.393

这可能发生的另一个原因（因为它发生在我身上）：

当您的 VS 安装缺少**x64 编译器工具链**时，您正在为 x64 构建。

要解决这个问题，在`appwiz.cpl`（“程序和功能”）中找到MSVS，单击“卸载/更改”，然后转到C++下的x64工具链复选框并选中它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-27T20:58:06.710

这最近发生在我身上，当时我试图编译一个显然与其父解决方案无关的项目。

当我最终编译它时，它不会工作，因为来自另一个项目的一些库丢失了（这应该是成功构建解决方案的一部分）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T20:12:45.013

嗯...我记得曾经诅咒过那个？只是从我糟糕的记忆中猜测，但输出目录路径可能不存在？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-08T12:02:05.250

我发现解决方案 *.sln 文件是问题所在。恢复到以前的版本并解决了问题。通常，该项目引用的项目是真正的违规者，因此请尝试建立参考列表以查看问题所在。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-12-13T20:17:17.033

当 PC 的资源 (RAM) 不足时，我通常会遇到这种情况，关闭之后构建运行良好。

# oracle - 如何使用 PL/SQL 进行 Exp 和 Imp

> ID：365656
> 
> 赞同：2
> 
> 时间：2008-12-13T20:14:12.203
> 
> 标签：oracle, plsql

如何使用 PL/SQL 进行 Exp 和 Imp？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-29T03:59:56.757

这可以通过几种方式完成。

首先，如果您使用的是 10g 或更高版本，则可以考虑使用数据泵（expdp 和 impdp），而不是 imp 和 exp。这些是这些工具的更新和更强大的版本。

至于如何从 PL/SQL 中调用它们，您可以通过以下方式进行：

*   您可以对 DLL（或共享库，如果您在 UNIX 上）进行外部过程调用
*   您可以编写一个简单的 Java 类（在 Oracle JVM 中运行），它会使用 Java 调用
*   您可以使用高级队列或 DBMS_PIPE 与外部应用程序进行通信
*   您可以使用 UTL_TCP 通过网络进行交互（例如 SOAP）
*   在 10g 中，您可以使用 DBMS_SCHEDULER 包来调用操作系统命令

第一个和最后一个选项应该在 Oracle 在线文档中详细记录 - 其他两个选项需要更多的协调和编码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-23T05:22:03.070

如果您使用 impdp/expdp - Datapump (10g or later) - ，您可以简单地使用 DBMS_DATAPUMP：

[http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_datpmp.htm](http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_datpmp.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-06T15:17:23.387

您可以在[Oracle Database Utilities](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/toc.htm)一书中[的使用数据泵 API](http://download.oracle.com/docs/cd/B19306_01/server.102/b14215/dp_api.htm#sthref460)的示例中看到一个关于您所要求的示例。

# c# - 如何在 Windows 窗体中一键完成两件事

> ID：365657
> 
> 赞同：0
> 
> 时间：2008-12-13T20:14:46.447
> 
> 标签：c#, winforms

在我的主窗体上，还有另一个（浮动）窗口。这个浮动窗口有点像一个弹出窗口，当用户点击这个窗口之外的其他地方时它会关闭。这由 Deactivate 事件处理。但我想要做的是，如果用户点击不同的控件（比如一个按钮），我想关闭这个浮动窗口，然后只需单击一下即可激活该按钮。目前，用户必须单击两次（一次以停用窗口，再一次以激活所需的按钮）。有没有办法一键做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T20:36:55.463

```
foreach(Control c in parentForm.Controls)
{
   c.Click += delegate(object sender, EventArgs e)
              {
                  if(floatyWindow != null && floatyWindow.IsFloating)
                  {
                       floatyWindow.Close();
                  }
              };
} 
```

然后像往常一样添加你的处理程序。这个额外的处理程序可以关闭浮动窗口。确保您的浮动窗口也不是对话框，因为这将不允许单击父窗体的控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-13T21:38:05.390

我曾经也遇到过这样的问题，当客户想要“浮动”窗口到处都是应用程序时。我使用了一种类似于本文中描述的方法：

[http://www.vbaccelerator.com/home/NET/Code/Controls/Popup_Windows/Popup_Windows/article.asp](http://www.vbaccelerator.com/home/NET/Code/Controls/Popup_Windows/Popup_Windows/article.asp)

此处提供的代码示例：

[http://www.vbaccelerator.com/home/NET/Code/Controls/Popup_Windows/Popup_Windows/Popup_Form_Demonstration.asp](http://www.vbaccelerator.com/home/NET/Code/Controls/Popup_Windows/Popup_Windows/Popup_Form_Demonstration.asp)

通过扩展这一点，我们创建了类似于 VS 在调试代码时遇到运行时错误时使用的“浮动”窗口。

至少阅读代码可能会给您一些见解，但是，quarrelsome 的响应可能是更简单的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-13T20:34:53.207

我有一个有点hacky的解决方案。在您的 Deactivate 事件中，向您的主窗体触发另一个自定义事件。然后，当您的主窗体正在处理自定义事件时，枚举您的控件（this.Controls）并通过检查所有绑定然后调用 Focus（）来定位鼠标下的控件。您可能需要按表面积最小的排序，或者您可以为此目的单独列出“可聚焦”控件（如按钮）。

另一种方法可能是在浮动窗口的 OnMouseLeave 或主窗口的 OnMouseHover 之后立即将焦点切换到主窗体，但将浮动窗口保持在顶部，只是没有焦点。处理主窗体的全局鼠标向下，然后关闭浮动窗口。

这些只是理论，未经测试。

# svn - SVN 客户端可以破坏存储库吗？

> ID：365661
> 
> 赞同：2
> 
> 时间：2008-12-13T20:16:29.470
> 
> 标签：svn, repository

Subversion 客户端是否有可能以任何方式破坏存储库？这可能是任何类型的破坏性破坏，但必须是在不从备份中恢复存储库的情况下无法恢复。

显然，删除所有内容，然后检查是否很容易通过回滚来修复，所以我正在寻找更多的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T20:24:26.363

Subversion 客户端可以与服务器通信以访问存储库，也可以使用`file://`URL 直接访问存储库。在第一种情况下，服务器负责存储库，因此客户端不能直接“破坏”它。在第二种情况下，客户端负责存储库，因此客户端中的错误可能会影响存储库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T20:24:54.630

理论上，它不会破坏存储库，因为 Subversion 使用原子提交（尽管 Subversion 中存在错误）。

但是，忽略访问控制，客户端当然可以移动/复制/删除新版本中存储库的内容。旧版本继续存在。理论上，您可以通过明智地使用 svn 命令或通过管理员删除以后的版本来恢复到这些旧版本。

一般来说，它非常安全，但请查看访问控制：[http ://svnbook.red-bean.com/en/1.5/svn-book.html#svn.serverconfig.httpd.authz](http://svnbook.red-bean.com/en/1.5/svn-book.html#svn.serverconfig.httpd.authz)

注意：正如 Greg 所暗示的，使用本地存储库时会稍微复杂一些，因为客户端可以直接访问存储库的文件系统。本质上，您必须信任 Subversion。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-15T13:28:36.983

如果客户端可以以任何需要恢复存储库的方式破坏存储库，则 Subversion 人员认为这是一个非常严重的错误。

快速浏览一下他们的 bug-tracker 会发现他们偶尔会遇到存储库损坏错误，但在没有错误的情况下，客户端不可能完全破坏存储库。

# macos - 如何制作 Spotlight 索引 Markdown 文件？

> ID：365669
> 
> 赞同：20
> 
> 时间：2008-12-13T20:21:26.073
> 
> 标签：macos, markdown, spotlight

我通常对降价文档使用 .markdown 或 .md 扩展名。不幸的是，除非它们具有 .txt 文件扩展名，否则 Spotlight 拒绝为它们编制索引。

我已经看到了一个可能的解决方案，涉及在 textmate 博客上[编辑 Info.plist 文件。](http://blog.macromates.com/2007/leopard-issues/)有没有更好的办法？

更新：我刚刚发现[了 Markdown 文件的 QuickLook 生成器，](http://github.com/mdk/qlmarkdown/)它增加了聚光灯支持和漂亮的 HTML 快速预览预览。这是一种享受！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-11-23T14:27:13.490

您可以通过创建系统 RichText.mdimporter 的副本、修改其 Info.plist 并将其保存在 /Library/Spotlight 中来执行此操作而无需禁用 SIP。

```
cp -r /System/Library/Spotlight/RichText.mdimporter .
patch -p2 RichText.mdimporter/Contents/Info.plist < Markdown.patch
mv RichText.mdimporter Markdown.mdimporter
sudo cp -R Markdown.mdimporter /Library/Spotlight
mdimport -r /Library/Spotlight/Markdown.mdimporter 
```

## 降价补丁

```
diff -ru RichText.mdimporter/Contents/Info.plist Markdown.mdimporter/Contents/Info.plist
--- RichText.mdimporter/Contents/Info.plist 2015-11-23 16:14:12.000000000 +0200
+++ Markdown.mdimporter/Contents/Info.plist 2015-11-23 16:10:03.000000000 +0200
@@ -13,15 +13,7 @@
            <string>MDImporter</string>
            <key>LSItemContentTypes</key>
            <array>
-               <string>public.rtf</string>
-               <string>public.html</string>
-               <string>public.xml</string>
-               <string>public.plain-text</string>
-               <string>com.apple.traditional-mac-plain-text</string>
-               <string>com.apple.rtfd</string>
-               <string>com.apple.webarchive</string>
-               <string>org.oasis-open.opendocument.text</string>
-               <string>org.openxmlformats.wordprocessingml.document</string>
+               <string>net.daringfireball.markdown</string>
            </array>
        </dict>
    </array>
@@ -30,11 +22,11 @@
    <key>CFBundleGetInfoString</key>
    <string>1.0, Copyright (c) 2004-2010 Apple Inc.</string>
    <key>CFBundleIdentifier</key>
-   <string>com.apple.MDImporter.RichText</string>
+   <string>com.apple.MDImporter.Markdown</string>
    <key>CFBundleInfoDictionaryVersion</key>
    <string>6.0</string>
    <key>CFBundleName</key>
-   <string>Rich Text Sniffer</string>
+   <string>Markdown Sniffer</string>
    <key>CFBundleShortVersionString</key>
    <string>6.9</string>
    <key>CFBundleSupportedPlatforms</key> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-13T20:25:43.303

您必须编写一个 Spotlight 导入器。有一个 Xcode 项目模板可以为您设置基本内容并帮助您入门；我认为还有一个开发人员示例。

您的导入器将需要`UTExportedTypeDeclarations`在其 Info.plist 中描述带有路径扩展名的降价文件的统一类型标识符的部分。然后，只需让您的导入器向 Spotlight 传递降价文件的适当数据即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-29T01:53:09.393

以下适用于 Mac OS X 10.11 El Capitan：

由于我们无法在 El Capitan 中编辑系统文件，我们必须暂时禁用 SIP（​​系统完整性保护）（有关详细信息，请查看[Lifehacker 文章](http://lifehacker.com/how-to-fix-os-x-el-capitans-annoyances-1733836821)）。

*   通过重新启动计算机并按住`command + R`直到屏幕上出现 Apple 标志，将 Mac 重新启动到恢复模式
*   点击`Utilities`>`Terminal`
*   在终端窗口中，输入`csrutil disable`并按 Enter
*   重新启动你的 Mac

现在我们可以编辑位于的文件`/System/Library/Spotlight/RichText.mdimporter/Contents/Info.plist`：

*   `sudo open -a TextEdit /System/Library/Spotlight/RichText.mdimporter/Contents/Info.plist`
*   添加`<string>net.daringfireball.markdown</string>`下`LSItemContentTypes`（有关更多信息，请参阅[原始帖子](http://hiltmon.com/blog/2015/06/27/a-simple-markdown-spotlight-importer/)）

完成后，您可能想要重新索引包含 Markdown 文件的文件夹，请查看这篇文章：[聚焦：如何重新索引文件夹或卷](https://support.apple.com/en-us/HT201716)。并且不要忘记通过重复第一部分并运行来重新打开 SIP `csrutil enable`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-10T21:26:08.560

这个[要点](https://gist.github.com/gereon/3150445)解释了如何修改 RichText.mdimporter 以导入源文件和降价文件。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2008-12-13T21:02:43.323

您*可以*编写一个 Importer，但有一种更简单的方法。Markdown 只是 Spotlight 处理的文本。如果您为降价文件提供扩展名“.txt”，Spotlight 会选择它们。

就我而言，我只是将我的全部命名为以“.mdwn.txt”结尾，并教 emacs 的 markdown-mode 为匹配此扩展名的文件激活。

# .net - 这个紧凑的框架程序是在桌面上运行的吗？

> ID：365688
> 
> 赞同：1
> 
> 时间：2008-12-13T20:36:14.250
> 
> 标签：.net, compact-framework

.NET Compact Framework 的一大优点是您可以在桌面版 Windows 上运行 .NETCF 可执行文件。但是，必须在运行时处理的平台之间存在轻微的不兼容性。我的问题是，我如何知道我现在在哪个平台上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T20:44:37.633

```
if(Environment.OSVersion.Platform == PlatformID.WinCE)
{} 
```

我可以先告诉你，你在一些 GDI+ 和任何文件访问代码中都需要这个。

# jquery - 在 jQuery AJAX 调用之后填充 HTML 元素或创建选择的更好方法或可重用代码

> ID：365699
> 
> 赞同：1
> 
> 时间：2008-12-13T20:44:30.987
> 
> 标签：jquery, ajax

我发现自己在 JS 中经常做两件事，目前使用 jQuery：

第一个是填充 HTML 元素，可能如下所示：

```
$.get('http://www.example.com/get_result.php', { id: 1 }, function (data) {
    $('#elementId').html(data);
}); 
```

第二个是使用 JSON 结果填充选择元素，例如：

```
$.getJSON('http://www.example.com/get_result.php', { id: 1 }, function(data) {
      $.each(data, function(value, name) {
          $('#selectField').append('<option value="' + value + '">' + name + '</option>');
      }
)}; 
```

我正在寻找的要么是更好地执行这些操作，要么是对 jQuery 的扩展（库或代码块），它可以执行这些操作，而无需一直重新创建代码。或者 jQuery 中是否已经有一些东西可以让这更快？

**编辑：**正如[Kevin Gorski](https://stackoverflow.com/questions/365699/better-way-or-reusable-code-to-populate-an-html-element-or-create-a-select-afte#365790)所提到的，填充 HTML 元素可以这样完成：

```
$('#elementId').load('http://www.example.com/get_result.php', { id: 1 }); 
```

太棒了。虽然，如果你想做一个 POST，它是行不通的。那么做[科林艾伦的](https://stackoverflow.com/questions/365699/better-way-or-reusable-code-to-populate-an-html-element-or-create-a-select-afte#365797)方法比较好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-13T21:49:07.473

这是我编写的一个快速 jQuery 插件，它使您的第一个示例更可重用：

```
(function ($) {
    $.fn.populateWith = function(sUrl, oData, fCallback) {
        if (!oData) oData = false;
        if (!fCallback) fCallback = false;
        $(this).load(sUrl, oData, fCallback);
    };
})(jQuery); 
```

您定位一个`<select>`元素（或一组元素，取决于您的 jQuery 选择器）并简单地从后端加载给定的结果，如下所示：

```
$("#firstSelect").populateWith("backend.html"); 
```

或者，在加载完成后触发回调：

```
$("#secondSelect").populateWith("backend.html", false, function() {
    alert('Callback fired!');
}); 
```

或者，使用回调和传递的数据：

```
$("#thirdSelect").populateWith("backend.html", {id: 1}, function() {
    alert('Callback fired with data!');
}); 
```

您也可以使用数据对象而不是回调来调用它，但您明白了！基本上，这个小插件可以让您担心您想要什么选项以及您想要它们的位置，而无需摆弄客户端的细节。服务器端的输出应该是纯 HTML，但它可以很容易地适应处理任何首选格式。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T21:44:13.363

要使用 AJAH 调用的结果填充元素，请查看[load 方法](http://docs.jquery.com/Ajax/load#urldatacallback)。

我不知道现有的插件可以专门将 JSON 数据加载到选择列表中，但编写一个插件会很简单。

# c# - XSLT 扩展对象方法允许的 .NET 返回类型是什么？

> ID：365704
> 
> 赞同：10
> 
> 时间：2008-12-13T20:49:37.640
> 
> 标签：c#, .net, xslt

.NET 允许使用所谓的扩展对象来扩展 XSLT。非常方便，非常方便。您可以通过创建一个类来做到这一点：

```
public class VeryHandyExtensionFunctions
{
    public string VerySmartStringConcat(XPathNodeIterator NodeList)
    {
       return "some very smart string concat based on NodeList";
    }
} 
```

等待一些魔法（见下文），您可以将 VerySmartStringConcat 作为 xslt 的一部分：

```
<xsl:value-of select="someprefix:VerySmartStringConcat(nodes[@withsomeattribute])"/> 
```

为了实现它，唯一要做的就是使用 XsltArgumentList 将扩展类的实例（上面的非常HandyExtensionFunctions）传递给 XslCompiledTransform 类：

```
XsltArgumentList xsltArg = new XsltArgumentList();
xsltArg.AddExtensionObject("SomeUriResolvingToSomePrefix",new VeryHandyExtensionFunctions);
XslCompiledTransform xslTransform;
XmlWriter W = XmlWriter.Create(SomeTarget, Xslt.OutputSettings);
xslTransform.Transform(SomeXmlDocument, xsltArg, W); 
```

.NET 在弄清楚如何将 XML 类型转换为扩展函数的输入参数和返回类型方面相当聪明。但是，每隔一段时间它就会抱怨不支持类型。支持的类型有哪些？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-13T20:52:15.043

经过一番研究，我在[http://msdn.microsoft.com/en-us/magazine/bb986125.aspx](http://msdn.microsoft.com/en-us/magazine/bb986125.aspx)上找到了这个：

3C XPath 类型 -> 等效 .NET 类（类型）
字符串 -> System.String
Boolean -> System.Boolean
Number -> System.Double
结果树片段 -> System.Xml.XPath.XPathNavigator
节点集 -> System.Xml。 XPath.XPathNodeIterator

# documentation - 为项目文档分配资源

> ID：365709
> 
> 赞同：1
> 
> 时间：2008-12-13T20:52:27.867
> 
> 标签：documentation, project-management

对于以下情况，您有什么建议：

十几个开发人员需要构建和设计一个复杂的系统。需要为未来的开发人员记录此设计，并且必须注意设计决策。这些报告需要大约每两个月进行一次。我的问题是应该如何记录这个项目。

我看到了两种可能性。每个开发人员都会写下他们帮助设计和集成的东西，然后一个人将这些文档中的每一个组合在一起。最终的文件有时可能会不连贯或多余，因为负责组装所有东西的人没有太多时间来调整每个部分。

假设每个开发人员的文档部分在截止日期前几天到达。协作系统（即 wiki）将无法正常工作，因为直到截止日期前几天才可以阅读任何内容。

还是应该让少数人（2-3 人）负责编写文档，而团队的其他成员则负责实际开发系统？开发人员需要一种方法将他们的设计选择和结论传递给技术作者。如何有效地做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T21:01:45.103

我们使用 confluence（atlassian 的 wiki-like-thing）并记录各种不同的“事物”。开发人员不断地做这件事，我们互相推动文档——我们让同伴压力决定什么是必要的。每当有新人出现时，他/她的任务是通读所有内容并找出仍然正确的内容。因此，不正确的内容要么被删除，要么被更新。当我们可以删除东西时我们很高兴；）

这个过程的好处是相关的东西会留下来，不相关的东西会被删除。我们总是“摆脱”更正式的要求，声称如果“他们”需要，我们总是可以构建他们想要的 word 文档。“他们”从不需要他们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T21:05:32.193

我认为备选方案 2 不太灵活，因为它意味着项目的新阶段（尽管它可能与测试并行）。

如果您处于敏捷模型中，那么只需添加文档（按照指南）作为故事。
如果您采用分阶段的方法，那么我仍然会要求开发人员按照一些指导方针处理文档，并沿着设计和代码审查该文档。最终，您可能会有一位技术作家审查所有内容以获得正确的英语，但这将是一种“发布”活动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T21:09:21.967

我们使用 RUP 风格的方法从两个方面进行处理。在第一种情况下，您将有一位领域专家负责粗略设计您将要交付的产品 - 开发人员会根据需要参与进来。在第二种情况下，我们使用技术作者 - 他们记录应用程序，因此他们应该很好地了解它是如何连接在一起的，并且您可以让他们直接参与设计和开发过程。在这种情况下，他们可以帮助完善设计，并确保它与他们认为正在开发的内容相匹配。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T20:55:49.763

我认为您可以使用 Sand Castle 来记录您的项目。

看看这个

[微软的沙堡](http://www.codeplex.com/DocProject/Wiki/View.aspx?title=How%20To%20Configure%20Visual%20Studio%202005%20For%20DocProject&referringTitle=Home)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T21:01:39.283

它不是一个完整的文档，但确保使用[Doxygen 样式的注释对接口等进行注释](http://www.doxygen.org)意味着编写代码和记录它更紧密。

这样，开发人员应该记录他们所做的事情。我仍然认为需要架构师进行审查以确保质量始终如一，但确保人们记录他们所做的事情是确保他们遵循架构的最佳方式。

# sql-server - 为什么 SSAS 不为我的多维数据集加载任何度量数据？

> ID：365718
> 
> 赞同：1
> 
> 时间：2008-12-13T20:58:59.430
> 
> 标签：sql-server, sql-server-2005, ssas, msas

背景：

我正在编写一个数据提供程序，SSAS 将使用它从第三方系统获取数据。
我编写了一个工具，它将基于使用 AMO 的第三方系统的配置来构建多维数据集、维度、度量值组和度量值。

现在，在多维数据集浏览器中，我可以提取维度的成员，但是，永远不会查询度量数据 - 我知道这一点，因为我的数据提供者将记录所有来自它的 SQL 查询 SSAS 请求。

那么，我该如何诊断呢？度量的配置步骤是什么（这只是针对单键维度的常规 1:1 度量 - 非常简单的多维数据集）。

据我所知，我的关系与工作维度和度量相同，我没有从 SSAS 或事件日志中得到任何错误，只是静默和 Cube 浏览器中的一组空单元格。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-03T21:45:12.407

更正计算：

在多维数据集计算选项卡中，确保您处于脚本视图（与表单视图相反）。在脚本区域写下 CALCULATE 一词。单击返回浏览器选项卡以验证您现在是否拥有测量数据。

感谢您的指导，伊恩！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-16T20:23:56.160

我发现了我的问题。

当我使用 AMO 创建度量值组时，我从未为其创建分区。没有分区的度量组将部署和处理而不会出错，但不会查询任何内容，因为与事实表的关系不存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-03-26T09:35:36.753

为他人：

*   检查是否*计算；*命令出现在脚本/计算选项卡中。
*   确保您指定维度和度量值组之间的关系。
*   将任何相关维度 UnknownMember 属性设置为 Visible。

更多建议[在这里](http://social.msdn.microsoft.com/Forums/eu/sqlanalysisservices/thread/7692e602-aa32-4e4a-8519-04e1a99c0111)和[这里](http://www.sqlservercentral.com/Forums/Topic868996-147-1.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-30T11:56:09.597

计算; 命令在脚本/计算选项卡中不存在。解决了并且有效

# ios - 时序循环结果

> ID：365719
> 
> 赞同：1
> 
> 时间：2008-12-13T20:59:08.477
> 
> 标签：ios, objective-c, iphone, cocoa-touch

我有点卡住了，我希望有人能指出我正确的方向。我有一个存储序列的 NSMutableArray。我创建了一个枚举器，以便一个while循环可以一个一个地获取数组的内容。

一切正常，但是我希望在每次调用之间有 10 秒的间隔来调用这些方法。现在它一次播放（或以非常快的顺序）。我应该看什么来在方法调用之间造成延迟？

以下是我到目前为止所得到的。谢谢！

```
NSEnumerator * enumerator = [gameSequenceArray objectEnumerator];
id element;

while(element = [enumerator nextObject])
{
    NSLog(element);

    int elementInt = [element intValue];
    [self.view showButton:elementInt];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T21:50:20.107

你几乎肯定不想在你的循环中加上一个“延迟”，这会阻塞线程直到它结束（并且，除非你的应用程序是多线程的，否则阻塞整个事情）。您可以使用多个线程，但我可能会将循环拆分为另一个选择器的重复定时调用。存储枚举数（或当前索引），然后查看NSObject的performSelector:awithObject:afterDelay：

所以像

```
[NSObject performSelector:@selector(some:selector:name:) withObject:objInstance afterDelay: 10] 
```

选择器将在其中拾取当前枚举器，使用它，推进它并安排另一个调用。确保在执行这组定时方法时不允许更改集合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T21:02:16.490

这就是 NSTimer 的用途。使用 NSTimer 按顺序获取数组中的每个元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T21:40:34.290

顺便说一句：您可能想看看 Objective-C 2.0 的[快速枚举](http://developer.apple.com/documentation/Cocoa/Conceptual/ObjectiveC/Articles/chapter_8_section_1.html#//apple_ref/doc/uid/TP30001163-CH18-SW1)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-15T11:18:32.267

如果 gameSequenceArray 是一个数组，那么您不需要使用枚举器：

```
NSTimeInterval time = 10;

for (id elementId in gameSequenceArray) {

    [self.view performSelector:@selector(showButton:) withObject:elementID afterDelay:time];
} 
```

然后你声明showButton：

```
- (void)showButton:(id)anElement {
    ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T21:58:08.670

如果您最终使用计时器传递对象枚举器，请知道在完成枚举之前不允许修改数组的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-14T22:20:17.020

所以这是我根据大家的意见提出的解决方案。

```
NSEnumerator * enumerator = [gameSequenceArray objectEnumerator];

NSTimeInterval time = 5;

for (NSString *element in enumerator) {
    id elementId = element;

    time++;

    [self.view performSelector:@selector(showButton:) withObject:elementId afterDelay:time];
} 
```

再次感谢大家为我指明正确的方向。

# java - 多线程：对象在使用时被设置为空

> ID：365743
> 
> 赞同：4
> 
> 时间：2008-12-13T21:11:19.123
> 
> 标签：java, multithreading, nullpointerexception

我有一个带有渲染线程的小应用程序。这个线程所做的就是在它们当前的位置绘制我的对象。

我有一些代码，例如：

```
public void render()
{
    // ... rendering various objects

    if (mouseBall != null) mouseBall.draw()

} 
```

然后我还有一些鼠标处理程序，当用户单击鼠标时，它会创建并将 mouseBall 设置为新球。然后，用户可以拖动鼠标，球将跟随鼠标移动的地方。当用户释放球时，我有另一个设置 mouseBall = null 的鼠标事件。

问题是，我的渲染循环运行得足够快，以至于条件（mouseBall！= null）会在随机时间返回true，但是在那之后的那一瞬间，用户会放开鼠标，我会得到一个空指针在空对象上尝试 .draw() 的异常。

像这样的问题有什么解决方案？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-13T21:17:13.153

问题在于您访问`mouseBall`了两次，一次是检查它是否不是`null`，另一次是调用它的函数。您可以通过使用这样的临时来避免此问题：

```
public void render()
{
    // ... rendering various objects
    tmpBall = mouseBall;
    if (tmpBall != null) tmpBall.draw();
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-13T21:25:01.187

您必须同步 if 和 draw 语句，以保证它们作为一个原子序列运行。在java中，这将是这样完成的：

```
 public void render()
{
    // ... rendering various objects
    synchronized(this) {
        if (mouseBall != null) mouseBall .draw();
   }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-09T18:10:13.943

我知道您已经接受了其他答案，但第三种选择是使用 java.util.concurrent.atomic 包的 AtomicReference 类。这提供了自动执行的检索、更新和比较操作，而无需任何支持代码。所以在你的例子中：

```
public void render()
{
    AtomicReference<MouseBallClass> mouseBall = ...;

    // ... rendering various objects
    MouseBall tmpBall = mouseBall.get();
    if (tmpBall != null) tmpBall.draw();
}
```

这看起来与 Greg 的解决方案非常相似，从概念上讲，它们的相似之处在于幕后都使用波动性来确保值的新鲜度，并在使用值之前获取临时副本以便应用条件。

因此，此处使用的确切示例对于展示 AtomicReferences 的威力并不是那么好。相反，请考虑您的其他线程仅在它已经为空时才更新鼠标球变量 - 对于各种初始化样式的代码块来说这是一个有用的习惯用法。在这种情况下，通常必须使用同步，以确保如果您检查并发现球是空的，当您尝试设置它时它*仍然*是空的（否则您会回到原来的问题领域）。但是，使用 AtomicReference 您可以简单地说：

```
mouseBall.compareAndSet(null, possibleNewBall);
```

因为这是一个原子操作，所以如果一个线程“看到”该值为 null，它还将在任何其他线程有机会读取它之前将其设置为 possibleNewBall 引用。

另一个使用原子引用的好习惯是，如果您无条件地设置某些内容，但需要对旧值执行某种清理。在这种情况下，您可以说：

```
 MouseBall oldBall = mouseBall.getAndSet(newMouseBall);
   // Cleanup code using oldBall
```

AtomicIntegers 不仅有这些好处；getAndIncrement() 方法非常适合全局共享计数器，因为您可以保证每次调用它都会返回一个不同的值，而不管线程的交错。线程安全，大惊小怪。

# xml - Xpath 兄弟条件测试？

> ID：365750
> 
> 赞同：2
> 
> 时间：2008-12-13T21:17:38.520
> 
> 标签：xml, xpath

我正在使用 VB.net (2003)，并在 xml 文档上调用 SelectNodes 方法。
如果我有文件：

```
<InqRs>  
  <DetRs>  
    <RefInfo>  
      <RefType>StopNum</RefType>  
      <RefId>0</RefId>  
    </RefInfo>  
    <RefInfo>  
      <RefType>Id</RefType>  
      <RefId>0</RefId>  
    </RefInfo>  
  </DetRs>  
  <DetRs>  
    <RefInfo>  
      <RefType>StopNum</RefType>  
      <RefId>0</RefId>  
    </RefInfo>  
    <RefInfo>  
      <RefType>Id</RefType>  
      <RefId>1</RefId>  
    </RefInfo>  
  </DetRs>  
</InqRs> 
```

如何仅选择`DetRs`具有`RefType=Id`and的那个`RefId=0`，即上面的“第一个”？

我尝试了几种不同的尝试，其中包括：

```
InqRs/DetRs[RefInfo/RefType='Id' and RefInfo/RefId='0']  
InqRs/DetRs[RefInfo/RefType='Id'][RefInfo/RefId='0'] 
```

但是这些选择了两个 DetRs 部分（因为我认为 StopNum RefId 为 0）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T18:44:40.900

您想要**`DetRs`**顶部元素的所有子元素：

    `/*/DetRs`

那有一个**`RefInfo`**孩子：

    `/*/DetRs`
             `[RefInfo]`

具有**`RefType`**价值“ **`Id`**”：

    `/*/DetRs`
             `[RefInfo`
                   [ `RefType`=' `Id`']
              ]

并且**`RefId`**具有值为**0**：

    `/*/DetRs`
             `[RefInfo`
                   [ `RefType`=' `Id`'
                 `and`
                   `RefId`=0
                   ]
              ]

**而且这个 XPath 表达式正确地选择`DetRs`了提供的 XML 文档中想要的第一个元素**。

当然，如果某人有其他风格偏好，上述表达式也可以写成：

    **`/*/DetRs[RefInfo[RefType='Id' and RefId=0]]`**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T23:53:29.937

像这样。您不需要 XPath 表达式中的顶级 InqR，尽管它没有坏处。您可能也不关心 DetR，但假设您这样做，您想说“给我具有以下规范的 Refinfo 元素的父级”

```
DetRs/Refinfo[RefType='Id' and RefId='0']/.. 
```

# resharper - 您如何从 Resharper 中受益

> ID：365754
> 
> 赞同：0
> 
> 时间：2008-12-13T21:19:30.463
> 
> 标签：resharper

使用 resharper 4 可以删除多少代码混乱？

我想了解更多关于 10k+ 代码库的好处

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-13T21:44:11.133

Resharper 是一个工具。持续重构是一种态度。如果您有这种态度，那么 IMO resharper 是您可以获得的最佳工具。该工具本身并不能真正消除任何杂物。

代码库的大小只会使这些工具变得更加重要。对于相当大的代码库，您必须信任该工具。我使用所有 og jetbrains 的工具，并认为它们很棒。

*我仍然认为，通过让一个或多个了解所有技巧的*人加入您的团队，最好将持续重构引入项目。

是的。我在一个卡住的项目上工作了 7 个月，*只*使用 resharper 进行重构。我基本上重构了几乎每一行代码。也许它应该从头开始重写，但这不是一个选择。一定要在重构时引入测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T22:43:59.263

真是太棒了 我目前正在为我们正在处理的大型代码库发布版本，并且合并两个分支之间的更改非常棒。

CTRL + T => 意味着我可以立即找到类型。转到 SmartcardProductIssueService 只需 CTRL+T、SPIS、ENTER 并打开文件。SHIFT+ALT+L 并在SolutionExplorer 中选中，然后我只需右键单击查看历史记录即可开始进行合并。

重构很好，未使用代码的“变灰”效果帮助我发现了一些错误。

如果您想看到重构的乐趣，请查看[绝地重构视频](http://www.jetbrains.com/resharper/documentation/index.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-22T17:01:16.333

Resharper 在开发人员生产力方面提供了许多好处。它还通过动态建议对代码进行许多改进来改进更好的设计。我一直在鼓励我团队中的人使用 Resharper 的所有快捷方式，并尝试改掉使用鼠标的习惯。这并不是说您根本不应该使用鼠标。但是 Resharper 提供了如此丰富的功能，作为开发人员，您几乎可以忘记使用鼠标。

这是我写的一篇关于如何使用 resharper 清理代码的小博客文章 [http://nileshgule.blogspot.com/2010/10/refactoring-clean-code-using-resharper.html](http://nileshgule.blogspot.com/2010/10/refactoring-clean-code-using-resharper.html)（这确实需要点击几下鼠标这里和那里 ：））

resharper 有各种插件，如 Stylecop、NUnit 等，可帮助其他工具与 resharper 集成并提供更好的用户（开发人员）体验。

希望这可以帮助。

# java - 简单的透明度示例在 Java 3D 中不起作用

> ID：365755
> 
> 赞同：5
> 
> 时间：2008-12-13T21:20:39.840
> 
> 标签：java, transparency, alpha, java-3d

我是 j3d 的完整 n00b（但 Java 专家）。刚开始，我在玩透明度时遇到了问题。我有一个简单的例子，它绘制了一个旋转平面四边形（在显示背面时消失，因为我没有禁用背面剔除）。

取消注释 Color3b 和 COLOR_3 行（以及注释相应的 Color4b 和 COLOR_4 行），我看到旋转的四边形，颜色为红色。

但是，当我注释 color-3 行并取消注释 color-4 行时，我看到一个黑色方块（在白色背景下），即使 alpha 值设置为 255（完全不透明）。

我究竟做错了什么？Google 没有帮助，甚至 java.forums.net 上的 Java3D 论坛也无济于事。StackOverflow，救救我！您可以复制并通过下面的程序，运行它，看看会发生什么。

这是我的规格：

OSX 10.5.5 上的 Java 6 J3D 1.5.2 JOGL 1.1.1

谢谢，

- 抢

这是代码：

```
import com.sun.j3d.utils.applet.MainFrame;
import com.sun.j3d.utils.geometry.ColorCube;
import com.sun.j3d.utils.universe.SimpleUniverse;
import java.applet.Applet;
import java.awt.*;
import javax.media.j3d.*;
import javax.vecmath.*;

public class Hello extends Applet
{
 public Hello() throws Exception
 {
  setLayout(new BorderLayout());
  GraphicsConfiguration config = SimpleUniverse.getPreferredConfiguration();
  Canvas3D canvas3D = new Canvas3D(config);

  add("Center", canvas3D);

  BranchGroup scene = createSceneGraph();
  scene.compile();

  SimpleUniverse univ = new SimpleUniverse(canvas3D);

  univ.getViewingPlatform().setNominalViewingTransform();

  univ.addBranchGraph(scene);
 }

 public BranchGroup createSceneGraph() throws Exception
 {
  BranchGroup root = new BranchGroup();

  // A white background.

  Background bgd = new Background(1.0f, 1.0f, 1.0f);
  root.addChild(bgd);

  // This will spin the quad around

  TransformGroup spin = new TransformGroup();
  spin.setCapability(TransformGroup.ALLOW_TRANSFORM_WRITE);
  root.addChild(spin);

  // define the quad:

  Point3d p1 = new Point3d(-0.5, -0.5, 0);
  Point3d p2 = new Point3d(0.5, -0.5, 0);
  Point3d p3 = new Point3d(0.5, 0.5, 0);
  Point3d p4 = new Point3d(-0.5, 0.5, 0);

  // colors

  Color4b c = new Color4b((byte)255, (byte)0, (byte)0, (byte)255);
  //Color3b c = new Color3b((byte)255, (byte)0, (byte)0);

  QuadArray quads = new QuadArray(4,
    GeometryArray.COORDINATES | GeometryArray.COLOR_4);
    // GeometryArray.COORDINATES | GeometryArray.COLOR_3);

  quads.setCoordinate(0, p1);
  quads.setCoordinate(1, p2);
  quads.setCoordinate(2, p3);
  quads.setCoordinate(3, p4);
  quads.setColor(0, c);
  quads.setColor(1, c);
  quads.setColor(2, c);
  quads.setColor(3, c);

  // Not sure if I need this. Doesn't seem to make a difference.

  Appearance appearance = new Appearance();
  TransparencyAttributes trans = new TransparencyAttributes();
  trans.setTransparencyMode(TransparencyAttributes.BLENDED);
  appearance.setTransparencyAttributes(trans);

  // Create the shape...

  Shape3D shape = new Shape3D();
  shape.setGeometry(quads);
  shape.setAppearance(appearance);

  spin.addChild(shape);

  Alpha rotationAlpha = new Alpha(-1, 4000);
  RotationInterpolator rotator = new RotationInterpolator(rotationAlpha, spin);
  BoundingSphere bounds = new BoundingSphere();
  rotator.setSchedulingBounds(bounds);
  spin.addChild(rotator);

  return root;
 }

 public static void main(String[] args) throws Exception
 {
  Frame frame = new MainFrame(new Hello(), 256, 256);
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T03:57:34.450

用 Color4f 替换 Color4b，对我有用。用下面的行替换代码中的相应行，

```
Color color = new Color(255, 0, 0, 50);

Color4f c = new Color4f(color);
QuadArray quads = new QuadArray(4, 
           GeometryArray.COORDINATES | GeometryArray.COLOR_4); 
```

我使用了 AWT Color，发现它更容易传递所有 ColorNx() 构造函数，即 Color3b()、Color4b() 和 Color4f() 等。如果你觉得很自然，你可以直接使用浮点参数。实际的解决方法是使用 Color4f，而不是 AWT。即使使用 AWT Color 也不能解决 Color4b 的问题。就用 Color4f，我看不出有什么问题。

**我的平台：** Java 版本“1.6.0_10”、Java 3D 1.5.2、Core2 Duo、OpenSUSE 11.0、Intel G33 Graphics。

# php - 记住跨页面选中的复选框 - 最好的方法是什么？

> ID：365757
> 
> 赞同：3
> 
> 时间：2008-12-13T21:21:25.827
> 
> 标签：php, javascript, checkbox

我需要添加类似于 Gmail 的功能，其中在多个结果页面以及离开和返回结果时记住项目列表上的复选框。我想弄清楚的是最好的方法。我正在使用 PHP 和可能的 jQuery。

我的第一个想法是向每个复选框添加一个 onClick，触发 AJAX 回调到服务器，该服务器将 id 存储在会话中的数组中。每次加载项目列表时，系统都会检查该行是否被选中，并在必要时选中复选框。为了可靠性，在检查是否无法完成对服务器的请求（连接问题、服务器错误等）后，将取消选中该复选框，并且将尽可能快地发出请求。

这听起来不错，除了一些项目：

*   检查所有：会发生什么？它是否向服务器发送 30 个（默认页面项）请求？还是我删除所有的onClicks，选中复选框，向服务器发送带有所有ID的请求，然后重新添加onClicks？或者...？取消选中所有类似的问题。
*   速度：如果 100 多个用户一直在检查和取消检查，可能会出现问题
*   浏览器速度：我认为最好在页面加载后使用 JS 添加 onClick，如果一页上有 500 个或更多项目，我认为这可能需要一两秒。检查所有会成为一个更大的问题。

在过去，我还没有找到一种可靠的方法来检测用户何时离开页面。如果有可靠的方法，那么我可以看到这是一个选项，因此它只记录每个卸载页面。

还有其他解决方案或更好的方法吗？

**编辑：**正如[Eran Galperin](https://stackoverflow.com/questions/365757/remembering-checked-checkboxes-across-pages-whats-the-best-way#365778)所提到的，检查所有方法只需要检查每个复选框，然后对所有行进行 ajax 调用。无需删除 onClick。

而且，看起来事件委托方法是一个好主意——会让事情变得更容易。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T21:37:19.650

1.  当您以编程方式更改复选框的选中状态时，不会触发 onclick 事件。当用户单击全选/取消选中链接时，您可以发送不同的 AJAX 请求，而不必担心附加到单个复选框的单击事件。
2.  这是使用每次点击请求时的权衡。或者使用保存整个表单的“保存”按钮。
3.  使用[事件委托](http://cherny.com/webdev/70/javascript-event-delegation-and-event-hanlders)- 将一个 onclick 事件附加到包含所有复选框的整个容器，并检查事件的目标以查看是否单击了复选框。另外，我个人会避免在同一页面上显示 500 个不同的选项。如果绝对有必要拥有这么多选项，请将它们分成几个区域/页面。

对于离开页面的用户，您可以使用[onbeforeonload](http://www.webreference.com/dhtml/diner/beforeunload/bunload4.html)事件，但是如果浏览器崩溃或以其他方式不正常退出，则不会被捕获。根据捕获用户更改的重要性来使用它。

# assembly - 使用 2 个堆栈的计算器

> ID：365768
> 
> 赞同：3
> 
> 时间：2008-12-13T21:31:52.827
> 
> 标签：assembly, stack, arithmetic-expressions

我有一个英特尔装配任务。我需要编写一个使用 2 个堆栈的计算器。例如，我有一个像 23+4/2^4$ 这样的表达式。所以 $ 表示表达式的结尾。我要做的是有两个堆栈，一个用于数字，一个用于运算符，并根据运算符优先级推送和弹出它们。

我需要的是如何同时将 2 个堆栈用于两个不同的目的。只要我知道 esp register 指示堆栈中变量弹出最后一个或推送一个新变量的位置。但是如果我只有一个 esp 寄存器，我怎么能有两个堆栈呢？

提前致谢...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-13T21:37:35.437

我认为您正在寻找的是 Dijkstra 的分流算法。

我在解释过程中没有使用堆栈就解决了这个问题，只[在我的博客中描述的执行过程中解决了这个问题。](http://www.guge.net/?p=3#more-3)

至于做额外的筹码，这很容易。所有的堆栈实际上只是一个带有指向顶部和底部的指针的内存区域。每次按下时，顶部指针递增，每次弹出时，顶部指针递减。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T22:19:43.073

或者，您可以以最简单的方式可能会工作™ 并在内存中实现您的两个执行堆栈；如上所述，您只需要一个 TOP 指针和一些算术。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T23:28:43.853

所有这些答案都假设不存在运算符优先级之类的东西。显然，问题中提到的堆栈的使用暗示了与使用运算符优先级的计算有关的正确答案。

这是一个链接，解释了您要实现的目标。 [http://epaperpress.com/oper/index.html](http://epaperpress.com/oper/index.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T23:10:39.523

假设表达式的长度为 L ，那么您的每个堆栈最多为 L，因此您最多需要 2L 内存。
将 ESP 增加 2L ，在 ESP 处你将有你的第一个堆栈的开始，在 ESP+L 你将有你的第二个堆栈的开始（应该注意这些堆栈都不会超过 L 因为表达式是长度L)。
调车场算法可以在各个地方找到。它所做的就是从中缀表示法
到后缀表示法的转换。在那之后，后缀符号的评估就不难了。

编辑：另外，为了操作 2 个堆栈，您需要将它们的堆栈指针存储在某处。
您可以使用 2 个您选择的寄存器，例如 EBX、ECX
使一个具有 ESP 值，另一个具有 ESP+L 值。每次您将使用一个堆栈或另一个堆栈时，您都必须使用适当的 EBX 或 ECX 或任何您可能保留 2 个堆栈指针的地方更新 ESP，因为 push 和 pop 将修改 ESP，您将希望他们修改 ESP 的版本需要而不是另一个。此外，当您完成弹出/推送时，您必须使用 ESP 的值更新 EBX/ECX。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T22:00:29.023

由于您的两个堆栈不是独立的，因此另一个想法是将**数据交错在单个堆栈上**。例如，您可以将偶数字用于数字，将奇数字用于运算符。

* * *

编辑：按照评论中的要求详细说明这个想法：我相信每次你推送一个运算符时，你都会推送它后面的数字（因为该数字后面可能会跟着一个更高优先级的运算符）。同样，每次弹出和运算符时，您都将弹出两个操作数并推送一个结果。因此，操作符堆栈和操作数堆栈同时增长和缩小，并且由于最初的问题是如何在汇编代码中执行此操作，我建议他们可以在单个堆栈上共享交替的插槽。（如果这还不够详细，请告诉我，我会再次编辑。）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-13T22:47:27.307

那么，我创建两个这样的堆栈是否正确：

```
mov ecx,256
L1: call ReadInt
    push eax          ;push the integer to where esp=1 points
    add esp,ecx       ;esp=1+256=257, now esp points to 257.

    call ReadChar     ;read operand
    cmp al,endChar    ;compare with end sign=$
    je next       
    push al           ;push operand to where esp=257 points
    sub esp,ecx       ;esp=257-256=1, now esp is in the original position
    loop L1
next:
... 
```

当然，评论是针对第一个循环的。

顺便说一句，我得到一个“1>..\main.asm(46)：错误 A2149：字节寄存器不能是第一个操作数”错误（push al）？怎么了？

谢谢...

# .net - Pocket PC/Windows Mobile：如何检测智能最小化

> ID：365773
> 
> 赞同：7
> 
> 时间：2008-12-13T21:35:28.153
> 
> 标签：.net, windows-mobile, compact-framework, pocketpc, minimize

如何检测我的 Compact Framework 应用程序何时被智能最小化（智能最小化是用户单击 Pocket PC 右上角的“X”按钮时发生的事情）？

Deactivate 事件不是正确的方法，因为它发生在最小化以外的情况下，例如当消息框或其他窗体显示在主窗体顶部时。并且表单的 WindowState 没有帮助，因为 .NET CF 上没有“最小化”WindowState。

我听说通过设置 MinimizeBox = false，我的应用程序将被关闭而不是最小化。但我实际上不希望我的应用程序关闭，我只想知道它什么时候被最小化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-04T01:13:16.737

我认为这里的方法是处理[WM_ACTIVE](http://msdn.microsoft.com/en-us/library/aa922525.aspx)消息，然后检查 fMinimized 参数是否不为零。[您可以在此处](http://www.pinvoke.net/default.aspx/Enums/WindowsMessages.html)找到有关如何在代码中声明此消息的更多信息。

我将尝试弄清楚如何在 C# 中准确编码并证明假设。但是，您可能比我快并弄清楚。

还要检查用于处理消息的函数[DefWindowProc](http://msdn.microsoft.com/en-us/library/ms960018.aspx)和[WindowProc 。](http://msdn.microsoft.com/en-us/library/ms915527.aspx)函数在您的代码中声明如下：

首先有包括：

```
using System.Runtime.InteropServices; 
```

然后在类中声明这样

```
[DllImport("coredll.dll")]
static extern IntPtr DefWindowProc(IntPtr hWnd, uint uMsg, UIntPtr wParam,
   IntPtr lParam); 
```

* * *

您还可以做另一件事，这更像是一种“哲学”解决方法。INMO 智能最小化 X 让用户感到困惑，这就是我不喜欢包含它的原因。相反，我在表单的右下角提供了一个按钮，上面写着“关闭”或“返回”，它使用表单的关闭方法。我以各种形式使用它来保持标准。这对 windows 用户来说不太含糊，因为他们可能会认为 windows mobile 中的 X 与 windows for PC 中的 X 相同。

如果由于某种原因您需要最小化您的应用程序或将其发送到后台，请使用以下代码：

```
using System.Runtime.InteropServices;
...

public partial class Main : Form
{
   public Main()
    {

        InitializeComponent();
    }

  [DllImport("coredll.dll")]
    static extern int ShowWindow(IntPtr hWnd, int nCmdShow);

  const int SW_MINIMIZED = 6;

  ...
  ...

   public void HideForm()
    {
        ShowWindow(this.Handle, SW_MINIMIZED);
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-12-15T07:29:06.007

智能最小化到底是什么意思？我想您的意思是您的应用程序在一段时间内没有活动时会自动最小化？好吧，我不认为有这样的事件。

该[博客点](http://blogs.msdn.com/windowsmobile/archive/2005/08/03/447404.aspx)的作者使用 Deactivate 事件来打开和关闭内部进程。这对于动画和其他类似的过程是可以接受的，并且弹出消息框或其他表单的情况没有问题。但是，如果除非应用程序关闭或“智能最小化”，否则您的进程不得停止，您可以尝试在停用事件上启动计时器。如果表单在特定时间间隔内没有被激活，那么停止内部进程是安全的。

当然，在设计解决方案时，您需要考虑电源管理。看看[这个](http://#)，当然还有 OpenNetCF 的电源通知。

# xml - 大型 XML 文件的架构和缓存注意事项

> ID：365776
> 
> 赞同：3
> 
> 时间：2008-12-13T21:36:45.390
> 
> 标签：xml, architecture, caching, data-layers

我正在建立一个网站来展示产品和产品类别。数据来自一个 500k XML 文件形式的外部服务。该网站是 ASP.NET，C#。

XML 被结构化为类别列表。每个类别内可能有一些产品和/或更多类别。

显然，我们无法调用这个外部服务来获取每个页面请求的大 XML 文件，所以我们每隔几个小时调用一次并缓存它。我需要做这样的事情：

*   在页面左侧显示产品类别菜单
*   显示选定类别中的所有产品
*   显示单个产品的扩展信息

我的问题如下：

首先，在显示“DVD”类别中所有产品的页面上，假设我执行以下操作（在页面加载时）：

```
XDocument allCategories = Cache["CategoriesXml"];
// loop through the XML and find the DVD category
// Get all products under it, then display them 
```

通过将类别 XML 放入一个局部变量（记住，它是 500k），这是否会消耗服务器？请记住，每次加载页面时我都必须这样做。可能有成千上万的人同时查看不同的页面。如果一千个人在几秒钟内加载同一个页面，我会在内存中保留一千个这个 XML 文件的实例吗？或者垃圾收集器会为我管理所有这些吗？

直接循环缓存项目是否更好，还是性能较差（和/或不好的做法）？

其次，我说我缓存了整个 XML 文件。我通过循环从该 XML 中获取产品或类别（我使用 LINQ over XML）。创建 Category 类型和 Product 类型，将它们放入数组并缓存它会更好吗？然后循环通过 Category 对象和数组而不是 XDocument？什么会更高效？

第三，就如何构建该系统而言，您会说什么是最佳实践。假设我有一个数据访问层、一个业务对象层和 Web 应用程序。我应该把对外部服务的引用放在哪里来检索 XML？我应该缓存哪一层？这个应用程序是否有数据访问层，从某种意义上说，DAL 部分是由其他系统完成的？目前我的 DAL 仅用于访问我们的数据库，在其中放置 web 服务引用感觉不对 - 但也许不是？在业务层中使用缓存是不好的做法（即干扰单元测试等）？我已经考虑了 Web 和业务层之间的中间层，仅用于缓存 - 这是一个好主意还是坏主意？

实际上，我已经完成了这个网站的大部分内容 - 我现在只是回顾它，想知道我是否以最好的方式完成了它，所以想将您的建议与我实际所做的进行比较，希望我会能够回去改进它。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T01:05:20.913

我已经做了类似的事情，我会把你的缓存逻辑放在你的数据层中。这将从您的业务和表示层中删除所有缓存逻辑。

我不熟悉 ASP.NET，但我的猜测是肯定的，每个页面请求都会导致 XMl 文件被单独加载。

而且我不会将 XML 存储在内存中。您应该将所需的*数据*存储在内存中。可能有 ASP.NET 库用于使用内存缓存，例如 Memcached，您可以在其中存储对象的序列化版本。

# javascript - 使用 JavaScript 开始文件下载

> ID：365777
> 
> 赞同：60
> 
> 时间：2008-12-13T21:37:03.893
> 
> 标签：javascript, ajax, download

*假设我的网站上有文件的下载链接。*

当点击这些链接时，会向服务器发送一个 AJAX 请求，服务器会返回带有文件位置的 URL。

我想要做的是在响应返回时指示浏览器下载文件。有没有便携的方法来做到这一点？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2011-01-10T12:45:00.223

我们这样做：首先添加这个脚本。

```
<script type="text/javascript">
function populateIframe(id,path) 
{
    var ifrm = document.getElementById(id);
    ifrm.src = "download.php?path="+path;
}
</script> 
```

把它放在你想要下载按钮的地方（这里我们只使用一个链接）：

```
<iframe id="frame1" style="display:none"></iframe>
<a href="javascript:populateIframe('frame1','<?php echo $path; ?>')">download</a> 
```

文件“download.php”（需要放在您的服务器上）仅包含：

```
<?php 
   header("Content-Type: application/octet-stream");
   header("Content-Disposition: attachment; filename=".$_GET['path']);
   readfile($_GET['path']);
?> 
```

因此，当您单击链接时，隐藏的 iframe 会获取/打开源文件“download.php”。使用路径作为获取参数。我们认为这是最好的解决方案！

应该注意的是，这个解决方案的 PHP 部分是一个简单的演示，并且可能非常非常不安全。它允许用户下载任何文件，而不仅仅是预定义的集合。这意味着他们可以下载网站本身的部分源代码，可能包含 API 凭证等。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-06-16T16:52:31.670

我创建了一个开源[jQuery 文件下载插件](http://johnculviner.com/post/2012/03/22/Ajax-like-feature-rich-file-downloads-with-jQuery-File-Download.aspx)（[带有示例的演示](http://jqueryfiledownload.apphb.com/)）（[GitHub](https://github.com/johnculviner/jquery.fileDownload)），它也可以帮助您解决问题。它与 iframe 的工作方式非常相似，但有一些很酷的功能，我发现它们非常方便：

*   用户永远不会离开他们启动文件下载的同一页面。此功能对于现代 Web 应用程序变得至关重要
*   经过测试的跨浏览器支持（包括移动设备！）
*   它以类似于 jQuery 的 AJAX API 的方式支持 POST 和 GET 请求
*   successCallback 和 failCallback 函数允许您明确说明用户在任何一种情况下看到的内容
*   结合 jQuery UI，开发人员可以轻松地显示一个模态，告诉用户正在下载文件，在下载开始后解散模态，甚至以友好的方式通知用户发生了错误。有关此示例，请参阅演示。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-12-13T23:20:13.590

只需`window.location.href = new_url`从您的 javascript 调用，它就会将浏览器重定向到该 URL，因为它是用户在地址栏中输入的

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-12-02T16:16:14.490

阅读答案 - 包括已接受的答案，我想指出通过 GET 将路径直接传递给 readfile 的安全隐患。

这对某些人来说似乎很明显，但有些人可能只是复制/粘贴此代码：

```
<?php 
   header("Content-Type: application/octet-stream");
   header("Content-Disposition: attachment; filename=".$_GET['path']);
   readfile($_GET['path']);
?> 
```

那么，如果我将 '/path/to/fileWithSecrets' 之类的内容传递给该脚本会发生什么？给定的脚本将愉快地发送 webserver-user 可以访问的任何文件。

有关如何防止这种情况的信息，请参阅此讨论：[如何确保文件路径在给定的子目录中？](https://stackoverflow.com/questions/456546/how-do-i-make-sure-a-file-path-is-within-a-given-subdirectory)

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-12-13T23:10:54.857

如果这是您自己的服务器应用程序，那么我建议使用以下标头

```
Content-disposition: attachment; filename=fname.ext 
```

这将强制任何浏览器下载文件而不是在浏览器窗口中呈现它。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-05T23:43:36.527

试试这个库[https://github.com/PixelsCommander/Download-File-JS](https://github.com/PixelsCommander/Download-File-JS)它比之前描述的所有解决方案都更现代，因为它使用“下载”属性和方法组合来带来最佳体验。

在这里解释 - [http://pixelscommander.com/en/javascript/javascript-file-downliading-ignore-content-type/](http://pixelscommander.com/en/javascript/javascript-file-downliading-ignore-content-type/)

似乎是开始在 JavaScript 中下载的理想代码。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-13T22:14:33.100

同意 maxnk 提到的方法，但是您可能需要重新考虑尝试自动强制浏览器下载 URL。它可能适用于二进制文件，但对于其他类型的文件（文本、PDF、图像、视频），浏览器可能希望在窗口（或 IFRAME）中呈现它，而不是保存到磁盘。

如果您确实需要进行 Ajax 调用以获取最终下载链接，那么使用 DHTML 将下载链接（来自 ajax 响应）动态写入页面怎么样？这样，用户可以单击它进行下载（如果是二进制文件）或在浏览器中查看 - 或在链接上选择“另存为”以保存到磁盘。这是一个额外的点击，但用户有更多的控制权。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-03-14T18:26:37.557

要绕过投票最多的答案中的安全漏洞，您可以将 iframe src 直接设置为您想要的文件（而不是中间 php 文件）并在 .htaccess 文件中设置标头信息：

```
<Files *.apk>
     ForceType application/force-download
     Header set Content-Disposition attachment
     Header set Content-Type application/vnd.android.package-archive
     Header set Content-Transfer-Encoding binary
</Files> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-13T22:07:48.963

我建议在页面上创建一个不可见的 iframe，并将其 src 设置为您从服务器收到的 url - 下载将在不重新加载页面的情况下开始。

或者您可以将当前的 document.location.href 设置为接收到的 url 地址。但是，如果请求的文档实际上不存在，这可能会导致用户看到错误。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-08-20T20:46:48.673

关于最佳答案，我有一个可能的安全风险解决方案。

```
<?php
     if(isset($_GET['path'])){
         if(in_array($_GET['path'], glob("*/*.*"))){
             header("Content-Type: application/octet-stream");
             header("Content-Disposition: attachment; filename=".$_GET['path']);
             readfile($_GET['path']);
         }
     }
?> 
```

使用 glob() 函数（我在要下载的文件的上一个文件夹的路径中测试了下载文件）我能够快速制作一组“允许”下载的文件，并对照它检查传递的路径. 这不仅确保被抓取的文件不是敏感文件，而且同时检查文件是否存在。

~注：Javascript / HTML~

HTML：

```
<iframe id="download" style="display:none"></iframe> 
```

和

```
<input type="submit" value="Download" onclick="ChangeSource('document_path');return false;"> 
```

JavaScript：

```
<script type="text/javascript">
    <!--
        function ChangeSource(path){
            document.getElementByID('download').src = 'path_to_php?path=' + document_path;
        }
    -->
</script> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-13T22:24:29.787

我建议`window.open()`打开一个弹出窗口。如果是下载，则没有窗口，您将获得文件。如果有 404 什么的，用户将在新窗口中看到它（因此，他们的工作不会受到打扰，但他们仍然会收到错误消息）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2013-03-05T23:47:12.397

当您只需要将浏览器重定向到不同的 window.location.href 时，为什么还要制作服务器端的东西？

这是解析 ?file= QueryString （[取自这个问题](https://stackoverflow.com/a/2880929)）并在 1 秒内将用户重定向到该地址的代码（即使在 Android 浏览器上也适用于我）：

```
<script type="text/javascript">
    var urlParams;
    (window.onpopstate = function () {
        var match,
        pl = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
        query = window.location.search.substring(1);

        urlParams = {};
        while (match = search.exec(query))
            urlParams[decode(match[1])] = decode(match[2]);
    })();

    (window.onload = function() {
        var path = urlParams["file"];
        setTimeout(function() { document.location.href = path; }, 1000);
    });
</script> 
```

如果您的项目中有 jQuery，请务必删除那些 window.onpopstate 和 window.onload 处理程序并在 $(document).ready(function () { } ); 中执行所有操作

# wpf - 我怎么能实现这个奇怪的 WPF TreeListDataGridView？

> ID：365780
> 
> 赞同：0
> 
> 时间：2008-12-13T21:37:57.730
> 
> 标签：wpf, treeview, datatemplate, hierarchicaldatatemplate, controltemplates

正如您在下图中看到的那样，我有一个树数据模型，其中包含可以包含其他组的组以及可以再次保存参数的任意数量的项目。参数本身是全局定义的，并且只会在项目中再次出现。只有参数的实际值可能会因不同项目中的参数用法而异。

下图是一个普通的 WPF 树视图控件，带有自定义控件模板和项目的数据模板。

现在我的目标是删除文本框上方的参数名称，并将它们垂直堆叠在树视图最左侧的单独列中，然后将文本框留在那里，但也垂直堆叠，以便它们与第一列中的参数名称相对应。

有没有办法通过控制模板和数据模板以及数据绑定到视图模型来解决这个问题？（是的，我使用 MVVM）

[树视图图片 http://img242.imageshack.us/img242/5377/treebh8.th.png](http://img242.imageshack.us/img242/5377/treebh8.th.png) [图片链接](http://img242.imageshack.us/img242/5377/treebh8.png)

这个问题是一个通用的布局问题，必须与数据绑定一起工作。通常我想将对象图绑定到一个看起来像这样的视图（剪切模型）：

[树布局 http://img75.imageshack.us/img75/5763/treelayoutjh5.jpg](http://img75.imageshack.us/img75/5763/treelayoutjh5.jpg)

请注意，ParamX 标头不再是树形布局的一部分。但价值仍然存在。现在这些值必须与它们保持连接（即它们在同一行）。此外，如果树中的任何项目都不包含例如 Param1，则 Param1 标题和相应的行必须完全消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-14T12:24:08.547

我不是树视图专家，但是在没有树视图的情况下很容易构建类似的东西。

从一个名为 WpfTreeGridWhatever 的空 VS2008 Wpf 应用程序开始

首先，让我们定义我们的模型：

```
using System;
using System.Collections.Generic;

namespace WpfTreeGridWhatever
{
    public class ItemBase
    {
    }
    public class Group : ItemBase
    {
        public string Name { get; set; }
        public IList<ItemBase> Items { get; set; }
    }
    public class Item : ItemBase
    {
        public string Name { get; set; }
        public IList<Parameter> Parameters { get; set; }
    }
    public class Parameter
    {
        public string Name { get; set; }
        public string Value { get; set; }
    }
} 
```

现在，在 Window1 构造函数中创建我们的对象（这样我们就有了一些要绑定的数据）：

```
 public Window1()
    {
        DataContext = new Group[]
        {
            new Group()
            {
                Name="Group A",
                Items = new List<ItemBase>()
                {
                    new Item()
                    {
                        Name="Item",
                        Parameters=new List<Parameter>()
                        {
                            new Parameter(){Name="Param 1",Value="12"},
                            new Parameter(){Name="Param 2",Value="true"},
                            new Parameter(){Name="Param 3",Value="0.0"},
                            new Parameter(){Name="Param 4",Value="off"},
                        }
                    },
                    new Item()
                    {
                        Name="Item",
                        Parameters=new List<Parameter>()
                        {
                            new Parameter(){Name="Param 1",Value="12"},
                            new Parameter(){Name="Param 2",Value="true"}
                        }
                    },
                    new Group()
                    {
                        Name="Group B",
                        Items = new List<ItemBase>()
                        {
                            new Item()
                            {
                                Name="Item",
                                Parameters=new List<Parameter>()
                                {
                                    new Parameter(){Name="Param 1",Value="12"},
                                    new Parameter(){Name="Param 2",Value="true"},
                                    new Parameter(){Name="Param 3",Value="0.0"},
                                    new Parameter(){Name="Param 4",Value="off"},
                                }
                            },
                            new Item()
                            {
                                Name="Item",
                                Parameters=new List<Parameter>()
                                {
                                    new Parameter(){Name="Param 1",Value="12"},
                                    new Parameter(){Name="Param 2",Value="true"},
                                    new Parameter(){Name="Param 3",Value="0.0"},
                                    new Parameter(){Name="Param 4",Value="off"},
                                    new Parameter(){Name="Param 5",Value="2000"},
                                }
                            },
                            new Item()
                            {
                                Name="Item",
                                Parameters=new List<Parameter>()
                                {
                                    new Parameter(){Name="Param 1",Value="12"},
                                    new Parameter(){Name="Param 2",Value="true"},
                                }
                            },
                            new Group()
                            {
                                Name="Group C",
                                Items = new List<ItemBase>()
                                {
                                    new Item()
                                    {
                                        Name="Item",
                                        Parameters=new List<Parameter>()
                                        {
                                            new Parameter(){Name="Param 1",Value="12"},
                                            new Parameter(){Name="Param 2",Value="true"},
                                            new Parameter(){Name="Param 3",Value="0.0"},
                                            new Parameter(){Name="Param 4",Value="off"},
                                        }
                                    },
                                    new Item()
                                    {
                                        Name="Item",
                                        Parameters=new List<Parameter>()
                                        {
                                            new Parameter(){Name="Param 1",Value="12"},
                                            new Parameter(){Name="Param 2",Value="true"},
                                            new Parameter(){Name="Param 3",Value="0.0"},
                                            new Parameter(){Name="Param 4",Value="off"},
                                            new Parameter(){Name="Param 5",Value="2000"},
                                        }
                                    },
                                    new Item()
                                    {
                                        Name="Item",
                                        Parameters=new List<Parameter>()
                                        {
                                            new Parameter(){Name="Param 1",Value="12"},
                                            new Parameter(){Name="Param 2",Value="true"},
                                        }
                                    },
                                }
                            }
                        }
                    }
                }
            }
        };

        InitializeComponent();
    } 
```

现在，魔术 - 在 Window1.xaml 中使用此代码

```
<Window x:Class="WpfTreeGridWhatever.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:l="clr-namespace:WpfTreeGridWhatever"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <LinearGradientBrush x:Key="Bk" StartPoint="0,0" EndPoint="0,1" >
            <GradientStop Offset="0" Color="DarkGray"/>
            <GradientStop Offset="1" Color="White"/>
        </LinearGradientBrush>
        <DataTemplate DataType="{x:Type l:Parameter}">
            <Border CornerRadius="5" Background="{StaticResource Bk}"
                    BorderThickness="1" BorderBrush="Gray" Margin="2" >
                <StackPanel Margin="5">
                    <TextBlock Height="12" Text="{Binding Name}"/>
                    <TextBox Height="22" Text="{Binding Value}"/>
                </StackPanel>
            </Border>
        </DataTemplate>
        <DataTemplate DataType="{x:Type l:Item}" >
            <StackPanel>
                <Border CornerRadius="5" Background="{StaticResource Bk}"
                    BorderThickness="1" BorderBrush="Gray" Height="25" Margin="3">
                    <TextBlock Height="12" Text="{Binding Name}" VerticalAlignment="Center" Margin="3,0"/>
                </Border>
                <ItemsControl ItemsSource="{Binding Parameters}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </StackPanel>
        </DataTemplate>
        <DataTemplate DataType="{x:Type l:Group}">
            <StackPanel>
                <Border CornerRadius="5" Background="{StaticResource Bk}"
                    BorderThickness="1" BorderBrush="Gray" Height="25" Margin="3">
                    <TextBlock Height="12" Text="{Binding Name}" VerticalAlignment="Center" Margin="3,0"/>
                </Border>
                <ItemsControl ItemsSource="{Binding Items}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </StackPanel>
        </DataTemplate>

    </Window.Resources>
    <Grid>
        <ItemsControl ItemsSource="{Binding}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
        </ItemsControl>
    </Grid>
</Window> 
```

这应该让你开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T05:25:05.587

您可以尝试您在问题标题中的假设 - 创建一个 TreeListDataGridView。它将是一个自定义控件，由顶部的 TreeView 和底部的 DataGrid 组成 - 或者可能只是一个普通的 Grid，具体取决于所需的效果。这样，您将拥有自己的外观，并保留数据绑定、控件模板等的所有优势。

# c++ - 如何最好地处理 C/C++ 中的动态多维数组？

> ID：365782
> 
> 赞同：26
> 
> 时间：2008-12-13T21:38:32.127
> 
> 标签：c++, c, arrays, multidimensional-array

在 C 和/或 C++ 中操作动态（直到运行时才知道所有维度）多维数组的公认/最常用方法是什么。

我正在尝试找到最简洁的方法来完成此 Java 代码的功能：

```
public static void main(String[] args){
 Scanner sc=new Scanner(System.in);
 int rows=sc.nextInt();
 int cols=sc.nextInt();
 int[][] data=new int[rows][cols];
 manipulate(data);
}

public static void manipulate(int[][] data){
   for(int i=0;i<data.length;i++)
   for(int j=0;j<data[0].length.j++){
         System.out.print(data[i][j]);       
   }    
} 
```

（从 std_in 读取只是为了澄清直到运行时才知道尺寸）。

编辑：我注意到这个问题很受欢迎，尽管它已经很老了。我实际上不同意最高投票的答案。我认为 C 的最佳选择是使用一维数组，正如 Guge 在下面所说的“您可以分配行*cols* sizeof(int) 并通过 table[row*cols+col] 访问它。”。

C++ 有很多选择，如果您真的喜欢 boost 或 stl，那么下面的答案可能更可取，但最简单且可能最快的选择是使用 C 中的一维数组。

如果您想要 [][] 语法，C 和 C++ 中的另一个可行选择是 lillq 在底部的答案是手动构建具有大量 malloc 的数组。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-13T21:52:51.943

使用**[boost::multi_array](http://www.boost.org/doc/libs/1_37_0/libs/multi_array/doc/user.html)**。

与您的示例一样，您在编译时唯一需要知道的是维数。这是文档中的第一个示例：

```
#include "boost/multi_array.hpp"
#include <cassert>

int 
main () {
  // Create a 3D array that is 3 x 4 x 2
  typedef boost::multi_array<double, 3> array_type;
  typedef array_type::index index;
  array_type A(boost::extents[3][4][2]);

  // Assign values to the elements
  int values = 0;
  for(index i = 0; i != 3; ++i) 
    for(index j = 0; j != 4; ++j)
      for(index k = 0; k != 2; ++k)
        A[i][j][k] = values++;

  // Verify values
  int verify = 0;
  for(index i = 0; i != 3; ++i) 
    for(index j = 0; j != 4; ++j)
      for(index k = 0; k != 2; ++k)
        assert(A[i][j][k] == verify++);

  return 0;
} 
```

编辑：正如评论中所建议的，[这是一个“简单”的示例](http://www.klaimsden.net/code/Test_MultiArray.cpp)应用程序，可让您在运行时定义多维数组大小，从控制台输入询问。这是此示例应用程序的示例输出（使用常量编译，表示它是 3 维）：

```
Multi-Array test!
Please enter the size of the dimension 0 : 4

Please enter the size of the dimension 1 : 6

Please enter the size of the dimension 2 : 2

Text matrix with 3 dimensions of size (4,6,2) have been created.

Ready!
Type 'help' for the command list.

>read 0.0.0
Text at (0,0,0) :
  ""

>write 0.0.0 "This is a nice test!"
Text "This is a nice test!" written at position (0,0,0)

>read 0.0.0
Text at (0,0,0) :
  "This is a nice test!"

>write 0,0,1 "What a nice day!"
Text "What a nice day!" written at position (0,0,1)

>read 0.0.0
Text at (0,0,0) :
  "This is a nice test!"

>read 0.0.1
Text at (0,0,1) :
  "What a nice day!"

>write 3,5,1 "This is the last text!"
Text "This is the last text!" written at position (3,5,1)

>read 3,5,1
Text at (3,5,1) :
  "This is the last text!"

>exit 
```

代码中的重要部分是我们从用户那里获取维度并创建数组的主要功能：

```
const unsigned int DIMENSION_COUNT = 3; // dimension count for this test application, change it at will :)

// here is the type of the multi-dimensional (DIMENSION_COUNT dimensions here) array we want to use
// for this example, it own texts
typedef boost::multi_array< std::string , DIMENSION_COUNT > TextMatrix;

// this provide size/index based position for a TextMatrix entry.
typedef std::tr1::array<TextMatrix::index, DIMENSION_COUNT> Position; // note that it can be a boost::array or a simple array

/*  This function will allow the user to manipulate the created array
    by managing it's commands.
    Returns true if the exit command have been called.
*/
bool process_command( const std::string& entry, TextMatrix& text_matrix );

/* Print the position values in the standard output. */
void display_position( const Position& position );

int main()
{
    std::cout << "Multi-Array test!" << std::endl;

    // get the dimension informations from the user
    Position dimensions; // this array will hold the size of each dimension 

    for( int dimension_idx = 0; dimension_idx < DIMENSION_COUNT; ++dimension_idx )
    {
        std::cout << "Please enter the size of the dimension "<< dimension_idx <<" : ";
        // note that here we should check the type of the entry, but it's a simple example so lets assume we take good numbers
        std::cin >> dimensions[dimension_idx]; 
        std::cout << std::endl;

    }

    // now create the multi-dimensional array with the previously collected informations
    TextMatrix text_matrix( dimensions );

    std::cout << "Text matrix with " << DIMENSION_COUNT << " dimensions of size ";
    display_position( dimensions );
    std::cout << " have been created."<< std::endl;
    std::cout << std::endl;
    std::cout << "Ready!" << std::endl;
    std::cout << "Type 'help' for the command list." << std::endl;
    std::cin.sync();

    // we can now play with it as long as we want
    bool wants_to_exit = false;
    while( !wants_to_exit )
    {
        std::cout << std::endl << ">" ;
        std::tr1::array< char, 256 > entry_buffer; 
        std::cin.getline(entry_buffer.data(), entry_buffer.size());

        const std::string entry( entry_buffer.data() );
        wants_to_exit = process_command( entry, text_matrix );
    }

    return 0;
} 
```

你可以看到加入数组中的一个元素，这真的很容易：你只需使用 operator() 如下函数：

```
void write_in_text_matrix( TextMatrix& text_matrix, const Position& position, const std::string& text )
{
    text_matrix( position ) = text;
    std::cout << "Text \"" << text << "\" written at position ";
    display_position( position );
    std::cout << std::endl;
}

void read_from_text_matrix( const TextMatrix& text_matrix, const Position& position )
{
    const std::string& text = text_matrix( position );
    std::cout << "Text at ";
    display_position(position);
    std::cout << " : "<< std::endl;
    std::cout << "  \"" << text << "\"" << std::endl;
} 
```

注意：我在 VC9 + SP1 中编译了这个应用程序——得到了一些容易忘记的警告。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-14T01:59:25.750

在 C++ 中有两种表示二维数组的方法。一个比另一个更灵活。

**数组数组**

首先创建一个指针数组，然后用另一个数组初始化每个指针。

```
// First dimension
int** array = new int*[3];
for( int i = 0; i < 3; ++i )
{
    // Second dimension
    array[i] = new int[4];
}

// You can then access your array data with
for( int i = 0; i < 3; ++i )
{
    for( int j = 0; j < 4; ++j )
    {
        std::cout << array[i][j];
    }
} 
```

这种方法的问题是您的第二维被分配了尽可能多的数组，因此不会减轻内存分配器的工作。您的内存可能会碎片化，从而导致性能下降。但它提供了更大的灵活性，因为第二维中的每个数组都可以有不同的大小。

**保存所有值的大数组**

这里的诀窍是创建一个庞大的数组来保存您需要的所有数据。困难的部分是，如果您希望能够使用 array[i][j] 语法访问数据，您仍然需要第一个指针数组。

```
int* buffer = new int[3*4];   
int** array = new int*[3];

for( int i = 0; i < 3; ++i )
{
    array[i] = array + i * 4;
} 
```

int* 数组不是强制性的，因为您可以通过从值的二维坐标计算缓冲区中的索引来直接访问缓冲区中的数据。

```
// You can then access your array data with
for( int i = 0; i < 3; ++i )
{
    for( int j = 0; j < 4; ++j )
    {
        const int index = i * 4 + j;
        std::cout << buffer[index];
    }
} 
```

**要记住的规则**

计算机内存是线性的，并且仍然会持续很长时间。请记住，计算机本身不支持二维数组，因此唯一的方法是将数组“线性化”为一维数组。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-13T21:44:17.623

您可以分配行*cols* sizeof(int) 并通过 table[row*cols+col] 访问它。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-13T22:17:59.303

不使用 boost 的标准方法是使用 std::vector ：

```
std::vector< std::vector<int> > v;
v.resize(rows, std::vector<int>(cols, 42)); // init value is 42
v[row][col] = ...; 
```

这将自动处理新/删除您需要的内存。但它相当慢，因为`std::vector`主要不是为这样使用它而设计的（`std::vector`相互嵌套）。例如，并非所有内存都分配在一个块中，而是为每一列单独分配。此外，行不必都是相同的宽度。Faster 是使用法线向量，然后进行索引计算，例如`col_count * row + col`获取某个行和列：

```
std::vector<int> v(col_count * row_count, 42);
v[col_count * row + col) = ...; 
```

但这将失去使用`[x][y]`. 您还必须在某处存储行数和列数，同时使用嵌套解决方案您可以获得使用的行数`v.size()`和使用的列数`v[0].size()`。

使用 boost，您可以使用`boost::multi_array`，这正是您想要的（请参阅其他答案）。

* * *

还有一种使用原生 C++ 数组的原始方式。这涉及相当多的工作，并且绝不比嵌套向量解决方案更好：

```
int ** rows = new int*[row_count];
for(std::size_t i = 0; i < row_count; i++) {
    rows[i] = new int[cols_count];
    std::fill(rows[i], rows[i] + cols_count, 42);
}

// use it... rows[row][col] then free it...

for(std::size_t i = 0; i < row_count; i++) {
    delete[] rows[i];
}

delete[] rows; 
```

您必须在某处存储您创建的列和行的数量，因为您无法从指针接收它们。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-01-16T06:34:07.873

这是在 C 中执行此操作的简单方法：

```
void manipulate(int rows, int cols, int (*data)[cols]) {
    for(int i=0; i < rows; i++) {
        for(int j=0; j < cols; j++) {
            printf("%d ", data[i][j]);       
        }
        printf("\n");
    }
}

int main() {
    int rows = ...;
    int cols = ...;
    int (*data)[cols] = malloc(rows*sizeof(*data));
    manipulate(rows, cols, data);
    free(data);
} 
```

这自 C99 以来完全有效，但它不是任何标准的 C++：C++ 要求数组类型的大小是编译时间常量。在这方面，C++ 现在比 C 落后了 15 年。而且这种情况不会很快改变（C++17 的可变长度数组提案并未接近 C99 可变长度数组的功能）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-14T00:31:58.890

C 和 C++ 中的 2D C 样式数组是大小`rows * columns * sizeof(datatype)`字节的内存块。

实际的 [row][column] 维度仅在编译时静态存在。运行时没有动态的东西！

因此，正如其他人所提到的，您可以实施

```
 int array [ rows ] [ columns ]; 
```

作为：

```
 int  array [ rows * columns ] 
```

或者作为：

```
 int * array = malloc ( rows * columns * sizeof(int) ); 
```

* * *

下一步：声明一个可变大小的数组。 **在 C**中这是可能的：

```
int main( int argc, char ** argv )
{
  assert( argc > 2 );

  int rows    = atoi( argv[1] );
  int columns = atoi( argv[2] );

  assert(rows > 0 && columns > 0);
  int data [ rows ] [ columns ];  // Yes, legal!

  memset( &data, 0, sizeof(data) );

  print( rows, columns, data );
  manipulate( rows, columns, data );
  print( rows, columns, data );
} 
```

* * *

**在 C**中，您可以将可变大小的数组与非可变大小的数组一样传递：

```
void manipulate( int theRows, int theColumns, int theData[theRows][theColumns] )
{
  for (   int r = 0; r < theRows;    r ++ )
    for ( int c = 0; c < theColumns; c ++  )
      theData[r][c] = r*10 + c;
} 
```

**但是，在 C++**中这是不可能的。您需要使用动态分配来分配数组，例如：

```
int *array = new int[rows * cols](); 
```

或者最好（使用自动内存管理）

```
std::vector<int> array(rows * cols); 
```

然后必须修改函数以接受一维数据：

```
void manipulate( int theRows, int theColumns, int *theData )
{
  for (   int r = 0; r < theRows;    r ++ )
    for ( int c = 0; c < theColumns; c ++  )
      theData[r * theColumns + c] = r*10 + c;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-13T22:13:39.310

如果您使用 C 而不是 C++，您可能需要查看 Dave Hanson 的库[C Interfaces and Implementations](http://www.cs.princeton.edu/software/cii)中的 Array_T 抽象。它非常干净且设计精良。我让我的学生做一个二维版本作为练习。您可以这样做或简单地编写一个执行索引映射的附加函数，例如，

```
void *Array_get_2d(Array_T a, int width, int height, int i, int j) {
    return Array_get(a, j * width, i, j);
} 
```

有一个单独的结构来存储宽度、高度和指向元素的指针会更简洁一些。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-01-16T06:16:58.147

我最近遇到了一个类似的问题。我没有可用的 Boost。与普通数组相比，向量的向量变得非常慢。拥有一个指针数组会使初始化更加费力，因为您必须遍历每个维度并初始化指针，在此过程中可能有一些非常笨拙的级联类型，可能还有很多 typedef。

免责声明：我不确定是否应该将其发布为答案，因为它只回答了您的部分问题。我对以下内容表示歉意：

*   正如其他评论员所说，我没有介绍如何从标准输入中读取尺寸。
*   这主要用于 C++。
*   我只为二维编码了这个解决方案。

无论如何，我决定发布这个，因为我看到在回答有关 C++ 中的多维数组的问题时经常提到向量的向量，而没有人提到它的性能方面（如果你关心它的话）。

我还将这个问题的核心问题解释为关于如何获得动态多维数组，这些数组可以像问题中的 Java 示例一样轻松使用，即无需用伪计算索引的麻烦。多维一维数组。

我没有看到其他答案中提到的编译器扩展，例如 GCC/G++ 提供的那些声明具有动态边界的多维数组的方式与使用静态边界的方式相同。据我了解，这个问题并不限制标准 C/C++ 的答案。ISO C99 显然支持它们，但在 C++ 和 C 的早期版本中，它们似乎是特定于编译器的扩展。看到这个问题：[Dynamic arrays in C without malloc?](https://stackoverflow.com/questions/6656731/dynamic-arrays-in-c-without-malloc)

我想出了一种人们可能会喜欢 C++ 的方式，因为它的代码少，易于使用内置的静态多维数组，而且速度一样快。

```
template <typename T> 
class Array2D {
private:
    std::unique_ptr<T> managed_array_;
    T* array_;
    size_t x_, y_;

public:
    Array2D(size_t x, size_t y) {
        managed_array_.reset(new T[x * y]);
        array_ = managed_array_.get();
        y_ = y;
    }
    T* operator[](size_t x) const {
        return &array_[x * y_];
    }
}; 
```

你可以像这样使用它。尺寸不

```
auto a = Array2D<int>(x, y);
a[xi][yi] = 42; 
```

您可以添加一个断言，至少除了最后一个维度之外的所有维度，并将这个想法扩展到两个以上的维度。我在我的博客上发表了一篇关于获取多维数组的替代方法的文章。我对那里的相对性能和编码工作也更加具体。

[C++ 中动态多维数组的性能](http://frankriesecodingblog.blogspot.com/2015/01/performance-of-dynamic-multi.html)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-14T17:16:40.407

您可以使用 malloc 来完成此操作，并且仍然可以通过普通的 array[][] 方法访问它，而不是 array[rows * cols + cols] 方法。

```
main()
{
   int i;
   int rows;
   int cols;
   int **array = NULL;

   array = malloc(sizeof(int*) * rows);
   if (array == NULL)
       return 0;  // check for malloc fail

   for (i = 0; i < rows; i++)
   {
       array[i] = malloc(sizeof(int) * cols)
       if (array[i] == NULL)
           return 0;  // check for malloc fail
   }

   // and now you have a dynamically sized array
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2008-12-13T21:43:04.503

在 C++ 中无法确定给定数组的长度。最好的方法可能是传入数组每个维度的长度，并使用它而不是数组本身的 .length 属性。

# c# - 读取 XML 文档时如何使用 XComment？

> ID：365794
> 
> 赞同：5
> 
> 时间：2008-12-13T21:46:46.870
> 
> 标签：c#, linq-to-xml

`<!-- -->`我正在使用以下行来读取一个 XML 文档，该文档在我的 XML 文件顶部附近可能有也可能没有一些用“”括起来的注释：

```
XDocument xe1 = XDocument.Load(filepath) 
```

如何阅读评论并存储为字符串？

我在 MS Visual Studio C# 中执行此操作。

我知道有一个叫做“XComment”的东西，但是我找不到在读取 XML 时使用它的简单示例（我只能找到创建新 XML 文件的示例）。

-阿迪娜

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-13T22:35:08.580

使用此代码段从 XDocument 中获取所有注释：

```
var document = XDocument.Load("test.xml");

var comments =  from node in document.Elements().DescendantNodesAndSelf()
        where node.NodeType == XmlNodeType.Comment
        select node as XComment; 
```

这仅解析顶级评论：

```
var document = XDocument.Load("test.xml");

var comments = from node in document.Nodes()
           where node.NodeType == XmlNodeType.Comment
           select node as XComment; 
```

# iphone - 哪个移动系统适合程序员？

> ID：365795
> 
> 赞同：10
> 
> 时间：2008-12-13T21:48:11.233
> 
> 标签：iphone, android, windows-mobile, blackberry, smartphone

我已经使用我的 Palm Treo 650 几年了。现在我正在考虑在 iPhone、BlackBerry 和 Windows mobile 之间购买新的。看来windows mobile最适合我。因为我有 .NET 开发的经验，而且我认为 .net framework compact 离我的知识不会太远。

除了电话、信息，我还经常用它来查看电子邮件、新闻和互联网。我也对开发有用的小程序非常感兴趣。不过看起来花哨的iphone和用黑莓推送邮件也很爽。

兼顾移动编程和个人使用，对于程序员来说，移动系统的最佳选择是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-13T21:58:25.177

Android 表面上比 iPhone 更“开放”。无线运营商声称不打算干扰 Android 上的开发人员。我们会看到的。

如果您只是想破解，Android 可能会对您更友好。也就是说，您在 Java 沙箱中。

如果你喜欢游戏，我会选择 iPhone，因为它支持 OpenGL ES 和一些非常酷的第三方库，比如 Unity 和 Cocos2d。

所以如果你想让人们看到/使用你的应用程序，现在只有 iPhone。J2ME 和 BREW 等旧系统已成为过去。我不指望他们最多能活几年。

Symbian 在欧洲很受欢迎，但我记得它是 API 的野兽。对我来说，一切都显得格外艰难。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-15T07:11:18.960

Windows Mobile 是迄今为止对开发人员最友好的平台。但是请注意，您需要 Visual Studio 专业版来编写移动应用程序。除此之外，开发应用程序很像为台式机开发。无需签署应用程序、应用程序商店或烦人的安全警告（只有一个警告，当您第一次运行应用程序时）。此外，这些工具处于非常成熟的状态，您可以从一开始就专注于您的应用程序，而不是与复杂的平台作斗争。所以，我会说 Windows Mobile 是业余项目和小规模应用程序的最佳解决方案。

对于大众市场应用（针对消费市场），我认为 iPhone 和黑莓更适合。这些平台似乎拥有更大的份额，最重要的是，这些手机的所有者更有可能为新应用程序付费。

还有 Symbian，特别是诺基亚的 S60，它在当今智能手机中的份额最大。然而，Symbian 以开发者不友好而闻名，而且我还认为 Symbian 手机的所有者不知道/不关心他们可以在他们的设备中安装应用程序。更不用说应用程序需要签名才能运行。

最后是 J2ME。这不再像以前那样受到限制，并且它具有几乎所有可用手机的巨大优势。然而，直到今天它主要用于游戏，因为每个使用敏感 API 的应用程序都需要签名。如果您只对游戏感兴趣，这将是一个很好的解决方案。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-13T21:51:29.963

如果您计划分发您的应用程序（免费或付费），那么 iPhone 平台绝对具有优势。您需要做的就是编写应用程序并提交它，他们负责分发和销售（假设您的应用程序已获得批准）。

Android 平台是另一种选择，它也有一个“市场”，但它更新的更多，可用的手机更少。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-03T19:25:07.937

多年后编辑：我会选择 Ionic。我能找到的最好的跨平台开发平台。

温莫：

*   听说过可怕的事情
*   昂贵的开发环境
*   黑莓对企业来说更常见，这说明了很多

苹果手机：

*   限制性保密协议
*   即使它安全且有用，苹果也可能不会批准您的应用程序（阅读这篇关于某人开发的播客应用程序[被苹果拒绝](http://almerica.blogspot.com/2008/09/podcaster-rejeceted-because-it.html)的文章）
*   目标C伤害了我的眼睛:)
*   100 美元的许可证
*   从好的方面来说，很多人都有这个平台
*   不知道它是否可以免费开发，[我读过](http://www.mikeash.com/?page=pyblog/the-iphone-development-story.html)您必须拥有将应用程序放在手机上的许可证

安卓：

*   免费开发，免费将应用程序放在自己的手机上，25 美元即可获得许可证
*   开发环境其实还不错，而且免费（我用的是Eclipse）
*   更多手机发布，更多运营商加入
*   [三星](http://codingmostly.blogspot.com/2008/12/samsung-android-good.html)手机在路上（我对我拥有的所有 Sammy 手机都很满意）
*   如果您是 C# 开发人员，Java 很容易上手
*   仅当存在安全风险时，您的应用才会从商店中删除
*   付费游戏应用程序即将推出（我听说是 1 月份，但我认为这只是谣言）
*   这可能是第一个拥有 Silverlight 的移动平台

Android是我的胜利。

回复：openmoko freerunner：[Android 版本](http://www.youtube.com/watch?v=m4NbsLmF9j0)即将推出。

编辑：为了一笑，尝试比较“iphone开发恐怖故事”的谷歌结果与Android的相同。没什么可比较的，找不到任何适用于 Android 的恐怖故事。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-13T22:15:21.927

我主要关注 iPhone，因为它是目前技术能力和流行度的最佳组合（我正在考虑将整个 OS X 平台作为其中的一部分——我在 Mac 上的工作很好地补充了 iPhone 和其他潜在的 OS X 平台）。在可预见的未来，Windows Mobile 似乎状况不佳。Android 对那些无法忍受 Apple 的态度和严格控制的人来说更加开放，但老实说，我会等待该平台兑现更多的承诺，然后再花太多时间或金钱在那里。

老实说，我对 iPhone 最感兴趣的部分是使用 Objective-C 和一些非常令人印象深刻的框架（例如 Core Animation）。从我使用 .Net 的经验来看，我只是更喜欢在 Cocoa 中编程。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-13T22:22:17.950

除非我错过了原始问题中的某些内容，否则您不是在询问开发应用程序并分发它们（免费或盈利），而只是开发供您自己使用的实用程序？在这种情况下，我想说免费的电话就是您想要的（像言论一样自由）。我所知道的最开放的是[OpenMoko Neo Freerunner](http://www.openmoko.com)（我拥有一个……它缺乏很多润色，但它是一款功能齐全的手机，潜力几乎无限）。在我的手机上运行 SSH 守护程序和 HTTP 服务器让我很兴奋。其中一款新的谷歌手机也可能是一个不错的选择。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-13T22:05:48.063

如果您已经拥有 .NET CF 经验并且您不担心销售软件，那么我建议这是一个不错的选择，因为 .NET CF 现在非常合理，并且有相当多的不错的工具可供使用。

除了关于 iPhone 的其他帖子，我建议在开发之前阅读 iPhone SDK，你可以通过他们的商店获得很多，但在我阅读之后，我决定我唯一会选择在 iPhone 上做的事情就是 hack它。让我生气的是那个文件....

就美观而言，我会说某些黑莓可以与 iPhone 相媲美，尤其是大胆的，我想他们的 SDK 更宽松。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-13T22:14:02.383

这完全取决于您的应用程序的用途。iPhone 分发机制很棒——只要您有信心让您的应用程序通过 Apple 的验收标准。一旦您编写了应用程序，Windows Mobile 就更难分发 - 但就您可以实现的目标而言，它更加灵活 - 例如，您可以编写位于后台的应用程序，这在 iPhone 上是不可能的。

您可能还想考虑诺基亚 S60，它是一个功能强大的平台，尽管学习曲线非常陡峭。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-13T22:17:56.167

iPhone 可能是最容易分发应用程序的平台，但也是最不开放的（如果 Apple 不批准您的应用程序，那您就完蛋了，除非您只想自己使用它并将其分发给几个朋友）。但是，如果您以前没有使用过 Objective-C 并且您没有任何“C”/C++/Java 背景，那么您的学习曲线可能会非常陡峭。也就是说，我设法在没有任何事先了解 Objective-C 或 MacOS 知识的情况下组装了一个应用程序——一本好书会有所帮助（我使用了实用程序员的 iphone SDK 书——没有这本书，我将无处可去）。

使用 Android 和 Blackberry，可能任何 Java 程序员都可以很快上手。两者都有应用分发渠道，但市场较小。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-13T22:20:49.750

如果您对手机上可用的互联网体验完全感兴趣，请使用 iPhone 或 Android。我将建议您使用 Android，因为您是 Windows 开发人员，因为这可能意味着您没有为 iPhone 开发所需的 mac。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-13T22:02:51.640

开发人员现在唯一赚钱的地方是 iPhone，所以我想说就这样吧。

不过，我不确定您在问题中要问什么。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-01-03T19:04:52.503

无论好坏，作为一名移动开发者，你已经考虑过什么时间投资会带来最好的潜在货币结果（当然，如果这只是作为一种爱好，请忽略以下内容）。

因此，目前我最好的推荐是 iPhone。尽管 Objective-c 可能很麻烦，但接触这么多用户（并为此获得报酬）的能力非常酷。

此外，我会研究黑莓和 Android，但这在很大程度上取决于您想要做什么。如果您的应用具有业务功能，并且您认为可以销售它，那么在这些平台上取得成功的可能性很大。Android 尤其有趣，因为该空间仍在定义中。

# html - 可以将html注释放在标签之外吗？

> ID：365805
> 
> 赞同：15
> 
> 时间：2008-12-13T21:57:54.507
> 
> 标签：html

W3c 验证器并没有提醒我，但我很好奇是否有人对将 html 注释放在 html 标签之外有意见？

```
...
</正文>
</html>
<!-- 再见 -->

```

我有一个应用程序并正在输出一些数据，并希望它绝对是完成的最后一件事，不幸的是，这意味着我已经附加了我的最后一个</html>。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-13T22:02:22.983

我看不出这是一个问题——DTD 中没有指定允许的注释（因为它们对人类有效，而不是对计算机有效）。此外，DOM API ( [http://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html](http://www.w3.org/TR/REC-DOM-Level-1/level-one-core.html) ) 明确允许直接在文档节点下的许多注释（即不是根 HTML 元素，逻辑文档根），因此任何符合要求的浏览器都应该允许它。

这并不是说您不会找到令人窒息的浏览器或工具，尤其是较旧的浏览器或工具。但如果有很多，我会感到惊讶。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-14T01:27:52.290

我不认为 </html> 之后的注释会导致任何问题，但我相信 DOCTYPE 声明之前的注释（因此在 <html> 标记之前）会将 IE6 踢到怪癖模式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T22:01:20.507

任何客户都应该完全忽略评论，因此它们不应该引起任何问题。无论如何，如果验证者没有抱怨，那可能没问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-06T15:15:41.107

仅供参考，如果您使用 AngularJS 并创建`.directive`where`replace`为真，则 HTML 片段中根元素之外的注释将导致 Angular 看到两个根元素并抛出此错误

`Template for directive 'yourDirective' must have exactly one root element.`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-29T20:43:30.493

我有一家在客户网站上工作的 SEO 公司决定将 HTML 注释添加到我的一个 PHP 包含中，该注释位于 HTML 标记之外，并导致 Internet Explorer 出现问题。它导致了我的下拉菜单的一系列格式问题。它为什么会崩溃是没有意义的，但绝对100％是由评论引起的。评论一删，一切恢复正常。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-12-15T01:50:39.933

是的，无论如何。任何渲染引擎（IE、Firefix、Opera、Safari 等）都会完全忽略任何 HTML 注释标记，无论其位置。

# web-standards - 符合标准的网页所需的博客工具

> ID：365817
> 
> 赞同：1
> 
> 时间：2008-12-13T22:04:10.703
> 
> 标签：web-standards, blogs, platform

我认识的一位程序员有一个完全符合标准的网站。它使用 Unicode 编码的完全验证的 XHTML 1.1 和 CSS。这些页面是无框架、无表格和无 JavaScript 的。

他希望被引导到一个博客工具，该工具不需要任何特定的数据库系统或 Web 服务器，但会创建符合上述标准和最佳实践的静态页面，并且它本身就是一个专业完成的原生 Windows 应用程序。

...而且它也应该能够生成 RSS 提要。

有什么东西可以接近这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-14T11:03:26.933

我从来没有听说过一个独立的专业品质的 Windows 应用程序可以充当博客 HTTP 服务器。我认为你最好的选择是[WordPress](http://wordpress.org/)之类的具有良好、符合标准的主题（它们存在）和某种博客更新工具（我知道它们存在，并且 WordPress 支持它们，尽管我只使用[过 Linux 的](http://www.gnome.org/~seth/gnome-blog/)）。

如果您决定不存在满足您要求的单个独立程序，则可能值得研究Windows 应用程序部分的[MetaWeblog 。](http://en.wikipedia.org/wiki/MetaWeblog)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T11:21:33.993

我想知道您为什么不希望它使用数据库，我想不出任何不使用数据库的博客引擎。例如，如果您替换模板中的一件事，它可以防止您更改所有静态文件。

WordPress 可能是最容易设置的，并且可以很好地与桌面 Windows 客户端（例如 Windows Live Writer ( [http://windowslivewriter.spaces.live.com/](http://windowslivewriter.spaces.live.com/) ) 集成）

# jquery - 如何使用 jquery 旋转插件旋转图像？

> ID：365820
> 
> 赞同：10
> 
> 时间：2008-12-13T22:06:47.483
> 
> 标签：jquery, image, rotation, jquery-rotate

如何使用[jQuery-rotate](http://code.google.com/p/jquery-rotate/)插件旋转图像？

我尝试了以下方法，但似乎不起作用：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>View Photo</title>
<script type="text/javascript" src="scripts/jquery.js"></script>
<script type="text/javascript" src="scripts/jquery.rotate.1-1.js"></script>
<script type="text/javascript">
var angle = 0;
setInterval ( function (e) {
    rotate();
}, 100 );
function rotate() {
    angle = angle + 1;
    $('#pic').rotate(angle);
}
</script>
</head>
<body>
<img border="0" src="player.gif" name="pic" id="pic">
</body>
</html> 
```

也需要大多数浏览器支持的其他方法，谢谢！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-13T22:32:13.733

你在 jQuery 和 jQuery 插件上有一个 404。因此，您的页面会引发 JavaScript 错误，即 $ 未定义。

您需要学习基本的 JavaScript 调试技术。快速搜索发现这篇文章看起来是一个不错的起点：

*   [使用 Firebug 进行 JavaScript 调试技术](http://www.developertutorials.com/tutorials/javascript/javascript-debugging-techniques-with-firebug-8-04-20/page1.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-11-10T20:30:10.073

您旋转图像的逻辑是正确的。如果在文档准备好时执行，它将起作用。

```
<script type="text/javascript">
//<![CDATA[
    var angle = 1;

    $(document).ready(function() {
        setInterval(function() {
            $("#pic").rotate(angle);
            /* angle += 1; Increases the rotating speed */
        }, 100);
    });
//]]>
</script> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-08-01T01:02:33.900

修复 jquery 包含问题后，您可以修复脚本。您的语法错误：这是修复：

```
<script type="text/javascript">
//<![CDATA[
    var angle = 1;

    $(document).ready(function(angle) {
        setInterval(function(angle) {
                $("#pic").rotate(angle);
                /* angle += 1; Increases the rotating speed */
        }, 100);
    });
//]]>
</script> 
```

# .net - 带有事件的集合 - 有比 BindingList(of T) 更好的选择吗？

> ID：365821
> 
> 赞同：2
> 
> 时间：2008-12-13T22:07:30.447
> 
> 标签：.net, collections, list

我需要一个可以在添加或删除项目时触发事件的通用集合或列表。

[我发现 BindingList(of T) 有这方面的事件，](http://msdn.microsoft.com/en-us/library/ms132740.aspx)并连接了一个运行良好的快速概念证明。

当然，这感觉不是最受过教育的选择。BindingList 对于我正在做的事情来说太过分了。有没有更简单的集合/列表对象可以做到这一点？

我当然可以自己动手。

**加分点：**当我们谈到它时，您是否知道有任何真正全面的资源详细介绍了所有 .Net 集合类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T22:19:55.600

ObservableCollection(of T) 实现 INotifyCollectionChanged。它会在添加或删除项目时通知您。这与由 BindingList(of T) 实现的 IRaiseItemChangedEvents 接口不同。它应该对你有用。

# c++ - 什么样的面试题适合 C++ 手机屏幕？

> ID：365823
> 
> 赞同：11
> 
> 时间：2008-12-13T22:08:07.090
> 
> 标签：c++

好奇地想了解人们的想法。我经常接受采访，在我的职业生涯中已经有足够的时间来反思它们，我注意到了各种各样的问题。我把这个 c++ 具体化了，但值得注意的是，有人通过电话问我算法复杂性问题，我什至不是说哈希查找与二叉树的复杂性是什么，我的意思更像是分析问题，例如“想象有 4 只大黄蜂，每只都在嗡嗡作响 bla bla bla”。

现在我个人更喜欢让电话屏幕更具体一些，而将抽象的问题留给白板。那么在进行 c++ 电话面试时，你会涵盖什么样的主题，尤其是针对高级开发人员？

我知道还有另一个与此类似的线程，但坦率地说，它似乎完全忽略了这是关于电话屏幕的重点，而不是面对面的采访。另外，这更特定于 c++。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-12-13T22:28:21.700

我会询问资源/内存管理，因为它是 C++ 中的一个重要主题，并且不需要具体的代码。只需勾画一个简单的假设场景，并询问他们如何确保即使面对错误/异常也能释放一些重要资源。假设他们正在开发一个网络应用程序，他们如何确保我们正确关闭我们的套接字？当然，正确的答案是将它包装在一个 RAII 对象中，但不要直接问他们（谷歌“RAII”很容易，而上面的问题“你如何确保资源得到正确释放”实际上显示了你是否或者他们不知道适当的技术。如果他们回答“用 try/catch 包装所有内容”，他们可能会遇到问题。这与关于堆和堆栈之间差异的问题很好地联系在一起。

您也可以提出一些关于异常安全的简单问题，这不需要任何实际代码。一般来说，我会说讨论所有各种 C++ 习语可能是一个好主意，因为它们中的许多不需要太多实际代码，但仍然是重要的特定于语言的概念。

看看他们是否知道智能指针（最好再给他们一个需要智能指针的情况，看看他们将如何解决问题），也许模板/元程序（在后一种情况下，可能只是找出他们是否'请注意这是可能的，而不是要求他们在手机上编写实际的元程序）

您可能还想询问一些未定义行为的常见区域（执行后 a 和 b 的值是`a = b++ + b++?`多少？），或者分配一个包含 10 个元素的数组，并将 10 或 11 加到数组指针上，并询问结果如何在每种情况下都是（+=10 是合法的，给你一个过去的指针，+=11 是未定义的）。或者给他们一个他们需要复制大量对象的场景，并询问他们如何做到这一点（简单的 for 循环一次复制每个元素，memcpy 或 std::copy 是显而易见的答案。注意 memcpy 的注意事项，对于非 POD 对象不安全）

或者询问他们的一般编码风格。他们如何看待迭代器？他们更喜欢普通的旧 for 循环吗？他们知道如何使用 std::for_each 或 std::transform 吗？

*编辑：* 似乎`a = b++ + b++`（答案是未定义的行为，顺便说一句）建议特别产生了很多评论。也许人们对它读得太多了。正如OP所说，他更喜欢问*具体的*（不是抽象的，并且易于通过电话解释/回答/讨论）问题，这将揭示一些关于受访者的 C++ 技能，这是一个简单的（是的，也许是挑剔的）示例。其背后的原因是 1）它具有直观的含义，这是错误的，以及 2）您必须对 C++ 有一定的经验才能意识到这一点。当然还有 3)，通过电话询问很简短。它不需要任何人写下代码。不，它不会透露候选人是否是“伟大的程序员”，但据我理解这个问题，这也不是目标。如果有人弄错了，那根本没有什么意义，但如果他们弄对了，你可以相当肯定他们懂一点 C++。但如果你再读一遍我的回答，你' 我会看到这只是我认为应该代表的一类问题的一个简单示例。C++ 充满了未定义的行为，即使在看起来完全无害且直观的代码中也是如此。要求候选人承认*这种情况的某些*例子可能很有用，无论是上面的“在同一个表达式中修改同一个变量两次”的例子，还是不同的例子。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-13T22:18:00.877

我想知道人们是否真的了解他们正在使用的工具。而且我还发现“高级”开发人员的知识可能存在严重差距。

你可以考虑问

*   什么是 vtable。
*   模板的工作原理
*   堆和栈的区别是什么。对此的回复的深度可能非常有启发性！

最后一个问题的“你真的需要采访我”的答案将涵盖

*   分配 - 限制、用例、故障模式、效率、资源清理、析构函数
*   stack call-frames - 调用函数时会发生什么，参数，回溯

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-08T15:10:51.357

作为 C++ 职位的电话屏幕的一部分，我已经开始询问“谁是 Bjarne Stroustrup”。

我发现许多自称是高级 C++ 开发人员的人都无法识别，这让我感到很惊讶。给说英语的人的提示：在你问问题之前，去他的常见问题解答并听正确的发音。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-14T08:40:09.577

*   设计模式
*   C/C++基础
*   虚函数
*   多态性
*   Scott Mayer 系列的概念
*   关于模板。（排名不分先后）

最后但是同样重要的。我将给出一些示例问题，我告诉他们设计课程。只是接口。

# math - 计算2个GPS坐标之间的距离

> ID：365826
> 
> 赞同：422
> 
> 时间：2008-12-13T22:12:33.697
> 
> 标签：math, geolocation, geometry, latitude-longitude, geography

如何计算两个 GPS 坐标之间的距离（使用纬度和经度）？

* * *

## 回答 #1

> 赞同：484
> 
> 时间：2008-12-13T22:22:42.897

[通过 latitude 和 longitude 计算两个坐标之间的距离](http://www.movable-type.co.uk/scripts/latlong.html)，包括 Javascript 实现。

*西部*和*南部*的位置是负面的。记住分钟和秒都在 60 以内，所以 S31 30' 是 -31.50 度。

不要忘记*将度数转换为弧度*。很多语言都有这个功能。或者它是一个简单的计算：`radians = degrees * PI / 180`。

```
function degreesToRadians(degrees) {
  return degrees * Math.PI / 180;
}

function distanceInKmBetweenEarthCoordinates(lat1, lon1, lat2, lon2) {
  var earthRadiusKm = 6371;

  var dLat = degreesToRadians(lat2-lat1);
  var dLon = degreesToRadians(lon2-lon1);

  lat1 = degreesToRadians(lat1);
  lat2 = degreesToRadians(lat2);

  var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
          Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2); 
  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
  return earthRadiusKm * c;
} 
```

以下是一些使用示例：

```
distanceInKmBetweenEarthCoordinates(0,0,0,0)  // Distance between same 
                                              // points should be 0
0

distanceInKmBetweenEarthCoordinates(51.5, 0, 38.8, -77.1) // From London
                                                          // to Arlington
5918.185064088764 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2009-09-13T05:46:03.123

用谷歌寻找haversine；这是我的解决方案：

```
#include <math.h>
#include "haversine.h"

#define d2r (M_PI / 180.0)

//calculate haversine distance for linear distance
double haversine_km(double lat1, double long1, double lat2, double long2)
{
    double dlong = (long2 - long1) * d2r;
    double dlat = (lat2 - lat1) * d2r;
    double a = pow(sin(dlat/2.0), 2) + cos(lat1*d2r) * cos(lat2*d2r) * pow(sin(dlong/2.0), 2);
    double c = 2 * atan2(sqrt(a), sqrt(1-a));
    double d = 6367 * c;

    return d;
}

double haversine_mi(double lat1, double long1, double lat2, double long2)
{
    double dlong = (long2 - long1) * d2r;
    double dlat = (lat2 - lat1) * d2r;
    double a = pow(sin(dlat/2.0), 2) + cos(lat1*d2r) * cos(lat2*d2r) * pow(sin(dlong/2.0), 2);
    double c = 2 * atan2(sqrt(a), sqrt(1-a));
    double d = 3956 * c; 

    return d;
} 
```

* * *

## 回答 #3

> 赞同：46
> 
> 时间：2011-09-29T10:27:18.340

Haversine 的 C# 版本

```
double _eQuatorialEarthRadius = 6378.1370D;
double _d2r = (Math.PI / 180D);

private int HaversineInM(double lat1, double long1, double lat2, double long2)
{
    return (int)(1000D * HaversineInKM(lat1, long1, lat2, long2));
}

private double HaversineInKM(double lat1, double long1, double lat2, double long2)
{
    double dlong = (long2 - long1) * _d2r;
    double dlat = (lat2 - lat1) * _d2r;
    double a = Math.Pow(Math.Sin(dlat / 2D), 2D) + Math.Cos(lat1 * _d2r) * Math.Cos(lat2 * _d2r) * Math.Pow(Math.Sin(dlong / 2D), 2D);
    double c = 2D * Math.Atan2(Math.Sqrt(a), Math.Sqrt(1D - a));
    double d = _eQuatorialEarthRadius * c;

    return d;
} 
```

[这是 this 的 .NET Fiddle](https://dotnetfiddle.net/d8pgsp)，因此您可以使用自己的 Lat/Longs 对其进行测试。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2013-01-22T13:30:29.873

Java版本的Haversine算法基于Roman Makarov对该线程的回复

```
public class HaversineAlgorithm {

    static final double _eQuatorialEarthRadius = 6378.1370D;
    static final double _d2r = (Math.PI / 180D);

    public static int HaversineInM(double lat1, double long1, double lat2, double long2) {
        return (int) (1000D * HaversineInKM(lat1, long1, lat2, long2));
    }

    public static double HaversineInKM(double lat1, double long1, double lat2, double long2) {
        double dlong = (long2 - long1) * _d2r;
        double dlat = (lat2 - lat1) * _d2r;
        double a = Math.pow(Math.sin(dlat / 2D), 2D) + Math.cos(lat1 * _d2r) * Math.cos(lat2 * _d2r)
                * Math.pow(Math.sin(dlong / 2D), 2D);
        double c = 2D * Math.atan2(Math.sqrt(a), Math.sqrt(1D - a));
        double d = _eQuatorialEarthRadius * c;

        return d;
    }

} 
```

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-02-01T17:38:32.707

这在 SQL Server 2008 中使用地理类型很容易做到。

```
SELECT geography::Point(lat1, lon1, 4326).STDistance(geography::Point(lat2, lon2, 4326))
-- computes distance in meters using eliptical model, accurate to the mm 
```

4326 是 WGS84 椭球地球模型的 SRID

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2013-08-09T10:21:46.457

这是我使用的 Python 中的 Haversine 函数：

```
from math import pi,sqrt,sin,cos,atan2

def haversine(pos1, pos2):
    lat1 = float(pos1['lat'])
    long1 = float(pos1['long'])
    lat2 = float(pos2['lat'])
    long2 = float(pos2['long'])

    degree_to_rad = float(pi / 180.0)

    d_lat = (lat2 - lat1) * degree_to_rad
    d_long = (long2 - long1) * degree_to_rad

    a = pow(sin(d_lat / 2), 2) + cos(lat1 * degree_to_rad) * cos(lat2 * degree_to_rad) * pow(sin(d_long / 2), 2)
    c = 2 * atan2(sqrt(a), sqrt(1 - a))
    km = 6367 * c
    mi = 3956 * c

    return {"km":km, "miles":mi} 
```

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2015-12-27T23:46:17.587

我需要为我的项目计算很多点之间的距离，所以我继续尝试优化代码，我在这里找到了。平均而言，在不同的浏览器中，我的新实现的运行速度比最受好评的答案**快 2 倍。**

```
function distance(lat1, lon1, lat2, lon2) {
  var p = 0.017453292519943295;    // Math.PI / 180
  var c = Math.cos;
  var a = 0.5 - c((lat2 - lat1) * p)/2 + 
          c(lat1 * p) * c(lat2 * p) * 
          (1 - c((lon2 - lon1) * p))/2;

  return 12742 * Math.asin(Math.sqrt(a)); // 2 * R; R = 6371 km
} 
```

您可以使用我的 jsPerf 并在[此处查看结果](http://jsperf.com/haversine-salvador/8)。

最近我需要在 python 中做同样的事情，所以这里是一个**python 实现**：

```
from math import cos, asin, sqrt
def distance(lat1, lon1, lat2, lon2):
    p = 0.017453292519943295
    a = 0.5 - cos((lat2 - lat1) * p)/2 + cos(lat1 * p) * cos(lat2 * p) * (1 - cos((lon2 - lon1) * p)) / 2
    return 12742 * asin(sqrt(a)) 
```

为了完整起见：维基上的[Haversine](https://en.wikipedia.org/wiki/Haversine_formula)。

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2008-12-13T22:28:50.467

这取决于您需要它有多准确。如果您需要精确度，最好查看使用椭球体而不是球体[的算法，例如 Vincenty 算法](http://en.wikipedia.org/wiki/Vincenty%27s_algorithm)，精确到毫米。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2010-05-27T15:42:38.510

这是在 C# 中（以弧度表示的纬度和经度）：

```
double CalculateGreatCircleDistance(double lat1, double long1, double lat2, double long2, double radius)
{
    return radius * Math.Acos(
        Math.Sin(lat1) * Math.Sin(lat2)
        + Math.Cos(lat1) * Math.Cos(lat2) * Math.Cos(long2 - long1));
} 
```

如果您的纬度和经度以度为单位，则除以 180/PI 以转换为弧度。

* * *

## 回答 #10

> 赞同：11
> 
> 时间：2015-01-29T10:38:45.113

PHP版本：

`deg2rad()`（如果您的坐标已经以弧度表示，请删除所有内容。）

```
$R = 6371; // km
$dLat = deg2rad($lat2-$lat1);
$dLon = deg2rad($lon2-$lon1);
$lat1 = deg2rad($lat1);
$lat2 = deg2rad($lat2);

$a = sin($dLat/2) * sin($dLat/2) +
     sin($dLon/2) * sin($dLon/2) * cos($lat1) * cos($lat2); 

$c = 2 * atan2(sqrt($a), sqrt(1-$a)); 
$d = $R * $c; 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2011-07-13T12:43:37.867

一个 T-SQL 函数，我用它来按中心的距离选择记录

```
Create Function  [dbo].[DistanceInMiles] 
 (  @fromLatitude float ,
    @fromLongitude float ,
    @toLatitude float, 
    @toLongitude float
  )
   returns float
AS 
BEGIN
declare @distance float

select @distance = cast((3963 * ACOS(round(COS(RADIANS(90-@fromLatitude))*COS(RADIANS(90-@toLatitude))+ 
SIN(RADIANS(90-@fromLatitude))*SIN(RADIANS(90-@toLatitude))*COS(RADIANS(@fromLongitude-@toLongitude)),15)) 
)as float) 
  return  round(@distance,1)
END 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2014-01-21T15:36:20.103

**一、关于“面包屑”方法**

1.  不同纬度的地球半径不同。在 Haversine 算法中必须考虑到这一点。
2.  考虑更换轴承，将直线变成拱形（更长）
3.  考虑速度变化会将拱形变成螺旋形（比拱形更长或更短）
4.  高度变化会将平面螺旋变成 3D 螺旋（再次变长）。这对于丘陵地区非常重要。

下面看C中的函数，它考虑了#1和#2：

```
double   calcDistanceByHaversine(double rLat1, double rLon1, double rHeading1,
       double rLat2, double rLon2, double rHeading2){
  double rDLatRad = 0.0;
  double rDLonRad = 0.0;
  double rLat1Rad = 0.0;
  double rLat2Rad = 0.0;
  double a = 0.0;
  double c = 0.0;
  double rResult = 0.0;
  double rEarthRadius = 0.0;
  double rDHeading = 0.0;
  double rDHeadingRad = 0.0;

  if ((rLat1 < -90.0) || (rLat1 > 90.0) || (rLat2 < -90.0) || (rLat2 > 90.0)
              || (rLon1 < -180.0) || (rLon1 > 180.0) || (rLon2 < -180.0)
              || (rLon2 > 180.0)) {
        return -1;
  };

  rDLatRad = (rLat2 - rLat1) * DEGREE_TO_RADIANS;
  rDLonRad = (rLon2 - rLon1) * DEGREE_TO_RADIANS;
  rLat1Rad = rLat1 * DEGREE_TO_RADIANS;
  rLat2Rad = rLat2 * DEGREE_TO_RADIANS;

  a = sin(rDLatRad / 2) * sin(rDLatRad / 2) + sin(rDLonRad / 2) * sin(
              rDLonRad / 2) * cos(rLat1Rad) * cos(rLat2Rad);

  if (a == 0.0) {
        return 0.0;
  }

  c = 2 * atan2(sqrt(a), sqrt(1 - a));
  rEarthRadius = 6378.1370 - (21.3847 * 90.0 / ((fabs(rLat1) + fabs(rLat2))
              / 2.0));
  rResult = rEarthRadius * c;

  // Chord to Arc Correction based on Heading changes. Important for routes with many turns and U-turns

  if ((rHeading1 >= 0.0) && (rHeading1 < 360.0) && (rHeading2 >= 0.0)
              && (rHeading2 < 360.0)) {
        rDHeading = fabs(rHeading1 - rHeading2);
        if (rDHeading > 180.0) {
              rDHeading -= 180.0;
        }
        rDHeadingRad = rDHeading * DEGREE_TO_RADIANS;
        if (rDHeading > 5.0) {
              rResult = rResult * (rDHeadingRad / (2.0 * sin(rDHeadingRad / 2)));
        } else {
              rResult = rResult / cos(rDHeadingRad);
        }
  }
  return rResult;
} 
```

**二、有一种更简单的方法可以提供很好的结果。**

按平均速度。

Trip_distance = Trip_average_speed * Trip_time

由于 GPS 速度是由多普勒效应检测的，并且与 [Lon,Lat] 没有直接关系，因此如果不是主要的距离计算方法，它至少可以被视为次要（备份或校正）。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-08-22T15:35:57.857

如果您需要更准确的内容，[请查看此](http://en.wikipedia.org/wiki/Vincenty%27s_formulae)内容。

> Vincenty 公式是大地测量学中用于计算球体表面上两点之间距离的两种相关迭代方法，由 Thaddeus Vincenty (1975a) 开发。它们基于地球图形是扁球体的假设，因此比假设球形地球的大圆距离等方法更准确。
> 
> 第一种（直接）方法计算一个点的位置，该点是与另一个点的给定距离和方位角（方向）。第二种（逆）方法计算两个给定点之间的地理距离和方位角。它们已广泛用于大地测量学，因为它们在地球椭球体上的精度在 0.5 毫米（0.020 英寸）以内。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2017-01-19T18:11:18.693

如果您使用的是 .NET，请不要重蹈覆辙。请参阅[System.Device.Location](https://msdn.microsoft.com/en-us/library/system.device.location.geocoordinate.getdistanceto%28v=vs.110%29.aspx)。[在另一个答案](https://stackoverflow.com/a/7595937/224976)的评论中感谢 fnx 。

```
using System.Device.Location;

double lat1 = 45.421527862548828D;
double long1 = -75.697189331054688D;
double lat2 = 53.64135D;
double long2 = -113.59273D;

GeoCoordinate geo1 = new GeoCoordinate(lat1, long1);
GeoCoordinate geo2 = new GeoCoordinate(lat2, long2);

double distance = geo1.GetDistanceTo(geo2); 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2012-07-11T09:30:24.160

这是适用于 MySQL 和 Kilometers 的“Henry Vilinskiy”版本：

```
CREATE FUNCTION `CalculateDistanceInKm`(
  fromLatitude float,
  fromLongitude float,
  toLatitude float, 
  toLongitude float
) RETURNS float
BEGIN
  declare distance float;

  select 
    6367 * ACOS(
            round(
              COS(RADIANS(90-fromLatitude)) *
                COS(RADIANS(90-toLatitude)) +
                SIN(RADIANS(90-fromLatitude)) *
                SIN(RADIANS(90-toLatitude)) *
                COS(RADIANS(fromLongitude-toLongitude))
              ,15)
            )
    into distance;

  return  round(distance,3);
END; 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2017-08-14T08:26:04.983

这是答案中的 Swift 实现

```
func degreesToRadians(degrees: Double) -> Double {
    return degrees * Double.pi / 180
}

func distanceInKmBetweenEarthCoordinates(lat1: Double, lon1: Double, lat2: Double, lon2: Double) -> Double {

    let earthRadiusKm: Double = 6371

    let dLat = degreesToRadians(degrees: lat2 - lat1)
    let dLon = degreesToRadians(degrees: lon2 - lon1)

    let lat1 = degreesToRadians(degrees: lat1)
    let lat2 = degreesToRadians(degrees: lat2)

    let a = sin(dLat/2) * sin(dLat/2) +
    sin(dLon/2) * sin(dLon/2) * cos(lat1) * cos(lat2)
    let c = 2 * atan2(sqrt(a), sqrt(1 - a))
    return earthRadiusKm * c
} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2008-12-13T22:26:04.357

此 Lua 代码改编自 Wikipedia 和 Robert Lipe 的[GPSbabel](http://www.gpsbabel.org/)工具中的内容：

```
local EARTH_RAD = 6378137.0 
  -- earth's radius in meters (official geoid datum, not 20,000km / pi)

local radmiles = EARTH_RAD*100.0/2.54/12.0/5280.0;
  -- earth's radius in miles

local multipliers = {
  radians = 1, miles = radmiles, mi = radmiles, feet = radmiles * 5280,
  meters = EARTH_RAD, m = EARTH_RAD, km = EARTH_RAD / 1000, 
  degrees = 360 / (2 * math.pi), min = 60 * 360 / (2 * math.pi)
}

function gcdist(pt1, pt2, units) -- return distance in radians or given units
  --- this formula works best for points close together or antipodal
  --- rounding error strikes when distance is one-quarter Earth's circumference
  --- (ref: wikipedia Great-circle distance)
  if not pt1.radians then pt1 = rad(pt1) end
  if not pt2.radians then pt2 = rad(pt2) end
  local sdlat = sin((pt1.lat - pt2.lat) / 2.0);
  local sdlon = sin((pt1.lon - pt2.lon) / 2.0);
  local res = sqrt(sdlat * sdlat + cos(pt1.lat) * cos(pt2.lat) * sdlon * sdlon);
  res = res > 1 and 1 or res < -1 and -1 or res
  res = 2 * asin(res);
  if units then return res * assert(multipliers[units])
  else return res
  end
end 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2011-07-22T11:53:16.693

```
 private double deg2rad(double deg)
    {
        return (deg * Math.PI / 180.0);
    }

    private double rad2deg(double rad)
    {
        return (rad / Math.PI * 180.0);
    }

    private double GetDistance(double lat1, double lon1, double lat2, double lon2)
    {
        //code for Distance in Kilo Meter
        double theta = lon1 - lon2;
        double dist = Math.Sin(deg2rad(lat1)) * Math.Sin(deg2rad(lat2)) + Math.Cos(deg2rad(lat1)) * Math.Cos(deg2rad(lat2)) * Math.Cos(deg2rad(theta));
        dist = Math.Abs(Math.Round(rad2deg(Math.Acos(dist)) * 60 * 1.1515 * 1.609344 * 1000, 0));
        return (dist);
    }

    private double GetDirection(double lat1, double lon1, double lat2, double lon2)
    {
        //code for Direction in Degrees
        double dlat = deg2rad(lat1) - deg2rad(lat2);
        double dlon = deg2rad(lon1) - deg2rad(lon2);
        double y = Math.Sin(dlon) * Math.Cos(lat2);
        double x = Math.Cos(deg2rad(lat1)) * Math.Sin(deg2rad(lat2)) - Math.Sin(deg2rad(lat1)) * Math.Cos(deg2rad(lat2)) * Math.Cos(dlon);
        double direct = Math.Round(rad2deg(Math.Atan2(y, x)), 0);
        if (direct < 0)
            direct = direct + 360;
        return (direct);
    }

    private double GetSpeed(double lat1, double lon1, double lat2, double lon2, DateTime CurTime, DateTime PrevTime)
    {
        //code for speed in Kilo Meter/Hour
        TimeSpan TimeDifference = CurTime.Subtract(PrevTime);
        double TimeDifferenceInSeconds = Math.Round(TimeDifference.TotalSeconds, 0);
        double theta = lon1 - lon2;
        double dist = Math.Sin(deg2rad(lat1)) * Math.Sin(deg2rad(lat2)) + Math.Cos(deg2rad(lat1)) * Math.Cos(deg2rad(lat2)) * Math.Cos(deg2rad(theta));
        dist = rad2deg(Math.Acos(dist)) * 60 * 1.1515 * 1.609344;
        double Speed = Math.Abs(Math.Round((dist / Math.Abs(TimeDifferenceInSeconds)) * 60 * 60, 0));
        return (Speed);
    }

    private double GetDuration(DateTime CurTime, DateTime PrevTime)
    {
        //code for speed in Kilo Meter/Hour
        TimeSpan TimeDifference = CurTime.Subtract(PrevTime);
        double TimeDifferenceInSeconds = Math.Abs(Math.Round(TimeDifference.TotalSeconds, 0));
        return (TimeDifferenceInSeconds);
    } 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2018-01-13T21:25:58.517

我选择了最佳答案并将其用于 Scala 程序

```
import java.lang.Math.{atan2, cos, sin, sqrt}

def latLonDistance(lat1: Double, lon1: Double)(lat2: Double, lon2: Double): Double = {
    val earthRadiusKm = 6371
    val dLat = (lat2 - lat1).toRadians
    val dLon = (lon2 - lon1).toRadians
    val latRad1 = lat1.toRadians
    val latRad2 = lat2.toRadians

    val a = sin(dLat / 2) * sin(dLat / 2) + sin(dLon / 2) * sin(dLon / 2) * cos(latRad1) * cos(latRad2)
    val c = 2 * atan2(sqrt(a), sqrt(1 - a))
    earthRadiusKm * c
} 
```

我对函数进行了柯里化，以便能够轻松地生成两个位置中的一个*固定*的函数，并且只需要一对纬度/经度来产生距离。

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2020-05-24T18:54:34.633

这是一个 Kotlin 变体：

```
import kotlin.math.*

class HaversineAlgorithm {

    companion object {
        private const val MEAN_EARTH_RADIUS = 6371.008
        private const val D2R = Math.PI / 180.0
    }

    private fun haversineInKm(lat1: Double, lon1: Double, lat2: Double, lon2: Double): Double {
        val lonDiff = (lon2 - lon1) * D2R
        val latDiff = (lat2 - lat1) * D2R
        val latSin = sin(latDiff / 2.0)
        val lonSin = sin(lonDiff / 2.0)
        val a = latSin * latSin + (cos(lat1 * D2R) * cos(lat2 * D2R) * lonSin * lonSin)
        val c = 2.0 * atan2(sqrt(a), sqrt(1.0 - a))
        return MEAN_EARTH_RADIUS * c
    }
} 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2008-12-13T22:17:00.363

我猜你想要它沿着地球的曲率。你的两个点和地球的中心在一个平面上。地球的中心是那个平面上一个圆的中心，两个点（大致）在那个圆的周长上。从中，您可以通过找出从一个点到另一个点的角度来计算距离。

如果这些点的高度不同，或者如果你需要考虑到地球不是一个完美的球体，那就有点困难了。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2011-08-22T15:40:03.237

你可以在[fssnip上的](http://fssnip.net/4a)**F#**中找到这个的实现（有一些很好的解释）

以下是重要部分：

```
 let GreatCircleDistance<[<Measure>] 'u> (R : float<'u>) (p1 : Location) (p2 : Location) =
    let degToRad (x : float<deg>) = System.Math.PI * x / 180.0<deg/rad>

    let sq x = x * x
    // take the sin of the half and square the result
    let sinSqHf (a : float<rad>) = (System.Math.Sin >> sq) (a / 2.0<rad>)
    let cos (a : float<deg>) = System.Math.Cos (degToRad a / 1.0<rad>)

    let dLat = (p2.Latitude - p1.Latitude) |> degToRad
    let dLon = (p2.Longitude - p1.Longitude) |> degToRad

    let a = sinSqHf dLat + cos p1.Latitude * cos p2.Latitude * sinSqHf dLon
    let c = 2.0 * System.Math.Atan2(System.Math.Sqrt(a), System.Math.Sqrt(1.0-a))

    R * c 
```

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2012-10-25T13:05:53.750

我需要在 PowerShell 中实现它，希望它可以帮助其他人。关于此方法的一些注意事项

1.  不要拆分任何行，否则计算会出错
2.  要以 KM 计算，请删除 $distance 计算中的 * 1000
3.  更改 $earthsRadius = 3963.19059 并在 $distance 的计算中删除 * 1000 以计算以英里为单位的距离
4.  我正在使用 Haversine，因为其他帖子指出文森蒂的公式要准确得多

    ```
    Function MetresDistanceBetweenTwoGPSCoordinates($latitude1, $longitude1, $latitude2, $longitude2)  
    {  
      $Rad = ([math]::PI / 180);  

      $earthsRadius = 6378.1370 # Earth's Radius in KM  
      $dLat = ($latitude2 - $latitude1) * $Rad  
      $dLon = ($longitude2 - $longitude1) * $Rad  
      $latitude1 = $latitude1 * $Rad  
      $latitude2 = $latitude2 * $Rad  

      $a = [math]::Sin($dLat / 2) * [math]::Sin($dLat / 2) + [math]::Sin($dLon / 2) * [math]::Sin($dLon / 2) * [math]::Cos($latitude1) * [math]::Cos($latitude2)  
      $c = 2 * [math]::ATan2([math]::Sqrt($a), [math]::Sqrt(1-$a))  

      $distance = [math]::Round($earthsRadius * $c * 1000, 0) #Multiple by 1000 to get metres  

      Return $distance  
    } 
    ```

* * *

## 回答 #24

> 赞同：2
> 
> 时间：2014-12-21T14:18:19.543

斯卡拉版本

```
 def deg2rad(deg: Double) = deg * Math.PI / 180.0

  def rad2deg(rad: Double) = rad / Math.PI * 180.0

  def getDistanceMeters(lat1: Double, lon1: Double, lat2: Double, lon2: Double) = {
    val theta = lon1 - lon2
    val dist = Math.sin(deg2rad(lat1)) * Math.sin(deg2rad(lat2)) + Math.cos(deg2rad(lat1)) *
      Math.cos(deg2rad(lat2)) * Math.cos(deg2rad(theta))
    Math.abs(
      Math.round(
        rad2deg(Math.acos(dist)) * 60 * 1.1515 * 1.609344 * 1000)
    )
  } 
```

* * *

## 回答 #25

> 赞同：2
> 
> 时间：2018-11-02T08:20:27.060

这是我在 Elixir 中的实现

```
defmodule Geo do
  @earth_radius_km 6371
  @earth_radius_sm 3958.748
  @earth_radius_nm 3440.065
  @feet_per_sm 5280

  @d2r :math.pi / 180

  def deg_to_rad(deg), do: deg * @d2r

  def great_circle_distance(p1, p2, :km), do: haversine(p1, p2) * @earth_radius_km
  def great_circle_distance(p1, p2, :sm), do: haversine(p1, p2) * @earth_radius_sm
  def great_circle_distance(p1, p2, :nm), do: haversine(p1, p2) * @earth_radius_nm
  def great_circle_distance(p1, p2, :m), do: great_circle_distance(p1, p2, :km) * 1000
  def great_circle_distance(p1, p2, :ft), do: great_circle_distance(p1, p2, :sm) * @feet_per_sm

  @doc """
  Calculate the [Haversine](https://en.wikipedia.org/wiki/Haversine_formula)
  distance between two coordinates. Result is in radians. This result can be
  multiplied by the sphere's radius in any unit to get the distance in that unit.
  For example, multiple the result of this function by the Earth's radius in
  kilometres and you get the distance between the two given points in kilometres.
  """
  def haversine({lat1, lon1}, {lat2, lon2}) do
    dlat = deg_to_rad(lat2 - lat1)
    dlon = deg_to_rad(lon2 - lon1)

    radlat1 = deg_to_rad(lat1)
    radlat2 = deg_to_rad(lat2)

    a = :math.pow(:math.sin(dlat / 2), 2) +
        :math.pow(:math.sin(dlon / 2), 2) *
        :math.cos(radlat1) * :math.cos(radlat2)

    2 * :math.atan2(:math.sqrt(a), :math.sqrt(1 - a))
  end
end 
```

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2019-06-07T19:02:07.783

**飞镖版**

**半正弦算法。**

```
import 'dart:math';

class GeoUtils {

  static double _degreesToRadians(degrees) {
    return degrees * pi / 180;
  }

  static double distanceInKmBetweenEarthCoordinates(lat1, lon1, lat2, lon2) {
    var earthRadiusKm = 6371;

    var dLat = _degreesToRadians(lat2-lat1);
    var dLon = _degreesToRadians(lon2-lon1);

    lat1 = _degreesToRadians(lat1);
    lat2 = _degreesToRadians(lat2);

    var a = sin(dLat/2) * sin(dLat/2) +
        sin(dLon/2) * sin(dLon/2) * cos(lat1) * cos(lat2);
    var c = 2 * atan2(sqrt(a), sqrt(1-a));
    return earthRadiusKm * c;
  }
} 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2021-06-30T13:33:11.553

在 Python 中，您可以使用 geopy 库使用 WGS84 椭球计算测地线距离：

```
from geopy.distance import geodesic
newport_ri = (41.49008, -71.312796)
cleveland_oh = (41.499498, -81.695391)
print(geodesic(newport_ri, cleveland_oh).km) 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2020-04-06T11:32:17.480

我认为**R**中的算法版本仍然缺失：

```
gpsdistance<-function(lat1,lon1,lat2,lon2){

# internal function to change deg to rad

degreesToRadians<- function (degrees) {
return (degrees * pi / 180)
}

R<-6371e3  #radius of Earth in meters

phi1<-degreesToRadians(lat1) # latitude 1
phi2<-degreesToRadians(lat2) # latitude 2
lambda1<-degreesToRadians(lon1) # longitude 1
lambda2<-degreesToRadians(lon2) # longitude 2

delta_phi<-phi1-phi2 # latitude-distance
delta_lambda<-lambda1-lambda2 # longitude-distance

a<-sin(delta_phi/2)*sin(delta_phi/2)+
cos(phi1)*cos(phi2)*sin(delta_lambda/2)*
sin(delta_lambda/2)

cc<-2*atan2(sqrt(a),sqrt(1-a))

distance<- R * cc

return(distance)  # in meters
} 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2021-03-03T19:16:14.080

**对于java**

```
public static double degreesToRadians(double degrees) {
    return degrees * Math.PI / 180;
}

public static double distanceInKmBetweenEarthCoordinates(Location location1, Location location2) {
    double earthRadiusKm = 6371;

    double dLat = degreesToRadians(location2.getLatitude()-location1.getLatitude());
    double dLon = degreesToRadians(location2.getLongitude()-location1.getLongitude());

    double lat1 = degreesToRadians(location1.getLatitude());
    double lat2 = degreesToRadians(location2.getLatitude());

    double a = Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2);
    double c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    return earthRadiusKm * c;
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2021-04-08T13:01:05.103

对于任何搜索 Delphi/Pascal 版本的人：

```
function GreatCircleDistance(const Lat1, Long1, Lat2, Long2: Double): Double;
var
  Lat1Rad, Long1Rad, Lat2Rad, Long2Rad: Double;
const
  EARTH_RADIUS_KM = 6378;
begin
  Lat1Rad  := DegToRad(Lat1);
  Long1Rad := DegToRad(Long1);
  Lat2Rad  := DegToRad(Lat2);
  Long2Rad := DegToRad(Long2);
  Result   := EARTH_RADIUS_KM * ArcCos(Cos(Lat1Rad) * Cos(Lat2Rad) * Cos(Long1Rad - Long2Rad) + Sin(Lat1Rad) * Sin(Lat2Rad));
end; 
```

我不相信这段代码，我最初发现它是由 Gary William 在公共论坛上发布的。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2021-11-12T15:16:40.683

统一版本 C#

半正弦算法。

```
public float Distance(float lat1, float lon1, float lat2, float lon2)
{
    var earthRadiusKm = 6371;

    var dLat = (lat2 - lat1) * Mathf.Rad2Deg;
    var dLon = (lon2 - lon1) * Mathf.Rad2Deg;

    var a = Mathf.Sin(dLat / 2) * Mathf.Sin(dLat / 2) +
            Mathf.Sin(dLon / 2) * Mathf.Sin(dLon / 2) * 
            Mathf.Cos(lat1 * Mathf.Rad2Deg) * Mathf.Cos(lat2 * Mathf.Rad2Deg);

    var c = 2 * Mathf.Atan2(Mathf.Sqrt(a), Mathf.Sqrt(1 - a));
    return earthRadiusKm * c;
} 
```

# linux - 如何为 Windows 应用程序制作一个简单的基于 Wine 的安装程序

> ID：365841
> 
> 赞同：4
> 
> 时间：2008-12-13T22:17:37.273
> 
> 标签：linux, installation, wine

我的 Windows 应用程序在 Wine 下运行，但安装对于外行来说有点头疼，而且我在网上看到的包装器（PlayOnLinux、Wine Doors）需要安装更多的包。如果用户需要安装 Wine、安装应用程序和快捷方式，有没有办法制作一个可以安装 Wine 的软件包，所有这些都以最少的用户麻烦？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-14T00:39:32.120

我不相信有任何预先制作的方法可以做到这一点，但你可以很容易地制作一个依赖于 Wine 的 Debian 包，将 MSI 复制到机器上，然后运行 ​​Wine`msiexec /i /q`作为安装后脚本

编辑：请务必考虑卸载案例！即在预卸载脚本中，`msiexec`再次运行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-07T15:06:44.010

您可以捆绑 Wine——这就是 Picasa 所做的——或者您可以将您的软件包列表 Wine 作为依赖项；那么用户的包管理器会在用户安装你的包时自动为用户安装 Wine。

理想情况下，您的 Linux 软件包不会运行 Windows 安装程序，而是已经解压了所有文件。

诀窍是安排您的软件包安装在 /usr 中的文件显示在每个用户的 .wine 目录中。您可以查看 Picasa 是如何做到这一点的，但 Wine 社区确实需要记录如何更好地做到这一点。

与往常一样，如果您需要更多信息，请访问 winehq.org。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-30T12:42:03.113

如果您想针对 Mac OS，可以使用 WineBottler： [http ://winebottler.kronenberg.org/](http://winebottler.kronenberg.org/)

这个项目的存在只是为了以一种对用户相当隐蔽的方式将 Wine 捆绑到本机 Mac .app 包中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-13T19:45:18.303

答案很简单：

1.  创建精灵安装程序。
2.  将 Elf 安装程序打包到 Exe 安装程序资源中。
3.  Exe 安装程序应该在启动时解压 Elf 安装程序。
4.  Exe 安装程序必须在解压后尝试运行 Elf 安装程序（系统调用或某些人认为）。
5.  如果操作失败，我们进行正常安装。
6.  如果操作没有失败，我们关闭 Exe 安装程序。

# xml - *您*如何在 Web 应用程序的世界中使用 XML？

> ID：365866
> 
> 赞同：4
> 
> 时间：2008-12-13T22:33:15.650
> 
> 标签：xml, web-applications, comparison, messaging

**背景**
我正在研究当代 Web 应用程序中消息传递的效率，研究 XML 替代方案的使用。这是一个大学项目，其结果将公开发布——社区的参与度越高，回馈的结果价值就越大。

我需要尽可能多的实际使用中的 XML 示例，以便：

*   完全理解当主机 A 与主机 B 交谈时使用 XML 的内容
    我当然可以想象应该/可能如何使用 XML。现实可能完全不同。

*   对实际而非假设的数据执行测试
    XML 与技术 X 在*现实生活数据集上的比较与 XML 与技术 X 在**任意*数据集上的比较同等重要

*   识别和测量 XML 的任何使用模式，
     例如仅元素、元素加上一些属性或最少元素和重属性使用

**问题**

***您*如何在 Web 应用程序的世界中使用 XML？**

当主机 B 通过 HTTP 向主机 A 返回 XML 结构的数据时，会返回什么？这可能是在 AJAX 环境中返回数据的服务器，或者是从一个或多个其他服务器整理数据的服务器。

理想的答案包括：

*   HTTP 响应中 XML 的真实示例
*   请求上述内容的 URL（如果相关）
*   如果需要，解释数据代表什么
*   解释（如果不是很明显）为什么要交换此类消息（例如，为了满足用户请求；主机 X 向主机 Y 返回健康状态报告）

我更喜欢*您*制作、开发或工作过的应用程序/服务的示例，尽管欢迎任何示例。从 5 行 XML 文档到 10,000 行怪物，任何东西都很棒。

您自己对示例中使用 XML 的看法也很棒（例如，由于需求 X/Person Y，我们实现了 XML 结构的响应，尽管我认为 JSON 会更好，因为 ...；或者，我们使用 XML这样做是因为 [非常好的理由]，而且它只是这项工作的最佳选择）。

**更新**
我非常感谢关于 XML 主题的所有答案，但是我真正在寻找的是*包含 XML 的 HTTP 响应主体的真实示例*。

我目前相当了解 XML 的历史，可能存在哪些常见的替代方案，以及它们在功能和适用性方面如何比较给定场景。

更大的好处是了解当前如何在 HTTP 主机之间交换数据时使用 XML，而不管当前的使用是否正确或合适。错误应用 XML 的例子与正确应用 XML 的例子一样有价值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T23:59:46.133

我尽量不使用它。在客户端和服务器彼此不了解并且独立实现的架构中，它作为一种传输协议肯定有它的位置——或者一个 API 正在独立于*任何*客户端开发。它在持久性中也有一席之地，同样的推理也适用，我在那个领域反对它的次数要少得多。

但是，如果客户端和服务器由同一个团队实现，那么以人类可读的形式在两者之间来回转换几乎没有意义，并且几乎总是有更快、更便宜（在处理方面）的替代方案，即使客户端和服务器技术是不同的。

将我的评论集中在传输协议上，早在 XML 出现在带宽和处理能力非常宝贵的“糟糕”旧客户端/服务器时代之前，架构师的工作就是设计一个协议（通常是二进制），唯一的工作就是数据包大小最小化的效率和速度。明显的限制是握手非常具体，除非发布，否则二进制方言是不可理解的。好处是它非常高效，可以针对手头的应用进行高度优化。经常发布二进制格式（您是否看过旧的 Excel BIFF 规范 - 不是协议，而是发布二进制格式的示例）。

HTTP 中的 XML，即 SOAP，打破了这一点。基本原理非常合理，有一个普遍理解的握手协议，一种计算机[世界语](http://en.wikipedia.org/wiki/Esperanto)，这样你就可以将你的客户端和服务器架构分开，并完全分开决定它们的开发速度和内部结构。更重要的是，通过承诺切换客户端只是实现一个新客户端的问题，您可以应对可能的客户需求，从而保证自己的未来。更重要的是，允许任何拥有 XML 解析器的 Joe 使用您的 API。所有伟大的东西，并导致了非常明确的架构如雨后春笋般涌现——这非常好。

所以在相当大的程度上，这个命题的力量已经得到了体现，并且有明显的优势，但是我认为 a) 这个要求经常被夸大了 b) XML 协议的实现通常非常草率并且很少考虑它们的处理成本意味着。更重要的是，最初理智的推理已经让位于极端主义宗教的案例（我敢打赌我被否决了），我已经看到代码*在同一类中的*函数调用之间传递 XML ，完全使用面向未来的基本原理和功能分离论点，显然是疯了。

所以我的口头禅是让沟通变得高效和有效。如果这意味着为任意和未知的消费者提供通用的 API 和协议，那么 XML 是一个非常好的选择。如果这意味着制作闪电般的、可扩展的客户端/服务器（即 Web）架构，那么我会尝试使用二进制协议，通常是我自己的。

JSON 的出现证明了 XML 的潮流有太多的层次。JSON试图在保持通用性的同时缩短结构元素，从而获得更小的数据包的好处。像 Adob​​e 的[AMF](http://download.macromedia.com/pub/labs/amf/amf3_spec_121207.pdf)这样的协议通常*更*紧凑，几乎完全是二进制的。

这就是我认为未来可能所在的地方。我确信将有可能保留 XML 为接口发布所代表的所有优势，但能够大幅削减它并减少处理器和带宽密集型 - 至少这是我作为开发人员和架构师的使命。

想象一下，如果您的平均客户端/服务器请求是大小的 1/10，并且两端都没有文本解析，但您保留了接口的通用性。我不知道有哪个开发者会接受它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T23:07:48.983

可能不是您想要的答案，但我从不使用 XML，它太复杂了，（无论如何，对于我的简单需求），但即使我的需求很复杂，XML 也太复杂了，它让我害怕在复杂的问题中使用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-13T23:46:56.547

我的建议是跳过 XML，看看像 JSON 这样更简单的东西。XML 只提供两件事：

1）序列化复杂数据的“标准化”方法 2）验证（通过 DTD）上述序列化正确性的方法

请注意，“标准化”在引号中。唯一标准化的是格式化标签的方式。标签的含义根本不是标准的。最后，XML 为您提供的唯一东西是您不必自己编写一个好的解析器。

如果您传递的数据可以表示为简单的字符串、数组或关联数组（或散列），那么 XML 就大材小用了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-13T23:04:04.293

我建议您也学习 JSON，它是 XML 的替代品，并且因其紧凑性而被广泛使用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-13T23:45:02.060

不幸的是，出于商业/法律原因，我无法为您提供任何真实数据。

根据我的经验，xml 一直是我近年来从事的 90% 以上后端、服务器到服务器通信的标准格式，这纯粹是因为使用它的工具很流行，而且大多数开发人员都有一些经验。

像谷歌的协议缓冲区这样的东西对于许多任务来说可能更有效，但是大多数具有“企业”经验的程序员已经知道如何使用的格式的便利性和安全性很难提出商业案例。

如果您向外部世界销售服务，那么如果您提供基于 xml 的界面，则销售会容易得多，CIO 阅读“基于 xml 的 Web 服务”，CIO 说“好吧，我的团队知道......”

Xml 并不总是（有些人认为永远不会）是这项工作的最佳工具，但它的无处不在，以及使用它的现有代码库和技能集（好的、坏的和平庸的）的数量，经常把它推到候选人的头上队列。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-14T00:50:22.940

我不认为 XML 是一种字节高效的语言，但这不是它的用途。XML 提供的是一个良好的基础设施，可以在其上构建协议。就我所开发的产品而言，我们使用 SOAP 向我们无法控制的外部系统发送和接收业务数据，但接受 SOAP 是一种可靠的通用消息传递协议。同样，我们使用 SAML 断言在系统之间交换授权数据。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-14T00:53:52.310

我曾多次在 Web 应用程序中使用 XML。它一直是通过 SOAP Web 服务实现的。这是因为我在 Visual Studio 中编程，它对 SOAP Web 服务有很好的内置支持。它自动生成 OOP 包装器，允许从 AJAX（客户端）和 .NET（用于服务器到服务器通信的服务器端）轻松使用它。

我不认为我可以发布任何示例，但是我认为它无论如何都不会发生太大变化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-14T03:40:45.453

我将举两个例子说明我们使用 XML 满足的需求：

1.  我们需要传达从许多 UNIX 服务器收集的有关文件分配的数据，将详细信息发送到 Windows 服务器进行分析。详细信息和摘要都通过 Web 应用程序以图形方式显示。

2.  我们需要将多种格式的表单响应存储在一个存储库中，以供以后搜索和“回放”。表单在 Web 应用程序中生成、存储、搜索和回放。

在这两种情况下，我们都需要能够以自定义格式传输结构松散的数据。在这两种情况下，我们都发明了一种通用的 XML 结构，它易于发送进程生成，接收进程易于存储（本质上是单个长字符串）、搜索和解码，并且易于人类阅读和理解。在我们都走了很久之后。我们本可以发明 XML 以外的语法，但当时没有人能想到更好的方法，而且它对我们很有帮助。我不能分享具体的例子，因为这些数据被认为是专有的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-13T23:36:48.957

[Eucaris](http://www.eucaris.net/technology.php)是一个检索汽车注册数据的网络应用程序。后端将 XSD 类型的 XML 数据用于请求和响应消息。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-12-14T00:42:14.830

与许多其他人一样，我曾经尝试过 SOAP 和 XMLRPC，但发现浏览器支持太弱，以至于当 MSXML 输入错误时，我需要“退回”到专用解析器。[我的 netMail 应用程序](http://demo.internetconnection.net/netmail/)的早期版本曾经使用 XML，而 MSIE 在 XML 解析方面根本不够快。如果您真的有兴趣看到它，我仍然有 XML 实现。

*两个现实世界的例子立刻*浮现在脑海中，因为我在过去几个月里不得不处理：

在处理 Ingram-Micro 的 XML 排序接口时，消息依赖于*所有*元素的顺序，对编码问题非常敏感。根本没有办法使用标准的 XML 处理工具与之交互。一个特别的解决方案会更好，因为这样就不会怀疑元素的顺序是什么。交换是通过推送和拉取方法执行的；我们的服务器将数据发布到 IM-XML 的端点，然后他们的服务器将数据返回。

MRIS 的 XML 提要由 <Data Separator="~"> 之类的一行组成，然后是一堆 -分隔的`~`数据。提要有好几兆字节，简单地采用面向行的读取+拆分而不是“XML”的方法可以在更少的内存和更快的情况下完成工作。“XML”数据通过 HTTP GET 定期下载。

我不再使用 XML。总是临时解析器。我认为 XML 是一种极其短视的设计决策，*充其量*是幼稚的证据，其余时间则是彻头彻尾的愚蠢。

大多数情况下，我发现在涉及浏览器时使用原始 javascript 表达式（通常称为 JSON）（仅仅是因为`eval`“尽可能快”），否则使用 S 表达式。

很抱歉，我无法为您提供网络上任何好的 XML 示例；我根本不认为有任何。

# iphone - 为 Rails 应用程序构建 iphone 客户端的最佳方法是什么？

> ID：365868
> 
> 赞同：11
> 
> 时间：2008-12-13T22:34:26.553
> 
> 标签：iphone, ruby-on-rails, objective-c, xml, rest

我有一个相当标准的 rails 应用程序，并且希望能够从 iPhone 应用程序访问基本的 CRUD（创建、更新、删除）操作以及我添加的查询。Rails 或多或少地为这些操作提供了开箱即用的 REST API。

处理 iphone 上的 REST/XML 部分的最佳方法是什么，是否有任何好的 Objective-C 库已经可以做这种事情？这些操作还需要与特定用户相关联（即经过身份验证）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-26T20:12:39.720

这对我来说是一个常见问题，以至于我一直在研究 Rails ActiveResource 框架的一个端口，称为[ObjectiveResource](http://iphoneonrails.com/)。

到目前为止，我们已经发布了该项目的两个版本。1.0 已经被 App Store 中的一些应用程序使用，并且可以处理 Rails 中内置的默认 to_xml 和 to_json 资源处理。1.01 是一个错误修复版本和升级下降。

我们目前正在为 1.1 定义功能集。我们[已经有了很多想法](http://yfactorial.lighthouseapp.com/projects/18393-objectiveresource/tickets/bins/14714)，并且正在[邮件列表中讨论更多](http://iphoneonrails.com/community)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-15T10:35:30.093

我有一些运气使用 plists ......

您需要安装 plist-3.0.0 gem (gem install plist IIRC)

然后在您的控制器中设置如下内容：

```
plist = {'a'  => 'b', 'c' => 'd', 'e' => {'f' => 'g', 'h' => {'i' => 'j'}}}.to_plist
render(:text => plist) 
```

然后在你的 iphone 应用程序设置中是这样的：

```
NSURL *url = [NSURL URLWithString:@"http://somewhere.com"]; 
NSURLRequest *request = [NSURLRequest requestWithURL:url];
NSURLResponse *response;
NSError *error;
NSData *plistData;
plistData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
NSPropertyListFormat format;
NSString *errorStr;
id imagesToRate = [NSPropertyListSerialization propertyListFromData:plistData mutabilityOption:NSPropertyListImmutable format:&format errorDescription:&errorStr];
if(!imagesToRate) {
    NSLog(errorStr);
} else {
    NSLog(@"%@", [imagesToRate objectForKey:@"e"]);
} 
```

您几乎可以自由地使用 json（例如，您不必滚动自己的 xml 方案来格式化数据，并且序列化就像调用 to_plist 一样简单）另外，sdk 带有用于处理的本机代码列表。

但是，如果你们都准备好有一个以 json/xml 输出的网络服务，那么您可能希望保留它并使用已经提到的东西（TouchXML，json-framework）解析 iphone 上的东西

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-13T23:28:39.050

你最好的办法是围绕 NSURLConnection 编写一个简单的包装类，为你的 API 设置特定的东西。它并不是特别复杂，它可以让您直接根据您的目标 REST API 定制您的类的 API。您的类可以有一个 init 方法`initWithMethod:delegate:params:`，例如委托是希望异步接收结果的对象，而 params 是所有参数的 NSDictionary。您还可以使用类上的属性来设置身份验证（或让类在您登录后自行发现并记录）。

至于解析 XML，我建议查看[TouchXML](http://code.google.com/p/touchcode/wiki/TouchXML)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-14T00:05:32.703

如果您不喜欢解析 XML（谁会？）并且可以将后端配置为输出 JSON 而不是 XML，我强烈建议您使用[json-framework](http://code.google.com/p/json-framework/)之类的库。将数据读入对象比通过 XML 节点解析要容易得多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-25T21:50:32.140

我最近整理了一个使用 NSURLConnection 的 TouchJSON 示例。这是非常基本的，但应该足以让您开始异步加载。

[http://github.com/twoism/touchjsonexample/tree/master](http://github.com/twoism/touchjsonexample/tree/master)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-02T07:07:11.960

在 iPhone 上使用 NSURLConnection 时要小心。众所周知，内存泄漏会很快使应用程序崩溃。如果您正在执行大量 HTTP 请求，请不要指望 NSURLConnection 为您工作。找到别的东西，可能是一些卷曲包装器。

# android - 使用 Netbeans IDE 进行 Android 开发

> ID：365880
> 
> 赞同：43
> 
> 时间：2008-12-13T22:44:56.737
> 
> 标签：android, netbeans

有没有人使用 Netbeans (5.5+) IDE 为 Android 平台开发成功？我知道至少有一个 netbeans 插件应该支持它，但想知道是否有人在使用 netbeans 进行 Android 开发以及设置它有多容易。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-29T11:07:59.407

有一个名为 nbandroid（以前称为 undroid）的项目，它是 ADT 的 Netbeans 版本，它与 SDK 1.0 配合得很好

[http://nbandroid.org/](http://nbandroid.org/)

过去它托管在 undroid.nolimit.cz 和 nbandroid.kenai.com，这两个网站现在都已过时。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-28T18:17:26.060

Android 在构建时考虑了 Eclipse IDE。

它可以与任何 IDE 一起使用，但如果您对 NetBeans 没有任何强烈的感情，那么最好使用 Eclipse 进行开发。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-11-08T10:08:54.757

[http://nbandroid.org/](http://nbandroid.org/)和（源代码托管在[https://bitbucket.org/nbandroid/nbandroid](https://bitbucket.org/nbandroid/nbandroid)）将为您提供帮助。

该项目是最初在 undroid.ulimit.cz 上发布的第一次尝试的延续。

-拉迪姆

# asp.net - 什么条件会导致 Web 应用程序及时编译？

> ID：365886
> 
> 赞同：4
> 
> 时间：2008-12-13T22:48:11.767
> 
> 标签：asp.net, jit

**我很好奇导致应用程序及时编译的确切条件？**

我想大家都知道第一次访问一个非预编译的站点会导致JIT。将新代码扔到 App_Code 目录中怎么样？

我很确定某些操作（例如保存 web.config）只会导致应用程序池卸载，到目前为止，我对哪个操作具有哪个结果感到有些困惑。

我很想获得**一些好的 MS 文档的链接，**或者**没有 ASP.NET 全明星的想法。**

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-13T23:20:44.963

[了解 ASP.NET 动态编译](http://msdn.microsoft.com/en-us/library/ms366723.aspx)

[IIS 5.0 和 6.0 的 ASP.NET 应用程序生命周期概述](http://msdn.microsoft.com/en-us/library/ms178473.aspx)，“编译生命周期”部分

# c++ - “malloc”和“new”如何工作？它们有何不同（实施方面）？

> ID：365887
> 
> 赞同：8
> 
> 时间：2008-12-13T22:49:56.227
> 
> 标签：c++, c

我知道它们在语法上有何不同，C++ 使用 new，而 C 使用 malloc。但是在高级解释中它们是如何工作的呢？

请参阅[new/delete 和 malloc/free 有什么区别？](https://stackoverflow.com/questions/240212/what-is-the-difference-between-newdelete-and-mallocfree#240308)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-13T22:54:02.507

我只是要引导你回答这个问题：[new/delete 和 malloc/free 有什么区别？](https://stackoverflow.com/questions/240212/what-is-the-difference-between-newdelete-and-mallocfree#240308). 马丁提供了一个很好的概述。快速概述它们的*工作原理*（无需深入研究如何将它们作为成员函数重载）：

## 新表达式和分配

1.  该代码包含一个提供类型 ID 的新表达式。
2.  编译器将检查该类型是否使用分配函数重载了 operator new。
3.  如果它发现 operator new 分配函数的重载，则使用赋予 new 的参数和 sizeof(TypeId) 作为其第一个参数来调用该函数：

样本：

```
new (a, b, c) TypeId;

// the function called by the compiler has to have the following signature:
operator new(std::size_t size, TypeOfA a, TypeOfB b, TypeOf C c); 
```

1.  如果 operator new 分配存储失败，它可以调用`new_handler`，并希望它成功。如果仍然没有足够的地方，新的必须抛出`std::bad_alloc`或衍生它。具有`throw()`（不抛出保证）的分配器，在这种情况下应返回一个空指针。
2.  C++ 运行时环境将在分配函数返回的内存中创建由 type-id 给出的类型的对象。

有一些特殊的分配函数具有特殊的名称：

*   `no-throw`新的。这需要`nothrow_t`作为第二个论点。如下形式的新表达式将调用仅采用 std::size_t 和 nothrow_t 的分配函数：

例子：

```
new (std::nothrow) TypeId; 
```

*   `placement new`. 这将 void* 指针作为第一个参数，而不是返回新分配的内存地址，而是返回该参数。它用于在给定地址创建对象。标准容器使用它来预分配空间，但仅在需要时才创建对象，稍后。

代码：

```
// the following function is defined implicitly in the standard library
void * operator(std::size_t size, void * ptr) throw() {
    return ptr;
} 
```

如果分配函数返回存储，并且运行时创建的对象的构造函数抛出，则自动调用操作符 delete。如果使用了带有附加参数的新形式，例如

```
new (a, b, c) TypeId; 
```

然后调用带有这些参数的操作符 delete。该操作符删除版本仅在删除完成时才被调用，因为对象的构造函数确实抛出了。如果您自己调用 delete，那么编译器将使用仅采用`void*`指针的普通运算符 delete 函数：

```
int * a = new int;
=> void * operator new(std::size_t size) throw(std::bad_alloc);
delete a;
=> void operator delete(void * ptr) throw();

TypeWhosCtorThrows * a = new ("argument") TypeWhosCtorThrows;
=> void * operator new(std::size_t size, char const* arg1) throw(std::bad_alloc);
=> void operator delete(void * ptr, char const* arg1) throw();

TypeWhosCtorDoesntThrow * a = new ("argument") TypeWhosCtorDoesntThrow;
=> void * operator new(std::size_t size, char const* arg1) throw(std::bad_alloc);
delete a;
=> void operator delete(void * ptr) throw(); 
```

## 新表达式和数组

如果你这样做

```
new (possible_arguments) TypeId[N]; 
```

编译器正在使用`operator new[]`函数而不是 plain `operator new`。运算符可以传递第一个参数不完全`sizeof(TypeId)*N`：编译器可以添加一些空间来存储创建的对象的数量（必须能够调用析构函数）。标准是这样说的：

*   `new T[5]`导致调用 operator `new[](sizeof(T)*5+x)`，并且
*   `new(2,f) T[5]`导致调用 operator `new[](sizeof(T)*5+y,2,f)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-13T22:57:22.997

不同的`new`形式`malloc`如下：

*   它通过调用在分配的内存中构造一个值`operator new`。可以通过重载此运算符来调整此行为，无论是针对所有类型，还是仅针对您的类。
*   如果无法分配内存，它会调用处理函数。如果您事先注册了这样的处理程序函数，这使您有机会即时释放所需的内存。
*   如果这没有帮助（例如，因为您*没有*注册任何函数），它会引发异常。

所以总而言之，`new`它是高度可定制的，并且除了内存分配之外还进行初始化工作。这是两个很大的区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T23:14:48.767

虽然`malloc`/`free`和`new`/`delete`有不同的行为，但它们都在底层做同样的事情：管理动态分配的内存。我假设这是你真正要问的。在我的系统上，`new`实际上是在内部调用`malloc`来执行它的分配，所以我将只讨论`malloc`.

`malloc`和的实际实现`free`可能会有很大差异，因为实现内存分配的方法有很多。一些方法获得更好的性能，一些浪费更少的内存，另一些更适合调试。垃圾收集语言也可能有完全不同的分配方式，但您的问题是关于 C/C++。

通常，块是从堆中分配的，堆是程序地址空间中的一大块内存区域。该库为您管理堆，通常使用系统调用，如`sbrk`或`mmap`. 从堆中分配块的一种方法是维护一个空闲和已分配块列表，其中存储块大小和位置。最初，列表可能包含整个堆的一个大块。当请求一个新块时，分配器将从列表中选择一个空闲块。如果块太大，可以将其分成两个块（一个是请求的大小，另一个是剩下的任何大小）。当一个分配的块被释放时，它可以与相邻的空闲块合并，因为拥有一个大的空闲块比几个小的空闲块更有用。实际的块列表可以存储为单独的数据结构或嵌入到堆中。

有很多变化。您可能希望保留单独的空闲和已分配块列表。如果您有单独的堆区域用于常见大小的块或单独的列表用于这些大小，您可能会获得更好的性能。例如，当您分配一个 16 字节块时，分配器可能有一个 16 字节块的特殊列表，因此分配可以是 O(1)。仅处理 2 的幂的块大小也可能是有利的（其他任何东西都被四舍五入）。例如，[Buddy 分配器](http://en.wikipedia.org/wiki/Buddy_memory_allocation)就是这样工作的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-13T22:51:59.000

“新”比 malloc 做得更多。malloc 只是分配内存-它甚至不会为您将其归零。new 初始化对象，调用构造函数等。我怀疑在大多数实现中 new 只不过是基本类型的 malloc 的薄包装器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T22:52:30.120

在 C 语言中： malloc 分配一块您在参数中提供的大小的内存，并返回一个指向该内存的指针。

内存是在堆上声明的，因此请确保在完成后释放它。

# google-analytics - 如何解码谷歌 gclids

> ID：365888
> 
> 赞同：23
> 
> 时间：2008-12-13T22:50:27.693
> 
> 标签：google-analytics, statistics, analytics, protocol-buffers, google-ads-api

现在，我意识到对此的最初反应可能是“你不能”或“使用分析”，但我会继续希望有人比这更有洞察力。

带有“自动标记”的 Google 广告词会在链接上附加一个“gclid”（可能是“google click id”），将您发送到广告网站。它出现在网络日志中，因为它是一个查询参数，分析使用它来将该访问与广告/活动联系起来。

我想做的是从 gclid 中提取任何有用的信息，以便对我们的流量进行我们自己的分析。原因如下：

*   统计数据是不完善的，但如果我们对它们进行整理，我们就会确切地知道我们做了什么假设，以及它们是如何计算的。
*   我们可以将数据与其他数据联系起来，并生成更准确的转化​​率统计数据。
*   我们不必依赖 javascript 进行转换。

现在很明显 gclid 是 base64 编码的（或一些接近的变体），它的某些部分比其他部分变化更大。除此之外，我无法确定它与什么有关。

有没有人对我如何解码这个有任何见解，或者是否有人已经将 gclids 关联回了compaigns 甚至帐户​​？

我和谷歌的几个人谈过，尽管他们有“不作恶”的座右铭，但他们完全不愿意讨论泄露这些信息的可能性，即使是在保密协议下。似乎他们喜欢他们对*我们的*网络统计数据的垄断。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-16T21:06:49.857

到目前为止，最简单的解决方案是使用 Google Analytics（分析）活动跟踪参数（utm_source、utm_campaign、utm_medium 等）手动标记您的链接，然后提取该数据。

gclid 不仅仅依赖于 adwords 帐户/广告系列/等。如果您两次点击相同的 adwords 广告，它可能会为您提供不同的 gclid，因为还有与该特定点击相关的各种会话和费用数据。

Gclid 可能不是 100% 随机的，真的，但如果可以从该数字中提取所有 Adwords 数据，我会感到非常惊讶和担忧。这将是一个巨大的安全漏洞（即任意用户可以查看您的 Adwords 数据）。更有可能的是，每次展示都会生成一个伪随机 gclid，如果点击该广告，则 gclid 会登录到 Adwords 中（否则它会被丢弃）。然后，Analytics 使用该数字在事后将数据与 Adwords 进行核对。除此之外，gclid 号码本身没有内在价值。

关于您的最后一点，在 Google Analytics 和 Google Adwords 服务条款中都明确禁止尝试破解或反向工程此信息，并且是永久禁止的理由。此外，您在注册这些服务时同意的 TOS 表明，您的数据不能以您喜欢的任何方式使用。谷歌提供免费服务，所以有附加条件。如果您不喜欢无法完全控制您的数据，那么还有很多其他解决方案。但是，您将为这种控制支付额外费用。

谷歌几乎所有的收入都来自销售广告。Adwords 是他们最大的赚钱产品。他们不会向您提供有关其运作方式的机密信息。他们不知道你是谁，也不知道你将如何处理这些信息。如果您签署 NDA 并且他们有法律追索权起诉您，这并不重要；如果您将该信息泄露给竞争对手，您的生命将不足以偿还您将失去的钱。

很抱歉打扰您，但不管是否“不要作恶”，Google 是一家企业，而不是一家慈善机构。他们并没有通过将搜索算法提供给第一个提出要求的人而成为世界上最成功的公司之一。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-12-16T16:47:21.243

该参数在[Protocol Buffers](https://developers.google.com/protocol-buffers/docs/overview)`gclid`中编码，然后在 Base64 的变体中。

请参阅本指南以解码和解释[gclid ，包括您可以使用的（Apache 许可的）PHP 函数。](http://blog.deed-poll-office.org.uk/articles/decoding-gclid-parameter)

里面基本上编码了3个参数，其中一个是时间戳。其他2个暂时未知。

就理解这些其他参数的含义而言，将其与[以极其相似的方式编码](http://blog.deed-poll-office.org.uk/articles/decoding-ei-parameter)`ei`的参数进行比较可能会有所帮助（基本上是去掉了键的协议缓冲区）。该参数还有一个时间戳，似乎是微秒，以及 2 个其他整数。`ei`

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-04-15T14:24:20.200

[仅供参考，我刚刚在这篇文章](http://www.brandonchecketts.com/archives/what-is-in-a-gclid)中发布了对我网站上的一些 glcid 数据的快速分析。gclid 肯定有一些结构，但很难破译。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-05-04T18:11:10.637

我也一直在我们公司解决这个问题。我们希望能够更好地了解我们的 AdWords 正在做什么，但我们对 Google Analytics（分析）的局限性感到沮丧。

我们当前的解决方案是使用正则表达式在 Apache 访问日志中查找 GET 请求：

```
.*[?&]gclid=([^$&]*) 
```

如果存在，那么我们查看引用字符串以获取关键字：

```
.*[?&]q=([^$&]*).* 
```

另一种选择是更改您的 Apache 网络日志以开始记录 google 设置的 __utmz cookie，该 cookie 中应包含 utmctr 中的关键字。Google __utmz cookie，您应该能够找到大量信息。

引用字符串的准确性如何？不是100%。防火墙和安全设备会将其剥离。但是自己解析它确实比谷歌分析给你更多的灵活性。将 gclid 发送到 AdWords 并取回数据将是一项很棒的功能，但该功能似乎不可用。

编辑：由于我写了这个，我们还创建了我们自己的标签，这些标签作为请求参数附加到每个目标 url。每个标签只是文本、广告组和广告系列名称的 md5 哈希。我们使用正则表达式从访问日志中获取它并在 SQL 数据库中查找它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-03-11T21:06:01.870

我认为您可以通过 google 的 adword api 获得与 gclid 相关联的所有好东西。具体可以查询点击效果报告。

[https://developers.google.com/adwords/api/docs/appendix/reports#click](https://developers.google.com/adwords/api/docs/appendix/reports#click)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-13T23:08:14.957

好吧，这不是答案，但是这种方法类似于您解决任何密码学问题的方法。

可能性1：它们只是随机的，在这种情况下，你就完蛋了。这类似于一次性垫。

可能性2：它们“意味着”某些东西。在这种情况下，您必须控制环境。

1.  获取它们的良好数据库。为您的站点和其他站点查找 gclid。记录所有点击发生的所有时间，以及任何其他可能有用的数据
2.  开裂！正如您已经开始的那样，开始将您收集的数据与您的已知数据进行回归，看看您是否可以找到使用解密技术的模式
3.  开始抓取随机 gclid，看看它们带你去哪里。

虽然我不希望这会成功，但我祝你好运！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-14T22:47:46.553

看起来我的代表很弱，所以我只会发布另一个答案而不是评论。

显然，这不是答案。只是表达一些想法。

当您在 Adwords 中启用自动标记时，gclid 参数不会添加到目标 URL。相反，它们在运行时由 Google 点击跟踪服务器附加到目标 URL。因此，正在发生以下两件事之一：

1.  点击服务器将 gclid 与 Adwords 实体标识符一起存储，以便 Google Analytics（分析）以后可以查找它们。

2.  gclid 具有以某种方式编码的实体标识符，以便 Analytics 可以对其进行解码。

从性能的角度来看，Google 似乎不太可能实施类似于选项 1 的任何东西。强制 Analytics 将 gclid “加入”到 Adwords ID 似乎在规模上非常低效。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-09-09T14:00:35.193

这是解码 GCLID 参数的非编程方式。您可能只是想弄清楚推动点击和转化的广告系列、广告组、关键字、展示位置和广告。为此，您可以将 GCLID 作为单独的转化类型上传到 AdWords 中，然后按转化类型细分以深入了解触发转化的条件。这些步骤：

1.  在 AdWords 用户界面中，转到“工具”->“转化”->“通过点击导入”来源添加转化
2.  访问有关导入转化的 AdWords 帮助主题[https://support.google.com/adwords/answer/7014069](https://support.google.com/adwords/answer/7014069)并使用您的 GCLID 值创建一个批量加载文件，将转化分配给您新的“从点击导入”转化类型
3.  在左侧导航栏中的工具->转化->转化操作（上传）中将转化上传到 AdWords
4.  转到广告系列标签，细分->转化->转化名称
5.  在细分列表中找到您的新转化名称，这就是转化的来源。在广告组和关键字标签上继续执行相同的过程，直到您知道 GCLID 发起条件

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-12-22T18:41:06.027

另一种方法是简单地查看推荐人数据，该数据至少会提供被搜索的关键字。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-16T19:03:05.140

这里有一个想法：gclid 是否有可能只是一个密码哈希、la bit.ly 或其他一些 URL 缩短器？

在这种情况下，散列文本的内容将被写入数据库，并替换为唯一 ID。

毕竟，gclid 正在缩短一堆原本很长的文本。

举个例子：www.example.com?utm_source=google&utm_medium=cpc

转换为：www.example.com?gclid=XDF

就像 URL 缩短器一样。

需要一个替换密码才能对加密哈希进行逆向工程......这不是一件容易的事：[https ://crypto.stackexchange.com/questions/300/reverse-engineering-a-hash](https://crypto.stackexchange.com/questions/300/reverse-engineering-a-hash)

也许一些深入挖掘日志，寻找模式等......

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2010-01-13T21:25:56.013

I agree with Ophir and Chris. My feeling is that it is purely a serial number / unique click ID, which only opens up its secrets when the Analytics and Adwords systems talk to each other behind the scenes.

Knowing this, I'd recommend looking at the referring URL and pulling as much as possible from this to use in your back end click tracking setup.

For example, I live in NZ, and am using Firefox. This is a search from the Firefox Google toolbar for "stack overflow": [http://www.google.co.nz/search?q=stack+overflow&ie=utf-8&oe=utf-8&aq=t&client=firefox-a&rlz=1R1GGLL_en-GB](http://www.google.co.nz/search?q=stack+overflow&ie=utf-8&oe=utf-8&aq=t&client=firefox-a&rlz=1R1GGLL_en-GB)

You can see that: a) im using .NZ domain, b) my keyword "stack+overflow", c) im running firefox.

Finally, if you also stash the full landing page URL, you can store the GCLID, which will tell you the visitor came from paid, whereas if it doesn't have a GCLID, then the user must have come from natural search (if URL tagging is enabled of course).

This would theoretically allow you to then search for the keyword in your campaign, and figure out which adgroup them came from. Knowing the creative would probably be impossible though, unless you split test your landing URLs or tag them somehow.

# .net - 树视图节点上的动态上下文菜单

> ID：365892
> 
> 赞同：4
> 
> 时间：2008-12-13T22:54:56.233
> 
> 标签：.net, winforms, treeview, contextmenu, right-click

重复：[查找在上下文菜单下单击的节点](https://stackoverflow.com/questions/2527/c-treeview-context-menus)

我在 Treeview 上有一个上下文菜单，当用户右键单击它应该根据当前右键单击的节点的标记对象进行更改。

目前我正在更新 after_select 事件中的上下文菜单，但是当用户右键单击另一个节点而不选择它时，这不起作用。

如何检测右键单击哪个节点并更改上下文菜单？还是我做错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-13T23:02:52.520

您可以使用 MouseDown 事件和 HitTest 方法来找出单击了哪个节点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-22T19:52:13.050

```
Private Sub tvTables_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles tvTables.MouseDown
    If e.Button = Windows.Forms.MouseButtons.Right Then
        Dim M As New ContextMenuStrip
        Dim HTI As TreeViewHitTestInfo = tvTables.HitTest(e.X, e.Y)
        If HTI.Node.Level = 0 Then
            M = T1Menu
        ElseIf HTI.Node.Level = 1 Then
            M = T2Menu
        ElseIf HTI.Node.Level = 2 Then
            M = T3Menu
        End If
        tvTables.ContextMenuStrip = M
        tvTables.ContextMenuStrip.Show()
    End If
End Sub 
```

# .net - linq 是游标吗？

> ID：365898
> 
> 赞同：2
> 
> 时间：2008-12-13T23:02:04.657
> 
> 标签：.net, linq, linq-to-sql, .net-3.5

我熟悉 .NET 和 SQL。现在我正在查看新的 LINQ，它在我看来就像一个光标。我了解易用性等，但如果我使用 foreach 循环执行 LINQ-to-SQL 查询，我只是使用 DB 游标吗？或者在 LINQ 一次收集所有数据并将其一次一行地提供给我的程序的幕后是否有某种魔力？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-13T23:20:18.193

不，它不是 SQL 意义上的游标。它不会一次遍历数据库中的行。相反，它使用您指定的条件动态构造查询。它延迟查询的执行，直到需要第一个数据，然后对数据库执行查询。根据您使用数据的方式，可能会为您缓冲数据，以便您可以逐行迭代它，或者如果您使用扩展方法获取列表、数组等，它可以将整个行集作为集合返回. 然而，就数据库而言，它只是在执行一条 SQL 语句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-13T23:15:50.713

LINQ 有许多化身。既然您提到了 LINQ-to-SQL，我将重点关注这一点：两者都不是......它最可比`IDataReader`- 即它执行构造的 TSQL 命令，然后逐行返回处理过的记录（见下文) 因为它从 SQL Server 接收它们。与 一样`IDataReader`，每行只有一次机会，除非您使用 , 等缓冲`.ToArray()`数据`.ToList()`。

执行的 TSQL 命令是根据您构建的 LINQ 查询构造的，并进行了参数化以防止 SQL 注入 - 因此，如果您使用“where”，则执行的 TSQL 包括“WHERE”等。

实际上，客户端通过 按需消费记录`IEnumerable[<T>]`，因此需要一个小缓冲区来处理传入的 TDS 流 - 但它与数据库游标不同。

请注意，大多数操作（排序等）可以向下发送到服务器并转换为 TSQL - 但可能必须在客户端完成某些操作，这可能会再次迫使它在内存中缓冲更多数据。如果您通过 强制它尤其如此`.ToEnumerable()`，它会切换到 LINQ-to-Objects。如果 LINQ-to-Objects 执行缓冲操作（排序、分组等），则需要将数据加载到内存中。

这里有几点需要注意；例如，如果您想在查询中计算完全独立的聚合等，您必须（通常）执行两次（等），或者将其全部缓冲在内存中（不一定是大数据的选项）。对于这种类型的场景（和其他场景），Jon Skeet 和我自己编写了一个替代的 LINQ 实现，它作为*push*而不是*pull*工作，允许您一次通过多个并行进程提供数据。[Jon在这里](http://codeblog.jonskeet.uk/2008/01/04/quot-push-quot-linq-revisited-next-attempt-at-an-explanation/)解释得更好。如果你有一个非常大的、一次性的数据流，你想对其进行复杂的处理，这种类型的东西主要是有用的。不过很有趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-13T23:31:07.283

每当您通过网络将数据库中的行返回到客户端时，数据库服务器都会使用游标返回查询结果。

它是一个隐式游标，由数据库服务器控制，但它仍然是一个游标。

人们不推荐使用显式游标的原因，以及它们比批量查询慢的原因，是因为使用隐式游标，数据库服务器可以准确地知道它是如何被使用的。它可以优化对磁盘的访问，并且可以智能地使用用于控制对数据库的并发访问的锁。使用显式游标时，数据库服务器必须假设最坏的情况，因为它不知道游标持有的锁何时或如何被释放。此外，数据库可以使用索引来提高批量查询的性能，如果您使用游标，您将无法获得这些查询。但是，即使在简单的“返回整个表”的情况下，使用批量查询而不是游标也可以获得更好的性能。

当您运行 LINQ 查询时，LINQ 代码将转换为批量 SQL 查询，该查询使用 ADO.NET 以类似于生成查询字符串并将它们提交到数据库时所编写的方式提交到数据库.

这会导致创建一个游标，但它与您直接提交批量查询并处理 IDataReader 时获得的隐式游标相同。

# ruby - Ramaze 会话中的复杂或深层对象存储被破坏？

> ID：365903
> 
> 赞同：2
> 
> 时间：2008-12-13T23:04:16.027
> 
> 标签：ruby, session, ramaze

（这是关于 Ramaze.net 框架的）

在会话中存储自定义对象时遇到了一些非常奇怪的问题。我注意到只有立即存储在会话中的对象的属性被更新。但是，如果这些对象包含对其他对象的引用，则如果会话中包含的直接对象在请求期间没有更改，则不会更新这些引用的对象。

这个问题只有在使用 Ramaze::FileCache 作为我的会话缓存后端时才变得明显。我相信在使用内存会话时问题被掩盖或不是问题。

我发现问题是因为在 Ramaze::Session::Hash#method_missing (lib/ramaze/current/session/hash.rb) 中找到的会话逻辑中的“浅拷贝”。

作为一个快速测试以确保我的想法是正确的，我注释掉了“差异检查”，基本上每次都强制更新会话。

```
 def method_missing(*args, &block)
    old = @hash.dup
    result = @hash.send(*args, &block)
    #unless old == @hash
      Cache.sessions[@session.session_id] = self
    #end
    result
  end 
```

这个小技巧解决了我的问题。现在我的问题是：

1.  这是一个安全合理的解决方案吗？
2.  我应该避免在会话中存储复杂/深层对象吗？
3.  有什么我想念的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-29T12:12:51.380

此问题已在最新的 Ramaze (2009.04) 中得到解决，如果问题仍然存在，请在[Ramaze 问题跟踪器中提交补丁。](http://github.com/manveru/ramaze/issues)

# python - 如何确定函数的周期

> ID：365924
> 
> 赞同：1
> 
> 时间：2008-12-13T23:23:11.917
> 
> 标签：python, math

如果我有一个函数 A，它可以在给定矩阵上应用某个规则来生成另一个矩阵，我称之为原矩阵的下一个状态，该函数也可以通过给定时间 N 确定矩阵的最终状态（将规则应用于原点，并再次将规则应用于原点矩阵的下一个状态，并应用规则应用规则... N 次）。

***所以假设对于一个给定的矩阵，对它应用规则 5 次，最终矩阵变得与原矩阵相同，我们称该矩阵的周期为 5。***

我还有另一个函数 B，我怎样才能使函数 B 可以在函数 A 的相同规则下确定给定函数的周期，并返回周期？我只是不知道如何开始制作它...谢谢进步。

```
def functionA(origin_matrix,N_times):
   #apply rule on the origin_matrix to generate another matrix which is the next sate of it.
   #apply rule on origin_matrix for N_times
   return the_final_matrix

def functionB(origin_matrix):
   #determine the period of the the origin_matrix.
   return period 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-13T23:36:18.847

使用 for 循环或带有临时结果和计数器的 while 循环。后一种方法是最有效的（通常）。

简单版本，伪代码：

```
iterations = 0;
tmp = origin_matrix;

do
    tmp = operation(tmp);
    iterations += 1;
while tmp != origin_matrix;

return iterations; 
```

编辑：您还可以使用简单的 while 构造：

```
while True:
    tmp = operation(tmp)
    iterations += 1

    if tmp == origin_matrix:
        break  # Or you could return here. 
```

编辑：那是针对功能B的。我不知道它们是单独的问题。例如，操作 (x) = 函数 A(x, 1)。

对于 functionA，您很可能会使用 for 循环。伪代码：

```
matrix = origin_matrix

for i in range(N_times):
    matrix = operation(matrix)

return matrix 
```

# air - 烟花还是空气？

> ID：365925
> 
> 赞同：3
> 
> 时间：2008-12-13T23:24:16.860
> 
> 标签：air

我需要编写一个可以在 Mac（Windows 和 Linux 很快）上运行的桌面应用程序，它可以从 MySQL 获取数据并允许用户将文件从他们的桌面传输到服务器。

我知道我可以在 AIR 中编写桌面应用程序，Fireworks 将如何发挥作用？

AIR 可以连接 MySQL 吗？

一个FTP文件可以用AIR吗？

第二点，可以在 AIR 中编写诸如铃声制作器、磁盘修复/分区实用程序之类的应用程序吗？我知道 AIR 使用网络技术，但还有什么其他可能的呢？

-杰森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-15T03:00:07.127

AIR 应用程序是 Flash 应用程序的桌面版本。因此，您可以在 Flash 应用程序中执行的任何操作都可以在 AIR 应用程序中执行。Flash 应用程序与 MySQL 一起使用，因此您应该能够让 AIR 应用程序与 MySQL 一起使用。

AIR 应用程序还可以访问本地文件系统。例如，您可以编写一个 AIR 文件加载器应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T23:48:16.593

你是说 Adob​​e Fireworks 吗？我会使用 Fireworks 进行界面设计。它还有一些可定制的资产。

这是产品页面，他们有更多关于它的功能的信息。

[http://www.adobe.com/products/fireworks/features/?view=topnew](http://www.adobe.com/products/fireworks/features/?view=topnew)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-10-07T17:17:14.847

您可以使用 Fireworks 为大多数部分的 UI（用户界面）创建图像，这已经足够了，如果您需要高级阴影和颜色选项，您可以查看 Photoshop，但 Fireworks 非常适合基本的图形内容。

我不确定您的问题是否与 UI 有关，因为烟花本身与构建 Air 应用程序无关。

您可以使用不同的解决方案来构建您的 air 应用程序，可能会跑题，但如果您还没有决定如何构建 AIR 应用程序，我会研究 Adob​​e Flash Builder 4,5、flex 和 AIR 开发库。Flex 也非常适合轻松更改用户界面 (CSS)，您可以在其中创建带有烟花的图像 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-17T00:39:31.463

Fireworks 是我最喜欢的设计工具。如果您正在使用数字图形，则几乎不需要将目光从 FW 转向 Photoshop 和 Illustrator 之类的东西。所有 CS5 软件介绍屏幕都是在 Fireworks 中设计的。它具有我所见过的最好的 32 位 PNG 输出，并且颜色已经死了，没有 PS 更改其从创作环境的输出的问题。

根据经验，我不建议花时间在 AIR 上。Web 应用程序是要走的路，由于编程维护成本、版本发布和新技术发布的速度，对桌面甚至移动特定设备应用程序的投资将很难证明是合理的。

# sql - 在 T-SQL 中批量导入 zip 文件

> ID：365931
> 
> 赞同：1
> 
> 时间：2008-12-13T23:30:24.070
> 
> 标签：sql, sql-server, tsql, zip

我有一些数据文件以 .Z 扩展名压缩存储在我们公司的服务器上（用于压缩它们的 UNIX 压缩实用程序）。

SQL Server 的 BULK IMPORT 操作可以读取这些格式的文件吗？或者我必须在获取数据之前解压缩它们吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-14T00:02:23.770

BULK IMPORT 本身无法执行此操作，但是如果您使用的是 SQL2005 或更高版本，则可以使用 SSIS。第一步是执行 Exectute Process Task 并使用 zip 实用程序解压缩文件。第二步是使用 SSIS Bulk Insert 任务将数据推送到 SQL Server。

编辑：使用来自 unixutils 而不是 cygwin 的压缩来解压缩文件，因为它理解本机 Windows 文件名。这意味着您不必维护 /cygdrive 路径以及本机路径。

# c# - 尝试将 rgb 从 .net 颜色转换为字符串，例如“red”或“blue”

> ID：365935
> 
> 赞同：8
> 
> 时间：2008-12-13T23:33:32.253
> 
> 标签：c#, .net, image, colors, system.drawing.color

我所有的方法都以各种方式让我失望。不同的照明也会把事情搞砸。

有没有人试图返回一个给定 rgb 值的名字？“红色”“绿色”“蓝色”足以满足我今天的需求。

我对来自网络摄像头的图像进行了不安全的字节处理。

[![摄像头](https://i.stack.imgur.com/ptjtc.png)](https://i.stack.imgur.com/ptjtc.png)

![颜色](https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Color_star-en.svg/646px-Color_star-en.svg.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-13T23:46:28.063

如果您有一个带有名称的已知颜色列表，您可以使用（F# 代码）行中的“接近性”函数来查看给定目标颜色与这些已知颜色中的哪些“最接近”：

```
let Diff (c1:Color) (c2:Color) =
    let dr = (c1.R - c2.R) |> int
    let dg = (c1.G - c2.G) |> int
    let db = (c1.B - c2.B) |> int
    dr*dr + dg*dg + db*db 
```

无论哪种已知颜色与您要命名的目标颜色的差异最小，请使用该名称。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T05:06:48.403

你可以试试这段代码

```
static char[] hexDigits = {
         '0', '1', '2', '3', '4', '5', '6', '7',
         '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'};

public static string ColorToHexString(Color color)
        {
            byte[] bytes = new byte[4];
            bytes[0] = color.A;
            bytes[1] = color.R;
            bytes[2] = color.G;
            bytes[3] = color.B;
            char[] chars = new char[bytes.Length * 2];
            for (int i = 0; i < bytes.Length; i++)
            {
                int b = bytes[i];
                chars[i * 2] = hexDigits[b >> 4];
                chars[i * 2 + 1] = hexDigits[b & 0xF];
            }
            return new string(chars);
        } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-14T04:19:13.643

我个人觉得从[色相/饱和度/亮度](http://en.wikipedia.org/wiki/HSV_color_space)的角度来考虑颜色比 RGB 值更自然，我认为在这种情况下这对你很有效。尝试这个：

将颜色名称分配给光谱的某些范围，如您所见。例如，红色可能是 0-39，橙色是 40-79，等等（这些是任意数字——我不知道它们是否适合任何规模）。然后根据您的 RGB 值计算色调（您可以在[此处](http://en.wikipedia.org/wiki/Hue#Computing_hue_from_RGB)找到一个公式，尽管可能还有其他公式）。一旦你知道了色调，你就知道它在光谱的哪个范围内，你可以给它一个名字。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-08-25T10:25:10.153

这是一个使用两个限定符和一个颜色名称的简单名称方案：

```
string ColorName(Color c)
{
    List<float> hues = new List<float>()
    { 0, 15, 35, 44, 54, 63, 80, 160, 180, 200, 244, 280, 350, 360};
    List<string> hueNames = new List<string>()
        { "red", "orange-red", "orange", "yellow-orange", "yellow",
          "yellow-green",   "green"  , "blue-green" , "cyan", "blue", 
          "violet", "purple", "red" };

    float h = c.GetHue();
    float s = c.GetSaturation();
    float b = (c.R * 0.299f + c.G * 0.587f + c.B *0.114f) / 256f;

    string name = s < 0.35f ? "pale " : s > 0.8f ? "vivid " : "";
    name += b < 0.35f ? "dark " : b > 0.8f ? "light " : "";
    for (int i = 0; i < hues.Count - 1; i++)
        if (h >= hues[i] && h <= hues[i+1] )
        {
            name += hueNames[i];
            break;
        }
    return name;
} 
```

如果您希望蓝调更加与众不同等，您可以轻松调整它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-13T23:38:18.220

好吧，红色/绿色/蓝色很容易通过检查来识别；您需要支持什么范围的值？

问题是除非你从一个命名的颜色开始，否则很难*回到*一个。`IsNamedColor`即使您通过 FromArgb 创建了明显的颜色，也会返回 false。

如果您只需要实际预期的标准颜色，您可以通过反射枚举已知颜色吗？

```
 Color test = Color.FromArgb(255,0,0);
        Color known = (
                   from prop in typeof(Color)
                       .GetProperties(BindingFlags.Public | BindingFlags.Static)
                   where prop.PropertyType == typeof(Color)
                   let color = (Color)prop.GetValue(null, null)
                   where color.A == test.A && color.R == test.R
                     && color.G == test.G && color.B == test.B
                   select color)
                   .FirstOrDefault();

        Console.WriteLine(known.Name); 
```

您也许还可以使用这种方法作为更复杂算法的已知颜色来源。

# java - 对于 Eclipse 片段项目，是否有等效于 BundleActivator 的工具？

> ID：365946
> 
> 赞同：4
> 
> 时间：2008-12-13T23:45:58.313
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-fragment

我正在构建一个 Eclipse 插件，它在常规插件项目中提供一组核心功能。我通过片段项目提供的可选功能。但我需要片段在启动时向主插件注册。

我不能在片段项目中使用 Bundle-Activator。所以我想知道是否有一些替代机制来声明一个入口点或一些我可以挂钩的回调？

如果除了将片段项目转换为常规插件项目之外别无选择，是否有我需要注意的缺点？

这是我根据接受的答案使用的解决方案：

```
final IExtensionRegistry registry = Platform.getExtensionRegistry();
final IExtensionPoint extensionPoint = registry.getExtensionPoint("myextensionid");
final IExtension[] extensions = extensionPoint.getExtensions();
for (int j = 0; j < extensions.length; ++j)
{
    final IConfigurationElement[] points = extensions[j].getConfigurationElements();
    for (int i = 0; i < points.length; ++i)
    {
        if ("myelementname".equals(points[i].getName()))
        {
            try
            {
                final Object objImpl= points[i].createExecutableExtension("class");
                objImplList.add(provider);
            }
            catch (CoreException e)
            {
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-14T15:00:01.790

您可以定义一个扩展点并通过扩展查找/调用您的片段类。

```
 IExtensionRegistry registry = Platform.getExtensionRegistry();
    IExtensionPoint extensionPoint = registry
            .getExtensionPoint("myplugin.myextension");
    IConfigurationElement points[] = extensionPoint
            .getConfigurationElements();
    for (IConfigurationElement point : points) {
        if ("myextensionFactory".equals(point.getName())) {
            Object impl = point.createExecutableExtension("class");
            if (impl instanceof IMyExtension) {
                ((IMyExtension) impl).foo();
            }
        }
    }
} 
```

* * *

编辑：

> 要使用这种方法，我必须将我的片段项目转换为插件项目。– bmatthews68

你不应该这样做。例如，在我的测试代码中，我在主机插件中有以下文件：

**元信息/清单.MF**：

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: Myplugin Plug-in
Bundle-SymbolicName: myplugin;singleton:=true
Bundle-Version: 1.0.0
Bundle-Activator: myplugin.Activator
Require-Bundle: org.eclipse.core.runtime
Eclipse-LazyStart: true
Export-Package: myplugin 
```

**插件.xml**：

```
<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<plugin>
    <extension-point id="myextension" name="myextension"
        schema="schema/myextension.exsd" />
</plugin> 
```

该片段包含以下文件：

**元信息/清单.MF**：

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: Myfragment Fragment
Bundle-SymbolicName: myfragment;singleton:=true
Bundle-Version: 1.0.0
Fragment-Host: myplugin;bundle-version="1.0.0" 
```

**片段.xml**：

```
<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.2"?>
<fragment>
   <extension
         point="myplugin.myextension">
      <myextensionFactory
            class="myfragment.MyExtension1">
      </myextensionFactory>
   </extension>
</fragment> 
```

这些项目是使用 Eclipse 3.3.1.1 生成的。

# visual-studio-2008 - Visual Studio 数据库版：一些新手问题

> ID：365948
> 
> 赞同：2
> 
> 时间：2008-12-13T23:46:12.197
> 
> 标签：visual-studio-2008, installation

我正在考虑将 Visual Studio 数据库版（又名 VSDE）添加到我的 VS2008 版本中。

Q1。这些产品的安装顺序是什么？这个可以吗？

*更新：根据反馈修复了安装顺序。*

*   VS2008（c# [无子选项]、web dev、ts 工具。没有别的）。
*   Team Foundation 客户端（在我们的 msdn dvd 上找到）
*   VSDE
*   ~~VSDE GDR（我想我们是从 download.microsoft.com 下载的）~~
*   ~~VS2008 SP1~~
*   VS2008 SP1
*   VSDE GDR

Q2。在客户端机器上没有安装 sql server 但使用开发盒是否“可以接受”？他们的开发数据的私有实例呢？基本上，我们不会在我们的 vista 开发盒上安装 sql。我个人不喜欢我可能不会一直使用的额外服务。我们通常有 3 个数据库 - 开发、测试、生产。我们是否应该在我们的开发盒（例如）上创建多个 Sql 实例，这些实例可能是 SqlMachine\User1、SqlMachine\User2 等，而根 SqlMachine 是“Dev”。这样，我们每个人都可以使用 VSDE 来玩我们自己的数据库实例，然后这会上升到 Dev 实例？

（我希望这是有道理的）。

干杯！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-13T23:53:15.880

Q1 - GDR 具有 VS2008 SP1 的先决条件，因此请切换最后两个。

Q2 - 我相信每个开发人员都应该使用自己的沙盒数据库实例，是的。如果您不想在工作站上安装 SQL Server 实例，那么在开发服务器上使用多个 SQL 实例听起来是一个合理的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T00:07:47.457

我会将数据库放在开发机器上。您可以更改该服务，使其默认不启动，并在您想使用它时手动启动它，如果您不希望它一直运行。我更喜欢这个，这样我在开发时就不会依赖另一个系统的可用性。如果您这样做并且想要 VS 中包含 Express 版以外的其他内容，请在安装 VS 之前安装 SQLServer（我使用开发人员版），以免默认安装 Express 版。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-14T03:36:41.780

既然你已经完成了修复，安装顺序对我来说看起来不错。

关于本地数据库：出于多种原因，我建议您使用本地副本。首先，您当然需要针对数据库进行测试，并且本地副本非常方便——尤其是在 Dev 数据库出现故障的情况下。其次，更重要的是，如果您还生成数据库代码（存储过程或 DDL 来更改数据库），您将需要一个私有沙箱来正确处理，然后再将其与其他人共享的副本合并（请注意，我是假设您拥有更改或添加到数据库结构或存储过程的权利或责任）。

在许多以数据库为中心的环境中，保留更改历史是一个挑战，因为在许多项目中，数据库结构本身并未保存在源代码控制中。我通过在我的解决方案 (ASP.NET) 的 app_data 目录中保留一个或多个 SQL DDL 文件来解决这个问题。由于整个解决方案都处于源代码控制之下，因此我记录了我在将产品从当前版本移动到下一个版本时所做的更改（显然但非常重要的是，在我们上线之前已将其删除）。当然，当您将代码与团队的其他成员集成时，您必须在修改开发服务器之前对您建议的任何结构更改进行仔细的代码审查。每日构建/集成将有助于防止这种情况失控。

# .net - 在 TreeView 中添加子项

> ID：365952
> 
> 赞同：1
> 
> 时间：2008-12-13T23:48:51.037
> 
> 标签：.net, vb.net, .net-3.5

我确定这听起来像是一个 n00b 问题，但是如何在 VB.NET 3.5 中填充 TreeView 列表时以编程方式添加子项？我有以下代码，但无法弄清楚如何为我填充 TreeView 的每个文件夹/文件添加子项：

```
Private Sub AddToList(ByVal targetDirectory As String, ByVal boolFiles As Boolean, Optional ByVal recur As Boolean = False)

    Dim shortName As String

    TreeView1.Items.Add(targetDirectory)

    //Add subitems under here

    If Directory.GetDirectories(targetDirectory).Length > 0 Then
        Dim subdirectoryEntries As String() = Directory.GetDirectories(targetDirectory)
        Dim subdirectory As String

        For Each subdirectory In subdirectoryEntries
            shortName = subdirectory.Remove(0, subdirectory.LastIndexOf("\") + 1)
            TreeView1.Items.Add(shortName)
            AddToList(subdirectory, False, True)

            If boolFiles = True Then AddToList(subdirectory, boolFiles)
        Next
    End If
End Sub 
```

澄清一下，我希望我的 TreeView 看起来类似于 Windows 资源管理器的外观。我感谢任何和所有的帮助！

提前致谢！联合部队

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-13T23:53:52.680

您需要使用 TreeNode 对象，并将子项添加到父 TreeNode，而不是直接将所有内容添加到 TreeView。看看[这个例子](http://www.java2s.com/Code/CSharp/GUI-Windows-Form/RecursivelyloadDirectoryinfointoTreeView.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-13T23:55:20.697

这是哪个树视图？在 winforms 中，您只需从 Add 中捕获返回的 TreeNode，并将更多项目添加到 Nodes 属性：

```
TreeNode parent = treeView.Nodes.Add("parent");
parent.Nodes.Add("child"); 
```

# delphi - 如何最好地将插件功能添加到 Delphi 程序

> ID：365968
> 
> 赞同：14
> 
> 时间：2008-12-14T00:02:26.860
> 
> 标签：delphi, plugins

我希望为用户添加在我用 Delphi 开发的程序中编写插件的功能。该程序是一个没有使用 DLL 的单一可执行文件。

这将允许用户社区为我的程序编写扩展，以访问内部数据并添加他们可能觉得有用的功能。

我在以下位置看到了帖子：[添加插件功能的建议？](https://stackoverflow.com/questions/8140/adding-plugin-capability)但它的答案似乎不能转移到德尔福程序。

如果可能，我希望添加此功能并将我的应用程序保留为单个可执行文件，而不需要任何 DLL 或其他模块。

您是否知道任何可以建议如何在 Delphi 中最好地做到这一点的资源、组件或文章，或者您有自己的建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-14T15:01:50.507

我要问的第一个问题是，您是否需要插件来访问主机应用程序的 UI，或者添加它们自己的任何 UI 元素？或者插件是否仅限于查询和/或向您的主机应用程序提供数据？

后者更容易，并开辟了两种可能性。其他人已经提到了 DLL，这是第一种方法。某些警告适用 - 通常，您应该仅使用 Windows API 中使用的数据类型与 dll 进行交互。这样，您可以确保插件 DLL 将理解您的数据类型，无论它们是用什么语言/编译器创建的。（例如，使用 PChars，而不是字符串。通常不要将 Delphi 类（如 TStream）传递给一个 DLL。这在某些情况下似乎可以工作，但通常是不安全的，因为即使 DLL 是在 Delphi 中编译的，它也可能是编译器的不同版本，对 TStream 的概念略有不同）。谷歌在 Delphi 中使用 DLL，你会发现更多的技巧。

另一种尚未提及的方法是在应用程序本身中启用脚本。有几个非常强大的第 3 方脚本引擎，包括商业的和免费的，其中大多数允许您与脚本交换 Delphi 对象。其中一些库仅支持 Pascal 作为脚本语言，其他库将允许您使用 Basic（对于初学者用户可能更好）或其他语言。[例如，参见http://www.remobjects.com/free.aspx](http://www.remobjects.com/free.aspx)上的 RemObjects Pascal 脚本（免费）。

目前我最喜欢的脚本解决方案是 Python for Delphi（P4D，也是免费的），来自[http://mmm-experts.com/Products.aspx?ProductID=3](http://mmm-experts.com/Products.aspx?ProductID=3)它可以通过 RTTI 与您的类完美交互，并允许您执行Delphi 应用程序中的 Python 代码，以及在 Python 脚本中使用 Delphi 类。鉴于 Python 的流行，如果您想吸引开发人员加入您的项目，这可能是一个可行的解决方案。但是，每个用户都需要安装 Python 发行版。

在我看来，从潜在的插件编写者的角度来看，使用脚本比选择 DLL 的门槛更低。

现在，回到我最初的问题：如果您需要插件与您的用户界面交互，例如通过在其上放置控件，事情会变得更加复杂。通常，DLL 不能用于执行此操作。Borland/CodeGear 认可的方式是使用包 (BPL)。使用 BPL，您可以访问和实例化插件提供的类，就好像它们在您的主机应用程序中声明一样。问题是，所有 BPL 都必须使用与主应用程序相同的 Delphi 版本和版本进行编译。在我看来，这使得软件包完全不切实际，因为很难期望世界上所有潜在的插件编写者都会使用与您相同的 Delphi 版本。一个重大的陷阱。

为了解决这个问题，我尝试了一种不同的方法：继续使用 DLL，并为插件开发一种语法来描述它需要的 UI，然后在主机应用程序中自己创建 UI。（XML 是一种方便的方式来表达 UI，因为您可以免费获得父级/嵌套的概念。） UI 描述语法可以包括当控件的内容或状态更改时触发的对 DLL 的回调。不过，此方法会将插件限制为您的应用程序已使用或已注册的 VCL 控件集。这不是一夜之间的工作，而 BPL 肯定是。

谷歌的“Delphi 插件框架”也是如此。有一些现成的解决方案，但据我所知，它们通常使用 BPL，用处有限。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-14T00:52:02.673

实际上，[您引用的问题的公认答案](/questions/8140#8157)也非常适合德尔福。您的插件将是 DLL，您可以指定它们应导出具有特定名称和签名的函数。然后，您的程序将加载 DLL（使用`LoadLibrary`）并获取函数的地址（使用`GetProcAddress`）。如果 DLL 没有加载，或者函数不存在，则 DLL 不是您的应用程序的插件。

获得 DLL 的地址后，就可以调用它了。您可以将函数传递给表示您希望公开的应用程序部分的接口。您还可以要求该函数返回一个接口，其中包含您的应用程序将在不同时间调用的方法。

在测试您的插件系统时，最好自己用 Delphi 以外的语言编写插件。这样，您就可以更加确信您没有无意中要求每个人都使用 Delphi。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-15T10:12:38.000

起初我选择了 BPL 和 DLL 基础插件。并且发现它们难以维护。

如果你使用 BPL 系统，那么你需要匹配 BPL 版本和 EXE 版本。这包括可以破坏某些东西的 Delphi 更新。我发现（很难）如果我需要在每个版本中包含我所有的插件，那么拥有插件是没有意义的。

然后我切换到普通的 DLL 插件。但是那个系统只是复杂的代码库。这不是一件好事。

在浏览网络时，我发现了[Lua](http://www.lua.org)嵌入式脚本语言，并提供了它。Lua 是 150K 的 DLL，嵌入字节码编译器、解释器和非常简单和智能的动态编程语言。

我的插件是简单的 lua 脚本。易于维护和制造。有预制的 Delphi 示例，因此您可以将任何类或过程导出为 Lua 表或函数。GUI 与否。例如，我的应用程序中有 TurboPower Abbrevia 用于压缩。我将我的 zipping 类导出到 lua，现在所有插件都可以调用 zip(' *.* ', 'dir.zip') 和 unzip()。然后我切换到 7zip，只实现了旧类来使用 7zip。所有插件都像以前一样工作，支持新的 zip(' *.* ', 'dir.7z')。

我制作了 TLuaAction，它从其脚本中调用 Execute()、Update()、Hint() 过程。

Lua 也有它自己的插件系统，可以很容易地为其添加功能。例如 luacom make 易于使用 COM 自动化，luainterface 允许从 lua 调用 .net。有关更多信息，请参见[luaforge](http://www.luaforge.net)。有 Delphi 制作的 Lua IDE，有源代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-14T08:17:44.240

前段时间我试图对[所有这些选项进行概述。](http://17slon.com/blogs/gabr/2008/09/interfacing-with-external-programs.html#comments "与外部程序的接口")我们与我的读者/评论者一起建立了这个列表：

*   从程序加载的 DLL/BPL。
*   从沙箱加载的 DLL/BPL（可以是程序的另一个副本或专门的“服务器”应用程序，它通过消息/套接字/msmq/命名管道/邮件槽/内存映射文件与主程序通信）。
*   COM（在其任何变体中）。
*   DDE（请不要）。
*   通过标准输入/输出进行通信的外部程序。
*   通过文件进行通信的外部程序（文件名是程序的参数）。
*   通过放置文件夹工作的外部程序（用于批处理）。
*   与 Windows 消息/Windows 套接字/msmq/命名管道/邮件槽/内存映射文件/数据库发布订阅通信的外部程序。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-12-15T03:58:29.473

添加插件功能最通用的方法是使用 COM。Eric Harmon的[Delphi Com Programming](https://rads.stackoverflow.com/amzn/click/com/1578702216)是一本让您开始上路的好书。虽然它最初是为 Delphi 版本 3 到 5 编写的，但书籍内容仍然适用于最新版本的 Delphi。

就我个人而言，我已将这种技术与活动脚本一起使用来允许最终用户进行自定义。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-14T02:14:25.330

我正在使用插件来实现我正在构建的游戏引擎中的大部分功能。主 EXE 由脚本引擎、插件管理器、一些基本的图形例程和其他部分组成。我正在使用 JEDI VCL 库中的 TJvPluginManager。它是一个非常好的管理器，它可以将你想要的任何东西添加到你的程序中。查看软件包中包含的演示，了解它是如何工作的。唯一的缺点是它会在您的程序中添加大量 JCL/JVCL 代码，但如果您已经在使用其他 JVCL 组件，这并不是真正的问题。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-14T00:24:32.777

如果插件将在 Delphi 或 C++ builder 中开发，请使用包 + 接口。Delphi OTA 就是一个很好的例子。如果插件将独立于语言，COM 是一个不错的选择。

补充：如果你不会使用 COM，你可能需要为每种语言提供 SDK。并且不同语言之间的数据类型处理可能很痛苦（例如 delphi 字符串类型）。Delphi COM 支持非常好，你不需要担心一些细节。这些大多隐含在 Delphi COM 支持中。不要试图再次发明轮子。我很惊讶为什么人们不倾向于提及它。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-19T01:51:50.240

我找到了 Tim Sullivan 的一篇文章：
[为您的 Delphi 应用程序实现插件](http://www.uil.net/uArticles/ImplementingPluginsforyou.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-14T00:19:35.343

你可以看看Remobjects 的[Hydra](http://www.remobjects.com/hydra.aspx)。这不仅可以让您添加插件，还可以混合使用 win32 和 .net。

# javascript - JavaScript 数组是如何实现的？

> ID：365975
> 
> 赞同：40
> 
> 时间：2008-12-14T00:11:49.307
> 
> 标签：javascript, arrays, associative-array

即，以下代码如何：

```
var sup = new Array(5);
sup[0] = 'z3ero';
sup[1] = 'o3ne';
sup[4] = 'f3our';
document.write(sup.length + "<br />"); 
```

当你所做的只是设置各种元素时，输出'5'的长度？

`length`这段代码的“问题”是，如果不调用 a`getLength()`或方法，我不明白如何更改`setLength()`。当我执行以下任何操作时：

```
a.length
a['length']
a.length = 4
a['length'] = 5 
```

在非数组对象上，它的行为类似于 dict / 关联数组。当我对数组对象执行此操作时，它具有特殊含义。JavaScript 中的什么机制允许这种情况发生？JavaScript 是否有某种类型的属性系统可以翻译

```
a.length
a['length'] 
```

进入“get”方法和

```
a.length = 4
a['length'] = 5 
```

进入“设置”方法？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-14T00:41:12.447

JavaScript 中的一切都是对象。在 的情况下`Array`，该`length`属性返回数组索引项的内部存储区域的大小。一些混淆可能会出现，因为`[]`运算符适用于数字和字符串参数。对于数组，如果将其与数字索引一起使用，它将返回/设置预期的索引项。如果将它与字符串一起使用，它会返回/设置数组对象上的命名属性 - 除非字符串对应于数值，否则它会返回索引项。这是因为在 JavaScript 中，数组索引是通过隐式`toString()`调用强制转换为字符串的。坦率地说，这只是让你挠头说“JavaScript，这，这就是他们嘲笑你的原因”的另一件事。

浏览器之间的实际底层表示可能不同（也可能不同）。除了使用它时提供的接口之外，我不会依赖任何其他东西。

[你可以在 MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)找到更多关于 JavaScript 数组的信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2019-05-25T11:37:18.777

JavaScript 数组的特征

1.  动态 - JavaScript 中的数组可以动态增长 .push
2.  可以是稀疏的 - 例如，array[50000] = 2;
3.  可以是密集的 - 例如，array = [1, 2, 3, 4, 5]

在 JavaScript 中，运行时很难知道数组是密集的还是稀疏的。所以它所能做的就是猜测。所有实现都使用启发式方法来确定数组是密集的还是稀疏的。

例如，上面第 2 点中的代码可以向 JavaScript 运行时指示这可能是一个稀疏数组实现。如果数组是用初始计数初始化的，这可能表明这可能是一个密集数组。

当运行时检测到数组是*sparse*时，它​​的实现方式与对象类似。因此，与其维护一个连续的数组，不如构建一个键/值映射。

有关更多参考，请参阅*[JavaScript 数组是如何在内部实现的？](https://www.quora.com/How-are-javascript-arrays-implemented-internally)*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-07-22T23:11:51.683

这真的取决于你打算用它做什么。

`[].length`是“神奇的”。
它实际上并不返回数组中的项目数。它返回数组中最大的 instated 索引。

```
var testArr = [];  testArr[5000] = "something";  testArr.length; // 5001 
```

但是 setter 背后的方法隐藏在引擎本身中。
某些浏览器中的某些引擎将使您能够访问它们对这些魔术方法的实现。其他人将完全锁定所有内容。

所以不要依赖 defineGetter 和 defineSetter 方法，甚至，真的，`__proto__`方法，除非你知道你知道你的目标是哪些浏览器，而你不是。

这将在未来发生变化，使用 ECMAScript Next/6 编写的选择加入应用程序将可以访问更多。

兼容 ECMAScript 5 的浏览器已经开始在对象中提供魔术方法，`get`而且`set`还会有更多……但是可能还需要一段时间才能放弃对 oldIE 和大量智能手机等的支持……

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-14T00:35:41.350

重要的是要知道，当您这样做时，`sup['look'] = 4;`您不是在使用关联数组，而是在修改 object 的属性`sup`。

这相当于`sup.look = 4;`因为您可以随时在 JavaScript 对象上动态添加属性。`sup['length']`将在您的第一个示例中输出 5 。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-14T04:07:20.797

添加到[tvanfosson 的答案](https://stackoverflow.com/questions/365975/how-are-javascript-arrays-implemented/365995#365995)：在 ECMA-262（我相信是 3.0 规范）中，数组被简单地定义为具有这种设置属性的行为（参见 15.4.5.1）。它没有底层的通用机制（至少到目前为止）——这就是它的定义方式，以及 JavaScript 解释器必须如何运行。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-01-26T19:33:57.133

正如其他人所提到的，JavaScript 中的属性基本上可以充当数组（或字符串或其他输入）的 getter 和 setter。

事实上，你可以自己试试这个：

```
const test = [1, 2, 3, 4, 5]
test.length = 3
console.log(test) // [1, 2, 3]
test.length = 5
console.log(test) // Guess what happens here! 
```

据我所知，JavaScript 中的数组与关联数组的工作方式并不完全相同，并且您可以将元素[尽可能连续地](https://javascript.info/array)放入内存中（假设您可以拥有混合对象的数组），具体取决于您正在考虑的 JavaScript 引擎。

作为旁注，我有点困惑的是，投票最多的答案一直在传播“一切都是 JavaScript 中的对象”的过于简单的神话（或半真半假）；[这并不完全正确](https://www.quora.com/Is-everything-an-object-in-Javascript/answer/Daniel-Couper)，否则您将永远不会学习原语，例如。

尝试这样做：

```
const pippi = "pippi"
pippi.cat = "cat"
console.log(pippi.cat) // Will it work? Throw an error? Guess why again 
```

剧透：字符串被包装在第二行的特定操作的一次性对象中，然后在接下来的一个中，您将访问不存在的原语的属性（前提是您没有玩过`String.prototype`或类似的东西） )，所以你得到`undefined`.

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-14T01:17:56.910

[`Array`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array)对象从 继承`caller`、`constructor`、[`length`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/length)和`name`属性[`Function.prototype`](https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Function/prototype)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-21T00:26:46.677

JavaScript 数组是一个对象，就像任何其他对象一样，但 JavaScript 赋予了它特殊的语法。

```
arr[5] = "yo" 
```

以上是语法**糖**

```
arr.insert(5,"yo") 
```

这就是您将东西添加到常规对象的方式。改变 arr.length 值的是*insert*方法内部的内容

在此处查看我对 customArray 类型的实现：http: [//jsfiddle.net/vfm3vkxy/4/](http://jsfiddle.net/vfm3vkxy/4/)

# sql - 跨进程的数据库连接池

> ID：365984
> 
> 赞同：2
> 
> 时间：2008-12-14T00:21:06.807
> 
> 标签：sql, connection, oledb, pooling

我们有一个由多个 EXE 组成的客户端/服务器应用程序。数据访问层与我们的 EXE 模块共享的库中的客户端位于同一物理层。ODBC 和 OleDB 连接池是按进程管理的；是否有跨进程共享数据库连接的技术（除了将数据访问层移动到中间层）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-14T01:14:32.800

OLEDB 和 ODBC 中的数据库连接本质上是进程绑定的。在最低级别，sql server 数据库连接使用 IPC 机制，如命名管道、共享内存或 tcp 套接字。其他数据库可能专门使用网络连接。如果您考虑一下，要共享连接池并因此共享连接，您需要将这些低级对象（套接字、命名管道、共享内存部分）复制到另一个进程，然后允许它们管理它们。即使您可以将它们交给您，您也无法同时使用它们。

要做你想做的事，你真的必须将数据访问层移动到所有多个 exe 都想使用的共享空间中。这通常是一个中间层，然后每个 exe 将通过某种 IPC 机制（.net 远程处理、com 服务器、RPC、网络等）与之通信。

# sql - 未更改密码时 sa 登录失败

> ID：365996
> 
> 赞同：0
> 
> 时间：2008-12-14T00:41:33.240
> 
> 标签：sql, sql-server, sql-server-2005

我一直在开发一个绑定到 sql server 的 winforms 应用程序。我有一段时间没有重新启动。今天我重新启动，现在我无法登录到 sql。我使用了我知道的每个帐户和他们的密码，包括在我重新启动之前正在工作的一个，我得到一个“登录失败”。我确实在开始之前将我使用的数据库脱机，并且在那之前我确实有备份。

对发生了什么的想法？有没有办法让数据库重新联机或以某种方式找出密码是什么？我什至尝试以管理员身份在盒子和 sa 上使用 Windows 身份验证（是的，不好），但仍然没有骰子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-14T00:46:45.163

:-/ 那是一个艰难的地方......祝你好运。查看此博客文章，不确定您是否使用 sql 2k5，但如果是，它可能会有所帮助：

[http://blogs.msdn.com/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server- 2005.aspx](http://blogs.msdn.com/raulga/archive/2007/07/12/disaster-recovery-what-to-do-when-the-sa-account-password-is-lost-in-sql-server-2005.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-14T01:10:55.817

您是否检查过以确保该服务确实在运行？您是否还尝试使用 IPC、TCPIP 或命名管道进行连接？无论哪种方式，请确保在配置工具中启用它。

由于盒子上的管理员是 SQL 管理员，我唯一能想到的是服务没有运行。***************